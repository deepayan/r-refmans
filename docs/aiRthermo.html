<!DOCTYPE html><html><head><title>Help for package aiRthermo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aiRthermo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aiRthermo-package'>
<p>Atmospheric Thermodynamics and Visualization</p></a></li>
<li><a href='#adiabatic_ascent'>
<p>Properties of an air parcel after adiabatic ascent</p></a></li>
<li><a href='#aiRthermoConstants'>
<p>Thermodynamical Constansts</p></a></li>
<li><a href='#AnyAdiabaticDown'>
<p>Adiabatic Downwards Evolution</p></a></li>
<li><a href='#boltonTLCL'>
<p>Find the Temperature at the Lifting Condensation Level (LCL)</p></a></li>
<li><a href='#bruntVaisallaOmegaSquared'>
<p>Brunt-Vaisalla (angular) frequency (squared)</p></a></li>
<li><a href='#C2K'>
<p>From Celsius to Kelvin degrees</p></a></li>
<li><a href='#CAPE_CIN'>
<p>Calculation of CAPE and CIN</p></a></li>
<li><a href='#densityDry'>
<p>Density of Dry Air</p></a></li>
<li><a href='#densityH2Ov'>
<p>Density of water vapour</p></a></li>
<li><a href='#densityMoistAir'>
<p>Density of Moist Air</p></a></li>
<li><a href='#dewpointdepression2rh'>
<p>Relative Humidity from the dew point depression</p></a></li>
<li><a href='#e2w'>
<p>Compute Mixing Ratio from partial pressure of water vapour</p></a></li>
<li><a href='#equivalentPotentialTemperature'>
<p>Equivalent Potential Temperature</p></a></li>
<li><a href='#export_constants'>
<p>Export the constants</p></a></li>
<li><a href='#export_lines'>
<p>Export the lines for the thermodynamic diagram</p></a></li>
<li><a href='#find_lcl'>
<p>Calculation of the Lifted Condensation Level (LCL)</p></a></li>
<li><a href='#fixedlines'>
<p>Data for plotting the lines of the thermodynamic (STUVE) diagram</p></a></li>
<li><a href='#gamma_saturated'>
<p>Saturated Adiabat Gamma</p></a></li>
<li><a href='#K2C'>
<p>From Kelvin to Celsius degrees</p></a></li>
<li><a href='#Kindex'>
<p>K Instability Index</p></a></li>
<li><a href='#latent_heat_H2O'>
<p>Latent heat of vaporization or sublimation of water</p></a></li>
<li><a href='#LIindex'>
<p>Lifted index</p></a></li>
<li><a href='#moistAdiabaticLapseRate'>
<p>Moist Adiabatic Lapse Rate</p></a></li>
<li><a href='#moistCp'>
<p>Moist Cp</p></a></li>
<li><a href='#moistCv'>
<p>Moist cv value</p></a></li>
<li><a href='#parcelState'>
<p>State of a parcel</p></a></li>
<li><a href='#PT2Theta'>
<p>Potential Temperature from pressure and temperature</p></a></li>
<li><a href='#PTheta2T'>
<p>Temperature from pressure and potential temperature</p></a></li>
<li><a href='#PW'>
<p>Vertically integrated water vapour column</p></a></li>
<li><a href='#q2e'>
<p>Partial Vapour Pressure</p></a></li>
<li><a href='#q2w'>
<p>Water vapour mixing Ratio to specific humidity</p></a></li>
<li><a href='#RadiosondeA'>
<p>Radiosonde A</p></a></li>
<li><a href='#RadiosondeD'>
<p>Radiosonde D</p></a></li>
<li><a href='#RadiosondeDavenport'>
<p>Radiosonde Davenport</p></a></li>
<li><a href='#rh2shum'>
<p>Specific Humidity from relative humidity</p></a></li>
<li><a href='#rh2w'>
<p>Mixing Ratio from relative humidity</p></a></li>
<li><a href='#saturation_mixing_ratio'>
<p>Saturation Mixing Ratio</p></a></li>
<li><a href='#saturation_pressure_H2O'>
<p>Saturation Pressure</p></a></li>
<li><a href='#Sindex'>
<p>Showalter Instability Index</p></a></li>
<li><a href='#stuve_diagram'>
<p>Thermodynamic (STUVE) Diagram</p></a></li>
<li><a href='#TTdP2rh'>
<p>Relative Humidity from temperature, pressure and dew point temperature</p></a></li>
<li><a href='#TTheta2P'>
<p>Pressure from temperature and potential temperature</p></a></li>
<li><a href='#TTindex'>
<p>Total-Totals Instability Index</p></a></li>
<li><a href='#virtual_temperature'>
<p>Virtual Temperature</p></a></li>
<li><a href='#w2q'>
<p>Specific Humidity from mixing ratio</p></a></li>
<li><a href='#w2Td'>
<p>Dew point temperature from mixing ratio</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Atmospheric Thermodynamics and Visualization</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-09-14</td>
</tr>
<tr>
<td>Author:</td>
<td>Jon Sáenz, Santos J. González-Rojí, Sheila Carreno-Madinabeitia and Gabriel Ibarra-Berastegi</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Santos J. González-Rojí &lt;santosjose.gonzalez@ehu.eus&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Deals with many computations related to the thermodynamics of atmospheric processes. It includes many functions designed to consider the density of air with varying degrees of water vapour in it, saturation pressures and mixing ratios, conversion of moisture indices, computation of atmospheric states of parcels subject to dry or pseudoadiabatic vertical evolutions and atmospheric instability indices that are routinely used for operational weather forecasts or meteorological diagnostics.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-09-15 12:34:05 UTC; Santitxu</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-09-16 22:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='aiRthermo-package'>
Atmospheric Thermodynamics and Visualization
</h2><span id='topic+aiRthermo-package'></span><span id='topic+aiRthermo'></span>

<h3>Description</h3>

<p>Deals with many computations related to the thermodynamics of atmospheric processes. It includes many functions designed to consider the density of air with varying degrees of water vapour in it, saturation pressures and mixing ratios, conversion of moisture indices, computation of atmospheric states of parcels subject to dry or pseudoadiabatic vertical evolutions and atmospheric instability indices that are routinely used for operational weather forecasts or meteorological diagnostics.
</p>
<p>Unless otherwise explicitly noted (<code><a href="#topic+boltonTLCL">boltonTLCL</a></code> and <code><a href="#topic+stuve_diagram">stuve_diagram</a></code>) all parameters to functions must be provided in the International System of Units: P in Pa, T in K and w in kg/kg.
</p>


<h3>Author(s)</h3>

<p>Jon Sáenz, Santos J. González-Rojí, Sheila Carreno-Madinabeitia and Gabriel Ibarra-Berastegi
</p>
<p>Maintainer: Santos J. González-Rojí &lt;santosjose.gonzalez@ehu.eus&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# CAPE, CIN index
data(RadiosondeA)
aPs&lt;-RadiosondeA[,1]*100
aTs&lt;-C2K(RadiosondeA[,3])
aws&lt;-RadiosondeA[,6]/1000
capeCin&lt;-CAPE_CIN(PlowTop=98000,precoolType="adiabatic",
                  Ps=aPs,Ts=aTs,ws=aws,doLog=0,deltaP=5,
                  getLiftedBack=TRUE,upToTop=TRUE)
print(min(capeCin$CAPE))


pdf("stuve.pdf")
stuveA&lt;-stuve_diagram(Pres = aPs/100,Temp=aTs-273.15)
lines(capeCin$Tl-273.15,capeCin$Pl/100,col="red",lwd=2)
dev.off()

# Adiabatic Ascent
P0&lt;-101325
T0&lt;-273.15
w0&lt;-0.0025
adiabEvol&lt;-adiabatic_ascent(P0,T0,w0,50000,5)

</code></pre>

<hr>
<h2 id='adiabatic_ascent'>
Properties of an air parcel after adiabatic ascent 
</h2><span id='topic+adiabatic_ascent'></span>

<h3>Description</h3>

<p>A particle located at Pstart pressure (Pa), Tstart temperature (K) and wstart mixing ratio (kg/kg) ascends (pseudo)adiabatically to Pend (Pa). The evolution is computed by numerically integrating the dT/dP ordinary differential equation (ODE) using a 4th order Runge-Kutta scheme, assuming hydrostatic equilibrium and that the particle is saturated after the Lifted Condensation Level (LCL).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adiabatic_ascent(Pstart, Tstart, wstart, Pend, deltaP = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adiabatic_ascent_+3A_pstart">Pstart</code></td>
<td>

<p>Initial value for pressure (Pa).
</p>
</td></tr>
<tr><td><code id="adiabatic_ascent_+3A_tstart">Tstart</code></td>
<td>

<p>Initial value for temperature (K).
</p>
</td></tr>
<tr><td><code id="adiabatic_ascent_+3A_wstart">wstart</code></td>
<td>

<p>Initial value for mixing ratio (kg/kg).
</p>
</td></tr>
<tr><td><code id="adiabatic_ascent_+3A_pend">Pend</code></td>
<td>

<p>End value for pressure (Pa).
</p>
</td></tr>
<tr><td><code id="adiabatic_ascent_+3A_deltap">deltaP</code></td>
<td>

<p>deltaP (Pa) represents the numerical increment used for integrating the Ordinary Differential Equation (ODE) representing the vertical evolution.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list that includes Tend (final value of temperature) and mixRatioEnd (mixing ratio of the air parcel at the end of the evolution).
</p>
<table>
<tr><td><code>Tend</code></td>
<td>

<p>Temperature at the end (K).
</p>
</td></tr>
<tr><td><code>mixRatioEnd</code></td>
<td>

<p>Mixing ratio at the end (kg/kg).
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>P0&lt;-101325
T0&lt;-273.15
w0&lt;-0.0025
adiabEvov&lt;-adiabatic_ascent(P0,T0,w0,50000,5)
</code></pre>

<hr>
<h2 id='aiRthermoConstants'>
Thermodynamical Constansts 
</h2><span id='topic+aiRthermoConstants'></span>

<h3>Description</h3>

<p>Frecuently used constants in atmospheric thermodynamics and in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aiRthermoConstants)</code></pre>


<h3>Format</h3>

<p><em>aiRthermoConstants</em> is a vector that includes the constants used by many of the functions in package. 
</p>


<h3>Details</h3>

<p>The constants stored in the vector are (in SI units): the gas constant for dry air <code class="reqn">R_d</code> and for water vapour <code class="reqn">R_v</code> (<code class="reqn">\frac{J}{Kkg}</code>), the temperature <code class="reqn">T_0</code> corresponding to 0 degree Celsius, <code class="reqn">es_0</code> used to calculate the saturated vapour pressure  (Pa), 1000 hPa in Pa (P1000), the specific heat of dry air for constant pressure <code class="reqn">c_p</code> (<code class="reqn">\frac{J}{Kkg}</code>) and for constant volume <code class="reqn">c_v</code> (<code class="reqn">\frac{J}{Kkg}</code>), acceleration due to gravity at sea level g (<code class="reqn">\frac{m}{s^2}</code>), our definition of a missing value MISSING_VALUE (-99999999) and epsilon <code class="reqn">\varepsilon</code> (<code class="reqn">\frac{R_d}{R_v}</code>).
</p>
<p>The values of the constants are taken from Bohren &amp; Albrecht (1998), and they are also consistent with those used in Petty (2008), Erukhimova &amp; North (2009) and Davies-Jones (2009). 
</p>


<h3>References</h3>

<p>Bohren, C.F., &amp; Albrecht, B. A. (1998). Atmospheric thermodynamics. Atmospheric thermodynamics. Publisher: New York; Oxford: Oxford University Press, 1998. ISBN: 0195099044.
</p>
<p>Petty, G.W. (2008). A First Course in Atmospheric Thermodynamics, Sundog Publishing, Madison.
</p>
<p>North, G. R. , Erukhimova,T. L. (2009). Atmospheric Thermodynamics, Cambridge University Press, New York.
</p>
<p>Davies-Jones, R. (2009). On formulas for equivalent potential temperature, Monthly Weather Review, 137,3137-3148. doi:10.1175/2009MWR2774.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Define the Rd
data(aiRthermoConstants)
Rd &lt;- aiRthermoConstants['Rd']

#Define gravity
data(aiRthermoConstants)
g &lt;- aiRthermoConstants['g'] 
</code></pre>

<hr>
<h2 id='AnyAdiabaticDown'>
Adiabatic Downwards Evolution
</h2><span id='topic+AnyAdiabaticDown'></span>

<h3>Description</h3>

<p>Calculation of the state of an air parcel subject to an adiabatic downwards evolution, taking into account the initial conditions of the parcel (Pstart, Tstart, wstart, wcstart).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AnyAdiabaticDown(Pstart, Tstart, wstart, wcstart, Pend, deltaP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AnyAdiabaticDown_+3A_pstart">Pstart</code></td>
<td>

<p>Initial pressure value (Pa).
</p>
</td></tr>
<tr><td><code id="AnyAdiabaticDown_+3A_tstart">Tstart</code></td>
<td>

<p>Initial temperature value (K).
</p>
</td></tr>
<tr><td><code id="AnyAdiabaticDown_+3A_wstart">wstart</code></td>
<td>

<p>Initial mixing ratio value (kg/kg).
</p>
</td></tr>
<tr><td><code id="AnyAdiabaticDown_+3A_wcstart">wcstart</code></td>
<td>

<p>Initial mixing ratio value for the condensates (kg/kg).
</p>
</td></tr>
<tr><td><code id="AnyAdiabaticDown_+3A_pend">Pend</code></td>
<td>

<p>Final pressure value (Pa).
</p>
</td></tr>
<tr><td><code id="AnyAdiabaticDown_+3A_deltap">deltaP</code></td>
<td>

<p>Pressure step used for the calculation. It must be a positive value (Pa).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In this case, we start from a parcel at pressure pstart (Pa), temperature tstart (K) and mixing ratio wstart (kg/kg), with potentially some condensates wcstart (kg/kg). The latent heat (L) used during the evolution depends on the Temperature (T). It is computed as described by <code><a href="#topic+latent_heat_H2O">latent_heat_H2O</a></code>. As the parcel goes down it could evaporate the condensates or, if no condensates are available anymore, it will go down according to a dry adiabatic evolution by means of a dry adiabatic process until the level Pend. At this point, it will have a temperature Tend, mixing ratio (vapour) Wend  and Wcend (may be still some condensates could be left) using steps of pressure dP (always positive).
</p>


<h3>Value</h3>

<p>This function returns a list including the following values:
</p>
<table>
<tr><td><code>Tend</code></td>
<td>
<p>Temperature at the end (K).</p>
</td></tr> 
<tr><td><code>Wend</code></td>
<td>
<p>Mixing ratio of water vapour at the end (kg/kg).</p>
</td></tr>
<tr><td><code>Wcend</code></td>
<td>
<p>Mixing ratio of condensed water at the end (kg/kg).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>AnyAdiabaticDown(50000,227,8.5e-5,0.005,101325,5)
AnyAdiabaticDown(70000,237,4e-4,0.005,101325,5)
</code></pre>

<hr>
<h2 id='boltonTLCL'>
Find the Temperature at the Lifting Condensation Level (LCL) 
</h2><span id='topic+boltonTLCL'></span>

<h3>Description</h3>

<p>This function is used to calculate the Temperature at the Lifting Condensation Level (LCL) using Bolton's approximation instead of integrating the Ordinary Differential Equation (ODE) upwards.</p>


<h3>Usage</h3>

<pre><code class='language-R'>boltonTLCL(TempCelsius, rh, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boltonTLCL_+3A_tempcelsius">TempCelsius</code></td>
<td>

<p>Temperature in degrees Celsius.
</p>
</td></tr>
<tr><td><code id="boltonTLCL_+3A_rh">rh</code></td>
<td>

<p>Relative humidity (%).
</p>
</td></tr>
<tr><td><code id="boltonTLCL_+3A_consts">consts</code></td>
<td>

<p>Includes the frecuently used constants in thermodynamics defined in 
</p>
<p><em>aiRthermoConstants</em>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function calculates an approximation of the temperature in degrees Celsius corresponding to the LCL. 
</p>


<h3>References</h3>

<p>Bolton, D. (1980). The computation of equivalent potential temperature, Monthly Weather Review 108, 1046-1053. doi:10.1175/1520-0493(1980)108&lt;1046:TCOEPT&gt;2.0.CO;2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>T0=273.15
rh=66.25489
boltonTLCL(T0,rh)
</code></pre>

<hr>
<h2 id='bruntVaisallaOmegaSquared'>
Brunt-Vaisalla (angular) frequency (squared)
</h2><span id='topic+bruntVaisallaOmegaSquared'></span>

<h3>Description</h3>

<p>Brunt-Vaisalla (angular) frequency (aquared, <code class="reqn">s^{-2}</code>) considering hydrostatic equilibrium. P is used as a vertical level. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bruntVaisallaOmegaSquared(Ps, Ts, ws, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bruntVaisallaOmegaSquared_+3A_ps">Ps</code></td>
<td>

<p>A vector with pressure values (Pa).
</p>
</td></tr>
<tr><td><code id="bruntVaisallaOmegaSquared_+3A_ts">Ts</code></td>
<td>

<p>A vector with temperature values (K).
</p>
</td></tr>
<tr><td><code id="bruntVaisallaOmegaSquared_+3A_ws">ws</code></td>
<td>

<p>A vector with mixing ratio values (kg/kg).
</p>
</td></tr>
<tr><td><code id="bruntVaisallaOmegaSquared_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. The constants g and Rd are used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The angular frequency (squared, <code class="reqn">s^{-2}</code>) is returned in order to avoid complex numbers. 
</p>


<h3>Value</h3>

<p>The Brunt-Vaisalla (angular) frequency (squared) is returned.
</p>


<h3>Note</h3>

<p>For stable atmospheres, should be positive at every level. Ps, Ts and ws are 1D arrays.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PT2Theta">PT2Theta</a></code> and <code><a href="#topic+densityMoistAir">densityMoistAir</a></code> are used inside <code>bruntVaisallaOmegaSquared</code> function. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dws&lt;-RadiosondeD[,6]/1000
bruntVaisallaOmegaSquared(dPs,dTs,dws)

</code></pre>

<hr>
<h2 id='C2K'>
From Celsius to Kelvin degrees
</h2><span id='topic+C2K'></span>

<h3>Description</h3>

<p>This function makes the transformation from Celsius to Kelvin degrees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C2K(Tc, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="C2K_+3A_tc">Tc</code></td>
<td>

<p>A vector of temperatures in degrees Celsius.
</p>
</td></tr>
<tr><td><code id="C2K_+3A_consts">consts</code></td>
<td>

<p>This funtion uses the <code class="reqn">T_0</code> constant, corresponding to 0 degree Celsius expressed in K (273.15 K).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of temperatures in Kelvin degrees is returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aiRthermoConstants">aiRthermoConstants</a></code> and <code><a href="#topic+K2C">K2C</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dTs&lt;-RadiosondeD[,3]
C2K(dTs)
</code></pre>

<hr>
<h2 id='CAPE_CIN'>
Calculation of CAPE and CIN
</h2><span id='topic+CAPE_CIN'></span>

<h3>Description</h3>

<p>Taking into account the data obtained in a radiosonde, and after defining the initial values of the parcel, this function calculates the values of CAPE and CIN for the sounding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CAPE_CIN(Ps, Ts, ws, deltaP = 5, P0 = NA, T0 = NA, w0 = NA, PlowTop = NA, 
precoolType = "none", doLog = 0, getLiftedBack = FALSE, upToTop = TRUE, 
checkBuoyancy = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CAPE_CIN_+3A_ps">Ps</code></td>
<td>

<p>Pressures (Pa) defining the sounding.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_ts">Ts</code></td>
<td>

<p>Temperatures (K) defining the sounding.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_ws">ws</code></td>
<td>

<p>Mixing ratios (kg/kg) defining the sounding.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_deltap">deltaP</code></td>
<td>

<p>The width (Pa) of the layers used in the calculation of the numerical solution for the vertical evolution. A default value of 5 Pa is used. It must be positive.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_p0">P0</code></td>
<td>

<p>The initial pressure (Pa) for the parcel that is lifted (may be the lowest level of the sounding). Missing value is used by default.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_t0">T0</code></td>
<td>

<p>The initial temperature (K) of the parcel being lifted. Missing value is used by default.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_w0">w0</code></td>
<td>

<p>The initial mixing ratio (kg/kg) of the parcel being lifted.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_plowtop">PlowTop</code></td>
<td>

<p>If some layers must be averaged in the bottom of the sounding this argument provides the pressure (Pa) at the top of the layer that must be averaged in the bottom of the sounding. <code>NA</code> is used by default.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_precooltype">precoolType</code></td>
<td>

<p>If requested, an adiabatic or an isobaric precooling of the initial parcel is performed. &quot;none&quot; is used by default, but &quot;adiabatic&quot; and &quot;isobaric&quot; are also accepted.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_dolog">doLog</code></td>
<td>

<p>Use logarithmic vertical interpolation between sounding levels if doLog=1. The default value is doLog=0.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_getliftedback">getLiftedBack</code></td>
<td>

<p>TRUE/FALSE requests that the evolution of the lifted particle until the top level of the soundig is returned as a set of vectors for P, T and w (fields Pl, Tl and wl respectively). FALSE is used by default.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_uptotop">upToTop</code></td>
<td>

<p>TRUE(FALSE) requests that the lifted particle continues(stops) after the first crossing with the ambient sounding (EL) (until the sounding finishes). If TRUE, remaining negative areas above are accumulated into CIN only if the parcel becomes buoyant again in upper levels depending on the setting of <em>checkBuoyancy</em>. TRUE is used by default.
</p>
</td></tr>
<tr><td><code id="CAPE_CIN_+3A_checkbuoyancy">checkBuoyancy</code></td>
<td>

<p>If <em>checkBuoyancy</em> is TRUE, the computation of CAPE and CIN proceed to the top of the sounding if <em>upToTop</em> is TRUE if CAPE is larger than CIN while the parcel passes non-buoyant regions. The default value is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>CAPE and CIN (J/kg) are calculated from a sounding given by 1D arrays for pressure Ps (Pa), for temperature Ts (K) and for mixing ratio ws (kg/kg).
</p>
<p>If <code class="reqn">P_0</code>/<code class="reqn">T_0</code>/<code class="reqn">w_0</code> are provided, no low vertical averaging is done and these values are used as initial points for the parcel. Missing value is used by default for these arguments.
</p>
<p>This function returns some error codes in field <em>outCode</em> in the return value if the computation of CAPE and CIN failed.
</p>


<h3>Value</h3>

<p>Returns:
</p>
<table>
<tr><td><code>airStart</code></td>
<td>

<p>The real starting variable of the air parcel. It is a vector with 6 elements: P (Pa), Temp (K), w (kg/kg), theta (K), Tvirtual (K) and wsat (kg/kg). The values are computed depending on the input arguments.
</p>
</td></tr>
<tr><td><code>cape</code></td>
<td>

<p>CAPE index (J/kg).
</p>
</td></tr>
<tr><td><code>cin</code></td>
<td>

<p>CIN index (J/kg) as a negative number.
</p>
</td></tr>
<tr><td><code>apLCL</code></td>
<td>

<p>Variables of the air parcel at the Lifting Condensation Level (LCL). It is returned as a vector with 6 elements: P (Pa), Temp (K), w (kg/kg), theta (K), virtualT (K) and wsat (kg/kg).
</p>
</td></tr>
<tr><td><code>apLFC</code></td>
<td>

<p>Variables of the Level of Free Convection (LFC). If LFC is found, it is returned as a vector with six elements: P (Pa), Temp (K), w (kg/kg), theta (K), virtualT (K) and wsat (kg/kg).
</p>
</td></tr>
<tr><td><code>apEL</code></td>
<td>

<p>End Level (EL). If EL is found, it is returned as a vector with six elements: P (Pa), Temp (K), w (kg/kg), theta (K), virtualT (K) and wsat (kg/kg).
</p>
</td></tr>
<tr><td><code>gotLCL</code></td>
<td>

<p>TRUE/FALSE whether the LCL has been found or not.
</p>
</td></tr>
<tr><td><code>gotLFC</code></td>
<td>

<p>TRUE/FALSE whether the LFC has been found or not.
</p>
</td></tr>
<tr><td><code>gotEL</code></td>
<td>

<p>TRUE/FALSE whether the EL has been found or not.
</p>
</td></tr>
<tr><td><code>Pl</code></td>
<td>

<p>Pressure (Pa) at every step of the lifted particle during its evolution. If requested by using getLiftedBack==TRUE, every step until the end of the radiosonde is returned.
</p>
</td></tr>
<tr><td><code>Tl</code></td>
<td>

<p>Temp (K) at every step of the lifted particle during its evolution. If requested by using getLiftedBack==TRUE, every step until the end of the radiosonde is returned.
</p>
</td></tr>
<tr><td><code>wl</code></td>
<td>

<p>Mixing-ratio of the lifted particle during its evolution. If requested by using getLiftedBack==TRUE, every step until the end of the radiosonde is returned.
</p>
</td></tr>
<tr><td><code>Olifted</code></td>
<td>

<p>Number of elements in  Pl/Tl/wl.
</p>
</td></tr>
<tr><td><code>upToTop</code></td>
<td>

<p>Process the whole sounding even after finding the first &quot;EL level&quot;.
</p>
</td></tr>
<tr><td><code>outCode</code></td>
<td>

<p>The  error code returned by the C routine that computes CAPE/CIN. If 0, everything has been OK!
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aPs&lt;-RadiosondeA[,1]*100
aTs&lt;-C2K(RadiosondeA[,3])
aws&lt;-RadiosondeA[,6]/1000
capeCin&lt;-CAPE_CIN(PlowTop=98000,precoolType="adiabatic",
                  Ps=aPs,Ts=aTs,ws=aws,doLog=0,deltaP=5,
                  getLiftedBack=TRUE,upToTop=TRUE)
print(min(capeCin$Tl))

pdf("stuve.pdf")
stuveA&lt;-stuve_diagram(Pres = aPs/100,Temp=aTs-273.15)
lines(capeCin$Tl-273.15,capeCin$Pl/100,col="red",lwd=2)
dev.off()
</code></pre>

<hr>
<h2 id='densityDry'>
Density of Dry Air
</h2><span id='topic+densityDry'></span>

<h3>Description</h3>

<p>From pressure P (Pa) and temperature Temp (K), this funtion calculates the density of dry air in <code class="reqn">kg/m^3</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>densityDry(P, Temp, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="densityDry_+3A_p">P</code></td>
<td>

<p>A vector with pressure values (Pa).
</p>
</td></tr>
<tr><td><code id="densityDry_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values (K).
</p>
</td></tr>
<tr><td><code id="densityDry_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with density of dry air values is returned (<code class="reqn">kg/m^3</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
densityDry(dPs,dTs)
</code></pre>

<hr>
<h2 id='densityH2Ov'>
Density of water vapour
</h2><span id='topic+densityH2Ov'></span>

<h3>Description</h3>

<p>From pressure of water vapour Pw (Pa) and temperature Temp (K), this function calculates density of water vapour (<code class="reqn">kg/m^3</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>densityH2Ov(Pw, Temp, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="densityH2Ov_+3A_pw">Pw</code></td>
<td>

<p>A vector with pressure water vapour values (Pa).
</p>
</td></tr>
<tr><td><code id="densityH2Ov_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values (K).
</p>
</td></tr>
<tr><td><code id="densityH2Ov_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with density of water vapour values is returned (<code class="reqn">kg/m^3</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+q2e">q2e</a></code> and <code><a href="#topic+w2q">w2q</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dws&lt;-RadiosondeD[,6]/1000
h2oe&lt;-q2e(dPs,w2q(dws))
densityH2Ov(h2oe,dTs)
</code></pre>

<hr>
<h2 id='densityMoistAir'>
Density of Moist Air
</h2><span id='topic+densityMoistAir'></span>

<h3>Description</h3>

<p>From pressure P (Pa) temperature Temp (K) and mixing ratio (kg/kg), this function calculates the density of moist air  (<code class="reqn">kg/m^3</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>densityMoistAir(P, Temp, w, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="densityMoistAir_+3A_p">P</code></td>
<td>

<p>A vector with pressure values (Pa).
</p>
</td></tr>
<tr><td><code id="densityMoistAir_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values (K).
</p>
</td></tr>
<tr><td><code id="densityMoistAir_+3A_w">w</code></td>
<td>

<p>A vector with mixing ratio values (kg/kg).
</p>
</td></tr>
<tr><td><code id="densityMoistAir_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with density of moist air values is returned (<code class="reqn">kg/m^3</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+virtual_temperature">virtual_temperature</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aPs&lt;-RadiosondeA[,1]*100
aTs&lt;-C2K(RadiosondeA[,3])
aws&lt;-RadiosondeA[,6]/1000
densityMoistAir(aPs,aTs,aws)
</code></pre>

<hr>
<h2 id='dewpointdepression2rh'>
Relative Humidity from the dew point depression
</h2><span id='topic+dewpointdepression2rh'></span>

<h3>Description</h3>

<p>This function calculates the relative humidity (%) from the dew point depression (K).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dewpointdepression2rh(P, Temp, dpd, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dewpointdepression2rh_+3A_p">P</code></td>
<td>

<p>A vector with pressure values (Pa).
</p>
</td></tr>
<tr><td><code id="dewpointdepression2rh_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values (K).
</p>
</td></tr>
<tr><td><code id="dewpointdepression2rh_+3A_dpd">dpd</code></td>
<td>

<p>A vector with dew point depression values (K).
</p>
</td></tr>
<tr><td><code id="dewpointdepression2rh_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with relative humidity (%).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saturation_mixing_ratio">saturation_mixing_ratio</a></code> and <code><a href="#topic+saturation_pressure_H2O">saturation_pressure_H2O</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dws&lt;-RadiosondeD[,6]/1000
dTds=w2Td(dPs,dws)
dDPDs=dTs-dTds
dewpointdepression2rh(dPs,dTs,dDPDs)
</code></pre>

<hr>
<h2 id='e2w'>
Compute Mixing Ratio from partial pressure of water vapour
</h2><span id='topic+e2w'></span>

<h3>Description</h3>

<p>This function calculates the mixing ratio (kg/kg) from the partial vapour pressure of water vapour (Pa).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e2w(eh2o, P, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e2w_+3A_eh2o">eh2o</code></td>
<td>

<p>A vector with partial pressure of water vapour (Pa).
</p>
</td></tr>
<tr><td><code id="e2w_+3A_p">P</code></td>
<td>

<p>A vector with pressure (Pa) values.
</p>
</td></tr>
<tr><td><code id="e2w_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with mixing ratio values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	
	
#Partial pressure of water vapour
data(RadiosondeA)
dPs&lt;-RadiosondeA[,1]*100
dws&lt;-RadiosondeA[,6]/1000
eh2o&lt;-q2e(dPs,w2q(dws))
#Pressure
e2w(eh2o,dPs)
</code></pre>

<hr>
<h2 id='equivalentPotentialTemperature'>
Equivalent Potential Temperature 
</h2><span id='topic+equivalentPotentialTemperature'></span>

<h3>Description</h3>

<p>This function calculates the equivalent potential temperature (K), following the techniques used in Davies-Jones (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>equivalentPotentialTemperature(P, Temp, w, TLCL, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="equivalentPotentialTemperature_+3A_p">P</code></td>
<td>

<p>The pressure (Pa) of the air parcel.
</p>
</td></tr>
<tr><td><code id="equivalentPotentialTemperature_+3A_temp">Temp</code></td>
<td>

<p>The temperature (K) of the parcel. 
</p>
</td></tr>
<tr><td><code id="equivalentPotentialTemperature_+3A_w">w</code></td>
<td>

<p>The mixing ratio (kg/kg) of the parcel.
</p>
</td></tr>
<tr><td><code id="equivalentPotentialTemperature_+3A_tlcl">TLCL</code></td>
<td>

<p>The temperature (K) at the Lifting Condensation Level (LCL).
</p>
</td></tr>
<tr><td><code id="equivalentPotentialTemperature_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the value of the equivalent potential temp (K).
</p>


<h3>References</h3>

<p>Davies-Jones, R. (2009). On formulas for equivalent potential temperature. Monthly Weather Review, 137(9), 3137-3148.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PT2Theta">PT2Theta</a></code> and <code><a href="#topic+moistCp">moistCp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aPs&lt;-RadiosondeA[,1]*100
aP0&lt;-aPs[1]
aT0&lt;-C2K(RadiosondeA[1,3])
aw0&lt;-RadiosondeA[1,6]/1000
deltaP=1
Na=length(aPs)
Ptop=aPs[Na]
fndlcl=find_lcl(Ptop,aP0,aT0,aw0,deltaP)
TLCL=fndlcl$Tlcl
equivalentPotentialTemperature(aP0,aT0,aw0,TLCL)
</code></pre>

<hr>
<h2 id='export_constants'>
Export the constants
</h2><span id='topic+export_constants'></span>

<h3>Description</h3>

<p>This function exports to R the constants frecuently used in the C part of <em>aiRthermo</em> for consistency.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_constants()
</code></pre>


<h3>Details</h3>

<p>The constants stored in the vector are (in SI units): the gas constant for dry air <code class="reqn">R_d</code> and for water vapour <code class="reqn">R_v</code> (<code class="reqn">\frac{J}{Kkg}</code>), the temperature <code class="reqn">T_0</code> corresponding to 0 degree Celsius, <code class="reqn">es_0</code> used to calculate the saturated vapour pressure  (Pa), 1000 hPa in Pa (P1000), the specific heat of dry air for constant pressure <code class="reqn">c_p</code> (<code class="reqn">\frac{J}{Kkg}</code>) and for constant volume <code class="reqn">c_v</code> (<code class="reqn">\frac{J}{Kkg}</code>), acceleration due to gravity at sea level g (<code class="reqn">\frac{m}{s^2}</code>), our definition of a missing value MISSING_VALUE (-99999999) and epsilon <code class="reqn">\varepsilon</code> (<code class="reqn">\frac{R_d}{R_v}</code>).
</p>
<p>Constants are taken from Bohren &amp; Albrecht (1998), and they are also consistent with those used in Petty (2008), Erukhimova &amp; North (2009) and Davies-Jones (2009). 
</p>


<h3>References</h3>

<p>Bohren, C.F., &amp; Albrecht, B. A. (1998). Atmospheric thermodynamics. Atmospheric thermodynamics. Publisher: New York; Oxford: Oxford University Press, 1998. ISBN: 0195099044.
</p>
<p>Petty, G.W. (2008). A First Course in Atmospheric Thermodynamics, Sundog Publishing, Madison.
</p>
<p>North, G. R. , Erukhimova,T. L. (2009). Atmospheric Thermodynamics, Cambridge University Press, New York.
</p>
<p>Davies-Jones, R. (2009). On formulas for equivalent potential temperature, Monthly Weather Review, 137,3137-3148. doi:10.1175/2009MWR2774.1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aiRthermoConstants">aiRthermoConstants</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>aiRthermoConstants&lt;-export_constants()
</code></pre>

<hr>
<h2 id='export_lines'>
Export the lines for the thermodynamic diagram
</h2><span id='topic+export_lines'></span>

<h3>Description</h3>

<p>This function exports the <em>fixedlines</em> for Stüve Diagram. It includes the data for plotting the pseudoadiabatic (adiabat_*_T), dry adiabatic (theta_*_T) and constant mixing ratio lines (wsat_*_T).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_lines()
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+fixedlines">fixedlines</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aPs&lt;-RadiosondeA[,1]*100
aTs&lt;-C2K(RadiosondeA[,3])
stuveA&lt;-stuve_diagram(Pres = aPs/100,Temp=aTs-273.15)
</code></pre>

<hr>
<h2 id='find_lcl'>
Calculation of the Lifted Condensation Level (LCL)
</h2><span id='topic+find_lcl'></span>

<h3>Description</h3>

<p>For a particle with initial conditions <code class="reqn">P_0</code>, <code class="reqn">T_0</code> and <code class="reqn">w_0</code>, this function performs an adiabatic vertical evolution until it gets saturated at most when Ptop is reached.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_lcl(Ptop, P0, T0, w0, deltaP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_lcl_+3A_ptop">Ptop</code></td>
<td>

<p>Maximun level pressure selected (Pa).
</p>
</td></tr>
<tr><td><code id="find_lcl_+3A_p0">P0</code></td>
<td>

<p>Initial value of pressure (Pa).
</p>
</td></tr>
<tr><td><code id="find_lcl_+3A_t0">T0</code></td>
<td>

<p>Initial value of temperature (K).
</p>
</td></tr>
<tr><td><code id="find_lcl_+3A_w0">w0</code></td>
<td>

<p>Initial value of mixing ratio (kg/kg).
</p>
</td></tr>
<tr><td><code id="find_lcl_+3A_deltap">deltaP</code></td>
<td>

<p>The width (Pa) of the layers used in the calculation of the numerical solution for the vertical evolution. A default value of 5 Pa is used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list including the following values:
</p>
<table>
<tr><td><code>Plcl</code></td>
<td>
<p>The pressure at LCL (Pa).</p>
</td></tr>
<tr><td><code>Tlcl</code></td>
<td>
<p>The temperature at LCL (K).</p>
</td></tr>
<tr><td><code>wlcl</code></td>
<td>
<p>The mixing ratio at LCL (kg/kg).</p>
</td></tr>
<tr><td><code>thetalcl</code></td>
<td>
<p>The potential temperature at LCL (K).</p>
</td></tr>
<tr><td><code>gotit</code></td>
<td>
<p>0 or 1 whether the particle arrived or not to saturation (LCL) before arriving to Ptop.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>Ptop=50000
P0=101325
T0=273.15
w0=0.0025
deltaP=5
rh=100*w0/saturation_mixing_ratio(P0,T0,export_constants())
fndlcl=find_lcl(Ptop,P0,T0,w0,deltaP)
</code></pre>

<hr>
<h2 id='fixedlines'>
Data for plotting the lines of the thermodynamic (STUVE) diagram
</h2><span id='topic+fixedlines'></span>

<h3>Description</h3>

<p>The vectors included in the list are: both components of the pseudoadiabatic lines (adiabatic_x_T, and adiabatic_y_T), labels of the pseudoadiabatic lines (adiabatic_z_T), both components of the dry adiabatic lines (theta_x_T and theta_y_T), both components of the constant mixing ratio lines (wsat_x_T and wsat_y_T) and their labels (wsat_z_T). The X components are provided in Celsius and the Y components in hPa. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fixedlines)</code></pre>


<h3>Details</h3>

<p>The pseudoadiabatic lines were calculated by the authors for this R-package following pseudoadiabatic evolutions from 1050 hPa. 
</p>
<p>The dry adiabatic lines were obtained using the functions in <em>aiRthermo</em> for different initial conditions and for a fixed set of initial potential temperatures. A similar procedure was applied on the calculation of the constant mixing ratio lines, starting from different values of saturation mixing ratio.
</p>


<h3>Source</h3>

<p>The data were calculated by the authors for this R-package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+export_lines">export_lines</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fixedlines)
</code></pre>

<hr>
<h2 id='gamma_saturated'>
Saturated Adiabat Gamma
</h2><span id='topic+gamma_saturated'></span>

<h3>Description</h3>

<p>Saturated adiabat at the points of the sounding as computed internally, considering hydrostatic balance and as <code class="reqn">\frac{dT}{dP}</code> (in pressure levels) (K/Pa).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamma_saturated(Ps, Temps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gamma_saturated_+3A_ps">Ps</code></td>
<td>

<p>A vector with pressure values (Pa).
</p>
</td></tr>
<tr><td><code id="gamma_saturated_+3A_temps">Temps</code></td>
<td>

<p>A vector with temperature values (K).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the vertical derivate <code class="reqn">\Gamma _s= \frac{dT}{dP} \Big|_s</code> for a saturated adiabatic evolution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aPs&lt;-RadiosondeA[,1]*100
aTs&lt;-C2K(RadiosondeA[,3])
gamma_saturated(aPs,aTs)
</code></pre>

<hr>
<h2 id='K2C'>
From Kelvin to Celsius degrees
</h2><span id='topic+K2C'></span>

<h3>Description</h3>

<p>This function makes the transformation from Kelvin degrees to Celsius.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>K2C(Tk, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K2C_+3A_tk">Tk</code></td>
<td>

<p>A vector of temperatures in Kelvin degrees.
</p>
</td></tr>
<tr><td><code id="K2C_+3A_consts">consts</code></td>
<td>

<p>This function uses the <code class="reqn">T_0</code> constant corresponding to 0 degree Celsius as K.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector of temperatures in Celsius degrees.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aiRthermoConstants">aiRthermoConstants</a></code> and <code><a href="#topic+C2K">C2K</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dTs&lt;-RadiosondeD[,3]
K2C(C2K(dTs))
</code></pre>

<hr>
<h2 id='Kindex'>
K Instability Index
</h2><span id='topic+Kindex'></span>

<h3>Description</h3>

<p>This function calculates the K instability index (Celsius) from a sounding given by the measured arrays pressure Ps (Pa) temperature Ts (K) and mixing ratio ws (kg/kg).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kindex(Ps, Ts, ws, doLog = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kindex_+3A_ps">Ps</code></td>
<td>

<p>A vector with pressure values (Pa) measured by the radiosonde.
</p>
</td></tr>
<tr><td><code id="Kindex_+3A_ts">Ts</code></td>
<td>

<p>A vector with temperature values (K) measured by the radiosonde.
</p>
</td></tr>
<tr><td><code id="Kindex_+3A_ws">ws</code></td>
<td>

<p>A vector with mixing ratio values (kg/kg) measured by the radiosonde.
</p>
</td></tr>
<tr><td><code id="Kindex_+3A_dolog">doLog</code></td>
<td>

<p>Use logarithmic vertical interpolation between sounding levels. The default value is 0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If needed levels (850, 700 and 500 hPa) are not found in the input sounding (without extrapolation), the function returns -99999999.
</p>
<p>Use/do not use logarithmic interpolation in pressure (if needed because mandatory levels such as 700 hPa or 500 hPa are not given in the sounding) when finding the requested levels.
</p>


<h3>Value</h3>

<p>This function returns the K index.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aPs&lt;-RadiosondeA[,1]*100
aTs&lt;-C2K(RadiosondeA[,3])
aws&lt;-RadiosondeA[,6]/1000
aK&lt;-Kindex(aPs,aTs,aws,0)

data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dws&lt;-RadiosondeD[,6]/1000
dK&lt;-Kindex(dPs,dTs,dws,0)
</code></pre>

<hr>
<h2 id='latent_heat_H2O'>
Latent heat of vaporization or sublimation of water
</h2><span id='topic+latent_heat_H2O'></span>

<h3>Description</h3>

<p>This function calculates the latent heat of vaporization or sublimation of water depending as a function of temperature. It uses a polynomial approximation over water or ice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>latent_heat_H2O(Temps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="latent_heat_H2O_+3A_temps">Temps</code></td>
<td>

<p>A vector with temperature values (K).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Taking into account the observed values in tables from Rogers and Yau (1989) and Feistel and Wagner (2006), a polynomial model is used to calculate the latent heat at different temperatures.
</p>


<h3>Value</h3>

<p>This function returns the latent heat of vaporization or sublimation of water.
</p>


<h3>References</h3>

<p>Rogers, R. R., and  Yau, M. K. (1989). A Short Course in Cloud Physics, 3rd Edition, Pergamon Press, Oxford.
</p>
<p>Feistel, R. and Wagner, W. (2006). A new equation of state for H2O ice Ih, Journal of Physical and Chemical Reference Data 35 1021-1047. doi:10.1063/1.2183324.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aTs&lt;-C2K(RadiosondeA[,3])
latent_heat_H2O(aTs) 
</code></pre>

<hr>
<h2 id='LIindex'>
Lifted index 
</h2><span id='topic+LIindex'></span>

<h3>Description</h3>

<p>This function calculates the instability parameter Lifted index (Celsius) from pressure, temperature and mixing ratio values described by a vertical sounding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LIindex(Ps, Ts, ws, Psurface, deltaP, PWIDTH, doLog = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LIindex_+3A_ps">Ps</code></td>
<td>

<p>Pressure (Pa) of the sounding.
</p>
</td></tr>
<tr><td><code id="LIindex_+3A_ts">Ts</code></td>
<td>

<p>Temperature (K) of the sounding.
</p>
</td></tr>
<tr><td><code id="LIindex_+3A_ws">ws</code></td>
<td>

<p>Mixing ratio (kg/kg) of the sounding.
</p>
</td></tr>
<tr><td><code id="LIindex_+3A_psurface">Psurface</code></td>
<td>

<p>Surface pressure (Pa). If not available, the first level of the sounding can be used.
</p>
</td></tr>
<tr><td><code id="LIindex_+3A_deltap">deltaP</code></td>
<td>

<p>The width (Pa) of the layers used in the numerical solution of the vertical evolution (integration of the ODE). A default value of 5 Pa is used. It must be positive.
</p>
</td></tr>
<tr><td><code id="LIindex_+3A_pwidth">PWIDTH</code></td>
<td>

<p>PWIDTH represents the width (Pa) of the lower layer that will be averaged for P, T and w in order to calculate a &quot;mixed-layer&quot; average parcel that will be used for the vertical evolution. Typically 5000-10000 Pa are used.
</p>
</td></tr>
<tr><td><code id="LIindex_+3A_dolog">doLog</code></td>
<td>

<p>Use logarithmic vertical interpolation between sounding levels if doLog=1. It is not used by default (doLog=0).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the 500 hPa needed level is not exactly found in the input sounding, logarithmic/linear
vertical interpolation is run to get the corresponding T/w from the Ps/Ts/ws depending on the value of doLog 0/1.
</p>
<p>The evolution of the lifted particle is computed by integrating the dT/dP ordinary differential equation (applying the Runge-Kutta 4th order method), that represents the vertical adiabatic evolution from the initial condition to 500 hPa using a pressure step deltaP (Pa). The vertical adiabatic evolution is either dry (before saturation) or pseudoadiabatic at every vertical step with a correction for moisture in <code class="reqn">c_p</code> using the value of the mixing ratio (<code class="reqn">c_{pm}</code> as in Tsonis, eq 7.11).
</p>
<p>If the sounding does not enclose the needed level of 500 hPa and the interpolation fails, the function returns -99999999.
</p>


<h3>Value</h3>

<p>This function returns the LI index (Celsius).
</p>


<h3>References</h3>

<p>Tsonis, A. A. (2002). An Introduction to Atmospheric Thermodynamics, Cambridge University Press, Cambridge. Eq. 7.11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aPs&lt;-RadiosondeA[,1]*100
aTs&lt;-C2K(RadiosondeA[,3])
aws&lt;-RadiosondeA[,6]/1000
LIindex(aPs,aTs,aws,max(aPs),5,2500,0)
</code></pre>

<hr>
<h2 id='moistAdiabaticLapseRate'>
Moist Adiabatic Lapse Rate 
</h2><span id='topic+moistAdiabaticLapseRate'></span>

<h3>Description</h3>

<p>This function calculates the moist adiabatic lapse rate according to a provided mixing ratio (kg/kg) (Tsonis, eq 7.29).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moistAdiabaticLapseRate(w, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moistAdiabaticLapseRate_+3A_w">w</code></td>
<td>

<p>A vector with mixing ratio values (kg/kg).
</p>
</td></tr>
<tr><td><code id="moistAdiabaticLapseRate_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with the moist adiabatic lapse rate (dry adiabatic lapse rate with correction of <code class="reqn">c_p</code> due to the water vapour in moist air).
</p>


<h3>References</h3>

<p>Tsonis, A. A. (2002). An Introduction to Atmospheric Thermodynamics, Cambridge University Press, Cambridge. Eq. 7.29.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aws&lt;-RadiosondeA[,6]/1000
moistAdiabaticLapseRate(aws)
</code></pre>

<hr>
<h2 id='moistCp'>
Moist Cp
</h2><span id='topic+moistCp'></span>

<h3>Description</h3>

<p>This function corrects the value of dry <code class="reqn">c_p</code> due to the existence of water vapour acording to equation 7.11 from Tsonis (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moistCp(w, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moistCp_+3A_w">w</code></td>
<td>

<p>A vector with mixing ratio values (kg/kg).
</p>
</td></tr>
<tr><td><code id="moistCp_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the value of dry <code class="reqn">c_p</code> corrected by the mixing ratio.
</p>


<h3>References</h3>

<p>Tsonis, A. A. (2002). An Introduction to Atmospheric Thermodynamics, Cambridge University Press, Cambridge. Eq. 7.11.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+w2q">w2q</a></code> and 
<code><a href="#topic+moistCv">moistCv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dws&lt;-RadiosondeD[,6]/1000
moistCp(dws)
</code></pre>

<hr>
<h2 id='moistCv'>
Moist cv value
</h2><span id='topic+moistCv'></span>

<h3>Description</h3>

<p>This function is similar to <code><a href="#topic+moistCp">moistCp</a></code> but for <code class="reqn">c_v</code>. In this case, it is the value of <code class="reqn">c_v</code> corrected due to the existence of water vapour (equation 7.12) from Tsonis (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moistCv(w, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moistCv_+3A_w">w</code></td>
<td>

<p>A vector with mixing ratio values (kg/kg).
</p>
</td></tr>
<tr><td><code id="moistCv_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the value of <code class="reqn">c_v</code> corrected due to the existence of water vapour.
</p>


<h3>References</h3>

<p>Tsonis, A. A. (2002). An Introduction to Atmospheric Thermodynamics, Cambridge University Press, Cambridge. Eq. 7.12.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+w2q">w2q</a></code> and <code><a href="#topic+moistCp">moistCp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dws&lt;-RadiosondeD[,6]/1000
moistCv(dws)
</code></pre>

<hr>
<h2 id='parcelState'>
State of a parcel 
</h2><span id='topic+parcelState'></span>

<h3>Description</h3>

<p>The function calculates the state of a parcel for easier computations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parcelState(Press, Temp, w = 0, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parcelState_+3A_press">Press</code></td>
<td>

<p>Value of pressure (Pa) of the parcel.
</p>
</td></tr>
<tr><td><code id="parcelState_+3A_temp">Temp</code></td>
<td>

<p>Value of temperature (K) of the parcel.
</p>
</td></tr>
<tr><td><code id="parcelState_+3A_w">w</code></td>
<td>

<p>Value of mixing ratio (kg/kg) of the parcel.
</p>
</td></tr>
<tr><td><code id="parcelState_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list including the following values:
</p>
<table>
<tr><td><code>pressure</code></td>
<td>
 
<p>Pressure value (Pa).
</p>
</td></tr>
<tr><td><code>temperature</code></td>
<td>
 
<p>Temperature value (K).
</p>
</td></tr>
<tr><td><code>mixingratio</code></td>
<td>
 
<p>Mixing ratio value (kg/kg).
</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
 
<p>Potential temperature value (K).
</p>
</td></tr>
<tr><td><code>virtualTemp</code></td>
<td>
 
<p>Virtual temperature value (K).
</p>
</td></tr>
<tr><td><code>saturationMixingRatio</code></td>
<td>
 
<p>Saturation mixing ratio value (kg/kg).
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+PT2Theta">PT2Theta</a></code>, <code><a href="#topic+virtual_temperature">virtual_temperature</a></code> and
<code><a href="#topic+saturation_mixing_ratio">saturation_mixing_ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>parcelState(101325,273.15,0.2)
</code></pre>

<hr>
<h2 id='PT2Theta'>
Potential Temperature from pressure and temperature
</h2><span id='topic+PT2Theta'></span>

<h3>Description</h3>

<p>This function calculates the potential temperature from given temperature and pressure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PT2Theta(P, Temp, w = 0, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PT2Theta_+3A_p">P</code></td>
<td>

<p>A vector with pressure values (Pa).
</p>
</td></tr>
<tr><td><code id="PT2Theta_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values (K).
</p>
</td></tr>
<tr><td><code id="PT2Theta_+3A_w">w</code></td>
<td>

<p>A vector with mixing ratio values (kg/kg). Default value 0.
</p>
</td></tr>
<tr><td><code id="PT2Theta_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with potencial temperature. Mixing ratio is only used to correct the value of <code class="reqn">c_p</code>, not to calculate a moist adiabatic evolution.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+moistCp">moistCp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dThetas=PT2Theta(dPs,dTs)
</code></pre>

<hr>
<h2 id='PTheta2T'>
Temperature from pressure and potential temperature
</h2><span id='topic+PTheta2T'></span>

<h3>Description</h3>

<p>This function calculates the temperature from a given pressure and potential temperature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PTheta2T(P, Theta, w = 0, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PTheta2T_+3A_p">P</code></td>
<td>

<p>A vector with pressure values (Pa).
</p>
</td></tr>
<tr><td><code id="PTheta2T_+3A_theta">Theta</code></td>
<td>

<p>A vector with potential temperature (K).
</p>
</td></tr>
<tr><td><code id="PTheta2T_+3A_w">w</code></td>
<td>

<p>A vector with mixing ratio values (kg/kg). Default value 0.
</p>
</td></tr>
<tr><td><code id="PTheta2T_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with temperatures (K).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+moistCp">moistCp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dThetas=PT2Theta(dPs,dTs)
PTheta2T(dPs,dThetas)
</code></pre>

<hr>
<h2 id='PW'>
Vertically integrated water vapour column
</h2><span id='topic+PW'></span>

<h3>Description</h3>

<p>This function calculates the vertically integrated water vapour column integrating in pressure vertical coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PW(w, PRES, Psurf, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PW_+3A_w">w</code></td>
<td>

<p>A vector with mixing ratio values of a sounding (kg/kg).
</p>
</td></tr>
<tr><td><code id="PW_+3A_pres">PRES</code></td>
<td>

<p>A vector with pressure values of a sounding (Pa).
</p>
</td></tr>
<tr><td><code id="PW_+3A_psurf">Psurf</code></td>
<td>

<p>Is the mean sea level pressure at the place of a sounding (Pa).
</p>
</td></tr>
<tr><td><code id="PW_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the vertically integrated water vapour column.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dws&lt;-RadiosondeD[,6]/1000
PW(dws,dPs,dPs[1])
</code></pre>

<hr>
<h2 id='q2e'>
Partial Vapour Pressure 
</h2><span id='topic+q2e'></span>

<h3>Description</h3>

<p>This function calculates the partial vapour pressure from specific humidity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q2e(P, q, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="q2e_+3A_p">P</code></td>
<td>

<p>A vector with pressure values (Pa).
</p>
</td></tr>
<tr><td><code id="q2e_+3A_q">q</code></td>
<td>

<p>A vector with specific humidity values (kg/kg).
</p>
</td></tr>
<tr><td><code id="q2e_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the value of the partial vapour pressure (Pa).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Get partial pressure of water vapour
data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dws&lt;-RadiosondeD[,6]/1000
h2oe&lt;-q2e(dPs,w2q(dws))
</code></pre>

<hr>
<h2 id='q2w'>
Water vapour mixing Ratio to specific humidity
</h2><span id='topic+q2w'></span>

<h3>Description</h3>

<p>This function calculates the water vapour mixing ratio (kg/kg) from specific humidity (kg/kg).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q2w(q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="q2w_+3A_q">q</code></td>
<td>

<p>A vector with specific humidity values (kg/kg).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with mixing ratio values in kg/kg.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dws&lt;-RadiosondeD[,6]/1000
q2w(w2q(dws))
</code></pre>

<hr>
<h2 id='RadiosondeA'>
Radiosonde A
</h2><span id='topic+RadiosondeA'></span>

<h3>Description</h3>

<p>Contains the information measured by a sounding in Santander (Station 08023) in 2010, June 16th at 12:00 UTC. It was not a really unstable day but a great amount of (large scale) precipitation was measured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("RadiosondeA")</code></pre>


<h3>Format</h3>

<p>A data frame with 74 observations on the following 11 variables.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>a vector with pressure values (hPa).</p>
</dd>
<dt><code>V2</code></dt><dd><p>a vector with height (m).</p>
</dd>
<dt><code>V3</code></dt><dd><p>a vector with temperature values (Celsius).</p>
</dd>
<dt><code>V4</code></dt><dd><p>a vector with dew point temperature values (Celsius).</p>
</dd>
<dt><code>V5</code></dt><dd><p>a vector with relative humidity values (%).</p>
</dd>
<dt><code>V6</code></dt><dd><p>a vector with mixing ratio values (g/kg).</p>
</dd>
<dt><code>V7</code></dt><dd><p>a vector with wind direction values (degrees).</p>
</dd>
<dt><code>V8</code></dt><dd><p>a vector with wind speed values (knots).</p>
</dd>
<dt><code>V9</code></dt><dd><p>a vector with potential temperature (K). </p>
</dd>
<dt><code>V10</code></dt><dd><p>a vector with equivalent potential temperature (K). </p>
</dd>
<dt><code>V11</code></dt><dd><p>a vector with virtual potential temperature (K). </p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+RadiosondeD">RadiosondeD</a></code> and <code><a href="#topic+RadiosondeDavenport">RadiosondeDavenport</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
#Calculate the pressure in Pa
RadiosondeA$V1*100

#Calculate the temperature in K
C2K(RadiosondeA$V3)
</code></pre>

<hr>
<h2 id='RadiosondeD'>
Radiosonde D
</h2><span id='topic+RadiosondeD'></span>

<h3>Description</h3>

<p>Contains the information measured by a sounding in Barcelona (station 05190) in 2013, August 7th at 12:00 UTC. According to the university of Wyoming, the CAPE was higher than 3000 J/kg and a great amount of (convective) precipitation was measured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("RadiosondeD")</code></pre>


<h3>Format</h3>

<p>A data frame with 70 observations on the following 11 variables.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>a vector with pressure values (hPa).</p>
</dd>
<dt><code>V2</code></dt><dd><p>a vector with height (m).</p>
</dd>
<dt><code>V3</code></dt><dd><p>a vector with temperature values (Celsius).</p>
</dd>
<dt><code>V4</code></dt><dd><p>a vector with dew point temperature values (Celsius).</p>
</dd>
<dt><code>V5</code></dt><dd><p>a vector with relative humidity values (%).</p>
</dd>
<dt><code>V6</code></dt><dd><p>a vector with mixing ratio values (g/kg).</p>
</dd>
<dt><code>V7</code></dt><dd><p>a vector with wind direction values (degrees).</p>
</dd>
<dt><code>V8</code></dt><dd><p>a vector with wind speed values (knots).</p>
</dd>
<dt><code>V9</code></dt><dd><p>a vector with potential temperature (K). </p>
</dd>
<dt><code>V10</code></dt><dd><p>a vector with equivalent potential temperature (K). </p>
</dd>
<dt><code>V11</code></dt><dd><p>a vector with virtual potential temperature (K). </p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+RadiosondeA">RadiosondeA</a></code> and <code><a href="#topic+RadiosondeDavenport">RadiosondeDavenport</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
#Calculate the pressure in Pa
RadiosondeD$V1*100

#Calculate the temperature in K
C2K(RadiosondeD$V3)
</code></pre>

<hr>
<h2 id='RadiosondeDavenport'>
Radiosonde Davenport
</h2><span id='topic+RadiosondeDavenport'></span>

<h3>Description</h3>

<p>Contains the information measured by a sounding in Davenport (station 74455) in 1997, June 21st at 00:00 UTC. That day was a very unstable situation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("RadiosondeDavenport")</code></pre>


<h3>Format</h3>

<p>A data frame with 67 observations on the following 11 variables.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>a vector with pressure values (hPa).</p>
</dd>
<dt><code>V2</code></dt><dd><p>a vector with height (m).</p>
</dd>
<dt><code>V3</code></dt><dd><p>a vector with temperature values (Celsius).</p>
</dd>
<dt><code>V4</code></dt><dd><p>a vector with dew point temperature values (Celsius).</p>
</dd>
<dt><code>V5</code></dt><dd><p>a vector with relative humidity values (%).</p>
</dd>
<dt><code>V6</code></dt><dd><p>a vector with mixing ratio values (g/kg).</p>
</dd>
<dt><code>V7</code></dt><dd><p>a vector with wind direction values (degrees).</p>
</dd>
<dt><code>V8</code></dt><dd><p>a vector with wind speed values (knots).</p>
</dd>
<dt><code>V9</code></dt><dd><p>a vector with potential temperature (K). </p>
</dd>
<dt><code>V10</code></dt><dd><p>a vector with equivalent potential temperature (K). </p>
</dd>
<dt><code>V11</code></dt><dd><p>a vector with virtual potential temperature (K). </p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+RadiosondeA">RadiosondeA</a></code> and <code><a href="#topic+RadiosondeD">RadiosondeD</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeDavenport)
#Calculate the pressure in Pa
RadiosondeDavenport$V1*100

#Calculate the temperature in K
C2K(RadiosondeDavenport$V3)
</code></pre>

<hr>
<h2 id='rh2shum'>
Specific Humidity from relative humidity
</h2><span id='topic+rh2shum'></span>

<h3>Description</h3>

<p>This function calculates the specific humidity from a given relative humidity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rh2shum(P, Temp, rh, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rh2shum_+3A_p">P</code></td>
<td>

<p>A vector with pressure values (Pa).
</p>
</td></tr>
<tr><td><code id="rh2shum_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values (Kelvin).
</p>
</td></tr>
<tr><td><code id="rh2shum_+3A_rh">rh</code></td>
<td>

<p>A vector with relative humidity values (%).
</p>
</td></tr>
<tr><td><code id="rh2shum_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with specific humidity (kg/kg).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rh2shum">rh2shum</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dws&lt;-RadiosondeD[,6]/1000
dTds&lt;-w2Td(dPs,dws)
rhs&lt;-TTdP2rh(dTs,dTds,dPs)
rh2shum(dPs,dTs,rhs)
</code></pre>

<hr>
<h2 id='rh2w'>
Mixing Ratio from relative humidity
</h2><span id='topic+rh2w'></span>

<h3>Description</h3>

<p>This function gets the mixing ratio (kg/kg) from a given relative humidity (%), pressure (Pa) and temperature (K).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rh2w(P, Temp, rh, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rh2w_+3A_p">P</code></td>
<td>

<p>A vector with pressure values in Pa.
</p>
</td></tr>
<tr><td><code id="rh2w_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values in Kelvin.
</p>
</td></tr>
<tr><td><code id="rh2w_+3A_rh">rh</code></td>
<td>

<p>A vector with relative humidity values in (%).
</p>
</td></tr>
<tr><td><code id="rh2w_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with mixing ratio values (kg/kg).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saturation_mixing_ratio">saturation_mixing_ratio</a>
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dws&lt;-RadiosondeD[,6]/1000
dTds&lt;-w2Td(dPs,dws)
rhs&lt;-TTdP2rh(dTs,dTds,dPs)
wfromrh&lt;-rh2w(dPs,dTs,rhs)
</code></pre>

<hr>
<h2 id='saturation_mixing_ratio'>
Saturation Mixing Ratio
</h2><span id='topic+saturation_mixing_ratio'></span>

<h3>Description</h3>

<p>This function calculates the saturation mixing ratio from a given temperature and pressure.</p>


<h3>Usage</h3>

<pre><code class='language-R'>saturation_mixing_ratio(P, Temp, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="saturation_mixing_ratio_+3A_p">P</code></td>
<td>

<p>A vector with pressure values in Pa.
</p>
</td></tr>
<tr><td><code id="saturation_mixing_ratio_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values in Kelvin.
</p>
</td></tr>
<tr><td><code id="saturation_mixing_ratio_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with saturation mixing ratio values (kg/kg).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
saturation_mixing_ratio(dPs,dTs)
</code></pre>

<hr>
<h2 id='saturation_pressure_H2O'>
Saturation Pressure
</h2><span id='topic+saturation_pressure_H2O'></span>

<h3>Description</h3>

<p>This function returns the saturation pressure (Pa) from a given array of temperatures (K). It uses approximate equations 5.67 and 5.70 in Bohren Albrecht, 1998.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saturation_pressure_H2O(Temps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="saturation_pressure_H2O_+3A_temps">Temps</code></td>
<td>

<p>A vector with temperature values in Kelvin.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Saturation pressure of water vapour <code class="reqn">e_s</code> is computed over ice/water depending whether the temperature is over/under 273.15 K (0 degree Celsius) at every element of the array.
</p>


<h3>Value</h3>

<p>This function returns a vector with saturation pressure values (Pa).
</p>


<h3>References</h3>

<p>Bohren, C.F., &amp; Albrecht, B. A. (1998). Atmospheric thermodynamics. Atmospheric thermodynamics. Publisher: New York; Oxford: Oxford University Press, 1998. ISBN: 0195099044. Equations 5.67 and 5.70. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aTs&lt;-C2K(RadiosondeA[,3])
esats&lt;-saturation_pressure_H2O(aTs)
</code></pre>

<hr>
<h2 id='Sindex'>
Showalter Instability Index 
</h2><span id='topic+Sindex'></span>

<h3>Description</h3>

<p>This function computes Showalter instability index (Celsius) from given parameters from a vertical sounding pressure (Pa), temperature (K) and mixing ratio (kg/kg).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sindex(Ps, Ts, ws, deltaP, doLog = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sindex_+3A_ps">Ps</code></td>
<td>

<p>A vector with pressure values in Pa.
</p>
</td></tr>
<tr><td><code id="Sindex_+3A_ts">Ts</code></td>
<td>

<p>A vector with temperature values in Kelvin.
</p>
</td></tr>
<tr><td><code id="Sindex_+3A_ws">ws</code></td>
<td>

<p>A vector with mixing ratio values in kg/kg.
</p>
</td></tr>
<tr><td><code id="Sindex_+3A_deltap">deltaP</code></td>
<td>

<p>The width (Pa) of the layers used in the numerical solution of the vertical evolution.
</p>
</td></tr>
<tr><td><code id="Sindex_+3A_dolog">doLog</code></td>
<td>

<p>Use logarithmic vertical interpolation between sounding levels. A default value is 0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the needed levels (850 hPa or 500 hPa) are not exactly found in the input sounding, logarithmic/linear vertical interpolation is run to get the corresponding T/w from the Ps/Ts/ws depending on the value of doLog (TRUE or FALSE).
</p>
<p>The evolution of the lifted particle is computed by integrating the dT/dP ordinary differential equation (applying the Runge Kutta 4th order method) that represents the vertical adiabatic evolution from 850 hPa to 500 hPa using a pressure step dP &gt; 0 (Pa). The vertical adiabatic evolution is either dry (before saturation) or pseudoadiabatic at every vertical step with a correction for moisture in the specific heat at constant pressure <code class="reqn">c_p</code> during the dry steps (as in Tsonis, eq 7.11).
</p>
<p>If the sounding does not enclose the needed levels and the interpolation fails, the function returns -99999999.
</p>


<h3>Value</h3>

<p>This function returns the Showalter instability index (Celsius).
</p>


<h3>References</h3>

<p>Djuric D. (1994). Weather Analysis, Prentice Hall, New Jersey.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LIindex">LIindex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aPs&lt;-RadiosondeA[,1]*100
aTs&lt;-C2K(RadiosondeA[,3])
aws&lt;-RadiosondeA[,6]/1000
S&lt;-Sindex(aPs,aTs,aws,5,0)
</code></pre>

<hr>
<h2 id='stuve_diagram'>
Thermodynamic (STUVE) Diagram
</h2><span id='topic+stuve_diagram'></span>

<h3>Description</h3>

<p>This function generates an Stüve diagram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stuve_diagram(Pres, Temp, TempD = NA, XLIM = c(-80, 45), YLIM = c(1050, 100), 
col.lines = NULL, lty.lines = NULL, lwd.lines = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stuve_diagram_+3A_pres">Pres</code></td>
<td>

<p>A vector with pressure values in hPa.
</p>
</td></tr>
<tr><td><code id="stuve_diagram_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values in Celsius .
</p>
</td></tr>
<tr><td><code id="stuve_diagram_+3A_tempd">TempD</code></td>
<td>

<p>An optional vector with dew point temperatures in Celsius. The default value is NA.
</p>
</td></tr>
<tr><td><code id="stuve_diagram_+3A_xlim">XLIM</code></td>
<td>

<p>X axis limit in Celsius. Default value is c(-80, 45).
</p>
</td></tr>
<tr><td><code id="stuve_diagram_+3A_ylim">YLIM</code></td>
<td>

<p>Y axis limit in hPa. Default value is c(1050, 100).
</p>
</td></tr>
<tr><td><code id="stuve_diagram_+3A_col.lines">col.lines</code></td>
<td>

<p>A vector of colours for the stuve_diagram lines. They must be provided in this order: isotherms, isobars, dry adiabats, moist adiabats, constant mixing ratio lines and sounding. Default colours are c(&quot;grey&quot;, &quot;grey&quot;, &quot;olivedrab&quot;, &quot;olivedrab&quot;, &quot;brown&quot;, &quot;red&quot;). 
</p>
</td></tr>
<tr><td><code id="stuve_diagram_+3A_lty.lines">lty.lines</code></td>
<td>

<p>A vector of line-types for the stuve_diagram. They must be provided following the same order as for the col.lines argument. Default values are c(&quot;dotted&quot;, &quot;dotted&quot;, &quot;dotted&quot;, &quot;solid&quot;, &quot;dotted&quot;, &quot;solid&quot;).
</p>
</td></tr>
<tr><td><code id="stuve_diagram_+3A_lwd.lines">lwd.lines</code></td>
<td>

<p>A vector of line-widths for the stuve_diagram. They must be provided following the same order as for the col.lines and lty.lines arguments. Default values are c(2,2,2,1,2,1).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is possible to add extra lines and to save as a pdf, jpeg or png (see examples).
</p>


<h3>Value</h3>

<p>The result is a plot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeA)
aPs&lt;-RadiosondeA[,1]*100
aTs&lt;-C2K(RadiosondeA[,3])
aws&lt;-RadiosondeA[,6]/1000
capeCin&lt;-CAPE_CIN(PlowTop=98000,precoolType="adiabatic",
                  Ps=aPs,Ts=aTs,ws=aws,doLog=0,deltaP=5,
                  getLiftedBack=TRUE,upToTop=TRUE)

#How to add a line to the plot
stuveA&lt;-stuve_diagram(Pres = aPs/100,Temp=aTs-273.15)
lines(capeCin$Tl-273.15,capeCin$Pl/100,col="blue",lwd=2)
</code></pre>

<hr>
<h2 id='TTdP2rh'>
Relative Humidity from temperature, pressure and dew point temperature
</h2><span id='topic+TTdP2rh'></span>

<h3>Description</h3>

<p>This function calculates the relative humidity from given temperature, dew point temperature and pressure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTdP2rh(Temp, Td, P, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TTdP2rh_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values in Kelvin.
</p>
</td></tr>
<tr><td><code id="TTdP2rh_+3A_td">Td</code></td>
<td>

<p>A vector with dew point temperature in Kelvin.
</p>
</td></tr>
<tr><td><code id="TTdP2rh_+3A_p">P</code></td>
<td>

<p>A vector with pressure values in Pa.
</p>
</td></tr>
<tr><td><code id="TTdP2rh_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with relative humidity values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saturation_mixing_ratio">saturation_mixing_ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dws&lt;-RadiosondeD[,6]/1000
dTds&lt;-w2Td(dPs,dws)
rhs&lt;-TTdP2rh(dTs,dTds,dPs)

</code></pre>

<hr>
<h2 id='TTheta2P'>
Pressure from temperature and potential temperature
</h2><span id='topic+TTheta2P'></span>

<h3>Description</h3>

<p>This function calculates the pressure from given potential temperature and temperature, assuming a dry adiabatic evolution (mixing ratio is only used to correct the values of <code class="reqn">c_p</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTheta2P(Temp, Theta, w = 0, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TTheta2P_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values in Kelvin.
</p>
</td></tr>
<tr><td><code id="TTheta2P_+3A_theta">Theta</code></td>
<td>

<p>A vector with potential temperature values in Kelvin.
</p>
</td></tr>
<tr><td><code id="TTheta2P_+3A_w">w</code></td>
<td>

<p>Initial value of mixing ratio (kg/kg). By default 0.
</p>
</td></tr>
<tr><td><code id="TTheta2P_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with pressure values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dws&lt;-RadiosondeD[,6]/1000
dTds&lt;-w2Td(dPs,dws)
dThetas&lt;-PT2Theta(dPs,dTs)
TTheta2P(dTs,dThetas)

</code></pre>

<hr>
<h2 id='TTindex'>
Total-Totals Instability Index 
</h2><span id='topic+TTindex'></span>

<h3>Description</h3>

<p>Total-Totals instability index (Celsius) from parameters (1D arrays) Ps (pressure, Pa) Ts (temperature, Kelvin) and ws (mixing ratio, kg/kg) obtained from a vertical sounding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTindex(Ps, Ts, ws, doLog = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TTindex_+3A_ps">Ps</code></td>
<td>

<p>A vector with pressure values in Pa.
</p>
</td></tr>
<tr><td><code id="TTindex_+3A_ts">Ts</code></td>
<td>

<p>A vector with temperature values in Kelvin.
</p>
</td></tr>
<tr><td><code id="TTindex_+3A_ws">ws</code></td>
<td>

<p>A vector with mixing ratio values in kg/kg.
</p>
</td></tr>
<tr><td><code id="TTindex_+3A_dolog">doLog</code></td>
<td>

<p>Use logarithmic vertical interpolation between sounding levels. A default value is 0.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the needed levels (850 hPa or 500 hPa) are not exactly found in the input sounding, logarithmic/linear vertical interpolation is run depending on the value of doLog (TRUE or FALSE).
</p>
<p>If the sounding does not enclose the needed levels and the interpolation fails, the function returns -99999999.
</p>


<h3>Value</h3>

<p>This function returns the Total-Totals instability index (Celsius).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeDavenport)
aPs&lt;-RadiosondeDavenport[,1]*100
aTs&lt;-C2K(RadiosondeDavenport[,3])
aws&lt;-RadiosondeDavenport[,6]/1000
aTT&lt;-TTindex(aPs,aTs,aws,0)
</code></pre>

<hr>
<h2 id='virtual_temperature'>
Virtual Temperature
</h2><span id='topic+virtual_temperature'></span>

<h3>Description</h3>

<p>This function calculates the virtual temperature from given pressure and mixing ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>virtual_temperature(P, Temp, w, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="virtual_temperature_+3A_p">P</code></td>
<td>

<p>A vector with pressure values in Pa.
</p>
</td></tr>
<tr><td><code id="virtual_temperature_+3A_temp">Temp</code></td>
<td>

<p>A vector with temperature values in Kelvin.
</p>
</td></tr>
<tr><td><code id="virtual_temperature_+3A_w">w</code></td>
<td>

<p>A vector with mixing ratio values in kg/kg.
</p>
</td></tr>
<tr><td><code id="virtual_temperature_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with virtual temperature values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+q2e">q2e</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dTs&lt;-C2K(RadiosondeD[,3])
dws&lt;-RadiosondeD[,6]/1000
virtual_temperature(dPs,dTs,dws)
</code></pre>

<hr>
<h2 id='w2q'>
Specific Humidity from mixing ratio
</h2><span id='topic+w2q'></span>

<h3>Description</h3>

<p>This function calculates the specific humidity from a given Water mixing ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w2q(w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w2q_+3A_w">w</code></td>
<td>

<p>A vector with mixing ratio values in kg/kg.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a vector with the specific humidity.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dws&lt;-RadiosondeD[,6]/1000
w2q(dws)
</code></pre>

<hr>
<h2 id='w2Td'>
Dew point temperature from mixing ratio
</h2><span id='topic+w2Td'></span>

<h3>Description</h3>

<p>This function calculates the dew point temperature from given mixing ratio and pressure, following the APPROXIMATE expression 5.68 in Bohren and Albrech (1998).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w2Td(P, w, consts = export_constants())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w2Td_+3A_p">P</code></td>
<td>

<p>A vector with pressure values in Pa.
</p>
</td></tr>
<tr><td><code id="w2Td_+3A_w">w</code></td>
<td>

<p>A vector with mixing ratio (kg/kg).
</p>
</td></tr>
<tr><td><code id="w2Td_+3A_consts">consts</code></td>
<td>

<p>The constants defined in <em>aiRthermoConstants</em> data are necessary. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector with the dew point temperature.
</p>


<h3>References</h3>

<p>Bohren, C.F., &amp; Albrecht, B. A. (1998). Atmospheric thermodynamics. Atmospheric thermodynamics. Publisher: New York; Oxford: Oxford University Press, 1998. ISBN: 0195099044. Equation 5.68.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RadiosondeD)
dPs&lt;-RadiosondeD[,1]*100
dws&lt;-RadiosondeD[,6]/1000
w2Td(dPs,dws)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
