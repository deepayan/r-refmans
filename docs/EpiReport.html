<!DOCTYPE html><html lang="en"><head><title>Help for package EpiReport</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EpiReport}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AERparams'><p>Dataset describing the parameters for the epidemiological report production</p></a></li>
<li><a href='#body_replace_gg_at_bkm'><p>Replace a plot at a bookmark location</p></a></li>
<li><a href='#cleanECDCTable'><p>Cleaning the final table</p></a></li>
<li><a href='#cleanMeasureCode'><p>Clean the MeasureCode variable</p></a></li>
<li><a href='#DENGUE2019'><p>Dataset including Dengue data for 2015-2019</p></a></li>
<li><a href='#EcdcColors'><p>Colour palettes following the March 2018 ECDC guidelines for presentation of surveillance data</p></a></li>
<li><a href='#filterDisease'><p>Filter disease parameters</p></a></li>
<li><a href='#getAER'><p>Get full disease-specific epidemiological report</p></a></li>
<li><a href='#getAgeGender'><p>Get disease-specific age and gender bar graph</p></a></li>
<li><a href='#getMap'><p>Get disease-specific map: distribution of cases by Member State</p></a></li>
<li><a href='#getSeason'><p>Get disease-specific seasonality graph: distribution of cases by month</p></a></li>
<li><a href='#getTableByMS'><p>Get disease-specific table: distribution of cases by Member State (GeoCode)</p></a></li>
<li><a href='#getTemplate'><p>Get epidemiological report (empty) template</p></a></li>
<li><a href='#getTrend'><p>Get disease-specific trend plot: trend and number of cases by month</p></a></li>
<li><a href='#includeMap'><p>Including PNG map in the 'Microsoft Word' template</p></a></li>
<li><a href='#MSCode'><p>Dataset correspondence table between country names and country code</p></a></li>
<li><a href='#orderQuasinum'><p>Order 'quasinumerical' categorical vectors (increasing order)</p></a></li>
<li><a href='#plotAge'><p>Age bar graph</p></a></li>
<li><a href='#plotAgeGender'><p>Age and Gender bar graph</p></a></li>
<li><a href='#plotBar'><p>Bar graph</p></a></li>
<li><a href='#plotBarGrouped'><p>Grouped bar graph</p></a></li>
<li><a href='#plotBarGroupedH'><p>Horizontal grouped bar graph</p></a></li>
<li><a href='#plotBarH'><p>Horizontal bar graph</p></a></li>
<li><a href='#plotPie'><p>Pie chart</p></a></li>
<li><a href='#plotSeasonality'><p>Seasonality line graph</p></a></li>
<li><a href='#plotTS'><p>Time series plot</p></a></li>
<li><a href='#plotTS12MAvg'><p>Time series with 12-month moving average</p></a></li>
<li><a href='#plotTSGrouped'><p>Multiple time series plot</p></a></li>
<li><a href='#previewMap'><p>Previewing the PNG map</p></a></li>
<li><a href='#SALM2016'><p>Dataset including Salmonellosis data for 2012-2016</p></a></li>
<li><a href='#shapeECDCFlexTable'><p>Shaping the final table (layout, title, color, font)</p></a></li>
<li><a href='#toCapTitle'><p>Capitalise first letter</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Epidemiological Report</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-07-02</td>
</tr>
<tr>
<td>Description:</td>
<td>Drafting an epidemiological report in 'Microsoft Word' format for a given disease,
  similar to the Annual Epidemiological Reports published by the European Centre 
  for Disease Prevention and Control. Through standalone functions, it is specifically 
  designed to generate each disease specific output presented in these reports and includes:
  - Table with the distribution of cases by Member State over the last five years;
  - Seasonality plot with the distribution of cases at the European Union / European Economic Area level, 
  by month, over the past five years;
  - Trend plot with the trend and number of cases at the European Union / European Economic Area level, 
  by month, over the past five years;
  - Age and gender bar graph with the distribution of cases at the European Union / European Economic Area level.
  Two types of datasets can be used:
  - The default dataset of dengue 2015-2019 data;
  - Any dataset specified as described in the vignette.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://joinup.ec.europa.eu/software/page/eupl">EUPL version 1.1</a> | <a href="https://joinup.ec.europa.eu/software/page/eupl">EUPL version 1.2</a> [expanded from: EUPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>officer, flextable, zoo, png, dplyr, tidyr, tidyselect,
ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.20), rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers">https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-07-02 10:16:12 UTC; LMC</td>
</tr>
<tr>
<td>Author:</td>
<td>Lore Merdrignac [aut, ctr, cre] (Author of the package and original
    code),
  Tommi Karki [aut, fnd],
  Esther Kissling [aut, ctr],
  Joana Gomes Dias [aut, fnd] (Project manager)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lore Merdrignac &lt;l.merdrignac@epiconcept.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-07-05 16:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AERparams'>Dataset describing the parameters for the epidemiological report production</h2><span id='topic+AERparams'></span>

<h3>Description</h3>

<p>A dataset describing the parameters to be used for each output of each disease report
for all 53 health topics included in TESSy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AERparams
</code></pre>


<h3>Format</h3>

<p>A data frame with 53 rows (corresponding to the 53 health topics) and 24 variables:
</p>

<dl>
<dt>HealthTopic</dt><dd><p>Disease code that should match with the health topic code
from the disease-specific dataset  e.g. <code>ANTH</code>, <code>SALM</code>, etc.</p>
</dd>
<dt>DG</dt><dd><p>(optional) Disease group e.g. FWD</p>
</dd>
<dt>DP</dt><dd><p>(optional) Disease programme e.g. FWD</p>
</dd>
<dt>Label</dt><dd><p>Disease label to be used in the report e.g. salmonellosis, anthrax</p>
</dd>
<dt>FrequencyCategory</dt><dd><p>(optional) Frequency of the disease e.g. <code>VERY RARE</code>, <code>NON-RARE</code>, etc.</p>
</dd>
<dt>MeasurePopulation</dt><dd><p>Type of population presented for this disease i.e. <code>ALL</code> or <code>CONFIRMED</code> cases</p>
</dd>
<dt>DatePublicAtlas</dt><dd><p>Date of latest availability in the public access of the Atlas</p>
</dd>
<dt>TableUse</dt><dd><p>Type of table to present in the report i.e. <code>NO</code> table,
<code>ASR</code> table presenting age-standardised rates, <code>RATE</code> table presenting rates
or <code>COUNT</code> table presenting the number of cases only.</p>
</dd>
<dt>TableRatesLabel</dt><dd><p>Label to use in the table for rates e.g. <code>RATE PER 100000 POPULATION</code></p>
</dd>
<dt>TableRatesNoDecimals</dt><dd><p>Number of decimals to use when presenting rates</p>
</dd>
<dt>TableASRNoDecimals</dt><dd><p>Number of descimals to use when presenting ASR</p>
</dd>
<dt>AgeGenderUse</dt><dd><p>Type of age and gender bar graph to present i.e. <code>NO</code> graph,
<code>AG-COUNT</code> Bar graph presenting the number of cases by age and gender,
<code>AG-RATE</code> Bar graph presenting the rates of cases by age and gender,
<code>AG-PROP</code> Bar graph presenting the proportion of cases by age and gender,
<code>A-RATE</code> Bar graph presenting the rates of cases by age.</p>
</dd>
<dt>AgeGenderBarGraphLabel</dt><dd><p>Label to use in the age and gender bar graph</p>
</dd>
<dt>AgeGenderGraphNoDecimals</dt><dd><p>Number of decimals to use when presenting rates
in the age and gender bar graph</p>
</dd>
<dt>TSTrendGraphUse</dt><dd><p>Logical Y/N specifying whether to include a line graph
describing the trend of the disease over the time</p>
</dd>
<dt>TSSeasonalityGraphUse</dt><dd><p>Logical Y/N specifying whether to include
a line graph describing the seasonality of the disease</p>
</dd>
<dt>TSSpecific</dt><dd><p>Logical Y/N for specific line graph inclusion</p>
</dd>
<dt>MapNumbersUse</dt><dd><p>Logical Y/N specifying whether to include the map
presenting the number of cases by Member State</p>
</dd>
<dt>MapRatesUse</dt><dd><p>Logical Y/N specifying whether to include the map
presenting the rates of cases by Member State</p>
</dd>
<dt>MapRatesNoDecimals</dt><dd><p>(optional) Number of decimals to use for presenting maps</p>
</dd>
<dt>MapASRUse</dt><dd><p>Logical Y/N specifying whether to include the map
presenting the age-standardised rates of cases by Member State</p>
</dd>
<dt>MapASRNoDecimals</dt><dd><p>(optional) Number of decimals to use for presenting maps</p>
</dd>
<dt>Transmission</dt><dd><p>Not implemented yet</p>
</dd>
<dt>TransmissionNoDecimals</dt><dd><p>Not implemented yet</p>
</dd>
</dl>


<hr>
<h2 id='body_replace_gg_at_bkm'>Replace a plot at a bookmark location</h2><span id='topic+body_replace_gg_at_bkm'></span>

<h3>Description</h3>

<p>Replace a plot at a bookmark location saving it as a PNG file in a temporary
folder. <br />
A bookmark will be considered as valid if enclosing words within a paragraph;
i.e., a bookmark along two or more paragraphs is invalid,
a bookmark set on a whole paragraph is also invalid,
but bookmarking few words inside a paragraph is valid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_replace_gg_at_bkm(doc, gg, bookmark, width = 6, height = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="body_replace_gg_at_bkm_+3A_doc">doc</code></td>
<td>
<p>a docx device</p>
</td></tr>
<tr><td><code id="body_replace_gg_at_bkm_+3A_gg">gg</code></td>
<td>
<p>a ggplot object or any object that can be printed in grDevices::png()</p>
</td></tr>
<tr><td><code id="body_replace_gg_at_bkm_+3A_bookmark">bookmark</code></td>
<td>
<p>bookmark id</p>
</td></tr>
<tr><td><code id="body_replace_gg_at_bkm_+3A_width">width</code></td>
<td>
<p>the width of the device in inches</p>
</td></tr>
<tr><td><code id="body_replace_gg_at_bkm_+3A_height">height</code></td>
<td>
<p>the height of the device.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>doc
</p>


<h3>Examples</h3>

<pre><code class='language-R'>doc &lt;- officer::read_docx(path = file.path(system.file(package = "EpiReport"),
                                           "template/AER_template.docx" ))
p &lt;- EpiReport::getTrend()
doc &lt;- EpiReport::body_replace_gg_at_bkm(doc = doc,
                                         gg = p,
                                         bookmark = "TS_TREND",
                                         width = 6,
                                         height = 3)

</code></pre>

<hr>
<h2 id='cleanECDCTable'>Cleaning the final table</h2><span id='topic+cleanECDCTable'></span>

<h3>Description</h3>

<p>Cleaning the final table: identifying missing reports with <code>'-'</code>,
replacing the Member State codes with Member State names (see correspondence
table <code><a href="#topic+MSCode">MSCode</a></code>), identifying not reporting Member States with <code>'.'</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cleanECDCTable(
  x,
  Country = EpiReport::MSCode$Country,
  GeoCode = EpiReport::MSCode$GeoCode
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cleanECDCTable_+3A_x">x</code></td>
<td>
<p>dataframe, dataset to clean</p>
</td></tr>
<tr><td><code id="cleanECDCTable_+3A_country">Country</code></td>
<td>
<p>character vector, full names of the countries /
Member States (e.g. Austria, Belgium, etc.) that will replace the GeoCodes
included the x dataframe (Default <code>MSCode$Country</code>)</p>
</td></tr>
<tr><td><code id="cleanECDCTable_+3A_geocode">GeoCode</code></td>
<td>
<p>character vector, corresponding GeoCode of each Member State
(e.g. AT, BE, etc.) to replace with the country full names (Default <code>MSCode$GeoCode</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>cleaned ECDC dataframe
</p>


<h3>See Also</h3>

<p>Global function: <code><a href="#topic+getTableByMS">getTableByMS</a></code> <br />
Default dataset <code><a href="#topic+MSCode">MSCode</a></code>
</p>

<hr>
<h2 id='cleanMeasureCode'>Clean the MeasureCode variable</h2><span id='topic+cleanMeasureCode'></span>

<h3>Description</h3>

<p>Clean the MeasureCode variable and replace the specific codes with the generic ones <br />
(e.g. <code>ACCUTE.AGE_GENDER.RATE</code> will be replaced by <code>CONFIRMED.AGE_GENDER.RATE</code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cleanMeasureCode(var)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cleanMeasureCode_+3A_var">var</code></td>
<td>
<p>character string vector variable, variable to clean</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p><code>ALL.COUNT</code> will replace the following codes:
</p>

<ul>
<li> <p><code>ALL.DOMESTIC.COUNT</code>
</p>
</li>
<li> <p><code>AGELT1.COUNT</code>
</p>
</li></ul>

</li>
<li><p><code>ALL.RATE</code> will replace the following codes:
</p>

<ul>
<li> <p><code>ALL.DOMESTIC.AGE.RATE</code>
</p>
</li></ul>

</li>
<li><p><code>ALL.AGE.RATE</code> will replace the following codes:
</p>

<ul>
<li> <p><code>ALL.DOMESTIC.AGE.RATE</code>
</p>
</li></ul>

</li>
<li><p><code>ALL.AGESTANDARDISED.RATE</code> will replace the following codes:
</p>

<ul>
<li> <p><code>ALL.DOMESTIC.AGESTANDARDISED.RATE</code>
</p>
</li></ul>

</li>
<li><p><code>CONFIRMED.COUNT</code> will replace the following codes:
</p>

<ul>
<li> <p><code>ALL.LABCONFIRMED.COUNT</code>
</p>
</li>
<li> <p><code>CONFIRMED.LABCONFIRMED.COUNT</code>
</p>
</li>
<li> <p><code>CONFIRMED.AGELT1.COUNT</code>
</p>
</li>
<li> <p><code>TYPHOID.COUNT</code>
</p>
</li></ul>

</li>
<li><p><code>CONFIRMED.RATE</code> will replace the following codes:
</p>

<ul>
<li> <p><code>CONFIRMED.LABCONFIRMED.RATE</code>
</p>
</li>
<li> <p><code>CONFIRMED.AGELT1.RATE</code>
</p>
</li>
<li> <p><code>TYPHOID.RATE</code>
</p>
</li></ul>

</li>
<li><p><code>CONFIRMED.AGESTANDARDISED.RATE</code> will replace the following codes:
</p>

<ul>
<li> <p><code>CONFIRMED.LABCONFIRMED.AGESTANDARDISED.RATE</code>
</p>
</li></ul>

</li>
<li><p><code>CONFIRMED.AGE_GENDER.RATE</code> will replace the following codes:
</p>

<ul>
<li> <p><code>CONFIRMED.LABCONFIRMED.AGE_GENDER.RATE</code>
</p>
</li>
<li> <p><code>TYPHOID.AGE_GENDER.RATE</code>
</p>
</li>
<li> <p><code>ACCUTE.AGE_GENDER.RATE</code>
</p>
</li></ul>

</li></ul>



<h3>Value</h3>

<p>cleaned vector variable
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SALM2016">SALM2016</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- EpiReport::SALM2016
x$MeasureCode &lt;- cleanMeasureCode(x$MeasureCode)

</code></pre>

<hr>
<h2 id='DENGUE2019'>Dataset including Dengue data for 2015-2019</h2><span id='topic+DENGUE2019'></span>

<h3>Description</h3>

<p>A dataset containing the data and indicators required to build the epidemiological report
for Dengue 2019 TESSy data (default dataset used throughout <code>EpiReport</code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DENGUE2019
</code></pre>


<h3>Format</h3>

<p>A data frame with 44,332 rows and 11 variables:
</p>

<dl>
<dt>HealthTopicCode</dt><dd><p>Disease code e.g. <code>ANTH</code>, <code>SALM</code>, etc.</p>
</dd>
<dt>MeasureCode</dt><dd><p>Code of the measure indicator</p>
</dd>
<dt>TimeUnit</dt><dd><p>Unit of the time variable i.e. <code>Y</code> for yearly data or <code>M</code> for monthly data</p>
</dd>
<dt>TimeCode</dt><dd><p>Time variable including dates in any formats available
(according to the unit defined in <code>TimeUnit</code>) yearly data (e.g. 2001) or monthly data (e.g. 2001-01)</p>
</dd>
<dt>GeoCode</dt><dd><p>Geographical level in coded format including country names
(e.g. <code>AT</code> for Austria, <code>BE</code> for Belgium, <code>BG</code> for Bulgaria,
see also the <code>EpiReport::MSCode</code> table, correspondence table for Member State labels and codes)</p>
</dd>
<dt>XValue</dt><dd><p>XValue</p>
</dd>
<dt>XLabel</dt><dd><p>The label associated with the x-axis in the epidemiological report
(see <code>getAgeGender()</code> and <code>plotAgeGender()</code> bar graph for the age variable)</p>
</dd>
<dt>YValue</dt><dd><p>The value associated with the y-axis in the epidemiological report
(see <code>plotAge()</code> bar graph for the variable age, or <code>getTableByMS()</code>
for the number of cases, rate or age-standardised rate in the table by Member States by year)</p>
</dd>
<dt>YLabel</dt><dd><p>The label associated with the y-axis in the epidemiological report
(see <code>getAgeGender()</code> and <code>plotAgeGender()</code> bar graph for the grouping variable gender)</p>
</dd>
<dt>ZValue</dt><dd><p>The value associated with the stratification of XLabel and YLabel
in the age and gender bar graph (see <code>getAgeGender()</code> and <code>plotAgeGender()</code>)</p>
</dd>
<dt>N</dt><dd><p>Number of cases (see <code>getTrend()</code> and <code>getSeason()</code> line graph)</p>
</dd>
</dl>



<h3>See Also</h3>

<p>The correspondence table for Member State labels and codes <code><a href="#topic+MSCode">MSCode</a></code> <br />
and the functions mentioned above: <code><a href="#topic+getAgeGender">getAgeGender</a></code>,
<code><a href="#topic+plotAgeGender">plotAgeGender</a></code>,  <code><a href="#topic+plotAge">plotAge</a></code>,  <code><a href="#topic+getTableByMS">getTableByMS</a></code>,
<code><a href="#topic+getTrend">getTrend</a></code> and <code><a href="#topic+getSeason">getSeason</a></code>.
</p>

<hr>
<h2 id='EcdcColors'>Colour palettes following the March 2018 ECDC guidelines for presentation of surveillance data</h2><span id='topic+EcdcColors'></span>

<h3>Description</h3>

<p>Full document: European Centre for Disease Prevention and Control. Guidelines for presentation of surveillance data.
Stockholm: ECDC; 2018. Available from: <a href="https://www.ecdc.europa.eu/en/publications-data/guidelines-presentation-surveillance-data">Guidelines for presentation of surveillance data</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EcdcColors(col_scale = "green", n = NULL, grey_shade = NULL, hot_cols = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EcdcColors_+3A_col_scale">col_scale</code></td>
<td>
<p>Selected colour scale, defaults to 'green'. Select from 'green', 'blue', 'red', 'grey', 'qual(itative)' or 'hot(cold)'</p>
</td></tr>
<tr><td><code id="EcdcColors_+3A_n">n</code></td>
<td>
<p>Number of colours from each colour scale, apart from grey, in order indicated in the guidelines. Defaults to one colour, apart from two colours for the hotcold scale,
max 7-8 colours for each scale. To select grey shades, use the argument grey_shade; to select number of hot (warm) colours in the hotcold scale, use the argument hot_cols.</p>
</td></tr>
<tr><td><code id="EcdcColors_+3A_grey_shade">grey_shade</code></td>
<td>
<p>(Optional: use only for 'grey') Selected shade(s) of grey in selected order; c('light', 'mediumlight','medium','mediumdark','dark'). Overrides given number of colours (n). Defaults to 'medium'.</p>
</td></tr>
<tr><td><code id="EcdcColors_+3A_hot_cols">hot_cols</code></td>
<td>
<p>(Optional: use only for 'hotcold') Selected number of hot (warm) colours in the hotcold colour scale. Must be smaller than the total number of colours (n).
Defaults to floored half of total hotcold colours.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tommi Karki
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Select three first green colours
EcdcColors("green", n=3)

# Select two first qualitative colours
EcdcColors("qual", n=2)

# Select seven red colours
EcdcColors("red", n=7)

EcdcColors("grey", grey_shade = c("mediumlight", "dark"))

# Use in a graph
# Dummy data
mydat &lt;- data.frame(ID = c(seq(1,10,1)),
                    Gender = c(rep(c("F", "M"),5)))
barplot(table(mydat$Gender),
        col = EcdcColors(col_scale = "qual", n=2))

# Hot-cold colour scale
barplot(c(1:4),
        col = EcdcColors(col_scale = "hotcold", n = 4, hot_cols = 2))

</code></pre>

<hr>
<h2 id='filterDisease'>Filter disease parameters</h2><span id='topic+filterDisease'></span>

<h3>Description</h3>

<p>Filter the table of parameters for the report on the given disease
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterDisease(dis, reportParameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filterDisease_+3A_dis">dis</code></td>
<td>
<p>character string, disease code</p>
</td></tr>
<tr><td><code id="filterDisease_+3A_reportparameters">reportParameters</code></td>
<td>
<p>dataset of parameters for the report
(default <code>AERparams</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with one row (from the <code>AERparams</code> dataframe)
corresponding to the parameters of the selected disease
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AERparams">AERparams</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>disease &lt;- "SALM"
reportParameters &lt;- EpiReport::AERparams
reportParameters &lt;- filterDisease(disease, reportParameters)

</code></pre>

<hr>
<h2 id='getAER'>Get full disease-specific epidemiological report</h2><span id='topic+getAER'></span>

<h3>Description</h3>

<p>Function to generate the 'Microsoft Word' epidemiological report
(similar to the ECDC Annual Epidemiological Report (AER))
including all disease-specific outputs at each output-specific bookmarks exact location. <br />
(for further information on the outputs and the corresponding bookmarks,
please see the package vignette &quot;The Epidemiological Report Package&quot; with <code>browseVignettes("EpiReport")</code>)<br />
(see ECDC AER <a href="https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers">https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAER(
  template = file.path(system.file(package = "EpiReport"),
    "template/AER_template.docx"),
  outputPath = getwd(),
  x = EpiReport::DENGUE2019,
  disease = "DENGUE",
  year = 2019,
  reportParameters = EpiReport::AERparams,
  MSCode = EpiReport::MSCode,
  pathPNG = system.file("maps", package = "EpiReport")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getAER_+3A_template">template</code></td>
<td>
<p>doc (see <code>'officer'</code> package), the empty 'Word' document template in which
to include the table and plots disease-specific outputs.
Default value is the empty template included in the package. See <code>getTemplate()</code>.</p>
</td></tr>
<tr><td><code id="getAER_+3A_outputpath">outputPath</code></td>
<td>
<p>character string, the full path where to generate the epidemiological
report 'Word' output.
Default value is the current working directory <code>getwd()</code>.</p>
</td></tr>
<tr><td><code id="getAER_+3A_x">x</code></td>
<td>
<p>dataframe, raw disease-specific dataset (see specification of the dataset in the
package vignette with <code>browseVignettes("EpiReport")</code>)
(default <code>DENGUE2019</code>)</p>
</td></tr>
<tr><td><code id="getAER_+3A_disease">disease</code></td>
<td>
<p>character string, disease code (default <code>"DENGUE"</code>).
Please make sure the disease code is included in the disease-specific dataset x
in the <code>HealthTopicCode</code> variable.</p>
</td></tr>
<tr><td><code id="getAER_+3A_year">year</code></td>
<td>
<p>numeric, year to produce the report for (default <code>2019</code>).
Please make sure the year is included in the disease-specific dataset x in the <code>TimeCode</code> variable.</p>
</td></tr>
<tr><td><code id="getAER_+3A_reportparameters">reportParameters</code></td>
<td>
<p>dataframe, dataset including the required parameters for the report
production (default <code>AERparams</code>) (see specification of the dataset in the
package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getAER_+3A_mscode">MSCode</code></td>
<td>
<p>dataframe, correspondence table of GeoCode names and codes
(default <code>MSCode</code>) (see specification of the dataset in the
package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getAER_+3A_pathpng">pathPNG</code></td>
<td>
<p>character string, the full path to the folder containing
the maps (in PNG) to include in the final report</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'Word' document
</p>


<h3>See Also</h3>

<p>Default template: <code><a href="#topic+getTemplate">getTemplate</a></code> <br />
Default datasets: <code><a href="#topic+MSCode">MSCode</a></code>
<code><a href="#topic+AERparams">AERparams</a></code> <code><a href="#topic+SALM2016">SALM2016</a></code> <code><a href="#topic+DENGUE2019">DENGUE2019</a></code><br />
Disease-specific outputs: <code><a href="#topic+getTableByMS">getTableByMS</a></code>
<code><a href="#topic+getSeason">getSeason</a></code> <code><a href="#topic+getTrend">getTrend</a></code> <code><a href="#topic+getMap">getMap</a></code> <code><a href="#topic+getAgeGender">getAgeGender</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# --- Generating the AER report using the default Dengue dataset
getAER()

## End(Not run)

## Not run: 
# --- Or using external data (example below)
ZIKV2016 &lt;- read.table("data/ZIKV2016.csv", sep = ",", header = TRUE, stringsAsFactors = FALSE)
output &lt;- "C:/EpiReport/doc/"
pathMap &lt;- "C:/EpiReport/maps/"
getAER(disease = "ZIKV", year = 2016, x = ZIKV2016, outputPath = output, pathPNG = pathMap)

## End(Not run)


</code></pre>

<hr>
<h2 id='getAgeGender'>Get disease-specific age and gender bar graph</h2><span id='topic+getAgeGender'></span>

<h3>Description</h3>

<p>Function returning the age and gender bar graph that will be included
in the epidemiological report at the bookmark location <code>'BARGPH_AGEGENDER'</code>
of the template report. <br />
The bar graph presents the distribution of cases at EU/EEA level using either:
</p>

<ul>
<li><p><code>AG-COUNT</code>: The number of cases by age and gender
</p>
</li>
<li><p><code>AG-RATE</code>: The rate per 100 000 cases by age and gender
</p>
</li>
<li><p><code>AG-PROP</code>: The proportion of cases by age and gender
</p>
</li>
<li><p><code>A-RATE</code>: The rate per 100 000 cases by age only
</p>
</li></ul>

<p>The choice of the type of bar graph is set in the report parameters table <code>AERparams</code>. <br />
(see ECDC reports
<a href="https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers">https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAgeGender(
  x = EpiReport::DENGUE2019,
  disease = "DENGUE",
  year = 2019,
  reportParameters = EpiReport::AERparams,
  geoCode = "EU_EEA31",
  index = 1,
  doc
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getAgeGender_+3A_x">x</code></td>
<td>
<p>dataframe, raw disease-specific dataset (see specification of the
dataset in the package vignette with <code>browseVignettes(package = "EpiReport")</code>)
(default <code>DENGUE2019</code>)</p>
</td></tr>
<tr><td><code id="getAgeGender_+3A_disease">disease</code></td>
<td>
<p>character string, disease code (default <code>"DENGUE"</code>).
Please make sure the disease code is included in the disease-specific dataset x
in the <code>HealthTopicCode</code> variable.</p>
</td></tr>
<tr><td><code id="getAgeGender_+3A_year">year</code></td>
<td>
<p>numeric, year to produce the graph for (default <code>2019</code>).
Please make sure the year is included in the disease-specific dataset x
in the <code>TimeCode</code> variable.</p>
</td></tr>
<tr><td><code id="getAgeGender_+3A_reportparameters">reportParameters</code></td>
<td>
<p>dataframe, dataset including the required parameters
for the graph and report production (default <code>AERparams</code>) (see specification
of the dataset in the package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getAgeGender_+3A_geocode">geoCode</code></td>
<td>
<p>character string, GeoCode to run the analysis on
(default <code>"EU_EEA31"</code>)</p>
</td></tr>
<tr><td><code id="getAgeGender_+3A_index">index</code></td>
<td>
<p>integer, figure number</p>
</td></tr>
<tr><td><code id="getAgeGender_+3A_doc">doc</code></td>
<td>
<p>'Word' document (see <code>'officer'</code> package) in which to add the graph
at the bookmark location.
If doc is missing, <code>getAgeGender</code> returns the <code>ggplot2</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'Word' doc or a ggplot2 object
</p>


<h3>See Also</h3>

<p>Global function for the full epidemilogical report: <code><a href="#topic+getAER">getAER</a></code>  <br />
Required Packages: <code>ggplot2</code> <code>officer</code> <br />
Internal functions: <code><a href="#topic+plotBarGrouped">plotBarGrouped</a></code> (use of <code>plotAgeGender</code> discouraged)
<code><a href="#topic+plotBar">plotBar</a></code> (use of <code>plotAge</code> discouraged)
<code><a href="#topic+EcdcColors">EcdcColors</a></code> <br />
Default datasets: <code><a href="#topic+AERparams">AERparams</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --- Plot using the default dataset
getAgeGender()

# --- Plot using external dataset
# --- Please see examples in the vignette
browseVignettes(package = "EpiReport")

</code></pre>

<hr>
<h2 id='getMap'>Get disease-specific map: distribution of cases by Member State</h2><span id='topic+getMap'></span>

<h3>Description</h3>

<p>Function returning the disease-specific PNG map previously created
and stored in a specific folder (see <code>pathPNG</code> argument) and
that will be included in the epidemiological report at the bookmark location
of the template report, depending of the type of map.
Three type of maps can be included in the report:
</p>

<ul>
<li><p>Bookmark <code>'MAP_NB'</code>: Distribution of cases by country.
An additional caption will be included at the location of the bookmark <code>'MAP_NB_CAPTION'</code>.
</p>
</li>
<li><p>Bookmark <code>'MAP_RATE'</code>: Distribution of cases
per 100 000 population by country. An additional caption will be included
at the location of the bookmark <code>'MAP_RATE_CAPTION'</code>.
</p>
</li>
<li><p>Bookmark <code>'MAP_ASR'</code>: Distribution of cases using
age-strandardised rates per 100 000 population by country.
An additional caption will be included at the location of the bookmark <code>'MAP_ASR_CAPTION'</code>.
</p>
</li></ul>

<p>(see ECDC reports
<a href="https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers">https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMap(
  disease = "DENGUE",
  year = 2019,
  reportParameters = EpiReport::AERparams,
  index = 1,
  pathPNG = system.file("maps", package = "EpiReport"),
  doc
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getMap_+3A_disease">disease</code></td>
<td>
<p>character string, disease code (default <code>"DENGUE"</code>).</p>
</td></tr>
<tr><td><code id="getMap_+3A_year">year</code></td>
<td>
<p>numeric, year to produce the map for (default <code>2019</code>).</p>
</td></tr>
<tr><td><code id="getMap_+3A_reportparameters">reportParameters</code></td>
<td>
<p>dataframe, dataset including the required parameters
for the map and report production (default <code>AERparams</code>) (see specification
of the dataset in the package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getMap_+3A_index">index</code></td>
<td>
<p>integer, figure number</p>
</td></tr>
<tr><td><code id="getMap_+3A_pathpng">pathPNG</code></td>
<td>
<p>character string, full path to the folder containing the maps in PNG
(default 'maps' folder included in the package <code>system.file("maps", package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getMap_+3A_doc">doc</code></td>
<td>
<p>'Word' document (see <code>'officer'</code> package) in which to add the maps
at the bookmark location.
If doc is missing, <code>getMap</code> returns a preview of the PNG image.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'Word' doc an image preview
</p>


<h3>See Also</h3>

<p>Global function for the full epidemilogical report: <code><a href="#topic+getAER">getAER</a></code>  <br />
Required Packages: <code>officer</code> <br />
Internal functions: <code><a href="#topic+includeMap">includeMap</a></code> <code><a href="#topic+previewMap">previewMap</a></code> <br />
Default datasets: <code><a href="#topic+AERparams">AERparams</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Preview of the PNG map using the default Dengue dataset
getMap()

# --- Plot using external PNG image
# --- Please see examples in the vignette
browseVignettes(package = "EpiReport")

</code></pre>

<hr>
<h2 id='getSeason'>Get disease-specific seasonality graph: distribution of cases by month</h2><span id='topic+getSeason'></span>

<h3>Description</h3>

<p>Function returning the plot describing the seasonality of the disease
that will be included in the epidemiological report at the bookmark location
<code>'TS_SEASON'</code> of the template report. <br />
<br />
The graph includes the distribution of cases at EU/EEA level, by month,
over the past five years, with:
</p>

<ul>
<li><p>The number of cases by month in the reference year (green solid line)
</p>
</li>
<li><p>The mean number of cases by month in the four previous years (grey dashed line)
</p>
</li>
<li><p>The minimum number of cases by month in the four previous years (grey area)
</p>
</li>
<li><p>The maximum number of cases by month in the four previous years (grey area)
</p>
</li></ul>

<p>(see ECDC reports
<a href="https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers">https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSeason(
  x = EpiReport::DENGUE2019,
  disease = "DENGUE",
  year = 2019,
  reportParameters = EpiReport::AERparams,
  MSCode = EpiReport::MSCode,
  index = 1,
  doc
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSeason_+3A_x">x</code></td>
<td>
<p>dataframe, raw disease-specific dataset (see specification of the
dataset in the package vignette with <code>browseVignettes(package = "EpiReport")</code>)
(default <code>DENGUE2019</code>)</p>
</td></tr>
<tr><td><code id="getSeason_+3A_disease">disease</code></td>
<td>
<p>character string, disease code (default <code>"DENGUE"</code>).
Please make sure the disease code is included in the disease-specific dataset x
in the <code>HealthTopicCode</code> variable.</p>
</td></tr>
<tr><td><code id="getSeason_+3A_year">year</code></td>
<td>
<p>numeric, year to produce the graph for (default <code>2019</code>).
Please make sure the year is included in the disease-specific dataset x
in the <code>TimeCode</code> variable.</p>
</td></tr>
<tr><td><code id="getSeason_+3A_reportparameters">reportParameters</code></td>
<td>
<p>dataframe, dataset including the required parameters
for the graph and report production (default <code>AERparams</code>) (see specification
of the dataset in the package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getSeason_+3A_mscode">MSCode</code></td>
<td>
<p>dataframe, correspondence table of GeoCode names and codes
(default <code>MSCode</code>) (see specification of the dataset in the
package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getSeason_+3A_index">index</code></td>
<td>
<p>integer, figure number</p>
</td></tr>
<tr><td><code id="getSeason_+3A_doc">doc</code></td>
<td>
<p>'Word' document (see <code>'officer'</code> package) in which to add the graph
at the bookmark location.
If doc is missing, <code>getSeason</code> returns the <code>ggplot2</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'Word' doc or a ggplot2 object
</p>


<h3>See Also</h3>

<p>Global function for the full epidemilogical report: <code><a href="#topic+getAER">getAER</a></code>  <br />
Required Packages: <code>ggplot2</code> <code>officer</code> <br />
Internal functions: <code><a href="#topic+plotSeasonality">plotSeasonality</a></code> <br />
Default datasets: <code><a href="#topic+AERparams">AERparams</a></code> <code><a href="#topic+MSCode">MSCode</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --- Plot using the default dataset
getSeason()

# --- Plot using external dataset
# --- Please see examples in the vignette
browseVignettes(package = "EpiReport")

</code></pre>

<hr>
<h2 id='getTableByMS'>Get disease-specific table: distribution of cases by Member State (GeoCode)</h2><span id='topic+getTableByMS'></span>

<h3>Description</h3>

<p>Function returning the table (<code>'flextable'</code>) that will be included
in the epidemiological report at the bookmark location <code>'TABLE1'</code>
of the template report. An additional caption will be included at the location
of the bookmark <code>'TABLE1_CAPTION'</code>. <br />
(see Table 1 of the ECDC annual reports
<a href="https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers">https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTableByMS(
  x = EpiReport::DENGUE2019,
  disease = "DENGUE",
  year = 2019,
  reportParameters = EpiReport::AERparams,
  MSCode = EpiReport::MSCode,
  index = 1,
  doc
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTableByMS_+3A_x">x</code></td>
<td>
<p>dataframe, raw disease-specific dataset (see specification of the dataset in the
package vignette with <code>browseVignettes(package = "EpiReport")</code>)
(default <code>DENGUE2019</code>)</p>
</td></tr>
<tr><td><code id="getTableByMS_+3A_disease">disease</code></td>
<td>
<p>character string, disease code (default <code>"DENGUE"</code>).
Please make sure the disease code is included in the disease-specific dataset x
in the <code>HealthTopicCode</code> variable.</p>
</td></tr>
<tr><td><code id="getTableByMS_+3A_year">year</code></td>
<td>
<p>numeric, year to produce the table for (default <code>2019</code>).
Please make sure the year is included in the disease-specific dataset x in the <code>TimeCode</code> variable.</p>
</td></tr>
<tr><td><code id="getTableByMS_+3A_reportparameters">reportParameters</code></td>
<td>
<p>dataframe, dataset including the required parameters for the report
production (default <code>AERparams</code>) (see specification of the dataset in the
package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getTableByMS_+3A_mscode">MSCode</code></td>
<td>
<p>dataframe, correspondence table of GeoCode names and codes
(default <code>MSCode</code>) (see specification of the dataset in the
package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getTableByMS_+3A_index">index</code></td>
<td>
<p>integer, figure number</p>
</td></tr>
<tr><td><code id="getTableByMS_+3A_doc">doc</code></td>
<td>
<p>'Word' document (see <code>officer</code> package) in which to add the table
at the bookmark location.
If doc is missing, <code>getTable</code> returns the <code>flextable</code> table object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The current version of the <code>'EpiReport'</code> package includes three types of table
(see detailed specification of the tables in the
package vignette with <code>browseVignettes(package = "EpiReport")</code>):
</p>

<ul>
<li><p><code>COUNT</code> - Table presenting the number of cases by Member State (GeoCode) over a 5-year period;
</p>
</li>
<li><p><code>RATE</code> - Table presenting the number of cases and rates by Member State (GeoCode) over a 5-year period;
</p>
</li>
<li><p><code>ASR</code> - Table presenting the number of cases and rates by Member State (GeoCode) over a 5-year period,
including age-standardised rates for the most recent year.
</p>
</li></ul>



<h3>Value</h3>

<p>'Word' doc or <code>flextable</code> object (see <code>'flextable'</code> package)
</p>


<h3>See Also</h3>

<p>Global function for the full epidemiological report: <code><a href="#topic+getAER">getAER</a></code>  <br />
Required Packages: <code>flextable</code> <code>officer</code> <br />
Internal functions: <code><a href="#topic+shapeECDCFlexTable">shapeECDCFlexTable</a></code> <code><a href="#topic+cleanECDCTable">cleanECDCTable</a></code> <br />
Default datasets: <code><a href="#topic+AERparams">AERparams</a></code> <code><a href="#topic+MSCode">MSCode</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Draft the table using the default Dengue dataset
getTableByMS()

</code></pre>

<hr>
<h2 id='getTemplate'>Get epidemiological report (empty) template</h2><span id='topic+getTemplate'></span>

<h3>Description</h3>

<p>Function to export the generic 'Microsoft Word' empty template (included in
the <code>'EpiReport'</code> package) used to produce the
epidemiological report similar to the ECDC Annual Epidemiological Report (AER).
The modified version of the template can then be used to produce the final
epidemiological report using <code>getAER(template = 'NewTemplate.docx', ...)</code> <br />
(see the package vignette &quot;The Epidemiological Report Package&quot; with
<code>browseVignettes("EpiReport")</code>)  <br />
(see ECDC annual epidemilogical reports
<a href="https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers">https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTemplate(output_path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTemplate_+3A_output_path">output_path</code></td>
<td>
<p>character string, the full path where to create the 'Word' output.
Defaut location will be the current working directory (default <code>getwd()</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'Word' document
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getAER">getAER</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# --- Export the template in the default folder: working directory
getTemplate()

# --- Or specify the full path
getTemplate(output_path = getwd())

## End(Not run)


</code></pre>

<hr>
<h2 id='getTrend'>Get disease-specific trend plot: trend and number of cases by month</h2><span id='topic+getTrend'></span>

<h3>Description</h3>

<p>Function returning the plot describing the trend of the disease over time
that will be included in the epidemiological report at the bookmark location
<code>'TS_TREND'</code> on the template report. <br />
<br />
The graph includes the number of cases at EU/EEA level, by month,
over the past five years, with:
</p>

<ul>
<li><p>The number of cases by month over the 5-year period (grey solid line)
</p>
</li>
<li><p>The 12-month moving average of the number of cases by month (green solid line)
</p>
</li></ul>

<p>(see ECDC reports
<a href="https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers">https://www.ecdc.europa.eu/en/all-topics-z/surveillance-and-disease-data/annual-epidemiological-reports-aers</a>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTrend(
  x = EpiReport::DENGUE2019,
  disease = "DENGUE",
  year = 2019,
  reportParameters = EpiReport::AERparams,
  MSCode = EpiReport::MSCode,
  index = 1,
  doc
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTrend_+3A_x">x</code></td>
<td>
<p>dataframe, raw disease-specific dataset (see specification of the
dataset in the package vignette with <code>browseVignettes(package = "EpiReport")</code>)
(default <code>DENGUE2019</code>)</p>
</td></tr>
<tr><td><code id="getTrend_+3A_disease">disease</code></td>
<td>
<p>character string, disease code (default <code>"DENGUE"</code>).
Please make sure the disease code is included in the disease-specific dataset x
in the <code>HealthTopicCode</code> variable.</p>
</td></tr>
<tr><td><code id="getTrend_+3A_year">year</code></td>
<td>
<p>numeric, year to produce the graph for (default <code>2019</code>).
Please make sure the year is included in the disease-specific dataset x
in the <code>TimeCode</code> variable.</p>
</td></tr>
<tr><td><code id="getTrend_+3A_reportparameters">reportParameters</code></td>
<td>
<p>dataframe, dataset including the required parameters
for the graph and report production (default <code>AERparams</code>) (see specification
of the dataset in the package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getTrend_+3A_mscode">MSCode</code></td>
<td>
<p>dataframe, correspondence table of GeoCode names and codes
(default <code>MSCode</code>) (see specification of the dataset in the
package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="getTrend_+3A_index">index</code></td>
<td>
<p>integer, figure number</p>
</td></tr>
<tr><td><code id="getTrend_+3A_doc">doc</code></td>
<td>
<p>'Word' document (see <code>officer</code> package) in which to add the graph
at the bookmark location.
If doc is missing, <code>getTrend</code> returns the <code>ggplot2</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'Word' doc or a ggplot2 preview
</p>


<h3>See Also</h3>

<p>Global function for the full epidemilogical report: <code><a href="#topic+getAER">getAER</a></code>  <br />
Required Packages: <code>ggplot2</code> <code>officer</code> <br />
Internal functions: <code><a href="#topic+plotTS12MAvg">plotTS12MAvg</a></code> <br />
Default datasets: <code><a href="#topic+AERparams">AERparams</a></code> <code><a href="#topic+MSCode">MSCode</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --- Plot using the default dataset
getTrend()

# --- Plot using external dataset
# --- Please see examples in the vignette
browseVignettes(package = "EpiReport")

</code></pre>

<hr>
<h2 id='includeMap'>Including PNG map in the 'Microsoft Word' template</h2><span id='topic+includeMap'></span>

<h3>Description</h3>

<p>Function including the disease-specific PNG map in the 'Word' document
at the specific bookmark location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>includeMap(
  disease,
  year,
  reportParameters,
  index,
  pathPNG,
  doc,
  pop,
  namePNGsuffix,
  unit,
  mapBookmark,
  captionBookmark
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="includeMap_+3A_disease">disease</code></td>
<td>
<p>character string, disease code (default <code>"DENGUE"</code>).</p>
</td></tr>
<tr><td><code id="includeMap_+3A_year">year</code></td>
<td>
<p>numeric, year to produce the graph for (default <code>2019</code>).</p>
</td></tr>
<tr><td><code id="includeMap_+3A_reportparameters">reportParameters</code></td>
<td>
<p>dataframe, dataset including the required parameters
for the graph and report production (default <code>AERparams</code>) (see specification
of the dataset in the package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="includeMap_+3A_index">index</code></td>
<td>
<p>integer, figure number</p>
</td></tr>
<tr><td><code id="includeMap_+3A_pathpng">pathPNG</code></td>
<td>
<p>character string, full path to the folder containing the maps in PNG
(default 'maps' folder included in the package <code>system.file("maps", package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="includeMap_+3A_doc">doc</code></td>
<td>
<p>'Word' document (see <code>'officer'</code> package) in which to add
the maps at the bookmark location</p>
</td></tr>
<tr><td><code id="includeMap_+3A_pop">pop</code></td>
<td>
<p>character string, label of the type of population to use in the caption
(e.g. <code>confirmed</code>)</p>
</td></tr>
<tr><td><code id="includeMap_+3A_namepngsuffix">namePNGsuffix</code></td>
<td>
<p>character string, suffix of the PNG file name of the map
(i.e. <code>"COUNT"</code>, <code>"RATE"</code> or <code>"AGESTANDARDISED"</code>.)</p>
</td></tr>
<tr><td><code id="includeMap_+3A_unit">unit</code></td>
<td>
<p>character string, label of the unit used in the caption
(e.g. <code>"per 100 000 population"</code>)</p>
</td></tr>
<tr><td><code id="includeMap_+3A_mapbookmark">mapBookmark</code></td>
<td>
<p>character string, label of the bookmark where to add
the map in the 'Word' document</p>
</td></tr>
<tr><td><code id="includeMap_+3A_captionbookmark">captionBookmark</code></td>
<td>
<p>character string, label of the bookmark where to add
the caption in the 'Word' document</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'Word' doc
</p>


<h3>See Also</h3>

<p>Global function: <code><a href="#topic+getMap">getMap</a></code>
</p>

<hr>
<h2 id='MSCode'>Dataset correspondence table between country names and country code</h2><span id='topic+MSCode'></span>

<h3>Description</h3>

<p>Dataframe providing the correspondence table of the geographical code <code>GeoCode</code>
used in the disease dataset, and the geographical label <code>Country</code> to use
throughout the report. Additional information on the EU/EEA affiliation
is also available in column <code>EUEEA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MSCode
</code></pre>


<h3>Format</h3>

<p>A data frame with 32 rows and 3 variables:
</p>

<dl>
<dt>Country</dt><dd><p>Full name of the country / Member State e.g. Austria, Belgium, etc.</p>
</dd>
<dt>TheCountry</dt><dd><p>Full name of the country / Member State
including 'the' article for NL and UK  e.g. Austria, Belgium, the Netherlands, the United Kingdom etc.</p>
</dd>
<dt>GeoCode</dt><dd><p>Associated code (see <code>GeoCode</code> variable
on the <code>SALM2016</code> internal dataset) e.g. AT, BE, BG, etc.</p>
</dd>
<dt>EUEEA</dt><dd><p>For each Member State, variable specifying in the country
is part of the EU or EEA.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+SALM2016">SALM2016</a></code>
</p>

<hr>
<h2 id='orderQuasinum'>Order 'quasinumerical' categorical vectors (increasing order)</h2><span id='topic+orderQuasinum'></span>

<h3>Description</h3>

<p>A function to order 'quasinumerical' (i.e. categorical with values
such as &quot;15-30&quot; or &quot;&lt;18&quot;) integer vectors into increasing order.
Currently handles away the following non-numerical characters
&quot;-&quot;, &quot;&gt;&quot;, &quot;&lt;&quot;, &quot;&gt;=&quot;, &quot;&lt;=&quot;, &quot;+&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orderQuasinum(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orderQuasinum_+3A_x">x</code></td>
<td>
<p>character vector with 'quasinumerical' values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tommi Karki
</p>


<h3>See Also</h3>

<p>Used in <code><a href="#topic+getAgeGender">getAgeGender</a></code> and <code><a href="#topic+plotAgeGender">plotAgeGender</a></code> / <code><a href="#topic+plotAge">plotAge</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age1 &lt;- c("&lt;1", "1-15", "16-25", "&gt;65", "26-65")
age2 &lt;- c("0-4", "5-10", "&gt;65", "25-64", "11-25")
age3 &lt;- c("5-10", "&gt;65", "25-64", "11-25", "&lt;=4")
age4 &lt;- c("&gt;=65", "&lt;18", "18-64")
age5 &lt;- c("5-10", "+65", "25-64", "11-25", "0-4")

age1
orderQuasinum(age1)
age2
orderQuasinum(age2)
age3
orderQuasinum(age3)
age4
orderQuasinum(age4)
age5
orderQuasinum(age5)

</code></pre>

<hr>
<h2 id='plotAge'>Age bar graph</h2><span id='topic+plotAge'></span>

<h3>Description</h3>

<p>(Discouraged function. Please use <code>plotBarGrouped()</code> instead.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAge(
  .data,
  xvar = "XLabel",
  yvar = "YValue",
  fill_color1 = "#65B32E",
  ytitle = "Rate"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotAge_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotAge_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the variable to plot on the x-axis in quotes
(default <code>"XLabel"</code>)</p>
</td></tr>
<tr><td><code id="plotAge_+3A_yvar">yvar</code></td>
<td>
<p>character string, name of the variable to plot on the y-axis in quotes
(default <code>"YValue"</code>)</p>
</td></tr>
<tr><td><code id="plotAge_+3A_fill_color1">fill_color1</code></td>
<td>
<p>character string, hexadecimal colour to use in the graph;
(default to ECDC green <code>"#65B32E"</code>, see EcdcColors(col_scale = &quot;qual&quot;, n = 1))</p>
</td></tr>
<tr><td><code id="plotAge_+3A_ytitle">ytitle</code></td>
<td>
<p>character string, y-axis title; (default <code>"Rate"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function draws a bar graph by age group (or possibly other grouping). <br />
The bar graph presents the distribution of cases at EU/EEA level
using the rate per 100 000 cases by age. <br />
Expects aggregated data.
</p>


<h3>See Also</h3>

<p>Global function: <code><a href="#topic+getAgeGender">getAgeGender</a></code>  <br />
Internal function: <code><a href="#topic+EcdcColors">EcdcColors</a></code> <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --- Create dummy data
mydat &lt;- data.frame(AgeGroup = c("0-25", "26-65", "65+"),
                    NumberOfCases = c(54,32,41))

# --- Plot the dummy data
plotAge(mydat,
        xvar = "AgeGroup",
        yvar = "NumberOfCases",
        ytitle = "Number of cases")

</code></pre>

<hr>
<h2 id='plotAgeGender'>Age and Gender bar graph</h2><span id='topic+plotAgeGender'></span>

<h3>Description</h3>

<p>(Discouraged function. Please use <code>plotBarGrouped()</code> instead.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAgeGender(
  .data,
  xvar = "XLabel",
  yvar = "ZValue",
  group = "YLabel",
  fill_color1 = "#65B32E",
  fill_color2 = "#7CBDC4",
  ytitle = "Rate"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotAgeGender_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotAgeGender_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the variable to plot on the x-axis in quotes
(default <code>"XLabel"</code>)</p>
</td></tr>
<tr><td><code id="plotAgeGender_+3A_yvar">yvar</code></td>
<td>
<p>character string, name of the variable to plot on the y-axis in quotes
(default <code>"ZValue"</code>)</p>
</td></tr>
<tr><td><code id="plotAgeGender_+3A_group">group</code></td>
<td>
<p>character string, name of the grouping variable in quotes, e.g. gender.
(default <code>"YLabel"</code>)</p>
</td></tr>
<tr><td><code id="plotAgeGender_+3A_fill_color1">fill_color1</code></td>
<td>
<p>character string, hexadecimal colour to use in the graph for bar 1;
(default to ECDC green <code>"#65B32E"</code>, see EcdcColors(col_scale = &quot;qual&quot;, n = 2))</p>
</td></tr>
<tr><td><code id="plotAgeGender_+3A_fill_color2">fill_color2</code></td>
<td>
<p>character string, hexadecimal colour to use in the graph for bar 2;
(default to ECDC blue <code>"#7CBDC4"</code>, see EcdcColors(col_scale = &quot;qual&quot;, n = 2))</p>
</td></tr>
<tr><td><code id="plotAgeGender_+3A_ytitle">ytitle</code></td>
<td>
<p>character string, y-axis title; (default <code>"Rate"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function draws a bar graph of the distribution of cases by age group
and gender (or possibly other grouping). <br />
The bar graph presents the distribution of cases at EU/EEA level using either:
</p>

<ul>
<li><p><code>AG-COUNT</code>: The number of cases by age and gender
</p>
</li>
<li><p><code>AG-RATE</code>: The rate per 100 000 cases by age and gender
</p>
</li>
<li><p><code>AG-PROP</code>: The proportion of cases by age and gender
</p>
</li></ul>

<p>Expects aggregated data.
</p>


<h3>See Also</h3>

<p>Global function: <code><a href="#topic+getAgeGender">getAgeGender</a></code>  <br />
Internal function: <code><a href="#topic+EcdcColors">EcdcColors</a></code> <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Create dummy data
mydat &lt;- data.frame(Gender=c("F", "F", "M", "M"),
                    AgeGroup = c("0-65", "65+", "0-65", "65+"),
                    NumberOfCases = c(54,43,32,41))

# --- Plot the dummy data
plotAgeGender(mydat,
              xvar = "AgeGroup",
              yvar = "NumberOfCases",
              group = "Gender",
              ytitle = "Number of cases")

</code></pre>

<hr>
<h2 id='plotBar'>Bar graph</h2><span id='topic+plotBar'></span>

<h3>Description</h3>

<p>This function draws a bar graph of the values of variable 'Yvar'
with the categorical variable 'Xvar' on the x-axis. <br />
Expects aggregated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBar(
  .data,
  xvar = "XLabel",
  xlabel = "",
  yvar = "YValue",
  ylabel = "",
  fill_color = EcdcColors(col_scale = "qual", n = 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotBar_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotBar_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the variable to plot on the x-axis in quotes
(default <code>"XLabel"</code>)</p>
</td></tr>
<tr><td><code id="plotBar_+3A_xlabel">xlabel</code></td>
<td>
<p>character string, label of the x axis</p>
</td></tr>
<tr><td><code id="plotBar_+3A_yvar">yvar</code></td>
<td>
<p>character string, name of the variable to plot on the y-axis in quotes
(default <code>"YValue"</code>)</p>
</td></tr>
<tr><td><code id="plotBar_+3A_ylabel">ylabel</code></td>
<td>
<p>character string, label of the y axis</p>
</td></tr>
<tr><td><code id="plotBar_+3A_fill_color">fill_color</code></td>
<td>
<p>character string, hexadecimal colour to use in the graph;
(default to ECDC green <code>"#65B32E"</code>, see EcdcColors(col_scale = &quot;qual&quot;, n = 1))</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Global function: <code><a href="#topic+getAgeGender">getAgeGender</a></code>  <br />
Internal function: <code><a href="#topic+EcdcColors">EcdcColors</a></code> <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --- Create dummy data
mydat &lt;- data.frame(AgeGroup = c("0-25", "26-65", "65+"),
                    NumberOfCases = c(54,32,41))

# --- Plot the dummy data
plotBar(mydat,
        xvar = "AgeGroup",
        xlabel = "Age",
        yvar = "NumberOfCases",
        ylabel = "Number of cases")

</code></pre>

<hr>
<h2 id='plotBarGrouped'>Grouped bar graph</h2><span id='topic+plotBarGrouped'></span>

<h3>Description</h3>

<p>This function draws a vertical grouped bar graph of the values of variable 'Yvar'
with the categorical variable 'Xvar' on the x-axis and grouped by 'Group' categorical variable. <br />
Expects aggregated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBarGrouped(
  .data,
  xvar = "XLabel",
  xlabel = "",
  yvar = "ZValue",
  ylabel = "",
  group = "YLabel",
  fill_color = EcdcColors(col_scale = "qual", n = length(unique(.data[[group]]))),
  position = "dodge"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotBarGrouped_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotBarGrouped_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the variable to plot on the x-axis in quotes
(default <code>"XLabel"</code>)</p>
</td></tr>
<tr><td><code id="plotBarGrouped_+3A_xlabel">xlabel</code></td>
<td>
<p>character string, label of the x axis</p>
</td></tr>
<tr><td><code id="plotBarGrouped_+3A_yvar">yvar</code></td>
<td>
<p>character string, name of the variable to plot on the y-axis in quotes
(default <code>"ZValue"</code>)</p>
</td></tr>
<tr><td><code id="plotBarGrouped_+3A_ylabel">ylabel</code></td>
<td>
<p>character string, label of the y axis</p>
</td></tr>
<tr><td><code id="plotBarGrouped_+3A_group">group</code></td>
<td>
<p>character string, name of the grouping variable in quotes, e.g. gender.
(default <code>"YLabel"</code>).</p>
</td></tr>
<tr><td><code id="plotBarGrouped_+3A_fill_color">fill_color</code></td>
<td>
<p>vector of character strings, hexadecimal colour to use in the graph for bars;
the vector should contain the number categories in <code>"group"</code> variable.
(default to ECDC blue <code>"#7CBDC4"</code> and ECDC green <code>"#65B32E"</code>, see EcdcColors(col_scale = &quot;qual&quot;, n = 2))</p>
</td></tr>
<tr><td><code id="plotBarGrouped_+3A_position">position</code></td>
<td>
<p>character string, position of the bars, either <code>"dodge"</code>
or <code>"stack"</code> (default <code>"dodge"</code>, see <code>geom_bar(position = ... )</code>).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Global function: <code><a href="#topic+getAgeGender">getAgeGender</a></code>  <br />
Internal function: <code><a href="#topic+EcdcColors">EcdcColors</a></code> <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Create dummy data
mydat &lt;- data.frame(Gender=c("F", "F", "M", "M"),
                    AgeGroup = c("0-65", "65+", "0-65", "65+"),
                    NumberOfCases = c(30, 35, 70, 65))

# --- Plot the dummy data
plotBarGrouped(mydat,
              xvar = "AgeGroup",
              xlabel = "Age",
              yvar = "NumberOfCases",
              ylabel = "Number of cases",
              group = "Gender")

# -- Create dummy data
mydat &lt;- data.frame(VaccStatus = rep(c("Unvaccinated", "1 dose", "2 doses", "3 doses"), 3),
                    AgeGroup = rep(c("&lt;1", "1-4", "5-9") , each = 4),
                    Proportion = c(90, 10, 0, 0,
                                   30, 50, 20, 0,
                                   10, 25, 35, 30))
mydat$VaccStatus &lt;- factor(mydat$VaccStatus,
                           levels = c("Unvaccinated", "1 dose", "2 doses", "3 doses"))
plotBarGrouped(mydat,
               xvar = "AgeGroup",
               xlabel = "Age (years)",
               yvar = "Proportion",
               ylabel = "Proportion of cases %",
               group = "VaccStatus",
               position = "stack")


</code></pre>

<hr>
<h2 id='plotBarGroupedH'>Horizontal grouped bar graph</h2><span id='topic+plotBarGroupedH'></span>

<h3>Description</h3>

<p>This function draws an horizontal bar graph of the values of variable 'Yvar'
with the categorical variable 'Xvar' on the x-axis. <br />
Expects aggregated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBarGroupedH(
  .data,
  xvar = "",
  xlabel = "",
  yvar = "",
  ylabel = "",
  group = "",
  fill_color = EcdcColors(col_scale = "qual", n = length(unique(.data[[group]]))),
  log10_scale = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotBarGroupedH_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotBarGroupedH_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the categorical variable to plot on the x-axis in quotes</p>
</td></tr>
<tr><td><code id="plotBarGroupedH_+3A_xlabel">xlabel</code></td>
<td>
<p>character string, label of the x axis</p>
</td></tr>
<tr><td><code id="plotBarGroupedH_+3A_yvar">yvar</code></td>
<td>
<p>character string, name of the numerical variable to plot on the y-axis in quotes</p>
</td></tr>
<tr><td><code id="plotBarGroupedH_+3A_ylabel">ylabel</code></td>
<td>
<p>character string, label of the y axis</p>
</td></tr>
<tr><td><code id="plotBarGroupedH_+3A_group">group</code></td>
<td>
<p>character string, name of the grouping variable in quotes, e.g. gender.</p>
</td></tr>
<tr><td><code id="plotBarGroupedH_+3A_fill_color">fill_color</code></td>
<td>
<p>character string, hexadecimal colour to use in the graph;
(default to ECDC green <code>"#65B32E"</code>, see <code>EcdcColors(col_scale = "qual", n = 1))</code></p>
</td></tr>
<tr><td><code id="plotBarGroupedH_+3A_log10_scale">log10_scale</code></td>
<td>
<p>boolean, TRUE if y-axis should be log scale
(default <code>FALSE</code> ,see <code>ggplot2::scale_y_log10</code>)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Internal function: <code><a href="#topic+EcdcColors">EcdcColors</a></code> <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Create dummy data
mydat &lt;- data.frame(Gender=c("F", "F", "M", "M"),
                    AgeGroup = c("0-65", "65+", "0-65", "65+"),
                    NumberOfCases = c(54,43,32,41))

# --- Plot the dummy data
plotBarGroupedH(mydat,
              xvar = "AgeGroup",
              xlabel = "Age",
              yvar = "NumberOfCases",
              ylabel = "Number of cases",
              group = "Gender")

</code></pre>

<hr>
<h2 id='plotBarH'>Horizontal bar graph</h2><span id='topic+plotBarH'></span>

<h3>Description</h3>

<p>This function draws an horizontal bar graph of the values of variable 'Yvar'
with the categorical variable 'Xvar' on the x-axis. <br />
Expects aggregated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBarH(
  .data,
  xvar = "",
  xlabel = "",
  yvar = "",
  ylabel = "",
  fill_color = EcdcColors(col_scale = "qual", n = 1),
  log10_scale = FALSE,
  xlabel_black = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotBarH_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotBarH_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the categorical variable to plot on the x-axis in quotes</p>
</td></tr>
<tr><td><code id="plotBarH_+3A_xlabel">xlabel</code></td>
<td>
<p>character string, label of the x axis</p>
</td></tr>
<tr><td><code id="plotBarH_+3A_yvar">yvar</code></td>
<td>
<p>character string, name of the numerical variable to plot on the y-axis in quotes</p>
</td></tr>
<tr><td><code id="plotBarH_+3A_ylabel">ylabel</code></td>
<td>
<p>character string, label of the y axis</p>
</td></tr>
<tr><td><code id="plotBarH_+3A_fill_color">fill_color</code></td>
<td>
<p>character string, hexadecimal colour to use in the graph;
(default to ECDC green <code>"#65B32E"</code>, see <code>EcdcColors(col_scale = "qual", n = 1))</code></p>
</td></tr>
<tr><td><code id="plotBarH_+3A_log10_scale">log10_scale</code></td>
<td>
<p>boolean, TRUE if y-axis should be log scale
(default <code>FALSE</code> ,see <code>ggplot2::scale_y_log10</code>)</p>
</td></tr>
<tr><td><code id="plotBarH_+3A_xlabel_black">xlabel_black</code></td>
<td>
<p>(optional) character string, value of the categorical variable
for which the bar should be black</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Internal function: <code><a href="#topic+EcdcColors">EcdcColors</a></code> <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Create dummy data
mfratio &lt;- data.frame( Country = sample(EpiReport::MSCode$Country, 28),
                       Ratio = runif(28, min = 0, max = 28))

# --- Plot the dummy data
plotBarH(mfratio,
         xvar = "Country",
         xlabel = "",
         yvar = "Ratio",
         ylabel = "Male-to-Female ratio",
         log10_scale = FALSE)
plotBarH(mfratio,
         xvar = "Country",
         xlabel = "",
         yvar = "Ratio",
         ylabel = "Male-to-Female ratio",
         log10_scale = TRUE,
         xlabel_black = "EU-EEA")

</code></pre>

<hr>
<h2 id='plotPie'>Pie chart</h2><span id='topic+plotPie'></span>

<h3>Description</h3>

<p>This function draws a pie chart of the values of variable 'Xvar'
with the labels from the categorical variable 'Labels'. <br />
Expects aggregated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPie(
  .data,
  xvar = "",
  labels = "",
  fill_colors = EcdcColors(col_scale = "qual", n = nrow(.data))
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPie_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotPie_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the numerical variable
to plot in quotes</p>
</td></tr>
<tr><td><code id="plotPie_+3A_labels">labels</code></td>
<td>
<p>character string, name of the character variable
including the corresponding labels</p>
</td></tr>
<tr><td><code id="plotPie_+3A_fill_colors">fill_colors</code></td>
<td>
<p>vector of character strings, hexadecimal colours
to use for each labels in the piechart; the vector should contain
the exact number of categories defined in <code>"labels"</code> variable.
(default to ECDC colors, see
<code>EcdcColors(col_scale = "qual", n = nrow(.data))</code>)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Internal function: <code><a href="#topic+EcdcColors">EcdcColors</a></code> <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Create dummy data
piechart &lt;- data.frame(Labels = c("Heterosexual females",
                                  "Heterosexual males",
                                  "MSM",
                                  "Unknow"),
                       Values = c(1633,2937,15342,2854))

# --- Plot the dummy data
plotPie(piechart,
         xvar = "Values",
         labels = "Labels")

</code></pre>

<hr>
<h2 id='plotSeasonality'>Seasonality line graph</h2><span id='topic+plotSeasonality'></span>

<h3>Description</h3>

<p>This function draws a line graph describing the seasonality of the selected disease
over the past 5 years. <br />
The graph includes the distribution of cases, by month, over the past five years, with:
</p>

<ul>
<li><p><code>yvar</code>: The number of cases by month in the reference year (green solid line)
</p>
</li>
<li><p><code>mean4years</code>: The mean number of cases by month in the four previous years (grey dashed line)
</p>
</li>
<li><p><code>min4years</code>: The minimum number of cases by month in the four previous years (grey area)
</p>
</li>
<li><p><code>max4years</code>: The maximum number of cases by month in the four previous years (grey area)
</p>
</li></ul>

<p>Expects aggregated data and pre-calculated min, max and mean figures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSeasonality(
  .data,
  xvar = "TimeCode",
  yvar = "N",
  min4years = "Min4Years",
  max4years = "Max4Years",
  mean4years = "Mean4Years",
  year = 2016
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotSeasonality_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotSeasonality_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the time variable on the x-axis in quotes
(default <code>"TimeCode"</code>)</p>
</td></tr>
<tr><td><code id="plotSeasonality_+3A_yvar">yvar</code></td>
<td>
<p>character string, name of the variable to plot on the y-axis in quotes
(default <code>"N"</code>), number of cases by month in the reference year (green solid line)</p>
</td></tr>
<tr><td><code id="plotSeasonality_+3A_min4years">min4years</code></td>
<td>
<p>character string, name of the variable to plot in quotes including the minimum
number of cases by month over the past 4 years (default <code>"Min4Years"</code>)</p>
</td></tr>
<tr><td><code id="plotSeasonality_+3A_max4years">max4years</code></td>
<td>
<p>character string, name of the variable to plot in quotes including the maximum
number of cases by month over the past 4 years (default <code>"Max4Years"</code>)</p>
</td></tr>
<tr><td><code id="plotSeasonality_+3A_mean4years">mean4years</code></td>
<td>
<p>character string, name of the variable to plot in quotes including the mean of the
number of cases by month over the past 4 years (default <code>"Mean4Years"</code>)</p>
</td></tr>
<tr><td><code id="plotSeasonality_+3A_year">year</code></td>
<td>
<p>numeric, year to produce the graph for (default <code>2016</code>).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Global function: <code><a href="#topic+getSeason">getSeason</a></code>  <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# --- Plot using external dataset

# Create a dummy dataset
test &lt;- data.frame(Time = as.Date(paste0("2019-",c(1:12), "-01")),
                   N = sample(c(5000:7000), 12),
                   mean = sample(c(4000:5000), 12),
                   low = sample(c(3000:4000), 12),
                   high = sample(c(5000:6000), 12))

# Plot the dummy data
plotSeasonality(test,
                xvar = "Time",
                yvar = "N",
                min4years = "low",
                max4years = "high",
                mean4years = "mean",
                year = 2019)

# --- Please see examples in the vignette
browseVignettes(package = "EpiReport")

# --- Plot using the default dataset
getSeason()

</code></pre>

<hr>
<h2 id='plotTS'>Time series plot</h2><span id='topic+plotTS'></span>

<h3>Description</h3>

<p>This function draws a time series of the values of variable 'Yvar'
with the time variable 'Xvar' on the x-axis. <br />
Expects aggregated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTS(
  .data,
  xvar = "",
  xlabel = "",
  yvar = "",
  ylabel = "",
  fill_color = EcdcColors(col_scale = "qual", n = 1),
  log10_scale = FALSE,
  xvar_format = "%Y",
  xvar_breaks = "1 year"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotTS_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotTS_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the time variable (expects date format)
to plot on the x-axis in quotes</p>
</td></tr>
<tr><td><code id="plotTS_+3A_xlabel">xlabel</code></td>
<td>
<p>character string, label of the x axis</p>
</td></tr>
<tr><td><code id="plotTS_+3A_yvar">yvar</code></td>
<td>
<p>character string, name of the numerical variable to plot on the y-axis in quotes</p>
</td></tr>
<tr><td><code id="plotTS_+3A_ylabel">ylabel</code></td>
<td>
<p>character string, label of the y axis</p>
</td></tr>
<tr><td><code id="plotTS_+3A_fill_color">fill_color</code></td>
<td>
<p>character string, hexadecimal colour to use in the graph;
(default to ECDC green <code>"#65B32E"</code>,
see <code>EcdcColors(col_scale = "qual", n = 1)</code></p>
</td></tr>
<tr><td><code id="plotTS_+3A_log10_scale">log10_scale</code></td>
<td>
<p>boolean, <code>TRUE</code> if y-axis should be log scale
(default <code>FALSE</code> ,see <code>ggplot2::scale_y_log10</code>)</p>
</td></tr>
<tr><td><code id="plotTS_+3A_xvar_format">xvar_format</code></td>
<td>
<p>character string, time format to use to plot the x-axis
(<code>"%Y"</code> for yearly labels or <code>"%b %Y"</code> for monthly labels)</p>
</td></tr>
<tr><td><code id="plotTS_+3A_xvar_breaks">xvar_breaks</code></td>
<td>
<p>character string, time unit to use to plot the x-axis between breaks
(<code>"1 year"</code> or <code>"1 month"</code>, see <code>ggplot2::scale_x_date(date_breaks = ... )</code>)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Internal function: <code><a href="#topic+EcdcColors">EcdcColors</a></code> <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Create dummy data
mydat &lt;- data.frame(TimeCode = seq(as.Date("2008/1/1"), as.Date("2017/1/1"), "years"),
                    YValue = sample(1:500/10, 10))

# --- Plot the dummy data
plotTS(mydat,
       xvar = "TimeCode",
       xlabel = "Year",
       yvar = "YValue",
       ylabel = "Rate per 100 000 population",
       log10_scale = FALSE,
       xvar_format = "%Y",
       xvar_breaks = "1 year")

</code></pre>

<hr>
<h2 id='plotTS12MAvg'>Time series with 12-month moving average</h2><span id='topic+plotTS12MAvg'></span>

<h3>Description</h3>

<p>This function draws a line graph describing the trend of the selected disease
over the past 5 years. <br />
The graph includes the trend and number of cases at EU/EEA level, by month,
over the past five years, with:
</p>

<ul>
<li><p><code>yvar</code>: The number of cases by month over the 5-year period (grey solid line)
</p>
</li>
<li><p><code>movAverage</code>: The 12-month moving average of the number of cases by month (green solid line)
</p>
</li></ul>

<p>Expects aggregated data and pre-calculated 12-month moving average.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTS12MAvg(.data, xvar = "TimeCode", yvar = "N", movAverage = "MAV")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotTS12MAvg_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotTS12MAvg_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the time variable to plot on the x-axis
in quotes (default <code>"TimeCode"</code>)</p>
</td></tr>
<tr><td><code id="plotTS12MAvg_+3A_yvar">yvar</code></td>
<td>
<p>character string, name of the variable to plot on the y-axis in quotes
(default <code>"N"</code>), number of cases by month over the 5-year period (grey solid line)</p>
</td></tr>
<tr><td><code id="plotTS12MAvg_+3A_movaverage">movAverage</code></td>
<td>
<p>character string, name of the variable to plot in quotes including
the moving average per each time unit (default <code>"MAV"</code>)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Global function: <code><a href="#topic+getTrend">getTrend</a></code>  <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --- Plot using external dataset

# Create a dummy dataset
test &lt;- data.frame(Time = as.Date(paste0("2019-",c(1:12), "-01")),
                   N = sample(c(4000:6000), 12),
                   mean = sample(c(4000:5000), 12))

# Plot the dummy data
plotTS12MAvg(test,
             xvar = "Time",
             yvar = "N",
             movAverage = "mean")

</code></pre>

<hr>
<h2 id='plotTSGrouped'>Multiple time series plot</h2><span id='topic+plotTSGrouped'></span>

<h3>Description</h3>

<p>This function draws a time series of the values of variable 'Yvar'
with the time variable 'Xvar' on the x-axis.
The categorical variable that specify the group of the observations
for which there will be one time series each. <br />
Expects aggregated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTSGrouped(
  .data,
  xvar = "",
  xlabel = "",
  yvar = "",
  ylabel = "",
  group = "",
  fill_color = EcdcColors(col_scale = "qual", n = length(unique(.data[[group]]))),
  log10_scale = FALSE,
  xvar_format = "%Y",
  xvar_breaks = "1 year"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotTSGrouped_+3A_.data">.data</code></td>
<td>
<p>dataframe containing the variables to plot</p>
</td></tr>
<tr><td><code id="plotTSGrouped_+3A_xvar">xvar</code></td>
<td>
<p>character string, name of the time variable (expects date format)
to plot on the x-axis in quotes</p>
</td></tr>
<tr><td><code id="plotTSGrouped_+3A_xlabel">xlabel</code></td>
<td>
<p>character string, label of the x axis</p>
</td></tr>
<tr><td><code id="plotTSGrouped_+3A_yvar">yvar</code></td>
<td>
<p>character string, name of the numerical variable to plot on the y-axis in quotes</p>
</td></tr>
<tr><td><code id="plotTSGrouped_+3A_ylabel">ylabel</code></td>
<td>
<p>character string, label of the y axis</p>
</td></tr>
<tr><td><code id="plotTSGrouped_+3A_group">group</code></td>
<td>
<p>character string, name of the grouping variable in quotes, e.g. gender.</p>
</td></tr>
<tr><td><code id="plotTSGrouped_+3A_fill_color">fill_color</code></td>
<td>
<p>character string, hexadecimal colour to use in the graph;
(default to ECDC green <code>"#65B32E"</code>,
see <code>EcdcColors(col_scale = "qual", n = length(unique(.data[[group]])))</code></p>
</td></tr>
<tr><td><code id="plotTSGrouped_+3A_log10_scale">log10_scale</code></td>
<td>
<p>boolean, <code>TRUE</code> if y-axis should be log scale
(default <code>FALSE</code> ,see <code>ggplot2::scale_y_log10</code>)</p>
</td></tr>
<tr><td><code id="plotTSGrouped_+3A_xvar_format">xvar_format</code></td>
<td>
<p>character string, time format to use to plot the x-axis
(<code>"%Y"</code> for yearly labels or <code>"%b %Y"</code> for monthly labels)</p>
</td></tr>
<tr><td><code id="plotTSGrouped_+3A_xvar_breaks">xvar_breaks</code></td>
<td>
<p>character string, time unit to use to plot the x-axis between breaks
(<code>"1 year"</code> or <code>"1 month"</code>, see <code>ggplot2::scale_x_date(date_breaks = ... )</code>)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Internal function: <code><a href="#topic+EcdcColors">EcdcColors</a></code> <br />
Required Packages: <code>ggplot2</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- Create dummy data
mydat &lt;- data.frame(TimeCode = seq(as.Date("2008/1/1"), as.Date("2017/1/1"), "years"),
                    YValue = sample(1:79/10, 20),
                    YLabel = rep(c("Acute", "Chronic"), each = 10))

# --- Plot the dummy data
plotTSGrouped(mydat,
              xvar = "TimeCode",
              xlabel = "Year",
              yvar = "YValue",
              ylabel = "Rate per 100 000 population",
              group = "YLabel",
              log10_scale = TRUE,
              xvar_format = "%Y",
              xvar_breaks = "1 year")

# --- Create dummy data
mydat &lt;- data.frame(TimeCode = rep(seq(as.Date("2008/1/1"), as.Date("2017/1/1"), "years"), 5),
                    YValue = c(sample(1:50/10, 10),
                               sample(1:100/10, 10),
                               sample(1:300/10, 10),
                               sample(1:400/10, 10),
                               sample(1:500/10, 10)),
                    YLabel = rep(c("United Kingdom",
                                   "France",
                                   "Spain",
                                   "Netherlands",
                                   "Belgium"), each = 10))

# --- Plot the dummy data
plotTSGrouped(mydat,
              xvar = "TimeCode",
              xlabel = "Year",
              yvar = "YValue",
              ylabel = "Rate per 100 000 population",
              group = "YLabel",
              log10_scale = FALSE,
              xvar_format = "%Y",
              xvar_breaks = "1 year")

</code></pre>

<hr>
<h2 id='previewMap'>Previewing the PNG map</h2><span id='topic+previewMap'></span>

<h3>Description</h3>

<p>Function previewing the disease-specific PNG map
</p>


<h3>Usage</h3>

<pre><code class='language-R'>previewMap(disease, year, reportParameters, pathPNG, namePNGsuffix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="previewMap_+3A_disease">disease</code></td>
<td>
<p>character string, disease code (default <code>"DENGUE"</code>).</p>
</td></tr>
<tr><td><code id="previewMap_+3A_year">year</code></td>
<td>
<p>numeric, year to produce the graph for (default <code>2019</code>).</p>
</td></tr>
<tr><td><code id="previewMap_+3A_reportparameters">reportParameters</code></td>
<td>
<p>dataframe, dataset including the required parameters
for the graph and report production (default <code>AERparams</code>) (see specification
of the dataset in the package vignette with <code>browseVignettes(package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="previewMap_+3A_pathpng">pathPNG</code></td>
<td>
<p>character string, full path to the folder containing the maps in PNG
(default 'maps' folder included in the package <code>system.file("maps", package = "EpiReport")</code>)</p>
</td></tr>
<tr><td><code id="previewMap_+3A_namepngsuffix">namePNGsuffix</code></td>
<td>
<p>character string, suffix of the PNG file name of the map
(i.e. <code>"COUNT"</code>, <code>"RATE"</code> or <code>"AGESTANDARDISED"</code>.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Preview
</p>


<h3>See Also</h3>

<p>Global function: <code><a href="#topic+getMap">getMap</a></code>
</p>

<hr>
<h2 id='SALM2016'>Dataset including Salmonellosis data for 2012-2016</h2><span id='topic+SALM2016'></span>

<h3>Description</h3>

<p>A dataset containing the data and indicators required to build the epidemiological report
for Salmonellosis 2016 TESSy data (default dataset used throughout <code>EpiReport</code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SALM2016
</code></pre>


<h3>Format</h3>

<p>A data frame with 60,775 rows and 18 variables:
</p>

<dl>
<dt>HealthTopicCode</dt><dd><p>Disease code e.g. <code>ANTH</code>, <code>SALM</code>, etc.</p>
</dd>
<dt>MeasureLabel</dt><dd><p>optional) Label of the measure indicator</p>
</dd>
<dt>MeasurePopulation</dt><dd><p>Population targeted by the measure indicator</p>
</dd>
<dt>MeasureCode</dt><dd><p>Code of the measure indicator</p>
</dd>
<dt>MeasureId</dt><dd><p>(optional) Measure indicator ID</p>
</dd>
<dt>MeasureType</dt><dd><p>(optional) Type of measure indicator</p>
</dd>
<dt>TimeUnit</dt><dd><p>Unit of the time variable i.e. <code>Y</code> for yearly data or <code>M</code> for monthly data</p>
</dd>
<dt>GeoLevel</dt><dd><p>(optional) Geographical level e.g. 1, 2, etc</p>
</dd>
<dt>TimeCode</dt><dd><p>Time variable including dates in any formats available
(according to the unit defined in <code>TimeUnit</code>) yearly data (e.g. 2001) or monthly data (e.g. 2001-01)</p>
</dd>
<dt>GeoCode</dt><dd><p>Geographical level in coded format including country names
(e.g. <code>AT</code> for Austria, <code>BE</code> for Belgium, <code>BG</code> for Bulgaria,
see also the <code>EpiReport::MSCode</code> table, correspondence table for Member State labels and codes)</p>
</dd>
<dt>XValue</dt><dd><p>(optional) XValue</p>
</dd>
<dt>XLabel</dt><dd><p>The label associated with the x-axis in the epidemiological report
(see <code>getAgeGender()</code> and <code>plotAgeGender()</code> bar graph for the age variable)</p>
</dd>
<dt>YValue</dt><dd><p>The value associated with the y-axis in the epidemiological report
(see <code>plotAge()</code> bar graph for the variable age, or <code>getTableByMS()</code>
for the number of cases, rate or age-standardised rate in the table by Member States by year)</p>
</dd>
<dt>YLabel</dt><dd><p>The label associated with the y-axis in the epidemiological report
(see <code>getAgeGender()</code> and <code>plotAgeGender()</code> bar graph for the grouping variable gender)</p>
</dd>
<dt>ZValue</dt><dd><p>The value associated with the stratification of XLabel and YLabel
in the age and gender bar graph (see <code>getAgeGender()</code> and <code>plotAgeGender()</code>)</p>
</dd>
<dt>N</dt><dd><p>Number of cases (see <code>getTrend()</code> and <code>getSeason()</code> line graph)</p>
</dd>
<dt>NMissing</dt><dd><p>(optional)</p>
</dd>
<dt>NLowerResolution</dt><dd><p>(optional)</p>
</dd>
</dl>



<h3>See Also</h3>

<p>The correspondence table for Member State labels and codes <code><a href="#topic+MSCode">MSCode</a></code> <br />
and the functions mentioned above: <code><a href="#topic+getAgeGender">getAgeGender</a></code>,
<code><a href="#topic+plotAgeGender">plotAgeGender</a></code>,  <code><a href="#topic+plotAge">plotAge</a></code>,  <code><a href="#topic+getTableByMS">getTableByMS</a></code>,
<code><a href="#topic+getTrend">getTrend</a></code> and <code><a href="#topic+getSeason">getSeason</a></code>.
</p>

<hr>
<h2 id='shapeECDCFlexTable'>Shaping the final table (layout, title, color, font)</h2><span id='topic+shapeECDCFlexTable'></span>

<h3>Description</h3>

<p>Shaping the final table including titles, adding background color, specifying font name and size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shapeECDCFlexTable(ft, headers, fsize, fname, maincolor, lastbold)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shapeECDCFlexTable_+3A_ft">ft</code></td>
<td>
<p>flextable (see <code>'flextable'</code> package), table to shape into ECDC table layout</p>
</td></tr>
<tr><td><code id="shapeECDCFlexTable_+3A_headers">headers</code></td>
<td>
<p>dataframe including the multiple headers to add to the flextable object.
Please note that the column <code>col_keys</code> should contain the names of the flextable object
(i.e. <code>col_key = names(x)</code>), accordingly to <code>set_header_df</code>.</p>
</td></tr>
<tr><td><code id="shapeECDCFlexTable_+3A_fsize">fsize</code></td>
<td>
<p>numeric, font to use (Default 7)</p>
</td></tr>
<tr><td><code id="shapeECDCFlexTable_+3A_fname">fname</code></td>
<td>
<p>character, font name (Default <code>"Tahoma"</code>)</p>
</td></tr>
<tr><td><code id="shapeECDCFlexTable_+3A_maincolor">maincolor</code></td>
<td>
<p>character string, hexadecimal code for the header background
color (Default <code>EcdcColors(col_scale = "green", n=1)</code>)</p>
</td></tr>
<tr><td><code id="shapeECDCFlexTable_+3A_lastbold">lastbold</code></td>
<td>
<p>bolean, last row in bold (Default <code>TRUE</code>),
usually used when the last row includes totals (EU/EEA totals)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>flextable object (see <code>flextable</code> package)
</p>


<h3>See Also</h3>

<p>Global function: <code><a href="#topic+getTableByMS">getTableByMS</a></code> <br />
Required package <code>flextable</code>
</p>

<hr>
<h2 id='toCapTitle'>Capitalise first letter</h2><span id='topic+toCapTitle'></span>

<h3>Description</h3>

<p>Capitalise the first letter of a character string in order to use it as title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toCapTitle(str)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="toCapTitle_+3A_str">str</code></td>
<td>
<p>character string to capitalise as a title</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>my_title &lt;- "number of salmonellosis cases by age group"
toCapTitle(my_title)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
