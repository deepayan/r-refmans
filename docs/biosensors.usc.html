<!DOCTYPE html><html lang="en"><head><title>Help for package biosensors.usc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {biosensors.usc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#biosensors.usc'><p>biosensors.usc Package</p></a></li>
<li><a href='#clustering'><p>clustering</p></a></li>
<li><a href='#clustering_prediction'><p>clustering_prediction</p></a></li>
<li><a href='#generate_data'><p>generate_data</p></a></li>
<li><a href='#hypothesis_testing'><p>hypothesis_testing</p></a></li>
<li><a href='#load_data'><p>load_data</p></a></li>
<li><a href='#nadayara_prediction'><p>nadayara_prediction</p></a></li>
<li><a href='#nadayara_regression'><p>nadayara_regression</p></a></li>
<li><a href='#regmod_prediction'><p>regmod_prediction</p></a></li>
<li><a href='#regmod_regression'><p>regmod_regression</p></a></li>
<li><a href='#ridge_regression'><p>ridge_regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Distributional Data Analysis Techniques for Biosensor Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-11</td>
</tr>
<tr>
<td>Description:</td>
<td>Unified and user-friendly framework for using new 
             distributional representations of biosensors data in different statistical modeling 
             tasks: regression models, hypothesis testing, cluster analysis, visualization, and 
             descriptive analysis. Distributional representations are a functional extension of 
             compositional time-range metrics and we have used them successfully so far in modeling 
             glucose profiles and accelerometer data. However, these functional representations can 
             be used to represent any biosensor data such as ECG or medical imaging such as fMRI.
             Matabuena M, Petersen A, Vidal JC, Gude F. "Glucodensities: A new representation of 
             glucose profiles using distributional data analysis" (2021) 
             &lt;<a href="https://doi.org/10.1177%2F0962280221998064">doi:10.1177/0962280221998064</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, graphics, stats, methods, utils, energy, fda.usc,
parallelDist, osqp, truncnorm</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>Yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-03 19:11:30 UTC; martakaras</td>
</tr>
<tr>
<td>Author:</td>
<td>Juan C. Vidal <a href="https://orcid.org/0000-0002-8682-6772"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Marcos Matabuena <a href="https://orcid.org/0000-0003-3841-4447"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Marta Karas <a href="https://orcid.org/0000-0001-5889-3970"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Juan C. Vidal &lt;juan.vidal@usc.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-05 05:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='biosensors.usc'>biosensors.usc Package</h2><span id='topic+biosensors.usc'></span>

<h3>Description</h3>

<p>Biosensor data have the potential to improve disease control and detection. However,
the analysis of these data under free-living conditions is not feasible with current
statistical techniques. To address this challenge, we introduce a new functional
representation of biosensor data, termed the glucodensity, together with a data
analysis framework based on distances between them. The new data analysis procedure
is illustrated through an application in diabetes with continuous-time glucose
monitoring (CGM) data. In this domain, we show marked improvement with respect to
state-of-the-art analysis methods. In particular, our findings demonstrate that (i)
the glucodensity possesses an extraordinary clinical sensitivity to capture the
typical biomarkers used in the standard clinical practice in diabetes; (ii) previous
biomarkers cannot accurately predict glucodensity, so that the latter is a richer
source of information and; (iii) the glucodensity is a natural generalization of the
time in range metric, this being the gold standard in the handling of CGM data.
Furthermore, the new method overcomes many of the drawbacks of time in range metrics
and provides more indepth insight into assessing glucose metabolism.
</p>


<h3>Author(s)</h3>

<p>Juan C. Vidal <a href="mailto:juan.vidal@usc.es">juan.vidal@usc.es</a>
</p>
<p>Marcos Matabuena <a href="mailto:marcos.matabuena@usc.es">marcos.matabuena@usc.es</a>
</p>

<hr>
<h2 id='clustering'>clustering</h2><span id='topic+clustering'></span>

<h3>Description</h3>

<p>Performs energy clustering with Wasserstein distance using quantile distributional representations as covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clustering(data, clusters=3, iter_max=10, restarts=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clustering_+3A_data">data</code></td>
<td>
<p>A biosensor object.</p>
</td></tr>
<tr><td><code id="clustering_+3A_clusters">clusters</code></td>
<td>
<p>Number of clusters.</p>
</td></tr>
<tr><td><code id="clustering_+3A_iter_max">iter_max</code></td>
<td>
<p>Maximum number of iterations.</p>
</td></tr>
<tr><td><code id="clustering_+3A_restarts">restarts</code></td>
<td>
<p>Number of restarts.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class bclustering:
<code>data</code> A data frame with biosensor raw data.
<code>result</code> A kgroups object (see energy library).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data extracted from the paper: Hall, H., Perelman, D., Breschi, A., Limcaoco, P., Kellogg, R.,
# McLaughlin, T., Snyder, M., Glucotypes reveal new patterns of glucose dysregulation, PLoS
# biology 16(7), 2018.
file1 = system.file("extdata", "data_1.csv", package = "biosensors.usc")
file2 = system.file("extdata", "variables_1.csv", package = "biosensors.usc")
data = load_data(file1, file2)
clus = clustering(data, clusters=3)
</code></pre>

<hr>
<h2 id='clustering_prediction'>clustering_prediction</h2><span id='topic+clustering_prediction'></span>

<h3>Description</h3>

<p>Predicts the cluster of each element of the objects list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clustering_prediction(clustering, objects)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clustering_prediction_+3A_clustering">clustering</code></td>
<td>
<p>A gl.clustering object.</p>
</td></tr>
<tr><td><code id="clustering_prediction_+3A_objects">objects</code></td>
<td>
<p>Matrix of objects to cluster.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The clusters to which these objects are assigned.
</p>

<hr>
<h2 id='generate_data'>generate_data</h2><span id='topic+generate_data'></span>

<h3>Description</h3>

<p>Generates a quantile regression model V + V2 * v + tau * V2 * Q0 where Q0 is a truncated random variable, v = 2 * X, tau = 2 * X, V ~ Unif(-1, 1), V2 ~ Unif(-1, -1), V3 ~ Unif(0.8, 1.2), and E(V|X) = tau * Q0;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_data(n = 100, Qp = 100, Xp = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_data_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="generate_data_+3A_qp">Qp</code></td>
<td>
<p>Dimension of the quantile.</p>
</td></tr>
<tr><td><code id="generate_data_+3A_xp">Xp</code></td>
<td>
<p>Dimension of covariates where X_i~Unif(0,1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A biosensor object:
<code>data</code> NULL.
<code>densities</code> NULL.
<code>quantiles</code> A functional data object (fdata) with the empirical quantile estimation.
<code>variables</code> A data frame with Xp covariates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data = generate_data(n=100, Qp=100, Xp=5)
names(data)
head(data$quantiles)
head(data$variables)
plot(data$quantiles, main="Quantile curves")
</code></pre>

<hr>
<h2 id='hypothesis_testing'>hypothesis_testing</h2><span id='topic+hypothesis_testing'></span>

<h3>Description</h3>

<p>Hypothesis testing between two random samples of distributional representations to detect differences in scale and localization (ANOVA test) or distributional differences (Energy distance).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hypothesis_testing(data1, data2, permutations=100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hypothesis_testing_+3A_data1">data1</code></td>
<td>
<p>A biosensor object. First population.</p>
</td></tr>
<tr><td><code id="hypothesis_testing_+3A_data2">data2</code></td>
<td>
<p>A biosensor object. Second population.</p>
</td></tr>
<tr><td><code id="hypothesis_testing_+3A_permutations">permutations</code></td>
<td>
<p>Number of permutations used in the energy distance calibration test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class biotest:
<code>p1_mean</code> Quantile mean of the first population.
<code>p1_variance</code> Quantile variance of the first population.
<code>p2_mean</code> Quantile mean of the second population.
<code>p2_variance</code> Quantile variance of the second population.
<code>energy_pvalue</code> P-value of the energy distance test.
<code>anova_pvalue</code> P-value of the ANOvA-Fréchet test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data extracted from the paper: Hall, H., Perelman, D., Breschi, A., Limcaoco, P., Kellogg, R.,
# McLaughlin, T., Snyder, M., Glucotypes reveal new patterns of glucose dysregulation, PLoS
# biology 16(7), 2018.
file1 = system.file("extdata", "data_1.csv", package = "biosensors.usc")
file2 = system.file("extdata", "variables_1.csv", package = "biosensors.usc")
data1 = load_data(file1, file2)
file3 = system.file("extdata", "data_2.csv", package = "biosensors.usc")
file4 = system.file("extdata", "variables_2.csv", package = "biosensors.usc")
data2 = load_data(file3, file4)
htest = hypothesis_testing(data1, data2)
</code></pre>

<hr>
<h2 id='load_data'>load_data</h2><span id='topic+load_data'></span>

<h3>Description</h3>

<p>R function to read biosensors data from a csv files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_data(filename_fdata, filename_variables = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load_data_+3A_filename_fdata">filename_fdata</code></td>
<td>
<p>A csv file with the functional data. The csv file must have long format with, at least, the following three columns: id, time, and value, where the id identifies the individual, the time indicates the moment in which the data was captured, and the value is a monitor measure.</p>
</td></tr>
<tr><td><code id="load_data_+3A_filename_variables">filename_variables</code></td>
<td>
<p>A csv file with the clinical variables. The csv file contains a row per individual and must have a column id identifying this individual.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A biosensor object:
<code>data</code> A data frame with biosensor raw data.
<code>densities</code> A functional data object (fdata) with a non-parametric density estimation.
<code>quantiles</code> A functional data object (fdata) with the empirical quantile estimation.
<code>variables</code> A data frame with the covariates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data extracted from the paper: Hall, H., Perelman, D., Breschi, A., Limcaoco, P., Kellogg, R.,
# McLaughlin, T., Snyder, M., Glucotypes reveal new patterns of glucose dysregulation, PLoS
# biology 16(7), 2018.
file1 = system.file("extdata", "data_1.csv", package = "biosensors.usc")
file2 = system.file("extdata", "variables_1.csv", package = "biosensors.usc")
data = load_data(file1, file2)
names(data)
head(data$quantiles)
head(data$variables)
plot(data$quantiles, main="Quantile curves")
</code></pre>

<hr>
<h2 id='nadayara_prediction'>nadayara_prediction</h2><span id='topic+nadayara_prediction'></span>

<h3>Description</h3>

<p>Functional non-parametric Nadaraya-Watson prediction with 2-Wasserstein distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nadayara_prediction(nadaraya, Qpred, hs=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nadayara_prediction_+3A_nadaraya">nadaraya</code></td>
<td>
<p>A Nadaraya regression object.</p>
</td></tr>
<tr><td><code id="nadayara_prediction_+3A_qpred">Qpred</code></td>
<td>
<p>Quantile curves that will be used in the predictions</p>
</td></tr>
<tr><td><code id="nadayara_prediction_+3A_hs">hs</code></td>
<td>
<p>Smoothing parameters for the predictions, by default hs = seq(0.8, 15, length = 200)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class bnadarayapred:
<code>prediction</code> The Nadaraya-Watson prediction for the test data at each value of hs.
<code>hs</code> Hs values used for the prediction.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data extracted from the paper: Hall, H., Perelman, D., Breschi, A., Limcaoco, P., Kellogg, R.,
# McLaughlin, T., Snyder, M., Glucotypes reveal new patterns of glucose dysregulation, PLoS
# biology 16(7), 2018.
file1 = system.file("extdata", "data_1.csv", package = "biosensors.usc")
file2 = system.file("extdata", "variables_1.csv", package = "biosensors.usc")
data = load_data(file1, file2)
nada = nadayara_regression(data, "BMI")
# Example of prediction with the column mean of quantiles
npre = nadayara_prediction(nada, t(colMeans(data$quantiles$data)))
</code></pre>

<hr>
<h2 id='nadayara_regression'>nadayara_regression</h2><span id='topic+nadayara_regression'></span>

<h3>Description</h3>

<p>Functional non-parametric Nadaraya-Watson regression with 2-Wasserstein distance, using as predictor the distributional representation and as response a scalar outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nadayara_regression(data, response)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nadayara_regression_+3A_data">data</code></td>
<td>
<p>A biosensor object.</p>
</td></tr>
<tr><td><code id="nadayara_regression_+3A_response">response</code></td>
<td>
<p>The name of the scalar response. The response must be a column name in data$variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class bnadaraya:
<code>prediction</code> The Nadaraya-Watson prediction for each point of the training data at each h=seq(0.8, 15, length=200).
<code>r2</code> R2 estimation for the training data at each h=seq(0.8, 15, length=200).
<code>error</code> Standard mean-squared error after applying leave-one-out cross-validation for the training data at each h=seq(0.8, 15, length=200).
<code>data</code> A data frame with biosensor raw data.
<code>response</code> The name of the scalar response.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data extracted from the paper: Hall, H., Perelman, D., Breschi, A., Limcaoco, P., Kellogg, R.,
# McLaughlin, T., Snyder, M., Glucotypes reveal new patterns of glucose dysregulation, PLoS
# biology 16(7), 2018.
file1 = system.file("extdata", "data_1.csv", package = "biosensors.usc")
file2 = system.file("extdata", "variables_1.csv", package = "biosensors.usc")
data = load_data(file1, file2)
nada = nadayara_regression(data, "BMI")
</code></pre>

<hr>
<h2 id='regmod_prediction'>regmod_prediction</h2><span id='topic+regmod_prediction'></span>

<h3>Description</h3>

<p>Performs the Wasserstein regression using quantile functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regmod_prediction(data, xpred)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regmod_prediction_+3A_data">data</code></td>
<td>
<p>A bregmod object.</p>
</td></tr>
<tr><td><code id="regmod_prediction_+3A_xpred">xpred</code></td>
<td>
<p>A kxp matrix of input values for regressors for prediction, where k is the number of points we do the prediction and p is the dimension of the input variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A kxm array. Qpred(l, :) is the regression prediction of Q given X = xpred(l, :)' where m is the dimension of the grid of quantile function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data extracted from the paper: Hall, H., Perelman, D., Breschi, A., Limcaoco, P., Kellogg, R.,
# McLaughlin, T., Snyder, M., Glucotypes reveal new patterns of glucose dysregulation, PLoS
# biology 16(7), 2018.
file1 = system.file("extdata", "data_1.csv", package = "biosensors.usc")
file2 = system.file("extdata", "variables_1.csv", package = "biosensors.usc")
data = load_data(file1, file2)
regm = regmod_regression(data, "BMI")
# Example of prediction
xpred = as.matrix(25)
g1rmp = regmod_prediction(regm, xpred)
</code></pre>

<hr>
<h2 id='regmod_regression'>regmod_regression</h2><span id='topic+regmod_regression'></span>

<h3>Description</h3>

<p>Performs the Wasserstein regression using quantile functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regmod_regression(data, response)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regmod_regression_+3A_data">data</code></td>
<td>
<p>A biosensor object.</p>
</td></tr>
<tr><td><code id="regmod_regression_+3A_response">response</code></td>
<td>
<p>The name of the scalar response. The response must be a column name in data$variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class bregmod containing the components:
<code>beta</code> The beta coefficient functions of the fitting.
<code>prediction</code> The prediction for each training data.
<code>residuals</code> The residuals for each prediction value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data extracted from the paper: Hall, H., Perelman, D., Breschi, A., Limcaoco, P., Kellogg, R.,
# McLaughlin, T., Snyder, M., Glucotypes reveal new patterns of glucose dysregulation, PLoS
# biology 16(7), 2018.
file1 = system.file("extdata", "data_1.csv", package = "biosensors.usc")
file2 = system.file("extdata", "variables_1.csv", package = "biosensors.usc")
data = load_data(file1, file2)
regm = regmod_regression(data, "BMI")
</code></pre>

<hr>
<h2 id='ridge_regression'>ridge_regression</h2><span id='topic+ridge_regression'></span>

<h3>Description</h3>

<p>Performs a Ridge regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ridge_regression(data, response, w=NULL, method="manhattan", type="gaussian")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ridge_regression_+3A_data">data</code></td>
<td>
<p>A biosensor object.</p>
</td></tr>
<tr><td><code id="ridge_regression_+3A_response">response</code></td>
<td>
<p>The name of the scalar response. The response must be a column name in data$variables.</p>
</td></tr>
<tr><td><code id="ridge_regression_+3A_w">w</code></td>
<td>
<p>A weight function.</p>
</td></tr>
<tr><td><code id="ridge_regression_+3A_method">method</code></td>
<td>
<p>The distance measure to be used (@seealso parallelDist::parDist). By default manhattan distance.</p>
</td></tr>
<tr><td><code id="ridge_regression_+3A_type">type</code></td>
<td>
<p>The kernel type (&quot;gaussian&quot; or &quot;lapla&quot;). By default gaussian distance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object containing the components:
<code>best_alphas</code> Best coefficients obtained with leave-one-out cross-validation criteria.
<code>best_kernel</code> The kernel matrix of the best solution.
<code>best_sigma</code> The sigma parameter of the best solution.
<code>best_lambda</code> The lambda parameter of the best solution.
<code>sigmas</code> The sigma parameters used in the fitting according to the median heuristic fitting criteria.
<code>predictions</code> A matrix of predictions.
<code>r2</code> R-square of the different models fitted.
<code>error</code> Mean squared-error of the different models fitted.
<code>predictions_cross</code> A matrix of predictions obtained with leave-one-out cross-validation criteria.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data extracted from the paper: Hall, H., Perelman, D., Breschi, A., Limcaoco, P., Kellogg, R.,
# McLaughlin, T., Snyder, M., Glucotypes reveal new patterns of glucose dysregulation, PLoS
# biology 16(7), 2018.
file1 = system.file("extdata", "data_1.csv", package = "biosensors.usc")
file2 = system.file("extdata", "variables_1.csv", package = "biosensors.usc")
data = load_data(file1, file2)
regm = ridge_regression(data, "BMI")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
