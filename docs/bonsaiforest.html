<!DOCTYPE html><html lang="en-US"><head><title>Help for package bonsaiforest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bonsaiforest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bonsaiforest-package'><p>bonsaiforest: Shrinkage Based Forest Plots</p></a></li>
<li><a href='#ahr_estimation'><p>Average Hazard Ratio Estimation</p></a></li>
<li><a href='#ahr_from_km'><p>Average Hazard Estimation based on Kaplan-Meier Estimates</p></a></li>
<li><a href='#compare'><p>Compare Treatment Estimate Methods</p></a></li>
<li><a href='#cut_norm_quant'><p>Helper for Cutting into Normal Quantiles</p></a></li>
<li><a href='#design_dummy1'><p>Design Dummy Subgroup x_1a</p></a></li>
<li><a href='#design_matrix1'><p>Design Matrix Subgroup x_1a</p></a></li>
<li><a href='#elastic_net'><p>Elastic Net Penalization Model Estimation</p></a></li>
<li><a href='#elastic_net_fit_bin'><p>Elastic Net Fit Binary</p></a></li>
<li><a href='#elastic_net_fit_surv'><p>Elastic Net Fit Survival</p></a></li>
<li><a href='#elastic_net_surv'><p>H0, Coefficients Elastic Net Survival Model and Matrices</p></a></li>
<li><a href='#est_coef_bin1'><p>Estimated coefficients elastic net Binary</p></a></li>
<li><a href='#example_data'><p>Example data</p></a></li>
<li><a href='#generate_stacked_data'><p>Generation of Stacked Data by Subgroups</p></a></li>
<li><a href='#horseshoe'><p>Bayesian Shrinkage Model Estimation</p></a></li>
<li><a href='#horseshoe_fit_bin'><p>Horseshoe Fit Binary</p></a></li>
<li><a href='#horseshoe_fit_surv'><p>Horseshoe Fit Survival</p></a></li>
<li><a href='#km_fun'><p>Helper Function to get Kaplan-Meier Estimate</p></a></li>
<li><a href='#lor_estimation'><p>Estimation of Log-Odds Ratio</p></a></li>
<li><a href='#naive'><p>Naive Model Estimation</p></a></li>
<li><a href='#naive_fit_bin'><p>Naive Fit Binary</p></a></li>
<li><a href='#naive_fit_surv'><p>Naive Fit Survival</p></a></li>
<li><a href='#naivepop'><p>Naive Overall Population Model Estimation</p></a></li>
<li><a href='#naivepop_fit_bin'><p>Naivepop Fit Binary</p></a></li>
<li><a href='#naivepop_fit_surv'><p>Naivepop Fit Survival</p></a></li>
<li><a href='#plot.compare.data'><p>Compare Forest Plots</p></a></li>
<li><a href='#plot.summary.elastic_net'><p>Forest plot Summary Elastic Net</p></a></li>
<li><a href='#plot.summary.horseshoe'><p>Forest plot Summary Horseshoe</p></a></li>
<li><a href='#plot.summary.naive'><p>Forest plot Summary Naive</p></a></li>
<li><a href='#preprocess'><p>Data Preprocessing</p></a></li>
<li><a href='#print.summary.elastic_net'><p>Print Function for Elastic Net Summary</p></a></li>
<li><a href='#print.summary.horseshoe'><p>Print Function for Horseshoe Summary</p></a></li>
<li><a href='#print.summary.naive'><p>Print Function for Naive Summary</p></a></li>
<li><a href='#print.summary.naivepop'><p>Print Function for Naivepop Summary</p></a></li>
<li><a href='#simul_covariates'><p>Generation of a Design Matrix for Simulations</p></a></li>
<li><a href='#simul_data'><p>Simulate Covariates and Progression Free Survival Data</p></a></li>
<li><a href='#simul_pfs'><p>Simulation of Progression Free Survival Times</p></a></li>
<li><a href='#subgroups'><p>Subgroup Treatment Effect</p></a></li>
<li><a href='#summary.elastic_net'><p>Summary Elastic Net Function</p></a></li>
<li><a href='#summary.horseshoe'><p>Summary Horseshoe Function</p></a></li>
<li><a href='#summary.naive'><p>Summary Naive</p></a></li>
<li><a href='#summary.naivepop'><p>Summary Naivepop Function</p></a></li>
<li><a href='#survival_curves'><p>Average Survival Curves</p></a></li>
<li><a href='#trt_horseshoe'><p>Subgroup Treatment Effect Horseshoe</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Shrinkage Based Forest Plots</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-25</td>
</tr>
<tr>
<td>Description:</td>
<td>Subgroup analyses are routinely performed in clinical trial
    analyses. From a methodological perspective, two key issues of
    subgroup analyses are multiplicity (even if only predefined subgroups
    are investigated) and the low sample sizes of subgroups which lead to
    highly variable estimates, see e.g. Yusuf et al (1991)
    &lt;<a href="https://doi.org/10.1001%2Fjama.1991.03470010097038">doi:10.1001/jama.1991.03470010097038</a>&gt;.  This package implements
    subgroup estimates based on Bayesian shrinkage priors, see Carvalho et
    al (2019) <a href="https://proceedings.mlr.press/v5/carvalho09a.html">https://proceedings.mlr.press/v5/carvalho09a.html</a>. In
    addition, estimates based on penalized likelihood inference are
    available, based on Simon et al (2011) &lt;<a href="https://doi.org/10.18637%2Fjss.v039.i05">doi:10.18637/jss.v039.i05</a>&gt;.
    The corresponding shrinkage based forest plots address the
    aforementioned issues and can complement standard forest plots in
    practical clinical trial analyses.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/insightsengineering/bonsaiforest/">https://github.com/insightsengineering/bonsaiforest/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/insightsengineering/bonsaiforest/issues">https://github.com/insightsengineering/bonsaiforest/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>brms (&ge; 2.22.0), broom, checkmate, dplyr, forcats, gbm,
ggplot2, glmnet, MASS, Rcpp, splines2, stats, survival, tibble,
tidyr, tidyselect, vdiffr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2.9000</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-26 11:53:59 UTC; gravesti</td>
</tr>
<tr>
<td>Author:</td>
<td>Mar Vazquez Rabunal [aut],
  Daniel Sabanés Bové [aut],
  Marcel Wolbers [aut],
  Isaac Gravestock [cre],
  F. Hoffmann-La Roche AG [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Isaac Gravestock &lt;isaac.gravestock@roche.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-27 12:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bonsaiforest-package'>bonsaiforest: Shrinkage Based Forest Plots</h2><span id='topic+bonsaiforest'></span><span id='topic+bonsaiforest-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Subgroup analyses are routinely performed in clinical trial analyses. From a methodological perspective, two key issues of subgroup analyses are multiplicity (even if only predefined subgroups are investigated) and the low sample sizes of subgroups which lead to highly variable estimates, see e.g. Yusuf et al (1991) <a href="https://doi.org/10.1001/jama.1991.03470010097038">doi:10.1001/jama.1991.03470010097038</a>. This package implements subgroup estimates based on Bayesian shrinkage priors, see Carvalho et al (2019) <a href="https://proceedings.mlr.press/v5/carvalho09a.html">https://proceedings.mlr.press/v5/carvalho09a.html</a>. In addition, estimates based on penalized likelihood inference are available, based on Simon et al (2011) <a href="https://doi.org/10.18637/jss.v039.i05">doi:10.18637/jss.v039.i05</a>. The corresponding shrinkage based forest plots address the aforementioned issues and can complement standard forest plots in practical clinical trial analyses.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Isaac Gravestock <a href="mailto:isaac.gravestock@roche.com">isaac.gravestock@roche.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Mar Vazquez Rabunal <a href="mailto:mar.vazquez_rabunal@roche.com">mar.vazquez_rabunal@roche.com</a>
</p>
</li>
<li><p> Daniel Sabanés Bové <a href="mailto:daniel.sabanes_bove@roche.com">daniel.sabanes_bove@roche.com</a>
</p>
</li>
<li><p> Marcel Wolbers <a href="mailto:marcel.wolbers@roche.com">marcel.wolbers@roche.com</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> F. Hoffmann-La Roche AG [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/insightsengineering/bonsaiforest/">https://github.com/insightsengineering/bonsaiforest/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/insightsengineering/bonsaiforest/issues">https://github.com/insightsengineering/bonsaiforest/issues</a>
</p>
</li></ul>


<hr>
<h2 id='ahr_estimation'>Average Hazard Ratio Estimation</h2><span id='topic+ahr_estimation'></span>

<h3>Description</h3>

<p>Function to obtain the average hazard ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ahr_estimation(x_subg, dummy_subg, est_coef, h0, gamma = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ahr_estimation_+3A_x_subg">x_subg</code></td>
<td>
<p>(<code>matrix</code>)<br /> the matrix with the subgroup covariates.</p>
</td></tr>
<tr><td><code id="ahr_estimation_+3A_dummy_subg">dummy_subg</code></td>
<td>
<p>(<code>matrix</code>)<br /> the dummy matrix with the subgroup
covariates.</p>
</td></tr>
<tr><td><code id="ahr_estimation_+3A_est_coef">est_coef</code></td>
<td>
<p>(<code>matrix</code>)<br /> the estimated coefficients from the fitted
model.</p>
</td></tr>
<tr><td><code id="ahr_estimation_+3A_h0">h0</code></td>
<td>
<p>(<code>numeric</code>)<br /> the vector with the cumulative baseline hazard.</p>
</td></tr>
<tr><td><code id="ahr_estimation_+3A_gamma">gamma</code></td>
<td>
<p>(<code>scalar</code>)<br /> numeric value defining the weights to obtain
the average hazard ratio. Default is 1 (in this case the average hazard
ratio obtained can be interpreted as the odds of concordance).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Average hazard ratio
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ahr_estimation(
  elastic_net_surv$design1, elastic_net_surv$dummy1,
  elastic_net_surv$est_coef, elastic_net_surv$h0
)
</code></pre>

<hr>
<h2 id='ahr_from_km'>Average Hazard Estimation based on Kaplan-Meier Estimates</h2><span id='topic+ahr_from_km'></span>

<h3>Description</h3>

<p>Average Hazard Estimation based on Kaplan-Meier Estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ahr_from_km(resp, trt, data, status, t_quantile = 0.99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ahr_from_km_+3A_resp">resp</code></td>
<td>
<p>(<code>string</code>)<br /> the response variable name.</p>
</td></tr>
<tr><td><code id="ahr_from_km_+3A_trt">trt</code></td>
<td>
<p>(<code>string</code>)<br /> the treatment variable name. The treatment variable
must be a factor with 2 levels where the first level is the control and the
second one the treatment.</p>
</td></tr>
<tr><td><code id="ahr_from_km_+3A_data">data</code></td>
<td>
<p>(<code style="white-space: pre;">&#8288;data frame&#8288;</code>)<br /> the data frame with the variables.</p>
</td></tr>
<tr><td><code id="ahr_from_km_+3A_status">status</code></td>
<td>
<p>(<code>string</code>)<br /> the status variable name in survival data.</p>
</td></tr>
<tr><td><code id="ahr_from_km_+3A_t_quantile">t_quantile</code></td>
<td>
<p>(<code>number</code>)<br /> definition of the quantile.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimates can be unstable due to the variability of the Kaplan-Meier estimates
in the tails. The <code>t_quantile</code> argument can address this, e.g. by setting it to
0.95, the 5% highest times will be discarded. By default, the 1% highest times
are discarded.
</p>


<h3>Value</h3>

<p>The estimated average hazard ratio of the treatment (second level of <code>trt</code>)
versus the control (first level of <code>trt</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ahr_from_km("tt_pfs", "arm", example_data, "ev_pfs")
ahr_from_km("tt_pfs", "arm", example_data, "ev_pfs", t_quantile = 0.95)
</code></pre>

<hr>
<h2 id='compare'>Compare Treatment Estimate Methods</h2><span id='topic+compare'></span>

<h3>Description</h3>

<p>Function to create a data set with the results for all the methods in order
to compare them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_+3A_...">...</code></td>
<td>
<p>Objects of class <code>bonsaiforest</code>. We write them separated by a comma.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with a <code>data.frame</code> of the estimated subgroup treatment effects,
with the overall treatment effect and with the response type of our data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>compare(naivepop_fit_surv, naive_fit_surv, elastic_net_fit_surv)
</code></pre>

<hr>
<h2 id='cut_norm_quant'>Helper for Cutting into Normal Quantiles</h2><span id='topic+cut_norm_quant'></span>

<h3>Description</h3>

<p>Helper for Cutting into Normal Quantiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cut_norm_quant(x, prob, labels = letters[seq_along(c(prob, 1))])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cut_norm_quant_+3A_x">x</code></td>
<td>
<p>(<code>numeric</code>)<br /> continuous covariate values.</p>
</td></tr>
<tr><td><code id="cut_norm_quant_+3A_prob">prob</code></td>
<td>
<p>(<code>numeric</code>)<br /> probabilities for the standard normal quantiles.</p>
</td></tr>
<tr><td><code id="cut_norm_quant_+3A_labels">labels</code></td>
<td>
<p>(<code>character</code>)<br /> corresponding labels for the resulting factor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The factor variable.
</p>

<hr>
<h2 id='design_dummy1'>Design Dummy Subgroup x_1a</h2><span id='topic+design_dummy1'></span>

<h3>Description</h3>

<p>The dummy design matrix from <code>example_data</code> considering just observations
from subgroup x_1a.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design_dummy1
</code></pre>


<h3>Format</h3>

<p>A <code>matrix</code> with 0 and 1 indicating the subgroups of each of the observations.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='design_matrix1'>Design Matrix Subgroup x_1a</h2><span id='topic+design_matrix1'></span>

<h3>Description</h3>

<p>The design matrix from <code>example_data</code> considering just observations
from subgroup x_1a.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design_matrix1
</code></pre>


<h3>Format</h3>

<p>A <code>matrix</code> with 0 and 1 indicating the subgroups of each of the observations
and their interactions with the treatment variable.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='elastic_net'>Elastic Net Penalization Model Estimation</h2><span id='topic+elastic_net'></span>

<h3>Description</h3>

<p>Function to fit the elastic net penalization model to the data. This model
penalizes the interaction between the covariates and the treatment but
leaves unpenalized the main effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elastic_net(
  resp,
  trt,
  subgr,
  covars,
  data,
  resptype = c("survival", "binary"),
  alpha,
  status = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elastic_net_+3A_resp">resp</code></td>
<td>
<p>(<code>string</code>)<br /> the response variable name.</p>
</td></tr>
<tr><td><code id="elastic_net_+3A_trt">trt</code></td>
<td>
<p>(<code>string</code>)<br /> the treatment variable name. The treatment variable
must be a factor with 2 levels where the first level is the control and the
second one the treatment.</p>
</td></tr>
<tr><td><code id="elastic_net_+3A_subgr">subgr</code></td>
<td>
<p>(<code>character</code>)<br /> vector with the name of the subgroup variables
from which we want to obtain the subgroup treatment effect. They have to be
<code>factor</code> variables with the subgroups as levels.</p>
</td></tr>
<tr><td><code id="elastic_net_+3A_covars">covars</code></td>
<td>
<p>(<code>character</code>)<br /> vector with the name of the variables that
we want to include in the model. They have to be <code>factor</code> variables with the
subgroups as levels. The <code>subgr</code> variables have to be included here.</p>
</td></tr>
<tr><td><code id="elastic_net_+3A_data">data</code></td>
<td>
<p>(<code style="white-space: pre;">&#8288;data frame&#8288;</code>)<br /> the data frame with the variables.</p>
</td></tr>
<tr><td><code id="elastic_net_+3A_resptype">resptype</code></td>
<td>
<p>(<code>string</code>)<br /> the type of data used. Can be &quot;survival&quot;
or &quot;binary&quot;.</p>
</td></tr>
<tr><td><code id="elastic_net_+3A_alpha">alpha</code></td>
<td>
<p>(<code>scalar</code>)<br /> the elastic net mixing parameter with values
between 0 and 1. The special case of <code>alpha</code>=1 corresponds to a lasso
penalty and the case of <code>alpha</code>=0 to a ridge penalty.</p>
</td></tr>
<tr><td><code id="elastic_net_+3A_status">status</code></td>
<td>
<p>(<code>string</code>)<br /> only for &quot;survival&quot; <code>resptype</code>,
the status variable name in survival data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>fit</code>, <code>model</code>, <code>resptype</code>, <code>data</code>, <code>alpha</code>,
<code>design_matrix</code>, <code>design_dummy</code>, <code>y</code>, <code>subgr_names</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elastic_net(
  "tt_pfs", "arm", c("x_1", "x_2"), c("x_1", "x_2", "x_3"),
  example_data, "survival", 1, "ev_pfs"
)
</code></pre>

<hr>
<h2 id='elastic_net_fit_bin'>Elastic Net Fit Binary</h2><span id='topic+elastic_net_fit_bin'></span>

<h3>Description</h3>

<p>A fitted model with the elastic_net function and binary data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elastic_net_fit_bin
</code></pre>


<h3>Format</h3>

<p>A <code>elastic_net</code> object fitted with <code>example_data</code>, considering as subgroup
variables all the covariates x_1, ..., x_10 and <code>binary</code> response type.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='elastic_net_fit_surv'>Elastic Net Fit Survival</h2><span id='topic+elastic_net_fit_surv'></span>

<h3>Description</h3>

<p>A fitted model with the elastic_net function and survival data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elastic_net_fit_surv
</code></pre>


<h3>Format</h3>

<p>A <code>elastic_net</code> object fitted with <code>example_data</code>, considering as subgroup
variables all the covariates x_1, ..., x_10 and <code>survival</code> response type.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='elastic_net_surv'>H0, Coefficients Elastic Net Survival Model and Matrices</h2><span id='topic+elastic_net_surv'></span>

<h3>Description</h3>

<p>List with the cumulative baseline hazard, with the estimated coefficients
of the model fitted with an elastic net and survival data, with the general
design matrix and with the design and dummy matrices for subgroup x_1a.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elastic_net_surv
</code></pre>


<h3>Format</h3>

<p>A <code>list</code> with three elements:
</p>

<ul>
<li> <p><code>h0</code>: the cumulative baseline hazard.
</p>
</li>
<li> <p><code>est_coef</code>: the estimated coefficients of the fitted model.
</p>
</li>
<li> <p><code>x</code>: the design matrix of the model.
</p>
</li>
<li> <p><code>dummy1</code>: the dummy matrix of the model for subgroup x_1a.
</p>
</li>
<li> <p><code>design1</code>: the design matrix of the model for subgroup x_1a.
</p>
</li></ul>



<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='est_coef_bin1'>Estimated coefficients elastic net Binary</h2><span id='topic+est_coef_bin1'></span>

<h3>Description</h3>

<p>The coefficients of the model <code>elastic_net_fit_bin</code> when lambda takes the
value that leads to minimal cross validation error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_coef_bin1
</code></pre>


<h3>Format</h3>

<p>A <code>matrix</code> with the coefficients of the elastic net model.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='example_data'>Example data</h2><span id='topic+example_data'></span>

<h3>Description</h3>

<p>A simulated data set for a realistic scenario of a clinical trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_data
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 1000 rows and 14 columns:
</p>

<ul>
<li> <p><code>id</code>: Integer variable with the id of the patient.
</p>
</li>
<li> <p><code>arm</code>: Factor variable with 2 levels: control and treatment.
</p>
</li>
<li> <p><code>x_1</code>, <code>x_2</code>, <code>x_3</code>, <code>x_4</code>, <code>x_5</code>, <code>x_6</code>, <code>x_7</code>, <code>x_8</code>, <code>x_9</code>, <code>x_10</code>:
Factor variables that represent covariates of the patients
(e.g. sex, region, race, etc.).
</p>
</li>
<li> <p><code>tt_pfs</code>: Continuous variable with the progression free survival time
of each patient.
</p>
</li>
<li> <p><code>ev_pfs</code>: Binary variable with the progression free survival status
of each patient. 0 indicates that the event of interest did not happen
and 1 indicates that it did.
</p>
</li></ul>



<h3>Source</h3>

<p>This is an artificial dataset.
</p>

<hr>
<h2 id='generate_stacked_data'>Generation of Stacked Data by Subgroups</h2><span id='topic+generate_stacked_data'></span>

<h3>Description</h3>

<p>Function to generate stacked data by the subgroups considered in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_stacked_data(
  base_model,
  subgroup_model,
  data,
  resptype = c("survival", "binary")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_stacked_data_+3A_base_model">base_model</code></td>
<td>
<p>(<code>formula</code>)<br /> the formula of the basic model that is going
to be fitted. Depending on <code>resptype</code> it will be the formula corresponding
to a coxph model or to a glm model. In the case of &quot;survival&quot; a formula like
Surv(time, status) ~ trt would be expected  and in the &quot;binary&quot; case a
formula like y ~ trt.</p>
</td></tr>
<tr><td><code id="generate_stacked_data_+3A_subgroup_model">subgroup_model</code></td>
<td>
<p>(<code>formula</code>)<br /> the formula with all the subgroup
variables.</p>
</td></tr>
<tr><td><code id="generate_stacked_data_+3A_data">data</code></td>
<td>
<p>(<code style="white-space: pre;">&#8288;data frame&#8288;</code>)<br /> the data frame with the variables.</p>
</td></tr>
<tr><td><code id="generate_stacked_data_+3A_resptype">resptype</code></td>
<td>
<p>(<code>string</code>)<br /> the type of data used. Can be &quot;survival&quot;
or &quot;binary&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame of the stacked data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>generate_stacked_data(Surv(tt_pfs, ev_pfs) ~ arm, ~ x_1 + x_2, example_data, "survival")
</code></pre>

<hr>
<h2 id='horseshoe'>Bayesian Shrinkage Model Estimation</h2><span id='topic+horseshoe'></span>

<h3>Description</h3>

<p>Function to fit a bayesian shrinkage model with a regularized horseshoe prior
on the interaction coefficients between the subgrouping covariates and
the treatment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>horseshoe(
  resp,
  trt,
  subgr,
  covars,
  data,
  resptype = c("survival", "binary"),
  status = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="horseshoe_+3A_resp">resp</code></td>
<td>
<p>(<code>string</code>)<br /> the response variable name.</p>
</td></tr>
<tr><td><code id="horseshoe_+3A_trt">trt</code></td>
<td>
<p>(<code>string</code>)<br /> the treatment variable name.The treatment variable
must be a factor with 2 levels where the first level is the control and the
second one the treatment.</p>
</td></tr>
<tr><td><code id="horseshoe_+3A_subgr">subgr</code></td>
<td>
<p>(<code>character</code>)<br /> vector with the name of the subgroup variables
from which we want to obtain the subgroup treatment effect. They have to be
<code>factor</code> variables with the subgroups as levels.</p>
</td></tr>
<tr><td><code id="horseshoe_+3A_covars">covars</code></td>
<td>
<p>(<code>character</code>)<br /> vector with the name of the variables that
we want to include in the model. They have to be <code>factor</code> variables with the
subgroups as levels. The <code>subgr</code> variables have to be included here.</p>
</td></tr>
<tr><td><code id="horseshoe_+3A_data">data</code></td>
<td>
<p>(<code style="white-space: pre;">&#8288;data frame&#8288;</code>)<br /> the data frame with the variables.</p>
</td></tr>
<tr><td><code id="horseshoe_+3A_resptype">resptype</code></td>
<td>
<p>(<code>string</code>)<br /> the type of data used. Can be &quot;survival&quot;
or &quot;binary&quot;.</p>
</td></tr>
<tr><td><code id="horseshoe_+3A_status">status</code></td>
<td>
<p>(<code>string</code>)<br /> only for &quot;survival&quot; <code>resptype</code>,
the status variable name in survival data.</p>
</td></tr>
<tr><td><code id="horseshoe_+3A_...">...</code></td>
<td>
<p>Additional arguments from the <code>brm</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>fit</code>, <code>model</code>, <code>resptype</code>, <code>data</code>, <code>alpha</code>,
<code>design_matrix</code>, <code>design_dummy</code>, <code>y</code>, <code>subgr_names</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
horseshoe("ev_pfs", "arm", c("x_1", "x_2"), c("x_1", "x_2", "x_3"),
  example_data, "binary",
  chains = 1, seed = 0, control = list(adapt_delta = 0.95),
  iter = 50 # In practice, you need to omit this or set it much higher!
)

</code></pre>

<hr>
<h2 id='horseshoe_fit_bin'>Horseshoe Fit Binary</h2><span id='topic+horseshoe_fit_bin'></span>

<h3>Description</h3>

<p>A fitted model with the horseshoe function and binary data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>horseshoe_fit_bin
</code></pre>


<h3>Format</h3>

<p>A <code>horseshoe</code> object fitted with <code>example_data</code>, considering as subgroup
variables just the covariates x_1 and x_2 and <code>binary</code> response type.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='horseshoe_fit_surv'>Horseshoe Fit Survival</h2><span id='topic+horseshoe_fit_surv'></span>

<h3>Description</h3>

<p>A fitted model with the horseshoe function and survival data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>horseshoe_fit_surv
</code></pre>


<h3>Format</h3>

<p>A <code>horseshoe</code> object fitted with <code>example_data</code>, considering as subgroup
variables just the covariates x_1 and x_2 and <code>survival</code> response type.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='km_fun'>Helper Function to get Kaplan-Meier Estimate</h2><span id='topic+km_fun'></span>

<h3>Description</h3>

<p>Helper Function to get Kaplan-Meier Estimate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>km_fun(resp, status, data, times)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="km_fun_+3A_resp">resp</code></td>
<td>
<p>(<code>string</code>)<br /> the response variable name.</p>
</td></tr>
<tr><td><code id="km_fun_+3A_status">status</code></td>
<td>
<p>(<code>string</code>)<br /> only for &quot;survival&quot; <code>resptype</code>,
the status variable name in survival data.</p>
</td></tr>
<tr><td><code id="km_fun_+3A_data">data</code></td>
<td>
<p>(<code>data.frame</code>)<br /> data to use.</p>
</td></tr>
<tr><td><code id="km_fun_+3A_times">times</code></td>
<td>
<p>(<code>numeric</code>)<br /> time points to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with Kaplan-Meier estimates at <code>times</code>.
</p>

<hr>
<h2 id='lor_estimation'>Estimation of Log-Odds Ratio</h2><span id='topic+lor_estimation'></span>

<h3>Description</h3>

<p>Function to estimate the subgroup log-odds ratio for binary data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lor_estimation(x_subg, dummy_subg, est_coef)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lor_estimation_+3A_x_subg">x_subg</code></td>
<td>
<p>(<code>matrix</code>)<br /> the matrix with the subgroup covariates.</p>
</td></tr>
<tr><td><code id="lor_estimation_+3A_dummy_subg">dummy_subg</code></td>
<td>
<p>(<code>matrix</code>)<br /> the dummy matrix with the subgroup
covariates.</p>
</td></tr>
<tr><td><code id="lor_estimation_+3A_est_coef">est_coef</code></td>
<td>
<p>(<code>matrix</code>)<br /> the estimated coefficients from the fitted
model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Log-odds ratio of the studied subgroup.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lor_estimation(design_matrix1, design_dummy1, est_coef_bin1)
</code></pre>

<hr>
<h2 id='naive'>Naive Model Estimation</h2><span id='topic+naive'></span>

<h3>Description</h3>

<p>Function to fit the naive models to the data of each one of the subgroups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive(
  resp,
  trt,
  subgr,
  data,
  resptype = c("survival", "binary"),
  status = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="naive_+3A_resp">resp</code></td>
<td>
<p>(<code>string</code>)<br /> the response variable name.</p>
</td></tr>
<tr><td><code id="naive_+3A_trt">trt</code></td>
<td>
<p>(<code>string</code>)<br /> the treatment variable name. The treatment variable
must be a factor with 2 levels where the first level is the control and the
second one the treatment.</p>
</td></tr>
<tr><td><code id="naive_+3A_subgr">subgr</code></td>
<td>
<p>(<code>character</code>)<br /> vector with the name of the subgrouping
variables. These variables have to be <code>factor</code> variables with the subgroups
as levels.</p>
</td></tr>
<tr><td><code id="naive_+3A_data">data</code></td>
<td>
<p>(<code style="white-space: pre;">&#8288;data frame&#8288;</code>)<br /> the data frame with the variables.</p>
</td></tr>
<tr><td><code id="naive_+3A_resptype">resptype</code></td>
<td>
<p>(<code>string</code>)<br /> the type of data used. Can be &quot;survival&quot;
or &quot;binary&quot;.</p>
</td></tr>
<tr><td><code id="naive_+3A_status">status</code></td>
<td>
<p>(<code>string</code>)<br /> only for &quot;survival&quot; <code>resptype</code>,
the status variable name in survival data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>fit</code>, <code>estimates</code>, <code>model</code>, <code>resptype</code>, <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>naive("tt_pfs", "arm", c("x_1", "x_2"), example_data, "survival", "ev_pfs")
</code></pre>

<hr>
<h2 id='naive_fit_bin'>Naive Fit Binary</h2><span id='topic+naive_fit_bin'></span>

<h3>Description</h3>

<p>A fitted model with the naive function and binary data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive_fit_bin
</code></pre>


<h3>Format</h3>

<p>A <code>naive</code> object fitted with <code>example_data</code>, considering as subgroup
variables all the covariates x_1, ..., x_10 and <code>binary</code> response type.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='naive_fit_surv'>Naive Fit Survival</h2><span id='topic+naive_fit_surv'></span>

<h3>Description</h3>

<p>A fitted model with the naive function and survival data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive_fit_surv
</code></pre>


<h3>Format</h3>

<p>A <code>naive</code> object fitted with <code>example_data</code>, considering as subgroup
variables all the covariates x_1, ..., x_10 and <code>survival</code> response type.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='naivepop'>Naive Overall Population Model Estimation</h2><span id='topic+naivepop'></span>

<h3>Description</h3>

<p>Function to fit the naive overall population model to the data. This model is going to
estimate the subgroup treatment effects with the overall population
treatment effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naivepop(resp, trt, data, resptype = c("survival", "binary"), status = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="naivepop_+3A_resp">resp</code></td>
<td>
<p>(<code>string</code>)<br /> the response variable name.</p>
</td></tr>
<tr><td><code id="naivepop_+3A_trt">trt</code></td>
<td>
<p>(<code>string</code>)<br /> the treatment variable name. The treatment variable
must be a factor with 2 levels where the first level is the control and the
second one the treatment.</p>
</td></tr>
<tr><td><code id="naivepop_+3A_data">data</code></td>
<td>
<p>(<code style="white-space: pre;">&#8288;data frame&#8288;</code>)<br /> the data frame with the variables.</p>
</td></tr>
<tr><td><code id="naivepop_+3A_resptype">resptype</code></td>
<td>
<p>(<code>string</code>)<br /> the type of data used. Can be &quot;survival&quot;
or &quot;binary&quot;.</p>
</td></tr>
<tr><td><code id="naivepop_+3A_status">status</code></td>
<td>
<p>(<code>string</code>)<br /> only for &quot;survival&quot; <code>resptype</code>,
the status variable name in survival data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>fit</code>, <code>model</code>, <code>resptype</code>, <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>naivepop("tt_pfs", "arm", example_data, "survival", "ev_pfs")
</code></pre>

<hr>
<h2 id='naivepop_fit_bin'>Naivepop Fit Binary</h2><span id='topic+naivepop_fit_bin'></span>

<h3>Description</h3>

<p>A fitted model with the naivepop function and binary data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naivepop_fit_bin
</code></pre>


<h3>Format</h3>

<p>A <code>naivepop</code> object fitted with <code>example_data</code>, considering as subgroup
variables all the covariates x_1, ..., x_10 and <code>binary</code> response type.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='naivepop_fit_surv'>Naivepop Fit Survival</h2><span id='topic+naivepop_fit_surv'></span>

<h3>Description</h3>

<p>A fitted model with the naivepop function and survival data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naivepop_fit_surv
</code></pre>


<h3>Format</h3>

<p>A <code>naivepop</code> object fitted with <code>example_data</code>, considering as subgroup
variables all the covariates x_1, ..., x_10 and <code>survival</code> response type.
</p>


<h3>Source</h3>

<p>This is an artificial example.
</p>

<hr>
<h2 id='plot.compare.data'>Compare Forest Plots</h2><span id='topic+plot.compare.data'></span>

<h3>Description</h3>

<p>Function to obtain a forest plot with all the different fitted models in
order to compare their performance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'compare.data'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.compare.data_+3A_x">x</code></td>
<td>
<p>(<code>compare.data</code>)<br /> object with the data of treatment effects estimated
with the different methods.</p>
</td></tr>
<tr><td><code id="plot.compare.data_+3A_...">...</code></td>
<td>
<p>Additional arguments to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Forest plot with all the methods that are compared.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(compare(naivepop_fit_surv, naive_fit_surv, elastic_net_fit_surv))
</code></pre>

<hr>
<h2 id='plot.summary.elastic_net'>Forest plot Summary Elastic Net</h2><span id='topic+plot.summary.elastic_net'></span>

<h3>Description</h3>

<p>Plot the forest plot of the summary of a <code>elastic_net</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.elastic_net'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.summary.elastic_net_+3A_x">x</code></td>
<td>
<p>(<code>summary.elastic_net</code>)<br /> summary of a <code>elastic_net</code> object.</p>
</td></tr>
<tr><td><code id="plot.summary.elastic_net_+3A_...">...</code></td>
<td>
<p>Additional arguments to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Forest plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(summary(elastic_net_fit_surv))
</code></pre>

<hr>
<h2 id='plot.summary.horseshoe'>Forest plot Summary Horseshoe</h2><span id='topic+plot.summary.horseshoe'></span>

<h3>Description</h3>

<p>Plot the forest plot of the summary of a <code>horseshoe</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.horseshoe'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.summary.horseshoe_+3A_x">x</code></td>
<td>
<p>(<code>summary.horseshoe</code>)<br /> summary of a <code>horseshoe</code> object.</p>
</td></tr>
<tr><td><code id="plot.summary.horseshoe_+3A_...">...</code></td>
<td>
<p>Additional arguments to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Forest plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(summary(horseshoe_fit_bin))
</code></pre>

<hr>
<h2 id='plot.summary.naive'>Forest plot Summary Naive</h2><span id='topic+plot.summary.naive'></span>

<h3>Description</h3>

<p>Plot the forest plot of the summary of a <code>naive</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.naive'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.summary.naive_+3A_x">x</code></td>
<td>
<p>(<code>summary.naive</code>)<br /> summary of a <code>naive</code> object.</p>
</td></tr>
<tr><td><code id="plot.summary.naive_+3A_...">...</code></td>
<td>
<p>Additional arguments to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Forest plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(summary(naive_fit_surv))
</code></pre>

<hr>
<h2 id='preprocess'>Data Preprocessing</h2><span id='topic+preprocess'></span>

<h3>Description</h3>

<p>Function to preprocess the data and obtain the design matrices corresponding
to a model with just interaction of the covariates with the treatment,
to a model with just the main effects and to a model just with the covariates
and one-hot encoding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocess(trt, subgr, covars, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="preprocess_+3A_trt">trt</code></td>
<td>
<p>(<code>string</code>)<br /> the treatment variable name. The treatment variable
must be a factor with 2 levels where the first level is the control and the
second one the treatment.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_subgr">subgr</code></td>
<td>
<p>(<code>character</code>)<br /> vector with the name of the subgroup variables
from which we want to obtain the subgroup treatment effect.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_covars">covars</code></td>
<td>
<p>(<code>character</code>)<br /> vector with the name of the variables that
we want to include in the model. The <code>subgr</code> variables have to be included
here.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_data">data</code></td>
<td>
<p>(<code style="white-space: pre;">&#8288;data frame&#8288;</code>)<br /> the data frame with the variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>design_ia</code>, <code>design_main</code>, <code>design_dummy</code>, <code>subgr_names</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>preprocess("arm", c("x_1", "x_2"), c("x_1", "x_2", "x_3"), example_data)
</code></pre>

<hr>
<h2 id='print.summary.elastic_net'>Print Function for Elastic Net Summary</h2><span id='topic+print.summary.elastic_net'></span>

<h3>Description</h3>

<p>Function that prints the summary of a elastic_net object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.elastic_net'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.elastic_net_+3A_x">x</code></td>
<td>
<p>(<code>summary.elastic_net</code>)<br /> Summary of a <code>elastic_net</code> object.</p>
</td></tr>
<tr><td><code id="print.summary.elastic_net_+3A_...">...</code></td>
<td>
<p>Other arguments of print.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The summary of the object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(summary(elastic_net_fit_bin))
</code></pre>

<hr>
<h2 id='print.summary.horseshoe'>Print Function for Horseshoe Summary</h2><span id='topic+print.summary.horseshoe'></span>

<h3>Description</h3>

<p>Function that prints the summary of a horseshoe object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.horseshoe'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.horseshoe_+3A_x">x</code></td>
<td>
<p>(<code>summary.horseshoe</code>)<br /> Summary of a <code>horseshoe</code> object.</p>
</td></tr>
<tr><td><code id="print.summary.horseshoe_+3A_...">...</code></td>
<td>
<p>Other arguments of print.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The summary of the object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(summary(horseshoe_fit_bin))
</code></pre>

<hr>
<h2 id='print.summary.naive'>Print Function for Naive Summary</h2><span id='topic+print.summary.naive'></span>

<h3>Description</h3>

<p>Function that prints the summary of a naive object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.naive'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.naive_+3A_x">x</code></td>
<td>
<p>(<code>summary.naive</code>)<br /> Summary of a <code>naive</code> object.</p>
</td></tr>
<tr><td><code id="print.summary.naive_+3A_...">...</code></td>
<td>
<p>Other arguments of print.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The summary of the object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(summary(naive_fit_bin))
</code></pre>

<hr>
<h2 id='print.summary.naivepop'>Print Function for Naivepop Summary</h2><span id='topic+print.summary.naivepop'></span>

<h3>Description</h3>

<p>Function that prints the summary of a naivepop object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.naivepop'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.naivepop_+3A_x">x</code></td>
<td>
<p>(<code>summary.naivepop</code>)<br /> Summary of a <code>naivepop</code> object.</p>
</td></tr>
<tr><td><code id="print.summary.naivepop_+3A_...">...</code></td>
<td>
<p>Other arguments of print.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The summary of the object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(summary(naivepop_fit_bin))
</code></pre>

<hr>
<h2 id='simul_covariates'>Generation of a Design Matrix for Simulations</h2><span id='topic+simul_covariates'></span>

<h3>Description</h3>

<p>This function uses a block diagonal covariance matrix for the underlying
multivariate normal data to create the design matrix in blocks of 10, see
the details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simul_covariates(n, p_catvar = 10, add_contvars = FALSE, arm_factor = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simul_covariates_+3A_n">n</code></td>
<td>
<p>(<code>count</code>)<br /> number of rows (observations).</p>
</td></tr>
<tr><td><code id="simul_covariates_+3A_p_catvar">p_catvar</code></td>
<td>
<p>(<code>count</code>)<br /> number of covariates (excluding treatment arm).</p>
</td></tr>
<tr><td><code id="simul_covariates_+3A_add_contvars">add_contvars</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to add continuous covariates.</p>
</td></tr>
<tr><td><code id="simul_covariates_+3A_arm_factor">arm_factor</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to make the arm variable a factor.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following pattern is repeated for the covariate blocks:
</p>

<ul>
<li><p> The first 5 covariates are uncorrelated with everything.
</p>
</li>
<li><p> The covariates 6 to 8 have &quot;moderate&quot; correlation (0.25) between each other.
</p>
</li>
<li><p> The covariates 9 and 10 have &quot;high&quot; correlation (0.5).
</p>
</li></ul>

<p>By default, only the resulting categorical covariates obtained by thresholding
are included. Optionally also the original continuous covariates are included
in the returned design matrix.
</p>


<h3>Value</h3>

<p>The design matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simul_covariates(n = 10, p_catvar = 3, add_contvars = FALSE)
simul_covariates(n = 10, p_catvar = 3, add_contvars = TRUE)
simul_covariates(n = 10, p_catvar = 3, add_contvars = TRUE, arm_factor = TRUE)
</code></pre>

<hr>
<h2 id='simul_data'>Simulate Covariates and Progression Free Survival Data</h2><span id='topic+simul_data'></span>

<h3>Description</h3>

<p>This combines the covariates simulation via <code><a href="#topic+simul_covariates">simul_covariates()</a></code> with 10
categorical covariates, and the PFS simulation via <code><a href="#topic+simul_pfs">simul_pfs()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simul_data(n, add_interaction = FALSE, coefs, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simul_data_+3A_n">n</code></td>
<td>
<p>(<code>count</code>)<br /> number of patients.</p>
</td></tr>
<tr><td><code id="simul_data_+3A_add_interaction">add_interaction</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to add interaction terms between covariates
1 and 2.</p>
</td></tr>
<tr><td><code id="simul_data_+3A_coefs">coefs</code></td>
<td>
<p>(<code>numeric</code>)<br /> named vector of coefficients to set.</p>
</td></tr>
<tr><td><code id="simul_data_+3A_...">...</code></td>
<td>
<p>additional parameters apart from the linear predictor values
needed for <code><a href="#topic+simul_pfs">simul_pfs()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Regression coefficients are for an AFT with over-parametrized dummy
coding for arm-subgroup interactions.
</p>


<h3>Value</h3>

<p>A combined <code>data.frame</code> with the <code>id</code> column, the design matrix and the
PFS outcomes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(321)
simul_data(
  n = 100,
  coefs = c(arm1 = 1),
  sigma_aft = 1,
  recr_duration = 0.2,
  rate_cens = 2,
  n_events = 20
)
</code></pre>

<hr>
<h2 id='simul_pfs'>Simulation of Progression Free Survival Times</h2><span id='topic+simul_pfs'></span>

<h3>Description</h3>

<p>Simulation of Progression Free Survival Times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simul_pfs(
  lp_aft,
  sigma_aft,
  recr_duration,
  rate_cens,
  n_events,
  add_uncensored_pfs = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simul_pfs_+3A_lp_aft">lp_aft</code></td>
<td>
<p>(<code>numeric</code>)<br /> linear predictor values for the accelerate failure time model (AFT).</p>
</td></tr>
<tr><td><code id="simul_pfs_+3A_sigma_aft">sigma_aft</code></td>
<td>
<p>(<code>number</code>)<br /> standard deviation for the AFT model.</p>
</td></tr>
<tr><td><code id="simul_pfs_+3A_recr_duration">recr_duration</code></td>
<td>
<p>(<code>number</code>)<br /> duration of recruitment.</p>
</td></tr>
<tr><td><code id="simul_pfs_+3A_rate_cens">rate_cens</code></td>
<td>
<p>(<code>number</code>)<br /> rate for the exponentially distributed censoring process.</p>
</td></tr>
<tr><td><code id="simul_pfs_+3A_n_events">n_events</code></td>
<td>
<p>(<code>count</code>)<br /> number of events to reach for the study end.</p>
</td></tr>
<tr><td><code id="simul_pfs_+3A_add_uncensored_pfs">add_uncensored_pfs</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to add the uncensored PFS as well to the resulting
<code>data.frame</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with columns <code>tt_pfs</code> (PFS time) and <code>ev_pfs</code> (corresponding
event indicator with 1 for an event and 0 for censored), and optionally
<code>tt_pfs_uncens</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
simul_pfs(
  lp_aft = rnorm(100),
  sigma_aft = 1,
  recr_duration = 0.2,
  rate_cens = 2,
  n_events = 20
)
</code></pre>

<hr>
<h2 id='subgroups'>Subgroup Treatment Effect</h2><span id='topic+subgroups'></span>

<h3>Description</h3>

<p>Function to obtain the estimated treatment effect in each one of the
considered subgroups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subgroups(object, est_coef, h0 = NULL, gamma = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subgroups_+3A_object">object</code></td>
<td>
<p>(<code>bonsaiforest</code>)<br /> the fitted bonsaiforest object.</p>
</td></tr>
<tr><td><code id="subgroups_+3A_est_coef">est_coef</code></td>
<td>
<p>(<code>matrix</code>)<br /> the estimated coefficients from the fitted
model.</p>
</td></tr>
<tr><td><code id="subgroups_+3A_h0">h0</code></td>
<td>
<p>(<code>numeric</code>)<br /> the vector with the cumulative baseline hazard.
Present just for <code>resptype</code> survival.</p>
</td></tr>
<tr><td><code id="subgroups_+3A_gamma">gamma</code></td>
<td>
<p>(<code>scalar</code>)<br /> numeric value defining the weights to obtain
the average hazard ratio. Default is 1 (in this case the average hazard
ratio obtained can be interpreted as the odds of concordance).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> with the subgroup names and with the estimated subgroup
treatment effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subgroups(
  elastic_net_fit_surv, elastic_net_surv$est_coef,
  elastic_net_surv$h0
)
</code></pre>

<hr>
<h2 id='summary.elastic_net'>Summary Elastic Net Function</h2><span id='topic+summary.elastic_net'></span>

<h3>Description</h3>

<p>Function to obtain the naive subgroup treatment effects of an object fitted
with the <code>elastic_net</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'elastic_net'
summary(object, gamma = 1, l = NULL, lambda = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.elastic_net_+3A_object">object</code></td>
<td>
<p>(<code>elastic_net</code>)<br /> the elastic_net object.</p>
</td></tr>
<tr><td><code id="summary.elastic_net_+3A_gamma">gamma</code></td>
<td>
<p>(<code>scalar</code>)<br /> numeric value defining the weights to obtain
the average hazard ratio. Default is 1 (in this case the average hazard
ratio obtained can be interpreted as the odds of concordance). Just needed
when using survival data.</p>
</td></tr>
<tr><td><code id="summary.elastic_net_+3A_l">l</code></td>
<td>
<p>(<code>scalar</code>)<br /> the maximum value of time that wants to be studied to
obtain the average hazard ratio. Default is the maximum value of time when
there was an event. Just needed when using survival data.</p>
</td></tr>
<tr><td><code id="summary.elastic_net_+3A_lambda">lambda</code></td>
<td>
<p>(<code>scalar</code>)<br /> the penalization constant in the elastic net.
Default is the value that leads to minimal cross validation error.</p>
</td></tr>
<tr><td><code id="summary.elastic_net_+3A_...">...</code></td>
<td>
<p>Arguments of summary</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>summary.elastic_net</code> which is a <code>list</code> with the
estimated subgroup treatment effects, the <code>resptype</code>, the confidence level
and the value of <code>alpha</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(elastic_net_fit_surv)
</code></pre>

<hr>
<h2 id='summary.horseshoe'>Summary Horseshoe Function</h2><span id='topic+summary.horseshoe'></span>

<h3>Description</h3>

<p>Function to obtain the estimated subgroup treatment effects from a <code>horseshoe</code>
model and a credible interval for them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'horseshoe'
summary(object, conf = 0.95, gamma = 1, l = NULL, m = 50, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.horseshoe_+3A_object">object</code></td>
<td>
<p>(<code>horseshoe</code>)<br /> the horseshoe object.</p>
</td></tr>
<tr><td><code id="summary.horseshoe_+3A_conf">conf</code></td>
<td>
<p>(<code>scalar</code>)<br /> the level of the credible intervals. Default is
0.95.</p>
</td></tr>
<tr><td><code id="summary.horseshoe_+3A_gamma">gamma</code></td>
<td>
<p>(<code>scalar</code>)<br /> numeric value defining the weights to obtain
the average hazard ratio. Default is 1 (in this case the average hazard
ratio obtained can be interpreted as the odds of concordance). Just needed
when using survival data.</p>
</td></tr>
<tr><td><code id="summary.horseshoe_+3A_l">l</code></td>
<td>
<p>(<code>scalar</code>)<br /> the maximum value of time that wants to be studied to
obtain the average hazard ratio. Default is the maximum value of time when
there was an event. Just needed when using survival data.</p>
</td></tr>
<tr><td><code id="summary.horseshoe_+3A_m">m</code></td>
<td>
<p>(<code>scalar</code>)<br /> the value that defines the equally spaced time points
where the survival curves are going to be studied. Default is 50. Just needed
when using survival data.</p>
</td></tr>
<tr><td><code id="summary.horseshoe_+3A_...">...</code></td>
<td>
<p>Arguments of summary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>summary.horseshoe</code> which is a <code>list</code> with the
approximated posterior distribution of the treatment
effects, a <code>data.frame</code> with the estimated subgroup treatment effect
(with the median) and the bounds of the credible intervals, the <code>resptype</code>
and the confidence level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(horseshoe_fit_bin)
</code></pre>

<hr>
<h2 id='summary.naive'>Summary Naive</h2><span id='topic+summary.naive'></span>

<h3>Description</h3>

<p>Function to obtain the naive subgroup treatment effects of an object fitted
with the <code>naive</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'naive'
summary(object, conf = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.naive_+3A_object">object</code></td>
<td>
<p>(<code>naive</code>)<br /> the naive object.</p>
</td></tr>
<tr><td><code id="summary.naive_+3A_conf">conf</code></td>
<td>
<p>(<code>scalar</code>)<br /> the confidence level of the intervals. Default is
0.95.</p>
</td></tr>
<tr><td><code id="summary.naive_+3A_...">...</code></td>
<td>
<p>Arguments of summary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>summary.elastic_net</code> which is a <code>list</code> with a
<code>data.frame</code> with 4 columns (the subgroup variables, the estimated
treatment effect and the low and high bounds of the confidence interval of the
treatment effect), the <code>resptype</code> and the confidence level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(naive_fit_surv)
</code></pre>

<hr>
<h2 id='summary.naivepop'>Summary Naivepop Function</h2><span id='topic+summary.naivepop'></span>

<h3>Description</h3>

<p>Function to obtain the overall subgroup treatment effect of a
naivepop object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'naivepop'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.naivepop_+3A_object">object</code></td>
<td>
<p>(<code>naivepop</code>)<br /> the naivepop object.</p>
</td></tr>
<tr><td><code id="summary.naivepop_+3A_...">...</code></td>
<td>
<p>Arguments of summary.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>summary.naivepop</code> which is a <code>list</code> with the
estimated subgroup treatment effects and the <code>resptype</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(naivepop_fit_surv)
</code></pre>

<hr>
<h2 id='survival_curves'>Average Survival Curves</h2><span id='topic+survival_curves'></span>

<h3>Description</h3>

<p>Function to obtain the average survival curve from all individual
survival curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survival_curves(x, h0, est_coef)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survival_curves_+3A_x">x</code></td>
<td>
<p>(<code>matrix</code>)<br /> the matrix with the subgroup covariates.</p>
</td></tr>
<tr><td><code id="survival_curves_+3A_h0">h0</code></td>
<td>
<p>(<code>numeric</code>)<br /> the vector with the cumulative baseline hazard.</p>
</td></tr>
<tr><td><code id="survival_curves_+3A_est_coef">est_coef</code></td>
<td>
<p>(<code>matrix</code>)<br /> the estimated coefficients from the fitted
model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The survival probabilities at the sorted event times.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>survival_curves(
  elastic_net_surv$x, elastic_net_surv$h0,
  elastic_net_surv$est_coef
)
</code></pre>

<hr>
<h2 id='trt_horseshoe'>Subgroup Treatment Effect Horseshoe</h2><span id='topic+trt_horseshoe'></span>

<h3>Description</h3>

<p>Function to obtain the estimated posterior distribution of the subgroup
treatment effects considering a horseshoe fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trt_horseshoe(object, gamma = 1, l = NULL, m = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trt_horseshoe_+3A_object">object</code></td>
<td>
<p>(<code>horseshoe</code>)<br /> the horseshoe object.</p>
</td></tr>
<tr><td><code id="trt_horseshoe_+3A_gamma">gamma</code></td>
<td>
<p>(<code>scalar</code>)<br /> numeric value defining the weights to obtain
the average hazard ratio. Default is 1 (in this case the average hazard
ratio obtained can be interpreted as the odds of concordance). Just needed
when using survival data.</p>
</td></tr>
<tr><td><code id="trt_horseshoe_+3A_l">l</code></td>
<td>
<p>(<code>scalar</code>)<br /> the maximum value of time that wants to be studied to
obtain the average hazard ratio. Default is the maximum value of time when
there was an event. Just needed when using survival data.</p>
</td></tr>
<tr><td><code id="trt_horseshoe_+3A_m">m</code></td>
<td>
<p>(<code>scalar</code>)<br /> the value that defines the equally spaced time points
where the survival curves are going to be studied. Default is 50. Just needed
when using survival data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Approximated posterior distribution of the subgroup treatment effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>trt_horseshoe(horseshoe_fit_surv, m = 1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
