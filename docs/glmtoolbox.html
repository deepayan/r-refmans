<!DOCTYPE html><html><head><title>Help for package glmtoolbox</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {glmtoolbox}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adjR2'><p>Adjusted R-squared</p></a></li>
<li><a href='#adjR2.glm'><p>Adjusted R-squared in Generalized Linear Models</p></a></li>
<li><a href='#adjR2.gnm'><p>Adjusted R-squared in Generalized Nonlinear Models</p></a></li>
<li><a href='#adjR2.lm'><p>Adjusted R-squared in Normal Linear Models</p></a></li>
<li><a href='#advertising'><p>Advertising</p></a></li>
<li><a href='#AGPC'><p>AGPC for Generalized Estimating Equations</p></a></li>
<li><a href='#amenorrhea'><p>amenorrhea</p></a></li>
<li><a href='#anova.glmgee'><p>Comparison of nested Generalized Estimating Equations</p></a></li>
<li><a href='#anova.gnm'><p>Comparison of nested models in Generalized Nonlinear Models.</p></a></li>
<li><a href='#anova.overglm'><p>Comparison of nested models for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</p></a></li>
<li><a href='#anova.zeroinflation'><p>Comparison of nested models for Regression Models to deal with Zero-Excess in Count Data</p></a></li>
<li><a href='#anova2'><p>Comparison of nested Generalized Linear Models</p></a></li>
<li><a href='#aucuba'><p>Lesions of Aucuba mosaic virus</p></a></li>
<li><a href='#bestSubset'><p>Best Subset Selection</p></a></li>
<li><a href='#bladder'><p>Bladder cancer in mice</p></a></li>
<li><a href='#BoxTidwell'><p>Box-Tidwell transformations</p></a></li>
<li><a href='#BoxTidwell.glm'><p>Box-Tidwell transformations in Generalized Linear Models</p></a></li>
<li><a href='#BoxTidwell.lm'><p>Box-Tidwell transformations in Normal Linear Models</p></a></li>
<li><a href='#brains'><p>Mammal brain and body weights</p></a></li>
<li><a href='#calls'><p>Calls to a technical support help line</p></a></li>
<li><a href='#cellular'><p>Agents to stimulate cellular differentiation</p></a></li>
<li><a href='#cholecystectomy'><p>Shoulder Pain after Laparoscopic Cholecystectomy</p></a></li>
<li><a href='#CIC'><p>Correlation Information Criterion for Generalized Estimating Equations</p></a></li>
<li><a href='#confint.gnm'><p>Confidence Intervals for Generalized Nonlinear Models</p></a></li>
<li><a href='#confint2'><p>Confidence Intervals for Generalized Linear Models</p></a></li>
<li><a href='#cooks.distance.glmgee'><p>Cook's Distance for Generalized Estimating Equations</p></a></li>
<li><a href='#cooks.distance.gnm'><p>Cook's Distance for Generalized Nonlinear Models</p></a></li>
<li><a href='#cooks.distance.overglm'><p>Cook's Distance for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion</p></a></li>
<li><a href='#cooks.distance.zeroinflation'><p>Cook's Distance for Regression Models to deal with Zero-Excess in Count Data</p></a></li>
<li><a href='#Cortisol'><p>Radioimmunological Assay of Cortisol</p></a></li>
<li><a href='#coupons'><p>Discount coupons</p></a></li>
<li><a href='#depression'><p>Treatment for severe postnatal depression</p></a></li>
<li><a href='#dfbeta.glmgee'><p>Dfbeta for Generalized Estimating Equations</p></a></li>
<li><a href='#dfbeta.gnm'><p>Dfbeta statistic for Generalized Nonlinear Models</p></a></li>
<li><a href='#dfbeta.overglm'><p>Dfbeta statistic for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</p></a></li>
<li><a href='#dfbeta.zeroinflation'><p>Dfbeta statistic for Regression Models to deal with Zero-Excess in Count Data</p></a></li>
<li><a href='#dilution'><p>Dilution Assay</p></a></li>
<li><a href='#Drosophila'><p>Developmental rate of Drosophila melanogaster</p></a></li>
<li><a href='#envelope'><p>Normal QQ-plot with simulated envelope of model residuals</p></a></li>
<li><a href='#envelope.glm'><p>Normal QQ-plot with simulated envelope of residuals in Generalized Linear Models</p></a></li>
<li><a href='#envelope.gnm'><p>Normal QQ-plot with simulated envelope of residuals in Generalized Nonlinear Models</p></a></li>
<li><a href='#envelope.lm'><p>Normal QQ-plot with simulated envelope of residuals for normal linear models</p></a></li>
<li><a href='#envelope.overglm'><p>Normal QQ-plot with Simulated Envelope of Residuals for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion</p></a></li>
<li><a href='#envelope.zeroinflation'><p>Normal QQ-plot with Simulated Envelope of Residuals for Regression Models to deal with Zero-Excess in Count Data</p></a></li>
<li><a href='#estequa'><p>Function to extract estimating equations</p></a></li>
<li><a href='#estequa.glm'><p>Estimating Equations in Generalized Linear Models</p></a></li>
<li><a href='#estequa.glmgee'><p>Estimating Equations in Generalized Estimating Equations</p></a></li>
<li><a href='#estequa.overglm'><p>Estimating Equations for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</p></a></li>
<li><a href='#estequa.zeroinflation'><p>Estimating Equations in Regression Models to deal with Zero-Excess in Count Data</p></a></li>
<li><a href='#fabric'><p>Fabric faults</p></a></li>
<li><a href='#FisherScoring'><p>Fisher Scoring algorithm in Generalized Linear Models</p></a></li>
<li><a href='#GHYC'><p>Gosho-Hamada-Yoshimura's Criterion for Generalized Estimating Equations</p></a></li>
<li><a href='#glmgee'><p>Fit Generalized Estimating Equations</p></a></li>
<li><a href='#gnm'><p>Generalized Nonlinear Models.</p></a></li>
<li><a href='#gnmgee'><p>Fit Nonlinear Generalized Estimating Equations</p></a></li>
<li><a href='#Grass'><p>The effects of fertilizers on coastal Bermuda grass</p></a></li>
<li><a href='#GUIDE'><p>Guidelines for Urinary Incontinence Discussion and Evaluation</p></a></li>
<li><a href='#gvif'><p>Generalized Variance Inflation Factor</p></a></li>
<li><a href='#gvif.glm'><p>Generalized Variance Inflation Factor</p></a></li>
<li><a href='#gvif.lm'><p>Generalized Variance Inflation Factor</p></a></li>
<li><a href='#gvif.overglm'><p>Generalized Variance Inflation Factor for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion</p></a></li>
<li><a href='#hltest'><p>The Hosmer-Lemeshow Goodness-of-Fit Test</p></a></li>
<li><a href='#ldh'><p>ldh</p></a></li>
<li><a href='#leverage'><p>Leverage</p></a></li>
<li><a href='#leverage.glmgee'><p>Leverage for Generalized Estimating Equations</p></a></li>
<li><a href='#liver'><p>Liver cancer in mice</p></a></li>
<li><a href='#localInfluence'><p>Local Influence</p></a></li>
<li><a href='#localInfluence.glm'><p>Local Influence for Generalized Linear Models</p></a></li>
<li><a href='#localInfluence.glmgee'><p>Local Influence for Generalized Estimating Equations</p></a></li>
<li><a href='#localInfluence.gnm'><p>Local Influence for Generalized Nonlinear Models</p></a></li>
<li><a href='#localInfluence.overglm'><p>Local Influence for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion</p></a></li>
<li><a href='#mammary'><p>Ability of retinyl acetate to prevent mammary cancer in rats</p></a></li>
<li><a href='#Melanopus'><p>Assay of an Insecticide with a Synergist</p></a></li>
<li><a href='#Oranges'><p>Oranges</p></a></li>
<li><a href='#orobanche'><p>Germination of Orobanche Seeds</p></a></li>
<li><a href='#ossification'><p>Teratogenic effects of phenytoin and trichloropropene oxide</p></a></li>
<li><a href='#overglm'><p>Alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</p></a></li>
<li><a href='#PAC'><p>Pardo-Alonso's Criterion for Generalized Estimating Equations</p></a></li>
<li><a href='#pipeline'><p>Alaska pipeline</p></a></li>
<li><a href='#predict.glmgee'><p>Predictions for Generalized Estimating Equations</p></a></li>
<li><a href='#QIC'><p>QIC for Generalized Estimating Equations</p></a></li>
<li><a href='#rabbits'><p>Age and Eye Lens Weight of Rabbits in Australia</p></a></li>
<li><a href='#races'><p>Hill races in Scotland</p></a></li>
<li><a href='#residuals.glmgee'><p>Residuals for Generalized Estimating Equations</p></a></li>
<li><a href='#residuals.gnm'><p>Residuals for Generalized Nonlinear Models</p></a></li>
<li><a href='#residuals.overglm'><p>Residuals for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</p></a></li>
<li><a href='#residuals.zeroinflation'><p>Residuals in Regression Models to deal with Zero-Excess in Count Data</p></a></li>
<li><a href='#residuals2'><p>Residuals for Linear and Generalized Linear Models</p></a></li>
<li><a href='#richness'><p>Species richness</p></a></li>
<li><a href='#rinse'><p>Dental Clinical Trial</p></a></li>
<li><a href='#RJC'><p>Rotnitzky–Jewell's Criterion for Generalized Estimating Equations</p></a></li>
<li><a href='#ROCc'><p>The Receiver Operating Characteristic (ROC) Curve</p></a></li>
<li><a href='#Seizures'><p>Seizures</p></a></li>
<li><a href='#SGPC'><p>SGPC for Generalized Estimating Equations</p></a></li>
<li><a href='#shelflife'><p>Shelf life of a photographic developer</p></a></li>
<li><a href='#skincancer'><p>Skin cancer in women</p></a></li>
<li><a href='#spruces'><p>Effect of ozone-enriched atmosphere on growth of sitka spruces</p></a></li>
<li><a href='#Steel'><p>Hardened Steel</p></a></li>
<li><a href='#stepCriterion'><p>Variable selection in regression models from a chosen criterion</p></a></li>
<li><a href='#stepCriterion.glm'><p>Variable Selection in Generalized Linear Models</p></a></li>
<li><a href='#stepCriterion.glmgee'><p>Variable selection in Generalized Estimating Equations</p></a></li>
<li><a href='#stepCriterion.lm'><p>Variable Selection in Normal Linear Models</p></a></li>
<li><a href='#stepCriterion.overglm'><p>Variable selection for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion</p></a></li>
<li><a href='#swimmers'><p>Self diagnozed ear infections in swimmers</p></a></li>
<li><a href='#Trajan'><p>Roots Produced by the Columnar Apple Cultivar Trajan.</p></a></li>
<li><a href='#uti'><p>Urinary Tract Infections in HIV-infected Men</p></a></li>
<li><a href='#vcov.glmgee'><p>Estimate of the variance-covariance matrix in GEEs</p></a></li>
<li><a href='#vdtest'><p>Test for Varying Dispersion Parameter</p></a></li>
<li><a href='#vdtest.glm'><p>Test for Varying Dispersion Parameter in Generalized Linear Models</p></a></li>
<li><a href='#vdtest.gnm'><p>Test for Varying Dispersion Parameter in Generalized Nonlinear Models</p></a></li>
<li><a href='#vdtest.lm'><p>Test for Varying Dispersion Parameter in Normal Linear Models</p></a></li>
<li><a href='#wglmgee'><p>Fit Weighted Generalized Estimating Equations</p></a></li>
<li><a href='#zero.excess'><p>Test for zero-excess in Count Regression Models</p></a></li>
<li><a href='#zeroalt'><p>Zero-Altered Regression Models to deal with Zero-Excess in Count Data</p></a></li>
<li><a href='#zeroinf'><p>Zero-Inflated Regression Models to deal with Zero-Excess in Count Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Set of Tools to Data Analysis using Generalized Linear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.11</td>
</tr>
<tr>
<td>Description:</td>
<td>Set of tools for the statistical analysis of data using: (1) normal linear models; (2) generalized linear models; (3) negative binomial regression models as alternative to the Poisson regression models under the presence of overdispersion; (4) beta-binomial and random-clumped binomial regression models as alternative to the binomial regression models under the presence of overdispersion; (5) Zero-inflated and zero-altered regression models to deal with zero-excess in count data; (6) generalized nonlinear models; (7) generalized estimating equations for cluster correlated data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, utils, graphics, numDeriv, Rfast, splines,
Formula, MASS, statmod, SuppDists</td>
</tr>
<tr>
<td>Suggests:</td>
<td>aplore3, ISLR, pscl, GLMsData</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>false</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-12 13:07:29 UTC; 57312</td>
</tr>
<tr>
<td>Author:</td>
<td>Luis Hernando Vanegas [aut, cre],
  Luz Marina Rondón [aut],
  Gilberto A. Paula [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luis Hernando Vanegas &lt;lhvanegasp@unal.edu.co&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://mlgs.netlify.app/">https://mlgs.netlify.app/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/lhvanegasp/glmtoolbox/issues">https://github.com/lhvanegasp/glmtoolbox/issues</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-12 13:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adjR2'>Adjusted R-squared</h2><span id='topic+adjR2'></span>

<h3>Description</h3>

<p>Computes the adjusted R-squared
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjR2(..., digits, verbose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjR2_+3A_...">...</code></td>
<td>
<p>one of several model fit objects.</p>
</td></tr>
<tr><td><code id="adjR2_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used.</p>
</td></tr>
<tr><td><code id="adjR2_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the values of the adjusted R-squared for all model fit objects.
</p>

<hr>
<h2 id='adjR2.glm'>Adjusted R-squared in Generalized Linear Models</h2><span id='topic+adjR2.glm'></span>

<h3>Description</h3>

<p>Computes the adjusted deviance-based R-squared in generalized linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
adjR2(..., digits = max(3, getOption("digits") - 2), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjR2.glm_+3A_...">...</code></td>
<td>
<p>one or several objects of the class <em>glm</em>, which are obtained from the fit of generalized linear models.</p>
</td></tr>
<tr><td><code id="adjR2.glm_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
<tr><td><code id="adjR2.glm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The deviance-based R-squared is computed as <code class="reqn">R^2=1 - Deviance/Null.Deviance</code>. Then,
the adjusted deviance-based R-squared is computed as
<code class="reqn">1 - \frac{n-1}{n-p}(1-R^2)</code>, where <code class="reqn">p</code> is the
number of parameters in the linear predictor and <code class="reqn">n</code> is the sample size.
</p>


<h3>Value</h3>

<p>a matrix with the following columns
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Deviance</code> </td><td style="text-align: left;"> value of the residual deviance,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R-squared</code> </td><td style="text-align: left;"> value of the deviance-based R-squared,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>df</code>       </td><td style="text-align: left;"> number of parameters in the linear predictor,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>adj.R-squared</code> </td><td style="text-align: left;"> value of the adjusted deviance-based R-squared,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Fuel efficiency of cars
Auto &lt;- ISLR::Auto
fit1 &lt;- glm(mpg ~ horsepower*weight, family=Gamma(inverse), data=Auto)
fit2 &lt;- update(fit1, formula=mpg ~ horsepower*weight*cylinders)
fit3 &lt;- update(fit1, family=Gamma(log))
fit4 &lt;- update(fit2, family=Gamma(log))
fit5 &lt;- update(fit1, family=inverse.gaussian(log))
fit6 &lt;- update(fit2, family=inverse.gaussian(log))

AIC(fit1,fit2,fit3,fit4,fit5,fit6)
BIC(fit1,fit2,fit3,fit4,fit5,fit6)
adjR2(fit1,fit2,fit3,fit4,fit5,fit6)

</code></pre>

<hr>
<h2 id='adjR2.gnm'>Adjusted R-squared in Generalized Nonlinear Models</h2><span id='topic+adjR2.gnm'></span>

<h3>Description</h3>

<p>Computes the adjusted deviance-based R-squared in generalized nonlinear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnm'
adjR2(..., digits = max(3, getOption("digits") - 2), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjR2.gnm_+3A_...">...</code></td>
<td>
<p>one or several objects of the class <em>gnm</em>, which are obtained from the fit of generalized nonlinear models.</p>
</td></tr>
<tr><td><code id="adjR2.gnm_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
<tr><td><code id="adjR2.gnm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The deviance-based R-squared is computed as <code class="reqn">R^2=1 - Deviance/Null.Deviance</code>. Then,
the adjusted deviance-based R-squared is computed as
<code class="reqn">1 - \frac{n-1}{n-p}(1-R^2)</code>, where <code class="reqn">p</code> is the
number of parameters in the &quot;linear&quot; predictor and <code class="reqn">n</code> is the sample size.
</p>


<h3>Value</h3>

<p>a matrix with the following columns
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Deviance</code> </td><td style="text-align: left;"> value of the residual deviance,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R-squared</code> </td><td style="text-align: left;"> value of the deviance-based R-squared,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>df</code>       </td><td style="text-align: left;"> number of parameters in the "linear" predictor,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>adj.R-squared</code> </td><td style="text-align: left;"> value of the adjusted deviance-based R-squared,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)
fit2 &lt;- update(fit1, family=Gamma(inverse))
adjR2(fit1,fit2)

###### Example 2: Developmental rate of Drosophila melanogaster
data(Drosophila)
fit1 &lt;- gnm(Duration ~ b0 + b1*Temp + b2/(Temp-a), family=Gamma(log),
            start=c(b0=3,b1=-0.25,b2=-210,a=55), weights=Size, data=Drosophila)
fit2 &lt;- update(fit1, family=inverse.gaussian(log))
adjR2(fit1,fit2)

###### Example 3: Radioimmunological Assay of Cortisol
data(Cortisol)
fit1 &lt;- gnm(Y ~ b0 + (b1-b0)/(1 + exp(b2+ b3*lDose))^b4, family=Gamma(identity),
            start=c(b0=130,b1=2800,b2=3,b3=3,b4=0.5), data=Cortisol)
fit2 &lt;- update(fit1, family=gaussian(identity))
adjR2(fit1,fit2)

###### Example 4: Age and Eye Lens Weight of Rabbits in Australia
data(rabbits)
fit1 &lt;- gnm(wlens ~ b1 - b2/(age + b3), family=Gamma(log),
            start=c(b1=5.5,b2=130,b3=35), data=rabbits)
fit2 &lt;- update(fit1, family=gaussian(log))
adjR2(fit1,fit2)

</code></pre>

<hr>
<h2 id='adjR2.lm'>Adjusted R-squared in Normal Linear Models</h2><span id='topic+adjR2.lm'></span>

<h3>Description</h3>

<p>Extracts the adjusted R-squared in normal linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
adjR2(..., digits = max(3, getOption("digits") - 2), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjR2.lm_+3A_...">...</code></td>
<td>
<p>one or several objects of the class <em>lm</em>, which are obtained from the fit of normal linear models.</p>
</td></tr>
<tr><td><code id="adjR2.lm_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
<tr><td><code id="adjR2.lm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The R-squared is computed as <code class="reqn">R^2=1 - RSS/Null.RSS</code>. Then,
the adjusted R-squared is computed as
<code class="reqn">1 - \frac{n-1}{n-p}(1-R^2)</code>, where <code class="reqn">p</code> is the
number of parameters in the linear predictor and <code class="reqn">n</code> is the sample size.
</p>


<h3>Value</h3>

<p>a matrix with the following columns
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>RSS</code> </td><td style="text-align: left;"> value of the residual sum of squares,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R-squared</code> </td><td style="text-align: left;"> value of the R-squared,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>df</code>       </td><td style="text-align: left;"> number of parameters in the linear predictor,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>adj.R-squared</code> </td><td style="text-align: left;"> value of the adjusted R-squared,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Fuel efficiency of cars
fit1 &lt;- lm(mpg ~ log(hp) + log(wt) + qsec, data=mtcars)
fit2 &lt;- lm(mpg ~ log(hp) + log(wt) + qsec + log(hp)*log(wt), data=mtcars)
fit3 &lt;- lm(mpg ~ log(hp)*log(wt)*qsec, data=mtcars)

AIC(fit1,fit2,fit3)
BIC(fit1,fit2,fit3)
adjR2(fit1,fit2,fit3)

</code></pre>

<hr>
<h2 id='advertising'>Advertising</h2><span id='topic+advertising'></span>

<h3>Description</h3>

<p>The advertising data set consists of sales of that product
in 200 different markets. It also includes advertising budgets for the
product in each of those markets for three different media: TV, radio,
and newspapers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(advertising)
</code></pre>


<h3>Format</h3>

<p>A data frame with 200 rows and 4 variables:
</p>

<dl>
<dt>TV</dt><dd><p>a numeric vector indicating the advertising budget on TV.</p>
</dd>
<dt>radio</dt><dd><p>a numeric vector indicating the advertising budget on radio.</p>
</dd>
<dt>newspaper</dt><dd><p>a numeric vector indicating the advertising budget on newspaper.</p>
</dd>
<dt>sales</dt><dd><p>a numeric vector indicating the sales of the interest product.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.statlearning.com/s/Advertising.csv">https://www.statlearning.com/s/Advertising.csv</a>
</p>


<h3>References</h3>

<p>James G., Witten D., Hastie T., Tibshirani R. (2013, page 15) <em>An Introduction to Statistical Learning with Applications in R</em>, Springer, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(advertising)
breaks &lt;- with(advertising,quantile(radio,probs=c(0:3)/3))
labels &lt;- c("low","mid","high")
advertising2 &lt;- within(advertising,radioC &lt;- cut(radio,breaks,labels,include.lowest=TRUE))
dev.new()
with(advertising2,plot(TV,sales,pch=16,col=as.numeric(radioC)))
legend("topleft",legend=c("low","mid","high"),fill=c(1:3),title="Radio",bty="n")
</code></pre>

<hr>
<h2 id='AGPC'>AGPC for Generalized Estimating Equations</h2><span id='topic+AGPC'></span>

<h3>Description</h3>

<p>Computes the Akaike-type penalized Gaussian pseudo-likelihood criterion (AGPC) for one or more objects of the class glmgee.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AGPC(..., k = 2, verbose = TRUE, digits = max(3, getOption("digits") - 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AGPC_+3A_...">...</code></td>
<td>
<p>one or several objects of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="AGPC_+3A_k">k</code></td>
<td>
<p>an (optional) non-negative value giving the magnitude of the penalty. As default, <code>k</code> is set to 2.</p>
</td></tr>
<tr><td><code id="AGPC_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="AGPC_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer indicating the number of digits to print. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>k</code> is set to 0 then the AGPC reduces to the Gaussian pseudo-likelihood criterion (GPC), proposed by Carey and Wang (2011), which corresponds to the logarithm of the multivariate normal density function.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with the values of the gaussian pseudo-likelihood, the number of parameters in the linear predictor plus the number of parameters in the correlation matrix, and the value of AGPC for each <em>glmgee</em> object in the input.
</p>


<h3>References</h3>

<p>Carey V.J., Wang Y.-G. (2011) Working covariance model selection for
generalized estimating equations. <em>Statistics in Medicine</em> 30:3117-3124.
</p>
<p>Zhu X., Zhu Z. (2013) Comparison of Criteria to Select Working Correlation
Matrix in Generalized Estimating Equations. <em>Chinese Journal of Applied Probability
and Statistics</em> 29:515-530.
</p>
<p>Fu L., Hao Y., Wang Y.-G. (2018) Working correlation structure
selection in generalized estimating equations. <em>Computational Statistics</em> 33:983-996.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+QIC">QIC</a>, <a href="#topic+CIC">CIC</a>, <a href="#topic+RJC">RJC</a>, <a href="#topic+GHYC">GHYC</a>, <a href="#topic+SGPC">SGPC</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
AGPC(fit1, fit2, fit3, fit4)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit1 &lt;- glmgee(mod2, id=subj, family=binomial(logit), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
AGPC(fit1, fit2, fit3, fit4)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit1 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Exchangeable")
AGPC(fit1, fit2, fit3)

</code></pre>

<hr>
<h2 id='amenorrhea'>amenorrhea</h2><span id='topic+amenorrhea'></span>

<h3>Description</h3>

<p>A total of 1151 women completed menstrual diaries. The
diary data were used to generate a binary sequence for each woman,
indicating whether or not she had experienced amenorrhea (the absence
of menstrual bleeding for a specified number of days) on the day of
randomization and three additional 90-day intervals. The goal of
this trial was to compare the two treatments (100 mg or 150 mg of
depot-medroxyprogesterone acetate (DMPA)) in terms of how the rates
of amenorrhea change over time with continued use of the contraceptive
method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(amenorrhea)
</code></pre>


<h3>Format</h3>

<p>A data frame with 4604 rows and 4 variables:
</p>

<dl>
<dt>ID</dt><dd><p>a numeric vector indicating the woman's ID.</p>
</dd>
<dt>Dose</dt><dd><p>a factor with two levels: &quot;100mg&quot; for treatment with 100 mg injection; and &quot;150mg&quot; for treatment with 150 mg injection.</p>
</dd>
<dt>Time</dt><dd><p>a numeric vector indicating the number of 90-day intervals since the trial beagn.</p>
</dd>
<dt>amenorrhea</dt><dd><p>a numeric vector indicating the amenorrhea status (1 for amenorrhea; 0 otherwise).</p>
</dd>
</dl>



<h3>References</h3>

<p>Fitzmaurice G.M., Laird N.M., Ware J.H. (2011, page 397). <em>Applied Longitudinal Analysis. 2nd ed.</em> John Wiley &amp; Sons.
</p>
<p>Machin D., Farley T.M., Busca B., Campbell M.J., d'Arcangues C. (1988) Assessing
changes in vaginal bleeding patterns in contracepting women. <em>Contraception</em>, 38, 165-79.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(amenorrhea)
dev.new()
amenorrhea2 &lt;- aggregate(amenorrhea ~ Time + Dose,mean,data=amenorrhea,na.rm=TRUE)
barplot(100*amenorrhea ~ Dose+Time,data=amenorrhea2,beside=TRUE,col=c("blue","yellow"),ylab="%")
legend("topleft",legend=c("100 mg","150 mg"),fill=c("blue","yellow"),title="Dose",bty="n")
</code></pre>

<hr>
<h2 id='anova.glmgee'>Comparison of nested Generalized Estimating Equations</h2><span id='topic+anova.glmgee'></span>

<h3>Description</h3>

<p>Allows to compare nested generalized estimating equations using the Wald and generalized score tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmgee'
anova(
  object,
  ...,
  test = c("wald", "score"),
  verbose = TRUE,
  varest = c("robust", "df-adjusted", "model", "bias-corrected")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.glmgee_+3A_object">object</code></td>
<td>
<p>an object of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="anova.glmgee_+3A_...">...</code></td>
<td>
<p>another objects of the class glmgee which are obtained from the fit of generalized estimating equations.</p>
</td></tr>
<tr><td><code id="anova.glmgee_+3A_test">test</code></td>
<td>
<p>an (optional) character string indicating the required test. The available options are: Wald (&quot;wald&quot;) and generalized score (&quot;score&quot;) tests. As default, <code>test</code> is set to &quot;wald&quot;.</p>
</td></tr>
<tr><td><code id="anova.glmgee_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="anova.glmgee_+3A_varest">varest</code></td>
<td>
<p>an (optional) character string indicating the type of estimator which should be used to the variance-covariance matrix of the interest parameters in the Wald test. The available options are: robust sandwich-type estimator (&quot;robust&quot;), degrees-of-freedom-adjusted estimator (&quot;df-adjusted&quot;), bias-corrected estimator (&quot;bias-corrected&quot;), and the model-based or naive estimator (&quot;model&quot;). As default, <code>varest</code> is set to &quot;robust&quot;. See <a href="#topic+vcov.glmgee">vcov.glmgee</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with three columns which contains the following:
</p>

<dl>
<dt><code>Chi</code></dt><dd><p> The value of the statistic of the test.</p>
</dd>
<dt><code>df</code></dt><dd><p> The number of degrees of freedom.</p>
</dd>
<dt><code>Pr(&gt;Chi)</code></dt><dd><p> The <em>p</em>-value of the test computed using the Chi-square distribution.</p>
</dd>
</dl>



<h3>References</h3>

<p>Rotnitzky A., Jewell P. (1990) Hypothesis Testing of Regression Parameters
in Semiparametric Generalized Linear Models for Cluster Correlated Data. <em>Biometrika</em> 77:485-497.
</p>
<p>Boos D.D. (1992) On Generalized Score Tests. <em>The American Statistician</em> 46:327-333.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>
<p>Boos D. (1992) On Generalized Score Tests. <em>American Statistician</em> 46:327–33.
</p>
<p>Rotnitzky A., Jewell N.P. (1990). Hypothesis Testing of Regression Parameters in Semiparametric Generalized Linear Models for Cluster Correlated Data. <em>Biometrika</em> 77:485-497.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod &lt;- size ~ poly(days,4)
fit1 &lt;- glmgee(mod, id=tree, family=Gamma(log), data=spruces, corstr="AR-M-dependent")
fit2 &lt;- update(fit1, . ~ . + treat)
fit3 &lt;- update(fit2, . ~ . + poly(days,4):treat)
anova(fit1,fit2,fit3,test="wald")
anova(fit3,test="wald")

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ group
fit1 &lt;- glmgee(mod2, id=subj, family=binomial(logit), corstr="AR-M-dependent", data=depression)
fit2 &lt;- update(fit1, . ~ . + visit)
fit3 &lt;- update(fit2, . ~ . + group:visit)
anova(fit1,fit2,fit3,test="score")
anova(fit3,test="score")

</code></pre>

<hr>
<h2 id='anova.gnm'>Comparison of nested models in Generalized Nonlinear Models.</h2><span id='topic+anova.gnm'></span>

<h3>Description</h3>

<p>Allows to use the likelihood-ratio test to compare nested models in generalized nonlinear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnm'
anova(object, ..., verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.gnm_+3A_object">object</code></td>
<td>
<p>an object of the class <em>gnm</em>.</p>
</td></tr>
<tr><td><code id="anova.gnm_+3A_...">...</code></td>
<td>
<p>another objects of the class <em>gnm</em>.</p>
</td></tr>
<tr><td><code id="anova.gnm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code>
is set to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the following three columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Chi</code> </td><td style="text-align: left;"> The value of the statistic of the test,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Df</code></td><td style="text-align: left;"> The number of degrees of freedom,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Pr(&gt;Chi)</code> </td><td style="text-align: left;"> The <em>p</em>-value of the <code>test</code>-type test computed using the Chi-square distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>###### Example: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)

fit2 &lt;- update(fit1,Yield ~ I(b0 + b2/(Phosphorus + a2) + b3/(Potassium + a3)),
               start=c(b0=0.1,b2=1,b3=1,a2=15,a3=30))

anova(fit2,fit1)

</code></pre>

<hr>
<h2 id='anova.overglm'>Comparison of nested models for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</h2><span id='topic+anova.overglm'></span>

<h3>Description</h3>

<p>Allows to compare nested models for regression models based on the negative binomial, beta-binomial, and random-clumped binomial
distributions, which are alternatives to the Poisson and binomial regression models under the presence of overdispersion.
The comparisons are performed by using the Wald, score, gradient or likelihood ratio tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'overglm'
anova(object, ..., test = c("wald", "lr", "score", "gradient"), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.overglm_+3A_object">object</code></td>
<td>
<p>an object of the class <em>overglm</em>.</p>
</td></tr>
<tr><td><code id="anova.overglm_+3A_...">...</code></td>
<td>
<p>another objects of the class <em>overglm</em>.</p>
</td></tr>
<tr><td><code id="anova.overglm_+3A_test">test</code></td>
<td>
<p>an (optional) character string which allows to specify the required test. The available options are: Wald (&quot;wald&quot;),
Rao's score (&quot;score&quot;), likelihood ratio (&quot;lr&quot;) and Terrell's gradient (&quot;gradient&quot;) tests. As default, <code>test</code> is
set to &quot;wald&quot;.</p>
</td></tr>
<tr><td><code id="anova.overglm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code>
is set to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the following three columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Chi</code> </td><td style="text-align: left;"> The value of the statistic of the test,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Df</code></td><td style="text-align: left;"> The number of degrees of freedom,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Pr(&gt;Chi)</code> </td><td style="text-align: left;"> The <em>p</em>-value of the <code>test</code>-type test computed using the Chi-square distribution.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Buse A. (1982) The Likelihood Ratio, Wald, and Lagrange Multiplier Tests: An Expository Note.
<em>The American Statistician</em> 36, 153-157.
</p>
<p>Terrell G.R. (2002) The gradient statistic. <em>Computing Science and Statistics</em> 34, 206–215.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- overglm(infections ~ frequency + location + age + gender, family="nb1(log)", data=swimmers)
anova(fit1, test="wald")
anova(fit1, test="score")
anova(fit1, test="lr")
anova(fit1, test="gradient")

## Example 2: Agents to stimulate cellular differentiation
data(cellular)
fit2 &lt;- overglm(cbind(cells,200-cells) ~ tnf*ifn, family="bb(logit)", data=cellular)
anova(fit2, test="wald")
anova(fit2, test="score")
anova(fit2, test="lr")
anova(fit2, test="gradient")

</code></pre>

<hr>
<h2 id='anova.zeroinflation'>Comparison of nested models for Regression Models to deal with Zero-Excess in Count Data</h2><span id='topic+anova.zeroinflation'></span>

<h3>Description</h3>

<p>Allows to compare nested models for regression models used to deal with zero-excess in count data.
The comparisons are performed by using the Wald, score, gradient or likelihood ratio tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'zeroinflation'
anova(
  object,
  ...,
  test = c("wald", "lr", "score", "gradient"),
  verbose = TRUE,
  submodel = c("counts", "zeros")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.zeroinflation_+3A_object">object</code></td>
<td>
<p>an object of the class <em>zeroinflation</em>.</p>
</td></tr>
<tr><td><code id="anova.zeroinflation_+3A_...">...</code></td>
<td>
<p>another objects of the class <em>zeroinflation</em>.</p>
</td></tr>
<tr><td><code id="anova.zeroinflation_+3A_test">test</code></td>
<td>
<p>an (optional) character string which allows to specify the required test. The available options are: Wald (&quot;wald&quot;),
Rao's score (&quot;score&quot;), likelihood ratio (&quot;lr&quot;) and Terrell's gradient (&quot;gradient&quot;) tests. As default, <code>test</code> is
set to &quot;wald&quot;.</p>
</td></tr>
<tr><td><code id="anova.zeroinflation_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code>
is set to TRUE.</p>
</td></tr>
<tr><td><code id="anova.zeroinflation_+3A_submodel">submodel</code></td>
<td>
<p>an (optional) character string which allows to specify the model: &quot;counts&quot; or &quot;zeros&quot;. By default,
<code>submodel</code> is set to &quot;counts&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the following three columns:
</p>

<dl>
<dt><code>Chi</code></dt><dd><p> The value of the statistic of the test,</p>
</dd>
<dt><code>Df</code></dt><dd><p> The number of degrees of freedom,</p>
</dd>
<dt><code>Pr(&gt;Chi)</code></dt><dd><p> The <em>p</em>-value of the test <em>test</em> computed using the Chi-square distribution.</p>
</dd>
</dl>



<h3>References</h3>

<p>Buse A. (1982) The Likelihood Ratio, Wald, and Lagrange Multiplier Tests: An Expository Note.
<em>The American Statistician</em> 36, 153-157.
</p>
<p>Terrell G.R. (2002) The gradient statistic. <em>Computing Science and Statistics</em> 34, 206–215.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>####### Example 1: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit1 &lt;- zeroinf(art ~ fem + kid5 + ment | ment, family="nb1(log)", data = bioChemists)
anova(fit1,test="wald")
anova(fit1,test="lr")
anova(fit1,test="score")
anova(fit1,test="gradient")

fit2 &lt;- zeroalt(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)
anova(fit2,submodel="zeros",test="wald")
anova(fit2,submodel="zeros",test="lr")
anova(fit2,submodel="zeros",test="score")
anova(fit2,submodel="zeros",test="gradient")

</code></pre>

<hr>
<h2 id='anova2'>Comparison of nested Generalized Linear Models</h2><span id='topic+anova2'></span>

<h3>Description</h3>

<p>Allows to compare nested generalized linear models using Wald, score, gradient, and likelihood ratio tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova2(
  object,
  ...,
  test = c("wald", "lr", "score", "gradient"),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova2_+3A_object">object</code></td>
<td>
<p>an object of the class glm which is obtained from the fit of a generalized linear model.</p>
</td></tr>
<tr><td><code id="anova2_+3A_...">...</code></td>
<td>
<p>another objects of the class glm which are obtained from the fit of generalized linear models.</p>
</td></tr>
<tr><td><code id="anova2_+3A_test">test</code></td>
<td>
<p>an (optional) character string indicating the required type of test. The available options are: Wald (&quot;wald&quot;), Rao's score (&quot;score&quot;), Terrell's gradient (&quot;gradient&quot;), and likelihood ratio (&quot;lr&quot;) tests. As default, <code>test</code> is set to &quot;wald&quot;.</p>
</td></tr>
<tr><td><code id="anova2_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Wald, Rao's score and Terrell's gradient tests are performed using the expected Fisher information matrix.
</p>


<h3>Value</h3>

<p>A matrix with three columns which contains the following:
</p>

<dl>
<dt><code>Chi</code></dt><dd><p> The value of the statistic of the test.</p>
</dd>
<dt><code>Df</code></dt><dd><p> The number of degrees of freedom.</p>
</dd>
<dt><code>Pr(&gt;Chi)</code></dt><dd><p> The <em>p</em>-value of the test computed using the Chi-square distribution.</p>
</dd>
</dl>



<h3>References</h3>

<p>Buse A. (1982) The Likelihood Ratio, Wald, and Lagrange Multiplier Tests: An Expository Note. <em>The American Statistician</em> 36, 153-157.
</p>
<p>Terrell G.R. (2002) The gradient statistic. <em>Computing Science and Statistics</em> 34, 206 – 215.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1
Auto &lt;- ISLR::Auto
fit1 &lt;- glm(mpg ~ weight, family=inverse.gaussian("log"), data=Auto)
fit2 &lt;- update(fit1, . ~ . + horsepower)
fit3 &lt;- update(fit2, . ~ . + horsepower:weight)
anova2(fit1, fit2, fit3, test="lr")
anova2(fit1, fit2, fit3, test="score")
anova2(fit1, fit2, fit3, test="wald")
anova2(fit1, fit2, fit3, test="gradient")

## Example 2
burn1000 &lt;- aplore3::burn1000
mod &lt;- death ~ age + tbsa + inh_inj
fit1 &lt;- glm(mod, family=binomial("logit"), data=burn1000)
fit2 &lt;- update(fit1, . ~ . + inh_inj + age*inh_inj + tbsa*inh_inj)
anova2(fit1, fit2, test="lr")
anova2(fit1, fit2, test="score")
anova2(fit1, fit2, test="wald")
anova2(fit1, fit2, test="gradient")

## Example 3
data(aucuba)
fit &lt;- glm(lesions ~ 1 + time, family=poisson("log"), data=aucuba)
anova2(fit, test="lr")
anova2(fit, test="score")
anova2(fit, test="wald")
anova2(fit, test="gradient")
</code></pre>

<hr>
<h2 id='aucuba'>Lesions of Aucuba mosaic virus</h2><span id='topic+aucuba'></span>

<h3>Description</h3>

<p>The investigators counted the number of lesions of
<em>Aucuba mosaic</em> virus developing after exposure to X rays for
various times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aucuba)
</code></pre>


<h3>Format</h3>

<p>A data frame with 7 rows and 2 variables:
</p>

<dl>
<dt>time</dt><dd><p> a numeric vector giving the minutes of exposure.</p>
</dd>
<dt>lesions</dt><dd><p> a numeric vector giving the counts of lesions, in hundreds.</p>
</dd>
</dl>



<h3>References</h3>

<p>Snedecor G.W., Cochran W.G. (1989) <em>Statistical Methods, Eight Edition</em>, Iowa State University Press, Ames.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aucuba)
dev.new()
barplot(lesions ~ time, col="red", data=aucuba)

</code></pre>

<hr>
<h2 id='bestSubset'>Best Subset Selection</h2><span id='topic+bestSubset'></span>

<h3>Description</h3>

<p>Best subset selection by exhaustive search in generalized linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bestSubset(
  object,
  nvmax = 8,
  nbest = 1,
  force.in = NULL,
  force.out = NULL,
  verbose = TRUE,
  digits = max(3, getOption("digits") - 2)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bestSubset_+3A_object">object</code></td>
<td>
<p>one object of the class <em>glm</em>, which is assumed to be the full model.</p>
</td></tr>
<tr><td><code id="bestSubset_+3A_nvmax">nvmax</code></td>
<td>
<p>an (optional) positive integer value indicating the maximum size of subsets to examine.</p>
</td></tr>
<tr><td><code id="bestSubset_+3A_nbest">nbest</code></td>
<td>
<p>an (optional) positive integer value indicating the number of subsets of each size to record.</p>
</td></tr>
<tr><td><code id="bestSubset_+3A_force.in">force.in</code></td>
<td>
<p>an (optional) positive integers vector indicating the index of columns of model matrix that should be in all models.</p>
</td></tr>
<tr><td><code id="bestSubset_+3A_force.out">force.out</code></td>
<td>
<p>an (optional) positive integers vector indicating the index of columns of model matrix that should be in no models.</p>
</td></tr>
<tr><td><code id="bestSubset_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="bestSubset_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to apply the &quot;best subset&quot; selection, an exhaustive search is conducted, separately for every size from <code class="reqn">i</code> to
<code>nvmax</code>, to identify the model with the smallest deviance value. Therefore, if, for a fixed model size, the interest model selection criteria reduce to
monotone functions of deviance, thus differing only in the way the sizes of the models are compared, then the results of the &quot;best subset&quot;
selection do not depend upon the choice of the trade-off between goodness-of-fit and complexity on which they are based.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Fuel consumption of automobiles
Auto &lt;- ISLR::Auto
Auto2 &lt;- within(Auto, origin &lt;- factor(origin))
mod &lt;- mpg ~ cylinders + displacement + acceleration + origin + horsepower*weight
fit1 &lt;- glm(mod, family=inverse.gaussian(log), data=Auto2)
out1 &lt;- bestSubset(fit1)
out1

###### Example 2: Patients with burn injuries
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death &lt;- factor(death, levels=c("Dead","Alive")))
mod &lt;- death ~ gender + race + flame + age*tbsa*inh_inj
fit2 &lt;- glm(mod, family=binomial(logit), data=burn1000)
out2 &lt;- bestSubset(fit2)
out2

###### Example 3: Advertising
data(advertising)
fit3 &lt;- glm(sales ~ log(TV)*radio*newspaper, family=gaussian(log), data=advertising)
out3 &lt;- bestSubset(fit3)
out3

</code></pre>

<hr>
<h2 id='bladder'>Bladder cancer in mice</h2><span id='topic+bladder'></span>

<h3>Description</h3>

<p>Female mice were continuously fed dietary concentrations
of 2-Acetylaminofluorene (2-AAF), a carcinogenic and mutagenic
derivative of fluorene. Serially sacrificed, dead or moribund mice
were examined for tumors and deaths dates recorded. These data consist
of the incidences of bladder neoplasms in mice observed during 33
months.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bladder)
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 3 variables:
</p>

<dl>
<dt>dose</dt><dd><p>a numeric vector giving the dose, in parts per <code class="reqn">10^4</code>, of 2-AAF.</p>
</dd>
<dt>exposed</dt><dd><p>a numeric vector giving the number of mice exposed to each dose of 2-AAF.</p>
</dd>
<dt>cancer</dt><dd><p>a numeric vector giving the number of mice with bladder cancer for each dose of 2-AAF.</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhang H., Zelterman D. (1999) Binary Regression for Risks in Excess of
Subject-Specific Thresholds. <em>Biometrics</em> 55:1247-1251.
</p>


<h3>See Also</h3>

<p><a href="#topic+liver">liver</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bladder)
dev.new()
barplot(100*cancer/exposed ~ dose, beside=TRUE, data=bladder, col="red",
        xlab="Dose of 2-AAF", ylab="% of mice with bladder cancer")
</code></pre>

<hr>
<h2 id='BoxTidwell'>Box-Tidwell transformations</h2><span id='topic+BoxTidwell'></span>

<h3>Description</h3>

<p>Computes the Box-Tidwell power transformations of the predictors in a regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BoxTidwell(
  object,
  transf,
  epsilon = 1e-04,
  maxiter = 30,
  trace = FALSE,
  digits = max(3, getOption("digits") - 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BoxTidwell_+3A_object">object</code></td>
<td>
<p>a model fit object.</p>
</td></tr>
<tr><td><code id="BoxTidwell_+3A_transf">transf</code></td>
<td>
<p>an one-sided formula giving the predictors that are candidates for transformation.</p>
</td></tr>
<tr><td><code id="BoxTidwell_+3A_epsilon">epsilon</code></td>
<td>
<p>an (optional) numerical value. If the maximum relative change in coefficients is less than
<em>epsilon</em>, then convergence is declared. As default, <em>epsilon</em> is set to 0.0001.</p>
</td></tr>
<tr><td><code id="BoxTidwell_+3A_maxiter">maxiter</code></td>
<td>
<p>an (optional) positive integer value indicating the maximum number of iterations. By default,
<em>maxiter</em> is set to 30.</p>
</td></tr>
<tr><td><code id="BoxTidwell_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical indicating if should the record of iterations be printed. By default,
<em>trace</em> is set to FALSE.</p>
</td></tr>
<tr><td><code id="BoxTidwell_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used.</p>
</td></tr>
<tr><td><code id="BoxTidwell_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two matrices with the values of marginal and omnibus tests.
</p>

<hr>
<h2 id='BoxTidwell.glm'>Box-Tidwell transformations in Generalized Linear Models</h2><span id='topic+BoxTidwell.glm'></span>

<h3>Description</h3>

<p>Computes the Box-Tidwell power transformations of the predictors in a generalized linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
BoxTidwell(
  object,
  transf,
  epsilon = 1e-04,
  maxiter = 30,
  trace = FALSE,
  digits = max(3, getOption("digits") - 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BoxTidwell.glm_+3A_object">object</code></td>
<td>
<p>an object of the class <em>glm</em>.</p>
</td></tr>
<tr><td><code id="BoxTidwell.glm_+3A_transf">transf</code></td>
<td>
<p>an one-sided formula giving the quantitative predictors that are candidates for transformation.</p>
</td></tr>
<tr><td><code id="BoxTidwell.glm_+3A_epsilon">epsilon</code></td>
<td>
<p>an (optional) numerical value. If the maximum relative change in coefficients is less than
<em>epsilon</em>, then convergence is declared. As default, <em>epsilon</em> is set to 0.0001.</p>
</td></tr>
<tr><td><code id="BoxTidwell.glm_+3A_maxiter">maxiter</code></td>
<td>
<p>an (optional) positive integer value indicating the maximum number of iterations. By default,
<em>maxiter</em> is set to 30.</p>
</td></tr>
<tr><td><code id="BoxTidwell.glm_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical indicating if should the record of iterations be printed. By default,
<em>trace</em> is set to FALSE.</p>
</td></tr>
<tr><td><code id="BoxTidwell.glm_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used.</p>
</td></tr>
<tr><td><code id="BoxTidwell.glm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>marginal</code> </td><td style="text-align: left;"> a matrix with estimates, standard errors, and 95
                      and the p-value of the Wald test to assess the hypothesis <code class="reqn">H_0:\tau=1</code> versus <code class="reqn">H_1:\tau\neq 1</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>omnibus</code> </td><td style="text-align: left;"> a matrix with the statistic and the p-value of the Wald test for null hypothesis that all powers
                     are 1,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Box G.E.P., Tidwell P.W. (1962) Transformation of the independent variables. <em>Technometrics</em> 4, 531-550.
</p>
<p>Fox J. (2016) <em>Applied Regression Analysis and Generalized Linear Models</em>, Third Edition. Sage.
</p>


<h3>See Also</h3>

<p><a href="#topic+BoxTidwell.lm">BoxTidwell.lm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Skin cancer in women
data(skincancer)
fit1 &lt;- glm(cases ~ age + city, offset=log(population), family=poisson(log), data=skincancer)
AIC(fit1)
BoxTidwell(fit1, transf= ~ age)
fit1 &lt;- update(fit1,formula=. ~ I(age^(-1/2)) + city)
AIC(fit1)

###### Example 3: Gas mileage
data(Auto, package="ISLR")
fit3 &lt;- glm(mpg ~ horsepower + weight, family=inverse.gaussian(log), data=Auto)
AIC(fit3)
BoxTidwell(fit3, transf= ~ horsepower + weight)
fit3 &lt;- update(fit3,formula=. ~ I(horsepower^(-1/3)) + weight)
AIC(fit3)

###### Example 4: Advertising
data(advertising)
fit4 &lt;- glm(sales ~ TV + radio, family=gaussian(log), data=advertising)
AIC(fit4)
BoxTidwell(fit4, transf= ~ TV)
fit4 &lt;- update(fit4,formula=. ~ I(TV^(1/10)) + radio)
AIC(fit4)

###### Example 5: Leukaemia Patients
data(leuk, package="MASS")
fit5 &lt;- glm(ifelse(time&gt;=52,1,0) ~ ag + wbc, family=binomial, data=leuk)
AIC(fit5)
BoxTidwell(fit5, transf= ~ wbc)
fit5 &lt;- update(fit5,formula=. ~ ag + I(wbc^(-0.18)))
AIC(fit5)

</code></pre>

<hr>
<h2 id='BoxTidwell.lm'>Box-Tidwell transformations in Normal Linear Models</h2><span id='topic+BoxTidwell.lm'></span>

<h3>Description</h3>

<p>Computes the Box-Tidwell power transformations of the predictors in a normal linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
BoxTidwell(
  object,
  transf,
  epsilon = 1e-04,
  maxiter = 30,
  trace = FALSE,
  digits = max(3, getOption("digits") - 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BoxTidwell.lm_+3A_object">object</code></td>
<td>
<p>an object of the class <em>lm</em>.</p>
</td></tr>
<tr><td><code id="BoxTidwell.lm_+3A_transf">transf</code></td>
<td>
<p>an one-sided formula giving the quantitative predictors that are candidates for transformation.</p>
</td></tr>
<tr><td><code id="BoxTidwell.lm_+3A_epsilon">epsilon</code></td>
<td>
<p>an (optional) numerical value. If the maximum relative change in coefficients is less than
<em>epsilon</em>, then convergence is declared. As default, <em>epsilon</em> is set to 0.0001.</p>
</td></tr>
<tr><td><code id="BoxTidwell.lm_+3A_maxiter">maxiter</code></td>
<td>
<p>an (optional) positive integer value indicating the maximum number of iterations. By default,
<em>maxiter</em> is set to 30.</p>
</td></tr>
<tr><td><code id="BoxTidwell.lm_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical indicating if should the record of iterations be printed. By default,
<em>trace</em> is set to FALSE.</p>
</td></tr>
<tr><td><code id="BoxTidwell.lm_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used.</p>
</td></tr>
<tr><td><code id="BoxTidwell.lm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>marginal</code> </td><td style="text-align: left;"> a matrix with estimates, standard errors, and 95
                      and the p-value of the Wald test to assess the hypothesis <code class="reqn">H_0:\tau=1</code> versus <code class="reqn">H_1:\tau\neq 1</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>omnibus</code> </td><td style="text-align: left;"> a matrix with the statistic and the p-value of the Wald test for null hypothesis that all powers
                     are 1,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Box G.E.P., Tidwell P.W. (1962) Transformation of the independent variables. <em>Technometrics</em> 4, 531-550.
</p>
<p>Fox J. (2016) <em>Applied Regression Analysis and Generalized Linear Models</em>, Third Edition. Sage.
</p>


<h3>See Also</h3>

<p><a href="#topic+BoxTidwell.glm">BoxTidwell.glm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Hill races in Scotland
data(races)
fit1 &lt;- lm(rtime ~ distance + cclimb, data=races)
AIC(fit1)
BoxTidwell(fit1, transf= ~ distance + cclimb)
fit1 &lt;- update(fit1,formula=rtime ~ distance + I(cclimb^2))
AIC(fit1)

###### Example 2: Gasoline yield
fit2 &lt;- lm(mpg ~ hp + wt + am, data=mtcars)
AIC(fit2)
BoxTidwell(fit2, transf= ~ hp + wt)
fit2 &lt;- update(fit2,formula=mpg ~ log(hp) + log(wt) + am)
AIC(fit2)

###### Example 3: New York Air Quality Measurements
fit3 &lt;- lm(log(Ozone) ~ Solar.R + Wind + Temp, data=airquality)
AIC(fit3)
BoxTidwell(fit3, transf= ~ Solar.R + Wind + Temp)
fit3 &lt;- update(fit3,formula=log(Ozone) ~ log(Solar.R) + Wind + Temp)
AIC(fit3)

###### Example 4: Heat capacity of hydrobromic acid
data(heatcap,package="GLMsData")
fit4 &lt;- lm(Cp ~ Temp, data=heatcap)
AIC(fit4)
BoxTidwell(fit4, transf= ~ Temp)
fit4 &lt;- update(fit4,formula=Cp ~ I(Temp^5))
AIC(fit4)

###### Example 5: Age and Eye Lens Weight of Rabbits in Australia
data(rabbits)
fit5 &lt;- lm(log(wlens) ~ age, data=rabbits)
AIC(fit5)
BoxTidwell(fit5, transf= ~ age)
fit5 &lt;- update(fit5,formula=log(wlens) ~ I(age^(-1/3)))
AIC(fit5)

</code></pre>

<hr>
<h2 id='brains'>Mammal brain and body weights</h2><span id='topic+brains'></span>

<h3>Description</h3>

<p>These data correspond to the (average) body weight and
the (average) brain weight for sixty-two species of mammals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(brains)
</code></pre>


<h3>Format</h3>

<p>A data frame with 62 rows and 3 variables:
</p>

<dl>
<dt>Specie</dt><dd><p>a character string giving the species name.</p>
</dd>
<dt>BrainWt</dt><dd><p>a numeric vector indicating the average brain weight, in grams.</p>
</dd>
<dt>BodyWt</dt><dd><p>a numeric vector indicating the average body weight, in kilograms.</p>
</dd>
</dl>



<h3>References</h3>

<p>Allison T., Cicchetti D. (1976). Sleep in mammals: Ecology and constitutional correlates. <em>Science</em> 194:732-734.
</p>
<p>Weisberg S. (2005). <em>Applied Linear Regression</em>, 3rd edition. Wiley, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(brains)
xlab &lt;- "log(Body Weight)"
ylab &lt;- "log(Brain Weight)"
dev.new()
with(brains,plot(log(BodyWt),log(BrainWt),pch=20,xlab=xlab,ylab=ylab))
</code></pre>

<hr>
<h2 id='calls'>Calls to a technical support help line</h2><span id='topic+calls'></span>

<h3>Description</h3>

<p>Data on technical support calls after a product release. Using
this information, new products could be allocated technical support
resources.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(calls)
</code></pre>


<h3>Format</h3>

<p>A data frame with 16 rows and 2 variables:
</p>

<dl>
<dt>week</dt><dd><p>a numeric vector indicating number of weeks that have elapsed since the product’s release.</p>
</dd>
<dt>calls</dt><dd><p>a numeric vector indicating the number of technical support calls.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.3/statug/statug_mcmc_examples12.htm">https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.3/statug/statug_mcmc_examples12.htm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(calls)
dev.new()
with(calls,plot(week,calls,xlab="The number of weeks since the release of the product",
     pch=16,col="blue",ylab="Technical support calls"))
</code></pre>

<hr>
<h2 id='cellular'>Agents to stimulate cellular differentiation</h2><span id='topic+cellular'></span>

<h3>Description</h3>

<p>In a biomedical study of the immuno-activating ability of
two agents, TNF (tumor necrosis factor) and IFN (interferon), to induce
cell differentiation, the number of cells that exhibited markers of
differentiation after exposure to TNF and IFN was recorded. At each of
the 16 TNF/INF dose combinations, 200 cells were examined. The main
question is whether the two agents stimulate cell differentiation
synergistically or independently.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cellular)
</code></pre>


<h3>Format</h3>

<p>A data frame with 16 rows and 3 variables:
</p>

<dl>
<dt>cells</dt><dd><p>a numeric vector giving the number of cells that exhibited markers of
differentiation after exposure to the dose of the two agents</p>
</dd>
<dt>tnf</dt><dd><p>a numeric vector giving the dose (U/ml) of TNF</p>
</dd>
<dt>ifn</dt><dd><p>a numeric vector giving the dose (U/ml) of IFN</p>
</dd>
</dl>



<h3>References</h3>

<p>Piegorsch W.W., Weinberg C.R., Margolin B.H. (1988) Exploring
simple independent action in multifactor tables of proportions. <em>Biometrics</em> 44:595-603.
</p>
<p>Vanegas L.H., Rondon L.M. (2020) A data transformation to deal with
constant under/over-dispersion in binomial and poisson regression models. <em>Journal
of Statistical Computation and Simulation</em> 90:1811-1833.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cellular)
dev.new()
barplot(100*cells/200 ~ ifn + tnf, beside=TRUE, data=cellular, col=terrain.colors(4),
        xlab="Dose of TNF", ylab="% of cells with markers of differentiation")
legend("topleft", legend=c("0","4","20","100"), fill=terrain.colors(4),
       title="Dose of IFN", bty="n")
</code></pre>

<hr>
<h2 id='cholecystectomy'>Shoulder Pain after Laparoscopic Cholecystectomy</h2><span id='topic+cholecystectomy'></span>

<h3>Description</h3>

<p>Inflation of the abdomen during laparoscopic
cholecystectomy (removal of the gallbladder) separates the liver from
the diaphragm and strains the attachments that connect both. This
strain is felt as a referred shoulder pain. Suction to remove residual
gas may reduce shoulder pain. There were 22 subjects randomized in the
active group (with abdominal suction) and 19 subjects randomized in
the control group (without abdominal suction). After laparoscopic
surgery, patients were asked to rate their shoulder pain on a visual
analog scale morning and afternoon for three days after the operation
(a total of six different times). The scale was coded into five
ordered categories where a pain score of 1 indicated &quot;low pain&quot; and
a score of 5 reflected &quot;high pain&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cholecystectomy)
</code></pre>


<h3>Format</h3>

<p>A data frame with 246 rows and 7 variables:
</p>

<dl>
<dt>id</dt><dd><p>a numeric vector with the identifier of the patient.</p>
</dd>
<dt>treatment</dt><dd><p>a factor indicating the treatment received by the patient: abdominal suction (&quot;A&quot;) and placebo (&quot;P&quot;).</p>
</dd>
<dt>gender</dt><dd><p>a factor indicating the gender of the patient: female (&quot;F&quot;) and male (&quot;M&quot;).</p>
</dd>
<dt>age</dt><dd><p>a numeric vector indicating the age of the patient, in years.</p>
</dd>
<dt>time</dt><dd><p>a numeric vector indicating the occasion the patient was asked to rate their shoulder pain after the laparoscopic surgery: integers from 1 to 6.</p>
</dd>
<dt>pain</dt><dd><p>a numeric vector indicating the shoulder pain rated by the patient on a scale coded into five ordered categories, where
1 indicated &quot;low pain&quot; and 5 reflected &quot;high pain&quot;.</p>
</dd>
<dt>pain2</dt><dd><p>a numeric vector indicating the shoulder pain rated by the patient and coded as 1 for the two first categories of
pain and 0 for other cases.</p>
</dd>
</dl>



<h3>References</h3>

<p>Jorgensen J.O., Gillies R.B., Hunt D.R., Caplehorn J.R.M., Lumley T. (1995)
A simple and effective way to reduce postoperative pain after laparoscopic cholecystectomy.
<em>Australian and New Zealand Journal of Surgery</em> 65:466–469.
</p>
<p>Lumley T. (1996) Generalized Estimating Equations for Ordinal Data: A Note on Working Correlation Structures.
<em>Biometrics</em> 52:354–361.
</p>
<p>Morel J.G., Nagaraj N.K. (2012) <em>Overdispersion Models in SAS</em>. SAS Institute Inc.,
Cary, North Carolina, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cholecystectomy)
out &lt;- aggregate(pain2 ~ treatment + time, data=cholecystectomy, mean)
dev.new()
barplot(100*pain2 ~ treatment + time, beside=TRUE, data=out, xlab="Time",
        col=c("yellow","blue"), ylab="% of patients with low pain")
legend("topleft", c("Placebo","Abdominal suction"), fill=c("yellow","blue"),
       title="Treatment", cex=0.9, bty="n")

</code></pre>

<hr>
<h2 id='CIC'>Correlation Information Criterion for Generalized Estimating Equations</h2><span id='topic+CIC'></span>

<h3>Description</h3>

<p>Computes the Correlation Information Criterion (CIC) for one or more objects of the class glmgee.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIC(..., verbose = TRUE, digits = max(3, getOption("digits") - 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIC_+3A_...">...</code></td>
<td>
<p>one or several objects of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="CIC_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="CIC_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer indicating the number of digits to print. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the values of the CIC for each <em>glmgee</em> object in the input.
</p>


<h3>References</h3>

<p>Hin L.-Y., Wang Y.-G. (2009) Working-Correlation-Structure Identification in Generalized Estimating Equations. <em>Statistics in Medicine</em>, 28:642-658.
</p>
<p>Hin L.-Y., Carey V.J., Wang Y.-G. (2007) Criteria for Working–Correlation–Structure Selection in GEE:
Assessment via Simulation. <em>The American Statistician</em> 61:360–364.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+QIC">QIC</a>, <a href="#topic+GHYC">GHYC</a>, <a href="#topic+RJC">RJC</a>, <a href="#topic+AGPC">AGPC</a>, <a href="#topic+SGPC">SGPC</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
CIC(fit1, fit2, fit3, fit4)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit1 &lt;- glmgee(mod2, id=subj, family=binomial(logit), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
CIC(fit1, fit2, fit3, fit4)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit1 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Exchangeable")
CIC(fit1, fit2, fit3)

</code></pre>

<hr>
<h2 id='confint.gnm'>Confidence Intervals for Generalized Nonlinear Models</h2><span id='topic+confint.gnm'></span>

<h3>Description</h3>

<p>Computes confidence intervals based on Wald test for a generalized nonlinear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnm'
confint(
  object,
  parm,
  level = 0.95,
  contrast,
  digits = max(3, getOption("digits") - 2),
  dispersion = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.gnm_+3A_object">object</code></td>
<td>
<p>an object of the class <em>gnm</em>.</p>
</td></tr>
<tr><td><code id="confint.gnm_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.gnm_+3A_level">level</code></td>
<td>
<p>an (optional) value indicating the required confidence level. As default, <code>level</code> is set to 0.95.</p>
</td></tr>
<tr><td><code id="confint.gnm_+3A_contrast">contrast</code></td>
<td>
<p>an (optional) matrix indicating the linear combinations of parameters for which confidence intervals are required. The number of rows in this matrix corresponds to the number of linear combinations required.</p>
</td></tr>
<tr><td><code id="confint.gnm_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
<tr><td><code id="confint.gnm_+3A_dispersion">dispersion</code></td>
<td>
<p>an (optional) value indicating the estimate of the dispersion parameter. As default, <code>dispersion</code> is set to <code>summary(object)$dispersion</code>.</p>
</td></tr>
<tr><td><code id="confint.gnm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="confint.gnm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approximate 100(<code>level</code>)% confidence interval for <code class="reqn">\beta</code> based on the Wald test.
</p>


<h3>Value</h3>

<p>A matrix with so many rows as parameters in the &quot;linear&quot; predictor and two columns: &quot;Lower limit&quot; and &quot;Upper limit&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)

confint(fit1, level=0.95)

###### Example 2: Assay of an Insecticide with a Synergist
data(Melanopus)
fit2 &lt;- gnm(Killed/Exposed ~ b0 + b1*log(Insecticide-a1) + b2*Synergist/(a2 + Synergist),
            family=binomial(logit), weights=Exposed, start=c(b0=-3,b1=1.2,a1=1.7,b2=1.7,a2=2),
		   data=Melanopus)

confint(fit2, level=0.95)

###### Example 3: Developmental rate of Drosophila melanogaster
data(Drosophila)
fit3 &lt;- gnm(Duration ~ b0 + b1*Temp + b2/(Temp-a), family=Gamma(log),
            start=c(b0=3,b1=-0.25,b2=-210,a=55), weights=Size, data=Drosophila)

confint(fit3, level=0.95)

###### Example 4: Radioimmunological Assay of Cortisol
data(Cortisol)
fit4 &lt;- gnm(Y ~ b0 + (b1-b0)/(1 + exp(b2+ b3*lDose))^b4, family=Gamma(identity),
            start=c(b0=130,b1=2800,b2=3,b3=3,b4=0.5), data=Cortisol)

### Confidence Interval for 'b1-b0'
confint(fit4, level=0.95, contrast=matrix(c(-1,1,0,0,0),1,5))

### Confidence Intervals for 'b0', 'b1', 'b2', 'b3', 'b4'
confint(fit4, level=0.95, contrast=diag(5))

</code></pre>

<hr>
<h2 id='confint2'>Confidence Intervals for Generalized Linear Models</h2><span id='topic+confint2'></span>

<h3>Description</h3>

<p>Computes confidence intervals based on Wald, likelihood-ratio, Rao's score or Terrell's gradient tests for a generalized linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confint2(
  model,
  level = 0.95,
  test = c("wald", "lr", "score", "gradient"),
  digits = max(3, getOption("digits") - 2),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint2_+3A_model">model</code></td>
<td>
<p>an object of the class <em>glm</em>.</p>
</td></tr>
<tr><td><code id="confint2_+3A_level">level</code></td>
<td>
<p>an (optional) value indicating the required confidence level. As default, <code>level</code> is set to 0.95.</p>
</td></tr>
<tr><td><code id="confint2_+3A_test">test</code></td>
<td>
<p>an (optional) character string indicating the required type of test. The available options are: Wald (&quot;wald&quot;), Rao's score (&quot;score&quot;), Terrell's gradient (&quot;gradient&quot;), and likelihood ratio (&quot;lr&quot;) tests. As default, <code>test</code> is set to &quot;wald&quot;.</p>
</td></tr>
<tr><td><code id="confint2_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
<tr><td><code id="confint2_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approximate 100(<code>level</code>)% confidence interval for <code class="reqn">\beta</code> based on the <code>test</code> test is the set of values of <code class="reqn">\beta_0</code> for which the hypothesis <code class="reqn">H_0</code>: <code class="reqn">\beta=\beta_0</code> versus <code class="reqn">H_1</code>: <code class="reqn">\beta!=\beta_0</code> is not rejected at the approximate significance level of 100(1-<code>level</code>)%. The Wald, Rao's score and Terrell's gradient tests are performed using the expected Fisher information matrix.
</p>


<h3>Value</h3>

<p>A matrix with so many rows as parameters in the linear predictor and two columns: &quot;Lower limit&quot; and &quot;Upper limit&quot;.
</p>


<h3>References</h3>

<p>Buse A. (1982) The Likelihood Ratio, Wald, and Lagrange Multiplier Tests: An Expository Note. <em>The American Statistician</em> 36, 153-157.
</p>
<p>Terrell G.R. (2002) The gradient statistic. <em>Computing Science and Statistics</em> 34, 206 – 215.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Fuel consumption of automobiles
Auto &lt;- ISLR::Auto
fit1 &lt;- glm(mpg ~ weight*horsepower, family=inverse.gaussian("log"), data=Auto)
confint2(fit1, test="lr")
confint2(fit1, test="score")

###### Example 2: Patients with burn injuries
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death &lt;- factor(death, levels=c("Dead","Alive")))
fit2 &lt;- glm(death ~ age*inh_inj + tbsa*inh_inj, family=binomial("logit"), data=burn1000)
confint2(fit2, test="lr")
confint2(fit2, test="gradient")

</code></pre>

<hr>
<h2 id='cooks.distance.glmgee'>Cook's Distance for Generalized Estimating Equations</h2><span id='topic+cooks.distance.glmgee'></span>

<h3>Description</h3>

<p>Produces an approximation, better known as the <em>one-step aproximation</em>,
of the Cook's distance, which is aimed to measure the effect on the estimates of the parameters in the linear predictor
of deleting each cluster/observation in turn. This function also can produce a cluster/observation-index plot of the
Cook's distance for all parameters in the linear predictor or for some subset of them (via the argument <code>coefs</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmgee'
cooks.distance(
  model,
  method = c("Preisser-Qaqish", "full"),
  level = c("clusters", "observations"),
  plot.it = FALSE,
  coefs,
  identify,
  varest = c("robust", "df-adjusted", "model", "bias-corrected"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cooks.distance.glmgee_+3A_model">model</code></td>
<td>
<p>an object of class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="cooks.distance.glmgee_+3A_method">method</code></td>
<td>
<p>an (optional) character string indicating the method of calculation for the <em>one-step approximation</em>. The options are: the <em>one-step approximation</em> described by Preisser and Qaqish (1996) in which the working-correlation matrix is assumed to be known (&quot;Preisser-Qaqish&quot;); and the &quot;authentic&quot; <em>one-step approximation</em> (&quot;full&quot;). As default, <code>method</code> is set to &quot;Preisser-Qaqish&quot;.</p>
</td></tr>
<tr><td><code id="cooks.distance.glmgee_+3A_level">level</code></td>
<td>
<p>an (optional) character string indicating the level for which the Cook's distance is required. The options are: cluster-level (&quot;clusters&quot;) and observation-level (&quot;observations&quot;). As default, <code>level</code> is set to &quot;clusters&quot;.</p>
</td></tr>
<tr><td><code id="cooks.distance.glmgee_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical indicating if the plot of Cook's distance is required or just the data matrix in which that plot is based. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="cooks.distance.glmgee_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of some of the parameters in the linear predictor.</p>
</td></tr>
<tr><td><code id="cooks.distance.glmgee_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of clusters to identify on the plot of Cook's distance. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="cooks.distance.glmgee_+3A_varest">varest</code></td>
<td>
<p>an (optional) character string indicating the type of estimator which should be used to the variance-covariance matrix of the interest parameters. The available options are: robust sandwich-type estimator (&quot;robust&quot;), degrees-of-freedom-adjusted estimator (&quot;df-adjusted&quot;), bias-corrected estimator (&quot;bias-corrected&quot;), and the model-based or naive estimator (&quot;model&quot;). As default, <code>varest</code> is set to &quot;robust&quot;.</p>
</td></tr>
<tr><td><code id="cooks.distance.glmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example,  <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cook's distance consists of the <em>distance</em> between two estimates of the
parameters in the linear predictor using a metric based on the (estimate of the) variance-covariance matrix. For the cluster-level,
the first one set of estimates is computed from a dataset including all clusters/observations, and the second one is computed from a dataset in which the <em>i</em>-th cluster is excluded. To avoid computational burden, the second set of estimates is replaced by its <em>one-step approximation</em>. See the <a href="#topic+dfbeta.glmgee">dfbeta.glmgee</a> documentation.
</p>


<h3>Value</h3>

<p>A matrix as many rows as clusters/observations in the sample and one column with the values of the Cook's distance.
</p>


<h3>References</h3>

<p>Pregibon D. (1981). Logistic regression diagnostics. <em>The Annals of Statistics</em> 9, 705-724.
</p>
<p>Preisser J.S., Qaqish B.F. (1996) Deletion diagnostics for generalised estimating equations.
<em>Biometrika</em> 83:551–562.
</p>
<p>Hammill B.G., Preisser J.S. (2006) A SAS/IML software program for GEE and regression diagnostics.
<em>Computational Statistics &amp; Data Analysis</em> 51:1197-1212.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces, corstr="AR-M-dependent")

### Cook's distance for all parameters in the linear predictor
cooks.distance(fit1, method="full", plot.it=TRUE, col="red", lty=1, lwd=1, cex=0.8,
               col.lab="blue", col.axis="blue", col.main="black", family="mono")

### Cook's distance for the parameter associated to the variable 'treat'
cooks.distance(fit1, coef="treat", method="full", plot.it=TRUE, col="red", lty=1,
               lwd=1, col.lab="blue", col.axis="blue", col.main="black", cex=0.8)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit2 &lt;- glmgee(mod2, id=subj, family=binomial(logit), corstr="AR-M-dependent", data=depression)

### Cook's distance for all parameters in the linear predictor
cooks.distance(fit2, method="full", plot.it=TRUE, col="red", lty=1, lwd=1, cex=0.8,
               col.lab="blue", col.axis="blue", col.main="black", family="mono")

### Cook's distance for the parameter associated to the variable 'group'
cooks.distance(fit2, coef="group", method="full", plot.it=TRUE, col="red", lty=1,
               lwd=1, col.lab="blue", col.axis="blue", col.main="black", cex=0.8)

</code></pre>

<hr>
<h2 id='cooks.distance.gnm'>Cook's Distance for Generalized Nonlinear Models</h2><span id='topic+cooks.distance.gnm'></span>

<h3>Description</h3>

<p>Produces an approximation of the Cook's distance, better known as the <em>one-step approximation</em>,
for measuring the effect of deleting each observation in turn on the estimates of the parameters in a linear
predictor. Additionally, this function can produce an index plot of Cook's distance for all or a subset of the
parameters in the linear predictor (via the argument <code>coefs</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnm'
cooks.distance(model, plot.it = FALSE, dispersion = NULL, coefs, identify, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cooks.distance.gnm_+3A_model">model</code></td>
<td>
<p>an object of class <em>gnm</em>.</p>
</td></tr>
<tr><td><code id="cooks.distance.gnm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical indicating if the plot is required or just the data matrix in which that
plot is based. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="cooks.distance.gnm_+3A_dispersion">dispersion</code></td>
<td>
<p>an (optional) value indicating the estimate of the dispersion parameter. As default, <code>dispersion</code> is set to <code>summary(object)$dispersion</code>.</p>
</td></tr>
<tr><td><code id="cooks.distance.gnm_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string that matches (partially) some of the model parameter names.</p>
</td></tr>
<tr><td><code id="cooks.distance.gnm_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of individuals to identify on the plot of the Cook's
distance. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="cooks.distance.gnm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used
to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>,
<code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cook's distance consists of the <em>distance</em> between two estimates of the parameters in the linear
predictor using a metric based on the (estimate of the) variance-covariance matrix. The first one set of estimates
is computed from a dataset including all individuals, and the second one is computed from a dataset in which the
<em>i</em>-th individual is excluded. To avoid computational burden, the second set of estimates is replaced by its
<em>one-step approximation</em>. See the <a href="#topic+dfbeta.overglm">dfbeta.overglm</a> documentation.
</p>


<h3>Value</h3>

<p>A matrix as many rows as individuals in the sample and one column with the values of the Cook's distance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)

cooks.distance(fit1, plot.it=TRUE, col="red", lty=1, lwd=1,
  col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Assay of an Insecticide with a Synergist
data(Melanopus)
fit2 &lt;- gnm(Killed/Exposed ~ b0 + b1*log(Insecticide-a1) + b2*Synergist/(a2 + Synergist),
            family=binomial(logit), weights=Exposed, start=c(b0=-3,b1=1.2,a1=1.7,b2=1.7,a2=2),
		   data=Melanopus)

### Cook's distance just for the parameter "b1"
cooks.distance(fit2, plot.it=TRUE, coef="b1", col="red", lty=1, lwd=1,
  col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 3: Developmental rate of Drosophila melanogaster
data(Drosophila)
fit3 &lt;- gnm(Duration ~ b0 + b1*Temp + b2/(Temp-a), family=Gamma(log),
            start=c(b0=3,b1=-0.25,b2=-210,a=55), weights=Size, data=Drosophila)

cooks.distance(fit3, plot.it=TRUE, col="red", lty=1, lwd=1,
  col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 4: Radioimmunological Assay of Cortisol
data(Cortisol)
fit4 &lt;- gnm(Y ~ b0 + (b1-b0)/(1 + exp(b2+ b3*lDose))^b4, family=Gamma(identity),
            start=c(b0=130,b1=2800,b2=3,b3=3,b4=0.5), data=Cortisol)

cooks.distance(fit4, plot.it=TRUE, col="red", lty=1, lwd=1,
  col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='cooks.distance.overglm'>Cook's Distance for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion</h2><span id='topic+cooks.distance.overglm'></span>

<h3>Description</h3>

<p>Produces an approximation, better known as the <em>one-step approximation</em>, of the Cook's distance,
which is aimed to measure the effect on the estimates of the parameters in the linear predictor of deleting each
observation in turn. This function also can produce an index plot of the Cook's distance for all parameters in
the linear predictor or for some subset of them (via the argument <code>coefs</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'overglm'
cooks.distance(model, plot.it = FALSE, coefs, identify, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cooks.distance.overglm_+3A_model">model</code></td>
<td>
<p>an object of class <em>overglm</em>.</p>
</td></tr>
<tr><td><code id="cooks.distance.overglm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical indicating if the plot is required or just the data matrix in which that
plot is based. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="cooks.distance.overglm_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of some model parameters.</p>
</td></tr>
<tr><td><code id="cooks.distance.overglm_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of individuals to identify on the plot of the Cook's
distance. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="cooks.distance.overglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used
to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>,
<code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cook's distance consists of the <em>distance</em> between two estimates of the parameters in the linear
predictor using a metric based on the (estimate of the) variance-covariance matrix. The first one set of estimates
is computed from a dataset including all individuals, and the second one is computed from a dataset in which the
<em>i</em>-th individual is excluded. To avoid computational burden, the second set of estimates is replaced by its
<em>one-step approximation</em>. See the <a href="#topic+dfbeta.overglm">dfbeta.overglm</a> documentation.
</p>


<h3>Value</h3>

<p>A matrix as many rows as individuals in the sample and one column with the values of the Cook's distance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- overglm(infections ~ frequency + location, family="nb1(log)", data=swimmers)

### Cook's distance for all parameters in the linear predictor
cooks.distance(fit1, plot.it=TRUE, col="red", lty=1, lwd=1, col.lab="blue",
               col.axis="blue", col.main="black", family="mono", cex=0.8)

### Cook's distance just for the parameter associated with 'frequency'
cooks.distance(fit1, plot.it=TRUE, coef="frequency", col="red", lty=1, lwd=1,
   col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit2 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)

### Cook's distance for all parameters in the linear predictor
cooks.distance(fit2, plot.it=TRUE, col="red", lty=1, lwd=1, col.lab="blue",
               col.axis="blue", col.main="black", family="mono", cex=0.8)

### Cook's distance just for the parameter associated with 'fem'
cooks.distance(fit2, plot.it=TRUE, coef="fem", col="red", lty=1, lwd=1,
   col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 3: Agents to stimulate cellular differentiation
data(cellular)
fit3 &lt;- overglm(cbind(cells,200-cells) ~ tnf + ifn, family="bb(logit)", data=cellular)

### Cook's distance for all parameters in the linear predictor
cooks.distance(fit3, plot.it=TRUE, col="red", lty=1, lwd=1, col.lab="blue",
               col.axis="blue", col.main="black", family="mono", cex=0.8)

### Cook's distance just for the parameter associated with 'tnf'
cooks.distance(fit3, plot.it=TRUE, coef="tnf", col="red", lty=1, lwd=1,
  col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='cooks.distance.zeroinflation'>Cook's Distance for Regression Models to deal with Zero-Excess in Count Data</h2><span id='topic+cooks.distance.zeroinflation'></span>

<h3>Description</h3>

<p>Produces an approximation, better known as the <em>one-step approximation</em>, of the Cook's distance,
which is aimed to measure the effect on the estimates of the parameters in the linear predictor of deleting each
observation in turn. This function also can produce an index plot of the Cook's distance for all parameters in
the linear predictor or for some subset of them (via the argument <code>coefs</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'zeroinflation'
cooks.distance(
  model,
  submodel = c("counts", "zeros", "full"),
  plot.it = FALSE,
  coefs,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cooks.distance.zeroinflation_+3A_model">model</code></td>
<td>
<p>an object of class <em>zeroinflation</em>.</p>
</td></tr>
<tr><td><code id="cooks.distance.zeroinflation_+3A_submodel">submodel</code></td>
<td>
<p>an (optional) character string which allows to specify the model: &quot;counts&quot;, &quot;zeros&quot; or &quot;full&quot;. By default,
<code>submodel</code> is set to &quot;counts&quot;.</p>
</td></tr>
<tr><td><code id="cooks.distance.zeroinflation_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical indicating if the plot is required or just the data matrix in which that
plot is based. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="cooks.distance.zeroinflation_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of some model parameters.</p>
</td></tr>
<tr><td><code id="cooks.distance.zeroinflation_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of individuals to identify on the plot of the Cook's
distance. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="cooks.distance.zeroinflation_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used
to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>,
<code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Cook's distance consists of the <em>distance</em> between two estimates of the parameters in the linear
predictor using a metric based on the (estimate of the) variance-covariance matrix. The first one set of estimates
is computed from a dataset including all individuals, and the second one is computed from a dataset in which the
<em>i</em>-th individual is excluded. To avoid computational burden, the second set of estimates is replaced by its
<em>one-step approximation</em>. See the <a href="#topic+dfbeta.zeroinflation">dfbeta.zeroinflation</a> documentation.
</p>


<h3>Value</h3>

<p>A matrix as many rows as individuals in the sample and one column with the values of the Cook's distance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
####### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit &lt;- zeroinf(infections ~ frequency + location, family="nb1(log)", data=swimmers)

### Cook's distance for all parameters in the "counts" model
cooks.distance(fit, submodel="counts", plot.it=TRUE, col="red", lty=1, lwd=1,
         col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

### Cook's distance for all parameters in the "zeros" model
cooks.distance(fit, submodel="zeros", plot.it=TRUE, col="red", lty=1, lwd=1,
         col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='Cortisol'>Radioimmunological Assay of Cortisol</h2><span id='topic+Cortisol'></span>

<h3>Description</h3>

<p>The amount of hormone contained in a preparation
cannot be measured directly, so estimating an unknown dose of
hormone involves a two-step process. A calibration curve must
first be established, then the curve must be inverted to
determine the hormone dose. The calibration curve is estimated
using a radioimmunological assay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Cortisol)
</code></pre>


<h3>Format</h3>

<p>A data frame with 64 rows and 2 variables:
</p>

<dl>
<dt>lDose</dt><dd><p>a numeric vector indicating the logarithm in base 10 of the dose.</p>
</dd>
<dt>Y</dt><dd><p>a numeric vector indicating the response, in counts per minute.</p>
</dd>
</dl>



<h3>References</h3>

<p>Huet S., Bouvier A., Poursat M.-A., Jolivet E. (2004). <em>Statistical tools for nonlinear regression : a practical guide with S-PLUS and R
examples. 2nd Edition</em>. Springer,  New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cortisol)
dev.new()
with(Cortisol, plot(lDose,Y,xlab="Log10(Dose, in ng/0.1 ml)",pch=16,col="blue",
                    ylab="Response, in counts per minute"))
</code></pre>

<hr>
<h2 id='coupons'>Discount coupons</h2><span id='topic+coupons'></span>

<h3>Description</h3>

<p>The market research department of a soft drink
manufacturer is investigating the effectiveness of a price discount
coupon on the purchase of a two-litre beverage product. A sample of
5500 costumers received coupons for varying price discounts between
5 and 25 cents. The main objective of the analysis is to determine
if the price discount affects the proportion of redeemed coupons
after one month.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(coupons)
</code></pre>


<h3>Format</h3>

<p>A data frame with 11 rows and 3 variables:
</p>

<dl>
<dt>discounts</dt><dd><p>a numeric vector indicating the price discount, in cents.</p>
</dd>
<dt>costumers</dt><dd><p>a numeric vector indicating the number of customers who received coupons.</p>
</dd>
<dt>redeemed</dt><dd><p>a numeric vector indicating the number of redeemed coupons.</p>
</dd>
</dl>



<h3>References</h3>

<p>Montgomery D.C., Peck E.A., Vining G. (2012, page 464) <em>Introduction to linear regression analysis. 5th ed.</em> Berlin, Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dev.new()
data(coupons)
barplot(100*redeemed/costumers ~ discounts, data=coupons, xlab="Discount price",
        ylab="(%) Redeemed coupons", col="blue")
</code></pre>

<hr>
<h2 id='depression'>Treatment for severe postnatal depression</h2><span id='topic+depression'></span>

<h3>Description</h3>

<p>These data arose from a study on the efficacy of oestrogen
given transdermally for the treatment of severe postnatal depression.
Women with major depression were randomly assigned to a placebo control
group or an oestrogen patch group. Prior to the treatment all women
were assessed by self-rated depressive symptoms on the Edinburgh
Postnatal Depression Scale (EPDS). EPDS data were collected monthly
for six months once treatment began. Higher EDPS scores are indicative
of higher depression levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(depression)
</code></pre>


<h3>Format</h3>

<p>A data frame with 427 rows and 5 variables:
</p>

<dl>
<dt>subj</dt><dd><p> a numeric vector giving the identifier of each woman.</p>
</dd>
<dt>group</dt><dd><p> a factor giving the received treatment: &quot;placebo&quot; or &quot;oestrogen&quot;.</p>
</dd>
<dt>visit</dt><dd><p> a numeric vector giving the number of months since the treatment began, where -1 indicates the pretreatment assessment of the EDPS.</p>
</dd>
<dt>dep</dt><dd><p> a numeric vector giving the value of the EDPS.</p>
</dd>
<dt>depressd</dt><dd><p> a numeric vector coded as 1 when the value of the EDPS is greater than or equal to 11 and coded as 0 in other cases.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://stats.oarc.ucla.edu/spss/library/spss-librarypanel-data-analysis-using-gee/">https://stats.oarc.ucla.edu/spss/library/spss-librarypanel-data-analysis-using-gee/</a>
</p>


<h3>References</h3>

<p>Gregoire A.J.P., Kumar R., Everitt B., Henderson A.F., Studd J.W.W. (1996) Transdermal oestrogen for treatment of severe postnatal depression,
<em>The Lancet</em> 347:930-933.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(depression)
dev.new()
boxplot(dep ~ visit, data=subset(depression,group=="placebo"), at=c(0:6) - 0.2,
        col="yellow", boxwex=0.3, xaxt="n", ylim=range(na.omit(depression$dep)),
        xlab="Months since the treatment began", ylab="EDPS")
boxplot(dep ~ visit, data=subset(depression,group=="oestrogen"), add=TRUE,
        at=c(0:6) + 0.2, col="blue", boxwex=0.3, xaxt="n")
axis(1, at=c(0:6), labels=c(-1,1:6))
legend("bottomleft", legend=c("placebo","oestrogen"), fill=c("yellow","blue"),
       title="Treatment", bty="n")

</code></pre>

<hr>
<h2 id='dfbeta.glmgee'>Dfbeta for Generalized Estimating Equations</h2><span id='topic+dfbeta.glmgee'></span>

<h3>Description</h3>

<p>Produces an approximation, better known as the <em>one-step approximation</em>,
of the effect on the parameter estimates of deleting each cluster/observation in turn. This function also can produce
an index plot of the Dfbeta Statistic for some parameters via the argument <code>coefs</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmgee'
dfbeta(
  model,
  level = c("clusters", "observations"),
  method = c("Preisser-Qaqish", "full"),
  coefs,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfbeta.glmgee_+3A_model">model</code></td>
<td>
<p>an object of class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="dfbeta.glmgee_+3A_level">level</code></td>
<td>
<p>an (optional) character string indicating the level for which the Dfbeta statistic is required. The options are: cluster-level (&quot;clusters&quot;) and observation-level (&quot;observations&quot;). As default, <code>level</code> is set to &quot;clusters&quot;.</p>
</td></tr>
<tr><td><code id="dfbeta.glmgee_+3A_method">method</code></td>
<td>
<p>an (optional) character string indicating the method of calculation for the <em>one-step approximation</em>. The options are: the <em>one-step approximation</em> described by Preisser and Qaqish (1996) in which the working-correlation matrix is assumed to be known (&quot;Preisser-Qaqish&quot;); and the &quot;authentic&quot; <em>one-step approximation</em> (&quot;full&quot;). As default, <code>method</code> is set to &quot;Preisser-Qaqish&quot;.</p>
</td></tr>
<tr><td><code id="dfbeta.glmgee_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of some parameters in the linear predictor.</p>
</td></tr>
<tr><td><code id="dfbeta.glmgee_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of clusters/observations to identify on the plot of the Dfbeta statistic. This is only appropriate if <code>coefs</code> is specified.</p>
</td></tr>
<tr><td><code id="dfbeta.glmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>coefs</code> is specified then <code>...</code> may be used to include graphical parameters to customize the plot. For example,  <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <em>one-step approximation</em> (with the <code>method</code> &quot;full&quot;) of the estimates of the parameters in the linear
predictor of a GEE when the <em>i</em>-th cluster is excluded from the dataset is given by the
vector obtained as the result of the first iteration of the fitting algorithm of that GEE
when it is performed using:  (1) a dataset in which the <em>i</em>-th cluster is excluded; and
(2) a starting value which is the solution to the same GEE but based on the dataset inluding all clusters.
</p>


<h3>Value</h3>

<p>A matrix with so many rows as clusters/observations in the sample and so many
columns as parameters in the linear predictor. For clusters, the <code class="reqn">i</code>-th row of that matrix corresponds to the
difference between the estimates of the parameters in the linear predictor using all clustersand the <em>one-step approximation</em> of those estimates when the <em>i</em>-th cluster is excluded from the dataset.
</p>


<h3>References</h3>

<p>Pregibon D. (1981). Logistic regression diagnostics. <em>The Annals of Statistics</em> 9, 705-724.
</p>
<p>Preisser J.S., Qaqish B.F. (1996) Deletion diagnostics for generalised estimating equations.
<em>Biometrika</em> 83:551–562.
</p>
<p>Hammill B.G., Preisser J.S. (2006) A SAS/IML software program for GEE and regression diagnostics.
<em>Computational Statistics &amp; Data Analysis</em> 51:1197-1212.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), corstr="AR-M-dependent", data=spruces)
dfbs1 &lt;- dfbeta(fit1, method="full", coefs="treat", col="red", lty=1, lwd=1, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8, main="treat")

### Calculation by hand of dfbeta for the tree labeled by "N1T01"
onestep1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), corstr="AR-M-dependent",
            data=spruces, start=coef(fit1), subset=c(tree!="N1T01"), maxit=1)

coef(fit1)-coef(onestep1)
dfbs1[rownames(dfbs1)=="N1T01",]

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit2 &lt;- glmgee(mod2, id=subj, family=binomial(logit), corstr="AR-M-dependent",
               data=depression)

dfbs2 &lt;- dfbeta(fit2, method="full", coefs="group" ,col="red", lty=1, lwd=1, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8, main="group")

### Calculation by hand of dfbeta for the woman labeled by "18"
onestep2 &lt;- glmgee(mod2, id=subj, family=binomial(logit), corstr="AR-M-dependent",
            data=depression, start=coef(fit2), subset=c(subj!=18), maxit=1)

coef(fit2)-coef(onestep2)
dfbs2[rownames(dfbs2)==18,]

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit3 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), corstr="AR-M-dependent",
               data=depression)

dfbs3 &lt;- dfbeta(fit3, method="full", coefs="visit:group" ,col="red", lty=1, lwd=1, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8, main="visit:group")

### Calculation by hand of dfbeta for the woman labeled by "18"
onestep3 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), corstr="AR-M-dependent",
            data=depression, start=coef(fit3), subset=c(subj!=18), maxit=1)

coef(fit3)-coef(onestep3)
dfbs3[rownames(dfbs3)==18,]

</code></pre>

<hr>
<h2 id='dfbeta.gnm'>Dfbeta statistic for Generalized Nonlinear Models</h2><span id='topic+dfbeta.gnm'></span>

<h3>Description</h3>

<p>Calculates an approximation of the parameter estimates that would be produced by deleting each case in turn,
which is known as the <em>one-step approximation</em>. Additionally, the function can produce an index plot of the Dfbeta statistic
for some parameter specified by the argument <code>coefs</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnm'
dfbeta(model, coefs, identify, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfbeta.gnm_+3A_model">model</code></td>
<td>
<p>an object of class <em>gnm</em>.</p>
</td></tr>
<tr><td><code id="dfbeta.gnm_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of some model parameters.</p>
</td></tr>
<tr><td><code id="dfbeta.gnm_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of individuals to identify on the plot of the Dfbeta statistic.
This is only appropriate if <code>coefs</code> is specified.</p>
</td></tr>
<tr><td><code id="dfbeta.gnm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used
to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>,
<code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <em>one-step approximation</em> of the parameters estimates when the <code class="reqn">i</code>-th case
is excluded from the dataset consists of the vector obtained as a result of the first iteration of the Fisher Scoring
algorithm when it is performed using: (1) a dataset in which the <code class="reqn">i</code>-th case is excluded; and (2)
a starting value that is the estimate of the same model but based on the dataset including all cases.
</p>


<h3>Value</h3>

<p>A matrix with as many rows as cases in the sample and as many columns as parameters in the linear predictor. The
<code class="reqn">i</code>-th row in that matrix corresponds to the difference between the parameters estimates obtained using all cases
and the <em>one-step approximation</em> of those estimates when excluding the <code class="reqn">i</code>-th case from the dataset.
</p>


<h3>References</h3>

<p>Pregibon D. (1981). Logistic regression diagnostics. <em>The Annals of Statistics</em>, 9, 705-724.
</p>
<p>Wei B.C. (1998). <em>Exponential Family Nonlinear Models</em>. Springer, Singapore.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)

fit1a &lt;- update(fit1, subset=-c(1), start=coef(fit1), maxit=1)
coef(fit1) - coef(fit1a)

dfbetas &lt;- dfbeta(fit1)
round(dfbetas[1,],5)

###### Example 2: Assay of an Insecticide with a Synergist
data(Melanopus)
fit2 &lt;- gnm(Killed/Exposed ~ b0 + b1*log(Insecticide-a1) + b2*Synergist/(a2 + Synergist),
            family=binomial(logit), weights=Exposed, start=c(b0=-3,b1=1.2,a1=1.7,b2=1.7,a2=2),
		   data=Melanopus)

fit2a &lt;- update(fit2, subset=-c(2), start=coef(fit2), maxit=1)
coef(fit2) - coef(fit2a)

dfbetas &lt;- dfbeta(fit2)
round(dfbetas[2,],5)

###### Example 3: Developmental rate of Drosophila melanogaster
data(Drosophila)
fit3 &lt;- gnm(Duration ~ b0 + b1*Temp + b2/(Temp-a), family=Gamma(log),
            start=c(b0=3,b1=-0.25,b2=-210,a=55), weights=Size, data=Drosophila)

fit3a &lt;- update(fit3, subset=-c(3), start=coef(fit3), maxit=1)
coef(fit3) - coef(fit3a)

dfbetas &lt;- dfbeta(fit3)
round(dfbetas[3,],5)

###### Example 4: Radioimmunological Assay of Cortisol
data(Cortisol)
fit4 &lt;- gnm(Y ~ b0 + (b1-b0)/(1 + exp(b2+ b3*lDose))^b4, family=Gamma(identity),
            start=c(b0=130,b1=2800,b2=3,b3=3,b4=0.5), data=Cortisol)

fit4a &lt;- update(fit4, subset=-c(4), start=coef(fit4), maxit=1)
coef(fit4) - coef(fit4a)

dfbetas &lt;- dfbeta(fit4)
round(dfbetas[4,],5)

</code></pre>

<hr>
<h2 id='dfbeta.overglm'>Dfbeta statistic for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</h2><span id='topic+dfbeta.overglm'></span>

<h3>Description</h3>

<p>Produces an approximation, better known as the <em>one-step approximation</em>, of the effect on the
parameter estimates of deleting each individual in turn. This function also can produce an index plot of the
Dfbeta statistic for some parameter chosen via the argument <code>coefs</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'overglm'
dfbeta(model, coefs, identify, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfbeta.overglm_+3A_model">model</code></td>
<td>
<p>an object of class <em>overglm</em>.</p>
</td></tr>
<tr><td><code id="dfbeta.overglm_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of some model parameters.</p>
</td></tr>
<tr><td><code id="dfbeta.overglm_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of individuals to identify on the plot of the Dfbeta statistic.
This is only appropriate if <code>coefs</code> is specified.</p>
</td></tr>
<tr><td><code id="dfbeta.overglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used
to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>,
<code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <em>one-step approximation</em> of the estimates of the parameters when the <em>i</em>-th individual
is excluded from the dataset consists of the vector obtained as result of the first iteration of the Newthon-Raphson
algorithm when it is performed using: (1) a dataset in which the <em>i</em>-th individual is excluded; and (2)
a starting value which is the estimate of the same model but based on the dataset inluding all individuals.
</p>


<h3>Value</h3>

<p>A matrix with so many rows as individuals in the sample and so many columns as parameters in the linear
predictor. The <code class="reqn">i</code>-th row of that matrix corresponds to the difference between the estimates of the parameters
in the linear predictor using all individuals and the <em>one-step approximation</em> of those estimates when the
<em>i</em>-th individual is excluded from the dataset.
</p>


<h3>References</h3>

<p>Pregibon D. (1981). Logistic regression diagnostics. <em>The Annals of Statistics</em>, 9, 705-724.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- overglm(infections ~ frequency + location, family="nb1(log)", data=swimmers)
dfbeta(fit1, coefs="frequency", col="red", lty=1, lwd=1, col.lab="blue",
       col.axis="blue", col.main="black", family="mono", cex=0.8, main="frequency")

###### Example 2: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit2 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)
dfbeta(fit2, coefs="fem", col="red", lty=1, lwd=1, col.lab="blue",
       col.axis="blue", col.main="black", family="mono", cex=0.8, main="fem")

###### Example 3: Agents to stimulate cellular differentiation
data(cellular)
fit3 &lt;- overglm(cbind(cells,200-cells) ~ tnf + ifn, family="bb(logit)", data=cellular)
dfbeta(fit3, coefs="tnf", col="red", lty=1, lwd=1, col.lab="blue",
       col.axis="blue", col.main="black", family="mono", cex=0.8, main="tnf")
</code></pre>

<hr>
<h2 id='dfbeta.zeroinflation'>Dfbeta statistic for Regression Models to deal with Zero-Excess in Count Data</h2><span id='topic+dfbeta.zeroinflation'></span>

<h3>Description</h3>

<p>Produces an approximation, better known as the <em>one-step approximation</em>, of the effect on the
parameter estimates of deleting each individual in turn. This function also can produce an index plot
of the Dfbeta statistic for some parameter chosen via the argument <code>coefs</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'zeroinflation'
dfbeta(model, submodel = c("counts", "zeros"), coefs, identify, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfbeta.zeroinflation_+3A_model">model</code></td>
<td>
<p>an object of class <em>zeroinflation</em>.</p>
</td></tr>
<tr><td><code id="dfbeta.zeroinflation_+3A_submodel">submodel</code></td>
<td>
<p>an (optional) character string which allows to specify the model: &quot;counts&quot; or &quot;zeros&quot;. By default,
<code>submodel</code> is set to &quot;counts&quot;.</p>
</td></tr>
<tr><td><code id="dfbeta.zeroinflation_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of some model parameters.</p>
</td></tr>
<tr><td><code id="dfbeta.zeroinflation_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of individuals to identify on the plot of the Dfbeta statistic. This
is only appropriate if <code>coefs</code> is specified.</p>
</td></tr>
<tr><td><code id="dfbeta.zeroinflation_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used
to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>,
<code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <em>one-step approximation</em> of the estimates of the parameters when the <em>i</em>-th individual
is excluded from the dataset consists of the vector obtained as result of the first iteration of the Newthon-Raphson
algorithm when it is performed using: (1) a dataset in which the <em>i</em>-th individual is excluded; and (2)
a starting value which is the estimate of the same model but based on the dataset inluding all individuals.
</p>


<h3>Value</h3>

<p>A matrix with so many rows as individuals in the sample and so many columns as parameters in the linear
predictor. The <code class="reqn">i</code>-th row of that matrix corresponds to the difference between the estimates of the parameters
in the linear predictor using all individuals and the <em>one-step approximation</em> of those estimates when the
<em>i</em>-th individual is excluded from the dataset.
</p>


<h3>References</h3>

<p>Pregibon D. (1981). Logistic regression diagnostics. <em>The Annals of Statistics</em>, 9, 705-724.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>####### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit &lt;- zeroinf(infections ~ frequency + location, family="nb1(log)", data=swimmers)

dfbeta(fit, submodel="counts", coefs="frequency", col="red", lty=1, lwd=1,
       col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

dfbeta(fit, submodel="zeros", coefs="location", col="red", lty=1, lwd=1,
       col.lab="blue", col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='dilution'>Dilution Assay</h2><span id='topic+dilution'></span>

<h3>Description</h3>

<p>These data are counts of virus particles at 5 different
dilutions. There are 4 replicate counts at each dilution except the
last for which there are 5 counts. The aim is to estimate the expected
number of virus particles per unit volume.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dilution)
</code></pre>


<h3>Format</h3>

<p>A data frame with 21 rows and 2 variables:
</p>

<dl>
<dt>Count</dt><dd><p>a numeric vector indicating the count of virus particles.</p>
</dd>
<dt>Dilution</dt><dd><p>a numeric vector indicating the dilution volume.</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://sada2013.sciencesconf.org/16138/glmSession4_Cotonou.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dilution)
xlab &lt;- "Dilution volume"
ylab &lt;- "Count of virus particles"
dev.new()
with(dilution,plot(Dilution,Count,pch=20,xlab=xlab,ylab=ylab))
</code></pre>

<hr>
<h2 id='Drosophila'>Developmental rate of Drosophila melanogaster</h2><span id='topic+Drosophila'></span>

<h3>Description</h3>

<p><em>Drosophila melanogaster</em> developmental stages were monitored as part of an experiment to determine the effect of temperature
on their duration. The eggs were laid at approximately 25 degrees Celsius and remained at that temperature for 20-30 minutes. The eggs were then
brought to the experimental temperature, which remained constant throughout the experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Drosophila)
</code></pre>


<h3>Format</h3>

<p>A data frame with 23 rows and 3 variables:
</p>

<dl>
<dt>Temp</dt><dd><p>a numeric vector indicating the temperature, in degrees Celsius.</p>
</dd>
<dt>Duration</dt><dd><p>a numeric vector indicating the average duration of the embryonic period, in hours, measured from the time at which the eggs were laid.</p>
</dd>
<dt>Size</dt><dd><p>a numeric vector indicating how many eggs each batch contained.</p>
</dd>
</dl>



<h3>References</h3>

<p>Powsner L. (1935) The effects of temperature on the durations of the developmental stages of <em>Drosophila melanogaster</em>.
<em>Physiological Zoology</em>, 8, 474-520.
</p>
<p>McCullagh P., Nelder J.A. (1989). <em>Generalized Linear Models. 2nd Edition</em>. Chapman and Hall, London.
</p>
<p>Wei B.C. (1998). <em>Exponential Family Nonlinear Models</em>. Springer, Singapore.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Drosophila)
dev.new()
with(Drosophila, plot(Temp,Duration,xlab="Temperature, in degrees Celsius",pch=16,col="blue",
                      ylab="Average duration of the embryonic period"))
</code></pre>

<hr>
<h2 id='envelope'>Normal QQ-plot with simulated envelope of model residuals</h2><span id='topic+envelope'></span>

<h3>Description</h3>

<p>Generic function for building a normal QQ-plot with simulated envelope of residuals obtained from a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>envelope(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope_+3A_object">object</code></td>
<td>
<p>a fitted model object.</p>
</td></tr>
<tr><td><code id="envelope_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the simulated envelope and, optionally, a plot of it.
</p>

<hr>
<h2 id='envelope.glm'>Normal QQ-plot with simulated envelope of residuals in Generalized Linear Models</h2><span id='topic+envelope.glm'></span>

<h3>Description</h3>

<p>Produces a normal QQ-plot with simulated envelope of residuals for generalized linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
envelope(
  object,
  rep = 25,
  conf = 0.95,
  type = c("quantile", "deviance", "pearson"),
  standardized = FALSE,
  plot.it = TRUE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope.glm_+3A_object">object</code></td>
<td>
<p>an object of the class <em>glm</em>.</p>
</td></tr>
<tr><td><code id="envelope.glm_+3A_rep">rep</code></td>
<td>
<p>an (optional) positive integer which allows to specify the number of replicates which should be used to build the simulated envelope. As default, <code>rep</code> is set to 25.</p>
</td></tr>
<tr><td><code id="envelope.glm_+3A_conf">conf</code></td>
<td>
<p>an (optional) value in the interval (0,1) indicating the confidence level which should be used to build the pointwise confidence intervals, which form the envelope. As default, <code>conf</code> is set to 0.95.</p>
</td></tr>
<tr><td><code id="envelope.glm_+3A_type">type</code></td>
<td>
<p>an (optional) character string indicating the type of residuals which should be used. The available options are: randomized quantile (&quot;quantile&quot;), deviance (&quot;deviance&quot;) and pearson (&quot;pearson&quot;) residuals. As default, <code>type</code> is set to &quot;quantile&quot;.</p>
</td></tr>
<tr><td><code id="envelope.glm_+3A_standardized">standardized</code></td>
<td>
<p>an (optional) logical switch indicating if the residuals should be standardized by dividing by the square root of <code class="reqn">(1-h)</code>, where <code class="reqn">h</code> is a measure of leverage. As default, <code>standardized</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="envelope.glm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if the normal QQ-plot with simulated envelope of residuals is required or just the data matrix in which it is based. As default, <code>plot.it</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="envelope.glm_+3A_identify">identify</code></td>
<td>
<p>an (optional) positive integer indicating the number of individuals to identify on the QQ-plot with simulated envelope of residuals. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="envelope.glm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example,  <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to construct the simulated envelope, <code>rep</code> independent realizations of the response variable for each individual are simulated, which is
done by considering (1) the model assumption about the distribution of the response variable; (2) the estimation of the linear predictor parameters; and (3)
the estimation of the dispersion parameter. Each time, the vector of observed responses is replaced with one of the simulated samples, re-fitting the interest
model <code>rep</code> times. For each <code class="reqn">i=1,2,...,n</code>, where <code class="reqn">n</code> is the number of individuals in the sample, the <code class="reqn">i</code>-th order statistic of the
<code>type</code>-type residuals is computed and then sorted for each replicate, giving a random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order statistic. In
other words, the simulated envelope is comprised of the quantiles (1 - <code>conf</code>)/2 and (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of the
<code class="reqn">i</code>-th order statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>.
</p>


<h3>Value</h3>

<p>A matrix with the following four columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Lower limit</code> </td><td style="text-align: left;"> the quantile (1 - <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
                   </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Median</code> </td><td style="text-align: left;"> the quantile 0.5 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Upper limit</code> </td><td style="text-align: left;"> the quantile (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
                   </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Residuals</code> </td><td style="text-align: left;"> the observed <code>type</code>-type residuals,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Atkinson A.C. (1985) <em>Plots, Transformations and Regression</em>. Oxford University Press, Oxford.
</p>
<p>Davison A.C., Gigli A. (1989) Deviance Residuals and Normal Scores Plots. <em>Biometrika</em> 76, 211-221.
</p>
<p>Dunn P.K., Smyth G.K. (1996) Randomized Quantile Residuals. <em>Journal of Computational and Graphical Statistics</em> 5, 236-244.
</p>
<p>Pierce D.A., Schafer D.W. (1986) Residuals in Generalized Linear Models. <em>Journal of the American Statistical Association</em> 81, 977-986.
</p>
<p>Wei B.C. (1998). <em>Exponential Family Nonlinear Models</em>. Springer, Singapore.
</p>


<h3>See Also</h3>

<p><a href="#topic+envelope.lm">envelope.lm</a>, <a href="#topic+envelope.gnm">envelope.gnm</a>, <a href="#topic+envelope.overglm">envelope.overglm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1:
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death &lt;- factor(death, levels=c("Dead","Alive")))
fit1 &lt;- glm(death ~ age*inh_inj + tbsa*inh_inj, family=binomial("logit"), data=burn1000)
envelope(fit1, rep=50, conf=0.95, type="pearson", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Fuel consumption of automobiles
Auto &lt;- ISLR::Auto
fit2 &lt;- glm(mpg ~ horsepower*weight, family=inverse.gaussian("log"), data=Auto)
envelope(fit2, rep=50, conf=0.95, type="pearson", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 3: Skin cancer in women
data(skincancer)
fit3 &lt;- glm(cases ~ city + ageC, offset=log(population), family=poisson, data=skincancer)
envelope(fit3, rep=100, conf=0.95, type="quantile", col="red", pch=20,col.lab="blue",
         col.axis="blue",col.main="black",family="mono",cex=0.8)

###### Example 4: Self diagnozed ear infections in swimmers
data(swimmers)
fit4 &lt;- glm(infections ~ frequency + location, family=poisson(log), data=swimmers)
envelope(fit4, rep=100, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 5: Agents to stimulate cellular differentiation
data(cellular)
fit5 &lt;- glm(cbind(cells,200-cells) ~ tnf + ifn, family=binomial(logit), data=cellular)
envelope(fit5, rep=100, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='envelope.gnm'>Normal QQ-plot with simulated envelope of residuals in Generalized Nonlinear Models</h2><span id='topic+envelope.gnm'></span>

<h3>Description</h3>

<p>Produces a normal QQ-plot with simulated envelope of residuals for generalized nonlinear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnm'
envelope(
  object,
  rep = 25,
  conf = 0.95,
  type = c("quantile", "deviance", "pearson"),
  standardized = FALSE,
  plot.it = TRUE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope.gnm_+3A_object">object</code></td>
<td>
<p>an object of the class <em>gnm</em>.</p>
</td></tr>
<tr><td><code id="envelope.gnm_+3A_rep">rep</code></td>
<td>
<p>an (optional) positive integer which allows to specify the number of replicates which should be used to build the simulated envelope. As default, <code>rep</code> is set to 25.</p>
</td></tr>
<tr><td><code id="envelope.gnm_+3A_conf">conf</code></td>
<td>
<p>an (optional) value in the interval (0,1) indicating the confidence level which should be used to build the pointwise confidence intervals, which form the envelope. As default, <code>conf</code> is set to 0.95.</p>
</td></tr>
<tr><td><code id="envelope.gnm_+3A_type">type</code></td>
<td>
<p>a character string indicating the type of residuals which should be used. The available options are: randomized quantile (&quot;quantile&quot;), deviance (&quot;deviance&quot;) and pearson (&quot;pearson&quot;) residuals. As default, <code>type</code> is set to &quot;quantile&quot;.</p>
</td></tr>
<tr><td><code id="envelope.gnm_+3A_standardized">standardized</code></td>
<td>
<p>an (optional) logical switch indicating if the residuals should be standardized by dividing by the square root of <code class="reqn">(1-h)</code>, where <code class="reqn">h</code> is a measure of leverage. As default, <code>standardized</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="envelope.gnm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if the normal QQ-plot with simulated envelope of residuals is required or just the data matrix in which it is based. As default, <code>plot.it</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="envelope.gnm_+3A_identify">identify</code></td>
<td>
<p>an (optional) positive integer indicating the number of individuals to identify on the QQ-plot with simulated envelope of residuals. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="envelope.gnm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example,  <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to construct the simulated envelope, <code>rep</code> independent realizations of the response variable for each individual are simulated, which is
done by considering (1) the model assumption about the distribution of the response variable; (2) the estimation of the &quot;linear&quot; predictor parameters; and (3)
the estimation of the dispersion parameter. Each time, the vector of observed responses is replaced with one of the simulated samples, re-fitting the interest
model <code>rep</code> times. For each <code class="reqn">i=1,2,...,n</code>, where <code class="reqn">n</code> is the number of individuals in the sample, the <code class="reqn">i</code>-th order statistic of the
<code>type</code>-type residuals is computed and then sorted for each replicate, giving a random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order statistic. In
other words, the simulated envelope is comprised of the quantiles (1 - <code>conf</code>)/2 and (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of the
<code class="reqn">i</code>-th order statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>.
</p>


<h3>Value</h3>

<p>A matrix with the following four columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Lower limit</code> </td><td style="text-align: left;"> the quantile (1 - <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
                   </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Median</code> </td><td style="text-align: left;"> the quantile 0.5 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Upper limit</code> </td><td style="text-align: left;"> the quantile (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
                   </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Residuals</code> </td><td style="text-align: left;"> the observed <code>type</code>-type residuals,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Atkinson A.C. (1985) <em>Plots, Transformations and Regression</em>. Oxford University Press, Oxford.
</p>
<p>Davison A.C., Gigli A. (1989) Deviance Residuals and Normal Scores Plots. <em>Biometrika</em> 76, 211-221.
</p>
<p>Dunn P.K., Smyth G.K. (1996) Randomized Quantile Residuals. <em>Journal of Computational and Graphical Statistics</em> 5, 236-244.
</p>
<p>Pierce D.A., Schafer D.W. (1986) Residuals in Generalized Linear Models. <em>Journal of the American Statistical Association</em> 81, 977-986.
</p>
<p>Wei B.C. (1998). <em>Exponential Family Nonlinear Models</em>. Springer, Singapore.
</p>


<h3>See Also</h3>

<p><a href="#topic+envelope.lm">envelope.lm</a>, <a href="#topic+envelope.overglm">envelope.overglm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)

#envelope(fit1, rep=50, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
#         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Assay of an Insecticide with a Synergist
data(Melanopus)
fit2 &lt;- gnm(Killed/Exposed ~ b0 + b1*log(Insecticide-a1) + b2*Synergist/(a2 + Synergist),
            family=binomial(logit), weights=Exposed, start=c(b0=-3,b1=1.2,a1=1.7,b2=1.7,a2=2),
		   data=Melanopus)

#envelope(fit2, rep=50, conf=0.95, type="pearson", col="red", pch=20, col.lab="blue",
#         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 3: Developmental rate of Drosophila melanogaster
data(Drosophila)
fit3 &lt;- gnm(Duration ~ b0 + b1*Temp + b2/(Temp-a), family=Gamma(log),
            start=c(b0=3,b1=-0.25,b2=-210,a=55), weights=Size, data=Drosophila)

#envelope(fit3, rep=50, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
#         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 4: Radioimmunological Assay of Cortisol
data(Cortisol)
fit4 &lt;- gnm(Y ~ b0 + (b1-b0)/(1 + exp(b2+ b3*lDose))^b4, family=Gamma(identity),
            start=c(b0=130,b1=2800,b2=3,b3=3,b4=0.5), data=Cortisol)

#envelope(fit4, rep=50, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
#         col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='envelope.lm'>Normal QQ-plot with simulated envelope of residuals for normal linear models</h2><span id='topic+envelope.lm'></span>

<h3>Description</h3>

<p>Produces a normal QQ-plot with simulated envelope of residuals obtained from the fit of a normal linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
envelope(
  object,
  rep = 100,
  conf = 0.95,
  type = c("external", "internal"),
  plot.it = TRUE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope.lm_+3A_object">object</code></td>
<td>
<p>an object of the class <em>lm</em>.</p>
</td></tr>
<tr><td><code id="envelope.lm_+3A_rep">rep</code></td>
<td>
<p>an (optional) positive integer indicating the number of replicates which should be used to build the simulated envelope. As default, <code>rep</code> is set to 100.</p>
</td></tr>
<tr><td><code id="envelope.lm_+3A_conf">conf</code></td>
<td>
<p>an (optional) value in the interval (0,1) indicating the confidence level which should be used to build the pointwise confidence intervals, which form the envelope. As default, <code>conf</code> is set to 0.95.</p>
</td></tr>
<tr><td><code id="envelope.lm_+3A_type">type</code></td>
<td>
<p>a character string indicating the type of residuals which should be used. The available options are: internally Studentized (&quot;internal&quot;) and externally Studentized (&quot;external&quot;) residuals. See Cook and Weisberg (1982, pages 18-20).</p>
</td></tr>
<tr><td><code id="envelope.lm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if the normal QQ-plot with simulated envelope of residuals is required or just the data matrix in which it is based. As default, <code>plot.it</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="envelope.lm_+3A_identify">identify</code></td>
<td>
<p>an (optional) positive integer value indicating the number of individuals to identify on the QQ-plot with simulated envelope of residuals. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="envelope.lm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The simulated envelope is built by simulating <code>rep</code> independent realizations
of the response variable for each individual, which is accomplished taking into account
the following: (1) the model assumption about the distribution of the response variable;
(2) the estimates of the parameters in the linear predictor; and (3) the estimate of the
dispersion parameter. The interest model is re-fitted <code>rep</code> times, as each time the
vector of observed responses is replaced by one of the simulated samples. The
<code>type</code>-type residuals are computed and then sorted for each replicate, so that for
each <code class="reqn">i=1,2,...,n</code>, where <code class="reqn">n</code> is the number of individuals in the sample, there
is a random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order statistic of the
<code>type</code>-type residuals. Therefore, the simulated envelope is composed of the quantiles
(1 - <code>conf</code>)/2 and (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of the
<code class="reqn">i</code>-th order statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>.
</p>


<h3>Value</h3>

<p>A matrix with the following four columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Lower limit</code> </td><td style="text-align: left;"> the quantile (1 - <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
                   </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Median</code> </td><td style="text-align: left;"> the quantile 0.5 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Upper limit</code> </td><td style="text-align: left;"> the quantile (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
                   </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Residuals</code> </td><td style="text-align: left;"> the observed <code>type</code>-type residuals,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Atkinson A.C. (1985) <em>Plots, Transformations and Regression</em>. Oxford University Press, Oxford.
</p>
<p>Cook R.D., Weisberg S. (1982) <em>Residuals and Influence in Regression</em>. Chapman and Hall, New York.
</p>


<h3>See Also</h3>

<p><a href="#topic+envelope.glm">envelope.glm</a>, <a href="#topic+envelope.overglm">envelope.overglm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Fuel consumption of automobiles
fit1 &lt;- lm(mpg ~ log(hp) + log(wt), data=mtcars)
envelope(fit1, rep=100, conf=0.95, type="external", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Species richness in plots
data(richness)
fit2 &lt;- lm(Species ~ Biomass + pH + Biomass*pH, data=richness)
envelope(fit2, rep=100, conf=0.95, type="internal", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 3: Gas consumption in a home before and after insulation
whiteside &lt;- MASS::whiteside
fit3 &lt;- lm(Gas ~ Temp + Insul + Temp*Insul, data=whiteside)
envelope(fit3, rep=100, conf=0.95, type="internal", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='envelope.overglm'>Normal QQ-plot with Simulated Envelope of Residuals for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion</h2><span id='topic+envelope.overglm'></span>

<h3>Description</h3>

<p>Produces a normal QQ-plot with simulated envelope of residuals for regression models based on the negative binomial, beta-binomial, and random-clumped binomial
distributions, which are alternatives to the Poisson and binomial regression models under the presence of overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'overglm'
envelope(
  object,
  rep = 25,
  conf = 0.95,
  type = c("quantile", "response", "standardized"),
  plot.it = TRUE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope.overglm_+3A_object">object</code></td>
<td>
<p>an object of class <em>overglm</em>.</p>
</td></tr>
<tr><td><code id="envelope.overglm_+3A_rep">rep</code></td>
<td>
<p>an (optional) positive integer which allows to specify the number of replicates which should be used to build the simulated envelope. As default, <code>rep</code> is set to 25.</p>
</td></tr>
<tr><td><code id="envelope.overglm_+3A_conf">conf</code></td>
<td>
<p>an (optional) value in the interval <code class="reqn">(0,1)</code> indicating the confidence level which should be used to build the pointwise confidence intervals, which conform the simulated envelope. As default, <code>conf</code> is set to 0.95.</p>
</td></tr>
<tr><td><code id="envelope.overglm_+3A_type">type</code></td>
<td>
<p>an (optional) character string which allows to specify the required type of residuals. The available options are: (1) the difference between the observed response
and the fitted mean (&quot;response&quot;); (2) the standardized difference between the observed response and the fitted mean (&quot;standardized&quot;); and (3) the randomized quantile
residual (&quot;quantile&quot;). As default, <code>type</code> is set to &quot;quantile&quot;.</p>
</td></tr>
<tr><td><code id="envelope.overglm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if the normal QQ-plot with simulated envelope of residuals is required or just the data matrix in which it is based. As default, <code>plot.it</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="envelope.overglm_+3A_identify">identify</code></td>
<td>
<p>an (optional) positive integer value indicating the number of individuals to identify on the QQ-plot with simulated envelope of residuals. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="envelope.overglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The simulated envelope is builded by simulating <code>rep</code> independent realizations of the response variable for each
individual, which is accomplished taking into account the following: (1) the model assumption about the distribution of
the response variable; (2) the estimates of the parameters in the linear predictor; and (3) the estimate of the
dispersion parameter. The interest model is re-fitted <code>rep</code> times, as each time the vector of observed responses
is replaced by one of the simulated samples. The <code>type</code>-type residuals are computed and then sorted for each
replicate, so that for each <code class="reqn">i=1,2,...,n</code>, where <code class="reqn">n</code> is the number of individuals in the sample, there is a random
sample of size <code>rep</code> of the <code class="reqn">i</code>-th order statistic of the  <code>type</code>-type residuals. Therefore, the simulated
envelope is composed of the quantiles (1 - <code>conf</code>)/2 and (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of
the <code class="reqn">i</code>-th order statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>.
</p>


<h3>Value</h3>

<p>A matrix with the following four columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Lower limit</code> </td><td style="text-align: left;"> the quantile (1 - <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
                   </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Median</code> </td><td style="text-align: left;"> the quantile 0.5 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Upper limit</code> </td><td style="text-align: left;"> the quantile (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
                   </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Residuals</code></td><td style="text-align: left;"> the observed <code>type</code>-type residuals,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Atkinson A.C. (1985) <em>Plots, Transformations and Regression</em>. Oxford University Press, Oxford.
</p>
<p>Dunn P.K., Smyth G.K. (1996) Randomized Quantile Residuals. <em>Journal of Computational and Graphical Statistics</em> 5, 236-244.
</p>


<h3>See Also</h3>

<p><a href="#topic+envelope.lm">envelope.lm</a>, <a href="#topic+envelope.glm">envelope.glm</a>, <a href="#topic+envelope.zeroinflation">envelope.zeroinflation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- overglm(infections ~ frequency + location, family="nb1(log)", data=swimmers)
envelope(fit1, rep=30, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8, plot.it=TRUE)

###### Example 2: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit2 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)
envelope(fit2, rep=30, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8, plot.it=TRUE)

###### Example 3: Agents to stimulate cellular differentiation
data(cellular)
fit3 &lt;- overglm(cbind(cells,200-cells) ~ tnf + ifn, family="bb(logit)", data=cellular)
envelope(fit3, rep=30, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8, plot.it=TRUE)

</code></pre>

<hr>
<h2 id='envelope.zeroinflation'>Normal QQ-plot with Simulated Envelope of Residuals for Regression Models to deal with Zero-Excess in Count Data</h2><span id='topic+envelope.zeroinflation'></span>

<h3>Description</h3>

<p>Produces a normal QQ-plot with simulated envelope of residuals for regression models used to deal with
zero-excess in count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'zeroinflation'
envelope(
  object,
  rep = 20,
  conf = 0.95,
  type = c("quantile", "response", "standardized"),
  plot.it = TRUE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope.zeroinflation_+3A_object">object</code></td>
<td>
<p>an object of the class <em>zeroinflation</em>.</p>
</td></tr>
<tr><td><code id="envelope.zeroinflation_+3A_rep">rep</code></td>
<td>
<p>an (optional) positive integer which allows to specify the number of replicates which should be used to build the simulated envelope. As default, <code>rep</code> is set to 25.</p>
</td></tr>
<tr><td><code id="envelope.zeroinflation_+3A_conf">conf</code></td>
<td>
<p>an (optional) value in the interval <code class="reqn">(0,1)</code> indicating the confidence level which should be used to build the pointwise confidence intervals, which conform the simulated envelope. As default, <code>conf</code> is set to 0.95.</p>
</td></tr>
<tr><td><code id="envelope.zeroinflation_+3A_type">type</code></td>
<td>
<p>an (optional) character string which allows to specify the required type of residuals. The available options are: (1) the difference between the observed response
and the fitted mean (&quot;response&quot;); (2) the standardized difference between the observed response and the fitted mean (&quot;standardized&quot;); (3) the randomized quantile
residual (&quot;quantile&quot;). As default, <code>type</code> is set to &quot;quantile&quot;.</p>
</td></tr>
<tr><td><code id="envelope.zeroinflation_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if the normal QQ-plot with simulated envelope of residuals is required or just the data matrix in which it is based. As default, <code>plot.it</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="envelope.zeroinflation_+3A_identify">identify</code></td>
<td>
<p>an (optional) positive integer value indicating the number of individuals to identify on the QQ-plot with simulated envelope of residuals. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="envelope.zeroinflation_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The simulated envelope is builded by simulating <code>rep</code> independent realizations of the response variable for each
individual, which is accomplished taking into account the following: (1) the model assumption about the distribution of
the response variable; (2) the estimates of the parameters in the linear predictor; and (3) the estimate of the
dispersion parameter. The interest model is re-fitted <code>rep</code> times, as each time the vector of observed responses
is replaced by one of the simulated samples. The <code>type</code>-type residuals are computed and then sorted for each
replicate, so that for each <code class="reqn">i=1,2,...,n</code>, where <code class="reqn">n</code> is the number of individuals in the sample, there is a random
sample of size <code>rep</code> of the <code class="reqn">i</code>-th order statistic of the  <code>type</code>-type residuals. Therefore, the simulated
envelope is composed of the quantiles (1 - <code>conf</code>)/2 and (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of
the <code class="reqn">i</code>-th order statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>.
</p>


<h3>Value</h3>

<p>A matrix with the following four columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Lower limit</code> </td><td style="text-align: left;"> the quantile (1 - <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
                   </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Median</code> </td><td style="text-align: left;"> the quantile 0.5 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Upper limit</code> </td><td style="text-align: left;"> the quantile (1 + <code>conf</code>)/2 of the random sample of size <code>rep</code> of the <code class="reqn">i</code>-th order</td>
</tr>
<tr>
 <td style="text-align: left;">
                   </td><td style="text-align: left;">  statistic of the <code>type</code>-type residuals for <code class="reqn">i=1,2,...,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Residuals</code></td><td style="text-align: left;"> the observed <code>type</code>-type residuals.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Atkinson A.C. (1985) <em>Plots, Transformations and Regression</em>. Oxford University Press, Oxford.
</p>
<p>Dunn P.K., Smyth G.K. (1996) Randomized Quantile Residuals. <em>Journal of Computational and Graphical Statistics</em> 5, 236-244.
</p>


<h3>See Also</h3>

<p><a href="#topic+envelope.lm">envelope.lm</a>, <a href="#topic+envelope.glm">envelope.glm</a>, <a href="#topic+envelope.overglm">envelope.overglm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>####### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit &lt;- zeroinf(infections ~ frequency | location, family="nb1(log)", data=swimmers)
envelope(fit, rep=30, conf=0.95, type="quantile", col="red", pch=20, col.lab="blue",
         col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='estequa'>Function to extract estimating equations</h2><span id='topic+estequa'></span>

<h3>Description</h3>

<p>Extracts estimating equations evaluated at the parameter estimates and the observed data for a fitted model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estequa(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estequa_+3A_object">object</code></td>
<td>
<p>a fitted model object.</p>
</td></tr>
<tr><td><code id="estequa_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the value of the estimating equations evaluated at the parameter estimates and the observed data.
</p>

<hr>
<h2 id='estequa.glm'>Estimating Equations in Generalized Linear Models</h2><span id='topic+estequa.glm'></span>

<h3>Description</h3>

<p>Extracts estimating equations evaluated at the parameter estimates and the observed data for a generalized linear model fitted to the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
estequa(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estequa.glm_+3A_object">object</code></td>
<td>
<p>an object of the class glm which is obtained from the fit of a generalized linear model.</p>
</td></tr>
<tr><td><code id="estequa.glm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the value of the estimating equations evaluated at the parameter estimates and the observed data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1
Auto &lt;- ISLR::Auto
mod &lt;- mpg ~ cylinders + displacement + acceleration + origin + horsepower*weight
fit1 &lt;- glm(mod, family=inverse.gaussian("log"), data=Auto)
estequa(fit1)

## Example 2
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death &lt;- factor(death, levels=c("Dead","Alive")))
mod2 &lt;- death ~ age + gender + race + tbsa + inh_inj + flame + age*inh_inj + tbsa*inh_inj
fit2 &lt;- glm(mod2, family=binomial("logit"), data=burn1000)
estequa(fit2)

## Example 3
data(skincancer)
fit3 &lt;- glm(cases ~ offset(log(population)) + city + age, family=poisson("log"), data=skincancer)
estequa(fit3)
</code></pre>

<hr>
<h2 id='estequa.glmgee'>Estimating Equations in Generalized Estimating Equations</h2><span id='topic+estequa.glmgee'></span>

<h3>Description</h3>

<p>Extracts estimating equations evaluated at the parameter estimates and the observed data for a generalized estimating equation fitted to the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmgee'
estequa(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estequa.glmgee_+3A_object">object</code></td>
<td>
<p>an object of class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="estequa.glmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the value of the estimating equations evaluated at the parameter estimates and the observed data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), corstr="AR-M-dependent", data=spruces)
estequa(fit1)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit2 &lt;- glmgee(mod2, id=subj, family=binomial(logit), corstr="AR-M-dependent", data=depression)
estequa(fit2)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit3 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), corstr="AR-M-dependent", data=depression)
estequa(fit3)

###### Example 4: Dental Clinical Trial
data(rinse)
mod4 &lt;- score/3.6 ~ rinse*time
fit4 &lt;- glmgee(mod4, family=binomial(log), id=subject, corstr="Exchangeable", data=rinse)
estequa(fit4)

###### Example 5: Shoulder Pain after Laparoscopic Cholecystectomy
data(cholecystectomy)
mod5 &lt;- pain2 ~ treatment + age + time
corstr &lt;- "Stationary-M-dependent(2)"
fit5 &lt;- glmgee(mod5, family=binomial(logit), id=id, corstr=corstr, data=cholecystectomy)
estequa(fit5)

###### Example 6: Guidelines for Urinary Incontinence Discussion and Evaluation
data(GUIDE)
mod6 &lt;- bothered ~ gender + age + dayacc + severe + toilet
fit6 &lt;- glmgee(mod6, family=binomial(logit), id=practice, corstr="Exchangeable", data=GUIDE)
estequa(fit6)

###### Example 7: Tests of Auditory Perception in Children with OME
OME &lt;- MASS::OME
mod7 &lt;- cbind(Correct, Trials-Correct) ~ Loud + Age + OME
fit7 &lt;- glmgee(mod7, family = binomial(cloglog), id = ID, corstr = "Exchangeable", data = OME)
estequa(fit7)
</code></pre>

<hr>
<h2 id='estequa.overglm'>Estimating Equations for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</h2><span id='topic+estequa.overglm'></span>

<h3>Description</h3>

<p>Computes the estimating equations evaluated at the parameter estimates and the observed data for
regression models based on the negative binomial, beta-binomial, and random-clumped binomial
distributions, which are alternatives to the Poisson and binomial regression models under the presence of overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'overglm'
estequa(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estequa.overglm_+3A_object">object</code></td>
<td>
<p>an object of the class <em>overglm</em>.</p>
</td></tr>
<tr><td><code id="estequa.overglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the values of the estimating equations evaluated at the parameter estimates and the observed data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Example 1: Ability of retinyl acetate to prevent mammary cancer in rats
data(mammary)
fit1 &lt;- overglm(tumors ~ group, family="nb1(identity)", data=mammary)
estequa(fit1)

### Example 2: Self diagnozed ear infections in swimmers
data(swimmers)
fit2 &lt;- overglm(infections ~ frequency + location, family="nb1(log)", data=swimmers)
estequa(fit2)

### Example 3: Urinary tract infections in HIV-infected men
data(uti)
fit3 &lt;- overglm(episodes ~ cd4 + offset(log(time)), family="nb1(log)", data = uti)
estequa(fit3)

### Example 4: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit4 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)
estequa(fit4)

### Example 5: Agents to stimulate cellular differentiation
data(cellular)
fit5 &lt;- overglm(cbind(cells,200-cells) ~ tnf + ifn, family="bb(logit)", data=cellular)
estequa(fit5)

### Example 6: Teratogenic effects of phenytoin and trichloropropene oxide
data(ossification)
model6 &lt;- cbind(fetuses,litter-fetuses) ~ pht + tcpo
fit6 &lt;- overglm(model6, family="rcb(cloglog)", data=ossification)
estequa(fit6)

### Example 7: Germination of orobanche seeds
data(orobanche)
model7 &lt;- cbind(germinated,seeds-germinated) ~ specie + extract
fit7 &lt;- overglm(model7, family="rcb(cloglog)", data=orobanche)
estequa(fit7)

</code></pre>

<hr>
<h2 id='estequa.zeroinflation'>Estimating Equations in Regression Models to deal with Zero-Excess in Count Data</h2><span id='topic+estequa.zeroinflation'></span>

<h3>Description</h3>

<p>Computes the estimating equations evaluated at the parameter estimates and the observed data for regression models to deal with zero-excess in count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'zeroinflation'
estequa(object, submodel = c("counts", "zeros"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estequa.zeroinflation_+3A_object">object</code></td>
<td>
<p>an object of the class <em>zeroinflation</em>.</p>
</td></tr>
<tr><td><code id="estequa.zeroinflation_+3A_submodel">submodel</code></td>
<td>
<p>an (optional) character string which allows to specify the model: &quot;counts&quot; or &quot;zeros&quot;. By default,
<code>submodel</code> is set to &quot;counts&quot;.</p>
</td></tr>
<tr><td><code id="estequa.zeroinflation_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the values of the estimating equations evaluated at the parameter estimates and the observed data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>####### Example 1: Roots Produced by the Columnar Apple Cultivar Trajan
data(Trajan)
fit1 &lt;- zeroalt(roots ~ photoperiod, family="nbf(log)", zero.link="logit", data=Trajan)
estequa(fit1)

fit1a &lt;- zeroinf(roots ~ photoperiod, family="nbf(log)", zero.link="logit", data=Trajan)
estequa(fit1a)

####### Example 2: Self diagnozed ear infections in swimmers
data(swimmers)
fit2 &lt;- zeroalt(infections ~ frequency | location, family="nb1(log)", data=swimmers)
estequa(fit2)

fit2a &lt;- zeroinf(infections ~ frequency | location, family="nb1(log)", data=swimmers)
estequa(fit2a)

####### Example 3: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit3 &lt;- zeroalt(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)
estequa(fit3)

fit3a &lt;- zeroinf(art ~ fem + kid5 + ment | ment, family="nb1(log)", data = bioChemists)
estequa(fit3a)
</code></pre>

<hr>
<h2 id='fabric'>Fabric faults</h2><span id='topic+fabric'></span>

<h3>Description</h3>

<p>The main objective of the analysis of this dataset is to
assess if there is an association between the number of faults in
fabric rolls and their length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fabric)
</code></pre>


<h3>Format</h3>

<p>A data frame with 32 rows and 2 variables:
</p>

<dl>
<dt>roll</dt><dd><p>a numeric vector indicating the length of the rolls.</p>
</dd>
<dt>faults</dt><dd><p>a numeric vector indicating the number of faults.</p>
</dd>
</dl>



<h3>References</h3>

<p>Hinde J., Demetrio C.G.B. (1998) Over-dispersion: models and estimation. <em>Computational Statistics &amp; Data Analysis</em> 27:151–170.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dev.new()
data(fabric)
with(fabric,plot(roll, faults, pch=16, xlab="Length of roll", ylab="Number of faults"))
</code></pre>

<hr>
<h2 id='FisherScoring'>Fisher Scoring algorithm in Generalized Linear Models</h2><span id='topic+FisherScoring'></span>

<h3>Description</h3>

<p>This function displays the entire path performed by the
Fisher Scoring algorithm for parameter estimation in Generalized Linear
Models. It starts with the starting value until convergence is achieved
or the maximum number of iterations is exceeded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FisherScoring(object, verbose = TRUE, digits = max(3, getOption("digits") - 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FisherScoring_+3A_object">object</code></td>
<td>
<p>one object of the class <em>glm</em>.</p>
</td></tr>
<tr><td><code id="FisherScoring_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="FisherScoring_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix whose first three columns are the following
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Iteration</code> </td><td style="text-align: left;"> the iteration number,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Deviance</code> </td><td style="text-align: left;"> value of the (unscaled) deviance computed using the current value of the parameter vector,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Tolerance</code> </td><td style="text-align: left;"> value of <code class="reqn">|deviance-deviance_{old}|/(deviance_{old} + 0.1)</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Fuel efficiency of cars
Auto &lt;- ISLR::Auto
fit1 &lt;- glm(mpg ~ horsepower + weight + horsepower*weight, family=Gamma(inverse), data=Auto,
            control=list(trace=TRUE))
FisherScoring(fit1)

###### Example 2: Hill races in Scotland
data(races)
fit2 &lt;- glm(rtime ~ log(distance) + cclimb, family=Gamma(log), data=races,
            control=list(trace=TRUE))
FisherScoring(fit2)

###### Example 3:
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death &lt;- factor(death, levels=c("Dead","Alive")))
fit3 &lt;- glm(death ~ age*inh_inj + tbsa*inh_inj, family=binomial("logit"), data=burn1000,
            control=list(trace=TRUE))
FisherScoring(fit3)

###### Example 4: Skin cancer in women
data(skincancer)
fit4 &lt;- glm(cases ~ offset(log(population)) + city + age, family=poisson, data=skincancer,
            control=list(trace=TRUE))
FisherScoring(fit4)

###### Example 5: Agents to stimulate cellular differentiation
data(cellular)
fit5 &lt;- glm(cbind(cells,200-cells) ~ tnf + ifn, family=binomial(logit), data=cellular,
            control=list(trace=TRUE))
FisherScoring(fit5)

###### Example 6: Advertising
data(advertising)
fit6 &lt;- glm(sales ~ log(TV) + radio + log(TV)*radio, family=gaussian(log), data=advertising,
            control=list(trace=TRUE))
FisherScoring(fit6)

</code></pre>

<hr>
<h2 id='GHYC'>Gosho-Hamada-Yoshimura's Criterion for Generalized Estimating Equations</h2><span id='topic+GHYC'></span>

<h3>Description</h3>

<p>Computes the Gosho-Hamada-Yoshimura's criterion (GHYC) for one or more objects of the class glmgee.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GHYC(..., verbose = TRUE, digits = max(3, getOption("digits") - 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GHYC_+3A_...">...</code></td>
<td>
<p>one or several objects of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="GHYC_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="GHYC_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer indicating the number of digits to print. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the values of the GHYC for each <em>glmgee</em> object in the input.
</p>


<h3>References</h3>

<p>Gosho M., Hamada C., Yoshimura I. (2011) Criterion for the Selection
of a Working Correlation Structure in the Generalized Estimating Equation Approach for
Longitudinal Balanced Data. <em>Communications in Statistics — Theory and Methods</em> 40:3839-3856.
</p>
<p>Gosho M. (2014) Criteria to Select a Working Correlation Structure in SAS.
<em>Journal of Statistical Software, Code Snippets</em> 57:1548-7660.#' @references <a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+QIC">QIC</a>, <a href="#topic+CIC">CIC</a>, <a href="#topic+RJC">RJC</a>, <a href="#topic+AGPC">AGPC</a>, <a href="#topic+SGPC">SGPC</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
GHYC(fit1, fit2, fit3, fit4)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit1 &lt;- glmgee(mod2, id=subj, family=binomial(logit), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
GHYC(fit1, fit2, fit3, fit4)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit1 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Exchangeable")
GHYC(fit1, fit2, fit3)

</code></pre>

<hr>
<h2 id='glmgee'>Fit Generalized Estimating Equations</h2><span id='topic+glmgee'></span>

<h3>Description</h3>

<p>Produces an object of the class <code>glmgee</code> in which the main results of a Generalized Estimating Equation (GEE) fitted to the data are stored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glmgee(
  formula,
  family = gaussian(),
  weights,
  id,
  waves,
  data,
  subset,
  corstr,
  corr,
  start = NULL,
  scale.fix = FALSE,
  scale.value = 1,
  toler = 1e-05,
  maxit = 50,
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glmgee_+3A_formula">formula</code></td>
<td>
<p>a <code>formula</code> expression of the form <code>response ~ x1 + x2 + ...</code>, which is a symbolic description of the linear predictor of the model to be fitted to the data.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_family">family</code></td>
<td>
<p>an (optional) <code>family</code> object, that is, a list of functions and expressions for defining link and variance functions. Families (and links) supported are the same supported by <a href="stats.html#topic+glm">glm</a> using its <a href="stats.html#topic+family">family</a> argument, that is,
<code>gaussian</code>, <code>binomial</code>, <code>poisson</code>, <code>Gamma</code>, <code>inverse.gaussian</code>, and <code>quasi</code>. The family <code>negative.binomial</code> in the library <span class="pkg">MASS</span> are also available. As default, the argument <code>family</code> is set to <code>gaussian(identity)</code>.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_weights">weights</code></td>
<td>
<p>an (optional) vector of positive &quot;prior weights&quot; to be used in the fitting process. The length of <code>weights</code> should be the same as the total number of observations.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_id">id</code></td>
<td>
<p>a vector which identifies the subjects or clusters. The length of <code>id</code> should be the same as the number of observations.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_waves">waves</code></td>
<td>
<p>an (optional) positive integer-valued variable that is used to identify the order and spacing of observations within clusters. This argument is crucial when there are missing values and gaps in the data. As default, <code>waves</code> is equal to the integers from 1 to the size of each cluster.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_data">data</code></td>
<td>
<p>an (optional) <code>data frame</code> in which to look for variables involved in the <code>formula</code> expression, as well as for variables specified in the arguments <code>id</code> and <code>weights</code>. The data are assumed to be sorted by <code>id</code> and time.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_subset">subset</code></td>
<td>
<p>an (optional) vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_corstr">corstr</code></td>
<td>
<p>an (optional) character string which allows to specify the working-correlation structure. The available options are: &quot;Independence&quot;, &quot;Unstructured&quot;, &quot;Stationary-M-dependent(<em>m</em>)&quot;, &quot;Non-Stationary-M-dependent(<em>m</em>)&quot;, &quot;AR-M-dependent(<em>m</em>)&quot;, &quot;Exchangeable&quot; and &quot;User-defined&quot;, where <em>m</em> represents the lag of the dependence. As default, <code>corstr</code> is set to &quot;Independence&quot;.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_corr">corr</code></td>
<td>
<p>an (optional) square matrix of the same dimension of the maximum cluster size containing the user specified correlation. This is only appropriate if <code>corstr</code> is specified to be &quot;User-defined&quot;.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_start">start</code></td>
<td>
<p>an (optional) vector of starting values for the parameters in the linear predictor.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_scale.fix">scale.fix</code></td>
<td>
<p>an (optional) logical variable. If TRUE, the scale parameter is fixed at the value of <code>scale.value</code>. As default, <code>scale.fix</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_scale.value">scale.value</code></td>
<td>
<p>an (optional) numeric value at which the scale parameter should be fixed. This is only appropriate if <code>scale.fix=TRUE</code>. As default, <code>scale.value</code> is set to 1.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_toler">toler</code></td>
<td>
<p>an (optional) positive value which represents the <em>convergence tolerance</em>. The convergence is reached when the maximum of the absolute relative differences between the values of the parameters in the linear predictor in consecutive iterations of the fitting algorithm is lower than <code>toler</code>. As default, <code>toler</code> is set to 0.00001.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_maxit">maxit</code></td>
<td>
<p>an (optional) integer value which represents the maximum number of iterations allowed for the fitting algorithm. As default, <code>maxit</code> is set to 50.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical variable. If TRUE, output is produced for each iteration of the estimating algorithm.</p>
</td></tr>
<tr><td><code id="glmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values of the multivariate response variable measured on <code class="reqn">n</code> subjects or clusters,
denoted by <code class="reqn">y_{i}=(y_{i1},\ldots,y_{in_i})^{\top}</code> for <code class="reqn">i=1,\ldots,n</code>, are assumed to be
realizations of independent random vectors denoted by <code class="reqn">Y_{i}=(Y_{i1},\ldots,Y_{in_i})^{\top}</code>
for <code class="reqn">i=1,\ldots,n</code>. The random variables associated to the <code class="reqn">i</code>-th subject or
cluster, <code class="reqn">Y_{ij}</code> for <code class="reqn">j=1,\ldots,n_i</code>, are assumed to satisfy
<code class="reqn">\mu_{ij}=</code> E<code class="reqn">(Y_{ij})</code>,Var<code class="reqn">(Y_{ij})=\frac{\phi}{\omega_{ij}}</code>V<code class="reqn">(\mu_{ij})</code>
and Corr<code class="reqn">(Y_{ij},Y_{ik})=r_{jk}(\rho)</code>,
where <code class="reqn">\phi&gt;0</code> is the dispersion parameter,
V<code class="reqn">(\mu_{ij})</code> is the variance function, <code class="reqn">\omega_{ij}&gt;0</code> is a known weight, and
<code class="reqn">\rho=(\rho_1,\ldots,\rho_q)^{\top}</code> is a parameter vector.
In addition, <code class="reqn">\mu_{ij}</code> is assumed to be dependent on the regressors vector <code class="reqn">x_{ij}</code>
by <code class="reqn">g(\mu_{ij})=z_{ij} + x_{ij}^{\top}\beta</code>, where <code class="reqn">g(\cdot)</code> is the link function,
<code class="reqn">z_{ij}</code> is a known <em>offset</em> and <code class="reqn">\beta=(\beta_1,\ldots,\beta_p)^{\top}</code> is
a vector of regression parameters. The parameter estimates are obtained by iteratively
solving the estimating equations described by Liang and Zeger (1986).
</p>
<p>If the maximum cluster size is 6 and for a cluster of size 4 the value
of <code>waves</code> is set to 2, 4, 5, 6, then it means that the data at
times 1 and 3 are missing, which should be taken into account by
<code>glmgee</code> when the structure of the correlation matrix is assumed
to be &quot;Unstructured&quot;, &quot;Stationary-M-dependent&quot;, &quot;Non-Stationary-M-dependent&quot;
or &quot;AR-M-dependent&quot;. If in this scenario <code>waves</code> is not specified
then <code>glmgee</code> assumes that the available data for this cluster
were taken at times 1, 2, 3 and 4.
</p>
<p>A set of standard extractor functions for fitted model objects is
available for objects of class <em>glmgee</em>, including methods to generic functions such as  <code>print</code>, <code>summary</code>,	<code>model.matrix</code>, <code>estequa</code>,
<code>coef</code>, <code>vcov</code>, <code>logLik</code>, <code>fitted</code>, <code>confint</code> and <code>predict</code>.
In addition, the model may be assessed using functions such as <a href="#topic+anova.glmgee">anova.glmgee</a>,
<a href="#topic+residuals.glmgee">residuals.glmgee</a>, <a href="#topic+dfbeta.glmgee">dfbeta.glmgee</a>, <a href="#topic+cooks.distance.glmgee">cooks.distance.glmgee</a> and <a href="#topic+localInfluence.glmgee">localInfluence.glmgee</a>.
The variable selection may be accomplished using the routine
<a href="#topic+stepCriterion.glmgee">stepCriterion.glmgee</a>.
</p>


<h3>Value</h3>

<p>an object of class <em>glmgee</em> in which the main results of the GEE model fitted to the data are stored, i.e., a
list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>coefficients</code> </td><td style="text-align: left;"> a vector with the estimates of <code class="reqn">\beta_1,\ldots,\beta_p</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>fitted.values</code></td><td style="text-align: left;"> a vector with the estimates of <code class="reqn">\mu_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>start</code>        </td><td style="text-align: left;"> a vector with the starting values used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>iter</code>         </td><td style="text-align: left;"> a numeric constant with the number of iterations,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>prior.weights</code></td><td style="text-align: left;"> a vector with the values of <code class="reqn">\omega_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>offset</code>       </td><td style="text-align: left;"> a vector with the values of <code class="reqn">z_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>terms</code>        </td><td style="text-align: left;"> an object containing the terms objects,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>loglik</code>       </td><td style="text-align: left;"> the value of the quasi-log-likelihood function evaluated at the parameter</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> estimates and the observed data,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>estfun</code>       </td><td style="text-align: left;"> a vector with the estimating equations evaluated at the parameter</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> estimates and the observed data,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>formula</code>      </td><td style="text-align: left;"> the formula,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>levels</code>       </td><td style="text-align: left;"> the levels of the categorical regressors,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>contrasts</code>    </td><td style="text-align: left;"> an object containing the contrasts corresponding to levels,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>converged</code>    </td><td style="text-align: left;"> a logical indicating successful convergence,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>model</code>        </td><td style="text-align: left;"> the full model frame,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code>            </td><td style="text-align: left;"> a vector with the values of <code class="reqn">y_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>family</code>       </td><td style="text-align: left;"> an object containing the <a href="stats.html#topic+family">family</a> object used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>linear.predictors</code> </td><td style="text-align: left;"> a vector with the estimates of <code class="reqn">g(\mu_{ij})</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R</code>            </td><td style="text-align: left;"> a matrix with the (robust) estimate of the variance-covariance,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>corr</code>         </td><td style="text-align: left;"> a matrix with the estimate of the working-correlation,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>corstr</code>       </td><td style="text-align: left;"> a character string specifying the working-correlation structure,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>id</code>           </td><td style="text-align: left;"> a vector which identifies the subjects or clusters,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sizes</code>        </td><td style="text-align: left;"> a vector with the values of <code class="reqn">n_i</code> for <code class="reqn">i=1,\ldots,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>call</code>         </td><td style="text-align: left;"> the original function call,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Liang K.Y., Zeger S.L. (1986) Longitudinal data analysis using generalized linear models.
<em>Biometrika</em> 73:13-22.
</p>
<p>Zeger S.L., Liang K.Y. (1986) Longitudinal data analysis for discrete and continuous outcomes.
<em>Biometrics</em> 42:121-130.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+gnmgee">gnmgee</a>, <a href="#topic+wglmgee">wglmgee</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), corstr="AR-M-dependent(1)", data=spruces)
summary(fit1, corr.digits=2)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit2 &lt;- glmgee(mod2, id=subj, family=binomial(logit), corstr="AR-M-dependent(1)", data=depression)
summary(fit2, corr.digits=2)

###### Example 3: Treatment for severe postnatal depression (2)
data(depression)
mod3 &lt;- dep ~ visit*group
fit3 &lt;- glmgee(mod3, id=subj, family=gaussian, corstr="AR-M-dependent(1)", data=depression)
summary(fit3, corr.digits=2)

###### Example 4: Dental Clinical Trial
data(rinse)
mod4 &lt;- score/3.6 ~ rinse*time
fit4 &lt;- glmgee(mod4, family=binomial(log), id=subject, corstr="Exchangeable", data=rinse)
summary(fit4, corr.digits=2)

###### Example 5: Shoulder Pain after Laparoscopic Cholecystectomy
data(cholecystectomy)
mod5 &lt;- pain2 ~ treatment + age + time
corstr &lt;- "Stationary-M-dependent(2)"
fit5 &lt;- glmgee(mod5, family=binomial(logit), id=id, corstr=corstr, data=cholecystectomy)
summary(fit5,varest="bias-corrected")

###### Example 6: Guidelines for Urinary Incontinence Discussion and Evaluation
data(GUIDE)
mod6 &lt;- bothered ~ gender + age + dayacc + severe + toilet
fit6 &lt;- glmgee(mod6, family=binomial(logit), id=practice, corstr="Exchangeable", data=GUIDE)
summary(fit6)

###### Example 7: Tests of Auditory Perception in Children with OME
OME &lt;- MASS::OME
mod7 &lt;- cbind(Correct, Trials-Correct) ~ Loud + Age + OME
fit7 &lt;- glmgee(mod7, family = binomial(cloglog), id = ID, corstr = "Exchangeable", data = OME)
summary(fit7, corr=FALSE)

###### Example 8: Epileptic seizures
data(Seizures)
Seizures2 &lt;- within(Seizures, time4 &lt;- ifelse(time==4,1,0))
mod8 &lt;- seizures ~ log(age) + time4 + log(base/4)*treatment
fit8 &lt;- glmgee(mod8, family=poisson(log), id=id, corstr="Exchangeable", data=Seizures2)
summary(fit8)

</code></pre>

<hr>
<h2 id='gnm'>Generalized Nonlinear Models.</h2><span id='topic+gnm'></span>

<h3>Description</h3>

<p><code>gnm</code> is used to fit generalized nonlinear models, specified by giving a symbolic description of the &quot;linear&quot; predictor
and a description of the error distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gnm(
  formula,
  family = gaussian(),
  offset = NULL,
  weights = NULL,
  data,
  subset = NULL,
  start = NULL,
  toler = 1e-05,
  maxit = 50,
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gnm_+3A_formula">formula</code></td>
<td>
<p>a <code>formula</code> expression which is a symbolic description of the &quot;linear&quot; predictor of the model to be fitted to the data.</p>
</td></tr>
<tr><td><code id="gnm_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model. For <code>gnm</code> this can be a character string naming a family function,
a family function or the result of a call to a family function. As default, <code>family</code> is set to <code>gaussian(identity)</code>.</p>
</td></tr>
<tr><td><code id="gnm_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known component to be included in the linear predictor during fitting. This should be <code>NULL</code> or a numeric vector of length equal to the number of cases.</p>
</td></tr>
<tr><td><code id="gnm_+3A_weights">weights</code></td>
<td>
<p>an (optional) vector of &quot;prior weights&quot; to be used in the fitting process. The length of <code>weights</code> should be the same as the number of observations.</p>
</td></tr>
<tr><td><code id="gnm_+3A_data">data</code></td>
<td>
<p>an (optional) data frame, list or environment (or object coercible by <a href="base.html#topic+as.data.frame">as.data.frame</a> to a data frame) containing the variables in the model.
If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>gnm</code> is called.</p>
</td></tr>
<tr><td><code id="gnm_+3A_subset">subset</code></td>
<td>
<p>an (optional) vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="gnm_+3A_start">start</code></td>
<td>
<p>an (optional) vector of starting values for the parameters in the &quot;linear&quot; predictor.</p>
</td></tr>
<tr><td><code id="gnm_+3A_toler">toler</code></td>
<td>
<p>an (optional) positive value which represents the <em>convergence tolerance</em>. The convergence is reached when the maximum of the absolute relative
differences between the values of the parameters in the &quot;linear&quot; predictor in consecutive iterations of the fitting algorithm is lower than <code>toler</code>. As
default, <code>toler</code> is set to 0.00001.</p>
</td></tr>
<tr><td><code id="gnm_+3A_maxit">maxit</code></td>
<td>
<p>an (optional) integer value which represents the maximum number of iterations allowed for the fitting algorithm. As default, <code>maxit</code> is set to 50.</p>
</td></tr>
<tr><td><code id="gnm_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical variable. If <code>TRUE</code>, output is produced for each iteration of the estimating algorithm.</p>
</td></tr>
<tr><td><code id="gnm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A set of standard extractor functions for fitted model objects is available for objects of class <em>gnm</em>,
including methods to the generic functions such as <code>summary</code>, <code>model.matrix</code>, <code>estequa</code>,
<code>coef</code>, <code>vcov</code>, <code>logLik</code>, <code>fitted</code>, <code>confint</code>, <code>AIC</code>, <code>BIC</code> and <code>predict</code>.
In addition, the model fitted to the	data may be assessed using functions such as <code>adjR2.gnm</code>, <a href="#topic+anova.gnm">anova.gnm</a>,
<a href="#topic+residuals.gnm">residuals.gnm</a>, <a href="#topic+dfbeta.gnm">dfbeta.gnm</a>, <a href="#topic+cooks.distance.gnm">cooks.distance.gnm</a>, <a href="#topic+localInfluence.gnm">localInfluence.gnm</a> and <a href="#topic+envelope.gnm">envelope.gnm</a>.
</p>


<h3>Value</h3>

<p>an object of class <em>gnm</em> in which the main results of the model fitted to the data are stored, i.e., a
list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>coefficients</code> </td><td style="text-align: left;"> a vector containing the parameter estimates,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>fitted.values</code></td><td style="text-align: left;"> a vector containing the estimates of <code class="reqn">\mu_1,\ldots,\mu_n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>start</code>        </td><td style="text-align: left;"> a vector containing the starting values used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>prior.weights</code></td><td style="text-align: left;"> a vector containing the case weights used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>offset</code>       </td><td style="text-align: left;"> a vector containing the offset used, </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>terms</code>        </td><td style="text-align: left;"> an object containing the terms objects,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>loglik</code>       </td><td style="text-align: left;"> the value of the log-likelihood function avaliated at the parameter estimates,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>estfun</code>       </td><td style="text-align: left;"> a vector containing the estimating functions evaluated at the parameter estimates</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> and the observed data,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>formula</code>      </td><td style="text-align: left;"> the formula,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>converged</code>    </td><td style="text-align: left;"> a logical indicating successful convergence,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>model</code>        </td><td style="text-align: left;"> the full model frame,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code>            </td><td style="text-align: left;"> the response vector,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>family</code>       </td><td style="text-align: left;"> an object containing the <a href="stats.html#topic+family">family</a> object used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>linear.predictors</code> </td><td style="text-align: left;"> a vector containing the estimates of <code class="reqn">g(\mu_1),\ldots,g(\mu_n)</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R</code>            </td><td style="text-align: left;"> a matrix with unscaled estimate of the variance-covariance</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> matrix of model parameters,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>call</code>         </td><td style="text-align: left;"> the original function call.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p><a href="stats.html#topic+glm">glm</a>, <a href="#topic+glmgee">glmgee</a>, <a href="#topic+gnmgee">gnmgee</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)
summary(fit1)

###### Example 2: Assay of an Insecticide with a Synergist
data(Melanopus)
fit2 &lt;- gnm(Killed/Exposed ~ b0 + b1*log(Insecticide-a1) + b2*Synergist/(a2 + Synergist),
            family=binomial(logit), weights=Exposed, start=c(b0=-3,b1=1.2,a1=1.7,b2=1.7,a2=2),
		   data=Melanopus)
summary(fit2)

###### Example 3: Developmental rate of Drosophila melanogaster
data(Drosophila)
fit3 &lt;- gnm(Duration ~ b0 + b1*Temp + b2/(Temp-a), family=Gamma(log),
            start=c(b0=3,b1=-0.25,b2=-210,a=55), weights=Size, data=Drosophila)
summary(fit3)

###### Example 4: Radioimmunological Assay of Cortisol
data(Cortisol)
fit4 &lt;- gnm(Y ~ b0 + (b1-b0)/(1 + exp(b2+ b3*lDose))^b4, family=Gamma(identity),
            start=c(b0=130,b1=2800,b2=3,b3=3,b4=0.5), data=Cortisol)
summary(fit4)

###### Example 5: Age and Eye Lens Weight of Rabbits in Australia
data(rabbits)
fit5 &lt;- gnm(wlens ~ b1 - b2/(age + b3), family=Gamma(log),
            start=c(b1=5.5,b2=130,b3=35), data=rabbits)
summary(fit5)

###### Example 6: Calls to a technical support help line
data(calls)
fit6 &lt;- gnm(calls ~ SSlogis(week, Asym, xmid, scal), family=poisson(identity), data=calls)
summary(fit6)

</code></pre>

<hr>
<h2 id='gnmgee'>Fit Nonlinear Generalized Estimating Equations</h2><span id='topic+gnmgee'></span>

<h3>Description</h3>

<p>Produces an object of the class <code>glmgee</code> in which the main results of a Nonlinear Generalized Estimating Equation (GEE) fitted to the data are stored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gnmgee(
  formula,
  family = gaussian(),
  offset = NULL,
  weights = NULL,
  id,
  waves,
  data,
  subset = NULL,
  corstr,
  corr,
  start = NULL,
  scale.fix = FALSE,
  scale.value = 1,
  toler = 1e-05,
  maxit = 50,
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gnmgee_+3A_formula">formula</code></td>
<td>
<p>a nonlinear model <code>formula</code> including variables and parameters, which is a symbolic description of the nonlinear predictor of the model to be fitted to the data.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_family">family</code></td>
<td>
<p>an (optional) <code>family</code> object, that is, a list of functions and expressions for defining link and variance functions. Families (and links) supported are the same supported by <a href="stats.html#topic+glm">glm</a> using its <a href="stats.html#topic+family">family</a> argument, that is,
<code>gaussian</code>, <code>binomial</code>, <code>poisson</code>, <code>Gamma</code>, <code>inverse.gaussian</code>, and <code>quasi</code>. The family <code>negative.binomial</code> in the library <span class="pkg">MASS</span> are also available. As default, the argument <code>family</code> is set to <code>gaussian(identity)</code>.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_offset">offset</code></td>
<td>
<p>an (optional) numeric vector of length equal to the number of cases, which can be used to specify an a priori known component to be included in the linear predictor during fitting.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_weights">weights</code></td>
<td>
<p>an (optional) vector of positive &quot;prior weights&quot; to be used in the fitting process. The length of <code>weights</code> should be the same as the total number of observations.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_id">id</code></td>
<td>
<p>a vector which identifies the subjects or clusters. The length of <code>id</code> should be the same as the number of observations.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_waves">waves</code></td>
<td>
<p>an (optional) positive integer-valued variable that is used to identify the order and spacing of observations within clusters. This argument is crucial when there are missing values and gaps in the data. As default, <code>waves</code> is equal to the integers from 1 to the size of each cluster.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_data">data</code></td>
<td>
<p>an (optional) <code>data frame</code> in which to look for variables involved in the <code>formula</code> expression, as well as for variables specified in the arguments <code>id</code> and <code>weights</code>. The data are assumed to be sorted by <code>id</code> and time.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_subset">subset</code></td>
<td>
<p>an (optional) vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_corstr">corstr</code></td>
<td>
<p>an (optional) character string which allows to specify the working-correlation structure. The available options are: &quot;Independence&quot;, &quot;Unstructured&quot;, &quot;Stationary-M-dependent(<em>m</em>)&quot;, &quot;Non-Stationary-M-dependent(<em>m</em>)&quot;, &quot;AR-M-dependent(<em>m</em>)&quot;, &quot;Exchangeable&quot; and &quot;User-defined&quot;, where <em>m</em> represents the lag of the dependence. As default, <code>corstr</code> is set to &quot;Independence&quot;.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_corr">corr</code></td>
<td>
<p>an (optional) square matrix of the same dimension of the maximum cluster size containing the user specified correlation. This is only appropriate if <code>corstr</code> is specified to be &quot;User-defined&quot;.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_start">start</code></td>
<td>
<p>an (optional) vector of starting values for the parameters in the nonlinear predictor. When <code>start</code> is
missing (and <code>formula</code> is not a self-starting model, see <a href="stats.html#topic+nls">nls</a> and <a href="stats.html#topic+selfStart">selfStart</a>), a very cheap guess for <code>start</code> is tried.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_scale.fix">scale.fix</code></td>
<td>
<p>an (optional) logical variable. If TRUE, the scale parameter is fixed at the value of <code>scale.value</code>. As default, <code>scale.fix</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_scale.value">scale.value</code></td>
<td>
<p>an (optional) numeric value at which the scale parameter should be fixed. This is only appropriate if <code>scale.fix=TRUE</code>. As default, <code>scale.value</code> is set to 1.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_toler">toler</code></td>
<td>
<p>an (optional) positive value which represents the <em>convergence tolerance</em>. The convergence is reached when the maximum of the absolute relative differences between the values of the parameters in the nonlinear predictor in consecutive iterations of the fitting algorithm is lower than <code>toler</code>. As default, <code>toler</code> is set to 0.00001.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_maxit">maxit</code></td>
<td>
<p>an (optional) integer value which represents the maximum number of iterations allowed for the fitting algorithm. As default, <code>maxit</code> is set to 50.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical variable. If TRUE, output is produced for each iteration of the estimating algorithm.</p>
</td></tr>
<tr><td><code id="gnmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values of the multivariate response variable measured on <code class="reqn">n</code> subjects or clusters,
denoted by <code class="reqn">y_{i}=(y_{i1},\ldots,y_{in_i})^{\top}</code> for <code class="reqn">i=1,\ldots,n</code>, are assumed to be
realizations of independent random vectors denoted by <code class="reqn">Y_{i}=(Y_{i1},\ldots,Y_{in_i})^{\top}</code>
for <code class="reqn">i=1,\ldots,n</code>. The random variables associated to the <code class="reqn">i</code>-th subject or
cluster, <code class="reqn">Y_{ij}</code> for <code class="reqn">j=1,\ldots,n_i</code>, are assumed to satisfy
<code class="reqn">\mu_{ij}=</code> E<code class="reqn">(Y_{ij})</code>,Var<code class="reqn">(Y_{ij})=\frac{\phi}{\omega_{ij}}</code>V<code class="reqn">(\mu_{ij})</code>
and Corr<code class="reqn">(Y_{ij},Y_{ik})=r_{jk}(\rho)</code>,
where <code class="reqn">\phi&gt;0</code> is the dispersion parameter,
V<code class="reqn">(\mu_{ij})</code> is the variance function, <code class="reqn">\omega_{ij}&gt;0</code> is a known weight, and
<code class="reqn">\rho=(\rho_1,\ldots,\rho_q)^{\top}</code> is a parameter vector.
In addition, <code class="reqn">\mu_{ij}</code> is assumed to be dependent on the regressors vector <code class="reqn">x_{ij}</code>
by <code class="reqn">g(\mu_{ij})=z_{ij} + m(x_{ij},\beta)</code>, where <code class="reqn">g(\cdot)</code> is the link function,
<code class="reqn">z_{ij}</code> is a known <em>offset</em>, <code class="reqn">\beta=(\beta_1,\ldots,\beta_p)^{\top}</code> is
a vector of regression parameters and <code class="reqn">m(x_{ij},\beta)</code> is a known nonlinear function of <code class="reqn">\beta</code>.
The parameter estimates are obtained by iteratively
solving the estimating equations described by Liang and Zeger (1986).
</p>
<p>If the maximum cluster size is 6 and for a cluster of size 4 the value
of <code>waves</code> is set to 2, 4, 5, 6, then it means that the data at
times 1 and 3 are missing, which should be taken into account by
<code>gnmgee</code> when the structure of the correlation matrix is assumed
to be &quot;Unstructured&quot;, &quot;Stationary-M-dependent&quot;, &quot;Non-Stationary-M-dependent&quot;
or &quot;AR-M-dependent&quot;. If in this scenario <code>waves</code> is not specified
then <code>gnmgee</code> assumes that the available data for this cluster
were taken at times 1, 2, 3 and 4.
</p>
<p>A set of standard extractor functions for fitted model objects is
available for objects of class <em>glmgee</em>, including methods to generic functions such as   <code>print</code>, <code>summary</code>,	<code>model.matrix</code>, <code>estequa</code>,
<code>coef</code>, <code>vcov</code>, <code>logLik</code>, <code>fitted</code>, <code>confint</code> and <code>predict</code>.
In addition, the model may be assessed using functions such as <a href="#topic+anova.glmgee">anova.glmgee</a>,
<a href="#topic+residuals.glmgee">residuals.glmgee</a>, <a href="#topic+dfbeta.glmgee">dfbeta.glmgee</a> and <a href="#topic+cooks.distance.glmgee">cooks.distance.glmgee</a>.
</p>


<h3>Value</h3>

<p>an object of class <em>glmgee</em> in which the main results of the GEE model fitted to the data are stored, i.e., a
list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>coefficients</code> </td><td style="text-align: left;"> a vector with the estimates of <code class="reqn">\beta_1,\ldots,\beta_p</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>fitted.values</code></td><td style="text-align: left;"> a vector with the estimates of <code class="reqn">\mu_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>start</code>        </td><td style="text-align: left;"> a vector with the starting values used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>iter</code>         </td><td style="text-align: left;"> a numeric constant with the number of iterations,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>prior.weights</code></td><td style="text-align: left;"> a vector with the values of <code class="reqn">\omega_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>offset</code>       </td><td style="text-align: left;"> a vector with the values of <code class="reqn">z_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>terms</code>        </td><td style="text-align: left;"> an object containing the terms objects,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>loglik</code>       </td><td style="text-align: left;"> the value of the quasi-log-likelihood function evaluated at the parameter</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> estimates and the observed data,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>estfun</code>       </td><td style="text-align: left;"> a vector with the estimating equations evaluated at the parameter</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> estimates and the observed data,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>formula</code>      </td><td style="text-align: left;"> the formula,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>levels</code>       </td><td style="text-align: left;"> the levels of the categorical regressors,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>contrasts</code>    </td><td style="text-align: left;"> an object containing the contrasts corresponding to levels,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>converged</code>    </td><td style="text-align: left;"> a logical indicating successful convergence,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>model</code>        </td><td style="text-align: left;"> the full model frame,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code>            </td><td style="text-align: left;"> a vector with the values of <code class="reqn">y_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>family</code>       </td><td style="text-align: left;"> an object containing the <a href="stats.html#topic+family">family</a> object used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>linear.predictors</code> </td><td style="text-align: left;"> a vector with the estimates of <code class="reqn">g(\mu_{ij})</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R</code>            </td><td style="text-align: left;"> a matrix with the (robust) estimate of the variance-covariance,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>corr</code>         </td><td style="text-align: left;"> a matrix with the estimate of the working-correlation,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>corstr</code>       </td><td style="text-align: left;"> a character string specifying the working-correlation structure,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>id</code>           </td><td style="text-align: left;"> a vector which identifies the subjects or clusters,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sizes</code>        </td><td style="text-align: left;"> a vector with the values of <code class="reqn">n_i</code> for <code class="reqn">i=1,\ldots,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>call</code>         </td><td style="text-align: left;"> the original function call,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Liang K.Y., Zeger S.L. (1986) Longitudinal data analysis using generalized linear models.
<em>Biometrika</em> 73:13-22.
</p>
<p>Zeger S.L., Liang K.Y. (1986) Longitudinal data analysis for discrete and continuous outcomes.
<em>Biometrics</em> 42:121-130.
</p>
<p>Hardin J.W., Hilbe J.M. (2013) <em>Generalized Estimating Equations</em>. Chapman &amp; Hall, London.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+glmgee">glmgee</a>, <a href="#topic+wglmgee">wglmgee</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example : Orange trees grown at Riverside, California
data(Oranges)
mod &lt;- Trunk ~ b1/(1 + exp((b2-Days)/b3))
start &lt;- c(b1=200,b2=760,b3=375)
fit1 &lt;- gnmgee(mod, start=start, id=Tree, family=Gamma(identity), corstr="Exchangeable",
               data=Oranges)
summary(fit1, corr.digits=2)

mod &lt;- Trunk ~ SSlogis(Days,b1,b2,b3)
fit2 &lt;- gnmgee(mod, id=Tree, family=Gamma(identity), corstr="Exchangeable", data=Oranges)
summary(fit2, corr.digits=2)

</code></pre>

<hr>
<h2 id='Grass'>The effects of fertilizers on coastal Bermuda grass</h2><span id='topic+Grass'></span>

<h3>Description</h3>

<p>These data arose from a <code class="reqn">4^3</code> factorial experiment with the three major plant nutrients, nitrogen (N), phosphorus (P), and potassium (K), on the
yield of coastal Bermuda grass. The experiment was performed to produce a response surface for the effects of the three nutrients, so that an optimal
dressing could be predicted. The grass was cut about every five weeks and oven-dried.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Grass)
</code></pre>


<h3>Format</h3>

<p>A data frame with 64 rows and 4 variables:
</p>

<dl>
<dt>Nitrogen</dt><dd><p>a numeric vector indicating the Nitrogen level, in lb/acre.</p>
</dd>
<dt>Phosphorus</dt><dd><p>a numeric vector indicating the Phosphorus level, in lb/acre.</p>
</dd>
<dt>Potassium</dt><dd><p>a numeric vector indicating the Potassium level, in lb/acre.</p>
</dd>
<dt>Yield</dt><dd><p>a numeric vector indicating the yields, in tons/acre.</p>
</dd>
</dl>



<h3>References</h3>

<p>Welch L.F., Adams W.E., Carmon J.L. (1963) Yield Response Surfaces, Isoquants, and Economic Fertilizer Optima for Coastal Bermuda grass.
<em>Agronomy Journal</em>, 55, 63-67.
</p>
<p>McCullagh P., Nelder J.A. (1989). <em>Generalized Linear Models. 2nd Edition</em>. Chapman and Hall, London.
</p>
<p>Wei B.C. (1998). <em>Exponential Family Nonlinear Models</em>. Springer, Singapore.
</p>

<hr>
<h2 id='GUIDE'>Guidelines for Urinary Incontinence Discussion and Evaluation</h2><span id='topic+GUIDE'></span>

<h3>Description</h3>

<p>These data arose from a randomized controlled trial that
assessed if provider adherence to a set of guidelines for treatment of
patients with urinary incontinence (UI) affected patient outcomes. Data
were collected on 137 elderly patients from 38 medical practices. The
number of patients per practice ranged from 1 to 8 and the median was
4 patients. The statistical analysis aims to determine what predicts
whether or not a patient considers their UI a problem that interferes
with him/her daily life.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GUIDE)
</code></pre>


<h3>Format</h3>

<p>A data frame with 137 rows and 7 variables:
</p>

<dl>
<dt>bothered</dt><dd><p>a numeric vector giving the answer to the following: Do you consider this accidental loss of urine a problem that interferes with your day to day activities or bothers you in other ways? 1 for &quot;Yes&quot; and 0 for &quot;No&quot;.</p>
</dd>
<dt>gender</dt><dd><p>a factor giving the patient's gender: &quot;Male&quot; or &quot;Female&quot;.</p>
</dd>
<dt>age</dt><dd><p>a numeric vector giving the standardized age: (age in years - 76)/10.</p>
</dd>
<dt>dayacc</dt><dd><p>a numeric vector giving the patient's report of the number of leaking accidents they experience in an average day (derived from number of accidents reported per week).</p>
</dd>
<dt>severe</dt><dd><p>a factor giving the severity of the loss of urine: &quot;1&quot; if there is only some moisture; &quot;2&quot; if the patient wet the underwear; &quot;3&quot; if the urine trickled down the thigh; and &quot;4&quot; if the patient wet the floor.</p>
</dd>
<dt>toilet</dt><dd><p>a numeric vector giving the patient's report on the number of times during the day he (or she) usually go to the toilet to urinate.</p>
</dd>
<dt>practice</dt><dd><p>a character string giving the identifier of the medical practice.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://www.bios.unc.edu/~preisser/personal/uidata/preqaq99.dat">http://www.bios.unc.edu/~preisser/personal/uidata/preqaq99.dat</a>
</p>


<h3>References</h3>

<p>Hammill B.G., Preisser J.S. (2006) A SAS/IML software program for GEE and regression diagnostics. <em>Computational Statistics &amp; Data Analysis</em> 51:1197-1212.
</p>
<p>Jung K.-M. (2008) Local Influence in Generalized Estimating Equations. <em>Scandinavian Journal of Statistics</em> 35:286-294.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GUIDE)
mod &lt;- bothered ~ gender + age + dayacc + severe + toilet
fit &lt;- glmgee(mod, family=binomial(logit), id=practice, corstr="Exchangeable", data=GUIDE)
summary(fit)
</code></pre>

<hr>
<h2 id='gvif'>Generalized Variance Inflation Factor</h2><span id='topic+gvif'></span>

<h3>Description</h3>

<p>Computes the generalized variance inflation factor (GVIF) for a fitted model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gvif(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gvif_+3A_model">model</code></td>
<td>
<p>a fitted model object.</p>
</td></tr>
<tr><td><code id="gvif_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with the values of the GVIF for all effects in the model.
</p>

<hr>
<h2 id='gvif.glm'>Generalized Variance Inflation Factor</h2><span id='topic+gvif.glm'></span>

<h3>Description</h3>

<p>Computes the generalized variance inflation factor (GVIF) for a generalized linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
gvif(model, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gvif.glm_+3A_model">model</code></td>
<td>
<p>an object of the class <em>glm</em>.</p>
</td></tr>
<tr><td><code id="gvif.glm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="gvif.glm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number of degrees of freedom is 1 then the GVIF reduces to the Variance
Inflation Factor (VIF).
</p>


<h3>Value</h3>

<p>A matrix with so many rows as effects in the model and the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>GVIF</code> </td><td style="text-align: left;"> the values of GVIF,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>df</code></td><td style="text-align: left;"> the number of degrees of freedom,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>GVIF^(1/(2*df))</code></td><td style="text-align: left;"> the values of GVIF<code class="reqn">^{1/2 df}</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Fox J., Monette G. (1992) Generalized collinearity diagnostics, <em>JASA</em> 87, 178–183.
</p>


<h3>See Also</h3>

<p><a href="#topic+gvif.lm">gvif.lm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Fuel consumption of automobiles
Auto &lt;- ISLR::Auto
Auto2 &lt;- within(Auto, origin &lt;- factor(origin))
mod &lt;- mpg ~ cylinders + displacement + acceleration + origin + horsepower*weight
fit1 &lt;- glm(mod, family=inverse.gaussian("log"), data=Auto2)
gvif(fit1)

###### Example 2: Patients with burn injuries
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death &lt;- factor(death, levels=c("Dead","Alive")))
mod2 &lt;- death ~ gender + race + flame + age*inh_inj + tbsa*inh_inj
fit2 &lt;- glm(mod2, family=binomial("logit"), data=burn1000)
gvif(fit2)

###### Example 3: Hill races in Scotland
data(races)
fit3 &lt;- glm(rtime ~ log(distance) + cclimb, family=Gamma(log), data=races)
gvif(fit3)

</code></pre>

<hr>
<h2 id='gvif.lm'>Generalized Variance Inflation Factor</h2><span id='topic+gvif.lm'></span>

<h3>Description</h3>

<p>Computes the generalized variance inflation factor (GVIF) for a weighted or unweighted normal linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
gvif(model, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gvif.lm_+3A_model">model</code></td>
<td>
<p>an object of the class <em>lm</em>.</p>
</td></tr>
<tr><td><code id="gvif.lm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="gvif.lm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number of degrees of freedom is 1 then the GVIF reduces to the Variance
Inflation Factor (VIF).
</p>


<h3>Value</h3>

<p>A matrix with so many rows as effects in the model and the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>GVIF</code>            </td><td style="text-align: left;"> the values of GVIF,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>df</code>              </td><td style="text-align: left;"> the number of degrees of freedom,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>GVIF^(1/(2*df))</code> </td><td style="text-align: left;"> the values of GVIF<code class="reqn">^{1/2 df}</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Fox J., Monette G. (1992) Generalized collinearity diagnostics, <em>JASA</em> 87, 178–183.
</p>


<h3>See Also</h3>

<p><a href="#topic+gvif.glm">gvif.glm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: New York air quality measurements
fit1 &lt;- lm(log(Ozone) ~ Solar.R + Temp + Wind, data=airquality)
gvif(fit1)

###### Example 2: Fuel consumption of automobiles
fit2 &lt;- lm(mpg ~ log(hp) + log(wt) + qsec, data=mtcars)
gvif(fit2)

###### Example 3: Credit card balance
Credit &lt;- ISLR::Credit
fit3 &lt;- lm(Balance ~ Cards + Age + Rating + Income + Student + Limit, data=Credit)
gvif(fit3)
</code></pre>

<hr>
<h2 id='gvif.overglm'>Generalized Variance Inflation Factor for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion</h2><span id='topic+gvif.overglm'></span>

<h3>Description</h3>

<p>Computes the generalized variance inflation factor (GVIF) for regression models based on the negative binomial, beta-binomial, and
random-clumped binomial distributions, which are alternatives to the Poisson and binomial regression models under the presence of overdispersion.
The GVIF is aimed to identify collinearity problems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'overglm'
gvif(model, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gvif.overglm_+3A_model">model</code></td>
<td>
<p>an object of class <em>overglm</em>.</p>
</td></tr>
<tr><td><code id="gvif.overglm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="gvif.overglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number of degrees of freedom is 1 then the GVIF reduces to the Variance
Inflation Factor (VIF).
</p>


<h3>Value</h3>

<p>A matrix with so many rows as effects in the model and the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>GVIF</code> </td><td style="text-align: left;"> the values of GVIF,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>df</code></td><td style="text-align: left;"> the number of degrees of freedom,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>GVIF^(1/(2*df))</code></td><td style="text-align: left;"> the values of GVIF<code class="reqn">^{1/2 df}</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Fox J., Monette G. (1992) Generalized collinearity diagnostics, <em>JASA</em> 87, 178–183.
</p>


<h3>See Also</h3>

<p><a href="#topic+gvif.lm">gvif.lm</a>, <a href="#topic+gvif.glm">gvif.glm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- overglm(infections ~ frequency + location, family="nb1(log)", data=swimmers)
gvif(fit1)

###### Example 2: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit2 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)
gvif(fit2)

###### Example 3: Agents to stimulate cellular differentiation
data(cellular)
fit3 &lt;- overglm(cbind(cells,200-cells) ~ tnf + ifn, family="bb(logit)", data=cellular)
gvif(fit3)

</code></pre>

<hr>
<h2 id='hltest'>The Hosmer-Lemeshow Goodness-of-Fit Test</h2><span id='topic+hltest'></span>

<h3>Description</h3>

<p>Computes the Hosmer-Lemeshow goodness-of-fit test for a generalized linear model fitted to binary responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hltest(model, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hltest_+3A_model">model</code></td>
<td>
<p>an object of the class <em>glm</em>, which is obtained from the fit of a generalized linear model where the distribution for the response variable is assumed to be binomial.</p>
</td></tr>
<tr><td><code id="hltest_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="hltest_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the following four columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>hm</code> </td><td style="text-align: left;"> a matrix with the values of Group, Size, Observed and Expected, which are required to compute the statistic of the test,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>statistic</code> </td><td style="text-align: left;"> the value of the statistic of the test,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>df</code> </td><td style="text-align: left;"> the number of degrees of freedom, given by the number of groups minus 2,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p.value</code> </td><td style="text-align: left;"> the <em>p</em>-value of the test computed using the Chi-square distribution,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Hosmer D.W., Lemeshow S. (2000) <em>Applied Logistic Regression. 2nd ed.</em> John Wiley &amp; Sons, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###### Example 1: Patients with burn injuries
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death &lt;- factor(death, levels=c("Dead","Alive")))
fit1 &lt;- glm(death ~ age*inh_inj + tbsa*inh_inj, family=binomial("logit"), data=burn1000)
hltest(fit1)

###### Example 2: Bladder cancer in mice
data(bladder)
fit2 &lt;-  glm(cancer/exposed ~ dose, weights=exposed, family=binomial("cloglog"), data=bladder)
hltest(fit2)

###### Example 3: Liver cancer in mice
data(liver)
fit3 &lt;-  glm(cancer/exposed ~ dose, weights=exposed, family=binomial("probit"), data=liver)
hltest(fit3)

</code></pre>

<hr>
<h2 id='ldh'>ldh</h2><span id='topic+ldh'></span>

<h3>Description</h3>

<p>The data consists of the proportion of lactic dehydrogenase
enzyme leakage obtained as a response of hepatocyte cell toxicity to the
effects of different combinations of carbon tetrachloride (CCl4) and
chloroform (CHCl3). Thus, the main objective of the data analysis is to
evaluate the effects of CCl4, CHCl3 and their interactions on the
response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ldh)
</code></pre>


<h3>Format</h3>

<p>A data frame with 448 rows and 5 variables:
</p>

<dl>
<dt>LDH</dt><dd><p>a numeric vector indicating the proportion of lactic dehydrogenase enzyme leakage, a surrogate for cell toxicity.</p>
</dd>
<dt>CCl4</dt><dd><p>a numeric vector indicating the carbon tetrachloride at 0, 1, 2.5 and 5 mM.</p>
</dd>
<dt>CHCl3</dt><dd><p>a numeric vector indicating the chloroform at 0, 5, 10 and 25 mM.</p>
</dd>
<dt>Flask</dt><dd><p>a numeric vector indicating the flask of isolated hepatocyte suspensions.</p>
</dd>
<dt>Time</dt><dd><p>a numeric vector indicating the time at 0, 0.01, 0.25, 0.50, 1, 2 and 3 hours.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Gennings, C., Chinchilli, V.M., Carter, W.H. (1989). Response
Surface Analysis with Correlated Data: A Nonlinear Model Approach.
<em>Journal of the American Statistical Association</em>, 84, 805–809.
</p>


<h3>References</h3>

<p>Vonesh E.F. (2012) Generalized Linear and Nonlinear Models
for Correlated Data: Theory and Applications Using SAS.
<em>Cary, NC: SAS Institute Inc</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ldh)
opt &lt;- unique(ldh$CCl4)
dev.new()
par(mfrow=c(1,length(opt)))
for(i in 1:length(opt))
boxplot(LDH ~ Time, data=subset(ldh,CCl4==opt[i]), ylim=c(0,0.8), main=paste("CCl4=",opt[i]))

dev.new()
opt &lt;- unique(ldh$CHCl3)
par(mfrow=c(1,length(opt)))
for(i in 1:length(opt))
boxplot(LDH ~ Time, data=subset(ldh,CHCl3==opt[i]), ylim=c(0,0.8), main=paste("CHCl3=",opt[i]))

</code></pre>

<hr>
<h2 id='leverage'>Leverage</h2><span id='topic+leverage'></span>

<h3>Description</h3>

<p>Computes leverage measures for a fitted model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leverage(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leverage_+3A_object">object</code></td>
<td>
<p>a fitted model object.</p>
</td></tr>
<tr><td><code id="leverage_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with the values of the leverage measures.
</p>

<hr>
<h2 id='leverage.glmgee'>Leverage for Generalized Estimating Equations</h2><span id='topic+leverage.glmgee'></span>

<h3>Description</h3>

<p>Computes and, optionally, displays a graph of the leverage measures at the cluster- and observation-level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmgee'
leverage(
  object,
  level = c("clusters", "observations"),
  plot.it = FALSE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leverage.glmgee_+3A_object">object</code></td>
<td>
<p>an object of class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="leverage.glmgee_+3A_level">level</code></td>
<td>
<p>an (optional) character string indicating the level for which the leverage measures are required. The options are: cluster-level (&quot;clusters&quot;) and observation-level (&quot;observations&quot;). As default, <code>level</code> is set to &quot;clusters&quot;.</p>
</td></tr>
<tr><td><code id="leverage.glmgee_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical indicating if the plot of the measures of leverage are required or just the data matrix in which that plot is based. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="leverage.glmgee_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of (<code>level=``clusters''</code>) or observations (<code>level=``observations''</code>) to identify on the plot of the leverage measures. This is only appropriate if <code>plot.it</code> is specified to be <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="leverage.glmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it</code> is specified to be <code>TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example,  <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the values of the leverage measures with so many rows as clusters (<code>level=``clusters''</code>) or observations (<code>level=``observations''</code>) in the sample.
</p>


<h3>References</h3>

<p>Preisser J.S., Qaqish B.F. (1996). Deletion diagnostics for generalised estimating equations. <em>Biometrika</em>, 83:551-562.
</p>
<p>Hammill B.G., Preisser J.S. (2006). A SAS/IML software program for GEE and regression diagnostics. <em>Computational Statistics &amp; Data Analysis</em>, 51:1197-1212.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###### Example 1: Tests of Auditory Perception in Children with OME
OME &lt;- MASS::OME
mod &lt;- cbind(Correct, Trials-Correct) ~ Loud + Age + OME
fit1 &lt;- glmgee(mod, family = binomial(cloglog), id = ID, corstr = "Exchangeable", data = OME)
leverage(fit1,level="clusters",plot.it=TRUE)

###### Example 2: Guidelines for Urinary Incontinence Discussion and Evaluation
data(GUIDE)
mod &lt;- bothered ~ gender + age + dayacc + severe + toilet
fit2 &lt;- glmgee(mod, family=binomial(logit), id=practice, corstr="Exchangeable", data=GUIDE)
leverage(fit2,level="clusters",plot.it=TRUE)
leverage(fit2,level="observations",plot.it=TRUE)

</code></pre>

<hr>
<h2 id='liver'>Liver cancer in mice</h2><span id='topic+liver'></span>

<h3>Description</h3>

<p>Female mice were continuously fed dietary concentrations
of 2-Acetylaminofluorene (2-AAF), a carcinogenic and mutagenic
derivative of fluorene. Serially sacrificed, dead or moribund mice
were examined for tumors and deaths dates recorded. These data consist
of the incidences of liver neoplasms in mice observed during 18 months.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(liver)
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 3 variables:
</p>

<dl>
<dt>dose</dt><dd><p>a numeric vector giving the dose, in parts per <code class="reqn">10^4</code>, of 2-AAF.</p>
</dd>
<dt>exposed</dt><dd><p>a numeric vector giving the number of mice exposed to each dose of 2-AAF.</p>
</dd>
<dt>cancer</dt><dd><p>a numeric vector giving the number of mice with liver cancer for each dose of 2-AAF.</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhang H., Zelterman D. (1999) Binary Regression for Risks in Excess of Subject-Specific Thresholds. <em>Biometrics</em> 55:1247-1251.
</p>


<h3>See Also</h3>

<p><a href="#topic+bladder">bladder</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(liver)
dev.new()
barplot(100*cancer/exposed ~ dose, beside=TRUE, data=liver, col="red",
        xlab="Dose of 2-AAF", ylab="% of mice with liver cancer")
</code></pre>

<hr>
<h2 id='localInfluence'>Local Influence</h2><span id='topic+localInfluence'></span>

<h3>Description</h3>

<p>Computes measures of local influence for a fitted model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>localInfluence(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="localInfluence_+3A_object">object</code></td>
<td>
<p>a fitted model object.</p>
</td></tr>
<tr><td><code id="localInfluence_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with the measures of local influence.
</p>

<hr>
<h2 id='localInfluence.glm'>Local Influence for Generalized Linear Models</h2><span id='topic+localInfluence.glm'></span>

<h3>Description</h3>

<p>Computes some measures and, optionally, display	graphs of them to perform
influence analysis based on the approaches described by Cook (1986).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
localInfluence(
  object,
  type = c("total", "local"),
  perturbation = c("case-weight", "response", "covariate"),
  covariate,
  coefs,
  plot.it = FALSE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="localInfluence.glm_+3A_object">object</code></td>
<td>
<p>an object of class <em>glm</em>.</p>
</td></tr>
<tr><td><code id="localInfluence.glm_+3A_type">type</code></td>
<td>
<p>an (optional) character string indicating the type of approach to study the
local influence. The options are: the absolute value of the elements of the eigenvector which corresponds to the maximum absolute eigenvalue (&quot;local&quot;); and the absolute value of the elements of the main diagonal (&quot;total&quot;). As default, <code>type</code> is set to &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="localInfluence.glm_+3A_perturbation">perturbation</code></td>
<td>
<p>an (optional) character string indicating the perturbation scheme
to apply. The options are: case weight perturbation of observations (&quot;case-weight&quot;); perturbation of covariates (&quot;covariate&quot;); and perturbation of response (&quot;response&quot;). As default, <code>perturbation</code> is set to &quot;case-weight&quot;.</p>
</td></tr>
<tr><td><code id="localInfluence.glm_+3A_covariate">covariate</code></td>
<td>
<p>an character string which (partially) match with the names of one of
the parameters in the linear predictor. This is only appropriate if <code>perturbation="covariate"</code>.</p>
</td></tr>
<tr><td><code id="localInfluence.glm_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of
some of the parameters in the linear predictor.</p>
</td></tr>
<tr><td><code id="localInfluence.glm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical indicating if the plot of the measures of local
influence is required or just the data matrix in which that plot is based. By default,
<code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="localInfluence.glm_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of observations to identify
on the plot of the measures of local influence. This is only appropriate if
<code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="localInfluence.glm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code>
then <code>...</code> may be used to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix as many rows as observations in the sample and one column with the values of the measures of local influence.
</p>


<h3>References</h3>

<p>Cook D. (1986) Assessment of Local Influence. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 48, 133-155.
</p>
<p>Thomas W., Cook D. (1989) Assessing Influence on Regression Coefficients in Generalized Linear Models. <em>Biometrika</em> 76, 741-749.
</p>

<hr>
<h2 id='localInfluence.glmgee'>Local Influence for Generalized Estimating Equations</h2><span id='topic+localInfluence.glmgee'></span>

<h3>Description</h3>

<p>Computes some measures and, optionally, display	graphs of them to perform influence analysis based on the approaches described in Cook (1986) and Jung (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmgee'
localInfluence(
  object,
  type = c("total", "local"),
  perturbation = c("cw-clusters", "cw-observations", "response"),
  coefs,
  plot.it = FALSE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="localInfluence.glmgee_+3A_object">object</code></td>
<td>
<p>an object of class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="localInfluence.glmgee_+3A_type">type</code></td>
<td>
<p>an (optional) character string indicating the type of approach to study the local influence. The options are: the absolute value of the elements of the eigenvector which corresponds to the maximum absolute eigenvalue (&quot;local&quot;); and the elements of the main diagonal (&quot;total&quot;). As default, <code>type</code> is set to &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="localInfluence.glmgee_+3A_perturbation">perturbation</code></td>
<td>
<p>an (optional) character string indicating the perturbation scheme to apply. The options are: case weight perturbation of clusters (&quot;cw-clusters&quot;); Case weight perturbation of observations (&quot;cw-observations&quot;); and perturbation of response (&quot;response&quot;). As default, <code>perturbation</code> is set to &quot;cw-clusters&quot;.</p>
</td></tr>
<tr><td><code id="localInfluence.glmgee_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of some of the parameters in the linear predictor.</p>
</td></tr>
<tr><td><code id="localInfluence.glmgee_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical indicating if the plot of the measures of local influence is required or just the data matrix in which that plot is based. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="localInfluence.glmgee_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of clusters/observations to identify on the plot of the measures of local influence. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="localInfluence.glmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix as many rows as clusters/observations in the sample and one column with the values of the measures of local influence.
</p>


<h3>References</h3>

<p>Cook D. (1986) Assessment of Local Influence. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 48:133-155.
</p>
<p>Jung K.-M. (2008) Local Influence in Generalized Estimating Equations. <em>Scandinavian Journal of Statistics</em> 35:286-294.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), corstr="AR-M-dependent", data=spruces)
localInfluence(fit1,type="total",perturbation="cw-clusters",coefs="treat",plot.it=TRUE)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit2 &lt;- glmgee(mod2, id=subj, family=binomial(logit), corstr="AR-M-dependent", data=depression)
localInfluence(fit2,type="total",perturbation="cw-clusters",coefs="group",plot.it=TRUE)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit3 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), corstr="AR-M-dependent", data=depression)
localInfluence(fit3,type="total",perturbation="cw-clusters",coefs="visit:group",plot.it=TRUE)

</code></pre>

<hr>
<h2 id='localInfluence.gnm'>Local Influence for Generalized Nonlinear Models</h2><span id='topic+localInfluence.gnm'></span>

<h3>Description</h3>

<p>Computes some measures and, optionally, display	graphs of them to perform
influence analysis based on the approaches described by Cook (1986).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnm'
localInfluence(
  object,
  type = c("total", "local"),
  perturbation = c("case-weight", "response"),
  coefs,
  plot.it = FALSE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="localInfluence.gnm_+3A_object">object</code></td>
<td>
<p>an object of class <em>gnm</em>.</p>
</td></tr>
<tr><td><code id="localInfluence.gnm_+3A_type">type</code></td>
<td>
<p>an (optional) character string indicating the type of approach to study the
local influence. The options are: the absolute value of the elements of the eigenvector which corresponds to the maximum absolute eigenvalue (&quot;local&quot;); and the absolute value of the elements of the main diagonal (&quot;total&quot;). As default, <code>type</code> is set to &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="localInfluence.gnm_+3A_perturbation">perturbation</code></td>
<td>
<p>an (optional) character string indicating the perturbation scheme
to apply. The options are: case weight perturbation of observations (&quot;case-weight&quot;) and perturbation of response (&quot;response&quot;). As default, <code>perturbation</code> is set to &quot;case-weight&quot;.</p>
</td></tr>
<tr><td><code id="localInfluence.gnm_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of
some of the parameters in the 'linear' predictor.</p>
</td></tr>
<tr><td><code id="localInfluence.gnm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical indicating if the plot of the measures of local
influence is required or just the data matrix in which that plot is based. As default,
<code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="localInfluence.gnm_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of observations to identify
on the plot of the measures of local influence. This is only appropriate if
<code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="localInfluence.gnm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code>
then <code>...</code> may be used to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix as many rows as observations in the sample and one column with the values of the measures of local influence.
</p>


<h3>References</h3>

<p>Cook D. (1986) Assessment of Local Influence. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 48, 133-155.
</p>
<p>Thomas W., Cook D. (1989) Assessing Influence on Regression Coefficients in Generalized Linear Models. <em>Biometrika</em> 76, 741-749.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)

localInfluence(fit1, type="local", perturbation="case-weight", plot.it=TRUE, col="red",
               lty=1, lwd=1, col.lab="blue", col.axis="blue", col.main="black", family="mono")

###### Example 2: Assay of an Insecticide with a Synergist
data(Melanopus)
fit2 &lt;- gnm(Killed/Exposed ~ b0 + b1*log(Insecticide-a1) + b2*Synergist/(a2 + Synergist),
            family=binomial(logit), weights=Exposed, start=c(b0=-3,b1=1.2,a1=1.7,b2=1.7,a2=2),
		   data=Melanopus)

### Local Influence just for the parameter "b1"
localInfluence(fit2, type="local", perturbation="case-weight", plot.it=TRUE, coefs="b1", col="red",
               lty=1, lwd=1, col.lab="blue", col.axis="blue", col.main="black", family="mono")

###### Example 3: Developmental rate of Drosophila melanogaster
data(Drosophila)
fit3 &lt;- gnm(Duration ~ b0 + b1*Temp + b2/(Temp-a), family=Gamma(log),
            start=c(b0=3,b1=-0.25,b2=-210,a=55), weights=Size, data=Drosophila)

localInfluence(fit3, type="total", perturbation="case-weight", plot.it=TRUE, col="red",
               lty=1, lwd=1, col.lab="blue", col.axis="blue", col.main="black", family="mono")

###### Example 4: Radioimmunological Assay of Cortisol
data(Cortisol)
fit4 &lt;- gnm(Y ~ b0 + (b1-b0)/(1 + exp(b2+ b3*lDose))^b4, family=Gamma(identity),
            start=c(b0=130,b1=2800,b2=3,b3=3,b4=0.5), data=Cortisol)

localInfluence(fit4, type="total", perturbation="case-weight", plot.it=TRUE, col="red",
               lty=1, lwd=1, col.lab="blue", col.axis="blue", col.main="black", family="mono")

</code></pre>

<hr>
<h2 id='localInfluence.overglm'>Local Influence for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion</h2><span id='topic+localInfluence.overglm'></span>

<h3>Description</h3>

<p>Computes local influence measures under the case-weight perturbation scheme for alternatives to the Poisson and
Binomial Regression Models under the presence of Overdispersion. Those local influence measures
may be chosen to correspond to all parameters in the linear predictor or (via <code>coefs</code>) for just some subset of them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'overglm'
localInfluence(
  object,
  type = c("total", "local"),
  coefs,
  plot.it = FALSE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="localInfluence.overglm_+3A_object">object</code></td>
<td>
<p>an object of class <em>overglm</em>.</p>
</td></tr>
<tr><td><code id="localInfluence.overglm_+3A_type">type</code></td>
<td>
<p>an (optional) character string which allows to specify the local influence approach:
the absolute value of the elements of the main diagonal of the normal curvature matrix (&quot;total&quot;) or
the eigenvector which corresponds to the maximum absolute eigenvalue of the normal curvature matrix (&quot;local&quot;).
As default, <code>type</code> is set to &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="localInfluence.overglm_+3A_coefs">coefs</code></td>
<td>
<p>an (optional) character string which (partially) match with the names of some model parameters.</p>
</td></tr>
<tr><td><code id="localInfluence.overglm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical indicating if the plot is required or just the data matrix in which that plot is based. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="localInfluence.overglm_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer indicating the number of individuals to identify on the plot. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="localInfluence.overglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used
to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>,
<code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix as many rows as individuals in the sample and one column with the values of the local influence measure.
</p>


<h3>References</h3>

<p>Cook R.D. (1986) Assessment of Local Influence. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 48, 133-155.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- overglm(infections ~ frequency + location, family="nb1(log)", data=swimmers)

### Local influence for all parameters in the linear predictor
localInfluence(fit1, type="local", plot.it=TRUE, col="red", lty=1, lwd=1, col.lab="blue",
               col.axis="blue", col.main="black", family="mono", cex=0.8)

### Local influence for the parameter associated with 'frequency'
localInfluence(fit1, type="local", plot.it=TRUE, col="red", lty=1, lwd=1, col.lab="blue",
               coef="frequency", col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit2 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)

### Local influence for all parameters in the linear predictor
localInfluence(fit2, type="local", plot.it=TRUE, col="red", lty=1, lwd=1, col.lab="blue",
               col.axis="blue", col.main="black", family="mono", cex=0.8)

### Local influence for the parameter associated with 'fem'
localInfluence(fit2, type="local", plot.it=TRUE, col="red", lty=1, lwd=1, col.lab="blue",
               coef="fem", col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 3: Agents to stimulate cellular differentiation
data(cellular)
fit3 &lt;- overglm(cbind(cells,200-cells) ~ tnf + ifn, family="bb(logit)", data=cellular)

### Local influence for all parameters in the linear predictor
localInfluence(fit3, type="local", plot.it=TRUE, col="red", lty=1, lwd=1, col.lab="blue",
               col.axis="blue", col.main="black", family="mono", cex=0.8)

### Local influence for the parameter associated with 'tnf'
localInfluence(fit3, type="local", plot.it=TRUE, col="red", lty=1, lwd=1, col.lab="blue",
               coef="tnf", col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='mammary'>Ability of retinyl acetate to prevent mammary cancer in rats</h2><span id='topic+mammary'></span>

<h3>Description</h3>

<p>A total of 76 female rats were injected with a carcinogen
for mammary cancer. Then, all animals were given retinyl acetate
(retinoid) to prevent mammary cancer for 60 days. After this phase,
the 48 animals that remained tumor-free were randomly assigned to
continue retinoid prophylaxis or control. Rats were then palpated for
tumors twice weekly, and observations ended 182 days after initial
carcinogen injections began. The main objective of the analysis was
to assess the difference in tumor development between the treated
and control groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mammary)
</code></pre>


<h3>Format</h3>

<p>A data frame with 48 rows and 2 variables:
</p>

<dl>
<dt>group</dt><dd><p>a factor giving the group to which the rat was assigned: &quot;retinoid&quot; or &quot;control&quot;.</p>
</dd>
<dt>tumors</dt><dd><p>a numeric vector giving the number of tumors identified on the rat.</p>
</dd>
</dl>



<h3>References</h3>

<p>Lawless J.F. (1987) Regression Methods for Poisson Process Data. <em>Journal of the American
Statistical Association</em> 82:808-815.
</p>
<p>Morel J.G., Nagaraj N.K. (2012) <em>Overdispersion Models in SAS</em>. SAS Institute Inc., Cary, North Carolina, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mammary)
dev.new()
boxplot(tumors ~ group, data=mammary, outline=FALSE, xlab="Group",
        ylab="Number of tumors", col=c("yellow","blue"))
</code></pre>

<hr>
<h2 id='Melanopus'>Assay of an Insecticide with a Synergist</h2><span id='topic+Melanopus'></span>

<h3>Description</h3>

<p>These data are concerned with the estimation of the lowest-cost mixtures of insecticides and synergists. They
relate to assays on a grasshopper <em>Melanopus sanguinipes</em> with carbofuran and piperonyl butoxide, which enhances
carbofuran's toxicity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Melanopus)
</code></pre>


<h3>Format</h3>

<p>A data frame with 15 rows and 4 variables:
</p>

<dl>
<dt>Killed</dt><dd><p>a numeric vector indicating how many grasshoppers were killed.</p>
</dd>
<dt>Exposed</dt><dd><p>a numeric vector indicating how many grasshoppers were exposed.</p>
</dd>
<dt>Insecticide</dt><dd><p>a numeric vector indicating the dose of insecticide.</p>
</dd>
<dt>Synergist</dt><dd><p>a numeric vector indicating the dose of synergist.</p>
</dd>
</dl>



<h3>References</h3>

<p>McCullagh P., Nelder J.A. (1989). <em>Generalized Linear Models. 2nd Edition</em>. Chapman and Hall, London.
</p>
<p>Wei B.C. (1998). <em>Exponential Family Nonlinear Models</em>. Springer, Singapore.
</p>

<hr>
<h2 id='Oranges'>Oranges</h2><span id='topic+Oranges'></span>

<h3>Description</h3>

<p>The data arose from five orange trees grown in Riverside,
California, during 1969-1973. The response is the trunk circumference,
in millimeters, and the predictor variable is time, in days. The
predictor variable has an arbitrary origin and was taken on December
31, 1968.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Oranges)
</code></pre>


<h3>Format</h3>

<p>A data frame with 35 rows and 3 variables:
</p>

<dl>
<dt>Trunk</dt><dd><p>a numeric vector indicating the trunk circumference, in millimeters.</p>
</dd>
<dt>Days</dt><dd><p>a numeric vector indicating the time, in days, since December 31, 1968.</p>
</dd>
<dt>Tree</dt><dd><p>a numeric vector with the identifier of each orange tree.</p>
</dd>
</dl>



<h3>References</h3>

<p>Draper N., Smith H. (1998) Applied Regression Analysis, Third Edition. <em>John Wiley &amp; Sons</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dev.new()
data(Oranges)
with(Oranges,plot(Days, Trunk, pch=16, col="blue"))
</code></pre>

<hr>
<h2 id='orobanche'>Germination of Orobanche Seeds</h2><span id='topic+orobanche'></span>

<h3>Description</h3>

<p>These data arose from a study of the germination of two
species of Orobanche seeds (O. aegyptiaca 75 and O. aegyptiaca 73)
grown on 1/125 dilutions of two different root extract media (cucumber
and bean) in a 2×2 factorial layout with replicates. The data consist
of the number of seeds and germinating seeds for each replicate.
Interest is focused on the possible differences in germination rates
for the two types of seed and root extract and whether there is any
interaction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(orobanche)
</code></pre>


<h3>Format</h3>

<p>A data frame with 21 rows and 4 variables:
</p>

<dl>
<dt>specie</dt><dd><p>a factor indicating the specie of Orobanche seed: O. aegyptiaca 75 (&quot;Aegyptiaca 75&quot;) and O. aegyptiaca 73 (&quot;Aegyptiaca 73&quot;).</p>
</dd>
<dt>extract</dt><dd><p>a factor indicating the root extract: cucumber (&quot;Cucumber&quot;) and bean (&quot;Bean&quot;).</p>
</dd>
<dt>seeds</dt><dd><p>a numeric vector indicating the total number of seeds.</p>
</dd>
<dt>germinated</dt><dd><p>a numeric vector indicating the number of germinated seeds.</p>
</dd>
</dl>



<h3>References</h3>

<p>Crowder M.J. (1978) Beta-binomial anova for proportions. <em>Journal of the Royal Statistical Society.
Series C (Applied Statistics)</em> 27:34-37.
</p>
<p>Hinde J., Demetrio C.G.B. (1998) Overdispersion: Models and estimation. <em>Computational Statistics
&amp; Data Analysis</em> 27:151-170.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(orobanche)
out &lt;- aggregate(cbind(germinated,seeds) ~ extract + specie, data=orobanche, sum)
dev.new()
barplot(100*germinated/seeds ~ extract + specie, beside=TRUE, data=out, width=0.3,
        col=c("yellow","blue"), xlab="Specie", ylab="% of germinated seeds")
legend("topleft",c("Bean","Cucumber"),fill=c("yellow","blue"),title="Extract",bty="n")

</code></pre>

<hr>
<h2 id='ossification'>Teratogenic effects of phenytoin and trichloropropene oxide</h2><span id='topic+ossification'></span>

<h3>Description</h3>

<p>The data come from a 2x2 factorial design with 81 pregnant
mice. In the experiment each pregnant mouse was randomly allocated to a
control group and three treated groups. These groups received daily, by
gastric gavage, 60 mg/kg of phenytoin, 100 mg/kg of trichloropropene
oxide, or 60 mg/kg of phenytoin and 100 mg/kg of trichloropropene oxide. On day 18 of gestation, the fetuses were recovered, stained, and cleared. Then, by visual inspection, the presence or absence of ossification was determined for the different joints of the right and left forepaws. The experiment investigated the synergy of phenytoin and trichloropropene oxide to produce ossification at the phalanges, teratogenic effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ossification)
</code></pre>


<h3>Format</h3>

<p>A data frame with 81 rows and 4 variables:
</p>

<dl>
<dt>fetuses</dt><dd><p>a numeric vector giving the number of fetuses showing ossification on the left middle third phalanx.</p>
</dd>
<dt>litter</dt><dd><p>a numeric vector giving the litter size.</p>
</dd>
<dt>pht</dt><dd><p>a factor giving the dose (mg/kg) of phenytoin: &quot;0 mg/kg&quot; or &quot;60 mg/kg&quot;.</p>
</dd>
<dt>tcpo</dt><dd><p>a factor giving the dose (mg/kg) of trichloropropene oxide: &quot;0 mg/kg&quot; or &quot;100 mg/kg&quot;.</p>
</dd>
</dl>



<h3>References</h3>

<p>Morel J.G., Neerchal N.K. (1997) Clustered binary logistic regression in teratology data
using a finite mixture distribution. <em>Statistics in Medicine</em> 16:2843-2853.
</p>
<p>Morel J.G., Nagaraj N.K. (2012) <em>Overdispersion Models in SAS</em>. SAS Institute Inc., Cary, North Carolina, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ossification)
dev.new()
boxplot(100*fetuses/litter ~ pht, data=subset(ossification,tcpo=="0 mg/kg"),
        at=c(1:2) - 0.2, col="yellow", boxwex=0.25, xaxt="n",
        xlab="Dose of PHT", ylab="% of fetuses showing ossification")
boxplot(100*fetuses/litter ~ pht, data=subset(ossification,tcpo=="100 mg/kg"),
        add=TRUE, at=c(1:2) + 0.2, col="blue", boxwex=0.25, xaxt="n")
axis(1, at=c(1:2), labels=levels(ossification$pht))
legend("bottomleft", legend=c("0 mg/kg","100 mg/kg"), fill=c("yellow","blue"),
       title="Dose of TCPO", bty="n", cex=0.9)
</code></pre>

<hr>
<h2 id='overglm'>Alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</h2><span id='topic+overglm'></span>

<h3>Description</h3>

<p>Allows to fit regression models based on the negative binomial, beta-binomial, and random-clumped binomial.
distributions, which are alternatives to the Poisson and binomial regression models under the presence of overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>overglm(
  formula,
  offset,
  family = "nb1(log)",
  weights,
  data,
  subset,
  na.action = na.omit(),
  reltol = 1e-13,
  start = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="overglm_+3A_formula">formula</code></td>
<td>
<p>a <code>formula</code> expression of the form <code>response ~ x1 + x2 + ...</code>, which is a symbolic description
of the linear predictor of the model to be fitted to the data.</p>
</td></tr>
<tr><td><code id="overglm_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known component to be included in the linear predictor during fitting. This should be <code>NULL</code> or a numeric vector of length equal to the number of cases.</p>
</td></tr>
<tr><td><code id="overglm_+3A_family">family</code></td>
<td>
<p>A character string that allows you to specify the
distribution describing the response variable. In addition,
it allows you to specify the link function to be used in the
model for <code class="reqn">\mu</code>. The following distributions are
supported: negative binomial I (&quot;nb1&quot;), negative binomial II
(&quot;nb2&quot;), negative binomial (&quot;nbf&quot;), zero-truncated negative
binomial I (&quot;ztnb1&quot;), zero-truncated negative binomial II
(&quot;ztnb2&quot;), zero-truncated negative binomial (&quot;ztnbf&quot;),
zero-truncated poisson (&quot;ztpoi&quot;), beta-binomial (&quot;bb&quot;) and
random-clumped binomial (&quot;rcb&quot;). Link functions available for
these models are the same as those available for Poisson and
binomial models via <a href="stats.html#topic+glm">glm</a>. See <a href="stats.html#topic+family">family</a> documentation.</p>
</td></tr>
<tr><td><code id="overglm_+3A_weights">weights</code></td>
<td>
<p>an (optional) vector of positive &quot;prior weights&quot; to be used in the fitting process. The length of
<code>weights</code> should be the same as the number of observations.</p>
</td></tr>
<tr><td><code id="overglm_+3A_data">data</code></td>
<td>
<p>an (optional) <code>data frame</code> in which to look for variables involved in the <code>formula</code> expression,
as well as for variables specified in the arguments <code>weights</code> and <code>subset</code>.</p>
</td></tr>
<tr><td><code id="overglm_+3A_subset">subset</code></td>
<td>
<p>an (optional) vector specifying a subset of individuals to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="overglm_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. By default <code>na.action</code>
is set to <code>na.omit()</code>.</p>
</td></tr>
<tr><td><code id="overglm_+3A_reltol">reltol</code></td>
<td>
<p>an (optional) positive value which represents the <em>relative convergence tolerance</em> for the BFGS method in <a href="stats.html#topic+optim">optim</a>.
As default, <code>reltol</code> is set to 1e-13.</p>
</td></tr>
<tr><td><code id="overglm_+3A_start">start</code></td>
<td>
<p>an (optional) vector of starting values for the parameters in the linear predictor.</p>
</td></tr>
<tr><td><code id="overglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The negative binomial distribution can be obtained as mixture of the Poisson and Gamma distributions. If
<code class="reqn">Y | \lambda</code> ~ Poisson<code class="reqn">(\lambda)</code>, where E<code class="reqn">(Y | \lambda)=</code> Var<code class="reqn">(Y | \lambda)=\lambda</code>, and
<code class="reqn">\lambda</code> ~ Gamma<code class="reqn">(\theta,\nu)</code>, in which E<code class="reqn">(\lambda)=\theta</code> and Var<code class="reqn">(\lambda)=\nu\theta^2</code>, then
<code class="reqn">Y</code> is distributed according to the negative binomial distribution. As follows, some special cases are described:
</p>
<p>(1) If <code class="reqn">\theta=\mu</code> and <code class="reqn">\nu=\phi</code> then <code class="reqn">Y</code> ~ Negative Binomial I,
E<code class="reqn">(Y)=\mu</code> and Var<code class="reqn">(Y)=\mu(1 + \phi\mu)</code>.
</p>
<p>(2) If <code class="reqn">\theta=\mu</code> and <code class="reqn">\nu=\phi/\mu</code> then <code class="reqn">Y</code> ~ Negative Binomial II,
E<code class="reqn">(Y)=\mu</code> and Var<code class="reqn">(Y)=\mu(1 +\phi)</code>.
</p>
<p>(3) If <code class="reqn">\theta=\mu</code> and <code class="reqn">\nu=\phi\mu^\tau</code> then <code class="reqn">Y</code> ~ Negative Binomial,
E<code class="reqn">(Y)=\mu</code> and Var<code class="reqn">(Y)=\mu(1 +\phi\mu^{\tau+1})</code>.
</p>
<p>Therefore, the regression models based on the negative binomial and
zero-truncated negative binomial distributions are alternatives,
under overdispersion, to those based on the Poisson and
zero-truncated Poisson distributions, respectively.
</p>
<p>The beta-binomial distribution can be obtained as a mixture of the binomial and beta distributions. If
<code class="reqn">mY | \pi</code> ~ Binomial<code class="reqn">(m,\pi)</code>, where E<code class="reqn">(Y | \pi)=\pi</code> and Var<code class="reqn">(Y | \pi)=m^{-1}\pi(1-\pi)</code>,
and <code class="reqn">\pi</code> ~ Beta<code class="reqn">(\mu,\phi)</code>, in which E<code class="reqn">(\pi)=\mu</code> and Var<code class="reqn">(\pi)=(\phi+1)^{-1}\mu(1-\mu)</code>,
with <code class="reqn">\phi&gt;0</code>, then <code class="reqn">mY</code> ~ Beta-Binomial<code class="reqn">(m,\mu,\phi)</code>, so that E<code class="reqn">(Y)=\mu</code> and
Var<code class="reqn">(Y)=m^{-1}\mu(1-\mu)[1 + (\phi+1)^{-1}(m-1)]</code>. Therefore, the regression model based on the
beta-binomial distribution is an alternative, under overdispersion, to the binomial regression model.
</p>
<p>The random-clumped binomial distribution can be obtained as a mixture of the binomial and Bernoulli distributions. If
<code class="reqn">mY | \pi</code> ~ Binomial<code class="reqn">(m,\pi)</code>, where E<code class="reqn">(Y | \pi)=\pi</code> and Var<code class="reqn">(Y | \pi)=m^{-1}\pi(1-\pi)</code>,
whereas <code class="reqn">\pi=(1-\phi)\mu + \phi</code> with probability <code class="reqn">\mu</code>, and <code class="reqn">\pi=(1-\phi)\mu</code> with probability <code class="reqn">1-\mu</code>,
in which E<code class="reqn">(\pi)=\mu</code> and Var<code class="reqn">(\pi)=\phi^{2}\mu(1-\mu)</code>, with <code class="reqn">\phi \in (0,1)</code>, then <code class="reqn">mY</code> ~ Random-clumped
Binomial<code class="reqn">(m,\mu,\phi)</code>, so that E<code class="reqn">(Y)=\mu</code> and Var<code class="reqn">(Y)=m^{-1}\mu(1-\mu)[1 + \phi^{2}(m-1)]</code>. Therefore,
the regression model based on the random-clumped binomial distribution is an alternative, under
overdispersion, to the binomial regression model.
</p>
<p>In all cases, even where the response variable is described by a
zero-truncated distribution, the fitted model describes the way in
which <code class="reqn">\mu</code> is dependent on some covariates. Parameter estimation
is performed using the maximum likelihood method. The model
parameters are estimated by maximizing the log-likelihood function
through the BFGS method available in the routine <a href="stats.html#topic+optim">optim</a>. The
accuracy and speed of the BFGS method are increased because the call
to the routine <a href="stats.html#topic+optim">optim</a> is performed using analytical instead
of the numerical  derivatives. The variance-covariance matrix
estimate is obtained as being minus the inverse of the (analytical)
hessian matrix evaluated at the parameter estimates and the observed
data.
</p>
<p>A set of standard extractor functions for fitted model objects is available for objects of class  <em>zeroinflation</em>,
including methods to the generic functions such as <code>print</code>, <code>summary</code>,	<code>model.matrix</code>, <code>estequa</code>,
<code>coef</code>, <code>vcov</code>, <code>logLik</code>, <code>fitted</code>, <code>confint</code>, <code>AIC</code>, <code>BIC</code> and <code>predict</code>.
In addition, the model fitted to the	data may be assessed using functions such as <a href="#topic+anova.overglm">anova.overglm</a>,
<a href="#topic+residuals.overglm">residuals.overglm</a>, <a href="#topic+dfbeta.overglm">dfbeta.overglm</a>, <a href="#topic+cooks.distance.overglm">cooks.distance.overglm</a>, <a href="#topic+localInfluence.overglm">localInfluence.overglm</a>,
<a href="#topic+gvif.overglm">gvif.overglm</a> and <a href="#topic+envelope.overglm">envelope.overglm</a>. The variable selection may be accomplished using the routine
<a href="#topic+stepCriterion.overglm">stepCriterion.overglm</a>.
</p>


<h3>Value</h3>

<p>an object of class <em>overglm</em> in which the main results of the model fitted to the data are stored, i.e., a
list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>coefficients</code> </td><td style="text-align: left;"> a vector containing the parameter estimates,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>fitted.values</code></td><td style="text-align: left;"> a vector containing the estimates of <code class="reqn">\mu_1,\ldots,\mu_n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>start</code>        </td><td style="text-align: left;"> a vector containing the starting values used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>prior.weights</code></td><td style="text-align: left;"> a vector containing the case weights used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>offset</code>       </td><td style="text-align: left;"> a vector containing the offset used, </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>terms</code>        </td><td style="text-align: left;"> an object containing the terms objects,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>loglik</code>       </td><td style="text-align: left;"> the value of the log-likelihood function avaliated at the parameter estimates,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>estfun</code>       </td><td style="text-align: left;"> a vector containing the estimating functions evaluated at the parameter estimates</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> and the observed data,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>formula</code>      </td><td style="text-align: left;"> the formula,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>levels</code>       </td><td style="text-align: left;"> the levels of the categorical regressors,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>contrasts</code>    </td><td style="text-align: left;"> an object containing the contrasts corresponding to levels,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>converged</code>    </td><td style="text-align: left;"> a logical indicating successful convergence,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>model</code>        </td><td style="text-align: left;"> the full model frame,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code>            </td><td style="text-align: left;"> the response count vector,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>family</code>       </td><td style="text-align: left;"> an object containing the <a href="stats.html#topic+family">family</a> object used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>linear.predictors</code> </td><td style="text-align: left;"> a vector containing the estimates of <code class="reqn">g(\mu_1),\ldots,g(\mu_n)</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R</code>            </td><td style="text-align: left;"> a matrix with the Cholesky decomposition of the inverse of the variance-covariance</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> matrix of all parameters in the model,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>call</code>         </td><td style="text-align: left;"> the original function call.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Crowder M. (1978) Beta-binomial anova for proportions, <em>Journal of the Royal Statistical
Society Series C (Applied Statistics)</em> 27, 34-37.
</p>
<p>Lawless J.F. (1987) Negative binomial and mixed poisson regression, <em>The Canadian Journal
of Statistics</em> 15, 209-225.
</p>
<p>Morel J.G., Neerchal N.K. (1997) Clustered binary logistic regression in teratology data
using a finite mixture distribution, <em>Statistics in Medicine</em> 16, 2843-2853.
</p>
<p>Morel J.G., Nagaraj N.K. (2012) <em>Overdispersion Models in SAS</em>. SAS Institute Inc.,
Cary, North Carolina, USA.
</p>


<h3>See Also</h3>

<p><a href="#topic+zeroalt">zeroalt</a>, <a href="#topic+zeroinf">zeroinf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Example 1: Ability of retinyl acetate to prevent mammary cancer in rats
data(mammary)
fit1 &lt;- overglm(tumors ~ group, family="nb1(identity)", data=mammary)
summary(fit1)

### Example 2: Self diagnozed ear infections in swimmers
data(swimmers)
fit2 &lt;- overglm(infections ~ frequency + location, family="nb1(log)", data=swimmers)
summary(fit2)

### Example 3: Urinary tract infections in HIV-infected men
data(uti)
fit3 &lt;- overglm(episodes ~ cd4 + offset(log(time)), family="nb1(log)", data = uti)
summary(fit3)

### Example 4: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit4 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)
summary(fit4)

### Example 5: Agents to stimulate cellular differentiation
data(cellular)
fit5 &lt;- overglm(cbind(cells,200-cells) ~ tnf + ifn, family="bb(logit)", data=cellular)
summary(fit5)

### Example 6: Teratogenic effects of phenytoin and trichloropropene oxide
data(ossification)
model6 &lt;- cbind(fetuses,litter-fetuses) ~ pht + tcpo
fit6 &lt;- overglm(model6, family="rcb(cloglog)", data=ossification)
summary(fit6)

### Example 7: Germination of orobanche seeds
data(orobanche)
model7 &lt;- cbind(germinated,seeds-germinated) ~ specie + extract
fit7 &lt;- overglm(model7, family="rcb(cloglog)", data=orobanche)
summary(fit7)

</code></pre>

<hr>
<h2 id='PAC'>Pardo-Alonso's Criterion for Generalized Estimating Equations</h2><span id='topic+PAC'></span>

<h3>Description</h3>

<p>Computes the Pardo-Alonso's criterion (PAC) for one or more objects of the class glmgee.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PAC(..., verbose = TRUE, digits = max(3, getOption("digits") - 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PAC_+3A_...">...</code></td>
<td>
<p>one or several objects of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="PAC_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="PAC_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer indicating the number of digits to print. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the values of the PAC for each <em>glmgee</em> object in the input.
</p>


<h3>References</h3>

<p>Pardo M.C., Alonso R. (2019) Working correlation structure selection in GEE analysis.
<em>Statistical Papers</em> 60:1447–1467.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+QIC">QIC</a>, <a href="#topic+CIC">CIC</a>, <a href="#topic+RJC">RJC</a>, <a href="#topic+AGPC">AGPC</a>, <a href="#topic+SGPC">SGPC</a>, <a href="#topic+GHYC">GHYC</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
PAC(fit1, fit2, fit3, fit4)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit1 &lt;- glmgee(mod2, id=subj, family=binomial(logit), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
PAC(fit1, fit2, fit3, fit4)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit1 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Exchangeable")
PAC(fit1, fit2, fit3)

</code></pre>

<hr>
<h2 id='pipeline'>Alaska pipeline</h2><span id='topic+pipeline'></span>

<h3>Description</h3>

<p>The Alaska pipeline data consists of in-field ultrasonic
measurements of defects depths in the Alaska pipeline. The depth of
the defects was measured again in the laboratory. These measurements
were performed in six batches. The data were analyzed to calibrate
the bias of field measurements relative to laboratory measurements.
In this analysis, the field measurement is the response variable and
the laboratory measurement is the predictor variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pipeline)
</code></pre>


<h3>Format</h3>

<p>A data frame with 107 rows and 2 variables:
</p>

<dl>
<dt>Field</dt><dd><p>a numeric vector indicating the number of defects measured in the field.</p>
</dd>
<dt>Lab</dt><dd><p>a numeric vector indicating the number of defects measured in the laboratory.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.itl.nist.gov/div898/handbook/pmd/section6/pmd621.htm">https://www.itl.nist.gov/div898/handbook/pmd/section6/pmd621.htm</a>
</p>


<h3>References</h3>

<p>Weisberg S. (2005). <em>Applied Linear Regression</em>, 3rd edition. Wiley, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pipeline)
dev.new()
xlab &lt;- "In-laboratory measurements"
ylab &lt;- "In-field measurements"
with(pipeline,plot(Lab,Field,pch=20,xlab=xlab,ylab=ylab))
</code></pre>

<hr>
<h2 id='predict.glmgee'>Predictions for Generalized Estimating Equations</h2><span id='topic+predict.glmgee'></span>

<h3>Description</h3>

<p>Produces predictions and optionally estimates standard errors of those predictions from a fitted generalized estimating equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmgee'
predict(
  object,
  ...,
  newdata,
  se.fit = FALSE,
  type = c("link", "response"),
  varest = c("robust", "df-adjusted", "model", "bias-corrected")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.glmgee_+3A_object">object</code></td>
<td>
<p>an object of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="predict.glmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="predict.glmgee_+3A_newdata">newdata</code></td>
<td>
<p>an (optional) <code>data frame</code> in which to look for variables with which to predict. If omitted, the fitted linear predictors are used.</p>
</td></tr>
<tr><td><code id="predict.glmgee_+3A_se.fit">se.fit</code></td>
<td>
<p>an (optional) logical switch indicating if standard errors are required. As default, <code>se.fit</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="predict.glmgee_+3A_type">type</code></td>
<td>
<p>an (optional) character string giving the type of prediction required. The default, &quot;link&quot;, is on the scale of the linear predictors, and the alternative, &quot;response&quot;, is on the scale of the response variable.</p>
</td></tr>
<tr><td><code id="predict.glmgee_+3A_varest">varest</code></td>
<td>
<p>an (optional) character string indicating the type of estimator which should be used to the variance-covariance matrix of the interest parameters. The available options are: robust sandwich-type estimator (&quot;robust&quot;), degrees-of-freedom-adjusted estimator (&quot;df-adjusted&quot;), bias-corrected estimator (&quot;bias-corrected&quot;), and the model-based or naive estimator (&quot;model&quot;). As default, <code>varest</code> is set to &quot;robust&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with so many rows as <code>newdata</code> and one column with the predictions. If <code>se.fit=</code>TRUE then a second column with estimates standard errors is included.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces, corstr="AR-M-dependent")
newdata1 &lt;- data.frame(days=c(556,556),treat=as.factor(c("normal","ozone-enriched")))
predict(fit1,newdata=newdata1,type="response",se.fit=TRUE)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit2 &lt;- glmgee(mod2, id=subj, family=binomial(logit), corstr="AR-M-dependent", data=depression)
newdata2 &lt;- data.frame(visit=c(6,6),group=as.factor(c("placebo","oestrogen")))
predict(fit2,newdata=newdata2,type="response",se.fit=TRUE)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit3 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), corstr="AR-M-dependent", data=depression)
newdata3 &lt;- data.frame(visit=c(6,6),group=as.factor(c("placebo","oestrogen")))
predict(fit3,newdata=newdata3,type="response",se.fit=TRUE)

</code></pre>

<hr>
<h2 id='QIC'>QIC for Generalized Estimating Equations</h2><span id='topic+QIC'></span>

<h3>Description</h3>

<p>Computes the quasi-likelihood under the independence model criterion (QIC) for one or more objects of the class glmgee.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QIC(
  ...,
  k = 2,
  u = FALSE,
  verbose = TRUE,
  digits = max(3, getOption("digits") - 2)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QIC_+3A_...">...</code></td>
<td>
<p>one or several objects of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="QIC_+3A_k">k</code></td>
<td>
<p>an (optional) non-negative value giving the magnitude of the penalty. As default, <code>k</code> is set to 2.</p>
</td></tr>
<tr><td><code id="QIC_+3A_u">u</code></td>
<td>
<p>an (optional) logical switch indicating if QIC should be replaced by QICu. As default, <code>u</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="QIC_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="QIC_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer indicating the number of digits to print. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the values of -2*quasi-likelihood, the number of parameters in the linear predictor, and the value of QIC (or QICu if <code>u</code>=TRUE) for each <em>glmgee</em> object in the input.
</p>


<h3>References</h3>

<p>Pan W. (2001) Akaike's information criterion in generalized estimating equations, <em>Biometrics</em> 57:120-125.
</p>
<p>Hin L.-Y., Carey V.J., Wang Y.-G. (2007) Criteria for Working–Correlation–Structure Selection in GEE:
Assessment via Simulation. <em>The American Statistician</em> 61:360–364.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+CIC">CIC</a>, <a href="#topic+GHYC">GHYC</a>, <a href="#topic+RJC">RJC</a>, <a href="#topic+AGPC">AGPC</a>, <a href="#topic+SGPC">SGPC</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
QIC(fit1, fit2, fit3, fit4)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit1 &lt;- glmgee(mod2, id=subj, family=binomial(logit), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
QIC(fit1, fit2, fit3, fit4)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit1 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Exchangeable")
QIC(fit1, fit2, fit3)

</code></pre>

<hr>
<h2 id='rabbits'>Age and Eye Lens Weight of Rabbits in Australia</h2><span id='topic+rabbits'></span>

<h3>Description</h3>

<p>The dry weight of the eye lens was measured for 71 free-living wild rabbits of known age. Eye
lens weight tends to vary much less with environmental conditions than does total body weight, and
therefore may be a much better indicator of age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rabbits)
</code></pre>


<h3>Format</h3>

<p>A data frame with 71 rows and 2 variables:
</p>

<dl>
<dt>age</dt><dd><p>a numeric vector indicating the rabbit age, in days.</p>
</dd>
<dt>wlens</dt><dd><p>a numeric vector indicating the dry weight of eye lens, in milligrams.</p>
</dd>
</dl>



<h3>References</h3>

<p>Dudzinski M.L., Mykytowycz R. (1961) The eye lens as an indicator of age in
the wild rabbit in Australia. <em>CSIRO Wildlife Research</em>, 6, 156-159.
</p>
<p>Ratkowsky D.A. (1983). <em>Nonlinear Regression Modelling</em>. Marcel Dekker, New York.
</p>
<p>Wei B.C. (1998). <em>Exponential Family Nonlinear Models</em>. Springer, Singapore.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rabbits)
dev.new()
with(rabbits,plot(age,wlens,xlab="Age (in days)",pch=16,col="blue",
                  ylab="Dry weight of eye lens (in milligrams)"))
</code></pre>

<hr>
<h2 id='races'>Hill races in Scotland</h2><span id='topic+races'></span>

<h3>Description</h3>

<p>Each year the Scottish Hill Runners Association publishes
a list of hill races in Scotland for the year. These data consist of
the record time, distance, and cumulative climb of 35 of those races.
The statistical analysis of these data aims to explain the differences
between the record time of the races. This is done using their
differences in distance and cumulative climb.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(races)
</code></pre>


<h3>Format</h3>

<p>A data frame with 35 rows and 4 variables:
</p>

<dl>
<dt>race</dt><dd><p>a character vector giving the names of the races.</p>
</dd>
<dt>distance</dt><dd><p>a numeric vector giving the distance, in miles, of the races.</p>
</dd>
<dt>cclimb</dt><dd><p>a numeric vector giving the cumulative climb, in thousands of feet, of the races.</p>
</dd>
<dt>rtime</dt><dd><p>a numeric vector giving the record time, in minutes, of the races.</p>
</dd>
</dl>



<h3>References</h3>

<p>Agresti A. (2015) <em>Foundations of Linear and Generalized Linear Models</em>.
John Wiley &amp; Sons, New Jersey.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(races)
breaks &lt;- with(races,quantile(cclimb,probs=c(0:2)/2))
labels &lt;- c("low","high")
races2 &lt;- within(races,cli &lt;- cut(cclimb,include.lowest=TRUE,breaks,labels))
dev.new()
with(races2,plot(log(distance),log(rtime),pch=16,col=as.numeric(cli)))
legend("topleft", legend=c("low","high"), title="Cumulative climb",
       col=c(1:2), pch=16, bty="n")
</code></pre>

<hr>
<h2 id='residuals.glmgee'>Residuals for Generalized Estimating Equations</h2><span id='topic+residuals.glmgee'></span>

<h3>Description</h3>

<p>Calculates residuals for a fitted generalized estimating equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmgee'
residuals(
  object,
  ...,
  type = c("mahalanobis", "pearson", "deviance"),
  plot.it = FALSE,
  identify
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.glmgee_+3A_object">object</code></td>
<td>
<p>a object of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="residuals.glmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="residuals.glmgee_+3A_type">type</code></td>
<td>
<p>an (optional) character string giving the type of residuals which should be returned. The available options are: (1) &quot;pearson&quot;; (2) &quot;deviance&quot;;  (3) the distance between the observed response vector and the fitted mean vector using a metric based on the product between the cluster size and fitted variance-covariance matrix (&quot;mahalanobis&quot;). As default, <code>type</code> is set to &quot;mahalanobis&quot;.</p>
</td></tr>
<tr><td><code id="residuals.glmgee_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if a plot of the residuals is required. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="residuals.glmgee_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer value indicating the number of individuals/clusters to identify on the plot of residuals. This is only appropriate when <code>plot.it=TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the observed residuals type <code>type</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces, corstr="AR-M-dependent")
### Plot to assess the adequacy of the chosen variance function
residuals(fit1, type="deviance", plot.it=TRUE, col="red", pch=20, col.lab="blue",
          col.axis="blue", col.main="black", family="mono", cex=0.8)
### Plot to identify trees suspicious to be outliers
residuals(fit1, type="mahalanobis", plot.it=TRUE, col="red", pch=20, col.lab="blue",
          col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit2 &lt;- glmgee(mod2, id=subj, family=binomial(logit), corstr="AR-M-dependent", data=depression)
### Plot to identify women suspicious to be outliers
residuals(fit2, type="mahalanobis", plot.it=TRUE, col="red", pch=20, col.lab="blue",
          col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit3 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), corstr="AR-M-dependent", data=depression)
### Plot to assess the adequacy of the chosen variance function
residuals(fit3, type="pearson", plot.it=TRUE, col="red", pch=20, col.lab="blue",
          col.axis="blue", col.main="black", family="mono", cex=0.8)
### Plot to identify women suspicious to be outliers
residuals(fit3, type="mahalanobis", plot.it=TRUE, col="red", pch=20, col.lab="blue",
          col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='residuals.gnm'>Residuals for Generalized Nonlinear Models</h2><span id='topic+residuals.gnm'></span>

<h3>Description</h3>

<p>Computes residuals for a fitted generalized nonlinear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnm'
residuals(
  object,
  type = c("quantile", "deviance", "pearson"),
  standardized = FALSE,
  plot.it = FALSE,
  identify,
  dispersion = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.gnm_+3A_object">object</code></td>
<td>
<p>a object of the class <em>gnm</em>.</p>
</td></tr>
<tr><td><code id="residuals.gnm_+3A_type">type</code></td>
<td>
<p>an (optional) character string giving the type of residuals which should be returned. The available options are: (1) &quot;quantile&quot;, (2) &quot;deviance&quot;, and (3) &quot;pearson&quot;. As default, <code>type</code> is set to &quot;quantile&quot;.</p>
</td></tr>
<tr><td><code id="residuals.gnm_+3A_standardized">standardized</code></td>
<td>
<p>an (optional) logical switch indicating if the residuals should be standardized by dividing by the square root of <code class="reqn">(1-h)</code>, where <code class="reqn">h</code> is a measure of leverage. As default, <code>standardized</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="residuals.gnm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if a plot of the residuals versus the fitted values is required. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="residuals.gnm_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer value indicating the number of individuals to identify on the plot of residuals. This is only appropriate when <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="residuals.gnm_+3A_dispersion">dispersion</code></td>
<td>
<p>an (optional) value indicating the dispersion parameter estimate that must be used to calculate residuals.</p>
</td></tr>
<tr><td><code id="residuals.gnm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the observed residuals type <code>type</code>.
</p>


<h3>References</h3>

<p>Atkinson A.C. (1985) <em>Plots, Transformations and Regression</em>. Oxford University Press, Oxford.
</p>
<p>Davison A.C., Gigli A. (1989) Deviance Residuals and Normal Scores Plots. <em>Biometrika</em> 76, 211-221.
</p>
<p>Dunn P.K., Smyth G.K. (1996) Randomized Quantile Residuals. <em>Journal of Computational and Graphical Statistics</em> 5, 236-244.
</p>
<p>Pierce D.A., Schafer D.W. (1986) Residuals in Generalized Linear Models. <em>Journal of the American Statistical Association</em> 81, 977-986.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)
residuals(fit1, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
                col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Assay of an Insecticide with a Synergist
data(Melanopus)
fit2 &lt;- gnm(Killed/Exposed ~ b0 + b1*log(Insecticide-a1) + b2*Synergist/(a2 + Synergist),
            family=binomial(logit), weights=Exposed, start=c(b0=-3,b1=1.2,a1=1.7,b2=1.7,a2=2),
		   data=Melanopus)
residuals(fit2, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
                col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 3: Developmental rate of Drosophila melanogaster
data(Drosophila)
fit3 &lt;- gnm(Duration ~ b0 + b1*Temp + b2/(Temp-a), family=Gamma(log),
            start=c(b0=3,b1=-0.25,b2=-210,a=55), weights=Size, data=Drosophila)
residuals(fit3, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
                col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 4: Radioimmunological Assay of Cortisol
data(Cortisol)
fit4 &lt;- gnm(Y ~ b0 + (b1-b0)/(1 + exp(b2+ b3*lDose))^b4, family=Gamma(identity),
            start=c(b0=130,b1=2800,b2=3,b3=3,b4=0.5), data=Cortisol)
residuals(fit4, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
                col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 5: Age and Eye Lens Weight of Rabbits in Australia
data(rabbits)
fit5 &lt;- gnm(wlens ~ b1 - b2/(age + b3), family=Gamma(log),
            start=c(b1=5.5,b2=130,b3=35), data=rabbits)
residuals(fit5, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
                col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 6: Calls to a technical support help line
data(calls)
fit6 &lt;- gnm(calls ~ SSlogis(week, Asym, xmid, scal), family=poisson(identity), data=calls)
residuals(fit6, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
                col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='residuals.overglm'>Residuals for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion.</h2><span id='topic+residuals.overglm'></span>

<h3>Description</h3>

<p>Computes various types of residuals to assess the individual quality of model fit for
regression models based on the negative binomial, beta-binomial, and random-clumped binomial
distributions, which are alternatives to the Poisson and binomial regression models under the presence of overdispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'overglm'
residuals(
  object,
  type = c("quantile", "standardized", "response"),
  plot.it = FALSE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.overglm_+3A_object">object</code></td>
<td>
<p>an object of class <em>overglm</em>.</p>
</td></tr>
<tr><td><code id="residuals.overglm_+3A_type">type</code></td>
<td>
<p>an (optional) character string which allows to specify the required type of residuals. The available options are: (1)
the difference between the observed response and the fitted mean (&quot;response&quot;); (2) the standardized difference between
the observed response and the fitted mean (&quot;standardized&quot;); and (3) the randomized quantile residual (&quot;quantile&quot;). By
default, <code>type</code> is set to &quot;quantile&quot;.</p>
</td></tr>
<tr><td><code id="residuals.overglm_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if the plot of residuals versus the fitted values is required. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="residuals.overglm_+3A_identify">identify</code></td>
<td>
<p>an (optional) positive integer value indicating the number of individuals to identify on the plot of residuals versus the fitted values. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="residuals.overglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the observed <code>type</code>-type residuals.
</p>


<h3>References</h3>

<p>Dunn P.K., Smyth G.K. (1996) Randomized Quantile Residuals. <em>Journal of Computational and Graphical Statistics</em>, 5, 236-244.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- overglm(infections ~ frequency + location, family="nb1(log)", data=swimmers)
residuals(fit1, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
          col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit2 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)
residuals(fit2, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
          col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 3: Agents to stimulate cellular differentiation
data(cellular)
fit3 &lt;- overglm(cbind(cells,200-cells) ~ tnf + ifn, family="bb(logit)", data=cellular)
residuals(fit3, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
          col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='residuals.zeroinflation'>Residuals in Regression Models to deal with Zero-Excess in Count Data</h2><span id='topic+residuals.zeroinflation'></span>

<h3>Description</h3>

<p>Computes various types of residuals to assess the individual quality of model fit in regression models
to deal with zero-excess in count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'zeroinflation'
residuals(
  object,
  type = c("quantile", "standardized", "response"),
  plot.it = FALSE,
  identify,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.zeroinflation_+3A_object">object</code></td>
<td>
<p>an object of class <em>zeroinflation</em>.</p>
</td></tr>
<tr><td><code id="residuals.zeroinflation_+3A_type">type</code></td>
<td>
<p>an (optional) character string which allows to specify the required type of residuals. The available options are: (1)
the difference between the observed response and the fitted mean (&quot;response&quot;); (2) the standardized difference between
the observed response and the fitted mean (&quot;standardized&quot;); (3) the randomized quantile residual (&quot;quantile&quot;). By
default, <code>type</code> is set to &quot;quantile&quot;.</p>
</td></tr>
<tr><td><code id="residuals.zeroinflation_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if the plot of residuals versus the fitted values is required. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="residuals.zeroinflation_+3A_identify">identify</code></td>
<td>
<p>an (optional) positive integer value indicating the number of individuals to identify on the plot of residuals versus the fitted values. This is only appropriate if <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="residuals.zeroinflation_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. If <code>plot.it=TRUE</code> then <code>...</code> may be used to include graphical parameters to customize the plot. For example, <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the observed residuals type <code>type</code>.
</p>


<h3>References</h3>

<p>Dunn P.K., Smyth G.K. (1996) Randomized Quantile Residuals. <em>Journal of Computational and Graphical Statistics</em>, 5, 236-244.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>####### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- zeroalt(infections ~ frequency | location, family="nb1(log)", data=swimmers)
residuals(fit1, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
          col.axis="blue", col.main="black", family="mono", cex=0.8)

####### Example 2: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit2 &lt;- zeroinf(art ~ fem + kid5 + ment | ment, family="nb1(log)", data = bioChemists)
residuals(fit2, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
          col.axis="blue", col.main="black", family="mono", cex=0.8)

</code></pre>

<hr>
<h2 id='residuals2'>Residuals for Linear and Generalized Linear Models</h2><span id='topic+residuals2'></span>

<h3>Description</h3>

<p>Computes residuals for a fitted linear or generalized linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>residuals2(object, type, standardized = FALSE, plot.it = FALSE, identify, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals2_+3A_object">object</code></td>
<td>
<p>a object of the class <em>lm</em> or <em>glm</em>.</p>
</td></tr>
<tr><td><code id="residuals2_+3A_type">type</code></td>
<td>
<p>an (optional) character string giving the type of residuals which should be returned. The available options for LMs are: (1) externally studentized (&quot;external&quot;); (2) internally studentized (&quot;internal&quot;) (default). The available options for GLMs are: (1) &quot;pearson&quot;; (2) &quot;deviance&quot; (default);  (3) &quot;quantile&quot;.</p>
</td></tr>
<tr><td><code id="residuals2_+3A_standardized">standardized</code></td>
<td>
<p>an (optional) logical switch indicating if the residuals should be standardized by dividing by the square root of <code class="reqn">(1-h)</code>, where <code class="reqn">h</code> is a measure of leverage. As default, <code>standardized</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="residuals2_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if a plot of the residuals versus the fitted values is required. As default, <code>plot.it</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="residuals2_+3A_identify">identify</code></td>
<td>
<p>an (optional) integer value indicating the number of individuals to identify on the plot of residuals. This is only appropriate when <code>plot.it=TRUE</code>.</p>
</td></tr>
<tr><td><code id="residuals2_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the observed residuals type <code>type</code>.
</p>


<h3>References</h3>

<p>Atkinson A.C. (1985) <em>Plots, Transformations and Regression</em>. Oxford University Press, Oxford.
</p>
<p>Davison A.C., Gigli A. (1989) Deviance Residuals and Normal Scores Plots. <em>Biometrika</em> 76, 211-221.
</p>
<p>Dunn P.K., Smyth G.K. (1996) Randomized Quantile Residuals. <em>Journal of Computational and Graphical Statistics</em> 5, 236-244.
</p>
<p>Pierce D.A., Schafer D.W. (1986) Residuals in Generalized Linear Models. <em>Journal of the American Statistical Association</em> 81, 977-986.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Species richness in plots
data(richness)
fit1 &lt;- lm(Species ~ Biomass + pH, data=richness)
residuals2(fit1, type="external", plot.it=TRUE, col="red", pch=20, col.lab="blue",
           col.axis="blue", col.main="black", family="mono", cex=0.8)

###### Example 2: Lesions of Aucuba mosaic virus
data(aucuba)
fit2 &lt;- glm(lesions ~ time, family=poisson, data=aucuba)
residuals2(fit2, type="quantile", plot.it=TRUE, col="red", pch=20, col.lab="blue",
           col.axis="blue",col.main="black",family="mono",cex=0.8)
</code></pre>

<hr>
<h2 id='richness'>Species richness</h2><span id='topic+richness'></span>

<h3>Description</h3>

<p>In these data the response is species richness represented
by a count of the number of plant species on plots with different
biomass and three different soil pH levels: low, mid, and high.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(richness)
</code></pre>


<h3>Format</h3>

<p>A data frame with 90 rows and 3 variables:
</p>

<dl>
<dt>Biomass</dt><dd><p>a numeric vector giving the value of the biomass in the plots.</p>
</dd>
<dt>pH</dt><dd><p>a factor giving the soil pH level in the plots: &quot;low&quot;, &quot;mid&quot;, and &quot;high&quot;.</p>
</dd>
<dt>Species</dt><dd><p>a numeric vector giving the number of plant species in the plots.</p>
</dd>
</dl>



<h3>References</h3>

<p>Crawley M.J. (2007) <em>The R Book</em>. John Wiley &amp; Sons, Chichester.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(richness)
dev.new()
with(richness,plot(Biomass,Species,col=as.numeric(pH),pch=16))
legend("topright", legend=c("low","mid","high"), col=c(1:3), pch=16,
       title="pH level", bty="n")
</code></pre>

<hr>
<h2 id='rinse'>Dental Clinical Trial</h2><span id='topic+rinse'></span>

<h3>Description</h3>

<p>These data arose from a study in dentistry. In this trial,
subjects were generally healthy adult male and female volunteers, ages
18–55, with pre-existing plaque but without advanced periodontal
disease. Prior to entry, subjects were screened for a minimum of 20
sound, natural teeth and a minimum mean plaque index of 2.0. Subjects
with gross oral pathology or on antibiotic, antibacterial, or
anti-inflammatory therapy were excluded from the study. One hundred
nine volunteers were randomized in a double-blinded way to one of two
novel mouth rinses (A and B) or to a control mouth rinse. Plaque was
scored at baseline, at 3 months, and at 6 months by the Turesky
modification of the Quigley-Hein index, a continuous measure. Four
subjects had missing plaque scores. The main objective of the
analysis is to measure the effectiveness of three mouth rinses at
inhibiting dental plaque.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rinse)
</code></pre>


<h3>Format</h3>

<p>A data frame with 315 rows and 7 variables:
</p>

<dl>
<dt>subject</dt><dd><p>a character string giving the identifier of the volunteer.</p>
</dd>
<dt>gender</dt><dd><p>a factor indicating the gender of the volunteer: &quot;Female&quot; and &quot;Male&quot;.</p>
</dd>
<dt>age</dt><dd><p>a numeric vector indicating the age of the volunteer.</p>
</dd>
<dt>rinse</dt><dd><p>a factor indicating the type of rinse used by the volunteer: &quot;Placebo&quot;, &quot;A&quot; and &quot;B&quot;.</p>
</dd>
<dt>smoke</dt><dd><p>a factor indicating if the volunteer smoke: &quot;Yes&quot; and &quot;No&quot;.</p>
</dd>
<dt>time</dt><dd><p>a numeric vector indicating the time (in months) since the treatment began.</p>
</dd>
<dt>score</dt><dd><p>a numeric vector giving the subject’s score of plaque.</p>
</dd>
</dl>



<h3>References</h3>

<p>Hadgu A., Koch G. (1999) Application of generalized estimating equations
to a dental randomized clinical trial. <em>Journal of Biopharmaceutical Statistics</em> 9:161-178.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rinse)
dev.new()
boxplot(score ~ time, data=subset(rinse,rinse=="Placebo"),ylim=c(0,3.5),
        at=c(1:3)-0.2, col="yellow", xaxt="n", boxwex=0.15)
boxplot(score ~ time, data=subset(rinse,rinse=="A"), add=TRUE,
        at=c(1:3), col="gray", xaxt="n", boxwex=0.15)
boxplot(score ~ time, data=subset(rinse,rinse=="B"), add=TRUE,
        at=c(1:3) + 0.2, col="blue", xaxt="n", boxwex=0.15)
axis(1, at=c(1:3), labels=unique(rinse$time))
legend("bottomleft",legend=c("placebo","rinse A","rinse B"),
       title="Treatment",fill=c("yellow","gray","blue"),bty="n")
</code></pre>

<hr>
<h2 id='RJC'>Rotnitzky–Jewell's Criterion for Generalized Estimating Equations</h2><span id='topic+RJC'></span>

<h3>Description</h3>

<p>Computes the Rotnitzky–Jewell's criterion (RJC) for one or more objects of the class glmgee.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RJC(..., verbose = TRUE, digits = max(3, getOption("digits") - 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RJC_+3A_...">...</code></td>
<td>
<p>one or several objects of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="RJC_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="RJC_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer indicating the number of digits to print. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the values of the RJC for each <em>glmgee</em> object in the input.
</p>


<h3>References</h3>

<p>Hin L.-Y., Carey V.J., Wang Y.-G. (2007) Criteria for Working–Correlation–Structure
Selection in GEE: Assessment via Simulation. <em>The American Statistician</em> 61:360-364.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+QIC">QIC</a>, <a href="#topic+CIC">CIC</a>, <a href="#topic+GHYC">GHYC</a>, <a href="#topic+AGPC">AGPC</a>, <a href="#topic+SGPC">SGPC</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
RJC(fit1, fit2, fit3, fit4)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit1 &lt;- glmgee(mod2, id=subj, family=binomial(logit), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
RJC(fit1, fit2, fit3, fit4)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit1 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Exchangeable")
RJC(fit1, fit2, fit3)

</code></pre>

<hr>
<h2 id='ROCc'>The Receiver Operating Characteristic (ROC) Curve</h2><span id='topic+ROCc'></span>

<h3>Description</h3>

<p>Computes the exact area under the ROC curve (AUROC), the Gini coefficient, and the Kolmogorov-Smirnov (KS) statistic for a binary classifier. Optionally, this function can plot the ROC curve, that is, the plot of the estimates of Sensitivity versus the estimates of 1-Specificity. This function also computes confidence intervals for AUROC and Gini coefficient using the method proposed by DeLong et al. (1988).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ROCc(
  object,
  plot.it = TRUE,
  verbose = TRUE,
  level = 0.95,
  digits = max(3, getOption("digits") - 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ROCc_+3A_object">object</code></td>
<td>
<p>a matrix with two columns: the first one is a numeric vector of 1's and 0's indicating whether each row is a &quot;success&quot; or a &quot;failure&quot;; the second one is a numeric vector of values indicating the probability (or propensity score) of each row to be a &quot;success&quot;. Optionally, <code>object</code> can be an object of the class glm which is obtained from the fit of a generalized linear model where the distribution of the response variable is assumed to be binomial.</p>
</td></tr>
<tr><td><code id="ROCc_+3A_plot.it">plot.it</code></td>
<td>
<p>an (optional) logical switch indicating if the plot of the ROC curve is required or just the data matrix in which it is based. As default, <code>plot.it</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="ROCc_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="ROCc_+3A_level">level</code></td>
<td>
<p>an (optional) value indicating the required confidence level. As default, <code>level</code> is set to 0.95.</p>
</td></tr>
<tr><td><code id="ROCc_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer value indicating the number of decimal places to be used. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
<tr><td><code id="ROCc_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. For example, if <code>plot.it=TRUE</code> then <code>...</code> may to include graphical parameters as <code>col</code>, <code>pch</code>, <code>cex</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which contains the following objects:
</p>

<dl>
<dt><code>roc</code></dt><dd><p> A matrix with the Cutoffs and the associated estimates of Sensitivity and Specificity.</p>
</dd>
<dt><code>auroc</code></dt><dd><p> The exact area under the ROC curve.</p>
</dd>
<dt><code>ci.auroc</code></dt><dd><p> Confidence interval for the area under the ROC curve.</p>
</dd>
<dt><code>gini</code></dt><dd><p> The value of the Gini coefficient computed as 2(<code>auroc</code>-0.5).</p>
</dd>
<dt><code>ci.gini</code></dt><dd><p> Confidence interval for the Gini coefficient.</p>
</dd>
<dt><code>ks</code></dt><dd><p> The value of the Kolmogorov-Smirnov statistic computed as the maximum value of |1-Sensitivity-Specificity|.</p>
</dd>
</dl>



<h3>References</h3>

<p>Cho H., Matthews G.J., Harel O. (2019) Confidence Intervals for the Area Under the Receiver Operating Characteristic Curve in the Presence of Ignorable Missing Data. <em>International statistical review</em> 87, 152–177.
</p>
<p>DeLong E.R., DeLong D.M., Clarke-Pearson D.L. (1988). Comparing the areas under two or more correlated receiver operating characteristic curves: a nonparametric approach. <em>Biometrics</em> 44, 837–845.
</p>
<p>Nahm F.S. (2022). Receiver operating characteristic curve: overview and practical use for clinicians. <em>Korean journal of anesthesiology</em> 75, 25–36.
</p>
<p>Hanley J.A., McNeil B.J. (1982) The Meaning and Use of the Area under a Receiver Operating Characteristic (ROC) Curve. <em>Radiology</em> 143, 29–36.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example: Patients with burn injuries
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death2 &lt;- ifelse(death=="Dead",1,0))

### splitting the sample: 70% for the training sample and 30% for the validation sample
train &lt;- sample(1:nrow(burn1000),size=nrow(burn1000)*0.7)
traindata &lt;- burn1000[train,]
testdata &lt;- burn1000[-train,]

fit &lt;- glm(death ~ age*inh_inj + tbsa*inh_inj, family=binomial("logit"), data=traindata)
probs &lt;- predict(fit, newdata=testdata, type="response")

### ROC curve for the validation sample
ROCc(cbind(testdata[,"death2"],probs), col="red", col.lab="blue", col.axis="black",
     col.main="black", family="mono")
</code></pre>

<hr>
<h2 id='Seizures'>Seizures</h2><span id='topic+Seizures'></span>

<h3>Description</h3>

<p>The dataset reports the number of epileptic seizures in
each of four two-week intervals, and in a baseline eight-week interval,
for Progabide treatment and placebo groups with a total of 59
individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Seizures)
</code></pre>


<h3>Format</h3>

<p>A data frame with 236 rows and 6 variables:
</p>

<dl>
<dt>seizures</dt><dd><p>a numeric vector indicating the number of epileptic seizures.</p>
</dd>
<dt>treatment</dt><dd><p>a factor indicating the applied treatment: &quot;Progabide&quot; and &quot;Placebo&quot;.</p>
</dd>
<dt>base</dt><dd><p>a numeric vector indicating the number of epileptic seizures in the baseline eight-week inverval.</p>
</dd>
<dt>age</dt><dd><p>a numeric vector indicating the age of the individuals.</p>
</dd>
<dt>time</dt><dd><p>a numeric vector indicating which the two-week interval corresponds to the reported number of epileptic seizures.</p>
</dd>
<dt>id</dt><dd><p>a numeric vector indicating the identifier of each individual.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Thall P.F., Vail S.C. (1990) Some covariance models for longitudinal count data with overdispersion. <em>Biometrics</em> 46:657–671.
</p>


<h3>References</h3>

<p>Carey V.J., Wang Y.-G. (2011) Working covariance model selection for generalized estimating equations. <em>Statistics in Medicine</em> 30:3117–3124.
</p>
<p>Fu L., Hao Y., Wang Y.-G. (2018) Working correlation structure selection in generalized estimating equations. <em>Computational Statistics &amp; Data Analysis</em> 33:983–996.
</p>
<p>Diggle P.J., Liang K.Y., Zeger S.L. (1994, page 166) <em>Analysis of Longitudinal Data</em>. Clarendon Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dev.new()
data(Seizures)
boxplot(seizures ~ treatment:time, data=Seizures, ylim=c(0,25), col=c("blue","yellow"))
</code></pre>

<hr>
<h2 id='SGPC'>SGPC for Generalized Estimating Equations</h2><span id='topic+SGPC'></span>

<h3>Description</h3>

<p>Computes the Schwarz-type penalized Gaussian pseudo-likelihood criterion (SGPC) for one or more objects of the class glmgee.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SGPC(..., verbose = TRUE, digits = max(3, getOption("digits") - 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SGPC_+3A_...">...</code></td>
<td>
<p>one or several objects of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="SGPC_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="SGPC_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer indicating the number of digits to print. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the values of the gaussian pseudo-likelihood, the number of parameters in the linear predictor plus the number of parameters in the correlation matrix, and the value of SGPC for each <em>glmgee</em> object in the input.
</p>


<h3>References</h3>

<p>Carey V.J., Wang Y.-G. (2011) Working covariance model selection for
generalized estimating equations. <em>Statistics in Medicine</em> 30:3117-3124.
</p>
<p>Zhu X., Zhu Z. (2013) Comparison of Criteria to Select Working Correlation
Matrix in Generalized Estimating Equations. <em>Chinese Journal of Applied Probability
and Statistics</em> 29:515-530.
</p>
<p>Fu L., Hao Y., Wang Y.-G. (2018) Working correlation structure
selection in generalized estimating equations. <em>Computational Statistics</em> 33:983-996.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+QIC">QIC</a>, <a href="#topic+CIC">CIC</a>, <a href="#topic+RJC">RJC</a>, <a href="#topic+GHYC">GHYC</a>, <a href="#topic+AGPC">AGPC</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod1 &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod1, id=tree, family=Gamma(log), data=spruces)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
SGPC(fit1, fit2, fit3, fit4)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod2 &lt;- depressd ~ visit + group
fit1 &lt;- glmgee(mod2, id=subj, family=binomial(logit), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Stationary-M-dependent(2)")
fit4 &lt;- update(fit1, corstr="Exchangeable")
SGPC(fit1, fit2, fit3, fit4)

###### Example 3: Treatment for severe postnatal depression (2)
mod3 &lt;- dep ~ visit*group
fit1 &lt;- glmgee(mod3, id=subj, family=gaussian(identity), data=depression)
fit2 &lt;- update(fit1, corstr="AR-M-dependent")
fit3 &lt;- update(fit1, corstr="Exchangeable")
SGPC(fit1, fit2, fit3)

</code></pre>

<hr>
<h2 id='shelflife'>Shelf life of a photographic developer</h2><span id='topic+shelflife'></span>

<h3>Description</h3>

<p>These data arise from an experiment using accelerated
life testing to determine the estimated shelf life of a photographic
developer. Maximum density and temperature seem to be reliable
indicators of overall developer/film performance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(shelflife)
</code></pre>


<h3>Format</h3>

<p>A data frame with 21 rows and 3 variables:
</p>

<dl>
<dt>Time</dt><dd><p> a numeric vector giving the shelf life, in hours.</p>
</dd>
<dt>Temp</dt><dd><p> a factor giving the temperature, in degrees celsius.</p>
</dd>
<dt>Dmax</dt><dd><p> a numeric vector giving the maximum density.</p>
</dd>
</dl>



<h3>References</h3>

<p>Chapman R.E. (1997) Degradation study of a photographic developer to determine shelf life,
<em>Quality Engineering</em> 10:1, 137-140.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shelflife)
dev.new()
with(shelflife,plot(Dmax, Time, pch=16, col=as.numeric(Temp)))
legend("topright", legend=c("72C","82C","92C"), col=c(1:3), pch=16,
       title="Temperature", bty="n")

</code></pre>

<hr>
<h2 id='skincancer'>Skin cancer in women</h2><span id='topic+skincancer'></span>

<h3>Description</h3>

<p>The data describe the incidence of nonmelanoma skin
cancer among women stratified by age in Minneapolis (St. Paul) and
Dallas (Fort Worth).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(skincancer)
</code></pre>


<h3>Format</h3>

<p>A data frame with 16 rows and 4 variables:
</p>

<dl>
<dt>cases</dt><dd><p>a numeric vector giving the nonmelanoma skin cancer counts.</p>
</dd>
<dt>city</dt><dd><p>a factor giving the city to which correspond the skin cancer counts: &quot;St.Paul&quot; and &quot;Ft.Worth&quot;.</p>
</dd>
<dt>ageC</dt><dd><p>a factor giving the age range to which correspond the skin cancer counts: &quot;15-24&quot;, &quot;25-34&quot;, &quot;35-44&quot;, &quot;45-54&quot;, &quot;55-64&quot;, &quot;65-74&quot;, &quot;75-84&quot; and &quot;85+&quot;.</p>
</dd>
<dt>population</dt><dd><p>a numeric vector giving the population of women.</p>
</dd>
<dt>age</dt><dd><p>a numeric vector giving the midpoint of age range.</p>
</dd>
</dl>



<h3>References</h3>

<p>Kleinbaum D., Kupper L., Nizam A., Rosenberg E.S. (2013) <em>Applied Regression Analysis and
other Multivariable Methods, Fifth Edition</em>, Cengage Learning, Boston.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(skincancer)
dev.new()
barplot(1000*cases/population ~ city + ageC, beside=TRUE, col=c("yellow","blue"),
        data=skincancer)
legend("topleft", legend=c("St.Paul","Ft.Worth"), title="City",
       fill=c("yellow","blue"), bty="n")

</code></pre>

<hr>
<h2 id='spruces'>Effect of ozone-enriched atmosphere on growth of sitka spruces</h2><span id='topic+spruces'></span>

<h3>Description</h3>

<p>These data are analyzed primarily to determine how ozone
pollution affects tree growth. As ozone pollution is common in urban
areas, the impact of increased ozone concentrations on tree growth is
of considerable interest. The response variable is tree size, where
size is conventionally measured by the product of tree height and
stem diameter squared. In the first group, 54 trees were grown under
an ozone-enriched atmosphere, ozone exposure at 70 parts per billion.
In the second group, 25 trees were grown under normal conditions. The
size of each tree was observed 13 times across time, that is, 152,
174, 201, 227, 258, 469, 496, 528, 556, 579, 613, 639 and 674 days
since the beginning of the experiment. Hence, the objective is to
compare the trees' growth patterns under the two conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spruces)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1027 rows and 4 variables:
</p>

<dl>
<dt>tree</dt><dd><p>a factor giving an unique identifier for each tree.</p>
</dd>
<dt>days</dt><dd><p>a numeric vector giving the number of days since the beginning of the experiment.</p>
</dd>
<dt>size</dt><dd><p>a numeric vector giving an estimate of the volume of the tree trunk.</p>
</dd>
<dt>treat</dt><dd><p>a factor giving the treatment received for each tree: &quot;normal&quot; and &quot;ozone-enriched&quot;.</p>
</dd>
</dl>



<h3>References</h3>

<p>Diggle P.J., Heagarty P., Liang K.-Y., Zeger S.L. (2002) <em>Analysis of Longitudinal Data</em>. Oxford University Press, Oxford.
</p>
<p>Crainiceanu C.M., Ruppert D., Wand M.P. (2005). Bayesian Analysis for Penalized Spline Regression Using WinBUGS. <em>Journal of Statistical Software</em> 14(14):1-24.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spruces)
dev.new()
boxplot(size ~ days, data=subset(spruces,treat=="normal"), at=c(1:13) - 0.2,
        col="yellow", boxwex=0.3, xaxt="n", xlim=c(0.9,13.1))
boxplot(size ~ days, data=subset(spruces,treat=="ozone-enriched"), add=TRUE,
        at=c(1:13) + 0.2, col="blue", boxwex=0.3, xaxt="n")
axis(1, at=c(1:13), labels=unique(spruces$days))
axis(2, at=seq(0,2000,250), labels=seq(0,2000,250))
legend("topleft", legend=c("normal","ozone-enriched"), fill=c("yellow","blue"),
       title="Atmosphere", bty="n")

</code></pre>

<hr>
<h2 id='Steel'>Hardened Steel</h2><span id='topic+Steel'></span>

<h3>Description</h3>

<p>This dataset consists of failure times for hardened steel
specimens in a rolling contact fatigue test. Ten independent
observations were taken at each of the four contact stress values.
Response is the time that each specimen of hardened steel failed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Steel)
</code></pre>


<h3>Format</h3>

<p>A data frame with 40 rows and 2 variables:
</p>

<dl>
<dt>stress</dt><dd><p>a numeric vector indicating the values of contact stress, in pounds per square inch x <code class="reqn">10^{-6}</code>.</p>
</dd>
<dt>life</dt><dd><p>a numeric vector indicating the length of the time until the specimen of the hardened steel failed.</p>
</dd>
</dl>



<h3>References</h3>

<p>McCool J. (1980) Confidence limits for Weibull regression with censored data. <em> Transactions on Reliability</em> 29:145-150.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dev.new()
data(Steel)
with(Steel,plot(log(stress), log(life), pch=16, xlab="Log(Stress)", ylab="log(Life)"))
</code></pre>

<hr>
<h2 id='stepCriterion'>Variable selection in regression models from a chosen criterion</h2><span id='topic+stepCriterion'></span>

<h3>Description</h3>

<p>Generic function for selecting variables from a fitted regression model using a chosen criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stepCriterion(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepCriterion_+3A_model">model</code></td>
<td>
<p>a fitted model object.</p>
</td></tr>
<tr><td><code id="stepCriterion_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which includes the descriptions of the linear predictors of the initial and final models as well as the criterion used to compare the candidate models.
</p>

<hr>
<h2 id='stepCriterion.glm'>Variable Selection in Generalized Linear Models</h2><span id='topic+stepCriterion.glm'></span>

<h3>Description</h3>

<p>Performs variable selection in generalized linear models using hybrid versions of forward stepwise and backward stepwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
stepCriterion(
  model,
  criterion = c("adjr2", "bic", "aic", "p-value", "qicu"),
  test = c("wald", "lr", "score", "gradient"),
  direction = c("forward", "backward"),
  levels = c(0.05, 0.05),
  trace = TRUE,
  scope,
  force.in,
  force.out,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepCriterion.glm_+3A_model">model</code></td>
<td>
<p>an object of the class <em>glm</em>.</p>
</td></tr>
<tr><td><code id="stepCriterion.glm_+3A_criterion">criterion</code></td>
<td>
<p>an (optional) character string indicating the criterion which should be used to compare the candidate models. The available options are: AIC (&quot;aic&quot;), BIC (&quot;bic&quot;), adjusted deviance-based R-squared (&quot;adjr2&quot;), and <em>p</em>-value of the <code>test</code> test (&quot;p-value&quot;). As default, <code>criterion</code> is set to &quot;adjr2&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.glm_+3A_test">test</code></td>
<td>
<p>an (optional) character string indicating the statistical test which should be used to compare nested models. The available options are: Wald (&quot;wald&quot;), Rao's score (&quot;score&quot;), likelihood-ratio (&quot;lr&quot;) and gradient (&quot;gradient&quot;) tests. As default, <code>test</code> is set to &quot;wald&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.glm_+3A_direction">direction</code></td>
<td>
<p>an (optional) character string indicating the type of procedure which should be used. The available options are: hybrid backward stepwise (&quot;backward&quot;) and hybrid forward stepwise (&quot;forward&quot;). As default, <code>direction</code> is set to &quot;forward&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.glm_+3A_levels">levels</code></td>
<td>
<p>an (optional) two-dimensional vector of values in the interval <code class="reqn">(0,1)</code> indicating the levels at which the variables should in and out from the model. This is only appropiate if <code>criterion</code>=&quot;p-value&quot;. As default, <code>levels</code> is set to <code>c(0.05,0.05)</code>.</p>
</td></tr>
<tr><td><code id="stepCriterion.glm_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical switch indicating if should the stepwise reports be printed. As default, <code>trace</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="stepCriterion.glm_+3A_scope">scope</code></td>
<td>
<p>an (optional) list, containing components <code>lower</code> and <code>upper</code>, both formula-type objects, indicating the range of models which should be examined in the stepwise search. As default, <code>lower</code> is a model with no predictors and <code>upper</code> is the linear predictor of the model in <code>model</code>.</p>
</td></tr>
<tr><td><code id="stepCriterion.glm_+3A_force.in">force.in</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in all models</p>
</td></tr>
<tr><td><code id="stepCriterion.glm_+3A_force.out">force.out</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in no models</p>
</td></tr>
<tr><td><code id="stepCriterion.glm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. For example, <code>k</code>, that is, the magnitude of the penalty in the AIC/QICu, which by default is set to 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;hybrid forward stepwise&quot; algorithm starts with the simplest model (which may
be chosen at the argument <code>scope</code>, and As default, is a model whose parameters in the
linear predictor, except the intercept, if any, are set to 0), and then the candidate
models are built by hierarchically including effects in the linear predictor, whose
&quot;relevance&quot; and/or &quot;importance&quot; in the model fit is assessed by comparing nested models
(that is, by comparing the models with and without the added effect) using a criterion
previously specified. If an effect is added to the equation, this strategy may also remove
any effect which, according to the previously specified criterion, no longer provides
improvement in the model fit. That process continues until no more effects are included
or excluded. The &quot;hybrid backward stepwise&quot; algorithm works similarly.
</p>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>initial</code> </td><td style="text-align: left;">  a character string indicating the linear predictor of the "initial model",</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>direction</code> </td><td style="text-align: left;">  a character string indicating the type of procedure which was used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>criterion</code> </td><td style="text-align: left;"> a character string indicating the criterion used to compare the candidate models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>final</code> </td><td style="text-align: left;"> a character string indicating the linear predictor of the "final model",</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>final.fit</code> </td><td style="text-align: left;"> an object of class <code>glm</code> with the results of the fit to the data of the "final model",</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>James G., Witten D., Hastie T., Tibshirani R. (2013, page 210) An Introduction to Statistical Learning with Applications in R, Springer, New York.
</p>


<h3>See Also</h3>

<p><a href="#topic+bestSubset">bestSubset</a>, <a href="#topic+stepCriterion.lm">stepCriterion.lm</a>, <a href="#topic+stepCriterion.overglm">stepCriterion.overglm</a>, <a href="#topic+stepCriterion.glmgee">stepCriterion.glmgee</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Fuel consumption of automobiles
Auto &lt;- ISLR::Auto
Auto2 &lt;- within(Auto, origin &lt;- factor(origin))
mod &lt;- mpg ~ cylinders + displacement + acceleration + origin + horsepower*weight
fit1 &lt;- glm(mod, family=inverse.gaussian("log"), data=Auto2)
stepCriterion(fit1, direction="forward", criterion="p-value", test="lr")
stepCriterion(fit1, direction="backward", criterion="bic", force.in=~cylinders)

###### Example 2: Patients with burn injuries
burn1000 &lt;- aplore3::burn1000
burn1000 &lt;- within(burn1000, death &lt;- factor(death, levels=c("Dead","Alive")))
upper &lt;- ~ age + gender + race + tbsa + inh_inj + flame + age*inh_inj + tbsa*inh_inj
fit2 &lt;- glm(death ~ age + gender + race + tbsa + inh_inj, family=binomial("logit"), data=burn1000)
stepCriterion(fit2, direction="backward", criterion="bic", scope=list(upper=upper),force.in=~tbsa)
stepCriterion(fit2, direction="forward", criterion="p-value", test="score")

###### Example 3: Skin cancer in women
data(skincancer)
upper &lt;- cases ~ city + age + city*age
fit3 &lt;- glm(upper, family=poisson("log"), offset=log(population), data=skincancer)
stepCriterion(fit3, direction="backward", criterion="aic", scope=list(lower=~ 1,upper=upper))
stepCriterion(fit3, direction="forward", criterion="p-value", test="lr")
</code></pre>

<hr>
<h2 id='stepCriterion.glmgee'>Variable selection in Generalized Estimating Equations</h2><span id='topic+stepCriterion.glmgee'></span>

<h3>Description</h3>

<p>Performs variable selection in generalized estimating equations using hybrid versions of forward stepwise
and backward stepwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmgee'
stepCriterion(
  model,
  criterion = c("p-value", "qic", "qicu", "agpc", "sgpc"),
  test = c("wald", "score"),
  direction = c("forward", "backward"),
  levels = c(0.05, 0.05),
  trace = TRUE,
  scope,
  digits = max(3, getOption("digits") - 2),
  varest = c("robust", "df-adjusted", "model", "bias-corrected"),
  force.in,
  force.out,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepCriterion.glmgee_+3A_model">model</code></td>
<td>
<p>an object of the class <code>glmgee</code> which is obtained from the fit of a generalized estimating equation.</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_criterion">criterion</code></td>
<td>
<p>an (optional) character string indicating the criterion which should be used to compare the candidate
models. The available options are: QIC (&quot;qic&quot;), QICu (&quot;qicu&quot;), Akaike-type penalized gaussian pseudo-likelihood criterion (&quot;agpc&quot;),
Schwarz-type penalized gaussian pseudo-likelihood criterion (&quot;sgpc&quot;) and <em>p</em>-value of the <code>test</code> test (&quot;p-value&quot;). By
default, <code>criterion</code> is set to &quot;p-value&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_test">test</code></td>
<td>
<p>an (optional) character string indicating the statistical test which should be used to compare nested
models. The available options are: Wald (&quot;wald&quot;) and generalized score (&quot;score&quot;) tests. As default, <code>test</code> is
set to &quot;wald&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_direction">direction</code></td>
<td>
<p>an (optional) character string indicating the type of procedure which should be used. The available
options are: hybrid backward stepwise (&quot;backward&quot;) and hybrid forward stepwise (&quot;forward&quot;). As default, <code>direction</code>
is set to &quot;forward&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_levels">levels</code></td>
<td>
<p>an (optional) two-dimensional vector of values in the interval <code class="reqn">(0,1)</code> indicating the levels at which
the variables should in and out from the model. This is only appropiate if <code>criterion</code>=&quot;p-value&quot;. By default,
<code>levels</code> is set to <code>c(0.05,0.05)</code>.</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical switch indicating if should the stepwise reports be printed. By default,
<code>trace</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_scope">scope</code></td>
<td>
<p>an (optional) list, containing components <code>lower</code> and <code>upper</code>, both formula-type objects,
indicating the range of models which should be examined in the stepwise search. As default, <code>lower</code> is a model
with no predictors and <code>upper</code> is the linear predictor of the model in <code>model</code>.</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_digits">digits</code></td>
<td>
<p>an (optional) integer indicating the number of digits which should be used to print the most of the
criteria to compare the candidate models. As default, <code>digits</code> is set to <code>max(3, getOption("digits") - 2)</code>.</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_varest">varest</code></td>
<td>
<p>an (optional) character string indicating the type of estimator which should be used to the variance-covariance matrix of the interest parameters in the Wald-type test. The available options are: robust sandwich-type estimator (&quot;robust&quot;), degrees-of-freedom-adjusted estimator (&quot;df-adjusted&quot;), bias-corrected estimator (&quot;bias-corrected&quot;), and the model-based or naive estimator (&quot;model&quot;). As default, <code>varest</code> is set to &quot;robust&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_force.in">force.in</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in all models</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_force.out">force.out</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in no models</p>
</td></tr>
<tr><td><code id="stepCriterion.glmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. For example, <code>k</code>, that is, the magnitude of the
penalty in the AGPC, which by default is set to 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which contains the following objects:
</p>

<dl>
<dt><code>initial</code></dt><dd><p> a character string indicating the linear predictor of the &quot;initial model&quot;.</p>
</dd>
<dt><code>direction</code></dt><dd><p> a character string indicating the type of procedure which was used.</p>
</dd>
<dt><code>criterion</code></dt><dd><p> a character string indicating the criterion used to compare the candidate models.</p>
</dd>
<dt><code>final</code></dt><dd><p> a character string indicating the linear predictor of the &quot;final model&quot;.</p>
</dd>
<dt><code>final.fit</code></dt><dd><p> an object of class <code>glmgee</code> with the results of the fit to the data of the &quot;final model&quot;.</p>
</dd></dl>
<p>'

</p>


<h3>References</h3>

<p>James G., Witten D., Hastie T., Tibshirani R. (2013, page 210) <em>An Introduction to Statistical Learning
with Applications in R</em>. Springer, New York.
</p>
<p>Jianwen X., Jiamao Z., Liya F. (2019) Variable selection in generalized estimating equations via empirical
likelihood and Gaussian pseudo-likelihood. <em>Communications in Statistics - Simulation and Computation</em> 48:1239-1250.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+stepCriterion.lm">stepCriterion.lm</a>, <a href="#topic+stepCriterion.glm">stepCriterion.glm</a>, <a href="#topic+stepCriterion.overglm">stepCriterion.overglm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod &lt;- size ~ poly(days,4)*treat
fit1 &lt;- glmgee(mod, id=tree, family=Gamma(log), data=spruces, corstr="AR-M-dependent")
stepCriterion(fit1, criterion="p-value", direction="forward", scope=list(upper=mod),force.in=~treat)

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod &lt;- depressd ~ visit*group
fit2 &lt;- glmgee(mod, id=subj, family=binomial(probit), corstr="AR-M-dependent", data=depression)
stepCriterion(fit2, criterion="agpc", direction="forward", scope=list(upper=mod),force.in=~group)

###### Example 3: Treatment for severe postnatal depression (2)
mod &lt;- dep ~ visit*group
fit2 &lt;- glmgee(mod, id=subj, family=gaussian(identity), corstr="AR-M-dependent", data=depression)
stepCriterion(fit2, criterion="sgpc", direction="forward", scope=list(upper=mod),force.in=~group)

</code></pre>

<hr>
<h2 id='stepCriterion.lm'>Variable Selection in Normal Linear Models</h2><span id='topic+stepCriterion.lm'></span>

<h3>Description</h3>

<p>Performs variable selection in normal linear models using a hybrid versions of forward stepwise and backward stepwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
stepCriterion(
  model,
  criterion = c("bic", "aic", "adjr2", "prdr2", "cp", "p-value"),
  direction = c("forward", "backward"),
  levels = c(0.05, 0.05),
  trace = TRUE,
  scope,
  force.in,
  force.out,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepCriterion.lm_+3A_model">model</code></td>
<td>
<p>an object of the class <em>lm</em>.</p>
</td></tr>
<tr><td><code id="stepCriterion.lm_+3A_criterion">criterion</code></td>
<td>
<p>an (optional) character string indicating the criterion which should be used to compare the candidate models. The available options are: AIC (&quot;aic&quot;), BIC (&quot;bic&quot;), adjusted R-squared (&quot;adjr2&quot;), predicted R-squared (&quot;prdr2&quot;), Mallows' CP (&quot;cp&quot;) and <em>p</em>-value of the F test (&quot;p-value&quot;). As default, <code>criterion</code> is set to &quot;bic&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.lm_+3A_direction">direction</code></td>
<td>
<p>an (optional) character string indicating the type of procedure which should be used. The available options are: hybrid backward stepwise (&quot;backward&quot;) and hybrid forward stepwise (&quot;forward&quot;). As default, <code>direction</code> is set to &quot;forward&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.lm_+3A_levels">levels</code></td>
<td>
<p>an (optional) two-dimensional vector of values in the interval <code class="reqn">(0,1)</code> indicating the levels at which the variables should in and out from the model. This is only appropiate if <code>criterion</code>=&quot;p-value&quot;. As default, <code>levels</code> is set to <code>c(0.05,0.05)</code>.</p>
</td></tr>
<tr><td><code id="stepCriterion.lm_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical switch indicating if should the stepwise reports be printed. As default, <code>trace</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="stepCriterion.lm_+3A_scope">scope</code></td>
<td>
<p>an (optional) list containing components <code>lower</code> and <code>upper</code>, both formula-type objects, indicating the range of models which should be examined in the stepwise search. As default, <code>lower</code> is a model with no predictors and <code>upper</code> is the linear predictor of the model in <code>model</code>.</p>
</td></tr>
<tr><td><code id="stepCriterion.lm_+3A_force.in">force.in</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in all models</p>
</td></tr>
<tr><td><code id="stepCriterion.lm_+3A_force.out">force.out</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in no models</p>
</td></tr>
<tr><td><code id="stepCriterion.lm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. For example, <code>k</code>, that is, the magnitude of the penalty in the AIC/QICu, which by default is set to 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;hybrid forward stepwise&quot; algorithm starts with the
simplest model (which may be chosen at the argument <code>scope</code>, and
As default, is a model whose parameters in the linear predictor,
except the intercept, if any, are set to 0), and then the candidate
models are built by hierarchically including effects in the linear
predictor, whose &quot;relevance&quot; and/or &quot;importance&quot; in the model fit is
assessed by comparing nested models (that is, by comparing the models
with and without the added effect) using a criterion previously
specified. If an effect is added to the equation, this strategy may
also remove any effect which, according to the previously specified
criteria, no longer provides an improvement in the model fit. That
process continues until no more effects are included or excluded. The
&quot;hybrid backward stepwise&quot; algorithm works similarly.
</p>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>initial</code> </td><td style="text-align: left;">  a character string indicating the linear predictor of the "initial model",</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>direction</code> </td><td style="text-align: left;">  a character string indicating the type of procedure which was used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>criterion</code> </td><td style="text-align: left;"> a character string indicating the criterion used to compare the candidate models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>final</code> </td><td style="text-align: left;"> a character string indicating the linear predictor of the "final model",</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>final.fit</code> </td><td style="text-align: left;"> an object of class <code>lm</code> with the results of the fit to the data of the "final model",</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>James G., Witten D., Hastie T., Tibshirani R. (2013, page 210) An Introduction to Statistical Learning with Applications in R, Springer, New York.
</p>


<h3>See Also</h3>

<p><a href="#topic+stepCriterion.glm">stepCriterion.glm</a>, <a href="#topic+stepCriterion.overglm">stepCriterion.overglm</a>, <a href="#topic+stepCriterion.glmgee">stepCriterion.glmgee</a>
</p>
<p><a href="#topic+stepCriterion.glm">stepCriterion.glm</a>, <a href="#topic+stepCriterion.overglm">stepCriterion.overglm</a>, <a href="#topic+stepCriterion.glmgee">stepCriterion.glmgee</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: New York air quality measurements
fit1 &lt;- lm(log(Ozone) ~ Solar.R + Temp + Wind, data=airquality)
scope=list(lower=~1, upper=~Solar.R*Temp*Wind)
stepCriterion(fit1, direction="forward", criterion="adjr2", scope=scope)
stepCriterion(fit1, direction="forward", criterion="bic", scope=scope)
stepCriterion(fit1, direction="forward", criterion="p-value", scope=scope)

###### Example 2: Fuel consumption of automobiles
fit2 &lt;- lm(mpg ~ log(hp) + log(wt) + qsec, data=mtcars)
scope=list(lower=~1, upper=~log(hp)*log(wt)*qsec)
stepCriterion(fit2, direction="backward", criterion="bic", scope=scope)
stepCriterion(fit2, direction="forward", criterion="cp", scope=scope)
stepCriterion(fit2, direction="backward", criterion="prdr2", scope=scope)

###### Example 3: Credit card balance
Credit &lt;- ISLR::Credit
fit3 &lt;- lm(Balance ~ Cards + Age + Rating + Income + Student + Limit, data=Credit)
stepCriterion(fit3, direction="forward", criterion="prdr2")
stepCriterion(fit3, direction="forward", criterion="cp")
stepCriterion(fit3, direction="forward", criterion="p-value")

</code></pre>

<hr>
<h2 id='stepCriterion.overglm'>Variable selection for alternatives to the Poisson and Binomial Regression Models under the presence of Overdispersion</h2><span id='topic+stepCriterion.overglm'></span>

<h3>Description</h3>

<p>Performs variable selection using hybrid versions of forward stepwise and backward stepwise by comparing
hierarchically builded candidate models using a criterion previously specified such as AIC, BIC or <code class="reqn">p</code>-value of the
significance tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'overglm'
stepCriterion(
  model,
  criterion = c("bic", "aic", "p-value"),
  test = c("wald", "score", "lr", "gradient"),
  direction = c("forward", "backward"),
  levels = c(0.05, 0.05),
  trace = TRUE,
  scope,
  force.in,
  force.out,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepCriterion.overglm_+3A_model">model</code></td>
<td>
<p>an object of the class <em>overglm</em>.</p>
</td></tr>
<tr><td><code id="stepCriterion.overglm_+3A_criterion">criterion</code></td>
<td>
<p>an (optional) character string which allows to specify the criterion which should be used to compare the
candidate models. The available options are: AIC (&quot;aic&quot;), BIC (&quot;bic&quot;), and <em>p</em>-value of the <code>test</code>-type test
(&quot;p-value&quot;). As default, <code>criterion</code> is set to &quot;bic&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.overglm_+3A_test">test</code></td>
<td>
<p>an (optional) character string which allows to specify the statistical test which should be used to compare nested
models. The available options are: Wald (&quot;wald&quot;), Rao's score (&quot;score&quot;), likelihood-ratio (&quot;lr&quot;) and gradient
(&quot;gradient&quot;) tests. As default, <code>test</code> is set to &quot;wald&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.overglm_+3A_direction">direction</code></td>
<td>
<p>an (optional) character string which allows to specify the type of procedure which should be used. The available
options are: hybrid backward stepwise (&quot;backward&quot;) and hybrid forward stepwise (&quot;forward&quot;). As default, <code>direction</code>
is set to &quot;forward&quot;.</p>
</td></tr>
<tr><td><code id="stepCriterion.overglm_+3A_levels">levels</code></td>
<td>
<p>an (optional) two-dimensional vector of values in the interval <code class="reqn">(0,1)</code> indicating the levels at which
the variables should in and out from the model. This is only appropiate if <code>criterion</code>=&quot;p-value&quot;. By default,
<code>levels</code> is set to <code>c(0.05,0.05)</code>.</p>
</td></tr>
<tr><td><code id="stepCriterion.overglm_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical switch indicating if should the stepwise reports be printed. By default,
<code>trace</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="stepCriterion.overglm_+3A_scope">scope</code></td>
<td>
<p>an (optional) list, containing components <code>lower</code> and <code>upper</code>, both formula-type objects,
indicating the range of models which should be examined in the stepwise search. As default, <code>lower</code> is a model
with no predictors and <code>upper</code> is the linear predictor of the model in <code>model</code>.</p>
</td></tr>
<tr><td><code id="stepCriterion.overglm_+3A_force.in">force.in</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in all models</p>
</td></tr>
<tr><td><code id="stepCriterion.overglm_+3A_force.out">force.out</code></td>
<td>
<p>an (optional) formula-type object indicating the effects that should be in no models</p>
</td></tr>
<tr><td><code id="stepCriterion.overglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. For example, <code>k</code>, that is, the magnitude of the
penalty in the AIC, which by default is set to 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which contains the following objects:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>initial</code> </td><td style="text-align: left;"> a character string indicating the linear predictor of the "initial model",</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>direction</code></td><td style="text-align: left;"> a character string indicating the type of procedure which was used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>criterion</code></td><td style="text-align: left;"> a character string indicating the criterion used to compare the candidate models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>final</code></td><td style="text-align: left;"> a character string indicating the linear predictor of the "final model",</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>final.fit</code> </td><td style="text-align: left;"> an object of class <code>overglm</code> with the results of the fit to the data of the "final model",</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>James G., Witten D., Hastie T., Tibshirani R. (2013, page 210) An Introduction to Statistical Learning
with Applications in R. Springer, New York.
</p>


<h3>See Also</h3>

<p><a href="#topic+stepCriterion.lm">stepCriterion.lm</a>, <a href="#topic+stepCriterion.glm">stepCriterion.glm</a>, <a href="#topic+stepCriterion.glmgee">stepCriterion.glmgee</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- overglm(infections ~ age + gender + frequency + location, family="nb1(log)", data=swimmers)

stepCriterion(fit1, criterion="p-value", direction="forward", test="lr")

stepCriterion(fit1, criterion="bic", direction="backward", test="score", force.in=~location)

###### Example 2: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit2 &lt;- overglm(art ~ fem + mar + kid5 + phd + ment, family="nb1(log)", data = bioChemists)

stepCriterion(fit2, criterion="p-value", direction="forward", test="lr")

stepCriterion(fit2, criterion="bic", direction="backward", test="score", force.in=~fem)

###### Example 3: Agents to stimulate cellular differentiation
data(cellular)
fit3 &lt;- overglm(cbind(cells,200-cells) ~ tnf + ifn + tnf*ifn, family="bb(logit)", data=cellular)

stepCriterion(fit3, criterion="p-value", direction="backward", test="lr")

stepCriterion(fit3, criterion="bic", direction="forward", test="score")

</code></pre>

<hr>
<h2 id='swimmers'>Self diagnozed ear infections in swimmers</h2><span id='topic+swimmers'></span>

<h3>Description</h3>

<p>A pilot surf/health study was conducted by NSW Water
Board in 1990 on 287 recruits. The objective of the study was to
determine whether beach swimmers run an increased risk of contracting
ear infections than non-beach swimmers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(swimmers)
</code></pre>


<h3>Format</h3>

<p>A data frame with 287 rows and 5 variables:
</p>

<dl>
<dt>frequency</dt><dd><p>a factor giving the recruit's perception of whether he or she is a frequent swimmer: &quot;frequent&quot; and &quot;occasional&quot;.</p>
</dd>
<dt>location</dt><dd><p>a factor giving the recruit's usually chosen swimming location: &quot;beach&quot; and &quot;non-beach&quot;.</p>
</dd>
<dt>age</dt><dd><p>a factor giving the recruit's age range: &quot;15-19&quot;, &quot;20-24&quot; and &quot;25-29&quot;.</p>
</dd>
<dt>gender</dt><dd><p>a factor giving the recruit's gender: &quot;male&quot; and &quot;female&quot;.</p>
</dd>
<dt>infections</dt><dd><p>a numeric vector giving the number of self diagnozed
ear infections that were reported by the recruit.</p>
</dd>
</dl>



<h3>References</h3>

<p>Hand D.J., Daly F., Lunn A.D., McConway K.J., Ostrowsky E. (1994)
<em>A Handbook of Small Data Sets</em>, Chapman and Hall, London.
</p>
<p>Vanegas L.H., Rondon L.M. (2020) A data transformation to deal with
constant under/over-dispersion in binomial and poisson regression models. <em>Journal
of Statistical Computation and Simulation</em> 90:1811-1833.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swimmers)
dev.new()
boxplot(infections ~ frequency, data=subset(swimmers,location=="non-beach"),
        at=c(1:2) - 0.2, col="yellow", boxwex=0.25, xaxt="n")
boxplot(infections ~ frequency, data=subset(swimmers,location=="beach"), add=TRUE,
        at=c(1:2) + 0.2, col="blue", boxwex=0.25, xaxt="n")
axis(1, at=c(1:2), labels=levels(swimmers$frequency))
legend("topleft", title="Location",legend=c("non-beach","beach"),
       fill=c("yellow","blue"),bty="n")
</code></pre>

<hr>
<h2 id='Trajan'>Roots Produced by the Columnar Apple Cultivar Trajan.</h2><span id='topic+Trajan'></span>

<h3>Description</h3>

<p>The data arose from a horticultural experiment to study
the number of roots produced by 270 micropropagated shoots of the
columnar apple cultivar Trajan. During the rooting period, all shoots
were maintained under identical conditions. However, the shoots
themselves were cultured on media containing different concentrations
of the cytokinin 6-benzylaminopurine (BAP), in growth cabinets with
an 8 or 16 hour photoperiod. The objective is to assess the effect
of both the photoperiod and BAP concentration levels on the number
of roots produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trajan)
</code></pre>


<h3>Format</h3>

<p>A data frame with 270 rows and 4 variables:
</p>

<dl>
<dt>roots</dt><dd><p>a numeric vector indicating the number of roots produced.</p>
</dd>
<dt>shoot</dt><dd><p>a numeric vector indicating the number of micropropogated shoots.</p>
</dd>
<dt>photoperiod</dt><dd><p>a factor indicating the photoperiod, in hours: 8 or 16.</p>
</dd>
<dt>bap</dt><dd><p>a numeric vector indicating the concentrations of the cytokinin 6-benzylaminopurine: 2.2, 4.4, 8.8 or 17.6.</p>
</dd>
</dl>



<h3>References</h3>

<p>Ridout M., Demétrio C.G., Hinde J. (1998). Models for count data with many zeros. In
<em>Proceedings of the XIXth international biometric conference</em>, 179–192.
</p>
<p>Ridout M., Hinde J., Demétrio C.G. (2001). A score test for testing a zero-inflated
Poisson regression model against zero-inflated negative binomial alternatives. <em>Biometrics</em>
57:219-223.
</p>
<p>Garay A.M., Hashimoto E.M., Ortega E.M.M., Lachos V. (2011). On estimation and
influence diagnostics for zero-inflated negative binomial regression models. <em>Computational
Statistics &amp; Data Analysis</em> 55:1304-1318.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Trajan)
dev.new()
boxplot(roots ~ bap, data=subset(Trajan,photoperiod=="8"), at=c(1:4) - 0.15,
        col="blue", boxwex=0.2, xaxt="n", ylim=c(-0.5,17))
boxplot(roots ~ bap, data=subset(Trajan,photoperiod=="16"), add=TRUE,
        at=c(1:4) + 0.15, col="yellow", boxwex=0.2, xaxt="n")
axis(1, at=c(1:4), labels=levels(Trajan$bap))
legend("topright", legend=c("8","16"), title="Photoperiod", bty="n",
       fill=c("blue","yellow"))

</code></pre>

<hr>
<h2 id='uti'>Urinary Tract Infections in HIV-infected Men</h2><span id='topic+uti'></span>

<h3>Description</h3>

<p>These data arose from a study conducted in the Department
of Internal Medicine at Utrecht University Hospital, in the
Netherlands. In this study, 98 HIV-infected men were followed for
up to two years. Urinary cultures were obtained during the first
visit and every six months thereafter. Also, cultures were obtained
between regular scheduled visits when signs and symptoms of urinary
tract infections (UTI) occurred, or when patients had a fever of
unknown origin. CD4+ cell counts were also measured. A CD4+ count
is a blood test to determine how well the immune system works in
people diagnosed with HIV. In general, a decreasing CD4+ count
indicates HIV progression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(uti)
</code></pre>


<h3>Format</h3>

<p>A data frame with 98 rows and 3 variables:
</p>

<dl>
<dt>episodes</dt><dd><p>a numeric vector indicating the number of episodes, that is, the number of times each patient had urinary tract infections (UTI).</p>
</dd>
<dt>time</dt><dd><p>a numeric vector indicating the time to follow up, in months.</p>
</dd>
<dt>cd4</dt><dd><p>a numeric vector indicating the immune status of the patient as measured by the CD4+ cell counts.</p>
</dd>
</dl>



<h3>References</h3>

<p>Hoepelman A.I.M., Van Buren M., Van den Broek J., Borleffs J.C.C. (1992) Bacteriuria
in men infected with HIV-1 is related to their immune status (CD4+ cell count). <em>AIDS</em> 6:179-184.
</p>
<p>Morel J.G., Nagaraj N.K. (2012) <em>Overdispersion Models in SAS</em>. SAS Institute Inc.,
Cary, North Carolina, USA.
</p>
<p>van den Broek J. (1995) A Score Test for Zero Inflation in a Poisson Distribution.
<em>Biometrics</em> 51:738–743.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(uti)
dev.new()
uti2 &lt;- within(uti,cd4C &lt;- cut(log(cd4),4,labels=c("low","mid-low","mid-high","high")))
out &lt;- aggregate(cbind(episodes,time) ~ cd4C, sum, data=uti2)
barplot(12*episodes/time ~ cd4C, beside=TRUE, data=out, col="red",
        xlab="CD4+ cell count", ylab="Number of UTIs per year")

</code></pre>

<hr>
<h2 id='vcov.glmgee'>Estimate of the variance-covariance matrix in GEEs</h2><span id='topic+vcov.glmgee'></span>

<h3>Description</h3>

<p>Computes the type-<code>type</code> estimate of the variance-covariance matrix from an object of the class glmgee.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmgee'
vcov(
  object,
  ...,
  type = c("robust", "df-adjusted", "model", "bias-corrected", "jackknife")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.glmgee_+3A_object">object</code></td>
<td>
<p>An object of the class <em>glmgee</em>.</p>
</td></tr>
<tr><td><code id="vcov.glmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="vcov.glmgee_+3A_type">type</code></td>
<td>
<p>an (optional) character string indicating the type of estimator which should be used. The available options are: robust sandwich-type estimator (&quot;robust&quot;), degrees-of-freedom-adjusted estimator (&quot;df-adjusted&quot;), bias-corrected estimator (&quot;bias-corrected&quot;), and the model-based or naive estimator (&quot;model&quot;). As default, <code>type</code> is set to &quot;robust&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> with the type-<code>type</code> estimate of the variance-covariance matrix.
</p>


<h3>References</h3>

<p>Mancl L.A., DeRouen T.A. (2001) A Covariance Estimator for GEE with Improved Small-Sample Properties. <em>Biometrics</em> 57:126-134.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Effect of ozone-enriched atmosphere on growth of sitka spruces
data(spruces)
mod &lt;- size ~ poly(days,4) + treat
fit1 &lt;- glmgee(mod, id=tree, family=Gamma(log), data=spruces, corstr="Exchangeable")
vcov(fit1)
vcov(fit1,type="bias-corrected")

###### Example 2: Treatment for severe postnatal depression
data(depression)
mod &lt;- depressd ~ visit + group
fit3 &lt;- glmgee(mod, id=subj, family=binomial(logit), corstr="AR-M-dependent", data=depression)
vcov(fit3)
vcov(fit3,type="bias-corrected")

###### Example 3: Treatment for severe postnatal depression (2)
mod &lt;- dep ~ visit*group
fit2 &lt;- glmgee(mod, id=subj, family=gaussian(identity), corstr="AR-M-dependent", data=depression)
vcov(fit2)
vcov(fit2,type="bias-corrected")

</code></pre>

<hr>
<h2 id='vdtest'>Test for Varying Dispersion Parameter</h2><span id='topic+vdtest'></span>

<h3>Description</h3>

<p>Generic function for testing for varying dispersion parameter from a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vdtest(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vdtest_+3A_model">model</code></td>
<td>
<p>a fitted model object.</p>
</td></tr>
<tr><td><code id="vdtest_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list which includes the main attributes of the test as, for example, value of the statistic and <em>p</em>-value.
</p>

<hr>
<h2 id='vdtest.glm'>Test for Varying Dispersion Parameter in Generalized Linear Models</h2><span id='topic+vdtest.glm'></span>

<h3>Description</h3>

<p>Performs Rao's score test for varying dispersion parameter in
weighted and unweighted generalized linear models in which the response
distribution is assumed to be Gaussian, Gamma, or inverse Gaussian.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
vdtest(model, varformula, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vdtest.glm_+3A_model">model</code></td>
<td>
<p>an object of the class <em>glm</em> where the distribution of the response
variable is assumed to be <code>gaussian</code>, <code>Gamma</code> or <code>inverse.gaussian</code>.</p>
</td></tr>
<tr><td><code id="vdtest.glm_+3A_varformula">varformula</code></td>
<td>
<p>an (optional) <code>formula</code> expression of the form <code>~ z1 + z2 + ... + zq</code> describing only the potential explanatory variables for the dispersion. As default, the same explanatory variables are taken as in the model for the mean.</p>
</td></tr>
<tr><td><code id="vdtest.glm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="vdtest.glm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From the generalized linear model with varying dispersion in which
<code class="reqn">\log(\phi)=\gamma_0 + \gamma_1z_1 + \gamma_2z_2 + ... + \gamma_qz_q</code>, where
<code class="reqn">\phi</code> is the dispersion parameter of the distribution used to describe the
response variable, the Rao's score test (denoted here as <code class="reqn">S</code>) to assess the
hypothesis <code class="reqn">H_0: \gamma=0</code> versus <code class="reqn">H_1: \gamma\neq 0</code> is computed,
where <code class="reqn">\gamma=(\gamma_1,\ldots,\gamma_q)</code>.  The corresponding <em>p</em>-value is
computed from the chi-squared distribution with <code class="reqn">q</code> degrees of freedom,
that is, <em>p</em>-value = Prob<code class="reqn">[\chi^2_{q} &gt; S]</code>. If the object <code>model</code>
corresponds to an unweighted generalized linear model, this test assesses assumptions
of constant variance and constant coefficient of variation on models in which the
response distribution is assumed to be Gaussian and Gamma, respectively.
</p>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>statistic</code> </td><td style="text-align: left;"> value of the Rao's score test (<code class="reqn">S</code>),</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>df</code>        </td><td style="text-align: left;"> number of degrees of freedom (<code class="reqn">q</code>),</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p.value</code>   </td><td style="text-align: left;"> <em>p</em>-value of the test,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vars</code>   </td><td style="text-align: left;"> names of explanatory variables for the dispersion parameter,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Wei B.-C., Shi, J.-Q., Fung W.-K., Hu Y.-Q. (1998) Testing for Varying Dispersion in Exponential Family Nonlinear Models. <em>Annals of the Institute of Statistical Mathematics</em> 50, 277–294.
</p>


<h3>See Also</h3>

<p><a href="#topic+vdtest.lm">vdtest.lm</a>, <a href="#topic+vdtest.gnm">vdtest.gnm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Fuel consumption of automobiles
Auto &lt;- ISLR::Auto
fit1 &lt;- glm(mpg ~ weight*horsepower, family=inverse.gaussian("log"), data=Auto)
vdtest(fit1)
vdtest(fit1,varformula= ~ weight + horsepower)
vdtest(fit1,varformula= ~ log(weight) + log(horsepower))

###### Example 2: Hill races in Scotland
data(races)
fit2 &lt;- glm(rtime ~ log(distance) + cclimb, family=Gamma("log"), data=races)
vdtest(fit2)
vdtest(fit2,varformula= ~ distance + cclimb)
vdtest(fit2,varformula= ~ log(distance) + log(cclimb))

###### Example 3: Mammal brain and body weights
data(brains)
fit3 &lt;- glm(BrainWt ~ log(BodyWt), family=Gamma("log"), data=brains)
vdtest(fit3)
vdtest(fit3,varformula= ~ BodyWt)
</code></pre>

<hr>
<h2 id='vdtest.gnm'>Test for Varying Dispersion Parameter in Generalized Nonlinear Models</h2><span id='topic+vdtest.gnm'></span>

<h3>Description</h3>

<p>Performs Rao's score test for varying dispersion parameter in
weighted and unweighted generalized nonlinear models in which the response
distribution is assumed to be Gaussian, Gamma, or inverse Gaussian.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnm'
vdtest(model, varformula, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vdtest.gnm_+3A_model">model</code></td>
<td>
<p>an object of the class <em>gnm</em> where the distribution of the response
variable is assumed to be <code>gaussian</code>, <code>Gamma</code> or <code>inverse.gaussian</code>.</p>
</td></tr>
<tr><td><code id="vdtest.gnm_+3A_varformula">varformula</code></td>
<td>
<p>an (optional) <code>formula</code> expression of the form <code>~ z1 + z2 + ... + zq</code> describing only the potential explanatory variables for the dispersion. As default, the same explanatory variables are taken as in the model for the mean.</p>
</td></tr>
<tr><td><code id="vdtest.gnm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="vdtest.gnm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From the generalized nonlinear model with varying dispersion in which
<code class="reqn">\log(\phi)=\gamma_0 + \gamma_1z_1 + \gamma_2z_2 + ... + \gamma_qz_q</code>, where
<code class="reqn">\phi</code> is the dispersion parameter of the distribution used to describe the
response variable, the Rao's score test (denoted here as <code class="reqn">S</code>) to assess the
hypothesis <code class="reqn">H_0: \gamma=0</code> versus <code class="reqn">H_1: \gamma\neq 0</code> is computed,
where <code class="reqn">\gamma=(\gamma_1,\ldots,\gamma_q)</code>.  The corresponding <em>p</em>-value is
computed from the chi-squared distribution with <code class="reqn">q</code> degrees of freedom,
that is, <em>p</em>-value = Prob<code class="reqn">[\chi^2_{q} &gt; S]</code>. If the object <code>model</code>
corresponds to an unweighted generalized linear model, this test assesses assumptions
of constant variance and constant coefficient of variation on models in which the
response distribution is assumed to be Gaussian and Gamma, respectively.
</p>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>statistic</code> </td><td style="text-align: left;"> value of the Rao's score test (<code class="reqn">S</code>),</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>df</code>        </td><td style="text-align: left;"> number of degrees of freedom (<code class="reqn">q</code>),</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p.value</code>   </td><td style="text-align: left;"> <em>p</em>-value of the test,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vars</code>   </td><td style="text-align: left;"> names of explanatory variables for the dispersion parameter,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Wei B.-C., Shi, J.-Q., Fung W.-K., Hu Y.-Q. (1998) Testing for Varying Dispersion in Exponential Family Nonlinear Models. <em>Annals of the Institute of Statistical Mathematics</em> 50, 277–294.
</p>


<h3>See Also</h3>

<p><a href="#topic+vdtest.lm">vdtest.lm</a>, <a href="#topic+vdtest.glm">vdtest.glm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: The effects of fertilizers on coastal Bermuda grass
data(Grass)
fit1 &lt;- gnm(Yield ~ b0 + b1/(Nitrogen + a1) + b2/(Phosphorus + a2) + b3/(Potassium + a3),
            family=gaussian(inverse), start=c(b0=0.1,b1=13,b2=1,b3=1,a1=45,a2=15,a3=30), data=Grass)
vdtest(fit1)
vdtest(fit1,varformula = ~ Nitrogen + Phosphorus + Potassium)

###### Example 2: Developmental rate of Drosophila melanogaster
data(Drosophila)
fit2 &lt;- gnm(Duration ~ b0 + b1*Temp + b2/(Temp-a), family=Gamma(log),
            start=c(b0=3,b1=-0.25,b2=-210,a=55), weights=Size, data=Drosophila)
vdtest(fit2)
vdtest(fit2,varformula = ~ Temp)
vdtest(fit2,varformula = ~ log(Temp))

###### Example 3: Radioimmunological Assay of Cortisol
data(Cortisol)
fit3 &lt;- gnm(Y ~ b0 + (b1-b0)/(1 + exp(b2+ b3*lDose))^b4, family=Gamma(identity),
            start=c(b0=130,b1=2800,b2=3,b3=3,b4=0.5), data=Cortisol)
vdtest(fit3)
vdtest(fit3,varformula = ~ lDose)
vdtest(fit3,varformula = ~ exp(lDose))

###### Example 4: Age and Eye Lens Weight of Rabbits in Australia
data(rabbits)
fit4 &lt;- gnm(wlens ~ b1 - b2/(age + b3), family=Gamma(log),
            start=c(b1=5.5,b2=130,b3=35), data=rabbits)
vdtest(fit4)
vdtest(fit4,varformula = ~ age)
vdtest(fit4,varformula = ~ log(age))
</code></pre>

<hr>
<h2 id='vdtest.lm'>Test for Varying Dispersion Parameter in Normal Linear Models</h2><span id='topic+vdtest.lm'></span>

<h3>Description</h3>

<p>Performs Rao's score test for varying dispersion parameter in weighted and unweighted normal linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
vdtest(model, varformula, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vdtest.lm_+3A_model">model</code></td>
<td>
<p>an object of the class <em>lm</em>.</p>
</td></tr>
<tr><td><code id="vdtest.lm_+3A_varformula">varformula</code></td>
<td>
<p>an (optional) <code>formula</code> expression of the form <code>~ z1 + z2 + ... + zq</code> indicating the potential explanatory variables for the dispersion parameter. As default, the same explanatory variables are taken as in the model for the mean.</p>
</td></tr>
<tr><td><code id="vdtest.lm_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="vdtest.lm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From the heteroskedastic normal linear model in which
<code class="reqn">\log(\sigma^2)=\gamma_0 + \gamma_1z_1 + \gamma_2z_2 + ...+ \gamma_qz_q</code>, where
<code class="reqn">\sigma^2</code> is the dispersion parameter of the distribution of the
random errors, the Rao's score test (denoted here as <code class="reqn">S</code>) to assess the
hypothesis <code class="reqn">H_0: \gamma=0</code> versus <code class="reqn">H_1: \gamma\neq 0</code> is computed,
where <code class="reqn">\gamma=(\gamma_1,\ldots,\gamma_q)</code>. The corresponding <em>p</em>-value is
computed from the chi-squared distribution with <code class="reqn">q</code> degrees of freedom,
that is, <em>p</em>-value = Prob<code class="reqn">[\chi^2_{q} &gt; S]</code>. If the object
<code>model</code> corresponds to an unweighted normal linear model, then the
test assess the assumption of constant variance, which coincides with the
non-studentized Breusch-Pagan test against heteroskedasticity.
</p>


<h3>Value</h3>

<p>a list list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>statistic</code> </td><td style="text-align: left;"> value of the Rao's score test (<code class="reqn">S</code>),</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>df</code>        </td><td style="text-align: left;"> number of degrees of freedom (<code class="reqn">q</code>),</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p.value</code>   </td><td style="text-align: left;"> <em>p</em>-value of the test,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vars</code>   </td><td style="text-align: left;"> names of explanatory variables for the dispersion parameter,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Breusch T.S., Pagan A.R. (1979) A simple test for heteroscedasticity and random coefficient variation. <em>Econometrica</em> 47, 1287–1294.
</p>
<p>Cook R.D., Weisberg S. (1983) Diagnostics for heteroscedasticity in regression. <em>Biometrika</em> 70, 1–10.
</p>


<h3>See Also</h3>

<p><a href="#topic+vdtest.glm">vdtest.glm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example 1: Fuel consumption of automobiles
fit1 &lt;- lm(mpg ~ log(hp) + log(wt), data=mtcars)
vdtest(fit1)
vdtest(fit1,varformula = ~ hp + wt)
vdtest(fit1,varformula = ~ hp + wt + hp*wt)

###### Example 2: Species richness in plots
data(richness)
fit2 &lt;- lm(Species ~ Biomass + pH, data=richness)
vdtest(fit2)

### The test conclusions change when the outlying observations are excluded
fit2a &lt;- lm(Species ~ Biomass + pH, data=richness, subset=-c(1,3,18,20))
vdtest(fit2a)

###### Example 3: Gas consumption in a home before and after insulation
whiteside &lt;- MASS::whiteside
fit3 &lt;- lm(Gas ~ Temp + Insul + Temp*Insul, data=whiteside)
vdtest(fit3)

### The test conclusions change when the outlying observations are excluded
fit3a &lt;- lm(Gas ~ Temp + Insul + Temp*Insul, data=whiteside, subset=-c(8,9,36,46,55))
vdtest(fit3a)

</code></pre>

<hr>
<h2 id='wglmgee'>Fit Weighted Generalized Estimating Equations</h2><span id='topic+wglmgee'></span>

<h3>Description</h3>

<p>Produces an object of the class <code>wglmgee</code> in which the main results of a Weighted Generalized Estimating Equation (WGEE) fitted to the data are stored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wglmgee(
  formula,
  level = c("observations", "clusters"),
  family = gaussian(),
  weights,
  id,
  data,
  subset,
  corstr,
  corr,
  start = NULL,
  scale.fix = FALSE,
  scale.value = 1,
  toler = 1e-05,
  maxit = 50,
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wglmgee_+3A_formula">formula</code></td>
<td>
<p>an <code>Formula</code> expression of the form <code>response ~ x1 + x2 + ... | z1 + z2 + ...</code>, whose first part is a symbolic description of the linear predictor of the GEE model to be fitted to the data, whereas the second part is a symbolic description of the linear predictor of the logistic model to be used to calculate the missingness probabilities under the MAR assumption. Then, those probabilities are used to computed the weights to be included in the parameter estimation algorithm.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_level">level</code></td>
<td>
<p>an (optional) character string which allows to specify the weighted GEE method. The available options are: &quot;observations&quot; and &quot;clusters&quot; for Observation- and Cluster-specified Weighted GEE, respectively. As default, <em>level</em> is set to &quot;observations&quot;.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_family">family</code></td>
<td>
<p>an (optional) <code>family</code> object, that is, a list of functions and expressions for defining link and variance functions. Families (and links) supported are the same supported by <a href="stats.html#topic+glm">glm</a> using its <a href="stats.html#topic+family">family</a> argument, that is,
<code>gaussian</code>, <code>binomial</code>, <code>poisson</code>, <code>Gamma</code>, <code>inverse.gaussian</code>, and <code>quasi</code>. The family <code>negative.binomial</code> in the library <span class="pkg">MASS</span> are also available. As default, the argument <code>family</code> is set to <code>gaussian(identity)</code>.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_weights">weights</code></td>
<td>
<p>an (optional) vector of positive &quot;prior weights&quot; to be used in the fitting process. The length of <code>weights</code> should be the same as the total number of observations.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_id">id</code></td>
<td>
<p>a vector which identifies the subjects or clusters. The length of <code>id</code> should be the same as the number of observations.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_data">data</code></td>
<td>
<p>an (optional) <code>data frame</code> in which to look for variables involved in the <code>formula</code> expression, as well as for variables specified in the arguments <code>id</code> and <code>weights</code>. The data are assumed to be sorted by <code>id</code> and time.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_subset">subset</code></td>
<td>
<p>an (optional) vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_corstr">corstr</code></td>
<td>
<p>an (optional) character string which allows to specify the working-correlation structure. The available options are: &quot;Independence&quot;, &quot;Unstructured&quot;, &quot;Stationary-M-dependent(<em>m</em>)&quot;, &quot;Non-Stationary-M-dependent(<em>m</em>)&quot;, &quot;AR-M-dependent(<em>m</em>)&quot;, &quot;Exchangeable&quot; and &quot;User-defined&quot;, where <em>m</em> represents the lag of the dependence. As default, <code>corstr</code> is set to &quot;Independence&quot;.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_corr">corr</code></td>
<td>
<p>an (optional) square matrix of the same dimension of the maximum cluster size containing the user specified correlation. This is only appropriate if <code>corstr</code> is specified to be &quot;User-defined&quot;.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_start">start</code></td>
<td>
<p>an (optional) vector of starting values for the parameters in the linear predictor.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_scale.fix">scale.fix</code></td>
<td>
<p>an (optional) logical variable. If TRUE, the scale parameter is fixed at the value of <code>scale.value</code>. As default, <code>scale.fix</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_scale.value">scale.value</code></td>
<td>
<p>an (optional) numeric value at which the scale parameter should be fixed. This is only appropriate if <code>scale.fix=TRUE</code>. As default, <code>scale.value</code> is set to 1.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_toler">toler</code></td>
<td>
<p>an (optional) positive value which represents the <em>convergence tolerance</em>. The convergence is reached when the maximum of the absolute relative differences between the values of the parameters in the linear predictor in consecutive iterations of the fitting algorithm is lower than <code>toler</code>. As default, <code>toler</code> is set to 0.00001.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_maxit">maxit</code></td>
<td>
<p>an (optional) integer value which represents the maximum number of iterations allowed for the fitting algorithm. As default, <code>maxit</code> is set to 50.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_trace">trace</code></td>
<td>
<p>an (optional) logical variable. If TRUE, output is produced for each iteration of the estimating algorithm.</p>
</td></tr>
<tr><td><code id="wglmgee_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values of the multivariate response variable measured on <code class="reqn">n</code> subjects or clusters,
denoted by <code class="reqn">y_{i}=(y_{i1},\ldots,y_{in_i})^{\top}</code> for <code class="reqn">i=1,\ldots,n</code>, are assumed to be
realizations of independent random vectors denoted by <code class="reqn">Y_{i}=(Y_{i1},\ldots,Y_{in_i})^{\top}</code>
for <code class="reqn">i=1,\ldots,n</code>. The random variables associated to the <code class="reqn">i</code>-th subject or
cluster, <code class="reqn">Y_{ij}</code> for <code class="reqn">j=1,\ldots,n_i</code>, are assumed to satisfy
<code class="reqn">\mu_{ij}=</code> E<code class="reqn">(Y_{ij})</code>,Var<code class="reqn">(Y_{ij})=\frac{\phi}{\omega_{ij}}</code>V<code class="reqn">(\mu_{ij})</code>
and Corr<code class="reqn">(Y_{ij},Y_{ik})=r_{jk}(\rho)</code>,
where <code class="reqn">\phi&gt;0</code> is the dispersion parameter,
V<code class="reqn">(\mu_{ij})</code> is the variance function, <code class="reqn">\omega_{ij}&gt;0</code> is a known weight, and
<code class="reqn">\rho=(\rho_1,\ldots,\rho_q)^{\top}</code> is a parameter vector.
In addition, <code class="reqn">\mu_{ij}</code> is assumed to be dependent on the regressors vector <code class="reqn">x_{ij}</code>
by <code class="reqn">g(\mu_{ij})=z_{ij} + x_{ij}^{\top}\beta</code>, where <code class="reqn">g(\cdot)</code> is the link function,
<code class="reqn">z_{ij}</code> is a known <em>offset</em> and <code class="reqn">\beta=(\beta_1,\ldots,\beta_p)^{\top}</code> is
a vector of regression parameters. The probabilities <code class="reqn">Pr[T_{ij}=1|T_{i,j-1}=1,x_{i1},\ldots,x_{ij},Y_{i1},\ldots,Y_{i,j-1}]</code>
are estimated by using a logistic model whose covariates are given by <code class="reqn">z_{1},\ldots,z_{r}</code>. Then, those
probabilities are used to computed the weights to be included in the parameter estimation algorithm.
</p>
<p>A set of standard extractor functions for fitted model objects is available for objects of class  <em>glmgee</em>,
including methods to the generic functions such as <code>print</code>, <code>summary</code>,	<code>model.matrix</code>, <code>estequa</code>,
<code>coef</code>, <code>vcov</code>, <code>fitted</code>, <code>confint</code> and <code>predict</code>. The input data are assumed to be ordered
in time within each cluster.
</p>


<h3>Value</h3>

<p>an object of class <em>wglmgee</em> in which the main results of the weighted GEE model fitted to the data are stored,
i.e., a list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>coefficients</code> </td><td style="text-align: left;"> a vector with the estimates of <code class="reqn">\beta_1,\ldots,\beta_p</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>fitted.values</code></td><td style="text-align: left;"> a vector with the estimates of <code class="reqn">\mu_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>start</code>        </td><td style="text-align: left;"> a vector with the starting values used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>iter</code>         </td><td style="text-align: left;"> a numeric constant with the number of iterations,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>prior.weights</code></td><td style="text-align: left;"> a vector with the values of <code class="reqn">\omega_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>offset</code>       </td><td style="text-align: left;"> a vector with the values of <code class="reqn">z_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>terms</code>        </td><td style="text-align: left;"> an object containing the terms objects,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>estfun</code>       </td><td style="text-align: left;"> a vector with the estimating equations evaluated at the parameter</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> estimates and the observed data,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>formula</code>      </td><td style="text-align: left;"> the formula,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>levels</code>       </td><td style="text-align: left;"> the levels of the categorical regressors,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>contrasts</code>    </td><td style="text-align: left;"> an object containing the contrasts corresponding to levels,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>converged</code>    </td><td style="text-align: left;"> a logical indicating successful convergence,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>model</code>        </td><td style="text-align: left;"> the full model frame,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code>            </td><td style="text-align: left;"> a vector with the values of <code class="reqn">y_{ij}</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>family</code>       </td><td style="text-align: left;"> an object containing the <a href="stats.html#topic+family">family</a> object used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>linear.predictors</code> </td><td style="text-align: left;"> a vector with the estimates of <code class="reqn">g(\mu_{ij})</code> for <code class="reqn">i=1,\ldots,n</code> and <code class="reqn">j=1,\ldots,n_i</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R</code>            </td><td style="text-align: left;"> a matrix with the (robust) estimate of the variance-covariance,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>corr</code>         </td><td style="text-align: left;"> a matrix with the estimate of the working-correlation,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>corstr</code>       </td><td style="text-align: left;"> a character string specifying the working-correlation structure,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>level</code>        </td><td style="text-align: left;"> a character string specifying the weighted GEE method,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>id</code>           </td><td style="text-align: left;"> a vector which identifies the subjects or clusters,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sizes</code>        </td><td style="text-align: left;"> a vector with the values of <code class="reqn">n_i</code> for <code class="reqn">i=1,\ldots,n</code>,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>call</code>         </td><td style="text-align: left;"> the original function call,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Fitzmaurice G.M., Laird N.M., Ware J.H. (2011). <em>Applied Longitudinal Analysis. 2nd ed.</em> John Wiley &amp; Sons.
</p>
<p>Preisser J.S., Lohman K.K., Rathouz P.J. (2002). Performance of Weighted Estimating Equations for
Longitudinal Binary Data with Drop-Outs Missing at Random. <em>Statistics in Medicine</em> 21:3035–3054.
</p>
<p>Robins J.M., Rotnitzky A., Zhao L.P. (1995) Analysis of Semiparametric Regression Models for Repeated
Outcomes in the Presence of Missing Data. <em>Journal of the American Statistical Association</em> 90:122–129.
</p>
<p><a href="https://journal.r-project.org/articles/RJ-2023-056/">Vanegas L.H., Rondon L.M., Paula G.A. (2023) Generalized Estimating Equations using the new R package glmtoolbox.
<em>The R Journal</em> 15:105-133.</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+glmgee">glmgee</a>, <a href="#topic+gnmgee">gnmgee</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###### Example: Amenorrhea rates over time
data(amenorrhea)
amenorrhea2 &lt;- within(amenorrhea,{
							 Ctime &lt;- factor(Time)
							 Ctime &lt;- relevel(Ctime,ref="1")
							 ylag1 &lt;- c(0,amenorrhea[-length(ID)])
							 ylag1 &lt;- ifelse(Time==0,0,ylag1)})

mod &lt;- amenorrhea ~ poly(Time,2) + Dose | Ctime + Dose + ylag1

### Observation-specified Weighted GEE
fit1 &lt;- wglmgee(mod, family=binomial, data=amenorrhea2, id=ID,
                corstr="AR-M-dependent(1)", level="observations")
summary(fit1)

### Cluster-specified Weighted GEE
fit2 &lt;- wglmgee(mod, family=binomial, data=amenorrhea2, id=ID,
                corstr="Exchangeable", level="clusters")
summary(fit2)

</code></pre>

<hr>
<h2 id='zero.excess'>Test for zero-excess in Count Regression Models</h2><span id='topic+zero.excess'></span>

<h3>Description</h3>

<p>Allows to assess if the observed number of zeros is significantly higher than expected according to the fitted count regression model (poisson or negative binomial).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zero.excess(
  object,
  alternative = c("excess", "lack", "both"),
  method = c("boot", "naive"),
  rep = 100,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zero.excess_+3A_object">object</code></td>
<td>
<p>an object of the class <code>glm</code>, for poisson regression models, or an object of the class <code>overglm</code>, for negative binomial regression models.</p>
</td></tr>
<tr><td><code id="zero.excess_+3A_alternative">alternative</code></td>
<td>
<p>an (optional) character string indicating the alternative hypothesis. There are three options: excess of zeros (&quot;excess&quot;), lack of zeros (&quot;lack&quot;), and both (&quot;both&quot;). As a default, <code>type</code> is set to &quot;excess&quot;.</p>
</td></tr>
<tr><td><code id="zero.excess_+3A_method">method</code></td>
<td>
<p>an (optional) character string indicating the method to calculate the mean and variance of the difference between observed and estimated expected number of zeros. There are two options: parametric bootstrapping (&quot;boot&quot;) and naive (&quot;naive&quot;). As a default, <code>type</code> is set to &quot;boot&quot;.</p>
</td></tr>
<tr><td><code id="zero.excess_+3A_rep">rep</code></td>
<td>
<p>an (optional) positive integer which allows to specify the number of replicates which should be used by the parametric bootstrapping. As a default, <code>rep</code> is set to 100.</p>
</td></tr>
<tr><td><code id="zero.excess_+3A_verbose">verbose</code></td>
<td>
<p>an (optional) logical switch indicating if should the report of results be printed. As a default, <code>verbose</code> is set to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>According to the formulated count regression model, we have that <code class="reqn">Y_i\sim P(y;\mu_i,\phi)</code>
for <code class="reqn">i=1,\ldots,n</code> are independent variables. Consequently, the expected number of zeros can
be estimated by <code class="reqn">P(0;\hat{\mu}_i,\hat{\phi})</code> for <code class="reqn">i=1,\ldots,n</code>, where <code class="reqn">\hat{\mu}_i</code>
and <code class="reqn">\hat{\phi}</code> represent the estimates of <code class="reqn">\mu_i</code> and <code class="reqn">\phi</code>, respectively, obtained
from the fitted model. Thus, the statistical test can be defined as the standardized difference
between the observed and (estimated) expected number of zeros. The standard normal distribution
tends to be the distribution of that statistic when the sample size, <code class="reqn">n</code>, tends to infinity.
In He, Zhang, Ye, and Tang (2019), the above approach is called a naive test since it ignores the
sampling variation associated with the estimated model parameters. To correct this, parametric
bootstrapping is used to estimate the mean and variance of the difference between the (estimated)
expected and observed number of zeros.
</p>


<h3>Value</h3>

<p>A matrix with 1 row and the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Observed</code> </td><td style="text-align: left;"> the observed number of zeros,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Expected</code></td><td style="text-align: left;"> the expected number of zeros,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>z-value</code></td><td style="text-align: left;"> the value of the statistical test,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p.value</code></td><td style="text-align: left;"> the p-value of the statistical test.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>He Hua, Zhang Hui, Ye Peng, Tang Wan (2019) A test of inflated zeros
for Poisson regression models, <em>Statistical Methods in Medical Research</em> 28,
1157-1169.
</p>


<h3>See Also</h3>

<p><a href="#topic+overglm">overglm</a>, <a href="#topic+zeroinf">zeroinf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>####### Example 1: Self diagnozed ear infections in swimmers
data(swimmers)
fit1 &lt;- glm(infections ~ frequency + location, family=poisson, data=swimmers)
zero.excess(fit1,rep=50)
fit2 &lt;- overglm(infections ~ frequency + location, family="nb1", data=swimmers)
zero.excess(fit2,rep=50)

####### Example 2: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit1 &lt;- glm(art ~ fem + kid5 + ment, family=poisson, data=bioChemists)
zero.excess(fit1,rep=50)
fit2 &lt;- overglm(art ~ fem + kid5 + ment, family="nb1", data=bioChemists)
zero.excess(fit2,rep=50)
####### Example 3: Roots Produced by the Columnar Apple Cultivar Trajan
data(Trajan)
fit1 &lt;- glm(roots ~ photoperiod, family=poisson, data=Trajan)
zero.excess(fit1,rep=50)
fit2 &lt;- overglm(roots ~ photoperiod, family="nbf", data=Trajan)
zero.excess(fit2,rep=50)

</code></pre>

<hr>
<h2 id='zeroalt'>Zero-Altered Regression Models to deal with Zero-Excess in Count Data</h2><span id='topic+zeroalt'></span>

<h3>Description</h3>

<p>Allows to fit a zero-altered (Poisson or negative binomial) regression model to deal with zero-excess in count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zeroalt(
  formula,
  data,
  offset,
  subset,
  na.action = na.omit(),
  weights,
  family = "poi(log)",
  zero.link = c("logit", "probit", "cloglog", "cauchit", "log"),
  reltol = 1e-13,
  start = list(counts = NULL, zeros = NULL),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zeroalt_+3A_formula">formula</code></td>
<td>
<p>a <code>Formula</code> expression of the form <code>response ~ x1 + x2 + ...| z1 + z2 + ...</code>,
which is a symbolic description of the linear predictors of the models to be fitted to
<code class="reqn">\mu</code> and <code class="reqn">\pi</code>, respectively.    See <a href="Formula.html#topic+Formula">Formula</a> documentation. If a formula
of the form <code>response ~ x1 + x2 + ...</code> is supplied, the same regressors are
employed in both components. This is equivalent to <code>response ~ x1 + x2 + ...| x1 + x2 + ...</code>.</p>
</td></tr>
<tr><td><code id="zeroalt_+3A_data">data</code></td>
<td>
<p>an (optional) <code>data frame</code> in which to look for variables involved in the <code>formula</code> expression,
as well as for variables specified in the arguments <code>weights</code> and <code>subset</code>.</p>
</td></tr>
<tr><td><code id="zeroalt_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known component to be included in the linear predictor during fitting. This should be <code>NULL</code> or a numeric vector of length equal to the number of cases.</p>
</td></tr>
<tr><td><code id="zeroalt_+3A_subset">subset</code></td>
<td>
<p>an (optional) vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="zeroalt_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. By default <code>na.action</code> is set to <code>na.omit()</code>.</p>
</td></tr>
<tr><td><code id="zeroalt_+3A_weights">weights</code></td>
<td>
<p>an (optional) vector of positive &quot;prior weights&quot; to be used in the fitting process. The length of
<code>weights</code> should be the same as the number of observations. As default, <code>weights</code> is set to a vector of 1s.</p>
</td></tr>
<tr><td><code id="zeroalt_+3A_family">family</code></td>
<td>
<p>an (optional) character string that allows you to specify the distribution
to describe the response variable, as well as the link function to be used in
the model for <code class="reqn">\mu</code>. The following distributions are supported:
(zero-altered) negative binomial I (&quot;nb1&quot;), (zero-altered) negative binomial II
(&quot;nb2&quot;), (zero-altered) negative binomial (&quot;nbf&quot;), and (zero-altered) poisson
(&quot;poi&quot;). Link functions are the same as those available in Poisson models via
<a href="stats.html#topic+glm">glm</a>. See <a href="stats.html#topic+family">family</a> documentation. As default, <code>family</code> is set to
be Poisson with log link.</p>
</td></tr>
<tr><td><code id="zeroalt_+3A_zero.link">zero.link</code></td>
<td>
<p>an (optional) character string which allows to specify the link function to be used in the model for <code class="reqn">\pi</code>.
Link functions available are the same than those available in binomial models via <a href="stats.html#topic+glm">glm</a>. See <a href="stats.html#topic+family">family</a> documentation.
As default, <code>zero.link</code> is set to &quot;logit&quot;.</p>
</td></tr>
<tr><td><code id="zeroalt_+3A_reltol">reltol</code></td>
<td>
<p>an (optional) positive value which represents the <em>relative convergence tolerance</em> for the BFGS method in <a href="stats.html#topic+optim">optim</a>.
As default, <code>reltol</code> is set to 1e-13.</p>
</td></tr>
<tr><td><code id="zeroalt_+3A_start">start</code></td>
<td>
<p>an (optional) list with two components named &quot;counts&quot; and &quot;zeros&quot;, which allows to specify the starting values to be used in the
iterative process to obtain the estimates of the parameters in the linear predictors of the models for <code class="reqn">\mu</code>
and <code class="reqn">\pi</code>, respectively.</p>
</td></tr>
<tr><td><code id="zeroalt_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The zero-altered count distributions, also called <em>hurdle models</em>, may be obtained as the mixture between
a zero-truncated count distribution and the Bernoulli distribution. Indeed, if <code class="reqn">Y</code> is a count random variable
such that <code class="reqn">Y|\nu=1</code> is 0 with probability 1
and <code class="reqn">Y|\nu=0</code> ~ ZTP<code class="reqn">(\mu)</code>, where <code class="reqn">\nu</code> ~ Bernoulli<code class="reqn">(\pi)</code>, then
<code class="reqn">Y</code> is distributed according to the Zero-Altered Poisson distribution, denoted here as
ZAP<code class="reqn">(\mu,\pi)</code>.
</p>
<p>Similarly, if <code class="reqn">Y</code> is a count random variable such that <code class="reqn">Y|\nu=1</code> is 0 with probability 1
and <code class="reqn">Y|\nu=0</code> ~ ZTNB<code class="reqn">(\mu,\phi,\tau)</code>, where <code class="reqn">\nu</code> ~ Bernoulli<code class="reqn">(\pi)</code>, then
<code class="reqn">Y</code> is distributed according to the Zero-Altered Negative Binomial distribution, denoted here as
ZANB<code class="reqn">(\mu,\phi,\tau,\pi)</code>. The Zero-Altered Negative Binomial I <code class="reqn">(\mu,\phi,\pi)</code> and
Zero-Altered Negative Binomial II <code class="reqn">(\mu,\phi,\pi)</code> distributions are special cases of ZANB when
<code class="reqn">\tau=0</code> and <code class="reqn">\tau=-1</code>, respectively.
</p>
<p>The &quot;counts&quot; model may be expressed as <code class="reqn">g(\mu_i)=x_i^{\top}\beta</code> for <code class="reqn">i=1,\ldots,n</code>, where
<code class="reqn">g(\cdot)</code> is the link function specified at the argument <code>family</code>. Similarly, the &quot;zeros&quot; model may
be expressed as <code class="reqn">h(\pi_i)=z_i^{\top}\gamma</code> for <code class="reqn">i=1,\ldots,n</code>, where <code class="reqn">h(\cdot)</code> is the
link function specified at the argument <code>zero.link</code>. Parameter estimation is
performed using the maximum likelihood method. The parameter vector <code class="reqn">\gamma</code> is
estimated by applying the routine <a href="stats.html#topic+glm.fit">glm.fit</a>, where a binary-response model
(<code class="reqn">1</code> or &quot;success&quot; if <code>response</code>=0 and <code class="reqn">0</code> or &quot;fail&quot; if <code>response</code>&gt;0)
is fitted. Then, the rest of the model parameters are estimated by maximizing the
log-likelihood function based on the zero-truncated count distribution through the
BFGS method available in the routine <a href="stats.html#topic+optim">optim</a>. The accuracy and speed of the BFGS
method are increased because the call to the routine <a href="stats.html#topic+optim">optim</a> is performed using
the analytical instead of the numerical derivatives. The variance-covariance matrix
estimate is obtained as being minus the inverse of the (analytical) hessian matrix
evaluated at the parameter estimates and the observed data.
A set of standard extractor functions for fitted model objects is available for objects
of class  <em>zeroinflation</em>, including methods to the generic functions such as
<a href="base.html#topic+print">print</a>, <a href="base.html#topic+summary">summary</a>, <a href="stats.html#topic+model.matrix">model.matrix</a>, <a href="#topic+estequa">estequa</a>,
<a href="stats.html#topic+coef">coef</a>, <a href="stats.html#topic+vcov">vcov</a>, <a href="stats.html#topic+logLik">logLik</a>, <a href="stats.html#topic+fitted">fitted</a>, <a href="stats.html#topic+confint">confint</a>, <a href="stats.html#topic+AIC">AIC</a>, <a href="stats.html#topic+BIC">BIC</a> and
<a href="stats.html#topic+predict">predict</a>. In addition, the model fitted to the	data may be assessed using functions such as
<a href="#topic+anova.zeroinflation">anova.zeroinflation</a>, <a href="#topic+residuals.zeroinflation">residuals.zeroinflation</a>, <a href="#topic+dfbeta.zeroinflation">dfbeta.zeroinflation</a>,
<a href="#topic+cooks.distance.zeroinflation">cooks.distance.zeroinflation</a> and <a href="#topic+envelope.zeroinflation">envelope.zeroinflation</a>.
</p>


<h3>Value</h3>

<p>An object of class  <em>zeroinflation</em> in which the main results of the model fitted to the data are stored, i.e., a list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>coefficients</code> </td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the parameter estimates</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> from the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>fitted.values</code></td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the estimates of <code class="reqn">\mu_1,\ldots,\mu_n</code></td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> and <code class="reqn">\pi_1,\ldots,\pi_n</code>, respectively,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>start</code>        </td><td style="text-align: left;"> a vector containing the starting values for all parameters in the model,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>prior.weights</code></td><td style="text-align: left;"> a vector containing the case weights used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>offset</code>       </td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the offset vectors, if any, </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> from the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>terms</code>        </td><td style="text-align: left;"> a list with elements "counts", "zeros" and "full" containing the terms objects for </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>loglik</code>       </td><td style="text-align: left;"> the value of the log-likelihood function avaliated at the parameter estimates and</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> the observed data,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>estfun</code>       </td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the estimating functions </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> evaluated at the parameter estimates and the observed data for the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>formula</code>      </td><td style="text-align: left;"> the formula,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>levels</code>       </td><td style="text-align: left;"> the levels of the categorical regressors,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>contrasts</code>    </td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the contrasts corresponding</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> to levels from the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>converged</code>    </td><td style="text-align: left;"> a logical indicating successful convergence,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>model</code>        </td><td style="text-align: left;"> the full model frame,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code>            </td><td style="text-align: left;"> the response count vector,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>family</code>       </td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the <a href="stats.html#topic+family">family</a> objects used</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;">  in the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>linear.predictors</code> </td><td style="text-align: left;">  a list with elements "counts" and "zeros" containing the estimates of </td>
</tr>
<tr>
 <td style="text-align: left;">
                         </td><td style="text-align: left;">  <code class="reqn">g(\mu_1),\ldots,g(\mu_n)</code> and <code class="reqn">h(\pi_1),\ldots,h(\pi_n)</code>, respectively,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R</code>            </td><td style="text-align: left;"> a matrix with the Cholesky decomposition of the inverse of the variance-covariance</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> matrix of all parameters in the model,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>call</code>         </td><td style="text-align: left;"> the original function call.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Cameron A.C., Trivedi P.K. (1998) <em>Regression Analysis of Count Data</em>. New York:
Cambridge University Press.
</p>
<p>Mullahy J. (1986) Specification and Testing of Some Modified Count Data Models. <em>Journal of
Econometrics</em> 33, 341–365.
</p>


<h3>See Also</h3>

<p><a href="#topic+overglm">overglm</a>, <a href="#topic+zeroinf">zeroinf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>####### Example 1: Roots Produced by the Columnar Apple Cultivar Trajan
data(Trajan)
fit1 &lt;- zeroalt(roots ~ photoperiod, family="nbf(log)", zero.link="logit", data=Trajan)
summary(fit1)

####### Example 2: Self diagnozed ear infections in swimmers
data(swimmers)
fit2 &lt;- zeroalt(infections ~ frequency | location, family="nb1(log)", data=swimmers)
summary(fit2)

####### Example 3: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit3 &lt;- zeroalt(art ~ fem + kid5 + ment, family="nb1(log)", data = bioChemists)
summary(fit3)

</code></pre>

<hr>
<h2 id='zeroinf'>Zero-Inflated Regression Models to deal with Zero-Excess in Count Data</h2><span id='topic+zeroinf'></span>

<h3>Description</h3>

<p>Allows to fit a zero-inflated (Poisson or negative binomial) regression model to deal with zero-excess in count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zeroinf(
  formula,
  data,
  offset,
  subset,
  na.action = na.omit(),
  weights,
  family = "poi(log)",
  zero.link = c("logit", "probit", "cloglog", "cauchit", "log"),
  reltol = 1e-13,
  start = list(counts = NULL, zeros = NULL),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zeroinf_+3A_formula">formula</code></td>
<td>
<p>a <code>Formula</code> expression of the form <code>response ~ x1 + x2 + ... | z1 + z2 + ...</code>, which is a symbolic description
of the linear predictors of the models to be fitted to <code class="reqn">\mu</code> and <code class="reqn">\pi</code>, respectively.    See <a href="Formula.html#topic+Formula">Formula</a> documentation.  If a
formula of the form <code>response ~ x1 + x2 + ...</code> is supplied, then the same regressors are employed in both components. This is equivalent to
<code>response ~ x1 + x2 + ...| x1 + x2 + ...</code>.</p>
</td></tr>
<tr><td><code id="zeroinf_+3A_data">data</code></td>
<td>
<p>an (optional) <code>data frame</code> in which to look for variables involved in the <code>formula</code> expression,
as well as for variables specified in the arguments <code>weights</code> and <code>subset</code>.</p>
</td></tr>
<tr><td><code id="zeroinf_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known component to be included in the linear predictor during fitting. This should be <code>NULL</code> or a numeric vector of length equal to the number of cases.</p>
</td></tr>
<tr><td><code id="zeroinf_+3A_subset">subset</code></td>
<td>
<p>an (optional) vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="zeroinf_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. By default <code>na.action</code> is set to <code>na.omit()</code>.</p>
</td></tr>
<tr><td><code id="zeroinf_+3A_weights">weights</code></td>
<td>
<p>an (optional) vector of positive &quot;prior weights&quot; to be used in the fitting process. The length of
<code>weights</code> should be the same as the number of observations. As default, <code>weights</code> is set to a vector of 1s.</p>
</td></tr>
<tr><td><code id="zeroinf_+3A_family">family</code></td>
<td>
<p>an (optional) character string that allows you to specify the distribution
to describe the response variable, as well as the link function to be used in
the model for <code class="reqn">\mu</code>. The following distributions are supported:
(zero-inflated) negative binomial I (&quot;nb1&quot;), (zero-inflated) negative binomial II
(&quot;nb2&quot;), (zero-inflated) negative binomial (&quot;nbf&quot;), and (zero-inflated) poisson
(&quot;poi&quot;). Link functions are the same as those available in Poisson models via
<a href="stats.html#topic+glm">glm</a>. See <a href="stats.html#topic+family">family</a> documentation. As default, <code>family</code> is set to
be Poisson with log link.</p>
</td></tr>
<tr><td><code id="zeroinf_+3A_zero.link">zero.link</code></td>
<td>
<p>an (optional) character string which allows to specify the link function to be used in the model for <code class="reqn">\pi</code>.
Link functions available are the same than those available in binomial models via <a href="stats.html#topic+glm">glm</a>. See <a href="stats.html#topic+family">family</a> documentation.
As default, <code>zero.link</code> is set to &quot;logit&quot;.</p>
</td></tr>
<tr><td><code id="zeroinf_+3A_reltol">reltol</code></td>
<td>
<p>an (optional) positive value which represents the <em>relative convergence tolerance</em> for the BFGS method in <a href="stats.html#topic+optim">optim</a>.
As default, <code>reltol</code> is set to 1e-13.</p>
</td></tr>
<tr><td><code id="zeroinf_+3A_start">start</code></td>
<td>
<p>an (optional) list with two components named &quot;counts&quot; and &quot;zeros&quot;, which allows to specify the starting values to be used in the
iterative process to obtain the estimates of the parameters in the linear predictors to the models for <code class="reqn">\mu</code>
and <code class="reqn">\pi</code>, respectively.</p>
</td></tr>
<tr><td><code id="zeroinf_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The zero-inflated count distributions may be obtained as the mixture between a count
distribution and the Bernoulli distribution. Indeed, if <code class="reqn">Y</code> is a count random
variable such that <code class="reqn">Y|\nu=1</code> is 0 with probability 1
and <code class="reqn">Y|\nu=0</code> ~ Poisson<code class="reqn">(\mu)</code>, where <code class="reqn">\nu</code> ~ Bernoulli<code class="reqn">(\pi)</code>, then
<code class="reqn">Y</code> is distributed according to the Zero-Inflated Poisson distribution, denoted here as
ZIP<code class="reqn">(\mu,\pi)</code>.
</p>
<p>Similarly, if <code class="reqn">Y</code> is a count random variable such that <code class="reqn">Y|\nu=1</code> is 0 with probability 1
and <code class="reqn">Y|\nu=0</code> ~ NB<code class="reqn">(\mu,\phi,\tau)</code>, where <code class="reqn">\nu</code> ~ Bernoulli<code class="reqn">(\pi)</code>, then
<code class="reqn">Y</code> is distributed according to the Zero-Inflated Negative Binomial distribution, denoted here as
ZINB<code class="reqn">(\mu,\phi,\tau,\pi)</code>. The Zero-Inflated Negative Binomial I <code class="reqn">(\mu,\phi,\pi)</code> and
Zero-Inflated Negative Binomial II <code class="reqn">(\mu,\phi,\pi)</code> distributions are special cases of ZINB when
<code class="reqn">\tau=0</code> and <code class="reqn">\tau=-1</code>, respectively.
</p>
<p>The &quot;counts&quot; model may be expressed as <code class="reqn">g(\mu_i)=x_i^{\top}\beta</code> for <code class="reqn">i=1,\ldots,n</code>, where
<code class="reqn">g(\cdot)</code> is the link function specified at the argument <code>family</code>. Similarly, the &quot;zeros&quot; model may
be expressed as <code class="reqn">h(\pi_i)=z_i^{\top}\gamma</code> for <code class="reqn">i=1,\ldots,n</code>, where <code class="reqn">h(\cdot)</code> is the
link function specified at the argument <code>zero.link</code>. Parameter estimation is
performed using the maximum likelihood method. The model parameters are estimated by
maximizing the log-likelihood function through the BFGS method available in the routine
<a href="stats.html#topic+optim">optim</a>. Analytical derivatives are used instead of numerical derivatives to
increase BFGS method accuracy and speed. The variance-covariance matrix estimate is
obtained as being minus the inverse of the (analytical) hessian matrix evaluated at the
parameter estimates and the observed data.
</p>
<p>A set of standard extractor functions for fitted model objects is available for objects
of class <em>zeroinflation</em>, including methods for generic functions such as
<a href="base.html#topic+print">print</a>, <a href="base.html#topic+summary">summary</a>, <a href="stats.html#topic+model.matrix">model.matrix</a>, <a href="#topic+estequa">estequa</a>,
<a href="stats.html#topic+coef">coef</a>, <a href="stats.html#topic+vcov">vcov</a>, <a href="stats.html#topic+logLik">logLik</a>, <a href="stats.html#topic+fitted">fitted</a>, <a href="stats.html#topic+confint">confint</a>, <a href="stats.html#topic+AIC">AIC</a>, <a href="stats.html#topic+BIC">BIC</a> and
<a href="stats.html#topic+predict">predict</a>. In addition, the model fitted to the	data may be assessed using functions such as
<a href="#topic+anova.zeroinflation">anova.zeroinflation</a>, <a href="#topic+residuals.zeroinflation">residuals.zeroinflation</a>, <a href="#topic+dfbeta.zeroinflation">dfbeta.zeroinflation</a>,
<a href="#topic+cooks.distance.zeroinflation">cooks.distance.zeroinflation</a> and <a href="#topic+envelope.zeroinflation">envelope.zeroinflation</a>.
</p>


<h3>Value</h3>

<p>An object of class  <em>zeroinflation</em> in which the main results of the model fitted to the data are stored, i.e., a
list with components including
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>coefficients</code> </td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the parameter estimates</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> from the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>fitted.values</code></td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the estimates of <code class="reqn">\mu_1,\ldots,\mu_n</code></td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> and <code class="reqn">\pi_1,\ldots,\pi_n</code>, respectively,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>start</code>        </td><td style="text-align: left;"> a vector containing the starting values for all parameters in the model,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>prior.weights</code></td><td style="text-align: left;"> a vector containing the case weights used,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>offset</code>       </td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the offset vectors, if any, </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> from the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>terms</code>        </td><td style="text-align: left;"> a list with elements "counts", "zeros" and "full" containing the terms objects for </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>loglik</code>       </td><td style="text-align: left;"> the value of the log-likelihood function avaliated at the parameter estimates and</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> the observed data,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>estfun</code>       </td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the estimating functions </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> evaluated at the parameter estimates and the observed data for the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>formula</code>      </td><td style="text-align: left;"> the formula,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>levels</code>       </td><td style="text-align: left;"> the levels of the categorical regressors,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>contrasts</code>    </td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the contrasts corresponding</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> to levels from the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>converged</code>    </td><td style="text-align: left;"> a logical indicating successful convergence,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>model</code>        </td><td style="text-align: left;"> the full model frame,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code>            </td><td style="text-align: left;"> the response count vector,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>family</code>       </td><td style="text-align: left;"> a list with elements "counts" and "zeros" containing the <a href="stats.html#topic+family">family</a> objects used</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;">  in the respective models,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>linear.predictors</code> </td><td style="text-align: left;">  a list with elements "counts" and "zeros" containing the estimates of </td>
</tr>
<tr>
 <td style="text-align: left;">
                         </td><td style="text-align: left;">  <code class="reqn">g(\mu_1),\ldots,g(\mu_n)</code> and <code class="reqn">h(\pi_1),\ldots,h(\pi_n)</code>, respectively,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>R</code>            </td><td style="text-align: left;"> a matrix with the Cholesky decomposition of the inverse of the variance-covariance</td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> matrix of all parameters in the model,</td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>call</code>         </td><td style="text-align: left;"> the original function call.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Cameron A.C., Trivedi P.K. 1998. <em>Regression Analysis of Count Data</em>. New York:
Cambridge University Press.
</p>
<p>Lambert D. 1992. Zero-Inflated Poisson Regression, with an Application to Defects in
Manufacturing. <em>Technometrics</em> 34, 1-14.
</p>
<p>Garay A.M., Hashimoto E.M., Ortega E.M.M., Lachos V. (2011) On estimation and
influence diagnostics for zero-inflated negative binomial regression models. <em>Computational
Statistics &amp; Data Analysis</em> 55, 1304-1318.
</p>


<h3>See Also</h3>

<p><a href="#topic+overglm">overglm</a>, <a href="#topic+zeroalt">zeroalt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>####### Example 1: Roots Produced by the Columnar Apple Cultivar Trajan
data(Trajan)
fit1 &lt;- zeroinf(roots ~ photoperiod, family="nbf(log)", zero.link="logit", data=Trajan)
summary(fit1)

####### Example 2: Self diagnozed ear infections in swimmers
data(swimmers)
fit2 &lt;- zeroinf(infections ~ frequency | location, family="nb1(log)", data=swimmers)
summary(fit2)

####### Example 3: Article production by graduate students in biochemistry PhD programs
bioChemists &lt;- pscl::bioChemists
fit3 &lt;- zeroinf(art ~ fem + kid5 + ment | ment, family="nb1(log)", data = bioChemists)
summary(fit3)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
