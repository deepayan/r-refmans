<!DOCTYPE html><html><head><title>Help for package andurinha</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {andurinha}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#andurinha'><p>andurinha: Tools to make spectroscopic data processing easier</p></a></li>
<li><a href='#andurinhaData'><p>Andurinha data set</p></a></li>
<li><a href='#findPeaks'><p>findPeaks</p></a></li>
<li><a href='#gOverview'><p>gOverview</p></a></li>
<li><a href='#importSpectra'><p>importSpectra</p></a></li>
<li><a href='#plotPeaks'><p>plotPeaks</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Make Spectroscopic Data Processing Easier</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>The goal of 'andurinha' is provide a fast and friendly way to 
    process spectroscopic data. It is intended for processing several spectra of 
    samples with similar composition (tens to hundreds of spectra). It compiles 
    spectroscopy data files, produces standardized and second derivative spectra, 
    finds peaks and allows to select the most significant ones based on the second 
    derivative/absorbance sum spectrum. It also provides functions for graphic 
    evaluation of the outputs.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/noemiallefs/andurinha">https://github.com/noemiallefs/andurinha</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/noemiallefs/andurinha/issues">https://github.com/noemiallefs/andurinha/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>signal, tidyr, ggplot2, cowplot, rlang, utils, plyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>extrafont, dplyr, knitr, rmarkdown, testthat, MASS</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-08-07 11:41:17 UTC; noemi</td>
</tr>
<tr>
<td>Author:</td>
<td>Noemi Alvarez Fernandez
    <a href="https://orcid.org/0000-0003-2690-4051"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Antonio Martinez Cortizas
    <a href="https://orcid.org/0000-0003-0430-5760"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Noemi Alvarez Fernandez &lt;noemiallefs@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-08-13 08:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='andurinha'>andurinha: Tools to make spectroscopic data processing easier</h2><span id='topic+andurinha'></span>

<h3>Description</h3>

<p>This package contains a set of functions that makes
spectroscopic data processing easier and faster. It is intended for
processing several spectra (tens to hundreds) of samples with similar
composition. It compiles spectroscopy data files, produces standardised and
second derivative spectra, finds peaks and allows to select the most
significant ones based on the second derivative/absorbance sum spectrum. It
also provides functions for graphic evaluation of the outputs.
</p>


<h3>andurinha functions</h3>


<ol>
<li> <p><code><a href="#topic+importSpectra">importSpectra</a></code>: in case you have your spectra in
separated files (.csv) this function imports and bind them in a single data
frame.
</p>
</li>
<li> <p><code><a href="#topic+findPeaks">findPeaks</a></code>: finds peaks and allows to select the most
relevant based on the second derivative sum spectrum.
</p>
</li>
<li> <p><code><a href="#topic+gOverview">gOverview</a></code>: generates a graphic overview of the
spectroscopic data.
</p>
</li>
<li> <p><code><a href="#topic+plotPeaks">plotPeaks</a></code>: makes a graphic representation of the
peaks over the second derivative/absorbance sum spectrum.
</p>
</li></ol>


<hr>
<h2 id='andurinhaData'>Andurinha data set</h2><span id='topic+andurinhaData'></span>

<h3>Description</h3>

<p>A collection of FTIR-ATR mid-infrared spectra of peat samples
with increasing degree of peat humification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>andurinhaData
</code></pre>


<h3>Format</h3>

<p>A data frame with 1736 observations of 3 peat samples.
</p>

<ul>
<li> <p><em>WN</em>: wave numbers of the spectra.
</p>
</li>
<li> <p><em>A-C</em>: absorbances of a FTIR spectra of three peat samples.
</p>
</li></ul>



<h3>Source</h3>

<p>EcoPast research group, Universidade de Santiago de Compostela
(Spain) <a href="https://ecopast.es">https://ecopast.es</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+importSpectra">importSpectra</a></code>, <code><a href="#topic+findPeaks">findPeaks</a></code>,
<code><a href="#topic+plotPeaks">plotPeaks</a></code> and <code><a href="#topic+gOverview">gOverview</a></code>
</p>

<hr>
<h2 id='findPeaks'>findPeaks</h2><span id='topic+findPeaks'></span>

<h3>Description</h3>

<p>This function finds peaks and allows to the most relevant based
on the second derivative/absorbance sum spectrum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findPeaks(
  data,
  resolution = 4,
  minAbs = 0.1,
  cutOff = NULL,
  scale = TRUE,
  ndd = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findPeaks_+3A_data">data</code></td>
<td>
<p>A data frame object, which contains in the first column the wave
numbers and in the following columns the samples absorbances.</p>
</td></tr>
<tr><td><code id="findPeaks_+3A_resolution">resolution</code></td>
<td>
<p>The equipment measurement resolution; by default 4 cm-1.</p>
</td></tr>
<tr><td><code id="findPeaks_+3A_minabs">minAbs</code></td>
<td>
<p>The cut off value to check spectra quality; by default 0.1.</p>
</td></tr>
<tr><td><code id="findPeaks_+3A_cutoff">cutOff</code></td>
<td>
<p>The second derivative/absorbance sum spectrum cut off to reduce
the raw peaks table; by default NULL.</p>
</td></tr>
<tr><td><code id="findPeaks_+3A_scale">scale</code></td>
<td>
<p>By default (TRUE) the data is scaled by Z-scores. Use FALSE in
case you do not want to scale it.</p>
</td></tr>
<tr><td><code id="findPeaks_+3A_ndd">ndd</code></td>
<td>
<p>By default (TRUE) the peaks are searched based on the second
derivative sum spectrum. Use FALSE in case you want to search them based on
the absorbance sum spectrum.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with a collection of data frames which contains:
</p>

<ol>
<li> <p><em>dataZ</em>: the standardised data by Z-scores.
</p>
</li>
<li> <p><em>secondDerivative</em>: the second derivative values of the data.
</p>
</li>
<li> <p><em>sumSpectrum_peaksTable</em>: the peaks wave numbers and their
second derivative/absorbance sum spectrum values.
</p>
</li>
<li> <p><em>peaksTable</em>: the selected peaks wave numbers and their
absorbance for each spectrum.
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+importSpectra">importSpectra</a></code>, <code><a href="#topic+gOverview">gOverview</a></code> and
<code><a href="#topic+plotPeaks">plotPeaks</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Find Peaks based on the absorbance sum spectrum
fp.abs &lt;- findPeaks(andurinhaData, ndd = FALSE)

# See the peaks table of the absorbance sum spectrum
fp.abs$sumSpectrum_peaksTable

# Find Peaks based on the second derivative sum spectrum
fp.ndd &lt;- findPeaks(andurinhaData)

# See the peaks table of the second derivative sum spectrum
fp.ndd$sumSpectrum_peaksTable

# Select a cutOff to reduce the number of peaks in the table
# (i.e. select the most relevant)
# fp.ndd$sumSpectrum_peaksTable %&gt;%
#   arrange(desc(sumSpectrum))
# Run findPeaks() with the new cutOff
fp.ndd2 &lt;- findPeaks(andurinhaData, cutOff = 0.25)

</code></pre>

<hr>
<h2 id='gOverview'>gOverview</h2><span id='topic+gOverview'></span>

<h3>Description</h3>

<p>This function generates a graphic overview of the spectroscopic
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gOverview(data_abs, data_ndd, fontFamily = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gOverview_+3A_data_abs">data_abs</code></td>
<td>
<p>A data frame, which contains in the first column the wave
numbers and in the following columns the samples absorbances.</p>
</td></tr>
<tr><td><code id="gOverview_+3A_data_ndd">data_ndd</code></td>
<td>
<p>A data frame, which contains in the first column the wave
numbers and in the following columns the samples second derivative values.</p>
</td></tr>
<tr><td><code id="gOverview_+3A_fontfamily">fontFamily</code></td>
<td>
<p>The desired graphic font family.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>If <em>data_ndd is provided</em>:</dt><dd><p>It returns a grid with three plots:
</p>

<ul>
<li><p> The ensemble of all samples spectra.
</p>
</li>
<li><p> The ensemble of the second derivative spectra of all samples.
</p>
</li>
<li><p> The average and standard deviation spectra.
</p>
</li></ul>

</dd>
<dt>If <em>data_ndd is omitted</em>:</dt><dd><p>It returns a grid with two plots:
</p>

<ul>
<li><p> The ensemble of all samples spectra.
</p>
</li>
<li><p> The average and standard deviation spectra.
</p>
</li></ul>

</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+importSpectra">importSpectra</a></code>, <code><a href="#topic+findPeaks">findPeaks</a></code> and
<code><a href="#topic+plotPeaks">plotPeaks</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Grapic overview of your raw data
gOverview(andurinhaData)

# Graphic overview of your processed data by findPeaks()
fp &lt;- findPeaks(andurinhaData)
gOverview(fp$dataZ, fp$secondDerivative)

</code></pre>

<hr>
<h2 id='importSpectra'>importSpectra</h2><span id='topic+importSpectra'></span>

<h3>Description</h3>

<p>In case you have your spectra in separated files (.csv) this
function imports and binds them in a single data frame. The files directory
must contain only the samples files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importSpectra(path, sep = ";")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importSpectra_+3A_path">path</code></td>
<td>
<p>A character vector with the full path to the data directory; by
default corresponds to the working directory, <code><a href="base.html#topic+getwd">getwd</a></code>.</p>
</td></tr>
<tr><td><code id="importSpectra_+3A_sep">sep</code></td>
<td>
<p>The field separator character; by default sep = &quot;;&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the structure:
</p>

<ul>
<li> <p><em>First column (WN)</em>: wave numbers of the spectra.
</p>
</li>
<li> <p><em>1-n</em>: samples spectra (the column names correspond to the files
names).
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+findPeaks">findPeaks</a></code>, <code><a href="#topic+gOverview">gOverview</a></code> and
<code><a href="#topic+plotPeaks">plotPeaks</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create an empty directory
# Now create some spectra separate files
A &lt;- andurinhaData[, 1:2]
B &lt;- andurinhaData[, c(1, 3)]
C &lt;- andurinhaData[, c(1, 4)]

MASS::write.matrix(A, file = tempfile(pattern = "A.csv"), sep = ";")
MASS::write.matrix(A, file = tempfile(pattern = "B.csv"), sep = ";")
MASS::write.matrix(A, file = tempfile(pattern = "C.csv"), sep = ";")

# Try
importSpectra(path = paste0(tempdir(), "/"), ";")

</code></pre>

<hr>
<h2 id='plotPeaks'>plotPeaks</h2><span id='topic+plotPeaks'></span>

<h3>Description</h3>

<p>This function makes a graphic representation of the peaks over
the second derivative and/or absorbance sum spectra.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPeaks(peaksWN, data_abs, data_ndd, fontFamily = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPeaks_+3A_peakswn">peaksWN</code></td>
<td>
<p>A vector with the peaks wave numbers.</p>
</td></tr>
<tr><td><code id="plotPeaks_+3A_data_abs">data_abs</code></td>
<td>
<p>A data frame, which contains in the first column the wave
numbers and in the following columns the samples absorbances.</p>
</td></tr>
<tr><td><code id="plotPeaks_+3A_data_ndd">data_ndd</code></td>
<td>
<p>A data frame, which contains in the first column the wave
numbers and in the following columns the samples second derivative values.</p>
</td></tr>
<tr><td><code id="plotPeaks_+3A_fontfamily">fontFamily</code></td>
<td>
<p>The desired graphic font family.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+importSpectra">importSpectra</a></code>, <code><a href="#topic+findPeaks">findPeaks</a></code> and
<code><a href="#topic+gOverview">gOverview</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot the peaks found by findPeaks()
# 1. Based on absorbance sum spectrum
fp.abs &lt;- findPeaks(andurinhaData, ndd = FALSE)
plotPeaks(fp.abs[[3]]$WN, fp.abs$dataZ)

# 2. Based on second derivative spectrum
fp.ndd &lt;- findPeaks(andurinhaData, cutOff = 0.25)
plotPeaks(fp.ndd[[4]]$WN, fp.ndd$dataZ, fp.ndd$secondDerivative)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
