<!DOCTYPE html><html><head><title>Help for package svKomodo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {svKomodo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#koCmd'><p>Connect to the SciViews-K (Komodo Edit/IDE) socket server and run JavaScript code in Komodo</p></a></li>
<li><a href='#koInstall'><p>Install and uninstall hooks for communicating with Komodo Edit/IDE</p></a></li>
<li><a href='#koRefresh'><p>Refresh Komodo interface (active object lists and R object browser)</p></a></li>
<li><a href='#svKomodo-package'><p>svKomodo: 'SciViews' - Functions to Interface with Komodo IDE</p></a></li>
<li><a href='#svTaskCallbackManager'><p>Create task callbacks that are evaluated both from R and socket/http server</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-07</td>
</tr>
<tr>
<td>Title:</td>
<td>'SciViews' - Functions to Interface with Komodo IDE</td>
</tr>
<tr>
<td>Description:</td>
<td>R-side code to implement an R editor and IDE in Komodo IDE
  with the SciViews-K extension.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philippe Grosjean &lt;phgrosjean@sciviews.org&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.6.0), svMisc (&ge; 0.9-68)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>svHttp, svSocket, spelling, covr, knitr, rmarkdown</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Komodo Edit
(https://www.activestate.com/products/komodo-ide/)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/SciViews/svKomodo">https://github.com/SciViews/svKomodo</a>,
<a href="https://www.sciviews.org/svKomodo/">https://www.sciviews.org/svKomodo/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/SciViews/svKomodo/issues">https://github.com/SciViews/svKomodo/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-10 15:08:48 UTC; phgrosjean</td>
</tr>
<tr>
<td>Author:</td>
<td>Philippe Grosjean <a href="https://orcid.org/0000-0002-2694-9471"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-10 15:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='koCmd'>Connect to the SciViews-K (Komodo Edit/IDE) socket server and run JavaScript code in Komodo</h2><span id='topic+koCmd'></span>

<h3>Description</h3>

<p>If Komodo Edit/IDE with the SciViews-K extension is running on your machine,
you can connect to its socket server and run javascript code in it with this
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>koCmd(
  cmd,
  data = NULL,
  async = FALSE,
  host = getOption("ko.host"),
  port = getOption("ko.port"),
  kotype = getOption("ko.kotype"),
  timeout = 2,
  type = c("js", "rjsonp", "output"),
  pad = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="koCmd_+3A_cmd">cmd</code></td>
<td>
<p>the JavaScript you want to execute in Komodo Edit, in a character</p>
</td></tr>
<tr><td><code id="koCmd_+3A_data">data</code></td>
<td>
<p>if a named list, replace <code style="white-space: pre;">&#8288;&lt;&lt;&lt;name&gt;&gt;&gt;&#8288;</code> in cmd for each name of the
list by its component first. If a character string, replace <code style="white-space: pre;">&#8288;&lt;&lt;&lt;data&gt;&gt;&gt;&#8288;</code> in
cmd. If <code>NULL</code> (by default), do nothing to cmd before submitting it. See the
last examples for using data.</p>
</td></tr>
<tr><td><code id="koCmd_+3A_async">async</code></td>
<td>
<p>not used yet!</p>
</td></tr>
<tr><td><code id="koCmd_+3A_host">host</code></td>
<td>
<p>the host where Komodo is located. Currently, only <code>localhost</code> is
accepted. Can be changed by setting <code>options(ko.host = ....)</code>.</p>
</td></tr>
<tr><td><code id="koCmd_+3A_port">port</code></td>
<td>
<p>the socket port where the SciViews-K server is listening, by
default, it is port 7052. Can be changed by setting
<code>options(ko.port = ....)</code>.</p>
</td></tr>
<tr><td><code id="koCmd_+3A_kotype">kotype</code></td>
<td>
<p>the type of Komodo server in use. Currently
(SciViews-K &gt;= 0.9-25), it can be either <code>"socket"</code> or <code>"file"</code>.</p>
</td></tr>
<tr><td><code id="koCmd_+3A_timeout">timeout</code></td>
<td>
<p>number of seconds to wait for a response.</p>
</td></tr>
<tr><td><code id="koCmd_+3A_type">type</code></td>
<td>
<p>which type of Komodo command do we send? If <code>type = "js"</code> (by
default), <code>cmd</code> is considered to be JavaScript code to be evaluated in
Komodo. If <code>type = "rjsonp"</code>, <code>cmd</code> is parsed as RJson object with padding
(included in a JavaScript function call) and will be evaluated as such in
Komodo. if <code>type = "output"</code>, the string in <code>cmd</code> is considered to be some R
output and will be displayed in the Komodo local R console (no evaluation).</p>
</td></tr>
<tr><td><code id="koCmd_+3A_pad">pad</code></td>
<td>
<p>a string naming the JavaScript function to run in Komodo, with the
constructed RJson object as argument. If <code>NULL</code> (by default), the RJson
object is evaluated directly without padding.</p>
</td></tr>
<tr><td><code id="koCmd_+3A_...">...</code></td>
<td>
<p>further arguments to pass to <code>toRjson()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Komodo Edit (https://www.activestate.com/products/komodo-ide/) is an Open
Source (MPL, GPL &amp; LGPL) editor based on the excellent Mozilla platform and
the powerful Scintilla text editor widget. It runs on many Linux
distributions, on Windows and on MacOS. Komodo IDE was a commercial
equivalent, but with many tools for developers, especially targeting
languages like Perl, Tcl, Python, Ruby, etc. This product is now freely
distributed as well and Komodo Edit was deprecated. However, the project does
not appear to be actively maintained any more and it may not work on more
recent MacOS or Windows versions.
</p>
<p><code>koCmd()</code> can only talk to Komodo if the SciViews-K socket server is
installed. This server is contained in the SciViews-K extension that you can
download from https://github.com/SciViews/sciviewsk. See Komodo documentation
to know how to install this extension (drag and drop of the extension on the
Komodo window works in most platforms).
</p>


<h3>Value</h3>

<p>Returns the results of the evaluation of the javascript code in
Komodo Edit/IDE if <code>async = FALSE</code>. Note that <code>async = TRUE</code> is not
supported yet.
</p>
<p>If there is an error, or <code>cmd</code> is an invalid JavaScript code, a character
string containing javascript error message is returned (this is changed from
version 0.9-47, previously a 'try-error' was returned).
</p>


<h3>Note</h3>

<p>Because of security concerns, the SciViews-K server only allows connections
from local clients (running on the same computer). This limitation would be
relatively easy to eliminate, but at your own risks!
</p>
<p>Data are returned from Komodo to R by using the JavaScript function
<code>sv.socket.serverWrite()</code>, see the examples bellow.
</p>


<h3>See Also</h3>

<p><code><a href="svSocket.html#topic+start_socket_server">svSocket::startSocketServer()</a></code>, <code><a href="svSocket.html#topic+process_socket_server">svSocket::processSocket()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Make sure you have started Komodo Edit or IDE with the SciViews-K extension
# installed on the same machine, and the socket server started and then...

# Send JavaScript commands to Komodo
# Alert box in Komodo, and then reply to R
koCmd(c('alert("Hello from R!");',
  'sv.socket.serverWrite("Hello from OpenKomodo (" + ko.interpolate.currentFilePath() + ")");'))

# Open a web page wih Komodo configuration
koCmd("ko.open.URI('about:config','browser');")

# Get info from Komodo
koCmd("sv.socket.serverWrite(ko.logging.getStack());")

# Passing a large amount of data to Komodo, and then, back to R
koCmd(paste0('sv.socket.serverWrite("', rep(paste(iris, collapse = "\\\\n"), 10), '");'))

# It is easier to use 'data =' instead of paste() for constructing the JS command
koCmd('alert("&lt;&lt;&lt;data&gt;&gt;&gt;");', data = search())

# Using a named list for data to replace in the cmd
koCmd('alert("This is R version &lt;&lt;&lt;major&gt;&gt;&gt;.&lt;&lt;&lt;minor&gt;&gt;&gt;");', R.version)

# Sending incorrect JavaScript instruction
koCmd('nonexistingJSfunction();')
# Should return something like:
# "ReferenceError: nonexistingJSfunction is not defined"

# Sending RJsonP (RJson with padding) instruction to Komodo
koCmd("Hello with RJsonP!", type = "rjsonp", pad = "alert")

# This is more useful to pass complex R objects to Komodo
koCmd(head(iris), type = "rjsonp", pad = "sv.socket.serverWrite")

# Send simple text (no evaluation) to the Komodo R console
koCmd("Hello again from R!", type = "output")

## End(Not run)
</code></pre>

<hr>
<h2 id='koInstall'>Install and uninstall hooks for communicating with Komodo Edit/IDE</h2><span id='topic+koInstall'></span><span id='topic+koUninstall'></span>

<h3>Description</h3>

<p>Install functions in <code>SciViews:TempEnv</code> and callbacks required to communicate
with Komodo Edit with the SciViews-K extension (see
https://github.com/SciViews/sciviewsk).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>koInstall()

koUninstall()
</code></pre>


<h3>Details</h3>

<p>The minimum instruction to install the communication with Komodo/SciViews-K
(so called, SciViews Komodo) is to use:
<code style="white-space: pre;">&#8288;options(ko.serve = 8888); require(svKomodo)&#8288;</code>. When the <code>ko.serve</code> option is
set, svKomodo loads svSocket, starts the socket server listening to the
port you have selected (8888 by default), and install the hooks and callbacks
required to communicate with SciViews Komodo.
</p>
<p>Before loading svKomodo, you can also set <code>option(ko.port = 7052)</code> or another
port number where the Komodo SciViews-K server is listening (7052 is the
default value). If the Komodo client is running on a different machine, you
should also set <code>ko.host = "xxx.xxx.xxx.xxx"</code>, where <code>xxx.xxx.xxx.xxx</code> is the
IP address of the Komodo client's machine, before loading svKomodo (note that
running R and Komodo on separate machines is not supported yet, but this is a
planned feature and corresponding configurations are already recognized;
just, distant server is currently locked until we will build a better
security mechanism in the server (SSL, TSL, ...).
</p>
<p>All these operations are done by Komodo if you start R from Komodo with
SciViews-K extension installed.
</p>


<h3>Value</h3>

<p>Returns nothing.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+koCmd">koCmd()</a></code>
</p>

<hr>
<h2 id='koRefresh'>Refresh Komodo interface (active object lists and R object browser)</h2><span id='topic+koRefresh'></span><span id='topic+koAutoRefresh'></span>

<h3>Description</h3>

<p>These function manage to refresh the list of active objects in Komodo and
also the data displayed in the Komodo R object browser. They should not be
called directly by the end-user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>koRefresh(force = FALSE)

koAutoRefresh(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="koRefresh_+3A_force">force</code></td>
<td>
<p>do we force refresh, even if data have not changed?</p>
</td></tr>
<tr><td><code id="koRefresh_+3A_...">...</code></td>
<td>
<p>any argument (ignored, but useful for <code>addTaskCallback()</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Both functions return <code>TRUE</code> on success.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+koCmd">koCmd()</a></code>
</p>

<hr>
<h2 id='svKomodo-package'>svKomodo: 'SciViews' - Functions to Interface with Komodo IDE</h2><span id='topic+svKomodo'></span><span id='topic+svKomodo-package'></span>

<h3>Description</h3>

<p>R-side code to implement an R editor and IDE in Komodo IDE
with the SciViews-K extension.
</p>


<h3>Details</h3>

<p>Before RStudio or R addins for vscode were developed and popularized, this
was an attempt to develop a complete IDE for R by using Komodo IDE, see
https://www.activestate.com/products/komodo-ide/. The additional code needed
to supplement Komodo IDE with R-related features was implemented in two
parts: (1) The SciViews-K (https://github.com/SciViews/sciviewsk) addin for
Komodo and (2) the present svKomodo R package that work hand in hand to
provide R code intelligence, an object explorer, an integrated R Console, a
document format similar to R Markdown, but using ASCIIDoc instead of
Markdown, and more.
</p>
<p>The development of this extension for Komodo IDE was stopped in 2016 because
it was too similar to RStudio that emerged at that time as one of the
preferred editor/IDE for R. The SciViews IDE using Komodo never was enough
advertised, nor documented to gain a significant useR base.
</p>
<p>Nevertheless, the SciViews-K Komodo addin and the svKomodo R package
implemented features that may be interesting in a different context. The
interaction of R and Komodo and the remote R Console in Komodo use
communication protocols developed in the svSocket and svHttp R packages.
As such, it is an example of R -JavaScript code to interact with R in a
non-blocking way that could be reused in any other software that implements
its UI using HTML + JavaScript. The consequent JavaScript code developed for
the R object explorer may be worth looking at, for instance.
</p>
<p>Both SciViews-K and svKomodo should be considered archived items. I keep
them &quot;alive&quot; in the hope that their code could be useful to others in similar
contexts. See the other man pages for further explanations.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Philippe Grosjean <a href="mailto:phgrosjean@sciviews.org">phgrosjean@sciviews.org</a> (<a href="https://orcid.org/0000-0002-2694-9471">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/SciViews/svKomodo">https://github.com/SciViews/svKomodo</a>
</p>
</li>
<li> <p><a href="https://www.sciviews.org/svKomodo/">https://www.sciviews.org/svKomodo/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/SciViews/svKomodo/issues">https://github.com/SciViews/svKomodo/issues</a>
</p>
</li></ul>


<hr>
<h2 id='svTaskCallbackManager'>Create task callbacks that are evaluated both from R and socket/http server</h2><span id='topic+svTaskCallbackManager'></span>

<h3>Description</h3>

<p><code>svTaskCallbackManager()</code> is a copy of <code>taskCallbackManager()</code> in R base
package, as of version 4.0.5 of R. Two important differences: (1) the top
task created is named <code>SV-taskCallbackManager</code> instead of
<code>R-taskCallbackManager</code>, and its tasks are executed after each top-level task
in R console, or after execution of non-hidden R code from the socket or http
server (take care: only once per set of code, no matter the number of
top-level task in the R code send by the client in the second case). All
taskCallbacks defined by <code>addTaskCallback()</code> or <code>taskCallbackManager$add()</code>
from R base package are not executed when code is invoked from the R socket
or http server!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svTaskCallbackManager(handlers = list(), registered = FALSE, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svTaskCallbackManager_+3A_handlers">handlers</code></td>
<td>
<p>this can be a list of callbacks in which each element is a
list with an element named <code>f</code> which is a callback function, and an optional
element named <code>data</code> which is the 5-th argument to be supplied to the
callback when it is invoked. Typically this argument is not specified, and
one uses add to register callbacks after the manager is created.</p>
</td></tr>
<tr><td><code id="svTaskCallbackManager_+3A_registered">registered</code></td>
<td>
<p>a logical value indicating whether the <code>evaluate</code>
function has already been registered with the internal task callback
mechanism. This is usually <code>FALSE</code> and the first time a callback is
added via the add function, the evaluate function is automatically
registered. One can control when the function is registered by specifying
<code>TRUE</code> for this argument and calling <code>addTaskCallback()</code> manually.</p>
</td></tr>
<tr><td><code id="svTaskCallbackManager_+3A_verbose">verbose</code></td>
<td>
<p>a logical value, which if <code>TRUE</code>, causes information to be
printed to the console about certain activities this dispatch manager
performs. This is useful for debugging callbacks and the handler itself.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>See <code>?taskCallbackManager</code> for both the returned object and how to use it.
</p>


<h3>Author(s)</h3>

<p>Slightly modified from the original R core team's function by Ph.
Grosjean <a href="mailto:phgrosjean@sciviews.org">phgrosjean@sciviews.org</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+taskCallbackManager">taskCallbackManager()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create a task callback manager
cbman &lt;- svTaskCallbackManager()
# Add a function to activate after each code evaluation in R
cbman$add(function(expr, value, ok, visible) {
  cat("Hi from the callback manager!\n")
  return(TRUE)
  }, name = "exampleHandler")
# Just issue a command and see the callback function activated
1 + 1
# List defined callbacks
cbman$callbacks()
# Remove the callback we just defined
cbman$remove("exampleHandler")
1 + 1
# Remove the task callback manager (base R function)
removeTaskCallback("SV-taskCallbackManager")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
