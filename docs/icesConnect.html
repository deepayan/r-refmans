<!DOCTYPE html><html><head><title>Help for package icesConnect</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {icesConnect}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#clear_token'><p>clear_token</p></a></li>
<li><a href='#decode_token'><p>Decode token</p></a></li>
<li><a href='#ices_get_jwt'><p>ices_request_jwt</p></a></li>
<li><a href='#ices_token'><p>ices_token</p></a></li>
<li><a href='#set_username'><p>Set your ICES username</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Provides User Tokens for Access to ICES Web Services</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides user tokens for ICES web services that require
  authentication and authorization.  Web services covered by this
  package are ICES VMS database, the ICES DATSU web services, and the
  ICES SharePoint site.</td>
</tr>
<tr>
<td>Imports:</td>
<td>whoami, keyring, httr, base64enc, jsonlite, getPass</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-09 17:48:38 UTC; colin</td>
</tr>
<tr>
<td>Author:</td>
<td>Colin Millar [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Colin Millar &lt;colin.millar@ices.dk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-10 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='clear_token'>clear_token</h2><span id='topic+clear_token'></span>

<h3>Description</h3>

<p>Deletes the token from the key ring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clear_token(username = getOption("ices.username"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clear_token_+3A_username">username</code></td>
<td>
<p>the ices username that you require a token for,
Default: getOption(&quot;ices.username&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value
</p>


<h3>See Also</h3>

<p><code><a href="whoami.html#topic+username">username</a></code>
<code><a href="keyring.html#topic+key_get">key_get</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
clear_token()

## End(Not run)

</code></pre>

<hr>
<h2 id='decode_token'>Decode token</h2><span id='topic+decode_token'></span><span id='topic+token_expiration'></span><span id='topic+token_user'></span>

<h3>Description</h3>

<p>Decodes the token to allow inspection of claims
</p>
<p>Return the expiration date of the token
</p>
<p>What user is this token for
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decode_token(jwt = ices_token(), formatted = TRUE)

token_expiration(jwt = ices_token())

token_user(jwt = ices_token())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decode_token_+3A_jwt">jwt</code></td>
<td>
<p>a javascript web token got by running <code>ices_token()</code></p>
</td></tr>
<tr><td><code id="decode_token_+3A_formatted">formatted</code></td>
<td>
<p>should formatted output be returned</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of claims
</p>
<p>POSIXct date time
</p>
<p>string, user name
</p>


<h3>See Also</h3>

<p><code><a href="whoami.html#topic+username">username</a></code>
<code><a href="keyring.html#topic+key_get">key_get</a></code>
</p>
<p><code><a href="whoami.html#topic+username">username</a></code>
<code><a href="keyring.html#topic+key_get">key_get</a></code>
</p>
<p><code><a href="whoami.html#topic+username">username</a></code>
<code><a href="keyring.html#topic+key_get">key_get</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
decode_token()

## End(Not run)

## Not run: 
token_expiration()

## End(Not run)

## Not run: 
token_user()

## End(Not run)

</code></pre>

<hr>
<h2 id='ices_get_jwt'>ices_request_jwt</h2><span id='topic+ices_get_jwt'></span><span id='topic+ices_post_jwt'></span><span id='topic+ices_patch_jwt'></span><span id='topic+ices_request_jwt'></span>

<h3>Description</h3>

<p>Perform a get request to a url using a javascript web token for authentication
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ices_get_jwt(
  url,
  username = NULL,
  retry = TRUE,
  quiet = FALSE,
  verbose = FALSE,
  jwt = NULL
)

ices_post_jwt(
  url,
  body = list(),
  encode = "json",
  username = NULL,
  retry = TRUE,
  quiet = FALSE,
  verbose = FALSE,
  jwt = NULL
)

ices_patch_jwt(
  url,
  body = list(),
  encode = "json",
  username = NULL,
  retry = TRUE,
  quiet = FALSE,
  verbose = FALSE,
  jwt = NULL
)

ices_request_jwt(
  type = c("GET", "POST", "PATCH"),
  url,
  body = NULL,
  encode = c("multipart", "form", "json", "raw"),
  username = NULL,
  retry = TRUE,
  quiet = FALSE,
  verbose = FALSE,
  jwt = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ices_get_jwt_+3A_url">url</code></td>
<td>
<p>the url to make the request to</p>
</td></tr>
<tr><td><code id="ices_get_jwt_+3A_username">username</code></td>
<td>
<p>the ices username to perform the request as,
Default: getOption(&quot;ices.username&quot;)</p>
</td></tr>
<tr><td><code id="ices_get_jwt_+3A_retry">retry</code></td>
<td>
<p>if initial request fails, should a retry be made, Default: TRUE</p>
</td></tr>
<tr><td><code id="ices_get_jwt_+3A_quiet">quiet</code></td>
<td>
<p>suppress informative messages to the console</p>
</td></tr>
<tr><td><code id="ices_get_jwt_+3A_verbose">verbose</code></td>
<td>
<p>should the http request return verbose output</p>
</td></tr>
<tr><td><code id="ices_get_jwt_+3A_jwt">jwt</code></td>
<td>
<p>option to supply a token bypassing the ices_token() route, if &quot;&quot; no token is used</p>
</td></tr>
<tr><td><code id="ices_get_jwt_+3A_body">body</code></td>
<td>
<p>optional body of request</p>
</td></tr>
<tr><td><code id="ices_get_jwt_+3A_encode">encode</code></td>
<td>
<p>If the body is a named list, how should it be encoded?</p>
</td></tr>
<tr><td><code id="ices_get_jwt_+3A_type">type</code></td>
<td>
<p>the type of request to make, GET, POST or PATCH</p>
</td></tr>
</table>


<h3>Value</h3>

<p>httr response object
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ices_token">ices_token</a></code>
<code><a href="httr.html#topic+GET">GET</a></code>,<code><a href="httr.html#topic+add_headers">add_headers</a></code>,<code><a href="httr.html#topic+stop_for_status">stop_for_status</a></code>,<code><a href="httr.html#topic+status_code">status_code</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# this function is interactive and asks the user for a password
ices_request_jwt("GET", "https://taf.ices.dk/vms/api/gearwidths")
ices_get_jwt("https://taf.ices.dk/vms/api/gearwidths")

## End(Not run)
</code></pre>

<hr>
<h2 id='ices_token'>ices_token</h2><span id='topic+ices_token'></span>

<h3>Description</h3>

<p>Stores a user token in the system keyring
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ices_token(username = NULL, password = NULL, refresh = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ices_token_+3A_username">username</code></td>
<td>
<p>the ices username that you require a token for,
Default: NULL, which results in getOption(&quot;ices.username&quot;)</p>
</td></tr>
<tr><td><code id="ices_token_+3A_password">password</code></td>
<td>
<p>the ices username that you require a token for,
Default: NULL, which results in a dialogue box request for the
password</p>
</td></tr>
<tr><td><code id="ices_token_+3A_refresh">refresh</code></td>
<td>
<p>should the token be refreshed to update new claims
for example</p>
</td></tr>
<tr><td><code id="ices_token_+3A_...">...</code></td>
<td>
<p>not yet used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character scalar, the token
</p>


<h3>See Also</h3>

<p><code><a href="whoami.html#topic+username">username</a></code>
<code><a href="keyring.html#topic+key_get">key_get</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ices_token()

## End(Not run)

</code></pre>

<hr>
<h2 id='set_username'>Set your ICES username</h2><span id='topic+set_username'></span>

<h3>Description</h3>

<p>Set the ICES user or logon name that will be used for requests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_username(username)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_username_+3A_username">username</code></td>
<td>
<p>the ices username you use to login to SharePoint
for example.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To set this permanently, add the line:
<code>options(ices.username = "your ices user name")</code>
to your '.Rprofile' file, see, usually '~/.Rprofile', see
<code><a href="base.html#topic+Startup">Startup</a></code> for more information.
</p>


<h3>Value</h3>

<p>invisible value: the previous username that was set
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+options">options</a></code>
<code><a href="base.html#topic+getOption">getOption</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set_username("myusername")


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
