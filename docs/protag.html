<!DOCTYPE html><html><head><title>Help for package protag</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {protag}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#protag'><p>protag: Search Tagged Peptides &amp; Draw Highlighted Mass Spectra</p></a></li>
<li><a href='#myoglobin'><p>Simulated MALDI-TOF data of equine myoglobin, labeled (with dimethylation)  and control</p></a></li>
<li><a href='#tag.search'><p>tag.search</p></a></li>
<li><a href='#tag.spectra.butterflyplot'><p>tag.spectra.butterflyplot</p></a></li>
<li><a href='#tag.spectra.listplot'><p>tag.spectra.listplot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Search Tagged Peptides &amp; Draw Highlighted Mass Spectra</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>In a typical protein labelling procedure, proteins are chemically tagged with a functional group, usually at specific sites, then digested into peptides, which are then analyzed using matrix-assisted laser desorption ionization - time of flight mass spectrometry (MALDI-TOF MS) to generate peptide fingerprint. Relative to the control, peptides that are heavier by the mass of the labelling group are informative for sequence determination. Searching for peptides with such mass shifts, however, can be difficult. This package, designed to tackle this inconvenience, takes as input the mass list of two or multiple MALDI-TOF MS mass lists, and makes pairwise comparisons between the labeled groups vs. control, and restores centroid mass spectra with highlighted peaks of interest for easier visual examination. Particularly, peaks differentiated by the mass of the labelling group are defined as a “pair”, those with equal masses as a “match”, and all the other peaks as a “mismatch”.For more bioanalytical background information, refer to following publications: Jingjing Deng (2015) &lt;<a href="https://doi.org/10.1007%2F978-1-4939-2550-6_19">doi:10.1007/978-1-4939-2550-6_19</a>&gt;; Elizabeth Chang (2016) &lt;<a href="https://doi.org/10.7171%2Fjbt.16-2702-002">doi:10.7171/jbt.16-2702-002</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, dplyr, RColorBrewer, grDevices</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-08 00:17:47 UTC; Boyuan</td>
</tr>
<tr>
<td>Author:</td>
<td>Bo Yuan [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bo Yuan &lt;yuanbo.faith@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-09 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='protag'>protag: Search Tagged Peptides &amp; Draw Highlighted Mass Spectra</h2><span id='topic+protag'></span><span id='topic+protag-package'></span>

<h3>Description</h3>

<p>In a typical protein labelling procedure, proteins are chemically tagged with a functional group, usually at a specific site, digested into peptides, which are then analyzed using matrix-assisted laser desorption ionization - time of flight mass spectrometry (MALDI-TOF MS) to generate peptide fingerprint. Relative to the control, peptides that are heavier by the mass of the labelling group are informative for sequence determination. Searching for peptides with such mass shifts, however, can be difficult. This package, designed to tackle this inconvenience, takes as input the mass list of two or multiple MALDI-TOF MS mass lists, and makes pairwise comparisons between the labeled groups vs. control, and restores centroid mass spectra with highlighted peaks of interest for easier visual examination. Particularly, peaks differentiated by the mass of the labelling group are defined as a “pair”, those with equal masses as a “match”, and all the other peaks as a “mismatch”. For more bioanalytical background information, refer to following publications: Jingjing Deng (2015) &lt;doi:10.1007/978-1-4939-2550-6_19&gt;; Elizabeth Chang (2016) &lt;doi:10.7171/jbt.16-2702-002&gt;.
</p>


<h3>Author(s)</h3>

<p>Bo Yuan | yuanbo.faith@gmail.com
</p>

<hr>
<h2 id='myoglobin'>Simulated MALDI-TOF data of equine myoglobin, labeled (with dimethylation)  and control</h2><span id='topic+myoglobin'></span>

<h3>Description</h3>

<p>This example data is loosely based on the predicted MALDI-TOF mass list of tryptic peptides of equine myoglobin, created using entry P68082 (MYG_HORSE) in UniProtKB (https://www.uniprot.org/uniprot/P68082) with further modification. Labeled peptides, either singly or doubly dimethylated, present 28 or 56 Da shfit relative to the control.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myoglobin
</code></pre>


<h3>Format</h3>

<p>a tibble dataset of 193 rows and 7 variables.</p>


<h3>Author(s)</h3>

<p>Bo Yuan <a href="mailto:yuanbo.faith@gmail.com">yuanbo.faith@gmail.com</a>
</p>

<dl>
<dt>mass</dt><dd><p>the mass of singly protonated peptides, in Dalton. Cysteins were alkylated with iodoacetate. </p>
</dd>
<dt>position</dt><dd><p>the positions of the N- and C-termini of peptides, counting from signal amino acid methionine. The position number of N-terminus of mature protein starts at number 2.</p>
</dd>
<dt>no.MC</dt><dd><p>number of mis-cleavages, which are cites of C-termini of lysines and arginines (without following proline)  where trypsin fail to digest apart.</p>
</dd>
<dt>peptide.sequence</dt><dd><p>the sequence of the tryptic peptides of myoglobin, composed of amino acids' single-letter abbreviations.</p>
</dd>
<dt>group</dt><dd><p>four experimental groups, consisting &quot;label1&quot;, &quot;label2&quot;, &quot;label3&quot;, and &quot;control&quot;</p>
</dd>
<dt>err</dt><dd><p>error of the mass, in Dalton.</p>
</dd>
<dt>err.ppm</dt><dd><p>error of the mass, in parts per million (ppm) .</p>
</dd>
<dt>intensity</dt><dd><p>peak intensity, in &quot;counts&quot;.</p>
</dd>
</dl>



<h3>References</h3>

<p><a href="https://www.uniprot.org/uniprot/P68082">https://www.uniprot.org/uniprot/P68082</a>
</p>

<hr>
<h2 id='tag.search'>tag.search</h2><span id='topic+tag.search'></span>

<h3>Description</h3>

<p>This function takes a mass list dataset containing columns of &quot;mass&quot;, &quot;intensity&quot; and &quot;group&quot; (contains the &quot;control&quot; observations) , and searches within specified error tolerance for &quot;paired&quot; peaks, &quot;matched&quot; peaks, and &quot;mismatched&quot; peaks. Mass spectra peaks with m/z diffrence being the designated variable &quot;delta&quot; (within error tolerance) are defined as a &quot;pair&quot;, and peaks of the same m/z (within error tolerance) as &quot;match&quot;; otherwise defined as &quot;mismatch&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tag.search(dataset, delta = NA, error.Da.pair = 0.5,
  error.Da.match = 0.5, error.ppm.pair = Inf, error.ppm.match = Inf,
  intens.log.transfrom = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tag.search_+3A_dataset">dataset</code></td>
<td>
<p>a tidy dataset containing the mass list. At least three numeric columns are required: &quot;mass&quot;, &quot;intensity&quot; and &quot;group&quot;. The &quot;mass&quot; refers to m/z values; &quot;intensity&quot; refers to peak height/area; &quot;group&quot; must contain the &quot;control&quot; observations.</p>
</td></tr>
<tr><td><code id="tag.search_+3A_delta">delta</code></td>
<td>
<p>a single numeric value, or a numeric vector when multiple m/z difference is of interest. The variable &quot;delta&quot; reflects the mass difference between the labelled proteins/peptides vs. the non-labelled (the control), caused by the chemically-labelling group.</p>
</td></tr>
<tr><td><code id="tag.search_+3A_error.da.pair">error.Da.pair</code></td>
<td>
<p>error tolerance for the paired peaks, in Dalton; default at 0.5.</p>
</td></tr>
<tr><td><code id="tag.search_+3A_error.da.match">error.Da.match</code></td>
<td>
<p>error tolerance for the matched peaks, in Dalton; default at 0.5.</p>
</td></tr>
<tr><td><code id="tag.search_+3A_error.ppm.pair">error.ppm.pair</code></td>
<td>
<p>error tolerance threshold for the paired peaks, in ppm. For paired peaks p and q, the tolerance threshold is defined as 0.5 * (p+q) * error.ppm.pair / 10^6. When the absolute difference between the measured vs. theoretical delta is lower than the error tolerance, then the associated two peaks are considered a pair. The default value of error.ppm.pair is Inf (positive infinite); that is, the error tolerance by default is controled by error.Da.pair. When error.ppm.pair is otherwise set, say at 100 (ppm), then the practical error tolerance value is the smallest of either the Dalton control or ppm control. When the ppm control is more desirable than Dalton control, consider setting error.Da.pair = Inf.</p>
</td></tr>
<tr><td><code id="tag.search_+3A_error.ppm.match">error.ppm.match</code></td>
<td>
<p>error tolerance for the matched peaks, in ppm. Error tolerance control for matched peaks is similar to the case of paired peaks.</p>
</td></tr>
<tr><td><code id="tag.search_+3A_intens.log.transfrom">intens.log.transfrom</code></td>
<td>
<p>default to FALSE. If set to TRUE, peak intensities will be logarithmically transformed. This is useful for displaying low-intensity peaks that would otherwise be overshadowed and less visible in the mass spectra.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tidy dataset, with the original input dataset augmented with additional columns. The content in the input dataset remain unchanged (though the display sequence may change).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>search.result &lt;- tag.search(myoglobin, delta = c(14, 28), error.Da.pair = .3)
search.result
tag.spectra.listplot(search.result)
</code></pre>

<hr>
<h2 id='tag.spectra.butterflyplot'>tag.spectra.butterflyplot</h2><span id='topic+tag.spectra.butterflyplot'></span>

<h3>Description</h3>

<p>This function takes the output dataset from tag.search, and draw using ggplot2 the centroid mass spectra displayed in a mirrored or &quot;butterfly&quot; manner. Peaks from the same &quot;pair&quot; (with designated m/z difference) are highlighted in differentiating colors, distinguished away from peaks of the &quot;match&quot; (with the same m/z) and the &quot;mismatch&quot; (neither of the prior two cases).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tag.spectra.butterflyplot(search.output.list, show.peak.pair = TRUE,
  show.peak.match = TRUE, show.peak.mismatch = TRUE,
  show.annotation.pair = TRUE, show.annotation.match = TRUE,
  show.annotation.mismatch = TRUE, size.peak.pair = 2,
  size.peak.match = 1, size.peak.mismatch = 0.5, size.divider = 0.3,
  size.annotation.pair = NA, size.annotation.match = NA,
  size.annotation.mismatch = NA, size.groupname = NA,
  alpha.peak.pair = 0.8, alpha.peak.match = 0.5,
  alpha.peak.mismatch = 0.2, alpha.annotation.pair = 0.8,
  alpha.annotation.match = 0.5, alpha.annotation.mismatch = 0.2,
  color.pair = 1, color.match = "black", color.mismatch = "black",
  color.groupname = "black", color.divider = "black",
  angle.annotation = 90, angle.groupname = 90, gap.groupname = 0.1,
  gap.annotation = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tag.spectra.butterflyplot_+3A_search.output.list">search.output.list</code></td>
<td>
<p>the output list from function tag.search</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_show.peak.pair">show.peak.pair</code></td>
<td>
<p>if TRUE, show the paired peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_show.peak.match">show.peak.match</code></td>
<td>
<p>if TRUE, show the matched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_show.peak.mismatch">show.peak.mismatch</code></td>
<td>
<p>if TRUE, show the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_show.annotation.pair">show.annotation.pair</code></td>
<td>
<p>if TRUE, show the m/z annotations for the paired peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_show.annotation.match">show.annotation.match</code></td>
<td>
<p>if TRUE, show the m/z annotations for the mathced peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_show.annotation.mismatch">show.annotation.mismatch</code></td>
<td>
<p>if TRUE, show the m/z annotations for the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_size.peak.pair">size.peak.pair</code></td>
<td>
<p>adjust the peak width of the paired peaks. All size.xxx arguments take a numeric value, same functionality as line width or text size control in ggplot2</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_size.peak.match">size.peak.match</code></td>
<td>
<p>adjust the peak width of the matched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_size.peak.mismatch">size.peak.mismatch</code></td>
<td>
<p>adjust the peak width of the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_size.divider">size.divider</code></td>
<td>
<p>adjust divider width</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_size.annotation.pair">size.annotation.pair</code></td>
<td>
<p>adjust the m/z annotation text size for the paired peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_size.annotation.match">size.annotation.match</code></td>
<td>
<p>adjust the m/z annotation text size for the matched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_size.annotation.mismatch">size.annotation.mismatch</code></td>
<td>
<p>adjust the m/z annotation text size for the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_size.groupname">size.groupname</code></td>
<td>
<p>adjust the text size for groupnames (e.g., &quot;control&quot;, &quot;experiment1&quot;, &quot;experiment2&quot;, etc.).</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_alpha.peak.pair">alpha.peak.pair</code></td>
<td>
<p>adjust the transparency of the paired peaks. All alpha.xxx arguments take a numeric value [0,1]</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_alpha.peak.match">alpha.peak.match</code></td>
<td>
<p>adjust the transparency of the matched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_alpha.peak.mismatch">alpha.peak.mismatch</code></td>
<td>
<p>adjust the transparency of the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_alpha.annotation.pair">alpha.annotation.pair</code></td>
<td>
<p>adjust the transparency of the m/z annotations for the paired peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_alpha.annotation.match">alpha.annotation.match</code></td>
<td>
<p>adjust the transparency of the m/z annotations for the matched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_alpha.annotation.mismatch">alpha.annotation.mismatch</code></td>
<td>
<p>adjust the transparency of the m/z annotations for the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_color.pair">color.pair</code></td>
<td>
<p>control the color for the paired peaks and the associated m/z annotations. Each pair will be of the same color, and different pairs of differentiating colors. In case of multiple mass shifts being of interest within a pair, e.g., delta = c(14, 28, 56), then peaks with m/z difference of either 14, 28 or 56, all belonging to the same pair, will be of the same color.  Apart from the default color set, users could otherwise choose color from RColorBrewer palettes, e.g., color.pair = &quot;Set1&quot;, or color.pair = &quot;Blues&quot;.
</p>
<p>Colors for peaks (paired, matched, and mismatched) and the respectively associated annotations are designed to be of the same set of color for maximum clarity.</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_color.match">color.match</code></td>
<td>
<p>control the color for the matched peaks with the associated m/z annotations, with default in &quot;black&quot;. Users may otherwise reset to different colors, e.g., color.match = &quot;firebrick&quot;. As the matched peaks and mismatched peaks are usually of less research interest than paired peaks, the matched and mismatched peaks are respectively designed to be of monocolor.</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_color.mismatch">color.mismatch</code></td>
<td>
<p>control the color for the mismatched peaks with the associated m/z annotations, with default in &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_color.groupname">color.groupname</code></td>
<td>
<p>control the color for the groupnames, with default in &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_color.divider">color.divider</code></td>
<td>
<p>control the color of the central divider</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_angle.annotation">angle.annotation</code></td>
<td>
<p>adjust the angle for the m/z annotations, taking a numeric value. This argument is useful to avoid annotation overlap, and is particularly handy when the plot is reoriented with coord_flip().</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_angle.groupname">angle.groupname</code></td>
<td>
<p>adjust the angle of the groupnames.</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_gap.groupname">gap.groupname</code></td>
<td>
<p>adjust the horizontal position of groupnames. A positive numeric value adjusts the distance between groupnames and the left bound of the mass spectra; negative values shifts the groupnames to the right side.</p>
</td></tr>
<tr><td><code id="tag.spectra.butterflyplot_+3A_gap.annotation">gap.annotation</code></td>
<td>
<p>adjust the distance between m/z annotations and the top of the peak.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Though similar to tag.spectra.listplot, tag.spectra.butterflyplot is specifically designed for comparison of TWO mass spectra with the highest annotation clarity. That is, the “group” variable of the associated feeding dataset should contain only two unique levels, “control” and another named level. In case of existence of more than two levels in the “group” variable, all levels except “control” will be plotted overlapped with tag.spectra.butterflyplot; and it is recommended to use tag.spectra.listplot instead for multiple spectra drawing.
</p>


<h3>Value</h3>

<p>a ggplot2 plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subset &lt;-  myoglobin[myoglobin$group %in% c("control", "label1"), ]
search.result &lt;- tag.search(subset, delta = c(14, 28), error.Da.pair = .3)
tag.spectra.butterflyplot(search.result)

</code></pre>

<hr>
<h2 id='tag.spectra.listplot'>tag.spectra.listplot</h2><span id='topic+tag.spectra.listplot'></span>

<h3>Description</h3>

<p>This function takes the output dataset from tag.search, and draw using ggplot2 the centroid mass spectra displayed in a listed manner. Peaks from the same &quot;pair&quot; (with designated m/z difference) are highlighted in differentiating colors, distinguished away from peaks of the &quot;match&quot; (with the same m/z) and the &quot;mismatch&quot; (neither of the prior two cases).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tag.spectra.listplot(search.output.list, show.peak.pair = TRUE,
  show.peak.match = TRUE, show.peak.mismatch = TRUE,
  show.annotation.pair = TRUE, show.annotation.match = TRUE,
  show.annotation.mismatch = FALSE, size.peak.pair = 2,
  size.peak.match = 1, size.peak.mismatch = 0.5, size.divider = 0.3,
  size.annotation.pair = NA, size.annotation.match = NA,
  size.annotation.mismatch = NA, size.groupname = NA,
  alpha.peak.pair = 0.8, alpha.peak.match = 0.5,
  alpha.peak.mismatch = 0.2, alpha.annotation.pair = 0.8,
  alpha.annotation.match = 0.5, alpha.annotation.mismatch = 0.2,
  color.pair = 1, color.match = "black", color.mismatch = "black",
  color.groupname = "black", color.divider = "black",
  angle.annotation = 90, angle.groupname = 90, gap.groupname = 0.02,
  gap.annotation = 0.15, peak.height.shrink = 0.7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tag.spectra.listplot_+3A_search.output.list">search.output.list</code></td>
<td>
<p>the output list from function tag.search</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_show.peak.pair">show.peak.pair</code></td>
<td>
<p>if TRUE, show the paired peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_show.peak.match">show.peak.match</code></td>
<td>
<p>if TRUE, show the matched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_show.peak.mismatch">show.peak.mismatch</code></td>
<td>
<p>if TRUE, show the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_show.annotation.pair">show.annotation.pair</code></td>
<td>
<p>if TRUE, show the m/z annotations for the paired peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_show.annotation.match">show.annotation.match</code></td>
<td>
<p>if TRUE, show the m/z annotations for the mathced peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_show.annotation.mismatch">show.annotation.mismatch</code></td>
<td>
<p>if TRUE, show the m/z annotations for the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_size.peak.pair">size.peak.pair</code></td>
<td>
<p>adjust the peak width of the paired peaks. All size.xxx arguments take a numeric value, same functionality as line width or text size control in ggplot2</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_size.peak.match">size.peak.match</code></td>
<td>
<p>adjust the peak width of the matched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_size.peak.mismatch">size.peak.mismatch</code></td>
<td>
<p>adjust the peak width of the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_size.divider">size.divider</code></td>
<td>
<p>adjust divider width</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_size.annotation.pair">size.annotation.pair</code></td>
<td>
<p>adjust the m/z annotation text size for the paired peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_size.annotation.match">size.annotation.match</code></td>
<td>
<p>adjust the m/z annotation text size for the matched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_size.annotation.mismatch">size.annotation.mismatch</code></td>
<td>
<p>adjust the m/z annotation text size for the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_size.groupname">size.groupname</code></td>
<td>
<p>adjust the text size for groupnames (e.g., &quot;control&quot;, &quot;experiment1&quot;, &quot;experiment2&quot;, etc.).</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_alpha.peak.pair">alpha.peak.pair</code></td>
<td>
<p>adjust the transparency of the paired peaks. All alpha.xxx arguments take a numeric value [0,1]</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_alpha.peak.match">alpha.peak.match</code></td>
<td>
<p>adjust the transparency of the matched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_alpha.peak.mismatch">alpha.peak.mismatch</code></td>
<td>
<p>adjust the transparency of the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_alpha.annotation.pair">alpha.annotation.pair</code></td>
<td>
<p>adjust the transparency of the m/z annotations for the paired peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_alpha.annotation.match">alpha.annotation.match</code></td>
<td>
<p>adjust the transparency of the m/z annotations for the matched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_alpha.annotation.mismatch">alpha.annotation.mismatch</code></td>
<td>
<p>adjust the transparency of the m/z annotations for the mismatched peaks</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_color.pair">color.pair</code></td>
<td>
<p>control the color for the paired peaks and the associated m/z annotations. Each pair will be of the same color, and different pairs of differentiating colors. In case of multiple mass shifts being of interest within a pair, e.g., delta = c(14, 28, 56), then peaks with m/z difference of either 14, 28 or 56, all belonging to the same pair, will be of the same color.  Apart from the default color set, users could otherwise choose color from RColorBrewer palettes, e.g., color.pair = &quot;Set1&quot;, or color.pair = &quot;Blues&quot;.
</p>
<p>Colors for peaks (paired, matched, and mismatched) and the respectively associated annotations are designed to be of the same set of color for maximum clarity.</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_color.match">color.match</code></td>
<td>
<p>control the color for the matched peaks with the associated m/z annotations, with default in &quot;black&quot;. Users may otherwise reset to different colors, e.g., color.match = &quot;firebrick&quot;. As the matched peaks and mismatched peaks are usually of less research interest than paired peaks, the matched and mismatched peaks are respectively designed to be of monocolor.</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_color.mismatch">color.mismatch</code></td>
<td>
<p>control the color for the mismatched peaks with the associated m/z annotations, with default in &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_color.groupname">color.groupname</code></td>
<td>
<p>control the color for the groupnames, with default in &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_color.divider">color.divider</code></td>
<td>
<p>control the color of the central divider</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_angle.annotation">angle.annotation</code></td>
<td>
<p>adjust the angle for the m/z annotations, taking a numeric value. This argument is useful to avoid annotation overlap, and is particularly handy when the plot is reoriented with coord_flip().</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_angle.groupname">angle.groupname</code></td>
<td>
<p>adjust the angle of the groupnames.</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_gap.groupname">gap.groupname</code></td>
<td>
<p>adjust the horizontal position of groupnames. A positive numeric value adjusts the distance between groupnames and the left bound of the mass spectra; negative values shifts the groupnames to the right side.</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_gap.annotation">gap.annotation</code></td>
<td>
<p>adjust the distance between m/z annotations and the top of the peak.</p>
</td></tr>
<tr><td><code id="tag.spectra.listplot_+3A_peak.height.shrink">peak.height.shrink</code></td>
<td>
<p>Taking a numeric value [0, 1], a small shrinking factor renders smaller peak height, and generates more space between peak and the central divider, leaving more space for annotations. This argument resolves overlap among annotations with upper-floor-residing peaks, a problem unique to listplot. Therefore, this argument is not used in the butterflyplot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed for comparison of multiple mass spectra. In case of comparison of two mass spectra, it is recommended to use tag.spectra.butterflyplot for the highest annotation clarity.
</p>


<h3>Value</h3>

<p>a ggplot2 plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>search.result &lt;- tag.search(myoglobin, delta = c(14, 28), error.Da.pair = .3)
search.result
tag.spectra.listplot(search.result)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
