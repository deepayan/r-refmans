<!DOCTYPE html><html><head><title>Help for package QUALYPSO</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {QUALYPSO}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fit.climate.response'><p>fit.climate.response</p></a></li>
<li><a href='#get.Qmat'><p>get.Qmat</p></a></li>
<li><a href='#get.Qstar.mat'><p>get.Qstar.mat</p></a></li>
<li><a href='#lm.ANOVA'><p>lm.ANOVA</p></a></li>
<li><a href='#plotQUALYPSOclimateChangeResponse'><p>plotQUALYPSOclimateChangeResponse</p></a></li>
<li><a href='#plotQUALYPSOclimateResponse'><p>plotQUALYPSOclimateResponse</p></a></li>
<li><a href='#plotQUALYPSOeffect'><p>plotQUALYPSOeffect</p></a></li>
<li><a href='#plotQUALYPSOgrandmean'><p>plotQUALYPSOgrandmean</p></a></li>
<li><a href='#plotQUALYPSOMeanChangeAndUncertainties'><p>plotQUALYPSOMeanChangeAndUncertainties</p></a></li>
<li><a href='#plotQUALYPSOMeanChangeAndUncertaintiesBetatest'><p>plotQUALYPSOMeanChangeAndUncertaintiesBetatest</p></a></li>
<li><a href='#plotQUALYPSOTotalVarianceByScenario'><p>plotQUALYPSOTotalVarianceByScenario</p></a></li>
<li><a href='#plotQUALYPSOTotalVarianceDecomposition'><p>plotQUALYPSOTotalVarianceDecomposition</p></a></li>
<li><a href='#QUALYPSO'><p>QUALYPSO</p></a></li>
<li><a href='#QUALYPSO.ANOVA'><p>QUALYPSO.ANOVA</p></a></li>
<li><a href='#QUALYPSO.ANOVA.i'><p>QUALYPSO.ANOVA.i</p></a></li>
<li><a href='#QUALYPSO.check.option'><p>QUALYPSO.check.option</p></a></li>
<li><a href='#QUALYPSO.process.scenario'><p>QUALYPSO.process.scenario</p></a></li>
<li><a href='#scenAvail'><p>List of GCM and RCM which have been used for the 20 climate projections</p></a></li>
<li><a href='#X_globaltas'><p>Annual warming levels simulated by different CMIP5 GCMs</p></a></li>
<li><a href='#X_time_mat'><p>Years 1971-2099 repeated for the 20 scenarios</p></a></li>
<li><a href='#X_time_vec'><p>X_time_vec gives the years corr. to Y, i.e. from 1971 to 2099</p></a></li>
<li><a href='#Xfut_globaltas'><p>Vector of of future warming levels</p></a></li>
<li><a href='#Xfut_time'><p>Xfut_time is a vector of 11 years equally spaced from 1999 to 2099</p></a></li>
<li><a href='#Y'><p>Mean winter temperature over CEU with 20 GCM/RCM combinations for 1971-2099</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-24</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Title:</td>
<td>Partitioning Uncertainty Components of an Incomplete Ensemble of
Climate Projections</td>
</tr>
<tr>
<td>Version:</td>
<td>2.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Guillaume Evin [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guillaume Evin &lt;guillaume.evin@inrae.fr&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, expm, Rfast, stats, graphics, grDevices</td>
</tr>
<tr>
<td>Description:</td>
<td>These functions use data augmentation and Bayesian techniques for the assessment of single-member and incomplete ensembles of climate projections. It provides unbiased estimates of climate change responses of all simulation chains and of all uncertainty variables. It additionally propagates uncertainty due to missing information in the estimates.
  - Evin, G., B. Hingray, J. Blanchet, N. Eckert, S. Morin, and D. Verfaillie. (2019) &lt;<a href="https://doi.org/10.1175%2FJCLI-D-18-0606.1">doi:10.1175/JCLI-D-18-0606.1</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-24 07:13:30 UTC; eving</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-24 07:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fit.climate.response'>fit.climate.response</h2><span id='topic+fit.climate.response'></span>

<h3>Description</h3>

<p>Fit trends for each simulation chain of an ensemble of <code>nS</code> projections. Each simulation chain is a time series
of <code>nY</code> time steps (e.g. number of years).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.climate.response(Y, args.smooth.spline, Xmat, Xfut, typeChangeVariable)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.climate.response_+3A_y">Y</code></td>
<td>
<p>matrix of simulation chains: <code>nS</code> x <code>nY</code></p>
</td></tr>
<tr><td><code id="fit.climate.response_+3A_args.smooth.spline">args.smooth.spline</code></td>
<td>
<p>list of arguments to be passed to <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>.
The <code>names</code> attribute of <code>args.smooth.spline</code> gives the argument
names (see <code><a href="base.html#topic+do.call">do.call</a></code>).</p>
</td></tr>
<tr><td><code id="fit.climate.response_+3A_xmat">Xmat</code></td>
<td>
<p>matrix of predictors corresponding to the projections, e.g. time or global temperature.</p>
</td></tr>
<tr><td><code id="fit.climate.response_+3A_xfut">Xfut</code></td>
<td>
<p>values of the predictor over which the ANOVA will be applied.</p>
</td></tr>
<tr><td><code id="fit.climate.response_+3A_typechangevariable">typeChangeVariable</code></td>
<td>
<p>type of change variable: &quot;abs&quot; (absolute, value by default) or &quot;rel&quot; (relative)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+QUALYPSO">QUALYPSO</a></code> for further information on arguments <code>indexReferenceYear</code> and <code>typeChangeVariable</code>.
</p>


<h3>Value</h3>

<p>list with the following fields for each simulation chain:
</p>

<ul>
<li> <p><strong>YStar</strong>: <code>nS x nY</code>, change variable
</p>
</li>
<li> <p><strong>phiStar</strong>: <code>nS x nF</code>, climate change responses
</p>
</li>
<li> <p><strong>etaStar</strong>: <code>nS x nY</code>, deviation from the climate change response
due to the internal variability, for <code>Xmat</code>
</p>
</li>
<li> <p><strong>phi</strong>: <code>nS x nF</code>, raw trends obtained using <a href="stats.html#topic+smooth.spline">smooth.spline</a>
</p>
</li>
<li> <p><strong>climateResponse</strong>: output from <a href="stats.html#topic+smooth.spline">smooth.spline</a>
</p>
</li>
<li> <p><strong>varInterVariability</strong>: scalar, internal variability component of the MME
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>Evin, G., B. Hingray, J. Blanchet, N. Eckert, S. Morin, and D. Verfaillie (2020)
Partitioning Uncertainty Components of an Incomplete Ensemble of Climate Projections Using Data Augmentation.
Journal of Climate. J. Climate, 32, 2423–2440. &lt;doi:10.1175/JCLI-D-18-0606.1&gt;.
</p>

<hr>
<h2 id='get.Qmat'>get.Qmat</h2><span id='topic+get.Qmat'></span>

<h3>Description</h3>

<p>Provide matrix Q derived from a matrix Q* of Helmert contrasts: </p>
<p style="text-align: center;"><code class="reqn">Q = Q^* (Q^{*T} Q^*)^{-1/2}</code>
</p>

<p>See Eq. A6 in Evin et al., 2019.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.Qmat(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.Qmat_+3A_p">p</code></td>
<td>
<p>integer</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>p x p matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>Evin, G., B. Hingray, J. Blanchet, N. Eckert, S. Morin, and D. Verfaillie (2020)
Partitioning Uncertainty Components of an Incomplete Ensemble of Climate Projections Using Data Augmentation.
Journal of Climate. J. Climate, 32, 2423–2440. &lt;doi:10.1175/JCLI-D-18-0606.1&gt;.
</p>

<hr>
<h2 id='get.Qstar.mat'>get.Qstar.mat</h2><span id='topic+get.Qstar.mat'></span>

<h3>Description</h3>

<p>Provide matrix containing Helmert contrasts (see Eq. A7 in Evin et al., 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.Qstar.mat(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.Qstar.mat_+3A_p">p</code></td>
<td>
<p>integer</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>
<p>p x (p-1) matrix containing Helmert contrasts</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>Evin, G., B. Hingray, J. Blanchet, N. Eckert, S. Morin, and D. Verfaillie (2020) &lt;doi:10.1175/JCLI-D-18-0606.1&gt;.
</p>
<p>Evin, G., B. Hingray, J. Blanchet, N. Eckert, S. Morin, and D. Verfaillie (2020)
Partitioning Uncertainty Components of an Incomplete Ensemble of Climate Projections Using Data Augmentation.
Journal of Climate. J. Climate, 32, 2423–2440. &lt;doi:10.1175/JCLI-D-18-0606.1&gt;.
</p>

<hr>
<h2 id='lm.ANOVA'>lm.ANOVA</h2><span id='topic+lm.ANOVA'></span>

<h3>Description</h3>

<p>Partition uncertainty in climate responses using an ANOVA inferred with a Bayesian approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lm.ANOVA(phiStar, scenAvail, listOption = NULL, namesEff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lm.ANOVA_+3A_phistar">phiStar</code></td>
<td>
<p>matrix of climate change responses (absolute or relative changes): <code>nS</code> x <code>n</code>. <code>n</code> can be the number of time steps or the number of grid points</p>
</td></tr>
<tr><td><code id="lm.ANOVA_+3A_scenavail">scenAvail</code></td>
<td>
<p>data.frame <code>nS</code> x <code>nEff</code> with the <code>nEff</code> characteristics (e.g. type of GCM) for each of the <code>nS</code> x <code>nS</code> scenarios</p>
</td></tr>
<tr><td><code id="lm.ANOVA_+3A_listoption">listOption</code></td>
<td>
<p>list of options (see <code><a href="#topic+QUALYPSO">QUALYPSO</a></code>)</p>
</td></tr>
<tr><td><code id="lm.ANOVA_+3A_nameseff">namesEff</code></td>
<td>
<p>names of the main effects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the following fields:
</p>

<ul>
<li> <p><strong>GRANDMEAN</strong>: List of estimates for the grand mean:
</p>

<ul>
<li> <p>strong: MEAN: vector of length <code>n</code> of means
</p>
</li>
<li> <p>strong: SD: vector of length <code>n</code> of standard dev.
</p>
</li>
<li> <p>strong: CI: matrix <code>n</code> x 2 of credible intervals of
probability <code>probCI</code> given in <code>listOption</code>.
</p>
</li></ul>

</li>
<li> <p><strong>RESIDUALVAR</strong>: List of estimates for the variance of the
residual errors:
</p>

<ul>
<li> <p>strong: MEAN: vector of length <code>n</code>
</p>
</li></ul>

</li>
<li> <p><strong>MAINEFFECT</strong>: List of estimates for the main effects. For each
main effect (GCM, RCM,..), each element of the list contains a list with:
</p>

<ul>
<li> <p>strong: MEAN: matrix <code>n</code> x <code>nTypeEff</code>
</p>
</li></ul>

</li>
<li> <p><strong>CHANGEBYEFFECT</strong>: For each main effect, list of estimates for
the mean change by main effect, i.e. mean change by scenario (RCP4.5). For
each main effect (GCM, RCM,..), each element of the list contains a list with:
</p>

<ul>
<li> <p>strong: MEAN: matrix <code>n</code> x <code>nTypeEff</code>
</p>
</li></ul>

</li>
<li> <p><strong>EFFECTVAR</strong>: variability related to the main effects (i.e.
variability between the different RCMs, GCMs,..). Matrix <code>n</code> x
<code>nTypeEff</code>
</p>
</li>
<li> <p><strong>CONTRIB_EACH_EFFECT</strong>: Contribution of each individual effect
to its component (percentage), e.g. what is the contribution of GCM1 to the
variability related to GCMs. For each main effect (GCM, RCM,..), each
element of the list contains a matrix <code>n</code> x <code>nTypeEff</code>
</p>
</li>
<li> <p><strong>listOption</strong>: list of options used to obtained these results
(obtained from <code><a href="#topic+QUALYPSO.check.option">QUALYPSO.check.option</a></code>)
</p>
</li>
<li> <p><strong>listScenarioInput</strong>: list of scenario characteristics
(obtained from <code><a href="#topic+QUALYPSO.process.scenario">QUALYPSO.process.scenario</a></code>)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='plotQUALYPSOclimateChangeResponse'>plotQUALYPSOclimateChangeResponse</h2><span id='topic+plotQUALYPSOclimateChangeResponse'></span>

<h3>Description</h3>

<p>Plot climate change responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotQUALYPSOclimateChangeResponse(
  QUALYPSOOUT,
  lim = NULL,
  xlab = "",
  ylab = "Climate change response",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotQUALYPSOclimateChangeResponse_+3A_qualypsoout">QUALYPSOOUT</code></td>
<td>
<p>output from <code><a href="#topic+QUALYPSO">QUALYPSO</a></code></p>
</td></tr>
<tr><td><code id="plotQUALYPSOclimateChangeResponse_+3A_lim">lim</code></td>
<td>
<p>y-axis limits (default is NULL)</p>
</td></tr>
<tr><td><code id="plotQUALYPSOclimateChangeResponse_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOclimateChangeResponse_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOclimateChangeResponse_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='plotQUALYPSOclimateResponse'>plotQUALYPSOclimateResponse</h2><span id='topic+plotQUALYPSOclimateResponse'></span>

<h3>Description</h3>

<p>Plot the climate responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotQUALYPSOclimateResponse(
  QUALYPSOOUT,
  lim = NULL,
  xlab = "X",
  ylab = "Y",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotQUALYPSOclimateResponse_+3A_qualypsoout">QUALYPSOOUT</code></td>
<td>
<p>output from <code><a href="#topic+QUALYPSO">QUALYPSO</a></code></p>
</td></tr>
<tr><td><code id="plotQUALYPSOclimateResponse_+3A_lim">lim</code></td>
<td>
<p>y-axis limits (default is NULL)</p>
</td></tr>
<tr><td><code id="plotQUALYPSOclimateResponse_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOclimateResponse_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOclimateResponse_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='plotQUALYPSOeffect'>plotQUALYPSOeffect</h2><span id='topic+plotQUALYPSOeffect'></span>

<h3>Description</h3>

<p>Plot prediction of ANOVA effects for one main effect. By default, we plot we plot the credible intervals corresponding to a probability 0.95.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotQUALYPSOeffect(
  QUALYPSOOUT,
  nameEff,
  includeMean = FALSE,
  lim = NULL,
  col = 1:20,
  xlab = "",
  ylab = "Effect",
  addLegend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotQUALYPSOeffect_+3A_qualypsoout">QUALYPSOOUT</code></td>
<td>
<p>output from <code><a href="#topic+QUALYPSO">QUALYPSO</a></code></p>
</td></tr>
<tr><td><code id="plotQUALYPSOeffect_+3A_nameeff">nameEff</code></td>
<td>
<p>name of the main effect to be plotted in <code>QUALYPSOOUT$namesEff</code></p>
</td></tr>
<tr><td><code id="plotQUALYPSOeffect_+3A_includemean">includeMean</code></td>
<td>
<p>if TRUE, the grand mean is added to the main effect in the plot</p>
</td></tr>
<tr><td><code id="plotQUALYPSOeffect_+3A_lim">lim</code></td>
<td>
<p>y-axis limits (default is NULL)</p>
</td></tr>
<tr><td><code id="plotQUALYPSOeffect_+3A_col">col</code></td>
<td>
<p>colors for each effect</p>
</td></tr>
<tr><td><code id="plotQUALYPSOeffect_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOeffect_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOeffect_+3A_addlegend">addLegend</code></td>
<td>
<p>if TRUE, a legend is added</p>
</td></tr>
<tr><td><code id="plotQUALYPSOeffect_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='plotQUALYPSOgrandmean'>plotQUALYPSOgrandmean</h2><span id='topic+plotQUALYPSOgrandmean'></span>

<h3>Description</h3>

<p>Plot prediction of grand mean ensemble.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotQUALYPSOgrandmean(
  QUALYPSOOUT,
  lim = NULL,
  col = "black",
  xlab = "",
  ylab = "Grand mean",
  addLegend = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotQUALYPSOgrandmean_+3A_qualypsoout">QUALYPSOOUT</code></td>
<td>
<p>output from <code><a href="#topic+QUALYPSO">QUALYPSO</a></code></p>
</td></tr>
<tr><td><code id="plotQUALYPSOgrandmean_+3A_lim">lim</code></td>
<td>
<p>y-axis limits (default is NULL)</p>
</td></tr>
<tr><td><code id="plotQUALYPSOgrandmean_+3A_col">col</code></td>
<td>
<p>color for the overall mean and the credible interval</p>
</td></tr>
<tr><td><code id="plotQUALYPSOgrandmean_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOgrandmean_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOgrandmean_+3A_addlegend">addLegend</code></td>
<td>
<p>if TRUE, a legend is added</p>
</td></tr>
<tr><td><code id="plotQUALYPSOgrandmean_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='plotQUALYPSOMeanChangeAndUncertainties'>plotQUALYPSOMeanChangeAndUncertainties</h2><span id='topic+plotQUALYPSOMeanChangeAndUncertainties'></span>

<h3>Description</h3>

<p>Plot fraction of total variance explained by each source of uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotQUALYPSOMeanChangeAndUncertainties(
  QUALYPSOOUT,
  col = NULL,
  ylim = NULL,
  xlab = "",
  ylab = "Change variable",
  addLegend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertainties_+3A_qualypsoout">QUALYPSOOUT</code></td>
<td>
<p>output from <code><a href="#topic+QUALYPSO">QUALYPSO</a></code></p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertainties_+3A_col">col</code></td>
<td>
<p>colors for each source of uncertainty, the first two colors corresponding to internal variability and residual variability, respectively</p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertainties_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits</p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertainties_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertainties_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertainties_+3A_addlegend">addLegend</code></td>
<td>
<p>if TRUE, a legend is added</p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertainties_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='plotQUALYPSOMeanChangeAndUncertaintiesBetatest'>plotQUALYPSOMeanChangeAndUncertaintiesBetatest</h2><span id='topic+plotQUALYPSOMeanChangeAndUncertaintiesBetatest'></span>

<h3>Description</h3>

<p>Plot fraction of total variance explained by each source of uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotQUALYPSOMeanChangeAndUncertaintiesBetatest(
  QUALYPSOOUT,
  col = NULL,
  ylim = NULL,
  xlab = "",
  ylab = "Change variable",
  addLegend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertaintiesBetatest_+3A_qualypsoout">QUALYPSOOUT</code></td>
<td>
<p>output from <code><a href="#topic+QUALYPSO">QUALYPSO</a></code></p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertaintiesBetatest_+3A_col">col</code></td>
<td>
<p>colors for each source of uncertainty, the first two colors corresponding to internal variability and residual variability, respectively</p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertaintiesBetatest_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits</p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertaintiesBetatest_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertaintiesBetatest_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertaintiesBetatest_+3A_addlegend">addLegend</code></td>
<td>
<p>if TRUE, a legend is added</p>
</td></tr>
<tr><td><code id="plotQUALYPSOMeanChangeAndUncertaintiesBetatest_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='plotQUALYPSOTotalVarianceByScenario'>plotQUALYPSOTotalVarianceByScenario</h2><span id='topic+plotQUALYPSOTotalVarianceByScenario'></span>

<h3>Description</h3>

<p>Plot fraction of total variance explained by each source of uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotQUALYPSOTotalVarianceByScenario(
  QUALYPSOOUT,
  nameEff,
  nameScenario,
  col = NULL,
  ylim = NULL,
  xlab = "",
  ylab = "Change variable",
  addLegend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotQUALYPSOTotalVarianceByScenario_+3A_qualypsoout">QUALYPSOOUT</code></td>
<td>
<p>output from <code><a href="#topic+QUALYPSO">QUALYPSO</a></code></p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceByScenario_+3A_nameeff">nameEff</code></td>
<td>
<p>name of the main effect to be plotted in <code>QUALYPSOOUT$namesEff</code></p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceByScenario_+3A_namescenario">nameScenario</code></td>
<td>
<p>name of the scenario to be plotted (as provided in <code>scenAvail</code>)</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceByScenario_+3A_col">col</code></td>
<td>
<p>colors for each source of uncertainty, the first two colors
corresponding to internal variability and residual variability, respectively</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceByScenario_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceByScenario_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceByScenario_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceByScenario_+3A_addlegend">addLegend</code></td>
<td>
<p>if TRUE, a legend is added</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceByScenario_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='plotQUALYPSOTotalVarianceDecomposition'>plotQUALYPSOTotalVarianceDecomposition</h2><span id='topic+plotQUALYPSOTotalVarianceDecomposition'></span>

<h3>Description</h3>

<p>Plot fraction of total variance explained by each source of uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotQUALYPSOTotalVarianceDecomposition(
  QUALYPSOOUT,
  vecEff = NULL,
  col = c("orange", "yellow", "cadetblue1", "blue1", "darkgreen", "darkgoldenrod4",
    "darkorchid1"),
  xlab = "",
  ylab = "% Total Variance",
  addLegend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotQUALYPSOTotalVarianceDecomposition_+3A_qualypsoout">QUALYPSOOUT</code></td>
<td>
<p>output from <code><a href="#topic+QUALYPSO">QUALYPSO</a></code></p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceDecomposition_+3A_veceff">vecEff</code></td>
<td>
<p>vector of indices corresponding to the main effects (NULL by default), so that the order of appearance in the plot can be modified</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceDecomposition_+3A_col">col</code></td>
<td>
<p>colors for each source of uncertainty, the first two colors corresponding to internal variability and residual variability, respectively</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceDecomposition_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceDecomposition_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceDecomposition_+3A_addlegend">addLegend</code></td>
<td>
<p>if TRUE, a legend is added</p>
</td></tr>
<tr><td><code id="plotQUALYPSOTotalVarianceDecomposition_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='QUALYPSO'>QUALYPSO</h2><span id='topic+QUALYPSO'></span>

<h3>Description</h3>

<p>Partition uncertainty in climate responses using an ANOVA applied to climate change responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QUALYPSO(Y, scenAvail, X = NULL, Xfut = NULL, iFut = NULL, listOption = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QUALYPSO_+3A_y">Y</code></td>
<td>
<p>matrix <code>nS</code> x <code>nY</code> or array <code>nG</code> x <code>nS</code> x <code>nY</code> of climate projections.</p>
</td></tr>
<tr><td><code id="QUALYPSO_+3A_scenavail">scenAvail</code></td>
<td>
<p>data.frame <code>nS</code> x <code>nEff</code> with the <code>nEff</code> characteristics
(e.g. type of GCM) for each of the <code>nS</code> scenarios. The number of characteristics
<code>nEff</code> corresponds to the number of main effects that will be included in the ANOVA model.</p>
</td></tr>
<tr><td><code id="QUALYPSO_+3A_x">X</code></td>
<td>
<p>(optional) predictors corresponding to the projections, e.g. time or global temperature.
It can be a vector if the predictor is the same for all scenarios (e.g. <code>X=2001:2100</code>) or
a matrix of the same size as Y if these predictors are different for the scenarios. By default,
a vector <code>1:nY</code> is created.</p>
</td></tr>
<tr><td><code id="QUALYPSO_+3A_xfut">Xfut</code></td>
<td>
<p>(optional) <code>nF</code> values of the predictor over which the ANOVA will be applied. It must be
a vector of values within the range of values of X. By default, it corresponds to X if X is a vector,
<code>1:nY</code> if X is <code>NULL</code> or a vector of 10 values equally spaced between the minimum and
maximum values of X if X is a matrix.</p>
</td></tr>
<tr><td><code id="QUALYPSO_+3A_ifut">iFut</code></td>
<td>
<p>index in <code>1:nF</code> corresponding to a future predictor value . This index is
necessary when <code>Y</code> is an array <code>nG</code> x <code>nS</code> x <code>nY</code> available for <code>nG</code> grid points.
Indeed, in this case, we run QUALYPSO only for one future predictor. The first value defines the reference
period or warming level.</p>
</td></tr>
<tr><td><code id="QUALYPSO_+3A_listoption">listOption</code></td>
<td>
<p>(optional) list of options
</p>

<ul>
<li> <p><strong>args.smooth.spline</strong>: list of arguments to be passed to
<code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>. The <code>names</code> attribute of
<code>args.smooth.spline</code> gives the argument names (see <code><a href="base.html#topic+do.call">do.call</a></code>).
The default option runs <code>smooth.spline</code> with <code>spar</code>=1.
</p>
</li>
<li> <p><strong>typeChangeVariable</strong>: type of change variable: &quot;abs&quot; (absolute, value by default) or &quot;rel&quot; (relative).
</p>
</li>
<li> <p><strong>ANOVAmethod</strong>: ANOVA method: &quot;QUALYPSO&quot; applies the method described in Evin et al. (2020),
&quot;lm&quot; applies a simple linear model to estimate the main effects.
</p>
</li>
<li> <p><strong>nBurn</strong>: if <code>ANOVAmethod=="QUALYPSO"</code>, number of burn-in samples (default: 1000).
If <code>nBurn</code> is too small, the convergence of MCMC chains might not be obtained.
</p>
</li>
<li> <p><strong>nKeep</strong>: if <code>ANOVAmethod=="QUALYPSO"</code>, number of kept samples (default: 2000).
If <code>nKeep</code> is too small, MCMC samples might not represent correctly the posterior
distributions of inferred parameters.
</p>
</li>
<li> <p><strong>probCI</strong>: probability (in [0,1]) for the confidence intervals, <code>probCI = 0.9</code> by default.
</p>
</li>
<li> <p><strong>quantilePosterior</strong>: vector of probabilities (in [0,1]) for which
we compute the quantiles from the posterior distributions
<code>quantilePosterior = c(0.005,0.025,0.05,0.1,0.25,0.33,0.5,0.66,0.75,0.9,0.95,0.975,0.995)</code> by default.
</p>
</li>
<li> <p><strong>climResponse</strong>: NULL by default. If it is provided, it must correspond to the outputs
of <code><a href="#topic+fit.climate.response">fit.climate.response</a></code>, i.e. a list with <code>YStar</code> [nS x nY], <code>phiStar</code> [nS x nF],
<code>etaStar</code> [nS x nY], <code>phi</code> [nS x nF] and <code>varInterVariability</code> [scalar] if <code>Y</code> is a matrix [nS x nY],
or a list with <code>phiStar</code> [nG x nS x nF], <code>etaStar</code> [nG x nS x nY], <code>phi</code> [nG x nS x nF] and
<code>varInterVariability</code> vector of length <code>nG</code> if <code>Y</code> is an array [nG x nS x nY].
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>List providing the results for each of the <code>n</code> values of <code>Xfut</code>
if <code>Y</code> is a matrix or for each grid point if <code>Y</code> is an array, with the following fields:
</p>

<ul>
<li> <p><strong>CLIMATERESPONSE</strong>: list of climate change responses and
corresponding internal variability. Contains <code>phiStar</code> (climate change
responses), <code>etaStar</code> (deviation from the climate change responses as
a result of internal variability), <code>Ystar</code> (change variable from the
projections),and <code>phi</code> (fitted climate responses).
</p>
</li>
<li> <p><strong>GRANDMEAN</strong>: List of estimates for the grand mean:
</p>

<ul>
<li> <p><strong>MEAN</strong>: vector of length <code>n</code> of means.
</p>
</li>
<li> <p><strong>SD</strong>: vector of length <code>n</code> of standard dev.
if <code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li>
<li> <p><strong>CI</strong>: matrix <code>n</code> x 2 of credible intervals of
probability <code>probCI</code> given in <code>listOption</code> if
<code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li>
<li> <p><strong>QUANT</strong>: matrix <code>n</code> x <code>nQ</code> of quantiles of
probability <code>quantilePosterior</code> given in <code>listOption</code> if
<code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li></ul>

</li>
<li> <p><strong>MAINEFFECT</strong>: List of estimates for the main effects. For each
main effect (GCM, RCM,..), each element of the list contains a list with:
</p>

<ul>
<li> <p><strong>MEAN</strong>: matrix <code>n</code> x <code>nTypeEff</code>
</p>
</li>
<li> <p><strong>SD</strong>: matrix <code>n</code> x <code>nTypeEff</code> of standard dev.
if <code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li>
<li> <p><strong>CI</strong>: array <code>n</code> x 2 x <code>nTypeEff</code> of credible
intervals of probability <code>probCI</code> given in <code>listOption</code> if
<code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li>
<li> <p><strong>QUANT</strong>: array <code>n</code> x <code>nQ</code> x <code>nTypeEff</code> of
quantiles of probability <code>quantilePosterior</code> given in
<code>listOption</code> if <code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li></ul>

</li>
<li> <p><strong>CHANGEBYEFFECT</strong>: For each main effect, list of estimates for
the mean change by main effect, i.e. mean change by scenario. For
each main effect (GCM, RCM,..), each element of the list contains a list with:
</p>

<ul>
<li> <p><strong>MEAN</strong>: matrix <code>n</code> x <code>nTypeEff</code>
</p>
</li>
<li> <p><strong>SD</strong>: matrix <code>n</code> x <code>nTypeEff</code> of standard dev.
if <code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li>
<li> <p><strong>CI</strong>: array <code>n</code> x 2 x <code>nTypeEff</code> of credible
intervals of probability <code>probCI</code> given in <code>listOption</code> if
<code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li>
<li> <p><strong>QUANT</strong>: array <code>n</code> x <code>nQ</code> x <code>nTypeEff</code> of
quantiles of probability <code>quantilePosterior</code> given in
<code>listOption</code> if <code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li></ul>

</li>
<li> <p><strong>EFFECTVAR</strong>: Matrix <code>n</code> x <code>nTypeEff</code> giving, for each
time variability related to the main effects (i.e.
variability between the different RCMs, GCMs,..).
</p>
</li>
<li> <p><strong>CONTRIB_EACH_EFFECT</strong>: Contribution of each individual effect
to its component (percentage), e.g. what is the contribution of GCM1 to the
variability related to GCMs. For each main effect (GCM, RCM,..), each
element of the list contains a matrix <code>n</code> x <code>nTypeEff</code>
</p>
</li>
<li> <p><strong>RESIDUALVAR</strong>: List of estimates for the variance of the
residual errors:
</p>

<ul>
<li> <p><strong>MEAN</strong>: vector of length <code>n</code>.
</p>
</li>
<li> <p><strong>SD</strong>: vector of length <code>n</code> of standard dev.
if <code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li>
<li> <p><strong>CI</strong>: matrix <code>n</code> x 2 of credible intervals of
probability <code>probCI</code> given in <code>listOption</code> if
<code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li>
<li> <p><strong>QUANT</strong>: matrix <code>n</code> x <code>nQ</code> of quantiles of
probability <code>quantilePosterior</code> given in <code>listOption</code> if
<code>ANOVAmethod=="QUALYPSO"</code>.
</p>
</li></ul>

</li>
<li> <p><strong>INTERNALVAR</strong>: Internal variability (constant over time)
</p>
</li>
<li> <p><strong>TOTALVAR</strong>: total variability, i.e. the sum of internal variability,
residual variability and variability related to the main effects
</p>
</li>
<li> <p><strong>DECOMPVAR</strong>: Decomposition of the total variability for each component
</p>
</li>
<li> <p><strong>RESERR</strong>: differences between the climate change responses and the additive anova formula (grand mean + main effects)
</p>
</li>
<li> <p><strong>Xmat</strong>: matrix of predictors
</p>
</li>
<li> <p><strong>Xfut</strong>: future predictor values
</p>
</li>
<li> <p><strong>paralType</strong>: type of parallelisation (Time or Grid)
</p>
</li>
<li> <p><strong>namesEff</strong>: names of the main effects
</p>
</li>
<li> <p><strong>Y</strong>: matrix of available combinations given as inputs
</p>
</li>
<li> <p><strong>listOption</strong>: list of options used to obtained these results
(obtained from <code><a href="#topic+QUALYPSO.check.option">QUALYPSO.check.option</a></code>)
</p>
</li>
<li> <p><strong>listScenarioInput</strong>: list of scenario characteristics
(obtained from <code><a href="#topic+QUALYPSO.process.scenario">QUALYPSO.process.scenario</a></code>)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>Evin, G., B. Hingray, J. Blanchet, N. Eckert, S. Morin, and D. Verfaillie (2020)
Partitioning Uncertainty Components of an Incomplete Ensemble of Climate Projections Using Data Augmentation.
Journal of Climate. &lt;doi:10.1175/JCLI-D-18-0606.1&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##########################################################################
# SYNTHETIC SCENARIOS
##########################################################################
# create nS=3 fictive climate scenarios with 2 GCMs and 2 RCMs, for a period of nY=20 years
n=20
t=1:n/n

# GCM effects (sums to 0 for each t)
effGCM1 = t*2
effGCM2 = t*-2

# RCM effects (sums to 0 for each t)
effRCM1 = t*1
effRCM2 = t*-1

# These climate scenarios are a sum of effects and a random gaussian noise
scenGCM1RCM1 = effGCM1 + effRCM1 + rnorm(n=n,sd=0.5)
scenGCM1RCM2 = effGCM1 + effRCM2 + rnorm(n=n,sd=0.5)
scenGCM2RCM1 = effGCM2 + effRCM1 + rnorm(n=n,sd=0.5)
Y.synth = rbind(scenGCM1RCM1,scenGCM1RCM2,scenGCM2RCM1)

# Here, scenAvail indicates that the first scenario is obtained with the combination of the
# GCM "GCM1" and RCM "RCM1", the second scenario is obtained with the combination of
# the GCM "GCM1" and RCM "RCM2" and the third scenario is obtained with the combination
# of the GCM "GCM2" and RCM "RCM1".
scenAvail.synth = data.frame(GCM=c('GCM1','GCM1','GCM2'),RCM=c('RCM1','RCM2','RCM1'))

##########################################################################
# RUN QUALYPSO
##########################################################################
# call main QUALYPSO function: two arguments are mandatory:
# - Y: Climate projections for nS scenarios and nY time steps. if Y is a matrix nS x nY, we
# run QUALYPSO nY times, for each time step. If Y is an array nG x nS x nY, for nG grid points,
# we run QUALYPSO nG times, for each grid point, for one time step specified using the argument
# iFut
# - scenAvail: matrix or data.frame of available combinations nS x nEff. The number of
# characteristics nEff corresponds to the number of main effects that will be included in the
# ANOVA model. In the following example, we have nEff=2 main effects corresponding to the GCMs
# and RCMs.

# Many options can be specified in the argument "listOption". When ANOVAmethod=="QUALYPSO"
# a Bayesian inference is performed. Here, we change the default values for nBurn and nKeep
# in order to speed up computation time for this small example. However, it must be noticed
# that convergence and sampling of the posterior distributions often require higher values
#  for these two arguments.
listOption = list(nBurn=100,nKeep=100,ANOVAmethod="QUALYPSO",quantilePosterior=c(0.025,0.5,0.975))

# run QUALYPSO
QUALYPSO.synth = QUALYPSO(Y=Y.synth, scenAvail=scenAvail.synth, X=2001:2020, listOption=listOption)

##########################################################################
# SOME PLOTS
##########################################################################
# plot grand mean
plotQUALYPSOgrandmean(QUALYPSO.synth,xlab="Years")

# plot main GCM effects
plotQUALYPSOeffect(QUALYPSO.synth,nameEff="GCM",xlab="Years")

# plot main RCM effects
plotQUALYPSOeffect(QUALYPSO.synth,nameEff="RCM",xlab="Years")

# plot fraction of total variance for the differences sources of uncertainty
plotQUALYPSOTotalVarianceDecomposition(QUALYPSO.synth,xlab="Years")

# plot mean prediction and total variance with the differences sources of uncertainty
plotQUALYPSOMeanChangeAndUncertainties(QUALYPSO.synth,xlab="Years")

#____________________________________________________________
# EXAMPLE OF QUALYPSO WHEN THE PREDICTOR IS TIME
#____________________________________________________________

# list of options
listOption = list(typeChangeVariable='abs')

# call QUALYPSO
QUALYPSO.time = QUALYPSO(Y=Y,scenAvail=scenAvail,X=X_time_vec,
                         Xfut=Xfut_time,listOption=listOption)

# grand mean effect
plotQUALYPSOgrandmean(QUALYPSO.time,xlab="Years")

# main GCM effects
plotQUALYPSOeffect(QUALYPSO.time,nameEff="GCM",xlab="Years")

# main RCM effects
plotQUALYPSOeffect(QUALYPSO.time,nameEff="RCM",xlab="Years")

# mean change and associated uncertainties
plotQUALYPSOMeanChangeAndUncertainties(QUALYPSO.time,xlab="Years")

# variance decomposition
plotQUALYPSOTotalVarianceDecomposition(QUALYPSO.time,xlab="Years")

#____________________________________________________________
# EXAMPLE OF QUALYPSO WHEN THE PREDICTOR IS THE GLOBAL TEMPERATURE
#____________________________________________________________

# list of options
listOption = list(typeChangeVariable='abs')

# call QUALYPSO
QUALYPSO.globaltas = QUALYPSO(Y=Y,scenAvail=scenAvail,X=X_globaltas,
                              Xfut=Xfut_globaltas,listOption=listOption)

# grand mean effect
plotQUALYPSOgrandmean(QUALYPSO.globaltas,xlab="Global warming (Celsius)")

# main GCM effects
plotQUALYPSOeffect(QUALYPSO.globaltas,nameEff="GCM",xlab="Global warming (Celsius)")

# main RCM effects
plotQUALYPSOeffect(QUALYPSO.globaltas,nameEff="RCM",xlab="Global warming (Celsius)")

# mean change and associated uncertainties
plotQUALYPSOMeanChangeAndUncertainties(QUALYPSO.globaltas,xlab="Global warming (Celsius)")

# variance decomposition
plotQUALYPSOTotalVarianceDecomposition(QUALYPSO.globaltas,xlab="Global warming (Celsius)")

</code></pre>

<hr>
<h2 id='QUALYPSO.ANOVA'>QUALYPSO.ANOVA</h2><span id='topic+QUALYPSO.ANOVA'></span>

<h3>Description</h3>

<p>Partition uncertainty in climate responses using an ANOVA inferred with a Bayesian approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QUALYPSO.ANOVA(phiStar, scenAvail, listOption = NULL, namesEff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QUALYPSO.ANOVA_+3A_phistar">phiStar</code></td>
<td>
<p>matrix of climate change responses (absolute or relative changes): <code>nS</code> x <code>n</code>.
<code>n</code> can be the number of time steps or the number of grid points</p>
</td></tr>
<tr><td><code id="QUALYPSO.ANOVA_+3A_scenavail">scenAvail</code></td>
<td>
<p>data.frame <code>nS</code> x <code>nEff</code> with the <code>nEff</code> characteristics (e.g. type of GCM) for each of the <code>nS</code> x <code>nS</code> scenarios</p>
</td></tr>
<tr><td><code id="QUALYPSO.ANOVA_+3A_listoption">listOption</code></td>
<td>
<p>list of options (see <code><a href="#topic+QUALYPSO">QUALYPSO</a></code>)</p>
</td></tr>
<tr><td><code id="QUALYPSO.ANOVA_+3A_nameseff">namesEff</code></td>
<td>
<p>names of the main effects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the following fields:
</p>

<ul>
<li> <p><strong>GRANDMEAN</strong>: List of estimates for the grand mean:
</p>

<ul>
<li> <p>strong: MEAN: vector of length <code>n</code> of posterior means
</p>
</li>
<li> <p>strong: SD: vector of length <code>n</code> of posterior standard dev.
</p>
</li>
<li> <p>strong: CI: matrix <code>n</code> x 2 of credible intervals of
probability <code>probCI</code> given in <code>listOption</code>.
</p>
</li>
<li> <p>strong: QUANT: matrix <code>n</code> x <code>nQ</code> of quantiles related
to the probabilities <code>quantilePosterior</code> given in <code>listOption</code>
</p>
</li></ul>

</li>
<li> <p><strong>RESIDUALVAR</strong>: List of estimates for the variance of the
residual errors:
</p>

<ul>
<li> <p>strong: MEAN: vector of length <code>n</code> of posterior means
</p>
</li>
<li> <p>strong: SD: vector of length <code>n</code> of posterior standard dev.
</p>
</li>
<li> <p>strong: CI: matrix <code>n</code> x 2 of credible intervals of
probability <code>probCI</code> given in <code>listOption</code>.
</p>
</li>
<li> <p>strong: QUANT: matrix <code>n</code> x <code>nQ</code> of quantiles related
to the probabilities <code>quantilePosterior</code> given in <code>listOption</code>
</p>
</li></ul>

</li>
<li> <p><strong>MAINEFFECT</strong>: List of estimates for the main effects. For each
main effect (GCM, RCM,..), each element of the list contains a list with:
</p>

<ul>
<li> <p>strong: MEAN: matrix <code>n</code> x <code>nTypeEff</code> of posterior means
</p>
</li>
<li> <p>strong: SD: matrix <code>n</code> x <code>nTypeEff</code> of posterior standard dev.
</p>
</li>
<li> <p>strong: CI: array <code>n</code> x 2 x <code>nTypeEff</code> of credible
intervals of probability <code>probCI</code> given in <code>listOption</code>.
</p>
</li>
<li> <p>strong: QUANT: array <code>n</code> x <code>nQ</code> x <code>nTypeEff</code> of
quantiles related to the probabilities <code>quantilePosterior</code> given in
<code>listOption</code>
</p>
</li></ul>

</li>
<li> <p><strong>CHANGEBYEFFECT</strong>: For each main effect, list of estimates for
the mean change by main effect, i.e. mean change by scenario (RCP4.5). For
each main effect (GCM, RCM,..), each element of the list contains a list with:
</p>

<ul>
<li> <p>strong: MEAN: matrix <code>n</code> x <code>nTypeEff</code> of posterior means
</p>
</li>
<li> <p>strong: SD: matrix <code>n</code> x <code>nTypeEff</code> of posterior standard dev.
</p>
</li>
<li> <p>strong: CI: array <code>n</code> x 2 x <code>nTypeEff</code> of credible
intervals of probability <code>probCI</code> given in <code>listOption</code>.
</p>
</li>
<li> <p>strong: QUANT: array <code>n</code> x <code>nQ</code> x <code>nTypeEff</code> of
quantiles related to the probabilities <code>quantilePosterior</code> given in
<code>listOption</code>
</p>
</li></ul>

</li>
<li> <p><strong>EFFECTVAR</strong>: variability related to the main effects (i.e.
variability between the different RCMs, GCMs,..). Matrix <code>n</code> x
<code>nTypeEff</code>
</p>
</li>
<li> <p><strong>CONTRIB_EACH_EFFECT</strong>: Contribution of each individual effect
to its component (percentage), e.g. what is the contribution of GCM1 to the
variability related to GCMs. For each main effect (GCM, RCM,..), each
element of the list contains a matrix <code>n</code> x <code>nTypeEff</code>
</p>
</li>
<li> <p><strong>listOption</strong>: list of options used to obtained these results
(obtained from <code><a href="#topic+QUALYPSO.check.option">QUALYPSO.check.option</a></code>)
</p>
</li>
<li> <p><strong>listScenarioInput</strong>: list of scenario characteristics
(obtained from <code><a href="#topic+QUALYPSO.process.scenario">QUALYPSO.process.scenario</a></code>)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>Evin, G., B. Hingray, J. Blanchet, N. Eckert, S. Morin, and D. Verfaillie (2020)
Partitioning Uncertainty Components of an Incomplete Ensemble of Climate Projections Using Data Augmentation.
Journal of Climate. &lt;doi:10.1175/JCLI-D-18-0606.1&gt;.
</p>

<hr>
<h2 id='QUALYPSO.ANOVA.i'>QUALYPSO.ANOVA.i</h2><span id='topic+QUALYPSO.ANOVA.i'></span>

<h3>Description</h3>

<p>Partition sources of uncertainty in climate change responses for one lead time or one grid point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QUALYPSO.ANOVA.i(phiStar.i, nMCMC, listScenarioInput)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QUALYPSO.ANOVA.i_+3A_phistar.i">phiStar.i</code></td>
<td>
<p>vector of <code>nS</code> climate change response for one lead time or for one grid point: <code>nS x 1</code></p>
</td></tr>
<tr><td><code id="QUALYPSO.ANOVA.i_+3A_nmcmc">nMCMC</code></td>
<td>
<p>number of MCMC simulation required</p>
</td></tr>
<tr><td><code id="QUALYPSO.ANOVA.i_+3A_listscenarioinput">listScenarioInput</code></td>
<td>
<p>list containing specifications, provided by <code><a href="#topic+QUALYPSO.process.scenario">QUALYPSO.process.scenario</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the following fields:
</p>

<ul>
<li> <p><strong>mu</strong>: vector of length <code>nMCMC</code>, mean climate change response
</p>
</li>
<li> <p><strong>sigma2</strong>: vector of length <code>nMCMC</code>, variance of the residual terms
</p>
</li>
<li> <p><strong>effect</strong>: list with <code>nTypeEff</code> elements, where each element corresponds to a different type of effect (e.g. alpha, beta, gamma in Eq. 7)
Each element is a matrix <code>nMCMC</code> x <code>nMaineff</code>, and <code>nMaineff</code> is the number of main effects (e.g. number of GCMs, RCMs, etc.)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Guillaume Evin
</p>


<h3>References</h3>

<p>Evin, G., B. Hingray, J. Blanchet, N. Eckert, S. Morin, and D. Verfaillie (2020)
Partitioning Uncertainty Components of an Incomplete Ensemble of Climate Projections Using Data Augmentation.
Journal of Climate. &lt;doi:10.1175/JCLI-D-18-0606.1&gt;.
</p>

<hr>
<h2 id='QUALYPSO.check.option'>QUALYPSO.check.option</h2><span id='topic+QUALYPSO.check.option'></span>

<h3>Description</h3>

<p>Check if input options provided in <code><a href="#topic+QUALYPSO">QUALYPSO</a></code> are valid and assigned default values if missing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QUALYPSO.check.option(listOption)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QUALYPSO.check.option_+3A_listoption">listOption</code></td>
<td>
<p>list of options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the complete set of options.
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='QUALYPSO.process.scenario'>QUALYPSO.process.scenario</h2><span id='topic+QUALYPSO.process.scenario'></span>

<h3>Description</h3>

<p>Process input scenarios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QUALYPSO.process.scenario(scenAvail)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QUALYPSO.process.scenario_+3A_scenavail">scenAvail</code></td>
<td>
<p>data.frame <code>nS</code> x <code>nEff</code> with the <code>nEff</code> characteristics (e.g. type of GCM) for each of the <code>nS</code> x <code>nS</code> scenarios</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of preprocessed objects (<code>listEff, scenAvail, scenComp, nEff, nTypeEff, nComp, isMissing, nMissing, iMatchScen,
indexEffInCompScen, Qmat</code>)
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin
</p>

<hr>
<h2 id='scenAvail'>List of GCM and RCM which have been used for the 20 climate projections</h2><span id='topic+scenAvail'></span>

<h3>Description</h3>

<p>scenAvail gives the GCM and RCM which have been used for the 20 climate
projections (obtained with the RCP8.5)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(scenAvail)
</code></pre>


<h3>Format</h3>

<p>data.frame with 20 rows and two columns: GCM and RCM
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin <a href="mailto:guillaume.evin@inrae.fr">guillaume.evin@inrae.fr</a>
</p>

<hr>
<h2 id='X_globaltas'>Annual warming levels simulated by different CMIP5 GCMs</h2><span id='topic+X_globaltas'></span>

<h3>Description</h3>

<p>Annual warming levels at the planetary scales simulated by different CMIP5
GCMs for the period 1971-2099. Warming levels are obtained with respect to
the year 1860 (common starting year of the CMIP5 simulations). These warming
levels have been obtained with the following steps:
</p>

<ol>
<li><p> Annual tas averages simulated by different CMIP5 have first been smoothed
using a smoothing spline. Let us denote these smoothed values by
tas_GCM(y) for a year y.
</p>
</li>
<li><p> Large discrepancies can be observed for tas_GCM_smooth(y) even in the past
due to large first-order biases in the GCM simulations. In order to obtain a
common reference, we also consider observed tas estimates at the global scale.
HadCRUT5 (Morice et al., 2021, 10.1029/2019JD032361) provides anomalies with
respect to the period 1961-1990. An estimate of absolute average temperature
for this period is 14°C (Jones et al., 1999, 10.1029/1999RG900002). Smoothed
estimates of absolute tas averages are obtained using a smoothing spline and
is denoted by tas_obs(y).
</p>
</li>
<li><p> Warming levels are obtained as anomalies with respect to the period 1860
and considering a reference year, here 1990, where the warming levels WL are
in agreement:
WL(y) = tas_GCM(y)-tas_GCM(1990)+tas_obs(1990)-tas_obs(1860)
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>data(X_globaltas)
</code></pre>


<h3>Format</h3>

<p>matrix 20 scenarios x 129 years
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin <a href="mailto:guillaume.evin@inrae.fr">guillaume.evin@inrae.fr</a>
</p>

<hr>
<h2 id='X_time_mat'>Years 1971-2099 repeated for the 20 scenarios</h2><span id='topic+X_time_mat'></span>

<h3>Description</h3>

<p>Years 1971-2099 repeated for the 20 scenarios
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(X_time_mat)
</code></pre>


<h3>Format</h3>

<p>matrix 20 scenarios x 129 years
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin <a href="mailto:guillaume.evin@inrae.fr">guillaume.evin@inrae.fr</a>
</p>

<hr>
<h2 id='X_time_vec'>X_time_vec gives the years corr. to Y, i.e. from 1971 to 2099</h2><span id='topic+X_time_vec'></span>

<h3>Description</h3>

<p>X_time_vec gives the years corr. to Y, i.e. from 1971 to 2099
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(X_time_vec)
</code></pre>


<h3>Format</h3>

<p>vector of length 129
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin <a href="mailto:guillaume.evin@inrae.fr">guillaume.evin@inrae.fr</a>
</p>

<hr>
<h2 id='Xfut_globaltas'>Vector of of future warming levels</h2><span id='topic+Xfut_globaltas'></span>

<h3>Description</h3>

<p>Equally spaced vector of of future warming levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Xfut_globaltas)
</code></pre>


<h3>Format</h3>

<p>vector of length 13
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin <a href="mailto:guillaume.evin@inrae.fr">guillaume.evin@inrae.fr</a>
</p>

<hr>
<h2 id='Xfut_time'>Xfut_time is a vector of 11 years equally spaced from 1999 to 2099</h2><span id='topic+Xfut_time'></span>

<h3>Description</h3>

<p>Xfut_time is a vector of 11 years equally spaced from 1999 to 2099
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Xfut_time)
</code></pre>


<h3>Format</h3>

<p>vectors of length 11
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin <a href="mailto:guillaume.evin@inrae.fr">guillaume.evin@inrae.fr</a>
</p>

<hr>
<h2 id='Y'>Mean winter temperature over CEU with 20 GCM/RCM combinations for 1971-2099</h2><span id='topic+Y'></span>

<h3>Description</h3>

<p>climate projections of mean winter (DJF) temperature over the SREX region CEU
simulated by 20 combinations of CMIP5 GCMs and RCMs for the period 1971-2099
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Y)
</code></pre>


<h3>Format</h3>

<p>matrix 20 scenarios x 129 years
</p>


<h3>Author(s)</h3>

<p>Guillaume Evin <a href="mailto:guillaume.evin@inrae.fr">guillaume.evin@inrae.fr</a>
</p>


<h3>References</h3>

<p>Seneviratne, S. I. et al. Changes in Climate Extremes and their
Impacts on the Natural Physical Environment, in: Managing the Risks of
Extreme Events and Disasters to Advance Climate Change Adaptation: Special
Report of the Intergovernmental Panel on Climate Change, edited by: Field,
C., Barros, V., Stocker, T., and Dahe, Q., Cambridge University Press,
Cambridge, 109-230, https://doi.org/10.1017/CBO9781139177245.006, 2012
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
