<!DOCTYPE html><html lang="en"><head><title>Help for package xpectr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {xpectr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#xpectr-package'><p>xpectr: A package for generating tests for <code>testthat</code> unit testing</p></a></li>
<li><a href='#assertCollectionAddin'><p>Inserts code for a checkmate assert collection</p></a></li>
<li><a href='#capture_parse_eval_side_effects'><p>Capture side effects from parse eval</p></a></li>
<li><a href='#capture_side_effects'><p>Capture side effects</p></a></li>
<li><a href='#dputSelectedAddin'><p>Replaces selected code with its dput() output</p></a></li>
<li><a href='#element_classes'><p>Gets the class of each element</p></a></li>
<li><a href='#element_lengths'><p>Gets the length of each element</p></a></li>
<li><a href='#element_types'><p>Gets the type of each element</p></a></li>
<li><a href='#gxs_function'><p>Generate testhat expectations for argument values in a function</p></a></li>
<li><a href='#gxs_selection'><p>Generate testhat expectations from selection</p></a></li>
<li><a href='#initializeGXSFunctionAddin'><p>Initialize <code>gxs_function()</code> call</p></a></li>
<li><a href='#initializeTestthatAddin'><p>Initializes <code>test_that()</code> call</p></a></li>
<li><a href='#insertExpectationsAddin'><p>Creates testthat tests for selected code</p></a></li>
<li><a href='#navigateTestFileAddin'><p>Navigates to test file</p></a></li>
<li><a href='#num_total_elements'><p>Total number of elements</p></a></li>
<li><a href='#prepare_insertion'><p>Prepare expectations for insertion</p></a></li>
<li><a href='#render_toc'><p>Render Table of Contents</p></a></li>
<li><a href='#set_test_seed'><p>Set random seed for unit tests</p></a></li>
<li><a href='#simplified_formals'><p>Extract and simplify a function's formal arguments</p></a></li>
<li><a href='#smpl'><p>Random sampling</p></a></li>
<li><a href='#stop_if'><p>Simple side effect functions</p></a></li>
<li><a href='#strip'><p>Strip strings of non-alphanumeric characters</p></a></li>
<li><a href='#strip_msg'><p>Strip side-effect messages of non-alphanumeric characters and rethrow them</p></a></li>
<li><a href='#suppress_mw'><p>Suppress warnings and messages</p></a></li>
<li><a href='#wrapStringAddin'><p>Wraps the selection with paste0</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Generates Expectations for 'testthat' Unit Testing</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Helps systematize and ease the process of 
    building unit tests with the 'testthat' package by providing 
    tools for generating expectations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ludvigolsen/xpectr">https://github.com/ludvigolsen/xpectr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ludvigolsen/xpectr/issues">https://github.com/ludvigolsen/xpectr/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>clipr (&ge; 0.7.0), checkmate (&ge; 2.0.0), dplyr, fansi (&ge;
0.4.1), lifecycle, plyr, rlang, rstudioapi (&ge; 0.10), stats,
testthat (&ge; 2.3.1), tibble, utils, withr (&ge; 2.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>data.table, knitr, rmarkdown</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>lifecycle</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-03 17:13:05 UTC; au547627</td>
</tr>
<tr>
<td>Author:</td>
<td>Ludvig Renbo Olsen
    <a href="https://orcid.org/0009-0006-6798-7454"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  R. Mark Sharp [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ludvig Renbo Olsen &lt;r-pkgs@ludvigolsen.dk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-03 17:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='xpectr-package'>xpectr: A package for generating tests for <code>testthat</code> unit testing</h2><span id='topic+xpectr'></span><span id='topic+xpectr-package'></span>

<h3>Description</h3>

<p>A set of utilities and RStudio addins for generating tests.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ludvigolsen/xpectr">https://github.com/ludvigolsen/xpectr</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ludvigolsen/xpectr/issues">https://github.com/ludvigolsen/xpectr/issues</a>
</p>
</li></ul>


<hr>
<h2 id='assertCollectionAddin'>Inserts code for a checkmate assert collection</h2><span id='topic+assertCollectionAddin'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>RStudio Addin:
Inserts code for initializing and reporting a
<code><a href="checkmate.html#topic+AssertCollection">checkmate assert collection</a></code>.
</p>
<p>See <code>`Details`</code> for how to set a key command.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assertCollectionAddin(add_comments = TRUE, insert = TRUE, indentation = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assertCollectionAddin_+3A_add_comments">add_comments</code></td>
<td>
<p>Whether to add comments around. (Logical)
</p>
<p>This makes it easy for a user to create their own addin without the comments.</p>
</td></tr>
<tr><td><code id="assertCollectionAddin_+3A_insert">insert</code></td>
<td>
<p>Whether to insert the code via
<code><a href="rstudioapi.html#topic+rstudio-documents">rstudioapi::insertText()</a></code>
or return it. (Logical)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="assertCollectionAddin_+3A_indentation">indentation</code></td>
<td>
<p>Indentation of the code. (Numeric)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>How to set up a key command in RStudio</h4>

<p>After installing the package.
Go to:
</p>
<p><code>Tools &gt;&gt; Addins &gt;&gt; Browse Addins &gt;&gt; Keyboard Shortcuts</code>.
</p>
<p>Find <code>"Insert checkmate AssertCollection Code"</code> and press its field under <code>Shortcut</code>.
</p>
<p>Press desired key command, e.g. <code>Alt+C</code>.
</p>
<p>Press <code>Apply</code>.
</p>
<p>Press <code>Execute</code>.
</p>



<h3>Value</h3>

<p>Inserts the following (excluding the <code>----</code>):
</p>
<p><code>----</code>
</p>
<p><code># Check arguments ####</code>
</p>
<p><code>assert_collection &lt;- checkmate::makeAssertCollection()</code>
</p>
<p><code># checkmate::assert_ , add = assert_collection)</code>
</p>
<p><code>checkmate::reportAssertions(assert_collection)</code>
</p>
<p><code># End of argument checks ####</code>
</p>
<p><code>----</code>
</p>
<p>Returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other addins: 
<code><a href="#topic+dputSelectedAddin">dputSelectedAddin</a>()</code>,
<code><a href="#topic+initializeGXSFunctionAddin">initializeGXSFunctionAddin</a>()</code>,
<code><a href="#topic+initializeTestthatAddin">initializeTestthatAddin</a>()</code>,
<code><a href="#topic+insertExpectationsAddin">insertExpectationsAddin</a>()</code>,
<code><a href="#topic+navigateTestFileAddin">navigateTestFileAddin</a>()</code>,
<code><a href="#topic+wrapStringAddin">wrapStringAddin</a>()</code>
</p>

<hr>
<h2 id='capture_parse_eval_side_effects'>Capture side effects from parse eval</h2><span id='topic+capture_parse_eval_side_effects'></span>

<h3>Description</h3>

<p>Wraps string in <code><a href="#topic+capture_side_effects">capture_side_effects()</a></code>
before parsing and evaluating it.
The side effects (<code>error</code>, <code>warning</code>s, <code>message</code>s) are returned in a <code>list</code>.
</p>
<p>When capturing an <code>error</code>, no other side effects are captured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>capture_parse_eval_side_effects(
  string,
  envir = NULL,
  copy_env = FALSE,
  reset_seed = FALSE,
  disable_crayon = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="capture_parse_eval_side_effects_+3A_string">string</code></td>
<td>
<p>String of code that can be parsed and evaluated in <code>envir</code>.</p>
</td></tr>
<tr><td><code id="capture_parse_eval_side_effects_+3A_envir">envir</code></td>
<td>
<p>Environment to evaluate in. Defaults to
<code><a href="base.html#topic+sys.parent">parent.frame()</a></code>.</p>
</td></tr>
<tr><td><code id="capture_parse_eval_side_effects_+3A_copy_env">copy_env</code></td>
<td>
<p>Whether to use deep copies of the environment when capturing side effects. (Logical)
</p>
<p>Disabled by default to save memory but is often preferable to enable, e.g. when the function
alters non-local variables before throwing its <code>error</code>/<code>warning</code>/<code>message</code>.</p>
</td></tr>
<tr><td><code id="capture_parse_eval_side_effects_+3A_reset_seed">reset_seed</code></td>
<td>
<p>Whether to reset the random state on exit. (Logical)</p>
</td></tr>
<tr><td><code id="capture_parse_eval_side_effects_+3A_disable_crayon">disable_crayon</code></td>
<td>
<p>Whether to disable <code>crayon</code> formatting.
This can remove ANSI characters from the messages. (Logical)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>named list</code> with the side effects.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other capturers: 
<code><a href="#topic+capture_side_effects">capture_side_effects</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach package
library(xpectr)


capture_parse_eval_side_effects("stop('hi!')")
capture_parse_eval_side_effects("warning('hi!')")
capture_parse_eval_side_effects("message('hi!')")

</code></pre>

<hr>
<h2 id='capture_side_effects'>Capture side effects</h2><span id='topic+capture_side_effects'></span>

<h3>Description</h3>

<p>Captures <code>error</code>s, <code>warning</code>s, and <code>message</code>s from an expression.
</p>
<p>In case of an <code>error</code>, no other side effects are captured.
</p>
<p>Simple wrapper for <code>testthat</code>'s
<code><a href="testthat.html#topic+capture_condition">capture_error()</a></code>,
<code><a href="testthat.html#topic+capture_condition">capture_warnings()</a></code> and
<code><a href="testthat.html#topic+capture_condition">capture_messages()</a></code>.
</p>
<p>Note: Evaluates <code>expr</code> up to three times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>capture_side_effects(
  expr,
  envir = NULL,
  copy_env = FALSE,
  reset_seed = FALSE,
  disable_crayon = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="capture_side_effects_+3A_expr">expr</code></td>
<td>
<p>Expression.</p>
</td></tr>
<tr><td><code id="capture_side_effects_+3A_envir">envir</code></td>
<td>
<p>Environment to evaluate in. Defaults to
<code><a href="base.html#topic+sys.parent">parent.frame()</a></code>.</p>
</td></tr>
<tr><td><code id="capture_side_effects_+3A_copy_env">copy_env</code></td>
<td>
<p>Whether to use deep copies of the environment when capturing side effects. (Logical)
</p>
<p>Disabled by default to save memory but is often preferable to enable, e.g. when the function
alters non-local variables before throwing its <code>error</code>/<code>warning</code>/<code>message</code>.</p>
</td></tr>
<tr><td><code id="capture_side_effects_+3A_reset_seed">reset_seed</code></td>
<td>
<p>Whether to reset the random state on exit. (Logical)</p>
</td></tr>
<tr><td><code id="capture_side_effects_+3A_disable_crayon">disable_crayon</code></td>
<td>
<p>Whether to disable <code>crayon</code> formatting.
This can remove ANSI characters from the messages. (Logical)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>named list</code> with the side effects.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other capturers: 
<code><a href="#topic+capture_parse_eval_side_effects">capture_parse_eval_side_effects</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

fn &lt;- function(raise = FALSE){
  message("Hi! I'm Kevin, your favorite message!")
  warning("G'Day Mam! I'm a warning to the world!")
  message("Kevin is ma name! Yesss!")
  warning("Hopefully the whole world will see me :o")
  if (isTRUE(raise)){
    stop("Lord Evil Error has arrived! Yeehaaa")
  }
  "the output"
}

capture_side_effects(fn())
capture_side_effects(fn(raise = TRUE))
capture_side_effects(fn(raise = TRUE), copy_env = TRUE)

</code></pre>

<hr>
<h2 id='dputSelectedAddin'>Replaces selected code with its dput() output</h2><span id='topic+dputSelectedAddin'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>RStudio Addin:
Runs <code><a href="base.html#topic+dput">dput()</a></code> on the selected code and inserts
it instead of the selection.
</p>
<p>See <code>`Details`</code> for how to set a key command.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dputSelectedAddin(selection = NULL, insert = TRUE, indentation = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dputSelectedAddin_+3A_selection">selection</code></td>
<td>
<p>String of code. (Character)
</p>
<p>E.g. <code>"stop('This gives an expect_error test')"</code>.
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="dputSelectedAddin_+3A_insert">insert</code></td>
<td>
<p>Whether to insert the expectations via
<code><a href="rstudioapi.html#topic+rstudio-documents">rstudioapi::insertText()</a></code>
or return them. (Logical)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="dputSelectedAddin_+3A_indentation">indentation</code></td>
<td>
<p>Indentation of the selection. (Numeric)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>How</h4>

<p>Parses and evaluates the selected code string,
applies <code><a href="base.html#topic+dput">dput()</a></code> and
inserts the output instead of the selection.
</p>



<h4>How to set up a key command in RStudio</h4>

<p>After installing the package.
Go to:
</p>
<p><code>Tools &gt;&gt; Addins &gt;&gt; Browse Addins &gt;&gt; Keyboard Shortcuts</code>.
</p>
<p>Find <code>"dput() Selected"</code> and press its field under <code>Shortcut</code>.
</p>
<p>Press desired key command, e.g. <code>Alt+D</code>.
</p>
<p>Press <code>Apply</code>.
</p>
<p>Press <code>Execute</code>.
</p>



<h3>Value</h3>

<p>Inserts the output of running
<code><a href="base.html#topic+dput">dput()</a></code> on the selected code.
</p>
<p>Does not return anything.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other addins: 
<code><a href="#topic+assertCollectionAddin">assertCollectionAddin</a>()</code>,
<code><a href="#topic+initializeGXSFunctionAddin">initializeGXSFunctionAddin</a>()</code>,
<code><a href="#topic+initializeTestthatAddin">initializeTestthatAddin</a>()</code>,
<code><a href="#topic+insertExpectationsAddin">insertExpectationsAddin</a>()</code>,
<code><a href="#topic+navigateTestFileAddin">navigateTestFileAddin</a>()</code>,
<code><a href="#topic+wrapStringAddin">wrapStringAddin</a>()</code>
</p>

<hr>
<h2 id='element_classes'>Gets the class of each element</h2><span id='topic+element_classes'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Applies <code><a href="base.html#topic+class">class()</a></code> to each element of <code>`x`</code> (without recursion). When
<code>class()</code> returns multiple strings, the first class string is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>element_classes(x, keep_names = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="element_classes_+3A_x">x</code></td>
<td>
<p>List with elements.</p>
</td></tr>
<tr><td><code id="element_classes_+3A_keep_names">keep_names</code></td>
<td>
<p>Whether to keep existing names. (Logical)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Gets first string in <code>class()</code> for all elements.
</p>


<h3>Value</h3>

<p>The main class of each element.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other element descriptors: 
<code><a href="#topic+element_lengths">element_lengths</a>()</code>,
<code><a href="#topic+element_types">element_types</a>()</code>,
<code><a href="#topic+num_total_elements">num_total_elements</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

l &lt;- list("a" = c(1,2,3), "b" = "a", "c" = NULL)

element_classes(l)
element_classes(l, keep_names = TRUE)
</code></pre>

<hr>
<h2 id='element_lengths'>Gets the length of each element</h2><span id='topic+element_lengths'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Applies <code><a href="base.html#topic+length">length()</a></code> to each element of <code>`x`</code> (without recursion).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>element_lengths(x, keep_names = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="element_lengths_+3A_x">x</code></td>
<td>
<p>List with elements.</p>
</td></tr>
<tr><td><code id="element_lengths_+3A_keep_names">keep_names</code></td>
<td>
<p>Whether to keep existing names. (Logical)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simple wrapper for <code>unlist(lapply(x, length))</code>.
</p>


<h3>Value</h3>

<p>The length of each element.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other element descriptors: 
<code><a href="#topic+element_classes">element_classes</a>()</code>,
<code><a href="#topic+element_types">element_types</a>()</code>,
<code><a href="#topic+num_total_elements">num_total_elements</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

l &lt;- list("a" = c(1,2,3), "b" = 1, "c" = NULL)

element_lengths(l)
element_lengths(l, keep_names = TRUE)
</code></pre>

<hr>
<h2 id='element_types'>Gets the type of each element</h2><span id='topic+element_types'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Applies <code><a href="base.html#topic+typeof">typeof()</a></code> to each element of <code>`x`</code> (without recursion).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>element_types(x, keep_names = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="element_types_+3A_x">x</code></td>
<td>
<p>List with elements.</p>
</td></tr>
<tr><td><code id="element_types_+3A_keep_names">keep_names</code></td>
<td>
<p>Whether to keep existing names. (Logical)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simple wrapper for <code>unlist(lapply(x, typeof))</code>.
</p>


<h3>Value</h3>

<p>The type of each element.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other element descriptors: 
<code><a href="#topic+element_classes">element_classes</a>()</code>,
<code><a href="#topic+element_lengths">element_lengths</a>()</code>,
<code><a href="#topic+num_total_elements">num_total_elements</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

l &lt;- list("a" = c(1,2,3), "b" = "a", "c" = NULL)

element_types(l)
element_types(l, keep_names = TRUE)
</code></pre>

<hr>
<h2 id='gxs_function'>Generate testhat expectations for argument values in a function</h2><span id='topic+gxs_function'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Based on a set of supplied values for each function argument,
a set of <code>testthat</code> <code>expect_*</code> statements are generated.
</p>
<p><strong>Included tests</strong>: The first value supplied for an argument
is considered the <em>valid baseline</em> value. For each argument, we
create tests for each of the supplied values, where the other arguments
have their baseline value.
</p>
<p>When testing a function that alters non-local variables, consider enabling <code>`copy_env`</code>.
</p>
<p>See supported objects in <code>details</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gxs_function(
  fn,
  args_values,
  extra_combinations = NULL,
  check_nulls = TRUE,
  indentation = 0,
  tolerance = "1e-4",
  round_to_tolerance = TRUE,
  strip = TRUE,
  sample_n = 30,
  envir = NULL,
  copy_env = FALSE,
  assign_output = TRUE,
  seed = 42,
  add_wrapper_comments = TRUE,
  add_test_comments = TRUE,
  start_with_newline = TRUE,
  end_with_newline = TRUE,
  out = "insert",
  parallel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gxs_function_+3A_fn">fn</code></td>
<td>
<p>Function to create tests for.</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_args_values">args_values</code></td>
<td>
<p>The arguments and the values to create tests for.
Should be supplied as a named list of lists, like the following:
</p>
<p><code>args_values = list(</code>
</p>
<p><code>"x1" = list(1, 2, 3), </code>
</p>
<p><code>"x2" = list("a", "b", "c")</code>
</p>
<p><code>)</code>
</p>
<p>The first value for each argument (referred to as the 'baseline' value) should be valid
(not throw an <code>error/</code><code>message</code>/<code>warning</code>).
</p>
<p><strong>N.B.</strong> This is not checked but should lead to more meaningful tests.
</p>
<p><strong>N.B.</strong> Please define the list directly in the function call.
This is currently necessary.</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_extra_combinations">extra_combinations</code></td>
<td>
<p>Additional combinations to test. List of lists, where
each combination is a named sublist.
</p>
<p>E.g. the following two combinations:
</p>
<p><code>extra_combinations = list(</code>
</p>
<p><code>list("x1" = 4, "x2" = "b"),</code>
</p>
<p><code>list("x1" = 7, "x2" = "c")</code>
</p>
<p><code>)</code>
</p>
<p><strong>N.B.</strong> Unspecified arguments gets the baseline value.
</p>
<p>If you find yourself adding many combinations,
an additional <code>gxs_function()</code> call with different baseline values
might be preferable.</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_check_nulls">check_nulls</code></td>
<td>
<p>Whether to try all arguments with <code>NULL</code>. (Logical)
</p>
<p>When enabled, you don't need to add <code>NULL</code> to your <code>`args_values`</code>,
unless it should be the baseline value.</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_indentation">indentation</code></td>
<td>
<p>Indentation of the selection. (Numeric)</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_tolerance">tolerance</code></td>
<td>
<p>The tolerance for numeric tests as a string, like <code>"1e-4"</code>. (Character)</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_round_to_tolerance">round_to_tolerance</code></td>
<td>
<p>Whether to round numeric elements to the specified tolerance. (Logical)
</p>
<p>This is currently applied to numeric columns and vectors (excluding some lists).</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_strip">strip</code></td>
<td>
<p>Whether to insert
<code><a href="#topic+strip">strip_msg()</a></code> and
<code><a href="#topic+strip">strip()</a></code>
in tests of side effects. (Logical)
</p>
<p>Sometimes testthat tests have differences in punctuation and newlines on different
systems. By stripping both the error message and the expected message of non-alphanumeric symbols,
we can avoid such failed tests.</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_sample_n">sample_n</code></td>
<td>
<p>The number of elements/rows to sample. Set to <code>NULL</code> to avoid sampling.
</p>
<p>Inserts <code><a href="#topic+strip">smpl()</a></code> in the generated tests when sampling was used. A seed is
set internally, setting <code>sample.kind</code> as <code>"Rounding"</code> to ensure compatibility with <code>R</code> versions
<code>&lt; 3.6.0</code>.
</p>
<p>The order of the elements/rows is kept intact. No replacement is used, why no oversampling will
take place.
</p>
<p>When testing a big <code>data.frame</code>, sampling the rows can help keep the test files somewhat readable.</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_envir">envir</code></td>
<td>
<p>Environment to evaluate in. Defaults to
<code><a href="base.html#topic+sys.parent">parent.frame()</a></code>.</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_copy_env">copy_env</code></td>
<td>
<p>Whether each combination should be tested in a deep copy of the environment. (Logical)
</p>
<p>Side effects will be captured in copies of the copy, why two copies of the environment will
exist at the same time.
</p>
<p>Disabled by default to save memory but is often preferable to enable,
e.g. when the function changes non-local variables.</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_assign_output">assign_output</code></td>
<td>
<p>Whether to assign the output of a function call or long selection
to a variable. This will avoid recalling the function and decrease cluttering. (Logical)
</p>
<p>Heuristic: when the <code>`selection`</code> isn't of a string and contains a parenthesis, it is considered a function call.
A selection with more than 30 characters will be assigned as well.
</p>
<p>The tests themselves can be more difficult to interpret, as you will
have to look at the assignment to see the object that is being tested.</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_seed">seed</code></td>
<td>
<p><code>seed</code> to set. (Whole number)</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_add_wrapper_comments">add_wrapper_comments</code></td>
<td>
<p>Whether to add intro and outro comments. (Logical)</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_add_test_comments">add_test_comments</code></td>
<td>
<p>Whether to add comments for each test. (Logical)</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_start_with_newline">start_with_newline</code>, <code id="gxs_function_+3A_end_with_newline">end_with_newline</code></td>
<td>
<p>Whether to have a newline in the beginning/end. (Logical)</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_out">out</code></td>
<td>
<p>Either <code>"insert"</code> or <code>"return"</code>.
</p>


<h4>&quot;insert&quot; (Default)</h4>

<p>Inserts the expectations via
<code><a href="rstudioapi.html#topic+rstudio-documents">rstudioapi::insertText()</a></code>.
</p>



<h4>&quot;return&quot;</h4>

<p>Returns the expectations in a <code>list</code>.
</p>
<p>These can be prepared for insertion with
<code><a href="#topic+prepare_insertion">prepare_insertion()</a></code>.
</p>
</td></tr>
<tr><td><code id="gxs_function_+3A_parallel">parallel</code></td>
<td>
<p>Whether to parallelize the generation of expectations. (Logical)
</p>
<p>Requires a registered parallel backend. Like with <code>doParallel::registerDoParallel</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following &quot;types&quot; are currently supported or intended to be supported in the future.
Please suggest more types and tests in a GitHub issue!
</p>
<p>Note: A set of fallback tests will be generated for unsupported objects.
</p>

<table>
<tr>
 <td style="text-align: right;">
<strong>Type</strong> </td><td style="text-align: right;"> <strong>Supported</strong> </td><td style="text-align: right;"> <strong>Notes</strong> </td>
</tr>
<tr>
 <td style="text-align: right;">
Side effects </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> Errors, warnings, and messages. </td>
</tr>
<tr>
 <td style="text-align: right;">
Vector </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> Lists are treated differently, depending on their structure. </td>
</tr>
<tr>
 <td style="text-align: right;">
Factor </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: right;">
Data Frame </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> List columns (like nested tibbles) are currently skipped. </td>
</tr>
<tr>
 <td style="text-align: right;">
Matrix </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> Supported but could be improved. </td>
</tr>
<tr>
 <td style="text-align: right;">
Formula </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: right;">
Function </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>NULL</code> </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: right;">
Array </td><td style="text-align: right;"> No </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: right;">
Dates </td><td style="text-align: right;"> No </td><td style="text-align: right;"> Base and <code>lubridate</code>. </td>
</tr>
<tr>
 <td style="text-align: right;">
ggplot2 </td><td style="text-align: right;"> No </td><td style="text-align: right;"> This may be a challenge, but would be cool!</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>Either <code>NULL</code> or the unprepared expectations as a <code>character vector</code>.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other expectation generators: 
<code><a href="#topic+gxs_selection">gxs_selection</a>()</code>,
<code><a href="#topic+initializeGXSFunctionAddin">initializeGXSFunctionAddin</a>()</code>,
<code><a href="#topic+insertExpectationsAddin">insertExpectationsAddin</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

## Not run: 
fn &lt;- function(x, y, z){
  if (x&gt;3) stop("'x' &gt; 3")
  if (y&lt;0) warning("'y'&lt;0")
  if (z==10) message("'z' was 10!")
  x + y + z
}

# Create expectations
# Note: define the list in the call
gxs_function(fn,
             args_values = list(
               "x" = list(2, 4, NA),
               "y" = list(0, -1),
               "z" = list(5, 10))
             )

# Add additional combinations
gxs_function(fn,
             args_values = list(
               "x" = list(2, 4, NA),
               "y" = list(0, -1),
               "z" = list(5, 10)),
             extra_combinations = list(
               list("x" = 4, "z" = 10),
               list("y" = 1, "z" = 10))
             )

## End(Not run)
</code></pre>

<hr>
<h2 id='gxs_selection'>Generate testhat expectations from selection</h2><span id='topic+gxs_selection'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Based on the selection (string of code), a set of <code>testthat</code> <code>expect_*</code>
statements are generated.
</p>
<p>Example: If the selected code is the name of a <code>data.frame</code> object,
it will create an <code><a href="testthat.html#topic+equality-expectations">expect_equal</a></code>
test for each column, along with a test of the column names,
types and classes, dimensions, grouping keys, etc.
</p>
<p>See supported objects in <code>details</code>.
</p>
<p>When testing a function that alters non-local variables, consider enabling <code>`copy_env`</code>.
</p>
<p>Feel free to suggest useful tests etc. in a GitHub issue!
</p>
<p>Addin: <code><a href="#topic+insertExpectationsAddin">insertExpectationsAddin()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gxs_selection(
  selection,
  indentation = 0,
  tolerance = "1e-4",
  round_to_tolerance = TRUE,
  strip = TRUE,
  sample_n = 30,
  envir = NULL,
  copy_env = FALSE,
  assign_output = TRUE,
  seed = 42,
  test_id = NULL,
  add_wrapper_comments = TRUE,
  add_test_comments = TRUE,
  start_with_newline = TRUE,
  end_with_newline = TRUE,
  out = "insert"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gxs_selection_+3A_selection">selection</code></td>
<td>
<p>String of code. (Character)
</p>
<p>E.g. <code>"stop('This gives an expect_error test')"</code>.</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_indentation">indentation</code></td>
<td>
<p>Indentation of the selection. (Numeric)</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_tolerance">tolerance</code></td>
<td>
<p>The tolerance for numeric tests as a string, like <code>"1e-4"</code>. (Character)</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_round_to_tolerance">round_to_tolerance</code></td>
<td>
<p>Whether to round numeric elements to the specified tolerance. (Logical)
</p>
<p>This is currently applied to numeric columns and vectors (excluding some lists).</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_strip">strip</code></td>
<td>
<p>Whether to insert
<code><a href="#topic+strip">strip_msg()</a></code> and
<code><a href="#topic+strip">strip()</a></code>
in tests of side effects. (Logical)
</p>
<p>Sometimes testthat tests have differences in punctuation and newlines on different
systems. By stripping both the error message and the expected message of non-alphanumeric symbols,
we can avoid such failed tests.</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_sample_n">sample_n</code></td>
<td>
<p>The number of elements/rows to sample. Set to <code>NULL</code> to avoid sampling.
</p>
<p>Inserts <code><a href="#topic+strip">smpl()</a></code> in the generated tests when sampling was used. A seed is
set internally, setting <code>sample.kind</code> as <code>"Rounding"</code> to ensure compatibility with <code>R</code> versions
<code>&lt; 3.6.0</code>.
</p>
<p>The order of the elements/rows is kept intact. No replacement is used, why no oversampling will
take place.
</p>
<p>When testing a big <code>data.frame</code>, sampling the rows can help keep the test files somewhat readable.</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_envir">envir</code></td>
<td>
<p>Environment to evaluate in. Defaults to
<code><a href="base.html#topic+sys.parent">parent.frame()</a></code>.</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_copy_env">copy_env</code></td>
<td>
<p>Whether to work in a deep copy of the environment. (Logical)
</p>
<p>Side effects will be captured in copies of the copy, why two copies of the environment will
exist at the same time.
</p>
<p>Disabled by default to save memory but is often preferable to enable,
e.g. when the function changes non-local variables.</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_assign_output">assign_output</code></td>
<td>
<p>Whether to assign the output of a function call or long selection
to a variable. This will avoid recalling the function and decrease cluttering. (Logical)
</p>
<p>Heuristic: when the <code>`selection`</code> isn't of a string and contains a parenthesis, it is considered a function call.
A selection with more than 30 characters will be assigned as well.
</p>
<p>The tests themselves can be more difficult to interpret, as you will
have to look at the assignment to see the object that is being tested.</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_seed">seed</code></td>
<td>
<p><code>seed</code> to set. (Whole number)</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_test_id">test_id</code></td>
<td>
<p>Number to append to assignment names. (Whole number)
</p>
<p>For instance used to create the <code>"output_"</code> name: <code>output_&lt;test_id&gt;</code>.</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_add_wrapper_comments">add_wrapper_comments</code></td>
<td>
<p>Whether to add intro and outro comments. (Logical)</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_add_test_comments">add_test_comments</code></td>
<td>
<p>Whether to add comments for each test. (Logical)</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_start_with_newline">start_with_newline</code>, <code id="gxs_selection_+3A_end_with_newline">end_with_newline</code></td>
<td>
<p>Whether to have a newline in the beginning/end. (Logical)</p>
</td></tr>
<tr><td><code id="gxs_selection_+3A_out">out</code></td>
<td>
<p>Either <code>"insert"</code> or <code>"return"</code>.
</p>


<h4>&quot;insert&quot; (Default)</h4>

<p>Inserts the expectations via
<code><a href="rstudioapi.html#topic+rstudio-documents">rstudioapi::insertText()</a></code>.
</p>



<h4>&quot;return&quot;</h4>

<p>Returns the expectations in a <code>list</code>.
</p>
<p>These can be prepared for insertion with
<code><a href="#topic+prepare_insertion">prepare_insertion()</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following &quot;types&quot; are currently supported or intended to be supported in the future.
Please suggest more types and tests in a GitHub issue!
</p>
<p>Note: A set of fallback tests will be generated for unsupported objects.
</p>

<table>
<tr>
 <td style="text-align: right;">
<strong>Type</strong> </td><td style="text-align: right;"> <strong>Supported</strong> </td><td style="text-align: right;"> <strong>Notes</strong> </td>
</tr>
<tr>
 <td style="text-align: right;">
Side effects </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> Errors, warnings, and messages. </td>
</tr>
<tr>
 <td style="text-align: right;">
Vector </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> Lists are treated differently, depending on their structure. </td>
</tr>
<tr>
 <td style="text-align: right;">
Factor </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: right;">
Data Frame </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> List columns (like nested tibbles) are currently skipped. </td>
</tr>
<tr>
 <td style="text-align: right;">
Matrix </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> Supported but could be improved. </td>
</tr>
<tr>
 <td style="text-align: right;">
Formula </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: right;">
Function </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>NULL</code> </td><td style="text-align: right;"> Yes </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: right;">
Array </td><td style="text-align: right;"> No </td><td style="text-align: right;"> </td>
</tr>
<tr>
 <td style="text-align: right;">
Dates </td><td style="text-align: right;"> No </td><td style="text-align: right;"> Base and <code>lubridate</code>. </td>
</tr>
<tr>
 <td style="text-align: right;">
ggplot2 </td><td style="text-align: right;"> No </td><td style="text-align: right;"> This may be a challenge, but would be cool!</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>Either <code>NULL</code> or the unprepared expectations as a <code>character vector</code>.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other expectation generators: 
<code><a href="#topic+gxs_function">gxs_function</a>()</code>,
<code><a href="#topic+initializeGXSFunctionAddin">initializeGXSFunctionAddin</a>()</code>,
<code><a href="#topic+insertExpectationsAddin">insertExpectationsAddin</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

## Not run: 
df &lt;- data.frame('a' = c(1, 2, 3), 'b' = c('t', 'y', 'u'),
                 stringsAsFactors = FALSE)

gxs_selection("stop('This gives an expect_error test!')")
gxs_selection("warning('This gives a set of side effect tests!')")
gxs_selection("message('This also gives a set of side effect tests!')")
gxs_selection("stop('This: tests the -&gt; punctuation!')", strip = FALSE)
gxs_selection("sum(1, 2, 3, 4)")
gxs_selection("df")

tests &lt;- gxs_selection("df", out = "return")
for_insertion &lt;- prepare_insertion(tests)
rstudioapi::insertText(for_insertion)

## End(Not run)
</code></pre>

<hr>
<h2 id='initializeGXSFunctionAddin'>Initialize <code>gxs_function()</code> call</h2><span id='topic+initializeGXSFunctionAddin'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Initializes the <code>gxs_function()</code> call with the arguments and default values
of the selected function.
</p>
<p>See <code>`Details`</code> for how to set a key command.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initializeGXSFunctionAddin(selection = NULL, insert = TRUE, indentation = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initializeGXSFunctionAddin_+3A_selection">selection</code></td>
<td>
<p>Name of function to test with <code>gxs_function()</code>. (Character)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="initializeGXSFunctionAddin_+3A_insert">insert</code></td>
<td>
<p>Whether to insert the code via
<code><a href="rstudioapi.html#topic+rstudio-documents">rstudioapi::insertText()</a></code>
or return them. (Logical)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="initializeGXSFunctionAddin_+3A_indentation">indentation</code></td>
<td>
<p>Indentation of the selection. (Numeric)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>How</h4>

<p>Parses and evaluates the selected code string
within the parent environment.
When the output is a function, it extracts the formals (arguments and default values)
and creates the initial <code>`args_values`</code> for <code><a href="#topic+gxs_function">gxs_function()</a></code>.
When the output is not a function, it throws an error.
</p>



<h4>How to set up a key command in RStudio</h4>

<p>After installing the package.
Go to:
</p>
<p><code>Tools &gt;&gt; Addins &gt;&gt; Browse Addins &gt;&gt; Keyboard Shortcuts</code>.
</p>
<p>Find <code>"Initialize gxs_function()"</code> and press its field under <code>Shortcut</code>.
</p>
<p>Press desired key command, e.g. <code>Alt+F</code>.
</p>
<p>Press <code>Apply</code>.
</p>
<p>Press <code>Execute</code>.
</p>



<h3>Value</h3>

<p>Inserts <code><a href="#topic+gxs_function">gxs_function()</a></code> call for
the selected function.
</p>
<p>Returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other expectation generators: 
<code><a href="#topic+gxs_function">gxs_function</a>()</code>,
<code><a href="#topic+gxs_selection">gxs_selection</a>()</code>,
<code><a href="#topic+insertExpectationsAddin">insertExpectationsAddin</a>()</code>
</p>
<p>Other addins: 
<code><a href="#topic+assertCollectionAddin">assertCollectionAddin</a>()</code>,
<code><a href="#topic+dputSelectedAddin">dputSelectedAddin</a>()</code>,
<code><a href="#topic+initializeTestthatAddin">initializeTestthatAddin</a>()</code>,
<code><a href="#topic+insertExpectationsAddin">insertExpectationsAddin</a>()</code>,
<code><a href="#topic+navigateTestFileAddin">navigateTestFileAddin</a>()</code>,
<code><a href="#topic+wrapStringAddin">wrapStringAddin</a>()</code>
</p>

<hr>
<h2 id='initializeTestthatAddin'>Initializes <code>test_that()</code> call</h2><span id='topic+initializeTestthatAddin'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Inserts code for calling <code><a href="testthat.html#topic+test_that">testthat::test_that()</a></code>.
</p>
<p>See <code>`Details`</code> for how to set a key command.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initializeTestthatAddin(insert = TRUE, indentation = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initializeTestthatAddin_+3A_insert">insert</code></td>
<td>
<p>Whether to insert the code via
<code><a href="rstudioapi.html#topic+rstudio-documents">rstudioapi::insertText()</a></code>
or return it. (Logical)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="initializeTestthatAddin_+3A_indentation">indentation</code></td>
<td>
<p>Indentation of the code. (Numeric)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>How to set up a key command in RStudio</h4>

<p>After installing the package.
Go to:
</p>
<p><code>Tools &gt;&gt; Addins &gt;&gt; Browse Addins &gt;&gt; Keyboard Shortcuts</code>.
</p>
<p>Find <code>"Initialize test_that()"</code> and press its field under <code>Shortcut</code>.
</p>
<p>Press desired key command, e.g. <code>Alt+T</code>.
</p>
<p>Press <code>Apply</code>.
</p>
<p>Press <code>Execute</code>.
</p>



<h3>Value</h3>

<p>Inserts code for calling
<code><a href="testthat.html#topic+test_that">testthat::test_that()</a></code>.
</p>
<p>Returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other addins: 
<code><a href="#topic+assertCollectionAddin">assertCollectionAddin</a>()</code>,
<code><a href="#topic+dputSelectedAddin">dputSelectedAddin</a>()</code>,
<code><a href="#topic+initializeGXSFunctionAddin">initializeGXSFunctionAddin</a>()</code>,
<code><a href="#topic+insertExpectationsAddin">insertExpectationsAddin</a>()</code>,
<code><a href="#topic+navigateTestFileAddin">navigateTestFileAddin</a>()</code>,
<code><a href="#topic+wrapStringAddin">wrapStringAddin</a>()</code>
</p>

<hr>
<h2 id='insertExpectationsAddin'>Creates testthat tests for selected code</h2><span id='topic+insertExpectationsAddin'></span><span id='topic+insertExpectationsCopyEnvAddin'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Inserts relevant <code>expect_*</code> tests based
on the evaluation of the selected code.
</p>
<p>Example: If the selected code is the name of a <code>data.frame</code> object,
it will create an <code><a href="testthat.html#topic+equality-expectations">expect_equal</a></code>
test for each column,
along with a test of the column names.
</p>
<p>Currently supports side effects (<code>error</code>, <code>warning</code>s, <code>message</code>s),
<code>data.frame</code>s, and <code>vector</code>s.
</p>
<p>List columns in <code>data.frame</code>s (like nested <code>tibble</code>s) are currently skipped.
</p>
<p>See <code>`Details`</code> for how to set a key command.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insertExpectationsAddin(
  selection = NULL,
  insert = TRUE,
  indentation = 0,
  copy_env = FALSE
)

insertExpectationsCopyEnvAddin(
  selection = NULL,
  insert = TRUE,
  indentation = 0,
  copy_env = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="insertExpectationsAddin_+3A_selection">selection</code></td>
<td>
<p>String of code. (Character)
</p>
<p>E.g. <code>"stop('This gives an expect_error test')"</code>.
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="insertExpectationsAddin_+3A_insert">insert</code></td>
<td>
<p>Whether to insert the expectations via
<code><a href="rstudioapi.html#topic+rstudio-documents">rstudioapi::insertText()</a></code>
or return them. (Logical)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="insertExpectationsAddin_+3A_indentation">indentation</code></td>
<td>
<p>Indentation of the selection. (Numeric)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="insertExpectationsAddin_+3A_copy_env">copy_env</code></td>
<td>
<p>Whether to work in a deep copy of the environment. (Logical)
</p>
<p>Side effects will be captured in copies of the copy, why two copies of the environment will
exist at the same time.
</p>
<p>Disabled by default to save memory but is often preferable to enable,
e.g. when the function changes non-local variables.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>How</h4>

<p>Parses and evaluates the selected code string
within the parent environment (or a deep copy thereof).
Depending on the output, it creates a set of unit tests
(like <code>expect_equal(data[["column"]], c(1,2,3))</code>),
and inserts them instead of the selection.
</p>



<h4>How to set up a key command in RStudio</h4>

<p>After installing the package.
Go to:
</p>
<p><code>Tools &gt;&gt; Addins &gt;&gt; Browse Addins &gt;&gt; Keyboard Shortcuts</code>.
</p>
<p>Find <code>"Insert Expectations"</code> and press its field under <code>Shortcut</code>.
</p>
<p>Press desired key command, e.g. <code>Alt+E</code>.
</p>
<p>Press <code>Apply</code>.
</p>
<p>Press <code>Execute</code>.
</p>



<h3>Value</h3>

<p>Inserts <code><a href="testthat.html#topic+equality-expectations">testthat::expect_*</a></code>
unit tests for the selected code.
</p>
<p>Returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other expectation generators: 
<code><a href="#topic+gxs_function">gxs_function</a>()</code>,
<code><a href="#topic+gxs_selection">gxs_selection</a>()</code>,
<code><a href="#topic+initializeGXSFunctionAddin">initializeGXSFunctionAddin</a>()</code>
</p>
<p>Other addins: 
<code><a href="#topic+assertCollectionAddin">assertCollectionAddin</a>()</code>,
<code><a href="#topic+dputSelectedAddin">dputSelectedAddin</a>()</code>,
<code><a href="#topic+initializeGXSFunctionAddin">initializeGXSFunctionAddin</a>()</code>,
<code><a href="#topic+initializeTestthatAddin">initializeTestthatAddin</a>()</code>,
<code><a href="#topic+navigateTestFileAddin">navigateTestFileAddin</a>()</code>,
<code><a href="#topic+wrapStringAddin">wrapStringAddin</a>()</code>
</p>

<hr>
<h2 id='navigateTestFileAddin'>Navigates to test file</h2><span id='topic+navigateTestFileAddin'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p><code>RStudio</code> Addin:
Extracts file name and (possibly) line number of a test file
from a selection or from clipboard content.
Navigates to the file and places the cursor at the line number.
</p>
<p>Supported types of strings: <code>"test_x.R:3"</code>, <code>"test_x.R#3"</code>, <code>"test_x.R"</code>.
</p>
<p>The string must start with <code>"test_"</code> and contain <code>".R"</code>.
It is split at either <code>":"</code> or <code>"#"</code>, with the second element (here <code>"3"</code>) being
interpreted as the line number.
</p>
<p>See <code>`Details`</code> for how to set a key command.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>navigateTestFileAddin(selection = NULL, navigate = TRUE, abs_path = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="navigateTestFileAddin_+3A_selection">selection</code></td>
<td>
<p>String with file name and line number. (Character)
</p>
<p>E.g. <code>"test_x.R:3:"</code>, which navigates to the third line of <code>"/tests/testthat/test_x.R"</code>.
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="navigateTestFileAddin_+3A_navigate">navigate</code></td>
<td>
<p>Whether to navigate to the file or return the extracted file name and line number. (Logical)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="navigateTestFileAddin_+3A_abs_path">abs_path</code></td>
<td>
<p>Whether to return the full path or only the file name when <code>`navigate`</code> is <code>FALSE</code>.
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>How to set up a key command in RStudio</h4>

<p>After installing the package.
Go to:
</p>
<p><code>Tools &gt;&gt; Addins &gt;&gt; Browse Addins &gt;&gt; Keyboard Shortcuts</code>.
</p>
<p>Find <code>"Go To Test File"</code> and press its field under <code>Shortcut</code>.
</p>
<p>Press desired key command, e.g. <code>Alt+N</code>.
</p>
<p>Press <code>Apply</code>.
</p>
<p>Press <code>Execute</code>.
</p>



<h3>Value</h3>

<p>Navigates to file and line number.
</p>
<p>Does not return anything.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other addins: 
<code><a href="#topic+assertCollectionAddin">assertCollectionAddin</a>()</code>,
<code><a href="#topic+dputSelectedAddin">dputSelectedAddin</a>()</code>,
<code><a href="#topic+initializeGXSFunctionAddin">initializeGXSFunctionAddin</a>()</code>,
<code><a href="#topic+initializeTestthatAddin">initializeTestthatAddin</a>()</code>,
<code><a href="#topic+insertExpectationsAddin">insertExpectationsAddin</a>()</code>,
<code><a href="#topic+wrapStringAddin">wrapStringAddin</a>()</code>
</p>

<hr>
<h2 id='num_total_elements'>Total number of elements</h2><span id='topic+num_total_elements'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Unlists <code>`x`</code> recursively and finds the total number of elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>num_total_elements(x, deduplicated = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="num_total_elements_+3A_x">x</code></td>
<td>
<p>List with elements.</p>
</td></tr>
<tr><td><code id="num_total_elements_+3A_deduplicated">deduplicated</code></td>
<td>
<p>Whether to only count the unique elements. (Logical)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simple wrapper for
<code>length(unlist(x, recursive = TRUE, use.names = FALSE))</code>.
</p>


<h3>Value</h3>

<p>The total number of elements in <code>`x`</code>.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other element descriptors: 
<code><a href="#topic+element_classes">element_classes</a>()</code>,
<code><a href="#topic+element_lengths">element_lengths</a>()</code>,
<code><a href="#topic+element_types">element_types</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

l &lt;- list(list(list(1, 2, 3), list(2, list(3, 2))),
          list(1, list(list(2, 4), list(7, 1, list(3, 8)))),
          list(list(2, 7, 8), list(10, 2, list(18, 1, 4))))

num_total_elements(l)
num_total_elements(l, deduplicated = TRUE)
</code></pre>

<hr>
<h2 id='prepare_insertion'>Prepare expectations for insertion</h2><span id='topic+prepare_insertion'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Collapses a <code>list</code>/<code>vector</code> of expectation strings and adds the specified indentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_insertion(
  strings,
  indentation = 0,
  trim_left = FALSE,
  trim_right = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_insertion_+3A_strings">strings</code></td>
<td>
<p>Expectation strings. (List or Character)
</p>
<p>As returned with <code>gxs_*</code> functions with <code>out = "return"</code>.</p>
</td></tr>
<tr><td><code id="prepare_insertion_+3A_indentation">indentation</code></td>
<td>
<p>Indentation to add. (Numeric)</p>
</td></tr>
<tr><td><code id="prepare_insertion_+3A_trim_left">trim_left</code></td>
<td>
<p>Whether to trim whitespaces from the beginning of the collapsed string. (Logical)</p>
</td></tr>
<tr><td><code id="prepare_insertion_+3A_trim_right">trim_right</code></td>
<td>
<p>Whether to trim whitespaces from the end of the collapsed string. (Logical)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string for insertion with <code><a href="rstudioapi.html#topic+rstudio-documents">rstudioapi::insertText()</a></code>.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

## Not run: 
df &lt;- data.frame('a' = c(1, 2, 3), 'b' = c('t', 'y', 'u'),
                 stringsAsFactors = FALSE)

tests &lt;- gxs_selection("df", out = "return")
for_insertion &lt;- prepare_insertion(tests)
for_insertion
rstudioapi::insertText(for_insertion)

## End(Not run)
</code></pre>

<hr>
<h2 id='render_toc'>Render Table of Contents</h2><span id='topic+render_toc'></span>

<h3>Description</h3>

<p>From: https://gist.github.com/gadenbuie/c83e078bf8c81b035e32c3fc0cf04ee8
</p>


<h3>Usage</h3>

<pre><code class='language-R'>render_toc(
  filename,
  toc_header_name = "Table of Contents",
  base_level = NULL,
  toc_depth = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="render_toc_+3A_filename">filename</code></td>
<td>
<p>Name of RMarkdown or Markdown document</p>
</td></tr>
<tr><td><code id="render_toc_+3A_toc_header_name">toc_header_name</code></td>
<td>
<p>The table of contents header name. If specified, any
header with this format will not be included in the TOC. Set to <code>NULL</code> to
include the TOC itself in the TOC (but why?).</p>
</td></tr>
<tr><td><code id="render_toc_+3A_base_level">base_level</code></td>
<td>
<p>Starting level of the lowest header level. Any headers
prior to the first header at the base_level are dropped silently.</p>
</td></tr>
<tr><td><code id="render_toc_+3A_toc_depth">toc_depth</code></td>
<td>
<p>Maximum depth for TOC, relative to base_level. Default is
<code>toc_depth = 3</code>, which results in a TOC of at most 3 levels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A simple function to extract headers from an RMarkdown or Markdown document
and build a table of contents. Returns a markdown list with links to the
headers using pandoc header identifiers.
</p>
<p>WARNING: This function only works with hash-tag headers.
</p>
<p>Because this function returns only the markdown list, the header for the
Table of Contents itself must be manually included in the text. Use
<code>toc_header_name</code> to exclude the table of contents header from the TOC, or
set to <code>NULL</code> for it to be included.
</p>


<h3>Usage</h3>

<p>Just drop in a chunk where you want the toc to appear (set <code>echo=FALSE</code>):
</p>
<div class="sourceCode"><pre># Table of Contents

```{r echo=FALSE}
render_toc("/path/to/the/file.Rmd")
```
</pre></div>

<hr>
<h2 id='set_test_seed'>Set random seed for unit tests</h2><span id='topic+set_test_seed'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>In order for tests to be compatible with <code>R</code> versions <code>&lt; 3.6.0</code>,
we set the <code>sample.kind</code> argument in <code><a href="base.html#topic+Random">set.seed()</a></code>
to <code>"Rounding"</code> when using <code>R</code> versions <code>&gt;= 3.6.0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_test_seed(seed = 42, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_test_seed_+3A_seed">seed</code></td>
<td>
<p>Random <code>seed</code>.</p>
</td></tr>
<tr><td><code id="set_test_seed_+3A_...">...</code></td>
<td>
<p>Named arguments to <code><a href="base.html#topic+Random">set.seed()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Initially contributed by R. Mark Sharp (github: @rmsharp).
</p>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>
<p>R. Mark Sharp
</p>

<hr>
<h2 id='simplified_formals'>Extract and simplify a function's formal arguments</h2><span id='topic+simplified_formals'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Extracts <code><a href="base.html#topic+formals">formals</a></code> and
formats them as an easily testable <code>character vector</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplified_formals(fn)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simplified_formals_+3A_fn">fn</code></td>
<td>
<p><code>Function</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>character vector</code> with the simplified formals.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

fn1 &lt;- function(a = "x", b = NULL, c = NA, d){
  paste0(a, b, c, d)
}

simplified_formals(fn1)
</code></pre>

<hr>
<h2 id='smpl'>Random sampling</h2><span id='topic+smpl'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Samples a <code>vector</code>, <code>factor</code> or <code>data.frame</code>. Useful to reduce size of testthat <code>expect_*</code> tests.
Not intended for other purposes.
</p>
<p>Wraps <code><a href="base.html#topic+sample">sample.int()</a></code>. <code>data.frame</code>s are sampled row-wise.
</p>
<p>The <code>seed</code> is set within the function with <code>sample.kind</code> as <code>"Rounding"</code>
for compatibility with <code>R</code> versions <code>&lt; 3.6.0</code>. On exit, the random state is restored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smpl(data, n, keep_order = TRUE, seed = 42)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smpl_+3A_data">data</code></td>
<td>
<p><code>vector</code> or <code>data.frame</code>. (Logical)</p>
</td></tr>
<tr><td><code id="smpl_+3A_n">n</code></td>
<td>
<p>Number of elements/rows to sample.
</p>
<p><strong>N.B.</strong> No replacement is used, why <code>n &gt;</code> the number of elements/rows in <code>`data`</code> won't
perform oversampling.</p>
</td></tr>
<tr><td><code id="smpl_+3A_keep_order">keep_order</code></td>
<td>
<p>Whether to keep the order of the elements. (Logical)</p>
</td></tr>
<tr><td><code id="smpl_+3A_seed">seed</code></td>
<td>
<p><code>seed</code> to use.
</p>
<p>The <code>seed</code> is set with <code>sample.kind = "Rounding"</code>
for compatibility with <code>R</code> versions <code>&lt; 3.6.0</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>`data`</code> has <code>&lt;=`n`</code> elements, <code>`data`</code> is returned.
Otherwise, <code>`data`</code> is sampled and returned.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

smpl(c(1,2,3,4,5), n = 3)
smpl(data.frame("a" = c(1,2,3,4,5), "b" = c(2,3,4,5,6), stringsAsFactors = FALSE), n = 3)
</code></pre>

<hr>
<h2 id='stop_if'>Simple side effect functions</h2><span id='topic+stop_if'></span><span id='topic+warn_if'></span><span id='topic+message_if'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>If the <code>`condition`</code> is <code>TRUE</code>,
generate <code>error</code>/<code>warning</code>/<code>message</code> with the supplied message.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stop_if(condition, message = NULL, sys.parent.n = 0L)

warn_if(condition, message = NULL, sys.parent.n = 0L)

message_if(condition, message = NULL, sys.parent.n = 0L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stop_if_+3A_condition">condition</code></td>
<td>
<p>The condition to check. (Logical)</p>
</td></tr>
<tr><td><code id="stop_if_+3A_message">message</code></td>
<td>
<p>Message. (Character)
</p>
<p>Note: If <code>NULL</code>, the <code>`condition`</code> will be used as message.</p>
</td></tr>
<tr><td><code id="stop_if_+3A_sys.parent.n">sys.parent.n</code></td>
<td>
<p>The number of generations to go back when calling the message function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>`condition`</code> is <code>FALSE</code>, they return <code>NULL</code> invisibly.
</p>
<p>When <code>`condition`</code> is <code>TRUE</code>:
</p>


<h4>stop_if()</h4>

<p>Throws error with the supplied message.
</p>



<h4>warn_if()</h4>

<p>Throws warning with the supplied message.
</p>



<h4>message_if()</h4>

<p>Generates message with the supplied message.
</p>



<h3>Value</h3>

<p>Returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

# Note: The use of `try()` is just for package-testing purposes


a &lt;- 0
try(stop_if(a == 0, "'a' cannot be 0."))
try(warn_if(a == 0, "'a' was 0."))
message_if(a == 0, "'a' was so kind to be 0.")

</code></pre>

<hr>
<h2 id='strip'>Strip strings of non-alphanumeric characters</h2><span id='topic+strip'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>

<ol>
<li><p> Removes any character that is not alphanumeric or a space.
</p>
</li>
<li><p> (Disabled by default): Remove numbers.
</p>
</li>
<li><p> Reduces multiple consecutive whitespaces to a single whitespace and trims ends.
</p>
</li></ol>

<p>Can for instance be used to simplify error messages before checking them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strip(
  strings,
  replacement = "",
  remove_spaces = FALSE,
  remove_numbers = FALSE,
  remove_ansi = TRUE,
  lowercase = FALSE,
  allow_na = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strip_+3A_strings">strings</code></td>
<td>
<p><code>vector</code> of strings. (Character)</p>
</td></tr>
<tr><td><code id="strip_+3A_replacement">replacement</code></td>
<td>
<p>What to replace blocks of punctuation with. (Character)</p>
</td></tr>
<tr><td><code id="strip_+3A_remove_spaces">remove_spaces</code></td>
<td>
<p>Whether to remove all whitespaces. (Logical)</p>
</td></tr>
<tr><td><code id="strip_+3A_remove_numbers">remove_numbers</code></td>
<td>
<p>Whether to remove all numbers. (Logical)</p>
</td></tr>
<tr><td><code id="strip_+3A_remove_ansi">remove_ansi</code></td>
<td>
<p>Whether to remove ANSI control sequences. (Logical)</p>
</td></tr>
<tr><td><code id="strip_+3A_lowercase">lowercase</code></td>
<td>
<p>Whether to make the strings lowercase. (Logical)</p>
</td></tr>
<tr><td><code id="strip_+3A_allow_na">allow_na</code></td>
<td>
<p>Whether to allow <code>strings</code>
to contain <code>NA</code>s. (Logical)</p>
</td></tr>
</table>


<h3>Details</h3>


<ol>
<li><p> ANSI control sequences are removed with <code><a href="fansi.html#topic+strip_ctl">fansi::strip_ctl()</a></code>.
</p>
</li>
<li> <p><code>gsub("[^[:alnum:][:blank:]]", replacement, strings))</code>
</p>
</li>
<li> <p><code>gsub('[0-9]+', '', strings)</code> (Note: only if specified!)
</p>
</li>
<li> <p><code>trimws( gsub("[[:blank:]]+", " ", strings) )</code>
(Or <code>""</code> if <code>remove_spaces</code> is <code>TRUE</code>)
</p>
</li></ol>



<h3>Value</h3>

<p>The stripped strings.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other strippers: 
<code><a href="#topic+strip_msg">strip_msg</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

strings &lt;- c(
  "Hello! I am George.  \n\rDon't call me Frank! 123",
  "    \tAs that, is, not, my,     name!"
)

strip(strings)
strip(strings, remove_spaces = TRUE)
strip(strings, remove_numbers = TRUE)
</code></pre>

<hr>
<h2 id='strip_msg'>Strip side-effect messages of non-alphanumeric characters and rethrow them</h2><span id='topic+strip_msg'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Catches side effects (<code>error</code>, <code>warning</code>s, <code>message</code>s), strips the message strings of
non-alphanumeric characters with <code><a href="#topic+strip">strip()</a></code> and regenerates them.
</p>
<p>When numbers in error messages vary slightly between systems
(and this variation isn't important to catch), we can strip the numbers as well.
</p>
<p>Use case: Sometimes <code>testthat</code> tests have differences in punctuation and newlines on different
systems. By stripping both the error message and the expected message
(with <code><a href="#topic+strip">strip()</a></code>), we can avoid such failed tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strip_msg(
  x,
  remove_spaces = FALSE,
  remove_numbers = FALSE,
  remove_ansi = TRUE,
  lowercase = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strip_msg_+3A_x">x</code></td>
<td>
<p>Code that potentially throws <code>warning</code>s, <code>message</code>s, or an <code>error</code>.</p>
</td></tr>
<tr><td><code id="strip_msg_+3A_remove_spaces">remove_spaces</code></td>
<td>
<p>Whether to remove all whitespaces. (Logical)</p>
</td></tr>
<tr><td><code id="strip_msg_+3A_remove_numbers">remove_numbers</code></td>
<td>
<p>Whether to remove all numbers. (Logical)</p>
</td></tr>
<tr><td><code id="strip_msg_+3A_remove_ansi">remove_ansi</code></td>
<td>
<p>Whether to remove ANSI control sequences. (Logical)</p>
</td></tr>
<tr><td><code id="strip_msg_+3A_lowercase">lowercase</code></td>
<td>
<p>Whether to make the strings lowercase. (Logical)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other strippers: 
<code><a href="#topic+strip">strip</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)
library(testthat)

# Note: The use of `try()` is just for package-testing purposes


try(strip_msg(stop("this 'dot' .\n is removed! 123")))
try(strip_msg(warning("this 'dot' .\n is removed! 123")))
strip_msg(message("this 'dot' .\n is removed! 123"))
strip_msg(message("this 'dot' .\n is removed! 123"), remove_numbers = TRUE)
error_fn &lt;- function(){stop("this 'dot' .\n is removed! 123")}
try(strip_msg(error_fn()))

# With testthat tests
expect_error(strip_msg(error_fn()),
             strip("this 'dot' .\n is removed! 123"))
expect_error(strip_msg(error_fn(), remove_numbers = TRUE),
             strip("this 'dot' .\n is removed! 123", remove_numbers = TRUE))

</code></pre>

<hr>
<h2 id='suppress_mw'>Suppress warnings and messages</h2><span id='topic+suppress_mw'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Run expression wrapped in both
<code><a href="base.html#topic+message">suppressMessages()</a></code> and
<code><a href="base.html#topic+warning">suppressWarnings()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>suppress_mw(expr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="suppress_mw_+3A_expr">expr</code></td>
<td>
<p>Any expression to run within <code><a href="base.html#topic+message">suppressMessages()</a></code> and
<code><a href="base.html#topic+warning">suppressWarnings()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>suppressWarnings(suppressMessages(expr))</code>
</p>


<h3>Value</h3>

<p>The output of <code>expr</code>.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Attach packages
library(xpectr)

fn &lt;- function(a, b){
  warning("a warning")
  message("a message")
  a + b
}

suppress_mw(fn(1, 5))
</code></pre>

<hr>
<h2 id='wrapStringAddin'>Wraps the selection with paste0</h2><span id='topic+wrapStringAddin'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Splits the selection every n characters
and inserts it in a <code><a href="base.html#topic+paste">paste0()</a></code> call.
</p>
<p>See <code>`Details`</code> for how to set a key command.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrapStringAddin(
  selection = NULL,
  indentation = 0,
  every_n = NULL,
  tolerance = 10,
  insert = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wrapStringAddin_+3A_selection">selection</code></td>
<td>
<p>String of code. (Character)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="wrapStringAddin_+3A_indentation">indentation</code></td>
<td>
<p>Indentation of the selection. (Numeric)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
<tr><td><code id="wrapStringAddin_+3A_every_n">every_n</code></td>
<td>
<p>Number of characters per split.
</p>
<p>If <code>NULL</code>, the following is used to calculate the string width:
</p>
<p><code>max(min(80 - indentation, 70), 50)</code>
</p>
<p><strong>N.B.</strong> Strings shorter than <code>every_n + tolerance</code> will not be wrapped.</p>
</td></tr>
<tr><td><code id="wrapStringAddin_+3A_tolerance">tolerance</code></td>
<td>
<p>Tolerance. Number of characters.
</p>
<p>We may prefer not to split a string that's only a few
characters too long. Strings shorter than <code>every_n + tolerance</code>
will not be wrapped.</p>
</td></tr>
<tr><td><code id="wrapStringAddin_+3A_insert">insert</code></td>
<td>
<p>Whether to insert the wrapped text via
<code><a href="rstudioapi.html#topic+rstudio-documents">rstudioapi::insertText()</a></code>
or return it. (Logical)
</p>
<p><strong>N.B.</strong> Mainly intended for testing the addin programmatically.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>How to set up a key command in RStudio</h4>

<p>After installing the package.
Go to:
</p>
<p><code>Tools &gt;&gt; Addins &gt;&gt; Browse Addins &gt;&gt; Keyboard Shortcuts</code>.
</p>
<p>Find <code>"Wrap String with paste0"</code> and press its
field under <code>Shortcut</code>.
</p>
<p>Press desired key command, e.g. <code>Alt+P</code>.
</p>
<p>Press <code>Apply</code>.
</p>
<p>Press <code>Execute</code>.
</p>



<h3>Value</h3>

<p>Inserts the following (with newlines and correct indentation):
</p>
<p><code>paste0("first n chars", "next n chars")</code>
</p>
<p>Returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Ludvig Renbo Olsen, <a href="mailto:r-pkgs@ludvigolsen.dk">r-pkgs@ludvigolsen.dk</a>
</p>


<h3>See Also</h3>

<p>Other addins: 
<code><a href="#topic+assertCollectionAddin">assertCollectionAddin</a>()</code>,
<code><a href="#topic+dputSelectedAddin">dputSelectedAddin</a>()</code>,
<code><a href="#topic+initializeGXSFunctionAddin">initializeGXSFunctionAddin</a>()</code>,
<code><a href="#topic+initializeTestthatAddin">initializeTestthatAddin</a>()</code>,
<code><a href="#topic+insertExpectationsAddin">insertExpectationsAddin</a>()</code>,
<code><a href="#topic+navigateTestFileAddin">navigateTestFileAddin</a>()</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
