<!DOCTYPE html><html lang="en"><head><title>Help for package msae</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {msae}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#datasae1'><p>Data generated based on Multivariate Fay Herriot Model (Model 1)</p></a></li>
<li><a href='#datasae2'><p>Data generated based on Autoregressive Multivariate Fay Herriot Model (Model 2)</p></a></li>
<li><a href='#datasae3'><p>Data generated based on Heteroscedastic Autoregressive Multivariate Fay Herriot Model (Model 3)</p></a></li>
<li><a href='#df2matR'><p>Transform Dataframe to Matrix R</p></a></li>
<li><a href='#eblupMFH1'><p>EBLUPs based on a Multivariate Fay Herriot (Model 1)</p></a></li>
<li><a href='#eblupMFH2'><p>EBLUPs based on a Autoregressive Multivariate Fay Herriot (Model 2)</p></a></li>
<li><a href='#eblupMFH3'><p>EBLUPs based on a Heteroscedastic Autoregressive Multivariate Fay Herriot (Model 3)</p></a></li>
<li><a href='#eblupUFH'><p>EBLUPs based on a Univariate Fay Herriot (Model 0)</p></a></li>
<li><a href='#msae'><p>msae : Multivariate Fay Herriot Models for Small Area Estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Fay Herriot Models for Small Area Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.5</td>
</tr>
<tr>
<td>Author:</td>
<td>Novia Permatasari, Azka Ubaidillah</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Novia Permatasari &lt;novia.permatasari@bps.go.id&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements multivariate Fay-Herriot models for small area estimation. It uses empirical best linear unbiased prediction (EBLUP) estimator. Multivariate models consider the correlation of several target variables and borrow strength from auxiliary variables to improve the effectiveness of a domain sample size. Models which accommodated by this package are univariate model with several target variables (model 0), multivariate model (model 1), autoregressive multivariate model (model 2), and heteroscedastic autoregressive multivariate model (model 3). Functions provide EBLUP estimators and mean squared error (MSE) estimator for each model. These models were developed by Roberto Benavent and Domingo Morales (2015) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2015.07.013">doi:10.1016/j.csda.2015.07.013</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>magic</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-24 16:46:44 UTC; Novia</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-24 19:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='datasae1'>Data generated based on Multivariate Fay Herriot Model (Model 1)</h2><span id='topic+datasae1'></span>

<h3>Description</h3>

<p>This data is generated based on multivariate Fay-Herriot model (model 1) by these following steps:
</p>

<ol>
<li><p> Generate sampling error <code>e</code>, random effect <code>u</code>, and auxiliary variables <code>X1 X2</code>.
</p>

<ul>
<li><p> For sampling error <code>e</code>, we set <code class="reqn">e_{d}</code> ~ <code class="reqn">N_{3}(0, V_{ed})</code> , where <code class="reqn">V_{ed} = (\sigma_{dij})_{i,j=1,2,3}</code>, with  <code class="reqn">\sigma_{11}</code>  ~ <code class="reqn">InvGamma(11, 1)</code>, <code class="reqn">\sigma_{22}</code>  ~ <code class="reqn">InvGamma(11, 2)</code>,  <code class="reqn">\sigma_{33}</code>  ~ <code class="reqn">InvGamma(11, 3)</code>, and <code class="reqn">\rho_{e}</code> = 0.5.
</p>
</li>
<li><p> For random effect <code>u</code>, we set <code class="reqn">u</code> ~ <code class="reqn">N_{3}(0, V_{u})</code> , where <code class="reqn">\sigma_{u11}</code> = 0.2 , <code class="reqn">\sigma_{u22}</code> = 0.4 , and <code class="reqn">\sigma_{u33}</code> = 1.2.
</p>
</li>
<li><p> For auxiliary variables <code>X1 and X2</code>, we set <code class="reqn">X1</code> ~ <code class="reqn">N(5, 0.1)</code> and <code class="reqn">X2</code> ~ <code class="reqn">N(10, 0.2)</code>.
</p>
</li></ul>

</li>
<li><p> Calculate direct estimation <code>Y1 Y2 and Y3</code> , where <code class="reqn">Y_{i}</code> = <code class="reqn">X * \beta + u_{i} + e_{i}</code>. We take <code class="reqn">\beta_{1} = 5</code> and <code class="reqn">\beta_{2} = 10</code>.
</p>
</li></ol>

<p>Auxiliary variables <code>X1 X2</code>, direct estimation <code>Y1 Y2 Y3</code>, and sampling variance-covariance <code>v1 v2 v3 v12 v13 v23</code> are combined into a dataframe called datasae1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasae1
</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows and 11 variables:
</p>

<dl>
<dt>X1</dt><dd><p>Auxiliary variable of X1</p>
</dd>
<dt>X2</dt><dd><p>Auxiliary variable of X2</p>
</dd>
<dt>Y1</dt><dd><p>Direct Estimation of Y1</p>
</dd>
<dt>Y2</dt><dd><p>Direct Estimation of Y2</p>
</dd>
<dt>Y3</dt><dd><p>Direct Estimation of Y3</p>
</dd>
<dt>v1</dt><dd><p>Sampling Variance of Y1</p>
</dd>
<dt>v12</dt><dd><p>Sampling Covariance of Y1 and Y2</p>
</dd>
<dt>v13</dt><dd><p>Sampling Covariance of Y1 and Y3</p>
</dd>
<dt>v2</dt><dd><p>Sampling Variance of Y2</p>
</dd>
<dt>v23</dt><dd><p>Sampling Covariance of Y2 and Y3</p>
</dd>
<dt>v3</dt><dd><p>Sampling Variance of Y3</p>
</dd>
</dl>



<h3>Reference</h3>

<p>Benavent, Roberto &amp; Morales, Domingo. (2015). Multivariate Fay-Herriot models for small area estimation. Computational Statistics &amp; Data Analysis. 100. 372-390. DOI: 10.1016/j.csda.2015.07.013.
</p>

<hr>
<h2 id='datasae2'>Data generated based on Autoregressive Multivariate Fay Herriot Model (Model 2)</h2><span id='topic+datasae2'></span>

<h3>Description</h3>

<p>This data is generated based on autoregressive multivariate Fay-Herriot model (model 2) by following these steps:
</p>

<ol>
<li><p> Generate sampling error <code>e</code>, random effect <code>u</code>, and auxiliary variables <code>X1 X2</code>.
</p>

<ul>
<li><p> For sampling error <code>e</code>, we set <code class="reqn">e</code> ~ <code class="reqn">N_{3}(0, V_{e})</code> , where <code class="reqn">V_{e} = (\sigma_{ij})_{i,j=1,2,3}</code>, with  <code class="reqn">\sigma_{11}</code> = 0.1 , <code class="reqn">\sigma_{22}</code> = 0.2 ,  <code class="reqn">\sigma_{33}</code> = 0.3 , and <code class="reqn">\rho_{e}</code> = 0.5.
</p>
</li>
<li><p> For random effect <code>u</code>, we set <code class="reqn">u</code> ~ <code class="reqn">N_{3}(0, V_{u})</code> , where <code class="reqn">\sigma_{u}</code> = 0.4, and <code class="reqn">\rho_{u}</code> = 0.8.
</p>
</li>
<li><p> For auxiliary variables <code>X1 and X2</code>, we set <code class="reqn">X1</code> ~ <code class="reqn">N(5, 0.1)</code> and <code class="reqn">X2</code> ~ <code class="reqn">N(10, 0.2)</code>.
</p>
</li></ul>

</li>
<li><p> Calculate direct estimation <code>Y1 Y2 and Y3</code> , where <code class="reqn">Y_{i}</code> = <code class="reqn">X * \beta + u_{i} + e_{i}</code>. We take <code class="reqn">\beta_{1} = 5</code> and <code class="reqn">\beta_{2} = 10</code>.
</p>
</li></ol>

<p>Auxiliary variables <code>X1 X2</code>, direct estimation <code>Y1 Y2 Y3</code>, and sampling variance-covariance <code>v1 v2 v3 v12 v13 v23</code> are combined into a dataframe called datasae2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasae2
</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows and 11 variables:
</p>

<dl>
<dt>X1</dt><dd><p>Auxiliary variable of X1</p>
</dd>
<dt>X2</dt><dd><p>Auxiliary variable of X2</p>
</dd>
<dt>Y1</dt><dd><p>Direct Estimation of Y1</p>
</dd>
<dt>Y2</dt><dd><p>Direct Estimation of Y2</p>
</dd>
<dt>Y3</dt><dd><p>Direct Estimation of Y3</p>
</dd>
<dt>v1</dt><dd><p>Sampling Variance of Y1</p>
</dd>
<dt>v12</dt><dd><p>Sampling Covariance of Y1 and Y2</p>
</dd>
<dt>v13</dt><dd><p>Sampling Covariance of Y1 and Y3</p>
</dd>
<dt>v2</dt><dd><p>Sampling Variance of Y2</p>
</dd>
<dt>v23</dt><dd><p>Sampling Covariance of Y2 and Y3</p>
</dd>
<dt>v3</dt><dd><p>Sampling Variance of Y3</p>
</dd>
</dl>



<h3>Reference</h3>

<p>Benavent, Roberto &amp; Morales, Domingo. (2015). Multivariate Fay-Herriot models for small area estimation. Computational Statistics &amp; Data Analysis. 100. 372-390. DOI: 10.1016/j.csda.2015.07.013.
</p>

<hr>
<h2 id='datasae3'>Data generated based on Heteroscedastic Autoregressive Multivariate Fay Herriot Model (Model 3)</h2><span id='topic+datasae3'></span>

<h3>Description</h3>

<p>This data is generated based on heteroscedastic autoregressive multivariate Fay-Herriot model (model 3) by following these steps:
</p>

<ol>
<li><p> Generate sampling error <code>e</code>, random effect <code>u</code>, and auxiliary variables <code>X1 X2</code>.
</p>

<ul>
<li><p> For sampling error <code>e</code>, we set <code class="reqn">e</code> ~ <code class="reqn">N_{3}(0, V_{e})</code> , where <code class="reqn">V_{e} = (\sigma_{ij})_{i,j=1,2,3}</code>, with  <code class="reqn">\sigma_{11}</code> = 0.1 , <code class="reqn">\sigma_{22}</code> = 0.2 , <code class="reqn">\sigma_{33}</code> = 0.3 , and <code class="reqn">\rho_{e}</code> = 0.5.
</p>
</li>
<li><p> For random effect <code>u</code>, we set <code class="reqn">u</code> ~ <code class="reqn">N_{3}(0, V_{u})</code> , where <code class="reqn">\sigma_{u11}</code> = 0.2 , <code class="reqn">\sigma_{u22}</code> = 0.4 , <code class="reqn">\sigma_{u33}</code> = 1.2, and <code class="reqn">\rho_{u}</code> = 0.8.
</p>
</li>
<li><p> For auxiliary variables <code>X1 and X2</code>, we set <code class="reqn">X1</code> ~ <code class="reqn">N(5, 0.1)</code> and <code class="reqn">X2</code> ~ <code class="reqn">N(10, 0.2)</code>.
</p>
</li></ul>

</li>
<li><p> Calculate direct estimation <code>Y1 Y2 and Y3</code> , where <code class="reqn">Y_{i}</code> = <code class="reqn">X * \beta + u_{i} + e_{i}</code>. We take <code class="reqn">\beta_{1} = 5</code> and <code class="reqn">\beta_{2} = 10</code>.
</p>
</li></ol>

<p>Auxiliary variables <code>X1 X2</code>, direct estimation <code>Y1 Y2 Y3</code>, and sampling variance-covariance <code>v1 v2 v3 v12 v13 v23</code> are combined into a dataframe called datasae3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasae3
</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows and 11 variables:
</p>

<dl>
<dt>X1</dt><dd><p>Auxiliary variable of X1</p>
</dd>
<dt>X2</dt><dd><p>Auxiliary variable of X2</p>
</dd>
<dt>Y1</dt><dd><p>Direct Estimation of Y1</p>
</dd>
<dt>Y2</dt><dd><p>Direct Estimation of Y2</p>
</dd>
<dt>Y3</dt><dd><p>Direct Estimation of Y3</p>
</dd>
<dt>v1</dt><dd><p>Sampling Variance of Y1</p>
</dd>
<dt>v12</dt><dd><p>Sampling Covariance of Y1 and Y2</p>
</dd>
<dt>v13</dt><dd><p>Sampling Covariance of Y1 and Y3</p>
</dd>
<dt>v2</dt><dd><p>Sampling Variance of Y2</p>
</dd>
<dt>v23</dt><dd><p>Sampling Covariance of Y2 and Y3</p>
</dd>
<dt>v3</dt><dd><p>Sampling Variance of Y3</p>
</dd>
</dl>



<h3>Reference</h3>

<p>Benavent, Roberto &amp; Morales, Domingo. (2015). Multivariate Fay-Herriot models for small area estimation. Computational Statistics &amp; Data Analysis. 100. 372-390. DOI: 10.1016/j.csda.2015.07.013.
</p>

<hr>
<h2 id='df2matR'>Transform Dataframe to Matrix R</h2><span id='topic+df2matR'></span>

<h3>Description</h3>

<p>This function transforms dataframe contains sampling variance to block diagonal matrix R
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df2matR(var.df, r)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df2matR_+3A_var.df">var.df</code></td>
<td>
<p>dataframe of sampling variances of direct estimators.</p>
</td></tr>
<tr><td><code id="df2matR_+3A_r">r</code></td>
<td>
<p>number of variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Block diagonal matrix R
</p>


<h3>Examples</h3>

<pre><code class='language-R'>NULL
</code></pre>

<hr>
<h2 id='eblupMFH1'>EBLUPs based on a Multivariate Fay Herriot (Model 1)</h2><span id='topic+eblupMFH1'></span>

<h3>Description</h3>

<p>This function gives the EBLUP and MSE based on a multivariate Fay-Herriot model (model 1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eblupMFH1(
  formula,
  vardir,
  samevar = FALSE,
  MAXITER = 100,
  PRECISION = 1e-04,
  data
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eblupMFH1_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="eblupMFH1_+3A_vardir">vardir</code></td>
<td>
<p>if data is available, it is vector containing name of sampling variances of direct estimators. if not, it is data frame of sampling variances of direct estimators. The order is : <code>var1, var2, . , var(k) , cov12, . cov1k, cov23, . , cov(k-1)(k)</code></p>
</td></tr>
<tr><td><code id="eblupMFH1_+3A_samevar">samevar</code></td>
<td>
<p>logical input, true if variances of the data are same, Default: <code>FALSE</code></p>
</td></tr>
<tr><td><code id="eblupMFH1_+3A_maxiter">MAXITER</code></td>
<td>
<p>maximum number of iterations allowed in the Fisher-scoring algorithm, Default: <code>100</code></p>
</td></tr>
<tr><td><code id="eblupMFH1_+3A_precision">PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm, Default: <code>1e-4</code></p>
</td></tr>
<tr><td><code id="eblupMFH1_+3A_data">data</code></td>
<td>
<p>dataframe containing the variables named in <code>formula</code> and <code>vardir</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>eblup</dt><dd><p>a dataframe with the values of the EBLUP estimators</p>
</dd>
<dt>MSE</dt><dd><p>a dataframe with the estimated mean squared errors of the EBLUPs for the small domains</p>
</dd>
<dt>randomEffect</dt><dd><p>a dataframe with the values of the random effect estimators</p>
</dd>
<dt>Rmatrix</dt><dd><p>a block diagonal matrix composed of sampling errors</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> method : type of fitting method, named &quot;REML&quot;
</p>
</li>
<li><p> convergence : a logical value of convergence of Fisher Scoring algorithm
</p>
</li>
<li><p> iterations : number of iterations performed by Fisher-Scoring algorithm
</p>
</li>
<li><p> estcoef : a dataframe with the estimated model coefficient in the first column, their standard error in the second column, the t statistics in the third column, and the p-values of the significance of each coefficient in the last column
</p>
</li>
<li><p> refvar : a dataframe with the estimated random effect variance
</p>
</li>
<li><p> informationFisher : a matrix of information Fisher of Fisher-Scoring algorithm
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'>## Load dataset
data(datasae1)

# Compute EBLUP and MSE of Y1 Y2 and Y3  based on Model 1
# using auxiliary variables X1 and X2 for each dependent variable

## Using parameter 'data'
Fo &lt;- list(f1=Y1~X1+X2,
           f2=Y2~X1+X2,
           f3=Y3~X1+X2)
vardir &lt;- c("v1", "v2", "v3", "v12", "v13", "v23")
m1 &lt;- eblupMFH1(Fo, vardir, data=datasae1)

## Without parameter 'data'
Fo &lt;- list(f1=datasae1$Y1~datasae1$X1+datasae1$X2,
           f2=datasae1$Y2~datasae1$X1+datasae1$X2,
           f3=datasae1$Y3~datasae1$X1+datasae1$X2)
vardir &lt;- datasae1[,c("v1", "v2", "v3", "v12", "v13", "v23")]
m1 &lt;- eblupMFH1(Fo, vardir)

m1$eblup   # see the EBLUP estimators
m1$MSE   # see MSE of EBLUP estimators

</code></pre>

<hr>
<h2 id='eblupMFH2'>EBLUPs based on a Autoregressive Multivariate Fay Herriot (Model 2)</h2><span id='topic+eblupMFH2'></span>

<h3>Description</h3>

<p>This function gives the EBLUP and MSE based on a  autoregressive multivariate Fay-Herriot model (model 2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eblupMFH2(formula, vardir, MAXITER = 100, PRECISION = 1e-04, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eblupMFH2_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="eblupMFH2_+3A_vardir">vardir</code></td>
<td>
<p>if data is available, it is vector containing name of sampling variances of direct estimators. if not, it is data frame of sampling variances of direct estimators. The order is : <code>var1, var2, . , var(k) , cov12, . cov1k, cov23, . , cov(k-1)(k)</code></p>
</td></tr>
<tr><td><code id="eblupMFH2_+3A_maxiter">MAXITER</code></td>
<td>
<p>maximum number of iterations allowed in the Fisher-scoring algorithm, Default: <code>100</code></p>
</td></tr>
<tr><td><code id="eblupMFH2_+3A_precision">PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm, Default: <code>1e-4</code></p>
</td></tr>
<tr><td><code id="eblupMFH2_+3A_data">data</code></td>
<td>
<p>dataframe containing the variables named in <code>formula</code> and <code>vardir</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>eblup</dt><dd><p>a dataframe with the values of the EBLUP estimators</p>
</dd>
<dt>MSE</dt><dd><p>a dataframe with the estimated mean squared errors of the EBLUPs for the small domains</p>
</dd>
<dt>randomEffect</dt><dd><p>a dataframe with the values of the random effect estimators</p>
</dd>
<dt>Rmatrix</dt><dd><p>a block diagonal matrix composed of sampling errors</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> method : type of fitting method, named &quot;REML&quot;
</p>
</li>
<li><p> convergence : a logical value of convergence of Fisher Scoring algorithm
</p>
</li>
<li><p> iterations : number of iterations performed by Fisher-Scoring algorithm
</p>
</li>
<li><p> estcoef : a dataframe with the estimated model coefficient in the first column, their standard error in the second column, the t statistics in the third column, and the p-values of the significance of each coefficient in the last column
</p>
</li>
<li><p> refvar : a dataframe with the estimated random effect variance
</p>
</li>
<li><p> rho : a dataframe with the estimated rho of random effect variance and their rho parameter test based on Model 2
</p>
</li>
<li><p> informationFisher : a matrix of information Fisher of Fisher-Scoring algorithm
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'>## Load dataset
data(datasae2)

# Compute EBLUP and MSE of Y1 Y2 and Y3  based on Model 2
# using auxiliary variables X1 and X2 for each dependent variable

## Without parameter 'data'
Fo &lt;- list(f1=Y1~X1+X2,
           f2=Y2~X1+X2,
           f3=Y3~X1+X2)
vardir &lt;- c("v1", "v2", "v3", "v12", "v13", "v23")
m2 &lt;- eblupMFH2(Fo, vardir, data=datasae2)

## Without parameter 'data'
Fo &lt;- list(f1=datasae2$Y1~datasae2$X1+datasae2$X2,
           f2=datasae2$Y2~datasae2$X1+datasae2$X2,
           f3=datasae2$Y3~datasae2$X1+datasae2$X2)
vardir &lt;- datasae2[,c("v1", "v2", "v3", "v12", "v13", "v23")]
m2 &lt;- eblupMFH2(Fo, vardir)

m2$eblup   # see the EBLUP estimators
m2$MSE   # see MSE of EBLUP estimators

</code></pre>

<hr>
<h2 id='eblupMFH3'>EBLUPs based on a Heteroscedastic Autoregressive Multivariate Fay Herriot (Model 3)</h2><span id='topic+eblupMFH3'></span>

<h3>Description</h3>

<p>This function gives the EBLUP and MSE based on a heteroscedastic autoregressive multivariate Fay-Herriot model (model 3).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eblupMFH3(formula, vardir, MAXITER = 100, PRECISION = 1e-04, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eblupMFH3_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="eblupMFH3_+3A_vardir">vardir</code></td>
<td>
<p>if data is available, it is vector containing name of sampling variances of direct estimators. if not, it is data frame of sampling variances of direct estimators. The order is : <code>var1, var2, . , var(k) , cov12, . cov1k, cov23, . , cov(k-1)(k)</code></p>
</td></tr>
<tr><td><code id="eblupMFH3_+3A_maxiter">MAXITER</code></td>
<td>
<p>maximum number of iterations allowed in the Fisher-scoring algorithm, Default: <code>100</code></p>
</td></tr>
<tr><td><code id="eblupMFH3_+3A_precision">PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm, Default: <code>1e-4</code></p>
</td></tr>
<tr><td><code id="eblupMFH3_+3A_data">data</code></td>
<td>
<p>dataframe containing the variables named in <code>formula</code> and <code>vardir</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>eblup</dt><dd><p>a dataframe with the values of the EBLUP estimators</p>
</dd>
<dt>MSE</dt><dd><p>a dataframe with the estimated mean squared errors of the EBLUPs for the small domains</p>
</dd>
<dt>randomEffect</dt><dd><p>a dataframe with the values of the random effect estimators</p>
</dd>
<dt>Rmatrix</dt><dd><p>a block diagonal matrix composed of sampling errors</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> method : type of fitting method, named &quot;REML&quot;
</p>
</li>
<li><p> convergence : a logical value of convergence of Fisher Scoring algorithm
</p>
</li>
<li><p> iterations : number of iterations performed by Fisher-Scoring algorithm
</p>
</li>
<li><p> estcoef : a dataframe with the estimated model coefficient in the first column, their standard error in the second column, the t statistics in the third column, and the p-values of the significance of each coefficient in the last column
</p>
</li>
<li><p> refvar : a dataframe with the estimated random effect variance
</p>
</li>
<li><p> refvarTest : homogeneity of random effect variance test based on Model 3
</p>
</li>
<li><p> rho : a dataframe with the estimated rho of random effect variance and their rho parameter test based on Model 2
</p>
</li>
<li><p> informationFisher : a matrix of information Fisher of Fisher-Scoring algorithm
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'>## Load dataset
data(datasae3)

# Compute EBLUP and MSE of Y1 Y2 and Y3  based on Model 3
# using auxiliary variables X1 and X2 for each dependent variable

## Using parameter 'data'
Fo &lt;- list(f1=Y1~X1+X2,
           f2=Y2~X1+X2,
           f3=Y3~X1+X2)
vardir &lt;- c("v1", "v2", "v3", "v12", "v13", "v23")
m3 &lt;- eblupMFH3(Fo, vardir, data=datasae3)

## Without parameter 'data'
Fo &lt;- list(f1=datasae3$Y1~datasae3$X1+datasae3$X2,
           f2=datasae3$Y2~datasae3$X1+datasae3$X2,
           f3=datasae3$Y3~datasae3$X1+datasae3$X2)
vardir &lt;- datasae3[,c("v1", "v2", "v3", "v12", "v13", "v23")]
m3 &lt;- eblupMFH3(Fo, vardir)

m3$eblup   # see the EBLUP estimators
m3$MSE   # see MSE of EBLUP estimators

</code></pre>

<hr>
<h2 id='eblupUFH'>EBLUPs based on a Univariate Fay Herriot (Model 0)</h2><span id='topic+eblupUFH'></span>

<h3>Description</h3>

<p>This function gives the EBLUP and MSE based on a univariate Fay Herriot model (model 0)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eblupUFH(
  formula,
  vardir,
  samevar = FALSE,
  MAXITER = 100,
  PRECISION = 1e-04,
  data
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eblupUFH_+3A_formula">formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td></tr>
<tr><td><code id="eblupUFH_+3A_vardir">vardir</code></td>
<td>
<p>if data is available, it is vector containing name of sampling variances of direct estimators. if not, it is data frame of sampling variances of direct estimators. The order is : <code>var1, var2, . , var(k) , cov12, . cov1k, cov23, . , cov(k-1)(k)</code></p>
</td></tr>
<tr><td><code id="eblupUFH_+3A_samevar">samevar</code></td>
<td>
<p>logical input, true if variance of the data is same, Default: <code>FALSE</code></p>
</td></tr>
<tr><td><code id="eblupUFH_+3A_maxiter">MAXITER</code></td>
<td>
<p>maximum number of iterations allowed in the Fisher-scoring algorithm, Default: <code>100</code></p>
</td></tr>
<tr><td><code id="eblupUFH_+3A_precision">PRECISION</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm, Default: <code>1e-4</code></p>
</td></tr>
<tr><td><code id="eblupUFH_+3A_data">data</code></td>
<td>
<p>dataframe containing the variables named in <code>formula</code> and <code>vardir</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>eblup</dt><dd><p>a dataframe with the values of the EBLUP estimators</p>
</dd>
<dt>MSE</dt><dd><p>a dataframe with the estimated mean squared errors of the EBLUPs for the small domains</p>
</dd>
<dt>randomEffect</dt><dd><p>a dataframe with the values of the random effect estimators</p>
</dd>
<dt>Rmatrix</dt><dd><p>a block diagonal matrix composed of sampling errors</p>
</dd>
<dt>fit</dt><dd><p>a list containing the following objects:</p>
</dd>
</dl>

<ul>
<li><p> method : type of fitting method, named &quot;REML&quot;
</p>
</li>
<li><p> convergence : a logical value of convergence of Fisher Scoring algorithm
</p>
</li>
<li><p> iterations : number of iterations performed by Fisher-Scoring algorithm
</p>
</li>
<li><p> estcoef : a dataframe with the estimated model coefficient in the first column, their standard error in the second column, the t statistics in the third column, and the p-values of the significance of each coefficient in the last column
</p>
</li>
<li><p> refvar : a dataframe with the estimated random effect variance
</p>
</li>
<li><p> informationFisher : a matrix of information Fisher of Fisher-Scoring algorithm
</p>
</li></ul>




<h3>Examples</h3>

<pre><code class='language-R'>## Load dataset
data(datasae1)

# Compute EBLUP and MSE of Y1 Y2 and Y3  based on Model 0
# using auxiliary variables X1 and X2 for each dependent variable

## Using parameter 'data'
Fo &lt;- list(f1=Y1~X1+X2,
           f2=Y2~X1+X2,
           f3=Y3~X1+X2)
vardir &lt;- c("v1", "v2", "v3", "v12", "v13", "v23")
un &lt;- eblupUFH(Fo, vardir, data=datasae1)

## Without parameter 'data'
Fo &lt;- list(f1=datasae1$Y1~datasae1$X1+datasae1$X2,
           f2=datasae1$Y2~datasae1$X1+datasae1$X2,
           f3=datasae1$Y3~datasae1$X1+datasae1$X2)
vardir &lt;- datasae1[,c("v1", "v2", "v3", "v12", "v13", "v23")]
un &lt;- eblupUFH(Fo, vardir)

un$eblup   # see the EBLUP estimators
un$MSE   # see MSE of EBLUP estimators

</code></pre>

<hr>
<h2 id='msae'>msae : Multivariate Fay Herriot Models for Small Area Estimation</h2><span id='topic+msae'></span>

<h3>Description</h3>

<p>Implements multivariate Fay-Herriot models for small area estimation. It uses empirical best linear unbiased prediction (EBLUP) estimator. Multivariate models consider the correlation of several target variable and borrow strength from auxiliary variables to improve the effectiveness of a domain sample size. Models which accommodated by this package are univariate model with several target variables (model 0), multivariate model (model 1), autoregressive multivariate model (model 2), and heteroscedastic autoregressive multivariate model (model 3). Functions provide EBLUP estimators and mean squared error (MSE) estimator for each model. These models were developed by Roberto Benavent and Domingo Morales (2015) &lt;doi:10.1016/j.csda.2015.07.013&gt;.
</p>


<h3>Author(s)</h3>

<p>Novia Permatasari, Azka Ubaidillah
</p>
<p><strong>Maintainer</strong>: Novia Permatasari <a href="mailto:16.9335@stis.ac.id">16.9335@stis.ac.id</a>
</p>


<h3>Functions</h3>


<dl>
<dt><code><a href="#topic+eblupUFH">eblupUFH</a></code></dt><dd><p>Gives the EBLUPs and MSE of Univariate SAE (Model 0)</p>
</dd>
<dt><code><a href="#topic+eblupMFH1">eblupMFH1</a></code></dt><dd><p>Gives the EBLUPs and MSE of Multivariate SAE (Model 1)</p>
</dd>
<dt><code><a href="#topic+eblupMFH2">eblupMFH2</a></code></dt><dd><p>Gives the EBLUPs and MSE of Autoregressive Multivariate SAE (Model 2)</p>
</dd>
<dt><code><a href="#topic+eblupMFH3">eblupMFH3</a></code></dt><dd><p>Gives the EBLUPs and MSE of Heteroscedastics Autoregressive Multivariate SAE (Model 3)</p>
</dd>
</dl>



<h3>Reference</h3>


<ul>
<li><p>Benavent, Roberto &amp; Morales, Domingo. (2015). Multivariate Fay-Herriot models for small area estimation. Computational Statistics &amp; Data Analysis. 100. 372-390. DOI: 10.1016/j.csda.2015.07.013.
</p>
</li>
<li><p>Rao, J.N.K &amp; Molina. (2015). Small Area Estimation 2nd Edition. New York: John Wiley and Sons, Inc.
</p>
</li>
<li><p>Ubaidillah, Azka et al. (2019). Multivariate Fay-Herriot models for small area estimation with application to household consumption per capita expenditure in Indonesia. Journal of Applied Statistics. 46:15. 2845-2861. DOI: 10.1080/02664763.2019.1615420.
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
