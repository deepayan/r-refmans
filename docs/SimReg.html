<!DOCTYPE html><html><head><title>Help for package SimReg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SimReg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SimReg-package'>
<p>Similarity Regression Functions</p></a></li>
<li><a href='#get_term_marginals'><p>Calculate marginal probability of terms inclusion in <code>phi</code> from <code>sim_reg_out</code> object</p></a></li>
<li><a href='#get_terms'><p>Get full set of terms to use in inference procedure based on similarity function arguments</p></a></li>
<li><a href='#log_BF'><p>Calculate log Bayes factor for similarity the model, <code>gamma=1</code> and baseline model, <code>gamma=0</code>.</p></a></li>
<li><a href='#plot_term_marginals'><p>Create ontological plot of marginal probabilities of terms</p></a></li>
<li><a href='#plot.sim_reg_summary'><p>Plot summary of <code>sim_reg_output</code> object</p></a></li>
<li><a href='#posterior_prediction'><p>Predicted probability of <code>y</code> given <code>x</code> conditional on association and given data.</p></a></li>
<li><a href='#print.sim_reg_output'><p>Print <code>sim_reg_output</code> object</p></a></li>
<li><a href='#print.sim_reg_summary'><p>Print <code>sim_reg_summary</code> object</p></a></li>
<li><a href='#prob_association'><p>Calculate probability of association between <code>y</code> and <code>x</code></p></a></li>
<li><a href='#sim_reg'><p>Similarity regression</p></a></li>
<li><a href='#sum_log_probs'><p>Calculate sum of log probabilities on log scale without over/under-flow</p></a></li>
<li><a href='#summary.sim_reg_output'><p>Get summary of <code>sim_reg_output</code> object</p></a></li>
<li><a href='#term_marginals'><p>Calculate marginal probability of terms inclusion in <code>phi</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Similarity Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>3.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-20</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Greene</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Greene &lt;dg333@cam.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Similarity regression,
    evaluating the probability of association between sets of ontological terms
    and binary response vector. A no-association model is compared with one in which
    the log odds of a true response is linked to the semantic similarity
    between terms and a latent characteristic ontological profile - 'Phenotype Similarity Regression for Identifying the Genetic Determinants of Rare Diseases', Greene et al 2016 &lt;<a href="https://doi.org/10.1016%2Fj.ajhg.2016.01.008">doi:10.1016/j.ajhg.2016.01.008</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.1), ontologyIndex (&ge; 2.0), ontologySimilarity
(&ge; 2.0), ontologyPlot</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-21 03:30:03 UTC; dg</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-21 04:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='SimReg-package'>
Similarity Regression Functions
</h2><span id='topic+SimReg-package'></span><span id='topic+SimReg'></span>

<h3>Description</h3>

<p>Functions for performing Bayesian similarity regression,
and evaluating the probability of association between sets of ontological terms
and binary response vector. A random model is compared with one in which
the log odds of a true response is linked to the semantic similarity
between terms and a latent characteristic ontological profile.
</p>


<h3>Details</h3>

<p>Key functions include sim_reg, for similarity regression of binary response variable against an ontologically encoded predictor. An example application would be inferring the probability of association between the presence of a rare genetic variant conditional on an ontologically encoded phenotype.
</p>


<h3>Author(s)</h3>

<p>Daniel Greene &lt;dg333@cam.ac.uk&gt;
</p>
<p>Maintainer: Daniel Greene &lt;dg333@cam.ac.uk&gt;
</p>


<h3>References</h3>

<p>D. Greene, NIHR BioResource, S. Richardson, E. Turro, &lsquo;Phenotype similarity regression for identifying the genetic determinants of rare diseases&rsquo;, The American Journal of Human Genetics 98, 1-10, March 3, 2016.
</p>

<hr>
<h2 id='get_term_marginals'>Calculate marginal probability of terms inclusion in <code>phi</code> from <code>sim_reg_out</code> object</h2><span id='topic+get_term_marginals'></span>

<h3>Description</h3>

<p>Calculate marginal probability of terms inclusion in <code>phi</code> from <code>sim_reg_out</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_term_marginals(sim_reg_out)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_term_marginals_+3A_sim_reg_out">sim_reg_out</code></td>
<td>
<p>Object of class <code>sim_reg_output</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of probabilities, named by term ID.
</p>

<hr>
<h2 id='get_terms'>Get full set of terms to use in inference procedure based on similarity function arguments</h2><span id='topic+get_terms'></span>

<h3>Description</h3>

<p>Get full set of terms to use in inference procedure based on similarity function arguments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_terms(args)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_terms_+3A_args">args</code></td>
<td>
<p>Named list of named arguments which gets passed to ontological similarity function by <code>sim_reg</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of term IDs.
</p>

<hr>
<h2 id='log_BF'>Calculate log Bayes factor for similarity the model, <code>gamma=1</code> and baseline model, <code>gamma=0</code>.</h2><span id='topic+log_BF'></span><span id='topic+log_BF.default'></span><span id='topic+log_BF.sim_reg_output'></span>

<h3>Description</h3>

<p>Calculate log Bayes factor for similarity the model, <code>gamma=1</code> and baseline model, <code>gamma=0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_BF(x, ...)

## Default S3 method:
log_BF(x, ...)

## S3 method for class 'sim_reg_output'
log_BF(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_BF_+3A_x">x</code></td>
<td>
<p><code>list</code> of term sets or <code>sim_reg_output</code> object.</p>
</td></tr>
<tr><td><code id="log_BF_+3A_...">...</code></td>
<td>
<p>If x is a <code>list</code> term sets, other arguments to pass to <code><a href="#topic+sim_reg">sim_reg</a></code>, otherwise this is not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value.
</p>

<hr>
<h2 id='plot_term_marginals'>Create ontological plot of marginal probabilities of terms</h2><span id='topic+plot_term_marginals'></span>

<h3>Description</h3>

<p>Create ontological plot of marginal probabilities of terms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_term_marginals(
  ontology,
  term_marginals,
  max_terms = 10,
  min_probability = 0.01,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_term_marginals_+3A_ontology">ontology</code></td>
<td>
<p><code>ontology_index</code> object.</p>
</td></tr>
<tr><td><code id="plot_term_marginals_+3A_term_marginals">term_marginals</code></td>
<td>
<p>Numeric vector of marginal probabilities of inclusion in <code>phi</code> for individual terms, named by the term IDs.</p>
</td></tr>
<tr><td><code id="plot_term_marginals_+3A_max_terms">max_terms</code></td>
<td>
<p>Maximum number of terms to include in plot. Note that additional terms may be included when terms have the same marginal probability, and common ancestor terms are included.</p>
</td></tr>
<tr><td><code id="plot_term_marginals_+3A_min_probability">min_probability</code></td>
<td>
<p>Threshold probability of inclusion in <code>phi</code> for triggering inclusion in plot.</p>
</td></tr>
<tr><td><code id="plot_term_marginals_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code>onto_plot</code></p>
</td></tr>
</table>

<hr>
<h2 id='plot.sim_reg_summary'>Plot summary of <code>sim_reg_output</code> object</h2><span id='topic+plot.sim_reg_summary'></span><span id='topic+plot.sim_reg_output'></span>

<h3>Description</h3>

<p>Plot summary of <code>sim_reg_output</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sim_reg_summary'
plot(x, ...)

## S3 method for class 'sim_reg_output'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.sim_reg_summary_+3A_x">x</code></td>
<td>
<p>Object of class <code>sim_reg_summary</code>.</p>
</td></tr>
<tr><td><code id="plot.sim_reg_summary_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code><a href="#topic+plot_term_marginals">plot_term_marginals</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='posterior_prediction'>Predicted probability of <code>y</code> given <code>x</code> conditional on association and given data.</h2><span id='topic+posterior_prediction'></span>

<h3>Description</h3>

<p>Predicted probability of <code>y</code> given <code>x</code> conditional on association and given data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_prediction(
  ontology,
  x,
  y,
  sim_reg_out,
  x_new = x,
  information_content = get_term_info_content(ontology, x),
  sim_params = list(ontology = ontology, information_content = information_content),
  two_way = TRUE,
  prediction_fn = NULL,
  min_ratio = 0.001,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posterior_prediction_+3A_ontology">ontology</code></td>
<td>
<p><code>ontology_index</code> object.</p>
</td></tr>
<tr><td><code id="posterior_prediction_+3A_x">x</code></td>
<td>
<p><code>list</code> of <code>character</code> vectors of ontological terms.</p>
</td></tr>
<tr><td><code id="posterior_prediction_+3A_y">y</code></td>
<td>
<p><code>logical</code> response vector.</p>
</td></tr>
<tr><td><code id="posterior_prediction_+3A_sim_reg_out">sim_reg_out</code></td>
<td>
<p>Object of class <code>sim_reg_output</code>.</p>
</td></tr>
<tr><td><code id="posterior_prediction_+3A_x_new">x_new</code></td>
<td>
<p>New <code>list</code> of ontological term sets to perform prediction on. Defaults to <code>x</code>.</p>
</td></tr>
<tr><td><code id="posterior_prediction_+3A_information_content">information_content</code></td>
<td>
<p>Numeric vector of information contents of terms named by term ID. Defaults to information content based on frequencies of annotation in <code>x</code>.</p>
</td></tr>
<tr><td><code id="posterior_prediction_+3A_sim_params">sim_params</code></td>
<td>
<p>List of arguments to pass to <code>get_asym_sim_grid</code>.</p>
</td></tr>
<tr><td><code id="posterior_prediction_+3A_two_way">two_way</code></td>
<td>
<p>Boolean value determining whether to calculate semantic similarity &lsquo;in both directions&rsquo; (i.e. compute <code>s_x</code> and <code>s_phi</code> or just <code>s_phi</code>).</p>
</td></tr>
<tr><td><code id="posterior_prediction_+3A_prediction_fn">prediction_fn</code></td>
<td>
<p>Function for computing predicted probabilities for <code>y[i]=TRUE</code>.</p>
</td></tr>
<tr><td><code id="posterior_prediction_+3A_min_ratio">min_ratio</code></td>
<td>
<p>Threshold for fraction of posterior probability which sampled phi must hold in order to be included in sum.</p>
</td></tr>
<tr><td><code id="posterior_prediction_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code>prediction_fn</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of predicted probabilities corresponding to term sets in <code>x_new</code>.
</p>

<hr>
<h2 id='print.sim_reg_output'>Print <code>sim_reg_output</code> object</h2><span id='topic+print.sim_reg_output'></span>

<h3>Description</h3>

<p>Print <code>sim_reg_output</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sim_reg_output'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.sim_reg_output_+3A_x">x</code></td>
<td>
<p>Object of class <code>sim_reg_output</code>.</p>
</td></tr>
<tr><td><code id="print.sim_reg_output_+3A_...">...</code></td>
<td>
<p>Non-used arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.sim_reg_summary'>Print <code>sim_reg_summary</code> object</h2><span id='topic+print.sim_reg_summary'></span>

<h3>Description</h3>

<p>Print <code>sim_reg_summary</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sim_reg_summary'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.sim_reg_summary_+3A_x">x</code></td>
<td>
<p>Object of class <code>sim_reg_summary</code>.</p>
</td></tr>
<tr><td><code id="print.sim_reg_summary_+3A_...">...</code></td>
<td>
<p>Non-used arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='prob_association'>Calculate probability of association between <code>y</code> and <code>x</code></h2><span id='topic+prob_association'></span>

<h3>Description</h3>

<p>Calculate probability of association between <code>y</code> and <code>x</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob_association(..., prior = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prob_association_+3A_...">...</code></td>
<td>
<p>Arguments to pass to <code><a href="#topic+log_BF">log_BF</a></code>.</p>
</td></tr>
<tr><td><code id="prob_association_+3A_prior">prior</code></td>
<td>
<p>Numeric value determing prior probability that <code>gamma=1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value.
</p>

<hr>
<h2 id='sim_reg'>Similarity regression</h2><span id='topic+sim_reg'></span>

<h3>Description</h3>

<p>Performs Bayesian &lsquo;similarity regression&rsquo; on given <code>logical</code> response vector <code>y</code> against <code>list</code> of ontological term sets <code>x</code>. It returns an object of class <code>sim_reg_output</code>. Of particular interest are the probability of an association, which can be calculated with <code><a href="#topic+prob_association">prob_association</a></code>, and the characteristic ontological profile phi, which can be visualised using the functions <code><a href="#topic+plot_term_marginals">plot_term_marginals</a></code>, and <code><a href="#topic+term_marginals">term_marginals</a></code>). The results can be summarised with <code>summary</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_reg(
  ontology,
  x,
  y,
  information_content = get_term_info_content(ontology, x),
  sim_params = list(ontology = ontology, information_content = information_content),
  using_terms = get_terms(sim_params),
  term_weights = rep(0, length(using_terms)),
  prior = discrete_gamma(using_terms),
  min_BF = -Inf,
  max_select = 2000L,
  max_phi_count = 200L,
  two_way = TRUE,
  selection_fn = fg_step_tab(N = length(y)),
  lik_method = NULL,
  lik_method_args = list(),
  gamma0_ml = bg_rate,
  min_ratio = 1e-04,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_reg_+3A_ontology">ontology</code></td>
<td>
<p><code>ontology_index</code> object.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_x">x</code></td>
<td>
<p><code>list</code> of <code>character</code> vectors of ontological terms.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_y">y</code></td>
<td>
<p><code>logical</code> response vector.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_information_content">information_content</code></td>
<td>
<p>Numeric vector of information contents of terms named by term ID. Defaults to information content based on frequencies of annotation in <code>x</code>.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_sim_params">sim_params</code></td>
<td>
<p>List of arguments to pass to <code>get_asym_sim_grid</code>.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_using_terms">using_terms</code></td>
<td>
<p>Character vector of term IDs giving the complete set of terms to include in the the <code>phi</code> parameter space.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_term_weights">term_weights</code></td>
<td>
<p>Numeric vector of prior weights for individual terms.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_prior">prior</code></td>
<td>
<p>Function for computing the unweighted prior probability of a <code>phi</code> value.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_min_bf">min_BF</code></td>
<td>
<p>Bayes factor threshold below which to terminate computation, enabling faster execution time at the expense of accuracy and precision.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_max_select">max_select</code></td>
<td>
<p>Upper bound for number of <code>phi</code> values to sample.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_max_phi_count">max_phi_count</code></td>
<td>
<p>Upper bound for number of <code>phi</code> values to include in final likelihood sum.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_two_way">two_way</code></td>
<td>
<p>Boolean value determining whether to calculate semantic similarity &lsquo;in both directions&rsquo; (i.e. compute <code>s_x</code> and <code>s_phi</code> or just <code>s_phi</code>).</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_selection_fn">selection_fn</code></td>
<td>
<p>Function for selecting values of <code>phi</code> with high posterior mass.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_lik_method">lik_method</code></td>
<td>
<p>Function for calculating marginal likelihood contional on values of <code>phi</code>.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_lik_method_args">lik_method_args</code></td>
<td>
<p>List of additional arguments to pass to <code>lik_method</code>.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_gamma0_ml">gamma0_ml</code></td>
<td>
<p>Function for computing marginal likelihood of data under baseline model <code>gamma=0</code>.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_min_ratio">min_ratio</code></td>
<td>
<p>Lower bound on ratio below which to discard <code>phi</code> values.</p>
</td></tr>
<tr><td><code id="sim_reg_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code>selection_fn</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='sum_log_probs'>Calculate sum of log probabilities on log scale without over/under-flow</h2><span id='topic+sum_log_probs'></span>

<h3>Description</h3>

<p>Calculate sum of log probabilities on log scale without over/under-flow
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_log_probs(log_probs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sum_log_probs_+3A_log_probs">log_probs</code></td>
<td>
<p>Numeric vector of probabilities on log scale.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value on log scale.
</p>

<hr>
<h2 id='summary.sim_reg_output'>Get summary of <code>sim_reg_output</code> object</h2><span id='topic+summary.sim_reg_output'></span>

<h3>Description</h3>

<p>Get summary of <code>sim_reg_output</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sim_reg_output'
summary(object, prior = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.sim_reg_output_+3A_object">object</code></td>
<td>
<p>Object of class <code>sim_reg_output</code>.</p>
</td></tr>
<tr><td><code id="summary.sim_reg_output_+3A_prior">prior</code></td>
<td>
<p>Prior probability of association.</p>
</td></tr>
<tr><td><code id="summary.sim_reg_output_+3A_...">...</code></td>
<td>
<p>Non-used arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='term_marginals'>Calculate marginal probability of terms inclusion in <code>phi</code></h2><span id='topic+term_marginals'></span>

<h3>Description</h3>

<p>Calculate marginal probability of terms inclusion in <code>phi</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>term_marginals(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="term_marginals_+3A_...">...</code></td>
<td>
<p>Arguments to pass to <code><a href="#topic+sim_reg">sim_reg</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of probabilities, named by term ID.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
