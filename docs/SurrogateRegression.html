<!DOCTYPE html><html><head><title>Help for package SurrogateRegression</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SurrogateRegression}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SurrogateRegression'><p>SurrogateRegression: Surrogate Outcome Regression Analysis</p></a></li>
<li><a href='#bnr-class'><p>Bivariate Regression Model</p></a></li>
<li><a href='#CheckInit'><p>Check Initiation</p></a></li>
<li><a href='#CheckTestSpec'><p>Check Test Specification</p></a></li>
<li><a href='#coef.bnr'><p>Extract Coefficients from Bivariate Regression Model</p></a></li>
<li><a href='#CovInfo'><p>Covariance Information Matrix</p></a></li>
<li><a href='#CovTab'><p>Tabulate Covariance Parameters</p></a></li>
<li><a href='#CovUpdate'><p>Covariate Update</p></a></li>
<li><a href='#FitBNEM'><p>Fit Bivariate Normal Regression Model via Expectation Maximization.</p></a></li>
<li><a href='#FitBNLS'><p>Fit Bivariate Normal Regression Model via Least Squares</p></a></li>
<li><a href='#FitBNR'><p>Fit Bivariate Normal Regression Model</p></a></li>
<li><a href='#fitOLS'><p>Ordinary Least Squares</p></a></li>
<li><a href='#FormatOutput'><p>Format Output</p></a></li>
<li><a href='#IterUpdate'><p>Update Iteration</p></a></li>
<li><a href='#matDet'><p>Matrix Determinant</p></a></li>
<li><a href='#matInv'><p>Matrix Inverse</p></a></li>
<li><a href='#matIP'><p>Matrix Inner Product</p></a></li>
<li><a href='#matOP'><p>Matrix Outer Product</p></a></li>
<li><a href='#matQF'><p>Quadratic Form</p></a></li>
<li><a href='#MMP'><p>Matrix Matrix Product</p></a></li>
<li><a href='#ObsLogLik'><p>Observed Data Log Likelihood</p></a></li>
<li><a href='#ParamInit'><p>Parameter Initialization</p></a></li>
<li><a href='#PartitionData'><p>Partition Data by Outcome Missingness Pattern.</p></a></li>
<li><a href='#print.bnr'><p>Print for Bivariate Regression Model</p></a></li>
<li><a href='#rBNR'><p>Simulate Bivariate Normal Data with Missingness</p></a></li>
<li><a href='#RegInfo'><p>Regression Information</p></a></li>
<li><a href='#RegTab'><p>Tabulate Regression Coefficients</p></a></li>
<li><a href='#RegUpdate'><p>Regression Update</p></a></li>
<li><a href='#residuals.bnr'><p>Extract Residuals from Bivariate Regression Model</p></a></li>
<li><a href='#SchurC'><p>Schur complement</p></a></li>
<li><a href='#ScoreBNEM'><p>Score Test via Expectation Maximization.</p></a></li>
<li><a href='#show,bnr-method'><p>Show for Bivariate Regression Model</p></a></li>
<li><a href='#TestBNR'><p>Test Bivariate Normal Regression Model.</p></a></li>
<li><a href='#tr'><p>Matrix Trace</p></a></li>
<li><a href='#UpdateEM'><p>EM Update</p></a></li>
<li><a href='#vcov.bnr'><p>Extract Covariance Matrix from Bivariate Normal Regression Model</p></a></li>
<li><a href='#WaldBNEM'><p>Wald Test via Expectation Maximization.</p></a></li>
<li><a href='#WaldBNLS'><p>Wald Test via Least Squares.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Surrogate Outcome Regression Analysis</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-01</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs estimation and inference on a partially missing target outcome (e.g. gene expression in an inaccessible tissue) while borrowing information from a correlated surrogate outcome (e.g. gene expression in an accessible tissue). Rather than regarding the surrogate outcome as a proxy for the target outcome, this package jointly models the target and surrogate outcomes within a bivariate regression framework. Unobserved values of either outcome are treated as missing data. In contrast to imputation-based inference, no assumptions are required regarding the relationship between the target and surrogate outcomes. Estimation in the presence of bilateral outcome missingness is performed via an expectation conditional maximization either algorithm. In the case of unilateral target missingness, estimation is performed using an accelerated least squares procedure. A flexible association test is provided for evaluating hypotheses about the target regression parameters. For additional details, see: McCaw ZR, Gaynor SM, Sun R, Lin X: "Leveraging a surrogate outcome to improve inference on a partially missing target outcome" &lt;<a href="https://doi.org/10.1111%2Fbiom.13629">doi:10.1111/biom.13629</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp, stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, rmarkdown, withr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-01 15:30:30 UTC; zmccaw</td>
</tr>
<tr>
<td>Author:</td>
<td>Zachary McCaw <a href="https://orcid.org/0000-0002-2006-9828"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zachary McCaw &lt;zmccaw@alumni.harvard.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-01 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='SurrogateRegression'>SurrogateRegression: Surrogate Outcome Regression Analysis</h2><span id='topic+SurrogateRegression'></span><span id='topic+SurrogateRegression-package'></span>

<h3>Description</h3>

<p>This package performs estimation and inference on a partially missing target
outcome while borrowing information from a correlated surrogate outcome.
Rather than regarding the surrogate outcome as a proxy for the target
outcome, this package jointly models the target and surrogate outcomes within
a bivariate regression framework. Unobserved values of either outcome are
treated as missing data. In contrast to imputation-based inference, no
assumptions are required regarding the relationship between the target and
surrogate outcomes. However, in order for surrogate inference to improve
power, the target and surrogate outcomes must be correlated, and the target
outcome must be partially missing. The primary estimation function is
<code><a href="#topic+FitBNR">FitBNR</a></code>. In the case of bilateral missingness, i.e. missingness
in both the target and surrogate outcomes, estimation is performed via an
expectation conditional maximization either (ECME) algorithm. In the case of
unilateral target missingness, estimation is performed using an accelerated
least squares procedure. Inference on regression parameters for the target
outcome is performed using <code><a href="#topic+TestBNR">TestBNR</a></code>.
</p>


<h3>Author(s)</h3>

<p>Zachary R. McCaw
</p>

<hr>
<h2 id='bnr-class'>Bivariate Regression Model</h2><span id='topic+bnr-class'></span>

<h3>Description</h3>

<p>Bivariate Regression Model
</p>


<h3>Slots</h3>


<dl>
<dt><code>Covariance</code></dt><dd><p>Residual covariance matrix.</p>
</dd>
<dt><code>Covariance.info</code></dt><dd><p>Information for covariance parameters.</p>
</dd>
<dt><code>Covariance.tab</code></dt><dd><p>Table of covariance parameters.</p>
</dd>
<dt><code>Method</code></dt><dd><p>Method used for estimation.</p>
</dd>
<dt><code>Regression.info</code></dt><dd><p>Information for regression coefficients.</p>
</dd>
<dt><code>Regression.tab</code></dt><dd><p>Table of regression coefficients.</p>
</dd>
<dt><code>Residuals</code></dt><dd><p>Outcome residuals.</p>
</dd>
</dl>

<hr>
<h2 id='CheckInit'>Check Initiation</h2><span id='topic+CheckInit'></span>

<h3>Description</h3>

<p>Check Initiation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CheckInit(init)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CheckInit_+3A_init">init</code></td>
<td>
<p>Optional list of initial parameters for fitting the null model.</p>
</td></tr>
</table>

<hr>
<h2 id='CheckTestSpec'>Check Test Specification</h2><span id='topic+CheckTestSpec'></span>

<h3>Description</h3>

<p>Check Test Specification
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CheckTestSpec(is_zero, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CheckTestSpec_+3A_is_zero">is_zero</code></td>
<td>
<p>Logical vector, with as many entires as columns in the target model
matrix, indicating which columns have coefficient zero under the null.</p>
</td></tr>
<tr><td><code id="CheckTestSpec_+3A_p">p</code></td>
<td>
<p>Number of columns for the target model matrix.</p>
</td></tr>
</table>

<hr>
<h2 id='coef.bnr'>Extract Coefficients from Bivariate Regression Model</h2><span id='topic+coef.bnr'></span>

<h3>Description</h3>

<p>Extract Coefficients from Bivariate Regression Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bnr'
coef(object, ..., type = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.bnr_+3A_object">object</code></td>
<td>
<p><code>bnr</code> object.</p>
</td></tr>
<tr><td><code id="coef.bnr_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="coef.bnr_+3A_type">type</code></td>
<td>
<p>Either Target or Surrogate.</p>
</td></tr>
</table>

<hr>
<h2 id='CovInfo'>Covariance Information Matrix</h2><span id='topic+CovInfo'></span>

<h3>Description</h3>

<p>Covariance Information Matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CovInfo(data_part, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CovInfo_+3A_data_part">data_part</code></td>
<td>
<p>List of partitioned data. See <code><a href="#topic+PartitionData">PartitionData</a></code>.</p>
</td></tr>
<tr><td><code id="CovInfo_+3A_sigma">sigma</code></td>
<td>
<p>Target-surrogate covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>3x3 Numeric information matrix for the target variance,
target-surrogate covariance, and surrogate variance.
</p>

<hr>
<h2 id='CovTab'>Tabulate Covariance Parameters</h2><span id='topic+CovTab'></span>

<h3>Description</h3>

<p>Tabulate Covariance Parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CovTab(point, info, sig = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CovTab_+3A_point">point</code></td>
<td>
<p>Point estimates.</p>
</td></tr>
<tr><td><code id="CovTab_+3A_info">info</code></td>
<td>
<p>Information matrix.</p>
</td></tr>
<tr><td><code id="CovTab_+3A_sig">sig</code></td>
<td>
<p>Significance level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data.table containing the point estimate, standard error, and
confidence interval.
</p>

<hr>
<h2 id='CovUpdate'>Covariate Update</h2><span id='topic+CovUpdate'></span>

<h3>Description</h3>

<p>Covariate Update
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CovUpdate(data_part, b0, a0, b1, a1, sigma0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CovUpdate_+3A_data_part">data_part</code></td>
<td>
<p>List of partitioned data. See <code><a href="#topic+PartitionData">PartitionData</a></code>.</p>
</td></tr>
<tr><td><code id="CovUpdate_+3A_b0">b0</code></td>
<td>
<p>Previous target regression coefficient.</p>
</td></tr>
<tr><td><code id="CovUpdate_+3A_a0">a0</code></td>
<td>
<p>Previous surrogate regression coefficient.</p>
</td></tr>
<tr><td><code id="CovUpdate_+3A_b1">b1</code></td>
<td>
<p>Current target regression coefficient.</p>
</td></tr>
<tr><td><code id="CovUpdate_+3A_a1">a1</code></td>
<td>
<p>Current surrogate regression coefficient.</p>
</td></tr>
<tr><td><code id="CovUpdate_+3A_sigma0">sigma0</code></td>
<td>
<p>Initial target-surrogate covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ECM update of the target-surrogate covariance matrix.
</p>

<hr>
<h2 id='FitBNEM'>Fit Bivariate Normal Regression Model via Expectation Maximization.</h2><span id='topic+FitBNEM'></span>

<h3>Description</h3>

<p>Estimation procedure for bivariate normal regression models in which
the target and surrogate outcomes are both subject to missingness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitBNEM(
  t,
  s,
  X,
  Z,
  sig = 0.05,
  b0 = NULL,
  a0 = NULL,
  sigma0 = NULL,
  maxit = 100,
  eps = 1e-06,
  report = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitBNEM_+3A_t">t</code></td>
<td>
<p>Target outcome vector.</p>
</td></tr>
<tr><td><code id="FitBNEM_+3A_s">s</code></td>
<td>
<p>Surrogate outcome vector.</p>
</td></tr>
<tr><td><code id="FitBNEM_+3A_x">X</code></td>
<td>
<p>Target model matrix.</p>
</td></tr>
<tr><td><code id="FitBNEM_+3A_z">Z</code></td>
<td>
<p>Surrogate model matrix.</p>
</td></tr>
<tr><td><code id="FitBNEM_+3A_sig">sig</code></td>
<td>
<p>Type I error level.</p>
</td></tr>
<tr><td><code id="FitBNEM_+3A_b0">b0</code></td>
<td>
<p>Initial target regression coefficient.</p>
</td></tr>
<tr><td><code id="FitBNEM_+3A_a0">a0</code></td>
<td>
<p>Initial surrogate regression coefficient.</p>
</td></tr>
<tr><td><code id="FitBNEM_+3A_sigma0">sigma0</code></td>
<td>
<p>Initial covariance matrix.</p>
</td></tr>
<tr><td><code id="FitBNEM_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of parameter updates.</p>
</td></tr>
<tr><td><code id="FitBNEM_+3A_eps">eps</code></td>
<td>
<p>Minimum acceptable improvement in log likelihood.</p>
</td></tr>
<tr><td><code id="FitBNEM_+3A_report">report</code></td>
<td>
<p>Report fitting progress?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The target and surrogate model matrices are expected in numeric format.
Include an intercept if required. Expand factors and interactions in advance.
Initial values may be specified for any of the target coefficient
<code>b0</code>, the surrogate coefficient <code>a0</code>, or the target-surrogate
covariance matrix <code>sigma0</code>.
</p>


<h3>Value</h3>

<p>An object of class 'bnr' with slots containing the estimated
regression coefficients, the target-surrogate covariance matrix, the
information matrices for the regression and covariance parameters, and the
residuals.
</p>

<hr>
<h2 id='FitBNLS'>Fit Bivariate Normal Regression Model via Least Squares</h2><span id='topic+FitBNLS'></span>

<h3>Description</h3>

<p>Estimation procedure for bivariate normal regression models in which
only the target outcome is subject to missingness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitBNLS(t, s, X, sig = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitBNLS_+3A_t">t</code></td>
<td>
<p>Target outcome vector.</p>
</td></tr>
<tr><td><code id="FitBNLS_+3A_s">s</code></td>
<td>
<p>Surrogate outcome vector.</p>
</td></tr>
<tr><td><code id="FitBNLS_+3A_x">X</code></td>
<td>
<p>Model matrix.</p>
</td></tr>
<tr><td><code id="FitBNLS_+3A_sig">sig</code></td>
<td>
<p>Type I error level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model matrix is expected in numeric format. Include an intercept if
required. Expand factors and interactions in advance.
</p>


<h3>Value</h3>

<p>An object of class 'bnr' with slots containing the estimated
regression coefficients, the target-surrogate covariance matrix, the
information matrices for the regression and covariance parameters, and the
residuals.
</p>

<hr>
<h2 id='FitBNR'>Fit Bivariate Normal Regression Model</h2><span id='topic+FitBNR'></span>

<h3>Description</h3>

<p>Estimation procedure for bivariate normal regression models. The EM algorithm
is applied if <code>s</code> contains missing values, or if <code>X</code> differs from
<code>Z</code>. Otherwise, an accelerated least squares procedure is applied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitBNR(t, s, X, Z = NULL, sig = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitBNR_+3A_t">t</code></td>
<td>
<p>Target outcome vector.</p>
</td></tr>
<tr><td><code id="FitBNR_+3A_s">s</code></td>
<td>
<p>Surrogate outcome vector.</p>
</td></tr>
<tr><td><code id="FitBNR_+3A_x">X</code></td>
<td>
<p>Target model matrix.</p>
</td></tr>
<tr><td><code id="FitBNR_+3A_z">Z</code></td>
<td>
<p>Surrogate model matrix. Defaults to <code>X</code>.</p>
</td></tr>
<tr><td><code id="FitBNR_+3A_sig">sig</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="FitBNR_+3A_...">...</code></td>
<td>
<p>Additional arguments accepted if fitting via EM. See
<code><a href="#topic+FitBNEM">FitBNEM</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The target and surrogate model matrices are expected in numeric format.
Include an intercept if required. Expand factors and interactions in advance.
</p>


<h3>Value</h3>

<p>An object of class 'mnr' with slots containing the estimated regression
coefficients, the target-surrogate covariance matrix, the information matrices
for regression parameters, and the residuals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Case 1: No surrogate missingness.
set.seed(100)
n &lt;- 1e3
X &lt;- stats::rnorm(n)
data &lt;- rBNR(
  X = X,
  Z = X,
  b = 1,
  a = -1,
  t_miss = 0.1,
  s_miss = 0.0
)
t &lt;- data[, 1]
s &lt;- data[, 2]

# Model fit.
fit_bnls &lt;- FitBNR(
  t = t,
  s = s,
  X = X
)

# Case 2: Target and surrogate missingness.
set.seed(100)
n &lt;- 1e3
X &lt;- stats::rnorm(n)
Z &lt;- stats::rnorm(n)
data &lt;- rBNR(
  X = X,
  Z = Z,
  b = 1,
  a = -1,
  t_miss = 0.1,
  s_miss = 0.1
)

# Log likelihood.
fit_bnem &lt;- FitBNR(
  t = data[, 1],
  s = data[, 2],
  X = X,
  Z = Z
)

</code></pre>

<hr>
<h2 id='fitOLS'>Ordinary Least Squares</h2><span id='topic+fitOLS'></span>

<h3>Description</h3>

<p>Fits the standard OLS model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitOLS(y, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitOLS_+3A_y">y</code></td>
<td>
<p>Nx1 Numeric vector.</p>
</td></tr>
<tr><td><code id="fitOLS_+3A_x">X</code></td>
<td>
<p>NxP Numeric matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the following:
</p>
<table>
<tr><td><code>Beta</code></td>
<td>
<p>Regression coefficient.</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>Outcome variance.</p>
</td></tr>
<tr><td><code>Ibb</code></td>
<td>
<p>Information matrix for beta.</p>
</td></tr>
<tr><td><code>Resid</code></td>
<td>
<p>Outcome residuals.</p>
</td></tr>
</table>

<hr>
<h2 id='FormatOutput'>Format Output</h2><span id='topic+FormatOutput'></span>

<h3>Description</h3>

<p>Format Output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FormatOutput(data_part, method, b, a, sigma, sig)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FormatOutput_+3A_data_part">data_part</code></td>
<td>
<p>List of partitioned data. See <code><a href="#topic+PartitionData">PartitionData</a></code>.</p>
</td></tr>
<tr><td><code id="FormatOutput_+3A_method">method</code></td>
<td>
<p>Estimation method.</p>
</td></tr>
<tr><td><code id="FormatOutput_+3A_b">b</code></td>
<td>
<p>Final target regression parameter.</p>
</td></tr>
<tr><td><code id="FormatOutput_+3A_a">a</code></td>
<td>
<p>Final surrogate regression parameter.</p>
</td></tr>
<tr><td><code id="FormatOutput_+3A_sigma">sigma</code></td>
<td>
<p>Final target-surrogate covariance matrix.</p>
</td></tr>
<tr><td><code id="FormatOutput_+3A_sig">sig</code></td>
<td>
<p>Significance level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class 'bnr'.
</p>

<hr>
<h2 id='IterUpdate'>Update Iteration</h2><span id='topic+IterUpdate'></span>

<h3>Description</h3>

<p>Update Iteration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IterUpdate(theta0, update, maxit, eps, report)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IterUpdate_+3A_theta0">theta0</code></td>
<td>
<p>List containing the initial parameter values.</p>
</td></tr>
<tr><td><code id="IterUpdate_+3A_update">update</code></td>
<td>
<p>Function to iterate. Should accept and return a list similar
parameter values.</p>
</td></tr>
<tr><td><code id="IterUpdate_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of parameter updates.</p>
</td></tr>
<tr><td><code id="IterUpdate_+3A_eps">eps</code></td>
<td>
<p>Minimum acceptable improvement in log likelihood.</p>
</td></tr>
<tr><td><code id="IterUpdate_+3A_report">report</code></td>
<td>
<p>Report fitting progress?</p>
</td></tr>
</table>

<hr>
<h2 id='matDet'>Matrix Determinant</h2><span id='topic+matDet'></span>

<h3>Description</h3>

<p>Calculates the determinant of <code class="reqn">A</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matDet(A, logDet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matDet_+3A_a">A</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
<tr><td><code id="matDet_+3A_logdet">logDet</code></td>
<td>
<p>Return the logarithm of the determinant?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar.
</p>

<hr>
<h2 id='matInv'>Matrix Inverse</h2><span id='topic+matInv'></span>

<h3>Description</h3>

<p>Calcualtes <code class="reqn">A^{-1}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matInv(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matInv_+3A_a">A</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix.
</p>

<hr>
<h2 id='matIP'>Matrix Inner Product</h2><span id='topic+matIP'></span>

<h3>Description</h3>

<p>Calculates the product <code class="reqn">A'B</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matIP(A, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matIP_+3A_a">A</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
<tr><td><code id="matIP_+3A_b">B</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix.
</p>

<hr>
<h2 id='matOP'>Matrix Outer Product</h2><span id='topic+matOP'></span>

<h3>Description</h3>

<p>Calculates the outer product <code class="reqn">AB'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matOP(A, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matOP_+3A_a">A</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
<tr><td><code id="matOP_+3A_b">B</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix.
</p>

<hr>
<h2 id='matQF'>Quadratic Form</h2><span id='topic+matQF'></span>

<h3>Description</h3>

<p>Calculates the quadratic form <code class="reqn">X'AX</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matQF(X, A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matQF_+3A_x">X</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
<tr><td><code id="matQF_+3A_a">A</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix.
</p>

<hr>
<h2 id='MMP'>Matrix Matrix Product</h2><span id='topic+MMP'></span>

<h3>Description</h3>

<p>Calculates the product <code class="reqn">AB</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MMP(A, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MMP_+3A_a">A</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
<tr><td><code id="MMP_+3A_b">B</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix.
</p>

<hr>
<h2 id='ObsLogLik'>Observed Data Log Likelihood</h2><span id='topic+ObsLogLik'></span>

<h3>Description</h3>

<p>Observed Data Log Likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ObsLogLik(data_part, b, a, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ObsLogLik_+3A_data_part">data_part</code></td>
<td>
<p>List of partitioned data. See <code><a href="#topic+PartitionData">PartitionData</a></code>.</p>
</td></tr>
<tr><td><code id="ObsLogLik_+3A_b">b</code></td>
<td>
<p>Target regression coefficient.</p>
</td></tr>
<tr><td><code id="ObsLogLik_+3A_a">a</code></td>
<td>
<p>Surrogate regression coefficient.</p>
</td></tr>
<tr><td><code id="ObsLogLik_+3A_sigma">sigma</code></td>
<td>
<p>Target-surrogate covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Observed data log likelihood.
</p>

<hr>
<h2 id='ParamInit'>Parameter Initialization</h2><span id='topic+ParamInit'></span>

<h3>Description</h3>

<p>Parameter Initialization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ParamInit(data_part, b0, a0, sigma0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ParamInit_+3A_data_part">data_part</code></td>
<td>
<p>List of partitioned data. See <code><a href="#topic+PartitionData">PartitionData</a></code>.</p>
</td></tr>
<tr><td><code id="ParamInit_+3A_b0">b0</code></td>
<td>
<p>Initial target regression coefficient.</p>
</td></tr>
<tr><td><code id="ParamInit_+3A_a0">a0</code></td>
<td>
<p>Initial surrogate regression coefficient.</p>
</td></tr>
<tr><td><code id="ParamInit_+3A_sigma0">sigma0</code></td>
<td>
<p>Initial covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing initial values of beta, alpha, sigma.
</p>

<hr>
<h2 id='PartitionData'>Partition Data by Outcome Missingness Pattern.</h2><span id='topic+PartitionData'></span>

<h3>Description</h3>

<p>Partition Data by Outcome Missingness Pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PartitionData(t, s, X, Z = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PartitionData_+3A_t">t</code></td>
<td>
<p>Target outcome vector.</p>
</td></tr>
<tr><td><code id="PartitionData_+3A_s">s</code></td>
<td>
<p>Surrogate outcome vector.</p>
</td></tr>
<tr><td><code id="PartitionData_+3A_x">X</code></td>
<td>
<p>Target model matrix.</p>
</td></tr>
<tr><td><code id="PartitionData_+3A_z">Z</code></td>
<td>
<p>Surrogate model matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing these components:
</p>

<ul>
<li><p> 'Orig' original data.
</p>
</li>
<li><p> 'Dims' dimensions and names.
</p>
</li>
<li><p> 'Complete', data for complete cases.
</p>
</li>
<li><p> 'TMiss', data for subjects with target missingness.
</p>
</li>
<li><p> 'SMiss', data for subjects with surrogate missingness.
</p>
</li>
<li><p> 'IPs', inner products. 
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Generate data.
n &lt;- 1e3
X &lt;- rnorm(n)
Z &lt;- rnorm(n)
data &lt;- rBNR(X = X, Z = Z, b = 1, a = -1)
data_part &lt;- PartitionData(
  t = data[, 1], 
  s = data[, 2], 
  X = X, 
  Z = Z
)
</code></pre>

<hr>
<h2 id='print.bnr'>Print for Bivariate Regression Model</h2><span id='topic+print.bnr'></span>

<h3>Description</h3>

<p>Print for Bivariate Regression Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bnr'
print(x, ..., type = "Regression")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.bnr_+3A_x">x</code></td>
<td>
<p><code>bnr</code> object.</p>
</td></tr>
<tr><td><code id="print.bnr_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="print.bnr_+3A_type">type</code></td>
<td>
<p>Either Regression or Covariance.</p>
</td></tr>
</table>

<hr>
<h2 id='rBNR'>Simulate Bivariate Normal Data with Missingness</h2><span id='topic+rBNR'></span>

<h3>Description</h3>

<p>Function to simulate from a bivariate normal regression model with outcomes
missing completely at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rBNR(
  X,
  Z,
  b,
  a,
  t_miss = 0,
  s_miss = 0,
  sigma = NULL,
  include_residuals = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rBNR_+3A_x">X</code></td>
<td>
<p>Target design matrix.</p>
</td></tr>
<tr><td><code id="rBNR_+3A_z">Z</code></td>
<td>
<p>Surrogate design matrix.</p>
</td></tr>
<tr><td><code id="rBNR_+3A_b">b</code></td>
<td>
<p>Target regression coefficient.</p>
</td></tr>
<tr><td><code id="rBNR_+3A_a">a</code></td>
<td>
<p>Surrogate regression coefficient.</p>
</td></tr>
<tr><td><code id="rBNR_+3A_t_miss">t_miss</code></td>
<td>
<p>Target missingness in [0,1].</p>
</td></tr>
<tr><td><code id="rBNR_+3A_s_miss">s_miss</code></td>
<td>
<p>Surrogate missingness in [0,1].</p>
</td></tr>
<tr><td><code id="rBNR_+3A_sigma">sigma</code></td>
<td>
<p>2x2 target-surrogate covariance matrix.</p>
</td></tr>
<tr><td><code id="rBNR_+3A_include_residuals">include_residuals</code></td>
<td>
<p>Include the residual? Default: TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric Nx2 matrix. The first column contains the target
outcome, the second contains the surrogate outcome.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)
# Observations.
n &lt;- 1e3
# Target design.
X &lt;- cbind(1, matrix(rnorm(3 * n), nrow = n))
# Surrogate design.
Z &lt;- cbind(1, matrix(rnorm(3 * n), nrow = n))
# Target coefficient.
b &lt;- c(-1, 0.1, -0.1, 0.1)
# Surrogate coefficient.
a &lt;- c(1, -0.1, 0.1, -0.1)
# Covariance structure.
sigma &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2)
# Data generation, target and surrogate subject to 10% missingness.
y &lt;- rBNR(X, Z, b, a, t_miss = 0.1, s_miss = 0.1, sigma = sigma)
</code></pre>

<hr>
<h2 id='RegInfo'>Regression Information</h2><span id='topic+RegInfo'></span>

<h3>Description</h3>

<p>Regression Information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RegInfo(data_part, sigma, as_matrix = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RegInfo_+3A_data_part">data_part</code></td>
<td>
<p>List of partitioned data. See <code><a href="#topic+PartitionData">PartitionData</a></code>.</p>
</td></tr>
<tr><td><code id="RegInfo_+3A_sigma">sigma</code></td>
<td>
<p>Target-surrogate covariance matrix.</p>
</td></tr>
<tr><td><code id="RegInfo_+3A_as_matrix">as_matrix</code></td>
<td>
<p>Return as an information matrix? If FALSE, returns a list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the information matrix for beta (Ibb), the
information matrix for alpha (Iaa), and the cross information (Iba).
</p>

<hr>
<h2 id='RegTab'>Tabulate Regression Coefficients</h2><span id='topic+RegTab'></span>

<h3>Description</h3>

<p>Tabulate Regression Coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RegTab(point, info, sig = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RegTab_+3A_point">point</code></td>
<td>
<p>Point estimates.</p>
</td></tr>
<tr><td><code id="RegTab_+3A_info">info</code></td>
<td>
<p>Information matrix.</p>
</td></tr>
<tr><td><code id="RegTab_+3A_sig">sig</code></td>
<td>
<p>Significance level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data.table containing the point estimate, standard error, confidence
interval, and Wald p-value.
</p>

<hr>
<h2 id='RegUpdate'>Regression Update</h2><span id='topic+RegUpdate'></span>

<h3>Description</h3>

<p>Regression Update
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RegUpdate(data_part, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RegUpdate_+3A_data_part">data_part</code></td>
<td>
<p>List of partitioned data. See <code><a href="#topic+PartitionData">PartitionData</a></code>.</p>
</td></tr>
<tr><td><code id="RegUpdate_+3A_sigma">sigma</code></td>
<td>
<p>Target-surrogate covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the generalized least squares estimates of beta and
alpha.
</p>

<hr>
<h2 id='residuals.bnr'>Extract Residuals from Bivariate Regression Model</h2><span id='topic+residuals.bnr'></span>

<h3>Description</h3>

<p>Extract Residuals from Bivariate Regression Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bnr'
residuals(object, ..., type = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.bnr_+3A_object">object</code></td>
<td>
<p>A <code>bnr</code> object.</p>
</td></tr>
<tr><td><code id="residuals.bnr_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="residuals.bnr_+3A_type">type</code></td>
<td>
<p>Either Target or Surrogate.</p>
</td></tr>
</table>

<hr>
<h2 id='SchurC'>Schur complement</h2><span id='topic+SchurC'></span>

<h3>Description</h3>

<p>Calculates the efficient information <code class="reqn">I_{bb}-I_{ba}I_{aa}^{-1}I_{ab}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SchurC(Ibb, Iaa, Iba)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SchurC_+3A_ibb">Ibb</code></td>
<td>
<p>Information of target parameter</p>
</td></tr>
<tr><td><code id="SchurC_+3A_iaa">Iaa</code></td>
<td>
<p>Information of nuisance parameter</p>
</td></tr>
<tr><td><code id="SchurC_+3A_iba">Iba</code></td>
<td>
<p>Cross information between target and nuisance parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix.
</p>

<hr>
<h2 id='ScoreBNEM'>Score Test via Expectation Maximization.</h2><span id='topic+ScoreBNEM'></span>

<h3>Description</h3>

<p>Performs a Score test of the null hypothesis that a subset of the regression
parameters for the target outcome are zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ScoreBNEM(
  t,
  s,
  X,
  Z,
  is_zero,
  init = NULL,
  maxit = 100,
  eps = 1e-08,
  report = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ScoreBNEM_+3A_t">t</code></td>
<td>
<p>Target outcome vector.</p>
</td></tr>
<tr><td><code id="ScoreBNEM_+3A_s">s</code></td>
<td>
<p>Surrogate outcome vector.</p>
</td></tr>
<tr><td><code id="ScoreBNEM_+3A_x">X</code></td>
<td>
<p>Target model matrix.</p>
</td></tr>
<tr><td><code id="ScoreBNEM_+3A_z">Z</code></td>
<td>
<p>Surrogate model matrix.</p>
</td></tr>
<tr><td><code id="ScoreBNEM_+3A_is_zero">is_zero</code></td>
<td>
<p>Logical vector, with as many entires as columns in the target model
matrix, indicating which columns have coefficient zero under the null.</p>
</td></tr>
<tr><td><code id="ScoreBNEM_+3A_init">init</code></td>
<td>
<p>Optional list of initial parameters for fitting the null model.</p>
</td></tr>
<tr><td><code id="ScoreBNEM_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of parameter updates.</p>
</td></tr>
<tr><td><code id="ScoreBNEM_+3A_eps">eps</code></td>
<td>
<p>Minimum acceptable improvement in log likelihood.</p>
</td></tr>
<tr><td><code id="ScoreBNEM_+3A_report">report</code></td>
<td>
<p>Report model fitting progress? Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the score statistic, the degrees of
freedom, and a p-value.
</p>

<hr>
<h2 id='show+2Cbnr-method'>Show for Bivariate Regression Model</h2><span id='topic+show+2Cbnr-method'></span>

<h3>Description</h3>

<p>Show for Bivariate Regression Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bnr'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Cbnr-method_+3A_object">object</code></td>
<td>
<p><code>bnr</code> object.</p>
</td></tr>
</table>

<hr>
<h2 id='TestBNR'>Test Bivariate Normal Regression Model.</h2><span id='topic+TestBNR'></span>

<h3>Description</h3>

<p>Performs a test of the null hypothesis that a subset of the regression
parameters for the target outcome are zero in the bivariate normal regression
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TestBNR(t, s, X, Z = NULL, is_zero, test = "Wald", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TestBNR_+3A_t">t</code></td>
<td>
<p>Target outcome vector.</p>
</td></tr>
<tr><td><code id="TestBNR_+3A_s">s</code></td>
<td>
<p>Surrogate outcome vector.</p>
</td></tr>
<tr><td><code id="TestBNR_+3A_x">X</code></td>
<td>
<p>Target model matrix.</p>
</td></tr>
<tr><td><code id="TestBNR_+3A_z">Z</code></td>
<td>
<p>Surrogate model matrix.</p>
</td></tr>
<tr><td><code id="TestBNR_+3A_is_zero">is_zero</code></td>
<td>
<p>Logical vector, with as many entires as columns in the target
model matrix, indicating which columns have coefficient zero under the
null.</p>
</td></tr>
<tr><td><code id="TestBNR_+3A_test">test</code></td>
<td>
<p>Either Score or Wald. Only Wald is available for LS.</p>
</td></tr>
<tr><td><code id="TestBNR_+3A_...">...</code></td>
<td>
<p>Additional arguments accepted if fitting via EM. See
<code><a href="#topic+FitBNEM">FitBNEM</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the test statistic, the degrees of
freedom, and a p-value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate data.
set.seed(100)
n &lt;- 1e3
X &lt;- cbind(1, rnorm(n))
Z &lt;- cbind(1, rnorm(n))
data &lt;- rBNR(X = X, Z = Z, b = c(1, 0), a = c(-1, 0), t_miss = 0.1, s_miss = 0.1)

# Test 1st coefficient.
wald_test1 &lt;- TestBNR(
  t = data[, 1], 
  s = data[, 2], 
  X = X, 
  Z = Z,
  is_zero = c(TRUE, FALSE),
  test = "Wald"
)

score_test1 &lt;- TestBNR(
  t = data[, 1], 
  s = data[, 2], 
  X = X, 
  Z = Z,
  is_zero = c(TRUE, FALSE),
  test = "Score"
)

# Test 2nd coefficient.
wald_test2 &lt;- TestBNR(
  t = data[, 1], 
  s = data[, 2], 
  X = X, 
  Z = Z,
  is_zero = c(FALSE, TRUE),
  test = "Wald"
)

score_test2 &lt;- TestBNR(
  t = data[, 1], 
  s = data[, 2], 
  X = X, 
  Z = Z,
  is_zero = c(FALSE, TRUE),
  test = "Score"
)

</code></pre>

<hr>
<h2 id='tr'>Matrix Trace</h2><span id='topic+tr'></span>

<h3>Description</h3>

<p>Calculates the trace of a matrix <code class="reqn">A</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tr(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tr_+3A_a">A</code></td>
<td>
<p>Numeric matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar.
</p>

<hr>
<h2 id='UpdateEM'>EM Update</h2><span id='topic+UpdateEM'></span>

<h3>Description</h3>

<p>EM Update
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UpdateEM(data_part, b0, a0, sigma0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UpdateEM_+3A_data_part">data_part</code></td>
<td>
<p>List of partitioned data. See <code><a href="#topic+PartitionData">PartitionData</a></code>.</p>
</td></tr>
<tr><td><code id="UpdateEM_+3A_b0">b0</code></td>
<td>
<p>Initial target regression coefficient.</p>
</td></tr>
<tr><td><code id="UpdateEM_+3A_a0">a0</code></td>
<td>
<p>Initial surrogate regression coefficient.</p>
</td></tr>
<tr><td><code id="UpdateEM_+3A_sigma0">sigma0</code></td>
<td>
<p>Initial covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing updated values for beta 'b', alpha 'a', 'sigma', the
log likelihood 'loglik', and the change in log likelihood 'delta'.
</p>

<hr>
<h2 id='vcov.bnr'>Extract Covariance Matrix from Bivariate Normal Regression Model</h2><span id='topic+vcov.bnr'></span>

<h3>Description</h3>

<p>Returns the either the estimated covariance matrix of the outcome, the
information matrix for regression coefficients, or the information matrix for
covariance parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bnr'
vcov(object, ..., type = "Regression", inv = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.bnr_+3A_object">object</code></td>
<td>
<p><code>bnr</code> object.</p>
</td></tr>
<tr><td><code id="vcov.bnr_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="vcov.bnr_+3A_type">type</code></td>
<td>
<p>Select &quot;Covariance&quot;,&quot;Outcome&quot;,or &quot;Regression&quot;. Default is
&quot;Regression&quot;.</p>
</td></tr>
<tr><td><code id="vcov.bnr_+3A_inv">inv</code></td>
<td>
<p>Invert the covariance matrix? Default is FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='WaldBNEM'>Wald Test via Expectation Maximization.</h2><span id='topic+WaldBNEM'></span>

<h3>Description</h3>

<p>Performs a Wald test of the null hypothesis that a subset of the regression
parameters for the target outcome are zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WaldBNEM(
  t,
  s,
  X,
  Z,
  is_zero,
  init = NULL,
  maxit = 100,
  eps = 1e-08,
  report = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WaldBNEM_+3A_t">t</code></td>
<td>
<p>Target outcome vector.</p>
</td></tr>
<tr><td><code id="WaldBNEM_+3A_s">s</code></td>
<td>
<p>Surrogate outcome vector.</p>
</td></tr>
<tr><td><code id="WaldBNEM_+3A_x">X</code></td>
<td>
<p>Target model matrix.</p>
</td></tr>
<tr><td><code id="WaldBNEM_+3A_z">Z</code></td>
<td>
<p>Surrogate model matrix.</p>
</td></tr>
<tr><td><code id="WaldBNEM_+3A_is_zero">is_zero</code></td>
<td>
<p>Logical vector, with as many entries as columns in the target model
matrix, indicating which columns have coefficient zero under the null.</p>
</td></tr>
<tr><td><code id="WaldBNEM_+3A_init">init</code></td>
<td>
<p>Optional list of initial parameters for fitting the null model,
with one or more of the components: a0, b0, S0.</p>
</td></tr>
<tr><td><code id="WaldBNEM_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of parameter updates.</p>
</td></tr>
<tr><td><code id="WaldBNEM_+3A_eps">eps</code></td>
<td>
<p>Minimum acceptable improvement in log likelihood.</p>
</td></tr>
<tr><td><code id="WaldBNEM_+3A_report">report</code></td>
<td>
<p>Report model fitting progress? Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the Wald statistic, the degrees of
freedom, and a p-value.
</p>

<hr>
<h2 id='WaldBNLS'>Wald Test via Least Squares.</h2><span id='topic+WaldBNLS'></span>

<h3>Description</h3>

<p>Performs a Wald test of the null hypothesis that a subset of the regression
parameters for the target outcome are zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WaldBNLS(t, s, X, is_zero)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WaldBNLS_+3A_t">t</code></td>
<td>
<p>Target outcome vector.</p>
</td></tr>
<tr><td><code id="WaldBNLS_+3A_s">s</code></td>
<td>
<p>Surrogate outcome vector.</p>
</td></tr>
<tr><td><code id="WaldBNLS_+3A_x">X</code></td>
<td>
<p>Model matrix.</p>
</td></tr>
<tr><td><code id="WaldBNLS_+3A_is_zero">is_zero</code></td>
<td>
<p>Logical vector, with as many entires as columns in the target model
matrix, indicating which columns have coefficient zero under the null.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the Wald statistic, the degrees of
freedom, and a p-value.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
