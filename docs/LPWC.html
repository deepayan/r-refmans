<!DOCTYPE html><html><head><title>Help for package LPWC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LPWC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#best.lag'><p>Best Lag</p></a></li>
<li><a href='#comp.corr'><p>Computing corr</p></a></li>
<li><a href='#corr.bestlag'><p>Computes best lag correlation</p></a></li>
<li><a href='#findC'><p>Finding best C</p></a></li>
<li><a href='#prep.data'><p>Preparing Data</p></a></li>
<li><a href='#score'><p>Score of Lags</p></a></li>
<li><a href='#simdata'><p>Example datasets for LPC</p></a></li>
<li><a href='#weight'><p>Weight in correlation</p></a></li>
<li><a href='#weight.lag'><p>Weight Lag</p></a></li>
<li><a href='#wt.corr'><p>Weighted correlation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Lag Penalized Weighted Correlation for Time Series Clustering</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes a time series distance measure for clustering based on weighted correlation and introduction of lags. The lags capture delayed responses in a time series dataset. The timepoints must be specified. T. Chandereng, A. Gitter (2020) &lt;<a href="https://doi.org/10.1186%2Fs12859-019-3324-1">doi:10.1186/s12859-019-3324-1</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, rmarkdown, pkgdown, ggplot2, knitr, devtools</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/gitter-lab/LPWC">https://github.com/gitter-lab/LPWC</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gitter-lab/LPWC/issues">https://github.com/gitter-lab/LPWC/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>nleqslv</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-01-23 17:54:19 UTC; thevaasiinenchandereng</td>
</tr>
<tr>
<td>Author:</td>
<td>Thevaa Chandereng <a href="https://orcid.org/0000-0003-4078-9176"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Anthony Gitter <a href="https://orcid.org/0000-0002-5324-9833"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thevaa Chandereng &lt;chandereng@wisc.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-01-23 22:50:20 UTC</td>
</tr>
</table>
<hr>
<h2 id='best.lag'>Best Lag</h2><span id='topic+best.lag'></span>

<h3>Description</h3>

<p><code>best.lag</code> computes the best lags for a dataset using weighted correlation.
The lags obtained are in reference to the original timepoints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>best.lag(data, timepoints, max.lag = NULL, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="best.lag_+3A_data">data</code></td>
<td>
<p>a matrix or data frame with rows representing genes and columns
representing different timepoints. If data is a data frame, the gene names
can be specified using the <code>row.names()</code>.</p>
</td></tr>
<tr><td><code id="best.lag_+3A_timepoints">timepoints</code></td>
<td>
<p>a vector of time points used in the dataset</p>
</td></tr>
<tr><td><code id="best.lag_+3A_max.lag">max.lag</code></td>
<td>
<p>a numeric value of the maximum lag allowed, if null,
defaults to the floor of the number of timepoints divided by 4</p>
</td></tr>
<tr><td><code id="best.lag_+3A_c">C</code></td>
<td>
<p>a numeric value of C used in computing weighted correlation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of best lags used in the dataset, one per gene
</p>


<h3>Author(s)</h3>

<p>Thevaa Chandereng, Anthony Gitter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>best.lag(data = array(rnorm(20), c(4, 5)), timepoints = c(0, 5, 10, 20, 40), C = 300)
best.lag(data = array(runif(100), c(5, 20)), timepoints = seq(2, 40, 2), C = 10)
best.lag(data = array(runif(100), c(5, 20)), timepoints = seq(2, 40, 2), max.lag = 2, C = 10)


</code></pre>

<hr>
<h2 id='comp.corr'>Computing corr</h2><span id='topic+comp.corr'></span>

<h3>Description</h3>

<p>This function computes the weighted correlation with a penalty for lags.
It should only be used after the fixed lags have already been applied to the dataset and timepoints using the functions
prep.data() and best.lag().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.corr(data, time, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comp.corr_+3A_data">data</code></td>
<td>
<p>a lagged matrix or data frame with rows representing genes and columns representing
different timepoints (NAs added when lags are needed)</p>
</td></tr>
<tr><td><code id="comp.corr_+3A_time">time</code></td>
<td>
<p>a lagged matrix with rows representing each gene's timepoint and columns representing the number of timepoints, NA is introduced when it is lagged</p>
</td></tr>
<tr><td><code id="comp.corr_+3A_c">C</code></td>
<td>
<p>a numeric value of C used in computing weighted correlation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a simmilarity matrix with values between -1 and 1
(1 highly correlated, 0 no correlation)
</p>


<h3>Author(s)</h3>

<p>Thevaa Chandereng, Anthony Gitter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## This function computes the correlation after the lags (or shifts) have
## been computed.  In this example, the lags argument is randomly sampled
## for the sake of illustrating how prep.data() applies the lags and
## prepares a transformed dataset for comp.corr().
lagged &lt;- prep.data(array(rnorm(30), c(3, 10)), timepoints = seq(0, 45, 5),
          lags = sample(c(0, 1, -1, 2, -2), size = 3))
comp.corr(data = lagged$data, time = lagged$time, C = 10)

## This example shows how comp.corr is used in practice with real data.
## The best.lag() function is called first to pre-compute the lags, which
## are passed to prep.data().
randdata &lt;- array(rnorm(120), c(10, 12))
bl &lt;- best.lag(data = randdata, timepoints = 1:12, C = 5)
lag.data &lt;- prep.data(randdata, timepoints = 1:12, lags = bl)
comp.corr(lag.data$data, time = lag.data$time, C = 5)


</code></pre>

<hr>
<h2 id='corr.bestlag'>Computes best lag correlation</h2><span id='topic+corr.bestlag'></span>

<h3>Description</h3>

<p>This function computes correlation based on best picked lags. The lags indicate delayed changes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr.bestlag(data, timepoints, max.lag = NULL, C = NULL,
  penalty = "high", iter = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corr.bestlag_+3A_data">data</code></td>
<td>
<p>a matrix or data frame with rows representing genes and columns
representing different timepoints. If data is a data frame, the gene names
can be specified using the <code>row.names()</code>.</p>
</td></tr>
<tr><td><code id="corr.bestlag_+3A_timepoints">timepoints</code></td>
<td>
<p>a vector of time points used in the dataset</p>
</td></tr>
<tr><td><code id="corr.bestlag_+3A_max.lag">max.lag</code></td>
<td>
<p>a integer value of the maximum lags allowed in the dataset,
if null, defaults to the floor of the number of timepoints divided by 4</p>
</td></tr>
<tr><td><code id="corr.bestlag_+3A_c">C</code></td>
<td>
<p>a numeric value of C used in computing weighted correlation,
if null, a default is computed based on the penalty argument</p>
</td></tr>
<tr><td><code id="corr.bestlag_+3A_penalty">penalty</code></td>
<td>
<p>a factor with two levels high and low penalty on the weighted correlation</p>
</td></tr>
<tr><td><code id="corr.bestlag_+3A_iter">iter</code></td>
<td>
<p>an integer indicating the number of C values to test for low penalty</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing weighted correlation and best lags used in each row
</p>


<h3>Author(s)</h3>

<p>Thevaa Chandereng, Anthony Gitter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>corr.bestlag(array(rnorm(30), c(5, 6)), max.lag = 1,
          timepoints = c(0, 5, 10, 15, 20, 25), C = 10, penalty = "high")
corr.bestlag(array(runif(40, 0, 20), c(4, 10)),
          timepoints = c(0, 0.5, 1.5, 3, 6, 12, 18, 26, 39, 50), penalty = "high")
corr.bestlag(matrix(data = rexp(n = 40, 2), nrow = 8),
          timepoints = c(0, 5, 15, 20, 40), penalty = "low", iter = 5)

</code></pre>

<hr>
<h2 id='findC'>Finding best C</h2><span id='topic+findC'></span>

<h3>Description</h3>

<p>This function computes the values of C to test using the timepoints and max lag in the dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findC(timepoints, max.lag = NULL, pi = 0.95, iter = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findC_+3A_timepoints">timepoints</code></td>
<td>
<p>a vector of timepoints used in the dataset</p>
</td></tr>
<tr><td><code id="findC_+3A_max.lag">max.lag</code></td>
<td>
<p>a numeric value with maximum lags allowed,
if null, defaults to the floor of the number of timepoints divided by 4</p>
</td></tr>
<tr><td><code id="findC_+3A_pi">pi</code></td>
<td>
<p>a numeric value between 0.5 and 1 for the upper bound on the penalty</p>
</td></tr>
<tr><td><code id="findC_+3A_iter">iter</code></td>
<td>
<p>a numeric value with the number of penalties to test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of length iter of the different values of C to test
</p>


<h3>Author(s)</h3>

<p>Thevaa Chandereng, Anthony Gitter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>findC(c(0, 5, 10, 15, 20, 25), max.lag = 1, iter = 15)
findC(c(2, 4, 8, 16, 32, 64, 128, 256), iter = 5)
findC(c(2, 6, 10, 15, 22, 30, 40, 55, 80), pi = 0.8, iter = 20)
findC(c(1, 2, 3.2, 4, 5.3, 7), pi = 0.99)

</code></pre>

<hr>
<h2 id='prep.data'>Preparing Data</h2><span id='topic+prep.data'></span>

<h3>Description</h3>

<p>This function prepares the data to compute correlation by introducing NA's when lags are needed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep.data(data, lags, timepoints)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep.data_+3A_data">data</code></td>
<td>
<p>a matrix or data frame with rows representing genes and columns
representing different timepoints. If data is a data frame, the gene names
can be specified using the <code>row.names()</code>.</p>
</td></tr>
<tr><td><code id="prep.data_+3A_lags">lags</code></td>
<td>
<p>a vector of same length as the number of rows in the data column
indicating the best lags</p>
</td></tr>
<tr><td><code id="prep.data_+3A_timepoints">timepoints</code></td>
<td>
<p>a vector of time points used in the dataset</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two matrices, one matrix with NA's for the lags for the dataset
and another matrix with the timepoints used for each row in the dataset
</p>


<h3>Author(s)</h3>

<p>Thevaa Chandereng, Anthony Gitter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prep.data(array(rnorm(20), c(5, 4)), c(0, 0, 0, -1, 1),
          timepoints = c(0, 5, 15, 30))
prep.data(array(runif(100, 0, 10), c(10, 10)), sample((-2:2), size = 10, replace = TRUE),
          timepoints = c(0, 5, 15, 30, 45, 60, 75, 80, 100, 120))

</code></pre>

<hr>
<h2 id='score'>Score of Lags</h2><span id='topic+score'></span>

<h3>Description</h3>

<p>This function computes the score of best lags by summing the correlation of corresponding lags
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score(corr, lags)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="score_+3A_corr">corr</code></td>
<td>
<p>a vector of computed correlation</p>
</td></tr>
<tr><td><code id="score_+3A_lags">lags</code></td>
<td>
<p>a vector of same length with corr that holds the lags corresponding to the corr vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical value of best lag picked based on corr and lags
</p>


<h3>Author(s)</h3>

<p>Thevaa Chandereng, Anthony Gitter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>score(runif(10, 0, 1), c(2, 0, 0, 0, 3, 2, -1, 2, 0, 1))
score(runif(20, 0.5, 0.8), sample(-3:3, size = 20, replace = TRUE))


</code></pre>

<hr>
<h2 id='simdata'>Example datasets for LPC</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>Data is simulated from ImpulseDE function with 8 timepoints c(0, 2, 4, 6, 8, 18, 24, 32, 48, 72)
See https://doi.org/10.1093/bioinformatics/btw665
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simdata
</code></pre>


<h3>Format</h3>

<p>data matrix</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)


</code></pre>

<hr>
<h2 id='weight'>Weight in correlation</h2><span id='topic+weight'></span>

<h3>Description</h3>

<p>This function computes the weight used for correlation using timepoints used and lags used
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weight(t, lag, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weight_+3A_t">t</code></td>
<td>
<p>a vector of timepoints</p>
</td></tr>
<tr><td><code id="weight_+3A_lag">lag</code></td>
<td>
<p>a integer value of the lag used</p>
</td></tr>
<tr><td><code id="weight_+3A_c">C</code></td>
<td>
<p>a numeric of the constant used in the penalty and weight inside the Gaussian kernel</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing w0 and vector w used for computing weighted correlation
</p>


<h3>Author(s)</h3>

<p>Thevaa Chandereng, Anthony Gitter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>weight(t = c(0, 5, 10, 15, 20), lag = 1, C = 20)
weight(t = c(0, 2, 5, 10, 14, 19, 22), lag = 1,C = 100)


</code></pre>

<hr>
<h2 id='weight.lag'>Weight Lag</h2><span id='topic+weight.lag'></span>

<h3>Description</h3>

<p>This function matches vectors of two different lengths
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weight.lag(x1, x2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weight.lag_+3A_x1">x1</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="weight.lag_+3A_x2">x2</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with two rows with the shortest length of the vector as the number of columns
</p>


<h3>Author(s)</h3>

<p>Thevaa Chandereng, Anthony Gitter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>weight.lag(1:5, 2:9)
weight.lag (seq(0, 10, 2), seq(4, 10, 2))


</code></pre>

<hr>
<h2 id='wt.corr'>Weighted correlation</h2><span id='topic+wt.corr'></span>

<h3>Description</h3>

<p>This function computes weighted Pearson correlation between two vectors with weights given. The output is between -1 and 1 with 1
being highly positively correlated, -1 being highly negatively correlated, and 0 being no correlation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wt.corr(x, y, w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wt.corr_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="wt.corr_+3A_y">y</code></td>
<td>
<p>a vector with same length of x</p>
</td></tr>
<tr><td><code id="wt.corr_+3A_w">w</code></td>
<td>
<p>a vector with same length of x and y</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical value of weighted Pearson correlation
</p>


<h3>Source</h3>

<p><a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#Weighted_correlation_coefficient">https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#Weighted_correlation_coefficient</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wt.corr(c(1, 2, -9, 4, 5), c(2:6), c(0.5, 1, 2, 0.5, 2))
wt.corr(rnorm(5), rnorm(5), runif(5, 0, 1))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
