<!DOCTYPE html><html lang="en"><head><title>Help for package transltr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {transltr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#transltr-package'><p>Support Many Languages in R</p></a></li>
<li><a href='#algorithms'><p>Hashing Algorithms</p></a></li>
<li><a href='#find_source'><p>Find Source Text</p></a></li>
<li><a href='#find_source_in_file'><p>Find Source Text in Expressions</p></a></li>
<li><a href='#flat_serialize'><p>Serialize Objects to Flat Strings</p></a></li>
<li><a href='#format_vector'><p>Format Vectors</p></a></li>
<li><a href='#hash'><p>Hashing</p></a></li>
<li><a href='#is_int'><p>Assertions</p></a></li>
<li><a href='#language_set'><p>Get or Set Language</p></a></li>
<li><a href='#location'><p>Source Locations</p></a></li>
<li><a href='#normalize'><p>Normalize Text</p></a></li>
<li><a href='#range_format'><p>Source Ranges</p></a></li>
<li><a href='#serialize'><p>Serialize Objects</p></a></li>
<li><a href='#stops'><p>Throw Errors</p></a></li>
<li><a href='#str_to'><p>Character String Utilities</p></a></li>
<li><a href='#text'><p>Source Text</p></a></li>
<li><a href='#text_read'><p>Read and Write Text</p></a></li>
<li><a href='#translator'><p>Source Text and Translations</p></a></li>
<li><a href='#translator_read'><p>Read and Write Translations</p></a></li>
<li><a href='#uuid'><p>Universally Unique Identifiers</p></a></li>
<li><a href='#vapply_1l'><p>Apply Wrappers</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Support Many Languages in R</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>An object model for source text and translations. Find and extract
    translatable strings. Provide translations and seamlessly retrieve them at
    runtime.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://transltr.ununoctium.dev">https://transltr.ununoctium.dev</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jeanmathieupotvin/transltr/issues">https://github.com/jeanmathieupotvin/transltr/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>digest, R6, stringi, utils, yaml</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, devtools, lifecycle, microbenchmark, pkgdown, testthat
(&ge; 3.0.0), usethis, withr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'aaa.R' 'assert.R' 'class-location.R' 'class-text.R'
'class-translator.R' 'find-source-in-exprs.R' 'find-source.R'
'flat.R' 'hash.R' 'language.R' 'normalize.R' 'serialize.R'
'text-io.R' 'translator-io.R' 'transltr-package.R'
'utils-format-vector.R' 'utils-map.R' 'utils-nullish-op.R'
'utils-stop.R' 'utils-strings.R' 'uuid.R' 'zzz.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-14 16:05:36 UTC; jmp</td>
</tr>
<tr>
<td>Author:</td>
<td>Jean-Mathieu Potvin [aut, cre, cph],
  Jérôme Lavoué <a href="https://orcid.org/0000-0003-4950-5475"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, fnd, rev]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jean-Mathieu Potvin &lt;jeanmathieupotvin@ununoctium.dev&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-14 16:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='transltr-package'>Support Many Languages in R</h2><span id='topic+transltr'></span><span id='topic+transltr-package'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>An object model for source text and translations. Find and extract
translatable strings. Provide translations and seamlessly retrieve
them at runtime.
</p>


<h3>Introduction</h3>

<p><span class="rlang"><b>R</b></span> relies on GNU <a href="https://www.gnu.org/software/gettext/"><code>gettext</code></a> to
produce multi-lingual messages (if <em>Native Language Support</em> is enabled).
This is well-designed software offering an extensive set of functionalities.
It is ubiquitous and has withstood the test of time. It is not the objective
of <code><a href="#topic+transltr">transltr</a></code> to (fully) replace it.
</p>
<p>Package <code><a href="#topic+transltr">transltr</a></code> provides an alternative in-memory object
model (and further functions) to easily inspect and manipulate source text
and translations.
</p>

<ul>
<li><p> It does not change any aspect of the underlying locale.
</p>
</li>
<li><p> It has its own data serialization formats for I/O purposes. Source text
and translations can be exported to text formats that are sharable and
easily modifiable, even by non-technical collaborators.
</p>
</li>
<li><p> Its features are extensively documented (even internal ones).
</p>
</li>
<li><p> It can always locate and extract translatable strings (no matter where
they are in the source code).
</p>
</li>
<li><p> Translatable source text is treated as a regular <span class="rlang"><b>R</b></span> object.
</p>
</li></ul>



<h3>Getting Started</h3>

<p>Write code as you normally would. Whenever a piece of text (literal 
character vectors) should be available in multiple languages, pass it
to method <code><a href="#topic+Translator">Translator$translate()</a></code>. You may also use your
own function.
</p>

<ol>
<li><p> Once you are ready to translate your project, call <code><a href="#topic+find_source">find_source()</a></code>.
This returns a <code><a href="#topic+Translator">Translator</a></code> object.
</p>
</li>
<li><p> Export the <code><a href="#topic+Translator">Translator</a></code> object with <code><a href="#topic+translator_write">translator_write()</a></code>.
Fill in the underlying translation files.
</p>
</li>
<li><p> Import translations back into an <span class="rlang"><b>R</b></span> session with <code><a href="#topic+translator_read">translator_read()</a></code>.
</p>
</li></ol>

<p>Current language and source language are respectively set with
<code><a href="#topic+language_set">language_set()</a></code> and <code><a href="#topic+language_source_get">language_source_get()</a></code>. By default, the latter is set
equal to <code>"en"</code> (English).
</p>


<h3>Bugs and Feedback</h3>

<p>You may submit bugs, request features, and provide feedback by creating an
<a href="https://github.com/jeanmathieupotvin/transltr/issues/new">issue on GitHub</a>.
</p>


<h3>Acknowledgements</h3>

<p>Warm thanks to Jérôme Lavoué, who supported and sponsored the first release
of this project.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Jean-Mathieu Potvin <a href="mailto:jeanmathieupotvin@ununoctium.dev">jeanmathieupotvin@ununoctium.dev</a> [copyright holder]
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Jérôme Lavoué <a href="mailto:jerome.lavoue@umontreal.ca">jerome.lavoue@umontreal.ca</a> (<a href="https://orcid.org/0000-0003-4950-5475">ORCID</a>) [contributor, funder, reviewer]
</p>
</li></ul>



<h3>See Also</h3>

<p>The scattered and incomplete documentation of <span class="rlang"><b>R</b></span>'s Native Language Support:
</p>

<ul>
<li> <p><code><a href="base.html#topic+gettext">gettext()</a></code>,
</p>
</li>
<li> <p><code><a href="base.html#topic+Sys.setLanguage">Sys.setLanguage()</a></code>, <code><a href="base.html#topic+Sys.setlocale">Sys.setlocale()</a></code>, <code><a href="base.html#topic+Sys.localeconv">Sys.localeconv()</a></code>,
</p>
</li>
<li> <p><code><a href="tools.html#topic+xgettext">tools::xgettext()</a></code>,
</p>
</li>
<li> <p><code><a href="tools.html#topic+xgettext">tools::xgettext2pot()</a></code>, <code><a href="tools.html#topic+update_pkg_po">tools::update_pkg_po()</a></code>, <code><a href="tools.html#topic+checkPoFiles">tools::checkPoFiles()</a></code>,
</p>
</li>
<li> <p><a href="https://cran.r-project.org/doc/manuals/r-release/R-ints.html#R-code-1">Section 3 (Internationalization)</a>
of <span class="rlang"><b>R</b></span> Internals,
</p>
</li>
<li> <p><a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Internationalization-and-Localization">Section 7 (Internationalization and Localization)</a>
of <span class="rlang"><b>R</b></span> Installation and Administration, and
</p>
</li>
<li> <p><a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Internationalization">Section 1.8 (Internationalization)</a> of Writing <span class="rlang"><b>R</b></span> Extensions.
</p>
</li></ul>

<p>The comprehensive technical documentation of
<a href="https://www.gnu.org/software/gettext/manual/gettext.html">GNU <code>gettext</code></a>.
</p>

<hr>
<h2 id='algorithms'>Hashing Algorithms</h2><span id='topic+algorithms'></span>

<h3>Description</h3>

<p>These algorithms map a character string to another character string of
hexadecimal characters highly likely to be unique. The latter is used
to uniquely identify a source text (and the underlying source language).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>algorithms()
</code></pre>


<h3>Details</h3>



<h4>Secure Hash Algorithm 1</h4>

<p>Method <code>sha1</code> corresponds to SHA-1 (Secure Hash Algorithm version 1), a
cryptographic hashing function. While it is now superseded by more secure
variants (SHA-256, SHA-512, etc.), it is still useful for non-sensitive
purposes. It is fast, collision-resistant, and may handle very large inputs.
It emits strings of 40 hexadecimal characters.
</p>



<h4>Cumulative UTF-8 Sum</h4>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p><strong>This method is experimental. Use with caution.</strong>
</p>
<p>Method <code>utf8</code> is a simple method derived from cumulative sums of UTF-8 code
points (converted to integers). It is slightly faster than method <code>sha1</code> for
small inputs and emits hashes with a width porportional to the underlying
input's length. It is used for testing purposes internally.
</p>


<hr>
<h2 id='find_source'>Find Source Text</h2><span id='topic+find_source'></span><span id='topic+find_source_in_files'></span>

<h3>Description</h3>

<p>Find and extract source text that must be translated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_source(
  path = ".",
  encoding = "UTF-8",
  verbose = getOption("transltr.verbose", TRUE),
  tr = translator(),
  interface = NULL
)

find_source_in_files(
  paths = character(),
  encoding = "UTF-8",
  verbose = getOption("transltr.verbose", TRUE),
  algorithm = algorithms(),
  interface = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_source_+3A_path">path</code></td>
<td>
<p>A non-empty and non-NA character string. A path to a directory
containing <span class="rlang"><b>R</b></span> source scripts. All subdirectories are searched. Files that
do not have a <code>.R</code>, or <code>.Rprofile</code> extension are skipped.</p>
</td></tr>
<tr><td><code id="find_source_+3A_encoding">encoding</code></td>
<td>
<p>A non-empty and non-NA character string. The source character
encoding. In almost all cases, this should be UTF-8. Other encodings are
internally re-encoded to UTF-8 for portability.</p>
</td></tr>
<tr><td><code id="find_source_+3A_verbose">verbose</code></td>
<td>
<p>A non-NA logical value. Should progress information be
reported?</p>
</td></tr>
<tr><td><code id="find_source_+3A_tr">tr</code></td>
<td>
<p>A <code><a href="#topic+Translator">Translator</a></code> object.</p>
</td></tr>
<tr><td><code id="find_source_+3A_interface">interface</code></td>
<td>
<p>A <code><a href="base.html#topic+name">name</a></code>, a <code><a href="base.html#topic+call">call</a></code> object, or a <code>NULL</code>.
A reference to an alternative (custom) function used to translate text.
If a <code><a href="base.html#topic+call">call</a></code> object is passed to <code>interface</code>, it <strong>must</strong> be to
operator <code>::</code>. Calls to method <code><a href="#topic+Translator">Translator$translate()</a></code>
are ignored and calls to <code>interface</code> are extracted instead. See Details
below.</p>
</td></tr>
<tr><td><code id="find_source_+3A_paths">paths</code></td>
<td>
<p>A character vector of non-empty and non-NA values. A set of
paths to <span class="rlang"><b>R</b></span> source scripts that must be searched.</p>
</td></tr>
<tr><td><code id="find_source_+3A_algorithm">algorithm</code></td>
<td>
<p>A non-empty and non-NA character string equal to <code>"sha1"</code>,
or <code>"utf8"</code>. The algorithm to use when hashing source information for
identification purposes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+find_source">find_source()</a></code> and <code><a href="#topic+find_source_in_files">find_source_in_files()</a></code> look for calls to method
<code><a href="#topic+Translator">Translator$translate()</a></code> in <span class="rlang"><b>R</b></span> scripts and convert them
to <code><a href="#topic+Text">Text</a></code> objects. The former further sets these resulting
objects into a <code><a href="#topic+Translator">Translator</a></code> object. See argument <code>tr</code>.
</p>
<p><code><a href="#topic+find_source">find_source()</a></code> and <code><a href="#topic+find_source_in_files">find_source_in_files()</a></code> work on a purely lexical basis.
The source code is parsed but never evaluated (aside from extracted literal
character vectors).
</p>

<ul>
<li><p> The underlying <code><a href="#topic+Translator">Translator</a></code> object is never evaluated and
does not need to exist (placeholders may be used in the source code).
</p>
</li>
<li><p> Only <strong>literal</strong> character vectors can be passed to arguments of
method <code><a href="#topic+Translator">Translator$translate()</a></code>.
</p>
</li></ul>



<h4>Interfaces</h4>

<p>In some cases, it may not be desirable to call method
<code><a href="#topic+Translator">Translator$translate()</a></code> directly. A custom function wrapping
(<em>interfacing</em>) this method may always be used as long as it has the same
<a href="https://en.wikipedia.org/wiki/Type_signature">signature</a> as method
<code><a href="#topic+Translator">Translator$translate()</a></code>. In other words, it must minimally
have two formal arguments: <code>...</code> and <code>source_lang</code>.
</p>
<p>Custom interfaces must be passed to <code><a href="#topic+find_source">find_source()</a></code> and
<code><a href="#topic+find_source_in_files">find_source_in_files()</a></code> for extraction purposes. Since these functions work
on a lexical basis, interfaces can be placeholders in the source code (non-
existent bindings) at the time these functions are called. However, they must
be bound to a function (ultimately) calling <code><a href="#topic+Translator">Translator$translate()</a></code>
at runtime.
</p>
<p>Custom interfaces are passed to <code><a href="#topic+find_source">find_source()</a></code> and <code><a href="#topic+find_source_in_files">find_source_in_files()</a></code>
as <code><a href="base.html#topic+name">name</a></code> or <code><a href="base.html#topic+call">call</a></code> objects in a variety of ways. The most
straightforward way is to use <code><a href="base.html#topic+substitute">base::quote()</a></code>. See Examples below.
</p>



<h4>Methodology</h4>

<p><code><a href="#topic+find_source">find_source()</a></code> and <code><a href="#topic+find_source_in_files">find_source_in_files()</a></code> go through these steps to
extract source text from a single <span class="rlang"><b>R</b></span> script.
</p>

<ol>
<li><p> It is read with <code><a href="#topic+text_read">text_read()</a></code> and re-encoded to UTF-8 if necessary.
</p>
</li>
<li><p> It is parsed with <code><a href="base.html#topic+parse">parse()</a></code> and underlying tokens are extracted from
parsed expressions with <code><a href="utils.html#topic+getParseData">utils::getParseData()</a></code>.
</p>
</li>
<li><p> Each expression (<code>expr</code>) token is converted to language objects with
<code><a href="base.html#topic+str2lang">str2lang()</a></code>. Parsing errors and invalid expressions are silently
skipped.
</p>
</li>
<li><p> Valid <code><a href="base.html#topic+call">call</a></code> objects stemming from step 3 are filtered with
<code><a href="#topic+is_source">is_source()</a></code>.
</p>
</li>
<li><p> Calls to method <code><a href="#topic+Translator">Translator$translate()</a></code> or to <code>interface</code>
stemming from step 4 are coerced to <code><a href="#topic+Text">Text</a></code> objects with
<code><a href="#topic+as_text">as_text()</a></code>.
</p>
</li></ol>

<p>These steps are repeated for each <span class="rlang"><b>R</b></span> script. <code><a href="#topic+find_source">find_source()</a></code> further merges
all resulting <code><a href="#topic+Text">Text</a></code> objects into a coherent set with <code><a href="#topic+merge_texts">merge_texts()</a></code>
(identical source code is merged into single <code><a href="#topic+Text">Text</a></code> entities).
</p>
<p>Extracted character vectors are always normalized for consistency (at step
5). See <code><a href="#topic+normalize">normalize()</a></code> for more information.
</p>



<h4>Limitations</h4>

<p>The current version of <code><a href="#topic+transltr">transltr</a></code> can only handle <strong>literal</strong>
character vectors. This means it cannot resolve non-trivial expressions
that depends on a <em>state</em>. All values passed to argument <code>...</code> of method
<code><a href="#topic+Translator">Translator$translate()</a></code> must yield character vectors
(trivially).
</p>



<h3>Value</h3>

<p><code><a href="#topic+find_source">find_source()</a></code> returns an <code><a href="R6.html#topic+R6Class">R6</a></code> object of class
<code><a href="#topic+Translator">Translator</a></code>. If an existing <code><a href="#topic+Translator">Translator</a></code>
object is passed to <code>tr</code>, it is modified in place and returned.
</p>
<p><code><a href="#topic+find_source_in_files">find_source_in_files()</a></code> returns a list of <code><a href="#topic+Text">Text</a></code> objects. It may
contain duplicated elements, depending on the extracted contents.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Translator">Translator</a></code>,
<code><a href="#topic+Text">Text</a></code>,
<code><a href="#topic+normalize">normalize()</a></code>,
<code><a href="#topic+translator_read">translator_read()</a></code>,
<code><a href="#topic+translator_write">translator_write()</a></code>,
<code><a href="base.html#topic+substitute">base::quote()</a></code>,
<code><a href="base.html#topic+call">base::call()</a></code>,
<code><a href="base.html#topic+name">base::as.name()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a directory containing dummy R scripts for illustration purposes.
temp_dir   &lt;- file.path(tempdir(TRUE), "find-source")
temp_files &lt;- file.path(temp_dir, c("ex-script-1.R", "ex-script-2.R"))
dir.create(temp_dir, showWarnings = FALSE, recursive = TRUE)

cat(
  "tr$translate('Hello, world!')",
  "tr$translate('Farewell, world!')",
  sep  = "\n",
  file = temp_files[[1L]])
cat(
  "tr$translate('Hello, world!')",
  "tr$translate('Farewell, world!')",
  sep  = "\n",
  file = temp_files[[2L]])

# Extract calls to method Translator$translate().
find_source(temp_dir)
find_source_in_files(temp_files)

# Use custom functions.
# For illustrations purposes, assume the package
# exports an hypothetical translate() function.
cat(
  "translate('Hello, world!')",
  "transtlr::translate('Farewell, world!')",
  sep  = "\n",
  file = temp_files[[1L]])
cat(
  "translate('Hello, world!')",
  "transltr::translate('Farewell, world!')",
  sep  = "\n",
  file = temp_files[[2L]])

# Extract calls to translate() and transltr::translate().
# Since find_source() and find_source_in_files() work on
# a lexical basis, these are always considered to be two
# distinct functions. They also don't need to exist in the
# R session calling find_source() and find_source_in_files().
find_source(temp_dir, interface = quote(translate))
find_source_in_files(temp_files, interface = quote(transltr::translate))

</code></pre>

<hr>
<h2 id='find_source_in_file'>Find Source Text in Expressions</h2><span id='topic+find_source_in_file'></span><span id='topic+find_source_in_exprs'></span><span id='topic+find_source_exprs'></span><span id='topic+is_source'></span>

<h3>Description</h3>

<p>Find and extract source text that must be translated from a single file
or a set of <span class="rlang"><b>R</b></span> <code>expr</code> tokens.
</p>
<p><strong>Arguments listed below are not explicitly validated for efficiency.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_source_in_file(
  path = "",
  encoding = "UTF-8",
  verbose = getOption("transltr.verbose", TRUE),
  algorithm = algorithms(),
  interface = NULL
)

find_source_in_exprs(
  tokens = utils::getParseData(),
  path = "",
  algorithm = algorithms(),
  interface = NULL
)

find_source_exprs(path = "", encoding = "UTF-8")

is_source(x, interface = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_source_in_file_+3A_path">path</code></td>
<td>
<p>A non-empty and non-NA character string. A path to an <span class="rlang"><b>R</b></span> source
script.</p>
</td></tr>
<tr><td><code id="find_source_in_file_+3A_encoding">encoding</code></td>
<td>
<p>A non-empty and non-NA character string. The source character
encoding. In almost all cases, this should be UTF-8. Other encodings are
internally re-encoded to UTF-8 for portability.</p>
</td></tr>
<tr><td><code id="find_source_in_file_+3A_verbose">verbose</code></td>
<td>
<p>A non-NA logical value. Should progress information be
reported?</p>
</td></tr>
<tr><td><code id="find_source_in_file_+3A_algorithm">algorithm</code></td>
<td>
<p>A non-empty and non-NA character string equal to <code>"sha1"</code>,
or <code>"utf8"</code>. The algorithm to use when hashing source information for
identification purposes.</p>
</td></tr>
<tr><td><code id="find_source_in_file_+3A_interface">interface</code></td>
<td>
<p>A <code><a href="base.html#topic+name">name</a></code>, a <code><a href="base.html#topic+call">call</a></code> object, or a <code>NULL</code>.
A reference to an alternative (custom) function used to translate text.
If a <code><a href="base.html#topic+call">call</a></code> object is passed to <code>interface</code>, it <strong>must</strong> be to
operator <code>::</code>. Calls to method <code><a href="#topic+Translator">Translator$translate()</a></code>
are ignored and calls to <code>interface</code> are extracted instead. See Details
below.</p>
</td></tr>
<tr><td><code id="find_source_in_file_+3A_tokens">tokens</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> returned by
<code><a href="utils.html#topic+getParseData">utils::getParseData()</a></code>. It must always minimally contain
columns <code>line1</code>, <code>col1</code>, <code>line2</code>, <code>col2</code>, and <code>text</code>.</p>
</td></tr>
<tr><td><code id="find_source_in_file_+3A_x">x</code></td>
<td>
<p>Any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+find_source_in_exprs">find_source_in_exprs()</a></code> silently skips parsing errors. See <code><a href="#topic+find_source">find_source()</a></code>
for more information.
</p>
<p><code><a href="#topic+is_source">is_source()</a></code> checks if an object conceptually represents a source text.
This can either be
</p>

<ul>
<li><p> a <code><a href="base.html#topic+call">call</a></code> to method <code><a href="#topic+Translator">Translator$translate()</a></code> <strong>or</strong>
</p>
</li>
<li><p> a <code><a href="base.html#topic+call">call</a></code> to a custom function referenced by <code>interface</code>.
</p>
</li></ul>

<p>Calls to method <code><a href="#topic+Translator">Translator$translate()</a></code> that include
<code><a href="base.html#topic+dots">...</a></code> in their argument(s) are ignored. Such calls are part
of the definition of a custom <code>interface</code> and should not be extracted.
</p>


<h3>Value</h3>

<p><code><a href="#topic+find_source_in_file">find_source_in_file()</a></code> and <code><a href="#topic+find_source_in_exprs">find_source_in_exprs()</a></code> return a list of
<code><a href="#topic+Text">Text</a></code> objects. It may contain duplicated elements, depending
on the extracted contents.
</p>
<p><code><a href="#topic+find_source_exprs">find_source_exprs()</a></code> returns a subset of the output of
<code><a href="utils.html#topic+getParseData">utils::getParseData()</a></code>. Only <code>expr</code> tokens are returned.
</p>
<p><code><a href="#topic+is_source">is_source()</a></code> returns a logical value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Text">Text</a></code>,
<code><a href="#topic+find_source">find_source()</a></code>,
<code><a href="utils.html#topic+getParseData">utils::getParseData()</a></code>
</p>

<hr>
<h2 id='flat_serialize'>Serialize Objects to Flat Strings</h2><span id='topic+flat_serialize'></span><span id='topic+flat_deserialize'></span><span id='topic+flat_tag'></span><span id='topic+flat_format'></span><span id='topic+flat_example'></span>

<h3>Description</h3>

<p>Serialize <span class="rlang"><b>R</b></span> objects into textual sequences of unindented (<em>flat</em>) and
identifiable sections. These are called FLAT (1.0) objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flat_serialize(x = list(), tag_sep = ": ", tag_empty = "")

flat_deserialize(string = "", tag_sep = ": ")

flat_tag(x = list(), tag_sep = ": ", tag_empty = "")

flat_format(x = list())

flat_example()
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flat_serialize_+3A_x">x</code></td>
<td>
<p>A list. It can be empty.</p>
</td></tr>
<tr><td><code id="flat_serialize_+3A_tag_sep">tag_sep</code></td>
<td>
<p>A non-empty and non-NA character string. The separator to use
when creating tags from names (recursively) extracted from <code>x</code>.</p>
</td></tr>
<tr><td><code id="flat_serialize_+3A_tag_empty">tag_empty</code></td>
<td>
<p>A non-NA character string. The value to use as a substitute
for empty names. Positional indices are automatically appended to it to
ensure tags are always unique.</p>
</td></tr>
<tr><td><code id="flat_serialize_+3A_string">string</code></td>
<td>
<p>A non-NA character string. It can be empty. Contents to
deserialize.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Flat format (<strong>F</strong>lat <strong>L</strong>ist <strong>A</strong>s <strong>T</strong>ext, or FLAT) is a minimal
textual data serialization format optimized for <span class="rlang"><b>R</b></span> <code><a href="base.html#topic+list">list</a></code> objects.
Elements are converted to character strings and organized into unindented
sections identified by a tag. Call <code><a href="#topic+flat_example">flat_example()</a></code> for a valid example.
</p>
<p><code><a href="#topic+flat_serialize">flat_serialize()</a></code> serializes <code>x</code> into a FLAT object.
</p>
<p><code><a href="#topic+flat_deserialize">flat_deserialize()</a></code> is the inverse operation: it converts a FLAT object
back into a list. The latter has the same shape as the original one, but
</p>

<ul>
<li> <p><a href="base.html#topic+atomic">atomic</a> vectors are not reconstituted (they are deserialized as
elements of length 1), and
</p>
</li>
<li><p> all elements are also left as character strings.
</p>
</li></ul>

<p>The convention is to serialize an empty list to an empty character string.
</p>


<h4>Internal mechanisms</h4>

<p><code><a href="#topic+flat_tag">flat_tag()</a></code> and <code><a href="#topic+flat_format">flat_format()</a></code> are called internally by <code><a href="#topic+flat_serialize">flat_serialize()</a></code>.
Aside from debugging purposes, they should not be called outside of the
former.
</p>
<p><code><a href="#topic+flat_tag">flat_tag()</a></code> creates tags from names extracted from <code>x</code> and formats them.
Tags may not be unique, depending on <code>x</code>'s structure and names.
</p>
<p><code><a href="#topic+flat_format">flat_format()</a></code> recursively formats the elements of <code>x</code> as part of the
serialization process. It
</p>

<ul>
<li><p> converts <code>NULL</code> to the <code>"NULL"</code> character string,
</p>
</li>
<li><p> converts other elements to character strings using <code><a href="base.html#topic+format">format()</a></code> and
</p>
</li>
<li><p> replaces empty lists by a <code style="white-space: pre;">&#8288;&lt;empty list&gt;&#8288;</code> constant treated as a
placeholder.
</p>
</li></ul>




<h3>Value</h3>

<p><code><a href="#topic+flat_serialize">flat_serialize()</a></code> returns a character string, possibly empty.
</p>
<p><code><a href="#topic+flat_deserialize">flat_deserialize()</a></code> returns a named list, possibly empty. Its structure
depends on the underlying tags.
</p>
<p><code><a href="#topic+flat_tag">flat_tag()</a></code> returns a character vector, possibly empty.
</p>
<p><code><a href="#topic+flat_format">flat_format()</a></code> returns an unnamed list having the same <em>shape</em> as <code>x</code>. See
Details.
</p>
<p><code><a href="#topic+flat_example">flat_example()</a></code> returns a character string (a serialized example),
invisibly. It is used for its side-effect of printing an illustration of
the format (with useful information).
</p>

<hr>
<h2 id='format_vector'>Format Vectors</h2><span id='topic+format_vector'></span>

<h3>Description</h3>

<p>Format <a href="base.html#topic+vector">atomic</a> vectors, <a href="base.html#topic+list">lists</a>, and
<a href="base.html#topic+pairlist">pairlists</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_vector(
  x = vector(),
  label = NULL,
  level = 0L,
  indent = 1L,
  fill_names = FALSE,
  null = "&lt;null&gt;",
  empty = "&lt;empty&gt;",
  validate = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_vector_+3A_x">x</code></td>
<td>
<p>A <a href="base.html#topic+vector">vector</a> of any <a href="base.html#topic+vector">atomic</a> mode, a
<a href="base.html#topic+list">list</a>, or a <a href="base.html#topic+pairlist">pairlist</a>. It can be empty
and it can contain NA values.</p>
</td></tr>
<tr><td><code id="format_vector_+3A_label">label</code></td>
<td>
<p>A <code>NULL</code>, or a non-empty and non-NA character string. A top
descriptive label for <code>x</code>. It is used to preserve, and output all names
in recursive calls. The value passed to <code>label</code> is considered to be at
<code>level</code> 0, and is not indented.</p>
</td></tr>
<tr><td><code id="format_vector_+3A_level">level</code></td>
<td>
<p>A non-NA integer value. The current depth, or current
<em>nesting level</em> to use for indentation purposes.</p>
</td></tr>
<tr><td><code id="format_vector_+3A_indent">indent</code></td>
<td>
<p>A non-NA integer value. The number of single space(s) to use
for each <code>level</code> when indenting name/value pairs.</p>
</td></tr>
<tr><td><code id="format_vector_+3A_fill_names">fill_names</code></td>
<td>
<p>A non-NA logical value. Should <code>NULL</code> and empty names
be replaced by names created from the elements' underlying positions?
Positions are relative to each <code>level</code>.</p>
</td></tr>
<tr><td><code id="format_vector_+3A_null">null</code></td>
<td>
<p>A non-empty and non-NA character string. The value to use to
represent <code>NULL</code> and empty parlists (they are conceptually the same thing).</p>
</td></tr>
<tr><td><code id="format_vector_+3A_empty">empty</code></td>
<td>
<p>A non-empty and non-NA character string. The value to use to
represent empty vectors, excluding <code>NULL</code>. See <code>null</code> above for the latter.
The <a href="base.html#topic+typeof">type</a> of the underlying empty object is added to <code>empty</code>
for convenience. See Examples below.</p>
</td></tr>
<tr><td><code id="format_vector_+3A_validate">validate</code></td>
<td>
<p>A non-NA logical value. Should the arguments be validated
before being used? This argument should be left as is.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+format_vector">format_vector()</a></code> is an alternative to <code><a href="utils.html#topic+str">utils::str()</a></code> that exposes a much
simpler generic formatting interface and yields terser outputs of name/value
pairs. Indentation is used for nested values.
</p>
<p><code><a href="#topic+format_vector">format_vector()</a></code> does not attempt to cover all <span class="rlang"><b>R</b></span> objects like
<code><a href="utils.html#topic+str">utils::str()</a></code>. Instead, it (merely) focuses on efficiently handling the
types used by <code><a href="#topic+transltr">transltr</a></code>. It is the low-level <em>workhorse</em> function of
<code><a href="#topic+format.Translator">format.Translator()</a></code>, <code><a href="#topic+format.Text">format.Text()</a></code>, and <code><a href="#topic+format.Location">format.Location()</a></code>.
</p>


<h3>Value</h3>

<p>A character vector, possibly trimmed by <code><a href="#topic+str_trim">str_trim()</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+str_trim">str_trim()</a></code>
</p>
<p>Other utility functions: 
<code><a href="#topic+stops">stops</a>()</code>,
<code><a href="#topic+str_to">str_to</a>()</code>,
<code><a href="#topic+vapply_1l">vapply_1l</a>()</code>
</p>

<hr>
<h2 id='hash'>Hashing</h2><span id='topic+hash'></span>

<h3>Description</h3>

<p>Map an arbitrary character string to a shorter string of hexadecimal
characters highly likely to be unique. It typically has a fixed width.
</p>
<p><strong>Arguments listed below are not validated for efficiency.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hash(lang = "", text = "", algorithm = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hash_+3A_lang">lang</code></td>
<td>
<p>A non-empty and non-NA character string. The underlying language.
</p>
<p>A language is usually a code (of two or three letters) for a native
language name. While users retain full control over codes, it is best
to use language codes stemming from well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>
to maximize portability and cross-compatibility.</p>
</td></tr>
<tr><td><code id="hash_+3A_text">text</code></td>
<td>
<p>A non-NA character string. It can be empty.</p>
</td></tr>
<tr><td><code id="hash_+3A_algorithm">algorithm</code></td>
<td>
<p>A non-empty and non-NA character string equal to <code>"sha1"</code>,
or <code>"utf8"</code>. The algorithm to use when hashing source information for
identification purposes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Hashes generated by <code><a href="#topic+hash">hash()</a></code> uniquely identify the <code>lang</code> and <code>text</code> pair.
Values passed to these arguments are concatenated with a colon character for
hashing purposes.
</p>


<h3>Value</h3>

<p><code><a href="#topic+hash">hash()</a></code> returns a character string, or <code>NULL</code> if <code>algorithm</code> is not
supported.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Translator">Translator</a></code>,
<code><a href="#topic+Text">Text</a></code>,
<code><a href="#topic+normalize">normalize()</a></code>,
<code><a href="#topic+algorithms">algorithms()</a></code>
</p>

<hr>
<h2 id='is_int'>Assertions</h2><span id='topic+is_int'></span><span id='topic+is_chr'></span><span id='topic+is_lgl1'></span><span id='topic+is_int1'></span><span id='topic+is_chr1'></span><span id='topic+is_list'></span><span id='topic+is_between'></span><span id='topic+is_named'></span><span id='topic+is_match'></span><span id='topic+assert_int'></span><span id='topic+assert_chr'></span><span id='topic+assert_lgl1'></span><span id='topic+assert_int1'></span><span id='topic+assert_chr1'></span><span id='topic+assert_list'></span><span id='topic+assert_between'></span><span id='topic+assert_named'></span><span id='topic+assert_match'></span><span id='topic+assert_arg'></span><span id='topic+assert'></span><span id='topic+assert.default'></span>

<h3>Description</h3>

<p>These functions are a functional implementation of defensive programming.
</p>
<p><code style="white-space: pre;">&#8288;is_*()&#8288;</code> functions check whether their argument meets certain criteria.
</p>
<p><code style="white-space: pre;">&#8288;assert_*()&#8288;</code> functions further throw an error message when at least one
criterion is not met.
</p>
<p><strong>Arguments listed below are not explicitly validated for efficiency.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_int(x, allow_empty = FALSE)

is_chr(x, allow_empty = FALSE)

is_lgl1(x)

is_int1(x)

is_chr1(x, allow_empty_string = FALSE)

is_list(x, allow_empty = FALSE)

is_between(x, min = -Inf, max = Inf)

is_named(x, allow_empty_names = FALSE, allow_na_names = FALSE)

is_match(x, choices = vector(), allow_partial = FALSE)

assert_int(
  x,
  allow_empty = FALSE,
  throw_error = TRUE,
  x_name = deparse(substitute(x))
)

assert_chr(
  x,
  allow_empty = FALSE,
  throw_error = TRUE,
  x_name = deparse(substitute(x))
)

assert_lgl1(x, throw_error = TRUE, x_name = deparse(substitute(x)))

assert_int1(x, throw_error = TRUE, x_name = deparse(substitute(x)))

assert_chr1(
  x,
  allow_empty_string = FALSE,
  throw_error = TRUE,
  x_name = deparse(substitute(x))
)

assert_list(
  x,
  allow_empty = FALSE,
  throw_error = TRUE,
  x_name = deparse(substitute(x))
)

assert_between(
  x,
  min = -Inf,
  max = Inf,
  throw_error = TRUE,
  x_name = deparse(substitute(x))
)

assert_named(
  x,
  allow_empty_names = FALSE,
  allow_na_names = FALSE,
  throw_error = TRUE,
  x_name = deparse(substitute(x))
)

assert_match(
  x,
  choices,
  allow_partial = FALSE,
  quote_values = FALSE,
  throw_error = TRUE,
  x_name = deparse(substitute(x))
)

assert_arg(x, quote_values = FALSE, throw_error = TRUE)

assert(x, ...)

## Default S3 method:
assert(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_int_+3A_x">x</code></td>
<td>
<p>Any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="is_int_+3A_allow_empty">allow_empty</code></td>
<td>
<p>A non-NA logical value. Should vectors of length 0 be
considered as valid values?</p>
</td></tr>
<tr><td><code id="is_int_+3A_allow_empty_string">allow_empty_string</code></td>
<td>
<p>A non-NA logical value. Should empty character
strings be considered as valid values?</p>
</td></tr>
<tr><td><code id="is_int_+3A_min">min</code></td>
<td>
<p>A non-NA numeric lower bound. It can be infinite.</p>
</td></tr>
<tr><td><code id="is_int_+3A_max">max</code></td>
<td>
<p>A non-NA numeric upper bound. It can be infinite.</p>
</td></tr>
<tr><td><code id="is_int_+3A_allow_empty_names">allow_empty_names</code></td>
<td>
<p>A non-NA logical value. Should empty character
strings be considered as valid names? This is different from having no
names at all.</p>
</td></tr>
<tr><td><code id="is_int_+3A_allow_na_names">allow_na_names</code></td>
<td>
<p>A non-NA logical value. Should NA values be considered
as valid names?</p>
</td></tr>
<tr><td><code id="is_int_+3A_choices">choices</code></td>
<td>
<p>A non-empty <a href="base.html#topic+vector">vector</a> of valid candidates.</p>
</td></tr>
<tr><td><code id="is_int_+3A_allow_partial">allow_partial</code></td>
<td>
<p>A non-NA logical value. Should <code>x</code> be partially matched?</p>
</td></tr>
<tr><td><code id="is_int_+3A_throw_error">throw_error</code></td>
<td>
<p>A non-NA logical value. Should an error be thrown? If so,
<code><a href="#topic+stops">stops()</a></code> is called. Otherwise, error messages are returned as a character
vector (possibly empty).</p>
</td></tr>
<tr><td><code id="is_int_+3A_x_name">x_name</code></td>
<td>
<p>A non-empty and non-NA character string. The name of <code>x</code>.</p>
</td></tr>
<tr><td><code id="is_int_+3A_quote_values">quote_values</code></td>
<td>
<p>A non-NA logical value. Passed as is to <code><a href="#topic+str_to">str_to()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Guard clauses tend to be verbose and recycled many times within a project.
This makes it hard to keep error messages consistent over time. <code style="white-space: pre;">&#8288;assert_*()&#8288;</code>
functions encapsulate usual guard clause into simple semantic functions.
This reduces code repetition and number of required unit tests. See
Examples below.
</p>
<p>By convention, NA values are <strong>always</strong> disallowed.
</p>
<p><code><a href="#topic+assert_arg">assert_arg()</a></code> is a partial refactoring of <code><a href="base.html#topic+match.arg">base::match.arg()</a></code>. It relies
on <code><a href="#topic+assert_match">assert_match()</a></code> internally and does not have an equivalent <code>is_arg()</code>
function. It must be called within another function.
</p>
<p><code><a href="#topic+assert">assert()</a></code> is a S3 generic function that covers specific data structures.
Classes (and underlying objects) that do not have an <code><a href="#topic+assert">assert()</a></code> method are
considered to be valid by default.
</p>


<h3>Value</h3>

<p><code><a href="#topic+is_int">is_int()</a></code>,
<code><a href="#topic+is_chr">is_chr()</a></code>,
<code><a href="#topic+is_lgl1">is_lgl1()</a></code>,
<code><a href="#topic+is_int1">is_int1()</a></code>,
<code><a href="#topic+is_chr1">is_chr1()</a></code>,
<code><a href="#topic+is_list">is_list()</a></code>,
<code><a href="#topic+is_between">is_between()</a></code>,
<code><a href="#topic+is_named">is_named()</a></code>, and
<code><a href="#topic+is_match">is_match()</a></code> return a logical value.
</p>
<p><code><a href="#topic+assert">assert()</a></code>,
<code><a href="#topic+assert_int">assert_int()</a></code>,
<code><a href="#topic+assert_chr">assert_chr()</a></code>,
<code><a href="#topic+assert_lgl1">assert_lgl1()</a></code>,
<code><a href="#topic+assert_int1">assert_int1()</a></code>,
<code><a href="#topic+assert_chr1">assert_chr1()</a></code>,
<code><a href="#topic+assert_list">assert_list()</a></code>,
<code><a href="#topic+assert_between">assert_between()</a></code>,
<code><a href="#topic+assert_named">assert_named()</a></code>,
<code><a href="#topic+assert_match">assert_match()</a></code>, and
<code><a href="#topic+assert_arg">assert_arg()</a></code> return an empty character vector if <code>x</code> meets the underlying
criteria and throw an error otherwise. If <code>throw_error</code> is <code>FALSE</code>, the
error message is returned as a character vector. Unless otherwise stated,
the latter is of length 1 (a character string).
</p>
<p><code><a href="#topic+assert.default">assert.default()</a></code> always returns an empty character vector.
</p>

<hr>
<h2 id='language_set'>Get or Set Language</h2><span id='topic+language_set'></span><span id='topic+language_get'></span><span id='topic+language_source_set'></span><span id='topic+language_source_get'></span>

<h3>Description</h3>

<p>Get or set the current, and source languages.
</p>
<p>They are registered as environment variables named
<code>TRANSLTR_LANGUAGE</code>, and <code>TRANSLTR_SOURCE_LANGUAGE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>language_set(lang = "en")

language_get()

language_source_set(lang = "en")

language_source_get()
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="language_set_+3A_lang">lang</code></td>
<td>
<p>A non-empty and non-NA character string. The underlying language.
</p>
<p>A language is usually a code (of two or three letters) for a native
language name. While users retain full control over codes, it is best
to use language codes stemming from well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>
to maximize portability and cross-compatibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The language and the source language can always be temporarily changed. See
argument <code>lang</code> of method <code><a href="#topic+Translator">Translator$translate()</a></code> for more
information.
</p>
<p>The underlying locale is left as is. To change an <span class="rlang"><b>R</b></span> session's locale,
use <code><a href="base.html#topic+Sys.setlocale">Sys.setlocale()</a></code> or <code><a href="base.html#topic+Sys.setLanguage">Sys.setLanguage()</a></code> instead. See below for more
information.
</p>


<h3>Value</h3>

<p><code><a href="#topic+language_set">language_set()</a></code>, and <code><a href="#topic+language_source_set">language_source_set()</a></code> return <code>NULL</code>, invisibly. They
are used for their side-effect of setting environment variables
<code>TRANSLTR_LANGUAGE</code> and <code>TRANSLTR_SOURCE_LANGUAGE</code>, respectively.
</p>
<p><code><a href="#topic+language_get">language_get()</a></code> returns a character string. It is the current value of
environment variable <code>TRANSLTR_LANGUAGE</code>. It is empty if the latter is
unset.
</p>
<p><code><a href="#topic+language_source_get">language_source_get()</a></code> returns a character string. It is the current value
of environment variable <code>TRANSLTR_SOURCE_LANGUAGE</code>. It returns <code>"en"</code> if the
latter is unset.
</p>


<h3>Locales versus languages</h3>

<p>A <a href="https://en.wikipedia.org/wiki/Locale_(computer_software)">locale</a> is a
set of multiple low-level settings that relate to the user's language and
region. The <em>language</em> itself is just one parameter among many others.
</p>
<p>Modifying a locale on-the-fly <em>can</em> be considered risky in some situations.
It may not be the optimal solution for merely changing textual representations
of a program or an application at runtime, as it may introduce unintended
changes and induce subtle bugs that are harder to fix.
</p>
<p>Moreover, it makes sense for some applications and/or programs such as
<a href="https://shiny.posit.co/">Shiny applications</a> to decouple the front-end's
current language (what <em>users</em> see) from the back-end's locale (what
<em>developers</em> see). A UI may be displayed in a certain language while keeping
logs and <span class="rlang"><b>R</b></span> internal <a href="base.html#topic+message">messages</a>, <a href="base.html#topic+warning">warnings</a>, and
<a href="base.html#topic+stop">errors</a> as is.
</p>
<p>Consequently, the language setting of <code><a href="#topic+transltr">transltr</a></code> is purposely
kept separate from the underlying locale and removes the complexity of
having to support many of them. Users can always change both the locale and
the <code>language</code> parameter of the package. See Examples.
</p>


<h3>Note</h3>

<p>Environment variables are used because they can be shared among different
processes. This matters when using parallel and/or concurrent <span class="rlang"><b>R</b></span> sessions.
It can further be shared among direct and transitive dependencies (other
packages that rely on <code><a href="#topic+transltr">transltr</a></code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Change the language parameters (globally).
language_source_set("en")
language_set("fr")

language_source_get()  ## Outputs "en"
language_get()         ## Outputs "fr"

# Change both the language parameter and the locale.
# Note that while users control how languages are named
# for language_set(), they do not for Sys.setLanguage().
language_set("fr")
Sys.setLanguage("fr-CA")

# Reset settings.
language_source_set(NULL)
language_set(NULL)

# Source language has a default value.
language_source_get()  ## Outputs "en"

</code></pre>

<hr>
<h2 id='location'>Source Locations</h2><span id='topic+location'></span><span id='topic+Location'></span><span id='topic+is_location'></span><span id='topic+format.Location'></span><span id='topic+print.Location'></span><span id='topic+c.Location'></span><span id='topic+merge_locations'></span>

<h3>Description</h3>

<p>Structure and manipulate source locations. Class <code><a href="#topic+Location">Location</a></code> is
a lighter alternative to <code><a href="base.html#topic+srcfile">srcfile()</a></code> and other related functionalities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>location(path = tempfile(), line1 = 1L, col1 = 1L, line2 = 1L, col2 = 1L)

is_location(x)

## S3 method for class 'Location'
format(x, ...)

## S3 method for class 'Location'
print(x, ...)

## S3 method for class 'Location'
c(...)

merge_locations(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="location_+3A_path">path</code></td>
<td>
<p>A non-empty and non-NA character string. The origin of the ranges.</p>
</td></tr>
<tr><td><code id="location_+3A_line1">line1</code>, <code id="location_+3A_col1">col1</code></td>
<td>
<p>A non-empty integer vector of non-NA values. The
(inclusive) starting point(s) of what is being referenced.</p>
</td></tr>
<tr><td><code id="location_+3A_line2">line2</code>, <code id="location_+3A_col2">col2</code></td>
<td>
<p>A non-empty integer vector of non-NA values. The
(inclusive) end(s) of what is being referenced.</p>
</td></tr>
<tr><td><code id="location_+3A_x">x</code></td>
<td>
<p>Any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="location_+3A_...">...</code></td>
<td>
<p>Usage depends on the underlying function.
</p>

<ul>
<li><p> Any number of <code><a href="#topic+Location">Location</a></code> objects for <code><a href="#topic+merge_locations">merge_locations()</a></code>
and S3 method <code><a href="base.html#topic+c">c()</a></code>.
</p>
</li>
<li><p> Further arguments passed to or from other methods for <code><a href="base.html#topic+format">format()</a></code> and
<code><a href="base.html#topic+print">print()</a></code>.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code><a href="#topic+Location">Location</a></code> is a set of one or more line/column ranges
referencing contents (like text or source code) within a common <em>origin</em>
identified by an underlying <code>path</code>. The latter is generic and can be
<em>anything</em>: a file on disk, on a network, a pointer, a binding, etc. What
matters is the underlying context.
</p>
<p><code><a href="#topic+Location">Location</a></code> objects may refer to multiple distinct ranges for
the the same origin. This is why arguments <code>line1</code>, <code>col1</code>, <code>line2</code> and
<code>col2</code> accept integer vectors (and not only scalar values).
</p>


<h4>Combining Location Objects</h4>

<p><code><a href="base.html#topic+c">c()</a></code> can only combine <code><a href="#topic+Location">Location</a></code> objects having the same
<code>path</code>. In that case, the underlying ranges are combined into a set of
non-duplicated range(s).
</p>
<p><code><a href="#topic+merge_locations">merge_locations()</a></code> is a generalized version of <code><a href="base.html#topic+c">c()</a></code> that handles any
number of <code><a href="#topic+Location">Location</a></code> objects having possibly different paths.
It can be viewed as a vectorized version of <code><a href="base.html#topic+c">c()</a></code>.
</p>



<h3>Value</h3>

<p><code><a href="#topic+location">location()</a></code>, and <code><a href="base.html#topic+c">c()</a></code> return a named list of length 5 and of S3 class
<code><a href="#topic+Location">Location</a></code> containing the values of <code>path</code>, <code>line1</code>, <code>col1</code>,
<code>line2</code>, and <code>col2</code>.
</p>
<p><code><a href="#topic+is_location">is_location()</a></code> returns a logical value.
</p>
<p><code><a href="base.html#topic+format">format()</a></code> returns a character vector.
</p>
<p><code><a href="base.html#topic+print">print()</a></code> returns argument <code>x</code> invisibly.
</p>
<p><code><a href="#topic+merge_locations">merge_locations()</a></code> returns a list of (combined) <code><a href="#topic+Location">Location</a></code>
objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create Location objects.
loc1 &lt;- location("file-a", 1L, 2L, 3L, 4L)
loc2 &lt;- location("file-a", 5L, 6L, 7L, 8L)
loc3 &lt;- location("file-c", c(9L, 10L), c(11L, 12L), c(13L, 14L), c(15L, 16L))

is_location(loc1)  ## TRUE

print(loc1)
print(loc2)
print(loc3)

# Combine Location objects.
# c() throws an error if they do not have the same path.
c(loc1, loc2)

# Location objects with different paths can be merged.
# This groups Location objects according to their paths
# and calls c() on each group. It returns a list.
merge_locations(loc1, loc2, loc3)

# The path of a Location object can be whatever fits the context.
# Below is an example that references text in a character vector
# bound to variable x in the global environment.
x &lt;- "This is a string and it is held in memory for some purpose."
location("&lt;environment: R_GlobalEnv: x&gt;", 1L, 11L, 1L, 16L)

</code></pre>

<hr>
<h2 id='normalize'>Normalize Text</h2><span id='topic+normalize'></span>

<h3>Description</h3>

<p>Construct a standardized string from values passed to <code>...</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="normalize_+3A_...">...</code></td>
<td>
<p>Any number of vectors containing <a href="base.html#topic+atomic">atomic</a> elements. Each vector
is normalized as a paragraph.
</p>

<ul>
<li><p> Elements are coerced to character values.
</p>
</li>
<li><p> NA values and empty strings are discarded.
</p>
</li>
<li><p> Multi-line strings are supported and encouraged. Blank lines are
interpreted (two or more newline characters) as paragraph separators.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>Input text can written in a variety of ways using single-line and multi-line
strings. Values passed to <code>...</code> are normalized (to ensure their consistency)
and collapsed to a single character string using the standard paragraph
separator. The latter is defined as two newline characters (<code>"\n\n"</code>).
</p>

<ol>
<li><p> NA values and empty strings are discarded before reducing <code>...</code> to a
character string.
</p>
</li>
<li><p> Whitespaces (tabs, newlines, and repeated spaces) characters are
replaced by a single space. Paragraph separators are preserved.
</p>
</li>
<li><p> Leading or trailing whitespaces are stripped.
</p>
</li></ol>



<h3>Value</h3>

<p>A character string, possibly empty.
</p>

<hr>
<h2 id='range_format'>Source Ranges</h2><span id='topic+range_format'></span><span id='topic+range_parse'></span><span id='topic+range_is_parseable'></span>

<h3>Description</h3>

<p>Create, parse, and validate source ranges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>range_format(x = location())

range_parse(ranges = character())

range_is_parseable(ranges = character())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="range_format_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+Location">Location</a></code> object.</p>
</td></tr>
<tr><td><code id="range_format_+3A_ranges">ranges</code></td>
<td>
<p>A character vector of non-NA and non-empty values.
The ranges to extract pairs of indices (line, column) from.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ranges are <code style="white-space: pre;">&#8288;Ln &lt;int&gt;, Col &lt;int&gt; @ Ln &lt;int&gt;, Col &lt;int&gt;&#8288;</code> strings created on-the-fly from
<code><a href="#topic+Location">Location</a></code> objects for outputting purposes.
</p>


<h3>Value</h3>

<p><code><a href="#topic+range_format">range_format()</a></code> returns a character vector. It assumes that <code>x</code> is valid.
</p>
<p><code><a href="#topic+range_parse">range_parse()</a></code> returns a list having the same length as <code>ranges</code>. Each
element is an integer vectors containing 4 non-NA values (unless the
underlying range is invalid).
</p>
<p><code><a href="#topic+range_is_parseable">range_is_parseable()</a></code> returns a logical vector having the same length as
<code>ranges</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Location">Location</a></code>,
<code><a href="#topic+ExportedLocation">ExportedLocation</a></code>,
</p>

<hr>
<h2 id='serialize'>Serialize Objects</h2><span id='topic+serialize'></span><span id='topic+ExportedTranslator'></span><span id='topic+ExportedText'></span><span id='topic+ExportedLocation'></span><span id='topic+ExportedTranslations'></span><span id='topic+serialize_translations'></span><span id='topic+deserialize'></span><span id='topic+deserialize_translations'></span><span id='topic+export_translations'></span><span id='topic+export'></span><span id='topic+export.Translator'></span><span id='topic+export.Text'></span><span id='topic+export.Location'></span><span id='topic+assert.ExportedTranslator'></span><span id='topic+assert.ExportedText'></span><span id='topic+assert.ExportedLocation'></span><span id='topic+assert.ExportedTranslations'></span><span id='topic+import'></span><span id='topic+import.ExportedTranslator'></span><span id='topic+import.ExportedText'></span><span id='topic+import.ExportedLocation'></span><span id='topic+import.ExportedTranslations'></span><span id='topic+import.default'></span><span id='topic+format_errors'></span>

<h3>Description</h3>

<p>Convert <code><a href="#topic+Translator">Translator</a></code> objects, <code><a href="#topic+Text">Text</a></code> objects, and
<code><a href="#topic+Location">Location</a></code> objects to a <a href="yaml.html#topic+as.yaml">YAML</a> object, or
vice-versa.
</p>
<p>Convert translations contained by a <code><a href="#topic+Translator">Translator</a></code> object to
a custom textual representation (a <a href="#topic+flat_serialize">FLAT</a> object), or
vive-versa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>serialize(x, ...)

serialize_translations(tr = translator(), lang = "")

deserialize(string = "")

deserialize_translations(string = "", tr = NULL)

export_translations(tr = translator(), lang = "")

export(x, ...)

## S3 method for class 'Translator'
export(x, ...)

## S3 method for class 'Text'
export(x, id = uuid(), set_translations = FALSE, ...)

## S3 method for class 'Location'
export(x, id = uuid(), ...)

## S3 method for class 'ExportedTranslator'
assert(x, throw_error = TRUE, ...)

## S3 method for class 'ExportedText'
assert(x, throw_error = TRUE, ...)

## S3 method for class 'ExportedLocation'
assert(x, throw_error = TRUE, ...)

## S3 method for class 'ExportedTranslations'
assert(x, throw_error = TRUE, ...)

import(x, ...)

## S3 method for class 'ExportedTranslator'
import(x, ...)

## S3 method for class 'ExportedText'
import(x, ...)

## S3 method for class 'ExportedLocation'
import(x, ...)

## S3 method for class 'ExportedTranslations'
import(x, tr = NULL, ...)

## Default S3 method:
import(x, ...)

format_errors(errors = character(), id = uuid(), throw_error = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="serialize_+3A_x">x</code></td>
<td>
<p>Any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="serialize_+3A_...">...</code></td>
<td>
<p>Further arguments passed to, or from other methods.</p>
</td></tr>
<tr><td><code id="serialize_+3A_tr">tr</code></td>
<td>
<p>A <code><a href="#topic+Translator">Translator</a></code> object.
</p>
<p>This argument is <code>NULL</code> by default for <code><a href="#topic+deserialize_translations">deserialize_translations()</a></code> and
<code><a href="#topic+import.ExportedTranslations">import.ExportedTranslations()</a></code>. If a <code><a href="#topic+Translator">Translator</a></code> object
is passed to these functions, they will import translations and further
register them (as long as they correspond to an existing source text).</p>
</td></tr>
<tr><td><code id="serialize_+3A_lang">lang</code></td>
<td>
<p>A non-empty and non-NA character string. The underlying language.
</p>
<p>A language is usually a code (of two or three letters) for a native
language name. While users retain full control over codes, it is best
to use language codes stemming from well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>
to maximize portability and cross-compatibility.</p>
</td></tr>
<tr><td><code id="serialize_+3A_string">string</code></td>
<td>
<p>A non-empty and non-NA character string. Contents
to deserialize.</p>
</td></tr>
<tr><td><code id="serialize_+3A_id">id</code></td>
<td>
<p>A non-empty and non-NA character string. A unique identifier for
the underlying object. It is used for validation purposes.</p>
</td></tr>
<tr><td><code id="serialize_+3A_set_translations">set_translations</code></td>
<td>
<p>A non-NA logical value. Should translations be
included in the resulting <code><a href="#topic+export">ExportedText</a></code> object? If <code>FALSE</code>,
field <code>Translations</code> is set equal to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="serialize_+3A_throw_error">throw_error</code></td>
<td>
<p>A non-NA logical value. Should an error be thrown? If so,
<code><a href="#topic+stops">stops()</a></code> is called. Otherwise, error messages are returned as a character
vector (possibly empty).</p>
</td></tr>
<tr><td><code id="serialize_+3A_errors">errors</code></td>
<td>
<p>A non-empty character vector of non-NA values. Error
message(s) describing why object(s) are invalid.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The information contained within a <code><a href="#topic+Translator">Translator</a></code> object is
split by default. Unless <code>set_translations</code> is <code>TRUE</code>, translations are
serialized independently from other fields. This is useful when creating
Translator files and translations files.
</p>
<p>While <code><a href="#topic+serialize">serialize()</a></code> and <code><a href="#topic+serialize_translations">serialize_translations()</a></code> are distinct, they share
a common <em>design</em> and perform the same <em>thing</em>, at least conceptually. The
same is true for <code><a href="#topic+deserialize">deserialize()</a></code> and <code><a href="#topic+deserialize_translations">deserialize_translations()</a></code>. These 4
functions are those that should be used in almost all circumstances.
</p>


<h4>Serialization</h4>

<p>The data serialization process performed by <code><a href="#topic+serialize">serialize()</a></code> and
<code><a href="#topic+serialize_translations">serialize_translations()</a></code> is internally broken down into 2 steps: objects
are first <em>exported</em> before being <em>serialized</em>.
</p>
<p><code><a href="#topic+export">export()</a></code> and <code><a href="#topic+export_translations">export_translations()</a></code> are <em>preserializing mechanisms</em> that
convert objects into <em>transient</em> objects that ease the conversion process.
They are never returned to the user: <code><a href="#topic+serialize">serialize()</a></code>, and
<code><a href="#topic+serialize_translations">serialize_translations()</a></code> immediately transform them into character strings.
</p>
<p><code><a href="#topic+serialize">serialize()</a></code> returns a <a href="yaml.html#topic+as.yaml">YAML object</a>.
</p>
<p><code><a href="#topic+serialize_translations">serialize_translations()</a></code> returns a <a href="#topic+flat_serialize">FLAT object</a>.
</p>



<h4>Deserialization</h4>

<p>The data deserialization process performed by <code><a href="#topic+deserialize">deserialize()</a></code> and
<code><a href="#topic+deserialize_translations">deserialize_translations()</a></code> is internally broken down into 3 steps: objects
are first <em>deserialized</em>, then <em>validated</em> and finally, <em>imported</em>.
</p>
<p><code><a href="#topic+deserialize">deserialize()</a></code> and <code><a href="#topic+deserialize_translations">deserialize_translations()</a></code> are
<em>raw deserializer mechanisms</em>: <code>string</code> is converted into an <span class="rlang"><b>R</b></span> named list
that is <strong>presumed</strong> to be an <em>exported</em> object. <code><a href="#topic+deserialize">deserialize()</a></code> relies on
<a href="https://yaml.org/spec/1.1/#id858600">YAML tags</a> to infer the class of each
object.
</p>
<p>The contents of the <em>transient</em> objects is thoroughly checked with an
<code><a href="#topic+assert">assert()</a></code> method (based on the underlying presumed class). Valid objects
are <em>imported</em> back into an appropriate <span class="rlang"><b>R</b></span> object with <code><a href="#topic+import">import()</a></code>.
</p>
<p>Custom fields and comments added by users to serialized objects are ignored.
</p>



<h4>Formatting errors</h4>

<p><code><a href="#topic+assert">assert()</a></code> methods accumulate error messages before returning, or throwing
them. <code><a href="#topic+format_errors">format_errors()</a></code> is a helper function that eases this process. It
exists to avoid repeting code in each method. There is no reason to call
it outside of <code><a href="#topic+assert">assert()</a></code> methods.
</p>



<h3>Value</h3>

<p>See other sections for further information.
</p>
<p><code><a href="#topic+serialize">serialize()</a></code>, and <code><a href="#topic+serialize_translations">serialize_translations()</a></code> return a character string.
</p>
<p><code><a href="#topic+export">export()</a></code> returns a named list of S3 class
</p>

<ul>
<li> <p><code><a href="#topic+export">ExportedTranslator</a></code> if <code>x</code> is a <code><a href="#topic+Translator">Translator</a></code>
object,
</p>
</li>
<li> <p><code><a href="#topic+export">ExportedText</a></code> if <code>x</code> is a <code><a href="#topic+Text">Text</a></code> object, or
</p>
</li>
<li> <p><code><a href="#topic+export">ExportedLocation</a></code> if <code>x</code> is a <code><a href="#topic+Location">Location</a></code> object.
</p>
</li></ul>

<p><code><a href="#topic+export_translations">export_translations()</a></code> returns an <code><a href="#topic+export">ExportedTranslations</a></code> object.
</p>
<p><code><a href="#topic+deserialize">deserialize()</a></code> and <code><a href="#topic+import">import()</a></code> return
</p>

<ul>
<li><p> a <code><a href="#topic+Translator">Translator</a></code> object if <code>x</code> is a valid
<code><a href="#topic+export">ExportedTranslator</a></code> object,
</p>
</li>
<li><p> a <code><a href="#topic+Text">Text</a></code> object if <code>x</code> is a valid <code><a href="#topic+export">ExportedText</a></code>
object, or
</p>
</li>
<li><p> a <code><a href="#topic+Location">Location</a></code> object if <code>x</code> a valid
<code><a href="#topic+export">ExportedLocation</a></code> object.
</p>
</li></ul>

<p><code><a href="#topic+deserialize_translations">deserialize_translations()</a></code> and <code><a href="#topic+import.ExportedTranslations">import.ExportedTranslations()</a></code> return an
<code><a href="#topic+export">ExportedTranslations</a></code> object. They further register imported
translations if a <code><a href="#topic+Translator">Translator</a></code> object is passed to <code>tr</code>.
</p>

<ul>
<li><p> Translations must correspond to an existing source text (a registered
<code><a href="#topic+Text">Text</a></code> object). Otherwise, they are skipped.
</p>
</li>
<li><p> The value passed to <code>tr</code> is updated <strong>by reference</strong> and is not returned.
</p>
</li></ul>

<p><code><a href="#topic+import.default">import.default()</a></code> is used for its side-effect of throwing an error for
unsupported objects.
</p>
<p><code><a href="#topic+assert.ExportedTranslator">assert.ExportedTranslator()</a></code>,
<code><a href="#topic+assert.ExportedText">assert.ExportedText()</a></code>,
<code><a href="#topic+assert.ExportedLocation">assert.ExportedLocation()</a></code>, and
<code><a href="#topic+assert.ExportedTranslations">assert.ExportedTranslations()</a></code> return a character vector, possibly empty.
If <code>throw_error</code> is <code>TRUE</code>, an error is thrown if an object is invalid.
</p>
<p><code><a href="#topic+format_errors">format_errors()</a></code> returns a character vector, and outputs its contents as
an error if <code>throw_error</code> is <code>TRUE</code>.
</p>


<h3>Exported Objects</h3>

<p>An exported object is a named list of S3 class
<code><a href="#topic+export">ExportedTranslator</a></code>,
<code><a href="#topic+export">ExportedText</a></code>,
<code><a href="#topic+export">ExportedLocation</a></code>, or
<code><a href="#topic+export">ExportedTranslations</a></code> and
always having a <code>tag</code> attribute whose value is equal to the super-class of
<code>x</code>.
</p>
<p>There are four main differences between an object and its <em>exported</em>
counterpart.
</p>

<ol>
<li><p> Field names are slightly more verbose.
</p>
</li>
<li><p> Source text is treated independently from translations.
</p>
</li>
<li><p> Unset fields are set equal to <code>NULL</code> (a <code>~</code> in YAML).
</p>
</li>
<li><p> Each object has an <code>Identifier</code> used to locate errors.
</p>
</li></ol>

<p>The correspondance between objects is self-explanatory.
</p>

<ul>
<li><p> See class <code><a href="#topic+Translator">Translator</a></code> for more information on class
<code><a href="#topic+export">ExportedTranslator</a></code>.
</p>
</li>
<li><p> See class <code><a href="#topic+Text">Text</a></code> for more information on class
<code><a href="#topic+export">ExportedText</a></code>.
</p>
</li>
<li><p> See class <code><a href="#topic+Location">Location</a></code> for more information on class
<code><a href="#topic+export">ExportedLocation</a></code>.
</p>
</li></ul>

<p>You may also explore provided examples below.
</p>


<h4>The <code>ExportedTranslations</code> Class</h4>

<p><code><a href="#topic+export">ExportedTranslations</a></code> objects are created from a
<code><a href="#topic+Translator">Translator</a></code> object with <code><a href="#topic+export_translations">export_translations()</a></code>. Their purpose
is to restructure translations by language. They are different from other
exported objects because there is no corresponding <code>Translations</code> class.
</p>
<p>An <code><a href="#topic+export">ExportedTranslations</a></code> object is a named list of S3 class
<code><a href="#topic+export">ExportedTranslations</a></code> containing the following elements.
</p>

<dl>
<dt><code>Identifier</code></dt><dd><p>The unique identifier of argument <code>tr</code>. See
<code><a href="#topic+Translator">Translator$id</a></code> for more information.</p>
</dd>
<dt><code style="white-space: pre;">&#8288;Language Code&#8288;</code></dt><dd><p>The value of argument <code>lang</code>.</p>
</dd>
<dt><code>Language</code></dt><dd><p>The translation's language. See
<code><a href="#topic+Translator">Translator$native_languages</a></code> for more information.</p>
</dd>
<dt><code style="white-space: pre;">&#8288;Source Language&#8288;</code></dt><dd><p>The source text's language. See
<code><a href="#topic+Translator">Translator$source_langs</a></code> for more information.</p>
</dd>
<dt><code>Translations</code></dt><dd><p>A named list containing further named lists. Each
sublist contains two values:
</p>

<dl>
<dt><code style="white-space: pre;">&#8288;Source Text&#8288;</code></dt><dd><p>A non-empty and non-NA character string.</p>
</dd>
<dt><code>Translation</code></dt><dd><p>A non-empty and non-NA character string.</p>
</dd>
</dl>

<p>See <code><a href="#topic+Text">Text$translations</a></code> for more information.</p>
</dd>
</dl>

<p>Unavailable translations are automatically replaced by a placeholder that
depends on whether they are exported or imported.
</p>



<h3>Note</h3>

<p>Dividing the serialization and deserialization processes into multiple steps
helps keeping the underlying functions short, and easier to test.
</p>


<h3>See Also</h3>

<p><a href="https://yaml.org/spec/1.1/">Official YAML 1.1 specification</a>,
<code><a href="yaml.html#topic+as.yaml">yaml::as.yaml()</a></code>,
<code><a href="yaml.html#topic+yaml.load">yaml::yaml.load()</a></code>,
<code><a href="#topic+flat_serialize">flat_serialize()</a></code>,
<code><a href="#topic+flat_deserialize">flat_deserialize()</a></code>,
<code><a href="#topic+translator_read">translator_read()</a></code>,
<code><a href="#topic+translator_write">translator_write()</a></code>,
<code><a href="#topic+translations_read">translations_read()</a></code>,
<code><a href="#topic+translations_write">translations_write()</a></code>
</p>

<hr>
<h2 id='stops'>Throw Errors</h2><span id='topic+stops'></span><span id='topic+stopf'></span>

<h3>Description</h3>

<p><code><a href="#topic+stops">stops()</a></code> is equivalent to <code>stop(..., call. = FALSE)</code>. It removes calls
from error messages by default. These are rarely useful and confuse users
more often than they help them.
</p>
<p><code><a href="#topic+stopf">stopf()</a></code> is equivalent to <code>stops(sprintf(fmt, ...))</code>. It wraps
<code><a href="base.html#topic+sprintf">base::sprintf()</a></code> and <code><a href="#topic+stops">stops()</a></code> and is used to construct flexible
error messages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stops(...)

stopf(fmt = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stops_+3A_...">...</code></td>
<td>
<p>Further arguments respectively passed to <code><a href="base.html#topic+stop">base::stop()</a></code> and
<code><a href="base.html#topic+sprintf">base::sprintf()</a></code> by <code><a href="#topic+stops">stops()</a></code> and <code><a href="#topic+stopf">stopf()</a></code>.</p>
</td></tr>
<tr><td><code id="stops_+3A_fmt">fmt</code></td>
<td>
<p>A character of length 1 passed as is to <code><a href="base.html#topic+sprintf">base::sprintf()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing. These functions are used for their side-effect of raising
an error.
</p>


<h3>See Also</h3>

<p>Other utility functions: 
<code><a href="#topic+format_vector">format_vector</a>()</code>,
<code><a href="#topic+str_to">str_to</a>()</code>,
<code><a href="#topic+vapply_1l">vapply_1l</a>()</code>
</p>

<hr>
<h2 id='str_to'>Character String Utilities</h2><span id='topic+str_to'></span><span id='topic+str_to.default'></span><span id='topic+str_trim'></span><span id='topic+str_wrap'></span>

<h3>Description</h3>

<p><code><a href="#topic+str_to">str_to()</a></code> converts an <span class="rlang"><b>R</b></span> object to a character string. It is a slightly
more flexible alternative to <code><a href="base.html#topic+toString">base::toString()</a></code>.
</p>
<p><code><a href="#topic+str_trim">str_trim()</a></code> wraps <code><a href="base.html#topic+strtrim">base::strtrim()</a></code> and further adds a <code>...</code> suffix to
each trimmed element.
</p>
<p><code><a href="#topic+str_wrap">str_wrap()</a></code> wraps <code><a href="base.html#topic+strwrap">base::strwrap()</a></code> and ensures a character string is
returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>str_to(x, ...)

## Default S3 method:
str_to(x, quote_values = FALSE, last_sep = ", or ", ...)

str_trim(x = character(), width = 80L)

str_wrap(x = character(), width = 80L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="str_to_+3A_x">x</code></td>
<td>
<p>Any <span class="rlang"><b>R</b></span> object for <code><a href="#topic+str_to">str_to()</a></code>. A character vector otherwise.</p>
</td></tr>
<tr><td><code id="str_to_+3A_...">...</code></td>
<td>
<p>Further arguments passed to, or from other methods.</p>
</td></tr>
<tr><td><code id="str_to_+3A_quote_values">quote_values</code></td>
<td>
<p>A non-NA logical value. Should elements of <code>x</code> be quoted?</p>
</td></tr>
<tr><td><code id="str_to_+3A_last_sep">last_sep</code></td>
<td>
<p>A non-empty and non-NA character string separating the last
and penultimate elements.</p>
</td></tr>
<tr><td><code id="str_to_+3A_width">width</code></td>
<td>
<p>A non-NA integer value. The target width for individual
elements of <code>x</code>. <code><a href="#topic+str_trim">str_trim()</a></code> takes 3 more characters into account for the
suffix it inserts (<code>...</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+str_to">str_to()</a></code> concatenates all elements with <code>", "</code>, except for the last
one. See argument <code>last_sep</code>.
</p>
<p><code><a href="#topic+str_wrap">str_wrap()</a></code> preserves existing paragraph separators (<code>"\n\n"</code>).
</p>


<h3>Value</h3>

<p><code><a href="#topic+str_to">str_to()</a></code> and <code><a href="#topic+str_wrap">str_wrap()</a></code> return a character string.
</p>
<p><code><a href="#topic+str_trim">str_trim()</a></code> returns a character vector having the same length as <code>x</code>.
</p>


<h3>See Also</h3>

<p>Other utility functions: 
<code><a href="#topic+format_vector">format_vector</a>()</code>,
<code><a href="#topic+stops">stops</a>()</code>,
<code><a href="#topic+vapply_1l">vapply_1l</a>()</code>
</p>

<hr>
<h2 id='text'>Source Text</h2><span id='topic+text'></span><span id='topic+is_text'></span><span id='topic+format.Text'></span><span id='topic+print.Text'></span><span id='topic+c.Text'></span><span id='topic+merge_texts'></span><span id='topic+as_text'></span><span id='topic+as_text.call'></span><span id='topic+Text'></span>

<h3>Description</h3>

<p>Structure source text and its translations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>text(..., source_lang = language_source_get(), algorithm = algorithms())

is_text(x)

## S3 method for class 'Text'
format(x, ...)

## S3 method for class 'Text'
print(x, ...)

## S3 method for class 'Text'
c(...)

merge_texts(..., algorithm = algorithms())

as_text(x, ...)

## S3 method for class 'call'
as_text(x, loc = location(), algorithm = algorithms(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="text_+3A_...">...</code></td>
<td>
<p>Usage depends on the underlying function.
</p>

<ul>
<li><p> Any number of <code><a href="#topic+Location">Location</a></code> objects and/or named character
strings for <code><a href="#topic+text">text()</a></code> (in no preferred order).
</p>
</li>
<li><p> Any number of <code><a href="#topic+Text">Text</a></code> objects for <code><a href="#topic+merge_texts">merge_texts()</a></code> and S3
method <code><a href="base.html#topic+c">c()</a></code>.
</p>
</li>
<li><p> Further arguments passed to or from other methods for <code><a href="base.html#topic+format">format()</a></code>,
<code><a href="base.html#topic+print">print()</a></code>, and <code><a href="#topic+as_text">as_text()</a></code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="text_+3A_source_lang">source_lang</code></td>
<td>
<p>A non-empty and non-NA character string. The language of
the source text.
</p>
<p>A language is usually a code (of two or three letters) for a native
language name. While users retain full control over codes, it is best
to use language codes stemming from well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>.
Doing so maximizes portability and cross-compatibility between packages.</p>
</td></tr>
<tr><td><code id="text_+3A_algorithm">algorithm</code></td>
<td>
<p>A non-empty and non-NA character string equal to <code>"sha1"</code>,
or <code>"utf8"</code>. The algorithm to use when hashing source information for
identification purposes.</p>
</td></tr>
<tr><td><code id="text_+3A_x">x</code></td>
<td>
<p>Any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="text_+3A_loc">loc</code></td>
<td>
<p>A <code><a href="#topic+Location">Location</a></code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code><a href="#topic+Text">Text</a></code> object is a piece of source text that is extracted from <span class="rlang"><b>R</b></span>
source scripts.
</p>

<ul>
<li><p> It (typically) has one or more <code><a href="#topic+Location">Locations</a></code> within a project.
</p>
</li>
<li><p> It has zero or more translations.
</p>
</li></ul>

<p>The <code><a href="#topic+Text">Text</a></code> class structures this information and exposes a set of
methods to manipulate it.
</p>


<h4>Combining Text Objects</h4>

<p><code><a href="base.html#topic+c">c()</a></code> can only combine <code><a href="#topic+Text">Text</a></code> objects having the same <code>hash</code>.
This is equivalent to having the same <code>algorithm</code>, <code>source_lang</code>, and
<code>source_text</code>. In that case, the underlying translations and
<code><a href="#topic+Location">Location</a></code> objects are combined and a new object is returned.
It throws an error if all <code><a href="#topic+Text">Text</a></code> objects are empty (they have no
set <code>source_lang</code>).
</p>
<p><code><a href="#topic+merge_texts">merge_texts()</a></code> is a generalized version of <code><a href="base.html#topic+c">c()</a></code> that handles any number
of <code><a href="#topic+Text">Text</a></code> objects having possibly different hashes. It can be
viewed as a vectorized version of <code><a href="base.html#topic+c">c()</a></code>. It silently ignores and drops
all empty <code><a href="#topic+Text">Text</a></code> objects.
</p>



<h4>Coercion</h4>

<p><code><a href="#topic+as_text">as_text()</a></code> is an S3 generic function that attempts to coerce its argument
into a suitable <code><a href="#topic+Text">Text</a></code> object. <code><a href="#topic+as_text.call">as_text.call()</a></code> is the method used
by <code><a href="#topic+find_source">find_source()</a></code> to coerce a <code><a href="base.html#topic+call">call</a></code> object to a <code><a href="#topic+Text">Text</a></code>
object. While it <em>can</em> be used, it should be avoided most of the time. Users
may extend it by defining their own methods.
</p>



<h3>Value</h3>

<p><code><a href="#topic+text">text()</a></code>, <code><a href="base.html#topic+c">c()</a></code>, and <code><a href="#topic+as_text">as_text()</a></code> return an <code><a href="R6.html#topic+R6Class">R6</a></code> object of
class <code><a href="#topic+Text">Text</a></code>.
</p>
<p><code><a href="#topic+is_text">is_text()</a></code> returns a logical value.
</p>
<p><code><a href="base.html#topic+format">format()</a></code> returns a character vector.
</p>
<p><code><a href="base.html#topic+print">print()</a></code> returns argument <code>x</code> invisibly.
</p>
<p><code><a href="#topic+merge_texts">merge_texts()</a></code> returns a list of (combined) <code><a href="#topic+Text">Text</a></code> objects. It
can be empty if all underlying <code><a href="#topic+Text">Text</a></code> objects are empty.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>hash</code></dt><dd><p>A non-empty and non-NA character string. A reproducible
hash generated from <code>source_lang</code> and <code>source_text</code>, and by using
the algorithm specified by <code>algorithm</code>. It is used as a unique
identifier for the underlying <code><a href="#topic+Text">Text</a></code> object.
</p>
<p>This is a <strong>read-only</strong> field. It is automatically updated
whenever fields <code>source_lang</code> and/or <code>algorithm</code> are updated.</p>
</dd>
<dt><code>algorithm</code></dt><dd><p>A non-empty and non-NA character string equal to <code>"sha1"</code>,
or <code>"utf8"</code>. The algorithm to use when hashing source information for
identification purposes.</p>
</dd>
<dt><code>source_lang</code></dt><dd><p>A non-empty and non-NA character string. The language of
the source text.
</p>
<p>A language is usually a code (of two or three letters) for a native
language name. While users retain full control over codes, it is best
to use language codes stemming from well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>.
Doing so maximizes portability and cross-compatibility between packages.</p>
</dd>
<dt><code>source_text</code></dt><dd><p>A non-empty and non-NA character string. The source text.
This is a <strong>read-only</strong> field.</p>
</dd>
<dt><code>languages</code></dt><dd><p>A character vector. Registered language
codes. This is a <strong>read-only</strong> field. Use methods below
to update it.</p>
</dd>
<dt><code>translations</code></dt><dd><p>A named character vector. Registered
translations of <code>source_text</code>, including the latter. Names
correspond to <code>languages</code>. This is a <strong>read-only</strong> field.
Use methods below to update it.</p>
</dd>
<dt><code>locations</code></dt><dd><p>A list of <code><a href="#topic+Location">Location</a></code> objects giving
the location(s) of <code>source_text</code> in the underlying project. It
can be empty. This is a <strong>read-only</strong> field. Use methods below
to update it.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-Text-new"><code>Text$new()</code></a>
</p>
</li>
<li> <p><a href="#method-Text-get_translation"><code>Text$get_translation()</code></a>
</p>
</li>
<li> <p><a href="#method-Text-set_translation"><code>Text$set_translation()</code></a>
</p>
</li>
<li> <p><a href="#method-Text-set_translations"><code>Text$set_translations()</code></a>
</p>
</li>
<li> <p><a href="#method-Text-set_locations"><code>Text$set_locations()</code></a>
</p>
</li>
<li> <p><a href="#method-Text-rm_translation"><code>Text$rm_translation()</code></a>
</p>
</li>
<li> <p><a href="#method-Text-rm_location"><code>Text$rm_location()</code></a>
</p>
</li></ul>


<hr>
<a id="method-Text-new"></a>



<h4>Method <code>new()</code></h4>

<p>Create a <code><a href="#topic+Text">Text</a></code> object.
</p>


<h5>Usage</h5>

<div class="r"><pre>Text$new(algorithm = algorithms())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>algorithm</code></dt><dd><p>A non-empty and non-NA character string equal to <code>"sha1"</code>,
or <code>"utf8"</code>. The algorithm to use when hashing source information for
identification purposes.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>An <code><a href="R6.html#topic+R6Class">R6</a></code> object of class <code><a href="#topic+Text">Text</a></code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre># Consider using text() instead.
txt &lt;- Text$new()
</pre>
</div>


<hr>
<a id="method-Text-get_translation"></a>



<h4>Method <code>get_translation()</code></h4>

<p>Extract a translation, or the source text.
</p>


<h5>Usage</h5>

<div class="r"><pre>Text$get_translation(lang = "")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>lang</code></dt><dd><p>A non-empty and non-NA character string. The underlying language.
</p>
<p>A language is usually a code (of two or three letters) for a native
language name. While users retain full control over codes, it is best
to use language codes stemming from well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>
to maximize portability and cross-compatibility.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A character string. <code>NULL</code> is returned if the requested
translation is not available.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>txt &lt;- Text$new()
txt$set_translation("en", "Hello, world!")

txt$get_translation("en")  ## Outputs "Hello, world!"
txt$get_translation("fr")  ## Outputs NULL
</pre>
</div>


<hr>
<a id="method-Text-set_translation"></a>



<h4>Method <code>set_translation()</code></h4>

<p>Register a translation, or the source text.
</p>


<h5>Usage</h5>

<div class="r"><pre>Text$set_translation(lang = "", text = "")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>lang</code></dt><dd><p>A non-empty and non-NA character string. The underlying language.
</p>
<p>A language is usually a code (of two or three letters) for a native
language name. While users retain full control over codes, it is best
to use language codes stemming from well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>
to maximize portability and cross-compatibility.</p>
</dd>
<dt><code>text</code></dt><dd><p>A non-empty and non-NA character string. A translation,
or the source text.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>This method is also used to register <code>source_lang</code> and
<code>source_text</code> <strong>before</strong> setting them as such. See Examples below.
</p>



<h5>Returns</h5>

<p>A <code>NULL</code>, invisibly.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre># Register a pair of source_lang and source_text.
txt &lt;- Text$new()
txt$set_translation("en", "Hello, world!")
txt$source_lang &lt;- "en"
</pre>
</div>


<hr>
<a id="method-Text-set_translations"></a>



<h4>Method <code>set_translations()</code></h4>

<p>Register one or more translations, and/or the source
text.
</p>


<h5>Usage</h5>

<div class="r"><pre>Text$set_translations(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Any number of named, non-empty, and non-NA character
strings.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>This method can be viewed as a vectorized version of
method <code>set_translation()</code>.
</p>



<h5>Returns</h5>

<p>A <code>NULL</code>, invisibly.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>txt &lt;- Text$new()
txt$set_translations(en = "Hello, world!", fr = "Bonjour, monde!")
</pre>
</div>


<hr>
<a id="method-Text-set_locations"></a>



<h4>Method <code>set_locations()</code></h4>

<p>Register one or more locations.
</p>


<h5>Usage</h5>

<div class="r"><pre>Text$set_locations(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Any number of <code><a href="#topic+Location">Location</a></code> objects.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>This method calls <code><a href="#topic+merge_locations">merge_locations()</a></code> to merge all
values passed to <code>...</code> together with previously registered
<code><a href="#topic+Location">Location</a></code> objects. The underlying registered
paths and/or ranges won't be duplicated.
</p>



<h5>Returns</h5>

<p>A <code>NULL</code>, invisibly.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>txt &lt;- Text$new()
txt$set_locations(
  location("a", 1L, 2L, 3L, 4L),
  location("a", 1L, 2L, 3L, 4L),
  location("b", 5L, 6L, 7L, 8L))
</pre>
</div>


<hr>
<a id="method-Text-rm_translation"></a>



<h4>Method <code>rm_translation()</code></h4>

<p>Remove a registered translation.
</p>


<h5>Usage</h5>

<div class="r"><pre>Text$rm_translation(lang = "")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>lang</code></dt><dd><p>A non-empty and non-NA character string identifying a
translation to be removed.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>You cannot remove <code>lang</code> when it is registered as the
current <code>source_lang</code>. You must update <code>source_lang</code> before
doing so.
</p>



<h5>Returns</h5>

<p>A <code>NULL</code>, invisibly.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>txt &lt;- Text$new()
txt$set_translations(en = "Hello, world!", fr = "Bonjour, monde!")
txt$source_lang &lt;- "en"

# Remove source_lang and source_text.
txt$source_lang &lt;- "fr"
txt$rm_translation("en")
</pre>
</div>


<hr>
<a id="method-Text-rm_location"></a>



<h4>Method <code>rm_location()</code></h4>

<p>Remove a registered location.
</p>


<h5>Usage</h5>

<div class="r"><pre>Text$rm_location(path = "")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>path</code></dt><dd><p>A non-empty and non-NA character string identifying a
<code><a href="#topic+Location">Location</a></code> object to be removed.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A <code>NULL</code>, invisibly.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>txt &lt;- Text$new()
txt$set_locations(
  location("a", 1L, 2L, 3L, 4L),
  location("b", 5L, 6L, 7L, 8L))

txt$rm_location("a")
</pre>
</div>




<h3>Examples</h3>

<pre><code class='language-R'># Set source language.
language_source_set("en")

# Create Text objects.
txt1 &lt;- text(
  location("a", 1L, 2L, 3L, 4L),
  location("a", 1L, 2L, 3L, 4L),
  location("b", 5L, 6L, 7L, 8L),
  location("c", c(9L, 10L), c(11L, 12L), c(13L, 14L), c(15L, 16L)),
  en = "Hello, world!",
  fr = "Bonjour, monde!",
  es = "¡Hola, mundo!")

txt2 &lt;- text(
  location("a", 1L, 2L, 3L, 4L),
  en = "Hello, world!",
  fr = "Bonjour, monde!",
  es = "¡Hola, mundo!")

txt3 &lt;- text(
  source_lang = "fr2",
  location("a", 5L, 6L, 7L, 8L),
  en  = "Hello, world!",
  fr2 = "Bonjour le monde!",
  es  = "¡Hola, mundo!")

is_text(txt1)

# Texts objects has a specific format.
# print() calls format() internally, as expected.
print(txt1)
print(txt2)
print(txt3)

# Combine Texts objects.
# c() throws an error if they do not have the same
# hash (same souce_text, source_lang, and algorithm).
c(txt1, txt2)

# Text objects with different hashes can be merged.
# This groups Text objects according to their hashes
# and calls c() on each group. It returns a list.
merge_texts(txt1, txt2, txt3)

# Objects can be coerced to a Text object with as_text(). Below is an
# example for call objects. This is for illustration purposes only,
# and the latter should not be used. This method is used internally by
# find_source().
cl  &lt;- str2lang("translate('Hello, world!')")
loc &lt;- location("example in class-text", 2L, 32L, 2L, 68L)
as_text(cl, loc)


## ------------------------------------------------
## Method `Text$new`
## ------------------------------------------------

# Consider using text() instead.
txt &lt;- Text$new()

## ------------------------------------------------
## Method `Text$get_translation`
## ------------------------------------------------

txt &lt;- Text$new()
txt$set_translation("en", "Hello, world!")

txt$get_translation("en")  ## Outputs "Hello, world!"
txt$get_translation("fr")  ## Outputs NULL

## ------------------------------------------------
## Method `Text$set_translation`
## ------------------------------------------------

# Register a pair of source_lang and source_text.
txt &lt;- Text$new()
txt$set_translation("en", "Hello, world!")
txt$source_lang &lt;- "en"

## ------------------------------------------------
## Method `Text$set_translations`
## ------------------------------------------------

txt &lt;- Text$new()
txt$set_translations(en = "Hello, world!", fr = "Bonjour, monde!")

## ------------------------------------------------
## Method `Text$set_locations`
## ------------------------------------------------

txt &lt;- Text$new()
txt$set_locations(
  location("a", 1L, 2L, 3L, 4L),
  location("a", 1L, 2L, 3L, 4L),
  location("b", 5L, 6L, 7L, 8L))

## ------------------------------------------------
## Method `Text$rm_translation`
## ------------------------------------------------

txt &lt;- Text$new()
txt$set_translations(en = "Hello, world!", fr = "Bonjour, monde!")
txt$source_lang &lt;- "en"

# Remove source_lang and source_text.
txt$source_lang &lt;- "fr"
txt$rm_translation("en")

## ------------------------------------------------
## Method `Text$rm_location`
## ------------------------------------------------

txt &lt;- Text$new()
txt$set_locations(
  location("a", 1L, 2L, 3L, 4L),
  location("b", 5L, 6L, 7L, 8L))

txt$rm_location("a")
</code></pre>

<hr>
<h2 id='text_read'>Read and Write Text</h2><span id='topic+text_read'></span><span id='topic+text_write'></span>

<h3>Description</h3>

<p><code><a href="#topic+text_read">text_read()</a></code> and <code><a href="#topic+text_write">text_write()</a></code> respectively wrap <code><a href="base.html#topic+readLines">base::readLines()</a></code> and
<code><a href="base.html#topic+writeLines">base::writeLines()</a></code>. They further validate their arguments, normalize
file paths and re-encode inputs to <code>UTF-8</code> before reading and writing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>text_read(path = "", encoding = "UTF-8")

text_write(x = character(), path = "", encoding = "UTF-8")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="text_read_+3A_path">path</code></td>
<td>
<p>A non-empty and non-NA character string. A path to a file to
read text from, or write text to.</p>
</td></tr>
<tr><td><code id="text_read_+3A_encoding">encoding</code></td>
<td>
<p>A non-empty and non-NA character string. The source character
encoding. In almost all cases, this should be UTF-8. Other encodings are
internally re-encoded to UTF-8 for portability.</p>
</td></tr>
<tr><td><code id="text_read_+3A_x">x</code></td>
<td>
<p>A character vector. Lines of text to write. Its current encoding is
given by <code>encoding</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+text_read">text_read()</a></code> returns a character vector.
</p>
<p><code><a href="#topic+text_write">text_write()</a></code> returns <code>NULL</code>, invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+readLines">readLines()</a></code>,
<code><a href="base.html#topic+writeLines">writeLines()</a></code>,
<code><a href="base.html#topic+iconv">iconv()</a></code>
</p>

<hr>
<h2 id='translator'>Source Text and Translations</h2><span id='topic+translator'></span><span id='topic+is_translator'></span><span id='topic+format.Translator'></span><span id='topic+print.Translator'></span><span id='topic+Translator'></span>

<h3>Description</h3>

<p>Structure and manipulate the source text of a project and its translations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>translator(..., id = uuid(), algorithm = algorithms())

is_translator(x)

## S3 method for class 'Translator'
format(x, ...)

## S3 method for class 'Translator'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="translator_+3A_...">...</code></td>
<td>
<p>Usage depends on the underlying function.
</p>

<ul>
<li><p> Any number of <code><a href="#topic+Text">Text</a></code> objects and/or named character
strings for <code><a href="#topic+translator">translator()</a></code> (in no preferred order).
</p>
</li>
<li><p> Further arguments passed to or from other methods for <code><a href="base.html#topic+format">format()</a></code>,
and <code><a href="base.html#topic+print">print()</a></code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="translator_+3A_id">id</code></td>
<td>
<p>A non-empty and non-NA character string. A globally unique
identifier for the <code><a href="#topic+Translator">Translator</a></code> object. Beware of collisions
when using user-defined values.</p>
</td></tr>
<tr><td><code id="translator_+3A_algorithm">algorithm</code></td>
<td>
<p>A non-empty and non-NA character string equal to <code>"sha1"</code>,
or <code>"utf8"</code>. The algorithm to use when hashing source information for
identification purposes.</p>
</td></tr>
<tr><td><code id="translator_+3A_x">x</code></td>
<td>
<p>Any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code><a href="#topic+Translator">Translator</a></code> object encapsulates the source text of a project
(or any other <em>context</em>) and all related translations. Under the hood,
<code><a href="#topic+Translator">Translator</a></code> objects are collections of <code><a href="#topic+Text">Text</a></code> objects.
These do most of the work. They are treated as lower-level component and in
typical situations, users rarely interact with them.
</p>
<p><code><a href="#topic+Translator">Translator</a></code> objects can be saved and exported with
<code><a href="#topic+translator_write">translator_write()</a></code>. They can be imported back into an <span class="rlang"><b>R</b></span> session
with <code><a href="#topic+translator_read">translator_read()</a></code>.
</p>


<h3>Value</h3>

<p><code><a href="#topic+translator">translator()</a></code> returns an <code><a href="R6.html#topic+R6Class">R6</a></code> object of class
<code><a href="#topic+Translator">Translator</a></code>.
</p>
<p><code><a href="#topic+is_translator">is_translator()</a></code> returns a logical value.
</p>
<p><code><a href="base.html#topic+format">format()</a></code> returns a character vector.
</p>
<p><code><a href="base.html#topic+print">print()</a></code> returns argument <code>x</code> invisibly.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>id</code></dt><dd><p>A non-empty and non-NA character string. A globally unique
identifier for the underlying object. Beware of plausible collisions
when using user-defined values.</p>
</dd>
<dt><code>algorithm</code></dt><dd><p>A non-empty and non-NA character string equal to <code>"sha1"</code>,
or <code>"utf8"</code>. The algorithm to use when hashing source information for
identification purposes.</p>
</dd>
<dt><code>hashes</code></dt><dd><p>A character vector of non-empty and non-NA values, or
<code>NULL</code>. The set of all <code>hash</code> exposed by registered <code><a href="#topic+Text">Text</a></code>
objects. If there is none, <code>hashes</code> is <code>NULL</code>. This is a
<strong>read-only</strong> field updated whenever field <code>algorithm</code> is updated.</p>
</dd>
<dt><code>source_texts</code></dt><dd><p>A character vector of non-empty and non-NA
values, or <code>NULL</code>. The set of all registered source texts. If
there is none, <code>source_texts</code> is <code>NULL</code>. This is a <strong>read-only</strong>
field.</p>
</dd>
<dt><code>source_langs</code></dt><dd><p>A character vector of non-empty and non-NA
values, or <code>NULL</code>. The set of all registered source languages.
This is a <strong>read-only</strong> field.
</p>

<ul>
<li><p> If there is none, <code>source_langs</code> is <code>NULL</code>.
</p>
</li>
<li><p> If there is one unique value, <code>source_langs</code> is an unnamed
character string.
</p>
</li>
<li><p> Otherwise, it is a named character vector.
</p>
</li></ul>
</dd>
<dt><code>languages</code></dt><dd><p>A character vector of non-empty and non-NA values,
or <code>NULL</code>. The set of all registered <code>languages</code> (codes). If there
is none, <code>languages</code> is <code>NULL</code>. This is a <strong>read-only</strong> field.</p>
</dd>
<dt><code>native_languages</code></dt><dd><p>A named character vector of non-empty and
non-NA values, or <code>NULL</code>. A map (bijection) of <code>languages</code> (codes)
to native language names. Names are codes and values are native
languages. If there is none, <code>native_languages</code> is <code>NULL</code>.
</p>
<p>While users retain full control over <code>native_languages</code>, it is
best to use well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>.
Doing so maximizes portability and cross-compatibility between packages.
</p>
<p>Update this field with method <code><a href="#topic+Translator">$set_native_languages()</a></code>.
See below for more information.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-Translator-new"><code>Translator$new()</code></a>
</p>
</li>
<li> <p><a href="#method-Translator-translate"><code>Translator$translate()</code></a>
</p>
</li>
<li> <p><a href="#method-Translator-get_translation"><code>Translator$get_translation()</code></a>
</p>
</li>
<li> <p><a href="#method-Translator-get_text"><code>Translator$get_text()</code></a>
</p>
</li>
<li> <p><a href="#method-Translator-set_text"><code>Translator$set_text()</code></a>
</p>
</li>
<li> <p><a href="#method-Translator-set_texts"><code>Translator$set_texts()</code></a>
</p>
</li>
<li> <p><a href="#method-Translator-rm_text"><code>Translator$rm_text()</code></a>
</p>
</li>
<li> <p><a href="#method-Translator-set_native_languages"><code>Translator$set_native_languages()</code></a>
</p>
</li>
<li> <p><a href="#method-Translator-set_default_value"><code>Translator$set_default_value()</code></a>
</p>
</li></ul>


<hr>
<a id="method-Translator-new"></a>



<h4>Method <code>new()</code></h4>

<p>Create a <code><a href="#topic+Translator">Translator</a></code> object.
</p>


<h5>Usage</h5>

<div class="r"><pre>Translator$new(id = uuid(), algorithm = algorithms())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>id</code></dt><dd><p>A non-empty and non-NA character string. A globally unique
identifier for the <code><a href="#topic+Translator">Translator</a></code> object. Beware of collisions
when using user-defined values.</p>
</dd>
<dt><code>algorithm</code></dt><dd><p>A non-empty and non-NA character string equal to <code>"sha1"</code>,
or <code>"utf8"</code>. The algorithm to use when hashing source information for
identification purposes.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>An <code><a href="R6.html#topic+R6Class">R6</a></code> object of class <code><a href="#topic+Translator">Translator</a></code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre># Consider using translator() instead.
tr &lt;- Translator$new()
</pre>
</div>


<hr>
<a id="method-Translator-translate"></a>



<h4>Method <code>translate()</code></h4>

<p>Translate source text.
</p>


<h5>Usage</h5>

<div class="r"><pre>Translator$translate(
  ...,
  lang = language_get(),
  source_lang = language_source_get()
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Any number of vectors containing <a href="base.html#topic+atomic">atomic</a> elements. Each vector
is normalized as a paragraph.
</p>

<ul>
<li><p> Elements are coerced to character values.
</p>
</li>
<li><p> NA values and empty strings are discarded.
</p>
</li>
<li><p> Multi-line strings are supported and encouraged. Blank lines are
interpreted (two or more newline characters) as paragraph separators.
</p>
</li></ul>
</dd>
<dt><code>lang</code></dt><dd><p>A non-empty and non-NA character string. The underlying language.
</p>
<p>A language is usually a code (of two or three letters) for a native
language name. While users retain full control over codes, it is best
to use language codes stemming from well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>
to maximize portability and cross-compatibility.</p>
</dd>
<dt><code>source_lang</code></dt><dd><p>A non-empty and non-NA character string. The
language of the source text. See argument <code>lang</code> for more
information.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>See <code><a href="#topic+normalize">normalize()</a></code> for further details on how <code>...</code> is normalized.
</p>



<h5>Returns</h5>

<p>A character string. If there is no corresponding translation,
the value passed to method <code><a href="#topic+Translator">$set_default_value()</a></code> is
returned. <code>NULL</code> is returned by default.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>tr &lt;- Translator$new()
tr$set_text(en = "Hello, world!", fr = "Bonjour, monde!")
tr$translate("Hello, world!", lang = "en")  ## Outputs "Hello, world!"
tr$translate("Hello, world!", lang = "fr")  ## Outputs "Bonjour, monde!"
</pre>
</div>


<hr>
<a id="method-Translator-get_translation"></a>



<h4>Method <code>get_translation()</code></h4>

<p>Extract a translation or a source text.
</p>


<h5>Usage</h5>

<div class="r"><pre>Translator$get_translation(hash = "", lang = "")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>hash</code></dt><dd><p>A non-empty and non-NA character string. The unique identifier
of the requested source text.</p>
</dd>
<dt><code>lang</code></dt><dd><p>A non-empty and non-NA character string. The underlying language.
</p>
<p>A language is usually a code (of two or three letters) for a native
language name. While users retain full control over codes, it is best
to use language codes stemming from well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>
to maximize portability and cross-compatibility.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A character string. If there is no corresponding translation,
the value passed to method <code><a href="#topic+Translator">$set_default_value()</a></code> is
returned. <code>NULL</code> is returned by default.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>tr &lt;- Translator$new()
tr$set_text(en = "Hello, world!")

# Consider using translate() instead.
tr$get_translation("256e0d7", "en")  ## Outputs "Hello, world!"
</pre>
</div>


<hr>
<a id="method-Translator-get_text"></a>



<h4>Method <code>get_text()</code></h4>

<p>Extract a source text and its translations.
</p>


<h5>Usage</h5>

<div class="r"><pre>Translator$get_text(hash = "")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>hash</code></dt><dd><p>A non-empty and non-NA character string. The unique identifier
of the requested source text.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A <code><a href="#topic+Text">Text</a></code> object, or <code>NULL</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>tr &lt;- Translator$new()
tr$set_text(en = "Hello, world!")

tr$get_translation("256e0d7", "en")  ## Outputs "Hello, world!"
</pre>
</div>


<hr>
<a id="method-Translator-set_text"></a>



<h4>Method <code>set_text()</code></h4>

<p>Register a source text.
</p>


<h5>Usage</h5>

<div class="r"><pre>Translator$set_text(..., source_lang = language_source_get())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Passed as is to <code><a href="#topic+text">text()</a></code>.</p>
</dd>
<dt><code>source_lang</code></dt><dd><p>Passed as is to <code><a href="#topic+text">text()</a></code>.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A <code>NULL</code>, invisibly.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>tr &lt;- Translator$new()

tr$set_text(en = "Hello, world!", location())
</pre>
</div>


<hr>
<a id="method-Translator-set_texts"></a>



<h4>Method <code>set_texts()</code></h4>

<p>Register one or more source texts.
</p>


<h5>Usage</h5>

<div class="r"><pre>Translator$set_texts(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Any number of <code><a href="#topic+Text">Text</a></code> objects.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>This method calls <code><a href="#topic+merge_texts">merge_texts()</a></code> to merge all values
passed to <code>...</code> together with previously registered
<code><a href="#topic+Text">Text</a></code> objects. The underlying registered source texts,
translations, and <code><a href="#topic+Location">Location</a></code> objects won't be
duplicated.
</p>



<h5>Returns</h5>

<p>A <code>NULL</code>, invisibly.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre># Set source language.
language_source_set("en")

tr &lt;- Translator$new()

# Create Text objects.
txt1 &lt;- text(
  location("a", 1L, 2L, 3L, 4L),
  en = "Hello, world!",
  fr = "Bonjour, monde!")

txt2 &lt;- text(
  location("b", 5L, 6L, 7L, 8L),
  en = "Farewell, world!",
  fr = "Au revoir, monde!")

tr$set_texts(txt1, txt2)
</pre>
</div>


<hr>
<a id="method-Translator-rm_text"></a>



<h4>Method <code>rm_text()</code></h4>

<p>Remove a registered source text.
</p>


<h5>Usage</h5>

<div class="r"><pre>Translator$rm_text(hash = "")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>hash</code></dt><dd><p>A non-empty and non-NA character string identifying the
source text to remove.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A <code>NULL</code>, invisibly.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>tr &lt;- Translator$new()
tr$set_text(en = "Hello, world!")

tr$rm_text("256e0d7")
</pre>
</div>


<hr>
<a id="method-Translator-set_native_languages"></a>



<h4>Method <code>set_native_languages()</code></h4>

<p>Map a language code to a native language name.
</p>


<h5>Usage</h5>

<div class="r"><pre>Translator$set_native_languages(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Any number of named, non-empty, and non-NA character
strings. Names are codes and values are native languages. See
field <code>native_languages</code> for more information.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A <code>NULL</code>, invisibly.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>tr &lt;- Translator$new()

tr$set_native_languages(en = "English", fr = "Français")

# Remove existing entries.
tr$set_native_languages(fr = NULL)
</pre>
</div>


<hr>
<a id="method-Translator-set_default_value"></a>



<h4>Method <code>set_default_value()</code></h4>

<p>Register a default value to return when there is no
corresponding translations for the requested language.
</p>


<h5>Usage</h5>

<div class="r"><pre>Translator$set_default_value(value = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>value</code></dt><dd><p>A <code>NULL</code> or a non-NA character string. It can be empty.
The former is returned by default.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>This modifies what methods <code><a href="#topic+Translator">$translate()</a></code> and
<code><a href="#topic+Translator">$get_translation()</a></code> returns when there is no
translation for <code>lang</code>.
</p>



<h5>Returns</h5>

<p>A <code>NULL</code>, invisibly.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>tr &lt;- Translator$new()
tr$set_default_value("&lt;unavailable&gt;")
</pre>
</div>




<h3>See Also</h3>

<p><code><a href="#topic+find_source">find_source()</a></code>,
<code><a href="#topic+translator_read">translator_read()</a></code>,
<code><a href="#topic+translator_write">translator_write()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set source language.
language_source_set("en")

# Create a Translator object.
# This would normally be done automatically
# by find_source(), or translator_read().
tr &lt;- translator(
  id = "test-translator",
  en = "English",
  es = "Español",
  fr = "Français",
  text(
    location("a", 1L, 2L, 3L, 4L),
    en = "Hello, world!",
    fr = "Bonjour, monde!"),
  text(
    location("b", 1L, 2L, 3L, 4L),
    en = "Farewell, world!",
    fr = "Au revoir, monde!"))

is_translator(tr)

# Translator objects has a specific format.
# print() calls format() internally, as expected.
print(tr)


## ------------------------------------------------
## Method `Translator$new`
## ------------------------------------------------

# Consider using translator() instead.
tr &lt;- Translator$new()

## ------------------------------------------------
## Method `Translator$translate`
## ------------------------------------------------

tr &lt;- Translator$new()
tr$set_text(en = "Hello, world!", fr = "Bonjour, monde!")
tr$translate("Hello, world!", lang = "en")  ## Outputs "Hello, world!"
tr$translate("Hello, world!", lang = "fr")  ## Outputs "Bonjour, monde!"

## ------------------------------------------------
## Method `Translator$get_translation`
## ------------------------------------------------

tr &lt;- Translator$new()
tr$set_text(en = "Hello, world!")

# Consider using translate() instead.
tr$get_translation("256e0d7", "en")  ## Outputs "Hello, world!"

## ------------------------------------------------
## Method `Translator$get_text`
## ------------------------------------------------

tr &lt;- Translator$new()
tr$set_text(en = "Hello, world!")

tr$get_translation("256e0d7", "en")  ## Outputs "Hello, world!"

## ------------------------------------------------
## Method `Translator$set_text`
## ------------------------------------------------

tr &lt;- Translator$new()

tr$set_text(en = "Hello, world!", location())

## ------------------------------------------------
## Method `Translator$set_texts`
## ------------------------------------------------

# Set source language.
language_source_set("en")

tr &lt;- Translator$new()

# Create Text objects.
txt1 &lt;- text(
  location("a", 1L, 2L, 3L, 4L),
  en = "Hello, world!",
  fr = "Bonjour, monde!")

txt2 &lt;- text(
  location("b", 5L, 6L, 7L, 8L),
  en = "Farewell, world!",
  fr = "Au revoir, monde!")

tr$set_texts(txt1, txt2)

## ------------------------------------------------
## Method `Translator$rm_text`
## ------------------------------------------------

tr &lt;- Translator$new()
tr$set_text(en = "Hello, world!")

tr$rm_text("256e0d7")

## ------------------------------------------------
## Method `Translator$set_native_languages`
## ------------------------------------------------

tr &lt;- Translator$new()

tr$set_native_languages(en = "English", fr = "Français")

# Remove existing entries.
tr$set_native_languages(fr = NULL)

## ------------------------------------------------
## Method `Translator$set_default_value`
## ------------------------------------------------

tr &lt;- Translator$new()
tr$set_default_value("&lt;unavailable&gt;")
</code></pre>

<hr>
<h2 id='translator_read'>Read and Write Translations</h2><span id='topic+translator_read'></span><span id='topic+translator_write'></span><span id='topic+translations_read'></span><span id='topic+translations_write'></span><span id='topic+translations_paths'></span>

<h3>Description</h3>

<p>Export <code><a href="#topic+Translator">Translator</a></code> objects to text files and import such
files back into <span class="rlang"><b>R</b></span> as <code><a href="#topic+Translator">Translator</a></code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>translator_read(
  path = getOption("transltr.path"),
  encoding = "UTF-8",
  verbose = getOption("transltr.verbose", TRUE),
  translations = TRUE
)

translator_write(
  tr = translator(),
  path = getOption("transltr.path"),
  overwrite = FALSE,
  verbose = getOption("transltr.verbose", TRUE),
  translations = TRUE
)

translations_read(path = "", encoding = "UTF-8", tr = NULL)

translations_write(tr = translator(), path = "", lang = "")

translations_paths(
  tr = translator(),
  parent_dir = dirname(getOption("transltr.path"))
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="translator_read_+3A_path">path</code></td>
<td>
<p>A non-empty and non-NA character string. A path to a file to
read from, or write to.
</p>

<ul>
<li><p> This file must be a Translator file for <code><a href="#topic+translator_read">translator_read()</a></code>.
</p>
</li>
<li><p> This file must be a translations file for <code><a href="#topic+translations_read">translations_read()</a></code>.
</p>
</li></ul>

<p>See Details for more information. <code><a href="#topic+translator_write">translator_write()</a></code> automatically
creates the parent directories of <code>path</code> (recursively) if they do not
exist.</p>
</td></tr>
<tr><td><code id="translator_read_+3A_encoding">encoding</code></td>
<td>
<p>A non-empty and non-NA character string. The source character
encoding. In almost all cases, this should be UTF-8. Other encodings are
internally re-encoded to UTF-8 for portability.</p>
</td></tr>
<tr><td><code id="translator_read_+3A_verbose">verbose</code></td>
<td>
<p>A non-NA logical value. Should progress information be
reported?</p>
</td></tr>
<tr><td><code id="translator_read_+3A_translations">translations</code></td>
<td>
<p>A non-NA logical value. Should translations files also
be read, or written along with <code>path</code> (the Translator file)?</p>
</td></tr>
<tr><td><code id="translator_read_+3A_tr">tr</code></td>
<td>
<p>A <code><a href="#topic+Translator">Translator</a></code> object.
</p>
<p>This argument is <code>NULL</code> by default for <code><a href="#topic+translations_read">translations_read()</a></code>. If a
<code><a href="#topic+Translator">Translator</a></code> object is passed to this function, it
will read translations and further register them (as long as they
correspond to an existing source text).</p>
</td></tr>
<tr><td><code id="translator_read_+3A_overwrite">overwrite</code></td>
<td>
<p>A non-NA logical value. Should existing files be
overwritten? If such files are detected and <code>overwrite</code> is set equal
to <code>TRUE</code>, an error is thrown.</p>
</td></tr>
<tr><td><code id="translator_read_+3A_lang">lang</code></td>
<td>
<p>A non-empty and non-NA character string. The underlying language.
</p>
<p>A language is usually a code (of two or three letters) for a native
language name. While users retain full control over codes, it is best
to use language codes stemming from well-known schemes such as
<a href="https://en.wikipedia.org/wiki/IETF_language_tag">IETF BCP 47</a>, or
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes">ISO 639-1</a>
to maximize portability and cross-compatibility.</p>
</td></tr>
<tr><td><code id="translator_read_+3A_parent_dir">parent_dir</code></td>
<td>
<p>A non-empty and non-NA character string. A path to a
parent directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The information contained within a <code><a href="#topic+Translator">Translator</a></code> object is
split: translations are reorganized by language and exported independently
from other fields.
</p>
<p><code><a href="#topic+translator_write">translator_write()</a></code> creates two types of file: a single <em>Translator file</em>,
and zero, or more <em>translations files</em>. These are plain text files that can
be inspected and modified using a wide variety of tools and systems. They
target different audiences:
</p>

<ul>
<li><p> the Translator file is useful to developers, and
</p>
</li>
<li><p> translations files are meant to be shared with non-technical
collaborators such as translators.
</p>
</li></ul>

<p><code><a href="#topic+translator_read">translator_read()</a></code> first reads a Translator file and creates a
<code><a href="#topic+Translator">Translator</a></code> object from it. It then calls
<code><a href="#topic+translations_paths">translations_paths()</a></code> to list expected translations files (that should
normally be stored alongside the Translator file), attempts to read them,
and registers successfully imported translations.
</p>
<p>There are two requirements.
</p>

<ul>
<li><p> All files must be stored in the same directory. By default, this is set
equal to <code style="white-space: pre;">&#8288;inst/transltr/&#8288;</code> (see <code>getOption("transltr.path")</code>).
</p>
</li>
<li><p> Filenames of translations files are standardized and must correspond to
languages (language codes, see <code>lang</code>).
</p>
</li></ul>

<p>The inner workings of the serialization process are thoroughly described in
<code><a href="#topic+serialize">serialize()</a></code>.
</p>


<h4>Translator file</h4>

<p>A Translator file contains a <a href="https://yaml.org/spec/1.1/">YAML</a> (1.1)
representation of a <code><a href="#topic+Translator">Translator</a></code> object stripped of all
its translations except those that are registered as source text.
</p>



<h4>Translations files</h4>

<p>A translations file contains a <a href="#topic+flat_serialize">FLAT</a> representation of
a set of translations sharing the same target language. This format attempts
to be as simple as possible for non-technical collaborators.
</p>



<h3>Value</h3>

<p><code><a href="#topic+translator_read">translator_read()</a></code> returns an <code><a href="R6.html#topic+R6Class">R6</a></code> object of class
<code><a href="#topic+Translator">Translator</a></code>.
</p>
<p><code><a href="#topic+translator_write">translator_write()</a></code> returns <code>NULL</code>, invisibly. It is used for its
side-effects of
</p>

<ul>
<li><p> creating a Translator file to the location given by <code>path</code>, and
</p>
</li>
<li><p> creating further translations file(s) in the same directory if
<code>translations</code> is <code>TRUE</code>.
</p>
</li></ul>

<p><code><a href="#topic+translations_read">translations_read()</a></code> returns an S3 object of class
<code><a href="#topic+export">ExportedTranslations</a></code>.
</p>
<p><code><a href="#topic+translations_write">translations_write()</a></code> returns <code>NULL</code>, invisibly.
</p>
<p><code><a href="#topic+translations_paths">translations_paths()</a></code> returns a named character vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Translator">Translator</a></code>,
<code><a href="#topic+serialize">serialize()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set source language.
language_source_set("en")

# Create a path to a temporary Translator file.
temp_path &lt;- tempfile(pattern = "translator_", fileext = ".yml")
temp_dir  &lt;- dirname(temp_path)  ## tempdir() could also be used

# Create a Translator object.
# This would normally be done by find_source(), or translator_read().
tr &lt;- translator(
  id = "test-translator",
  en = "English",
  es = "Español",
  fr = "Français",
  text(
    en = "Hello, world!",
    fr = "Bonjour, monde!"),
  text(
    en = "Farewell, world!",
    fr = "Au revoir, monde!"))

# Export it. This creates 3 files: 1 Translator file, and 2 translations
# files because two non-source languages are registered. The file for
# language "es" contains placeholders and must be completed.
translator_write(tr, temp_path)
translator_read(temp_path)

# Translations can be read individually.
translations_files &lt;- translations_paths(tr, temp_dir)
translations_read(translations_files[["es"]])
translations_read(translations_files[["fr"]])

# This is rarely useful, but translations can also be exported individually.
# You may use this to add a new language, as long as it has an entry in the
# underlying Translator object (or file).
tr$set_native_languages(el = "Greek")

translations_files &lt;- translations_paths(tr, temp_dir)

translations_write(tr, translations_files[["el"]], "el")
translations_read(file.path(temp_dir, "el.txt"))

</code></pre>

<hr>
<h2 id='uuid'>Universally Unique Identifiers</h2><span id='topic+uuid'></span><span id='topic+uuid_raw'></span><span id='topic+uuid_is'></span>

<h3>Description</h3>

<p>Generate a random UUID (<em>Universally Unique Identifier</em>) that complies to
what <a href="https://www.rfc-editor.org/rfc/rfc4122">RFC4122</a> prescribes. Such a
value is also known as a <em>version 4</em> UUID.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uuid()

uuid_raw()

uuid_is(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uuid_+3A_x">x</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+uuid">uuid()</a></code> calls <code><a href="#topic+uuid_raw">uuid_raw()</a></code> and formats its output accordingly.
</p>
<p>Pseudo-random bytes are generated with <code><a href="base.html#topic+sample">sample()</a></code> whenever <code><a href="#topic+uuid_raw">uuid_raw()</a></code>
is called. This is most likely done before runtime when
<code><a href="#topic+Translator">Translator</a></code> objects are created. <code><a href="#topic+uuid_raw">uuid_raw()</a></code> samples values
in the <code style="white-space: pre;">&#8288;[0, 255]&#8288;</code> range with replacement and converts them to <a href="base.html#topic+raw">raw</a>
values. The user must ensure that the underlying seed is appropriate when
generating UUIDs. See <code><a href="base.html#topic+set.seed">set.seed()</a></code> for more information.
</p>


<h3>Value</h3>

<p><code><a href="#topic+uuid">uuid()</a></code> returns a character of length 1 containing exactly 36
characters: 32 hexadecimal characters and 4 hyphens (used as separators).
</p>
<p><code><a href="#topic+uuid_raw">uuid_raw()</a></code> returns a raw vector of length 16.
</p>
<p><code><a href="#topic+uuid_is">uuid_is()</a></code> returns a logical vector having the same length as <code>x</code>. It
checks whether its elements are valid version 4 (variant 1) UUIDs or
not. It returns <code>FALSE</code> for any other kind of UUID.
</p>


<h3>Note</h3>

<p>UUIDs are designed to be globally unique (collisions are extremely unlikely)
and are sometimes called GUIDs (<em>Globally Unique Identifiers</em>). There are
several UUID versions with slightly different purposes.
</p>
<p>Package <code><a href="#topic+transltr">transltr</a></code> uses random identifiers (version 4/variant 1,
also known as DCE 1.1, ISO/IEC 11578:1996).
</p>


<h3>See Also</h3>

<p><a href="https://www.rfc-editor.org/rfc/rfc4122">RFC4122</a>,
<a href="https://www.uuidtools.com/uuid-versions-explained">UUIDs explained</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>uuid()
uuid_raw()
uuid_is(uuid())      ## TRUE
uuid_is(uuid_raw())  ## FALSE, uuid_raw() does not return a string.

</code></pre>

<hr>
<h2 id='vapply_1l'>Apply Wrappers</h2><span id='topic+vapply_1l'></span><span id='topic+vapply_1i'></span><span id='topic+vapply_1c'></span><span id='topic+map'></span>

<h3>Description</h3>

<p>These functions wrap a function of the <code><a href="base.html#topic+lapply">apply()</a></code>
family, and enforce various values for convenience. Arguments are
passed <em>as is</em> to an <code><a href="base.html#topic+lapply">apply()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vapply_1l(x, fun, ...)

vapply_1i(x, fun, ...)

vapply_1c(x, fun, ...)

map(fun, ..., more = list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vapply_1l_+3A_x">x</code></td>
<td>
<p>See argument <code>X</code> of <code><a href="base.html#topic+lapply">vapply()</a></code>.</p>
</td></tr>
<tr><td><code id="vapply_1l_+3A_fun">fun</code></td>
<td>
<p>See argument <code>FUN</code> of <code><a href="base.html#topic+lapply">vapply()</a></code>, and
<code><a href="base.html#topic+.mapply">.mapply()</a></code>.</p>
</td></tr>
<tr><td><code id="vapply_1l_+3A_...">...</code></td>
<td>
<p>Further optional arguments passed to <code>fun</code>.</p>
</td></tr>
<tr><td><code id="vapply_1l_+3A_more">more</code></td>
<td>
<p>See argument <code>MoreArgs</code> of <code><a href="base.html#topic+.mapply">.mapply()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+vapply_1l">vapply_1l()</a></code>,
<code><a href="#topic+vapply_1l">vapply_1l()</a></code>, and
<code><a href="#topic+vapply_1c">vapply_1c()</a></code> respectively return a logical, an integer, and a character
vector having the same length as <code>x</code>. Names are always discarded.
</p>
<p><code><a href="#topic+map">map()</a></code> returns a list having the same length as the longest element passed
to  <code>...</code>.
</p>


<h3>See Also</h3>

<p>Other utility functions: 
<code><a href="#topic+format_vector">format_vector</a>()</code>,
<code><a href="#topic+stops">stops</a>()</code>,
<code><a href="#topic+str_to">str_to</a>()</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
