<!DOCTYPE html><html lang="en-US"><head><title>Help for package shoredate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {shoredate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#create_isobases'><p>Create isobases with different directions within the spatial coverage in</p>
south-eastern Norway</a></li>
<li><a href='#displacement_plot'><p>Plot shoreline displacement curves</p></a></li>
<li><a href='#interpolate_curve'><p>Interpolate displacement curve to a target location within the spatial</p>
coverage in south-eastern Norway</a></li>
<li><a href='#print.shoreline_date'><p>Print shoreline dates to console</p></a></li>
<li><a href='#shoredate_hdr'><p>Find the highest density region of shoreline dates</p></a></li>
<li><a href='#shoredate_plot'><p>Plot shoreline dates</p></a></li>
<li><a href='#shoredate_sumplot'><p>Plot the summed probability distribution of multiple shoreline dates</p></a></li>
<li><a href='#shoreline_date'><p>Shoreline date</p></a></li>
<li><a href='#sum_shoredates'><p>Sum the probability of multiple shoreline dates</p></a></li>
<li><a href='#target_plot'><p>Plot a map with target locations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Shoreline Dating Coastal Stone Age Sites</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for shoreline dating coastal Stone Age sites. The 
  implemented method was developed in Roalkvam (2023) 
  &lt;<a href="https://doi.org/10.1016%2Fj.quascirev.2022.107880">doi:10.1016/j.quascirev.2022.107880</a>&gt; for the Norwegian Skagerrak coast. 
  Although it can be extended to other areas, this also forms the core area for 
  application of the package. Shoreline dating is based on the present-day 
  elevation of a site, a reconstruction of past relative sea-level change, and
  empirically derived estimates of the likely elevation of the sites above the 
  contemporaneous sea-level when they were in use. The geographical and temporal 
  coverage of the method thus follows from the availability of local geological 
  reconstructions of shoreline displacement and the degree to which the 
  settlements to be dated have been located on or close to the shoreline when 
  they were in use. Methods for numerical treatment and visualisation of the 
  dates are provided, along with basic tools for visualising and evaluating the 
  location of sites. </td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/isakro/shoredate">https://github.com/isakro/shoredate</a>,
<a href="https://isakro.github.io/shoredate/">https://isakro.github.io/shoredate/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/isakro/shoredate/issues">https://github.com/isakro/shoredate/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, ggrepel, ggridges, ggspatial, sf, terra, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, elevatr, knitr, rmarkdown, testthat (&ge; 3.0.0), vdiffr,
rnaturalearth</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-24 15:49:29 UTC; isak</td>
</tr>
<tr>
<td>Author:</td>
<td>Isak Roalkvam <a href="https://orcid.org/0000-0001-6974-1374"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Isak Roalkvam &lt;isakroa@protonmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-24 16:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='create_isobases'>Create isobases with different directions within the spatial coverage in
south-eastern Norway</h2><span id='topic+create_isobases'></span>

<h3>Description</h3>

<p>Function to create isobases for interpolating shoreline displacement curves
within the spatial coverage in south-eastern Norway. This is done from the
centre points of the supplied displacement curves. Isobases can also be
created for multiple directions, which is useful for testing the sensitivity
of dates to the direction of the isobases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_isobases(isobase_direction)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_isobases_+3A_isobase_direction">isobase_direction</code></td>
<td>
<p>A numerical vector holding a single or multiple
directions for the isobases.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A simple feature holding the isobases represented as lines.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create isobases in a specified direction
isobases &lt;- create_isobases(327)
plot(sf::st_geometry(isobases))

# Create isobases using different directions
isobases &lt;- create_isobases(c(327, 338))

# Plot for visualisation
plot(sf::st_geometry(isobases))
</code></pre>

<hr>
<h2 id='displacement_plot'>Plot shoreline displacement curves</h2><span id='topic+displacement_plot'></span>

<h3>Description</h3>

<p>Function for plotting shoreline displacement curves. Calling to plot without
providing a target curve will display the four underlying geologically
derived displacement curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>displacement_plot(
  target_curve = NA,
  displacement_curves = c("Horten", "Porsgrunn", "Tvedestrand", "Arendal"),
  target_name = "Target curve",
  target_line = "solid",
  target_col = "red",
  target_alpha = 1,
  displacement_line = c(Horten = "solid", Porsgrunn = "solid", Tvedestrand = "solid",
    Arendal = "solid"),
  displacement_col = c(Horten = "darkorange", Porsgrunn = "darkgreen", Tvedestrand =
    "blue", Arendal = "black"),
  displacement_alpha = 1,
  greyscale = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="displacement_plot_+3A_target_curve">target_curve</code></td>
<td>
<p>Data frame holding a shoreline displacement curve.</p>
</td></tr>
<tr><td><code id="displacement_plot_+3A_displacement_curves">displacement_curves</code></td>
<td>
<p>Character vector specifying which geologically
informed displacement curves should be plotted. Accepted values are
<code>c("Horten", "Porsgrunn", "Tvedestrand", "Arendal")</code>. All are included by
default.</p>
</td></tr>
<tr><td><code id="displacement_plot_+3A_target_name">target_name</code></td>
<td>
<p>Character value specifying the name that is given to the
target curve, if provided. Defaults to <code>"Target curve"</code>.</p>
</td></tr>
<tr><td><code id="displacement_plot_+3A_target_line">target_line</code></td>
<td>
<p>Character value specifying the line type that is used for
the target curve, if this is provided. Defaults to <code>"solid"</code>.</p>
</td></tr>
<tr><td><code id="displacement_plot_+3A_target_col">target_col</code></td>
<td>
<p>Character value specifying the colour that is used for the
target curve, if this is provided. Defaults to <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="displacement_plot_+3A_target_alpha">target_alpha</code></td>
<td>
<p>Numerical value specifying the alpha value that is used
for the target curve, if this is provided. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="displacement_plot_+3A_displacement_line">displacement_line</code></td>
<td>
<p>Character vector specifying the line types that are
used for the geological displacement curves to be plotted. Defaults to
<code>c("Horten" = "solid", "Porsgrunn" = "solid", "Tvedestrand" = "solid", "Arendal" = "solid")</code>.</p>
</td></tr>
<tr><td><code id="displacement_plot_+3A_displacement_col">displacement_col</code></td>
<td>
<p>Character vector specifying the colours that are
used for the geological displacement curves to be plotted. Defaults to
<code>c("Horten" = "darkorange", "Porsgrunn" = "darkgreen", "Tvedestrand" = "blue", "Arendal" = "black")</code>.</p>
</td></tr>
<tr><td><code id="displacement_plot_+3A_displacement_alpha">displacement_alpha</code></td>
<td>
<p>Numerical value specifying the alpha value that are
used for all of the geological displacement curves to be plotted. Defaults
to 1.</p>
</td></tr>
<tr><td><code id="displacement_plot_+3A_greyscale">greyscale</code></td>
<td>
<p>Logical value indicating whether the plot should be in
greyscale or not. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot displaying the underlying shoreline displacement curves and,
if provided, a target curve.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Empty plot for speed
displacement_plot(displacement_curves = "")

</code></pre>

<hr>
<h2 id='interpolate_curve'>Interpolate displacement curve to a target location within the spatial
coverage in south-eastern Norway</h2><span id='topic+interpolate_curve'></span>

<h3>Description</h3>

<p>Interpolate the trajectory of past shoreline displacement to a target
location within the spatial coverage on the Skagerrak coast of south-eastern
Norway. This based on the distance of the location to the shoreline isobases
of the geologically derived displacement curves and is done using inverse
distance weighting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolate_curve(
  target,
  isobases = NA,
  power = 2,
  cal_reso = 10,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interpolate_curve_+3A_target">target</code></td>
<td>
<p>A spatial target location to where the new displacement curve
is interpolated.</p>
</td></tr>
<tr><td><code id="interpolate_curve_+3A_isobases">isobases</code></td>
<td>
<p>4 spatial lines representing the shoreline isobases of the
existing displacement curves. Multiple sets of 4 isobases with different
isobase directions can be provided (see <code><a href="#topic+create_isobases">create_isobases()</a></code>). Defaults to
isobases with a direction of <code>327</code>.</p>
</td></tr>
<tr><td><code id="interpolate_curve_+3A_power">power</code></td>
<td>
<p>A numerical value indicating the inverse distance power for IDW.
Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="interpolate_curve_+3A_cal_reso">cal_reso</code></td>
<td>
<p>A numerical value specifying the resolution to use on the
calendar scale. Defaults to <code>10</code>.</p>
</td></tr>
<tr><td><code id="interpolate_curve_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether progress should be printed to
console. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list holding an interpolated displacement curve for each
isobase direction. Each displacement curve is represented by a data frame
with the columns <code>bce</code> where negative values indicate years BCE and positive
CE, <code>lowerelev</code>, representing the lower limit for the elevation of the
shoreline for each year. <code>upperelev</code>, the upper limit for elevation of the
shoreline for each year, and <code>direction</code> which indicates the direction of
the isobases used when interpolating the curve.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create example point using the required coordinate system
# WGS84 / zone UTM32N (EPSG: 32632)
target_point &lt;- sf::st_sfc(sf::st_point(c(579570, 6582982)), crs = 32632)

# Interpolate shoreline displacement curve to the target point location,
# setting the resolution on the calendar scale to 2000 years for speed.
target_curve &lt;- interpolate_curve(target_point, cal_reso = 2000)
</code></pre>

<hr>
<h2 id='print.shoreline_date'>Print shoreline dates to console</h2><span id='topic+print.shoreline_date'></span>

<h3>Description</h3>

<p>Print the dates held in a <code>shoreline_date</code> object. Each date is printed
with site name, elevation and highest density region. If the isobase
direction is different or more are provided than the default, the
directions and dates associated with these are printed separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shoreline_date'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.shoreline_date_+3A_x">x</code></td>
<td>
<p>Object of class <code>shoreline_date</code>.</p>
</td></tr>
<tr><td><code id="print.shoreline_date_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print the site names, elevations, non-default isobase directions and
HDRs contained in a <code>shoreline_date</code> object to console.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>target_point &lt;- sf::st_sfc(sf::st_point(c(538310, 6544255)), crs = 32632)

# Reduce date resolution with cal_reso and elevation_reso for speed
target_date &lt;- shoreline_date(site = target_point,
                              elevation = 70,
                              elev_reso = 1,
                              cal_reso = 400)

# Print to console
target_date
</code></pre>

<hr>
<h2 id='shoredate_hdr'>Find the highest density region of shoreline dates</h2><span id='topic+shoredate_hdr'></span>

<h3>Description</h3>

<p>Function to find 95% highest density region (HDR) for a provided shoreline
date. Negative values denote years BCE while positive values denote CE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shoredate_hdr(bce, probability, site_name, cal_reso, prob = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shoredate_hdr_+3A_bce">bce</code></td>
<td>
<p>A vector holding calendar years associated with a date.</p>
</td></tr>
<tr><td><code id="shoredate_hdr_+3A_probability">probability</code></td>
<td>
<p>A vector holding the probability mass corresponding to
each calendar year.</p>
</td></tr>
<tr><td><code id="shoredate_hdr_+3A_site_name">site_name</code></td>
<td>
<p>A vector holding the name of the site that has been dated.</p>
</td></tr>
<tr><td><code id="shoredate_hdr_+3A_cal_reso">cal_reso</code></td>
<td>
<p>Resolution on the calendar scale used when dating the site.</p>
</td></tr>
<tr><td><code id="shoredate_hdr_+3A_prob">prob</code></td>
<td>
<p>A numerical value between 0 and 1 indicating the probability
coverage of the HDR. Defaults to <code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list holding start and end points for segments of the highest
density region of a shoreline date, the weighted mean date,
the probability coverage and site name.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>target_point &lt;- sf::st_sfc(sf::st_point(c(538310, 6544255)), crs = 32632)

# Reduce date resolution with cal_reso and elevation_reso for speed
target_date &lt;- shoreline_date(sites = target_point,
                              elevation = 80,
                              elev_reso = 1,
                              cal_reso = 400)

# shoredate_hdr() is already called under the hood with shoreline_date(),
# the result of which is printed when calling the shoreline_date object
target_date

# However, shoredate_hdr() can be applied separately by pulling the
# necessary data from the date
(shoredate_hdr(target_date[[1]][[1]]$date$bce,
               target_date[[1]][[1]]$date$probability,
               target_date[[1]][[1]]$site_name,
               target_date[[1]][[1]]$cal_reso))
</code></pre>

<hr>
<h2 id='shoredate_plot'>Plot shoreline dates</h2><span id='topic+shoredate_plot'></span>

<h3>Description</h3>

<p>Function for plotting shoreline dates along with associated metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shoredate_plot(
  shorelinedates,
  date_probability = TRUE,
  date_probability_scale = 10000,
  elevation_distribution = TRUE,
  displacement_curve = TRUE,
  site_name = FALSE,
  parameters = FALSE,
  isobase_direction = FALSE,
  highest_density_region = TRUE,
  hdr_label = TRUE,
  multiplot = FALSE,
  date_col = NA,
  date_fill = "darkgrey",
  displacement_col = "red",
  displacement_fill = "red",
  site_elevation_col = "#046c9a",
  site_elevation_fill = "#046c9a",
  hdr_col = "black",
  hdr_label_xadj = 0.2,
  hdr_label_yadj = 0.3,
  greyscale = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shoredate_plot_+3A_shorelinedates">shorelinedates</code></td>
<td>
<p>Object of class <code>shoreline_date</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_date_probability">date_probability</code></td>
<td>
<p>Logical value indicating whether the
probability distribution of the shoreline date should be plotted.
Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_date_probability_scale">date_probability_scale</code></td>
<td>
<p>Numerical constant with which to scale the
probability distribution of the date to make it fit the plot. Defaults to
10000.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_elevation_distribution">elevation_distribution</code></td>
<td>
<p>Logical value indicating whether the
distribution describing the distance between site and shoreline should be
displayed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_displacement_curve">displacement_curve</code></td>
<td>
<p>Logical value indicating whether the displacement
curve should be displayed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_site_name">site_name</code></td>
<td>
<p>Logical value indicating whether the name of the site should
be printed in the header of the plot. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_parameters">parameters</code></td>
<td>
<p>Logical value indicating whether the parameters of the
statistical function should be displayed. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_isobase_direction">isobase_direction</code></td>
<td>
<p>Logical value indicating whether the direction of
the isobases should be printed. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_highest_density_region">highest_density_region</code></td>
<td>
<p>Logical value indicating whether the 95%
highest density region should be displayed. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_hdr_label">hdr_label</code></td>
<td>
<p>Logical value indicating whether the numeric values for the
highest density regions should be displayed. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_multiplot">multiplot</code></td>
<td>
<p>Logical value indicating whether multiple dates should be
plotted individually, or be collapsed into a single plot. The only other
graphical option with <code>multiplot</code> set to <code>TRUE</code> is <code>highest_density_region</code>.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_date_col">date_col</code></td>
<td>
<p>Character value specifying the outline colour of the
probability distribution of the shoreline date. Defaults to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_date_fill">date_fill</code></td>
<td>
<p>Character value specifying the fill colour of the
probability distribution of the shoreline date. Defaults to <code>"darkgrey"</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_displacement_col">displacement_col</code></td>
<td>
<p>Character value specifying the outline colour of the
displacement curve. Defaults to <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_displacement_fill">displacement_fill</code></td>
<td>
<p>Character value specifying the fill colour of the
displacement curve. Defaults to <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_site_elevation_col">site_elevation_col</code></td>
<td>
<p>Character value specifying the outline colour of
the distribution describing the likely distance between site and shoreline.
Defaults to <code>"#046c9a"</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_site_elevation_fill">site_elevation_fill</code></td>
<td>
<p>Character value specifying the fill colour of
the distribution describing the likely distance between site and shoreline.
Defaults to <code>"#046c9a"</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_hdr_col">hdr_col</code></td>
<td>
<p>Character value specifying the colour of the line
segment giving the highest density region of the shoreline date. Defaults to
<code>"black"</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_hdr_label_xadj">hdr_label_xadj</code></td>
<td>
<p>Numerical value between 0 and 1 specifying the position
of the HDR label on the x-axis. Increasing the value moves the label further
from the plot border. Defaults to <code>0.2</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_hdr_label_yadj">hdr_label_yadj</code></td>
<td>
<p>Numerical value between 0 and 1 specifying the position
of the HDR label on the y-axis. Increasing the value moves the label further
from the plot border. Defaults to <code>0.3</code>.</p>
</td></tr>
<tr><td><code id="shoredate_plot_+3A_greyscale">greyscale</code></td>
<td>
<p>Logical value indicating whether the plot should be in
greyscale or not. If <code>TRUE</code>, overrides other colour parameters.
Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>shoredate_plot()</code> returns a plot displaying the provided shoreline
dates. A single plot is created for each date, where a range of settings can
be adjusted to display or hide various parameters and results. Setting the
parameter <code>multiplot</code> to <code>TRUE</code> returns a sparser version for multiple
dates, where the only option is whether or not to display the highest
density region in addition to each date. <code>multiplot</code> does not allow for
multiple isobase directions. Negative values denote years BCE while positive
values denote CE.
</p>


<h3>Value</h3>

<p>Plot(s) displaying shoreline dates and associated metadata.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create example point with correct coordinate reference system
target_point &lt;- sf::st_sfc(sf::st_point(c(538310, 6544255)), crs = 32632)

# Reduce date resolution with cal_reso and elevation_reso for speed
target_date &lt;- shoreline_date(sites = target_point, elevation = 80,
                              elev_reso = 10,
                              cal_reso = 500)

shoredate_plot(target_date)
</code></pre>

<hr>
<h2 id='shoredate_sumplot'>Plot the summed probability distribution of multiple shoreline dates</h2><span id='topic+shoredate_sumplot'></span>

<h3>Description</h3>

<p>Function to plot the sum of the probabilities of multiple shoreline dates as
resulting from running <code>sum_shoredates()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shoredate_sumplot(shoredates_sum, sample_size = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shoredate_sumplot_+3A_shoredates_sum">shoredates_sum</code></td>
<td>
<p>Object of class <code>shoredates_sum</code>.</p>
</td></tr>
<tr><td><code id="shoredate_sumplot_+3A_sample_size">sample_size</code></td>
<td>
<p>Logical indicating whether or not to display the number of
summed dates on the plot. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A line plot showing the provided summed probability distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create example points
target_points &lt;- sf::st_sfc(sf::st_point(c(538310, 6544255)),
                            sf::st_point(c(538300, 6544250)))

# Set correct CRS
target_points &lt;- sf::st_as_sf(target_points, crs = 32632)

# Reduce date resolution with cal_reso and elevation_reso for speed
target_dates &lt;- shoreline_date(target_points,
                               elevation = c(65, 70),
                               elev_reso = 10,
                               cal_reso = 750)

# Find summed probability
target_sum &lt;- sum_shoredates(target_dates)

# Call to plot
shoredate_sumplot(target_sum)
</code></pre>

<hr>
<h2 id='shoreline_date'>Shoreline date</h2><span id='topic+shoreline_date'></span>

<h3>Description</h3>

<p>A function for shoreline dating Stone Age sites based on their present-day
elevation, their likely elevation above sea-level when in use and the
trajectory of past shoreline displacement. Details and caveats pertaining to
the implemented method is given in Roalkvam (2023).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shoreline_date(
  sites,
  elevation = NA,
  elev_reso = 0.01,
  cal_reso = 10,
  isobase_direction = 327,
  sum_isobase_directions = FALSE,
  model = "gamma",
  model_parameters = c(0.286, 20.833),
  elev_fun = "mean",
  upper_temp_limit = -2500,
  target_curve = NA,
  hdr_prob = 0.95,
  normalise = TRUE,
  sparse = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shoreline_date_+3A_sites">sites</code></td>
<td>
<p>Vector giving one or more site names, or, if displacement curves
are to be interpolated, objects of class <code>sf</code> representing the sites to be
dated. In the case of a spatial geometry, the first column is taken as the
site name.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_elevation">elevation</code></td>
<td>
<p>Vector of numeric elevation values for each site or a
an elevation raster of class <code>SpatRaster</code> from the package
<code>terra</code> from where the elevation values are to be derived.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_elev_reso">elev_reso</code></td>
<td>
<p>Numeric value specifying the resolution with which to step
through the distribution representing the distance between site and
shoreline. Defaults to 0.01m.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_cal_reso">cal_reso</code></td>
<td>
<p>Numeric value specifying the resolution to use on the
calendar scale. Defaults to 10.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_isobase_direction">isobase_direction</code></td>
<td>
<p>A vector of numeric values defining the direction(s)
of the isobases. Defaults to 327.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_sum_isobase_directions">sum_isobase_directions</code></td>
<td>
<p>Logical value indicating that if multiple
isobase directions are specified in <code>isobase_direction</code> the results should
be summed for each site using <code>sum_shoredates</code>. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_model">model</code></td>
<td>
<p>Character vector specifying the statistical model with which to
model the distance from site to shoreline. Currently accepts either &quot;none&quot;
or &quot;gamma&quot;. Defaults to &quot;gamma&quot;.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_model_parameters">model_parameters</code></td>
<td>
<p>Vector of numeric values specifying the parameters
for the statistical model describing the distance between site and
shoreline. Defaults to c(0.286, 20.833), denoting the shape and scale of the
default gamma function, respectively.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_elev_fun">elev_fun</code></td>
<td>
<p>Statistic to define site elevation if this is to be derived
from an elevation raster. Uses <code>terra::extract()</code>. Defaults to mean.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_upper_temp_limit">upper_temp_limit</code></td>
<td>
<p>Numerical value giving the upper temporal limit.
Dates with a start date after the limit are returned as NA. Defaults to
-2500, i.e. 2500 BCE.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_target_curve">target_curve</code></td>
<td>
<p>Data frame holding pre-computed shoreline displacement
curve. This has to have the same or higher resolution on the calendar scale
as that specified with <code>cal_reso</code>. <code><a href="#topic+interpolate_curve">interpolate_curve()</a></code> will be run if
nothing is provided to <code>target_curve</code>. Defaults to NA.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_hdr_prob">hdr_prob</code></td>
<td>
<p>Numeric value specifying the coverage of the highest density
region. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_normalise">normalise</code></td>
<td>
<p>Logical value specifying whether the shoreline date should
be normalised to sum to unity. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_sparse">sparse</code></td>
<td>
<p>Logical value specifying if only site name and shoreline date
should be returned. Defaults to FALSE. Note that of the functions for
further treatment, sparse dates are only compatible with
<code><a href="#topic+sum_shoredates">sum_shoredates()</a></code>.</p>
</td></tr>
<tr><td><code id="shoreline_date_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether progress should be printed to
console. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A nested list of class <code>shoreline_date</code> holding the shoreline date
results and associated metadata for each dated site for each isobase
direction. The elements of each date is:
</p>

<ul>
<li> <p><code>site_name</code> name of the site.
</p>
</li>
<li> <p><code>site_elev</code> elevation of the site.
</p>
</li>
<li> <p><code>date</code> data frame with the columns <code>bce</code> where negative values
indicate years BCE and positive CE, as well as <code>probability</code>, which gives
the probability mass for each year.
</p>
</li>
<li> <p><code>weighted_mean</code> the weighted mean date.
</p>
</li>
<li> <p><code>hdr_start</code> start values for the HDR ranges.
</p>
</li>
<li> <p><code>hdr_end</code> end values for the HDR ranges.
</p>
</li>
<li> <p><code>hdr_prob</code> probability level for the HDR.
</p>
</li>
<li> <p><code>dispcurve</code> data frame holding the displacement curve used for dating
the site. This has the columns <code>bce</code>, giving years BCE/CE. <code>lowerelev</code>,
the lower limit for the elevation of the shoreline for each year.
<code>upperelev</code>, the upper limit for elevation of the shoreline for each year.
</p>
</li>
<li> <p><code>dispcurve_direction</code> direction of the isobases in use.
</p>
</li>
<li> <p><code>model_parameters</code> parameters for the statistical model.
</p>
</li>
<li> <p><code>modeldat</code> data frame holding the model distribution. The column
<code>offset</code> denotes the vertical distance (m) from the shoreline, as specified
by the <code>elev_reso</code> argument. <code>px</code> is the cumulative probability at each step
of <code>offset</code>, and <code>probs</code> is the probability of each step found by
subtracting the preceding value from each value of <code>px</code>.
</p>
</li>
<li> <p><code>cal_reso</code> resolution on the calendar scale.
</p>
</li></ul>



<h3>References</h3>

<p>Roalkvam, I. 2023. A simulation-based assessment of the relation between
Stone Age sites and relative sea-level change along the Norwegian Skagerrak
coast. <em>Quaternary Science Reviews</em> 299:107880. DOI:
https://doi.org/10.1016/j.quascirev.2022.107880
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create example point using the required CRS WGS84 UTM32N (EPSG: 32632)
target_point &lt;- sf::st_sfc(sf::st_point(c(538310, 6544255)), crs = 32632)

# Date target point, manually specifying the elevation instead of providing
# an elevation raster. Reducing elev_reso and cal_reso for speed.
shoreline_date(sites = target_point,
               elevation = 80,
               elev_reso = 1,
               cal_reso = 400)
</code></pre>

<hr>
<h2 id='sum_shoredates'>Sum the probability of multiple shoreline dates</h2><span id='topic+sum_shoredates'></span>

<h3>Description</h3>

<p>Function for finding the summed probability distribution of multiple
shoreline dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_shoredates(
  shoreline_dates,
  cut_off = -2500,
  cut_off_level = 1,
  normalise = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sum_shoredates_+3A_shoreline_dates">shoreline_dates</code></td>
<td>
<p>Object of class <code>shoreline_date</code>.</p>
</td></tr>
<tr><td><code id="sum_shoredates_+3A_cut_off">cut_off</code></td>
<td>
<p>Calendar year specifying where dates should be cut off.
Defaults to 2500 BCE.</p>
</td></tr>
<tr><td><code id="sum_shoredates_+3A_cut_off_level">cut_off_level</code></td>
<td>
<p>Numerical value between 0 and 1 indicating the
probability mass that has to fall after the cut-off for a date to be
excluded. Defaults to 1, retaining all dates.</p>
</td></tr>
<tr><td><code id="sum_shoredates_+3A_normalise">normalise</code></td>
<td>
<p>Logical value indicating whether the probability sum of the
dates should be normalised to sum to unity. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of class <code>shoredate_sum</code> holding the elements:
</p>

<ul>
<li> <p><code>sum</code> data frame with the columns <code>bce</code> where negative values
indicate years BCE and positive CE, as well as <code>probability</code>, which gives
the probability mass for each year.
</p>
</li>
<li> <p><code>dates_n</code> number of dates that make up the sum after applying any
specified cut-off. One date per site per isobase direction.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>target_points &lt;- sf::st_sfc(sf::st_point(c(538310, 6544255)),
                            sf::st_point(c(538300, 6544250)))
target_points &lt;- sf::st_as_sf(target_points, crs = 32632)

# Shoreline date, reducing resoltuion on elevation and calendar scales for
# speed.
target_dates &lt;- shoreline_date(target_points,
                               elevation = c(65, 70),
                               elev_reso = 10,
                               cal_reso = 500)

sum_shoredates(target_dates)
</code></pre>

<hr>
<h2 id='target_plot'>Plot a map with target locations</h2><span id='topic+target_plot'></span>

<h3>Description</h3>

<p>Function to plot the centroids of sites to be dated and shoreline isobases of
employed displacement curves on a basemap. Defaults to displaying a
light-weight version of the spatial coverage in south-eastern Norway.
However, spatial geometries covering other regions can also be provided or
temporarily downloaded with the function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>target_plot(
  targets = NA,
  isobases = sf::st_read(system.file("extdata/isobases.gpkg", package = "shoredate",
    mustWork = TRUE), quiet = TRUE),
  basemap = sf::st_read(system.file("extdata/naturalearth_basemap.gpkg", package =
    "shoredate", mustWork = TRUE), quiet = TRUE),
  crs_epsg = 32632,
  naturalearth_basemap = FALSE,
  naturalearth_zoom = c(20000, 20000),
  target_labels = TRUE,
  scalebar = TRUE,
  scalebar_width = 0.4,
  scalebar_style = "ticks",
  scalebar_location = "br",
  base_fill = "grey",
  base_col = NA,
  target_shape = 21,
  target_col = "black",
  target_fill = "red",
  target_size = 2.25,
  isobase_line = c(Horten = "solid", Porsgrunn = "solid", Tvedestrand = "solid", Arendal
    = "solid"),
  isobase_col = c(Arendal = "black", Porsgrunn = "darkgreen", Tvedestrand = "blue",
    Horten = "darkorange"),
  greyscale = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="target_plot_+3A_targets">targets</code></td>
<td>
<p>Objects of class <code>sf</code> representing the sites to be dated. The
first column beyond geom is taken as site name.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_isobases">isobases</code></td>
<td>
<p>Spatial lines as object of class <code>sf</code> representing the
shoreline isobases. Defaults to isobases with a direction of 327 within the
spatial limit in SE Norway, but <code>create_isobases()</code> can be used to create
isobases with other directions that can then be passed to <code>target_plot()</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_basemap">basemap</code></td>
<td>
<p>Object of class <code>sf</code> representing a background map. Defaults
to a light-weight basemap for the spatial limit in SE Norway.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_crs_epsg">crs_epsg</code></td>
<td>
<p>Numeric value specifying the EPSG code of the coordinate
reference system (CRS) to be used. Geometries with a different CRS will be
re-projected. Defaults to 32632, which is WGS 84 / UTM zone 32N
(EPSG:32632).</p>
</td></tr>
<tr><td><code id="target_plot_+3A_naturalearth_basemap">naturalearth_basemap</code></td>
<td>
<p>Logical value specifying if a background map
should be downloaded to be used as a basemap. Downloaded files are stored
with <code>base::tempdir()</code> and deleted when the R session is closed. If <code>TRUE</code>,
overrides the <code>basemap</code> argument. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_naturalearth_zoom">naturalearth_zoom</code></td>
<td>
<p>A vector of two numerical values specifying the
amount of cropping that is done around provided <code>targets</code> when
<code>naturalearth_basemap</code> is set to
<code>TRUE</code>. Be aware of whether a projected or geographical CRS is specified in
<code>crs_epsg</code>. Defaults to <code>c(20000, 20000)</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_target_labels">target_labels</code></td>
<td>
<p>Logical value specifying whether the targets should be
labelled in the plot. Takes the first column beyond the one holding the
geometries to represent names. If this is not present the targets are
labelled by row number. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_scalebar">scalebar</code></td>
<td>
<p>Logical specifying whether a scale bar should be added to the
plot. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_scalebar_width">scalebar_width</code></td>
<td>
<p>Numerical value specifying the width of the scale bar
by passing it to the <code>width_hint</code> argument of
<code>ggspatial::annotation:scale()</code>. Defaults to <code>0.4</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_scalebar_style">scalebar_style</code></td>
<td>
<p>Character value specifying the style of the scale bar
by passing it to the <code>style</code> argument of <code>ggspatial::annotation:scale()</code>.
Defaults to <code>"ticks"</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_scalebar_location">scalebar_location</code></td>
<td>
<p>Character value specifying the location of the
scale bar on the plot by passing it to the <code>location</code> argument of
<code>ggspatial::annotation:scale()</code>. Defaults to <code>"br"</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_base_fill">base_fill</code></td>
<td>
<p>Character value specifying the fill colour of the basemap.
Defaults to <code>"grey"</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_base_col">base_col</code></td>
<td>
<p>Character value specifying the outline colour of the
basemap. Defaults to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_target_shape">target_shape</code></td>
<td>
<p>Numerical value specifying the point shape that represent
the centroids of the targets. Defaults to <code>21</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_target_col">target_col</code></td>
<td>
<p>Character value specifying the colour parameter for the
points that represent the centroids of the targets. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_target_fill">target_fill</code></td>
<td>
<p>Character value specifying the fill parameter for the
points that represent the centroids of the targets. Defaults to <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_target_size">target_size</code></td>
<td>
<p>Numerical value specifying the size of the points that
represent the centroids of the targets. Defaults to <code>2.25</code>.</p>
</td></tr>
<tr><td><code id="target_plot_+3A_isobase_line">isobase_line</code></td>
<td>
<p>Vector of character values specifying the linetype that
is used to represent the isobases of the geologically derived displacement
curves. Defaults to <code>c("Horten" = "solid", "Porsgrunn" = "solid", "Tvedestrand" = "solid", "Arendal" = "solid")</code>.'</p>
</td></tr>
<tr><td><code id="target_plot_+3A_isobase_col">isobase_col</code></td>
<td>
<p>Vector of character values specifying the colours used
for the lines that represent the isobases of the geologically derived
displacement curves. Defaults to <code>c("Arendal" = "black", "Porsgrunn" = "darkgreen", "Tvedestrand" = "blue", "Horten" = "darkorange")</code>.'</p>
</td></tr>
<tr><td><code id="target_plot_+3A_greyscale">greyscale</code></td>
<td>
<p>Logical value indicating whether the plot should include
colours or not. Overrides other graphical parameters When set to <code>TRUE</code>.
Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot that displays a background map with the location of the
shoreline isobases within the spatial coverage in south-eastern Norway,
unless geometries for other regions are provided. If provided, the function
also plots the position of target locations represented as centroids.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Display the background map and default isobases
target_plot()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
