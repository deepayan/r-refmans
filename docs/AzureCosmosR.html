<!DOCTYPE html><html><head><title>Help for package AzureCosmosR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AzureCosmosR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#az_cosmosdb'><p>Azure Cosmos DB account class</p></a></li>
<li><a href='#bulk_delete'><p>Delete a set of documents from an Azure Cosmos DB container</p></a></li>
<li><a href='#bulk_import'><p>Import a set of documents to an Azure Cosmos DB container</p></a></li>
<li><a href='#cosmos_endpoint'><p>Client endpoint for Azure Cosmos DB core API</p></a></li>
<li><a href='#cosmos_mongo_endpoint'><p>MongoDB endpoint for Azure Cosmos DB</p></a></li>
<li><a href='#create_cosmosdb_account'><p>Create Azure Cosmos DB account</p></a></li>
<li><a href='#delete_cosmosdb_account'><p>Delete Azure Cosmos DB account</p></a></li>
<li><a href='#do_cosmos_op'><p>Carry out a Cosmos DB operation</p></a></li>
<li><a href='#get_cosmos_container'><p>Methods for working with Azure Cosmos DB containers</p></a></li>
<li><a href='#get_cosmos_database'><p>Methods for working with Azure Cosmos DB databases</p></a></li>
<li><a href='#get_cosmosdb_account'><p>Get Azure Cosmos DB account</p></a></li>
<li><a href='#get_document'><p>Methods for working with Azure Cosmos DB documents</p></a></li>
<li><a href='#get_partition_key'><p>Container partition key information</p></a></li>
<li><a href='#get_stored_procedure'><p>Methods for working with Azure Cosmos DB stored procedures</p></a></li>
<li><a href='#get_udf'><p>Methods for working with Azure Cosmos DB user-defined functions</p></a></li>
<li><a href='#query_documents'><p>Query an Azure Cosmos DB container</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Interface to the 'Azure Cosmos DB' 'NoSQL' Database Service</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>An interface to 'Azure CosmosDB': <a href="https://azure.microsoft.com/en-us/services/cosmos-db/">https://azure.microsoft.com/en-us/services/cosmos-db/</a>. On the admin side, 'AzureCosmosR' provides functionality to create and manage 'Cosmos DB' instances in Microsoft's 'Azure' cloud. On the client side, it provides an interface to the 'Cosmos DB' SQL API, letting the user store and query documents and attachments in 'Cosmos DB'. Part of the 'AzureR' family of packages.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Azure/AzureCosmosR">https://github.com/Azure/AzureCosmosR</a>
<a href="https://github.com/Azure/AzureR">https://github.com/Azure/AzureR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Azure/AzureCosmosR/issues">https://github.com/Azure/AzureCosmosR/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, AzureRMR (&ge; 2.3.3), curl, openssl, jsonlite, httr,
uuid, vctrs (&ge; 0.3.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>AzureTableStor, mongolite, DBI, odbc, dplyr, testthat, knitr,
rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-18 21:39:24 UTC; hongo</td>
</tr>
<tr>
<td>Author:</td>
<td>Hong Ooi [aut, cre],
  Andrew Liu [ctb] (Assistance with Cosmos DB),
  Microsoft [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hong Ooi &lt;hongooi73@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-18 23:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='az_cosmosdb'>Azure Cosmos DB account class</h2><span id='topic+az_cosmosdb'></span>

<h3>Description</h3>

<p>Class representing an Azure Cosmos DB account. For working with the data inside the account, see <a href="#topic+cosmos_endpoint">cosmos_endpoint</a> and <a href="#topic+cosmos_database">cosmos_database</a>.
</p>


<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;list_keys(read_only=FALSE&#8288;</code>): Return the access keys for this account.
</p>
</li>
<li> <p><code>regen_key(kind)</code>: Regenerate (change) an access key. <code>kind</code> should be one of &quot;primary&quot;, &quot;secondary&quot;, &quot;primaryReadonly&quot; or &quot;secondaryReadonly&quot;.
</p>
</li>
<li> <p><code>get_endpoint(interface, ...)</code>: Return a default endpoint object for interacting with the data. See 'Endpoints' below.
</p>
</li>
<li> <p><code>get_sql_endpoint(key, key_type)</code>: Return an object representing the core (SQL) endpoint of the account.
</p>
</li>
<li> <p><code>get_table_endpoint(key)</code>: Return an object representing the table storage endpoint of the account.
</p>
</li>
<li> <p><code>get_mongo_endpoint(collection, key, mongo_options)</code>: Return an object representing the MongoDB enpoint of the account.
</p>
</li></ul>



<h3>Details</h3>

<p>Initializing a new object of this class can either retrieve an existing Cosmos DB resource, or create a new resource on the host. Generally, the best way to initialize an object is via the <code>get_cosmosdb_account</code> or <code>create_cosmosdb_account</code> methods of the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class, which handle the details automatically.
</p>


<h3>Endpoints</h3>

<p>Azure Cosmos DB provides multiple APIs for accessing the data stored within the account. You choose at account creation the API that you want to use: core (SQL), table storage, Mongo DB, Apache Cassandra, or Gremlin. The following methods allow you to create an endpoint object corresponding to these APIs.
</p>

<ul>
<li> <p><code>get_endpoint(interface=NULL, ...)</code>: Return an endpoint object for interacting with the data. The default <code>interface=NULL</code> will choose the interface that you selected at account creation. Otherwise, set <code>interface</code> to one of &quot;sql&quot;, &quot;table&quot;, &quot;mongo&quot;, &quot;cassandra&quot; or &quot;gremlin&quot; to create an endpoint object for that API. It's an error to select an interface that the Cosmos DB account doesn't actually provide.
</p>
</li>
<li> <p><code>get_sql_endpoint(key, key_type=c("master", "resource"))</code>: Return an endpoint object for the core (SQL) API, of class <a href="#topic+cosmos_endpoint">cosmos_endpoint</a>. A master key provides full access to all the data in the account; a resource key provides access only to a chosen subset of the data.
</p>
</li>
<li> <p><code>get_table_endpoint(key)</code>: Return an endpoint object for the table storage API, of class <a href="AzureTableStor.html#topic+table_endpoint">AzureTableStor::table_endpoint</a>.
</p>
</li>
<li> <p><code>get_mongo_endpoint(key, mongo_options)</code>: Return an endpoint object for the MongoDB API, of class <a href="#topic+cosmos_mongo_endpoint">cosmos_mongo_endpoint</a>. <code>mongo_options</code> should be an optional named list of parameters to set in the connection string.
</p>
</li></ul>

<p>Note that AzureCosmosR provides a client framework only for the SQL API. To use the table storage API, you will also need the AzureTableStor package, and to use the MongoDB API, you will need the mongolite package. Currently, the Cassandra and Gremlin APIs are not supported.
</p>
<p>As an alternative to AzureCosmosR, you can also use the ODBC protocol to interface with the SQL API. By installing a suitable ODBC driver, you can then talk to Cosmos DB in a manner similar to other SQL databases. An advantage of the ODBC interface is that it fully supports cross-partition queries, unlike the REST API. A disadvantage is that it does not support nested document fields; functions like <code>array_contains()</code> cannot be used, and attempts to reference arrays and objects may return incorrect results.
</p>


<h3>See Also</h3>

<p><a href="#topic+get_cosmosdb_account">get_cosmosdb_account</a>, <a href="#topic+create_cosmosdb_account">create_cosmosdb_account</a>, <a href="#topic+delete_cosmosdb_account">delete_cosmosdb_account</a>
</p>
<p><a href="#topic+cosmos_endpoint">cosmos_endpoint</a>, <a href="#topic+cosmos_database">cosmos_database</a>, <a href="#topic+cosmos_container">cosmos_container</a>, <a href="#topic+query_documents">query_documents</a>, <a href="#topic+cosmos_mongo_endpoint">cosmos_mongo_endpoint</a>, <a href="AzureTableStor.html#topic+table_endpoint">AzureTableStor::table_endpoint</a>, <a href="mongolite.html#topic+mongo">mongolite::mongo</a>
</p>

<hr>
<h2 id='bulk_delete'>Delete a set of documents from an Azure Cosmos DB container</h2><span id='topic+bulk_delete'></span><span id='topic+bulk_delete.cosmos_container'></span>

<h3>Description</h3>

<p>Delete a set of documents from an Azure Cosmos DB container
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bulk_delete(container, ...)

## S3 method for class 'cosmos_container'
bulk_delete(
  container,
  query,
  partition_key,
  procname = "_AzureCosmosR_bulkDelete",
  headers = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bulk_delete_+3A_container">container</code></td>
<td>
<p>A Cosmos DB container object, as obtained by <code>get_cosmos_container</code> or <code>create_cosmos_container</code>.</p>
</td></tr>
<tr><td><code id="bulk_delete_+3A_query">query</code></td>
<td>
<p>A query specifying which documents to delete.</p>
</td></tr>
<tr><td><code id="bulk_delete_+3A_partition_key">partition_key</code></td>
<td>
<p>Optionally, limit the deletion only to documents with this key value.</p>
</td></tr>
<tr><td><code id="bulk_delete_+3A_procname">procname</code></td>
<td>
<p>The stored procedure name to use for the server-side import code. Change this if, for some reason, the default name is taken.</p>
</td></tr>
<tr><td><code id="bulk_delete_+3A_headers">headers</code>, <code id="bulk_delete_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to lower-level functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a convenience function to delete multiple documents from a container. It works by creating a stored procedure and then calling it with the supplied query as a parameter. This function is not meant for production use.
</p>


<h3>Value</h3>

<p>The number of rows deleted.
</p>


<h3>See Also</h3>

<p><a href="#topic+bulk_import">bulk_import</a>, <a href="#topic+cosmos_container">cosmos_container</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- cosmos_endpoint("https://myaccount.documents.azure.com:443/", key="mykey")
db &lt;- get_cosmos_database(endp, "mydatabase")
cont &lt;- create_cosmos_container(db, "mycontainer", partition_key="sex")

 # importing the Star Wars data from dplyr
bulk_import(cont, dplyr::starwars)

# deleting a subset of documents
bulk_delete(cont, "select * from mycontainer c where c.gender = 'masculine'")

# deleting documents for a specific partition key value
bulk_delete(cont, "select * from mycontainer", partition_key="male")

# deleting all documents
bulk_delete(cont, "select * from mycontainer")


## End(Not run)
</code></pre>

<hr>
<h2 id='bulk_import'>Import a set of documents to an Azure Cosmos DB container</h2><span id='topic+bulk_import'></span><span id='topic+bulk_import.cosmos_container'></span>

<h3>Description</h3>

<p>Import a set of documents to an Azure Cosmos DB container
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bulk_import(container, ...)

## S3 method for class 'cosmos_container'
bulk_import(
  container,
  data,
  init_chunksize = 1000,
  verbose = TRUE,
  procname = "_AzureCosmosR_bulkImport",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bulk_import_+3A_container">container</code></td>
<td>
<p>A Cosmos DB container object, as obtained by <code>get_cosmos_container</code> or <code>create_cosmos_container</code>.</p>
</td></tr>
<tr><td><code id="bulk_import_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="bulk_import_+3A_data">data</code></td>
<td>
<p>The data to import. Can be a data frame, or a string containing JSON text.</p>
</td></tr>
<tr><td><code id="bulk_import_+3A_init_chunksize">init_chunksize</code></td>
<td>
<p>The number of rows to import per chunk. <code>bulk_import</code> can adjust this number dynamically based on observed performance.</p>
</td></tr>
<tr><td><code id="bulk_import_+3A_verbose">verbose</code></td>
<td>
<p>Whether to print updates to the console as the import progresses.</p>
</td></tr>
<tr><td><code id="bulk_import_+3A_procname">procname</code></td>
<td>
<p>The stored procedure name to use for the server-side import code. Change this if, for some reason, the default name is taken.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a convenience function to import a dataset into a container. It works by creating a stored procedure and then calling it in a loop, passing the to-be-imported data in chunks. The dataset must include a column for the container's partition key or an error will result.
</p>
<p>Note that this function is not meant for production use. In particular, if the import fails midway through, it will not clean up after itself: you should call <code>bulk_delete</code> to remove the remnants of a failed import.
</p>


<h3>Value</h3>

<p>A list containing the number of rows imported, for each value of the partition key.
</p>


<h3>See Also</h3>

<p><a href="#topic+bulk_delete">bulk_delete</a>, <a href="#topic+cosmos_container">cosmos_container</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- cosmos_endpoint("https://myaccount.documents.azure.com:443/", key="mykey")
db &lt;- get_cosmos_database(endp, "mydatabase")
cont &lt;- create_cosmos_container(db, "mycontainer", partition_key="sex")

# importing the Star Wars data from dplyr
# notice that rows with sex=NA are not imported
bulk_import(cont, dplyr::starwars)

# importing from a JSON file
writeLines(jsonlite::toJSON(dplyr::starwars), "starwars.json")
bulk_import(cont, "starwars.json")


## End(Not run)
</code></pre>

<hr>
<h2 id='cosmos_endpoint'>Client endpoint for Azure Cosmos DB core API</h2><span id='topic+cosmos_endpoint'></span><span id='topic+call_cosmos_endpoint'></span><span id='topic+process_cosmos_response'></span><span id='topic+process_cosmos_response.response'></span><span id='topic+process_cosmos_response.list'></span>

<h3>Description</h3>

<p>Client endpoint for Azure Cosmos DB core API
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosmos_endpoint(
  host,
  key,
  key_type = c("master", "resource"),
  api_version = getOption("azure_cosmosdb_api_version")
)

call_cosmos_endpoint(
  endpoint,
  path,
  resource_type,
  resource_link,
  options = list(),
  headers = list(),
  body = NULL,
  encode = "json",
  do_continuations = TRUE,
  http_verb = c("GET", "DELETE", "PUT", "POST", "PATCH", "HEAD"),
  num_retries = 10,
  ...
)

process_cosmos_response(response, ...)

## S3 method for class 'response'
process_cosmos_response(
  response,
  http_status_handler = c("stop", "warn", "message", "pass"),
  return_headers = NULL,
  simplify = FALSE,
  ...
)

## S3 method for class 'list'
process_cosmos_response(
  response,
  http_status_handler = c("stop", "warn", "message", "pass"),
  return_headers = NULL,
  simplify = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cosmos_endpoint_+3A_host">host</code></td>
<td>
<p>For <code>cosmos_endpoint</code>, the host URL for the endpoint. Typically of the form <code style="white-space: pre;">&#8288;https://{account-name}.documents.azure.com:443/&#8288;</code> (note the port number).</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_key">key</code></td>
<td>
<p>For <code>cosmos_endpoint</code>, a string containing the password for the endpoint. This can be either a master key or a resource token.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_key_type">key_type</code></td>
<td>
<p>For <code>cosmos_endpoint</code>, the type of the key, either &quot;master&quot; or &quot;resource&quot;.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_api_version">api_version</code></td>
<td>
<p>For <code>cosmos_endpoint</code>, the API version to use.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_endpoint">endpoint</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, a Cosmos DB endpoint object, as returned by <code>cosmos_endpoint</code>.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_path">path</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, the path in the URL for the endpoint call.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_resource_type">resource_type</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, the type of resource: for example, &quot;dbs&quot; for a database, &quot;colls&quot; for a collection (container), &quot;docs&quot; for a document, etc.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_resource_link">resource_link</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, a string to pass to the API for authorization purposes. See the Cosmos DB API documentation for more information.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_options">options</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, query options to include in the request URL.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_headers">headers</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, any HTTP headers to include in the request. You don't need to include authorization headers as <code>call_cosmos_endpoint</code> will take care of the details.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_body">body</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, the body of the request if any.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_encode">encode</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, the encoding (really content-type) of the request body. The Cosmos DB REST API uses JSON, so there should rarely be a need to change this argument.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_do_continuations">do_continuations</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, whether to automatically handle paged responses. If FALSE, only the initial response is returned.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_http_verb">http_verb</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, the HTTP verb for the request. One of &quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;PATCH&quot;, &quot;HEAD&quot; or &quot;DELETE&quot;.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_num_retries">num_retries</code></td>
<td>
<p>For <code>call_cosmos_endpoint</code>, how many times to retry a failed request. Useful for dealing with rate limiting issues.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_...">...</code></td>
<td>
<p>Arguments passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_response">response</code></td>
<td>
<p>For <code>process_cosmos_response</code>, the returned object from a <code>call_cosmos_endpoint</code> call. This will be either a single httr request object, or a list of such objects.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_http_status_handler">http_status_handler</code></td>
<td>
<p>For <code>process_cosmos_response</code>, the R handler for the HTTP status code of the response.  &quot;stop&quot;, &quot;warn&quot; or &quot;message&quot; will call the corresponding handlers in httr, while &quot;pass&quot; ignores the status code. The latter is primarily useful for debugging purposes.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_return_headers">return_headers</code></td>
<td>
<p>For <code>process_cosmos_response</code>, whether to return the headers from the response object(s), as opposed to the body. Defaults to TRUE if the original endpoint call was a HEAD request, and FALSE otherwise.</p>
</td></tr>
<tr><td><code id="cosmos_endpoint_+3A_simplify">simplify</code></td>
<td>
<p>For <code>process_cosmos_response</code>, whether to convert arrays of objects into data frames via the <code>simplifyDataFrame</code> argument to <a href="jsonlite.html#topic+fromJSON">jsonlite::fromJSON</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are the basis of the SQL API client framework provided by AzureCosmosR. The <code>cosmos_endpoint</code> function returns a client object, which can then be passed to other functions for querying databases and containers. The <code>call_cosmos_endpoint</code> function sends calls to the REST endpoint, the results of which are then processed by <code>process_cosmos_response</code>.
</p>
<p>In most cases, you should not have to use <code>call_cosmos_endpoint</code> directly. Instead, use <code>do_cosmos_op</code> which provides a slightly higher-level interface to the API, by providing sensible defaults for the <code>resource_type</code> and<code>resource_link</code> arguments and partially filling in the request path.
</p>
<p>As an alternative to AzureCosmosR, you can also use the ODBC protocol to interface with the SQL API. By installing a suitable ODBC driver, you can then talk to Cosmos DB in a manner similar to other SQL databases. An advantage of the ODBC interface is that it fully supports cross-partition queries, unlike the REST API. A disadvantage is that it does not support nested document fields; functions like <code>array_contains()</code> cannot be used, and attempts to reference arrays and objects may return incorrect results.
</p>
<p>Note that AzureCosmosR is a framework for communicating directly with the <em>core</em> Cosmos DB client API, also known as the &quot;SQL&quot; API. Cosmos DB provides other APIs as options when creating an account, such as Cassandra, MongoDB, table storage and Gremlin. These APIs are not supported by AzureCosmosR, but you can use other R packages for working with them. For example, you can use AzureTableStor to work with the table storage API, or mongolite to work with the MongoDB API.
</p>


<h3>Value</h3>

<p>For <code>cosmos_endpoint</code>, an object of S3 class <code>cosmos_endpoint</code>.
</p>
<p>For <code>call_cosmos_endpoint</code>, either a httr response object, or a list of such responses (if a paged query, and <code>do_continuations</code> is TRUE).
</p>
<p>For <code>process_cosmos_response</code> and a single response object, the content of the response. This can be either the parsed response body (if <code>return_headers</code> is FALSE) or the headers (if <code>return_headers</code> is TRUE).
</p>
<p>For <code>process_cosmos_response</code> and a list of response objects, a list containing the individual contents of each response.
</p>


<h3>See Also</h3>

<p><a href="#topic+do_cosmos_op">do_cosmos_op</a>, <a href="#topic+cosmos_database">cosmos_database</a>, <a href="#topic+cosmos_container">cosmos_container</a>, <a href="#topic+az_cosmosdb">az_cosmosdb</a>
</p>
<p><a href="httr.html#topic+VERB">httr::VERB</a>, which is what carries out the low-level work of sending the HTTP request.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- cosmos_endpoint("https://myaccount.documents.azure.com:443/", key="mykey")

# properties for the Cosmos DB account
call_cosmos_endpoint(endp, "", "", "") %&gt;%
    process_cosmos_response()


## End(Not run)
</code></pre>

<hr>
<h2 id='cosmos_mongo_endpoint'>MongoDB endpoint for Azure Cosmos DB</h2><span id='topic+cosmos_mongo_endpoint'></span><span id='topic+cosmos_mongo_connection'></span><span id='topic+cosmos_mongo_connection.cosmos_mongo_endpoint'></span>

<h3>Description</h3>

<p>MongoDB endpoint for Azure Cosmos DB
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosmos_mongo_endpoint(
  host,
  key,
  mongo_options = list(),
  connection_string = NULL
)

cosmos_mongo_connection(endpoint, ...)

## S3 method for class 'cosmos_mongo_endpoint'
cosmos_mongo_connection(endpoint, collection, database, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cosmos_mongo_endpoint_+3A_host">host</code></td>
<td>
<p>For <code>cosmos_mongo_endpoint</code>, the URL of the Cosmos DB MongoDB endpoint. Usually of the form &quot;https://account-name.mongo.cosmos.azure.com:443/&quot;.</p>
</td></tr>
<tr><td><code id="cosmos_mongo_endpoint_+3A_key">key</code></td>
<td>
<p>For <code>cosmos_mongo_endpoint</code>, a string containing the access key (password) for the endpoint. Can be either a read-write or read-only key.</p>
</td></tr>
<tr><td><code id="cosmos_mongo_endpoint_+3A_mongo_options">mongo_options</code></td>
<td>
<p>For <code>cosmos_mongo_endpoint</code>, a named list containing any additional parameters for the MongoDB connection string.</p>
</td></tr>
<tr><td><code id="cosmos_mongo_endpoint_+3A_connection_string">connection_string</code></td>
<td>
<p>Alternatively, the full connection string for the MongoDB endpoint. If this is supplied, all other arguments to <code>cosmos_mongo_endpoint</code> are ignored. Note that if you already have the full connection string, you most likely do not need AzureCosmosR and can call <code>mongolite::mongo</code> directly.</p>
</td></tr>
<tr><td><code id="cosmos_mongo_endpoint_+3A_endpoint">endpoint</code></td>
<td>
<p>For <code>cosmos_mongo_connection</code>, a MongoDB endpoint object as obtained from <code>cosmos_mongo_endpoint</code>.</p>
</td></tr>
<tr><td><code id="cosmos_mongo_endpoint_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="cosmos_mongo_endpoint_+3A_collection">collection</code>, <code id="cosmos_mongo_endpoint_+3A_database">database</code></td>
<td>
<p>For <code>cosmos_mongo_connection</code>, the collection and database to connect to.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions act as a bridge between the Azure resource and the functionality provided by the mongolite package.
</p>


<h3>Value</h3>

<p>For <code>cosmos_mongo_endpoint</code>, an object of S3 class <code>cosmos_mongo_endpoint</code>.
</p>
<p>For <code>cosmos_mongo_connection</code>, an object of class <code>mongolite::mongo</code> which can then be used to interact with the given collection.
</p>


<h3>See Also</h3>

<p><a href="#topic+az_cosmosdb">az_cosmosdb</a>, <a href="mongolite.html#topic+mongo">mongolite::mongo</a>
</p>
<p>For the SQL API client framework: <a href="#topic+cosmos_endpoint">cosmos_endpoint</a>, <a href="#topic+cosmos_database">cosmos_database</a>, <a href="#topic+cosmos_container">cosmos_container</a>, <a href="#topic+query_documents">query_documents</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

mendp &lt;- cosmos_mongo_endpoint("https://mymongoacct.mongo.cosmos.azure.com:443",
    key="mykey")

cosmos_mongo_connection(mendp, "mycollection", "mydatabase")


## End(Not run)
</code></pre>

<hr>
<h2 id='create_cosmosdb_account'>Create Azure Cosmos DB account</h2><span id='topic+create_cosmosdb_account'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>create_cosmosdb_account(
    name,
    location = self$location,
    interface = c("sql", "cassandra", "mongo", "table", "graph"),
    serverless = FALSE,
    free_tier = FALSE,
    properties = list(),
    ...
)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the Cosmos DB account.
</p>
</li>
<li> <p><code>location</code>: The location/region in which to create the account. Defaults to the resource group's location.
</p>
</li>
<li> <p><code>interface</code>: The default API by which to access data in the account.
</p>
</li>
<li> <p><code>serverless</code>: Whether this account should use provisioned throughput or a serverless mode. In the latter, you are charged solely on the basis of the traffic generated by your database operations. Serverless mode is best suited for small-to-medium workloads with light and intermittent traffic that is hard to forecast; it is currently (January 2021) in preview.
</p>
</li>
<li> <p><code>free_tier</code>: Whether this account should be in the free tier, in which a certain amount of database operations are provided free of charge. You can have one free tier account per subscription.
</p>
</li>
<li> <p><code>properties</code>: Additional properties to set for the account.
</p>
</li>
<li> <p><code>wait</code>: Whether to wait until the Cosmos DB account provisioning is complete.
</p>
</li>
<li> <p><code>...</code>: Optional arguments to pass to <code>az_cosmosdb$new()</code>.
</p>
</li></ul>



<h3>Details</h3>

<p>This method creates a new Azure Cosmos DB account in the given resource group. Azure Cosmos DB is a globally distributed multi-model database that supports the document, graph, and key-value data models.
</p>
<p>The ARM resource object provides methods for working in the management plane. For working in the data plane, AzureCosmosR provides a client framework that interfaces with the core (SQL) API. Other packages provide functionality for other APIs, such as AzureTableStor for table storage and mongolite for MongoDB.
</p>


<h3>Value</h3>

<p>An object of class <code>az_cosmosdb</code> representing the Cosmos DB account.
</p>


<h3>See Also</h3>

<p><a href="#topic+get_cosmosdb_account">get_cosmosdb_account</a>, <a href="#topic+delete_cosmosdb_account">delete_cosmosdb_account</a>
</p>
<p>For the SQL API client framework: <a href="#topic+cosmos_endpoint">cosmos_endpoint</a>, <a href="#topic+cosmos_database">cosmos_database</a>, <a href="#topic+cosmos_container">cosmos_container</a>, <a href="#topic+query_documents">query_documents</a>
</p>
<p>For the table storage API: <a href="AzureTableStor.html#topic+table_endpoint">AzureTableStor::table_endpoint</a>
</p>
<p>For the MongoDB API: <a href="#topic+cosmos_mongo_endpoint">cosmos_mongo_endpoint</a>, <a href="mongolite.html#topic+mongo">mongolite::mongo</a>
</p>

<hr>
<h2 id='delete_cosmosdb_account'>Delete Azure Cosmos DB account</h2><span id='topic+delete_cosmosdb_account'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>delete_cosmosdb_account(name, confirm = TRUE, wait = FALSE)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the Cosmos DB account.
</p>
</li>
<li> <p><code>confirm</code>: Whether to ask for confirmation before deleting.
</p>
</li>
<li> <p><code>wait</code>: Whether to wait until the deletion has completed before returning.
</p>
</li></ul>



<h3>Details</h3>

<p>This method deletes an existing Azure Cosmos DB account.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_cosmosdb_account">create_cosmosdb_account</a>, <a href="#topic+get_cosmosdb_account">get_cosmosdb_account</a>
</p>
<p>For the SQL API client framework: <a href="#topic+cosmos_endpoint">cosmos_endpoint</a>, <a href="#topic+cosmos_database">cosmos_database</a>, <a href="#topic+cosmos_container">cosmos_container</a>, <a href="#topic+query_documents">query_documents</a>
</p>
<p>For the table storage API: <a href="AzureTableStor.html#topic+table_endpoint">AzureTableStor::table_endpoint</a>
</p>
<p>For the MongoDB API: <a href="#topic+cosmos_mongo_endpoint">cosmos_mongo_endpoint</a>, <a href="mongolite.html#topic+mongo">mongolite::mongo</a>
</p>

<hr>
<h2 id='do_cosmos_op'>Carry out a Cosmos DB operation</h2><span id='topic+do_cosmos_op'></span><span id='topic+do_cosmos_op.cosmos_endpoint'></span><span id='topic+do_cosmos_op.cosmos_database'></span><span id='topic+do_cosmos_op.cosmos_container'></span><span id='topic+do_cosmos_op.cosmos_document'></span>

<h3>Description</h3>

<p>Carry out a Cosmos DB operation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_cosmos_op(object, ...)

## S3 method for class 'cosmos_endpoint'
do_cosmos_op(object, ...)

## S3 method for class 'cosmos_database'
do_cosmos_op(object, path = "", resource_type = "dbs", resource_link = "", ...)

## S3 method for class 'cosmos_container'
do_cosmos_op(
  object,
  path = "",
  resource_type = "colls",
  resource_link = "",
  ...
)

## S3 method for class 'cosmos_document'
do_cosmos_op(
  object,
  path = "",
  resource_type = "docs",
  resource_link = "",
  headers = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_cosmos_op_+3A_object">object</code></td>
<td>
<p>A Cosmos DB endpoint, database, container or document object.</p>
</td></tr>
<tr><td><code id="do_cosmos_op_+3A_...">...</code></td>
<td>
<p>Arguments passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="do_cosmos_op_+3A_path">path</code></td>
<td>
<p>The (partial) URL path for the operation.</p>
</td></tr>
<tr><td><code id="do_cosmos_op_+3A_resource_type">resource_type</code></td>
<td>
<p>The type of resource. For most purposes, the default value should suffice.</p>
</td></tr>
<tr><td><code id="do_cosmos_op_+3A_resource_link">resource_link</code></td>
<td>
<p>The resource link for authorization. For most purposes, the default value should suffice.</p>
</td></tr>
<tr><td><code id="do_cosmos_op_+3A_headers">headers</code></td>
<td>
<p>Any optional HTTP headers to include in the API call.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>do_cosmos_op</code> provides a higher-level interface to the Cosmos DB REST API than <code>call_cosmos_endpoint</code>. In particular, it sets the <code>resource_type</code> and <code>resource_link</code> arguments to sensible defaults, and fills in the beginning of the URL path for the REST call.
</p>


<h3>Value</h3>

<p>The result of <code>call_cosmos_endpoint</code>: either a httr response object, or a list of such objects. Call <code>process_cosmos_response</code> to extract the result of the call.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- cosmos_endpoint("https://myaccount.documents.azure.com:443/", key="mykey")

db &lt;- get_cosmos_database(endp, "mydatabase")
do_cosmos_op(db) %&gt;%
    process_cosmos_response()

cont &lt;- get_cosmos_container(db, "mycontainer")
do_cosmos_op(cont) %&gt;%
    process_cosmos_response()


## End(Not run)
</code></pre>

<hr>
<h2 id='get_cosmos_container'>Methods for working with Azure Cosmos DB containers</h2><span id='topic+get_cosmos_container'></span><span id='topic+cosmos_container'></span><span id='topic+get_cosmos_container.cosmos_database'></span><span id='topic+get_cosmos_container.cosmos_endpoint'></span><span id='topic+create_cosmos_container'></span><span id='topic+create_cosmos_container.cosmos_database'></span><span id='topic+delete_cosmos_container'></span><span id='topic+delete_cosmos_container.cosmos_database'></span><span id='topic+delete_cosmos_container.cosmos_container'></span><span id='topic+list_cosmos_containers'></span><span id='topic+list_cosmos_containers.cosmos_database'></span>

<h3>Description</h3>

<p>Methods for working with Azure Cosmos DB containers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cosmos_container(object, ...)

## S3 method for class 'cosmos_database'
get_cosmos_container(object, container, ...)

## S3 method for class 'cosmos_endpoint'
get_cosmos_container(object, database, container, ...)

create_cosmos_container(object, ...)

## S3 method for class 'cosmos_database'
create_cosmos_container(
  object,
  container,
  partition_key,
  partition_version = 2,
  autoscale_maxRUs = NULL,
  manual_RUs = NULL,
  headers = list(),
  ...
)

delete_cosmos_container(object, ...)

## S3 method for class 'cosmos_database'
delete_cosmos_container(object, container, confirm = TRUE, ...)

## S3 method for class 'cosmos_container'
delete_cosmos_container(object, ...)

list_cosmos_containers(object, ...)

## S3 method for class 'cosmos_database'
list_cosmos_containers(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_cosmos_container_+3A_object">object</code></td>
<td>
<p>A Cosmos DB database object, as obtained from <code>get_cosmos_database</code> or <code>create_cosmos_database</code>, or for <code>delete_cosmos_container.cosmos_container</code>, the container object.</p>
</td></tr>
<tr><td><code id="get_cosmos_container_+3A_container">container</code></td>
<td>
<p>The name of the container.</p>
</td></tr>
<tr><td><code id="get_cosmos_container_+3A_database">database</code></td>
<td>
<p>For <code>get_cosmos_container.cosmos_endpoint</code>, the name of the database that includes the container.</p>
</td></tr>
<tr><td><code id="get_cosmos_container_+3A_partition_key">partition_key</code></td>
<td>
<p>For <code>create_cosmos_container</code>, the name of the partition key.</p>
</td></tr>
<tr><td><code id="get_cosmos_container_+3A_partition_version">partition_version</code></td>
<td>
<p>For <code>create_cosmos_container</code>, the partition version. Can be either 1 or 2. Version 2 supports large partition key values (longer than 100 bytes) but requires API version <code>2018-12-31</code> or later. Use version 1 if the container needs to be accessible to older Cosmos DB SDKs.</p>
</td></tr>
<tr><td><code id="get_cosmos_container_+3A_autoscale_maxrus">autoscale_maxRUs</code>, <code id="get_cosmos_container_+3A_manual_rus">manual_RUs</code></td>
<td>
<p>For <code>create_cosmos_container</code>, optional parameters for the maximum request units (RUs) allowed. See the Cosmos DB documentation for more details.</p>
</td></tr>
<tr><td><code id="get_cosmos_container_+3A_headers">headers</code>, <code id="get_cosmos_container_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="get_cosmos_container_+3A_confirm">confirm</code></td>
<td>
<p>For <code>delete_cosmos_container</code>, whether to ask for confirmation before deleting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are methods for working with Cosmos DB containers using the core (SQL) API. A container is analogous to a table in SQL, or a collection in MongoDB.
</p>
<p><code>get_cosmos_container</code>, <code>create_cosmos_container</code>, <code>delete_cosmos_container</code> and <code>list_cosmos_containers</code> provide basic container management functionality.
</p>
<p><code>get_partition_key</code> returns the name of the partition key column in the container, and <code>list_partition_key_values</code> returns all the distinct values for this column. These are useful when working with queries that have to be mapped across partitions.
</p>


<h3>Value</h3>

<p>For <code>get_cosmos_container</code> and <code>create_cosmos_container</code>, an object of class <code style="white-space: pre;">&#8288;cosmos_container. For &#8288;</code>list_cosmos_container', a list of such objects.
</p>


<h3>See Also</h3>

<p><a href="#topic+cosmos_container">cosmos_container</a>, <a href="#topic+query_documents">query_documents</a>, <a href="#topic+bulk_import">bulk_import</a>, <a href="#topic+bulk_delete">bulk_delete</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- cosmos_endpoint("https://myaccount.documents.azure.com:443/", key="mykey")
db &lt;- get_cosmos_database(endp, "mydatabase")

create_cosmos_container(db, "mycontainer", partition_key="sex")

list_cosmos_containers(db)

cont &lt;- get_cosmos_container(db, "mycontainer")

delete_cosmos_container(cont)


## End(Not run)
</code></pre>

<hr>
<h2 id='get_cosmos_database'>Methods for working with Azure Cosmos DB databases</h2><span id='topic+get_cosmos_database'></span><span id='topic+cosmos_database'></span><span id='topic+get_cosmos_database.cosmos_endpoint'></span><span id='topic+create_cosmos_database'></span><span id='topic+create_cosmos_database.cosmos_endpoint'></span><span id='topic+delete_cosmos_database'></span><span id='topic+delete_cosmos_database.cosmos_endpoint'></span><span id='topic+delete_cosmos_database.cosmos_database'></span><span id='topic+list_cosmos_databases'></span><span id='topic+list_cosmos_databases.cosmos_endpoint'></span>

<h3>Description</h3>

<p>Methods for working with Azure Cosmos DB databases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cosmos_database(object, ...)

## S3 method for class 'cosmos_endpoint'
get_cosmos_database(object, database, ...)

create_cosmos_database(object, ...)

## S3 method for class 'cosmos_endpoint'
create_cosmos_database(
  object,
  database,
  autoscale_maxRUs = NULL,
  manual_RUs = NULL,
  headers = list(),
  ...
)

delete_cosmos_database(object, ...)

## S3 method for class 'cosmos_endpoint'
delete_cosmos_database(object, database, confirm = TRUE, ...)

## S3 method for class 'cosmos_database'
delete_cosmos_database(object, ...)

list_cosmos_databases(object, ...)

## S3 method for class 'cosmos_endpoint'
list_cosmos_databases(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_cosmos_database_+3A_object">object</code></td>
<td>
<p>A Cosmos DB endpoint object as obtained from <code>cosmos_endpoint</code>, or for <code>delete_cosmos_database.cosmos_database</code>, the database object.</p>
</td></tr>
<tr><td><code id="get_cosmos_database_+3A_database">database</code></td>
<td>
<p>The name of the Cosmos DB database.</p>
</td></tr>
<tr><td><code id="get_cosmos_database_+3A_autoscale_maxrus">autoscale_maxRUs</code>, <code id="get_cosmos_database_+3A_manual_rus">manual_RUs</code></td>
<td>
<p>For <code>create_cosmos_database</code>, optional parameters for the maximum request units (RUs) allowed. See the Cosmos DB documentation for more details.</p>
</td></tr>
<tr><td><code id="get_cosmos_database_+3A_headers">headers</code>, <code id="get_cosmos_database_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="get_cosmos_database_+3A_confirm">confirm</code></td>
<td>
<p>For <code>delete_cosmos_database</code>, whether to ask for confirmation before deleting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are methods for managing Cosmos DB databases using the core (SQL) API.
</p>


<h3>Value</h3>

<p><code>get_cosmos_database</code> and <code>create_cosmos_database</code> return an object of class <code>cosmos_database</code>. <code>list_cosmos_databases</code> returns a list of such objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- cosmos_endpoint("https://myaccount.documents.azure.com:443/", key="mykey")

create_cosmos_database(endp, "mydatabase")

list_cosmos_databases(endp)

db &lt;- get_cosmos_database(endp, "mydatabase")

delete_cosmos_database(db)


## End(Not run)
</code></pre>

<hr>
<h2 id='get_cosmosdb_account'>Get Azure Cosmos DB account</h2><span id='topic+get_cosmosdb_account'></span><span id='topic+list_cosmosdb_accounts'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>get_cosmosdb_account(name)
list_cosmosdb_accounts()
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the Cosmos DB account.
</p>
</li></ul>



<h3>Details</h3>

<p><code>get_cosmosdb_account</code> retrieves the details for an existing Azure Cosmos DB account. <code>list_cosmosdb_accounts</code> retrieves all the Cosmos DB accounts within the resource group.
</p>


<h3>Value</h3>

<p>For <code>get_cosmosdb_account</code>, an object of class <code>az_cosmosdb</code> representing the Cosmos DB account. For <code>list_cosmosdb_accounts</code>, a list of such objects.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_cosmosdb_account">create_cosmosdb_account</a>, <a href="#topic+delete_cosmosdb_account">delete_cosmosdb_account</a>
</p>
<p>For the SQL API client framework: <a href="#topic+cosmos_endpoint">cosmos_endpoint</a>, <a href="#topic+cosmos_database">cosmos_database</a>, <a href="#topic+cosmos_container">cosmos_container</a>, <a href="#topic+query_documents">query_documents</a>
</p>
<p>For the table storage API: <a href="AzureTableStor.html#topic+table_endpoint">AzureTableStor::table_endpoint</a>
</p>
<p>For the MongoDB API: <a href="#topic+cosmos_mongo_endpoint">cosmos_mongo_endpoint</a>, <a href="mongolite.html#topic+mongo">mongolite::mongo</a>
</p>

<hr>
<h2 id='get_document'>Methods for working with Azure Cosmos DB documents</h2><span id='topic+get_document'></span><span id='topic+cosmos_document'></span><span id='topic+create_document'></span><span id='topic+create_document.cosmos_container'></span><span id='topic+list_documents'></span><span id='topic+list_documents.cosmos_container'></span><span id='topic+delete_document'></span><span id='topic+delete_document.cosmos_container'></span><span id='topic+delete_document.cosmos_document'></span>

<h3>Description</h3>

<p>Methods for working with Azure Cosmos DB documents
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_document(object, ...)

create_document(object, ...)

## S3 method for class 'cosmos_container'
create_document(object, data, headers = list(), ...)

list_documents(object, ...)

## S3 method for class 'cosmos_container'
list_documents(
  object,
  partition_key = NULL,
  as_data_frame = FALSE,
  metadata = TRUE,
  headers = list(),
  ...
)

delete_document(object, ...)

## S3 method for class 'cosmos_container'
delete_document(
  object,
  id,
  partition_key,
  headers = list(),
  confirm = TRUE,
  ...
)

## S3 method for class 'cosmos_document'
delete_document(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_document_+3A_object">object</code></td>
<td>
<p>A Cosmos DB container object, as obtained by <code>get_cosmos_container</code> or <code>create_cosmos_container</code>.</p>
</td></tr>
<tr><td><code id="get_document_+3A_data">data</code></td>
<td>
<p>For <code>create_document</code>, the document data. This can be either a string containing JSON text, or a (possibly nested) list containing the parsed JSON.</p>
</td></tr>
<tr><td><code id="get_document_+3A_headers">headers</code>, <code id="get_document_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="get_document_+3A_partition_key">partition_key</code></td>
<td>
<p>For <code>get_document</code> and <code>delete_document</code>, the value of the partition key for the desired document. For <code>list_documents</code>, restrict the returned list only to documents with this key value.</p>
</td></tr>
<tr><td><code id="get_document_+3A_as_data_frame">as_data_frame</code></td>
<td>
<p>For <code>list_documents</code>, whether to return a data frame or a list of Cosmos DB document objects. Note that the default value is FALSE, unlike <a href="#topic+query_documents">query_documents</a>.</p>
</td></tr>
<tr><td><code id="get_document_+3A_metadata">metadata</code></td>
<td>
<p>For <code>get_document</code> and <code>list_documents</code>, whether to include Cosmos DB document metadata in the result.</p>
</td></tr>
<tr><td><code id="get_document_+3A_id">id</code></td>
<td>
<p>The document ID.</p>
</td></tr>
<tr><td><code id="get_document_+3A_confirm">confirm</code></td>
<td>
<p>For <code>delete_cosmos_container</code>, whether to ask for confirmation before deleting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are low-level functions for working with individual documents in a Cosmos DB container. In most cases you will want to use <a href="#topic+query_documents">query_documents</a> to issue queries against the container, or <a href="#topic+bulk_import">bulk_import</a> and <a href="#topic+bulk_delete">bulk_delete</a> to create and delete documents.
</p>


<h3>Value</h3>

<p><code>get_document</code> and <code>create_document</code> return an object of S3 class <code>cosmos_document</code>. The actual document contents can be found in the <code>data</code> component of this object.
</p>
<p><code>list_documents</code> returns a list of <code>cosmos_document</code> objects if <code>as_data_frame</code> is FALSE, and a data frame otherwise.
</p>


<h3>See Also</h3>

<p><a href="#topic+query_documents">query_documents</a>, <a href="#topic+bulk_import">bulk_import</a>, <a href="#topic+bulk_delete">bulk_delete</a>, <a href="#topic+cosmos_container">cosmos_container</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- cosmos_endpoint("https://myaccount.documents.azure.com:443/", key="mykey")
db &lt;- get_cosmos_database(endp, "mydatabase")

cont &lt;- get_cosmos_container(db, "mycontainer")

# a list of document objects
list_documents(cont)

# a data frame
list_documents(cont, as_data_frame=TRUE)

# a single document
doc &lt;- get_document(cont, "mydocumentid")
doc$data

delete_document(doc)


## End(Not run)
</code></pre>

<hr>
<h2 id='get_partition_key'>Container partition key information</h2><span id='topic+get_partition_key'></span><span id='topic+list_partition_key_values'></span><span id='topic+list_partition_key_ranges'></span>

<h3>Description</h3>

<p>Container partition key information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_partition_key(container)

list_partition_key_values(container)

list_partition_key_ranges(container)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_partition_key_+3A_container">container</code></td>
<td>
<p>An object of class <code>cosmos_container</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are functions to facilitate working with a Cosmos DB container, which often requires knowledge of its partition key.
</p>


<h3>Value</h3>

<p>For <code>get_partition_key</code>, the name of the partition key column as a string.
</p>
<p>For <code>list_partition_key_values</code>, a character vector of all the values of the partition key.
</p>
<p>For <code>list_partition_key_ranges</code>, a character vector of the IDs of the partition key ranges.
</p>

<hr>
<h2 id='get_stored_procedure'>Methods for working with Azure Cosmos DB stored procedures</h2><span id='topic+get_stored_procedure'></span><span id='topic+cosmos_stored_procedure'></span><span id='topic+get_stored_procedure.cosmos_container'></span><span id='topic+list_stored_procedures'></span><span id='topic+create_stored_procedure'></span><span id='topic+create_stored_procedure.cosmos_container'></span><span id='topic+exec_stored_procedure'></span><span id='topic+exec_stored_procedure.cosmos_container'></span><span id='topic+exec_stored_procedure.cosmos_stored_procedure'></span><span id='topic+replace_stored_procedure'></span><span id='topic+replace_stored_procedure.cosmos_container'></span><span id='topic+replace_stored_procedure.cosmos_stored_procedure'></span><span id='topic+delete_stored_procedure'></span><span id='topic+delete_stored_procedure.cosmos_container'></span><span id='topic+delete_stored_procedure.cosmos_stored_procedure'></span>

<h3>Description</h3>

<p>Methods for working with Azure Cosmos DB stored procedures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_stored_procedure(object, ...)

## S3 method for class 'cosmos_container'
get_stored_procedure(object, procname, ...)

list_stored_procedures(object, ...)

create_stored_procedure(object, ...)

## S3 method for class 'cosmos_container'
create_stored_procedure(object, procname, body, ...)

exec_stored_procedure(object, ...)

## S3 method for class 'cosmos_container'
exec_stored_procedure(object, procname, parameters = list(), ...)

## S3 method for class 'cosmos_stored_procedure'
exec_stored_procedure(object, ...)

replace_stored_procedure(object, ...)

## S3 method for class 'cosmos_container'
replace_stored_procedure(object, procname, body, ...)

## S3 method for class 'cosmos_stored_procedure'
replace_stored_procedure(object, body, ...)

delete_stored_procedure(object, ...)

## S3 method for class 'cosmos_container'
delete_stored_procedure(object, procname, confirm = TRUE, ...)

## S3 method for class 'cosmos_stored_procedure'
delete_stored_procedure(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_stored_procedure_+3A_object">object</code></td>
<td>
<p>A Cosmos DB container object, as obtained by <code>get_cosmos_container</code> or <code>create_cosmos_container</code>, or for <code>delete_stored_procedure.cosmos_stored_procedure</code>, the stored procedure object.</p>
</td></tr>
<tr><td><code id="get_stored_procedure_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="get_stored_procedure_+3A_procname">procname</code></td>
<td>
<p>The name of the stored procedure.</p>
</td></tr>
<tr><td><code id="get_stored_procedure_+3A_body">body</code></td>
<td>
<p>For <code>create_stored_procedure</code> and <code>replace_stored_procedure</code>, the body of the stored procedure. This can be either a character string containing the source code, or the name of a source file.</p>
</td></tr>
<tr><td><code id="get_stored_procedure_+3A_parameters">parameters</code></td>
<td>
<p>For <code>exec_stored_procedure</code>, a list of parameters to pass to the procedure.</p>
</td></tr>
<tr><td><code id="get_stored_procedure_+3A_confirm">confirm</code></td>
<td>
<p>For <code>delete_stored_procedure</code>, whether to ask for confirmation before deleting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are methods for working with stored procedures in Azure Cosmos DB using the core (SQL) API. In the Cosmos DB model, stored procedures are written in JavaScript and associated with a container.
</p>


<h3>Value</h3>

<p>For <code>get_stored_procedure</code> and <code>create_stored_procedure</code>, an object of class <code>cosmos_stored_procedure</code>. For <code>list_stored_procedures</code>, a list of such objects.
</p>


<h3>See Also</h3>

<p><a href="#topic+cosmos_container">cosmos_container</a>, <a href="#topic+get_udf">get_udf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- cosmos_endpoint("https://myaccount.documents.azure.com:443/", key="mykey")
db &lt;- get_cosmos_database(endp, "mydatabase")
cont &lt;- create_cosmos_container(db, "mycontainer", partition_key="sex")

# a simple stored procedure
src &lt;- 'function helloworld() {
   var context = getContext();
    var response = context.getResponse();
    response.setBody("Hello, World");
}'
create_stored_procedure(cont, "helloworld", src)
sproc &lt;- get_stored_procedure(cont, "helloworld")
exec_stored_procedure(sproc)

# more complex example: uploading data
sproc2 &lt;- create_stored_procedure(cont, "myBulkUpload",
    body=system.file("srcjs/bulkUpload.js", package="AzureCosmosR"))

list_stored_procedures(cont)

sw_male &lt;- dplyr::filter(dplyr::starwars, sex == "male")
exec_stored_procedure(sproc2, parameters=list(sw_male))

delete_stored_procedure(sproc)
delete_stored_procedure(sproc2)


## End(Not run)
</code></pre>

<hr>
<h2 id='get_udf'>Methods for working with Azure Cosmos DB user-defined functions</h2><span id='topic+get_udf'></span><span id='topic+get_udf.cosmos_container'></span><span id='topic+list_udfs'></span><span id='topic+create_udf'></span><span id='topic+create_udf.cosmos_container'></span><span id='topic+replace_udf'></span><span id='topic+replace_udf.cosmos_container'></span><span id='topic+replace_udf.cosmos_udf'></span><span id='topic+delete_udf'></span><span id='topic+delete_udf.cosmos_container'></span><span id='topic+delete_udf.cosmos_udf'></span>

<h3>Description</h3>

<p>Methods for working with Azure Cosmos DB user-defined functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_udf(object, ...)

## S3 method for class 'cosmos_container'
get_udf(object, funcname, ...)

list_udfs(object, ...)

create_udf(object, ...)

## S3 method for class 'cosmos_container'
create_udf(object, funcname, body, ...)

replace_udf(object, ...)

## S3 method for class 'cosmos_container'
replace_udf(object, funcname, body, ...)

## S3 method for class 'cosmos_udf'
replace_udf(object, body, ...)

delete_udf(object, ...)

## S3 method for class 'cosmos_container'
delete_udf(object, funcname, confirm = TRUE, ...)

## S3 method for class 'cosmos_udf'
delete_udf(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_udf_+3A_object">object</code></td>
<td>
<p>A Cosmos DB container object, as obtained by <code>get_cosmos_container</code> or <code>create_cosmos_container</code>, or for <code>delete_udf.cosmos_udf</code>, the function object.</p>
</td></tr>
<tr><td><code id="get_udf_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to lower-level functions.</p>
</td></tr>
<tr><td><code id="get_udf_+3A_funcname">funcname</code></td>
<td>
<p>The name of the user-defined function.</p>
</td></tr>
<tr><td><code id="get_udf_+3A_body">body</code></td>
<td>
<p>For <code>create_udf</code> and <code>replace_udf</code>, the body of the function. This can be either a character string containing the source code, or the name of a source file.</p>
</td></tr>
<tr><td><code id="get_udf_+3A_confirm">confirm</code></td>
<td>
<p>For <code>delete_udf</code>, whether to ask for confirmation before deleting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are methods for working with user-defined functions (UDFs) in Azure Cosmos DB using the core (SQL) API. In the Cosmos DB model, UDFs are written in JavaScript and associated with a container.
</p>


<h3>Value</h3>

<p>For <code>get_udf</code> and <code>create_udf</code>, an object of class <code>cosmos_udf</code>. For <code>list_udfs</code>, a list of such objects.
</p>


<h3>See Also</h3>

<p><a href="#topic+cosmos_container">cosmos_container</a>, <a href="#topic+get_stored_procedure">get_stored_procedure</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- cosmos_endpoint("https://myaccount.documents.azure.com:443/", key="mykey")
db &lt;- get_cosmos_database(endp, "mydatabase")

# importing the Star Wars data from dplyr
cont &lt;- endp %&gt;%
    get_cosmos_database(endp, "mydatabase") %&gt;%
    create_cosmos_container(db, "mycontainer", partition_key="sex")

create_udf(cont, "times2", "function(x) { return 2*x; }")

list_udfs(cont)

# UDFs in queries are prefixed with the 'udf.' identifier
query_documents(cont, "select udf.times2(c.height) t2 from cont c")

delete_udf(cont, "times2")


## End(Not run)
</code></pre>

<hr>
<h2 id='query_documents'>Query an Azure Cosmos DB container</h2><span id='topic+query_documents'></span><span id='topic+query_documents.cosmos_container'></span>

<h3>Description</h3>

<p>Query an Azure Cosmos DB container
</p>


<h3>Usage</h3>

<pre><code class='language-R'>query_documents(container, ...)

## S3 method for class 'cosmos_container'
query_documents(
  container,
  query,
  parameters = list(),
  cross_partition = TRUE,
  partition_key = NULL,
  by_pkrange = FALSE,
  as_data_frame = TRUE,
  metadata = TRUE,
  headers = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="query_documents_+3A_container">container</code></td>
<td>
<p>A Cosmos DB container object, as obtained by <code>get_cosmos_container</code> or <code>create_cosmos_container</code>.</p>
</td></tr>
<tr><td><code id="query_documents_+3A_query">query</code></td>
<td>
<p>A string containing the query text.</p>
</td></tr>
<tr><td><code id="query_documents_+3A_parameters">parameters</code></td>
<td>
<p>A named list of parameters to pass to a parameterised query, if required.</p>
</td></tr>
<tr><td><code id="query_documents_+3A_cross_partition">cross_partition</code>, <code id="query_documents_+3A_partition_key">partition_key</code>, <code id="query_documents_+3A_by_pkrange">by_pkrange</code></td>
<td>
<p>Arguments that control how to handle cross-partition queries. See 'Details' below.</p>
</td></tr>
<tr><td><code id="query_documents_+3A_as_data_frame">as_data_frame</code></td>
<td>
<p>Whether to return the query result as a data frame, or a list of Cosmos DB document objects.</p>
</td></tr>
<tr><td><code id="query_documents_+3A_metadata">metadata</code></td>
<td>
<p>Whether to include Cosmos DB document metadata in the query result.</p>
</td></tr>
<tr><td><code id="query_documents_+3A_headers">headers</code>, <code id="query_documents_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to lower-level functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the primary function for querying the contents of a Cosmos DB container (table). The <code>query</code> argument should contain the text of a SQL query, optionally parameterised. if the query contains parameters, pass them in the <code>parameters</code> argument as a named list.
</p>
<p>Cosmos DB is a partitioned key-value store under the hood, with documents stored in separate physical databases according to their value of the partition key. The Cosmos DB REST API has limited support for cross-partition queries: basic SELECTs should work, but aggregates and more complex queries may require some hand-hacking.
</p>
<p>The default <code>cross_partition=TRUE</code> runs the query for all partition key values and then attempts to stitch the results together. To run the query for only one key value, set <code>cross_partition=FALSE</code> and <code>partition_key</code> to the desired value. You can obtain all the values of the key with the <a href="#topic+list_partition_key_values">list_partition_key_values</a> function.
</p>
<p>The <code>by_pkrange</code> argument allows running the query separately across all <em>partition key ranges</em>. Each partition key range corresponds to a separate physical partition, and contains the documents for one or more key values. You can set this to TRUE to run a query that fails when run across partitions; the returned object will be a list containing the individual query results from each pkrange.
</p>
<p>As an alternative to AzureCosmosR, you can also use the ODBC protocol to interface with the SQL API. By installing a suitable ODBC driver, you can then talk to Cosmos DB in a manner similar to other SQL databases. An advantage of the ODBC interface is that it fully supports cross-partition queries, unlike the REST API. A disadvantage is that it does not support nested document fields; functions like <code>array_contains()</code> cannot be used, and attempts to reference arrays and objects may return incorrect results.
</p>


<h3>Value</h3>

<p><code>query_documents</code> returns the results of the query. Most of the time this will be a data frame, or list of data frames if <code>by_pkrange=TRUE</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+cosmos_container">cosmos_container</a>, <a href="#topic+cosmos_document">cosmos_document</a>, <a href="#topic+list_partition_key_values">list_partition_key_values</a>, <a href="#topic+list_partition_key_ranges">list_partition_key_ranges</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

endp &lt;- cosmos_endpoint("https://myaccount.documents.azure.com:443/", key="mykey")

# importing the Star Wars data from dplyr
cont &lt;- endp %&gt;%
    get_cosmos_database(endp, "mydatabase") %&gt;%
    create_cosmos_container(db, "mycontainer", partition_key="sex")

bulk_import(cont, dplyr::starwars)

query_documents(cont, "select * from mycontainer")

# removing the Cosmos DB metadata cruft
query_documents(cont, "select * from mycontainer", metadata=FALSE)

# a simple filter
query_documents(cont, "select * from mycontainer c where c.gender = 'masculine'")

# run query for one partition key -- zero rows returned
query_documents(cont, "select * from mycontainer c where c.gender = 'masculine'",
    partition_key="female")

# aggregates will fail -- API does not fully support cross-partition queries
try(query_documents(cont, "select avg(c.height) avgheight from mycontainer c"))
# Error in process_cosmos_response.response(response, simplify = as_data_frame) :
#  Bad Request (HTTP 400). Failed to complete Cosmos DB operation. Message:
# ...

# run query separately by pkrange and combine the results manually
query_documents(
    cont,
    "select avg(c.height) avgheight, count(1) n from mycontainer c",
    by_pkrange=TRUE
)


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
