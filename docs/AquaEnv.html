<!DOCTYPE html><html><head><title>Help for package AquaEnv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AquaEnv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aquaenv'><p>aquaenv</p></a></li>
<li><a href='#AquaEnv_package'><p>AquaEnv - an integrated development toolbox for aquatic</p>
chemical model generation</a></li>
<li><a href='#as.data.frame.aquaenv'><p>as.data.frame.aquaenv</p></a></li>
<li><a href='#BufferFactors'><p>BufferFactors</p></a></li>
<li><a href='#c.aquaenv'><p>c.aquaenv</p></a></li>
<li><a href='#ConcRelCl'><p>ConcRelCl</p></a></li>
<li><a href='#convert'><p>convert</p></a></li>
<li><a href='#DeltaPcoeffs'><p>DeltaPcoeffs</p></a></li>
<li><a href='#gauge_p'><p>gauge\_p</p></a></li>
<li><a href='#K_BOH3'><p>K\_BOH3</p></a></li>
<li><a href='#K_CO2'><p>K\_CO2</p></a></li>
<li><a href='#K_H2PO4'><p>K\_H2PO4</p></a></li>
<li><a href='#K_H2S'><p>K\_H2S</p></a></li>
<li><a href='#K_H3PO4'><p>K\_H3PO4</p></a></li>
<li><a href='#K_HCO3'><p>K\_HCO3</p></a></li>
<li><a href='#K_HF'><p>K\_HF</p></a></li>
<li><a href='#K_HPO4'><p>K\_HPO4</p></a></li>
<li><a href='#K_HSO4'><p>K\_HSO4</p></a></li>
<li><a href='#K_NH4'><p>K\_NH4</p></a></li>
<li><a href='#K_SiOH4'><p>K\_SiOH4</p></a></li>
<li><a href='#K_SiOOH3'><p>K\_SiOOH3</p></a></li>
<li><a href='#K_W'><p>K\_W</p></a></li>
<li><a href='#K0_CO2'><p>K0\_CO2</p></a></li>
<li><a href='#K0_O2'><p>K0\_O2</p></a></li>
<li><a href='#Ksp_aragonite'><p>Ksp\_aragonite</p></a></li>
<li><a href='#Ksp_calcite'><p>Ksp\_calcite</p></a></li>
<li><a href='#length.aquaenv'><p>length.aquaenv</p></a></li>
<li><a href='#MeanMolecularMass'><p>MeanMolecularMass</p></a></li>
<li><a href='#merge.aquaenv'><p>merge.aquaenv</p></a></li>
<li><a href='#PhysChemConst'><p>PhysChemConst</p></a></li>
<li><a href='#plot.aquaenv'><p>plot.aquaenv</p></a></li>
<li><a href='#sample_dickson1981'><p>sample\_dickson1981</p></a></li>
<li><a href='#sample_dickson2007'><p>sample\_dickson2007</p></a></li>
<li><a href='#TAfit'><p>TAfit</p></a></li>
<li><a href='#Technicals'><p>Technicals</p></a></li>
<li><a href='#titration'><p>titration</p></a></li>
<li><a href='#watdepth'><p>watdepth</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0-4</td>
</tr>
<tr>
<td>Title:</td>
<td>Integrated Development Toolbox for Aquatic Chemical Model
Generation</td>
</tr>
<tr>
<td>Author:</td>
<td>Andreas F. Hofmann, Karline Soetaert, Filip J.R. Meysman, 
        Mathilde Hagens</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Karline Soetaert &lt;Karline.Soetaert@nioz.nl&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>minpack.lm, graphics, grDevices, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>deSolve</td>
</tr>
<tr>
<td>Description:</td>
<td>Toolbox for the experimental aquatic chemist, focused on 
        acidification and CO2 air-water exchange. It contains all elements to
        model the pH, the related CO2 air-water exchange, and
        aquatic acid-base chemistry for an arbitrary marine,
        estuarine or freshwater system. It contains a suite of tools for 
        sensitivity analysis, visualisation, modelling of chemical batches, 
        and can be used to build dynamic models of aquatic systems. 
        As from version 1.0-4, it also contains functions to calculate 
        the buffer factors. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-09-06 16:39:52</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository/R-Forge/Project:</td>
<td>aquaenv</td>
</tr>
<tr>
<td>Repository/R-Forge/Revision:</td>
<td>97</td>
</tr>
<tr>
<td>Repository/R-Forge/DateTimeStamp:</td>
<td>2016-09-05 13:48:52</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-09-05 14:07:37 UTC; rforge</td>
</tr>
</table>
<hr>
<h2 id='aquaenv'>aquaenv</h2><span id='topic+aquaenv'></span>

<h3>Description</h3>

<p>PUBLIC function: the main function of the package AquaEnv: creates an object of class aquaenv</p>


<h3>Usage</h3>

<pre><code class='language-R'>aquaenv(S, t, p=pmax((P-Pa), gauge_p(d, lat, Pa)),
        P=Pa, Pa=1.01325, d=0, lat=0,
        SumCO2=0, SumNH4=0, SumH2S=0, SumH3PO4=0,
        SumSiOH4=0, SumHNO3=0, SumHNO2=0, SumBOH3=NULL,
        SumH2SO4=NULL, SumHF=NULL, TA=NULL, pH=NULL, fCO2=NULL, CO2=NULL,
        speciation=TRUE, dsa=FALSE, ae=NULL, from.data.frame=FALSE,
        SumH2SO4_Koffset=0, SumHF_Koffset=0, revelle=FALSE, skeleton=FALSE,
        k_w=NULL, k_co2=NULL, k_hco3=NULL, k_boh3=NULL, k_hso4=NULL,
        k_hf=NULL, k1k2="lueker", khf="dickson", khso4="dickson", 
        fCO2atm=0.000400, fO2atm=0.20946)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aquaenv_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure)
in bars, standard is calculated either from the given P,
or the given d, lat, and Pa</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_p">P</code></td>
<td>
<p>total pressure in bars, standard: Pa (at the surface)</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_pa">Pa</code></td>
<td>
<p>atmospheric pressure in bars, standard: 1 atm (at sea-level) </p>
</td></tr>
<tr><td><code id="aquaenv_+3A_d">d</code></td>
<td>
<p>depth below the surface in meters, standard: 0 (at the surface)</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_lat">lat</code></td>
<td>
<p>latitude in degrees (-90 to +90) to calculate the
gravitational constant g for calculating the water depth from the
pressure and vice versa, standard: 0</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumco2">SumCO2</code></td>
<td>
<p>total carbonate concentration in mol/kg-solution, if NULL is supplied it is calculated</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumnh4">SumNH4</code></td>
<td>
<p>total ammonium concentration in mol/kg-solution, optional</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumh2s">SumH2S</code></td>
<td>
<p>total sulfide concentration in mol/kg-solution, optional</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumh3po4">SumH3PO4</code></td>
<td>
<p>total phosphate concentration in mol/kg-solution, optional</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumsioh4">SumSiOH4</code></td>
<td>
<p>total silicate concentration in mol/kg-solution, optional</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumhno3">SumHNO3</code></td>
<td>
<p>total nitrate concentration in mol/kg-solution, optional</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumhno2">SumHNO2</code></td>
<td>
<p>total nitrite concentration in mol/kg-solution, optional</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumboh3">SumBOH3</code></td>
<td>
<p>total borate concentration in mol/kg-solution, calculated from S if not supplied</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution, calculated from S if not supplied</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution, calculated from S if not supplied</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_ta">TA</code></td>
<td>
<p>total alkalinity in mol/kg-solution, if supplied, pH will be calculated</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_ph">pH</code></td>
<td>
<p>pH on the free proton concentration scale, if supplied, total alkalinity will be calculated</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_fco2">fCO2</code></td>
<td>
<p>fugacity of CO2 in the water in atm (i.e. the fugacity of
CO2 in a small volume of air fully equilibrated with a sufficiently
large sample of water), can be used with either [TA], pH, or [CO2] to define the system</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_co2">CO2</code></td>
<td>
<p>concentration of CO2, can be used with either [TA], pH, or fCO2 to define the system </p>
</td></tr>
<tr><td><code id="aquaenv_+3A_speciation">speciation</code></td>
<td>
<p>flag: TRUE = full speciation is calculated</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_dsa">dsa</code></td>
<td>
<p>flag: TRUE = all information necessary to build a pH model with the direct substitution approach (DSA, Hofmann2008) is calculated</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_ae">ae</code></td>
<td>
<p>either an object of class aquaenv used for the cloning functionality or a dataframe used for the from.data.frame
functionality. Note that for cloning the desired k1k2 and khf values need to be specified! (otherwise the default values are used for the cloned object)</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_from.data.frame">from.data.frame</code></td>
<td>
<p>flag: TRUE = the object of class aquaenv is built from the data frame supplied in ae</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumh2so4_koffset">SumH2SO4_Koffset</code></td>
<td>
<p>only used internally to calculate dTAdKdKdSumH2SO4</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_sumhf_koffset">SumHF_Koffset</code></td>
<td>
<p>only used internally to calculate dTAdKdKdSumHF</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_revelle">revelle</code></td>
<td>
<p>flag: TRUE = the revelle factor is numerically calculated. We do however strongly encourage to use the analytical calculation from BufferFactors$RF</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_skeleton">skeleton</code></td>
<td>
<p>flag: TRUE = a reduced amount of information is calculated yielding a smaller object of type aquaenv</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_k_w">k_w</code></td>
<td>
<p>a fixed K\_W can be specified</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_k_co2">k_co2</code></td>
<td>
<p>a fixed K\_CO2 can be specified; used for TA fitting: give a K\_CO2 and NOT calculate it from T and S: i.e. K\_CO2 can be fitted in the routine as well</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_k_hco3">k_hco3</code></td>
<td>
<p>a fixed K\_HCO3 can be specified</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_k_boh3">k_boh3</code></td>
<td>
<p>a fixed K\_BOH3 can be specified</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_k_hso4">k_hso4</code></td>
<td>
<p>a fixed K\_HSO4 can be specified</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_k_hf">k_hf</code></td>
<td>
<p>a fixed K\_HF can be specified</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_k1k2">k1k2</code></td>
<td>
<p>either &quot;lueker&quot; (default, Lueker2000), &quot;roy&quot; (Roy1993a), 
or &quot;millero&quot; (Millero2006) for K\_CO2 and K\_HCO3.</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_khf">khf</code></td>
<td>
<p>either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot;
(Perez1987a) for K\_HF</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_khso4">khso4</code></td>
<td>
<p>either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977) for
K\_HSO4</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_fco2atm">fCO2atm</code></td>
<td>
<p>atmospheric fugacity of CO2 in atm, default =
0.000400 atm</p>
</td></tr>
<tr><td><code id="aquaenv_+3A_fo2atm">fO2atm</code></td>
<td>
<p>atmospheric fugacity of O2 in atm, default =
0.20946 atm</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing: 
&quot;S&quot;                &quot;t&quot;                &quot;p&quot;
&quot;T&quot;                &quot;Cl&quot;               &quot;I&quot;
&quot;P&quot;                &quot;Pa&quot;               &quot;d&quot;
&quot;density&quot;          &quot;SumCO2&quot;          
&quot;SumNH4&quot;           &quot;SumH2S&quot;           &quot;SumHNO3&quot;         
&quot;SumHNO2&quot;          &quot;SumH3PO4&quot;         &quot;SumSiOH4&quot;        
&quot;SumBOH3&quot;          &quot;SumH2SO4&quot;         &quot;SumHF&quot;           
&quot;Br&quot;               &quot;ClConc&quot;           &quot;Na&quot;              
&quot;Mg&quot;               &quot;Ca&quot;               &quot;K&quot;               
&quot;Sr&quot;               &quot;molal2molin&quot;      &quot;free2tot&quot;        
&quot;free2sws&quot;         &quot;tot2free&quot;         &quot;tot2sws&quot;         
&quot;sws2free&quot;         &quot;sws2tot&quot;          &quot;K0\_CO2&quot;          
&quot;K0\_O2&quot;           &quot;fCO2atm&quot;          &quot;fO2atm&quot;
&quot;CO2\_sat&quot;          &quot;O2\_sat&quot;
&quot;K\_W&quot;              &quot;K\_HSO4&quot;           &quot;K\_HF&quot;            
&quot;K\_CO2&quot;            &quot;K\_HCO3&quot;           &quot;K\_BOH3&quot;          
&quot;K\_NH4&quot;            &quot;K\_H2S&quot;            &quot;K\_H3PO4&quot;         
&quot;K\_H2PO4&quot;          &quot;K\_HPO4&quot;           &quot;K\_SiOH4&quot;         
&quot;K\_SiOOH3&quot;         &quot;K\_HNO2&quot;           &quot;K\_HNO3&quot;          
&quot;K\_H2SO4&quot;          &quot;K\_HS&quot;             &quot;Ksp\_calcite&quot;     
&quot;Ksp\_aragonite&quot;    &quot;TA&quot;               &quot;pH&quot;              
&quot;fCO2&quot;             &quot;CO2&quot;              &quot;HCO3&quot;            
&quot;CO3&quot;              &quot;BOH3&quot;             &quot;BOH4&quot;            
&quot;OH&quot;               &quot;H3PO4&quot;            &quot;H2PO4&quot;           
&quot;HPO4&quot;             &quot;PO4&quot;              &quot;SiOH4&quot;           
&quot;SiOOH3&quot;           &quot;SiO2OH2&quot;          &quot;H2S&quot;             
&quot;HS&quot;               &quot;S2min&quot;            &quot;NH4&quot;             
&quot;NH3&quot;              &quot;H2SO4&quot;            &quot;HSO4&quot;            
&quot;SO4&quot;              &quot;HF&quot;               &quot;F&quot;               
&quot;HNO3&quot;             &quot;NO3&quot;              &quot;HNO2&quot;            
&quot;NO2&quot;              &quot;omega\_calcite&quot;    &quot;omega\_aragonite&quot; 
&quot;revelle&quot;          &quot;c1&quot;               &quot;c2&quot;              
&quot;c3&quot;               &quot;dTAdSumCO2&quot;       &quot;b1&quot;              
&quot;b2&quot;               &quot;dTAdSumBOH3&quot;      &quot;so1&quot;             
&quot;so2&quot;              &quot;so3&quot;              &quot;dTAdSumH2SO4&quot;    
&quot;f1&quot;               &quot;f2&quot;               &quot;dTAdSumHF&quot;       
&quot;dTAdH&quot;            &quot;dTAdKdKdS&quot;        &quot;dTAdKdKdT&quot;       
&quot;dTAdKdKdd&quot;        &quot;dTAdKdKdSumH2SO4&quot; &quot;dTAdKdKdSumHF&quot;   
or a subset of this set. Please consult the vignette of AquaEnv for more details
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
############################
# Minimal aquaenv definition
############################
ae &lt;- aquaenv(S=30, t=15)
ae$K_CO2

ae$Ksp_calcite
ae$Ksp_aragonite

ae &lt;- aquaenv(S=30, t=15, p=10)
ae &lt;- aquaenv(S=30, t=15, P=11)
ae &lt;- aquaenv(S=30, t=15, d=100)
ae &lt;- aquaenv(S=30, t=15, d=100, Pa=0.5)
ae$K_CO2

ae$Ksp_calcite
ae$Ksp_aragonite

ae


########################################################
# Defining the complete aquaenv system in different ways
########################################################
S      &lt;- 30
t      &lt;- 15
p      &lt;- gauge_p(d=10)  # ~ p &lt;- 0.1*10*1.01325
SumCO2 &lt;- 0.0020
pH     &lt;- 8
TA     &lt;- 0.002140798
fCO2   &lt;- 0.0005326744
CO2    &lt;- 2.051946e-05

ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, pH=pH)
ae$TA

ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, TA=TA)
ae$pH

ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, CO2=CO2)
ae$pH

ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, fCO2=fCO2)
ae$pH

ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, CO2=CO2, fCO2=fCO2)
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, pH=pH, TA=TA)
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, pH=pH, CO2=CO2)
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, pH=pH, fCO2=fCO2)
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, TA=TA, CO2=CO2)
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, TA=TA, fCO2=fCO2)


################################################################
# Cloning the aquaenv system: 1 to 1 and with different pH or TA
################################################################
S      &lt;- 30
t      &lt;- 15
SumCO2 &lt;- 0.0020
TA     &lt;- 0.00214


ae &lt;- aquaenv(S, t, SumCO2=SumCO2, TA=TA)

aeclone1 &lt;- aquaenv(ae=ae)

pH &lt;- 9

aeclone2 &lt;- aquaenv(ae=ae, pH=pH)

TA &lt;- 0.002

aeclone3 &lt;- aquaenv(ae=ae, TA=TA)

ae$pH
aeclone1$pH
aeclone2$TA
aeclone3$pH



#########################################################################
# Vectors as input variables (only ONE input variable may be a vector)
# (with full output: including the Revelle factor and the DSA properties)
#########################################################################
SumCO2 &lt;- 0.0020
pH     &lt;- 8

S      &lt;- 30
t      &lt;- 1:15
p      &lt;- gauge_p(10)
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, pH=pH, revelle=TRUE, dsa=TRUE)
plot(ae, xval=t, xlab="T/(deg C)", newdevice=FALSE)

S  &lt;- 1:30
t  &lt;- 15
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, pH=pH, revelle=TRUE, dsa=TRUE)
plot(ae, xval=S, xlab="S", newdevice=FALSE)

S  &lt;- 30
p  &lt;- gauge_p(seq(1,1000, 100))
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, pH=pH, revelle=TRUE, dsa=TRUE)
plot(ae, xval=p, xlab="gauge pressure/bar", newdevice=FALSE)



TA &lt;- 0.0023

S  &lt;- 30
t  &lt;- 1:15
d  &lt;- gauge_p(10)
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, TA=TA, revelle=TRUE, dsa=TRUE)
plot(ae, xval=t, xlab="T/(deg C)", newdevice=FALSE)

S  &lt;- 1:30
t  &lt;- 15
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, TA=TA, revelle=TRUE, dsa=TRUE)
plot(ae, xval=S, xlab="S", newdevice=FALSE)

S  &lt;- 30
p  &lt;- gauge_p(seq(1,1000, 100))
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, TA=TA, revelle=TRUE, dsa=TRUE)
plot(ae, xval=p, xlab="gauge pressure/bar", newdevice=FALSE)



##################################################################
# Calculating SumCO2 by giving a constant  pH&amp;CO2, pH&amp;fCO2, pH&amp;TA,
# TA&amp;CO2, or TA&amp;fCO2
##################################################################
fCO2   &lt;- 0.0006952296
CO2    &lt;- 2.678137e-05
pH     &lt;- 7.888573
TA     &lt;- 0.0021

S  &lt;- 30
t  &lt;- 15
p  &lt;- gauge_p(10)

ae &lt;- aquaenv(S, t, p, SumCO2=NULL, pH=pH, CO2=CO2, dsa=TRUE, revelle=TRUE)
ae$SumCO2
ae$revelle
ae$dTAdH

ae &lt;- aquaenv(S, t, p, SumCO2=NULL, pH=pH, fCO2=fCO2)
ae$SumCO2

ae &lt;- aquaenv(S, t, p, SumCO2=NULL, pH=pH, TA=TA)
ae$SumCO2

ae &lt;- aquaenv(S, t, p, SumCO2=NULL, TA=TA, CO2=CO2)
ae$SumCO2

ae &lt;- aquaenv(S, t, p, SumCO2=NULL, TA=TA, fCO2=fCO2)
ae$SumCO2


t  &lt;- 1:15
ae &lt;- aquaenv(S, t, p, SumCO2=NULL, pH=pH, CO2=CO2)
plot(ae, xval=t, xlab="T/(deg C)", mfrow=c(9,10), newdevice=FALSE)

ae &lt;- aquaenv(S, t, p, SumCO2=NULL, pH=pH, CO2=CO2, revelle=TRUE, dsa=TRUE)
plot(ae, xval=t, xlab="T/(deg C)", newdevice=FALSE)

S  &lt;- 1:30
t  &lt;- 15
ae &lt;- aquaenv(S, t, p, SumCO2=NULL, pH=pH, fCO2=fCO2, revelle=TRUE, dsa=TRUE)
plot(ae, xval=S, xlab="S", newdevice=FALSE)

S  &lt;- 30
p  &lt;- gauge_p(seq(1,1000, 100))
ae &lt;- aquaenv(S, t, p, SumCO2=NULL, pH=pH, TA=TA, revelle=TRUE, dsa=TRUE)
plot(ae, xval=p, xlab="gauge pressure/bar", newdevice=FALSE)


## End(Not run)</code></pre>

<hr>
<h2 id='AquaEnv_package'>AquaEnv - an integrated development toolbox for aquatic
chemical model generation</h2><span id='topic+AquaEnv'></span>

<h3>Description</h3>

<p>AquaEnv is an integrated development toolbox for aquatic
chemical model generation focused on (ocean)
acidification and CO2 air-water exchange.
</p>
<p>It contains
all elements necessary to model the pH, the related CO2
air-water exchange, as well as aquatic acid-base
chemistry in general for an arbitrary marine, estuarine
or freshwater system. Also chemical batches can be
modelled.
</p>
<p>Next to the routines necessary to calculate
desired information, AquaEnv also contains a suite of
tools to visualize this information. Furthermore,
AquaEnv can not only be used to build dynamic models of
aquatic systems, but it can also serve as a simple
desktop tool for the experimental aquatic chemist to
generate and visualize all possible derived information
from a set of measurements with one single easy to use R
function.
</p>
<p>Additionally, the sensitivity of the system to
variations in the input variables can be visualized.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> AquaEnv</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 2016-05-18</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GNU Public License 2 or above</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Karline Soetaert (Maintainer), Andreas F. Hofmann, Mathilde Hagens 
</p>


<h3>References</h3>

<p>Hagens M. and J.J. Middelburg, 2016 Generalised expressions for the response of pH to changes in ocean chemistry. <em>Geochimica et Cosmochimica Acta, in press</em>.
</p>
<p>Hofmann A. F., K. Soetaert,  J.J. Middelburg, F. J. R. Meysman, 2010 AquaEnv: An Aquatic Acid-Base Modelling Environment in R. <em>Aquatic Geochemistry</em> <b>16</b>: 507-546.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## show examples (see respective help pages for details)
example(aquaenv)

## open the directory with source code of demos
browseURL(paste(system.file(package="AquaEnv"), "/demo", sep=""))

## run demos
demo(basicfeatures )

## show package vignette with tutorial about how to use aquaenv
vignette("AquaEnv")
edit(vignette("AquaEnv"))
browseURL(paste(system.file(package="AquaEnv"), "/doc", sep=""))

## show index file of package vignettes and documentation files
browseURL(paste(system.file(package="AquaEnv"), "/doc/index.html", sep=""))

## show documentation about private functions in the packet
browseURL(paste(system.file(package="AquaEnv"), "/doc/AquaEnv-PrivateFunctions.pdf", sep=""))

## show documentation about physical-chemical constants and formulae used in the packet
browseURL(paste(system.file(package="AquaEnv"), "/doc/AquaEnv-ConstantsAndFormulae.pdf", sep=""))

## End(Not run)
</code></pre>

<hr>
<h2 id='as.data.frame.aquaenv'>as.data.frame.aquaenv</h2><span id='topic+as.data.frame.aquaenv'></span>

<h3>Description</h3>

<p>PUBLIC function: converts an object of class aquaenv to a standard R data frame</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aquaenv'
as.data.frame(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.aquaenv_+3A_x">x</code></td>
<td>
<p>object of type aquaenv</p>
</td></tr>
<tr><td><code id="as.data.frame.aquaenv_+3A_...">...</code></td>
<td>
<p>further arguments are passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing all elements of aquaenv
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='BufferFactors'>BufferFactors</h2><span id='topic+BufferFactors'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates buffer factors describing the
sensitivity of pH and concentrations of acid-base species to a change
in ocean chemistry</p>


<h3>Usage</h3>

<pre><code class='language-R'>BufferFactors(ae = NULL, parameters = NA, species = c("SumCO2"),
                     k_w = NULL, k_co2 = NULL, k_hco3 = NULL, 
                     k_boh3 = NULL, k_hso4 = NULL,
                     k_hf = NULL, k1k2 = "lueker", 
                     khf = "dickson", khso4 = "dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BufferFactors_+3A_ae">ae</code></td>
<td>
<p>an object of class 'aquaenv'. An error is produced in case
an object is provided that is not of class 'aquaenv',</p>
</td></tr> 
<tr><td><code id="BufferFactors_+3A_parameters">parameters</code></td>
<td>
<p>a vector containing one or more of the following
variables: &quot;DIC&quot; (mol/kg-soln), &quot;TotNH3&quot; (mol/kg-soln), &quot;TotP&quot; 
(mol/kg-soln), &quot;TotNO3&quot; (mol/kg-soln), &quot;TotNO2&quot; (mol/kg-soln), 
&quot;TotS&quot; (mol/kg-soln), &quot;TotSi&quot; (mol/kg-soln), &quot;TB&quot; (mol/kg-soln), 
&quot;TotF&quot; (mol/kg-soln), &quot;TotSO4&quot; (mol/kg-soln), &quot;sal&quot; (-), &quot;temp&quot; 
(deg C), &quot;pres&quot; (bar), &quot;Alk&quot; (mol/kg-soln). If a variable is not 
supplied and no object of class 'aquaenv' is provided, default values 
are assigned following Table 4 of Hagens and Middelburg (2016). If 
both ae and parameters are supplied, given parameters will overwrite 
the corresponding values of ae</p>
</td></tr>
<tr><td><code id="BufferFactors_+3A_species">species</code></td>
<td>
<p>a vector containing one or more of the following
variables: &quot;SumCO2&quot;, &quot;SumNH4&quot;, &quot;SumH3PO4&quot;, &quot;SumHNO3&quot;, &quot;SumHNO2&quot;, 
&quot;SumH2S&quot;, &quot;SumSiOH4&quot;, &quot;SumBOH3&quot;, &quot;SumHF&quot;, &quot;SumH2SO4&quot;, &quot;CO2&quot;, &quot;HCO3&quot;,            
&quot;CO3&quot;, &quot;BOH3&quot;, &quot;BOH4&quot;, &quot;OH&quot;, &quot;H3PO4&quot;, &quot;H2PO4&quot;, &quot;HPO4&quot;, &quot;PO4&quot;, 
&quot;SiOH4&quot;, &quot;SiOOH3&quot;, &quot;SiO2OH2&quot;, &quot;H2S&quot;, &quot;HS&quot;, &quot;S2min&quot;, &quot;NH4&quot;, &quot;NH3&quot;, 
&quot;H2SO4&quot;, &quot;HSO4&quot;, &quot;SO4&quot;, &quot;HF&quot;, &quot;F&quot;, &quot;HNO3&quot;, &quot;NO3&quot;, &quot;HNO2&quot;, &quot;NO2&quot;. 
Default is c(&quot;SumCO2&quot;). This vector defines the species for which the
sensitivities are calculated</p>
</td></tr>
<tr><td><code id="BufferFactors_+3A_k_w">k_w</code></td>
<td>
<p>a fixed K\_W can be specified</p>
</td></tr>
<tr><td><code id="BufferFactors_+3A_k_co2">k_co2</code></td>
<td>
<p>a fixed K\_CO2 can be specified</p>
</td></tr>
<tr><td><code id="BufferFactors_+3A_k_hco3">k_hco3</code></td>
<td>
<p>a fixed K\_HCO3 can be specified</p>
</td></tr>
<tr><td><code id="BufferFactors_+3A_k_boh3">k_boh3</code></td>
<td>
<p>a fixed K\_BOH3 can be specified</p>
</td></tr>
<tr><td><code id="BufferFactors_+3A_k_hso4">k_hso4</code></td>
<td>
<p>a fixed K\_HSO4 can be specified</p>
</td></tr>
<tr><td><code id="BufferFactors_+3A_k_hf">k_hf</code></td>
<td>
<p>a fixed K\_HF can be specified</p>
</td></tr>
<tr><td><code id="BufferFactors_+3A_k1k2">k1k2</code></td>
<td>
<p>either &quot;lueker&quot; (default, Lueker2000), &quot;roy&quot; (Roy1993a),
or &quot;millero&quot; (Millero2006) for K\_CO2 and K\_HCO3</p>
</td></tr>
<tr><td><code id="BufferFactors_+3A_khf">khf</code></td>
<td>
<p>either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot;
(Perez1987a) for K\_HF</p>
</td></tr>
<tr><td><code id="BufferFactors_+3A_khso4">khso4</code></td>
<td>
<p>either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; 
(Khoo1977) for K\_HSO4</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the objects &quot;ae&quot;, &quot;dTA.dH&quot;, &quot;dtotX.dH&quot;, 
&quot;dTA.dX&quot;, &quot;dtotX.dX&quot;, &quot;dTA.dpH&quot;, &quot;dtotX.dpH&quot;, &quot;dH.dTA&quot;, &quot;dH.dtotX&quot;, 
&quot;dX.dTA&quot;, &quot;dX.dtotX&quot;, &quot;dpH.dTA&quot;, &quot;dpH.dtotX&quot;, &quot;beta.H&quot; and &quot;RF&quot;.
</p>
<p>The object 'ae' is of class 'aquaenv' and refers to the output of the 
aquaenv function that is always run as part of BufferFactors. Consult 
the vignette of AquaEnv for more information on this object. The 
other objects are vectors with the length and names of the input 
species. Exceptions here are dH.dtotX and dpH.dtotX, which also 
contain the numerically estimated sensitivities with respect to 
salinity, pressure and temperature, as well as two factors related to 
pH scale conversion (see the AquaEnv vignette for details on these
latter conversion factors).
</p>
<p>In case species are defined which corresponding total concentration 
equals zero, the corresponding output produces 'NaN'. This is with
the exception of &quot;dTA.dH&quot; and &quot;dTA.dpH&quot;, which are always calculated
as they are linked to beta.H. Additionally, the Revelle factor is
always calculated, as the function 'aquaenv' requires that the 
carbonate system be specified.
</p>


<h3>Author(s)</h3>

<p>Mathilde Hagens (<a href="mailto:M.Hagens@uu.nl">M.Hagens@uu.nl</a>)</p>


<h3>References</h3>

<p>Hagens M. and J.J. Middelburg, 2016 Generalised expressions for the response of pH to changes in ocean chemistry. <em>Geochimica et Cosmochimica Acta, in press</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Default run
BufferFactors()

# All carbonate system species
BufferFactors(species = c("CO2", "HCO3", "CO3"))

# Total concentrations of all species
BufferFactors(species = c("SumCO2", "SumNH4", "SumH3PO4", "SumHNO3",
                          "SumHNO2", "SumH2S", "SumSiOH4", "SumBOH3",
                          "SumHF", "SumH2SO4"))

# Different carbonate system equilibrium constants
BufferFactors(k1k2 = "roy")

# Object of class 'aquaenv' as input
ae_input &lt;- aquaenv(S=35, t=25, SumCO2 = 0.0020, pH = 8.1,
                    skeleton = TRUE)
BufferFactors(ae = ae_input)

# Produces some NaNs as certain total concentrations are zero
BufferFactors(ae = ae_input, 
              species = c("SumCO2", "SumNH4", "SumH3PO4", "SumHNO3",
                          "SumHNO2", "SumH2S", "SumSiOH4", "SumBOH3",
                          "SumHF", "SumH2SO4"))

# Object of class 'aquaenv' as input, but different total alkalinity
parameters &lt;- c(Alk = 0.0022)
BufferFactors(ae = ae_input, parameters = parameters)


## End(Not run)</code></pre>

<hr>
<h2 id='c.aquaenv'>c.aquaenv</h2><span id='topic+c.aquaenv'></span>

<h3>Description</h3>

<p>PRIVATE function: adds an element to an object of class aquaenv</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aquaenv'
c(aquaenv, x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="c.aquaenv_+3A_aquaenv">aquaenv</code></td>
<td>
<p>object of class aquaenv</p>
</td></tr>
<tr><td><code id="c.aquaenv_+3A_x">x</code></td>
<td>
<p>a vector of the form c(value, name) representing the element to be inserted into the object of class aquaenv</p>
</td></tr>
<tr><td><code id="c.aquaenv_+3A_...">...</code></td>
<td>
<p>further arguments will be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class aquaenv with the added element
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='ConcRelCl'>ConcRelCl</h2><span id='topic+ConcRelCl'></span>

<h3>Description</h3>

<p>PUBLIC data frame: a collection of concentrations of key chemical species in seawater, relative with respect to chlorinity (DOE1994))</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='convert'>convert</h2><span id='topic+convert'></span>

<h3>Description</h3>

<p>PUBLIC function: converts either a single value (the pH scale of a pH value, the pH scale of a dissociation constant (K*), the unit of a concentration value), or all elements of a special unit or pH scale in an object of class aquaenv</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_+3A_x">x</code></td>
<td>
<p>object to be converted: either a single value (pH value, K* value, or concentration value) or an object of class aquaenv</p>
</td></tr>
<tr><td><code id="convert_+3A_vartype">vartype</code></td>
<td>
<p>only valid if x is a single value: the type of x, either &quot;pHscale&quot;, &quot;KHscale&quot;, or &quot;conc&quot;</p>
</td></tr>
<tr><td><code id="convert_+3A_what">what</code></td>
<td>
<p>only valid if x is a single value: only valid if x is a single value: the type of conversion to be done, for pH scales one of &quot;free2tot&quot;, &quot;free2sws&quot;, &quot;free2nbs&quot;, ... (any combination of &quot;free&quot;, &quot;tot&quot;, &quot;sws&quot;, and &quot;nbs&quot;); for concentrations one of &quot;molar2molal&quot;, &quot;molar2molin&quot;, ... (any combination of &quot;molar&quot; (mol/l), &quot;molal&quot; (mol/kg-H2O), and &quot;molin&quot; (mol/kg-solution))</p>
</td></tr>
<tr><td><code id="convert_+3A_s">S</code></td>
<td>
<p>only valid if x is a single value: salinity (in practical salinity units: no unit)</p>
</td></tr>
<tr><td><code id="convert_+3A_t">t</code></td>
<td>
<p>only valid if x is a single value: temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="convert_+3A_p">p</code></td>
<td>
<p>only valid if x is a single value: gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="convert_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>only valid if x is a single value: total sulfate concentration in mol/kg-solution; if not supplied this is calculated from S</p>
</td></tr>
<tr><td><code id="convert_+3A_sumhf">SumHF</code></td>
<td>
<p>only valid if x is a single value: total fluoride concentration in mol/kg-solution; if not supplied this is calculated from S</p>
</td></tr>
<tr><td><code id="convert_+3A_khf">khf</code></td>
<td>
<p>only valid if x is a single value: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a) for K\_HF</p>
</td></tr>
<tr><td><code id="convert_+3A_khso4">khso4</code></td>
<td>
<p>only valid if x is a single value: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977) for K\_HSO4</p>
</td></tr>
<tr><td><code id="convert_+3A_from">from</code></td>
<td>
<p>only valid if x is an object of class aquaenv: the unit which needs to be converted (as a string; must be a perfect match)</p>
</td></tr>
<tr><td><code id="convert_+3A_to">to</code></td>
<td>
<p>only valid if x is an object of class aquaenv: the unit to which the conversion should go</p>
</td></tr>
<tr><td><code id="convert_+3A_factor">factor</code></td>
<td>
<p>only valid if x is an object of class aquaenv: the conversion factor to be applied: can either be a number (e.g. 1000 to convert from mol to mmol), or any of the conversion factors given in an object of class  aquaenv</p>
</td></tr>
<tr><td><code id="convert_+3A_convattr">convattr</code></td>
<td>
<p>only valid if x is an object of class aquaenv: which attribute should be converted? can either be &quot;unit&quot; or &quot;pH scale&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible usages are
</p>
<pre>
convert(x, vartype, what, S, t, p, SumH2SO4, SumHF, khf)
convert(x, from, to, factor, convattr)</pre>

<h3>Value</h3>

<p>converted single value or object of class aquaenv with converted elements
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### 1
#####

t &lt;- 15
S  &lt;- 10

pH_NBS      &lt;- 8.142777
SumCO2molar &lt;- 0.002016803

pH_free     &lt;- convert(pH_NBS,      "pHscale", "nbs2free",    S=S, t=t)
SumCO2molin &lt;- convert(SumCO2molar, "conc",    "molar2molin", S=S, t=t)

ae &lt;- aquaenv(S, t, SumCO2=SumCO2molin, pH=pH_free)
ae$pH
ae$SumCO2



### 2
#####
ae &lt;- aquaenv(30,10)
ae$SumBOH3
ae &lt;- convert(ae, "mol/kg-soln", "umol/kg-H2O", 1e6/ae$molal2molin, "unit")
ae$SumBOH3


## End(Not run)</code></pre>

<hr>
<h2 id='DeltaPcoeffs'>DeltaPcoeffs</h2><span id='topic+DeltaPcoeffs'></span>

<h3>Description</h3>

<p>PUBLIC data frame: a collection of coefficients for the pressure correction of dissociation constants and solubility products (Millero1995 WITH CORRECTIONS BY Lewis1998 (CO2Sys)!)</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='gauge_p'>gauge\_p</h2><span id='topic+gauge_p'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the gauge pressure (total pressure minus atmospheric pressure) from the depth (in m) and the latitude (in degrees: -90 to 90) and the atmospheric pressure (in bar)</p>


<h3>Usage</h3>

<pre><code class='language-R'>gauge_p(d, lat=0, Pa=1.01325)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gauge_p_+3A_d">d</code></td>
<td>
<p>water depth in meters</p>
</td></tr>
<tr><td><code id="gauge_p_+3A_lat">lat</code></td>
<td>
<p>latitude in degrees: -90 to 90, standard: 0</p>
</td></tr>
<tr><td><code id="gauge_p_+3A_pa">Pa</code></td>
<td>
<p>atmospheric pressure in bar, standard: 1 atm (at sea level)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>gauge pressure (total pressure minus atmospheric pressure) p in bars</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Fofonoff1983</p>


<h3>Examples</h3>

<pre><code class='language-R'>gauge_p(100)
plot(gauge_p(1:100))
</code></pre>

<hr>
<h2 id='K_BOH3'>K\_BOH3</h2><span id='topic+K_BOH3'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of B(OH)3</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_BOH3(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_BOH3_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_BOH3_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_BOH3_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_BOH3_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_BOH3_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_BOH3_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_BOH3_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of B(OH)3 in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Dickson1990, DOE1994, Millero1995 (molality version given), Zeebe2001</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_BOH3(35, 15)
K_BOH3(35, 15, 10)
K_BOH3(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_BOH3(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_CO2'>K\_CO2</h2><span id='topic+K_CO2'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of CO2</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_CO2(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, k1k2="lueker", khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_CO2_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_CO2_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_CO2_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_CO2_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_CO2_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_CO2_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;lueker&quot;, &quot;roy&quot;, or &quot;millero&quot;: specifies the S, t,
dependency to be used. Default is &quot;lueker&quot;. (see section below for
references)</p>
</td></tr>
<tr><td><code id="K_CO2_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_CO2_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of CO2 in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>k1k2 = &quot;roy&quot;: Roy1993b, DOE1994, Millero1995, Zeebe2001;
k1k2 = &quot;lueker&quot;: Lueker2000;
k1k2 = &quot;millero&quot;: Millero2006</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_CO2(35, 15)
K_CO2(35, 15, 10)
K_CO2(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_CO2(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_H2PO4'>K\_H2PO4</h2><span id='topic+K_H2PO4'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of H2PO4</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_H2PO4(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_H2PO4_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_H2PO4_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_H2PO4_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_H2PO4_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_H2PO4_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_H2PO4_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_H2PO4_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of H2PO4 in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Millero1995 (original, SWS pH version), DOE1994 (in a later revision cites Millero1995)</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_H2PO4(35, 15)
K_H2PO4(35, 15, 10)
K_H2PO4(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_H2PO4(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_H2S'>K\_H2S</h2><span id='topic+K_H2S'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of H2S</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_H2S(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_H2S_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_H2S_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_H2S_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_H2S_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_H2S_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_H2S_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_H2S_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of H2S in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Millero1988, Millero1995</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_H2S(35, 15)
K_H2S(35, 15, 10)
K_H2S(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_H2S(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_H3PO4'>K\_H3PO4</h2><span id='topic+K_H3PO4'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of H3PO4</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_H3PO4(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_H3PO4_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_H3PO4_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_H3PO4_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_H3PO4_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_H3PO4_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_H3PO4_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_H3PO4_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of H3PO4 in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Millero1995 (original, SWS pH version), DOE1994 (in a later revision cites Millero1995)</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_H3PO4(35, 15)
K_H3PO4(35, 15, 10)
K_H3PO4(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_H3PO4(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_HCO3'>K\_HCO3</h2><span id='topic+K_HCO3'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of HCO3</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_HCO3(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, 
       k1k2="lueker", khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_HCO3_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_HCO3_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_HCO3_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_HCO3_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_HCO3_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_HCO3_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;lueker&quot;, &quot;roy&quot;, or &quot;millero&quot;: specifies the S, t,
dependency to be used. Default is &quot;lueker&quot;. (see section below for
references)</p>
</td></tr>
<tr><td><code id="K_HCO3_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_HCO3_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of HCO3 in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>k1k2 = &quot;roy&quot;: Roy1993b, DOE1994, Millero1995, Zeebe2001;
k1k2 = &quot;lueker&quot;: Lueker2000;
k1k2 = &quot;millero&quot;: Millero2006</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_HCO3(35, 15)
K_HCO3(35, 15, 10)
K_HCO3(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_HCO3(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_HF'>K\_HF</h2><span id='topic+K_HF'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of HF</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_HF(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_HF_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_HF_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_HF_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure)
in bars</p>
</td></tr>
<tr><td><code id="K_HF_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_HF_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_HF_+3A_khf">khf</code></td>
<td>
<p>&quot;dickson&quot; or &quot;perez&quot;: specifies the S, t,
dependency to be used. Default is &quot;dickson&quot;. (see section below for
references)</p>
</td></tr>
<tr><td><code id="K_HF_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of HF in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>khf = &quot;dickson&quot;: Dickson1979a, Dickson1987, Roy1993b, DOE1994, Millero1995,
Zeebe2001;
khf = &quot;perez&quot;: Perez1987</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_HF(35, 15)
K_HF(35, 15, 10)
plot(K_HF(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_HPO4'>K\_HPO4</h2><span id='topic+K_HPO4'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of HPO4</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_HPO4(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_HPO4_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_HPO4_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_HPO4_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_HPO4_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_HPO4_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_HPO4_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_HPO4_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of HPO4 in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Millero1995 (original, SWS pH version), DOE1994 (in a later revision cites Millero1995)</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_HPO4(35, 15)
K_HPO4(35, 15, 10)
K_HPO4(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_HPO4(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_HSO4'>K\_HSO4</h2><span id='topic+K_HSO4'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of HSO4</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_HSO4(S, t, p=0, khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_HSO4_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_HSO4_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_HSO4_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure)
in bars</p>
</td></tr>
<tr><td><code id="K_HSO4_+3A_khso4">khso4</code></td>
<td>
<p>&quot;dickson&quot; or &quot;khoo&quot;: specifies the S, t,
dependency to be used. Default is &quot;dickson&quot;. (see section below for references)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of HSO4 in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>&quot;dickson&quot;: Dickson1990, DOE1994, Zeebe2001;
&quot;khoo&quot;:    Khoo1977, Roy1993, Millero1995</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_HSO4(35, 15)
K_HSO4(35, 15, 10)
plot(K_HSO4(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_NH4'>K\_NH4</h2><span id='topic+K_NH4'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of NH4</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_NH4(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_NH4_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_NH4_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_NH4_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_NH4_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_NH4_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_NH4_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_NH4_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of NH4 in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Millero1995a, Millero1995, corrected by Lewis1998</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_NH4(35, 15)
K_NH4(35, 15, 10)
K_NH4(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_NH4(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_SiOH4'>K\_SiOH4</h2><span id='topic+K_SiOH4'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of SiOH4</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_SiOH4(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_SiOH4_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_SiOH4_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_SiOH4_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_SiOH4_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_SiOH4_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_SiOH4_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_SiOH4_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of SiOH4 in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Millero1988, DOE1994, Millero1995</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_SiOH4(35, 15)
K_SiOH4(35, 15, 10)
K_SiOH4(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_SiOH4(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K_SiOOH3'>K\_SiOOH3</h2><span id='topic+K_SiOOH3'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the dissociation constant of SiOOH3</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_SiOOH3(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_SiOOH3_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_SiOOH3_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_SiOOH3_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_SiOOH3_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_SiOOH3_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_SiOOH3_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_SiOOH3_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dissociation constant of SiOOH3 in mol/kg-solution on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Wischmeyer2003 (incl. corrections)</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_SiOOH3(35, 15)
K_SiOOH3(35, 15, 10)
K_SiOOH3(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_SiOOH3(35, 1:25), xlab="temperature / degC")</code></pre>

<hr>
<h2 id='K_W'>K\_W</h2><span id='topic+K_W'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the ion product of H2O</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_W(S, t, p=0, SumH2SO4=NULL, SumHF=NULL, khf="dickson", khso4="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_W_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K_W_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="K_W_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
<tr><td><code id="K_W_+3A_sumh2so4">SumH2SO4</code></td>
<td>
<p>total sulfate concentration in mol/kg-solution (calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_W_+3A_sumhf">SumHF</code></td>
<td>
<p>total fluoride concentration in mol/kg-solution
(calculated from S if not supplied)</p>
</td></tr>
<tr><td><code id="K_W_+3A_khf">khf</code></td>
<td>
<p>S, t relation for K\_HF needed for scale conversion: either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a)</p>
</td></tr>
<tr><td><code id="K_W_+3A_khso4">khso4</code></td>
<td>
<p>S, t relation for K\_HSO4 needed for scale conversion: either &quot;dickson&quot; (default, Dickson1990) or &quot;khoo&quot; (Khoo1977)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the ion product of H2O in (mol/kg-solution)2 on the free proton pH scale
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Millero1995 (SWS pH version), DOE1994 (cites Millero1995), Zeebe2001</p>


<h3>Examples</h3>

<pre><code class='language-R'>K_W(35, 15)
K_W(35, 15, 10)
K_W(S=35, t=15, p=10, SumH2SO4=0.03)
plot(K_W(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K0_CO2'>K0\_CO2</h2><span id='topic+K0_CO2'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the Henry's constant (solubility) for CO2</p>


<h3>Usage</h3>

<pre><code class='language-R'>K0_CO2(S, t)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K0_CO2_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K0_CO2_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the Henry's constant for CO2 in mol/(kg-solution*atm)
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Weiss1974, DOE1994, Millero1995, Zeebe2001</p>


<h3>Examples</h3>

<pre><code class='language-R'>K0_CO2(35, 15)
plot(K0_CO2(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='K0_O2'>K0\_O2</h2><span id='topic+K0_O2'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the Henry's constant (solubility) for O2</p>


<h3>Usage</h3>

<pre><code class='language-R'>K0_O2(S, t)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K0_O2_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="K0_O2_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the Henry's constant for CO2 in mol/(kg-solution*atm)
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>derived from a formulation for [O2]sat given in Weiss1970</p>


<h3>Examples</h3>

<pre><code class='language-R'>K0_O2(35, 15)
plot(K0_O2(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='Ksp_aragonite'>Ksp\_aragonite</h2><span id='topic+Ksp_aragonite'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the solubility product for aragonite</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ksp_aragonite(S, t, p=0)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ksp_aragonite_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="Ksp_aragonite_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="Ksp_aragonite_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the solubility product for aragonite in (mol/kg-solution)2
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Mucci1983, Boudreau1996</p>


<h3>Examples</h3>

<pre><code class='language-R'>Ksp_aragonite(35, 15)
Ksp_aragonite(35, 15, 10)
plot(Ksp_aragonite(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='Ksp_calcite'>Ksp\_calcite</h2><span id='topic+Ksp_calcite'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the solubility product for aragonite</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ksp_calcite(S, t, p=0)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ksp_calcite_+3A_s">S</code></td>
<td>
<p>salinity in practical salinity units (i.e. no unit)</p>
</td></tr>
<tr><td><code id="Ksp_calcite_+3A_t">t</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="Ksp_calcite_+3A_p">p</code></td>
<td>
<p>gauge pressure (total pressure minus atmospheric pressure) in bars</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the solubility product for calcite in (mol/kg-solution)2
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Mucci1983, Boudreau1996</p>


<h3>Examples</h3>

<pre><code class='language-R'>Ksp_calcite(35, 15)
Ksp_calcite(35, 15, 10)
plot(Ksp_aragonite(35, 1:25), xlab="temperature / degC")
</code></pre>

<hr>
<h2 id='length.aquaenv'>length.aquaenv</h2><span id='topic+length.aquaenv'></span>

<h3>Description</h3>

<p>PRIVATE function: returns the (maximal) length of the elements in an object of class aquaenv (i.e. &gt; 1 if one of the input variables was a vector)</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aquaenv'
length(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="length.aquaenv_+3A_x">x</code></td>
<td>
<p>object of class aquaenv</p>
</td></tr>
<tr><td><code id="length.aquaenv_+3A_...">...</code></td>
<td>
<p>further arguments will be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the maximal length of the elements in the object of class aquaenv
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='MeanMolecularMass'>MeanMolecularMass</h2><span id='topic+MeanMolecularMass'></span>

<h3>Description</h3>

<p>PUBLIC data frame: a collection of mean molecular masses of key chemical species in seawater in g/mol (DOE1994))</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='merge.aquaenv'>merge.aquaenv</h2><span id='topic+merge.aquaenv'></span>

<h3>Description</h3>

<p>PRIVATE function: merges the elements of two objects of class aquaenv: element names are taken from the first argument, the elements of which are also first in the merged object</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aquaenv'
merge(x, y, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge.aquaenv_+3A_x">x</code></td>
<td>
<p>object of class aquaenv: this is where the element names are taken from</p>
</td></tr>
<tr><td><code id="merge.aquaenv_+3A_y">y</code></td>
<td>
<p>object of class aquaenv: must contain at leas all the element (names) as aquaenv1, extra elements are ignored</p>
</td></tr>
<tr><td><code id="merge.aquaenv_+3A_...">...</code></td>
<td>
<p>further arguments will be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class aquaenv with merged elements
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='PhysChemConst'>PhysChemConst</h2><span id='topic+PhysChemConst'></span>

<h3>Description</h3>

<p>PUBLIC list: a collection of physical and chemical constants</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>R</code></td>
<td>
<p>(bar*cm3)/(mol*K) the gas constant (corrected after
Lewis1998, in Millero1995: R = 83.131); digits extended after
Dickson2007)</p>
</td></tr>
<tr><td><code>F</code></td>
<td>
<p>C/mol the Faraday constant (charge per mol of electrons) (N\_A*e-): Dickson2007</p>
</td></tr>
<tr><td><code>uMolToMol</code></td>
<td>
<p>conversion factor from umol to mol</p>
</td></tr>
<tr><td><code>absZero</code></td>
<td>
<p>absolute zero in degrees centigrade</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>relative dielectric constanf of seawater (Zeebe2001)</p>
</td></tr>
<tr><td><code>K_HNO2</code></td>
<td>
<p>dissociation constant of HNO2:  mol/l, NBS pH scale, hybrid constant (Riordan2005)</p>
</td></tr>
<tr><td><code>K_HNO3</code></td>
<td>
<p>dissociation constant of HNO3:  assumed on mol/kg-soln and free pH scale, stoichiometric constant (Soetaert pers. comm.)</p>
</td></tr>
<tr><td><code>K_H2SO4</code></td>
<td>
<p>dissociation constant of H2SO4: assumed on mol/kg-soln and free pH scale, stoichiometric constant (Atkins1996)</p>
</td></tr>
<tr><td><code>K_HS</code></td>
<td>
<p>dissociation constant of HHS:   assumed on mol/kg-soln and free pH scale, stoichiometric constant (Atkins1996)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='plot.aquaenv'>plot.aquaenv</h2><span id='topic+plot.aquaenv'></span>

<h3>Description</h3>

<p>PUBLIC function: high level plot function for objects of  class aquaenv</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.aquaenv_+3A_x">x</code></td>
<td>
<p>object of class aquaenv</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_xval">xval</code></td>
<td>
<p>only valid if bjerrum=FALSE: a vector of the (maximal) length of the elements of aquaenv against which they are to be plotted</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_what">what</code></td>
<td>
<p>a list of names of the elements of aquaenv that are to be plotted, if not supplied and bjerrum=FALSE and cumulative=FALSE: all elements are plotted, if not supplied and bjerrum=TRUE then what is set to be c(&quot;CO2&quot;, &quot;HCO3&quot;, &quot;CO3&quot;, &quot;BOH3&quot;, &quot;BOH4&quot;, &quot;OH&quot;, &quot;H3PO4&quot;, &quot;H2PO4&quot;, &quot;HPO4&quot;, &quot;PO4&quot;, &quot;SiOH4&quot;, &quot;SiOOH3&quot;, &quot;SiO2OH2&quot;, &quot;H2S&quot;, &quot;HS&quot;, &quot;S2min&quot;, &quot;NH4&quot;, &quot;NH3&quot;, &quot;H2SO4&quot;, &quot;HSO4&quot;, &quot;SO4&quot;, &quot;HF&quot;, &quot;F&quot;, &quot;HNO3&quot;, &quot;NO3&quot;, &quot;HNO2&quot;, &quot;NO2&quot;), needs to be supplied for cumulative=TRUE</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_bjerrum">bjerrum</code></td>
<td>
<p>flag: TRUE = a bjerrum plot is done (by calling bjerrumplot)</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_cumulative">cumulative</code></td>
<td>
<p>flag: TRUE = a cumulative plot is done (by calling cumulativeplot)</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_newdevice">newdevice</code></td>
<td>
<p>flag: if TRUE, new plot device is opened</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_setpar">setpar</code></td>
<td>
<p>flag: if TRUE parameters are set with the function par</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_xlab">xlab</code></td>
<td>
<p>x axis label</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_log">log</code></td>
<td>
<p>only valif if bjerrum=TRUE: should the plot be on a logarithmic y axis?</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_total">total</code></td>
<td>
<p>only valid if cumulative=TRUE: should the sum of all elements specified in what be plotted as well?</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_device">device</code></td>
<td>
<p>the device to plot on; default: &quot;x11&quot; (can also be &quot;eps&quot; or &quot;pdf&quot;)</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_filename">filename</code></td>
<td>
<p>filename to be used if &quot;eps&quot; or &quot;pdf&quot; is selected for device</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_size">size</code></td>
<td>
<p>the size of the plot device; default: 12 (width) by 10 (height) inches</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_ylim">ylim</code></td>
<td>
<p>standard plot parameter; if not supplied it will be calculated by range() of the elements to plot</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_lwd">lwd</code></td>
<td>
<p>standard plot parameter; width of the lines in the plot</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_mgp">mgp</code></td>
<td>
<p>standard plot parameter; default: axis title on line 1.8, axis labels on line 0.5, axis on line 0</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_mar">mar</code></td>
<td>
<p>standard plot parameter; default: margin of 3 lines bottom and left and 0.5 lines top and right</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_oma">oma</code></td>
<td>
<p>standard plot parameter; default: no outer margin</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_palette">palette</code></td>
<td>
<p>only valid if bjerrum=TRUE or cumulative=TRUE: a vector of colors to use in the plot (either numbers or names given in colors())</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_legendposition">legendposition</code></td>
<td>
<p>only valid if bjerrum=TRUE or cumulative=TRUE: position of the legend</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_legendinset">legendinset</code></td>
<td>
<p>only valid if bjerrum=TRUE or cumulative=TRUE: standard legend parameter inset</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_legendlwd">legendlwd</code></td>
<td>
<p>only valid if bjerrum=TRUE or cumulative=TRUE: standard legend parameter lwd: line width of lines in legend</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_bg">bg</code></td>
<td>
<p>only valid if bjerrum=TRUE or cumulative=TRUE: standard legend parameter: default background color: white</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_y.intersp">y.intersp</code></td>
<td>
<p>standard legend parameter; if cumulative=TRUE then default: 1.2 lines space between the lines in the legend</p>
</td></tr>
<tr><td><code id="plot.aquaenv_+3A_...">...</code></td>
<td>
<p>further arguments are passed on to the plot function</p>
</td></tr>	
</table>


<h3>Details</h3>

<p>Top level generic usage is
</p>
<pre>plot.aquaenv(x, xval, what=NULL, bjerrum=FALSE,
             cumulative=FALSE, newdevice=TRUE, setpar=TRUE,
	     device="x11", ...)</pre>
<p>Generic usages for standard plotting are
</p>
<pre>plot.aquaenv(x, xval, ...)</pre>
<pre>plot.aquaenv(x, xval, what, mfrow=c(1,1), size=c(7,7), ...)</pre>
<p>Generic usage for creating a bjerrum plot is
</p>
<pre>plot.aquaenv(x, what, log=FALSE, palette=NULL,
             device="x11", filename="aquaenv",
             size=c(12,10), ylim=NULL, lwd=2, xlab="free scale pH",
	     mgp=c(1.8, 0.5, 0), mar=c(3,3,0.5,0.5), oma=c(0,0,0,0),
	     legendposition="bottomleft", legendinset=0.05,
	     legendlwd=4, bg="white", newdevice=TRUE, setpar=TRUE,
	     device="x11",...)</pre>
<p>Generic usage for creating a cumulative plot is
</p>
<pre>plot.aquaenv(x, xval, what, total=TRUE, palette=NULL,
             device="x11", filename="aquaenv", size=c(12,10), ylim=NULL,
             lwd=2, mgp=c(1.8, 0.5, 0), mar=c(3,3,0.5,0.5), oma=c(0,0,0,0),
             legendposition="bottomleft", legendinset=0.05, legendlwd=4,
             bg="white", y.intersp=1.2, newdevice=TRUE, setpar=TRUE,
	     device="x11",...)</pre>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### 0
#####
A &lt;- aquaenv(35, 15, SumCO2=0.003, TA=seq(0.001,0.004, 0.0001))
plot(A, xval=A$TA, xlab="[TA]/(mol/kg-soln)")
plot(A, what=c("CO2", "HCO3", "CO3"), bjerrum=TRUE, log=TRUE)
plot(A, xval=A$TA, xlab="[TA]/(mol/kg-soln)", what=c("CO2", "HCO3", "CO3"),
     cumulative=TRUE, ylab="mol/kg-soln", ylim=c(0,0.0031))


### 1
#####

SumCO2 &lt;- 0.0020
pH     &lt;- 8

S      &lt;- 30
t      &lt;- 1:15
p      &lt;- 10
ae &lt;- aquaenv(S, t, p, SumCO2=SumCO2, pH=pH, revelle=TRUE, dsa=TRUE)
plot(ae, xval=t, xlab="T/(deg C)", newdevice=FALSE)



### 2
#####
S &lt;- 35
t &lt;- 15

SumCO2 &lt;- 0.003500
SumNH4 &lt;- 0.000020

mass_sample  &lt;- 0.01 # the mass of the sample solution in kg
mass_titrant &lt;- 0.02 # the total mass of the added titrant solution in
                     # kg
conc_titrant &lt;- 0.01 # the concentration of the titrant solution in
                     # mol/kg-soln
S_titrant    &lt;- 0.5  # the salinity of the titrant solution (the
                     # salinity of a solution with a ionic strength of
                     # 0.01 according to: I = (19.924 S) / (1000 - 1.005S)
steps        &lt;- 50   # the amount of steps the mass of titrant is added
                     # in
type         &lt;- "HCl"

pHstart &lt;- 11.3


ae &lt;- titration(aquaenv(S=S, t=t, SumCO2=SumCO2, SumNH4=SumNH4,
                pH=pHstart), mass_sample, mass_titrant, conc_titrant,
                S_titrant, steps, type)


# plotting everything
plot(ae, xval=ae$delta_mass_titrant, xlab="HCl solution added [kg]",
mfrow=c(10,10))


# plotting selectively
size  &lt;- c(12,8) #inches
mfrow &lt;- c(4,4)
what  &lt;- c("TA", "pH", "CO2", "HCO3", "CO3", "BOH3", "BOH4", "OH",
           "NH4", "NH3", "H2SO4", "HSO4", "SO4", "HF", "F", "pCO2")


plot(ae, xval=ae$delta_mass_titrant, xlab="HCl solution added [kg]",
     what=what, size=size, mfrow=mfrow)

plot(ae, xval=ae$pH, xlab="free scale pH", what=what, size=size,
     mfrow=mfrow)


# different x values
plot(ae, xval=ae$delta_conc_titrant, xlab="[HCl] offset added
     [mol/kg-soln]", what=what, size=size, mfrow=mfrow)

plot(ae, xval=ae$delta_moles_titrant, xlab="HCl added [mol]", what=what,
     size=size, mfrow=mfrow, newdevice=FALSE)


# bjerrum plots
plot(ae, bjerrum=TRUE)

what  &lt;- c("CO2", "HCO3", "CO3")
plot(ae, what=what, bjerrum=TRUE)
plot(ae, what=what, bjerrum=TRUE, lwd=4, palette=c("cyan", "magenta",
     "yellow"), bg="gray", legendinset=0.1, legendposition="topleft")



what  &lt;- c("CO2", "HCO3", "CO3", "BOH3", "BOH4", "OH", "NH4", "NH3",
           "H2SO4", "HSO4", "SO4", "HF", "F")

plot(ae, what=what, bjerrum=TRUE, log=TRUE, newdevice=FALSE)
plot(ae, what=what, bjerrum=TRUE, log=TRUE, ylim=c(-6,-1),
     legendinset=0, lwd=3, palette=c(1,3,4,5,6,colors()[seq(100,250,6)]))


### 3
#####
parameters &lt;- list(             
    t           = 15        , # degrees C
    S           = 35        , # psu       

    SumCO2_t0   = 0.002     , # mol/kg-soln  (comparable to Wang2005)
    TA_t0       = 0.0022    , # mol/kg-soln  (comparable to Millero1998)

    kc          = 0.5       , # 1/d	         proportionality factor
                              #                  for air-water exchange
    kp          = 0.000001  , # mol/(kg-soln*d)	 max rate of calcium
                              #                  carbonate precipitation
    n           = 2.0       , # -                exponent for kinetic
                              #                  rate law of precipitation
 
    modeltime   = 20        , # d              duration of the model
    outputsteps = 100         #                number of outputsteps
                   )

boxmodel &lt;- function(timestep, currentstate, parameters)
{
  with (
        as.list(c(currentstate,parameters)),
        {        
          ae    &lt;- aquaenv(S=S, t=t, SumCO2=SumCO2, pH=-log10(H), SumSiOH4=0, 
                           SumBOH3=0, SumH2SO4=0, SumHF=0, dsa=TRUE)
                   
          Rc    &lt;- kc * ((ae$CO2_sat) - (ae$CO2)) 
          Rp    &lt;- kp * (1-ae$omega_calcite)^n               

          dSumCO2 &lt;- Rc - Rp

          dHRc    &lt;- (      -(ae$dTAdSumCO2*Rc   ))/ae$dTAdH
          dHRp    &lt;- (-2*Rp -(ae$dTAdSumCO2*(-Rp)))/ae$dTAdH
          dH      &lt;- dHRc + dHRp
          
          ratesofchanges &lt;- c(dSumCO2, dH)
          
          processrates   &lt;- c(Rc=Rc, Rp=Rp)
          outputvars     &lt;- c(dHRc=dHRc, dHRp=dHRp)
          
          return(list(ratesofchanges, list(processrates, outputvars, ae)))
        }
        )
}

with (as.list(parameters),
      {
        aetmp &lt;- aquaenv(S=S, t=t, SumCO2=SumCO2_t0,
                         TA=TA_t0, SumSiOH4=0, SumBOH3=0,
                         SumH2SO4=0, SumHF=0)
        H_t0  &lt;- 10^(-aetmp$pH)
        
        initialstate &lt;&lt;- c(SumCO2=SumCO2_t0, H=H_t0)
        times        &lt;&lt;- seq(0,modeltime,(modeltime/outputsteps))       
        output       &lt;&lt;- as.data.frame(vode(initialstate,times,
                                    boxmodel,parameters, hmax=1))
      })

what   &lt;- c("SumCO2", "TA", "Rc", "Rp",
            "omega_calcite", "pH", "dHRc", "dHRp")
plot(aquaenv(ae=output, from.data.frame=TRUE), xval=output$time,
     xlab="time/d", mfrow=c(3,3), size=c(15,10), what=what) 

what &lt;- c("dHRc", "dHRp")
plot(aquaenv(ae=output, from.data.frame=TRUE), xval=output$time,
     xlab="time/d", what=what, ylab="mol-H/(kg-soln*d)",
     legendposition="topright", cumulative=TRUE) 

## End(Not run)</code></pre>

<hr>
<h2 id='sample_dickson1981'>sample\_dickson1981</h2><span id='topic+sample_dickson1981'></span>

<h3>Description</h3>

<p>PUBLIC dataset: theoretical titration curve for TA
determination as given in table 1 of Dickson1981 <br />
<br />
Meta-data: <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
  <em>x-value</em> </td><td style="text-align: left;"> mass of titrant added (in g) </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>y-value</em> </td><td style="text-align: left;"> pH measured on the free proton scale </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>


<table>
<tr>
 <td style="text-align: left;">
  <em>t</em> </td><td style="text-align: left;"> 25 </td><td style="text-align: left;"> degC </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>S</em> </td><td style="text-align: left;"> 35 </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>mass\_sample</em> </td><td style="text-align: left;"> 200 </td><td style="text-align: left;"> g </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>conc\_titrant</em> </td><td style="text-align: left;"> 0.3000 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>TA</em> </td><td style="text-align: left;"> 0.00245 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>SumCO2</em> </td><td style="text-align: left;"> 0.00220 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>SumBOH3</em> </td><td style="text-align: left;"> 0.00042 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>SumH2SO4</em> </td><td style="text-align: left;"> 0.02824 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>SumHF</em> </td><td style="text-align: left;"> 0.00007 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>K\_W</em> </td><td style="text-align: left;"> 4.32e-14 </td><td style="text-align: left;"> (mol/kg-soln)*(mol/kg-soln) </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>K\_CO2</em> </td><td style="text-align: left;"> 1.00e-6 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>K\_HCO3</em> </td><td style="text-align: left;"> 8.20e-10 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>K\_BOH3</em> </td><td style="text-align: left;"> 1.78e-9 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>K\_HSO4</em> </td><td style="text-align: left;"> 1/1.23e1 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>K\_HF</em> </td><td style="text-align: left;"> 1/4.08e2 </td><td style="text-align: left;"> mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
             </td>
</tr>

</table>
 


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='sample_dickson2007'>sample\_dickson2007</h2><span id='topic+sample_dickson2007'></span>

<h3>Description</h3>

<p>PUBLIC dataset: titration curve for TA determination as
given on p. 11 of SOP3b in  Dickson2007 <br />
<br />
Metadata:<br />
</p>

<table>
<tr>
 <td style="text-align: left;">
  <em>x-value</em> </td><td style="text-align: left;"> mass of titrant added (in cubic centimeters) </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>y-value</em> </td><td style="text-align: left;"> E in V </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>


<table>
<tr>
 <td style="text-align: left;">
  <em>t</em> </td><td style="text-align: left;"> 24.25  </td><td style="text-align: left;"> degC </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>S</em> </td><td style="text-align: left;"> 33.923 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>mass\_sample</em> </td><td style="text-align: left;"> 140.32 </td><td style="text-align: left;">  g </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>conc\_titrant</em> </td><td style="text-align: left;"> 0.10046 </td><td style="text-align: left;">  mol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>density titrant</em> </td><td style="text-align: left;"> 1.02393  </td><td style="text-align: left;"> g/cm3 </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>calculated TA</em> </td><td style="text-align: left;"> 2260.06 </td><td style="text-align: left;">  umol/kg-soln </td>
</tr>
<tr>
 <td style="text-align: left;">
  <em>calculated E0</em> </td><td style="text-align: left;"> 0.394401 </td><td style="text-align: left;"> V </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='TAfit'>TAfit</h2><span id='topic+TAfit'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates [TA] and [SumCO2] (and optionally K\_C02 and E0) from a titration curve using an optimization procedure (nls.lm from R package minpack.lm)</p>


<h3>Usage</h3>

<pre><code class='language-R'>TAfit(ae, titcurve, conc_titrant, mass_sample, S_titrant=NULL,
      TASumCO2guess=0.0025, E0guess=0.4, type="HCl", Evals=FALSE,
      electrode_polarity="pos", K_CO2fit=FALSE,
      equalspaced=TRUE, seawater_titrant=FALSE,
      pHscale="free", debug=FALSE, k_w=NULL, k_co2=NULL, k_hco3=NULL,
      k_boh3=NULL, k_hso4=NULL, k_hf=NULL,
      nlscontrol=nls.lm.control(), verbose=FALSE,
      k1k2="roy", khf="dickson", datxbegin=0, SumCO2Zero=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TAfit_+3A_ae">ae</code></td>
<td>
<p>an object of type aquaenv: minimal definition, contains all information about the system: T, S, d, total concentrations of nutrients etc (Note that it is possible to give values for SumBOH4, SumHSO4, and SumHF in the sample other than the ones calculated from salinity)</p>
</td></tr>
<tr><td><code id="TAfit_+3A_titcurve">titcurve</code></td>
<td>
<p>a table containing the titration curve: basically a series of tuples of added titrant solution mass and pH values (pH on free proton scale) or E values in V</p>
</td></tr>
<tr><td><code id="TAfit_+3A_conc_titrant">conc_titrant</code></td>
<td>
<p>concentration of the titrant solution in mol/kg-soln</p>
</td></tr>
<tr><td><code id="TAfit_+3A_mass_sample">mass_sample</code></td>
<td>
<p>the mass of the sample solution in kg</p>
</td></tr>
<tr><td><code id="TAfit_+3A_s_titrant">S_titrant</code></td>
<td>
<p>the salinity of the titrant solution, if not supplied it is assumed that the titrant solution has the same salinity as the sample solution</p>
</td></tr>
<tr><td><code id="TAfit_+3A_tasumco2guess">TASumCO2guess</code></td>
<td>
<p>a first guess for [TA] and [SumCO2] to be used as initial values for the optimization procedure</p>
</td></tr>
<tr><td><code id="TAfit_+3A_e0guess">E0guess</code></td>
<td>
<p>first guess for E0 in V</p>
</td></tr>
<tr><td><code id="TAfit_+3A_type">type</code></td>
<td>
<p>the type of titrant: either &quot;HCl&quot; or &quot;NaOH&quot;</p>
</td></tr>
<tr><td><code id="TAfit_+3A_evals">Evals</code></td>
<td>
<p>are the supplied datapoints pH or E (V) values?</p>
</td></tr>
<tr><td><code id="TAfit_+3A_electrode_polarity">electrode_polarity</code></td>
<td>
<p>either &quot;pos&quot; or &quot;neg&quot;: how is the polarity of the Electrode: E = E0 -(RT/F)ln(H+) (&quot;pos&quot;) or -E = E0 -(RT/F)ln(H+) (&quot;neg&quot;)?</p>
</td></tr>
<tr><td><code id="TAfit_+3A_k_co2fit">K_CO2fit</code></td>
<td>
<p>should K\_CO2 be fitted as well?</p>
</td></tr>
<tr><td><code id="TAfit_+3A_equalspaced">equalspaced</code></td>
<td>
<p>are the mass values of titcurve equally spaced?</p>
</td></tr>
<tr><td><code id="TAfit_+3A_seawater_titrant">seawater_titrant</code></td>
<td>
<p>is the titrant based on  natural seawater? (does it contain SumBOH4, SumHSO4, and SumHF in the same proportions as seawater, i.e., correlated to S?); Note that you can only assume a seawater based titrant (i.e. SumBOH4, SumHSO4, and SumHF ~ S) or a water based titrant (i.e. SumBOH4, SumHSO4, and SumHF = 0). It is not possible to give values for SumBOH4, SumHSO4, and SumHF of the titrant.</p>
</td></tr>
<tr><td><code id="TAfit_+3A_phscale">pHscale</code></td>
<td>
<p>either &quot;free&quot;, &quot;total&quot;, &quot;sws&quot; or &quot;nbs&quot;: if the titration curve contains pH data: on which scale is it measured?</p>
</td></tr>
<tr><td><code id="TAfit_+3A_debug">debug</code></td>
<td>
<p>debug mode: the last simulated titration tit, the
converted pH profile calc, and the nls.lm output out are made global
variables for investigation and plotting</p>
</td></tr>
<tr><td><code id="TAfit_+3A_k_w">k_w</code></td>
<td>
<p>a fixed K\_W can be specified</p>
</td></tr>
<tr><td><code id="TAfit_+3A_k_co2">k_co2</code></td>
<td>
<p>a fixed K\_CO2 can be specified; used for TA fitting: give a K\_CO2 and NOT calculate it from T and S: i.e. K\_CO2 can be fitted in the routine as well</p>
</td></tr>
<tr><td><code id="TAfit_+3A_k_hco3">k_hco3</code></td>
<td>
<p>a fixed K\_HCO3 can be specified</p>
</td></tr>
<tr><td><code id="TAfit_+3A_k_boh3">k_boh3</code></td>
<td>
<p>a fixed K\_BOH3 can be specified</p>
</td></tr>
<tr><td><code id="TAfit_+3A_k_hso4">k_hso4</code></td>
<td>
<p>a fixed K\_HSO4 can be specified</p>
</td></tr>
<tr><td><code id="TAfit_+3A_k_hf">k_hf</code></td>
<td>
<p>a fixed K\_HF can be specified</p>
</td></tr>
<tr><td><code id="TAfit_+3A_nlscontrol">nlscontrol</code></td>
<td>
<p>nls.lm.control() can be specified</p>
</td></tr>
<tr><td><code id="TAfit_+3A_verbose">verbose</code></td>
<td>
<p>verbose mode: show the traject of the fitting in a
plot</p>
</td></tr>
<tr><td><code id="TAfit_+3A_k1k2">k1k2</code></td>
<td>
<p>either &quot;roy&quot; (default, Roy1993a) or &quot;lueker&quot; (Lueker2000) for K\_CO2 and K\_HCO3.</p>
</td></tr>
<tr><td><code id="TAfit_+3A_khf">khf</code></td>
<td>
<p>either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot;
(Perez1987a) for K\_HF</p>
</td></tr>
<tr><td><code id="TAfit_+3A_datxbegin">datxbegin</code></td>
<td>
<p>at what x value (amount of titrant added) does the
supplied curve start? (i.e. is the complete curve supplied or just a
part?)</p>
</td></tr>
<tr><td><code id="TAfit_+3A_sumco2zero">SumCO2Zero</code></td>
<td>
<p>should SumCO2==0?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of up to five values ([TA] in mol/kg-solution, [SumCO2] in mol/kg-solution, E0 in V, K1 in mol/kg-solution and on free scale, sum of the squared residuals)
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

####################################
# Calculating TA from titration data
####################################

#### 1.) proof of concept ##########
####################################
####################################

# generate "data":
S &lt;- 35
t &lt;- 15

SumCO2     &lt;- 0.002000
TA         &lt;- 0.002200
initial_ae &lt;- aquaenv(S=S, t=t, SumCO2=SumCO2, TA=TA)

mass_sample  &lt;- 0.01  # the mass of the sample solution in kg
mass_titrant &lt;- 0.003 # the total mass of the added titrant solution
                      # in kg
conc_titrant &lt;- 0.01  # the concentration of the titrant solution in
                      # mol/kg-soln
S_titrant    &lt;- 0.5   # the salinity of the titrant solution (the
                      # salinity of a solution with a ionic strength
                      # of 0.01 according to:
                      # I = (19.924 S) / (1000 - 1.005 S)
steps        &lt;- 20    # the amount of steps the mass of titrant is
                      # added in 
type         &lt;- "HCl"

ae &lt;- titration(initial_ae, mass_sample, mass_titrant, conc_titrant,
                S_titrant, steps, type)

plot(ae, ae$delta_mass_titrant, what="pH", newdevice=FALSE)

# the input data for the TA fitting routine: a table with the added
# mass of the titrant and the resulting free scale pH
titcurve &lt;- cbind(ae$delta_mass_titrant, ae$pH)


# for the TA fitting procedure all total quantities except SumCO2
# (SumNH4, SumH2S, SumH3PO4, SumSiOH4, SumHNO3, SumHNO2, SumBOH3,
# SumH2SO4, SumHF) need to be known. However, the latter three
# can be calculated from salinity as it is done in this example.

fit1 &lt;- TAfit(initial_ae, titcurve, conc_titrant, mass_sample,
              S_titrant)
fit1

# E (V) values as input variables: generate E values using
# E0=0.4 V and the nernst equation
tottitcurve &lt;- convert(titcurve[,2], "pHscale", "free2sws", S=S,
                       t=t)
# (Nernst equation relates E to TOTAL [H+] (DOE1994, p.7,
# ch.4, sop.3), BUT, if fluoride is present, its SWS, so
# we use SWS!
Etitcurve   &lt;- cbind(titcurve[,1], (0.4 - ((PhysChemConst$R/10)
               *initial_ae$T/PhysChemConst$F)
               *log(10^-tottitcurve)))  # Nernst equation

fit2 &lt;- TAfit(initial_ae, Etitcurve, conc_titrant, mass_sample,
              S_titrant, Evals=TRUE, verbose=TRUE)
fit2
          

# k_co2 fitting: one K_CO2 (k_co2) for the whole titration curve
# is fitted, i.e. there is NO correction for K_CO2 changes due to
# changing S due to mixing with the titrant
fit3 &lt;- TAfit(initial_ae, titcurve, conc_titrant, mass_sample,
              S_titrant, K_CO2fit=TRUE)
fit3

# assume the titrant has the same salinity as the sample
# (and is made up of natural seawater, i.e. containing SumBOH4,
# SumH2SO4 and SumHF as functions of S), then the "right" K_CO2
# should be fitted i.e we do NOT give the argument S_titrant
# and set the flag seawater_titrant to TRUE
ae       &lt;- titration(initial_ae, mass_sample, mass_titrant,
                      conc_titrant, steps=steps, type=type,
                      seawater_titrant=TRUE)
titcurve &lt;- cbind(ae$delta_mass_titrant, ae$pH)

fit4 &lt;- TAfit(initial_ae, titcurve, conc_titrant, mass_sample,
              K_CO2fit=TRUE, seawater_titrant=TRUE)
fit4

# fitting of TA, SumCO2, K_CO2 and E0
Etitcurve &lt;- cbind(titcurve[,1], (0.4 - ((PhysChemConst$R/10)
                   *initial_ae$T/PhysChemConst$F)
                   *log(10^-titcurve[,2])))
fit5 &lt;- TAfit(initial_ae, Etitcurve, conc_titrant, mass_sample,
              K_CO2fit=TRUE, seawater_titrant=TRUE, Evals=TRUE)
fit5

# fitting of non equally spaced data:
neqsptitcurve &lt;- rbind(titcurve[1:9,], titcurve[11:20,])
fit6 &lt;- TAfit(initial_ae, neqsptitcurve, conc_titrant,
               mass_sample, seawater_titrant=TRUE,
               equalspaced=FALSE)
fit6

#add some "noise" on the generated data
noisetitcurve &lt;- titcurve * rnorm(length(titcurve),
                 mean=1, sd=0.01) #one percent error possible
plot(ae, ae$delta_mass_titrant, what="pH", type="l", col="red",
     xlim=c(0,0.003), ylim=c(3,8.1), newdevice=FALSE)
par(new=TRUE)
plot(noisetitcurve[,1],noisetitcurve[,2], type="l",
     xlim=c(0,0.003), ylim=c(3,8.1))

fit7 &lt;- TAfit(initial_ae, noisetitcurve, conc_titrant,
              mass_sample, seawater_titrant=TRUE)
fit7




# 2.) test with generated data from Dickson1981 #
#################################################
#################################################

conc_titrant = 0.3     # mol/kg-soln
mass_sample  = 0.2     # kg
S_titrant    = 14.835  # is aequivalent to the ionic strength
                       # of 0.3 mol/kg-soln 
  
SumBOH3  = 0.00042 # mol/kg-soln
SumH2SO4 = 0.02824 # mol/kg-soln
SumHF    = 0.00007 # mol/kg-soln

# convert mass of titrant from g to kg
sam &lt;- cbind(sample_dickson1981[,1]/1000, sample_dickson1981[,2]) 

dicksonfit &lt;- TAfit(aquaenv(t=25, S=35, SumBOH3=SumBOH3,
                    SumH2SO4=SumH2SO4, SumHF=SumHF), sam,
                    conc_titrant, mass_sample,
                    S_titrant=S_titrant, debug=TRUE)
dicksonfit
#TA     Dickson1981: 0.00245
#SumCO2 Dickson1981: 0.00220

# =&gt; not exactly the same! why?



# a.) does salinity correction (S_titrant) matter or not?
##########################################################

# without salinity correction
dicksontitration1 &lt;- titration(aquaenv(t=25, S=35, SumCO2=0.00220,
                               SumBOH3=SumBOH3, SumH2SO4=SumH2SO4,
                               SumHF=SumHF, TA=0.00245),
                               mass_sample=mass_sample,
                               mass_titrant=0.0025,
                               conc_titrant=conc_titrant,
                               steps=50, type="HCl")

# with salinity correction
dicksontitration2 &lt;- titration(aquaenv(t=25, S=35, SumCO2=0.00220,
                               SumBOH3=SumBOH3, SumH2SO4=SumH2SO4,
                               SumHF=SumHF, TA=0.00245),
                               mass_sample=mass_sample,
                               mass_titrant=0.0025,
                               conc_titrant=conc_titrant,
                               S_titrant=S_titrant,
                               steps=50, type="HCl")          

plot(dicksontitration1, xval=dicksontitration1$delta_mass_titrant,
     what="pH", xlim=c(0,0.0025), ylim=c(3,8.2), newdevice=FALSE,
     col="red") 
par(new=TRUE)
plot(dicksontitration2, xval=dicksontitration2$delta_mass_titrant,
     what="pH", xlim=c(0,0.0025), ylim=c(3,8.2), newdevice=FALSE,
     col="blue") 
par(new=TRUE)
plot(sam[,1], sam[,2], type="l", xlim=c(0,0.0025), ylim=c(3,8.2))

# =&gt; salinity correction makes NO difference, because the relation
# between total sample and added titrant is very large:
# salinity only drops from 35 to 34.75105

#BUT: there is an offset between the "Dickson" curve and our curve:
plot(dicksontitration2$pH - sam[,2])


# b.) does it get better if we fit K_CO2 as well?
#################################################
dicksonfit2 &lt;- TAfit(aquaenv(t=25, S=35, SumBOH3=SumBOH3,
                             SumH2SO4=SumH2SO4, SumHF=SumHF), sam,
                             conc_titrant, mass_sample,
			     S_titrant=S_titrant, debug=TRUE,
			     K_CO2fit=TRUE)
dicksonfit2
#TA     Dickson1981: 0.00245
#SumCO2 Dickson1981: 0.00220

# =&gt; yes it does, but it is not perfect yet!


# c.) differing K values
#########################
# Dickson uses fixed K values that are slightly different than ours
dicksontitration3 &lt;- titration(aquaenv(t=25, S=35, SumCO2=0.00220,
                               SumBOH3=SumBOH3, SumH2SO4=SumH2SO4,
                               SumHF=SumHF, TA=0.00245, k_w=4.32e-14,
			       k_co2=1e-6, k_hco3=8.20e-10,
			       k_boh3=1.78e-9, k_hso4=(1/1.23e1),
			       k_hf=(1/4.08e2)),
			       mass_sample=mass_sample,
			       mass_titrant=0.0025,
			       conc_titrant=conc_titrant,
			       steps=50, type="HCl",
			       S_titrant=S_titrant, k_w=4.32e-14,
			       k_co2=1e-6, k_hco3=8.20e-10,
			       k_boh3=1.78e-9, k_hso4=(1/1.23e1),
			       k_hf=(1/4.08e2))          
plot(dicksontitration3, xval=dicksontitration3$delta_mass_titrant,
     what="pH", xlim=c(0,0.0025), ylim=c(3,8.2), newdevice=FALSE,
     col="blue") 
par(new=TRUE)
plot(sam[,1], sam[,2], type="l", xlim=c(0,0.0025), ylim=c(3,8.2))

plot(dicksontitration3$pH - sam[,2])
# =&gt; no offset between the pH curves

# =&gt; exactly the same curves!


dicksonfit3 &lt;- TAfit(aquaenv(t=25, S=35, SumBOH3=SumBOH3,
                     SumH2SO4=SumH2SO4, SumHF=SumHF, k_w=4.32e-14,
                     k_co2=1e-6, k_hco3=8.20e-10, k_boh3=1.78e-9,
		     k_hso4=(1/1.23e1), k_hf=(1/4.08e2)),
                     sam, conc_titrant, mass_sample,
		     S_titrant=S_titrant, debug=TRUE,
                     k_w=4.32e-14, k_co2=1e-6, k_hco3=8.20e-10,
		     k_boh3=1.78e-9, k_hso4=(1/1.23e1),
		     k_hf=(1/4.08e2))
dicksonfit3

# PERFECT fit!

plot(sam[,1], sam[,2], xlim=c(0,0.0025), ylim=c(3,8.2), type="l")
par(new=TRUE)
plot(tit$delta_mass_titrant, calc, xlim=c(0,0.0025), ylim=c(3,8.2),
     type="l", col="red")


## End(Not run)</code></pre>

<hr>
<h2 id='Technicals'>Technicals</h2><span id='topic+Technicals'></span>

<h3>Description</h3>

<p>PUBLIC list: a collection programming-technical constants</p>


<h3>Value</h3>

<p>A list with elements:
</p>
<table>
<tr><td><code>Haccur</code></td>
<td>
<p>accuracy for iterative (Follows2006) pH calculations (max. deviation in [H+])</p>
</td></tr>
<tr><td><code>Hstart</code></td>
<td>
<p>start [H+] for an iterative pH calculation</p>
</td></tr>
<tr><td><code>maxiter</code></td>
<td>
<p>maximum number of iterations for iterative (Follows2006) pH calculation method as well as for the application of the standard R function uniroot</p>
</td></tr>
<tr><td><code>unirootinterval</code></td>
<td>
<p>the interval (in terms of [H+]) for pH calculation using the standard R function uniroot</p>
</td></tr>
<tr><td><code>uniroottol</code></td>
<td>
<p>the interval (in terms of [H+]) for pH calculation using the standard R function uniroot</p>
</td></tr>
<tr><td><code>epsilon_fraction</code></td>
<td>
<p>fraction of disturbance for the numerical calculation of derivatives of TA with respect to changes in the dissociation constants</p>
</td></tr>
<tr><td><code>revelle_fraction</code></td>
<td>
<p>fraction of disturbance for the numerical calculation of the revelle factor</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>fugacity of CO2 in atm</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>

<hr>
<h2 id='titration'>titration</h2><span id='topic+titration'></span>

<h3>Description</h3>

<p>PUBLIC function: creates an object of class aquaenv which contains a titration simulation</p>


<h3>Usage</h3>

<pre><code class='language-R'>titration(aquaenv, mass_sample, mass_titrant, conc_titrant,
          S_titrant=NULL, steps, type="HCl", seawater_titrant=FALSE,
          k_w=NULL, k_co2=NULL, k_hco3=NULL, k_boh3=NULL, k_hso4=NULL,
          k_hf=NULL, k1k2="lueker", khf="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="titration_+3A_aquaenv">aquaenv</code></td>
<td>
<p>an object of type aquaenv: minimal definition, contains all information about the system: T, S, d, total concentrations of nutrients etc (Note that it is possible to give values for SumBOH4, SumHSO4, and SumHF in the sample other than the ones calculated from salinity)</p>
</td></tr>
<tr><td><code id="titration_+3A_mass_sample">mass_sample</code></td>
<td>
<p>the mass of the sample solution in kg</p>
</td></tr>
<tr><td><code id="titration_+3A_mass_titrant">mass_titrant</code></td>
<td>
<p>the total mass of the added titrant solution in kg</p>
</td></tr>
<tr><td><code id="titration_+3A_conc_titrant">conc_titrant</code></td>
<td>
<p>the concentration of the titrant solution in mol/kg-soln</p>
</td></tr>
<tr><td><code id="titration_+3A_s_titrant">S_titrant</code></td>
<td>
<p>the salinity of the titrant solution, if not supplied it is assumed that the titrant solution has the same salinity as the sample solution</p>
</td></tr>
<tr><td><code id="titration_+3A_steps">steps</code></td>
<td>
<p>the amount of steps the mass of titrant is added in</p>
</td></tr> 
<tr><td><code id="titration_+3A_type">type</code></td>
<td>
<p>the type of titrant: either &quot;HCl&quot; or &quot;NaOH&quot;, default: &quot;HCl&quot;</p>
</td></tr>
<tr><td><code id="titration_+3A_seawater_titrant">seawater_titrant</code></td>
<td>
<p>is the titrant based on natural seawater?
(does it contain SumBOH4, SumHSO4, and SumHF in the same proportions
as seawater, i.e., correlated to S?); Note that you can only assume
a seawater based titrant (i.e. SumBOH4, SumHSO4, and SumHF ~ S) or a
water based titrant (i.e. SumBOH4, SumHSO4, and SumHF = 0). It is
not possible to give values for SumBOH4, SumHSO4, and SumHF of the
titrant.</p>
</td></tr>
<tr><td><code id="titration_+3A_k_w">k_w</code></td>
<td>
<p>a fixed K\_W can be specified</p>
</td></tr>
<tr><td><code id="titration_+3A_k_co2">k_co2</code></td>
<td>
<p>a fixed K\_CO2 can be specified; used for TA fitting: give a K\_CO2 and NOT calculate it from T and S: i.e. K\_CO2 can be fitted in the routine as well</p>
</td></tr>
<tr><td><code id="titration_+3A_k_hco3">k_hco3</code></td>
<td>
<p>a fixed K\_HCO3 can be specified</p>
</td></tr>
<tr><td><code id="titration_+3A_k_boh3">k_boh3</code></td>
<td>
<p>a fixed K\_BOH3 can be specified</p>
</td></tr>
<tr><td><code id="titration_+3A_k_hso4">k_hso4</code></td>
<td>
<p>a fixed K\_HSO4 can be specified</p>
</td></tr>
<tr><td><code id="titration_+3A_k_hf">k_hf</code></td>
<td>
<p>a fixed K\_HF can be specified</p>
</td></tr>
<tr><td><code id="titration_+3A_k1k2">k1k2</code></td>
<td>
<p>either &quot;lueker&quot; (default, Lueker2000) or &quot;roy&quot; (Roy1993a) for K\_CO2 and K\_HCO3.</p>
</td></tr>
<tr><td><code id="titration_+3A_khf">khf</code></td>
<td>
<p>either &quot;dickson&quot; (default, Dickson1979a) or &quot;perez&quot; (Perez1987a) for K\_HF</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class aquaenv which contains a titration simulation
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
####################
# Titration with HCl
####################
S &lt;- 35
t &lt;- 15

SumCO2 &lt;- 0.003500
SumNH4 &lt;- 0.000020

mass_sample  &lt;- 0.01 # the mass of the sample solution in kg
mass_titrant &lt;- 0.02 # the total mass of the added titrant solution in
                     # kg
conc_titrant &lt;- 0.01 # the concentration of the titrant solution in
                     # mol/kg-soln
S_titrant    &lt;- 0.5  # the salinity of the titrant solution (the
                     # salinity of a solution with a ionic strength of
                     # 0.01 according to: I = (19.924 S) / (1000 - 1.005S)
steps        &lt;- 50   # the amount of steps the mass of titrant is added
                     # in
type         &lt;- "HCl"

pHstart &lt;- 11.3


ae &lt;- titration(aquaenv(S=S, t=t, SumCO2=SumCO2, SumNH4=SumNH4,
                pH=pHstart), mass_sample, mass_titrant, conc_titrant,
                S_titrant, steps, type)


# plotting everything
plot(ae, xval=ae$delta_mass_titrant, xlab="HCl solution added [kg]",
mfrow=c(10,10))


# plotting selectively
size  &lt;- c(12,8) #inches
mfrow &lt;- c(4,4)
what  &lt;- c("TA", "pH", "CO2", "HCO3", "CO3", "BOH3", "BOH4", "OH",
           "NH4", "NH3", "H2SO4", "HSO4", "SO4", "HF", "F", "pCO2")


plot(ae, xval=ae$delta_mass_titrant, xlab="HCl solution added [kg]",
     what=what, size=size, mfrow=mfrow)

plot(ae, xval=ae$pH, xlab="free scale pH", what=what, size=size,
     mfrow=mfrow)


# different x values
plot(ae, xval=ae$delta_conc_titrant, xlab="[HCl] offset added
     [mol/kg-soln]", what=what, size=size, mfrow=mfrow)

plot(ae, xval=ae$delta_moles_titrant, xlab="HCl added [mol]", what=what,
     size=size, mfrow=mfrow)


# bjerrum plots
par(mfrow=c(1,1))
plot(ae, bjerrum=TRUE)

what  &lt;- c("CO2", "HCO3", "CO3")
plot(ae, what=what, bjerrum=TRUE)
plot(ae, what=what, bjerrum=TRUE, lwd=4, palette=c("cyan", "magenta",
     "yellow"), bg="gray", legendinset=0.1, legendposition="topleft")



what  &lt;- c("CO2", "HCO3", "CO3", "BOH3", "BOH4", "OH", "NH4", "NH3",
           "H2SO4", "HSO4", "SO4", "HF", "F")

plot(ae, what=what, bjerrum=TRUE, log=TRUE)
plot(ae, what=what, bjerrum=TRUE, log=TRUE, ylim=c(-6,-1),
     legendinset=0, lwd=3, palette=c(1,3,4,5,6,colors()[seq(100,250,6)]))

## End(Not run)</code></pre>

<hr>
<h2 id='watdepth'>watdepth</h2><span id='topic+watdepth'></span>

<h3>Description</h3>

<p>PUBLIC function: calculates the depth (in m) from the gauge
pressure p (or the total pressure P) and the latitude (in degrees: -90
to 90) and the atmospheric pressure Pa (in bar)</p>


<h3>Usage</h3>

<pre><code class='language-R'>watdepth(P=Pa, p=pmax(0, P-Pa), lat=0, Pa=1.013253)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="watdepth_+3A_p">P</code></td>
<td>
<p>total pressure in bar, standard: 1 atm (at the sea surface)</p>
</td></tr>
<tr><td><code id="watdepth_+3A_p">p</code></td>
<td>
<p>gauge pressure in bar (total pressure minus atmospheric pressure), standard: 0 (at the water surface)</p>
</td></tr>
<tr><td><code id="watdepth_+3A_lat">lat</code></td>
<td>
<p>latitude in degrees: -90 to 90, standard: 0</p>
</td></tr>
<tr><td><code id="watdepth_+3A_pa">Pa</code></td>
<td>
<p>atmospheric pressure in bar, standard: 1 atm (at sea level)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>water depth d in meters</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>References</h3>

<p>Fofonoff1983</p>


<h3>Examples</h3>

<pre><code class='language-R'>watdepth(100)
plot(watdepth(1:100))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
