<!DOCTYPE html><html><head><title>Help for package jocre</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {jocre}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#jocre-package'>
<p>Joint confidence regions</p></a></li>
<li><a href='#cset'><p>Confidence regions and intervals around multivariate normal means</p></a></li>
<li><a href='#csetMV'><p>Confidence regions and intervals for a normal mean and variance</p></a></li>
<li><a href='#helpers'><p>Different generic functions for classes <code>JOC</code> and <code>JOCMV</code></p></a></li>
<li><a href='#iutsize'><p>Size of intersection union tests derived from confidence sets</p></a></li>
<li><a href='#marzo'>
<p>Bioequivalence study of ticlopidine hydrochloride</p></a></li>
<li><a href='#translate'><p>Conversion of confidence levels between intervals and ellipses</p></a></li>
<li><a href='#wires'>
<p>Quality control study of wire connections</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Joint Confidence Regions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-05-12</td>
</tr>
<tr>
<td>Description:</td>
<td>Computing and plotting joint confidence regions and intervals. Regions include classical ellipsoids, minimum-volume or minimum-length regions, and an empirical Bayes region. Intervals include the TOST procedure with ordinary or expanded intervals and a fixed-sequence procedure. Such regions and intervals are useful e.g., for the assessment of multi-parameter (bio-)equivalence. Joint confidence regions for the mean and variance of a normal distribution are available as well.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>boot, KernSmooth, plyr, TSP</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/PhilipPallmann/jocre/issues">https://github.com/PhilipPallmann/jocre/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-05-12 15:04:07 UTC; pallmann</td>
</tr>
<tr>
<td>Author:</td>
<td>Philip Pallmann [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philip Pallmann &lt;p.pallmann@lancaster.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-05-12 22:51:36 UTC</td>
</tr>
</table>
<hr>
<h2 id='jocre-package'>
Joint confidence regions
</h2><span id='topic+jocre-package'></span><span id='topic+jocre'></span>

<h3>Description</h3>

<p>This package provides functions for computing and plotting joint confidence regions as well as (simultaneous) confidence intervals, with a focus on multivariate normal parameter vectors and parameters of the normal distribution i.e., mean and variance.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> jocre</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.3.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-05-12</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><code>cset</code> computes joint confidence regions and (simultaneous) confidence intervals around multivariate normal means. The parameter estimates and interval bounds (in the case of confidence regions their boundaries are projected onto the axes) are displayed with <code>print</code> or <code>summary</code>, and <code>plot</code> generates a graph of the estimate and region or intervals and allows for some fine tuning e.g., shading of an equivalence region. 
</p>
<p><code>csetMV</code> computes joint confidence regions for the mean and variance (or standard deviation) of a normal distribution. <code>plot</code>, <code>print</code>, and <code>summary</code> produce the corresponding graphics and summaries.
</p>
<p>Insights into the conservativeness of the two one-sided test procedure can be obtained with <code>iutsize</code>.
</p>
<p>Confidence levels of a joint ellipse and marginal intervals can be &quot;translated&quot; back and forth with <code>translate</code>.
</p>


<h3>Author(s)</h3>

<p>Philip Pallmann (<a href="mailto:p.pallmann@lancaster.ac.uk">p.pallmann@lancaster.ac.uk</a>)
</p>


<h3>References</h3>

<p>Philip Pallmann (2017) Joint confidence regions with the R package jocre. In preparation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("marzo")
plot(cset(dat=marzo, method="limacon"))

data("wires")
plot(csetMV(dat=wires, method="mood"))

## End(Not run)
</code></pre>

<hr>
<h2 id='cset'>Confidence regions and intervals around multivariate normal means</h2><span id='topic+cset'></span>

<h3>Description</h3>

<p>Computes boundaries of (simultaneous) confidence regions and intervals around multivariate normal means using different methods.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cset(dat, method, alpha=0.1, steps=NULL, nboot=1e4, TsengBrownA=1, TsengBrownB=1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cset_+3A_dat">dat</code></td>
<td>
<p>A matrix or data.frame with independent units in rows and multivariate outcomes in columns.</p>
</td></tr>
<tr><td><code id="cset_+3A_method">method</code></td>
<td>
<p>A character string specifying the method to be used. See details for available <code>method</code>s.</p>
</td></tr>
<tr><td><code id="cset_+3A_alpha">alpha</code></td>
<td>
<p>A numeric value giving the type I error level to be controlled. Default is <code>0.1</code>.</p>
</td></tr>
<tr><td><code id="cset_+3A_steps">steps</code></td>
<td>
<p>An integer setting the initial number of steps for the search algorithm. Default is <code>NULL</code>, which chooses 300 for two-dimensional and 50 for higher-dimensional problems.</p>
</td></tr>
<tr><td><code id="cset_+3A_nboot">nboot</code></td>
<td>
<p>A numeric giving the number of bootstrap replications to be used when <code>method="bootkern"</code> (ignored otherwise). Default is <code>1e4</code>.</p>
</td></tr>
<tr><td><code id="cset_+3A_tsengbrowna">TsengBrownA</code></td>
<td>
<p>A numeric giving the parameter A to be used when <code>method="tseng.brown"</code> (ignored otherwise). Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="cset_+3A_tsengbrownb">TsengBrownB</code></td>
<td>
<p>A numeric giving the parameter B to be used when <code>method="tseng.brown"</code> (ignored otherwise). Default is <code>1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Available <code>method</code>s for confidence regions are: <code>boot.kern</code> for the nonparametric bootstrap method using kernel density estimation described in Pallmann &amp; Jaki (2017); <code>emp.bayes</code> for the empirical Bayes region described in Casella &amp; Hwang (1983); <code>hotelling</code> for the Hotelling-type region described in Wang et al (1999); <code>limacon.asy</code> for the limacon-shaped mimimum expected volume region described in Brown et al (1995); <code>limacon.fin</code> for the finite-sample variant of the minimum expected volume region described in Berger &amp; Hsu (1996); <code>standard.cor</code> for the standard region incorporating correlation between parameters described in Chew (1966); <code>standard.ind</code> for the standard region ignoring correlation between parameters; <code>tost</code> for the two one-sided test (TOST) intervals described in Schuirmann (1987); <code>tseng</code> for the mimimum expected interval length region described in Tseng (2002); <code>tseng.brown</code> for the pseudo-empirical Bayes region described in Tseng &amp; Brown (1997).
</p>
<p>Available <code>method</code>s for confidence intervals are: <code>expanded</code> for the two one-sided test (TOST) procedure (Schuirmann 1987) using the expanded intervals described e.g., in Bofinger (1992) and Hsu et al. (1994); <code>fix.seq</code> for the fixed sequence intervals described in Maurer et al (1995) and Hsu &amp; Berger (1999); <code>tost</code> for the two one-sided test (TOST) intervals described in Schuirmann (1987).
</p>
<p>See also an overview and comparison of all methods in Pallmann &amp; Jaki (2017).</p>


<h3>Value</h3>

<p>An object of class <code>JOC</code>.</p>


<h3>Note</h3>

<p>Warning: please use with care! Some of the functionality has not yet been thoroughly tested.</p>


<h3>Author(s)</h3>

<p>Philip Pallmann (<a href="mailto:p.pallmann@lancaster.ac.uk">p.pallmann@lancaster.ac.uk</a>)</p>


<h3>References</h3>

<p>Roger L. Berger &amp; Jason C. Hsu (1996) Bioequivalence trials, intersection-union tests and equivalence confidence sets. Statistical Science, 11(4), 283&ndash;319.
</p>
<p>Eve Bofinger (1992) Expanded confidence intervals, one-sided tests, and equivalence testing. Journal of Biopharmaceutical Statistics, 2(2), 181&ndash;188.
</p>
<p>Lawrence D. Brown, George Casella, J. T. Gene Hwang (1995) Optimal confidence sets, bioequivalence, and the limacon of Pascal. Journal of the American Statistical Association, 90(431), 880&ndash;889.
</p>
<p>George Casella &amp; Jiunn T. Hwang (1983) Empirical Bayes confidence sets for the mean of a multivariate normal distribution. Journal of the American Statistical Association, 78(383), 688&ndash;698.
</p>
<p>Victor Chew (1966) Confidence, prediction, and tolerance regions for the multivariate normal distribution. Journal of the American Statistical Association, 61(315), 605&ndash;617.
</p>
<p>Jason C. Hsu &amp; Roger L. Berger (1999) Stepwise confidence intervals without multiplicity adjustment for dose-response and toxicity studies. Journal of the American Statistical Association, 94(446), 468&ndash;482.
</p>
<p>Jason C. Hsu, J. T. Gene Hwang, Hung-Kung Liu, Stephen J. Ruberg (1994) Confidence intervals associated with tests for bioequivalence. Biometrika, 81(1), 103&ndash;114.
</p>
<p>Willi Maurer, Ludwig A. Hothorn, Walter Lehmacher (1995) Multiple comparisons in drug clinical trials and preclinical assays: a priori ordered hypotheses. In: Joachim Vollmar (editor), Biometrie in der Chemisch-Pharmazeutischen Industrie, vol. 6, pp. 3&ndash;18. Fischer-Verlag, Stuttgart, Germany.
</p>
<p>Philip Pallmann &amp; Thomas Jaki (2017) Simultaneous confidence regions and intervals for multivariate bioequivalence. Submitted to Statistics in Medicine.
</p>
<p>Donald J. Schuirmann (1987) A comparison of the two one-sided tests procedure and the power approach for assessing the equivalence of average bioavailability. Journal of Pharmacokinetics and Biopharmaceutics, 15(6), 657&ndash;680.
</p>
<p>Yu-Ling Tseng (2002) Optimal confidence sets for testing average bioequivalence. Test, 11(1), 127&ndash;141.
</p>
<p>Yu-Ling Tseng &amp; Lawrence D. Brown (1997) Good exact confidence sets for a multivariate normal mean. The Annals of Statistics, 25(5), 2228&ndash;2258.
</p>
<p>Weizhen Wang, J. T. Gene Hwang, Anirban DasGupta (1999) Statistical tests for multivariate bioequivalence. Biometrika, 86(2), 395&ndash;402.
</p>
<p># bootkern not included so far
</p>


<h3>See Also</h3>

<p><code><a href="#topic+csetMV">csetMV</a></code> for (simultaneous) confidence regions for normal mean and variance.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example 1: simultaneous 90% confidence intervals for trivariate data

trivar &lt;- mvtnorm::rmvnorm(n=20, mean=rep(0.05, 3), sigma=toeplitz(c(0.05, 0.04, 0.03)))
colnames(trivar) &lt;- c("AUCinf", "AUCt", "Cmax")

tost &lt;- cset(dat=trivar, method="tost", alpha=0.1)
summary(tost)

# Example 2: simultaneous 90% confidence regions for bivariate data

bivar &lt;- mvtnorm::rmvnorm(n=20, mean=rep(0.05, 2), sigma=toeplitz(c(0.05, 0.04)))
colnames(bivar) &lt;- c("AUC", "Cmax")

hotelling &lt;- cset(dat=bivar, method="hotelling", alpha=0.1)
summary(hotelling)
plot(hotelling, main="90% Hotelling Region")

limacon &lt;- cset(dat=bivar, method="limacon.asy", alpha=0.1)
summary(limacon)
plot(limacon, main="90% Limacon Region")

tseng &lt;- cset(dat=bivar, method="tseng", alpha=0.1)
summary(tseng)
plot(tseng, main="90% Tseng Region")

## End(Not run)
</code></pre>

<hr>
<h2 id='csetMV'>Confidence regions and intervals for a normal mean and variance</h2><span id='topic+csetMV'></span>

<h3>Description</h3>

<p>Computes boundaries of (simultaneous) confidence regions for the mean and variance of a normal distribution using different methods.</p>


<h3>Usage</h3>

<pre><code class='language-R'>csetMV(dat, n, method, alpha=0.1, scale="var", steps=500)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="csetMV_+3A_dat">dat</code></td>
<td>
<p>A vector of numeric values assumed to follow a normal distribution. Not required for <code>method="cheng.iles"</code> or <code>"min.area"</code>.</p>
</td></tr>
<tr><td><code id="csetMV_+3A_n">n</code></td>
<td>
<p>A numeric value giving the sample size. Only required for <code>method="cheng.iles"</code> or <code>"min.area"</code>.</p>
</td></tr>
<tr><td><code id="csetMV_+3A_method">method</code></td>
<td>
<p>A character string specifying the method to be used. See details for available <code>method</code>s.</p>
</td></tr>
<tr><td><code id="csetMV_+3A_alpha">alpha</code></td>
<td>
<p>A numeric value giving the type I error level to be controlled. Default is <code>0.1</code>.</p>
</td></tr>
<tr><td><code id="csetMV_+3A_scale">scale</code></td>
<td>
<p>A character string specifying whether the variance (<code>var</code>) or standard deviation (<code>sd</code>) is to be plotted on the y axis. Not required for <code>method="cheng.iles"</code> or <code>"min.area"</code>.</p>
</td></tr>
<tr><td><code id="csetMV_+3A_steps">steps</code></td>
<td>
<p>An integer setting the initial number of steps for the search algorithm. Default is <code>800</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Available <code>method</code>s are: <code>mood</code> for the classical region described in Mood (1950); <code>large</code> for the large-sample approximation region described in section 4.1 of Arnold &amp; Shavelle (1998); <code>plugin</code> for a plug-in variant of the large-sample approximation region described in section 4.2 of Arnold &amp; Shavelle (1998); <code>pluginF</code> for the plug-in variant of the large-sample approximation region described in section 4.3 of Arnold &amp; Shavelle (1998) using an asymptotic F distribution as in Douglas (1993); <code>lrt</code> for the likelihood ratio test region described in section 4.4 of Arnold &amp; Shavelle (1998); <code>cheng.iles</code> for the region described in Cheng &amp; Iles (1983); <code>min.area</code> for the minimum-area region described in Frey et al. (2009).</p>


<h3>Value</h3>

<p>An object of class <code>JOCMV</code>.</p>


<h3>Note</h3>

<p>Warning: please use with care! Some of the functionality has not yet been thoroughly tested.</p>


<h3>Author(s)</h3>

<p>Philip Pallmann (<a href="mailto:p.pallmann@lancaster.ac.uk">p.pallmann@lancaster.ac.uk</a>)</p>


<h3>References</h3>

<p>Barry C. Arnold &amp; Robert M. Shaville (1998) Joint confidence sets for the mean and variance of a normal distribution. The American Statistician, 52(2), 133&ndash;140.
</p>
<p>R. C. H. Cheng &amp; T. C. Iles (1983) Confidence bands for cumulative distribution functions of continuous random variables. Technometrics, 25(1), 77&ndash;86.
</p>
<p>J. B. Douglas (1993) Confidence regions for parameter pairs. The American Statistician, 47(1), 43&ndash;45.
</p>
<p>Jesse Frey, Osvaldo Marrero, Douglas Norton (2009) Minimum-area confidence sets for a normal distribution. Journal of Statistical Planning and Inference, 139(3), 1023&ndash;1032.
</p>
<p>Alexander M. Mood (1950) Introduction to the Theory of Statistics. McGraw-Hill, New York, NY.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cset">cset</a></code> for (simultaneous) confidence regions and intervals around multivariate normal means.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Simultaneous 90% confidence regions for the mean and variance or sd of univariate normal data

univar &lt;- rnorm(n=50)

moodvar &lt;- csetMV(dat=univar, method="mood", alpha=0.1, scale="var")
summary(moodvar)
plot(moodvar)

moodsd &lt;- csetMV(dat=univar, method="mood", alpha=0.1, scale="sd")
summary(moodsd)
plot(moodsd)

## End(Not run)
</code></pre>

<hr>
<h2 id='helpers'>Different generic functions for classes <code>JOC</code> and <code>JOCMV</code></h2><span id='topic+plot.JOC'></span><span id='topic+print.JOC'></span><span id='topic+summary.JOC'></span><span id='topic+plot.JOCMV'></span><span id='topic+print.JOCMV'></span><span id='topic+summary.JOCMV'></span>

<h3>Description</h3>

<p>Generic functions for summarising and plotting objects of class <code>JOC</code> or <code>JOCMV</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'JOC'
plot(x, equi=log(c(0.8, 1.25)), axnames=NULL, main=NULL, xlim=log(c(0.77, 1.3)),
     ylim=log(c(0.77, 1.3)), col="black", convexify=FALSE, ...)

## S3 method for class 'JOC'
print(x, digits=max(3, getOption("digits") - 4), ...)

## S3 method for class 'JOC'
summary(object, digits=max(3, getOption("digits") - 4), ...)

## S3 method for class 'JOCMV'
plot(x, axnames=NULL, main=NULL, xlim=NULL, ylim=NULL, col="black", ...)

## S3 method for class 'JOCMV'
print(x, digits=max(3, getOption("digits") - 4), ...)

## S3 method for class 'JOCMV'
summary(object, digits=max(3, getOption("digits") - 4), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="helpers_+3A_x">x</code></td>
<td>
<p>An output object of class <code>JOC</code> or <code>JOCMV</code>.</p>
</td></tr>
<tr><td><code id="helpers_+3A_object">object</code></td>
<td>
<p>An output object of class <code>JOC</code> or <code>JOCMV</code>.</p>
</td></tr>
<tr><td><code id="helpers_+3A_digits">digits</code></td>
<td>
<p>A numeric value giving the number of significant digits to be printed.</p>
</td></tr>
<tr><td><code id="helpers_+3A_equi">equi</code></td>
<td>
<p>A numeric vector of length 2 specifying the equivalence region (lower and upper equivalence threshold) to be shaded in grey. When set to <code>NULL</code> no equivalence region is drawn. Default is <code>log(c(0.8, 1.25))</code>.</p>
</td></tr>
<tr><td><code id="helpers_+3A_axnames">axnames</code></td>
<td>
<p>A vector of two character strings giving the x and y axis labels. For <code>plot.JOC</code>, when set to <code>NULL</code> the column names of <code>dat</code> are used as axis labels. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="helpers_+3A_main">main</code></td>
<td>
<p>A character string giving the plot title. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="helpers_+3A_xlim">xlim</code></td>
<td>
<p>A numeric vector of length two specifying the plotting range on the x-axis. Default is <code>log(c(0.77, 1.3))</code> for <code>plot.JOC</code> and <code>NULL</code> for <code>plot.JOCMV</code>.</p>
</td></tr>
<tr><td><code id="helpers_+3A_ylim">ylim</code></td>
<td>
<p>A numeric vector of length two specifying the plotting range on the y-axis. Default is <code>log(c(0.77, 1.3))</code> for <code>plot.JOC</code> and <code>NULL</code> for <code>plot.JOCMV</code>.</p>
</td></tr>
<tr><td><code id="helpers_+3A_col">col</code></td>
<td>
<p>A character string specifying the colour of the plotted region or intervals.</p>
</td></tr>
<tr><td><code id="helpers_+3A_convexify">convexify</code></td>
<td>
<p>A logical specifying whether the convex hull around a non-convex region should be plotted instead of the region itself. Ignored unless <code>method="limacon.fin"</code> or <code>method="limacon.asy"</code> for the <code>JOC</code> object. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="helpers_+3A_...">...</code></td>
<td>
<p>Further plotting arguments to be passed to methods. Type <code>?plot</code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print</code> and <code>summary</code> summarise the estimates and confidence set boundaries of an object of class <code>JOC</code> or <code>JOCMV</code> that was created with <code>cset</code> or <code>csetMV</code>, respectively. <code>plot</code> displays a (simultaneous) confidence region or intervals when applied to an object of class <code>JOC</code> or <code>JOCMV</code>.</p>


<h3>Value</h3>

<p>An on-screen summary or graphical display.</p>


<h3>Note</h3>

<p>Warning: please use with care! Some of the functionality has not yet been thoroughly tested.</p>


<h3>Author(s)</h3>

<p>Philip Pallmann (<a href="mailto:p.pallmann@lancaster.ac.uk">p.pallmann@lancaster.ac.uk</a>)</p>


<h3>References</h3>

<p>Philip Pallmann &amp; Thomas Jaki (2017) Simultaneous confidence regions and intervals for multivariate bioequivalence. Submitted to Statistics in Medicine.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cset">cset</a></code> and <code><a href="#topic+csetMV">csetMV</a></code> for computing (simultaneous) confidence regions and intervals.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example 1: simultaneous 90% confidence region for bivariate data

bivar &lt;- mvtnorm::rmvnorm(n=100, mean=rep(0.05, 2), sigma=diag(2) * 0.05)

hotelling &lt;- cset(dat=bivar, method="hotelling", alpha=0.1)
summary(hotelling)
plot(hotelling, main="90% Hotelling Region")

# Example 2: simultaneous 90% confidence region for the mean and variance of univariate normal data

univar &lt;- rnorm(n=50)

moodvar &lt;- csetMV(dat=univar, method="mood", alpha=0.1, scale="var")
summary(moodvar)
plot(moodvar, main="90% Mood Region")

## End(Not run)
</code></pre>

<hr>
<h2 id='iutsize'>Size of intersection union tests derived from confidence sets</h2><span id='topic+iutsize'></span>

<h3>Description</h3>

<p>Computes the actual size of a intersection union test procedure that corresponds to a (1 &ndash; alpha) confidence set.</p>


<h3>Usage</h3>

<pre><code class='language-R'>iutsize(p, n, alpha=0.1, sim=1e6)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iutsize_+3A_p">p</code></td>
<td>
<p>An integer giving the number of dimensions.</p>
</td></tr>
<tr><td><code id="iutsize_+3A_n">n</code></td>
<td>
<p>An integer giving the sample size.</p>
</td></tr>
<tr><td><code id="iutsize_+3A_alpha">alpha</code></td>
<td>
<p>A numeric value specifying the type I error level to be controlled. Default is 0.1.</p>
</td></tr>
<tr><td><code id="iutsize_+3A_sim">sim</code></td>
<td>
<p>An integer giving the number of simulations to be carried out. Default is 1 million.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A (1 &ndash; alpha) confidence set can be used to derive a two one-sided tests (TOST) procedure (Schuirmann 1987) whereby type I error rate control is ensured at level alpha due to the intersection union principle (Berger 1982). The actual test size, however, is often substantially lower than alpha i.e., the approach is conservative. It is well known for the one-dimensional case that the TOST corresponding to a (1 &ndash; alpha) confidence interval has size (1 &ndash; alpha/2). This function computes the achieved test size with dimension <code>p</code> and <code>n</code> according to the formula on p. 399 of Wang et al (1999).</p>


<h3>Value</h3>

<p>A numeric value giving the actual size of the test.</p>


<h3>Author(s)</h3>

<p>Philip Pallmann (<a href="mailto:p.pallmann@lancaster.ac.uk">p.pallmann@lancaster.ac.uk</a>)</p>


<h3>References</h3>

<p>Roger L. Berger (1982) Multiparameter hypothesis testing and acceptance sampling. Technometrics, 24(4), 295&ndash;300.
</p>
<p>Donald J. Schuirmann (1987) A comparison of the two one-sided tests procedure and the power approach for assessing the equivalence of average bioavailability. Journal of Pharmacokinetics and Biopharmaceutics, 15(6), 657&ndash;680.
</p>
<p>Weizhen Wang, J. T. Gene Hwang, Anirban DasGupta (1999) Statistical tests for multivariate bioequivalence. Biometrika, 86(2), 395&ndash;402.</p>


<h3>Examples</h3>

<pre><code class='language-R'># For p=1 we get the well-known result that the 90% CI corresponds to the TOST at 5%:

#iutsize(p=1, n=20)

# With increasing dimension the test gets conservative:

#iutsize(p=2, n=20)
#iutsize(p=3, n=20)

# For p&gt;1 the conservativeness also depends on sample size:

#iutsize(p=2, n=10)
#iutsize(p=2, n=1000)
</code></pre>

<hr>
<h2 id='marzo'>
Bioequivalence study of ticlopidine hydrochloride
</h2><span id='topic+marzo'></span>

<h3>Description</h3>

<p>Pharmacokinetic data from a study on the bioequivalence of a test and a reference formulation of ticlopidine hydrochloride in 24 healthy male volunteers, using a randomised crossover design (Marzo et al. 2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("marzo")</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 8 variables.
</p>

<dl>
<dt><code>Volunteer</code></dt><dd><p>A numeric vector giving the volunteer ID.</p>
</dd>
<dt><code>Sequence</code></dt><dd><p>A factor with levels <code>RT</code> and <code>TR</code> specifying the sequence a volunteer was randomised to (R=reference, T=test).</p>
</dd>
<dt><code>Cmax_T</code></dt><dd><p>A numeric vector of the maximum concentration (Cmax) with the test product.</p>
</dd>
<dt><code>Cmax_R</code></dt><dd><p>A numeric vector of the maximum concentration (Cmax) with the reference product.</p>
</dd>
<dt><code>AUC_T</code></dt><dd><p>A numeric vector of the area under the concentration-time curve (AUC) from zero to the last observed time point with the test product.</p>
</dd>
<dt><code>AUC_R</code></dt><dd><p>A numeric vector of the area under the concentration-time curve (AUC) from zero to the last observed time point with the reference product.</p>
</dd>
<dt><code>AUCinf_T</code></dt><dd><p>A numeric vector of the area under the concentration-time curve AUC) from zero to infinity with the test product.</p>
</dd>
<dt><code>AUCinf_R</code></dt><dd><p>A numeric vector of the area under the concentration-time curve AUC) from zero to infinity with the reference product.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The pharmacokinetic parameters (Cmax and AUC) were calculated using a non-compartmental approach. The data were taken from Tables I and II of Marzo et al. (2002).
</p>


<h3>Source</h3>

<p>Antonio Marzo, Lorenzo Dal Bo, Antonio Rusca, Pierangelo Zini (2002) Bioequivalence of ticlopidine hydrochloride administered in single dose to healthy volunteers. Pharmacological Research, 46(5), 401&ndash;407.
</p>


<h3>References</h3>

<p>Philip Pallmann &amp; Thomas Jaki (2017) Simultaneous confidence regions and intervals for multivariate bioequivalence. Submitted to Statistics in Medicine.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(marzo)

## An example analysis of Cmax assuming log-normality

# Difference of log(Cmax)
marzo$deltalogCmax &lt;- log(marzo$Cmax_T) - log(marzo$Cmax_R)

# Estimated mean treatment effect with SE 
mean(marzo$deltalogCmax)
sd(marzo$deltalogCmax) / sqrt(nrow(marzo))

# Two one-sided test (TOST) p-values
t.test(x=marzo$deltalogCmax, alternative="less", mu=log(1.25))$p.value
t.test(x=marzo$deltalogCmax, alternative="greater", mu=log(0.80))$p.value

# 90% TOST confidence interval
t.test(x=marzo$deltalogCmax, conf.level=0.9)$conf.int[1:2]
</code></pre>

<hr>
<h2 id='translate'>Conversion of confidence levels between intervals and ellipses</h2><span id='topic+translate'></span>

<h3>Description</h3>

<p>Translates the confidence level of a joint 100(1 &ndash; alpha)% confidence ellipse into that of the corresponding marginal confidence interval when projecting the ellipse's boundary onto the axes. Also does the &quot;inverse operation&quot; i.e., calculates the confidence level of a joint confidence ellipse so that its perpendicular shadows onto the axes are 100(1 &ndash; alpha)% confidence intervals.</p>


<h3>Usage</h3>

<pre><code class='language-R'>translate(level=0.95, ddf, direction)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="translate_+3A_level">level</code></td>
<td>
<p>A numeric value giving the confidence level.</p>
</td></tr>
<tr><td><code id="translate_+3A_ddf">ddf</code></td>
<td>
<p>An integer specifying the denominator degrees of freedom. Setting this to <code>0</code> enforces an asymptotic computation.</p>
</td></tr>
<tr><td><code id="translate_+3A_direction">direction</code></td>
<td>
<p>A character string indicating what is to be computed. Choose either <code>ci2cr</code> or <code>cr2ci</code> (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Setting <code>direction="ci2cr"</code> calculates the confidence level of a confidence interval generating ellipse (CIGE) whose perpendicular shadows onto the axes are 100(1 &ndash; alpha)% confidence intervals with a marginal confidence level (1 &ndash; alpha) as specified in <code>level</code>; see p. 205 of Fox (2008).
</p>
<p>On the other hand, setting <code>direction="cr2ci"</code> computes the marginal confidence level of the intervals obtained by projecting a joint 100(1 &ndash; alpha)% confidence ellipse with (1 &ndash; alpha) as specified in <code>level</code>; see p. 254 of Monette (1990). These marginal intervals can be viewed as including a Scheffe penalty (Scheffe 1953).
</p>
<p>For <code>ddf=0</code> the F-distribution used for calculating the confidence levels is replaced with an asymptotic chi-square distribution.
</p>


<h3>Value</h3>

<p>A numeric value giving the calculated confidence level.</p>


<h3>Author(s)</h3>

<p>Philip Pallmann (<a href="mailto:p.pallmann@lancaster.ac.uk">p.pallmann@lancaster.ac.uk</a>)</p>


<h3>References</h3>

<p>John Fox (2008) Applied Linear Regression and Generalized Linear Models. Second Edition. SAGE, Thousand Oaks, CA.
</p>
<p>Georges Monette (1990). Geometry of multiple regression and interactive 3-D graphics. In: John Fox &amp; J. Scott Long (eds.) Modern Methods of Data Analysis. SAGE, Newbury Park, CA.
</p>
<p>Henry Scheffe (1953) A method for judging all contrasts in the analysis of variance. Biometrika, 40(1&ndash;2), 87&ndash;104.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Get CIGE level
translate(0.95, ddf=1, "ci2cr")
translate(0.95, ddf=9999, "ci2cr")
translate(0.95, ddf=0, "ci2cr")

# Get Scheffe CI level
translate(0.95, ddf=1, "cr2ci")
translate(0.95, ddf=9999, "cr2ci")
translate(0.95, ddf=0, "cr2ci")
</code></pre>

<hr>
<h2 id='wires'>
Quality control study of wire connections
</h2><span id='topic+wires'></span>

<h3>Description</h3>

<p>Data from a study in quality control assessing the breaking strengths of 20 wire connections between a semiconductor wafer and a terminal post (King 1971).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("wires")</code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations on the following 2 variables.
</p>

<dl>
<dt><code>Strength</code></dt><dd><p>A numeric vector giving the strength at which the connection failed.</p>
</dd>
<dt><code>Failure</code></dt><dd><p>A factor with levels <code>b</code> and <code>w</code> specifying whether the bond or wire failed.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data were taken from Table 4.1 of Nelson (1982).
</p>


<h3>Source</h3>

<p>James R. King (1971) Probability Charts for Decision Making. Industrial Press, New York, NY.
</p>


<h3>References</h3>

<p>Wayne B. Nelson (1982) Applied Life Data Analysis. Wiley, Hoboken, NJ.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(wires)

# Simultaneous 90% confidence regions for the mean and variance
plot(csetMV(wires$Strength, method="mood"), main="Mood")
plot(csetMV(wires$Strength, method="lrt"), main="LRT")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
