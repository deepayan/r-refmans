<!DOCTYPE html><html lang="en"><head><title>Help for package SkewHyperbolic</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SkewHyperbolic}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SkewHyperbolic-package'>
<p>The Package 'SkewHyperbolic': Summary Information</p></a></li>
<li><a href='#ais'><p>Australian Institute of Sport data</p></a></li>
<li><a href='#lrdji'><p>Dow Jones Log Return Data</p></a></li>
<li><a href='#lrnokeur'><p>Log Returns of the NOK/EUR Exchange Rate</p></a></li>
<li><a href='#skewhypCalcRange'>
<p>Range of a Skew Hyperbolic Student t-Distribution</p></a></li>
<li><a href='#skewhypCheckPars'><p>Check Parameters of the Skew Hyperbolic Student t-distribution</p></a></li>
<li><a href='#SkewHyperbolic-internal'><p>Internal Skew Hyperbolic Functions</p></a></li>
<li><a href='#SkewHyperbolicDistribution'>
<p>Skewed Hyperbolic Student t-Distribution</p></a></li>
<li><a href='#SkewHyperbolicPlots'>
<p>Skew Hyperbolic Student t-Distribution Quantile-Quantile and</p>
Percent-Percent Plots</a></li>
<li><a href='#skewhypFit'>
<p>Fit the Skew Hyperbolic Student t-Distribution to Data</p></a></li>
<li><a href='#skewhypFitStart'>
<p>Find Starting Values for Fitting a Skew Hyperbolic Student</p>
t-Distribution</a></li>
<li><a href='#skewhypMeanVarMode'>
<p>Moments and Mode of the Skew Hyperbolic Student t-Distribution.</p></a></li>
<li><a href='#skewhypMom'><p>Calculate Moments of the Skew Hyperbolic Student t-Distribution.</p></a></li>
<li><a href='#skewhypParam'><p>Parameter Sets for the Skew Hyperbolic t-Distribution</p></a></li>
<li><a href='#skewhypTailPlotLine'><p>Tail Plot Line</p></a></li>
<li><a href='#summary.skewhypFit'><p>Summarising the Skew Hyperbolic Student t-Distribution Fit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-26</td>
</tr>
<tr>
<td>Title:</td>
<td>The Skew Hyperbolic Student t-Distribution</td>
</tr>
<tr>
<td>Author:</td>
<td>David Scott &lt;d.scott@auckland.ac.nz&gt;, Fiona Grimson</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Scott &lt;d.scott@auckland.ac.nz&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, graphics, stats, DistributionUtils,
GeneralizedHyperbolic</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RUnit</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions are provided for the density function,
	     distribution function, quantiles and random number
	     generation for the skew hyperbolic
	     t-distribution. There are also functions that fit
	     the distribution to data. There are functions for the
	     mean, variance, skewness, kurtosis and mode of a given
	     distribution and to calculate moments of any order about
	     any centre. To assess goodness of fit, there are
	     functions to generate a Q-Q plot, a P-P plot and a tail plot.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-forge.r-project.org/projects/rmetrics/">https://r-forge.r-project.org/projects/rmetrics/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-26 00:10:44 UTC; dsco036</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-26 00:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='SkewHyperbolic-package'>
The Package 'SkewHyperbolic': Summary Information
</h2><span id='topic+SkewHyperbolic-package'></span><span id='topic+SkewHyperbolic'></span><span id='topic+skewhyp'></span>

<h3>Description</h3>

<p>This package provides a collection of functions for working with the
skew hyperbolic Student <em>t</em>-distribution.
</p>
<p>Functions are provided for the density function (<code>dskewhyp</code>),
distribution function (<code>pskewhyp</code>), quantiles (<code>qskewhyp</code>) and
random number generation (<code>rskewhyp</code>). There are functions that fit
the distribution to data (<code>skewhypFit</code>). The mean, variance,
skewness, kurtosis and mode can be found using the functions
<code>skewhypMean</code>, <code>skewhypVar</code>, <code>skewhypSkew</code>,
<code>skewhypKurt</code> and <code>skewhypMode</code> respectively, and there is
also a function to calculate moments of any order <code>skewhypMom</code>. To
assess goodness of fit, there are functions to generate a Q-Q plot
(<code>qqskewhyp</code>) and a P-P plot (<code>ppskewhyp</code>). S3 methods
<code>print</code>, <code>plot</code> and <code>summary</code> are provided for the output
of <code>skwewhypFit</code>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275&ndash;309.
</p>
<p>Paolella, Marc S. (2007)
Intermediate Probability: A Computational Approach,
Chichester: Wiley
</p>
<p>Scott, D. J., WÃ¼rtz, D. and Tran, T. T. (2008)
Moments of the Generalized Hyperbolic Distribution. Preprint.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dskewhyp">dskewhyp</a></code>,
<code><a href="#topic+skewhypMean">skewhypMean</a></code>,<code><a href="#topic+skewhypMom">skewhypMom</a></code>,
<code><a href="#topic+skewhypFit">skewhypFit</a></code>, <code><a href="#topic+skewhypFitStart">skewhypFitStart</a></code>,
<code><a href="#topic+qqskewhyp">qqskewhyp</a></code>,
<code><a href="GeneralizedHyperbolic.html#topic+GeneralizedHyperbolicDistribution">GeneralizedHyperbolicDistribution</a></code>.
</p>

<hr>
<h2 id='ais'>Australian Institute of Sport data</h2><span id='topic+ais'></span>

<h3>Description</h3>

<p>Data on 102 male and 100 female athletes collected at the Australian
Institute of Sport, courtesy of Richard Telford and Ross Cunningham.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ais)</code></pre>


<h3>Format</h3>

<p>A data frame with 202 observations on 13 variables.
</p>

<table>
<tr>
 <td style="text-align: right;">
    [, 1] </td><td style="text-align: left;"> sex  </td><td style="text-align: left;"> sex </td>
</tr>
<tr>
 <td style="text-align: right;">
    [, 2] </td><td style="text-align: left;"> sport</td><td style="text-align: left;"> sport </td>
</tr>
<tr>
 <td style="text-align: right;">
    [, 3] </td><td style="text-align: left;"> rcc  </td><td style="text-align: left;"> red cell count </td>
</tr>
<tr>
 <td style="text-align: right;">
    [, 4] </td><td style="text-align: left;"> wcc  </td><td style="text-align: left;"> white cell count </td>
</tr>
<tr>
 <td style="text-align: right;">
    [, 5] </td><td style="text-align: left;"> Hc   </td><td style="text-align: left;"> Hematocrit </td>
</tr>
<tr>
 <td style="text-align: right;">
    [, 6] </td><td style="text-align: left;"> Hg   </td><td style="text-align: left;"> Hemoglobin </td>
</tr>
<tr>
 <td style="text-align: right;">
    [, 7] </td><td style="text-align: left;"> Fe   </td><td style="text-align: left;"> plasma ferritin concentration </td>
</tr>
<tr>
 <td style="text-align: right;">
    [, 8] </td><td style="text-align: left;"> bmi  </td><td style="text-align: left;"> body mass index, weight/(height)<code class="reqn">^2</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
    [, 9] </td><td style="text-align: left;"> ssf  </td><td style="text-align: left;"> sum of skin folds </td>
</tr>
<tr>
 <td style="text-align: right;">
    [,10] </td><td style="text-align: left;"> Bfat </td><td style="text-align: left;"> body fat percentage </td>
</tr>
<tr>
 <td style="text-align: right;">
    [,11] </td><td style="text-align: left;"> lbm  </td><td style="text-align: left;"> lean body mass </td>
</tr>
<tr>
 <td style="text-align: right;">
    [,12] </td><td style="text-align: left;"> Ht   </td><td style="text-align: left;"> height (cm) </td>
</tr>
<tr>
 <td style="text-align: right;">
    [,13] </td><td style="text-align: left;"> Wt   </td><td style="text-align: left;"> weight (Kg) </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td>
</tr>

</table>



<h3>Source</h3>

<p>Cook and Weisberg (1994) via the package <span class="pkg">sn</span>. This help file is a
modification of the help file from the package <span class="pkg">sn</span>.
</p>


<h3>References</h3>

<p>Cook and Weisberg (1994),
<em>An Introduction to Regression Graphics</em>.
John Wiley &amp; Sons, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ais)
Fe &lt;- ais$Fe
### Not enough data to find starting values
### Use default parameter values as starting values
FeFit &lt;- skewhypFit(Fe, startValues = "US", paramStart = c(0,1,1,1))
### Ferritin must always be non-negative
### Probability of negative values is small for fitted distribution
pskewhyp(0, param = FeFit$param)
</code></pre>

<hr>
<h2 id='lrdji'>Dow Jones Log Return Data</h2><span id='topic+lrdji'></span>

<h3>Description</h3>

<p>Log returns of daily closing value data from the dow
jones index, from 04/JAN/1999 to 08/JUL/2003. The original data used
to calculate these was the dji data set available in the QRMlib package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lrdji)
</code></pre>


<h3>Format</h3>

<p>A vector of 1132 observations.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>Source</h3>

<p>library(QRMlib)
data(dji)
</p>


<h3>References</h3>

<p>McNeil, A. &amp; Ulman, S. (2008).
QRMlib <em>http://cran.r-project.org/web/packages/QRMlib/index.html</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lrdji)
##fit a skew hyperbolic student t-distribution to the data
fit &lt;- skewhypFit(lrdji, plot = TRUE, print = TRUE)
</code></pre>

<hr>
<h2 id='lrnokeur'>Log Returns of the NOK/EUR Exchange Rate</h2><span id='topic+lrnokeur'></span>

<h3>Description</h3>

<p>Log returns of daily closing value data of the NOK/EUR (Norwegian
Kroner/Euro) exchange rate, from 04/JAN/1999 to 08/JUL/2003. The
original data was downloaded from the oanda website. The data was
selected to be as similar as possible to the data used in the Aas &amp;
Haff article (see <b>References</b>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lrnokeur)
</code></pre>


<h3>Format</h3>

<p>A vector of 1647 observations.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>Source</h3>

<p>http://www.oanda.com
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275&ndash;309.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Fit the skew hyperbolic students-t distribution to the data
data(lrnokeur)
fit &lt;- skewhypFit(lrnokeur, method = "nlm", plot = TRUE, print = TRUE)
</code></pre>

<hr>
<h2 id='skewhypCalcRange'>
Range of a Skew Hyperbolic Student t-Distribution
</h2><span id='topic+skewhypCalcRange'></span><span id='topic+skewhypStepSize'></span>

<h3>Description</h3>

  
<p>Given the parameter vector <code>param</code>, or parameter values of a skew
hyperbolic Student <em>t</em>-distribution, this function determines the
range outside of which the density function or distribution function
are negligible, to a specified tolerance.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewhypCalcRange(mu = 0, delta = 1, beta = 1, nu = 1,
                 param = c(mu,delta,beta,nu), density = TRUE,
                 tol= 10^(-5), ...)
skewhypStepSize(dist, delta, beta, nu, side = c("right","left"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skewhypCalcRange_+3A_mu">mu</code></td>
<td>
<p>Location parameter <code class="reqn">\mu</code>, default is 0.</p>
</td></tr>
<tr><td><code id="skewhypCalcRange_+3A_delta">delta</code></td>
<td>
<p>Scale parameter <code class="reqn">\delta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypCalcRange_+3A_beta">beta</code></td>
<td>
<p>Skewness parameter <code class="reqn">\beta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypCalcRange_+3A_nu">nu</code></td>
<td>
<p>Shape parameter <code class="reqn">\nu</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypCalcRange_+3A_param">param</code></td>
<td>
<p>Specifying the parameters as a vector of the form<br />
<code>c(mu,delta,beta,nu)</code>.</p>
</td></tr>
<tr><td><code id="skewhypCalcRange_+3A_density">density</code></td>
<td>
<p>Logical. If <code>TRUE</code> bounds refer to the density
function, otherwise bounds refer to the distribution function.</p>
</td></tr> 
<tr><td><code id="skewhypCalcRange_+3A_tol">tol</code></td>
<td>
<p>Density function value at the endpoints of the range
returned by the function.</p>
</td></tr>
<tr><td><code id="skewhypCalcRange_+3A_dist">dist</code></td>
<td>
<p>Numeric. Current distance value.</p>
</td></tr>
<tr><td><code id="skewhypCalcRange_+3A_side">side</code></td>
<td>
<p>Character. <code>"right"</code> for a step to the right,
<code>"left"</code> for a step to the right.</p>
</td></tr>
<tr><td><code id="skewhypCalcRange_+3A_...">...</code></td>
<td>
<p>Passes additional arguments to <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The particular skew hyperbolic distribution being considered is
specified by either the individual parameter values, or the parameter
vector <code>param</code>. If both are specified, the values in <code>param</code>
will overwriete the other ones.  In addition the parameter values are
examined by calling the function <code>skewhypCheckPars</code> to see if
they are valid.
</p>
<p>The function <code>skewhypCalcRange</code> returns the range outside of
which the density function or distribution function are less than the
given tolerance.  The points are found by using <code><a href="stats.html#topic+uniroot">uniroot</a></code>
on the density or distribution function.
</p>
<p>The function <code>skewhypStepSize</code> is used for stepping to the right
or the left to obtain an enclosing interval so <code>uniroot</code> can be
used to search. When the tail is declining exponentially the step is
just a linear function of the current distance from the mode. If the
tail is declining only as a power of <code class="reqn">x</code>, an exponential step is
used.
</p>
<p><code>skewhypStepSize</code> is for internal use and is not expected to be
called by users. It is documented here for completeness.
</p>


<h3>Value</h3>

<p>The function <code>skewhypCalcRange</code> returns a two component vector
giving the lower and upper limits of the range.
</p>
<p><code>skewhypStepSize</code> returns the size of the step.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275&ndash;309.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+uniroot">uniroot</a></code>, <code><a href="#topic+dskewhyp">dskewhyp</a></code>, <code><a href="#topic+skewhypCheckPars">skewhypCheckPars</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param &lt;- c(0,1,10,10)
range &lt;- skewhypCalcRange(param = param, tol = 10^(-2))
range
curve(dskewhyp(x, param = c(0,1,5,10), range[1], range[2]))

param &lt;- c(0,1,20,1)
(range &lt;- skewhypCalcRange(param = param))
round(integrate(dskewhyp, -Inf, range[1], param = param)$value,7)
round(integrate(dskewhyp, range[2], Inf, param = param)$value,7)
</code></pre>

<hr>
<h2 id='skewhypCheckPars'>Check Parameters of the Skew Hyperbolic Student t-distribution</h2><span id='topic+skewhypCheckPars'></span>

<h3>Description</h3>

<p>Given a set of parameters for the skew hyperbolic Student
<em>t</em>-distribution, the function checks that the parameters are in
the correct range, and that the set has the correct length of 4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewhypCheckPars(param)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skewhypCheckPars_+3A_param">param</code></td>
<td>
<p>A numeric vector of proposed parameters for the skew hyperbolic
<em>t</em>-distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vector <code>param</code> should be of the form
<code>c(mu,delta,beta,nu)</code>.
If either <code>delta</code> or <code>nu</code> is not greater than zero an error
message is returned.
If the vector <code>param</code> does not have a length of 4 then an error
message is returned.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>case</code></td>
<td>
<p>Either <code>'error'</code> or <code>'normal'</code>, as identified by
the function.</p>
</td></tr>
<tr><td><code>errMessage</code></td>
<td>
<p>An appropriate error message if an error was found,
otherwise an empty string.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dskewhyp">dskewhyp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>skewhypCheckPars(c(0,1,1,1))     #normal
skewhypCheckPars(c(0,0,1,1))     #error
skewhypCheckPars(c(0,1,1,-1))    #error
skewhypCheckPars(c(0,1,1))       #error
</code></pre>

<hr>
<h2 id='SkewHyperbolic-internal'>Internal Skew Hyperbolic Functions</h2><span id='topic+ddskewhypScale'></span>

<h3>Description</h3>

<p>Internal functions for the package SkewHyperbolic
</p>


<h3>Details</h3>

<p>Functions which are either not intended to be called by the user or
are waiting to be documented.
</p>

<hr>
<h2 id='SkewHyperbolicDistribution'>
Skewed Hyperbolic Student t-Distribution
</h2><span id='topic+dskewhyp'></span><span id='topic+pskewhyp'></span><span id='topic+qskewhyp'></span><span id='topic+rskewhyp'></span><span id='topic+ddskewhyp'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantiles and random number
generation for the skew hyperbolic Student <em>t</em>-distribution, with
parameters <code class="reqn">\beta</code> (skewness), <code class="reqn">\delta</code>
(scale), <code class="reqn">\mu</code> (location) and <code class="reqn">\nu</code> (shape). Also a
function for the derivative of the density function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dskewhyp(x, mu = 0, delta = 1, beta = 1, nu = 1,
         param = c(mu,delta,beta,nu), log = FALSE,
         tolerance = .Machine$double.eps^0.5)
pskewhyp(q, mu = 0, delta = 1, beta = 1, nu = 1,
         param = c(mu, delta, beta, nu), log.p = FALSE,
         lower.tail = TRUE, subdivisions = 100,
         intTol = .Machine$double.eps^0.25, valueOnly = TRUE, ...)
qskewhyp(p, mu = 0, delta = 1, beta = 1, nu = 1,
         param = c(mu,delta, beta, nu),
         lower.tail = TRUE, log.p = FALSE,
         method = c("spline","integrate"),
         nInterpol = 501, uniTol = .Machine$double.eps^0.25,
         subdivisions = 100, intTol = uniTol, ...)
rskewhyp(n, mu = 0, delta = 1, beta = 1, nu = 1,
         param = c(mu,delta,beta,nu), log = FALSE)
ddskewhyp(x, mu = 0, delta = 1, beta = 1, nu = 1,
          param = c(mu,delta,beta,nu),log = FALSE,
          tolerance = .Machine$double.eps^0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SkewHyperbolicDistribution_+3A_x">x</code>, <code id="SkewHyperbolicDistribution_+3A_q">q</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_p">p</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_n">n</code></td>
<td>
<p>Number of random variates to be generated.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_mu">mu</code></td>
<td>
<p>Location parameter <code class="reqn">\mu</code>, default is 0.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_delta">delta</code></td>
<td>
<p>Scale parameter <code class="reqn">\delta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_beta">beta</code></td>
<td>
<p>Skewness parameter <code class="reqn">\beta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_nu">nu</code></td>
<td>
<p>Shape parameter <code class="reqn">\nu</code>, default is 1.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_param">param</code></td>
<td>
<p>Specifying the parameters as a vector of the form<br />
<code>c(mu,delta,beta,nu)</code>.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_log">log</code>, <code id="SkewHyperbolicDistribution_+3A_log.p">log.p</code></td>
<td>
<p>Logical; if <code>log = TRUE</code>, probabilities are given as
log(p).</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_method">method</code></td>
<td>
<p>Character. If <code>"spline"</code> quantiles are found from a
spline approximation to the distribution function. If
<code>"integrate"</code>, the distribution function used is always obtained
by integration.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical. If <code>lower.tail = TRUE</code>, the cumulative
density is taken from the lower tail.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_tolerance">tolerance</code></td>
<td>
<p>Specified level of tolerance when checking if
parameter <code>beta</code> is equal to 0.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_subdivisions">subdivisions</code></td>
<td>
<p>The maximum number of subdivisions used to
integrate the density and determine the accuracy of the distribution
function calculation.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_inttol">intTol</code></td>
<td>
<p>Value of <code>rel.tol</code> and hence <code>abs.tol</code> in
calls to <code>integrate</code>. See <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_valueonly">valueOnly</code></td>
<td>
<p>Logical. If <code>valueOnly = TRUE</code> calls to
<code>pskewhyp</code> only return the value obtained for the
integral. If <code>valueOnly = FALSE</code> an estimate of the
accuracy of the numerical integration is also returned.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_ninterpol">nInterpol</code></td>
<td>
<p>Number of points used in <code>qskewhyp</code> for cubic
spline interpolation of the distribution function.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_unitol">uniTol</code></td>
<td>
<p>Value of <code>tol</code> in
calls to <code>uniroot</code>. See <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicDistribution_+3A_...">...</code></td>
<td>
<p>Passes additional arguments to <code><a href="stats.html#topic+integrate">integrate</a></code> in
<code>pskewhyp</code> and <code>qskewhyp</code>, and to <code><a href="stats.html#topic+uniroot">uniroot</a></code> in
<code>qskewhyp</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Users may either specify the values of the parameters individually or
as a vector. If both forms are specified, then the values specified by
the vector <code>param</code> will overwrite the other ones. In addition the
parameter values are examined by calling the function
<code>skewhypCheckPars</code> to see if they are valid.
</p>
<p>The density function is
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\frac{2^{(1-\nu)/2}\delta^\nu%latex
      |\beta|^{(\nu+1)/2}%
      K_{(\nu+1)/2}\sqrt{(\beta^2(\delta^2+(x-\mu)^2))}%
      \exp(\beta(x-\mu))}{\Gamma(\nu/2)\sqrt{(\pi)}%
      \sqrt{(\delta^2+(x-\mu)^2)^{(\nu+1)/2}}}</code>
</p>

<p>when <code class="reqn">\beta \ne 0</code>, and
</p>
<p style="text-align: center;"><code class="reqn"> f(x)=\frac{\Gamma((\nu+1)/2)}{\sqrt{\pi}\delta%
      \Gamma(\nu/2)}\left(1+\frac{(x-\mu)^2}{\delta^2}\right)^%
    {-(\nu+1)/2} </code>
</p>

<p>when <code class="reqn">\beta = 0</code>, where <code class="reqn">K_{\nu}(.)</code> is the
modified Bessel function of the third kind with order <code class="reqn">\nu</code>,
and <code class="reqn">\Gamma(.)</code> is the gamma function.
</p>
<p><code>pskewhyp</code> uses the function <code><a href="stats.html#topic+integrate">integrate</a></code> to
numerically integrate the density function. The integration is from
<code>-Inf</code> to <code>x</code> if <code>x</code> is to the left of the mode, and
from <code>x</code> to <code>Inf</code> if <code>x</code> is to the right of the
mode. The probability calculated this way is subtracted from 1 if
required. Integration in this manner appears to make calculation of
the quantile function more stable in extreme cases.
</p>
<p>Calculation of quantiles using <code>qhyperb</code> permits the use of two
different methods. Both methods use <code>uniroot</code> to find the value
of <code class="reqn">x</code> for which a given <code class="reqn">q</code> is equal <code class="reqn">F(x)</code> where <code class="reqn">F</code>
denotes the cumulative distribution function. The difference is in how
the numerical approximation to <code class="reqn">F</code> is obtained. The obvious
and more accurate method is to calculate the value of <code class="reqn">F(x)</code>
whenever it is required using a call to <code>phyperb</code>. This is what
is done if the method is specified as <code>"integrate"</code>. It is clear
that the time required for this approach is roughly linear in the
number of quantiles being calculated. A Q-Q plot of a large data set
will clearly take some time. The alternative (and default) method is
that for the major part of the distribution a spline approximation to
<code class="reqn">F(x)</code> is calculated and quantiles found using <code>uniroot</code> with
this approximation. For extreme values (for which the tail probability
is less than <code class="reqn">10^{-7}</code>), the integration method is still
used even when the method specifed is <code>"spline"</code>.
</p>
<p>If accurate probabilities or quantiles are required, tolerances
(<code>intTol</code> and <code>uniTol</code>) should be set to small values, say
<code class="reqn">10^{-10}</code> or <code class="reqn">10^{-12}</code> with <code>method
  = "integrate"</code>. Generally then accuracy might be expected to be at
least <code class="reqn">10^{-9}</code>. If the default values of the functions
are used, accuracy can only be expected to be around
<code class="reqn">10^{-4}</code>. Note that on 32-bit systems
<code>.Machine$double.eps^0.25 = 0.0001220703</code> is a typical value.
</p>
<p>Note that when small values of <code class="reqn">\nu</code> are used, and the density
is skewed, there are often some extreme values generated by
<code>rskewhyp</code>. These look like outliers, but are caused by the
heaviness of the skewed tail, see <b>Examples</b>.
</p>
<p>The extreme skewness of the distribution when <code class="reqn">\beta</code> is
large in absolute value and <code class="reqn">\nu</code> is small make this
distribution very challenging numerically.
</p>


<h3>Value</h3>

<p><code>dskewhyp</code> gives the density function, <code>pskewhyp</code> gives the
distribution function, <code>qskewhyp</code> gives the quantile function and
<code>rskewhyp</code> generates random variates.
</p>
<p>An estimate of the accuracy of the approximation to the distribution
function can be found by setting <code>valueOnly = FALSE</code> in the call to
<code>pskewyhp</code> which returns a list with components <code>value</code> and
<code>error</code>.
</p>
<p><code>ddskewhyp</code> gives the derivative of <code><a href="#topic+dskewhyp">dskewhyp</a></code>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275&ndash;309.
</p>


<h3>See Also</h3>

<p><code><a href="DistributionUtils.html#topic+safeIntegrate">safeIntegrate</a></code>,
<code><a href="stats.html#topic+integrate">integrate</a></code> for its shortfalls,
<code><a href="#topic+skewhypCheckPars">skewhypCheckPars</a></code>,
<code><a href="DistributionUtils.html#topic+logHist">logHist</a></code>. Also
<code><a href="#topic+skewhypMean">skewhypMean</a></code> for information on moments and mode, and
<code><a href="#topic+skewhypFit">skewhypFit</a></code> for fitting to data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param &lt;- c(0,1,40,10)
par(mfrow = c(1,2))
range &lt;- skewhypCalcRange(param = param, tol = 10^(-2))

### curves of density and distribution
curve(dskewhyp(x, param = param), range[1], range[2], n = 1000)
title("Density of the \n Skew Hyperbolic Distribution")
curve(pskewhyp(x, param = param),
      range[1], range[2], n = 500)
title("Distribution Function of the \n Skew Hyperbolic Distribution")

### curves of density and log density
par(mfrow = c(1,2))
data &lt;- rskewhyp(1000, param = param)
curve(dskewhyp(x, param = param), range(data)[1], range(data)[2],
      n = 1000, col = 2)
hist(data, freq = FALSE, add = TRUE)
title("Density and Histogram of the\n Skew Hyperbolic Distribution")
DistributionUtils::logHist(data, main =
  "Log-Density and Log-Histogram of\n the Skew Hyperbolic Distribution")
curve(dskewhyp(x, param = param, log = TRUE),
      range(data)[1], range(data)[2],
      n = 500, add = TRUE, col = 2)

##plots of density and derivative
par(mfrow = c(2,1))
curve(dskewhyp(x, param = param), range[1], range[2], n = 1000)
title("Density of the Skew\n Hyperbolic Distribution")
curve(ddskewhyp(x, param = param), range[1], range[2], n = 1000)
title("Derivative of the Density\n of the Skew Hyperbolic Distribution")

##  example of density and random numbers for beta large and nu small
par(mfrow = c(1,2))
param1 &lt;- c(0,1,10,1)
data1 &lt;- rskewhyp(1000, param = param1)
curve(dskewhyp(x, param = param1), range(data1)[1], range(data1)[2],
      n = 1000, col = 2, main = "Density and Histogram -- when nu is small")
hist(data1, freq = FALSE, add = TRUE)

DistributionUtils::logHist(data1, main =
      "Log-Density and Log-Histogram -- when nu is small")
curve(dskewhyp(x, param = param1, log = TRUE),
      from = min(data1), to = max(data1), n = 500, add = TRUE, col = 2)
</code></pre>

<hr>
<h2 id='SkewHyperbolicPlots'>
Skew Hyperbolic Student t-Distribution Quantile-Quantile and
Percent-Percent Plots
</h2><span id='topic+qqskewhyp'></span><span id='topic+ppskewhyp'></span>

<h3>Description</h3>

<p><code>qqskewhyp</code> produces a skew hyperbolic <em>t</em>-distribution Q-Q
plot of the values in <code>y</code>, <code>ppskewhyp</code> produces a skew
hyperbolic <em>t</em>-distribution P-P (percent-percent) plot or
probability plot of the values in <code>y</code>.  Graphical parameters may
be given as arguments to <code>qqskewhyp</code> and <code>ppskewhyp</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqskewhyp(y, mu = 0, delta = 1, beta = 1, nu = 1,
          param = c(mu, delta, beta, nu),
          main = "Skew Hyperbolic Student-t QQ Plot",
          xlab = "Theoretical Quantiles", ylab = "Sample Quantiles",
          plot.it = TRUE, line = TRUE, ...)
ppskewhyp(y, beta = NULL, delta = NULL, mu = NULL, nu = NULL,
          param = c(mu, delta, beta, nu),
          main = "Skew Hyperbolic Student-t P-P Plot",
          xlab = "Uniform Quantiles",
          ylab = "Probability-integral-transformed Data",
          plot.it = TRUE, line = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SkewHyperbolicPlots_+3A_y">y</code></td>
<td>
<p>The sample data.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicPlots_+3A_mu">mu</code></td>
<td>
<p>Location parameter <code class="reqn">\mu</code>, default is 0.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicPlots_+3A_delta">delta</code></td>
<td>
<p>Scale parameter <code class="reqn">\delta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicPlots_+3A_beta">beta</code></td>
<td>
<p>Skewness parameter <code class="reqn">\beta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicPlots_+3A_nu">nu</code></td>
<td>
<p>Shape parameter <code class="reqn">\nu</code>, default is 1.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicPlots_+3A_param">param</code></td>
<td>
<p>Specifying the parameters as a vector of the form<br />
<code>c(mu,delta,beta,nu)</code>.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicPlots_+3A_main">main</code>, <code id="SkewHyperbolicPlots_+3A_xlab">xlab</code>, <code id="SkewHyperbolicPlots_+3A_ylab">ylab</code></td>
<td>
<p>Plot labels.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicPlots_+3A_plot.it">plot.it</code></td>
<td>
<p>Logical; if <code>plot.it = TRUE</code> the results will be plotted.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicPlots_+3A_line">line</code></td>
<td>
<p>Logical; if <code>line = TRUE</code> a line is added through the
origin with unit slope.</p>
</td></tr>
<tr><td><code id="SkewHyperbolicPlots_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Users may either specify the values of the parameters individually or
as a vector. If both forms are specified, then the values specified by
the vector <code>param</code> will overwrite the other ones.
</p>


<h3>Value</h3>

<p>For <code>qqskewhyp</code> and <code>ppskewhyp</code>, a list with components:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>The x coordinates of the points to be plotted.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The y coordinates of the points to be plotted.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275&ndash;309.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ppoints">ppoints</a></code>, <code><a href="stats.html#topic+qqplot">qqplot</a></code>, <code><a href="#topic+dskewhyp">dskewhyp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mfrow = c(1,2))
param &lt;- c(0,1,0,10)
y &lt;- rskewhyp(500, param = param)
qqskewhyp(y, param = param, main = "Skew Hyperbolic\n Q-Q Plot")
ppskewhyp(y, param = param, main = "Skew Hyperbolic\n P-P Plot")
</code></pre>

<hr>
<h2 id='skewhypFit'>
Fit the Skew Hyperbolic Student t-Distribution to Data
</h2><span id='topic+skewhypFit'></span><span id='topic+plot.skewhypFit'></span><span id='topic+print.skewhypFit'></span>

<h3>Description</h3>

<p>Fits a skew hyperbolic <em>t</em>-distribution to given data.
Displays the histogram, log-histogram (both with fitted densities),
Q-Q plot and P-P plot for the fit which has maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewhypFit(x, freq = NULL, breaks = NULL, startValues = "LA",
           paramStart = NULL, method = "Nelder-Mead", hessian = TRUE,
           plots = FALSE, printOut = TRUE, controlBFGS = list(maxit = 200),
           controlNM = list(maxit = 1000), maxitNLM = 1500, ...)
## S3 method for class 'skewhypFit'
plot(x, which = 1:4,
     plotTitles = paste(c("Histogram of ", "Log-Histogram of ",
     "Q-Q Plot of ", "P-P Plot of "), x$obsName, sep = ""),
     ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(), ...)
## S3 method for class 'skewhypFit'
print(x,digits = max(3, getOption("digits") - 3),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skewhypFit_+3A_x">x</code></td>
<td>
<p>Data vector for <code>skewhypFit</code>. Object of class
<code>"skewhypFit"</code> for <code>print.skewhypFit</code>.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_freq">freq</code></td>
<td>
<p>Vector of weights with length equal to length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_breaks">breaks</code></td>
<td>
<p>Breaks for histogram, defaults to those generated by
<code>hist(x, plot = FALSE, right = FALSE).</code>If <code>startValues = "LA"</code>
then 30 breaks are used by default.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_startvalues">startValues</code></td>
<td>
<p>Code giving the method of determining starting
values for finding the maximum likelihood estimates of the
parameters.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_paramstart">paramStart</code></td>
<td>
<p>If <code>startValues = "US"</code> the
user must specify a vector of starting parameter values in the form
<code>c(mu,delta,beta,nu)</code>.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_method">method</code></td>
<td>
<p>Different optimisation methods to consider, see
<b>Details</b>.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_hessian">hessian</code></td>
<td>
<p>Logical; if <code>hessian = TRUE</code> the value of the
hessian is returned.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_plots">plots</code></td>
<td>
<p>Logical; if <code>plots = TRUE</code> the histogram,
log-histogram, Q-Q and P-P plots are printed.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_printout">printOut</code></td>
<td>
<p>Logical; if <code>printOut = TRUE</code> results of the
fitting are printed.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_controlbfgs">controlBFGS</code></td>
<td>
<p>A list of control parameters for <code>optim</code> when
using the <code>"BFGS"</code> optimisation.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_controlnm">controlNM</code></td>
<td>
<p>A list of control parameters for <code>optim</code>
when using the <code>"Nelder-Mead"</code> optimisation.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_maxitnlm">maxitNLM</code></td>
<td>
<p>A positive integer specifying the maximum number of
iterations when using the <code>"nlm"</code> optimisation.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_which">which</code></td>
<td>
<p>If a subset of plots is required, specify a subset of the
numbers <code>1:4</code>.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_plottitles">plotTitles</code></td>
<td>
<p>Titles to appear above the plots.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_ask">ask</code></td>
<td>
<p>Logical; if <code>TRUE</code> the user is asked before plot
change, see <code><a href="graphics.html#topic+par">par</a>(ask = .)</code>.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_digits">digits</code></td>
<td>
<p>Desired number of digits when the object is printed.</p>
</td></tr>
<tr><td><code id="skewhypFit_+3A_...">...</code></td>
<td>
<p>Passes arguments to <code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+nlm">nlm</a></code>,
<code><a href="graphics.html#topic+hist">hist</a></code>, <code><a href="DistributionUtils.html#topic+logHist">logHist</a></code>,
<code><a href="#topic+qqskewhyp">qqskewhyp</a></code> and <code><a href="#topic+ppskewhyp">ppskewhyp</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>startValues</code> can be either <code>"US"</code>(User-supplied) or
<code>"LA"</code> (Linear approximation)
If <code>startValues = "US"</code> then a value for <code>paramStart</code> must be
supplied. For the details concerning the use of <code>startValues</code>
and <code>paramStart</code> see <code><a href="#topic+skewhypFitStart">skewhypFitStart</a></code>.
</p>
<p>The three optimisation methods currently available are:
</p>

<dl>
<dt><code>"BFGS"</code></dt><dd><p>Uses the quasi-Newton method <code>"BFGS"</code> as
documented in <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>"Nelder-Mead"</code></dt><dd><p>Uses an implementation of the Nelder and
Mead method as documented in <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>"nlm"</code></dt><dd><p>Uses the <code><a href="stats.html#topic+nlm">nlm</a></code> function in R.</p>
</dd>
</dl>

<p>For the details of how to pass control information using
<code><a href="stats.html#topic+optim">optim</a></code> and <code><a href="stats.html#topic+nlm">nlm</a></code>, see <code><a href="stats.html#topic+optim">optim</a></code> and
<code><a href="stats.html#topic+nlm">nlm</a>.</code>
</p>


<h3>Value</h3>

<p><code>skewhypFit</code> returns a list with components:
</p>
<table role = "presentation">
<tr><td><code>param</code></td>
<td>
<p>A vector giving the maximum likelihood estimates of the
parameters in the form <code>c(mu,delta,beta,nu)</code>.</p>
</td></tr>
<tr><td><code>maxLik</code></td>
<td>
<p>The value of the maximised log-likelihood.</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>If <code>hessian</code> was set to <code>TRUE</code>, the value of
the hessian, not present otherwise.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Optimisation method used.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>Convergence code. See <code><a href="stats.html#topic+optim">optim</a></code> or
<code><a href="stats.html#topic+nlm">nlm</a></code> for details.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations of optimisation routine.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>The data used to fit the distribution.</p>
</td></tr>
<tr><td><code>xName</code></td>
<td>
<p>Character string with the actual <code>x</code> argument name.</p>
</td></tr>
<tr><td><code>paramStart</code></td>
<td>
<p>Starting values of the parameters returned by
<code><a href="#topic+skewhypFitStart">skewhypFitStart</a></code>.</p>
</td></tr>
<tr><td><code>svName</code></td>
<td>
<p>Name of the method used to find starting values.</p>
</td></tr>
<tr><td><code>startValues</code></td>
<td>
<p>Acronym of method used to find starting values.</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>
<p>Cell boundaries found by a call to <code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>midpoints</code></td>
<td>
<p>The cell midpoints found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>empDens</code></td>
<td>
<p>The estimated density found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code> if <code>startValues = "US"</code>, or
<code><a href="stats.html#topic+density">density</a></code> if <code>startValues = "LA"</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275&ndash;309.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+nlm">nlm</a></code>, <code><a href="graphics.html#topic+par">par</a></code>,
<code><a href="graphics.html#topic+hist">hist</a></code>, <code><a href="stats.html#topic+density">density</a>,</code>
<code><a href="DistributionUtils.html#topic+logHist">logHist</a></code>,
<code><a href="#topic+qqskewhyp">qqskewhyp</a></code>, <code><a href="#topic+ppskewhyp">ppskewhyp</a></code>,
<code><a href="#topic+dskewhyp">dskewhyp</a></code> and <code><a href="#topic+skewhypFitStart">skewhypFitStart</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See how well skewhypFit works
param &lt;- c(0, 1, 4, 10)
data &lt;- rskewhyp(500, param = param)
fit &lt;- skewhypFit(data)
## Use data set NOK/EUR as per Aas&amp;Haff
data(lrnokeur)
nkfit &lt;- skewhypFit(lrnokeur, method = "nlm")
## Use data set DJI
data(lrdji)
djfit &lt;- skewhypFit(lrdji)
</code></pre>

<hr>
<h2 id='skewhypFitStart'>
Find Starting Values for Fitting a Skew Hyperbolic Student
t-Distribution
</h2><span id='topic+skewhypFitStart'></span><span id='topic+skewhypFitStartLA'></span><span id='topic+skewhypFitStartMM'></span>

<h3>Description</h3>

<p>Finds starting values for input to a maximum likelihood routine for
fitting a skew hyperbolic <em>t</em>-distribution to data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewhypFitStart(x, breaks = NULL, startValues = "LA", paramStart = NULL,
...)
skewhypFitStartLA(x, breaks = NULL)
skewhypFitStartMM(x, nuTol = 1e-6, nuStart = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skewhypFitStart_+3A_x">x</code></td>
<td>
<p>Data vector.</p>
</td></tr>
<tr><td><code id="skewhypFitStart_+3A_breaks">breaks</code></td>
<td>
<p>Breaks for histogram. If missing defaults to those
generated by <code>hist(x, right = FALSE, plot =FALSE)</code>. If
<code>startValues = "LA"</code> then 30 breaks are used by default.</p>
</td></tr>
<tr><td><code id="skewhypFitStart_+3A_startvalues">startValues</code></td>
<td>
<p>Code giving the method of determining starting
values for finding the maximum likelihood estimates of the
parameters.</p>
</td></tr> 
<tr><td><code id="skewhypFitStart_+3A_paramstart">paramStart</code></td>
<td>
<p>If <code>startValues = "US"</code> the user must specify a
vector of starting parameter values in the form
<code>c(mu,delta,beta,nu)</code>.</p>
</td></tr>
<tr><td><code id="skewhypFitStart_+3A_nutol">nuTol</code></td>
<td>
<p>Tolerance for numerical determination of <code>nu</code> in
<code><a href="#topic+skewhypFitStartMM">skewhypFitStartMM</a></code></p>
</td></tr>
<tr><td><code id="skewhypFitStart_+3A_nustart">nuStart</code></td>
<td>
<p>Initial value for numerical determinationof <code>nu</code>
in <code><a href="#topic+skewhypFitStartMM">skewhypFitStartMM</a></code></p>
</td></tr>
<tr><td><code id="skewhypFitStart_+3A_...">...</code></td>
<td>
<p>Passes additional arguments to <code><a href="#topic+skewhypFitStartMM">skewhypFitStartMM</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>startValues</code> can be either <code>"US"</code>(User-supplied),
<code>"LA"</code>(Linear approximation), or <code>"MM"</code>(Method of moments).
</p>
<p>If <code>startValues = "US"</code> then a value for <code>paramStart</code> must be
supplied. The parameters are checked for validity by the function
<code>skewhypCheckPars</code>.
</p>
<p>If <code>startValues = "LA"</code> a linear approximation is made to the
log-density in each of the tails, from which the estimates for
<code class="reqn">\nu</code> and <code class="reqn">\beta</code> are found. The remaining two
parameters, <code class="reqn">\delta</code> and <code class="reqn">\mu</code> are found by solving
the moment equations for mean and variance.  Since the variance does
not exist for values of <code class="reqn">\nu \le 4</code>, the estimate of
<code class="reqn">\nu</code> will be at least 4.1.  Note that if the distribution is
too skewed, there are not enough points in the lighter tail to fit the
required linear model, and the method will stop and return a
warning. User supplied values will have to be used in this case.
</p>
<p>If <code>startValues = "MM"</code>, start values are found using the method
of moments as outlined in Aas and Haff (2006).
</p>


<h3>Value</h3>

<p><code>skewhypFitStart</code> returns a list with components:
</p>
<table role = "presentation">
<tr><td><code>paramStart</code></td>
<td>
<p>A vector of the form <code>c(mu,delta,beta,nu)</code>
giving the generated starting values of the parameters.</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>
<p>The cell boundaries found by a call to <code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>midpoints</code></td>
<td>
<p>The cell midpoints found by a call to <code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>empDens</code></td>
<td>
<p>The estimated density at the midpoints found by a call
to <code><a href="graphics.html#topic+hist">hist</a></code> if <code>startValues = "US"</code> or
<code>startValues = "MM"</code>, or to <code><a href="stats.html#topic+density">density</a></code> if
<code>startValues  = "LA"</code>.</p>
</td></tr>
<tr><td><code>svName</code></td>
<td>
<p>Name of the method used to find the starting values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275&ndash;309.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+hist">hist</a></code>, <code><a href="stats.html#topic+density">density</a></code>, <code><a href="#topic+dskewhyp">dskewhyp</a></code>,
<code><a href="#topic+skewhypFit">skewhypFit</a></code>, <code><a href="#topic+skewhypCheckPars">skewhypCheckPars</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## find starting values to feed to skewhypFit
data(lrnokeur)
skewhypFitStart(lrnokeur, startValues="LA")$paramStart
## user supplied values
skewhypFitStart(lrnokeur, startValues="US",
                paramStart=c(0,0.01,0,5))$paramStart
</code></pre>

<hr>
<h2 id='skewhypMeanVarMode'>
Moments and Mode of the Skew Hyperbolic Student t-Distribution.
</h2><span id='topic+skewhypMeanVarMode'></span><span id='topic+skewhypMean'></span><span id='topic+skewhypVar'></span><span id='topic+skewhypSkew'></span><span id='topic+skewhypKurt'></span><span id='topic+skewhypMode'></span>

<h3>Description</h3>

<p>Functions to calculate the mean, variance, skewness, kurtosis and mode
of a specified skew hyperbolic <em>t</em>-distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewhypMean(mu = 0, delta = 1, beta = 1, nu = 1,
            param = c(mu,delta,beta,nu))
skewhypVar(mu = 0, delta = 1, beta = 1, nu = 1,
           param = c(mu,delta,beta,nu))
skewhypSkew(mu = 0, delta = 1, beta = 1, nu = 1,
            param = c(mu,delta,beta,nu))
skewhypKurt(mu = 0, delta = 1, beta = 1, nu = 1,
            param = c(mu,delta,beta,nu))
skewhypMode(mu = 0, delta = 1, beta = 1, nu = 1,
            param = c(mu,delta,beta,nu),
            tolerance = .Machine$double.eps ^ 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skewhypMeanVarMode_+3A_mu">mu</code></td>
<td>
<p>Location parameter <code class="reqn">\mu</code>, default is 0.</p>
</td></tr>
<tr><td><code id="skewhypMeanVarMode_+3A_delta">delta</code></td>
<td>
<p>Scale parameter <code class="reqn">\sigma</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypMeanVarMode_+3A_beta">beta</code></td>
<td>
<p>Skewness parameter <code class="reqn">\beta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypMeanVarMode_+3A_nu">nu</code></td>
<td>
<p>Shape parameter <code class="reqn">\nu</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypMeanVarMode_+3A_param">param</code></td>
<td>
<p>Specifying the parameters as a vector of the form<br />
<code>c(mu,delta,beta,nu)</code>.</p>
</td></tr>
<tr><td><code id="skewhypMeanVarMode_+3A_tolerance">tolerance</code></td>
<td>
<p>A difference smaller than this value is taken to be zero.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Users may either specify the values of the parameters individually or
as a vector. If both forms are specified, then the values specified by
the vector <code>param</code> will overwrite the other ones.In addition the
parameter values are examined by calling the function
<code>skewhypCheckPars</code> to see if they are valid.
</p>
<p>The moments are calculated as per formulae in Aas&amp;Haff(2006) and the
mode is calculated by numerical optimisation of the density function
using <code><a href="stats.html#topic+optim">optim</a></code>.
</p>
<p>Note that the mean does not exist when <code class="reqn">\nu = 2</code>, the
variance does not exist for <code class="reqn">\nu \le 4</code>, the skewness
does not exist for <code class="reqn">\nu \le 6</code>, and the kurtosis does not
exist for <code class="reqn">\nu \le 8</code>.
</p>


<h3>Value</h3>

<p><code>skewhypMean</code> gives the mean of the skew hyperbolic
<em>t</em>-distribution, <code>skewhypVar</code> the variance,
<code>skewhypSkew</code> the skewness, <code>skewhypKurt</code> the kurtosis and
<code>skewhypMode</code> the mode.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275&ndash;309.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dskewhyp">dskewhyp</a></code>, <code><a href="stats.html#topic+optim">optim</a></code>,
<code><a href="#topic+skewhypCheckPars">skewhypCheckPars</a></code>, <code><a href="#topic+skewhypMom">skewhypMom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param &lt;- c(10,1,5,9)
skewhypMean(param = param)
skewhypVar(param = param)
skewhypSkew(param = param)
skewhypKurt(param = param)
skewhypMode(param = param)
range &lt;- skewhypCalcRange(param = param)
curve(dskewhyp(x, param = param), range[1], range[2])
abline(v = skewhypMode(param = param), col = "red")
abline(v = skewhypMean(param = param), col = "blue")
</code></pre>

<hr>
<h2 id='skewhypMom'>Calculate Moments of the Skew Hyperbolic Student t-Distribution.</h2><span id='topic+skewhypMom'></span>

<h3>Description</h3>

<p>This function can be used to calculate the raw moments, mu moments,
central moments, and moments about any other given location for the
skew hyperbolic <em>t</em>-distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewhypMom(order, mu = 0, delta = 1, beta = 1, nu = 1,
           param = c(mu,delta,beta,nu), momType = "raw", about = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skewhypMom_+3A_order">order</code></td>
<td>
<p>Numeric. The order of the moment to be calculated. Not
permitted to be a vector. Must be a positive integer, except for
moments about 0.</p>
</td></tr>
<tr><td><code id="skewhypMom_+3A_mu">mu</code></td>
<td>
<p>Location parameter <code class="reqn">\mu</code>, default is 0.</p>
</td></tr>
<tr><td><code id="skewhypMom_+3A_delta">delta</code></td>
<td>
<p>Scale parameter <code class="reqn">\delta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypMom_+3A_beta">beta</code></td>
<td>
<p>Skewness parameter <code class="reqn">\beta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypMom_+3A_nu">nu</code></td>
<td>
<p>Shape parameter <code class="reqn">\nu</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypMom_+3A_param">param</code></td>
<td>
<p>Specifying the parameters as a vector of the form
<code>c(mu,delta,beta,nu)</code>.</p>
</td></tr>
<tr><td><code id="skewhypMom_+3A_momtype">momType</code></td>
<td>
<p>Common types of moments to be calculated, default is
<code>"raw"</code>, see <b>Details</b>.</p>
</td></tr>
<tr><td><code id="skewhypMom_+3A_about">about</code></td>
<td>
<p>Numeric. The point around which the moment is to be
calculated, default is zero. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Users may either specify the values of the parameters individually or
as a vector. If both forms are specified, then the values specified by
the vector <code>param</code> will overwrite the other ones. In addition the
parameter values are examined by calling the function
<code>skewhypCheckPars</code> to see if they are valid.
</p>
<p><code>order</code> is also checked by calling the function
<code>is.wholenumber</code> in the <code>DistributionUtils</code> package to
see whether a whole number is given.
</p>
<p><code>momType</code> can be either <code>"raw"</code> (moments about zero),
<code>"mu"</code> (moments about mu), or <code>"central"</code> (moments
about the mean). If one of these types of moments is required there is
no need to specify a value for <code>about</code>. For moments about any
other location <code>about</code> must be specified. In the case that both
<code>momType</code> and <code>about</code> are specified and contradicting, the
function will calculate the moments based on the value of
<code>about</code>.
</p>
<p>To calculate the moments of the skew hyperbolic <em>t</em>-distribution,
the function first calculates the mu moments by the formula defined
below, and then transforms them to any of the other types of moment by
calling <code>momChangeAbout</code> in the <code>DistributionUtils</code>
package.
</p>
<p>The mu moments of the skew hyperbolic <em>t</em>-distribution are given
by:
</p>
<p style="text-align: center;"><code class="reqn">\bar{M}_k = \sum\limits_{\ell = \lfloor(k+1)/2\rfloor}^{k}
        a_{k, \ell} \beta^{2\ell - k} \left[\frac{\delta^{2\ell}
          \Gamma(\nu/2 - \ell)}{ \Gamma(\nu/2) 2^{\ell} }\right]</code>
</p>

<p>where <code class="reqn">k = \code{order}</code> and <code class="reqn">k &gt; 0</code> and
<code class="reqn">a_{k, \ell}</code> is the recursive coefficient (see
<code><a href="GeneralizedHyperbolic.html#topic+momRecursion">momRecursion</a></code> for details).
</p>
<p>This formula is given in Scott, WÃ¼rtz and Tran
(2008). Note that the [.] part of this formula is actually equivalent
to the formula for the raw moments of the inverse gamma distribution,
so the function calls <code>gammaRawMom</code> in the <code>GeneralizedHyperbolic</code>
package when implementing the computations.
</p>


<h3>Value</h3>

 
<p>The function returns the moment specified. In the case of raw moments,
<code>Inf</code> is returned if the moment is infinite.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson</p>


<h3>References</h3>

<p>Paolella, Marc S. (2007) Intermediate Probability: A Computational
Approach, Chichester: Wiley
</p>
<p>Scott, D. J., WÃ¼rtz, D. and Tran, T. T. (2008)
Moments of the Generalized Hyperbolic Distribution. Preprint.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+skewhypCheckPars">skewhypCheckPars</a></code>, <code><a href="#topic+skewhypMean">skewhypMean</a></code>,
<code><a href="DistributionUtils.html#topic+is.wholenumber">is.wholenumber</a></code>,
<code><a href="GeneralizedHyperbolic.html#topic+momRecursion">momRecursion</a></code>,
<code><a href="DistributionUtils.html#topic+momChangeAbout">momChangeAbout</a></code> and
<code><a href="GeneralizedHyperbolic.html#topic+gigMom">gigMom</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param = c(1,2,3,10)
##Raw moments of the skew hyperbolic t distribution
skewhypMom(3, param = param, momType = "raw")
##Mu moments
skewhypMom(3, param = param, momType = "mu")
##Central moments
skewhypMom(3, param = param, momType = "central")
##Moments about any location
skewhypMom(3, param = param, about = 5)
</code></pre>

<hr>
<h2 id='skewhypParam'>Parameter Sets for the Skew Hyperbolic t-Distribution</h2><span id='topic+skewhypSmallShape'></span><span id='topic+skewhypLargeShape'></span><span id='topic+skewhypSmallParam'></span><span id='topic+skewhypLargeParam'></span>

<h3>Description</h3>

<p>These objects store different parameter sets of the skew hyperbolic
<code class="reqn">t</code> distribution for testing or demonstrating purpose as matrices.
</p>
<p>Specifically, the parameter sets <code>skewhypSmallShape</code> and
<code>skewhypLargeShape</code> have constant location parameter of <code class="reqn">\mu
    = 0</code> and scale parameter of <code class="reqn">\delta = 1</code>.
</p>
<p>The skewness parameter <code class="reqn">\beta</code> takes values from {0,2} in
<code>skewhypSmallShape</code> and <code>skewhypSmallParam</code>, and from
{-5,0,1,2,5} in <code>skewhypLargeShape</code> and
<code>skewhypLargeParam</code>.
</p>
<p>The shape parameter <code class="reqn">\nu</code> takes values from {1,5} in
<code>skewhypSmallShape</code> and <code>skewhypSmallParam</code>, and from
{1,2,5,10,20} in <code>skewhypLargeShape</code> and
<code>skewhypLargeParam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(skewhypParam)
</code></pre>


<h3>Format</h3>

<p><code>skewhypSmallShape</code>: a 4 by 4 matrix;
</p>
<p><code>skewhypLargeShape</code>: a 25 by 4 matrix;
</p>
<p><code>skewhypSmallParam</code>: a 16 by 4 matrix;
</p>
<p><code>skewhypLargeParam</code>: a 400 by 4 matrix.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(skewhypParam)
### Testing the accuracy of skewhypMean
for (i in 1:nrow(skewhypSmallParam)) {
  param &lt;- skewhypSmallParam[i, ]
  x &lt;- rskewhyp(1000, param = param)
  sampleMean &lt;- mean(x)
  distMean &lt;- skewhypMean(param = param)
  difference &lt;- abs(sampleMean - distMean)
  print(difference)
}

</code></pre>

<hr>
<h2 id='skewhypTailPlotLine'>Tail Plot Line</h2><span id='topic+skewhypTailPlotLine'></span>

<h3>Description</h3>

<p>Adds skew hyperbolic <em>t</em>-distribution line to a tail plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewhypTailPlotLine(x, mu = 0, delta = 1, beta = 1, nu = 1,
                    param = c(mu,delta,beta,nu),
                    side = c("right", "left"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skewhypTailPlotLine_+3A_x">x</code></td>
<td>
<p>A vector of values for which the tail plot has been drawn.</p>
</td></tr>
<tr><td><code id="skewhypTailPlotLine_+3A_side">side</code></td>
<td>
<p>Character. <code>"right"</code> (the default) if the tail plot
is of the right-hand tail, <code>"left"</code> if the tail plot is of the
left-hand tail.</p>
</td></tr>
<tr><td><code id="skewhypTailPlotLine_+3A_mu">mu</code></td>
<td>
<p>Location parameter <code class="reqn">\mu</code>, default is 0.</p>
</td></tr>
<tr><td><code id="skewhypTailPlotLine_+3A_delta">delta</code></td>
<td>
<p>Scale parameter <code class="reqn">\delta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypTailPlotLine_+3A_beta">beta</code></td>
<td>
<p>Skewness parameter <code class="reqn">\beta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypTailPlotLine_+3A_nu">nu</code></td>
<td>
<p>Shape parameter <code class="reqn">\nu</code>, default is 1.</p>
</td></tr>
<tr><td><code id="skewhypTailPlotLine_+3A_param">param</code></td>
<td>
<p>Specifying the parameters as a vector of the form<br />
<code>c(mu,delta,beta,nu)</code>.</p>
</td></tr>
<tr><td><code id="skewhypTailPlotLine_+3A_...">...</code></td>
<td>
<p>Other graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>tailPlot</code> from <span class="pkg">DistributionUtils</span> can be used
to draw either a left-hand or right-hand tail plot of
the data <code>x</code>.  See for example Resnick (2007), p.105. The
left-hand tail plot plots the empirical distribution of the data
against the order statistics, for order statistic values below the
median. The right-hand tail plot plots one minus the empirical
distribution of the data against the order statistics, for order
statistic values above the median. The default is for the y-axis to be
plotted on a log scale.
</p>
<p><code>skewhypTailPlotLine</code> adds the line derived from the given skew
hyperbolic <em>t</em>-distribution to an already drawn tail plot.
</p>


<h3>Value</h3>

<p>Returns <code>NULL</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>
</p>


<h3>References</h3>

<p>Aas, Kjersti and HobÃ¦k Haff, Ingrid (2006)
The generalised hyperbolic skew Student's <code class="reqn">t</code>-distribution.
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275&ndash;309.
</p>
<p>Resnick, S. (2007) <em>Heavy-Tail Phenomena</em>, New York: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="DistributionUtils.html#topic+tailPlot">tailPlot</a></code> and
<code><a href="#topic+skewhypFit">skewhypFit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Draw tail plot of some data
tailPlot &lt;- DistributionUtils :: tailPlot  ## for convenience below
param &lt;- c(0,1,1,10)
x &lt;- rskewhyp(200, param = param)
tailPlot(x)
### Add skew hyperbolic t-distribution line
skewhypTailPlotLine(x, param = param)
### Parameters from fit may look better
paramFit &lt;- skewhypFit(x, plots = FALSE)$param
tailPlot(x)
skewhypTailPlotLine(x, param = param)
skewhypTailPlotLine(x, param = paramFit, col = "steelblue")

### Left tail example
tailPlot(x, side = "l")
### Add skew hyperbolic t-distribution line
skewhypTailPlotLine(x, param = paramFit, side = "l")
### Log scale on both axes
tailPlot(x, side = "r", log = "xy")
### Add skew hyperbolic t-distribution line
skewhypTailPlotLine(x, param = paramFit, side = "r")

</code></pre>

<hr>
<h2 id='summary.skewhypFit'>Summarising the Skew Hyperbolic Student t-Distribution Fit</h2><span id='topic+summary.skewhypFit'></span><span id='topic+print.summary.skewhypFit'></span>

<h3>Description</h3>

<p><code>summary</code> Method for class <code>"skewhypFit"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'skewhypFit'
summary(object, ...)
## S3 method for class 'summary.skewhypFit'
print(x, digits = max(3,
getOption("digits") - 3), ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.skewhypFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>"skewhypFit"</code>, resulting from a
call to <code><a href="#topic+skewhypFit">skewhypFit</a></code>.</p>
</td></tr>
<tr><td><code id="summary.skewhypFit_+3A_x">x</code></td>
<td>
<p>An object of class <code>"summary.skewhypFit"</code>, resulting
from a call to<br />
<code>summary.skewhypFit</code>.</p>
</td></tr>
<tr><td><code id="summary.skewhypFit_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary.skewhypFit_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary.skewhypFit</code> calculates standard errors for errors for
the estimates of <code class="reqn">\mu</code>, <code class="reqn">\delta</code>, <code class="reqn">\beta</code>
and <code class="reqn">\nu</code> of the skew hyperbolic Student
<em>t</em>-distribution parameter vector <code>param</code>, if the Hessian
from the call to <code><a href="stats.html#topic+optim">optim</a></code> or <code><a href="stats.html#topic+nlm">nlm</a></code> is
available. Because the parameters in the call to the optimiser are
<code class="reqn">\mu</code>, <code class="reqn">\log(\delta)</code>, <code class="reqn">\beta</code> and
<code class="reqn">\log(\nu)</code> the delta method is used to obtain standard
errors for <code class="reqn">\delta</code> and <code class="reqn">\nu</code>
</p>


<h3>Value</h3>

<p>If the Hessian is available <code>summary.skewhyhpFit</code> computes
standard errors of <code class="reqn">\mu</code>, <code class="reqn">\delta</code>, <code class="reqn">\beta</code>
and <code class="reqn">\nu</code>, and adds them to <code>object</code> as
<code>object$sds</code>. Otherwise, no calculations are performed and the
composition <code>object</code> is unaltered.
</p>
<p><code>summary.skewhypFit</code> invisibly returns <code>x</code> with class
changed to <code>summary.skewhypFit</code>.
</p>
<p>See <code><a href="#topic+skewhypFit">skewhypFit</a></code> for the composition of an object of class
<code>skewhypFit</code>.
</p>
<p><code>print.summary.skewhypFit</code> prints a summary in the same format as
<code><a href="#topic+print.skewhypFit">print.skewhypFit</a></code> when the Hessian is not available from
the fit. When the Hessian is available, the standard errors for the
parameter estimates are printed in parentheses beneath the parameter
estimates, in the manner of <code>fitdistr</code> in the package <code>MASS</code>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Fiona Grimson
</p>


<h3>References</h3>

<p>Aas, K. and Haff, I. H. (2006).
The Generalised Hyperbolic Skew Student's <em>t</em>-distribution,
<em>Journal of Financial Econometrics</em>, <b>4</b>, 275&ndash;309.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+skewhypFit">skewhypFit</a></code>, <code><a href="#topic+dskewhyp">dskewhyp</a></code>, <code><a href="base.html#topic+summary">summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Continuing the skewhypFit(.) example:
data(lrdji)
djfit &lt;- skewhypFit(lrdji, print = FALSE, plot = FALSE, hessian = TRUE)
print(djfit)
summary(djfit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
