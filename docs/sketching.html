<!DOCTYPE html><html><head><title>Help for package sketching</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sketching}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AK'><p>AK</p></a></li>
<li><a href='#simulation_dgp'><p>Simulating observations from the data-generating process considered in Lee and Ng (2022)</p></a></li>
<li><a href='#sketch'><p>Sketch</p></a></li>
<li><a href='#sketch_leverage'><p>Sketch using leverage score type sampling</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sketching of Data via Random Subspace Embeddings</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Construct sketches of data via random subspace embeddings. 
  For more details, see the following papers.
  Lee, S. and Ng, S. (2022). "Least Squares Estimation Using Sketched Data with Heteroskedastic Errors," Proceedings of the 39th International Conference on Machine Learning (ICML22), 162:12498-12520.
  Lee, S. and Ng, S. (2020). "An Econometric Perspective on Algorithmic Subsampling," Annual Review of Economics, 12(1): 45â€“80.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, MASS, Rcpp (&ge; 1.0.7), phangorn (&ge; 2.8.1)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), lmtest (&ge; 0.9), ivreg
(&ge; 0.6), sandwich (&ge; 3.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/sokbae/sketching/">https://github.com/sokbae/sketching/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sokbae/sketching/issues">https://github.com/sokbae/sketching/issues</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-06 21:44:00 UTC; sokbaelee</td>
</tr>
<tr>
<td>Author:</td>
<td>Sokbae Lee [aut, cre],
  Serena Ng [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sokbae Lee &lt;sl3841@columbia.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-07 07:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AK'>AK</h2><span id='topic+AK'></span>

<h3>Description</h3>

<p>Angrist-Krueger (AK) dataset is a data extract from US Censuses that was analyzed in Angrist and Krueger (1991).
In particular, the current dataset is from the 1970 Census, consisting of men born 1920-1929 
(Year 1929 is the omitted cohort group).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AK
</code></pre>


<h3>Format</h3>

<p>A data frame with 247,199 rows and 42 variables:
</p>

<dl>
<dt>LWKLYWGE</dt><dd><p>Outcome: log weekly wages</p>
</dd>
<dt>EDUC</dt><dd><p>Covariate of interest: years of education</p>
</dd>
<dt>YR20</dt><dd><p>Indicator variable for the year of birth: equals 1 if yob = 1920</p>
</dd>
<dt>YR21</dt><dd><p>Indicator variable for the year of birth: equals 1 if yob = 1921</p>
</dd>
<dt>YR22</dt><dd><p>Indicator variable for the year of birth: equals 1 if yob = 1922</p>
</dd>
<dt>YR23</dt><dd><p>Indicator variable for the year of birth: equals 1 if yob = 1923</p>
</dd>
<dt>YR24</dt><dd><p>Indicator variable for the year of birth: equals 1 if yob = 1924</p>
</dd>
<dt>YR25</dt><dd><p>Indicator variable for the year of birth: equals 1 if yob = 1925</p>
</dd>
<dt>YR26</dt><dd><p>Indicator variable for the year of birth: equals 1 if yob = 1926</p>
</dd>
<dt>YR27</dt><dd><p>Indicator variable for the year of birth: equals 1 if yob = 1927</p>
</dd>
<dt>YR28</dt><dd><p>Indicator variable for the year of birth: equals 1 if yob = 1928</p>
</dd>
<dt>QTR120</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR121</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR122</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR123</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR124</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR125</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR126</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR127</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR128</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR129</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR220</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR221</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR222</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR223</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR224</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR225</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR226</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR227</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR228</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR229</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR320</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR321</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR322</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR323</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR324</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR325</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR326</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR327</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR328</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>QTR329</dt><dd><p>Quarter-of-birth indicator interacted with year-of-birth indicator</p>
</dd>
<dt>CNST</dt><dd><p>Constant</p>
</dd>
</dl>



<h3>Source</h3>

<p>The dataset is publicly available on Joshua Angrist's website at 
<a href="https://economics.mit.edu/faculty/angrist/data1/data/angkru1991/">https://economics.mit.edu/faculty/angrist/data1/data/angkru1991/</a>.
</p>


<h3>References</h3>

<p>Angrist, J.D. and Krueger, A.B., 1991. Does compulsory school attendance affect schooling and earnings?
Quarterly Journal of Economics, 106(4), pp.979&ndash;1014.
<a href="https://doi.org/10.2307/2937954">doi:10.2307/2937954</a>
</p>

<hr>
<h2 id='simulation_dgp'>Simulating observations from the data-generating process considered in Lee and Ng (2022)</h2><span id='topic+simulation_dgp'></span>

<h3>Description</h3>

<p>Simulates observations from the data-generating process considered in Lee and Ng (2022)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_dgp(n, d, hetero = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation_dgp_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="simulation_dgp_+3A_d">d</code></td>
<td>
<p>dimension of regressors from a multivariate normal distribution</p>
</td></tr>
<tr><td><code id="simulation_dgp_+3A_hetero">hetero</code></td>
<td>
<p>TRUE if the conditional variance of the error term is heteroskedastic and
FALSE if it is homoskedastic  (default: FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 object has the following elements.
</p>
<table>
<tr><td><code>Y</code></td>
<td>
<p>n observations of outcomes</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>n times d matrix of regressors</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>d dimensional vector of coefficients</p>
</td></tr>
</table>


<h3>References</h3>

<p>Lee, S. and Ng, S. (2022). &quot;Least Squares Estimation Using Sketched Data with Heteroskedastic Errors,&quot; arXiv:2007.07781.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data &lt;- simulation_dgp(100, 5, hetero = TRUE)
  y &lt;- data$Y
  x &lt;- data$X
  model  &lt;- lm(y ~ x) 

</code></pre>

<hr>
<h2 id='sketch'>Sketch</h2><span id='topic+sketch'></span>

<h3>Description</h3>

<p>Provides a subsample of data using sketches
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sketch(data, m, method = "unif")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sketch_+3A_data">data</code></td>
<td>
<p>(n times d)-dimensional matrix of data.</p>
</td></tr>
<tr><td><code id="sketch_+3A_m">m</code></td>
<td>
<p>(expected) subsample size that is less than n</p>
</td></tr>
<tr><td><code id="sketch_+3A_method">method</code></td>
<td>
<p>method for sketching:
&quot;unif&quot; uniform sampling with replacement (default);
&quot;unif_without_replacement&quot; uniform sampling without replacement;
&quot;bernoulli&quot; Bernoulli sampling;
&quot;gaussian&quot; Gaussian projection;
&quot;countsketch&quot; CountSketch;
&quot;srht&quot; subsampled randomized Hadamard transform;
&quot;fft&quot; subsampled randomized trigonometric transforms using the real part of 
fast discrete Fourier transform (stats::ftt).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(m times d)-dimensional matrix of data
For Bernoulli sampling, the number of rows is not necessarily m.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Least squares: sketch and solve
# setup
n &lt;- 1e+6 # full sample size
d &lt;- 5    # dimension of covariates
m &lt;- 1e+3 # sketch size
# generate psuedo-data
X &lt;- matrix(stats::rnorm(n*d), nrow = n, ncol = d)
beta &lt;- matrix(rep(1,d), nrow = d, ncol = 1)
eps &lt;- matrix(stats::rnorm(n), nrow = n, ncol = 1)
Y &lt;- X %*% beta + eps
intercept &lt;- matrix(rep(1,n), nrow = n, ncol = 1)
# full sample including the intercept term
fullsample &lt;- cbind(Y,intercept,X)
# generate a sketch using CountSketch
s_cs &lt;-  sketch(fullsample, m, "countsketch")
# solve without the intercept
ls_cs &lt;- lm(s_cs[,1] ~ s_cs[,2] - 1)
# generate a sketch using SRHT
s_srht &lt;-  sketch(fullsample, m, "srht")
# solve without the intercept
ls_srht &lt;- lm(s_srht[,1] ~ s_srht[,2] - 1)

</code></pre>

<hr>
<h2 id='sketch_leverage'>Sketch using leverage score type sampling</h2><span id='topic+sketch_leverage'></span>

<h3>Description</h3>

<p>Provides a subsample of data using sketches
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sketch_leverage(data, m, method = "leverage")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sketch_leverage_+3A_data">data</code></td>
<td>
<p>(n times d)-dimensional matrix of data. 
The first column needs to be a vector of the dependent variable (Y)</p>
</td></tr>
<tr><td><code id="sketch_leverage_+3A_m">m</code></td>
<td>
<p>subsample size that is less than n</p>
</td></tr>
<tr><td><code id="sketch_leverage_+3A_method">method</code></td>
<td>
<p>method for sketching:
&quot;leverage&quot; leverage score sampling using X (default);
&quot;root_leverage&quot; square-root leverage score sampling using X.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 object has the following elements.
</p>
<table>
<tr><td><code>subsample</code></td>
<td>
<p>(m times d)-dimensional matrix of data</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>m-dimensional vector of probabilities</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ma, P., Zhang, X., Xing, X., Ma, J. and Mahoney, M.. (2020). Asymptotic Analysis of Sampling Estimators for Randomized Numerical Linear Algebra Algorithms. Proceedings of the Twenty Third International Conference on Artificial Intelligence and Statistics, PMLR 108:1026-1035.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Least squares: sketch and solve
# setup
n &lt;- 1e+6 # full sample size
d &lt;- 5    # dimension of covariates
m &lt;- 1e+3 # sketch size
# generate psuedo-data
X &lt;- matrix(stats::rnorm(n*d), nrow = n, ncol = d)
beta &lt;- matrix(rep(1,d), nrow = d, ncol = 1)
eps &lt;- matrix(stats::rnorm(n), nrow = n, ncol = 1)
Y &lt;- X %*% beta + eps
intercept &lt;- matrix(rep(1,n), nrow = n, ncol = 1)
# full sample including the intercept term
fullsample &lt;- cbind(Y,intercept,X)
# generate a sketch using leverage score sampling
s_lev &lt;-  sketch_leverage(fullsample, m, "leverage")
# solve without the intercept with weighting
ls_lev &lt;- lm(s_lev$subsample[,1] ~ s_lev$subsample[,2] - 1, weights = s_lev$prob)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
