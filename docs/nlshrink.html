<!DOCTYPE html><html><head><title>Help for package nlshrink</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlshrink}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ESD'><p>Compute the empirical spectral distribution (ESD) for a set of population</p>
eigenvalues</a></li>
<li><a href='#lambda_estimate'><p>Generate sample eigenvalues from population eigenvalues</p></a></li>
<li><a href='#linshrink'><p>Linear-shrinkage estimator of population eigenvalues.</p></a></li>
<li><a href='#linshrink_cov'><p>Linear-shrinkage estimator of population covariance matrix.</p></a></li>
<li><a href='#nlshrink'><p>Package</p></a></li>
<li><a href='#nlshrink_cov'><p>Non-linear shrinkage estimator of population covariance matrix.</p></a></li>
<li><a href='#nlshrink_demo'><p>Demonstration of non-linear shrinkage estimator of population eigenvalues</p></a></li>
<li><a href='#tau_estimate'><p>Non-linear shrinkage estimator of population eigenvalues.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Non-Linear Shrinkage Estimation of Population Eigenvalues and
Covariance Matrices</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-04-11</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.3)</td>
</tr>
<tr>
<td>Description:</td>
<td>Non-linear shrinkage estimation of population eigenvalues and covariance
    matrices, based on publications by Ledoit and Wolf (2004, 2015, 2016).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats (&ge; 3.2.3), MASS (&ge; 7.3-45), nloptr (&ge; 1.0.4),
graphics (&ge; 3.2.3)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-04-11 21:51:34 UTC; Pratik</td>
</tr>
<tr>
<td>Author:</td>
<td>Pratik Ramprasad [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pratik Ramprasad &lt;pratik.ramprasad@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-04-12 00:55:21</td>
</tr>
</table>
<hr>
<h2 id='ESD'>Compute the empirical spectral distribution (ESD) for a set of population
eigenvalues</h2><span id='topic+ESD'></span>

<h3>Description</h3>

<p>The Marcenko Pastur (MP) law relates the limiting distribution
of the sample eigenvalues to that of the population eigenvalues. In the
finite-dimensional case, the population spectral distribution (PSD) can be
represented as a sum of point masses, and the empirical spectral
distribution (ESD) can be obtained by solving the discretized MP equation.
Theoretical and implementation details in the references.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ESD(tau, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ESD_+3A_tau">tau</code></td>
<td>
<p>(Required) A non-negative numeric vector of population
eigenvalues.</p>
</td></tr>
<tr><td><code id="ESD_+3A_n">n</code></td>
<td>
<p>(Required) A positive integer representing the number of datapoints
of a hypothetical data matrix with dimension <code>c(n, p = length(tau))</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector of containing points of the ESD. The names
give the corresponding points on the x axis.
</p>


<h3>References</h3>

 <ul>
<li><p> Ledoit, O. and Wolf, M. (2015). Spectrum
estimation: a unified framework for covariance matrix estimation and PCA in
large dimensions. Journal of Multivariate Analysis, 139(2) </p>
</li>
<li><p> Ledoit, O.
and Wolf, M. (2016). Numerical Implementation of the QuEST function.
arXiv:1601.05870 [stat.CO] </p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>tau_ESD &lt;- ESD(tau = rep(1,200), n = 300)
plot(names(tau_ESD), tau_ESD, ylab="F(x)", xlab="x")
</code></pre>

<hr>
<h2 id='lambda_estimate'>Generate sample eigenvalues from population eigenvalues</h2><span id='topic+lambda_estimate'></span>

<h3>Description</h3>

<p>The Marcenko Pastur (MP) law relates the limiting distribution
of the sample eigenvalues to that of the population eigenvalues. In the
finite-dimensional case, the population spectral distribution (PSD) can be
represented as a sum of point masses, and the empirical spectral
distribution (ESD) can be obtained by solving the discretized MP equation.
The QuEST function(see references), uses the quantile function of the ESD
to compute the sample eigenvalues for any given ratio <code class="reqn">c = p/n \in
  (0,\infty)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda_estimate(tau, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda_estimate_+3A_tau">tau</code></td>
<td>
<p>(Required) A non-negative numeric vector of population
eigenvalues.</p>
</td></tr>
<tr><td><code id="lambda_estimate_+3A_n">n</code></td>
<td>
<p>(Required) A positive integer representing the number of datapoints
of a hypothetical data matrix with dimension <code>c(n, p = length(tau))</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of the same length as <code>tau</code>, containing the
sample eigenvalue estimates, sorted in ascending order.
</p>


<h3>References</h3>

 <ul>
<li><p> Ledoit, O. and Wolf, M. (2015). Spectrum
estimation: a unified framework for covariance matrix estimation and PCA in
large dimensions. Journal of Multivariate Analysis, 139(2) </p>
</li>
<li><p> Ledoit, O.
and Wolf, M. (2016). Numerical Implementation of the QuEST function.
arXiv:1601.05870 [stat.CO] </p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>lambda_estimate(tau = rep(1,200), n = 300)
</code></pre>

<hr>
<h2 id='linshrink'>Linear-shrinkage estimator of population eigenvalues.</h2><span id='topic+linshrink'></span>

<h3>Description</h3>

<p><code>linshrink</code> estimates the population eigenvalues from the
sample eigenvalues by shrinking each sample eigenvalue towards the global
mean based on a shrinkage factor. Details in referenced publications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linshrink(X, k = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linshrink_+3A_x">X</code></td>
<td>
<p>A data matrix.</p>
</td></tr>
<tr><td><code id="linshrink_+3A_k">k</code></td>
<td>
<p>(Optional) Non-negative integer less than <code>ncol(X)</code>. If <code>k
== 0</code> (default), <code>X</code> is assumed to contain 1 class, which will be
centered. If <code>k &gt;= 1</code>, <code>X</code> is assumed to contain <code>k</code>
classes, each of which has already been centered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length <code>ncol(X)</code>, containing the population
eigenvalue estimates sorted in ascending order.
</p>


<h3>References</h3>

 <ul>
<li><p> Ledoit, O. and Wolf, M. (2004). A
well-conditioned estimator for large-dimensional covariance matrices.
Journal of Multivariate Analysis, 88(2) </p>
</li>
<li><p> Ledoit, O. and Wolf, M.
(2016). Numerical Implementation of the QuEST function. arXiv:1601.05870
[stat.CO] </p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>linshrink(X = matrix(rnorm(1e4, mean = 5), nrow = 100, ncol = 100)) # 1 class; will be centered
linshrink(X = matrix(rnorm(1e4), nrow = 100, ncol = 100), k = 1) # 1 class; no centering
</code></pre>

<hr>
<h2 id='linshrink_cov'>Linear-shrinkage estimator of population covariance matrix.</h2><span id='topic+linshrink_cov'></span>

<h3>Description</h3>

<p>The linear shrinkage estimator of the population covariance
matrix is computed by shrinking the sample covariance matrix towards the
identity matrix based on a shrinkage factor. Note that the eigenvalues of
the population covariance matrix estimate are not the same as the linear
shrinkage estimates of population eigenvalues. Details in referenced
publication.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linshrink_cov(X, k = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linshrink_cov_+3A_x">X</code></td>
<td>
<p>A data matrix.</p>
</td></tr>
<tr><td><code id="linshrink_cov_+3A_k">k</code></td>
<td>
<p>(Optional) Non-negative integer less than <code>ncol(X)</code>. If <code>k
== 0</code> (default), <code>X</code> is assumed to contain 1 class, which will be
centered. If <code>k &gt;= 1</code>, <code>X</code> is assumed to contain <code>k</code>
classes, each of which has already been centered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Population covariance matrix estimate. A square positive
semi-definite matrix of dimension <code>ncol(X)</code>.
</p>


<h3>References</h3>

 <ul>
<li><p> Ledoit, O. and Wolf, M. (2004). A
well-conditioned estimator for large-dimensional covariance matrices.
Journal of Multivariate Analysis, 88(2)</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>linshrink_cov(X = matrix(rnorm(1e4, mean = 5), nrow = 100, ncol = 100)) # 1 class; will be centered
linshrink_cov(X = matrix(rnorm(1e4), nrow = 100, ncol = 100), k = 1) # 1 class; no centering
</code></pre>

<hr>
<h2 id='nlshrink'>Package</h2><span id='topic+nlshrink'></span><span id='topic+nlshrink-package'></span>

<h3>Description</h3>

<p>A package for estimating population eigenvalues and covariance
matrices, based on publications by Ledoit and Wolf (2004, 2012, 2015,
2016).
</p>


<h3>Details</h3>

<p>A common assumption in statistics is that for a data matrix <code class="reqn">X</code>
of dimension <code class="reqn">n \times p</code>, the number of predictor variables (p)
vanishes relative to the number of datapoints (n) as <code class="reqn">n \to \infty</code>.
However, in modern datasets, it is often the case that p is comparable to
or greater than n. In this scenario, a more appropriate asymptotic
framework is to assume that the ratio <code class="reqn">c := p/n</code> approaches a finite
positive value as <code class="reqn">n,p \to \infty</code>. In this case, the sample covariance
matrix <code class="reqn">S</code> is no longer a consistent estimator of the population
covariance matrix <code class="reqn">\Sigma</code>. Similarly, the sample eigenvalues deviate
substantially from the population eigenvalues. This package contains
implementations of Ledoit and Wolf's linear and non-linear shrinkage
population eigenvalue and covariance estimation methods, based on their
2016 publication and the accompanying MATLAB code. Theoretical and
implementation details of these methods can be found in the following
publications:
</p>
 <ul>
<li><p> Ledoit, O. and Wolf, M. (2004). A well-conditioned
estimator for large-dimensional covariance matrices. Journal of
Multivariate Analysis, 88(2) </p>
</li>
<li><p> Ledoit, O. and Wolf, M. (2012).
Nonlinear shrinkage estimation of large-dimensional covariance matrices.
Annals of Statistics, 40(2). </p>
</li>
<li><p> Ledoit, O. and Wolf, M. (2015). Spectrum
estimation: a unified framework for covariance matrix estimation and PCA in
large dimensions. Journal of Multivariate Analysis, 139(2). </p>
</li>
<li><p> Ledoit,
O. and Wolf, M. (2016). Numerical Implementation of the QuEST function.
arXiv:1601.05870 [stat.CO]. </p>
</li></ul>


<hr>
<h2 id='nlshrink_cov'>Non-linear shrinkage estimator of population covariance matrix.</h2><span id='topic+nlshrink_cov'></span>

<h3>Description</h3>

<p><code>nlshrink_cov</code> calls <code><a href="#topic+tau_estimate">tau_estimate</a></code> to estimate
the population eigenvalues. Note that the eigenvalues of the estimated
population covariance matrix are not the same as the non-linear shrinkage
estimates of the population eigenvalues. Theoretical and implementation
details in references.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlshrink_cov(X, k = 0, method = "nlminb", control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlshrink_cov_+3A_x">X</code></td>
<td>
<p>A data matrix.</p>
</td></tr>
<tr><td><code id="nlshrink_cov_+3A_k">k</code></td>
<td>
<p>(Optional) Non-negative integer less than <code>ncol(X)</code>. If <code>k
== 0</code> (default), <code>X</code> is assumed to contain 1 class, which will be
centered. If <code>k &gt;= 1</code>, <code>X</code> is assumed to contain <code>k</code>
classes, each of which has already been centered.</p>
</td></tr>
<tr><td><code id="nlshrink_cov_+3A_method">method</code></td>
<td>
<p>(Optional) The optimization routine called in
<code><a href="#topic+tau_estimate">tau_estimate</a></code>. Choices are <code>nlminb</code> (default) and
<code>nloptr</code>.</p>
</td></tr>
<tr><td><code id="nlshrink_cov_+3A_control">control</code></td>
<td>
<p>(Optional) A list of control parameters. Must correspond to
the selected optimization method. See <code><a href="stats.html#topic+nlminb">nlminb</a></code>,
<code><a href="nloptr.html#topic+nloptr">nloptr</a></code> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric positive semi-definite matrix of dimension <code>ncol(X)</code>.
</p>


<h3>References</h3>

 <ul>
<li><p> Ledoit, O. and Wolf, M. (2015). Spectrum
estimation: a unified framework for covariance matrix estimation and PCA in
large dimensions. Journal of Multivariate Analysis, 139(2) </p>
</li>
<li><p> Ledoit, O.
and Wolf, M. (2016). Numerical Implementation of the QuEST function.
arXiv:1601.05870 [stat.CO] </p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># generate matrix of uniform random variates
X &lt;- matrix(sapply(1:20, function(b) runif(50, max=b)), nrow = 50, ncol = 20)
Sigma &lt;- diag((1:20)^2/12) # true population covariance matrix
nlshrink_X &lt;- nlshrink_cov(X, k=0) # compute non-linear shrinkage estimate
linshrink_X &lt;- linshrink_cov(X, k=0) # compute linear shrinkage estimate
S &lt;- cov(X) # sample covariance matrix

# compare accuracy of estimators (sum of squared elementwise Euclidean distance)
sum((S-Sigma)^2)
sum((nlshrink_X - Sigma)^2)
sum((linshrink_X - Sigma)^2)

</code></pre>

<hr>
<h2 id='nlshrink_demo'>Demonstration of non-linear shrinkage estimator of population eigenvalues</h2><span id='topic+nlshrink_demo'></span>

<h3>Description</h3>

<p>This is a demonstration of the non-linear shrinkage method for
estimating population eigenvalues. The inputted population eigenvalues are
used to simulate a matrix of multivariate normal random variates with
covariance matrix <code>diag(tau)</code>. This data matrix is then used to
estimate the input population eigenvalues using the non-linear shrinkage
method. The output plot shows the comparison of the various estimators
(sample eigenvalues, linear shrinkage, non-linear shrinkage) to the true
population eigenvalues.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlshrink_demo(tau = NULL, n = 300, p = 300, method = "nlminb",
  control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlshrink_demo_+3A_tau">tau</code></td>
<td>
<p>(Optional) Input population eigenvalues. Non-negative Numeric
vector of length <code>p</code>.</p>
</td></tr>
<tr><td><code id="nlshrink_demo_+3A_n">n</code></td>
<td>
<p>(Optional) Number of rows in simulated data matrix (Default 300).</p>
</td></tr>
<tr><td><code id="nlshrink_demo_+3A_p">p</code></td>
<td>
<p>(Optional) Number of columns in simulated data matrix (Default 300).</p>
</td></tr>
<tr><td><code id="nlshrink_demo_+3A_method">method</code></td>
<td>
<p>(Optional) The optimization routine called in
<code><a href="#topic+tau_estimate">tau_estimate</a></code>. Choices are <code>nlminb</code> (default) and
<code>nloptr</code>.</p>
</td></tr>
<tr><td><code id="nlshrink_demo_+3A_control">control</code></td>
<td>
<p>(Optional) A list of control parameters. Must correspond to
the selected optimization method. See <code><a href="stats.html#topic+nlminb">nlminb</a></code>,
<code><a href="nloptr.html#topic+nloptr">nloptr</a></code> for details.</p>
</td></tr>
</table>


<h3>NOTE</h3>

<p><code>nlminb</code> is usually robust and accurate, but does not
allow equality constraints, so the sum of the estimated population
eigenvalues is in general not equal to the sum of the sample eigenvalues.
<code>nloptr</code> enforces an equality constraint to preserve the trace, but is
substantially slower than <code>nlminb</code>. The default optimizer used for
<code>nloptr</code> is the Augmented Lagrangian method with local optimization
using LBFGS. These can be modified using the control parameter.
<code>Rcgmin</code> does not enforce equality constraints, but may be more
efficient for certain higher dimensional problems. The ideal optimization
routine depends on the underlying structure of the population eigenvalues.
</p>


<h3>References</h3>

<ul>
<li><p> Ledoit, O. and Wolf, M. (2015). Spectrum
estimation: a unified framework for covariance matrix estimation and PCA in
large dimensions. Journal of Multivariate Analysis, 139(2) </p>
</li>
<li><p> Ledoit, O.
and Wolf, M. (2016). Numerical Implementation of the QuEST function.
arXiv:1601.05870 [stat.CO]</p>
</li></ul>


<hr>
<h2 id='tau_estimate'>Non-linear shrinkage estimator of population eigenvalues.</h2><span id='topic+tau_estimate'></span>

<h3>Description</h3>

<p>The population eigenvalue estimates are computed by numerically
inverting the QuEST function (see references). The starting point is the
linear shrinkage estimate of the population eigenvalues, computed using
<code><a href="#topic+linshrink">linshrink</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tau_estimate(X, k = 0, method = "nlminb", control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tau_estimate_+3A_x">X</code></td>
<td>
<p>A data matrix.</p>
</td></tr>
<tr><td><code id="tau_estimate_+3A_k">k</code></td>
<td>
<p>(Optional) Non-negative integer less than <code>ncol(X)</code>. If <code>k
== 0</code> (default), <code>X</code> is assumed to contain 1 class, which will be
centered. If <code>k &gt;= 1</code>, <code>X</code> is assumed to contain <code>k</code>
classes, each of which has already been centered.</p>
</td></tr>
<tr><td><code id="tau_estimate_+3A_method">method</code></td>
<td>
<p>(Optional) The optimization routine used. Choices are
<code>nlminb</code> (default) and <code>nloptr</code>.</p>
</td></tr>
<tr><td><code id="tau_estimate_+3A_control">control</code></td>
<td>
<p>(Optional) A list of control parameters. Must correspond to
the selected optimization method. See <code><a href="stats.html#topic+nlminb">nlminb</a></code>,
<code><a href="nloptr.html#topic+nloptr">nloptr</a></code> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length <code>ncol(X)</code>, containing the population
eigenvalue estimates, sorted in ascending order.
</p>


<h3>NOTE</h3>

<p><code>nlminb</code> is usually robust and accurate, but does not
allow equality constraints, so, in general, the sum of the estimated
population eigenvalues is not equal to the sum of the sample eigenvalues.
<code>nloptr</code> enforces an equality constraint to preserve the trace, but is
substantially slower than <code>nlminb</code>. The default optimizer used for
<code>nloptr</code> is the Augmented Lagrangian method with local optimization
using LBFGS. These can be modified using the control parameter.
</p>


<h3>References</h3>

 <ul>
<li><p> Ledoit, O. and Wolf, M. (2015). Spectrum
estimation: a unified framework for covariance matrix estimation and PCA in
large dimensions. Journal of Multivariate Analysis, 139(2) </p>
</li>
<li><p> Ledoit, O.
and Wolf, M. (2016). Numerical Implementation of the QuEST function.
arXiv:1601.05870 [stat.CO] </p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>tau_estimate(X = matrix(rnorm(1e3, mean = 5), nrow = 50, ncol = 20))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
