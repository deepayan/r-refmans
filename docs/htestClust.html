<!DOCTYPE html><html lang="en"><head><title>Help for package htestClust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {htestClust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#chisqtestClust'><p>Chi-squared Test for Clustered Count Data</p></a></li>
<li><a href='#cortestClust'><p>Test for Marginal Association Between Paired Clustered Data</p></a></li>
<li><a href='#icsPlot'><p>Test of Marginal Proportion for Clustered Data</p></a></li>
<li><a href='#icstestClust'><p>Test for Informative Cluster Size</p></a></li>
<li><a href='#levenetestClust'><p>Reweighted Levene's Test for Homogeneity of Variance in Clustered Data</p></a></li>
<li><a href='#mcnemartestClust'><p>Test of Marginal Homogeneity for Clustered Data</p></a></li>
<li><a href='#onewaytestClust'><p>Test for Equal Marginal Means in Clustered Data</p></a></li>
<li><a href='#proptestClust'><p>Test of Marginal Proportion for Clustered Data</p></a></li>
<li><a href='#screen8'><p>Example data for informative cluster size</p></a></li>
<li><a href='#ttestClust'><p>Test of Marginal Means in Clustered Data</p></a></li>
<li><a href='#vartestClust'><p>Reweighted Test to Compare Two Variances in Clustered Data</p></a></li>
<li><a href='#wilcoxtestClust'><p>Rank Sum and Signed Rank Tests for Clustered Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Reweighted Marginal Hypothesis Tests for Clustered Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of reweighted marginal hypothesis tests for clustered data, based
    on reweighting methods of Williamson, J., Datta, S., and Satten, G. (2003) &lt;<a href="https://doi.org/10.1111%2F1541-0420.00005">doi:10.1111/1541-0420.00005</a>&gt;.
    The tests in this collection are clustered analogs to well-known hypothesis tests
    in the classical setting, and are appropriate for data with cluster- and/or group-size 
    informativeness. The syntax and output of functions are modeled after common, 
    recognizable functions native to R. Methods used in the package refer to 
    Gregg, M., Datta, S., and Lorenz, D. (2020) &lt;<a href="https://doi.org/10.1177%2F0962280220928572">doi:10.1177/0962280220928572</a>&gt;, 
    Nevalainen, J., Oja, H., and Datta, S. (2017) &lt;<a href="https://doi.org/10.1002%2Fsim.7288">doi:10.1002/sim.7288</a>&gt;
    Dutta, S. and Datta, S. (2015) &lt;<a href="https://doi.org/10.1111%2Fbiom.12447">doi:10.1111/biom.12447</a>&gt;, 
    Lorenz, D., Datta, S., and Harkema, S. (2011) &lt;<a href="https://doi.org/10.1002%2Fsim.4368">doi:10.1002/sim.4368</a>&gt;, 
    Datta, S. and Satten, G. (2008) &lt;<a href="https://doi.org/10.1111%2Fj.1541-0420.2007.00923.x">doi:10.1111/j.1541-0420.2007.00923.x</a>&gt;, 
    Datta, S. and Satten, G. (2005) &lt;<a href="https://doi.org/10.1198%2F016214504000001583">doi:10.1198/016214504000001583</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>bootstrap, graphics, MASS, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-15 23:45:00 UTC; konan</td>
</tr>
<tr>
<td>Author:</td>
<td>Mary Gregg <a href="https://orcid.org/0000-0003-2991-6939"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Somnath Datta <a href="https://orcid.org/0000-0003-4381-1842"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Doug Lorenz <a href="https://orcid.org/0000-0001-8114-0926"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mary Gregg &lt;megregg07@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-18 06:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='chisqtestClust'>Chi-squared Test for Clustered Count Data</h2><span id='topic+chisqtestClust'></span>

<h3>Description</h3>

<p><code>chisqtestClust</code> performs chi-squared contingency table tests and goodness-of-fit tests for
clustered data with potentially informative cluster size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisqtestClust(x, y = NULL, id, p = NULL,
             variance = c("MoM", "sand.null", "sand.est", "emp"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chisqtestClust_+3A_x">x</code></td>
<td>
<p>a numeric vector or factor. Can also be a table or data frame.</p>
</td></tr>
<tr><td><code id="chisqtestClust_+3A_y">y</code></td>
<td>
<p>a numeric vector or factor of the same length as <code>x</code>. Ignored if <code>x</code> is a table or data frame.</p>
</td></tr>
<tr><td><code id="chisqtestClust_+3A_id">id</code></td>
<td>
<p>a numeric vector or factor which identifies the clusters; ignored if <code>x</code> is a table or data frame.
The length of <code>id</code> must be the same as the length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="chisqtestClust_+3A_p">p</code></td>
<td>
<p>a vector of probabilities with length equal to the number of unique categories of <code>x</code>
if <code>x</code> is a vector, or equal to the number of columns of <code>x</code> if <code>x</code> is a table or data frame.</p>
</td></tr>
<tr><td><code id="chisqtestClust_+3A_variance">variance</code></td>
<td>
<p>character string specifying the method of variance estimation. Must be one of &quot;<code>sand.null</code>&quot;,
&quot;<code>sand.est</code>&quot;, &quot;<code>emp</code>&quot;, or &quot;<code>MoM</code>&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> is 2-dimensional table or data frame, or if <code>x</code> is a vector or factor and <code>y</code>
is not given, then the cluster-weighted <em>goodness-of-fit test</em> is performed. When <code>x</code> is a table
or data frame, the rows of <code>x</code> must give the aggregate category counts across the clusters. In this case,
the hypothesis tested is whether the marginal population probabilities equal those in <code>p</code>, or are all
equal if <code>p</code> is not given.
</p>
<p>When <code>x</code>, <code>y</code>, and <code>id</code> are all given as vectors or factors, the cluster-weighted
<em>chi-squared test of independence</em> is performed. The lengths of <code>x</code>, <code>y</code>, and <code>id</code>
must be equal. In this case, the hypothesis tested is that the joint probabilities of <code>x</code> and <code>y</code> are
equal to the product of the marginal probabilities.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>the degrees of freedom of the approximate chi-squared distribution of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed, and which variance estimation method was used.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data and the total number of clusters.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>the observed reweighted proportions.</p>
</td></tr>
<tr><td><code>expected</code></td>
<td>
<p>the expected proportions under the null hypothesis.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gregg, M., Datta, S., Lorenz, D. (2020) Variance estimation in tests of clustered categorical data
with informative cluster size.
<em>Statistical Methods in Medical Research</em>, doi:10.1177/0962280220928572.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen8)
## is the marginal extracurricular activity participation evenly distributed across categories?
## Goodness of Fit test using vectors.
chisqtestClust(x=screen8$activity, id=screen8$sch.id)

## Goodness of Fit test using table.
act.table &lt;- table(screen8$sch.id, screen8$activity)
chisqtestClust(act.table)

## test if extracurricular activity participation and gender are independent
chisqtestClust(screen8$gender, screen8$activity, screen8$sch.id)

</code></pre>

<hr>
<h2 id='cortestClust'>Test for Marginal Association Between Paired Clustered Data</h2><span id='topic+cortestClust'></span><span id='topic+cortestClust.default'></span><span id='topic+cortestClust.formula'></span>

<h3>Description</h3>

<p>Test for marginal association between paired samples in clustered data with potentially
informative cluster size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cortestClust(x, ...)

## Default S3 method:
cortestClust(
  x,
  y,
  id,
  method = c("pearson", "kendall", "spearman"),
  alternative = c("two.sided", "less", "greater"),
  conf.level = 0.95,
  ...
)

## S3 method for class 'formula'
cortestClust(formula, id, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cortestClust_+3A_x">x</code>, <code id="cortestClust_+3A_y">y</code></td>
<td>
<p>numeric vectors of data values.</p>
</td></tr>
<tr><td><code id="cortestClust_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="cortestClust_+3A_id">id</code></td>
<td>
<p>a vector or factor object which identifies the clusters. The length of <code>id</code> should be the
same as the number of observations.</p>
</td></tr>
<tr><td><code id="cortestClust_+3A_method">method</code></td>
<td>
<p>a character string indicating which correlation coefficient is to be used for the test.
One of &quot;<code>pearson</code>&quot;, &quot;<code>kendall</code>&quot;, or &quot;<code>spearman</code>&quot;. Can be abbreviated.</p>
</td></tr>
<tr><td><code id="cortestClust_+3A_alternative">alternative</code></td>
<td>
<p>indicates the alternative hypothesis and must be one of &quot;<code>two.sided</code>&quot;, &quot;<code>greater</code>&quot;,
or &quot;<code>less</code>&quot;.You can specify just the initial letter. &quot;<code>greater</code>&quot; corresponds to positive association,
&quot;<code>less</code>&quot; to negative association.</p>
</td></tr>
<tr><td><code id="cortestClust_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for the returned confidence interval.</p>
</td></tr>
<tr><td><code id="cortestClust_+3A_formula">formula</code></td>
<td>
<p>a formula of the form ~ u + v, where each of <code>u</code> and <code>v</code> are numeric variables
giving the data values for one sample. The samples must be of the sample length.</p>
</td></tr>
<tr><td><code id="cortestClust_+3A_data">data</code></td>
<td>
<p>an optional matrix or data frame containing variables in the formula <code>formula</code>. By default the
variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="cortestClust_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr><td><code id="cortestClust_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when data contain <code>NA</code>s. Defaults to
<code>getOption("na.action")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The three methods each estimate the marginal association between paired observations from
clustered data and compute a test of the value being zero.
</p>
<p>If <code>method</code> is &quot;<code>pearson</code>&quot; (&quot;<code>kendall</code>&quot;), the test statistic is based on the
Pearson product-moment (Kendall concordance coefficient) analog of Lorenz <em>et al.</em> (2011).
</p>
<p>If <code>method</code> is &quot;<code>spearman</code>&quot;, the test statistic
is based on the Spearman coefficient analog of Lorenz <em>et al.</em> (2018) modified for paired data.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the estimated measure of marginal association, with name &quot;<code>cluster-weighted cor</code>&quot;,
&quot;<code>cluster-weighted tau</code>&quot;, or &quot;<code>cluster-weighted rho</code>&quot; corresponding to the method employed.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the value of the association measure under the null hypothesis, always 0.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>a confidence interval for the measure of association.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating how the association was measured.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data and the total number of clusters.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Lorenz, D., Datta, S., Harkema, S. (2011) Marginal association measures for clustered data.
<em>Statistics in Medicine</em>, <b>30</b>, 3181&ndash;3191.
</p>
<p>Lorenz, D., Levy, S., Datta, S. (2018) Inferring marginal association with paired and unpaired
clustered data. <em>Stat. Methods Med. Res.</em>, <b>27</b>, 1806&ndash;1817.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen8)
## test if math and reading scores are marginally correlated using vectors
cortestClust(screen8$read, screen8$math, screen8$sch.id)

## formula interface
cortestClust(~ math + read, sch.id, data=screen8, method="kendall")

</code></pre>

<hr>
<h2 id='icsPlot'>Test of Marginal Proportion for Clustered Data</h2><span id='topic+icsPlot'></span>

<h3>Description</h3>

<p>Function to visualize informative cluster size. Plots within-cluster summary statistic from
quantitative variables against the size of each cluster. For categorical variables, a barplot of
category proportions for quantiles of cluster size is produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icsPlot(
  x,
  id,
  FUN = c("mean", "median", "var", "sd", "range", "IQR", "prop"),
  breaks,
  xlab = NULL,
  ylab = NULL,
  legend = c(TRUE, FALSE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="icsPlot_+3A_x">x</code></td>
<td>
<p>vector of data values. Alternatively a two-dimensional table or matrix.</p>
</td></tr>
<tr><td><code id="icsPlot_+3A_id">id</code></td>
<td>
<p>a vector which identifies the clusters, with length equal to length of <code>x</code>; ignored if <code>x</code> is a matrix or table.</p>
</td></tr>
<tr><td><code id="icsPlot_+3A_fun">FUN</code></td>
<td>
<p>the name of the function that produces the desired intra-cluster summary statistic.</p>
</td></tr>
<tr><td><code id="icsPlot_+3A_breaks">breaks</code></td>
<td>
<p>a single number giving the number of desired quantiles for the barplot of categorical variables with &gt;2 categories.</p>
</td></tr>
<tr><td><code id="icsPlot_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis, defaults to &quot;cluster size&quot;.</p>
</td></tr>
<tr><td><code id="icsPlot_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y axis, defaults to a description of <code>FUN</code> of <code>x</code>.</p>
</td></tr>
<tr><td><code id="icsPlot_+3A_legend">legend</code></td>
<td>
<p>a logical indicating whether a legend should be included in a barplot.</p>
</td></tr>
<tr><td><code id="icsPlot_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> is a matrix or table and <code>x</code> has exactly two columns, the first column should contain the cluster
sizes and the second column the respective intra-cluster summary statistic (e.g., mean, variance) that will be plotted
against cluster size.
</p>
<p>If <code>x</code> has more than two columns, the first column is assumed to contain the cluster size
and the subsequent columns the counts of intra-cluster observations belonging to the different categorical variable levels.
If there are exactly two categorical levels (e.g., <code>x</code> has exactly three columns), a scatterplot of the proportion of
intracluster observations belonging to the first category will be plotted against the cluster size. If the number of
categories is &gt; 2, a barplot of category proportions against quantiles of cluster size is produced.
</p>
<p>Standard graphical parameters can be passed to <code>icsPlot</code> through the <code>...</code> argument.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen8)
## VECTOR INPUT
## plot average math score by cluster size
icsPlot(x = screen8$math, id = screen8$sch.id, pch = 20)

## plot proportion of females by cluster size
icsPlot(screen8$gender, screen8$sch.id, pch = 20, main = "Female proportion by cluster size")

## barchart of activity proportion by quartile of cluster size
icsPlot(x = screen8$activity, id = screen8$sch.id)

## TABLE INPUT
## Plot intra-cluster variance of math score by cluster size
cl.size &lt;- as.numeric(table(screen8$sch.id))
tab1 &lt;- cbind(cl.size, aggregate(screen8$math, list(screen8$sch.id), var)[,2])
colnames(tab1) &lt;- c("cl.size", "variance")
icsPlot(x = tab1, pch = 17, main = "math score variance by cluster size")

## barchart of activity proportion across five quantiles of cluster size
tab2 &lt;- cbind(cl.size, table(screen8$sch.id, screen8$activity))
icsPlot(tab2, breaks = 5)

</code></pre>

<hr>
<h2 id='icstestClust'>Test for Informative Cluster Size</h2><span id='topic+icstestClust'></span>

<h3>Description</h3>

<p>Performs a test for informative cluster size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icstestClust(x, id, test.method = c("TF", "TCM"), B = 1000, print.it = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="icstestClust_+3A_x">x</code></td>
<td>
<p>a vector of numeric responses. Can also be a data frame.</p>
</td></tr>
<tr><td><code id="icstestClust_+3A_id">id</code></td>
<td>
<p>a vector or factor object which identifies the clusters; ignored if <code>x</code> is a data frame.
The length of <code>id</code> must be the same as the length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="icstestClust_+3A_test.method">test.method</code></td>
<td>
<p>character string specifying the method of construction for the test statistic.
Must be one of &quot;<code>TF</code>&quot; or &quot;<code>TCM</code>&quot;.</p>
</td></tr>
<tr><td><code id="icstestClust_+3A_b">B</code></td>
<td>
<p>the number of bootstrap iterations.</p>
</td></tr>
<tr><td><code id="icstestClust_+3A_print.it">print.it</code></td>
<td>
<p>a logical indicating whether to print the progression of bootstrap iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null is that the marginal distributions of the responses are independent of the cluster sizes.
A small p-value is evidence for the presence of informative cluster size.
</p>
<p>When <code>test.method = "TF"</code>, the test statistic is constructed based on differences between the null and
alternative distribution functions. &quot;<code>TF</code>&quot; is the suggested method when there are a large
number of unique cluster sizes and the number of clusters of each size is small. When <code>test.method = "TCM"</code>,
the test statistic is a multisample Cramer von Mises-based test. This method is recommended
when there are a small number of possible cluster sizes. See Nevalainen <em>et al.</em> (2017) for more details.
</p>
<p>When <code>x</code> is a data frame, the first column should contain values denoting cluster membership and
the second column the responses.
</p>
<p>This test is computationally intensive and can take significant time to execute. <code>print.it</code> defaults to
<code>TRUE</code> to identify the bootstrap progression.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed and the method of construction.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Nevalainen, J., Oja, H., Datta, S. (2017) Tests for informative cluster size using a novel balanced bootstrap scheme.
<em>Statistics in Medicine</em>, <b>36</b>, 2630&ndash;2640.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(screen8)
  ## using vectors
  ## test if cluster size is related to math scores
  icstestClust(screen8$math, screen8$sch.id, B=100)

  ## same test, but using a data frame and supressing iterations
  tdat &lt;- data.frame(screen8$sch.id, screen8$math)
  icstestClust(tdat, B=100, print.it = FALSE)

</code></pre>

<hr>
<h2 id='levenetestClust'>Reweighted Levene's Test for Homogeneity of Variance in Clustered Data</h2><span id='topic+levenetestClust'></span><span id='topic+levenetestClust.default'></span><span id='topic+levenetestClust.formula'></span>

<h3>Description</h3>

<p>Performs a reweighted test for homogeneity of marginal variances across intra-cluster groups in clustered data.
Appropriate for clustered data with cluster- or group size informativeness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>levenetestClust(y, ...)

## Default S3 method:
levenetestClust(y, group, id, center = c("median", "mean"), trim = NA, ...)

## S3 method for class 'formula'
levenetestClust(formula, id, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="levenetestClust_+3A_y">y</code></td>
<td>
<p>vector of numeric responses.</p>
</td></tr>
<tr><td><code id="levenetestClust_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="levenetestClust_+3A_group">group</code></td>
<td>
<p>vector or factor object defining groups.</p>
</td></tr>
<tr><td><code id="levenetestClust_+3A_id">id</code></td>
<td>
<p>vector or factor object denoting cluster membership for <code>y</code> responses.</p>
</td></tr>
<tr><td><code id="levenetestClust_+3A_center">center</code></td>
<td>
<p>The name of a function to compute the center of each group. If <code>mean</code>, the reweighted
group means will be used. The default <code>median</code> is the suggested measure of center, as it provides a more
robust test.</p>
</td></tr>
<tr><td><code id="levenetestClust_+3A_trim">trim</code></td>
<td>
<p>optional numeric argument taking values [0, 0.5] to specify the percentage trimmed mean.
Ignored if <code>center = median</code>.</p>
</td></tr>
<tr><td><code id="levenetestClust_+3A_formula">formula</code></td>
<td>
<p>a formula of the form <code>lhs ~ rhs</code> where <code>lhs</code> is a numeric variable giving the data values and
<code>rhs</code> a factor with two or more levels giving the corresponding groups.</p>
</td></tr>
<tr><td><code id="levenetestClust_+3A_data">data</code></td>
<td>
<p>an optional matrix or data frame containing variables in the formula <code>formula</code> and <code>id</code>.
By default the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="levenetestClust_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr><td><code id="levenetestClust_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when data contain <code>NA</code>s. Defaults to
<code>getOption("na.action")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis is that all levels of <code>group</code> have equal marginal variances.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>the degrees of freedom of the chi square distribution.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data and the total number of clusters.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gregg, M., Marginal methods and software for clustered data with cluster- and group-size informativeness.
PhD dissertation, University of Louisville, 2020.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen8)

## Do boys and girls have the same variability in math scores?
## Test using vectors
levenetestClust(y=screen8$math, group=screen8$gender, id=screen8$sch.id)

## Test using formula method
levenetestClust(math~gender, id=sch.id, data=screen8)

## Using 10% trimmed mean
levenetestClust(math~gender, id=sch.id, data=screen8, center="mean", trim=.1)

</code></pre>

<hr>
<h2 id='mcnemartestClust'>Test of Marginal Homogeneity for Clustered Data</h2><span id='topic+mcnemartestClust'></span>

<h3>Description</h3>

<p>Performs a test of marginal homogeneity of paired clustered data with potentially informative
cluster size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcnemartestClust(x, y, id, variance = c("MoM", "emp"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcnemartestClust_+3A_x">x</code>, <code id="mcnemartestClust_+3A_y">y</code></td>
<td>
<p>vector or factor objects of equal length.</p>
</td></tr>
<tr><td><code id="mcnemartestClust_+3A_id">id</code></td>
<td>
<p>a vector or factor object which identifies the clusters. The length of <code>id</code> must be the same
as the length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="mcnemartestClust_+3A_variance">variance</code></td>
<td>
<p>character string specifying the method of variance estimation. Must be one of &quot;<code>MoM</code>&quot;
or &quot;<code>emp</code>&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null is that the marginal probabilities of being classified into cells <code>[i,j]</code> and
<code>[j,i]</code> are equal.
</p>
<p>Arguments <code>x</code>, <code>y</code>, and <code>id</code> must be vectors or factors of the same length.
Incomplete cases are removed.
</p>
<p>When <code>variance</code> is <code>MoM</code>, a method of moments variance estimate evaluated under the null is used.
This is equivalent to the test by Durkalski <em>et al.</em> (2003). When <code>variance</code> is <code>emp</code>,
an empirical variance estimate is used. See Gregg (2020) for details.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>the degrees of freedom of the approximate chi-squared distribution of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed and which variance estimation method was used.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data and the total number of clusters.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Durkalski, V., Palesch, Y., Lipsitz, S., Rust, P. (2003). Analysis of clustered matched pair data.
<em>Statistics in Medicine</em>, <b>22</b>, 2417&ndash;2428.
</p>
<p>Gregg, M., Marginal methods and software for clustered data with cluster- and group-size informativeness.
PhD dissertation, University of Louisville, 2020.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen8)
## Is marginal proportion of students in lowest fitness category
## at the end of year equal to the beginning of year?
screen8$low.start &lt;- 1*(screen8$qfit.s=='Q1')
screen8$low.end &lt;- 1*(screen8$qfit=='Q1')
mcnemartestClust(screen8$low.start, screen8$low.end, screen8$sch.id)

</code></pre>

<hr>
<h2 id='onewaytestClust'>Test for Equal Marginal Means in Clustered Data</h2><span id='topic+onewaytestClust'></span><span id='topic+onewaytestClust.default'></span><span id='topic+onewaytestClust.formula'></span>

<h3>Description</h3>

<p>Test whether two or more intra-cluster groups have the same marginal means in clustered data. Reweighted to
correct for potential cluster- or group size informativeness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>onewaytestClust(x, ...)

## Default S3 method:
onewaytestClust(x, ...)

## S3 method for class 'formula'
onewaytestClust(formula, id, data, subset, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="onewaytestClust_+3A_x">x</code></td>
<td>
<p>a two-dimensional matrix or data frame containing the within-cluster group means, where rows are the clusters
and columns are the group means.</p>
</td></tr>
<tr><td><code id="onewaytestClust_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="onewaytestClust_+3A_formula">formula</code></td>
<td>
<p>a formula of the form <code>lhs</code> ~ <code>rhs</code>, where <code>lhs</code> is a numeric variable
giving the data values and <code>rhs</code> a numeric or factor with two or more levels giving the corresponding groups.</p>
</td></tr>
<tr><td><code id="onewaytestClust_+3A_id">id</code></td>
<td>
<p>a vector or factor object denoting cluster membership.</p>
</td></tr>
<tr><td><code id="onewaytestClust_+3A_data">data</code></td>
<td>
<p>an optional matrix or data frame containing variables in the formula <code>formula</code> and <code>id</code>.
By default the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="onewaytestClust_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis is that all levels of <code>group</code> have equal marginal means.
</p>
<p>If <code>x</code> is a matrix or data frame, the dimension of <code>x</code> should be MxK, where M is the
number of clusters and K is the number of groups. Each row of <code>x</code> corresponds to a cluster, where
the column values contain the respective group means from that cluster. Clusters which do not contain
observations in a particular group should have <code>NA</code> in the corresponding column.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the estimated marginal group means.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>the degrees of freedom of the chi square distribution.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data and the total number of clusters.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gregg, M., Marginal methods and software for clustered data with cluster- and group-size informativeness.
PhD dissertation, University of Louisville, 2020.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen8)
## do average reading scores differ across after-school activities?
## test using a table
read.tab &lt;- tapply(screen8$read, list(screen8$sch.id, screen8$activity), mean)
onewaytestClust(read.tab)

## test using formula method
onewaytestClust(read~activity, id=sch.id, data=screen8)

</code></pre>

<hr>
<h2 id='proptestClust'>Test of Marginal Proportion for Clustered Data</h2><span id='topic+proptestClust'></span>

<h3>Description</h3>

<p><code>proptestClust</code> can be used for testing the null that the marginal proportion
(probability of success) is equal to certain given values in clustered data with potentially informative
cluster size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proptestClust(x, id, p = NULL, alternative = c("two.sided", "less", "greater"),
             variance = c("sand.null", "sand.est", "emp", "MoM"), conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="proptestClust_+3A_x">x</code></td>
<td>
<p>a vector of binary indicators denoting success/failure of each observation, or a two-dimensional table
(or matrix) with 2 columns giving the aggregate counts of failures and successes (respectively) across clusters.</p>
</td></tr>
<tr><td><code id="proptestClust_+3A_id">id</code></td>
<td>
<p>a vector which identifies the clusters; ignored if <code>x</code> is a matrix or table.
The length of <code>id</code> must be the same as the length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="proptestClust_+3A_p">p</code></td>
<td>
<p>the null hypothesized value of the marginal proportion. Must be a single number greater than 0 and less
than 1.</p>
</td></tr>
<tr><td><code id="proptestClust_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis. Must be one of &quot;<code>two.sided</code>&quot;,
&quot;<code>greater</code>&quot;, or &quot;<code>less</code>&quot;. You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="proptestClust_+3A_variance">variance</code></td>
<td>
<p>character string specifying the method of variance estimation. Must be one of &quot;<code>sand.null</code>&quot;,
&quot;<code>sand.est</code>&quot;, &quot;<code>emp</code>&quot;, or &quot;<code>MoM</code>&quot;.</p>
</td></tr>
<tr><td><code id="proptestClust_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level of the returned confidence interval. Must be a single number between
0 and 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>p</code> is not given, the null tested is that the underlying marginal probability of
success is .5.
</p>
<p>The <code>variance</code> argument allows the user to specify the method of variance estimation, selecting from
the sandwich estimate evaluated at the null hypothesis (<code>sand.null</code>), the sandwich estimate evaluated at the
cluster-weighted proportion (<code>sand.est</code>), the empirical estimate (<code>emp</code>), or the method of moments
estimate (<code>MoM</code>).
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the estimated marginal proportion.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the value of <code>p</code> under the null hypothesis.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>a confidence interval for the true marginal proportion.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed and method of variance estimation.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data and the total number of clusters.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gregg, M., Datta, S., Lorenz, D. (2020) Variance Estimation in Tests of Clustered Categorical Data
with Informative Cluster Size.
<em>Statistical Methods in Medical Research</em>, doi:10.1177/0962280220928572.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen8)
## using vectors
## suppose math proficiency is determined by score &gt;= 65
## is the marginal proportion of students proficient in math at least 75%?
screen8$math.p &lt;- 1*(screen8$math&gt;=65)
proptestClust(screen8$math.p, screen8$sch.id, p = .75, alternative = "great")

## using table and empirical variance; two-sided CI
## (note that "failure" counts are the first column and "success" counts are the second column)
mathp.tab &lt;- table(screen8$sch.id, screen8$math.p)
proptestClust(mathp.tab, variance="emp", p=.75)

## when all clusters have a size of 1, results will be in general correspondence with
## that of the classical analogue test
set.seed(123)
x &lt;- rbinom(100, size = 1, p = 0.7)
id &lt;- 1:100
proptestClust(x, id)
prop.test(sum(x), length(x))

</code></pre>

<hr>
<h2 id='screen8'>Example data for informative cluster size</h2><span id='topic+screen8'></span>

<h3>Description</h3>

<p>Simulated hypothetical clustered data created for illustration of functions in the <code>htestClust</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(screen8)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2224 rows and 12 columns:
</p>

<dl>
<dt>sch.id</dt><dd><p>identification variable for school (clusters).</p>
</dd>
<dt>stud.id</dt><dd><p>identification variable for students within schools (observations within clusters).</p>
</dd>
<dt>age</dt><dd><p>student age in years.</p>
</dd>
<dt>gender</dt><dd><p>binary student gender.</p>
</dd>
<dt>height</dt><dd><p>student height in inches.</p>
</dd>
<dt>weight</dt><dd><p>student weight in lbs.</p>
</dd>
<dt>math</dt><dd><p>score from standardized math test.</p>
</dd>
<dt>read</dt><dd><p>score from standardized reading test.</p>
</dd>
<dt>phq2</dt><dd><p>ordinal (0-6) score from a mental health screening; higher scores correspond to higher levels of depression.</p>
</dd>
<dt>qfit</dt><dd><p>age-adjusted fitness quartile from physical health assessment at end of school year.</p>
</dd>
<dt>qfit.s</dt><dd><p>age-adjusted fitness quartile from physical health assessment at beginning of school year.</p>
</dd>
<dt>activity</dt><dd><p>student's primary after-school activity.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Hypothetical data simulated for the following scenario.
An urban school district has collected demographic, biometric, and academic performance data
from graduating 8th grade students. <code>screen8</code> contains a sample of this data from 2224 students across
73 schools. Student-level observations are clustered within schools.
The school district has implemented an incentive program in which schools with higher participation rates are
prioritized for classroom and technology upgrades. Cluster size could be informative in this data, as resource-poor
schools might have higher participation rates (larger cluster size), but also tend to have worse health metrics and
lower standardized test scores.
</p>


<h3>Author(s)</h3>

<p>Mary Gregg
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen8)
head(screen8)

## plot average math scores by cluster size
cl.size &lt;- as.numeric(table(screen8$sch.id))
ave.math &lt;- tapply(screen8$math, list(screen8$sch.id), mean)
plot(cl.size, ave.math)

</code></pre>

<hr>
<h2 id='ttestClust'>Test of Marginal Means in Clustered Data</h2><span id='topic+ttestClust'></span><span id='topic+ttestClust.default'></span><span id='topic+ttestClust.formula'></span>

<h3>Description</h3>

<p>Performs one and two sample tests of marginal means in clustered data, reweighted to correct
for potential cluster- or group-size informativeness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttestClust(x, ...)

## Default S3 method:
ttestClust(
  x,
  y = NULL,
  idx,
  idy = NULL,
  alternative = c("two.sided", "less", "greater"),
  mu = 0,
  paired = FALSE,
  conf.level = 0.95,
  ...
)

## S3 method for class 'formula'
ttestClust(formula, id, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ttestClust_+3A_x">x</code>, <code id="ttestClust_+3A_y">y</code></td>
<td>
<p>numeric vectors of data values.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_idx">idx</code></td>
<td>
<p>vector or factor object denoting cluster membership for <code>x</code> observations (or cluster
membership for paired observations when <code>paired</code> is <code>TRUE</code>). Length must be equal
to length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_idy">idy</code></td>
<td>
<p>vector or factor object denoting cluster membership for <code>y</code> observations. Length must be equal
to length of <code>y</code></p>
</td></tr>
<tr><td><code id="ttestClust_+3A_alternative">alternative</code></td>
<td>
<p>indicates the alternative hypothesis and must be one of &quot;<code>two.sided</code>&quot;, &quot;<code>greater</code>&quot;,
or &quot;<code>less</code>&quot;.You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_mu">mu</code></td>
<td>
<p>a number specifying an optional parameter used to form the null hypothesis.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_paired">paired</code></td>
<td>
<p>a logical indicating whether <code>x</code> and <code>y</code> are paired.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level of the interval.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_formula">formula</code></td>
<td>
<p>a formula of the form <code>lhs ~ rhs</code> where <code>lhs</code> is a numeric variable giving the data values and
<code>rhs</code> a factor with two levels giving the corresponding groups.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_id">id</code></td>
<td>
<p>a vector or factor giving the corresponding cluster membership.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_data">data</code></td>
<td>
<p>an optional matrix or data frame containing variables in the formula <code>formula</code> and <code>id</code>.
By default the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr><td><code id="ttestClust_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when data contain <code>NA</code>s. Defaults to
<code>getOption("na.action")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula interface is only applicable for the 2-sample tests.
</p>
<p>If <code>paired</code> is <code>TRUE</code> then <code>x</code>, <code>y</code>, and <code>idx</code> must be given and be of the same length.
<code>idy</code> is ignored.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>a confidence interval for the mean appropriate to the specified alternative hypothesis</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the estimated mean or difference in means, depending on whether it was a one-sample or two-sample test.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the specified hypothesized value of the mean or mean difference.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating what type of reweighted test of means was performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data and the total number of clusters.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gregg, M., Marginal methods and software for clustered data with cluster- and group-size informativeness.
PhD dissertation, University of Louisville, 2020.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen8)
## One sample test
## Test if marginal math scores are equal to 70
ttestClust(x=screen8$math, idx=screen8$sch.id, mu = 70)

## paired test
## Test equality of marginal means in math and reading scores
ttestClust(x=screen8$math, y=screen8$read, idx=screen8$sch.id, paired=TRUE)

## unpaired test
## Test if boys and girls have equal marginal math scores
boys &lt;- subset(screen8, gender=='M')
girls &lt;- subset(screen8, gender=='F')
ttestClust(x=boys$math, y=girls$math, idx=boys$sch.id, idy=girls$sch.id)

## unpaired test using formula method
ttestClust(math~gender, id=sch.id, data=screen8)

</code></pre>

<hr>
<h2 id='vartestClust'>Reweighted Test to Compare Two Variances in Clustered Data</h2><span id='topic+vartestClust'></span><span id='topic+vartestClust.default'></span><span id='topic+vartestClust.formula'></span>

<h3>Description</h3>

<p>Performs a reweighted test to compare marginal variances of intra-cluster groups in clustered data.
Appropriate for clustered data with cluster- or group-size informativeness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vartestClust(x, ...)

## Default S3 method:
vartestClust(
  x,
  y,
  idx,
  idy,
  difference = 0,
  alternative = c("two.sided", "less", "greater"),
  conf.level = 0.95,
  ...
)

## S3 method for class 'formula'
vartestClust(formula, id, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vartestClust_+3A_x">x</code>, <code id="vartestClust_+3A_y">y</code></td>
<td>
<p>numeric vectors of data values.</p>
</td></tr>
<tr><td><code id="vartestClust_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="vartestClust_+3A_idx">idx</code></td>
<td>
<p>vector or factor object denoting cluster membership for <code>x</code> observations.
Length must be equal to length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="vartestClust_+3A_idy">idy</code></td>
<td>
<p>vector or factor object denoting cluster membership for <code>y</code> observations. Length must be equal
to length of <code>y</code></p>
</td></tr>
<tr><td><code id="vartestClust_+3A_difference">difference</code></td>
<td>
<p>the hypothesized difference of the marginal population variances of <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code id="vartestClust_+3A_alternative">alternative</code></td>
<td>
<p>indicates the alternative hypothesis and must be one of &quot;<code>two.sided</code>&quot;, &quot;<code>greater</code>&quot;,
or &quot;<code>less</code>&quot;.You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="vartestClust_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level of the interval.</p>
</td></tr>
<tr><td><code id="vartestClust_+3A_formula">formula</code></td>
<td>
<p>a formula of the form <code>lhs ~ rhs</code> where <code>lhs</code> is a numeric variable giving the data values and
<code>rhs</code> a factor with two levels giving the corresponding groups.</p>
</td></tr>
<tr><td><code id="vartestClust_+3A_id">id</code></td>
<td>
<p>a vector or factor giving the corresponding cluster membership.</p>
</td></tr>
<tr><td><code id="vartestClust_+3A_data">data</code></td>
<td>
<p>an optional matrix or data frame containing variables in the formula <code>formula</code> and <code>id</code>.
By default the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="vartestClust_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr><td><code id="vartestClust_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when data contain <code>NA</code>s. Defaults to
<code>getOption("na.action")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis is that the difference of the marginal variances of the populations of
intra-cluster groups from which <code>x</code> and <code>y</code> were drawn is equal to <code>difference</code>.
</p>
<p>Using the default method, <code>difference</code> is the difference of the reweighted sample variances of <code>x</code>
and <code>y</code>. When using the formula method, the order of the difference is determined by the order of the
factor levels of <code>rhs</code>.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>a confidence interval for the difference of the population marginal variances.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the difference in reweighted sample variances of <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the difference of population marginal variances under the null.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data and the total number of clusters.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gregg, M., Marginal methods and software for clustered data with cluster- and group-size informativeness.
PhD dissertation, University of Louisville, 2020.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(screen8)
boys &lt;- subset(screen8, gender=='M')
girls &lt;- subset(screen8, gender=='F')

## Do boys and girls have the same variability in math scores?
## Test using vectors
vartestClust(x=boys$math, y=girls$math, idx=boys$sch.id, idy=girls$sch.id)

## Test using formula method.
vartestClust(math~gender, id=sch.id, data=screen8)

## Note that in this example, the sign of the estimate returned when using the formula
## method is opposite to that when the test was performed using vectors. This is due to
## the order of the gender factor levels

</code></pre>

<hr>
<h2 id='wilcoxtestClust'>Rank Sum and Signed Rank Tests for Clustered Data</h2><span id='topic+wilcoxtestClust'></span><span id='topic+wilcoxtestClust.default'></span><span id='topic+wilcoxtestClust.formula'></span>

<h3>Description</h3>

<p>Performs a one-sample or paired cluster-weighted signed rank test, or a cluster- or
group-weighted rank sum test. These tests are appropriate for clustered data with
potentially informative cluster size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wilcoxtestClust(x, ...)

## Default S3 method:
wilcoxtestClust(
  x,
  y = NULL,
  idx,
  idy = NULL,
  alternative = c("two.sided", "less", "greater"),
  mu = 0,
  paired = FALSE,
  method = c("cluster", "group"),
  ...
)

## S3 method for class 'formula'
wilcoxtestClust(formula, id, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wilcoxtestClust_+3A_x">x</code>, <code id="wilcoxtestClust_+3A_y">y</code></td>
<td>
<p>numeric vectors of data values.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_idx">idx</code></td>
<td>
<p>vector or factor object denoting cluster membership for <code>x</code> observations (or cluster
membership for paired observations when <code>paired</code> is <code>TRUE</code>). Length must be equal
to length of <code>x</code>.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_idy">idy</code></td>
<td>
<p>vector or factor object denoting cluster membership for <code>y</code> observations. Length must be equal
to length of <code>y</code></p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_alternative">alternative</code></td>
<td>
<p>indicates the alternative hypothesis and must be one of &quot;<code>two.sided</code>&quot;, &quot;<code>greater</code>&quot;,
or &quot;<code>less</code>&quot;.You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_mu">mu</code></td>
<td>
<p>a number specifying an optional parameter used to form the null hypothesis. Ignored when
performing a rank-sum test. See 'Details'.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_paired">paired</code></td>
<td>
<p>a logical indicating whether <code>x</code> and <code>y</code> are paired. When <code>TRUE</code>, the
cluster-weighted signed rank test is performed.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_method">method</code></td>
<td>
<p>a character string specifying the method of rank sum test to be performed. See 'Details'.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_formula">formula</code></td>
<td>
<p>a formula of the form <code>lhs</code> ~ <code>rhs</code>, where <code>lhs</code> is a numeric variable
giving the data values and <code>rhs</code> a numeric or factor with two levels giving the corresponding groups.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_id">id</code></td>
<td>
<p>a vector or factor object denoting cluster membership.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_data">data</code></td>
<td>
<p>an optional matrix or data frame containing variables in the formula <code>formula</code> and <code>id</code>.
By default the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr><td><code id="wilcoxtestClust_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when data contain <code>NA</code>s. Defaults to
<code>getOption("na.action")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula interface is only applicable for the 2-sample rank-sum tests.
</p>
<p>If only <code>x</code> and <code>idx</code> are given, a cluster-weighted signed rank test of the null that
the distribution of <code>x</code> is symmetric about <code>mu</code> is performed.
</p>
<p>If <code>x</code> and <code>y</code> are given and <code>paired</code> is <code>TRUE</code>, only <code>idx</code> is necessary (<code>idy</code>
is ignored). In this case, a cluster-weighted signed-rank test of the null that the distribution of <code>x - y</code>
is symmetric about <code>mu</code> is performed.
</p>
<p>When <code>method</code> is <code>cluster</code>, the cluster-weighted rank sum test of Datta and Satten (2005) is performed.
The data must have complete intra-cluster group distribution (i.e., all clusters must contain observations
belonging to both groups) for this test to be performed.
</p>
<p>When <code>method</code> is <code>group</code>, the group-weighted rank-sum test of Dutta and Datta (2015) is performed.
This test is appropriate for clustered data with potentially informative intra-cluster group size. Incomplete
intra-cluster group distribution is permitted.
</p>
<p>For the rank sum tests, the null is that the two groups follow the same marginal distribution. <code>mu</code> is
ignored when performing these tests.
</p>
<p>The tests performed by this function involve computation of reweighted empirical CDFs. This is computationally
intensive and can result in lengthy execution time for large data sets.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the location parameter <code>mu</code>. Always 0 for rank sum test.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data and the total number of clusters.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the test performed and method of construction.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>the number of clusters.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Datta, S., Satten, G. (2005) Rank-sum tests for clustered data.
<em>J. Am. Stat. Assoc.</em>, <b>100</b>, 908&ndash;915.
</p>
<p>Datta, S., Satten, G. (2008) A signed-rank test for clustered data.
<em>Biometrics</em>, <b>64</b>, 501&ndash;507.
</p>
<p>Dutta, S., Datta, S. (2015) A rank-sum test for clustered data when the number of subjects in a
group within a cluster is informative. <em>Biometrics</em>, <b>72</b>, 432&ndash;440.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(screen8)
  ## One-sample signed rank test
  wilcoxtestClust(x=screen8$math, idx=screen8$sch.id, mu=70)

  ## Paired signed rank test
  wilcoxtestClust(x=screen8$math, y=screen8$read, idx=screen8$sch.id, paired=TRUE, mu=10)

  ## Cluster-weighted rank sum test
  wilcoxtestClust(math~gender, id=sch.id, data=screen8)


  ## Group-weighted rank sum test
  boys &lt;- subset(screen8, gender=='M')
  girls &lt;- subset(screen8, gender=='F')
  wilcoxtestClust(x=boys$math, y=girls$math, idx=boys$sch.id, idy=girls$sch.id, method="group")

  ## Group-weighted rank sum test using formula method
  wilcoxtestClust(math~gender, id=sch.id, data=screen8, method="group")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
