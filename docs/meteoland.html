<!DOCTYPE html><html><head><title>Help for package meteoland</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {meteoland}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_topo'><p>Add topography data to meteo object</p></a></li>
<li><a href='#complete_meteo'><p>Complete missing meteo variables</p></a></li>
<li><a href='#create_meteo_interpolator'><p>Meteoland interpolator creation</p></a></li>
<li><a href='#defaultInterpolationParams'><p>Default interpolation parameters</p></a></li>
<li><a href='#get_interpolation_params'><p>Retrieving interpolation parameters from interpolator object</p></a></li>
<li><a href='#humidity_relative2dewtemperature'><p>Humidity conversion tools</p></a></li>
<li><a href='#interpolate_data'><p>Interpolation process for spatial data</p></a></li>
<li><a href='#interpolation_cross_validation'><p>Calibration and validation of interpolation procedures</p></a></li>
<li><a href='#interpolation_precipitation'><p>Low-level interpolation functions</p></a></li>
<li><a href='#meteoland_interpolator_example'><p>Example interpolator object</p></a></li>
<li><a href='#meteoland_meteo_example'><p>Example data set for meteo data from weather stations</p></a></li>
<li><a href='#meteoland_meteo_no_topo_example'><p>Example data set for meteo data from weather stations, without topography</p></a></li>
<li><a href='#meteoland_topo_example'><p>Example data set for topography data from weather stations, without meteo</p></a></li>
<li><a href='#meteoland-package'><p>meteoland: Landscape Meteorology Tools</p></a></li>
<li><a href='#meteospain2meteoland'><p>From meteospain to meteoland meteo objects</p></a></li>
<li><a href='#penman'><p>Potential evapotranspiration</p></a></li>
<li><a href='#points_to_interpolate_example'><p>Example data set of points for interpolation of weather variables</p></a></li>
<li><a href='#precipitation_concentration'><p>Precipitation daily concentration</p></a></li>
<li><a href='#precipitation_rainfall_erosivity'><p>Precipitation rainfall erosivity</p></a></li>
<li><a href='#radiation_julianDay'><p>Solar radiation utility functions</p></a></li>
<li><a href='#raster_to_interpolate_example'><p>Example raster data set for interpolation of weather variables</p></a></li>
<li><a href='#read_interpolator'><p>Read interpolator files</p></a></li>
<li><a href='#set_interpolation_params'><p>Setting interpolation parameters in an interpolator object</p></a></li>
<li><a href='#summarise_interpolated_data'><p>Summarise interpolated data by temporal dimension</p></a></li>
<li><a href='#summarise_interpolator'><p>Summarise interpolator objects by temporal dimension</p></a></li>
<li><a href='#utils_saturationVP'><p>Physical utility functions</p></a></li>
<li><a href='#with_meteo'><p>Ensure meteo object is ready to create an interpolator object</p></a></li>
<li><a href='#worldmet2meteoland'><p>From worldmet to meteoland meteo objects</p></a></li>
<li><a href='#write_interpolator'><p>Write the interpolator object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Landscape Meteorology Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-29</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to estimate weather variables at any position of a landscape [De Caceres et al. (2018) &lt;<a href="https://doi.org/10.1016%2Fj.envsoft.2018.08.003">doi:10.1016/j.envsoft.2018.08.003</a>&gt;].</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://emf-creaf.github.io/meteoland/index.html">https://emf-creaf.github.io/meteoland/index.html</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, sf, stars, stats, Rcpp, units, lifecycle, cli, dplyr,
tidyr, rlang, assertthat, purrr, ncdfgeom, ncmeta, lubridate,
cubelyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), meteospain, worldmet,
tibble</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-29 11:46:08 UTC; miquel</td>
</tr>
<tr>
<td>Author:</td>
<td>Miquel De Cáceres <a href="https://orcid.org/0000-0001-7132-2080"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Víctor Granda <a href="https://orcid.org/0000-0002-0469-1991"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Nicolas Martin <a href="https://orcid.org/0000-0001-7574-0108"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Antoine Cabon <a href="https://orcid.org/0000-0001-6426-1726"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Miquel De Cáceres &lt;miquelcaceres@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-29 12:30:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_topo'>Add topography data to meteo object</h2><span id='topic+add_topo'></span>

<h3>Description</h3>

<p>Add topography data to meteo object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_topo(meteo, topo, verbose = getOption("meteoland_verbosity", TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_topo_+3A_meteo">meteo</code></td>
<td>
<p>meteo object</p>
</td></tr>
<tr><td><code id="add_topo_+3A_topo">topo</code></td>
<td>
<p>topo object</p>
</td></tr>
<tr><td><code id="add_topo_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the function must show messages and info.
Default value checks <code>"meteoland_verbosity"</code> option and if not set, defaults
to TRUE. It can be turned off for the function with FALSE, or session wide with
<code>options(meteoland_verbosity = FALSE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>When using meteo data without topography info to create an interpolator,
topography must be added
</p>


<h3>Value</h3>

<p>meteo with the topography info added
</p>


<h3>See Also</h3>

<p>Other interpolator functions:
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a>()</code>,
<code><a href="#topic+get_interpolation_params">get_interpolation_params</a>()</code>, <code><a href="#topic+read_interpolator">read_interpolator</a>()</code>,
<code><a href="#topic+set_interpolation_params">set_interpolation_params</a>()</code>, <code><a href="#topic+with_meteo">with_meteo</a>()</code>,
<code><a href="#topic+write_interpolator">write_interpolator</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example meteo
data(meteoland_meteo_no_topo_example)
# example topo
data(meteoland_topo_example)
# add topo
with_meteo(meteoland_meteo_no_topo_example) |&gt;
  add_topo(meteoland_topo_example)

</code></pre>

<hr>
<h2 id='complete_meteo'>Complete missing meteo variables</h2><span id='topic+complete_meteo'></span>

<h3>Description</h3>

<p>Calculates missing values of relative humidity, radiation and potential
evapotranspiration from a data frame with daily values of
minimum/maximum/mean temperature and precipitation. The function
takes a meteo object (with meteoland names) and complete any
missing variable if it is possible
</p>


<h3>Usage</h3>

<pre><code class='language-R'>complete_meteo(meteo, verbose = getOption("meteoland_verbosity", TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="complete_meteo_+3A_meteo">meteo</code></td>
<td>
<p>meteoland weather data</p>
</td></tr>
<tr><td><code id="complete_meteo_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the function must show messages and info.
Default value checks <code>"meteoland_verbosity"</code> option and if not set, defaults
to TRUE. It can be turned off for the function with FALSE, or session wide with
<code>options(meteoland_verbosity = FALSE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>#' The function fills values for humidity, radiation and PET only if they are
missing in the input data frame. If a column 'SpecificHumidity' is present
in the input data, relative humidity is calculated from it. Otherwise,
relative humidity is calculated assuming that dew point temperature equals
the minimum temperature. Potential solar radiation is calculated from
latitude, slope and aspect. Incoming solar radiation is then corrected
following Thornton &amp; Running (1999) and potential evapotranspiration
following Penman (1948).
</p>


<h3>Value</h3>

<p>the same <code>meteo</code> data provided with the the variables completed
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>
<p>Victor Granda García, EMF-CREAF
</p>


<h3>References</h3>

<p>Thornton, P.E., Running, S.W., 1999. An improved algorithm for
estimating incident daily solar radiation from measurements of temperature,
humidity, and precipitation. Agric. For. Meteorol. 93, 211-228.
</p>
<p>Penman, H. L. 1948. Natural evaporation from open water, bare soil and
grass. Proceedings of the Royal Society of London. Series A. Mathematical
and Physical Sciences, 193, 120-145.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# example data
data("meteoland_meteo_example")

# remove MinRelativeHumidity
meteoland_meteo_example$MinRelativeHumidity &lt;- NULL
# complete vars
completed_meteo &lt;- complete_meteo(meteoland_meteo_example)
# check MinRelativeHumidity
completed_meteo$MinRelativeHumidity


</code></pre>

<hr>
<h2 id='create_meteo_interpolator'>Meteoland interpolator creation</h2><span id='topic+create_meteo_interpolator'></span>

<h3>Description</h3>

<p>Function to create the meteoland interpolator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_meteo_interpolator(
  meteo_with_topo,
  params = NULL,
  verbose = getOption("meteoland_verbosity", TRUE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_meteo_interpolator_+3A_meteo_with_topo">meteo_with_topo</code></td>
<td>
<p>Meteo object, as returned by <code><a href="#topic+with_meteo">with_meteo</a></code></p>
</td></tr>
<tr><td><code id="create_meteo_interpolator_+3A_params">params</code></td>
<td>
<p>Interpolation parameters as a list. Typically the result of
<code><a href="#topic+defaultInterpolationParams">defaultInterpolationParams</a></code>.</p>
</td></tr>
<tr><td><code id="create_meteo_interpolator_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the function must show messages and info.
Default value checks <code>"meteoland_verbosity"</code> option and if not set, defaults
to TRUE. It can be turned off for the function with FALSE, or session wide with
<code>options(meteoland_verbosity = FALSE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes meteorology information and a list of interpolation
parameters and creates the interpolator object to be ready to use.
</p>


<h3>Value</h3>

<p>an interpolator object (stars)
</p>


<h3>Author(s)</h3>

<p>Victor Granda García, EMF-CREAF
</p>
<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>


<h3>See Also</h3>

<p>Other interpolator functions: <code><a href="#topic+add_topo">add_topo</a>()</code>,
<code><a href="#topic+get_interpolation_params">get_interpolation_params</a>()</code>, <code><a href="#topic+read_interpolator">read_interpolator</a>()</code>,
<code><a href="#topic+set_interpolation_params">set_interpolation_params</a>()</code>, <code><a href="#topic+with_meteo">with_meteo</a>()</code>,
<code><a href="#topic+write_interpolator">write_interpolator</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example meteo data
data(meteoland_meteo_example)

# create the interpolator with default params
with_meteo(meteoland_meteo_example) |&gt;
  create_meteo_interpolator()

# create the interpolator with some params changed
with_meteo(meteoland_meteo_example) |&gt;
  create_meteo_interpolator(params = list(debug = TRUE))

</code></pre>

<hr>
<h2 id='defaultInterpolationParams'>Default interpolation parameters</h2><span id='topic+defaultInterpolationParams'></span>

<h3>Description</h3>

<p>Returns a list with the default parameterization for interpolation. Most
parameter values are set according to Thornton et al. (1997).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defaultInterpolationParams()
</code></pre>


<h3>Value</h3>

<p>A list with the following items (default values in brackets):
</p>
 <ul>
<li><p><code>initial_Rp [= 140000]</code>: Initial truncation radius.
</p>
</li>
<li><p><code>iterations [= 3]</code>: Number of station density iterations.
</p>
</li>
<li><p><code>alpha_MinTemperature [= 3.0]</code>: Gaussian shape parameter for
minimum temperature. </p>
</li>
<li><p><code>alpha_MaxTemperature [= 3.0]</code>: Gaussian
shape parameter for maximum temperature. </p>
</li>
<li><p><code>alpha_DewTemperature [=
3.0]</code>: Gaussian shape parameter for dew-point temperature.
</p>
</li>
<li><p><code>alpha_PrecipitationEvent [= 5.0]</code>: Gaussian shape parameter for
precipitation events. </p>
</li>
<li><p><code>alpha_PrecipitationAmount [= 5.0]</code>:
Gaussian shape parameter for the regression of precipitation amounts.
</p>
</li>
<li><p><code>alpha_Wind [= 3.0]</code>: Gaussian shape parameter for wind.
</p>
</li>
<li><p><code>N_MinTemperature [= 30]</code>: Average number of stations with
non-zero weights for minimum temperature. </p>
</li>
<li><p><code>N_MaxTemperature [=
30]</code>: Average number of stations with non-zero weights for maximum
temperature. </p>
</li>
<li><p><code>N_DewTemperature [= 30]</code>: Average number of stations
with non-zero weights for dew-point temperature.
</p>
</li>
<li><p><code>N_PrecipitationEvent [= 5]</code>: Average number of stations with
non-zero weights for precipitation events. </p>
</li>
<li><p><code>N_PrecipitationAmount
[= 20]</code>: Average number of stations with non-zero weights for the regression
of precipitation amounts. </p>
</li>
<li><p><code>N_Wind [= 2]</code>: Average number of
stations with non-zero weights for wind. </p>
</li>
<li><p><code>St_Precipitation [= 5]</code>:
Number of days for the temporal smoothing of precipitation.
</p>
</li>
<li><p><code>St_TemperatureRange [= 15]</code>: Number of days for the temporal
smoothing of temperature range. </p>
</li>
<li><p><code>pop_crit [= 0.50]</code>: Critical
precipitation occurrence parameter. </p>
</li>
<li><p><code>f_max [= 0.6]</code>: Maximum value
for precipitation regression extrapolations (0.6 equals to a maximum of 4
times extrapolation). </p>
</li>
<li><p><code>wind_height [= 10]</code>: Wind measurement
height (in m). </p>
</li>
<li><p><code>wind_roughness_height [= 0.001]</code>: Wind roughness
height (in m), for PET calculations. </p>
</li>
<li><p><code>penman_albedo [= 0.25]</code>: Albedo
for PET calculations. </p>
</li>
<li><p><code>penman_windfun [= "1956"]</code>: Wind speed function version,
either &quot;1948&quot; or &quot;1956&quot;, for PET calculation. </p>
</li>
<li><p><code>debug [= FALSE]</code>: Boolean flag to show extra
console output. </p>
</li></ul>



<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Thornton, P.E., Running, S.W., White, M. A., 1997. Generating
surfaces of daily meteorological variables over large regions of complex
terrain. J. Hydrol. 190, 214–251. doi:10.1016/S0022-1694(96)03128-9.
</p>
<p>De Caceres M, Martin-StPaul N, Turco M, Cabon A, Granda V (2018) Estimating
daily meteorological data and downscaling climate models over landscapes.
Environmental Modelling and Software 108: 186-196.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interpolate_data">interpolate_data</a></code>
</p>

<hr>
<h2 id='get_interpolation_params'>Retrieving interpolation parameters from interpolator object</h2><span id='topic+get_interpolation_params'></span>

<h3>Description</h3>

<p>Retrieve the parameter list from and interpolator object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_interpolation_params(interpolator)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_interpolation_params_+3A_interpolator">interpolator</code></td>
<td>
<p>interpolator object as returned by
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The complete parameter list from the interpolator object
</p>


<h3>Author(s)</h3>

<p>Victor Granda García, EMF-CREAF
</p>


<h3>See Also</h3>

<p>Other interpolator functions: <code><a href="#topic+add_topo">add_topo</a>()</code>,
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a>()</code>,
<code><a href="#topic+read_interpolator">read_interpolator</a>()</code>, <code><a href="#topic+set_interpolation_params">set_interpolation_params</a>()</code>,
<code><a href="#topic+with_meteo">with_meteo</a>()</code>, <code><a href="#topic+write_interpolator">write_interpolator</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example interpolator
data(meteoland_interpolator_example)
# get the params from the interpolator
get_interpolation_params(meteoland_interpolator_example)

</code></pre>

<hr>
<h2 id='humidity_relative2dewtemperature'>Humidity conversion tools</h2><span id='topic+humidity_relative2dewtemperature'></span><span id='topic+humidity_dewtemperature2relative'></span><span id='topic+humidity_specific2relative'></span><span id='topic+humidity_relative2specific'></span>

<h3>Description</h3>

<p>Functions to transform relative humidity to specific humidity or dew point
temperature and viceversa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>humidity_relative2dewtemperature(Tc, HR)

humidity_dewtemperature2relative(Tc, Td, allowSaturated = FALSE)

humidity_specific2relative(Tc, HS, allowSaturated = FALSE)

humidity_relative2specific(Tc, HR)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="humidity_relative2dewtemperature_+3A_tc">Tc</code></td>
<td>
<p>A numeric vector of temperature in degrees Celsius.</p>
</td></tr>
<tr><td><code id="humidity_relative2dewtemperature_+3A_hr">HR</code></td>
<td>
<p>A numeric vector of relative humidity (in %).</p>
</td></tr>
<tr><td><code id="humidity_relative2dewtemperature_+3A_td">Td</code></td>
<td>
<p>A numeric vector of dew temperature in degrees Celsius.</p>
</td></tr>
<tr><td><code id="humidity_relative2dewtemperature_+3A_allowsaturated">allowSaturated</code></td>
<td>
<p>Logical flag to allow values over 100%</p>
</td></tr>
<tr><td><code id="humidity_relative2dewtemperature_+3A_hs">HS</code></td>
<td>
<p>A numeric vector of specific humidity (unitless).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with specific or relative humidity.
</p>


<h3>Author(s)</h3>

<p>Nicholas Martin-StPaul, INRA
</p>
<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>See Also</h3>

<p><code><a href="#topic+complete_meteo">complete_meteo</a></code>
</p>

<hr>
<h2 id='interpolate_data'>Interpolation process for spatial data</h2><span id='topic+interpolate_data'></span>

<h3>Description</h3>

<p>Interpolate spatial data to obtain downscaled meteorologic variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolate_data(
  spatial_data,
  interpolator,
  dates = NULL,
  variables = NULL,
  ignore_convex_hull_check = FALSE,
  verbose = getOption("meteoland_verbosity", TRUE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpolate_data_+3A_spatial_data">spatial_data</code></td>
<td>
<p>An sf or stars raster object to interpolate</p>
</td></tr>
<tr><td><code id="interpolate_data_+3A_interpolator">interpolator</code></td>
<td>
<p>A meteoland interpolator object, as created by
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a></code></p>
</td></tr>
<tr><td><code id="interpolate_data_+3A_dates">dates</code></td>
<td>
<p>vector with dates to interpolate (must be within the
interpolator date range). Default to NULL (all dates present in the
interpolator object)</p>
</td></tr>
<tr><td><code id="interpolate_data_+3A_variables">variables</code></td>
<td>
<p>vector with variable names to be interpolated. NULL (default),
will interpolate all variables. Accepted names are &quot;Temperature&quot;, &quot;Precipitation&quot;,
&quot;RelativeHumidity&quot;, &quot;Radiation&quot; and &quot;Wind&quot;</p>
</td></tr>
<tr><td><code id="interpolate_data_+3A_ignore_convex_hull_check">ignore_convex_hull_check</code></td>
<td>
<p>Logical indicating whether errors in convex hull checks should be ignored.
Checking for points to be inside the convex hull will normally raise an error
if &gt;10% of points are outside. Setting <code>ignore_convex_hull_check = TRUE</code> means
that a warning is raised but interpolation is performed, which can be useful to users interpolating
on a few points close but outside of the convex hull.</p>
</td></tr>
<tr><td><code id="interpolate_data_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the function must show messages and info.
Default value checks <code>"meteoland_verbosity"</code> option and if not set, defaults
to TRUE. It can be turned off for the function with FALSE, or session wide with
<code>options(meteoland_verbosity = FALSE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a spatial data object (sf or stars raster), an
interpolator object (<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a></code>) and a
vector of dates to perform the interpolation of the meteorologic variables
for the spatial locations present in the <code>spatial_data</code> object.
</p>


<h3>Value</h3>

<p>an object with the same class and structure as the provided spatial
data with the results of the interpolation joined. In the case of spatial
data being an sf, the results are added as a list-type column that can be
unnested with <code><a href="tidyr.html#topic+unnest">unnest</a></code>. In the case of a stars raster
object, interpolation results are added as attributes (variables)
</p>


<h3>Spatial data</h3>

<p>The spatial data provided must be of two types. (I) A sf object containing
POINT for each location to interpolate or (II) a stars raster object for
which the interpolation should be done. Independently of the class of
<code>spatial_data</code> it has to have some mandatory variables, namely
<code>elevation</code>. It should also contain <code>aspect</code> and <code>slope</code> for
a better interpolation process, though this two variables are not mandatory.
</p>


<h3>Author(s)</h3>

<p>Victor Granda García, EMF-CREAF
</p>
<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# example of data to interpolate and example interpolator
data("points_to_interpolate_example")
data("meteoland_interpolator_example")

# interpolate data
res &lt;- interpolate_data(points_to_interpolate_example, meteoland_interpolator_example)

# check result
# same class as input data
class(res)
# data
res
# results for the first location
res[["interpolated_data"]][1]
# unnest results
tidyr::unnest(res, cols = "interpolated_data")


</code></pre>

<hr>
<h2 id='interpolation_cross_validation'>Calibration and validation of interpolation procedures</h2><span id='topic+interpolation_cross_validation'></span><span id='topic+interpolator_calibration'></span>

<h3>Description</h3>

<p>Calibration and validation of interpolation procedures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolation_cross_validation(
  interpolator,
  stations = NULL,
  verbose = getOption("meteoland_verbosity", TRUE)
)

interpolator_calibration(
  interpolator,
  stations = NULL,
  update_interpolation_params = FALSE,
  variable = "MinTemperature",
  N_seq = seq(5, 30, by = 5),
  alpha_seq = seq(0.25, 10, by = 0.25),
  verbose = getOption("meteoland_verbosity", TRUE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpolation_cross_validation_+3A_interpolator">interpolator</code></td>
<td>
<p>A meteoland interpolator object, as created by
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a></code></p>
</td></tr>
<tr><td><code id="interpolation_cross_validation_+3A_stations">stations</code></td>
<td>
<p>A vector with the stations (numeric for station indexes or
character for stations id) to be used to calculate <code>"MAE"</code>. All
stations with data are included in the training set but predictive
<code>"MAE"</code> are calculated for the stations subset indicated in
<code>stations</code> param only. If <code>NULL</code> all stations are used in the
predictive <code>"MAE"</code> calculation.</p>
</td></tr>
<tr><td><code id="interpolation_cross_validation_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the function must show messages and info.
Default value checks <code>"meteoland_verbosity"</code> option and if not set, defaults
to TRUE. It can be turned off for the function with FALSE, or session wide with
<code>options(meteoland_verbosity = FALSE)</code></p>
</td></tr>
<tr><td><code id="interpolation_cross_validation_+3A_update_interpolation_params">update_interpolation_params</code></td>
<td>
<p>Logical indicating if the interpolator
object must be updated with the calculated parameters. Default to FALSE</p>
</td></tr>
<tr><td><code id="interpolation_cross_validation_+3A_variable">variable</code></td>
<td>
<p>A string indicating the meteorological variable for which
interpolation parameters <code>"N"</code> and <code>"alpha"</code> will be calibrated.
Accepted values are:
</p>

<ul>
<li><p><code>MinTemperature</code> (kernel for minimum temperature)
</p>
</li>
<li><p><code>MaxTemperature</code> (kernel for maximum temperature)
</p>
</li>
<li><p><code>DewTemperature</code> (kernel for dew-temperature (i.e. relative humidity))
</p>
</li>
<li><p><code>Precipitation</code> (to calibrate the same
kernel for both precipitation events and regression of precipitation amounts;
not recommended)
</p>
</li>
<li><p><code>PrecipitationAmount</code> (kernel for regression of precipitation amounts)
</p>
</li>
<li><p><code>PrecipitationEvent</code> (kernel for precipitation events)
</p>
</li></ul>
</td></tr>
<tr><td><code id="interpolation_cross_validation_+3A_n_seq">N_seq</code></td>
<td>
<p>Numeric vector with <code>"N"</code> values to be tested</p>
</td></tr>
<tr><td><code id="interpolation_cross_validation_+3A_alpha_seq">alpha_seq</code></td>
<td>
<p>Numeric vector with <code>"alpha"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>interpolator_calibration</code> determines optimal interpolation
parameters <code>"N"</code> and <code>"alpha"</code> for a given meteorological
variable. Optimization is done by minimizing mean absolute error (&quot;MAE&quot;)
(Thornton <em>et al.</em> 1997). Function
<code>interpolation_cross_validation</code> calculates average mean absolute
errors (&quot;MAE&quot;) for the prediction period of the interpolator object. In both
calibration and cross validation procedures, predictions for each
meteorological station are made using a <em>leave-one-out</em> procedure (i.e.
after excluding the station from the predictive set).
</p>


<h3>Value</h3>

<p><code>interpolation_cross_validation</code> returns a list with the
following items
</p>

<ul>
<li><p>errors: Data frame with each combination of station and date with
observed variables, predicated variables and the total error
(predicted - observed) calculated for each variable
</p>
</li>
<li><p>station_stats: Data frame with error and bias statistics aggregated by
station
</p>
</li>
<li><p>dates_stats: Data frame with error and bias statistics aggregated by
date
</p>
</li>
<li><p>r2: correlation indexes between observed and predicted values for each
meteorological variable
</p>
</li></ul>

<p>If <code>update_interpolation_params</code> is FALSE (default),
<code>interpolator_calibration</code> returns a list with the following items
</p>
 <ul>
<li><p>MAE: A numeric matrix with the mean absolute error values,
averaged across stations, for each combination of parameters <code>"N"</code> and
<code>"alpha"</code> </p>
</li>
<li><p>minMAE: Minimum MAE value </p>
</li>
<li><p>N: Value of parameter
<code>"N"</code> corresponding to the minimum MAE </p>
</li>
<li><p>alpha: Value of parameter
<code>"alpha"</code> corresponding the the minimum MAE </p>
</li>
<li><p>observed: matrix with
observed values (meteorological measured values) </p>
</li>
<li><p>predicted: matrix with
interpolated values for the optimum parameter combination </p>
</li></ul>
<p> If
<code>update_interpolation_params</code> is FALSE, <code>interpolator_calibration</code>
returns the interpolator provided with the parameters updated
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>interpolation_cross_validation()</code>: 
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, EMF-CREAF
</p>
<p>Victor Granda García, EMF-CREAF
</p>


<h3>References</h3>

<p>Thornton, P.E., Running, S.W., 1999. An improved algorithm for
estimating incident daily solar radiation from measurements of temperature,
humidity, and precipitation. Agric. For. Meteorol. 93, 211–228.
doi:10.1016/S0168-1923(98)00126-9.
</p>
<p>De Caceres M, Martin-StPaul N, Turco M, Cabon A, Granda V (2018) Estimating
daily meteorological data and downscaling climate models over landscapes.
Environmental Modelling and Software 108: 186-196.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# example interpolator
data("meteoland_interpolator_example")

# As the cross validation for all stations can be time consuming, we are
# gonna use only for the first 5 stations of the 198
cv &lt;- interpolation_cross_validation(meteoland_interpolator_example, stations = 1:5)

# Inspect the results
cv$errors
cv$station_stats
cv$dates_stats
cv$r2




# example interpolator
data("meteoland_interpolator_example")

# As the calibration for all stations can be time consuming, we are gonna
# interpolate only for the first 5 stations of the 198 and only a handful
# of parameter combinations
calibration &lt;- interpolator_calibration(
  meteoland_interpolator_example,
  stations = 1:5,
  variable = "MaxTemperature",
  N_seq = seq(10, 20, by = 5),
  alpha_seq = seq(8, 9, by = 0.25)
)

# we can update the interpolator params directly:
updated_interpolator &lt;- interpolator_calibration(
  meteoland_interpolator_example,
  stations = 1:5,
  update_interpolation_params = TRUE,
  variable = "MaxTemperature",
  N_seq = seq(10, 20, by = 5),
  alpha_seq = seq(8, 9, by = 0.25)
)


# check the new interpolator have the parameters updated
get_interpolation_params(updated_interpolator)$N_MaxTemperature
get_interpolation_params(updated_interpolator)$alpha_MaxTemperature


</code></pre>

<hr>
<h2 id='interpolation_precipitation'>Low-level interpolation functions</h2><span id='topic+interpolation_precipitation'></span><span id='topic+interpolation_dewtemperature'></span><span id='topic+interpolation_temperature'></span><span id='topic+interpolation_wind'></span>

<h3>Description</h3>

<p>Low-level functions to interpolate meteorology (one day) on a set of points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolation_precipitation(
  Xp,
  Yp,
  Zp,
  X,
  Y,
  Z,
  P,
  Psmooth,
  iniRp = 140000,
  alpha_event = 6.25,
  alpha_amount = 6.25,
  N_event = 20L,
  N_amount = 20L,
  iterations = 3L,
  popcrit = 0.5,
  fmax = 0.95,
  debug = FALSE
)

interpolation_dewtemperature(
  Xp,
  Yp,
  Zp,
  X,
  Y,
  Z,
  T,
  iniRp = 140000,
  alpha = 3,
  N = 30L,
  iterations = 3L,
  debug = FALSE
)

interpolation_temperature(
  Xp,
  Yp,
  Zp,
  X,
  Y,
  Z,
  T,
  iniRp = 140000,
  alpha = 3,
  N = 30L,
  iterations = 3L,
  debug = FALSE
)

interpolation_wind(
  Xp,
  Yp,
  WS,
  WD,
  X,
  Y,
  iniRp = 140000,
  alpha = 2,
  N = 1L,
  iterations = 3L,
  directionsAvailable = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpolation_precipitation_+3A_xp">Xp</code>, <code id="interpolation_precipitation_+3A_yp">Yp</code>, <code id="interpolation_precipitation_+3A_zp">Zp</code></td>
<td>
<p>Spatial coordinates and elevation (Zp; in m.a.s.l) of target
points.</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_x">X</code>, <code id="interpolation_precipitation_+3A_y">Y</code>, <code id="interpolation_precipitation_+3A_z">Z</code></td>
<td>
<p>Spatial coordinates and elevation (Zp; in m.a.s.l) of reference
locations (e.g. meteorological stations).</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_p">P</code></td>
<td>
<p>Precipitation at the reference locations (in mm).</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_psmooth">Psmooth</code></td>
<td>
<p>Temporally-smoothed precipitation at the reference locations
(in mm).</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_inirp">iniRp</code></td>
<td>
<p>Initial truncation radius.</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_iterations">iterations</code></td>
<td>
<p>Number of station density iterations.</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_popcrit">popcrit</code></td>
<td>
<p>Critical precipitation occurrence parameter.</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_fmax">fmax</code></td>
<td>
<p>Maximum value for precipitation regression extrapolations (0.6
equals to a maximum of 4 times extrapolation).</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_debug">debug</code></td>
<td>
<p>Boolean flag to show extra console output.</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_t">T</code></td>
<td>
<p>Temperature (e.g., minimum, maximum or dew temperature) at the
reference locations (in degrees).</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_alpha">alpha</code>, <code id="interpolation_precipitation_+3A_alpha_amount">alpha_amount</code>, <code id="interpolation_precipitation_+3A_alpha_event">alpha_event</code></td>
<td>
<p>Gaussian shape parameter.</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_n">N</code>, <code id="interpolation_precipitation_+3A_n_event">N_event</code>, <code id="interpolation_precipitation_+3A_n_amount">N_amount</code></td>
<td>
<p>Average number of stations with non-zero weights.</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_ws">WS</code>, <code id="interpolation_precipitation_+3A_wd">WD</code></td>
<td>
<p>Wind speed (in m/s) and wind direction (in degrees from north
clock-wise) at the reference locations.</p>
</td></tr>
<tr><td><code id="interpolation_precipitation_+3A_directionsavailable">directionsAvailable</code></td>
<td>
<p>A flag to indicate that wind directions are
available (i.e. non-missing) at the reference locations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions exposes internal low-level interpolation functions written in C++
not intended to be used directly in any script or function. The are maintained for
compatibility with older versions of the package and future versions of meteoland
will remove this functions (they will be still accessible through the triple colon
notation (<code>:::</code>), but their use is not recommended)
</p>


<h3>Value</h3>

<p>All functions return a vector with interpolated values for the
target points.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>interpolation_precipitation()</code>: Precipitation
</p>
</li>
<li> <p><code>interpolation_dewtemperature()</code>: Dew temperature
</p>
</li>
<li> <p><code>interpolation_wind()</code>: Wind
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Thornton, P.E., Running, S.W., White, M. A., 1997. Generating
surfaces of daily meteorological variables over large regions of complex
terrain. J. Hydrol. 190, 214–251. doi:10.1016/S0022-1694(96)03128-9.
</p>
<p>De Caceres M, Martin-StPaul N, Turco M, Cabon A, Granda V (2018) Estimating
daily meteorological data and downscaling climate models over landscapes.
Environmental Modelling and Software 108: 186-196.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+defaultInterpolationParams">defaultInterpolationParams</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Xp &lt;- as.numeric(sf::st_coordinates(points_to_interpolate_example)[,1])
Yp &lt;- as.numeric(sf::st_coordinates(points_to_interpolate_example)[,2])
Zp &lt;- points_to_interpolate_example$elevation
X &lt;- as.numeric(
  sf::st_coordinates(stars::st_get_dimension_values(meteoland_interpolator_example, "station"))[,1]
)
Y &lt;- as.numeric(
  sf::st_coordinates(stars::st_get_dimension_values(meteoland_interpolator_example, "station"))[,2]
)
Z &lt;- as.numeric(meteoland_interpolator_example[["elevation"]][1,])
Temp &lt;- as.numeric(meteoland_interpolator_example[["MinTemperature"]][1,])
P &lt;- as.numeric(meteoland_interpolator_example[["Precipitation"]][1,])
Psmooth &lt;- as.numeric(meteoland_interpolator_example[["SmoothedPrecipitation"]][1,])
WS &lt;- as.numeric(meteoland_interpolator_example[["WindSpeed"]][1,])
WD &lt;- as.numeric(meteoland_interpolator_example[["WindDirection"]][1,])
iniRp &lt;- get_interpolation_params(meteoland_interpolator_example)$initial_Rp
alpha &lt;- get_interpolation_params(meteoland_interpolator_example)$alpha_MinTemperature
N &lt;- get_interpolation_params(meteoland_interpolator_example)$N_MinTemperature
alpha_event &lt;- get_interpolation_params(meteoland_interpolator_example)$alpha_PrecipitationEvent
N_event &lt;- get_interpolation_params(meteoland_interpolator_example)$N_PrecipitationEvent
alpha_amount &lt;- get_interpolation_params(meteoland_interpolator_example)$alpha_PrecipitationAmount
N_amount &lt;- get_interpolation_params(meteoland_interpolator_example)$N_PrecipitationAmount
alpha_wind &lt;- get_interpolation_params(meteoland_interpolator_example)$alpha_Wind
N_wind &lt;- get_interpolation_params(meteoland_interpolator_example)$N_Wind
iterations &lt;- get_interpolation_params(meteoland_interpolator_example)$iterations
popcrit &lt;- get_interpolation_params(meteoland_interpolator_example)$pop_crit
fmax &lt;- get_interpolation_params(meteoland_interpolator_example)$f_max
debug &lt;- get_interpolation_params(meteoland_interpolator_example)$debug

interpolation_temperature(
  Xp, Yp, Zp,
  X[!is.na(Temp)], Y[!is.na(Temp)], Z[!is.na(Temp)],
  Temp[!is.na(Temp)],
  iniRp, alpha, N, iterations, debug
)

interpolation_wind(
  Xp, Yp,
  WS[!is.na(WD)], WD[!is.na(WD)],
  X[!is.na(WD)], Y[!is.na(WD)],
  iniRp, alpha_wind, N_wind, iterations, directionsAvailable = FALSE
)

interpolation_precipitation(
  Xp, Yp, Zp,
  X[!is.na(P)], Y[!is.na(P)], Z[!is.na(P)],
  P[!is.na(P)], Psmooth[!is.na(P)],
  iniRp, alpha_event, alpha_amount, N_event, N_amount,
  iterations, popcrit, fmax, debug
)

</code></pre>

<hr>
<h2 id='meteoland_interpolator_example'>Example interpolator object</h2><span id='topic+meteoland_interpolator_example'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Example interpolator with daily meteorological
records from 189 weather stations in Catalonia (NE Spain) corresponding to
April 2022.
</p>


<h3>Format</h3>

<p>stars data cube object
</p>


<h3>Source</h3>

<p>Spanish National Forest Inventory
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(meteoland_interpolator_example)

</code></pre>

<hr>
<h2 id='meteoland_meteo_example'>Example data set for meteo data from weather stations</h2><span id='topic+meteoland_meteo_example'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Example data set of spatial location, topography and daily meteorological
records from 189 weather stations in Catalonia (NE Spain) corresponding to
April 2022.
</p>


<h3>Format</h3>

<p>sf object
</p>


<h3>Source</h3>

<p>'Servei Meteorològic de Catalunya' (SMC)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(meteoland_meteo_example)

</code></pre>

<hr>
<h2 id='meteoland_meteo_no_topo_example'>Example data set for meteo data from weather stations, without topography</h2><span id='topic+meteoland_meteo_no_topo_example'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Example data set of spatial location and daily meteorological
records from 189 weather stations in Catalonia (NE Spain) corresponding to
April 2022.
</p>


<h3>Format</h3>

<p>sf object
</p>


<h3>Source</h3>

<p>'Servei Meteorològic de Catalunya' (SMC)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(meteoland_meteo_no_topo_example)

</code></pre>

<hr>
<h2 id='meteoland_topo_example'>Example data set for topography data from weather stations, without meteo</h2><span id='topic+meteoland_topo_example'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Example data set of spatial location and topography
records from 189 weather stations in Catalonia (NE Spain).
</p>


<h3>Format</h3>

<p>sf object
</p>


<h3>Source</h3>

<p>'Servei Meteorològic de Catalunya' (SMC)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(meteoland_topo_example)

</code></pre>

<hr>
<h2 id='meteoland-package'>meteoland: Landscape Meteorology Tools</h2><span id='topic+meteoland-package'></span><span id='topic+_PACKAGE'></span><span id='topic+meteoland'></span>

<h3>Description</h3>

<p>Functions to estimate weather variables at any position of a landscape
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Miquel De Cáceres
<a href="mailto:miquelcaceres@gmail.com">miquelcaceres@gmail.com</a>
<a href="https://orcid.org/0000-0001-7132-2080">ORCID</a>
</p>
<p>Authors: </p>

<ul>
<li><p> Víctor Granda
<a href="https://orcid.org/0000-0002-0469-1991">ORCID</a>
</p>
</li>
<li><p> Nicolas Martin
<a href="https://orcid.org/0000-0001-7574-0108">ORCID</a>
</p>
</li>
<li><p> Antoine Cabon
<a href="https://orcid.org/0000-0001-6426-1726">ORCID</a>
</p>
</li></ul>



<h3>References</h3>

<p>De Caceres et al., 2018 (<a href="https://doi.org/10.1016/j.envsoft.2018.08.003">doi:10.1016/j.envsoft.2018.08.003</a>))
</p>


<h3>See Also</h3>

<p>Useful links: </p>
 <ul>
<li>
<p><a href="https://emf-creaf.github.io/meteoland/index.html">https://emf-creaf.github.io/meteoland/index.html</a> </p>
</li></ul>


<hr>
<h2 id='meteospain2meteoland'>From meteospain to meteoland meteo objects</h2><span id='topic+meteospain2meteoland'></span>

<h3>Description</h3>

<p>Adapting meteospain meteo objects to meteoland meteo objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meteospain2meteoland(meteo, complete = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meteospain2meteoland_+3A_meteo">meteo</code></td>
<td>
<p>meteospain meteo object.</p>
</td></tr>
<tr><td><code id="meteospain2meteoland_+3A_complete">complete</code></td>
<td>
<p>logical indicating if the meteo data missing variables
should be calculated (if possible). Default to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function converts <code>meteospain</code> R package meteo objects to
compatible meteoland meteo objects by selecting the needed variables and
adapting the names to comply with meteoland requirements.
</p>


<h3>Value</h3>

<p>a compatible meteo object to use with meteoland.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (interactive()) {
  # meteospain data
  library(meteospain)
  mg_april_2022_data &lt;- get_meteo_from(
    "meteogalicia",
    meteogalicia_options("daily", as.Date("2022-04-01"), as.Date("2022-04-30"))
  )

  # just convert
  meteospain2meteoland(mg_april_2022_data)
  # convert and complete
  meteospain2meteoland(mg_april_2022_data, complete = TRUE)

}

</code></pre>

<hr>
<h2 id='penman'>Potential evapotranspiration</h2><span id='topic+penman'></span><span id='topic+penmanmonteith'></span>

<h3>Description</h3>

<p>Functions to calculate potential evapotranspiration using Penman or
Penman-Monteith.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penman(
  latrad,
  elevation,
  slorad,
  asprad,
  J,
  Tmin,
  Tmax,
  RHmin,
  RHmax,
  R_s,
  u,
  z = 10,
  z0 = 0.001,
  alpha = 0.25,
  windfun = "1956"
)

penmanmonteith(rc, elevation, Tmin, Tmax, RHmin, RHmax, Rn, u = NA_real_)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="penman_+3A_latrad">latrad</code></td>
<td>
<p>Latitude in radians.</p>
</td></tr>
<tr><td><code id="penman_+3A_elevation">elevation</code></td>
<td>
<p>Elevation (in m).</p>
</td></tr>
<tr><td><code id="penman_+3A_slorad">slorad</code></td>
<td>
<p>Slope (in radians).</p>
</td></tr>
<tr><td><code id="penman_+3A_asprad">asprad</code></td>
<td>
<p>Aspect (in radians from North).</p>
</td></tr>
<tr><td><code id="penman_+3A_j">J</code></td>
<td>
<p>Julian day, number of days since January 1, 4713 BCE at noon UTC.</p>
</td></tr>
<tr><td><code id="penman_+3A_tmin">Tmin</code></td>
<td>
<p>Minimum temperature (degrees Celsius).</p>
</td></tr>
<tr><td><code id="penman_+3A_tmax">Tmax</code></td>
<td>
<p>Maximum temperature (degrees Celsius).</p>
</td></tr>
<tr><td><code id="penman_+3A_rhmin">RHmin</code></td>
<td>
<p>Minimum relative humidity (percent).</p>
</td></tr>
<tr><td><code id="penman_+3A_rhmax">RHmax</code></td>
<td>
<p>Maximum relative humidity (percent).</p>
</td></tr>
<tr><td><code id="penman_+3A_r_s">R_s</code></td>
<td>
<p>Solar radiation (MJ/m2).</p>
</td></tr>
<tr><td><code id="penman_+3A_u">u</code></td>
<td>
<p>With wind speed (m/s).</p>
</td></tr>
<tr><td><code id="penman_+3A_z">z</code></td>
<td>
<p>Wind measuring height (m).</p>
</td></tr>
<tr><td><code id="penman_+3A_z0">z0</code></td>
<td>
<p>Roughness height (m).</p>
</td></tr>
<tr><td><code id="penman_+3A_alpha">alpha</code></td>
<td>
<p>Albedo.</p>
</td></tr>
<tr><td><code id="penman_+3A_windfun">windfun</code></td>
<td>
<p>Wind speed function version, either &quot;1948&quot; or &quot;1956&quot;.</p>
</td></tr>
<tr><td><code id="penman_+3A_rc">rc</code></td>
<td>
<p>Canopy vapour flux (stomatal) resistance (s·m-1).</p>
</td></tr>
<tr><td><code id="penman_+3A_rn">Rn</code></td>
<td>
<p>Daily net radiation (MJ·m-2·day-1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The code was adapted from package &lsquo;Evapotranspiration&rsquo;, which follows
McMahon et al. (2013). If wind speed is not available, an alternative
formulation for potential evapotranspiration is used as an approximation
(Valiantzas 2006)
</p>


<h3>Value</h3>

<p>Potential evapotranspiration (in mm of water).
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>penmanmonteith()</code>: Penman Monteith method
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Penman, H. L. 1948. Natural evaporation from open water, bare
soil and grass. Proceedings of the Royal Society of London. Series A.
Mathematical and Physical Sciences, 193, 120-145.
</p>
<p>Penman, H. L. 1956. Evaporation: An introductory survey. Netherlands Journal
of Agricultural Science, 4, 9-29.
</p>
<p>McMahon, T.A., Peel, M.C., Lowe, L., Srikanthan, R., McVicar, T.R. 2013.
Estimating actual, potential, reference crop and pan evaporation using
standard meteorological data: a pragmatic synthesis. Hydrology &amp; Earth
System Sciences 17, 1331–1363. doi:10.5194/hess-17-1331-2013.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interpolate_data">interpolate_data</a></code>
</p>

<hr>
<h2 id='points_to_interpolate_example'>Example data set of points for interpolation of weather variables</h2><span id='topic+points_to_interpolate_example'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Example data set of spatial location and topography
records from 15 experimental plots in Catalonia (NE Spain).
</p>


<h3>Format</h3>

<p>sf object
</p>


<h3>Source</h3>

<p>Spanish National Forest Inventory
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(points_to_interpolate_example)

</code></pre>

<hr>
<h2 id='precipitation_concentration'>Precipitation daily concentration</h2><span id='topic+precipitation_concentration'></span>

<h3>Description</h3>

<p>Function <code>precipitation_concentration()</code> calculates daily precipitation
concentration (Martin-Vide et al. 2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>precipitation_concentration(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="precipitation_concentration_+3A_p">p</code></td>
<td>
<p>A numeric vector with daily precipitation values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code>precipitation_concentration()</code> returns a value
between 0 (equal distribution of rainfall) and 1 (one day concentrates all
rainfall).
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF.
</p>


<h3>References</h3>

<p>Martin-Vide J (2004) Spatial distribution of a daily precipitation
concentration index in peninsular Spain. International Journal of
Climatology 24, 959–971. doi:10.1002/joc.1030.
</p>

<hr>
<h2 id='precipitation_rainfall_erosivity'>Precipitation rainfall erosivity</h2><span id='topic+precipitation_rainfall_erosivity'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Function <code>precipitation_rainfall_erosivity()</code> calculates a multi-year
average of monthly rainfall erosivity using the MedREM model proposed by
Diodato and Bellochi (2010) for the Mediterranean area (see also Guerra et
al. 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>precipitation_rainfall_erosivity(
  meteo_data,
  longitude,
  scale = c("month", "year"),
  average = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="precipitation_rainfall_erosivity_+3A_meteo_data">meteo_data</code></td>
<td>
<p>A meteo tibble as with the dates and meteorological variables
as returned by <code><a href="#topic+interpolate_data">interpolate_data</a></code> in the &quot;interpolated_data&quot;
column.</p>
</td></tr>
<tr><td><code id="precipitation_rainfall_erosivity_+3A_longitude">longitude</code></td>
<td>
<p>Longitude in degrees.</p>
</td></tr>
<tr><td><code id="precipitation_rainfall_erosivity_+3A_scale">scale</code></td>
<td>
<p>Character, either 'month' or 'year'. Default to 'month'</p>
</td></tr>
<tr><td><code id="precipitation_rainfall_erosivity_+3A_average">average</code></td>
<td>
<p>Boolean flag to calculate multi-year averages before applying
MedREM's formula.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MedREM model is: Rm = b0·P·sqrt(d)·(alpha + b1*longitude), where P is
accumulated precipitation and d is maximum daily precipitation. Parameters
used for the MedREM model are b0 = 0.117, b1 = -0.015, alpha = 2. Note that
there is a mistake in Guerra et al. (2016) regarding parameters b1 and a.
</p>


<h3>Value</h3>

<p>A vector of values for each month (in MJ·mm·ha-1·h-1·month-1) or each
year (in MJ·mm·ha-1·h-1·yr-1), depending on the scale
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF.
</p>
<p>Víctor Granda García, CREAF.
</p>


<h3>References</h3>

<p>Diodato, N., Bellocchi, G., 2010. MedREM, a rainfall erosivity
model for the Mediterranean region. J. Hydrol. 387, 119–127,
doi:10.1016/j.jhydrol.2010.04.003.
</p>
<p>Guerra CA, Maes J, Geijzendorffer I, Metzger MJ (2016) An assessment of soil
erosion prevention by vegetation in Mediterranean Europe: Current trends of
ecosystem service provision. Ecol Indic 60:213–222. doi:
10.1016/j.ecolind.2015.06.043.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
interpolated_example &lt;-
  interpolate_data(points_to_interpolate_example, meteoland_interpolator_example)

precipitation_rainfall_erosivity(
  meteo_data = interpolated_example$interpolated_data[[1]],
  longitude = 2.32,
  scale = "month",
  average = TRUE
)


</code></pre>

<hr>
<h2 id='radiation_julianDay'>Solar radiation utility functions</h2><span id='topic+radiation_julianDay'></span><span id='topic+radiation_dateStringToJulianDays'></span><span id='topic+radiation_daylength'></span><span id='topic+radiation_daylengthseconds'></span><span id='topic+radiation_directDiffuseInstant'></span><span id='topic+radiation_directDiffuseDay'></span><span id='topic+radiation_potentialRadiation'></span><span id='topic+radiation_skyLongwaveRadiation'></span><span id='topic+radiation_outgoingLongwaveRadiation'></span><span id='topic+radiation_netRadiation'></span><span id='topic+radiation_solarRadiation'></span><span id='topic+radiation_solarConstant'></span><span id='topic+radiation_solarElevation'></span><span id='topic+radiation_solarDeclination'></span><span id='topic+radiation_sunRiseSet'></span>

<h3>Description</h3>

<p>Set of functions used in the calculation of incoming solar radiation and net
radiation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>radiation_julianDay(year, month, day)

radiation_dateStringToJulianDays(dateStrings)

radiation_solarDeclination(J)

radiation_solarConstant(J)

radiation_sunRiseSet(latrad, slorad, asprad, delta)

radiation_solarElevation(latrad, delta, hrad)

radiation_daylength(latrad, slorad, asprad, delta)

radiation_daylengthseconds(latrad, slorad, asprad, delta)

radiation_potentialRadiation(solarConstant, latrad, slorad, asprad, delta)

radiation_solarRadiation(
  solarConstant,
  latrad,
  elevation,
  slorad,
  asprad,
  delta,
  diffTemp,
  diffTempMonth,
  vpa,
  precipitation
)

radiation_directDiffuseInstant(
  solarConstant,
  latrad,
  slorad,
  asprad,
  delta,
  hrad,
  R_s,
  clearday
)

radiation_directDiffuseDay(
  solarConstant,
  latrad,
  slorad,
  asprad,
  delta,
  R_s,
  clearday,
  nsteps = 24L
)

radiation_skyLongwaveRadiation(Tair, vpa, c = 0)

radiation_outgoingLongwaveRadiation(
  solarConstant,
  latrad,
  elevation,
  slorad,
  asprad,
  delta,
  vpa,
  tmin,
  tmax,
  R_s
)

radiation_netRadiation(
  solarConstant,
  latrad,
  elevation,
  slorad,
  asprad,
  delta,
  vpa,
  tmin,
  tmax,
  R_s,
  alpha = 0.08
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="radiation_julianDay_+3A_year">year</code>, <code id="radiation_julianDay_+3A_month">month</code>, <code id="radiation_julianDay_+3A_day">day</code></td>
<td>
<p>Year, month and day as integers.</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_datestrings">dateStrings</code></td>
<td>
<p>A character vector with dates in format &quot;YYYY-MM-DD&quot;.</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_j">J</code></td>
<td>
<p>Julian day (integer), number of days since January 1, 4713 BCE at
noon UTC.</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_latrad">latrad</code></td>
<td>
<p>Latitude (in radians North).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_slorad">slorad</code></td>
<td>
<p>Slope (in radians).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_asprad">asprad</code></td>
<td>
<p>Aspect (in radians from North).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_delta">delta</code></td>
<td>
<p>Solar declination (in radians).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_hrad">hrad</code></td>
<td>
<p>Solar hour (in radians).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_solarconstant">solarConstant</code></td>
<td>
<p>Solar constant (in kW·m-2).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_elevation">elevation</code></td>
<td>
<p>Elevation above sea level (in m).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_difftemp">diffTemp</code></td>
<td>
<p>Difference between maximum and minimum temperature (ºC).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_difftempmonth">diffTempMonth</code></td>
<td>
<p>Difference between maximum and minimum temperature,
averaged over 30 days (ºC).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_vpa">vpa</code></td>
<td>
<p>Average daily vapor pressure (kPa).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_precipitation">precipitation</code></td>
<td>
<p>Precipitation (in mm).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_r_s">R_s</code></td>
<td>
<p>Daily incident solar radiation (MJ·m-2).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_clearday">clearday</code></td>
<td>
<p>Boolean flag to indicate a clearsky day (vs. overcast).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_nsteps">nsteps</code></td>
<td>
<p>Number of daily substeps.</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_tair">Tair</code></td>
<td>
<p>Air temperature (in degrees Celsius).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_c">c</code></td>
<td>
<p>Proportion of sky covered by clouds (0-1).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_tmin">tmin</code>, <code id="radiation_julianDay_+3A_tmax">tmax</code></td>
<td>
<p>Minimum and maximum daily temperature (ºC).</p>
</td></tr>
<tr><td><code id="radiation_julianDay_+3A_alpha">alpha</code></td>
<td>
<p>Surface albedo (from 0 to 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Values returned for each function are: </p>

<ul>
<li><p><code>radiation_dateStringToJulianDays</code>: A vector of Julian days (i.e.
number of days since January 1, 4713 BCE at noon UTC).
</p>
</li>
<li><p><code>radiation_daylength</code>: Day length (in hours).
</p>
</li>
<li><p><code>radiation_daylengthseconds</code>: Day length (in seconds).
</p>
</li>
<li><p><code>radiation_directDiffuseInstant</code>: A vector with instantaneous
direct and diffusive radiation rates (for both SWR and PAR).
</p>
</li>
<li><p><code>radiation_directDiffuseDay</code>: A data frame with instantaneous
direct and diffusive radiation rates (for both SWR and PAR) for each
subdaily time step. </p>
</li>
<li><p><code>radiation_potentialRadiation</code>: Daily
(potential) solar radiation (in MJ·m-2). </p>
</li>
<li><p><code>radiation_julianDay</code>:
Number of days since January 1, 4713 BCE at noon UTC.
</p>
</li>
<li><p><code>radiation_skyLongwaveRadiation</code>: Instantaneous incoming (sky)
longwave radiation (W·m-2).
</p>
</li>
<li><p><code>radiation_outgoingLongwaveRadiation</code>: Daily outgoing longwave
radiation (MJ·m-2·day-1).  </p>
</li>
<li><p><code>radiation_netRadiation</code>: Daily net
solar radiation (MJ·m-2·day-1).  </p>
</li>
<li><p><code>radiation_solarConstant</code>: Solar
constant (in kW·m-2). </p>
</li>
<li><p><code>radiation_solarDeclination</code>: Solar
declination (in radians). </p>
</li>
<li><p><code>radiation_solarElevation</code>: Angle of
elevation of the sun with respect to the horizon (in radians).
</p>
</li>
<li><p><code>radiation_solarRadiation</code>: Daily incident solar radiation
(MJ·m-2·day-1). </p>
</li>
<li><p><code>radiation_sunRiseSet</code>: Sunrise and sunset hours
in hour angle (radians). </p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>radiation_dateStringToJulianDays()</code>: Date string to julian days
</p>
</li>
<li> <p><code>radiation_solarDeclination()</code>: solar declination
</p>
</li>
<li> <p><code>radiation_solarConstant()</code>: solar constant
</p>
</li>
<li> <p><code>radiation_sunRiseSet()</code>: sun rise and set
</p>
</li>
<li> <p><code>radiation_solarElevation()</code>: solar elevation
</p>
</li>
<li> <p><code>radiation_daylength()</code>: Day length
</p>
</li>
<li> <p><code>radiation_daylengthseconds()</code>: Day length seconds
</p>
</li>
<li> <p><code>radiation_potentialRadiation()</code>: Potential radiation
</p>
</li>
<li> <p><code>radiation_solarRadiation()</code>: solar Radiation
</p>
</li>
<li> <p><code>radiation_directDiffuseInstant()</code>: Direct diffuse instant
</p>
</li>
<li> <p><code>radiation_directDiffuseDay()</code>: Direct diffuse day
</p>
</li>
<li> <p><code>radiation_skyLongwaveRadiation()</code>: Sky longwave radiation
</p>
</li>
<li> <p><code>radiation_outgoingLongwaveRadiation()</code>: Outgoing longwave radiation
</p>
</li>
<li> <p><code>radiation_netRadiation()</code>: Net radiation
</p>
</li></ul>


<h3>Note</h3>

<p>Code for <code>radiation_julianDay()</code>,
<code>radiation_solarConstant()</code> and <code>radiation_solarDeclination()</code> was
translated to C++ from R code in package 'insol' (by J. G. Corripio).
</p>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>Danby, J. M. Eqn. 6.16.4 in Fundamentals of Celestial Mechanics,
2nd ed. Richmond, VA: Willmann-Bell, p. 207, 1988.
</p>
<p>Garnier, B.J., Ohmura, A., 1968. A method of calculating the direct
shortwave radiation income of slopes. J. Appl. Meteorol. 7: 796-800
</p>
<p>McMahon, T. A., M. C. Peel, L. Lowe, R. Srikanthan, and T. R. McVicar. 2013.
Estimating actual, potential, reference crop and pan evaporation using
standard meteorological data: a pragmatic synthesis. Hydrology &amp; Earth
System Sciences 17:1331–1363. See also:
http://www.fao.org/docrep/x0490e/x0490e06.htm.
</p>
<p>Reda, I. and Andreas, A. 2003. Solar Position Algorithm for Solar Radiation
Applications. 55 pp.; NREL Report No. TP-560-34302, Revised January 2008.
http://www.nrel.gov/docs/fy08osti/34302.pdf
</p>
<p>Spitters, C.J.T., Toussaint, H.A.J.M. and Goudriaan, J. (1986). Separating
the diffuse and direct components of global radiation and its implications
for modeling canopy photosynthesis. I. Components of incoming radiation.
Agricultural and Forest Meteorology, 38, 231–242.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interpolate_data">interpolate_data</a></code>
</p>

<hr>
<h2 id='raster_to_interpolate_example'>Example raster data set for interpolation of weather variables</h2><span id='topic+raster_to_interpolate_example'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Example raster data set of spatial location and topography
records from Catalonia (NE Spain). Cell size is 1km x 1km and raster size is 10x10 cells.
</p>


<h3>Format</h3>

<p>stars object
</p>


<h3>Source</h3>

<p>ICGC
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(raster_to_interpolate_example)

</code></pre>

<hr>
<h2 id='read_interpolator'>Read interpolator files</h2><span id='topic+read_interpolator'></span>

<h3>Description</h3>

<p>Read interpolator files created with <code><a href="#topic+write_interpolator">write_interpolator</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_interpolator(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_interpolator_+3A_filename">filename</code></td>
<td>
<p>interpolator file name</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes the file name of the nc file storing an interpolator
object and load it into the work environment
</p>


<h3>Value</h3>

<p>an interpolator (stars) object
</p>


<h3>Author(s)</h3>

<p>Victor Granda García, EMF-CREAF
</p>


<h3>See Also</h3>

<p>Other interpolator functions: <code><a href="#topic+add_topo">add_topo</a>()</code>,
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a>()</code>,
<code><a href="#topic+get_interpolation_params">get_interpolation_params</a>()</code>,
<code><a href="#topic+set_interpolation_params">set_interpolation_params</a>()</code>, <code><a href="#topic+with_meteo">with_meteo</a>()</code>,
<code><a href="#topic+write_interpolator">write_interpolator</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# example interpolator
data(meteoland_interpolator_example)

# temporal folder
tmp_dir &lt;- tempdir()

# write interpolator
write_interpolator(
  meteoland_interpolator_example,
  file.path(tmp_dir, "meteoland_interpolator_example.nc")
)

# check file exists
file.exists(file.path(tmp_dir, "meteoland_interpolator_example.nc"))

# read it again
read_interpolator(file.path(tmp_dir, "meteoland_interpolator_example.nc"))


</code></pre>

<hr>
<h2 id='set_interpolation_params'>Setting interpolation parameters in an interpolator object</h2><span id='topic+set_interpolation_params'></span>

<h3>Description</h3>

<p>Changing or updating interpolation parameters in an interpolator object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_interpolation_params(
  interpolator,
  params = NULL,
  verbose = getOption("meteoland_verbosity", TRUE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_interpolation_params_+3A_interpolator">interpolator</code></td>
<td>
<p>interpolator object to update</p>
</td></tr>
<tr><td><code id="set_interpolation_params_+3A_params">params</code></td>
<td>
<p>list with the parameters provided by the user</p>
</td></tr>
<tr><td><code id="set_interpolation_params_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the function must show messages and info.
Default value checks <code>"meteoland_verbosity"</code> option and if not set, defaults
to TRUE. It can be turned off for the function with FALSE, or session wide with
<code>options(meteoland_verbosity = FALSE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function ensures that if no parameters are provided, the default ones
are used (see <code><a href="#topic+defaultInterpolationParams">defaultInterpolationParams</a></code>). Also, if params are
partially provided, this function ensures that the rest of the parameters
are not changed.
</p>


<h3>Value</h3>

<p>The same interpolator object provided, with the updated
interpolation parameters
</p>


<h3>Author(s)</h3>

<p>Victor Granda García, EMF-CREAF
</p>


<h3>See Also</h3>

<p>Other interpolator functions: <code><a href="#topic+add_topo">add_topo</a>()</code>,
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a>()</code>,
<code><a href="#topic+get_interpolation_params">get_interpolation_params</a>()</code>, <code><a href="#topic+read_interpolator">read_interpolator</a>()</code>,
<code><a href="#topic+with_meteo">with_meteo</a>()</code>, <code><a href="#topic+write_interpolator">write_interpolator</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example interpolator
data(meteoland_interpolator_example)
# store the actual parameters
old_parameters &lt;- get_interpolation_params(meteoland_interpolator_example)
# we can provide only the parameter we want to change
meteoland_interpolator_example &lt;- set_interpolation_params(
  meteoland_interpolator_example,
  list(debug = TRUE)
)
# check
get_interpolation_params(meteoland_interpolator_example)$debug
# compare with old
old_parameters$debug
# the rest should be the same
setdiff(old_parameters, get_interpolation_params(meteoland_interpolator_example))

</code></pre>

<hr>
<h2 id='summarise_interpolated_data'>Summarise interpolated data by temporal dimension</h2><span id='topic+summarise_interpolated_data'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Summarises the interpolated meteorology in one or more locations by the desired
temporal scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarise_interpolated_data(
  interpolated_data,
  fun = "mean",
  frequency = NULL,
  vars_to_summary = c("MeanTemperature", "MinTemperature", "MaxTemperature",
    "Precipitation", "MeanRelativeHumidity", "MinRelativeHumidity",
    "MaxRelativeHumidity", "Radiation", "WindSpeed", "WindDirection", "PET"),
  dates_to_summary = NULL,
  months_to_summary = 1:12,
  verbose = getOption("meteoland_verbosity", TRUE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarise_interpolated_data_+3A_interpolated_data">interpolated_data</code></td>
<td>
<p>An interpolated data object as returned by
<code><a href="#topic+interpolate_data">interpolate_data</a></code>.</p>
</td></tr>
<tr><td><code id="summarise_interpolated_data_+3A_fun">fun</code></td>
<td>
<p>The function to use for summarising the data.</p>
</td></tr>
<tr><td><code id="summarise_interpolated_data_+3A_frequency">frequency</code></td>
<td>
<p>A string indicating the interval specification (allowed ones
are &quot;week&quot;, &quot;month&quot;, &quot;quarter&quot; and &quot;year&quot;). If NULL (default), aggregation
is done in one interval for all the dates present.</p>
</td></tr>
<tr><td><code id="summarise_interpolated_data_+3A_vars_to_summary">vars_to_summary</code></td>
<td>
<p>A character vector with one or more variable names to
summarise. By default, all interpolated variables are summarised.</p>
</td></tr>
<tr><td><code id="summarise_interpolated_data_+3A_dates_to_summary">dates_to_summary</code></td>
<td>
<p>A Date object to define the dates to be summarised.
If NULL (default), all dates in the interpolated data are processed.</p>
</td></tr>
<tr><td><code id="summarise_interpolated_data_+3A_months_to_summary">months_to_summary</code></td>
<td>
<p>A numeric vector with the month numbers to subset
the data before summarising. (e.g. <code>c(7,8)</code> for July and August).
This parameter allows studying particular seasons, when combined with
<code>frequency</code>. For example <code>frequency = "years"</code> and
<code>months = 6:8</code> leads to summarizing summer months of each year.</p>
</td></tr>
<tr><td><code id="summarise_interpolated_data_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the function must show messages and info.
Default value checks <code>"meteoland_verbosity"</code> option and if not set, defaults
to TRUE. It can be turned off for the function with FALSE, or session wide with
<code>options(meteoland_verbosity = FALSE)</code></p>
</td></tr>
<tr><td><code id="summarise_interpolated_data_+3A_...">...</code></td>
<td>
<p>Arguments needed for <code>fun</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>interpolated_data</code> is a nested interpolated data sf object, as
returned by <code><a href="#topic+interpolate_data">interpolate_data</a></code>, temporal summary is done for each
location present in the interpolated data. If <code>interpolated_data</code> is
an unnested interpolated data sf object, temporal summary is done for all
locations together. If <code>interpolated_data</code> is a single location data.frame
containing the dates and the interpolated variables, temporal summary is done
for that location. If <code>interpolated_data</code> is a stars object as returned
by <code><a href="#topic+interpolate_data">interpolate_data</a></code>, temporal summary is done for all the raster.
</p>


<h3>Value</h3>

<p>For a nested interpolated data, the same sf object with a new column
with the temporal summaries. For an unnested interpolated
data, a data.frame with the summarised meteo variables. For an interpolated
raster (stars object), the same raster with the temporal dimension aggregated
as desired.
</p>


<h3>Author(s)</h3>

<p>Víctor Granda García, CREAF
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# points interpolation aggregation
points_to_interpolate_example |&gt;
  interpolate_data(meteoland_interpolator_example, verbose = FALSE) |&gt;
  summarise_interpolated_data()

# raster interpolation aggregation
raster_to_interpolate_example |&gt;
  interpolate_data(meteoland_interpolator_example, verbose = FALSE) |&gt;
  summarise_interpolated_data()


</code></pre>

<hr>
<h2 id='summarise_interpolator'>Summarise interpolator objects by temporal dimension</h2><span id='topic+summarise_interpolator'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Summarises an interpolator object by the desired temporal scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarise_interpolator(
  interpolator,
  fun = "mean",
  frequency = NULL,
  vars_to_summary = c("Temperature", "MinTemperature", "MaxTemperature", "Precipitation",
    "RelativeHumidity", "MinRelativeHumidity", "MaxRelativeHumidity", "Radiation",
    "WindSpeed", "WindDirection", "PET", "SmoothedPrecipitation",
    "SmoothedTemperatureRange", "elevation", "slope", "aspect"),
  dates_to_summary = NULL,
  months_to_summary = 1:12,
  verbose = getOption("meteoland_verbosity", TRUE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarise_interpolator_+3A_interpolator">interpolator</code></td>
<td>
<p>An interpolator object as created by <code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a></code>.</p>
</td></tr>
<tr><td><code id="summarise_interpolator_+3A_fun">fun</code></td>
<td>
<p>The function to use for summarising the data.</p>
</td></tr>
<tr><td><code id="summarise_interpolator_+3A_frequency">frequency</code></td>
<td>
<p>A string indicating the interval specification (allowed ones
are &quot;week&quot;, &quot;month&quot;, &quot;quarter&quot; and &quot;year&quot;). If NULL (default), aggregation
is done in one interval for all the dates present.</p>
</td></tr>
<tr><td><code id="summarise_interpolator_+3A_vars_to_summary">vars_to_summary</code></td>
<td>
<p>A character vector with one or more variable names to
summarise. By default, all interpolated variables are summarised.</p>
</td></tr>
<tr><td><code id="summarise_interpolator_+3A_dates_to_summary">dates_to_summary</code></td>
<td>
<p>A Date object to define the dates to be summarised.
If NULL (default), all dates in the interpolated data are processed.</p>
</td></tr>
<tr><td><code id="summarise_interpolator_+3A_months_to_summary">months_to_summary</code></td>
<td>
<p>A numeric vector with the month numbers to subset
the data before summarising. (e.g. <code>c(7,8)</code> for July and August).
This parameter allows studying particular seasons, when combined with
<code>frequency</code>. For example <code>frequency = "years"</code> and
<code>months = 6:8</code> leads to summarizing summer months of each year.</p>
</td></tr>
<tr><td><code id="summarise_interpolator_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the function must show messages and info.
Default value checks <code>"meteoland_verbosity"</code> option and if not set, defaults
to TRUE. It can be turned off for the function with FALSE, or session wide with
<code>options(meteoland_verbosity = FALSE)</code></p>
</td></tr>
<tr><td><code id="summarise_interpolator_+3A_...">...</code></td>
<td>
<p>Arguments needed for <code>fun</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summarise_interpolator</code> function returns the same interpolator object provided with the
temporal dimension aggregated to desired frequency.
</p>


<h3>Author(s)</h3>

<p>Víctor Granda García, CREAF
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example interpolator
meteoland_interpolator_example

# aggregate all dates in the interpolator, calculating the maximum values
summarise_interpolator(meteoland_interpolator_example, fun = "max")

# aggregate weekly, calculating mean values
summarise_interpolator(meteoland_interpolator_example, frequency = "week")



</code></pre>

<hr>
<h2 id='utils_saturationVP'>Physical utility functions</h2><span id='topic+utils_saturationVP'></span><span id='topic+utils_airDensity'></span><span id='topic+utils_atmosphericPressure'></span><span id='topic+utils_averageDailyVP'></span><span id='topic+utils_averageDaylightTemperature'></span><span id='topic+utils_latentHeatVaporisation'></span><span id='topic+utils_latentHeatVaporisationMol'></span><span id='topic+utils_psychrometricConstant'></span><span id='topic+utils_saturationVaporPressureCurveSlope'></span>

<h3>Description</h3>

<p>Set of functions used in the calculation of physical variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utils_saturationVP(temperature)

utils_averageDailyVP(Tmin, Tmax, RHmin, RHmax)

utils_atmosphericPressure(elevation)

utils_airDensity(temperature, Patm)

utils_averageDaylightTemperature(Tmin, Tmax)

utils_latentHeatVaporisation(temperature)

utils_latentHeatVaporisationMol(temperature)

utils_psychrometricConstant(temperature, Patm)

utils_saturationVaporPressureCurveSlope(temperature)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="utils_saturationVP_+3A_temperature">temperature</code></td>
<td>
<p>Air temperature (ºC).</p>
</td></tr>
<tr><td><code id="utils_saturationVP_+3A_tmin">Tmin</code>, <code id="utils_saturationVP_+3A_tmax">Tmax</code></td>
<td>
<p>Minimum and maximum daily temperature (ºC).</p>
</td></tr>
<tr><td><code id="utils_saturationVP_+3A_rhmin">RHmin</code>, <code id="utils_saturationVP_+3A_rhmax">RHmax</code></td>
<td>
<p>Minimum and maximum relative humidity (%).</p>
</td></tr>
<tr><td><code id="utils_saturationVP_+3A_elevation">elevation</code></td>
<td>
<p>Elevation above sea level (in m).</p>
</td></tr>
<tr><td><code id="utils_saturationVP_+3A_patm">Patm</code></td>
<td>
<p>Atmospheric air pressure (in kPa).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Values returned for each function are: </p>

<ul>
<li><p><code>utils_airDensity</code>: air density (in kg·m-3).
</p>
</li>
<li><p><code>utils_atmosphericPressure</code>: Air atmospheric pressure (in kPa).
</p>
</li>
<li><p><code>utils_averageDailyVP</code>: average (actual) vapour pressure (in kPa).
</p>
</li>
<li><p><code>utils_averageDaylightTemperature</code>: average daylight air
temperature (in ºC). </p>
<p><code>utils_latentHeatVaporisation</code>: Latent heat
of vaporisation (MJ·kg-1).  </p>
<p><code>utils_latentHeatVaporisationMol</code>:
Latent heat of vaporisation (J·mol-1).
</p>
</li>
<li><p><code>utils_psychrometricConstant</code>: Psychrometric constant (kPa·ºC-1).
</p>
</li>
<li><p><code>utils_saturationVP</code>: saturation vapour pressure (in kPa).
</p>
</li>
<li><p><code>utils_saturationVaporPressureCurveSlope</code>: Slope of the saturation
vapor pressure curve (kPa·ºC-1).  </p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>utils_averageDailyVP()</code>: Average daily VP
</p>
</li>
<li> <p><code>utils_atmosphericPressure()</code>: Atmospheric pressure
</p>
</li>
<li> <p><code>utils_airDensity()</code>: Air density
</p>
</li>
<li> <p><code>utils_averageDaylightTemperature()</code>: Daylight temperature
</p>
</li>
<li> <p><code>utils_latentHeatVaporisation()</code>: latent heat vaporisation
</p>
</li>
<li> <p><code>utils_latentHeatVaporisationMol()</code>: Heat vaporisation mol
</p>
</li>
<li> <p><code>utils_psychrometricConstant()</code>: psychrometric constant
</p>
</li>
<li> <p><code>utils_saturationVaporPressureCurveSlope()</code>: Saturation VP curve slope
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Miquel De Cáceres Ainsa, CREAF
</p>


<h3>References</h3>

<p>McMurtrie, R. E., D. A. Rook, and F. M. Kelliher. 1990.
Modelling the yield of Pinus radiata on a site limited by water and
nitrogen. Forest Ecology and Management 30:381–413.
</p>
<p>McMahon, T. A., M. C. Peel, L. Lowe, R. Srikanthan, and T. R. McVicar. 2013.
Estimating actual, potential, reference crop and pan evaporation using
standard meteorological data: a pragmatic synthesis. Hydrology &amp; Earth
System Sciences 17:1331–1363. See also:
http://www.fao.org/docrep/x0490e/x0490e06.htm
</p>

<hr>
<h2 id='with_meteo'>Ensure meteo object is ready to create an interpolator object</h2><span id='topic+with_meteo'></span>

<h3>Description</h3>

<p>Check integrity of meteo objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>with_meteo(meteo, verbose = getOption("meteoland_verbosity", TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="with_meteo_+3A_meteo">meteo</code></td>
<td>
<p>meteo object</p>
</td></tr>
<tr><td><code id="with_meteo_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if the function must show messages and info.
Default value checks <code>"meteoland_verbosity"</code> option and if not set, defaults
to TRUE. It can be turned off for the function with FALSE, or session wide with
<code>options(meteoland_verbosity = FALSE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is the first step in the creation of a meteoland interpolator,
ensuring the meteo provided contains all the required elements
</p>


<h3>Value</h3>

<p>invisible meteo object ready to pipe in the interpolator creation
</p>


<h3>See Also</h3>

<p>Other interpolator functions: <code><a href="#topic+add_topo">add_topo</a>()</code>,
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a>()</code>,
<code><a href="#topic+get_interpolation_params">get_interpolation_params</a>()</code>, <code><a href="#topic+read_interpolator">read_interpolator</a>()</code>,
<code><a href="#topic+set_interpolation_params">set_interpolation_params</a>()</code>, <code><a href="#topic+write_interpolator">write_interpolator</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example meteo
data(meteoland_meteo_example)
with_meteo(meteoland_meteo_example)

</code></pre>

<hr>
<h2 id='worldmet2meteoland'>From worldmet to meteoland meteo objects</h2><span id='topic+worldmet2meteoland'></span>

<h3>Description</h3>

<p>Adapting <code><a href="worldmet.html#topic+importNOAA">importNOAA</a></code> meteo objects to meteoland meteo objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worldmet2meteoland(meteo, complete = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="worldmet2meteoland_+3A_meteo">meteo</code></td>
<td>
<p>worldmet meteo object.</p>
</td></tr>
<tr><td><code id="worldmet2meteoland_+3A_complete">complete</code></td>
<td>
<p>logical indicating if the meteo data missing variables
should be calculated (if possible). Default to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function converts <code><a href="worldmet.html#topic+importNOAA">importNOAA</a></code> meteo objects to
compatible meteoland meteo objects by selecting the needed variables and
adapting the names to comply with meteoland requirements. Also it aggregates
subdaily data as well as complete missing variables if possible (setting
<code>complete = TRUE</code>)
</p>


<h3>Value</h3>

<p>a compatible meteo object to use with meteoland.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (interactive()) {
  # worldmet data
  library(worldmet)
  worldmet_stations &lt;- worldmet::getMeta(lat = 42, lon = 0, n = 2, plot = FALSE)
  worldmet_subdaily_2022 &lt;-
    worldmet::importNOAA(worldmet_stations$code, year = 2022, hourly = TRUE)

  # just convert
  worldmet2meteoland(worldmet_subdaily_2022)
  # convert and complete
  worldmet2meteoland(worldmet_subdaily_2022, complete = TRUE)

}

</code></pre>

<hr>
<h2 id='write_interpolator'>Write the interpolator object</h2><span id='topic+write_interpolator'></span>

<h3>Description</h3>

<p>Write the interpolator object to a file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_interpolator(interpolator, filename, .overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_interpolator_+3A_interpolator">interpolator</code></td>
<td>
<p>meteoland interpolator object, as created by
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a></code></p>
</td></tr>
<tr><td><code id="write_interpolator_+3A_filename">filename</code></td>
<td>
<p>file name for the interpolator nc file</p>
</td></tr>
<tr><td><code id="write_interpolator_+3A_.overwrite">.overwrite</code></td>
<td>
<p>logical indicating if the file should be overwritten if it
already exists</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function writes the interpolator object created with
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a></code> in a NetCDF-CF standard
compliant format, as specified in
https://cfconventions.org/cf-conventions/cf-conventions.html
</p>


<h3>Value</h3>

<p>invisible interpolator object, to allow using this function as a
step in a pipe
</p>


<h3>Author(s)</h3>

<p>Victor Granda García, EMF-CREAF
</p>


<h3>See Also</h3>

<p>Other interpolator functions: <code><a href="#topic+add_topo">add_topo</a>()</code>,
<code><a href="#topic+create_meteo_interpolator">create_meteo_interpolator</a>()</code>,
<code><a href="#topic+get_interpolation_params">get_interpolation_params</a>()</code>, <code><a href="#topic+read_interpolator">read_interpolator</a>()</code>,
<code><a href="#topic+set_interpolation_params">set_interpolation_params</a>()</code>, <code><a href="#topic+with_meteo">with_meteo</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# example interpolator
data(meteoland_interpolator_example)

# temporal folder
tmp_dir &lt;- tempdir()

# write interpolator
write_interpolator(
  meteoland_interpolator_example,
  file.path(tmp_dir, "meteoland_interpolator_example.nc"),
  .overwrite = TRUE
)

# check file exists
file.exists(file.path(tmp_dir, "meteoland_interpolator_example.nc"))

# read it again
read_interpolator(file.path(tmp_dir, "meteoland_interpolator_example.nc"))


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
