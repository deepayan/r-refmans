<!DOCTYPE html><html lang="en"><head><title>Help for package epizootic</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {epizootic}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#epizootic-package'><p>epizootic: Spatially Explicit Population Models of Disease Transmission in Wildlife</p></a></li>
<li><a href='#aspatial_siri'><p>Helper Function for Seasonal SIRI Simulation</p></a></li>
<li><a href='#bsl_raster'><p>Raster of breeding season length for the house finch</p></a></li>
<li><a href='#check_aspatial_siri_inputs'><p>Helper function to check the validity of inputs to the <code>siri_model_summer</code></p>
and <code>siri_model_winter</code> functions.</a></li>
<li><a href='#check_simulator_inputs'><p>Helper function to check the validity of inputs to the <code>disease_simulator</code></p>
function.</a></li>
<li><a href='#disease_dispersal'><p>Nested functions for population dispersal in a disease ecology simulation.</p></a></li>
<li><a href='#disease_results'><p>Nested functions for initializing, calculating and collecting disease</p>
simulator results.</a></li>
<li><a href='#disease_simulator'><p>Stage-based seasonal spatially explicit population-level disease model.</p></a></li>
<li><a href='#disease_transformation'><p>Nested functions for a user-defined transformation of a population affected</p>
by a disease outbreak.</a></li>
<li><a href='#disease_transitions'><p>Nested functions for stage- and compartment-based population transitions in</p>
an outbreak.</a></li>
<li><a href='#DiseaseModel'><p>R6 class representing a disease model of the <em>Mycoplasma gallisepticum</em></p>
outbreak in <em>Haemorhous mexicanus</em></a></li>
<li><a href='#finch_region'><p>Study region for house finch conjunctivitis simulations</p></a></li>
<li><a href='#habitat_suitability'><p>House finch habitat suitability</p></a></li>
<li><a href='#initial_abundance'><p>Initial house finch abundance</p></a></li>
<li><a href='#SimulationHandler'><p>R6 class representing a simulation handler.</p></a></li>
<li><a href='#siri_model_summer'><p>Simulate a <em>Mycoplasma gallisepticum</em> Outbreak in the Breeding Season</p></a></li>
<li><a href='#siri_model_winter'><p>Simulate a <em>Mycoplasma gallisepticum</em> Outbreak in the Non-Breeding Season</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Spatially Explicit Population Models of Disease Transmission in
Wildlife</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>This extension of the pattern-oriented modeling framework of the 
    'poems' package provides a collection of modules and functions customized 
    for modeling disease transmission on a population scale in a spatiotemporally 
    explicit manner. This includes seasonal time steps, dispersal functions that 
    track disease state of dispersers, results objects that store disease states, 
    and a population simulator that includes disease dynamics.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/viralemergence/epizootic">https://github.com/viralemergence/epizootic</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/viralemergence/epizootic/issues">https://github.com/viralemergence/epizootic/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>purrr (&ge; 1.0.0), dplyr (&ge; 1.1.3), tibble (&ge; 3.2.1), R6 (&ge;
2.5.1), cli (&ge; 3.6.1), raster (&ge; 3.6), qs (&ge; 0.25.7), poems
(&ge; 1.1.0), doParallel (&ge; 1.0.16), foreach (&ge; 1.5.1), Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), geosphere (&ge; 1.5), knitr (&ge; 1.17),
rmarkdown (&ge; 1.6)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'DiseaseModel.R' 'RcppExports.R' 'SimulationHandler.R'
'aspatial_siri_seasons.R' 'check_aspatial_siri_inputs.R'
'check_simulator_inputs.R' 'data.R' 'disease_dispersal.r'
'disease_results.R' 'disease_simulator.R'
'disease_transformation.R' 'disease_transitions.R'
'epizootic-package.R'</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-30 18:40:10 UTC; caryinstitute</td>
</tr>
<tr>
<td>Author:</td>
<td>July Pilowsky <a href="https://orcid.org/0000-0002-6376-2585"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  National Science Foundation Biology Integration Institute 2213854 [fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>July Pilowsky &lt;pilowskyj@caryinstitute.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-02 13:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='epizootic-package'>epizootic: Spatially Explicit Population Models of Disease Transmission in Wildlife</h2><span id='topic+epizootic'></span><span id='topic+epizootic-package'></span>

<h3>Description</h3>

<p>This extension of the pattern-oriented modeling framework of the 'poems' package provides a collection of modules and functions customized for modeling disease transmission on a population scale in a spatiotemporally explicit manner. This includes seasonal time steps, dispersal functions that track disease state of dispersers, results objects that store disease states, and a population simulator that includes disease dynamics.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: July Pilowsky <a href="mailto:pilowskyj@caryinstitute.org">pilowskyj@caryinstitute.org</a> (<a href="https://orcid.org/0000-0002-6376-2585">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> National Science Foundation Biology Integration Institute 2213854 [funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/viralemergence/epizootic">https://github.com/viralemergence/epizootic</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/viralemergence/epizootic/issues">https://github.com/viralemergence/epizootic/issues</a>
</p>
</li></ul>


<hr>
<h2 id='aspatial_siri'>Helper Function for Seasonal SIRI Simulation</h2><span id='topic+aspatial_siri'></span>

<h3>Description</h3>

<p>This function is an internal one that does the aspatial simulations within
one population for one timestep, for any given season.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aspatial_siri(
  initial_pop,
  season_length,
  mortality,
  transmission,
  recovery,
  fecundity,
  abundance_threshold,
  carrying_capacity,
  season
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aspatial_siri_+3A_initial_pop">initial_pop</code></td>
<td>
<p>A vector of length 8 showing the initial abundance for
each combination of stage and compartment.</p>
</td></tr>
<tr><td><code id="aspatial_siri_+3A_season_length">season_length</code></td>
<td>
<p>The length of the season in days.</p>
</td></tr>
<tr><td><code id="aspatial_siri_+3A_mortality">mortality</code></td>
<td>
<p>A vector of length 8 with the mortality rates for each
stage and compartment in the season in question.</p>
</td></tr>
<tr><td><code id="aspatial_siri_+3A_transmission">transmission</code></td>
<td>
<p>A vector of length 8 with the transmission rates for each
stage in the season in question.</p>
</td></tr>
<tr><td><code id="aspatial_siri_+3A_recovery">recovery</code></td>
<td>
<p>A vector of length 8 with the recovery rates for each
infected stage in the season in question.</p>
</td></tr>
<tr><td><code id="aspatial_siri_+3A_fecundity">fecundity</code></td>
<td>
<p>A vector of length 8 with the fecundity for each
reproductive segment.</p>
</td></tr>
<tr><td><code id="aspatial_siri_+3A_abundance_threshold">abundance_threshold</code></td>
<td>
<p>A quasi-extinction threshold below which a
population becomes extinct.</p>
</td></tr>
<tr><td><code id="aspatial_siri_+3A_carrying_capacity">carrying_capacity</code></td>
<td>
<p>A single numeric that indicates the carrying
capacity of the population in this season.</p>
</td></tr>
<tr><td><code id="aspatial_siri_+3A_season">season</code></td>
<td>
<p>Either &quot;breeding&quot; or &quot;non-breeding.&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length 8 showing the abundance for each combination of
stage and compartment at the end of the season.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>aspatial_siri(
 initial_pop = c(50000, 50000, 0, 1, 0, 0, 0, 0),
 season_length = 100,
 mortality = c(0.004, 0, 0.00505, 0.00105, 0.004, 0, 0.0045, 5e-04),
 fecundity = c(0, 15/182, 0, 15/182, 0, 15/182, 0, 15/182),
 transmission = c(0.00002, 0.00001, 0, 0, 7.84e-06, 3.92e-06, 0, 0),
 recovery = c(0, 0, 0.05714286, 0.05714286, 0, 0, 0.1, 0.1),
 carrying_capacity = 150000,
 abundance_threshold = 10,
 season = "breeding"
)
</code></pre>

<hr>
<h2 id='bsl_raster'>Raster of breeding season length for the house finch</h2><span id='topic+bsl_raster'></span>

<h3>Description</h3>

<p>This is a RasterBrick object containing data on the breeding season
length in days of the house finch in North America from 1994 to 2016. I
created this dataset using a machine learning algorithm on season length data
from the eastern bluebird, which is noted to have a very similar breeding
season to the house finch. The raster has the same resolution as the
<code><a href="#topic+finch_region">finch_region</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bsl_raster
</code></pre>


<h3>Format</h3>

<p>A RasterBrick with 17066 cells and 23 layers.
</p>

<hr>
<h2 id='check_aspatial_siri_inputs'>Helper function to check the validity of inputs to the <code>siri_model_summer</code>
and <code>siri_model_winter</code> functions.</h2><span id='topic+check_aspatial_siri_inputs'></span>

<h3>Description</h3>

<p>This is an internal function that checks inputs to the <code>disease_simulator</code>
function to make sure they are valid, and sets default values for needed
inputs if their values are not supplied. The possible inputs for this
function are the same as the possible inputs to the <code>disease_simulator</code>
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_aspatial_siri_inputs(inputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_aspatial_siri_inputs_+3A_inputs">inputs</code></td>
<td>
<p>A nested list with named elements:
</p>

<dl>
<dt><code>replicates</code></dt><dd><p>Number of replicate simulation runs.</p>
</dd>
<dt><code>time_steps</code></dt><dd><p>Number of simulation time steps.</p>
</dd>
<dt><code>populations</code></dt><dd><p>Number of populations.</p>
</dd>
<dt><code>stages</code></dt><dd><p>Number of life cycle stages.</p>
</dd>
<dt><code>compartments</code></dt><dd><p>Number of disease compartments (e.g., 3 for a
SIR model).</p>
</dd>
<dt><code>abundance_threshold</code></dt><dd><p>A quasi-extinction threshold at
which a population becomes extinct.</p>
</dd>
<dt><code>mortality</code></dt><dd><p>A vector of mortality rates, one for each
combination of stages and compartments.</p>
</dd>
<dt><code>mortality_unit</code></dt><dd><p>A vector indicating whether mortality rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>fecundity</code></dt><dd><p>A vector of fecundity rates, one for each
combination of stages and compartments for which fecundity applies.</p>
</dd>
<dt><code>fecundity_unit</code></dt><dd><p>A vector indicating whether fecundity rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>fecundity_mask</code></dt><dd><p>A vector indicating which stages and
compartments reproduce.</p>
</dd>
<dt><code>transmission</code></dt><dd><p>A vector of transmission rates, one for each
combination of stages and compartment for which transmission applies (see
<code>transmission_mask</code> below.</p>
</dd>
<dt><code>transmission_unit</code></dt><dd><p>A vector indicating whether mortality
rates are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>transmission_mask</code></dt><dd><p>A vector indicating which stages and
compartments are subject to transmission (i.e., classes susceptible to
infection.)</p>
</dd>
<dt><code>recovery</code></dt><dd><p>A vector of recovery rates, one for each
combination of stages and compartment for which recovery applies (see
<code>recovery_mask</code> below.)</p>
</dd>
<dt><code>recovery_unit</code></dt><dd><p>A vector indicating whether mortality rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>recovery_mask</code></dt><dd><p>A vector indicating which compartments are
subject to recovery (i.e., infected classes that can recover.)</p>
</dd>
<dt><code>r</code></dt><dd><p>Simulation replicate.</p>
</dd>
<dt><code>tm</code></dt><dd><p>Simulation time step.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array of carrying capacity values for
each population at time step.</p>
</dd>
<dt><code>breeding_season_length</code></dt><dd><p>Array of breeding season lengths in
days for each population at time step.</p>
</dd>
<dt><code>segment_abundance</code></dt><dd><p>Matrix of (current) abundance for each
stage-compartment combo (rows) and population (columns) at time step.</p>
</dd>
<dt><code>occupied_indices</code></dt><dd><p>Array of indices for populations occupied
at (current) time step.</p>
</dd>
<dt><code>simulator</code></dt><dd><p><code><a href="poems.html#topic+SimulatorReference">poems::SimulatorReference</a></code> object with
dynamically accessible <em>attached</em> and <em>results</em> lists.</p>
</dd>
<dt><code>additional attributes</code></dt><dd><p>Additional attributes when the
transformation is optionally nested in a list.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>A list identical to the inputs (if there are no errors.)
</p>

<hr>
<h2 id='check_simulator_inputs'>Helper function to check the validity of inputs to the <code>disease_simulator</code>
function.</h2><span id='topic+check_simulator_inputs'></span>

<h3>Description</h3>

<p>This is an internal function that checks inputs to the <code>disease_simulator</code>
function to make sure they are valid, and sets default values for needed
inputs if their values are not supplied. The possible inputs for this
function are the same as the possible inputs to the <code>disease_simulator</code>
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_simulator_inputs(inputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_simulator_inputs_+3A_inputs">inputs</code></td>
<td>
<p>Nested list/object with named elements:
</p>

<dl>
<dt><code>random_seed</code></dt><dd><p>Number to seed the random number generation for
stochasticity.</p>
</dd>
<dt><code>replicates</code></dt><dd><p>Number of replicate simulation runs (default is
1.)</p>
</dd>
<dt><code>time_steps</code></dt><dd><p>Number of simulation years. Required input.</p>
</dd>
<dt><code>seasons</code></dt><dd><p>Number of seasons per year (default is 2.)</p>
</dd>
<dt><code>populations</code></dt><dd><p>Number of populations. Required input.</p>
</dd>
<dt><code>coordinates</code></dt><dd><p>Data frame (or matrix) of X-Y population
coordinates.</p>
</dd>
<dt><code>stages</code></dt><dd><p>Number of life cycle stages. Default: 1.</p>
</dd>
<dt><code>compartments</code></dt><dd><p>Number of disease compartments (e.g., 3 for a
SIR model). Default: 1.</p>
</dd>
<dt><code>region</code></dt><dd><p>A <code><a href="poems.html#topic+Region">poems::Region</a></code> object
defining the study region.</p>
</dd>
<dt><code>initial_abundance</code></dt><dd><p>Array (or matrix) of initial abundances.
There must be one column per population and one row per compartment/stage
combination. By default, this should be in the order compartment by stage,
e.g., 2 stage classes plus a SI model should be ordered as S1, S2, I1, I2.
If a region object is attached, then initial abundance may be provided in
the form of a raster with the same specs as the region raster and one
layer per stage/compartment combination. If there is only one
stage/compartment combination you may provide a vector with length
<code>populations</code>. Required input.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array (matrix) of carrying capacity values
at each population cell (<code>populations</code> rows by <code>time_steps</code>
columns when across time). Required input.</p>
</dd>
<dt><code>breeding_season_length</code></dt><dd><p>Array (matrix) of breeding season
length values in days at each population cell (<code>populations</code> rows by
<code>time_steps</code> columns when across time). Can also be a vector of length
<code>populations</code> if the breeding season length does not change over
time.</p>
</dd>
<dt><code>season_lengths</code></dt><dd><p>Vector of season lengths in days. Length must
equal <code>seasons</code>. If neither <code>breeding_season_length</code> nor
<code>season_lengths</code> are provided, season lengths will default to
<code>365/seasons</code>.</p>
</dd>
<dt><code>correlation</code></dt><dd><p>List containing either an environmental
correlation matrix (correlation_matrix), a pre-calculated transposed
(Cholesky) decomposition matrix (t_decomposition_matrix), or a compact
transposed (Cholesky) decomposition matrix (t_decomposition_compact_matrix)
and a corresponding map of population indices (t_decomposition_compact_map),
as per <code><a href="poems.html#topic+SpatialCorrelation">poems::SpatialCorrelation</a></code> class attributes.</p>
</dd>
<dt><code>mortality</code></dt><dd><p>A vector of mortality rates, one for each
combination of stages and compartments. Assumed by default to be daily
mortality rates unless indicated otherwise (see below). If mortality varies
by season, a list of mortality vectors with the same length as <code>seasons</code>
may be provided instead. Required input.</p>
</dd>
<dt><code>mortality_unit</code></dt><dd><p>A vector indicating whether mortality rates are
daily or seasonal. 1 indicates seasonal, 0 indicates daily. Default: all 0.
A list of vectors may be provided if this varies by season.</p>
</dd>
<dt><code>fecundity</code></dt><dd><p>A vector of fecundity rates, one for each
combination of stages and compartments for which fecundity applies (see
<code>fecundity_mask</code> below). If fecundity varies among seasons, a list of
fecundity vectors with the same length as <code>seasons</code> may be provided.
Required input.</p>
</dd>
<dt><code>fecundity_unit</code></dt><dd><p>A vector indicating whether fecundity rates are
daily or seasonal. 1 indicates seasonal, 0 indicates daily. Default: all 0.
A list of vectors may be provided if this varies by season.</p>
</dd>
<dt><code>fecundity_mask</code></dt><dd><p>A vector indicating which stages and
compartments reproduce. Must be the same length as
<code>stages * compartments</code>. A list of vectors may be provided if this
varies by season. If no fecundity mask is provided, then it is assumed that
all stages and compartments reproduce.</p>
</dd>
<dt><code>abundance_threshold</code></dt><dd><p>A quasi-extinction threshold at which a
population becomes extinct. Default: 0.</p>
</dd>
<dt><code>demographic_stochasticity</code></dt><dd><p>Boolean for choosing demographic
stochasticity for transition, dispersal, and/or other processes (default is
TRUE).</p>
</dd>
<dt><code>transmission</code></dt><dd><p>A vector of transmission rates, one for each
combination of stages and compartment for which transmission applies (see
<code>transmission_mask</code> below). If transmission varies by season, a list of
transmission vectors with the same length as <code>seasons</code> may be provided
instead. Required input.</p>
</dd>
<dt><code>transmission_unit</code></dt><dd><p>A vector indicating whether transmission
is daily or seasonal. 1 indicates seasonal, 0 indicates daily. Default: all
0. A list of vectors may be provided if this varies by season.</p>
</dd>
<dt><code>transmission_mask</code></dt><dd><p>A vector indicating which stages and
compartments are subject to transmission (i.e., classes susceptible to
infection.) Must be the same length as <code>compartments</code>. A list of
vectors may be provided if this varies by season. If no transmission mask is
provided, then it is assumed that all stages in the first compartment are
susceptible to infection.</p>
</dd>
<dt><code>recovery</code></dt><dd><p>A vector of recovery rates, one for each
combination of stages and compartment for which recovery applies (see
<code>recovery_mask</code> below.) If recovery varies by season, a list of
recovery vectors the same length as <code>seasons</code> may be provided instead.</p>
</dd>
<dt><code>recovery_unit</code></dt><dd><p>A vector
indicating whether recovery rates are daily or seasonal. 1 indicates
seasonal, 0 indicates daily. Default: all 0. A list of vectors may be
provided if this varies by season.</p>
</dd>
<dt><code>recovery_mask</code></dt><dd><p>A
vector indicating which compartments are subject to recovery (i.e., infected
classes that can recover.) Must be the same length as <code>compartments</code>.
A list of vectors may be provided if this varies by season. If no recovery
mask is provided, then it is assumed that all stages in the second
compartment can recover, if there is a second compartment.</p>
</dd>
<dt><code>dispersal</code></dt><dd><p>A list that is either length 1 or the same length as
<code>stages</code>. If it is length 1, the same dispersal will be applied across
all stages. Within each element of the list, there should be either a function,
a matrix of dispersal rates between populations (source columns to target
rows) or a list of data frames of non-zero dispersal rates and indices for
constructing a compact dispersal matrix, and optional changing rates over
time (as per class <code><a href="poems.html#topic+DispersalGenerator">poems::DispersalGenerator</a></code> <em>dispersal_data</em>
attribute).</p>
</dd>
<dt><code>dispersal_source_n_k</code></dt><dd><p>Dispersal proportion (p) density
dependence via source population abundance divided by carrying capacity
(n/k), where p is reduced via a linear slope (defined by two list items)
from n/k &lt;= <em>cutoff</em> (p = 0) to n/k \&gt;= <em>threshold</em> (aliases:
<em>dispersal_n_k_cutoff</em> &amp; <em>dispersal_n_k_threshold</em>).</p>
</dd>
<dt><code>dispersal_target_k</code></dt><dd><p>Dispersal rate (r) density dependence via
target population carrying capacity (k), where r is reduced via a linear
slope (through the origin) when k &lt;= <em>threshold</em> (alias:
<em>dispersal_k_threshold</em>).</p>
</dd>
<dt><code>dispersal_target_n</code></dt><dd><p>Dispersal
rate (r) density dependence via target population abundance (n), where r is
reduced via a linear slope (defined by two list items) from n \&gt;=
<em>threshold</em> to n &lt;= <em>cutoff</em> (r = 0) or vice versa (aliases:
<em>dispersal_n_threshold</em> &amp; <em>dispersal_n_cutoff</em>).</p>
</dd>
<dt><code>dispersal_target_n_k</code></dt><dd><p>Dispersal rate (r) density dependence via
target population abundance divided by carrying capacity (n/k), where r is
reduced via a linear slope (defined by two list items) from n/k \&gt;=
<em>threshold</em> to n/k &lt;= <em>cutoff</em> (r = 0) or vice versa.</p>
</dd>
<dt><code>season_functions</code></dt><dd><p>A list of population transformation functions
(functions that change abundance across stages and compartments) the same
length as <code>seasons.</code> The function must be in the form
<code>function(params)</code>, where <code>params</code> is a list passed to the
function containing:
</p>

<dl>
<dt><code>replicates</code></dt><dd><p>Number of replicate simulation runs
(default is 1.)</p>
</dd>
<dt><code>time_steps</code></dt><dd><p>Number of simulation years. Required
input.</p>
</dd>
<dt><code>seasons</code></dt><dd><p>Number of seasons per year (default is 2.)</p>
</dd>
<dt><code>populations</code></dt><dd><p>Number of populations. Required input.</p>
</dd>
<dt><code>stages</code></dt><dd><p>Number of life cycle stages. Default: 1.</p>
</dd>
<dt><code>compartments</code></dt><dd><p>Number of disease compartments (e.g., 3
for a SIR model). Default: 1.</p>
</dd>
<dt><code>breeding_season_length</code></dt><dd><p>Array (matrix) of breeding
season length values in days at each population cell
(<code>populations</code> rows by <code>time_steps</code> columns when across
time).</p>
</dd>
<dt><code>season_lengths</code></dt><dd><p>Vector of season lengths in days.
Length must equal <code>seasons</code>.</p>
</dd>
<dt><code>mortality</code></dt><dd><p>A vector of mortality rates, one for each
combination of stages and compartments. Assumed by default to be
daily mortality rates. Required input.</p>
</dd>
<dt><code>mortality_unit</code></dt><dd><p>A vector indicating whether mortality
rates are daily or seasonal. 1 indicates seasonal, 0 indicates
daily. Default: all 0.</p>
</dd>
<dt><code>fecundity</code></dt><dd><p>A vector of fecundity rates, one for each
combination of stages and compartments for which fecundity applies
(see <code>fecundity_mask</code> below). Required input.</p>
</dd>
<dt><code>fecundity_unit</code></dt><dd><p>A vector indicating whether mortality
rates are daily or seasonal. 1 indicates seasonal, 0 indicates
daily. Default: all 0.</p>
</dd>
<dt><code>fecundity_mask</code></dt><dd><p>A vector indicating which stages and
compartments reproduce. Must be the same length as
<code>stages * compartments</code>.</p>
</dd>
<dt><code>abundance_threshold</code></dt><dd><p>A quasi-extinction threshold below
which a population becomes extinct. Default: 0.</p>
</dd>
<dt><code>demographic_stochasticity</code></dt><dd><p>Boolean for choosing
demographic stochasticity for transition, dispersal, and/or other
processes (default is TRUE).</p>
</dd>
<dt><code>transmission</code></dt><dd><p>A vector of transmission rates, one for
each combination of stages and compartments. Assumed by default to
be daily transmission rates. Required input.</p>
</dd>
<dt><code>transmission_unit</code></dt><dd><p>A vector indicating whether
mortality rates are daily or seasonal. 1 indicates seasonal, 0
indicates daily. Default: all 0.</p>
</dd>
<dt><code>recovery</code></dt><dd><p>A vector of recovery rates, one for each
combination of stages and compartment for which recovery applies
(see <code>recovery_mask</code> below.)</p>
</dd>
<dt><code>recovery_unit</code></dt><dd><p>A vector indicating whether mortality
rates are daily or seasonal. 1 indicates seasonal, 0 indicates
daily. Default: all 0.</p>
</dd>
<dt><code>recovery_mask</code></dt><dd><p>A vector indicating which compartments
are subject to recovery (i.e., infected classes that can recover.)
Must be the same length as <code>compartments</code>.</p>
</dd>
<dt><code>r</code></dt><dd><p>Simulation replicate.</p>
</dd>
<dt><code>tm</code></dt><dd><p>Simulation time step.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array of carrying capacity values
for each population at time step.</p>
</dd>
<dt><code>segment_abundance</code></dt><dd><p>Matrix of abundance for each
combination of stage and compartment (rows) and population (columns)
at time step.</p>
</dd>
<dt><code>occupied_indices</code></dt><dd><p>Array of indices for populations
occupied at time step.</p>
</dd>
<dt><code>simulator</code></dt><dd><p><code><a href="poems.html#topic+SimulatorReference">poems::SimulatorReference</a></code> object
with dynamically accessible <em>attached</em> and <em>results</em>
lists.</p>
</dd>
<dt><code>additional attributes</code></dt><dd><p>Additional attributes when the
transformation is optionally nested in a list.</p>
</dd>
</dl>

<p>and returns a transformed stage abundance matrix.</p>
</dd>
<dt><code>simulation_order</code></dt><dd><p>A list the same length as <code>seasons</code>.
Each element in the list is a vector of named simulation processes in the
desired order. Processes must be one of &quot;transition&quot;, &quot;dispersal&quot;,
&quot;season_functions&quot;, or &quot;results.&quot;</p>
</dd>
<dt><code>dispersal_type</code></dt><dd><p>A character vector that may contain &quot;pooled&quot;
(if all individuals disperse the same), &quot;stages&quot;, &quot;compartments&quot;, or
&quot;segments&quot;, if different stages, compartments, or stage-compartment
combinations disperse differently. If &quot;pooled&quot; is chosen,
<code>dispersal</code> must be a list of length 1. If &quot;stages&quot; is chosen, it
must be the same length as <code>stages</code>, if &quot;compartments&quot; is chosen,
it must be the same length as <code>compartments</code>, and if &quot;segments&quot; is
chosen, it must be the same length as stages*compartments. The default
value is &quot;pooled&quot;.</p>
</dd>
<dt><code>results_selection</code></dt><dd><p>List of results selection from: &quot;abundance&quot;
(default), &quot;ema&quot;, &quot;extirpation&quot;, &quot;extinction_location&quot;,
&quot;occupancy&quot;; &quot;summarize&quot; (default) or &quot;replicate&quot;.</p>
</dd>
<dt><code>results_breakdown</code></dt><dd><p>A string with one of these values:
&quot;segments&quot; (default),
&quot;compartments&quot;, &quot;stages&quot; or &quot;pooled.&quot; &quot;segments&quot; returns results for each
segment (stage x compartment combination.) &quot;compartments&quot; returns results for
each disease compartment. &quot;stages&quot; returns results for each life cycle stage.
&quot;pooled&quot; returns results that are not broken down by stage or compartment.</p>
</dd>
<dt><code>verbose</code></dt><dd><p>TRUE or FALSE, indicating if the user wants informative
messages throughout the simulation process.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>A list identical to the inputs, except with default values supplied
to fill in any crucial missing values, as explained in the documentation
above.
</p>

<hr>
<h2 id='disease_dispersal'>Nested functions for population dispersal in a disease ecology simulation.</h2><span id='topic+disease_dispersal'></span>

<h3>Description</h3>

<p>Modular functions for the disease simulator for performing dispersal of
segment (stage by compartment) abundance at a specified time step via
dispersal rates provided. Dispersal can be handled identically for all stages
and compartments, or can be handled differently by stage, compartment, or
both.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disease_dispersal(
  replicates,
  time_steps,
  populations,
  demographic_stochasticity,
  dispersal,
  dispersal_type,
  dispersal_source_n_k = NULL,
  dispersal_target_k = NULL,
  dispersal_target_n = NULL,
  dispersal_target_n_k = NULL,
  stages = NULL,
  compartments = NULL,
  simulator
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="disease_dispersal_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicate simulation runs.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_time_steps">time_steps</code></td>
<td>
<p>Number of simulation time steps.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_populations">populations</code></td>
<td>
<p>Number of populations.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_demographic_stochasticity">demographic_stochasticity</code></td>
<td>
<p>Boolean for optionally choosing demographic
stochasticity for the transformation.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_dispersal">dispersal</code></td>
<td>
<p>Must be a list. Either a list of matrices of dispersal rates
between populations (source columns to target rows) or a list of data
frames of non-zero dispersal rates and indices for constructing a compact
dispersal matrix, and optionally a list of lists of data frames showing
changing rates over time (as per class <code><a href="poems.html#topic+DispersalGenerator">poems::DispersalGenerator</a></code>
<em>dispersal_data</em> attribute). Alternatively a list of user-defined
functions may be used: <code>function(params)</code>, where <em>params</em> is a
list passed to the function containing:
</p>

<dl>
<dt><code>replicates</code></dt><dd><p>Number of replicate simulation runs.</p>
</dd>
<dt><code>time_steps</code></dt><dd><p>Number of simulation time steps.</p>
</dd>
<dt><code>populations</code></dt><dd><p>Number of populations.</p>
</dd>
<dt><code>stages</code></dt><dd><p>Number of life cycle stages.</p>
</dd>
<dt><code>compartments</code></dt><dd><p>Number of disease compartments.</p>
</dd>
<dt><code>dispersal_type</code></dt><dd><p>Must be &quot;pooled&quot;, &quot;stages&quot;, &quot;compartments&quot;, or &quot;segments&quot;. This indicates whether dispersal should be handled differently by stage and/or compartment.</p>
</dd>
<dt><code>demographic_stochasticity</code></dt><dd><p>Boolean for optionally choosing demographic stochasticity for the transformation.</p>
</dd>
<dt><code>dispersal_source_n_k</code></dt><dd><p>Dispersal proportion (p) density dependence via source population abundance divided by carrying capacity (n/k), where p is reduced via a linear slope (defined by two list items) from n/k &lt;= <em>cutoff</em> (p = 0) to n/k &gt;= <em>threshold</em>.</p>
</dd>
<dt><code>dispersal_target_k</code></dt><dd><p>Dispersal rate (r) density dependence via target population carrying capacity (k), where r is reduced via a linear slope (through the origin) when k &lt;= <em>threshold</em>.</p>
</dd>
<dt><code>dispersal_target_n</code></dt><dd><p>Dispersal rate (r) density dependence via target population abundance (n), where r is reduced via a linear slope (defined by two list items) from n &gt;= <em>threshold</em> to n &lt;= <em>cutoff</em> (r = 0) or vice versa.</p>
</dd>
<dt><code>dispersal_target_n_k</code></dt><dd><p>Dispersal rate (r) density dependence via target population abundance divided by carrying capacity (n/k), where r is reduced via a linear slope (defined by two list items) from n/k &gt;= <em>threshold</em> to n/k &lt;= <em>cutoff</em> (r = 0) or vice versa.</p>
</dd>
<dt><code>r</code></dt><dd><p>Simulation replicate.</p>
</dd>
<dt><code>tm</code></dt><dd><p>Simulation time step.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array of carrying capacity values for each population at time step.</p>
</dd>
<dt><code>segment_abundance</code></dt><dd><p>Matrix of abundance for each stage by compartment (rows) and population (columns) at time step.</p>
</dd>
<dt><code>simulator</code></dt><dd><p><code><a href="poems.html#topic+SimulatorReference">poems::SimulatorReference</a></code> object with dynamically accessible <em>attached</em> and <em>results</em> lists.</p>
</dd>
</dl>

<p>returns the post-dispersal abundance matrix</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_dispersal_type">dispersal_type</code></td>
<td>
<p>Must be &quot;pooled&quot;, &quot;stages&quot;, &quot;compartments&quot;, or
&quot;segments&quot;. This indicates whether dispersal should be handled differently
by stage and/or compartment.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_dispersal_source_n_k">dispersal_source_n_k</code></td>
<td>
<p>Dispersal proportion (p) density dependence via
source population abundance divided by carrying capacity (n/k), where p is
reduced via a linear slope (defined by two list items) from n/k &lt;=
<em>cutoff</em> (p = 0) to n/k &gt;= <em>threshold</em> or vice versa.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_dispersal_target_k">dispersal_target_k</code></td>
<td>
<p>Dispersal rate (r) density dependence via target
population carrying capacity (k), where r is reduced via a linear slope
(through the origin) when k &lt;= <em>threshold</em>.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_dispersal_target_n">dispersal_target_n</code></td>
<td>
<p>Dispersal rate (r) density dependence via target
population abundance (n), where r is reduced via a linear slope (defined by
two list items) from n &gt;= <em>threshold</em> to n &lt;= <em>cutoff</em> (r = 0) or
visa-versa.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_dispersal_target_n_k">dispersal_target_n_k</code></td>
<td>
<p>Dispersal rate (r) density dependence via target
population abundance divided by carrying capacity (n/k), where r is reduced
via a linear slope (defined by two list items) from n/k &gt;= <em>threshold</em>
to n/k &lt;= <em>cutoff</em> (r = 0) or vice versa.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_stages">stages</code></td>
<td>
<p>Number of life cycle stages.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_compartments">compartments</code></td>
<td>
<p>Number of disease compartments.</p>
</td></tr>
<tr><td><code id="disease_dispersal_+3A_simulator">simulator</code></td>
<td>
<p><code><a href="poems.html#topic+SimulatorReference">poems::SimulatorReference</a></code> object with dynamically
accessible <em>attached</em> and <em>results</em> lists.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dispersal function: <code>function(r, tm, carrying_capacity,
  segment_abundance)</code>, where:
</p>

<dl>
<dt><code>r</code></dt><dd><p>Simulation replicate.</p>
</dd>
<dt><code>tm</code></dt><dd><p>Simulation time step.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array of carrying capacity values for each population at time step.</p>
</dd>
<dt><code>segment_abundance</code></dt><dd><p>Matrix of abundance for each stage by compartment (rows) and population (columns) at time step.</p>
</dd>
<dt><code>returns</code></dt><dd><p>New stage abundance matrix with dispersal applied.</p>
</dd>
</dl>


<hr>
<h2 id='disease_results'>Nested functions for initializing, calculating and collecting disease
simulator results.</h2><span id='topic+disease_results'></span>

<h3>Description</h3>

<p>Modular functions for the disease simulator for initializing, calculating and
collecting simulator results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disease_results(
  replicates,
  time_steps,
  seasons,
  stages,
  compartments,
  coordinates,
  initial_abundance,
  results_selection = NULL,
  results_breakdown = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="disease_results_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicate simulation runs.</p>
</td></tr>
<tr><td><code id="disease_results_+3A_time_steps">time_steps</code></td>
<td>
<p>Number of simulation time steps.</p>
</td></tr>
<tr><td><code id="disease_results_+3A_seasons">seasons</code></td>
<td>
<p>Number of seasons per time step.</p>
</td></tr>
<tr><td><code id="disease_results_+3A_stages">stages</code></td>
<td>
<p>Number of life cycle stages.</p>
</td></tr>
<tr><td><code id="disease_results_+3A_compartments">compartments</code></td>
<td>
<p>Number of disease compartments.</p>
</td></tr>
<tr><td><code id="disease_results_+3A_coordinates">coordinates</code></td>
<td>
<p>Data frame (or matrix) of X-Y population coordinates.</p>
</td></tr>
<tr><td><code id="disease_results_+3A_initial_abundance">initial_abundance</code></td>
<td>
<p>Matrix of initial abundances at each combination of
stage and compartment (in rows) for each population (in columns).</p>
</td></tr>
<tr><td><code id="disease_results_+3A_results_selection">results_selection</code></td>
<td>
<p>List of results selection from: &quot;abundance&quot;
(default), &quot;ema&quot;, &quot;extirpation&quot;, &quot;extinction_location&quot;, &quot;harvested&quot;,
&quot;occupancy&quot;; &quot;summarize&quot; (default) or &quot;replicate&quot;. &quot;summarize&quot; calculates
mean, sd, min and max across replicates. &quot;replicate&quot; returns results
separately for each replicate.</p>
</td></tr>
<tr><td><code id="disease_results_+3A_results_breakdown">results_breakdown</code></td>
<td>
<p>A string with one of these values: &quot;segments&quot; (default),
&quot;compartments&quot;, &quot;stages&quot; or &quot;pooled.&quot; &quot;segments&quot; returns results for each
segment (stage x compartment combination.) &quot;compartments&quot; returns results for
each disease compartment. &quot;stages&quot; returns results for each life cycle stage.
&quot;pooled&quot; returns results that are not broken down by stage or compartment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of result functions:
</p>

<dl>
<dt><code>initialize_attributes = function())</code></dt><dd><p>Constructs and returns
an initialized nested list for the selected result attributes.</p>
</dd>
<dt><code>initialize_replicate = function(results)</code></dt><dd><p>Initializes and
returns nested result attributes at the start of each replicate.</p>
</dd>
<dt><code>calculate_at_season = function(r, tm, season,
    segment_abundance, harvested, results)</code></dt><dd><p>Appends and calculates
(non-NULL) results and returns nested result attributes at the end of
each season within time step (tm) within replicate (r).</p>
</dd>
<dt><code>calculate_at_timestep = function(r, tm, segment_abundance,
    harvested, results)</code></dt><dd><p>Appends and calculates (non-NULL) results and
returns nested result attributes at the end of each time step (tm) within
replicate (r).</p>
</dd>
<dt><code>finalize_attributes = function(results)</code></dt><dd><p>Finalizes result
calculations at the end of the simulation.</p>
</dd>
</dl>


<hr>
<h2 id='disease_simulator'>Stage-based seasonal spatially explicit population-level disease model.</h2><span id='topic+disease_simulator'></span>

<h3>Description</h3>

<p>Simulates a stage-based demographic population model and returns simulation
results across multiple replicate runs. Processes run at each simulation
time-step include:
</p>

<ol>
<li><p> Stage transition (stochastic) calculations
</p>
</li>
<li><p> Population growth/decline calculations
</p>
</li>
<li><p> Disease outbreak according to a compartmental model
</p>
</li>
<li><p> Dispersal calculations (default or user-defined)
</p>
</li>
<li><p> Results collection
</p>
</li></ol>

<p>Note that the breeding season is
always treated as the first season.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disease_simulator(inputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="disease_simulator_+3A_inputs">inputs</code></td>
<td>
<p>Nested list/object with named elements:
</p>

<dl>
<dt><code>random_seed</code></dt><dd><p>Number to seed the random number generation for
stochasticity.</p>
</dd>
<dt><code>replicates</code></dt><dd><p>Number of replicate simulation runs (default is
1.)</p>
</dd>
<dt><code>time_steps</code></dt><dd><p>Number of simulation years. Required input.</p>
</dd>
<dt><code>seasons</code></dt><dd><p>Number of seasons per year (default is 2.)</p>
</dd>
<dt><code>populations</code></dt><dd><p>Number of populations. Required input.</p>
</dd>
<dt><code>coordinates</code></dt><dd><p>Data frame (or matrix) of X-Y population
coordinates.</p>
</dd>
<dt><code>stages</code></dt><dd><p>Number of life cycle stages. Default: 1.</p>
</dd>
<dt><code>compartments</code></dt><dd><p>Number of disease compartments (e.g., 3 for a
SIR model). Default: 1.</p>
</dd>
<dt><code>region</code></dt><dd><p>A <code><a href="poems.html#topic+Region">poems::Region</a></code> object
defining the study region.</p>
</dd>
<dt><code>initial_abundance</code></dt><dd><p>Array (or matrix) of initial abundances.
There must be one column per population and one row per compartment/stage
combination. By default, this should be in the order compartment by stage,
e.g., 2 stage classes plus a SI model should be ordered as S1, S2, I1, I2.
If a region object is attached, then initial abundance may be provided in
the form of a raster with the same specs as the region raster and one
layer per stage/compartment combination. If there is only one
stage/compartment combination you may provide a vector with length
<code>populations</code>. Required input.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array (matrix) of carrying capacity values
at each population cell (<code>populations</code> rows by <code>time_steps</code>
columns when across time). Required input.</p>
</dd>
<dt><code>breeding_season_length</code></dt><dd><p>Array (matrix) of breeding season
length values in days at each population cell (<code>populations</code> rows by
<code>time_steps</code> columns when across time). Can also be a vector of length
<code>populations</code> if the breeding season length does not change over
time.</p>
</dd>
<dt><code>season_lengths</code></dt><dd><p>Vector of season lengths in days. Length must
equal <code>seasons</code>. If neither <code>breeding_season_length</code> nor
<code>season_lengths</code> are provided, season lengths will default to
<code>365/seasons</code>.</p>
</dd>
<dt><code>correlation</code></dt><dd><p>List containing either an environmental
correlation matrix (correlation_matrix), a pre-calculated transposed
(Cholesky) decomposition matrix (t_decomposition_matrix), or a compact
transposed (Cholesky) decomposition matrix (t_decomposition_compact_matrix)
and a corresponding map of population indices (t_decomposition_compact_map),
as per <code><a href="poems.html#topic+SpatialCorrelation">poems::SpatialCorrelation</a></code> class attributes.</p>
</dd>
<dt><code>mortality</code></dt><dd><p>A vector of mortality rates, one for each
combination of stages and compartments. Assumed by default to be daily
mortality rates unless indicated otherwise (see below). If mortality varies
by season, a list of mortality vectors with the same length as <code>seasons</code>
may be provided instead. Required input.</p>
</dd>
<dt><code>mortality_unit</code></dt><dd><p>A vector indicating whether mortality rates are
daily or seasonal. 1 indicates seasonal, 0 indicates daily. Default: all 0.
A list of vectors may be provided if this varies by season.</p>
</dd>
<dt><code>fecundity</code></dt><dd><p>A vector of fecundity rates, one for each
combination of stages and compartments for which fecundity applies (see
<code>fecundity_mask</code> below). If fecundity varies among seasons, a list of
fecundity vectors with the same length as <code>seasons</code> may be provided.
Required input.</p>
</dd>
<dt><code>fecundity_unit</code></dt><dd><p>A vector indicating whether fecundity rates are
daily or seasonal. 1 indicates seasonal, 0 indicates daily. Default: all 0.
A list of vectors may be provided if this varies by season.</p>
</dd>
<dt><code>fecundity_mask</code></dt><dd><p>A vector indicating which stages and
compartments reproduce. Must be the same length as
<code>stages * compartments</code>. A list of vectors may be provided if this
varies by season. If no fecundity mask is provided, then it is assumed that
all stages and compartments reproduce.</p>
</dd>
<dt><code>abundance_threshold</code></dt><dd><p>A quasi-extinction threshold at which a
population becomes extinct. Default: 0.</p>
</dd>
<dt><code>demographic_stochasticity</code></dt><dd><p>Boolean for choosing demographic
stochasticity for transition, dispersal, and/or other processes (default is
TRUE).</p>
</dd>
<dt><code>transmission</code></dt><dd><p>A vector of transmission rates, one for each
combination of stages and compartment for which transmission applies (see
<code>transmission_mask</code> below. If transmission varies by season, a list of
transmission vectors with the same length as <code>seasons</code> may be provided
instead. Required input.</p>
</dd>
<dt><code>transmission_unit</code></dt><dd><p>A vector indicating whether transmission
is daily or seasonal. 1 indicates seasonal, 0 indicates daily. Default: all
0. A list of vectors may be provided if this varies by season.</p>
</dd>
<dt><code>transmission_mask</code></dt><dd><p>A vector indicating which stages and
compartments are subject to transmission (i.e., classes susceptible to
infection.) Must be the same length as <code>compartments</code>. A list of
vectors may be provided if this varies by season. If no transmission mask is
provided, then it is assumed that all stages in the first compartment are
susceptible to infection.</p>
</dd>
<dt><code>recovery</code></dt><dd><p>A vector of recovery rates, one for each
combination of stages and compartment for which recovery applies (see
<code>recovery_mask</code> below.) If recovery varies by season, a list of
recovery vectors the same length as <code>seasons</code> may be provided instead.</p>
</dd>
<dt><code>recovery_unit</code></dt><dd><p>A vector
indicating whether recovery rates are daily or seasonal. 1 indicates
seasonal, 0 indicates daily. Default: all 0. A list of vectors may be
provided if this varies by season.</p>
</dd>
<dt><code>recovery_mask</code></dt><dd><p>A
vector indicating which compartments are subject to recovery (i.e., infected
classes that can recover.) Must be the same length as <code>compartments</code>.
A list of vectors may be provided if this varies by season. If no recovery
mask is provided, then it is assumed that all stages in the second
compartment can recover, if there is a second compartment.</p>
</dd>
<dt><code>dispersal</code></dt><dd><p>A list that is either length 1 or the same length as
<code>stages</code>. If it is length 1, the same dispersal will be applied across
all stages. Within each element of the list, there should be either a function,
a matrix of dispersal rates between populations (source columns to target
rows) or a list of data frames of non-zero dispersal rates and indices for
constructing a compact dispersal matrix, and optional changing rates over
time (as per class <code><a href="poems.html#topic+DispersalGenerator">poems::DispersalGenerator</a></code> <em>dispersal_data</em>
attribute).</p>
</dd>
<dt><code>dispersal_source_n_k</code></dt><dd><p>Dispersal proportion (p) density
dependence via source population abundance divided by carrying capacity
(n/k), where p is reduced via a linear slope (defined by two list items)
from n/k &lt;= <em>cutoff</em> (p = 0) to n/k \&gt;= <em>threshold</em> (aliases:
<em>dispersal_n_k_cutoff</em> &amp; <em>dispersal_n_k_threshold</em>).</p>
</dd>
<dt><code>dispersal_target_k</code></dt><dd><p>Dispersal rate (r) density dependence via
target population carrying capacity (k), where r is reduced via a linear
slope (through the origin) when k &lt;= <em>threshold</em> (alias:
<em>dispersal_k_threshold</em>).</p>
</dd>
<dt><code>dispersal_target_n</code></dt><dd><p>Dispersal
rate (r) density dependence via target population abundance (n), where r is
reduced via a linear slope (defined by two list items) from n \&gt;=
<em>threshold</em> to n &lt;= <em>cutoff</em> (r = 0) or vice versa (aliases:
<em>dispersal_n_threshold</em> &amp; <em>dispersal_n_cutoff</em>).</p>
</dd>
<dt><code>dispersal_target_n_k</code></dt><dd><p>Dispersal rate (r) density dependence via
target population abundance divided by carrying capacity (n/k), where r is
reduced via a linear slope (defined by two list items) from n/k \&gt;=
<em>threshold</em> to n/k &lt;= <em>cutoff</em> (r = 0) or vice versa.</p>
</dd>
<dt><code>season_functions</code></dt><dd><p>A list of population transformation functions
(functions that change abundance across stages and compartments) the same
length as <code>seasons.</code> The function must be in the form
<code>function(params)</code>, where <code>params</code> is a list passed to the
function containing:
</p>

<dl>
<dt><code>replicates</code></dt><dd><p>Number of replicate simulation runs
(default is 1.)</p>
</dd>
<dt><code>time_steps</code></dt><dd><p>Number of simulation years. Required
input.</p>
</dd>
<dt><code>seasons</code></dt><dd><p>Number of seasons per year (default is 2.)</p>
</dd>
<dt><code>populations</code></dt><dd><p>Number of populations. Required input.</p>
</dd>
<dt><code>stages</code></dt><dd><p>Number of life cycle stages. Default: 1.</p>
</dd>
<dt><code>compartments</code></dt><dd><p>Number of disease compartments (e.g., 3
for a SIR model). Default: 1.</p>
</dd>
<dt><code>breeding_season_length</code></dt><dd><p>Array (matrix) of breeding
season length values in days at each population cell
(<code>populations</code> rows by <code>time_steps</code> columns when across
time).</p>
</dd>
<dt><code>season_lengths</code></dt><dd><p>Vector of season lengths in days.
Length must equal <code>seasons</code>.</p>
</dd>
<dt><code>mortality</code></dt><dd><p>A vector of mortality rates, one for each
combination of stages and compartments. Assumed by default to be
daily mortality rates. Required input.</p>
</dd>
<dt><code>mortality_unit</code></dt><dd><p>A vector indicating whether mortality
rates are daily or seasonal. 1 indicates seasonal, 0 indicates
daily. Default: all 0.</p>
</dd>
<dt><code>fecundity</code></dt><dd><p>A vector of fecundity rates, one for each
combination of stages and compartments for which fecundity applies
(see <code>fecundity_mask</code> below). Required input.</p>
</dd>
<dt><code>fecundity_unit</code></dt><dd><p>A vector indicating whether mortality
rates are daily or seasonal. 1 indicates seasonal, 0 indicates
daily. Default: all 0.</p>
</dd>
<dt><code>fecundity_mask</code></dt><dd><p>A vector indicating which stages and
compartments reproduce. Must be the same length as
<code>stages * compartments</code>.</p>
</dd>
<dt><code>abundance_threshold</code></dt><dd><p>A quasi-extinction threshold below
which a population becomes extinct. Default: 0.</p>
</dd>
<dt><code>demographic_stochasticity</code></dt><dd><p>Boolean for choosing
demographic stochasticity for transition, dispersal, and/or other
processes (default is TRUE).</p>
</dd>
<dt><code>transmission</code></dt><dd><p>A vector of transmission rates, one for
each combination of stages and compartments. Assumed by default to
be daily transmission rates. Required input.</p>
</dd>
<dt><code>transmission_unit</code></dt><dd><p>A vector indicating whether
mortality rates are daily or seasonal. 1 indicates seasonal, 0
indicates daily. Default: all 0.</p>
</dd>
<dt><code>recovery</code></dt><dd><p>A vector of recovery rates, one for each
combination of stages and compartment for which recovery applies
(see <code>recovery_mask</code> below.)</p>
</dd>
<dt><code>recovery_unit</code></dt><dd><p>A vector indicating whether mortality
rates are daily or seasonal. 1 indicates seasonal, 0 indicates
daily. Default: all 0.</p>
</dd>
<dt><code>recovery_mask</code></dt><dd><p>A vector indicating which compartments
are subject to recovery (i.e., infected classes that can recover.)
Must be the same length as <code>compartments</code>.</p>
</dd>
<dt><code>r</code></dt><dd><p>Simulation replicate.</p>
</dd> <dt><code>tm</code></dt><dd><p>Simulation
time step.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array of carrying capacity values
for each population at time step.</p>
</dd>
<dt><code>segment_abundance</code></dt><dd><p>Matrix of abundance for each
combination of stage and compartment (rows) and population (columns)
at time step.</p>
</dd>
<dt><code>occupied_indices</code></dt><dd><p>Array of indices for populations
occupied at time step.</p>
</dd>
<dt><code>simulator</code></dt><dd><p><code><a href="poems.html#topic+SimulatorReference">poems::SimulatorReference</a></code> object
with dynamically accessible <em>attached</em> and <em>results</em>
lists.</p>
</dd>
<dt><code>additional attributes</code></dt><dd><p>Additional attributes when the
transformation is optionally nested in a list.</p>
</dd>
</dl>

<p>and returns a transformed stage abundance matrix.
</p>
</dd>
<dt><code>simulation_order</code></dt><dd><p>A list the same length as <code>seasons</code>.
Each element in the list is a vector of named simulation processes in the
desired order. Processes must be one of &quot;transition&quot;, &quot;dispersal&quot;,
&quot;season_functions&quot;, or &quot;results.&quot;
&quot;season_functions&quot; will be matched to the appropriate season (i.e., if
&quot;season_functions&quot; appears in element 1 of the list, <code>season_functions[[1]]</code>
will be called.) If the simulation processes are the same across seasons,
then a single character vector may be provided. Required input.</p>
</dd>
<dt><code>dispersal_type</code></dt><dd><p>A character vector that may contain &quot;pooled&quot;
(if all individuals disperse the same), &quot;stages&quot;, &quot;compartments&quot;, or
&quot;segments&quot;, if different stages, compartments, or stage-compartment
combinations disperse differently. If &quot;pooled&quot; is chosen,
<code>dispersal</code> must be a list of length 1. If &quot;stages&quot; is chosen, it
must be the same length as <code>stages</code>, if &quot;compartments&quot; is chosen,
it must be the same length as <code>compartments</code>, and if &quot;segments&quot; is
chosen, it must be the same length as stages*compartments. The default
value is &quot;pooled&quot;.</p>
</dd>
<dt><code>results_selection</code></dt><dd><p>List of results selection from: &quot;abundance&quot;
(default), &quot;ema&quot;, &quot;extirpation&quot;, &quot;extinction_location&quot;,
&quot;occupancy&quot;; &quot;summarize&quot; (default) or &quot;replicate&quot;.</p>
</dd>
<dt><code>results_breakdown</code></dt><dd><p>A string with one of these values:
&quot;segments&quot; (default),
&quot;compartments&quot;, &quot;stages&quot; or &quot;pooled.&quot; &quot;segments&quot; returns results for each
segment (stage x compartment combination.) &quot;compartments&quot; returns results for
each disease compartment. &quot;stages&quot; returns results for each life cycle stage.
&quot;pooled&quot; returns results that are not broken down by stage or compartment.</p>
</dd>
<dt><code>verbose</code></dt><dd><p>TRUE or FALSE, indicating if the user wants informative
messages throughout the simulation process.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>Selected simulation results as a nested list summarized (mean, sd,
min, max) across multiple replicates (default), or 2-3D arrays including
results for each replicate:
</p>

<dl>
<dt><code>abundance</code></dt><dd><p>Matrix or 3D array of simulation abundance:
<em>populations</em> rows by <em>time_steps</em> columns (by <em>replicates</em>
deep).</p>
</dd>
<dt><code>abundance_stages</code></dt><dd><p>List of matrices or 3D arrays of simulation
abundance for unique stage-compartment combinations when present: each
<em>populations</em> rows by <em>time_steps</em> columns (by <em>replicates</em>
deep).</p>
</dd>
<dt><code>all$abundance</code></dt><dd><p>Array or matrix of total abundance across
populations: <em>time_steps</em> (rows by <em>replicates</em> columns).</p>
</dd>
<dt><code>all$abundance_stages</code></dt><dd><p>List of arrays or matrices of total
abundance across populations for unique stage-compartment combinations when
present: each <em>time_steps</em> (rows by <em>replicates</em> columns).</p>
</dd>
<dt><code>all$ema</code></dt><dd><p>Array of expected minimum abundance at each time step
(averaged across replicates).</p>
</dd>
<dt><code>extirpation</code></dt><dd><p>Array or matrix of extirpation times:
<em>populations</em> (rows by <em>replicates</em> columns).</p>
</dd>
<dt><code>all$extirpation</code></dt><dd><p>Array of extirpation time across populations
for each replicate.</p>
</dd>
<dt><code>all$extinction_location</code></dt><dd><p>The weighted centroid of cells
occupied in the time-step prior to the extirpation of all populations
(if it occurred) for each replicate.</p>
</dd>
<dt><code>all$occupancy</code></dt><dd><p>Array or matrix of the number of populations
occupied at each time-step: <em>time_steps</em> (rows by <em>replicates</em>
columns).</p>
</dd>
<dt><code>additional results</code></dt><dd><p>Additional results may be attached via
user-defined functions (using <code>params$simulator$results</code>).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>inputs &lt;- list(
 time_steps = 5,
 seasons = 2,
 populations = 25,
 stages = 2,
 compartments = 4,
 coordinates = data.frame(x = rep(seq(177.01, 177.05, 0.01), 5),
                          y = rep(seq(-18.01, -18.05, -0.01), each = 5)),
 initial_abundance = c(c(5000, 5000, 0, 1, 0, 0, 0, 0),
                       rep(c(5000, 5000, 0, 0, 0, 0, 0, 0), 24)) |&gt;
   matrix(nrow = 8),
 carrying_capacity = matrix(100000, nrow = 25, ncol = 5),
 breeding_season_length = rep(100, 25),
 mortality = c(0.4, 0, 0.505, 0.105, 0.4, 0, 0.45, 0.05),
 mortality_unit = 1,
 fecundity = 15,
 fecundity_unit = 1,
 fecundity_mask = c(0, 1, 0, 1, 0, 1, 0, 1),
 transmission = c(0.00002, 0.00001, 7.84e-06, 3.92e-06),
 transmission_unit = 0,
 transmission_mask = c(1, 1, 0, 0, 1, 1, 0, 0),
 recovery = c(0.05714286, 0.05714286, 0.1, 0.1),
 recovery_unit = rep(0, 8),
 recovery_mask = c(0, 0, 1, 1, 0, 0, 1, 1),
 season_functions = list(siri_model_summer, siri_model_winter),
 simulation_order = c("transition", "season_functions", "results")
)
disease_simulator(inputs)

</code></pre>

<hr>
<h2 id='disease_transformation'>Nested functions for a user-defined transformation of a population affected
by a disease outbreak.</h2><span id='topic+disease_transformation'></span>

<h3>Description</h3>

<p>Modular functions for the disease simulator for performing a transformation
of a population across stages and disease compartments (and optionally
carrying capacity) at a specified time step via a user-defined function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disease_transformation(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="disease_transformation_+3A_params">params</code></td>
<td>
<p>A list of parameters, which must contain all of the below,
except <code>name</code>, which is optional:
</p>

<dl>
<dt><code>replicates</code></dt><dd><p>Number of replicate simulation runs.</p>
</dd>
<dt><code>time_steps</code></dt><dd><p>Number of simulation time steps.</p>
</dd>
<dt><code>years_per_step</code></dt><dd><p>Number of years per time step.</p>
</dd>
<dt><code>populations</code></dt><dd><p>Number of populations.</p>
</dd>
<dt><code>seasons</code></dt><dd><p>Number of seasons per year.</p>
</dd>
<dt><code>stages</code></dt><dd><p>Number of life cycle stages.</p>
</dd>
<dt><code>compartments</code></dt><dd><p>Number of disease compartments (e.g., 3 for a
SIR model).</p>
</dd>
<dt><code>demographic_stochasticity</code></dt><dd><p>Boolean for optionally choosing
demographic stochasticity for the transformation.</p>
</dd>
<dt><code>density_stages</code></dt><dd><p>Array of booleans or numeric (0,1) for each
stage to indicate which stages are affected by density.</p>
</dd>
<dt><code>abundance_threshold</code></dt><dd><p>A quasi-extinction threshold at
which a population becomes extinct.</p>
</dd>
<dt><code>mortality</code></dt><dd><p>A vector of mortality rates, one for each
combination of stages and compartments.</p>
</dd>
<dt><code>mortality_unit</code></dt><dd><p>A vector indicating whether mortality rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>fecundity</code></dt><dd><p>A vector of fecundity rates, one for each
combination of stages and compartments for which fecundity applies.</p>
</dd>
<dt><code>fecundity_unit</code></dt><dd><p>A vector indicating whether fecundity rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>fecundity_mask</code></dt><dd><p>A vector indicating which stages and
compartments reproduce.</p>
</dd>
<dt><code>transmission</code></dt><dd><p>A vector of transmission rates, one for each
combination of stages and compartment for which transmission applies (see
<code>transmission_mask</code> below.</p>
</dd>
<dt><code>transmission_unit</code></dt><dd><p>A vector indicating whether mortality
rates are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>transmission_mask</code></dt><dd><p>A vector indicating which stages and
compartments are subject to transmission (i.e., classes susceptible to
infection.)</p>
</dd>
<dt><code>recovery</code></dt><dd><p>A vector of recovery rates, one for each
combination of stages and compartment for which recovery applies (see
<code>recovery_mask</code> below.)</p>
</dd>
<dt><code>recovery_unit</code></dt><dd><p>A vector indicating whether mortality rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>recovery_mask</code></dt><dd><p>A vector indicating which compartments are
subject to recovery (i.e., infected classes that can recover.)</p>
</dd>
<dt><code>transformation</code></dt><dd><p>A user-defined function (optionally nested in a list
with additional attributes) for performing transformation using <code>params</code> as
arguments.</p>
</dd>
<dt><code>simulator</code></dt><dd><p><code><a href="poems.html#topic+SimulatorReference">poems::SimulatorReference</a></code> object with
dynamically accessible <em>attached</em> and <em>results</em> lists.</p>
</dd>
<dt><code>name</code></dt><dd><p>Optional name for the transformation function.</p>
</dd>
<dt><code>additional attributes</code></dt><dd><p>Additional attributes when the
transformation is optionally nested in a list.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>Abundance (and capacity) transformation function:
<code>function(r, tm, carrying_capacity, segment_abundance,
occupied_indices)</code>, where:
</p>

<dl>
<dt><code>r</code></dt><dd><p>Simulation replicate.</p>
</dd>
<dt><code>tm</code></dt><dd><p>Simulation time step.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array of carrying capacity values for
each population at time step.</p>
</dd>
<dt><code>segment_abundance</code></dt><dd><p>Matrix of abundance for each
stage-compartment combo (rows) and population (columns) at time step.</p>
</dd>
<dt><code>occupied_indices</code></dt><dd><p>Array of indices for populations occupied
at time step.</p>
</dd>
<dt><code>returns</code></dt><dd><p>List with transformed stage abundance matrix (and
optionally carrying capacity).</p>
</dd>
</dl>


<hr>
<h2 id='disease_transitions'>Nested functions for stage- and compartment-based population transitions in
an outbreak.</h2><span id='topic+disease_transitions'></span>

<h3>Description</h3>

<p>Modular functions for the disease simulator to transition populations
between stages and within disease compartments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disease_transitions(stages, compartments)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="disease_transitions_+3A_stages">stages</code></td>
<td>
<p>Number of life cycle stages.</p>
</td></tr>
<tr><td><code id="disease_transitions_+3A_compartments">compartments</code></td>
<td>
<p>Number of disease compartments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Transition calculation function that takes as input:
</p>

<dl>
<dt><code>segment_abundance</code></dt><dd><p>Matrix of (current) abundance for each
stage-compartment combo (rows) and population (columns) at time step.</p>
</dd>
<dt><code>occupied_indices</code></dt><dd><p>Array of indices for populations occupied
at (current) time step.</p>
</dd>
</dl>


<hr>
<h2 id='DiseaseModel'>R6 class representing a disease model of the <em>Mycoplasma gallisepticum</em>
outbreak in <em>Haemorhous mexicanus</em></h2><span id='topic+DiseaseModel'></span>

<h3>Description</h3>

<p>A <code><a href="R6.html#topic+R6Class">R6::R6Class</a></code> class representing fixed settings
for a spatially-explicit demographic-based SIRI model of disease dynamics. It
extends the <code><a href="poems.html#topic+SimulationModel">poems::SimulationModel</a></code> class with parameters for the
<code><a href="#topic+disease_simulator">disease_simulator</a></code> function. It inherits functionality for
creating a nested model, whereby a nested template model with fixed
parameters is maintained when a model is cloned for various sampled
parameters. Also provided are extensions to the methods for checking the
consistency and completeness of model parameters.
</p>


<h3>Super classes</h3>

<p><code><a href="poems.html#topic+GenericClass">poems::GenericClass</a></code> -&gt; <code><a href="poems.html#topic+GenericModel">poems::GenericModel</a></code> -&gt; <code><a href="poems.html#topic+SpatialModel">poems::SpatialModel</a></code> -&gt; <code><a href="poems.html#topic+SimulationModel">poems::SimulationModel</a></code> -&gt; <code>DiseaseModel</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>attached</code></dt><dd><p>A list of dynamically attached attributes (name-value
pairs).</p>
</dd>
</dl>

</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>simulation_function</code></dt><dd><p>Name (character string) or source path of the
default simulation function, which takes a model as an input and
returns the simulation results.</p>
</dd>
<dt><code>model_attributes</code></dt><dd><p>A vector of model attribute names.</p>
</dd>
<dt><code>region</code></dt><dd><p>A <code><a href="poems.html#topic+Region">poems::Region</a></code> (or inherited class) object specifying
the study region.</p>
</dd>
<dt><code>coordinates</code></dt><dd><p>Data frame (or matrix) of X-Y population (WGS84)
coordinates in longitude (degrees West) and latitude (degrees North)
(get and set), or distance-based coordinates dynamically returned by
region raster (get only).</p>
</dd>
<dt><code>random_seed</code></dt><dd><p>Number to seed the random number generation for
stochasticity.</p>
</dd>
<dt><code>replicates</code></dt><dd><p>Number of replicate simulation runs.</p>
</dd>
<dt><code>time_steps</code></dt><dd><p>Number of simulation time steps.</p>
</dd>
<dt><code>years_per_step</code></dt><dd><p>Number of years per time step.</p>
</dd>
<dt><code>populations</code></dt><dd><p>Number of population cells.</p>
</dd>
<dt><code>initial_abundance</code></dt><dd><p>Array (matrix) or raster (stack) of initial
abundance values at each population cell (for each age/stage).</p>
</dd>
<dt><code>demographic_stochasticity</code></dt><dd><p>Boolean for choosing demographic
stochasticity for transition, dispersal, harvest and/or other processes.</p>
</dd>
<dt><code>standard_deviation</code></dt><dd><p>Standard deviation matrix (or single value) for
applying environmental stochasticity to transition rates.</p>
</dd>
<dt><code>correlation</code></dt><dd><p>Simulator-dependent attribute or list of attributes
for describing/parameterizing the correlation strategy utilized when
applying environmental stochasticity and/or other processes (see
<code><a href="poems.html#topic+population_simulator">poems::population_simulator</a></code>).</p>
</dd>
<dt><code>stages</code></dt><dd><p>Number of life cycle stages (default 1).</p>
</dd>
<dt><code>compartments</code></dt><dd><p>Number of disease compartments (default 1).</p>
</dd>
<dt><code>results_breakdown</code></dt><dd><p>A string with one of these values: &quot;segments&quot; (default),
&quot;compartments&quot;, &quot;stages&quot; or &quot;pooled.&quot; &quot;segments&quot; returns results for each
segment (stage x compartment combination.) &quot;compartments&quot; returns results for
each disease compartment. &quot;stages&quot; returns results for each life cycle stage.
&quot;pooled&quot; returns results that are not broken down by stage or compartment.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array (matrix), or raster (stack) of carrying
capacity values at each population cell (across time).</p>
</dd>
<dt><code>density_dependence</code></dt><dd><p>Simulator-dependent function, attribute or list
of attributes for describing/parameterizing the density dependence
strategy utilized (see <code><a href="poems.html#topic+population_simulator">poems::population_simulator</a></code>).</p>
</dd>
<dt><code>growth_rate_max</code></dt><dd><p>Maximum growth rate (utilized by density
dependence processes).</p>
</dd>
<dt><code>fecundity</code></dt><dd><p>A vector of fecundity rates, one for each combination of
stages and compartments for which fecundity applies (see
<code>fecundity_mask</code> below). If fecundity varies among seasons, a list
of fecundity vectors with the same length as <code>seasons</code> may be
provided. Required input.</p>
</dd>
<dt><code>density_stages</code></dt><dd><p>Array of booleans or numeric (0-1) for each stage
to indicate (the degree to) which stages are affected by density
(default is 1 for all stages).</p>
</dd>
<dt><code>translocation</code></dt><dd><p>Simulator-dependent function, attribute or list of
attributes for describing/parameterizing translocation (management)
strategies utilized (see <code><a href="poems.html#topic+population_simulator">poems::population_simulator</a></code>).</p>
</dd>
<dt><code>harvest</code></dt><dd><p>Simulator-dependent function, attribute or list of
attributes for describing/parameterizing a harvest (organism
removal/hunting) strategy (see <code><a href="poems.html#topic+population_simulator">poems::population_simulator</a></code>).</p>
</dd>
<dt><code>mortality</code></dt><dd><p>Simulator-dependent function, attribute or list of
attributes to describe/parameterize a spatio-temporal mortality
strategy (see <code><a href="poems.html#topic+population_simulator">poems::population_simulator</a></code>).</p>
</dd>
<dt><code>dispersal</code></dt><dd><p>Simulator-dependent function, attribute or list of
attributes for describing/parameterizing the dispersal (migration)
strategy utilized (see <code><a href="#topic+disease_simulator">disease_simulator</a></code>).</p>
</dd>
<dt><code>dispersal_stages</code></dt><dd><p>Array of relative dispersal (0-1) for each stage
to indicate the degree to which each stage participates in dispersal
(default is 1 for all stages).</p>
</dd>
<dt><code>dispersal_source_n_k</code></dt><dd><p>Simulator-dependent attribute for
describing/parameterizing dispersal dependent on source population
abundance divided by carrying capacity (see
<code><a href="#topic+disease_simulator">disease_simulator</a></code>).</p>
</dd>
<dt><code>dispersal_target_k</code></dt><dd><p>Simulator-dependent attribute for
describing/parameterizing dispersal dependent on target population
carrying capacity (see <code><a href="#topic+disease_simulator">disease_simulator</a></code>).</p>
</dd>
<dt><code>dispersal_target_n</code></dt><dd><p>Simulator-dependent attribute (default is list
with <em>threshold</em> and <em>cutoff</em>) of attributes for
describing/parameterizing dispersal dependent on target population
abundance (see <code><a href="#topic+disease_simulator">disease_simulator</a></code>).</p>
</dd>
<dt><code>dispersal_target_n_k</code></dt><dd><p>Simulator-dependent attribute (default is
list with <em>threshold</em> and <em>cutoff</em>) of attributes for
describing/parameterizing dispersal dependent on target population
abundance/capacity (see <code><a href="poems.html#topic+population_simulator">poems::population_simulator</a></code>).</p>
</dd>
<dt><code>abundance_threshold</code></dt><dd><p>Abundance threshold (that needs to be
exceeded) for each population to persist.</p>
</dd>
<dt><code>seasons</code></dt><dd><p>Number of seasons in a year (default 1.) The first one is
always treated as the breeding season.</p>
</dd>
<dt><code>simulation_order</code></dt><dd><p>A vector of simulation process names in
configured order of execution.</p>
</dd>
<dt><code>results_selection</code></dt><dd><p>List of attributes to be included in the
returned results of each simulation run, selected from: &quot;abundance&quot;,
&quot;ema&quot;, &quot;extirpation&quot;, &quot;extinction_location&quot;, &quot;harvested&quot;, &quot;occupancy&quot;;
&quot;summarize&quot; or &quot;replicate&quot;.</p>
</dd>
<dt><code>attribute_aliases</code></dt><dd><p>A list of alternative alias names for model
attributes (form: <code>alias = "attribute"</code>) to be used with the set
and get attributes methods.</p>
</dd>
<dt><code>template_model</code></dt><dd><p>Nested template model for fixed (non-sampled)
attributes for shallow cloning.</p>
</dd>
<dt><code>sample_attributes</code></dt><dd><p>Vector of sample attribute names (only).</p>
</dd>
<dt><code>required_attributes</code></dt><dd><p>Vector of required attribute names (only),
i.e. those needed to run a simulation.</p>
</dd>
<dt><code>error_messages</code></dt><dd><p>A vector of error messages encountered when setting
model attributes.</p>
</dd>
<dt><code>warning_messages</code></dt><dd><p>A vector of warning messages encountered when
setting model attributes.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-DiseaseModel-new"><code>DiseaseModel$new()</code></a>
</p>
</li>
<li> <p><a href="#method-DiseaseModel-set_sample_attributes"><code>DiseaseModel$set_sample_attributes()</code></a>
</p>
</li>
<li> <p><a href="#method-DiseaseModel-list_consistency"><code>DiseaseModel$list_consistency()</code></a>
</p>
</li>
<li> <p><a href="#method-DiseaseModel-clone"><code>DiseaseModel$clone()</code></a>
</p>
</li></ul>



<details><summary>Inherited methods</summary>
<ul>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericModel" data-id="get_attribute"><a href='../../poems/html/GenericModel.html#method-GenericModel-get_attribute'><code>poems::GenericModel$get_attribute()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericModel" data-id="get_attribute_aliases"><a href='../../poems/html/GenericModel.html#method-GenericModel-get_attribute_aliases'><code>poems::GenericModel$get_attribute_aliases()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="get_attribute_names"><a href='../../poems/html/SimulationModel.html#method-SimulationModel-get_attribute_names'><code>poems::SimulationModel$get_attribute_names()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="get_attributes"><a href='../../poems/html/SimulationModel.html#method-SimulationModel-get_attributes'><code>poems::SimulationModel$get_attributes()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="incomplete_attributes"><a href='../../poems/html/SimulationModel.html#method-SimulationModel-incomplete_attributes'><code>poems::SimulationModel$incomplete_attributes()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="inconsistent_attributes"><a href='../../poems/html/SimulationModel.html#method-SimulationModel-inconsistent_attributes'><code>poems::SimulationModel$inconsistent_attributes()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="is_complete"><a href='../../poems/html/SimulationModel.html#method-SimulationModel-is_complete'><code>poems::SimulationModel$is_complete()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="is_consistent"><a href='../../poems/html/SimulationModel.html#method-SimulationModel-is_consistent'><code>poems::SimulationModel$is_consistent()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="list_completeness"><a href='../../poems/html/SimulationModel.html#method-SimulationModel-list_completeness'><code>poems::SimulationModel$list_completeness()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="new_clone"><a href='../../poems/html/SimulationModel.html#method-SimulationModel-new_clone'><code>poems::SimulationModel$new_clone()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="set_attributes"><a href='../../poems/html/SimulationModel.html#method-SimulationModel-set_attributes'><code>poems::SimulationModel$set_attributes()</code></a></span></li>
</ul>
</details>

<hr>
<a id="method-DiseaseModel-new"></a>



<h4>Method <code>new()</code></h4>

<p>Initialization method sets default aliases and given attributes
individually and/or from a list.
</p>


<h5>Usage</h5>

<div class="r"><pre>DiseaseModel$new(attribute_aliases = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>attribute_aliases</code></dt><dd><p>A list of alternative alias names for model
attributes (form: <code>alias = "attribute"</code>) to be used with the set and
get attributes methods.</p>
</dd>
<dt><code>...</code></dt><dd><p>Parameters passed via a <em>params</em> list or individually.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-DiseaseModel-set_sample_attributes"></a>



<h4>Method <code>set_sample_attributes()</code></h4>

<p>Sets the names (only - when <em>params</em> is a vector) and values (when
<em>params</em> is a list and/or when name-value pairs are provided) of the
sample attributes for the model.
</p>


<h5>Usage</h5>

<div class="r"><pre>DiseaseModel$set_sample_attributes(params = list(), ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt><dd><p>List of parameters/attributes (names and values) or array
of names only.</p>
</dd>
<dt><code>...</code></dt><dd><p>Parameters/attributes passed individually.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-DiseaseModel-list_consistency"></a>



<h4>Method <code>list_consistency()</code></h4>

<p>Returns a boolean to indicate if (optionally selected or all) model
attributes (such as dimensions) are consistent.
</p>


<h5>Usage</h5>

<div class="r"><pre>DiseaseModel$list_consistency(params = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt><dd><p>Optional array of parameter/attribute names.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>List of booleans (or NAs) to indicate consistency of selected/all
attributes.
</p>


<hr>
<a id="method-DiseaseModel-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>DiseaseModel$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>



<hr>
<h2 id='finch_region'>Study region for house finch conjunctivitis simulations</h2><span id='topic+finch_region'></span>

<h3>Description</h3>

<p>This is a raster that defines the spatial extent and resolution of the house
finch conjunctivitis example in the vignette. It encompasses terrestrial
North America from southern Mexico to southern Canada. It has a resolution of
46.375 by 46.375 kilometers, adding up to 6,355 possible populations of
house finches. The projected coordinate system for the study region is
Albers equal-area conic, with a reference longitude of 94.5 W and standard
parallels at 21.5 N and 47.5 N.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>finch_region
</code></pre>


<h3>Format</h3>

<p>A raster object with 1 layer and 17066 cells defining the spatial
scope of a simulation.
</p>

<hr>
<h2 id='habitat_suitability'>House finch habitat suitability</h2><span id='topic+habitat_suitability'></span>

<h3>Description</h3>

<p>This is a RasterStack containing data on habitat suitability for
the house finch in North America from 1994 to 2016. This habitat suitability
stack was generated using a species distribution model. The predictors for
the SDM were the 12 bioclimatic variables, plus an urbanization index
(proportion of each grid cell with urban land use.) The occurrences for the
SDM came from quality-checked GBIF records.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>habitat_suitability
</code></pre>


<h3>Format</h3>

<p>A RasterStack with 17066 cells and 23 layers.
</p>


<h3>Details</h3>

<p>The raster has the same resolution and projection as the <a href="#topic+finch_region">finch_region</a>.
Habitat suitability ranges from 0 to 1, with 1 being the most suitable.
</p>

<hr>
<h2 id='initial_abundance'>Initial house finch abundance</h2><span id='topic+initial_abundance'></span>

<h3>Description</h3>

<p>This numeric matrix contains initial abundances of house finches in 1994 for
the house finch conjunctivitis vignette. These abundances were themselves
simulated using <code>epizootic</code> and do not represent empirical estimates of house
finch abundance in 1994. The matrix has 6,355 columns, one for each
population in the <a href="#topic+finch_region">finch_region</a>, and 8 rows, one for each combination of
life cycle stage and disease compartment (row 1: susceptible juveniles, row
2: susceptible adults, row 3: juveniles infected for the first time, row 4:
adults infected for the first time, row 5: recovered juveniles, row 6:
recovered adults, row 7: re-infected juveniles, row 8: re-infected adults.)
This initial abundance matrix has only zeroes in rows 3-8 because the disease
has not yet broken out at the start of the simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initial_abundance
</code></pre>


<h3>Format</h3>

<p>A numeric matrix with 8 rows and 6355 columns.
</p>

<hr>
<h2 id='SimulationHandler'>R6 class representing a simulation handler.</h2><span id='topic+SimulationHandler'></span>

<h3>Description</h3>

<p><code><a href="R6.html#topic+R6Class">R6::R6Class</a></code> class to represent a handler for running multiple model
simulations and saving results. This simulation manager bears some
resemblance to the <code><a href="poems.html#topic+SimulationManager">poems::SimulationManager</a></code> in <code>poems</code>, but differs
in that it can handle multiple dispersal generators, uses a different engine
for parallelization, handles errors differently, and has a different default
data format (<code>.qs</code>).
</p>


<h3>Super classes</h3>

<p><code><a href="poems.html#topic+GenericClass">poems::GenericClass</a></code> -&gt; <code><a href="poems.html#topic+GenericManager">poems::GenericManager</a></code> -&gt; <code>SimulationHandler</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>attached</code></dt><dd><p>A list of dynamically attached attributes (name-value
pairs).</p>
</dd>
</dl>

</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>sample_data</code></dt><dd><p>A data frame of sampled parameters for each simulation/result.</p>
</dd>
<dt><code>model_template</code></dt><dd><p>A <code><a href="poems.html#topic+SimulationModel">poems::SimulationModel</a></code> (or inherited class)
object with parameters common to all simulations.</p>
</dd>
<dt><code>nested_model</code></dt><dd><p>A <code><a href="poems.html#topic+SimulationModel">poems::SimulationModel</a></code> (or inherited class)
object with empty sample parameters and a nested model template common to
all simulations.</p>
</dd>
<dt><code>generators</code></dt><dd><p>A list of generators (<code><a href="poems.html#topic+Generator">poems::Generator</a></code> or inherited
class) objects for generating simulation model values.</p>
</dd>
<dt><code>model_simulator</code></dt><dd><p>A <code><a href="poems.html#topic+ModelSimulator">poems::ModelSimulator</a></code> (or inherited class)
object for running the simulations.</p>
</dd>
<dt><code>parallel_cores</code></dt><dd><p>Number of cores for running the simulations in
parallel.</p>
</dd>
<dt><code>results_dir</code></dt><dd><p>Results directory path.</p>
</dd>
<dt><code>results_ext</code></dt><dd><p>Result file extension (default is .RData).</p>
</dd>
<dt><code>results_filename_attributes</code></dt><dd><p>A vector of: prefix (optional);
attribute names (from the sample data frame); postfix (optional);
utilized to construct results filenames.</p>
</dd>
<dt><code>error_messages</code></dt><dd><p>A vector of error messages encountered when setting
model attributes.</p>
</dd>
<dt><code>warning_messages</code></dt><dd><p>A vector of warning messages encountered when
setting model attributes.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-SimulationHandler-new"><code>SimulationHandler$new()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationHandler-log_simulation"><code>SimulationHandler$log_simulation()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationHandler-set_model_sample"><code>SimulationHandler$set_model_sample()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationHandler-run"><code>SimulationHandler$run()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationHandler-clone"><code>SimulationHandler$clone()</code></a>
</p>
</li></ul>



<details open><summary>Inherited methods</summary>
<ul>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericClass" data-id="new_clone"><a href='../../poems/html/GenericClass.html#method-GenericClass-new_clone'><code>poems::GenericClass$new_clone()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericManager" data-id="get_attribute"><a href='../../poems/html/GenericManager.html#method-GenericManager-get_attribute'><code>poems::GenericManager$get_attribute()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericManager" data-id="get_message_sample"><a href='../../poems/html/GenericManager.html#method-GenericManager-get_message_sample'><code>poems::GenericManager$get_message_sample()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericManager" data-id="get_results_filename"><a href='../../poems/html/GenericManager.html#method-GenericManager-get_results_filename'><code>poems::GenericManager$get_results_filename()</code></a></span></li>
</ul>
</details>

<hr>
<a id="method-SimulationHandler-new"></a>



<h4>Method <code>new()</code></h4>

<p>Initialization method sets any included attributes (<em>sample_data</em>,
<em>model_template</em>, <em>generators</em>, <em>model_simulator</em>,
<em>parallel_cores</em>, <em>results_dir</em>,
<em>results_filename_attributes</em>) and attaches other attributes
individually listed.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationHandler$new(model_template = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>model_template</code></dt><dd><p>A SimulationModel (or inherited class) object with
parameters common to all simulations.</p>
</dd>
<dt><code>...</code></dt><dd><p>Parameters listed individually.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-SimulationHandler-log_simulation"></a>



<h4>Method <code>log_simulation()</code></h4>

<p>Summarizes the simulation log and writes it to a text file.
</p>
<p>This method takes a nested list of simulation log entries generated by
the <code>run</code> method and summarizes the log. It determines which simulations
were successful, collects any warnings, and writes the summary to a text
file in the results directory.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationHandler$log_simulation(simulation_log)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>simulation_log</code></dt><dd><p>A nested list of simulation log entries.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A list containing the summary, indices of failed simulations,
indices of simulations with warnings, and the full log.
</p>


<hr>
<a id="method-SimulationHandler-set_model_sample"></a>



<h4>Method <code>set_model_sample()</code></h4>

<p>Sets the model sample attributes via the sample data frame and the
generators.
</p>
<p>This method sets the sample attributes of a SimulationModel object based
on the specified sample index. It uses the sample data frame and the
generators to determine the attribute values.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationHandler$set_model_sample(model, sample_index)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>model</code></dt><dd><p><code><a href="poems.html#topic+SimulationModel">poems::SimulationModel</a></code> (or inherited class) object
(clone) to receive sample attributes.</p>
</dd>
<dt><code>sample_index</code></dt><dd><p>Index of sample from data frame.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-SimulationHandler-run"></a>



<h4>Method <code>run()</code></h4>

<p>Runs the multiple population simulations, stores the
results, and creates a simulation log.
</p>
<p>This method runs multiple population simulations using the specified
model template and sample data. It stores the simulation results in the
specified results directory and creates a simulation log. The simulation
log contains information about the success or failure of each simulation
run.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationHandler$run(results_dir = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>results_dir</code></dt><dd><p>Results directory path where the simulation results
will be stored. If not provided, the results directory must be set
within the manager class object.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A list representing the simulation log. Each element of the list
corresponds to a simulation run and contains information about the
success or failure of the run, any error messages, and the path to the
saved results file (if applicable).
</p>


<hr>
<a id="method-SimulationHandler-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationHandler$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>



<hr>
<h2 id='siri_model_summer'>Simulate a <em>Mycoplasma gallisepticum</em> Outbreak in the Breeding Season</h2><span id='topic+siri_model_summer'></span>

<h3>Description</h3>

<p>Simulate a <em>Mycoplasma gallisepticum</em> outbreak during the breeding season
day-by-day in a population of house finches (<em>Haemorhous mexicanus</em>). Uses a
SIRI model (Susceptible-Infected 1- Recovered-Infected 2+) and includes
demographic stochasticity in fecundity, mortality, and infection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>siri_model_summer(inputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="siri_model_summer_+3A_inputs">inputs</code></td>
<td>
<p>A nested list with named elements:
</p>

<dl>
<dt><code>replicates</code></dt><dd><p>Number of replicate simulation runs.</p>
</dd>
<dt><code>time_steps</code></dt><dd><p>Number of simulation time steps.</p>
</dd>
<dt><code>populations</code></dt><dd><p>Number of populations.</p>
</dd>
<dt><code>stages</code></dt><dd><p>Number of life cycle stages.</p>
</dd>
<dt><code>compartments</code></dt><dd><p>Number of disease compartments (e.g., 3 for a
SIR model).</p>
</dd>
<dt><code>abundance_threshold</code></dt><dd><p>A quasi-extinction threshold at
which a population becomes extinct.</p>
</dd>
<dt><code>mortality</code></dt><dd><p>A vector of mortality rates, one for each
combination of stages and compartments.</p>
</dd>
<dt><code>mortality_unit</code></dt><dd><p>A vector indicating whether mortality rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>fecundity</code></dt><dd><p>A vector of fecundity rates, one for each
combination of stages and compartments for which fecundity applies.</p>
</dd>
<dt><code>fecundity_unit</code></dt><dd><p>A vector indicating whether fecundity rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>fecundity_mask</code></dt><dd><p>A vector indicating which stages and
compartments reproduce.</p>
</dd>
<dt><code>transmission</code></dt><dd><p>A vector of transmission rates, one for each
combination of stages and compartment for which transmission applies (see
<code>transmission_mask</code> below.</p>
</dd>
<dt><code>transmission_unit</code></dt><dd><p>A vector indicating whether mortality
rates are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>transmission_mask</code></dt><dd><p>A vector indicating which stages and
compartments are subject to transmission (i.e., classes susceptible to
infection.)</p>
</dd>
<dt><code>recovery</code></dt><dd><p>A vector of recovery rates, one for each
combination of stages and compartment for which recovery applies (see
<code>recovery_mask</code> below.)</p>
</dd>
<dt><code>recovery_unit</code></dt><dd><p>A vector indicating whether mortality rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>recovery_mask</code></dt><dd><p>A vector indicating which compartments are
subject to recovery (i.e., infected classes that can recover.)</p>
</dd>
<dt><code>r</code></dt><dd><p>Simulation replicate.</p>
</dd>
<dt><code>tm</code></dt><dd><p>Simulation time step.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array of carrying capacity values for
each population at time step.</p>
</dd>
<dt><code>breeding_season_length</code></dt><dd><p>Array of breeding season lengths in
days for each population at time step.</p>
</dd>
<dt><code>segment_abundance</code></dt><dd><p>Matrix of (current) abundance for each
stage-compartment combo (rows) and population (columns) at time step.</p>
</dd>
<dt><code>occupied_indices</code></dt><dd><p>Array of indices for populations occupied
at (current) time step.</p>
</dd>
<dt><code>simulator</code></dt><dd><p><code><a href="poems.html#topic+SimulatorReference">poems::SimulatorReference</a></code> object with
dynamically accessible <em>attached</em> and <em>results</em> lists.</p>
</dd>
<dt><code>additional attributes</code></dt><dd><p>Additional attributes when the
transformation is optionally nested in a list.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can also handle the case in which there are no infected
individuals. The principal difference between this function and the one for
simulating an outbreak in the non-breeding season is that this one includes
fecundity.
</p>


<h3>Value</h3>

<p>An abundance matrix with <code>populations</code> columns and
<code>stages*compartments</code> rows, updated from the <code>segment_abundance</code> input in
<code>inputs</code> according to demography and disease dynamics.
</p>

<hr>
<h2 id='siri_model_winter'>Simulate a <em>Mycoplasma gallisepticum</em> Outbreak in the Non-Breeding Season</h2><span id='topic+siri_model_winter'></span>

<h3>Description</h3>

<p>Simulate a <em>Mycoplasma gallisepticum</em> outbreak during the non-breeding season day-by-day in a
population of house finches (<em>Haemorhous mexicanus</em>). Uses a SIRI model (Susceptible-Infected 1-
Recovered-Infected 2+) and includes demographic stochasticity in fecundity, mortality, and
infection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>siri_model_winter(inputs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="siri_model_winter_+3A_inputs">inputs</code></td>
<td>
<p>A nested list with named elements:
</p>

<dl>
<dt><code>replicates</code></dt><dd><p>Number of replicate simulation runs.</p>
</dd>
<dt><code>time_steps</code></dt><dd><p>Number of simulation time steps.</p>
</dd>
<dt><code>populations</code></dt><dd><p>Number of populations.</p>
</dd>
<dt><code>stages</code></dt><dd><p>Number of life cycle stages.</p>
</dd>
<dt><code>compartments</code></dt><dd><p>Number of disease compartments (e.g., 3 for a
SIR model).</p>
</dd>
<dt><code>abundance_threshold</code></dt><dd><p>A quasi-extinction threshold below
which a population becomes extinct.</p>
</dd>
<dt><code>mortality</code></dt><dd><p>A vector of mortality rates, one for each
combination of stages and compartments.</p>
</dd>
<dt><code>mortality_unit</code></dt><dd><p>A vector indicating whether mortality rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>fecundity</code></dt><dd><p>A vector of fecundity rates, one for each
combination of stages and compartments for which fecundity applies.</p>
</dd>
<dt><code>fecundity_unit</code></dt><dd><p>A vector indicating whether fecundity rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>fecundity_mask</code></dt><dd><p>A vector indicating which stages and
compartments reproduce.</p>
</dd>
<dt><code>transmission</code></dt><dd><p>A vector of transmission rates, one for each
combination of stages and compartment for which transmission applies (see
<code>transmission_mask</code> below.</p>
</dd>
<dt><code>transmission_unit</code></dt><dd><p>A vector indicating whether mortality
rates are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>transmission_mask</code></dt><dd><p>A vector indicating which stages and
compartments are subject to transmission (i.e., classes susceptible to
infection.)</p>
</dd>
<dt><code>recovery</code></dt><dd><p>A vector of recovery rates, one for each
combination of stages and compartment for which recovery applies (see
<code>recovery_mask</code> below.)</p>
</dd>
<dt><code>recovery_unit</code></dt><dd><p>A vector indicating whether mortality rates
are daily or seasonal. 1 indicates seasonal, 0 indicates daily.</p>
</dd>
<dt><code>recovery_mask</code></dt><dd><p>A vector indicating which compartments are
subject to recovery (i.e., infected classes that can recover.)</p>
</dd>
<dt><code>r</code></dt><dd><p>Simulation replicate.</p>
</dd>
<dt><code>tm</code></dt><dd><p>Simulation time step.</p>
</dd>
<dt><code>carrying_capacity</code></dt><dd><p>Array of carrying capacity values for
each population at time step.</p>
</dd>
<dt><code>breeding_season_length</code></dt><dd><p>Array of breeding season lengths in
days for each population at time step.</p>
</dd>
<dt><code>segment_abundance</code></dt><dd><p>Matrix of (current) abundance for each
stage-compartment combo (rows) and population (columns) at time step.</p>
</dd>
<dt><code>occupied_indices</code></dt><dd><p>Array of indices for populations occupied
at (current) time step.</p>
</dd>
<dt><code>simulator</code></dt><dd><p><code><a href="poems.html#topic+SimulatorReference">poems::SimulatorReference</a></code> object with
dynamically accessible <em>attached</em> and <em>results</em> lists.</p>
</dd>
<dt><code>additional attributes</code></dt><dd><p>Additional attributes when the
transformation is optionally nested in a list.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can also handle the case in which there are no infected individuals. The principal
difference between this function and the one for simulating an outbreak in the breeding season
is that this one does not include fecundity.
</p>


<h3>Value</h3>

<p>An abundance matrix with <code>populations</code> columns and
<code>stages*compartments</code> rows, updated from the <code>segment_abundance</code> input in
<code>inputs</code> according to demography and disease dynamics.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
