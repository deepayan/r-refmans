<!DOCTYPE html><html><head><title>Help for package maxlike</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {maxlike}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#carw'>
<p>The Carolina Wren data used by Royle et al. (2012)</p></a></li>
<li><a href='#MaungaWhau'>
<p>Fake data for the Maunga Whau volcano</p></a></li>
<li><a href='#maxlike'>
<p>Model occurrence probability using presence-only data</p></a></li>
<li><a href='#maxlike-package'>
<p>Model species distributions by estimating the probability of occurrence</p>
using presence-only data.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Model Species Distributions by Estimating the Probability of
Occurrence Using Presence-Only Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-11</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-3-18</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0), raster</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dismo</td>
</tr>
<tr>
<td>Author:</td>
<td>Richard Chandler, Andy Royle and Roeland Kindt</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Roeland Kindt &lt;RoelandCEKindt@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a likelihood-based approach to modeling species distributions using presence-only data. In contrast to the popular software program MAXENT, this approach yields estimates of the probability of occurrence, which is a natural descriptor of a species' distribution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-18 14:49:43 UTC; RKINDT</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-19 08:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='carw'>
The Carolina Wren data used by Royle et al. (2012)
</h2><span id='topic+carw'></span><span id='topic+carw.data'></span>

<h3>Description</h3>

<p>These data come from the North American Breeding Bird Survey. They
include presence-only and presence-absence data for all 25
square-kilometer covering the contiguous United States. See
Royle et al. (2012) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(carw)</code></pre>


<h3>Format</h3>

<p>The format is:
List of 5
$ raster.data:'data.frame':	31980 obs. of  6 variables:
</p>
<p>$ pa.data    :'data.frame':	4615 obs. of  9 variables:
</p>
<p>$ xy1        :'data.frame':	12082 obs. of  2 variables:
</p>
<p>$ ext        : num [1:4] -3043880 3106120 114746 3364746
</p>
<p>$ dim        : num [1:2] 130 246
</p>


<h3>Details</h3>

<p>The component <code>raster.data</code> contains the spatially-referenced
covariate data that can be coverted to a <code><a href="raster.html#topic+raster">raster</a></code>
object. <code>pa.data</code> is a data.frame of presence-absence data.
<code>xy1</code> is a data.frame of coordinates of routes where Carolina
Wrens were detected. The other components are attibutes necessary for
formatting <code>raster.data</code> as a <code><a href="raster.html#topic+raster">raster</a></code> object.
</p>


<h3>Source</h3>

<p><a href="https://www.pwrc.usgs.gov/bbs/RawData/">https://www.pwrc.usgs.gov/bbs/RawData/</a>
</p>


<h3>References</h3>

<p>Royle, J.A., R.B. Chandler, C. Yackulic and J.
D. Nichols. 2012. Likelihood analysis of species occurrence probability
from presence-only data for modelling species distributions. Methods
in Ecology and Evolution. doi: 10.1111/j.2041-210X.2011.00182.x
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(carw)

# Convert data frame to a list of rasters
rl &lt;- lapply(carw.data$raster.data, function(x) {
   m &lt;- matrix(x, nrow=carw.data$dim[1], ncol=carw.data$dim[2],
               byrow=TRUE)
   r &lt;- raster(m)
   extent(r) &lt;- carw.data$ext
   r
})

# Stack and name them
rs &lt;- stack(rl[[1]], rl[[2]], rl[[3]], rl[[4]], rl[[5]], rl[[6]])
names(rs) &lt;- names(carw.data$raster.data)

plot(rs)

</code></pre>

<hr>
<h2 id='MaungaWhau'>
Fake data for the Maunga Whau volcano
</h2><span id='topic+MaungaWhau'></span>

<h3>Description</h3>

<p>Based upon <a href="datasets.html#topic+volcano">volcano</a> in the datasets package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MaungaWhau)</code></pre>


<h3>Format</h3>

<p>The format is:
List of 3
$ elev  : num [1:87, 1:61] -1.17 -1.13 -1.09 -1.05 -1.01 ...
</p>
<p>$ precip: num [1:87, 1:61] -2.27 -2.25 -2.24 -2.22 -2.2 ...
</p>
<p>$ xy    : num [1:1000, 1:2] 38.5 42.5 30.5 25.5 16.5 36.5 22.5 56.5
49.5 18.5 ...
</p>


<h3>Details</h3>

<p>No coordinate system attributes are included
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MaungaWhau)
elev &lt;- raster(MaungaWhau$elev, xmn=0, xmx=61, ymn=0, ymx=87)
precip &lt;- raster(MaungaWhau$precip, xmn=0, xmx=61, ymn=0, ymx=87)
</code></pre>

<hr>
<h2 id='maxlike'>
Model occurrence probability using presence-only data
</h2><span id='topic+maxlike'></span>

<h3>Description</h3>

<p>This function estimates the probability of occurrence using
presence-only data and spatially-referenced covariates. Species
distribution maps can be created by plotting the
expected values of occurrence probability.  The model is described by
Royle et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  maxlike(formula, rasters, points, x=NULL, z=NULL,
          link=c("logit", "cloglog"),
          starts, hessian = TRUE, fixed, removeDuplicates=FALSE,
          savedata=FALSE, na.action = "na.omit", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxlike_+3A_formula">formula</code></td>
<td>

<p>A right-hand side <code><a href="stats.html#topic+formula">formula</a></code> describing the model.
At least 1 continuous covariate must be present in the formula.
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_rasters">rasters</code></td>
<td>

<p>The spatially-referenced covariate data formatted as a 'raster
stack' created by the <code><a href="utils.html#topic+stack">stack</a></code> function
in the <code><a href="raster.html#topic+raster-package">raster-package</a></code>. It's a good idea to standardize
these by subtracting the mean and dividing by the standard
deviation. This will make it easier for <code><a href="stats.html#topic+optim">optim</a></code> to find
the maximum-likelihood estimates.
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_points">points</code></td>
<td>

<p>A <code><a href="base.html#topic+matrix">matrix</a></code> or <code><a href="base.html#topic+data.frame">data.frame</a></code> with the X and Y
coordinates of the presence locations.
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_x">x</code></td>
<td>

<p>A <code><a href="base.html#topic+matrix">matrix</a></code> or <code><a href="base.html#topic+data.frame">data.frame</a></code> with the explanatory
data for presence locations. In case data is provided for <code>x</code>
and <code>z</code>, arguments <code>rasters</code> and <code>points</code> will be ignored
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_z">z</code></td>
<td>

<p>A <code><a href="base.html#topic+matrix">matrix</a></code> or <code><a href="base.html#topic+data.frame">data.frame</a></code> with the explanatory
data for background locations. In case data is provided for <code>x</code>
and <code>z</code>, arguments <code>rasters</code> and <code>points</code> will be ignored
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_link">link</code></td>
<td>

<p>The link function. Either &quot;logit&quot; (the default) or &quot;cloglog&quot;.
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_starts">starts</code></td>
<td>

<p>Starting values for the parameters. This should be a vector with as
many elements as there are parameters. By default, all starting
values are 0, which should be adequate if covariates are standardized.
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_hessian">hessian</code></td>
<td>

<p>Logical. Should the hessian be computed and the variance-covariance
matrix returned?
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_fixed">fixed</code></td>
<td>

<p>Optional vector for fixing parameters. It must be
of length equal to the number of parameters in the
model. If an element of <code>fixed</code> is NA, then the parameter is
estimated, otherwise if it is a real number, the parameter is fixed
at this value.
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_removeduplicates">removeDuplicates</code></td>
<td>

<p>Logical. Should duplicate points be removed? Defaults to FALSE, but
note that the MAXENT default is TRUE.
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_savedata">savedata</code></td>
<td>

<p>Should the raster data be saved with the fitted model? Defaults to
FALSE in order to reduce the size of the returned object. If you
wish to make predictions, it is safer to set this to TRUE, otherwise
the raster data are searched for in the working directory, and thus
may not be the data used to fit the model.
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_na.action">na.action</code></td>
<td>

<p>See <code><a href="base.html#topic+options">options</a></code> for choices
</p>
</td></tr>
<tr><td><code id="maxlike_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to <code><a href="stats.html#topic+optim">optim</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>points</code> and <code>rasters</code>
should the same coordinate system. The program does not check
this so it is up to the user.
</p>


<h3>Value</h3>

<p>A list with 8 components
</p>
<table>
<tr><td><code>Est</code></td>
<td>
<p>data.frame containing the parameter estimates (Ests) and
standard errors (SE).</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>variance-covariance matrix</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>AIC</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the original call</p>
</td></tr>
<tr><td><code>pts.removed</code></td>
<td>
<p>The points removed due to missing values</p>
</td></tr>
<tr><td><code>pix.removed</code></td>
<td>
<p>The pixels removed due to missing values</p>
</td></tr>
<tr><td><code>optim</code></td>
<td>
<p>The object returned by <code><a href="stats.html#topic+optim">optim</a></code></p>
</td></tr>
<tr><td><code>not.fixed</code></td>
<td>
<p>A logical vector indicating if a parameter was
estimated or fixed.</p>
</td></tr>
<tr><td><code>link</code></td>
<td>
<p>The link function</p>
</td></tr>
</table>


<h3>Warnings</h3>

<p>Maximizing the log-likelihood function is achieved using the
<code><a href="stats.html#topic+optim">optim</a></code> function, which can fail to find the global optima
if sensible starting values are not
supplied. The default starting values are <code>rep(0, npars)</code>, which
will often be adequate if the covariates have been
standardized. Standardizing covariates is thus recommended.
Even when covariates are standardized, it is always a good idea to try
various starting values to see if the
log-likelihood can be increased. When fitting models with many
parameters, good starting values can be found by fitting simpler
models first.
</p>


<h3>Note</h3>

<p>In general it is very hard to obtain a random sample of presence
points, which is a requirement of both the Royle et al. (2012)
method and of MAXENT. This is one of many reasons why presence-absence
data are preferable to presence-only data. When presence-absence data
are available, they can be modeled using functions such as
<code><a href="stats.html#topic+glm">glm</a></code>. Creating species distribution maps
from <code><a href="stats.html#topic+glm">glm</a></code> is easily accomplished using the
<code><a href="stats.html#topic+predict">predict</a></code> method.
</p>
<p>The MAXENT software assumes that species prevalence is known a
priori. If the user does not specify a value for prevalence,
prevalence is set to 0.5. MAXENT predictions of occurrence probability
are highly sensitive to this setting. In contrast, <code>maxlike</code>
directly estimates prevalence.
</p>
<p>Another weakness of models for presence-only data is that they do not
allow one to model detection probability, which is typically less than
one in field conditions. If detection probability is affected by the same
covariates that affect occurrence probability, then bias
is inevitable. The R package <span class="pkg">unmarked</span>
(Fiske and Chandler 2011) offers numerous
methods for jointly modeling both occurrence and detection probability
when detection/non-detection data are available.
</p>


<h3>References</h3>

<p>Royle, J.A., R.B. Chandler, C. Yackulic and J.
D. Nichols. 2012. Likelihood analysis of species occurrence probability
from presence-only data for modelling species distributions. Methods
in Ecology and Evolution. doi: 10.1111/j.2041-210X.2011.00182.x
</p>
<p>Fiske, I. and R.B. Chandler. 2011. unmarked: An R Package for Fitting
Hierarchical Models of Wildlife Occurrence and Abundance. Journal of
Statistical Software 43(10).
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+maxlike-package">maxlike-package</a></code>, <code><a href="raster.html#topic+raster">raster</a></code>,
<code><a href="#topic+carw">carw</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

# Carolina Wren data used in Royle et. al (2012)
data(carw)

# Covert data.frame to a list of rasters
rl &lt;- lapply(carw.data$raster.data, function(x) {
   m &lt;- matrix(x, nrow=carw.data$dim[1], ncol=carw.data$dim[2], byrow=TRUE)
   r &lt;- raster(m)
   extent(r) &lt;- carw.data$ext
   r
})

# Create a raster stack and add layer names
rs &lt;- stack(rl[[1]], rl[[2]], rl[[3]], rl[[4]], rl[[5]], rl[[6]])
names(rs) &lt;- names(carw.data$raster.data)

plot(rs)


# Fit a model
fm &lt;- maxlike(~pcMix + I(pcMix^2) + pcDec + I(pcDec^2)+ pcCon +
    I(pcCon^2) + pcGr + I(pcGr^2) +
    Lat + I(Lat^2) + Lon + I(Lon^2), rs, carw.data$xy1,
    method="BFGS", removeDuplicates=TRUE, savedata=TRUE)

summary(fm)
confint(fm)
AIC(fm)
logLik(fm)


# Produce species distribution map (ie, expected probability of occurrence)
psi.hat &lt;- predict(fm) # Will warn if savedata=FALSE
plot(psi.hat)
points(carw.data$xy1, pch=16, cex=0.1)



# MAXENT sets "default prevalence" to an arbitrary value, 0.5.
# We could do something similar by fixing the intercept at logit(0.5)=0.
# However, it seems more appropriate to estimate this parameter.

# fm.fix &lt;- update(fm, fixed=c(0, rep(NA,length(coef(fm))-1)))

# Predict data.frame
presenceData &lt;- as.data.frame(extract(rs, carw.data$xy1))
presenceData &lt;- presenceData[complete.cases(presenceData), ]
presence.predictions &lt;- predict(fm, newdata=presenceData)
summary(presence.predictions)

# Calibrate with data.frames
PresenceUniqueCells &lt;- unique(cellFromXY(rs, xy=carw.data$xy1))
PresenceUnique &lt;- xyFromCell(rs, PresenceUniqueCells)
presenceData &lt;- as.data.frame(extract(rs, PresenceUnique))
library(dismo)
background &lt;- randomPoints(rs, n=ncell(rs), extf=1.00)
backgroundData &lt;- as.data.frame(extract(rs, y=background))
backgroundData &lt;- backgroundData[complete.cases(backgroundData), ]
fm2 &lt;- maxlike(~pcMix + I(pcMix^2) + pcDec + I(pcDec^2)+ pcCon +
    I(pcCon^2) + pcGr + I(pcGr^2) +
    Lat + I(Lat^2) + Lon + I(Lon^2),
    rasters=NULL, points=NULL,
    x=presenceData, z=backgroundData,
    method="BFGS", removeDuplicates=TRUE, savedata=TRUE)

summary(fm2)

fm2$rasters &lt;- rs
psi.hat2 &lt;- predict(fm2)


# Simulation example

set.seed(131)
x1 &lt;- sort(rnorm(100))
x1 &lt;- raster(outer(x1, x1), xmn=0, xmx=100, ymn=0, ymx=100)

x2 &lt;- raster(matrix(runif(1e4), 100, 100), 0, 100, 0, 100)

# Code factors as dummy variables.
# Note, using asFactor(x3) will not help
x3 &lt;- raster(matrix(c(0,1), 100, 100), 0, 100, 0, 100)

logit.psi &lt;- -1 + 1*x1 + 0*x2
psi &lt;- exp(logit.psi)/(1+exp(logit.psi))
plot(psi)

r &lt;- stack(x1, x2, x3)
names(r) &lt;- c("x1", "x2", "x3")
plot(r)

pa &lt;- matrix(NA, 100, 100)
pa[] &lt;- rbinom(1e4, 1, as.matrix(psi))
str(pa)
table(pa)

pa &lt;- raster(pa, 0, 100, 0, 100)
plot(pa)

xy &lt;- xyFromCell(pa, sample(Which(pa==1, cells=TRUE), 1000))

plot(x1)
points(xy)

fm2 &lt;- maxlike(~x1 + x2 + x3, r, xy)

summary(fm2)
confint(fm2)
AIC(fm2)
logLik(fm2)


## End(Not run)

</code></pre>

<hr>
<h2 id='maxlike-package'>
Model species distributions by estimating the probability of occurrence
using presence-only data.
</h2><span id='topic+maxlike-package'></span>

<h3>Description</h3>

<p>A species' distribution can be characterized by the probability that it
occurs at some location in space. Estimating occurrence probability
can be easily accomplished
using presence-absence data, but often researchers only have presence
locations and environmental data for the study area. MAXENT is a
popular software program for modeling species distributions, but it does
not estimate the probability of occurrence. Rather, it returns various
indices that are not easy to interpret (see Royle et
al. 2012). Package &quot;maxlike&quot; provides a simple
likelihood-based alternative.
</p>


<h3>Note</h3>

<p>All presence-only models require a random sample of data from
locations where the species is present. Unfortunately, random sampling
is not a feature of most presence-only datasets, and bias in the
estimated probability surface should
be expected in such cases. This assumption can be greatly relaxed if
one has presence-absence data, which will always
contain more information about a species' distribution.
</p>


<h3>References</h3>

<p>J. A. Royle, R. B. Chandler, C. Yackulic and J.
D. Nichols. 2012. Likelihood analysis of species occurrence probability
from presence-only data for modelling species distributions. Methods
in Ecology and Evolution 3:545&ndash;554. doi: 10.1111/j.2041-210X.2011.00182.x.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+maxlike">maxlike</a></code>, <code><a href="raster.html#topic+raster">raster</a></code> </p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
