<!DOCTYPE html><html><head><title>Help for package skewlmm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {skewlmm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acfresid'><p>Autocorrelation function for smn.lmm or smsn.lmm residuals</p></a></li>
<li><a href='#boot_ci'><p>Extract confidence intervals from <code>lmmBoot</code> object</p></a></li>
<li><a href='#boot_par'><p>Parametric bootstrap for SMSN/SMN objects</p></a></li>
<li><a href='#criteria'><p>Extracts criteria for model comparison of SMSN/SMN/SMNclmm objects</p></a></li>
<li><a href='#errorVar'><p>Error scale matrix associated with <code>times</code></p></a></li>
<li><a href='#fitted.SMN'><p>Extract smn.lmm fitted values</p></a></li>
<li><a href='#fitted.SMNclmm'><p>Extract smn.clmm fitted values</p>
</a></li>
<li><a href='#fitted.SMSN'><p>Extract smsn.lmm fitted values</p></a></li>
<li><a href='#healy.plot'><p>Healy-type plot from a smn.lmm or smsn.lmm object</p></a></li>
<li><a href='#lmmControl'><p>Control options for <code>smsn.lmm()</code>, <code>smn.lmm()</code> and <code>smn.clmm()</code></p></a></li>
<li><a href='#lr.test'><p>Likelihood-ratio test for SMSN/SMN objects</p></a></li>
<li><a href='#mahalDist'><p>Mahalanobis distance from a smn.lmm or smsn.lmm object</p></a></li>
<li><a href='#mahalDistCens'><p>Mahalanobis distance from a smn.clmm object</p>
</a></li>
<li><a href='#plot'><p>Plot a smn.lmm or smsn.lmm object</p></a></li>
<li><a href='#plot.acfresid'><p>Plot ACF for smn.lmm or smsn.lmm residuals</p></a></li>
<li><a href='#plot.mahalDist'><p>Plot Mahalanobis distance for a fitted smn.lmm or smsn.lmm</p></a></li>
<li><a href='#plot.mahalDistCens'><p>Plot Mahalanobis distance for a fitted smn.clmm</p>
</a></li>
<li><a href='#plot.SMNclmm'><p>Plot a smn.clmm object</p>
</a></li>
<li><a href='#predict.SMN'><p>Prediction of future observations from an smn.lmm object</p></a></li>
<li><a href='#predict.SMNclmm'><p>Prediction of future observations from an smn.clmm object</p></a></li>
<li><a href='#predict.SMSN'><p>Prediction of future observations from an smsn.lmm object</p></a></li>
<li><a href='#print.SMN'><p>Print a smn.lmm object</p></a></li>
<li><a href='#print.SMNclmm'><p>Print a smn.clmm object</p>
</a></li>
<li><a href='#print.SMSN'><p>Print a smsn.lmm object</p></a></li>
<li><a href='#ranef'><p>Extract random effects from smsn.lmm, smn.lmm and smn.clmm objects</p></a></li>
<li><a href='#residuals'><p>Extract model residuals from smn.lmm and smsn.lmm objects</p></a></li>
<li><a href='#residuals.SMNclmm'><p>Extract model residuals from smn.clmm objects</p>
</a></li>
<li><a href='#rsmsn.clmm'><p>Generate data from SMSN-CLMM with censored responses</p>
</a></li>
<li><a href='#rsmsn.lmm'><p>Generate data from SMSN-LMM</p></a></li>
<li><a href='#smn.clmm'><p>ML estimation of scale mixture of normal linear mixed models with censored responses</p></a></li>
<li><a href='#smn.lmm'><p>ML estimation of scale mixture of normal linear mixed models</p></a></li>
<li><a href='#smsn.lmm'><p>ML estimation of scale mixture of skew-normal linear mixed models</p></a></li>
<li><a href='#summary.SMN'><p>Summary of a smn.lmm object</p></a></li>
<li><a href='#summary.SMNclmm'><p>Summary of a smn.clmm object</p>
</a></li>
<li><a href='#summary.SMSN'><p>Summary of a smsn.lmm object</p></a></li>
<li><a href='#update'><p>Update for SMSN/SMN/SMNclmm objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Scale Mixture of Skew-Normal Linear Mixed Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fernanda L. Schumacher &lt;fernandalschumacher@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>It fits scale mixture of skew-normal linear mixed models using an expectationâ€“maximization (EM) type algorithm, including some possibilities for modeling the within-subject dependence. Details can be found in Schumacher, Lachos and Matos (2021) &lt;<a href="https://doi.org/10.1002%2Fsim.8870">doi:10.1002/sim.8870</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2), optimParallel</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, furrr, future, ggplot2, ggrepel, haven, matrixcalc,
methods, moments, MomTrunc, mvtnorm, nlme, numDeriv, purrr,
relliptical, TruncatedNormal</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/fernandalschumacher/skewlmm">https://github.com/fernandalschumacher/skewlmm</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/fernandalschumacher/skewlmm/issues">https://github.com/fernandalschumacher/skewlmm/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-30 04:36:47 UTC; schumacher.313</td>
</tr>
<tr>
<td>Author:</td>
<td>Fernanda L. Schumacher
    <a href="https://orcid.org/0000-0002-5724-8918"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Larissa A. Matos <a href="https://orcid.org/0000-0002-2635-0901"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Victor H. Lachos <a href="https://orcid.org/0000-0002-7239-2459"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Katherine A. L. Valeriano
    <a href="https://orcid.org/0000-0001-6388-4753"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Nicholas Henderson [ctb],
  Ravi Varadhan [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-30 05:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='acfresid'>Autocorrelation function for smn.lmm or smsn.lmm residuals
</h2><span id='topic+acfresid'></span>

<h3>Description</h3>

<p>This function calculates the empirical autocorrelation function for the within-subject residuals from a smn.lmm or smsn.lmm fit. The autocorrelation values are calculated using pairs of residuals within-subjects. The autocorrelation function is useful for investigating serial correlation models for discrete-time data, preferably equally spaced.</p>


<h3>Usage</h3>

<pre><code class='language-R'>acfresid(object, maxLag, resLevel = "marginal", resType = "normalized",
    calcCI = FALSE, levelCI, MCiter, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acfresid_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMN</code> or <code>SMSN</code>, representing
a fitted scale mixture of (skew) normal linear mixed model.</p>
</td></tr>
<tr><td><code id="acfresid_+3A_maxlag">maxLag</code></td>
<td>
<p>An optional integer giving the maximum lag for which the autocorrelation should be calculated. Defaults to maximum lag in the within-subject residuals.</p>
</td></tr>
<tr><td><code id="acfresid_+3A_reslevel">resLevel</code></td>
<td>
<p><code>"marginal"</code> (default) or <code>"conditional"</code>. An optional character string specifying which residual should be used. For details see <code><a href="#topic+residuals.SMN">residuals.SMN</a></code>.</p>
</td></tr>
<tr><td><code id="acfresid_+3A_restype">resType</code></td>
<td>
<p><code>"response"</code>, <code>"normalized"</code> (default), or <code>"modified"</code>. An optional character string specifying which type of residual should be used. For details see <code><a href="#topic+residuals.SMN">residuals.SMN</a></code>.</p>
</td></tr>
<tr><td><code id="acfresid_+3A_calcci">calcCI</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> (default). A logical value indicating if Monte Carlo confidence intervals should be computed for the conditionally independent model, which can be used for testing if the autocorrelations are zero.</p>
</td></tr>
<tr><td><code id="acfresid_+3A_levelci">levelCI</code></td>
<td>
<p>An optional numeric value in <code class="reqn">(0,1)</code> indicating the confidence level that should be used in the Monte Carlo confidence intervals. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="acfresid_+3A_mciter">MCiter</code></td>
<td>
<p>An optional discrete value indicating the number of Monte Carlo samples that should be used to compute the confidence intervals. Default is <code>300</code>.</p>
</td></tr>
<tr><td><code id="acfresid_+3A_seed">seed</code></td>
<td>
<p>An optional value used to specify seeds inside the function. Default is to use a random seed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns lag, ACF, and n.used representing, respectively, the lag between residuals within a pair, the corresponding empirical autocorrelation, and the number of pairs used. If <code>calcCI=TRUE</code>, the data frame has two extra columns containing the confidence intervals for the conditionally independent model. The returned value inherits from class acfresid.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Pinheiro, J. C. &amp; Bates, D. M. (2000). Mixed-Effects Models in S and S-PLUS. Springer, New York, NY.
</p>
<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+plot.acfresid">plot.acfresid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
acf1 = acfresid(fm1)
acf1
plot(acf1)

## computing simulated bands
acfCI = acfresid(fm1, calcCI=TRUE)
plot(acfCI)
  
</code></pre>

<hr>
<h2 id='boot_ci'>Extract confidence intervals from <code>lmmBoot</code> object
</h2><span id='topic+boot_ci'></span>

<h3>Description</h3>

<p>It  extracts confidence intervals from parametric bootstrap results obtained using the <code>boot_par()</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot_ci(object, conf = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot_ci_+3A_object">object</code></td>
<td>
<p>An object containing the results of the <code>boot_par()</code> function.</p>
</td></tr>
<tr><td><code id="boot_ci_+3A_conf">conf</code></td>
<td>
<p>Confidence level to be considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the confidence intervals.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+boot_par">boot_par</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fm1 = smn.lmm(nlme::Orthodont, formFixed=distance ~ age+Sex, groupVar="Subject")
b1 = boot_par(fm1, B=100)
boot_ci(b1)

</code></pre>

<hr>
<h2 id='boot_par'>Parametric bootstrap for SMSN/SMN objects
</h2><span id='topic+boot_par'></span>

<h3>Description</h3>

<p>It generates and estimates <code>B</code> Monte Carlo samples identical to the fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot_par(object, B = 100, seed = 123)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot_par_+3A_object">object</code></td>
<td>
<p>A smsn.lmm or smn.lmm object containing the fitted model to be updated.</p>
</td></tr>
<tr><td><code id="boot_par_+3A_b">B</code></td>
<td>
<p>Number of samples to be used.</p>
</td></tr>
<tr><td><code id="boot_par_+3A_seed">seed</code></td>
<td>
<p>Seed to be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides an alternative for the asymptotic standard errors and confidence intervals given in <code>summary</code>, which may be helpful for small samples.
Nevertheless, the computational cost is higher and it may take several minutes to get the results.
</p>


<h3>Value</h3>

<p>A tibble of class <code>lmmBoot</code> with <code>B</code> lines, where each line contains the estimated parameters from a simulated sample.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+boot_ci">boot_ci</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fm1 = smn.lmm(nlme::Orthodont, formFixed=distance ~ age+Sex, groupVar="Subject")
b1 = boot_par(fm1, B=100)
boot_ci(b1)

</code></pre>

<hr>
<h2 id='criteria'>Extracts criteria for model comparison of SMSN/SMN/SMNclmm objects
</h2><span id='topic+criteria'></span>

<h3>Description</h3>

<p>It extracts criteria for model comparison of sereval SMSN-LMM, SMN-LMM and/or SMN-CLMM (for censored responses).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>criteria(lobjects)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="criteria_+3A_lobjects">lobjects</code></td>
<td>
<p>A list containg the smsn.lmm, smn.lmm or smn.clmm objects to be compared.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> containing for each model the maximum log-likelihood value, the number of parameters, the AIC, and the BIC.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smn.clmm">smn.clmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm_norm = smn.lmm(nlme::Orthodont, formFixed=distance~age+Sex, groupVar="Subject")
fm_t = update(fm_norm, distr="t")
fm_sn = smsn.lmm(nlme::Orthodont, formFixed=distance~age+Sex, groupVar="Subject")
fm_cens = smn.clmm(nlme::Orthodont, formFixed=distance~age+Sex, groupVar="Subject")
criteria(list(fm_norm=fm_norm, fm_t=fm_t, fm_sn=fm_sn, fm_cens=fm_cens))
</code></pre>

<hr>
<h2 id='errorVar'>Error scale matrix associated with <code>times</code>
</h2><span id='topic+errorVar'></span>

<h3>Description</h3>

<p>It returns a scale matrix associated with the error term at time <code>times</code>.
Can be applied to a smn.lmm or smsn.lmm object or to a specific dependence structure with chosen parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>errorVar(times, object = NULL, sigma2 = NULL, depStruct = NULL,
    phi = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="errorVar_+3A_times">times</code></td>
<td>
<p>A vector containing the times for which the matrix should be calculated.</p>
</td></tr>
<tr><td><code id="errorVar_+3A_object">object</code></td>
<td>
<p>A smn.lmm or smsn.lmm object for which the variance should be extracted.</p>
</td></tr>
<tr><td><code id="errorVar_+3A_sigma2">sigma2</code></td>
<td>
<p>Common variance parameter, such that <code class="reqn">\Sigma = sigma2*R</code>. Only evaluated if object <code>is.null(object)</code>.</p>
</td></tr>
<tr><td><code id="errorVar_+3A_depstruct">depStruct</code></td>
<td>
<p>Dependence structure. <code>"UNC"</code> for conditionally uncorrelated (<code>"CI"</code> is also accepted), <code>"ARp"</code> for AR(p) &ndash; p is <code>length(phi)</code>&ndash;, <code>"CS"</code> for compound symmetry, <code>"DEC"</code> for DEC, and <code>"CAR1"</code> for  continuous-time AR(1). Only evaluated if object <code>is.null(object)</code>.</p>
</td></tr>
<tr><td><code id="errorVar_+3A_phi">phi</code></td>
<td>
<p>Parameter vector indexing the dependence structure. Only evaluated if object <code>is.null(object)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of dimension <code>length(times)</code>.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fm1 = smsn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
errorVar(times=1:4,fm1)
#
errorVar(times=1:5, sigma2=1, depStruct="ARp", phi=.5)
errorVar(times=1:5, sigma2=1, depStruct="DEC", phi=c(.5,.8))
</code></pre>

<hr>
<h2 id='fitted.SMN'>Extract smn.lmm fitted values
</h2><span id='topic+fitted.SMN'></span>

<h3>Description</h3>

<p>The fitted values are obtained by adding together the
population fitted values (based only on the fixed effects estimates)
and the estimated contributions of the random effects to the fitted
values at grouping levels. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMN'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.SMN_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMN</code>, representing
a fitted scale mixture normal linear mixed model.</p>
</td></tr>
<tr><td><code id="fitted.SMN_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of fitted values with length equal to <code>nrow(data)</code>.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+predict.SMN">predict.SMN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
fitted(fm1)
</code></pre>

<hr>
<h2 id='fitted.SMNclmm'>Extract smn.clmm fitted values

</h2><span id='topic+fitted.SMNclmm'></span>

<h3>Description</h3>

<p>The fitted values are obtained by adding together the
population fitted values (based only on the fixed effects estimates)
and the estimated contributions of the random effects to the fitted
values at grouping levels. </p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'SMNclmm'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.SMNclmm_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMNclmm</code>, representing a fitted scale mixture normal linear mixed model with censored responses.</p>
</td></tr>
<tr><td><code id="fitted.SMNclmm_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of fitted values with length equal to <code>nrow(data)</code>.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.clmm">smn.clmm</a></code>, <code><a href="#topic+predict.SMNclmm">predict.SMNclmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nj1 = 5; m = 30
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))
dat1 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=0.7,
                  D=0.6*diag(1), beta=c(1,2), depStruct="UNC")

fm1 = smn.clmm(dat1, formFixed=y~x, groupVar="ind", depStruct="UNC",
               ci="ci", lcl="lcl", ucl="ucl", control=lmmControl(max.iter=30))
fitted(fm1)
</code></pre>

<hr>
<h2 id='fitted.SMSN'>Extract smsn.lmm fitted values
</h2><span id='topic+fitted.SMSN'></span>

<h3>Description</h3>

<p>The fitted values are obtained by adding together the
population fitted values (based only on the fixed effects estimates)
and the estimated contributions of the random effects to the fitted
values at grouping levels. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMSN'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.SMSN_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMSN</code>, representing
a fitted scale mixture skew-normal linear mixed model.</p>
</td></tr>
<tr><td><code id="fitted.SMSN_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of fitted values with length equal to <code>nrow(data)</code>.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+predict.SMSN">predict.SMSN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smsn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject",
               control=lmmControl(tol=.0001))
fitted(fm1)
</code></pre>

<hr>
<h2 id='healy.plot'>Healy-type plot from a smn.lmm or smsn.lmm object
</h2><span id='topic+healy.plot'></span>

<h3>Description</h3>

<p>It creates a Healy-type plot from a smn.lmm or smsn.lmm object, for goodness-of-fit assessment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>healy.plot(object, dataPlus = NULL, dotsize = 0.4, calcCI = FALSE,
           levelCI, MCiter, seed, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="healy.plot_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMN</code> or <code>SMSN</code>, representing
a fitted scale mixture of (skew) normal linear mixed model.</p>
</td></tr>
<tr><td><code id="healy.plot_+3A_dataplus">dataPlus</code></td>
<td>
<p>Optional. Expanded dataset that should be used instead the one used for fitting. This is necessary for unbalanced datasets, since Haley's plot requires all subject to have the same number of observations.</p>
</td></tr>
<tr><td><code id="healy.plot_+3A_dotsize">dotsize</code></td>
<td>
<p>Optional. Dotsize used in ggplot.</p>
</td></tr>
<tr><td><code id="healy.plot_+3A_calcci">calcCI</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> (default). A logical value indicating if Monte Carlo confidence intervals should be computed for the conditionally independent model, which can be used for testing if the autocorrelations are zero.</p>
</td></tr>
<tr><td><code id="healy.plot_+3A_levelci">levelCI</code></td>
<td>
<p>An optional numeric value in <code class="reqn">(0,1)</code> indicating the confidence level that should be used in the Monte Carlo confidence intervals. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="healy.plot_+3A_mciter">MCiter</code></td>
<td>
<p>An optional discrete value indicating the number of Monte Carlo samples that should be used to compute the confidence intervals. Default is <code>300</code>.</p>
</td></tr>
<tr><td><code id="healy.plot_+3A_seed">seed</code></td>
<td>
<p>An optional value used to specify seeds inside the function. Default is to use a random seed.</p>
</td></tr>
<tr><td><code id="healy.plot_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It constructs a Healy-type plot (Healy, 1968) by plotting the nominal probability values <code class="reqn">1/n,2/n,...,n/n</code> against the theoretical cumulative probabilities of the ordered observed Mahalanobis distances. If the fitted model is appropriate, the plot
should resemble a straight line through the origin with unit slope.
If <code>calcCI=TRUE</code>, the plot presents two dashed blue lines containing approximated confidence intervals by considering that the fitted model is correct.
</p>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Healy, M. J. R. (1968). Multivariate normal plotting. Journal of the Royal Statistical Society: Series C (Applied Statistics), 17(2), 157-161.
</p>
<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>,
<code><a href="#topic+mahalDist">mahalDist</a></code>, <code><a href="#topic+acfresid">acfresid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
healy.plot(fm1)

## computing simulated bands
healy.plot(fm1, calcCI=TRUE)

</code></pre>

<hr>
<h2 id='lmmControl'>Control options for <code>smsn.lmm()</code>, <code>smn.lmm()</code> and <code>smn.clmm()</code>
</h2><span id='topic+lmmControl'></span>

<h3>Description</h3>

<p>The values supplied in the function call replace the defaults and a list with all possible arguments is returned. The returned list has class <code>"lmmControl"</code> and is used as the control argument to the <code>smsn.lmm()</code>, <code>smn.lmm()</code> and <code>smn.clmm()</code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmmControl(tol = 1e-06, max.iter = 300, calc.se = TRUE, lb = NULL,
           lu = NULL, luDEC = 10,
           initialValues = list(beta = NULL, sigma2 = NULL, D = NULL,
                                lambda = NULL, phi = NULL, nu = NULL),
           quiet = FALSE, showCriterium = FALSE, algorithm = "DAAREM",
           parallelphi = NULL, parallelnu = NULL, ncores = NULL,
           control.daarem = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmmControl_+3A_tol">tol</code></td>
<td>
<p>Tolerance for the convergence criterion. Default = <code>1e-6</code>.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_max.iter">max.iter</code></td>
<td>
<p>Maximum number of iterations for the EM algorithm. Default = <code>200</code>.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_calc.se">calc.se</code></td>
<td>
<p>A logical value indicating if standard errors should be calculated.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_lb">lb</code></td>
<td>
<p>Optional. Bottom limit for estimating <code>nu</code>.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_lu">lu</code></td>
<td>
<p>Optional. Upper limit for estimating <code>nu</code>.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_ludec">luDEC</code></td>
<td>
<p>Optional. Upper limit for estimating the &quot;damping&quot; parameter for DEC covariance. If <code>luDEC&lt;=1</code>, only attenuation of the exponential decay can be obtained.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_initialvalues">initialValues</code></td>
<td>
<p>Optional. A named list containing initial parameter values, with at most the following elements: <code>beta</code>, <code>sigma2</code>, <code>D</code>, <code>lambda</code>, <code>phi</code>, <code>nu</code>.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_quiet">quiet</code></td>
<td>
<p>A logical value indicating if the iteration message should be suppressed. Useful when calling the function in R Markdown.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_showcriterium">showCriterium</code></td>
<td>
<p>A logical value indicating if the criterium should be shown at each iteration.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_algorithm">algorithm</code></td>
<td>
<p>Algorithm to be used for estimation, either <code>"DAAREM"</code> (default) or <code>"EM"</code>. DAAREM is an acceleration method and usually converges with fewer iterations, but it may result in numerical errors (in this case, please use the <code>"EM"</code> option).</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_parallelphi">parallelphi</code></td>
<td>
<p>A logical value indicating if parallel optimization should be used in the numerical update of the parameters related to the within-subject dependence structure. Default is <code>TRUE</code> if the data contains more than <code>30</code> subjects, and <code>FALSE</code> otherwise. Meaningless if <code>depStruct = "UNC"</code>.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_parallelnu">parallelnu</code></td>
<td>
<p>A logical value indicating if parallel optimization should be used in the numerical update of nu. Meaningless if <code>distr="norm"</code> or <code>distr="sn"</code>.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores to be used for the parallel optimization. Meaningless if <code>parallelphi = FALSE</code> and <code>parallelnu = FALSE</code>.</p>
</td></tr>
<tr><td><code id="lmmControl_+3A_control.daarem">control.daarem</code></td>
<td>
<p>List of control for the daarem algorithm. See <code>help(daarem, package = "daarem")</code> for details. Meaningless if <code>algorithm = "EM"</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Henderson, N.C. and Varadhan, R. (2019) Damped Anderson acceleration with restarts and monotonicity control for accelerating EM and EM-like algorithms, Journal of Computational and Graphical Statistics, Vol. 28(4), 834-846.
</p>
<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smn.clmm">smn.clmm</a></code>, <code><a href="stats.html#topic+update">update</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmmControl(algorithm = "EM")

fm1 = smn.lmm(nlme::Orthodont, formFixed=distance ~ age+Sex,
              groupVar="Subject", control=lmmControl(tol=1e-7))
</code></pre>

<hr>
<h2 id='lr.test'>Likelihood-ratio test for SMSN/SMN objects
</h2><span id='topic+lr.test'></span>

<h3>Description</h3>

<p>It performs a likelihood-ratio test for two nested SMSN-LMM or SMN-LMM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lr.test(obj1, obj2, level = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lr.test_+3A_obj1">obj1</code>, <code id="lr.test_+3A_obj2">obj2</code></td>
<td>
<p>smsn.lmm or smn.lmm objects containing the fitted models to be tested.</p>
</td></tr>
<tr><td><code id="lr.test_+3A_level">level</code></td>
<td>
<p>The significance level that should be used. If <code>quiet = TRUE</code>, this is ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>statistic</code></td>
<td>
<p>The test statistic value.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value from the test.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>The degrees of freedom used on the test.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(nlme::Orthodont, formFixed=distance ~ age+Sex, groupVar="Subject")
fm2 = smsn.lmm(nlme::Orthodont, formFixed=distance ~ age+Sex, groupVar="Subject",
               control=lmmControl(tol=.0001))
lr.test(fm1, fm2)
</code></pre>

<hr>
<h2 id='mahalDist'>Mahalanobis distance from a smn.lmm or smsn.lmm object
</h2><span id='topic+mahalDist'></span>

<h3>Description</h3>

<p>Returns the squared Mahalanobis distance from a fitted SMN-LMM or SMSN-LMM.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mahalDist(object, decomposed = FALSE, dataPlus = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mahalDist_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMN</code> or <code>SMSN</code>, representing
a fitted scale mixture of (skew) normal linear mixed model.</p>
</td></tr>
<tr><td><code id="mahalDist_+3A_decomposed">decomposed</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the Mahalanobis distance is decomposed in an error term and a random effect term. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mahalDist_+3A_dataplus">dataPlus</code></td>
<td>
<p>Optional. Expanded dataset that should be used instead the one used for fitting, useful for using Healy's plot with missing data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the Mahalanobis distance, if <code>decomposed = FALSE</code>, or a data frame containing the Mahalanobis distance and its decomposition in error term and random effect (b) term, if <code>decomposed = TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>
<p>Zeller, C. B., Labra, F. V., Lachos, V. H. &amp; Balakrishnan, N. (2010). Influence analyses of skew-normal/independent linear mixed models. Computational Statistics &amp; Data Analysis, 54(5).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+plot.mahalDist">plot.mahalDist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
mahalDist(fm1)
plot(mahalDist(fm1), nlabels=2)
</code></pre>

<hr>
<h2 id='mahalDistCens'>Mahalanobis distance from a smn.clmm object

</h2><span id='topic+mahalDistCens'></span>

<h3>Description</h3>

<p>Returns the squared Mahalanobis distance from a fitted SMN-CLMM. Censored values are imputed using their conditional expectation from the fitting algorithm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mahalDistCens(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mahalDistCens_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMNclmm</code>, representing
a fitted scale mixture of normal censored linear mixed model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mahalDistCens</code> containing the Mahalanobis distance.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>References</h3>

<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>
<p>Zeller, C. B., Labra, F. V., Lachos, V. H. &amp; Balakrishnan, N. (2010). Influence analyses of skew-normal/independent linear mixed models. Computational Statistics &amp; Data Analysis, 54(5).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.clmm">smn.clmm</a></code>, <code><a href="#topic+plot.mahalDistCens">plot.mahalDistCens</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nj1 = 5; m = 30
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))
dat1 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=0.7,
                  D=0.5*diag(1), beta=c(1,2), depStruct="CS", phi=0.4)
# Estimation
fm1 = smn.clmm(dat1, formFixed=y~x, groupVar="ind", depStruct="CS", ci="ci",
               lcl="lcl", ucl="ucl", control=lmmControl(max.iter=30))
distance = mahalDistCens(fm1)
plot(distance, level=0.95, nlabels=2)
</code></pre>

<hr>
<h2 id='plot'>Plot a smn.lmm or smsn.lmm object
</h2><span id='topic+plot.SMN'></span><span id='topic+plot.SMSN'></span>

<h3>Description</h3>

<p>Fitted values versus residuals plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMN'
plot(x, type = "response", level = "conditional",
     useweight = TRUE, alpha = 0.3, ...)

## S3 method for class 'SMSN'
plot(x, type = "response", level = "conditional",
     useweight = TRUE, alpha = 0.3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>SMN</code> or <code>SMSN</code>, representing
a fitted scale mixture of (skew) normal linear mixed model.</p>
</td></tr>
<tr><td><code id="plot_+3A_type">type</code></td>
<td>
<p>Type of residual that should be used. For details see <code><a href="#topic+residuals.SMN">residuals.SMN</a></code>. Default is &quot;response&quot;, indicating raw residuals.</p>
</td></tr>
<tr><td><code id="plot_+3A_level">level</code></td>
<td>
<p>Level of residual that should be used. For details see <code><a href="#topic+residuals.SMN">residuals.SMN</a></code>. Default is &quot;conditional&quot;.</p>
</td></tr>
<tr><td><code id="plot_+3A_useweight">useweight</code></td>
<td>
<p>A logical value indicating if the estimated weights should be used as color in the plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_alpha">alpha</code></td>
<td>
<p>Transparency parameter to be used (<code>0&lt;alpha&lt;1</code>). Meaningless if <code>useweight = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+fitted.SMN">fitted.SMN</a></code>, <code><a href="#topic+fitted.SMSN">fitted.SMSN</a></code>, <code><a href="#topic+residuals.SMN">residuals.SMN</a></code>, <code><a href="#topic+residuals.SMSN">residuals.SMSN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont,
              groupVar="Subject", distr="t")
plot(fm1)
plot(fm1, useweight=FALSE)

library(ggplot2)
plot(fm1) + ggtitle("t-LMM for orthodont data")
</code></pre>

<hr>
<h2 id='plot.acfresid'>Plot ACF for smn.lmm or smsn.lmm residuals
</h2><span id='topic+plot.acfresid'></span>

<h3>Description</h3>

<p>Plot method for objects of class &quot;acfresid&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'acfresid'
plot(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.acfresid_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>acfresid</code>, representing the empirical autocorrelation function from the residuals of a scale mixture of (skew) normal linear mixed model.</p>
</td></tr>
<tr><td><code id="plot.acfresid_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="#topic+acfresid">acfresid</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+residuals.SMN">residuals.SMN</a></code>, <code><a href="#topic+residuals.SMSN">residuals.SMSN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
plot(acfresid(fm1))

acfCI = acfresid(fm1, calcCI=TRUE)
plot(acfCI)
  
</code></pre>

<hr>
<h2 id='plot.mahalDist'>Plot Mahalanobis distance for a fitted smn.lmm or smsn.lmm
</h2><span id='topic+plot.mahalDist'></span>

<h3>Description</h3>

<p>Plot method for objects of class &quot;mahalDist&quot;. For the total Mahalanobis distance, it gives a quantile for outlier detection, based on the Mahalanobis distance theoretical distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mahalDist'
plot(x, fitobject, type, level = 0.99, nlabels = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mahalDist_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>mahalDist</code>, representing
the Mahalanobis distance from a fitted scale mixture of (skew) normal linear mixed model.</p>
</td></tr>
<tr><td><code id="plot.mahalDist_+3A_fitobject">fitobject</code></td>
<td>
<p>Optional. An object inheriting from class <code>SMN</code> or <code>SMSN</code>, representing
the fitted scale mixture of (skew) normal linear mixed model that was used for calculating the Mahalanobis distance.</p>
</td></tr>
<tr><td><code id="plot.mahalDist_+3A_type">type</code></td>
<td>
<p>Optional. Either <code>"total"</code> (default), for the standard Mahalanobis distance, <code>"error"</code>, for the error term of the decomposition, or <code>"b"</code> for the random effect term of the decomposition. For details see <code><a href="#topic+mahalDist">mahalDist</a></code>.</p>
</td></tr>
<tr><td><code id="plot.mahalDist_+3A_level">level</code></td>
<td>
<p>An optional numeric value in <code class="reqn">(0,1)</code> indicating the level of the quantile. It only has utility if <code>type="total"</code>. Default is <code>0.99</code>.</p>
</td></tr>
<tr><td><code id="plot.mahalDist_+3A_nlabels">nlabels</code></td>
<td>
<p>Number of observations that should be labeled. Default is 3.</p>
</td></tr>
<tr><td><code id="plot.mahalDist_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object, plotting the index versus the Mahalanobis distance, if all subject have the same number of observations; or plotting the number of observations per subject versus the Mahalanobis, otherwise.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="#topic+mahalDist">mahalDist</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
plot(mahalDist(fm1), nlabels=2)

#the estimated quantile is stored at the attribute "info" of the plot object
plotMD = plot(mahalDist(fm1))
attr(plotMD, "info")
</code></pre>

<hr>
<h2 id='plot.mahalDistCens'>Plot Mahalanobis distance for a fitted smn.clmm

</h2><span id='topic+plot.mahalDistCens'></span>

<h3>Description</h3>

<p>Plot method for objects of class &quot;mahalDistCens&quot;. It also gives a quantile for outlier detection, based on the Mahalanobis distance theoretical distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'mahalDistCens'
plot(x, fitobject, level = 0.99, nlabels = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mahalDistCens_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>mahalDistCens</code>, representing
the Mahalanobis distance from a fitted scale mixture of normal censored linear mixed model.</p>
</td></tr>
<tr><td><code id="plot.mahalDistCens_+3A_fitobject">fitobject</code></td>
<td>
<p>Optional. An object inheriting from class <code>SMNclmm</code>, representing
the fitted scale mixture of normal linear mixed model that was used for calculating the Mahalanobis distance.</p>
</td></tr>
<tr><td><code id="plot.mahalDistCens_+3A_level">level</code></td>
<td>
<p>An optional numeric value in <code class="reqn">(0,1)</code> indicating the level of the quantile. Default is <code>0.99</code>.</p>
</td></tr>
<tr><td><code id="plot.mahalDistCens_+3A_nlabels">nlabels</code></td>
<td>
<p>Number of observations that should be labeled. Default is 3.</p>
</td></tr>
<tr><td><code id="plot.mahalDistCens_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object, plotting the index versus the Mahalanobis distance, if all subject have the same number of observations; or plotting the number of observations per subject versus the Mahalanobis, otherwise.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="#topic+mahalDistCens">mahalDistCens</a></code>, <code><a href="#topic+smn.clmm">smn.clmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nj1 = 5; m = 30
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))
dat1 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=0.7,
                  D=0.5*diag(1), beta=c(1,2), depStruct="CS", phi=0.4)
# Estimation
fm1 = smn.clmm(dat1, formFixed=y~x, groupVar="ind", depStruct="CS", ci="ci",
               lcl="lcl", ucl="ucl", control=lmmControl(max.iter=30))
distance = mahalDistCens(fm1)
plot(distance, level=0.95, nlabels=2)
</code></pre>

<hr>
<h2 id='plot.SMNclmm'>Plot a smn.clmm object

</h2><span id='topic+plot.SMNclmm'></span>

<h3>Description</h3>

<p>Fitted values versus residuals plot. Censored values are imputed using their conditional expectation from the fitting algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'SMNclmm'
plot(x, level = "conditional", useweight = TRUE,
                         alpha = 0.3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SMNclmm_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>SMNclmm</code>, representing
a fitted scale mixture of normal censored linear mixed model.</p>
</td></tr>
<tr><td><code id="plot.SMNclmm_+3A_level">level</code></td>
<td>
<p>Level of residual that should be used. For details see <code><a href="#topic+residuals.SMNclmm">residuals.SMNclmm</a></code>. Default is &quot;conditional&quot;.</p>
</td></tr>
<tr><td><code id="plot.SMNclmm_+3A_useweight">useweight</code></td>
<td>
<p>A logical value indicating if the estimated weights should be used as color in the plot.</p>
</td></tr>
<tr><td><code id="plot.SMNclmm_+3A_alpha">alpha</code></td>
<td>
<p>Transparency parameter to be used (<code>0&lt;alpha&lt;1</code>). Meaningless if <code>useweight = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.SMNclmm_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="#topic+smn.clmm">smn.clmm</a></code>, <code><a href="#topic+fitted.SMNclmm">fitted.SMNclmm</a></code>, <code><a href="#topic+residuals.SMNclmm">residuals.SMNclmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nj1 = 5; m = 30
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))
dat1 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=0.7,
                  D=0.5*diag(1), beta=c(1,2), depStruct="UNC", distr="t", nu=4)
# Estimation
fm1 = smn.clmm(dat1, formFixed=y~x, groupVar="ind", depStruct="UNC", ci="ci",
               lcl="lcl", ucl="ucl", distr="t", control=lmmControl(max.iter=30))
plot(fm1)
</code></pre>

<hr>
<h2 id='predict.SMN'>Prediction of future observations from an smn.lmm object
</h2><span id='topic+predict.SMN'></span>

<h3>Description</h3>

<p>Predicted values are obtained through conditional expectation. For details, see Schumacher, Lachos, and Matos (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMN'
predict(object, newData, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.SMN_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMN</code>, representing
a fitted scale mixture normal linear mixed model.</p>
</td></tr>
<tr><td><code id="predict.SMN_+3A_newdata">newData</code></td>
<td>
<p>A data frame for which response variable should be predicted, including covariates, groupVar and possibly timeVar. If missing or <code>NULL</code>, fitted values are returned.</p>
</td></tr>
<tr><td><code id="predict.SMN_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with covariates, groupVar and ypred, where ypred contains the predicted values from the response variable.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+fitted.SMN">fitted.SMN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat1 = nlme::Orthodont
fm1 = smn.lmm(distance ~ age+Sex, data=subset(dat1, age&lt;14), groupVar="Subject")
predict(fm1, subset(dat1, age==14))
</code></pre>

<hr>
<h2 id='predict.SMNclmm'>Prediction of future observations from an smn.clmm object
</h2><span id='topic+predict.SMNclmm'></span>

<h3>Description</h3>

<p>Predicted values are obtained through conditional expectation. For details, see Schumacher, Lachos, and Matos (2021).

</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'SMNclmm'
predict(object, newData, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.SMNclmm_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMNclmm</code>, representing
a fitted scale mixture normal linear mixed model.</p>
</td></tr>
<tr><td><code id="predict.SMNclmm_+3A_newdata">newData</code></td>
<td>
<p>A data frame for which response variable should be predicted, including covariates, groupVar and possibly timeVar. If missing or <code>NULL</code>, fitted values are returned.</p>
</td></tr>
<tr><td><code id="predict.SMNclmm_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with covariates, groupVar and ypred, where ypred contains the predicted values from the response variable.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>References</h3>

<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.clmm">smn.clmm</a></code>, <code><a href="#topic+fitted.SMNclmm">fitted.SMNclmm</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulated example: 20 individuals with 5 times for estimation and
# 1 time for prediction
set.seed(963)
nj1 = 6; m = 20
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))
dat1 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=0.4,
                  D=0.6*diag(1), beta=c(1,2), depStruct="CS", phi=0.25)
# Estimation
fm1 = smn.clmm(subset(dat1,time&lt;6), formFixed=y~x, groupVar="ind",
               depStruct="CS", ci="ci", lcl="lcl", ucl="ucl",
               control=lmmControl(max.iter=30, tol=1e-4))
# Prediction
pred = predict(fm1, subset(dat1,time==6))
# MSPE
mean((subset(dat1,time==6)$y - pred$ypred)^2)
</code></pre>

<hr>
<h2 id='predict.SMSN'>Prediction of future observations from an smsn.lmm object
</h2><span id='topic+predict.SMSN'></span>

<h3>Description</h3>

<p>Predicted values are obtained through conditional expectation. For details, see Schumacher, Lachos, and Matos (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMSN'
predict(object, newData, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.SMSN_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMSN</code>, representing
a fitted scale mixture skew-normal linear mixed model.</p>
</td></tr>
<tr><td><code id="predict.SMSN_+3A_newdata">newData</code></td>
<td>
<p>A data frame for which response variable should be predicted, including covariates, groupVar and possibly timeVar. If missing or <code>NULL</code>, fitted values are returned.</p>
</td></tr>
<tr><td><code id="predict.SMSN_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with covariates, groupVar and ypred, where ypred contains the predicted values from the response variable.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+fitted.SMSN">fitted.SMSN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat1 = nlme::Orthodont
fm1 = smsn.lmm(distance ~ age+Sex, data=subset(dat1, age&lt;14), groupVar="Subject")
predict(fm1, subset(dat1, age==14))

</code></pre>

<hr>
<h2 id='print.SMN'>Print a smn.lmm object
</h2><span id='topic+print.SMN'></span>

<h3>Description</h3>

<p>Print a smn.lmm object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMN'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.SMN_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>SMN</code>, representing
a fitted scale mixture normal linear mixed model.</p>
</td></tr>
<tr><td><code id="print.SMN_+3A_...">...</code></td>
<td>
<p>Additional print arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+summary.SMN">summary.SMN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
fm1
</code></pre>

<hr>
<h2 id='print.SMNclmm'>Print a smn.clmm object

</h2><span id='topic+print.SMNclmm'></span>

<h3>Description</h3>

<p>Print a smn.clmm object.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'SMNclmm'
print(x, confint.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.SMNclmm_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>SMNclmm</code>, representing
a fitted scale mixture normal linear mixed model with censored responses.</p>
</td></tr>
<tr><td><code id="print.SMNclmm_+3A_confint.level">confint.level</code></td>
<td>
<p>Level of the approximate confidence intervals presented.</p>
</td></tr>
<tr><td><code id="print.SMNclmm_+3A_...">...</code></td>
<td>
<p>Additional print arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.clmm">smn.clmm</a></code>, <code><a href="#topic+summary.SMNclmm">summary.SMNclmm</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>nj1 = 5; m = 30
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))
dat1 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=0.7,
                  D=0.6*diag(1), beta=c(1,2), depStruct="UNC")
fm1 = smn.clmm(dat1, formFixed=y~x, groupVar="ind", formRandom=~1,
               depStruct="UNC", ci="ci", lcl="lcl", ucl="ucl")
fm1
</code></pre>

<hr>
<h2 id='print.SMSN'>Print a smsn.lmm object
</h2><span id='topic+print.SMSN'></span>

<h3>Description</h3>

<p>Print a smsn.lmm object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMSN'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.SMSN_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>SMSN</code>, representing
a fitted scale mixture skew-normal linear mixed model.</p>
</td></tr>
<tr><td><code id="print.SMSN_+3A_...">...</code></td>
<td>
<p>Additional print arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+summary.SMSN">summary.SMSN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fm1 = smsn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
fm1
  
</code></pre>

<hr>
<h2 id='ranef'>Extract random effects from smsn.lmm, smn.lmm and smn.clmm objects
</h2><span id='topic+ranef'></span>

<h3>Description</h3>

<p>It extracts random effects from smsn.lmm, smn.lmm and smn.clmm objects.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ranef(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ranef_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMSN</code>, representing
a fitted scale mixture skew-normal linear mixed model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of estimated random effects.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smn.clmm">smn.clmm</a></code>, <code><a href="#topic+fitted.SMSN">fitted.SMSN</a></code>, <code><a href="#topic+fitted.SMN">fitted.SMN</a></code>, <code><a href="#topic+fitted.SMNclmm">fitted.SMNclmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
ranef(fm1)
</code></pre>

<hr>
<h2 id='residuals'>Extract model residuals from smn.lmm and smsn.lmm objects
</h2><span id='topic+residuals.SMN'></span><span id='topic+residuals.SMSN'></span>

<h3>Description</h3>

<p>The conditional residuals are obtained by subtracting the fitted values from the response vector, while the marginal residuals are obtained by subtracting only the fixed effects from the response vector.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMN'
residuals(object, level = "conditional", type = "response", ...)

## S3 method for class 'SMSN'
residuals(object, level = "conditional", type = "response", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMN</code> or <code>SMSN</code>, representing
a fitted scale mixture of (skew) normal linear mixed model.</p>
</td></tr>
<tr><td><code id="residuals_+3A_level">level</code></td>
<td>
<p>Either <code>"conditional"</code>, for obtaining conditional residuals, or <code>"marginal"</code>, for marginal residuals.</p>
</td></tr>
<tr><td><code id="residuals_+3A_type">type</code></td>
<td>
<p>An optional character string specifying the type of residuals to be used. If <code>"response"</code>, as by default, the &quot;raw&quot; residuals (observed - fitted) are used; if <code>"normalized"</code>, the standardized residuals (residuals pre-multiplied by the inverse square-root of the estimated variance matrix) are used; else, if <code>"modified"</code>, modified residuals (residuals pre-multiplied by the inverse square-root of the estimated scale matrix) are used.</p>
</td></tr>
<tr><td><code id="residuals_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Modified residuals are useful when the variance is not finite, such as when <code class="reqn">\nu \le 2</code> for t or ST distributions, or when <code class="reqn">\nu \le 1</code> for SL or SSL distributions.
</p>


<h3>Value</h3>

<p>Vector with the residuals of length equal to <code>nrow(data)</code>.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+acfresid">acfresid</a></code>, <code><a href="#topic+mahalDist">mahalDist</a></code>, <code><a href="#topic+healy.plot">healy.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
residuals(fm1)
plot(fm1, useweight=FALSE)
</code></pre>

<hr>
<h2 id='residuals.SMNclmm'>Extract model residuals from smn.clmm objects

</h2><span id='topic+residuals.SMNclmm'></span>

<h3>Description</h3>

<p>The conditional residuals are obtained by subtracting the fitted values from the response vector, while the marginal residuals are obtained by subtracting only the fixed effects from the response vector.
</p>
<p>Censored values are imputed using their conditional expectation from the fitting algorithm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'SMNclmm'
residuals(object, level = "conditional", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.SMNclmm_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMNclmm</code>, representing
a fitted scale mixture of normal censored linear mixed model.</p>
</td></tr>
<tr><td><code id="residuals.SMNclmm_+3A_level">level</code></td>
<td>
<p>Either <code>"conditional"</code>, for obtaining conditional residuals, or <code>"marginal"</code>, for marginal residuals.</p>
</td></tr>
<tr><td><code id="residuals.SMNclmm_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with the residuals of length equal to <code>nrow(data)</code>.
</p>


<h3>Note</h3>

<p>The residuals are computed after imputing the censored observations.</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.clmm">smn.clmm</a></code>, <code><a href="#topic+mahalDistCens">mahalDistCens</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nj1 = 5; m = 30
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))
dat1 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=0.7,
                  D=0.6*diag(1), beta=c(1,2), depStruct="CS", phi=0.4)

fm1 = smn.clmm(dat1, formFixed=y~x, groupVar="ind", depStruct="CS", ci="ci",
               lcl="lcl", ucl="ucl", control=lmmControl(max.iter=30))
residuals(fm1)
</code></pre>

<hr>
<h2 id='rsmsn.clmm'>Generate data from SMSN-CLMM with censored responses

</h2><span id='topic+rsmsn.clmm'></span>

<h3>Description</h3>

<p>It creates a simulated data set from SMSN-CLMM with several possible dependence structures, with an established censoring rate or a fixed limit of detectation (LOD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  rsmsn.clmm(time, ind, x, z, sigma2, D, beta, lambda=rep(0, nrow(D)),
             depStruct="UNC", phi=NULL, distr="norm", nu=NULL, type="left",
             pcens=0.10, LOD=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsmsn.clmm_+3A_time">time</code></td>
<td>
<p>Vector of length <code class="reqn">N</code> containing times that should be used in data generation, where <code class="reqn">N</code> indicates the total number of observations.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_ind">ind</code></td>
<td>
<p>Vector of length <code class="reqn">N</code> containing the variable which represents the subjects or groups.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_x">x</code></td>
<td>
<p>Design matrix for fixed effects of dimension <code class="reqn">N\times p</code>.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_z">z</code></td>
<td>
<p>Design matrix for random effects of dimension <code class="reqn">N \times q</code>.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_sigma2">sigma2</code></td>
<td>
<p>Common variance parameter, such that <code class="reqn">\Sigma=\sigma^2*R</code>.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_d">D</code></td>
<td>
<p>Variance matrix for random effects.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_beta">beta</code></td>
<td>
<p>Vector of fixed effects parameter.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_lambda">lambda</code></td>
<td>
<p>Skewness parameter of random effects.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_depstruct">depStruct</code></td>
<td>
<p>Dependence structure. <code>"UNC"</code> for conditionally uncorrelated (<code>"CI"</code> is also accepted), <code>"ARp"</code> for AR(p) &ndash; p is <code>length(phi)</code>&ndash;, <code>"CS"</code> for compound symmetry, <code>"DEC"</code> for DEC, <code>"CAR1"</code> for continuous-time AR(1), and <code>"MA1"</code> for moving average of order 1.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_phi">phi</code></td>
<td>
<p>Parameter vector indexing the dependence structure.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_distr">distr</code></td>
<td>
<p>Distribution that should be used. <code>"norm"</code> for normal, <code>"t"</code> for Student-t, <code>"sn"</code> for skew-normal, and <code>"st"</code> for skew-t.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_nu">nu</code></td>
<td>
<p>Degrees of freedom for Student-t and skew-t distributions. It must be greater than 2.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_type">type</code></td>
<td>
<p><code>left</code> for left censoring and <code>right</code> for right censoring.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_pcens">pcens</code></td>
<td>
<p>Desired censoring rate.</p>
</td></tr>
<tr><td><code id="rsmsn.clmm_+3A_lod">LOD</code></td>
<td>
<p>Desired limit of detectation. If <code>LOD</code> is provided, then <code>pcens</code> will be discarded.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing time, the variable indicating groups (<code>ind</code>), the generated response variable (<code>y</code>), the censoring indicator variable (<code>ci</code>), the lower censoring limit (<code>lcl</code>), the upper censoring limit (<code>ucl</code>), and possible covariates.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>References</h3>

<p>Matos, L. A., Prates, M. O., Chen, M. H., and Lachos, V. H. (2013). Likelihood-based inference for mixed-effects models with censored response using the multivariate-t distribution. Statistica Sinica 23(3), 1323-1345.
</p>
<p>Lachos, V. H., A. Matos, L., Castro, L. M., and Chen, M. H. (2019). Flexible longitudinal linear mixed models for multiple censored responses data. Statistics in medicine, 38(6), 1074-1102.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.clmm">smn.clmm</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

# Generating a sample for m=25 individuals with 5 times
nj1 = 5
m = 25
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))

# Considering 10% of right censoring responses and normal distribution
dat1 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=.25,
                  D=0.5*diag(1), beta=c(1,2), depStruct="ARp", phi=0.5,
                  type="right")
head(dat1)
ggplot(dat1, aes(x=x, y=y, group=ind)) + geom_line() +
  stat_summary(aes(group=1), geom="line", fun=mean, col="blue", size=1.5) +
  geom_line(aes(x=x,y=lcl), color="red", linetype="dashed")

# Considering LOD=4, left censoring, and Student-t distribution
dat2 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=.25,
                  D=0.5*diag(1), beta=c(1,2), depStruct="CS", phi=0.2,
                  distr="t", nu=4, LOD=4)
mean(dat2$ci) #censoring rate
ggplot(dat2, aes(x=x, y=y, group=ind)) + geom_line() +
  stat_summary(aes(group=1), geom="line", fun=mean, col="blue", size=1.5) +
  geom_line(aes(x=x,y=ucl), color="red", linetype="dashed")
</code></pre>

<hr>
<h2 id='rsmsn.lmm'>Generate data from SMSN-LMM
</h2><span id='topic+rsmsn.lmm'></span>

<h3>Description</h3>

<p>It creates a simulated data set from SMSN-LMM (or from SMN-LMM, if <code>lambda = 0</code>) with several possible dependence structures, for one subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsmsn.lmm(time1, x1, z1, sigma2, D1, beta, lambda, depStruct = "UNC",
          phi = NULL, distr = "sn", nu = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsmsn.lmm_+3A_time1">time1</code></td>
<td>
<p>Vector containing times that should be used in data generation.</p>
</td></tr>
<tr><td><code id="rsmsn.lmm_+3A_x1">x1</code></td>
<td>
<p>Design matrix for fixed effects.</p>
</td></tr>
<tr><td><code id="rsmsn.lmm_+3A_z1">z1</code></td>
<td>
<p>Design matrix for random effects.</p>
</td></tr>
<tr><td><code id="rsmsn.lmm_+3A_sigma2">sigma2</code></td>
<td>
<p>Common variance parameter, such that <code class="reqn">\Sigma=\sigma^2*R</code>.</p>
</td></tr>
<tr><td><code id="rsmsn.lmm_+3A_d1">D1</code></td>
<td>
<p>Variance matrix for random effects.</p>
</td></tr>
<tr><td><code id="rsmsn.lmm_+3A_beta">beta</code></td>
<td>
<p>Vector of fixed effects parameter.</p>
</td></tr>
<tr><td><code id="rsmsn.lmm_+3A_lambda">lambda</code></td>
<td>
<p>Skewness parameter of random effects.</p>
</td></tr>
<tr><td><code id="rsmsn.lmm_+3A_depstruct">depStruct</code></td>
<td>
<p>Dependence structure. <code>"UNC"</code> for conditionally uncorrelated (<code>"CI"</code> is also accepted), <code>"ARp"</code> for AR(p) &ndash; p is <code>length(phi)</code>&ndash;, <code>"CS"</code> for compound symmetry, <code>"DEC"</code> for DEC, and <code>"CAR1"</code> for  continuous-time AR(1).</p>
</td></tr>
<tr><td><code id="rsmsn.lmm_+3A_phi">phi</code></td>
<td>
<p>Parameter vector indexing the dependence structure.</p>
</td></tr>
<tr><td><code id="rsmsn.lmm_+3A_distr">distr</code></td>
<td>
<p>Distribution that should be used. <code>"sn"</code> for skew-normal, <code>"st"</code> for skew-t, <code>"ss"</code> for skew-slash, and <code>"scn"</code> for skew-contaminated normal.</p>
</td></tr>
<tr><td><code id="rsmsn.lmm_+3A_nu">nu</code></td>
<td>
<p>Parameter vector indexing <code>distr</code>. Should be <code>NULL</code> for <code>"sn"</code>, be a vector of length 1 for <code>"st"</code> and <code>"ss"</code>, and of length 2 for <code>"scn"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing time, the generated response variable (<code>y</code>), and possible covariates.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Lachos, V. H., P. Ghosh, and R. B. Arellano-Valle (2010). Likelihood based inference for skew-normal independent linear mixed models. Statistica Sinica 20, 303-322.
</p>
<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.lmm">smsn.lmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generating a sample for 1 individual at 5 times
nj1 = 5
rsmsn.lmm(1:nj1, cbind(1, 1:nj1), rep(1, nj1), sigma2=.25, D1=diag(1),
          beta=c(1, 2), lambda=2, depStruct="ARp", phi=.5,
          distr="st", nu=5)

# Generating a sample for m=25 individuals with 5 times
library(dplyr)
library(purrr)
library(ggplot2)
nj1 = 5
m = 25
gendatList = map(rep(nj1, m),
                 function(nj) rsmsn.lmm(1:nj, cbind(1, 1:nj), rep(1, nj),
                                        sigma2=.25, D1=.5*diag(1), beta=c(1, 2),
                                        lambda=2, depStruct="ARp", phi=.5))
gendat = bind_rows(gendatList, .id="ind")
ggplot(gendat, aes(x=x, y=y, group=ind)) + geom_line() +
  stat_summary(aes(group=1), geom="line", fun=mean, col="blue", size=2)
#
fm1 = smsn.lmm(y ~ x, data=gendat, groupVar="ind", depStruct="ARp",
                pAR=1)
summary(fm1)

</code></pre>

<hr>
<h2 id='smn.clmm'>ML estimation of scale mixture of normal linear mixed models with censored responses
</h2><span id='topic+smn.clmm'></span>

<h3>Description</h3>

<p>It fits left, right, or interval censored scale mixture of normal linear mixed model with possible within-subject dependence structure, using the EM algorithm.
It provides estimates and standard errors of parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smn.clmm(data, formFixed, groupVar, formRandom = ~1, depStruct = "UNC",
         ci, lcl, ucl, timeVar = NULL, distr = "norm",
         nufix = FALSE, pAR = 1, control = lmmControl())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smn.clmm_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables named in <code>formFixed</code>, <code>formRandom</code>, <code>groupVar</code>, <code>timeVar</code>, <code>ci</code>, <code>lcl</code>, and <code>ucl</code>.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_formfixed">formFixed</code></td>
<td>
<p>A two-sided linear formula object describing the fixed effects part of the model, with the response on the left of a <code>~</code> operator and the covariates, separated by <code>+</code> operators, on the right.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_groupvar">groupVar</code></td>
<td>
<p>A character containing the name of the variable which represents the subjects or groups in <code>data</code>.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_formrandom">formRandom</code></td>
<td>
<p>A one-sided linear formula object describing the random effects part of the model, with the covariates, separated by <code>+</code> operators, on the right of a <code>~</code> operator. By default, a model with random intercept is considered.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_depstruct">depStruct</code></td>
<td>
<p>A character indicating which dependence structure should be used. <code>"UNC"</code> for conditionally uncorrelated (<code>"CI"</code> is also accepted), <code>"ARp"</code> for AR(p) &ndash; p is <code>length(phi)</code>&ndash;, <code>"CS"</code> for compound symmetry, <code>"DEC"</code> for DEC, <code>"CAR1"</code> for continuous-time AR(1), and <code>"MA1"</code> for moving average of order 1.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_ci">ci</code></td>
<td>
<p>A character containing the name of the censoring indicator variable in <code>data</code>, which should be 1 if the respective observation is censored or missing, and 1 otherwise. If missing, it is assumed that none of the observations is censored.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_lcl">lcl</code></td>
<td>
<p>A character containing the name of the lower censoring limit in <code>data</code>. If missing, it is assumed <code>lcl=-Inf</code>, i.e., no left limit.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_ucl">ucl</code></td>
<td>
<p>A character containing the name of the upper censoring limit in <code>data</code>. If missing, it is assumed <code>ucl=Inf</code>, i.e., no right limit.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_timevar">timeVar</code></td>
<td>
<p>A character containing the name of the variable which represents the time in <code>data</code>. Meaningless if <code>depStruct="UNC"</code> or <code>depStruct="CS"</code>. For other structures, if <code>is.null(timeVar)</code> the observations are considered equally spaced and ordered. If <code>depStruct="ARp"</code>, timeVar must be an index, preferably starting at 1.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_distr">distr</code></td>
<td>
<p>A character indicating which distribution should be used. <code>"norm"</code> for normal and <code>"t"</code> for Student-t.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_nufix">nufix</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating if <code>nu</code> should be estimated for t distribution. If <code>nufix=TRUE</code>, nu must be especified through <code>lmmControl()</code>.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_par">pAR</code></td>
<td>
<p>If <code>depStruct="ARp"</code>, <code>pAR</code> indicates the order of the autoregressive process that should be used (1 by default). Otherwise, it is meaningless.</p>
</td></tr>
<tr><td><code id="smn.clmm_+3A_control">control</code></td>
<td>
<p>An object resulting from the function <code>lmmControl()</code>, containing additional options for the estimation algorithm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It fits the model <code class="reqn">Y_i = X_i \beta + Z_i b_i + \epsilon_i</code>, for <code class="reqn">i=1,\dots,n</code>, where <code class="reqn">Y_i</code> is a vector with <code class="reqn">n_i</code> observed continuous responses, <code class="reqn">b_i ~ SMN(0, D; H)</code> and <code class="reqn">\epsilon_i ~ SMN(0, \Sigma_i; H)</code>, indexed by the same mixing distribution.
</p>
<p>For details see Matos et al. (2013) and Lachos et al. (2019).
</p>


<h3>Value</h3>

<p>An object of class &quot;SMNclmm&quot; representing the SMN-CLMM fit. Generic functions such as print and summary have methods to show the results of the fit. The functions fitted and ranef can be used to extract some of its components.
</p>
<p>Specifically, the following components are returned:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>Named vector with parameter estimates.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations runned.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>A named list containing parameter estimates.</p>
</td></tr>
<tr><td><code>yest</code></td>
<td>
<p>Imputed values in the response variable.</p>
</td></tr>
<tr><td><code>uhat</code></td>
<td>
<p>Estimated weights.</p>
</td></tr>
<tr><td><code>loglik.track</code></td>
<td>
<p>Vector containing the log-likelihood value from each iteration of the estimation procedure.</p>
</td></tr>
<tr><td><code>random.effects</code></td>
<td>
<p>Estimated random effects.</p>
</td></tr>
<tr><td><code>std.error</code></td>
<td>
<p>A vector with standard errors.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Value of the log-likelihood at last iteration.</p>
</td></tr>
<tr><td><code>elapsedTime</code></td>
<td>
<p>Time elapsed in processing, in seconds.</p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>Convergence criterion at last iteration.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>A list with AIC, BIC, and SIC criterion.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The <code>smn.clmm</code> call that produced the object.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The data frame used on <code>smn.clmm</code> call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>A list containing the formulas used on <code>smn.clmm</code> call.</p>
</td></tr>
<tr><td><code>depStruct</code></td>
<td>
<p>A character indicating which dependence structure was used.</p>
</td></tr>
<tr><td><code>covRandom</code></td>
<td>
<p>A character indicating which structure was used for the random effects scale matrix.</p>
</td></tr>
<tr><td><code>distr</code></td>
<td>
<p>A character indicating which distribution was used.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The number of observations used.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The number of individuals/groups used.</p>
</td></tr>
<tr><td><code>groupVar</code></td>
<td>
<p>A character indicating the name of the grouping variable.</p>
</td></tr>
<tr><td><code>timeVar</code></td>
<td>
<p>A character indicating the name of the time variable, if any.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>A vector of fitted values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Larissa A. Matos, Victor H. Lachos, Katherine L. Valeriano and Fernanda L. Schumacher
</p>


<h3>References</h3>

<p>Henderson, N. C. and R. Varadhan (2019). Damped anderson acceleration with restarts
and monotonicity control for accelerating EM and EM-like algorithms. Journal of
Computational and Graphical Statistics 28(4), 834-846.
</p>
<p>Matos, L. A., Prates, M. O., Chen, M. H., and Lachos, V. H. (2013). Likelihood-based inference for mixed-effects models with censored response using the multivariate-t distribution. Statistica Sinica 23(3), 1323-1345.
</p>
<p>Lachos, V. H., A. Matos, L., Castro, L. M., and Chen, M. H. (2019). Flexible longitudinal linear mixed models for multiple censored responses data. Statistics in medicine, 38(6), 1074-1102.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmmControl">lmmControl</a></code>, <code><a href="stats.html#topic+update">update</a></code>, <code><a href="#topic+predict.SMNclmm">predict.SMNclmm</a></code>, <code><a href="#topic+residuals.SMNclmm">residuals.SMNclmm</a></code>, <code><a href="#topic+plot.SMNclmm">plot.SMNclmm</a></code>,
<code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generating a sample for m=30 individuals with 5 times
# Considering 10% of left censoring responses
# AR(1) and normal distribution
nj1 = 5
m = 30
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))
dat1 = rsmsn.clmm(time = time, ind = groups, x = cbind(1,time), z = rep(1,m*nj1),
                  sigma2=0.6, D=0.5*diag(1), beta=c(1,2), depStruct="ARp",
                  phi=0.4, pcens = .1, type = "left")

# Estimation using UNC
fm0 = smn.clmm(dat1, formFixed=y~x, groupVar="ind", ci="ci", ucl="ucl")
summary(fm0)

# Estimation using AR(1)
fm1 = update(fm0, depStruct="ARp")

# Estimation using AR(1) and t distribution
fm2 = update(fm1, distr="t")

# Comparing fitted models
criteria(list(fm0= fm0, fm1=fm1, fm2=fm2))

</code></pre>

<hr>
<h2 id='smn.lmm'>ML estimation of scale mixture of normal linear mixed models
</h2><span id='topic+smn.lmm'></span>

<h3>Description</h3>

<p>It fits a scale mixture of normal linear mixed model with possible within-subject dependence structure, using an EM-type algorithm (via the DAAREM method, by default).
It provides estimates and standard errors of parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smn.lmm(data, formFixed, groupVar, formRandom = ~1, depStruct = "UNC",
        timeVar = NULL, distr = "norm", covRandom = "pdSymm",
        pAR = 1, control = lmmControl())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smn.lmm_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables named in <code>formFixed</code>, <code>formRandom</code>, <code>groupVar</code>, and <code>timeVar</code>.</p>
</td></tr>
<tr><td><code id="smn.lmm_+3A_formfixed">formFixed</code></td>
<td>
<p>A two-sided linear formula object describing the fixed effects part of the model, with the response on the left of a <code>~</code> operator and the covariates, separated by <code>+</code> operators, on the right.</p>
</td></tr>
<tr><td><code id="smn.lmm_+3A_groupvar">groupVar</code></td>
<td>
<p>A character containing the name of the variable which represents the subjects or groups in <code>data</code>.</p>
</td></tr>
<tr><td><code id="smn.lmm_+3A_formrandom">formRandom</code></td>
<td>
<p>A one-sided linear formula object describing the random effects part of the model, with the covariates, separated by <code>+</code> operators, on the right of a <code>~</code> operator. By default, a model with random intercept is considered.</p>
</td></tr>
<tr><td><code id="smn.lmm_+3A_depstruct">depStruct</code></td>
<td>
<p>A character indicating which dependence structure should be used. <code>"UNC"</code> for conditionally uncorrelated (<code>"CI"</code> is also accepted), <code>"ARp"</code> for AR(p) &ndash; p is <code>length(phi)</code>&ndash;, <code>"CS"</code> for compound symmetry, <code>"DEC"</code> for DEC, and <code>"CAR1"</code> for  continuous-time AR(1).</p>
</td></tr>
<tr><td><code id="smn.lmm_+3A_timevar">timeVar</code></td>
<td>
<p>A character containing the name of the variable which represents the time in <code>data</code>. Meaningless if <code>depStruct="UNC"</code> or <code>depStruct="CS"</code>. For other structures, if <code>is.null(timeVar)</code> the observations are considered equally spaced and ordered. If <code>depStruct="ARp"</code>, timeVar must be an index, preferably starting at 1.</p>
</td></tr>
<tr><td><code id="smn.lmm_+3A_distr">distr</code></td>
<td>
<p>A character indicating which distribution should be used. <code>"norm"</code> for normal, <code>"t"</code> for t, <code>"sl"</code> for slash, and <code>"cn"</code> for contaminated normal.</p>
</td></tr>
<tr><td><code id="smn.lmm_+3A_covrandom">covRandom</code></td>
<td>
<p>A character indicating which structure should be used for the random
effects scale matrix (either <code>"pdSymm"</code> (default), for a general positive-definite matrix, or <code>"pdDiag"</code>, for a diagonal matrix).</p>
</td></tr>
<tr><td><code id="smn.lmm_+3A_par">pAR</code></td>
<td>
<p>If <code>depStruct="ARp"</code>, pAR indicates the order of the autoregressive process that should be used. Otherwise, it is meaningless.</p>
</td></tr>
<tr><td><code id="smn.lmm_+3A_control">control</code></td>
<td>
<p>An object resulting from the function <code>lmmControl()</code>, containing additional options for the estimation algorithm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It fits the model <code class="reqn">Y_i = X_i \beta + Z_i b_i + \epsilon_i</code>, for <code class="reqn">i=1,\dots,n</code>, where <code class="reqn">Y_i</code> is a vector with <code class="reqn">n_i</code> observed continuous responses, <code class="reqn">b_i ~ SMN(0, D; H)</code> and <code class="reqn">\epsilon_i ~ SMN(0, \Sigma_i; H)</code>, indexed by the same mixing distribution.
</p>
<p>For efficiency, the DAAREM method is used for parameter estimation. In case of numerical errors, please try passing to  <code><a href="#topic+lmmControl">lmmControl</a>(algorithm = "DAAREM")</code> to the <code>control</code> argument.
</p>
<p>For details see Schumacher, Lachos &amp; Matos (2021).
</p>


<h3>Value</h3>

<p>An object of class &quot;SMN&quot; representing the SMN-LMM fit. Generic functions such as print and summary have methods to show the results of the fit. The functions fitted and ranef can be used to extract some of its components.
</p>
<p>Specifically, the following components are returned:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>Named vector with parameter estimates.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations runned.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>A named list containing parameter estimates.</p>
</td></tr>
<tr><td><code>uhat</code></td>
<td>
<p>Estimated weights.</p>
</td></tr>
<tr><td><code>loglik.track</code></td>
<td>
<p>Vector containing the log-likelihood value from each iteration of the estimation procedure.</p>
</td></tr>
<tr><td><code>random.effects</code></td>
<td>
<p>Estimated random effects.</p>
</td></tr>
<tr><td><code>std.error</code></td>
<td>
<p>A vector with standard errors.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Value of the log-likelihood at last iteration.</p>
</td></tr>
<tr><td><code>elapsedTime</code></td>
<td>
<p>Time elapsed in processing, in seconds.</p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>Convergence criterion at last iteration.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The <code>smn.lmm</code> call that produced the object.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>A list with AIC and BIC criterion.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The data frame used on <code>smn.lmm</code> call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>A list containing the formulas used on <code>smn.lmm</code> call.</p>
</td></tr>
<tr><td><code>depStruct</code></td>
<td>
<p>A character indicating which dependence structure was used.</p>
</td></tr>
<tr><td><code>covRandom</code></td>
<td>
<p>A character indicating which structure was used for the random effects scale matrix.</p>
</td></tr>
<tr><td><code>distr</code></td>
<td>
<p>A character indicating which distribution was used.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The number of observations used.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The number of individuals/groups used.</p>
</td></tr>
<tr><td><code>groupVar</code></td>
<td>
<p>A character indicating the name of the grouping variable.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>The control list used in the function's call.</p>
</td></tr>
<tr><td><code>timeVar</code></td>
<td>
<p>A character indicating the name of the time variable, if any.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>A vector of fitted values, if <code>calc.bi=TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Henderson, N. C. and R. Varadhan (2019). Damped anderson acceleration with restarts
and monotonicity control for accelerating EM and EM-like algorithms. Journal of
Computational and Graphical Statistics 28(4), 834-846.
</p>
<p>Lachos, V. H., P. Ghosh, and R. B. Arellano-Valle (2010). Likelihood based inference for skew-normal independent linear mixed models. Statistica Sinica 20, 303-322.
</p>
<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmmControl">lmmControl</a></code>, <code><a href="stats.html#topic+update">update</a></code>, <code><a href="#topic+predict.SMN">predict.SMN</a></code>, <code><a href="#topic+residuals.SMN">residuals.SMN</a></code>, <code><a href="#topic+plot.SMN">plot.SMN</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+smn.clmm">smn.clmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simple example
dat1 = as.data.frame(nlme::Orthodont)
fm1 = smn.lmm(dat1, formFixed=distance ~ age, groupVar="Subject",
                control=lmmControl(max.iter=30))
fm1

#fitting for several distributions / dependence structures
fm1 = smn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject")
fm2 = smn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject",
              distr="t")
fm3 = smn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject",
              distr="sl")
fm4 = smn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject",
              depStruct="ARp", pAR=1)
criteria(list(fm1=fm1, fm2=fm2, fm3=fm3, fm4=fm4))
summary(fm3)

#some diagnostic tools
plot(fm3)
acf3 = acfresid(fm3, calcCI=TRUE, MCiter=100)
plot(acf3)
plot(mahalDist(fm3), nlabels=2)
healy.plot(fm3)

</code></pre>

<hr>
<h2 id='smsn.lmm'>ML estimation of scale mixture of skew-normal linear mixed models
</h2><span id='topic+smsn.lmm'></span>

<h3>Description</h3>

<p>It fits a scale mixture of skew-normal linear mixed model with possible within-subject dependence structure, using an EM-type algorithm (via the DAAREM method, by default).
It provides estimates and standard errors of parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smsn.lmm(data, formFixed, groupVar, formRandom = ~1, depStruct = "UNC",
         timeVar = NULL, distr = "sn", covRandom = "pdSymm",
         skewind, pAR = 1, control = lmmControl())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smsn.lmm_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables named in <code>formFixed</code>, <code>formRandom</code>, <code>groupVar</code>, and <code>timeVar</code>.</p>
</td></tr>
<tr><td><code id="smsn.lmm_+3A_formfixed">formFixed</code></td>
<td>
<p>A two-sided linear formula object describing the fixed effects part of the model, with the response on the left of a <code>~</code> operator and the covariates, separated by <code>+</code> operators, on the right.</p>
</td></tr>
<tr><td><code id="smsn.lmm_+3A_groupvar">groupVar</code></td>
<td>
<p>A character containing the name of the variable which represents the subjects or groups in <code>data</code>.</p>
</td></tr>
<tr><td><code id="smsn.lmm_+3A_formrandom">formRandom</code></td>
<td>
<p>A one-sided linear formula object describing the random effects part of the model, with the covariates, separated by <code>+</code> operators, on the right of a <code>~</code> operator. By default, a model with random intercept is considered.</p>
</td></tr>
<tr><td><code id="smsn.lmm_+3A_depstruct">depStruct</code></td>
<td>
<p>A character indicating which dependence structure should be used. <code>"UNC"</code> for conditionally uncorrelated (<code>"CI"</code> is also accepted), <code>"ARp"</code> for AR(p) &ndash; p is <code>length(phi)</code>&ndash;, <code>"CS"</code> for compound symmetry, <code>"DEC"</code> for DEC, and <code>"CAR1"</code> for  continuous-time AR(1).</p>
</td></tr>
<tr><td><code id="smsn.lmm_+3A_timevar">timeVar</code></td>
<td>
<p>A character containing the name of the variable which represents the time in <code>data</code>. Meaningless if <code>depStruct="UNC"</code> or <code>depStruct="CS"</code>. For other structures, if <code>is.null(timeVar)</code> the observations are considered equally spaced and ordered. If <code>depStruct="ARp"</code>, timeVar must be an index, preferably starting at 1.</p>
</td></tr>
<tr><td><code id="smsn.lmm_+3A_distr">distr</code></td>
<td>
<p>A character indicating which distribution should be used. <code>"sn"</code> for skew-normal, <code>"st"</code> for skew-t, <code>"ssl"</code> for skew-slash, and <code>"scn"</code> for skew-contaminated normal.</p>
</td></tr>
<tr><td><code id="smsn.lmm_+3A_covrandom">covRandom</code></td>
<td>
<p>A character indicating which structure should be used for the random
effects scale matrix (either <code>"pdSymm"</code> (default), for a general positive-definite matrix, or <code>"pdDiag"</code>, for a diagonal matrix).</p>
</td></tr>
<tr><td><code id="smsn.lmm_+3A_skewind">skewind</code></td>
<td>
<p>A vector of length equal to the number of random effects, containing
0's and 1's, indicating which elements of the skewness parameter vector should be estimated
(optional, default is an all-ones vector).</p>
</td></tr>
<tr><td><code id="smsn.lmm_+3A_par">pAR</code></td>
<td>
<p>If <code>depStruct="ARp"</code>, pAR indicates the order of the autoregressive process that should be used. Otherwise, it is meaningless.</p>
</td></tr>
<tr><td><code id="smsn.lmm_+3A_control">control</code></td>
<td>
<p>An object resulting from the function <code>lmmControl()</code>, containing additional options for the estimation algorithm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It fits the model <code class="reqn">Y_i = X_i \beta + Z_i b_i + \epsilon_i</code>, for <code class="reqn">i=1,\dots,n</code>, where <code class="reqn">Y_i</code> is a vector with <code class="reqn">n_i</code> observed continuous responses, <code class="reqn">b_i ~ SMSN(c\Delta, D,\lambda;H)</code> and <code class="reqn">\epsilon_i ~ SMN(0, \Sigma_i; H)</code>, indexed by the same mixing distribution.
</p>
<p>For efficiency, the DAAREM method is used for parameter estimation. In case of numerical errors, please try passing to  <code><a href="#topic+lmmControl">lmmControl</a>(algorithm = "DAAREM")</code> to the <code>control</code> argument.
</p>
<p>For details see Schumacher, Lachos &amp; Matos (2021).
</p>


<h3>Value</h3>

<p>An object of class &quot;SMSN&quot; representing the SMSN-LMM fit. Generic functions such as print and summary have methods to show the results of the fit. The functions fitted and ranef can be used to extract some of its components.
</p>
<p>Specifically, the following components are returned:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>Named vector with parameter estimates.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations runned.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>A named list containing parameter estimates.</p>
</td></tr>
<tr><td><code>uhat</code></td>
<td>
<p>Estimated weights.</p>
</td></tr>
<tr><td><code>loglik.track</code></td>
<td>
<p>Vector containing the log-likelihood value from each iteration of the estimation procedure.</p>
</td></tr>
<tr><td><code>random.effects</code></td>
<td>
<p>Estimated random effects.</p>
</td></tr>
<tr><td><code>std.error</code></td>
<td>
<p>A vector with standard errors.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Value of the log-likelihood at last iteration.</p>
</td></tr>
<tr><td><code>elapsedTime</code></td>
<td>
<p>Time elapsed in processing, in seconds.</p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>Convergence criterion at last iteration.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The <code>smsn.lmm</code> call that produced the object.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>A list with AIC and BIC criterion.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The data frame used on <code>smsn.lmm</code> call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>A list containing the formulas used on <code>smsn.lmm</code> call.</p>
</td></tr>
<tr><td><code>depStruct</code></td>
<td>
<p>A character indicating which dependence structure was used.</p>
</td></tr>
<tr><td><code>covRandom</code></td>
<td>
<p>A character indicating which structure was used for the random effects scale matrix.</p>
</td></tr>
<tr><td><code>distr</code></td>
<td>
<p>A character indicating which distribution was used.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The number of observations used.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The number of individuals/groups used.</p>
</td></tr>
<tr><td><code>groupVar</code></td>
<td>
<p>A character indicating the name of the grouping variable.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>The control list used in the function's call.</p>
</td></tr>
<tr><td><code>timeVar</code></td>
<td>
<p>A character indicating the name of the time variable, if any.</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>A vector of fitted values, if <code>calc.bi=TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>References</h3>

<p>Henderson, N. C. and R. Varadhan (2019). Damped anderson acceleration with restarts
and monotonicity control for accelerating EM and EM-like algorithms. Journal of
Computational and Graphical Statistics 28(4), 834-846.
</p>
<p>Lachos, V. H., P. Ghosh, and R. B. Arellano-Valle (2010). Likelihood based inference for skew-normal independent linear mixed models. Statistica Sinica 20, 303-322.
</p>
<p>Schumacher, F. L., Lachos, V. H., and Matos, L. A. (2021). Scale mixture of skew-normal linear mixed models with within-subject serial dependence. Statistics in Medicine 40(7), 1790-1810.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmmControl">lmmControl</a></code>, <code><a href="stats.html#topic+update">update</a></code>, <code><a href="#topic+predict.SMSN">predict.SMSN</a></code>, <code><a href="#topic+residuals.SMSN">residuals.SMSN</a></code>, <code><a href="#topic+plot.SMSN">plot.SMSN</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smn.clmm">smn.clmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simple example
dat1 = as.data.frame(nlme::Orthodont)
fm1 = smsn.lmm(dat1, formFixed=distance ~ age, groupVar="Subject",
                control=lmmControl(max.iter=30))
fm1

#fitting for several distributions / dependence structures
fm1 = smsn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject")
fm2 = smsn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject",
               distr="st")
fm3 = smsn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject",
               distr="ssl")
fm4 = smsn.lmm(dat1, formFixed=distance ~ age+Sex, groupVar="Subject",
               depStruct="ARp", pAR=1)
criteria(list(fm1=fm1, fm2=fm2, fm3=fm3, fm4=fm4))
summary(fm3)

#some diagnostic tools
plot(fm3)
acf3 = acfresid(fm3, calcCI=TRUE, MCiter=100)
plot(acf3)
plot(mahalDist(fm3), nlabels=2)
healy.plot(fm3)

</code></pre>

<hr>
<h2 id='summary.SMN'>Summary of a smn.lmm object
</h2><span id='topic+summary.SMN'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;SMN&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMN'
summary(object, confint.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SMN_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMN</code>, representing
a fitted scale mixture normal linear mixed model.</p>
</td></tr>
<tr><td><code id="summary.SMN_+3A_confint.level">confint.level</code></td>
<td>
<p>Level of the approximate confidence intervals presented.</p>
</td></tr>
<tr><td><code id="summary.SMN_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>varRandom</code></td>
<td>
<p>Estimated variance matrix from random effects (<code class="reqn">D</code>).</p>
</td></tr>
<tr><td><code>varFixed</code></td>
<td>
<p>Parameter estimates of variance from random errors (<code class="reqn">\Sigma</code>). For recovering the error variance matrix use <code><a href="#topic+errorVar">errorVar</a></code> function.</p>
</td></tr>
<tr><td><code>tableFixed</code></td>
<td>
<p>Estimated fixed effects, their standard errors and approximated confidence intervals.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>Maximum log-likelihood value, AIC and BIC criteria.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+boot_par">boot_par</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+errorVar">errorVar</a></code>, <code><a href="#topic+plot.SMN">plot.SMN</a></code>, <code><a href="#topic+residuals.SMN">residuals.SMN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fm1 = smn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject")
summary(fm1)
</code></pre>

<hr>
<h2 id='summary.SMNclmm'>Summary of a smn.clmm object

</h2><span id='topic+summary.SMNclmm'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;SMNclmm&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'SMNclmm'
summary(object, confint.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SMNclmm_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMNclmm</code>,
representing a fitted scale mixture normal linear mixed model with censored responses.</p>
</td></tr>
<tr><td><code id="summary.SMNclmm_+3A_confint.level">confint.level</code></td>
<td>
<p>Level of the approximate confidence intervals presented.</p>
</td></tr>
<tr><td><code id="summary.SMNclmm_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smn.clmm">smn.clmm</a></code>, <code><a href="#topic+plot.SMNclmm">plot.SMNclmm</a></code>, <code><a href="#topic+residuals.SMNclmm">residuals.SMNclmm</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>nj1 = 5; m = 30
time = rep(1:nj1, times=m)
groups = as.factor(rep(1:m, each=nj1))
dat1 = rsmsn.clmm(time, groups, cbind(1,time), rep(1,m*nj1), sigma2=0.7,
                  D=0.5*diag(1), beta=c(1,2), depStruct="UNC")
fm1 = smn.clmm(dat1, formFixed=y~x, groupVar="ind", formRandom=~1,
               depStruct="UNC", ci="ci", lcl="lcl", ucl="ucl")
summary(fm1)
</code></pre>

<hr>
<h2 id='summary.SMSN'>Summary of a smsn.lmm object
</h2><span id='topic+summary.SMSN'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;SMSN&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMSN'
summary(object, confint.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.SMSN_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>SMSN</code>, representing
a fitted scale mixture skew-normal linear mixed model.</p>
</td></tr>
<tr><td><code id="summary.SMSN_+3A_confint.level">confint.level</code></td>
<td>
<p>Level of the approximate confidence intervals presented.</p>
</td></tr>
<tr><td><code id="summary.SMSN_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>varRandom</code></td>
<td>
<p>Estimated variance matrix from random effects (<code class="reqn">D</code>).</p>
</td></tr>
<tr><td><code>varFixed</code></td>
<td>
<p>Parameter estimates of variance from random errors (<code class="reqn">\Sigma</code>). For recovering the error variance matrix use <code><a href="#topic+errorVar">errorVar</a></code> function.</p>
</td></tr>
<tr><td><code>tableFixed</code></td>
<td>
<p>Estimated fixed effects, their standard errors and approximated confidence intervals.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>Maximum log-likelihood value, AIC and BIC criteria.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos and Victor H. Lachos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+boot_par">boot_par</a></code>, <code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+errorVar">errorVar</a></code>, <code><a href="#topic+plot.SMSN">plot.SMSN</a></code>, <code><a href="#topic+residuals.SMSN">residuals.SMSN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smsn.lmm(distance ~ age+Sex, data=nlme::Orthodont, groupVar="Subject",
               control=lmmControl(tol=.0001))
summary(fm1)
</code></pre>

<hr>
<h2 id='update'>Update for SMSN/SMN/SMNclmm objects
</h2><span id='topic+update.SMN'></span><span id='topic+update.SMSN'></span><span id='topic+update.SMNclmm'></span>

<h3>Description</h3>

<p>It fits a SM(S)N-(C)LMM by updating a fitted object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SMN'
update(object, ..., evaluate = TRUE)

## S3 method for class 'SMSN'
update(object, ..., evaluate = TRUE)

## S3 method for class 'SMNclmm'
update(object, ..., evaluate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_+3A_object">object</code></td>
<td>
<p>A smsn.lmm, smn.lmm or smn.clmm object containing the fitted model to be updated.</p>
</td></tr>
<tr><td><code id="update_+3A_...">...</code></td>
<td>
<p>Arguments to be changed.</p>
</td></tr>
<tr><td><code id="update_+3A_evaluate">evaluate</code></td>
<td>
<p>A logical value indicating if the new class should be evaluated. If <code>FALSE</code>, the call is returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object resulting from the <code>smsm.lmm()</code>, <code>smn.lmm()</code> or <code>smn.clmm()</code> function.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Larissa A. Matos, Victor H. Lachos and Katherine L. Valeriano
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smsn.lmm">smsn.lmm</a></code>, <code><a href="#topic+smn.lmm">smn.lmm</a></code>, <code><a href="#topic+smn.clmm">smn.clmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm1 = smn.lmm(nlme::Orthodont, formFixed=distance ~ age+Sex, groupVar="Subject")
fm2 = update(fm1, distr="t")
fm2
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
