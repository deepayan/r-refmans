<!DOCTYPE html><html lang="en-US"><head><title>Help for package HiResTEC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HiResTEC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DeconvoluteSpectrum'><p>Deconvolute a Mass Spectrum from a list of raw data files.</p></a></li>
<li><a href='#EvaluateCandidateListAgainstRawData'><p>Evaluate m/z pairs against raw data.</p></a></li>
<li><a href='#EvaluatePairsFromXCMSSet'><p>Identify and evaluate mz pairs from a peak list.</p></a></li>
<li><a href='#GenerateCandXLSX'><p>Generate a table for the candidates obtained in EvaluateCandidateListAgainstRawData.</p></a></li>
<li><a href='#GenerateQCPlots'><p>Generate quality control plots for mz pair candidates.</p></a></li>
<li><a href='#getMultipleBPC'><p>Extract multiple ion chromatograms from mass spectrometry data.</p></a></li>
<li><a href='#plotBPC'><p>Plot base peak chromatograms for multiple high resolution masses in multiple samples.</p></a></li>
<li><a href='#plotMID'><p>Plot a Mass Isotopomer Distribution (MID) for multiple samples.</p></a></li>
<li><a href='#raw'><p>Different example data files to be used in the help section of 'HiResTEC' functions.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Non-Targeted Fluxomics on High-Resolution Mass-Spectrometry Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.63.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-02-21</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Lisec &lt;jan.lisec@bam.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Identifying labeled compounds in a 13C-tracer experiment in
    non-targeted fashion is a cumbersome process. This package facilitates
    such type of analyses by providing high level quality control plots,
    deconvoluting and evaluating spectra and performing a multitude of
    tests in an automatic fashion.  The main idea is to use changing
    intensity ratios of ion pairs from peak list generated with 'xcms' as
    candidates and evaluate those against base peak chromatograms and
    spectra information within the raw measurement data automatically.
    The functionality is described in Hoffmann et al. (2018)
    &lt;<a href="https://doi.org/10.1021%2Facs.analchem.8b00356">doi:10.1021/acs.analchem.8b00356</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/janlisec/HiResTEC">https://github.com/janlisec/HiResTEC</a>,
<a href="https://janlisec.github.io/HiResTEC/">https://janlisec.github.io/HiResTEC/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>CorrectOverloadedPeaks (&ge; 1.3.5), plyr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>beeswarm, CorMID, InterpretMSSpectrum, knitr, openxlsx,
rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-27 09:36:55 UTC; jlisec</td>
</tr>
<tr>
<td>Author:</td>
<td>Jan Lisec <a href="https://orcid.org/0000-0003-1220-2286"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Friederike Hoffmann [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-27 09:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='DeconvoluteSpectrum'>Deconvolute a Mass Spectrum from a list of raw data files.</h2><span id='topic+DeconvoluteSpectrum'></span>

<h3>Description</h3>

<p><code>DeconvoluteSpectrum</code> will evaluate a list of 'xcmsRaw' or
'xcmsRawLike' objects at a given time (rt) and potential mass (mz1). The
main purpose is to deconvolute the mass spectrum at rt including mz1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DeconvoluteSpectrum(
  dat = NULL,
  rt = NULL,
  rt_dev = 3,
  mz1 = NULL,
  mz_dev = 0.003,
  use.mz.adjust = FALSE,
  ionization = c("APCI", "ESI")[1],
  smooth = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DeconvoluteSpectrum_+3A_dat">dat</code></td>
<td>
<p>A list of 'xcmsRaw' or 'xcmsRawLike' objects.</p>
</td></tr>
<tr><td><code id="DeconvoluteSpectrum_+3A_rt">rt</code></td>
<td>
<p>Retention time of the expected peak.</p>
</td></tr>
<tr><td><code id="DeconvoluteSpectrum_+3A_rt_dev">rt_dev</code></td>
<td>
<p>Allowed retention time deviation.</p>
</td></tr>
<tr><td><code id="DeconvoluteSpectrum_+3A_mz1">mz1</code></td>
<td>
<p>If specified, ensure that this mass is included in the spectrum (assumed base peak). Can be NULL otherwise in which case the most intense peak at rt will be selected as mz1.</p>
</td></tr>
<tr><td><code id="DeconvoluteSpectrum_+3A_mz_dev">mz_dev</code></td>
<td>
<p>Allowed mz deviation [Da].</p>
</td></tr>
<tr><td><code id="DeconvoluteSpectrum_+3A_use.mz.adjust">use.mz.adjust</code></td>
<td>
<p>Will adjust mz on an experiment wide basis.</p>
</td></tr>
<tr><td><code id="DeconvoluteSpectrum_+3A_ionization">ionization</code></td>
<td>
<p>Either APCI or ESI. Choice will modify some internal parameters and checks performed.</p>
</td></tr>
<tr><td><code id="DeconvoluteSpectrum_+3A_smooth">smooth</code></td>
<td>
<p>Smoothing parameter passed on to <a href="#topic+getMultipleBPC">getMultipleBPC</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The specific advantage of <code>DeconvoluteSpectrum</code> is, that it does
not deconvolute signals within a single measurement file but uses correlation
tests over a set of measurements to improve statistical power. It will test
all mz around a specified rt to co-apex with some mz1, have a low rt
difference and consistent intensity ratio over all samples.
</p>


<h3>Value</h3>

<p>A pseudo spectrum at rt (containing mz1 if specified). Effectively
a 2-column matrix (mz, int) with rt as attribute.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The example measurement data provided with HiResTEC contain a peak at 1026s
raw &lt;- HiResTEC::raw
HiResTEC::DeconvoluteSpectrum(raw, rt = 1026)

</code></pre>

<hr>
<h2 id='EvaluateCandidateListAgainstRawData'>Evaluate m/z pairs against raw data.</h2><span id='topic+EvaluateCandidateListAgainstRawData'></span>

<h3>Description</h3>

<p><code>EvaluateCandidateListAgainstRawData</code> will compare the result
of function <a href="#topic+EvaluatePairsFromXCMSSet">EvaluatePairsFromXCMSSet</a> against raw data files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EvaluateCandidateListAgainstRawData(
  x = NULL,
  tp = NULL,
  gr = NULL,
  dat = NULL,
  dmz = 0.025,
  drt = 1,
  dEcut = 1,
  Pcut = 0.01,
  Icut = 1000,
  method = c("APCI", "ESI")[1],
  rolp = c("non", "pos", "neg", "all")[2],
  smooth = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_x">x</code></td>
<td>
<p>Dataframe of results (output of EvaluatePairsFromXCMSet).</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_tp">tp</code></td>
<td>
<p>Timepoint.</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_gr">gr</code></td>
<td>
<p>group, e.g. different genotypes or concentrations.</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_dat">dat</code></td>
<td>
<p>list of xcmsRaw's for deconvolution and plotting.</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_dmz">dmz</code></td>
<td>
<p>Allowed mass deviation in Da (for BPC extraction).</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_drt">drt</code></td>
<td>
<p>Allowed rt deviation in seconds (for get extraction).</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_decut">dEcut</code></td>
<td>
<p>Minimum required change in enrichment before a candidate ID is assigned.</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_pcut">Pcut</code></td>
<td>
<p>Maximum allowed P value before a candidate ID is assigned.</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_icut">Icut</code></td>
<td>
<p>Minimum required median peak intensity before a candidate ID is assigned.</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_method">method</code></td>
<td>
<p>Either APCI or ESI. Choice will modify some internal parameters
and checks performed.</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_rolp">rolp</code></td>
<td>
<p>RemoveOverLappingPeaks parameter, overlapping means from a
deconvoluted spectrum where another peak was already evaluated.</p>
</td></tr>
<tr><td><code id="EvaluateCandidateListAgainstRawData_+3A_smooth">smooth</code></td>
<td>
<p>Smoothing parameter passed to <a href="#topic+getMultipleBPC">getMultipleBPC</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will evaluate candidate mz pairs found within an 'xcmsSet'
object or any peak list by <a href="#topic+EvaluatePairsFromXCMSSet">EvaluatePairsFromXCMSSet</a> against the raw
measurement data.
This step is required to minimize redundancy and false positive results. It
will allow to generate a number of informative quality control plots. As
quite some input data is required for this function, please have a look in
the vignette for an example.
A special parameter in this function is &lsquo;rolp' which can be set to &rsquo;non',
'pos', 'neg' or 'all'. It will influence the time performance of the function
by determining how many peaks are effectively tested. If 'rolp' is set to
'non', no overlapping peaks will be skipped, every individual mz-pair will
be sequentially evaluated (slow but most informative). If it is set to 'pos'
or 'neg', overlapping peaks (determined by experiment wide deconvolution)
will not be tested additionally for positive or negative hits ('neg' is
standard). If set to 'all' overlapping peaks will always be removed from
the list of mz-pairs to be tested (fast).
</p>


<h3>Value</h3>

<p>A list of evaluation results.
</p>

<hr>
<h2 id='EvaluatePairsFromXCMSSet'>Identify and evaluate mz pairs from a peak list.</h2><span id='topic+EvaluatePairsFromXCMSSet'></span>

<h3>Description</h3>

<p><code>EvaluatePairsFromXCMSSet</code> will analyze an 'xcmsSet' result
or a generic peak list from a mass spectrometry experiment for mass
pairs (mz1, mz2) with changes due to any tracer incorporation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EvaluatePairsFromXCMSSet(
  xg = NULL,
  tp = NULL,
  gr = NULL,
  drt = 1,
  dmz = 0.025,
  mz_iso = 1.00335,
  n = 6,
  method = c("APCI", "ESI")[1],
  specific_row = NULL,
  testing = FALSE,
  silent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_xg">xg</code></td>
<td>
<p>xcmsSet object with group information. Alternatively, can be a numeric
matrix containing 'mz' and 'rt' information in the first two columns
followed by peak intensities of all samples in the same order as in
parameters 'tp' and 'gr'.</p>
</td></tr>
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_tp">tp</code></td>
<td>
<p>Time point information for all samples (obviously required,
internally converted to factor).</p>
</td></tr>
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_gr">gr</code></td>
<td>
<p>Group information for all samples, e.g. different genotypes or
concentrations (optional, factor).</p>
</td></tr>
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_drt">drt</code></td>
<td>
<p>Allowed rt deviation in time units of xcmsSet (usually seconds) to
test for candidates.</p>
</td></tr>
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_dmz">dmz</code></td>
<td>
<p>Allowed mass deviation in Da.</p>
</td></tr>
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_mz_iso">mz_iso</code></td>
<td>
<p>Mass defect of the isotope under investigation (use 1.00335 for ^13^C experiments.</p>
</td></tr>
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_n">n</code></td>
<td>
<p>Number of maximal incorporated carbons to test.</p>
</td></tr>
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_method">method</code></td>
<td>
<p>Currently APCI or ESI. If APCI, dmz will be modified depending
on n (see details).</p>
</td></tr>
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_specific_row">specific_row</code></td>
<td>
<p>A single row of the peak list to process.</p>
</td></tr>
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_testing">testing</code></td>
<td>
<p>Stop in function using browser() if specific_row is specified;
can be a isotope number, i.e. 3 will stop at third isotope.</p>
</td></tr>
<tr><td><code id="EvaluatePairsFromXCMSSet_+3A_silent">silent</code></td>
<td>
<p>Suppress warnings and console output if TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using 'APCI' as method assumes that (i) you analyze TMS-derivatized
compounds and (ii) your MS resolution does not allow to separate Si and C
isotopes but reports an intermediate mass as m/z. In this case you will
find carbon isotopes below there expected masses, i.e. M+1 would be
1.001 mDa apart from M+0 instead of 1.003.
The effect is increased with isotope number, i.e. M+6 will be ~20 mDa
below the expected value. Hence, selecting method 'APCI' will combine your
selected dmz with a allowed deviation due to mass shifts caused by Si
isotopes. Use 'ESI' if you are not sure if this effect takes place in your
settings.
</p>


<h3>Value</h3>

<p>A dataframe with all observable pairs within the provided xg object
(usually an 'xcmsSet' peak) list including mean group intensities and P values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The example measurement data provided with HiResTEC contain a peak at 1026s
raw &lt;- HiResTEC::raw
sam &lt;- HiResTEC::sam
mz &lt;- c(556.26, 561.26, 564.26)

# extract the peak intensities for 3 m/z of this peak
int &lt;- sapply(raw, function(x) {
  tmp &lt;- getMultipleBPC(x = x, mz = mz, mz_dev = 0.04, rt = 1026)
  tmp[attr(tmp, "maxBPC"),]
})
colnames(int) &lt;- sam$ID; rownames(int) &lt;- NULL
xg &lt;- data.frame(
 "mz" = mz,
 "rt" = rep(1026.5, 3),
 int
)

# evaluate this peak list for interesting pairs
EvaluatePairsFromXCMSSet(xg=xg, tp=sam$TP, gr=sam$Group, silent=TRUE, n=8)

</code></pre>

<hr>
<h2 id='GenerateCandXLSX'>Generate a table for the candidates obtained in <a href="#topic+EvaluateCandidateListAgainstRawData">EvaluateCandidateListAgainstRawData</a>.</h2><span id='topic+GenerateCandXLSX'></span>

<h3>Description</h3>

<p><code>GenerateCandXLSX</code> will produce a XLSX of a list containing
test results objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateCandXLSX(res_list = NULL, xlsx_file = NULL, rejected = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GenerateCandXLSX_+3A_res_list">res_list</code></td>
<td>
<p>A list of result objects (each testing an individual mz pair).</p>
</td></tr>
<tr><td><code id="GenerateCandXLSX_+3A_xlsx_file">xlsx_file</code></td>
<td>
<p>File name.</p>
</td></tr>
<tr><td><code id="GenerateCandXLSX_+3A_rejected">rejected</code></td>
<td>
<p>Logical. Prepare table of rejected candidates if TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Just a wrapper, to get the important information in a tabular layout.
</p>


<h3>Value</h3>

<p>Candidate table as data.frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load evaluation result of example data and
# generate table within R (use parameter xlsx_file to write to file)
x &lt;- GenerateCandXLSX(HiResTEC::res_list)
str(x)
x[,1:5]

</code></pre>

<hr>
<h2 id='GenerateQCPlots'>Generate quality control plots for mz pair candidates.</h2><span id='topic+GenerateQCPlots'></span>

<h3>Description</h3>

<p><code>GenerateQCPlots</code> will produce QC plots for a list
containing test results objects (generated by <a href="#topic+EvaluateCandidateListAgainstRawData">EvaluateCandidateListAgainstRawData</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateQCPlots(
  res_list = NULL,
  pdf_file = NULL,
  mfrow = NULL,
  skip_plots = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GenerateQCPlots_+3A_res_list">res_list</code></td>
<td>
<p>A list of result objects (each testing an individual mz pair).</p>
</td></tr>
<tr><td><code id="GenerateQCPlots_+3A_pdf_file">pdf_file</code></td>
<td>
<p>The path to a writable file.</p>
</td></tr>
<tr><td><code id="GenerateQCPlots_+3A_mfrow">mfrow</code></td>
<td>
<p>If NULL automatically determined, otherwise useful to specify a layout.</p>
</td></tr>
<tr><td><code id="GenerateQCPlots_+3A_skip_plots">skip_plots</code></td>
<td>
<p>NULL or numeric vector in which case plots with numbers in skip_plots will be empty.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you provide a single candidate (list of length = 1) an output to
a screen plotting device is reasonable, otherwise a target PDF file should
be specified in parameter 'pdf_file'.
</p>


<h3>Value</h3>

<p>Figure output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  # load evaluation result of example data
  data(res_list)
  # generate Figures on screen (use PDF output for multiple candidates)
  GenerateQCPlots(res_list[1])

## End(Not run)

</code></pre>

<hr>
<h2 id='getMultipleBPC'>Extract multiple ion chromatograms from mass spectrometry data.</h2><span id='topic+getMultipleBPC'></span>

<h3>Description</h3>

<p><code>getMultipleBPC</code> will extract multiple BPCs from an 'xcmsRaw'
or 'xcmsRawLike' object for a vector of mz within the limits given by rt,
rt_dev and mz_dev.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMultipleBPC(
  x,
  mz = NULL,
  mz_dev = 0.005,
  rt = NULL,
  rt_dev = 2,
  zeroVal = NA,
  smooth = 0,
  returnEIC = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getMultipleBPC_+3A_x">x</code></td>
<td>
<p>'xcmsRaw' or 'xcmsRawLike' object.</p>
</td></tr>
<tr><td><code id="getMultipleBPC_+3A_mz">mz</code></td>
<td>
<p>Numeric vector of masses or NULL (default) to return the overall BPC.</p>
</td></tr>
<tr><td><code id="getMultipleBPC_+3A_mz_dev">mz_dev</code></td>
<td>
<p>Allowed mass deviations (can be a single numeric, a vector, a matrix
with one row (lower bound, upper bound) or a matrix with <code>length(mz)</code> rows
giving lower and upper bound for each mz).</p>
</td></tr>
<tr><td><code id="getMultipleBPC_+3A_rt">rt</code></td>
<td>
<p>Target retention time or NULL (default) to use full time range.</p>
</td></tr>
<tr><td><code id="getMultipleBPC_+3A_rt_dev">rt_dev</code></td>
<td>
<p>Allowed time deviation (if rt is specified).</p>
</td></tr>
<tr><td><code id="getMultipleBPC_+3A_zeroval">zeroVal</code></td>
<td>
<p>Set values &lt;=0 to NA or keep as is with NULL.</p>
</td></tr>
<tr><td><code id="getMultipleBPC_+3A_smooth">smooth</code></td>
<td>
<p>Window size for moving average smoother, 0 = no smoothing.</p>
</td></tr>
<tr><td><code id="getMultipleBPC_+3A_returneic">returnEIC</code></td>
<td>
<p>Return EIC instead of BPC?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>While there are other functions to extract BPC information from raw data,
this one is particularly useful to get all traces belonging to a isotopologue
group. It will attach several derived values to the results object,
i.e. describing the observed mass shift (deviation from expected value) which
is helpful in QC for non-targeted tracer analyses.
While the 'mz' and 'mz_dev' parameters  can be vectorized, the 'rt' and
'rt_dev' values will be consistently used for all ion traces.
</p>


<h3>Value</h3>

<p>A matrix with scan wise (rows) intensities for all requested masses (columns)
as either EIC or BPC.
</p>


<h3>References</h3>

<p>Uses C code modified from XCMS (see <code>citation("xcms")</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>raw &lt;- HiResTEC::raw
# search for mz = 556.263 and its isotopic traces
mz &lt;- 556.263 + c(0:3) * 1.0034
getMultipleBPC(x = raw[[1]], mz = mz, mz_dev = 0.04, rt = 1026)

</code></pre>

<hr>
<h2 id='plotBPC'>Plot base peak chromatograms for multiple high resolution masses in multiple samples.</h2><span id='topic+plotBPC'></span>

<h3>Description</h3>

<p><code>plotBPC</code> will plot for each item of a list of result-objects
from <a href="#topic+getMultipleBPC">getMultipleBPC</a> the BPC traces and the spectrum at the scan
where the summed intensity of all ions is max.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBPC(
  bpc = NULL,
  mfrow = NULL,
  skip_plots = NULL,
  ylim = NULL,
  col = NULL,
  ids = NULL,
  type = "both",
  ann = c("mdev", "mz", "none")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotBPC_+3A_bpc">bpc</code></td>
<td>
<p>A bpc object (list of intensity matrices, rt x mz, including several attributes as attached by <a href="#topic+getMultipleBPC">getMultipleBPC</a>).</p>
</td></tr>
<tr><td><code id="plotBPC_+3A_mfrow">mfrow</code></td>
<td>
<p>Specify mfrow explicitly (is optimized internally if NULL to cover n=length(bpc)).</p>
</td></tr>
<tr><td><code id="plotBPC_+3A_skip_plots">skip_plots</code></td>
<td>
<p>Allows to block certain subplots in the mfrow matrix to better align replicates.</p>
</td></tr>
<tr><td><code id="plotBPC_+3A_ylim">ylim</code></td>
<td>
<p>Can be specified specifically, will be adjusted to overall min/max otherwise.</p>
</td></tr>
<tr><td><code id="plotBPC_+3A_col">col</code></td>
<td>
<p>Specific color vector for masses may be provided.</p>
</td></tr>
<tr><td><code id="plotBPC_+3A_ids">ids</code></td>
<td>
<p>Specific plot ids may be explicitly provided.</p>
</td></tr>
<tr><td><code id="plotBPC_+3A_type">type</code></td>
<td>
<p>Switch between co-plot of BPC and Spectrum (&quot;both&quot;) or BPC alone (&quot;bpc&quot;).</p>
</td></tr>
<tr><td><code id="plotBPC_+3A_ann">ann</code></td>
<td>
<p>Select value to annotate peaks in spectrum. Usually the mass deviation from the expected value in mDa.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plotBPC</code> allows to get a quick overview of similar information
from all samples of an experimental set. As it uses 'mfrow' to arrange samples
its output can not be used as subplot in other figures.
</p>


<h3>Value</h3>

<p>A plot to the graphics device and NULL as invisible.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load example raw data
bpc &lt;- HiResTEC::res_list[[1]][["bpc"]][c(1:2, 13:14)]
plotBPC(bpc = bpc)
plotBPC(bpc = bpc, ann="mz", ids=LETTERS[1:4], mfrow=c(3,2), skip_plots=c(2,3))

</code></pre>

<hr>
<h2 id='plotMID'>Plot a Mass Isotopomer Distribution (MID) for multiple samples.</h2><span id='topic+plotMID'></span>

<h3>Description</h3>

<p><code>plotMID</code> will plot Mass Isotopomer Distributions (MIDs).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMID(
  mid = NULL,
  gr = NULL,
  name = "unknown",
  contr = NULL,
  stackedbars = FALSE,
  subplot_ylim = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotMID_+3A_mid">mid</code></td>
<td>
<p>Matrix of corrected MIDs. Samples in columns, MID values in rows.</p>
</td></tr>
<tr><td><code id="plotMID_+3A_gr">gr</code></td>
<td>
<p>Groups, a factor vector of length ncol(mid).</p>
</td></tr>
<tr><td><code id="plotMID_+3A_name">name</code></td>
<td>
<p>Name of analyte for annotation.</p>
</td></tr>
<tr><td><code id="plotMID_+3A_contr">contr</code></td>
<td>
<p>Contrasts. Not yet clear if useful.</p>
</td></tr>
<tr><td><code id="plotMID_+3A_stackedbars">stackedbars</code></td>
<td>
<p>Alternative plotting layout using stacked bar plot.</p>
</td></tr>
<tr><td><code id="plotMID_+3A_subplot_ylim">subplot_ylim</code></td>
<td>
<p>Calculate 'ylim' individually per subplot if 0, show
full range in all subplots if 100 and limit to the minimal specified
number otherwise.</p>
</td></tr>
<tr><td><code id="plotMID_+3A_...">...</code></td>
<td>
<p>Further arguments to 'boxplot' or 'barplot' (depending on
parameter 'stackedbars').</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple styling options are available using the function parameters.
</p>


<h3>Value</h3>

<p>An annotated barplot or boxplot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mid &lt;- matrix(c(seq(0, 0.3, 0.1), seq(1, 0.7, -0.1)), byrow = TRUE, nrow = 2)
gr &lt;- gl(2, 2, labels = letters[1:2])
plotMID(mid = mid, gr = gr, name = "Metabolite X")
plotMID(mid = mid, gr = gr, stackedbars = TRUE, las = 1, xlab = "MID")
lt &lt;- paste0("M", 0:1)
rownames(mid) &lt;- lt
plotMID(mid = mid, gr = gr, stackedbars = TRUE, xlab = "MID", legend.text = lt)
plotMID(mid = mid[, 2, drop = FALSE], stackedbars = TRUE, col = c(3, 4))
colnames(mid) &lt;- paste0("S", 1:4)
gr2 &lt;- gl(n = 1, k = 1, labels = "bla")
plotMID(mid = mid[, 2, drop = FALSE], gr = gr2, stackedbars = TRUE, name = NULL)
plotMID(mid = mid, gr = factor(colnames(mid)), stackedbars = TRUE, name = NULL)

</code></pre>

<hr>
<h2 id='raw'>Different example data files to be used in the help section of 'HiResTEC' functions.</h2><span id='topic+raw'></span><span id='topic+sam'></span><span id='topic+xcms_cand'></span><span id='topic+res_list'></span><span id='topic+mz_shift_corrector'></span>

<h3>Description</h3>

<p>'raw' contains a list of 'xcmsRawLike' objects, each containing a selected mass range for a small retention time window of 18 samples defined in sam.
</p>
<p>'sam' provides a data frame containing the sample definition of 18 samples from a larger experiment.
</p>
<p>'xcms_cand' contains a data frame with the analysis result of an 'xcmsSet' obtained using <a href="#topic+EvaluatePairsFromXCMSSet">EvaluatePairsFromXCMSSet</a>.
</p>
<p>'res_list' is a list containing the evaluations results established based on processing example data with <a href="#topic+EvaluateCandidateListAgainstRawData">EvaluateCandidateListAgainstRawData</a>.
</p>
<p>'mz_shift_corrector' contains a list defining windows for high res APCI or ESI instrumentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(raw)

data(sam)

data(xcms_cand)

data(res_list)

data(mz_shift_corrector)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 18.
</p>
<p>An object of class <code>data.frame</code> with 18 rows and 8 columns.
</p>
<p>An object of class <code>data.frame</code> with 72 rows and 19 columns.
</p>
<p>An object of class <code>list</code> of length 14.
</p>
<p>An object of class <code>list</code> of length 3.
</p>


<h3>Source</h3>

<p>jan.lisec@bam.de
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
