<!DOCTYPE html><html><head><title>Help for package LongCART</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LongCART}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ACTG175'>
<p>Converted AIDS Clinical Trials Group Study 175 (source: speff2trial package)</p></a></li>
<li><a href='#GBSG2'>
<p>German Breast Cancer Study Group 2 (source: TH.data package)</p></a></li>
<li><a href='#KMPlot'>
<p>KM plot for SurvCART object</p></a></li>
<li><a href='#LongCART'><p>Longitudinal CART with continuous response via binary partitioning</p></a></li>
<li><a href='#plot'><p>Plot an SurvCART or LongCART Object</p></a></li>
<li><a href='#PoS'>
<p>Probability of trial ans clinical success for a prospective trial using normal-normal approximation</p></a></li>
<li><a href='#predict'><p>Predicts according to the fitted SurvCART or LongCART tree</p></a></li>
<li><a href='#ProfilePlot'>
<p>Population level longitudinal profile plot for sub-groups</p></a></li>
<li><a href='#StabCat '><p>parameter stability test for categorical partitioning variable</p></a></li>
<li><a href='#StabCat.surv '><p>parameter stability test for categorical partitioning variable</p></a></li>
<li><a href='#StabCont '><p>parameter stability test for continuous partitioning variable</p></a></li>
<li><a href='#StabCont.surv '><p>parameter stability test for continuous partitioning variable</p></a></li>
<li><a href='#succ_ia'>
<p>Conditional power and predictive power of success based on interim results using normal-normal approximation</p></a></li>
<li><a href='#succ_ia_betabinom_one'>
<p>Determines predictive power of success based on interim results and beta prior for one-sample binary data</p></a></li>
<li><a href='#succ_ia_betabinom_two'>
<p>Determines predictive power of success based on interim results and beta priors for two-sample binary data</p></a></li>
<li><a href='#SurvCART'><p>Survival CART with time to event response via binary partitioning</p></a></li>
<li><a href='#text'><p>Place text on SurvCART or LongCART tree</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Recursive Partitioning for Longitudinal Data and Right Censored
Data Using Baseline Covariates</td>
</tr>
<tr>
<td>Version:</td>
<td>3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-17</td>
</tr>
<tr>
<td>Author:</td>
<td>Madan G Kundu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Madan G Kundu &lt;madan_g.kundu@yahoo.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), nlme, rpart, survival, magic, survminer</td>
</tr>
<tr>
<td>Imports:</td>
<td>Formula</td>
</tr>
<tr>
<td>Description:</td>
<td>Constructs tree for continuous longitudinal data and survival data using baseline covariates as partitioning variables according to the 'LongCART' and 'SurvCART' algorithm, respectively. Later also included functions to calculate conditional power and predictive power of success based on interim results and probability of success for a prospective trial.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/madanstat/LongCART/issues">https://github.com/madanstat/LongCART/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-17 19:01:31 UTC; madan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-17 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ACTG175'>
Converted AIDS Clinical Trials Group Study 175 (source: speff2trial package)</h2><span id='topic+ACTG175'></span>

<h3>Description</h3>

<p>ACTG 175 was a randomized clinical trial to compare monotherapy with zidovudine or didanosine with combination therapy with zidovudine and didanosine or zidovudine and zalcitabine in adults infected with the human immunodeficiency virus type I whose CD4 T cell counts were between 200 and 500 per cubic millimeter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ACTG175)
</code></pre>


<h3>Format</h3>

<p>A data frame with 6417 observations from 2139 patients on the following 24 variables.
</p>

<dl>
<dt>pidnum</dt><dd><p>patient ID number</p>
</dd>
<dt>age</dt><dd><p>age in years at baseline</p>
</dd>
<dt>wtkg</dt><dd><p>weight in kg at baseline</p>
</dd>
<dt>hemo</dt><dd><p>hemophilia (0=no, 1=yes)</p>
</dd>
<dt>homo</dt><dd><p>homosexual activity (0=no, 1=yes)</p>
</dd>
<dt>drugs</dt><dd><p>history of intravenous drug use (0=no, 1=yes)</p>
</dd>
<dt>karnof</dt><dd><p>Karnofsky score (on a scale of 0-100)</p>
</dd>
<dt>oprior</dt><dd><p>non-zidovudine antiretroviral therapy prior to initiation of study treatment (0=no, 1=yes)</p>
</dd>
<dt>z30</dt><dd><p>zidovudine use in the 30 days prior to treatment initiation (0=no, 1=yes)</p>
</dd>
<dt>zprior</dt><dd><p>zidovudine use prior to treatment initiation (0=no, 1=yes)</p>
</dd>
<dt>preanti</dt><dd><p>number of days of previously received antiretroviral therapy</p>
</dd>
<dt>race</dt><dd><p>race (0=white, 1=non-white)</p>
</dd>
<dt>gender</dt><dd><p>gender (0=female, 1=male)</p>
</dd>
<dt>str2</dt><dd><p>antiretroviral history (0=naive, 1=experienced)</p>
</dd>
<dt>strat</dt><dd><p>antiretroviral history stratification (1:antiretroviral naive, 2:greater than 1 but less than 52 weeks of prior antiretroviral therapy, 3: greater than 52 weeks)</p>
</dd>
<dt>symptom</dt><dd><p>symptomatic indicator (0=asymptomatic, 1=symptomatic)</p>
</dd>
<dt>treat</dt><dd><p>treatment indicator (0=zidovudine only, 1=other therapies)</p>
</dd>
<dt>offtrt</dt><dd><p>indicator of off-treatment before 96 weeks (0=no,1=yes)</p>
</dd>
<dt>r</dt><dd><p>missing CD4 T cell count at 96 weeks (0=missing, 1=observed)</p>
</dd>
<dt>cens</dt><dd><p>indicator of observing the event in days</p>
</dd>
<dt>days</dt><dd><p>number of days until the first occurrence of: (i) a decline in CD4 T cell count of at least 50 (ii) an event indicating progression to AIDS, or (iii) death.</p>
</dd>
<dt>arms</dt><dd><p>treatment arm (0=zidovudine, 1=zidovudine and didanosine, 2=zidovudine and zalcitabine, 3=didanosine)</p>
</dd>
<dt>time</dt><dd><p>time in weeks</p>
</dd>
<dt>cd4</dt><dd><p>CD4 T cell count</p>
</dd>
</dl>



<h3>References</h3>

<p>Hammer, S.M., et al. (1996), A trial comparing nucleoside monotherapy with combination therapy in HIV-infected adults with CD4 cell counts from 200 to 500 per cubic millimeter. New England Journal of Medicine, 335:1081-1090.
</p>

<hr>
<h2 id='GBSG2'>
German Breast Cancer Study Group 2 (source: TH.data package)
</h2><span id='topic+GBSG2'></span>

<h3>Description</h3>

<p>A data frame containing the observations from the GBSG2 study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GBSG2)</code></pre>


<h3>Format</h3>

<p>A data frame with 686 observations on the following 10 variables.
</p>

<dl>
<dt><code>horTh</code></dt><dd><p>hormonal therapy, a factor with levels <code>no</code> <code>yes</code></p>
</dd>
<dt><code>age</code></dt><dd><p>age in years</p>
</dd>
<dt><code>menostat</code></dt><dd><p>menopausal status, a factor with levels <code>Pre</code> <code>Post</code></p>
</dd>
<dt><code>tsize</code></dt><dd><p>tumor size (in mm)</p>
</dd>
<dt><code>tgrade</code></dt><dd><p>an ordered factor with levels <code>I</code> &lt; <code>II</code> &lt; <code>III</code></p>
</dd>
<dt><code>pnodes</code></dt><dd><p>number of positive nodes</p>
</dd>
<dt><code>progrec</code></dt><dd><p>progesterone receptor (in fmol).</p>
</dd>
<dt><code>estrec</code></dt><dd><p>estrogen receptor (in fmol).</p>
</dd>
<dt><code>time</code></dt><dd><p>recurrence free survival time (in days).</p>
</dd>
<dt><code>cens</code></dt><dd><p>censoring indicator (0- censored, 1- event).</p>
</dd>
</dl>



<h3>References</h3>

<p>Schumacher M, Bastert G, Bojar H, Huebner K, Olschewski M, Sauerbrei W, Schmoor C, Beyerle C, Neumann RL, Rauschecker HF. Randomized 2 x 2 trial evaluating hormonal treatment and the duration of chemotherapy in node-positive breast cancer patients. German Breast Cancer Study Group. Journal of Clinical Oncology. 1994 Oct;12(10):2086-93.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GBSG2)
</code></pre>

<hr>
<h2 id='KMPlot'>
KM plot for SurvCART object
</h2><span id='topic+KMPlot'></span>

<h3>Description</h3>

<p>Generates KM plot for sub-groups (i.e., terminal nodes) associated with survival tree generated by SurvCART()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KMPlot(x, type = 1, overlay=TRUE, conf.type="log-log", mfrow=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KMPlot_+3A_x">x</code></td>
<td>
<p>a fitted object of class <code>"SurvCART"</code>, containing a survival tree.</p>
</td></tr>
<tr><td><code id="KMPlot_+3A_type">type</code></td>
<td>
<p>1 for KM plot of survival probabilities, 2 for KM plot of censoring probabilities</p>
</td></tr>
<tr><td><code id="KMPlot_+3A_overlay">overlay</code></td>
<td>
<p>Logical inputs (<code>TRUE</code> or <code>FALSE</code>) whether the KM plots for different subgroups will be overlaid in the same plot or separate plots to be generated</p>
</td></tr>
<tr><td><code id="KMPlot_+3A_conf.type">conf.type</code></td>
<td>
<p>One of <code>none</code>, <code>plain</code>, <code>log</code>, or <code>log-log</code>. The first option causes confidence intervals not to be generated. This  input is ignored when <code>overlay=TRUE</code>.</p>
</td></tr>
<tr><td><code id="KMPlot_+3A_mfrow">mfrow</code></td>
<td>
<p>Desired frame for fitting multiple plots. Default option is to include plots for all subgroups in the same frame. This  input is ignored when <code>overlay=TRUE</code>.</p>
</td></tr>
<tr><td><code id="KMPlot_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from other methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Ghosh, S. (2021). Survival trees based on heterogeneity in time-to-event and censoring distributions using parameter instability test. Statistical Analysis and Data Mining: The ASA Data Science Journal, 14(5), 466-483.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+text">text</a></code>, <code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+SurvCART">SurvCART</a></code>, <code><a href="#topic+StabCat.surv">StabCat.surv</a></code>, <code><a href="#topic+StabCont.surv">StabCont.surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#--- Get the data
data(GBSG2)

#numeric coding of character variables
GBSG2$horTh1&lt;- as.numeric(GBSG2$horTh)
GBSG2$tgrade1&lt;- as.numeric(GBSG2$tgrade)
GBSG2$menostat1&lt;- as.numeric(GBSG2$menostat)

#Add subject id
GBSG2$subjid&lt;- 1:nrow(GBSG2)

#--- Run SurvCART() with time-to-event distribution: exponential, censoring distribution: None  
out&lt;- SurvCART(data=GBSG2, patid="subjid", censorvar="cens", timevar="time", 
        gvars=c('horTh1', 'age', 'menostat1', 'tsize', 'tgrade1', 'pnodes', 'progrec', 'estrec'),  
        tgvars=c(0,1,0,1,0,1, 1,1),          
        event.ind=1,  alpha=0.05, minsplit=80, minbucket=40, print=TRUE)

#--- Plot tree
par(xpd = TRUE)
plot(out, compress = TRUE)
text(out, use.n = TRUE)

#Plot KM plot of survival probabilities for sub-groups identified by tree
KMPlot(out, xscale=365.25, type=1)
KMPlot(out, xscale=365.25, type=1, overlay=FALSE, mfrow=c(2,2), xlab="Year", ylab="Survival prob.")

#Plot KM plot of censoring probabilities for sub-groups identified by tree
KMPlot(out, xscale=365.25, type=2)
KMPlot(out, xscale=365.25, type=2, overlay=FALSE, mfrow=c(2,2), xlab="Year", ylab="Censoring prob.")

</code></pre>

<hr>
<h2 id='LongCART'>Longitudinal CART with continuous response via binary partitioning</h2><span id='topic+LongCART'></span>

<h3>Description</h3>

<p>Recursive partitioning for linear mixed effects model with continuous
univariate response variables per LonCART algorithm based on baseline partitioning
variables (Kundu and Harezlak, 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LongCART(data, patid, fixed, gvars, tgvars, minsplit=40,
         minbucket=20, alpha=0.05, coef.digits=2, print.lme=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LongCART_+3A_data">data</code></td>
<td>
<p>name of the dataset. It must contain variable specified for <code>patid</code> (indicating subject id), all the variables specified in the formula and the baseline partitioning variables.</p>
</td></tr>
<tr><td><code id="LongCART_+3A_patid">patid</code></td>
<td>
<p>name of the subject id variable.</p>
</td></tr>
<tr><td><code id="LongCART_+3A_fixed">fixed</code></td>
<td>
<p>a two-sided linear formula object describing the fixed-effects part of the model, with the response on the left of a <code>~ </code>operator and the terms, separated by <code>+</code> operators, on the right. Model with <code>-1</code> to the end of right side indicates no intercept. For model with no fixed effect beyond intercept, please specify only <code>1</code> right to the <code>~</code> operator.</p>
</td></tr>
<tr><td><code id="LongCART_+3A_gvars">gvars</code></td>
<td>
<p>list of partitioning variables of interest. Value of these variables should not change over time. Regarding categorical variables, only numerically coded categorical variables should be specified. For nominal categorical variables or factors, please first create corresponding dummy variable(s) and then pass through <code>gvars</code>. </p>
</td></tr>
<tr><td><code id="LongCART_+3A_tgvars">tgvars</code></td>
<td>
<p>types (categorical or continuous) of partitioning variables specified in <code>gvar</code>. For each of continuous partitioning variables, specify <code>1</code> and for each of the categorical partitioning variables, specify <code>0</code>. Length of <code>tgvars</code> should match to the length of <code>gvars</code></p>
</td></tr>
<tr><td><code id="LongCART_+3A_minsplit">minsplit</code></td>
<td>
<p>the minimum number of observations that must exist in a node in order for a split to be attempted.</p>
</td></tr>
<tr><td><code id="LongCART_+3A_minbucket">minbucket</code></td>
<td>
<p>he minimum number of observations in any terminal node.</p>
</td></tr>
<tr><td><code id="LongCART_+3A_alpha">alpha</code></td>
<td>
<p>alpha (i.e., nominal type I error) level for parameter instability test</p>
</td></tr>
<tr><td><code id="LongCART_+3A_coef.digits">coef.digits</code></td>
<td>
<p>decimal points for displaying coefficients in the tree  structure.</p>
</td></tr>
<tr><td><code id="LongCART_+3A_print.lme">print.lme</code></td>
<td>
<p>if <code>TRUE</code>, then summary of fitte model from <code>lme()</code> will be printed for each node.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Construct regression tree based on heterogeneity in linear mixed effects models of following type:
<code>Y_i(t)= W_i(t)theta + b_i + epsilon_{it}</code>
where <code>W_i(t)</code> is the design matrix, <code>theta</code> is the parameter associated with <code>W_i(t)</code> and <code>b_i</code> is the random intercept.
Also, <code>epsilon_{it} ~  N(0,sigma ^2)</code> and <code>b_i ~ N(0, sigma_u^2)</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Treeout</code></td>
<td>
<p>contains summary information of tree fitting for each terminal nodes and non-terminal nodes. Columns of <code>Treeout</code> include &quot;ID&quot;, the (unique) node numbers that follow a binary ordering indexed by node depth, <code>n</code>, the number of observations reaching the node, <code>yval</code>, the fitted model of the response at the node, var, a factor giving the names of the variables used in the split at each, <code>index</code>, the cut-off value of splitting variable for binary partitioning, <code>p (Instability)</code>, the p-value for parameter instability test for the splitting variable, <code>loglik</code>, the log-likelihood of the node, <code>improve</code>,  the improvement in deviance given by this split, and <code>Terminal</code>,  indicator (True or False) of terminal node.  </p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>number of fixed parameters</p>
</td></tr>
<tr><td><code>AIC.tree</code></td>
<td>
<p>AIC of the tree-structured model</p>
</td></tr>
<tr><td><code>AIC.root</code></td>
<td>
<p>AIC at the root node (i.e., without tree structure)</p>
</td></tr>
<tr><td><code>improve.AIC</code></td>
<td>
<p>improvement in AIC due to tree structure (AIC.tree - AIC.root)</p>
</td></tr>
<tr><td><code>logLik.tree</code></td>
<td>
<p>log-likelihood of the tree-structured model</p>
</td></tr>
<tr><td><code>logLik.root</code></td>
<td>
<p>log-likelihood at the root node (i.e., without tree structure) </p>
</td></tr>
<tr><td><code>Deviance</code></td>
<td>
<p>2*(logLik.tree-logLik.root)</p>
</td></tr>
<tr><td><code>LRT.df</code></td>
<td>
<p>degrees of freedom for likelihood ratio test comparing tree-structured model with the model at root node.</p>
</td></tr>
<tr><td><code>LRT.p</code></td>
<td>
<p>p-value for likelihood ratio test comparing tree-structured model with the model at root node.</p>
</td></tr>
<tr><td><code>nodelab</code></td>
<td>
<p>List of subgroups or terminal nodes with their description</p>
</td></tr>
<tr><td><code>varnam</code></td>
<td>
<p>List of splitting variables</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the dataset originally supplied</p>
</td></tr>
<tr><td><code>patid</code></td>
<td>
<p>the patid variable originally supplied</p>
</td></tr>
<tr><td><code>fixed</code></td>
<td>
<p>the fixed part of the model originally supplied</p>
</td></tr>
<tr><td><code>frame</code></td>
<td>
<p>rpart compatible object</p>
</td></tr>
<tr><td><code>splits</code></td>
<td>
<p>rpart compatible object</p>
</td></tr>
<tr><td><code>cptable</code></td>
<td>
<p>rpart compatible object</p>
</td></tr>
<tr><td><code>functions</code></td>
<td>
<p>rpart compatible object</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Harezlak, J. (2019). Regression trees for longitudinal data with baseline covariates. Biostatistics &amp; Epidemiology, 3(1):1-22.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+text">text</a></code>, <code><a href="#topic+ProfilePlot">ProfilePlot</a></code>, <code><a href="#topic+StabCat">StabCat</a></code>, <code><a href="#topic+StabCont">StabCont</a></code>, <code><a href="#topic+predict">predict</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#--- Get the data
data(ACTG175)

#-----------------------------------------------#
#   model: cd4~ time + subject(random)          #
#-----------------------------------------------#

#--- Run LongCART()  
gvars=c("gender", "wtkg", "hemo", "homo", "drugs",
        "karnof", "oprior", "z30", "zprior", "race",
        "str2", "symptom", "treat", "offtrt")
tgvars=c(0, 1, 0, 0, 0,
         1, 0, 0, 0, 0,
         0, 0, 0, 0)


out1&lt;- LongCART(data=ACTG175, patid="pidnum", fixed=cd4~time,
                gvars=gvars, tgvars=tgvars, alpha=0.05,
                minsplit=100, minbucket=50, coef.digits=2)

#--- Plot tree
par(mfrow=c(1,1))
par(xpd = TRUE)
plot(out1, compress = TRUE)
text(out1, use.n = TRUE)

#--- Plot longitudinal profiles of subgroups
ProfilePlot(x=out1, timevar="time")

#-----------------------------------------------#
#   model: cd4~ time+ time^2 + subject(random)  #
#-----------------------------------------------#

ACTG175$time2&lt;- ACTG175$time^2

out2&lt;- LongCART(data=ACTG175, patid="pidnum", fixed=cd4~time + time2,
                gvars=gvars, tgvars=tgvars, alpha=0.05,
                minsplit=100, minbucket=50, coef.digits=2)


par(mfrow=c(1,1))
par(xpd = TRUE)
plot(out2, compress = TRUE)
text(out2, use.n = TRUE)

ProfilePlot(x=out2, timevar="time", timevar.power=c(1,2))


#--------------------------------------------------------#
#   model: cd4~ time+ time^2 + subject(random) + karnof  #
#--------------------------------------------------------#

out3&lt;- LongCART(data=ACTG175, patid="pidnum", fixed=cd4~time + time2 + karnof,
                gvars=gvars, tgvars=tgvars, alpha=0.05,
                minsplit=100, minbucket=50, coef.digits=2)


par(mfrow=c(1,1))
par(xpd = TRUE)
plot(out3, compress = TRUE)
text(out3, use.n = TRUE)

#the value of the covariate karnof is set at median by default
ProfilePlot(x=out3, timevar="time", timevar.power=c(1,2, NA)) 

#the value of the covariate karnof is set at 120
ProfilePlot(x=out3, timevar="time", timevar.power=c(1,2, NA), 
                     covariate.val=c(NA, NA, 120)) 


</code></pre>

<hr>
<h2 id='plot'>Plot an SurvCART or LongCART Object</h2><span id='topic+plot'></span><span id='topic+plot.SurvCART'></span><span id='topic+plot.LongCART'></span>

<h3>Description</h3>

<p>Plots an SurvCART or LongCART object on the current graphics device.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SurvCART'
plot(x, uniform = FALSE, branch = 1, compress = FALSE, 
              nspace = branch, margin = 0, minbranch = 0.3, ...)
## S3 method for class 'LongCART'
plot(x, uniform = FALSE, branch = 1, compress = FALSE, 
              nspace = branch, margin = 0, minbranch = 0.3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>a fitted object of class <code>"SurvCART"</code>, containing a survival tree or <code>"LongCART"</code>, containing a longitudinal tree.</p>
</td></tr>
<tr><td><code id="plot_+3A_uniform">uniform</code></td>
<td>
<p>similar to <code>plot.rpart</code>; if TRUE, uniform vertical spacing
of the nodes is used; this may be less cluttered when fitting a large plot
onto a page. The default is to use a non-uniform spacing proportional to the
error in the fit.</p>
</td></tr>
<tr><td><code id="plot_+3A_branch">branch</code></td>
<td>
<p>similar to <code>plot.rpart</code>;
controls the shape of the branches from parent to child node. Any number from
0 to 1 is allowed. A value of 1 gives square shouldered branches, a value of
0 give V shaped branches, with other values being intermediate.</p>
</td></tr>
<tr><td><code id="plot_+3A_compress">compress</code></td>
<td>
<p>similar to <code>plot.rpart</code>;
if <code>FALSE</code>, the leaf nodes will be at the horizontal plot coordinates of <code>1:nleaves</code>. If <code>TRUE</code>, the routine attempts a more compact arrangement of the tree.</p>
</td></tr>
<tr><td><code id="plot_+3A_nspace">nspace</code></td>
<td>
<p>similar to <code>plot.rpart</code>; the amount of extra space between a node with children
and a leaf, as compared to the minimal space between leaves. Applies to compressed trees only.
The default is the value of <code>branch</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_margin">margin</code></td>
<td>
<p>similar to <code>plot.rpart</code>; an extra fraction of white space to
leave around the borders of the tree. (Long labels sometimes get cut off by the default computation). </p>
</td></tr>
<tr><td><code id="plot_+3A_minbranch">minbranch</code></td>
<td>
<p>similar to <code>plot.rpart</code>; set the minimum length for a branch to <code>minbranch</code>
times the average branch length. This parameter is ignored if <code>uniform=TRUE</code>. Sometimes a split will
give very little improvement, or even (in the classification case) no improvement at all. A tree with
branch lengths strictly proportional to improvement leaves no room to squeeze in node labels.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a method for the generic function plot, for objects of class
<code>SurvCART</code>. The y-coordinate of the top node of the tree will always be 1.</p>


<h3>Value</h3>

<p>The coordinates of the nodes are returned as a list, with components <code>x</code>
and <code>y</code>.
</p>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Harezlak, J. (2019). Regression trees for longitudinal data with baseline covariates. Biostatistics &amp; Epidemiology, 3(1):1-22.
</p>
<p>Kundu, M. G., and Ghosh, S. (2021). Survival trees based on heterogeneity in time-to-event and censoring distributions using parameter instability test. Statistical Analysis and Data Mining: The ASA Data Science Journal, 14(5), 466-483.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+text">text</a></code>, <code><a href="#topic+SurvCART">SurvCART</a></code>, <code><a href="#topic+LongCART">LongCART</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#--- Get the data
data(GBSG2)

#numeric coding of character variables
GBSG2$horTh1&lt;- as.numeric(GBSG2$horTh)
GBSG2$tgrade1&lt;- as.numeric(GBSG2$tgrade)
GBSG2$menostat1&lt;- as.numeric(GBSG2$menostat)

#Add subject id
GBSG2$subjid&lt;- 1:nrow(GBSG2)

#--- Run SurvCART()
out&lt;- SurvCART(data=GBSG2, patid="subjid", censorvar="cens", timevar="time", event.ind=1, 
        gvars=c('horTh1', 'age', 'menostat1', 'tsize', 'tgrade1', 'pnodes', 'progrec', 'estrec'),  
        tgvars=c(0,1,0,1,0,1, 1,1),          
        alpha=0.05, minsplit=80,  
        minbucket=40, print=TRUE)

#--- Plot tree
par(xpd = TRUE)
plot(out, compress = TRUE)
text(out, use.n = TRUE)

</code></pre>

<hr>
<h2 id='PoS'>
Probability of trial ans clinical success for a prospective trial using normal-normal approximation
</h2><span id='topic+PoS'></span>

<h3>Description</h3>

<p>This function can be used to determine probability of trial success and clinical success based on the prior distribution for each of continuous, binary  and time-to-event endpoints. The calculation is carried out assuming normal distribution for estimated parameter and normal prior distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PoS(type, nsamples, null.value = NULL, alternative = "greater", 
    N = NULL, D = NULL, a = 1, 
    succ.crit = "trial", Z.crit.final = 1.96, alpha.final = 0.025, 
    clin.succ.threshold = NULL, se.exp = NULL, 
    meandiff.prior = NULL, mean.prior = NULL, sd.prior = NULL, 
    propdiff.prior = NULL, prop.prior = NULL, hr.prior = NULL, D.prior = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PoS_+3A_type">type</code></td>
<td>
<p>Type of the endpoint. It could be <code>cont</code> for continuous, <code>bin</code> for binary and <code>surv</code> for survival endpoint.</p>
</td></tr>
<tr><td><code id="PoS_+3A_nsamples">nsamples</code></td>
<td>
<p>Number of samples. For continuous and binary case, it can be 1 or 2. For survival endpoint, it can be only 2. </p>
</td></tr>
<tr><td><code id="PoS_+3A_null.value">null.value</code></td>
<td>
<p>The specified value under null hypothesis. Default is 0 for continuous and binomial case and 1 for survival case.</p>
</td></tr>
<tr><td><code id="PoS_+3A_alternative">alternative</code></td>
<td>
<p>Direction of alternate hypothesis. Can be &quot;greater&quot; or &quot;less&quot;. Default is &quot;less&quot; for test of HR and &quot;greater&quot; otherwise.</p>
</td></tr>
<tr><td><code id="PoS_+3A_n">N</code></td>
<td>
<p>Total sample size at final analysis. Cannot be missing for continuous and binary endpoint.</p>
</td></tr>
<tr><td><code id="PoS_+3A_d">D</code></td>
<td>
<p>Total number of events at final analysis. Cannot be missing for survival endpoint.</p>
</td></tr>
<tr><td><code id="PoS_+3A_a">a</code></td>
<td>
<p>Allocation ratio in two sample case.</p>
</td></tr>
<tr><td><code id="PoS_+3A_succ.crit">succ.crit</code></td>
<td>
<p>Specify &quot;trial&quot; for trial success (i.e., null hypothesis is rejected at final analysis) or &quot;clinical&quot; for clinical success (i.e., estimated value at the final analysis is greater than clinically meaningful value as specified under <code>clin.succ.threshold</code>.)</p>
</td></tr>
<tr><td><code id="PoS_+3A_z.crit.final">Z.crit.final</code></td>
<td>
<p>The rejection boundary at final analysis in Z-value scale. Either <code>alpha.final</code> or <code>Z.crit.final</code> must be specified when determining trial success.</p>
</td></tr>
<tr><td><code id="PoS_+3A_alpha.final">alpha.final</code></td>
<td>
<p>The rejection boundary at final analysis in alpha (1-sided) scale (e.g., 0.025). Either <code>alpha.final</code> or <code>Z.crit.final</code> must be specified when determining trial success.</p>
</td></tr>
<tr><td><code id="PoS_+3A_clin.succ.threshold">clin.succ.threshold</code></td>
<td>
<p>Clinically meaningful value. Required when <code>succ.crit="clinical"</code>.</p>
</td></tr>
<tr><td><code id="PoS_+3A_se.exp">se.exp</code></td>
<td>
<p>Expected standard error to be observed in the study. Must be specified in continuous case and two-sample binary case. </p>
</td></tr>
<tr><td><code id="PoS_+3A_meandiff.prior">meandiff.prior</code></td>
<td>
<p>Mean value of prior distribution for mean difference. Relevant for two-sample continuous case.</p>
</td></tr>
<tr><td><code id="PoS_+3A_mean.prior">mean.prior</code></td>
<td>
<p>Mean value of prior distribution for mean. Relevant for one-sample continuous case.</p>
</td></tr>
<tr><td><code id="PoS_+3A_sd.prior">sd.prior</code></td>
<td>
<p>Standard deviation of prior distribution for mean difference (2-sample continuous case) or mean (1-sample continuous case) or prop (2-sample binary case) or difference of proportion (1-sample binary case) or log(HR) (2 sample survival case). </p>
</td></tr>
<tr><td><code id="PoS_+3A_propdiff.prior">propdiff.prior</code></td>
<td>
<p>Mean value of prior distribution for difference in proportion. Relevant for two-sample binomial case.</p>
</td></tr>
<tr><td><code id="PoS_+3A_prop.prior">prop.prior</code></td>
<td>
<p>Mean value of prior distribution for proportion. Relevant for one-sample binomial case.</p>
</td></tr>
<tr><td><code id="PoS_+3A_hr.prior">hr.prior</code></td>
<td>
<p>Mean value of prior distribution for hazards ratio (HR). Relevant for two-sample survival case.</p>
</td></tr>
<tr><td><code id="PoS_+3A_d.prior">D.prior</code></td>
<td>
<p>Ignored if <code>sd.prior</code> is specified. If <code>sd.prior</code> is not specified then sd.prior is determined as 2/<code>D.prior</code>. Relevant for two-sample survival case.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to determine probability of success (PoS) for a prospective trial for each of continuous (one-sample or two-samples), binary (one-sample or two-samples) and time-to-event endpoints (two-samples). The PoS is calculated based on the prior distribution and expected standard error in the estimate in trial. The calculation PoS is carried out assuming normal distribution for estimated parameter and normal prior distribution. This function can be used to determine clinical success (<code>succ.crit="clinical"</code>) and trial success (<code>succ.crit="trial"</code>). For clinical success, <code>clin.succ.threshold</code> must be specified. For trial success, <code>Z.crit.final or alpha.final</code> must be specified.
</p>


<h3>Author(s)</h3>

<p>Madan Gopal Kundu &lt;madan_g.kundu@yahoo.com&gt;</p>


<h3>References</h3>

<p>Kundu, M. G., Samanta, S., and Mondal, S. (2021). An introduction to the determination of the probability of a successful trial: Frequentist and Bayesian approaches. arXiv preprint arXiv:2102.13550.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+succ_ia_betabinom_one">succ_ia_betabinom_one</a></code>, <code><a href="#topic+succ_ia_betabinom_two">succ_ia_betabinom_two</a></code>, <code><a href="#topic+succ_ia">succ_ia</a></code>   </p>


<h3>Examples</h3>

<pre><code class='language-R'>#--- Example 1
PoS(type="cont", nsamples=2, null.value=-0.05, alternative="greater", 
        N=1552, a=1,  
        succ.crit="trial", Z.crit.final=1.97,
        se.exp=0.12*sqrt(1/776 + 1/776),
        meandiff.prior=0, sd.prior=0.02) 

#--- Example 2
PoS(type="bin", nsamples=2, null.value=0, alternative="greater", 
        N=210, a=2,  
        succ.crit="trial", Z.crit.final=2.012,
        se.exp=0.5*sqrt(1/140 + 1/70),
        propdiff.prior=0.20, sd.prior=sqrt(0.06)) 

PoS(type="bin", nsamples=2, null.value=0, alternative="greater", 
        N=210, a=2,  
        succ.crit="clinical", clin.succ.threshold =0.15,
        se.exp=0.5*sqrt(1/140 + 1/70),
        propdiff.prior=0.20, sd.prior=sqrt(0.06)) 

#--- Example 4
PoS(type="surv", nsamples=2, null.value=1, alternative="less", 
        D=441,  
        succ.crit="trial", Z.crit.final=1.96,
        hr.prior=0.71, D.prior=133) 

PoS(type="surv", nsamples=2, null.value=1, alternative="less", 
        D=441,  
        succ.crit="clinical", clin.succ.threshold =0.8,
        hr.prior=0.71, D.prior=133) 

</code></pre>

<hr>
<h2 id='predict'>Predicts according to the fitted SurvCART or LongCART tree</h2><span id='topic+predict'></span><span id='topic+predict.SurvCART'></span><span id='topic+predict.LongCART'></span>

<h3>Description</h3>

<p>Predicts according to the fitted SurvCART or LongCART tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SurvCART'
predict(object, newdata, ...)
## S3 method for class 'LongCART'
predict(object, newdata, patid, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_+3A_object">object</code></td>
<td>
<p>a fitted object of class <code>"SurvCART"</code>, containing a survival tree, or class <code>"LongCART"</code>, containing a longitudinal tree.</p>
</td></tr>
<tr><td><code id="predict_+3A_newdata">newdata</code></td>
<td>
<p>The dataset for prediction.</p>
</td></tr>
<tr><td><code id="predict_+3A_patid">patid</code></td>
<td>
<p>Variable name containing patient id in the new dataset. Must for prediction based on LongCART object</p>
</td></tr>
<tr><td><code id="predict_+3A_...">...</code></td>
<td>
<p>Please disregard.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For prediction based on <code>"SurvCART"</code> algorithm, the predicted dataset includes the terminal node id the observation belongs to, and the median event and censoring times of the terminal id. 
</p>
<p>For prediction based on <code>"LongCART"</code> algorithm, the predicted dataset includes the terminal node id the observation belongs to,  the fitted profile, and the predicted value based on the fitted profile. Note that the predicted value does not consider the random effects.  
</p>


<h3>Value</h3>

<p>For prediction based on <code>"SurvCART"</code> algorithm, the dataset adds to the following variables in the new dataset:
</p>
<table>
<tr><td><code>node</code></td>
<td>
<p>Terminal node id the observation belongs to</p>
</td></tr>
<tr><td><code>median.T</code></td>
<td>
<p>Median event time of the terminal node id the observation belongs to</p>
</td></tr>
<tr><td><code>median.C</code></td>
<td>
<p>Median censoring time of the terminal node id the observation belongs to</p>
</td></tr>
<tr><td><code>Q1.T</code></td>
<td>
<p>First quartile for event time of the terminal node id the observation belongs to</p>
</td></tr>
<tr><td><code>Q1.C</code></td>
<td>
<p>First quartile for censoring time of the terminal node id the observation belongs to</p>
</td></tr>
<tr><td><code>Q3.T</code></td>
<td>
<p>Third quartile for event time of the terminal node id the observation belongs to</p>
</td></tr>
<tr><td><code>Q3.C</code></td>
<td>
<p>Third quartile for censoring time of the terminal node id the observation belongs to</p>
</td></tr>
</table>
<p>For prediction based on <code>LongCART</code> algorithm, the dataset adds to the following variables in the new dataset:
</p>
<table>
<tr><td><code>node.id</code></td>
<td>
<p>Terminal node id the observation belongs to</p>
</td></tr>
<tr><td><code>profile</code></td>
<td>
<p>The fitted profile of the terminal node id the observation belongs to</p>
</td></tr>
<tr><td><code>predval</code></td>
<td>
<p>predicted value based on the fitted profile <code>profile</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Harezlak, J. (2019). Regression trees for longitudinal data with baseline covariates. Biostatistics &amp; Epidemiology, 3(1):1-22.
</p>
<p>Kundu, M. G., and Ghosh, S. (2021). Survival trees based on heterogeneity in time-to-event and censoring distributions using parameter instability test. Statistical Analysis and Data Mining: The ASA Data Science Journal, 14(5), 466-483.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SurvCART">SurvCART</a></code>, <code><a href="#topic+LongCART">LongCART</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#--- LongCART example

data(ACTG175)
gvars=c("gender", "wtkg", "hemo", "homo", "drugs",
        "karnof", "oprior", "z30", "zprior", "race",
        "str2", "symptom", "treat", "offtrt")
tgvars=c(0, 1, 0, 0, 0,
         1, 0, 0, 0, 0,
         0, 0, 0, 0)
out1&lt;- LongCART(data=ACTG175, patid="pidnum", fixed=cd4~time,
                gvars=gvars, tgvars=tgvars, alpha=0.05,
                minsplit=100, minbucket=50, coef.digits=2)
pred1&lt;- predict.LongCART(object=out1, newdata=ACTG175, patid="pidnum")
head(pred1)

#--- SurvCART example

data(GBSG2)
GBSG2$horTh1&lt;- as.numeric(GBSG2$horTh)
GBSG2$tgrade1&lt;- as.numeric(GBSG2$tgrade)
GBSG2$menostat1&lt;- as.numeric(GBSG2$menostat)

GBSG2$subjid&lt;- 1:nrow(GBSG2)

fit&lt;- SurvCART(data=GBSG2, patid="subjid", censorvar="cens", timevar="time", 
        gvars=c('horTh1', 'age', 'menostat1', 'tsize', 'tgrade1', 'pnodes', 'progrec', 'estrec'),  
        tgvars=c(0,1,0,1,0,1, 1,1),          
        event.ind=1,  alpha=0.05, minsplit=80, minbucket=40, print=TRUE)

pred2&lt;- predict.SurvCART(object=fit, newdata=GBSG2)
head(pred2)

</code></pre>

<hr>
<h2 id='ProfilePlot'>
Population level longitudinal profile plot for sub-groups
</h2><span id='topic+ProfilePlot'></span>

<h3>Description</h3>

<p>Generates population level longitudinal profile plot for each of sub-groups (i.e., terminal nodes) associated with longitudinal tree generated by LongCART()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ProfilePlot(x, timevar, timevar.power=NULL, covariate.val=NULL,
                xlab=NULL, ylab=NULL, sg.title=4, mfrow=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ProfilePlot_+3A_x">x</code></td>
<td>
<p>a fitted object of class <code>"LongCART"</code>, containing a longitudinal tree.</p>
</td></tr>
<tr><td><code id="ProfilePlot_+3A_timevar">timevar</code></td>
<td>
<p>Speciy the variable name contining time informaiton in the dataset that was used to fit LongCART object</p>
</td></tr>
<tr><td><code id="ProfilePlot_+3A_timevar.power">timevar.power</code></td>
<td>
<p>Mandatory when the fixed part of the fitted model contains term as time with power not equal to  1. For example, if fixed part of the model is t + sqrtt + cov1, then specify <code>c(1, 0.5, NA</code>. If fixed part of the model is t + t^2 + cov1, then specify <code>c(1, 2, NA)</code>.</p>
</td></tr>
<tr><td><code id="ProfilePlot_+3A_covariate.val">covariate.val</code></td>
<td>
<p>Specify the covariate values for generation of longitudinal profile plot. Iin the longitudinal profile plot, only time can vary and therefore, and therefore the value for the other covariates are fixed at constant value. This is not needed if the longitudinal model does not contain additional covariate(s). By default, the covariates values are specified at median value over all the datapoint (not at the subject level).  For example, if the fixed part of the model is t + cov1, then <code>c(NA, 100)</code> sets the value of cov1 at 100. Similarly, If fixed part of the model is t + t^2 + cov1, then <code>c(NA, NA, 100)</code> would be acceptable.</p>
</td></tr>
<tr><td><code id="ProfilePlot_+3A_xlab">xlab</code></td>
<td>
<p>Optional label for X-axis</p>
</td></tr>
<tr><td><code id="ProfilePlot_+3A_ylab">ylab</code></td>
<td>
<p>Optional label for Y-axis</p>
</td></tr>
<tr><td><code id="ProfilePlot_+3A_sg.title">sg.title</code></td>
<td>
<p>1 for sub-groups' title as <code>Sub-group=x</code>, 2 for sub-groups' title as <code>Node=x</code>, 3 for sub-groups' title as <code>Sub-group=x (Node=x)</code>, and 4 for sub-groups' title as <code>&lt;node number&gt;: &lt;node defintion&gt;</code>.</p>
</td></tr>
<tr><td><code id="ProfilePlot_+3A_mfrow">mfrow</code></td>
<td>
<p>Desired frame for fitting multiple plots. Default option is to include plots for all subgroups in the same frame. This  input is ignored when <code>overlay=TRUE</code>.</p>
</td></tr>
<tr><td><code id="ProfilePlot_+3A_...">...</code></td>
<td>
<p>Graphical parameters other than <code>x, y, type, xlab, ylab</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Harezlak, J. (2019). Regression trees for longitudinal data with baseline covariates. Biostatistics &amp; Epidemiology, 3(1):1-22.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+text">text</a></code>, <code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+LongCART">LongCART</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#--- Get the data
data(ACTG175)

#-----------------------------------------------#
#   model: cd4~ time + subject(random)          #
#-----------------------------------------------#

#--- Run LongCART()
gvars=c("gender", "wtkg", "hemo", "homo", "drugs",
        "karnof", "oprior", "z30", "zprior", "race",
        "str2", "symptom", "treat", "offtrt")
tgvars=c(0, 1, 0, 0, 0,
         1, 0, 0, 0, 0,
         0, 0, 0, 0)


out1&lt;- LongCART(data=ACTG175, patid="pidnum", fixed=cd4~time,
                gvars=gvars, tgvars=tgvars, alpha=0.05,
                minsplit=100, minbucket=50, coef.digits=2)

#--- Plot longitudinal profiles of subgroups
ProfilePlot(x=out1, timevar="time")

#-----------------------------------------------#
#   model: cd4~ time+ time^2 + subject(random)  #
#-----------------------------------------------#

ACTG175$time2&lt;- ACTG175$time^2

out2&lt;- LongCART(data=ACTG175, patid="pidnum", fixed=cd4~time + time2,
                gvars=gvars, tgvars=tgvars, alpha=0.05,
                minsplit=100, minbucket=50, coef.digits=2)

ProfilePlot(x=out2, timevar="time", timevar.power=c(1,2))


#--------------------------------------------------------#
#   model: cd4~ time+ time^2 + subject(random) + karnof  #
#--------------------------------------------------------#

out3&lt;- LongCART(data=ACTG175, patid="pidnum", fixed=cd4~time + time2 + karnof,
                gvars=gvars, tgvars=tgvars, alpha=0.05,
                minsplit=100, minbucket=50, coef.digits=2)

#the value of the covariate karnof is set at median by default
ProfilePlot(x=out3, timevar="time", timevar.power=c(1,2, NA))

#the value of the covariate karnof is set at 120
ProfilePlot(x=out3, timevar="time", timevar.power=c(1,2, NA), 
                    covariate.val=c(NA, NA, 120))


</code></pre>

<hr>
<h2 id='StabCat+20'>parameter stability test for categorical partitioning variable</h2><span id='topic+StabCat'></span>

<h3>Description</h3>

<p>Performs parameter stability test (Kundu and Harezlak, 2019) 
with categorical partitioning variable to determine whether the parameters 
of linear mixed effects model remains same across all distinct values of 
given categorical partitioning variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StabCat(data, patid, fixed, splitvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="StabCat+2B20_+3A_data">data</code></td>
<td>
<p>name of the dataset. It must contain variable specified for <code>patid</code> (indicating subject id) and all the variables specified in the formula and the caterogrical partitioning variable of interest specified in <code>splitvar</code>. Note that, only numerically coded categorical variable should be specified. </p>
</td></tr>
<tr><td><code id="StabCat+2B20_+3A_patid">patid</code></td>
<td>
<p>name of the subject id variable.</p>
</td></tr>
<tr><td><code id="StabCat+2B20_+3A_fixed">fixed</code></td>
<td>
<p>a two-sided linear formula object describing the fixed-effects part of the model, with the response on the left of a <code>~ </code>operator and the terms, separated by <code>+</code> operators, on the right. Model with <code>-1</code> to the end of right side indicates no intercept. For model with no fixed effect beyond intercept, please specify only <code>1</code> right to the <code>~</code> operator.</p>
</td></tr>
<tr><td><code id="StabCat+2B20_+3A_splitvar">splitvar</code></td>
<td>
<p>the categorical partitioning variable of interest. It's value should not change over time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The categorical partitioning variable of interest. It's value should not change over time.
</p>
<p><code>Y_i(t)= W_i(t) theta + b_i + epsilon_{it}</code>
</p>
<p>where <code>W_i(t)</code> is the design matrix, <code>theta</code> is the parameter associated with 
<code>W_i(t)</code> and <code>b_i</code> is the random intercept. Also, <code>epsilon_{it} ~  N(0,sigma ^2)</code> 
and <code>b_i ~ N(0, sigma_u^2)</code>. Let X be the baseline categorical partitioning 
variable of interest. <code>StabCat()</code> performs the following omnibus test
</p>
<p><code>H_0:theta_{(g)}=theta_0</code> vs. <code>H_1: theta_{(g)} ^= theta_0</code>,     for all g
</p>
<p>where, <code>theta_{(g)}</code> is the true value of <code>theta</code> for subjects with <code>X=C_g</code> 
where <code>C_g</code> is the any value realized by <code>X</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>p</code></td>
<td>
<p>It returns the p-value for parameter instability test</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Harezlak, J. (2019). Regression trees for longitudinal data with baseline covariates. Biostatistics &amp; Epidemiology, 3(1):1-22.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StabCont">StabCont</a></code>, <code><a href="#topic+LongCART">LongCART</a></code>, <code><a href="#topic+LongCART">LongCART</a></code>, <code><a href="#topic+LongCART">LongCART</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--- Get the data
data(ACTG175)
                
#--- Run StabCat()                
out&lt;- StabCat(data=ACTG175, patid="pidnum", fixed=cd4~time, splitvar="gender")
out$pval
</code></pre>

<hr>
<h2 id='StabCat.surv+20'>parameter stability test for categorical partitioning variable</h2><span id='topic+StabCat.surv'></span>

<h3>Description</h3>

<p>Performs parameter stability test (Kundu, 2020) 
with categorical partitioning variable to determine whether the parameters 
of exponential time-to-event distribution and exponential censoring distribution remain 
same across all distinct values of given categorical partitioning variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StabCat.surv(data, timevar, censorvar, splitvar, 
              time.dist="exponential", cens.dist="NA", event.ind=1, print=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="StabCat.surv+2B20_+3A_data">data</code></td>
<td>
<p>name of the dataset. It must contain variable specified for <code>timevar</code> (indicating follow-up times), <code>censorvar</code> (indicating censoring status) and the caterogrical partitioning variable of interest specified in <code>splitvar</code>. Note that, only numerically coded categorical variable should be specified. </p>
</td></tr>
<tr><td><code id="StabCat.surv+2B20_+3A_timevar">timevar</code></td>
<td>
<p>name of the variable with follow-up times.</p>
</td></tr>
<tr><td><code id="StabCat.surv+2B20_+3A_censorvar">censorvar</code></td>
<td>
<p>name of the variable with censoring status.</p>
</td></tr>
<tr><td><code id="StabCat.surv+2B20_+3A_time.dist">time.dist</code></td>
<td>
<p>name of time-to-event distribution. It can be one of the following distributions: <code>"exponential"</code>, <code>"weibull"</code>, <code>"lognormal"</code> or <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="StabCat.surv+2B20_+3A_cens.dist">cens.dist</code></td>
<td>
<p>name of censoring distribution. It can be one of the following distributions: <code>"exponential"</code>, <code>"weibull"</code>, <code>"lognormal"</code>, <code>"normal"</code> or <code>"NA"</code>. If specified <code>"NA"</code>, then parameter instability test corresponding to censoring distribution will not be performed.</p>
</td></tr>
<tr><td><code id="StabCat.surv+2B20_+3A_event.ind">event.ind</code></td>
<td>
<p>value of the censoring variable indicating event.</p>
</td></tr>
<tr><td><code id="StabCat.surv+2B20_+3A_splitvar">splitvar</code></td>
<td>
<p>the categorical partitioning variable of interest. It's value should not change over time.</p>
</td></tr>
<tr><td><code id="StabCat.surv+2B20_+3A_print">print</code></td>
<td>
<p>if <code>TRUE</code>, then additional information including estimated parameters, score function and its variance will be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>StabCat.surv()</code> performs the following omnibus test
</p>
<p><code>H_0:lambda_{(g)}=lambda_0</code> vs. <code>H_1: lambda_{(g)} ^= lambda_0</code>,     for all g
</p>
<p>where, <code>theta_{(g)}</code> is the true value of <code>theta</code> for subjects with <code>X=C_g</code>. <code>theta</code> includes all the parameters of time to event distribution and also parameters of censoring distribution, if specified. <code>C_g</code> is the any value realized by categorical partitioning variable <code>X</code>.
</p>
<p>Exponential distribution: f(t)=lambda*exp(-lambda*t)
</p>
<p>Weibull distribution: f(t)=alpha*lambda*t^(alpha-1)*exp(-lambda*t^alpha)
</p>
<p>Lognormal distribution: f(t)=(1/t)*(1/sqrt(2*pi*sigma^2))*exp[-(1/2)*(log(t)-mu)/sigma^2]
</p>
<p>Normal distribution: f(t)=(1/sqrt(2*pi*sigma^2))*exp[-(1/2)*(t-mu)/sigma^2]
</p>


<h3>Value</h3>

<table>
<tr><td><code>pval</code></td>
<td>
<p>p-value for parameter instability test</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>1, if event times are more heterogeneous; 2, if censoring times are more hetergeneous.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Ghosh, S. (2021). Survival trees based on heterogeneity in time-to-event and censoring distributions using parameter instability test. Statistical Analysis and Data Mining: The ASA Data Science Journal, 14(5), 466-483. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StabCont.surv">StabCont.surv</a></code>, <code><a href="#topic+SurvCART">SurvCART</a></code>, <code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+text">text</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>       

#--- time-to-event distribution: exponential, censoring distribution: None    
out1&lt;- StabCat.surv(data=lung, timevar="time", censorvar="status", splitvar="sex", event.ind=2) 
out1$pval

#--- time-to-event distribution: weibull, censoring distribution: None  
StabCat.surv(data=lung, timevar="time", censorvar="status", splitvar="sex", 
             time.dist="weibull", event.ind=2) 

#--- time-to-event distribution: weibull, censoring distribution: exponential
StabCat.surv(data=lung, timevar="time", censorvar="status", splitvar="sex", 
             time.dist="weibull", cens.dist="exponential", event.ind=2)
</code></pre>

<hr>
<h2 id='StabCont+20'>parameter stability test for continuous partitioning variable</h2><span id='topic+StabCont'></span>

<h3>Description</h3>

<p>Performs parameter stability test (Kundu and Harezlak, 2019) 
with continuous partitioning variable to determine whether the parameters 
of linear mixed effects model remains same across all distinct values of 
given continuous partitioning variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StabCont(data, patid, fixed, splitvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="StabCont+2B20_+3A_data">data</code></td>
<td>
<p>name of the dataset. It must contain variable specified for <code>patid</code> (indicating subject id) and all the variables specified in the formula and the StabCont(data, fixed, splitvar)partitioning variable of interest specified in <code>splitvar</code>.</p>
</td></tr>
<tr><td><code id="StabCont+2B20_+3A_patid">patid</code></td>
<td>
<p>name of the subject id variable.</p>
</td></tr>
<tr><td><code id="StabCont+2B20_+3A_fixed">fixed</code></td>
<td>
<p>a two-sided linear formula object describing the fixed-effects part of the model, with the response on the left of a <code>~ </code>operator and the terms, separated by <code>+</code> operators, on the right. Model with <code>-1</code> to the end of right side indicates no intercept. For model with no fixed effect beyond intercept, please specify only <code>1</code> right to the <code>~</code> operator.</p>
</td></tr>
<tr><td><code id="StabCont+2B20_+3A_splitvar">splitvar</code></td>
<td>
<p>the continuous partitioning variable of interest. It's value should not change over time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The continuous partitioning variable of interest. It's value should not change over time.
</p>
<p style="text-align: center;"><code class="reqn">Y_i(t)= W_i(t)theta + b_i + epsilon_{it}</code>
</p>

<p>where <code class="reqn">W_i(t)</code> is the design matrix, <code>theta</code> is the parameter associated with 
<code class="reqn">W_i(t)</code> and <code>b_i</code> is the random intercept. Also, <code class="reqn">epsilon_{it} ~  N(0,sigma ^2)</code> 
and <code class="reqn">b_i ~ N(0, sigma_u^2)</code>. Let <code class="reqn">X</code> be the baseline continuous partitioning 
variable of interest. <code>StabCont()</code> performs the following omnibus test
</p>
<p><code class="reqn">H_0:theta_{(g)}=theta_0</code> vs. <code class="reqn">H_1: theta_{(g)} ^= theta_0</code>,     for all g
</p>
<p>where, <code class="reqn">theta_{(g)}</code> is the true value of <code class="reqn">theta</code> for subjects with <code class="reqn">X=C_g</code> 
where <code class="reqn">C_g</code> is the any value realized by <code class="reqn">X</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>p</code></td>
<td>
<p>It returns the p-value for parameter instability test</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Harezlak, J. (2019). Regression trees for longitudinal data with baseline covariates. Biostatistics &amp; Epidemiology, 3(1):1-22.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StabCont">StabCont</a></code>, <code><a href="#topic+LongCART">LongCART</a></code>, <code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+text">text</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--- Get the data
data(ACTG175)
               
#--- Run StabCont()                
out&lt;- StabCont(data=ACTG175, patid="pidnum", fixed=cd4~time, splitvar="age")
out$pval
</code></pre>

<hr>
<h2 id='StabCont.surv+20'>parameter stability test for continuous partitioning variable</h2><span id='topic+StabCont.surv'></span>

<h3>Description</h3>

<p>Performs parameter stability test (Kundu, 2020) 
with continuous partitioning variable to determine whether the parameters 
of exponential time-to-event distribution and exponential censoring distribution remain 
same across all distinct values of given continupus partitioning variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StabCont.surv(data, timevar, censorvar, splitvar, 
              time.dist="exponential", cens.dist="NA", event.ind=1, print=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="StabCont.surv+2B20_+3A_data">data</code></td>
<td>
<p>name of the dataset. It must contain variable specified for <code>timevar</code> (indicating follow-up times), <code>censorvar</code> (indicating censoring status) and the caterogrical partitioning variable of interest specified in <code>splitvar</code>. Note that, only numerically coded categorical variable should be specified. </p>
</td></tr>
<tr><td><code id="StabCont.surv+2B20_+3A_timevar">timevar</code></td>
<td>
<p>name of the variable with follow-up times.</p>
</td></tr>
<tr><td><code id="StabCont.surv+2B20_+3A_censorvar">censorvar</code></td>
<td>
<p>name of the variable with censoring status.</p>
</td></tr>
<tr><td><code id="StabCont.surv+2B20_+3A_time.dist">time.dist</code></td>
<td>
<p>name of time-to-event distribution. It can be one of the following distributions: <code>"exponential"</code>, <code>"weibull"</code>, <code>"lognormal"</code> or <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="StabCont.surv+2B20_+3A_cens.dist">cens.dist</code></td>
<td>
<p>name of censoring distribution. It can be one of the following distributions: <code>"exponential"</code>, <code>"weibull"</code>, <code>"lognormal"</code>, <code>"normal"</code> or <code>"NA"</code>. If specified <code>"NA"</code>, then parameter instability test corresponding to censoring distribution will not be performed.</p>
</td></tr>
<tr><td><code id="StabCont.surv+2B20_+3A_event.ind">event.ind</code></td>
<td>
<p>value of the censoring variable indicating event.</p>
</td></tr>
<tr><td><code id="StabCont.surv+2B20_+3A_splitvar">splitvar</code></td>
<td>
<p>the continuous partitioning variable of interest. </p>
</td></tr>
<tr><td><code id="StabCont.surv+2B20_+3A_print">print</code></td>
<td>
<p>if <code>TRUE</code>, then additional information including estimated parameters, score function and its variance will be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>StabCont.surv()</code> performs the following omnibus test
</p>
<p><code>H_0:theta_{(g)}=theta_0</code> vs. <code>H_1: theta_{(g)} ^= theta_0</code>,     for all g
</p>
<p>where, <code>theta_{(g)}</code> is the true value of <code>theta</code> for subjects with <code>X=C_g</code>. <code>theta</code> includes all the parameters of time to event distribution and also parameters of censoring distribution, if specified. <code>C_g</code> is the any value realized by continuous partitioning variable <code>X</code>.
</p>
<p>Exponential distribution: f(t)=lambda*exp(-lambda*t)
</p>
<p>Weibull distribution: f(t)=alpha*lambda*t^(alpha-1)*exp(-lambda*t^alpha)
</p>
<p>Lognormal distribution: f(t)=(1/t)*(1/sqrt(2*pi*sigma^2))*exp[-(1/2)*(log(t)-mu)/sigma^2]
</p>
<p>Normal distribution: f(t)=(1/sqrt(2*pi*sigma^2))*exp[-(1/2)*(t-mu)/sigma^2]
</p>


<h3>Value</h3>

<table>
<tr><td><code>pval</code></td>
<td>
<p>p-value for parameter instability test</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>1, if event times are more heterogeneous; 2, if censoring times are more hetergeneous.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Ghosh, S. (2021). Survival trees based on heterogeneity in time-to-event and censoring distributions using parameter instability test. Statistical Analysis and Data Mining: The ASA Data Science Journal, 14(5), 466-483.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+StabCont.surv">StabCont.surv</a></code>, <code><a href="#topic+SurvCART">SurvCART</a></code>, <code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+text">text</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   
#--- time-to-event distribution: exponential, censoring distribution: None    
out1&lt;- StabCont.surv(data=lung, timevar="time", censorvar="status", splitvar="age", event.ind=2) 
out1$pval

#--- time-to-event distribution: weibull, censoring distribution: None  
StabCont.surv(data=lung, timevar="time", censorvar="status", splitvar="age", 
              time.dist="weibull", event.ind=2) 

#--- time-to-event distribution: weibull, censoring distribution: exponential
StabCont.surv(data=lung, timevar="time", censorvar="status", splitvar="age", 
              time.dist="weibull", cens.dist="exponential", event.ind=2) 
</code></pre>

<hr>
<h2 id='succ_ia'>
Conditional power and predictive power of success based on interim results using normal-normal approximation
</h2><span id='topic+succ_ia'></span>

<h3>Description</h3>

<p>This function can be used to determine conditional power and predictive power for trial success and clinical success based on the interim results and prior distribution for each of continuous, binary  and time-to-event endpoints. The calculation is carried out assuming normal distribution for estimated parameter and normal prior distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>succ_ia(type, nsamples, null.value = NULL, alternative = NULL, 
        N = NULL, n = NULL, D = NULL, d = NULL, a = 1, 
        meandiff.ia = NULL, mean.ia = NULL, 
        propdiff.ia = NULL, prop.ia = NULL, hr.ia = NULL, 
        stderr.ia = NULL, sd.ia = NULL, 
        succ.crit = "trial", Z.crit.final = 1.96, 
        alpha.final = 0.025, clin.succ.threshold = NULL, 
        meandiff.exp = NULL, mean.exp = NULL, 
        propdiff.exp = NULL, prop.exp = NULL, hr.exp = NULL, 
        meandiff.prior = NULL, mean.prior = NULL, sd.prior = NULL, 
        propdiff.prior = NULL, prop.prior = NULL, hr.prior = NULL, D.prior = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="succ_ia_+3A_type">type</code></td>
<td>
<p>Type of the endpoint. It could be <code>cont</code> for continuous, <code>bin</code> for binary and <code>surv</code> for survival endpoint.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_nsamples">nsamples</code></td>
<td>
<p>Number of samples. For continuous and binary case, it can be 1 or 2. For survival endpoint, it can be only 2. </p>
</td></tr>
<tr><td><code id="succ_ia_+3A_null.value">null.value</code></td>
<td>
<p>The specified value under null hypothesis. Default is 0 for continuous and binomial case and 1 for survival case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_alternative">alternative</code></td>
<td>
<p>Direction of alternate hypothesis. Can be &quot;greater&quot; or &quot;less&quot;. Default is &quot;less&quot; for test of HR and &quot;greater&quot; otherwise.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_n">N</code></td>
<td>
<p>Total sample size at final analysis. Cannot be missing for continuous and binary endpoint.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_n">n</code></td>
<td>
<p>Total sample size at interim analysis. Cannot be missing for continuous and binary endpoint.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_d">D</code></td>
<td>
<p>Total number of events at final analysis. Cannot be missing for survival endpoint.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_d">d</code></td>
<td>
<p>Total number of events at interim analysis. Cannot be missing for survival endpoint.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_a">a</code></td>
<td>
<p>Allocation ratio in two sample case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_meandiff.ia">meandiff.ia</code></td>
<td>
<p>Estimated mean difference at interim analysis. Mandatory for continuous two sample case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_mean.ia">mean.ia</code></td>
<td>
<p>Estimated mean value at interim analysis. Mandatory for continuous single sample case</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_propdiff.ia">propdiff.ia</code></td>
<td>
<p>Estimated difference in proportion at interim analysis. Mandatory for binary two sample case</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_prop.ia">prop.ia</code></td>
<td>
<p>Estimated proportion at interim analysis. Mandatory for binary single sample case</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_hr.ia">hr.ia</code></td>
<td>
<p>Estimate hazards ratio (HR) at interim analysis. Mandatory for continuous single sample case</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_stderr.ia">stderr.ia</code></td>
<td>
<p>Standard error (SE) of estimated mean difference (in one-sample continuous  case) or estimated mean (in two-sample continuous case) or estimated difference in proportion (in two-sample binary case) at interim analysis. For continuous case, if not specified, then the function attempts to estimate SE  from <code>sd.ia</code>. Mandatory for two-sample binary case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_sd.ia">sd.ia</code></td>
<td>
<p>Standard deviation of estimated mean difference (in one-sample continuous  case) or estimated mean (in two-sample continuous case) at interim analysis. If <code>stderr.ia</code> is specified, then the value of <code>sd.ia</code> is ignored. If codestderr.ia is not specified, then mandatory for continuous case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_succ.crit">succ.crit</code></td>
<td>
<p>Specify &quot;trial&quot; for trial success (i.e., null hypothesis is rejected at final analysis) or &quot;clinical&quot; for clinical success (i.e., estimated value at the final analysis is greater than clinically meaningful value as specified under <code>clin.succ.threshold</code>.)</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_z.crit.final">Z.crit.final</code></td>
<td>
<p>The rejection boundary at final analysis in Z-value scale. Either <code>alpha.final</code> or <code>Z.crit.final</code> must be specified when determining trial success.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_alpha.final">alpha.final</code></td>
<td>
<p>The rejection boundary at final analysis in alpha (1-sided) scale (e.g., 0.025). Either <code>alpha.final</code> or <code>Z.crit.final</code> must be specified when determining trial success.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_clin.succ.threshold">clin.succ.threshold</code></td>
<td>
<p>Clinically meaningful value. Required when <code>succ.crit="clinical"</code>.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_meandiff.exp">meandiff.exp</code></td>
<td>
<p>Expected mean difference in post interim data. Relevant for two-sample continuous case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_mean.exp">mean.exp</code></td>
<td>
<p>Expected mean in post interim data. Relevant for one-sample continuous case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_propdiff.exp">propdiff.exp</code></td>
<td>
<p>Expected difference in proportion in post interim data. Relevant for two-sample binary case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_prop.exp">prop.exp</code></td>
<td>
<p>Expected proportion in post interim data. Relevant for one-sample binary case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_hr.exp">hr.exp</code></td>
<td>
<p>Expected hazards ratio (HR) in post interim data. Relevant for two-sample survival case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_meandiff.prior">meandiff.prior</code></td>
<td>
<p>Mean value of prior distribution for mean difference. Relevant for two-sample continuous case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_mean.prior">mean.prior</code></td>
<td>
<p>Mean value of prior distribution for mean. Relevant for one-sample continuous case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_sd.prior">sd.prior</code></td>
<td>
<p>Standard deviation of prior distribution for mean difference (2-sample continuous case) or mean (1-sample continuous case) or prop (2-sample binary case) or difference of proportion (1-sample binary case) or log(HR) (2 sample survival case). </p>
</td></tr>
<tr><td><code id="succ_ia_+3A_propdiff.prior">propdiff.prior</code></td>
<td>
<p>Mean value of prior distribution for difference in proportion. Relevant for two-sample binomial case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_prop.prior">prop.prior</code></td>
<td>
<p>Mean value of prior distribution for proportion. Relevant for one-sample binomial case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_hr.prior">hr.prior</code></td>
<td>
<p>Mean value of prior distribution for hazards ratio (HR). Relevant for two-sample survival case.</p>
</td></tr>
<tr><td><code id="succ_ia_+3A_d.prior">D.prior</code></td>
<td>
<p>Ignored if <code>sd.prior</code> is specified. If <code>sd.prior</code> is not specified then sd.prior is determined as 2/<code>D.prior</code>. Relevant for two-sample survival case.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to determine Conditional power (CP) and Predictive power or predictive probability of success (PPoS) based on the interim results for each of continuous (one-sample or two-samples), binary (one-sample or two-samples) and time-to-event endpoints (two-samples). The PPoS can be  based on interim results only or using both prior information and interim results. The calculation of CP and PPoS are carried out assuming normal distribution for estimated parameter and normal prior distribution. This function can be used to determine clinical success (<code>succ.crit="clinical"</code>) and trial success (<code>succ.crit="trial"</code>). For clinical success, <code>clin.succ.threshold</code> must be specified. For trial success, <code>Z.crit.final or alpha.final</code> must be specified.
</p>
<p>In order to calculate CP and PPoS, <code>succ.ia()</code> should be invoked in the following form:
</p>
<p>Continuous-two sample case (trial success): 
</p>
<p><code>succ.ia(type="cont", nsamples=2, null.value=, alternative=,  N=, n=, a, meandiff.ia, stderr.ia=, succ.crit="trial", Z.crit.final=)</code>
</p>
<p>Continuous-two sample case (clinical success): 
</p>
<p><code>succ.ia(type="cont", nsamples=2, null.value=, alternative=,  N=, n=, a, meandiff.ia, stderr.ia=, succ.crit="clinical", clin.succ.threshold=)</code>
</p>
<p>Continuous-one sample case (trial success): 
</p>
<p><code>succ.ia(type="cont", nsamples=1, null.value=, alternative=,  N=, n=, mean.ia, stderr.ia=, succ.crit="trial", Z.crit.final=)</code>
</p>
<p>Continuous-one sample case (clinical success): 
</p>
<p><code>succ.ia(type="cont", nsamples=1, null.value=, alternative=,  N=, n=, mean.ia, stderr.ia=, succ.crit="clinical", clin.succ.threshold=)</code>
</p>
<p>Binary-two sample case (trial success): 
</p>
<p><code>succ.ia(type="bin", nsamples=2, null.value=, alternative=,  N=, n=, a, propdiff.ia, stderr.ia=, succ.crit="trial", Z.crit.final=)</code>
</p>
<p>Binary-two sample case (clinical success): 
</p>
<p><code>succ.ia(type="bin", nsamples=2, null.value=, alternative=,  N=, n=, a, propdiff.ia, stderr.ia=, succ.crit="clinical", clin.succ.threshold=)</code>
</p>
<p>Binary-one sample case (trial success): 
</p>
<p><code>succ.ia(type="bin", nsamples=1, null.value=, alternative=,  N=, n=, prop.ia, succ.crit="trial", Z.crit.final=)</code>
</p>
<p>Binary-one sample case (clinical success): 
</p>
<p><code>succ.ia(type="bin", nsamples=1, null.value=, alternative=,  N=, n=, prop.ia, succ.crit="clinical", clin.succ.threshold=)</code>
</p>
<p>Survival-two sample case (trial success): 
</p>
<p><code>succ.ia(type="surv", nsamples=2, null.value=, alternative=,  D=, d=, a, hr.ia, succ.crit="trial", Z.crit.final=)</code>
</p>
<p>Survival-two sample case (clinical success): 
</p>
<p><code>succ.ia(type="surv", nsamples=2, null.value=, alternative=,  D=, d=, a, hr.ia, succ.crit="clinical", clin.succ.threshold=)</code>
</p>
<p>The conditional power is calculated assuming interim trend for post-interim data. If <code>meandiff.exp</code> (for continuous 2-samples case), <code>mean.exp</code> (for continuous 1-sample case), <code>propdiff.exp</code> (for binomial 2-samples case), <code>prop.exp</code> (for binomial 1-sample case), or <code>hr.exp</code> (for survival 2-samples case) is specified, then conditional power would be calculated using these specified value as well.
</p>
<p>The Predictive power or Predictive probability of success (PPoS) is calculated based interim results. On top of this, it can also incorporate prior information. The prior information can be specified as follows: If <code>meandiff.prior, sd.prior</code> for continuous 2-samples case, <code>mean.prior, sd.prior</code> for continuous 1-sample case, <code>propdiff.prior, sd.prior</code> for binomial 2-samples case, <code>prop.prior, sd.prior</code> for binomial 1-sample case, and <code>hr.exp, sd.prior</code> (or, <code>hr.exp, D.prior</code>) for survival 2-samples case. 
</p>


<h3>Author(s)</h3>

<p>Madan Gopal Kundu &lt;madan_g.kundu@yahoo.com&gt;</p>


<h3>References</h3>

<p>Kundu, M. G., Samanta, S., and Mondal, S. (2021). An introduction to the determination of the probability of a successful trial: Frequentist and Bayesian approaches. arXiv preprint arXiv:2102.13550.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+succ_ia_betabinom_one">succ_ia_betabinom_one</a></code>, <code><a href="#topic+succ_ia_betabinom_two">succ_ia_betabinom_two</a></code>, <code><a href="#topic+PoS">PoS</a></code>   </p>


<h3>Examples</h3>

<pre><code class='language-R'>#--- Lan et al. (2009), see #6. Example, outcome: Matching
succ_ia(type="cont", nsamples=1, null.value=0, alternative="greater", 
        N=225, n=45,   
        mean.ia=0, stderr.ia=1,       
        succ.crit="trial", Z.crit.final=1.96) 


#--- Dallow et al. (2011), see Figure 1. Example, outcome: Matching
succ_ia(type="cont", nsamples=1, null.value=0, alternative="greater", 
        N=100, n=50,   
        mean.ia=1.364, stderr.ia=1,      
        succ.crit="trial",  Z.crit.final=1.64) 

#--- Example 1 in the paper (Continuous endpoint)
succ_ia(type="cont", nsamples=2, null.value=-0.05, alternative="greater",
        N=1552, n=776, a=1,   
        meandiff.ia=-0.025, sd.ia=0.16,      
        succ.crit="trial", Z.crit.final=1.97,  
        meandiff.exp=-0.030,
        meandiff.prior=0, sd.prior=0.02) 

#--- Example 2 in the paper (Binary endpoint)
p1&lt;- 0.379; p2&lt;- 0.222
n1&lt;- 105; n2&lt;- 53

#-- Trial success
succ_ia(type="bin", nsamples=2, null.value=0, alternative="greater",
        N=210, n=158,  a=2,
        propdiff.ia=p1-p2,
        stderr.ia=sqrt(p1*(1-p1)/n1 + p2*(1-p2)/n2), 
        succ.crit="trial", Z.crit.final=2.012,
        propdiff.exp=0.20,
        propdiff.prior=0.20, sd.prior=sqrt(0.06))  

#-- Clinical success
succ_ia(type="bin", nsamples=2, null.value=0, alternative="greater",
        N=210, n=158,  a=2,
        propdiff.ia=p1-p2,
        stderr.ia=sqrt(p1*(1-p1)/n1 + p2*(1-p2)/n2), 
        succ.crit="clinical", clin.succ.threshold=0.15,
        propdiff.exp=0.20,
        propdiff.prior=0.20, sd.prior=sqrt(0.06)) 


#--- Example 3 in the paper (Survival endpoint)

#--- Trial success
succ_ia(type="surv", nsamples=2, null.value=1, alternative="less", 
        D=441, d=346, a=1,   
        hr.ia=0.82,        
        succ.crit="trial", Z.crit.final=2.012,            
        hr.exp=0.75,
        hr.prior=0.71, D.prior=133) 

#--- clinical success
succ_ia(type="surv", nsamples=2, null.value=1, alternative="less", 
        D=441, d=346, a=1,   
        hr.ia=0.82,        
        succ.crit="clinical", clin.succ.threshold=0.80,            
        hr.exp=0.75,
        hr.prior=0.71, D.prior=133) 

</code></pre>

<hr>
<h2 id='succ_ia_betabinom_one'>
Determines predictive power of success based on interim results and beta prior for one-sample binary data
</h2><span id='topic+succ_ia_betabinom_one'></span>

<h3>Description</h3>

<p>This function can be used to determine predictive power for trial success and clinical success based on the interim results and beta prior distribution for test of population proportion. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>succ_ia_betabinom_one(N, n, x, 
                      null.value = 0, alternative = "greater", 
                      test="z", correct=TRUE,
                      succ.crit = "trial", Z.crit.final = 1.96, 
                      alpha.final = 0.025, clin.succ.threshold = NULL, 
                      a = 1, b = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="succ_ia_betabinom_one_+3A_n">N</code></td>
<td>
<p>Sample size at final analysis. Cannot be missing.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_n">n</code></td>
<td>
<p>Sample size at interim analysis. Cannot be missing.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_x">x</code></td>
<td>
<p>Number of observed response at interim analysis. Cannot be missing.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_null.value">null.value</code></td>
<td>
<p>The specified value under null hypothesis. Default is 0.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_alternative">alternative</code></td>
<td>
<p>Direction of alternate hypothesis. Can be &quot;greater&quot; or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_test">test</code></td>
<td>
<p>Statistical test. Default is <code>"z"</code> for Z test. For Exact binomial test, specify <code>"exact"</code>.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_correct">correct</code></td>
<td>
<p>A logical indicating whether Yates' continuity correction should be applied where possible. Applies to approximate Z-test only.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_succ.crit">succ.crit</code></td>
<td>
<p>Specify &quot;trial&quot; for trial success (i.e., null hypothesis is rejected at final analysis) or &quot;clinical&quot; for clinical success (i.e., estimated value at the final analysis is greater than clinically meaningful value as specified under <code>clin.succ.threshold</code>.)</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_z.crit.final">Z.crit.final</code></td>
<td>
<p>The rejection boundary at final analysis in Z-value scale. Either <code>alpha.final</code> or <code>Z.crit.final</code> must be specified when determining trial success.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_alpha.final">alpha.final</code></td>
<td>
<p>The rejection boundary at final analysis in alpha (1-sided) scale (e.g., 0.025). Either <code>alpha.final</code> or <code>Z.crit.final</code> must be specified when determining trial success.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_clin.succ.threshold">clin.succ.threshold</code></td>
<td>
<p>Clinically meaningful value. Required when <code>succ.crit="clinical"</code>.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_a">a</code></td>
<td>
<p>Value of <code>a</code> corresponding to Beta(a, b) prior for proportion.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_one_+3A_b">b</code></td>
<td>
<p>Value of <code>b</code> corresponding to Beta(a, b) prior for proportion.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to determine Predictive power or predictive probability of success (PPoS) based on the interim results for testing of population proportion. The calculation of PoS is carried out assuming beta prior distributions for proportion. This function can be used to determine clinical success (<code>succ.crit="clinical"</code>) and trial success (<code>succ.crit="trial"</code>). For clinical success, <code>clin.succ.threshold</code> must be specified. For trial success, <code>Z.crit.final or alpha.final</code> must be specified.
</p>


<h3>Author(s)</h3>

<p>Madan Gopal Kundu &lt;madan_g.kundu@yahoo.com&gt;</p>


<h3>References</h3>

<p>Kundu, M. G., Samanta, S., and Mondal, S. (2021). An introduction to the determination of the probability of a successful trial: Frequentist and Bayesian approaches. arXiv preprint arXiv:2102.13550.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+succ_ia_betabinom_two">succ_ia_betabinom_two</a></code>, <code><a href="#topic+succ_ia">succ_ia</a></code>, <code><a href="#topic+PoS">PoS</a></code>   </p>


<h3>Examples</h3>

<pre><code class='language-R'>succ_ia_betabinom_one( N=40, n=30, x=25, 
        null.value=0.6, alternative="greater", 
        succ.crit = "trial", alpha.final = 0.016,  
        a = 1, b=1) 

succ_ia_betabinom_one( N=40, n=30, x=25, 
        null.value=0.6, alternative="greater", test="exact",
        succ.crit = "trial", alpha.final = 0.016,  
        a = 1, b=1) 

succ_ia_betabinom_one( N=40, n=30, x=15, 
        null.value=0.6, alternative="greater", 
        succ.crit = "clinical", clin.succ.threshold =0.5,  
        a = 1, b=1) 
</code></pre>

<hr>
<h2 id='succ_ia_betabinom_two'>
Determines predictive power of success based on interim results and beta priors for two-sample binary data
</h2><span id='topic+succ_ia_betabinom_two'></span>

<h3>Description</h3>

<p>This function can be used to determine predictive power for trial success and clinical success based on the interim results and beta prior distribution for test of difference of two proportions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>succ_ia_betabinom_two(N.trt, N.con, 
                      n.trt, x.trt, n.con, x.con, 
                      alternative = "greater", test = "z", 
                      succ.crit = "trial", Z.crit.final = 1.96, 
                      alpha.final = 0.025, clin.succ.threshold = NULL, 
                      a.trt = 1, b.trt = 1, a.con = 1, b.con = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="succ_ia_betabinom_two_+3A_n.trt">N.trt</code></td>
<td>
<p>Sample size in treatment arm at final analysis. Cannot be missing.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_n.con">N.con</code></td>
<td>
<p>Sample size in control arm at final analysis. Cannot be missing.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_n.trt">n.trt</code></td>
<td>
<p>Sample size in treatment arm at interim analysis. Cannot be missing.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_x.trt">x.trt</code></td>
<td>
<p>Number of observed response in treatment arm at interim analysis. Cannot be missing.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_n.con">n.con</code></td>
<td>
<p>Sample size in control arm at interim analysis. Cannot be missing.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_x.con">x.con</code></td>
<td>
<p>Number of observed response in control arm at interim analysis. Cannot be missing.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_alternative">alternative</code></td>
<td>
<p>Direction of alternate hypothesis. Can be &quot;greater&quot; or &quot;less&quot;.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_test">test</code></td>
<td>
<p>Statistical test. Default is <code>"z"</code> for Z test. For Fisher's exact test, specify <code>"fisher"</code>.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_succ.crit">succ.crit</code></td>
<td>
<p>Specify &quot;trial&quot; for trial success (i.e., null hypothesis is rejected at final analysis) or &quot;clinical&quot; for clinical success (i.e., estimated value at the final analysis is greater than clinically meaningful value as specified under <code>clin.succ.threshold</code>.)</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_z.crit.final">Z.crit.final</code></td>
<td>
<p>The rejection boundary at final analysis in Z-value scale. Either <code>alpha.final</code> or <code>Z.crit.final</code> must be specified when determining trial success.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_alpha.final">alpha.final</code></td>
<td>
<p>The rejection boundary at final analysis in alpha (1-sided) scale (e.g., 0.025). Either <code>alpha.final</code> or <code>Z.crit.final</code> must be specified when determining trial success.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_clin.succ.threshold">clin.succ.threshold</code></td>
<td>
<p>Clinically meaningful value. Required when <code>succ.crit="clinical"</code>.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_a.trt">a.trt</code></td>
<td>
<p>Value of <code>a</code> corresponding to Beta(a, b) prior in treatment arm.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_b.trt">b.trt</code></td>
<td>
<p>Value of <code>b</code> corresponding to Beta(a, b) prior in treatment arm.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_a.con">a.con</code></td>
<td>
<p>Value of <code>a</code> corresponding to Beta(a, b) prior for proportion in control arm.</p>
</td></tr>
<tr><td><code id="succ_ia_betabinom_two_+3A_b.con">b.con</code></td>
<td>
<p>Value of <code>b</code> corresponding to Beta(a, b) prior for proportion in control arm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to determine Predictive power or predictive probability of success (PPoS) based on the interim results for comparison of two proportions. The calculation of PoS is carried out assuming beta prior distributions for proportions in both treatment and control arms. This function can be used to determine clinical success (<code>succ.crit="clinical"</code>) and trial success (<code>succ.crit="trial"</code>). For clinical success, <code>clin.succ.threshold</code> must be specified. For trial success, <code>Z.crit.final or alpha.final</code> must be specified.
</p>


<h3>Author(s)</h3>

<p>Madan Gopal Kundu &lt;madan_g.kundu@yahoo.com&gt;</p>


<h3>References</h3>

<p>Kundu, M. G., Samanta, S., and Mondal, S. (2021). An introduction to the determination of the probability of a successful trial: Frequentist and Bayesian approaches. arXiv preprint arXiv:2102.13550.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+succ_ia_betabinom_one">succ_ia_betabinom_one</a></code>, <code><a href="#topic+succ_ia">succ_ia</a></code>, <code><a href="#topic+PoS">PoS</a></code>    </p>


<h3>Examples</h3>

<pre><code class='language-R'>
succ_ia_betabinom_two( N.con=40, N.trt=40, 
        n.trt=30, x.trt=20, n.con=30, x.con=15, 
        alternative="greater", test="fisher",
        succ.crit = "trial", Z.crit.final = 1.96,  
        a.trt = 1, b.trt=1, a.con=1, b.con=1) 

succ_ia_betabinom_two( N.con=40, N.trt=40, 
        n.trt=30, x.trt=20, n.con=30, x.con=15, 
        alternative="greater", test="z",
        succ.crit = "trial", Z.crit.final = 1.96,  
        a.trt = 1, b.trt=1, a.con=1, b.con=1) 

succ_ia_betabinom_two( N.con=40, N.trt=40, 
        n.trt=30, x.trt=20, n.con=30, x.con=15, 
        alternative="greater", test="fisher",
        succ.crit = "clinical", clin.succ.threshold = 0.5, 
        a.trt = 1, b.trt=1, a.con=1, b.con=1) 

#--- Johns &amp; Andersen, 1999, Example 1a (results matching)
succ_ia_betabinom_two( N.trt=32, N.con=32,  
        n.trt=12, x.trt=8, n.con=12, x.con=8, 
        alternative="greater", test="fisher",
        succ.crit = "clinical", clin.succ.threshold = 0,  
        a.trt = 1, b.trt=1, a.con=1, b.con=1) 

#--- Johns &amp; Andersen, 1999, Example 1b (results matching)
succ_ia_betabinom_two( N.trt=32, N.con=32,  
        n.trt=12, x.trt=8, n.con=12, x.con=11, 
        alternative="greater", test="fisher",
        succ.crit = "clinical", clin.succ.threshold = 0,  
        a.trt = 1, b.trt=1, a.con=1, b.con=1) 

#--- Johns &amp; Andersen, 1999, Example 2 (not matching, reported 0.586, got 0.536)
succ_ia_betabinom_two( N.trt=155+170, N.con=152+171,  
        n.trt=155, x.trt=13, n.con=152, x.con=21, 
        alternative="less", test="z",
        succ.crit = "trial", Z.crit.final = 1.96,  
        a.trt = 1, b.trt=1, a.con=1, b.con=1) 

succ_ia_betabinom_two( N.trt=155+170, N.con=152+171,  
        n.trt=155, x.trt=13, n.con=152, x.con=21, 
        alternative="less", test="fisher",
        succ.crit = "trial", Z.crit.final = 1.96,  
        a.trt = 1, b.trt=1, a.con=1, b.con=1) 

</code></pre>

<hr>
<h2 id='SurvCART'>Survival CART with time to event response via binary partitioning</h2><span id='topic+SurvCART'></span>

<h3>Description</h3>

<p>Recursive partitioning for linear mixed effects model with survival 
data per SurvCART algorithm based on baseline partitioning variables (Kundu, 2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurvCART(data, patid, timevar, censorvar, gvars, tgvars, 
         time.dist="exponential", cens.dist="NA", event.ind=1, 
         alpha=0.05, minsplit=40, minbucket=20, quantile=0.50, print=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SurvCART_+3A_data">data</code></td>
<td>
<p>name of the dataset. It must contain variable specified for <code>patid</code> (indicating subject id), all the variables specified in the formula and the baseline partitioning variables.</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_patid">patid</code></td>
<td>
<p>name of the subject id variable.</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_timevar">timevar</code></td>
<td>
<p>name of the variable with follow-up times.</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_censorvar">censorvar</code></td>
<td>
<p>name of the variable with censoring status.</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_gvars">gvars</code></td>
<td>
<p>list of partitioning variables of interest. Value of these variables should not change over time. Regarding categorical variables, only numerically coded categorical variables should be specified. For nominal categorical variables or factors, please first create corresponding dummy variable(s) and then pass through <code>gvars</code>. </p>
</td></tr>
<tr><td><code id="SurvCART_+3A_tgvars">tgvars</code></td>
<td>
<p>types (categorical or continuous) of partitioning variables specified in <code>gvar</code>. For each of continuous partitioning variables, specify <code>1</code> and for each of the categorical partitioning variables, specify <code>0</code>. Length of <code>tgvars</code> should match to the length of <code>gvars</code></p>
</td></tr>
<tr><td><code id="SurvCART_+3A_time.dist">time.dist</code></td>
<td>
<p>name of time-to-event distribution. It can be one of the following distributions: <code>"exponential"</code>, <code>"weibull"</code>, <code>"lognormal"</code> or <code>"normal"</code>.</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_cens.dist">cens.dist</code></td>
<td>
<p>name of censoring distribution. It can be one of the following distributions: <code>"exponential"</code>, <code>"weibull"</code>, <code>"lognormal"</code>, <code>"normal"</code> or <code>"NA"</code>. If specified <code>"NA"</code>, then parameter instability test corresponding to censoring distribution will not be performed.</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_event.ind">event.ind</code></td>
<td>
<p>value of the censoring variable indicating event.</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_alpha">alpha</code></td>
<td>
<p>alpha (i.e., nominal type I error) level for parameter instability test</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_minsplit">minsplit</code></td>
<td>
<p>the minimum number of observations that must exist in a node in order for a split to be attempted.</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_minbucket">minbucket</code></td>
<td>
<p>the minimum number of observations in any terminal node.</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_quantile">quantile</code></td>
<td>
<p>The quantile to be displayed in the visualization of tree through <code>plot.SurvCART()</code> or <code>plot()</code>.</p>
</td></tr>
<tr><td><code id="SurvCART_+3A_print">print</code></td>
<td>
<p>if <code>TRUE</code>, then summary such as number of subjects at risk, number of events, median event time and median censoring time model will be printed for each node.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Construct survival tree based on heterogeneity in time-to-event and censoring distributions.
</p>
<p>Exponential distribution: f(t)=lambda*exp(-lambda*t)
</p>
<p>Weibull distribution: f(t)=alpha*lambda*t^(alpha-1)*exp(-lambda*t^alpha)
</p>
<p>Lognormal distribution: f(t)=(1/t)*(1/sqrt(2*pi*sigma^2))*exp[-(1/2)*(log(t)-mu)/sigma^2]
</p>
<p>Normal distribution: f(t)=(1/sqrt(2*pi*sigma^2))*exp[-(1/2)*(t-mu)/sigma^2]
</p>


<h3>Value</h3>

<table>
<tr><td><code>Treeout</code></td>
<td>
<p>contains summary information of tree fitting for each terminal nodes and non-terminal nodes. Columns of <code>Treeout</code> include &quot;ID&quot;, the (unique) node numbers that follow a binary ordering indexed by node depth, <code>n</code>, the number of subjectsreaching the node, <code>D</code>, the number of events reaching the node, <code>median.T</code>, the median survival time at the node, <code>median.C</code>, the median censoring time at the node, var, splitting variable, <code>index</code>, the cut-off value of splitting variable for binary partitioning, <code>p (Instability)</code>, the p-value for parameter instability test for the splitting variable, <code>loglik</code>, the log-likelihood at the node, <code>AIC</code>, the AIC at the node, <code>improve</code>,  the improvement in deviance given by this split, and <code>Terminal</code>,  indicator (True or False) of terminal node.  </p>
</td></tr>
<tr><td><code>logLik.tree</code></td>
<td>
<p>log-likelihood of the tree-structured model, based on Cox model including sub-groups as covariates</p>
</td></tr>
<tr><td><code>logLik.root</code></td>
<td>
<p>log-likelihood at the root node (i.e., without tree structure), based on Cox model without any covariate  </p>
</td></tr>
<tr><td><code>AIC.tree</code></td>
<td>
<p>AIC of the tree-structured model, based on Cox model including sub-groups as covariates</p>
</td></tr>
<tr><td><code>AIC.root</code></td>
<td>
<p>AIC at the root node (i.e., without tree structure), based on Cox model without any covariate </p>
</td></tr>
<tr><td><code>nodelab</code></td>
<td>
<p>List of subgroups or terminal nodes with their description</p>
</td></tr>
<tr><td><code>varnam</code></td>
<td>
<p>List of splitting variables</p>
</td></tr>
<tr><td><code>ds</code></td>
<td>
<p>the dataset originally supplied</p>
</td></tr>
<tr><td><code>event.ind</code></td>
<td>
<p>value of the censoring variable indicating event.</p>
</td></tr>
<tr><td><code>timevar</code></td>
<td>
<p>name of the variable with follow-up times</p>
</td></tr>
<tr><td><code>censorvar</code></td>
<td>
<p>name of the variable with censoring status</p>
</td></tr>
<tr><td><code>frame</code></td>
<td>
<p>rpart compatible object</p>
</td></tr>
<tr><td><code>splits</code></td>
<td>
<p>rpart compatible object</p>
</td></tr>
<tr><td><code>cptable</code></td>
<td>
<p>rpart compatible object</p>
</td></tr>
<tr><td><code>functions</code></td>
<td>
<p>rpart compatible object</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Ghosh, S. (2021). Survival trees based on heterogeneity in time-to-event and censoring distributions using parameter instability test. Statistical Analysis and Data Mining: The ASA Data Science Journal, 14(5), 466-483.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+KMPlot">KMPlot</a></code>, <code><a href="#topic+text">text</a></code>, <code><a href="#topic+StabCat.surv">StabCat.surv</a></code>, <code><a href="#topic+StabCont.surv">StabCont.surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#--- Get the data
data(GBSG2)

#numeric coding of character variables
GBSG2$horTh1&lt;- as.numeric(GBSG2$horTh)
GBSG2$tgrade1&lt;- as.numeric(GBSG2$tgrade)
GBSG2$menostat1&lt;- as.numeric(GBSG2$menostat)

#Add subject id
GBSG2$subjid&lt;- 1:nrow(GBSG2)

#--- Run SurvCART() with time-to-event distribution: exponential, censoring distribution: None  
out&lt;- SurvCART(data=GBSG2, patid="subjid", censorvar="cens", timevar="time", 
        gvars=c('horTh1', 'age', 'menostat1', 'tsize', 'tgrade1', 'pnodes', 'progrec', 'estrec'),  
        tgvars=c(0,1,0,1,0,1, 1,1),          
        event.ind=1,  alpha=0.05, minsplit=80, minbucket=40, print=TRUE)

#--- Plot tree
par(xpd = TRUE)
plot(out, compress = TRUE)
text(out, use.n = TRUE)

#Plot KM plot for sub-groups identified by tree
KMPlot(out, xscale=365.25, type=1)
KMPlot(out, xscale=365.25, type=2, overlay=FALSE, mfrow=c(2,2), xlab="Year", ylab="Survival prob.")


#--- Run SurvCART() with time-to-event distribution: weibull censoring distribution: None  
out2&lt;- SurvCART(data=GBSG2, patid="subjid", censorvar="cens", timevar="time",  
        gvars=c('horTh1', 'age', 'menostat1', 'tsize', 'tgrade1', 'pnodes', 'progrec', 'estrec'),  
        tgvars=c(0,1,0,1,0,1, 1,1),          
        time.dist="weibull", event.ind=1, alpha=0.05, minsplit=80, minbucket=40, print=TRUE)


#--- Run SurvCART() with time-to-event distribution: weibull censoring distribution: exponential
out&lt;- SurvCART(data=GBSG2, patid="subjid", censorvar="cens", timevar="time",  
        gvars=c('horTh1', 'age', 'menostat1', 'tsize', 'tgrade1', 'pnodes', 'progrec', 'estrec'),  
        tgvars=c(0,1,0,1,0,1, 1,1),          
        time.dist="weibull", cens.dist="exponential", event.ind=1, 
        alpha=0.05, minsplit=80, minbucket=40, print=TRUE)

</code></pre>

<hr>
<h2 id='text'>Place text on SurvCART or LongCART tree</h2><span id='topic+text'></span><span id='topic+text.SurvCART'></span><span id='topic+text.LongCART'></span>

<h3>Description</h3>

<p>Labels the current plot of the tree generated from SurvCART or LongCART object with text.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SurvCART'
text(x, splits = TRUE, all = FALSE,
             use.n = FALSE, minlength = 1L, ...)
## S3 method for class 'LongCART'
text(x, splits = TRUE, all = FALSE,
             use.n = FALSE, minlength = 1L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="text_+3A_x">x</code></td>
<td>
<p>a fitted object of class <code>"SurvCART"</code>, containing a survival tree, or class <code>"LongCART"</code>, containing a longitudinal tree.</p>
</td></tr>
<tr><td><code id="text_+3A_splits">splits</code></td>
<td>
<p>similar to text.rpart; 
logical flag. If <code>TRUE</code> (default), then the splits in the tree are labeled with the criterion for the split.</p>
</td></tr>
<tr><td><code id="text_+3A_all">all</code></td>
<td>
<p>similar to text.rpart; 
Logical. If TRUE, all nodes are labeled, otherwise just terminal nodes.</p>
</td></tr>
<tr><td><code id="text_+3A_use.n">use.n</code></td>
<td>
<p>similar to text.rpart; 
Logical. If TRUE, adds <code>n</code> to label.</p>
</td></tr>
<tr><td><code id="text_+3A_minlength">minlength</code></td>
<td>
<p>similar to text.rpart; 
the length to use for factor labels. A value of 1 causes them to be printed as 'a', 'b', ..... Larger values use abbreviations of the label names. See the labels.rpart function for details.</p>
</td></tr>
<tr><td><code id="text_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from other methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Madan Gopal Kundu <a href="mailto:madan_g.kundu@yahoo.com">madan_g.kundu@yahoo.com</a></p>


<h3>References</h3>

<p>Kundu, M. G., and Harezlak, J. (2019). Regression trees for longitudinal data with baseline covariates. Biostatistics &amp; Epidemiology, 3(1):1-22.
</p>
<p>Kundu, M. G., and Ghosh, S. (2021). Survival trees based on heterogeneity in time-to-event and censoring distributions using parameter instability test. Statistical Analysis and Data Mining: The ASA Data Science Journal, 14(5), 466-483.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+SurvCART">SurvCART</a></code>, <code><a href="#topic+LongCART">LongCART</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#--- Get the data
data(GBSG2)

#numeric coding of character variables
GBSG2$horTh1&lt;- as.numeric(GBSG2$horTh)
GBSG2$tgrade1&lt;- as.numeric(GBSG2$tgrade)
GBSG2$menostat1&lt;- as.numeric(GBSG2$menostat)

#Add subject id
GBSG2$subjid&lt;- 1:nrow(GBSG2)

#--- Run SurvCART()
out&lt;- SurvCART(data=GBSG2, patid="subjid", censorvar="cens", timevar="time", event.ind=1, 
        gvars=c('horTh1', 'age', 'menostat1', 'tsize', 'tgrade1', 'pnodes', 'progrec', 'estrec'),  
        tgvars=c(0,1,0,1,0,1, 1,1),          
        alpha=0.05, minsplit=80,  
        minbucket=40, print=TRUE)

#--- Plot tree
par(xpd = TRUE)
plot(out, compress = TRUE)
text(out, use.n = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
