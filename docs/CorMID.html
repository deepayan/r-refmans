<!DOCTYPE html><html><head><title>Help for package CorMID</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CorMID}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CalcTheoreticalMDV'><p>CalcTheoreticalMDV.</p></a></li>
<li><a href='#CorMID'><p>CorMID.</p></a></li>
<li><a href='#CountChemicalElements'><p>CountChemicalElements.</p></a></li>
<li><a href='#prep'><p>Example data as used in function <code>CorMID</code>.</p></a></li>
<li><a href='#recMID'><p>recMID.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Correct Mass Isotopologue Distribution Vectors</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-07-25</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Lisec &lt;jan.lisec@bam.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>In metabolic flux experiments tracer molecules (often glucose
    containing labelled carbon) are incorporated in compounds measured
    using mass spectrometry. The mass isotopologue distributions of these
    compounds needs to be corrected for natural abundance of labelled
    carbon and other effects, which are specific on the compound and
    ionization technique applied. This package provides functions to
    correct such effects in gas chromatography atmospheric pressure
    chemical ionization mass spectrometry analyses.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/janlisec/CorMID">https://github.com/janlisec/CorMID</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.50)</td>
</tr>
<tr>
<td>Imports:</td>
<td>plyr, Rdisop</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, vdiffr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-09 07:50:52 UTC; jlisec</td>
</tr>
<tr>
<td>Author:</td>
<td>Jan Lisec <a href="https://orcid.org/0000-0003-1220-2286"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-10 09:10:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='CalcTheoreticalMDV'>CalcTheoreticalMDV.</h2><span id='topic+CalcTheoreticalMDV'></span>

<h3>Description</h3>

<p><code>CalcTheoreticalMDV</code> will compute the Mass Distribution Vectors
of isotopologues as it is used for correction matrix in <a href="#topic+CorMID">CorMID</a> computations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcTheoreticalMDV(fml = NULL, nbio = NULL, nmz = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcTheoreticalMDV_+3A_fml">fml</code></td>
<td>
<p>The chemical formula of the compound.</p>
</td></tr>
<tr><td><code id="CalcTheoreticalMDV_+3A_nbio">nbio</code></td>
<td>
<p>Provide the number of biological carbon within <code>fml</code> explicitly.</p>
</td></tr>
<tr><td><code id="CalcTheoreticalMDV_+3A_nmz">nmz</code></td>
<td>
<p>Provide the number of measured isotopes of <code>fml</code> explicitly.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>CalcTheoreticalMDV</code> basically is a convenience function using Rdisop
to generate the isotopologue distribution at natural abundance of <code class="reqn">^{13}C</code>
for a given formula.
It will break this down into a matrix where the components of the MID constitute
the rows and the expected relative ion intensities are within the columns.
The number of exported ion intensities and MID components can be limited
if numeric values for <code>nmz</code> and/or <code>nbio</code> are provided as parameters.
</p>


<h3>Value</h3>

<p>A matrix of theoretical mass distribution vectors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># standard distribution matrix
fml &lt;- "C5H6Si1"
CalcTheoreticalMDV(fml = fml)

# extend to more columns (number of measured ions) if required
CalcTheoreticalMDV(fml = fml, nmz = 4)

# limit to a smaller number of biological carbon (i.e. if compounds are silylated)
CalcTheoreticalMDV(fml = fml, nmz = 4, nbio = 2)
</code></pre>

<hr>
<h2 id='CorMID'>CorMID.</h2><span id='topic+CorMID'></span><span id='topic+plot.CorMID'></span><span id='topic+print.CorMID'></span>

<h3>Description</h3>

<p><code>CorMID</code> will compute a MID (Mass Isotopomer Distribution)
based on measured ion intensities in GC-APCI-MS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CorMID(
  int = NULL,
  fml = "",
  r = NULL,
  penalize = 7,
  mid_fix = NULL,
  trace_steps = FALSE,
  prec = 0.01
)

## S3 method for class 'CorMID'
plot(x, ...)

## S3 method for class 'CorMID'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CorMID_+3A_int">int</code></td>
<td>
<p>Named numeric vector of measured ion intensities of a fragment. Names will give position of values relative to M+H (see details).</p>
</td></tr>
<tr><td><code id="CorMID_+3A_fml">fml</code></td>
<td>
<p>Chemical formula of the fragment as string.</p>
</td></tr>
<tr><td><code id="CorMID_+3A_r">r</code></td>
<td>
<p>Either a character vector giving fragments to be considered
OR a named numeric giving relative amounts of fragments
OR NULL (all known fragments will  be estimated)
OR a 2-row matrix giving the lower and upper allowed ratio (see examples).</p>
</td></tr>
<tr><td><code id="CorMID_+3A_penalize">penalize</code></td>
<td>
<p>Numeric exponent penalizing solutions with low M+H occurrence. Formula is 1+3*(1-x)^penalty. NA to omit penalizing.</p>
</td></tr>
<tr><td><code id="CorMID_+3A_mid_fix">mid_fix</code></td>
<td>
<p>May provide a numeric vector used as a given MID. Allows to estimate <em>r</em> individually.</p>
</td></tr>
<tr><td><code id="CorMID_+3A_trace_steps">trace_steps</code></td>
<td>
<p>For testing purposes. Print the results of intermediate steps to console.</p>
</td></tr>
<tr><td><code id="CorMID_+3A_prec">prec</code></td>
<td>
<p>Precision of the estimation of MID, set to 1% as default.</p>
</td></tr>
<tr><td><code id="CorMID_+3A_x">x</code></td>
<td>
<p>Object of class CorMID.</p>
</td></tr>
<tr><td><code id="CorMID_+3A_...">...</code></td>
<td>
<p>Further plotting parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let's assume we measured the ion intensities of all 3 isotopes of an
individual compound containing 2 carbons and observe a vector of 978,22,0.
We may calculate the enrichment <strong>E</strong> out of this data, i.e. the relative proportion
of 13C vs total carbon which will amount to about 1.1% (the natural 13C abundance)
under standard conditions.
The equivalent corMID vector would be 1,0,0, indicating that the non-labeled
isotopologue (where non-labeled means non-labeled above the natural 1.1%)
is the only component observed.
During a labeling experiment we may change the measurement values in different
ways (either labeling only one carbon or both), which potentially can translate
into similar values for <strong>E</strong> being larger 1.1%.
The MIDs will provide additional information about the isotopologue fraction
which gave rise to the observed <strong>E</strong>'s (cf. examples). The <em>r</em> parameter
indicates an overlay of chemical rearrangements which may occur.
</p>


<h3>Value</h3>

<p>Estimated percent representation of each isotopologue measured (corMID).
</p>


<h3>References</h3>

<p>&lt;doi:10.3390/metabo12050408&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># make up some fake measurement data for Pyruvic acid 2TMS with 3 biological carbon
# assuming 10% labeling at M3 and 2 fragments
fml &lt;- "C9H20O3Si2"
mid &lt;- c(0.9,0,0,0.1)
r &lt;- unlist(list("M+H"=0.8, "M+H2O-CH4"=0.2))
int &lt;- CorMID::recMID(mid=mid, r=r, fml=fml)
plot(int)

# full estimation of M and r
out &lt;- CorMID::CorMID(int=int, fml=fml)
plot(out)

# get an improved result setting r to the correct values
CorMID::CorMID(int=int, fml=fml, r=r, prec=0.0001)

# provoke a wrong estimation using a fixed r
CorMID::CorMID(int=int, fml=fml, r=unlist(list("M+H"=1)))

# calculate r if you know the true corMID for a compound
r &lt;- attr(CorMID::CorMID(int=int, fml=fml, mid_fix=c(0.9,0,0,0.1)), "ratio")
round(CorMID::CorMID(int=int, fml=fml, r=r, prec=0.0001),3)

# deal with missing intensity values
CorMID::CorMID(int=int[-3], fml=fml)


# perform estimation with banded r and observation of optimization steps
r &lt;- matrix(c(0.5,1,0,0.5,0,0.5), nrow=2, dimnames=list(NULL,c("M+H","M+","M+H2O-CH4")))
CorMID::CorMID(int=int, fml=fml, r=r, trace=TRUE)

#process Gln data from publication
utils::data("prep", package = "CorMID")
int &lt;- prep[[24]][["int"]][,6]
fml &lt;- prep[[24]]$fml
CorMID::CorMID(int=int, fml=fml, trace=TRUE)

# check the effect of the penalize parameter on selection of adducts
int &lt;- c(1560, 119203, 41927, 16932, 4438)
names(int) &lt;- c(-2, 0, 1, 2, 3)
fml &lt;- "C19H37NO4Si3"
CorMID::CorMID(int=int, fml=fml, r=NULL, trace=TRUE)
CorMID::CorMID(int=int, fml=fml, r=NULL, trace=TRUE, penalize=7)

</code></pre>

<hr>
<h2 id='CountChemicalElements'>CountChemicalElements.</h2><span id='topic+CountChemicalElements'></span>

<h3>Description</h3>

<p><code>CountChemicalElements</code> will split a character (chemical formula)
into its elements and count their occurrence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CountChemicalElements(x = NULL, ele = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CountChemicalElements_+3A_x">x</code></td>
<td>
<p>Chemical formula.</p>
</td></tr>
<tr><td><code id="CountChemicalElements_+3A_ele">ele</code></td>
<td>
<p>Character vector of elements to count particularly or counting all contained in string if NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>No testing for any chemical alphabet is performed. Elements may occur
several times and will be summed up in this case without a warning.
Information within brackets, i.e. [13]C will be removed prior to counting
together with other symbols not contained in the R set 'alnum'.
The result is filtered and ordered according to parameter 'ele' if provided.
</p>


<h3>Value</h3>

<p>A named numeric with counts for all contained or specified elements.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># count every element
CountChemicalElements("C3H7Cl")

# remove additional symbols and sum up redundant elements (here 'C')
CountChemicalElements("[13]CC2H8Cl+")

# count specific elements and return in specified order
CountChemicalElements("[13]CC2H8Cl+", ele=c("Cl","O","H"))

# apply on a vector of formulas using sapply
sapply(c("C3H7Cl", "[13]CC2H8Cl+"), CorMID::CountChemicalElements, ele=c("Cl","O","H"))
</code></pre>

<hr>
<h2 id='prep'>Example data as used in function <code>CorMID</code>.</h2><span id='topic+prep'></span>

<h3>Description</h3>

<p>Example data as used in function <code>CorMID</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(prep)
</code></pre>


<h3>Format</h3>

<p>A list of 36 example metabolites.
</p>

<dl>
<dt>name</dt><dd><p>The compound name.</p>
</dd>
<dt>int</dt><dd><p>A numeric matrix providing peak intensities of isotopologues containing biological carbon (rows) over ten samples (columns).</p>
</dd>
<dt>fml</dt><dd><p>A character vector of the chemical formula of the compound amended by attributes for the number  of biological carbons 'nbio' and the number of measured mass isotopologues 'nmz'.</p>
</dd>
</dl>



<h3>Source</h3>

<p>A flux experiment on SW480/SW620 cell lines by Inna Zaimenko (IZ_Exp05).
</p>

<hr>
<h2 id='recMID'>recMID.</h2><span id='topic+recMID'></span><span id='topic+plot.recMID'></span>

<h3>Description</h3>

<p><code>recMID</code> will reconstruct a measured GC-APCI-MS spectrum
of a compound given its true MID and the fragment ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recMID(mid = NULL, r = list(`M+H` = 1), fml = NULL, cutoff = 0.001)

## S3 method for class 'recMID'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recMID_+3A_mid">mid</code></td>
<td>
<p>A numeric vector with sum=1 and length of C atoms +1.</p>
</td></tr>
<tr><td><code id="recMID_+3A_r">r</code></td>
<td>
<p>Fragment ratios. A numeric vector with sum=1.</p>
</td></tr>
<tr><td><code id="recMID_+3A_fml">fml</code></td>
<td>
<p>A compound formula.</p>
</td></tr>
<tr><td><code id="recMID_+3A_cutoff">cutoff</code></td>
<td>
<p>Remove values below this threshold from output vector.</p>
</td></tr>
<tr><td><code id="recMID_+3A_x">x</code></td>
<td>
<p>Object of class recMID.</p>
</td></tr>
<tr><td><code id="recMID_+3A_...">...</code></td>
<td>
<p>Further plotting parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>recMID</code> is basically the inverse function to <code>CorMID</code>.
Providing a specific chemical formula together with information regarding
the true MID and r, this function will compute a vector of ion intensities
which can be expected in a GC-APCI-MS analysis for this compound.
</p>


<h3>Value</h3>

<p>A reconstructed MID.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fml &lt;- "C9H20O3Si2"
mid &lt;- c(0.9,0,0,0.1)
r &lt;- list("M+H"=0.8, "M-H"=0.1, "M+H2O-CH4"=0.1)
(rMID &lt;- CorMID::recMID(mid=mid, r=r, fml=fml))
plot(rMID)
plot(x = rMID, ylim=c(0,max(rMID)))
plot(x = rMID, xlim=c(-2,12), ylim=NULL, col=2, lwd=12, las=2, xlab="label")

CorMID::CorMID(int = rMID, fml=fml, prec=0.001, r=unlist(r), trace_steps = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
