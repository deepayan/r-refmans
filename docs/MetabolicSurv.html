<!DOCTYPE html><html><head><title>Help for package MetabolicSurv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MetabolicSurv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CVLasoelacox'><p>Cross Validations for Lasso Elastic Net Survival predictive models and</p>
Classification</a></li>
<li><a href='#cvle'><p>Constructor for the cvle class</p></a></li>
<li><a href='#cvle-class'><p>The cvle Class.</p></a></li>
<li><a href='#CVMajorityvotes'><p>Cross validation for majority votes</p></a></li>
<li><a href='#CVMetSpecificCoxPh'><p>Cross validation for the Metabolite specific analysis</p></a></li>
<li><a href='#cvmm'><p>Constructor for the cvmm class</p></a></li>
<li><a href='#cvmm-class'><p>The cvmm Class.</p></a></li>
<li><a href='#cvmv'><p>Constructor for the cvmv class</p></a></li>
<li><a href='#cvmv-class'><p>The cvmv Class.</p></a></li>
<li><a href='#CVPcaPls'><p>Cross Validations for PCA and PLS based methods</p></a></li>
<li><a href='#cvpp'><p>Constructor for the cvpp class</p></a></li>
<li><a href='#cvpp-class'><p>The cvpp Class.</p></a></li>
<li><a href='#cvsim'><p>Constructor for the cvsim class</p></a></li>
<li><a href='#cvsim-class'><p>The cvsim Class.</p></a></li>
<li><a href='#CVSimet'><p>Cross validation for sequentially increases metabolites</p></a></li>
<li><a href='#DataHR'><p>Survival and Prognostic Data .</p></a></li>
<li><a href='#DistHR'><p>Null Distribution of the Estimated HR</p></a></li>
<li><a href='#EstimateHR'><p>Classification, Survival Estimation and Visualization</p></a></li>
<li><a href='#fcv'><p>Constructor for the fcv class</p></a></li>
<li><a href='#fcv-class'><p>The fcv Class.</p></a></li>
<li><a href='#Icvlasoel'><p>Inner and Outer Cross Validations for Lasso Elastic Net Survival predictive models and Classification</p></a></li>
<li><a href='#Lasoelacox'><p>Wapper function for glmnet</p></a></li>
<li><a href='#Majorityvotes'><p>Classifiction for Majority Votes</p></a></li>
<li><a href='#MetabolicSurv'><p>MetabolicSurv: A biomarker validation approach for predicting survival using metabolic signature.</p></a></li>
<li><a href='#MetFreq'><p>Frequency of Selected Metabolites from the LASSO, Elastic-net Cross-Validation</p></a></li>
<li><a href='#ms'><p>The ms class</p></a></li>
<li><a href='#MSData'><p>Generate Artificial Metabolic Survival Data</p></a></li>
<li><a href='#MSpecificCoxPh'><p>Metabolite by metabolite Cox proportional analysis</p></a></li>
<li><a href='#perm'><p>Constructor for the perm class</p></a></li>
<li><a href='#perm-class'><p>The perm Class.</p></a></li>
<li><a href='#plot,cvle,missing-method'><p>Plot method for cvle class</p></a></li>
<li><a href='#plot,cvmm,ANY-method'><p>Plot method for cvmm class</p></a></li>
<li><a href='#plot,cvmv,ANY-method'><p>Plot method for cvmv class</p></a></li>
<li><a href='#plot,cvpp,missing-method'><p>Plot method for cvpp class</p></a></li>
<li><a href='#plot,cvsim,missing-method'><p>Plot method for cvsim class</p></a></li>
<li><a href='#plot,fcv,missing-method'><p>Plot method for fcv class</p></a></li>
<li><a href='#plot,ms,ANY-method'><p>Plot method for ms class</p></a></li>
<li><a href='#plot,perm,ANY-method'><p>Plot method for perm class</p></a></li>
<li><a href='#show,cvle-method'><p>Show method for cvle class</p></a></li>
<li><a href='#show,cvmm-method'><p>Show method for cvmm class</p></a></li>
<li><a href='#show,cvmv-method'><p>Show method for cvmv class</p></a></li>
<li><a href='#show,cvpp-method'><p>Show method for cvpp class</p></a></li>
<li><a href='#show,cvsim-method'><p>Show method for cvsim class</p></a></li>
<li><a href='#show,fcv-method'><p>Show method for fcv class</p></a></li>
<li><a href='#show,ms-method'><p>Show method for ms class</p></a></li>
<li><a href='#show,perm-method'><p>Show method for perm class</p></a></li>
<li><a href='#SIMet'><p>Sequential Increase in Metabolites for the PCA or PLS classifier</p></a></li>
<li><a href='#summary,cvle-method'><p>Summary method for cvle class</p></a></li>
<li><a href='#summary,cvmm-method'><p>Summary method for cvmm class</p></a></li>
<li><a href='#summary,cvmv-method'><p>Summary method for cvmv class</p></a></li>
<li><a href='#summary,cvpp-method'><p>Summary method for cvpp class</p></a></li>
<li><a href='#summary,cvsim-method'><p>Summary method for cvsim class</p></a></li>
<li><a href='#summary,fcv-method'><p>Summary method for fcv class</p></a></li>
<li><a href='#summary,ms-method'><p>Summary method for ms class</p></a></li>
<li><a href='#summary,perm-method'><p>Summary method for perm class</p></a></li>
<li><a href='#SurvPcaClass'><p>Survival PCA and Classification for metabolic data</p></a></li>
<li><a href='#SurvPlsClass'><p>Survival PLS and Classification for metabolic data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Biomarker Validation Approach for Classification and
Predicting Survival Using Metabolomics Signature</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>An approach to identifies metabolic biomarker signature for metabolic data by discovering predictive metabolite for predicting survival and classifying patients into risk groups. 
 Classifiers are constructed as a linear combination of predictive/important metabolites, prognostic factors and treatment effects if necessary. 
 Several methods were implemented to reduce the metabolomics matrix such as the  principle component analysis of Wold Svante et al. (1987) &lt;<a href="https://doi.org/10.1016%2F0169-7439%2887%2980084-9">doi:10.1016/0169-7439(87)80084-9</a>&gt; , 
 the LASSO method by Robert Tibshirani (1998) &lt;<a href="https://doi.org/10.1002/(SICI)1097-0258(19970228)16:4%3C385::AID-SIM380%3E3.0.CO;2-3">doi:10.1002/(SICI)1097-0258(19970228)16:4%3C385::AID-SIM380%3E3.0.CO;2-3</a>&gt;, the 
 elastic net approach by Hui Zou and Trevor Hastie (2005) &lt;<a href="https://doi.org/10.1111%2Fj.1467-9868.2005.00503.x">doi:10.1111/j.1467-9868.2005.00503.x</a>&gt;. 
 Sensitivity analysis on the quantile used for the classification can also be accessed to check the deviation of the classification group based on the quantile specified. 
 Large scale cross validation can be performed in  order to investigate the mostly selected predictive metabolites and for internal validation. During the evaluation process, validation is accessed using the hazard ratios (HR) distribution of the test set and inference is mainly based on resampling and permutations technique.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/OlajumokeEvangelina/MetabolicSurv">https://github.com/OlajumokeEvangelina/MetabolicSurv</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/OlajumokeEvangelina/MetabolicSurv/issues/new">https://github.com/OlajumokeEvangelina/MetabolicSurv/issues/new</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>superpc, glmnet, matrixStats, survminer, survival, rms, tidyr,
pls, Rdpack, methods, stats, ggplot2, dplyr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-10 22:12:49 UTC; lucp9546</td>
</tr>
<tr>
<td>Author:</td>
<td>Olajumoke Evangelina Owokotomo [aut, cre],
  Ziv Shkedy [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Olajumoke Evangelina Owokotomo &lt;olajumoke.owokotomo@uhasselt.be&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-11 08:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CVLasoelacox'>Cross Validations for Lasso Elastic Net Survival predictive models and
Classification</h2><span id='topic+CVLasoelacox'></span>

<h3>Description</h3>

<p>The function does cross validation for Lasso, Elastic net and Ridge
regressions models before the survial analysis and classification.
The survival analysis is based on the selected metabolites in the
presence or absene of prognostic factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CVLasoelacox(
  Survival,
  Censor,
  Mdata,
  Prognostic,
  Quantile = 0.5,
  Metlist = NULL,
  Standardize = TRUE,
  Reduce = TRUE,
  Select = 15,
  Alpha = 1,
  Fold = 4,
  Ncv = 10,
  nlambda = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CVLasoelacox_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of
subjects</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with metabolic profiles where the number of rows should be equal to the number of metabolites and number of columns should be equal to number of patients.</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_quantile">Quantile</code></td>
<td>
<p>The cut off value for the classifier, default is the median cutoff</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_metlist">Metlist</code></td>
<td>
<p>A list of metabolites to be considered in the model
usually smaller than the metabolites in the Mdata .
Default is to use all metabolites available and it is advisable
to be greater than 17.</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_standardize">Standardize</code></td>
<td>
<p>A Logical flag for the standardization of the
metabolite matrix, prior to fitting the model sequence.
The coefficients are always returned on the original scale.
Default is standardize=TRUE.</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_reduce">Reduce</code></td>
<td>
<p>A boolean parameter indicating if the metabolic profile
matrix should be reduced, default is TRUE and larger metabolic profile
matrix is reduced by supervised pca approach and first pca is extracted
from the reduced matrix to be used in the classifier.</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_select">Select</code></td>
<td>
<p>Number of metabolites (default is 15) to be selected
from supervised PCA. This is valid only if the argument Reduce=TRUE</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_alpha">Alpha</code></td>
<td>
<p>The mixing parameter for glmnet
(see <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>). The range is 0&lt;= Alpha &lt;= 1.
The Default is 1</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_fold">Fold</code></td>
<td>
<p>number of folds to be used for the cross validation.
Its value ranges between 3 and the numbe rof subjects in the dataset</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_ncv">Ncv</code></td>
<td>
<p>Number of validations to be carried out. The default is 25.</p>
</td></tr>
<tr><td><code id="CVLasoelacox_+3A_nlambda">nlambda</code></td>
<td>
<p>The number of lambda values - default is 100 as in glmnet.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs the cross validations for Lasso, Elastic net and
Ridge regressions models for Cox proportional hazard model. Metabolites
are selected at each iteration and then use for the classifier.
This implies that predictive metabolites signature is varied from one
cross validation to the other depending on selection.
The underline idea is to investigate the Hazard Ratio for the train and
test data based on the optimal lambda selected for the
non-zero shrinkage coefficients, the nonzero selected metabolites will
thus be used in the survival analysis and in calculation of the risk
scores for each sets of data.
</p>


<h3>Value</h3>

<p>A object of class <code><a href="#topic+cvle">cvle</a></code> is
returned with the following values </p>

<ul>
<li><p>Coef.mat :A matrix of coefficients with rows equals to number
of cross validations and columns equals to number of metabolites.
</p>
</li>
<li><p>RuntimeA vector of runtime for each iteration measured in
seconds.
</p>
</li>
<li><p>lambdaA vector of estimated optimum lambda for each iterations.
</p>
</li>
<li><p>nA vector of the number of selected metabolites
</p>
</li>
<li><p>HRTrainA matrix of survival information for the training
dataset. It has three columns representing the estimated HR, the
95% lower confidence interval and the 95% upper confidence interval.
</p>
</li>
<li><p>HRTestA matrix of survival information for the test dataset.
It has three columns representing the estimated HR, the 95%
lower confidence interval and the 95% upper confidence interval.
</p>
</li>
<li><p>pldA vector of partial likelihood deviance at each cross
validations.
</p>
</li>
<li><p>Met.matA matrix with 0 and 1. Number of rows equals to
number of iterations and number of columns equals to number of
metabolites. 1 indicates that the particular metabolite was
selected or had nonzero coefficient and otherwise it is zero.
</p>
</li>
<li><p>MdataThe Metabolite data matrix that was used for the
analysis either same as Mdata or a reduced version.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>,
<code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>,
<code><a href="#topic+Lasoelacox">Lasoelacox</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Results = CVLasoelacox(Survival = Data$Survival,Censor = Data$Censor,
Mdata = t(Data$Mdata),Prognostic = Data$Prognostic, Quantile = 0.5,
Metlist = NULL,Standardize = TRUE, Reduce=FALSE, Select=15,
Alpha = 1,Fold = 4,Ncv = 10,nlambda = 100)

## NUMBER OF SELECTED METABOLITES PER CV
Results@n

## GET THE MATRIX OF COEFFICIENTS
Results@Coef.mat

## SURVIVAL INFORMATION OF THE TRAIN DATASET
Results@HRTrain

## SURVIVAL INFORMATION OF THE TEST DATASET
Results@HRTest

</code></pre>

<hr>
<h2 id='cvle'>Constructor for the cvle class</h2><span id='topic+cvle'></span>

<h3>Description</h3>

<p>Constructor for the cvle class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvle(Coef.mat, Runtime, lambda, n, Met.mat, HRTrain, HRTest, pld, Mdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvle_+3A_coef.mat">Coef.mat</code></td>
<td>
<p>A matrix of coefficients with rows equals to number of cross
validations and columns equals to number of metabolites.</p>
</td></tr>
<tr><td><code id="cvle_+3A_runtime">Runtime</code></td>
<td>
<p>A vector of runtime for each iteration measured in seconds.</p>
</td></tr>
<tr><td><code id="cvle_+3A_lambda">lambda</code></td>
<td>
<p>A vector of estimated optimum lambda for each iterations.</p>
</td></tr>
<tr><td><code id="cvle_+3A_n">n</code></td>
<td>
<p>A vector of the number of selected metabolites</p>
</td></tr>
<tr><td><code id="cvle_+3A_met.mat">Met.mat</code></td>
<td>
<p>A matrix with 0 and 1. Number of rows equals to number of
iterations and number of columns equals to number of metabolites. 1 indicates
that the particular metabolite was selected or had nonzero coefficient and
otherwise it is zero.</p>
</td></tr>
<tr><td><code id="cvle_+3A_hrtrain">HRTrain</code></td>
<td>
<p>A matrix of survival information for the training dataset.
It has three columns representing the estimated HR, the 95% lower confidence
interval and the 95% upper confidence interval.</p>
</td></tr>
<tr><td><code id="cvle_+3A_hrtest">HRTest</code></td>
<td>
<p>A matrix of survival information for the test dataset. It has
three columns representing the estimated HR, the 95% lower confidence
interval and the 95% upper confidence interval.</p>
</td></tr>
<tr><td><code id="cvle_+3A_pld">pld</code></td>
<td>
<p>A vector of partial likelihood deviance at each cross
validations.</p>
</td></tr>
<tr><td><code id="cvle_+3A_mdata">Mdata</code></td>
<td>
<p>The metabolite matrix that was used for the analysis which can
either be the full the full data or a reduced supervised PCA version.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class cvle
</p>

<hr>
<h2 id='cvle-class'>The cvle Class.</h2><span id='topic+cvle-class'></span>

<h3>Description</h3>

<p>The cvle Class.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Coef.mat</code></dt><dd><p>A matrix of coefficients with rows equals to number of
cross validations and columns equals to number of metabolites.</p>
</dd>
<dt><code>Runtime</code></dt><dd><p>A vector of runtime for each iteration measured in seconds.</p>
</dd>
<dt><code>lambda</code></dt><dd><p>A vector of estimated optimum lambda for each iterations.</p>
</dd>
<dt><code>n</code></dt><dd><p>A vector of the number of selected metabolites</p>
</dd>
<dt><code>Met.mat</code></dt><dd><p>A matrix with 0 and 1. Number of rows equals to number of
iterations and number of columns equals to number of metabolites.
1 indicates that the particular metabolite was selected or had
nonzero coefficient and otherwise it is zero.</p>
</dd>
<dt><code>HRTrain</code></dt><dd><p>A matrix of survival information for the training
dataset. It has three columns representing the estimated HR,
the 95% lower confidence interval and the 95% upper confidence interval.</p>
</dd>
<dt><code>HRTest</code></dt><dd><p>A matrix of survival information for the test dataset.
It has three columns representing the estimated HR, the 95% lower
confidence interval and the 95% upper confidence interval.</p>
</dd>
<dt><code>pld</code></dt><dd><p>A vector of partial likelihood deviance at each
cross validations.</p>
</dd>
<dt><code>Mdata</code></dt><dd><p>The metabolite matrix that was used for the analysis
which can either be the full the full data or a reduced
supervised PCA version.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>, <code><a href="#topic+Lasoelacox">Lasoelacox</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## GENERATE SOME METABOLIC SURVIVAL DATA WITH PROGNOSTIC FACTORS
Data&lt;-MSData(nPatients=100,nMet=150,Prop=0.5)

## USE THE FUNCTION
Eg = CVLasoelacox(Survival = Data$Survival,Censor = Data$Censor,
Mdata = t(Data$Mdata),Prognostic = Data$Prognostic, Quantile = 0.5,
Metlist = NULL,Standardize = TRUE, Reduce=FALSE, Select=15,
Alpha = 1,Fold = 4,Ncv = 10,nlambda = 100)

## GET THE CLASS OF THE OBJECT
class(Eg)     # An "cvle" Class

##  METHOD THAT CAN BE USED FOR THIS CLASS
show(Eg)
summary(Eg)
plot(Eg, type =3)

</code></pre>

<hr>
<h2 id='CVMajorityvotes'>Cross validation for majority votes</h2><span id='topic+CVMajorityvotes'></span>

<h3>Description</h3>

<p>This function does cross validation for the Majority votes based
classification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CVMajorityvotes(
  Survival,
  Censor,
  Prognostic = NULL,
  Mdata,
  Reduce = TRUE,
  Select = 15,
  Fold = 3,
  Ncv = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CVMajorityvotes_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number
of subjects</p>
</td></tr>
<tr><td><code id="CVMajorityvotes_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="CVMajorityvotes_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor
and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="CVMajorityvotes_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with
metabolic profiles where the number of rows should be equal to the number
of metabolites and number of columns should be equal to number of patients.</p>
</td></tr>
<tr><td><code id="CVMajorityvotes_+3A_reduce">Reduce</code></td>
<td>
<p>A boolean parameter indicating if the metabolic profile matrix
should be reduced, default is TRUE and larger metabolic profile matrix is
reduced by supervised pca approach and first pca is extracted from the
reduced matrix to be used in the classifier.</p>
</td></tr>
<tr><td><code id="CVMajorityvotes_+3A_select">Select</code></td>
<td>
<p>Number of metabolites (default is 15) to be selected from
supervised PCA. This is valid only if th argument Reduce=TRUE</p>
</td></tr>
<tr><td><code id="CVMajorityvotes_+3A_fold">Fold</code></td>
<td>
<p>Number of times in which the dataset is divided. Default is
3 which implies dataset will be divided into three groups and 2/3 of the
dataset will be the train datset and 1/3 will be to train the results.</p>
</td></tr>
<tr><td><code id="CVMajorityvotes_+3A_ncv">Ncv</code></td>
<td>
<p>The Number of cross validation loop. Default is 50 but it is
recommended to have at least 100.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function does cross validation for the Majority votes based
classification which is a cross validated approach to
<code><a href="#topic+Majorityvotes">Majorityvotes</a></code>.
</p>


<h3>Value</h3>

<p>A object of class <code><a href="#topic+cvmv">cvmv</a></code> is returned
with the following values
</p>
<table>
<tr><td><code>HRTrain</code></td>
<td>
<p>A matrix of survival information for the training dataset.
It has three columns representing the estimated HR, the 95% lower
confidence interval and the 95% upper confidence interval.</p>
</td></tr>
<tr><td><code>HRTest</code></td>
<td>
<p>A matrix of survival information for the test dataset.
It has three columns representing the estimated HR, the 95% lower
confidence interval and the 95% upper confidence interval.</p>
</td></tr>
<tr><td><code>Ncv</code></td>
<td>
<p>The number of cross validation used</p>
</td></tr>
<tr><td><code>Mdata</code></td>
<td>
<p>The Metabolite data matrix that was used for the analysis either same as Mdata or a reduced version.</p>
</td></tr>
<tr><td><code>Progfact</code></td>
<td>
<p>The names of prognostic factors used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Majorityvotes">Majorityvotes</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Result = CVMajorityvotes(Survival=Data$Survival,Censor=Data$Censor,
Prognostic=Data$Prognostic, Mdata=t(Data$Mdata), Reduce=FALSE,
Select=15, Fold=3, Ncv=10)

## GET THE CLASS OF THE OBJECT
class(Result)     # An "cvmv" Class

##  METHOD THAT CAN BE USED FOR THE RESULT
show(Result)
summary(Result)


</code></pre>

<hr>
<h2 id='CVMetSpecificCoxPh'>Cross validation for the Metabolite specific analysis</h2><span id='topic+CVMetSpecificCoxPh'></span>

<h3>Description</h3>

<p>The function performs cross validation for each metabolite depending the
number of fold which guides the division into the train and testing dataset.
The classifier is then obtained on the training dataset to be validated on
the test dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CVMetSpecificCoxPh(
  Fold = 3,
  Survival,
  Mdata,
  Censor,
  Reduce = TRUE,
  Select = 150,
  Prognostic = NULL,
  Quantile = 0.5,
  Ncv = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CVMetSpecificCoxPh_+3A_fold">Fold</code></td>
<td>
<p>Number of times in which the dataset is divided. Default is
3 which implies dataset will be divided into three groups and 2/3 of the
dataset will be the train datset and 1/3 will be to train the results.</p>
</td></tr>
<tr><td><code id="CVMetSpecificCoxPh_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number
of subjects</p>
</td></tr>
<tr><td><code id="CVMetSpecificCoxPh_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with
metabolic profiles where the number of rows should be equal to the
number of metabolites and number of columns should be equal to number
of patients.</p>
</td></tr>
<tr><td><code id="CVMetSpecificCoxPh_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="CVMetSpecificCoxPh_+3A_reduce">Reduce</code></td>
<td>
<p>A boolean parameter indicating if the metabolic profile
matrix should be reduced, default is TRUE and larger metabolic profile
matrix is reduced by supervised pca approach and first pca is extracted
from the reduced matrix to be used in the classifier.</p>
</td></tr>
<tr><td><code id="CVMetSpecificCoxPh_+3A_select">Select</code></td>
<td>
<p>Number of metabolites (default is 15) to be selected from
supervised PCA. This is valid only if th argument Reduce=TRUE</p>
</td></tr>
<tr><td><code id="CVMetSpecificCoxPh_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor
and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="CVMetSpecificCoxPh_+3A_quantile">Quantile</code></td>
<td>
<p>The cut off value for the classifier, default is the
median cutoff</p>
</td></tr>
<tr><td><code id="CVMetSpecificCoxPh_+3A_ncv">Ncv</code></td>
<td>
<p>The Number of cross validation loop. Default is 50 but it is
recommended to have at least 100.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs the cross validation for metabolite by metabolite
analysis. The data will firstly be divided into data train dataset and test
datset. Furthermore, a metabolite-specific model is fitted on train data and
a classifier is built. In addition, the classifier is then evaluated on test
dataset for each particular metabolite. The Process is repeated for all the
full or reduced metabolites to obtaind the HR statistics of the low risk
group. The following steps depends on the number of cross validation
specified.
</p>


<h3>Value</h3>

<p>A object of class <code><a href="#topic+cvmm">cvmm</a></code> is returned
with the following values
</p>
<table>
<tr><td><code>HRTrain</code></td>
<td>
<p>The Train dataset HR statistics for each metabolite by
the number of CV</p>
</td></tr>
<tr><td><code>HRTest</code></td>
<td>
<p>The Test dataset HR statistics for each metabolite by
the number of CV</p>
</td></tr>
<tr><td><code>train</code></td>
<td>
<p>The selected subjects for each CV in the train dataset</p>
</td></tr>
<tr><td><code>train</code></td>
<td>
<p>The selected subjects for each CV in the test dataset</p>
</td></tr>
<tr><td><code>n.mets</code></td>
<td>
<p>The number of metabolite used in the analysis</p>
</td></tr>
<tr><td><code>Ncv</code></td>
<td>
<p>The number of cross validation performed</p>
</td></tr>
<tr><td><code>Rdata</code></td>
<td>
<p>The Metabolite data matrix that was used for the analysis
either same as Mdata or a reduced version.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>,
<code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="#topic+MSpecificCoxPh">MSpecificCoxPh</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Result = CVMetSpecificCoxPh(Fold=3,Survival=Data$Survival,
Mdata=t(Data$Mdata),Censor= Data$Censor,Reduce=TRUE,
Select=150,Prognostic=Data$Prognostic,Quantile = 0.5,Ncv=3)

## GET THE CLASS OF THE OBJECT
class(Result)     # An "cvmm" Class

##  METHOD THAT CAN BE USED FOR THE RESULT
show(Result)
summary(Result)
plot(Result)

</code></pre>

<hr>
<h2 id='cvmm'>Constructor for the cvmm class</h2><span id='topic+cvmm'></span>

<h3>Description</h3>

<p>Constructor for the cvmm class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvmm(HRTrain, HRTest, train, test, n.mets, Ncv, Rdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvmm_+3A_hrtrain">HRTrain</code></td>
<td>
<p>A 3-way array, The first dimension is the number of metabolites, the second dimension is the HR statistics for the low risk group in the train dataset (HR,1/HR LCI, UCI) while the third dimension is the number of cross validation performed.</p>
</td></tr>
<tr><td><code id="cvmm_+3A_hrtest">HRTest</code></td>
<td>
<p>A 3-way array, The first dimension is the number of metabolites,
the second dimension is the HR statistics for the low risk group in the test
dataset (HR,1/HR LCI, UCI) while the third dimension is the number of
cross validation performed.</p>
</td></tr>
<tr><td><code id="cvmm_+3A_train">train</code></td>
<td>
<p>The selected subjects for each CV in the train dataset</p>
</td></tr>
<tr><td><code id="cvmm_+3A_test">test</code></td>
<td>
<p>The selected subjects for each CV in the test dataset</p>
</td></tr>
<tr><td><code id="cvmm_+3A_n.mets">n.mets</code></td>
<td>
<p>The number of metabolite used in the analysis</p>
</td></tr>
<tr><td><code id="cvmm_+3A_ncv">Ncv</code></td>
<td>
<p>The number of cross validation performed</p>
</td></tr>
<tr><td><code id="cvmm_+3A_rdata">Rdata</code></td>
<td>
<p>The Metabolite data matrix that was used for the analysis either
same as Mdata or a reduced version</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class cvmm
</p>

<hr>
<h2 id='cvmm-class'>The cvmm Class.</h2><span id='topic+cvmm-class'></span>

<h3>Description</h3>

<p>The cvmm Class.
</p>


<h3>Slots</h3>


<dl>
<dt><code>HRTrain</code></dt><dd><p>A 3-way array, The first dimension is the number of metabolites, the second dimension is the HR statistics for the low risk group in the train dataset (HR,1/HR LCI, UCI) while the third dimension is the number of cross validation performed.</p>
</dd>
<dt><code>HRTest</code></dt><dd><p>A 3-way array, The first dimension is the number of metabolites,
the second dimension is the HR statistics for the low risk group in the test
dataset (HR,1/HR LCI, UCI) while the third dimension is the number of
cross validation performed.</p>
</dd>
<dt><code>train</code></dt><dd><p>The selected subjects for each CV in the train dataset</p>
</dd>
<dt><code>test</code></dt><dd><p>The selected subjects for each CV in the test dataset</p>
</dd>
<dt><code>n.mets</code></dt><dd><p>The number of metabolite used in the analysis</p>
</dd>
<dt><code>Ncv</code></dt><dd><p>The number of cross validation performed</p>
</dd>
<dt><code>Rdata</code></dt><dd><p>The Metabolite data matrix that was used for the analysis either
same as Mdata or a reduced version</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CVMetSpecificCoxPh">CVMetSpecificCoxPh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## GENERATE SOME METABOLIC SURVIVAL DATA WITH PROGNOSTIC FACTORS
Data&lt;-MSData(nPatients=100,nMet=150,Prop=0.5)

## USING THE FUNCTION
Result = CVMetSpecificCoxPh(Fold=3,Survival=Data$Survival,
Mdata=t(Data$Mdata),Censor= Data$Censor,Reduce=TRUE,
Select=150,Prognostic=Data$Prognostic,Quantile = 0.5,Ncv=3)

## GET THE CLASS OF THE OBJECT
class(Result)     # An "cvmm" Class

##  METHOD THAT CAN BE USED FOR THIS CLASS
show(Result)
summary(Result)
plot(Result)

</code></pre>

<hr>
<h2 id='cvmv'>Constructor for the cvmv class</h2><span id='topic+cvmv'></span>

<h3>Description</h3>

<p>Constructor for the cvmv class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvmv(HRTrain, HRTest, Ncv, Mdata, Progfact)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvmv_+3A_hrtrain">HRTrain</code></td>
<td>
<p>A matrix of survival information for the training dataset.
It has three columns representing the estimated HR, the 95% lower
confidence interval and the 95% upper confidence interval.</p>
</td></tr>
<tr><td><code id="cvmv_+3A_hrtest">HRTest</code></td>
<td>
<p>A matrix of survival information for the test dataset.
It has three columns representing the estimated HR, the 95%
lower confidence interval and the 95% upper confidence interval.</p>
</td></tr>
<tr><td><code id="cvmv_+3A_ncv">Ncv</code></td>
<td>
<p>The number of cross validation used</p>
</td></tr>
<tr><td><code id="cvmv_+3A_mdata">Mdata</code></td>
<td>
<p>The Metabolite data matrix that was used for the analysis
either same as Mdata or a reduced version.</p>
</td></tr>
<tr><td><code id="cvmv_+3A_progfact">Progfact</code></td>
<td>
<p>The names of prognostic factors used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class cvmv
</p>

<hr>
<h2 id='cvmv-class'>The cvmv Class.</h2><span id='topic+cvmv-class'></span>

<h3>Description</h3>

<p>The cvmv Class.
</p>


<h3>Slots</h3>


<dl>
<dt><code>HRTrain</code></dt><dd><p>A matrix of survival information for the training dataset.
It has three columns representing the estimated HR, the 95% lower
confidence interval and the 95% upper confidence interval.</p>
</dd>
<dt><code>HRTest</code></dt><dd><p>A matrix of survival information for the test dataset.
It has three columns representing the estimated HR, the 95% lower
confidence interval and the 95% upper confidence interval.</p>
</dd>
<dt><code>Ncv</code></dt><dd><p>The number of cross validation used</p>
</dd>
<dt><code>Mdata</code></dt><dd><p>The Metabolite data matrix that was used for the analysis either
same as Mdata or a reduced version.</p>
</dd>
<dt><code>Progfact</code></dt><dd><p>The names of prognostic factors used</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Majorityvotes">Majorityvotes</a></code>, <code><a href="#topic+CVPcaPls">CVPcaPls</a></code>, <code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code>, <code><a href="#topic+SurvPlsClass">SurvPlsClass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## GENERATE SOME METABOLIC SURVIVAL DATA WITH PROGNOSTIC FACTORS
Data&lt;-MSData(nPatients=100,nMet=150,Prop=0.5)

## USING THE FUNCTION
Result = CVMajorityvotes(Survival=Data$Survival,Censor=Data$Censor,
Prognostic=Data$Prognostic, Mdata=t(Data$Mdata), Reduce=FALSE,
Select=15, Fold=3, Ncv=10)

## GET THE CLASS OF THE OBJECT
class(Result)     # A "cvmv" Class

##  METHOD THAT CAN BE USED FOR THE RESULT
show(Result)
summary(Result)


</code></pre>

<hr>
<h2 id='CVPcaPls'>Cross Validations for PCA and PLS based methods</h2><span id='topic+CVPcaPls'></span>

<h3>Description</h3>

<p>This function does cross validation  for the analysis performs by <code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code> and <code><a href="#topic+SurvPlsClass">SurvPlsClass</a></code> functions where the dimension reduction methods can either be PCA and PLS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CVPcaPls(
  Fold = 3,
  Survival,
  Mdata,
  Censor,
  Reduce = TRUE,
  Select = 15,
  Prognostic = NULL,
  Ncv = 5,
  DR = "PCA"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CVPcaPls_+3A_fold">Fold</code></td>
<td>
<p>Number of times in which the dataset is divided. Default is 3 which implies dataset will be divided into three groups and 2/3 of the dataset will be the train datset and 1/3 will be to train the results.</p>
</td></tr>
<tr><td><code id="CVPcaPls_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td></tr>
<tr><td><code id="CVPcaPls_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with metabolic profiles where the number of rows should be equal to the number of metabolites and number of columns should be equal to number of patients.</p>
</td></tr>
<tr><td><code id="CVPcaPls_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="CVPcaPls_+3A_reduce">Reduce</code></td>
<td>
<p>A boolean parameter indicating if the metabolic profile matrix should be reduced, default is TRUE and larger metabolic profile matrix is reduced by supervised pca approach and first pca is extracted from the reduced matrix to be used in the classifier.</p>
</td></tr>
<tr><td><code id="CVPcaPls_+3A_select">Select</code></td>
<td>
<p>Number of metabolites (default is 15) to be selected from supervised PCA. This is valid only if th argument Reduce=TRUE</p>
</td></tr>
<tr><td><code id="CVPcaPls_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="CVPcaPls_+3A_ncv">Ncv</code></td>
<td>
<p>The Number of cross validation loop. Default is 50 but it is recommended to have at least 100.</p>
</td></tr>
<tr><td><code id="CVPcaPls_+3A_dr">DR</code></td>
<td>
<p>The dimension reduction method. It can be either &quot;PCA&quot; for Principle components analysis or &quot;PLS&quot; for Partial least squares.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function does cross validation for the analysis using two reduction method. The reduction method can be PCA or PLS. If it is PCA then the <code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code> is internally used for the cross validation and <code><a href="#topic+SurvPlsClass">SurvPlsClass</a></code> otherwise.
</p>


<h3>Value</h3>

<p>A object of class <code><a href="#topic+cvpp">cvpp</a></code> is returned with the following values
</p>
<table>
<tr><td><code>Result</code></td>
<td>
<p>A dataframe containg the estimated Hazard ratio of the test dataset and the training dataset</p>
</td></tr>
<tr><td><code>Ncv</code></td>
<td>
<p>The number of cross validation performed</p>
</td></tr>
<tr><td><code>Method</code></td>
<td>
<p>The dimesion reduction method used</p>
</td></tr>
<tr><td><code>CVtrain</code></td>
<td>
<p>The training dataset indices matrix used for the cross validation</p>
</td></tr>
<tr><td><code>CVtest</code></td>
<td>
<p>The test dataset indices matrix used for the cross validation</p>
</td></tr>
<tr><td><code>Select</code></td>
<td>
<p>The number of metabolite used for the dimesion reduction method used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>References</h3>

<p>Bair E, Hastie T, Debashis P, Tibshirani R (2006).
&ldquo;Prediction by supervised principal components.&rdquo;
<em>American Statistics Association,</em>, <b>101</b>(473), 119&ndash;137.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SurvPlsClass">SurvPlsClass</a></code>,
<code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Result = CVPcaPls(Fold = 4, Survival = Data$Survival,
Mdata = t(Data$Mdata), Censor = Data$Censor, Reduce=TRUE,
Select=19, Prognostic= Data$Prognostic,Ncv=55,DR ="PLS")

## GET THE CLASS OF THE OBJECT
class(Result)     # An "cvpp" Class

##  METHOD THAT CAN BE USED FOR THE RESULT
show(Result)
summary(Result)
plot(Result)
</code></pre>

<hr>
<h2 id='cvpp'>Constructor for the cvpp class</h2><span id='topic+cvpp'></span>

<h3>Description</h3>

<p>Constructor for the cvpp class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvpp(Results, Ncv, Method, CVtrain, CVtest, Nmet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvpp_+3A_results">Results</code></td>
<td>
<p>A dataframe containg the estimated Hazard ratio of the
test dataset and the training dataset</p>
</td></tr>
<tr><td><code id="cvpp_+3A_ncv">Ncv</code></td>
<td>
<p>The number of cross validation performed</p>
</td></tr>
<tr><td><code id="cvpp_+3A_method">Method</code></td>
<td>
<p>The dimesion reduction method used</p>
</td></tr>
<tr><td><code id="cvpp_+3A_cvtrain">CVtrain</code></td>
<td>
<p>The training dataset indices matrix used for the cross
validation</p>
</td></tr>
<tr><td><code id="cvpp_+3A_cvtest">CVtest</code></td>
<td>
<p>The test dataset indices matrix used for the cross
validation</p>
</td></tr>
<tr><td><code id="cvpp_+3A_nmet">Nmet</code></td>
<td>
<p>The number of metabolite used for the dimesion reduction
method used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class cvpp
</p>

<hr>
<h2 id='cvpp-class'>The cvpp Class.</h2><span id='topic+cvpp-class'></span>

<h3>Description</h3>

<p>The cvpp Class.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Results</code></dt><dd><p>A dataframe containg the estimated Hazard ratio of the test
dataset and the training dataset</p>
</dd>
<dt><code>Ncv</code></dt><dd><p>The number of cross validation performed</p>
</dd>
<dt><code>Method</code></dt><dd><p>The dimesion reduction method used</p>
</dd>
<dt><code>CVtrain</code></dt><dd><p>The training dataset indices matrix used for the cross
validation</p>
</dd>
<dt><code>CVtest</code></dt><dd><p>The test dataset indices matrix used for the cross validation</p>
</dd>
<dt><code>Nmet</code></dt><dd><p>The number of metabolite used for the dimesion reduction method
used</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CVPcaPls">CVPcaPls</a></code>, <code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code>, <code><a href="#topic+SurvPlsClass">SurvPlsClass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## GENERATE SOME METABOLIC SURVIVAL DATA WITH PROGNOSTIC FACTORS
Data&lt;-MSData(nPatients=100,nMet=150,Prop=0.5)

## USING THE FUNCTION
Result = CVPcaPls(Fold = 4, Survival = Data$Survival,
Mdata = t(Data$Mdata), Censor = Data$Censor, Reduce=TRUE,
Select=19, Prognostic= Data$Prognostic,Ncv=55,DR ="PLS")

## GET THE CLASS OF THE OBJECT
class(Result)     # A "cvpp" Class

##  METHOD THAT CAN BE USED FOR THE RESULT
show(Result)
summary(Result)
plot(Result)
</code></pre>

<hr>
<h2 id='cvsim'>Constructor for the cvsim class</h2><span id='topic+cvsim'></span>

<h3>Description</h3>

<p>Constructor for the cvsim class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvsim(HRpca, HRpls, Nmets, Ncv, Top)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvsim_+3A_hrpca">HRpca</code></td>
<td>
<p>A 3-way array in which first, second, and third
dimensions correspond to number of metabolites, Hazard ratio
infromation(Estimated HR, LowerCI and UpperCI),
and number of cross validation respectively.
This contains the estimated HR on test data and
dimension reduction method is PCA.</p>
</td></tr>
<tr><td><code id="cvsim_+3A_hrpls">HRpls</code></td>
<td>
<p>A 3-way array in which first, second, and
third dimensions correspond to number of metabolites,
Hazard ratio infromation(Estimated HR, LowerCI and UpperCI),
and number of cross validation respectively. This contains the
estimated HR on test data and dimension reduction method is
PLS.</p>
</td></tr>
<tr><td><code id="cvsim_+3A_nmets">Nmets</code></td>
<td>
<p>The number of metabolites in the reduced matrix</p>
</td></tr>
<tr><td><code id="cvsim_+3A_ncv">Ncv</code></td>
<td>
<p>The number of cross validation done</p>
</td></tr>
<tr><td><code id="cvsim_+3A_top">Top</code></td>
<td>
<p>A sequence of top k metabolites considered.
Default is Top=seq(5,100,by=5)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class cvsim
</p>

<hr>
<h2 id='cvsim-class'>The cvsim Class.</h2><span id='topic+cvsim-class'></span>

<h3>Description</h3>

<p>The cvsim Class.
</p>


<h3>Slots</h3>


<dl>
<dt><code>HRpca</code></dt><dd><p>A 3-way array in which first, second, and third
dimensions correspond to number of metabolites, Hazard ratio
infromation(Estimated HR, LowerCI and UpperCI),
and number of cross validation respectively.
This contains the estimated HR on test data and
dimension reduction method is PCA.</p>
</dd>
<dt><code>HRpls</code></dt><dd><p>A 3-way array in which first, second, and third
dimensions correspond to number of metabolites,
Hazard ratio infromation(Estimated HR, LowerCI and UpperCI),
and number of cross validation respectively.
This contains the estimated HR on test data and dimension
reduction method is PLS.</p>
</dd>
<dt><code>Nmets</code></dt><dd><p>The number of metabolites in the reduced matrix</p>
</dd>
<dt><code>Ncv</code></dt><dd><p>The number of cross validation done</p>
</dd>
<dt><code>Top</code></dt><dd><p>A sequence of top k metabolites considered.
Default is Top=seq(5,100,by=5)</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CVPcaPls">CVPcaPls</a></code>, <code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code>, <code><a href="#topic+SurvPlsClass">SurvPlsClass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## GENERATE SOME METABOLIC SURVIVAL DATA WITH PROGNOSTIC FACTORS
Data&lt;-MSData(nPatients=100,nMet=150,Prop=0.5)

## FIRST IS THE NETABOLITE BY METABOLITE ANALYSIS
w = CVMetSpecificCoxPh(Fold=3,Survival=Data$Survival,
Mdata=t(Data$Mdata),Censor= Data$Censor,Reduce=TRUE,
Select=150,Prognostic=Data$Prognostic,Quantile = 0.5,Ncv=3)

## USING THE FUNCTION
Result = CVSimet(w, Top = seq(5, 100, by = 5), Survival=Data$Survival,
 Censor=Data$Censor, Prognostic = Data$Prognostic)

## GET THE CLASS OF THE OBJECT
class(Result)     # A "cvsim" Class

##  METHOD THAT CAN BE USED FOR THE RESULT
show(Result)
summary(Result)
plot(Result, type =2)

</code></pre>

<hr>
<h2 id='CVSimet'>Cross validation for sequentially increases metabolites</h2><span id='topic+CVSimet'></span>

<h3>Description</h3>

<p>This function does cross validation for the metabolite by metabolite analysis while sequentially increasing the number of metabolites as specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CVSimet(Object, Top = seq(5, 100, by = 5), Survival, Censor, Prognostic = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CVSimet_+3A_object">Object</code></td>
<td>
<p>An object of class <code><a href="#topic+cvmm">cvmm</a></code></p>
</td></tr>
<tr><td><code id="CVSimet_+3A_top">Top</code></td>
<td>
<p>The Top k number of metabolites to be used</p>
</td></tr>
<tr><td><code id="CVSimet_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td></tr>
<tr><td><code id="CVSimet_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="CVSimet_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function firstly processes the cross validation for the metabolite by metabolite  analysis results, and then sequentially considers top k metabolites. The function recompute first PCA or PLS on train data and estimate risk scores on both test and train data only on the metabolite matrix with top k metabolites. Patients are then classified as having low or high risk based on the test data where the cutoff used is median of the risk score. The process is repeated for each top K metabolite sets.
</p>


<h3>Value</h3>

<p>A object of class <code><a href="#topic+cvsim">cvsim</a></code> is returned with the following values
</p>
<table>
<tr><td><code>HRpca</code></td>
<td>
<p>A 3-way array in which first, second, and third dimensions correspond to number of metabolites, Hazard ratio infromation(Estimated HR, LowerCI and UpperCI), and number of cross validation respectively. This contains the estimated HR on test data and dimension reduction method is PCA.</p>
</td></tr>
<tr><td><code>HRpls</code></td>
<td>
<p>A 3-way array in which first, second, and third dimensions correspond to number of metabolites, Hazard ratio infromation(Estimated HR, LowerCI and UpperCI), and number of cross validation respectively. This contains the estimated HR on test data and dimension reduction method is PLS.</p>
</td></tr>
<tr><td><code>Nmets</code></td>
<td>
<p>The number of metabolites in the reduced matrix</p>
</td></tr>
<tr><td><code>Ncv</code></td>
<td>
<p>The number of cross validation done</p>
</td></tr>
<tr><td><code>Top</code></td>
<td>
<p>A sequence of top k metabolites considered. Default is Top=seq(5,100,by=5)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MSpecificCoxPh">MSpecificCoxPh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## GETTING THE cvmm OBJECT
Result = CVMetSpecificCoxPh(Fold=3,Survival=Data$Survival,
Mdata=t(Data$Mdata),Censor= Data$Censor,Reduce=TRUE,Select=150,
Prognostic=Data$Prognostic,Quantile = 0.5,Ncv=3)

## USING THE FUNCTION
 Result2 = CVSimet(Result, Top = seq(5, 100, by = 5), Data$Survival,
 Data$Censor,Prognostic = Data$Prognostic)

## GET THE CLASS OF THE OBJECT
class(Result2)     # An "cvsim" Class

</code></pre>

<hr>
<h2 id='DataHR'>Survival and Prognostic Data .</h2><span id='topic+DataHR'></span>

<h3>Description</h3>

<p>A dataset containing the riskscore, survival parameters (Overall survival and censoring indicator) and other pronostic factors of 149 subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DataHR)
</code></pre>


<h3>Format</h3>

<p>A data frame with 149 rows and 5 variables:
</p>

<dl>
<dt>Riskscore</dt><dd><p>Riskscores of the subjects</p>
</dd>
<dt>Survival</dt><dd><p>Overall survival of the subjects</p>
</dd>
<dt>Censor</dt><dd><p>Censoring indicator for all the patients; 1= Dead and 0 = Alive</p>
</dd>
<dt>Gender</dt><dd><p>The first prognostic factor which is the gender of  all the patients; 1=Male and 0 = Female</p>
</dd>
<dt>Stage</dt><dd><p>The second prognostic factor which is the cancer stage of all the patients; 1= Early stage and 0= Advanced stage</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p><a href="https://bmccancer.biomedcentral.com/articles/10.1186/s12885-018-4755-1">https://bmccancer.biomedcentral.com/articles/10.1186/s12885-018-4755-1</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DataHR)
summary(DataHR[,1:2])
</code></pre>

<hr>
<h2 id='DistHR'>Null Distribution of the Estimated HR</h2><span id='topic+DistHR'></span>

<h3>Description</h3>

<p>This function generates the null distribution of the HR by permutation approach. Several ways of permutation setting can be implemented. That is, function can be used to generate null distributions for four different validation schemes, PLS based, PCA based, Majority votes based and Lasso based.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DistHR(
  Survival,
  Censor,
  Mdata,
  Prognostic = NULL,
  Quantile = 0.5,
  Reduce = FALSE,
  Select = 15,
  nperm = 100,
  case = 2,
  Validation = c("PLSbased", "PCAbased", "L1based", "MVbased")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DistHR_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td></tr>
<tr><td><code id="DistHR_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="DistHR_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with metabolic profiles where the number of rows should be equal to the number of metabolites and number of columns should be equal to number of patients.</p>
</td></tr>
<tr><td><code id="DistHR_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="DistHR_+3A_quantile">Quantile</code></td>
<td>
<p>The cut off value for the classifier, default is the median cutoff</p>
</td></tr>
<tr><td><code id="DistHR_+3A_reduce">Reduce</code></td>
<td>
<p>A boolean parameter indicating if the metabolic profile matrix should be reduced, default is TRUE and larger metabolic profile matrix is reduced by supervised pca approach and first pca is extracted from the reduced matrix to be used in the classifier.</p>
</td></tr>
<tr><td><code id="DistHR_+3A_select">Select</code></td>
<td>
<p>Number of metabolites (default is 15) to be selected from supervised PCA. This is valid only if the argument Reduce=TRUE</p>
</td></tr>
<tr><td><code id="DistHR_+3A_nperm">nperm</code></td>
<td>
<p>Number of permutations to be used and default 100</p>
</td></tr>
<tr><td><code id="DistHR_+3A_case">case</code></td>
<td>
<p>There are seven different ways on how to call this argument:
</p>

<ol>
<li><p>Permute survival only.
</p>
</li>
<li><p>Permute survival and rows of data frame of the prognostic factors.
</p>
</li>
<li><p>Permute survival, rows of data frame of the prognostic factors, columns of metabolite matrix independently.
</p>
</li>
<li><p>Permute metabolite matrix only.
</p>
</li></ol>
</td></tr>
<tr><td><code id="DistHR_+3A_validation">Validation</code></td>
<td>
<p>There are four different validation schemes where the null distribution can be estimated. That is c(&quot;PLSbased&quot;,&quot;PCAbased&quot;,&quot;L1based&quot;,&quot;MVbased&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates the null distribution of the HR by permutation approach either using a large metabolite matrix or a reduced version by supervised pca approach. Several ways of permutation setting can be implemented. That is, the function can be used to generate null distributions for four different validation schemes which are PLS based, PCA based, Majority votes based and Lasso based. Note this function internally calls function  <code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code>, <code><a href="#topic+SurvPlsClass">SurvPlsClass</a></code>, <code><a href="#topic+Majorityvotes">Majorityvotes</a></code>, and <code><a href="#topic+Lasoelacox">Lasoelacox</a></code>.
</p>


<h3>Value</h3>

<p>A object of class <code><a href="#topic+perm">perm</a></code> is returned with the following values
</p>
<table>
<tr><td><code>HRobs</code></td>
<td>
<p>Estimated HR for low risk group on the original data</p>
</td></tr>
<tr><td><code>HRperm</code></td>
<td>
<p>Estimated HR for low risk group on the permuted data</p>
</td></tr>
<tr><td><code>nperm</code></td>
<td>
<p>Number of permutations carried out</p>
</td></tr>
<tr><td><code>Validation</code></td>
<td>
<p>The validation scheme that was used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>, <code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code>, <code><a href="#topic+SurvPlsClass">SurvPlsClass</a></code>, <code><a href="#topic+Majorityvotes">Majorityvotes</a></code>, <code><a href="#topic+Lasoelacox">Lasoelacox</a></code>, <code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="#topic+Lasoelacox">Lasoelacox</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Example &lt;- DistHR(Survival = Data$Survival,Mdata = t(Data$Mdata),
Censor = Data$Censor,Reduce=FALSE,Select=15,Prognostic=Data$Prognostic,
Quantile = 0.5, nperm=10, case=2, Validation=c("L1based"))

</code></pre>

<hr>
<h2 id='EstimateHR'>Classification, Survival Estimation and Visualization</h2><span id='topic+EstimateHR'></span>

<h3>Description</h3>

<p>The Function  classifies subjects into low and high risk group using the risk scores based on the cut-off percentile specified. It also visualize survival fit along with HR estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EstimateHR(
  Risk.Scores,
  Data.Survival,
  Prognostic = NULL,
  Plots = FALSE,
  Quantile = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EstimateHR_+3A_risk.scores">Risk.Scores</code></td>
<td>
<p>A vector of risk scores with size equals to number of subjects</p>
</td></tr>
<tr><td><code id="EstimateHR_+3A_data.survival">Data.Survival</code></td>
<td>
<p>A dataframe in which the first column is the survival time and the second column is the Censoring indicator for each subject.</p>
</td></tr>
<tr><td><code id="EstimateHR_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect</p>
</td></tr>
<tr><td><code id="EstimateHR_+3A_plots">Plots</code></td>
<td>
<p>A boolean parameter indicating if plots should be shown. Default is FALSE</p>
</td></tr>
<tr><td><code id="EstimateHR_+3A_quantile">Quantile</code></td>
<td>
<p>The cut off value for the classifier, default is the median cutoff</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The risk scores obtained using the signature is used to generate the risk group by dividing subjects into low and high risk group. A Cox model is then fitted with the risk group as covariate in the presence or absence of  prognostic factors and or treatment effect. The extent of survival in the risk groups is known.
</p>


<h3>Value</h3>

<p>An object of is returned, which is a list with the results of the cox regression and some informative plot concerning survival of the risk group.
</p>
<table>
<tr><td><code>SurvResult</code></td>
<td>
<p>The cox proportional regression result</p>
</td></tr>
<tr><td><code>Riskgroup</code></td>
<td>
<p>The riskgroup based on the riskscore and the cut off value and length is equal to number of subjects</p>
</td></tr>
<tr><td><code>KMplot</code></td>
<td>
<p>The Kaplan-Meier survival plot of the riskgroup</p>
</td></tr>
<tr><td><code>SurvBPlot</code></td>
<td>
<p>The distribution of the survival in the riskgroup</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Classification and estimating with prognostic factors
data(DataHR)
Result = EstimateHR(Risk.Scores=DataHR[,1],Data.Survival=DataHR[,2:3]
,Prognostic=DataHR[,4:5],Plots=FALSE,Quantile=0.50)

### Classification and estimating without prognostic factors
data(DataHR)
Result = EstimateHR(Risk.Scores=DataHR[,1],Data.Survival=DataHR[,2:3]
,Prognostic=NULL,Plots=FALSE,Quantile=0.50)
</code></pre>

<hr>
<h2 id='fcv'>Constructor for the fcv class</h2><span id='topic+fcv'></span>

<h3>Description</h3>

<p>Constructor for the fcv class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fcv(Runtime, Fold, Ncv, Nicv, TopK, HRInner, HRTest, Weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fcv_+3A_runtime">Runtime</code></td>
<td>
<p>A vector of runtime for each iteration measured in seconds.</p>
</td></tr>
<tr><td><code id="fcv_+3A_fold">Fold</code></td>
<td>
<p>Number of folds used.</p>
</td></tr>
<tr><td><code id="fcv_+3A_ncv">Ncv</code></td>
<td>
<p>Number of outer cross validations used.</p>
</td></tr>
<tr><td><code id="fcv_+3A_nicv">Nicv</code></td>
<td>
<p>Number of inner cross validations used.</p>
</td></tr>
<tr><td><code id="fcv_+3A_topk">TopK</code></td>
<td>
<p>The Top metabolites used</p>
</td></tr>
<tr><td><code id="fcv_+3A_hrinner">HRInner</code></td>
<td>
<p>A 3-way array in which first, second, and third dimensions
correspond to Nicv, 1, and Ncv respectively. This contains estimated HR
for low risk group on the out of bag data.</p>
</td></tr>
<tr><td><code id="fcv_+3A_hrtest">HRTest</code></td>
<td>
<p>A matrix of survival information for the test dataset based on
the out of bag data. It has three columns representing the estimated HR,
the 95% lower confidence interval and the 95% upper confidence interval.</p>
</td></tr>
<tr><td><code id="fcv_+3A_weight">Weight</code></td>
<td>
<p>A matrix with columns equals number of TopK metabolites and
rows Ncv. Note that Weights are estimated as colMeans of
coefficients matrix return from the inner cross validations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class fcv
</p>

<hr>
<h2 id='fcv-class'>The fcv Class.</h2><span id='topic+fcv-class'></span>

<h3>Description</h3>

<p>The fcv Class.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Runtime</code></dt><dd><p>A vector of runtime for each iteration measured in seconds.</p>
</dd>
<dt><code>Fold</code></dt><dd><p>Number of folds used.</p>
</dd>
<dt><code>Ncv</code></dt><dd><p>Number of outer cross validations used.</p>
</dd>
<dt><code>Nicv</code></dt><dd><p>Number of inner cross validations used.</p>
</dd>
<dt><code>TopK</code></dt><dd><p>The Top metabolites used</p>
</dd>
<dt><code>HRInner</code></dt><dd><p>A 3-way array in which first, second, and third dimensions
correspond to Nicv, 1, and Ncv respectively. This contains estimated HR
for low risk group on the out of bag data.</p>
</dd>
<dt><code>HRTest</code></dt><dd><p>A matrix of survival information for the test dataset based
on the out of bag data. It has three columns representing the estimated HR,
the 95% lower confidence interval and the 95% upper confidence interval.</p>
</dd>
<dt><code>Weight</code></dt><dd><p>A matrix with columns equals number of TopK metabolites and
rows Ncv. Note that Weights are estimated as colMeans of coefficients
matrix return from the inner cross validations.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CVLasoelacox">CVLasoelacox</a></code>,
<code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>, <code><a href="#topic+Lasoelacox">Lasoelacox</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## GENERATE SOME METABOLIC SURVIVAL DATA WITH PROGNOSTIC FACTORS
Data&lt;-MSData(nPatients=100,nMet=150,Prop=0.5)

## USE THE FUNCTION
Eg = Icvlasoel(Data$Survival, Data$Censor, Data$Prognostic,
t(Data$Mdata), Fold = 3,Ncv = 5, Nicv = 7, Alpha = 1,
TopK = colnames(Data$Mdata[,80:100]), Weights = FALSE)

## GET THE CLASS OF THE OBJECT
class(Eg)     # An "fcv" Class

##  METHOD THAT CAN BE USED FOR THIS CLASS
show(Eg)
summary(Eg)
plot(Eg, type =1)

</code></pre>

<hr>
<h2 id='Icvlasoel'>Inner and Outer Cross Validations for Lasso Elastic Net Survival predictive models and Classification</h2><span id='topic+Icvlasoel'></span>

<h3>Description</h3>

<p>The function does cross validation for Lasso, Elastic net and Ridge regressions models based on fixed or top selected metabolites from <code><a href="#topic+CVLasoelacox">CVLasoelacox</a></code> with classifier validated on a independent sample for the survial analysis and classification. The survival analysis is based on the selected metabolites in the presence or absene of prognostic factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Icvlasoel(
  Survival,
  Censor,
  Prognostic = NULL,
  Mdata,
  Fold = 3,
  Ncv = 50,
  Nicv = 100,
  Alpha = 0.1,
  TopK,
  Weights = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Icvlasoel_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td></tr>
<tr><td><code id="Icvlasoel_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="Icvlasoel_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="Icvlasoel_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with metabolic profiles where the number of rows should be equal to the number of metabolites and number of columns should be equal to number of patients.</p>
</td></tr>
<tr><td><code id="Icvlasoel_+3A_fold">Fold</code></td>
<td>
<p>number of folds to be used for the cross validation. Its value ranges between 3 and the numbe rof subjects in the dataset</p>
</td></tr>
<tr><td><code id="Icvlasoel_+3A_ncv">Ncv</code></td>
<td>
<p>Number of validations to be carried out. The default is 25.</p>
</td></tr>
<tr><td><code id="Icvlasoel_+3A_nicv">Nicv</code></td>
<td>
<p>Number of validations to be carried out for the inner loop. The default is 5.</p>
</td></tr>
<tr><td><code id="Icvlasoel_+3A_alpha">Alpha</code></td>
<td>
<p>The mixing parameter for glmnet (see <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>). The range is 0&lt;= Alpha &lt;= 1. The Default is 1</p>
</td></tr>
<tr><td><code id="Icvlasoel_+3A_topk">TopK</code></td>
<td>
<p>Top list of metabolites. Usually this can be mostly selected metabolites by function <code><a href="#topic+CVLasoelacox">CVLasoelacox</a></code>.</p>
</td></tr>
<tr><td><code id="Icvlasoel_+3A_weights">Weights</code></td>
<td>
<p>A logical flag indicating if a fixed or non-fixed weights should be used during the classifier evaluations. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function does cross validation for Lasso, Elastic net and Ridge regressions models based on fixed or top selected metabolites from <code><a href="#topic+CVLasoelacox">CVLasoelacox</a></code> with classifier validated on a independent sample for the survial analysis and classification. The survival analysis is based on the selected metabolites in the presence or absene of prognostic factors. The classifier is built on the weights obtain from the inner cross validations results and it is tested on out-of-bag data. These weights can be fixed or can be updated at each outer iteration. If weights are not fixed then patients are classified using majority votes. Otherwise, weights obtained from the inner cross validations are summarized by mean weights and used in the classifier. Inner cross validations are performed by calling to function <code><a href="#topic+CVLasoelacox">CVLasoelacox</a></code>. Hazard ratio for low risk group is estimated using out-of-bag data.
</p>


<h3>Value</h3>

<p>A object of class <code><a href="#topic+fcv">fcv</a></code> is returned with the following values
</p>
<table>
<tr><td><code>Runtime</code></td>
<td>
<p>A vector of runtime for each iteration measured in seconds.</p>
</td></tr>
<tr><td><code>Fold</code></td>
<td>
<p>Number of folds used.</p>
</td></tr>
<tr><td><code>Ncv</code></td>
<td>
<p>Number of outer cross validations used.</p>
</td></tr>
<tr><td><code>Nicv</code></td>
<td>
<p>Number of inner cross validations used.</p>
</td></tr>
<tr><td><code>TopK</code></td>
<td>
<p>The Top metabolites used</p>
</td></tr>
<tr><td><code>HRInner</code></td>
<td>
<p>A 3-way array in which first, second, and third dimensions correspond to Nicv, 1, and Ncv respectively. This contains estimated HR for low risk group on the out of bag data.</p>
</td></tr>
<tr><td><code>HRTest</code></td>
<td>
<p>A matrix of survival information for the test dataset based on the out of bag data. It has three columns representing the estimated HR, the 95% lower confidence interval and the 95% upper confidence interval.</p>
</td></tr>
<tr><td><code>Weight</code></td>
<td>
<p>A matrix with columns equals number of TopK metabolites and rows Ncv. Note that Weights are estimated as colMeans of coefficients matrix return from the inner cross validations.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CVLasoelacox">CVLasoelacox</a></code>,
<code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>, <code><a href="#topic+Lasoelacox">Lasoelacox</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Results = Icvlasoel(Data$Survival, Data$Censor, Data$Prognostic,
t(Data$Mdata), Fold = 3,Ncv = 5, Nicv = 7, Alpha = 1,
TopK = colnames(Data$Mdata[,80:100]), Weights = FALSE)

## NUMBER OF Outer CV
Results@Ncv
## NUMBER OF Inner CV
Results@Nicv

## HR of low risk group for the Inner CV
Results@HRInner

## HR of low risk group for the out of bag dataset
Results@HRTest

## The weight for the analysis
Results@Weight

</code></pre>

<hr>
<h2 id='Lasoelacox'>Wapper function for glmnet</h2><span id='topic+Lasoelacox'></span>

<h3>Description</h3>

<p>The function uses the glmnet function to firstly do the variable selection either with Lasso, Elastic net or ridge regressions before the survial analysis. The survival analysis is based on the selected metabolites in the presence or absence of prognostic factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Lasoelacox(
  Survival,
  Censor,
  Mdata,
  Prognostic,
  Quantile = 0.5,
  Metlist = NULL,
  Plots = FALSE,
  Standardize = TRUE,
  Alpha = 1,
  Fold = 4,
  nlambda = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Lasoelacox_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td></tr>
<tr><td><code id="Lasoelacox_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="Lasoelacox_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with metabolic profiles where the number of rows should be equal to the number of metabolites and number of columns should be equal to number of patients.</p>
</td></tr>
<tr><td><code id="Lasoelacox_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="Lasoelacox_+3A_quantile">Quantile</code></td>
<td>
<p>The cut off value for the classifier, default is the median cutoff</p>
</td></tr>
<tr><td><code id="Lasoelacox_+3A_metlist">Metlist</code></td>
<td>
<p>A list of metabolites to be considered in the model usually smaller than the metabolites in the Mdata . Default is to use all metabolites available</p>
</td></tr>
<tr><td><code id="Lasoelacox_+3A_plots">Plots</code></td>
<td>
<p>A boolean parameter indicating if plots should be shown. Default is FALSE. If TRUE, the first plot is the partial likelihood deviance against the logarithmn of each lambda while the second is the coefficients versus the lamdas</p>
</td></tr>
<tr><td><code id="Lasoelacox_+3A_standardize">Standardize</code></td>
<td>
<p>A Logical flag for the standardization of the metabolite matrix, prior to fitting the model sequence. The coefficients are always returned on the original scale. Default is standardize=TRUE.</p>
</td></tr>
<tr><td><code id="Lasoelacox_+3A_alpha">Alpha</code></td>
<td>
<p>The mixing parameter for glmnet (see <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>). The range is 0&lt;= Alpha &lt;= 1. The Default is 1</p>
</td></tr>
<tr><td><code id="Lasoelacox_+3A_fold">Fold</code></td>
<td>
<p>number of folds to be used for the cross validation. Its value ranges between 3 and the numbe rof subjects in the dataset</p>
</td></tr>
<tr><td><code id="Lasoelacox_+3A_nlambda">nlambda</code></td>
<td>
<p>The number of lambda values - default is 100 as in <a href="glmnet.html#topic+glmnet">glmnet</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper function for glmnet and it fits models using either Lasso, Elastic net and Ridge regressions. This is done in the presence or absence of prognostic factors. The prognostic factor when avaialable will always be forced to be in the model so no penalty for it. Optimum lambda will be used to select the non-zero shrinkage coefficients, the nonzero selected metabolites will thus be used in the survival analysis and in calculation of the risk scores.
</p>


<h3>Value</h3>

<p>A object is returned with the following values
</p>
<table>
<tr><td><code>Coefficients.NonZero</code></td>
<td>
<p>The coefficients of the selected metabolites</p>
</td></tr>
<tr><td><code>Selected.Mets</code></td>
<td>
<p>The selected metabolites</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The number of selected metabolites</p>
</td></tr>
<tr><td><code>Risk.scores</code></td>
<td>
<p>The risk scores of the subjects</p>
</td></tr>
<tr><td><code>Risk.group</code></td>
<td>
<p>The risk classification of the subjects based on the specified quantile</p>
</td></tr>
<tr><td><code>SurvFit</code></td>
<td>
<p>The cox analysis of the riskgroup based on the selected metabolites and the prognostic factors</p>
</td></tr>
<tr><td><code>Select</code></td>
<td>
<p>A Boolean argument indicating if there was selection or not</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>,
<code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Results = Lasoelacox(Survival=Data$Survival, Censor=Data$Censor,
Mdata=t(Data$Mdata), Prognostic = Data$Prognostic, Quantile = 0.5,
Metlist = NULL, Plots = FALSE, Standardize = TRUE, Alpha = 1)

## VIEW THE SELECTED METABOLITES
Results$Selected.mets
## NUMBER OF SELECTED METABOLITES
Results$n

## VIEW THE CLASSIFICATION GROUP OF EACH SUBJECT
Results$Risk.Group

## VIEW THE SURVIVAL ANALYSIS RESULT
Results$SurvFit

## TO CHECK IF THERE WAS ANY SELECTION
Results$Select
</code></pre>

<hr>
<h2 id='Majorityvotes'>Classifiction for Majority Votes</h2><span id='topic+Majorityvotes'></span>

<h3>Description</h3>

<p>The Function fits cox proportional hazard model and does classification based on the majority votes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Majorityvotes(Result, Prognostic, Survival, Censor, J = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Majorityvotes_+3A_result">Result</code></td>
<td>
<p>An object obtained from the metabolite specific analysis (<code><a href="#topic+MSpecificCoxPh">MSpecificCoxPh</a></code>) which is of class &quot;ms&quot;</p>
</td></tr>
<tr><td><code id="Majorityvotes_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="Majorityvotes_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td></tr>
<tr><td><code id="Majorityvotes_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="Majorityvotes_+3A_j">J</code></td>
<td>
<p>The jth set of patients required for the visualization. The default is J=1 which is the first set of patients. For visualization, J should be less than the number of patients divided by 25</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Function fits cox proportional hazard model and does classification based on the majority votes while estimating the Hazard ratio of the low risk group. The function firstly count the number of low risk classification for each subject based on the metabolite specific analysis which determines the majority votes. In addition, It visualizes the metabolic specific calssification for the subjects. 25 subjects is taken for visualization purpose.
</p>


<h3>Value</h3>

<p>A list is returned with the following values
</p>
<table>
<tr><td><code>Model.result</code></td>
<td>
<p>The cox proportional regression result based on the majority vote classification</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The majority vote for each subject</p>
</td></tr>
<tr><td><code>Classif</code></td>
<td>
<p>The majority vote classification for each subjects</p>
</td></tr>
<tr><td><code>Group</code></td>
<td>
<p>The classification of the subjects based on each metabolite analysis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>References</h3>

<p>Hastie T, Tibshirani R, Friedman J (2001).
<em>The elements of statistical learning: data mining, inference, and prediction: with 200 full-color illustrations</em>.
New York: Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MSpecificCoxPh">MSpecificCoxPh</a></code>, <code><a href="survival.html#topic+coxph">coxph</a></code>,  <code><a href="#topic+EstimateHR">EstimateHR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## RUNNING THE METABOLITE SPECIFIC FUNCTION
Example1 = MSpecificCoxPh(Survival = Data$Survival,
Mdata = t(Data$Mdata), Censor = Data$Censor, Reduce = FALSE,
Select = 15,Prognostic = Data$Prognostic, Quantile = 0.5)

## USING THE FUNCTION
Result2 = Majorityvotes(Example1,Data$Prognostic, Data$Survival,Data$Censor,J=2)

## THE SURVIVAL ANALYSIS FOR MAJORITY VOTE RESULT
 Result2$Model.result

### THE MAJORITY VOTE FOR EACH SUBJECT
Result2$N

### THE MAJORITY VOTE CLASSIFICATION FOR EACH SUBJECT
Result2$Classif

### THE GROUP FOR EACH SUBJECT BASED ON THE METABOLITE SPPECIFIC ANALYSIS
Result2$Group
</code></pre>

<hr>
<h2 id='MetabolicSurv'>MetabolicSurv: A biomarker validation approach for predicting survival using metabolic signature.</h2><span id='topic+MetabolicSurv'></span>

<h3>Description</h3>

<p>This package develope biomarker signature for metabolic data. It contains a set of functions and cross validation methods  to validate and select biomarkers when the outcome of interest is survival. The package can handle prognostic factors and mainly metabolite matrix as input, the package can served as biomarker validation tool.
</p>


<h3>MetabolicSurv functions</h3>


<ol>
<li><p> It can be used with any form of high dimensional/omics data such as:
Metabolic data, Gene expression matrix, incase you dont have a data it
can simulate hypothetical scinerio of a high dimensional data based on the
desired biological parameters
</p>
</li>
<li><p> It developed any form of signature from the high dimensional data to be used for other purpose
</p>
</li>
<li><p> It also employs data reduction techniques such as PCA, PLS and Lasso
</p>
</li>
<li><p> It classifies subjects based on the signatures into Low and high risk
group
</p>
</li>
<li><p> It incorporate the use of subject prognostic information for the to
enhance the biomarker for classification
</p>
</li>
<li><p> It gives information about the survival rate of subjects depending on the classification
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>

<hr>
<h2 id='MetFreq'>Frequency of Selected Metabolites from the LASSO, Elastic-net Cross-Validation</h2><span id='topic+MetFreq'></span>

<h3>Description</h3>

<p>The function selects the frquency of selection  from the shrinkage method (LASSO, Elastic-net) based on cross validation, that is the number of times each metabolite occur during the cross-validation process. In case of large metabolomic matrix then the N argument can be used to select metabolites occurence at a particular frequency.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MetFreq(Object, TopK = NULL, N = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MetFreq_+3A_object">Object</code></td>
<td>
<p>An object of class <code><a href="#topic+cvle">cvle</a></code> returned from the function <code><a href="#topic+CVLasoelacox">CVLasoelacox</a></code>.</p>
</td></tr>
<tr><td><code id="MetFreq_+3A_topk">TopK</code></td>
<td>
<p>The number of Top K metabolites (5 by default) to be displayed in the frequency of selection graph.</p>
</td></tr>
<tr><td><code id="MetFreq_+3A_n">N</code></td>
<td>
<p>The metqbolites with the specified frequency should be displayed in the frequency of selection graph.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function outputs the mostly selected metabolites during the LASSO and Elastic-net cross validation. Selected top metabolites are ranked based on frequency of selection and also a particular frequency cqn be selected. In addition, it visualizes the selected top metabolites based on the minimum frequency specified.
</p>


<h3>Value</h3>

<p>A vector of metabolites and their frequency of selection. Also, a graphical representation is displayed.
</p>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cvmm">cvmm</a></code>, <code><a href="survival.html#topic+coxph">coxph</a></code>,
<code><a href="#topic+EstimateHR">EstimateHR</a></code>,<code><a href="#topic+CVLasoelacox">CVLasoelacox</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## CROSS-VALIDATION FOR LASSO AND ELASTIC-NET
Result = CVLasoelacox(Survival = Data$Survival,
Censor = Data$Censor, Mdata = t(Data$Mdata),
Prognostic = Data$Prognostic, Quantile = 0.5,
Metlist = NULL,Standardize = TRUE, Reduce=FALSE, Select=15,
Alpha = 1,Fold = 4,Ncv = 10,nlambda = 100)

## CONFIRMING THE CLASS
class(Result)

## USING THE FUNCTION
MetFreq(Result,TopK = 5, N=5)

</code></pre>

<hr>
<h2 id='ms'>The ms class</h2><span id='topic+ms'></span>

<h3>Description</h3>

<p>The ms class
</p>
<p>Constructor for the ms class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ms(Result, HRRG, Group, Metnames)

ms(Result, HRRG, Group, Metnames)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ms_+3A_result">Result</code></td>
<td>
<p>A list of dataframes of each output object of coxph for the metabolites.</p>
</td></tr>
<tr><td><code id="ms_+3A_hrrg">HRRG</code></td>
<td>
<p>A dataframe with estimated metabolite-specific HR for low risk group and 95 percent CI.</p>
</td></tr>
<tr><td><code id="ms_+3A_group">Group</code></td>
<td>
<p>A matrix of the classification group a subject belongs to for each of the metabolite analysis. The metabolites are on the rows and the subjects are the columns</p>
</td></tr>
<tr><td><code id="ms_+3A_metnames">Metnames</code></td>
<td>
<p>The names of the metabolites for the analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class ms
</p>


<h3>Slots</h3>


<dl>
<dt><code>Result</code></dt><dd><p>A list of dataframes of each output object of coxph for the metabolites.</p>
</dd>
<dt><code>HRRG</code></dt><dd><p>A dataframe with estimated metabolite-specific HR for low risk group and 95 percent CI.</p>
</dd>
<dt><code>Group</code></dt><dd><p>A matrix of the classification group a subject belongs to for each of the metabolite analysis. The metabolites are on the rows and the subjects are the columns</p>
</dd>
<dt><code>Metnames</code></dt><dd><p>The names of the metabolites for the analysis</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo,
<a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MSpecificCoxPh">MSpecificCoxPh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## GENERATE SOME METABOLIC SURVIVAL DATA WITH PROGNOSTIC FACTORS
Data&lt;-MSData(nPatients=100,nMet=150,Prop=0.5)

## DO THE METABOLITE BY METABOLITE ANALYSIS
Eg = MSpecificCoxPh(Survival=Data$Survival, Mdata=t(Data$Mdata),
Censor=Data$Censor, Reduce = FALSE, Select = 15,
Prognostic=Data$Prognostic, Quantile = 0.5)

## GET THE CLASS OF THE OBJECT
class(Eg)     # An "ms" Class

##  METHOD THAT CAN BE USED FOR THIS CLASS
show(Eg)
summary(Eg)
plot(Eg)
</code></pre>

<hr>
<h2 id='MSData'>Generate Artificial Metabolic Survival Data</h2><span id='topic+MSData'></span>

<h3>Description</h3>

<p>The Function generates metabolic profile and survival dataset of any number of patients and also their survival information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MSData(nPatients = 100, nMet = 150, Prop = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MSData_+3A_npatients">nPatients</code></td>
<td>
<p>The number of patients</p>
</td></tr>
<tr><td><code id="MSData_+3A_nmet">nMet</code></td>
<td>
<p>The number of metabolites</p>
</td></tr>
<tr><td><code id="MSData_+3A_prop">Prop</code></td>
<td>
<p>The proportion of patients having low risk</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function generates the metabolic profile where small set of metabolites (30) are informative and rest of them are set as noisy metabolites.
Also, the survival time and Censoring information are generated based on first right singular vectors of <code><a href="base.html#topic+svd">svd</a></code> of the metabolic profile matrix.
It also generates other prognostic factors such as Age, Stage and Gender which are slightly correlated with survival time.
</p>


<h3>Value</h3>

<p>An object of class list is returned with the following items .
</p>
<table>
<tr><td><code>Censor</code></td>
<td>
<p>The censoring/event indicator</p>
</td></tr>
<tr><td><code>Survival</code></td>
<td>
<p>The Survival time</p>
</td></tr>
<tr><td><code>Met.names</code></td>
<td>
<p>The vector of metabolites name</p>
</td></tr>
<tr><td><code>Mdata</code></td>
<td>
<p>The metabolic profile matrix</p>
</td></tr>
<tr><td><code>Prognostic</code></td>
<td>
<p>A data frame with prognostic factors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#GENERATE SOME METABOLIC SURVIVAL DATA WITH PROGNOSTIC FACTORS

Data&lt;-MSData(nPatients=100,nMet=150,Prop=0.5)

SurvTime&lt;-Data$Survival
Censor&lt;-Data$Censor
ProgFact&lt;-Data$Prognostic
MetData&lt;-Data$Mdata
Metnames&lt;-Data$Met.names
</code></pre>

<hr>
<h2 id='MSpecificCoxPh'>Metabolite by metabolite Cox proportional analysis</h2><span id='topic+MSpecificCoxPh'></span>

<h3>Description</h3>

<p>The Function fits cox proportional hazard model and does classification for each metabolite
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MSpecificCoxPh(
  Survival,
  Mdata,
  Censor,
  Reduce = FALSE,
  Select = 15,
  Prognostic = NULL,
  Quantile = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MSpecificCoxPh_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td></tr>
<tr><td><code id="MSpecificCoxPh_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with metabolic profiles where the number of rows should be equal to the number of metabolites and number of columns should be equal to number of patients.</p>
</td></tr>
<tr><td><code id="MSpecificCoxPh_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="MSpecificCoxPh_+3A_reduce">Reduce</code></td>
<td>
<p>A boolean parameter indicating if the metabolic profile matrix should be reduced, default is TRUE and larger metabolic profile matrix is reduced by supervised pca approach and first pca is extracted from the reduced matrix to be used in the classifier.</p>
</td></tr>
<tr><td><code id="MSpecificCoxPh_+3A_select">Select</code></td>
<td>
<p>Number of metabolites (default is 15) to be selected from supervised PCA. This is valid only if the argument Reduce=TRUE</p>
</td></tr>
<tr><td><code id="MSpecificCoxPh_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="MSpecificCoxPh_+3A_quantile">Quantile</code></td>
<td>
<p>The cut off value for the classifier, default is the median cutoff</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits  metabolite by metabolite Cox proportional hazard model and perform the classification based on a specified quantile. Risk score will be been estimated using a single  metabolite. Function is useful for majority vote classification method and  metabolite by  metabolite analysis and also for top K  metabolites.
</p>


<h3>Value</h3>

<p>A object of class <code><a href="#topic+ms">ms</a></code> is returned with the following values
</p>
<table>
<tr><td><code>Result</code></td>
<td>
<p>The cox proportional regression result for each metabolite</p>
</td></tr>
<tr><td><code>HRRG</code></td>
<td>
<p>The hazard ratio statistics (Hazard-ratio, Lower confidence interval and upper confidence interval) of the riskgroup based on the riskscore and the cut off value for each metabolite</p>
</td></tr>
<tr><td><code>Group</code></td>
<td>
<p>The classification of the subjects based on each metabolite analysis</p>
</td></tr>
<tr><td><code>Metnames</code></td>
<td>
<p>The names of the metabolites for the analysis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>,  <code><a href="#topic+EstimateHR">EstimateHR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Example1 = MSpecificCoxPh(Survival = Data$Survival,
Mdata = t(Data$Mdata), Censor = Data$Censor, Reduce = FALSE,
Select = 15,Prognostic = Data$Prognostic, Quantile = 0.5)

## KNOWLING THE CLASS OF THE OUTPUT
class(Example1)

## EXTRACTING THE COMPONENT OF THE FUNCTION
### HAZARD RATIO INFORMATION FOR EACH METABOLITES
Example1@HRRG

### COX MODEL RESULT FOR EACH METABOLITES
Example1@Result

### CLASSIFICATION FOR EACH METABOLITES
Example1@Group
</code></pre>

<hr>
<h2 id='perm'>Constructor for the perm class</h2><span id='topic+perm'></span>

<h3>Description</h3>

<p>Constructor for the perm class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm(HRobs, HRperm, nperm, Validation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm_+3A_hrobs">HRobs</code></td>
<td>
<p>Estimated HR for low risk group on the original data.</p>
</td></tr>
<tr><td><code id="perm_+3A_hrperm">HRperm</code></td>
<td>
<p>Estimated HR for low risk group on the permuted data</p>
</td></tr>
<tr><td><code id="perm_+3A_nperm">nperm</code></td>
<td>
<p>Number of permutations carried out.</p>
</td></tr>
<tr><td><code id="perm_+3A_validation">Validation</code></td>
<td>
<p>The validation scheme that was used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class perm
</p>

<hr>
<h2 id='perm-class'>The perm Class.</h2><span id='topic+perm-class'></span>

<h3>Description</h3>

<p>The perm Class.
</p>


<h3>Slots</h3>


<dl>
<dt><code>HRobs</code></dt><dd><p>Estimated HR for low risk group on the original data.</p>
</dd>
<dt><code>HRperm</code></dt><dd><p>Estimated HR for low risk group on the permuted data</p>
</dd>
<dt><code>nperm</code></dt><dd><p>Number of permutations carried out.</p>
</dd>
<dt><code>Validation</code></dt><dd><p>The validation scheme that was used.</p>
</dd>
</dl>


<h3>Note</h3>

<p>The first, third and last vertical line on the plot are the lower,
median  and upper CI of the permuted data estimated HR while
the red line is the estimated HR of the original data
</p>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DistHR">DistHR</a></code>, <code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code>, <code><a href="#topic+SurvPlsClass">SurvPlsClass</a></code>, <code><a href="#topic+Majorityvotes">Majorityvotes</a></code>, <code><a href="#topic+Lasoelacox">Lasoelacox</a></code>, <code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="#topic+Lasoelacox">Lasoelacox</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## GENERATE SOME METABOLIC SURVIVAL DATA WITH PROGNOSTIC FACTORS
Data&lt;-MSData(nPatients=100,nMet=150,Prop=0.5)

## USING THE FUNCTION
Example &lt;- DistHR(Survival = Data$Survival,Mdata = t(Data$Mdata),
Censor = Data$Censor,Reduce=FALSE,Select=15,Prognostic=Data$Prognostic,
Quantile = 0.5, nperm=10, case=2, Validation=c("L1based"))

## GET THE CLASS OF THE OBJECT
class(Example)     # A "perm" Class

##  METHOD THAT CAN BE USED FOR THIS CLASS
show(Example)
summary(Example)
plot(Example)

</code></pre>

<hr>
<h2 id='plot+2Ccvle+2Cmissing-method'>Plot method for cvle class</h2><span id='topic+plot+2Ccvle+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot method for cvle class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvle,missing'
plot(x, y, type = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Ccvle+2B2Cmissing-method_+3A_x">x</code></td>
<td>
<p>A cvle class object</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvle+2B2Cmissing-method_+3A_y">y</code></td>
<td>
<p>missing</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvle+2B2Cmissing-method_+3A_type">type</code></td>
<td>
<p>Plot type. 1 distribution of the HR under training and test set. 2 HR vs number selected metabolites.</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvle+2B2Cmissing-method_+3A_...">...</code></td>
<td>
<p>The usual extra arguments to generic functions — see  <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross Valdiated Results for Lasso and Elastic Net based Predictive Metabolite plots
</p>

<hr>
<h2 id='plot+2Ccvmm+2CANY-method'>Plot method for cvmm class</h2><span id='topic+plot+2Ccvmm+2CANY-method'></span>

<h3>Description</h3>

<p>Plot method for cvmm class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvmm,ANY'
plot(x, y, which = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Ccvmm+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>A cvmm class object</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvmm+2B2CANY-method_+3A_y">y</code></td>
<td>
<p>missing</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvmm+2B2CANY-method_+3A_which">which</code></td>
<td>
<p>This specify which metabolite for which estimated HR
information need to be visualized. By default results of the first metabolite
is used.</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvmm+2B2CANY-method_+3A_...">...</code></td>
<td>
<p>The usual extra arguments to generic functions — see  <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross Valdiated Metabolic Specific CoxPh plots
</p>

<hr>
<h2 id='plot+2Ccvmv+2CANY-method'>Plot method for cvmv class</h2><span id='topic+plot+2Ccvmv+2CANY-method'></span>

<h3>Description</h3>

<p>Plot method for cvmv class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvmv,ANY'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Ccvmv+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>A cvmv class object</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvmv+2B2CANY-method_+3A_y">y</code></td>
<td>
<p>missing</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvmv+2B2CANY-method_+3A_...">...</code></td>
<td>
<p>The usual extra arguments to generic functions — see  <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross validation for Majority Votes Based Classification Analysis plots
</p>

<hr>
<h2 id='plot+2Ccvpp+2Cmissing-method'>Plot method for cvpp class</h2><span id='topic+plot+2Ccvpp+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot method for cvpp class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvpp,missing'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Ccvpp+2B2Cmissing-method_+3A_x">x</code></td>
<td>
<p>A cvpp class object</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvpp+2B2Cmissing-method_+3A_y">y</code></td>
<td>
<p>missing</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvpp+2B2Cmissing-method_+3A_...">...</code></td>
<td>
<p>The usual extra arguments to generic functions — see  <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross Validations for PCA and PLS based plots
</p>

<hr>
<h2 id='plot+2Ccvsim+2Cmissing-method'>Plot method for cvsim class</h2><span id='topic+plot+2Ccvsim+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot method for cvsim class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvsim,missing'
plot(x, y, type = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Ccvsim+2B2Cmissing-method_+3A_x">x</code></td>
<td>
<p>A cvsim class object</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvsim+2B2Cmissing-method_+3A_y">y</code></td>
<td>
<p>missing</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvsim+2B2Cmissing-method_+3A_type">type</code></td>
<td>
<p>Plot type. 1 distribution of the HR under test For the Top K
metabolites using PCA. 2 distribution of the HR under test For the Top K
metabolites using PLS.</p>
</td></tr>
<tr><td><code id="plot+2B2Ccvsim+2B2Cmissing-method_+3A_...">...</code></td>
<td>
<p>The usual extra arguments to generic functions — see
<code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross validation for sequentially increases metabolites plots
</p>

<hr>
<h2 id='plot+2Cfcv+2Cmissing-method'>Plot method for fcv class</h2><span id='topic+plot+2Cfcv+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot method for fcv class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fcv,missing'
plot(x, y, type = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cfcv+2B2Cmissing-method_+3A_x">x</code></td>
<td>
<p>A fcv class object</p>
</td></tr>
<tr><td><code id="plot+2B2Cfcv+2B2Cmissing-method_+3A_y">y</code></td>
<td>
<p>missing</p>
</td></tr>
<tr><td><code id="plot+2B2Cfcv+2B2Cmissing-method_+3A_type">type</code></td>
<td>
<p>Plot type. 1 is the distribution of the inner cross validated
HR under test data for each outer iterations and estimated HR on the out
of bag data are superimposed. 2 Estimated HR Density for low Risk Group.</p>
</td></tr>
<tr><td><code id="plot+2B2Cfcv+2B2Cmissing-method_+3A_...">...</code></td>
<td>
<p>The usual extra arguments to generic functions — see
<code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Inner and Outer Cross Validations for Lasso Elastic Net Survival predictive models and Classification plots
</p>

<hr>
<h2 id='plot+2Cms+2CANY-method'>Plot method for ms class</h2><span id='topic+plot+2Cms+2CANY-method'></span>

<h3>Description</h3>

<p>Plot method for ms class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ms,ANY'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cms+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>A ms class object</p>
</td></tr>
<tr><td><code id="plot+2B2Cms+2B2CANY-method_+3A_y">y</code></td>
<td>
<p>missing</p>
</td></tr>
<tr><td><code id="plot+2B2Cms+2B2CANY-method_+3A_...">...</code></td>
<td>
<p>The usual extra arguments to generic functions — see  <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Metabolite by Metabolite CoxPh plots
</p>

<hr>
<h2 id='plot+2Cperm+2CANY-method'>Plot method for perm class</h2><span id='topic+plot+2Cperm+2CANY-method'></span>

<h3>Description</h3>

<p>Plot method for perm class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'perm,ANY'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2Cperm+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>A perm class object</p>
</td></tr>
<tr><td><code id="plot+2B2Cperm+2B2CANY-method_+3A_y">y</code></td>
<td>
<p>missing</p>
</td></tr>
<tr><td><code id="plot+2B2Cperm+2B2CANY-method_+3A_...">...</code></td>
<td>
<p>The usual extra arguments to generic functions — see
<code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Null Distribution of the Estimated HR plots
</p>

<hr>
<h2 id='show+2Ccvle-method'>Show method for cvle class</h2><span id='topic+show+2Ccvle-method'></span>

<h3>Description</h3>

<p>Show method for cvle class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvle'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Ccvle-method_+3A_object">object</code></td>
<td>
<p>An object of class cvle</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross Valdiated Results for Lasso and Elastic Net based Predictive Metabolite signature.
</p>

<hr>
<h2 id='show+2Ccvmm-method'>Show method for cvmm class</h2><span id='topic+show+2Ccvmm-method'></span>

<h3>Description</h3>

<p>Show method for cvmm class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvmm'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Ccvmm-method_+3A_object">object</code></td>
<td>
<p>An object of class cvmm</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross Valdiated Metabolic Specific CoxPh information
</p>

<hr>
<h2 id='show+2Ccvmv-method'>Show method for cvmv class</h2><span id='topic+show+2Ccvmv-method'></span>

<h3>Description</h3>

<p>Show method for cvmv class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvmv'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Ccvmv-method_+3A_object">object</code></td>
<td>
<p>An object of class cvmv</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross validation for Majority Votes Based Classification Analysis information
</p>

<hr>
<h2 id='show+2Ccvpp-method'>Show method for cvpp class</h2><span id='topic+show+2Ccvpp-method'></span>

<h3>Description</h3>

<p>Show method for cvpp class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvpp'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Ccvpp-method_+3A_object">object</code></td>
<td>
<p>An object of class cvpp</p>
</td></tr>
</table>


<h3>Value</h3>

<p>CCross Validations for PCA and PLS based information
</p>

<hr>
<h2 id='show+2Ccvsim-method'>Show method for cvsim class</h2><span id='topic+show+2Ccvsim-method'></span>

<h3>Description</h3>

<p>Show method for cvsim class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvsim'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Ccvsim-method_+3A_object">object</code></td>
<td>
<p>An object of class cvsim</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross validation for sequentially increases metabolites information
</p>

<hr>
<h2 id='show+2Cfcv-method'>Show method for fcv class</h2><span id='topic+show+2Cfcv-method'></span>

<h3>Description</h3>

<p>Show method for fcv class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fcv'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Cfcv-method_+3A_object">object</code></td>
<td>
<p>An object of class fcv</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Inner and Outer Cross Validations for Lasso Elastic Net Survival predictive models and Classification information
</p>

<hr>
<h2 id='show+2Cms-method'>Show method for ms class</h2><span id='topic+show+2Cms-method'></span>

<h3>Description</h3>

<p>Show method for ms class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ms'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Cms-method_+3A_object">object</code></td>
<td>
<p>An object of class ms</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Metabolite by Metabolite CoxPh Model and the number of
metabolites used.
</p>

<hr>
<h2 id='show+2Cperm-method'>Show method for perm class</h2><span id='topic+show+2Cperm-method'></span>

<h3>Description</h3>

<p>Show method for perm class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'perm'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Cperm-method_+3A_object">object</code></td>
<td>
<p>An object of class perm</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Null Distribution of the Estimated HR information
</p>

<hr>
<h2 id='SIMet'>Sequential Increase in Metabolites for the PCA or PLS classifier</h2><span id='topic+SIMet'></span>

<h3>Description</h3>

<p>The Function fits cox proportional hazard model and does classification
by sequentially increasing the metabolites  using either PCA or PLS based
on the topK metabolites specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SIMet(
  TopK = 15,
  Survival,
  Mdata,
  Censor,
  Reduce = TRUE,
  Select = 50,
  Prognostic = NULL,
  Plot = FALSE,
  DimMethod = c("PLS", "PCA"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SIMet_+3A_topk">TopK</code></td>
<td>
<p>Top K metabolites (15 by default) to be used in the sequential
analysis.</p>
</td></tr>
<tr><td><code id="SIMet_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of
subjects</p>
</td></tr>
<tr><td><code id="SIMet_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with
metabolic profiles where the number of rows should be equal to the number
of metabolites and number of columns should be equal to number of patients.</p>
</td></tr>
<tr><td><code id="SIMet_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="SIMet_+3A_reduce">Reduce</code></td>
<td>
<p>A boolean parameter indicating if the metabolic profile matrix should be reduced, default is TRUE and larger metabolic profile matrix is reduced by supervised pca approach and first pca is extracted from the reduced matrix to be used in the classifier.</p>
</td></tr>
<tr><td><code id="SIMet_+3A_select">Select</code></td>
<td>
<p>Number of metabolites to be selected from supervised PCA.
This is valid only if the argument Reduce=TRUE</p>
</td></tr>
<tr><td><code id="SIMet_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor
and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="SIMet_+3A_plot">Plot</code></td>
<td>
<p>A boolean parameter indicating if Plot should be shown.
Default is FALSE</p>
</td></tr>
<tr><td><code id="SIMet_+3A_dimmethod">DimMethod</code></td>
<td>
<p>Dimension reduction method which can either be PLS or PCA.</p>
</td></tr>
<tr><td><code id="SIMet_+3A_...">...</code></td>
<td>
<p>Additinal arguments for plotting and only valid  if Plot=TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function sequentially increase the number of top K metabolites to be
used in the PCA or PLS methods in order to obtain the risk score.
This function internally calls <code><a href="#topic+MSpecificCoxPh">MSpecificCoxPh</a></code>
to rank the metabolites based on HR.
Therefore metabolites can be ordered based on increasing order of the HR
for low risk group. Thereafter, the function takes few top K
(15 is the default) to be used in the sequential analysis.
</p>


<h3>Value</h3>

<p>A list containing a data frame with estimated HR along with 95% CI
at each TopK value for the sequential analysis.
</p>
<table>
<tr><td><code>Result</code></td>
<td>
<p>The hazard ratio statistics (HR, Lower confidence interval
and upper confidence interval) of the lower riskgroup based for each
sequential metabolite analysis</p>
</td></tr>
<tr><td><code>TopKplot</code></td>
<td>
<p>A graphical representation of the Result containing the
hazard ratio statistics</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>References</h3>

<p>Vinzi VE, Chin WW, Henseler J, Wang H (2010).
<em>Handbook of Partial Least Squares: Concepts, Methods and Applications</em>, 1st edition.
Springer Publishing Company, Incorporated.
</p>
<p>Bair E, Hastie T, Debashis P, Tibshirani R (2006).
&ldquo;Prediction by supervised principal components.&rdquo;
<em>American Statistics Association,</em>, <b>101</b>(473), 119&ndash;137.
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>,  <code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="#topic+MSpecificCoxPh">MSpecificCoxPh</a></code>, <code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code>, <code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Example1 = SIMet(TopK = 10, Survival=Data$Survival,
Mdata=t(Data$Mdata), Censor=Data$Censor, Reduce = TRUE,
Select = 50,Prognostic = Data$Prognostic, Plot = TRUE, DimMethod ="PLS")

## FOR THE HR STATISTICS
Example1$Result

## FOR THE GRAPHICAL OUTPUT
Example1$TopKplot

</code></pre>

<hr>
<h2 id='summary+2Ccvle-method'>Summary method for cvle class</h2><span id='topic+summary+2Ccvle-method'></span>

<h3>Description</h3>

<p>Summary method for cvle class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvle'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Ccvle-method_+3A_object">object</code></td>
<td>
<p>An object of class cvle</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross Valdiated Results for Lasso and Elastic Net based Predictive Metabolite signature summary information
</p>

<hr>
<h2 id='summary+2Ccvmm-method'>Summary method for cvmm class</h2><span id='topic+summary+2Ccvmm-method'></span>

<h3>Description</h3>

<p>Summary method for cvmm class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvmm'
summary(object, which = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Ccvmm-method_+3A_object">object</code></td>
<td>
<p>An object of class cvmm</p>
</td></tr>
<tr><td><code id="summary+2B2Ccvmm-method_+3A_which">which</code></td>
<td>
<p>This specify which metabolite for which estimated HR</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross Valdiated Metabolic Specific CoxPh summary
</p>

<hr>
<h2 id='summary+2Ccvmv-method'>Summary method for cvmv class</h2><span id='topic+summary+2Ccvmv-method'></span>

<h3>Description</h3>

<p>Summary method for cvmv class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvmv'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Ccvmv-method_+3A_object">object</code></td>
<td>
<p>An object of class cvmv</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross validation for Majority Votes Based Classification Analysis summary
</p>

<hr>
<h2 id='summary+2Ccvpp-method'>Summary method for cvpp class</h2><span id='topic+summary+2Ccvpp-method'></span>

<h3>Description</h3>

<p>Summary method for cvpp class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvpp'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Ccvpp-method_+3A_object">object</code></td>
<td>
<p>An object of class cvpp</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross Validations for PCA and PLS based summary
</p>

<hr>
<h2 id='summary+2Ccvsim-method'>Summary method for cvsim class</h2><span id='topic+summary+2Ccvsim-method'></span>

<h3>Description</h3>

<p>Summary method for cvsim class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cvsim'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Ccvsim-method_+3A_object">object</code></td>
<td>
<p>An object of class cvsim</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross validation for sequentially increases metabolites summary
</p>

<hr>
<h2 id='summary+2Cfcv-method'>Summary method for fcv class</h2><span id='topic+summary+2Cfcv-method'></span>

<h3>Description</h3>

<p>Summary method for fcv class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fcv'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Cfcv-method_+3A_object">object</code></td>
<td>
<p>An object of class fcv</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Inner and Outer Cross Validations for Lasso Elastic Net Survival predictive models and Classification summary
</p>

<hr>
<h2 id='summary+2Cms-method'>Summary method for ms class</h2><span id='topic+summary+2Cms-method'></span>

<h3>Description</h3>

<p>Summary method for ms class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ms'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Cms-method_+3A_object">object</code></td>
<td>
<p>An object of class ms</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Metabolite by Metabolite CoxPh summary information
</p>

<hr>
<h2 id='summary+2Cperm-method'>Summary method for perm class</h2><span id='topic+summary+2Cperm-method'></span>

<h3>Description</h3>

<p>Summary method for perm class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'perm'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2Cperm-method_+3A_object">object</code></td>
<td>
<p>An object of class perm</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Null Distribution of the Estimated HR summary
</p>

<hr>
<h2 id='SurvPcaClass'>Survival PCA and Classification for metabolic data</h2><span id='topic+SurvPcaClass'></span>

<h3>Description</h3>

<p>The function performs principal component analysis (PCA) on Metabolomics matrix and fit Cox proportional hazard model with covariates using also the first PCA as covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurvPcaClass(
  Survival,
  Mdata,
  Censor,
  Reduce = TRUE,
  Select = 150,
  Prognostic = NULL,
  Plots = FALSE,
  Quantile = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SurvPcaClass_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td></tr>
<tr><td><code id="SurvPcaClass_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with metabolic profiles where the number of rows should be equal to the number of metabolites and number of columns should be equal to number of patients.</p>
</td></tr>
<tr><td><code id="SurvPcaClass_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="SurvPcaClass_+3A_reduce">Reduce</code></td>
<td>
<p>A boolean parameter indicating if the metabolic profile matrix should be reduced, default is TRUE and larger metabolic profile matrix is reduced by supervised pca approach and first pca is extracted from the reduced matrix to be used in the classifier.</p>
</td></tr>
<tr><td><code id="SurvPcaClass_+3A_select">Select</code></td>
<td>
<p>Number of metabolites (default is 15) to be selected from supervised PCA. This is valid only if th argument Reduce=TRUE</p>
</td></tr>
<tr><td><code id="SurvPcaClass_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="SurvPcaClass_+3A_plots">Plots</code></td>
<td>
<p>A boolean parameter indicating if the plots should be shown. Default is FALSE</p>
</td></tr>
<tr><td><code id="SurvPcaClass_+3A_quantile">Quantile</code></td>
<td>
<p>The cut off value for the classifier, default is the median cutoff</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can also be used to perform the grid analysis where the grid will be several quantile values and default is 0.5 which is the median cut-off. This function can handle single and multiple metabolites. For larger Metabolomics matrix, this function will reduce larger Metabolomics matrix to smaller version using supervised pca approach and this is by default done and can be control by using the argument Reduce. Other prognostic factors can be included to the model.
</p>


<h3>Value</h3>

<p>A object of class SurvPca is returned with the following values
</p>
<table>
<tr><td><code>Survfit</code></td>
<td>
<p>The cox proportional regression result using the first PCA</p>
</td></tr>
<tr><td><code>Riskscores</code></td>
<td>
<p>A vector of risk scores which is equal to the number of patents.</p>
</td></tr>
<tr><td><code>Riskgroup</code></td>
<td>
<p>The classification of the subjects based on the PCA into low or high risk group</p>
</td></tr>
<tr><td><code>pc1</code></td>
<td>
<p>The First PCA scores based on either the reduced Metabolite matrix or the full matrix</p>
</td></tr>
<tr><td><code>KMplot</code></td>
<td>
<p>The Kaplan-Meier survival plot of the riskgroup</p>
</td></tr>
<tr><td><code>SurvBPlot</code></td>
<td>
<p>The distribution of the survival in the riskgroup</p>
</td></tr>
<tr><td><code>Riskpca</code></td>
<td>
<p>The plot of  Risk scores vs first PCA</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>References</h3>

<p>Bair E, Hastie T, Debashis P, Tibshirani R (2006).
&ldquo;Prediction by supervised principal components.&rdquo;
<em>American Statistics Association,</em>, <b>101</b>(473), 119&ndash;137.
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>,
<code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="stats.html#topic+princomp">princomp</a></code>,
<code><a href="#topic+SurvPlsClass">SurvPlsClass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Result = SurvPcaClass(Survival=Data$Survival, Mdata=t(Data$Mdata),
Censor=Data$Censor, Reduce = FALSE, Select = 150,
Prognostic = Data$Prognostic, Plots = FALSE, Quantile = 0.5)

## GETTING THE SURVIVAL REGRESSION OUTPUT
Result$SurvFit

## GETTING THE RISKSCORES
Result$Riskscores

### GETTING THE RISKGROUP
Result$Riskgroup

### OBTAINING THE FIRST PRINCIPAL COMPONENT SCORES
Result$pc1
</code></pre>

<hr>
<h2 id='SurvPlsClass'>Survival PLS and Classification for metabolic data</h2><span id='topic+SurvPlsClass'></span>

<h3>Description</h3>

<p>The function performs partial least squares (PLS)  and principal component regression on Metabolomics matrix and fit Cox proportional hazard model with covariates using the first PLS scores as covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurvPlsClass(
  Survival,
  Mdata,
  Censor,
  Reduce = TRUE,
  Select = 150,
  Prognostic = NULL,
  Plots = FALSE,
  Quantile = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SurvPlsClass_+3A_survival">Survival</code></td>
<td>
<p>A vector of survival time with length equals to number of subjects</p>
</td></tr>
<tr><td><code id="SurvPlsClass_+3A_mdata">Mdata</code></td>
<td>
<p>A large or small metabolic profile matrix. A matrix with metabolic profiles where the number of rows should be equal to the number of metabolites and number of columns should be equal to number of patients.</p>
</td></tr>
<tr><td><code id="SurvPlsClass_+3A_censor">Censor</code></td>
<td>
<p>A vector of censoring indicator</p>
</td></tr>
<tr><td><code id="SurvPlsClass_+3A_reduce">Reduce</code></td>
<td>
<p>A boolean parameter indicating if the metabolic profile matrix should be reduced, default is TRUE and larger metabolic profile matrix is reduced by supervised pca approach and first pca is extracted from the reduced matrix to be used in the classifier.</p>
</td></tr>
<tr><td><code id="SurvPlsClass_+3A_select">Select</code></td>
<td>
<p>Number of  metabolites (default is 15) to be selected from supervised PCA. This is valid only if th argument Reduce=TRUE</p>
</td></tr>
<tr><td><code id="SurvPlsClass_+3A_prognostic">Prognostic</code></td>
<td>
<p>A dataframe containing possible prognostic(s) factor and/or treatment effect to be used in the model.</p>
</td></tr>
<tr><td><code id="SurvPlsClass_+3A_plots">Plots</code></td>
<td>
<p>A boolean parameter indicating if the plots should be shown. Default is FALSE</p>
</td></tr>
<tr><td><code id="SurvPlsClass_+3A_quantile">Quantile</code></td>
<td>
<p>The cut off value for the classifier, default is the median cutoff</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function reduces larger metabolomics matrix to smaller version using supervised pca approach. The function performs the PLS on the reduced metabolomics matrix and fit Cox proportional hazard model with first PLS scores as a covariate afterwards. And classifier is then built based on the first PLS scores multiplied by its estimated regression coefficient. Patients are classified using median of the risk scores. The function can also perform grid analysis where the grid will be several quantiles but the default is median. This function can handle single and multiple metabolites. Prognostic factors can also be included to enhance classification.
</p>


<h3>Value</h3>

<p>A object is returned with the following values
</p>
<table>
<tr><td><code>Survfit</code></td>
<td>
<p>The cox proportional regression result using the first PCA</p>
</td></tr>
<tr><td><code>Riskscores</code></td>
<td>
<p>A vector of risk scores which is equal to the number of patents.</p>
</td></tr>
<tr><td><code>Riskgroup</code></td>
<td>
<p>The classification of the subjects based on the PCA into low or high risk group</p>
</td></tr>
<tr><td><code>pc1</code></td>
<td>
<p>The First PCA scores based on either the reduced Metabolite matrix or the full matrix</p>
</td></tr>
<tr><td><code>KMplot</code></td>
<td>
<p>The Kaplan-Meier survival plot of the riskgroup</p>
</td></tr>
<tr><td><code>SurvBPlot</code></td>
<td>
<p>The distribution of the survival in the riskgroup</p>
</td></tr>
<tr><td><code>Riskpca</code></td>
<td>
<p>The plot of  Risk scores vs first PCA</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olajumoke Evangelina Owokotomo, <a href="mailto:olajumoke.owokotomo@uhasselt.be">olajumoke.owokotomo@uhasselt.be</a>
</p>
<p>Ziv Shkedy
</p>


<h3>References</h3>

<p>Bair E, Hastie T, Debashis P, Tibshirani R (2006).
&ldquo;Prediction by supervised principal components.&rdquo;
<em>American Statistics Association,</em>, <b>101</b>(473), 119&ndash;137.
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>,
<code><a href="#topic+EstimateHR">EstimateHR</a></code>, <code><a href="pls.html#topic+plsr">plsr</a></code>,
<code><a href="#topic+SurvPcaClass">SurvPcaClass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## FIRSTLY SIMULATING A METABOLIC SURVIVAL DATA
Data = MSData(nPatients = 100, nMet = 150, Prop = 0.5)

## USING THE FUNCTION
Result = SurvPlsClass(Survival=Data$Survival, Mdata=t(Data$Mdata),
Censor=Data$Censor, Reduce = FALSE, Select = 150,
Prognostic = Data$Prognostic, Plots = FALSE, Quantile = 0.5)

## GETTING THE SURVIVAL REGRESSION OUTPUT
Result$SurvFit

## GETTING THE RISKSCORES
Result$Riskscores

### GETTING THE RISKGROUP
Result$Riskgroup

### OBTAINING THE FIRST PRINCIPAL COMPONENT SCORES
Result$pc1
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
