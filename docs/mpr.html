<!DOCTYPE html><html><head><title>Help for package mpr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mpr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addterm'>
<p>All Possible Single-Term Additions to / Deletions from a Multi-Parameter Regression (MPR) Model</p></a></li>
<li><a href='#Distributions'><p>Distributions in the <code>mpr</code> Package</p></a></li>
<li><a href='#extractIC'>
<p>Extracting Information Criteria for MPR models.</p></a></li>
<li><a href='#mpr'>
<p>Fitting a Multi-Parameter Regression (MPR) model.</p></a></li>
<li><a href='#predict.mpr'>
<p>Predict method for Multi-Parameter Regression (MPR) Fits</p></a></li>
<li><a href='#stepmpr'>
<p>Stepwise Selection Procedure for Multi-Parameter Regression (MPR) Models</p></a></li>
<li><a href='#summary.mpr'>
<p>Summarising Multi-Parameter Regression (MPR) Fits</p></a></li>
<li><a href='#update.mpr'>
<p>Update and Re-fit a Multi-Parameter Regression (MPR) Model Call</p></a></li>
<li><a href='#vcov.mpr'>
<p>Extracting variance-covariance matrix for MPR models.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multi-Parameter Regression (MPR)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-12-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Kevin Burke</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kevin Burke &lt;kevin.burke@ul.ie&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.14)</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival</td>
</tr>
<tr>
<td>Description:</td>
<td>Fitting Multi-Parameter Regression (MPR) models to right-censored survival data. These are flexible parametric regression models which extend standard models, for example, proportional hazards. See Burke &amp; MacKenzie (2016) &lt;<a href="https://doi.org/10.1111%2Fbiom.12625">doi:10.1111/biom.12625</a>&gt; and Burke et al (2020) &lt;<a href="https://doi.org/10.1111%2Frssc.12398">doi:10.1111/rssc.12398</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-07 17:26:07 UTC; Kevin Burke</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-08 01:42:44 UTC</td>
</tr>
</table>
<hr>
<h2 id='addterm'>
All Possible Single-Term Additions to / Deletions from a Multi-Parameter Regression (MPR) Model
</h2><span id='topic+addterm'></span><span id='topic+dropterm'></span>

<h3>Description</h3>

<p>Identifies all models which arise via single-term additions to / deletions from a
component (or, simultaneously, multiple components) of the supplied <code>mpr</code> model, fits all such
models and summarises these models in a table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addterm(object, upper = ~ ., comp = 1:(object$ncomp),
        aic = TRUE, bestmodel = object, ...)

dropterm(object, lower = ~ 1, comp = 1:(object$ncomp),
         aic = TRUE, bestmodel = object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addterm_+3A_object">object</code></td>
<td>

<p>an object of class &ldquo;<code>mpr</code>&rdquo; which is the result of a call to <code><a href="#topic+mpr">mpr</a></code>.
</p>
</td></tr>
<tr><td><code id="addterm_+3A_upper">upper</code></td>
<td>

<p>a one-sided <code>formula</code> (used in <code>addterm</code>) specifying a maximal model which must
include the current one.
</p>
</td></tr>
<tr><td><code id="addterm_+3A_lower">lower</code></td>
<td>

<p>a one-sided <code>formula</code> (used in <code>dropterm</code>) specifying a minimal model which must
be within the current one.
</p>
</td></tr>
<tr><td><code id="addterm_+3A_comp">comp</code></td>
<td>

<p>a numeric value (or vector) indicating the regression component (or components) where (simultaneous) 
additions / deletions occur. Note that &ldquo;<code>1</code>&rdquo; <code class="reqn"> = \lambda</code>, &ldquo;<code>2</code>&rdquo;
<code class="reqn"> = \gamma</code> and &ldquo;<code>3</code>&rdquo; <code class="reqn"> = \rho</code>.  For more information on the various components, 
see <code><a href="#topic+mpr">mpr</a></code> and <code><a href="#topic+distributions">distributions</a></code>.
</p>
</td></tr>
<tr><td><code id="addterm_+3A_aic">aic</code></td>
<td>

<p>logical. If <code>TRUE</code>, AIC is used as the basis for determining the best model among those
considered. If <code>FALSE</code>, BIC is used.
</p>
</td></tr>
<tr><td><code id="addterm_+3A_bestmodel">bestmodel</code></td>
<td>

<p>an initial best model which, by default, is the supplied current model. This argument is used within the
<code><a href="#topic+stepmpr">stepmpr</a></code> function but is unlikely to be used directly by the end user.
</p>
</td></tr>
<tr><td><code id="addterm_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to internal methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The hierarchy is respected when considering terms to be added or dropped, e.g., all main effects
contained in a second-order interaction must remain.
</p>
<p>When using <code>addterm</code>, the terms in the <code>upper</code> model formula must be a <em>superset</em>
of the terms for each regression component indicated by <code>comp</code>. For example, if component
1 is <code>~ a + b + c</code> and component 2 is <code>~ a + b</code> (and terms are to be added to both
simultaneously, i.e., <code>comp=1:2</code>),
then <code>upper = ~ a + b + c + d</code> is acceptable and means that the variable
<code>d</code> will be added simultaneously to components 1 and 2 (this can be written more compactly as
<code>upper = ~ . + d</code>). On the other hand, <code>~ a + b + d</code> is not acceptable since its terms do
not form a superset of the terms in component 1 (however, this would be acceptable if we were only
considering component 2, i.e., if <code>comp=2</code>).
</p>
<p>When using <code>dropterm</code>, the terms in the <code>lower</code> model formula must be a <em>subset</em>
of the terms for each regression component indicated by <code>comp</code>. Again, if component 1 is
<code>~ a + b + c</code> and component 2 is <code>~ a + b</code> (and terms are to be dropped from both
simultaneously, i.e., <code>comp=1:2</code>), then <code>lower = ~ a</code> is
acceptable and means that the variable <code>b</code> will be dropped simultaneously from components 1 and 2 
(this can be written more compactly as <code>lower = ~ . - b</code>). On the other hand, <code>~ c</code> is not
acceptable since its terms do not form a subset of the terms in component 2 (however, this would be
acceptable if we were only considering component 1, i.e., if <code>comp=1</code>).
</p>
<p>To summarise the above two paragraphs, the <code>upper</code> formula must <em>contain</em> each formula
corresponding to the components under consideration whereas the <code>lower</code> formula must <em>be
contained within</em> each of these formulae.
</p>






<h3>Value</h3>

<p>A <code>list</code> containing the following components:
</p>
<table>
<tr><td><code>modeltab</code></td>
<td>

<p>a table containing information about each of the fitted models. This information comes from the
&ldquo;<code>model</code>&rdquo; element of each of the <code>mpr</code> objects - see <code><a href="#topic+mpr">mpr</a></code> for details.
</p>
</td></tr>
<tr><td><code>bestmodel</code></td>
<td>

<p>the model with the lowest AIC (or BIC if <code>aic = FALSE</code>) among the fitted models including the
initial <code>bestmodel</code> passed to the <code>addterm</code> / <code>dropterm</code> function.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Burke.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mpr">mpr</a></code>, <code><a href="#topic+stepmpr">stepmpr</a></code>, <code><a href="#topic+update.mpr">update.mpr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Veterans' administration lung cancer data
veteran &lt;- survival::veteran
head(veteran)

# null model
mod1 &lt;- mpr(Surv(time, status) ~ list(~ 1, ~ 1), data=veteran)
mod1 # family = "Weibull" by default

# consider adding trt and celltype to component 1 
addterm(mod1, ~ trt + celltype, comp=1)

# consider adding trt and celltype to components 1 and 2 simultaneously
addterm(mod1, ~ trt + celltype, comp=1:2)$modeltab

# further examples
mod2 &lt;- mpr(Surv(time, status) ~ list(~ trt + celltype, ~ trt + karno),
            data=veteran)
dropterm(mod2, ~ 1, comp=1:2)$modeltab
dropterm(mod2, ~ 1, comp=1)$modeltab
dropterm(mod2, ~ 1, comp=2)$modeltab

# does nothing since celltype is only in component 1
dropterm(mod2, ~ . - celltype, comp=1:2)$modeltab 

# removes celltype from component 1
dropterm(mod2, ~ . - celltype, comp=1)$modeltab
</code></pre>

<hr>
<h2 id='Distributions'>Distributions in the <code>mpr</code> Package</h2><span id='topic+Distributions'></span><span id='topic+distributions'></span><span id='topic+Distribution'></span><span id='topic+distribution'></span><span id='topic+mprdists'></span><span id='topic+family'></span><span id='topic+Weibull'></span><span id='topic+WeibullAFT'></span><span id='topic+Gompertz'></span><span id='topic+Loglogistic'></span><span id='topic+TDL'></span><span id='topic+Burr'></span><span id='topic+PGW'></span>

<h3>Description</h3>

<p>Information on the distributions currently available within the <code>mpr</code> package.
</p>


<h3>Details</h3>

<p>When fitting a Multi-Parameter Regression (MPR) model to data, the underlying distribution is selected
using the &ldquo;<code>family</code>&rdquo; argument in the <code><a href="#topic+mpr">mpr</a></code> function.
</p>
<p>Currently the <code>mpr</code> package includes distributions which have upto three parameters:
</p>

<dl>
<dt>1</dt><dd>
<p><code class="reqn">\lambda</code>. This is a <em>scale</em> parameter which controls the overall magnitude of the hazard
function and is typically the &ldquo;interest&rdquo; parameter in standard Single-Parameter Regression
(SPR) models. The Multi-Parameter Regression (MPR) framework is more general and considers all
parameters to be of interest. 
</p>
</dd>
<dt>2</dt><dd>
<p><code class="reqn">\gamma</code>. This is a <em>shape</em> parameter which controls the time evolution of the hazard.
</p>
</dd>
<dt>3</dt><dd>
<p><code class="reqn">\rho</code>. This is an additional <em>shape</em> parameter which controls the time evolution of the
hazard (available within the Burr and PGW distributions).
</p>
</dd>
</dl>

<p>The MPR framework allows these parameters to depend on covariates as follows:
</p>
<p style="text-align: center;"><code class="reqn">g_1(\lambda) = x^T \beta</code>
</p>

<p style="text-align: center;"><code class="reqn">g_2(\gamma) = z^T \alpha</code>
</p>

<p style="text-align: center;"><code class="reqn">g_3(\rho) = w^T \tau</code>
</p>

<p>where <code class="reqn">g_1(.)</code>, <code class="reqn">g_2(.)</code> and <code class="reqn">g_3(.)</code> are appropriate link functions 
(log-link for positive parameters and identity-link for unconstrained parameters), <code class="reqn">x</code>, <code class="reqn">z</code> and 
<code class="reqn">w</code> are covariate vectors, which may or may not contain covariates in common, and <code class="reqn">\beta</code>,
<code class="reqn">\alpha</code> and <code class="reqn">\tau</code> are the corresponding vectors of regression coefficients.
</p>
<p>The distributions currently available are described below in terms of their hazard functions:
</p>

<table>
<tr>
 <td style="text-align: left;">

<code>family</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">  <b>Hazard <code class="reqn">h(t)</code></b> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<b>Parameters</b> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> <b>Note</b></td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">

<code>Weibull</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">
 \lambda \gamma t^{\gamma - 1} </code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">\lambda &gt; 0</code>, <code class="reqn">\gamma &gt; 0</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> SPR<code class="reqn">(\lambda)</code> <code class="reqn">=</code> PH </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">

<code>WeibullAFT</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">
 \lambda \gamma (\lambda t)^{\gamma - 1} </code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">\lambda &gt; 0</code>, <code class="reqn">\gamma &gt; 0</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">  SPR<code class="reqn">(\lambda)</code> <code class="reqn">=</code> AFT  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">

<code>Gompertz</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">
 \lambda \exp(\gamma t) </code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">\lambda &gt; 0</code>, <code class="reqn">\gamma \in (-\infty, \infty)</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">  SPR<code class="reqn">(\lambda)</code> <code class="reqn">=</code> PH </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">

<code>Loglogistic</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">
 \frac{\lambda \gamma t^{\gamma - 1}}{1 + \lambda t^\gamma} </code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">\lambda &gt; 0</code>, <code class="reqn">\gamma &gt; 0</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">  SPR<code class="reqn">(\lambda)</code> <code class="reqn">=</code> PO  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">

<code>TDL</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">
 \frac{\exp(\gamma t + \lambda)}{1+\exp(\gamma t + \lambda)} </code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">\lambda \in (-\infty, \infty)</code>, <code class="reqn">\gamma \in (-\infty, \infty)</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> ---  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">

<code>Burr</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">
 \frac{\lambda \gamma t^{\gamma - 1}}{1 + \lambda \rho t^\gamma} </code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">\lambda &gt; 0</code>, <code class="reqn">\gamma &gt; 0</code>, <code class="reqn">\rho &gt; 0</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">  ---  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">

<code>PGW</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>||<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">
 \lambda \gamma \rho t^{\gamma-1} (1+t^\gamma)^{\rho-1} </code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">
<code class="reqn">\lambda &gt; 0</code>, <code class="reqn">\gamma &gt; 0</code>, <code class="reqn">\rho &gt; 0</code> </td><td style="text-align: center;"><code style="white-space: pre;">&#8288;  &#8288;</code>|<code style="white-space: pre;">&#8288;  &#8288;</code></td><td style="text-align: left;">  SPR<code class="reqn">(\lambda)</code> <code class="reqn">=</code> PH 
</td>
</tr>

</table>

<p>The acronymns which appear in the table above are:
</p>

<dl>
<dt>SPR<code class="reqn">(\lambda)</code></dt><dd>
<p>a Single-Parameter Regression (SPR) model where covariates enter through the scale parameter,
<code class="reqn">\lambda</code>. For example, in the row corresponding to the <code>Weibull</code> model, &ldquo;SPR<code class="reqn">(\lambda)</code>
<code class="reqn">=</code> PH&rdquo; means that the Weibull SPR<code class="reqn">(\lambda)</code> model is a PH model. Thus, this standard parametric
PH model is generalised via the Weibull MPR model.
</p>
</dd>
<dt>PH</dt><dd>
<p>proportional hazards.
</p>
</dd>
<dt>AFT</dt><dd>
<p>accelerated failure time.
</p>
</dd>
<dt>PO</dt><dd>
<p>proportional odds.
</p>
</dd>
<dt>TDL</dt><dd>
<p>time-dependent logistic.
</p>
</dd>
<dt>PGW</dt><dd>
<p>power generalised Weibull.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Kevin Burke.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mpr">mpr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Veterans' administration lung cancer data
veteran &lt;- survival::veteran
head(veteran)

# Weibull MPR treatment model
mpr(Surv(time, status) ~ list(~ trt, ~ trt), data=veteran, family="Weibull")

# Burr MPR treatment model
mpr(Surv(time, status) ~ list(~ trt, ~ trt, ~ trt), data=veteran,
    family="Burr")

</code></pre>

<hr>
<h2 id='extractIC'>
Extracting Information Criteria for MPR models.
</h2><span id='topic+extractIC'></span>

<h3>Description</h3>

<p>This function extracts the Akaike Information Criterion (AIC) or Bayesian Information Criterion (BIC)
from a fitted <code><a href="#topic+mpr">mpr</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractIC(object, aic = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractIC_+3A_object">object</code></td>
<td>

<p>fitted <code><a href="#topic+mpr">mpr</a></code> model.
</p>
</td></tr>
<tr><td><code id="extractIC_+3A_aic">aic</code></td>
<td>

<p>logical. If <code>TRUE</code>, AIC is extracted. If <code>FALSE</code>, BIC is extracted.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The AIC or BIC value.
</p>


<h3>Author(s)</h3>

<p>Kevin Burke.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mpr">mpr</a></code>, <code><a href="#topic+addterm">addterm</a></code>, <code><a href="#topic+dropterm">dropterm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Veterans' administration lung cancer data
veteran &lt;- survival::veteran
head(veteran)

mod1 &lt;- mpr(Surv(time, status) ~ list(~ trt, ~ trt), data=veteran, family="Weibull")
mod1
extractIC(mod1) # AIC
extractIC(mod1, aic=FALSE) # BIC


</code></pre>

<hr>
<h2 id='mpr'>
Fitting a Multi-Parameter Regression (MPR) model.
</h2><span id='topic+mpr'></span><span id='topic+print.mpr'></span>

<h3>Description</h3>

<p>Fits a Multi-Parameter Regression (MPR) model using a Newton-type algorithm via the <code><a href="stats.html#topic+nlm">nlm</a></code>
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mpr(formula, data, family = "Weibull", init, iterlim = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mpr_+3A_formula">formula</code></td>
<td>

<p>a two-sided <code>formula</code> object with the response on the left hand side of the <code>~</code> operator
and a <code>list</code> of one-sided <code>formula</code> objects on the right hand side (one for each
regression component in the <code>mpr</code> model). The response must be a right-censored survival object
as returned by the <code>Surv</code> function. See &ldquo;Details&rdquo; for more information on the struture of
the formula within the <code>mpr</code> function as it differs from standard regression models.
</p>
</td></tr>
<tr><td><code id="mpr_+3A_data">data</code></td>
<td>

<p>an optional <code>data.frame</code> containing the variables in the model. If missing, the variables are 
taken from the <code>environment</code> from which <code>mpr</code> is called.
</p>
</td></tr> 
<tr><td><code id="mpr_+3A_family">family</code></td>
<td>

<p>the name of the parametric distribution to be used in the model. See <code><a href="#topic+distributions">distributions</a></code> for the 
list of distributions currently available.
</p>
</td></tr>
<tr><td><code id="mpr_+3A_init">init</code></td>
<td>

<p>an optional vector of initial values for the optimisation routine. If missing, default values
are used. One may also set <code>init="random"</code> to randomly generate initial values.
</p>
</td></tr>
<tr><td><code id="mpr_+3A_iterlim">iterlim</code></td>
<td>

<p>a positive integer specifying the maximum number of iterations to be performed before the
optimisation procedure is terminated. This is supplied to <code><a href="stats.html#topic+nlm">nlm</a></code>.
</p>
</td></tr>
<tr><td><code id="mpr_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to <code>nlm</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multi-Parameter Regression (MPR) models are generated by allowing <em>multiple</em> distributional parameters
to depend on covariates, for example, both the scale and shape parameters. This is in contrast to the
more typical approach where covariates enter a model only through <em>one</em> distributional parameter. As 
these standard models have a single regression component, we may refer to them as Single Parameter
Regression (SPR) models and, clearly, they are special cases of MPR models. The parameter through
which covariates enter such SPR models may be referred to as the &ldquo;interest&rdquo; parameter since it 
generally has some specific subject-matter importance. However, this standard approach neglects other
parameters which
may also be important in describing the phenomenon at hand. The MPR approach generalises the standard
SPR approach by viewing all distributional parameters as interest parameters in which covariate effects
can be investigated.
</p>
<p>In the context of survival analysis (currently the focus of the <code>mpr</code> package), the Weibull model
is one of the most popular parametric models. Its hazard function is given by
</p>
<p style="text-align: center;"><code class="reqn">
 h(t) = \lambda \gamma t^{\gamma - 1} </code>
</p>

<p>where <code class="reqn">\lambda &gt; 0</code>, the scale parameter, controls the overall magnitude of <code class="reqn">h(t)</code> and
<code class="reqn">\gamma &gt; 0</code>, the shape parameter, controls its time evolution. In the standard SPR Weibull model,
<code class="reqn">\lambda</code> depends on covariates via <code class="reqn">\log \lambda = x^T \beta</code> leading to a
proportional hazards (PH) model. The MPR model generalises this by allowing <em>both</em> parameters to
depend on covariates as follows
</p>
<p style="text-align: center;"><code class="reqn">\log \lambda = x^T \beta</code>
</p>

<p style="text-align: center;"><code class="reqn">\log \gamma = z^T \alpha</code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">z</code> are the scale and shape covariate vectors (which may or may not
contain covariates in common) and <code class="reqn">\beta</code> and <code class="reqn">\alpha</code> are the corresponding
regression coefficients.
</p>
<p>Note that the log-link is used above to ensure positivity of the parameters. More generally, we may
have
</p>
<p style="text-align: center;"><code class="reqn">g_1(\lambda) = x^T \beta</code>
</p>

<p style="text-align: center;"><code class="reqn">g_2(\gamma) = z^T \alpha</code>
</p>

<p>where <code class="reqn">g_1(\cdot)</code> and <code class="reqn">g_2(\cdot)</code> are appropriate link functions.
The <code>mpr</code> function does not
allow the user to alter these link functions but, rather, uses the following default link functions:
<b>log-link</b> (for parameters which must be <em>positive</em>) and <b>identity-link</b> (for parameters
which are <em>unconstrained</em>). Although the two-parameter Weibull distribution is discussed here
(due to its popularity), other distributions may have additional shape parameters, for example,
</p>
<p style="text-align: center;"><code class="reqn">g_3(\rho) = w^T \tau</code>
</p>

<p>where <code class="reqn">w</code> and <code class="reqn">\tau</code> are the vectors of covariates and regression coefficients for this
additional shape component. See <code><a href="#topic+distributions">distributions</a></code> for further details on the distributions
currently available.
</p>
<p>The struture of the <code>formula</code> within the <code>mpr</code> function is, for example,
<code>Surv(time, status) ~ list(~ x1 + x2, ~ x1)</code> which clearly generalises the typical <code>formula</code> used in
standard models (i.e., those with only one regression component) in the sense that the right hand side is a
<code>list</code> of one-sided <code>formula</code> objects. Note the requirement that the <code>~</code> operator
precedes each element within the <code>list</code>. Specifically, the example shown here represents the case
where the covariates <code>x1</code> and <code>x2</code> appear in the first regression component, <code class="reqn">\lambda</code>,
and the covariate <code>x2</code> appears in the second regression component, <code class="reqn">\gamma</code>. If there was a
third regression component, <code class="reqn">\rho</code>, then there would be an additional component in the <code>list</code>,
for example, <code>Surv(time, status) ~ list(~ x1 + x2, ~ x1, ~ x1)</code>. The <code>mpr</code> function also accepts
more typical two-sided <code>formula</code> objects, such as <code>Surv(time, status) ~ x1 + x2</code>, which imply that
the terms on the right hand side appear in <em>each</em> of the regression components.
</p>


<h3>Value</h3>

<p><code>mpr</code> returns an object of class &ldquo;<code>mpr</code>&rdquo;.
</p>
<p>The function <code>summary</code> (i.e., <code><a href="#topic+summary.mpr">summary.mpr</a></code>) can be used to obtain and print a summary
of the results. The the generic accessor function <code>coefficients</code> extracts the <code>list</code> of
regression coefficient vectors. One can also apply <code>predict</code> (i.e., <code><a href="#topic+predict.mpr">predict.mpr</a></code>) to
predict various quantites from the fitted <code>mpr</code> model. A stepwise variable selection procedure has
been implemented for <code>mpr</code> models - see <code><a href="#topic+stepmpr">stepmpr</a></code>.
</p>
<p>An object of class <code>mpr</code> is a <code>list</code> containing the following components: 
</p>
<table>
<tr><td><code>model</code></td>
<td>

<p>a <code>data.frame</code> containing useful information about the fitted model with the following headings:
</p>

<dl>
<dt><code>family</code></dt><dd>
<p>the chosen <code><a href="#topic+distribution">distribution</a></code>.
</p>
</dd>
<dt><code>npar</code></dt><dd>
<p>number of estimated parameters in the fitted model.
</p>
</dd>
<dt><code>loglike</code></dt><dd>
<p>value of the log-likelihood.
</p>
</dd>
<dt><code>aic</code></dt><dd>
<p>value of the AIC (Akaike Information Criterion).
</p>
</dd>
<dt><code>bic</code></dt><dd>
<p>value of the BIC (Bayesian Information Criterion).
</p>
</dd>
<dt><code>code</code></dt><dd>
<p>an integer indicating why the Newton optimisation procedure terminated (for more
details on this stop-code see <code><a href="stats.html#topic+nlm">nlm</a></code>) where, in particular, &ldquo;<code>1</code>&rdquo; means
&ldquo;relative gradient is close to zero&rdquo;. 
</p>
</dd>
</dl>

</td></tr>
<tr><td><code>coefficients</code></td>
<td>

<p>a <code>list</code> whose elements are named vectors of coefficients (one vector per regression component).
</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>

<p>the variance-covariance matrix for the estimates.
</p>
</td></tr>
<tr><td><code>gradient</code></td>
<td>

<p>the values of the (negative) score functions from <code><a href="stats.html#topic+nlm">nlm</a></code>.
</p>
</td></tr>
<tr><td><code>ncomp</code></td>
<td>

<p>the number of regression components in the model, i.e., the number of distributional parameters in the 
underlying <code><a href="#topic+distribution">distribution</a></code>.
</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>

<p>the <code>formula</code> supplied.
</p>
</td></tr>
<tr><td><code>xvars</code></td>
<td>

<p>a record of the names of all variables (i.e., covariates) used in fitting.
</p>
</td></tr>
<tr><td><code>xlevels</code></td>
<td>

<p>a record of the levels of any <code><a href="base.html#topic+factor">factor</a>s</code> (i.e., categorical variables) used in fitting.
</p>
</td></tr>
<tr><td><code>call</code></td>
<td>

<p>the matched call.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Burke.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distributions">distributions</a></code>, <code><a href="#topic+summary.mpr">summary.mpr</a></code>, <code><a href="#topic+predict.mpr">predict.mpr</a></code>,
<code><a href="#topic+stepmpr">stepmpr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Veterans' administration lung cancer data
veteran &lt;- survival::veteran
head(veteran)

# treatment variable, "trt", in scale (lambda) and shape (gamma)
# components of a Weibull model
mpr(Surv(time, status) ~ list(~ trt, ~ trt), data=veteran, family="Weibull")

# same as first model
mpr(Surv(time, status) ~ trt, data=veteran, family="Weibull")

# now with "celltype" also appearing in the scale
mpr(Surv(time, status) ~ list(~ trt + celltype, ~ trt), data=veteran,
    family="Weibull")

# trt in scale only (this is a PH Weibull model)
mpr(Surv(time, status) ~ list(~ trt, ~ 1), data=veteran, family="Weibull")

# trt in all three components (scale and two shape parameters) of a Burr model
mpr(Surv(time, status) ~ list(~ trt, ~ trt, ~ trt), data=veteran,
    family="Burr")

# use of summary
mod1 &lt;- mpr(Surv(time, status) ~ list(~ trt, ~ trt), data=veteran)
summary(mod1)
</code></pre>

<hr>
<h2 id='predict.mpr'>
Predict method for Multi-Parameter Regression (MPR) Fits
</h2><span id='topic+predict.mpr'></span>

<h3>Description</h3>

<p>Survival predictions based on <code>mpr</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mpr'
predict(object, newdata, type = c("survivor", "hazard", "percentile"),
        tvec, prob = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mpr_+3A_object">object</code></td>
<td>

<p>an object of class &ldquo;<code>mpr</code>&rdquo; which is the result of a call to <code><a href="#topic+mpr">mpr</a></code>.
</p>
</td></tr>
<tr><td><code id="predict.mpr_+3A_newdata">newdata</code></td>
<td>

<p><code>data.frame</code> in which to look for variables with which to predict. 
</p>
</td></tr>
<tr><td><code id="predict.mpr_+3A_type">type</code></td>
<td>

<p>type of prediction which may be a survivor function, hazard function or percentile value.
</p>
</td></tr>
<tr><td><code id="predict.mpr_+3A_tvec">tvec</code></td>
<td>

<p>vector of times at which the predicted survivor or hazard function will be evaluated. Only required
if <code>type</code> is <code>"survivor"</code> or <code>"hazard"</code>.
</p>
</td></tr>
<tr><td><code id="predict.mpr_+3A_prob">prob</code></td>
<td>

<p>numeric value between 0 and 1 (i.e., probability) indicating the percentile to be predicted. By
default <code>prob = 0.5</code> which corresponds to the median value. Only required if <code>type</code> is 
<code>"percentile"</code>.
</p>
</td></tr>
<tr><td><code id="predict.mpr_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of predictions whose rows correspond to the rows of <code>newdata</code>. When <code>type</code>
is <code>"survivor"</code> or <code>"hazard"</code>, this matrix of predictions has columns
corresponding to <code>tvec</code>. However, when <code>type</code> is <code>"percentile"</code>, the matrix only
has one column.
</p>


<h3>Author(s)</h3>

<p>Kevin Burke.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mpr">mpr</a></code>, <code><a href="#topic+summary.mpr">summary.mpr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)

# Veterans' administration lung cancer data
veteran &lt;- survival::veteran
head(veteran)

# Weibull MPR treatment model
mod1 &lt;- mpr(Surv(time, status) ~ list(~ trt, ~ trt), data=veteran,
            family="Weibull")

# predicted survivor function evaluated at four times
predict(mod1, newdata=data.frame(trt=c(1,2)), type="survivor",
        tvec=c(25, 50, 100, 150))

# predicted percentiles
predict(mod1, newdata=data.frame(trt=c(1,2)), type="percentile", prob=0.5)
predict(mod1, newdata=data.frame(trt=c(1,2)), type="percentile", prob=0.1)

# comparing predicted survivor functions to Kaplan-Meier curves
KM &lt;- survfit(Surv(time, status) ~ trt, data=veteran)
plot(KM, col=1:2)
tvec &lt;- seq(0, max(KM$time), length=100)
Stpred &lt;- predict(mod1, newdata=data.frame(trt=c(1,2)), type="survivor",
                  tvec=tvec)
lines(tvec, Stpred[1,])
lines(tvec, Stpred[2,], col=2)
</code></pre>

<hr>
<h2 id='stepmpr'>
Stepwise Selection Procedure for Multi-Parameter Regression (MPR) Models
</h2><span id='topic+stepmpr'></span>

<h3>Description</h3>

<p>Applies a stepwise selection procedure to an object of class &ldquo;<code>mpr</code>&rdquo; to find the best model
in the sense of AIC (or BIC).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stepmpr(object, scope = list(lower = ~ 1, upper = ~ .),
        comp = 1:(object$ncomp), direction = c("both", "backward", "forward"),
        joint = TRUE, jointonly = FALSE, aic = TRUE, trace = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepmpr_+3A_object">object</code></td>
<td>

<p>an object of class &ldquo;<code>mpr</code>&rdquo; which is the result of a call to <code><a href="#topic+mpr">mpr</a></code>.
</p>
</td></tr>
<tr><td><code id="stepmpr_+3A_scope">scope</code></td>
<td>

<p>either a single formula defining the <code>upper</code> (maximal) model or a list containing two formulae - 
the <code>lower</code> (minimal) and <code>upper</code> (maximal) models respectively. See &ldquo;Details&rdquo; for
further information.
</p>
</td></tr>
<tr><td><code id="stepmpr_+3A_comp">comp</code></td>
<td>

<p>a numeric vector indicating the regression component(s) to which the selection procedure should be
applied. Note that &ldquo;<code>1</code>&rdquo; <code class="reqn"> = \lambda</code>, &ldquo;<code>2</code>&rdquo; <code class="reqn"> = \gamma</code> and
&ldquo;<code>3</code>&rdquo; <code class="reqn"> = \rho</code>. For more information on the various components, see <code><a href="#topic+mpr">mpr</a></code>
and <code><a href="#topic+distributions">distributions</a></code>. 
</p>
</td></tr>
<tr><td><code id="stepmpr_+3A_direction">direction</code></td>
<td>

<p>the mode of stepwise search, which can be one of <code>"both"</code>, <code>"backward"</code>, or <code>"forward"</code>,
with a default of <code>"both"</code>.
</p>
</td></tr>
<tr><td><code id="stepmpr_+3A_joint">joint</code></td>
<td>

<p>logical. If <code>TRUE</code>, the selection procedure carries out <em>joint</em> component (i.e., 
simultaneous) steps in addition to <em>individual</em> component steps. If <code>FALSE</code>, only individual
component steps are carried out. See &ldquo;Details&rdquo; for more information.
</p>
</td></tr>
<tr><td><code id="stepmpr_+3A_jointonly">jointonly</code></td>
<td>

<p>logical. If <code>TRUE</code>, the selection procedure only carries out <em>joint</em> component steps.  
</p>
</td></tr>
<tr><td><code id="stepmpr_+3A_aic">aic</code></td>
<td>

<p>logical. If <code>TRUE</code>, AIC is used as the basis for determining the best model among those
considered. If <code>FALSE</code>, BIC is used.
</p>
</td></tr>
<tr><td><code id="stepmpr_+3A_trace">trace</code></td>
<td>

<p>if positive, information is printed during the running of <code>stepmpr</code>. Larger values may give more
detailed information. 
</p>
</td></tr>
<tr><td><code id="stepmpr_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to internal methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>stepmpr</code> uses repeated calls to <code><a href="#topic+addterm">addterm</a></code> and
<code><a href="#topic+dropterm">dropterm</a></code> and is based on the idea that variable selection should be applied to
each component individually <em>and</em> to all components jointly (when <code>joint = TRUE</code>). As an example,
consider the case where forward selection (<code>direction = "forward"</code>) will be carried out in components
1 and 2 individually (<code>comp = 1:2</code>) <em>and</em> jointly (<code>joint = TRUE</code>). At a given iteration of
the algorithm, the following single-term additions are then carried out:
</p>

<dl>
<dt>individual step <code>1</code>:</dt><dd>
<p>each term currently absent from component 1 will be considered.
</p>
</dd>
<dt>individual step <code>2</code>:</dt><dd>
<p>each term currently absent from component 2 will be considered.
</p>
</dd>
<dt>joint step <code>1&amp;2</code>:</dt><dd>
<p>each term currently absent from both components 1 and 2 will be considered.
</p>
</dd>
</dl>

<p>The reason for the joint step is to account for the possibility that a covariate may only appear significant
when it is present simultaneously in <em>both</em> regression components. This situation can arise as the
variance-covariance matrix for the estimated regression coefficients is typically not block diagonal with
respect to the regression components and, in particular, coefficients for the same covariate in
different components are typically highly correlated. Of course, the <code>stepmpr</code> function has the
flexibility to carry individual steps only, joint steps only or individual steps in a particular component
only as the end user prefers. See &ldquo;Examples&rdquo; below.
</p>
<p>The set of models searched is determined by the <code>scope</code> argument which is either a single
<code>upper</code> formula or a list whose elements are <code>lower</code> and <code>upper</code> formulae. The
<code>upper</code> formula must <em>contain</em> each formula corresponding to the components under
consideration (as indicated by <code>comp</code>) whereas the <code>lower</code> formula must <em>be contained
within</em> each of these formulae. For more information on the use of <code>lower</code> and <code>upper</code>, see
<code><a href="#topic+addterm">addterm</a></code>.
</p>
<p>If <code>scope</code> is missing, the <code>lower</code> model is simply the null model (i.e., a model with no 
covariates) and the <code>upper</code> model is formed using terms from the initial model; specifically, 
all terms from the regession components under consideration (as indicated by <code>comp</code>) are used
in the <code>upper</code> formula.
</p>


<h3>Value</h3>

<p>A final &ldquo;best&rdquo; <code>mpr</code> model as selected using the stepwise procedure.
</p>


<h3>Author(s)</h3>

<p>Kevin Burke.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mpr">mpr</a></code>, <code><a href="#topic+dropterm">dropterm</a></code>, <code><a href="#topic+addterm">addterm</a></code>, <code><a href="#topic+update.mpr">update.mpr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Veterans' administration lung cancer data
veteran &lt;- survival::veteran
head(veteran)

#######
mod0 &lt;- mpr(Surv(time, status) ~ 1, data=veteran)
mod0 # family = "Weibull" by default

# the "upper" model formula (by default the lower will be ~ 1)
scope &lt;- ~ trt + celltype

stepmpr(mod0, scope)
stepmpr(mod0, scope, direction="forward", aic=FALSE)

# individual steps only
stepmpr(mod0, scope, joint=FALSE)

# joint steps only
stepmpr(mod0, scope, jointonly=TRUE)

# component 1 only (and, hence, only individual steps)
stepmpr(mod0, scope, comp=1)

#######
mod1 &lt;- mpr(Surv(time, status) ~ trt + celltype, data=veteran)
mod1

stepmpr(mod1)
stepmpr(mod1, scope = ~ .^2)

# "lower" model formula forces trt to stay in
stepmpr(mod1, scope = list(~trt, ~.))

</code></pre>

<hr>
<h2 id='summary.mpr'>
Summarising Multi-Parameter Regression (MPR) Fits
</h2><span id='topic+summary.mpr'></span><span id='topic+print.summary.mpr'></span><span id='topic+overallpval'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &ldquo;<code>mpr</code>&rdquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mpr'
summary(object, overall = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mpr_+3A_object">object</code></td>
<td>

<p>an object of class &ldquo;<code>mpr</code>&rdquo; which is the result of a call to <code><a href="#topic+mpr">mpr</a></code>.
</p>
</td></tr>
<tr><td><code id="summary.mpr_+3A_overall">overall</code></td>
<td>

<p>logical. If <code>TRUE</code>, p-values testing the overall effect of a covariate are shown. See
&ldquo;Details&rdquo; for more information.
</p>
</td></tr>
<tr><td><code id="summary.mpr_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>print.summary.lm</code> produces a typical table of coefficients, standard errors and
p-values along with &ldquo;significance stars&rdquo;. In addition, a table of overall p-values are shown.
</p>
<p>Multi-Parameter Regression (MPR) models are defined by allowing mutliple distributional parameters to
depend on covariates. The regression components are:
</p>
<p style="text-align: center;"><code class="reqn">g_1(\lambda) = x^T \beta</code>
</p>

<p style="text-align: center;"><code class="reqn">g_2(\gamma) = z^T \alpha</code>
</p>

<p style="text-align: center;"><code class="reqn">g_3(\rho) = w^T \tau</code>
</p>

<p>and the table of coefficients displayed by <code>print.summary.lm</code> follows this ordering.
Furthermore, the names of the coefficients in the table are proceeded by &ldquo;<code>.b</code>&rdquo; for
<code class="reqn">\beta</code> coefficients, &ldquo;<code>.a</code>&rdquo; for <code class="reqn">\alpha</code> coefficients and &ldquo;<code>.t</code>&rdquo; for
<code class="reqn">\tau</code> coefficients to avoid ambiguity.
</p>
<p>Let us assume that a covariate <code class="reqn">c</code>, say, appears in both the <code class="reqn">\lambda</code> and <code class="reqn">\gamma</code>
regression components. The standard table of coefficients provides p-values corresponding to the following
null hypotheses:
</p>
<p style="text-align: center;"><code class="reqn">H_0: \beta_c = 0</code>
</p>

<p style="text-align: center;"><code class="reqn">H_0: \alpha_c = 0</code>
</p>
 
<p>where <code class="reqn">\beta_c</code> and <code class="reqn">\alpha_c</code> are the regression coefficients of <code class="reqn">c</code> (one for each of the
two components in which <code class="reqn">c</code> appears). However, in the context of MPR models, it may be of interest
to test the hypothesis that the <b>overall</b> effect of <code class="reqn">c</code> is zero, i.e., that its <code class="reqn">\beta</code>
<em>and</em> <code class="reqn">\alpha</code> effects are jointly zero:
</p>
<p style="text-align: center;"><code class="reqn">H_0: \beta_c = \alpha_c = 0</code>
</p>

<p>Thus, if <code>overall=TRUE</code>, <code>print.summary.lm</code> displays a table of such &ldquo;overall p-values&rdquo;.
</p>


<h3>Value</h3>

<p>The function <code>summary.mpr</code> returns a <code>list</code> containing the following components: 
</p>
<table>
<tr><td><code>call</code></td>
<td>

<p>the matched call from the <code>mpr</code> object.
</p>
</td></tr>
<tr><td><code>model</code></td>
<td>

<p>a <code>data.frame</code> containing useful information about the fitted model. This is the same as the
&ldquo;<code>model</code>&rdquo; element of the <code>mpr</code> object - see <code><a href="#topic+mpr">mpr</a></code> for details.
</p>
</td></tr>
<tr><td><code>coefmat</code></td>
<td>

<p>a typical coefficient matrix whose columns are the estimated regression coefficients,
standard errors and p-values.
</p>
</td></tr>
<tr><td><code>overallpmat</code></td>
<td>

<p>a matrix containing the overall p-values as described above in &ldquo;Details&rdquo;.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Burke.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mpr">mpr</a></code>, <code><a href="#topic+predict.mpr">predict.mpr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Veterans' administration lung cancer data
veteran &lt;- survival::veteran
head(veteran)

# Weibull MPR treatment model (family = "Weibull" by default)
mod1 &lt;- mpr(Surv(time, status) ~ list(~ trt, ~ trt), data=veteran)

summary(mod1)
</code></pre>

<hr>
<h2 id='update.mpr'>
Update and Re-fit a Multi-Parameter Regression (MPR) Model Call
</h2><span id='topic+update.mpr'></span>

<h3>Description</h3>

<p>Updates the right-hand side of the <code>formula</code> and re-fits the <code>mpr</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mpr'
update(object, new, comp = 1:(object$ncomp), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update.mpr_+3A_object">object</code></td>
<td>

<p>an object of class &ldquo;<code>mpr</code>&rdquo; which is the result of a call to <code><a href="#topic+mpr">mpr</a></code>.
</p>
</td></tr>
<tr><td><code id="update.mpr_+3A_new">new</code></td>
<td>

<p>either a one-sided <code>formula</code> (in which case the <code>comp</code> argument is also required) or a
<code>list</code> of one-sided <code>formula</code> objects whose length is equal
to the number of regression components in the <code>mpr</code> object, e.g., the Weibull model has two components. 
</p>
</td></tr>
<tr><td><code id="update.mpr_+3A_comp">comp</code></td>
<td>

<p>a numeric vector indicating the regression component(s) to be updated (only needed when <code>new</code> is
a one-sided <code>formula</code>) where &ldquo;<code>1</code>&rdquo; <code class="reqn"> = \lambda</code>, &ldquo;<code>2</code>&rdquo;
<code class="reqn"> = \gamma</code> and &ldquo;<code>3</code>&rdquo; <code class="reqn"> = \rho</code>.  For more information on the various components,
see <code><a href="#topic+mpr">mpr</a></code> and <code><a href="#topic+distributions">distributions</a></code>.
</p>
</td></tr>
<tr><td><code id="update.mpr_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to the updated <code>mpr</code> call.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two ways in whcih the <code>update.mpr</code> function can be used. The first specificies which
component(s) will be updated
(via the <code>comp</code> argument) along with the update to be applied via <code>new</code> which must then be a one-sided
<code>formula</code>. The second approach specifies both the components in question and the updates to be applied
through <code>new</code> which is a <code>list</code> of one-sided <code>formula</code> objects (in this case <code>comp</code>
is ignored). See &ldquo;Examples&rdquo; below.
</p>
<p>In the <code>new</code> formula (or list of formulae) . means &ldquo;what is already there&rdquo;.
</p>


<h3>Value</h3>

<p>The fitted, updated <code>mpr</code> object.
</p>


<h3>Author(s)</h3>

<p>Kevin Burke.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mpr">mpr</a></code>, <code><a href="#topic+addterm">addterm</a></code>, <code><a href="#topic+dropterm">dropterm</a></code>, <code><a href="#topic+stepmpr">stepmpr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Veterans' administration lung cancer data
veteran &lt;- survival::veteran
head(veteran)

# Weibull MPR treatment model
mod1 &lt;- mpr(Surv(time, status) ~ list(~ trt, ~ trt), data=veteran,
            family="Weibull")

# remove trt from first component
update(mod1, ~ . - trt, comp=1)
update(mod1, list(~ . - trt, ~ .))

# remove trt from both components
update(mod1, ~ . - trt, comp=1:2)
update(mod1, list(~ . - trt, ~ . - trt))

# add celltype to second component
update(mod1, ~ . + celltype, comp=2)
update(mod1, list(~ . , ~ . + celltype))

# simultaneously remove trt from first component and add celltype to second
# component. This is only possible using the approach where "new" is a list. 
update(mod1, list(~ . - trt, ~ . + celltype))

# can also update other things, e.g. "family"
update(mod1, ~ ., family="Gompertz")
update(mod1, ~ . + celltype, family="Loglogistic")

mod2 &lt;- update(mod1, ~ ., family="Burr") # change to Burr model
mod2
update(mod2, ~ . + celltype, comp=2:3) # add celltype to components 2 and 3
</code></pre>

<hr>
<h2 id='vcov.mpr'>
Extracting variance-covariance matrix for MPR models.
</h2><span id='topic+vcov.mpr'></span>

<h3>Description</h3>

<p>This function extracts the variance-covariance matrix for the estimated parameters from a fitted
<code><a href="#topic+mpr">mpr</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mpr'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.mpr_+3A_object">object</code></td>
<td>

<p>fitted <code><a href="#topic+mpr">mpr</a></code> model.
</p>
</td></tr>
<tr><td><code id="vcov.mpr_+3A_...">...</code></td>
<td>

<p>further arguments passed to or from other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The variance-covariance matrix.
</p>


<h3>Author(s)</h3>

<p>Kevin Burke.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mpr">mpr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Veterans' administration lung cancer data
veteran &lt;- survival::veteran
head(veteran)

mod1 &lt;- mpr(Surv(time, status) ~ list(~ trt, ~ trt), data=veteran, family="Weibull")
vcov(mod1)
mod1$vcov

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
