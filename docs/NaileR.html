<!DOCTYPE html><html lang="en"><head><title>Help for package NaileR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NaileR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#agri_studies'><p>Agribusiness studies survey</p></a></li>
<li><a href='#atomic_habit'><p>Atomic habits survey</p></a></li>
<li><a href='#atomic_habit_clust'><p>Atomic habits survey</p></a></li>
<li><a href='#beard'><p>Beard descriptions</p></a></li>
<li><a href='#beard_cont'><p>Beard descriptions</p></a></li>
<li><a href='#beard_wide'><p>Beard descriptions</p></a></li>
<li><a href='#boss'><p>Ideal boss survey</p></a></li>
<li><a href='#car_alone'><p>Atomic habits survey</p></a></li>
<li><a href='#dist_mat_llm'><p>LLM distance matrix</p></a></li>
<li><a href='#dist_ref_llm'><p>LLM response consistency</p></a></li>
<li><a href='#fabric'><p>Car seat fabrics</p></a></li>
<li><a href='#glossophobia'><p>Glossophobia survey</p></a></li>
<li><a href='#local_food'><p>Local food systems survey</p></a></li>
<li><a href='#nail_catdes'><p>Interpret a categorical latent variable</p></a></li>
<li><a href='#nail_condes'><p>Interpret a continuous latent variable</p></a></li>
<li><a href='#nail_descfreq'><p>Interpret the rows of a contingency table</p></a></li>
<li><a href='#nail_qda'><p>Interpret QDA data</p></a></li>
<li><a href='#nail_sort'><p>Sort textual data</p></a></li>
<li><a href='#nail_textual'><p>Interpret a group based on answers to open-ended questions</p></a></li>
<li><a href='#nutriscore'><p>Nutri-score survey</p></a></li>
<li><a href='#quality'><p>Perception of food quality</p></a></li>
<li><a href='#rorschach'><p>Rorschach inkblots</p></a></li>
<li><a href='#sim_llm'><p>LLM text similarity</p></a></li>
<li><a href='#waste'><p>Food waste survey</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Interpreting Latent Variables with AI</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>A small package designed for interpreting continuous and categorical latent variables. You provide a data set with a latent variable you want to understand and some other explanatory variables. It provides a description of the latent variable based on the explanatory variables. It also provides a name to the latent variable.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, stringr, FactoMineR, glue, ollamar, magrittr, tibble,
rlang, SensoMineR</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-18 18:58:27 UTC; sebastienle</td>
</tr>
<tr>
<td>Author:</td>
<td>Nel Hervé [aut],
  Sébastien Lê <a href="https://orcid.org/0000-0001-8814-6714"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sébastien Lê &lt;sebastien.le@institut-agro.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-19 00:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='agri_studies'>Agribusiness studies survey</h2><span id='topic+agri_studies'></span>

<h3>Description</h3>

<p>These data were collected after a Q-method-like survey on students' expectations of agribusiness studies.
Participants had to rank how much they agreed with 38 statements about possible benefits from agribusiness studies; then, they were asked personal questions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agri_studies
</code></pre>


<h3>Format</h3>

<p>A data frame with 53 rows (participants) and 42 columns (questions):
</p>

<ul>
<li><p> columns 1-38: statements about agribusiness studies
</p>
</li>
<li><p> columns 39-42: personal information
</p>
</li></ul>



<h3>Source</h3>

<p>Juliette LE COLLONNIER and Lou ROBERT, students at l'Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(NaileR)
data(agri_studies)

res_mca_agri &lt;- FactoMineR::MCA(agri_studies, quali.sup = 39:42,
level.ventil = 0.05, graph = FALSE)
agri_work &lt;- res_mca_agri$ind$coord |&gt; as.data.frame()
agri_work &lt;- agri_work[,1] |&gt; cbind(agri_studies)

intro_agri &lt;- "These data were collected after a survey
on students' expectations of agribusiness studies.
Participants had to rank how much they agreed with 38 statements
about possible benefits from agribusiness studies;
then, they were asked personal questions."
intro_agri &lt;- gsub('\n', ' ', intro_agri) |&gt;
stringr::str_squish()

res_agri &lt;- nail_condes(agri_work, num.var = 1,
introduction = intro_agri)
res_agri

## End(Not run)
</code></pre>

<hr>
<h2 id='atomic_habit'>Atomic habits survey</h2><span id='topic+atomic_habit'></span>

<h3>Description</h3>

<p>People think they need to make big changes to change
the course of their lives. But in James Clear's book,
Atomic Habits, they will discover that the smallest of changes,
coupled with a good knowledge of psychology and neuroscience,
can have a revolutionary effect on their lives and relationships.
To understand this concept of atomic habits, we interviewed 167 people
and asked them if they were able to never take their car alone again,
to buy local products...
We also asked them how restrictive they found this and why.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atomic_habit
</code></pre>


<h3>Format</h3>

<p>A data frame with 167 rows and 50 columns:
</p>

<ul>
<li><p> columns 1-10, do you feel able to...
</p>
</li>
<li><p> columns 11-20, from 0 to 5 how restrictive...
</p>
</li>
<li><p> columns 21-30, is it restrictive, yes or no...
</p>
</li>
<li><p> columns 31-40, justify your answers
</p>
</li>
<li><p> columns 41-50, a combination of able and restrictive
</p>
</li></ul>



<h3>Source</h3>

<p>Applied mathematics department, Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(FactoMineR)
library(NaileR)
data(atomic_habit)

res_mfa &lt;- MFA(atomic_habit[,1:30],
              group = c(10,10,10),
              type = c("n","s","n"),
              num.group.sup = 3,
              name.group = c("capable","restrictive", "restrictive binary"),
              graph = FALSE)

plot.MFA(res_mfa, choix = "ind", invisible = c("quali","quali.sup"),
        lab.ind = FALSE,
        title = "MFA based on being capable and restrictiveness data")

res_hcpc &lt;- HCPC(res_mfa, nb.clust = 3, graph = FALSE)
plot.HCPC(res_hcpc, choice = "map",
         draw.tree = FALSE,
         ind.names = FALSE,
         title = "Atomic habits - typology")
summary(res_hcpc$data.clust)

## End(Not run)
</code></pre>

<hr>
<h2 id='atomic_habit_clust'>Atomic habits survey</h2><span id='topic+atomic_habit_clust'></span>

<h3>Description</h3>

<p>People think they need to make big changes to change
the course of their lives. But in James Clear's book,
Atomic Habits, they will discover that the smallest of changes,
coupled with a good knowledge of psychology and neuroscience,
can have a revolutionary effect on their lives and relationships.
To understand this concept of atomic habits, we interviewed 167 people
and asked them if they were able to never take their car alone again,
to buy local products...
We also asked them how restrictive they found this and why.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atomic_habit_clust
</code></pre>


<h3>Format</h3>

<p>A data frame with 167 rows and 51 columns:
</p>

<ul>
<li><p> columns 1-10, do you feel able to...
</p>
</li>
<li><p> columns 11-20, from 0 to 5 how restrictive...
</p>
</li>
<li><p> columns 21-30, is it restrictive, yes or no...
</p>
</li>
<li><p> columns 31-40, justify your answers
</p>
</li>
<li><p> columns 41-50, a combination of able and restrictive
</p>
</li>
<li><p> column 51, cluster variable based on MFA (20 first variables)
</p>
</li></ul>



<h3>Source</h3>

<p>Applied mathematics department, Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(FactoMineR)
library(NaileR)
data(atomic_habit_clust)

catdes(atomic_habit_clust, num.var = 51)

## End(Not run)
</code></pre>

<hr>
<h2 id='beard'>Beard descriptions</h2><span id='topic+beard'></span>

<h3>Description</h3>

<p>These data refer to 8 types of beards.
Each beard was evaluated by 62 assessors (except beard 8 which only had 60 evaluations).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beard
</code></pre>


<h3>Format</h3>

<p>A data frame with 494 rows and 2 columns:
</p>

<ul>
<li><p> the types of beards;
</p>
</li>
<li><p> the words used to describe them.
</p>
</li></ul>



<h3>Source</h3>

<p>Applied mathematics department, Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

data(beard)
beard[1:8,]

## End(Not run)
</code></pre>

<hr>
<h2 id='beard_cont'>Beard descriptions</h2><span id='topic+beard_cont'></span>

<h3>Description</h3>

<p>These data refer to 8 types of beards.
Each beard was evaluated by 62 assessors (except beard 8 which only had 60 evaluations).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beard_cont
</code></pre>


<h3>Format</h3>

<p>A contingency table (data frame) with 8 rows and 337 columns:
</p>

<ul>
<li><p> rows are the types of beards;
</p>
</li>
<li><p> columns are the words used at least once to describe them.
</p>
</li></ul>



<h3>Source</h3>

<p>Applied mathematics department, Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(NaileR)
data(beard_cont)

FactoMineR::descfreq(beard_cont)

intro_beard &lt;- 'A survey was conducted about beards
and 8 types of beards were described.
In the data that follow, beards are named B1 to B8.'
intro_beard &lt;- gsub('\n', ' ', intro_beard) |&gt;
stringr::str_squish()

req_beard &lt;- 'Please give a name to each beard
and summarize what makes this beard unique.'
req_beard &lt;- gsub('\n', ' ', req_beard) |&gt;
stringr::str_squish()

res_beard &lt;- nail_descfreq(beard_cont,
introduction = intro_beard,
request = req_beard)
res_beard

## End(Not run)
</code></pre>

<hr>
<h2 id='beard_wide'>Beard descriptions</h2><span id='topic+beard_wide'></span>

<h3>Description</h3>

<p>These data refer to 8 types of beards. They come from a subset of the original &quot;beard&quot; dataset.
Each beard was evaluated by 62 assessors (except beard 8 which only had 60 evaluations).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beard_wide
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 24 columns:
</p>

<ul>
<li><p> rows are the types of beards;
</p>
</li>
<li><p> columns are the assessors' opinions.
</p>
</li></ul>



<h3>Source</h3>

<p>Applied mathematics department, Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(NaileR)
data(beard_wide)

intro_beard &lt;- "As a barber, you make
recommendations based on consumers comments.
Examples of consumers descriptions of beards
are as follows."
intro_beard &lt;- gsub('\n', ' ', intro_beard) |&gt;
stringr::str_squish()

res &lt;- nail_sort(beard_wide[,1:5], name_size = 3,
stimulus_id = "beard", introduction = intro_beard,
measure = 'the description was')
res$prompt_llm[[1]] |&gt; cat()

## End(Not run)
</code></pre>

<hr>
<h2 id='boss'>Ideal boss survey</h2><span id='topic+boss'></span>

<h3>Description</h3>

<p>These data were collected after a Q-method-like survey on participants' perception of an &quot;ideal boss&quot;.
Participants had to rank how much they agreed with 30 statements about an ideal boss; then, they were asked personal questions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boss
</code></pre>


<h3>Format</h3>

<p>A data frame with 73 rows (participants) and 39 columns (questions):
</p>

<ul>
<li><p> columns 1-30: statements about the ideal boss
</p>
</li>
<li><p> columns 31-39: personal information
</p>
</li></ul>



<h3>Source</h3>

<p>Florian LECLERE and Marianne ANDRE, students at l'Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(FactoMineR)
library(NaileR)
data(boss)
res_mca_boss &lt;- MCA(boss, quali.sup = 31:39,
ncp = 30, level.ventil = 0.05, graph = FALSE)
res_hcpc_boss &lt;- HCPC(res_mca_boss, nb.clust = 4, graph = FALSE)
don_clust_boss &lt;- res_hcpc_boss$data.clust

intro_boss &lt;- 'A study on "the ideal boss" was led on 73 participants.
The study had 2 parts. In the first part,
participants were given statements about the ideal boss
(starting with "My ideal boss...").
They had to rate, on a scale from 1 to 5,
how much they agreed with the statements;
1 being "Strongly disagree", 3 being "neutral"
and 5 being "Strongly agree".
In the second part, they were asked for personal information:
work experience, age, etc.
Participants were then split into groups based on their answers.'
intro_boss &lt;- gsub('\n', ' ', intro_boss) |&gt;
stringr::str_squish()

req_boss &lt;- "Please describe, for each group, their ideal boss.
Then, give each group a new name, based on your conclusions."
req_boss &lt;- gsub('\n', ' ', req_boss) |&gt;
stringr::str_squish()


res_boss &lt;- nail_catdes(don_clust_boss, num.var = 40,
introduction = intro_boss, request = req_boss,
isolate.groups = FALSE, drop.negative = TRUE)
res_boss |&gt; cat()

## End(Not run)
</code></pre>

<hr>
<h2 id='car_alone'>Atomic habits survey</h2><span id='topic+car_alone'></span>

<h3>Description</h3>

<p>People think they need to make big changes to change
the course of their lives. But in James Clear's book,
Atomic Habits, they will discover that the smallest of changes,
coupled with a good knowledge of psychology and neuroscience,
can have a revolutionary effect on their lives and relationships.
To understand this concept of atomic habits, we interviewed 167 people
and asked them if they were able to never take their car alone again,
to buy local products...
We also asked them how restrictive they found this and why.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>car_alone
</code></pre>


<h3>Format</h3>


<ul>
<li><p> column 1, a combination of being able and feeling restrictive
</p>
</li>
<li><p> column 2, justify your answer
</p>
</li></ul>



<h3>Source</h3>

<p>Applied mathematics department, Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(FactoMineR)
library(NaileR)
library(dplyr)
data(car_alone)
sampled_car_alone &lt;- car_alone %&gt;%
group_by(car_alone_capable_restrictive) %&gt;%
sample_frac(0.5)
sampled_car_alone &lt;- as.data.frame(sampled_car_alone)

intro_car &lt;- "Knowing the impact on the climate,
I have made these choices based on
the following benefits and constraints..."
intro_car &lt;- gsub('\n', ' ', intro_car) |&gt;
stringr::str_squish()
res_nail_textual &lt;- nail_textual(sampled_car_alone, num.var = 1,
                                num.text = 2,
                                introduction = intro_car,
                                request = NULL,
                                model = 'llama3', isolate.groups = TRUE,
                                generate = TRUE)
res_nail_textual[[1]]$response |&gt; cat()
res_nail_textual[[3]]$response |&gt; cat()
res_nail_textual[[2]]$response |&gt; cat()
res_nail_textual[[4]]$response |&gt; cat()

## End(Not run)
</code></pre>

<hr>
<h2 id='dist_mat_llm'>LLM distance matrix</h2><span id='topic+dist_mat_llm'></span>

<h3>Description</h3>

<p>Compute a distance matrix between randomly-generated responses to an LLM prompt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_mat_llm(ppt, n, per_miss = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_mat_llm_+3A_ppt">ppt</code></td>
<td>
<p>an LLM prompt.</p>
</td></tr>
<tr><td><code id="dist_mat_llm_+3A_n">n</code></td>
<td>
<p>the number of responses to be generated.</p>
</td></tr>
<tr><td><code id="dist_mat_llm_+3A_per_miss">per_miss</code></td>
<td>
<p>the proportion of missing values in the final matrix (between 0 and 1; 0 by default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The final percentage of missing values might differ from the per_miss parameter value; rather than a percentage of values being turned to NA, each value has a per_miss probability of being NA.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li><p> a list of the LLM results for each iteration;
</p>
</li>
<li><p> a distance matrix.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

data(iris)

intro_iris &lt;- "A study measured various parts of iris flowers
from 3 different species: setosa, versicolor and virginica.
I will give you the results from this study.
You will have to identify what sets these flowers apart."
intro_iris &lt;- gsub('\n', ' ', intro_iris) |&gt;
stringr::str_squish()

req_iris &lt;- "Please explain what makes each species distinct.
Also, tell me which species has the biggest flowers,
and which species has the smallest."
req_iris &lt;- gsub('\n', ' ', req_iris) |&gt;
stringr::str_squish()

res_iris &lt;- nail_catdes(iris, num.var = 5,
introduction = intro_iris, request = req_iris)

dist_mat_llm(res_iris$prompt, n = 5, per_miss = 0)

## End(Not run)
</code></pre>

<hr>
<h2 id='dist_ref_llm'>LLM response consistency</h2><span id='topic+dist_ref_llm'></span>

<h3>Description</h3>

<p>Compute distances between an LLM response of interest and some other responses to the same prompt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_ref_llm(ppt, ref, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_ref_llm_+3A_ppt">ppt</code></td>
<td>
<p>an LLM prompt.</p>
</td></tr>
<tr><td><code id="dist_ref_llm_+3A_ref">ref</code></td>
<td>
<p>the reference response.</p>
</td></tr>
<tr><td><code id="dist_ref_llm_+3A_n">n</code></td>
<td>
<p>the number of new responses to be generated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li><p> a list with the newly-generated prompts;
</p>
</li>
<li><p> a vector of distances to the reference response.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

data(iris)

intro_iris &lt;- "A study measured various parts of iris flowers
from 3 different species: setosa, versicolor and virginica.
I will give you the results from this study.
You will have to identify what sets these flowers apart."
intro_iris &lt;- gsub('\n', ' ', intro_iris) |&gt;
stringr::str_squish()

req_iris &lt;- "Please explain what makes each species distinct.
Also, tell me which species has the biggest flowers,
and which species has the smallest."
req_iris &lt;- gsub('\n', ' ', req_iris) |&gt;
stringr::str_squish()

res_iris &lt;- nail_catdes(iris, num.var = 5,
introduction = intro_iris, request = req_iris)

dist_ref_llm(res_iris$prompt, res_iris$response, n = 5)

## End(Not run)
</code></pre>

<hr>
<h2 id='fabric'>Car seat fabrics</h2><span id='topic+fabric'></span>

<h3>Description</h3>

<p>This dataset was initially collected to understand the free jar data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fabric
</code></pre>


<h3>Format</h3>

<p>A data frame with 567 rows and 4 columns:
</p>

<ul>
<li><p> The ID of the judge
</p>
</li>
<li><p> The product
</p>
</li>
<li><p> The reason why the product was liked or disliked
</p>
</li>
<li><p> O if the product was disliked, 1 otherwise
</p>
</li></ul>



<h3>Source</h3>

<p>Applied mathematics department, Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(NaileR)
data(fabric)

intro_car &lt;- "For this consumer study,
a car seat fabric was evaluated by consumers.
Some of them didn't like it (group '0'),
others liked it (group '1'). The consumers
gave their reasons for disliking or liking the fabric."
intro_car &lt;- gsub('\n', ' ', intro_car) |&gt;
stringr::str_squish()

request_car &lt;- "Based on the comments provided by the consumers,
please explain the reasons why
the fabric was not appreciated for group '0',
and the reasons why the fabric was appreciated for group '1'.
In other words, what are the drivers
for disliking and liking this fabric."
request_car &lt;- gsub('\n', ' ', request_car) |&gt;
stringr::str_squish()

fabric_A &lt;- droplevels(fabric[fabric$Fabric=="A",])

res_nail_textual_fabric &lt;- nail_textual(fabric_A, num.var = 4,
                                        num.text = 3,
                                        introduction = intro_car,
                                        request = request_car,
                                        model = 'llama3',
                                        isolate.groups = FALSE,
                                        generate = FALSE)
res_nail_textual_fabric |&gt; cat()

res_nail_textual_fabric &lt;- nail_textual(fabric_A, num.var = 4,
                                        num.text = 3,
                                        introduction = intro_car,
                                        request = request_car,
                                        model = 'llama3',
                                        isolate.groups = FALSE,
                                        generate = TRUE)
res_nail_textual_fabric$response |&gt; cat()

## End(Not run)
</code></pre>

<hr>
<h2 id='glossophobia'>Glossophobia survey</h2><span id='topic+glossophobia'></span>

<h3>Description</h3>

<p>These data were collected after a Q-method-like survey on participants' feelings about speaking in public.
Participants had to rank how much they agreed with 25 descriptions of speaking in public; then, they were asked personal questions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glossophobia
</code></pre>


<h3>Format</h3>

<p>A data frame with 139 rows (participants) and 41 columns (questions):
</p>

<ul>
<li><p> columns 1-25: descriptions of speaking in public
</p>
</li>
<li><p> columns 26-41: personal information
</p>
</li></ul>



<h3>Source</h3>

<p>Elina BIAU and Théo LEDAIN, students at l'Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(NaileR)
data(glossophobia)

res_mca_phobia &lt;- FactoMineR::MCA(glossophobia, quali.sup = 26:41,
level.ventil = 0.05, graph = FALSE)
phobia_work &lt;- res_mca_phobia$ind$coord |&gt; as.data.frame()
phobia_work &lt;- phobia_work[,1] |&gt; cbind(glossophobia)

intro_phobia &lt;- "These data were collected after a survey
on participants' feelings about speaking in public.
Participants had to rank how much they agreed with
25 descriptions of speaking in public;
then, they were asked personal questions."
intro_phobia &lt;- gsub('\n', ' ', intro_phobia) |&gt;
stringr::str_squish()

res_phobia &lt;- nail_condes(phobia_work, num.var = 1,
introduction = intro_phobia)
res_phobia

## End(Not run)
</code></pre>

<hr>
<h2 id='local_food'>Local food systems survey</h2><span id='topic+local_food'></span>

<h3>Description</h3>

<p>These data were collected after a Q-method-like survey on sustainable food systems.
Participants had to rank how acceptable they found 45 statements about a sustainable food system; then, they were asked if they agreed with 14 other statements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local_food
</code></pre>


<h3>Format</h3>

<p>A data frame with 573 rows (participants) and 63 columns (questions):
</p>

<ul>
<li><p> columns 1-45 statements about food systems
</p>
</li>
<li><p> columns 46-59 opinions
</p>
</li>
<li><p> columns 60-63 personal information
</p>
</li></ul>



<h3>Source</h3>

<p>Applied mathematics department, Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(FactoMineR)
library(NaileR)
data(local_food)

res_mca_food &lt;- MCA(local_food, quali.sup = 46:63,
ncp = 100, level.ventil = 0.05, graph = FALSE)
res_hcpc_food &lt;- HCPC(res_mca_food, nb.clust = 3, graph = FALSE)
don_clust_food &lt;- res_hcpc_food$data.clust

intro_food &lt;- 'A study on sustainable food systems
was led on several French participants.
This study had 2 parts. In the first part,
participants had to rate how acceptable
"a food system that..." (e.g, "a food system that
only uses renewable energy") was to them.
In the second part, they had to say
if they agreed or disagreed with some statements.'
intro_food &lt;- gsub('\n', ' ', intro_food) |&gt;
stringr::str_squish()

req_food &lt;- 'I will give you the answers from one group.
Please explain who the individuals of this group are,
what their beliefs are.
Then, give this group a new name,
and explain why you chose this name.
Do not use 1st person ("I", "my"...) in your answer.'
req_food &lt;- gsub('\n', ' ', req_food) |&gt;
stringr::str_squish()

res_food &lt;- nail_catdes(don_clust_food, num.var = 64,
introduction = intro_food,
request = req_food,
isolate.groups = TRUE, drop.negative = TRUE)
res_food[[1]] |&gt; cat()

## End(Not run)
</code></pre>

<hr>
<h2 id='nail_catdes'>Interpret a categorical latent variable</h2><span id='topic+nail_catdes'></span>

<h3>Description</h3>

<p>Generate an LLM response to analyze a categorical latent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nail_catdes(
  dataset,
  num.var,
  introduction = NULL,
  request = NULL,
  model = "llama3",
  isolate.groups = FALSE,
  quali.sample = 1,
  quanti.sample = 1,
  drop.negative = FALSE,
  proba = 0.05,
  row.w = NULL,
  generate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nail_catdes_+3A_dataset">dataset</code></td>
<td>
<p>a data frame made up of at least one categorical variable and a set of quantitative variables and/or categorical variables.</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_num.var">num.var</code></td>
<td>
<p>the index of the variable to be characterized.</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_introduction">introduction</code></td>
<td>
<p>the introduction for the LLM prompt.</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_request">request</code></td>
<td>
<p>the request made to the LLM.</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_model">model</code></td>
<td>
<p>the model name ('llama3' by default).</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_isolate.groups">isolate.groups</code></td>
<td>
<p>a boolean that indicates whether to give the LLM a single prompt, or one prompt per category. Recommended with long catdes results.</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_quali.sample">quali.sample</code></td>
<td>
<p>from 0 to 1, the proportion of qualitative features that are randomly kept.</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_quanti.sample">quanti.sample</code></td>
<td>
<p>from 0 to 1, the proportion of quantitative features that are randomly kept.</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_drop.negative">drop.negative</code></td>
<td>
<p>a boolean that indicates whether to drop negative v.test values for interpretation (keeping only positive v.tests). Recommended with long catdes results.</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_proba">proba</code></td>
<td>
<p>the significance threshold considered to characterize the categories (by default 0.05).</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_row.w">row.w</code></td>
<td>
<p>a vector of integers corresponding to an optional row weights (by default, a vector of 1 for uniform row weights)</p>
</td></tr>
<tr><td><code id="nail_catdes_+3A_generate">generate</code></td>
<td>
<p>a boolean that indicates whether to generate the LLM response. If FALSE, the function only returns the prompt.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function directly sends a prompt to an LLM. Therefore, to get a consistent answer, we highly recommend to customize the parameters introduction and request and add all relevant information on your data for the LLM. We also recommend renaming the columns with clear, unshortened and unambiguous names.
</p>
<p>Additionally, if isolate.groups = TRUE, you will need an introduction and a request that take into account the fact that only one group is analyzed at a time.
</p>


<h3>Value</h3>

<p>A data frame, or a list of data frames, containing the LLM's prompt and response (if generate = TRUE).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

### Example 1: Fisher's iris ###
library(NaileR)
data(iris)

intro_iris &lt;- "A study measured various parts of iris flowers
from 3 different species: setosa, versicolor and virginica.
I will give you the results from this study.
You will have to identify what sets these flowers apart."
intro_iris &lt;- gsub('\n', ' ', intro_iris) |&gt;
stringr::str_squish()

req_iris &lt;- "Please explain what makes each species distinct.
Also, tell me which species has the biggest flowers,
and which species has the smallest."
req_iris &lt;- gsub('\n', ' ', req_iris) |&gt;
stringr::str_squish()

res_iris &lt;- nail_catdes(iris,
                        num.var = 5,
                        introduction = intro_iris,
                        request = req_iris,
                        generate = TRUE)

cat(res_iris$response)

### Example 2: food waste dataset ###

library(FactoMineR)

data(waste)
waste &lt;- waste[-14]    # no variability on this question

set.seed(1)
res_mca_waste &lt;- MCA(waste, quali.sup = c(1,2,50:76),
ncp = 35, level.ventil = 0.05, graph = FALSE)
plot.MCA(res_mca_waste, choix = "ind",
invisible = c("var", "quali.sup"), label = "none")
res_hcpc_waste &lt;- HCPC(res_mca_waste, nb.clust = 3, graph = FALSE)
plot.HCPC(res_hcpc_waste, choice = "map", draw.tree = FALSE,
ind.names = FALSE)
don_clust_waste &lt;- res_hcpc_waste$data.clust

intro_waste &lt;- 'These data were collected
after a survey on food waste,
with participants describing their habits.'
intro_waste &lt;- gsub('\n', ' ', intro_waste) |&gt;
stringr::str_squish()

req_waste &lt;- 'Please summarize the characteristics of each group.
Then, give each group a new name, based on your conclusions.
Finally, give each group a grade between 0 and 10,
based on how wasteful they are with food:
0 being "not at all", 10 being "absolutely".'
req_waste &lt;- gsub('\n', ' ', req_waste) |&gt;
stringr::str_squish()

res_waste &lt;- nail_catdes(don_clust_waste,
                         num.var = ncol(don_clust_waste),
                         introduction = intro_waste,
                         request = req_waste,
                         drop.negative = TRUE,
                         generate = TRUE)

cat(res_waste$response)


### Example 3: local_food dataset ###

data(local_food)

set.seed(1)
res_mca_food &lt;- MCA(local_food, quali.sup = 46:63,
ncp = 100, level.ventil = 0.05, graph = FALSE)
plot.MCA(res_mca_food, choix = "ind",
invisible = c("var", "quali.sup"), label = "none")
res_hcpc_food &lt;- HCPC(res_mca_food, nb.clust = 3, graph = FALSE)
plot.HCPC(res_hcpc_food, choice = "map", draw.tree = FALSE,
ind.names = FALSE)
don_clust_food &lt;- res_hcpc_food$data.clust

intro_food &lt;- 'A study on sustainable food systems
was led on several French participants.
This study had 2 parts. In the first part,
participants had to rate how acceptable
"a food system that..." (e.g, "a food system that
only uses renewable energy") was to them.
In the second part, they had to say
if they agreed or disagreed with some statements.'
intro_food &lt;- gsub('\n', ' ', intro_food) |&gt;
stringr::str_squish()

req_food &lt;- 'I will give you the answers from one group.
Please explain who the individuals of this group are,
what their beliefs are.
Then, give this group a new name,
and explain why you chose this name.
Do not use 1st person ("I", "my"...) in your answer.'
req_food &lt;- gsub('\n', ' ', req_food) |&gt;
stringr::str_squish()

res_food &lt;- nail_catdes(don_clust_food,
                        num.var = 64,
                        introduction = intro_food,
                        request = req_food,
                        isolate.groups = TRUE,
                        drop.negative = TRUE,
                        generate = TRUE)

res_food[[1]]$response |&gt; cat()
res_food[[2]]$response |&gt; cat()
res_food[[3]]$response |&gt; cat()

## End(Not run)
</code></pre>

<hr>
<h2 id='nail_condes'>Interpret a continuous latent variable</h2><span id='topic+nail_condes'></span>

<h3>Description</h3>

<p>Generate an LLM response to analyze a continuous latent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nail_condes(
  dataset,
  num.var,
  introduction = NULL,
  request = NULL,
  model = "llama3",
  quanti.threshold = 0,
  quanti.cat = c("Significantly above average", "Significantly below average", "Average"),
  weights = NULL,
  proba = 0.05,
  generate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nail_condes_+3A_dataset">dataset</code></td>
<td>
<p>a data frame made up of at least one quantitative variable and a set of quantitative variables and/or categorical variables.</p>
</td></tr>
<tr><td><code id="nail_condes_+3A_num.var">num.var</code></td>
<td>
<p>the index of the variable to be characterized.</p>
</td></tr>
<tr><td><code id="nail_condes_+3A_introduction">introduction</code></td>
<td>
<p>the introduction for the LLM prompt.</p>
</td></tr>
<tr><td><code id="nail_condes_+3A_request">request</code></td>
<td>
<p>the request made to the LLM.</p>
</td></tr>
<tr><td><code id="nail_condes_+3A_model">model</code></td>
<td>
<p>the model name ('llama3' by default).</p>
</td></tr>
<tr><td><code id="nail_condes_+3A_quanti.threshold">quanti.threshold</code></td>
<td>
<p>the threshold above (resp. below) which a scaled variable is considered significantly above (resp.below) the average. Used when converting continuous variables to categorical ones.</p>
</td></tr>
<tr><td><code id="nail_condes_+3A_quanti.cat">quanti.cat</code></td>
<td>
<p>a vector of the 3 possible categories for continuous variables converted to categorical ones according to the threshold. Default is &quot;above average&quot;, &quot;below average&quot; and &quot;average&quot;.</p>
</td></tr>
<tr><td><code id="nail_condes_+3A_weights">weights</code></td>
<td>
<p>weights for the individuals (see <code><a href="FactoMineR.html#topic+condes">FactoMineR::condes()</a></code>).</p>
</td></tr>
<tr><td><code id="nail_condes_+3A_proba">proba</code></td>
<td>
<p>the significance threshold considered to characterize the category (by default 0.05).</p>
</td></tr>
<tr><td><code id="nail_condes_+3A_generate">generate</code></td>
<td>
<p>a boolean that indicates whether to generate the LLM response. If FALSE, the function only returns the prompt.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function directly sends a prompt to an LLM. Therefore, to get a consistent answer, we highly recommend to customize the parameters introduction and request and add all relevant information on your data for the LLM. We also recommend renaming the columns with clear, unshortened and unambiguous names.
</p>


<h3>Value</h3>

<p>A data frame containing the LLM's prompt and response (if generate = TRUE).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

### Example 1: decathlon dataset ###

library(FactoMineR)
data(decathlon)

names(decathlon) &lt;- c('Time taken to complete the 100m',
'Distance reached for the long jump',
'Distance reached for the shot put',
'Height reached for the high jump',
'Time taken to complete the 400m',
'Time taken to complete the 110m hurdle',
'Distance reached for the discus',
'Height reached for the pole vault',
'Distance reached for the javeline',
'Time taken to complete the 1500 m',
'Rank/Counter-performance indicator',
'Points', 'Competition')

res_pca_deca &lt;- FactoMineR::PCA(decathlon,
quanti.sup = 11:12, quali.sup = 13, graph = FALSE)
plot.PCA(res_pca_deca, choix = 'var')
deca_work &lt;- res_pca_deca$ind$coord |&gt; as.data.frame()
deca_work &lt;- deca_work[,1] |&gt; cbind(decathlon)

intro_deca &lt;- "A study was led on athletes
participating in a decathlon event.
Their performance was assessed on each part of the decathlon,
and they were all placed on an unidimensional scale."
intro_deca &lt;- gsub('\n', ' ', intro_deca) |&gt;
stringr::str_squish()

res_deca &lt;- nail_condes(deca_work,
                        num.var = 1,
                        quanti.threshold = 1,
                        quanti.cat = c('High', 'Low', 'Average'),
                        introduction = intro_deca,
                        generate = TRUE)

cat(res_deca$response)


### Example 2: agri_studies dataset ###

data(agri_studies)

set.seed(1)
res_mca_agri &lt;- FactoMineR::MCA(agri_studies, quali.sup = 39:42,
level.ventil = 0.05, graph = FALSE)
plot.MCA(res_mca_agri, choix = 'ind',
invisible = c('var', 'quali.sup'), label = 'none')

agri_work &lt;- res_mca_agri$ind$coord |&gt; as.data.frame()
agri_work &lt;- agri_work[,1] |&gt; cbind(agri_studies)

intro_agri &lt;- "These data were collected after a survey
on students' expectations of agribusiness studies.
Participants had to rank how much they agreed with 38 statements
about possible benefits from agribusiness studies;
then, they were asked personal questions."
intro_agri &lt;- gsub('\n', ' ', intro_agri) |&gt;
stringr::str_squish()

res_agri &lt;- nail_condes(agri_work,
                        num.var = 1,
                        introduction = intro_agri,
                        generate = TRUE)

cat(res_agri$response)

### Example 3: glossophobia dataset ###

data(glossophobia)

set.seed(1)
res_mca_phobia &lt;- FactoMineR::MCA(glossophobia,
quali.sup = 26:41, level.ventil = 0.05, graph = FALSE)
plot.MCA(res_mca_phobia, choix = 'ind',
invisible = c('var', 'quali.sup'), label = 'none')

phobia_work &lt;- res_mca_phobia$ind$coord |&gt; as.data.frame()
phobia_work &lt;- phobia_work[,1] |&gt; cbind(glossophobia)

intro_phobia &lt;- "These data were collected after a survey
on participants' feelings about speaking in public.
Participants had to rank how much they agreed with
25 descriptions of speaking in public;
then, they were asked personal questions."
intro_phobia &lt;- gsub('\n', ' ', intro_phobia) |&gt;
stringr::str_squish()

res_phobia &lt;- nail_condes(phobia_work,
                          num.var = 1,
                          introduction = intro_phobia,
                          generate = TRUE)

cat(res_phobia$response)

### Example 4: beard_cont dataset ###

data(beard_cont)

set.seed(1)
res_ca_beard &lt;- FactoMineR::CA(beard_cont, graph = FALSE)
plot.CA(res_ca_beard, invisible = 'col')

beard_work &lt;- res_ca_beard$row$coord |&gt; as.data.frame()
beard_work &lt;- beard_work[,1] |&gt; cbind(beard_cont)

intro_beard &lt;- "These data refer to 8 types of beards.
Each beard was evaluated by 62 assessors."
intro_beard &lt;- gsub('\n', ' ', intro_beard) |&gt;
stringr::str_squish()

req_beard &lt;- "Please explain what differentiates beards
on both sides of the scale.
Then, give the scale a name."
req_beard &lt;- gsub('\n', ' ', req_beard) |&gt;
stringr::str_squish()

res_beard &lt;- nail_condes(beard_work,
                         num.var = 1,
                         quanti.threshold = 0.5,
                         quanti.cat = c('Very often used', 'Never used', 'Sometimes used'),
                         introduction = intro_beard,
                         request = req_beard)

res_beard

ppt &lt;- stringr::str_replace_all(res_beard, 'observations', 'beards')
cat(ppt)

res_beard &lt;- ollamar::generate(model = 'llama3', prompt = ppt, output = 'text')

cat(res_beard)

## End(Not run)
</code></pre>

<hr>
<h2 id='nail_descfreq'>Interpret the rows of a contingency table</h2><span id='topic+nail_descfreq'></span>

<h3>Description</h3>

<p>Describes the rows of a contingency table. For each row, this description is based on the columns of the contingency table that are significantly related to it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nail_descfreq(
  dataset,
  introduction = NULL,
  request = NULL,
  model = "llama3",
  isolate.groups = FALSE,
  by.quali = NULL,
  proba = 0.05,
  generate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nail_descfreq_+3A_dataset">dataset</code></td>
<td>
<p>a data frame corresponding to a contingency table.</p>
</td></tr>
<tr><td><code id="nail_descfreq_+3A_introduction">introduction</code></td>
<td>
<p>the introduction for the LLM prompt.</p>
</td></tr>
<tr><td><code id="nail_descfreq_+3A_request">request</code></td>
<td>
<p>the request made to the LLM.</p>
</td></tr>
<tr><td><code id="nail_descfreq_+3A_model">model</code></td>
<td>
<p>the model name ('llama3' by default).</p>
</td></tr>
<tr><td><code id="nail_descfreq_+3A_isolate.groups">isolate.groups</code></td>
<td>
<p>a boolean that indicates whether to give the LLM a single prompt, or one prompt per row. Recommended if the contingency table has a great number of rows.</p>
</td></tr>
<tr><td><code id="nail_descfreq_+3A_by.quali">by.quali</code></td>
<td>
<p>a factor used to merge the data from different rows of the contingency table; by default NULL and each row is characterized.</p>
</td></tr>
<tr><td><code id="nail_descfreq_+3A_proba">proba</code></td>
<td>
<p>the significance threshold considered to characterize the category (by default 0.05).</p>
</td></tr>
<tr><td><code id="nail_descfreq_+3A_generate">generate</code></td>
<td>
<p>a boolean that indicates whether to generate the LLM response. If FALSE, the function only returns the prompt.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function directly sends a prompt to an LLM. Therefore, to get a consistent answer, we highly recommend to customize the parameters introduction and request and add all relevant information on your data for the LLM.
</p>
<p>Additionally, if isolate.groups = TRUE, you will need an introduction and a request that take into account the fact that only one group is analyzed at a time.
</p>


<h3>Value</h3>

<p>A data frame, or a list of data frames, containing the LLM's prompt and response (if generate = TRUE).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

### Example 1: beard dataset ###

data(beard_cont)

intro_beard_iso &lt;- 'A survey was conducted about beards
and 8 types of beards were described.
I will give you the results for one type of beard.'
intro_beard_iso &lt;- gsub('\n', ' ', intro_beard_iso) |&gt;
stringr::str_squish()

req_beard_iso &lt;- 'Please give a name to this beard
and summarize what makes this beard unique.'
req_beard_iso &lt;- gsub('\n', ' ', req_beard_iso) |&gt;
stringr::str_squish()

res_beard &lt;- nail_descfreq(beard_cont,
                           introduction = intro_beard_iso,
                           request = req_beard_iso,
                           isolate.groups = TRUE,
                           generate = FALSE)

res_beard[[1]]
res_beard[[2]]

intro_beard &lt;- 'A survey was conducted about beards
and 8 types of beards were described.
In the data that follow, beards are named B1 to B8.'
intro_beard &lt;- gsub('\n', ' ', intro_beard) |&gt;
stringr::str_squish()

req_beard &lt;- 'Please give a name to each beard
and summarize what makes this beard unique.'
req_beard &lt;- gsub('\n', ' ', req_beard) |&gt;
stringr::str_squish()

res_beard &lt;- nail_descfreq(beard_cont,
                           introduction = intro_beard,
                           request = req_beard,
                           generate = TRUE)

cat(res_beard$response)

text &lt;- res_beard$response
titles &lt;- stringr::str_extract_all(text, "\\*\\*B[0-9]+: [^\\*\\*]+\\*\\*")[[1]]

titles

# for the following code to work, the response must have the beards'
# new names with this format: **B1: The Nice beard**, etc.

titles &lt;- stringr::str_replace_all(titles, "\\*\\*", "")  # remove asterisks
names &lt;- stringr::str_extract(titles, ": .+")
names &lt;- stringr::str_replace_all(names, ": ", "")  # remove the colon and space

rownames(beard_cont) &lt;- names

library(FactoMineR)

res_ca_beard &lt;- CA(beard_cont, graph = F)
plot.CA(res_ca_beard, invisible = "col")


### Example 2: children dataset ###

data(children)

children &lt;- children[1:14, 1:5] |&gt; t() |&gt; as.data.frame()
rownames(children) &lt;- c('No education', 'Elementary school',
'Middle school', 'High school', 'University')

intro_children &lt;- 'The data used here is a contingency table
that summarizes the answers
given by different categories of people to the following question:
"according to you, what are the reasons that can make
a woman of a couple hesitate to have children?".
Each row corresponds to a level of education, and columns are reasons.'
intro_children &lt;- gsub('\n', ' ', intro_children) |&gt;
stringr::str_squish()

req_children &lt;- "Please explain the main differences
between more educated and less educated couples,
when it comes to hesitating to have children."
req_children &lt;- gsub('\n', ' ', req_children) |&gt;
stringr::str_squish()

res_children &lt;- nail_descfreq(children,
                              introduction = intro_children,
                              request = req_children,
                              generate = TRUE)

cat(res_children$response)

## End(Not run)
</code></pre>

<hr>
<h2 id='nail_qda'>Interpret QDA data</h2><span id='topic+nail_qda'></span>

<h3>Description</h3>

<p>Generate an LLM response to analyze QDA data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nail_qda(
  dataset,
  formul,
  firstvar,
  lastvar = length(colnames(dataset)),
  introduction = NULL,
  request = NULL,
  conclusion = NULL,
  model = "llama3",
  isolate.groups = FALSE,
  drop.negative = FALSE,
  proba = 0.05,
  generate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nail_qda_+3A_dataset">dataset</code></td>
<td>
<p>a data frame made up of at least two categorical variables (product, panelist) and a set of quantitative variables (sensory attributes).</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_formul">formul</code></td>
<td>
<p>the analyis of variance model to be evaluated for each sensory attribute.</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_firstvar">firstvar</code></td>
<td>
<p>the index of the first sensory attribute.</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_lastvar">lastvar</code></td>
<td>
<p>the index of the last sensory attribute.</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_introduction">introduction</code></td>
<td>
<p>the introduction for the LLM prompt.</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_request">request</code></td>
<td>
<p>the request for the LLM prompt.</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_conclusion">conclusion</code></td>
<td>
<p>the conclusion for the LLM prompt.</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_model">model</code></td>
<td>
<p>the model name ('llama3' by default).</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_isolate.groups">isolate.groups</code></td>
<td>
<p>a boolean that indicates whether to give the LLM a single prompt, or one prompt per product.</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_drop.negative">drop.negative</code></td>
<td>
<p>a boolean that indicates whether to drop negative v.test values for interpretation (keeping only positive v.tests).</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_proba">proba</code></td>
<td>
<p>the significance threshold considered to characterize the products (by default 0.05).</p>
</td></tr>
<tr><td><code id="nail_qda_+3A_generate">generate</code></td>
<td>
<p>a boolean that indicates whether to generate the LLM response. If FALSE, the function only returns the prompt.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function directly sends a prompt to an LLM. Therefore, to get a consistent answer, we highly recommend to customize the parameters introduction and request and add all relevant information on your data for the LLM. We also recommend renaming the columns with clear, unshortened and unambiguous names.
</p>
<p>Additionally, if isolate.groups = TRUE, you will need an introduction and a request that take into account the fact that only one group is analyzed at a time.
</p>


<h3>Value</h3>

<p>A data frame, or a list of data frames, containing the LLM's prompt and response (if generate = TRUE).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

### Example 1: QDA data on chocolates with isolate.groups = FALSE ###
library(NaileR)
library(SensoMineR)
data(chocolates)

intro_sensochoc &lt;- "Six chocolates were measured according
to sensory attributes by a trained panel.
I will give you the results from this study.
You will have to identify what sets these chocolates apart."
intro_sensochoc &lt;- gsub('\n', ' ', intro_sensochoc) |&gt;
stringr::str_squish()

req_sensochoc &lt;- "Please explain what makes each chocolate different
and provide a sensory profile of each chocolate, as well as a name."
req_sensochoc &lt;- gsub('\n', ' ', req_sensochoc) |&gt;
stringr::str_squish()

res_nail_qda &lt;- nail_qda(sensochoc,
                         formul="~Product+Panelist",
                         firstvar = 5,
                         introduction = intro_sensochoc,
                         request = req_sensochoc,
                         model = 'llama3',
                         isolate.groups = FALSE,
                         drop.negative = FALSE,
                         proba = 0.05,
                         generate = TRUE)

cat(res_nail_qda$prompt)
cat(res_nail_qda$response)

### Example 2: QDA data on chocolates with isolate.groups = TRUE ###
library(NaileR)
library(SensoMineR)
data(chocolates)

intro_sensochoc &lt;- "A chocolate was measured according
to sensory attributes by a trained panel.
I will give you the results from this study.
You will have to identify the characteristics of this chocolate."
intro_sensochoc &lt;- gsub('\n', ' ', intro_sensochoc) |&gt;
stringr::str_squish()

req_sensochoc &lt;- "Please provide a detailed sensory profile for this chocolate,
as well as a name."
req_sensochoc &lt;- gsub('\n', ' ', req_sensochoc) |&gt;
stringr::str_squish()

res_nail_qda &lt;- nail_qda(sensochoc,
                         formul="~Product+Panelist",
                         firstvar = 5,
                         introduction = intro_sensochoc,
                         request = req_sensochoc,
                         model = 'llama3',
                         isolate.groups = TRUE,
                         drop.negative = FALSE,
                         proba = 0.05,
                         generate = TRUE)

cat(res_nail_qda[[1]]$prompt)
cat(res_nail_qda[[1]]$response)

## End(Not run)
</code></pre>

<hr>
<h2 id='nail_sort'>Sort textual data</h2><span id='topic+nail_sort'></span>

<h3>Description</h3>

<p>Group textual data according to their similarity, in a context in which the assessors have commented on a set of stimuli.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nail_sort(
  dataset,
  name_size = 3,
  stimulus_id = "stimulus",
  introduction = "",
  measure = "",
  nb_max = 6,
  generate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nail_sort_+3A_dataset">dataset</code></td>
<td>
<p>a data frame where each row is a stimulus and each column is an assessor.</p>
</td></tr>
<tr><td><code id="nail_sort_+3A_name_size">name_size</code></td>
<td>
<p>the maximum number of words in a group name created by the LLM.</p>
</td></tr>
<tr><td><code id="nail_sort_+3A_stimulus_id">stimulus_id</code></td>
<td>
<p>the nature of the stimulus. Customizing it is highly recommended.</p>
</td></tr>
<tr><td><code id="nail_sort_+3A_introduction">introduction</code></td>
<td>
<p>the introduction to the LLM prompt.</p>
</td></tr>
<tr><td><code id="nail_sort_+3A_measure">measure</code></td>
<td>
<p>the type of measure used in the experiment.</p>
</td></tr>
<tr><td><code id="nail_sort_+3A_nb_max">nb_max</code></td>
<td>
<p>the maximum number of clusters the LLM can form per assessor.</p>
</td></tr>
<tr><td><code id="nail_sort_+3A_generate">generate</code></td>
<td>
<p>a boolean that indicates whether to generate the LLM response. If FALSE, the function only returns the prompt.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses a while loop to ensure that the LLM gives the right number of groups. Therefore, customizing the stimulus ID, prompt introduction and measure is highly recommended; a clear prompt can help the LLM finish its task faster.
</p>


<h3>Value</h3>

<p>A list consisting of:
</p>

<ul>
<li><p> a list of prompts (one per assessor);
</p>
</li>
<li><p> a data frame with the group names.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(NaileR)
data(beard_wide)

intro_beard &lt;- "As a barber, you make
recommendations based on consumers comments.
Examples of consumers descriptions of beards
are as follows."
intro_beard &lt;- gsub('\n', ' ', intro_beard) |&gt;
stringr::str_squish()

res &lt;- nail_sort(beard_wide[,1:5], name_size = 3,
stimulus_id = "beard", introduction = intro_beard,
measure = 'the description was', generate = TRUE)

res$dta_sort
cat(res$prompt_llm[[1]])

## End(Not run)
</code></pre>

<hr>
<h2 id='nail_textual'>Interpret a group based on answers to open-ended questions</h2><span id='topic+nail_textual'></span>

<h3>Description</h3>

<p>Generate an LLM response to analyze a categorical latent variable, based on answers to open-ended questions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nail_textual(
  dataset,
  num.var,
  num.text,
  introduction = NULL,
  request = NULL,
  model = "llama3",
  isolate.groups = TRUE,
  generate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nail_textual_+3A_dataset">dataset</code></td>
<td>
<p>a data frame made up of at least one categorical variable and a textual variable.</p>
</td></tr>
<tr><td><code id="nail_textual_+3A_num.var">num.var</code></td>
<td>
<p>the index of the categorical variable to be characterized.</p>
</td></tr>
<tr><td><code id="nail_textual_+3A_num.text">num.text</code></td>
<td>
<p>the index of the textual variable that characterizes the categorical variable of interest.</p>
</td></tr>
<tr><td><code id="nail_textual_+3A_introduction">introduction</code></td>
<td>
<p>the introduction for the LLM prompt.</p>
</td></tr>
<tr><td><code id="nail_textual_+3A_request">request</code></td>
<td>
<p>the request made to the LLM.</p>
</td></tr>
<tr><td><code id="nail_textual_+3A_model">model</code></td>
<td>
<p>the model name ('llama3' by default).</p>
</td></tr>
<tr><td><code id="nail_textual_+3A_isolate.groups">isolate.groups</code></td>
<td>
<p>a boolean that indicates whether to give the LLM a single prompt, or one prompt per category. Recommended with long catdes results.</p>
</td></tr>
<tr><td><code id="nail_textual_+3A_generate">generate</code></td>
<td>
<p>a boolean that indicates whether to generate the LLM response. If FALSE, the function only returns the prompt.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function directly sends a prompt to an LLM. Therefore, to get a consistent answer, we highly recommend to customize the parameters introduction and request and add all relevant information on your data for the LLM. We also recommend renaming the columns with clear, unshortened and unambiguous names.
</p>
<p>Additionally, if isolate.groups = TRUE, you will need an introduction and a request that take into account the fact that only one group is analyzed at a time.
</p>


<h3>Value</h3>

<p>A data frame, or a list of data frames, containing the LLM's prompt and response (if generate = TRUE).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

### Example 1: Car alone survey ###
library(NaileR)
library(dplyr)
data(car_alone)

sampled_car_alone &lt;- car_alone %&gt;%
group_by(car_alone_capable_restrictive) %&gt;%
dplyr::sample_frac(0.5)
sampled_car_alone &lt;- as.data.frame(sampled_car_alone)

intro_car &lt;- "Knowing the impact on the climate,
I have made these choices based on
the following benefits and constraints..."
intro_car &lt;- gsub('\n', ' ', intro_car) |&gt;
stringr::str_squish()

res_nail_textual &lt;- nail_textual(sampled_car_alone, num.var = 1,
                                 num.text = 2,
                                 introduction = intro_car,
                                 request = NULL,
                                 model = 'llama3', isolate.groups = TRUE,
                                 generate = TRUE)

res_nail_textual[[1]]$response |&gt; cat()
res_nail_textual[[3]]$response |&gt; cat()
res_nail_textual[[2]]$response |&gt; cat()
res_nail_textual[[4]]$response |&gt; cat()

### Example 2: Atomic habits survey ###
library(NaileR)
library(dplyr)
data(atomic_habit_clust)

intro_atomic &lt;- "These data were collected
after a survey on atomic habits: we asked
what people were prepared to change about their daily habits
to make the world a better place,
what habits they felt able to adopt,
what habits were restrictive."
intro_atomic &lt;- gsub('\n', ' ', intro_atomic) |&gt;
stringr::str_squish()

dta_plane &lt;- atomic_habit_clust[,c(32,51)] %&gt;%
            filter(never_plane_text != 'THAT')

sampled_dta_plane &lt;- dta_plane %&gt;%
                    group_by(clust) %&gt;%
                    dplyr::sample_frac(0.75)

sampled_dta_plane &lt;- as.data.frame(sampled_dta_plane)
summary(sampled_dta_plane)

res_nail_textual_plane &lt;- nail_textual(sampled_dta_plane, num.var = 2,
                                       num.text = 1,
                                       introduction = intro_atomic,
                                       request = NULL,
                                       model = 'llama3',
                                       isolate.groups = TRUE,
                                       generate = TRUE)

cat(res_nail_textual_plane[[1]]$prompt)
cat(res_nail_textual_plane[[1]]$response)

cat(res_nail_textual_plane[[2]]$prompt)
cat(res_nail_textual_plane[[2]]$response)

cat(res_nail_textual_plane[[3]]$prompt)
cat(res_nail_textual_plane[[3]]$response)

res_nail_textual_plane &lt;- nail_textual(sampled_dta_plane, num.var = 2,
                                       num.text = 1,
                                       introduction = intro_atomic,
                                       request = NULL,
                                       model = 'llama3',
                                       isolate.groups = FALSE,
                                       generate = TRUE)

cat(res_nail_textual_plane$prompt)
cat(res_nail_textual_plane$response)

### Example 3: Car seat fabrics ###

# Drivers of liking and disliking
# isolate.groups = F

intro_car &lt;- "In this consumer study, a number of car seat fabrics
were rated by consumers who gave their reasons
for liking or disliking the fabrics.
Reasons for disliking the fabrics were reported in group '0',
while reasons for liking the fabrics were reported in group '1'."
intro_car &lt;- gsub('\n', ' ', intro_car) |&gt;
stringr::str_squish()

request_car &lt;- "Based on the comments provided by the consumers,
please explain the reasons why
the fabrics were not appreciated (group '0'),
and the reasons why fabrics were appreciated (group '1').
In other words, what are the drivers for disliking
and liking the fabrics."
request_car &lt;- gsub('\n', ' ', request_car) |&gt;
stringr::str_squish()

res_nail_textual_fabric &lt;- nail_textual(fabric, num.var = 4,
                                        num.text = 3,
                                        introduction = intro_car,
                                        request = request_car,
                                        model = 'llama3',
                                        isolate.groups = FALSE,
                                        generate = TRUE)

cat(res_nail_textual_fabric$response)

# Drivers of disliking with a specific prompt
# isolate.groups = T

intro_car_disliking &lt;- "In this consumer study, a range of car seat fabrics
were rated by consumers who gave their reasons
for disliking the fabrics.
In these data, only the reasons for disliking the fabrics were reported."
intro_car_disliking &lt;- gsub('\n', ' ', intro_car_disliking) |&gt;
stringr::str_squish()

request_car_disliking &lt;- "Based on the comments provided by the consumers,
please explain the reasons why
the fabrics were not appreciated.
In other words, what are the drivers for disliking the fabrics."
request_car_disliking &lt;- gsub('\n', ' ', request_car_disliking) |&gt;
stringr::str_squish()

res_nail_textual_fabric &lt;- nail_textual(fabric, num.var = 4,
                                        num.text = 3,
                                        introduction = intro_car_disliking,
                                        request = request_car_disliking,
                                        model = 'llama3',
                                        isolate.groups = TRUE,
                                        generate = FALSE)

ppt &lt;- res_nail_textual_fabric[1]
cat(ppt)

res_disliking &lt;- ollamar::generate(model = 'llama3', prompt = ppt,
                                   output = "df")
cat(res_disliking$response)

# Drivers of liking with a specific prompt
# isolate.groups = T

intro_car_liking &lt;- "In this consumer study, a range of car seat fabrics
were rated by consumers who gave their reasons
for liking the fabrics.
In these data, only the reasons for liking the fabrics were reported."
intro_car_liking &lt;- gsub('\n', ' ', intro_car_liking) |&gt;
stringr::str_squish()

request_car_liking &lt;- "Based on the comments provided by the consumers,
please explain the reasons why
the fabrics were appreciated.
In other words, what are the drivers for liking the fabrics."
request_car_liking &lt;- gsub('\n', ' ', request_car_liking) |&gt;
stringr::str_squish()

res_nail_textual_fabric &lt;- nail_textual(fabric, num.var = 4,
                                        num.text = 3,
                                        introduction = intro_car_liking,
                                        request = request_car_liking,
                                        model = 'llama3',
                                        isolate.groups = TRUE,
                                        generate = FALSE)

ppt &lt;- res_nail_textual_fabric[2]
cat(ppt)

res_liking &lt;- ollamar::generate(model = 'llama3', prompt = ppt,
                                output = "df")
cat(res_liking$response)

### Example 4: Rorschach inkblots ###

# Description of each inkblot
# isolate.groups = TRUE

intro_rorschach &lt;- "For this study,
we asked sixty people to briefly describe
one of the inkblots of the Rorschach test."
intro_rorschach &lt;- gsub('\n', ' ', intro_rorschach) |&gt;
stringr::str_squish()

request_rorschach &lt;- "Based on the comments of the 60 people,
please give me a description of that inkblot
in terms of how it was perceived. Tell me if it was
a rather positive or negative perception."
request_rorschach &lt;- gsub('\n', ' ', request_rorschach) |&gt;
stringr::str_squish()

res_nail_textual_rorschach &lt;- nail_textual(rorschach, num.var = 2,
                                           num.text = 5,
                                           introduction = intro_rorschach,
                                           request = request_rorschach,
                                           model = 'llama3',
                                           isolate.groups = TRUE,
                                           generate = FALSE)

cat(res_nail_textual_rorschach[[10]])

ppt &lt;- gsub("## Group", "## Stimulus", res_nail_textual_rorschach[[10]])
cat(ppt)

res_inkblot_10 &lt;- ollamar::generate(model = 'llama3', prompt = ppt, output = "df")
cat(res_inkblot_10$response)

cat(res_nail_textual_rorschach[[5]])

ppt &lt;- gsub("## Group", "## Stimulus", res_nail_textual_rorschach[[5]])
cat(ppt)

res_inkblot_5 &lt;- ollamar::generate(model = 'llama3', prompt = ppt,
                                   output = "df")
cat(res_inkblot_5$response)


#Comparison of panels

rorschach_10 &lt;- droplevels(rorschach[rorschach$Inkblot=="10",])

intro_rorschach &lt;- "For this study,
we asked sixty people to briefly describe
one of the inkblots of the Rorschach test.
The sixty people belonged to three different panels,
with 20 people per panel."
intro_rorschach &lt;- gsub('\n', ' ', intro_rorschach) |&gt;
stringr::str_squish()

request_rorschach &lt;- "Based on the comments of the 60 people,
please tell me what is common from panel to panel
and what is specific to each panel
in terms of the perception of the inkblot."
request_rorschach &lt;- gsub('\n', ' ', request_rorschach) |&gt;
stringr::str_squish()

res_nail_textual_rorschach &lt;- nail_textual(rorschach_10, num.var = 1,
                                           num.text = 5,
                                           introduction = intro_rorschach,
                                           request = request_rorschach,
                                           model = 'llama3',
                                           isolate.groups = FALSE,
                                           generate = TRUE)

cat(res_nail_textual_rorschach$prompt)
cat(res_nail_textual_rorschach$response)

## End(Not run)
</code></pre>

<hr>
<h2 id='nutriscore'>Nutri-score survey</h2><span id='topic+nutriscore'></span>

<h3>Description</h3>

<p>These data were collected after a survey on the nutri-score. Participants were asked various questions about their views on the nutri-score, and about their eating habits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nutriscore
</code></pre>


<h3>Format</h3>

<p>A data frame with 112 rows (participants) and 36 columns (questions).
</p>


<h3>Source</h3>

<p>Anaëlle YANNIC and Jessie PICOT, students at l'Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(NaileR)
library(FactoMineR)

data(nutriscore)

res_mca_nutriscore &lt;- MCA(nutriscore, quali.sup = 17:36,
ncp = 15, level.ventil = 0.05, graph = FALSE)

res_hcpc_nutriscore &lt;- HCPC(res_mca_nutriscore, nb.clust = 3,
graph = FALSE)
don_clust_nutriscore &lt;- res_hcpc_nutriscore$data.clust

intro_nutri &lt;- 'These data were collected after a survey
on the nutri-score. Participants were asked
various questions about their views on the nutri-score,
and about their eating habits.
Participants were split into groups according to their answers.'
intro_nutri &lt;- gsub('\n', ' ', intro_nutri) |&gt;
stringr::str_squish()

req_nutri &lt;- 'Please summarize the characteristics
of each group. Then, give each group a new name,
based on your conclusions.'
req_nutri &lt;- gsub('\n', ' ', req_nutri)|&gt;
stringr::str_squish()

res_nutriscore &lt;- nail_catdes(don_clust_nutriscore, num.var = 37,
introduction = intro_nutri, request = req_nutri,
drop.negative = TRUE)
res_nutriscore |&gt; cat()

## End(Not run)
</code></pre>

<hr>
<h2 id='quality'>Perception of food quality</h2><span id='topic+quality'></span>

<h3>Description</h3>

<p>These data were collected after a study on the perception of food quality.
Participants were given 9 French logos; they had to rate, on a scale from 0 (not at all) to 10 (absolutely), how much a product bearing them aligned with their own perception of quality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quality
</code></pre>


<h3>Format</h3>

<p>A data frame with 55 rows and 9 columns. Here is the list of logos:
</p>

<ul>
<li><p> AB: organic;
</p>
</li>
<li><p> Label Rouge: superior quality (from the taste, process, packaging...);
</p>
</li>
<li><p> FairTrade: decent wages and working conditions for the producers;
</p>
</li>
<li><p> Bleu Blanc Coeur: diverse and balanced diet for the livestock;
</p>
</li>
<li><p> AOC: controlled designation of origin;
</p>
</li>
<li><p> Produit en Bretagne: processed in Brittany;
</p>
</li>
<li><p> Viandes de France: livestock bred, grown and slaughtered in France, with respectful living conditions;
</p>
</li>
<li><p> Nourri sans OGM: no GMOs in livestock food;
</p>
</li>
<li><p> Médailles Agro: a prize won at a yearly contest based on taste.
</p>
</li></ul>



<h3>Source</h3>

<p>Sébastien Lê, applied mathematics department, Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(NaileR)
data(quality)

colnames(quality) &lt;- c("Agriculture biologique",
"Label Rouge",
"FairTrade",
"Bleu Blanc Coeur",
"Appelation d'origine contrôlée",
"Produit en Bretagne",
"Viandes de France",
"Nourri sans OGM",
"Médailles Agro")

res_pca_quality &lt;- FactoMineR::PCA(quality, graph = FALSE)
quali_work &lt;- res_pca_quality$ind$coord |&gt; as.data.frame()
quali_work &lt;- quali_work[,1] |&gt; cbind(quality)

intro_quali &lt;- "These data were collected after a study
on the perception of food quality.
Participants were given 9 French logos;
they had to rate, on a scale from 0 (not at all)
to 10 (absolutely), how much a product bearing them
aligned with their own perception of quality."
intro_quali &lt;- gsub('\n', ' ', intro_quali) |&gt;
stringr::str_squish()

res_quality &lt;- nail_condes(quali_work, num.var = 1,
quanti.cat = c('Higher quality', 'Lower quality', 'Neutral'),
introduction = intro_quali, generate = FALSE)

ppt &lt;- gsub('characteristics', 'opinions', res_quality)

res_quality &lt;- ollamar::generate('llama3', ppt, output = 'df')
res_quality$response |&gt; cat()

## End(Not run)
</code></pre>

<hr>
<h2 id='rorschach'>Rorschach inkblots</h2><span id='topic+rorschach'></span>

<h3>Description</h3>

<p>This dataset was initially collected to understand the perception of the Rorschach test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rorschach
</code></pre>


<h3>Format</h3>

<p>A data frame with 600 rows and 5 columns:
</p>

<ul>
<li><p> The Panel effect (3 panels)
</p>
</li>
<li><p> The Inkblot effect (10 inkblots)
</p>
</li>
<li><p> The Panelist effect (20 panelists par panel)
</p>
</li>
<li><p> The interaction Panel and Panelist
</p>
</li>
<li><p> The perception of the inkblot
</p>
</li></ul>



<h3>Source</h3>

<p>Applied mathematics department, Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(NaileR)
data(rorschach)

### Example 1: perception of the inkblots for one panel ###
intro_rorschach &lt;- "For this study,
we asked 20 people to briefly describe
the 10 inkblots of the Rorschach test."
intro_rorschach &lt;- gsub('\n', ' ', intro_rorschach) |&gt;
stringr::str_squish()

request_rorschach &lt;- "Based on the comments of the 20 people,
please give me a description of each inkblot
in terms of how it was perceived. Tell me if it was
a rather positive or negative perception."
request_rorschach &lt;- gsub('\n', ' ', request_rorschach) |&gt;
stringr::str_squish()

rorschach_A &lt;- droplevels(rorschach[rorschach$Panel=="A",])

res_nail_textual_rorschach &lt;- nail_textual(rorschach_A, num.var = 2,
                                           num.text = 5,
                                           introduction = intro_rorschach,
                                           request = request_rorschach,
                                           model = 'llama3',
                                           isolate.groups = FALSE,
                                           generate = FALSE)
res_nail_textual_rorschach |&gt; cat()

ppt &lt;- gsub("## Group", "## Inkblot", res_nail_textual_rorschach)
ppt |&gt; cat()

res_inkblot &lt;- ollamar::generate(model = 'llama3', prompt = ppt,
                                 output = "text")
res_inkblot |&gt; cat()

## End(Not run)
</code></pre>

<hr>
<h2 id='sim_llm'>LLM text similarity</h2><span id='topic+sim_llm'></span>

<h3>Description</h3>

<p>Compute a similarity score, on a scale ranging from 0 (totally different) to 100 (the exact same), between two character strings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_llm(textA, textB)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_llm_+3A_texta">textA</code>, <code id="sim_llm_+3A_textb">textB</code></td>
<td>
<p>two character strings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The similarity score is generated by an LLM. Therefore, the result might vary if the function is run several times.
</p>


<h3>Value</h3>

<p>An integer between 0 and 100.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

textA &lt;- "Participant A was described as a nice, outgoing man, with a friendly attitude."
textB &lt;- "Participant A was an extroverted and caring individual."

sim_llm(textA, textB)

## End(Not run)
</code></pre>

<hr>
<h2 id='waste'>Food waste survey</h2><span id='topic+waste'></span>

<h3>Description</h3>

<p>These data were collected after a survey on food waste, with participants describing their habits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>waste
</code></pre>


<h3>Format</h3>

<p>A data frame with 180 rows (participants) and 77 columns (questions).
</p>


<h3>Source</h3>

<p>Héloïse BILLES and Amélie RATEAU, students at l'Institut Agro Rennes-Angers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Processing time is often longer than ten seconds
# because the function uses a large language model.

library(NaileR)
library(FactoMineR)
data(waste)
waste &lt;- waste[-14]

res_mca_waste &lt;- MCA(waste, quali.sup = c(1,2,50:76),
ncp = 35, level.ventil = 0.05, graph = FALSE)
res_hcpc_waste &lt;- HCPC(res_mca_waste, nb.clust = 3, graph = FALSE)
don_clust_waste &lt;- res_hcpc_waste$data.clust

intro_waste &lt;- 'These data were collected
after a survey on food waste,
with participants describing their habits.'
intro_waste &lt;- gsub('\n', ' ', intro_waste) |&gt;
stringr::str_squish()

req_waste &lt;- 'Please summarize the characteristics of each group.
Then, give each group a new name, based on your conclusions.
Finally, give each group a grade between 0 and 10,
based on how wasteful they are with food:
0 being "not at all", 10 being "absolutely".'
req_waste &lt;- gsub('\n', ' ', req_waste) |&gt;
stringr::str_squish()

res_waste &lt;- nail_catdes(don_clust_waste,
num.var = ncol(don_clust_waste),
introduction = intro_waste, request = req_waste,
drop.negative = TRUE)
res_waste |&gt; cat()

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
