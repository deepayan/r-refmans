<!DOCTYPE html><html><head><title>Help for package npROCRegression</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {npROCRegression}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#npROCRegression-package'>
<p>Kernel-Based Nonparametric ROC Regression Modelling</p></a></li>
<li><a href='#controlDNPROCreg'>
<p>Function used to set several parameters controlling the ROC regression fitting process</p></a></li>
<li><a href='#controlINPROCreg'>
<p>Function used to set several parameters controlling fitting process.</p></a></li>
<li><a href='#DNPROCreg'>
<p>Direct nonparametric ROC regression modelling</p></a></li>
<li><a href='#DNPROCregData'>
<p>Selects an adequate set of points from a data set for obtaining predictions or plots.</p></a></li>
<li><a href='#endosim'>
<p>Simulated endocrine data.</p></a></li>
<li><a href='#INPROCreg'>
<p>Induced nonparametric ROC regression modelling</p></a></li>
<li><a href='#plot.DNPROCreg'>
<p>Default DNPROCreg plotting</p></a></li>
<li><a href='#plot.INPROCreg'>
<p>Default INPROCreg plotting</p></a></li>
<li><a href='#print.DNPROCreg'>
<p>Print method for DNPROCreg objects</p></a></li>
<li><a href='#print.INPROCreg'>
<p>Print method for INPROCreg objects</p></a></li>
<li><a href='#summary.DNPROCreg'>
<p>Summary method for DNPROCreg objects.</p></a></li>
<li><a href='#summary.INPROCreg'>
<p>Summary method for INPROCreg objects.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Kernel-Based Nonparametric ROC Regression Modelling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-7</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-31</td>
</tr>
<tr>
<td>Imports:</td>
<td>lattice, graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements several nonparametric regression approaches for the inclusion of covariate information on the receiver operating characteristic (ROC) framework.</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-31 09:45:49 UTC; mrodriguez</td>
</tr>
<tr>
<td>Author:</td>
<td>Maria Xose Rodriguez-Alvarez [aut, cre],
  Javier Roca-Pardinas [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maria Xose Rodriguez-Alvarez &lt;mxrodriguez@uvigo.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-31 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='npROCRegression-package'>
Kernel-Based Nonparametric ROC Regression Modelling
</h2><span id='topic+npROCRegression-package'></span><span id='topic+npROCRegression'></span>

<h3>Description</h3>

<p>The npROCRegression package allows the user to apply in practice the nonparametric induced and direct ROC regression approaches presented in Rodriguez-Alvarez et al. (2011a) and Rodriguez-Alvarez et al. (2011b, 2016) respectively.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> npROCRegression</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0-7</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-08-31</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Maria Xose Rodriguez - Alvarez and Javier Roca-Pardinas
</p>
<p>Maintainer: Maria Xose Rodriguez - Alvarez &lt;mxrodriguez@uvigo.es&gt;
</p>


<h3>References</h3>

<p>Rodriguez-Alvarez, M.X., Roca-Pardinas, J. and Cadarso-Suarez, C. (2011a). ROC curve and covariates: extending induced methodology to the non-parametric framework. Statistics and Computing, 21(4), 483&ndash;499.
</p>
<p>Rodriguez-Alvarez, M.X., Roca-Pardinas, J. and Cadarso-Suarez, C. (2011b). A new flexible direct ROC regression model - Application to the detection of cardiovascular risk factors by anthropometric measures. Computational Statistics and Data Analysis, 55(12), 3257&ndash;3270.
</p>
<p>Rodriguez-Alvarez, M.X., Roca-Pardinas, J. and Cadarso-Suarez, C. (2016). Bootstrap-based procedures for inference in nonparametric ROC regression analysis. Technical report.
</p>

<hr>
<h2 id='controlDNPROCreg'>
Function used to set several parameters controlling the ROC regression fitting process
</h2><span id='topic+controlDNPROCreg'></span>

<h3>Description</h3>

<p>Function used to set several parameters controlling the ROC regression fitting process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlDNPROCreg(step.p = 0.02, card.P = 50, link = c("probit", "logit","cloglog"), 
kbin = 30, p = 1, seed = NULL, nboot = 500, level = 0.95, 
resample.m = c("coutcome", "ncoutcome"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlDNPROCreg_+3A_step.p">step.p</code></td>
<td>
<p>a numeric value, defaulting to 0.02. ROC curves are calculated at a regular sequence of false positive fractions with <code>step.p</code> increment.
</p>
</td></tr>
<tr><td><code id="controlDNPROCreg_+3A_card.p">card.P</code></td>
<td>
<p>an integer value specifying the cardinality of the set of false positive fractions used in the estimation processs. By default 50.
</p>
</td></tr>
<tr><td><code id="controlDNPROCreg_+3A_link">link</code></td>
<td>
<p>a character string specifying the link function (&ldquo;probit&rdquo;, &ldquo;logit&rdquo; or &ldquo;cloglog&rdquo;). By default the link is the probit function.
</p>
</td></tr>
<tr><td><code id="controlDNPROCreg_+3A_kbin">kbin</code></td>
<td>
<p>an integer value specifying the number of binning knots. By default 30.
</p>
</td></tr>
<tr><td><code id="controlDNPROCreg_+3A_p">p</code></td>
<td>
<p>an integer value specifying the order of the local polinomial kernel estimator. By default 1.
</p>
</td></tr>
<tr><td><code id="controlDNPROCreg_+3A_seed">seed</code></td>
<td>
<p>an integer value specifying the seed for the bootstrap resamples. If NULL it is initialized randomly.
</p>
</td></tr>
<tr><td><code id="controlDNPROCreg_+3A_nboot">nboot</code></td>
<td>
<p>an integer value specifying the number of bootstrap resamples for the construction of the confidence intervals. By default 500.   
</p>
</td></tr>
<tr><td><code id="controlDNPROCreg_+3A_level">level</code></td>
<td>
<p>a real value specifying the confidence level for the confidence intervals. By default 0.95  
</p>
</td></tr>
<tr><td><code id="controlDNPROCreg_+3A_resample.m">resample.m</code></td>
<td>
<p>a character string specifying if bootstrap resampling (for the confidence intervals) should be done with or without regard to the disease status (&ldquo;coutcome&rdquo; or &ldquo;noutcome&rdquo;). In both cases, a naive bootstrap is used. By default, the resampling is done conditionally on the disease status.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Xose Rodriguez - Alvarez and Javier Roca-Pardinas
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+DNPROCreg">DNPROCreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Fit a model including the interaction between age and gender.
m0 &lt;- DNPROCreg(marker = "bmi", formula.h = "~ gender + s(age) + s(age, by = gender)", 
				formula.ROC = "~ gender + s(age) + s(age, by = gender)", 
				group = "idf_status", 
				tag.healthy = 0, 
				data = endosim, 
				control = controlDNPROCreg(card.P=50, kbin=30, step.p=0.02))
summary(m0)				
plot(m0)
</code></pre>

<hr>
<h2 id='controlINPROCreg'>
Function used to set several parameters controlling fitting process.
</h2><span id='topic+controlINPROCreg'></span>

<h3>Description</h3>

<p>Function used to set several parameters controlling fitting process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlINPROCreg(step.p = 0.02, kbin = 30, p = 1, h = c(-1, -1, -1, -1), 
seed = NULL, nboot = 500, level = 0.95, resample.m = c("coutcome", "ncoutcome"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlINPROCreg_+3A_step.p">step.p</code></td>
<td>
<p>a numeric value, defaulting to 0.02. ROC curves are calculated at a regular sequence of false positive fractions with <code>step.p</code> increment.</p>
</td></tr>
<tr><td><code id="controlINPROCreg_+3A_kbin">kbin</code></td>
<td>
<p>an integer value specifying the number of binning knots. By default 30.</p>
</td></tr>
<tr><td><code id="controlINPROCreg_+3A_p">p</code></td>
<td>
<p>an integer value specifying the order of the local polynomial kernel estimator for the regression functions. By default 1.</p>
</td></tr>
<tr><td><code id="controlINPROCreg_+3A_h">h</code></td>
<td>
<p>a vector of length 4 specifying the bandwidths to be used for the estimation of the regression and variance functions in healthy population and the regression and variance functions in diseased populations (in this order). By default -1 (selected using cross-validation). A value of 0 would indicate a linear fit.</p>
</td></tr>
<tr><td><code id="controlINPROCreg_+3A_seed">seed</code></td>
<td>
<p>an integer value specifying the seed for the bootstrap resamples. If NULL it is initialized randomly.</p>
</td></tr>
<tr><td><code id="controlINPROCreg_+3A_nboot">nboot</code></td>
<td>
<p>an integer value specifying the number of bootstrap resamples for the construction of the confidence intervals. By default 500.</p>
</td></tr>
<tr><td><code id="controlINPROCreg_+3A_level">level</code></td>
<td>
<p>a real value specifying the confidence level for the confidence intervals. By default 0.95.</p>
</td></tr>
<tr><td><code id="controlINPROCreg_+3A_resample.m">resample.m</code></td>
<td>
<p>a character string specifying if bootstrap resampling (for the confidence intervals) should be done with or without regard to the disease status (&ldquo;coutcome&rdquo; or &ldquo;noutcome&rdquo;). When the resampling method is done conditionally on the disease status, the resampling is based on the residuals of the regression models in healthy and diseased populations. However, when the bootstrap resampling is done without regard to the disease status, a naive bootstrap is used. By default, the resampling is done conditionally on the disease status.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Xose Rodriguez - Alvarez and Javier Roca-Pardinas
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+INPROCreg">INPROCreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Evaluate the effect of age on the accuracy of the body mass index for males
m0.men &lt;- INPROCreg(marker = "bmi", covariate = "age", group = "idf_status", 
						tag.healthy = 0, 
						data = subset(endosim, gender == "Men"), 
						ci.fit = FALSE, test = FALSE, 
						accuracy = c("EQ","TH"),
						accuracy.cal="AROC", 
						control=controlINPROCreg(p=1,kbin=30,step.p=0.01), 
						newdata = data.frame(age = seq(18,85,l=50)))	

summary(m0.men)
plot(m0.men)
</code></pre>

<hr>
<h2 id='DNPROCreg'>
Direct nonparametric ROC regression modelling
</h2><span id='topic+DNPROCreg'></span>

<h3>Description</h3>

<p>Estimates the covariate-specific ROC curve in the presence of multidimensional covariates by means of the ROC-GAM regression model presented in Rodriguez- Alvarez et al. (2011)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DNPROCreg(marker, formula.h = ~1, formula.ROC = ~1, group, tag.healthy, data, 
ci.fit = FALSE, test.partial = NULL, newdata = NULL, 
control = controlDNPROCreg(), weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DNPROCreg_+3A_marker">marker</code></td>
<td>
<p>A character string with the name of the diagnostic test variable.
</p>
</td></tr>
<tr><td><code id="DNPROCreg_+3A_formula.h">formula.h</code></td>
<td>
<p>Right-hand formula(s) giving the mean and variance model(s) to be fitted in healthy population. Atomic values are also valid, being recycled.
</p>
</td></tr>
<tr><td><code id="DNPROCreg_+3A_formula.roc">formula.ROC</code></td>
<td>
<p>Right-hand formula giving the ROC regression model to be fitted (ROC-GAM model).
</p>
</td></tr>
<tr><td><code id="DNPROCreg_+3A_group">group</code></td>
<td>
<p>A character string with the name of the variable that distinguishes healthy from diseased individuals.
</p>
</td></tr>
<tr><td><code id="DNPROCreg_+3A_tag.healthy">tag.healthy</code></td>
<td>
<p>The value codifying the healthy individuals in the variable <code>group</code>.
</p>
</td></tr>
<tr><td><code id="DNPROCreg_+3A_data">data</code></td>
<td>
<p>Data frame representing the data and containing all needed variables.
</p>
</td></tr>
<tr><td><code id="DNPROCreg_+3A_ci.fit">ci.fit</code></td>
<td>
<p>A logical value. If TRUE, confidence intervals are computed.
</p>
</td></tr>
<tr><td><code id="DNPROCreg_+3A_test.partial">test.partial</code></td>
<td>
<p>A numeric vector containing the position of the covariate components in the ROC-GAM formula to be tested for a possible effect. If NULL, no test is performed.. If NULL, no test is performed.
</p>
</td></tr>
<tr><td><code id="DNPROCreg_+3A_newdata">newdata</code></td>
<td>
<p>A data frame containing the values of the covariate at which predictions are required.
</p>
</td></tr>
<tr><td><code id="DNPROCreg_+3A_control">control</code></td>
<td>
<p>Output of the <code>controlDNROCreg()</code> function.
</p>
</td></tr>
<tr><td><code id="DNPROCreg_+3A_weights">weights</code></td>
<td>
<p>An optional vector of &lsquo;prior weights&rsquo; to be used in the fitting process.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>As a result, the function <code>DNPROCreg()</code> provides a list with the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>Data frame containing all variables and observations used in the fitting process.</p>
</td></tr>
<tr><td><code>fpf</code></td>
<td>
<p>Set of false positive fractions (FPF) at which the covariate-specific ROC curve has been estimated.</p>
</td></tr>
<tr><td><code>newdata</code></td>
<td>
<p>Data frame containing the values of the covariates at which estimates has been obtained.</p>
</td></tr>
<tr><td><code>pfunctions</code></td>
<td>
<p>Matrices containing the estimates of each component of the additive predictor of the ROC-GAM. One matrix contains the effects of the covariates, the other the effect of the FPF. Confidence intervals are returned if required).</p>
</td></tr>	
<tr><td><code>coefficients</code></td>
<td>
<p>Vector of parametric coefficient of the fitted ROC-GAM.</p>
</td></tr>
<tr><td><code>ROC</code></td>
<td>
<p>Estimated covariate-specific ROC curve.</p>
</td></tr>
<tr><td><code>AUC</code></td>
<td>
<p>Estimated covariate-specific AUC, and corresponding confidence intervals if required.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>If required, p-values are obtained  - with two different bootstrap-based tests - for each model component indicated in argument <code>test.partial</code> (T2: <code class="reqn">L_{2}</code>-based test; and T1: <code class="reqn">L_{1}</code>-based test). See Rodriguez-Alvarez et al. (2016).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Xose Rodriguez-Alvarez and Javier Roca-Pardinas
</p>


<h3>References</h3>

<p>Rodriguez- Alvarez, M.X., Roca-Pardinas, J. and Cadarso-Suarez, C. (2011). A new flexible direct ROC regression model - Application to the detection of cardiovascular risk factors by anthropometric measures. Computational Statistics and Data Analysis, 55(12), 3257&ndash;3270.
</p>
<p>Rodriguez- Alvarez, M.X., Roca-Pardinas, J. and Cadarso-Suarez, C. (2016). Bootstrap-based procedures for inference in nonparametric ROC regression analysis. Technical report.
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+INPROCreg">INPROCreg</a></code>, <code><a href="#topic+summary.DNPROCreg">summary.DNPROCreg</a></code>, <code><a href="#topic+plot.DNPROCreg">plot.DNPROCreg</a></code>, <code><a href="#topic+controlDNPROCreg">controlDNPROCreg</a></code>, <code><a href="#topic+DNPROCregData">DNPROCregData</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Fit a model including the interaction between age and gender.
m0 &lt;- DNPROCreg(marker = "bmi", formula.h = "~ gender + s(age) + s(age, by = gender)", 
				formula.ROC = "~ gender + s(age) + s(age, by = gender)", 
				group = "idf_status", 
				tag.healthy = 0, 
				data = endosim, 
				control = list(card.P=50, kbin=30, step.p=0.02))
summary(m0)				
plot(m0)

## Not run: 
# For confidence intervals
set.seed(123)
m1 &lt;- DNPROCreg(marker = "bmi", formula.h = "~ gender + s(age) + s(age, by = gender)", 
				formula.ROC = "~ gender + s(age) + s(age, by = gender)", 
				group = "idf_status", 
				tag.healthy = 0, 
				data = endosim, 
				control = list(card.P=50, kbin=30, step.p=0.02),
				ci.fit = TRUE)
summary(m1)
plot(m1)

# For testing the presence of interaccion between age and gender
set.seed(123)
m2 &lt;- DNPROCreg(marker = "bmi", formula.h = "~ gender + s(age) + s(age, by = gender)", 
				formula.ROC = "~ gender + s(age) + s(age, by = gender)", 
				group = "idf_status", 
				tag.healthy = 0, 
				data = endosim, 
				control = list(card.P=50, kbin=30, step.p=0.02),
				test.partial = 3)
summary(m2)
plot(m2)			

## End(Not run)
</code></pre>

<hr>
<h2 id='DNPROCregData'>
Selects an adequate set of points from a data set for obtaining predictions or plots.
</h2><span id='topic+DNPROCregData'></span>

<h3>Description</h3>

<p>Selects an adequate set of points from a data set to be used as a default dataset for obtaining predictions or plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DNPROCregData(data, names.cov, group)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DNPROCregData_+3A_data">data</code></td>
<td>
<p>Data set from which the new set of covariate values is obtained.
</p>
</td></tr>
<tr><td><code id="DNPROCregData_+3A_names.cov">names.cov</code></td>
<td>
<p>Character vector with the names of the covariates to be included in the new data set.
</p>
</td></tr>
<tr><td><code id="DNPROCregData_+3A_group">group</code></td>
<td>
<p>A character string with the name of the variable in the original data set that distinguishes healthy from diseased individuals.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame containing selected values of all needed covariates. For those that are continuous, 30 different values are selected.</p>


<h3>Author(s)</h3>

<p>Maria Xose Rodriguez - Alvarez and Javier Roca-Pardinas
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+DNPROCreg">DNPROCreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Fit a model including the interaction between age and gender.
m0 &lt;- DNPROCreg(marker = "bmi", formula.h = "~ gender + s(age) + s(age, by = gender)", 
				formula.ROC = "~ gender + s(age) + s(age, by = gender)", 
				group = "idf_status", 
				tag.healthy = 0, 
				data = endosim, 
				control = list(card.P=50, kbin=30, step.p=0.02), 
				ci.fit = FALSE, 
				test.partial = NULL,
				newdata = NULL)
summary(m0)				
plot(m0)			 
</code></pre>

<hr>
<h2 id='endosim'>
Simulated endocrine data.
</h2><span id='topic+endosim'></span>

<h3>Description</h3>

<p>The <code>endosim</code> data set was simulated based on the data analyzed in Rodriguez-Alvarez et al. (2011a,b) and presented in Botana et al. (2007) and Tome et al. (2008). The aim of these studies was to use the Body Mass Index (BMI) to detect patients having a higher risk of cardiovascular
problems, ascertaining the possible effect of age and gender on the accuracy of this measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(endosim)</code></pre>


<h3>Format</h3>

<p>A data frame with 2840 observations on the following 4 variables.
</p>

<dl>
<dt><code>gender</code></dt><dd><p>patient's gender. Factor with <code>Male</code> and <code>Female</code> levels.</p>
</dd>
<dt><code>age</code></dt><dd><p>patient's age.</p>
</dd>
<dt><code>idf_status</code></dt><dd><p>true disease status (presence/absence of two of more cardiovascular risk factors according to the International Diabetes Federation). Numerical vector (0=absence, 1=presence).</p>
</dd>
<dt><code>bmi</code></dt><dd><p>patient's body mass index.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Botana, M.A., Mato, J.A., Cadarso-Suarez, C., Tome, M.A., Perez-Fernandez, R., Fernandez-Mario, A., Rego-Iraeta, A., Solache, I. (2007). Overweight, obesity and central obesity prevalences in the region of Galicia in Northwest Spain. Obesity and Metabolism, 3, 106&ndash;115.
</p>
<p>Tome, M.A., Botana, M.A., Cadarso-Suarez, C., Rego-Iraeta, A., Fernandez-Mario, A., Mato, J.A, Solache, I., Perez-Fernandez, R. (2008). Prevalence of metabolic syndrome in Galicia (NW Spain) on four alternative definitions and association with insulin resistance. Journal of Endocrinological Investigation, 32, 505&ndash;511.
</p>


<h3>References</h3>

<p>Rodriguez-Alvarez, M.X., Roca-Pardinas, J. and Cadarso-Suarez, C. (2011a). ROC curve and covariates: extending induced methodology to the non-parametric framework. Statistics and Computing, 21(4), 483&ndash;499.
</p>
<p>Rodriguez- Alvarez, M.X., Roca-Pardinas, J. and Cadarso-Suarez, C. (2011b). A new flexible direct ROC regression model - Application to the detection of cardiovascular risk factors by anthropometric measures. Computational Statistics and Data Analysis, 55(12), 3257&ndash;3270.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
summary(endosim)
</code></pre>

<hr>
<h2 id='INPROCreg'>
Induced nonparametric ROC regression modelling
</h2><span id='topic+INPROCreg'></span>

<h3>Description</h3>

<p>Estimates the covariate-specific ROC curve (and related measures) in the presence of a one-dimensional continuous covariate based on the induced nonparametric ROC regression approach as presented in Rodriguez-Alvarez et al. (2011).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>INPROCreg(marker, covariate, group, tag.healthy, data, ci.fit = FALSE, 
test = FALSE, accuracy = NULL, accuracy.cal = c("ROC", "AROC"), 
newdata = NULL, control = controlINPROCreg(), weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="INPROCreg_+3A_marker">marker</code></td>
<td>
<p>A character string with the name of the diagnostic test variable.
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_covariate">covariate</code></td>
<td>
<p>A character string with the name of the continuous covariate.
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_group">group</code></td>
<td>
<p>A character string with the name of the variable that distinguishes healthy from diseased individuals.
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_tag.healthy">tag.healthy</code></td>
<td>
<p>The value codifying the healthy individuals in the variable <code>group</code>.
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_data">data</code></td>
<td>
<p>Data frame representing the data and containing all needed variables.
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_ci.fit">ci.fit</code></td>
<td>
<p>A logical value. If TRUE, confidence intervals are computed.
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_test">test</code></td>
<td>
<p>A logical value. If TRUE, the bootstrap-based test for detecting covariate effect is performed.
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_accuracy">accuracy</code></td>
<td>
<p>A character vector indicating if the Youden index (&ldquo;YI&rdquo;), the value for which the TPF and the TNF coincides (&ldquo;EQ&rdquo;), and/or optimal threshold (&ldquo;TH&rdquo;) based on these two criteria should be computed. 
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_accuracy.cal">accuracy.cal</code></td>
<td>
<p>A character string indicating if the accuracy measures should be calculated based on the covariate-specific ROC curve or on the covariate-adjusted ROC curve (AROC).
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_newdata">newdata</code></td>
<td>
<p>A data frame containing the values of the covariate at which predictions are required.
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_control">control</code></td>
<td>
<p>Output of the <code>controlINROCreg()</code> function.
</p>
</td></tr>
<tr><td><code id="INPROCreg_+3A_weights">weights</code></td>
<td>
<p>An optional vector of &lsquo;prior weights&rsquo; to be used in the fitting process.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>As a result, the function <code>INPROCreg()</code> provides a list with the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>The data frame used in the predictions.</p>
</td></tr>
<tr><td><code>fpf</code></td>
<td>
<p>Set of false positive fractions at which the covariate-specific ROC curve has been estimated.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>Estimated regression and variance functions in healthy population.</p>
</td></tr> 
<tr><td><code>d</code></td>
<td>
<p>Estimated regression and variance functions in diseased population.</p>
</td></tr>
<tr><td><code>ROC</code></td>
<td>
<p>Estimated covariate-specific ROC curve.</p>
</td></tr>	
<tr><td><code>AUC</code></td>
<td>
<p>Estimated covariate-specific AUC, and corresponding confidence intervals if required.</p>
</td></tr>
<tr><td><code>AROC</code></td>
<td>
<p>Estimated covariate-adjusted ROC curve.</p>
</td></tr>
<tr><td><code>YI/EQ</code></td>
<td>
<p>If required, estimated covariate-specific YI (or values at which the TPF and the TNF coincide), and corresponding bootstrap confidence intervals.</p>
</td></tr>
<tr><td><code>TH</code></td>
<td>
<p>If required, estimated optimal threshold values based on either the YI or the criterion of equality of TPF and TNF, and corresponding bootstrap confidence intervals.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>If required, p-value obtained with the test for checking the effect of the continuous covariate on the ROC curve.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Xose Rodriguez - Alvarez and Javier Roca-Pardinas
</p>


<h3>References</h3>

<p>Gonzalez - Manteiga, W., Pardo-Fernandez, J.C. and van Keilegom, I. (2011). ROC curves in nonparametric location-scale regression models. Scandinavian Journal of Statistics, 38, 169&ndash;184.
</p>
<p>Rodriguez - Alvarez, M.X., Roca-Pardinas, J. and Cadarso-Suarez, C. (2011). ROC curve and covariates: extending induced methodology to the non-parametric framework. Statistics and Computing, 21(4), 483&ndash;499.
</p>
<p>Yao, F., Craiu, R.V. and Reiser, B. (2010). Nonparametric covariate adjustment for receiver operating characteristic curves. The Canadian Journal of Statistics, 38, 27&ndash;46.
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+DNPROCreg">DNPROCreg</a></code>, <code><a href="#topic+summary.INPROCreg">summary.INPROCreg</a></code>, <code><a href="#topic+plot.INPROCreg">plot.INPROCreg</a></code>, <code><a href="#topic+controlINPROCreg">controlINPROCreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Evaluate the effect of age on the accuracy of the body mass index for males
m0.men &lt;- INPROCreg(marker = "bmi", covariate = "age", group = "idf_status", 
						tag.healthy = 0, 
						data = subset(endosim, gender == "Men"), 
						ci.fit = FALSE, test = FALSE, 
						accuracy = c("EQ","TH"),
						accuracy.cal="AROC", 
						control=controlINPROCreg(p=1,kbin=30,step.p=0.01), 
						newdata = data.frame(age = seq(18,85,l=50)))	

summary(m0.men)
plot(m0.men)
# Evaluate the effect of age on the accuracy of the body mass index for females
m0.women &lt;- INPROCreg(marker = "bmi", covariate = "age", group = "idf_status", 
						tag.healthy = 0, 
						data = subset(endosim, gender == "Women"), 
						ci.fit = FALSE, test = FALSE, 
						accuracy = c("EQ","TH"),
						accuracy.cal="ROC", 
						control=controlINPROCreg(p=1,kbin=30,step.p=0.01), 
						newdata = data.frame(age = seq(18,85,l=50)))
						
summary(m0.women)						
plot(m0.women)
## Not run: 
# For computing confidence intervals and testing covariate effect
set.seed(123)
m1.men &lt;- INPROCreg(marker = "bmi", covariate = "age", group = "idf_status", 
						tag.healthy = 0, 
						data = subset(endosim, gender == "Men"), 
						ci.fit = TRUE, test = TRUE, 
						accuracy = c("EQ","TH"),
						accuracy.cal="AROC", 
						control=controlINPROCreg(p=1,kbin=30,step.p=0.01), 
						newdata = data.frame(age = seq(18,85,l=50)))
summary(m1.men)
plot(m1.men)					

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.DNPROCreg'>
Default DNPROCreg plotting
</h2><span id='topic+plot.DNPROCreg'></span>

<h3>Description</h3>

<p>Takes a fitted <code>DNPROCreg</code> object produced by <code>DNPROCreg()</code> and plots the covariate-specific ROC curve and associated AUC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DNPROCreg'
plot(x, ask = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.DNPROCreg_+3A_x">x</code></td>
<td>
<p>an object of class <code>DNPROCreg</code> as produced by <code>DNPROCreg()</code></p>
</td></tr>
<tr><td><code id="plot.DNPROCreg_+3A_ask">ask</code></td>
<td>
<p>a logical value. If TRUE, the default, the user is asked for confirmation, before a new figure is drawn</p>
</td></tr>
<tr><td><code id="plot.DNPROCreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Xose Rodriguez-Alvarez and Javier Roca-Pardinas
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+DNPROCreg">DNPROCreg</a></code>, <code><a href="#topic+summary.DNPROCreg">summary.DNPROCreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Fit a model including the interaction between age and gender.
m0 &lt;- DNPROCreg(marker = "bmi", formula.h = "~ gender + s(age) + s(age, by = gender)", 
				formula.ROC = "~ gender + s(age) + s(age, by = gender)", 
				group = "idf_status", 
				tag.healthy = 0, 
				data = endosim, 
				control = list(card.P=50, kbin=30, step.p=0.02))
summary(m0)				
plot(m0)
</code></pre>

<hr>
<h2 id='plot.INPROCreg'>
Default INPROCreg plotting
</h2><span id='topic+plot.INPROCreg'></span>

<h3>Description</h3>

<p>Default INPROCreg plotting (see details)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INPROCreg'
plot(x, ask = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.INPROCreg_+3A_x">x</code></td>
<td>
<p>an object of class <code>INPROCreg</code> as produced by <code>INPROCreg()</code>.</p>
</td></tr>
<tr><td><code id="plot.INPROCreg_+3A_ask">ask</code></td>
<td>
<p>a logical value. If TRUE, the default, the user is asked for confirmation, before a new figure is drawn.</p>
</td></tr>
<tr><td><code id="plot.INPROCreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces the following plots:
</p>

<dl>
<dt>(a)</dt><dd><p>the estimated regression and variance functions in both the healthy and diseased populations.
</p>
</dd>
<dt>(b)</dt><dd><p>the covariate-specific ROC curve and AUC.
</p>
</dd>
<dt>(c)</dt><dd><p>the covariate-adjusted ROC curve (AROC).
</p>
</dd>
<dt>(d)</dt><dd><p>(optionally) the Youden Index (YI) or the value for which the TPF and the TNF coincides (EQ).
</p>
</dd>
<dt>(e)</dt><dd><p>(optionally) the optimal thresholds based on these criteria (TH).
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Maria Xose Rodriguez-Alvarez and Javier Roca-Pardinas
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+INPROCreg">INPROCreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Evaluate the effect of age on the accuracy of the body mass index for males
m0.men &lt;- INPROCreg(marker = "bmi", covariate = "age", group = "idf_status", 
						tag.healthy = 0, 
						data = subset(endosim, gender == "Men"), 
						ci.fit = FALSE, test = FALSE, 
						accuracy = c("EQ","TH"),
						accuracy.cal="AROC", 
						control=controlINPROCreg(p=1,kbin=30,step.p=0.01), 
						newdata = data.frame(age = seq(18,85,l=50)))
summary(m0.men)
plot(m0.men)						
</code></pre>

<hr>
<h2 id='print.DNPROCreg'>
Print method for DNPROCreg objects
</h2><span id='topic+print.DNPROCreg'></span>

<h3>Description</h3>

<p>Print method for DNPROCreg objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DNPROCreg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.DNPROCreg_+3A_x">x</code></td>
<td>
<p>an object of class <code>DNPROCreg</code> as produced by <code>DNPROCreg()</code></p>
</td></tr>
<tr><td><code id="print.DNPROCreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. Not yet implemented</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Xose Rodriguez-Alvarez and Javier Roca-Pardinas
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+DNPROCreg">DNPROCreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Fit a model including the interaction between age and gender.
m0 &lt;- DNPROCreg(marker = "bmi", formula.h = "~ gender + s(age) + s(age, by = gender)", 
				formula.ROC = "~ gender + s(age) + s(age, by = gender)", 
				group = "idf_status", 
				tag.healthy = 0, 
				data = endosim, 
				control = list(card.P=50, kbin=30, step.p=0.02), 
				ci.fit = FALSE, 
				test.partial = NULL,
				newdata = NULL)
m0				
summary(m0)				
plot(m0)
</code></pre>

<hr>
<h2 id='print.INPROCreg'>
Print method for INPROCreg objects
</h2><span id='topic+print.INPROCreg'></span>

<h3>Description</h3>

<p>Print method for INPROCreg objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INPROCreg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.INPROCreg_+3A_x">x</code></td>
<td>
<p>an object of class <code>INPROCreg</code> as produced by <code>INPROCreg()</code></p>
</td></tr>
<tr><td><code id="print.INPROCreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. Not yet implemented</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Xose Rodriguez - Alvarez and Javier Roca-Pardinas
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+INPROCreg">INPROCreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Evaluate the effect of age on the accuracy of the body mass index for males
m0.men &lt;- INPROCreg(marker = "bmi", covariate = "age", group = "idf_status", 
						tag.healthy = 0, 
						data = subset(endosim, gender == "Men"), 
						ci.fit = FALSE, test = FALSE, 
						accuracy = c("EQ","TH"),
						accuracy.cal="AROC", 
						control=controlINPROCreg(p=1,kbin=30,step.p=0.01), 
						newdata = data.frame(age = seq(18,85,l=50)))
m0.men						
summary(m0.men)
plot(m0.men)
</code></pre>

<hr>
<h2 id='summary.DNPROCreg'>
Summary method for DNPROCreg objects.
</h2><span id='topic+summary.DNPROCreg'></span>

<h3>Description</h3>

<p>Summary method for DNPROCreg objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DNPROCreg'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.DNPROCreg_+3A_object">object</code></td>
<td>
<p>an object of class <code>DNPROCreg</code> as produced by <code>DNPROCreg()</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="summary.DNPROCreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. Not yet implemented.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Xose Rodriguez - Alvarez and Javier Roca-Pardinas
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+DNPROCreg">DNPROCreg</a></code>, <code><a href="#topic+plot.DNPROCreg">plot.DNPROCreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Fit a model including the interaction between age and gender.
m0 &lt;- DNPROCreg(marker = "bmi", formula.h = "~ gender + s(age) + s(age, by = gender)", 
				formula.ROC = "~ gender + s(age) + s(age, by = gender)", 
				group = "idf_status", 
				tag.healthy = 0, 
				data = endosim, 
				control = list(card.P=50, kbin=30, step.p=0.02), 
				ci.fit = FALSE, 
				test.partial = NULL,
				newdata = NULL)
summary(m0)				
plot(m0)
</code></pre>

<hr>
<h2 id='summary.INPROCreg'>
Summary method for INPROCreg objects.
</h2><span id='topic+summary.INPROCreg'></span>

<h3>Description</h3>

<p>Summary method for INPROCreg objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INPROCreg'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.INPROCreg_+3A_object">object</code></td>
<td>
<p>an object of class <code>INPROCreg</code> as produced by <code>INPROCreg()</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="summary.INPROCreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. Not yet implemented.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Maria Xose Rodriguez - Alvarez and Javier Roca-Pardinas
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+INPROCreg">INPROCreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(endosim)
# Evaluate the effect of age on the accuracy of the body mass index for males
m0.men &lt;- INPROCreg(marker = "bmi", covariate = "age", group = "idf_status", 
						tag.healthy = 0, 
						data = subset(endosim, gender == "Men"), 
						ci.fit = FALSE, test = FALSE, 
						accuracy = c("EQ","TH"),
						accuracy.cal="AROC", 
						control=controlINPROCreg(p=1,kbin=30,step.p=0.01), 
						newdata = data.frame(age = seq(18,85,l=50)))
summary(m0.men)
plot(m0.men)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
