<!DOCTYPE html><html><head><title>Help for package MCMCtreeR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MCMCtreeR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#apeData'><p>ApeData</p>
Ape phylogeny in ape format, monophyletic clades, and maximum and minimum ages</a></li>
<li><a href='#estimateBound'><p>Estimate a Uniform Distribution for MCMCtree</p></a></li>
<li><a href='#estimateCauchy'><p>Estimate Cauchy Distribution for MCMCtree</p></a></li>
<li><a href='#estimateFixed'><p>Fixed Age for MCMCtree analysis input</p></a></li>
<li><a href='#estimateGamma'><p>Estimate Gamma Distribution for MCMCtree analysis</p></a></li>
<li><a href='#estimateSkewNormal'><p>Estimate Skew Normal for MCMCtree analysis</p></a></li>
<li><a href='#estimateSkewT'><p>Estimate Skew-t Distribution for MCMCtree analysis</p></a></li>
<li><a href='#estimateUpper'><p>Estimate Upper Age for MCMCtree analysis</p></a></li>
<li><a href='#MCMC.tree.plot'><p>Plot time-scaled phylogenies</p></a></li>
<li><a href='#MCMCtree.output'><p>MCMCtree.output</p></a></li>
<li><a href='#MCMCtreePhy'><p>MCMCtreePhy</p></a></li>
<li><a href='#nodeToPhy'><p>Add Node Constraints to Tree in MCMCtree Format</p></a></li>
<li><a href='#plotMCMCtree'><p>Plot distribution from MCMCtree node estimations</p></a></li>
<li><a href='#priorPosterior'><p>priorPosterior</p></a></li>
<li><a href='#readMCMCtree'><p>Read MCMCtree output tree into R</p></a></li>
<li><a href='#tipDes'><p>Find Descendent Tips From A Common Ancestor</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Prepare MCMCtree Analyses and Plot Bayesian Divergence Time
Analyses Estimates on Trees</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark Puttick [aut,cre], Pascal Title [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mark Puttick &lt;mark.puttick@bristol.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to prepare time priors for 'MCMCtree' analyses in the 'PAML' software from Yang (2007)&lt;<a href="https://doi.org/10.1093%2Fmolbev%2Fmsm088">doi:10.1093/molbev/msm088</a>&gt; and plot time-scaled phylogenies from any Bayesian divergence time analysis. Most time-calibrated node prior distributions require user-specified parameters. The package provides functions to refine these parameters, so that the resulting prior distributions accurately reflect confidence in known, usually fossil, time information. These functions also enable users to visualise distributions and write 'MCMCtree' ready input files. Additionally, the package supplies flexible functions to visualise age uncertainty on a plotted tree with using node bars, using branch widths proportional to the age uncertainty, or by plotting the full posterior distributions on nodes. Time-scaled phylogenetic plots can be visualised with absolute and geological timescales . All plotting functions are applicable with output from any Bayesian software, not just 'MCMCtree'.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3), ape (&ge; 3.0-7), sn, coda</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, utils, stats, grDevices, graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-21 19:24:11 UTC; markputtick</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-05-21 22:20:31 UTC</td>
</tr>
</table>
<hr>
<h2 id='apeData'>ApeData
Ape phylogeny in ape format, monophyletic clades, and maximum and minimum ages</h2><span id='topic+apeData'></span>

<h3>Description</h3>

<p>ApeData
Ape phylogeny in ape format, monophyletic clades, and maximum and minimum ages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(apeData)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 4.</p>


<h3>References</h3>

<p>Yang 2014
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apeData)
attach(apeData)
names(apeData)
</code></pre>

<hr>
<h2 id='estimateBound'>Estimate a Uniform Distribution for MCMCtree</h2><span id='topic+estimateBound'></span>

<h3>Description</h3>

<p>Estimate the paramaters of a soft-bounded uniform distribution and output trees for MCMCtree input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateBound(minAge, maxAge, minProb = 0.025, rightTail = 0.025, phy,
  monoGroups, writeMCMCtree = FALSE, plot = TRUE,
  MCMCtreeName = "bound.tre", pdfOutput = "uniformPlot.pdf")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateBound_+3A_minage">minAge</code></td>
<td>
<p>vector of minimum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateBound_+3A_maxage">maxAge</code></td>
<td>
<p>vector of maximum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateBound_+3A_minprob">minProb</code></td>
<td>
<p>probability of left tail (minimum bound) - default to hard minimum (minProb=0)</p>
</td></tr>
<tr><td><code id="estimateBound_+3A_righttail">rightTail</code></td>
<td>
<p>probability of right tail (maximum bound default = 0.975)</p>
</td></tr>
<tr><td><code id="estimateBound_+3A_phy">phy</code></td>
<td>
<p>fully resolved phylogeny in ape format</p>
</td></tr>
<tr><td><code id="estimateBound_+3A_monogroups">monoGroups</code></td>
<td>
<p>list  with each element containing species that define a node of interest</p>
</td></tr>
<tr><td><code id="estimateBound_+3A_writemcmctree">writeMCMCtree</code></td>
<td>
<p>logical whether to write tree in format that is compatible with MCMCTree to file</p>
</td></tr>
<tr><td><code id="estimateBound_+3A_plot">plot</code></td>
<td>
<p>logical specifying whether to plot to PDF</p>
</td></tr>
<tr><td><code id="estimateBound_+3A_mcmctreename">MCMCtreeName</code></td>
<td>
<p>MCMCtree.output file name</p>
</td></tr>
<tr><td><code id="estimateBound_+3A_pdfoutput">pdfOutput</code></td>
<td>
<p>pdf output file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing node estimates for each distribution
</p>

<ul>
<li><p>&quot;parameters&quot; estimated parameters for each node
</p>
</li>
<li><p>&quot;apePhy&quot; phylogeny in ape format with node labels showing node distributions
</p>
</li>
<li><p>&quot;MCMCtree&quot; phylogeny in MCMCtreeR format
</p>
</li>
<li><p>&quot;nodeLabels&quot; node labels in MCMCtreeR format
</p>
</li></ul>

<p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory
</p>
<p>If writeMCMCtree=TRUE tree in MCMCtree format in file &quot;MCMCtreeName&quot; written to current working directory
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apeData)
attach(apeData)
## extract taxon descending from calibrated nodes 8, 10, 11, 13
## these nodes can be visualised using plot.phylo
## and nodelabels from ape
monophyleticGroups &lt;- tipDes(apeData$apeTree, c(8,10,11,13))
minimumTimes &lt;- c("nodeOne"=15, "nodeTwo"=6,
"nodeThree"=8, "nodeFour"=13) / 10
maximumTimes &lt;- c("nodeOne" = 30, "nodeTwo" = 12,
"nodeThree"=12, "nodeFour" = 20) / 10
estimateBound(minAge=minimumTimes, maxAge=maximumTimes, 
monoGroups=monophyleticGroups, phy=apeTree, plot=FALSE)$MCMCtree
</code></pre>

<hr>
<h2 id='estimateCauchy'>Estimate Cauchy Distribution for MCMCtree</h2><span id='topic+estimateCauchy'></span>

<h3>Description</h3>

<p>Estimate the offset and scale paramaters of a soft-tailed cauchy distribution and output trees for MCMCtree input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateCauchy(minAge, maxAge, phy, monoGroups, scale = 1.5,
  offset = 50, estimateScale = TRUE, minProb = 0, maxProb = 0.975,
  plot = FALSE, pdfOutput = "cauchyPlot.pdf", writeMCMCtree = FALSE,
  MCMCtreeName = "cauchyInput.tre")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateCauchy_+3A_minage">minAge</code></td>
<td>
<p>vector of minimum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_maxage">maxAge</code></td>
<td>
<p>vector of maximum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_phy">phy</code></td>
<td>
<p>fully resolved phylogeny in ape format</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_monogroups">monoGroups</code></td>
<td>
<p>list  with each element containing species that define a node of interest</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_scale">scale</code></td>
<td>
<p>scale value for cauchy distribution (default = 1.5) (c in PAML manual page 49)</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_offset">offset</code></td>
<td>
<p>offset value for cauchy distribution (default = 50) (p in PAML manual page 49)</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_estimatescale">estimateScale</code></td>
<td>
<p>logical specifying whether to estimate scale with a given shape value (default = TRUE)</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_minprob">minProb</code></td>
<td>
<p>probability of left tail (minimum bound) - default to hard minimum (minProb=0)</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_maxprob">maxProb</code></td>
<td>
<p>probability of right tail (maximum bound. default = 0.975)</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_plot">plot</code></td>
<td>
<p>logical specifying whether to plot to PDF</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_pdfoutput">pdfOutput</code></td>
<td>
<p>pdf output file name</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_writemcmctree">writeMCMCtree</code></td>
<td>
<p>logical whether to write tree in format that is compatible with MCMCTree to file</p>
</td></tr>
<tr><td><code id="estimateCauchy_+3A_mcmctreename">MCMCtreeName</code></td>
<td>
<p>MCMCtree.output file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing node estimates for each distribution
</p>

<ul>
<li><p>&quot;parameters&quot; estimated parameters for each node
</p>
</li>
<li><p>&quot;apePhy&quot; phylogeny in ape format with node labels showing node distributions
</p>
</li>
<li><p>&quot;MCMCtree&quot; phylogeny in MCMCtree format
</p>
</li>
<li><p>&quot;nodeLabels&quot; node labels in MCMCtreeR format
</p>
</li></ul>

<p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory
</p>
<p>If writeMCMCtree=TRUE tree in MCMCtree format in file &quot;MCMCtreeName&quot; written to current working directory
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
data(apeData)
attach(apeData)
## extract taxon descending from calibrated nodes 8, 10, 11, 13
## these nodes can be visualised using plot.phylo
## and nodelabels from ape
monophyleticGroups &lt;- tipDes(apeData$apeTree, c(8,10,11,13))
minimumTimes &lt;- c(&quot;nodeOne&quot;=15, &quot;nodeTwo&quot;=6,
&quot;nodeThree&quot;=8, &quot;nodeFour&quot;=13) / 10
maximumTimes &lt;- c(&quot;nodeOne&quot; = 30, &quot;nodeTwo&quot; = 12,
&quot;nodeThree&quot;=12, &quot;nodeFour&quot; = 20) / 10
estimateCauchy(minAge=minimumTimes, maxAge=maximumTimes, 
monoGroups=monophyleticGroups, offset=0.5, 
phy=apeTree, plot=FALSE)$MCMCtree
</p>

<hr>
<h2 id='estimateFixed'>Fixed Age for MCMCtree analysis input</h2><span id='topic+estimateFixed'></span>

<h3>Description</h3>

<p>Produce fixed age trees for MCMCtree analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateFixed(minAge, phy, monoGroups, writeMCMCtree = FALSE,
  MCMCtreeName = "estimateFixed.tre")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateFixed_+3A_minage">minAge</code></td>
<td>
<p>vector of fixed age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateFixed_+3A_phy">phy</code></td>
<td>
<p>fully resolved phylogeny in ape format</p>
</td></tr>
<tr><td><code id="estimateFixed_+3A_monogroups">monoGroups</code></td>
<td>
<p>list  with each element containing species that define a node of interest</p>
</td></tr>
<tr><td><code id="estimateFixed_+3A_writemcmctree">writeMCMCtree</code></td>
<td>
<p>logical whether to write tree in format that is compatible with MCMCTree to file</p>
</td></tr>
<tr><td><code id="estimateFixed_+3A_mcmctreename">MCMCtreeName</code></td>
<td>
<p>MCMCtree.output file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing node estimates for each distribution
</p>

<ul>
<li><p>&quot;parameters&quot; estimated parameters for each node
</p>
</li>
<li><p>&quot;apePhy&quot; phylogeny in ape format with node labels showing node distributions
</p>
</li>
<li><p>&quot;MCMCtree&quot; phylogeny in MCMCtreeR format
</p>
</li>
<li><p>&quot;nodeLabels&quot; node labels in MCMCtreeR format
</p>
</li></ul>

<p>If writeMCMCtree=TRUE tree in MCMCtree format in file &quot;MCMCtreeName&quot; written to current working directory
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apeData)
attach(apeData)
## extract taxon descending from calibrated nodes 8, 10, 11, 13
## these nodes can be visualised using plot.phylo
## and nodelabels from ape
monophyleticGroups &lt;- tipDes(apeData$apeTree, c(8,10,11,13))
minimumTimes &lt;- c("nodeOne"=15, "nodeTwo"=6,
"nodeThree"=8, "nodeFour"=13) / 10
maximumTimes &lt;- c("nodeOne" = 30, "nodeTwo" = 12,
"nodeThree"=12, "nodeFour" = 20) / 10
estimateFixed(minAge=minimumTimes[1],
monoGroups=monophyleticGroups[[1]], phy=apeTree)$MCMCtree
</code></pre>

<hr>
<h2 id='estimateGamma'>Estimate Gamma Distribution for MCMCtree analysis</h2><span id='topic+estimateGamma'></span>

<h3>Description</h3>

<p>Estimate the shape and rate paramaters of Gamma distribution and output trees for MCMCtree input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateGamma(minAge, maxAge, phy, monoGroups, alpha = 188,
  beta = 2690, offset = 0.1, estimateAlpha = TRUE,
  estimateBeta = FALSE, plot = FALSE, pdfOutput = "gammaPlot.pdf",
  writeMCMCtree = FALSE, MCMCtreeName = "gammaInput.tre")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateGamma_+3A_minage">minAge</code></td>
<td>
<p>vector of minimum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_maxage">maxAge</code></td>
<td>
<p>vector of maximum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_phy">phy</code></td>
<td>
<p>fully resolved phylogeny in ape format</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_monogroups">monoGroups</code></td>
<td>
<p>list  with each element containing species that define a node of interest</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_alpha">alpha</code></td>
<td>
<p>alpha value for gamma distribution (default = 188)</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_beta">beta</code></td>
<td>
<p>beta value for gamma distribution (default = 2690)</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_offset">offset</code></td>
<td>
<p>distance of mean value from minimum bound</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_estimatealpha">estimateAlpha</code></td>
<td>
<p>logical specifying whether to estimate alpha with a given beta value (default = TRUE)</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_estimatebeta">estimateBeta</code></td>
<td>
<p>logical specifying whether to estimate beta with a given alpha value (default = FALSE)</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_plot">plot</code></td>
<td>
<p>logical specifying whether to plot to PDF</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_pdfoutput">pdfOutput</code></td>
<td>
<p>pdf output file name</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_writemcmctree">writeMCMCtree</code></td>
<td>
<p>logical whether to write tree in format that is compatible with MCMCTree to file</p>
</td></tr>
<tr><td><code id="estimateGamma_+3A_mcmctreename">MCMCtreeName</code></td>
<td>
<p>MCMCtree.output file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing node estimates for each distribution
</p>

<ul>
<li><p>&quot;parameters&quot; estimated parameters for each node
</p>
</li>
<li><p>&quot;apePhy&quot; phylogeny in <span class="pkg">APE</span> format with node labels showing node distributions
</p>
</li>
<li><p>&quot;MCMCtree&quot; phylogeny in MCMCtreeR format
</p>
</li>
<li><p>&quot;nodeLabels&quot; node labels in MCMCtreeR format
</p>
</li></ul>

<p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory
</p>
<p>If writeMCMCtree=TRUE tree in MCMCtree format in file &quot;MCMCtreeName&quot; written to current working directory
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apeData)
attach(apeData)
## extract taxon descending from calibrated nodes 8, 10, 11, 13
## these nodes can be visualised using plot.phylo
## and nodelabels from ape
monophyleticGroups &lt;- tipDes(apeData$apeTree, c(8,10,11,13))
minimumTimes &lt;- c("8"=15, "10"=6,
"11"=8, "13"=13) / 10
maximumTimes &lt;- c("8" = 30, "10" = 12,
"11"=12, "13" = 20) / 10
gamma.nodes &lt;- estimateGamma(minAge=minimumTimes, maxAge=maximumTimes, 
monoGroups=monophyleticGroups, alpha=188, beta=2690, 
offset=0.1, phy=apeTree, plot=FALSE)
gamma.nodes
</code></pre>

<hr>
<h2 id='estimateSkewNormal'>Estimate Skew Normal for MCMCtree analysis</h2><span id='topic+estimateSkewNormal'></span>

<h3>Description</h3>

<p>Estimate the shape, scale, and location paramaters of a skew normal distribution and output trees for MCMCtree input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateSkewNormal(minAge, maxAge, monoGroups, phy, shape = 50,
  scale = 1.5, addMode = 0, maxProb = 0.975, minProb = 0.003,
  estimateScale = TRUE, estimateShape = FALSE, estimateMode = FALSE,
  plot = FALSE, pdfOutput = "skewNormalPlot.pdf",
  writeMCMCtree = FALSE, MCMCtreeName = "skewNormalInput.tre")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateSkewNormal_+3A_minage">minAge</code></td>
<td>
<p>vector of minimum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_maxage">maxAge</code></td>
<td>
<p>vector of maximum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_monogroups">monoGroups</code></td>
<td>
<p>list  with each element containing species that define a node of interest</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_phy">phy</code></td>
<td>
<p>fully resolved phylogeny in ape format</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_shape">shape</code></td>
<td>
<p>shape value for skew normal distribution (default = 50)</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_scale">scale</code></td>
<td>
<p>scale value for skew normal distribution (default = 1.5)</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_addmode">addMode</code></td>
<td>
<p>addition to the minimum age to give the location of the distribution</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_maxprob">maxProb</code></td>
<td>
<p>probability of right tail (maximum bound default = 0.975)</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_minprob">minProb</code></td>
<td>
<p>probability of left tail (maximum bound default = 0.003)</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_estimatescale">estimateScale</code></td>
<td>
<p>logical specifying whether to estimate scale with a given shape value (default = TRUE)</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_estimateshape">estimateShape</code></td>
<td>
<p>logical specifying whether to estimate shape with a given scale value (default = FALSE)</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_estimatemode">estimateMode</code></td>
<td>
<p>logical speciftying whether to estimate the scale that produces probabilities of each tail that corresponds roughly to the values given by minProb (lower tail) and maxProb (upper tail)</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_plot">plot</code></td>
<td>
<p>logical specifying whether to plot to PDF</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_pdfoutput">pdfOutput</code></td>
<td>
<p>pdf output file name</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_writemcmctree">writeMCMCtree</code></td>
<td>
<p>logical whether to write tree in format that is compatible with MCMCTree to file</p>
</td></tr>
<tr><td><code id="estimateSkewNormal_+3A_mcmctreename">MCMCtreeName</code></td>
<td>
<p>MCMCtree.output file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing node estimates for each distribution
</p>

<ul>
<li><p>&quot;parameters&quot; estimated parameters for each node
</p>
</li>
<li><p>&quot;apePhy&quot; phylogeny in ape format with node labels showing node distributions
</p>
</li>
<li><p>&quot;MCMCtree&quot; phylogeny in MCMCtree format
</p>
</li>
<li><p>&quot;nodeLabels&quot; node labels in MCMCtreeR format
</p>
</li></ul>

<p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory
</p>
<p>If writeMCMCtree=TRUE tree in MCMCtree format in file &quot;MCMCtreeName&quot; written to current working directory
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>See Also</h3>

<p><code><a href="sn.html#topic+qst">qst</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apeData)
attach(apeData)
monophyleticGroups &lt;- list()
## extract taxon descending from calibrated nodes 8, 10, 11, 13
## these nodes can be visualised using plot.phylo
## and nodelabels from ape
monophyleticGroups &lt;- tipDes(apeData$apeTree, c(8,10,11,13))
minimumTimes &lt;- c("nodeOne"=15, "nodeTwo"=6,
"nodeThree"=8, "nodeFour"=13) / 10
maximumTimes &lt;- c("nodeOne" = 30, "nodeTwo" = 12,
"nodeThree"=12, "nodeFour" = 20) / 10
estimateSkewNormal(minAge=minimumTimes, maxAge=maximumTimes, 
monoGroups=monophyleticGroups, phy=apeTree, plot=FALSE)
</code></pre>

<hr>
<h2 id='estimateSkewT'>Estimate Skew-t Distribution for MCMCtree analysis</h2><span id='topic+estimateSkewT'></span>

<h3>Description</h3>

<p>Estimate the shape, scale, and location paramaters of a Skew-t distribution and output trees for MCMCtree input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateSkewT(minAge, maxAge, monoGroups, phy, shape = 50, scale = 1.5,
  df = 1, addMode = 0, maxProb = 0.975, minProb = 0.003,
  estimateScale = TRUE, estimateShape = FALSE, estimateMode = FALSE,
  plot = FALSE, pdfOutput = "skewTPlot.pdf", writeMCMCtree = FALSE,
  MCMCtreeName = "skewTInput.tre")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateSkewT_+3A_minage">minAge</code></td>
<td>
<p>vector of minimum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_maxage">maxAge</code></td>
<td>
<p>vector of maximum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_monogroups">monoGroups</code></td>
<td>
<p>list  with each element containing species that define a node of interest</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_phy">phy</code></td>
<td>
<p>fully resolved phylogeny in ape format</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_shape">shape</code></td>
<td>
<p>shape value for skew-t distribution (default = 50)</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_scale">scale</code></td>
<td>
<p>scale value for skew-t distribution (default = 1.5)</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_df">df</code></td>
<td>
<p>degrees of freedom for skew-t distribution (default = 1)</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_addmode">addMode</code></td>
<td>
<p>addition to the minimum age to give the location of the distribution</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_maxprob">maxProb</code></td>
<td>
<p>probability of right tail (maximum bound default = 0.975)</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_minprob">minProb</code></td>
<td>
<p>probability of left tail (maximum bound default = 0.003)</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_estimatescale">estimateScale</code></td>
<td>
<p>logical specifying whether to estimate scale with a given shape value (default = TRUE)</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_estimateshape">estimateShape</code></td>
<td>
<p>logical specifying whether to estimate shape with a given scale value (default = FALSE)</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_estimatemode">estimateMode</code></td>
<td>
<p>logical speciftying whether to estimate the scale that produces probabilities of each tail that corresponds roughly to the values given by minProb (lower tail) and maxProb (upper tail)</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_plot">plot</code></td>
<td>
<p>logical specifying whether to plot to PDF</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_pdfoutput">pdfOutput</code></td>
<td>
<p>pdf output file name</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_writemcmctree">writeMCMCtree</code></td>
<td>
<p>logical whether to write tree in format that is compatible with MCMCTree to file</p>
</td></tr>
<tr><td><code id="estimateSkewT_+3A_mcmctreename">MCMCtreeName</code></td>
<td>
<p>MCMCtree.output file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing node estimates for each distribution
</p>

<ul>
<li><p>&quot;parameters&quot; estimated parameters for each node
</p>
</li>
<li><p>&quot;apePhy&quot; phylogeny in <span class="pkg">APE</span> format with node labels showing node distributions
</p>
</li>
<li><p>&quot;MCMCtree&quot; phylogeny in MCMCtree format
</p>
</li>
<li><p>&quot;nodeLabels&quot; node labels in MCMCtreeR format
</p>
</li></ul>

<p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory
</p>
<p>If writeMCMCtree=TRUE tree in MCMCtree format in file &quot;MCMCtreeName&quot; written to current working directory
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>See Also</h3>

<p><code><a href="sn.html#topic+qst">qst</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apeData)
attach(apeData)
## extract taxon descending from calibrated nodes 8, 10, 11, 13
## these nodes can be visualised using plot.phylo
## and nodelabels from ape
monophyleticGroups &lt;- tipDes(apeData$apeTree, c(8,10,11,13))
minimumTimes &lt;- c("nodeOne"=15, "nodeTwo"=6,
"nodeThree"=8, "nodeFour"=13) / 10
maximumTimes &lt;- c("nodeOne" = 30, "nodeTwo" = 12,
"nodeThree"=12, "nodeFour" = 20) / 10
estimateSkewT(minAge=minimumTimes, maxAge=maximumTimes,
monoGroups=monophyleticGroups, phy=apeTree, plot=FALSE)$MCMCtree
</code></pre>

<hr>
<h2 id='estimateUpper'>Estimate Upper Age for MCMCtree analysis</h2><span id='topic+estimateUpper'></span>

<h3>Description</h3>

<p>Estimate the upper age distribution and output trees for MCMCtree input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateUpper(maxAge, rightTail = 0.025, phy, monoGroups,
  writeMCMCtree = FALSE, MCMCtreeName = "estimateUpper.tre")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateUpper_+3A_maxage">maxAge</code></td>
<td>
<p>vector of maximum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="estimateUpper_+3A_righttail">rightTail</code></td>
<td>
<p>probability of right tail (maximum bound default = 0.025)</p>
</td></tr>
<tr><td><code id="estimateUpper_+3A_phy">phy</code></td>
<td>
<p>fully resolved phylogeny in ape format</p>
</td></tr>
<tr><td><code id="estimateUpper_+3A_monogroups">monoGroups</code></td>
<td>
<p>list  with each element containing species that define a node of interest</p>
</td></tr>
<tr><td><code id="estimateUpper_+3A_writemcmctree">writeMCMCtree</code></td>
<td>
<p>logical whether to write tree in format that is compatible with MCMCTree to file</p>
</td></tr>
<tr><td><code id="estimateUpper_+3A_mcmctreename">MCMCtreeName</code></td>
<td>
<p>MCMCtree.output file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing node estimates for each distribution
</p>

<ul>
<li><p>&quot;parameters&quot; estimated parameters for each node
</p>
</li>
<li><p>&quot;apePhy&quot; phylogeny in <span class="pkg">APE</span> format with node labels showing node distributions
</p>
</li>
<li><p>&quot;MCMCtree&quot; phylogeny in MCMCtree format
</p>
</li>
<li><p>&quot;nodeLabels&quot; node labels in MCMCtreeR format
</p>
</li></ul>

<p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory
</p>
<p>If writeMCMCtree=TRUE tree in MCMCtree format in file &quot;MCMCtreeName&quot; written to current working directory
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apeData)
attach(apeData)
## extract taxon descending from calibrated nodes 8, 10, 11, 13
## these nodes can be visualised using plot.phylo
## and nodelabels from ape
monophyleticGroups &lt;- tipDes(apeData$apeTree, c(8,10,11,13))
minimumTimes &lt;- c("nodeOne"=15, "nodeTwo"=6,
"nodeThree"=8, "nodeFour"=13) / 10
maximumTimes &lt;- c("nodeOne" = 30, "nodeTwo" = 12,
"nodeThree"=12, "nodeFour" = 20) / 10
estimateUpper(maxAge=maximumTimes, monoGroups=monophyleticGroups,
rightTail=0.025, phy=apeTree)
</code></pre>

<hr>
<h2 id='MCMC.tree.plot'>Plot time-scaled phylogenies</h2><span id='topic+MCMC.tree.plot'></span>

<h3>Description</h3>

<p>Plot time-scaled phylogenies with node uncertainty and timescale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMC.tree.plot(phy = NULL, analysis.type = "MCMCtree",
  MCMC.chain = NULL, node.ages = NULL, directory.files = NULL,
  plot.type = "phylogram", build.tree = FALSE, node.method = "bar",
  all.nodes = NULL, add.time.scale = TRUE, add.abs.time = TRUE,
  scale.res = "Epoch", label.timescale.names = FALSE,
  time.correction = 1, col.age = "blue", tip.lengths = FALSE,
  density.col = "#00000050", density.border.col = "#00000080",
  cex.tips = 1, show.tip.label = TRUE, col.tree = "black",
  tip.color = "black", lwd.bar = 1, grey.bars = TRUE, cex.age = 1,
  cex.labels = 1, cex.names = 1, relative.height = 0.08,
  tip.bar.col = "#ff000050", burn.in = 0.25,
  distribution.height = 0.8, abs.age.mgp = c(3, 0.35, 0),
  abs.age.lwd.ticks = 0.7, abs.age.lwd = 0, tck.abs.age = -0.01,
  abs.age.line = -0.4, pos.age = NULL, n.runs = 2,
  ladderize.tree = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCMC.tree.plot_+3A_phy">phy</code></td>
<td>
<p>A timescaled phylogeny, unless analysis.type=&quot;MCMCtree&quot; and build.tree=TRUE</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_analysis.type">analysis.type</code></td>
<td>
<p>The method used to generate the time-scale tree, one of MCMCtree, MrBayes, RevBayes, or User.</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_mcmc.chain">MCMC.chain</code></td>
<td>
<p>The full posterior of age estimates for all nodes (default NULL)</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_node.ages">node.ages</code></td>
<td>
<p>List of user-supplied node ages applicable for analysis.type user. Either all nodes or a selection of nodes. Each list element must be named with its corresponding node label from the APE format.</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_directory.files">directory.files</code></td>
<td>
<p>The directory for files to summarise for MrBayes and RevBayes analyses</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_plot.type">plot.type</code></td>
<td>
<p>The plotting method for the phylogram corresponding to the APE definition. Phylogram is available for all analysis types, but cladogram is only avilable for MCMCtree analyses at present. Type distributions plots a phylogram with stats::density distributions on each of the nodes.</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_build.tree">build.tree</code></td>
<td>
<p>Logical. Only applicable to MCMCtree analyses, whether to timescale the phylogeny based on the full MCMC chain</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_node.method">node.method</code></td>
<td>
<p>For plot.type phylogram the method to dispay age uncertainty on each node, either bar, node.length, or full.length. If 'none' is supplied plotting node uncertainty is suppressed.</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_all.nodes">all.nodes</code></td>
<td>
<p>If NULL (default) node uncertainty is plotted on all nodes. If node numbers are supplied, only these nodes will be labelled with uncertainty.</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_add.time.scale">add.time.scale</code></td>
<td>
<p>Logical. Adds a timescale to the plotted phylogeny.</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_add.abs.time">add.abs.time</code></td>
<td>
<p>Logical. Adds an absolute timescale alongside the geological timescale. Only applicable if add.time.scale is TRUE</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_scale.res">scale.res</code></td>
<td>
<p>The geological age designation to add to the plot can be one or a combination of Eon, Period, Epoch, Age. The order of plot (from bottom to top) is the same as the supplied order. Subsequent arguments add.abs.time and grey.bars are based on the last supplied age designation.</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_label.timescale.names">label.timescale.names</code></td>
<td>
<p>Logical. Add names (Eon, Period, Epoch, Age, Ma) to axis if timescale used</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_time.correction">time.correction</code></td>
<td>
<p>Number to place branch lengths and age estimates in absolute time, deafult to one.</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_col.age">col.age</code></td>
<td>
<p>The colouring of the node.method bars to summarise node age uncertainty</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_tip.lengths">tip.lengths</code></td>
<td>
<p>Logical. If the tree contains non-present tip ages, the age uncertainty associated with them will be added to the plot</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_density.col">density.col</code></td>
<td>
<p>Colour of the node distributions (if analysis.type=distributions)</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_density.border.col">density.border.col</code></td>
<td>
<p>Colour of the node distributions (if analysis.type=distributions) borders</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_cex.tips">cex.tips</code></td>
<td>
<p>Size of the phylogeny tip labels</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_show.tip.label">show.tip.label</code></td>
<td>
<p>Logical. Should the tree tip labels be displayed</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_col.tree">col.tree</code></td>
<td>
<p>Colour of the phylogeny edges</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_tip.color">tip.color</code></td>
<td>
<p>Colour of the phylogeny tip labels</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_lwd.bar">lwd.bar</code></td>
<td>
<p>Width of the bar to summarise age uncertainty, applicable only if plot.type is phylogram and node.method is bar</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_grey.bars">grey.bars</code></td>
<td>
<p>Logical. Should grey bars be used to signify time bins, applicable only if add.time.scale is TRUE</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_cex.age">cex.age</code></td>
<td>
<p>Size of the labels for the absolute timescale</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_cex.labels">cex.labels</code></td>
<td>
<p>Size of the labels for the geological timescale</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_cex.names">cex.names</code></td>
<td>
<p>Logical. Add label.timescale.names, if applicable.</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_relative.height">relative.height</code></td>
<td>
<p>the relative height of the timescale labels</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_tip.bar.col">tip.bar.col</code></td>
<td>
<p>The colour of uncertainty around non-contemporary tips</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_burn.in">burn.in</code></td>
<td>
<p>The number of points in the chain to discard for MrBayes and RevBayes analyses</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_distribution.height">distribution.height</code></td>
<td>
<p>The relative height of node distributions when plot.type is distributions measured as the relative height of the descendent node</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_abs.age.mgp">abs.age.mgp</code></td>
<td>
<p>mgp values for the absolute age axis, only applicable if add.abs.time is TRUE</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_abs.age.lwd.ticks">abs.age.lwd.ticks</code></td>
<td>
<p>lwd values for the absolute age axis ticks, only applicable if add.abs.time is TRUE</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_abs.age.lwd">abs.age.lwd</code></td>
<td>
<p>lwd values for the absolute age axis horizontal line, only applicable if add.abs.time is TRUE</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_tck.abs.age">tck.abs.age</code></td>
<td>
<p>tck values for the absolute age axis tick height, only applicable if add.abs.time is TRUE</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_abs.age.line">abs.age.line</code></td>
<td>
<p>line correction for the absolute age axis tick, only applicable if add.abs.time is TRUE</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_pos.age">pos.age</code></td>
<td>
<p>position position of absolute age axis</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_n.runs">n.runs</code></td>
<td>
<p>For analysis.type mrbayes, the number of independent chains to summarise</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_ladderize.tree">ladderize.tree</code></td>
<td>
<p>Logical. Plot a ladderized tree (TRUE) or not (FALSE)</p>
</td></tr>
<tr><td><code id="MCMC.tree.plot_+3A_...">...</code></td>
<td>
<p>further arguments to be used in <code><a href="ape.html#topic+plot.phylo">plot.phylo</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The primary inputs for the 'method' options are outputs from analysis conducting using MCMCtree, MrBayes, RevBayes, or User.
</p>
<p>For analyses under the 'MCMCtree' option (the default) the function only requires a 'FigTree' output from MCMCtree analysis or the full MCMCtree posterior. For option &quot;MrBayes&quot; and &quot;RevBayes&quot;, the method argument takes the user-supplied directory address in which all the output files are stored.
</p>
<p>For the option 'User' the function requires a full posterior distribution and time-scaled phylogeny. This function can take any posterior distribution, but it may require some manipulation. The argument node.ages in MCMC.tree.plot takes a named list containing the posterior ages for each node, with the name of each element corresponding to the node in the phylogeny.
</p>


<h3>Value</h3>

<p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MCMCtree.output)
attach(MCMCtree.output)
## if it is necessary to read in file manually
## MCMCtree.posterior &lt;- read.csv("mcmc.posterior.file.directory", sep="\t")
MCMCtree.file &lt;- readMCMCtree(MCMCtree.phy, from.file=FALSE)$apePhy
MCMC.tree.plot(phy=MCMCtree.file,  analysis.type="MCMCtree",
MCMC.chain=MCMCtree.posterior, plot.type="distributions", cex.tips=0.5)
</code></pre>

<hr>
<h2 id='MCMCtree.output'>MCMCtree.output</h2><span id='topic+MCMCtree.output'></span>

<h3>Description</h3>

<p>Phylogeny output from MCMCtree, and posterior estimates from MCMCtree 'out' file from a re-analysis of data from Morris et al. 2018
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MCMCtree.output)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 2.</p>


<h3>References</h3>

<p>Morris et al. 2018
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MCMCtree.output)
attach(MCMCtree.output)
names(MCMCtree.output)
</code></pre>

<hr>
<h2 id='MCMCtreePhy'>MCMCtreePhy</h2><span id='topic+MCMCtreePhy'></span>

<h3>Description</h3>

<p>Wrapper function to estimate node distributions and add them to tree and output MCMCtree format phylogeny file. If parameter values are in vectors shorter than the number of nodes they are recycled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCMCtreePhy(phy, minAges, maxAges, monoGroups, method = c("cauchy",
  "upper", "bound", "gamma", "skewNormal", "skewT", "fixed"),
  offset = 0.1, df = 1, shape = 50, scale = 1.5, minProb = 1e-08,
  addMode = 0, maxProb = 0.975, rightTail = 0.025, alpha = 188,
  beta = 100, estimateScale = TRUE, estimateShape = FALSE,
  estimateMode = FALSE, estimateAlpha = TRUE, estimateBeta = FALSE,
  plot = FALSE, pdfOutput = "nodeDistributions.pdf",
  writeMCMCtree = TRUE, MCMCtreeName = "output.tre")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCMCtreePhy_+3A_phy">phy</code></td>
<td>
<p>fully resolved phylogeny in ape format</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_minages">minAges</code></td>
<td>
<p>vector of minimum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_maxages">maxAges</code></td>
<td>
<p>vector of maximum age bounds for nodes matching order in monoGroups</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_monogroups">monoGroups</code></td>
<td>
<p>list  with each element containing species that define a node of interest</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_method">method</code></td>
<td>
<p>vector of the type of calibration distribution for each node</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_offset">offset</code></td>
<td>
<p>offset value for distribution (default = 50)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_df">df</code></td>
<td>
<p>degrees of freedom for skew-t distribution (default = 1)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_shape">shape</code></td>
<td>
<p>shape value for skew-t distribution (default = 50)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_scale">scale</code></td>
<td>
<p>scale value for distribution (default = 1.5)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_minprob">minProb</code></td>
<td>
<p>probability of left tail (minimum bound) - default to hard minimum (minProb=0)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_addmode">addMode</code></td>
<td>
<p>addition to the minimum age to give the location of the distribution</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_maxprob">maxProb</code></td>
<td>
<p>probability of right tail (maximum bound. default = 0.975)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_righttail">rightTail</code></td>
<td>
<p>probability of right tail (maximum bound default = 0.025)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_alpha">alpha</code></td>
<td>
<p>alpha value for gamma distribution (default = 188)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_beta">beta</code></td>
<td>
<p>beta value for gamma distribution (default = 2690)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_estimatescale">estimateScale</code></td>
<td>
<p>logical specifying whether to estimate scale with a given shape value (default = TRUE)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_estimateshape">estimateShape</code></td>
<td>
<p>logical specifying whether to estimate shape with a given scale value</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_estimatemode">estimateMode</code></td>
<td>
<p>logical speciftying whether to estimate the scale that produces probabilities of each tail that corresponds roughly to the values given by minProb (lower tail) and maxProb (upper tail)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_estimatealpha">estimateAlpha</code></td>
<td>
<p>logical specifying whether to estimate alpha with a given beta value (default = TRUE)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_estimatebeta">estimateBeta</code></td>
<td>
<p>logical specifying whether to estimate beta with a given alpha value (default = FALSE)</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_plot">plot</code></td>
<td>
<p>logical specifying whether to plot to PDF</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_pdfoutput">pdfOutput</code></td>
<td>
<p>pdf output file name</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_writemcmctree">writeMCMCtree</code></td>
<td>
<p>logical whether to write tree in format that is compatible with MCMCTree to file</p>
</td></tr>
<tr><td><code id="MCMCtreePhy_+3A_mcmctreename">MCMCtreeName</code></td>
<td>
<p>MCMCtree.output file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing node estimates for each distribution
</p>

<ul>
<li><p>&quot;parameters&quot; estimated parameters for each node
</p>
</li>
<li><p>&quot;apePhy&quot; phylogeny in <span class="pkg">APE</span> format with node labels showing node distributions
</p>
</li>
<li><p>&quot;MCMCtree&quot; phylogeny in MCMCtree format
</p>
</li>
<li><p>&quot;nodeLabels&quot; node labels in MCMCtreeR format
</p>
</li></ul>

<p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory
</p>
<p>If writeMCMCtree=TRUE tree in MCMCtree format in file &quot;MCMCtreeName&quot; written to current working directory
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apeData)
attach(apeData)
## extract taxon descending from calibrated nodes 8, 10, 11, 13
## these nodes can be visualised using plot.phylo
## and nodelabels from ape
monophyleticGroups &lt;- tipDes(apeData$apeTree, c(8,10,11,13))
minimumTimes &lt;- c("nodeOne"=15, "nodeTwo"=6,
"nodeThree"=8, "nodeFour"=13) / 10
maximumTimes &lt;- c("nodeOne" = 30, "nodeTwo" = 12,
"nodeThree"=12, "nodeFour" = 20) / 10
# Cauchy, upper age, bound, and gamma applied individually to each node
MCMCtreePhy(phy=apeTree, minAge=minimumTimes, maxAge=maximumTimes, 
monoGroups=monophyleticGroups, plot=FALSE, 
method=c("cauchy", "upper", "bound", "gamma"), writeMCMCtree=FALSE)
</code></pre>

<hr>
<h2 id='nodeToPhy'>Add Node Constraints to Tree in MCMCtree Format</h2><span id='topic+nodeToPhy'></span>

<h3>Description</h3>

<p>Produce tree with node labels in MCMCtree format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nodeToPhy(phy, monoGroups, nodeCon, returnPhy = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nodeToPhy_+3A_phy">phy</code></td>
<td>
<p>fully resolved phylogeny in ape format</p>
</td></tr>
<tr><td><code id="nodeToPhy_+3A_monogroups">monoGroups</code></td>
<td>
<p>list  with each element containing species that define a node of interest</p>
</td></tr>
<tr><td><code id="nodeToPhy_+3A_nodecon">nodeCon</code></td>
<td>
<p>node distributions in MCMCtreeR format</p>
</td></tr>
<tr><td><code id="nodeToPhy_+3A_returnphy">returnPhy</code></td>
<td>
<p>logical specifying whether to return phy to console or write MCMCtree for input (default = TRUE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If returnPhy=TRUE phylogeny with node labels in ape format
</p>
<p>If returnPhy=FALSE phylogeny with node labels in MCMCtree format
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>

<hr>
<h2 id='plotMCMCtree'>Plot distribution from MCMCtree node estimations</h2><span id='topic+plotMCMCtree'></span>

<h3>Description</h3>

<p>Estimate the offset and scale paramaters of a soft-tailed cauchy distribution and output trees for MCMCtree input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMCMCtree(parameters, method = c("skewT", "skewNormal", "cauchy",
  "gamma", "bound"), title, upperTime, lowerTime = 0,
  plotMCMCtreeData = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMCMCtree_+3A_parameters">parameters</code></td>
<td>
<p>output parameters from node estimation function</p>
</td></tr>
<tr><td><code id="plotMCMCtree_+3A_method">method</code></td>
<td>
<p>one of skewT, skewNormal, cauchy, gamma, or bound</p>
</td></tr>
<tr><td><code id="plotMCMCtree_+3A_title">title</code></td>
<td>
<p>title for the plot</p>
</td></tr>
<tr><td><code id="plotMCMCtree_+3A_uppertime">upperTime</code></td>
<td>
<p>maxmimum age for x-axis plot</p>
</td></tr>
<tr><td><code id="plotMCMCtree_+3A_lowertime">lowerTime</code></td>
<td>
<p>maxmimum age for x-axis plot (default = 0)</p>
</td></tr>
<tr><td><code id="plotMCMCtree_+3A_plotmcmctreedata">plotMCMCtreeData</code></td>
<td>
<p>If TRUE returns co-ordinates to plot distributions to allow greater flexibility (default = TRUE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot of the specified prior applied for a node
</p>
<p>If plotMCMCtreeData=TRUE x and y coordinates of distributions from 0 to upperTime on x axis
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apeData)
attach(apeData)
# create monophyletic groups descending from nodes 8, 10, 11, and 13
monophyleticGroups &lt;- tipDes(apeData$apeTree, c(8,10,11,13))
minimumTimes &lt;- c("nodeOne"=15, "nodeTwo"=6,
"nodeThree"=8, "nodeFour"=13) / 10
maximumTimes &lt;- c("nodeOne" = 30, "nodeTwo" = 12,
"nodeThree"=12, "nodeFour" = 20) / 10
cauchy &lt;- estimateCauchy(minAge=minimumTimes[1], maxAge=maximumTimes[1],
monoGroups=monophyleticGroups[[1]], offset=0.5, phy=apeTree, plot=FALSE)
## un-comment to run
plotMCMCtree(parameters=cauchy$parameters, method="cauchy",
title="cauchyPlot", upperTime=maximumTimes[1]+1)
</code></pre>

<hr>
<h2 id='priorPosterior'>priorPosterior</h2><span id='topic+priorPosterior'></span>

<h3>Description</h3>

<p>Analyse prior and posterior node distributions from MCMCtree analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>priorPosterior(MCMCPrior, MCMCPosterior = NULL, inputTree,
  return.density = FALSE, rootCalibration = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="priorPosterior_+3A_mcmcprior">MCMCPrior</code></td>
<td>
<p>prior of MCMC file from MCMCtree analysis using data=0</p>
</td></tr>
<tr><td><code id="priorPosterior_+3A_mcmcposterior">MCMCPosterior</code></td>
<td>
<p>posterior of MCMC file from MCMCtree analysis using data</p>
</td></tr>
<tr><td><code id="priorPosterior_+3A_inputtree">inputTree</code></td>
<td>
<p>phylogeny in MCMCtree format used in MCMCtree analysis</p>
</td></tr>
<tr><td><code id="priorPosterior_+3A_return.density">return.density</code></td>
<td>
<p>Logical. Whether to return the density or original values for the effective prior and posterior.</p>
</td></tr>
<tr><td><code id="priorPosterior_+3A_rootcalibration">rootCalibration</code></td>
<td>
<p>= NULL If NULL, then behaves as by default. Alternatively, if a user has specified a root prior in the MCMCtreeR control file it can be added here as a vector in the form it would appear tree.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing node estimates for each distribution
</p>

<ul>
<li><p>&quot;prior&quot; distribution of effective prior
</p>
</li>
<li><p>&quot;posterior&quot; distribution of posterior
</p>
</li>
<li><p>&quot;specifiedPrior&quot; distribution of specified prior
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mark Puttick, Pascal Title
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MCMCtree.output)
# priorPosterior(MCMCPrior, 
# MCMCPosterior=MCMCtree.output$MCMCtree.posterior, 
# path.to.input.tree)
</code></pre>

<hr>
<h2 id='readMCMCtree'>Read MCMCtree output tree into R</h2><span id='topic+readMCMCtree'></span>

<h3>Description</h3>

<p>Read MCMCtree output tree into R to produce time-scaled tree in APE format, and a table of the mean and 95
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readMCMCtree(inputPhy, forceUltrametric = TRUE, from.file = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readMCMCtree_+3A_inputphy">inputPhy</code></td>
<td>
<p>file directory of 'Figtree' output from MCMCtree</p>
</td></tr>
<tr><td><code id="readMCMCtree_+3A_forceultrametric">forceUltrametric</code></td>
<td>
<p>alters branch lengths at tips so tree is fully ultrametric (default = TRUE)</p>
</td></tr>
<tr><td><code id="readMCMCtree_+3A_from.file">from.file</code></td>
<td>
<p>Logical. Read a tree from file or locally from within R?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>apePhy time-scaled output tree from MCMCtree in APE format
</p>
<p>nodeAges mean and 95
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MCMCtree.output)
attach(MCMCtree.output)
# tree and node ages
readMCMCtree(MCMCtree.phy, from.file=FALSE)
</code></pre>

<hr>
<h2 id='tipDes'>Find Descendent Tips From A Common Ancestor</h2><span id='topic+tipDes'></span>

<h3>Description</h3>

<p>This function finds tip descendants from a common ancestor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tipDes(phy, node)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tipDes_+3A_phy">phy</code></td>
<td>
<p>user tree in ape format</p>
</td></tr>
<tr><td><code id="tipDes_+3A_node">node</code></td>
<td>
<p>one or more nodes from the ape format that designate the crown monophyletic group</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a single node number is supplied the function returns a vector of tip labels. When more than one node number is supplied the function returns a list with each element a vector of tip labels for that node.
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1029)
# one node
phy &lt;- rcoal(10)
node &lt;- 13
tipDes(phy, node)
## multiple nodes
node &lt;- c(13,14,15)
tipDes(phy, node)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
