<!DOCTYPE html><html><head><title>Help for package validann</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {validann}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ann'><p>Fit Artificial Neural Networks.</p></a></li>
<li><a href='#ar9'><p>Data generated by autoregressive AR9 model.</p></a></li>
<li><a href='#observed'><p>Return observed target values.</p></a></li>
<li><a href='#plot.validann'><p>Plot ANN validation results.</p></a></li>
<li><a href='#predict.ann'><p>Predict new examples using a trained neural network.</p></a></li>
<li><a href='#validann'><p>Validate Artificial Neural Networks.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Validation Tools for Artificial Neural Networks</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-11-08</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods and tools for analysing and validating the outputs
    and modelled functions of artificial neural networks (ANNs) in terms
    of predictive, replicative and structural validity. Also provides a
    method for fitting feed-forward ANNs with a single hidden layer.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>moments</td>
</tr>
<tr>
<td>Suggests:</td>
<td>nnet, knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://github.com/gbhumphrey1/validann">http://github.com/gbhumphrey1/validann</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="http://github.com/gbhumphrey1/validann/issues">http://github.com/gbhumphrey1/validann/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-04-20 05:29:31 UTC; ghumphrey</td>
</tr>
<tr>
<td>Author:</td>
<td>Greer B. Humphrey [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Greer B. Humphrey &lt;greer.humphrey@student.adelaide.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-04-20 08:35:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='ann'>Fit Artificial Neural Networks.</h2><span id='topic+ann'></span>

<h3>Description</h3>

<p>Fits a single hidden layer ANN model to input data <code>x</code> and output data
<code>y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ann(x, y, size, act_hid = c("tanh", "sigmoid", "linear", "exp"),
  act_out = c("linear", "sigmoid", "tanh", "exp"), Wts = NULL, rang = 0.5,
  objfn = NULL, method = "BFGS", maxit = 1000, abstol = 1e-04,
  reltol = 1e-08, trace = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ann_+3A_x">x</code></td>
<td>
<p>matrix, data frame or vector of numeric input values, with
<code>ncol(x)</code> equal to the number of inputs/predictors and <code>nrow(x)</code>
equal to the number of examples. A vector is considered to comprise examples
of a single input or predictor variable.</p>
</td></tr>
<tr><td><code id="ann_+3A_y">y</code></td>
<td>
<p>matrix, data frame or vector of target values for examples.</p>
</td></tr>
<tr><td><code id="ann_+3A_size">size</code></td>
<td>
<p>number of hidden layer nodes. Can be zero.</p>
</td></tr>
<tr><td><code id="ann_+3A_act_hid">act_hid</code></td>
<td>
<p>activation function to be used at the hidden layer.
See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="ann_+3A_act_out">act_out</code></td>
<td>
<p>activation function to be used at the output layer.
See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="ann_+3A_wts">Wts</code></td>
<td>
<p>initial weight vector. If <code>NULL</code> chosen at random.</p>
</td></tr>
<tr><td><code id="ann_+3A_rang">rang</code></td>
<td>
<p>initial random weights on [-rang,rang].
Default value is 0.5.</p>
</td></tr>
<tr><td><code id="ann_+3A_objfn">objfn</code></td>
<td>
<p>objective function to be minimised when fitting
weights. This function may be user-defined with the first two arguments
corresponding to <code>y</code> (the observed target data) and <code>y_hat</code>
(the ANN output). If this function has additional parameters which require
optimizing, these must be defined in argument <code>par_of</code>
(see AR(1) case in &lsquo;Examples&rsquo;). Default is <code>sse</code> (internal
function to compute sum squared error, with error given by
<code>y - y_hat</code>) when <code>objfn = NULL</code>.</p>
</td></tr>
<tr><td><code id="ann_+3A_method">method</code></td>
<td>
<p>the method to be used by <code><a href="stats.html#topic+optim">optim</a></code>
for minimising the objective function. May be &ldquo;Nelder-Mead&rdquo;, &ldquo;BFGS&rdquo;,
&ldquo;CG&rdquo;, &ldquo;L-BFGS-B&rdquo;, &ldquo;SANN&rdquo; or &ldquo;Brent&rdquo;. Can be abbreviated.
Default is &ldquo;BFGS&rdquo;.</p>
</td></tr>
<tr><td><code id="ann_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations used by <code><a href="stats.html#topic+optim">optim</a></code>.
Default value is 1000.</p>
</td></tr>
<tr><td><code id="ann_+3A_abstol">abstol</code></td>
<td>
<p>absolute convergence tolerance (stopping criterion)
used by <code><a href="stats.html#topic+optim">optim</a></code>. Default is <code>1e-4</code>.</p>
</td></tr>
<tr><td><code id="ann_+3A_reltol">reltol</code></td>
<td>
<p>relative convergence tolerance (stopping criterion)
used by <code><a href="stats.html#topic+optim">optim</a></code>. Optimization stops if the value
returned by <code>objfn</code> cannot be reduced by a factor of
<code>reltol * (abs(val) + reltol)</code> at a step. Default is <code>1e-8</code>.</p>
</td></tr>
<tr><td><code id="ann_+3A_trace">trace</code></td>
<td>
<p>logical. Should optimization be traced?
Default = TRUE.</p>
</td></tr>
<tr><td><code id="ann_+3A_...">...</code></td>
<td>
<p>arguments to be passed to user-defined <code>objfn</code>. Initial
values of any parameters (in addition to the ANN weights) requiring
optimization must be supplied in argument <code>par_of</code> (see AR(1) case
in &lsquo;Examples&rsquo;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &ldquo;linear&rdquo; activation, or transfer, function is the
identity function where the output of a node is equal to its input
<code class="reqn">f(x) = x</code>.
</p>
<p>The &ldquo;sigmoid&rdquo; function is the standard logistic sigmoid function given
by <code class="reqn">f(x) = \frac{1}{1+e^{-x}}</code>.
</p>
<p>The &ldquo;tanh&rdquo; function is the hyperbolic tangent function given by
<code class="reqn">f(x) = \frac{e^{x}-e^{-x}}{e^{x}+e^{-x}}</code>
</p>
<p>The &ldquo;exp&rdquo; function is the exponential function given by
<code class="reqn">f(x) = e^{x}</code>
</p>
<p>The default configuration of activation functions is
<code>act_hid = "tanh"</code> and <code>act_out = "linear"</code>.
</p>
<p>Optimization (minimization) of the objective function (<code>objfn</code>) is
performed by <code><a href="stats.html#topic+optim">optim</a></code> using the method specified.
</p>
<p>Derivatives returned are first-order partial derivatives of the hidden and
output nodes with respect to their inputs. These may be useful for
sensitivity analyses.
</p>


<h3>Value</h3>

<p>object of class &lsquo;ann&rsquo; with components describing the ANN structure
and the following output components:
</p>
<table>
<tr><td><code>wts</code></td>
<td>
<p>best set of weights found.</p>
</td></tr>
<tr><td><code>par_of</code></td>
<td>
<p>best values of additional <code>objfn</code> parameters. This
component will only be returned if a user-defined <code>objfn</code> is supplied
and argument <code>par_of</code> is included in the function call (see AR(1)
case in &lsquo;Examples&rsquo;).</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>value of objective function.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>fitted values for the training data.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>residuals for the training data.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>integer code returned by <code><a href="stats.html#topic+optim">optim</a></code>.
0 indicates successful completion, see <code><a href="stats.html#topic+optim">optim</a></code> for
possible error codes.</p>
</td></tr>
<tr><td><code>derivs</code></td>
<td>
<p>matrix of derivatives of hidden (columns <code>1:size</code>)
and output (final column) nodes.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+predict.ann">predict.ann</a></code>, <code><a href="#topic+validann">validann</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## fit 1-hidden node ann model with tanh activation at the hidden layer and
## linear activation at the output layer.
## Use 200 random samples from ar9 dataset.
## ---
data("ar9")
samp &lt;- sample(1:1000, 200)
y &lt;- ar9[samp, ncol(ar9)]
x &lt;- ar9[samp, -ncol(ar9)]
x &lt;- x[, c(1,4,9)]
fit &lt;- ann(x, y, size = 1, act_hid = "tanh", act_out = "linear", rang = 0.1)

## fit 3-hidden node ann model to ar9 data with user-defined AR(1) objective
## function
## ---
ar1_sse &lt;- function(y, y_hat, par_of) {
  err &lt;- y - y_hat
  err[-1] &lt;- err[-1] - par_of * err[-length(y)]
  sum(err ^ 2)
}
fit &lt;- ann(x, y, size = 3, act_hid = "tanh", act_out = "linear", rang = 0.1,
           objfn = ar1_sse, par_of = 0.7)

</code></pre>

<hr>
<h2 id='ar9'>Data generated by autoregressive AR9 model.</h2><span id='topic+ar9'></span>

<h3>Description</h3>

<p>Synthetically generated dataset containing values of dependent variable
<code>x_t</code> given values of <br />
<code>x_t-1, x_t-2, ..., x_t-15</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ar9
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 rows and 16 variables:
</p>

<dl>
<dt>x_t-1,x_t-2,x_t-3,x_t-4,x_t-5,x_t-6,x_t-7,x_t-8,x_t-9,x_t-10,x_t-11,x_t-12,</dt><dd></dd>
<dt>x_t-13,x_t-14,x_t-15</dt><dd><p>lagged values of
x_t in columns 1:15</p>
</dd>
<dt>x_t</dt><dd><p>dependent variable in column 16</p>
</dd>
</dl>


<h3>Details</h3>

<p>This dataset was generated using the AR9 model first described in
Sharma (2000) and given by:
</p>
<p><code class="reqn">x_{t}	= 0.3x_{t-1} - 0.6x_{t-4} - 0.5x_{t-9} + \epsilon_{t}</code>
</p>
<p>where <code class="reqn">\epsilon_{t}</code>
</p>


<h3>References</h3>

<p>Sharma, A. (2000), Seasonal to interannual rainfall
probabilistic forecasts for improved water supply management: Part 1 -
a strategy for system predictor identification, Journal of Hydrology,
239(1-4), 232-239, <a href="http://dx.doi.org/10.1016/S0022-1694(00)00346-2">http://dx.doi.org/10.1016/S0022-1694(00)00346-2</a>.
</p>

<hr>
<h2 id='observed'>Return observed target values.</h2><span id='topic+observed'></span>

<h3>Description</h3>

<p>Return observed target values used for fitting &lsquo;ann&rsquo; or &lsquo;nnet&rsquo; ANN models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observed(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="observed_+3A_object">object</code></td>
<td>
<p>an object of class &lsquo;ann&rsquo; as returned by <code><a href="#topic+ann">ann</a></code> or
of class &lsquo;nnet&rsquo; as returned by <code><a href="nnet.html#topic+nnet">nnet</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be invoked by calling <code>observed(x)</code> for an
object <code>x</code> of class &lsquo;ann&rsquo; or &lsquo;nnet&rsquo;.
</p>


<h3>Value</h3>

<p>a 1-column matrix of observed target values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Get observed values of y used to train ann object `fit'.
# ---
data("ar9")
samp &lt;- sample(1:1000, 200)
y &lt;- ar9[samp, ncol(ar9)]
x &lt;- ar9[samp, -ncol(ar9)]
x &lt;- x[, c(1,4,9)]
fit &lt;- ann(x, y, size = 1, act_hid = "tanh", act_out = "linear", rang = 0.1)
y_obs &lt;- observed(fit)
</code></pre>

<hr>
<h2 id='plot.validann'>Plot ANN validation results.</h2><span id='topic+plot.validann'></span>

<h3>Description</h3>

<p>Plot method for objects of class &lsquo;validann&rsquo;. Produces a series
of plots used for validating and assessing ANN models based on results
returned by <code><a href="#topic+validann">validann</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'validann'
plot(x, obs, sim, gof = TRUE, resid = TRUE, sa = TRUE,
  display = c("multi", "single"), profile = c("all", "median"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.validann_+3A_x">x</code></td>
<td>
<p>object of class &lsquo;validann&rsquo; as returned
by <code><a href="#topic+validann">validann</a></code>. This is a list comprising metrics and
statistics that can be used for validating ANN models.</p>
</td></tr>
<tr><td><code id="plot.validann_+3A_obs">obs</code>, <code id="plot.validann_+3A_sim">sim</code></td>
<td>
<p>vectors comprising observed (<code>obs</code>) and simulated
(<code>sim</code>) examples of a single response variable used for computing
<code>x</code> object.</p>
</td></tr>
<tr><td><code id="plot.validann_+3A_gof">gof</code></td>
<td>
<p>logical; should goodness-of-fit plots be produced?
Default = TRUE.</p>
</td></tr>
<tr><td><code id="plot.validann_+3A_resid">resid</code></td>
<td>
<p>logical; should residual analysis plots be produced?
Default = TRUE.</p>
</td></tr>
<tr><td><code id="plot.validann_+3A_sa">sa</code></td>
<td>
<p>logical; should input sensitivity analysis plots be
produced? Default = TRUE.</p>
</td></tr>
<tr><td><code id="plot.validann_+3A_display">display</code></td>
<td>
<p>character string defining how plots should be
displayed. The default is &ldquo;multi&rdquo; where multiple plots are displayed
together according to whether they are goodness-of-fit, residual analysis
or sensitivity analysis plots. For &ldquo;single&rdquo;, each plot is displayed on
its own. If the session is interactive, the user will be asked to confirm
a new page whether <code>display</code> is &ldquo;single&rdquo; or &ldquo;multi&rdquo;.</p>
</td></tr>
<tr><td><code id="plot.validann_+3A_profile">profile</code></td>
<td>
<p>character string defining which structural
validity Profile method outputs should be plotted. The default is &ldquo;all&rdquo;
where outputs corresponding to 5 summary statistics are plotted together
with the median predicted response for each input value.
For &ldquo;median&rdquo;, only the median response is plotted.</p>
</td></tr>
<tr><td><code id="plot.validann_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to plot (not currently used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be invoked by calling
<code>plot(x, obs, sim)</code> for an object <code>x</code> of class
&lsquo;validann&rsquo;.
</p>
<p>To produce plots for all types of validation metrics and statistics,
<code>gof</code>, <code>resid</code> and <code>sa</code> must be
<code>TRUE</code> and corresponding results must have been successfully
computed by <code><a href="#topic+validann">validann</a></code> and returned in object <code>x</code>.
</p>
<p>If <code>gof</code> is <code>TRUE</code>, a scatter plot, Q-Q plot and
time/sample plot of observed (<code>obs</code>) versus predicted (<code>sim</code>)
data are produced.
</p>
<p>If <code>resid</code> is <code>TRUE</code> and <code>x$residuals</code>
is not <code>NULL</code>, plots of the model residuals are produced including
histogram, Q-Q plot (standardized residuals compared to standard normal),
autocorrelation (acf), partial autocorrelation (pacf), standardized
residual versus predicted output (i.e. <code>sim</code>) and standardized
residual versus time/order of the data.
</p>
<p>If <code>sa</code> is <code>TRUE</code> and <code>x$y_hat</code> is not
<code>NULL</code>, model response values resulting from the Profile
sensitivity analysis are plotted against percentiles of each
input. If <code>x$rs</code> is not <code>NULL</code>, the relative sensitivities of
each input, as computed by the partial derivative (PaD) sensitivity
analysis, are plotted against predicted output.
</p>
<p>Setting <code>gof</code>, <code>resid</code> and/or <code>sa</code> to <code>FALSE</code>
will &lsquo;turn off&rsquo; the respective validation plots.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+validann">validann</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Build ANN model and compute replicative and structural validation results
data("ar9")
samp &lt;- sample(1:1000, 200)
y &lt;- ar9[samp, ncol(ar9)]
x &lt;- ar9[samp, -ncol(ar9)]
x &lt;- x[, c(1,4,9)]
fit &lt;- ann(x, y, size = 1, act_hid = "tanh", act_out = "linear", rang = 0.1)
results &lt;- validann(fit, x = x)
obs &lt;- observed(fit)
sim &lt;- fitted(fit)

## Plot replicative and structural validation results to the current device
## - a single page for each type of validation
plot(results, obs, sim)

## Plot results to the current device - a single page for each plot
plot(results, obs, sim, display = "single")

## Plot replicative and structural validation results to single file
pdf("RepStructValidationPlots.pdf")
plot(results, obs, sim)
dev.off()

## Get predictive validation results for above model based on a new sample
## of ar9 data.
samp &lt;- sample(1:1000, 200)
y &lt;- ar9[samp, ncol(ar9)]
x &lt;- ar9[samp, -ncol(ar9)]
x &lt;- x[, c(1,4,9)]
obs &lt;- y
sim &lt;- predict(fit, newdata = x)
results &lt;- validann(fit, obs = obs, sim = sim, x = x)

## Plot predictive results only to file
pdf("PredValidationPlots.pdf")
plot(results, obs, sim, resid = FALSE, sa = FALSE)
dev.off()

</code></pre>

<hr>
<h2 id='predict.ann'>Predict new examples using a trained neural network.</h2><span id='topic+predict.ann'></span>

<h3>Description</h3>

<p>Predict new examples using a trained neural network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ann'
predict(object, newdata = NULL, derivs = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.ann_+3A_object">object</code></td>
<td>
<p>an object of class &lsquo;ann&rsquo; as returned by function <code>ann</code>.</p>
</td></tr>
<tr><td><code id="predict.ann_+3A_newdata">newdata</code></td>
<td>
<p>matrix, data frame or vector of input data.
A vector is considered to comprise examples of a single input or
predictor variable. If <code>x</code> is <code>NULL</code>, fitted outputs derived
from <code>object</code> will be returned.</p>
</td></tr>
<tr><td><code id="predict.ann_+3A_derivs">derivs</code></td>
<td>
<p>logical; should derivatives of hidden and output nodes be
returned? Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predict.ann_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the predictions produced (not
currently used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a method for the generic function <code>predict()</code>
for class &lsquo;ann&rsquo;. It can be invoked by calling <code>predict(x)</code> for an
object <code>x</code> of class &lsquo;ann&rsquo;.
</p>
<p><code>predict.ann</code> produces predicted values, obtained by evaluating the
&lsquo;ann&rsquo; model given <code>newdata</code>, which contains the inputs to be used
for prediction. If <code>newdata</code> is omitted, the
predictions are based on the data used for the fit.
</p>
<p>Derivatives may be returned for sensitivity analyses, for example.
</p>


<h3>Value</h3>

<p>if <code>derivs = FALSE</code>, a vector of predictions is returned.
</p>
<p>Otherwise, a list with the following components is returned:
</p>
<table>
<tr><td><code>values</code></td>
<td>
<p>matrix of values returned by the trained ANN.</p>
</td></tr>
<tr><td><code>derivs</code></td>
<td>
<p>matrix of derivatives of hidden (columns <code>1:object$size</code>)
and output (final column) nodes.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+ann">ann</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## fit 1-hidden node `ann' model to ar9 data
data("ar9")
samp &lt;- sample(1:1000, 200)
y &lt;- ar9[samp, ncol(ar9)]
x &lt;- ar9[samp, -ncol(ar9)]
x &lt;- x[, c(1,4,9)]

fit &lt;- ann(x, y, size = 1, act_hid = "tanh", act_out = "linear", rang = 0.1)

## get model predictions based on a new sample of ar9 data.
samp &lt;- sample(1:1000, 200)
y &lt;- ar9[samp, ncol(ar9)]
x &lt;- ar9[samp, -ncol(ar9)]
x &lt;- x[, c(1,4,9)]

sim &lt;- predict(fit, newdata = x)

## if derivatives are required...
tmp &lt;- predict(fit, newdata = x, derivs = TRUE)
sim &lt;- tmp$values
derivs &lt;- tmp$derivs
</code></pre>

<hr>
<h2 id='validann'>Validate Artificial Neural Networks.</h2><span id='topic+validann'></span><span id='topic+validann.ann'></span><span id='topic+validann.default'></span><span id='topic+validann.nnet'></span>

<h3>Description</h3>

<p>Compute metrics and statistics for predictive, replicative
and/or structural validation of artificial neural networks (ANNs).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validann(...)

## S3 method for class 'ann'
validann(net, obs = NULL, sim = NULL, x = NULL,
  na.rm = TRUE, ...)

## S3 method for class 'nnet'
validann(net, obs = NULL, sim = NULL, x = NULL,
  na.rm = TRUE, ...)

## Default S3 method:
validann(obs, sim, wts = NULL, nodes = NULL,
  na.rm = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validann_+3A_net">net</code></td>
<td>
<p>an object of class &lsquo;ann&rsquo; (as returned by function
<code><a href="#topic+ann">ann</a></code>) or &lsquo;nnet&rsquo; (as returned using <code><a href="nnet.html#topic+nnet">nnet</a></code>).
This is a list object comprising information about the fitted ANN model,
including values of weights, fitted target values, number of layers and
numbers of nodes in each layer, for example.</p>
</td></tr>
<tr><td><code id="validann_+3A_obs">obs</code>, <code id="validann_+3A_sim">sim</code></td>
<td>
<p>vectors comprising observed (<code>obs</code>) and simulated
(<code>sim</code>) examples of a single response variable. These vectors are
used to compute model fit statistics. Optional if <code>net</code> is supplied
(see &lsquo;Details&rsquo;).</p>
</td></tr>
<tr><td><code id="validann_+3A_x">x</code></td>
<td>
<p>matrix, data frame or vector of input data used for
fitting <code>net</code> object. A vector is considered to comprise examples of
a single input or predictor variable. While <code>x</code> is optional,
sensitivity analyses useful for structural validation cannot be performed
if it is not supplied.</p>
</td></tr>
<tr><td><code id="validann_+3A_na.rm">na.rm</code></td>
<td>
<p>logical; should missing values (including NaN)
be removed from calculations? Default = TRUE.</p>
</td></tr>
<tr><td><code id="validann_+3A_wts">wts</code></td>
<td>
<p>vector of ANN weights used to compute input
&lsquo;relative importance&rsquo; measures if <code>net</code> object is not supplied. Must
be supplied together with <code>nodes</code> in order to compute such metrics.
See &lsquo;Details&rsquo; for ordering of <code>wts</code> vector.</p>
</td></tr>
<tr><td><code id="validann_+3A_nodes">nodes</code></td>
<td>
<p>vector indicating the number of nodes in each layer
of the ANN model. This vector should have 3 elements: nodes in input
layer, nodes in hidden layer (can be 0), and nodes in output layer.
If <code>net</code> object is not supplied, <code>nodes</code> must be supplied
together with <code>wts</code> if any structural validation metrics are to be
computed.</p>
</td></tr>
<tr><td><code id="validann_+3A_...">...</code></td>
<td>
<p>arguments to be passed to different validann methods,
see specific formulations for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To compute all possible validation metrics and statistics,
<code>net</code> must be supplied and must be of class &lsquo;ann&rsquo; (as returned by
<code><a href="#topic+ann">ann</a></code>) or &lsquo;nnet&rsquo; (as returned by <code><a href="nnet.html#topic+nnet">nnet</a></code>).
However, a partial derivative (PaD) sensitivity analysis (useful for
structural validation) will only be carried out if <code>net</code> is of class
&lsquo;ann&rsquo;.
</p>
<p>If <code>obs</code> and <code>sim</code> data are supplied in addition to <code>net</code>,
validation metrics are computed based on these. Otherwise, metrics and
statistics are computed based on <code>obs</code> and <code>sim</code> datasets
derived from the <code>net</code> object (i.e. the data used to fit <code>net</code>
and the fitted values). As such, both <code>obs</code> and <code>sim</code> must be
supplied if validation is to be based either on data not used for
training or on unprocessed training data (if training data were
preprocessed). If either <code>obs</code> or <code>sim</code> is specified but the
other isn't, both <code>obs</code> and <code>sim</code> will be derived from
<code>net</code> if supplied (and a warning will be given). Similarly, this
will occur if <code>obs</code> and <code>sim</code> are of different lengths.
</p>
<p>If <code>net</code> is not supplied, both <code>obs</code> and <code>sim</code> are
required. This may be necessary if validating an ANN model not built
using either the <code><a href="nnet.html#topic+nnet">nnet</a></code> or <code><a href="#topic+ann">ann</a></code> functions.
In this case, both <code>wts</code> and <code>nodes</code> are also required if any
structural validation metrics are to be returned. If an ANN model has
<em>K</em> input nodes, <em>J</em> hidden nodes and a single output <em>O</em>,
with a bias node for both the hidden and output layers, the <code>wts</code> vector must be ordered
as follows:
</p>
<p><code>c(Wi1h1,Wi1h2,...Wi1hJ,Wi2h1,...Wi2hJ,...,WiKh1,...,WiKhJ,Wi0h1,...,Wi0hJ,</code><br />
<code>  Wh1O,...,WhJO,Wh0O)</code>
</p>
<p>where <code>Wikhj</code> is the weight between the <em>k</em>th input and the
<em>j</em>th hidden node and <code>WhjO</code> is the weight between the
<em>j</em>th hidden node and the output. The bias weight on the <em>j</em>th
hidden layer node is labelled <code>Wi0hj</code> while the bias weight on the
output is labelled <code>Wh0O</code>. The <code>wts</code> vector assumes the network
is fully connected; however, missing connections may be substituted by
zero weights. Skip-layer connections are not allowed.
</p>


<h3>Value</h3>

<p>list object of class &lsquo;validann&rsquo; with components dependent on
arguments passed to <code>validann</code> function:
</p>
<table>
<tr><td><code>metrics</code></td>
<td>
<p>a data frame consisting of metrics:
</p>
<p>AME, PDIFF, MAE, ME, RMSE, R4MS4E, AIC, BIC, NSC, RAE, PEP, MARE,
MdAPE, MRE, MSRE, RVE, RSqr, IoAd, CE, PI, MSLE, MSDE, IRMSE, VE,
KGE, SSE and R.
</p>
<p>See Dawson et al. (2007) for definitions.</p>
</td></tr>
<tr><td><code>obs_stats</code></td>
<td>
<p>a data frame consisting of summary statistics about the
<code>obs</code> dataset including mean, minimum, maximum, variance,
standard deviation, skewness and kurtosis.</p>
</td></tr>
<tr><td><code>sim_stats</code></td>
<td>
<p>a data frame consisting of summary statistics about the
<code>sim</code> dataset including mean, minimum, maximum, variance,
standard deviation, skewness and kurtosis.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>a 1-column matrix of model residuals (<code>sim - obs</code>).</p>
</td></tr>
<tr><td><code>resid_stats</code></td>
<td>
<p>a data frame consisting of summary statistics about the
model <code>residuals</code> including mean, minimum, maximum, variance,
standard deviation, skewness and kurtosis.</p>
</td></tr>
<tr><td><code>ri</code></td>
<td>
<p>a data frame consisting of &lsquo;relative importance&rsquo; values for each
input. Only returned if <code>net</code> or <code>wts</code> and <code>nodes</code> are
supplied.
</p>
<p>If <code>net</code> is supplied, relative importance values computed using the
following 4 methods are returned:
</p>
<p>Garson's (Garson); connection weight (CW); Profile sensitivity
analysis (Profile); and partial derivative sensitivity analysis (PaD).
</p>
<p>In addition, if <code>net</code> is of class &lsquo;ann&rsquo; (as returned by function
<code><a href="#topic+ann">ann</a></code>) and the activation function used at the hidden
layer (<code>act_hid</code>) is &quot;tanh&quot;, relative importance
values computed using the modified CW (MCW) are also returned.
This method requires that the hidden layer activation function be
symmetric about the origin.
</p>
<p>If <code>wts</code> and <code>nodes</code> are supplied, only relative importance
values computed using the Garson and CW methods are returned.
</p>
<p>See Gevrey et al. (2003), Olden et al. (2004) and Kingston et al. (2006)
for details of the relative importance methods.</p>
</td></tr>
<tr><td><code>y_hat</code></td>
<td>
<p>a matrix of dimension <code>c(101, ncol(x) * 6)</code> of model
response values indicating the local sensitivity of the model to each
input in <code>x</code>. Only returned if <code>net</code> and <code>x</code> are supplied.
</p>
<p>The response values returned in <code>y_hat</code> are calculated using the
&lsquo;Profile&rsquo; sensitivity analysis method described in Gevrey et al. (2003).
Using this method, the local sensitivity of each input in <code>x</code> is
considered successively. For each input <code>x[,i]</code>, 5 synthetic data
sets are generated where inputs <code>x[,-i]</code> are successively fixed at
their minimum, 1st quartile, median, 3rd quartile and maximum values
(as calculated from <code>x</code>), while input <code>x[,i]</code> is varied between
its minimum and maximum value, increasing in increments of 1% (giving
101 synthetic values of <code>x[,i]</code> for each of the 5 sets of fixed
<code>x[,-i]</code>). These data are input into <code>net</code> and model response
values corresponding to the 5 summary statistics are computed.
These 5 sets of response values, together with a set of computed median
responses, are returned as y_hat[,(i - 1) * 6 + 1:6]. This process is
repeated for each input variable in <code>x</code>. See Gevrey et al. (2003)
for further details.</p>
</td></tr>
<tr><td><code>as</code></td>
<td>
<p>a matrix of dimension <code>dim(x)</code> of &lsquo;absolute sensitivity&rsquo;
values for each input in <code>x</code> given the model output values
(i.e. <code>sim</code>). Only returned if <code>net</code> and <code>x</code> are
supplied and <code>net</code> is of class &lsquo;ann&rsquo;.
</p>
<p>The values in <code>as</code> are calculated according to the partial
derivative (PaD) sensitivity analysis method described in Gevrey et al.
(2003), which involves computing the first-order partial derivatives of
the ANN output with respect to each input. <code>net</code> must be of class
&lsquo;ann&rsquo; in order to access partial derivatives of the hidden layer nodes as
returned by <code><a href="#topic+ann">ann</a></code>.</p>
</td></tr>
<tr><td><code>rs</code></td>
<td>
<p>a matrix of dimension <code>dim(x)</code> of &lsquo;relative sensitivity&rsquo;
values for each input in <code>x</code> given the model output values
(i.e. <code>sim</code>). Only returned if <code>net</code> and <code>x</code> are
supplied and <code>net</code> is of class &lsquo;ann&rsquo;.
</p>
<p>To compute the values in <code>rs</code>, the <code>as</code> values are normalised
by multiplying by <code>x[,i]</code>/<code>sim</code> as described in Mount et al.
(2013). As for <code>as</code>, <code>net</code> must be of class
&lsquo;ann&rsquo; in order to access partial derivatives of the hidden layer nodes as
returned by <code><a href="#topic+ann">ann</a></code>.</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>ann</code>: Compute validation metrics when <code>net</code>
is of class &lsquo;ann&rsquo;.
</p>
</li>
<li> <p><code>nnet</code>: Compute validation metrics when <code>net</code>
is of class &lsquo;nnet&rsquo;.
</p>
</li>
<li> <p><code>default</code>: Useful for predictive validation only or when ANN model
has not been developed using either <code><a href="#topic+ann">ann</a></code> or
<code><a href="nnet.html#topic+nnet">nnet</a></code>. Limited structural validation metrics may be
computed and only if <code>wts</code> and <code>nodes</code> are supplied.
</p>
</li></ul>


<h3>References</h3>

<p>Dawson, C.W., Abrahart, R.J., See, L.M., 2007. HydroTest: A web-based
toolbox of evaluation metrics for the standardised assessment of
hydrological forecasts. Environmental Modelling &amp; Software, 22(7),
1034-1052. <a href="http://dx.doi.org/10.1016/j.envsoft.2006.06.008">http://dx.doi.org/10.1016/j.envsoft.2006.06.008</a>.
</p>
<p>Olden, J.D., Joy, M.K., Death, R.G., 2004. An accurate comparison of
methods for quantifying variable importance in artificial neural networks
using simulated data. Ecological Modelling 178, 389-397.
<a href="http://dx.doi.org/10.1016/j.ecolmodel.2004.03.013">http://dx.doi.org/10.1016/j.ecolmodel.2004.03.013</a>.
</p>
<p>Gevrey, M., Dimopoulos, I., Lek, S., 2003. Review and comparison of methods
to study the contribution of variables in artificial neural network
models. Ecological Modelling 160, 249-264.
<a href="http://dx.doi.org/10.1016/S0304-3800(02)00257-0">http://dx.doi.org/10.1016/S0304-3800(02)00257-0</a>.
</p>
<p>Kingston, G.B., Maier, H.R., Lambert, M.F., 2006. Forecasting cyanobacteria
with Bayesian and deterministic artificial neural networks, in: IJCNN '06.
International Joint Conference on Neural Networks, 2006., IEEE.
pp. 4870-4877. <a href="http://dx.doi.org/10.1109/ijcnn.2006.247166">http://dx.doi.org/10.1109/ijcnn.2006.247166</a>.
</p>
<p>Mount, N.J., Dawson, C.W., Abrahart, R.J., 2013. Legitimising
data-driven models: exemplification of a new data-driven mechanistic
modelling framework. Hydrology and Earth System Sciences 17, 2827-2843.
<a href="http://dx.doi.org/10.5194/hess-17-2827-2013">http://dx.doi.org/10.5194/hess-17-2827-2013</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ann">ann</a></code>, <code><a href="#topic+plot.validann">plot.validann</a></code>,
<code><a href="#topic+predict.ann">predict.ann</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get validation results for 1-hidden node `ann' model fitted to ar9 data
# based on training data.
# ---
data("ar9")
samp &lt;- sample(1:1000, 200)
y &lt;- ar9[samp, ncol(ar9)]
x &lt;- ar9[samp, -ncol(ar9)]
x &lt;- x[, c(1,4,9)]

fit &lt;- ann(x, y, size = 1, act_hid = "tanh", act_out = "linear", rang = 0.1)
results &lt;- validann(fit, x = x)

# get validation results for above model based on a new sample of ar9 data.
# ---
samp &lt;- sample(1:1000, 200)
y &lt;- ar9[samp, ncol(ar9)]
x &lt;- ar9[samp, -ncol(ar9)]
x &lt;- x[, c(1,4,9)]

obs &lt;- y
sim &lt;- predict(fit, newdata = x)
results &lt;- validann(fit, obs = obs, sim = sim, x = x)

# get validation results for `obs' and `sim' data without ANN model.
# In this example `sim' is generated using a linear model. No structural
# validation of the model is possible, but `wts' are provided to compute the
# number of model parameters needed for the calculation of certain
# goodness-of-fit metrics.
# ---
samp &lt;- sample(1:1000, 200)
y &lt;- ar9[samp, ncol(ar9)]
x &lt;- ar9[samp, -ncol(ar9)]
x &lt;- as.matrix(x[, c(1,4,9)])
lmfit &lt;- lm.fit(x, y)
sim &lt;- lmfit$fitted.values
obs &lt;- y
results &lt;- validann(obs = obs, sim = sim, wts = lmfit$coefficients)

# validann would be called in the same way if the ANN model used to generate
# `sim' was not available or was not of class `ann' or `nnet'. Ideally in
# this case, however, both `wts' and `nodes' should be supplied such that
# some structural validation metrics may be computed.
# ---
obs &lt;- c(0.257, -0.891, -1.710, -0.575, -1.668, 0.851, -0.350, -1.313,
         -2.469, 0.486)
sim &lt;- c(-1.463, 0.027, -2.053, -1.091, -1.602, 2.018, 0.723, -0.776,
         -2.351, 1.054)
wts &lt;- c(-0.05217, 0.08363, 0.07840, -0.00753, -7.35675, -0.00066)
nodes &lt;- c(3, 1, 1)
results &lt;- validann(obs = obs, sim = sim, wts = wts, nodes = nodes)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
