<!DOCTYPE html><html lang="en"><head><title>Help for package TimeDepFrail</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TimeDepFrail}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AdPaik_1D'><p>One-dimensional analysis of log-likelihood function</p></a></li>
<li><a href='#AdPaikModel'><p>Adapted Paik et al.'s Model: Time-Dependent Shared Frailty Cox Model</p></a></li>
<li><a href='#bas_hazard'><p>Baseline hazard step-function</p></a></li>
<li><a href='#check.C_mult'><p>Check positiveness of the multiplicative constant C</p></a></li>
<li><a href='#check.categories_params'><p>Check correctness of parameters categories</p></a></li>
<li><a href='#check.centre'><p>Check correctness for the cluster variable</p></a></li>
<li><a href='#check.dataset'><p>Check presence of null or nan element value in the dataset</p></a></li>
<li><a href='#check.flag_optimal_params'><p>Check coherence between flag for optimal parameters and optimal parameters</p></a></li>
<li><a href='#check.formula_terms'><p>Check correctness of formula terms</p></a></li>
<li><a href='#check.frailty_dispersion'><p>Check correctness of frailty standard deviation</p></a></li>
<li><a href='#check.index'><p>Check existence of provided input index</p></a></li>
<li><a href='#check.pchtype_colorbg'><p>Check correctness of plot variables pch and color</p></a></li>
<li><a href='#check.pos_frailty_sd'><p>Check positiviness of the frailty standard deviation</p></a></li>
<li><a href='#check.poslegend'><p>Check correctness of legend position</p></a></li>
<li><a href='#check.post_frailty_centre'><p>Check numerosity of posterior frailty estimates</p></a></li>
<li><a href='#check.range_params'><p>Check correctness of input parameters</p></a></li>
<li><a href='#check.result'><p>Internal function to check the structure of the model output</p></a></li>
<li><a href='#check.result.AdPaik'><p>Check structure of the 'AdPaikModel' output</p></a></li>
<li><a href='#check.structure_paramsCI'><p>Check structure for the Parameters Confidence Interval</p></a></li>
<li><a href='#check.structure_post_frailty_CI'><p>Check structure of Posterior Frailty Confidence Interval</p></a></li>
<li><a href='#check.structure_post_frailty_est'><p>Check structure of Posterior Frailty Estimates</p></a></li>
<li><a href='#check.structure_post_frailty_var'><p>Check structure of Posterior Frailty Variances</p></a></li>
<li><a href='#check.time_axis'><p>Check correctness of time domain subdivision</p></a></li>
<li><a href='#check.value_post_frailty'><p>Check non-negativeness of the posterior frailty estimates</p></a></li>
<li><a href='#coef.AdPaik'><p>Extracts the optimal parameters of each cateogry for the 'Adapted Paik et al.' Model</p></a></li>
<li><a href='#coefse'><p>Extracts the standard errors computed for each cateogry for the 'Adapted Paik et al.' Model</p></a></li>
<li><a href='#confint.AdPaik'><p>Extracts the confidence intervals computed for each cateogry for the 'Adapted Paik et al.' Model</p></a></li>
<li><a href='#data_dropout'><p>Data Dropout Dataset</p></a></li>
<li><a href='#extract_dummy_variables'><p>Transform categorical covariate into dummy variables</p></a></li>
<li><a href='#extract_event_data'><p>Extracting variables for Posterior Frailty Estimates computation</p></a></li>
<li><a href='#frailty_sd'><p>Frailty standard deviation and Variance for the 'Adapted Paik et al.'s Model'</p></a></li>
<li><a href='#frailty_sd.AdPaik'><p>Frailty standard deviation and Variance for the 'Adapted Paik et al.'s Model'</p></a></li>
<li><a href='#ll_AdPaik_1D'><p>One-dimensional log-likelihood function to be optimized.</p></a></li>
<li><a href='#ll_AdPaik_centre_1D'><p>One-dimensional group log-likelihood function.</p></a></li>
<li><a href='#ll_AdPaik_centre_eval'><p>Evaluation of model group log-likelihood</p></a></li>
<li><a href='#ll_AdPaik_eval'><p>Evaluation of model log-likelihood</p></a></li>
<li><a href='#n_nodes'><p>Nodes and weights for the Gauss_hermite quadrature formula</p>
for the 'Centre-Specific Frailty Model with Power Parameter'.
The nodes and weights have been extracted from the 'Handbook of Mathematical functions'
pag 940.</a></li>
<li><a href='#n_nodesG'><p>Nodes and weights for the Gauss-Hermite quadrature formula,</p>
for the 'Stochastic Time-Dependent Centre-Specific Frailty Model'.
For the G function, the chosen nodes should not contain the zero (node)
since it appears at the denominator of a fraction.
Also in this case, the nodes and weights have been extracted from the
'Handbook of Mathematical functions', pag 940.</a></li>
<li><a href='#params_CI'><p>Confidence interval for the optimal estimated parameters</p></a></li>
<li><a href='#params_se.AdPaik'><p>Standard error of the parameters</p></a></li>
<li><a href='#plot_bas_hazard'><p>Plot the Baseline Hazard Step-Function</p></a></li>
<li><a href='#plot_frailty_sd'><p>Plot for the Frailty Standard Deviation or Variance</p></a></li>
<li><a href='#plot_ll_1D'><p>Plot the One-Dimensional Log-Likelihood Function</p></a></li>
<li><a href='#plot_ll_1D.AdPaik'><p>Plot the One-Dimensional Log-Likelihood Function</p></a></li>
<li><a href='#plot_post_frailty_est'><p>Plot the Posterior Frailty Estimates</p></a></li>
<li><a href='#plot_survival'><p>Plot of Conditional Survival Function</p></a></li>
<li><a href='#post_frailty_CI.AdPaik'><p>Confidence interval for posterior frailty estimates</p></a></li>
<li><a href='#post_frailty.AdPaik'><p>Posterior frailty estimates and variances for the 'Adapted Paik et al.'s Model'</p></a></li>
<li><a href='#summary'><p>Summary for Time-Dependent Frailty Models</p></a></li>
<li><a href='#summary.AdPaik'><p>Summary of the Adapted Paik et al.'s Time-Dependent Shared Frailty Model</p></a></li>
<li><a href='#survival'><p>Compute the Conditional Survival Function</p></a></li>
<li><a href='#time_int_eval'><p>Resolution of integral with respect to time</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Time Dependent Shared Frailty Cox Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits time-dependent shared frailty Cox model (specifically the adapted Paik et al.'s Model) based on the paper "Centre-Effect on Survival After Bone Marrow Transplantation: Application of Time-Dependent Frailty Models", by C.M. Wintrebert, H. Putter, A.H. Zwinderman and J.C. van Houwelingen (2004) &lt;<a href="https://doi.org/10.1002%2Fbimj.200310051">doi:10.1002/bimj.200310051</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://alessandragni.github.io/TimeDepFrail/">https://alessandragni.github.io/TimeDepFrail/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-17 19:50:19 UTC; alessandragni</td>
</tr>
<tr>
<td>Author:</td>
<td>Alessandra Ragni <a href="https://orcid.org/0000-0002-3647-7340"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Giulia Romani [aut],
  Chiara Masci <a href="https://orcid.org/0000-0002-9208-3194"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alessandra Ragni &lt;alessandra.ragni@polimi.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-17 20:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AdPaik_1D'>One-dimensional analysis of log-likelihood function</h2><span id='topic+AdPaik_1D'></span>

<h3>Description</h3>

<p>Function for studying the log-likelihood function from the point of view of a single parameter and, therefore,
in a single direction.
It performs both the optimization of the log-likelihood with respect to this parameter and the
evaluation of the log-likelihood in several samples of the same parameter, while the other parameters can assume a constant assigned value or
can vary in their range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AdPaik_1D(
  formula,
  data,
  time_axis,
  index_param_to_vary,
  flag_optimal_params = FALSE,
  optimal_params = NULL,
  categories_range_min,
  categories_range_max,
  n_iter = 5,
  tol_optimize = 1e-06,
  flag_plot = FALSE,
  n_points = 150,
  cex = 0.7,
  cex_max = 0.8,
  color_bg = "black",
  color_max_bg = "red",
  pch = 21
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AdPaik_1D_+3A_formula">formula</code></td>
<td>
<p>Formula object indicating the response variable, the covariates and the cluster variable.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_data">data</code></td>
<td>
<p>Dataset in which the variables of the formula object are located.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_time_axis">time_axis</code></td>
<td>
<p>Partitioned time-domain.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_index_param_to_vary">index_param_to_vary</code></td>
<td>
<p>Index of the parameter, in the parameter vector, with respect to which the log-likelihood function
is maximized in a one-dimensional way. The index s provided to identify the parameter under consideration inside the vector, avoiding
providing its name or value.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_flag_optimal_params">flag_optimal_params</code></td>
<td>
<p>Are the other parameters extracted from the optimal vector of parameters? If so, the flag should be equal to TRUE.
Otherwise, the flag is equal to FALSE.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_optimal_params">optimal_params</code></td>
<td>
<p>Vector of optimal parameters, determined through an entire multi-dimensional maximization
of the log-likelihood function. The default value (NULL) indicates that no vector is provided
and the parameters are randomly extracted in their range.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_categories_range_min">categories_range_min</code></td>
<td>
<p>Vector containing the minimum value assumed by each parameter category.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_categories_range_max">categories_range_max</code></td>
<td>
<p>Vector containing the maximum value assumed by each parameter category.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_n_iter">n_iter</code></td>
<td>
<p>Number of times the one-dimensional analysis with respect to the indicated parameter must be executed.
Default value is 5. See details for more information.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_tol_optimize">tol_optimize</code></td>
<td>
<p>Tolerance used in the optimize R function for the one-dimensional optimization
of the log-likelihood function.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_flag_plot">flag_plot</code></td>
<td>
<p>Logical value for plotting the trend of the log-likelihood function with respect to the parameter under consideration.
A plot for each iteration (n_iter) is reported. Defaults to FALSE.
Be careful that if the optimal parameters are provided, then the trend may be always the same and therefore it may be sufficient to
set n_iter = 1. On the other hand, if optimal parameters are not provided, then it is recommended to impose a higher n_iter.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_n_points">n_points</code></td>
<td>
<p>Number of internal points in which the log-likelihood function must be evaluated, to
plot it.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_cex">cex</code></td>
<td>
<p>Dimension of the points in the plot.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_cex_max">cex_max</code></td>
<td>
<p>Dimension of the optimal point in the plot.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_color_bg">color_bg</code></td>
<td>
<p>Color used in the plot for the points.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_color_max_bg">color_max_bg</code></td>
<td>
<p>Color used for the optimal point in the plot.</p>
</td></tr>
<tr><td><code id="AdPaik_1D_+3A_pch">pch</code></td>
<td>
<p>Shape to be used for the points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The one-dimensional analysis of the log-likelihood function can be performed in two ways, with two different aims and results:
</p>

<ul>
<li><p> Keeping fixed the other parameters (all the parameters in the vector, except for the one under consideration) to their optimal
value (flag_optimal_params = TRUE), determined through the multi-dimensional optimization. In this way, the optimized value of the parameter
coincides with the one get with the general and global approach and, therefore, there is no need to repeat this procedure several times (n_iter = 1).
However, this approach is really useful if we want to check the trend the log-likelihood function and to observe if it increases, decreases or
is constant.
</p>
</li>
<li><p> Letting the other parameters vary in their range (flag_optimal_params = FALSE). The optimized parameter value will always assume a different
value, because it depends on the value of the other parameters, and it is suggested to repeat the procedure several times (n_iter <code class="reqn">\geq</code> 5),
so that it is possible to identify a precise existence region for such parameter
</p>
</li></ul>



<h3>Value</h3>

<p>If the flag for the plot has been activated, the function returns both the plot of the one-dimensional log-likelihood function and
a class S3 object. Otherwise, only a S3 object of class 'AdPaik_1D'.
This class object is composed of:
</p>

<ul>
<li><p> numerical vector of length @n_iter containing the optimal estimated parameter.
</p>
</li>
<li><p> numerical vector of length @n_iter containing the associated one-dimensional optimized log-likelihood value
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Consider the 'Academic Dropout dataset'
data(data_dropout)
# Define the variables needed for the model execution
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
eps &lt;- 1e-10

# Identify a parameter existence range
categories_range_min &lt;- c(-8, -2, eps, eps, eps)
categories_range_max &lt;- c(-eps, 0.5, 1 - eps, 1, 10)
index_param_to_vary &lt;- 1
analysis_1D_opt &lt;- AdPaik_1D(formula, data_dropout,
                             time_axis, index_param_to_vary, 
                             flag_optimal_params = FALSE, 
                             optimal_params = NULL,
                             flag_plot = TRUE,
                             categories_range_min, categories_range_max, 
                             n_iter = 5)


# or Study the log-likelihood behaviour
categories_range_min &lt;- c(-8, -2, eps, eps, eps)
categories_range_max &lt;- c(-eps, 0.4, 1 - eps, 1, 10)
index_param_to_vary &lt;- 14
# Call the main model
result &lt;- AdPaikModel(formula, data_dropout, time_axis,
                      categories_range_min, categories_range_max, TRUE)
analysis_1D_opt &lt;- AdPaik_1D(formula, data_dropout, time_axis,
                             index_param_to_vary, flag_optimal_params = TRUE, 
                             flag_plot = TRUE, optimal_params = result$OptimalParameters,
                             categories_range_min, categories_range_max, n_iter = 1)

</code></pre>

<hr>
<h2 id='AdPaikModel'>Adapted Paik et al.'s Model: Time-Dependent Shared Frailty Cox Model</h2><span id='topic+AdPaikModel'></span>

<h3>Description</h3>

<p>Function for applying the 'Adapted Paik et al.'s Model', an innovative Cox Model with time-dependent frailty,
shared by individuals belonging to the same group/cluster.
</p>
<p>To generate time-dependence, the temporal domain must be divided into a certain number
of intervals. For more information about the time-domain, its relationship with the follow-up and its internal
subdivision refer to Details.
</p>
<p>The model log-likelihood function depends on a certain number of parameters and it is maximized with respect to all of them,
using a reinterpretation of the 'Powell's method in multidimension', that is a multi-dimensional optimization method based on
repeated one-dimensional optimization of the log-likelihood function (with respect to one parameter at the time).
In this context, the one-dimensional optimization is performed through the 'optimize' R function.
For more information about the unknown model parameters, their type and numerosity refer to Details.
</p>
<p>Several quantities are estimated at the end of the optimization phase:
</p>

<ul>
<li><p> parameters, their standard error and confidence interval;
</p>
</li>
<li><p> baseline hazard;
</p>
</li>
<li><p> frailty dispersion (standard deviation and variance);
</p>
</li>
<li><p> posterior frailty estimates, their variance and confidence interval;
</p>
</li>
<li><p> Akaike Information Criterion (AIC).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>AdPaikModel(
  formula,
  data,
  time_axis,
  categories_range_min,
  categories_range_max,
  flag_fullsd = TRUE,
  n_extrarun = 60,
  tol_ll = 1e-06,
  tol_optimize = 1e-06,
  h_dd = 0.001,
  print_previous_ll_values = c(TRUE, 3),
  level = 0.95,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AdPaikModel_+3A_formula">formula</code></td>
<td>
<p>Formula object having on the left hand side the @time_to_event variable, that is the time-instant in which
the individual failed. On the right hand side, it has the regressors and the cluster variable.</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_data">data</code></td>
<td>
<p>Dataset in which all variables of the formula object must be found and contained.
This dataset can also contain other variables, but they will not be considered.
It can be either a dataframe or a matrix, but in both cases the name of each column must correspond to the name of
the formula variables. It is not necessary to attach it (in case of a data.frame)</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_time_axis">time_axis</code></td>
<td>
<p>Temporal domain</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_categories_range_min">categories_range_min</code></td>
<td>
<p>Vector containing the minimum value assumable by each parameter category.</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_categories_range_max">categories_range_max</code></td>
<td>
<p>Vector containing the maximum value assumable by each parameter category.</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_flag_fullsd">flag_fullsd</code></td>
<td>
<p>Logical. If TRUE, the full frailty standard deviation is computed, otherwise the partial one that keeps into
account only the time-dependent component. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_n_extrarun">n_extrarun</code></td>
<td>
<p>Total number of runs (iterations) are obtained summing to the number of parameters and n_extrarun.</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_tol_ll">tol_ll</code></td>
<td>
<p>Tolerance on the log-likelihood value.</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_tol_optimize">tol_optimize</code></td>
<td>
<p>Internal tolerance for the one-dimensional optimization through 'optimize' R function.</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_h_dd">h_dd</code></td>
<td>
<p>Discretization step used for the numerical approximation of the second derivative of the log-likelihood function.</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_print_previous_ll_values">print_previous_ll_values</code></td>
<td>
<p>If we want to print the previous values of the log-likelihood function. This can
be useful for controlling that the optimization procedure is proceeding in a monotone way and it does not
oscillate.
This argument is composed of two elements: TRUE/FALSE if we want or not to print the previous values and how many values we
want to print on the console. Default is (TRUE, 3), so that only the previous 3 values of the log-likelihood are printed.</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_level">level</code></td>
<td>
<p>A numeric value representing the confidence level for the optimal parameters (default is 0.95 for 95% confidence).</p>
</td></tr>
<tr><td><code id="AdPaikModel_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, detailed progress messages will be printed to the console. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two observation needs to made about the time-domain:
</p>

<ul>
<li><p> The time domain may coincide with the follow-up or it may be contained in it.
Indeed, the left boundary can be greater than the beginning of the follow-up and, for instance, it can coincide
with the time-instants in which the events begin to happen; conversely, the right boundary of the two must be the same.
</p>
</li>
<li><p> The partition of the time domain into intervals can be made according to two selected criteria:
(1) using an already existent partition of the follow-up
(2) using the shape of the baseline hazard function as reference: divide the time-domain according to regions in
which it has a peak or a plateau.
</p>
</li></ul>

<p>The parameters with respect to which the log-likelihood function must be optimized are:
</p>

<ul>
<li><p> baseline log-hazard (number of parameters = number of intervals of the time-domain)
</p>
</li>
<li><p> data regressors
</p>
</li>
<li> <p><code class="reqn">\mu_1</code>, <code class="reqn">\nu</code>: parameters of the gamma distribution of <code class="reqn">\alpha_j</code> (time-independent/constant) (2 parameters)
</p>
</li>
<li> <p><code class="reqn">\gamma_k</code>: parameters of the gamma distribution of <code class="reqn">\epsilon_{jk}</code> (time-dependent) (number of parameters = number of intervals)
Another model parameter is <code class="reqn">\mu_2</code> and it is get imposing the constraint that <code class="reqn">\mu_1 + \mu_2 = 1</code>.
As it can be notice, some parameters can be grouped into the same category (regressors, baseline log-hazard and so on)
and we can easily constraint them assigning each category both a minimum and maximum range.
The category vector is structured as follows: (baseline log-hazard, regressors, <code class="reqn">\mu_1</code>, <code class="reqn">\nu</code>, <code class="reqn">\gamma_k</code>) with dimension
(n_intervals, n_regressors, 1, 1, n_intervals).
</p>
</li></ul>

<p>The output of the model call 'AdPaikModel(...)' is a S3 object of class 'AdPaik', composed of the following quantities:
</p>

<ul>
<li><p> formula: formula object provided in input by the user and specifying the relationship between the time-to-event, the covariates of
the dataset (regressors) and the cluster variable.
</p>
</li>
<li><p> Regressors: categorical vector of length R, with the name of the regressors.
They could be different from the original covariates of the dataset in case of categorical covariates.
Indeed, each categorical covariate with n levels needs to be transformed into (n-1) dummy variables and, therefore, (n-1) new regressors.
</p>
</li>
<li><p> NRegressors: number of regressors (R)
</p>
</li>
<li><p> ClusterVariable: name of the variable with respect to which the individuals can be grouped.
</p>
</li>
<li><p> NClusters: number of clusters/centres (also indicated with N).
</p>
</li>
<li><p> NIntervals: number of intervals of the time-domain, also called with L.
</p>
</li>
<li><p> NParameters: number of parameters of the model. It can be computed as: <code class="reqn">n_p = 2L + R + 2</code>.
</p>
</li>
<li><p> ParametersCategories: Numerical vector of length 5, containing the numerosity of each parameter category.
</p>
</li>
<li><p> ParametersRange: S3 object of class 'ParametersRange', containing ParametersRangeMin and ParametersRangeMax, two numerical vectors of length <code class="reqn">n_p</code>, giving the minimum and the maximum range of each parameter, respectively.
</p>
</li>
<li><p> Loglikelihood: value of the maximized log-likelihood function, at the optimal estimated parameters.
</p>
</li>
<li><p> AIC: 'Akaike Information Criterion': it can be computed as <code class="reqn">AIC = 2n_p - 2ll_{optimal}</code>.
It quantifies the loss of information related to the model fitting and output.
The smaller, the less the loss of information and the better the model accuracy.
</p>
</li>
<li><p> Status: Logical value. TRUE if the model reaches convergence, FALSE otherwise.
</p>
</li>
<li><p> NRun: Number of runs necessary to reach convergence. If the model does not reach convergence, such number is equal to the maximum number
of imposed runs.
</p>
</li>
<li><p> OptimalParameters: numerical vector of length <code class="reqn">n_p</code>, containing the optimal estimated parameters (the parameters
that maximize the log-likelihood function).
</p>
</li>
<li><p> StandardErrorParameters: numerical vector of length <code class="reqn">n_p</code>, corresponding to the standard error of each estimated parameters.
</p>
</li>
<li><p> ParametersCI: S3 object of class 'ParametersCI', composed of two numerical vector of length equal to <code class="reqn">n_p</code>: the left and right 95\
interval of each estimated parameter of given level.
</p>
</li>
<li><p> BaselineHazard: numerical vector of length equal to L, containing the baseline hazard step-function.
</p>
</li>
<li><p> FrailtyDispersion:  S3 object of class 'FrailtyDispersion', containing two numerical vectors of length equal to L with the standard deviation and the variance of the frailty.
numerical vector of length equal to L (i.e. number of intervals of the time-domain), reporting the standard deviation
of the frailty.
</p>
</li>
<li><p> PosteriorFrailtyEstimates: S3 object of class 'PFE.AdPaik'. See details.
</p>
</li>
<li><p> PosteriorFrailtyVariance: S3 object of class 'PFV.AdPaik'. See details.
</p>
</li>
<li><p> PosteriorFrailtyCI: S3 object of class 'PFCI.AdPaik'. See details.
</p>
</li></ul>

<p>The object of class 'PFE.AdPaik' contains the Posterior Frailty Estimates computed with the procedure indicated in the reference paper and
it is composed of three elements:
</p>

<ul>
<li><p> 'alpha': posterior frailty estimates for <code class="reqn">\alpha_j, \forall j</code>. It is a vector of length equal to the number of centres.
</p>
</li>
<li><p> 'eps': posterior frailty estimates for <code class="reqn">\epsilon_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li>
<li><p> 'Z': posterior frailty estimates for <code class="reqn">Z_{jk} = \alpha_j + \epsilon_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li></ul>

<p>The object of class 'PFV.AdPaik' contains the Posterior Frailty Variances computed as indicated in the reference papaer and it
is  composed of three elements:
</p>

<ul>
<li><p> 'alphaVar': posterior frailty variance for <code class="reqn">\alpha_j, \forall j</code>. It is a vector of length equal to the number of centres.
</p>
</li>
<li><p> 'epsVar': posterior frailty variance for <code class="reqn">\epsilon_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li>
<li><p> 'ZVar': posterior frailty variance for <code class="reqn">Z_{jk} = \alpha_j + \epsilon_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li></ul>

<p>The object of class 'PFCI.AdPaik' contains the Posterior Frailty Confidence Interval and it is composed of two elements:
</p>

<ul>
<li><p> left confidence interval for the estimated <code class="reqn">\hat{Z}_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li>
<li><p> right confidence interval for the estimated <code class="reqn">\hat{Z}_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li></ul>



<h3>Value</h3>

<p>S3 object of class 'AdPaik', composed of several elements. See Details.
</p>


<h3>Source</h3>

<p>...
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Consider the 'Academic Dropout dataset'
data(data_dropout)

# Define the variables needed for the model execution
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
eps &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps, eps, eps)
categories_range_max &lt;- c(-eps, 0, 1 - eps, 1, 10)


# Call the main model
result &lt;- AdPaikModel(formula, data_dropout, time_axis,
                      categories_range_min, categories_range_max, TRUE)

</code></pre>

<hr>
<h2 id='bas_hazard'>Baseline hazard step-function</h2><span id='topic+bas_hazard'></span>

<h3>Description</h3>

<p>The method computes the baseline hazard step-function in each interval of the time-domain, using the estimated parameters
<code class="reqn">\phi_k, \forall k</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bas_hazard(optimal_params, time_axis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bas_hazard_+3A_optimal_params">optimal_params</code></td>
<td>
<p>Numerical vector of length equal to the number of model parameters, containing the optimal estimated parameters.</p>
</td></tr>
<tr><td><code id="bas_hazard_+3A_time_axis">time_axis</code></td>
<td>
<p>Numerical vector of temporal domain.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numerical vector of length equal to the number of intervals of the time-domain, with the value of the baseline hazard step-function.
</p>

<hr>
<h2 id='check.C_mult'>Check positiveness of the multiplicative constant C</h2><span id='topic+check.C_mult'></span>

<h3>Description</h3>

<p>The method controls the multiplicative constant C is non-negative (i.e. positive).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.C_mult(C_mult)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.C_mult_+3A_c_mult">C_mult</code></td>
<td>
<p>Multiplicative constant</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if the condition is not satisfied.
</p>

<hr>
<h2 id='check.categories_params'>Check correctness of parameters categories</h2><span id='topic+check.categories_params'></span>

<h3>Description</h3>

<p>The function controls that the provided parameters categories have a length equal to the number of categories required by the model
parameters. For the current model, the number of categories is 5 because there are five blocks of unkown parameters (<code class="reqn">\phi_k \forall k, \beta_r \forall r,
\mu_1, \nu, \gamma_k \forall k</code>).
</p>
<p>Moreover, it also controls that the minimum value of a parameter category is actually less than or eqaul to the maximum value for the same category.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.categories_params(
  n_categories,
  categories_range_min,
  categories_range_max
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.categories_params_+3A_n_categories">n_categories</code></td>
<td>
<p>Number of categories expected by the model. For the current model, they are 5.</p>
</td></tr>
<tr><td><code id="check.categories_params_+3A_categories_range_min">categories_range_min</code></td>
<td>
<p>Numerical vector of length 5, containing the minimum ranges for the parameters beloning to those categories.</p>
</td></tr>
<tr><td><code id="check.categories_params_+3A_categories_range_max">categories_range_max</code></td>
<td>
<p>Numerical vector of length equal to 5, containing the maximum ranges for the parameters belonging to those categories.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if the any condition is not satisfied.
</p>

<hr>
<h2 id='check.centre'>Check correctness for the cluster variable</h2><span id='topic+check.centre'></span>

<h3>Description</h3>

<p>The function controls that the provided cluster variable is a vector, with at least two levels. Indeed, it is not possible to
apply the Time-Dependent Shared Frailty Cox Model with no clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.centre(centre)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.centre_+3A_centre">centre</code></td>
<td>
<p>Numerical vector of length equal to the number of individuals in the study, containing the individual grouo/cluster
membership.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied
</p>

<hr>
<h2 id='check.dataset'>Check presence of null or nan element value in the dataset</h2><span id='topic+check.dataset'></span>

<h3>Description</h3>

<p>The method controls that the dataset does not contain 'NULL', 'null', 'NaN' or 'nan' value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.dataset(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.dataset_+3A_data">data</code></td>
<td>
<p>Dataset (dataframe)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.flag_optimal_params'>Check coherence between flag for optimal parameters and optimal parameters</h2><span id='topic+check.flag_optimal_params'></span>

<h3>Description</h3>

<p>The function controls that one of the following condition is satisfied:
</p>

<ul>
<li><p> if the flag for the optimal parameters is activated, then the optimal parameters should be provided in input
</p>
</li>
<li><p> if the flag is not activated, then the optimal parameters should not be provided and the parameter vector should be NU
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>check.flag_optimal_params(optimal_params, flag_optimal_params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.flag_optimal_params_+3A_optimal_params">optimal_params</code></td>
<td>
<p>Either a numerical vector of length equal to the number of model parameters or a NULL value.</p>
</td></tr>
<tr><td><code id="check.flag_optimal_params_+3A_flag_optimal_params">flag_optimal_params</code></td>
<td>
<p>Logical value. Did the user want to provide optimal parameters vector? If so, the variable should be TRUE; otherwise
(no optimal parameters), FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.formula_terms'>Check correctness of formula terms</h2><span id='topic+check.formula_terms'></span>

<h3>Description</h3>

<p>The function controls that the terms composing the formula object provided in input to the main model are correct.
They must include:
</p>

<ul>
<li><p> response variable on the left hand side
</p>
</li>
<li><p> covariates (numerical or categorical) on the right hand side
</p>
</li>
<li><p> cluster variable (categorical) on the right hand side and specified by the function 'cluster()'
</p>
</li></ul>

<p>Moreover, it controls that the covariates are contained in the dataset provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.formula_terms(formula, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.formula_terms_+3A_formula">formula</code></td>
<td>
<p>Formula object specifying the relationship between the time-to-event, the covariates and the cluster variables.</p>
</td></tr>
<tr><td><code id="check.formula_terms_+3A_data">data</code></td>
<td>
<p>Dataset in which these variables can be found.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satified.
</p>

<hr>
<h2 id='check.frailty_dispersion'>Check correctness of frailty standard deviation</h2><span id='topic+check.frailty_dispersion'></span>

<h3>Description</h3>

<p>The function controls that the frailty standard deviation vector has a length equal to the number of inyervals of the time domain and
that its elements are non-negative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.frailty_dispersion(frailty_dispersion, n_intervals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.frailty_dispersion_+3A_frailty_dispersion">frailty_dispersion</code></td>
<td>
<p>Frailty dispersion</p>
</td></tr>
<tr><td><code id="check.frailty_dispersion_+3A_n_intervals">n_intervals</code></td>
<td>
<p>Number of intervals of the time-domain</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.index'>Check existence of provided input index</h2><span id='topic+check.index'></span>

<h3>Description</h3>

<p>The method controls that the provided input index exists: it cannot be greater than the maximum number
of parameters of the current model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.index(index, n_params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.index_+3A_index">index</code></td>
<td>
<p>Index with respect to which the user wants to study the one dimensional behaviour of
the log-likelihood function.</p>
</td></tr>
<tr><td><code id="check.index_+3A_n_params">n_params</code></td>
<td>
<p>Number of parameters of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.pchtype_colorbg'>Check correctness of plot variables pch and color</h2><span id='topic+check.pchtype_colorbg'></span>

<h3>Description</h3>

<p>The function controls that the input variables 'pch_type' and 'color_bg' have the correct structure,
they have the same dimension of the number of clusters in the dataset and they have meaningful elements.
</p>
<p>These variables are used for the plot of the posterio frailty estimates: the estimates for each faculty are plotted through a symbol, having
color and shape indicated by the variables (for the k-th faculty, consider the k-th element of both vectors).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.pchtype_colorbg(centre_codes, pch_type, color_bg)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.pchtype_colorbg_+3A_centre_codes">centre_codes</code></td>
<td>
<p>Numerical vector of length equal to the number of centres/clusters in the dataset and containing the distinct centres/clusters.
They correspond to the levels of the numerical vector of individual group membership.</p>
</td></tr>
<tr><td><code id="check.pchtype_colorbg_+3A_pch_type">pch_type</code></td>
<td>
<p>Numerical vector of length equal to the number of centres and containing the point shape for each faculty.</p>
</td></tr>
<tr><td><code id="check.pchtype_colorbg_+3A_color_bg">color_bg</code></td>
<td>
<p>Numerical vector of length equal to the number of centres and containing the color of the point for each faculty.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.pos_frailty_sd'>Check positiviness of the frailty standard deviation</h2><span id='topic+check.pos_frailty_sd'></span>

<h3>Description</h3>

<p>The method controls that the frailty standard deviation vector has non-negative elements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.pos_frailty_sd(sd, n_intervals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.pos_frailty_sd_+3A_sd">sd</code></td>
<td>
<p>Numerical vector of length equal to the number of intervals, containing the frailty standard deviation</p>
</td></tr>
<tr><td><code id="check.pos_frailty_sd_+3A_n_intervals">n_intervals</code></td>
<td>
<p>Number of intervals of the time-domain</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.poslegend'>Check correctness of legend position</h2><span id='topic+check.poslegend'></span>

<h3>Description</h3>

<p>The function controls that the provided position of the legend is correct. It can be either
a vector of length 2, giving the x and y coordinates, or a string, giving the exact position among different possibilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.poslegend(pos_legend)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.poslegend_+3A_pos_legend">pos_legend</code></td>
<td>
<p>Either a numerical vector of length 2, with the x and y coordinates, or a string with the exact position.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.post_frailty_centre'>Check numerosity of posterior frailty estimates</h2><span id='topic+check.post_frailty_centre'></span>

<h3>Description</h3>

<p>The function controls that a time-dependent posterior frailty estimate is computed for each centre
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.post_frailty_centre(post_frailty_est, centre_codes)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.post_frailty_centre_+3A_post_frailty_est">post_frailty_est</code></td>
<td>
<p>An S3 class object containing the posterior frailty estimates <code class="reqn">\hat{\alpha}_j, \hat{\epsilon}_{jk},
\hat{Z}_{jk}, \forall j,k</code></p>
</td></tr>
<tr><td><code id="check.post_frailty_centre_+3A_centre_codes">centre_codes</code></td>
<td>
<p>Numerical vector of length equal to the number of distinct centres/clusters in the study</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.range_params'>Check correctness of input parameters</h2><span id='topic+check.range_params'></span>

<h3>Description</h3>

<p>The function controls that the input parameter vector have a length equal to the theoretical one required by the model and that each parameter
properly belongs to its range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.range_params(optimal_params, params_range_min, params_range_max)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.range_params_+3A_optimal_params">optimal_params</code></td>
<td>
<p>Numerical vector of length equal to the number of model parameters. For the 'Adapted Paik et al.'s Model' it can be computed
as: <code class="reqn">n_p = 2L + R + 2</code>, where <code class="reqn">L</code> stands for the number of intervals of the time domain and <code class="reqn">R</code> the number of regressors of the dataset.</p>
</td></tr>
<tr><td><code id="check.range_params_+3A_params_range_min">params_range_min</code></td>
<td>
<p>Numerical vector of length equal to the number of model parameters (<code class="reqn">n_p</code>) and containing the minimum range for each
parameter.</p>
</td></tr>
<tr><td><code id="check.range_params_+3A_params_range_max">params_range_max</code></td>
<td>
<p>Numerical vector of length equal to the number of model parameters (<code class="reqn">n_p</code>) and containing the maximum range for each
parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.result'>Internal function to check the structure of the model output</h2><span id='topic+check.result'></span>

<h3>Description</h3>

<p>This internal function checks if the input <code>result</code> object belongs to one of the
expected S3 classes ('AdPaik', 'PowPar', or 'StocTimeDep') and calls the
appropriate checking function based on the class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.result(result)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.result_+3A_result">result</code></td>
<td>
<p>S3 object. Expected to be of class 'AdPaik', 'PowPar', or 'StocTimeDep'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and dispatches the appropriate structure-checking function
based on the class of the input. Currently, it supports 'AdPaik' class. The structure-checking
functions for 'PowPar' and 'StocTimeDep' are placeholders and should be implemented if needed.
</p>


<h3>Value</h3>

<p>Throws an error if the <code>result</code> object does not belong to one of the expected classes,
or if the objectâ€™s structure is incorrect.
</p>

<hr>
<h2 id='check.result.AdPaik'>Check structure of the 'AdPaikModel' output</h2><span id='topic+check.result.AdPaik'></span>

<h3>Description</h3>

<p>The function controls that the structure of the input variable is coherent with the one returned by the
'AdPaikModel' execution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.result.AdPaik(result)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.result.AdPaik_+3A_result">result</code></td>
<td>
<p>S3 object of class 'AdPaik', composed of several elements. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output of the model call 'AdPaikModel(...)' is a S3 object of class 'AdPaik', composed of 18 quantities:
</p>

<ul>
<li><p> formula: formula object provided in input by the user and specifying the relationship between the time-to-event, the covariates of
the dataset (regressors) and the cluster variable.
</p>
</li>
<li><p> Regressors: categorical vector of length R, with the name of the regressors.
They could be different from the original covariates of the dataset in case of categorical covariates.
Indeed, each categorical covariate with n levels needs to be transformed into (n-1) dummy variables and, therefore, (n-1) regressors.
</p>
</li>
<li><p> NRegressors: number of regressors (R)
</p>
</li>
<li><p> ClusterVariable: name of the variable with respect to which the individuals can be grouped.
</p>
</li>
<li><p> NClusters: number of clusters/groups/centres
</p>
</li>
<li><p> NIntervals: number of intervals of the time-domain, also called with L. It corresponds to the length of the time-domain minus 1.
</p>
</li>
<li><p> NParameters: number of parameters of the model. It can be computed as: <code class="reqn">n_p = 2L + R + 2</code>.
</p>
</li>
<li><p> ParametersCategories: Numerical vector of length 5, containing the numerosity of each parameter category.
</p>
</li>
<li><p> ParametersRangeMin: Numerical vector of length <code class="reqn">n_p</code>, giving the minimum range of each parameter.
</p>
</li>
<li><p> ParametersRangeMax: Numerical vector of length <code class="reqn">n_p</code>, giving the maximum range of each parameter.
</p>
</li>
<li><p> Loglikelihood: value of the maximized log-likelihood function, at the optimal estimated parameters.
</p>
</li>
<li><p> AIC: 'Akaike Information Criterion': it can be computed as <code class="reqn">AIC = 2n_p - 2ll_{optimal}</code>.
It gives an idea of the loss of information related to the model fitting and output.
The smaller it is, the less loss of information and the better model accuracy.
</p>
</li>
<li><p> Status: Logical value. Does the model reach convergence? If so, the variable is TRUE, otherwise FALSE.
</p>
</li>
<li><p> NRun: Number of runs necessary to reach convergence. If the model does not reach convergence, such number is equal to the maximum number
of imposed runs.
</p>
</li>
<li><p> OptimalParameters: numerical vector of length <code class="reqn">n_p</code>, containing the optimal estimated parameters or, in other words, the parameters
that maximizes the log-likelihood function.
</p>
</li>
<li><p> StandardErrorParameters: numerical vector of length <code class="reqn">n_p</code>, corresponding to the standard error of each estimated parameters.
</p>
</li>
<li><p> ParametersCI: S3 object of class 'ParametersCI', composed of two numerical vector of length equal to <code class="reqn">n_p</code>: the left and right confidence
interval of each estimated parameter.
</p>
</li>
<li><p> FrailtyStandardDeviation: numerical vector of length equal to L (i.e. number of intervals of the time-domain), reporting the standard deviation
of the frailty.
</p>
</li>
<li><p> PosteriorFrailtyEstimates: S3 object of class 'PFE.AdPaik'. See details.
</p>
</li>
<li><p> PosteriorFrailtyVariance: S3 object of class 'PFV.AdPaik'. See details.
</p>
</li>
<li><p> PosteriorFrailtyCI: S3 object of class 'PFCI.AdPaik'. See details.
</p>
</li></ul>

<p>The object of class 'PFE.AdPaik' contains the Posterior Frailty Estimates computed with the procedure indicated in the reference paper and
it is composed of three elements:
</p>

<ul>
<li><p> 'alpha': posterior frailty estimates for <code class="reqn">\alpha_j, \forall j</code>. It is a vector of length equal to the number of groups/centres.
</p>
</li>
<li><p> 'eps': posterior frailty estimates for <code class="reqn">\epsilon_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li>
<li><p> 'Z': posterior frailty estimates for <code class="reqn">Z_{jk} = \alpha_j + \epsilon_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li></ul>

<p>The object of class 'PFV.AdPaik' contains the Posterior Frailty Variances computed as indicated in the reference papaer and it
is  composed of three elements:
</p>

<ul>
<li><p> 'alphaVar': posterior frailty variance for <code class="reqn">\alpha_j, \forall j</code>. It is a vector of length equal to the number of groups/centres.
</p>
</li>
<li><p> 'epsVar': posterior frailty variance for <code class="reqn">\epsilon_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li>
<li><p> 'ZVar': posterior frailty variance for <code class="reqn">Z_{jk} = \alpha_j + \epsilon_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li></ul>

<p>The object of class 'PFCI.AdPaik' contains the Posterior Frailty Confidence Interval and it is composed of two elements:
</p>

<ul>
<li><p> left confidence interval for the estimated <code class="reqn">\hat{Z}_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li>
<li><p> right confidence interval for the estimated <code class="reqn">\hat{Z}_{jk}, \forall j,k</code>. Matrix of dimension (N, L).
</p>
</li></ul>



<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.structure_paramsCI'>Check structure for the Parameters Confidence Interval</h2><span id='topic+check.structure_paramsCI'></span>

<h3>Description</h3>

<p>The function controls that the structure of the Parameters Confidence Intervals coincides with the theoretical one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.structure_paramsCI(parametersCI)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.structure_paramsCI_+3A_parametersci">parametersCI</code></td>
<td>
<p>S3 object of class 'ParametersCI', composed of two elements:
</p>

<ul>
<li><p> left confidence interval: numerical vector of length equal to the number of parameters in the model
</p>
</li>
<li><p> right confidence interval: numerical vector of length equal to the number of parameters in the model
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.structure_post_frailty_CI'>Check structure of Posterior Frailty Confidence Interval</h2><span id='topic+check.structure_post_frailty_CI'></span>

<h3>Description</h3>

<p>The function controls that the structure of the 'Posterior Frailty Confidence Interval' coincides with the theoretical one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.structure_post_frailty_CI(post_frailty_CI, n_intervals, n_centres)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.structure_post_frailty_CI_+3A_post_frailty_ci">post_frailty_CI</code></td>
<td>
<p>Posterior frailty estimates S3 object of class 'PFCI.AdPaik', composed of two elements:
</p>

<ul>
<li><p> left confidence interval for the estimated <code class="reqn">\hat{Z}_{jk}, \forall j,k</code>
</p>
</li>
<li><p> right confidence interval for the estimated <code class="reqn">\hat{Z}_{jk}, \forall j,k</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="check.structure_post_frailty_CI_+3A_n_intervals">n_intervals</code></td>
<td>
<p>Number of intervals of the time-domain</p>
</td></tr>
<tr><td><code id="check.structure_post_frailty_CI_+3A_n_centres">n_centres</code></td>
<td>
<p>Number of centres/clusters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.structure_post_frailty_est'>Check structure of Posterior Frailty Estimates</h2><span id='topic+check.structure_post_frailty_est'></span>

<h3>Description</h3>

<p>The function controls that the structure of the 'Posterior Frailty Estimates' coincides with the theoretical one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.structure_post_frailty_est(post_frailty_est, n_intervals, n_centres)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.structure_post_frailty_est_+3A_post_frailty_est">post_frailty_est</code></td>
<td>
<p>Posterior frailty estimates S3 object of class 'PFE.AdPaik', composed of three elements:
</p>

<ul>
<li><p> 'alpha': posterior frailty estimates for <code class="reqn">\alpha_j, \forall j</code>. It is a vector of length equal to the number of centres.
</p>
</li>
<li><p> 'eps': posterior frailty estimates for <code class="reqn">\epsilon_{jk}, \forall j,k</code>. It is a matrix of dimension (n_centres, n_intervals).
</p>
</li>
<li><p> 'Z': posterior frailty estimates for <code class="reqn">Z_{jk} = \alpha_j + \epsilon_{jk}, \forall j,k</code>. It is a matrix of dimension (n_centres, n_intervals)
</p>
</li></ul>
</td></tr>
<tr><td><code id="check.structure_post_frailty_est_+3A_n_intervals">n_intervals</code></td>
<td>
<p>Number of intervals of the time-domain</p>
</td></tr>
<tr><td><code id="check.structure_post_frailty_est_+3A_n_centres">n_centres</code></td>
<td>
<p>Number of centres/clusters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.structure_post_frailty_var'>Check structure of Posterior Frailty Variances</h2><span id='topic+check.structure_post_frailty_var'></span>

<h3>Description</h3>

<p>The function controls that the structure of the 'Posterior Frailty Variances' coincides with the theoretical one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.structure_post_frailty_var(post_frailty_var, n_intervals, n_centres)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.structure_post_frailty_var_+3A_post_frailty_var">post_frailty_var</code></td>
<td>
<p>Posterior frailty variances S3 object of class 'PFV.AdPaik', composed of three elements:
</p>

<ul>
<li><p> 'alphaVar': posterior frailty variance for <code class="reqn">\alpha_j, \forall j</code>. It is a vector of length equal to the number of centres.
</p>
</li>
<li><p> 'epsVar': posterior frailty variance for <code class="reqn">\epsilon_{jk}, \forall j,k</code>. It is a matrix of dimension (n_centres, n_intervals).
</p>
</li>
<li><p> 'ZVar': posterior frailty variance for <code class="reqn">Z_{jk} = \alpha_j + \epsilon_{jk}, \forall j,k</code>. It is a matrix of dimension (n_centres, n_intervals)
</p>
</li></ul>
</td></tr>
<tr><td><code id="check.structure_post_frailty_var_+3A_n_intervals">n_intervals</code></td>
<td>
<p>Number of intervals of the time-domain</p>
</td></tr>
<tr><td><code id="check.structure_post_frailty_var_+3A_n_centres">n_centres</code></td>
<td>
<p>Number of centres/clusters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='check.time_axis'>Check correctness of time domain subdivision</h2><span id='topic+check.time_axis'></span>

<h3>Description</h3>

<p>The function controls that the time domain is a vector and it has at least 2 elements and that all of them are not negative.
Moreover, it checks that all its elements are non-negative and properly ordered, in an ascending way.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.time_axis(time_axis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.time_axis_+3A_time_axis">time_axis</code></td>
<td>
<p>Numerical vector of temporal domain subdivision.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error is returned if any condition is not satisfied.
</p>

<hr>
<h2 id='check.value_post_frailty'>Check non-negativeness of the posterior frailty estimates</h2><span id='topic+check.value_post_frailty'></span>

<h3>Description</h3>

<p>The function controls that all posterior frailty estimates are non-negative.
Indeed, by construction the realizations of a gamma distribution are non negative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.value_post_frailty(post_frailty_est, n_centres, n_intervals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.value_post_frailty_+3A_post_frailty_est">post_frailty_est</code></td>
<td>
<p>An S3 class object containing the posterior frailty estimates: <code class="reqn">\hat{\alpha}_j, \hat{\epsilon}_{jk},
\hat{Z}_{jk}, \forall j,k</code></p>
</td></tr>
<tr><td><code id="check.value_post_frailty_+3A_n_centres">n_centres</code></td>
<td>
<p>Number of groups/clusters.</p>
</td></tr>
<tr><td><code id="check.value_post_frailty_+3A_n_intervals">n_intervals</code></td>
<td>
<p>Number of intervals of the time domain</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error if any condition is not satisfied.
</p>

<hr>
<h2 id='coef.AdPaik'>Extracts the optimal parameters of each cateogry for the 'Adapted Paik et al.' Model</h2><span id='topic+coef.AdPaik'></span>

<h3>Description</h3>

<p>Extracts the optimal parameters <code class="reqn">\boldsymbol{\phi}</code>, <code class="reqn">\boldsymbol{\beta}</code>, <code class="reqn">\mu_1</code>,
<code class="reqn">\nu</code>, <code class="reqn">\boldsymbol{\gamma}</code> obtained with the
time-dependent frailty model proposed in the 'Adapted Paik et al.' framework.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AdPaik'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.AdPaik_+3A_object">object</code></td>
<td>
<p>An S3 object of class <code>AdPaik</code>, returned by the main model function
(<code>AdPaikModel</code>). This object contains all the optimal parameter estimates.</p>
</td></tr>
<tr><td><code id="coef.AdPaik_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>coef.AdPaik</code> function extracts the coefficients from the
<code>OptimalParameters</code> field in <code>object</code>.
</p>
<p>The function validates the structure of <code>object</code> and ensures compatibility
with the expected model output. It throws an error if the object is malformed or
inconsistent.
</p>


<h3>Value</h3>

<p>A named list containing the categories of optimal parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example using the 'Academic Dropout' dataset
data(data_dropout)

# Define the formula and time axis for the model
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
eps &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps, eps, eps)
categories_range_max &lt;- c(-eps, 0, 1 - eps, 1, 10)


# Run the main model
result &lt;- AdPaikModel(formula, data_dropout, time_axis,
                      categories_range_min, categories_range_max, TRUE)

# Extract the coefficients
coef(result)

</code></pre>

<hr>
<h2 id='coefse'>Extracts the standard errors computed for each cateogry for the 'Adapted Paik et al.' Model</h2><span id='topic+coefse'></span>

<h3>Description</h3>

<p>Extracts the standard errors for <code class="reqn">\boldsymbol{\phi}</code>, <code class="reqn">\boldsymbol{\beta}</code>, <code class="reqn">\mu_1</code>,
<code class="reqn">\nu</code>, <code class="reqn">\boldsymbol{\gamma}</code> obtained with the
time-dependent frailty model proposed in the 'Adapted Paik et al.' framework.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coefse(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coefse_+3A_object">object</code></td>
<td>
<p>An S3 object of class <code>AdPaik</code>, returned by the main model function
(<code>AdPaikModel</code>). This object contains all the optimal parameter estimates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>coefse</code> function extracts the standard errors for the estimated parameters from the
<code>StandardErrorParameters</code> field in <code>object</code>.
</p>
<p>The function validates the structure of <code>object</code> and ensures compatibility
with the expected model output. It throws an error if the object is malformed or
inconsistent.
</p>


<h3>Value</h3>

<p>A named list containing the categories of the standard errors for the optimal parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example using the 'Academic Dropout' dataset
data(data_dropout)

# Define the formula and time axis for the model
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
eps &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps, eps, eps)
categories_range_max &lt;- c(-eps, 0, 1 - eps, 1, 10)


# Run the main model
result &lt;- AdPaikModel(formula, data_dropout, time_axis,
                      categories_range_min, categories_range_max, TRUE)

# Extract the coefficients
coefse(result)

</code></pre>

<hr>
<h2 id='confint.AdPaik'>Extracts the confidence intervals computed for each cateogry for the 'Adapted Paik et al.' Model</h2><span id='topic+confint.AdPaik'></span>

<h3>Description</h3>

<p>Extracts the confidence intervals for <code class="reqn">\boldsymbol{\phi}</code>, <code class="reqn">\boldsymbol{\beta}</code>, <code class="reqn">\mu_1</code>,
<code class="reqn">\nu</code>, <code class="reqn">\boldsymbol{\gamma}</code> obtained with the
time-dependent frailty model proposed in the 'Adapted Paik et al.' framework.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AdPaik'
confint(object, parm = NULL, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.AdPaik_+3A_object">object</code></td>
<td>
<p>An S3 object of class <code>AdPaik</code>, returned by the main model function
(<code>AdPaikModel</code>). This object contains all the optimal parameter estimates.</p>
</td></tr>
<tr><td><code id="confint.AdPaik_+3A_parm">parm</code></td>
<td>
<p>A specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names.
Defaults to NULL, and all parameters are considered. Changing it is not supported for this model. It will be ignored.</p>
</td></tr>
<tr><td><code id="confint.AdPaik_+3A_level">level</code></td>
<td>
<p>The confidence level required. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="confint.AdPaik_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>confint.AdPaik</code> function extracts the standard errors for the estimated parameters from the
<code>ParametersCI</code> field in <code>object</code>.
</p>
<p>The function validates the structure of <code>object</code> and ensures compatibility
with the expected model output. It throws an error if the object is malformed or
inconsistent.
</p>


<h3>Value</h3>

<p>A named list containing the categories of the standard errors for the optimal parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example using the 'Academic Dropout' dataset
data(data_dropout)

# Define the formula and time axis for the model
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
eps &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps, eps, eps)
categories_range_max &lt;- c(-eps, 0, 1 - eps, 1, 10)


# Run the main model
result &lt;- AdPaikModel(formula, data_dropout, time_axis,
                      categories_range_min, categories_range_max, TRUE)

# Extract the coefficients
confint(result)

</code></pre>

<hr>
<h2 id='data_dropout'>Data Dropout Dataset</h2><span id='topic+data_dropout'></span>

<h3>Description</h3>

<p>This dataset is extracted from an administrative database provided by a
non-specified university and tracks students enrolled in 2012 over three academic years (or 6 semesters).
We are interested in understanding what factors lead to students dropping out.
Dropout students with a time-instant in the first semester have been removed,
for internal reasons (the university cannot take preventive action to reduce or avoid their withdrawal).
The students are followed for at most 3 academic years or, equivalently,
6 semesters (follow-up periods), from the first day of lecture up to the time-instant
of withdrawal (i.e. survival event) or the end of the academic year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_dropout
</code></pre>


<h3>Format</h3>

<p>A data frame with 4448 rows and 4 columns:
</p>

<dl>
<dt>Gender</dt><dd><p>Categorical covariate (Male or Female).</p>
</dd>
<dt>CFUP</dt><dd><p>Standardized numerical covariate indicating the number of credits \ passed by the students by the end of the first semester.</p>
</dd>
<dt>time_to_event</dt><dd><p>Time (in semesters) at which a student decides to leave the university. \ A value greater than 6.0 indicates the student did not drop out during the follow-up (e.g. 6.1 semesters)</p>
</dd>
<dt>group</dt><dd><p>Categorical variable indicating the student's course of study, with 16 different levels from CosA, CosB, ... , CosP.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data for demonstration purposes.
</p>

<hr>
<h2 id='extract_dummy_variables'>Transform categorical covariate into dummy variables</h2><span id='topic+extract_dummy_variables'></span>

<h3>Description</h3>

<p>This function produces for a categorical variable of the dataset (covariate) the associated dummy variables: for n levels of the covariate,
(n-1) dummy binary variables are generated. The chosen reference value is the first one of the list of extracted levels and cannot be changed
(the first one in alphabetical order). Therefore, if an individual has null value for all dummy variables, then his/her belonging level is the
reference one.
</p>
<p>Each dummy variable has a name, corresponding to the name of the covariate + name of the level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_dummy_variables(covariate, covariate_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_dummy_variables_+3A_covariate">covariate</code></td>
<td>
<p>Categorical dataset covariate, with at least 2 levels.</p>
</td></tr>
<tr><td><code id="extract_dummy_variables_+3A_covariate_name">covariate_name</code></td>
<td>
<p>Name of the covariate, for assigning each dummy variable a proper name.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The S3 class object 'DummyData' contains the variables related to the transformation of a single categorical covariate present in the dataset
into (n-1) binary covariates, stored in a matrix. To be precise:
</p>

<ul>
<li><p> DummyMatrix: binary matrix of dimension (n_individuals, n-1), where each column corresponds to one level of the original categorical
covariate.
</p>
</li>
<li><p> DummyVariablesName: categorical vector of length (n-1), reporting the names of the dummy variables and, therefore, the new name of each regressor.
</p>
</li>
<li><p> DummyVariablesNumber: number of dummy variables (n-1).
</p>
</li></ul>



<h3>Value</h3>

<p>S3 object of class 'DummyData', composed of three elements. See details.
</p>

<hr>
<h2 id='extract_event_data'>Extracting variables for Posterior Frailty Estimates computation</h2><span id='topic+extract_event_data'></span>

<h3>Description</h3>

<p>Function for extracting from the dataset quantities necessary to the evaluation of the posterior
frailty estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_event_data(dataset, time_to_event, centre, time_axis, phi, betar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_event_data_+3A_dataset">dataset</code></td>
<td>
<p>Dataset containing the covariates/regressors. Their numerosity is indicated with R.</p>
</td></tr>
<tr><td><code id="extract_event_data_+3A_time_to_event">time_to_event</code></td>
<td>
<p>Time-instant in the follow-up in which an individual fails or faces the event.
If an individual does not face the event, the time-instant assumes a default value.</p>
</td></tr>
<tr><td><code id="extract_event_data_+3A_centre">centre</code></td>
<td>
<p>Categorical vector indicating the group/cluster membership. The number of distinct group is indicated with N.</p>
</td></tr>
<tr><td><code id="extract_event_data_+3A_time_axis">time_axis</code></td>
<td>
<p>Numerical vector of the temporal domain. Its length is (L+1), where L indicates the number of intervals of the time-domain.</p>
</td></tr>
<tr><td><code id="extract_event_data_+3A_phi">phi</code></td>
<td>
<p>Numerical vector of length L, of estimated baseline log-hazard.</p>
</td></tr>
<tr><td><code id="extract_event_data_+3A_betar">betar</code></td>
<td>
<p>Numerical vector of length R, of estimated regressors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The S3 class obejct 'EventData' contains the variables necessary for the estimate of the posterior frailty and that can be extracted or
computed starting from the dataset.
</p>

<ul>
<li><p> N_ik: matrix of dimension (N, L), containing the number of event in each interval k and group i.
</p>
</li>
<li><p> N_i: numerical vector of length L, with the number of event in each group i. It can be computed as: <code class="reqn">N_i = \sum_{k=1}^L N_{ik}</code>.
</p>
</li>
<li><p> e_ijk: matrix of dimension (n_individuals, L) with the evaluation of the temporal integral, for each individual j, group i and interval k.
</p>
</li>
<li><p> Y_risk: binary matrix of dimension (n_individuals, L) reporting for each individual, in each interval, his/her risk of facing the event.
For an individual, the risk is equal to 1 in an interval k if, in that interval, he/she has not faced the event yet; otherwise, it is equal to 0.
</p>
</li>
<li><p> cum_hazard_group: matrix of dimension (N, L), where each element in position (i,k) indicates the computed cumulative hazard for all individuals
belonging to group i and at interval k.
</p>
</li>
<li><p> sum_cum_hazard_group: numerical vector of length N, giving the sum of the computed cumulative hazard for all intervals k and for all individuals
belonging to group i.
It can be computed from the previous element, summing with respect to the interval k.
</p>
</li></ul>



<h3>Value</h3>

<p>S3 object of class 'EventData', composed of six elements. See details.
</p>

<hr>
<h2 id='frailty_sd'>Frailty standard deviation and Variance for the 'Adapted Paik et al.'s Model'</h2><span id='topic+frailty_sd'></span>

<h3>Description</h3>

<p>The function computes both the standard deviation and the variance of the time-dependent
frailty of the 'Adapted Paik et al.'s Model'.
</p>
<p>Recalling the frailty structure <code class="reqn">Z_{jk} = \alpha_j + \epsilon_{jk}</code> as being composed by a constant group-dependent term
(<code class="reqn">\alpha_j</code>) and a time and group dependent term (<code class="reqn">\epsilon_{jk}</code>), the frailty standard deviation (and variance)
can be computed in two different way:
</p>

<ul>
<li><p> Considering only the time-dependent spread of the clusters/groups/centre: <code class="reqn">sd(Z_{jk}) = \mu_2 * \gamma_k</code>.
In this case, the flag_fullsd should be FALSE.
</p>
</li>
<li><p> Considering both the time-dependent and constant spread of the clusters: <code class="reqn">sd(Z_{jk}) = \mu_1 * \nu + \mu_2 * \gamma_k</code>.
The new added term only moves upward the other case and the flag_fullsd should be TRUE.
</p>
</li></ul>

<p>The final case only depends on what we want to observe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frailty_sd(result, flag_fullsd = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="frailty_sd_+3A_result">result</code></td>
<td>
<p>S3 object of class 'AdPaik' returned by the main model output, that contains all the information for the computation
of the frailty standard deviation.</p>
</td></tr>
<tr><td><code id="frailty_sd_+3A_flag_fullsd">flag_fullsd</code></td>
<td>
<p>Logical value. Do we want to compute the full frailty standard deviation? If so, the flag must be TRUE,
otherwise, FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 class object 'FrailtyDispersion' containing both two numerical vectors of length equal to the number of intervals of the time-domain:
</p>

<ul>
<li><p> FrailtyVariance
</p>
</li>
<li><p> FrailtyStandardDevation
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Consider the 'Academic Dropout dataset'
data(data_dropout)

# Define the variables needed for the model execution
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
eps &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps, eps, eps)
categories_range_max &lt;- c(-eps, 0, 1 - eps, 1, 10)

# Call the main model

result &lt;- AdPaikModel(formula, data_dropout, time_axis,
                      categories_range_min, categories_range_max, TRUE)

frailty_sd(result, TRUE)
frailty_sd(result, FALSE)

</code></pre>

<hr>
<h2 id='frailty_sd.AdPaik'>Frailty standard deviation and Variance for the 'Adapted Paik et al.'s Model'</h2><span id='topic+frailty_sd.AdPaik'></span>

<h3>Description</h3>

<p>The function computes both the standard deviation and the variance of the time-dependent
frailty of the 'Adapted Paik et al.'s Model'.
</p>
<p>Recalling the frailty structure <code class="reqn">Z_{jk} = \alpha_j + \epsilon_{jk}</code> as being composed by a constant group-dependent term
(<code class="reqn">\alpha_j</code>) and a time and group dependent term (<code class="reqn">\epsilon_{jk}</code>), the frailty standard deviation (and variance)
can be computed in two different way:
</p>

<ul>
<li><p> Considering only the time-dependent spread of the clusters/groups/centre: <code class="reqn">sd(Z_{jk}) = \mu_2 * \gamma_k</code>.
In this case, the flag_fullsd should be FALSE.
</p>
</li>
<li><p> Considering both the time-dependent and constant spread of the clusters: <code class="reqn">sd(Z_{jk}) = \mu_1 * \nu + \mu_2 * \gamma_k</code>.
The new added term only moves upward the other case and the flag_fullsd should be TRUE.
</p>
</li></ul>

<p>The final case only depends on what we want to observe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frailty_sd.AdPaik(result, flag_fullsd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="frailty_sd.AdPaik_+3A_result">result</code></td>
<td>
<p>S3 object of class 'AdPaik' returned by the main model output, that contains all the information for the computation
of the frailty standard deviation.</p>
</td></tr>
<tr><td><code id="frailty_sd.AdPaik_+3A_flag_fullsd">flag_fullsd</code></td>
<td>
<p>Logical value. Do we want to compute the full frailty standard deviation? If so, the flag must be TRUE,
otherwise, FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 class object 'FrailtyDispersion' containing both two numerical vectors of length equal to the number of intervals of the time-domain:
</p>

<ul>
<li><p> FrailtyVariance
</p>
</li>
<li><p> FrailtyStandardDevation
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Consider the 'Academic Dropout dataset'
data(data_dropout)

# Define the variables needed for the model execution
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
eps &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps, eps, eps)
categories_range_max &lt;- c(-eps, 0, 1 - eps, 1, 10)


# Call the main model
result &lt;- AdPaikModel(formula, data_dropout, time_axis,
                      categories_range_min, categories_range_max, TRUE)

frailty_sd(result, TRUE)
frailty_sd(result, FALSE)

</code></pre>

<hr>
<h2 id='ll_AdPaik_1D'>One-dimensional log-likelihood function to be optimized.</h2><span id='topic+ll_AdPaik_1D'></span>

<h3>Description</h3>

<p>Model log-likelihood function to be optimized only with respect to a parameter. To correctly identify this parameter inside the model
and inside the vector of all parameter, it is necessary to provide also the position (index) of this parameter in the vector.
</p>
<p>This function is internally used by the main function @AdPaikModel to perform, as said, the one-dimensional optimization
through 'optimize'.
It cannot be used to evaluate the log-likelihood function at a vector of parameter and at the provided data. For this purpose, we
have to use another implemented function, called @ll_AdPaik_eval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ll_AdPaik_1D(
  x,
  index,
  params,
  dataset,
  centre,
  time_axis,
  dropout_matrix,
  e_matrix
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ll_AdPaik_1D_+3A_x">x</code></td>
<td>
<p>Value of the parameter, with respect to which the log-likelihood function has to be optimized.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_1D_+3A_index">index</code></td>
<td>
<p>Index of the parameter inside the parameter vector.
For instance, if we need to optimize the log-likelihood function with respect to the first regressor,
then @x will be generic but @index will be equal to (n_intervals + 1) because in the parameter vector
the first regressor appears after the baseline log-hazard group (n_intervals elements).</p>
</td></tr>
<tr><td><code id="ll_AdPaik_1D_+3A_params">params</code></td>
<td>
<p>Parameter vector.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_1D_+3A_dataset">dataset</code></td>
<td>
<p>Matrix containing only the formula regressors, that is the regressors appearing in the
formula object provided by the user and eventually modified if they are categorical (nd therefore transformed into dummy variables).</p>
</td></tr>
<tr><td><code id="ll_AdPaik_1D_+3A_centre">centre</code></td>
<td>
<p>Individual membership to the clusters.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_1D_+3A_time_axis">time_axis</code></td>
<td>
<p>Temporal domain.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_1D_+3A_dropout_matrix">dropout_matrix</code></td>
<td>
<p>Binary matrix indicating in which interval of the time domain an individual failed. For an individual,
the sum of the row elements must be equal to 1 (if he/she failed) or 0 (if he/she does not failed).
It has dimension equal to (n_individuals, n_intervals).</p>
</td></tr>
<tr><td><code id="ll_AdPaik_1D_+3A_e_matrix">e_matrix</code></td>
<td>
<p>Matrix of dimension (n_individual, n_intervals), where each element contains the evaluation of the temporal
integral, performed through the function @param time_int_eval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function firstly divides the individuals according to their group/cluster membership, extracting group customized dataset and
other variables, and then compute the group log-likelihood function through the function @ll_AdPaik_centre_1D.
The produced group log-likelihood value is summed together the
other values into a unique result, that corresponds to the overall (and final) log-likelihood value.
</p>


<h3>Value</h3>

<p>Overall log-likelihood function
</p>

<hr>
<h2 id='ll_AdPaik_centre_1D'>One-dimensional group log-likelihood function.</h2><span id='topic+ll_AdPaik_centre_1D'></span>

<h3>Description</h3>

<p>This function simply implements the group log-likelihood function, following the definition.
It is internally used by @ll_AdPaik_1D and, therefore, it requires as first and second argument the parameter according to which the
global log-likelihood is one-dimensionally optimized and its position inside the vector of parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ll_AdPaik_centre_1D(
  param_onedim,
  index_param_onedim,
  params,
  dataset,
  dropout_matrix,
  e_matrix
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ll_AdPaik_centre_1D_+3A_param_onedim">param_onedim</code></td>
<td>
<p>One dimensional parameter, with respect to which the log-likelihood function
must be optmize.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_centre_1D_+3A_index_param_onedim">index_param_onedim</code></td>
<td>
<p>Index of the previous parameter inside the parameter vector.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_centre_1D_+3A_params">params</code></td>
<td>
<p>Parameter vector.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_centre_1D_+3A_dataset">dataset</code></td>
<td>
<p>Matrix of dataset regressors, with a number of rows equal to the number of individuals in a cluster.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_centre_1D_+3A_dropout_matrix">dropout_matrix</code></td>
<td>
<p>Binary matrix indicating in which interval of the time domain and individual failed. For an individual,
the sum of the row elements must be equal to 1 (if he/she failed) or 0 (if he/she does not failed).
It has dimension equal to (n_individuals, n_intervals)</p>
</td></tr>
<tr><td><code id="ll_AdPaik_centre_1D_+3A_e_matrix">e_matrix</code></td>
<td>
<p>Matrix of dimension (n_individual, n_intervals), where each element contains the evaluation of the temporal
integral, performed through the function @param time_int_eval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Centre log-likelihood function.
</p>

<hr>
<h2 id='ll_AdPaik_centre_eval'>Evaluation of model group log-likelihood</h2><span id='topic+ll_AdPaik_centre_eval'></span>

<h3>Description</h3>

<p>Evaluation of model group log-likelihood at the provided parameter vector and data.
This function is internally called by 'll_AdPaik_eval' to evaluate the log-likelihood function, considering
all and only the individuals belonging to a group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ll_AdPaik_centre_eval(params, dataset, dropout_matrix, e_matrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ll_AdPaik_centre_eval_+3A_params">params</code></td>
<td>
<p>Parameter vector.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_centre_eval_+3A_dataset">dataset</code></td>
<td>
<p>Matrix of dataset regressors, with a number of rows equal to the number of individuals in a cluster.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_centre_eval_+3A_dropout_matrix">dropout_matrix</code></td>
<td>
<p>Binary matrix indicating in which interval of the time domain and individual failed. For an individual,
the sum of the row elements must be equal to 1 (if he/she failed) or 0 (if he/she does not failed).
It has dimension equal to (n_individuals, n_intervals)</p>
</td></tr>
<tr><td><code id="ll_AdPaik_centre_eval_+3A_e_matrix">e_matrix</code></td>
<td>
<p>Matrix of dimension (n_individual, n_intervals), where each element contains the evaluation of the temporal
integral, performed through the function @time_int_eval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Group log-likelihood evaluation
</p>

<hr>
<h2 id='ll_AdPaik_eval'>Evaluation of model log-likelihood</h2><span id='topic+ll_AdPaik_eval'></span>

<h3>Description</h3>

<p>Evaluation of the log-likelihood function at the provided parameter vector and data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ll_AdPaik_eval(params, dataset, centre, time_axis, dropout_matrix, e_matrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ll_AdPaik_eval_+3A_params">params</code></td>
<td>
<p>Parameter vector</p>
</td></tr>
<tr><td><code id="ll_AdPaik_eval_+3A_dataset">dataset</code></td>
<td>
<p>Matrix of dimension equal to (number of individuals in the study, number of regressors), where only the regressors
indicated in the formula object are considered.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_eval_+3A_centre">centre</code></td>
<td>
<p>Vector of length equal to the number of individuals in the study, where each element corresponds to the individual
cluster membership.</p>
</td></tr>
<tr><td><code id="ll_AdPaik_eval_+3A_time_axis">time_axis</code></td>
<td>
<p>Temporal domain</p>
</td></tr>
<tr><td><code id="ll_AdPaik_eval_+3A_dropout_matrix">dropout_matrix</code></td>
<td>
<p>Binary matrix indicating in which interval of the time domain and individual failed. For an individual,
the sum of the row elements must be equal to 1 (if he/she failed) or 0 (if he/she does not failed).
It has dimension equal to (n_individuals, n_intervals)</p>
</td></tr>
<tr><td><code id="ll_AdPaik_eval_+3A_e_matrix">e_matrix</code></td>
<td>
<p>Matrix of dimension (n_individual, n_intervals), where each element contains the evaluation of the temporal
integral, performed through the function @time_int_eval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function divides the individuals according to their group/cluster membership and then evaluates the group log-likelihood
through another implemented function, but using all and only the individuals belonging to that group.
Then the results are summed together to return the overall log-likelihood value.
</p>


<h3>Value</h3>

<p>Overall log-likelihood function value at the provided parameters and data
</p>

<hr>
<h2 id='n_nodes'>Nodes and weights for the Gauss_hermite quadrature formula
for the 'Centre-Specific Frailty Model with Power Parameter'.
The nodes and weights have been extracted from the 'Handbook of Mathematical functions'
pag 940.</h2><span id='topic+n_nodes'></span>

<h3>Description</h3>

<p>Nodes and weights for the Gauss_hermite quadrature formula
for the 'Centre-Specific Frailty Model with Power Parameter'.
The nodes and weights have been extracted from the 'Handbook of Mathematical functions'
pag 940.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_nodes
</code></pre>


<h3>Format</h3>

<p>An object of class <code>numeric</code> of length 1.
</p>

<hr>
<h2 id='n_nodesG'>Nodes and weights for the Gauss-Hermite quadrature formula,
for the 'Stochastic Time-Dependent Centre-Specific Frailty Model'.
For the G function, the chosen nodes should not contain the zero (node)
since it appears at the denominator of a fraction.
Also in this case, the nodes and weights have been extracted from the
'Handbook of Mathematical functions', pag 940.</h2><span id='topic+n_nodesG'></span>

<h3>Description</h3>

<p>Nodes and weights for the Gauss-Hermite quadrature formula,
for the 'Stochastic Time-Dependent Centre-Specific Frailty Model'.
For the G function, the chosen nodes should not contain the zero (node)
since it appears at the denominator of a fraction.
Also in this case, the nodes and weights have been extracted from the
'Handbook of Mathematical functions', pag 940.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n_nodesG
</code></pre>


<h3>Format</h3>

<p>An object of class <code>numeric</code> of length 1.
</p>

<hr>
<h2 id='params_CI'>Confidence interval for the optimal estimated parameters</h2><span id='topic+params_CI'></span>

<h3>Description</h3>

<p>The function provides the confidence interval for each estimated parameter, using the standard error
computed through another method and provided as second argument to the current function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>params_CI(optimal_params, se_params, level)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="params_CI_+3A_optimal_params">optimal_params</code></td>
<td>
<p>Numerical vector of optimal estimated parameters. Its length is equal to the number of model parameters.</p>
</td></tr>
<tr><td><code id="params_CI_+3A_se_params">se_params</code></td>
<td>
<p>Numerical vector containing the standard error associated to each estimated parameter.</p>
</td></tr>
<tr><td><code id="params_CI_+3A_level">level</code></td>
<td>
<p>A numeric value representing the confidence level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A S3  object of class 'ParametersCI', composed of two numerical vector of length equal to the number of model parameters:
</p>

<ul>
<li><p> ParamsCI_left: left confidence interval for each parameter
</p>
</li>
<li><p> ParamsCI_right: right confidence interval for each parameter
</p>
</li></ul>


<hr>
<h2 id='params_se.AdPaik'>Standard error of the parameters</h2><span id='topic+params_se.AdPaik'></span>

<h3>Description</h3>

<p>Function for computing the standard error of each optimal parameter, estimated through the
constraint multi-dimensional optimization.
The procedure for the computation is based on the numerical approximation of the second derivative
of the log-likelihood function, by the 'centered finite difference scheme' with an accuracy of the second order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>params_se.AdPaik(
  optimal_params,
  params_range_min,
  params_range_max,
  dataset,
  centre,
  time_axis,
  dropout_matrix,
  e_matrix,
  h_dd
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="params_se.AdPaik_+3A_optimal_params">optimal_params</code></td>
<td>
<p>Numerical vector of optimal parameters. Its length (i.e. number of parameters) is equal to <code class="reqn">n_p</code>.</p>
</td></tr>
<tr><td><code id="params_se.AdPaik_+3A_params_range_min">params_range_min</code></td>
<td>
<p>Numerical vector of length equal to <code class="reqn">n_p</code>, containing the minimum range of each parameter.</p>
</td></tr>
<tr><td><code id="params_se.AdPaik_+3A_params_range_max">params_range_max</code></td>
<td>
<p>Numerical vector of length equal to <code class="reqn">n_p</code>, containing the maximum range of each parameter.</p>
</td></tr>
<tr><td><code id="params_se.AdPaik_+3A_dataset">dataset</code></td>
<td>
<p>Dataset containing the value of the regressors for all individuals in the study.</p>
</td></tr>
<tr><td><code id="params_se.AdPaik_+3A_centre">centre</code></td>
<td>
<p>vector containing the group membership of each individual and that induces the clustering subdivision.</p>
</td></tr>
<tr><td><code id="params_se.AdPaik_+3A_time_axis">time_axis</code></td>
<td>
<p>Temporal domain.
Its number of intervals corresponds to the length of the time-domain minus 1</p>
</td></tr>
<tr><td><code id="params_se.AdPaik_+3A_dropout_matrix">dropout_matrix</code></td>
<td>
<p>Binary matrix of dimension (n_individuals, n_intervals).
The sum of the elements of each row must be (1), if the associated individual failed in a precise interval, and (0) if the individual
did not fail in the @time-axis.
Therefore, if an individual failed in the time-domain, the interval in which he failed will have value (1) and the others (0).</p>
</td></tr>
<tr><td><code id="params_se.AdPaik_+3A_e_matrix">e_matrix</code></td>
<td>
<p>Matrix of dimension (n_individuals, n_intervals) where each element contains the resolution of the temporal
integral for that individual in that interval, thorugh the 'e_time_fun' function.</p>
</td></tr>
<tr><td><code id="params_se.AdPaik_+3A_h_dd">h_dd</code></td>
<td>
<p>Discretization step for the numerical approximation of the second derivative fo the loglikelihood function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The standrd error of each parameter is computed as the inverse of the square root of the 'Information matrix', that in turn
is computed as the opposite of the 'Hessian matrix'. Only its diagonal is built and its elements are separatey
evaluated through a numerical approximation of the second derivative of the log-likelihood function.
</p>
<p>The function requires the optimal parameter vector and other parameters-related variables, to check:
</p>

<ul>
<li><p> the right numerosity of the parameter vector
</p>
</li>
<li><p> the correct range existence of each parameter (i.e. each parameter lies in its range).
</p>
</li></ul>



<h3>Value</h3>

<p>Vector of parameter standard error, of length equal to the number of model parameters.
</p>

<hr>
<h2 id='plot_bas_hazard'>Plot the Baseline Hazard Step-Function</h2><span id='topic+plot_bas_hazard'></span>

<h3>Description</h3>

<p>This function plots the baseline hazard step-function based on the estimated parameters from the Adapted Paik et al.'s model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_bas_hazard(
  result,
  xlim = c(min(result$TimeDomain), max(result$TimeDomain)),
  ylim = c(0, max(result$BaselineHazard)),
  xlab = "Time",
  ylab = "Values",
  main = "Baseline hazard step-function",
  color = "black",
  pch = 21,
  bg = "black",
  cex_points = 0.7
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_bas_hazard_+3A_result">result</code></td>
<td>
<p>S3 object of class 'AdPaik', returned by the method call 'AdPaikModel(...)'.</p>
</td></tr>
<tr><td><code id="plot_bas_hazard_+3A_xlim">xlim</code></td>
<td>
<p>A numeric vector specifying the x-axis limits. Default is set to the interval min-max of the time-domain.</p>
</td></tr>
<tr><td><code id="plot_bas_hazard_+3A_ylim">ylim</code></td>
<td>
<p>A numeric vector specifying the y-axis limits. Default is 0 to the maximum value of the baseline hazard.</p>
</td></tr>
<tr><td><code id="plot_bas_hazard_+3A_xlab">xlab</code>, <code id="plot_bas_hazard_+3A_ylab">ylab</code></td>
<td>
<p>String giving the x and y axis name. Default values are 'x' and 'y'.</p>
</td></tr>
<tr><td><code id="plot_bas_hazard_+3A_main">main</code></td>
<td>
<p>Title of the plot. Default title is 'Baseline hazard step-function'.</p>
</td></tr>
<tr><td><code id="plot_bas_hazard_+3A_color">color</code></td>
<td>
<p>Color used for plotting the horizontal segments of the step-function. Default one is 'black'.</p>
</td></tr>
<tr><td><code id="plot_bas_hazard_+3A_pch">pch</code></td>
<td>
<p>Symbol for marking the boundaries of each segment. Default is a dot (value 21).</p>
</td></tr>
<tr><td><code id="plot_bas_hazard_+3A_bg">bg</code></td>
<td>
<p>Color for the boundary symbols. Default matches the plot color ('black').</p>
</td></tr>
<tr><td><code id="plot_bas_hazard_+3A_cex_points">cex_points</code></td>
<td>
<p>Size of the boundary symbols. Default is 0.7.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots a horizontal segment for each interval of the time domain, representing the baseline hazard.
The boundaries of each segment are marked with colored dots, and subsequent segments are intentionally left unconnected
to reflect the discrete nature of the intervals.
</p>


<h3>Value</h3>

<p>Plot of the baseline hazard step-function and value of the function in each interval.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import data
data(data_dropout)

# Define the variables needed for the model execution
eps_paik &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps_paik, eps_paik, eps_paik)
categories_range_max &lt;- c(-eps_paik, 0.4, 1 - eps_paik, 1, 10)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)


# Call the main model function
result &lt;- AdPaikModel(formula, data_dropout, time_axis, categories_range_min, categories_range_max)

plot_bas_hazard(result)

</code></pre>

<hr>
<h2 id='plot_frailty_sd'>Plot for the Frailty Standard Deviation or Variance</h2><span id='topic+plot_frailty_sd'></span>

<h3>Description</h3>

<p>This function generates a plot of either the frailty standard deviation or the frailty variance for the intervals in the time-domain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_frailty_sd(
  result,
  flag_variance = FALSE,
  flag_sd_external = FALSE,
  frailty_sd = NULL,
  xlim = c(min(result$TimeDomain), max(result$TimeDomain)),
  ylim = NULL,
  xlab = "Time",
  ylab = "Values",
  main = NULL,
  pch = 21,
  color_bg = "blue",
  cex_points = 0.7
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_frailty_sd_+3A_result">result</code></td>
<td>
<p>An S3 object of class 'AdPaik', returned by the main model call 'AdPaikModel(...)'.</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_flag_variance">flag_variance</code></td>
<td>
<p>A boolean flag indicating whether to plot the frailty variance (<code>TRUE</code>) or the frailty standard deviation (<code>FALSE</code>). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_flag_sd_external">flag_sd_external</code></td>
<td>
<p>A logical flag indicating whether the user is providing an external frailty standard deviation vector.</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_frailty_sd">frailty_sd</code></td>
<td>
<p>A numerical vector representing the evaluated frailty standard deviation, with length equal to the number of time-domain intervals.
Its elements must be non-negative. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_xlim">xlim</code></td>
<td>
<p>A numeric vector specifying the range for the x-axis (intervals). If NULL, default is set to the interval min-max of the time-domain.</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_ylim">ylim</code></td>
<td>
<p>A numeric vector specifying the range for the y-axis (intervals). If NULL, default is 0 to the maximum value of the frailty variance/standard deviation.</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_xlab">xlab</code></td>
<td>
<p>A string for the x-axis label. Default is <code>'Intervals'</code>.</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_ylab">ylab</code></td>
<td>
<p>A string for the y-axis label. Default is <code>'Values'</code>.</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_main">main</code></td>
<td>
<p>A string for the plot title. Default title is <code>'Frailty Standard Deviation'</code> or <code>'Frailty Variance'</code> according to the produced plot (flag_variance).</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_pch">pch</code></td>
<td>
<p>A numeric or character symbol used for plotting the frailty standard deviation values. Default is a dot (<code>21</code>).</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_color_bg">color_bg</code></td>
<td>
<p>A string specifying the color used for the symbols. Default is <code>'blue'</code>.</p>
</td></tr>
<tr><td><code id="plot_frailty_sd_+3A_cex_points">cex_points</code></td>
<td>
<p>A numeric value indicating the size of the plotting symbols. Default is <code>0.7</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot represents the values of the frailty standard deviation or variance for each time interval (represented by its mid point).
It connects these points to illustrate the trend of the chosen metric.
</p>
<p>This function supports two modes of operation:
</p>

<ul>
<li><p> Plotting the frailty standard deviation or variance retrieved from the main model (contained in the S3 object of class 'AdPaik').
</p>
</li>
<li><p> Plotting a user-provided vector of frailty standard deviations, which can be computed using the method <code>frailty.sd</code>. This allows for flexibility in analysis without re-optimizing the log-likelihood function. For instance, users can compare frailty standard deviations computed with different model specifications (e.g., including only time-dependent terms).
</p>
</li></ul>

<p>The output will differentiate between these two cases, ensuring the correct values are plotted regardless of the source.
</p>


<h3>Value</h3>

<p>A plot displaying either the frailty standard deviation or variance across the specified intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import data
data(data_dropout)

# Define the variables needed for the model execution
eps_paik &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps_paik, eps_paik, eps_paik)
categories_range_max &lt;- c(-eps_paik, 0.4, 1 - eps_paik, 1, 10)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)

# Call the main model function

result &lt;- AdPaikModel(formula, data_dropout, time_axis, categories_range_min, categories_range_max)

plot_frailty_sd(result)

</code></pre>

<hr>
<h2 id='plot_ll_1D'>Plot the One-Dimensional Log-Likelihood Function</h2><span id='topic+plot_ll_1D'></span>

<h3>Description</h3>

<p>This function plots the trend of the log-likelihood function concerning a single parameter specified by its index in the parameter vector.
It generates samples of the parameter, evaluates them in the log-likelihood function, and displays the results along with the maximum point of the one-dimensional log-likelihood function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ll_1D(
  param_1D,
  index_param_1D,
  ll_1D,
  params,
  param_range_min,
  param_range_max,
  dataset,
  centre,
  time_axis,
  dropout_matrix,
  e_matrix,
  n_points = 150,
  cex = 0.7,
  cex_max = 0.8,
  color_bg = "black",
  color_max_bg = "red",
  pch = 21
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ll_1D_+3A_param_1d">param_1D</code></td>
<td>
<p>A numeric value representing the optimal parameter determined by maximizing the log-likelihood function for the specified parameter.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_index_param_1d">index_param_1D</code></td>
<td>
<p>An integer representing the index of the optimal parameter within the parameter vector.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_ll_1d">ll_1D</code></td>
<td>
<p>A numeric value of the log-likelihood function evaluated at the optimal parameter <code>param_1D</code>, with the other parameters held constant.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_params">params</code></td>
<td>
<p>A numeric vector of length equal to the number of parameters minus one, containing the fixed values for the other parameters.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_param_range_min">param_range_min</code></td>
<td>
<p>A numeric value indicating the minimum allowable value for the parameter <code>param_1D</code>.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_param_range_max">param_range_max</code></td>
<td>
<p>A numeric value indicating the maximum allowable value for the parameter <code>param_1D</code>.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_dataset">dataset</code></td>
<td>
<p>A data frame or matrix containing individual covariates.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_centre">centre</code></td>
<td>
<p>A numeric vector indicating individual cluster membership; its length must match the number of individuals in the dataset.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_time_axis">time_axis</code></td>
<td>
<p>A numeric vector corresponding to the subdivisions of the temporal domain.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_dropout_matrix">dropout_matrix</code></td>
<td>
<p>A binary matrix indicating which interval of the time domain an individual failed. Each row should sum to 1 (if failed) or 0 (if not failed), with dimensions (n_individuals, n_intervals).</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_e_matrix">e_matrix</code></td>
<td>
<p>A matrix of dimensions (n_individuals, n_intervals), where each element contains the evaluation of the temporal integral performed by the function <code>time_int_eval</code>.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_n_points">n_points</code></td>
<td>
<p>An integer specifying the number of points at which to evaluate the log-likelihood function. A value that is neither too small nor too high is recommended; the default is 150.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_cex">cex</code></td>
<td>
<p>A numeric value specifying the size of the points used for the graphical representation of the log-likelihood function. Default is 0.7.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_cex_max">cex_max</code></td>
<td>
<p>A numeric value indicating the size of the optimal point (the one maximizing the log-likelihood function). Default is 0.8.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_color_bg">color_bg</code></td>
<td>
<p>A string specifying the color for the points representing the log-likelihood trend. Default is <code>'black'</code>.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_color_max_bg">color_max_bg</code></td>
<td>
<p>A string specifying the color for the optimal point provided as the first argument. Default is <code>'red'</code>.</p>
</td></tr>
<tr><td><code id="plot_ll_1D_+3A_pch">pch</code></td>
<td>
<p>A numeric or character symbol representing the shape of the plotted points. Default is a circle (<code>21</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot displaying the trend of the log-likelihood function concerning a single parameter, including the maximum point.
</p>

<hr>
<h2 id='plot_ll_1D.AdPaik'>Plot the One-Dimensional Log-Likelihood Function</h2><span id='topic+plot_ll_1D.AdPaik'></span>

<h3>Description</h3>

<p>This function plots the trend of the log-likelihood function with respect to a single parameter specified by its index in the parameter vector.
It generates samples of the parameter, evaluates them in the log-likelihood function, and displays the results along with the maximum point of the one-dimensional log-likelihood function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ll_1D.AdPaik(
  param_1D,
  index_param_1D,
  ll_1D,
  params,
  param_range_min,
  param_range_max,
  dataset,
  centre,
  time_axis,
  dropout_matrix,
  e_matrix,
  n_points = 150,
  cex = 0.7,
  cex_max = 0.8,
  color_bg = "black",
  color_max_bg = "red",
  pch = 21
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ll_1D.AdPaik_+3A_param_1d">param_1D</code></td>
<td>
<p>A numeric value representing the optimal parameter determined by maximizing the log-likelihood function for the specified parameter.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_index_param_1d">index_param_1D</code></td>
<td>
<p>An integer representing the index of the optimal parameter within the parameter vector.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_ll_1d">ll_1D</code></td>
<td>
<p>A numeric value of the log-likelihood function evaluated at the optimal parameter <code>param_1D</code>, with other parameters held constant.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_params">params</code></td>
<td>
<p>A numeric vector of length equal to the number of parameters minus one, containing fixed values for the other parameters.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_param_range_min">param_range_min</code></td>
<td>
<p>A numeric value indicating the minimum allowable value for the parameter <code>param_1D</code>.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_param_range_max">param_range_max</code></td>
<td>
<p>A numeric value indicating the maximum allowable value for the parameter <code>param_1D</code>.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_dataset">dataset</code></td>
<td>
<p>A data frame or matrix containing individual covariates.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_centre">centre</code></td>
<td>
<p>A numeric vector indicating individual cluster membership; its length must match the number of individuals in the dataset.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_time_axis">time_axis</code></td>
<td>
<p>A numeric vector corresponding to the subdivisions of the temporal domain.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_dropout_matrix">dropout_matrix</code></td>
<td>
<p>A binary matrix indicating which interval of the time domain an individual failed. Each row should sum to 1 (if failed) or 0 (if not failed), with dimensions (n_individuals, n_intervals).</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_e_matrix">e_matrix</code></td>
<td>
<p>A matrix of dimensions (n_individuals, n_intervals) where each element contains the evaluation of the temporal integral performed by the function <code>time_int_eval</code>.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_n_points">n_points</code></td>
<td>
<p>An integer specifying the number of points at which to evaluate the log-likelihood function. A value that is neither too small nor too high is recommended; the default is 150.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_cex">cex</code></td>
<td>
<p>A numeric value specifying the size of the points used for the graphical representation of the log-likelihood function. Default is 0.7.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_cex_max">cex_max</code></td>
<td>
<p>A numeric value indicating the size of the optimal point (the one maximizing the log-likelihood function). Default is 0.8.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_color_bg">color_bg</code></td>
<td>
<p>A string specifying the color for the points representing the log-likelihood trend. Default is <code>'black'</code>.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_color_max_bg">color_max_bg</code></td>
<td>
<p>A string specifying the color for the optimal point provided as the first argument. Default is <code>'red'</code>.</p>
</td></tr>
<tr><td><code id="plot_ll_1D.AdPaik_+3A_pch">pch</code></td>
<td>
<p>A numeric or character symbol representing the shape of the plotted points. Default is a circle (<code>21</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot displaying the trend of the log-likelihood function with respect to a single parameter, including the maximum point.
</p>

<hr>
<h2 id='plot_post_frailty_est'>Plot the Posterior Frailty Estimates</h2><span id='topic+plot_post_frailty_est'></span>

<h3>Description</h3>

<p>This function plots the posterior frailty estimates for each group in each time interval (represented by its mid point).
Each groupâ€™s estimates are represented by a sequence of points connected by straight lines.
The function can plot either the entire posterior frailty estimate or
its time-independent and time-dependent components based on user-specified flags.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_post_frailty_est(
  result,
  data,
  flag_eps = FALSE,
  flag_alpha = FALSE,
  xlim = NULL,
  ylim = NULL,
  xlab = "Time",
  ylab = "Values",
  main = "Posterior frailty estimates",
  cex = 0.7,
  pch_type = rep(21, length(centre_codes)),
  color_bg = rep("black", length(centre_codes)),
  cex_legend = 0.7,
  pos_legend = "topright"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_post_frailty_est_+3A_result">result</code></td>
<td>
<p>S3 object of class 'AdPaik', returned by the method call 'AdPaikModel(...)'.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_data">data</code></td>
<td>
<p>Dataset (dataframe) in which all variables of the formula object must be found and contained.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_flag_eps">flag_eps</code></td>
<td>
<p>Logical flag indicating whether to plot only the time-dependent posterior frailty estimates. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_flag_alpha">flag_alpha</code></td>
<td>
<p>Logical flag indicating whether to plot only the time-independent posterior frailty estimates. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_xlim">xlim</code></td>
<td>
<p>A numeric vector specifying the range for the x-axis (intervals). If NULL, default is set to the interval min-max of the time-domain, plus space for the legend.
If flag_alpha = TRUE, the plot is produced around 1 (defaults to 0.8-1.4).</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_ylim">ylim</code></td>
<td>
<p>A numeric vector specifying the range for the y-axis (intervals). If NULL, default is min-max value of the posterior frailty estimate.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_xlab">xlab</code>, <code id="plot_post_frailty_est_+3A_ylab">ylab</code></td>
<td>
<p>String giving the x and y axis name. Default values are 'Time' and 'Values'.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_main">main</code></td>
<td>
<p>Title of the plot. Default title is 'Posterior frailty estimates'.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_cex">cex</code></td>
<td>
<p>Dimension of the points used for plotting the estimates.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_pch_type">pch_type</code></td>
<td>
<p>Numerical vector of length equal to the number of clusters in the data, giving the symbol to be used for plotting the estimates.
Default symbol (circle, 21) is the same for all clusters.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_color_bg">color_bg</code></td>
<td>
<p>Numerical vector of length equal to the number of clusters in the data, giving the color to be used for plotting the symbols
for the estimates. Default ('black') is the same for all faculties. On the other hand, the same color is used throughout the intervals for
the same faculty.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_cex_legend">cex_legend</code></td>
<td>
<p>Dimension of the symbol in the legend. Default is 0.7.</p>
</td></tr>
<tr><td><code id="plot_post_frailty_est_+3A_pos_legend">pos_legend</code></td>
<td>
<p>Either a numeric vector providing the x and y coordinates for the legend or
a string specifying the legend's position (e.g., 'bottomright', 'bottom', 'bottomleft', 'left',
'topleft', 'top', 'topright', 'right', 'center').</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Recalling the frailty structure as <code class="reqn">Z_{jk} = \alpha_{j} + \epsilon_{jk}, \forall j,k</code> and the posterior
frailty estimate as <code class="reqn">\hat{Z}_{jk} = \hat{\alpha}_{j}/\hat{\alpha}_{max} + \hat{\epsilon}_{jk}/\hat{\epsilon}_{max}</code>,
this function allows plotting either the entire posterior frailty estimate <code class="reqn">\hat{Z}_{jk}</code>
or its time-independent <code class="reqn">\frac{\hat{\alpha}_{j}}{\hat{\alpha}_{\text{max}}}</code> or
time-dependent <code class="reqn">\frac{\hat{\epsilon}_{jk}}{\hat{\epsilon}_{\text{max}}}</code> components.
The user can control which components to display using the flag_eps and flag_alpha parameters.
Only one of these flags can be set to TRUE at a time.
</p>


<h3>Value</h3>

<p>The plot of the posterior frailty estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import data
data(data_dropout)

# Define the variables needed for the model execution
eps_paik &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps_paik, eps_paik, eps_paik)
categories_range_max &lt;- c(-eps_paik, 0.4, 1 - eps_paik, 1, 10)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)

# Call the main model function


result &lt;- AdPaikModel(formula, data_dropout, time_axis, categories_range_min, categories_range_max)

# Define variables for plotting the estimates
pch_type &lt;- c(21, seq(21,25,1), seq(21,25,1), seq(21,25,1))
color_bg &lt;- c("darkblue", rep("red", 5), rep("purple", 5), rep("green",5))

plot_post_frailty_est(result, data_dropout,
                      pch_type = pch_type, color_bg = color_bg)
                      
</code></pre>

<hr>
<h2 id='plot_survival'>Plot of Conditional Survival Function</h2><span id='topic+plot_survival'></span>

<h3>Description</h3>

<p>Plots the conditional survival function based on the 'Adapted Paik et al.' model's
estimated coefficients and frailty effects, for each unit in each time interval (represented by its mid point).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_survival(
  result,
  survival_df,
  lwd = 1,
  xlim = c(min(result$TimeDomain), max(result$TimeDomain)),
  ylim = c(0, 1),
  xlab = "Time",
  ylab = "Values",
  main = "Conditional Survival",
  cex = 0.2,
  cexlegend = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_survival_+3A_result">result</code></td>
<td>
<p>S3 object of class 'AdPaik' containing model results.</p>
</td></tr>
<tr><td><code id="plot_survival_+3A_survival_df">survival_df</code></td>
<td>
<p>The dataframe returned by 'survival' function,
where each row corresponds to the survival function values
over the time intervals for each individual in the dataset.
The first column represents the cluster to which the individual belongs.</p>
</td></tr>
<tr><td><code id="plot_survival_+3A_lwd">lwd</code></td>
<td>
<p>The line width of the plot. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_survival_+3A_xlim">xlim</code></td>
<td>
<p>A numeric vector specifying the range for the x-axis (intervals). Default is min-max value of the time domain.</p>
</td></tr>
<tr><td><code id="plot_survival_+3A_ylim">ylim</code></td>
<td>
<p>A numeric vector specifying the range for the y-axis (intervals). Default is the range 0-1.</p>
</td></tr>
<tr><td><code id="plot_survival_+3A_xlab">xlab</code>, <code id="plot_survival_+3A_ylab">ylab</code></td>
<td>
<p>String giving the x and y axis name. Default values are 'Time' and 'Values'.</p>
</td></tr>
<tr><td><code id="plot_survival_+3A_main">main</code></td>
<td>
<p>Title of the plot. Default title is 'Survival'.</p>
</td></tr>
<tr><td><code id="plot_survival_+3A_cex">cex</code></td>
<td>
<p>Dimension of the points used for plotting the estimates. Defaults to 0.2.</p>
</td></tr>
<tr><td><code id="plot_survival_+3A_cexlegend">cexlegend</code></td>
<td>
<p>Dimension of the text used for the legend. Defaults to 0.9.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The plot of the conditional survival function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import data
data(data_dropout)

# Define the variables needed for the model execution
eps_paik &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps_paik, eps_paik, eps_paik)
categories_range_max &lt;- c(-eps_paik, 0.4, 1 - eps_paik, 1, 10)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)

# Call the main model function

result &lt;- AdPaikModel(formula, data_dropout, time_axis, categories_range_min, categories_range_max)

survival_df = survival(result, data_dropout)
plot_survival(result, survival_df)
  
</code></pre>

<hr>
<h2 id='post_frailty_CI.AdPaik'>Confidence interval for posterior frailty estimates</h2><span id='topic+post_frailty_CI.AdPaik'></span>

<h3>Description</h3>

<p>Function for computing the confidence interval for each posterior frailty estimates <code class="reqn">\hat{Z}_{jk}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_frailty_CI.AdPaik(
  post_frailty_est,
  post_frailty_est_var,
  n_centres,
  n_intervals,
  level
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="post_frailty_CI.AdPaik_+3A_post_frailty_est">post_frailty_est</code></td>
<td>
<p>Posterior frailty estimates list.</p>
</td></tr>
<tr><td><code id="post_frailty_CI.AdPaik_+3A_post_frailty_est_var">post_frailty_est_var</code></td>
<td>
<p>Posterior frailty variance list.</p>
</td></tr>
<tr><td><code id="post_frailty_CI.AdPaik_+3A_n_centres">n_centres</code></td>
<td>
<p>Number of clusters/centres.</p>
</td></tr>
<tr><td><code id="post_frailty_CI.AdPaik_+3A_n_intervals">n_intervals</code></td>
<td>
<p>Number of intervals of the time-domain. it is equal to the length of the tima_axis minus one.</p>
</td></tr>
<tr><td><code id="post_frailty_CI.AdPaik_+3A_level">level</code></td>
<td>
<p>A numeric value representing the confidence level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object of class 'PFCI.AdPaik' composed of two matrices of dimension (number groups, number of intervals):
</p>

<ul>
<li><p> PostFrailtyCI_left: left confidence interval for each posterior frailty estimates
</p>
</li>
<li><p> PostFrailtyCI_right: right confidence interval for each each posterior frailty estimates
</p>
</li></ul>


<hr>
<h2 id='post_frailty.AdPaik'>Posterior frailty estimates and variances for the 'Adapted Paik et al.'s Model'</h2><span id='topic+post_frailty.AdPaik'></span>

<h3>Description</h3>

<p>Function for computing the posterior frailty estimates and variances of the time-dependent shared frailty Cox model.
Recalling the structure of the frailty <code class="reqn">Z_{jk} = \alpha_j + \epsilon_{jk}, \forall j,k</code> as being composed by the sum
of two independent gamma distributions:
</p>

<ul>
<li> <p><code class="reqn">\alpha_j \sim gamma(\mu_1/\nu, 1/\nu), \forall j</code>
</p>
</li>
<li> <p><code class="reqn">\epsilon_{jk} \sin gamma(\mu_2/\gamma_k, 1/\gamma_k), \forall j,k</code>
the posterior distribution of both terms is still a gamma with different mean and variance and the
posterior frailty estimate corresponds to the 'empirical Bayes estimate', that is the previous mentioned posterior mean.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>post_frailty.AdPaik(optimal_params, dataset, time_to_event, centre, time_axis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="post_frailty.AdPaik_+3A_optimal_params">optimal_params</code></td>
<td>
<p>Optimal parameters estimated by maximizing the log-likelihood function, through the constraint
multi-dimensional optmization method.</p>
</td></tr>
<tr><td><code id="post_frailty.AdPaik_+3A_dataset">dataset</code></td>
<td>
<p>Dataset containing all the covariates/regressors.</p>
</td></tr>
<tr><td><code id="post_frailty.AdPaik_+3A_time_to_event">time_to_event</code></td>
<td>
<p>Time-instant, in the follow-up, in which an individual faces the event or fails.
If an individual does not face the event in the follow-up, then the time-instant must assume a default value.</p>
</td></tr>
<tr><td><code id="post_frailty.AdPaik_+3A_centre">centre</code></td>
<td>
<p>Individual group/cluster membership.</p>
</td></tr>
<tr><td><code id="post_frailty.AdPaik_+3A_time_axis">time_axis</code></td>
<td>
<p>Temporal domain.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object of class 'PF.AdPaik' composed of two elements of different class:
</p>

<ul>
<li><p> PosteriorFrailtyEst: S3 object of class 'PFE.AdPaik'.
</p>
</li>
<li><p> PosteriorFrailtyVar: S3 object of class 'PFV.AdPaik'.
</p>
</li></ul>


<hr>
<h2 id='summary'>Summary for Time-Dependent Frailty Models</h2><span id='topic+summary'></span>

<h3>Description</h3>

<p>This function displays a summary of the model output based on the class of the result object.
It delegates to the appropriate summary method according to the class of the result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary(result)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_+3A_result">result</code></td>
<td>
<p>An object containing the output of the model call.
The class of this object determines which summary method is invoked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary of the model output printed to the console.
</p>

<hr>
<h2 id='summary.AdPaik'>Summary of the Adapted Paik et al.'s Time-Dependent Shared Frailty Model</h2><span id='topic+summary.AdPaik'></span>

<h3>Description</h3>

<p>This function provides a comprehensive summary of the results from the Adapted Paik et al.'s Time-Dependent Shared Frailty Model.
It includes key information about the dataset (e.g., number of individuals, regressors, intervals, and clusters), model parameters,
and output (log-likelihood, AIC). The summary also lists the estimated regressors along with their standard errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AdPaik'
summary(result)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.AdPaik_+3A_result">result</code></td>
<td>
<p>'S3' class object returned by the main model call, i.e. output of the 'Adapted Paik et al.'s Model'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function reports the estimated regressors, their standard errors, and confidence intervals (if available).
</p>


<h3>Value</h3>

<p>Model summary printed on output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the variables needed for the model execution

data(data_dropout)
eps_paik &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps_paik, eps_paik, eps_paik)
categories_range_max &lt;- c(-eps_paik, 0.4, 1 - eps_paik, 1, 10)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)


# Call the main model function
result &lt;- AdPaikModel(formula, data_dropout, time_axis, categories_range_min, categories_range_max)

# Call the summary
summary(result)

</code></pre>

<hr>
<h2 id='survival'>Compute the Conditional Survival Function</h2><span id='topic+survival'></span>

<h3>Description</h3>

<p>Computes the conditional survival function based on the 'Adapted Paik et al.' model's
given the estimated coefficients and frailty effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survival(result, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survival_+3A_result">result</code></td>
<td>
<p>S3 object of class 'AdPaik' containing model results.</p>
</td></tr>
<tr><td><code id="survival_+3A_data">data</code></td>
<td>
<p>Data frame containing covariates used in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataset where each row corresponds to an individual unit in the dataset,
and the columns represent the survival function values over time interval,
with the first column indicating the cluster to which the individual belongs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import data
data(data_dropout)

# Define the variables needed for the model execution
eps_paik &lt;- 1e-10
categories_range_min &lt;- c(-8, -2, eps_paik, eps_paik, eps_paik)
categories_range_max &lt;- c(-eps_paik, 0.4, 1 - eps_paik, 1, 10)
time_axis &lt;- c(1.0, 1.4, 1.8, 2.3, 3.1, 3.8, 4.3, 5.0, 5.5, 5.8, 6.0)
formula &lt;- time_to_event ~ Gender + CFUP + cluster(group)

# Call the main model function

result &lt;- AdPaikModel(formula, data_dropout, time_axis, categories_range_min, categories_range_max)

survival_df = survival(result, data_dropout)
   
</code></pre>

<hr>
<h2 id='time_int_eval'>Resolution of integral with respect to time</h2><span id='topic+time_int_eval'></span>

<h3>Description</h3>

<p>Function for the resolution of an integral with respect to time,
in the evaluation of the log-likelihood function.
It is implemented as defined in the paper of Wintrebert et al.'s (2004)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_int_eval(time_t, k, time_axis)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="time_int_eval_+3A_time_t">time_t</code></td>
<td>
<p>Event time instant</p>
</td></tr>
<tr><td><code id="time_int_eval_+3A_k">k</code></td>
<td>
<p>k-th interval of the time-axis</p>
</td></tr>
<tr><td><code id="time_int_eval_+3A_time_axis">time_axis</code></td>
<td>
<p>Temporal domain (it may coincide with the follow-up)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Evaluation of the temporal integral
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
