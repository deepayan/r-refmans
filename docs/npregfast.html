<!DOCTYPE html><html lang="en"><head><title>Help for package npregfast</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {npregfast}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#allotest'><p>Bootstrap based test for testing an allometric model</p></a></li>
<li><a href='#autoplot.frfast'><p>Visualization of <code>frfast</code> objects with ggplot2 graphics</p></a></li>
<li><a href='#barnacle'><p>Barnacle dataset.</p></a></li>
<li><a href='#children'><p>Children dataset.</p></a></li>
<li><a href='#critical'><p>Critical points of the regression function</p></a></li>
<li><a href='#criticaldiff'><p>Differences between the critical points</p>
for two factor's levels</a></li>
<li><a href='#frfast'><p>Fitting nonparametric models</p></a></li>
<li><a href='#globaltest'><p>Testing the equality of the <em>M</em> curves specific to each level</p></a></li>
<li><a href='#localtest'><p>Testing the equality of critical points</p></a></li>
<li><a href='#plot.frfast'><p>Visualization of <code>frfast</code> objects with the base graphics</p></a></li>
<li><a href='#predict.frfast'><p>Prediction from fitted <code>frfast</code> model</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#runExample'><p>Run npregfast example</p></a></li>
<li><a href='#summary.frfast'><p>Summarizing fits of <code>frfast</code> class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Estimation of Regression Models with
Factor-by-Curve Interactions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-01</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marta Sestelo &lt;sestelo@uvigo.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A method for obtaining nonparametric estimates of regression models
    with or without factor-by-curve interactions using local polynomial kernel
    smoothers or splines. Additionally, a parametric model (allometric model) can be
    estimated.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sestelo/npregfast/issues">https://github.com/sestelo/npregfast/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>gridExtra</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, utils, shiny, doParallel, foreach, mgcv,
sfsmisc, shinyjs, wesanderson, ggplot2</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-02 11:18:56 UTC; sestelo</td>
</tr>
<tr>
<td>Author:</td>
<td>Marta Sestelo <a href="https://orcid.org/0000-0003-4284-6509"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Nora M. Villanueva [aut],
  Javier Roca-Pardinas [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-02 12:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='allotest'>Bootstrap based test for testing an allometric model</h2><span id='topic+allotest'></span>

<h3>Description</h3>

<p>Bootstrap-based procedure that tests whether the data 
can be modelled by an allometric model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allotest(
  formula,
  data,
  na.action = "na.omit",
  nboot = 500,
  seed = NULL,
  cluster = TRUE,
  ncores = NULL,
  test = "res",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="allotest_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>formula</code>: a sympbolic description
of the model to be fitted.</p>
</td></tr>
<tr><td><code id="allotest_+3A_data">data</code></td>
<td>
<p>An optional data frame, matrix or list required by 
the formula. If not found in data, the variables are taken from 
<code>environment(formula)</code>, typically the environment from which
<code>allotest</code> is called.</p>
</td></tr>
<tr><td><code id="allotest_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the 
data contain 'NA's. The default is 'na.omit'.</p>
</td></tr>
<tr><td><code id="allotest_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repeats.</p>
</td></tr>
<tr><td><code id="allotest_+3A_seed">seed</code></td>
<td>
<p>Seed to be used in the bootstrap procedure.</p>
</td></tr>
<tr><td><code id="allotest_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If  <code>TRUE</code> (default), the
bootstrap procedure is  parallelized (only for <code>smooth = "splines"</code>).
Note that there are cases 
(e.g., a low number of bootstrap repetitions) that R will gain in
performance through serial computation. R takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing, it does
not worth parallelize.</p>
</td></tr>
<tr><td><code id="allotest_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used
in the parallelized procedure. If <code>NULL</code> (default), the number of cores 
to be used is equal to the number of cores of the machine - 1.</p>
</td></tr>
<tr><td><code id="allotest_+3A_test">test</code></td>
<td>
<p>Statistic test to be used, based on residuals on the null model
(<code>res</code>) or based on the likelihood ratio test 
using rss0 and rss1 <code>lrt</code>.</p>
</td></tr>
<tr><td><code id="allotest_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to facilitate the choice of a model appropriate
to the data while at the same time endeavouring to minimise the 
loss of information,  a bootstrap-based procedure, that test whether the 
data can be modelled by an allometric model, was developed.  Therefore,
<code>allotest</code> tests the null hypothesis of an allometric model taking 
into account the logarithm of the original variable
(<code class="reqn">X^* = log(X)</code> and <code class="reqn">Y^* = log(Y)</code>). 
</p>
<p>Based on a general model of the type 
</p>
<p style="text-align: center;"><code class="reqn">Y^*=m(X^*)+\varepsilon</code>
</p>

<p>the aim here is to test the null hypothesis of an allometric model 
</p>
<p style="text-align: center;"><code class="reqn">H_0 = m(x^*) =  a^*+ b^* x^*</code>
</p>

<p><code class="reqn">vs.</code> the general hypothesis 
<code class="reqn">H_1</code>, with <code class="reqn">m</code>
being an unknown nonparametric function; or analogously,
</p>
<p style="text-align: center;"><code class="reqn">H_1: m(x^*)= a^*+ b^* x^* + g(x^*)</code>
</p>

<p>with <code class="reqn">g(x^*)</code> being an unknown function not equal to zero. 
</p>
<p>To implement this test we have used the wild bootstrap.
</p>


<h3>Value</h3>

<p>An object is returned with the following elements:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>References</h3>

<p>Sestelo, M. and Roca-Pardinas, J. (2011). A new approach to estimation of 
length-weight relationship of <code class="reqn">Pollicipes</code>  <code class="reqn">pollicipes</code> (Gmelin, 1789)
on the Atlantic coast of Galicia (Northwest Spain): some aspects of its 
biology and management. Journal of Shellfish Research, 30 (3), 939&ndash;948.
</p>
<p>Sestelo, M. (2013). Development and computational implementation of 
estimation and inference methods in flexible regression models. 
Applications in Biology, Engineering and Environment. PhD Thesis, Department
of Statistics and O.R. University of Vigo.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(npregfast)
data(barnacle)
allotest(DW ~ RC, data = barnacle, nboot = 50, seed = 130853, 
cluster = FALSE)

</code></pre>

<hr>
<h2 id='autoplot.frfast'>Visualization of <code>frfast</code> objects with ggplot2 graphics</h2><span id='topic+autoplot.frfast'></span>

<h3>Description</h3>

<p>Useful for drawing the estimated regression function, 
first and second derivative (for each factor's level) using ggplot2 graphics.
Additionally, with the 
<code>diffwith</code> argument it is possible to draw the differences between
two factor's levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'frfast'
autoplot(
  object = model,
  fac = NULL,
  der = 0,
  diffwith = NULL,
  points = TRUE,
  xlab = model$name[2],
  ylab = model$name[1],
  ylim = NULL,
  main = NULL,
  col = "black",
  CIcol = "black",
  CIlinecol = "transparent",
  pcol = "grey80",
  abline = TRUE,
  ablinecol = "red",
  lty = 1,
  CIlty = 2,
  lwd = 1,
  CIlwd = 1,
  cex = 1.4,
  alpha = 0.2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoplot.frfast_+3A_object">object</code></td>
<td>
<p><code>frfast</code> object.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_fac">fac</code></td>
<td>
<p>Factor's level to be taken into account
in the plot. By default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_der">der</code></td>
<td>
<p>Number which determines any inference process. 
By default <code>der</code> is <code>0</code>. If this term is <code>0</code>, the plot 
shows the initial estimate. If it is <code>1</code> or <code>2</code>,
it is designed for the first or second derivative, respectively.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_diffwith">diffwith</code></td>
<td>
<p>Factor's level used for drawing the differences respect to the 
level specified in the <code>fac</code> argument.  By default, <code>NULL</code>. 
The differences are computed for the r-th derivative specified 
in the <code>der</code> argument.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_points">points</code></td>
<td>
<p>Draw the original data into the plot. By default it is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_xlab">xlab</code></td>
<td>
<p>A title for the <code>x</code> axis.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_ylab">ylab</code></td>
<td>
<p>A title for the <code>y</code> axis.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_ylim">ylim</code></td>
<td>
<p>The <code>y</code> limits of the plot.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_main">main</code></td>
<td>
<p>An overall title for the plot.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_col">col</code></td>
<td>
<p>A specification for the default plotting color.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_cicol">CIcol</code></td>
<td>
<p>A specification for the default confidence intervals
plotting color (for the fill).</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_cilinecol">CIlinecol</code></td>
<td>
<p>A specification for the default confidence intervals
plotting color (for the edge).</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_pcol">pcol</code></td>
<td>
<p>A specification for the points color.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_abline">abline</code></td>
<td>
<p>Draw an horizontal line into the plot of the second derivative 
of the model.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_ablinecol">ablinecol</code></td>
<td>
<p>The color to be used for <code>abline</code>.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_lty">lty</code></td>
<td>
<p>The line type. Line types can either be specified as an integer
(0 = blank, 1 = solid (default), 2 = dashed, 3 = dotted, 4 = dotdash, 
5 = longdash, 6 = twodash).  See details in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_cilty">CIlty</code></td>
<td>
<p>The line type for confidence intervals. Line types can either 
be specified as an integer (0 = blank, 1 = solid (default), 2 = dashed,
3 = dotted, 4 = dotdash, 5 = longdash, 6 = twodash).</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_lwd">lwd</code></td>
<td>
<p>The line width, a positive number, defaulting to 1.
See details in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_cilwd">CIlwd</code></td>
<td>
<p>The line width for confidence intervals, a positive number, 
defaulting to 1.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_cex">cex</code></td>
<td>
<p>A numerical value giving the amount by which plotting symbols
should be magnified relative to the default. See details in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_alpha">alpha</code></td>
<td>
<p>Alpha transparency for overlapping elements expressed 
as a fraction between 0 (complete transparency) and 1 (complete opacity).</p>
</td></tr>
<tr><td><code id="autoplot.frfast_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object, so you can use common features from 
ggplot2 package to manipulate the plot.
</p>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(npregfast)
library(ggplot2)


data(barnacle)

# Nonparametric regression without interactions
fit &lt;- frfast(DW ~ RC, data = barnacle, nboot = 50) 
autoplot(fit)
autoplot(fit, points = FALSE) + ggtitle("Title")
autoplot(fit, der = 1) + xlim(4, 20)
#autoplot(fit, der = 1, col = "red", CIcol = "blue")

# Nonparametric regression with interactions
fit2 &lt;- frfast(DW ~ RC : F, data = barnacle, nboot = 50) 
autoplot(fit2, fac = "barca")
# autoplot(fit2, der = 1, fac = "lens")

# Visualization of the differences between two factor's levels
autoplot(fit2, fac = "barca", diffwith = "lens")
# autoplot(fit2, der = 1, fac = "barca", diffwith = "lens")


#Plotting in the same graphics device
## Not run: 

if (requireNamespace("gridExtra", quietly = TRUE)) {

# For plotting two derivatives in the same graphic windows
ders &lt;- lapply(0:1, function(x) autoplot(fit, der = x))
gridExtra::grid.arrange(grobs = ders, ncol = 2, nrow = 1)

# For plotting two levels in the same graphic windows
facs &lt;- lapply(c("barca", "lens"), function(x) autoplot(fit2, der = 0, fac = x))
gridExtra::grid.arrange(grobs = facs, ncol = 2, nrow = 1)

}


## End(Not run)

</code></pre>

<hr>
<h2 id='barnacle'>Barnacle dataset.</h2><span id='topic+barnacle'></span>

<h3>Description</h3>

<p>This barnacle data set gives the measurements of the variables 
dry weight (in g.) and rostro-carinal lenght (in mm) for 2000 barnacles 
collected along the intertidal zone from two sites of the Atlantic coast of Galicia (Spain).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>barnacle
</code></pre>


<h3>Format</h3>

<p><code>barnacle</code> is a data frame with 2000 cases (rows) and 
3 variables (columns).
</p>

<dl>
<dt>DW</dt><dd><p>Dry weight (in g.)</p>
</dd> 
<dt>RC</dt><dd><p>Rostro-carinal lenght (in mm).</p>
</dd>
<dt>F</dt><dd><p>Factor indicating the sites of harvest: <code>barca</code> and <code>lens</code>.</p>
</dd>
</dl>



<h3>References</h3>

<p>Sestelo, M. and Roca-Pardinas, J. (2011). A new approach to estimation of 
length-weight relationship of <code class="reqn">Pollicipes</code>  <code class="reqn">pollicipes</code> 
(Gmelin, 1789) on the Atlantic coast of Galicia (Northwest Spain): some 
aspects of its biology and management. Journal of Shellfish Research, 
30(3), 939&ndash;948.
</p>
<p>Sestelo, M., Villanueva, N.M., Meira-Machado, L., Roca-Pardinas, J. (2017). 
npregfast: An R Package for Nonparametric Estimation and Inference in Life 
Sciences. Journal of Statistical Software, 82(12), 1-27.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(barnacle)
head(barnacle)

</code></pre>

<hr>
<h2 id='children'>Children dataset.</h2><span id='topic+children'></span>

<h3>Description</h3>

<p>This children data set contains the age and height 
measurements of 2500 children aged 5 to 19 years, splitted 
by sex (1292 females and 1208 males).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>children
</code></pre>


<h3>Format</h3>

<p><code>children</code> is a data frame with 2500 cases (rows) and 
3 variables (columns).
</p>

<dl>
<dt>sex</dt><dd><p>Individual's gender (female or male).</p>
</dd> 
<dt>height</dt><dd><p>Height measured in centimeters.</p>
</dd>
<dt>age</dt><dd><p>Age in years.</p>
</dd>
</dl>



<h3>Note</h3>

<p>Other data sets of this type can be obtained 
from <a href="https://www.who.int/toolkits/child-growth-standards">https://www.who.int/toolkits/child-growth-standards</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(children)
head(children)

</code></pre>

<hr>
<h2 id='critical'>Critical points of the regression function</h2><span id='topic+critical'></span>

<h3>Description</h3>

<p>This function draws inference about some critical point in 
the support of <code class="reqn">X</code> which is associated  with  some features of the regression
function (e.g., minimum, maximum or inflection points which indicate changes
in the sign of curvature). Returns the value of the covariate <code>x</code> 
which maximizes the estimate of the function, the value of the covariate 
<code>x</code> which maximizes the first derivative and the value of the covariate 
<code>x</code> which equals the second derivative to zero, for each level of the 
factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>critical(model, der = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="critical_+3A_model">model</code></td>
<td>
<p>Parametric or nonparametric regression out 
obtained by <code><a href="#topic+frfast">frfast</a></code> function.</p>
</td></tr>
<tr><td><code id="critical_+3A_der">der</code></td>
<td>
<p>Number which determines any inference process. By default
<code>der</code> is <code>NULL</code>. If this term is <code>0</code>, the calculation is for
the point which maximize the estimate. If it is <code>1</code> it is 
designed for the first derivative and if it is <code>2</code>, it returns the point
which equals the second derivative to zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object is returned with the following elements:
</p>
<table role = "presentation">
<tr><td><code>Estimation</code></td>
<td>
 <p><code>x</code> value which maximize the regression function with 
their 95% confidence intervals (for each level).</p>
</td></tr>
<tr><td><code>First_der</code></td>
<td>
<p><code>x</code> value which maximize the first derivative with their
95% confidence intervals (for each level).</p>
</td></tr>
<tr><td><code>Second_der</code></td>
<td>
<p><code>x</code> value which equals the second derivative to zero 
with their 95% confidence intervals (for each level).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>References</h3>

<p>Sestelo, M. (2013). Development and computational implementation of 
estimation and inference methods in flexible regression models. 
Applications in Biology, Engineering and Environment. PhD Thesis, Department
of Statistics and O.R. University of Vigo.
</p>
<p>Sestelo, M., Villanueva, N.M., Meira-Machado, L., Roca-Pardinas, J. (2017). 
npregfast: An R Package for Nonparametric Estimation and Inference in Life 
Sciences. Journal of Statistical Software, 82(12), 1-27.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(npregfast)
data(barnacle)

fit &lt;- frfast(DW ~ RC, data = barnacle) # without interactions
critical(fit)
critical(fit, der = 0)
critical(fit, der = 1)
critical(fit, der = 2)

# fit2 &lt;- frfast(DW ~ RC : F, data = barnacle) # with interactions
# critical(fit2)
# critical(fit2, der = 0)
# critical(fit2, der = 1)
# critical(fit2, der = 2)

</code></pre>

<hr>
<h2 id='criticaldiff'>Differences between the critical points  
for two factor's levels</h2><span id='topic+criticaldiff'></span>

<h3>Description</h3>

<p>Differences between the estimation of <code><a href="#topic+critical">critical</a></code> for two 
factor's levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>criticaldiff(model, level1 = NULL, level2 = NULL, der = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="criticaldiff_+3A_model">model</code></td>
<td>
<p>Parametric or nonparametric regression model 
obtained by <code><a href="#topic+frfast">frfast</a></code> function.</p>
</td></tr>
<tr><td><code id="criticaldiff_+3A_level1">level1</code></td>
<td>
<p>First factor's level at which to perform the differences 
between critical points.</p>
</td></tr>
<tr><td><code id="criticaldiff_+3A_level2">level2</code></td>
<td>
<p>Second factor's level at which to perform the differences 
between critical points.</p>
</td></tr>
<tr><td><code id="criticaldiff_+3A_der">der</code></td>
<td>
<p>Number which determines any inference process. By default 
<code>der</code> is <code>NULL</code>. If this term is <code>0</code>, the calculate of the 
differences for the critical point is for the estimate. If it is <code>1</code> or 
<code>2</code>, it is designed for the first or second derivative, respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Differences are calculated by subtracting a factor relative to 
another (<code class="reqn">level2 - level1</code>).  By default <code>level2</code> and 
<code>level1</code> are <code>NULL</code>, so the differences calculated are for all 
possible combinations between two factors. Additionally, it is obtained 
the 95% confidence interval for this difference which let us to make
inference about them.
</p>


<h3>Value</h3>

<p>An object is returned with the following elements:
</p>
<table role = "presentation">
<tr><td><code>critical.diff</code></td>
<td>
<p>a table with a couple of factor's level where it is used 
to calculate the differences between the critical points, and their 
95% confidence interval (for the estimation, first and second derivative).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>References</h3>

<p>Sestelo, M. (2013). Development and computational implementation of 
estimation and inference methods in flexible regression models. 
Applications in Biology, Engineering and Environment. PhD Thesis, Department
of Statistics and O.R. University of Vigo.
</p>
<p>Sestelo, M., Villanueva, N.M., Meira-Machado, L., Roca-Pardinas, J. (2017). 
npregfast: An R Package for Nonparametric Estimation and Inference in Life 
Sciences. Journal of Statistical Software, 82(12), 1-27.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(npregfast)
data(barnacle)
fit2 &lt;- frfast(DW ~ RC : F, data = barnacle, seed = 130853, nboot = 100) # with interactions
criticaldiff(fit2)
criticaldiff(fit2, der = 1)
criticaldiff(fit2, der = 1, level1 = "lens", level2 = "barca")

</code></pre>

<hr>
<h2 id='frfast'>Fitting nonparametric models</h2><span id='topic+frfast'></span>

<h3>Description</h3>

<p>This function is used to fit nonparametric models by
using local polynomial kernel smoothers or splines. These models can 
include or not  
factor-by-curve interactions. Additionally, a parametric 
model (allometric model) can be estimated (or not).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frfast(
  formula,
  data,
  na.action = "na.omit",
  model = "np",
  smooth = "kernel",
  h0 = -1,
  h = -1,
  nh = 30,
  weights = NULL,
  kernel = "epanech",
  p = 3,
  kbin = 100,
  nboot = 500,
  rankl = NULL,
  ranku = NULL,
  seed = NULL,
  cluster = TRUE,
  ncores = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="frfast_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>formula</code>: a sympbolic 
description of the model to be fitted. The details of model 
specification are given under 'Details'.</p>
</td></tr>
<tr><td><code id="frfast_+3A_data">data</code></td>
<td>
<p>An optional data frame, matrix or list required by 
the formula. If not found in data, the variables are taken from 
<code>environment(formula)</code>, typically the environment from which
<code>frfast</code> is called.</p>
</td></tr>
<tr><td><code id="frfast_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the 
data contain 'NA's. The default is 'na.omit'.</p>
</td></tr>
<tr><td><code id="frfast_+3A_model">model</code></td>
<td>
<p>Type model used: <code>model = "np"</code> for a nonparametric
regression model, 
<code>model = "allo"</code>  for an allometric model. See details.</p>
</td></tr>
<tr><td><code id="frfast_+3A_smooth">smooth</code></td>
<td>
<p>Type smoother used: <code>smooth = "kernel"</code> for local polynomial
kernel smoothers and <code>smooth = "splines"</code> for splines using the 
<code>mgcv</code> package.</p>
</td></tr>
<tr><td><code id="frfast_+3A_h0">h0</code></td>
<td>
<p>The kernel bandwidth smoothing parameter for the global effect (see
references for more details at the estimation). Large values of the bandwidth lead
to smoothed estimates; smaller values of the bandwidth lead lo undersmoothed estimates. 
By default, cross validation is used to obtain the bandwidth.</p>
</td></tr>
<tr><td><code id="frfast_+3A_h">h</code></td>
<td>
<p>The kernel bandwidth smoothing parameter for the partial effects.</p>
</td></tr>
<tr><td><code id="frfast_+3A_nh">nh</code></td>
<td>
<p>Integer number of equally-spaced bandwidth in which the
<code>h</code> is discretised, to speed up computation in the kernel-based regression.</p>
</td></tr>
<tr><td><code id="frfast_+3A_weights">weights</code></td>
<td>
<p>Prior weights on the data.</p>
</td></tr>
<tr><td><code id="frfast_+3A_kernel">kernel</code></td>
<td>
<p>A character string specifying the desired kernel. 
Defaults to <code>kernel = "epanech"</code>, where the Epanechnikov
density function kernel will be used. Also, several types of kernel functons 
can be used:  triangular and Gaussian density function, 
with <code>"triang"</code> and <code>"gaussian"</code> term, respectively.</p>
</td></tr>
<tr><td><code id="frfast_+3A_p">p</code></td>
<td>
<p>Polynomial degree to be used in the kernel-based regression. Its 
value must be the value of
derivative + 1. The default value is 3, returning 
the estimation, first and second derivative.</p>
</td></tr>
<tr><td><code id="frfast_+3A_kbin">kbin</code></td>
<td>
<p>Number of binning nodes over which the function 
is to be estimated.</p>
</td></tr>
<tr><td><code id="frfast_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repeats. Defaults to 500 bootstrap repeats. 
The wild bootstrap is used when <code>model = "np"</code> and the simple bootstrap 
when <code>model = "allo"</code>.</p>
</td></tr>
<tr><td><code id="frfast_+3A_rankl">rankl</code></td>
<td>
<p>Number or vector specifying the minimum value for the
interval at which to search the <code>x</code> value which maximizes the
estimate, first or second derivative  (for each level). The default
is the minimum data value.</p>
</td></tr>
<tr><td><code id="frfast_+3A_ranku">ranku</code></td>
<td>
<p>Number or vector specifying the maximum value for the
interval at which to search the <code>x</code> value which maximizes the
estimate, first or second derivative  (for each level). The default
is the maximum data value.</p>
</td></tr>
<tr><td><code id="frfast_+3A_seed">seed</code></td>
<td>
<p>Seed to be used in the bootstrap procedure.</p>
</td></tr>
<tr><td><code id="frfast_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If  <code>TRUE</code> (default), the
bootstrap procedure is  parallelized (only for <code>smooth = "splines"</code>).
Note that there are cases 
(e.g., a low number of bootstrap repetitions) that R will gain in
performance through serial computation. R takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing, it does
not worth parallelize.</p>
</td></tr>
<tr><td><code id="frfast_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used
in the parallelized procedure. If <code>NULL</code> (default), the number of cores 
to be used is equal to the number of cores of the machine - 1.</p>
</td></tr>
<tr><td><code id="frfast_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The models fitted by <code>frfast</code> function are specified 
in a compact symbolic form. The ~ operator is basic in the formation 
of such models. An expression of the form <code>y ~ model</code>  is interpreted as 
a specification that the response <code>y</code> is modelled by a predictor 
specified symbolically by <code>model</code>. The possible terms consist of a 
variable name or a variable name and a factor name separated by : operator. 
Such a term is interpreted as the interaction of the continuous variable and 
the factor. However, if <code>smooth = "splines"</code>, the formula is based on the function
formula.gam of the mgcv package.
</p>
<p>According with the <code>model</code> argument, if <code>model = "np"</code> the 
estimated regression model will be of the type
</p>
<p style="text-align: center;"><code class="reqn">Y = m(X) + e</code>
</p>

<p>being <code class="reqn">m</code> an smooth and unknown function and <code class="reqn">e</code>
the regression error with zero mean. If <code>model = "allo"</code>, users could estimate
the classical allometric model (Huxley, 1924) with a regression curve 
</p>
<p style="text-align: center;"><code class="reqn">m(X) = a X^b</code>
</p>

<p>being <code class="reqn">a</code> and <code class="reqn">b</code> the parameters of the model.
</p>


<h3>Value</h3>

<p>An object is returned with the following elements:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>Vector of values of the grid points at which model is to 
be estimate.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Matrix of values of the grid points at which to compute the 
estimate, their first and second derivative.</p>
</td></tr>
<tr><td><code>pl</code></td>
<td>
<p>Lower values of  95% confidence interval for the estimate, 
their first and second derivative.</p>
</td></tr>
<tr><td><code>pu</code></td>
<td>
<p>Upper values of  95% confidence interval for the estimate, 
their first and second derivative.</p>
</td></tr>
<tr><td><code>diff</code></td>
<td>
<p>Differences between the estimation values of a couple of 
levels (i. e. level 2 - level 1). The same procedure for their first
and second derivative.</p>
</td></tr>
<tr><td><code>diffl</code></td>
<td>
<p>Lower values of 95% confidence interval for the differences 
between the estimation values of a couple of levels. It is performed 
for their first and second derivative.</p>
</td></tr>
<tr><td><code>diffu</code></td>
<td>
<p>Upper values of 95% confidence interval for the differences 
between the estimation values of a couple of levels. It is performed for 
their first and second derivative.</p>
</td></tr>
<tr><td><code>nboot</code></td>
<td>
<p>Number of bootstrap repeats.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code>dp</code></td>
<td>
<p>Degree of polynomial to be used.</p>
</td></tr>
<tr><td><code>h0</code></td>
<td>
<p>The kernel bandwidth smoothing parameter for the global effect.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>The kernel bandwidth smoothing parameter for the partial effects.</p>
</td></tr>
<tr><td><code>fmod</code></td>
<td>
<p>Factor's level for each data.</p>
</td></tr>
<tr><td><code>xdata</code></td>
<td>
<p>Original x values.</p>
</td></tr>
<tr><td><code>ydata</code></td>
<td>
<p>Original y values.</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>Weights on the data.</p>
</td></tr>
<tr><td><code>kbin</code></td>
<td>
<p>Number of binning nodes over which the function is to 
be estimated.</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>Number of levels.</p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p>Value of covariate <code>x</code> which maximizes the  estimate, 
first or second derivative.</p>
</td></tr>
<tr><td><code>maxu</code></td>
<td>
<p>Upper value of 95% confidence interval for the 
value <code>max</code>.</p>
</td></tr>
<tr><td><code>maxl</code></td>
<td>
<p>Lower value of 95% confidence interval for the 
value <code>max</code>.</p>
</td></tr>
<tr><td><code>diffmax</code></td>
<td>
<p>Differences between the estimation of <code>max</code> for a 
couple of levels (i. e. level 2 - level 1). The same procedure for their 
first and second derivative.</p>
</td></tr>
<tr><td><code>diffmaxu</code></td>
<td>
<p>Upper value of 95% confidence interval for the value 
<code>diffmax</code>.</p>
</td></tr>
<tr><td><code>diffmaxl</code></td>
<td>
<p>Lower value of 95% confidence interval for the value 
<code>diffmax</code>.</p>
</td></tr>
<tr><td><code>repboot</code></td>
<td>
<p>Matrix of values of the grid points at which to compute 
the estimate, their first and second derivative for each bootstrap repeat.</p>
</td></tr>
<tr><td><code>rankl</code></td>
<td>
<p>Maximum value for the interval at which to search the 
<code>x</code> value which maximizes the estimate, first or second derivative  
(for each level). The default is the maximum data value.</p>
</td></tr>
<tr><td><code>ranku</code></td>
<td>
<p>Minimum value for the interval at which to search the 
<code>x</code> value which maximizes the estimate, first or second derivative  
(for each level). The default is the minimum data value.</p>
</td></tr>
<tr><td><code>nmodel</code></td>
<td>
<p>Type model used: <code>nmodel = 1</code> the nonparametric model, 
<code>nmodel = 2</code> the allometric model.</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>Labels of the variables in the model.</p>
</td></tr>
<tr><td><code>numlabel</code></td>
<td>
<p>Number of labels.</p>
</td></tr>
<tr><td><code>kernel</code></td>
<td>
<p>A character specifying the derised kernel.</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>Estimated coefficient in the case of fitting an allometric model.</p>
</td></tr>
<tr><td><code>al</code></td>
<td>
<p>Lower value of 95% confidence interval for the value of <code>a</code>.</p>
</td></tr>
<tr><td><code>au</code></td>
<td>
<p>Upper value of 95% confidence interval for the value of <code>a</code>.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>Estimated coefficient in the case of fitting an allometric model.</p>
</td></tr>
<tr><td><code>bl</code></td>
<td>
<p>Lower value of 95% confidence interval for the value of <code>b</code>.</p>
</td></tr>
<tr><td><code>bu</code></td>
<td>
<p>Upper value of 95% confidence interval for the value of <code>b</code>.</p>
</td></tr>
<tr><td><code>name</code></td>
<td>
<p>Name of the variables in the model.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>A sympbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code>nh</code></td>
<td>
<p>Integer number of equally-spaced bandwidth on which the
<code>h</code> is discretised.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>Coefficient of determination (in the case of the allometric model).</p>
</td></tr>
<tr><td><code>smooth</code></td>
<td>
<p>Type smoother used.</p>
</td></tr>
<tr><td><code>cluster</code></td>
<td>
<p>Is the procedure parallelized? (for splines smoothers).</p>
</td></tr>
<tr><td><code>ncores</code></td>
<td>
<p>Number of cores used in the parallelized procedure? (for splines smoothers).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>References</h3>

<p>Huxley, J. S. (1924). Constant differential growth-ratios and their 
significance. Nature, 114:895&ndash;896.
</p>
<p>Sestelo, M. (2013). Development and computational implementation of 
estimation and inference methods in flexible regression models. 
Applications in Biology, Engineering and Environment. PhD Thesis, Department
of Statistics and O.R. University of Vigo.
</p>
<p>Sestelo, M., Villanueva, N.M., Meira-Machado, L., Roca-Pardinas, J. (2017). 
npregfast: An R Package for Nonparametric Estimation and Inference in Life 
Sciences. Journal of Statistical Software, 82(12), 1-27.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(npregfast)
data(barnacle)

# Nonparametric regression without interactions
fit &lt;- frfast(DW ~ RC, data = barnacle, nboot = 100, smooth = "kernel") 
fit
summary(fit)

# using  splines
#fit &lt;- frfast(DW ~ s(RC), data = barnacle, nboot = 100, 
#smooth = "splines", cluster = TRUE, ncores = 2) 
#fit
#summary(fit)


# Change the number of binning nodes and bootstrap replicates
fit &lt;- frfast(DW ~ RC, data = barnacle, kbin = 200,
               nboot = 100, smooth = "kernel")

# Nonparametric regression with interactions
fit2 &lt;- frfast(DW ~ RC : F, data = barnacle, nboot = 100)
fit2
summary(fit2)

# using  splines
#fit2 &lt;- frfast(DW ~ s(RC, by = F), data = barnacle,
#               nboot = 100, smooth = "splines", cluster = TRUE, ncores = 2)
#fit2
#summary(fit2)


# Allometric model
fit3 &lt;- frfast(DW ~ RC, data = barnacle, model = "allo", nboot = 100)
summary(fit3)

# fit4 &lt;- frfast(DW ~ RC : F, data = barnacle, model = "allo", nboot = 100)
# summary(fit4)

</code></pre>

<hr>
<h2 id='globaltest'>Testing the equality of the <em>M</em> curves specific to each level</h2><span id='topic+globaltest'></span>

<h3>Description</h3>

<p>This function can be used to test the equality of the 
<code class="reqn">M</code> curves specific to each level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>globaltest(
  formula,
  data,
  na.action = "na.omit",
  der,
  smooth = "kernel",
  weights = NULL,
  nboot = 500,
  h0 = -1,
  h = -1,
  nh = 30,
  kernel = "epanech",
  p = 3,
  kbin = 100,
  seed = NULL,
  cluster = TRUE,
  ncores = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="globaltest_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>formula</code>: a sympbolic 
description of the model to be fitted. The details of model 
specification are given under 'Details'.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_data">data</code></td>
<td>
<p>An optional data frame, matrix or list required by 
the formula. If not found in data, the variables are taken from 
<code>environment(formula)</code>, typically the environment from which
<code>globaltest</code> is called.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the 
data contain 'NA's. The default is 'na.omit'.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_der">der</code></td>
<td>
<p>Number which determines any inference process. 
By default <code>der</code> is <code>NULL</code>. If this term is <code>0</code>, 
the testing procedures is applied for the estimate. If it is <code>1</code> or
<code>2</code>, it is designed for the first or second derivative, respectively.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_smooth">smooth</code></td>
<td>
<p>Type smoother used: <code>smooth = "kernel"</code> for local polynomial
kernel smoothers and <code>smooth = "splines"</code> for splines using the 
<code>mgcv</code> package.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_weights">weights</code></td>
<td>
<p>Prior weights on the data.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repeats.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_h0">h0</code></td>
<td>
<p>The kernel bandwidth smoothing parameter for the global effect (see
references for more details at the estimation). Large values of the bandwidth lead
to smoothed estimates; smaller values of the bandwidth lead lo undersmoothed estimates. 
By default, cross validation is used to obtain the bandwidth.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_h">h</code></td>
<td>
<p>The kernel bandwidth smoothing parameter for the partial effects.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_nh">nh</code></td>
<td>
<p>Integer number of equally-spaced bandwidth on which the
<code>h</code> is discretised, to speed up computation.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_kernel">kernel</code></td>
<td>
<p>A character string specifying the desired kernel. 
Defaults to <code>kernel = "epanech"</code>, where the Epanechnikov
density function kernel will be used. Also, several types of kernel funcitons 
can be used:  triangular and Gaussian density function, 
with <code>"triang"</code> and <code>"gaussian"</code> term, respectively.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_p">p</code></td>
<td>
<p>Degree of polynomial to be used. Its value must be the value of
derivative + 1. The default value is 3 due to the function
returns the estimation, first and second derivative.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_kbin">kbin</code></td>
<td>
<p>Number of binning nodes over which the function 
is to be estimated.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_seed">seed</code></td>
<td>
<p>Seed to be used in the bootstrap procedure.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If  <code>TRUE</code> (default), the
bootstrap procedure is  parallelized (only for <code>smooth = "splines"</code>.
Note that there are cases 
(e.g., a low number of bootstrap repetitions) that R will gain in
performance through serial computation. R takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing, it does
not worth parallelize.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used
in the parallelized procedure. If <code>NULL</code> (default), the number of cores 
to be used is equal to the number of cores of the machine - 1.</p>
</td></tr>
<tr><td><code id="globaltest_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>globaltest</code>  can be used to test the equality of the <code class="reqn">M</code> 
curves specific to each level. This bootstrap based test assumes the  
following null hypothesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0^r: m_1^r(\cdot) = \ldots = m_M^r(\cdot)</code>
</p>

<p>versus the general alternative
</p>
<p style="text-align: center;"><code class="reqn">H_1^r: m_i^r (\cdot)  \ne m_j^r (\cdot) \quad  \rm{for} \quad \rm{some}
 \quad i, j \in \{ 1, \ldots, M\}. </code>
</p>

<p>Note that, if <code class="reqn">H_0</code> is not rejected, then the equality of critical points
will also accepted. 
</p>
<p>To test the null hypothesis, it is used a test statistic, 
<code class="reqn">T</code>, based on direct nonparametric estimates of the curves. 
</p>
<p>If the null hypothesis is true, the <code class="reqn">T</code> value should be close to zero 
but is generally greater. The test rule based on <code class="reqn">T</code> consists of 
rejecting the null hypothesis if <code class="reqn">T &gt; T^{1- \alpha}</code>, where <code class="reqn">T^p</code> 
is the empirical <code class="reqn">p</code>-percentile of <code class="reqn">T</code> under the null hypothesis. To
obtain this percentile, we have used bootstrap techniques. See details in 
references.
</p>
<p>Note that the models fitted by <code>globaltest</code> function are specified 
in a compact symbolic form. The ~ operator is basic in the formation 
of such models. An expression of the form <code>y ~ model</code>  is interpreted as 
a specification that the response <code>y</code> is modelled by a predictor 
specified symbolically by <code>model</code>. The possible terms consist of a 
variable name or a variable name and a factor name separated by : operator. 
Such a term is interpreted as the interaction of the continuous variable and 
the factor. However, if <code>smooth = "splines"</code>, the formula is based on the function
formula.gam of the mgcv package.
</p>


<h3>Value</h3>

<p>The <code class="reqn">T</code> value and the <code class="reqn">p</code>-value  are returned. Additionally, 
it is shown the decision, accepted or rejected, of the global test. 
The null hypothesis is rejected if the <code class="reqn">p</code>-value<code class="reqn">&lt; 0.05</code>.
</p>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>References</h3>

<p>Sestelo, M. (2013). Development and computational implementation of 
estimation and inference methods in flexible regression models. 
Applications in Biology, Engineering and Environment. PhD Thesis, Department
of Statistics and O.R. University of Vigo.
</p>
<p>Sestelo, M., Villanueva, N.M., Meira-Machado, L., Roca-Pardinas, J. (2017). 
npregfast: An R Package for Nonparametric Estimation and Inference in Life 
Sciences. Journal of Statistical Software, 82(12), 1-27.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(npregfast)
data(barnacle)
globaltest(DW ~ RC : F, data = barnacle, der = 1, seed = 130853, nboot = 100)

# globaltest(height ~ s(age, by = sex), data = children, 
# seed = 130853, der = 0, smooth = "splines")


</code></pre>

<hr>
<h2 id='localtest'>Testing the equality of critical points</h2><span id='topic+localtest'></span>

<h3>Description</h3>

<p>This function can be used to test the equality of the
<code class="reqn">M</code> critical points estimated from the respective level-specific curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>localtest(
  formula,
  data = data,
  na.action = "na.omit",
  der,
  smooth = "kernel",
  weights = NULL,
  nboot = 500,
  h0 = -1,
  h = -1,
  nh = 30,
  kernel = "epanech",
  p = 3,
  kbin = 100,
  rankl = NULL,
  ranku = NULL,
  seed = NULL,
  cluster = TRUE,
  ncores = NULL,
  ci.level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="localtest_+3A_formula">formula</code></td>
<td>
<p>An object of class <code>formula</code>: a sympbolic 
description of the model to be fitted. The details of model 
specification are given under 'Details'.</p>
</td></tr>
<tr><td><code id="localtest_+3A_data">data</code></td>
<td>
<p>An optional data frame, matrix or list required by 
the formula. If not found in data, the variables are taken from 
<code>environment(formula)</code>, typically the environment from which
<code>localtest</code> is called.</p>
</td></tr>
<tr><td><code id="localtest_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the 
data contain 'NA's. The default is 'na.omit'.</p>
</td></tr>
<tr><td><code id="localtest_+3A_der">der</code></td>
<td>
<p>Number which determines any inference process. 
By default <code>der</code> is <code>NULL</code>. If this term is <code>0</code>, 
the testing procedures is applied for the estimate. If it is <code>1</code> or
<code>2</code>, it is designed for the first or second derivative, respectively.</p>
</td></tr>
<tr><td><code id="localtest_+3A_smooth">smooth</code></td>
<td>
<p>Type smoother used: <code>smooth = "kernel"</code> for local polynomial
kernel smoothers and <code>smooth = "splines"</code> for splines using the 
<code>mgcv</code> package.</p>
</td></tr>
<tr><td><code id="localtest_+3A_weights">weights</code></td>
<td>
<p>Prior weights on the data.</p>
</td></tr>
<tr><td><code id="localtest_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap repeats.</p>
</td></tr>
<tr><td><code id="localtest_+3A_h0">h0</code></td>
<td>
<p>The kernel bandwidth smoothing parameter for the global effect (see
references for more details at the estimation). Large values of the bandwidth lead
to smoothed estimates; smaller values of the bandwidth lead lo undersmoothed estimates. 
By default, cross validation is used to obtain the bandwidth.</p>
</td></tr>
<tr><td><code id="localtest_+3A_h">h</code></td>
<td>
<p>The kernel bandwidth smoothing parameter for the partial effects.</p>
</td></tr>
<tr><td><code id="localtest_+3A_nh">nh</code></td>
<td>
<p>Integer number of equally-spaced bandwidth on which the
<code>h</code> is discretised, to speed up computation.</p>
</td></tr>
<tr><td><code id="localtest_+3A_kernel">kernel</code></td>
<td>
<p>A character string specifying the desired kernel. 
Defaults to <code>kernel = "epanech"</code>, where the Epanechnikov
density function kernel will be used. Also, several types of kernel funcitons 
can be used:  triangular and Gaussian density function, 
with <code>"triang"</code> and <code>"gaussian"</code> term, respectively.</p>
</td></tr>
<tr><td><code id="localtest_+3A_p">p</code></td>
<td>
<p>Degree of polynomial to be used. Its value must be the value of
derivative + 1. The default value is 3 due to the function
returns the estimation, first and second derivative.</p>
</td></tr>
<tr><td><code id="localtest_+3A_kbin">kbin</code></td>
<td>
<p>Number of binning nodes over which the function 
is to be estimated.</p>
</td></tr>
<tr><td><code id="localtest_+3A_rankl">rankl</code></td>
<td>
<p>Number or vector specifying the minimum value for the
interval at which to search the <code>x</code> value which maximizes the
estimate, first or second derivative  (for each level). The default
is the minimum data value.</p>
</td></tr>
<tr><td><code id="localtest_+3A_ranku">ranku</code></td>
<td>
<p>Number or vector specifying the maximum value for the
interval at which to search the <code>x</code> value which maximizes the
estimate, first or second derivative  (for each level). The default
is the maximum data value.</p>
</td></tr>
<tr><td><code id="localtest_+3A_seed">seed</code></td>
<td>
<p>Seed to be used in the bootstrap procedure.</p>
</td></tr>
<tr><td><code id="localtest_+3A_cluster">cluster</code></td>
<td>
<p>A logical value. If  <code>TRUE</code> (default), the
bootstrap procedure is  parallelized (only for <code>smooth = "splines"</code>.
Note that there are cases 
(e.g., a low number of bootstrap repetitions) that R will gain in
performance through serial computation. R takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing, it does
not worth parallelize.</p>
</td></tr>
<tr><td><code id="localtest_+3A_ncores">ncores</code></td>
<td>
<p>An integer value specifying the number of cores to be used
in the parallelized procedure. If <code>NULL</code> (default), the number of cores 
to be used is equal to the number of cores of the machine - 1.</p>
</td></tr>
<tr><td><code id="localtest_+3A_ci.level">ci.level</code></td>
<td>
<p>Level of bootstrap confidence interval. Defaults to 0.95 (corresponding to 95%). Note that the function accepts a vector of levels.</p>
</td></tr>
<tr><td><code id="localtest_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>localtest</code> can be used to test the equality of the 
<code class="reqn">M</code> critical points estimated from the respective level-specific curves. 
Note that, even if the curves and/or their derivatives are different, it is 
possible for these points to be equal. 
</p>
<p>For instance, taking the maxima of the first derivatives into account, 
interest lies in testing the following null hypothesis
</p>
<p style="text-align: center;"><code class="reqn">H_0: x_{01} = \ldots = x_{0M}</code>
</p>

<p>versus the general  alternative  
</p>
<p style="text-align: center;"><code class="reqn">H_1: x_{0i} \ne x_{0j}  \quad {\rm{for}} \quad {\rm{some}} \quad 
i, j \in \{ 1, \ldots, M\}.</code>
</p>

<p>The above hypothesis is true if <code class="reqn">d=x_{0j}-x_{0k}=0</code> where 
</p>
<p style="text-align: center;"><code class="reqn"> (j,k)= argmax \quad (l,m) \quad \{1 \leq l&lt;m \leq M\} \quad |x_{0l}-x_{0m}|, </code>
</p>

<p>otherwise  <code class="reqn">H_0</code> is false. It is important to highlight that, in practice,
the true <code class="reqn">x_{0j}</code> are not known, and consequently neither is <code class="reqn">d</code>, 
so an estimate <code class="reqn">\hat d = \hat x_{0j}-\hat x_{0k}</code> is used, where, 
in general, <code class="reqn">\hat x_{0l}</code> are the estimates of <code class="reqn">x_{0l}</code> based on the 
estimated curves <code class="reqn">\hat m_l</code> with <code class="reqn">l = 1, \ldots , M</code>. 
</p>
<p>Needless to say, 
since <code class="reqn">\hat d</code> is only an estimate of the true <code class="reqn">d</code>, the sampling 
uncertainty of these estimates needs to be acknowledged. Hence, a confidence 
interval <code class="reqn">(a,b)</code> is created for <code class="reqn">d</code> for a specific level of 
confidence (95%).  Based on this, the null hypothesis is rejected if  
zero is not contained in the interval.
</p>
<p>Note that if this hypothesis is rejected (and the factor has more than 
two levels), one option could be to use the <code>maxp.diff</code> function in 
order to obtain the differences between each pair of factor's levels.
</p>
<p>Note that the models fitted by <code>localtest</code> function are specified 
in a compact symbolic form. The ~ operator is basic in the formation 
of such models. An expression of the form <code>y ~ model</code>  is interpreted as 
a specification that the response <code>y</code> is modelled by a predictor 
specified symbolically by <code>model</code>. The possible terms consist of a 
variable name or a variable name and a factor name separated by : operator. 
Such a term is interpreted as the interaction of the continuous variable and 
the factor. However, if <code>smooth = "splines"</code>, the formula is based on the function
formula.gam of the mgcv package.
</p>


<h3>Value</h3>

<p>The estimate of <code class="reqn">d</code> value is returned and its confidence interval 
for a specific-level of confidence, i.e. 95%. Additionally, it is shown 
the decision, accepted or rejected,  of the local test. Based on the null 
hypothesis is rejected if a zero value is not within the interval.
</p>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>References</h3>

<p>Sestelo, M. (2013). Development and computational implementation of 
estimation and inference methods in flexible regression models. 
Applications in Biology, Engineering and Environment. PhD Thesis, Department
of Statistics and O.R. University of Vigo.
</p>
<p>Sestelo, M., Villanueva, N.M., Meira-Machado, L., Roca-Pardinas, J. (2017). 
npregfast: An R Package for Nonparametric Estimation and Inference in Life 
Sciences. Journal of Statistical Software, 82(12), 1-27.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(npregfast)
data(barnacle)
localtest(DW ~ RC : F, data = barnacle, der = 1, seed = 130853, nboot = 100)

# localtest(height ~ s(age, by = sex), data = children, seed = 130853, 
# der = 1, smooth = "splines") 

</code></pre>

<hr>
<h2 id='plot.frfast'>Visualization of <code>frfast</code> objects with the base graphics</h2><span id='topic+plot.frfast'></span>

<h3>Description</h3>

<p>Useful for drawing the estimated regression function, 
first and second derivative (for each factor's level). Additionally, with the 
<code>diffwith</code> argument it is possible to draw the differences between
two factor's levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'frfast'
plot(
  x = model,
  y,
  fac = NULL,
  der = NULL,
  diffwith = NULL,
  points = TRUE,
  xlab = model$name[2],
  ylab = model$name[1],
  ylim = NULL,
  main = NULL,
  col = "black",
  CIcol = "black",
  pcol = "grey80",
  ablinecol = "red",
  abline = TRUE,
  type = "l",
  CItype = "l",
  lwd = 2,
  CIlwd = 1,
  lty = 1,
  CIlty = 2,
  cex = 0.6,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.frfast_+3A_x">x</code></td>
<td>
<p><code>frfast</code> object.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_y">y</code></td>
<td>
<p>NULL.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_fac">fac</code></td>
<td>
<p>Vector which determines the level to take into account
in the plot. By default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_der">der</code></td>
<td>
<p>Number or vector which determines any inference process. 
By default <code>der</code> is <code>NULL</code>. If this term is <code>0</code>, the plot 
shows the initial estimate. If it is <code>1</code> or <code>2</code>,
it is designed for the first or second derivative, respectively.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_diffwith">diffwith</code></td>
<td>
<p>Factor's level used for drawing the differences respect to the 
level specified in the <code>fac</code> argument.  By default, <code>NULL</code>. 
The differences are computed for the r-th derivative speciefied 
in the <code>der</code> argument.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_points">points</code></td>
<td>
<p>Draw the original data into the plot. By default it is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_xlab">xlab</code></td>
<td>
<p>A title for the <code>x</code> axis.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_ylab">ylab</code></td>
<td>
<p>A title for the <code>y</code> axis.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_ylim">ylim</code></td>
<td>
<p>The <code>y</code> limits of the plot.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_main">main</code></td>
<td>
<p>An overall title for the plot.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_col">col</code></td>
<td>
<p>A specification for the default plotting color.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_cicol">CIcol</code></td>
<td>
<p>A specification for the default confidence intervals
plotting color.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_pcol">pcol</code></td>
<td>
<p>A specification for the points color.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_ablinecol">ablinecol</code></td>
<td>
<p>The color to be used for <code>abline</code>.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_abline">abline</code></td>
<td>
<p>Draw an horizontal line into the plot of the second derivative 
of the model.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_type">type</code></td>
<td>
<p>What type of plot should be drawn. Possible types are,
<code>p</code> for points, <code>l</code> for lines, <code>o</code> for overplotted, etc. 
See details in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_citype">CItype</code></td>
<td>
<p>What type of plot should be drawn for confidence intervals. 
Possible types are, <code>p</code> for points, <code>l</code> for lines, <code>o</code> 
for overplotted.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_lwd">lwd</code></td>
<td>
<p>The line width, a positive number, defaulting to 1.
See details in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_cilwd">CIlwd</code></td>
<td>
<p>The line width for confidence intervals, a positive number, 
defaulting to 1.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_lty">lty</code></td>
<td>
<p>The line type. Line types can either be specified as an integer
(0 = blank, 1 = solid (default), 2 = dashed, 3 = dotted, 4 = dotdash, 
5 = longdash, 6 = twodash).  See details in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_cilty">CIlty</code></td>
<td>
<p>The line type for confidence intervals. Line types can either 
be specified as an integer (0 = blank, 1 = solid (default), 2 = dashed,
3 = dotted, 4 = dotdash, 5 = longdash, 6 = twodash).</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_cex">cex</code></td>
<td>
<p>A numerical value giving the amount by which plotting symbols
should be magnified relative to the default. See details in <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot.frfast_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Simply produce a plot.
</p>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(npregfast)
data(barnacle)

# Nonparametric regression without interactions
fit &lt;- frfast(DW ~ RC, data = barnacle, nboot = 100) 
plot(fit)
plot(fit, der = 0)
plot(fit, der = 0, points = FALSE)
plot(fit, der = 1, col = "red", CIcol = "blue")

# Nonparametric regression with interactions
fit2 &lt;- frfast(DW ~ RC : F, data = barnacle, nboot = 100) 
plot(fit2)
plot(fit2, der = 0, fac = "lens")
plot(fit2, der = 1, col = "grey", CIcol = "red")
plot(fit2, der = c(0,1), fac = c("barca","lens"))

# Visualization of the differences between two factor's levels
plot(fit2, fac = "barca", diffwith = "lens")
plot(fit2, fac = "barca", diffwith = "lens", der = 1)


</code></pre>

<hr>
<h2 id='predict.frfast'>Prediction from fitted <code>frfast</code> model</h2><span id='topic+predict.frfast'></span>

<h3>Description</h3>

<p>Takes a fitted <code>frfast</code> object  and produces predictions 
(with their 95% confidence intervals) from a fitted model with 
interactions or without interactions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'frfast'
predict(object = model, newdata, fac = NULL, der = NULL, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.frfast_+3A_object">object</code></td>
<td>
<p>A fitted <code>frfast</code> object as produced by <code>frfast()</code>.</p>
</td></tr>
<tr><td><code id="predict.frfast_+3A_newdata">newdata</code></td>
<td>
<p>A data frame containing the values of the model covariates
at which predictions are required.  If newdata is provided, then it should 
contain all the variables needed for prediction: a warning is 
generated if not.</p>
</td></tr>
<tr><td><code id="predict.frfast_+3A_fac">fac</code></td>
<td>
<p>Factor's level to take into account. By default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="predict.frfast_+3A_der">der</code></td>
<td>
<p>Number which determines any inference process. By default 
<code>der</code> is <code>NULL</code>. If this term is <code>0</code>, 
the function returns the initial estimate. If it is <code>1</code> or <code>2</code>, 
it is designed for the first or second derivative, respectively.</p>
</td></tr>
<tr><td><code id="predict.frfast_+3A_seed">seed</code></td>
<td>
<p>Seed to be used in the bootstrap procedure.</p>
</td></tr>
<tr><td><code id="predict.frfast_+3A_...">...</code></td>
<td>
<p>Other options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>predict.frfast</code> computes and returns a list containing 
predictions of the estimates, first and second derivative, 
with their 95% confidence intervals.
</p>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(npregfast)
data(barnacle)

# Nonparametric regression without interactions
fit &lt;- frfast(DW ~ RC, data = barnacle, nboot = 100)
nd &lt;- data.frame(RC = c(10, 14, 18))
predict(fit, newdata = nd)

# Nonparametric regression with interactions
# fit2 &lt;- frfast(DW ~ RC : F, data = barnacle, nboot = 100)
# nd2 &lt;- data.frame(RC = c(10, 15, 20))
# predict(fit2, newdata = nd2)
# predict(fit2, newdata = nd2, der = 0, fac = "barca")
 
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+autoplot'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ggplot2</dt><dd><p><code><a href="ggplot2.html#topic+autoplot">autoplot</a></code></p>
</dd>
</dl>

<hr>
<h2 id='runExample'>Run npregfast example</h2><span id='topic+runExample'></span>

<h3>Description</h3>

<p>Launch a Shiny app that shows a demo of what can be done with
the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runExample()
</code></pre>


<h3>Details</h3>

<p>This example is also
<a href="https://sestelo.shinyapps.io/npregfast/">available online</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Only run this example in interactive R sessions
if (interactive()) {
  runExample()
}
</code></pre>

<hr>
<h2 id='summary.frfast'>Summarizing fits of <code>frfast</code> class</h2><span id='topic+summary.frfast'></span><span id='topic+print.frfast'></span>

<h3>Description</h3>

<p>Takes a fitted <code>frfast</code> object produced by <code>frfast()</code>
and produces various useful summaries from it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'frfast'
summary(object = model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.frfast_+3A_object">object</code></td>
<td>
<p>a fitted <code>frfast</code> object as produced by <code>frfast()</code>.</p>
</td></tr>
<tr><td><code id="summary.frfast_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the predictions produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print.frfast</code> tries to be smart about <code>summary.frfast</code>.
</p>


<h3>Value</h3>

<p><code>summary.frfast</code> computes and returns a list of summary 
information for a fitted <code>frfast</code> object.
</p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>type of model: nonparametric or allometric.</p>
</td></tr>
<tr><td><code>smooth</code></td>
<td>
<p>type of smoother: kernel or splines.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>the kernel bandwidth smoothing parameter.</p>
</td></tr>
<tr><td><code>dp</code></td>
<td>
<p>degree of the polynomial.</p>
</td></tr>
<tr><td><code>nboot</code></td>
<td>
<p>number of bootstrap repeats.</p>
</td></tr>
<tr><td><code>kbin</code></td>
<td>
<p>number of binning nodes over which the function is to be estimated.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>fmod</code></td>
<td>
<p>factor's levels.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>if <code>model = "allo"</code>, coefficients of the model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.
</p>


<h3>References</h3>

<p>Sestelo, M. (2013). Development and computational implementation of 
estimation and inference methods in flexible regression models. 
Applications in Biology, Engineering and Environment. PhD Thesis, Department
of Statistics and O.R. University of Vigo.
</p>
<p>Sestelo, M., Villanueva, N.M., Meira-Machado, L., Roca-Pardinas, J. (2017). 
npregfast: An R Package for Nonparametric Estimation and Inference in Life 
Sciences. Journal of Statistical Software, 82(12), 1-27.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(npregfast)
data(barnacle)

# Nonparametric regression without interactions
fit &lt;- frfast(DW ~ RC, data = barnacle, nboot = 100) 
fit
summary(fit)

# Nonparametric regression with interactions
fit2 &lt;- frfast(DW ~ RC : F, data = barnacle, nboot = 100)
fit2
summary(fit2)

# Allometric model
fit3 &lt;- frfast(DW ~ RC, data = barnacle, model = "allo", nboot = 100)
fit3
summary(fit3)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
