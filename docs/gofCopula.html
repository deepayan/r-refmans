<!DOCTYPE html><html><head><title>Help for package gofCopula</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gofCopula}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Banks'><p>Volatility-adjusted log returns of the two Banks Citigroup and Bank of</p>
America.</a></li>
<li><a href='#CopulaTestTable'><p>Applicable dimensions and copula for each test</p></a></li>
<li><a href='#CryptoCurrencies'><p>Volatility-adjusted log returns of the two Cryptocurrencies Bitcoin and</p>
Litecoin.</a></li>
<li><a href='#gof'><p>Combining function for tests</p></a></li>
<li><a href='#gofArchmChisq'><p>ArchmChisq Gof test using the Anderson-Darling test</p>
statistic and the chi-square distribution</a></li>
<li><a href='#gofArchmGamma'><p>The ArchmGamma Gof test using the Anderson-Darling test</p>
statistic and the gamma distribution</a></li>
<li><a href='#gofArchmSnB'><p>The ArchmSnB test based on the Rosenblatt transformation for</p>
archimedean copula</a></li>
<li><a href='#gofArchmSnC'><p>The ArchmSnC test based on the Rosenblatt transformation for</p>
archimedean copula</a></li>
<li><a href='#gofCheckTime'><p>Combining function for tests</p></a></li>
<li><a href='#gofco'><p>Interface with copula class</p></a></li>
<li><a href='#gofCopula4Test'><p>Implemented copula for a certain test</p></a></li>
<li><a href='#gofCustomTest'><p>Function to derive own tests</p></a></li>
<li><a href='#gofCvM'><p>The CvM gof test using the empirical copula</p></a></li>
<li><a href='#gofGetHybrid'><p>GetHybrid gof test</p></a></li>
<li><a href='#gofKendallCvM'><p>gof test (Cramer-von Mises) based on Kendall's process</p></a></li>
<li><a href='#gofKendallKS'><p>gof test (Kolmogorov-Smirnov) based on Kendall's process</p></a></li>
<li><a href='#gofKernel'><p>2 dimensional gof test of Scaillet (2007)</p></a></li>
<li><a href='#gofKS'><p>The KS gof test using the empirical copula</p></a></li>
<li><a href='#gofOutputHybrid'><p>Output Hybrid gof test</p></a></li>
<li><a href='#gofPIOSRn'><p>2 and 3 dimensional gof test based on the in-and-out-of-sample approach</p></a></li>
<li><a href='#gofPIOSTn'><p>2 and 3 dimensional gof test based on the in-and-out-of-sample approach</p></a></li>
<li><a href='#gofRosenblattChisq'><p>Gof test using the Anderson-Darling test statistic and the chi-square</p>
distribution</a></li>
<li><a href='#gofRosenblattGamma'><p>Gof test using the Anderson-Darling test statistic and the gamma</p>
distribution</a></li>
<li><a href='#gofRosenblattSnB'><p>The SnB test based on the Rosenblatt transformation</p></a></li>
<li><a href='#gofRosenblattSnC'><p>The SnC test based on the Rosenblatt transformation</p></a></li>
<li><a href='#gofTest4Copula'><p>Applicable gof tests for testing problem</p></a></li>
<li><a href='#gofWhich'><p>The function <code>gofWhich</code> was renamed to <code>gofTest4Copula</code>. Please</p>
use <code>gofTest4Copula</code>.</a></li>
<li><a href='#gofWhichCopula'><p>The function <code>gofWhichCopula</code> was renamed to <code>gofCopula4Test</code>.</p>
Please use <code>gofCopula4Test</code>.</a></li>
<li><a href='#gofWhite'><p>2 dimensional gof tests based on White's information matrix equality.</p></a></li>
<li><a href='#IndexReturns2D'><p>Log returns of european stock indices</p></a></li>
<li><a href='#IndexReturns3D'><p>Log returns of european stock indices</p></a></li>
<li><a href='#plot.gofCOP'><p>Plotting function for objects of class gofCOP</p></a></li>
<li><a href='#print.gofCOP'><p>Printing function for objects of class gofCOP</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Goodness-of-Fit Tests for Copulae</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-04-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Ostap Okhrin &lt;ostap.okhrin@tu-dresden.de&gt;, 
		Simon Trimborn &lt;trimborn.econometrics@gmail.com&gt;, 
		Martin Waltz &lt;martin.waltz@tu-dresden.de&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Simon Trimborn &lt;trimborn.econometrics@gmail.com&gt;</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.9.0), copula (&ge; 1.0-1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>foreach, parallel, doSNOW, R.utils, SparseGrid, numDeriv,
VineCopula (&ge; 2.0.5), methods, stats, MASS, utils, yarrr,
progress, crayon</td>
</tr>
<tr>
<td>Description:</td>
<td>Several Goodness-of-Fit (GoF) tests for Copulae are provided. A new hybrid test, Zhang et al. (2016) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2016.02.017">doi:10.1016/j.jeconom.2016.02.017</a>&gt; is implemented which supports all of the individual tests in the package, e.g. Genest et al. (2009) &lt;<a href="https://doi.org/10.1016%2Fj.insmatheco.2007.10.005">doi:10.1016/j.insmatheco.2007.10.005</a>&gt;. Estimation methods for the margins are provided and all the tests support parameter estimation and predefined values. The parameters are estimated by pseudo maximum likelihood but if it fails the estimation switches automatically to inversion of Kendall's tau. For reproducibility of results, the functions support the definition of seeds. Also all the tests support automatized parallelization of the bootstrapping tasks. The package provides an interface to perform new GoF tests by submitting the test statistic.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-22 08:16:44 UTC; simon</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-22 12:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='Banks'>Volatility-adjusted log returns of the two Banks Citigroup and Bank of
America.</h2><span id='topic+Banks'></span>

<h3>Description</h3>

<p>A dataset containing the volatility-adjusted log returns of two Banks in the
years 2004-2012.
</p>


<h3>Format</h3>

<p>A list with 9 entries containing the Banks log returns divided by
years.
</p>


<h3>Source</h3>

<p>Yahoo-Finance.
</p>

<hr>
<h2 id='CopulaTestTable'>Applicable dimensions and copula for each test</h2><span id='topic+CopulaTestTable'></span>

<h3>Description</h3>

<p><code><a href="#topic+CopulaTestTable">CopulaTestTable</a></code> returns a table which shows the applicable
dimensions and copula for each test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CopulaTestTable()
</code></pre>


<h3>Details</h3>

<p>Before performing a gof test with the package on a dataset, it pays out to 
know the implemented copula and dimensions for each test. This
function is dedicated to help finding the applicable tests depending on the 
copula and dimensions available.
</p>


<h3>Value</h3>

<p>A character matrix which consists of dimensions for the 
combination of tests and copula.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
CopulaTestTable()

</code></pre>

<hr>
<h2 id='CryptoCurrencies'>Volatility-adjusted log returns of the two Cryptocurrencies Bitcoin and
Litecoin.</h2><span id='topic+CryptoCurrencies'></span>

<h3>Description</h3>

<p>A dataset containing the volatility-adjusted log returns of two
Cryptocurrencies in the years 2015-2018.
</p>


<h3>Format</h3>

<p>A list with 4 entries containing the Cryptocurrencies log returns
divided by years.
</p>


<h3>Source</h3>

<p>CoinMetrics. <a href="https://coinmetrics.io/">https://coinmetrics.io/</a>
</p>

<hr>
<h2 id='gof'>Combining function for tests</h2><span id='topic+gof'></span>

<h3>Description</h3>

<p><code><a href="#topic+gof">gof</a></code> computes for a given dataset and based on the choices of
the user different tests for different copulae. If copulae are given, all
the implemented tests for those copulae are calculated. If tests are given,
all the implemented copulae for every test are used. If both copulae and
tests are given, all possible combinations are calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof(
  x,
  priority = "copula",
  copula = NULL,
  tests = NULL,
  customTests = NULL,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  MJ = 100,
  dispstr = "ex",
  m = 1,
  delta.J = 0.5,
  nodes.Integration = 12,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gof_+3A_priority">priority</code></td>
<td>
<p>A character string which is either <code>"tests"</code> or
<code>"copula"</code>. <code>"tests"</code> indicates that all implemented tests are
performed for all copulae which the tests share. These are e.g.
<code>"normal"</code> and <code>"clayton"</code>. If <code>"copula"</code> is chosen, 
all copula are chosen and only the tests are performend which these copula 
share. If one of the arguments <code>tests</code> or <code>copula</code> is not 
<code>NULL</code>, then <code>priority</code> doesn't affect the choice of the copulae 
and tests.</p>
</td></tr>
<tr><td><code id="gof_+3A_copula">copula</code></td>
<td>
<p>A character vector which indicates the copula to test for.
Possible are <code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"huslerReiss"</code>, <code>"tawn"</code>, <code>"tev"</code>, <code>"fgm"</code> and 
<code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_tests">tests</code></td>
<td>
<p>A character vector which indicates the tests to use. Possible
choices are the individual tests implemented in this package.</p>
</td></tr>
<tr><td><code id="gof_+3A_customtests">customTests</code></td>
<td>
<p>A character vector which indicates the customized test to
use, if any. The test has to be loaded into the workspace. Currently the
function containing the test has to have 2 arguments, the first one for the
dataset and the second one for the copula to test for. The arguments have to
be named &quot;x&quot; and &quot;copula&quot; respectively.</p>
</td></tr>
<tr><td><code id="gof_+3A_param">param</code></td>
<td>
<p>The copulae parameters to use for each test, if it shall not be
estimated.</p>
</td></tr>
<tr><td><code id="gof_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gof_+3A_df">df</code></td>
<td>
<p>The degrees of freedom, if not meant to be estimated. Only
necessary if tested for <code>"t"</code>-copula. For the <code>"gofPIOSTn"</code> test
the entry is limited to 60 degrees of freedom for computational reasons.</p>
</td></tr>
<tr><td><code id="gof_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated. For the <code>"gofPIOSTn"</code> test the estimate is limited to 60
degrees of freedom for computational reasons.</p>
</td></tr>
<tr><td><code id="gof_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_flip">flip</code></td>
<td>
<p>The vector of control parameters to flip the copula 
by 90, 180, 270 degrees clockwise. Only applicable for bivariate copula. 
Default is 0 and possible inputs are 0, 90, 180, 270 and NULL. One can either
specify one flip degree which will be applied on all copulae or choose
an individual flip for each copula in which case the input has to be a vector.</p>
</td></tr>
<tr><td><code id="gof_+3A_m">M</code></td>
<td>
<p>The amount of bootstrap rounds to be performed by each test.
Default is 1000.</p>
</td></tr>
<tr><td><code id="gof_+3A_mj">MJ</code></td>
<td>
<p>Just for the test gofKernel. Size of bootstrapping sample.</p>
</td></tr>
<tr><td><code id="gof_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_m">m</code></td>
<td>
<p>Length of blocks. Only necessary if the test <code>gofPIOSTn</code> is
part of <code>tests</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_delta.j">delta.J</code></td>
<td>
<p>Scaling parameter for the matrix of smoothing parameters.
Only necessary if the test <code>gofKernel</code> is part of <code>tests</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_nodes.integration">nodes.Integration</code></td>
<td>
<p>Number of knots of the bivariate Gauss-Legendre
quadrature. Only necessary if the test <code>gofKernel</code> is part of
<code>tests</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gof_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a character vector is given for the argument <code>copula</code> and nothing
for <code>tests</code>, then all tests are performed for which the given copulae
are implemented. If <code>tests</code> contains a character vector of tests and
<code>copula = NULL</code>, then this tests will be performed for all implemented
copulae. If character vectors are given for <code>copula</code> and <code>tests</code>,
then the tests are performed with the given copulae. If <code>tests = NULL</code>
and <code>copula = NULL</code>, then the argument <code>priority</code> catches in and
defines the procedure.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>
<p>Note that this function does not display <code>warning()</code> messages. Due to
the large amount of tests run at once, the messages are not tracable to the
situation when they appeared. Hence they are omitted for this function.
</p>


<h3>Value</h3>

<p>A list containing several objects of <code>class</code> gofCOP with the
following components for each copulae </p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which
informs about the performed analysis</p>
</td></tr> <tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr>
<tr><td><code>margins</code></td>
<td>
<p>the method used to estimate the margin distribution.</p>
</td></tr>
<tr><td><code>param.margins</code></td>
<td>
<p>the parameters of the estimated margin distributions.
Only applicable if the margins were not specified as <code>"ranks"</code> or
<code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence parameters of the copulae</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula. Only applicable for
t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values and test statistics
of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gof(IndexReturns2D, priority = "tests", copula = "normal", 
tests = c("gofRosenblattSnB", "gofRosenblattSnC"), M = 5)

</code></pre>

<hr>
<h2 id='gofArchmChisq'>ArchmChisq Gof test using the Anderson-Darling test
statistic and the chi-square distribution</h2><span id='topic+gofArchmChisq'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofArchmChisq">gofArchmChisq</a></code> contains the Chisq gof test with a Rosenblatt 
transformation for archimedean copulae, described in Hering and Hofert (2015).
The test follows the RosenblattChisq test as described in Genest (2009) 
and Hofert (2014), and compares the empirical copula against a parametric 
estimate of the copula derived under the null hypothesis. The margins can be 
estimated by a bunch of distributions and the time which is necessary for 
the estimation can be given. The approximate p-values are computed with a 
parametric bootstrap, which computation can be accelerated by enabling 
in-build parallel computation. The gof statistics are computed with the 
function <code><a href="copula.html#topic+gofTstat">gofTstat</a></code> from the package copula. 
It is possible to insert datasets of all dimensions above 1 
(except for the <code>"amh"</code> copula) and the possible copulae are 
<code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code> and 
<code>"amh"</code>. The parameter estimation is performed with pseudo maximum
likelihood method. In case the estimation fails, inversion of Kendall's tau
is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofArchmChisq(
  copula = c("clayton", "gumbel", "frank", "joe", "amh"),
  x,
  param = 0.5,
  param.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofArchmChisq_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"clayton"</code>, 
<code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code> and <code>"amh"</code>.</p>
</td></tr>
<tr><td><code id="gofArchmChisq_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofArchmChisq_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofArchmChisq_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofArchmChisq_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmChisq_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofArchmChisq_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofArchmChisq_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmChisq_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmChisq_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofArchmChisq_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This Anderson-Darling test statistic (supposedly) computes
U[0,1]-distributed (under <code class="reqn">H_0</code>) random variates via the
distribution function of chi-square distribution with d degrees of freedom,
see Hofert et al. (2014). The <code class="reqn">H_0</code> hypothesis is </p>
<p style="text-align: center;"><code class="reqn">C \in
\mathcal{C}_0</code>
</p>
<p> with <code class="reqn">\mathcal{C}_0</code> as the true class
of copulae under <code class="reqn">H_0</code>.
</p>
<p>This test is based on the Rosenblatt transformation for archimedean copula
which uses the mapping <code class="reqn">\mathcal{R}: (0,1)^d 
\rightarrow (0,1)^d</code>. Following 
Hering and Hofert (2015) the mapping provides 
pseudo observations <code class="reqn">E_i</code>, given by </p>
<p style="text-align: center;"><code class="reqn">E_1 = \mathcal{R}(U_1), 
\dots, E_n = \mathcal{R}(U_n).</code>
</p>
 
<p>Let <code class="reqn">C</code> be an Archimedean copula with <code class="reqn">d</code> monotone generator 
<code class="reqn">\psi</code> and continuous Kendall distribution function <code class="reqn">K_{C}</code>. Then, 
</p>
<p style="text-align: center;"><code class="reqn">e_{j}=\left(\frac{\sum_{k=1}^{j} \psi^{-1}\left(u_{k}
\right)}{\sum_{k=1}^{j+1} \psi^{-1}\left(u_{k}\right)}\right)^{j}, 
j \in\{1, \ldots, d-1\}</code>
</p>
<p> and 
</p>
<p style="text-align: center;"><code class="reqn">e_{d}= \frac{n}{n+1} K_{C}(C(u))</code>
</p>
<p>.
</p>
<p>The Anderson-Darling test statistic of the variates
</p>
<p style="text-align: center;"><code class="reqn">G(x_j) = \chi_d^2 \left( x_j \right)</code>
</p>

<p>is computed (via <code>ADGofTest::ad.test</code>), where <code class="reqn">x_j = \sum_{i=1}^d
(\Phi^{-1}(e_{ij}))^2</code>, <code class="reqn">\Phi^{-1}</code>
denotes the quantile function of the standard normal distribution function,
<code class="reqn">\chi_d^2</code> denotes the distribution function of the
chi-square distribution with <code>d</code> degrees of freedom, and <code class="reqn">u_{ij}</code>
is the <code class="reqn">j</code>th component in the <code class="reqn">i</code>th row of <code class="reqn">\mathbf{u}</code>.
</p>
<p>The test statistic is then given by </p>
<p style="text-align: center;"><code class="reqn">T = -n - \sum_{j=1}^n \frac{2j -
1}{n} [\ln(G(x_j)) + \ln(1 - G(x_{n+1-j}))].</code>
</p>

<p>The approximate p-value is computed by the formula,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br /> <br /> Marius
Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br /> <br />
Christian Hering, Marius Hofert (2015) Goodness-of-fit tests for 
Archimedean copulas in high dimensions. <em>In: Glau K., Scherer M., 
Zagst R. (eds) Innovations in Quantitative Risk Management, 
Springer Proceedings in Mathematics &amp; Statistics, Volume 99, 
Springer, Cham, 357-373</em>.
doi: <a href="https://doi.org/10.1007/978-3-319-09114-3_21">10.1007/978-3-319-09114-3_21</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofArchmChisq("clayton", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofArchmGamma'>The ArchmGamma Gof test using the Anderson-Darling test
statistic and the gamma distribution</h2><span id='topic+gofArchmGamma'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofArchmGamma">gofArchmGamma</a></code> contains the Gamma gof test with a Rosenblatt 
transformation for archimedean copulae, described in Hering and Hofert (2015).
The test follows the RosenblattChisq test as described in Genest (2009) 
and Hofert (2014), and compares the empirical copula against a parametric 
estimate of the copula derived under the null hypothesis. The margins can be 
estimated by a bunch of distributions and the time which is necessary for 
the estimation can be given. The approximate p-values are computed with a 
parametric bootstrap, which computation can be accelerated by enabling 
in-build parallel computation. The gof statistics are computed with the 
function <code><a href="copula.html#topic+gofTstat">gofTstat</a></code> from the package copula. 
It is possible to insert datasets of all dimensions above 1 
(except for the <code>"amh"</code> copula) and the possible copulae are 
<code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code> and 
<code>"amh"</code>. The parameter estimation is performed with pseudo maximum
likelihood method. In case the estimation fails, inversion of Kendall's tau
is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofArchmGamma(
  copula = c("clayton", "gumbel", "frank", "joe", "amh"),
  x,
  param = 0.5,
  param.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofArchmGamma_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"clayton"</code>, 
<code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code> and <code>"amh"</code>.</p>
</td></tr>
<tr><td><code id="gofArchmGamma_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofArchmGamma_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofArchmGamma_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofArchmGamma_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmGamma_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofArchmGamma_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofArchmGamma_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmGamma_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmGamma_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofArchmGamma_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This Anderson-Darling test statistic (supposedly) computes
U[0,1]-distributed (under <code class="reqn">H_0</code>) random variates via the
distribution function of the gamma distribution, see Hofert et al. (2014).
As written in Hofert et al. (2014) computes this Anderson-Darling test
statistic for (supposedly) U[0,1]-distributed (under H_0) random variates
via the distribution function of the gamma distribution. The <code class="reqn">H_0</code>
hypothesis is </p>
<p style="text-align: center;"><code class="reqn">C \in \mathcal{C}_0</code>
</p>
<p> with
<code class="reqn">\mathcal{C}_0</code> as the true class of copulae under <code class="reqn">H_0</code>.
</p>
<p>This test is based on the Rosenblatt transformation for archimedean copula
which uses the mapping <code class="reqn">\mathcal{R}: (0,1)^d 
\rightarrow (0,1)^d</code>. Following 
Hering and Hofert (2015) the mapping provides 
pseudo observations <code class="reqn">E_i</code>, given by </p>
<p style="text-align: center;"><code class="reqn">E_1 = \mathcal{R}(U_1), 
\dots, E_n = \mathcal{R}(U_n).</code>
</p>
 
<p>Let <code class="reqn">C</code> be an Archimedean copula with <code class="reqn">d</code> monotone generator 
<code class="reqn">\psi</code> and continuous Kendall distribution function <code class="reqn">K_{C}</code>. Then, 
</p>
<p style="text-align: center;"><code class="reqn">e_{j}=\left(\frac{\sum_{k=1}^{j} \psi^{-1}\left(u_{k}
\right)}{\sum_{k=1}^{j+1} \psi^{-1}\left(u_{k}\right)}\right)^{j}, 
j \in\{1, \ldots, d-1\}</code>
</p>
<p> and 
</p>
<p style="text-align: center;"><code class="reqn">e_{d}= \frac{n}{n+1} K_{C}(C(u))</code>
</p>
<p>.
</p>
<p>The Anderson-Darling test statistic of the variates
</p>
<p style="text-align: center;"><code class="reqn">G(x_j) = \Gamma_d \left( x_j \right)</code>
</p>

<p>is computed (via <code>ADGofTest::ad.test</code>), where <code class="reqn">x_j = \sum_{i=1}^d
(- \ln e_{ij})</code>,
<code class="reqn">\Gamma_d()</code> denotes the distribution function of
the gamma distribution with shape parameter d and shape parameter one (being
equal to an Erlang(d) distribution function).
</p>
<p>The test statistic is then given by </p>
<p style="text-align: center;"><code class="reqn">T = -n - \sum_{j=1}^n \frac{2j -
1}{n} [\ln(G(x_j)) + \ln(1 - G(x_{n+1-j}))].</code>
</p>

<p>The approximate p-value is computed by the formula,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br /> <br /> Marius
Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br /> <br />
Christian Hering, Marius Hofert (2015) Goodness-of-fit tests for 
Archimedean copulas in high dimensions. <em>In: Glau K., Scherer M., 
Zagst R. (eds) Innovations in Quantitative Risk Management, 
Springer Proceedings in Mathematics &amp; Statistics, Volume 99, 
Springer, Cham, 357-373</em>.
doi: <a href="https://doi.org/10.1007/978-3-319-09114-3_21">10.1007/978-3-319-09114-3_21</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofArchmGamma("clayton", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofArchmSnB'>The ArchmSnB test based on the Rosenblatt transformation for 
archimedean copula</h2><span id='topic+gofArchmSnB'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofArchmSnB">gofArchmSnB</a></code> contains the SnB gof test with a Rosenblatt 
transformation for archimedean copulae, described in Hering and Hofert (2015).
The test follows the RosenblattChisq test as described in Genest (2009) 
and Hofert (2014), and compares the empirical copula against a parametric 
estimate of the copula derived under the null hypothesis. The margins can be 
estimated by a bunch of distributions and the time which is necessary for 
the estimation can be given. The approximate p-values are computed with a 
parametric bootstrap, which computation can be accelerated by enabling 
in-build parallel computation. The gof statistics are computed with the 
function <code><a href="copula.html#topic+gofTstat">gofTstat</a></code> from the package copula. 
It is possible to insert datasets of all dimensions above 1 
(except for the <code>"amh"</code> copula) and the possible copulae are 
<code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code> and 
<code>"amh"</code>. The parameter estimation is performed with pseudo maximum
likelihood method. In case the estimation fails, inversion of Kendall's tau
is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofArchmSnB(
  copula = c("clayton", "gumbel", "frank", "joe", "amh"),
  x,
  param = 0.5,
  param.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofArchmSnB_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"clayton"</code>, 
<code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code> and <code>"amh"</code>.</p>
</td></tr>
<tr><td><code id="gofArchmSnB_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofArchmSnB_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofArchmSnB_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofArchmSnB_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmSnB_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofArchmSnB_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofArchmSnB_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmSnB_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmSnB_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofArchmSnB_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This test is based on the Rosenblatt transformation for archimedean copula
which uses the mapping <code class="reqn">\mathcal{R}: (0,1)^d 
\rightarrow (0,1)^d</code>. Following 
Hering and Hofert (2015) the mapping provides 
pseudo observations <code class="reqn">E_i</code>, given by </p>
<p style="text-align: center;"><code class="reqn">E_1 = \mathcal{R}(U_1), 
\dots, E_n = \mathcal{R}(U_n).</code>
</p>
 
<p>Let <code class="reqn">C</code> be an Archimedean copula with <code class="reqn">d</code> monotone generator 
<code class="reqn">\psi</code> and continuous Kendall distribution function <code class="reqn">K_{C}</code>. Then, 
</p>
<p style="text-align: center;"><code class="reqn">e_{j}=\left(\frac{\sum_{k=1}^{j} \psi^{-1}\left(u_{k}
\right)}{\sum_{k=1}^{j+1} \psi^{-1}\left(u_{k}\right)}\right)^{j}, 
j \in\{1, \ldots, d-1\}</code>
</p>
<p> and 
</p>
<p style="text-align: center;"><code class="reqn">e_{d}= \frac{n}{n+1} K_{C}(C(u))</code>
</p>
<p>. 
The resulting independence copula is given by
<code class="reqn">C_{\bot}(\mathbf{u}) = u_1 \cdot \dots \cdot u_d</code>.
</p>
<p>The test statistic <code class="reqn">T</code> is then defined as
</p>
<p style="text-align: center;"><code class="reqn">T = n \int_{[0,1]^d} \{ D_n(\mathbf{u}) - C_{\bot}(\mathbf{u}) \}^2 d
(\mathbf{u})</code>
</p>
<p> with
<code class="reqn">D_n(\mathbf{u}) = \frac{1}{n} \sum_{i = 1}^n \mathbf{I}(E_i \leq
\mathbf{u})</code>.
</p>
<p>The approximate p-value is computed by the formula, see <span class="pkg">copula</span>,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br /> <br /> Marius
Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br /> <br />
Christian Hering, Marius Hofert (2015) Goodness-of-fit tests for 
Archimedean copulas in high dimensions. <em>In: Glau K., Scherer M., 
Zagst R. (eds) Innovations in Quantitative Risk Management, 
Springer Proceedings in Mathematics &amp; Statistics, Volume 99, 
Springer, Cham, 357-373</em>.
doi: <a href="https://doi.org/10.1007/978-3-319-09114-3_21">10.1007/978-3-319-09114-3_21</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofArchmSnB("clayton", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofArchmSnC'>The ArchmSnC test based on the Rosenblatt transformation for 
archimedean copula</h2><span id='topic+gofArchmSnC'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofArchmSnC">gofArchmSnC</a></code> contains the SnC gof test with a Rosenblatt 
transformation for archimedean copulae, described in Hering and Hofert (2015).
The test follows the RosenblattChisq test as described in Genest (2009) 
and Hofert (2014), and compares the empirical copula against a parametric 
estimate of the copula derived under the null hypothesis. The margins can be 
estimated by a bunch of distributions and the time which is necessary for 
the estimation can be given. The approximate p-values are computed with a 
parametric bootstrap, which computation can be accelerated by enabling 
in-build parallel computation. The gof statistics are computed with the 
function <code><a href="copula.html#topic+gofTstat">gofTstat</a></code> from the package copula. 
It is possible to insert datasets of all dimensions above 1 
(except for the <code>"amh"</code> copula) and the possible copulae are 
<code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code> and 
<code>"amh"</code>. The parameter estimation is performed with pseudo maximum
likelihood method. In case the estimation fails, inversion of Kendall's tau
is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofArchmSnC(
  copula = c("clayton", "gumbel", "frank", "joe", "amh"),
  x,
  param = 0.5,
  param.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofArchmSnC_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"clayton"</code>, 
<code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code> and <code>"amh"</code>.</p>
</td></tr>
<tr><td><code id="gofArchmSnC_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofArchmSnC_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofArchmSnC_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofArchmSnC_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmSnC_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofArchmSnC_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofArchmSnC_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmSnC_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofArchmSnC_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofArchmSnC_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This test is based on the Rosenblatt transformation for archimedean copula
which uses the mapping <code class="reqn">\mathcal{R}: (0,1)^d 
\rightarrow (0,1)^d</code>. Following 
Hering and Hofert (2015) the mapping provides 
pseudo observations <code class="reqn">E_i</code>, given by </p>
<p style="text-align: center;"><code class="reqn">E_1 = \mathcal{R}(U_1), 
\dots, E_n = \mathcal{R}(U_n).</code>
</p>
 
<p>Let <code class="reqn">C</code> be an Archimedean copula with <code class="reqn">d</code> monotone generator 
<code class="reqn">\psi</code> and continuous Kendall distribution function <code class="reqn">K_{C}</code>. Then, 
</p>
<p style="text-align: center;"><code class="reqn">e_{j}=\left(\frac{\sum_{k=1}^{j} \psi^{-1}\left(u_{k}
\right)}{\sum_{k=1}^{j+1} \psi^{-1}\left(u_{k}\right)}\right)^{j}, 
j \in\{1, \ldots, d-1\}</code>
</p>
<p> and 
</p>
<p style="text-align: center;"><code class="reqn">e_{d}= \frac{n}{n+1} K_{C}(C(u))</code>
</p>
<p>. 
The resulting independence copula is given by
<code class="reqn">C_{\bot}(\mathbf{u}) = u_1 \cdot \dots \cdot u_d</code>.
</p>
<p>The test statistic <code class="reqn">T</code> is then defined as
</p>
<p style="text-align: center;"><code class="reqn">T = n \int_{[0,1]^d} \{ D_n(\mathbf{u}) - C_{\bot}(\mathbf{u}) \}^2 d
D_n(\mathbf{u})</code>
</p>
<p> with
<code class="reqn">D_n(\mathbf{u}) = \frac{1}{n} \sum_{i = 1}^n \mathbf{I}(E_i \leq
\mathbf{u})</code>.
</p>
<p>The approximate p-value is computed by the formula, see <span class="pkg">copula</span>,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br /> <br /> Marius
Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br /> <br />
Christian Hering, Marius Hofert (2015) Goodness-of-fit tests for 
Archimedean copulas in high dimensions. <em>In: Glau K., Scherer M., 
Zagst R. (eds) Innovations in Quantitative Risk Management, 
Springer Proceedings in Mathematics &amp; Statistics, Volume 99, 
Springer, Cham, 357-373</em>.
doi: <a href="https://doi.org/10.1007/978-3-319-09114-3_21">10.1007/978-3-319-09114-3_21</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofArchmSnC("clayton", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofCheckTime'>Combining function for tests</h2><span id='topic+gofCheckTime'></span>

<h3>Description</h3>

<p>The computation of a gof test can take very long, especially when the number
of bootstrap rounds is high. The function <code><a href="#topic+gofCheckTime">gofCheckTime</a></code>
computes the time which the estimation most likely takes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofCheckTime(
  copula,
  x,
  tests = NULL,
  customTests = NULL,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  MJ = 100,
  dispstr = "ex",
  print.res = TRUE,
  m = 1,
  delta.J = 0.5,
  nodes.Integration = 12,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofCheckTime_+3A_copula">copula</code></td>
<td>
<p>A character vector which indicates the copula to test for. 
Possible are <code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"huslerReiss"</code>, <code>"tawn"</code>, <code>"tev"</code>, <code>"fgm"</code> and 
<code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_tests">tests</code></td>
<td>
<p>A character vector which indicates the test to use.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_customtests">customTests</code></td>
<td>
<p>A character vector which indicates the customized test to
use, if any.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_param">param</code></td>
<td>
<p>The copulae parameters to use for each test, if it shall not be
estimated.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_df">df</code></td>
<td>
<p>The degrees of freedom, if not meant to be estimated. Only
necessary if tested for <code>"t"</code>-copula.  For the <code>"gofPIOSTn"</code> test
the entry is limited to 60 degrees of freedom for computational reasons.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated. For the <code>"gofPIOSTn"</code> test the estimate is limited to 60
degrees of freedom for computational reasons.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_m">M</code></td>
<td>
<p>The number of bootstrapping rounds which shall be later taken in
the estimation.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_mj">MJ</code></td>
<td>
<p>Just for the test gofKernel. Size of bootstrapping sample.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_print.res">print.res</code></td>
<td>
<p>Logical which defines if the resulting time shall be
printed or given as value. Default is TRUE.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_m">m</code></td>
<td>
<p>Length of blocks. Only necessary if the test <code>gofPIOSTn</code> is
part of <code>testset</code>.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_delta.j">delta.J</code></td>
<td>
<p>Scaling parameter for the matrix of smoothing parameters.
Only necessary if the test <code>gofKernel</code> is part of <code>testset</code>.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_nodes.integration">nodes.Integration</code></td>
<td>
<p>Number of knots of the bivariate Gauss-Legendre
quadrature. Only necessary if the test <code>gofKernel</code> is part of
<code>testset</code>.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofCheckTime_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates the time which the entire gof test will take.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(IndexReturns2D)

gofCheckTime("normal", IndexReturns2D, "gofKendallKS", M = 10000)

## End(Not run)

</code></pre>

<hr>
<h2 id='gofco'>Interface with copula class</h2><span id='topic+gofco'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofco">gofco</a></code> is an interface with the <code>copula</code> package. It reads
out the information from a copula class object and hands them over to a
specified gof test or set of tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofco(
  copulaobject,
  x,
  tests = c("gofPIOSRn", "gofKernel"),
  customTests = NULL,
  margins = "ranks",
  flip = 0,
  M = 1000,
  MJ = 100,
  dispstr = "ex",
  m = 1,
  delta.J = 0.5,
  nodes.Integration = 12,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofco_+3A_copulaobject">copulaobject</code></td>
<td>
<p>An object with of class <code>copula</code> from the copula
package.</p>
</td></tr>
<tr><td><code id="gofco_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofco_+3A_tests">tests</code></td>
<td>
<p>A character vector which indicates the tests to use. Possible
choices are the individual tests implemented in this package.</p>
</td></tr>
<tr><td><code id="gofco_+3A_customtests">customTests</code></td>
<td>
<p>A character vector which indicates the customized test to
use, if any. The test has to be loaded into the workspace. Currently the
function containing the test has to have 2 arguments, the first one for the
dataset and the second one for the copula to test for. The arguments have to
be named &quot;x&quot; and &quot;copula&quot; respectively.</p>
</td></tr>
<tr><td><code id="gofco_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively can the following distributions
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofco_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofco_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping samples in the single tests.</p>
</td></tr>
<tr><td><code id="gofco_+3A_mj">MJ</code></td>
<td>
<p>Size of bootstrapping sample. Only necessary if the test
<code>gofKernel</code> is part of <code>testset</code>.</p>
</td></tr>
<tr><td><code id="gofco_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofco_+3A_m">m</code></td>
<td>
<p>Length of blocks. Only necessary if the test <code>gofPIOSTn</code> is
part of <code>testset</code>.</p>
</td></tr>
<tr><td><code id="gofco_+3A_delta.j">delta.J</code></td>
<td>
<p>Scaling parameter for the matrix of smoothing parameters.
Only necessary if the test <code>gofKernel</code> is part of <code>testset</code>.</p>
</td></tr>
<tr><td><code id="gofco_+3A_nodes.integration">nodes.Integration</code></td>
<td>
<p>Number of knots of the bivariate Gauss-Legendre
quadrature. Only necessary if the test <code>gofKernel</code> is part of
<code>testset</code>.</p>
</td></tr>
<tr><td><code id="gofco_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofco_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofco_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofco_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function reads out the arguments in the copula class object. If the
dependence parameter is not specified in the object, it is estimated. In
case that the object describes a &quot;t&quot;-copula, then the same holds for the
degrees of freedom. The dimension is not extracted from the object. It is
obtained from the inserted dataset.
</p>
<p>When more than one test shall be performed, the hybrid test is computed too.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Yan, Jun. Enjoy the joy of copulas: with a package copula.
Journal of Statistical Software 21.4 (2007): 1-21.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)
copObject = normalCopula(param = 0.5)

gofco(copObject, x = IndexReturns2D, tests = c("gofPIOSRn", "gofKernel"), 
      M = 20)

</code></pre>

<hr>
<h2 id='gofCopula4Test'>Implemented copula for a certain test</h2><span id='topic+gofCopula4Test'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofCopula4Test">gofCopula4Test</a></code> returns for a given test the applicable
implemented copula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofCopula4Test(test)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofCopula4Test_+3A_test">test</code></td>
<td>
<p>The test to search for copula.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In case that the decision for a certain gof test was already done, it is
interesting to know which copula can be used with this test.
</p>


<h3>Value</h3>

<p>A character vector which consists of the names of the copula.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
gofCopula4Test("gofRosenblattSnB")

gofCopula4Test("gofPIOSTn")

</code></pre>

<hr>
<h2 id='gofCustomTest'>Function to derive own tests</h2><span id='topic+gofCustomTest'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofCustomTest">gofCustomTest</a></code> allows to include own Goodness-of-Fit tests and
perform the test with the package. The margins can be estimated by a bunch
of distributions and the time which is necessary for the estimation can be
given. The approximate p-values are computed with a parametric bootstrap,
which computation can be accelerated by enabling in-build parallel
computation. It is possible to insert datasets of all dimensions above 1 and
the possible copulae are <code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, 
<code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, 
<code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, <code>"tev"</code>, 
<code>"fgm"</code> and <code>"plackett"</code>. The parameter estimation is performed
with pseudo maximum likelihood method. In case the estimation fails,
inversion of Kendall's tau is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofCustomTest(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "huslerReiss", "tawn", "tev", "fgm", "plackett"),
  x,
  customTest = NULL,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofCustomTest_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_customtest">customTest</code></td>
<td>
<p>A character string with the name of the customized test.
The test has to be loaded into the workspace. Currently the function
containing the test has to have 2 arguments, the first one for the dataset
and the second one for the copula to test for. The arguments have to be
named &quot;x&quot; and &quot;copula&quot; respectively.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofCustomTest_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approximate p-value is computed by the formula, see <span class="pkg">copula</span>,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# For illustration we load here the test statistic of the gofSn test
Testfunc = function(x, copula) {
            C.theo = pCopula(x, copula = copula)
            C.n = F.n(x, X = x)
            CnK = sum((C.n - C.theo)^2)
            return(CnK)
}

data(IndexReturns2D)

gofCustomTest(copula = "normal", x = IndexReturns2D, 
              customTest = "Testfunc", M=10)


</code></pre>

<hr>
<h2 id='gofCvM'>The CvM gof test using the empirical copula</h2><span id='topic+gofCvM'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofCvM">gofCvM</a></code> performs the <code>"CvM"</code> gof test, described in Genest
et al. (2009), for copulae and compares the empirical copula against a
parametric estimate of the copula derived under the null hypothesis. The
margins can be estimated by a bunch of distributions and the time which is
necessary for the estimation can be given. The approximate p-values are
computed with a parametric bootstrap, which computation can be accelerated
by enabling in-build parallel computation. The gof statistics are computed
with the function <code><a href="copula.html#topic+gofTstat">gofTstat</a></code> from the package copula. It is
possible to insert datasets of all dimensions above 1 and the possible
copulae are <code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"huslerReiss"</code>, <code>"tawn"</code>, <code>"tev"</code>, <code>"fgm"</code> and 
<code>"plackett"</code>. The parameter estimation is performed with pseudo
maximum likelihood method. In case the estimation fails, inversion of
Kendall's tau is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofCvM(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "huslerReiss", "tawn", "tev", "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofCvM_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofCvM_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With the pseudo observations <code class="reqn">U_{ij}</code> for <code class="reqn">i = 1, \dots,n</code>, <code class="reqn">j = 1, \dots,d</code> and <code class="reqn">\mathbf{u} \in
[0,1]^d</code> is the empirical copula given by <code class="reqn">C_n(\mathbf{u})
= \frac{1}{n} \sum_{i = 1}^n \mathbf{I}(U_{i1} \leq u_1, \dots, U_{id} \leq
u_d).</code> It shall be
tested the <code class="reqn">H_0</code> hypothesis: </p>
<p style="text-align: center;"><code class="reqn">C \in \mathcal{C}_0</code>
</p>

<p>with <code class="reqn">\mathcal{C}_0</code> as the true class of copulae under
<code class="reqn">H_0</code>. The test statistic <code class="reqn">T</code> is then defined as
</p>
<p style="text-align: center;"><code class="reqn">T = n \int_{[0,1]^d} \{ C_n(\mathbf{u}) - C_{\theta_n}(\mathbf{u})
\}^2 d C_n(\mathbf{u})</code>
</p>

<p>with <code class="reqn">C_{\theta_n}(\mathbf{u})</code> the estimation of <code class="reqn">C</code>
under the <code class="reqn">H_0</code>.
</p>
<p>The approximate p-value is computed by the formula,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Rosenblatt, M. (1952). Remarks on a Multivariate Transformation.
<em>The Annals of Mathematical Statistics 23, 3, 470-472</em>.<br /> <br /> Hering,
C. and Hofert, M. (2014). Goodness-of-fit tests for Archimedean copulas in
high dimensions. <em>Innovations in Quantitative Risk Management</em>.<br /> <br />
Marius Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofCvM("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofGetHybrid'>GetHybrid gof test</h2><span id='topic+gofGetHybrid'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofGetHybrid">gofGetHybrid</a></code> computes based on previous test results from this
package and on p-values from your own goodness-of-fit tests the hybrid test
p-values for the specified testing size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofGetHybrid(result, p_values = NULL, nsets = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofGetHybrid_+3A_result">result</code></td>
<td>
<p>An object of <code>class</code> gofCOP.</p>
</td></tr>
<tr><td><code id="gofGetHybrid_+3A_p_values">p_values</code></td>
<td>
<p>A vector containing different p-values from your own
goodness-of-fit tests. If the elements are unnamed, the test results in the
output will be labeled with Test_A, Test_B etc.</p>
</td></tr>
<tr><td><code id="gofGetHybrid_+3A_nsets">nsets</code></td>
<td>
<p>The desired number of tests to be included in each hybrid test.
It should be an integer larger than 1 and smaller or equal than the number
of tests given in <code>result</code> and <code>p_values</code> together. If
<code>nsets</code> is set NULL (default), all possible testing sizes are
calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In most of scenarios for goodness-of-fit tests, including the one for copula
models (e.g. Genest et al. (2009)) there exists no single dominant optimal
test. Zhang et al. (2015) proposed a hybrid test which performed in their
simulation study more desirably compared to the applied single tests.
</p>
<p>The p-value is a combination of the single tests in the following way:
</p>
<p style="text-align: center;"><code class="reqn">p_n^{hybrid} = \min(q \cdot \min{(p_n^{(1)}, \dots, p_n^{(q)})},
1)</code>
</p>
<p> where <code class="reqn">q</code> is
the number of tests and <code class="reqn">p_n^{(i)}</code> the p-value of the test
<code class="reqn">i</code>. It is ensured that the hybrid test is consistent as long as at
least one of the tests is consistent.
</p>
<p>The computation of the individual p-values is performed as described in the
details of this tests. Note that the derivation differs.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, S., Okhrin, O., Zhou, Q., and Song, P.. Goodness-of-fit
Test For Specification of Semiparametric Copula Dependence Models.
<em>Journal of Econometrics, 193, 2016, pp. 215-233</em>
doi: <a href="https://doi.org/10.1016/j.jeconom.2016.02.017">10.1016/j.jeconom.2016.02.017</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

res_2 = gof(x = IndexReturns2D, copula = "normal", 
            tests = c("gofKernel", "gofKendallCvM", "gofWhite"), M = 10)
gofGetHybrid(result = res_2, 
             p_values = c("MyTest" = 0.3, "AnotherTest" = 0.7), nsets = 3)

</code></pre>

<hr>
<h2 id='gofKendallCvM'>gof test (Cramer-von Mises) based on Kendall's process</h2><span id='topic+gofKendallCvM'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofKendallCvM">gofKendallCvM</a></code> tests a given dataset for a copula based on
Kendall's process with the Cramer-von Mises test statistic. The margins can
be estimated by a bunch of distributions and the time which is necessary for
the estimation can be given. The possible copulae are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>. See for
reference Genest et al. (2009). The parameter estimation is performed with
pseudo maximum likelihood method. In case the estimation fails, inversion of
Kendall's tau is used. The approximate p-values are computed with a
parametric bootstrap, which computation can be accelerated by enabling
in-build parallel computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofKendallCvM(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "huslerReiss", "tawn", "tev", "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofKendallCvM_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_m">M</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofKendallCvM_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With the pseudo observations <code class="reqn">U_{ij}</code> for <code class="reqn">i = 1, \dots,n</code>, <code class="reqn">j = 1, \dots,d</code> and <code class="reqn">\mathbf{u} \in
[0,1]^d</code> is the empirical copula given by <code class="reqn">C_n(\mathbf{u})
= \frac{1}{n} \sum_{i = 1}^n \mathbf{I}(U_{i1} \leq u_1, \dots, U_{id} \leq
u_d).</code> Let the
rescaled pseudo observations be <code class="reqn">V_1 = C_n(U_1), \dots, V_n =
C_n(U_n)</code> and the distribution
function of <code class="reqn">V</code> shall be <code class="reqn">K</code>. The estimated version is given by
</p>
<p style="text-align: center;"><code class="reqn">K_n(v) = \frac{1}{n} \sum_{i=1}^n \mathbf{I}(V_i \leq v)</code>
</p>
<p> with <code class="reqn">v \in [0,1]^d.</code> The
testable <code class="reqn">H_0^{'}</code> hypothesis is then </p>
<p style="text-align: center;"><code class="reqn">K \in \mathcal{K}_0 =
\{K_{\theta} : \theta \in \Theta \}</code>
</p>

<p>with <code class="reqn">\Theta</code> being an open subset of <code class="reqn">R^p</code> for an
integer <code class="reqn">p \geq 1</code>, see Genest et al. (2009). The resulting
Cramer-von Mises test statistic is then given by </p>
<p style="text-align: center;"><code class="reqn">T = n \int_0^1
(K_n(v) - K_{\theta_n})^2 d K_{\theta_n}(v).</code>
</p>

<p>Because <code class="reqn">H_0^{'}</code> consists of more distributions than
<code class="reqn">H_0</code> the test is not necessarily consistent.
</p>
<p>The approximate p-value is computed by the formula
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br /> <br /> Christian
Genest, Jean-Francois Quessy, Bruno Remillard (2006). Goodness-of-fit
Procedures for Copula Models Based on the Probability Integral
Transformation. <em>Scandinavian Journal of Statistics, Volume 33, Issue
2, 2006, Pages 337-366</em>.
doi: <a href="https://doi.org/10.1111/j.1467-9469.2006.00470.x">10.1111/j.1467-9469.2006.00470.x</a><br /> <br /> Ulf
Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler
(2015). VineCopula: Statistical Inference of Vine Copulas. <em>R package
version 1.4.</em>. <a href="https://cran.r-project.org/package=VineCopula">https://cran.r-project.org/package=VineCopula</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofKendallCvM("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofKendallKS'>gof test (Kolmogorov-Smirnov) based on Kendall's process</h2><span id='topic+gofKendallKS'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofKendallKS">gofKendallKS</a></code> tests a given dataset for a copula based on
Kendall's process with the Kolmogorov-Smirnov test statistic. The margins
can be estimated by a bunch of distributions and the time which is necessary
for the estimation can be given. The possible copulae are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>. See for
reference Genest et al. (2009). The parameter estimation is performed with
pseudo maximum likelihood method. In case the estimation fails, inversion of
Kendall's tau is used. The approximate p-values are computed with a
parametric bootstrap, which computation can be accelerated by enabling
in-build parallel computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofKendallKS(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "huslerReiss", "tawn", "tev", "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofKendallKS_+3A_copula">copula</code></td>
<td>
<p>Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_m">M</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofKendallKS_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With the pseudo observations <code class="reqn">U_{ij}</code> for <code class="reqn">i = 1, \dots,n</code>, <code class="reqn">j = 1, \dots,d</code> and <code class="reqn">\mathbf{u} \in
[0,1]^d</code> is the empirical copula given by <code class="reqn">C_n(\mathbf{u})
= \frac{1}{n} \sum_{i = 1}^n \mathbf{I}(U_{i1} \leq u_1, \dots, U_{id} \leq
u_d).</code> Let the
rescaled pseudo observations be <code class="reqn">V_1 = C_n(U_1), \dots, V_n =
C_n(U_n)</code> and the distribution
function of <code class="reqn">V</code> shall be <code class="reqn">K</code>. The estimated version is given by
</p>
<p style="text-align: center;"><code class="reqn">K_n(v) = \frac{1}{n} \sum_{i=1}^n \mathbf{I}(V_i \leq v)</code>
</p>
<p> with <code class="reqn">v \in [0,1]^d.</code>
The testable <code class="reqn">H_0^{'}</code> hypothesis is then </p>
<p style="text-align: center;"><code class="reqn">K \in
\mathcal{K}_0 = \{K_{\theta} : \theta \in \Theta \}</code>
</p>
<p> with <code class="reqn">\Theta</code> being an open subset of
<code class="reqn">R^p</code> for an integer <code class="reqn">p \geq 1</code>, see Genest et al.
(2009). The resulting Kolmogorov-Smirnof test statistic is then given by
</p>
<p style="text-align: center;"><code class="reqn">T = \sqrt{n} \sup_{v \in [0,1]} |K_n(v) - K_{\theta_n}| .</code>
</p>

<p>Because <code class="reqn">H_0^{'}</code> consists of more distributions than the
<code class="reqn">H_0</code> is the test not necessarily consistent.
</p>
<p>The approximate p-value is computed by the formula
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br /> <br /> Christian
Genest, Jean-Francois Quessy, Bruno Remillard (2006). Goodness-of-fit
Procedures for Copula Models Based on the Probability Integral
Transformation. <em>Scandinavian Journal of Statistics, Volume 33, Issue
2, 2006, Pages 337-366</em>.
doi: <a href="https://doi.org/10.1111/j.1467-9469.2006.00470.x">10.1111/j.1467-9469.2006.00470.x</a><br /> <br /> Ulf
Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler
(2015). VineCopula: Statistical Inference of Vine Copulas. <em>R package
version 1.4.</em>. <a href="https://cran.r-project.org/package=VineCopula">https://cran.r-project.org/package=VineCopula</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofKendallKS("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofKernel'>2 dimensional gof test of Scaillet (2007)</h2><span id='topic+gofKernel'></span>

<h3>Description</h3>

<p><code>gofKernel</code> tests a 2 dimensional dataset with the Scaillet test for a
copula. The possible copulae are <code>"normal"</code>, <code>"t"</code>, 
<code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>. The parameter
estimation is performed with pseudo maximum likelihood method. In case the
estimation fails, inversion of Kendall's tau is used. The approximate
p-values are computed with a parametric bootstrap, which computation can be
accelerated by enabling in-build parallel computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofKernel(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "huslerReiss", "tawn", "tev", "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  MJ = 100,
  dispstr = "ex",
  delta.J = 0.5,
  nodes.Integration = 12,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofKernel_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_param">param</code></td>
<td>
<p>The parameter to be used.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated with a maximum likelihood
estimation.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_mj">MJ</code></td>
<td>
<p>Size of bootstrapping sample.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_delta.j">delta.J</code></td>
<td>
<p>Scaling parameter for the matrix of smoothing parameters.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_nodes.integration">nodes.Integration</code></td>
<td>
<p>Number of knots of the bivariate Gauss-Legendre
quadrature.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofKernel_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Scaillet test is a kernel-based goodness-of-fit test with a fixed
smoothing parameter. For the copula density <code class="reqn">c(\mathbf{u}, \theta)</code>, the corresponding kernel estimator is given by
</p>
<p style="text-align: center;"><code class="reqn">c_n(\mathbf{u}) = \frac{1}{n} \sum_{i=1}^n K_H[\mathbf{u} - (U_{i1},
\dots, U_{id})^{\top}], </code>
</p>
<p> where <code class="reqn">U_{ij}</code> for <code class="reqn">i = 1, \dots,n</code>; <code class="reqn">j = 1, \dots,d</code> are the pseudo observations,
<code class="reqn">\mathbf{u} \in [0,1]^d</code> and <code class="reqn">K_H(y) =
K(H^{-1}y)/\det(H)</code> for which a bivariate
quadratic kernel is used, as in Scaillet (2007). The matrix of smoothing
parameters is <code class="reqn">H = 2.6073n^{-1/6} \hat{\Sigma}^{1/2}</code> with <code class="reqn">\hat{\Sigma}</code> the sample covariance
matrix.  The test statistic is then given by </p>
<p style="text-align: center;"><code class="reqn">T = \int_{[0,1]^d}
\{c_n(\mathbf{u}) - K_H * c(\mathbf{u}, \theta_n)\} \omega(\mathbf{u}) d
\mathbf{u}, </code>
</p>

<p>where <code class="reqn">*</code> denotes the convolution operator and <code class="reqn">\omega</code> is
a weight function, see Zhang et al. (2015). The bivariate Gauss-Legendre
quadrature method is used to compute the integral in the test statistic
numerically, see Scaillet (2007).
</p>
<p>The approximate p-value is computed by the formula </p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M
\mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, S., Okhrin, O., Zhou, Q., and Song, P.. Goodness-of-fit
Test For Specification of Semiparametric Copula Dependence Models.
<em>Journal of Econometrics, 193, 2016, pp. 215-233</em>
doi: <a href="https://doi.org/10.1016/j.jeconom.2016.02.017">10.1016/j.jeconom.2016.02.017</a> <br /> <br /> Scaillet, O.
(2007). Kernel based goodness-of-fit tests for copulas with fixed smoothing
parameters. <em>Journal of Multivariate Analysis, 98:533-543</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofKernel("normal", IndexReturns2D, M = 5, MJ = 5)

</code></pre>

<hr>
<h2 id='gofKS'>The KS gof test using the empirical copula</h2><span id='topic+gofKS'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofKS">gofKS</a></code> performs the <code>"KS"</code> gof test for copulae 
and compares the empirical copula against a parametric estimate of the 
copula derived under the null hypothesis. The margins can be estimated by a 
bunch of distributions and the time which is necessary for the estimation 
can be given. The approximate p-values are computed with a parametric 
bootstrap, which computation can be accelerated by enabling in-build parallel 
computation. The gof statistics are computed with the function 
<code><a href="copula.html#topic+gofTstat">gofTstat</a></code> from the package copula. It is possible to insert 
datasets of all dimensions above 1 and the possible copulae are 
<code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"huslerReiss"</code>, <code>"tawn"</code>, <code>"tev"</code>, <code>"fgm"</code> and 
<code>"plackett"</code>. The parameter estimation is performed with pseudo maximum 
likelihood method. In case the estimation fails, inversion of 
Kendall's tau is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofKS(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "huslerReiss", "tawn", "tev", "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofKS_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"huslerReiss"</code>, <code>"tawn"</code>, 
<code>"tev"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofKS_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With the pseudo observations <code class="reqn">U_{ij}</code> for <code class="reqn">i = 1, \dots,n</code>, <code class="reqn">j = 1, \dots,d</code> and <code class="reqn">\mathbf{u} \in
[0,1]^d</code> is the empirical copula given by <code class="reqn">C_n(\mathbf{u})
= \frac{1}{n} \sum_{i = 1}^n \mathbf{I}(U_{i1} \leq u_1, \dots, U_{id} \leq
u_d).</code> It shall be
tested the <code class="reqn">H_0</code> hypothesis: </p>
<p style="text-align: center;"><code class="reqn">C \in \mathcal{C}_0</code>
</p>

<p>with <code class="reqn">\mathcal{C}_0</code> as the true class of copulae under
<code class="reqn">H_0</code>. The resulting Kolmogorov-Smirnof test statistic is then 
given by </p>
<p style="text-align: center;"><code class="reqn">T = \sqrt{n} \sup_{v \in [0,1]} |C_n(v) - C_{\theta_n}| 
</code>
</p>
<p> with 
<code class="reqn">C_{\theta_n}(\mathbf{u})</code> the estimation of <code class="reqn">C</code>
under the <code class="reqn">H_0</code>.
</p>
<p>The approximate p-value is computed by the formula,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Rosenblatt, M. (1952). Remarks on a Multivariate Transformation.
<em>The Annals of Mathematical Statistics 23, 3, 470-472</em>.<br /> <br /> Hering,
C. and Hofert, M. (2014). Goodness-of-fit tests for Archimedean copulas in
high dimensions. <em>Innovations in Quantitative Risk Management</em>.<br /> <br />
Marius Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofKS("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofOutputHybrid'>Output Hybrid gof test</h2><span id='topic+gofOutputHybrid'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofOutputHybrid">gofOutputHybrid</a></code> outputs the desired Hybrid tests from previous
test results from this package for the specified testing size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofOutputHybrid(result, tests = NULL, nsets = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofOutputHybrid_+3A_result">result</code></td>
<td>
<p>An object of <code>class</code> gofCOP.</p>
</td></tr>
<tr><td><code id="gofOutputHybrid_+3A_tests">tests</code></td>
<td>
<p>Individual tests which should be used in the hybrid test.
Submit a vector containing the position of the individual tests as they
appear in the object submitted, e.g. <code>c(1,4)</code> for the 1st and 4th
tests. If <code>tests</code> is set NULL (default), all possible testing sizes are
returned.</p>
</td></tr>
<tr><td><code id="gofOutputHybrid_+3A_nsets">nsets</code></td>
<td>
<p>The desired number of tests to be included in each hybrid test.
It should be an integer larger than 1 and smaller or equal than the number
of tests given in <code>result</code>. If <code>nsets</code> is set NULL (default), all
possible testing sizes are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In most of scenarios for goodness-of-fit tests, including the one for copula
models (e.g. Genest et al. (2009)) there exists no single dominant optimal
test. Zhang et al. (2015) proposed a hybrid test which performed in their
simulation study more desirably compared to the applied single tests.
</p>
<p>The p-value is a combination of the single tests in the following way:
</p>
<p style="text-align: center;"><code class="reqn">p_n^{hybrid} = \min(q \cdot \min{(p_n^{(1)}, \dots, p_n^{(q)})},
1)</code>
</p>
<p> where <code class="reqn">q</code> is
the number of tests and <code class="reqn">p_n^{(i)}</code> the p-value of the test
<code class="reqn">i</code>. It is ensured that the hybrid test is consistent as long as at
least one of the tests is consistent.
</p>
<p>The computation of the individual p-values is performed as described in the
details of this tests. Note that the derivation differs.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, S., Okhrin, O., Zhou, Q., and Song, P.. Goodness-of-fit
Test For Specification of Semiparametric Copula Dependence Models.
<em>Journal of Econometrics, 193, 2016, pp. 215-233</em>
doi: <a href="https://doi.org/10.1016/j.jeconom.2016.02.017">10.1016/j.jeconom.2016.02.017</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

res1 = gof(IndexReturns2D, priority = "tests", copula = "normal", 
           tests = c("gofKendallCvM", "gofRosenblattSnC", "gofKendallKS"), 
           M = 5)
gofOutputHybrid(res1, tests = 1, nsets = 2)
# mind the difference to the regular output
res1

</code></pre>

<hr>
<h2 id='gofPIOSRn'>2 and 3 dimensional gof test based on the in-and-out-of-sample approach</h2><span id='topic+gofPIOSRn'></span>

<h3>Description</h3>

<p><code>gofPIOSRn</code> tests a 2 or 3 dimensional dataset with the approximate
PIOS test for a copula. The possible copulae are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"fgm"</code> and <code>"plackett"</code>. The
parameter estimation is performed with pseudo maximum likelihood method. In
case the estimation fails, inversion of Kendall's tau is used. The
approximate p-values are computed with a semiparametric bootstrap, which
computation can be accelerated by enabling in-build parallel computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofPIOSRn(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofPIOSRn_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_param">param</code></td>
<td>
<p>The parameter to be used.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated with a maximum likelihood
estimation.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofPIOSRn_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;Rn&quot; test is introduced in Zhang et al. (2015). It is a information
ratio statistic which is approximately equivalent to the &quot;Tn&quot; test, which is
the PIOS test. Both test the <code class="reqn">H_0</code> hypothesis </p>
<p style="text-align: center;"><code class="reqn">H_0 : C_0 \in
\mathcal{C}.</code>
</p>
<p> &quot;Rn&quot; is introduced because the &quot;Tn&quot; test has
to estimate <code class="reqn">n/m</code> parameters which can be computationally demanding. The
test statistic of the &quot;Tn&quot; test is defined as </p>
<p style="text-align: center;"><code class="reqn">T = \sum_{b=1}^M
\sum_{k=1}^m \{l(U_k^b;\theta_n ) - l(U_k^b;\theta_n^{-b} )\}</code>
</p>

<p>with <code class="reqn">l</code> the log likelihood function, the pseudo observations
<code class="reqn">U_{ij}</code> for <code class="reqn">i = 1, \dots,n</code>; <code class="reqn">j = 1,
\dots,d</code> and </p>
<p style="text-align: center;"><code class="reqn">\theta_n = \arg \min_{\theta} \sum_{i=1}^n
l(U_i; \theta)</code>
</p>
<p> and
</p>
<p style="text-align: center;"><code class="reqn">\theta_n^{-b} = \arg \min_{\theta} \sum_{b^{'} \neq b}^M \sum_{k=1}^m
l(U_k^{b^{'}}; \theta), b=1, \dots, M.</code>
</p>

<p>By defining two information matrices </p>
<p style="text-align: center;"><code class="reqn">S(\theta) = - E_0
[\frac{\partial^2}{\partial \theta \partial \theta^{\top}}l \{U_1; \theta \}
],</code>
</p>
 <p style="text-align: center;"><code class="reqn">V(\theta) =
E_0 [\frac{\partial}{\partial \theta} l (U_1; \theta)
\{\frac{\partial}{\partial \theta} l (U_1; \theta) \}^{\top} ]</code>
</p>
<p> where
<code class="reqn">S(\cdot)</code> represents the negative sensitivity matrix,
<code class="reqn">V(\cdot)</code> the variability matrix and <code class="reqn">E_0</code> is the
expectation under the true copula <code class="reqn">C_0</code>. Under suitable regularity
conditions, given in Zhang et al. (2015), holds then in probability, that
</p>
<p style="text-align: center;"><code class="reqn">T = tr\{S(\theta^{*})^{-1} V(\theta^{*}) \}</code>
</p>
<p> as <code class="reqn">n \rightarrow \infty.</code>
</p>
<p>The approximate p-value is computed by the formula </p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M
\mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>
<p> For
more details, see Zhang et al. (2015). The applied estimation method is the
two-step pseudo maximum likelihood approach, see Genest and Rivest (1995).
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, S., Okhrin, O., Zhou, Q., and Song, P.. Goodness-of-fit
Test For Specification of Semiparametric Copula Dependence Models.
<em>Journal of Econometrics, 193, 2016, pp. 215-233</em>
doi: <a href="https://doi.org/10.1016/j.jeconom.2016.02.017">10.1016/j.jeconom.2016.02.017</a> <br /> <br /> Genest, C., K.
G. and Rivest, L.-P. (1995). A semiparametric estimation procedure of
dependence parameters in multivariate families of distributions.
<em>Biometrika, 82:534-552</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofPIOSRn("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofPIOSTn'>2 and 3 dimensional gof test based on the in-and-out-of-sample approach</h2><span id='topic+gofPIOSTn'></span>

<h3>Description</h3>

<p><code>gofPIOSTn</code> tests a 2 or 3 dimensional dataset with the PIOS test for a
copula. The possible copulae are <code>"normal"</code>, <code>"t"</code>, 
<code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"fgm"</code> and <code>"plackett"</code>. 
The parameter estimation is performed with pseudo maximum likelihood method. 
In case the estimation fails, inversion of Kendall's tau is used. The 
approximate p-values are computed with a semiparametric bootstrap, which 
computation can be accelerated by enabling in-build parallel computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofPIOSTn(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  m = 1,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofPIOSTn_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_param">param</code></td>
<td>
<p>The parameter to be used.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated with a maximum likelihood
estimation.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula. For computational reasons the entry is
limited to 60 degrees of freedom.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated. For computational reasons the estimate is limited to 60 degrees
of freedom.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_m">m</code></td>
<td>
<p>Length of blocks.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofPIOSTn_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;Tn&quot; test is introduced in Zhang et al. (2015). It tests the
<code class="reqn">H_0</code> hypothesis </p>
<p style="text-align: center;"><code class="reqn">H_0 : C_0 \in \mathcal{C}.</code>
</p>

<p>For the test blocks of length <code>m</code> are constructed out of the data. The
test compares then the pseudo likelihood of the data in each block with the
overall parameter and with the parameter by leaving out the data in the
block. By this procedure can be determined if the data in the block
influence the parameter estimation significantly. The test statistic is
defined as </p>
<p style="text-align: center;"><code class="reqn">T = \sum_{b=1}^M \sum_{k=1}^m [l\{U_k^b;\theta_n \} -
l\{U_k^b;\theta_n^{-b} \}]</code>
</p>

<p>with the pseudo observations <code class="reqn">U_{ij}</code> for <code class="reqn">i = 1, \dots,n</code>; <code class="reqn">j = 1, \dots,d</code> and </p>
<p style="text-align: center;"><code class="reqn">\theta_n = \arg
\min_{\theta} \sum_{i=1}^n l(U_i; \theta)</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">\theta_n^{-b} = \arg
\min_{\theta} \sum_{b^{'} \neq b}^M \sum_{i=1}^m l(U_i^{b^{'}}; \theta),
b=1, \dots, M.</code>
</p>

<p>The approximate p-value is computed by the formula </p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M
\mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>The applied estimation method is the two-step pseudo maximum likelihood
approach, see Genest and Rivest (1995).
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhang, S., Okhrin, O., Zhou, Q., and Song, P.. Goodness-of-fit
Test For Specification of Semiparametric Copula Dependence Models.
<em>Journal of Econometrics, 193, 2016, pp. 215-233</em>
doi: <a href="https://doi.org/10.1016/j.jeconom.2016.02.017">10.1016/j.jeconom.2016.02.017</a> <br /> <br /> Genest, C., K.
G. and Rivest, L.-P. (1995). A semiparametric estimation procedure of
dependence parameters in multivariate families of distributions.
<em>Biometrika, 82:534-552</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofPIOSTn("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofRosenblattChisq'>Gof test using the Anderson-Darling test statistic and the chi-square
distribution</h2><span id='topic+gofRosenblattChisq'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofRosenblattChisq">gofRosenblattChisq</a></code> contains the RosenblattChisq gof test for
copulae, described in Genest (2009) and Hofert (2014), and compares the
empirical copula against a parametric estimate of the copula derived under
the null hypothesis. The margins can be estimated by a bunch of
distributions and the time which is necessary for the estimation can be
given. The approximate p-values are computed with a parametric bootstrap,
which computation can be accelerated by enabling in-build parallel
computation. The gof statistics are computed with the function
<code><a href="copula.html#topic+gofTstat">gofTstat</a></code> from the package copula. It is possible to insert
datasets of all dimensions above 1 and the possible copulae are
<code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"fgm"</code> and <code>"plackett"</code>. The parameter estimation is performed 
with pseudo maximum likelihood method. In case the estimation fails, 
inversion of Kendall's tau is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofRosenblattChisq(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofRosenblattChisq_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofRosenblattChisq_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This Anderson-Darling test statistic (supposedly) computes
U[0,1]-distributed (under <code class="reqn">H_0</code>) random variates via the
distribution function of chi-square distribution with d degrees of freedom,
see Hofert et al. (2014). The <code class="reqn">H_0</code> hypothesis is </p>
<p style="text-align: center;"><code class="reqn">C \in
\mathcal{C}_0</code>
</p>
<p> with <code class="reqn">\mathcal{C}_0</code> as the true class
of copulae under <code class="reqn">H_0</code>.
</p>
<p>This test is based on the Rosenblatt probability integral transform which
uses the mapping <code class="reqn">\mathcal{R}: (0,1)^d \rightarrow (0,1)^d</code>. Following Genest et al. (2009) ensures this transformation the
decomposition of a random vector <code class="reqn">\mathbf{u} \in [0,1]^d</code>
with a distribution into mutually independent elements with a uniform
distribution on the unit interval. The mapping provides pseudo observations
<code class="reqn">E_i</code>, given by </p>
<p style="text-align: center;"><code class="reqn">E_1 = \mathcal{R}(U_1), \dots, E_n =
\mathcal{R}(U_n).</code>
</p>
<p> The mapping is
performed by assigning to every vector <code class="reqn">\mathbf{u}</code> for <code class="reqn">e_1 =
u_1</code> and for <code class="reqn">i \in \{2, \dots, d\}</code>,
</p>
<p style="text-align: center;"><code class="reqn">e_i = \frac{\partial^{i-1} C(u_1, \dots, u_i, 1, \dots, 1)}{\partial
u_1 \cdots \partial u_{i-1}} / \frac{\partial^{i-1} C(u_1, \dots, u_{i-1},
1, \dots, 1)}{\partial u_1 \cdots \partial u_{i-1}}.</code>
</p>

<p>The Anderson-Darling test statistic of the variates
</p>
<p style="text-align: center;"><code class="reqn">G(x_j) = \chi_d^2 \left( x_j \right)</code>
</p>

<p>is computed (via <code>ADGofTest::ad.test</code>), where <code class="reqn">x_j = \sum_{i=1}^d
(\Phi^{-1}(e_{ij}))^2</code>, <code class="reqn">\Phi^{-1}</code>
denotes the quantile function of the standard normal distribution function,
<code class="reqn">\chi_d^2</code> denotes the distribution function of the
chi-square distribution with <code>d</code> degrees of freedom, and <code class="reqn">u_{ij}</code>
is the <code class="reqn">j</code>th component in the <code class="reqn">i</code>th row of <code class="reqn">\mathbf{u}</code>.
</p>
<p>The test statistic is then given by </p>
<p style="text-align: center;"><code class="reqn">T = -n - \sum_{j=1}^n \frac{2j -
1}{n} [\ln(G(x_j)) + \ln(1 - G(x_{n+1-j}))].</code>
</p>

<p>The approximate p-value is computed by the formula,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br /> <br /> Marius
Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofRosenblattChisq("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofRosenblattGamma'>Gof test using the Anderson-Darling test statistic and the gamma
distribution</h2><span id='topic+gofRosenblattGamma'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofRosenblattGamma">gofRosenblattGamma</a></code> contains the RosenblattGamma gof tests for
copulae, described in Genest (2009) and Hofert (2014), and compares the
empirical copula against a parametric estimate of the copula derived under
the null hypothesis. The margins can be estimated by a bunch of
distributions and the time which is necessary for the estimation can be
given. The approximate p-values are computed with a parametric bootstrap,
which computation can be accelerated by enabling in-build parallel
computation. The gof statistics are computed with the function
<code><a href="copula.html#topic+gofTstat">gofTstat</a></code> from the package copula. It is possible to insert
datasets of all dimensions above 1 and the possible copulae are
<code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"fgm"</code> and <code>"plackett"</code>. The parameter estimation is performed 
with pseudo maximum likelihood method. In case the estimation fails, 
inversion of Kendall's tau is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofRosenblattGamma(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofRosenblattGamma_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofRosenblattGamma_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This Anderson-Darling test statistic (supposedly) computes
U[0,1]-distributed (under <code class="reqn">H_0</code>) random variates via the
distribution function of the gamma distribution, see Hofert et al. (2014).
As written in Hofert et al. (2014) computes this Anderson-Darling test
statistic for (supposedly) U[0,1]-distributed (under H_0) random variates
via the distribution function of the gamma distribution. The <code class="reqn">H_0</code>
hypothesis is </p>
<p style="text-align: center;"><code class="reqn">C \in \mathcal{C}_0</code>
</p>
<p> with
<code class="reqn">\mathcal{C}_0</code> as the true class of copulae under <code class="reqn">H_0</code>.
</p>
<p>This test is based on the Rosenblatt probability integral transform which
uses the mapping <code class="reqn">\mathcal{R}: (0,1)^d \rightarrow (0,1)^d</code>. Following Genest et al. (2009) ensures this transformation the
decomposition of a random vector <code class="reqn">\mathbf{u} \in [0,1]^d</code>
with a distribution into mutually independent elements with a uniform
distribution on the unit interval. The mapping provides pseudo observations
<code class="reqn">E_i</code>, given by </p>
<p style="text-align: center;"><code class="reqn">E_1 = \mathcal{R}(U_1), \dots, E_n =
\mathcal{R}(U_n).</code>
</p>
<p> The mapping is
performed by assigning to every vector <code class="reqn">\mathbf{u}</code> for <code class="reqn">e_1 =
u_1</code> and for <code class="reqn">i \in \{2, \dots, d\}</code>,
</p>
<p style="text-align: center;"><code class="reqn">e_i = \frac{\partial^{i-1} C(u_1, \dots, u_i, 1, \dots, 1)}{\partial
u_1 \cdots \partial u_{i-1}} / \frac{\partial^{i-1} C(u_1, \dots, u_{i-1},
1, \dots, 1)}{\partial u_1 \cdots \partial u_{i-1}}.</code>
</p>

<p>The Anderson-Darling test statistic of the variates
</p>
<p style="text-align: center;"><code class="reqn">G(x_j) = \Gamma_d \left( x_j \right)</code>
</p>

<p>is computed (via <code>ADGofTest::ad.test</code>), where <code class="reqn">x_j = \sum_{i=1}^d
(- \ln e_{ij})</code>,
<code class="reqn">\Gamma_d()</code> denotes the distribution function of
the gamma distribution with shape parameter d and shape parameter one (being
equal to an Erlang(d) distribution function).
</p>
<p>The test statistic is then given by </p>
<p style="text-align: center;"><code class="reqn">T = -n - \sum_{j=1}^n \frac{2j -
1}{n} [\ln(G(x_j)) + \ln(1 - G(x_{n+1-j}))].</code>
</p>

<p>The approximate p-value is computed by the formula,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br /> <br /> Marius
Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofRosenblattGamma("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofRosenblattSnB'>The SnB test based on the Rosenblatt transformation</h2><span id='topic+gofRosenblattSnB'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofRosenblattSnB">gofRosenblattSnB</a></code> contains the SnB gof test for copulae from
Genest (2009) and compares the empirical copula against a parametric
estimate of the copula derived under the null hypothesis. The margins can be
estimated by a bunch of distributions and the time which is necessary for
the estimation can be given. The approximate p-values are computed with a
parametric bootstrap, which computation can be accelerated by enabling
in-build parallel computation. The gof statistics are computed with the
function <code><a href="copula.html#topic+gofTstat">gofTstat</a></code> from the package copula. It is possible to
insert datasets of all dimensions above 1 and the possible copulae are
<code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"fgm"</code> and <code>"plackett"</code>. The parameter estimation is performed 
with pseudo maximum likelihood method. In case the estimation fails, 
inversion of Kendall's tau is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofRosenblattSnB(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofRosenblattSnB_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnB_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This test is based on the Rosenblatt probability integral transform which
uses the mapping <code class="reqn">\mathcal{R}: (0,1)^d \rightarrow (0,1)^d</code> to test the <code class="reqn">H_0</code> hypothesis </p>
<p style="text-align: center;"><code class="reqn">C \in
\mathcal{C}_0</code>
</p>
<p> with <code class="reqn">\mathcal{C}_0</code> as the true class
of copulae under <code class="reqn">H_0</code>. Following Genest et al. (2009) ensures this
transformation the decomposition of a random vector <code class="reqn">\mathbf{u} \in
[0,1]^d</code> with a distribution into mutually independent
elements with a uniform distribution on the unit interval. The mapping
provides pseudo observations <code class="reqn">E_i</code>, given by </p>
<p style="text-align: center;"><code class="reqn">E_1 =
\mathcal{R}(U_1), \dots, E_n = \mathcal{R}(U_n).</code>
</p>
<p> The mapping is performed by assigning to every vector
<code class="reqn">\mathbf{u}</code> for <code class="reqn">e_1 = u_1</code> and for <code class="reqn">i \in \{2,
\dots, d\}</code>, </p>
<p style="text-align: center;"><code class="reqn">e_i = \frac{\partial^{i-1} C(u_1,
\dots, u_i, 1, \dots, 1)}{\partial u_1 \cdots \partial u_{i-1}} /
\frac{\partial^{i-1} C(u_1, \dots, u_{i-1}, 1, \dots, 1)}{\partial u_1
\cdots \partial u_{i-1}}.</code>
</p>
<p> The resulting independence copula is given by
<code class="reqn">C_{\bot}(\mathbf{u}) = u_1 \cdot \dots \cdot u_d</code>.
</p>
<p>The test statistic <code class="reqn">T</code> is then defined as
</p>
<p style="text-align: center;"><code class="reqn">T = n \int_{[0,1]^d} \{ D_n(\mathbf{u}) - C_{\bot}(\mathbf{u}) \}^2 d
(\mathbf{u})</code>
</p>
<p> with
<code class="reqn">D_n(\mathbf{u}) = \frac{1}{n} \sum_{i = 1}^n \mathbf{I}(E_i \leq
\mathbf{u})</code>.
</p>
<p>The approximate p-value is computed by the formula, see <span class="pkg">copula</span>,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br /> <br /> Marius
Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofRosenblattSnB("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofRosenblattSnC'>The SnC test based on the Rosenblatt transformation</h2><span id='topic+gofRosenblattSnC'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofRosenblattSnC">gofRosenblattSnC</a></code> contains the SnC gof test from Genest (2009)
for copulae and compares the empirical copula against a parametric estimate
of the copula derived under the null hypothesis. The margins can be
estimated by a bunch of distributions and the time which is necessary for
the estimation can be given. The approximate p-values are computed with a
parametric bootstrap, which computation can be accelerated by enabling
in-build parallel computation. The gof statistics are computed with the
function <code><a href="copula.html#topic+gofTstat">gofTstat</a></code> from the package copula. It is possible to
insert datasets of all dimensions above 1 and the possible copulae are
<code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"fgm"</code> and <code>"plackett"</code>. The parameter estimation is performed 
with pseudo maximum likelihood method. In case the estimation fails, 
inversion of Kendall's tau is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofRosenblattSnC(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe", "amh", "galambos",
    "fgm", "plackett"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  dispstr = "ex",
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofRosenblattSnC_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are <code>"normal"</code>, 
<code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, <code>"frank"</code>, <code>"joe"</code>, 
<code>"amh"</code>, <code>"galambos"</code>, <code>"fgm"</code> and <code>"plackett"</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_param">param</code></td>
<td>
<p>The copula parameter to use, if it shall not be estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_df">df</code></td>
<td>
<p>Degrees of freedom, if not meant to be estimated. Only necessary
if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_m">M</code></td>
<td>
<p>Number of bootstrapping loops.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_dispstr">dispstr</code></td>
<td>
<p>A character string specifying the type of the symmetric
positive definite matrix characterizing the elliptical copula. Implemented
structures are &quot;ex&quot; for exchangeable and &quot;un&quot; for unstructured, see package
<code>copula</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofRosenblattSnC_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This test is based on the Rosenblatt probability integral transform which
uses the mapping <code class="reqn">\mathcal{R}: (0,1)^d \rightarrow (0,1)^d</code> to test the <code class="reqn">H_0</code> hypothesis </p>
<p style="text-align: center;"><code class="reqn">C \in
\mathcal{C}_0</code>
</p>
<p> with <code class="reqn">\mathcal{C}_0</code> as the true class
of copulae under <code class="reqn">H_0</code>. Following Genest et al. (2009) ensures this
transformation the decomposition of a random vector <code class="reqn">\mathbf{u} \in
[0,1]^d</code> with a distribution into mutually independent
elements with a uniform distribution on the unit interval. The mapping
provides pseudo observations <code class="reqn">E_i</code>, given by </p>
<p style="text-align: center;"><code class="reqn">E_1 =
\mathcal{R}(U_1), \dots, E_n = \mathcal{R}(U_n).</code>
</p>
<p> The mapping is performed by assigning to every vector
<code class="reqn">\mathbf{u}</code> for <code class="reqn">e_1 = u_1</code> and for <code class="reqn">i \in \{2,
\dots, d\}</code>, </p>
<p style="text-align: center;"><code class="reqn">e_i = \frac{\partial^{i-1} C(u_1,
\dots, u_i, 1, \dots, 1)}{\partial u_1 \cdots \partial u_{i-1}} /
\frac{\partial^{i-1} C(u_1, \dots, u_{i-1}, 1, \dots, 1)}{\partial u_1
\cdots \partial u_{i-1}}.</code>
</p>
<p> The resulting independence copula is given by
<code class="reqn">C_{\bot}(\mathbf{u}) = u_1 \cdot \dots \cdot u_d</code>.
</p>
<p>The test statistic <code class="reqn">T</code> is then defined as
</p>
<p style="text-align: center;"><code class="reqn">T = n \int_{[0,1]^d} \{ D_n(\mathbf{u}) - C_{\bot}(\mathbf{u}) \}^2 d
D_n(\mathbf{u})</code>
</p>
<p> with
<code class="reqn">D_n(\mathbf{u}) = \frac{1}{n} \sum_{i = 1}^n \mathbf{I}(E_i \leq
\mathbf{u})</code>.
</p>
<p>The approximate p-value is computed by the formula, see <span class="pkg">copula</span>,
</p>
<p style="text-align: center;"><code class="reqn">\sum_{b=1}^M \mathbf{I}(|T_b| \geq |T|) / M,</code>
</p>

<p>where <code class="reqn">T</code> and <code class="reqn">T_b</code> denote the test statistic and the
bootstrapped test statistc, respectively.
</p>
<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Christian Genest, Bruno Remillard, David Beaudoin (2009).
Goodness-of-fit tests for copulas: A review and a power study.
<em>Insurance: Mathematics and Economics, Volume 44, Issue 2, April 2009,
Pages 199-213, ISSN 0167-6687</em>.
doi: <a href="https://doi.org/10.1016/j.insmatheco.2007.10.005">10.1016/j.insmatheco.2007.10.005</a><br /> <br /> Marius
Hofert, Ivan Kojadinovic, Martin Maechler, Jun Yan (2014). copula:
Multivariate Dependence with Copulas. <em>R package version 0.999-15.</em>.
<a href="https://cran.r-project.org/package=copula">https://cran.r-project.org/package=copula</a> <br /> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofRosenblattSnC("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='gofTest4Copula'>Applicable gof tests for testing problem</h2><span id='topic+gofTest4Copula'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofTest4Copula">gofTest4Copula</a></code> returns for a given copula and a dimension the
applicable implemented tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofTest4Copula(copula = NULL, d = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofTest4Copula_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are the copulae 
<code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"huslerReiss"</code>, <code>"tawn"</code>, <code>"tev"</code>, <code>"fgm"</code> and 
<code>"plackett"</code>. For the default <code>NULL</code>, all tests in the package are
returned.</p>
</td></tr>
<tr><td><code id="gofTest4Copula_+3A_d">d</code></td>
<td>
<p>The dimension to search for.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Before performing a gof test on a dataset, it pays out to have a close look
at the Scatterplot to receive an idea about the possible type of copula.
Afterwards follows the decision about the test. The tests in this package
can be used for different types of copulae functions and dimensions. This
function is dedicated to help finding the applicable gof tests for the
dataset.
</p>


<h3>Value</h3>

<p>A character vector which consists of the names of the tests.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
gofTest4Copula("clayton", d = 2)

gofTest4Copula("gumbel", d = 5)

</code></pre>

<hr>
<h2 id='gofWhich'>The function <code>gofWhich</code> was renamed to <code>gofTest4Copula</code>. Please
use <code>gofTest4Copula</code>.</h2><span id='topic+gofWhich'></span>

<h3>Description</h3>

<p>Please see and use the function <code><a href="#topic+gofTest4Copula">gofTest4Copula</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofWhich(copula = NULL, d = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofWhich_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are the copulae
<code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code>, <code>"joe"</code>, <code>"amh"</code>, <code>"galambos"</code>, 
<code>"huslerReiss"</code>, <code>"tawn"</code>, <code>"tev"</code>, <code>"fgm"</code> and 
<code>"plackett"</code>. For the default <code>NULL</code>, all tests in the package are
returned.</p>
</td></tr>
<tr><td><code id="gofWhich_+3A_d">d</code></td>
<td>
<p>The dimension to search for.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector which consists of the names of the tests.
</p>

<hr>
<h2 id='gofWhichCopula'>The function <code>gofWhichCopula</code> was renamed to <code>gofCopula4Test</code>.
Please use <code>gofCopula4Test</code>.</h2><span id='topic+gofWhichCopula'></span>

<h3>Description</h3>

<p>Please see and use the function <code><a href="#topic+gofCopula4Test">gofCopula4Test</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofWhichCopula(test)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofWhichCopula_+3A_test">test</code></td>
<td>
<p>The test to search for copula.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector which consists of the names of the copula.
</p>

<hr>
<h2 id='gofWhite'>2 dimensional gof tests based on White's information matrix equality.</h2><span id='topic+gofWhite'></span>

<h3>Description</h3>

<p><code><a href="#topic+gofWhite">gofWhite</a></code> tests a given 2 dimensional dataset for a copula with
the gof test based on White's information matrix equality. The possible
copulae are <code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code> and <code>"joe"</code>. See for reference Schepsmeier et al. (2015). 
The parameter estimation is performed with pseudo maximum likelihood method. 
In case the estimation fails, inversion of Kendall's tau is used. The margins
can be estimated by a bunch of distributions and the time which is necessary
for the estimation can be given. The approximate p-values are computed with
a parametric bootstrap, which computation can be accelerated by enabling
in-build parallel computation. The computation of the test statistic and
p-values is performed by corresponding functions from the <code>VineCopula</code>
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofWhite(
  copula = c("normal", "t", "clayton", "gumbel", "frank", "joe"),
  x,
  param = 0.5,
  param.est = TRUE,
  df = 4,
  df.est = TRUE,
  margins = "ranks",
  flip = 0,
  M = 1000,
  lower = NULL,
  upper = NULL,
  seed.active = NULL,
  processes = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofWhite_+3A_copula">copula</code></td>
<td>
<p>The copula to test for. Possible are the copulae
<code>"normal"</code>, <code>"t"</code>, <code>"clayton"</code>, <code>"gumbel"</code>, 
<code>"frank"</code> and <code>"joe"</code>.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_x">x</code></td>
<td>
<p>A matrix containing the data with rows being observations and
columns being variables.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_param">param</code></td>
<td>
<p>The parameter to be used.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_param.est">param.est</code></td>
<td>
<p>Shall be either <code>TRUE</code> or <code>FALSE</code>. <code>TRUE</code>
means that <code>param</code> will be estimated with a maximum likelihood
estimation.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_df">df</code></td>
<td>
<p>The degrees of freedom, if not meant to be estimated. Only
necessary if tested for <code>"t"</code>-copula.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_df.est">df.est</code></td>
<td>
<p>Indicates if <code>df</code> shall be estimated. Has to be either
<code>FALSE</code> or <code>TRUE</code>, where <code>TRUE</code> means that it will be
estimated.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_margins">margins</code></td>
<td>
<p>Specifies which estimation method for the margins shall be
used. The default is <code>"ranks"</code>, which is the standard approach to
convert data in such a case. Alternatively the following distributions can
be specified: <code>"beta"</code>, <code>"cauchy"</code>, Chi-squared (<code>"chisq"</code>),
<code>"f"</code>, <code>"gamma"</code>, Log normal (<code>"lnorm"</code>), Normal
(<code>"norm"</code>), <code>"t"</code>, <code>"weibull"</code>, Exponential (<code>"exp"</code>).
Input can be either one method, e.g. <code>"ranks"</code>, which will be used for
estimation of all data sequences. Also an individual method for each margin
can be specified, e.g. <code>c("ranks", "norm", "t")</code> for 3 data sequences.
If one does not want to estimate the margins, set it to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_flip">flip</code></td>
<td>
<p>The control parameter to flip the copula by 90, 180, 270 degrees
clockwise. Only applicable for bivariate copula. Default is 0 and possible 
inputs are 0, 90, 180, 270 and NULL.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_m">M</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the maximum likelihood estimation of the copula
parameter. The constraint is also active in the bootstrapping procedure. The
constraint is not active when a switch to inversion of Kendall's tau is
necessary. Default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_seed.active">seed.active</code></td>
<td>
<p>Has to be either an integer or a vector of M+1 integers.
If an integer, then the seeds for the bootstrapping procedure will be
simulated. If M+1 seeds are provided, then these seeds are used in the
bootstrapping procedure. Defaults to <code>NULL</code>, then <code>R</code> generates
the seeds from the computer runtime. Controlling the seeds is useful for
reproducibility of a simulation study to compare the power of the tests or
for reproducibility of an empirical study.</p>
</td></tr>
<tr><td><code id="gofWhite_+3A_processes">processes</code></td>
<td>
<p>The number of parallel processes which are performed to
speed up the bootstrapping. Shouldn't be higher than the number of logical
processors. Please see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The details are obtained from Schepsmeier et al. (2015) who states that this
test uses the information matrix equality of White (1982). Under correct
model specification is the Fisher Information equivalently calculated as
minus the expected Hessian matrix or as the expected outer product of the
score function. The null hypothesis is </p>
<p style="text-align: center;"><code class="reqn">H_0 : \mathbf{V}(\theta) +
\mathbf{S}(\theta) = 0</code>
</p>
<p> where
<code class="reqn">\mathbf{V}(\theta)</code> is the expected Hessian matrix and
<code class="reqn">\mathbf{S}(\theta)</code> is the expected outer product of the
score function.
</p>
<p>The test statistic is derived by </p>
<p style="text-align: center;"><code class="reqn">T_n = n(\bar{d}(\theta_n))^\top
A_{\theta_n}^{-1} \bar{d}(\theta_n)</code>
</p>
<p> with </p>
<p style="text-align: center;"><code class="reqn">\bar{d}(\theta_n) = \frac{1}{n}
\sum_{i=1}^n vech(\mathbf{V}_n(\theta_n|\mathbf{u}) +
\mathbf{S}_n(\theta_n|\mathbf{u})),</code>
</p>

<p style="text-align: center;"><code class="reqn">d(\theta_n) = vech(\mathbf{V}_n(\theta_n|\mathbf{u}) +
\mathbf{S}_n(\theta_n|\mathbf{u})),</code>
</p>

<p style="text-align: center;"><code class="reqn">A_{\theta_n} = \frac{1}{n} \sum_{i=1}^n (d(\theta_n) - D_{\theta_n}
\mathbf{V}_n(\theta_n)^{-1} \delta l(\theta_n))(d(\theta_n) - D_{\theta_n}
\mathbf{V}_n(\theta_n)^{-1} \delta l(\theta_n))^\top</code>
</p>
<p> and
</p>
<p style="text-align: center;"><code class="reqn">D_{\theta_n} = \frac{1}{n} \sum_{i=1}^n [\delta_{\theta_k}
d_l(\theta_n)]_{l=1, \dots, \frac{p(p+1)}{2}, k=1, \dots, p}</code>
</p>
<p> where <code class="reqn">l(\theta_n)</code> represents the log likelihood
function and <code class="reqn">p</code> is the length of the parameter vector
<code class="reqn">\theta</code>.
</p>
<p>The test statistic will be rejected if </p>
<p style="text-align: center;"><code class="reqn">T &gt; (1 - \alpha)
(\chi^2_{p(p+1)/2})^{-1}.</code>
</p>

<p>For small values of <code>M</code>, initializing the parallelisation via
<code>processes</code> does not make sense. The registration of the parallel
processes increases the computation time. Please consider to enable
parallelisation just for high values of <code>M</code>.
</p>
<p>Please note, the test gofWhite may be unstable for t-copula. Please handle
the results carefully.
</p>


<h3>Value</h3>

<p>An object of the <code>class</code> gofCOP with the components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>a character which informs about the performed analysis</p>
</td></tr>
<tr><td><code>copula</code></td>
<td>
<p>the copula tested for</p>
</td></tr> <tr><td><code>margins</code></td>
<td>
<p>the method used to
estimate the margin distribution.</p>
</td></tr> <tr><td><code>param.margins</code></td>
<td>
<p>the parameters of
the estimated margin distributions. Only applicable if the margins were not
specified as <code>"ranks"</code> or <code>NULL</code>.</p>
</td></tr> <tr><td><code>theta</code></td>
<td>
<p>dependence
parameters of the copulae</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p>the degrees of freedem of the copula.
Only applicable for t-copula.</p>
</td></tr> <tr><td><code>res.tests</code></td>
<td>
<p>a matrix with the p-values
and test statistics of the hybrid and the individual tests</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann,
Benedikt Graeler (2015). VineCopula: Statistical Inference of Vine Copulas.
<em>R package version 1.4.</em>.
<a href="https://cran.r-project.org/package=VineCopula">https://cran.r-project.org/package=VineCopula</a> <br /> <br /> Schepsmeier, U.
and J. Stoeber (2014). Derivatives and Fisher information of bivariate
copulas. <em>Statistical Papers, 55(2), 525-542.</em>
<a href="https://link.springer.com/article/10.1007/s00362-013-0498-x">https://link.springer.com/article/10.1007/s00362-013-0498-x</a> <br /> <br />
Stoeber, J. and U. Schepsmeier (2013). Estimating standard errors in regular
vine copula models <em>Computational Statistics, 28 (6), 2679-2707</em> <br />
<br /> Schepsmeier, U. (2015). Efficient information based goodness-of-fit
tests for vine copula models with fixed margins. <em>Journal of
Multivariate Analysis 138, 34-52.</em> Schepsmeier, U. (2014). A goodness-of-fit
test for regular vine copula models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(IndexReturns2D)

gofWhite("normal", IndexReturns2D, M = 10)

</code></pre>

<hr>
<h2 id='IndexReturns2D'>Log returns of european stock indices</h2><span id='topic+IndexReturns2D'></span>

<h3>Description</h3>

<p>A dataset containing the log returns of two european stock indices in the
year 1998.
</p>


<h3>Format</h3>

<p>A matrix with 100 rows and 2 columns
</p>


<h3>Source</h3>

<p>The raw data are part of the R datasets and were kindly provided by
Erste Bank AG, Vienna, Austria.
</p>

<hr>
<h2 id='IndexReturns3D'>Log returns of european stock indices</h2><span id='topic+IndexReturns3D'></span>

<h3>Description</h3>

<p>A dataset containing the log returns of three european stock indices in the
year 1998.
</p>


<h3>Format</h3>

<p>A matrix with 200 rows and 3 columns
</p>


<h3>Source</h3>

<p>The raw data are part of the R datasets and were kindly provided by
Erste Bank AG, Vienna, Austria.
</p>

<hr>
<h2 id='plot.gofCOP'>Plotting function for objects of class gofCOP</h2><span id='topic+plot.gofCOP'></span>

<h3>Description</h3>

<p>Plots an object of class gofCOP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gofCOP'
plot(
  x,
  copula = NULL,
  hybrid = NULL,
  point.bg = "white",
  point.col = "black",
  point.cex = 0.7,
  jitter.val = 0.1,
  pal = "xmen",
  bean.b.o = 0.2,
  inf.method = "hdi",
  theme = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gofCOP_+3A_x">x</code></td>
<td>
<p>An object of <code>class</code> gofCOP.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_copula">copula</code></td>
<td>
<p>Specify for which copulae to plot the results. The possible
entry is a character vector of the copula names. Default is <code>NULL</code>
which plots all copulae in the object.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_hybrid">hybrid</code></td>
<td>
<p>Specify for which combinations to plot the hybrid tests. The
possible entry is a numeric vector of the hybrid combinations. Default is
<code>NULL</code> which plots all possible combinations.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_point.bg">point.bg</code></td>
<td>
<p>The background color of the plot. Defaults to <code>white</code>.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_point.col">point.col</code></td>
<td>
<p>The color of the dots. Defaults to <code>black</code>.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_point.cex">point.cex</code></td>
<td>
<p>The size of the dots. Defaults to <code>0.7</code>.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_jitter.val">jitter.val</code></td>
<td>
<p>Jittering the dots left/right for better visibility of
results. Defaults to <code>0.1</code>.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_pal">pal</code></td>
<td>
<p>Color palette of the plots. Defaults to <code>xmen</code>.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_bean.b.o">bean.b.o</code></td>
<td>
<p>Specification of how opaque the bars are. Defaults to
<code>0.2</code>.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_inf.method">inf.method</code></td>
<td>
<p>Type of inference bands. Defaults to Bayesian Highest
Density Intervals, <code>hdi</code>.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_theme">theme</code></td>
<td>
<p>Theme of the plot. See <code><a href="yarrr.html#topic+pirateplot">pirateplot</a></code> for more
details. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.gofCOP_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="yarrr.html#topic+pirateplot">pirateplot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plotting function is constructed around <code><a href="yarrr.html#topic+pirateplot">pirateplot</a></code> from
the <code>yarrr</code> package. Please see respective package for more details on
the non-default specifications of the plotting function.
</p>
<p>We recommend not to amend the arguments <code>xlim</code>, <code>data</code>,
<code>formula</code>, <code>sortx</code>, <code>xaxt</code>, <code>ylim</code> and <code>ylab</code> from
<code><a href="yarrr.html#topic+pirateplot">pirateplot</a></code>. The arguments were defined such that the resulting
plot displays the test results in a proper manner.
</p>


<h3>Value</h3>

<p>None
</p>


<h3>References</h3>

<p>Phillips, N. (2017). yarrr: A Companion to the e-Book &quot;YaRrr!:
The Pirate's Guide to R&quot;. <em>R package version 0.1.5.</em>
<a href="https://CRAN.R-project.org/package=yarrr">https://CRAN.R-project.org/package=yarrr</a> <br /> <br />
</p>

<hr>
<h2 id='print.gofCOP'>Printing function for objects of class gofCOP</h2><span id='topic+print.gofCOP'></span>

<h3>Description</h3>

<p><code><a href="#topic+print.gofCOP">print.gofCOP</a></code> prints the values of an object of class gofCOP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gofCOP'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.gofCOP_+3A_x">x</code></td>
<td>
<p>An object of <code>class</code> gofCOP.</p>
</td></tr>
<tr><td><code id="print.gofCOP_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed over. Currently non.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
