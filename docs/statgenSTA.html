<!DOCTYPE html><html><head><title>Help for package statgenSTA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {statgenSTA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#statgenSTA-package'><p>statgenSTA: Single Trial Analysis (STA) of Field Trials</p></a></li>
<li><a href='#dropsRaw'><p>DROPS data set</p></a></li>
<li><a href='#extractSTA'><p>Extract statistics from fitted models</p></a></li>
<li><a href='#fitTD'><p>Fit single trial mixed model</p></a></li>
<li><a href='#getMeta'><p>Get and set metadata for TD objects</p></a></li>
<li><a href='#outlierSTA'><p>Identifying outliers in objects of class STA</p></a></li>
<li><a href='#plot.STA'><p>Plot function for class STA</p></a></li>
<li><a href='#plot.TD'><p>Plot function for class TD</p></a></li>
<li><a href='#report'><p>Base method for creating a report</p></a></li>
<li><a href='#report.STA'><p>Report method for class STA</p></a></li>
<li><a href='#STAtoCross'><p>Convert STA to Cross</p></a></li>
<li><a href='#STAtoTD'><p>Convert STA to TD</p></a></li>
<li><a href='#summary.STA'><p>Summarizing objects of class <code>STA</code></p></a></li>
<li><a href='#summary.TD'><p>Summarizing objects of class <code>TD</code></p></a></li>
<li><a href='#TD'><p>S3 class TD</p></a></li>
<li><a href='#TDHeat05'><p>Field data for a wheat experiment in Mexico</p></a></li>
<li><a href='#TDMaize'><p>Field data for a maize experiment in Tlaltizapan, Mexico</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Single Trial Analysis (STA) of Field Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.12</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-03</td>
</tr>
<tr>
<td>Description:</td>
<td>Phenotypic analysis of field trials using mixed models with and 
    without spatial components. One of a series of statistical genetic packages 
    for streamlining the analysis of typical plant breeding experiments developed
    by Biometris.    
    Some functions have been created to be used in conjunction with the R 
    package 'asreml' for the 'ASReml' software, which can be obtained upon 
    purchase from 'VSN' international (<a href="https://vsni.co.uk/software/asreml-r">https://vsni.co.uk/software/asreml-r</a>). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>emmeans, ggplot2 (&ge; 3.3.0), ggrepel, gridExtra, knitr, lme4,
mapproj, maps, qtl, rlang, scales (&ge; 1.1.0), SpATS (&ge;
1.0-18), xtable</td>
</tr>
<tr>
<td>Suggests:</td>
<td>asreml(&ge; 3.0), rmarkdown, testthat, tibble</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>pdflatex</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://biometris.github.io/statgenSTA/index.html">https://biometris.github.io/statgenSTA/index.html</a>,
<a href="https://github.com/Biometris/statgenSTA/">https://github.com/Biometris/statgenSTA/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Biometris/statgenSTA/issues">https://github.com/Biometris/statgenSTA/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-03 13:28:10 UTC; rossu027</td>
</tr>
<tr>
<td>Author:</td>
<td>Bart-Jan van Rossum
    <a href="https://orcid.org/0000-0002-8673-2514"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Fred van Eeuwijk <a href="https://orcid.org/0000-0003-3672-2921"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Martin Boer <a href="https://orcid.org/0000-0002-1879-4588"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Marcos Malosetti <a href="https://orcid.org/0000-0002-8150-1397"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Daniela Bustos-Korts
    <a href="https://orcid.org/0000-0003-3827-6726"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Emilie J. Millet <a href="https://orcid.org/0000-0002-2913-4892"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Joao Paulo <a href="https://orcid.org/0000-0002-4180-0763"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Maikel Verouden <a href="https://orcid.org/0000-0002-4893-3323"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Willem Kruijer <a href="https://orcid.org/0000-0001-7179-1733"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Ron Wehrens <a href="https://orcid.org/0000-0002-8798-5599"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Choazhi Zheng <a href="https://orcid.org/0000-0001-6030-3933"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bart-Jan van Rossum &lt;bart-jan.vanrossum@wur.nl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-03 14:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='statgenSTA-package'>statgenSTA: Single Trial Analysis (STA) of Field Trials</h2><span id='topic+statgenSTA'></span><span id='topic+statgenSTA-package'></span>

<h3>Description</h3>

<p>Phenotypic analysis of field trials using mixed models with and without spatial components. One of a series of statistical genetic packages for streamlining the analysis of typical plant breeding experiments developed by Biometris. Some functions have been created to be used in conjunction with the R package 'asreml' for the 'ASReml' software, which can be obtained upon purchase from 'VSN' international (<a href="https://vsni.co.uk/software/asreml-r">https://vsni.co.uk/software/asreml-r</a>).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Bart-Jan van Rossum <a href="mailto:bart-jan.vanrossum@wur.nl">bart-jan.vanrossum@wur.nl</a> (<a href="https://orcid.org/0000-0002-8673-2514">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Fred van Eeuwijk (<a href="https://orcid.org/0000-0003-3672-2921">ORCID</a>) [contributor]
</p>
</li>
<li><p> Martin Boer (<a href="https://orcid.org/0000-0002-1879-4588">ORCID</a>) [contributor]
</p>
</li>
<li><p> Marcos Malosetti (<a href="https://orcid.org/0000-0002-8150-1397">ORCID</a>) [contributor]
</p>
</li>
<li><p> Daniela Bustos-Korts (<a href="https://orcid.org/0000-0003-3827-6726">ORCID</a>) [contributor]
</p>
</li>
<li><p> Emilie J. Millet (<a href="https://orcid.org/0000-0002-2913-4892">ORCID</a>) [contributor]
</p>
</li>
<li><p> Joao Paulo (<a href="https://orcid.org/0000-0002-4180-0763">ORCID</a>) [contributor]
</p>
</li>
<li><p> Maikel Verouden (<a href="https://orcid.org/0000-0002-4893-3323">ORCID</a>) [contributor]
</p>
</li>
<li><p> Willem Kruijer (<a href="https://orcid.org/0000-0001-7179-1733">ORCID</a>) [contributor]
</p>
</li>
<li><p> Ron Wehrens (<a href="https://orcid.org/0000-0002-8798-5599">ORCID</a>) [contributor]
</p>
</li>
<li><p> Choazhi Zheng (<a href="https://orcid.org/0000-0001-6030-3933">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://biometris.github.io/statgenSTA/index.html">https://biometris.github.io/statgenSTA/index.html</a>
</p>
</li>
<li> <p><a href="https://github.com/Biometris/statgenSTA/">https://github.com/Biometris/statgenSTA/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/Biometris/statgenSTA/issues">https://github.com/Biometris/statgenSTA/issues</a>
</p>
</li></ul>


<hr>
<h2 id='dropsRaw'>DROPS data set</h2><span id='topic+dropsRaw'></span>

<h3>Description</h3>

<p>This dataset comes from the European Union project DROPS (DROught-tolerant
yielding PlantS). A panel of 256 maize hybrids was grown with two water
regimes (irrigated or rainfed), in seven fields in 2012 and 2013,
respectively, spread along a climatic transect from western to eastern
Europe, plus one site in Chile in 2013. This resulted in 28 experiments
defined as the combination of one year, one site and one water regime, with
two and three repetitions for rainfed and irrigated treatments, respectively.
A detailed environmental characterisation was carried out, with hourly
records of micrometeorological data and soil water status, and associated
with precise measurement of phenology. Grain yield and its components were
measured at the end of the experiment.<br />
10 experiments have been selected from the full data set, two for each of
the five main environmental scenarios that were identified in the data. The
scenarios have been added to the data as well as a classification of the
genotypes in four genetic groups.<br /><br />
The data.frame contains the raw phenotypic data per experiment
(Location × year × water regime), one value per individual plot and
outliers have been removed.<br /><br />
A data.frame with 6499 rows and 25 columns.<br />
</p>

<dl>
<dt>Experiment</dt><dd><p>experiments ID described by the three first letters of the
city’s name followed by the year of experiment and the water regime with W
for watered and R for rain-fed.</p>
</dd>
<dt>Site</dt><dd><p>location where the experiment was performed</p>
</dd>
<dt>year</dt><dd><p>year in which the experiment was performed</p>
</dd>
<dt>plotId</dt><dd><p>plot identifier (when available)</p>
</dd>
<dt>treatment</dt><dd><p>targeted water regime</p>
</dd>
<dt>Code_ID, Variety_ID, Accession_ID</dt><dd><p>identifier of the genotype</p>
</dd>
<dt>Replicate, block</dt><dd><p>experimental design factors</p>
</dd>
<dt>Row, Column</dt><dd><p>2D coordinates of each plot</p>
</dd>
<dt>grain.yield</dt><dd><p>genotypic mean for yield adjusted at 15\
in ton per hectare (t ha^-1)</p>
</dd>
<dt>grain.number</dt><dd><p>genotypic mean for number of grain per square meter</p>
</dd>
<dt>grain.weight</dt><dd><p>genotypic mean for individual grain weight in milligram
(mg)</p>
</dd>
<dt>anthesis</dt><dd><p>genotypic mean for male flowering (pollen shed), in thermal
time cumulated since emergence (d_20°C)</p>
</dd>
<dt>silking</dt><dd><p>genotypic mean for female flowering (silking emergence), in
thermal time cumulated since emergence (d_20°C)</p>
</dd></dl>
<p>#'
</p>
<dl>
<dt>plant.height</dt><dd><p>genotypic mean for plant height, from ground level to
the base of the flag leaf (highest) leaf in centimeter (cm)</p>
</dd>
<dt>tassel.height</dt><dd><p>genotypic mean for plant height including tassel, from
ground level to the highest point of the tassel in centimeter (cm)</p>
</dd>
<dt>ear.height</dt><dd><p>genotypic mean for ear insertion height, from ground level
to ligule of the highest ear leaf in centimeter (cm)</p>
</dd>
<dt>Lat</dt><dd><p>The latitude of the location where the experiment was performed</p>
</dd>
<dt>Long</dt><dd><p>The longitude of the location where the experiment was performed</p>
</dd>
<dt>scenarioWater</dt><dd><p>water scenario for the experiment, well watered (WW) or
water deficit (WD)</p>
</dd>
<dt>scenarioTemp</dt><dd><p>temperature scenario for the experiment, Cool, Hot or
Hot(Day)</p>
</dd>
<dt>scenarioFull</dt><dd><p>the full scenario for the experiment, a combination of
scenarioWater and scenarioTemp</p>
</dd>
<dt>geneticGroup</dt><dd><p>the genetic group to which the genotype belongs</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>dropsRaw
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 6486 rows and 26 columns.
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.15454/IASSTN">doi:10.15454/IASSTN</a>
</p>


<h3>References</h3>

<p>Millet, E. J., Pommier, C., et al. (2019). A multi-site
experiment in a network of European fields for assessing the maize yield
response to environmental scenarios (Data set).
<a href="https://doi.org/10.15454/IASSTN">doi:10.15454/IASSTN</a>
</p>

<hr>
<h2 id='extractSTA'>Extract statistics from fitted models</h2><span id='topic+extractSTA'></span>

<h3>Description</h3>

<p>Extract and calculate various results for fitted models such as BLUEs, BLUPs,
unit errors and heritabilities. For a full list of results that can be
extracted, see the table below.<br /><br />
The result(s) to extract can be specified in <code>what</code>.<br />
If a single result is extracted, this result is returned as a
<code>data.frame</code>, If this is not possible, because the format of the result
is incompatible with the <code>data.frame</code> format, the result is returned as
a list. E.g. if BLUEs are extracted, the output of the function is a
<code>data.frame</code> with BLUEs. However if varCompF is extracted, the
output of the function is a <code>list</code>.<br /><br />
Results that are returned as <code>data.frame</code> are marked as such in the
asDataFrame column in the table. If the default return value for a result
is a <code>data.frame</code> that can be overridden by the user by specifying
<code>asDataFrame = FALSE</code>. When doing so the result will be returned as a
list of data.frames, one per trial. They other way round is not possible.
If a result is returned as a <code>list</code> according to the table, it cannot
be returned as a <code>data.frame</code>.<br />
If multiple results are extracted at the same time, these are always
returned as a list.
<br /><br />
Most results can only be calculated if a model is fitted with genotype as
fixed or with genotype as random. E.g. to compute heritabilities a model
should be fitted with genotype as random effect. This is indicated in the
table in the column model with &quot;F&quot; and &quot;R&quot; respectively.
</p>
<p>Possible options for <code>what</code> are:</p>

<table>
<tr>
 <td style="text-align: left;">
   result </td><td style="text-align: left;"> model </td><td style="text-align: left;"> description </td><td style="text-align: left;"> asDataFrame </td>
</tr>
<tr>
 <td style="text-align: left;">
   BLUEs </td><td style="text-align: left;"> F </td><td style="text-align: left;"> Best Linear Unbiased Estimators </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   seBLUEs </td><td style="text-align: left;"> F </td><td style="text-align: left;"> standard errors of the BLUEs </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   ue </td><td style="text-align: left;"> F </td><td style="text-align: left;"> unit errors - only for lme4 and asreml </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   varCompF </td><td style="text-align: left;"> F </td><td style="text-align: left;"> variance components for the model with genotype as fixed component </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
   fitted </td><td style="text-align: left;"> F </td><td style="text-align: left;"> fitted values for the model with genotype as fixed component </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   residF </td><td style="text-align: left;"> F </td><td style="text-align: left;"> residuals for the model with genotype as fixed component </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   stdResF </td><td style="text-align: left;"> F </td><td style="text-align: left;"> standardized residuals for the model with genotype as fixed component </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   wald </td><td style="text-align: left;"> F </td><td style="text-align: left;"> results of the wald test - only for lme4 and asreml </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
   CV </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Coefficient of Variation </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   rDfF </td><td style="text-align: left;"> F </td><td style="text-align: left;"> residual degrees of freedom for the model with genotype as fixed component </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   sed </td><td style="text-align: left;"> F </td><td style="text-align: left;"> standard error of difference - only for asreml </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
   lsd </td><td style="text-align: left;"> F </td><td style="text-align: left;"> least significant difference - only for asreml </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
   BLUPs </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Best Linear Unbiased Predictors </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   seBLUPs </td><td style="text-align: left;"> R </td><td style="text-align: left;"> standard errors of the BLUPs </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   heritability </td><td style="text-align: left;"> R </td><td style="text-align: left;"> broad sense heritability </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   varCompR </td><td style="text-align: left;"> R </td><td style="text-align: left;"> variance components for the model with genotype as random component </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
   varGen </td><td style="text-align: left;"> R </td><td style="text-align: left;"> genetic variance component </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   varErr </td><td style="text-align: left;"> R </td><td style="text-align: left;"> residual variance component </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   varSpat </td><td style="text-align: left;"> R </td><td style="text-align: left;"> spatial variance components - only for SpATS </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
   rMeans </td><td style="text-align: left;"> R </td><td style="text-align: left;"> fitted values for the model with genotype as random component </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   ranEf </td><td style="text-align: left;"> R </td><td style="text-align: left;"> random genetic effects </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   residR </td><td style="text-align: left;"> R </td><td style="text-align: left;"> residuals for the model with genotype as random component </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   stdResR </td><td style="text-align: left;"> R </td><td style="text-align: left;"> standardized residuals for the model with genotype as random component </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   rDfR </td><td style="text-align: left;"> R </td><td style="text-align: left;"> residual degrees of freedom for the model with genotype as random component </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
   effDim </td><td style="text-align: left;"> R </td><td style="text-align: left;"> effective dimensions - only for SpATS </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
   ratEffDim </td><td style="text-align: left;"> R </td><td style="text-align: left;"> ratios of the effective dimensions - only for SpATS </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>extractSTA(
  STA,
  trials = names(STA),
  traits = NULL,
  what = "all",
  asDataFrame = length(what) == 1 &amp;&amp; what != "all",
  keep = NULL,
  restoreColNames = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractSTA_+3A_sta">STA</code></td>
<td>
<p>An object of class STA.</p>
</td></tr>
<tr><td><code id="extractSTA_+3A_trials">trials</code></td>
<td>
<p>A character vector of trials for which the statistics should be
computed. If not supplied, statistics are computed for all trials that have
been modeled.</p>
</td></tr>
<tr><td><code id="extractSTA_+3A_traits">traits</code></td>
<td>
<p>A character vector of traits for which the statistics should be
computed. If not supplied, statistics are computed for all traits that have
been modeled.</p>
</td></tr>
<tr><td><code id="extractSTA_+3A_what">what</code></td>
<td>
<p>A character vector indicating which statistics should be
computed. Most statistics are available for all models, some only for models
fitted using a certain engine. If this is the case, this is indicated in the
list with options in details.<br />
If <code>what = "all"</code>, all available statistics are computed.</p>
</td></tr>
<tr><td><code id="extractSTA_+3A_asdataframe">asDataFrame</code></td>
<td>
<p>Should the output be reshaped to a data.frame. This is
only possible if the number of statistics to extract is one.</p>
</td></tr>
<tr><td><code id="extractSTA_+3A_keep">keep</code></td>
<td>
<p>A character vector of column(s) in the object of class
<code><a href="#topic+TD">TD</a></code> used for modeling. These columns will be kept as output when
computing fitted values, residuals, standardized residuals and rMeans.
Columns can also be kept when computing (se)BLUEs and (se)BLUPs but only if
the column to keep contains unique values for the modeled variables, i.e. a
column repId with several different values per genotype cannot be kept.</p>
</td></tr>
<tr><td><code id="extractSTA_+3A_restorecolnames">restoreColNames</code></td>
<td>
<p>Should the original column names be restored in the
output of the extracted data?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the input either a data.frame or a list with, per
trial for which statistics have been extracted, a list of those statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitTD">fitTD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit model using SpATS.
modSp &lt;- fitTD(TD = TDHeat05,
               design = "res.rowcol",
               traits = "yield")

## Extract all available statistics from the fitted model.
extr &lt;- extractSTA(modSp)

## Extract only the BLUEs from the fitted model.
BLUEs &lt;- extractSTA(modSp,
                    what = "BLUEs")

## Extract only the BLUEs from the fitted model and keep trial as variable in
## the output.
BLUEs2 &lt;- extractSTA(modSp,
                     what = "BLUEs",
                     keep = "trial")

</code></pre>

<hr>
<h2 id='fitTD'>Fit single trial mixed model</h2><span id='topic+fitTD'></span>

<h3>Description</h3>

<p>Perform REML analysis given a specific experimental design using either
SpATS, lme4 or asreml. SpATS is used as a default method when row
coordinates (rowCoord) and column coordinates (colCoord) are present, lme4
otherwise.
See details for the exact models fitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitTD(
  TD,
  trials = names(TD),
  design = NULL,
  traits,
  what = c("fixed", "random"),
  covariates = NULL,
  useCheckId = FALSE,
  spatial = FALSE,
  engine = NA,
  control = NULL,
  progress = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitTD_+3A_td">TD</code></td>
<td>
<p>An object of class <code><a href="#topic+TD">TD</a></code>.</p>
</td></tr>
<tr><td><code id="fitTD_+3A_trials">trials</code></td>
<td>
<p>A character vector specifying the trials for which the models
should be fitted.</p>
</td></tr>
<tr><td><code id="fitTD_+3A_design">design</code></td>
<td>
<p>A character string specifying the experimental design. Either
&quot;ibd&quot; (incomplete block design), &quot;res.ibd&quot; (resolvable incomplete block
design), &quot;rcbd&quot; (randomized complete block design), &quot;rowcol&quot; (row column
design) or &quot;res.rowcol&quot; (resolvable row column design). Can be ignored when
the trial design is specified in the meta data (see <code><a href="#topic+setMeta">setMeta</a></code>).</p>
</td></tr>
<tr><td><code id="fitTD_+3A_traits">traits</code></td>
<td>
<p>A character vector specifying the traits for which the models
should be fitted.</p>
</td></tr>
<tr><td><code id="fitTD_+3A_what">what</code></td>
<td>
<p>A character vector specifying whether &quot;genotype&quot; should
be fitted as fixed or random effect. If not specified, both models are
fitted.</p>
</td></tr>
<tr><td><code id="fitTD_+3A_covariates">covariates</code></td>
<td>
<p>A character vector specifying covariates to be fitted as
extra fixed effects in the model.</p>
</td></tr>
<tr><td><code id="fitTD_+3A_usecheckid">useCheckId</code></td>
<td>
<p>Should checkId be used as a fixed effect in the model?<br />
If <code>TRUE</code>, <code>TD</code> has to contain a column 'checkId'. Using checkId
as fixed effect can only be done when genotype is fitted as a random effect
in the model.</p>
</td></tr>
<tr><td><code id="fitTD_+3A_spatial">spatial</code></td>
<td>
<p>Should spatial models be tried? Spatial models can
only be fitted with SpATS and asreml. If SpATS is used for modeling, only
spatial models can be fitted and spatial is always set to <code>TRUE</code>. If
asreml is used, fitting spatial models is optional.</p>
</td></tr>
<tr><td><code id="fitTD_+3A_engine">engine</code></td>
<td>
<p>A character string specifying the name of the mixed modeling
engine to use, either &quot;SpATS&quot;, &quot;lme4&quot; or &quot;asreml.&quot; For spatial models,
&quot;SpaTS&quot; is used as default, for other models &quot;lme4&quot;.</p>
</td></tr>
<tr><td><code id="fitTD_+3A_control">control</code></td>
<td>
<p>An optional list with control parameters to be passed to the
actual fitting functions. Currently <code>nSeg</code> and <code>nestDiv</code> are valid
parameters when fitting a model using SpATS. They pass a value to nseg and
nest.div in <code><a href="SpATS.html#topic+PSANOVA">PSANOVA</a></code> respectively. For <code>nSeg</code> also a
named list can be supplied containing values for nSeg per trial.<br />
<code>criterion</code> is a valid parameter when fitting a spatial model using
asreml. It may be used to pass a goodness-of-fit criterion for comparing
different spatial models. See also in details. Other parameters are ignored.</p>
</td></tr>
<tr><td><code id="fitTD_+3A_progress">progress</code></td>
<td>
<p>Should the progress of the modeling be printed. If
<code>TRUE</code>, for every trial a line is output indicating the traits fitted
for the particular trial.</p>
</td></tr>
<tr><td><code id="fitTD_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code>SpATS</code>, <code>lme4</code> or
<code>asreml</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The actual model fitted depends on the design. For the supported designs, the
following models are used:</p>

<table>
<tr>
 <td style="text-align: left;">
   Design </td><td style="text-align: left;"> Code </td><td style="text-align: left;"> Model fitted </td>
</tr>
<tr>
 <td style="text-align: left;">
   incomplete block design </td><td style="text-align: left;"> ibd </td><td style="text-align: left;"> trait = <strong>subBlock</strong> + genotype + <code class="reqn">\epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   resolvable incomplete block design </td><td style="text-align: left;"> res.ibd </td><td style="text-align: left;"> trait = <em>repId</em> + <strong>repId:subBlock</strong> + genotype + <code class="reqn">\epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   randomized complete block design </td><td style="text-align: left;"> rcbd </td><td style="text-align: left;"> trait = <em>repId</em> + genotype + <code class="reqn">\epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   row column design </td><td style="text-align: left;"> rowcol </td><td style="text-align: left;"> trait = <strong>rowId</strong> + <strong>colId</strong> + genotype + <code class="reqn">\epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   resolvable row column design </td><td style="text-align: left;"> res.rowcol </td><td style="text-align: left;"> trait = <em>repId</em> + <strong>repId:rowId</strong> + <strong>repId:colId</strong> + genotype + <code class="reqn">\epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>In the models above, fixed effects are indicated in <em>italics</em> whereas random
effects are indicated in <strong>bold</strong>. genotype can be fitted as fixed or as
random effect depending on the value of the parameter <code>what</code>. Extra
fixed effects may be fitted using the parameter <code>covariates</code>.<br /><br />
If <code>SpATS</code> is used as modeling engine, an extra spatial term is always
included  in the model. This term is constructed using the function
<code><a href="SpATS.html#topic+PSANOVA">PSANOVA</a></code> from the SpATS package as<br />
<code>PSANOVA(colCoord, rowCoord, nseg = nSeg, nest.div = 2)</code>
where<br /> <code>nSeg = (number of columns / 2, number of rows / 2)</code>. nseg and
nest.div can be modified using the <code>control</code> parameter.<br /><br />
When <code>asreml</code> is used for modeling and <code>spatial</code> is <code>TRUE</code>
seven models are fitted with different random terms and covariance structure.
The best model is determined based on a goodness-of-fit criterion, either
AIC or BIC. This can be set using the control parameter <code>criterion</code>,
default is AIC.
The fitted random terms depend on the structure of the data. If the trial
has a regular structure, i.e. all replicates appear the same amount of times
in the trial, the following combinations of random and spatial terms are
fitted:</p>

<table>
<tr>
 <td style="text-align: left;">
   Random part </td><td style="text-align: left;"> Spatial part </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design </td><td style="text-align: left;"> none </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design </td><td style="text-align: left;"> AR1(rowId):colId </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design </td><td style="text-align: left;"> rowId:AR1(colId) </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design </td><td style="text-align: left;"> AR1(rowId):ar1(colId) </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design + nugget </td><td style="text-align: left;"> AR1(rowId):colId </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design + nugget </td><td style="text-align: left;"> rowId:AR1(colId) </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design + nugget </td><td style="text-align: left;"> AR1(rowId):AR1(colId) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>If the design is not regular the following combinations of random and spatial
terms are fitted:</p>

<table>
<tr>
 <td style="text-align: left;">
   Random part </td><td style="text-align: left;"> Spatial part </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design </td><td style="text-align: left;"> none </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design </td><td style="text-align: left;"> exp(rowCoord):colCoord </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design </td><td style="text-align: left;"> rowCoord:exp(colCoord) </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design </td><td style="text-align: left;"> iexp(rowCoord, colCoord) </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design  + nugget </td><td style="text-align: left;"> exp(rowCoord):colCoord </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design + nugget </td><td style="text-align: left;"> rowCoord:exp(colCoord) </td>
</tr>
<tr>
 <td style="text-align: left;">
   random effects based on design + nugget </td><td style="text-align: left;"> iexp(rowCoord,colCoord) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>An object of class <code>STA</code>, a list containing, per trial
that has been analyzed, a list of:
</p>
<table>
<tr><td><code>mRand</code></td>
<td>
<p>A list of models with fitted with genotype as random effect.</p>
</td></tr>
<tr><td><code>mFix</code></td>
<td>
<p>A list of models fitted with genotype as fixed effect.</p>
</td></tr>
<tr><td><code>TD</code></td>
<td>
<p>An object of class <code><a href="#topic+TD">TD</a></code> containing the data on which
<code>mRand</code> and <code>mFix</code> are based.</p>
</td></tr>
<tr><td><code>traits</code></td>
<td>
<p>A character vector indicating the traits for which the models
are fitted.</p>
</td></tr>
<tr><td><code>design</code></td>
<td>
<p>A character string containing the design of the trial.
(see <code><a href="#topic+fitTD">fitTD</a></code> for the possible designs).</p>
</td></tr>
<tr><td><code>spatial</code></td>
<td>
<p>A character string indicating the spatial part of the model.
<code>FALSE</code> if no spatial design has been used.</p>
</td></tr>
<tr><td><code>engine</code></td>
<td>
<p>A character string containing the engine used for the
analysis.</p>
</td></tr>
<tr><td><code>predicted</code></td>
<td>
<p>A character string indicating the variable that has been
predicted.</p>
</td></tr>
<tr><td><code>sumTab</code></td>
<td>
<p>A data.frame with a summary table for the spatial models tried
when <code>engine = "asreml"</code> and <code>spatial = TRUE</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Maria Xose Rodriguez-Alvarez, Martin P. Boer, Fred A. van Eeuwijk, Paul H.C.
Eilers (2017). Correcting for spatial heterogeneity in plant breeding
experiments with P-splines. Spatial Statistics
<a href="https://doi.org/10.1016/j.spasta.2017.10.003">doi:10.1016/j.spasta.2017.10.003</a>
</p>
<p>Butler, D. G., et al. (2010). Analysis of Mixed Models for S language
environments: ASReml-R reference manual. Brisbane, DPI Publications
</p>
<p>Douglas Bates, Martin Maechler, Ben Bolker, Steve Walker (2015). Fitting
Linear Mixed-Effects Models Using lme4. Journal of Statistical Software,
67(1), 1-48. <a href="https://www.jstatsoft.org/article/view/v067i01/0">https://www.jstatsoft.org/article/view/v067i01/0</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fit model using lme4.
lmeMod &lt;- fitTD(TD = TDHeat05,
                design = "ibd",
                traits = "yield",
                what = "fixed",
                engine = "lme4")

## Summarize results.
summary(lmeMod)

## Create base plots of the results.
plot(lmeMod)

## Create a pdf report summarizing results.
report(lmeMod,
       outfile = tempfile(fileext = ".pdf"),
       what = "fixed")

## Fit model using SpATS.
spaMod &lt;- fitTD(TD = TDHeat05,
                design = "res.rowcol",
                traits = "yield",
                what = "fixed")
summary(spaMod)

## Create spatial plots of the results.
plot(spaMod, plotType = "spatial")

## Fit model using SpATS.
## Specify the number of segments to use in PSANOVA
spaMod2 &lt;- fitTD(TD = TDHeat05,
                 design = "res.rowcol",
                 traits = "yield",
                 what = "fixed",
                 control = list(nSeg = c(13, 26)))

## Create a pdf report summarizing results.
report(spaMod, outfile = tempfile(fileext = ".pdf"), what = "fixed")

## Fit model using asreml.
if (requireNamespace("asreml", quietly = TRUE)) {
  asrMod &lt;- fitTD(TD = TDHeat05,
                  design = "res.rowcol",
                  traits = "yield",
                  what = "fixed",
                  engine = "asreml")
  summary(asrMod)

  report(asrMod,
         outfile = tempfile(fileext = ".pdf"),
         what = "fixed")
}

</code></pre>

<hr>
<h2 id='getMeta'>Get and set metadata for TD objects</h2><span id='topic+getMeta'></span><span id='topic+setMeta'></span>

<h3>Description</h3>

<p>Functions for extracting and adding metadata for objects of class TD.<br /><br />
<code>getMeta</code> extracts a data.frame with location, date, design, latitude,
longitude, plot width and plot length for all trials in TD.<br /><br />
<code>setMeta</code> adds metadata from a data.frame to an object of class TD. See
details for the specifications of the data.frame.<br /><br />
The most common use case is extracting metadata from a TD object, modifying
the content and then adding it back to the TD object.<br />
Information in the metadata of a TD object is used in plotting functions
(e.g. latitude and longitude for a map plot) and when fitting models on the
data (the trial design).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMeta(TD)

setMeta(TD, meta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMeta_+3A_td">TD</code></td>
<td>
<p>An object of class TD.</p>
</td></tr>
<tr><td><code id="getMeta_+3A_meta">meta</code></td>
<td>
<p>A data.frame containing metadata.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When setting metadata, metadata has to be a data.frame with rownames
corresponding to the trials in <code>TD</code>. The data.frame should contain one
or more of the following columns:
</p>

<dl>
<dt>trLocation</dt><dd><p>The location of the trial. Used as default name when
creating plots and summaries.</p>
</dd>
<dt>trDate</dt><dd><p>The date of the trial.</p>
</dd>
<dt>trDesign</dt><dd><p>The design of the trial. One of &quot;none&quot; (no (known) design),
&quot;ibd&quot; (incomplete-block design), &quot;res.ibd&quot; (resolvable incomplete-block
design), &quot;rcbd&quot; (randomized complete block design),
&quot;rowcol&quot; (row-column design) or &quot;res.rowcol&quot; (resolvable row-column design).
Used when fitting models.</p>
</dd>
<dt>trLat</dt><dd><p>The latitude of the trial on a scale of -90 to 90. Used when
plotting the trials on a map.</p>
</dd>
<dt>trLong</dt><dd><p>The longitude of the trial on a scale of -180 to 180. Used
when plotting the trials on a map.</p>
</dd>
<dt>trPlWidth</dt><dd><p>The width of the plot. Used in combination with trPlLength
to determine the size of the plots in a layout plot of a trial.</p>
</dd>
<dt>trPlLength</dt><dd><p>The length of the plot. Used in combination with
trPlWidth to determine the size of the plots in a layout plot of a trial.</p>
</dd>
</dl>

<p>The values of the metadata of TD will be set to the values in the
corresponding column in <code>meta</code>. Existing values will be overwritten,
but <code>NA</code> will be ignored so setting a value to <code>NA</code> won't result
in accidentally removing it.
</p>


<h3>See Also</h3>

<p>Other functions for TD objects: 
<code><a href="#topic+TD">TD</a></code>,
<code><a href="#topic+plot.TD">plot.TD</a>()</code>,
<code><a href="#topic+summary.TD">summary.TD</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dropsRaw")

## Create a TD object.
dropsTD &lt;- createTD(data = dropsRaw[dropsRaw$year == 2012, ],
                    genotype = "Variety_ID",
                    trial = "Experiment",
                    loc = "Site",
                    repId = "Replicate",
                    subBlock = "block",
                    rowCoord = "Row",
                    colCoord = "Column",
                    trLat = "Lat",
                    trLong = "Long")

## Get meta data from dropsTD.
(dropsMeta &lt;- getMeta(dropsTD))

## Add trial date to meta data.
dropsMeta$trDate &lt;- as.Date(rep("010112", times = 5), "%d%m%y")

## Add back meta data to wheatTD.
dropsTD &lt;- setMeta(dropsTD,
                   dropsMeta)

</code></pre>

<hr>
<h2 id='outlierSTA'>Identifying outliers in objects of class STA</h2><span id='topic+outlierSTA'></span>

<h3>Description</h3>

<p>Function to identify observations with standardized residuals exceeding
<code>rLimit</code>. If not provided <code>rLimit</code> is computed as
<code>qnorm(1 - 0.5 / rDf)</code> where <code>rDf</code> is the residual degrees
of freedom for the model. This value is then restricted to the interval
2..4. Alternatively a custom limit may be provided.<br />
If <code>verbose = TRUE</code> a summary is printed of outliers and observations
that have the same value for <code>commonFactors</code>. The column outlier in the
output can be used to distinguish real outliers from observations included
because of their commonFactors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outlierSTA(
  STA,
  trials = NULL,
  traits = NULL,
  what = NULL,
  rLimit = NULL,
  commonFactors = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outlierSTA_+3A_sta">STA</code></td>
<td>
<p>An object of class <code>STA</code>.</p>
</td></tr>
<tr><td><code id="outlierSTA_+3A_trials">trials</code></td>
<td>
<p>A character vector specifying the trials for which outliers
should be identified. If <code>trials = NULL</code>, all trials are included.</p>
</td></tr>
<tr><td><code id="outlierSTA_+3A_traits">traits</code></td>
<td>
<p>A character vector specifying the traits for which outliers
should be identified.</p>
</td></tr>
<tr><td><code id="outlierSTA_+3A_what">what</code></td>
<td>
<p>A character string indicating whether the outliers should be
identified for the fitted model with genotype as fixed
(<code>what = "fixed"</code>) or genotype as random (<code>what = "random"</code>) factor.
If <code>STA</code> contains only one model this model is chosen automatically.</p>
</td></tr>
<tr><td><code id="outlierSTA_+3A_rlimit">rLimit</code></td>
<td>
<p>A numerical value used for determining when a value is
considered an outlier. All observations with standardized residuals
exceeding <code>rLimit</code> will be marked as outliers.</p>
</td></tr>
<tr><td><code id="outlierSTA_+3A_commonfactors">commonFactors</code></td>
<td>
<p>A character vector specifying the names of columns
in <code>TD</code> used for selecting observations that are similar to the
outliers. If <code>commonFactors = NULL</code>, only outliers are reported and
no similar observations.</p>
</td></tr>
<tr><td><code id="outlierSTA_+3A_verbose">verbose</code></td>
<td>
<p>Should the outliers be printed to the console?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li><p>indicator - a list of numeric vectors indicating the location of the
outliers in the data
</p>
</li>
<li><p>outliers - a data.frame containing the outliers and observations
similar to the outliers as defined by <code>commonFactors</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Fit a model using lme4.
modLme &lt;- fitTD(TD = TDHeat05,
                traits = "yield",
                design = "res.rowcol",
                engine = "lme4")

## Detect outliers in the standardized residuals of the fitted model.
outliers &lt;- outlierSTA(STA = modLme,
                       traits = "yield")

</code></pre>

<hr>
<h2 id='plot.STA'>Plot function for class STA</h2><span id='topic+plot.STA'></span>

<h3>Description</h3>

<p>This function draws either four base plots:
</p>

<ul>
<li><p>A histogram of the residuals
</p>
</li>
<li><p>A normal Q-Q plot
</p>
</li>
<li><p>A residuals vs fitted values plot
</p>
</li>
<li><p>An absolute residuals vs fitted values plot
</p>
</li></ul>

<p>or five or six spatial plots:
</p>

<ul>
<li><p>A spatial plot of the raw data
</p>
</li>
<li><p>A spatial plot of the fitted data
</p>
</li>
<li><p>A spatial plot of the residuals
</p>
</li>
<li><p>A spatial plot of the estimated spatial trend (SpATS only)
</p>
</li>
<li><p>A spatial plot of the BLUEs or BLUPs
</p>
</li>
<li><p>A histogram of the BLUEs or BLUPs
</p>
</li></ul>

<p>Spatial plots can only be made if the data contains both row and column
information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'STA'
plot(
  x,
  ...,
  trials = NULL,
  traits = NULL,
  what = NULL,
  plotType = c("base", "spatial"),
  spaTrend = c("raw", "percentage"),
  outCols = ifelse(plotType == "base", 2, 3),
  title = NULL,
  output = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.STA_+3A_x">x</code></td>
<td>
<p>An object of class STA.</p>
</td></tr>
<tr><td><code id="plot.STA_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
<tr><td><code id="plot.STA_+3A_trials">trials</code></td>
<td>
<p>A character vector indicating the trials to plot. If
<code>trials = NULL</code>, all trials are plotted.</p>
</td></tr>
<tr><td><code id="plot.STA_+3A_traits">traits</code></td>
<td>
<p>A character vector indicating the traits to plot. If
<code>traits = NULL</code>, all traits are plotted.</p>
</td></tr>
<tr><td><code id="plot.STA_+3A_what">what</code></td>
<td>
<p>A character string indicating whether the fitted model with
genotype as fixed (<code>what = "fixed"</code>) or genotype as random
(<code>what = "random"</code>) factor should be plotted.
If <code>x</code> contains only one model this model is chosen automatically.</p>
</td></tr>
<tr><td><code id="plot.STA_+3A_plottype">plotType</code></td>
<td>
<p>A character string indicating whether <code>base</code> plots or
<code>spatial</code> plots should be made.</p>
</td></tr>
<tr><td><code id="plot.STA_+3A_spatrend">spaTrend</code></td>
<td>
<p>A character string indicating how the spatial trend should
be displayed. Either &quot;raw&quot; (original scale), or &quot;percentage&quot;. If
&quot;percentage&quot;, the estimated spatial trend is scaled (i.e., divided by the
average of the observed response variable of interest across the field) and
results are shown as a percentage.</p>
</td></tr>
<tr><td><code id="plot.STA_+3A_outcols">outCols</code></td>
<td>
<p>An integer indicating the number of columns to use for
displaying the plots. Usually the default of 2 for base plots and 3 for
spatial plots will be fine, but decreasing the numbers may help for nicer
printing.</p>
</td></tr>
<tr><td><code id="plot.STA_+3A_title">title</code></td>
<td>
<p>A character string used a title for the plot. Note that when
a title is specified and multiple plots are created, all plots will get the
same title.</p>
</td></tr>
<tr><td><code id="plot.STA_+3A_output">output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a list of ggplot objects is invisibly returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing ggplot objects for the selected plots.
</p>


<h3>See Also</h3>

<p>Other functions for STA objects: 
<code><a href="#topic+STAtoCross">STAtoCross</a>()</code>,
<code><a href="#topic+STAtoTD">STAtoTD</a>()</code>,
<code><a href="#topic+report.STA">report.STA</a>()</code>,
<code><a href="#topic+summary.STA">summary.STA</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Run a single trait analysis using SpATS.
modSp &lt;- fitTD(TD = TDHeat05,
               design = "res.rowcol",
               traits = "yield")

## Create base plots.
plot(modSp,
     what = "fixed",
     plotType = "base")

## Create spatial plots.
plot(modSp,
     what = "fixed",
     plotType = "spatial")

## Create spatial plots showing the spatial trend as percentage.
plot(modSp,
     what = "fixed",
     plotType = "spatial",
     spaTrend = "percentage")

</code></pre>

<hr>
<h2 id='plot.TD'>Plot function for class TD</h2><span id='topic+plot.TD'></span>

<h3>Description</h3>

<p>Plotting function for objects of class TD. Plots either the layout of the
different trials within the TD object or locates the trials on a map. Also a
boxplot can be made for selected traits and trials, a plot of correlations
between trials and a scatter plot matrix. A detailed description and optional
extra parameters of the different plots is given in the sections below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TD'
plot(
  x,
  ...,
  plotType = c("layout", "map", "box", "cor", "scatter"),
  trials = names(x),
  traits = NULL,
  title = NULL,
  output = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.TD_+3A_x">x</code></td>
<td>
<p>An object of class TD.</p>
</td></tr>
<tr><td><code id="plot.TD_+3A_...">...</code></td>
<td>
<p>Extra plot options. Described per plotType in their respective
section.</p>
</td></tr>
<tr><td><code id="plot.TD_+3A_plottype">plotType</code></td>
<td>
<p>A single character string indicating which plot should be
made. See the sections below for a detailed explanation of the plots.</p>
</td></tr>
<tr><td><code id="plot.TD_+3A_trials">trials</code></td>
<td>
<p>A character vector indicating which trials to include in the
plot.</p>
</td></tr>
<tr><td><code id="plot.TD_+3A_traits">traits</code></td>
<td>
<p>A character vector indicating for which traits a plot should
be made. Ignored if <code>plotType</code> = &quot;map&quot;.</p>
</td></tr>
<tr><td><code id="plot.TD_+3A_title">title</code></td>
<td>
<p>A character string used a title for the plot. Note that when
a title is specified and multiple plots are created, all plots will get the
same title.</p>
</td></tr>
<tr><td><code id="plot.TD_+3A_output">output</code></td>
<td>
<p>Should the plot be output to the current device? If
<code>FALSE</code> only a list of ggplot objects is invisibly returned.</p>
</td></tr>
</table>


<h3>Layout Plot</h3>

<p>Plots the layout of the selected trials.
This plot can only be made for trials that contain both row (<code>rowCoord</code>)
and column (<code>colCoord</code>) information. If either one of those is missing
the trial is skipped with a warning. If blocks (<code>subBlock</code>) are
available for a trial these can be colored in different colors per block by
setting <code>colorSubBlock = TRUE</code>. If replicates (<code>repId</code>) are
available a black line is plotted between different replicates. Missing plots
are indicated in white. These can either be single plots in a trial or
complete missing columns or rows.<br />
Extra parameter options:
</p>

<dl>
<dt>showGeno</dt><dd><p>Should individual genotypes be indicated as text in the plot?
Defaults to <code>FALSE</code></p>
</dd>
<dt>sizeGeno</dt><dd><p>The text size for indicating individual genotypes. Defaults
to 2. Ignored if <code>showGeno = FALSE</code>.</p>
</dd>
<dt>highlight</dt><dd><p>A character vector of genotypes to be highlighted in the
plot.</p>
</dd>
<dt>colHighlight</dt><dd><p>A character vector specifying colors to use for the
highlighted genotypes. If not specified, default ggplot colors are used.</p>
</dd>
<dt>colorSubBlock</dt><dd><p>Should blocks be colored with a different color per
subBlock? Defaults to <code>FALSE</code>. <code>colorSubBlock</code> is ignored when
highlight is used to highlight genotypes.</p>
</dd>
<dt>colSubBlock</dt><dd><p>A character vector specifying colors to use for the
subBlocks. If not specified, default ggplot colors are used.</p>
</dd>
</dl>



<h3>Map Plot</h3>

<p>A map is plotted with the locations of the trials in the TD object.
Mapping the trials is done based on latitude and longitude that can be
added when creating an object of class TD. Trials for which either latitude
or longitude is not available are skipped with a warning message.
The countries in which the trials are located will be plotted on a single
map and the location of the trials will be indicated on this map. The
actual plot is made using ggplot, but for getting the data for the borders
of the countries the maps package is needed.<br />
Extra parameter options:
</p>

<dl>
<dt>colorTrialBy</dt><dd><p>A character string indicating a column in <code>TD</code> by
which the trials on the map are colored.</p>
</dd>
<dt>colTrial</dt><dd><p>A character vector with plot colors for the trials. A
single color when <code>colorTrialBy = NULL</code>, a vector of colors otherwise.</p>
</dd>
<dt>printTrialNames</dt><dd><p>Should trial names be printed. Defaults to
<code>TRUE</code>. Setting this to <code>FALSE</code> can be useful if there are many
trials.</p>
</dd>
<dt>minLatRange</dt><dd><p>A positive numerical value indicating the minimum range
(in degrees) for the latitude on the plotted map. Defaults to 10.</p>
</dd>
<dt>minLongRange</dt><dd><p>A positive numerical value indicating the minimum range
(in degrees) for the longitude on the plotted map. Defaults to 5.</p>
</dd>
</dl>



<h3>Box Plot</h3>

<p>Creates a boxplot per selected trait grouped by trial. Extra parameter
options:
</p>

<dl>
<dt>groupBy</dt><dd><p>A character string indicating a column in <code>TD</code> by which
the boxes in the plot should be grouped. By default the boxes are grouped
per trial.</p>
</dd>
<dt>colorTrialBy</dt><dd><p>A character string indicating a column in <code>TD</code> by
which the boxes are colored. Coloring will be done within the groups
indicated by the <code>groupBy</code> parameter.</p>
</dd>
<dt>colTrial</dt><dd><p>A character vector with plot colors for the trials. A
single color when <code>colorTrialBy = NULL</code>, a vector of colors otherwise.</p>
</dd>
<dt>orderBy</dt><dd><p>A character string indicating the way the boxes should be
ordered. Either &quot;alphabetic&quot; for alphabetical ordering of the groups,
&quot;ascending&quot; for ordering by ascending mean, or &quot;descending&quot; for ordering by
descending mean. Default boxes are ordered alphabetically.</p>
</dd>
</dl>



<h3>Correlation Plot</h3>

<p>Draws a heat map of correlations between trials per selected trait. If
genotypes are replicated within trials genotypic means are taken before
computing correlations. The order of the trials in the heat map is determined
by clustering them. Closely related trials will be plotted close to each
other.
</p>


<h3>Scatter Plot</h3>

<p>Draws a scatter plot matrix per selected trait. If genotypes are replicated
within trials genotypic means are taken before plotting. The lower left of
the matrix contains scatter plots between trials. The diagonal contains
histograms of the data per trial.<br />
Extra parameter options:
</p>

<dl>
<dt>colorGenoBy</dt><dd><p>A character string indicating a column in <code>TD</code> by
which the genotypes in the scatter plots are colored.</p>
</dd>
<dt>colGeno</dt><dd><p>A character vector with plot colors for the genotypes. A
single color when <code>colorGenoBy = NULL</code>, a vector of colors otherwise.</p>
</dd>
<dt>colorTrialBy</dt><dd><p>A character string indicating a column in <code>TD</code> by
which the trials in the histograms are colored.</p>
</dd>
<dt>colTrial</dt><dd><p>A character vector with plot colors for the trials. A
single color when <code>colorTrialBy = NULL</code>, a vector of colors otherwise.</p>
</dd>
<dt>trialOrder</dt><dd><p>A character vector indicating the order of the trials in
the plot matrix (left to right and top to bottom). This vector should be a
permutation of all trials plotted.</p>
</dd>
<dt>addCorr</dt><dd><p>A character string indicating the position of the correlation
between trials displayed in each plot, either &quot;tl&quot; for top left, &quot;tr&quot;, for
top right, &quot;bl&quot; for bottom left or &quot;br&quot; for bottom right. If <code>NULL</code>,
the default, then no correlation is added to the plot.</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other functions for TD objects: 
<code><a href="#topic+TD">TD</a></code>,
<code><a href="#topic+getMeta">getMeta</a>()</code>,
<code><a href="#topic+summary.TD">summary.TD</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dropsRaw")

## Create a TD object.
dropsTD &lt;- createTD(data = dropsRaw[dropsRaw$year == 2012, ],
                    genotype = "Variety_ID",
                    trial = "Experiment",
                    loc = "Site",
                    repId = "Replicate",
                    subBlock = "block",
                    rowCoord = "Row",
                    colCoord = "Column",
                    trLat = "Lat",
                    trLong = "Long")

### Layout plot.


## Plot the layout of one of the trials.
plot(dropsTD,
    trials = "Kar12W")

## Highlight some of the genotypes in the layout.
plot(dropsTD,
     trials = "Kar12W",
     highlight = c("A3", "11430"))

### Map plot.

## Plot the location of the trials on the map.
plot(dropsTD,
     plotType = "map")

### Box plot.

## Create a box plot for grain.yield.
plot(dropsTD,
     plotType = "box",
     traits = "grain.yield")

## Add coloring by scenarioFull to the boxes.
plot(dropsTD,
     plotType = "box",
     traits = "grain.yield",
     colorTrialBy = "scenarioFull")

## Sort the boxes in descending order.
plot(dropsTD,
     plotType = "box",
     traits = "grain.yield",
     orderBy = "descending")

### Correlation plot.

## Plot the correlations between trials for grain.yield.
plot(dropsTD,
     plotType = "cor",
     traits = "grain.yield")

### Scatter plot

## Plot scatter plot for grain.yield.
plot(dropsTD,
    plotType = "scatter",
    traits = "grain.yield")

## Create a scatter plot matrix for grain yield.
## Color trials by scenario and genotypes by family.
plot(dropsTD,
     plotType = "scatter",
     traits = "grain.yield",
     colorTrialBy = "scenarioFull",
     colorGenoBy = "geneticGroup")


</code></pre>

<hr>
<h2 id='report'>Base method for creating a report</h2><span id='topic+report'></span>

<h3>Description</h3>

<p>Base method for creating a .pdf and .tex report from an <code>R</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="report_+3A_x">x</code></td>
<td>
<p>An <code>R</code> object</p>
</td></tr>
<tr><td><code id="report_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed on to specific report functions.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+report.STA">report.STA</a></code>
</p>

<hr>
<h2 id='report.STA'>Report method for class STA</h2><span id='topic+report.STA'></span>

<h3>Description</h3>

<p>pdf reports will be created containing a summary of the results of the
fitted model(s). For all selected trails and traits a separate pdf file will
be generated. Also a .tex file and a folder containing figures will be
created for each report to enable easy modifying of the report.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'STA'
report(
  x,
  ...,
  trials = NULL,
  traits = NULL,
  descending = TRUE,
  outfile = NULL,
  what = c("fixed", "random")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="report.STA_+3A_x">x</code></td>
<td>
<p>An object of class STA.</p>
</td></tr>
<tr><td><code id="report.STA_+3A_...">...</code></td>
<td>
<p>Further arguments passed to the report function.</p>
</td></tr>
<tr><td><code id="report.STA_+3A_trials">trials</code></td>
<td>
<p>A character vector indicating the trials to report. If
<code>trials = NULL</code>, all trials are reported.</p>
</td></tr>
<tr><td><code id="report.STA_+3A_traits">traits</code></td>
<td>
<p>A character vector indicating the traits to report. If
<code>traits = NULL</code>, all traits are reported.</p>
</td></tr>
<tr><td><code id="report.STA_+3A_descending">descending</code></td>
<td>
<p>Should the trait be ordered in descending order? Set to
<code>FALSE</code> if low values of the trait indicate better performance.</p>
</td></tr>
<tr><td><code id="report.STA_+3A_outfile">outfile</code></td>
<td>
<p>A character string, the name and location of the output .pdf
and .tex file for the report. If <code>NULL</code>, a report with a default name
will be created in the current working directory. Trial, trait and
the type of model (genotype fixed or random) will be concatenated to the
name of the output file.<br />
Both knitr and pdflatex don't work well with spaces in file paths and these
are therefore disallowed. Relative paths are possible though.</p>
</td></tr>
<tr><td><code id="report.STA_+3A_what">what</code></td>
<td>
<p>A character vector indicating whether the fitted model with
genotype as fixed or genotype as random factor should be reported. By
default all fitted models in the STA object are reported.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses pdflatex to create a pdf report. For it to run correctly
an installation of LaTeX is required. Checking for this is done with
Sys.which(&quot;pdflatex&quot;).
</p>


<h3>Value</h3>

<p>A pdf report and the .tex file and figures folder that can be used
to recreate the report.
</p>


<h3>See Also</h3>

<p>Other functions for STA objects: 
<code><a href="#topic+STAtoCross">STAtoCross</a>()</code>,
<code><a href="#topic+STAtoTD">STAtoTD</a>()</code>,
<code><a href="#topic+plot.STA">plot.STA</a>()</code>,
<code><a href="#topic+summary.STA">summary.STA</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit model using lme4.
modLme &lt;- fitTD(TD = TDHeat05,
                design = "ibd",
                traits = "yield",
                engine = "lme4")

## Create a pdf report summarizing the results for the model with genotype
## as fixed factor.

report(modLme,
       outfile = tempfile(fileext = ".pdf"),
       what = "fixed")


## Create two pdf report summarizing the results for the model with genotype
## as fixed factor and for the model with genotype as random factor. Order
## the results in ascending order.

report(modLme,
       outfile = tempfile(fileext = ".pdf"),
       descending = FALSE)


</code></pre>

<hr>
<h2 id='STAtoCross'>Convert STA to Cross</h2><span id='topic+STAtoCross'></span>

<h3>Description</h3>

<p>Convert an STA object to a cross object from package qtl. Genotypic
information should be available in a .csv file.<br />
The only way to create an object of class cross is by importing both the
phenotypic and the genotypic data from external files. Therefore the
phenotypic data, either the BLUEs or the BLUPs from the fitted model are
first written to a temporary file. The genotypic data has to be available in
a .csv file in the correct format as well, see <code>genoFile</code> for a
description of this format. These phenotypic and genotypic files are then
imported into a cross object using the read.cross function in the qtl
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>STAtoCross(
  STA,
  trial = NULL,
  traits = NULL,
  what = c("BLUEs", "BLUPs"),
  genoFile,
  genotypes = c("A", "H", "B", "D", "C"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="STAtoCross_+3A_sta">STA</code></td>
<td>
<p>An object of class <code>STA</code>.</p>
</td></tr>
<tr><td><code id="STAtoCross_+3A_trial">trial</code></td>
<td>
<p>A character string indicating the trial to be exported. If
<code>NULL</code> and <code>STA</code> contains only one trial, that trial is exported.</p>
</td></tr>
<tr><td><code id="STAtoCross_+3A_traits">traits</code></td>
<td>
<p>A character string containing the traits to be exported. If
<code>NULL</code>, all traits for the selected trial are exported.</p>
</td></tr>
<tr><td><code id="STAtoCross_+3A_what">what</code></td>
<td>
<p>A character string containing the statistics to be exported as
phenotype in the cross object. This can be either <code>BLUEs</code> or
<code>BLUPs</code>.</p>
</td></tr>
<tr><td><code id="STAtoCross_+3A_genofile">genoFile</code></td>
<td>
<p>A character string indicating a filename containing
phenotypic data. The data should be in the format required by the
qtl package. The first column should contain the individuals, starting
from row 4. The following columns contain markers with in the second and
third row the chromosome and position on the chromosome and in the
following rows the genotypes.</p>
</td></tr>
<tr><td><code id="STAtoCross_+3A_genotypes">genotypes</code></td>
<td>
<p>A character vector specifying the genotype codes
corresponding to AA, AB, BB, not BB and not AA.</p>
</td></tr>
<tr><td><code id="STAtoCross_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to the read.cross function.
See <code><a href="qtl.html#topic+read.cross">read.cross</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="qtl.html#topic+read.cross">read.cross</a></code>
</p>
<p>Other functions for STA objects: 
<code><a href="#topic+STAtoTD">STAtoTD</a>()</code>,
<code><a href="#topic+plot.STA">plot.STA</a>()</code>,
<code><a href="#topic+report.STA">report.STA</a>()</code>,
<code><a href="#topic+summary.STA">summary.STA</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit model using SpATS.
modSp &lt;- fitTD(TD = TDHeat05,
               design = "res.rowcol",
               traits = "yield",
               what = "fixed")

## Create cross object with BLUEs from modSp using genotypic information
## from markers.csv in the package.
cross &lt;- STAtoCross(modSp,
                    genoFile = system.file("extdata", "markers.csv",
                                           package = "statgenSTA"))

</code></pre>

<hr>
<h2 id='STAtoTD'>Convert STA to TD</h2><span id='topic+STAtoTD'></span>

<h3>Description</h3>

<p>Convert an STA object to a TD object.<br />
To be able to use the output of a single trial analysis in
Genotype-by-Environment (GxE) analysis the output first needs to be converted
back to an TD object. This function does exactly that. It extracts BLUEs,
BLUPs and their standard errors from the STA object and creates a new TD
object using these. Also a column &quot;wt&quot; (weight) may also be added. Weights
are then calculated as 1/(SE BLUEs) ^ 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>STAtoTD(
  STA,
  what = c("BLUEs", "seBLUEs", "BLUPs", "seBLUPs"),
  traits = NULL,
  keep = NULL,
  addWt = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="STAtoTD_+3A_sta">STA</code></td>
<td>
<p>An object of class <code>STA</code>.</p>
</td></tr>
<tr><td><code id="STAtoTD_+3A_what">what</code></td>
<td>
<p>A character string containing the statistics to be included as
traits in the TD object. Multiple statistics can be included in which case
they will appear as <code>statistic_trait</code> in the output</p>
</td></tr>
<tr><td><code id="STAtoTD_+3A_traits">traits</code></td>
<td>
<p>A character string containing the traits to be included in the
TD object. If <code>NULL</code>, all traits are exported.</p>
</td></tr>
<tr><td><code id="STAtoTD_+3A_keep">keep</code></td>
<td>
<p>Columns from the TD object used as input for the STA model to
be copied to the output. see <code><a href="#topic+extractSTA">extractSTA</a></code> for possible columns to
copy. If if it is available in <code>TD</code>, the column <code>trial</code> will always
be copied.</p>
</td></tr>
<tr><td><code id="STAtoTD_+3A_addwt">addWt</code></td>
<td>
<p>Should a column wt be added to the output? If <code>TRUE</code>
weight is calculated as 1/(SE BLUEs) ^ 2. If multiple traits are included in
the output, multiple weight columns will be added, 1 for each trait. These
will be named <code>wt_trait</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Trial information for the trials in the STA object will be copied from the
original TD object on which the modeling was done.
</p>


<h3>See Also</h3>

<p>Other functions for STA objects: 
<code><a href="#topic+STAtoCross">STAtoCross</a>()</code>,
<code><a href="#topic+plot.STA">plot.STA</a>()</code>,
<code><a href="#topic+report.STA">report.STA</a>()</code>,
<code><a href="#topic+summary.STA">summary.STA</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fit model using SpATS.
modSp &lt;- fitTD(TD = TDHeat05,
               design = "res.rowcol",
               traits = "yield",
               what = "fixed")

## Create TD object from the fitted model with BLUEs and standard errors.
TDRes &lt;- STAtoTD(modSp,
                 what = c("BLUEs", "seBLUEs"))

## Add a weight column in the output.
TDResWt &lt;- STAtoTD(modSp,
                   what = c("BLUEs", "seBLUEs"),
                   addWt = TRUE)

</code></pre>

<hr>
<h2 id='summary.STA'>Summarizing objects of class <code>STA</code></h2><span id='topic+summary.STA'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>STA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'STA'
summary(
  object,
  trials = NULL,
  trait = NULL,
  nBest = 20,
  sortBy = NULL,
  naLast = TRUE,
  decreasing = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.STA_+3A_object">object</code></td>
<td>
<p>An object of class <code>STA</code>.</p>
</td></tr>
<tr><td><code id="summary.STA_+3A_trials">trials</code></td>
<td>
<p>A character vector indicating the trial to summarize. If
<code>trial = NULL</code> a summary is made of all trials in the <code>STA</code> object.
If a single trial is selected a full summary for this trial is created. For
multiple trials a summary table with the most importantant statistics is
returned.</p>
</td></tr>
<tr><td><code id="summary.STA_+3A_trait">trait</code></td>
<td>
<p>A character string indicating the trait to summarize. If
<code>trait = NULL</code> and only one trait is modeled, this trait is summarized.</p>
</td></tr>
<tr><td><code id="summary.STA_+3A_nbest">nBest</code></td>
<td>
<p>An integer indicating the number of the best genotypes (sorted
by either BLUEs or BLUPs) to print. If <code>NA</code>, all genotypes will be
printed.</p>
</td></tr>
<tr><td><code id="summary.STA_+3A_sortby">sortBy</code></td>
<td>
<p>A character string specifying how the genotypes will be sorted.
Either <code>"BLUEs"</code>, <code>"BLUPs"</code> or <code>NA</code> (i.e. no sorting).</p>
</td></tr>
<tr><td><code id="summary.STA_+3A_nalast">naLast</code></td>
<td>
<p>Should missing values in the data be put last when sorting?</p>
</td></tr>
<tr><td><code id="summary.STA_+3A_decreasing">decreasing</code></td>
<td>
<p>Should the sort order be decreasing?</p>
</td></tr>
<tr><td><code id="summary.STA_+3A_...">...</code></td>
<td>
<p>Further arguments - not used.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other functions for STA objects: 
<code><a href="#topic+STAtoCross">STAtoCross</a>()</code>,
<code><a href="#topic+STAtoTD">STAtoTD</a>()</code>,
<code><a href="#topic+plot.STA">plot.STA</a>()</code>,
<code><a href="#topic+report.STA">report.STA</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Run a single trait analysis using SpATS.
modSp &lt;- fitTD(TD = TDHeat05,
               design = "res.rowcol",
               traits = "yield")

## Print a summary of the fitted model.
summary(modSp)

</code></pre>

<hr>
<h2 id='summary.TD'>Summarizing objects of class <code>TD</code></h2><span id='topic+summary.TD'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>TD</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TD'
summary(
  object,
  ...,
  trial = names(object),
  traits,
  groupBy = NULL,
  what = if (!is.null(groupBy)) {
     c("nObs", "mean", "sd")
 } else {
     c("nObs",
    "nMiss", "mean", "median", "min", "max", "firstQ", "thirdQ", "var")
 }
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.TD_+3A_object">object</code></td>
<td>
<p>An object of class TD.</p>
</td></tr>
<tr><td><code id="summary.TD_+3A_...">...</code></td>
<td>
<p>Further arguments - currently not used.</p>
</td></tr>
<tr><td><code id="summary.TD_+3A_trial">trial</code></td>
<td>
<p>A character string specifying the trial to be summarized.</p>
</td></tr>
<tr><td><code id="summary.TD_+3A_traits">traits</code></td>
<td>
<p>A character vector specifying the traits to be summarized.</p>
</td></tr>
<tr><td><code id="summary.TD_+3A_groupby">groupBy</code></td>
<td>
<p>A character string specifying a column in TD by which the
summary should be grouped. If <code>NULL</code>, no grouping is done.</p>
</td></tr>
<tr><td><code id="summary.TD_+3A_what">what</code></td>
<td>
<p>A character vector indicating which summary statistics should be
computed. If <code>what = "all"</code>, all available statistics are computed.<br />
Possible options are:
</p>

<dl>
<dt>nVals</dt><dd><p>The number of values, i.e. non-missing + missing values.</p>
</dd>
<dt>nObs</dt><dd><p>The number of non-missing observations.</p>
</dd>
<dt>nMiss</dt><dd><p>The number of missing values.</p>
</dd>
<dt>mean</dt><dd><p>The mean.</p>
</dd>
<dt>median</dt><dd><p>The median.</p>
</dd>
<dt>min</dt><dd><p>The minimum.</p>
</dd>
<dt>max</dt><dd><p>The maximum.</p>
</dd>
<dt>range</dt><dd><p>The range (maximum - minimum).</p>
</dd>
<dt>firstQ</dt><dd><p>The first (25pct) quantile.</p>
</dd>
<dt>thirdQ</dt><dd><p>The third (75pct) quantile.</p>
</dd>
<dt>sd</dt><dd><p>The standard deviation.</p>
</dd>
<dt>seMean</dt><dd><p>The standard error of mean.</p>
</dd>
<dt>var</dt><dd><p>The variance.</p>
</dd>
<dt>seVar</dt><dd><p>The standard error of variance.</p>
</dd>
<dt>CV</dt><dd><p>The coefficient of variation.</p>
</dd>
<dt>sum</dt><dd><p>The sum.</p>
</dd>
<dt>sumSq</dt><dd><p>The sum of squares.</p>
</dd>
<dt>uncorSumSq</dt><dd><p>The uncorrected sum of squares.</p>
</dd>
<dt>skew</dt><dd><p>The skewness.</p>
</dd>
<dt>seSkew</dt><dd><p>The standard error of the skewness.</p>
</dd>
<dt>kurt</dt><dd><p>The kurtosis.</p>
</dd>
<dt>seKurt</dt><dd><p>The standard error of the kurtosis.</p>
</dd>
<dt>all</dt><dd><p>All summary statistics.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>A table containing the selected summary statistics.
</p>


<h3>See Also</h3>

<p>Other functions for TD objects: 
<code><a href="#topic+TD">TD</a></code>,
<code><a href="#topic+getMeta">getMeta</a>()</code>,
<code><a href="#topic+plot.TD">plot.TD</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Summarize TDHeat05.
summary(TDHeat05,
        traits = "yield")

## Summarize TDHeat05 grouping by repId.
summary(TDHeat05,
        traits = "yield",
        groupBy = "repId")

</code></pre>

<hr>
<h2 id='TD'>S3 class TD</h2><span id='topic+TD'></span><span id='topic+createTD'></span><span id='topic+addTD'></span><span id='topic+dropTD'></span>

<h3>Description</h3>

<p><code>createTD</code><br />
Function for creating objects of S3 class TD (Trial Data). The function
converts a data.frame to an object of class TD in the following steps:
</p>

<ul>
<li><p>Check input data
</p>
</li>
<li><p>Rename columns to default column names - default column names:
genotype, trial, loc, year, repId, subBlock, rowCoord, colCoord, rowId,
colId, checkId
</p>
</li>
<li><p>Convert column types to default column types - rowCoord and colCoord
are converted to numeric columns, all other renamed columns to factor
columns. Columns other than the default columns, e.g. traits or other
covariates will be included in the output unchanged.
</p>
</li>
<li><p>Split input data by trial - each trial in the input data will become
a list item in the output.
</p>
</li>
<li><p>Add meta data - the trial meta data are added as attributes to the
different output items. The function parameters starting with &quot;tr&quot; provide
the meta data. Their values will be recycled if needed, so by setting a
single &quot;trDesign&quot;, all trials will get the same design. For trLat, trLong,
trDesign and trDate a column in <code>data</code> that contains the information
can be specified as well. The meta data can be changed later on using
<code>getMeta</code> and <code>setMeta</code>
</p>
</li></ul>

<p><code>addTD</code><br />
Function for adding extra trial data to an existing object of class TD. The
data for the new trials will be added after the data for existing trials. It
is possible to add data for an already existing trial, but this will cause
multiple items in the output with identical names, which might cause problems
later on in the analysis. Therefore a warning will be issued in this
case.<br /><br />
<code>dropTD</code><br />
Function for removing data for selected trials from an existing object of
class TD.<br /><br />
<code><a href="#topic+summary.TD">summary.TD</a></code> and <code><a href="#topic+plot.TD">plot.TD</a></code> methods are available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createTD(
  data,
  genotype = NULL,
  trial = NULL,
  loc = NULL,
  year = NULL,
  repId = NULL,
  subBlock = NULL,
  plotId = NULL,
  rowCoord = NULL,
  colCoord = NULL,
  rowId = rowCoord,
  colId = colCoord,
  checkId = NULL,
  trLocation = NULL,
  trDate = NULL,
  trDesign = NULL,
  trLat = NULL,
  trLong = NULL,
  trPlWidth = NULL,
  trPlLength = NULL
)

addTD(
  TD,
  data,
  genotype = NULL,
  trial = NULL,
  loc = NULL,
  year = NULL,
  repId = NULL,
  subBlock = NULL,
  plotId = NULL,
  rowCoord = NULL,
  colCoord = NULL,
  rowId = rowCoord,
  colId = colCoord,
  checkId = NULL,
  trLocation = NULL,
  trDate = NULL,
  trDesign = NULL,
  trLat = NULL,
  trLong = NULL,
  trPlWidth = NULL,
  trPlLength = NULL
)

dropTD(TD, rmTrials)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TD_+3A_data">data</code></td>
<td>
<p>A data.frame containing trial data with at least a column for
genotype. The data.frame should be in a wide format, i.e. all available
phenotypic data should be in a separate column within the data.frame.</p>
</td></tr>
<tr><td><code id="TD_+3A_genotype">genotype</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains genotypes.</p>
</td></tr>
<tr><td><code id="TD_+3A_trial">trial</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains trials.</p>
</td></tr>
<tr><td><code id="TD_+3A_loc">loc</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains trial locations.</p>
</td></tr>
<tr><td><code id="TD_+3A_year">year</code></td>
<td>
<p>An optional character string indicating the column in <code>data</code>
that contains years.</p>
</td></tr>
<tr><td><code id="TD_+3A_repid">repId</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains replicates.</p>
</td></tr>
<tr><td><code id="TD_+3A_subblock">subBlock</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains sub blocks.</p>
</td></tr>
<tr><td><code id="TD_+3A_plotid">plotId</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains plots. This column will be combined with trial
to a single output factor.</p>
</td></tr>
<tr><td><code id="TD_+3A_rowcoord">rowCoord</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains the row coordinates.</p>
</td></tr>
<tr><td><code id="TD_+3A_colcoord">colCoord</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains the column coordinates.</p>
</td></tr>
<tr><td><code id="TD_+3A_rowid">rowId</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains field rows. If not supplied, this is assumed to
be the same as rowCoord.</p>
</td></tr>
<tr><td><code id="TD_+3A_colid">colId</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains field columns. If not supplied, this is assumed to
be the same as colCoord.</p>
</td></tr>
<tr><td><code id="TD_+3A_checkid">checkId</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains the check IDs.</p>
</td></tr>
<tr><td><code id="TD_+3A_trlocation">trLocation</code></td>
<td>
<p>An optional character vector indicating the locations of
the trials. This will be used as default names when creating plots and
summaries. If no locations are provided, first the column loc is considered.
If this contains one unique value for a trial this is used as trLocation.
Otherwise the trial name is used.</p>
</td></tr>
<tr><td><code id="TD_+3A_trdate">trDate</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains the date of the trial or a date vector indicating
the dates of the trials.</p>
</td></tr>
<tr><td><code id="TD_+3A_trdesign">trDesign</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains the design of the trial or a character vector
indicating the designs of the trials. Either &quot;none&quot; (no (known) design), &quot;
ibd&quot; (incomplete-block design), &quot;res.ibd&quot; (resolvable incomplete-block
design), &quot;rcbd&quot; (randomized complete block design), &quot;rowcol&quot; (row-column
design) or &quot;res.rowcol&quot; (resolvable row-column design).</p>
</td></tr>
<tr><td><code id="TD_+3A_trlat">trLat</code></td>
<td>
<p>An optional character string indicating the column in <code>data</code>
that contains the latitude of the trial or a numerical vector indicating the
latitudes of the trials on a scale of -90 to 90.</p>
</td></tr>
<tr><td><code id="TD_+3A_trlong">trLong</code></td>
<td>
<p>An optional character string indicating the column in
<code>data</code> that contains the latitude of the trial or a numerical vector
indicating the longitudes of the trials on a scale of -180 to 180.</p>
</td></tr>
<tr><td><code id="TD_+3A_trplwidth">trPlWidth</code></td>
<td>
<p>An optional positive numerical vector indicating the
widths of the plots.</p>
</td></tr>
<tr><td><code id="TD_+3A_trpllength">trPlLength</code></td>
<td>
<p>An optional positive numerical vector indicating the
lengths of the plots.</p>
</td></tr>
<tr><td><code id="TD_+3A_td">TD</code></td>
<td>
<p>An object of class TD which should be modified.</p>
</td></tr>
<tr><td><code id="TD_+3A_rmtrials">rmTrials</code></td>
<td>
<p>A character vector of trials that should be removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class TD, a list of data.frames with renamed columns
and an attribute <code>renamedCols</code> containing an overview of renamed
columns. For each unique value of trial, the output has a data.frame in
the list with the same name as the trial. These data.frames have attributes
containing the metadata for the corresponding trial. If there is no column
for trial, the list will contain one item named after the input data.
</p>


<h3>See Also</h3>

<p>Other functions for TD objects: 
<code><a href="#topic+getMeta">getMeta</a>()</code>,
<code><a href="#topic+plot.TD">plot.TD</a>()</code>,
<code><a href="#topic+summary.TD">summary.TD</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a data.frame to be converted to TD object.
## The data consists of genotype, trial, row and column information and
## two traits, yield and flowering time.
datT1 &lt;- data.frame(geno = paste0("G", 1:10),
                    tr = "T1",
                    row = rep(1:5, each = 2),
                    col = rep(1:2, times = 5),
                    yield = 1:10,
                    flowering = 3:12)

## Convert data.frame to TD object.
TDT1 &lt;- createTD(data = datT1,
                 genotype = "geno",
                 trial = "tr",
                 rowCoord = "row",
                 colCoord = "col")

## Create a second data.frame similar to the first with data for a second trial.
datT2 &lt;- data.frame(geno = paste0("G", 1:10),
                    tr = "T2",
                    row = rep(1:2, each = 5),
                    col = rep(1:5, times = 2),
                    yield = 10:1,
                    flowering = 12:3)

## Add this data to the TD object created above.
TDTot &lt;- addTD(TD = TDT1,
               data = datT2,
               genotype = "geno",
               trial = "tr",
               rowCoord = "row",
               colCoord = "col")

## Drop the data for the first trial from the object.
TDT2 &lt;- dropTD(TD = TDTot,
               rmTrials = "T1")

</code></pre>

<hr>
<h2 id='TDHeat05'>Field data for a wheat experiment in Mexico</h2><span id='topic+TDHeat05'></span>

<h3>Description</h3>

<p>A dataset converted to a TD object containing raw plot data for one trial
from a series of wheat trials conducted in Mexico by CIMMYT. The different
trials took place under different regimes of irrigation and temperature,
there were 4 trials across two years, labelled as DRIP05, HEAT05, HEAT06 and
IRRI06. The TD object only contains the data for HEAT05. Within each trial,
a set of 167 progeny of a RIL (Recombinant Inbred Line; 8 generations)
population were tested alongside the population parents (Seri and Babax). A
lattice design with two replicates was used for each trial. In the first
replicate the entries were not randomized, as they were considered to be a
random selection from a population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TDHeat05
</code></pre>


<h3>Format</h3>

<p>A TD object, a list containing a data.frame with the following
columns:
</p>

<dl>
<dt>trial</dt><dd><p>trial, a combination of watering regime, year and nitrogen
treatment</p>
</dd>
<dt>genotype</dt><dd><p>genotype</p>
</dd>
<dt>Plot</dt><dd><p>plot number in the field</p>
</dd>
<dt>repId</dt><dd><p>replicate</p>
</dd>
<dt>subBlock</dt><dd><p>block id</p>
</dd>
<dt>rowId</dt><dd><p>row within the field (as factor)</p>
</dd>
<dt>colId</dt><dd><p>column within the field (as factor)</p>
</dd>
<dt>yield</dt><dd><p>yield in grams per square meter</p>
</dd>
<dt>rowCoord</dt><dd><p>row within the field (as numerical value)</p>
</dd>
<dt>colCoord</dt><dd><p>column within the field (as numerical value)</p>
</dd>
</dl>


<hr>
<h2 id='TDMaize'>Field data for a maize experiment in Tlaltizapan, Mexico</h2><span id='topic+TDMaize'></span>

<h3>Description</h3>

<p>A dataset converted into a TD object containing data corresponding to an
F2 maize reference population from CIMMYT maize drought breeding program,
which was derived from the cross of a drought-tolerant line (P1) with a
drought susceptible line (P2) as described in detail by Ribaut et al. (1996,
1997).<br />
DNA from 211 F2 plants was extracted to produce information for 132
co-dominant markers on 10 linkage groups. Phenotypic evaluations were
performed on 211 F2:3 families, each one derived from an original F2 plant.
The families were evaluated under different water and nitrogen regimes
during 1992, 1994 and 1996. In the winter of 1992 three water regimes were
imposed on the trials: well watered (NS), intermediate stress (IS) and severe
stress (SS). In the winter of 1994, only the IS and SS trials were available.
Nitrogen availability varied in the 1996 trials, with two low nitrogen
treatments (LN, in winter and summer) and one high-nitrogen treatment
(HN in summer). In each of the trials, five traits were evaluated but only
grain yield is included in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TDMaize
</code></pre>


<h3>Format</h3>

<p>A TD object, a list containing 8 data.frames, each with the following
columns:
</p>

<dl>
<dt>trial</dt><dd><p>trial, a combination of watering regime, year and nitrogen
treatment</p>
</dd>
<dt>genotype</dt><dd><p>genotype</p>
</dd>
<dt>regime</dt><dd><p>stress level, NS (no water stress), IS (intermediate water
stress, SS (severe water stress), LN (low nitrogen) or HN (high nitrogen))</p>
</dd>
<dt>yld</dt><dd><p>grain yield in tons</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://link.springer.com/article/10.1007/BF00221905">https://link.springer.com/article/10.1007/BF00221905</a>
</p>


<h3>References</h3>

<p>Ribaut JM, Hoisington DA, Deutsch JA, Jiang C, Gonzalez de Leon D
(1996) Identification of quantitative trait loci under drought conditions in
tropical maize.1. Flowering parameters and the anthesis-silking interval.
Theor Appl Genet 92:905–914
</p>
<p>Ribaut JM, Jiang C, Gonzalez de Leon D, Edmeades GO, Hoisington
DA (1997) Identification of quantitative trait loci under drought conditions
in tropical maize.2. Yield components and marker-assisted selection
strategies. Theor Appl Genet 94:887–896
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
