<!DOCTYPE html><html lang="en"><head><title>Help for package mand</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mand}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mand-package'><p>Multivariate Analysis for Neuroimaging Data Package</p></a></li>
<li><a href='#atlas'><p>Atlas set</p></a></li>
<li><a href='#atlasdatasets'><p>Atlas data set</p></a></li>
<li><a href='#atlastable'><p>Result report with atlas data</p></a></li>
<li><a href='#baseimg'><p>Base Brain Data</p></a></li>
<li><a href='#basisprod'><p>Product Radial Basis Function</p></a></li>
<li><a href='#coat'><p>Coat Function</p></a></li>
<li><a href='#diffimg'><p>Difference Brain Data</p></a></li>
<li><a href='#exbrain'><p>Example Brain Data</p></a></li>
<li><a href='#imgdatamat'><p>Creat Data Matrix Function</p></a></li>
<li><a href='#mask'><p>Brain Mask</p></a></li>
<li><a href='#multicoat'><p>Multi Coat Function</p></a></li>
<li><a href='#multicompplot'><p>Multi components plot</p></a></li>
<li><a href='#multirec'><p>Multi components reconstruction</p></a></li>
<li><a href='#ptest'><p>Prediction Model Function</p></a></li>
<li><a href='#rbfunc'><p>Radial Basis Function</p></a></li>
<li><a href='#rec'><p>Reconstruction</p></a></li>
<li><a href='#sdevimg'><p>Standard Deviation Brain Data</p></a></li>
<li><a href='#simbrain'><p>Generate simulation data Function</p></a></li>
<li><a href='#sizechange'><p>Size change Function</p></a></li>
<li><a href='#template'><p>Brain Template</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Analysis for Neuroimaging Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-14</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Atsushi Kawaguchi &lt;kawa_a24@yahoo.co.jp&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5), msma</td>
</tr>
<tr>
<td>Imports:</td>
<td>oro.nifti, oro.dicom, imager, caret</td>
</tr>
<tr>
<td>Description:</td>
<td>Several functions can be used to analyze neuroimaging data using multivariate methods based on the 'msma' package. The functions used in the book entitled "Multivariate Analysis for Neuroimaging Data" (2021, ISBN-13: 978-0367255329) are contained.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-12 07:30:32 UTC; kawaa</td>
</tr>
<tr>
<td>Author:</td>
<td>Atsushi Kawaguchi [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-12 22:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='mand-package'>Multivariate Analysis for Neuroimaging Data Package</h2><span id='topic+mand-package'></span>

<h3>Description</h3>

<p>A Package for implementation of multivariate data analysis for neuroimaging data.
</p>


<h3>Author(s)</h3>

<p>Atsushi Kawaguchi. <a href="mailto:kawa_a24@yahoo.co.jp">kawa_a24@yahoo.co.jp</a>
</p>


<h3>References</h3>

<p>Kawaguchi, A. (2021). Multivariate Analysis for Neuroimaging Data. CRC Press.
</p>

<hr>
<h2 id='atlas'>Atlas set</h2><span id='topic+atlas'></span>

<h3>Description</h3>

<p>The data is the atlas image data. An image whose element is &quot;ROIid&quot; is stored for each atlas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(atlas)
</code></pre>


<h3>Format</h3>

<p>A list of array
</p>

<hr>
<h2 id='atlasdatasets'>Atlas data set</h2><span id='topic+atlasdatasets'></span>

<h3>Description</h3>

<p>The data is the atlas data. Various atlases are stored. Each matrix has &quot;ROIid&quot; and &quot;ROIname&quot; as column names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(atlasdatasets)
</code></pre>


<h3>Format</h3>

<p>A list of matrix
</p>

<hr>
<h2 id='atlastable'>Result report with atlas data</h2><span id='topic+atlastable'></span><span id='topic+print.atlastable'></span>

<h3>Description</h3>

<p>This function refers to the results obtained by the analysis in an atlas image, and reports a summary of the results for each anatomical region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atlastable(x, y, atlasdataset = NULL, ROIids = NULL, ...)

## S3 method for class 'atlastable'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="atlastable_+3A_x">x</code></td>
<td>
<p>an array for the atlas image.</p>
</td></tr>
<tr><td><code id="atlastable_+3A_y">y</code></td>
<td>
<p>an array for the result image.</p>
</td></tr>
<tr><td><code id="atlastable_+3A_atlasdataset">atlasdataset</code></td>
<td>
<p>a matrix or data.frame. The colnames should include &quot;ROIid&quot; and &quot;ROIname&quot;.</p>
</td></tr>
<tr><td><code id="atlastable_+3A_roiids">ROIids</code></td>
<td>
<p>a vector indicating ROI id shown in the result.</p>
</td></tr>
<tr><td><code id="atlastable_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>atlastable</code> requires the atlas image and data frame including the ROI id and the name.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(diffimg)
data(atlasdatasets)
data(atlas)
atlasname = "aal3"
atlasdataset = atlasdatasets[[atlasname]]
tmpatlas = atlas[[atlasname]]
atlastable(tmpatlas, diffimg, atlasdataset=atlasdataset, ROIids = c(1:2, 41:44))
</code></pre>

<hr>
<h2 id='baseimg'>Base Brain Data</h2><span id='topic+baseimg'></span>

<h3>Description</h3>

<p>The data is the base brain data. This is an average image of a healthy person, and is used when generating artificial data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(baseimg)
</code></pre>


<h3>Format</h3>

<p>A array
</p>

<hr>
<h2 id='basisprod'>Product Radial Basis Function</h2><span id='topic+basisprod'></span>

<h3>Description</h3>

<p>This is a function to product the output for the rbfunc function with data matrix for a dimension reduction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basisprod(A, B)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="basisprod_+3A_a">A</code></td>
<td>
<p>a list or a matrix correponding to the output for the <code>rbfunc</code> function with the argument hispec=FALSE or data matrix, respectivey.</p>
</td></tr>
<tr><td><code id="basisprod_+3A_b">B</code></td>
<td>
<p>a list or a matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>basisprod</code> requires one list and one matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
imagedim1=c(10,10,10)

B1 = rbfunc(imagedim=imagedim1, seppix=4, hispec=TRUE)
B2 = rbfunc(imagedim=imagedim1, seppix=4, hispec=FALSE)

n = 50
S = matrix(rnorm(n*prod(imagedim1)), nrow = n, ncol = prod(imagedim1))

SB1 = S %*% B1
SB12 = tcrossprod(S, t(B1))
all(SB1-SB12 == 0)

SB2 = basisprod(S, B2)
all(SB1-SB2 == 0)

BS1 = t(B1) %*% t(S)
BS2 = basisprod(B2, S)
all(BS1-t(BS2) == 0)

</code></pre>

<hr>
<h2 id='coat'>Coat Function</h2><span id='topic+coat'></span>

<h3>Description</h3>

<p>This is a function for plotting an image. The analysis result can be overcoated on the template.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coat(
  x,
  y = NULL,
  pseq = NULL,
  xyz = NULL,
  col.x = gray(0:64/64),
  col.y = NULL,
  breaks.y = NULL,
  zlim.x = NULL,
  zlim.y = NULL,
  rownum = 5,
  colnum = NULL,
  plane = c("axial", "coronal", "sagittal", "all")[1],
  xlab = "",
  ylab = "",
  axes = FALSE,
  oma = rep(0, 4),
  mar = rep(0, 4),
  bg = "black",
  paron = TRUE,
  cross.hair = FALSE,
  chxy = NULL,
  color.bar = TRUE,
  regionplot = FALSE,
  atlasdataset = NULL,
  regionname = c("atlas", "stat")[1],
  regionlegend = FALSE,
  atlasname = "",
  ROIids = 1:9,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coat_+3A_x">x</code></td>
<td>
<p>image1. Base image.</p>
</td></tr>
<tr><td><code id="coat_+3A_y">y</code></td>
<td>
<p>image2 to be overcoated.</p>
</td></tr>
<tr><td><code id="coat_+3A_pseq">pseq</code></td>
<td>
<p>a vector plot sequence.</p>
</td></tr>
<tr><td><code id="coat_+3A_xyz">xyz</code></td>
<td>
<p>a vector position to be plotted.</p>
</td></tr>
<tr><td><code id="coat_+3A_col.x">col.x</code></td>
<td>
<p>a color vector for image1.</p>
</td></tr>
<tr><td><code id="coat_+3A_col.y">col.y</code></td>
<td>
<p>a color vector for image2.</p>
</td></tr>
<tr><td><code id="coat_+3A_breaks.y">breaks.y</code></td>
<td>
<p>a vector breaks value for y.</p>
</td></tr>
<tr><td><code id="coat_+3A_zlim.x">zlim.x</code></td>
<td>
<p>a vector plot limitation values for z of x.</p>
</td></tr>
<tr><td><code id="coat_+3A_zlim.y">zlim.y</code></td>
<td>
<p>a vector plot limitation values for z of y.</p>
</td></tr>
<tr><td><code id="coat_+3A_rownum">rownum</code></td>
<td>
<p>a numeric, the number of row for the plot.</p>
</td></tr>
<tr><td><code id="coat_+3A_colnum">colnum</code></td>
<td>
<p>a numeric, the number of colnum for the plot.</p>
</td></tr>
<tr><td><code id="coat_+3A_plane">plane</code></td>
<td>
<p>a vector plot sequence.</p>
</td></tr>
<tr><td><code id="coat_+3A_xlab">xlab</code></td>
<td>
<p>a character for a label in the x axis.</p>
</td></tr>
<tr><td><code id="coat_+3A_ylab">ylab</code></td>
<td>
<p>a character for a label in the y axis.</p>
</td></tr>
<tr><td><code id="coat_+3A_axes">axes</code></td>
<td>
<p>a logical. TRUE presents the axes.</p>
</td></tr>
<tr><td><code id="coat_+3A_oma">oma</code></td>
<td>
<p>a vector for outer margin area.</p>
</td></tr>
<tr><td><code id="coat_+3A_mar">mar</code></td>
<td>
<p>a vector for margin.</p>
</td></tr>
<tr><td><code id="coat_+3A_bg">bg</code></td>
<td>
<p>a character for color of background.</p>
</td></tr>
<tr><td><code id="coat_+3A_paron">paron</code></td>
<td>
<p>a logical. TRUE means par is used.</p>
</td></tr>
<tr><td><code id="coat_+3A_cross.hair">cross.hair</code></td>
<td>
<p>a logical.</p>
</td></tr>
<tr><td><code id="coat_+3A_chxy">chxy</code></td>
<td>
<p>a vector cross hair position to be plotted.</p>
</td></tr>
<tr><td><code id="coat_+3A_color.bar">color.bar</code></td>
<td>
<p>a logical.</p>
</td></tr>
<tr><td><code id="coat_+3A_regionplot">regionplot</code></td>
<td>
<p>a logical.</p>
</td></tr>
<tr><td><code id="coat_+3A_atlasdataset">atlasdataset</code></td>
<td>
<p>a matrix or data.frame. colnames shold include &quot;ROIid&quot; and &quot;ROIname&quot;.</p>
</td></tr>
<tr><td><code id="coat_+3A_regionname">regionname</code></td>
<td>
<p>a character.</p>
</td></tr>
<tr><td><code id="coat_+3A_regionlegend">regionlegend</code></td>
<td>
<p>a logical.</p>
</td></tr>
<tr><td><code id="coat_+3A_atlasname">atlasname</code></td>
<td>
<p>a character.</p>
</td></tr>
<tr><td><code id="coat_+3A_roiids">ROIids</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="coat_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>coat</code> requires a image array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(exbrain)
coat(exbrain)

</code></pre>

<hr>
<h2 id='diffimg'>Difference Brain Data</h2><span id='topic+diffimg'></span>

<h3>Description</h3>

<p>The data is the difference brain data. This represents the difference between the average images of healthy subjects and patients with Alzheimer's disease, and is used when generating artificial data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(diffimg)
</code></pre>


<h3>Format</h3>

<p>A array
</p>

<hr>
<h2 id='exbrain'>Example Brain Data</h2><span id='topic+exbrain'></span>

<h3>Description</h3>

<p>The data are from a MRI gray matter brain data for one subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(exbrain)
</code></pre>


<h3>Format</h3>

<p>A array
</p>

<hr>
<h2 id='imgdatamat'>Creat Data Matrix Function</h2><span id='topic+imgdatamat'></span>

<h3>Description</h3>

<p>This is a function that creates a data matrix for analysis from a file saved in image format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imgdatamat(
  imgfnames,
  mask = NULL,
  ROI = FALSE,
  atlas = NULL,
  atlasdataset = NULL,
  ROIids = NULL,
  zeromask = FALSE,
  schange = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imgdatamat_+3A_imgfnames">imgfnames</code></td>
<td>
<p>a vector for (nifti) file names to be used.</p>
</td></tr>
<tr><td><code id="imgdatamat_+3A_mask">mask</code></td>
<td>
<p>a vector for brain mask data.</p>
</td></tr>
<tr><td><code id="imgdatamat_+3A_roi">ROI</code></td>
<td>
<p>a logical for roi data set.</p>
</td></tr>
<tr><td><code id="imgdatamat_+3A_atlas">atlas</code></td>
<td>
<p>an array for the atlas.</p>
</td></tr>
<tr><td><code id="imgdatamat_+3A_atlasdataset">atlasdataset</code></td>
<td>
<p>a matrix or data.frame. colnames shold include &quot;ROIid&quot; and &quot;ROIname&quot;.</p>
</td></tr>
<tr><td><code id="imgdatamat_+3A_roiids">ROIids</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="imgdatamat_+3A_zeromask">zeromask</code></td>
<td>
<p>a logical for masking voxel with all zeros.</p>
</td></tr>
<tr><td><code id="imgdatamat_+3A_schange">schange</code></td>
<td>
<p>a logical for change dimension.</p>
</td></tr>
<tr><td><code id="imgdatamat_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>imgdatamat</code> requires image file names.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>S</code></td>
<td>
<p>data matrix</p>
</td></tr>
<tr><td><code>brainpos</code></td>
<td>
<p>binary brain position.</p>
</td></tr>
<tr><td><code>imagedim</code></td>
<td>
<p>three dimensional vector for image dimension</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># imgfnames1 = c("img1.nii", "img2.nii")
# imgdata = imgdatamat(imgfnames1)

</code></pre>

<hr>
<h2 id='mask'>Brain Mask</h2><span id='topic+mask'></span>

<h3>Description</h3>

<p>The data is the brain mask. This is used to exclude extra-brain regions from the analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mask)
</code></pre>


<h3>Format</h3>

<p>A array
</p>

<hr>
<h2 id='multicoat'>Multi Coat Function</h2><span id='topic+multicoat'></span>

<h3>Description</h3>

<p>This is a function for plotting an image. The analysis result can be overcoated on the template.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multicoat(imgs, y = NULL, row4imp = 6, col4imp = 1, trm = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multicoat_+3A_imgs">imgs</code></td>
<td>
<p>list of images. Base images.</p>
</td></tr>
<tr><td><code id="multicoat_+3A_y">y</code></td>
<td>
<p>image2 to be overcoated.</p>
</td></tr>
<tr><td><code id="multicoat_+3A_row4imp">row4imp</code></td>
<td>
<p>the number of rows per a image</p>
</td></tr>
<tr><td><code id="multicoat_+3A_col4imp">col4imp</code></td>
<td>
<p>the number of columns per a image</p>
</td></tr>
<tr><td><code id="multicoat_+3A_trm">trm</code></td>
<td>
<p>the index to trim the top and bottom of the slice</p>
</td></tr>
<tr><td><code id="multicoat_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>multicoat</code> requires a image array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(exbrain)

</code></pre>

<hr>
<h2 id='multicompplot'>Multi components plot</h2><span id='topic+multicompplot'></span>

<h3>Description</h3>

<p>This is a function that plots the vectorized image returned to its original dimensions by the multirec function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multicompplot(
  object,
  x,
  comps = NULL,
  row4comp = 6,
  col4comp = 1,
  pseq4comp = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multicompplot_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>multirec</code>.&quot; Usually, a result of a call to <code>multirec</code></p>
</td></tr>
<tr><td><code id="multicompplot_+3A_x">x</code></td>
<td>
<p>template image</p>
</td></tr>
<tr><td><code id="multicompplot_+3A_comps">comps</code></td>
<td>
<p>a component sequence to be plotted.</p>
</td></tr>
<tr><td><code id="multicompplot_+3A_row4comp">row4comp</code></td>
<td>
<p>the number of rows per a component</p>
</td></tr>
<tr><td><code id="multicompplot_+3A_col4comp">col4comp</code></td>
<td>
<p>the number of columns per a component</p>
</td></tr>
<tr><td><code id="multicompplot_+3A_pseq4comp">pseq4comp</code></td>
<td>
<p>the number of images per a component</p>
</td></tr>
<tr><td><code id="multicompplot_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>multicompplot</code> requires the output result of <code>msma</code> function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(baseimg)
data(diffimg)
data(mask)
data(template)
img1 = simbrain(baseimg = baseimg, diffimg = diffimg, mask=mask)
B1 = rbfunc(imagedim=img1$imagedim, seppix=2, hispec=FALSE, mask=img1$brainpos)
SB1 = basisprod(img1$S, B1)
fit111 = msma(SB1, comp=2)
ws = multirec(fit111, imagedim=img1$imagedim, B=B1, mask=img1$brainpos)
multicompplot(ws, template)

</code></pre>

<hr>
<h2 id='multirec'>Multi components reconstruction</h2><span id='topic+multirec'></span>

<h3>Description</h3>

<p>This is a function that returns the weight vector of multiple components obtained by the <code>msma</code> function applied after dimension reduction by the radial basis function to the same dimension as the original image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multirec(
  object,
  imagedim,
  B = NULL,
  mask = NULL,
  midx = 1,
  comps = NULL,
  XY = c("X", "Y", "XY")[1],
  signflip = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multirec_+3A_object">object</code></td>
<td>
<p>an object of class <code>msma</code>. Usually, a result of a call to <code>msma</code></p>
</td></tr>
<tr><td><code id="multirec_+3A_imagedim">imagedim</code></td>
<td>
<p>a vector for original dimension.</p>
</td></tr>
<tr><td><code id="multirec_+3A_b">B</code></td>
<td>
<p>a list or a matrix.</p>
</td></tr>
<tr><td><code id="multirec_+3A_mask">mask</code></td>
<td>
<p>a list or a matrix.</p>
</td></tr>
<tr><td><code id="multirec_+3A_midx">midx</code></td>
<td>
<p>a block number.</p>
</td></tr>
<tr><td><code id="multirec_+3A_comps">comps</code></td>
<td>
<p>a component sequence to be plotted.</p>
</td></tr>
<tr><td><code id="multirec_+3A_xy">XY</code></td>
<td>
<p>a character, indicating &quot;X&quot; or &quot;Y&quot;. &quot;XY&quot; for the scatter plots using X and Y scores from <code>msma</code>.</p>
</td></tr>
<tr><td><code id="multirec_+3A_signflip">signflip</code></td>
<td>
<p>a logical if the sign in the block is flipped to pose the super as possitive.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>multirec</code> requires the output result of <code>msma</code> function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(baseimg)
data(diffimg)
data(mask)
img1 = simbrain(baseimg = baseimg, diffimg = diffimg, mask=mask)
B1 = rbfunc(imagedim=img1$imagedim, seppix=2, hispec=FALSE, mask=img1$brainpos)
SB1 = basisprod(img1$S, B1)
fit111 = msma(SB1, comp=2)
ws = multirec(fit111, imagedim=img1$imagedim, B=B1, mask=img1$brainpos)

</code></pre>

<hr>
<h2 id='ptest'>Prediction Model Function</h2><span id='topic+ptest'></span>

<h3>Description</h3>

<p>This is the function that creates and evaluates the predictive model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptest(
  object,
  Z = Z,
  newdata = NULL,
  testZ = NULL,
  regmethod = "glm",
  methods1 = c("boot", "boot632", "cv", "repeatedcv", "LOOCV", "LGOCV")[4],
  metric = "ROC",
  number1 = 10,
  repeats1 = 5,
  params = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ptest_+3A_object">object</code></td>
<td>
<p>a matrix indicating the explanatory variable(s), or an object of class <code>msma</code>, which is a result of a call to <code>msma</code> .</p>
</td></tr>
<tr><td><code id="ptest_+3A_z">Z</code></td>
<td>
<p>a vector, response variable(s) for the construction of the prediction model. The length of Z is the number of subjects for the training.</p>
</td></tr>
<tr><td><code id="ptest_+3A_newdata">newdata</code></td>
<td>
<p>a matrix for the prediction.</p>
</td></tr>
<tr><td><code id="ptest_+3A_testz">testZ</code></td>
<td>
<p>a vector, response variable(s) for the prediction evaluation. The length of testZ is the number of subjects for the validation.</p>
</td></tr>
<tr><td><code id="ptest_+3A_regmethod">regmethod</code></td>
<td>
<p>a character for the name of the prediction model. This corresponds to the <code>method</code> argument of the <code>train</code> function in the <code>caret</code> package.</p>
</td></tr>
<tr><td><code id="ptest_+3A_methods1">methods1</code></td>
<td>
<p>a character for the name of the evaluation method.</p>
</td></tr>
<tr><td><code id="ptest_+3A_metric">metric</code></td>
<td>
<p>a character for the name of summary metric to select the optimal model.</p>
</td></tr>
<tr><td><code id="ptest_+3A_number1">number1</code></td>
<td>
<p>a number of folds or number of resampling iterations</p>
</td></tr>
<tr><td><code id="ptest_+3A_repeats1">repeats1</code></td>
<td>
<p>a number of repeats for the repeated cross-validation</p>
</td></tr>
<tr><td><code id="ptest_+3A_params">params</code></td>
<td>
<p>a data frame with possible tuning values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ptest</code> requires the output result of <code>msma</code> function.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>object</code></td>
<td>
<p>an object of class &quot;<code>msma</code>&quot;, usually, a result of a call to <code>msma</code></p>
</td></tr>
<tr><td><code>trainout</code></td>
<td>
<p>a predictive model output from the train function in the caret package with scores computed by the msma function as predictors</p>
</td></tr>
<tr><td><code>scorecvroc</code></td>
<td>
<p>the training evaluation measure and values of the tuning parameters</p>
</td></tr>
<tr><td><code>evalmeasure</code></td>
<td>
<p>evaluation measures and information criterion for the msma model</p>
</td></tr>
<tr><td><code>traincnfmat</code></td>
<td>
<p>a confusion matrix in training data</p>
</td></tr>
<tr><td><code>predcnfmat</code></td>
<td>
<p>a confusion matrix in test data</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>

data(baseimg)
data(diffimg)
data(mask)
data(template)
img1 = simbrain(baseimg = baseimg, diffimg = diffimg, mask=mask)
B1 = rbfunc(imagedim=img1$imagedim, seppix=2, hispec=FALSE, mask=img1$brainpos)
SB1 = basisprod(img1$S, B1)
fit111 = msma(SB1, comp=2)
predmodel = ptest(fit111, Z=img1$Z)


</code></pre>

<hr>
<h2 id='rbfunc'>Radial Basis Function</h2><span id='topic+rbfunc'></span>

<h3>Description</h3>

<p>This makes a radial basis function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbfunc(imagedim, seppix, hispec = FALSE, mask = NULL, brainpos = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rbfunc_+3A_imagedim">imagedim</code></td>
<td>
<p>a vector indicating image three dimension.</p>
</td></tr>
<tr><td><code id="rbfunc_+3A_seppix">seppix</code></td>
<td>
<p>a numeric. distance between knots.</p>
</td></tr>
<tr><td><code id="rbfunc_+3A_hispec">hispec</code></td>
<td>
<p>a logical. TRUE produces a matrix output. FALSE produces a list output to reduce the data memorry.</p>
</td></tr>
<tr><td><code id="rbfunc_+3A_mask">mask</code></td>
<td>
<p>a vector.</p>
</td></tr>
<tr><td><code id="rbfunc_+3A_brainpos">brainpos</code></td>
<td>
<p>a logical vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rbfunc</code> requires the dimensions of the original image to be applied and the knot interval. The output is obtained as a matrix, with the number of rows corresponding to the number of voxels in the original image and the number of columns determined by the knot spacing. By setting hispec = TRUE, you can get the output in list format with a smaller memory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
imagedim1=c(10,10,10)

B1 = rbfunc(imagedim=imagedim1, seppix=4, hispec=TRUE)
B2 = rbfunc(imagedim=imagedim1, seppix=4, hispec=FALSE)

</code></pre>

<hr>
<h2 id='rec'>Reconstruction</h2><span id='topic+rec'></span>

<h3>Description</h3>

<p>This is a function that restores the vectorized image to its original dimensions, reduced in dimension by the radial basis function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rec(Q, imagedim, B = NULL, mask = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rec_+3A_q">Q</code></td>
<td>
<p>a vector for reduced data.</p>
</td></tr>
<tr><td><code id="rec_+3A_imagedim">imagedim</code></td>
<td>
<p>a vector for original dimension.</p>
</td></tr>
<tr><td><code id="rec_+3A_b">B</code></td>
<td>
<p>a list or a matrix indicating the basis function used in the dimension reduction.</p>
</td></tr>
<tr><td><code id="rec_+3A_mask">mask</code></td>
<td>
<p>a list or a matrix indicating the mask image used in the dimension reduction.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rec</code> requires a vector to be converted to a array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
imagedim1=c(10,10,10)
recvec = rec(rnorm(prod(imagedim1)), imagedim1)

</code></pre>

<hr>
<h2 id='sdevimg'>Standard Deviation Brain Data</h2><span id='topic+sdevimg'></span>

<h3>Description</h3>

<p>The data is the standard deviation brain data. This represents the common standard deviation between the average images of healthy subjects and patients with Alzheimer's disease, and is used when generating artificial data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sdevimg)
</code></pre>


<h3>Format</h3>

<p>A array
</p>

<hr>
<h2 id='simbrain'>Generate simulation data Function</h2><span id='topic+simbrain'></span>

<h3>Description</h3>

<p>This is a function for simulation data based on the real base brain image data and difference in brain between healty and disease groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simbrain(
  baseimg,
  diffimg,
  sdevimg = NULL,
  mask = NULL,
  n0 = 10,
  c1 = 0.5,
  sd1 = 0.01,
  rho = NULL,
  zeromask = FALSE,
  reduce = c("no", "rd1", "rd2")[1],
  output = c("rdata", "nifti")[1],
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simbrain_+3A_baseimg">baseimg</code></td>
<td>
<p>an array for the basis image.</p>
</td></tr>
<tr><td><code id="simbrain_+3A_diffimg">diffimg</code></td>
<td>
<p>an array for the difference image.</p>
</td></tr>
<tr><td><code id="simbrain_+3A_sdevimg">sdevimg</code></td>
<td>
<p>an array for the standard deviation image.</p>
</td></tr>
<tr><td><code id="simbrain_+3A_mask">mask</code></td>
<td>
<p>an array for the mask image.</p>
</td></tr>
<tr><td><code id="simbrain_+3A_n0">n0</code></td>
<td>
<p>a numeric, which is a sample size per group.</p>
</td></tr>
<tr><td><code id="simbrain_+3A_c1">c1</code></td>
<td>
<p>a numeric, the strength of the difference</p>
</td></tr>
<tr><td><code id="simbrain_+3A_sd1">sd1</code></td>
<td>
<p>a numeric, standard deviation for the individual variation.</p>
</td></tr>
<tr><td><code id="simbrain_+3A_rho">rho</code></td>
<td>
<p>a numeric, correlation coefficient in the noize</p>
</td></tr>
<tr><td><code id="simbrain_+3A_zeromask">zeromask</code></td>
<td>
<p>a logical, whether mask the position with zero values for all subjects.</p>
</td></tr>
<tr><td><code id="simbrain_+3A_reduce">reduce</code></td>
<td>
<p>a vector.</p>
</td></tr>
<tr><td><code id="simbrain_+3A_output">output</code></td>
<td>
<p>a vector.</p>
</td></tr>
<tr><td><code id="simbrain_+3A_seed">seed</code></td>
<td>
<p>a numeric for seed for random variables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>simbrain</code> requires a base brain image data and mean difference image data.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>S</code></td>
<td>
<p>data matrix</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>binary group variable</p>
</td></tr>
<tr><td><code>brainpos</code></td>
<td>
<p>binary brain position.</p>
</td></tr>
<tr><td><code>imagedim</code></td>
<td>
<p>three dimensional vector for image dimension</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(baseimg)
data(diffimg)
sim1 = simbrain(baseimg = baseimg, diffimg = diffimg)

</code></pre>

<hr>
<h2 id='sizechange'>Size change Function</h2><span id='topic+sizechange'></span>

<h3>Description</h3>

<p>TThis is a function that changes the resolution of the image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sizechange(img1, simscale = NULL, refsize = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sizechange_+3A_img1">img1</code></td>
<td>
<p>a array or nifti class, which is a image data to be changed the size.</p>
</td></tr>
<tr><td><code id="sizechange_+3A_simscale">simscale</code></td>
<td>
<p>a numeric.</p>
</td></tr>
<tr><td><code id="sizechange_+3A_refsize">refsize</code></td>
<td>
<p>a vector with length 3, which is a size to be changed.</p>
</td></tr>
<tr><td><code id="sizechange_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sizechange</code> requires the array data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(exbrain)
exbrain2 = sizechange(exbrain, simscale=1/2)

</code></pre>

<hr>
<h2 id='template'>Brain Template</h2><span id='topic+template'></span>

<h3>Description</h3>

<p>The data is the brain tempalte. This is an average brain image, and is mainly used for overlaying analysis results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(template)
</code></pre>


<h3>Format</h3>

<p>A array
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
