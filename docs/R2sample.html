<!DOCTYPE html><html lang="en"><head><title>Help for package R2sample</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {R2sample}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#R2sample-package'><p>R2sample: Various Methods for the Two Sample Problem</p></a></li>
<li><a href='#asymptotic_pvalues'><p>This function finds the p values of several tests based on large sample theory</p></a></li>
<li><a href='#bincounter'><p>find counts in bins. Useful for power calculations. Replaces hist command from R.</p></a></li>
<li><a href='#calcTS'><p>This function calculates the test statistics for continuous data</p></a></li>
<li><a href='#case.studies'><p>This function creates the functions needed to run the various case studies.</p></a></li>
<li><a href='#chi_power'><p>This function runs the chi-square test for continuous or discrete data</p></a></li>
<li><a href='#chi_test'><p>This function runs the chi-square test for continuous or discrete data</p></a></li>
<li><a href='#Cpporder'><p>sort vector y by values in vector x</p></a></li>
<li><a href='#myTS2'><p>a local function needed for the vignette</p></a></li>
<li><a href='#perm_test_cont'><p>run permutation test.</p></a></li>
<li><a href='#perm_test_disc'><p>run permutation test.</p></a></li>
<li><a href='#permute_disc'><p>permute discrete data</p></a></li>
<li><a href='#plot_power'><p>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.</p></a></li>
<li><a href='#power_cont'><p>Find the power of various continuous tests via permutation.</p></a></li>
<li><a href='#power_cont_LS'><p>Find the power of various discrete tests via permutation.</p></a></li>
<li><a href='#power_cont_R'><p>Find the power of built-in continuous two sample tests using Rcpp and parallel computing.</p></a></li>
<li><a href='#power_disc'><p>Find the power of various continuous tests via permutation.</p></a></li>
<li><a href='#power_disc_R'><p>Find the power of built-in continuous two sample tests using Rcpp and parallel computing.</p></a></li>
<li><a href='#power_newtest'><p>This function estimates the power of test routines that calculate p value(s)</p></a></li>
<li><a href='#power_studies_results'><p>power_studies_results</p></a></li>
<li><a href='#pvaluecdf'><p>pvaluecdf</p></a></li>
<li><a href='#repC'><p>cpp version of R routine rep</p></a></li>
<li><a href='#run_shiny'><p>Runs the shiny app associated with R2sample package</p></a></li>
<li><a href='#run.studies'><p>This function runs the case studies included in the package</p></a></li>
<li><a href='#signif.digits'><p>This function does some rounding to nice numbers</p></a></li>
<li><a href='#timecheck'><p>test function</p></a></li>
<li><a href='#ts_C'><p>This function calculates the test statistics for continuous data</p></a></li>
<li><a href='#TS_cont'><p>find test statistics for continuous data</p></a></li>
<li><a href='#ts_D'><p>This function calculates the test statistics for discrete data</p></a></li>
<li><a href='#TS_disc'><p>find test statistics for discrete data</p></a></li>
<li><a href='#TSw_cont'><p>find test statistics for continuous data with weights</p></a></li>
<li><a href='#TSw_disc'><p>find test statistics for discrete data</p></a></li>
<li><a href='#twosample_power'><p>Find the power of various two sample tests using Rcpp and parallel computing.</p></a></li>
<li><a href='#twosample_test'><p>This function runs a number of two sample tests using Rcpp and parallel computing.</p></a></li>
<li><a href='#twosample_test_adjusted_pvalue'><p>This function runs a number of two sample tests using Rcpp and parallel computing and then finds the correct p value for the combined tests.</p></a></li>
<li><a href='#wbincounter'><p>Find counts and/or sum of weights in bins. Useful for power calculations. Replaces hist command from R.</p></a></li>
<li><a href='#weights'><p>find weights for several statistics for discrete data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Various Methods for the Two Sample Problem</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>The routine twosample_test() in this package runs the
    two sample test using various test statistic. The p values are
    found via permutation or large sample theory. The routine twosample_power() allows the
    calculation of the power in various cases, and plot_power() draws the corresponding power graphs.
    The routine run.studies allows a user to quickly study the power of a new method and 
    how it compares to some of the standard ones.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, parallel, shiny, ggplot2, stats, graphics,
microbenchmark</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-16 18:49:17 UTC; Wolfgang</td>
</tr>
<tr>
<td>Author:</td>
<td>Wolfgang Rolke <a href="https://orcid.org/0000-0002-3514-726X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wolfgang Rolke &lt;wolfgang.rolke@upr.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-16 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='R2sample-package'>R2sample: Various Methods for the Two Sample Problem</h2><span id='topic+R2sample'></span><span id='topic+R2sample-package'></span>

<h3>Description</h3>

<p>The routine twosample_test() in this package runs the two sample test using various test statistic. The p values are found via permutation or large sample theory. The routine twosample_power() allows the calculation of the power in various cases, and plot_power() draws the corresponding power graphs. The routine run.studies allows a user to quickly study the power of a new method and how it compares to some of the standard ones.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Wolfgang Rolke <a href="mailto:wolfgang.rolke@upr.edu">wolfgang.rolke@upr.edu</a> (<a href="https://orcid.org/0000-0002-3514-726X">ORCID</a>)
</p>

<hr>
<h2 id='asymptotic_pvalues'>This function finds the p values of several tests based on large sample theory</h2><span id='topic+asymptotic_pvalues'></span>

<h3>Description</h3>

<p>This function finds the p values of several tests based on large sample theory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asymptotic_pvalues(x, n, m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="asymptotic_pvalues_+3A_x">x</code></td>
<td>
<p>a vector of test statistics</p>
</td></tr>
<tr><td><code id="asymptotic_pvalues_+3A_n">n</code></td>
<td>
<p>size of sample 1</p>
</td></tr>
<tr><td><code id="asymptotic_pvalues_+3A_m">m</code></td>
<td>
<p>size of sample 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of p values.
</p>

<hr>
<h2 id='bincounter'>find counts in bins. Useful for power calculations. Replaces hist command from R.</h2><span id='topic+bincounter'></span>

<h3>Description</h3>

<p>find counts in bins. Useful for power calculations. Replaces hist command from R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bincounter(x, bins)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bincounter_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="bincounter_+3A_bins">bins</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer vector of counts
</p>

<hr>
<h2 id='calcTS'>This function calculates the test statistics for continuous data</h2><span id='topic+calcTS'></span>

<h3>Description</h3>

<p>This function calculates the test statistics for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcTS(dta, TS, typeTS, TSextra)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcTS_+3A_dta">dta</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="calcTS_+3A_ts">TS</code></td>
<td>
<p>routine</p>
</td></tr>
<tr><td><code id="calcTS_+3A_typets">typeTS</code></td>
<td>
<p>format of TS</p>
</td></tr>
<tr><td><code id="calcTS_+3A_tsextra">TSextra</code></td>
<td>
<p>list passed to TS function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numbers
</p>

<hr>
<h2 id='case.studies'>This function creates the functions needed to run the various case studies.</h2><span id='topic+case.studies'></span>

<h3>Description</h3>

<p>This function creates the functions needed to run the various case studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>case.studies(which, nsample = 500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="case.studies_+3A_which">which</code></td>
<td>
<p>name of the case study.</p>
</td></tr>
<tr><td><code id="case.studies_+3A_nsample">nsample</code></td>
<td>
<p>=500, sample size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of functions
</p>

<hr>
<h2 id='chi_power'>This function runs the chi-square test for continuous or discrete data</h2><span id='topic+chi_power'></span>

<h3>Description</h3>

<p>This function runs the chi-square test for continuous or discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_power(
  rxy,
  alpha = 0.05,
  B = 1000,
  xparam,
  yparam,
  nbins = c(50, 10),
  minexpcount = 5,
  typeTS
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chi_power_+3A_rxy">rxy</code></td>
<td>
<p>a function to generate data</p>
</td></tr>
<tr><td><code id="chi_power_+3A_alpha">alpha</code></td>
<td>
<p>=0.05 type I error probability of test</p>
</td></tr>
<tr><td><code id="chi_power_+3A_b">B</code></td>
<td>
<p>=1000 number of simulation runs</p>
</td></tr>
<tr><td><code id="chi_power_+3A_xparam">xparam</code></td>
<td>
<p>vector of parameter values</p>
</td></tr>
<tr><td><code id="chi_power_+3A_yparam">yparam</code></td>
<td>
<p>vector of parameter values</p>
</td></tr>
<tr><td><code id="chi_power_+3A_nbins">nbins</code></td>
<td>
<p>=c(50, 10) number of desired bins</p>
</td></tr>
<tr><td><code id="chi_power_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 smallest number of counts required in each bin</p>
</td></tr>
<tr><td><code id="chi_power_+3A_typets">typeTS</code></td>
<td>
<p>type of problem, continuous/discrete, with/without weights</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of power values
</p>

<hr>
<h2 id='chi_test'>This function runs the chi-square test for continuous or discrete data</h2><span id='topic+chi_test'></span>

<h3>Description</h3>

<p>This function runs the chi-square test for continuous or discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_test(dta, nbins = c(50, 10), minexpcount = 5, typeTS, ponly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chi_test_+3A_dta">dta</code></td>
<td>
<p>a list with two elements for continuous data or three elements for discrete data, Can also include weights for continuous data</p>
</td></tr>
<tr><td><code id="chi_test_+3A_nbins">nbins</code></td>
<td>
<p>=c(50, 10) number of desired bins</p>
</td></tr>
<tr><td><code id="chi_test_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 smallest number of counts required in each bin</p>
</td></tr>
<tr><td><code id="chi_test_+3A_typets">typeTS</code></td>
<td>
<p>=5  type of problem, continuous/discrete, with/without weights</p>
</td></tr>
<tr><td><code id="chi_test_+3A_ponly">ponly</code></td>
<td>
<p>Should the p value alone be returned?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the test statistics, the p value and the degree of freedom for each test
</p>

<hr>
<h2 id='Cpporder'>sort vector y by values in vector x</h2><span id='topic+Cpporder'></span>

<h3>Description</h3>

<p>sort vector y by values in vector x
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cpporder(y, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Cpporder_+3A_y">y</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="Cpporder_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector
</p>

<hr>
<h2 id='myTS2'>a local function needed for the vignette</h2><span id='topic+myTS2'></span>

<h3>Description</h3>

<p>a local function needed for the vignette
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myTS2(x, y, vals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="myTS2_+3A_x">x</code></td>
<td>
<p>An integer vector.</p>
</td></tr>
<tr><td><code id="myTS2_+3A_y">y</code></td>
<td>
<p>An integer vector.</p>
</td></tr>
<tr><td><code id="myTS2_+3A_vals">vals</code></td>
<td>
<p>A numeric vector with the values of the discrete rv.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with test statistics
</p>

<hr>
<h2 id='perm_test_cont'>run permutation test.</h2><span id='topic+perm_test_cont'></span>

<h3>Description</h3>

<p>run permutation test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm_test_cont(x, y, TS, typeTS, TSextra, wx, wy, B = 5000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="perm_test_cont_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="perm_test_cont_+3A_y">y</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="perm_test_cont_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistics for non-chi-square tests</p>
</td></tr>
<tr><td><code id="perm_test_cont_+3A_typets">typeTS</code></td>
<td>
<p>type of a test statistic</p>
</td></tr>
<tr><td><code id="perm_test_cont_+3A_tsextra">TSextra</code></td>
<td>
<p>additional info passed to TS, if necessary</p>
</td></tr>
<tr><td><code id="perm_test_cont_+3A_wx">wx</code></td>
<td>
<p>a numeric vector of weights of x.</p>
</td></tr>
<tr><td><code id="perm_test_cont_+3A_wy">wy</code></td>
<td>
<p>a numeric vector of weights of y.</p>
</td></tr>
<tr><td><code id="perm_test_cont_+3A_b">B</code></td>
<td>
<p>=5000, number of simulation runs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with test statistics and p values
</p>

<hr>
<h2 id='perm_test_disc'>run permutation test.</h2><span id='topic+perm_test_disc'></span>

<h3>Description</h3>

<p>run permutation test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm_test_disc(x, y, vals, TS, typeTS, TSextra, samplingmethod = 1L, B = 5000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="perm_test_disc_+3A_x">x</code></td>
<td>
<p>A vector of counts or weights.</p>
</td></tr>
<tr><td><code id="perm_test_disc_+3A_y">y</code></td>
<td>
<p>A vector of counts or weights.</p>
</td></tr>
<tr><td><code id="perm_test_disc_+3A_vals">vals</code></td>
<td>
<p>A numeric vector. Indicates discrete data.</p>
</td></tr>
<tr><td><code id="perm_test_disc_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistics for non-chi-square tests</p>
</td></tr>
<tr><td><code id="perm_test_disc_+3A_typets">typeTS</code></td>
<td>
<p>type of a test statistic</p>
</td></tr>
<tr><td><code id="perm_test_disc_+3A_tsextra">TSextra</code></td>
<td>
<p>additional info passed to TS, if necessary</p>
</td></tr>
<tr><td><code id="perm_test_disc_+3A_samplingmethod">samplingmethod</code></td>
<td>
<p>=1, 1 for independence sampling, 2 for MCMC</p>
</td></tr>
<tr><td><code id="perm_test_disc_+3A_b">B</code></td>
<td>
<p>Number of simulation runs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with test statistics and p values
</p>

<hr>
<h2 id='permute_disc'>permute discrete data</h2><span id='topic+permute_disc'></span>

<h3>Description</h3>

<p>permute discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute_disc(dta, samplingmethod = 1L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permute_disc_+3A_dta">dta</code></td>
<td>
<p>A list of numeric vectors.</p>
</td></tr>
<tr><td><code id="permute_disc_+3A_samplingmethod">samplingmethod</code></td>
<td>
<p>=2 , 1 for independence sampling by expansion or 2 for MCMC</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of permuted vectors
</p>

<hr>
<h2 id='plot_power'>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.</h2><span id='topic+plot_power'></span>

<h3>Description</h3>

<p>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_power(pwr, xname = " ", title = " ", Smooth = TRUE, span = 0.25)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_power_+3A_pwr">pwr</code></td>
<td>
<p>a matrix of power values, usually from the twosample_power command</p>
</td></tr>
<tr><td><code id="plot_power_+3A_xname">xname</code></td>
<td>
<p>Name of variable on x axis</p>
</td></tr>
<tr><td><code id="plot_power_+3A_title">title</code></td>
<td>
<p>(Optional) title of graph</p>
</td></tr>
<tr><td><code id="plot_power_+3A_smooth">Smooth</code></td>
<td>
<p>=TRUE lines are smoothed for easier reading</p>
</td></tr>
<tr><td><code id="plot_power_+3A_span">span</code></td>
<td>
<p>=0.25bandwidth of smoothing method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plt, an object of class ggplot.
</p>

<hr>
<h2 id='power_cont'>Find the power of various continuous tests via permutation.</h2><span id='topic+power_cont'></span>

<h3>Description</h3>

<p>Find the power of various continuous tests via permutation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_cont(rxy, xparam, yparam, TS, typeTS, TSextra, B = 1000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_cont_+3A_rxy">rxy</code></td>
<td>
<p>a function that generates x and y data.</p>
</td></tr>
<tr><td><code id="power_cont_+3A_xparam">xparam</code></td>
<td>
<p>arguments for r1.</p>
</td></tr>
<tr><td><code id="power_cont_+3A_yparam">yparam</code></td>
<td>
<p>arguments for r2.</p>
</td></tr>
<tr><td><code id="power_cont_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistics for non-chi-square tests</p>
</td></tr>
<tr><td><code id="power_cont_+3A_typets">typeTS</code></td>
<td>
<p>indicator for type of test statistics</p>
</td></tr>
<tr><td><code id="power_cont_+3A_tsextra">TSextra</code></td>
<td>
<p>additional info passed to TS, if necessary</p>
</td></tr>
<tr><td><code id="power_cont_+3A_b">B</code></td>
<td>
<p>=1000 number of simulation runs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list values of test statistics
</p>

<hr>
<h2 id='power_cont_LS'>Find the power of various discrete tests via permutation.</h2><span id='topic+power_cont_LS'></span>

<h3>Description</h3>

<p>Find the power of various discrete tests via permutation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_cont_LS(rxy, alpha = 0.05, B = 1000, xparam = 0, yparam = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_cont_LS_+3A_rxy">rxy</code></td>
<td>
<p>a function that generates x and y data.</p>
</td></tr>
<tr><td><code id="power_cont_LS_+3A_alpha">alpha</code></td>
<td>
<p>A numeric constant</p>
</td></tr>
<tr><td><code id="power_cont_LS_+3A_b">B</code></td>
<td>
<p>Number of simulation runs.</p>
</td></tr>
<tr><td><code id="power_cont_LS_+3A_xparam">xparam</code></td>
<td>
<p>arguments for r1.</p>
</td></tr>
<tr><td><code id="power_cont_LS_+3A_yparam">yparam</code></td>
<td>
<p>arguments for r2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of powers
</p>

<hr>
<h2 id='power_cont_R'>Find the power of built-in continuous two sample tests using Rcpp and parallel computing.</h2><span id='topic+power_cont_R'></span>

<h3>Description</h3>

<p>Find the power of built-in continuous two sample tests using Rcpp and parallel computing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_cont_R(
  rxy,
  xparam,
  yparam,
  TS,
  typeTS,
  TSextra,
  alpha = 0.05,
  B = 1000,
  maxProcessor
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_cont_R_+3A_rxy">rxy</code></td>
<td>
<p>function to generate a list with data sets x, y and (optional) vals, weights</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_xparam">xparam</code></td>
<td>
<p>first argument passed to rxy</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_yparam">yparam</code></td>
<td>
<p>second argument passed to rxy</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_ts">TS</code></td>
<td>
<p>test statistic</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_typets">typeTS</code></td>
<td>
<p>which format has TS?</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_tsextra">TSextra</code></td>
<td>
<p>list of items passed TS</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_b">B</code></td>
<td>
<p>= 1000 number of simulation runs</p>
</td></tr>
<tr><td><code id="power_cont_R_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>maximum number of cores to use. If maxProcessor=1 no parallel computing is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of power values.
</p>

<hr>
<h2 id='power_disc'>Find the power of various continuous tests via permutation.</h2><span id='topic+power_disc'></span>

<h3>Description</h3>

<p>Find the power of various continuous tests via permutation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_disc(
  rxy,
  xparam,
  yparam,
  TS,
  typeTS,
  TSextra,
  samplingmethod = 1L,
  B = 1000L
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_disc_+3A_rxy">rxy</code></td>
<td>
<p>a function that generates x and y data.</p>
</td></tr>
<tr><td><code id="power_disc_+3A_xparam">xparam</code></td>
<td>
<p>arguments for r1.</p>
</td></tr>
<tr><td><code id="power_disc_+3A_yparam">yparam</code></td>
<td>
<p>arguments for r2.</p>
</td></tr>
<tr><td><code id="power_disc_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistics for non-chi-square tests</p>
</td></tr>
<tr><td><code id="power_disc_+3A_typets">typeTS</code></td>
<td>
<p>indicator for type of test statistics</p>
</td></tr>
<tr><td><code id="power_disc_+3A_tsextra">TSextra</code></td>
<td>
<p>additional info passed to TS, if necessary</p>
</td></tr>
<tr><td><code id="power_disc_+3A_samplingmethod">samplingmethod</code></td>
<td>
<p>=1, 1 for independence sampling, 2 for MCMC</p>
</td></tr>
<tr><td><code id="power_disc_+3A_b">B</code></td>
<td>
<p>=1000 number of simulation runs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list values of test statistics
</p>

<hr>
<h2 id='power_disc_R'>Find the power of built-in continuous two sample tests using Rcpp and parallel computing.</h2><span id='topic+power_disc_R'></span>

<h3>Description</h3>

<p>Find the power of built-in continuous two sample tests using Rcpp and parallel computing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_disc_R(
  rxy,
  xparam,
  yparam,
  TS,
  typeTS,
  TSextra,
  alpha = 0.05,
  samplingmethod = 1,
  B = 1000,
  maxProcessor
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_disc_R_+3A_rxy">rxy</code></td>
<td>
<p>function to generate a list with data sets x, y and (optional) vals, weights</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_xparam">xparam</code></td>
<td>
<p>first argument passed to rxy</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_yparam">yparam</code></td>
<td>
<p>second argument passed to rxy</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_ts">TS</code></td>
<td>
<p>test statistic</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_typets">typeTS</code></td>
<td>
<p>which format has TS?</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_tsextra">TSextra</code></td>
<td>
<p>list of items passed TS</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_samplingmethod">samplingmethod</code></td>
<td>
<p>=independence or MCMC in discrete data case</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_b">B</code></td>
<td>
<p>= 1000 number of simulation runs</p>
</td></tr>
<tr><td><code id="power_disc_R_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>maximum number of cores to use. If maxProcessor=1 no parallel computing is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of power values.
</p>

<hr>
<h2 id='power_newtest'>This function estimates the power of test routines that calculate p value(s)</h2><span id='topic+power_newtest'></span>

<h3>Description</h3>

<p>This function estimates the power of test routines that calculate p value(s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_newtest(TS, f, param_alt, TSextra, alpha = 0.05, B = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power_newtest_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistics.</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_f">f</code></td>
<td>
<p>routine that generates data.</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_param_alt">param_alt</code></td>
<td>
<p>values of parameter under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_tsextra">TSextra</code></td>
<td>
<p>list passed to TS.</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_alpha">alpha</code></td>
<td>
<p>=0.05  type I error.</p>
</td></tr>
<tr><td><code id="power_newtest_+3A_b">B</code></td>
<td>
<p>= 1000 number of simulation runs to estimate the power.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of power values
</p>

<hr>
<h2 id='power_studies_results'>power_studies_results</h2><span id='topic+power_studies_results'></span>

<h3>Description</h3>

<p>the results of the included power studies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_studies_results
</code></pre>


<h3>Format</h3>



<h4>'power_studies_results'</h4>

<p>A list of matrices with powers
</p>


<hr>
<h2 id='pvaluecdf'>pvaluecdf</h2><span id='topic+pvaluecdf'></span>

<h3>Description</h3>

<p>data to draw a graph in vignette
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pvaluecdf
</code></pre>


<h3>Format</h3>



<h4>'pvaluecdf'</h4>

<p>A matrix
</p>


<hr>
<h2 id='repC'>cpp version of R routine rep</h2><span id='topic+repC'></span>

<h3>Description</h3>

<p>cpp version of R routine rep
</p>


<h3>Usage</h3>

<pre><code class='language-R'>repC(x, times)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="repC_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="repC_+3A_times">times</code></td>
<td>
<p>integer vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector
</p>

<hr>
<h2 id='run_shiny'>Runs the shiny app associated with R2sample package</h2><span id='topic+run_shiny'></span>

<h3>Description</h3>

<p>Runs the shiny app associated with R2sample package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_shiny()
</code></pre>


<h3>Value</h3>

<p>No return value, called for side effect of opening a shiny app
</p>

<hr>
<h2 id='run.studies'>This function runs the case studies included in the package</h2><span id='topic+run.studies'></span>

<h3>Description</h3>

<p>This function runs the case studies included in the package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run.studies(
  TS,
  study,
  TSextra,
  With.p.value = FALSE,
  BasicComparison = TRUE,
  nsample = 500,
  alpha = 0.05,
  param_alt,
  maxProcessor,
  B = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run.studies_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistics.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_study">study</code></td>
<td>
<p>either the name of the study, or its number. If missing all the studies are run.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_tsextra">TSextra</code></td>
<td>
<p>list passed to TS.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_with.p.value">With.p.value</code></td>
<td>
<p>=FALSE does user supplied routine return p values?</p>
</td></tr>
<tr><td><code id="run.studies_+3A_basiccomparison">BasicComparison</code></td>
<td>
<p>=TRUE if true compares tests on one default value of parameter of the alternative distribution.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_nsample">nsample</code></td>
<td>
<p>= 500, desired sample size.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_alpha">alpha</code></td>
<td>
<p>=0.05  type I error</p>
</td></tr>
<tr><td><code id="run.studies_+3A_param_alt">param_alt</code></td>
<td>
<p>(list of) values of parameter under the alternative hypothesis. If missing included values are used.</p>
</td></tr>
<tr><td><code id="run.studies_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>number of cores to use for parallel programming</p>
</td></tr>
<tr><td><code id="run.studies_+3A_b">B</code></td>
<td>
<p>= 1000</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A (list of ) matrices of p.values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The new test is a simple chisquare test:
chitest = function(x, y, TSextra) {
   nbins=TSextra$nbins
   nx=length(x);ny=length(y);n=nx+ny
   xy=c(x,y)
   bins=quantile(xy, (0:nbins)/nbins)
   Ox=hist(x, bins, plot=FALSE)$counts
   Oy=hist(y, bins, plot=FALSE)$counts
   tmp=sqrt(sum(Ox)/sum(Oy))
   chi = sum((Ox/tmp-Oy*tmp)^2/(Ox+Oy))
   pval=1-pchisq(chi, nbins-1)
   out=ifelse(TSextra$statistic,chi,pval)
   names(out)="ChiSquare"
   out
}
TSextra=list(nbins=5,statistic=FALSE) # Use 5 bins and calculate p values
run.studies(chitest,TSextra=TSextra, With.p.value=TRUE, B=100)
</code></pre>

<hr>
<h2 id='signif.digits'>This function does some rounding to nice numbers</h2><span id='topic+signif.digits'></span>

<h3>Description</h3>

<p>This function does some rounding to nice numbers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'digits'
signif(x, d = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signif.digits_+3A_x">x</code></td>
<td>
<p>a list of two vectors</p>
</td></tr>
<tr><td><code id="signif.digits_+3A_d">d</code></td>
<td>
<p>=4 number of digits to round to</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with rounded vectors
</p>

<hr>
<h2 id='timecheck'>test function</h2><span id='topic+timecheck'></span>

<h3>Description</h3>

<p>test function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timecheck(dta, TS, typeTS, TSextra)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="timecheck_+3A_dta">dta</code></td>
<td>
<p>data set</p>
</td></tr>
<tr><td><code id="timecheck_+3A_ts">TS</code></td>
<td>
<p>test statistics</p>
</td></tr>
<tr><td><code id="timecheck_+3A_typets">typeTS</code></td>
<td>
<p>format of TS</p>
</td></tr>
<tr><td><code id="timecheck_+3A_tsextra">TSextra</code></td>
<td>
<p>additional info TS</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Mean computation time
</p>

<hr>
<h2 id='ts_C'>This function calculates the test statistics for continuous data</h2><span id='topic+ts_C'></span>

<h3>Description</h3>

<p>This function calculates the test statistics for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts_C(typeTS, x, y, TS, TSextra, wx, wy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ts_C_+3A_typets">typeTS</code></td>
<td>
<p>format of TS</p>
</td></tr>
<tr><td><code id="ts_C_+3A_x">x</code></td>
<td>
<p>continuous data set</p>
</td></tr>
<tr><td><code id="ts_C_+3A_y">y</code></td>
<td>
<p>continuous data set</p>
</td></tr>
<tr><td><code id="ts_C_+3A_ts">TS</code></td>
<td>
<p>routine</p>
</td></tr>
<tr><td><code id="ts_C_+3A_tsextra">TSextra</code></td>
<td>
<p>list passed to TS function</p>
</td></tr>
<tr><td><code id="ts_C_+3A_wx">wx</code></td>
<td>
<p>weights for x</p>
</td></tr>
<tr><td><code id="ts_C_+3A_wy">wy</code></td>
<td>
<p>weights for y</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numbers
</p>

<hr>
<h2 id='TS_cont'>find test statistics for continuous data</h2><span id='topic+TS_cont'></span>

<h3>Description</h3>

<p>find test statistics for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_cont(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TS_cont_+3A_x">x</code></td>
<td>
<p>first continuous data set</p>
</td></tr>
<tr><td><code id="TS_cont_+3A_y">y</code></td>
<td>
<p>second continuous data set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of test statistics
</p>

<hr>
<h2 id='ts_D'>This function calculates the test statistics for discrete data</h2><span id='topic+ts_D'></span>

<h3>Description</h3>

<p>This function calculates the test statistics for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts_D(typeTS, x, y, vals, TS, TSextra, adw)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ts_D_+3A_typets">typeTS</code></td>
<td>
<p>format of TS</p>
</td></tr>
<tr><td><code id="ts_D_+3A_x">x</code></td>
<td>
<p>discrete data set (counts)</p>
</td></tr>
<tr><td><code id="ts_D_+3A_y">y</code></td>
<td>
<p>discrete data set (counts)</p>
</td></tr>
<tr><td><code id="ts_D_+3A_vals">vals</code></td>
<td>
<p>values of discrete RV</p>
</td></tr>
<tr><td><code id="ts_D_+3A_ts">TS</code></td>
<td>
<p>routine</p>
</td></tr>
<tr><td><code id="ts_D_+3A_tsextra">TSextra</code></td>
<td>
<p>list passed to TS function</p>
</td></tr>
<tr><td><code id="ts_D_+3A_adw">adw</code></td>
<td>
<p>vector of weights for Anderson-Darling test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numbers
</p>

<hr>
<h2 id='TS_disc'>find test statistics for discrete data</h2><span id='topic+TS_disc'></span>

<h3>Description</h3>

<p>find test statistics for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_disc(x, y, vals, ADweights = as.numeric(c(2)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TS_disc_+3A_x">x</code></td>
<td>
<p>integer vector of data set 1</p>
</td></tr>
<tr><td><code id="TS_disc_+3A_y">y</code></td>
<td>
<p>integer vector of data set 2</p>
</td></tr>
<tr><td><code id="TS_disc_+3A_vals">vals</code></td>
<td>
<p>numeric vector of values of discrete data set</p>
</td></tr>
<tr><td><code id="TS_disc_+3A_adweights">ADweights</code></td>
<td>
<p>A vector of weights for AD method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of test statistics
</p>

<hr>
<h2 id='TSw_cont'>find test statistics for continuous data with weights</h2><span id='topic+TSw_cont'></span>

<h3>Description</h3>

<p>find test statistics for continuous data with weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TSw_cont(x, y, wx, wy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TSw_cont_+3A_x">x</code></td>
<td>
<p>first continuous data set</p>
</td></tr>
<tr><td><code id="TSw_cont_+3A_y">y</code></td>
<td>
<p>second continuous data set</p>
</td></tr>
<tr><td><code id="TSw_cont_+3A_wx">wx</code></td>
<td>
<p>weights of x</p>
</td></tr>
<tr><td><code id="TSw_cont_+3A_wy">wy</code></td>
<td>
<p>weights of y</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of test statistics
</p>

<hr>
<h2 id='TSw_disc'>find test statistics for discrete data</h2><span id='topic+TSw_disc'></span>

<h3>Description</h3>

<p>find test statistics for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TSw_disc(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TSw_disc_+3A_x">x</code></td>
<td>
<p>vector of weights data set 1</p>
</td></tr>
<tr><td><code id="TSw_disc_+3A_y">y</code></td>
<td>
<p>vector of weights data set 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of test statistics
</p>

<hr>
<h2 id='twosample_power'>Find the power of various two sample tests using Rcpp and parallel computing.</h2><span id='topic+twosample_power'></span>

<h3>Description</h3>

<p>Find the power of various two sample tests using Rcpp and parallel computing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twosample_power(
  f,
  ...,
  TS,
  TSextra,
  alpha = 0.05,
  B = 1000,
  nbins = c(50, 10),
  minexpcount = 5,
  UseLargeSample,
  samplingmethod = "independence",
  maxProcessor
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twosample_power_+3A_f">f</code></td>
<td>
<p>function to generate a list with data sets x, y and (optional) vals, weights</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_...">...</code></td>
<td>
<p>additional arguments passed to f, up to 2</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistics for non-chi-square tests</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_tsextra">TSextra</code></td>
<td>
<p>additional info passed to TS, if necessary</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_b">B</code></td>
<td>
<p>=1000, number of simulation runs.</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_nbins">nbins</code></td>
<td>
<p>=c(50,10), number of bins for chi large and chi small.</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5 minimum required count for chi square tests</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_uselargesample">UseLargeSample</code></td>
<td>
<p>should p values be found via large sample theory if n,m&gt;10000?</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_samplingmethod">samplingmethod</code></td>
<td>
<p>=independence or MCMC in discrete data case</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>maximum number of cores to use. If maxProcessor=1 no parallel computing is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of power values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> f=function(mu) list(x=rnorm(25), y=rnorm(25, mu))
 twosample_power(f, mu=c(0,2), B=100, maxProcessor = 1)
 f=function(n, p) list(x=table(sample(1:5, size=1000, replace=TRUE)), 
       y=table(sample(1:5, size=n, replace=TRUE, 
       prob=c(1, 1, 1, 1, p))), vals=1:5)
 twosample_power(f, n=c(1000, 2000), p=c(1, 1.5), B=100, maxProcessor = 1)
</code></pre>

<hr>
<h2 id='twosample_test'>This function runs a number of two sample tests using Rcpp and parallel computing.</h2><span id='topic+twosample_test'></span>

<h3>Description</h3>

<p>This function runs a number of two sample tests using Rcpp and parallel computing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twosample_test(
  x,
  y,
  vals = NA,
  TS,
  TSextra,
  wx = rep(1, length(x)),
  wy = rep(1, length(y)),
  B = 5000,
  nbins = c(50, 10),
  minexpcount = 5,
  maxProcessor,
  UseLargeSample,
  samplingmethod = "independence",
  doMethods = "all"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twosample_test_+3A_x">x</code></td>
<td>
<p>a vector of numbers if data is continuous or of counts  if data is discrete.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_y">y</code></td>
<td>
<p>a vector of numbers if data is continuous or of counts  if data is discrete.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_vals">vals</code></td>
<td>
<p>=NA, a vector of numbers, the values of a discrete random variable. NA if data is continuous data.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistics for non-chi-square tests</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_tsextra">TSextra</code></td>
<td>
<p>additional info passed to TS, if necessary</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_wx">wx</code></td>
<td>
<p>A numeric vector of weights of x.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_wy">wy</code></td>
<td>
<p>A numeric vector of weights of y.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_b">B</code></td>
<td>
<p>=5000, number of simulation runs for permutation test</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_nbins">nbins</code></td>
<td>
<p>=c(50,10), number of bins for chi square tests.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_minexpcount">minexpcount</code></td>
<td>
<p>=5, minimum required expected counts for chi-square tests.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>maximum number of cores to use. If missing (the default) no parallel processing is used.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_uselargesample">UseLargeSample</code></td>
<td>
<p>should p values be found via large sample theory if n,m&gt;10000?</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_samplingmethod">samplingmethod</code></td>
<td>
<p>=&quot;independence&quot; or &quot;MCMC&quot; for discrete data</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_domethods">doMethods</code></td>
<td>
<p>=&quot;all&quot; Which methods should be included? If missing all methods are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two numeric vectors, the test statistics and the p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> R2sample::twosample_test(rnorm(1000), rt(1000, 4), B=1000)
 myTS=function(x,y) {z=c(mean(x)-mean(y),sd(x)-sd(y));names(z)=c("M","S");z}
 R2sample::twosample_test(rnorm(1000), rt(1000, 4), TS=myTS, B=1000)
 vals=1:5
 x=table(sample(vals, size=100, replace=TRUE))
 y=table(sample(vals, size=100, replace=TRUE, prob=c(1,1,3,1,1)))
 R2sample::twosample_test(x, y, vals)
</code></pre>

<hr>
<h2 id='twosample_test_adjusted_pvalue'>This function runs a number of two sample tests using Rcpp and parallel computing and then finds the correct p value for the combined tests.</h2><span id='topic+twosample_test_adjusted_pvalue'></span>

<h3>Description</h3>

<p>This function runs a number of two sample tests using Rcpp and parallel computing and then finds the correct p value for the combined tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twosample_test_adjusted_pvalue(
  x,
  y,
  vals = NA,
  TS,
  TSextra,
  wx = rep(1, length(x)),
  wy = rep(1, length(y)),
  B = c(5000, 1000),
  nbins = c(50, 10),
  minexpcount = 5,
  samplingmethod = "independence",
  doMethods
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_x">x</code></td>
<td>
<p>a vector of numbers if data is continuous or of counts  if data is discrete.</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_y">y</code></td>
<td>
<p>a vector of numbers if data is continuous or of counts  if data is discrete.</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_vals">vals</code></td>
<td>
<p>=NA, a vector of numbers, the values of a discrete random variable. NA if data is continuous data.</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_ts">TS</code></td>
<td>
<p>routine to calculate test statistics for non-chi-square tests</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_tsextra">TSextra</code></td>
<td>
<p>additional info passed to TS, if necessary</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_wx">wx</code></td>
<td>
<p>A numeric vector of weights of x.</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_wy">wy</code></td>
<td>
<p>A numeric vector of weights of y.</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_b">B</code></td>
<td>
<p>=c(5000, 1000), number of simulation runs for permutation test</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_nbins">nbins</code></td>
<td>
<p>=c(50,10), number of bins for chi square tests.</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_minexpcount">minexpcount</code></td>
<td>
<p>= 5, minimum required expected counts for chi-square tests</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_samplingmethod">samplingmethod</code></td>
<td>
<p>=&quot;independence&quot; or &quot;MCMC&quot; for discrete data</p>
</td></tr>
<tr><td><code id="twosample_test_adjusted_pvalue_+3A_domethods">doMethods</code></td>
<td>
<p>Which methods should be included?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two numeric vectors, the test statistics and the p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> x=rnorm(100)
 y=rt(200, 4)
 R2sample::twosample_test_adjusted_pvalue(x, y, B=c(500, 500))
 vals=1:5
 x=table(c(1:5, sample(1:5, size=100, replace=TRUE)))-1
 y=table(c(1:5, sample(1:5, size=100, replace=TRUE, prob=c(1,1,3,1,1))))-1
 R2sample::twosample_test_adjusted_pvalue(x, y, vals, B=c(500, 500))
</code></pre>

<hr>
<h2 id='wbincounter'>Find counts and/or sum of weights in bins. Useful for power calculations. Replaces hist command from R.</h2><span id='topic+wbincounter'></span>

<h3>Description</h3>

<p>Find counts and/or sum of weights in bins. Useful for power calculations. Replaces hist command from R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wbincounter(x, bins, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wbincounter_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="wbincounter_+3A_bins">bins</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="wbincounter_+3A_w">w</code></td>
<td>
<p>numeric vector of weights</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sum of weights in bins
</p>

<hr>
<h2 id='weights'>find weights for several statistics for discrete data</h2><span id='topic+weights'></span>

<h3>Description</h3>

<p>find weights for several statistics for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weights(dta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weights_+3A_dta">dta</code></td>
<td>
<p>A list with vectors x, y and vals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of weights
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
