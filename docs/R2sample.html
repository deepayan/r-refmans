<!DOCTYPE html><html><head><title>Help for package R2sample</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {R2sample}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bincounter_cpp'><p>count occurances in bins. Useful for power calculations. Replaces hist command from R.</p></a></li>
<li><a href='#chi_test_cont_cpp'><p>run chi square test for continuous data.</p></a></li>
<li><a href='#chi_test_disc_cpp'><p>run chi square test for discrete data.</p></a></li>
<li><a href='#perm_test_cpp'><p>run permutation test.</p></a></li>
<li><a href='#permute_cont_cpp'><p>permute continuous data</p></a></li>
<li><a href='#permute_disc_cpp'><p>permute discrete data</p></a></li>
<li><a href='#plot_power'><p>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.</p></a></li>
<li><a href='#power_cpp'><p>Find the power of various tests via permutation.</p></a></li>
<li><a href='#rep_cpp'><p>cpp version of R routine rep</p></a></li>
<li><a href='#run_shiny'><p>Runs the shiny app associated with R2sample package</p></a></li>
<li><a href='#TS_cont_cpp'><p>find test statistics for continuous data</p></a></li>
<li><a href='#TS_disc_cpp'><p>find test statistics for discrete data</p></a></li>
<li><a href='#twosample_power'><p>Find the power of various two sample tests using Rcpp and parallel computing.</p></a></li>
<li><a href='#twosample_test'><p>This function runs a number of two sample tests using Rcpp and parallel computing.</p></a></li>
<li><a href='#weights_cpp'><p>find weights for several statistics for discrete data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Two Sample Problem Routines using Permutation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>The routine twosample_test() in this package runs the
    two sample test using various test statistic. The p values are
    found via permutation. The routine twosample_power() allows the
    calculation of the power in various cases, and plot_power()
    draws the corresponding power graphs. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, parallel, shiny, ggplot2, microbenchmark</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-23 15:01:20 UTC; Wolfgang</td>
</tr>
<tr>
<td>Author:</td>
<td>Wolfgang Rolke <a href="https://orcid.org/0000-0002-3514-726X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wolfgang Rolke &lt;wolfgang.rolke@upr.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-23 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bincounter_cpp'>count occurances in bins. Useful for power calculations. Replaces hist command from R.</h2><span id='topic+bincounter_cpp'></span>

<h3>Description</h3>

<p>count occurances in bins. Useful for power calculations. Replaces hist command from R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bincounter_cpp(x, bins)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bincounter_cpp_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="bincounter_cpp_+3A_bins">bins</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Integer vector of counts
</p>

<hr>
<h2 id='chi_test_cont_cpp'>run chi square test for continuous data.</h2><span id='topic+chi_test_cont_cpp'></span>

<h3>Description</h3>

<p>run chi square test for continuous data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_test_cont_cpp(dta, nbins = as.integer(c(100, 10)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi_test_cont_cpp_+3A_dta">dta</code></td>
<td>
<p>A list of numeric vectors.</p>
</td></tr>
<tr><td><code id="chi_test_cont_cpp_+3A_nbins">nbins</code></td>
<td>
<p>A vector of length 2 of bin lengths.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with test statistics and p values
</p>

<hr>
<h2 id='chi_test_disc_cpp'>run chi square test for discrete data.</h2><span id='topic+chi_test_disc_cpp'></span>

<h3>Description</h3>

<p>run chi square test for discrete data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi_test_disc_cpp(dta, nbins = as.integer(c(100, 10)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi_test_disc_cpp_+3A_dta">dta</code></td>
<td>
<p>A list of numeric vectors.</p>
</td></tr>
<tr><td><code id="chi_test_disc_cpp_+3A_nbins">nbins</code></td>
<td>
<p>Integer vector of length 2 with number of bins.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with test statistics, p values and degrees of freedom
</p>

<hr>
<h2 id='perm_test_cpp'>run permutation test.</h2><span id='topic+perm_test_cpp'></span>

<h3>Description</h3>

<p>run permutation test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm_test_cpp(
  x,
  y,
  vals = 0,
  nbins = as.integer(c(100, 10)),
  B = 5000L,
  doMethod = as.character(c("chi large", "chi small", "t test", "KS", "Kuiper", "CvM",
    "AD", "LR", "ZA", "ZK", "ZC", "Wassp1"))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm_test_cpp_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="perm_test_cpp_+3A_y">y</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="perm_test_cpp_+3A_vals">vals</code></td>
<td>
<p>A numeric vector. Indicates discrete data.</p>
</td></tr>
<tr><td><code id="perm_test_cpp_+3A_nbins">nbins</code></td>
<td>
<p>Two bin numbers for chi square  test.</p>
</td></tr>
<tr><td><code id="perm_test_cpp_+3A_b">B</code></td>
<td>
<p>Number of simulation runs.</p>
</td></tr>
<tr><td><code id="perm_test_cpp_+3A_domethod">doMethod</code></td>
<td>
<p>A character vector of methods to include.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with test statistics and p values
</p>

<hr>
<h2 id='permute_cont_cpp'>permute continuous data</h2><span id='topic+permute_cont_cpp'></span>

<h3>Description</h3>

<p>permute continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute_cont_cpp(dta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permute_cont_cpp_+3A_dta">dta</code></td>
<td>
<p>A list of numeric vectors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of permuted x and y vectors.
</p>

<hr>
<h2 id='permute_disc_cpp'>permute discrete data</h2><span id='topic+permute_disc_cpp'></span>

<h3>Description</h3>

<p>permute discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute_disc_cpp(dta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permute_disc_cpp_+3A_dta">dta</code></td>
<td>
<p>A list of numeric vectors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of permuted vectors
</p>

<hr>
<h2 id='plot_power'>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.</h2><span id='topic+plot_power'></span>

<h3>Description</h3>

<p>This function draws the power graph, with curves sorted by the mean power and smoothed for easier reading.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_power(pwr, xname = " ", Smooth = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_power_+3A_pwr">pwr</code></td>
<td>
<p>a matrix of power values, usually from the twosample_power command</p>
</td></tr>
<tr><td><code id="plot_power_+3A_xname">xname</code></td>
<td>
<p>Name of variable on x axis</p>
</td></tr>
<tr><td><code id="plot_power_+3A_smooth">Smooth</code></td>
<td>
<p>=TRUE lines are smoothed for easier reading</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plt, an object of class ggplot.
</p>

<hr>
<h2 id='power_cpp'>Find the power of various tests via permutation.</h2><span id='topic+power_cpp'></span>

<h3>Description</h3>

<p>Find the power of various tests via permutation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_cpp(
  rxy,
  nbins = as.integer(c(100, 10)),
  alpha = 0.05,
  B = 1000L,
  xparam = 0,
  yparam = 0,
  doMethod = as.character(c("chi large", "chi small", "t test", "KS", "Kuiper", "CvM",
    "AD", "LR", "ZA", "ZK", "ZC", "Wassp1"))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_cpp_+3A_rxy">rxy</code></td>
<td>
<p>a function that generates x and y data.</p>
</td></tr>
<tr><td><code id="power_cpp_+3A_nbins">nbins</code></td>
<td>
<p>Two bin numbers for chi square  test.</p>
</td></tr>
<tr><td><code id="power_cpp_+3A_alpha">alpha</code></td>
<td>
<p>A numeric constant</p>
</td></tr>
<tr><td><code id="power_cpp_+3A_b">B</code></td>
<td>
<p>Number of simulation runs.</p>
</td></tr>
<tr><td><code id="power_cpp_+3A_xparam">xparam</code></td>
<td>
<p>arguments for r1.</p>
</td></tr>
<tr><td><code id="power_cpp_+3A_yparam">yparam</code></td>
<td>
<p>arguments for r2.</p>
</td></tr>
<tr><td><code id="power_cpp_+3A_domethod">doMethod</code></td>
<td>
<p>A character vector of methods to include.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of powers
</p>

<hr>
<h2 id='rep_cpp'>cpp version of R routine rep</h2><span id='topic+rep_cpp'></span>

<h3>Description</h3>

<p>cpp version of R routine rep
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rep_cpp(x, times)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rep_cpp_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="rep_cpp_+3A_times">times</code></td>
<td>
<p>integer vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector
</p>

<hr>
<h2 id='run_shiny'>Runs the shiny app associated with R2sample package</h2><span id='topic+run_shiny'></span>

<h3>Description</h3>

<p>Runs the shiny app associated with R2sample package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_shiny()
</code></pre>


<h3>Value</h3>

<p>No return value, called for side effect of opening a shiny app
</p>

<hr>
<h2 id='TS_cont_cpp'>find test statistics for continuous data</h2><span id='topic+TS_cont_cpp'></span>

<h3>Description</h3>

<p>find test statistics for continuous data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_cont_cpp(
  dta,
  doMethod = as.character(c("chi large", "chi small", "t test", "KS", "Kuiper", "CvM",
    "AD", "LR", "ZA", "ZK", "ZC", "Wassp1"))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS_cont_cpp_+3A_dta">dta</code></td>
<td>
<p>A list</p>
</td></tr>
<tr><td><code id="TS_cont_cpp_+3A_domethod">doMethod</code></td>
<td>
<p>A character vector of methods to include.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of test statistics
</p>

<hr>
<h2 id='TS_disc_cpp'>find test statistics for discrete data</h2><span id='topic+TS_disc_cpp'></span>

<h3>Description</h3>

<p>find test statistics for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TS_disc_cpp(
  dta,
  ADweights,
  doMethod = as.character(c("chi large", "chi small", "t test", "KS", "Kuiper", "CvM",
    "AD", "LR", "ZA", "ZK", "ZC", "Wassp1"))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TS_disc_cpp_+3A_dta">dta</code></td>
<td>
<p>A list</p>
</td></tr>
<tr><td><code id="TS_disc_cpp_+3A_adweights">ADweights</code></td>
<td>
<p>A vector of weights for AD method</p>
</td></tr>
<tr><td><code id="TS_disc_cpp_+3A_domethod">doMethod</code></td>
<td>
<p>A character vector of methods to include.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of test statistics
</p>

<hr>
<h2 id='twosample_power'>Find the power of various two sample tests using Rcpp and parallel computing.</h2><span id='topic+twosample_power'></span>

<h3>Description</h3>

<p>Find the power of various two sample tests using Rcpp and parallel computing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twosample_power(
  f,
  ...,
  alpha = 0.05,
  B = 1000,
  nbins = c(100, 10),
  maxProcessor = 10,
  doMethod = "all"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twosample_power_+3A_f">f</code></td>
<td>
<p>function to generate a list with data sets x, y and (optional) vals</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_...">...</code></td>
<td>
<p>additional arguments passed to f</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_alpha">alpha</code></td>
<td>
<p>=0.05, the level of the hypothesis test</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_b">B</code></td>
<td>
<p>=1000, number of simulation runs for permutation test and power.</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_nbins">nbins</code></td>
<td>
<p>=c(100,10), number of bins for chi large and chi small.</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>=10, maximum number of cores to use. If maxProcessor=1 no parallel computing is used.</p>
</td></tr>
<tr><td><code id="twosample_power_+3A_domethod">doMethod</code></td>
<td>
<p>=&quot;all&quot;, which methods should be included?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of power values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> f=function(mu) list(x=rnorm(25), y=rnorm(25, mu))
 twosample_power(f, mu=c(0,2), B=100, maxProcessor = 1)
 f=function() list(x=table(sample(1:10, size=1000, replace=TRUE)), 
       y=table(sample(1:10, size=1200, replace=TRUE)), vals=1:10)
 twosample_power(f, B=100, maxProcessor = 1)
</code></pre>

<hr>
<h2 id='twosample_test'>This function runs a number of two sample tests using Rcpp and parallel computing.</h2><span id='topic+twosample_test'></span>

<h3>Description</h3>

<p>This function runs a number of two sample tests using Rcpp and parallel computing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twosample_test(
  x,
  y,
  vals,
  B = 5000,
  nbins = c(100, 10),
  maxProcessor = 10,
  discretize = FALSE,
  doMethod
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twosample_test_+3A_x">x</code></td>
<td>
<p>a vector of numbers if data is contiunous or of counts  if data is discrete.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_y">y</code></td>
<td>
<p>a vector of numbers if data is contiunous or of counts  if data is discrete.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_vals">vals</code></td>
<td>
<p>a vector of numbers, the values of a discrete random variable. If it is missing, continuous data is assumed.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_b">B</code></td>
<td>
<p>=5000, number of simulation runs for permutation test</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_nbins">nbins</code></td>
<td>
<p>=c(100,10), number of bins for chi square tests.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_maxprocessor">maxProcessor</code></td>
<td>
<p>=10, maximum number of cores to use. If maxProcessor=1 no parallel computing is used.</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_discretize">discretize</code></td>
<td>
<p>=FALSE. Should continuous data be binned?</p>
</td></tr>
<tr><td><code id="twosample_test_+3A_domethod">doMethod</code></td>
<td>
<p>Which methods should be included? If missing default methods are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two numeric vectors, the test statistics and the p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> twosample_test(rnorm(1000), rt(1000, 4), B=1000, maxProcessor = 1)
 vals=1:5
 x=table(sample(vals, size=100, replace=TRUE))
 y=table(sample(vals, size=100, replace=TRUE, prob=c(1,1,2,1,1)))
 twosample_test(x, y, vals, maxProcessor = 1)
</code></pre>

<hr>
<h2 id='weights_cpp'>find weights for several statistics for discrete data</h2><span id='topic+weights_cpp'></span>

<h3>Description</h3>

<p>find weights for several statistics for discrete data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weights_cpp(dta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weights_cpp_+3A_dta">dta</code></td>
<td>
<p>A list with vectors x, y and vals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of weights
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
