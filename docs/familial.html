<!DOCTYPE html><html><head><title>Help for package familial</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {familial}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bayes.boot'><p>Bayesian bootstrap</p></a></li>
<li><a href='#center.test'><p>Center test</p></a></li>
<li><a href='#fit.family'><p>Fit family</p></a></li>
<li><a href='#plot.center.test'><p>Plot function for <code>center.test</code> object</p></a></li>
<li><a href='#plot.fit.family'><p>Plot function for <code>fit.family</code> object</p></a></li>
<li><a href='#print.center.test'><p>Print function for <code>center.test</code> object</p></a></li>
<li><a href='#rudirichlet'><p>Uniform Dirichlet distribution</p></a></li>
<li><a href='#weighted'><p>Weighted statistics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Tests of Familial Hypotheses</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functionality for testing familial hypotheses. Supports testing centers 
    belonging to the Huber family. Testing is carried out using the Bayesian bootstrap. One- and 
    two-sample tests are supported, as are directional tests. Methods for visualizing output are 
    provided.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ryan-thompson/familial">https://github.com/ryan-thompson/familial</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ryan-thompson/familial/issues">https://github.com/ryan-thompson/familial/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel, ggplot2, DepthProc, matrixStats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, MASS</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-26 02:34:44 UTC; ryan</td>
</tr>
<tr>
<td>Author:</td>
<td>Ryan Thompson <a href="https://orcid.org/0000-0002-9002-0448"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ryan Thompson &lt;ryan.thompson1@unsw.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-26 04:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bayes.boot'>Bayesian bootstrap</h2><span id='topic+bayes.boot'></span>

<h3>Description</h3>

<p>Performs a Bayesian bootstrap for a statistic defined via a suitable function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes.boot(x, fun, nboot = 1000, cluster = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayes.boot_+3A_x">x</code></td>
<td>
<p>a numeric vector to be passed as the first argument to <code>fun</code></p>
</td></tr>
<tr><td><code id="bayes.boot_+3A_fun">fun</code></td>
<td>
<p>the function to bootstrap; must accept data <code>x</code> and weights <code>w</code> (in that
order), and return a data frame</p>
</td></tr>
<tr><td><code id="bayes.boot_+3A_nboot">nboot</code></td>
<td>
<p>the number of bootstraps to perform</p>
</td></tr>
<tr><td><code id="bayes.boot_+3A_cluster">cluster</code></td>
<td>
<p>an optional cluster for running bootstraps in parallel; must be set up using
<code>parallel::makeCluster</code></p>
</td></tr>
<tr><td><code id="bayes.boot_+3A_...">...</code></td>
<td>
<p>any other arguments for <code>fun</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>bayes.boot</code>; a data frame with the following columns:
</p>
<table>
<tr><td><code>boot.id</code></td>
<td>
<p>the bootstrap iteration index</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>any columns returned by <code>fun</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ryan Thompson &lt;ryan.thompson1@unsw.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)

boot &lt;- bayes.boot(MASS::galaxies, fun = fit.family, nboot = 100)
head(boot)
</code></pre>

<hr>
<h2 id='center.test'>Center test</h2><span id='topic+center.test'></span>

<h3>Description</h3>

<p>Performs a one- or two-sample test for a family of centers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>center.test(
  x,
  y = NULL,
  family = "huber",
  alternative = c("two.sided", "less", "greater"),
  mu = 0,
  paired = FALSE,
  nboot = 1000,
  loss = NULL,
  cluster = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="center.test_+3A_x">x</code></td>
<td>
<p>a numeric vector of data</p>
</td></tr>
<tr><td><code id="center.test_+3A_y">y</code></td>
<td>
<p>an optional numeric vector of data</p>
</td></tr>
<tr><td><code id="center.test_+3A_family">family</code></td>
<td>
<p>the family of centers; currently only allows 'huber' for Huber family</p>
</td></tr>
<tr><td><code id="center.test_+3A_alternative">alternative</code></td>
<td>
<p>the form of the alternative hypothesis; must be one of 'two.sided' (default),
'greater', or 'less'</p>
</td></tr>
<tr><td><code id="center.test_+3A_mu">mu</code></td>
<td>
<p>the null value of the center for a one-sample test, or the
null value of the center of differences for a paired two-sample test, or the null value of the
difference of centers for an independent two-sample test; can be an interval</p>
</td></tr>
<tr><td><code id="center.test_+3A_paired">paired</code></td>
<td>
<p>a logical indicating whether to treat <code>x</code> and <code>y</code> as paired</p>
</td></tr>
<tr><td><code id="center.test_+3A_nboot">nboot</code></td>
<td>
<p>the number of bootstraps to perform</p>
</td></tr>
<tr><td><code id="center.test_+3A_loss">loss</code></td>
<td>
<p>an optional c√ó2 matrix of losses incurred from an incorrect decision, where c is the
number of candidate choices (typically c=3: H0, H1, or indeterminate)</p>
</td></tr>
<tr><td><code id="center.test_+3A_cluster">cluster</code></td>
<td>
<p>an optional cluster for running bootstraps in parallel; must be set up using
<code>parallel::makeCluster</code></p>
</td></tr>
<tr><td><code id="center.test_+3A_...">...</code></td>
<td>
<p>any other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses the Bayesian bootstrap to compute posterior probabilities for the hypotheses
<code class="reqn">\mathrm{H}_0:\mu(\lambda)=\mu_0</code> for some <code class="reqn">\lambda\in\Lambda</code> vs.
<code class="reqn">\mathrm{H}_1:\mu(\lambda)\neq\mu_0</code> for all <code class="reqn">\lambda\in\Lambda</code>,
where <code class="reqn">\{\mu(\lambda):\lambda\in\Lambda\}</code> is a family of centers. <br />
The default loss matrix results in a decision whenever the posterior probability
for one of the hypotheses is greater than 0.95 and otherwise is indeterminate.
</p>


<h3>Value</h3>

<p>An object of class <code>center.test</code>; a list with the following components:
</p>
<table>
<tr><td><code>expected.loss</code></td>
<td>
<p>the expected loss, calculated by post-multiplying <code>loss</code> with
<code>prob</code></p>
</td></tr>
<tr><td><code>decision</code></td>
<td>
<p>the optimal decision given the expected loss</p>
</td></tr>
<tr><td><code>loss</code></td>
<td>
<p>the loss matrix</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>the estimated posterior probabilities of the null and alternative</p>
</td></tr>
<tr><td><code>boot</code></td>
<td>
<p>the bootstrap output from <code>bayes.boot</code></p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the <code>x</code> that was supplied</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <code>y</code> that was supplied</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the <code>mu</code> that was supplied</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the <code>family</code> that was supplied</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ryan Thompson &lt;ryan.thompson1@unsw.edu.au&gt;
</p>


<h3>References</h3>

<p>Thompson, R., Forbes, C. S., MacEachern, S. N., and Peruggia, M. (2023). 'Familial
inference: Tests for hypotheses on a family of centres'. arXiv:
<a href="https://arxiv.org/abs/2202.12540">2202.12540</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)

test &lt;- center.test(MASS::galaxies, mu = 21000, nboot = 100)
print(test)
plot(test)

cl &lt;- parallel::makeCluster(2)
test &lt;- center.test(MASS::galaxies, mu = 21000, nboot = 100, cluster = cl)
parallel::stopCluster(cl)
print(test)
</code></pre>

<hr>
<h2 id='fit.family'>Fit family</h2><span id='topic+fit.family'></span>

<h3>Description</h3>

<p>Fits a family of centers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.family(
  x,
  w = rep(1, length(x)),
  family = "huber",
  spread.fun = weighted.mad,
  eps = .Machine$double.eps
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.family_+3A_x">x</code></td>
<td>
<p>a numeric vector of data</p>
</td></tr>
<tr><td><code id="fit.family_+3A_w">w</code></td>
<td>
<p>a numeric vector of weights</p>
</td></tr>
<tr><td><code id="fit.family_+3A_family">family</code></td>
<td>
<p>the location family; currently only allows 'huber' for Huber family</p>
</td></tr>
<tr><td><code id="fit.family_+3A_spread.fun">spread.fun</code></td>
<td>
<p>a function used for the spread of <code>x</code>; must accept data <code>x</code> and
weights <code>w</code> (in that order), and return a numeric</p>
</td></tr>
<tr><td><code id="fit.family_+3A_eps">eps</code></td>
<td>
<p>a numerical tolerance parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>fit.family</code>; a data frame with the following columns:
</p>
<table>
<tr><td><code>mu</code></td>
<td>
<p>the fitted values</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>the thresholding parameter</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ryan Thompson &lt;ryan.thompson1@unsw.edu.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- fit.family(MASS::galaxies)
plot(fit)
</code></pre>

<hr>
<h2 id='plot.center.test'>Plot function for <code>center.test</code> object</h2><span id='topic+plot.center.test'></span>

<h3>Description</h3>

<p>Plot the posterior distribution for the family of centers using a functional box plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'center.test'
plot(x, band = c(0.5, 0.75, 0.95), ninterp = 25, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.center.test_+3A_x">x</code></td>
<td>
<p>an object of class <code>center.test</code></p>
</td></tr>
<tr><td><code id="plot.center.test_+3A_band">band</code></td>
<td>
<p>a vector of band limits for the functional box plot</p>
</td></tr>
<tr><td><code id="plot.center.test_+3A_ninterp">ninterp</code></td>
<td>
<p>the number of interpolation points for the functional box plot; more points lead
to finer resolution of the plot at the expense of additional computation</p>
</td></tr>
<tr><td><code id="plot.center.test_+3A_...">...</code></td>
<td>
<p>any other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the posterior distribution.
</p>


<h3>Author(s)</h3>

<p>Ryan Thompson &lt;ryan.thompson@monash.edu&gt;
</p>

<hr>
<h2 id='plot.fit.family'>Plot function for <code>fit.family</code> object</h2><span id='topic+plot.fit.family'></span>

<h3>Description</h3>

<p>Plot a fitted family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fit.family'
plot(x, y = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fit.family_+3A_x">x</code></td>
<td>
<p>an object of class <code>fit.family</code></p>
</td></tr>
<tr><td><code id="plot.fit.family_+3A_y">y</code></td>
<td>
<p>an object of class <code>fit.family</code></p>
</td></tr>
<tr><td><code id="plot.fit.family_+3A_...">...</code></td>
<td>
<p>any other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the fitted family.
</p>


<h3>Author(s)</h3>

<p>Ryan Thompson &lt;ryan.thompson@monash.edu&gt;
</p>

<hr>
<h2 id='print.center.test'>Print function for <code>center.test</code> object</h2><span id='topic+print.center.test'></span>

<h3>Description</h3>

<p>Print objects of class <code>center.test</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'center.test'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.center.test_+3A_x">x</code></td>
<td>
<p>an object of class <code>center.test</code></p>
</td></tr>
<tr><td><code id="print.center.test_+3A_...">...</code></td>
<td>
<p>any other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The argument <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Ryan Thompson &lt;ryan.thompson@monash.edu&gt;
</p>

<hr>
<h2 id='rudirichlet'>Uniform Dirichlet distribution</h2><span id='topic+rudirichlet'></span>

<h3>Description</h3>

<p>Random number generation for the uniform Dirichlet distribution (having all
concentration parameters set to one).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rudirichlet(n, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rudirichlet_+3A_n">n</code></td>
<td>
<p>the number of observations</p>
</td></tr>
<tr><td><code id="rudirichlet_+3A_d">d</code></td>
<td>
<p>the number of dimensions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix; each row is a random draw and each column is a dimension.
</p>


<h3>Author(s)</h3>

<p>Ryan Thompson &lt;ryan.thompson1@unsw.edu.au&gt;
</p>

<hr>
<h2 id='weighted'>Weighted statistics</h2><span id='topic+weighted'></span><span id='topic+weighted.median'></span><span id='topic+weighted.mad'></span>

<h3>Description</h3>

<p>Assorted weighted statistics unavailable in base R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weighted.median(x, w)

weighted.mad(x, w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weighted_+3A_x">x</code></td>
<td>
<p>a numeric vector of data</p>
</td></tr>
<tr><td><code id="weighted_+3A_w">w</code></td>
<td>
<p>a numeric vector of weights</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A length-one numeric vector.
</p>


<h3>Author(s)</h3>

<p>Ryan Thompson &lt;ryan.thompson1@unsw.edu.au&gt;
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
