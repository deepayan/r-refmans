<!DOCTYPE html><html><head><title>Help for package Phase123</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Phase123}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AssignEffTox'><p>Determines the optimal dose to assign the next patient cohort.</p></a></li>
<li><a href='#EFFTOX'><p>Obtains estimated posterior probabilities of the four outcomes of (YE,YT) for each dose.</p></a></li>
<li><a href='#PieceMCMC'><p>Returns posterior distribution for key mixture model parameters</p></a></li>
<li><a href='#RandomEffTox'><p>Randomizes Eff-Tox dose proportional to posterior desireability scores.</p></a></li>
<li><a href='#Reoptimize'><p>Gives the Optimal Dose for enrolling next patient cohort.</p></a></li>
<li><a href='#Reoptimize1'><p>Gives the Optimal Dose for enrolling next patient cohort. Used in the SimPhase123 function.</p></a></li>
<li><a href='#ReturnMeanControl'><p>Gives true mean survival times for the control therapy.</p></a></li>
<li><a href='#ReturnMeansAgent'><p>Gives true mean survival times for doses considered of the experimental agent.</p></a></li>
<li><a href='#ReturnOCS'><p>Gives operating characteristics of phase 123 and conventional design.</p></a></li>
<li><a href='#RunAdaptiveEffToxTrial'><p>Simulates repitions of an Adaptive Eff-Tox Trial.</p></a></li>
<li><a href='#SimPhase123'><p>Simulates replications of the phase123 and phase 12-3 trials.</p></a></li>
<li><a href='#SimPhase3'><p>Performs one replication of phase 3 for the phase 123 design, given phase 12 data.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulating and Conducting Phase 123 Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-4-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew G Chapple</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew G Chapple &lt;achapp@lsuhsc.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains three simulation functions for implementing the entire Phase 123 trial and the separate Eff-Tox and Phase 3 portions of the trial, which may be beneficial for use on clusters. The functions AssignEffTox() and RandomizeEffTox() assign doses to patient cohorts during phase 12 and Reoptimize() determines the optimal dose to continue with during Phase 3. The functions ReturnMeansAgent() and ReturnMeanControl() gives the true mean survival for the agent doses and control and ReturnOCS() gives the operating characteristics of the design.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.9),survival, stats</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-25 17:27:40 UTC; Andrew</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-25 17:50:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='AssignEffTox'>Determines the optimal dose to assign the next patient cohort.</h2><span id='topic+AssignEffTox'></span>

<h3>Description</h3>

<p>This function returns the optimal acceptable dose number to assign the next patient cohort or stops the trial if no dose is deemed acceptable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AssignEffTox(YE, YT, Doses, Dose, DosesTried, Hypermeans, Hypervars,
  Contour, PiLim, ProbLim, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AssignEffTox_+3A_ye">YE</code></td>
<td>
<p>Vector containing observed efficacy indicators.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_yt">YT</code></td>
<td>
<p>Vector containing observed toxicity indicators.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_doses">Doses</code></td>
<td>
<p>Vector containing numbered Doses of patients in trial.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_dose">Dose</code></td>
<td>
<p>Vector containing the standardized doses considered.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_dosestried">DosesTried</code></td>
<td>
<p>Binary vector corresponding to which doses have been tried.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>Vector containing prior hypermeans of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_hypervars">Hypervars</code></td>
<td>
<p>Vector containing prior hypervariances of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_contour">Contour</code></td>
<td>
<p>Vector containing 4 entries used to make the desireability function. Contour[1] contains a desired toxicity probability given efficacy, Countour[2] contains a desired efficacy probability given toxicity, and (Contour[3],Contour[4]) is an equally desireable pair of efficacy and toxicity probabilities that are non-zero or one.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_pilim">PiLim</code></td>
<td>
<p>Vector of length two with PiLim[1] containing the acceptable lower limit on efficacy probability and PiLim[2] containing the acceptable upper limit on toxicity probability.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_problim">ProbLim</code></td>
<td>
<p>Vector of length two with ProbLim[1] containing the probability cutoff for acceptable efficacy probability and ProbLim[2] containing the probability cutoff for acceptable toxicity probability.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_b">B</code></td>
<td>
<p>Number of iterations to perform in the MCMC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The optimal dose level to administer the next patient cohort.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Doses, YE,YT
Doses= c(1,1,1,2,2,2,1,1,1,3,3,3,1,1,1,2,2,2)
YE = c(0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0)
YT=c(0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,0,0)
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
##Five doses, but only 3 tried so we have
DosesTried=c(1,1,1,0,0)
## Contour Vector
Contour = c(.35, .75,.7,.4)
##Hypermeans
Hypermeans = c(.022,3.45,0,-4.23,3.1,0)
Hypervars = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
Hypervars=Hypervars^2
##Acceptability Criteria
PiLim = c(.3,.4)
ProbLim=c(.1,.1)
##Number of iterations
B=2000
AssignEffTox(YE,YT, Doses, Dose, DosesTried, Hypermeans,  Hypervars, Contour, PiLim,  ProbLim, B )
</code></pre>

<hr>
<h2 id='EFFTOX'>Obtains estimated posterior probabilities of the four outcomes of (YE,YT) for each dose.</h2><span id='topic+EFFTOX'></span>

<h3>Description</h3>

<p>This function is used in Reoptimize, SimPhase123 and SimPhase3, here we estimate the mixture probabilities over the four outcomes for efficacy and toxicity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EFFTOX(YE, YT, Doses, Dose, Hypermeans, Hypervars, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EFFTOX_+3A_ye">YE</code></td>
<td>
<p>Vector containing observed efficacy indicators.</p>
</td></tr>
<tr><td><code id="EFFTOX_+3A_yt">YT</code></td>
<td>
<p>Vector containing observed toxicity indicators.</p>
</td></tr>
<tr><td><code id="EFFTOX_+3A_doses">Doses</code></td>
<td>
<p>Vector containing Standardized doses of patients in trial.</p>
</td></tr>
<tr><td><code id="EFFTOX_+3A_dose">Dose</code></td>
<td>
<p>Vector containing the standardized doses considered.</p>
</td></tr>
<tr><td><code id="EFFTOX_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>Vector containing prior hypermeans of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="EFFTOX_+3A_hypervars">Hypervars</code></td>
<td>
<p>Vector containing prior hypervariances of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="EFFTOX_+3A_b">B</code></td>
<td>
<p>Number of iterations to perform in the MCMC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The posterior probability matrix for the events (YE,YT) in each row corresponding to a dose level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Doses, YE,YT
Doses= c(1,1,1,2,2,2,1,1,1,3,3,3,1,1,1,2,2,2)
YE = c(0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0)
YT=c(0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,0,0)
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
Doses=Dose[Doses]
##Hypermeans
Hypermeans = c(.022,3.45,0,-4.23,3.1,0)
Hypervars = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
Hypervars=Hypervars^2
##Number of iterations
B=2000
EFFTOX(YE,YT, Doses, Dose, Hypermeans,  Hypervars, B )
</code></pre>

<hr>
<h2 id='PieceMCMC'>Returns posterior distribution for key mixture model parameters</h2><span id='topic+PieceMCMC'></span>

<h3>Description</h3>

<p>This function performs MCMC with Metropolis-Hastings-Green steps for the baseline hazard function and is used in the functions Reoptimize, SimPhase123 and SimPhase3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PieceMCMC(Y, I, YE, YT, Doses, Dose, B, prob, MaxObs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PieceMCMC_+3A_y">Y</code></td>
<td>
<p>Patient survival or followup times.</p>
</td></tr>
<tr><td><code id="PieceMCMC_+3A_i">I</code></td>
<td>
<p>Patient event indicators.</p>
</td></tr>
<tr><td><code id="PieceMCMC_+3A_ye">YE</code></td>
<td>
<p>Vector of indicators for patient efficacy.</p>
</td></tr>
<tr><td><code id="PieceMCMC_+3A_yt">YT</code></td>
<td>
<p>Vector of indicators for patient toxicity.</p>
</td></tr>
<tr><td><code id="PieceMCMC_+3A_doses">Doses</code></td>
<td>
<p>Vector of standardized doses given to patients.</p>
</td></tr>
<tr><td><code id="PieceMCMC_+3A_dose">Dose</code></td>
<td>
<p>Vector of standardized doses considered in trial.</p>
</td></tr>
<tr><td><code id="PieceMCMC_+3A_b">B</code></td>
<td>
<p>Number of iterations to perform in MCMC.</p>
</td></tr>
<tr><td><code id="PieceMCMC_+3A_prob">prob</code></td>
<td>
<p>length(Doses) X 4 matrix containing the estimated posterior probabilities for each dose and each (Efficacy, Toxicity) outcomes.</p>
</td></tr>
<tr><td><code id="PieceMCMC_+3A_maxobs">MaxObs</code></td>
<td>
<p>length(Doses) X 4 matrix containing the maximum observed survival time we want to evaluate the means to.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing a matrix of posterior means for each dose, regression coefficients in the cox models, locations of the split points, log hazard heights on each interval, and the number of intervals in the baseline hazard.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=100
Y=rexp(n,1)
I = rbinom(n,1,.9)
YE = rbinom(n,1,.5)
YT = rbinom(n,1,.5)
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
Doses = sample(1:5,n,replace=TRUE)
Doses=Dose[Doses]
B=2000
MaxObs = matrix(rep(0,length(Dose)*4),nrow=4)
prob=matrix(rep(0,length(Dose)*4),ncol=4)
prob=prob+1/4
MaxObs=MaxObs+max(Y)
G=PieceMCMC(Y,I,YE,YT,Doses,Dose,B,prob,MaxObs)
</code></pre>

<hr>
<h2 id='RandomEffTox'>Randomizes Eff-Tox dose proportional to posterior desireability scores.</h2><span id='topic+RandomEffTox'></span>

<h3>Description</h3>

<p>This function returns a random acceptable dose number to assign the next patient cohort or stops the trial if no dose is deemed acceptable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RandomEffTox(YE, YT, Doses, Dose, DosesTried, Hypermeans, Hypervars,
  Contour, PiLim, ProbLim, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RandomEffTox_+3A_ye">YE</code></td>
<td>
<p>Vector containing observed efficacy indicators.</p>
</td></tr>
<tr><td><code id="RandomEffTox_+3A_yt">YT</code></td>
<td>
<p>Vector containing observed toxicity indicators.</p>
</td></tr>
<tr><td><code id="RandomEffTox_+3A_doses">Doses</code></td>
<td>
<p>Vector containing numbered Doses of patients in trial.</p>
</td></tr>
<tr><td><code id="RandomEffTox_+3A_dose">Dose</code></td>
<td>
<p>Vector containing the standardized doses considered.</p>
</td></tr>
<tr><td><code id="RandomEffTox_+3A_dosestried">DosesTried</code></td>
<td>
<p>Binary vector corresponding to which doses have been tried.</p>
</td></tr>
<tr><td><code id="RandomEffTox_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>Vector containing prior hypermeans of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="RandomEffTox_+3A_hypervars">Hypervars</code></td>
<td>
<p>Vector containing prior hypervariances of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="RandomEffTox_+3A_contour">Contour</code></td>
<td>
<p>Vector containing 4 entries used to make the desireability function. Contour[1] contains a desired toxicity probability given efficacy, Countour[2] contains a desired efficacy probability given toxicity, and (Contour[3],Contour[4]) is an equally desireable pair of efficacy and toxicity probabilities that are non-zero or one.</p>
</td></tr>
<tr><td><code id="RandomEffTox_+3A_pilim">PiLim</code></td>
<td>
<p>Vector of length two with PiLim[1] containing the acceptable lower limit on efficacy probability and PiLim[2] containing the acceptable upper limit on toxicity probability.</p>
</td></tr>
<tr><td><code id="RandomEffTox_+3A_problim">ProbLim</code></td>
<td>
<p>Vector of length two with ProbLim[1] containing the probability cutoff for acceptable efficacy probability and ProbLim[2] containing the probability cutoff for acceptable toxicity probability.</p>
</td></tr>
<tr><td><code id="RandomEffTox_+3A_b">B</code></td>
<td>
<p>Number of iterations to perform in the MCMC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A random dose level to administer the next patient cohort.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Doses, YE,YT
Doses= c(1,1,1,2,2,2,1,1,1,3,3,3,1,1,1,2,2,2)
YE = c(0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0)
YT=c(0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,0,0)
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
##Five doses, but only 3 tried so we have
DosesTried=c(1,1,1,0,0)
## Contour Vector
Contour = c(.35, .75,.7,.4)
##Hypermeans
Hypermeans = c(.022,3.45,0,-4.23,3.1,0)
Hypervars = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
Hypervars=Hypervars^2
##Acceptability Criteria
PiLim = c(.3,.4)
ProbLim=c(.1,.1)
##Number of iterations
B=2000
RandomEffTox(YE,YT, Doses, Dose, DosesTried, Hypermeans,  Hypervars, Contour, PiLim,  ProbLim, B )
</code></pre>

<hr>
<h2 id='Reoptimize'>Gives the Optimal Dose for enrolling next patient cohort.</h2><span id='topic+Reoptimize'></span>

<h3>Description</h3>

<p>This function returns the optimal dose number to assign the next patient cohort or stops the trial if no dose is deemed acceptable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Reoptimize(Y, I, YE, YT, Doses, Dose, Hypermeans, Hypervars, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Reoptimize_+3A_y">Y</code></td>
<td>
<p>Vector containing observed patient survival or follow up times.</p>
</td></tr>
<tr><td><code id="Reoptimize_+3A_i">I</code></td>
<td>
<p>Vector indicating whether each patient experienced an exent.</p>
</td></tr>
<tr><td><code id="Reoptimize_+3A_ye">YE</code></td>
<td>
<p>Vector containing observed efficacy indicators.</p>
</td></tr>
<tr><td><code id="Reoptimize_+3A_yt">YT</code></td>
<td>
<p>Vector containing observed toxicity indicators.</p>
</td></tr>
<tr><td><code id="Reoptimize_+3A_doses">Doses</code></td>
<td>
<p>Vector containing standardized doses of patients in trial.</p>
</td></tr>
<tr><td><code id="Reoptimize_+3A_dose">Dose</code></td>
<td>
<p>Vector containing the standardized doses considered.</p>
</td></tr>
<tr><td><code id="Reoptimize_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>Vector containing prior hypermeans of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="Reoptimize_+3A_hypervars">Hypervars</code></td>
<td>
<p>Vector containing prior hypervariances of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="Reoptimize_+3A_b">B</code></td>
<td>
<p>Number of iterations to perform in the MCMC.</p>
</td></tr>
</table>


<h3>References</h3>

<p>[1] Chapple and Thall (2018).A Hybrid Phase I-II/III Clinical Trial Design Allowing Dose Re-Optimization in Phase III. Biometrics. In Press,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Doses, YE,YT
Doses= c(1,1,1,2,2,2,1,1,1,3,3,3,1,1,1,2,2,2)
YE = c(0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0)
YT=c(0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,0,0)
Y=rexp(length(YE))
I=rbinom(length(YE),1,.9)
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
##Hypermeans for Eff-Tox
Hypermeans = c(.022,3.45,0,-4.23,3.1,0)
Hypervars = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
Hypervars=Hypervars^2
###Number of iterations
B=20000
Reoptimize(Y,I,YE,YT, Doses, Dose, Hypermeans,  Hypervars,B)
</code></pre>

<hr>
<h2 id='Reoptimize1'>Gives the Optimal Dose for enrolling next patient cohort. Used in the SimPhase123 function.</h2><span id='topic+Reoptimize1'></span>

<h3>Description</h3>

<p>This function returns the optimal dose number to assign the next patient cohort or stops the trial if no dose is deemed acceptable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Reoptimize1(Y, I, YE, YT, Doses, Dose, Hypermeans, Hypervars, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Reoptimize1_+3A_y">Y</code></td>
<td>
<p>Vector containing observed patient survival or follow up times.</p>
</td></tr>
<tr><td><code id="Reoptimize1_+3A_i">I</code></td>
<td>
<p>Vector indicating whether each patient experienced an exent.</p>
</td></tr>
<tr><td><code id="Reoptimize1_+3A_ye">YE</code></td>
<td>
<p>Vector containing observed efficacy indicators.</p>
</td></tr>
<tr><td><code id="Reoptimize1_+3A_yt">YT</code></td>
<td>
<p>Vector containing observed toxicity indicators.</p>
</td></tr>
<tr><td><code id="Reoptimize1_+3A_doses">Doses</code></td>
<td>
<p>Vector containing standardized doses of patients in trial.</p>
</td></tr>
<tr><td><code id="Reoptimize1_+3A_dose">Dose</code></td>
<td>
<p>Vector containing the standardized doses considered.</p>
</td></tr>
<tr><td><code id="Reoptimize1_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>Vector containing prior hypermeans of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="Reoptimize1_+3A_hypervars">Hypervars</code></td>
<td>
<p>Vector containing prior hypervariances of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="Reoptimize1_+3A_b">B</code></td>
<td>
<p>Number of iterations to perform in the MCMC.</p>
</td></tr>
</table>


<h3>References</h3>

<p>[1] Chapple and Thall (2018).A Hybrid Phase I-II/III Clinical Trial Design Allowing Dose Re-Optimization in Phase III. Biometrics. In Press,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Doses, YE,YT
Doses= c(1,1,1,2,2,2,1,1,1,3,3,3,1,1,1,2,2,2)
YE = c(0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0)
YT=c(0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,0,0)
Y=rexp(length(YE))
I=rbinom(length(YE),1,.9)
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
##Hypermeans for Eff-Tox
Hypermeans = c(.022,3.45,0,-4.23,3.1,0)
Hypervars = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
Hypervars=Hypervars^2
###Number of iterations
B=20000
Reoptimize1(Y,I,YE,YT, Doses, Dose, Hypermeans,  Hypervars,B)
</code></pre>

<hr>
<h2 id='ReturnMeanControl'>Gives true mean survival times for the control therapy.</h2><span id='topic+ReturnMeanControl'></span>

<h3>Description</h3>

<p>Returns the mean survival times for the control given efficacy and toxicity dose probability vector, distribution family and linear relationship, effiacy, toxicity and survival.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ReturnMeanControl(ProbC, betaC, Family, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ReturnMeanControl_+3A_probc">ProbC</code></td>
<td>
<p>Probability of efficacy and toxicity for the control therapy.</p>
</td></tr>
<tr><td><code id="ReturnMeanControl_+3A_betac">betaC</code></td>
<td>
<p>Linear term for efficacy, toxicity and beta_0 for the control groupar term for efficacy, toxicity and beta_0 for the control group.</p>
</td></tr>
<tr><td><code id="ReturnMeanControl_+3A_family">Family</code></td>
<td>
<p>Time to event distribution. Options include: Exponential, Gamma, Weibull, Lognormal.</p>
</td></tr>
<tr><td><code id="ReturnMeanControl_+3A_alpha">alpha</code></td>
<td>
<p>Shape parameter or standard deviation of a lognormal distribution.</p>
</td></tr>
</table>


<h3>References</h3>

<p>[1] Chapple and Thall (2018).A Hybrid Phase I-II/III Clinical Trial Design Allowing Dose Re-Optimization in Phase III. Biometrics. In Press,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###Family of Distributions
Family="Gamma"
###Shape parameter
alpha=2
##True beta vector for efficacy, toxicity and intercept of the control treatment
betaC=c(.3,-.25,2.389)
##True efficacy and toxicity probability for control group
ProbC = c(.4,.15)
ReturnMeanControl(ProbC,betaC,Family,alpha)
</code></pre>

<hr>
<h2 id='ReturnMeansAgent'>Gives true mean survival times for doses considered of the experimental agent.</h2><span id='topic+ReturnMeansAgent'></span>

<h3>Description</h3>

<p>Returns the dose specific mean survival times for given efficacy and toxicity dose probability vector, distribution family and linear relationship between dose, effiacy, toxicity and survival.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ReturnMeansAgent(PE, PT, beta, Dose, Family, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ReturnMeansAgent_+3A_pe">PE</code></td>
<td>
<p>True efficacy dose-toxicity vector.</p>
</td></tr>
<tr><td><code id="ReturnMeansAgent_+3A_pt">PT</code></td>
<td>
<p>True toxicity dose-toxicity vector.</p>
</td></tr>
<tr><td><code id="ReturnMeansAgent_+3A_beta">beta</code></td>
<td>
<p>True linear term for the rate or mean parameter</p>
</td></tr>
<tr><td><code id="ReturnMeansAgent_+3A_dose">Dose</code></td>
<td>
<p>Vector of standardized doses considered in the trial.</p>
</td></tr>
<tr><td><code id="ReturnMeansAgent_+3A_family">Family</code></td>
<td>
<p>Time to event distribution. Options include: Exponential, Gamma, Weibull, Lognormal.</p>
</td></tr>
<tr><td><code id="ReturnMeansAgent_+3A_alpha">alpha</code></td>
<td>
<p>Shape parameter or standard deviation of a lognormal distribution.</p>
</td></tr>
</table>


<h3>References</h3>

<p>[1] Chapple and Thall (2018). A Hybrid Phase 12/3 Clinical Trial Design Allowing Dose Re-Optimization in Phase 3 Biometrics. Under Review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##True Efficacy and Toxicity Probabilities
PT = c(.1,.15,.25,.35,.5)
PE=c(.2,.4,.6,.65,.7)
##Dose Levels considered
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
###Family of Distributions
Family="Gamma"
###Shape parameter ## Doesn't matter for exponential distribution
alpha=2
###True Beta vector
beta = c(.75,-.5, .3, -.25,2.143)
ReturnMeansAgent(PE,PT,beta,Dose,Family,alpha)
</code></pre>

<hr>
<h2 id='ReturnOCS'>Gives operating characteristics of phase 123 and conventional design.</h2><span id='topic+ReturnOCS'></span>

<h3>Description</h3>

<p>Returns the probability of selecting the optimal dose, type I error, generalized power, probability of making the best decision, average number of patients treated and average trial duration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ReturnOCS(Results, Means, CMu, Delta, Hyp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ReturnOCS_+3A_results">Results</code></td>
<td>
<p>List containing phase 123 and conventional design results.</p>
</td></tr>
<tr><td><code id="ReturnOCS_+3A_means">Means</code></td>
<td>
<p>True mean survival times for experimental agents at each dose.</p>
</td></tr>
<tr><td><code id="ReturnOCS_+3A_cmu">CMu</code></td>
<td>
<p>Mean survival time for the control therapy.</p>
</td></tr>
<tr><td><code id="ReturnOCS_+3A_delta">Delta</code></td>
<td>
<p>Desired improvement in survival.</p>
</td></tr>
<tr><td><code id="ReturnOCS_+3A_hyp">Hyp</code></td>
<td>
<p>Null=0 or alternative=1 hypthesis</p>
</td></tr>
</table>


<h3>References</h3>

<p>[1] Chapple and Thall (2018). A Hybrid Phase 12/3 Clinical Trial Design Allowing Dose-Re-Optimization in Phase 3 Biometrics. Under Review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##True Mean Control
CMu=24
##True Means Agent
Means = c(27,32,38,42,28)
##Desired improvement in mean survival
Delta=12
##Random Trial results
 Results=as.list(c(0,0))
 nSims=5
 X=matrix(rep(NA,nSims*4),nrow=nSims)
 ##DoseSelected
 X[,1]=c(2,3,4,4,3)
 X[,2]=c(0,1,1,1,1)
 X[,3]=c(270,500,500,420,400)
 X[,4]=c(70,85,88,70,88)
 Results[[1]]=X
 X[,1]=c(2,3,5,4,2)
 X[,2]=c(0,1,0,1,0)
 X[,3]=c(270,500,450,420,415)
 X[,4]=c(70,82,80,70,79)
Results[[2]]=X
Hyp=1
ReturnOCS(Results,Means,CMu,Delta,Hyp)
</code></pre>

<hr>
<h2 id='RunAdaptiveEffToxTrial'>Simulates repitions of an Adaptive Eff-Tox Trial.</h2><span id='topic+RunAdaptiveEffToxTrial'></span>

<h3>Description</h3>

<p>This function simulates repititions of an adaptive Eff-Tox Trial and returns a list containing the optimal dose chosen
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RunAdaptiveEffToxTrial(DoseStart, Dose, Hypermeans, Hypervars, Contour,
  PiLim, ProbLim, cohort, NET, NF, B, nSims, PETrue, PTTrue)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_dosestart">DoseStart</code></td>
<td>
<p>Dose to start enrolling cohorts of patients at.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_dose">Dose</code></td>
<td>
<p>Vector containing the standardized doses considered.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>Vector containing prior hypermeans of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_hypervars">Hypervars</code></td>
<td>
<p>Vector containing prior hypervariances of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_contour">Contour</code></td>
<td>
<p>Vector containing 4 entries used to make the desireability function. Contour[1] contains a desired toxicity probability given efficacy, Countour[2] contains a desired efficacy probability given toxicity, and (Contour[3],Contour[4]) is an equally desireable pair of efficacy and toxicity probabilities that are non-zero or one.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_pilim">PiLim</code></td>
<td>
<p>Vector of length two with PiLim[1] containing the acceptable lower limit on efficacy probability and PiLim[2] containing the acceptable upper limit on toxicity probability.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_problim">ProbLim</code></td>
<td>
<p>Vector of length two with ProbLim[1] containing the probability cutoff for acceptable efficacy probability and ProbLim[2] containing the probability cutoff for acceptable toxicity probability.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_cohort">cohort</code></td>
<td>
<p>Size of each patient cohort.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_net">NET</code></td>
<td>
<p>Maximum sample size for phase I/II.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_nf">NF</code></td>
<td>
<p>Number of patients to assign optimal doses prior to adaptive randomization.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_b">B</code></td>
<td>
<p>Number of iterations to perform in the MCMC.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_nsims">nSims</code></td>
<td>
<p>Number of simulated trials to run.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_petrue">PETrue</code></td>
<td>
<p>True vector of efficacy probabilities for each dose.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrial_+3A_pttrue">PTTrue</code></td>
<td>
<p>True vector of toxicity probabilities for each dose.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the vector of optimal doses chosen, a matrix of posterior desireability scores for each trial, and a matrix consisting of patient dose assignments and Toxicity and Efficacy indicators, with each Nmax rows corresponding to a separate trial. Trials that are stopped due to excessive toxicity probabilty or small efficacy probabilities are not included in the final results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Doses, YE,YT
##Starting Dose
DoseStart=1
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
## Contour Vector
Contour = c(.35, .75,.7,.4)
##Hypermeans
Hypermeans = c(.022,3.45,0,-4.23,3.1,0)
Hypervars = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
Hypervars=Hypervars^2
##Acceptability Criteria
PiLim = c(.3,.4)
ProbLim=c(.1,.1)
##Cohort Size, N^F and N_ET
cohort=3
NF=15
NET=30
PTTrue = c(.1,.15,.25,.35,.5)
PETrue=c(.2,.4,.6,.65,.7)
##Number of iterations for MCMC
B=2000
### Number of Simulations
nSims=1
RunAdaptiveEffToxTrial(DoseStart,Dose, Hypermeans,  Hypervars,
Contour, PiLim, ProbLim,  cohort, NET,  NF, B, nSims, PETrue, PTTrue )
</code></pre>

<hr>
<h2 id='SimPhase123'>Simulates replications of the phase123 and phase 12-3 trials.</h2><span id='topic+SimPhase123'></span>

<h3>Description</h3>

<p>This function simulates replications of the phase123 and phase 12-3 trials and returns a list containing the doses chosen, decisions made (1=A(x) better, 0= futility, -1=C better)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimPhase123(DoseStart, Dose, PE, PT, Hypermeans, Hypervars, Contour, PiLim,
  ProbLim, NET, NF, Accrue12, Time12, cohort, betaA, ProbC, betaC, Family,
  alpha, Nmax, Accrue, Twait, NLookSwitch, NLook, Sup, Fut, nSims)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimPhase123_+3A_dosestart">DoseStart</code></td>
<td>
<p>Starting dose of the phase 12 trial.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_dose">Dose</code></td>
<td>
<p>Vector of standardized doses considered in the trial.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_pe">PE</code></td>
<td>
<p>True efficacy dose-toxicity vector.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_pt">PT</code></td>
<td>
<p>True toxicity dose-toxicity vector.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>Prior Means for the Eff-Tox design of length 6.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_hypervars">Hypervars</code></td>
<td>
<p>Prior Variances for the Eff-Tox design of length 6.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_contour">Contour</code></td>
<td>
<p>Vector containing 4 entries used to make the desireability function. Contour[1] contains a desired toxicity probability given efficacy, Countour[2] contains a desired efficacy probability given toxicity, and (Contour[3],Contour[4]) is an equally desireable pair of efficacy and toxicity probabilities that are non-zero or one.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_pilim">PiLim</code></td>
<td>
<p>Vector of length two with PiLim[1] containing the acceptable lower limit on efficacy probability and PiLim[2] containing the acceptable upper limit on toxicity probability.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_problim">ProbLim</code></td>
<td>
<p>Vector of length two with ProbLim[1] containing the probability cutoff for acceptable efficacy probability and ProbLim[2] containing the probability cutoff for acceptable toxicity probability.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_net">NET</code></td>
<td>
<p>Maximum sample size of the phase 12 trial.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_nf">NF</code></td>
<td>
<p>Number of patients to assign deterministic doses prior to adaptive randomization.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_accrue12">Accrue12</code></td>
<td>
<p>Accrual rate for patients in the phase 12 portion of the trial.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_time12">Time12</code></td>
<td>
<p>Time window for phase 12.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_cohort">cohort</code></td>
<td>
<p>Size of each patient cohort.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_betaa">betaA</code></td>
<td>
<p>True linear term for the rate or mean parameter (beta_1,exp(beta_E),-exp(beta_T),beta_2,beta_0) for agent A.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_probc">ProbC</code></td>
<td>
<p>Probability of efficacy and toxicity for the control therapy.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_betac">betaC</code></td>
<td>
<p>Linear term for efficacy, toxicity and beta_0 for the control groupar term for efficacy, toxicity and beta_0 for the control group.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_family">Family</code></td>
<td>
<p>Time to event distribution. Options include: Exponential, Gamma, Weibull, Lognormal.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_alpha">alpha</code></td>
<td>
<p>Shape parameter or standard deviation of a lognormal distribution.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_nmax">Nmax</code></td>
<td>
<p>Maximum number of patients to enroll in phase 3.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_accrue">Accrue</code></td>
<td>
<p>Accrual rate for patients in the phase 3 portion of the trial.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_twait">Twait</code></td>
<td>
<p>Waiting time in between phase 12 and phase 3.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_nlookswitch">NLookSwitch</code></td>
<td>
<p>Number of patient events to determine if we re-optimize doses for A.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_nlook">NLook</code></td>
<td>
<p>Vector of information criteria for making interim looks.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_sup">Sup</code></td>
<td>
<p>Vector of superiority boundaries.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_fut">Fut</code></td>
<td>
<p>Vector of futility boundaries.</p>
</td></tr>
<tr><td><code id="SimPhase123_+3A_nsims">nSims</code></td>
<td>
<p>Number of simulations to run for the phase 123 and conventional design.</p>
</td></tr>
</table>


<h3>References</h3>

<p>[1] Chapple and Thall (2018).A Hybrid Phase I-II/III Clinical Trial Design Allowing Dose Re-Optimization in Phase III. Biometrics. In Press,
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ##We need to specify Phase 12,
###Phase 3 trial paramters,
##the additional phase 123 parameters and simulation parameters
#This is scenario 3 for the exponetial case
##the additional phase 123 parameters and simulation parameters
###########PHASE12 Parameters ##################
DoseStart=1
##True Efficacy and Toxicity Probabilities
PT = c(.05,.08,.1,.15,.2)
PE=c(.2,.25,.35,.4,.55)
##Raw Dose Levels considered
Dose = c(1,2,3,3.5,5)
#Max Sample Size
NET=30
##Number of patients before randomization
NF=15
##Cohort size
cohort=3
##Hypermeans for Eff-Tox
Hypermeans = c(.022,3.45,0,-4.23,3.1,0)
Hypervars = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
Hypervars=Hypervars^2
##Contour Vector
Contour = c(.35, .75,.7,.4)
##Acceptability Criteria
PiLim = c(.3,.4)
ProbLim=c(.1,.1)
##Phase 12 accrual rate
Accrue12=5
###How long is the time window in phase 12?
Time12=1
##########PHASE3 Parameters####################
Nmax=500
##Number of patient events for interim looks
NLook = c(200,300,400)
##Superiority Boundaries
Sup = c(2.96, 2.53,1.99)
##Futility Boundaries (0 means no futility decision)
Fut = c(0,1.001,0)
##Average accrual rate for phase III
Accrue = 10
###########Phase123 Parameters###########
###Number of patient events to re-optimize doses
NLookSwitch=50
##Time in between phase 12 and phase 3
Twait=1
#########Simulation Parameters######
###Family of Distributions
Family="Gamma"
###Shape parameter, Not needed for Exponential
alpha=1
###True Beta vector (beta_1,exp(beta_E),-exp(beta_T),beta_2,beta_0)
betaA = c(.1, .3, -1,-1,3.6)
##True beta vector for (exp(beta_E),-exp(beta_T),beta_C)  of the control treatment
betaC=c(.3,-1,log(24/1.035111))
##True efficacy and toxicity probability for control group
ProbC = c(.3,.1)
##Number of simulations to run
nSims=1
##Run Simulations
Results=SimPhase123(DoseStart,Dose,PE,PT,Hypermeans,Hypervars,Contour,
                 PiLim,ProbLim,NET,NF,Accrue12,Time12,cohort,betaA,ProbC,betaC,
                Family,alpha,Nmax,Accrue,Twait,NLookSwitch,NLook,Sup,Fut,nSims)
</code></pre>

<hr>
<h2 id='SimPhase3'>Performs one replication of phase 3 for the phase 123 design, given phase 12 data.</h2><span id='topic+SimPhase3'></span>

<h3>Description</h3>

<p>This function simulates the phase 3 potion of the phase 123 trial, given phase 12 outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimPhase3(Dose, Phase12, PE, PT, Hypermeans, Hypervars, betaA, ProbC,
  betaC, Family, alpha, Nmax, Opt, Accrue, Time12, Twait, NLookSwitch,
  NLook, Sup, Fut)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimPhase3_+3A_dose">Dose</code></td>
<td>
<p>Vector of standardized doses considered in the trial.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_phase12">Phase12</code></td>
<td>
<p>Matrix Consisting of patient data from a phase 12 trial. The columns are in order: Doses given, YE, YT, Accrual Times</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_pe">PE</code></td>
<td>
<p>True efficacy dose-toxicity vector.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_pt">PT</code></td>
<td>
<p>True toxicity dose-toxicity vector.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>Prior Means for the Eff-Tox design of length 6.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_hypervars">Hypervars</code></td>
<td>
<p>Prior Variances for the Eff-Tox design of length 6.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_betaa">betaA</code></td>
<td>
<p>True linear term for the rate or mean parameter (beta_1,exp(beta_E),-exp(beta_T),beta_2,beta_0) for agent A.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_probc">ProbC</code></td>
<td>
<p>Probability of efficacy and toxicity for the control therapy.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_betac">betaC</code></td>
<td>
<p>Linear term for efficacy, toxicity and beta_0 for the control group.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_family">Family</code></td>
<td>
<p>Time to event distribution. Options include: Exponential, Gamma, Weibull, Lognormal.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_alpha">alpha</code></td>
<td>
<p>Shape parameter or standard deviation of a lognormal distribution.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_nmax">Nmax</code></td>
<td>
<p>Maximum number of patients to enroll in phase 3.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_opt">Opt</code></td>
<td>
<p>Dose used for A to begin randomization in phase 3.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_accrue">Accrue</code></td>
<td>
<p>Accrual rate for patients in phase 3.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_time12">Time12</code></td>
<td>
<p>Time window for phase 12.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_twait">Twait</code></td>
<td>
<p>Waiting time in between phase 12 and phase 3.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_nlookswitch">NLookSwitch</code></td>
<td>
<p>Number of patient events to determine if we re-optimize doses for A.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_nlook">NLook</code></td>
<td>
<p>Vector of information criteria for making interim looks.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_sup">Sup</code></td>
<td>
<p>Vector of superiority boundaries.</p>
</td></tr>
<tr><td><code id="SimPhase3_+3A_fut">Fut</code></td>
<td>
<p>Vector of futility boundaries.</p>
</td></tr>
</table>


<h3>References</h3>

<p>[1] Chapple and Thall (2018).A Hybrid Phase I-II/III Clinical Trial Design Allowing Dose Re-Optimization in Phase III. Biometrics. In Press,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
##True Efficacy and Toxicity Probabilities
PT = c(.1,.15,.25,.35,.5)
PE=c(.2,.4,.6,.65,.7)
##Dose Levels considered
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
##Average accrual rate for phase III
Accrue = 10
#'##Hypermeans for Eff-Tox
Hypermeans = c(.022,3.45,0,-4.23,3.1,0)
Hypervars = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
Hypervars=Hypervars^2
Contour = c(.35, .75,.7,.4)
PiLim = c(.3,.4)
ProbLim=c(.1,.1)
###Family of Distributions
Family="Exponential"
###Shape parameter ## Doesn't matter for exponential distribution
alpha=1
###True Beta vector
betaA = c(.75,-.5, .3, -.25,2.143)
##True beta vector for efficacy, toxicity and intercept of the control treatment
betaC=c(.3,-.25,2.389)
##True efficacy and toxicity probability for control group
ProbC = c(.4,.15)
##Waiting time in between
Twait=1
###How long is the time window in phase 12?
Time12=1
##Dose to start phase 3 with
Opt=3
##Make matrix with old phase 12 data
Doses= c(1,1,1,2,2,2,1,1,1,3,3,3,1,1,1,2,2,2)
YE = c(0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0)
YT=c(0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,0,0)
##Accrual Times for old data
Accrue12=2
##Size of phase 12 cohort
cohort=3
ACC1=cumsum(rexp(length(YT),Accrue12))
##Accrual times are the same for each cohort in phase 12
Grab = rep(NA,length(YT)/cohort)
for(m in 1:length(Grab)){Grab[m]=ACC1[m*3]}
for(m in 1:length(Grab)){ACC1[((m-1)*cohort+1):((m-1)*cohort+cohort)]=rep(Grab[m],cohort)}
Phase12 = cbind(Doses,YE,YT,ACC1)
betaC=c(.3,-.25,2.389)
##True efficacy and toxicity probability for control group
ProbC = c(.4,.15)
##Max Sample Size
Nmax=500
###Number of patient events to Re-optimize doses
NLookSwitch = 50
##Number of patient events for interim looks
NLook = c(200,300,400)
##Superiority Boundaries
Sup = c(2.96, 2.53,1.99)
##Futility Boundaries (0 means no futility decision)
Fut = c(0,1.001,0)
##Starting Dose, hat(x)_ET
Opt=3
##Number of simulations to run
nSims=10
SimPhase3(Dose,Phase12,PE,PT,Hypermeans,Hypervars,betaA,
ProbC,betaC,Family,alpha,Nmax,Opt,Accrue,
Time12,Twait,NLookSwitch,NLook,Sup,Fut)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
