<!DOCTYPE html><html><head><title>Help for package lrstat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lrstat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lrstat-package'><p>Power and Sample Size Calculation for Non-Proportional Hazards</p>
and Beyond</a></li>
<li><a href='#accrual'><p>Number of enrolled subjects</p></a></li>
<li><a href='#ad'><p>Number of patients enrolled during an interval and having an event</p>
by specified calendar times</a></li>
<li><a href='#adaptDesign'><p>Adaptive design at an interim look</p></a></li>
<li><a href='#aml'><p>Acute myelogenous leukemia survival data from the survival package</p></a></li>
<li><a href='#binary_tte_sim'><p>Simulation for a binary endpoint and a time-to-event endpoint</p></a></li>
<li><a href='#BOINTable'><p>BOIN decision table</p></a></li>
<li><a href='#caltime'><p>Calendar times for target number of events</p></a></li>
<li><a href='#ClopperPearsonCI'><p>Clopper-Pearson confidence interval for one-sample proportion</p></a></li>
<li><a href='#covrmst'><p>Covariance between restricted mean survival times</p></a></li>
<li><a href='#errorSpent'><p>Error spending</p></a></li>
<li><a href='#exitprob'><p>Stagewise exit probabilities</p></a></li>
<li><a href='#fadjpbon'><p>Adjusted p-values for Bonferroni-based graphical approaches</p></a></li>
<li><a href='#fadjpdun'><p>Adjusted p-values for Dunnett-based graphical approaches</p></a></li>
<li><a href='#fadjpsim'><p>Adjusted p-values for Simes-based graphical approaches</p></a></li>
<li><a href='#findInterval3'><p>Find interval numbers of indices</p></a></li>
<li><a href='#fmodmix'><p>Adjusted p-values for modified mixture gatekeeping procedures</p></a></li>
<li><a href='#fquantile'><p>The quantiles of a survival distribution</p></a></li>
<li><a href='#fseqbon'><p>Group sequential trials using Bonferroni-based graphical</p>
approaches</a></li>
<li><a href='#fstdmix'><p>Adjusted p-values for standard mixture gatekeeping procedures</p></a></li>
<li><a href='#fstp2seq'><p>Adjusted p-values for stepwise testing procedures for two sequences</p></a></li>
<li><a href='#ftrunc'><p>Adjusted p-values for Holm, Hochberg, and Hommel procedures</p></a></li>
<li><a href='#fwgtmat'><p>Weight matrix for all intersection hypotheses</p></a></li>
<li><a href='#getAccrualDurationFromN'><p>Accrual duration to enroll target number of subjects</p></a></li>
<li><a href='#getADCI'><p>Confidence interval after adaptation</p></a></li>
<li><a href='#getADRCI'><p>Repeated confidence interval after adaptation</p></a></li>
<li><a href='#getBound'><p>Efficacy boundaries for group sequential design</p></a></li>
<li><a href='#getCI'><p>Confidence interval after trial termination</p></a></li>
<li><a href='#getCP'><p>Conditional power allowing for varying parameter values</p></a></li>
<li><a href='#getDesign'><p>Power and sample size for a generic group sequential design</p></a></li>
<li><a href='#getDesignAgreement'><p>Power and sample size for Cohen's kappa</p></a></li>
<li><a href='#getDesignANOVA'><p>Power and sample size for one-way ANOVA</p></a></li>
<li><a href='#getDesignANOVAContrast'><p>Power and sample size for one-way ANOVA contrast</p></a></li>
<li><a href='#getDesignEquiv'><p>Power and sample size for a generic group sequential equivalence</p>
design</a></li>
<li><a href='#getDesignFisherExact'><p>Power and sample size for Fisher's exact test for two proportions</p></a></li>
<li><a href='#getDesignLogistic'><p>Power and sample size for logistic regression</p></a></li>
<li><a href='#getDesignMeanDiff'><p>Group sequential design for two-sample mean difference</p></a></li>
<li><a href='#getDesignMeanDiffCarryover'><p>Power and sample size for direct treatment effects in crossover</p>
trials accounting for carryover effects</a></li>
<li><a href='#getDesignMeanDiffEquiv'><p>Group sequential design for equivalence in two-sample</p>
mean difference</a></li>
<li><a href='#getDesignMeanDiffMMRM'><p>Group sequential design for two-sample mean difference from the</p>
MMRM model</a></li>
<li><a href='#getDesignMeanDiffXO'><p>Group sequential design for mean difference in 2x2 crossover</p></a></li>
<li><a href='#getDesignMeanDiffXOEquiv'><p>Group sequential design for equivalence in mean difference</p>
in 2x2 crossover</a></li>
<li><a href='#getDesignMeanRatio'><p>Group sequential design for two-sample mean ratio</p></a></li>
<li><a href='#getDesignMeanRatioEquiv'><p>Group sequential design for equivalence in two-sample</p>
mean ratio</a></li>
<li><a href='#getDesignMeanRatioXO'><p>Group sequential design for mean ratio in 2x2 crossover</p></a></li>
<li><a href='#getDesignMeanRatioXOEquiv'><p>Group sequential design for equivalence in mean ratio</p>
in 2x2 crossover</a></li>
<li><a href='#getDesignOddsRatio'><p>Group sequential design for two-sample odds ratio</p></a></li>
<li><a href='#getDesignOddsRatioEquiv'><p>Group sequential design for equivalence in two-sample</p>
odds ratio</a></li>
<li><a href='#getDesignOneMean'><p>Group sequential design for one-sample mean</p></a></li>
<li><a href='#getDesignOneMultinom'><p>Power and sample for one-sample multinomial response</p></a></li>
<li><a href='#getDesignOneProportion'><p>Group sequential design for one-sample proportion</p></a></li>
<li><a href='#getDesignOneRateExact'><p>Power and sample size for one-sample Poisson rate exact test</p></a></li>
<li><a href='#getDesignOneSlope'><p>Group sequential design for one-sample slope</p></a></li>
<li><a href='#getDesignOrderedBinom'><p>Power and sample size for Cochran-Armitage trend test for</p>
ordered multi-sample binomial response</a></li>
<li><a href='#getDesignPairedMeanDiff'><p>Group sequential design for paired mean difference</p></a></li>
<li><a href='#getDesignPairedMeanDiffEquiv'><p>Group sequential design for equivalence in paired mean</p>
difference</a></li>
<li><a href='#getDesignPairedMeanRatio'><p>Group sequential design for paired mean ratio</p></a></li>
<li><a href='#getDesignPairedMeanRatioEquiv'><p>Group sequential design for equivalence in paired mean ratio</p></a></li>
<li><a href='#getDesignPairedPropMcNemar'><p>Group sequential design for McNemar's test for paired</p>
proportions</a></li>
<li><a href='#getDesignRepeatedANOVA'><p>Power and sample size for repeated-measures ANOVA</p></a></li>
<li><a href='#getDesignRepeatedANOVAContrast'><p>Power and sample size for one-way repeated measures ANOVA contrast</p></a></li>
<li><a href='#getDesignRiskDiff'><p>Group sequential design for two-sample risk difference</p></a></li>
<li><a href='#getDesignRiskDiffEquiv'><p>Group sequential design for equivalence in two-sample</p>
risk difference</a></li>
<li><a href='#getDesignRiskDiffExact'><p>Power and sample size for exact unconditional test for risk</p>
difference</a></li>
<li><a href='#getDesignRiskDiffExactEquiv'><p>Power and sample size for exact unconditional test for</p>
equivalence in risk difference</a></li>
<li><a href='#getDesignRiskRatio'><p>Group sequential design for two-sample risk ratio</p></a></li>
<li><a href='#getDesignRiskRatioEquiv'><p>Group sequential design for equivalence in two-sample</p>
risk ratio</a></li>
<li><a href='#getDesignRiskRatioExact'><p>Power and sample size for exact unconditional test for risk</p>
ratio</a></li>
<li><a href='#getDesignRiskRatioExactEquiv'><p>Power and sample size for exact unconditional test for</p>
equivalence in risk ratio</a></li>
<li><a href='#getDesignRiskRatioFM'><p>Group sequential design for two-sample risk ratio based on</p>
the Farrington-Manning score test</a></li>
<li><a href='#getDesignSlopeDiff'><p>Group sequential design for two-sample slope difference</p></a></li>
<li><a href='#getDesignSlopeDiffMMRM'><p>Group sequential design for two-sample slope difference</p>
from the MMRM model</a></li>
<li><a href='#getDesignTwoMultinom'><p>Power and sample for difference in two-sample multinomial responses</p></a></li>
<li><a href='#getDesignTwoOrdinal'><p>Power and sample size for the Wilcoxon test for two-sample</p>
ordinal response</a></li>
<li><a href='#getDesignTwoWayANOVA'><p>Power and sample size for two-way ANOVA</p></a></li>
<li><a href='#getDesignUnorderedBinom'><p>Power and sample size for unordered multi-sample binomial response</p></a></li>
<li><a href='#getDesignUnorderedMultinom'><p>Power and sample size for unordered multi-sample</p>
multinomial response</a></li>
<li><a href='#getDesignWilcoxon'><p>Group sequential design for two-sample Wilcoxon test</p></a></li>
<li><a href='#getDurationFromNevents'><p>Range of accrual duration for target number of events</p></a></li>
<li><a href='#getNeventsFromHazardRatio'><p>Get the required number of events given hazard ratio</p></a></li>
<li><a href='#getRCI'><p>Repeated confidence interval for group sequential design</p></a></li>
<li><a href='#hd'><p>Integrated event probability over an interval with constant hazard</p></a></li>
<li><a href='#heart'><p>Stanford heart transplant data from the survival package</p></a></li>
<li><a href='#hedgesg'><p>Hedges' g effect size</p></a></li>
<li><a href='#immdef'><p>Simulated Concorde trial data from the rpsftm package</p></a></li>
<li><a href='#kmdiff'><p>Estimate of milestone survival difference</p></a></li>
<li><a href='#kmest'><p>Kaplan-Meier estimates of the survival curve</p></a></li>
<li><a href='#kmpower'><p>Power for difference in milestone survival probabilities</p></a></li>
<li><a href='#kmpower1s'><p>Power for one-sample milestone survival probability</p></a></li>
<li><a href='#kmpowerequiv'><p>Power for equivalence in milestone survival probability difference</p></a></li>
<li><a href='#kmsamplesize'><p>Sample size for difference in milestone survival probabilities</p></a></li>
<li><a href='#kmsamplesize1s'><p>Sample size for one-sample milestone survival probability</p></a></li>
<li><a href='#kmsamplesizeequiv'><p>Sample size for equivalence in milestone survival probability</p>
difference</a></li>
<li><a href='#kmstat'><p>Stratified difference in milestone survival probabilities</p></a></li>
<li><a href='#kmstat1'><p>Milestone survival probability by stratum</p></a></li>
<li><a href='#liferegr'><p>Parametric regression models for failure time data</p></a></li>
<li><a href='#lrpower'><p>Log-rank test power</p></a></li>
<li><a href='#lrpowerequiv'><p>Power for equivalence in hazard ratio</p></a></li>
<li><a href='#lrsamplesize'><p>Log-rank test sample size</p></a></li>
<li><a href='#lrsamplesizeequiv'><p>Sample size for equivalence in hazard ratio</p></a></li>
<li><a href='#lrsim'><p>Log-rank test simulation</p></a></li>
<li><a href='#lrsim2e'><p>Log-rank test simulation for two endpoints</p></a></li>
<li><a href='#lrsim2e3a'><p>Log-rank test simulation for two endpoints and three arms</p></a></li>
<li><a href='#lrsim3a'><p>Log-rank test simulation for three arms</p></a></li>
<li><a href='#lrstat'><p>Number of subjects having an event and log-rank statistics</p></a></li>
<li><a href='#lrstat1'><p>Number of subjects having an event and log-rank statistic</p>
for a hypothesized hazard ratio at a given calendar time</a></li>
<li><a href='#lrtest'><p>Log-rank test of survival curve difference</p></a></li>
<li><a href='#mnOddsRatioCI'><p>Miettinen-Nurminen score confidence interval for</p>
two-sample odds ratio</a></li>
<li><a href='#mnRateDiffCI'><p>Miettinen-Nurminen score confidence interval for</p>
two-sample rate difference</a></li>
<li><a href='#mnRateRatioCI'><p>Miettinen-Nurminen score confidence interval for</p>
two-sample rate ratio</a></li>
<li><a href='#mnRiskDiffCI'><p>Miettinen-Nurminen score confidence interval for</p>
two-sample risk difference</a></li>
<li><a href='#mnRiskRatioCI'><p>Miettinen-Nurminen score confidence interval for</p>
two-sample risk ratio</a></li>
<li><a href='#mTPI2Table'><p>mTPI-2 decision table</p></a></li>
<li><a href='#natrisk'><p>Number of subjects at risk</p></a></li>
<li><a href='#nbpower'><p>Power for negative binomial rate ratio</p></a></li>
<li><a href='#nbpower1s'><p>Power for one-sample negative binomial rate</p></a></li>
<li><a href='#nbpowerequiv'><p>Power for equivalence in negative binomial rate ratio</p></a></li>
<li><a href='#nbsamplesize'><p>Sample size for negative binomial rate ratio</p></a></li>
<li><a href='#nbsamplesize1s'><p>Sample size for one-sample negative binomial rate</p></a></li>
<li><a href='#nbsamplesizeequiv'><p>Sample size for equivalence in negative binomial rate ratio</p></a></li>
<li><a href='#nbstat'><p>Negative binomial rate ratio</p></a></li>
<li><a href='#nbstat1'><p>Negative binomial rate ratio by stratum</p></a></li>
<li><a href='#nevent'><p>Number of subjects having an event</p></a></li>
<li><a href='#nevent2'><p>Number of subjects having an event by calendar time</p></a></li>
<li><a href='#param_accrualDuration'><p>Parameter Description: accrualDuration</p></a></li>
<li><a href='#param_accrualIntensity'><p>Parameter Description: accrualIntensity</p></a></li>
<li><a href='#param_accrualTime'><p>Parameter Description: accrualTime</p></a></li>
<li><a href='#param_allocationRatioPlanned'><p>Parameter Description: allocationRatioPlanned</p></a></li>
<li><a href='#param_alpha'><p>Parameter Description: alpha</p></a></li>
<li><a href='#param_criticalValues'><p>Parameter Description: criticalValues</p></a></li>
<li><a href='#param_efficacyStopping'><p>Parameter Description: efficacyStopping</p></a></li>
<li><a href='#param_estimateHazardRatio'><p>Parameter Description: estimateHazardRatio</p></a></li>
<li><a href='#param_fixedFollowup'><p>Parameter Description: fixedFollowup</p></a></li>
<li><a href='#param_followupTime'><p>Parameter Description: followupTime</p></a></li>
<li><a href='#param_futilityBounds'><p>Parameter Description: futilityBounds</p></a></li>
<li><a href='#param_futilityStopping'><p>Parameter Description: futilityStopping</p></a></li>
<li><a href='#param_gamma'><p>Parameter Description: gamma</p></a></li>
<li><a href='#param_gamma1'><p>Parameter Description: gamma1</p></a></li>
<li><a href='#param_gamma1_stratified'><p>Parameter Description: gamma1_stratified</p></a></li>
<li><a href='#param_gamma2'><p>Parameter Description: gamma2</p></a></li>
<li><a href='#param_gamma2_stratified'><p>Parameter Description: gamma2_stratified</p></a></li>
<li><a href='#param_hazardRatioH0'><p>Parameter Description: hazardRatioH0</p></a></li>
<li><a href='#param_informationRates'><p>Parameter Description: informationRates</p></a></li>
<li><a href='#param_kMax'><p>Parameter Description: kMax</p></a></li>
<li><a href='#param_lambda'><p>Parameter Description: lambda</p></a></li>
<li><a href='#param_lambda1'><p>Parameter Description: lambda1</p></a></li>
<li><a href='#param_lambda1_stratified'><p>Parameter Description: lambda1_stratified</p></a></li>
<li><a href='#param_lambda2'><p>Parameter Description: lambda2</p></a></li>
<li><a href='#param_lambda2_stratified'><p>Parameter Description: lambda2_stratified</p></a></li>
<li><a href='#param_maxFollowupTime'><p>Parameter Description: maxFollowupTime</p></a></li>
<li><a href='#param_minFollowupTime'><p>Parameter Description: minFollowupTime</p></a></li>
<li><a href='#param_numSubintervals'><p>Parameter Description: numSubintervals</p></a></li>
<li><a href='#param_parameterAlphaSpending'><p>Parameter Description: parameterAlphaSpending</p></a></li>
<li><a href='#param_parameterBetaSpending'><p>Parameter Description: parameterBetaSpending</p></a></li>
<li><a href='#param_piecewiseSurvivalTime'><p>Parameter Description: piecewiseSurvivalTime</p></a></li>
<li><a href='#param_rho1'><p>Parameter Description: rho1</p></a></li>
<li><a href='#param_rho2'><p>Parameter Description: rho2</p></a></li>
<li><a href='#param_stratumFraction'><p>Parameter Description: stratumFraction</p></a></li>
<li><a href='#param_typeAlphaSpending'><p>Parameter Description: typeAlphaSpending</p></a></li>
<li><a href='#param_typeBetaSpending'><p>Parameter Description: typeBetaSpending</p></a></li>
<li><a href='#param_typeOfComputation'><p>Parameter Description: typeOfComputation</p></a></li>
<li><a href='#param_userAlphaSpending'><p>Parameter Description: userAlphaSpending</p></a></li>
<li><a href='#param_userBetaSpending'><p>Parameter Description: userBetaSpending</p></a></li>
<li><a href='#patrisk'><p>Probability of being at risk</p></a></li>
<li><a href='#pd'><p>Integrated event probability over an interval</p></a></li>
<li><a href='#pevent'><p>Probability of having an event</p></a></li>
<li><a href='#phregr'><p>Proportional hazards regression model</p></a></li>
<li><a href='#powerFisherExact'><p>Power for Fisher's exact test for two proportions</p></a></li>
<li><a href='#powerOnePropExact'><p>Power for binomial one-sample exact test</p></a></li>
<li><a href='#powerOneRateExact'><p>Power for Poisson one-sample exact test</p></a></li>
<li><a href='#powerRiskDiffExact'><p>Power for exact unconditional test of risk difference</p></a></li>
<li><a href='#powerRiskDiffExactEquiv'><p>Power for exact unconditional test of equivalence in risk</p>
difference</a></li>
<li><a href='#powerRiskRatioExact'><p>Power for exact unconditional test of risk ratio</p></a></li>
<li><a href='#powerRiskRatioExactEquiv'><p>Power for exact unconditional test of equivalence in risk</p>
ratio</a></li>
<li><a href='#print.adaptDesign'><p>Print adaptive group sequential design</p></a></li>
<li><a href='#print.BOINTable'><p>Print the decision table for the BOIN design</p></a></li>
<li><a href='#print.design'><p>Print group sequential design</p></a></li>
<li><a href='#print.designAgreement'><p>Print the power and sample size for Cohen's kappa.</p></a></li>
<li><a href='#print.designANOVA'><p>Print the power and sample size for one-way ANOVA</p></a></li>
<li><a href='#print.designANOVAContrast'><p>Print the power and sample size for a single contrast in</p>
one-way ANOVA</a></li>
<li><a href='#print.designEquiv'><p>Print group sequential equivalence design</p></a></li>
<li><a href='#print.designLogistic'><p>Print the power and sample size for logistic regression</p></a></li>
<li><a href='#print.designMeanDiff'><p>Print power and sample size results for two-sample mean difference</p></a></li>
<li><a href='#print.designMeanDiffCarryover'><p>Print power and sample size results for direct treatment effects</p>
in crossover trials accounting for carryover effects</a></li>
<li><a href='#print.designMeanDiffEquiv'><p>Print power and sample size results for equivalence in</p>
two-sample mean difference</a></li>
<li><a href='#print.designMeanDiffMMRM'><p>Print power and sample size results for two-sample mean difference</p>
at the last time point from the MMRM model</a></li>
<li><a href='#print.designMeanDiffXO'><p>Print power and sample size results for mean difference in 2x2</p>
crossover</a></li>
<li><a href='#print.designMeanDiffXOEquiv'><p>Print power and sample size results for equivalence in</p>
mean difference in 2x2 crossover</a></li>
<li><a href='#print.designMeanRatio'><p>Print power and sample size results for two-sample mean ratio</p></a></li>
<li><a href='#print.designMeanRatioEquiv'><p>Print power and sample size results for equivalence in</p>
two-sample mean ratio</a></li>
<li><a href='#print.designMeanRatioXO'><p>Print power and sample size results for mean ratio in 2x2 crossover</p></a></li>
<li><a href='#print.designMeanRatioXOEquiv'><p>Print power and sample size results for equivalence in</p>
mean ratio in 2x2 crossover</a></li>
<li><a href='#print.designOddsRatio'><p>Print power and sample size results for two-sample odds ratio</p></a></li>
<li><a href='#print.designOddsRatioEquiv'><p>Print power and sample size results for equivalence in</p>
two-sample odds ratio</a></li>
<li><a href='#print.designOneMean'><p>Print power and sample size results for one-sample mean</p></a></li>
<li><a href='#print.designOneMultinom'><p>Print the power and sample size for one-sample multinomial response</p></a></li>
<li><a href='#print.designOneProportion'><p>Print power and sample size results for one-sample proportion</p></a></li>
<li><a href='#print.designOneSlope'><p>Print power and sample size results for one-sample slope</p></a></li>
<li><a href='#print.designOrderedBinom'><p>Print the power and sample size for Cochran-Armitage trend test</p>
for ordered multi-sample binomial response</a></li>
<li><a href='#print.designPairedMeanDiff'><p>Print power and sample size results for paired mean difference</p></a></li>
<li><a href='#print.designPairedMeanDiffEquiv'><p>Print power and sample size results for equivalence in paired</p>
mean difference</a></li>
<li><a href='#print.designPairedMeanRatio'><p>Print power and sample size results for paired mean ratio</p></a></li>
<li><a href='#print.designPairedMeanRatioEquiv'><p>Print power and sample size results for equivalence in paired</p>
mean ratio</a></li>
<li><a href='#print.designPairedPropMcNemar'><p>Print power and sample size results for McNemar's test for paired</p>
proportions</a></li>
<li><a href='#print.designRepeatedANOVA'><p>Print the power and sample size for one-way repeated measures ANOVA</p></a></li>
<li><a href='#print.designRepeatedANOVAContrast'><p>Print the power and sample size for a single contrast in</p>
one-way repeated measures ANOVA</a></li>
<li><a href='#print.designRiskDiff'><p>Print power and sample size results for two-sample risk difference</p></a></li>
<li><a href='#print.designRiskDiffEquiv'><p>Print power and sample size results for equivalence in</p>
two-sample risk difference</a></li>
<li><a href='#print.designRiskRatio'><p>Print power and sample size results for two-sample risk ratio</p></a></li>
<li><a href='#print.designRiskRatioEquiv'><p>Print power and sample size results for equivalence in</p>
two-sample risk ratio</a></li>
<li><a href='#print.designRiskRatioFM'><p>Print power and sample size results for two-sample risk ratio</p>
based on the Farrington-Manning score test</a></li>
<li><a href='#print.designSlopeDiff'><p>Print power and sample size results for two-sample slope difference</p></a></li>
<li><a href='#print.designSlopeDiffMMRM'><p>Print power and sample size results for two-sample slope difference</p>
at the last time point from the MMRM model</a></li>
<li><a href='#print.designTwoMultinom'><p>Print the power and sample size for difference in two-sample</p>
multinomial response</a></li>
<li><a href='#print.designTwoOrdinal'><p>Print the power and sample size for Wilcoxon test for two-sample</p>
ordinal response.</a></li>
<li><a href='#print.designTwoWayANOVA'><p>Print the power and sample size for two-way ANOVA</p></a></li>
<li><a href='#print.designUnorderedBinom'><p>Print the power and sample size for unordered multi-sample</p>
binomial response</a></li>
<li><a href='#print.designUnorderedMultinom'><p>Print the power and sample size for unordered multi-sample</p>
multinomial response</a></li>
<li><a href='#print.designWilcoxon'><p>Print power and sample size results for two-sample Wilcoxon test</p></a></li>
<li><a href='#print.estimateCI'><p>Print the point estimate and confidence interval</p></a></li>
<li><a href='#print.kmpower'><p>Print power and sample size results for milestone survival</p>
difference</a></li>
<li><a href='#print.kmpower1s'><p>Print power and sample size results for one-sample milestone</p>
survival probability</a></li>
<li><a href='#print.kmpowerequiv'><p>Print power and sample size results for equivalence in milestone</p>
survival probability difference</a></li>
<li><a href='#print.lrpower'><p>Print power and sample size results for log-rank tests</p></a></li>
<li><a href='#print.lrpowerequiv'><p>Print power and sample size results for equivalence in hazard</p>
ratio</a></li>
<li><a href='#print.lrsim'><p>Print simulation results for log-rank tests</p></a></li>
<li><a href='#print.mTPI2Table'><p>Print the decision table for the mTPI-2 design</p></a></li>
<li><a href='#print.nbpower'><p>Print power and sample size results for negative binomial rate</p>
ratio</a></li>
<li><a href='#print.nbpower1s'><p>Print power and sample size results for one-sample negative</p>
binomial rate</a></li>
<li><a href='#print.nbpowerequiv'><p>Print power and sample size results for equivalence in negative</p>
binomial rate ratio</a></li>
<li><a href='#print.rmpower'><p>Print power and sample size results for restricted mean survival</p>
time difference</a></li>
<li><a href='#print.rmpower1s'><p>Print power and sample size results for one-sample restricted</p>
mean survival time</a></li>
<li><a href='#print.rmpowerequiv'><p>Print power and sample size results for equivalence in restricted</p>
mean survival time difference</a></li>
<li><a href='#ptpwexp'><p>Distribution function of truncated piecewise exponential</p>
distribution</a></li>
<li><a href='#pwexpcuts'><p>Piecewise exponential approximation to a survival distribution</p></a></li>
<li><a href='#pwexploglik'><p>Profile log-likelihood function for the change points in</p>
piecewise exponential approximation</a></li>
<li><a href='#qtpwexp'><p>Quantile function of truncated piecewise exponential distribution</p></a></li>
<li><a href='#rawdata'><p>A simulated time-to-event data set with 10 replications</p></a></li>
<li><a href='#remlOddsRatio'><p>REML estimates of individual proportions with specified odds</p>
ratio</a></li>
<li><a href='#remlRateDiff'><p>REML estimates of individual rates with specified rate</p>
difference</a></li>
<li><a href='#remlRateRatio'><p>REML estimates of individual rates with specified rate</p>
ratio</a></li>
<li><a href='#remlRiskDiff'><p>REML estimates of individual proportions with specified risk</p>
difference</a></li>
<li><a href='#remlRiskRatio'><p>REML estimates of individual proportions with specified risk</p>
ratio</a></li>
<li><a href='#repeatedPValue'><p>Repeated p-values for group sequential design</p></a></li>
<li><a href='#riskDiffExactCI'><p>Exact unconditional confidence interval for risk difference</p></a></li>
<li><a href='#riskDiffExactPValue'><p>P-value for exact unconditional test of risk difference</p></a></li>
<li><a href='#riskRatioExactCI'><p>Exact unconditional confidence interval for risk ratio</p></a></li>
<li><a href='#riskRatioExactPValue'><p>P-value for exact unconditional test of risk ratio</p></a></li>
<li><a href='#rmdiff'><p>Estimate of restricted mean survival time difference</p></a></li>
<li><a href='#rmest'><p>Estimate of restricted mean survival time</p></a></li>
<li><a href='#rmpower'><p>Power for difference in restricted mean survival times</p></a></li>
<li><a href='#rmpower1s'><p>Power for one-sample restricted mean survival time</p></a></li>
<li><a href='#rmpowerequiv'><p>Power for equivalence in restricted mean survival time difference</p></a></li>
<li><a href='#rmsamplesize'><p>Sample size for difference in restricted mean survival times</p></a></li>
<li><a href='#rmsamplesize1s'><p>Sample size for one-sample restricted mean survival time</p></a></li>
<li><a href='#rmsamplesizeequiv'><p>Sample size for equivalence in restricted mean survival time</p>
difference</a></li>
<li><a href='#rmst'><p>Restricted mean survival time</p></a></li>
<li><a href='#rmstat'><p>Stratified difference in restricted mean survival times</p></a></li>
<li><a href='#rmstat1'><p>Restricted mean survival time by stratum</p></a></li>
<li><a href='#rpsft'><p>Rank preserving structured failure time model (RPSFTM) for</p>
treatment switching</a></li>
<li><a href='#rtpwexp'><p>Random number generation function of truncated piecewise</p>
exponential distribution</a></li>
<li><a href='#runShinyApp'><p>Run Shiny app</p></a></li>
<li><a href='#samplesizeFisherExact'><p>Sample size for Fisher's exact test for two proportions</p></a></li>
<li><a href='#samplesizeOnePropExact'><p>Sample size for binomial one-sample exact test</p></a></li>
<li><a href='#samplesizeOneRateExact'><p>Sample size for Poisson one-sample exact test</p></a></li>
<li><a href='#samplesizeRiskDiffExact'><p>Sample size for exact unconditional test of risk difference</p></a></li>
<li><a href='#samplesizeRiskDiffExactEquiv'><p>Sample size for exact unconditional test of equivalence in risk</p>
difference</a></li>
<li><a href='#samplesizeRiskRatioExact'><p>Sample size for exact unconditional test of risk ratio</p></a></li>
<li><a href='#samplesizeRiskRatioExactEquiv'><p>Sample size for exact unconditional test of equivalence in risk</p>
ratio</a></li>
<li><a href='#simon2stage'><p>Simon's two-stage design</p></a></li>
<li><a href='#simonBayesAnalysis'><p>Analysis of Simon's Bayesian basket trials</p></a></li>
<li><a href='#simonBayesSim'><p>Simulation of Simon's Bayesian basket trials</p></a></li>
<li><a href='#survQuantile'><p>Brookmeyer-Crowley confidence interval for quantiles of</p>
right-censored time-to-event data</a></li>
<li><a href='#tobin'><p>Tobin's tobit data from the survival package</p></a></li>
<li><a href='#updateGraph'><p>Update graph for graphical approaches</p></a></li>
<li><a href='#zstatOddsRatio'><p>Miettinen-Nurminen score test statistic for two-sample odds ratio</p></a></li>
<li><a href='#zstatRateDiff'><p>Miettinen-Nurminen score test statistic for two-sample rate</p>
difference</a></li>
<li><a href='#zstatRateRatio'><p>Miettinen-Nurminen score test statistic for two-sample rate ratio</p></a></li>
<li><a href='#zstatRiskDiff'><p>Miettinen-Nurminen score test statistic for two-sample risk</p>
difference</a></li>
<li><a href='#zstatRiskRatio'><p>Miettinen-Nurminen score test statistic for two-sample risk ratio</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Power and Sample Size Calculation for Non-Proportional Hazards
and Beyond</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-22</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs power and sample size calculation for non-proportional hazards model using the Fleming-Harrington family of weighted log-rank tests. The sequentially calculated log-rank test score statistics are assumed to have independent increments as characterized in Anastasios A. Tsiatis (1982) &lt;<a href="https://doi.org/10.1080%2F01621459.1982.10477898">doi:10.1080/01621459.1982.10477898</a>&gt;. The mean and variance of log-rank test score statistics are calculated based on Kaifeng Lu (2021) &lt;<a href="https://doi.org/10.1002%2Fpst.2069">doi:10.1002/pst.2069</a>&gt;. The boundary crossing probabilities are calculated using the recursive integration algorithm described in Christopher Jennison and Bruce W. Turnbull (2000, ISBN:0849303168). The package can also be used for continuous, binary, and count data. For continuous data, it can handle missing data through mixed-model for repeated measures (MMRM). In crossover designs, it can estimate direct treatment effects while accounting for carryover effects. For binary data, it can design Simon's 2-stage, modified toxicity probability-2 (mTPI-2), and Bayesian optimal interval (BOIN) trials. For count data, it can design group sequential trials for negative binomial endpoints with censoring. Additionally, it facilitates group sequential equivalence trials for all supported data types. Moreover, it can design adaptive group sequential trials for changes in sample size, error spending function, number and spacing or future looks. Finally, it offers various options for adjusted p-values, including graphical and gatekeeping procedures. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.9), mvtnorm (&ge; 1.1-3), lpSolve (&ge; 5.6.1), shiny
(&ge; 1.7.1)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), dplyr (&ge; 1.1.4), tidyr (&ge; 1.3.0),
knitr (&ge; 1.45), rmarkdown (&ge; 2.25), survival (&ge; 3.5-7)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-22 22:38:37 UTC; kaife</td>
</tr>
<tr>
<td>Author:</td>
<td>Kaifeng Lu <a href="https://orcid.org/0000-0002-6160-7119"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaifeng Lu &lt;kaifenglu@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-23 16:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='lrstat-package'>Power and Sample Size Calculation for Non-Proportional Hazards
and Beyond</h2><span id='topic+lrstat-package'></span>

<h3>Description</h3>

<p>Performs power and sample size calculation for
non-proportional hazards model using the Fleming-Harrington family
of weighted log-rank tests.
</p>


<h3>Details</h3>

<p>For proportional hazards, the power is determined by the
total number of events and the constant hazard ratio along with
information rates and spending functions. For
non-proportional hazards, the hazard ratio varies over time and
the calendar time plays a key role in determining the mean and
variance of the log-rank test score statistic. It requires an
iterative algorithm to find the calendar time at which the
targeted number of events will be reached for each interim
analysis. The lrstat package uses the analytic method
in Lu (2021) to find the mean and variance of the weighted
log-rank test score statistic at each interim analysis. In
addition, the package approximates the variance and covariance
matrix of the sequentially calculated log-rank test statistics
under the alternative hypothesis with that under the null hypothesis
to take advantage of the independent increments structure in
Tsiatis (1982) applicable for the Fleming-Harrington family
of weighted log-rank tests.
</p>
<p>The most useful functions in the package are <code>lrstat</code>,
<code>lrpower</code>, <code>lrsamplesize</code>, and <code>lrsim</code>, which calculate
the mean and variance of log-rank test score statistic at a sequence
of given calendar times, the power of the log-rank test, the sample
size in terms of accrual duration and follow-up duration, and the
log-rank test simulation, respectively. The <code>accrual</code> function
calculates the number of patients accrued at given calendar times. The
<code>caltime</code> function finds the calendar times to reach the targeted
number of events. The <code>exitprob</code> function calculates the stagewise
exit probabilities for specified boundaries with a varying mean
parameter over time based on an adaptation of the recursive
integration algorithm described in Chapter 19 of Jennison and
Turnbull (2000).
</p>
<p>The development of the lrstat package is heavily influenced by
the rpact package. We find their function arguments to be
self-explanatory. We have used the same names whenever appropriate
so that users familiar with the rpact package can learn the
lrstat package quickly. However, there are notable differences:
</p>

<ul>
<li><p> lrstat uses direct approximation, while rpact uses the Schoenfeld
method for log-rank test power and sample size calculation.
</p>
</li>
<li><p> lrstat uses <code>accrualDuration</code> to explicitly set the end of
accrual period, while rpact incorporates the end of accrual period
in <code>accrualTime</code>.
</p>
</li>
<li><p> lrstat considers the trial a failure at the last stage if
the log-rank test cannot reject the null hypothesis up to this
stage and cannot stop for futility at an earlier stage.
</p>
</li>
<li><p> the <code>lrsim</code> function uses the variance of the log-rank
test score statistic as the information.
</p>
</li></ul>

<p>In addition to the log-rank test power and sample size calculations,
the lrstat package can also be used for the following tasks:
</p>

<ul>
<li><p> design generic group sequential trials.
</p>
</li>
<li><p> design generic group sequential equivalence trials.
</p>
</li>
<li><p> design adaptive group sequential trials for changes in sample
size, error spending function, number and spacing or future looks.
</p>
</li>
<li><p> calculate the terminating and repeated confidence intervals for
standard and adaptive group sequential trials.
</p>
</li>
<li><p> calculate the conditional power for non-proportional hazards
with or without design changes.
</p>
</li>
<li><p> perform multiplicity adjustment based on graphical approaches
using weighted Bonferroni tests, Bonferroni mixture of weighted
Simes test, and Bonferroni mixture of Dunnett test as well as
group sequential trials with multiple hypotheses.
</p>
</li>
<li><p> perform multiplicity adjustment using stepwise gatekeeping
procedures for two sequences of hypotheses and the standard or
modified mixture gatekeeping procedures in the general case.
</p>
</li>
<li><p> design parallel-group trials with the primary endpoint
analyzed using mixed-model for repeated measures (MMRM).
</p>
</li>
<li><p> design crossover trials to estimate direct treatment
effects while accounting for carryover effects.
</p>
</li>
<li><p> design one-way repeated measures ANOVA trials.
</p>
</li>
<li><p> design two-way ANOVA trials.
</p>
</li>
<li><p> design Simon's 2-stage trials.
</p>
</li>
<li><p> design modified toxicity probability-2 (mTPI-2) trials.
</p>
</li>
<li><p> design Bayesian optimal interval (BOIN) trials.
</p>
</li>
<li><p> design group sequential trials for negative binomial
endpoints with censoring.
</p>
</li>
<li><p> design trials using Wilcoxon, Fisher's exact, and McNemar's test.
</p>
</li>
<li><p> calculate Clopper-Pearson confidence interval for single
proportions.
</p>
</li>
<li><p> calculate Brookmeyer-Crowley confidence interval for quantiles
of censored survival data.
</p>
</li>
<li><p> calculate Miettinen &amp; Nurminen confidence interval for stratified
risk difference, risk ratio, odds ratio, rate difference, and
rate ratio.
</p>
</li>
<li><p> perform power and sample size calculation for logistic regression.
</p>
</li>
<li><p> perform power and sample size calculation for Cohen's kappa.
</p>
</li>
<li><p> calculate Hedges' g effect size.
</p>
</li>
<li><p> generate random numbers from truncated piecewise exponential
distribution.
</p>
</li>
<li><p> perform power and sample size calculations for negative binomial
data.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Anastasios A. Tsiatis. Repeated significance testing for a general class
of statistics used in censored survival analysis. J Am Stat Assoc.
1982;77:855-861.
</p>
<p>Christopher Jennison, Bruce W. Turnbull. Group Sequential Methods with
Applications to Clinical Trials. Chapman &amp; Hall/CRC: Boca Raton, 2000,
ISBN:0849303168
</p>
<p>Kaifeng Lu. Sample size calculation for logrank test and prediction of
number of events over time. Pharm Stat. 2021;20:229-244.
</p>


<h3>See Also</h3>

<p>rpact, gsDesign
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lrpower(kMax = 2, informationRates = c(0.8, 1),
        criticalValues = c(2.250, 2.025), accrualIntensity = 20,
        piecewiseSurvivalTime = c(0, 6),
        lambda1 = c(0.0533, 0.0309), lambda2 = c(0.0533, 0.0533),
        gamma1 = 0.00427, gamma2 = 0.00427,
        accrualDuration = 22, followupTime = 18)

</code></pre>

<hr>
<h2 id='accrual'>Number of enrolled subjects</h2><span id='topic+accrual'></span>

<h3>Description</h3>

<p>Obtains the number of subjects enrolled by given calendar
times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>accrual(
  time = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  accrualDuration = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="accrual_+3A_time">time</code></td>
<td>
<p>A vector of calendar times at which to calculate the number
of enrolled subjects.</p>
</td></tr>
<tr><td><code id="accrual_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="accrual_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="accrual_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of total number of subjects enrolled by the
specified calendar times.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Uniform enrollment with 20 patients per month for 12 months.

accrual(time = 3, accrualTime = 0, accrualIntensity = 20,
        accrualDuration = 12)


# Example 2: Piecewise accrual, 10 patients per month for the first
# 3 months, and 20 patients per month thereafter. Patient recruitment
# ends at 12 months for the study.

accrual(time = c(2, 9), accrualTime = c(0, 3),
        accrualIntensity = c(10, 20), accrualDuration = 12)

</code></pre>

<hr>
<h2 id='ad'>Number of patients enrolled during an interval and having an event
by specified calendar times</h2><span id='topic+ad'></span>

<h3>Description</h3>

<p>Obtains the number of patients who are enrolled during a
specified enrollment time interval and have an event by the specified
calendar times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ad(
  time = NA_real_,
  u1 = NA_real_,
  u2 = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  lambda = NA_real_,
  gamma = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ad_+3A_time">time</code></td>
<td>
<p>A vector of calendar times at which to calculate the number
of patients having an event.</p>
</td></tr>
<tr><td><code id="ad_+3A_u1">u1</code></td>
<td>
<p>Lower bound of the accrual time interval.</p>
</td></tr>
<tr><td><code id="ad_+3A_u2">u2</code></td>
<td>
<p>Upper bound of the accrual time interval.</p>
</td></tr>
<tr><td><code id="ad_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="ad_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="ad_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="ad_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event. One for
each analysis time interval.</p>
</td></tr>
<tr><td><code id="ad_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of number of patients who are enrolled during a
specified enrollment time interval and have an event by the specified
calendar times for a given treatment group had the enrollment being
restricted to the treatment group. By definition, we must have
<code>time &gt;= u2</code>.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, 10 patients per month for the first 3 months, and
# 20 patients per month thereafter. Piecewise exponential survival with
# hazard 0.0533 in the first 6 months, and hazard 0.0309 thereafter,
# and 5% dropout by the end of 1 year.

ad(time = c(9, 15), u1 = 1, u2 = 8, accrualTime = c(0, 3),
   accrualIntensity = c(10, 20), piecewiseSurvivalTime=c(0, 6),
   lambda = c(0.0533, 0.0309), gamma = -log(1-0.05)/12)

</code></pre>

<hr>
<h2 id='adaptDesign'>Adaptive design at an interim look</h2><span id='topic+adaptDesign'></span>

<h3>Description</h3>

<p>Obtains the conditional power for specified incremental
information given the interim results, parameter value, and
data-dependent changes in the error spending function, and the number
and spacing of interim looks. Conversely, obtains the incremental
information needed to attain a specified conditional power given
the interim results, parameter value, and data-dependent changes
in the error spending function, and the number and spacing of
interim looks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adaptDesign(
  betaNew = NA_real_,
  INew = NA_real_,
  L = NA_integer_,
  zL = NA_real_,
  theta = NA_real_,
  IMax = NA_real_,
  kMax = NA_integer_,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  spendingTime = NA_real_,
  MullerSchafer = 0L,
  kNew = NA_integer_,
  informationRatesNew = NA_real_,
  efficacyStoppingNew = NA_integer_,
  futilityStoppingNew = NA_integer_,
  typeAlphaSpendingNew = "sfOF",
  parameterAlphaSpendingNew = NA_real_,
  typeBetaSpendingNew = "none",
  parameterBetaSpendingNew = NA_real_,
  userBetaSpendingNew = NA_real_,
  spendingTimeNew = NA_real_,
  varianceRatio = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adaptDesign_+3A_betanew">betaNew</code></td>
<td>
<p>The type II error for the secondary trial.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_inew">INew</code></td>
<td>
<p>The maximum information of the secondary trial. Either
<code>betaNew</code> or <code>INew</code> should be provided while the other one
should be missing.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_l">L</code></td>
<td>
<p>The interim adaptation look of the primary trial.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_zl">zL</code></td>
<td>
<p>The z-test statistic at the interim adaptation look of
the primary trial.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_theta">theta</code></td>
<td>
<p>The parameter value.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_imax">IMax</code></td>
<td>
<p>The maximum information of the primary trial. Must be
provided if <code>futilityBounds</code> is missing and
<code>typeBetaSpending</code> is not equal to &quot;none&quot;, or
if conditional power calculation is desired.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages of the primary trial.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates of the primary trial.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is
allowed at each stage of the primary trial. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is
allowed at each stage of the primary trial. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>The upper boundaries on the z-test statistic scale
for efficacy stopping for the primary trial.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_alpha">alpha</code></td>
<td>
<p>The significance level of the primary trial.
Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending for the primary
trial. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function,
&quot;user&quot; for user defined spending, and
&quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value of alpha spending
for the primary trial. Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;,
and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending for the primary
trial. Cumulative alpha spent up to each stage.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>The lower boundaries on the z-test statistic scale
for futility stopping for the primary trial. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending for the primary trial.
One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value of beta spending
for the primary trial. Corresponds to rho for &quot;sfKD&quot;,
and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_spendingtime">spendingTime</code></td>
<td>
<p>The error spending time of the primary trial.
Defaults to missing, in which case, it is the same as
<code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_mullerschafer">MullerSchafer</code></td>
<td>
<p>Whether to use the Muller and Schafer (2001) method
for trial adaptation.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_knew">kNew</code></td>
<td>
<p>The number of looks of the secondary trial.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_informationratesnew">informationRatesNew</code></td>
<td>
<p>The spacing of looks of the secondary trial.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_efficacystoppingnew">efficacyStoppingNew</code></td>
<td>
<p>The indicators of whether efficacy stopping is
allowed at each look of the secondary trial. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_futilitystoppingnew">futilityStoppingNew</code></td>
<td>
<p>The indicators of whether futility stopping is
allowed at each look of the secondary trial. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_typealphaspendingnew">typeAlphaSpendingNew</code></td>
<td>
<p>The type of alpha spending for the secondary
trial. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_parameteralphaspendingnew">parameterAlphaSpendingNew</code></td>
<td>
<p>The parameter value of alpha spending
for the secondary trial. Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;,
and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_typebetaspendingnew">typeBetaSpendingNew</code></td>
<td>
<p>The type of beta spending for the secondary
trial. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function,
&quot;user&quot; for user defined spending, and
&quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_parameterbetaspendingnew">parameterBetaSpendingNew</code></td>
<td>
<p>The parameter value of beta spending
for the secondary trial. Corresponds to rho for &quot;sfKD&quot;,
and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_userbetaspendingnew">userBetaSpendingNew</code></td>
<td>
<p>The user defined cumulative beta spending.
Cumulative beta spent up to each stage of the secondary trial.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_spendingtimenew">spendingTimeNew</code></td>
<td>
<p>The error spending time of the secondary trial.
Defaults to missing, in which case, it is the same as
<code>informationRatesNew</code>.</p>
</td></tr>
<tr><td><code id="adaptDesign_+3A_varianceratio">varianceRatio</code></td>
<td>
<p>The ratio of the variance under H0 to the
variance under H1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>adaptDesign</code> object with two list components:
</p>

<ul>
<li> <p><code>primaryTrial</code>: A list of selected information for the primary
trial, including <code>L</code>, <code>zL</code>, <code>theta</code>, <code>kMax</code>,
<code>informationRates</code>, <code>efficacyBounds</code>, <code>futilityBounds</code>,
and <code>MullerSchafer</code>.
</p>
</li>
<li> <p><code>secondaryTrial</code>: A <code>design</code> object for the secondary trial.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Lu Chi, H. M. James Hung, and Sue-Jane Wang.
Modification of sample size in group sequential clinical trials.
Biometrics 1999;55:853-857.
</p>
<p>Hans-Helge Muller and Helmut Schafer.
Adaptive group sequential designs for clinical trials:
Combining the advantages of adaptive and of
classical group sequential approaches.
Biometrics 2001;57:886-891.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getDesign">getDesign</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# original group sequential design with 90% power to detect delta = 6
delta = 6
sigma = 17
n = 282
(des1 = getDesign(IMax = n/(4*sigma^2), theta = delta, kMax = 3,
                  alpha = 0.05, typeAlphaSpending = "sfHSD",
                  parameterAlphaSpending = -4))

# interim look results
L = 1
n1 = n/3
delta1 = 4.5
sigma1 = 20
zL = delta1/sqrt(4/n1*sigma1^2)

t = des1$byStageResults$informationRates

# conditional power with sample size increase
(des2 = adaptDesign(
  betaNew = NA, INew = 420/(4*sigma1^2),
  L, zL, theta = delta1,
  IMax = n/(4*sigma1^2), kMax = 3, informationRates = t,
  alpha = 0.05, typeAlphaSpending = "sfHSD",
  parameterAlphaSpending = -4))

# Muller &amp; Schafer (2001) method to design the secondary trial:
# 3-look gamma(-2) spending with 84% power at delta = 4.5 and sigma = 20
(des2 = adaptDesign(
  betaNew = 0.16, INew = NA,
  L, zL, theta = delta1,
  IMax = n/(4*sigma1^2), kMax = 3, informationRates = t,
  alpha = 0.05, typeAlphaSpending = "sfHSD",
  parameterAlphaSpending = -4,
  MullerSchafer = TRUE,
  kNew = 3, typeAlphaSpendingNew = "sfHSD",
  parameterAlphaSpendingNew = -2))

# incremental sample size for sigma = 20
(nNew = 4*sigma1^2*des2$secondaryTrial$overallResults$information)

</code></pre>

<hr>
<h2 id='aml'>Acute myelogenous leukemia survival data from the survival package</h2><span id='topic+aml'></span>

<h3>Description</h3>

<p>Survival in patients with acute myelogenous leukemia.
</p>

<dl>
<dt><code>time</code></dt><dd><p>Survival or censoring time</p>
</dd>
<dt><code>status</code></dt><dd><p>censoring status</p>
</dd>
<dt><code>x</code></dt><dd><p>maintenance chemotherapy given or not</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>aml
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 23 rows and 3 columns.
</p>

<hr>
<h2 id='binary_tte_sim'>Simulation for a binary endpoint and a time-to-event endpoint</h2><span id='topic+binary_tte_sim'></span>

<h3>Description</h3>

<p>Performs simulation for two-endpoint two-arm group
sequential trials. The first endpoint is a binary endpoint and
the Mantel-Haenszel test is used to test risk difference.
The second endpoint is a time-to-event endpoint and the log-rank
test is used to test the treatment difference. The analysis times
of the first endpoint are determined by the specified calendar times,
while the analysis times for the second endpoint is based on the
planned number of events at each look. The binary endpoint is
assessed at the first post-treatment follow-up visit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binary_tte_sim(
  kMax1 = 1L,
  kMax2 = 1L,
  riskDiffH0 = 0,
  hazardRatioH0 = 1,
  allocation1 = 1L,
  allocation2 = 1L,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  globalOddsRatio = 1,
  pi1 = NA_real_,
  pi2 = NA_real_,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  delta1 = 0L,
  delta2 = 0L,
  upper1 = NA_real_,
  upper2 = NA_real_,
  accrualDuration = NA_real_,
  plannedTime = NA_real_,
  plannedEvents = NA_integer_,
  maxNumberOfIterations = 1000L,
  maxNumberOfRawDatasetsPerStage = 0L,
  seed = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binary_tte_sim_+3A_kmax1">kMax1</code></td>
<td>
<p>Number of stages for the binary endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_kmax2">kMax2</code></td>
<td>
<p>Number of stages for the time-to-event endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_riskdiffh0">riskDiffH0</code></td>
<td>
<p>Risk difference under the null hypothesis for the
binary endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_hazardratioh0">hazardRatioH0</code></td>
<td>
<p>Hazard ratio under the null hypothesis for the
time-to-event endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_allocation1">allocation1</code></td>
<td>
<p>Number of subjects in the treatment group in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_allocation2">allocation2</code></td>
<td>
<p>Number of subjects in the control group in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_globaloddsratio">globalOddsRatio</code></td>
<td>
<p>The global odds ratio of the Plackett copula.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_pi1">pi1</code></td>
<td>
<p>Response probabilities by stratum for the treatment group
for the binary endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_pi2">pi2</code></td>
<td>
<p>Response probabilities by stratum for the control group
for the binary endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the treatment group for the time-to-event
endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group for the time-to-event
endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for the treatment group.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_delta1">delta1</code></td>
<td>
<p>The hazard rate for exponential treatment discontinuation,
a vector of hazard rates for piecewise exponential treatment
discontinuation applicable for all strata, or a vector of hazard rates
for treatment discontinuation in each analysis time interval by
stratum for the treatment group for the binary endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_delta2">delta2</code></td>
<td>
<p>The hazard rate for exponential treatment discontinuation,
a vector of hazard rates for piecewise exponential treatment
discontinuation applicable for all strata, or a vector of hazard rates
for treatment discontinuation in each analysis time interval by
stratum for the control group for the binary endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_upper1">upper1</code></td>
<td>
<p>The protocol-specified treatment duration for the treatment
group.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_upper2">upper2</code></td>
<td>
<p>The protocol-specified treatment duration for the control
group.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_plannedtime">plannedTime</code></td>
<td>
<p>The calendar times for the analyses of the binary
endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_plannedevents">plannedEvents</code></td>
<td>
<p>The planned cumulative total number of events for
the time-to-event endpoint.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_maxnumberofiterations">maxNumberOfIterations</code></td>
<td>
<p>The number of simulation iterations.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_maxnumberofrawdatasetsperstage">maxNumberOfRawDatasetsPerStage</code></td>
<td>
<p>The number of raw datasets per
stage to extract.</p>
</td></tr>
<tr><td><code id="binary_tte_sim_+3A_seed">seed</code></td>
<td>
<p>The seed to reproduce the simulation results.
The seed from the environment will be used if left unspecified,</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We consider dual primary endpoints with endpoint 1 being a
binary endpoint and endpoint 2 being a time-to-event endpoint.
The analyses of endpoint 1 will be based on calendar times, while
the analyses of endpoint 2 will be based on the number of events.
Therefor the analyses of the two endpoints are not at the same
time points. The correlation between the two endpoints is
characterized by the global odds ratio of the Plackett copula.
In addition, the time-to-event endpoint will render the binary
endpoint as a non-responder, and so does the dropout. In addition,
the treatment discontinuation will impact the number of available
subjects for analysis. The administrative censoring will exclude
subjects from the analysis of the binary endpoint.
</p>


<h3>Value</h3>

<p>A list with 4 components:
</p>

<ul>
<li> <p><code>sumdataBIN</code>: A data frame of summary data by iteration and stage
for the binary endpoint:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage number, covering all stages even if
the trial stops at an interim look.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>accruals1</code>: The number of subjects enrolled at the stage for
the treatment group.
</p>
</li>
<li> <p><code>accruals2</code>: The number of subjects enrolled at the stage for
the control group.
</p>
</li>
<li> <p><code>totalAccruals</code>: The total number of subjects enrolled at
the stage.
</p>
</li>
<li> <p><code>source1</code>: The total number of subjects with response status
determined by the underlying latent response variable.
</p>
</li>
<li> <p><code>source2</code>: The total number of subjects with response status
(non-responder) determined by experiencing the event for the
time-to-event endpoint.
</p>
</li>
<li> <p><code>source3</code>: The total number of subjects with response status
(non-responder) determined by dropping out prior to the PTFU1
visit.
</p>
</li>
<li> <p><code>n1</code>: The number of subjects included in the analysis of
the binary endpoint for the treatment group.
</p>
</li>
<li> <p><code>n2</code>: The number of subjects included in the analysis of
the binary endpoint for the control group.
</p>
</li>
<li> <p><code>n</code>: The total number of subjects included in the analysis of
the binary endpoint at the stage.
</p>
</li>
<li> <p><code>y1</code>: The number of responders for the binary endpoint in
the treatment group.
</p>
</li>
<li> <p><code>y2</code>: The number of responders for the binary endpoint in
the control group.
</p>
</li>
<li> <p><code>y</code>: The total number of responders for the binary endpoint
at the stage.
</p>
</li>
<li> <p><code>riskDiff</code>: The estimated risk difference for the binary
endpoint.
</p>
</li>
<li> <p><code>seRiskDiff</code>: The standard error for risk difference based on
the Sato approximation.
</p>
</li>
<li> <p><code>mnStatistic</code>: The Mantel-Haenszel test Z-statistic for
the binary endpoint.
</p>
</li></ul>

</li>
<li> <p><code>sumdataTTE</code>: A data frame of summary data by iteration and stage
for the time-to-event endpoint:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>eventsNotAchieved</code>: Whether the target number of events
is not achieved for the iteration.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage number, covering all stages even if
the trial stops at an interim look.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>accruals1</code>: The number of subjects enrolled at the stage for
the treatment group.
</p>
</li>
<li> <p><code>accruals2</code>: The number of subjects enrolled at the stage for
the control group.
</p>
</li>
<li> <p><code>totalAccruals</code>: The total number of subjects enrolled at
the stage.
</p>
</li>
<li> <p><code>events1</code>: The number of events at the stage for
the treatment group.
</p>
</li>
<li> <p><code>events2</code>: The number of events at the stage for
the control group.
</p>
</li>
<li> <p><code>totalEvents</code>: The total number of events at the stage.
</p>
</li>
<li> <p><code>dropouts1</code>: The number of dropouts at the stage for
the treatment group.
</p>
</li>
<li> <p><code>dropouts2</code>: The number of dropouts at the stage for
the control group.
</p>
</li>
<li> <p><code>totalDropouts</code>: The total number of dropouts at the stage.
</p>
</li>
<li> <p><code>logRankStatistic</code>: The log-rank test Z-statistic for
the time-to-event endpoint.
</p>
</li></ul>

</li>
<li> <p><code>rawdataBIN</code> (exists if <code>maxNumberOfRawDatasetsPerStage</code> is a
positive integer): A data frame for subject-level data for the binary
endpoint for selected replications, containing the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage under consideration.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>subjectId</code>: The subject ID.
</p>
</li>
<li> <p><code>arrivalTime</code>: The enrollment time for the subject.
</p>
</li>
<li> <p><code>stratum</code>: The stratum for the subject.
</p>
</li>
<li> <p><code>treatmentGroup</code>: The treatment group (1 or 2) for the
subject.
</p>
</li>
<li> <p><code>survivalTime</code>: The underlying survival time for the
time-to-event endpoint for the subject.
</p>
</li>
<li> <p><code>dropoutTime</code>: The underlying dropout time for the
time-to-event endpoint for the subject.
</p>
</li>
<li> <p><code>ptfu1Time</code>:The underlying assessment time for the
binary endpoint for the subject.
</p>
</li>
<li> <p><code>timeUnderObservation</code>: The time under observation
since randomization for the binary endpoint for the subject.
</p>
</li>
<li> <p><code>responder</code>: Whether the subject is a responder for the
binary endpoint.
</p>
</li>
<li> <p><code>source</code>: The source of the determination of responder
status for the binary endpoint: = 1 based on the underlying
latent response variable, = 2 based on the occurrence of
the time-to-event endpoint before the assessment time of the
binary endpoint (imputed as a non-responder), = 3 based on
the dropout before the assessment time of the binary endpoint
(imputed as a non-responder), = 4 excluded from analysis
due to administrative censoring.
</p>
</li></ul>

</li>
<li> <p><code>rawdataTTE</code> (exists if <code>maxNumberOfRawDatasetsPerStage</code> is a
positive integer): A data frame for subject-level data for the
time-to-event endpoint for selected replications, containing the
following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage under consideration.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>subjectId</code>: The subject ID.
</p>
</li>
<li> <p><code>arrivalTime</code>: The enrollment time for the subject.
</p>
</li>
<li> <p><code>stratum</code>: The stratum for the subject.
</p>
</li>
<li> <p><code>treatmentGroup</code>: The treatment group (1 or 2) for the
subject.
</p>
</li>
<li> <p><code>survivalTime</code>: The underlying survival time for the
time-to-event endpoint for the subject.
</p>
</li>
<li> <p><code>dropoutTime</code>: The underlying dropout time for the
time-to-event endpoint for the subject.
</p>
</li>
<li> <p><code>timeUnderObservation</code>: The time under observation
since randomization for the time-to-event endpoint for the subject.
</p>
</li>
<li> <p><code>event</code>: Whether the subject experienced the event for the
time-to-event endpoint.
</p>
</li>
<li> <p><code>dropoutEvent</code>: Whether the subject dropped out for the
time-to-event endpoint.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tcut = c(0, 12, 36, 48)
surv = c(1, 0.95, 0.82, 0.74)
lambda2 = (log(surv[1:3]) - log(surv[2:4]))/(tcut[2:4] - tcut[1:3])

sim1 = binary_tte_sim(
  kMax1 = 1,
  kMax2 = 2,
  accrualTime = 0:8,
  accrualIntensity = c(((1:8) - 0.5)/8, 1)*40,
  piecewiseSurvivalTime = c(0,12,36),
  globalOddsRatio = 1,
  pi1 = 0.80,
  pi2 = 0.65,
  lambda1 = 0.65*lambda2,
  lambda2 = lambda2,
  gamma1 = -log(1-0.04)/12,
  gamma2 = -log(1-0.04)/12,
  delta1 = -log(1-0.02)/12,
  delta2 = -log(1-0.02)/12,
  upper1 = 15*28/30.4,
  upper2 = 12*28/30.4,
  accrualDuration = 20,
  plannedTime = 20 + 15*28/30.4,
  plannedEvents = c(130, 173),
  maxNumberOfIterations = 1000,
  maxNumberOfRawDatasetsPerStage = 1,
  seed = 314159)


</code></pre>

<hr>
<h2 id='BOINTable'>BOIN decision table</h2><span id='topic+BOINTable'></span>

<h3>Description</h3>

<p>Obtains the decision table for the Bayesian optimal
interval (BOIN) design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BOINTable(
  nMax = NA_integer_,
  pT = 0.3,
  phi1 = 0.6 * pT,
  phi2 = 1.4 * pT,
  a = 1,
  b = 1,
  pExcessTox = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BOINTable_+3A_nmax">nMax</code></td>
<td>
<p>The maximum number of subjects in a dose cohort.</p>
</td></tr>
<tr><td><code id="BOINTable_+3A_pt">pT</code></td>
<td>
<p>The target toxicity probability. Defaults to 0.3.</p>
</td></tr>
<tr><td><code id="BOINTable_+3A_phi1">phi1</code></td>
<td>
<p>The lower equivalence limit for target toxicity
probability.</p>
</td></tr>
<tr><td><code id="BOINTable_+3A_phi2">phi2</code></td>
<td>
<p>The upper equivalence limit for target toxicity
probability.</p>
</td></tr>
<tr><td><code id="BOINTable_+3A_a">a</code></td>
<td>
<p>The prior toxicity parameter for the beta prior.</p>
</td></tr>
<tr><td><code id="BOINTable_+3A_b">b</code></td>
<td>
<p>The prior non-toxicity parameter for the beta prior.</p>
</td></tr>
<tr><td><code id="BOINTable_+3A_pexcesstox">pExcessTox</code></td>
<td>
<p>The threshold for excessive toxicity, i.e.,
if Prob(p &gt; pT | Data) &gt; pExcessTox, then the current and
all higher doses will be excluded and never be used again
in the remainder of the trial to avoid any other subjects
receiving treatment at those doses. Defaults to 0.95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>BOINTable</code> object with the following
components:
</p>

<ul>
<li> <p><code>settings</code>: The input settings data frame with the following
variables:
</p>

<ul>
<li> <p><code>nMax</code>: The maximum number of subjects in a dose cohort.
</p>
</li>
<li> <p><code>pT</code>: The target toxicity probability.
</p>
</li>
<li> <p><code>phi1</code>: The lower equivalence limit for target toxicity
probability.
</p>
</li>
<li> <p><code>phi2</code>: The upper equivalence limit for target toxicity
probability.
</p>
</li>
<li> <p><code>lambda1</code>: The lower decision boundary for observed toxicity
probability.
</p>
</li>
<li> <p><code>lambda2</code>: The upper decision boundary for observed toxicity
probability.
</p>
</li>
<li> <p><code>a</code>: The prior toxicity parameter for the beta prior.
</p>
</li>
<li> <p><code>b</code>: The prior non-toxicity parameter for the beta prior.
</p>
</li>
<li> <p><code>pExcessTox</code>: The threshold for excessive toxicity.
</p>
</li></ul>

</li>
<li> <p><code>decisionDataFrame</code>: The decision data frame for the BOIN design.
It includes the following variables:
</p>

<ul>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>y</code>: The number of toxicities.
</p>
</li>
<li> <p><code>decision</code>: The dosing decision.
</p>
</li></ul>

</li>
<li> <p><code>decisionMatrix</code>: The decision matrix corresponding to the
decision data frame.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
BOINTable(nMax = 18, pT = 0.3, phi = 0.6*0.3, phi2 = 1.4*0.3)

</code></pre>

<hr>
<h2 id='caltime'>Calendar times for target number of events</h2><span id='topic+caltime'></span>

<h3>Description</h3>

<p>Obtains the calendar times needed to reach the target
number of subjects experiencing an event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caltime(
  nevents = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="caltime_+3A_nevents">nevents</code></td>
<td>
<p>A vector of target number of events.</p>
</td></tr>
<tr><td><code id="caltime_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="caltime_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="caltime_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="caltime_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="caltime_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="caltime_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="caltime_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="caltime_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="caltime_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="caltime_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="caltime_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="caltime_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of calendar times expected to yield the target
number of events.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.

caltime(nevents = c(24, 80), allocationRatioPlanned = 1,
        accrualTime = seq(0, 8),
        accrualIntensity = 26/9*seq(1, 9),
        piecewiseSurvivalTime = c(0, 6),
        stratumFraction = c(0.2, 0.8),
        lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
        lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
        gamma1 = -log(1-0.05)/12,
        gamma2 = -log(1-0.05)/12,
        accrualDuration = 22,
        followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='ClopperPearsonCI'>Clopper-Pearson confidence interval for one-sample proportion</h2><span id='topic+ClopperPearsonCI'></span>

<h3>Description</h3>

<p>Obtains the Clopper-Pearson exact confidence interval for
a one-sample proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ClopperPearsonCI(n, y, cilevel = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ClopperPearsonCI_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="ClopperPearsonCI_+3A_y">y</code></td>
<td>
<p>The number of responses.</p>
</td></tr>
<tr><td><code id="ClopperPearsonCI_+3A_cilevel">cilevel</code></td>
<td>
<p>The confidence interval level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>y</code>: The number of responses.
</p>
</li>
<li> <p><code>phat</code>: The observed proportion of responses.
</p>
</li>
<li> <p><code>lower</code>: The lower limit of the confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper limit of the confidence interval.
</p>
</li>
<li> <p><code>cilevel</code>: The confidence interval level.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ClopperPearsonCI(20, 3)

</code></pre>

<hr>
<h2 id='covrmst'>Covariance between restricted mean survival times</h2><span id='topic+covrmst'></span>

<h3>Description</h3>

<p>Obtains the covariance between restricted mean survival
times at two different time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covrmst(
  t2 = NA_real_,
  tau1 = NA_real_,
  tau2 = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  maxFollowupTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covrmst_+3A_t2">t2</code></td>
<td>
<p>The calendar time for analysis 2.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_tau1">tau1</code></td>
<td>
<p>The milestone time for analysis 1.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_tau2">tau2</code></td>
<td>
<p>The milestone time for analysis 2.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="covrmst_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event for the
active treatment group. One for each analysis time interval.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event for the
control group. One for each analysis time interval.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the active
treatment group.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the control group.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="covrmst_+3A_maxfollowuptime">maxFollowupTime</code></td>
<td>
<p>Follow-up time for the first enrolled subject.
For fixed followup, <code>maxFollowupTime = minFollowupTime</code>.
For variable followup,
<code>maxFollowupTime = accrualDuration + minFollowupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The covariance between the restricted mean survival times
for each treatment group.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
covrmst(t2 = 25, tau1 = 16, tau2 = 18, allocationRatioPlanned = 1,
        accrualTime = c(0, 3), accrualIntensity = c(10, 20),
        piecewiseSurvivalTime = c(0, 6),
        lambda1 = c(0.0533, 0.0309), lambda2 = c(0.0533, 0.0533),
        gamma1 = -log(1-0.05)/12, gamma2 = -log(1-0.05)/12,
        accrualDuration = 12, maxFollowupTime = 30)

</code></pre>

<hr>
<h2 id='errorSpent'>Error spending</h2><span id='topic+errorSpent'></span>

<h3>Description</h3>

<p>Obtains the error spent at given spending times
for the specified error spending function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>errorSpent(t, error, sf = "sfOF", sfpar = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="errorSpent_+3A_t">t</code></td>
<td>
<p>A vector of spending times, typically equal to information
fractions.</p>
</td></tr>
<tr><td><code id="errorSpent_+3A_error">error</code></td>
<td>
<p>The total error to spend.</p>
</td></tr>
<tr><td><code id="errorSpent_+3A_sf">sf</code></td>
<td>
<p>The spending function. One of the following: &quot;sfOF&quot; for
O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type spending
function, &quot;sfKD&quot; for Kim &amp; DeMets spending function, and &quot;sfHSD&quot; for
Hwang, Shi &amp; DeCani spending function. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="errorSpent_+3A_sfpar">sfpar</code></td>
<td>
<p>The parameter for the spending function. Corresponds to
rho for &quot;sfKD&quot; and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of errors spent up to the interim look.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>errorSpent(t = 0.5, error = 0.025, sf = "sfOF")
errorSpent(t = c(0.5, 0.75, 1), error = 0.025, sf = "sfHSD", sfpar = -4)

</code></pre>

<hr>
<h2 id='exitprob'>Stagewise exit probabilities</h2><span id='topic+exitprob'></span>

<h3>Description</h3>

<p>Obtains the stagewise exit probabilities for both efficacy
and futility stopping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exitprob(b, a = NA, theta = 0, I = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exitprob_+3A_b">b</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale.</p>
</td></tr>
<tr><td><code id="exitprob_+3A_a">a</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale. Defaults to
<code>c(rep(-6.0, kMax-1), b[kMax])</code> if left unspecified, where
<code>kMax = length(b)</code>.</p>
</td></tr>
<tr><td><code id="exitprob_+3A_theta">theta</code></td>
<td>
<p>Stagewise parameter of interest, e.g., <code>-U/V</code> for
weighted log-rank test, where <code>U</code> is the mean and <code>V</code> is
the variance of the weighted log-rank test score statistic at each
stage. For proportional hazards and conventional log-rank test, use the
scalar input, <code>theta = -log(HR)</code>. Defaults to 0 corresponding to
the null hypothesis.</p>
</td></tr>
<tr><td><code id="exitprob_+3A_i">I</code></td>
<td>
<p>Stagewise cumulative information, e.g., <code>V</code>, the variance
of the weighted log-rank test score statistic at each stage. For
conventional log-rank test, information can be approximated by
<code>phi*(1-phi)*D</code>, where <code>phi</code> is the probability of being
allocated to the active arm, and <code>D</code> is the total number of events
at each stage. Defaults to <code>seq(1, kMax)</code> if left unspecified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of stagewise exit probabilities:
</p>

<ul>
<li> <p><code>exitProbUpper</code>: The vector of efficacy stopping probabilities
</p>
</li>
<li> <p><code>exitProbLower</code>: The vector of futility stopping probabilities.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exitprob(b = c(3.471, 2.454, 2.004), theta = -log(0.6),
         I = c(50, 100, 150)/4)

exitprob(b = c(2.963, 2.359, 2.014),
         a = c(-0.264, 0.599, 2.014),
         theta = c(0.141, 0.204, 0.289),
         I = c(81, 121, 160))

</code></pre>

<hr>
<h2 id='fadjpbon'>Adjusted p-values for Bonferroni-based graphical approaches</h2><span id='topic+fadjpbon'></span>

<h3>Description</h3>

<p>Obtains the adjusted p-values for graphical approaches
using weighted Bonferroni tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fadjpbon(w, G, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fadjpbon_+3A_w">w</code></td>
<td>
<p>The vector of initial weights for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="fadjpbon_+3A_g">G</code></td>
<td>
<p>The initial transition matrix.</p>
</td></tr>
<tr><td><code id="fadjpbon_+3A_p">p</code></td>
<td>
<p>The raw p-values for elementary hypotheses.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of adjusted p-values.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Frank Bretz, Willi Maurer, Werner Brannath and Martin Posch. A
graphical approach to sequentially rejective multiple test
procedures. Statistics in Medicine. 2009; 28:586-604.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pvalues &lt;- matrix(c(0.01,0.005,0.015,0.022, 0.02,0.015,0.010,0.023),
                  nrow=2, ncol=4, byrow=TRUE)
w &lt;- c(0.5,0.5,0,0)
g &lt;- matrix(c(0,0,1,0,0,0,0,1,0,1,0,0,1,0,0,0),
            nrow=4, ncol=4, byrow=TRUE)
fadjpbon(w, g, pvalues)

</code></pre>

<hr>
<h2 id='fadjpdun'>Adjusted p-values for Dunnett-based graphical approaches</h2><span id='topic+fadjpdun'></span>

<h3>Description</h3>

<p>Obtains the adjusted p-values for graphical approaches
using weighted Dunnett tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fadjpdun(wgtmat, p, family = NULL, corr = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fadjpdun_+3A_wgtmat">wgtmat</code></td>
<td>
<p>The weight matrix for intersection hypotheses.</p>
</td></tr>
<tr><td><code id="fadjpdun_+3A_p">p</code></td>
<td>
<p>The raw p-values for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="fadjpdun_+3A_family">family</code></td>
<td>
<p>The matrix of family indicators for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="fadjpdun_+3A_corr">corr</code></td>
<td>
<p>The correlation matrix that should be used for the parametric
test. Can contain NAs for unknown correlations between families.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of adjusted p-values.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Frank Bretz, Martin Posch, Ekkehard Glimm, Florian Klinglmueller,
Willi Maurer, and Kornelius Rohmeyer. Graphical approach for multiple
comparison procedures using weighted Bonferroni, Simes, or
parameter tests. Biometrical Journal. 2011; 53:894-913.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pvalues &lt;- matrix(c(0.01,0.005,0.015,0.022, 0.02,0.015,0.010,0.023),
                  nrow=2, ncol=4, byrow=TRUE)
w &lt;- c(0.5,0.5,0,0)
g &lt;- matrix(c(0,0,1,0,0,0,0,1,0,1,0,0,1,0,0,0),
            nrow=4, ncol=4, byrow=TRUE)
wgtmat = fwgtmat(w,g)

family = matrix(c(1,1,0,0,0,0,1,1), nrow=2, ncol=4, byrow=TRUE)
corr = matrix(c(1,0.5,NA,NA, 0.5,1,NA,NA,
                NA,NA,1,0.5, NA,NA,0.5,1),
              nrow = 4, byrow = TRUE)
fadjpdun(wgtmat, pvalues, family, corr)

</code></pre>

<hr>
<h2 id='fadjpsim'>Adjusted p-values for Simes-based graphical approaches</h2><span id='topic+fadjpsim'></span>

<h3>Description</h3>

<p>Obtains the adjusted p-values for graphical approaches
using weighted Simes tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fadjpsim(wgtmat, p, family = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fadjpsim_+3A_wgtmat">wgtmat</code></td>
<td>
<p>The weight matrix for intersection hypotheses.</p>
</td></tr>
<tr><td><code id="fadjpsim_+3A_p">p</code></td>
<td>
<p>The raw p-values for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="fadjpsim_+3A_family">family</code></td>
<td>
<p>The matrix of family indicators for elementary hypotheses.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of adjusted p-values.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Frank Bretz, Martin Posch, Ekkehard Glimm, Florian Klinglmueller,
Willi Maurer, and Kornelius Rohmeyer. Graphical approach for multiple
comparison procedures using weighted Bonferroni, Simes, or
parameter tests. Biometrical Journal. 2011; 53:894-913.
</p>
<p>Kaifeng Lu. Graphical approaches using a Bonferroni mixture of weighted
Simes tests. Statistics in Medicine. 2016; 35:4041-4055.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pvalues &lt;- matrix(c(0.01,0.005,0.015,0.022, 0.02,0.015,0.010,0.023),
                  nrow=2, ncol=4, byrow=TRUE)
w &lt;- c(0.5,0.5,0,0)
g &lt;- matrix(c(0,0,1,0,0,0,0,1,0,1,0,0,1,0,0,0),
            nrow=4, ncol=4, byrow=TRUE)
wgtmat = fwgtmat(w,g)

family = matrix(c(1,1,0,0,0,0,1,1), nrow=2, ncol=4, byrow=TRUE)
fadjpsim(wgtmat, pvalues, family)

</code></pre>

<hr>
<h2 id='findInterval3'>Find interval numbers of indices</h2><span id='topic+findInterval3'></span>

<h3>Description</h3>

<p>The implementation of <code>findInterval()</code> in R from
Advanced R by Hadley Wickham. Given a vector of non-decreasing
breakpoints in v, find the interval containing each element of x; i.e.,
if <code>i &lt;- findInterval3(x,v)</code>, for each index <code>j</code> in <code>x</code>,
<code>v[i[j]] &lt;= x[j] &lt; v[i[j] + 1]</code>, where <code>v[0] := -Inf</code>,
<code>v[N+1] := +Inf</code>, and <code>N = length(v)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findInterval3(x, v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findInterval3_+3A_x">x</code></td>
<td>
<p>The numeric vector of interest.</p>
</td></tr>
<tr><td><code id="findInterval3_+3A_v">v</code></td>
<td>
<p>The vector of break points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of <code>length(x)</code> with values in <code>0:N</code> where
<code>N = length(v)</code>.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 2:18
v &lt;- c(5, 10, 15) # create two bins [5,10) and [10,15)
cbind(x, findInterval3(x, v))

</code></pre>

<hr>
<h2 id='fmodmix'>Adjusted p-values for modified mixture gatekeeping procedures</h2><span id='topic+fmodmix'></span>

<h3>Description</h3>

<p>Obtains the adjusted p-values for the modified gatekeeping
procedures for multiplicity problems involving serial and parallel
logical restrictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fmodmix(
  p,
  family = NULL,
  serial,
  parallel,
  gamma,
  test = "hommel",
  exhaust = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fmodmix_+3A_p">p</code></td>
<td>
<p>The raw p-values for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="fmodmix_+3A_family">family</code></td>
<td>
<p>The matrix of family indicators for the hypotheses.</p>
</td></tr>
<tr><td><code id="fmodmix_+3A_serial">serial</code></td>
<td>
<p>The matrix of serial rejection set for the hypotheses.</p>
</td></tr>
<tr><td><code id="fmodmix_+3A_parallel">parallel</code></td>
<td>
<p>The matrix of parallel rejection set for the hypotheses.</p>
</td></tr>
<tr><td><code id="fmodmix_+3A_gamma">gamma</code></td>
<td>
<p>The truncation parameters for each family. The truncation
parameter for the last family is automatically set to 1.</p>
</td></tr>
<tr><td><code id="fmodmix_+3A_test">test</code></td>
<td>
<p>The component multiple testing procedure. Options include
&quot;holm&quot;, &quot;hochberg&quot;, or &quot;hommel&quot;. Defaults to &quot;hommel&quot;.</p>
</td></tr>
<tr><td><code id="fmodmix_+3A_exhaust">exhaust</code></td>
<td>
<p>Whether to use alpha-exhausting component testing procedure
for the last family with active hypotheses. It defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of adjusted p-values.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Alex Dmitrienko, George Kordzakhia, and Thomas Brechenmacher.
Mixture-based gatekeeping procedures for multiplicity problems with
multiple sequences of hypotheses. Journal of Biopharmaceutical
Statistics. 2016; 26(4):758–780.
</p>
<p>George Kordzakhia, Thomas Brechenmacher, Eiji Ishida, Alex Dmitrienko,
Winston Wenxiang Zheng, and David Fuyuan Li. An enhanced mixture method
for constructing gatekeeping procedures in clinical trials.
Journal of Biopharmaceutical Statistics. 2018; 28(1):113–128.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p = c(0.0194, 0.0068, 0.0271, 0.0088, 0.0370, 0.0018, 0.0814, 0.0066)
family = matrix(c(1, 1, 0, 0, 0, 0, 0, 0,
                  0, 0, 1, 1, 0, 0, 0, 0,
                  0, 0, 0, 0, 1, 1, 0, 0,
                  0, 0, 0, 0, 0, 0, 1, 1),
                nrow=4, byrow=TRUE)

serial = matrix(c(0, 0, 0, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 0, 0,
                  1, 0, 0, 0, 0, 0, 0, 0,
                  0, 1, 0, 0, 0, 0, 0, 0,
                  0, 0, 1, 0, 0, 0, 0, 0,
                  0, 0, 0, 1, 0, 0, 0, 0,
                  0, 0, 0, 0, 1, 0, 0, 0,
                  0, 0, 0, 0, 0, 1, 0, 0),
                nrow=8, byrow=TRUE)

parallel = matrix(0, 8, 8)
gamma = c(0.6, 0.6, 0.6, 1)
fmodmix(p, family, serial, parallel, gamma, test = "hommel", exhaust = 1)

</code></pre>

<hr>
<h2 id='fquantile'>The quantiles of a survival distribution</h2><span id='topic+fquantile'></span>

<h3>Description</h3>

<p>Obtains the quantiles of a survival distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fquantile(S, probs, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fquantile_+3A_s">S</code></td>
<td>
<p>The survival function of a univariate survival time.</p>
</td></tr>
<tr><td><code id="fquantile_+3A_probs">probs</code></td>
<td>
<p>The numeric vector of probabilities.</p>
</td></tr>
<tr><td><code id="fquantile_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to S.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of <code>length(probs)</code> for the quantiles.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fquantile(pweibull, probs = c(0.25, 0.5, 0.75), 
          shape = 1.37, scale = 1/0.818, lower.tail = FALSE)

</code></pre>

<hr>
<h2 id='fseqbon'>Group sequential trials using Bonferroni-based graphical
approaches</h2><span id='topic+fseqbon'></span>

<h3>Description</h3>

<p>Obtains the test results for group sequential trials using
graphical approaches based on weighted Bonferroni tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fseqbon(
  w,
  G,
  alpha = 0.025,
  kMax,
  typeAlphaSpending = NULL,
  parameterAlphaSpending = NULL,
  incidenceMatrix = NULL,
  maxInformation = NULL,
  p,
  information,
  spendingTime = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fseqbon_+3A_w">w</code></td>
<td>
<p>The vector of initial weights for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="fseqbon_+3A_g">G</code></td>
<td>
<p>The initial transition matrix.</p>
</td></tr>
<tr><td><code id="fseqbon_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="fseqbon_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="fseqbon_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The vector of alpha spending functions.
Each element is one of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries, &quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function,
and &quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot; if not provided.</p>
</td></tr>
<tr><td><code id="fseqbon_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The vector of parameter values for the
alpha spending functions. Each element corresponds to the value of
Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, or gamma for &quot;sfHSD&quot;.
Defaults to missing if not provided.</p>
</td></tr>
<tr><td><code id="fseqbon_+3A_incidencematrix">incidenceMatrix</code></td>
<td>
<p>The incidence matrix indicating whether the
specific hypothesis will be tested at the given look. The number of
columns of incidenceMatrix must be equal to the maximum number of
study looks (<code>kMax</code>). If not provided, defaults to testing each
hypothesis at all study looks.</p>
</td></tr>
<tr><td><code id="fseqbon_+3A_maxinformation">maxInformation</code></td>
<td>
<p>The vector of target maximum information for each
hypothesis. Defaults to a vector of 1s if not provided.</p>
</td></tr>
<tr><td><code id="fseqbon_+3A_p">p</code></td>
<td>
<p>The matrix of raw p-values for each hypothesis by study look.</p>
</td></tr>
<tr><td><code id="fseqbon_+3A_information">information</code></td>
<td>
<p>The matrix of observed information for each hypothesis
by study look.</p>
</td></tr>
<tr><td><code id="fseqbon_+3A_spendingtime">spendingTime</code></td>
<td>
<p>The spending time for alpha spending by study look.
If not provided, it is the same as <code>informationRates</code> calculated
from <code>information</code> and <code>maxInformation</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector to indicate the first look the specific hypothesis is
rejected (0 if the hypothesis is not rejected).
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Willi Maurer and Frank Bretz. Multiple testing in group sequential
trials using graphical approaches. Statistics in Biopharmaceutical
Research. 2013; 5:311-320.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Case study from Maurer &amp; Bretz (2013)

fseqbon(
  w = c(0.5, 0.5, 0, 0),
  G = matrix(c(0, 0.5, 0.5, 0,  0.5, 0, 0, 0.5,
               0, 1, 0, 0,  1, 0, 0, 0),
             nrow=4, ncol=4, byrow=TRUE),
  alpha = 0.025,
  kMax = 3,
  typeAlphaSpending = rep("sfOF", 4),
  maxInformation = rep(1, 4),
  p = matrix(c(0.0062, 0.017, 0.009, 0.13,
               0.0002, 0.0035, 0.002, 0.06),
             nrow=4, ncol=2),
  information = matrix(c(rep(1/3, 4), rep(2/3, 4)),
                       nrow=4, ncol=2))


</code></pre>

<hr>
<h2 id='fstdmix'>Adjusted p-values for standard mixture gatekeeping procedures</h2><span id='topic+fstdmix'></span>

<h3>Description</h3>

<p>Obtains the adjusted p-values for the standard gatekeeping
procedures for multiplicity problems involving serial and parallel
logical restrictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fstdmix(
  p,
  family = NULL,
  serial,
  parallel,
  gamma,
  test = "hommel",
  exhaust = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fstdmix_+3A_p">p</code></td>
<td>
<p>The raw p-values for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="fstdmix_+3A_family">family</code></td>
<td>
<p>The matrix of family indicators for the hypotheses.</p>
</td></tr>
<tr><td><code id="fstdmix_+3A_serial">serial</code></td>
<td>
<p>The matrix of serial rejection set for the hypotheses.</p>
</td></tr>
<tr><td><code id="fstdmix_+3A_parallel">parallel</code></td>
<td>
<p>The matrix of parallel rejection set for the hypotheses.</p>
</td></tr>
<tr><td><code id="fstdmix_+3A_gamma">gamma</code></td>
<td>
<p>The truncation parameters for each family. The truncation
parameter for the last family is automatically set to 1.</p>
</td></tr>
<tr><td><code id="fstdmix_+3A_test">test</code></td>
<td>
<p>The component multiple testing procedure. Options include
&quot;holm&quot;, &quot;hochberg&quot;, or &quot;hommel&quot;. Defaults to &quot;hommel&quot;.</p>
</td></tr>
<tr><td><code id="fstdmix_+3A_exhaust">exhaust</code></td>
<td>
<p>Whether to use alpha-exhausting component testing procedure
for the last family with active hypotheses. It defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of adjusted p-values.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Alex Dmitrienko and Ajit C Tamhane. Mixtures of multiple testing
procedures for gatekeeping applications in clinical trials.
Statistics in Medicine. 2011; 30(13):1473–1488.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p = c(0.0194, 0.0068, 0.0271, 0.0088, 0.0370, 0.0018, 0.0814, 0.0066)
family = matrix(c(1, 1, 0, 0, 0, 0, 0, 0,
                  0, 0, 1, 1, 0, 0, 0, 0,
                  0, 0, 0, 0, 1, 1, 0, 0,
                  0, 0, 0, 0, 0, 0, 1, 1),
                nrow=4, byrow=TRUE)

serial = matrix(c(0, 0, 0, 0, 0, 0, 0, 0,
                  0, 0, 0, 0, 0, 0, 0, 0,
                  1, 0, 0, 0, 0, 0, 0, 0,
                  0, 1, 0, 0, 0, 0, 0, 0,
                  0, 0, 1, 0, 0, 0, 0, 0,
                  0, 0, 0, 1, 0, 0, 0, 0,
                  0, 0, 0, 0, 1, 0, 0, 0,
                  0, 0, 0, 0, 0, 1, 0, 0),
                nrow=8, byrow=TRUE)

parallel = matrix(0, 8, 8)
gamma = c(0.6, 0.6, 0.6, 1)
fstdmix(p, family, serial, parallel, gamma, test = "hommel", exhaust = 0)

</code></pre>

<hr>
<h2 id='fstp2seq'>Adjusted p-values for stepwise testing procedures for two sequences</h2><span id='topic+fstp2seq'></span>

<h3>Description</h3>

<p>Obtains the adjusted p-values for the stepwise gatekeeping
procedures for multiplicity problems involving two sequences of
hypotheses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fstp2seq(p, gamma, test = "hochberg", retest = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fstp2seq_+3A_p">p</code></td>
<td>
<p>The raw p-values for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="fstp2seq_+3A_gamma">gamma</code></td>
<td>
<p>The truncation parameters for each family. The truncation
parameter for the last family is automatically set to 1.</p>
</td></tr>
<tr><td><code id="fstp2seq_+3A_test">test</code></td>
<td>
<p>The component multiple testing procedure. It is either &quot;Holm&quot;
or &quot;Hochberg&quot;, and it defaults to &quot;Hochberg&quot;.</p>
</td></tr>
<tr><td><code id="fstp2seq_+3A_retest">retest</code></td>
<td>
<p>Whether to allow retesting. It defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of adjusted p-values.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p = c(0.0194, 0.0068, 0.0271, 0.0088, 0.0370, 0.0018, 0.0814, 0.0066)
gamma = c(0.6, 0.6, 0.6, 1)
fstp2seq(p, gamma, test="hochberg", retest=1)

</code></pre>

<hr>
<h2 id='ftrunc'>Adjusted p-values for Holm, Hochberg, and Hommel procedures</h2><span id='topic+ftrunc'></span>

<h3>Description</h3>

<p>Obtains the adjusted p-values for possibly truncated
Holm, Hochberg, and Hommel procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ftrunc(p, test = "hommel", gamma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ftrunc_+3A_p">p</code></td>
<td>
<p>The raw p-values for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="ftrunc_+3A_test">test</code></td>
<td>
<p>The test to use, e.g., &quot;holm&quot;, &quot;hochberg&quot;, or
&quot;hommel&quot; (default).</p>
</td></tr>
<tr><td><code id="ftrunc_+3A_gamma">gamma</code></td>
<td>
<p>The value of the truncation parameter. Defaults to 1
for the regular Holm, Hochberg, or Hommel procedure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of adjusted p-values.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Alex Dmitrienko, Ajit C. Tamhane, and Brian L. Wiens.
General multistage gatekeeping procedures.
Biometrical Journal. 2008; 5:667-677.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pvalues &lt;- matrix(c(0.01,0.005,0.015,0.022, 0.02,0.015,0.010,0.023),
                  nrow=2, ncol=4, byrow=TRUE)
ftrunc(pvalues, "hochberg")

</code></pre>

<hr>
<h2 id='fwgtmat'>Weight matrix for all intersection hypotheses</h2><span id='topic+fwgtmat'></span>

<h3>Description</h3>

<p>Obtains the weight matrix for all intersection hypotheses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fwgtmat(w, G)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fwgtmat_+3A_w">w</code></td>
<td>
<p>The vector of weights for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="fwgtmat_+3A_g">G</code></td>
<td>
<p>The transition matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The weight matrix starting with the global null hypothesis.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
w = c(0.5,0.5,0,0)
g = matrix(c(0,0,1,0, 0,0,0,1, 0,1,0,0, 1,0,0,0),
           nrow=4, ncol=4, byrow=TRUE)
(wgtmat = fwgtmat(w,g))

</code></pre>

<hr>
<h2 id='getAccrualDurationFromN'>Accrual duration to enroll target number of subjects</h2><span id='topic+getAccrualDurationFromN'></span>

<h3>Description</h3>

<p>Obtains the accrual duration to enroll the target number
of subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAccrualDurationFromN(
  nsubjects = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getAccrualDurationFromN_+3A_nsubjects">nsubjects</code></td>
<td>
<p>The vector of target number of subjects.</p>
</td></tr>
<tr><td><code id="getAccrualDurationFromN_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="getAccrualDurationFromN_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of accrual durations.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getAccrualDurationFromN(nsubjects = c(20, 150), accrualTime = c(0, 3),
                        accrualIntensity = c(10, 20))

</code></pre>

<hr>
<h2 id='getADCI'>Confidence interval after adaptation</h2><span id='topic+getADCI'></span>

<h3>Description</h3>

<p>Obtains the p-value, median unbiased point estimate, and
confidence interval after the end of an adaptive trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getADCI(
  L = NA_integer_,
  zL = NA_real_,
  IMax = NA_real_,
  kMax = NA_integer_,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.25,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  spendingTime = NA_real_,
  L2 = NA_integer_,
  zL2 = NA_real_,
  INew = NA_real_,
  MullerSchafer = 0L,
  informationRatesNew = NA_real_,
  efficacyStoppingNew = NA_integer_,
  typeAlphaSpendingNew = "sfOF",
  parameterAlphaSpendingNew = NA_real_,
  spendingTimeNew = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getADCI_+3A_l">L</code></td>
<td>
<p>The interim adaptation look of the primary trial.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_zl">zL</code></td>
<td>
<p>The z-test statistic at the interim adaptation look of
the primary trial.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_imax">IMax</code></td>
<td>
<p>The maximum information of the primary trial.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages of the primary trial.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates of the primary trial.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is
allowed at each stage of the primary trial. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>The upper boundaries on the z-test statistic scale
for efficacy stopping for the primary trial.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_alpha">alpha</code></td>
<td>
<p>The significance level of the primary trial.
Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending for the primary
trial. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value of alpha spending
for the primary trial. Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;,
and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_spendingtime">spendingTime</code></td>
<td>
<p>The error spending time of the primary trial.
Defaults to missing, in which case, it is the same as
<code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_l2">L2</code></td>
<td>
<p>The termination look of the secondary trial.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_zl2">zL2</code></td>
<td>
<p>The z-test statistic at the termination look of the
secondary trial.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_inew">INew</code></td>
<td>
<p>The maximum information of the secondary trial.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_mullerschafer">MullerSchafer</code></td>
<td>
<p>Whether to use the Muller and Schafer (2001) method
for trial adaptation.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_informationratesnew">informationRatesNew</code></td>
<td>
<p>The spacing of looks of the secondary trial
up to look <code>L2</code>.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_efficacystoppingnew">efficacyStoppingNew</code></td>
<td>
<p>The indicators of whether efficacy stopping is
allowed at each look of the secondary trial up to look <code>L2</code>.
Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_typealphaspendingnew">typeAlphaSpendingNew</code></td>
<td>
<p>The type of alpha spending for the secondary
trial. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_parameteralphaspendingnew">parameterAlphaSpendingNew</code></td>
<td>
<p>The parameter value of alpha spending
for the secondary trial. Corresponds to Delta for &quot;WT&quot;,
rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getADCI_+3A_spendingtimenew">spendingTimeNew</code></td>
<td>
<p>The error spending time of the secondary trial
up to look <code>L2</code>. Defaults to missing, in which case, it is
the same as <code>informationRatesNew</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>pvalue</code>: p-value for rejecting the null hypothesis.
</p>
</li>
<li> <p><code>thetahat</code>: Median unbiased point estimate of the parameter.
</p>
</li>
<li> <p><code>cilevel</code>: Confidence interval level.
</p>
</li>
<li> <p><code>lower</code>: Lower bound of confidence interval.
</p>
</li>
<li> <p><code>upper</code>: Upper bound of confidence interval.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Ping Gao, Lingyun Liu and Cyrus Mehta.
Exact inference for adaptive group sequential designs.
Stat Med. 2013;32(23):3991-4005.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+adaptDesign">adaptDesign</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# original group sequential design with 90% power to detect delta = 6
delta = 6
sigma = 17
n = 282
(des1 = getDesign(IMax = n/(4*sigma^2), theta = delta, kMax = 3,
                  alpha = 0.05, typeAlphaSpending = "sfHSD",
                  parameterAlphaSpending = -4))

# interim look results
L = 1
n1 = n/3
delta1 = 4.5
sigma1 = 20
zL = delta1/sqrt(4/n1*sigma1^2)

t = des1$byStageResults$informationRates

# Muller &amp; Schafer (2001) method to design the secondary trial:
des2 = adaptDesign(
  betaNew = 0.2, L = L, zL = zL, theta = 5,
  kMax = 3, informationRates = t,
  alpha = 0.05, typeAlphaSpending = "sfHSD",
  parameterAlphaSpending = -4,
  MullerSchafer = TRUE,
  kNew = 3, typeAlphaSpendingNew = "sfHSD",
  parameterAlphaSpendingNew = -2)

n2 = ceiling(des2$secondaryTrial$overallResults$information*4*20^2)
ns = round(n2*(1:3)/3)
 (des2 = adaptDesign(
   INew = n2/(4*20^2), L = L, zL = zL, theta = 5,
   kMax = 3, informationRates = t,
   alpha = 0.05, typeAlphaSpending = "sfHSD",
   parameterAlphaSpending = -4,
   MullerSchafer = TRUE,
   kNew = 3, informationRatesNew = ns/n2,
   typeAlphaSpendingNew = "sfHSD",
   parameterAlphaSpendingNew = -2))

# termination at the second look of the secondary trial
L2 = 2
delta2 = 6.86
sigma2 = 21.77
zL2 = delta2/sqrt(4/197*sigma2^2)

t2 = des2$secondaryTrial$byStageResults$informationRates[1:L2]

# confidence interval
getADCI(L = L, zL = zL,
        IMax = n/(4*sigma1^2), kMax = 3,
        informationRates = t,
        alpha = 0.05, typeAlphaSpending = "sfHSD",
        parameterAlphaSpending = -4,
        L2 = L2, zL2 = zL2,
        INew = n2/(4*sigma2^2),
        MullerSchafer = TRUE,
        informationRatesNew = t2,
        typeAlphaSpendingNew = "sfHSD",
        parameterAlphaSpendingNew = -2)

</code></pre>

<hr>
<h2 id='getADRCI'>Repeated confidence interval after adaptation</h2><span id='topic+getADRCI'></span>

<h3>Description</h3>

<p>Obtains the repeated p-value, conservative point estimate,
and repeated confidence interval for an adaptive group sequential trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getADRCI(
  L = NA_integer_,
  zL = NA_real_,
  IMax = NA_real_,
  kMax = NA_integer_,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  spendingTime = NA_real_,
  L2 = NA_integer_,
  zL2 = NA_real_,
  INew = NA_real_,
  MullerSchafer = 0L,
  informationRatesNew = NA_real_,
  efficacyStoppingNew = NA_integer_,
  typeAlphaSpendingNew = "sfOF",
  parameterAlphaSpendingNew = NA_real_,
  spendingTimeNew = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getADRCI_+3A_l">L</code></td>
<td>
<p>The interim adaptation look of the primary trial.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_zl">zL</code></td>
<td>
<p>The z-test statistic at the interim adaptation look of
the primary trial.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_imax">IMax</code></td>
<td>
<p>The maximum information of the primary trial.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages of the primary trial.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates of the primary trial.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is
allowed at each stage of the primary trial. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>The upper boundaries on the z-test statistic scale
for efficacy stopping for the primary trial.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_alpha">alpha</code></td>
<td>
<p>The significance level of the primary trial.
Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending for the primary
trial. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value of alpha spending
for the primary trial. Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;,
and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_spendingtime">spendingTime</code></td>
<td>
<p>The error spending time of the primary trial.
Defaults to missing, in which case, it is the same as
<code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_l2">L2</code></td>
<td>
<p>The look of interest in the secondary trial.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_zl2">zL2</code></td>
<td>
<p>The z-test statistic at the look of the secondary trial.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_inew">INew</code></td>
<td>
<p>The maximum information of the secondary trial.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_mullerschafer">MullerSchafer</code></td>
<td>
<p>Whether to use the Muller and Schafer (2001) method
for trial adaptation.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_informationratesnew">informationRatesNew</code></td>
<td>
<p>The spacing of looks of the secondary trial.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_efficacystoppingnew">efficacyStoppingNew</code></td>
<td>
<p>The indicators of whether efficacy stopping is
allowed at each look of the secondary trial up to look <code>L2</code>.
Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_typealphaspendingnew">typeAlphaSpendingNew</code></td>
<td>
<p>The type of alpha spending for the secondary
trial. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_parameteralphaspendingnew">parameterAlphaSpendingNew</code></td>
<td>
<p>The parameter value of alpha spending
for the secondary trial. Corresponds to Delta for &quot;WT&quot;,
rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getADRCI_+3A_spendingtimenew">spendingTimeNew</code></td>
<td>
<p>The error spending time of the secondary trial.
up to look <code>L2</code>. Defaults to missing, in which case, it is
the same as <code>informationRatesNew</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>pvalue</code>: Repeated p-value for rejecting the null hypothesis.
</p>
</li>
<li> <p><code>thetahat</code>: Point estimate of the parameter.
</p>
</li>
<li> <p><code>cilevel</code>: Confidence interval level.
</p>
</li>
<li> <p><code>lower</code>: Lower bound of repeated confidence interval.
</p>
</li>
<li> <p><code>upper</code>: Upper bound of repeated confidence interval.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Cyrus R. Mehta, Peter Bauer, Martin Posch and Werner Brannath.
Repeated confidence intervals for adaptive group sequential trials.
Stat Med. 2007;26:5422–5433.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+adaptDesign">adaptDesign</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# original group sequential design with 90% power to detect delta = 6
delta = 6
sigma = 17
n = 282
(des1 = getDesign(IMax = n/(4*sigma^2), theta = delta, kMax = 3,
                  alpha = 0.05, typeAlphaSpending = "sfHSD",
                  parameterAlphaSpending = -4))

# interim look results
L = 1
n1 = n/3
delta1 = 4.5
sigma1 = 20
zL = delta1/sqrt(4/n1*sigma1^2)

t = des1$byStageResults$informationRates

# Muller &amp; Schafer (2001) method to design the secondary trial:
des2 = adaptDesign(
  betaNew = 0.2, L = L, zL = zL, theta = 5,
  kMax = 3, informationRates = t,
  alpha = 0.05, typeAlphaSpending = "sfHSD",
  parameterAlphaSpending = -4,
  MullerSchafer = TRUE,
  kNew = 3, typeAlphaSpendingNew = "sfHSD",
  parameterAlphaSpendingNew = -2)

n2 = ceiling(des2$secondaryTrial$overallResults$information*4*20^2)
ns = round(n2*(1:3)/3)
(des2 = adaptDesign(
  INew = n2/(4*20^2), L = L, zL = zL, theta = 5,
  kMax = 3, informationRates = t,
  alpha = 0.05, typeAlphaSpending = "sfHSD",
  parameterAlphaSpending = -4,
  MullerSchafer = TRUE,
  kNew = 3, informationRatesNew = ns/n2,
  typeAlphaSpendingNew = "sfHSD",
  parameterAlphaSpendingNew = -2))

# termination at the second look of the secondary trial
L2 = 2
delta2 = 6.86
sigma2 = 21.77
zL2 = delta2/sqrt(4/197*sigma2^2)

t2 = des2$secondaryTrial$byStageResults$informationRates[1:L2]

# repeated confidence interval
getADRCI(L = L, zL = zL,
         IMax = n/(4*sigma1^2), kMax = 3,
         informationRates = t,
         alpha = 0.05, typeAlphaSpending = "sfHSD",
         parameterAlphaSpending = -4,
         L2 = L2, zL2 = zL2,
         INew = n2/(4*sigma2^2),
         MullerSchafer = TRUE,
         informationRatesNew = t2,
         typeAlphaSpendingNew = "sfHSD",
         parameterAlphaSpendingNew = -2)

</code></pre>

<hr>
<h2 id='getBound'>Efficacy boundaries for group sequential design</h2><span id='topic+getBound'></span>

<h3>Description</h3>

<p>Obtains the efficacy stopping boundaries for a group
sequential design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBound(
  k = NA,
  informationRates = NA,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA,
  userAlphaSpending = NA,
  spendingTime = NA,
  efficacyStopping = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBound_+3A_k">k</code></td>
<td>
<p>Look number for the current analysis.</p>
</td></tr>
<tr><td><code id="getBound_+3A_informationrates">informationRates</code></td>
<td>
<p>Information rates up to the current look. Must be
increasing and less than or equal to 1.</p>
</td></tr>
<tr><td><code id="getBound_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getBound_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getBound_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getBound_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getBound_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>k</code> for the error spending
time at each analysis. Must be increasing and less than or equal to 1.
Defaults to missing, in which case, it is the same as
<code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="getBound_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>typeAlphaSpending</code> is &quot;OF&quot;, &quot;P&quot;, or &quot;WT&quot;, then the boundaries
will be based on equally spaced looks.
</p>


<h3>Value</h3>

<p>A numeric vector of critical values up to the current look.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
getBound(k = 2, informationRates = c(0.5,1),
         alpha = 0.025, typeAlphaSpending = "sfOF")

</code></pre>

<hr>
<h2 id='getCI'>Confidence interval after trial termination</h2><span id='topic+getCI'></span>

<h3>Description</h3>

<p>Obtains the p-value, median unbiased point estimate, and
confidence interval after the end of a group sequential trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCI(
  L = NA_integer_,
  zL = NA_real_,
  IMax = NA_real_,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getCI_+3A_l">L</code></td>
<td>
<p>The termination look.</p>
</td></tr>
<tr><td><code id="getCI_+3A_zl">zL</code></td>
<td>
<p>The z-test statistic at the termination look.</p>
</td></tr>
<tr><td><code id="getCI_+3A_imax">IMax</code></td>
<td>
<p>The maximum information of the trial.</p>
</td></tr>
<tr><td><code id="getCI_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates up to look <code>L</code>.</p>
</td></tr>
<tr><td><code id="getCI_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is
allowed at each stage up to look <code>L</code>.
Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getCI_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>The upper boundaries on the z-test statistic scale
for efficacy stopping up to look <code>L</code>.</p>
</td></tr>
<tr><td><code id="getCI_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getCI_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending.
One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getCI_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value of alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getCI_+3A_spendingtime">spendingTime</code></td>
<td>
<p>The error spending time up to look <code>L</code>.
Defaults to missing, in which case, it is the same as
<code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following components:
</p>

<ul>
<li> <p><code>pvalue</code>: p-value for rejecting the null hypothesis.
</p>
</li>
<li> <p><code>thetahat</code>: Median unbiased point estimate of the parameter.
</p>
</li>
<li> <p><code>cilevel</code>: Confidence interval level.
</p>
</li>
<li> <p><code>lower</code>: Lower bound of confidence interval.
</p>
</li>
<li> <p><code>upper</code>: Upper bound of confidence interval.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Anastasios A. Tsiatis, Gary L. Rosner and Cyrus R. Mehta.
Exact confidence intervals following a group sequential test.
Biometrics 1984;40:797-803.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# group sequential design with 90% power to detect delta = 6
delta = 6
sigma = 17
n = 282
(des1 = getDesign(IMax = n/(4*sigma^2), theta = delta, kMax = 3,
                  alpha = 0.05, typeAlphaSpending = "sfHSD",
                  parameterAlphaSpending = -4))

# crossed the boundary at the second look
L = 2
n1 = n*2/3
delta1 = 7
sigma1 = 20
zL = delta1/sqrt(4/n1*sigma1^2)

# confidence interval
getCI(L = L, zL = zL, IMax = n/(4*sigma1^2),
      informationRates = c(1/3, 2/3), alpha = 0.05,
      typeAlphaSpending = "sfHSD", parameterAlphaSpending = -4)

</code></pre>

<hr>
<h2 id='getCP'>Conditional power allowing for varying parameter values</h2><span id='topic+getCP'></span>

<h3>Description</h3>

<p>Obtains the conditional power for specified incremental
information given the interim results, parameter values, and
data-dependent changes in the error spending function, as well as the
number and spacing of interim looks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCP(
  INew = NA_real_,
  L = NA_integer_,
  zL = NA_real_,
  theta = NA_real_,
  IMax = NA_real_,
  kMax = NA_integer_,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  spendingTime = NA_real_,
  MullerSchafer = 0L,
  kNew = NA_integer_,
  informationRatesNew = NA_real_,
  efficacyStoppingNew = NA_integer_,
  futilityStoppingNew = NA_integer_,
  typeAlphaSpendingNew = "sfOF",
  parameterAlphaSpendingNew = NA_real_,
  typeBetaSpendingNew = "none",
  parameterBetaSpendingNew = NA_real_,
  spendingTimeNew = NA_real_,
  varianceRatio = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getCP_+3A_inew">INew</code></td>
<td>
<p>The maximum information of the secondary trial.</p>
</td></tr>
<tr><td><code id="getCP_+3A_l">L</code></td>
<td>
<p>The interim adaptation look of the primary trial.</p>
</td></tr>
<tr><td><code id="getCP_+3A_zl">zL</code></td>
<td>
<p>The z-test statistic at the interim adaptation look of
the primary trial.</p>
</td></tr>
<tr><td><code id="getCP_+3A_theta">theta</code></td>
<td>
<p>A scalar or a vector of parameter values of
length <code>kMax + kMax - L</code> if <code>MullerSchafer = FALSE</code> or
length <code>kMax + kNew</code> if <code>MullerSchafer = TRUE</code>.</p>
</td></tr>
<tr><td><code id="getCP_+3A_imax">IMax</code></td>
<td>
<p>The maximum information of the primary trial.</p>
</td></tr>
<tr><td><code id="getCP_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages of the primary trial.</p>
</td></tr>
<tr><td><code id="getCP_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates of the primary trial.</p>
</td></tr>
<tr><td><code id="getCP_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is
allowed at each stage of the primary trial. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="getCP_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is
allowed at each stage of the primary trial. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="getCP_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>The upper boundaries on the z-test statistic scale
for efficacy stopping for the primary trial.</p>
</td></tr>
<tr><td><code id="getCP_+3A_alpha">alpha</code></td>
<td>
<p>The significance level of the primary trial.
Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getCP_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending for the primary
trial. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function,
&quot;user&quot; for user defined spending, and
&quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getCP_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value of alpha spending
for the primary trial. Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;,
and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getCP_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending for the primary
trial. Cumulative alpha spent up to each stage.</p>
</td></tr>
<tr><td><code id="getCP_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>The lower boundaries on the z-test statistic scale
for futility stopping for the primary trial. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getCP_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending for the primary trial.
One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getCP_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value of beta spending
for the primary trial. Corresponds to rho for &quot;sfKD&quot;,
and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getCP_+3A_spendingtime">spendingTime</code></td>
<td>
<p>The error spending time of the primary trial.
Defaults to missing, in which case, it is the same as
<code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="getCP_+3A_mullerschafer">MullerSchafer</code></td>
<td>
<p>Whether to use the Muller and Schafer (2001) method
for trial adaptation.</p>
</td></tr>
<tr><td><code id="getCP_+3A_knew">kNew</code></td>
<td>
<p>The number of looks of the secondary trial.</p>
</td></tr>
<tr><td><code id="getCP_+3A_informationratesnew">informationRatesNew</code></td>
<td>
<p>The spacing of looks of the secondary trial.</p>
</td></tr>
<tr><td><code id="getCP_+3A_efficacystoppingnew">efficacyStoppingNew</code></td>
<td>
<p>The indicators of whether efficacy stopping is
allowed at each look of the secondary trial. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="getCP_+3A_futilitystoppingnew">futilityStoppingNew</code></td>
<td>
<p>The indicators of whether futility stopping is
allowed at each look of the secondary trial. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="getCP_+3A_typealphaspendingnew">typeAlphaSpendingNew</code></td>
<td>
<p>The type of alpha spending for the secondary
trial. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getCP_+3A_parameteralphaspendingnew">parameterAlphaSpendingNew</code></td>
<td>
<p>The parameter value of alpha spending
for the secondary trial. Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;,
and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getCP_+3A_typebetaspendingnew">typeBetaSpendingNew</code></td>
<td>
<p>The type of beta spending for the secondary
trial. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getCP_+3A_parameterbetaspendingnew">parameterBetaSpendingNew</code></td>
<td>
<p>The parameter value of beta spending
for the secondary trial. Corresponds to rho for &quot;sfKD&quot;,
and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getCP_+3A_spendingtimenew">spendingTimeNew</code></td>
<td>
<p>The error spending time of the secondary trial.
Defaults to missing, in which case, it is the same as
<code>informationRatesNew</code>.</p>
</td></tr>
<tr><td><code id="getCP_+3A_varianceratio">varianceRatio</code></td>
<td>
<p>The ratio of the variance under H0 to the variance
under H1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The conditional power given the interim results, parameter
values, and data-dependent design changes.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Cyrus R. Mehta and Stuart J. Pocock.
Adaptive increase in sample size when interim results are promising:
A practical guide with examples.
Stat Med. 2011;30:3267–3284.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getDesign">getDesign</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Conditional power calculation with delayed treatment effect

# Two interim analyses have occurred with 179 and 266 events,
# respectively. The observed hazard ratio at the second interim
# look is 0.81.

trialsdt = as.Date("2020-03-04")                       # trial start date
iadt = c(as.Date("2022-02-01"), as.Date("2022-11-01")) # interim dates
mo1 = as.numeric(iadt - trialsdt + 1)/30.4375          # interim months

# Assume a piecewise Poisson enrollment process with a 8-month ramp-up
# and 521 patients were enrolled after 17.94 months
N = 521                   # total number of patients
Ta = 17.94                # enrollment duration
Ta1 = 8                   # assumed end of enrollment ramp-up
enrate = N / (Ta - Ta1/2) # enrollment rate after ramp-up

# Assume a median survival of 16.7 months for the control group, a
# 5-month delay in treatment effect, and a hazard ratio of 0.7 after
# the delay
lam1 = log(2)/16.7  # control group hazard of exponential distribution
t1 = 5              # months of delay in treatment effect
hr = 0.7            # hazard ratio after delay
lam2 = hr*lam1      # treatment group hazard after delay

# Assume an annual dropout rate of 5%
gam = -log(1-0.05)/12  # hazard for dropout

# The original target number of events was 298 and the new target is 335
mo2 &lt;- caltime(
  nevents = c(298, 335),
  allocationRatioPlanned = 1,
  accrualTime = seq(0, Ta1),
  accrualIntensity = enrate*seq(1, Ta1+1)/(Ta1+1),
  piecewiseSurvivalTime = c(0, t1),
  lambda1 = c(lam1, lam2),
  lambda2 = c(lam1, lam1),
  gamma1 = gam,
  gamma2 = gam,
  accrualDuration = Ta,
  followupTime = 1000)

# expected number of events and average hazard ratios
(lr1 &lt;- lrstat(
  time = c(mo1, mo2),
  accrualTime = seq(0, Ta1),
  accrualIntensity = enrate*seq(1, Ta1+1)/(Ta1+1),
  piecewiseSurvivalTime = c(0, t1),
  lambda1 = c(lam1, lam2),
  lambda2 = c(lam1, lam1),
  gamma1 = gam,
  gamma2 = gam,
  accrualDuration = Ta,
  followupTime = 1000,
  predictTarget = 3))


hr2 = 0.81                    # observed hazard ratio at interim 2
z2 = (-log(hr2))*sqrt(266/4)  # corresponding z-test statistic value

# expected mean of -log(HR) at the original looks and the new final look
theta = -log(lr1$HR[c(1,2,3,4)])

# conditional power with sample size increase
getCP(INew = (335 - 266)/4,
      L = 2, zL = z2, theta = theta,
      IMax = 298/4, kMax = 3,
      informationRates = c(179, 266, 298)/298,
      alpha = 0.025, typeAlphaSpending = "sfOF")

</code></pre>

<hr>
<h2 id='getDesign'>Power and sample size for a generic group sequential design</h2><span id='topic+getDesign'></span>

<h3>Description</h3>

<p>Obtains the maximum information and stopping boundaries
for a generic group sequential design assuming a constant treatment
effect, or obtains the power given the maximum information and
stopping boundaries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesign(
  beta = NA_real_,
  IMax = NA_real_,
  theta = NA_real_,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_,
  varianceRatio = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesign_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_imax">IMax</code></td>
<td>
<p>The maximum information. Either <code>beta</code> or <code>IMax</code>
should be provided while the other one should be missing.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_theta">theta</code></td>
<td>
<p>The parameter value.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="getDesign_+3A_varianceratio">varianceRatio</code></td>
<td>
<p>The ratio of the variance under H0 to the
variance under H1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>design</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyTheta</code>: The efficacy boundaries on the parameter
scale.
</p>
</li>
<li> <p><code>futilityTheta</code>: The futility boundaries on the parameter
scale.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for
futility stopping under H0.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta
spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>varianceRatio</code>: The ratio of the variance under H0
to the variance under H1.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Christopher Jennison, Bruce W. Turnbull. Group Sequential Methods with
Applications to Clinical Trials. Chapman &amp; Hall/CRC: Boca Raton, 2000,
ISBN:0849303168
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: obtain the maximum information given power
(design1 &lt;- getDesign(
  beta = 0.2, theta = -log(0.7),
  kMax = 2, informationRates = c(0.5,1),
  alpha = 0.025, typeAlphaSpending = "sfOF",
  typeBetaSpending = "sfP"))

# Example 2: obtain power given the maximum information
(design2 &lt;- getDesign(
  IMax = 72.5, theta = -log(0.7),
  kMax = 3, informationRates = c(0.5, 0.75, 1),
  alpha = 0.025, typeAlphaSpending = "sfOF",
  typeBetaSpending = "sfP"))

</code></pre>

<hr>
<h2 id='getDesignAgreement'>Power and sample size for Cohen's kappa</h2><span id='topic+getDesignAgreement'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for Cohen's kappa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignAgreement(
  beta = NA_real_,
  n = NA_real_,
  ncats = NA_integer_,
  kappaH0 = NA_real_,
  kappa = NA_real_,
  p1 = NA_real_,
  p2 = NA_real_,
  rounding = TRUE,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignAgreement_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignAgreement_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignAgreement_+3A_ncats">ncats</code></td>
<td>
<p>The number of categories.</p>
</td></tr>
<tr><td><code id="getDesignAgreement_+3A_kappah0">kappaH0</code></td>
<td>
<p>The kappa coefficient under the null hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignAgreement_+3A_kappa">kappa</code></td>
<td>
<p>The kappa coefficient under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignAgreement_+3A_p1">p1</code></td>
<td>
<p>The marginal probabilities for the first rater.</p>
</td></tr>
<tr><td><code id="getDesignAgreement_+3A_p2">p2</code></td>
<td>
<p>The marginal probabilities for the second rater.
Defaults to be equal to the marginal probabilities for the first
rater if not provided.</p>
</td></tr>
<tr><td><code id="getDesignAgreement_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignAgreement_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The kappa coefficient is defined as
</p>
<p style="text-align: center;"><code class="reqn">\kappa = \frac{\pi_o - \pi_e}{1 - \pi_e},</code>
</p>
<p> where
<code class="reqn">\pi_o = \sum_i \pi_{ii}</code> is the observed agreement, and
<code class="reqn">\pi_e = \sum_i \pi_{i.} \pi_{.i}</code> is the expected agreement
by chance.
</p>
<p>By Fleiss et al. (1969), the variance of <code class="reqn">\hat{\kappa}</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">Var(\hat{\kappa}) = \frac{v_1}{n},</code>
</p>
<p> where
</p>
<p style="text-align: center;"><code class="reqn">v_1 = \frac{Q_1 + Q_2 - Q3 - Q4}{(1-\pi_e)^4},</code>
</p>

<p style="text-align: center;"><code class="reqn">Q_1 = \pi_o(1-\pi_e)^2,</code>
</p>

<p style="text-align: center;"><code class="reqn">Q_2 = (1-\pi_o)^2 \sum_i \sum_j \pi_{ij}(\pi_{i.} + \pi_{.j})^2,</code>
</p>

<p style="text-align: center;"><code class="reqn">Q_3 = 2(1-\pi_o)(1-\pi_e) \sum_i \pi_{ii}(\pi_{i.} + \pi_{.i}),</code>
</p>

<p style="text-align: center;"><code class="reqn">Q_4 = (\pi_o \pi_e - 2\pi_e + \pi_o)^2.</code>
</p>

<p>Given <code class="reqn">\kappa</code> and marginals
<code class="reqn">\{(\pi_{i.}, \pi_{.i}): i=1,\ldots,k\}</code>,
we obtain <code class="reqn">\pi_o</code>. The only unknowns are the double summation
in <code class="reqn">Q_2</code> and the single summation in <code class="reqn">Q_3</code>.
</p>
<p>We find the optimal configuration of cell probabilities that yield the
maximum variance of <code class="reqn">\hat{\kappa}</code> by treating the problem as a
linear programming problem with constraints to match the given
marginal probabilities and the observed agreement and ensure that
the cell probabilities are nonnegative. This is an extension of
Flack et al. (1988) by allowing unequal marginal probabilities
of the two raters.
</p>
<p>We perform the optimization under both the null and alternative
hypotheses to obtain <code class="reqn">\max Var(\hat{\kappa} | \kappa = \kappa_0)</code>
and <code class="reqn">\max Var(\hat{\kappa} | \kappa = \kappa_1)</code> for a
single subject, and then calculate the sample size or power
according to the following equation:
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{n} |\kappa - \kappa_0| = z_{1-\alpha}
\sqrt{\max Var(\hat{\kappa} | \kappa = \kappa_0)} +
z_{1-\beta} \sqrt{\max Var(\hat{\kappa} | \kappa = \kappa_1)}.</code>
</p>



<h3>Value</h3>

<p>An S3 class <code>designAgreement</code> object with the
following components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis.
</p>
</li>
<li> <p><code>alpha</code>: The one-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The total sample size.
</p>
</li>
<li> <p><code>ncats</code>: The number of categories.
</p>
</li>
<li> <p><code>kappaH0</code>: The kappa coefficient under the null hypothesis.
</p>
</li>
<li> <p><code>kappa</code>: The kappa coefficient under the alternative hypothesis.
</p>
</li>
<li> <p><code>p1</code>: The marginal probabilities for the first rater.
</p>
</li>
<li> <p><code>p2</code>: The marginal probabilities for the second rater.
</p>
</li>
<li> <p><code>piH0</code>: The cell probabilities that maximize the
variance of estimated kappa under H0.
</p>
</li>
<li> <p><code>pi</code>: The cell probabilities that maximize the
variance of estimated kappa under H1.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>V. F. Flack, A. A. Afifi, and P. A. Lachenbruch.
Sample size determinations for the two rater kappa statistic.
Psychometrika 1988; 53:321-325.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignAgreement(
  beta = 0.2, n = NA, ncats = 4, kappaH0 = 0.4, kappa = 0.6,
  p1 = c(0.1, 0.2, 0.3, 0.4), p2 = c(0.15, 0.2, 0.24, 0.41),
  rounding = TRUE, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignANOVA'>Power and sample size for one-way ANOVA</h2><span id='topic+getDesignANOVA'></span>

<h3>Description</h3>

<p>Obtains the power and sample size for one-way
analysis of variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignANOVA(
  beta = NA_real_,
  n = NA_real_,
  ngroups = 2,
  means = NA_real_,
  stDev = 1,
  allocationRatioPlanned = NA_real_,
  rounding = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignANOVA_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignANOVA_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignANOVA_+3A_ngroups">ngroups</code></td>
<td>
<p>The number of treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignANOVA_+3A_means">means</code></td>
<td>
<p>The treatment group means.</p>
</td></tr>
<tr><td><code id="getDesignANOVA_+3A_stdev">stDev</code></td>
<td>
<p>The common standard deviation.</p>
</td></tr>
<tr><td><code id="getDesignANOVA_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the treatment
groups. It has length <code>ngroups - 1</code> or <code>ngroups</code>. If it is
of length <code>ngroups - 1</code>, then the last treatment group will
assume value 1 for allocation ratio.</p>
</td></tr>
<tr><td><code id="getDesignANOVA_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignANOVA_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\{\mu_i: i=1,\ldots,k\}</code> denote the group means, and
<code class="reqn">\{r_i: i=1,\ldots,k\}</code> denote the randomization probabilities
to the <code class="reqn">k</code> treatment groups. Let <code class="reqn">\sigma</code> denote the
common standard deviation, and <code class="reqn">n</code> denote the total sample
size. Then the <code class="reqn">F</code>-statistic
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{SSR/(k-1)}{SSE/(n-k)}
\sim F_{k-1, n-k, \lambda},</code>
</p>
<p> where
</p>
<p style="text-align: center;"><code class="reqn">\lambda = n \sum_{i=1}^k r_i (\mu_i - \bar{\mu})^2/\sigma^2</code>
</p>

<p>is the noncentrality parameter, and
<code class="reqn">\bar{\mu} = \sum_{i=1}^k r_i \mu_i</code>.
</p>


<h3>Value</h3>

<p>An S3 class <code>designANOVA</code> object with the following
components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis that
there is no difference among the treatment groups.
</p>
</li>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The number of subjects.
</p>
</li>
<li> <p><code>ngroups</code>: The number of treatment groups.
</p>
</li>
<li> <p><code>means</code>: The treatment group means.
</p>
</li>
<li> <p><code>stDev</code>: The common standard deviation.
</p>
</li>
<li> <p><code>effectsize</code>: The effect size.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the treatment
groups.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignANOVA(
  beta = 0.1, ngroups = 4, means = c(1.5, 2.5, 2, 0),
  stDev = 3.5, allocationRatioPlanned = c(2, 2, 2, 1),
  alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignANOVAContrast'>Power and sample size for one-way ANOVA contrast</h2><span id='topic+getDesignANOVAContrast'></span>

<h3>Description</h3>

<p>Obtains the power and sample size for a single contrast
in one-way analysis of variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignANOVAContrast(
  beta = NA_real_,
  n = NA_real_,
  ngroups = 2,
  means = NA_real_,
  stDev = 1,
  contrast = NA_real_,
  meanContrastH0 = 0,
  allocationRatioPlanned = NA_real_,
  rounding = TRUE,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignANOVAContrast_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignANOVAContrast_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignANOVAContrast_+3A_ngroups">ngroups</code></td>
<td>
<p>The number of treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignANOVAContrast_+3A_means">means</code></td>
<td>
<p>The treatment group means.</p>
</td></tr>
<tr><td><code id="getDesignANOVAContrast_+3A_stdev">stDev</code></td>
<td>
<p>The common standard deviation.</p>
</td></tr>
<tr><td><code id="getDesignANOVAContrast_+3A_contrast">contrast</code></td>
<td>
<p>The coefficients for the single contrast.</p>
</td></tr>
<tr><td><code id="getDesignANOVAContrast_+3A_meancontrasth0">meanContrastH0</code></td>
<td>
<p>The mean of the contrast under the
null hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignANOVAContrast_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the treatment
groups. It has length <code>ngroups - 1</code> or <code>ngroups</code>. If it is
of length <code>ngroups - 1</code>, then the last treatment group will
assume value 1 for allocation ratio.</p>
</td></tr>
<tr><td><code id="getDesignANOVAContrast_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignANOVAContrast_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designANOVAContrast</code> object with the following
components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis for the
treatment contrast.
</p>
</li>
<li> <p><code>alpha</code>: The one-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The number of subjects.
</p>
</li>
<li> <p><code>ngroups</code>: The number of treatment groups.
</p>
</li>
<li> <p><code>means</code>: The treatment group means.
</p>
</li>
<li> <p><code>stDev</code>: The common standard deviation.
</p>
</li>
<li> <p><code>contrast</code>: The coefficients for the single contrast.
</p>
</li>
<li> <p><code>meanContrastH0</code>: The mean of the contrast under the null
hypothesis.
</p>
</li>
<li> <p><code>meanContrast</code>: The mean of the contrast under the alternative
hypothesis.
</p>
</li>
<li> <p><code>effectsize</code>: The effect size.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the treatment
groups.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignANOVAContrast(
  beta = 0.1, ngroups = 4, means = c(1.5, 2.5, 2, 0),
  stDev = 3.5, contrast = c(1, 1, 1, -3)/3,
  allocationRatioPlanned = c(2, 2, 2, 1),
  alpha = 0.025))

</code></pre>

<hr>
<h2 id='getDesignEquiv'>Power and sample size for a generic group sequential equivalence
design</h2><span id='topic+getDesignEquiv'></span>

<h3>Description</h3>

<p>Obtains the maximum information and stopping boundaries
for a generic group sequential equivalence design assuming a constant
treatment effect, or obtains the power given the maximum information
and stopping boundaries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignEquiv(
  beta = NA_real_,
  IMax = NA_real_,
  thetaLower = NA_real_,
  thetaUpper = NA_real_,
  theta = 0,
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  spendingTime = NA_real_,
  varianceRatioH10 = 1,
  varianceRatioH20 = 1,
  varianceRatioH12 = 1,
  varianceRatioH21 = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_imax">IMax</code></td>
<td>
<p>The maximum information. Either <code>beta</code> or <code>IMax</code>
should be provided while the other one should be missing.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_thetalower">thetaLower</code></td>
<td>
<p>The parameter value at the lower equivalence limit.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_thetaupper">thetaUpper</code></td>
<td>
<p>The parameter value at the upper equivalence limit.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_theta">theta</code></td>
<td>
<p>The parameter value under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests, e.g., 0.05.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_varianceratioh10">varianceRatioH10</code></td>
<td>
<p>The ratio of the variance under H10 to
the variance under H1.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_varianceratioh20">varianceRatioH20</code></td>
<td>
<p>The ratio of the variance under H20 to
the variance under H1.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_varianceratioh12">varianceRatioH12</code></td>
<td>
<p>The ratio of the variance under H10 to
the variance under H20.</p>
</td></tr>
<tr><td><code id="getDesignEquiv_+3A_varianceratioh21">varianceRatioH21</code></td>
<td>
<p>The ratio of the variance under H20 to
the variance under H10.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider the equivalence design with two one-sided hypotheses:
</p>
<p style="text-align: center;"><code class="reqn">H_{10}: \theta \leq \theta_{10},</code>
</p>

<p style="text-align: center;"><code class="reqn">H_{20}: \theta \geq \theta_{20}.</code>
</p>

<p>We reject <code class="reqn">H_{10}</code> at or before look <code class="reqn">k</code> if
</p>
<p style="text-align: center;"><code class="reqn">Z_{1j} = (\hat{\theta}_j - \theta_{10})\sqrt{\frac{n_j}{v_{10}}}
\geq b_j</code>
</p>

<p>for some <code class="reqn">j=1,\ldots,k</code>, where <code class="reqn">\{b_j:j=1,\ldots,K\}</code> are the
critical values associated with the specified alpha-spending function,
and <code class="reqn">v_{10}</code> is the null variance of
<code class="reqn">\hat{\theta}</code> based on the restricted maximum likelihood (reml)
estimate of model parameters subject to the constraint imposed by
<code class="reqn">H_{10}</code> for one sampling unit drawn from <code class="reqn">H_1</code>. For example,
for estimating the risk difference <code class="reqn">\theta = \pi_1 - \pi_2</code>,
the asymptotic limits of the
reml estimates of <code class="reqn">\pi_1</code> and <code class="reqn">\pi_2</code> subject to the constraint
imposed by <code class="reqn">H_{10}</code> are given by
</p>
<p style="text-align: center;"><code class="reqn">(\tilde{\pi}_1, \tilde{\pi}_2) = f(\theta_{10}, r, r\pi_1,
1-r, (1-r)\pi_2),</code>
</p>

<p>where <code class="reqn">f(\theta_0, n_1, y_1, n_2, y_2)</code> is the function to obtain
the reml of <code class="reqn">\pi_1</code> and <code class="reqn">\pi_2</code> subject to the constraint that
<code class="reqn">\pi_1-\pi_2 = \theta_0</code> with observed data
<code class="reqn">(n_1, y_1, n_2, y_2)</code> for the number of subjects and number of
responses in the active treatment and control groups,
<code class="reqn">r</code> is the randomization probability for the active treatment
group, and </p>
<p style="text-align: center;"><code class="reqn">v_{10} = \frac{\tilde{\pi}_1 (1-\tilde{\pi}_1)}{r} +
\frac{\tilde{\pi}_2 (1-\tilde{\pi}_2)}{1-r}.</code>
</p>

<p>Let <code class="reqn">I_j = n_j/v_1</code> denote the information for <code class="reqn">\theta</code> at the
<code class="reqn">j</code>th look, where
</p>
<p style="text-align: center;"><code class="reqn">v_{1} = \frac{\pi_1 (1-\pi_1)}{r} + \frac{\pi_2 (1-\pi_2)}{1-r}</code>
</p>

<p>denotes the variance of <code class="reqn">\hat{\theta}</code> under <code class="reqn">H_1</code> for one
sampling unit. It follows that
</p>
<p style="text-align: center;"><code class="reqn">(Z_{1j} \geq b_j) = (Z_j \geq w_{10} b_j +
(\theta_{10}-\theta)\sqrt{I_j}),</code>
</p>

<p>where <code class="reqn">Z_j = (\hat{\theta}_j - \theta)\sqrt{I_j}</code>, and
<code class="reqn">w_{10} = \sqrt{v_{10}/v_1}</code>.
</p>
<p>Similarly, we reject <code class="reqn">H_{20}</code> at or before look <code class="reqn">k</code> if
</p>
<p style="text-align: center;"><code class="reqn">Z_{2j} = (\hat{\theta}_j - \theta_{20})\sqrt{\frac{n_j}{v_{20}}}
\leq -b_j</code>
</p>
<p> for some <code class="reqn">j=1,\ldots,k</code>, where <code class="reqn">v_{20}</code> is the null
variance of <code class="reqn">\hat{\theta}</code> based on the reml estimate of model
parameters subject to the constraint imposed by <code class="reqn">H_{20}</code> for
one sampling unit drawn from <code class="reqn">H_1</code>. We have
</p>
<p style="text-align: center;"><code class="reqn">(Z_{2j} \leq -b_j) = (Z_j \leq -w_{20} b_j +
(\theta_{20}-\theta)\sqrt{I_j}),</code>
</p>

<p>where <code class="reqn">w_{20} = \sqrt{v_{20}/v_1}</code>.
</p>
<p>Let <code class="reqn">l_j = w_{10}b_j + (\theta_{10}-\theta)\sqrt{I_j}</code>,
and <code class="reqn">u_j = -w_{20}b_j + (\theta_{20}-\theta)\sqrt{I_j}</code>.
The cumulative probability to reject <code class="reqn">H_0 = H_{10} \cup H_{20}</code> at
or before look <code class="reqn">k</code> under the alternative hypothesis <code class="reqn">H_1</code> is
given by
</p>
<p style="text-align: center;"><code class="reqn">P_\theta\left(\cup_{j=1}^{k} (Z_{1j} \geq b_j) \cap
\cup_{j=1}^{k} (Z_{2j} \leq -b_j)\right) = p_1 + p_2 + p_{12},</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">p_1 = P_\theta\left(\cup_{j=1}^{k} (Z_{1j} \geq b_j)\right)
= P_\theta\left(\cup_{j=1}^{k} (Z_j \geq l_j)\right),</code>
</p>

<p style="text-align: center;"><code class="reqn">p_2 = P_\theta\left(\cup_{j=1}^{k} (Z_{2j} \leq -b_j)\right)
= P_\theta\left(\cup_{j=1}^{k} (Z_j \leq u_j)\right),</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">p_{12} = P_\theta\left(\cup_{j=1}^{k} \{(Z_j \geq l_j) \cup
(Z_j \leq u_j)\}\right).</code>
</p>

<p>Of note, both <code class="reqn">p_1</code> and <code class="reqn">p_2</code> can be evaluated using
one-sided exit probabilities for group sequential designs.
If there exists <code class="reqn">j\leq k</code> such that <code class="reqn">l_j \leq u_j</code>, then
<code class="reqn">p_{12} = 1</code>. Otherwise, <code class="reqn">p_{12}</code> can be evaluated using
two-sided exit probabilities for group sequential designs.
</p>
<p>To evaluate the type I error of the equivalence trial under
<code class="reqn">H_{10}</code>, we first match the information under <code class="reqn">H_{10}</code>
with the information under <code class="reqn">H_1</code>. For example, for estimating
the risk difference for two independent samples, the sample size
<code class="reqn">n_{10}</code> under <code class="reqn">H_{10}</code> must satisfy
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n_{10}}\left(\frac{(\pi_2 + \theta_{10})
(1 - \pi_2 - \theta_{10})}{r} + \frac{\pi_2 (1-\pi_2)}{1-r}\right)
= \frac{1}{n}\left(\frac{\pi_1(1-\pi_1)}{r} +
\frac{\pi_2 (1-\pi_2)}{1-r}\right).</code>
</p>

<p>Then we obtain the reml estimates of <code class="reqn">\pi_1</code> and <code class="reqn">\pi_2</code>
subject to the constraint imposed by <code class="reqn">H_{20}</code> for one sampling
unit drawn from <code class="reqn">H_{10}</code>,
</p>
<p style="text-align: center;"><code class="reqn">(\tilde{\pi}_{10}, \tilde{\pi}_{20}) = f(\theta_{20}, r,
r(\pi_2 + \theta_{10}), 1-r, (1-r)\pi_2).</code>
</p>

<p>Let <code class="reqn">t_j</code> denote the information fraction at look <code class="reqn">j</code>.
Define </p>
<p style="text-align: center;"><code class="reqn">\tilde{v}_1 = \frac{(\pi_2 + \theta_{10})
(1-\pi_2 -\theta_{10})}{r} + \frac{\pi_2 (1-\pi_2)}{1-r},</code>
</p>
<p> and
</p>
<p style="text-align: center;"><code class="reqn">\tilde{v}_{20} = \frac{\tilde{\pi}_{10}(1-\tilde{\pi}_{10})}{r} +
\frac{\tilde{\pi}_{20} (1-\tilde{\pi}_{20})}{1-r}.</code>
</p>

<p>The cumulative rejection probability under <code class="reqn">H_{10}</code> at or before
look <code class="reqn">k</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">P_{\theta_{10}}\left(\cup_{j=1}^{k} \{(\hat{\theta}_j - \theta_{10})
\sqrt{n_{10} t_j/\tilde{v}_1} \geq b_j\} \cap
\cup_{j=1}^{k} \{(\hat{\theta}_j - \theta_{20})
\sqrt{n_{10} t_j/\tilde{v}_{20}} \leq -b_j\}\right) =
q_1 + q_2 + q_{12},</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">q_1 = P_{\theta_{10}}\left(\cup_{j=1}^{k}
\{(\hat{\theta}_j - \theta_{10})
\sqrt{n_{10} t_j/\tilde{v}_1} \geq b_j\}\right) =
P_{\theta_{10}}\left(\cup_{j=1}^{k} (Z_j \geq b_j)\right),</code>
</p>

<p style="text-align: center;"><code class="reqn">q_2 = P_{\theta_{10}}\left(\cup_{j=1}^{k}
\{(\hat{\theta}_j - \theta_{20})
\sqrt{n_{10} t_j/\tilde{v}_{20}} \leq -b_j\}\right) =
P_{\theta_{10}}\left(\cup_{j=1}^{k} (Z_j \leq -b_j w_{21} +
(\theta_{20} - \theta_{10})\sqrt{I_j})\right),</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">q_{12} = P_{\theta_{10}}\left(\cup_{j=1}^{k}
\{(Z_j \geq b_j) \cup (Z_j \leq -w_{21} b_j +
(\theta_{20} - \theta_{10})\sqrt{I_j})\}\right).</code>
</p>

<p>Here <code class="reqn">Z_j = (\hat{\theta}_j - \theta_{10}) \sqrt{I_j}</code>, and
<code class="reqn">w_{21} = \sqrt{\tilde{v}_{20}/\tilde{v}_1}</code>.
Of note, <code class="reqn">q_1</code>, <code class="reqn">q_2</code>, and <code class="reqn">q_{12}</code>
can be evaluated using group sequential exit probabilities.
Similarly, we can define <code class="reqn">\tilde{v}_2</code>, <code class="reqn">\tilde{v}_{10}</code>,
and <code class="reqn">w_{12} = \sqrt{\tilde{v}_{10}/\tilde{v}_2}</code>, and
evaluate the type I error under <code class="reqn">H_{20}</code>.
</p>
<p>The variance ratios correspond to
</p>
<p style="text-align: center;"><code class="reqn">\text{varianceRatioH10} = v_{10}/v_1,</code>
</p>

<p style="text-align: center;"><code class="reqn">\text{varianceRatioH20} = v_{20}/v_1,</code>
</p>

<p style="text-align: center;"><code class="reqn">\text{varianceRatioH12} = \tilde{v}_{10}/\tilde{v}_2,</code>
</p>

<p style="text-align: center;"><code class="reqn">\text{varianceRatioH21} = \tilde{v}_{20}/\tilde{v}_1.</code>
</p>

<p>If the alternative variance is used, then the variance ratios
are all equal to 1.
</p>


<h3>Value</h3>

<p>An S3 class <code>designEquiv</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlphaH10</code>: The attained significance level under H10.
</p>
</li>
<li> <p><code>attainedAlphaH20</code>: The attained significance level under H20.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>thetaLower</code>: The parameter value at the lower equivalence
limit.
</p>
</li>
<li> <p><code>thetaUpper</code>: The parameter value at the upper equivalence
limit.
</p>
</li>
<li> <p><code>theta</code>: The parameter value under the alternative hypothesis.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH10</code>: The expected information under H10.
</p>
</li>
<li> <p><code>expectedInformationH20</code>: The expected information under H20.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH10</code>: The cumulative probability for
efficacy stopping under H10.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH20</code>: The cumulative probability for
efficacy stopping under H20.
</p>
</li>
<li> <p><code>efficacyThetaLower</code>: The efficacy boundaries on the
parameter scale for the one-sided null hypothesis at the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyThetaUpper</code>: The efficacy boundaries on the
parameter scale for the one-sided null hypothesis at the
upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following components:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>varianceRatioH10</code>: The ratio of the variance under H10 to
the variance under H1.
</p>
</li>
<li> <p><code>varianceRatioH20</code>: The ratio of the variance under H20 to
the variance under H1.
</p>
</li>
<li> <p><code>varianceRatioH12</code>: The ratio of the variance under H10 to
the variance under H20.
</p>
</li>
<li> <p><code>varianceRatioH21</code>: The ratio of the variance under H20 to
the variance under H10.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: obtain the maximum information given power
(design1 &lt;- getDesignEquiv(
  beta = 0.2, thetaLower = log(0.8), thetaUpper = log(1.25),
  kMax = 2, informationRates = c(0.5, 1),
  alpha = 0.05, typeAlphaSpending = "sfOF"))


# Example 2: obtain power given the maximum information
(design2 &lt;- getDesignEquiv(
  IMax = 72.5, thetaLower = log(0.7), thetaUpper = -log(0.7),
  kMax = 3, informationRates = c(0.5, 0.75, 1),
  alpha = 0.05, typeAlphaSpending = "sfOF"))

</code></pre>

<hr>
<h2 id='getDesignFisherExact'>Power and sample size for Fisher's exact test for two proportions</h2><span id='topic+getDesignFisherExact'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for Fisher's exact test for two proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignFisherExact(
  beta = NA_real_,
  n = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignFisherExact_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignFisherExact_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignFisherExact_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignFisherExact_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignFisherExact_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignFisherExact_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignFisherExact(
  beta = 0.2, pi1 = 0.5, pi2 = 0.2, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignLogistic'>Power and sample size for logistic regression</h2><span id='topic+getDesignLogistic'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for logistic regression of a binary response given
the covariate of interest and other covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignLogistic(
  beta = NA_real_,
  n = NA_real_,
  ncovariates = NA_integer_,
  nconfigs = NA_integer_,
  x = NA_real_,
  pconfigs = NA_real_,
  corr = 0,
  oddsratios = NA_real_,
  responseprob = NA_real_,
  rounding = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignLogistic_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignLogistic_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignLogistic_+3A_ncovariates">ncovariates</code></td>
<td>
<p>The number of covariates.</p>
</td></tr>
<tr><td><code id="getDesignLogistic_+3A_nconfigs">nconfigs</code></td>
<td>
<p>The number of configurations of discretized covariate
values.</p>
</td></tr>
<tr><td><code id="getDesignLogistic_+3A_x">x</code></td>
<td>
<p>The matrix of covariate values.</p>
</td></tr>
<tr><td><code id="getDesignLogistic_+3A_pconfigs">pconfigs</code></td>
<td>
<p>The vector of probabilities for the configurations.</p>
</td></tr>
<tr><td><code id="getDesignLogistic_+3A_corr">corr</code></td>
<td>
<p>The multiple correlation between the predictor and other
covariates. Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignLogistic_+3A_oddsratios">oddsratios</code></td>
<td>
<p>The odds ratios for one unit increase in the
covariates.</p>
</td></tr>
<tr><td><code id="getDesignLogistic_+3A_responseprob">responseprob</code></td>
<td>
<p>The response probability in the full model when
all predictor variables are equal to their means.</p>
</td></tr>
<tr><td><code id="getDesignLogistic_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignLogistic_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We consider the logistic regression of a binary response variable
<code class="reqn">Y</code> on a set of predictor variables <code class="reqn">x = (x_1,\ldots,x_K)^T</code>
with <code class="reqn">x_1</code> being the covariate of interest:
<code class="reqn">\log \frac{P(Y_i=1)}{1 - P(Y_i = 1)} = \psi_0 + x_i^T \psi,</code>
where <code class="reqn">\psi = (\psi_1,\ldots,\psi_K)^T</code>.
Similar to Self et al (1992), we assume that all covariates are
either inherently discrete or discretized from continuous
distributions (e.g. using the quantiles). Let <code class="reqn">m</code> denote the total
number of configurations of the covariate values. Let
</p>
<p style="text-align: center;"><code class="reqn">\pi_i = P(x = x_i), i = 1,\ldots, m</code>
</p>

<p>denote the probabilities for the configurations of the covariates
under independence. The likelihood ratio test statistic for testing
<code class="reqn">H_0: \psi_1 = 0</code> can be approximated by a noncentral chi-square
distribution with one degree of freedom and noncentrality parameter
</p>
<p style="text-align: center;"><code class="reqn">\Delta = 2 \sum_{i=1}^m \pi_i [b'(\theta_i)(\theta_i - \theta_i^*)
- \{b(\theta_i) - b(\theta_i^*)\}],</code>
</p>
<p> where
</p>
<p style="text-align: center;"><code class="reqn">\theta_i = \psi_0 + \sum_{j=1}^{k} \psi_j x_{ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">\theta_i^* = \psi_0^* + \sum_{j=2}^{k} \psi_j^* x_{ij},</code>
</p>

<p>for <code class="reqn">\psi_0^* = \psi_0 + \psi_1 \mu_1</code>, and <code class="reqn">\psi_j^* = \psi_j</code>
for <code class="reqn">j=2,\ldots,K</code>. Here <code class="reqn">\mu_1</code> is the mean of <code class="reqn">x_1</code>,
e.g., <code class="reqn">\mu_1 = \sum_i \pi_i x_{i1}.</code> In addition, by
formulating the logistic regression in the framework of generalized
linear models, </p>
<p style="text-align: center;"><code class="reqn">b(\theta) = \log(1 + \exp(\theta)),</code>
</p>
<p> and
</p>
<p style="text-align: center;"><code class="reqn">b'(\theta) = \frac{\exp(\theta)}{1 + \exp(\theta)}.</code>
</p>

<p>The regression coefficients <code class="reqn">\psi</code> can be obtained by taking the
log of the odds ratios for the covariates. The intercept <code class="reqn">\psi_0</code>
can be derived as </p>
<p style="text-align: center;"><code class="reqn">\psi_0 = \log(\bar{\mu}/(1- \bar{\mu})) -
\sum_{j=1}^{K} \psi_j \mu_j,</code>
</p>
<p> where <code class="reqn">\bar{\mu}</code> denotes the
response probability when all predictor variables are equal to their
means.
</p>
<p>Finally, let <code class="reqn">\rho</code> denote the multiple correlation between
the predictor and other covariates. The noncentrality parameter
of the chi-square test is adjusted downward by multiplying by
<code class="reqn">1-\rho^2</code>.
</p>


<h3>Value</h3>

<p>An S3 class <code>designLogistic</code> object with the
following components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis.
</p>
</li>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The total sample size.
</p>
</li>
<li> <p><code>ncovariates</code>: The number of covariates.
</p>
</li>
<li> <p><code>nconfigs</code>: The number of configurations of discretized covariate
values.
</p>
</li>
<li> <p><code>x</code>: The matrix of covariate values.
</p>
</li>
<li> <p><code>pconfigs</code>: The vector of probabilities for the configurations.
</p>
</li>
<li> <p><code>corr</code>: The multiple correlation between the predictor and other
covariates.
</p>
</li>
<li> <p><code>oddsratios</code>: The odds ratios for one unit increase in the
covariates.
</p>
</li>
<li> <p><code>responseprob</code>: The response probability in the full model when
all predictor variables are equal to their means.
</p>
</li>
<li> <p><code>effectsize</code>: The effect size for the chi-square test.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Steven G. Self, Robert H. Mauritsen and Jill Ohara.
Power calculations for likelihood ratio tests in generalized linear
models. Biometrics 1992; 48:31-39.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# two ordinal covariates
x1 = c(5, 10, 15, 20)
px1 = c(0.2, 0.3, 0.3, 0.2)

x2 = c(2, 4, 6)
px2 = c(0.4, 0.4, 0.2)

# discretizing a normal distribution with mean 4 and standard deviation 2
nbins = 10
x3 = qnorm(((1:nbins) - 0.5)/nbins)*2 + 4
px3 = rep(1/nbins, nbins)

# combination of covariate values
nconfigs = length(x1)*length(x2)*length(x3)
x = expand.grid(x3 = x3, x2 = x2, x1 = x1)
x = as.matrix(x[, ncol(x):1])

# probabilities for the covariate configurations under independence
pconfigs = as.numeric(px1 %x% px2 %x% px3)

# convert the odds ratio for the predictor variable in 5-unit change
# to the odds ratio in 1-unit change
(design1 &lt;- getDesignLogistic(
  beta = 0.1, ncovariates = 3,
  nconfigs = nconfigs,
  x = x,
  pconfigs = pconfigs,
  oddsratios = c(1.2^(1/5), 1.4, 1.3),
  responseprob = 0.25,
  alpha = 0.1))

</code></pre>

<hr>
<h2 id='getDesignMeanDiff'>Group sequential design for two-sample mean difference</h2><span id='topic+getDesignMeanDiff'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for two-sample mean
difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignMeanDiff(
  beta = NA_real_,
  n = NA_real_,
  meanDiffH0 = 0,
  meanDiff = 0.5,
  stDev = 1,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignMeanDiff_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_meandiffh0">meanDiffH0</code></td>
<td>
<p>The mean difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_meandiff">meanDiff</code></td>
<td>
<p>The mean difference under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiff_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designMeanDiff</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>meanDiffH0</code>: The mean difference under the null hypothesis.
</p>
</li>
<li> <p><code>meanDiff</code>: The mean difference under the alternative
hypothesis.
</p>
</li>
<li> <p><code>stDev</code>: The standard deviation.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyMeanDiff</code>: The efficacy boundaries on the mean
difference scale.
</p>
</li>
<li> <p><code>futilityMeanDiff</code>: The futility boundaries on the mean
difference scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignMeanDiff(
  beta = NA, n = 456, meanDiff = 9, stDev = 32,
  kMax = 5, alpha = 0.025, typeAlphaSpending = "sfOF",
  typeBetaSpending = "sfP"))

# Example 2: sample size calculation for two-sample t-test
(design2 &lt;- getDesignMeanDiff(
  beta = 0.1, n = NA, meanDiff = 0.3, stDev = 1,
  normalApproximation = FALSE, alpha = 0.025))

</code></pre>

<hr>
<h2 id='getDesignMeanDiffCarryover'>Power and sample size for direct treatment effects in crossover
trials accounting for carryover effects</h2><span id='topic+getDesignMeanDiffCarryover'></span>

<h3>Description</h3>

<p>Obtains the power and sample size for direct treatment
effects in crossover trials accounting for carryover effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignMeanDiffCarryover(
  beta = NA_real_,
  n = NA_real_,
  meanDiffH0 = 0,
  meanDiff = 0.5,
  stDev = 1,
  corr = 0.5,
  design = NA_real_,
  cumdrop = NA_real_,
  allocationRatioPlanned = NA_real_,
  normalApproximation = FALSE,
  rounding = TRUE,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_meandiffh0">meanDiffH0</code></td>
<td>
<p>The mean difference at the last time point
under the null hypothesis. Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_meandiff">meanDiff</code></td>
<td>
<p>The mean difference at the last time point
under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation for within-subject random error.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_corr">corr</code></td>
<td>
<p>The intra-subject correlation due to subject random effect.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_design">design</code></td>
<td>
<p>The crossover design represented by a matrix with
rows indexing the sequences, columns indexing the periods, and
matrix entries indicating the treatments.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_cumdrop">cumdrop</code></td>
<td>
<p>The cumulative dropout rate over periods.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the sequences.
Defaults to equal randomization if not provided.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffCarryover_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linear mixed-effects model to assess the direct treatment effect
in the presence of carryover treatment effect is given by
</p>
<p style="text-align: center;"><code class="reqn">y_{ijk} = \mu + \alpha_i + b_{ij} + \gamma_k + \tau_{d(i,k)}
+ \lambda_{c(i,k-1)} + e_{ijk},</code>
</p>

<p style="text-align: center;"><code class="reqn">i=1,\ldots,n; j=1,\ldots,r_i; k = 1,\ldots,p; d,c = 1,\ldots,t,</code>
</p>

<p>where <code class="reqn">\mu</code> is the general mean, <code class="reqn">\alpha_i</code> is the effect of
the <code class="reqn">i</code>th treatment sequence, <code class="reqn">b_{ij}</code> is the random effect
with variance <code class="reqn">\sigma_b^2</code> for the <code class="reqn">j</code>the subject of the
<code class="reqn">i</code>th treatment sequence, <code class="reqn">\gamma_k</code> is the period effect,
and <code class="reqn">e_{ijk}</code> is the random error with variance <code class="reqn">\sigma^2</code>
for the subject in period <code class="reqn">k</code>. The direct effect of the treatment
administered in period <code class="reqn">k</code> of sequence <code class="reqn">i</code> is
<code class="reqn">\tau_{d(i,k)}</code>, and <code class="reqn">\lambda_{c(i,k-1)}</code> is the carryover
effect of the treatment administered in period <code class="reqn">k-1</code> of sequence
<code class="reqn">i</code>. The value of the carryover effect for the observed
response in the first period is <code class="reqn">\lambda_{c(i,0)} = 0</code> since
there is no carryover effect in the first period. The intra-subject
correlation due to the subject random effect is
</p>
<p style="text-align: center;"><code class="reqn">\rho = \frac{\sigma_b^2}{\sigma_b^2 + sigma^2}.</code>
</p>

<p>By constructing the design matrix <code class="reqn">X</code> for the linear model with
a compound symmetry covariance matrix for the response vector of
a subject, we can obtain </p>
<p style="text-align: center;"><code class="reqn">Var(\hat{\beta}) = (X'V^{-1}X)^{-1}.</code>
</p>

<p>The covariance matrix for the direct treatment effects and the
carryover treatment effects can be extracted from the appropriate
sub-matrices. The covariance matrix for the direct treatment effects
without accounting for the carryover treatment effects can be obtained
by omitting the carryover effect terms from the model.
</p>
<p>The power and relative efficiency are for the direct treatment
effect comparing the first treatment to the last treatment
accounting for carryover effects.
</p>
<p>The degrees of freedom for the t-test can be calculated as the
total number of observations minus the number of subjects minus
<code class="reqn">p-1</code> minus <code class="reqn">2(t-1)</code> to account for the subject effect,
period effect, and direct and carryover treatment effects.
</p>


<h3>Value</h3>

<p>An S3 class <code>designMeanDiffCarryover</code> object with the
following components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis.
</p>
</li>
<li> <p><code>alpha</code>: The one-sided significance level.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>meanDiffH0</code>: The mean difference under the null hypothesis.
</p>
</li>
<li> <p><code>meanDiff</code>: The mean difference under the alternative
hypothesis.
</p>
</li>
<li> <p><code>stDev</code>: The standard deviation for within-subject random error.
</p>
</li>
<li> <p><code>corr</code>: The intra-subject correlation due to subject random effect.
</p>
</li>
<li> <p><code>design</code>: The crossover design represented by a matrix with
rows indexing the sequences, columns indexing the periods, and
matrix entries indicating the treatments.
</p>
</li>
<li> <p><code>nseq</code>: The number of sequences.
</p>
</li>
<li> <p><code>nprd</code>: The number of periods.
</p>
</li>
<li> <p><code>ntrt</code>: The number of treatments.
</p>
</li>
<li> <p><code>cumdrop</code>: The cumulative dropout rate over periods.
</p>
</li>
<li> <p><code>V_direct_only</code>: The covariance matrix for direct treatment
effects without accounting for carryover effects.
</p>
</li>
<li> <p><code>V_direct_carry</code>: The covariance matrix for direct and
carryover treatment effects.
</p>
</li>
<li> <p><code>v_direct_only</code>: The variance of direct treatment effects
without accounting for carryover effects.
</p>
</li>
<li> <p><code>v_direct</code>: The variance of direct treatment effects
accounting for carryover effects.
</p>
</li>
<li> <p><code>v_carry</code>: The variance of carryover treatment effects.
</p>
</li>
<li> <p><code>releff_direct</code>: The relative efficiency of the design
for estimating direct treatment effects after accounting
for carryover effects with respect to that without
accounting for carryover effects. This is equal to
<code>v_direct_only/v_direct</code>.
</p>
</li>
<li> <p><code>releff_carry</code>: The relative efficiency of the design
for estimating carryover effects. This is equal to
<code>v_direct_only/v_carry</code>.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the sequences.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Robert O. Kuehl. Design of Experiments: Statistical Principles of
Research Design and Analysis. Brooks/Cole: Pacific Grove, CA. 2000.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Williams design for 4 treatments

(design1 = getDesignMeanDiffCarryover(
  beta = 0.2, n = NA,
  meanDiff = 0.5, stDev = 1,
  design = matrix(c(1, 4, 2, 3,
                    2, 1, 3, 4,
                    3, 2, 4, 1,
                    4, 3, 1, 2),
                  4, 4, byrow = TRUE),
  alpha = 0.025))

</code></pre>

<hr>
<h2 id='getDesignMeanDiffEquiv'>Group sequential design for equivalence in two-sample
mean difference</h2><span id='topic+getDesignMeanDiffEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for equivalence in
two-sample mean difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignMeanDiffEquiv(
  beta = NA_real_,
  n = NA_real_,
  meanDiffLower = NA_real_,
  meanDiffUpper = NA_real_,
  meanDiff = 0,
  stDev = 1,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_meandifflower">meanDiffLower</code></td>
<td>
<p>The lower equivalence limit of mean difference.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_meandiffupper">meanDiffUpper</code></td>
<td>
<p>The upper equivalence limit of mean difference.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_meandiff">meanDiff</code></td>
<td>
<p>The mean difference under the alternative
hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffEquiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designMeanDiffEquiv</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The significance level for each of the two one-sided
tests. Defaults to 0.05.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>meanDiffLower</code>: The lower equivalence limit of mean
difference.
</p>
</li>
<li> <p><code>meanDiffUpper</code>: The upper equivalence limit of mean
difference.
</p>
</li>
<li> <p><code>meanDiff</code>: The mean difference under the alternative
hypothesis.
</p>
</li>
<li> <p><code>stDev</code>: The standard deviation.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlpha</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>efficacyMeanDiffLower</code>: The efficacy boundaries on the
mean difference scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyMeanDiffUpper</code>: The efficacy boundaries on the
mean difference scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignMeanDiffEquiv(
  beta = 0.1, n = NA, meanDiffLower = -1.3, meanDiffUpper = 1.3,
  meanDiff = 0, stDev = 2.2,
  kMax = 4, alpha = 0.05, typeAlphaSpending = "sfOF"))

# Example 2: sample size calculation for t-test
(design2 &lt;- getDesignMeanDiffEquiv(
  beta = 0.1, n = NA, meanDiffLower = -1.3, meanDiffUpper = 1.3,
  meanDiff = 0, stDev = 2.2,
  normalApproximation = FALSE, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignMeanDiffMMRM'>Group sequential design for two-sample mean difference from the
MMRM model</h2><span id='topic+getDesignMeanDiffMMRM'></span>

<h3>Description</h3>

<p>Obtains the power and sample size for two-sample
mean difference at the last time point from the mixed-model
for repeated measures (MMRM) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignMeanDiffMMRM(
  beta = NA_real_,
  meanDiffH0 = 0,
  meanDiff = 0.5,
  k = 1,
  t = NA_real_,
  covar1 = diag(k),
  covar2 = NA_real_,
  accrualTime = 0,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0,
  gamma1 = 0,
  gamma2 = 0,
  accrualDuration = NA_real_,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_meandiffh0">meanDiffH0</code></td>
<td>
<p>The mean difference at the last time point
under the null hypothesis. Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_meandiff">meanDiff</code></td>
<td>
<p>The mean difference at the last time point
under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_k">k</code></td>
<td>
<p>The number of postbaseline time points.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_t">t</code></td>
<td>
<p>The postbaseline time points.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_covar1">covar1</code></td>
<td>
<p>The covariance matrix for the repeated measures
given baseline for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_covar2">covar2</code></td>
<td>
<p>The covariance matrix for the repeated measures
given baseline for the control group. If missing, it will be
set equal to the covariance matrix for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the active
treatment group.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the control group.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The
degrees of freedom for the t-distribution is the total effective
sample size minus 2.  The exact calculation using the t distribution
is only implemented for the fixed design.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Defaults to
<code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffMMRM_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designMeanDiffMMRM</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>studyDuration</code>: The maximum study duration.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>expectedStudyDurationH1</code>: The expected study duration
under H1.
</p>
</li>
<li> <p><code>expectedStudyDurationH0</code>: The expected study duration
under H0.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up time.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>meanDiffH0</code>: The mean difference under H0.
</p>
</li>
<li> <p><code>meanDiff</code>: The mean difference under H1.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyMeanDiff</code>: The efficacy boundaries on the mean
difference scale.
</p>
</li>
<li> <p><code>futilityMeanDiff</code>: The futility boundaries on the mean
difference scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: The allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>accrualTime</code>: A vector that specifies the starting time of
piecewise Poisson enrollment time intervals.
</p>
</li>
<li> <p><code>accrualIntensity</code>: A vector of accrual intensities.
One for each accrual time interval.
</p>
</li>
<li> <p><code>piecewiseSurvivalTime</code>: A vector that specifies the
starting time of piecewise exponential survival time intervals.
</p>
</li>
<li> <p><code>gamma1</code>: The hazard rate for exponential dropout or
a vector of hazard rates for piecewise exponential dropout
for the active treatment group.
</p>
</li>
<li> <p><code>gamma2</code>: The hazard rate for exponential dropout or
a vector of hazard rates for piecewise exponential dropout
for the control group.
</p>
</li>
<li> <p><code>k</code>: The number of postbaseline time points.
</p>
</li>
<li> <p><code>t</code>: The postbaseline time points.
</p>
</li>
<li> <p><code>covar1</code>: The covariance matrix for the repeated measures
given baseline for the active treatment group.
</p>
</li>
<li> <p><code>covar2</code>: The covariance matrix for the repeated measures
given baseline for the control group.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# function to generate the AR(1) correlation matrix
ar1_cor &lt;- function(n, corr) {
  exponent &lt;- abs(matrix((1:n) - 1, n, n, byrow = TRUE) - ((1:n) - 1))
  corr^exponent
}

(design1 = getDesignMeanDiffMMRM(
  beta = 0.2,
  meanDiffH0 = 0,
  meanDiff = 0.5,
  k = 4,
  t = c(1,2,3,4),
  covar1 = ar1_cor(4, 0.7),
  accrualIntensity = 10,
  gamma1 = 0.02634013,
  gamma2 = 0.02634013,
  accrualDuration = NA,
  allocationRatioPlanned = 1,
  kMax = 3,
  alpha = 0.025,
  typeAlphaSpending = "sfOF"))

</code></pre>

<hr>
<h2 id='getDesignMeanDiffXO'>Group sequential design for mean difference in 2x2 crossover</h2><span id='topic+getDesignMeanDiffXO'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for two-sample mean
difference in 2x2 crossover.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignMeanDiffXO(
  beta = NA_real_,
  n = NA_real_,
  meanDiffH0 = 0,
  meanDiff = 0.5,
  stDev = 1,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignMeanDiffXO_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_meandiffh0">meanDiffH0</code></td>
<td>
<p>The mean difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_meandiff">meanDiff</code></td>
<td>
<p>The mean difference under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation for within-subject random error.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for sequence A/B
versus sequence B/A. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXO_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designMeanDiffXO</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>meanDiffH0</code>: The mean difference under the null hypothesis.
</p>
</li>
<li> <p><code>meanDiff</code>: The mean difference under the alternative
hypothesis.
</p>
</li>
<li> <p><code>stDev</code>: The standard deviation for within-subject random
error.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyMeanDiff</code>: The efficacy boundaries on the mean
difference scale.
</p>
</li>
<li> <p><code>futilityMeanDiff</code>: The futility boundaries on the mean
difference scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for sequence A/B
versus sequence B/A.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignMeanDiffXO(
  beta = 0.2, n = NA, meanDiff = 75, stDev = 150,
  normalApproximation = FALSE, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignMeanDiffXOEquiv'>Group sequential design for equivalence in mean difference
in 2x2 crossover</h2><span id='topic+getDesignMeanDiffXOEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for equivalence in
mean difference in 2x2 crossover.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignMeanDiffXOEquiv(
  beta = NA_real_,
  n = NA_real_,
  meanDiffLower = NA_real_,
  meanDiffUpper = NA_real_,
  meanDiff = 0,
  stDev = 1,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_meandifflower">meanDiffLower</code></td>
<td>
<p>The lower equivalence limit of mean difference.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_meandiffupper">meanDiffUpper</code></td>
<td>
<p>The upper equivalence limit of mean difference.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_meandiff">meanDiff</code></td>
<td>
<p>The mean difference under the alternative
hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation for within-subject random error.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for sequence A/B
versus sequence B/A. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanDiffXOEquiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designMeanDiffXOEquiv</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>meanDiffLower</code>: The lower equivalence limit of mean
difference.
</p>
</li>
<li> <p><code>meanDiffUpper</code>: The upper equivalence limit of mean
difference.
</p>
</li>
<li> <p><code>meanDiff</code>: The mean difference under the alternative
hypothesis.
</p>
</li>
<li> <p><code>stDev</code>: The standard deviation for within-subject random
error.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlpha</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>efficacyMeanDiffLower</code>: The efficacy boundaries on the
mean difference scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyMeanDiffUpper</code>: The efficacy boundaries on the
mean difference scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for sequence A/B
versus sequence B/A.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignMeanDiffXOEquiv(
  beta = 0.1, n = NA, meanDiffLower = -1.3, meanDiffUpper = 1.3,
  meanDiff = 0, stDev = 2.2,
  kMax = 4, alpha = 0.05, typeAlphaSpending = "sfOF"))

# Example 2: sample size calculation for t-test
(design2 &lt;- getDesignMeanDiffXOEquiv(
  beta = 0.1, n = NA, meanDiffLower = -1.3, meanDiffUpper = 1.3,
  meanDiff = 0, stDev = 2.2,
  normalApproximation = FALSE, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignMeanRatio'>Group sequential design for two-sample mean ratio</h2><span id='topic+getDesignMeanRatio'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for two-sample mean
ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignMeanRatio(
  beta = NA_real_,
  n = NA_real_,
  meanRatioH0 = 1,
  meanRatio = 1.25,
  CV = 1,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignMeanRatio_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_meanratioh0">meanRatioH0</code></td>
<td>
<p>The mean ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_meanratio">meanRatio</code></td>
<td>
<p>The mean ratio under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_cv">CV</code></td>
<td>
<p>The coefficient of variation. The standard deviation on the
log scale is equal to <code>sqrt(log(1 + CV^2))</code>.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatio_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designMeanRatio</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>meanRatioH0</code>: The mean ratio under the null hypothesis.
</p>
</li>
<li> <p><code>meanRatio</code>: The mean ratio under the alternative hypothesis.
</p>
</li>
<li> <p><code>CV</code>: The coefficient of variation.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>efficacyMeanRatio</code>: The efficacy boundaries on the mean
ratio scale.
</p>
</li>
<li> <p><code>futilityMeanRatio</code>: The futility boundaries on the mean
ratio scale.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignMeanRatio(
  beta = 0.1, n = NA, meanRatio = 1.25, CV = 0.25,
  alpha = 0.05, normalApproximation = FALSE))

</code></pre>

<hr>
<h2 id='getDesignMeanRatioEquiv'>Group sequential design for equivalence in two-sample
mean ratio</h2><span id='topic+getDesignMeanRatioEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for equivalence in
two-sample mean ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignMeanRatioEquiv(
  beta = NA_real_,
  n = NA_real_,
  meanRatioLower = NA_real_,
  meanRatioUpper = NA_real_,
  meanRatio = 1,
  CV = 1,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_meanratiolower">meanRatioLower</code></td>
<td>
<p>The lower equivalence limit of mean ratio.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_meanratioupper">meanRatioUpper</code></td>
<td>
<p>The upper equivalence limit of mean ratio.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_meanratio">meanRatio</code></td>
<td>
<p>The mean ratio under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_cv">CV</code></td>
<td>
<p>The coefficient of variation.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioEquiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designMeanRatioEquiv</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The significance level for each of the two one-sided
tests. Defaults to 0.05.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>meanRatioLower</code>: The lower equivalence limit of mean ratio.
</p>
</li>
<li> <p><code>meanRatioUpper</code>: The upper equivalence limit of mean ratio.
</p>
</li>
<li> <p><code>meanRatio</code>: The mean ratio under the alternative hypothesis.
</p>
</li>
<li> <p><code>CV</code>: The coefficient of variation.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlpha</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>efficacyMeanRatioLower</code>: The efficacy boundaries on the
mean ratio scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyMeanRatioUpper</code>: The efficacy boundaries on the
mean ratio scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignMeanRatioEquiv(
  beta = 0.1, n = NA, meanRatioLower = 0.8, meanRatioUpper = 1.25,
  meanRatio = 1, CV = 0.35,
  kMax = 4, alpha = 0.05, typeAlphaSpending = "sfOF"))

# Example 2: sample size calculation for t-test
(design2 &lt;- getDesignMeanRatioEquiv(
  beta = 0.1, n = NA, meanRatioLower = 0.8, meanRatioUpper = 1.25,
  meanRatio = 1, CV = 0.35,
  normalApproximation = FALSE, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignMeanRatioXO'>Group sequential design for mean ratio in 2x2 crossover</h2><span id='topic+getDesignMeanRatioXO'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for two-sample mean
ratio in 2x2 crossover.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignMeanRatioXO(
  beta = NA_real_,
  n = NA_real_,
  meanRatioH0 = 1,
  meanRatio = 1.25,
  CV = 1,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignMeanRatioXO_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_meanratioh0">meanRatioH0</code></td>
<td>
<p>The mean ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_meanratio">meanRatio</code></td>
<td>
<p>The mean ratio under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_cv">CV</code></td>
<td>
<p>The coefficient of variation. The standard deviation on the
log scale is equal to <code>sqrt(log(1 + CV^2))</code>.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for sequence A/B
versus sequence B/A. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXO_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designMeanRatioXO</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>meanRatioH0</code>: The mean ratio under the null hypothesis.
</p>
</li>
<li> <p><code>meanRatio</code>: The mean ratio under the alternative hypothesis.
</p>
</li>
<li> <p><code>CV</code>: The coefficient of variation.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyMeanRatio</code>: The efficacy boundaries on the mean
ratio scale.
</p>
</li>
<li> <p><code>futilityMeanRatio</code>: The futility boundaries on the mean
ratio scale.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for sequence A/B
versus sequence B/A.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignMeanRatioXO(
  beta = 0.1, n = NA, meanRatio = 1.25, CV = 0.25,
  alpha = 0.05, normalApproximation = FALSE))

</code></pre>

<hr>
<h2 id='getDesignMeanRatioXOEquiv'>Group sequential design for equivalence in mean ratio
in 2x2 crossover</h2><span id='topic+getDesignMeanRatioXOEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for equivalence
mean ratio in 2x2 crossover.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignMeanRatioXOEquiv(
  beta = NA_real_,
  n = NA_real_,
  meanRatioLower = NA_real_,
  meanRatioUpper = NA_real_,
  meanRatio = 1,
  CV = 1,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_meanratiolower">meanRatioLower</code></td>
<td>
<p>The lower equivalence limit of mean ratio.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_meanratioupper">meanRatioUpper</code></td>
<td>
<p>The upper equivalence limit of mean ratio.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_meanratio">meanRatio</code></td>
<td>
<p>The mean ratio under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_cv">CV</code></td>
<td>
<p>The coefficient of variation.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for sequence A/B
versus sequence B/A. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignMeanRatioXOEquiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designMeanRatioEquiv</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>meanRatioLower</code>: The lower equivalence limit of mean ratio.
</p>
</li>
<li> <p><code>meanRatioUpper</code>: The upper equivalence limit of mean ratio.
</p>
</li>
<li> <p><code>meanRatio</code>: The mean ratio under the alternative hypothesis.
</p>
</li>
<li> <p><code>CV</code>: The coefficient of variation.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlpha</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>efficacyMeanRatioLower</code>: The efficacy boundaries on the
mean ratio scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyMeanRatioUpper</code>: The efficacy boundaries on the
mean ratio scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for sequence A/B
versus sequence B/A.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignMeanRatioXOEquiv(
  beta = 0.1, n = NA, meanRatioLower = 0.8, meanRatioUpper = 1.25,
  meanRatio = 1, CV = 0.35,
  kMax = 4, alpha = 0.05, typeAlphaSpending = "sfOF"))

# Example 2: sample size calculation for t-test
(design2 &lt;- getDesignMeanRatioXOEquiv(
  beta = 0.1, n = NA, meanRatioLower = 0.8, meanRatioUpper = 1.25,
  meanRatio = 1, CV = 0.35,
  normalApproximation = FALSE, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignOddsRatio'>Group sequential design for two-sample odds ratio</h2><span id='topic+getDesignOddsRatio'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for two-sample odds
ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignOddsRatio(
  beta = NA_real_,
  n = NA_real_,
  oddsRatioH0 = 1,
  pi1 = NA_real_,
  pi2 = NA_real_,
  nullVariance = FALSE,
  allocationRatioPlanned = 1,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignOddsRatio_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_oddsratioh0">oddsRatioH0</code></td>
<td>
<p>The odds ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to use the variance under the null
or the empirical variance under the alternative.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatio_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designOddsRatio</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>oddsRatioH0</code>: The odds ratio under the null hypothesis.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyOdddsRatio</code>: The efficacy boundaries on the odds
ratio scale.
</p>
</li>
<li> <p><code>futilityOddsRatio</code>: The futility boundaries on the odds
ratio scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>varianceRatio</code>: The ratio of the variance under H0 to
the variance under H1.
</p>
</li>
<li> <p><code>nullVariance</code>: Whether to use the variance under the null
or the empirical variance under the alternative.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignOddsRatio(
  beta = 0.1, n = NA, pi1 = 0.5, pi2 = 0.3,
  alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignOddsRatioEquiv'>Group sequential design for equivalence in two-sample
odds ratio</h2><span id='topic+getDesignOddsRatioEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for equivalence in
two-sample odds ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignOddsRatioEquiv(
  beta = NA_real_,
  n = NA_real_,
  oddsRatioLower = NA_real_,
  oddsRatioUpper = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  nullVariance = FALSE,
  allocationRatioPlanned = 1,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_oddsratiolower">oddsRatioLower</code></td>
<td>
<p>The lower equivalence limit of odds ratio.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_oddsratioupper">oddsRatioUpper</code></td>
<td>
<p>The upper equivalence limit of odds ratio.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to use the variance under the null
or the empirical variance under the alternative.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignOddsRatioEquiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designOddsRatioEquiv</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The significance level for each of the two one-sided
tests. Defaults to 0.05.
</p>
</li>
<li> <p><code>attainedAlphaH10</code>: The attained significance level under H10.
</p>
</li>
<li> <p><code>attainedAlphaH20</code>: The attained significance level under H20.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH10</code>: The expected information under H10.
</p>
</li>
<li> <p><code>expectedInformationH20</code>: The expected information under H20.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH10</code>: The expected number of subjects
under H10.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH20</code>: The expected number of subjects
under H20.
</p>
</li>
<li> <p><code>oddsRatioLower</code>: The lower equivalence limit of odds ratio.
</p>
</li>
<li> <p><code>oddsRatioUpper</code>: The upper equivalence limit of odds ratio.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>oddsRatio</code>: The odds ratio.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH10</code>: The cumulative alpha attained
under H10.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH20</code>: The cumulative alpha attained
under H20.
</p>
</li>
<li> <p><code>efficacyOddsRatioLower</code>: The efficacy boundaries on the
odds ratio scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyOddsRatioUpper</code>: The efficacy boundaries on the
odds ratio scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>nullVariance</code>: Whether to use the variance under the null
or the empirical variance under the alternative.
</p>
</li>
<li> <p><code>varianceRatioH10</code>: The ratio of the variance under H10 to
the variance under H1.
</p>
</li>
<li> <p><code>varianceRatioH20</code>: The ratio of the variance under H20 to
the variance under H1.
</p>
</li>
<li> <p><code>varianceRatioH12</code>: The ratio of the variance under H10 to
the variance under H20.
</p>
</li>
<li> <p><code>varianceRatioH21</code>: The ratio of the variance under H20 to
the variance under H10.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignOddsRatioEquiv(
  beta = 0.2, n = NA, oddsRatioLower = 0.8,
  oddsRatioUpper = 1.25, pi1 = 0.12, pi2 = 0.12,
  kMax = 3, alpha = 0.05, typeAlphaSpending = "sfOF"))

</code></pre>

<hr>
<h2 id='getDesignOneMean'>Group sequential design for one-sample mean</h2><span id='topic+getDesignOneMean'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for one-sample mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignOneMean(
  beta = NA_real_,
  n = NA_real_,
  meanH0 = 0,
  mean = 0.5,
  stDev = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignOneMean_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_meanh0">meanH0</code></td>
<td>
<p>The mean under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_mean">mean</code></td>
<td>
<p>The mean under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignOneMean_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designOneMean</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>meanH0</code>: The mean under the null hypothesis.
</p>
</li>
<li> <p><code>mean</code>: The mean under the alternative hypothesis.
</p>
</li>
<li> <p><code>stDev</code>: The standard deviation.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyMean</code>: The efficacy boundaries on the mean scale.
</p>
</li>
<li> <p><code>futilityMean</code>: The futility boundaries on the mean scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignOneMean(
  beta = 0.1, n = NA, meanH0 = 7, mean = 6, stDev = 2.5,
  kMax = 5, alpha = 0.025, typeAlphaSpending = "sfOF",
  typeBetaSpending = "sfP"))

# Example 2: sample size calculation for one-sample t-test
(design2 &lt;- getDesignOneMean(
  beta = 0.1, n = NA, meanH0 = 7, mean = 6, stDev = 2.5,
  normalApproximation = FALSE, alpha = 0.025))

</code></pre>

<hr>
<h2 id='getDesignOneMultinom'>Power and sample for one-sample multinomial response</h2><span id='topic+getDesignOneMultinom'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for one-sample multinomial response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignOneMultinom(
  beta = NA_real_,
  n = NA_real_,
  ncats = NA_integer_,
  piH0 = NA_real_,
  pi = NA_real_,
  rounding = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignOneMultinom_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignOneMultinom_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignOneMultinom_+3A_ncats">ncats</code></td>
<td>
<p>The number of categories of the multinomial response.</p>
</td></tr>
<tr><td><code id="getDesignOneMultinom_+3A_pih0">piH0</code></td>
<td>
<p>The prevalence of each category under the null hypothesis.
Only need to provide the values for the first <code>ncats-1</code>
categories.</p>
</td></tr>
<tr><td><code id="getDesignOneMultinom_+3A_pi">pi</code></td>
<td>
<p>The prevalence of each category. Only need to provide the
values for the first <code>ncats-1</code> categories.</p>
</td></tr>
<tr><td><code id="getDesignOneMultinom_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignOneMultinom_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designOneMultinom</code> object with the following
components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis.
</p>
</li>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>ncats</code>: The number of categories of the multinomial response.
</p>
</li>
<li> <p><code>piH0</code>: The prevalence of each category under the null hypothesis.
</p>
</li>
<li> <p><code>pi</code>: The prevalence of each category.
</p>
</li>
<li> <p><code>effectsize</code>: The effect size for the chi-square test.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignOneMultinom(
  beta = 0.1, ncats = 3, piH0 = c(0.25, 0.25),
  pi = c(0.3, 0.4), alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignOneProportion'>Group sequential design for one-sample proportion</h2><span id='topic+getDesignOneProportion'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for one-sample proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignOneProportion(
  beta = NA_real_,
  n = NA_real_,
  piH0 = 0.1,
  pi = 0.2,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignOneProportion_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_pih0">piH0</code></td>
<td>
<p>The response probability under the null hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_pi">pi</code></td>
<td>
<p>The response probability under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the normal approximation will be used, otherwise
the calculations are performed with the binomial distribution. The exact
calculation using the binomial distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignOneProportion_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designOneProportion</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping as well as for the binomial exact test in a fixed
design.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>piH0</code>: The response probability under the null hypothesis.
</p>
</li>
<li> <p><code>pi</code>: The response probability under the alternative
hypothesis.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyResponses</code>: The efficacy boundaries on the number
of responses scale.
</p>
</li>
<li> <p><code>futilityResponses</code>: The futility boundaries on the number
of responses scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the binomial distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignOneProportion(
  beta = 0.2, n = NA, piH0 = 0.15, pi = 0.25,
  kMax = 3, alpha = 0.05, typeAlphaSpending = "sfOF"))

# Example 2: sample size calculation for one-sample binomial exact test
(design2 &lt;- getDesignOneProportion(
  beta = 0.2, n = NA, piH0 = 0.15, pi = 0.25,
  normalApproximation = FALSE, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignOneRateExact'>Power and sample size for one-sample Poisson rate exact test</h2><span id='topic+getDesignOneRateExact'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for one-sample Poisson rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignOneRateExact(
  beta = NA_real_,
  n = NA_real_,
  lambdaH0 = NA_real_,
  lambda = NA_real_,
  D = 1,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignOneRateExact_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignOneRateExact_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignOneRateExact_+3A_lambdah0">lambdaH0</code></td>
<td>
<p>The Poisson rate under the null hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignOneRateExact_+3A_lambda">lambda</code></td>
<td>
<p>The Poisson rate under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignOneRateExact_+3A_d">D</code></td>
<td>
<p>The average exposure per subject.</p>
</td></tr>
<tr><td><code id="getDesignOneRateExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained type I error of the exact test.
</p>
</li>
<li> <p><code>power</code>: The actual power of the exact test.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>lambdaH0</code>: The Poisson rate under the null hypothesis.
</p>
</li>
<li> <p><code>lambda</code>: The Poisson rate under the alternative hypothesis.
</p>
</li>
<li> <p><code>D</code>: The average exposure per subject.
</p>
</li>
<li> <p><code>r</code>: The critical value of the number of events for rejecting
the null hypothesis. Reject H0 if <code>Y &gt;= r</code> for upper-tailed
test, and reject H0 if <code>Y &lt;= r</code> for lower-tailed test.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: power calculation
(design1 &lt;- getDesignOneRateExact(
  n = 525, lambdaH0 = 0.049, lambda = 0.012,
  D = 0.5, alpha = 0.025))

# Example 2: sample size calculation
(design2 &lt;- getDesignOneRateExact(
  beta = 0.2, lambdaH0 = 0.2, lambda = 0.3,
  D = 1, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignOneSlope'>Group sequential design for one-sample slope</h2><span id='topic+getDesignOneSlope'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for one-sample slope.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignOneSlope(
  beta = NA_real_,
  n = NA_real_,
  slopeH0 = 0,
  slope = 0.5,
  stDev = 1,
  stDevCovariate = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignOneSlope_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_slopeh0">slopeH0</code></td>
<td>
<p>The slope under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_slope">slope</code></td>
<td>
<p>The slope under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation of the residual.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_stdevcovariate">stDevCovariate</code></td>
<td>
<p>The standard deviation of the covariate.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignOneSlope_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designOneSlope</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>slopeH0</code>: The slope under the null hypothesis.
</p>
</li>
<li> <p><code>slope</code>: The slope under the alternative hypothesis.
</p>
</li>
<li> <p><code>stDev</code>: The standard deviation of the residual.
</p>
</li>
<li> <p><code>stDevCovariate</code>: The standard deviation of the covariate.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacySlope</code>: The efficacy boundaries on the slope scale.
</p>
</li>
<li> <p><code>futilitySlope</code>: The futility boundaries on the slope scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignOneSlope(
  beta = 0.1, n = NA, slope = 0.5,
  stDev = 15, stDevCovariate = 9,
  normalApproximation = FALSE,
  alpha = 0.025))

</code></pre>

<hr>
<h2 id='getDesignOrderedBinom'>Power and sample size for Cochran-Armitage trend test for
ordered multi-sample binomial response</h2><span id='topic+getDesignOrderedBinom'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for the Cochran-Armitage trend test for ordered
multi-sample binomial response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignOrderedBinom(
  beta = NA_real_,
  n = NA_real_,
  ngroups = NA_integer_,
  pi = NA_real_,
  w = NA_real_,
  allocationRatioPlanned = NA_integer_,
  rounding = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignOrderedBinom_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignOrderedBinom_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignOrderedBinom_+3A_ngroups">ngroups</code></td>
<td>
<p>The number of treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignOrderedBinom_+3A_pi">pi</code></td>
<td>
<p>The response probabilities for the treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignOrderedBinom_+3A_w">w</code></td>
<td>
<p>The scores assigned to the treatment groups. This should
reflect the ordinal nature of the treatment groups, e.g. dose levels.
Defaults to equally spaced scores.</p>
</td></tr>
<tr><td><code id="getDesignOrderedBinom_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignOrderedBinom_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignOrderedBinom_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designOrderedBinom</code> object with the following
components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis.
</p>
</li>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>ngroups</code>: The number of treatment groups.
</p>
</li>
<li> <p><code>pi</code>: The response probabilities for the treatment groups.
</p>
</li>
<li> <p><code>w</code>: The scores assigned to the treatment groups.
</p>
</li>
<li> <p><code>trendstat</code>: The Cochran-Armitage trend test statistic.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the treatment
groups.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignOrderedBinom(
  beta = 0.1, ngroups = 3, pi = c(0.1, 0.25, 0.5), alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignPairedMeanDiff'>Group sequential design for paired mean difference</h2><span id='topic+getDesignPairedMeanDiff'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for paired mean
difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignPairedMeanDiff(
  beta = NA_real_,
  n = NA_real_,
  pairedDiffH0 = 0,
  pairedDiff = 0.5,
  stDev = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignPairedMeanDiff_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_paireddiffh0">pairedDiffH0</code></td>
<td>
<p>The paired difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_paireddiff">pairedDiff</code></td>
<td>
<p>The paired difference under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation for paired difference.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiff_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designPairedMeanDiff</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>pairedDiffH0</code>: The paired difference under the null
hypothesis.
</p>
</li>
<li> <p><code>pairedDiff</code>: The paired difference under the alternative
hypothesis.
</p>
</li>
<li> <p><code>stDev</code>: The standard deviation for paired difference.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyPairedDiff</code>: The efficacy boundaries on the paired
difference scale.
</p>
</li>
<li> <p><code>futilityPairedDiff</code>: The futility boundaries on the paired
difference scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignPairedMeanDiff(
  beta = 0.1, n = NA, pairedDiffH0 = 0, pairedDiff = -2, stDev = 5,
  kMax = 5, alpha = 0.05, typeAlphaSpending = "sfOF"))

# Example 2: sample size calculation for one-sample t-test
(design2 &lt;- getDesignPairedMeanDiff(
  beta = 0.1, n = NA, pairedDiffH0 = 0, pairedDiff = -2, stDev = 5,
  normalApproximation = FALSE, alpha = 0.025))

</code></pre>

<hr>
<h2 id='getDesignPairedMeanDiffEquiv'>Group sequential design for equivalence in paired mean
difference</h2><span id='topic+getDesignPairedMeanDiffEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for equivalence in
paired mean difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignPairedMeanDiffEquiv(
  beta = NA_real_,
  n = NA_real_,
  pairedDiffLower = NA_real_,
  pairedDiffUpper = NA_real_,
  pairedDiff = 0,
  stDev = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_paireddifflower">pairedDiffLower</code></td>
<td>
<p>The lower equivalence limit of paired difference.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_paireddiffupper">pairedDiffUpper</code></td>
<td>
<p>The upper equivalence limit of paired difference.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_paireddiff">pairedDiff</code></td>
<td>
<p>The paired difference under the alternative
hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation for paired difference.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanDiffEquiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designPairedMeanDiffEquiv</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The significance level for each of the two one-sided
tests. Defaults to 0.05.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level under H0.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>pairedDiffLower</code>: The lower equivalence limit of paired
difference.
</p>
</li>
<li> <p><code>pairedDiffUpper</code>: The upper equivalence limit of paired
difference.
</p>
</li>
<li> <p><code>pairedDiff</code>: The paired difference under the alternative
hypothesis.
</p>
</li>
<li> <p><code>stDev</code>: The standard deviation for paired difference.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlpha</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>efficacyPairedDiffLower</code>: The efficacy boundaries on the
paired difference scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyPairedDiffUpper</code>: The efficacy boundaries on the
paired difference scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignPairedMeanDiffEquiv(
  beta = 0.1, n = NA, pairedDiffLower = -1.3, pairedDiffUpper = 1.3,
  pairedDiff = 0, stDev = 2.2,
  kMax = 4, alpha = 0.05, typeAlphaSpending = "sfOF"))

# Example 2: sample size calculation for t-test
(design2 &lt;- getDesignPairedMeanDiffEquiv(
  beta = 0.1, n = NA, pairedDiffLower = -1.3, pairedDiffUpper = 1.3,
  pairedDiff = 0, stDev = 2.2,
  normalApproximation = FALSE, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignPairedMeanRatio'>Group sequential design for paired mean ratio</h2><span id='topic+getDesignPairedMeanRatio'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for paired mean ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignPairedMeanRatio(
  beta = NA_real_,
  n = NA_real_,
  pairedRatioH0 = 1,
  pairedRatio = 1.2,
  CV = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignPairedMeanRatio_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_pairedratioh0">pairedRatioH0</code></td>
<td>
<p>The paired ratio under the null hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_pairedratio">pairedRatio</code></td>
<td>
<p>The paired ratio under the alternative
hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_cv">CV</code></td>
<td>
<p>The coefficient of variation for paired ratio.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatio_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designPairedMeanRatio</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>pairedRatioH0</code>: The paired ratio under the null hypothesis.
</p>
</li>
<li> <p><code>pairedRatio</code>: The paired ratio under the alternative
hypothesis.
</p>
</li>
<li> <p><code>CV</code>: The coefficient of variation for paired ratio.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>efficacyPairedRatio</code>: The efficacy boundaries on the paired
ratio scale.
</p>
</li>
<li> <p><code>futilityPairedRatio</code>: The futility boundaries on the paired
ratio scale.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignPairedMeanRatio(
  beta = 0.1, n = NA, pairedRatio = 1.2, CV = 0.35,
  kMax = 5, alpha = 0.05, typeAlphaSpending = "sfOF"))

# Example 2: sample size calculation for one-sample t-test
(design2 &lt;- getDesignPairedMeanRatio(
  beta = 0.1, n = NA, pairedRatio = 1.2, CV = 0.35,
  normalApproximation = FALSE, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignPairedMeanRatioEquiv'>Group sequential design for equivalence in paired mean ratio</h2><span id='topic+getDesignPairedMeanRatioEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for equivalence in
paired mean ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignPairedMeanRatioEquiv(
  beta = NA_real_,
  n = NA_real_,
  pairedRatioLower = NA_real_,
  pairedRatioUpper = NA_real_,
  pairedRatio = 1,
  CV = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_pairedratiolower">pairedRatioLower</code></td>
<td>
<p>The lower equivalence limit of paired ratio.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_pairedratioupper">pairedRatioUpper</code></td>
<td>
<p>The upper equivalence limit of paired ratio.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_pairedratio">pairedRatio</code></td>
<td>
<p>The paired ratio under the alternative
hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_cv">CV</code></td>
<td>
<p>The coefficient of variation for paired ratio.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignPairedMeanRatioEquiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designPairedMeanRatioEquiv</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The significance level for each of the two one-sided
tests. Defaults to 0.05.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level under H0.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>pairedRatioLower</code>: The lower equivalence limit of paired
ratio.
</p>
</li>
<li> <p><code>pairedRatioUpper</code>: The upper equivalence limit of paired
ratio.
</p>
</li>
<li> <p><code>pairedRatio</code>: The paired ratio under the alternative
hypothesis.
</p>
</li>
<li> <p><code>CV</code>: The coefficient of variation for paired ratios.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlpha</code>: The cumulative alpha attained under
H0.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>:  The cumulative information.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>efficacyPairedRatioLower</code>: The efficacy boundaries on the
paired ratio scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyPairedRatioUpper</code>: The efficacy boundaries on the
paired ratio scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: group sequential trial power calculation
(design1 &lt;- getDesignPairedMeanRatioEquiv(
  beta = 0.1, n = NA, pairedRatioLower = 0.8, pairedRatioUpper = 1.25,
  pairedRatio = 1, CV = 0.35,
  kMax = 4, alpha = 0.05, typeAlphaSpending = "sfOF"))

# Example 2: sample size calculation for t-test
(design2 &lt;- getDesignPairedMeanRatioEquiv(
  beta = 0.1, n = NA, pairedRatioLower = 0.8, pairedRatioUpper = 1.25,
  pairedRatio = 1, CV = 0.35,
  normalApproximation = FALSE, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignPairedPropMcNemar'>Group sequential design for McNemar's test for paired
proportions</h2><span id='topic+getDesignPairedPropMcNemar'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for McNemar's test for
paired proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignPairedPropMcNemar(
  beta = NA_real_,
  n = NA_real_,
  pDiscordant = NA_real_,
  riskDiff = NA_real_,
  nullVariance = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_pdiscordant">pDiscordant</code></td>
<td>
<p>The proportion of discordant pairs
(xi = pi01 + pi10).</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_riskdiff">riskDiff</code></td>
<td>
<p>The risk difference between the active and control
treatments (delta = pi_t - pi_c = pi01 - pi10)</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to use the variance under the null
or the variance under the alternative.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignPairedPropMcNemar_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designPairedPropMcNemar</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>pDiscordant</code>: The proportion of discordant pairs
(xi = pi01 + pi10).
</p>
</li>
<li> <p><code>riskDiff</code>: The risk difference between the active and control
treatments (delta = pi_t - pi_c = pi01 - pi10)
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyRiskDiff</code>: The efficacy boundaries on the risk
difference scale.
</p>
</li>
<li> <p><code>futilityRiskDiff</code>: The futility boundaries on the risk
difference scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>varianceRatio</code>: The ratio of the variance under H0 to the
variance under H1.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: fixed design
(design1 &lt;- getDesignPairedPropMcNemar(
  beta = 0.1, n = NA, pDiscordant = 0.16, riskDiff = 0.1,
  alpha = 0.025))

# Example 2: group sequential design
(design2 &lt;- getDesignPairedPropMcNemar(
  beta = 0.1, n = NA, pDiscordant = 0.16, riskDiff = 0.1,
  alpha = 0.025, kMax = 3, typeAlphaSpending = "sfOF"))

</code></pre>

<hr>
<h2 id='getDesignRepeatedANOVA'>Power and sample size for repeated-measures ANOVA</h2><span id='topic+getDesignRepeatedANOVA'></span>

<h3>Description</h3>

<p>Obtains the power and sample size for one-way repeated
measures analysis of variance. Each subject takes all treatments
in the longitudinal study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRepeatedANOVA(
  beta = NA_real_,
  n = NA_real_,
  ngroups = 2,
  means = NA_real_,
  stDev = 1,
  corr = 0,
  rounding = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRepeatedANOVA_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVA_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVA_+3A_ngroups">ngroups</code></td>
<td>
<p>The number of treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVA_+3A_means">means</code></td>
<td>
<p>The treatment group means.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVA_+3A_stdev">stDev</code></td>
<td>
<p>The total standard deviation.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVA_+3A_corr">corr</code></td>
<td>
<p>The correlation among the repeated measures.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVA_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVA_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">y_{ij}</code> denote the measurement under treatment condition
<code class="reqn">j (j=1,\ldots,k)</code> for subject <code class="reqn">i (i=1,\ldots,n)</code>. Then
</p>
<p style="text-align: center;"><code class="reqn">y_{ij} = \alpha + \beta_j + b_i + e_{ij},</code>
</p>
<p> where <code class="reqn">b_i</code>
denotes the subject random effect, <code class="reqn">b_i \sim N(0, \sigma_b^2),</code>
and <code class="reqn">e_{ij} \sim N(0, \sigma_e^2)</code> denotes the within-subject
residual. If we set <code class="reqn">\beta_k = 0</code>, then <code class="reqn">\alpha</code> is the
mean of the last treatment (control), and <code class="reqn">\beta_j</code> is the
difference in means between the <code class="reqn">j</code>th treatment and the control
for <code class="reqn">j=1,\ldots,k-1</code>.
</p>
<p>The repeated measures have a compound symmetry covariance structure.
Let <code class="reqn">\sigma^2 = \sigma_b^2 + \sigma_e^2</code>, and
<code class="reqn">\rho = \frac{\sigma_b^2}{\sigma_b^2 + \sigma_e^2}</code>. Then
<code class="reqn">Var(y_i) = \sigma^2 \{(1-\rho) I_k + \rho 1_k 1_k^T\}</code>.
Let <code class="reqn">X_i</code> denote the design matrix for subject <code class="reqn">i</code>.
Let <code class="reqn">\theta = (\alpha, \beta_1, \ldots, \beta_{k-1})^T</code>.
It follows that
</p>
<p style="text-align: center;"><code class="reqn">Var(\hat{\theta}) = \left(\sum_{i=1}^{n} X_i^T V_i^{-1}
X_i\right)^{-1}.</code>
</p>
<p> It can be shown that
</p>
<p style="text-align: center;"><code class="reqn">Var(\hat{\beta}) = \frac{\sigma^2 (1-\rho)}{n} (I_{k-1} +
1_{k-1} 1_{k-1}^T).</code>
</p>
<p> It follows that
<code class="reqn">\hat{\beta}^T \hat{V}_{\hat{\beta}}^{-1} \hat{\beta} \sim
F_{k-1,(n-1)(k-1), \lambda},</code> where the noncentrality parameter for
the <code class="reqn">F</code> distribution is </p>
<p style="text-align: center;"><code class="reqn">\lambda =
\beta^T V_{\hat{\beta}}^{-1} \beta = \frac{n \sum_{j=1}^{k}
(\mu_j - \bar{\mu})^2}{\sigma^2(1-\rho)}.</code>
</p>



<h3>Value</h3>

<p>An S3 class <code>designRepeatedANOVA</code> object with the
following components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis that
there is no difference among the treatment groups.
</p>
</li>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The number of subjects.
</p>
</li>
<li> <p><code>ngroups</code>: The number of treatment groups.
</p>
</li>
<li> <p><code>means</code>: The treatment group means.
</p>
</li>
<li> <p><code>stDev</code>: The total standard deviation.
</p>
</li>
<li> <p><code>corr</code>: The correlation among the repeated measures.
</p>
</li>
<li> <p><code>effectsize</code>: The effect size.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignRepeatedANOVA(
  beta = 0.1, ngroups = 4, means = c(1.5, 2.5, 2, 0),
  stDev = 5, corr = 0.2, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignRepeatedANOVAContrast'>Power and sample size for one-way repeated measures ANOVA contrast</h2><span id='topic+getDesignRepeatedANOVAContrast'></span>

<h3>Description</h3>

<p>Obtains the power and sample size for a single contrast
in one-way repeated measures analysis of variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRepeatedANOVAContrast(
  beta = NA_real_,
  n = NA_real_,
  ngroups = 2,
  means = NA_real_,
  stDev = 1,
  corr = 0,
  contrast = NA_real_,
  meanContrastH0 = 0,
  rounding = TRUE,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRepeatedANOVAContrast_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVAContrast_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVAContrast_+3A_ngroups">ngroups</code></td>
<td>
<p>The number of treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVAContrast_+3A_means">means</code></td>
<td>
<p>The treatment group means.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVAContrast_+3A_stdev">stDev</code></td>
<td>
<p>The total standard deviation.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVAContrast_+3A_corr">corr</code></td>
<td>
<p>The correlation among the repeated measures.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVAContrast_+3A_contrast">contrast</code></td>
<td>
<p>The coefficients for the single contrast.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVAContrast_+3A_meancontrasth0">meanContrastH0</code></td>
<td>
<p>The mean of the contrast under the
null hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVAContrast_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignRepeatedANOVAContrast_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designRepeatedANOVAContrast</code> object with
the following components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis for the
treatment contrast.
</p>
</li>
<li> <p><code>alpha</code>: The one-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The number of subjects.
</p>
</li>
<li> <p><code>ngroups</code>: The number of treatment groups.
</p>
</li>
<li> <p><code>means</code>: The treatment group means.
</p>
</li>
<li> <p><code>stDev</code>: The total standard deviation.
</p>
</li>
<li> <p><code>corr</code>: The correlation among the repeated measures.
</p>
</li>
<li> <p><code>contrast</code>: The coefficients for the single contrast.
</p>
</li>
<li> <p><code>meanContrastH0</code>: The mean of the contrast under the null
hypothesis.
</p>
</li>
<li> <p><code>meanContrast</code>: The mean of the contrast under the alternative
hypothesis.
</p>
</li>
<li> <p><code>effectsize</code>: The effect size.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignRepeatedANOVAContrast(
  beta = 0.1, ngroups = 4, means = c(1.5, 2.5, 2, 0),
  stDev = 5, corr = 0.2, contrast = c(1, 1, 1, -3)/3,
  alpha = 0.025))

</code></pre>

<hr>
<h2 id='getDesignRiskDiff'>Group sequential design for two-sample risk difference</h2><span id='topic+getDesignRiskDiff'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for two-sample risk
difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRiskDiff(
  beta = NA_real_,
  n = NA_real_,
  riskDiffH0 = 0,
  pi1 = NA_real_,
  pi2 = NA_real_,
  nullVariance = TRUE,
  allocationRatioPlanned = 1,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRiskDiff_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_riskdiffh0">riskDiffH0</code></td>
<td>
<p>The risk difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to use the variance under the null or
the empirical variance under the alternative.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiff_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designRiskDiff</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>riskDiffH0</code>: The risk difference under the null hypothesis.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyRiskDiff</code>: The efficacy boundaries on the risk
difference scale.
</p>
</li>
<li> <p><code>futilityRiskDiff</code>: The futility boundaries on the risk
difference scale.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>varianceRatio</code>: The ratio of the variance under H0 to
the variance under H1.
</p>
</li>
<li> <p><code>nullVariance</code>: Whether to use the variance under the null or
the empirical variance under the alternative.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignRiskDiff(
  beta = 0.2, n = NA, pi1 = 0.1, pi2 = 0.15,
  kMax = 3, alpha = 0.025, typeAlphaSpending = "sfOF",
  nullVariance = 0))

</code></pre>

<hr>
<h2 id='getDesignRiskDiffEquiv'>Group sequential design for equivalence in two-sample
risk difference</h2><span id='topic+getDesignRiskDiffEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for equivalence in
two-sample risk difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRiskDiffEquiv(
  beta = NA_real_,
  n = NA_real_,
  riskDiffLower = NA_real_,
  riskDiffUpper = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  nullVariance = FALSE,
  allocationRatioPlanned = 1,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_riskdifflower">riskDiffLower</code></td>
<td>
<p>The lower equivalence limit of risk difference.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_riskdiffupper">riskDiffUpper</code></td>
<td>
<p>The upper equivalence limit of risk difference.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to use the variance under the null or
the empirical variance under the alternative.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffEquiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designRiskDiffEquiv</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The significance level for each of the two one-sided
tests. Defaults to 0.05.
</p>
</li>
<li> <p><code>attainedAlphaH10</code>: The attained significance level under H10.
</p>
</li>
<li> <p><code>attainedAlphaH20</code>: The attained significance level under H20.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH10</code>: The expected information under H10.
</p>
</li>
<li> <p><code>expectedInformationH20</code>: The expected information under H20.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH10</code>: The expected number of subjects
under H10.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH20</code>: The expected number of subjects
under H20.
</p>
</li>
<li> <p><code>riskDiffLower</code>: The lower equivalence limit of risk
difference.
</p>
</li>
<li> <p><code>riskDiffUpper</code>: The upper equivalence limit of risk
difference.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>riskDiff</code>: The risk difference.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH10</code>: The cumulative alpha attained
under H10.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH20</code>: The cumulative alpha attained
under H20.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyRiskDiffLower</code>: The efficacy boundaries on the
risk difference scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyRiskDiffUpper</code>: The efficacy boundaries on the
risk difference scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>nullVariance</code>: Whether to use the variance under the null or
the empirical variance under the alternative.
</p>
</li>
<li> <p><code>varianceRatioH10</code>: The ratio of the variance under H10 to
the variance under H1.
</p>
</li>
<li> <p><code>varianceRatioH20</code>: The ratio of the variance under H20 to
the variance under H1.
</p>
</li>
<li> <p><code>varianceRatioH12</code>: The ratio of the variance under H10 to
the variance under H20.
</p>
</li>
<li> <p><code>varianceRatioH21</code>: The ratio of the variance under H20 to
the variance under H10.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignRiskDiffEquiv(
  beta = 0.2, n = NA, riskDiffLower = -0.1,
  riskDiffUpper = 0.1, pi1 = 0.12, pi2 = 0.12,
  nullVariance = 1,
  kMax = 3, alpha = 0.05, typeAlphaSpending = "sfOF"))

</code></pre>

<hr>
<h2 id='getDesignRiskDiffExact'>Power and sample size for exact unconditional test for risk
difference</h2><span id='topic+getDesignRiskDiffExact'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for exact unconditional test of risk difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRiskDiffExact(
  beta = NA_real_,
  n = NA_real_,
  riskDiffH0 = 0,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRiskDiffExact_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExact_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExact_+3A_riskdiffh0">riskDiffH0</code></td>
<td>
<p>The risk difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExact_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExact_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExact_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified one-sided significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained one-sided significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskDiffH0</code>: The risk difference under the null hypothesis.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskDiffBound</code>: The critical value on the scale of
score test statistic for risk difference.
</p>
</li>
<li> <p><code>pi2star</code>: The response probability in the control group
at which the critical value of the test statistic is attained.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Superiority test

getDesignRiskDiffExact(n = 50, pi1 = 0.6, pi2 = 0.25, alpha = 0.025)


# Non-inferiority test

getDesignRiskDiffExact(beta = 0.1, riskDiffH0 = -0.2,
                       pi1 = 0.8, pi2 = 0.8, alpha = 0.025)


</code></pre>

<hr>
<h2 id='getDesignRiskDiffExactEquiv'>Power and sample size for exact unconditional test for
equivalence in risk difference</h2><span id='topic+getDesignRiskDiffExactEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for exact unconditional test of equivalence in risk
difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRiskDiffExactEquiv(
  beta = NA_real_,
  n = NA_real_,
  riskDiffLower = NA_real_,
  riskDiffUpper = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRiskDiffExactEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExactEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExactEquiv_+3A_riskdifflower">riskDiffLower</code></td>
<td>
<p>The lower equivalence limit of risk difference.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExactEquiv_+3A_riskdiffupper">riskDiffUpper</code></td>
<td>
<p>The upper equivalence limit of risk difference.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExactEquiv_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExactEquiv_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExactEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignRiskDiffExactEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified significance level for each of the two
one-sided tests.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskDiffLower</code>: The lower equivalence limit of risk difference.
</p>
</li>
<li> <p><code>riskDiffUpper</code>: The upper equivalence limit of risk difference.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>riskDiff</code>: The risk difference.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskDiffLower</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>zstatRiskDiffUpper</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
getDesignRiskDiffExactEquiv(
  n = 200, riskDiffLower = -0.2, riskDiffUpper = 0.2,
  pi1 = 0.775, pi2 = 0.775, alpha = 0.05)

</code></pre>

<hr>
<h2 id='getDesignRiskRatio'>Group sequential design for two-sample risk ratio</h2><span id='topic+getDesignRiskRatio'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for two-sample risk
ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRiskRatio(
  beta = NA_real_,
  n = NA_real_,
  riskRatioH0 = 1,
  pi1 = NA_real_,
  pi2 = NA_real_,
  nullVariance = TRUE,
  allocationRatioPlanned = 1,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRiskRatio_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_riskratioh0">riskRatioH0</code></td>
<td>
<p>The risk ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to use the variance under the null or
the empirical variance under the alternative.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatio_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designRiskRatio</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>riskRatioH0</code>: The risk ratio under the null hypothesis.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyRiskRatio</code>: The efficacy boundaries on the risk
ratio scale.
</p>
</li>
<li> <p><code>futilityRiskRatio</code>: The futility boundaries on the risk
ratio scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>varianceRatio</code>: The ratio of the variance under H0 to
the variance under H1.
</p>
</li>
<li> <p><code>nullVariance</code>: Whether to use the variance under the null or
the empirical variance under the alternative.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignRiskRatio(
  beta = 0.1, n = NA, pi1 = 0.5, pi2 = 0.3,
  alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignRiskRatioEquiv'>Group sequential design for equivalence in two-sample
risk ratio</h2><span id='topic+getDesignRiskRatioEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for equivalence in
two-sample risk ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRiskRatioEquiv(
  beta = NA_real_,
  n = NA_real_,
  riskRatioLower = NA_real_,
  riskRatioUpper = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  nullVariance = FALSE,
  allocationRatioPlanned = 1,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_riskratiolower">riskRatioLower</code></td>
<td>
<p>The lower equivalence limit of risk ratio.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_riskratioupper">riskRatioUpper</code></td>
<td>
<p>The upper equivalence limit of risk ratio.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to use the variance under the null or
the empirical variance under the alternative.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioEquiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designRiskRatioEquiv</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The significance level for each of the two one-sided
tests. Defaults to 0.05.
</p>
</li>
<li> <p><code>attainedAlphaH10</code>: The attained significance level under H10.
</p>
</li>
<li> <p><code>attainedAlphaH20</code>: The attained significance level under H20.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH10</code>: The expected information under H10.
</p>
</li>
<li> <p><code>expectedInformationH20</code>: The expected information under H20.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH10</code>: The expected number of subjects
under H10.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH20</code>: The expected number of subjects
under H20.
</p>
</li>
<li> <p><code>riskRatioLower</code>: The lower equivalence limit of risk ratio.
</p>
</li>
<li> <p><code>riskRatioUpper</code>: The upper equivalence limit of risk ratio.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>riskRatio</code>: The risk ratio.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH10</code>: The cumulative alpha attained
under H10.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH20</code>: The cumulative alpha attained
under H20.
</p>
</li>
<li> <p><code>efficacyRiskRatioLower</code>: The efficacy boundaries on the
risk ratio scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyRiskRatioUpper</code>: The efficacy boundaries on the
risk ratio scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>nullVariance</code>: Whether to use the variance under the null or
the empirical variance under the alternative.
</p>
</li>
<li> <p><code>varianceRatioH10</code>: The ratio of the variance under H10 to
the variance under H1.
</p>
</li>
<li> <p><code>varianceRatioH20</code>: The ratio of the variance under H20 to
the variance under H1.
</p>
</li>
<li> <p><code>varianceRatioH12</code>: The ratio of the variance under H10 to
the variance under H20.
</p>
</li>
<li> <p><code>varianceRatioH21</code>: The ratio of the variance under H20 to
the variance under H10.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignRiskRatioEquiv(
  beta = 0.2, n = NA, riskRatioLower = 0.8,
  riskRatioUpper = 1.25, pi1 = 0.12, pi2 = 0.12,
  kMax = 3, alpha = 0.05, typeAlphaSpending = "sfOF"))

</code></pre>

<hr>
<h2 id='getDesignRiskRatioExact'>Power and sample size for exact unconditional test for risk
ratio</h2><span id='topic+getDesignRiskRatioExact'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for exact unconditional test of risk ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRiskRatioExact(
  beta = NA_real_,
  n = NA_real_,
  riskRatioH0 = 1,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRiskRatioExact_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExact_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExact_+3A_riskratioh0">riskRatioH0</code></td>
<td>
<p>The risk ratio under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExact_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExact_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExact_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified one-sided significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained one-sided significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskRatioH0</code>: The risk ratio under the null hypothesis.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskRatioBound</code>: The critical value on the scale of
score test statistic for risk ratio.
</p>
</li>
<li> <p><code>pi2star</code>: The response probability in the control group
at which the critical value of the test statistic is attained.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Non-inferiority test

getDesignRiskRatioExact(beta = 0.1, riskRatioH0 = 0.833,
                        pi1 = 0.9, pi2 = 0.9, alpha = 0.025)


</code></pre>

<hr>
<h2 id='getDesignRiskRatioExactEquiv'>Power and sample size for exact unconditional test for
equivalence in risk ratio</h2><span id='topic+getDesignRiskRatioExactEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for exact unconditional test of equivalence in risk
ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRiskRatioExactEquiv(
  beta = NA_real_,
  n = NA_real_,
  riskRatioLower = NA_real_,
  riskRatioUpper = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRiskRatioExactEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExactEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExactEquiv_+3A_riskratiolower">riskRatioLower</code></td>
<td>
<p>The lower equivalence limit of risk ratio.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExactEquiv_+3A_riskratioupper">riskRatioUpper</code></td>
<td>
<p>The upper equivalence limit of risk ratio.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExactEquiv_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExactEquiv_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExactEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioExactEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified significance level for each of the two
one-sided tests.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskRatioLower</code>: The lower equivalence limit of risk ratio.
</p>
</li>
<li> <p><code>riskRatioUpper</code>: The upper equivalence limit of risk ratio.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>riskRatio</code>: The risk ratio.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskRatioLower</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>zstatRiskRatioUpper</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
getDesignRiskRatioExactEquiv(
  n = 200, riskRatioLower = 0.8, riskRatioUpper = 1.25,
  pi1 = 0.775, pi2 = 0.775, alpha = 0.05)

</code></pre>

<hr>
<h2 id='getDesignRiskRatioFM'>Group sequential design for two-sample risk ratio based on
the Farrington-Manning score test</h2><span id='topic+getDesignRiskRatioFM'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for two-sample risk
ratio based on the Farrington-Manning score test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignRiskRatioFM(
  beta = NA_real_,
  n = NA_real_,
  riskRatioH0 = 1,
  pi1 = NA_real_,
  pi2 = NA_real_,
  nullVariance = TRUE,
  allocationRatioPlanned = 1,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignRiskRatioFM_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_riskratioh0">riskRatioH0</code></td>
<td>
<p>The risk ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to use the variance under the null or
the empirical variance under the alternative.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignRiskRatioFM_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designRiskRatioFM</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>riskRatioH0</code>: The risk ratio under the null hypothesis.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyRiskRatioScore</code>: The efficacy boundaries on the
score test <code>pi1 - riskRatioH0*pi2</code> score.
</p>
</li>
<li> <p><code>futilityRiskRatioScore</code>: The futility boundaries on the
score test <code>pi1 - riskRatioH0*pi2</code> scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>varianceRatio</code>: The ratio of the variance under H0 to
the variance under H1.
</p>
</li>
<li> <p><code>nullVariance</code>: Whether to use the variance under the null or
the empirical variance under the alternative.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignRiskRatioFM(
  beta = 0.2, riskRatioH0 = 1.3, pi1 = 0.125, pi2 = 0.125,
  alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignSlopeDiff'>Group sequential design for two-sample slope difference</h2><span id='topic+getDesignSlopeDiff'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for two-sample slope
difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignSlopeDiff(
  beta = NA_real_,
  n = NA_real_,
  slopeDiffH0 = 0,
  slopeDiff = 0.5,
  stDev = 1,
  stDevCovariate = 1,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignSlopeDiff_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_slopediffh0">slopeDiffH0</code></td>
<td>
<p>The slope difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_slopediff">slopeDiff</code></td>
<td>
<p>The slope difference under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation of the residual.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_stdevcovariate">stDevCovariate</code></td>
<td>
<p>The standard deviation of the covariate.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The exact
calculation using the t distribution is only implemented for the
fixed design.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiff_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designSlopeDiff</code> object with three components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>slopeDiffH0</code>: The slope difference under the null hypothesis.
</p>
</li>
<li> <p><code>slopeDiff</code>: The slope difference under the alternative
hypothesis.
</p>
</li>
<li> <p><code>stDev</code>: The standard deviation of the residual.
</p>
</li>
<li> <p><code>stDevCovariate</code>: The standard deviation of the covariate.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacySlopeDiff</code>: The efficacy boundaries on the slope
difference scale.
</p>
</li>
<li> <p><code>futilitySlopeDiff</code>: The futility boundaries on the slope
difference scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignSlopeDiff(
  beta = 0.1, n = NA, slopeDiff = -0.5,
  stDev = 10, stDevCovariate = 6,
  normalApproximation = FALSE, alpha = 0.025))

</code></pre>

<hr>
<h2 id='getDesignSlopeDiffMMRM'>Group sequential design for two-sample slope difference
from the MMRM model</h2><span id='topic+getDesignSlopeDiffMMRM'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for two-sample slope difference from the growth curve
MMRM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignSlopeDiffMMRM(
  beta = NA_real_,
  slopeDiffH0 = 0,
  slopeDiff = 0.5,
  stDev = 1,
  stDevIntercept = 1,
  stDevSlope = 1,
  corrInterceptSlope = 0.5,
  w = NA_real_,
  N = NA_real_,
  accrualTime = 0,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0,
  gamma1 = 0,
  gamma2 = 0,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  allocationRatioPlanned = 1,
  normalApproximation = TRUE,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_slopediffh0">slopeDiffH0</code></td>
<td>
<p>The slope difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_slopediff">slopeDiff</code></td>
<td>
<p>The slope difference under the alternative
hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_stdev">stDev</code></td>
<td>
<p>The standard deviation of the residual.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_stdevintercept">stDevIntercept</code></td>
<td>
<p>The standard deviation of the random intercept.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_stdevslope">stDevSlope</code></td>
<td>
<p>The standard deviation of the random slope.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_corrinterceptslope">corrInterceptSlope</code></td>
<td>
<p>The correlation between the random
intercept and random slope.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_w">w</code></td>
<td>
<p>The number of time units per measurement visit in a period.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_n">N</code></td>
<td>
<p>The number of measurement visits in a period.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the active
treatment group.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the control group.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_normalapproximation">normalApproximation</code></td>
<td>
<p>The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution. The
degrees of freedom for the t-distribution for testing the slope
difference is calculated using the containment method, and
is equal to the total number of observations minus two times
the total number of subjects. The exact calculation using the
t distribution is only implemented for the fixed design.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Defaults to
<code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignSlopeDiffMMRM_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We use the following random-effects model to compare two slopes:
</p>
<p style="text-align: center;"><code class="reqn">y_{ij} = \alpha + (\beta + \gamma x_i) t_j + a_i + b_i t_j
+ e_{ij},</code>
</p>
<p> where
</p>

<ul>
<li> <p><code class="reqn">\alpha</code>: overall intercept common across treatment groups
due to randomization
</p>
</li>
<li> <p><code class="reqn">\beta</code>: slope for the control group
</p>
</li>
<li> <p><code class="reqn">\gamma</code>: difference in slopes between the active treatment and
control groups
</p>
</li>
<li> <p><code class="reqn">x_i</code>: treatment indicator for subject <code class="reqn">i</code>,
1 for the active treatment and 0 for the control
</p>
</li>
<li> <p><code class="reqn">t_j</code>: time point <code class="reqn">j</code> for repeated measurements,
<code class="reqn">t_1 = 0 &lt; t_2 &lt; \ldots &lt; t_k</code>
</p>
</li>
<li> <p><code class="reqn">(a_i, b_i)</code>: random intercept and random slope
for subject <code class="reqn">i</code>, <code class="reqn">Var(a_i) = \sigma_a^2</code>,
<code class="reqn">Var(b_i) = \sigma_b^2</code>, <code class="reqn">Corr(a_i, b_i) = \rho</code>
</p>
</li>
<li> <p><code class="reqn">e_{ij}</code>: within-subject residual with variance <code class="reqn">\sigma_e^2</code>
</p>
</li></ul>

<p>By accounting for randomization, we improve the efficiency for
estimating the difference in slopes. We also allow for non-equal
spacing of the time points and missing data due to dropouts.
</p>


<h3>Value</h3>

<p>An S3 class <code>designSlopeDiffMMRM</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>studyDuration</code>: The maximum study duration.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>expectedStudyDurationH1</code>: The expected study duration
under H1.
</p>
</li>
<li> <p><code>expectedStudyDurationH0</code>: The expected study duration
under H0.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up time.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>slopeDiffH0</code>: The slope difference under H0.
</p>
</li>
<li> <p><code>slopeDiff</code>: The slope difference under H1.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacySlopeDiff</code>: The efficacy boundaries on the slope
difference scale.
</p>
</li>
<li> <p><code>futilitySlopeDiff</code>: The futility boundaries on the slope
difference scale.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: The allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>accrualTime</code>: A vector that specifies the starting time of
piecewise Poisson enrollment time intervals.
</p>
</li>
<li> <p><code>accrualIntensity</code>: A vector of accrual intensities.
One for each accrual time interval.
</p>
</li>
<li> <p><code>piecewiseSurvivalTime</code>: A vector that specifies the
starting time of piecewise exponential survival time intervals.
</p>
</li>
<li> <p><code>gamma1</code>: The hazard rate for exponential dropout or
a vector of hazard rates for piecewise exponential dropout
for the active treatment group.
</p>
</li>
<li> <p><code>gamma2</code>: The hazard rate for exponential dropout or
a vector of hazard rates for piecewise exponential dropout
for the control group.
</p>
</li>
<li> <p><code>w</code>: The number of time units per measurement visit in a
period.
</p>
</li>
<li> <p><code>N</code>: The number of measurement visits in a period.
</p>
</li>
<li> <p><code>stdDev</code>: The standard deviation of the residual.
</p>
</li>
<li> <p><code>G</code>: The covariance matrix for the random intercept and
random slope.
</p>
</li>
<li> <p><code>normalApproximation</code>: The type of computation of the p-values.
If <code>TRUE</code>, the variance is assumed to be known, otherwise
the calculations are performed with the t distribution.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Daniel O. Scharfstein, Anastasios A. Tsiatis, and James M. Robins.
Semiparametric efficiency and its implication on the
design and analysis of group-sequential studies.
Journal of the American Statistical Association 1997; 92:1342-1350.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignSlopeDiffMMRM(
  beta = 0.2, slopeDiff = log(1.15)/52,
  stDev = sqrt(.182),
  stDevIntercept = sqrt(.238960),
  stDevSlope = sqrt(.000057),
  corrInterceptSlope = .003688/sqrt(.238960*.000057),
  w = 8,
  N = 10000,
  accrualIntensity = 15,
  gamma1 = 1/(4.48*52),
  gamma2 = 1/(4.48*52),
  accrualDuration = NA,
  followupTime = 8,
  alpha = 0.025))

</code></pre>

<hr>
<h2 id='getDesignTwoMultinom'>Power and sample for difference in two-sample multinomial responses</h2><span id='topic+getDesignTwoMultinom'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for difference in two-sample multinomial responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignTwoMultinom(
  beta = NA_real_,
  n = NA_real_,
  ncats = NA_integer_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  rounding = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignTwoMultinom_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignTwoMultinom_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignTwoMultinom_+3A_ncats">ncats</code></td>
<td>
<p>The number of categories of the multinomial response.</p>
</td></tr>
<tr><td><code id="getDesignTwoMultinom_+3A_pi1">pi1</code></td>
<td>
<p>The prevalence of each category for the treatment group.
Only need to specify the valued for the first <code>ncats-1</code> categories.</p>
</td></tr>
<tr><td><code id="getDesignTwoMultinom_+3A_pi2">pi2</code></td>
<td>
<p>The prevalence of each category for the control group.
Only need to specify the valued for the first <code>ncats-1</code> categories.</p>
</td></tr>
<tr><td><code id="getDesignTwoMultinom_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignTwoMultinom_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignTwoMultinom_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designTwoMultinom</code> object with the following
components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis.
</p>
</li>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>ncats</code>: The number of categories of the multinomial response.
</p>
</li>
<li> <p><code>pi1</code>: The prevalence of each category for the treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The prevalence of each category for the control group.
</p>
</li>
<li> <p><code>effectsize</code>: The effect size for the chi-square test.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active treatment
versus control.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignTwoMultinom(
  beta = 0.1, ncats = 3, pi1 = c(0.3, 0.35),
  pi2 = c(0.2, 0.3), alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignTwoOrdinal'>Power and sample size for the Wilcoxon test for two-sample
ordinal response</h2><span id='topic+getDesignTwoOrdinal'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for the Wilcoxon test for two-sample ordinal response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignTwoOrdinal(
  beta = NA_real_,
  n = NA_real_,
  ncats = NA_integer_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  rounding = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignTwoOrdinal_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignTwoOrdinal_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignTwoOrdinal_+3A_ncats">ncats</code></td>
<td>
<p>The number of categories of the ordinal response.</p>
</td></tr>
<tr><td><code id="getDesignTwoOrdinal_+3A_pi1">pi1</code></td>
<td>
<p>The prevalence of each category for the treatment group.
Only need to specify the valued for the first <code>ncats-1</code> categories.</p>
</td></tr>
<tr><td><code id="getDesignTwoOrdinal_+3A_pi2">pi2</code></td>
<td>
<p>The prevalence of each category for the control group.
Only need to specify the valued for the first <code>ncats-1</code> categories.</p>
</td></tr>
<tr><td><code id="getDesignTwoOrdinal_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignTwoOrdinal_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignTwoOrdinal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designTwoOrdinal</code> object with the following
components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis.
</p>
</li>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>ncats</code>: The number of categories of the ordinal response.
</p>
</li>
<li> <p><code>pi1</code>: The prevalence of each category for the treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The prevalence of each category for the control group.
</p>
</li>
<li> <p><code>meanscore1</code>: The mean midrank score for the treatment group.
</p>
</li>
<li> <p><code>meanscore2</code>: The mean midrank score for the control group.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active treatment
versus control.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignTwoOrdinal(
  beta = 0.1, ncats = 4, pi1 = c(0.55, 0.3, 0.1),
  pi2 = c(0.214, 0.344, 0.251), alpha = 0.025))

</code></pre>

<hr>
<h2 id='getDesignTwoWayANOVA'>Power and sample size for two-way ANOVA</h2><span id='topic+getDesignTwoWayANOVA'></span>

<h3>Description</h3>

<p>Obtains the power and sample size for two-way
analysis of variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignTwoWayANOVA(
  beta = NA_real_,
  n = NA_real_,
  nlevelsA = 2,
  nlevelsB = 2,
  means = NA_real_,
  stDev = 1,
  rounding = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignTwoWayANOVA_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignTwoWayANOVA_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignTwoWayANOVA_+3A_nlevelsa">nlevelsA</code></td>
<td>
<p>The number of groups for Factor A.</p>
</td></tr>
<tr><td><code id="getDesignTwoWayANOVA_+3A_nlevelsb">nlevelsB</code></td>
<td>
<p>The number of levels for Factor B.</p>
</td></tr>
<tr><td><code id="getDesignTwoWayANOVA_+3A_means">means</code></td>
<td>
<p>The matrix of treatment means for Factors A and B
combination.</p>
</td></tr>
<tr><td><code id="getDesignTwoWayANOVA_+3A_stdev">stDev</code></td>
<td>
<p>The common standard deviation.</p>
</td></tr>
<tr><td><code id="getDesignTwoWayANOVA_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignTwoWayANOVA_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designTwoWayANOVA</code> object with the following
components:
</p>

<ul>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>nlevelsA</code>: The number of levels for Factor A.
</p>
</li>
<li> <p><code>nlevelsB</code>: The number of levels for Factor B.
</p>
</li>
<li> <p><code>means</code>: The matrix of treatment group means.
</p>
</li>
<li> <p><code>stDev</code>: The common standard deviation.
</p>
</li>
<li> <p><code>effectsizeA</code>: The effect size for Factor A.
</p>
</li>
<li> <p><code>effectsizeB</code>: The effect size for Factor B.
</p>
</li>
<li> <p><code>effectsizeAB</code>: The effect size for Factor A and Factor B
interaction.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li>
<li> <p><code>powerdf</code>: The data frame containing the power and sample size
results. It has the following variables:
</p>

<ul>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>powerA</code>: The power to reject the null hypothesis that
there is no difference among Factor A levels.
</p>
</li>
<li> <p><code>powerB</code>: The power to reject the null hypothesis that
there is no difference among Factor B levels.
</p>
</li>
<li> <p><code>powerAB</code>: The power to reject the null hypothesis that
there is no interaction between Factor A and Factor B.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignTwoWayANOVA(
  beta = 0.1, nlevelsA = 2, nlevelsB = 2,
  means = matrix(c(0.5, 4.7, 0.4, 6.9), 2, 2, byrow = TRUE),
  stDev = 2, alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignUnorderedBinom'>Power and sample size for unordered multi-sample binomial response</h2><span id='topic+getDesignUnorderedBinom'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for the chi-square test for unordered multi-sample
binomial response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignUnorderedBinom(
  beta = NA_real_,
  n = NA_real_,
  ngroups = NA_integer_,
  pi = NA_real_,
  allocationRatioPlanned = NA_integer_,
  rounding = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignUnorderedBinom_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedBinom_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedBinom_+3A_ngroups">ngroups</code></td>
<td>
<p>The number of treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedBinom_+3A_pi">pi</code></td>
<td>
<p>The response probabilities for the treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedBinom_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedBinom_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedBinom_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designUnorderedBinom</code> object with the following
components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis.
</p>
</li>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>ngroups</code>: The number of treatment groups.
</p>
</li>
<li> <p><code>pi</code>: The response probabilities for the treatment groups.
</p>
</li>
<li> <p><code>effectsize</code>: The effect size for the chi-square test.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the treatment
groups.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignUnorderedBinom(
  beta = 0.1, ngroups = 3, pi = c(0.1, 0.25, 0.5), alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignUnorderedMultinom'>Power and sample size for unordered multi-sample
multinomial response</h2><span id='topic+getDesignUnorderedMultinom'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for the chi-square test for unordered multi-sample
multinomial response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignUnorderedMultinom(
  beta = NA_real_,
  n = NA_real_,
  ngroups = NA_integer_,
  ncats = NA_integer_,
  pi = NA_real_,
  allocationRatioPlanned = NA_integer_,
  rounding = TRUE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignUnorderedMultinom_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedMultinom_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedMultinom_+3A_ngroups">ngroups</code></td>
<td>
<p>The number of treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedMultinom_+3A_ncats">ncats</code></td>
<td>
<p>The number of categories of the multinomial response.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedMultinom_+3A_pi">pi</code></td>
<td>
<p>The matrix of response probabilities for the treatment groups.
It should have <code>ngroups</code> rows and <code>ncats-1</code> or <code>ncats</code>
columns.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedMultinom_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the treatment groups.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedMultinom_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignUnorderedMultinom_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designUnorderedMultinom</code> object with the
following components:
</p>

<ul>
<li> <p><code>power</code>: The power to reject the null hypothesis.
</p>
</li>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>n</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>ngroups</code>: The number of treatment groups.
</p>
</li>
<li> <p><code>ncats</code>: The number of categories of the multinomial response.
</p>
</li>
<li> <p><code>pi</code>: The response probabilities for the treatment groups.
</p>
</li>
<li> <p><code>effectsize</code>: The effect size for the chi-square test.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the treatment
groups.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- getDesignUnorderedMultinom(
  beta = 0.1, ngroups = 3, ncats = 4,
  pi = matrix(c(0.230, 0.320, 0.272,
                0.358, 0.442, 0.154,
                0.142, 0.036, 0.039),
              3, 3, byrow = TRUE),
  allocationRatioPlanned = c(2, 2, 1),
  alpha = 0.05))

</code></pre>

<hr>
<h2 id='getDesignWilcoxon'>Group sequential design for two-sample Wilcoxon test</h2><span id='topic+getDesignWilcoxon'></span>

<h3>Description</h3>

<p>Obtains the power given sample size or obtains the sample
size given power for a group sequential design for two-sample
Wilcoxon test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesignWilcoxon(
  beta = NA_real_,
  n = NA_real_,
  pLarger = 0.6,
  allocationRatioPlanned = 1,
  rounding = TRUE,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesignWilcoxon_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_plarger">pLarger</code></td>
<td>
<p>The probability that a randomly chosen sample from
the treatment group is larger than a randomly chosen sample from the
control group under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size. Defaults to 1 for
sample size rounding.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates. Fixed prior to the trial.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getDesignWilcoxon_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>designWilcoxon</code> object with three
components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level, which is
different from the overall significance level in the presence of
futility stopping..
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>theta</code>: The parameter value.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedInformationH1</code>: The expected information under H1.
</p>
</li>
<li> <p><code>expectedInformationH0</code>: The expected information under H0.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>theta*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The maximum number of subjects.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH1</code>: The expected number of subjects
under H1.
</p>
</li>
<li> <p><code>expectedNumberOfSubjectsH0</code>: The expected number of subjects
under H0.
</p>
</li>
<li> <p><code>pLarger</code>: The probability that a randomly chosen sample from
the treatment group is larger than a randomly chosen sample from the
control group under the alternative hypothesis.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li>
<li> <p><code>rejectPerStageH0</code>: The probability for efficacy stopping
under H0.
</p>
</li>
<li> <p><code>futilityPerStageH0</code>: The probability for futility stopping
under H0.
</p>
</li>
<li> <p><code>cumulativeRejectionH0</code>: The cumulative probability for
efficacy stopping under H0.
</p>
</li>
<li> <p><code>cumulativeFutilityH0</code>: The cumulative probability for futility
stopping under H0.
</p>
</li>
<li> <p><code>efficacyPLarger</code>: The efficacy boundaries on the proportion
of pairs of samples from the two treatment groups with the sample
from the treatment group greater than that from the control group.
</p>
</li>
<li> <p><code>futilityPLarger</code>: The futility boundaries on the proportion
of pairs of samples from the two treatment groups with the sample
from the treatment group greater than that from the control group.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
</p>

<ul>
<li> <p><code>typeAlphaSpending</code>: The type of alpha spending.
</p>
</li>
<li> <p><code>parameterAlphaSpending</code>: The parameter value for alpha
spending.
</p>
</li>
<li> <p><code>userAlphaSpending</code>: The user defined alpha spending.
</p>
</li>
<li> <p><code>typeBetaSpending</code>: The type of beta spending.
</p>
</li>
<li> <p><code>parameterBetaSpending</code>: The parameter value for beta spending.
</p>
</li>
<li> <p><code>userBetaSpending</code>: The user defined beta spending.
</p>
</li>
<li> <p><code>spendingTime</code>: The error spending time at each analysis.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>rounding</code>: Whether to round up sample size.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: fixed design
(design1 &lt;- getDesignWilcoxon(
  beta = 0.1, n = NA,
  pLarger = pnorm((8 - 2)/sqrt(2*25^2)), alpha = 0.025))

# Example 2: group sequential design
(design2 &lt;- getDesignWilcoxon(
  beta = 0.1, n = NA,
  pLarger = pnorm((8 - 2)/sqrt(2*25^2)), alpha = 0.025,
  kMax = 3, typeAlphaSpending = "sfOF"))

</code></pre>

<hr>
<h2 id='getDurationFromNevents'>Range of accrual duration for target number of events</h2><span id='topic+getDurationFromNevents'></span>

<h3>Description</h3>

<p>Obtains a range of accrual duration to reach the
target number of events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDurationFromNevents(
  nevents = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  npoints = 23L,
  interval = as.numeric(c(0.001, 240))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDurationFromNevents_+3A_nevents">nevents</code></td>
<td>
<p>The target number of events.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subjects.
Must be provided for fixed follow-up design.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_npoints">npoints</code></td>
<td>
<p>The number of accrual duration time points.
Defaults to 23.</p>
</td></tr>
<tr><td><code id="getDurationFromNevents_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of the following variables:
</p>

<ul>
<li> <p><code>nevents</code>: The target number of events.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>subjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up time for the last enrolled subject.
</p>
</li>
<li> <p><code>studyDuration</code>: The study duration.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.

getDurationFromNevents(
  nevents = 80, allocationRatioPlanned = 1,
  accrualTime = seq(0, 8),
  accrualIntensity = 26/9*seq(1, 9),
  piecewiseSurvivalTime = c(0, 6),
  stratumFraction = c(0.2, 0.8),
  lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
  lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
  gamma1 = -log(1-0.05)/12,
  gamma2 = -log(1-0.05)/12,
  fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='getNeventsFromHazardRatio'>Get the required number of events given hazard ratio</h2><span id='topic+getNeventsFromHazardRatio'></span>

<h3>Description</h3>

<p>Obtains the required number of events given the hazard
ratios under the null and alternative hypotheses for a group
sequential design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNeventsFromHazardRatio(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  spendingTime = NA_real_,
  hazardRatioH0 = 1,
  hazardRatio = NA_real_,
  allocationRatioPlanned = 1,
  rounding = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNeventsFromHazardRatio_+3A_beta">beta</code></td>
<td>
<p>Type II error. Defaults to 0.2.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates in terms of number of
events. Fixed prior to the trial. Defaults to <code>(1:kMax) / kMax</code>
if left unspecified.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_hazardratioh0">hazardRatioH0</code></td>
<td>
<p>Hazard ratio under the null hypothesis for the active
treatment versus control. Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_hazardratio">hazardRatio</code></td>
<td>
<p>Hazard ratio under the alternative hypothesis
for the active treatment versus control. Defaults to 0.5.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="getNeventsFromHazardRatio_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up the number of events.
Defaults to 1 for rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The required number of events.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
getNeventsFromHazardRatio(
  beta = 0.2, kMax = 2,
  informationRates = c(0.5,1),
  alpha = 0.025, typeAlphaSpending = "sfOF",
  typeBetaSpending = "sfP",
  hazardRatio = 0.673)

</code></pre>

<hr>
<h2 id='getRCI'>Repeated confidence interval for group sequential design</h2><span id='topic+getRCI'></span>

<h3>Description</h3>

<p>Obtains the repeated confidence interval
for a group sequential trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRCI(
  L = NA_integer_,
  zL = NA_real_,
  IMax = NA_real_,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  spendingTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRCI_+3A_l">L</code></td>
<td>
<p>The look of interest.</p>
</td></tr>
<tr><td><code id="getRCI_+3A_zl">zL</code></td>
<td>
<p>The z-test statistic at the look.</p>
</td></tr>
<tr><td><code id="getRCI_+3A_imax">IMax</code></td>
<td>
<p>The maximum information of the trial.</p>
</td></tr>
<tr><td><code id="getRCI_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates up to look <code>L</code>.</p>
</td></tr>
<tr><td><code id="getRCI_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is
allowed at each stage up to look <code>L</code>. Defaults to true
if left unspecified.</p>
</td></tr>
<tr><td><code id="getRCI_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>The upper boundaries on the z-test statistic scale
for efficacy stopping up to look <code>L</code>.</p>
</td></tr>
<tr><td><code id="getRCI_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="getRCI_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending.
One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries,
&quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries,
&quot;sfOF&quot; for O'Brien-Fleming type spending function,
&quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and
&quot;none&quot; for no early efficacy stopping.
Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="getRCI_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value of alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="getRCI_+3A_spendingtime">spendingTime</code></td>
<td>
<p>The error spending time up to look <code>L</code>.
Defaults to missing, in which case, it is the same as
<code>informationRates</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following components:
</p>

<ul>
<li> <p><code>pvalue</code>: Repeated p-value for rejecting the null hypothesis.
</p>
</li>
<li> <p><code>thetahat</code>: Point estimate of the parameter.
</p>
</li>
<li> <p><code>cilevel</code>: Confidence interval level.
</p>
</li>
<li> <p><code>lower</code>: Lower bound of repeated confidence interval.
</p>
</li>
<li> <p><code>upper</code>: Upper bound of repeated confidence interval.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Christopher Jennison and Bruce W. Turnbull.
Interim analyses: the repeated confidence interval approach
(with discussion).
J R Stat Soc Series B. 1989;51:305-361.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# group sequential design with 90% power to detect delta = 6
delta = 6
sigma = 17
n = 282
(des1 = getDesign(IMax = n/(4*sigma^2), theta = delta, kMax = 3,
                  alpha = 0.05, typeAlphaSpending = "sfHSD",
                  parameterAlphaSpending = -4))

# results at the second look
L = 2
n1 = n*2/3
delta1 = 7
sigma1 = 20
zL = delta1/sqrt(4/n1*sigma1^2)

# repeated confidence interval
getRCI(L = L, zL = zL, IMax = n/(4*sigma1^2),
       informationRates = c(1/3, 2/3), alpha = 0.05,
       typeAlphaSpending = "sfHSD", parameterAlphaSpending = -4)

</code></pre>

<hr>
<h2 id='hd'>Integrated event probability over an interval with constant hazard</h2><span id='topic+hd'></span>

<h3>Description</h3>

<p>Obtains the integration probability of having an event
during an interval with constant hazard.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hd(
  j = NA_integer_,
  t1 = NA_real_,
  t2 = NA_real_,
  piecewiseSurvivalTime = 0L,
  lambda = NA_real_,
  gamma = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hd_+3A_j">j</code></td>
<td>
<p>The analysis time interval with constant hazard.</p>
</td></tr>
<tr><td><code id="hd_+3A_t1">t1</code></td>
<td>
<p>Lower bound of the analysis time interval.</p>
</td></tr>
<tr><td><code id="hd_+3A_t2">t2</code></td>
<td>
<p>Upper bound of the analysis time interval.</p>
</td></tr>
<tr><td><code id="hd_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="hd_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event. One for
each analysis time interval.</p>
</td></tr>
<tr><td><code id="hd_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value for the integrated probability of having an event
during an interval with constant hazard for a treatment
group with specified piecewise exponential survival and dropout
distributions.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise exponential survival with hazard 0.0533 in the first 6
# months, and hazard 0.0309 thereafter, and 5% dropout by the end of
# 1 year.

hd(j = 1, t1 = 1, t2 = 3, piecewiseSurvivalTime = c(0, 6),
   lambda = c(0.0533, 0.0309), gamma = -log(1-0.05)/12)

</code></pre>

<hr>
<h2 id='heart'>Stanford heart transplant data from the survival package</h2><span id='topic+heart'></span>

<h3>Description</h3>

<p>Survival of patients on the waiting list for the Stanford heart
transplant program.
</p>

<dl>
<dt><code>start, stop, event</code></dt><dd><p>entry and exit time and status for
the time interval</p>
</dd>
<dt><code>age</code></dt><dd><p>age-48 years</p>
</dd>
<dt><code>year</code></dt><dd><p>year of acceptance (in years after Nov 1, 1967)</p>
</dd>
<dt><code>surgery</code></dt><dd><p>prior bypass surgery 1=yes, 0=no</p>
</dd>
<dt><code>transplant</code></dt><dd><p>received transplant 1=yes, 0=no</p>
</dd>
<dt><code>id</code></dt><dd><p>patient id</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>heart
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 172 rows and 8 columns.
</p>

<hr>
<h2 id='hedgesg'>Hedges' g effect size</h2><span id='topic+hedgesg'></span>

<h3>Description</h3>

<p>Obtains Hedges' g estimate and confidence interval of
effect size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hedgesg(tstat, m, ntilde, cilevel = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hedgesg_+3A_tstat">tstat</code></td>
<td>
<p>The value of the t-test statistic for comparing two
treatment conditions.</p>
</td></tr>
<tr><td><code id="hedgesg_+3A_m">m</code></td>
<td>
<p>The degrees of freedom for the t-test.</p>
</td></tr>
<tr><td><code id="hedgesg_+3A_ntilde">ntilde</code></td>
<td>
<p>The normalizing sample size to convert the
standardized treatment difference to the t-test statistic, i.e.,
<code>tstat = sqrt(ntilde)*meanDiff/stDev</code>.</p>
</td></tr>
<tr><td><code id="hedgesg_+3A_cilevel">cilevel</code></td>
<td>
<p>The confidence interval level. Defaults to 0.95.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Hedges' <code class="reqn">g</code> is an effect size measure commonly used in meta-analysis
to quantify the difference between two groups. It's an improvement
over Cohen's <code class="reqn">d</code>, particularly when dealing with small sample sizes.
</p>
<p>The formula for Hedges' <code class="reqn">g</code> is </p>
<p style="text-align: center;"><code class="reqn">g = c(m) d,</code>
</p>
<p> where <code class="reqn">d</code>
is Cohen's <code class="reqn">d</code> effect size estimate, and <code class="reqn">c(m)</code> is the bias
correction factor, </p>
<p style="text-align: center;"><code class="reqn">d = (\hat{\mu}_1 - \hat{\mu}_2)/\hat{\sigma},</code>
</p>

<p style="text-align: center;"><code class="reqn">c(m) = 1 - \frac{3}{4m-1}.</code>
</p>

<p>Since <code class="reqn">c(m) &lt; 1</code>, Cohen's <code class="reqn">d</code> overestimates the true effect size.
<code class="reqn">\delta = (\mu_1 - \mu_2)/\sigma.</code>
Since </p>
<p style="text-align: center;"><code class="reqn">t = \sqrt{\tilde{n}} d,</code>
</p>
<p> we have
</p>
<p style="text-align: center;"><code class="reqn">g = \frac{c(m)}{\sqrt{\tilde{n}}} t,</code>
</p>
<p> where <code class="reqn">t</code>
has a noncentral <code class="reqn">t</code> distribution with <code class="reqn">m</code> degrees of freedom
and noncentrality parameter <code class="reqn">\sqrt{\tilde{n}} \delta</code>.
</p>
<p>The asymptotic variance of <code class="reqn">g</code> can be approximated by
</p>
<p style="text-align: center;"><code class="reqn">Var(g) = \frac{1}{\tilde{n}} + \frac{g^2}{2m}.</code>
</p>

<p>The confidence interval for <code class="reqn">\delta</code>
can be constructed using normal approximation.
</p>
<p>For two-sample mean difference with sample size <code class="reqn">n_1</code> for the
treatment group and <code class="reqn">n_2</code> for the control group, we have
<code class="reqn">\tilde{n} = \frac{n_1n_2}{n_1+n_2}</code> and <code class="reqn">m=n_1+n_2-2</code>
for pooled variance estimate.
</p>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>tstat</code>: The value of the <code>t</code> test statistic.
</p>
</li>
<li> <p><code>m</code>: The degrees of freedom for the t-test.
</p>
</li>
<li> <p><code>ntilde</code>: The normalizing sample size to convert the
standardized treatment difference to the t-test statistic.
</p>
</li>
<li> <p><code>g</code>: Hedges' <code>g</code> effect size estimate.
</p>
</li>
<li> <p><code>varg</code>: Variance of <code>g</code>.
</p>
</li>
<li> <p><code>lower</code>: The lower confidence limit for effect size.
</p>
</li>
<li> <p><code>upper</code>: The upper confidence limit for effect size.
</p>
</li>
<li> <p><code>cilevel</code>: The confidence interval level.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>References</h3>

<p>Larry V. Hedges. Distribution theory for Glass's estimator of
effect size and related estimators.
Journal of Educational Statistics 1981; 6:107-128.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n1 = 7
n2 = 8
meanDiff = 0.444
stDev = 1.201
m = n1+n2-2
ntilde = n1*n2/(n1+n2)
tstat = sqrt(ntilde)*meanDiff/stDev

hedgesg(tstat, m, ntilde)

</code></pre>

<hr>
<h2 id='immdef'>Simulated Concorde trial data from the rpsftm package</h2><span id='topic+immdef'></span>

<h3>Description</h3>

<p>Patients were randomly assigned to receive treatment immediately
or deferred, and those in the deferred arm could cross over and
receive treatment. The primary endpoint was time to disease progression.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Patient identification number</p>
</dd>
<dt><code>def</code></dt><dd><p>Indicator that the participant was assigned to
the deferred treatment arm</p>
</dd>
<dt><code>imm</code></dt><dd><p>Indicator that the participant was assigned to
the immediate treatment arm</p>
</dd>
<dt><code>censyrs</code></dt><dd><p>The censoring time, in years, corresponding to
the close of study minus the time of entry for each patient</p>
</dd>
<dt><code>xo</code></dt><dd><p>Indicator that crossover occurred</p>
</dd>
<dt><code>xoyrs</code></dt><dd><p>The time, in years, from entry to switching, or
0 for patients in the immediate arm</p>
</dd>
<dt><code>prog</code></dt><dd><p>Indicator of disease progression (1), or
censoring (0)</p>
</dd>
<dt><code>progyrs</code></dt><dd><p>Time, in years, from entry to disease
progression or censoring</p>
</dd>
<dt><code>entry</code></dt><dd><p>The time of entry into the study, measured in years
from the date of randomisation</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>immdef
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 1000 rows and 9 columns.
</p>

<hr>
<h2 id='kmdiff'>Estimate of milestone survival difference</h2><span id='topic+kmdiff'></span>

<h3>Description</h3>

<p>Obtains the estimate of milestone survival difference
between two treatment groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmdiff(
  data,
  rep = "rep",
  stratum = "stratum",
  treat = "treat",
  time = "time",
  event = "event",
  milestone = NA_real_,
  survDiffH0 = 0,
  confint = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmdiff_+3A_data">data</code></td>
<td>
<p>The input data frame that contains the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication for by-group processing.
</p>
</li>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>treat</code>: The treatment.
</p>
</li>
<li> <p><code>time</code>: The possibly right-censored survival time.
</p>
</li>
<li> <p><code>event</code>: The event indicator.
</p>
</li></ul>
</td></tr>
<tr><td><code id="kmdiff_+3A_rep">rep</code></td>
<td>
<p>The name of the replication variable in the input data.</p>
</td></tr>
<tr><td><code id="kmdiff_+3A_stratum">stratum</code></td>
<td>
<p>The name of the stratum variable in the input data.</p>
</td></tr>
<tr><td><code id="kmdiff_+3A_treat">treat</code></td>
<td>
<p>The name of the treatment variable in the input data.</p>
</td></tr>
<tr><td><code id="kmdiff_+3A_time">time</code></td>
<td>
<p>The name of the time variable in the input data.</p>
</td></tr>
<tr><td><code id="kmdiff_+3A_event">event</code></td>
<td>
<p>The name of the event variable in the input data.</p>
</td></tr>
<tr><td><code id="kmdiff_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
survival probability.</p>
</td></tr>
<tr><td><code id="kmdiff_+3A_survdiffh0">survDiffH0</code></td>
<td>
<p>The difference in milestone survival probabilities
under the null hypothesis. Defaults to 0 for superiority test.</p>
</td></tr>
<tr><td><code id="kmdiff_+3A_confint">confint</code></td>
<td>
<p>The level of the two-sided confidence interval for
the difference in milestone survival probabilities. Defaults to 0.95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>survDiffH0</code>: The difference in milestone survival probabilities
under the null hypothesis.
</p>
</li>
<li> <p><code>surv1</code>: The estimated milestone survival probability for
the treatment group.
</p>
</li>
<li> <p><code>surv2</code>: The estimated milestone survival probability for
the control group.
</p>
</li>
<li> <p><code>survDiff</code>: The estimated difference in milestone survival
probabilities.
</p>
</li>
<li> <p><code>vsurv1</code>: The variance for surv1.
</p>
</li>
<li> <p><code>vsurv2</code>: The variance for surv2.
</p>
</li>
<li> <p><code>vsurvDiff</code>: The variance for survDiff.
</p>
</li>
<li> <p><code>survDiffZ</code>: The Z-statistic value.
</p>
</li>
<li> <p><code>survDiffPValue</code>: The one-sided p-value.
</p>
</li>
<li> <p><code>lower</code>: The lower bound of confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper bound of confidence interval.
</p>
</li>
<li> <p><code>confint</code>: The level of confidence interval.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- kmdiff(data = rawdata, rep = "iterationNumber",
             stratum = "stratum", treat = "treatmentGroup",
             time = "timeUnderObservation", event = "event",
             milestone = 12)
head(df)

</code></pre>

<hr>
<h2 id='kmest'>Kaplan-Meier estimates of the survival curve</h2><span id='topic+kmest'></span>

<h3>Description</h3>

<p>Obtains the Kaplan-Meier estimates of the survival curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmest(
  data,
  rep = "rep",
  stratum = "stratum",
  time = "time",
  event = "event",
  conftype = "log-log",
  confint = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmest_+3A_data">data</code></td>
<td>
<p>The input data frame that contains the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication for by-group processing.
</p>
</li>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The possibly right-censored survival time.
</p>
</li>
<li> <p><code>event</code>: The event indicator.
</p>
</li></ul>
</td></tr>
<tr><td><code id="kmest_+3A_rep">rep</code></td>
<td>
<p>The name of the replication variable in the input data.</p>
</td></tr>
<tr><td><code id="kmest_+3A_stratum">stratum</code></td>
<td>
<p>The name of the stratum variable in the input data.</p>
</td></tr>
<tr><td><code id="kmest_+3A_time">time</code></td>
<td>
<p>The name of the time variable in the input data.</p>
</td></tr>
<tr><td><code id="kmest_+3A_event">event</code></td>
<td>
<p>The name of the event variable in the input data.</p>
</td></tr>
<tr><td><code id="kmest_+3A_conftype">conftype</code></td>
<td>
<p>The type of confidence interval. One of &quot;none&quot;,
&quot;plain&quot;, &quot;log&quot;, &quot;log-log&quot; (the default), or &quot;arcsin&quot;.
The arcsin option bases the intervals on asin(sqrt(survival)).</p>
</td></tr>
<tr><td><code id="kmest_+3A_confint">confint</code></td>
<td>
<p>The level of the two-sided confidence interval for
the survival probabilities. Defaults to 0.95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication.
</p>
</li>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>size</code>: The number of subjects in the stratum.
</p>
</li>
<li> <p><code>time</code>: The event time.
</p>
</li>
<li> <p><code>nrisk</code>: The number of subjects at risk.
</p>
</li>
<li> <p><code>nevent</code>: The number of subjects having the event.
</p>
</li>
<li> <p><code>survival</code>: The Kaplan-Meier estimate of the survival probability.
</p>
</li>
<li> <p><code>stderr</code>: The standard error of the estimated survival
probability based on the Greendwood formula.
</p>
</li>
<li> <p><code>lower</code>: The lower bound of confidence interval if requested.
</p>
</li>
<li> <p><code>upper</code>: The upper bound of confidence interval if requested.
</p>
</li>
<li> <p><code>confint</code>: The level of confidence interval if requested.
</p>
</li>
<li> <p><code>conftype</code>: The type of confidence interval if requested.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
kmest(data = aml, stratum = "x",
      time = "time", event = "status")

</code></pre>

<hr>
<h2 id='kmpower'>Power for difference in milestone survival probabilities</h2><span id='topic+kmpower'></span>

<h3>Description</h3>

<p>Estimates the power for testing the difference in
milestone survival probabilities in a two-sample survival design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmpower(
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  milestone = NA_real_,
  survDiffH0 = 0,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  spendingTime = NA_real_,
  studyDuration = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmpower_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock
type spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and &quot;none&quot; for no
early futility stopping. Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the survival
probability.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_survdiffh0">survDiffH0</code></td>
<td>
<p>The difference in milestone survival probabilities
under the null hypothesis. Defaults to 0 for superiority test.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="kmpower_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="kmpower_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>kmpower</code> object with 3 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>(survDiff - survDiffH0)*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up duration.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>survDiffH0</code>: The difference in milestone survival
probabilities under the null hypothesis.
</p>
</li>
<li> <p><code>surv1</code>: The milestone survival probability for the
treatment group.
</p>
</li>
<li> <p><code>surv2</code>: The milestone survival probability for the
control group.
</p>
</li>
<li> <p><code>survDiff</code>: The difference in milestone survival
probabilities, equal to <code>surv1 - surv2</code>.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacySurvDiff</code>: The efficacy boundaries on the survival
difference scale.
</p>
</li>
<li> <p><code>futilitySurvDiff</code>: The futility boundaries on the survival
difference scale.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>typeBetaSpending</code>,
<code>parameterBetaSpending</code>, <code>allocationRatioPlanned</code>,
<code>accrualTime</code>, <code>accuralIntensity</code>,
<code>piecewiseSurvivalTime</code>, <code>stratumFraction</code>,
<code>lambda1</code>, <code>lambda2</code>, <code>gamma1</code>, <code>gamma2</code>,
and <code>spendingTime</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survival, and 5% dropout by
# the end of 1 year.

kmpower(kMax = 2, informationRates = c(0.8, 1),
        alpha = 0.025, typeAlphaSpending = "sfOF",
        milestone = 18,
        allocationRatioPlanned = 1, accrualTime = seq(0, 8),
        accrualIntensity = 26/9*seq(1, 9),
        piecewiseSurvivalTime = c(0, 6),
        stratumFraction = c(0.2, 0.8),
        lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
        lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
        gamma1 = -log(1-0.05)/12,
        gamma2 = -log(1-0.05)/12, accrualDuration = 22,
        followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='kmpower1s'>Power for one-sample milestone survival probability</h2><span id='topic+kmpower1s'></span>

<h3>Description</h3>

<p>Estimates the power, stopping probabilities, and expected
sample size in a one-group survival design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmpower1s(
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  milestone = NA_real_,
  survH0 = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda = NA_real_,
  gamma = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  spendingTime = NA_real_,
  studyDuration = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmpower1s_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock
type spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and &quot;none&quot; for no
early futility stopping. Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the survival
probability.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_survh0">survH0</code></td>
<td>
<p>The milestone survival probability under the null
hypothesis.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout or a vector of
hazard rates for piecewise exponential dropout. Defaults to 0 for
no dropout.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="kmpower1s_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>kmpower1s</code> object with 3 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>(surv - survH0)*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up duration.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time to calculate the survival
probability.
</p>
</li>
<li> <p><code>survH0</code>: The milestone survival probability under the null
hypothesis.
</p>
</li>
<li> <p><code>surv</code>: The milestone survival probability under the
alternative hypothesis.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacySurv</code>: The efficacy boundaries on the milestone
survival probability scale.
</p>
</li>
<li> <p><code>futilitySurv</code>: The futility boundaries on the milestone
survival probability scale.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>typeBetaSpending</code>,
<code>parameterBetaSpending</code>, <code>accrualTime</code>,
<code>accuralIntensity</code>, <code>piecewiseSurvivalTime</code>,
<code>stratumFraction</code>, <code>lambda</code>, <code>gamma</code>,
and <code>spendingTime</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kmstat">kmstat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
kmpower1s(kMax = 2, informationRates = c(0.8, 1),
          alpha = 0.025, typeAlphaSpending = "sfOF",
          milestone = 18, survH0 = 0.30,
          accrualTime = seq(0, 8),
          accrualIntensity = 26/9*seq(1, 9),
          piecewiseSurvivalTime = c(0, 6),
          stratumFraction = c(0.2, 0.8),
          lambda = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
          gamma = -log(1-0.05)/12, accrualDuration = 22,
          followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='kmpowerequiv'>Power for equivalence in milestone survival probability difference</h2><span id='topic+kmpowerequiv'></span>

<h3>Description</h3>

<p>Obtains the power for equivalence in milestone survival
probability difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmpowerequiv(
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  milestone = NA_real_,
  survDiffLower = NA_real_,
  survDiffUpper = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  spendingTime = NA_real_,
  studyDuration = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmpowerequiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the survival
probability.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_survdifflower">survDiffLower</code></td>
<td>
<p>The lower equivalence limit of milestone survival
probability difference.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_survdiffupper">survDiffUpper</code></td>
<td>
<p>The upper equivalence limit of milestone survival
probability difference.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="kmpowerequiv_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>kmpowerequiv</code> object with 3 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlphaH10</code>: The attained significance level under H10.
</p>
</li>
<li> <p><code>attainedAlphaH20</code>: The attained significance level under H20.
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>survDiffLower</code>: The lower equivalence limit of milestone
survival probability difference.
</p>
</li>
<li> <p><code>survDiffUpper</code>: The upper equivalence limit of milestone
survival probability difference.
</p>
</li>
<li> <p><code>surv1</code>: The milestone survival probability for the
treatment group.
</p>
</li>
<li> <p><code>surv2</code>: The milestone survival probability for the
control group.
</p>
</li>
<li> <p><code>survDiff</code>: The milestone survival probability difference.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up duration.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH10</code>: The cumulative alpha attained
under <code>H10</code>.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH20</code>: The cumulative alpha attained
under <code>H20</code>.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacySurvDiffLower</code>: The efficacy boundaries on the
milestone survival probability difference scale for the one-sided
null hypothesis at the lower equivalence limit.
</p>
</li>
<li> <p><code>efficacySurvDiffUpper</code>: The efficacy boundaries on the
milestone survival probability difference scale for the one-sided
null hypothesis at the upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>allocationRatioPlanned</code>,
<code>accrualTime</code>, <code>accuralIntensity</code>,
<code>piecewiseSurvivalTime</code>, <code>stratumFraction</code>,
<code>lambda1</code>, <code>lambda2</code>, <code>gamma1</code>, <code>gamma2</code>,
and <code>spendingTime</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kmstat">kmstat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
kmpowerequiv(kMax = 2, informationRates = c(0.5, 1),
             alpha = 0.05, typeAlphaSpending = "sfOF",
             milestone = 18,
             survDiffLower = -0.13, survDiffUpper = 0.13,
             allocationRatioPlanned = 1, accrualTime = seq(0, 8),
             accrualIntensity = 26/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12, accrualDuration = 22,
             followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='kmsamplesize'>Sample size for difference in milestone survival probabilities</h2><span id='topic+kmsamplesize'></span>

<h3>Description</h3>

<p>Obtains the needed accrual duration given power,
accrual intensity, and follow-up time, the needed follow-up time
given power, accrual intensity, and accrual duration, or the needed
absolute accrual intensity given power, relative accrual intensity,
accrual duration, and follow-up time in a two-group survival design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmsamplesize(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  milestone = NA_real_,
  survDiffH0 = 0,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmsamplesize_+3A_beta">beta</code></td>
<td>
<p>Type II error. Defaults to 0.2.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the survival
probability.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_survdiffh0">survDiffH0</code></td>
<td>
<p>The difference in milestone survival probabilities
under the null hypothesis. Defaults to 0 for superiority test.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupTime, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="kmsamplesize_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size.
Defaults to 1 for sample size rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two components:
</p>

<ul>
<li> <p><code>resultsUnderH1</code>: An S3 class <code>kmpower</code> object under the
alternative hypothesis.
</p>
</li>
<li> <p><code>resultsUnderH0</code>: An S3 class <code>kmpower</code> object under the
null hypothesis.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kmpower">kmpower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Obtains follow-up time given power, accrual intensity,
# and accrual duration for variable follow-up. Of note, the power
# reaches the maximum when the follow-up time equals milestone.

kmsamplesize(beta = 0.25, kMax = 2, informationRates = c(0.8, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             milestone = 18,
             allocationRatioPlanned = 1, accrualTime = seq(0, 8),
             accrualIntensity = 26/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12, accrualDuration = 22,
             followupTime = NA, fixedFollowup = FALSE)

# Example 2: Obtains accrual intensity given power, accrual duration, and
# follow-up time for variable follow-up

kmsamplesize(beta = 0.2, kMax = 2, informationRates = c(0.8, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             milestone = 18,
             allocationRatioPlanned = 1, accrualTime = seq(0, 8),
             accrualIntensity = 26/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12, accrualDuration = 22,
             followupTime = 18, fixedFollowup = FALSE)


# Example 3: Obtains accrual duration given power, accrual intensity, and
# follow-up time for fixed follow-up

kmsamplesize(beta = 0.2, kMax = 2, informationRates = c(0.8, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             milestone = 18,
             allocationRatioPlanned = 1, accrualTime = seq(0, 8),
             accrualIntensity = 26/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12, accrualDuration = NA,
             followupTime = 18, fixedFollowup = TRUE)

</code></pre>

<hr>
<h2 id='kmsamplesize1s'>Sample size for one-sample milestone survival probability</h2><span id='topic+kmsamplesize1s'></span>

<h3>Description</h3>

<p>Obtains the needed accrual duration given power and
follow-up time, the needed follow-up time given power and
accrual duration, or the needed absolute accrual rates given
power, accrual duration, follow-up duration, and relative accrual
rates in a one-group survival design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmsamplesize1s(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  milestone = NA_real_,
  survH0 = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda = NA_real_,
  gamma = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmsamplesize1s_+3A_beta">beta</code></td>
<td>
<p>Type II error. Defaults to 0.2.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the survival
probability.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_survh0">survH0</code></td>
<td>
<p>The milestone survival probability under the null
hypothesis.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout or a vector of
hazard rates for piecewise exponential dropout. Defaults to 0 for
no dropout.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupDuration, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="kmsamplesize1s_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size.
Defaults to 1 for sample size rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two components:
</p>

<ul>
<li> <p><code>resultsUnderH1</code>: An S3 class <code>kmpower1s</code> object under the
alternative hypothesis.
</p>
</li>
<li> <p><code>resultsUnderH0</code>: An S3 class <code>kmpower1s</code> object under the
null hypothesis.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kmpower1s">kmpower1s</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Obtains follow-up duration given power, accrual intensity,
# and accrual duration for variable follow-up

kmsamplesize1s(beta = 0.2, kMax = 2,
               informationRates = c(0.8, 1),
               alpha = 0.025, typeAlphaSpending = "sfOF",
               milestone = 18, survH0 = 0.30,
               accrualTime = seq(0, 8),
               accrualIntensity = 26/9*seq(1, 9),
               piecewiseSurvivalTime = c(0, 6),
               stratumFraction = c(0.2, 0.8),
               lambda = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
               gamma = -log(1-0.05)/12, accrualDuration = 22,
               followupTime = NA, fixedFollowup = FALSE)

# Example 2: Obtains accrual intensity given power, accrual duration, and
# follow-up duration for variable follow-up

kmsamplesize1s(beta = 0.2, kMax = 2,
               informationRates = c(0.8, 1),
               alpha = 0.025, typeAlphaSpending = "sfOF",
               milestone = 18, survH0 = 0.30,
               accrualTime = seq(0, 8),
               accrualIntensity = 26/9*seq(1, 9),
               piecewiseSurvivalTime = c(0, 6),
               stratumFraction = c(0.2, 0.8),
               lambda = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
               gamma = -log(1-0.05)/12, accrualDuration = 22,
               followupTime = 18, fixedFollowup = FALSE)


# Example 3: Obtains accrual duration given power, accrual intensity, and
# follow-up duration for fixed follow-up

kmsamplesize1s(beta = 0.2, kMax = 2,
               informationRates = c(0.8, 1),
               alpha = 0.025, typeAlphaSpending = "sfOF",
               milestone = 18, survH0 = 0.30,
               accrualTime = seq(0, 8),
               accrualIntensity = 26/9*seq(1, 9),
               piecewiseSurvivalTime = c(0, 6),
               stratumFraction = c(0.2, 0.8),
               lambda = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
               gamma = -log(1-0.05)/12, accrualDuration = NA,
               followupTime = 18, fixedFollowup = TRUE)

</code></pre>

<hr>
<h2 id='kmsamplesizeequiv'>Sample size for equivalence in milestone survival probability
difference</h2><span id='topic+kmsamplesizeequiv'></span>

<h3>Description</h3>

<p>Obtains the sample size for equivalence in milestone
survival probability difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmsamplesizeequiv(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  milestone = NA_real_,
  survDiffLower = NA_real_,
  survDiffUpper = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmsamplesizeequiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the survival
probability.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_survdifflower">survDiffLower</code></td>
<td>
<p>The lower equivalence limit of milestone survival
probability difference.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_survdiffupper">survDiffUpper</code></td>
<td>
<p>The upper equivalence limit of milestone survival
probability difference.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupDuration, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="kmsamplesizeequiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size.
Defaults to 1 for sample size rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>kmpowerequiv</code> object
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kmpowerequiv">kmpowerequiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
kmsamplesizeequiv(beta = 0.1, kMax = 2, informationRates = c(0.5, 1),
                  alpha = 0.05, typeAlphaSpending = "sfOF",
                  milestone = 18,
                  survDiffLower = -0.13, survDiffUpper = 0.13,
                  allocationRatioPlanned = 1, accrualTime = seq(0, 8),
                  accrualIntensity = 26/9*seq(1, 9),
                  piecewiseSurvivalTime = c(0, 6),
                  stratumFraction = c(0.2, 0.8),
                  lambda1 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
                  lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
                  gamma1 = -log(1-0.05)/12,
                  gamma2 = -log(1-0.05)/12, accrualDuration = NA,
                  followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='kmstat'>Stratified difference in milestone survival probabilities</h2><span id='topic+kmstat'></span>

<h3>Description</h3>

<p>Obtains the stratified milestone survival probabilities
and difference in milestone survival probabilities at given
calendar times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmstat(
  time = NA_real_,
  milestone = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmstat_+3A_time">time</code></td>
<td>
<p>A vector of calendar times for data cut.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
survival probability.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="kmstat_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="kmstat_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables:
</p>

<ul>
<li> <p><code>time</code>: The calendar time since trial start.
</p>
</li>
<li> <p><code>subjects</code>: The number of enrolled subjects.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>surv1</code>: The milestone survival probability for the treatment
group.
</p>
</li>
<li> <p><code>surv2</code>: The milestone survival probability for the control group.
</p>
</li>
<li> <p><code>survDiff</code>: The difference in milestone survival probabilities,
i.e., <code>surv1 - surv2</code>.
</p>
</li>
<li> <p><code>vsurv1</code>: The variance for <code>surv1</code>.
</p>
</li>
<li> <p><code>vsurv2</code>: The variance for <code>surv2</code>.
</p>
</li>
<li> <p><code>vsurvDiff</code>: The variance for <code>survDiff</code>.
</p>
</li>
<li> <p><code>information</code>: The information for <code>survDiff</code>, equal to
<code>1/vsurvDiff</code>.
</p>
</li>
<li> <p><code>survDiffZ</code>: The Z-statistic value, i.e.,
<code>survDiff/sqrt(vsurvDiff)</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.

kmstat(time = c(22, 40),
       milestone = 18,
       allocationRatioPlanned = 1,
       accrualTime = seq(0, 8),
       accrualIntensity = 26/9*seq(1, 9),
       piecewiseSurvivalTime = c(0, 6),
       stratumFraction = c(0.2, 0.8),
       lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
       lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
       gamma1 = -log(1-0.05)/12,
       gamma2 = -log(1-0.05)/12,
       accrualDuration = 22,
       followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='kmstat1'>Milestone survival probability by stratum</h2><span id='topic+kmstat1'></span>

<h3>Description</h3>

<p>Obtains the milestone survival probability and associated
variance by treatment group and by stratum at a given calendar time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmstat1(
  time = NA_real_,
  milestone = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmstat1_+3A_time">time</code></td>
<td>
<p>The calendar time for data cut.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
survival probability.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="kmstat1_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables:
</p>

<ul>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The calendar time since trial start.
</p>
</li>
<li> <p><code>subjects</code>: The number of enrolled subjects.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>surv1</code>: The milestone survival probability for the treatment
group.
</p>
</li>
<li> <p><code>surv2</code>: The milestone survival probability for the control group.
</p>
</li>
<li> <p><code>survDiff</code>: The difference in milestone survival probabilities,
i.e., <code>surv1 - surv2</code>.
</p>
</li>
<li> <p><code>vsurv1</code>: The variance for <code>surv1</code>.
</p>
</li>
<li> <p><code>vsurv2</code>: The variance for <code>surv2</code>.
</p>
</li>
<li> <p><code>vsurvDiff</code>: The variance for <code>survDiff</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.

kmstat1(time = 40,
        milestone = 18,
        allocationRatioPlanned = 1,
        accrualTime = seq(0, 8),
        accrualIntensity = 26/9*seq(1, 9),
        piecewiseSurvivalTime = c(0, 6),
        stratumFraction = c(0.2, 0.8),
        lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
        lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
        gamma1 = -log(1-0.05)/12,
        gamma2 = -log(1-0.05)/12,
        accrualDuration = 22,
        followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='liferegr'>Parametric regression models for failure time data</h2><span id='topic+liferegr'></span>

<h3>Description</h3>

<p>Obtains the parameter estimates from parametric
regression models with uncensored, right censored, left censored, or
interval censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>liferegr(
  data,
  rep = "rep",
  stratum = "stratum",
  time = "time",
  time2 = "time2",
  event = "event",
  covariates = "treat",
  weight = "weight",
  id = "id",
  dist = "weibull",
  robust = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="liferegr_+3A_data">data</code></td>
<td>
<p>The input data frame that contains the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication for by-group processing.
</p>
</li>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The follow-up time for right censored data, or
the left end of each interval for interval censored data.
</p>
</li>
<li> <p><code>time2</code>: The right end of each interval for interval
censored data.
</p>
</li>
<li> <p><code>event</code>: The event indicator, normally 1=event, 0=no event.
</p>
</li>
<li> <p><code>covariates</code>: The values of baseline covariates.
This is the full-rank design matrix (excluding the intercept)
for the regression model, assuming that factor variables
have already been expanded into dummy variables.
The intercept will be added automatically.
</p>
</li>
<li> <p><code>weight</code>: The weight for each observation.
</p>
</li>
<li> <p><code>id</code>: The optional subject ID to group the score residuals
in computing the robust sandwich variance.
</p>
</li></ul>
</td></tr>
<tr><td><code id="liferegr_+3A_rep">rep</code></td>
<td>
<p>The name of the replication variable in the input data.</p>
</td></tr>
<tr><td><code id="liferegr_+3A_stratum">stratum</code></td>
<td>
<p>The name of the stratum variable in the input data.</p>
</td></tr>
<tr><td><code id="liferegr_+3A_time">time</code></td>
<td>
<p>The name of the time variable or the left end of each
interval for interval censored data in the input data.</p>
</td></tr>
<tr><td><code id="liferegr_+3A_time2">time2</code></td>
<td>
<p>The name of the right end of each interval for
interval censored data in the input data.</p>
</td></tr>
<tr><td><code id="liferegr_+3A_event">event</code></td>
<td>
<p>The name of the event variable in the input data
for right censored data.</p>
</td></tr>
<tr><td><code id="liferegr_+3A_covariates">covariates</code></td>
<td>
<p>The vector of names of baseline covariates
in the input data.</p>
</td></tr>
<tr><td><code id="liferegr_+3A_weight">weight</code></td>
<td>
<p>The name of the weighting variable in the input data.</p>
</td></tr>
<tr><td><code id="liferegr_+3A_id">id</code></td>
<td>
<p>The name of the id variable in the input data.</p>
</td></tr>
<tr><td><code id="liferegr_+3A_dist">dist</code></td>
<td>
<p>The assumed distribution for time to event. Options include
&quot;exponential&quot;, &quot;weibull&quot;, &quot;lognormal&quot;, and &quot;loglogistic&quot; to be
modeled on the log-scale, and &quot;normal&quot; and &quot;logistic&quot; to be modeled
on the original scale.</p>
</td></tr>
<tr><td><code id="liferegr_+3A_robust">robust</code></td>
<td>
<p>Whether a robust sandwich variance estimate should be
computed. The default is TRUE if there are fractional weights or
there is at least 1 id with &gt;1 event. In the presence of the id
variable, the score residual will be aggregated for each id when
computing the robust sandwich variance estimate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two ways to specify the model, one for right censored
data through the time and event variables, and the other for interval
censored data through the time and time2 variables. For the second form,
we follow the convention used in SAS PROC LIFEREG:
</p>

<ul>
<li><p> If lower is not missing, upper is not missing, and lower is equal
to upper, then there is no censoring and the event occurred at
time lower.
</p>
</li>
<li><p> If lower is not missing, upper is not missing, and lower &lt; upper,
then the event time is censored within the interval (lower, upper).
</p>
</li>
<li><p> If lower is missing, but upper is not missing, then upper will be
used as the left censoring value.
</p>
</li>
<li><p> If lower is not missing, but upper is missing, then lower will be
used as the right censoring value.
</p>
</li>
<li><p> If lower is not missing, upper is not missing, but lower &gt; upper,
or if both lower and upper are missing, then the observation will
not be used.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>sumstat</code>: The data frame of summary statistics of model fit
with the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication.
</p>
</li>
<li> <p><code>n</code>: The number of observations.
</p>
</li>
<li> <p><code>nevents</code>: The number of events.
</p>
</li>
<li> <p><code>loglik0</code>: The log-likelihood under null.
</p>
</li>
<li> <p><code>loglik1</code>: The maximum log-likelihood.
</p>
</li>
<li> <p><code>scoretest</code>: The score test statistic.
</p>
</li></ul>

</li>
<li> <p><code>parest</code>: The data frame of parameter estimates with the
following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication.
</p>
</li>
<li> <p><code>param</code>: The name of the covariate for the parameter estimate.
</p>
</li>
<li> <p><code>beta</code>: The parameter estimate.
</p>
</li>
<li> <p><code>sebeta</code>: The standard error of parameter estimate.
</p>
</li>
<li> <p><code>z</code>: The Wald test statistic.
</p>
</li>
<li> <p><code>expbeta</code>: The exponentiated parameter.
</p>
</li>
<li> <p><code>vbeta</code>: The covariance matrix for parameter estimates.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

# right censored data
liferegr(data = rawdata %&gt;% mutate(treat = 1*(treatmentGroup == 1)),
         rep = "iterationNumber", stratum = "stratum",
         time = "timeUnderObservation", event = "event",
         covariates = "treat", dist = "weibull")

# tobit regression for left censored data
liferegr(data = tobin %&gt;% mutate(time = ifelse(durable&gt;0, durable, NA)),
         time = "time", time2 = "durable",
         covariates = c("age", "quant"), dist = "normal")

</code></pre>

<hr>
<h2 id='lrpower'>Log-rank test power</h2><span id='topic+lrpower'></span>

<h3>Description</h3>

<p>Estimates the power, stopping probabilities, and expected
sample size in a two-group survival design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrpower(
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  hazardRatioH0 = 1,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  rho1 = 0,
  rho2 = 0,
  numSubintervals = 300L,
  estimateHazardRatio = 1L,
  typeOfComputation = "direct",
  spendingTime = NA_real_,
  studyDuration = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrpower_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates in terms of number
of events for the conventional log-rank test and in terms of
the actual information for weighted log-rank tests.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock
type spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and &quot;none&quot; for no
early futility stopping. Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_hazardratioh0">hazardRatioH0</code></td>
<td>
<p>Hazard ratio under the null hypothesis for the active
treatment versus control. Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="lrpower_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_rho1">rho1</code></td>
<td>
<p>The first parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_rho2">rho2</code></td>
<td>
<p>The second parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_numsubintervals">numSubintervals</code></td>
<td>
<p>Number of sub-intervals to approximate the mean
and variance of the weighted log-rank test score statistic.
Defaults to 300. Specify a larger number for better approximation.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_estimatehazardratio">estimateHazardRatio</code></td>
<td>
<p>Whether to estimate the hazard ratio from
weighted Cox regression model and report the stopping boundaries on
the hazard ratio scale.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_typeofcomputation">typeOfComputation</code></td>
<td>
<p>The type of computation,
either &quot;direct&quot; for the direct approximation method,
or &quot;schoenfeld&quot; for the Schoenfeld method.
Defaults to &quot;direct&quot;. Can use &quot;Schoenfeld&quot;
under proportional hazards and conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="lrpower_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>lrpower</code> object with 4 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The total number of events.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The total number of dropouts.
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfEvents</code>: The expected number of events.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts</code>: The expected number of dropouts.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up time.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>rho1</code>: The first parameter of the Fleming-Harrington family
of weighted log-rank test.
</p>
</li>
<li> <p><code>rho2</code>: The second parameter of the Fleming-Harrington family
of weighted log-rank test.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>hazardRatioH0</code>: The hazard ratio under the null hypothesis.
</p>
</li>
<li> <p><code>typeOfComputation</code>: The type of computation,
either &quot;direct&quot; for the direct approximation method,
or &quot;schoenfeld&quot; for the Schoenfeld method.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The number of events.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The number of dropouts.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacyHR</code>: The efficacy boundaries on the hazard ratio
scale if <code>estimateHazardRatio</code>.
</p>
</li>
<li> <p><code>futilityHR</code>: The futility boundaries on the hazard ratio
scale if <code>estimateHazardRatio</code>.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>HR</code>: The average hazard ratio.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>typeBetaSpending</code>,
<code>parameterBetaSpending</code>, <code>allocationRatioPlanned</code>,
<code>accrualTime</code>, <code>accuralIntensity</code>,
<code>piecewiseSurvivalTime</code>, <code>stratumFraction</code>,
<code>lambda1</code>, <code>lambda2</code>, <code>gamma1</code>, <code>gamma2</code>,
<code>estimateHazardRatio</code>, and <code>spendingTime</code>.
</p>
</li>
<li> <p><code>byTreatmentCounts</code>: A list containing the following counts by
treatment group:
</p>

<ul>
<li> <p><code>numberOfEvents1</code>: The number of events by stage for
the treatment group.
</p>
</li>
<li> <p><code>numberOfDropouts1</code>: The number of dropouts by stage for
the treatment group.
</p>
</li>
<li> <p><code>numberOfSubjects1</code>: The number of subjects by stage for
the treatment group.
</p>
</li>
<li> <p><code>numberOfEvents2</code>: The number of events by stage for
the control group.
</p>
</li>
<li> <p><code>numberOfDropouts2</code>: The number of dropouts by stage for
the control group.
</p>
</li>
<li> <p><code>numberOfSubjects2</code>: The number of subjects by stage for
the control group.
</p>
</li>
<li> <p><code>expectedNumberOfEvents1</code>: The expected number of events for
the treatment group.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts1</code>: The expected number of dropouts
for the treatment group.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects1</code>: The expected number of subjects
for the treatment group.
</p>
</li>
<li> <p><code>expectedNumberOfEvents2</code>: The expected number of events for
control group.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts2</code>: The expected number of dropouts
for the control group.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects2</code>: The expected number of subjects
for the control group.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survival, and 5% dropout by
# the end of 1 year.

lrpower(kMax = 2, informationRates = c(0.8, 1),
        alpha = 0.025, typeAlphaSpending = "sfOF",
        allocationRatioPlanned = 1, accrualTime = seq(0, 8),
        accrualIntensity = 26/9*seq(1, 9),
        piecewiseSurvivalTime = c(0, 6),
        stratumFraction = c(0.2, 0.8),
        lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
        lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
        gamma1 = -log(1-0.05)/12,
        gamma2 = -log(1-0.05)/12, accrualDuration = 22,
        followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='lrpowerequiv'>Power for equivalence in hazard ratio</h2><span id='topic+lrpowerequiv'></span>

<h3>Description</h3>

<p>Obtains the power for equivalence in hazard ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrpowerequiv(
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  hazardRatioLower = NA_real_,
  hazardRatioUpper = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  typeOfComputation = "direct",
  spendingTime = NA_real_,
  studyDuration = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrpowerequiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_hazardratiolower">hazardRatioLower</code></td>
<td>
<p>The lower equivalence limit of hazard ratio.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_hazardratioupper">hazardRatioUpper</code></td>
<td>
<p>The upper equivalence limit of hazard ratio.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_typeofcomputation">typeOfComputation</code></td>
<td>
<p>The type of computation,
either &quot;direct&quot; for the direct approximation method,
or &quot;schoenfeld&quot; for the Schoenfeld method.
Defaults to &quot;direct&quot;. Can use &quot;Schoenfeld&quot;
under proportional hazards and conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="lrpowerequiv_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>lrpowerequiv</code> object with 4 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlphaH10</code>: The attained significance level under H10.
</p>
</li>
<li> <p><code>attainedAlphaH20</code>: The attained significance level under H20.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The total number of events.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The total number of dropouts.
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfEvents</code>: The expected number of events.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts</code>: The expected number of dropouts.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>hazardRatioLower</code>: The lower equivalence limit of hazard
ratio.
</p>
</li>
<li> <p><code>hazardRatioUpper</code>: The upper equivalence limit of hazard
ratio.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up time.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH10</code>: The cumulative alpha attained
under <code>H10</code>.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH20</code>: The cumulative alpha attained
under <code>H20</code>.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The number of events.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The number of dropouts.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacyHRLower</code>: The efficacy boundaries on the
hazard ratio scale for the one-sided null hypothesis
at the lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyHRUpper</code>: The efficacy boundaries on the
hazard ratio scale for the one-sided null hypothesis
at the upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>HR</code>: The average hazard ratio.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>allocationRatioPlanned</code>,
<code>accrualTime</code>, <code>accuralIntensity</code>,
<code>piecewiseSurvivalTime</code>, <code>stratumFraction</code>,
<code>lambda1</code>, <code>lambda2</code>, <code>gamma1</code>, <code>gamma2</code>,
<code>typeOfComputation</code>, and <code>spendingTime</code>.
</p>
</li>
<li> <p><code>byTreatmentCounts</code>: A list containing the following counts by
treatment group:
</p>

<ul>
<li> <p><code>numberOfEvents1</code>: The number of events by stage for
the treatment group.
</p>
</li>
<li> <p><code>numberOfDropouts1</code>: The number of dropouts by stage for
the treatment group.
</p>
</li>
<li> <p><code>numberOfSubjects1</code>: The number of subjects by stage for
the treatment group.
</p>
</li>
<li> <p><code>numberOfEvents2</code>: The number of events by stage for
the control group.
</p>
</li>
<li> <p><code>numberOfDropouts2</code>: The number of dropouts by stage for
the control group.
</p>
</li>
<li> <p><code>numberOfSubjects2</code>: The number of subjects by stage for
the control group.
</p>
</li>
<li> <p><code>expectedNumberOfEvents1</code>: The expected number of events for
the treatment group.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts1</code>: The expected number of dropouts
for the treatment group.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects1</code>: The expected number of subjects
for the treatment group.
</p>
</li>
<li> <p><code>expectedNumberOfEvents2</code>: The expected number of events for
control group.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts2</code>: The expected number of dropouts
for the control group.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects2</code>: The expected number of subjects
for the control group.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmstat">rmstat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
lrpowerequiv(kMax = 2, informationRates = c(0.5, 1),
             alpha = 0.05, typeAlphaSpending = "sfOF",
             hazardRatioLower = 0.71, hazardRatioUpper = 1.4,
             allocationRatioPlanned = 1, accrualTime = seq(0, 8),
             accrualIntensity = 100/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12, accrualDuration = 22,
             followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='lrsamplesize'>Log-rank test sample size</h2><span id='topic+lrsamplesize'></span>

<h3>Description</h3>

<p>Obtains the needed accrual duration given power and
follow-up time, the needed follow-up time given power and
accrual duration, or the needed absolute accrual rates given
power, accrual duration, follow-up time, and relative accrual
rates in a two-group survival design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrsamplesize(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  hazardRatioH0 = 1,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  rho1 = 0,
  rho2 = 0,
  numSubintervals = 300L,
  estimateHazardRatio = 1L,
  typeOfComputation = "direct",
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrsamplesize_+3A_beta">beta</code></td>
<td>
<p>Type II error. Defaults to 0.2.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates in terms of number
of events for the conventional log-rank test and in terms of
the actual information for weighted log-rank tests.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_hazardratioh0">hazardRatioH0</code></td>
<td>
<p>Hazard ratio under the null hypothesis for the active
treatment versus control. Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_rho1">rho1</code></td>
<td>
<p>The first parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_rho2">rho2</code></td>
<td>
<p>The second parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_numsubintervals">numSubintervals</code></td>
<td>
<p>Number of sub-intervals to approximate the mean
and variance of the weighted log-rank test score statistic.
Defaults to 300. Specify a larger number for better approximation.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_estimatehazardratio">estimateHazardRatio</code></td>
<td>
<p>Whether to estimate the hazard ratio from
weighted Cox regression model and report the stopping boundaries on
the hazard ratio scale.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_typeofcomputation">typeOfComputation</code></td>
<td>
<p>The type of computation,
either &quot;direct&quot; for the direct approximation method,
or &quot;schoenfeld&quot; for the Schoenfeld method.
Defaults to &quot;direct&quot;. Can use &quot;Schoenfeld&quot;
under proportional hazards and conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupTime, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>. Adjustment
may be needed for non-monotone relationship with study power.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="lrsamplesize_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size and events.
Defaults to 1 for sample size rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two components:
</p>

<ul>
<li> <p><code>resultsUnderH1</code>: An S3 class <code>lrpower</code> object under the
alternative hypothesis.
</p>
</li>
<li> <p><code>resultsUnderH0</code>: An S3 class <code>lrpower</code> object under the
null hypothesis.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lrpower">lrpower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survival, and 5% dropout by
# the end of 1 year.

# Example 1: Obtains accrual duration given power and follow-up time

lrsamplesize(beta = 0.2, kMax = 2,
             informationRates = c(0.8, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             accrualTime = seq(0, 8),
             accrualIntensity = 26/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12,
             accrualDuration = NA,
             followupTime = 18, fixedFollowup = FALSE)


# Example 2: Obtains follow-up time given power and accrual duration

lrsamplesize(beta = 0.2, kMax = 2,
             informationRates = c(0.8, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             accrualTime = seq(0, 8),
             accrualIntensity = 26/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12,
             accrualDuration = 22,
             followupTime = NA, fixedFollowup = FALSE)


# Example 3: Obtains absolute accrual intensity given power,
# accrual duration, follow-up time, and relative accrual intensity

lrsamplesize(beta = 0.2, kMax = 2,
             informationRates = c(0.8, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             accrualTime = seq(0, 8),
             accrualIntensity = 26/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12,
             accrualDuration = 22,
             followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='lrsamplesizeequiv'>Sample size for equivalence in hazard ratio</h2><span id='topic+lrsamplesizeequiv'></span>

<h3>Description</h3>

<p>Obtains the sample size for equivalence in hazard ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrsamplesizeequiv(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  hazardRatioLower = NA_real_,
  hazardRatioUpper = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  typeOfComputation = "direct",
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrsamplesizeequiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_hazardratiolower">hazardRatioLower</code></td>
<td>
<p>The lower equivalence limit of hazard ratio.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_hazardratioupper">hazardRatioUpper</code></td>
<td>
<p>The upper equivalence limit of hazard ratio.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_typeofcomputation">typeOfComputation</code></td>
<td>
<p>The type of computation,
either &quot;direct&quot; for the direct approximation method,
or &quot;schoenfeld&quot; for the Schoenfeld method.
Defaults to &quot;direct&quot;. Can use &quot;Schoenfeld&quot;
under proportional hazards and conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupDuration, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="lrsamplesizeequiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size.
Defaults to 1 for sample size rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>lrpowerequiv</code> object
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lrpowerequiv">lrpowerequiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
lrsamplesizeequiv(kMax = 2, informationRates = c(0.5, 1),
                  alpha = 0.05, typeAlphaSpending = "sfOF",
                  hazardRatioLower = 0.71, hazardRatioUpper = 1.4,
                  allocationRatioPlanned = 1, accrualTime = seq(0, 8),
                  accrualIntensity = 26/9*seq(1, 9),
                  piecewiseSurvivalTime = c(0, 6),
                  stratumFraction = c(0.2, 0.8),
                  lambda1 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
                  lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
                  gamma1 = -log(1-0.05)/12,
                  gamma2 = -log(1-0.05)/12, accrualDuration = NA,
                  followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='lrsim'>Log-rank test simulation</h2><span id='topic+lrsim'></span>

<h3>Description</h3>

<p>Performs simulation for two-arm group sequential
trials based on weighted log-rank test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrsim(
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  futilityBounds = NA_real_,
  hazardRatioH0 = 1,
  allocation1 = 1L,
  allocation2 = 1L,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  rho1 = 0,
  rho2 = 0,
  plannedEvents = NA_integer_,
  plannedTime = NA_real_,
  maxNumberOfIterations = 1000L,
  maxNumberOfRawDatasetsPerStage = 0L,
  seed = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrsim_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates in terms of number
of events for the conventional log-rank test and in terms of
the actual information for weighted log-rank tests.
Fixed prior to the trial. If left unspecified, it defaults to
<code>plannedEvents / plannedEvents[kMax]</code> when <code>plannedEvents</code>
is provided and to <code>plannedTime / plannedTime[kMax]</code> otherwise.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_hazardratioh0">hazardRatioH0</code></td>
<td>
<p>Hazard ratio under the null hypothesis for the active
treatment versus control. Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_allocation1">allocation1</code></td>
<td>
<p>Number of subjects in the active treatment group in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_allocation2">allocation2</code></td>
<td>
<p>Number of subjects in the control group in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="lrsim_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_rho1">rho1</code></td>
<td>
<p>The first parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_rho2">rho2</code></td>
<td>
<p>The second parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_plannedevents">plannedEvents</code></td>
<td>
<p>The planned cumulative total number of events at
each stage.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_plannedtime">plannedTime</code></td>
<td>
<p>The calendar times for the analyses. To use calendar
time to plan the analyses, <code>plannedEvents</code> should be missing.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_maxnumberofiterations">maxNumberOfIterations</code></td>
<td>
<p>The number of simulation iterations.
Defaults to 1000.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_maxnumberofrawdatasetsperstage">maxNumberOfRawDatasetsPerStage</code></td>
<td>
<p>The number of raw datasets per
stage to extract.</p>
</td></tr>
<tr><td><code id="lrsim_+3A_seed">seed</code></td>
<td>
<p>The seed to reproduce the simulation results.
The seed from the environment will be used if left unspecified,</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>lrsim</code> object with 3 components:
</p>

<ul>
<li> <p><code>overview</code>: A list containing the following information:
</p>

<ul>
<li> <p><code>rejectPerStage</code>: The efficacy stopping probability by stage.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The futility stopping probability by
stage.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: Cumulative efficacy stopping
probability by stage.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative futility stopping
probability by stage.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The average number of events by stage.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The average number of dropouts by stage.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The average number of subjects by stage.
</p>
</li>
<li> <p><code>analysisTime</code>: The average analysis time by stage.
</p>
</li>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>expectedNumberOfEvents</code>: The expected number of events for
the overall study.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts</code>: The expected number of dropouts
for the overall study.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects
for the overall study.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>hazardRatioH0</code>: Hazard ratio under the null hypothesis for
the active treatment versus control.
</p>
</li>
<li> <p><code>useEvents</code>: whether the analyses are planned
based on the number of events or calendar time.
</p>
</li>
<li> <p><code>accrualDuration</code>: Duration of the enrollment period.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>rho1</code>: The first parameter of the Fleming-Harrington family
of weighted log-rank test. Defaults to 0 for conventional log-rank
test.
</p>
</li>
<li> <p><code>rho2</code>: The second parameter of the Fleming-Harrington family
of weighted log-rank test. Defaults to 0 for conventional log-rank
test.
</p>
</li>
<li> <p><code>kMax</code>: The maximum number of stages.
</p>
</li></ul>

</li>
<li> <p><code>sumdata</code>: A data frame of summary data by iteration and stage:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stopStage</code>: The stage at which the trial stops.
</p>
</li>
<li> <p><code>eventsNotAchieved</code>: Whether the target number of events
is not achieved for the iteration.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage number, covering all stages even if
the trial stops at an interim look.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>accruals1</code>: The number of subjects enrolled at the stage for
the treatment group.
</p>
</li>
<li> <p><code>accruals2</code>: The number of subjects enrolled at the stage for
the control group.
</p>
</li>
<li> <p><code>totalAccruals</code>: The total number of subjects enrolled at
the stage.
</p>
</li>
<li> <p><code>events1</code>: The number of events at the stage for
the treatment group.
</p>
</li>
<li> <p><code>events2</code>: The number of events at the stage for
the control group.
</p>
</li>
<li> <p><code>totalEvents</code>: The total number of events at the stage.
</p>
</li>
<li> <p><code>dropouts1</code>: The number of dropouts at the stage for
the treatment group.
</p>
</li>
<li> <p><code>dropouts2</code>: The number of dropouts at the stage for
the control group.
</p>
</li>
<li> <p><code>totalDropouts</code>: The total number of dropouts at the stage.
</p>
</li>
<li> <p><code>uscore</code>: The numerator of the log-rank test statistic.
</p>
</li>
<li> <p><code>vscore</code>: The variance of the log-rank test statistic.
</p>
</li>
<li> <p><code>logRankStatistic</code>: The log-rank test Z-statistic.
</p>
</li>
<li> <p><code>rejectPerStage</code>: Whether to reject the null hypothesis
at the stage.
</p>
</li>
<li> <p><code>futilityPerStage</code>: Whether to stop the trial for futility
at the stage.
</p>
</li></ul>

</li>
<li> <p><code>rawdata</code> (exists if <code>maxNumberOfRawDatasetsPerStage</code> is a
positive integer): A data frame for subject-level data for selected
replications, containing the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stopStage</code>: The stage at which the trial stops.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>subjectId</code>: The subject ID.
</p>
</li>
<li> <p><code>arrivalTime</code>: The enrollment time for the subject.
</p>
</li>
<li> <p><code>stratum</code>: The stratum for the subject.
</p>
</li>
<li> <p><code>treatmentGroup</code>: The treatment group (1 or 2) for the
subject.
</p>
</li>
<li> <p><code>survivalTime</code>: The underlying survival time for the subject.
</p>
</li>
<li> <p><code>dropoutTime</code>: The underlying dropout time for the subject.
</p>
</li>
<li> <p><code>timeUnderObservation</code>: The time under observation
since randomization.
</p>
</li>
<li> <p><code>event</code>: Whether the subject experienced the event.
</p>
</li>
<li> <p><code>dropoutEvent</code>: Whether the subject dropped out.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: analyses based on number of events

sim1 = lrsim(kMax = 2, informationRates = c(0.5, 1),
             criticalValues = c(2.797, 1.977),
             accrualIntensity = 11,
             lambda1 = 0.018, lambda2 = 0.030,
             accrualDuration = 12,
             plannedEvents = c(60, 120),
             maxNumberOfIterations = 1000,
             maxNumberOfRawDatasetsPerStage = 1,
             seed = 314159)

# summary statistics
sim1

# summary for each simulated data set
head(sim1$sumdata)

# raw data for selected replication
head(sim1$rawdata)


# Example 2: analyses based on calendar time have similar power

sim2 = lrsim(kMax = 2, informationRates = c(0.5, 1),
             criticalValues = c(2.797, 1.977),
             accrualIntensity = 11,
             lambda1 = 0.018, lambda2 = 0.030,
             accrualDuration = 12,
             plannedTime = c(31.9, 113.2),
             maxNumberOfIterations = 1000,
             maxNumberOfRawDatasetsPerStage = 1,
             seed = 314159)

# summary statistics
sim2

# summary for each simulated data set
head(sim2$sumdata)

</code></pre>

<hr>
<h2 id='lrsim2e'>Log-rank test simulation for two endpoints</h2><span id='topic+lrsim2e'></span>

<h3>Description</h3>

<p>Performs simulation for two-endpoint two-arm group
sequential trials based on weighted log-rank test. The first
<code>kMaxe1</code> looks are driven by the total number of PFS events in
two arms combined, and the subsequent looks are driven by the total
number of OS events in two arms combined. Alternatively,
the analyses can be planned to occur at specified calendar times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrsim2e(
  kMax = NA_integer_,
  kMaxe1 = NA_integer_,
  hazardRatioH0e1 = 1,
  hazardRatioH0e2 = 1,
  allocation1 = 1L,
  allocation2 = 1L,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  rho = 0,
  lambda1e1 = NA_real_,
  lambda2e1 = NA_real_,
  lambda1e2 = NA_real_,
  lambda2e2 = NA_real_,
  gamma1e1 = 0L,
  gamma2e1 = 0L,
  gamma1e2 = 0L,
  gamma2e2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  rho1 = 0,
  rho2 = 0,
  plannedEvents = NA_integer_,
  plannedTime = NA_real_,
  maxNumberOfIterations = 1000L,
  maxNumberOfRawDatasetsPerStage = 0L,
  seed = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrsim2e_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_kmaxe1">kMaxe1</code></td>
<td>
<p>Number of stages with timing determined by PFS events.
Ranges from 0 (none) to <code>kMax</code>.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_hazardratioh0e1">hazardRatioH0e1</code></td>
<td>
<p>Hazard ratio under the null hypothesis for the
active treatment vs control for endpoint 1 (PFS). Defaults to 1 for
superiority test.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_hazardratioh0e2">hazardRatioH0e2</code></td>
<td>
<p>Hazard ratio under the null hypothesis for the
active treatment vs control for endpoint 2 (OS). Defaults to 1 for
superiority test.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_allocation1">allocation1</code></td>
<td>
<p>Number of subjects in the treatment group in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_allocation2">allocation2</code></td>
<td>
<p>Number of subjects in the control group in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_rho">rho</code></td>
<td>
<p>The correlation coefficient for the standard bivariate normal
random variables used to generate time to disease progression and time
to death using the inverse CDF method.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_lambda1e1">lambda1e1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the treatment group and endpoint 1 (PFS).</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_lambda2e1">lambda2e1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group and endpoint 1 (PFS).</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_lambda1e2">lambda1e2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the treatment group and endpoint 2 (OS).</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_lambda2e2">lambda2e2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group and endpoint 2 (OS).</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_gamma1e1">gamma1e1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for the treatment group and endpoint 1 (PFS).</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_gamma2e1">gamma2e1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for the control group and endpoint 1 (PFS).</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_gamma1e2">gamma1e2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for the treatment group and endpoint 2 (OS).</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_gamma2e2">gamma2e2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for the control group and endpoint 2 (OS).</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_rho1">rho1</code></td>
<td>
<p>The first parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_rho2">rho2</code></td>
<td>
<p>The second parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_plannedevents">plannedEvents</code></td>
<td>
<p>The planned cumulative total number of PFS events at
Look 1 to Look <code>kMaxe1</code> and the planned cumulative total number
of OS events at Look <code>kMaxe1+1</code> to Look <code>kMax</code>.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_plannedtime">plannedTime</code></td>
<td>
<p>The calendar times for the analyses. To use calendar
time to plan the analyses, <code>plannedEvents</code> should be missing.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_maxnumberofiterations">maxNumberOfIterations</code></td>
<td>
<p>The number of simulation iterations.
Defaults to 1000.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_maxnumberofrawdatasetsperstage">maxNumberOfRawDatasetsPerStage</code></td>
<td>
<p>The number of raw datasets per
stage to extract.</p>
</td></tr>
<tr><td><code id="lrsim2e_+3A_seed">seed</code></td>
<td>
<p>The seed to reproduce the simulation results.
The seed from the environment will be used if left unspecified,</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 2 components:
</p>

<ul>
<li> <p><code>sumdata</code>: A data frame of summary data by iteration and stage:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>eventsNotAchieved</code>: Whether the target number of events
is not achieved for the iteration.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage number, covering all stages even if
the trial stops at an interim look.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>accruals1</code>: The number of subjects enrolled at the stage for
the treatment group.
</p>
</li>
<li> <p><code>accruals2</code>: The number of subjects enrolled at the stage for
the control group.
</p>
</li>
<li> <p><code>totalAccruals</code>: The total number of subjects enrolled at
the stage.
</p>
</li>
<li> <p><code>endpoint</code>: The endpoint (1 or 2) under consideration.
</p>
</li>
<li> <p><code>events1</code>: The number of events at the stage for
the treatment group.
</p>
</li>
<li> <p><code>events2</code>: The number of events at the stage for
the control group.
</p>
</li>
<li> <p><code>totalEvents</code>: The total number of events at the stage.
</p>
</li>
<li> <p><code>dropouts1</code>: The number of dropouts at the stage for
the treatment group.
</p>
</li>
<li> <p><code>dropouts2</code>: The number of dropouts at the stage for
the control group.
</p>
</li>
<li> <p><code>totalDropouts</code>: The total number of dropouts at the stage.
</p>
</li>
<li> <p><code>logRankStatistic</code>: The log-rank test Z-statistic for
the endpoint.
</p>
</li></ul>

</li>
<li> <p><code>rawdata</code> (exists if <code>maxNumberOfRawDatasetsPerStage</code> is a
positive integer): A data frame for subject-level data for selected
replications, containing the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage under consideration.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>subjectId</code>: The subject ID.
</p>
</li>
<li> <p><code>arrivalTime</code>: The enrollment time for the subject.
</p>
</li>
<li> <p><code>stratum</code>: The stratum for the subject.
</p>
</li>
<li> <p><code>treatmentGroup</code>: The treatment group (1 or 2) for the
subject.
</p>
</li>
<li> <p><code>survivalTime1</code>: The underlying survival time for
event endpoint 1 for the subject.
</p>
</li>
<li> <p><code>dropoutTime1</code>: The underlying dropout time for
event endpoint 1 for the subject.
</p>
</li>
<li> <p><code>timeUnderObservation1</code>: The time under observation
since randomization for event endpoint 1 for the subject.
</p>
</li>
<li> <p><code>event1</code>: Whether the subject experienced event endpoint 1.
</p>
</li>
<li> <p><code>dropoutEvent1</code>: Whether the subject dropped out for
endpoint 1.
</p>
</li>
<li> <p><code>survivalTime2</code>: The underlying survival time for
event endpoint 2 for the subject.
</p>
</li>
<li> <p><code>dropoutTime2</code>: The underlying dropout time for
event endpoint 2 for the subject.
</p>
</li>
<li> <p><code>timeUnderObservation2</code>: The time under observation
since randomization for event endpoint 2 for the subject.
</p>
</li>
<li> <p><code>event2</code>: Whether the subject experienced event endpoint 2.
</p>
</li>
<li> <p><code>dropoutEvent2</code>: Whether the subject dropped out for
endpoint 2.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sim1 = lrsim2e(
  kMax = 3,
  kMaxe1 = 2,
  allocation1 = 2,
  allocation2 = 1,
  accrualTime = c(0, 8),
  accrualIntensity = c(10, 28),
  piecewiseSurvivalTime = 0,
  rho = 0,
  lambda1e1 = log(2)/12*0.60,
  lambda2e1 = log(2)/12,
  lambda1e2 = log(2)/30*0.65,
  lambda2e2 = log(2)/30,
  accrualDuration = 20.143,
  plannedEvents = c(186, 259, 183),
  maxNumberOfIterations = 1000,
  maxNumberOfRawDatasetsPerStage = 1,
  seed = 314159)

head(sim1$sumdata)
head(sim1$rawdata)

</code></pre>

<hr>
<h2 id='lrsim2e3a'>Log-rank test simulation for two endpoints and three arms</h2><span id='topic+lrsim2e3a'></span>

<h3>Description</h3>

<p>Performs simulation for two-endpoint three-arm group
sequential trials based on weighted log-rank test. The first
<code>kMaxe1</code> looks are driven by the total number of PFS events in Arm A
and Arm C combined, and the subsequent looks are driven by the total
number of OS events in Arm A and Arm C combined. Alternatively,
the analyses can be planned to occur at specified calendar times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrsim2e3a(
  kMax = NA_integer_,
  kMaxe1 = NA_integer_,
  hazardRatioH013e1 = 1,
  hazardRatioH023e1 = 1,
  hazardRatioH012e1 = 1,
  hazardRatioH013e2 = 1,
  hazardRatioH023e2 = 1,
  hazardRatioH012e2 = 1,
  allocation1 = 1L,
  allocation2 = 1L,
  allocation3 = 1L,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  rho = 0,
  lambda1e1 = NA_real_,
  lambda2e1 = NA_real_,
  lambda3e1 = NA_real_,
  lambda1e2 = NA_real_,
  lambda2e2 = NA_real_,
  lambda3e2 = NA_real_,
  gamma1e1 = 0L,
  gamma2e1 = 0L,
  gamma3e1 = 0L,
  gamma1e2 = 0L,
  gamma2e2 = 0L,
  gamma3e2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  rho1 = 0,
  rho2 = 0,
  plannedEvents = NA_integer_,
  plannedTime = NA_real_,
  maxNumberOfIterations = 1000L,
  maxNumberOfRawDatasetsPerStage = 0L,
  seed = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrsim2e3a_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_kmaxe1">kMaxe1</code></td>
<td>
<p>Number of stages with timing determined by PFS events.
Ranges from 0 (none) to <code>kMax</code>.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_hazardratioh013e1">hazardRatioH013e1</code></td>
<td>
<p>Hazard ratio under the null hypothesis for arm 1
vs arm 3 for endpoint 1 (PFS). Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_hazardratioh023e1">hazardRatioH023e1</code></td>
<td>
<p>Hazard ratio under the null hypothesis for arm 2
vs arm 3 for endpoint 1 (PFS). Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_hazardratioh012e1">hazardRatioH012e1</code></td>
<td>
<p>Hazard ratio under the null hypothesis for arm 1
vs arm 2 for endpoint 1 (PFS). Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_hazardratioh013e2">hazardRatioH013e2</code></td>
<td>
<p>Hazard ratio under the null hypothesis for arm 1
vs arm 3 for endpoint 2 (OS). Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_hazardratioh023e2">hazardRatioH023e2</code></td>
<td>
<p>Hazard ratio under the null hypothesis for arm 2
vs arm 3 for endpoint 2 (OS). Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_hazardratioh012e2">hazardRatioH012e2</code></td>
<td>
<p>Hazard ratio under the null hypothesis for arm 1
vs arm 2 for endpoint 2 (OS). Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_allocation1">allocation1</code></td>
<td>
<p>Number of subjects in Arm A in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_allocation2">allocation2</code></td>
<td>
<p>Number of subjects in Arm B in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_allocation3">allocation3</code></td>
<td>
<p>Number of subjects in Arm C in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_rho">rho</code></td>
<td>
<p>The correlation coefficient for the standard bivariate normal
random variables used to generate time to disease progression and time
to death using the inverse CDF method.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_lambda1e1">lambda1e1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for arm 1 and endpoint 1 (PFS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_lambda2e1">lambda2e1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for arm 2 and endpoint 1 (PFS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_lambda3e1">lambda3e1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for arm 3 and endpoint 1 (PFS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_lambda1e2">lambda1e2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for arm 1 and endpoint 2 (OS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_lambda2e2">lambda2e2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for arm 2 and endpoint 2 (OS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_lambda3e2">lambda3e2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for arm 3 and endpoint 2 (OS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_gamma1e1">gamma1e1</code></td>
<td>
<p>The hazard rate for exponential dropout. A vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for arm 1 and endpoint 1 (PFS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_gamma2e1">gamma2e1</code></td>
<td>
<p>The hazard rate for exponential dropout. A vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for arm 2 and endpoint 1 (PFS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_gamma3e1">gamma3e1</code></td>
<td>
<p>The hazard rate for exponential dropout. A vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for arm 3 and endpoint 1 (PFS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_gamma1e2">gamma1e2</code></td>
<td>
<p>The hazard rate for exponential dropout. A vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for arm 1 and endpoint 2 (OS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_gamma2e2">gamma2e2</code></td>
<td>
<p>The hazard rate for exponential dropout. A vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for arm 2 and endpoint 2 (OS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_gamma3e2">gamma3e2</code></td>
<td>
<p>The hazard rate for exponential dropout. A vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for arm 3 and endpoint 2 (OS).</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_rho1">rho1</code></td>
<td>
<p>The first parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_rho2">rho2</code></td>
<td>
<p>The second parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_plannedevents">plannedEvents</code></td>
<td>
<p>The planned cumulative total number of PFS events at
Look 1 to Look <code>kMaxe1</code> for Arms A and C combined and the planned
cumulative total number of OS events at Look <code>kMaxe1+1</code> to Look
<code>kMax</code> for Arms A and C combined.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_plannedtime">plannedTime</code></td>
<td>
<p>The calendar times for the analyses. To use calendar
time to plan the analyses, <code>plannedEvents</code> should be missing.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_maxnumberofiterations">maxNumberOfIterations</code></td>
<td>
<p>The number of simulation iterations.
Defaults to 1000.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_maxnumberofrawdatasetsperstage">maxNumberOfRawDatasetsPerStage</code></td>
<td>
<p>The number of raw datasets per
stage to extract.</p>
</td></tr>
<tr><td><code id="lrsim2e3a_+3A_seed">seed</code></td>
<td>
<p>The seed to reproduce the simulation results.
The seed from the environment will be used if left unspecified,</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 2 components:
</p>

<ul>
<li> <p><code>sumdata</code>: A data frame of summary data by iteration and stage:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>eventsNotAchieved</code>: Whether the target number of events
is not achieved for the iteration.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage number, covering all stages even if
the trial stops at an interim look.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>accruals1</code>: The number of subjects enrolled at the stage for
the active treatment 1 group.
</p>
</li>
<li> <p><code>accruals2</code>: The number of subjects enrolled at the stage for
the active treatment 2 group.
</p>
</li>
<li> <p><code>accruals3</code>: The number of subjects enrolled at the stage for
the control group.
</p>
</li>
<li> <p><code>totalAccruals</code>: The total number of subjects enrolled at
the stage.
</p>
</li>
<li> <p><code>endpoint</code>: The endpoint (1 or 2) under consideration.
</p>
</li>
<li> <p><code>events1</code>: The number of events at the stage for
the active treatment 1 group.
</p>
</li>
<li> <p><code>events2</code>: The number of events at the stage for
the active treatment 2 group.
</p>
</li>
<li> <p><code>events3</code>: The number of events at the stage for
the control group.
</p>
</li>
<li> <p><code>totalEvents</code>: The total number of events at the stage.
</p>
</li>
<li> <p><code>dropouts1</code>: The number of dropouts at the stage for
the active treatment 1 group.
</p>
</li>
<li> <p><code>dropouts2</code>: The number of dropouts at the stage for
the active treatment 2 group.
</p>
</li>
<li> <p><code>dropouts3</code>: The number of dropouts at the stage for
the control group.
</p>
</li>
<li> <p><code>totalDropouts</code>: The total number of dropouts at the stage.
</p>
</li>
<li> <p><code>logRankStatistic13</code>: The log-rank test Z-statistic
comparing the active treatment 1 to the control for the endpoint.
</p>
</li>
<li> <p><code>logRankStatistic23</code>: The log-rank test Z-statistic
comparing the active treatment 2 to the control for the endpoint.
</p>
</li>
<li> <p><code>logRankStatistic12</code>: The log-rank test Z-statistic
comparing the active treatment 1 to the active treatment 2
for the endpoint.
</p>
</li></ul>

</li>
<li> <p><code>rawdata</code> (exists if <code>maxNumberOfRawDatasetsPerStage</code> is a
positive integer): A data frame for subject-level data for selected
replications, containing the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage under consideration.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>subjectId</code>: The subject ID.
</p>
</li>
<li> <p><code>arrivalTime</code>: The enrollment time for the subject.
</p>
</li>
<li> <p><code>stratum</code>: The stratum for the subject.
</p>
</li>
<li> <p><code>treatmentGroup</code>: The treatment group (1, 2, or 3) for
the subject.
</p>
</li>
<li> <p><code>survivalTime1</code>: The underlying survival time for
event endpoint 1 for the subject.
</p>
</li>
<li> <p><code>dropoutTime1</code>: The underlying dropout time for
event endpoint 1 for the subject.
</p>
</li>
<li> <p><code>timeUnderObservation1</code>: The time under observation
since randomization for event endpoint 1 for the subject.
</p>
</li>
<li> <p><code>event1</code>: Whether the subject experienced event endpoint 1.
</p>
</li>
<li> <p><code>dropoutEvent1</code>: Whether the subject dropped out for
endpoint 1.
</p>
</li>
<li> <p><code>survivalTime2</code>: The underlying survival time for
event endpoint 2 for the subject.
</p>
</li>
<li> <p><code>dropoutTime2</code>: The underlying dropout time for
event endpoint 2 for the subject.
</p>
</li>
<li> <p><code>timeUnderObservation2</code>: The time under observation
since randomization for event endpoint 2 for the subject.
</p>
</li>
<li> <p><code>event2</code>: Whether the subject experienced event endpoint 2.
</p>
</li>
<li> <p><code>dropoutEvent2</code>: Whether the subject dropped out for
endpoint 2.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sim1 = lrsim2e3a(
  kMax = 3,
  kMaxe1 = 2,
  allocation1 = 2,
  allocation2 = 2,
  allocation3 = 1,
  accrualTime = c(0, 8),
  accrualIntensity = c(10, 28),
  piecewiseSurvivalTime = 0,
  rho = 0,
  lambda1e1 = log(2)/12*0.60,
  lambda2e1 = log(2)/12*0.70,
  lambda3e1 = log(2)/12,
  lambda1e2 = log(2)/30*0.65,
  lambda2e2 = log(2)/30*0.75,
  lambda3e2 = log(2)/30,
  accrualDuration = 30.143,
  plannedEvents = c(186, 259, 183),
  maxNumberOfIterations = 1000,
  maxNumberOfRawDatasetsPerStage = 1,
  seed = 314159)

head(sim1$sumdata)
head(sim1$rawdata)

</code></pre>

<hr>
<h2 id='lrsim3a'>Log-rank test simulation for three arms</h2><span id='topic+lrsim3a'></span>

<h3>Description</h3>

<p>Performs simulation for three-arm group sequential trials
based on weighted log-rank test. The looks are driven by the total
number of events in Arm A and Arm C combined. Alternatively,
the analyses can be planned to occur at specified calendar times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrsim3a(
  kMax = NA_integer_,
  hazardRatioH013 = 1,
  hazardRatioH023 = 1,
  hazardRatioH012 = 1,
  allocation1 = 1L,
  allocation2 = 1L,
  allocation3 = 1L,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  lambda3 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  gamma3 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  rho1 = 0,
  rho2 = 0,
  plannedEvents = NA_integer_,
  plannedTime = NA_real_,
  maxNumberOfIterations = 1000L,
  maxNumberOfRawDatasetsPerStage = 0L,
  seed = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrsim3a_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_hazardratioh013">hazardRatioH013</code></td>
<td>
<p>Hazard ratio under the null hypothesis for arm 1
versus arm 3. Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_hazardratioh023">hazardRatioH023</code></td>
<td>
<p>Hazard ratio under the null hypothesis for arm 2
versus arm 3. Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_hazardratioh012">hazardRatioH012</code></td>
<td>
<p>Hazard ratio under the null hypothesis for arm 1
versus arm 2. Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_allocation1">allocation1</code></td>
<td>
<p>Number of subjects in Arm A in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_allocation2">allocation2</code></td>
<td>
<p>Number of subjects in Arm B in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_allocation3">allocation3</code></td>
<td>
<p>Number of subjects in Arm C in
a randomization block. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for arm 1.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for arm 2.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_lambda3">lambda3</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for arm 3.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout. A vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for arm 1.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout. A vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for arm 2.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_gamma3">gamma3</code></td>
<td>
<p>The hazard rate for exponential dropout. A vector of
hazard rates for piecewise exponential dropout applicable for all
strata, or a vector of hazard rates for dropout in each analysis time
interval by stratum for arm 3.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_rho1">rho1</code></td>
<td>
<p>The first parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_rho2">rho2</code></td>
<td>
<p>The second parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_plannedevents">plannedEvents</code></td>
<td>
<p>The planned cumulative total number of events at
Look 1 to Look <code>kMax</code> for Arms A and C combined.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_plannedtime">plannedTime</code></td>
<td>
<p>The calendar times for the analyses. To use calendar
time to plan the analyses, <code>plannedEvents</code> should be missing.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_maxnumberofiterations">maxNumberOfIterations</code></td>
<td>
<p>The number of simulation iterations.
Defaults to 1000.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_maxnumberofrawdatasetsperstage">maxNumberOfRawDatasetsPerStage</code></td>
<td>
<p>The number of raw datasets per
stage to extract.</p>
</td></tr>
<tr><td><code id="lrsim3a_+3A_seed">seed</code></td>
<td>
<p>The seed to reproduce the simulation results.
The seed from the environment will be used if left unspecified,</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 2 components:
</p>

<ul>
<li> <p><code>sumdata</code>: A data frame of summary data by iteration and stage:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>eventsNotAchieved</code>: Whether the target number of events
is not achieved for the iteration.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage number, covering all stages even if
the trial stops at an interim look.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>accruals1</code>: The number of subjects enrolled at the stage for
the active treatment 1 group.
</p>
</li>
<li> <p><code>accruals2</code>: The number of subjects enrolled at the stage for
the active treatment 2 group.
</p>
</li>
<li> <p><code>accruals3</code>: The number of subjects enrolled at the stage for
the control group.
</p>
</li>
<li> <p><code>totalAccruals</code>: The total number of subjects enrolled at
the stage.
</p>
</li>
<li> <p><code>events1</code>: The number of events at the stage for
the active treatment 1 group.
</p>
</li>
<li> <p><code>events2</code>: The number of events at the stage for
the active treatment 2 group.
</p>
</li>
<li> <p><code>events3</code>: The number of events at the stage for
the control group.
</p>
</li>
<li> <p><code>totalEvents</code>: The total number of events at the stage.
</p>
</li>
<li> <p><code>dropouts1</code>: The number of dropouts at the stage for
the active treatment 1 group.
</p>
</li>
<li> <p><code>dropouts2</code>: The number of dropouts at the stage for
the active treatment 2 group.
</p>
</li>
<li> <p><code>dropouts3</code>: The number of dropouts at the stage for
the control group.
</p>
</li>
<li> <p><code>totalDropouts</code>: The total number of dropouts at the stage.
</p>
</li>
<li> <p><code>logRankStatistic13</code>: The log-rank test Z-statistic
comparing the active treatment 1 to the control.
</p>
</li>
<li> <p><code>logRankStatistic23</code>: The log-rank test Z-statistic
comparing the active treatment 2 to the control.
</p>
</li>
<li> <p><code>logRankStatistic12</code>: The log-rank test Z-statistic
comparing the active treatment 1 to the active treatment 2.
</p>
</li></ul>

</li>
<li> <p><code>rawdata</code> (exists if <code>maxNumberOfRawDatasetsPerStage</code> is a
positive integer): A data frame for subject-level data for selected
replications, containing the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage under consideration.
</p>
</li>
<li> <p><code>analysisTime</code>: The time for the stage since trial start.
</p>
</li>
<li> <p><code>subjectId</code>: The subject ID.
</p>
</li>
<li> <p><code>arrivalTime</code>: The enrollment time for the subject.
</p>
</li>
<li> <p><code>stratum</code>: The stratum for the subject.
</p>
</li>
<li> <p><code>treatmentGroup</code>: The treatment group (1, 2, or 3) for
the subject.
</p>
</li>
<li> <p><code>survivalTime</code>: The underlying survival time for the subject.
</p>
</li>
<li> <p><code>dropoutTime</code>: The underlying dropout time for the subject.
</p>
</li>
<li> <p><code>timeUnderObservation</code>: The time under observation
since randomization for the subject.
</p>
</li>
<li> <p><code>event</code>: Whether the subject experienced the event.
</p>
</li>
<li> <p><code>dropoutEvent</code>: Whether the subject dropped out.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sim1 = lrsim3a(
  kMax = 3,
  allocation1 = 2,
  allocation2 = 2,
  allocation3 = 1,
  accrualTime = c(0, 8),
  accrualIntensity = c(10, 28),
  piecewiseSurvivalTime = 0,
  lambda1 = log(2)/12*0.60,
  lambda2 = log(2)/12*0.70,
  lambda3 = log(2)/12,
  accrualDuration = 30.143,
  plannedEvents = c(186, 259, 295),
  maxNumberOfIterations = 1000,
  maxNumberOfRawDatasetsPerStage = 1,
  seed = 314159)

head(sim1$sumdata)
head(sim1$rawdata)

</code></pre>

<hr>
<h2 id='lrstat'>Number of subjects having an event and log-rank statistics</h2><span id='topic+lrstat'></span>

<h3>Description</h3>

<p>Obtains the number of subjects accrued, number of events,
number of dropouts, and number of subjects reaching the maximum
follow-up in each group, mean and variance of weighted log-rank
score statistic, estimated hazard ratio from weighted Cox regression
and variance of log hazard ratio estimate at given calendar times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrstat(
  time = NA_real_,
  hazardRatioH0 = 1,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  rho1 = 0,
  rho2 = 0,
  numSubintervals = 300L,
  predictTarget = 2L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrstat_+3A_time">time</code></td>
<td>
<p>A vector of calendar times at which to calculate the number
of events and the mean and variance of log-rank test score statistic.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_hazardratioh0">hazardRatioH0</code></td>
<td>
<p>Hazard ratio under the null hypothesis for the active
treatment versus control. Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="lrstat_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_rho1">rho1</code></td>
<td>
<p>The first parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_rho2">rho2</code></td>
<td>
<p>The second parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_numsubintervals">numSubintervals</code></td>
<td>
<p>Number of sub-intervals to approximate the mean
and variance of the weighted log-rank test score statistic.
Defaults to 300. Specify a larger number for better approximation.</p>
</td></tr>
<tr><td><code id="lrstat_+3A_predicttarget">predictTarget</code></td>
<td>
<p>The target of prediction.
Set <code>predictTarget = 1</code> to predict the number of events only.
Set <code>predictTarget = 2</code> (default) to predict the number of events
and log-rank score statistic mean and variance.
Set <code>predictTarget = 3</code> to predict the number of events,
log-rank score statistic mean and variance, and
hazard ratio and variance of log hazard ratio.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables if
<code>predictTarget = 1</code>:
</p>

<ul>
<li> <p><code>time</code>: The analysis time since trial start.
</p>
</li>
<li> <p><code>subjects</code>: The number of enrolled subjects.
</p>
</li>
<li> <p><code>nevents</code>: The total number of events.
</p>
</li>
<li> <p><code>nevents1</code>: The number of events in the active treatment group.
</p>
</li>
<li> <p><code>nevents2</code>: The number of events in the control group.
</p>
</li>
<li> <p><code>ndropouts</code>: The total number of dropouts.
</p>
</li>
<li> <p><code>ndropouts1</code>: The number of dropouts in the active treatment
group.
</p>
</li>
<li> <p><code>ndropouts2</code>: The number of dropouts in the control group.
</p>
</li>
<li> <p><code>nfmax</code>: The total number of subjects reaching maximum follow-up.
</p>
</li>
<li> <p><code>nfmax1</code>: The number of subjects reaching maximum follow-up in
the active treatment group.
</p>
</li>
<li> <p><code>nfmax2</code>: The number of subjects reaching maximum follow-up in
the control group.
</p>
</li></ul>

<p>If <code>predictTarget = 2</code>, the following variables will also
be included:
</p>

<ul>
<li> <p><code>uscore</code>: The numerator of the log-rank test statistic.
</p>
</li>
<li> <p><code>vscore</code>: The variance of the log-rank score test statistic.
</p>
</li>
<li> <p><code>logRankZ</code>: The log-rank test statistic on the Z-scale.
</p>
</li>
<li> <p><code>hazardRatioH0</code>: The hazard ratio under the null hypothesis.
</p>
</li></ul>

<p>Furthermore, if <code>predictTarget = 3</code>, the following additional
variables will also be included:
</p>

<ul>
<li> <p><code>HR</code>: The average hazard ratio from weighted Cox regression.
</p>
</li>
<li> <p><code>vlogHR</code>: The variance of log hazard ratio.
</p>
</li>
<li> <p><code>zlogHR</code>: The Z-statistic for log hazard ratio.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.

lrstat(time = c(22, 40), allocationRatioPlanned = 1,
       accrualTime = seq(0, 8),
       accrualIntensity = 26/9*seq(1, 9),
       piecewiseSurvivalTime = c(0, 6),
       stratumFraction = c(0.2, 0.8),
       lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
       lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
       gamma1 = -log(1-0.05)/12,
       gamma2 = -log(1-0.05)/12,
       accrualDuration = 22,
       followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='lrstat1'>Number of subjects having an event and log-rank statistic
for a hypothesized hazard ratio at a given calendar time</h2><span id='topic+lrstat1'></span>

<h3>Description</h3>

<p>Obtains the number of subjects having an event in each
treatment group by stratum, the mean and variance of weighted log-rank
score statistic for a hypothesized hazard ratio at a given calendar time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrstat1(
  time = NA_real_,
  hazardRatioH0 = 1,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  rho1 = 0,
  rho2 = 0,
  numSubintervals = 300L,
  predictEventOnly = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrstat1_+3A_time">time</code></td>
<td>
<p>The calendar time at which to calculate the number
of events and the mean and variance of log-rank test score statistic.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_hazardratioh0">hazardRatioH0</code></td>
<td>
<p>Hazard ratio under the null hypothesis for the active
treatment versus control. Defaults to 1 for superiority test.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_rho1">rho1</code></td>
<td>
<p>The first parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_rho2">rho2</code></td>
<td>
<p>The second parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_numsubintervals">numSubintervals</code></td>
<td>
<p>Number of sub-intervals to approximate the mean
and variance of the weighted log-rank test score statistic.
Defaults to 300. Specify a larger number for better approximation.</p>
</td></tr>
<tr><td><code id="lrstat1_+3A_predicteventonly">predictEventOnly</code></td>
<td>
<p>Whether to predict the number of events only.
Defaults to 0 for obtaining log-rank test score statistic mean
and variance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of the following variables if
<code>predictEventOnly = 1</code>:
</p>

<ul>
<li> <p><code>stratum</code>: The stratum number.
</p>
</li>
<li> <p><code>time</code>: The analysis time since trial start.
</p>
</li>
<li> <p><code>subjects</code>: The number of enrolled subjects.
</p>
</li>
<li> <p><code>nevents</code>: The total number of events.
</p>
</li>
<li> <p><code>nevents1</code>: The number of events in the active treatment group.
</p>
</li>
<li> <p><code>nevents2</code>: The number of events in the control group.
</p>
</li>
<li> <p><code>ndropouts</code>: The total number of dropouts.
</p>
</li>
<li> <p><code>ndropouts1</code>: The number of dropouts in the active treatment
group.
</p>
</li>
<li> <p><code>ndropouts2</code>: The number of dropouts in the control group.
</p>
</li>
<li> <p><code>nfmax</code>: The total number of subjects reaching maximum follow-up.
</p>
</li>
<li> <p><code>nfmax1</code>: The number of subjects reaching maximum follow-up in
the active treatment group.
</p>
</li>
<li> <p><code>nfmax2</code>: The number of subjects reaching maximum follow-up in
the control group.
</p>
</li></ul>

<p>If <code>predictEventOnly = 0</code>, the following variables will also
be included:
</p>

<ul>
<li> <p><code>uscore</code>: The numerator of the weighted log-rank test statistic.
</p>
</li>
<li> <p><code>vscore</code>: The variance of the weighted log-rank score statistic
with weight squared.
</p>
</li>
<li> <p><code>iscore</code>: The Fisher information of the weighted log-rank score
statistic.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.

lrstat1(time = 22, hazardRatioH0 = 1,
        allocationRatioPlanned = 1,
        accrualTime = seq(0, 8),
        accrualIntensity = 26/9*seq(1, 9),
        piecewiseSurvivalTime = c(0, 6),
        stratumFraction = c(0.2, 0.8),
        lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
        lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
        gamma1 = -log(1-0.05)/12,
        gamma2 = -log(1-0.05)/12,
        accrualDuration = 22,
        followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='lrtest'>Log-rank test of survival curve difference</h2><span id='topic+lrtest'></span>

<h3>Description</h3>

<p>Obtains the log-rank test using the Fleming-Harrington
family of weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrtest(
  data,
  rep = "rep",
  stratum = "stratum",
  treat = "treat",
  time = "time",
  event = "event",
  rho1 = 0,
  rho2 = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrtest_+3A_data">data</code></td>
<td>
<p>The input data frame that contains the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication for by-group processing.
</p>
</li>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>treat</code>: The treatment.
</p>
</li>
<li> <p><code>time</code>: The possibly right-censored survival time.
</p>
</li>
<li> <p><code>event</code>: The event indicator.
</p>
</li></ul>
</td></tr>
<tr><td><code id="lrtest_+3A_rep">rep</code></td>
<td>
<p>The name of the replication variable in the input data.</p>
</td></tr>
<tr><td><code id="lrtest_+3A_stratum">stratum</code></td>
<td>
<p>The name of the stratum variable in the input data.</p>
</td></tr>
<tr><td><code id="lrtest_+3A_treat">treat</code></td>
<td>
<p>The name of the treatment variable in the input data.</p>
</td></tr>
<tr><td><code id="lrtest_+3A_time">time</code></td>
<td>
<p>The name of the time variable in the input data.</p>
</td></tr>
<tr><td><code id="lrtest_+3A_event">event</code></td>
<td>
<p>The name of the event variable in the input data.</p>
</td></tr>
<tr><td><code id="lrtest_+3A_rho1">rho1</code></td>
<td>
<p>The first parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
<tr><td><code id="lrtest_+3A_rho2">rho2</code></td>
<td>
<p>The second parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication.
</p>
</li>
<li> <p><code>uscore</code>: The numerator of the log-rank test statistic.
</p>
</li>
<li> <p><code>vscore</code>: The variance of the log-rank score test statistic.
</p>
</li>
<li> <p><code>logRankZ</code>: The Z-statistic value.
</p>
</li>
<li> <p><code>logRankPValue</code>: The one-sided p-value.
</p>
</li>
<li> <p><code>rho1</code>: The first parameter of the Fleming-Harrington weights.
</p>
</li>
<li> <p><code>rho2</code>: The second parameter of the Fleming-Harrington weights.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- lrtest(data = rawdata, rep = "iterationNumber",
             stratum = "stratum", treat = "treatmentGroup",
             time = "timeUnderObservation", event = "event",
             rho1 = 0.5, rho2 = 0)
head(df)

</code></pre>

<hr>
<h2 id='mnOddsRatioCI'>Miettinen-Nurminen score confidence interval for
two-sample odds ratio</h2><span id='topic+mnOddsRatioCI'></span>

<h3>Description</h3>

<p>Obtains the Miettinen-Nurminen score confidence
interval for two-sample odds ratio possibly with
stratification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnOddsRatioCI(
  n1 = NA_real_,
  y1 = NA_real_,
  n2 = NA_real_,
  y2 = NA_real_,
  cilevel = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnOddsRatioCI_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="mnOddsRatioCI_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="mnOddsRatioCI_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="mnOddsRatioCI_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
<tr><td><code id="mnOddsRatioCI_+3A_cilevel">cilevel</code></td>
<td>
<p>The confidence interval level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mantel-Haenszel sample size weights are used for stratified
samples.
</p>


<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li> <p><code>data</code> A data frame containing the input sample size
and number of responses for each treatment group.
It has the following variables:
</p>

<ul>
<li> <p><code>n1</code>: The sample size for the active treatment group.
</p>
</li>
<li> <p><code>y1</code>: The number of responses for the active treatment group.
</p>
</li>
<li> <p><code>n2</code>: The sample size for the control group.
</p>
</li>
<li> <p><code>y2</code>: The number of responses for the control group.
</p>
</li></ul>

</li>
<li> <p><code>estimates</code>: A data frame containing the point estimate
and confidence interval for odds ratio. It has the following
variables:
</p>

<ul>
<li> <p><code>scale</code>: The scale of treatment effect.
</p>
</li>
<li> <p><code>estimate</code>: The point estimate.
</p>
</li>
<li> <p><code>lower</code>: The lower limit of the confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper limit of the confidence interval.
</p>
</li>
<li> <p><code>cilevel</code>: The confidence interval level.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mnOddsRatioCI(n1 = c(10,10), y1 = c(4,3), n2 = c(20,10), y2 = c(2,0))

</code></pre>

<hr>
<h2 id='mnRateDiffCI'>Miettinen-Nurminen score confidence interval for
two-sample rate difference</h2><span id='topic+mnRateDiffCI'></span>

<h3>Description</h3>

<p>Obtains the Miettinen-Nurminen score confidence
interval for two-sample rate difference possibly with
stratification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnRateDiffCI(
  t1 = NA_real_,
  y1 = NA_real_,
  t2 = NA_real_,
  y2 = NA_real_,
  cilevel = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnRateDiffCI_+3A_t1">t1</code></td>
<td>
<p>The exposure for the active treatment group.</p>
</td></tr>
<tr><td><code id="mnRateDiffCI_+3A_y1">y1</code></td>
<td>
<p>The number of events for the active treatment group.</p>
</td></tr>
<tr><td><code id="mnRateDiffCI_+3A_t2">t2</code></td>
<td>
<p>The exposure for the control group.</p>
</td></tr>
<tr><td><code id="mnRateDiffCI_+3A_y2">y2</code></td>
<td>
<p>The number of events for the control group.</p>
</td></tr>
<tr><td><code id="mnRateDiffCI_+3A_cilevel">cilevel</code></td>
<td>
<p>The confidence interval level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mantel-Haenszel weights are used for stratified samples.
</p>


<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li> <p><code>data</code> A data frame containing the input exposure
and number of events for each treatment group.
It has the following variables:
</p>

<ul>
<li> <p><code>t1</code>: The exposure for the active treatment group.
</p>
</li>
<li> <p><code>y1</code>: The number of events for the active treatment group.
</p>
</li>
<li> <p><code>t2</code>: The exposure for the control group.
</p>
</li>
<li> <p><code>y2</code>: The number of events for the control group.
</p>
</li></ul>

</li>
<li> <p><code>estimates</code>: A data frame containing the point estimate
and confidence interval for rate difference. It has the following
variables:
</p>

<ul>
<li> <p><code>scale</code>: The scale of treatment effect.
</p>
</li>
<li> <p><code>estimate</code>: The point estimate.
</p>
</li>
<li> <p><code>lower</code>: The lower limit of the confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper limit of the confidence interval.
</p>
</li>
<li> <p><code>cilevel</code>: The confidence interval level.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mnRateDiffCI(t1 = c(10,10), y1 = c(4,3), t2 = c(20,10), y2 = c(2,0))

</code></pre>

<hr>
<h2 id='mnRateRatioCI'>Miettinen-Nurminen score confidence interval for
two-sample rate ratio</h2><span id='topic+mnRateRatioCI'></span>

<h3>Description</h3>

<p>Obtains the Miettinen-Nurminen score confidence
interval for two-sample rate ratio possibly with
stratification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnRateRatioCI(t1, y1, t2, y2, cilevel = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnRateRatioCI_+3A_t1">t1</code></td>
<td>
<p>The exposure for the active treatment group.</p>
</td></tr>
<tr><td><code id="mnRateRatioCI_+3A_y1">y1</code></td>
<td>
<p>The number of events for the active treatment group.</p>
</td></tr>
<tr><td><code id="mnRateRatioCI_+3A_t2">t2</code></td>
<td>
<p>The exposure for the control group.</p>
</td></tr>
<tr><td><code id="mnRateRatioCI_+3A_y2">y2</code></td>
<td>
<p>The number of events for the control group.</p>
</td></tr>
<tr><td><code id="mnRateRatioCI_+3A_cilevel">cilevel</code></td>
<td>
<p>The confidence interval level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mantel-Haenszel weights are used for stratified samples.
</p>


<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li> <p><code>data</code> A data frame containing the input exposure
and number of events for each treatment group.
It has the following variables:
</p>

<ul>
<li> <p><code>t1</code>: The exposure for the active treatment group.
</p>
</li>
<li> <p><code>y1</code>: The number of events for the active treatment group.
</p>
</li>
<li> <p><code>t2</code>: The exposure for the control group.
</p>
</li>
<li> <p><code>y2</code>: The number of events for the control group.
</p>
</li></ul>

</li>
<li> <p><code>estimates</code>: A data frame containing the point estimate
and confidence interval for rate ratio. It has the following
variables:
</p>

<ul>
<li> <p><code>scale</code>: The scale of treatment effect.
</p>
</li>
<li> <p><code>estimate</code>: The point estimate.
</p>
</li>
<li> <p><code>lower</code>: The lower limit of the confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper limit of the confidence interval.
</p>
</li>
<li> <p><code>cilevel</code>: The confidence interval level.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mnRateRatioCI(t1 = c(10,10), y1 = c(4,3), t2 = c(20,10), y2 = c(2,0))

</code></pre>

<hr>
<h2 id='mnRiskDiffCI'>Miettinen-Nurminen score confidence interval for
two-sample risk difference</h2><span id='topic+mnRiskDiffCI'></span>

<h3>Description</h3>

<p>Obtains the Miettinen-Nurminen score confidence
interval for two-sample risk difference possibly with
stratification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnRiskDiffCI(
  n1 = NA_real_,
  y1 = NA_real_,
  n2 = NA_real_,
  y2 = NA_real_,
  cilevel = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnRiskDiffCI_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="mnRiskDiffCI_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="mnRiskDiffCI_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="mnRiskDiffCI_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
<tr><td><code id="mnRiskDiffCI_+3A_cilevel">cilevel</code></td>
<td>
<p>The confidence interval level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mantel-Haenszel sample size weights are used for stratified
samples.
</p>


<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li> <p><code>data</code> A data frame containing the input sample size
and number of responses for each treatment group.
It has the following variables:
</p>

<ul>
<li> <p><code>n1</code>: The sample size for the active treatment group.
</p>
</li>
<li> <p><code>y1</code>: The number of responses for the active treatment group.
</p>
</li>
<li> <p><code>n2</code>: The sample size for the control group.
</p>
</li>
<li> <p><code>y2</code>: The number of responses for the control group.
</p>
</li></ul>

</li>
<li> <p><code>estimates</code>: A data frame containing the point estimate
and confidence interval for risk difference. It has the following
variables:
</p>

<ul>
<li> <p><code>scale</code>: The scale of treatment effect.
</p>
</li>
<li> <p><code>estimate</code>: The point estimate.
</p>
</li>
<li> <p><code>lower</code>: The lower limit of the confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper limit of the confidence interval.
</p>
</li>
<li> <p><code>cilevel</code>: The confidence interval level.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mnRiskDiffCI(n1 = c(10,10), y1 = c(4,3), n2 = c(20,10), y2 = c(2,0))

</code></pre>

<hr>
<h2 id='mnRiskRatioCI'>Miettinen-Nurminen score confidence interval for
two-sample risk ratio</h2><span id='topic+mnRiskRatioCI'></span>

<h3>Description</h3>

<p>Obtains the Miettinen-Nurminen score confidence
interval for two-sample risk ratio possibly with
stratification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnRiskRatioCI(
  n1 = NA_real_,
  y1 = NA_real_,
  n2 = NA_real_,
  y2 = NA_real_,
  cilevel = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnRiskRatioCI_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="mnRiskRatioCI_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="mnRiskRatioCI_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="mnRiskRatioCI_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
<tr><td><code id="mnRiskRatioCI_+3A_cilevel">cilevel</code></td>
<td>
<p>The confidence interval level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mantel-Haenszel sample size weights are used for stratified
samples.
</p>


<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li> <p><code>data</code> A data frame containing the input sample size
and number of responses for each treatment group.
It has the following variables:
</p>

<ul>
<li> <p><code>n1</code>: The sample size for the active treatment group.
</p>
</li>
<li> <p><code>y1</code>: The number of responses for the active treatment group.
</p>
</li>
<li> <p><code>n2</code>: The sample size for the control group.
</p>
</li>
<li> <p><code>y2</code>: The number of responses for the control group.
</p>
</li></ul>

</li>
<li> <p><code>estimates</code>: A data frame containing the point estimate
and confidence interval for risk ratio. It has the following
variables:
</p>

<ul>
<li> <p><code>scale</code>: The scale of treatment effect.
</p>
</li>
<li> <p><code>estimate</code>: The point estimate.
</p>
</li>
<li> <p><code>lower</code>: The lower limit of the confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper limit of the confidence interval.
</p>
</li>
<li> <p><code>cilevel</code>: The confidence interval level.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mnRiskRatioCI(n1 = c(10,10), y1 = c(4,3), n2 = c(20,10), y2 = c(2,0))

</code></pre>

<hr>
<h2 id='mTPI2Table'>mTPI-2 decision table</h2><span id='topic+mTPI2Table'></span>

<h3>Description</h3>

<p>Obtains the decision table for the modified toxicity
probability interval-2 (mTPI-2) design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mTPI2Table(
  nMax = NA_integer_,
  pT = 0.3,
  epsilon1 = 0.05,
  epsilon2 = 0.05,
  a = 1,
  b = 1,
  pExcessTox = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mTPI2Table_+3A_nmax">nMax</code></td>
<td>
<p>The maximum number of subjects in a dose cohort.</p>
</td></tr>
<tr><td><code id="mTPI2Table_+3A_pt">pT</code></td>
<td>
<p>The target toxicity probability. Defaults to 0.3.</p>
</td></tr>
<tr><td><code id="mTPI2Table_+3A_epsilon1">epsilon1</code></td>
<td>
<p>The lower equivalence margin from the target.
Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="mTPI2Table_+3A_epsilon2">epsilon2</code></td>
<td>
<p>The upper equivalence margin from the target.
Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="mTPI2Table_+3A_a">a</code></td>
<td>
<p>The prior toxicity parameter for the beta prior.</p>
</td></tr>
<tr><td><code id="mTPI2Table_+3A_b">b</code></td>
<td>
<p>The prior non-toxicity parameter for the beta prior.</p>
</td></tr>
<tr><td><code id="mTPI2Table_+3A_pexcesstox">pExcessTox</code></td>
<td>
<p>The threshold for excessive toxicity, i.e.,
if Prob(p &gt; pT | Data) &gt; pExcessTox, then the current and
all higher doses will be excluded and never be used again
in the remainder of the trial to avoid any other subjects
receiving treatment at those doses. Defaults to 0.95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>mTPI2Table</code> object with the following
components:
</p>

<ul>
<li> <p><code>settings</code>: The input settings data frame with the following
variables:
</p>

<ul>
<li> <p><code>nMax</code>: The maximum number of subjects in a dose cohort.
</p>
</li>
<li> <p><code>pT</code>: The target toxicity probability.
</p>
</li>
<li> <p><code>epsilon1</code>: The lower equivalence margin from the target.
</p>
</li>
<li> <p><code>epsilon2</code>: The upper equivalence margin from the target.
</p>
</li>
<li> <p><code>a</code>: The prior toxicity parameter for the beta prior.
</p>
</li>
<li> <p><code>b</code>: The prior non-toxicity parameter for the beta prior.
</p>
</li>
<li> <p><code>pExcessTox</code>: The threshold for excessive toxicity.
</p>
</li></ul>

</li>
<li> <p><code>subintervals</code>: The subintervals of equal length in the mTPI-2
design. It includes the following variables:
</p>

<ul>
<li> <p><code>lower</code>: The lower bound of the subinterval.
</p>
</li>
<li> <p><code>upper</code>: The upper bound of the subinterval.
</p>
</li>
<li> <p><code>decision</code>: The dosing decision for the subinterval.
</p>
</li></ul>

</li>
<li> <p><code>decisionDataFrame</code>: The decision data frame for the mTPI-2 design.
It includes the following variables:
</p>

<ul>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>y</code>: The number of toxicities.
</p>
</li>
<li> <p><code>decision</code>: The dosing decision.
</p>
</li></ul>

</li>
<li> <p><code>decisionMatrix</code>: The decision matrix corresponding to the
decision data frame.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mTPI2Table(nMax = 18, pT = 0.3, epsilon1 = 0.05, epsilon2 = 0.05)

</code></pre>

<hr>
<h2 id='natrisk'>Number of subjects at risk</h2><span id='topic+natrisk'></span>

<h3>Description</h3>

<p>Obtains the number of subjects at risk at given analysis
times for each treatment group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>natrisk(
  time = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  minFollowupTime = NA_real_,
  maxFollowupTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="natrisk_+3A_time">time</code></td>
<td>
<p>A vector of analysis times at which to calculate the number
of patients at risk.</p>
</td></tr>
<tr><td><code id="natrisk_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="natrisk_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="natrisk_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="natrisk_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="natrisk_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event for the
active treatment group. One for each analysis time interval.</p>
</td></tr>
<tr><td><code id="natrisk_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event for the
control group. One for each analysis time interval.</p>
</td></tr>
<tr><td><code id="natrisk_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the active
treatment group.</p>
</td></tr>
<tr><td><code id="natrisk_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the control group.</p>
</td></tr>
<tr><td><code id="natrisk_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="natrisk_+3A_minfollowuptime">minFollowupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="natrisk_+3A_maxfollowuptime">maxFollowupTime</code></td>
<td>
<p>Follow-up time for the first enrolled subject.
For fixed followup, <code>maxFollowupTime = minFollowupTime</code>.
For variable followup,
<code>maxFollowupTime = accrualDuration + minFollowupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the number of patients at risk at the specified
analysis times (row) for each treatment group (column).
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.

natrisk(time = c(9, 24), allocationRatioPlanned = 1,
        accrualTime = c(0, 3), accrualIntensity = c(10, 20),
        piecewiseSurvivalTime = c(0, 6),
        lambda1 = c(0.0533, 0.0309), lambda2 = c(0.0533, 0.0533),
        gamma1 = -log(1-0.05)/12, gamma2 = -log(1-0.05)/12,
        accrualDuration = 12, minFollowupTime = 18,
        maxFollowupTime = 30)

</code></pre>

<hr>
<h2 id='nbpower'>Power for negative binomial rate ratio</h2><span id='topic+nbpower'></span>

<h3>Description</h3>

<p>Estimates the power for negative binomial rate ratio test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbpower(
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  rateRatioH0 = 1,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  kappa1 = NA_real_,
  kappa2 = NA_real_,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  spendingTime = NA_real_,
  studyDuration = NA_real_,
  nullVariance = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbpower_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock
type spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and &quot;none&quot; for no
early futility stopping. Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_rateratioh0">rateRatioH0</code></td>
<td>
<p>Rate ratio under the null hypothesis.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="nbpower_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_kappa1">kappa1</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape
parameter of the gamma mixing distribution) for the active treatment
group by stratum.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_kappa2">kappa2</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape
parameter of the gamma mixing distribution) for the control group by
stratum.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_lambda1">lambda1</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the active treatment group by stratum.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_lambda2">lambda2</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the control group by stratum.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
<tr><td><code id="nbpower_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to calculate the variance for log rate ratio
under the null hypothesis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>nbpower</code> object with 4 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The total number of events.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The total number of dropouts.
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>exposure</code>: The total exposure.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfEvents</code>: The expected number of events.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts</code>: The expected number of dropouts.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedExposure</code>: The expected exposure.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up duration.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>rateRatioH0</code>: The rate ratio under the null hypothesis.
</p>
</li>
<li> <p><code>rateRatio</code>: The rate ratio.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The number of events.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The number of dropouts.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>exposure</code>: The exposure.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacyRateRatio</code>: The efficacy boundaries on the rate
ratio scale.
</p>
</li>
<li> <p><code>futilityRateRatio</code>: The futility boundaries on the rate
ratio scale.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>typeBetaSpending</code>,
<code>parameterBetaSpending</code>, <code>allocationRatioPlanned</code>,
<code>accrualTime</code>, <code>accuralIntensity</code>,
<code>piecewiseSurvivalTime</code>, <code>kappa1</code>, <code>kappa2</code>,
<code>lambda1</code>, <code>lambda2</code>, <code>gamma1</code>, <code>gamma2</code>,
<code>spendingTime</code>, and <code>nullVariance</code>.
</p>
</li>
<li> <p><code>byTreatmentCounts</code>: A list containing the following counts by
treatment group:
</p>

<ul>
<li> <p><code>numberOfEvents1</code>: The number of events by stage for
the treatment group.
</p>
</li>
<li> <p><code>numberOfDropouts1</code>: The number of dropouts by stage for
the treatment group.
</p>
</li>
<li> <p><code>numberOfSubjects1</code>: The number of subjects by stage for
the treatment group.
</p>
</li>
<li> <p><code>exposure1</code>: The exposure by stage for the treatment group.
</p>
</li>
<li> <p><code>numberOfEvents2</code>: The number of events by stage for
the control group.
</p>
</li>
<li> <p><code>numberOfDropouts2</code>: The number of dropouts by stage for
the control group.
</p>
</li>
<li> <p><code>numberOfSubjects2</code>: The number of subjects by stage for
the control group.
</p>
</li>
<li> <p><code>exposure2</code>: The exposure by stage for the control group.
</p>
</li>
<li> <p><code>expectedNumberOfEvents1</code>: The expected number of events for
the treatment group.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts1</code>: The expected number of dropouts
for the treatment group.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects1</code>: The expected number of subjects
for the treatment group.
</p>
</li>
<li> <p><code>expectedExposure1</code>: The expected exposure for the treatment
group.
</p>
</li>
<li> <p><code>expectedNumberOfEvents2</code>: The expected number of events for
control group.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts2</code>: The expected number of dropouts
for the control group.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects2</code>: The expected number of subjects
for the control group.
</p>
</li>
<li> <p><code>expectedExposure2</code>: The expected exposure for the control
group.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nbstat">nbstat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Variable follow-up design

nbpower(kMax = 2, informationRates = c(0.5, 1),
        alpha = 0.025, typeAlphaSpending = "sfOF",
        accrualIntensity = 1956/1.25,
        stratumFraction = c(0.2, 0.8),
        kappa1 = 5, kappa2 = 5,
        lambda1 = c(0.7*0.125, 0.75*0.25),
        lambda2 = c(0.125, 0.25),
        gamma1 = 0, gamma2 = 0,
        accrualDuration = 1.25,
        followupTime = 2.75, fixedFollowup = FALSE,
        nullVariance = 1)

# Example 2: Fixed follow-up design

nbpower(kMax = 2, informationRates = c(0.5, 1),
        alpha = 0.025, typeAlphaSpending = "sfOF",
        accrualIntensity = 220/1.5,
        kappa1 = 3, kappa2 = 3,
        lambda1 = 0.5*8.4, lambda2 = 8.4,
        gamma1 = 0, gamma2 = 0,
        accrualDuration = 1.5,
        followupTime = 0.5, fixedFollowup = TRUE)

</code></pre>

<hr>
<h2 id='nbpower1s'>Power for one-sample negative binomial rate</h2><span id='topic+nbpower1s'></span>

<h3>Description</h3>

<p>Estimates the power, stopping probabilities, and expected
sample size in a one-group negative binomial design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbpower1s(
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  lambdaH0 = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  kappa = NA_real_,
  lambda = NA_real_,
  gamma = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  spendingTime = NA_real_,
  studyDuration = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbpower1s_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock
type spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and &quot;none&quot; for no
early futility stopping. Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_lambdah0">lambdaH0</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
under the null hypothesis.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_kappa">kappa</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape parameter
of the gamma mixing distribution) of the negative binomial
distribution by stratum.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_lambda">lambda</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
under the alternative hypothesis by stratum.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout or a vector of
hazard rates for piecewise exponential dropout by stratum.
Defaults to 0 for no dropout.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="nbpower1s_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>nbpower1s</code> object with 3 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The total number of events.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The total number of dropouts.
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>exposure</code>: The total exposure.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfEvents</code>: The expected number of events.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts</code>: The expected number of dropouts.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedExposure</code>: The expected exposure.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up duration.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>lambdaH0</code>: The rate parameter of the negative binomial
distribution under the null hypothesis.
</p>
</li>
<li> <p><code>lambda</code>: The overall rate parameter of the negative binomial
distribution under the alternative hypothesis.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The number of events.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The number of dropouts.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>exposure</code>: The exposure.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacyRate</code>: The efficacy boundaries on the rate scale.
</p>
</li>
<li> <p><code>futilityRate</code>: The futility boundaries on the rate scale.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>typeBetaSpending</code>,
<code>parameterBetaSpending</code>, <code>accrualTime</code>,
<code>accuralIntensity</code>, <code>piecewiseSurvivalTime</code>,
<code>stratumFraction</code>, <code>kappa</code>, <code>lambda</code>, <code>gamma</code>,
and <code>spendingTime</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nbstat">nbstat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Variable follow-up design

nbpower1s(kMax = 2, informationRates = c(0.5, 1),
          alpha = 0.025, typeAlphaSpending = "sfOF",
          lambdaH0 = 0.125, accrualIntensity = 500,
          stratumFraction = c(0.2, 0.8),
          kappa = c(3, 5), lambda = c(0.0875, 0.085),
          gamma = 0, accrualDuration = 1.25,
          followupTime = 2.75, fixedFollowup = FALSE)

# Example 2: Fixed follow-up design

nbpower1s(kMax = 2, informationRates = c(0.5, 1),
          alpha = 0.025, typeAlphaSpending = "sfOF",
          lambdaH0 = 8.4, accrualIntensity = 40,
          kappa = 3, lambda = 0.5*8.4,
          gamma = 0, accrualDuration = 1.5,
          followupTime = 0.5, fixedFollowup = TRUE)

</code></pre>

<hr>
<h2 id='nbpowerequiv'>Power for equivalence in negative binomial rate ratio</h2><span id='topic+nbpowerequiv'></span>

<h3>Description</h3>

<p>Obtains the power for equivalence in negative binomial
rate ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbpowerequiv(
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  rateRatioLower = NA_real_,
  rateRatioUpper = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  kappa1 = NA_real_,
  kappa2 = NA_real_,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  spendingTime = NA_real_,
  studyDuration = NA_real_,
  nullVariance = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbpowerequiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_rateratiolower">rateRatioLower</code></td>
<td>
<p>The lower equivalence limit of rate ratio.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_rateratioupper">rateRatioUpper</code></td>
<td>
<p>The upper equivalence limit of rate ratio.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_kappa1">kappa1</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape parameter
of the gamma mixing distribution) for the active treatment group
by stratum.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_kappa2">kappa2</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape parameter
of the gamma mixing distribution) for the control group by stratum.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_lambda1">lambda1</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the active treatment group by stratum.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_lambda2">lambda2</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the control group by stratum.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
<tr><td><code id="nbpowerequiv_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to calculate the variance for log rate ratio
under the null hypothesis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>nbpowerequiv</code> object with 4 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlphaH10</code>: The attained significance level under H10.
</p>
</li>
<li> <p><code>attainedAlphaH20</code>: The attained significance level under H20.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The total number of events.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The total number of dropouts.
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>exposure</code>: The total exposure.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfEvents</code>: The expected number of events.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts</code>: The expected number of dropouts.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedExposure</code>: The expected exposure.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>rateRatioLower</code>: The lower equivalence limit of rate ratio.
</p>
</li>
<li> <p><code>rateRatioUpper</code>: The upper equivalence limit of rate ratio.
</p>
</li>
<li> <p><code>rateRatio</code>: The rate ratio.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH10</code>: The cumulative alpha attained
under <code>H10</code>.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH20</code>: The cumulative alpha attained
under <code>H20</code>.
</p>
</li>
<li> <p><code>numberOfEvents</code>: The number of events.
</p>
</li>
<li> <p><code>numberOfDropouts</code>: The number of dropouts.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>exposure</code>: The exposure.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacyRateRatioLower</code>: The efficacy boundaries on the
rate ratio scale for the one-sided null hypothesis at the
lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyRateRatioUpper</code>: The efficacy boundaries on the
rate ratio scale for the one-sided null hypothesis at the
upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>allocationRatioPlanned</code>,
<code>accrualTime</code>, <code>accuralIntensity</code>,
<code>piecewiseSurvivalTime</code>, <code>stratumFraction</code>,
<code>kappa1</code>, <code>kappa2</code>,
<code>lambda1</code>, <code>lambda2</code>, <code>gamma1</code>, <code>gamma2</code>,
<code>accrualDuration</code>, <code>followupTime</code>, <code>fixedFollowup</code>,
<code>spendingTime</code>, <code>nullVariance</code>, and <code>varianceRatios</code>.
The <code>varianceRatios</code> is a data frame with the following
variables:
</p>

<ul>
<li> <p><code>varianceRatioH10</code>: The ratio of the variance under
<code>H10</code> to the variance under <code>H1</code>.
</p>
</li>
<li> <p><code>varianceRatioH20</code>: The ratio of the variance under
<code>H20</code> to the variance under <code>H1</code>.
</p>
</li>
<li> <p><code>varianceRatioH12</code>: The ratio of the variance under
<code>H10</code> to the variance under <code>H20</code>.
</p>
</li>
<li> <p><code>varianceRatioH21</code>: The ratio of the variance under
<code>H20</code> to the variance under <code>H10</code>.
</p>
</li></ul>

</li>
<li> <p><code>byTreatmentCounts</code>: A list containing the following counts by
treatment group:
</p>

<ul>
<li> <p><code>numberOfEvents1</code>: The number of events by stage for
the treatment group.
</p>
</li>
<li> <p><code>numberOfDropouts1</code>: The number of dropouts by stage for
the treatment group.
</p>
</li>
<li> <p><code>numberOfSubjects1</code>: The number of subjects by stage for
the treatment group.
</p>
</li>
<li> <p><code>exposure1</code>: The exposure by stage for the treatment group.
</p>
</li>
<li> <p><code>numberOfEvents2</code>: The number of events by stage for
the control group.
</p>
</li>
<li> <p><code>numberOfDropouts2</code>: The number of dropouts by stage for
the control group.
</p>
</li>
<li> <p><code>numberOfSubjects2</code>: The number of subjects by stage for
the control group.
</p>
</li>
<li> <p><code>exposure2</code>: The exposure by stage for the control group.
</p>
</li>
<li> <p><code>expectedNumberOfEvents1</code>: The expected number of events for
the treatment group.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts1</code>: The expected number of dropouts
for the treatment group.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects1</code>: The expected number of subjects
for the treatment group.
</p>
</li>
<li> <p><code>expectedExposure1</code>: The expected exposure for the treatment
group.
</p>
</li>
<li> <p><code>expectedNumberOfEvents2</code>: The expected number of events for
control group.
</p>
</li>
<li> <p><code>expectedNumberOfDropouts2</code>: The expected number of dropouts
for the control group.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects2</code>: The expected number of subjects
for the control group.
</p>
</li>
<li> <p><code>expectedExposure2</code>: The expected exposure for the control
group.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nbstat">nbstat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: Variable follow-up design
nbpowerequiv(kMax = 2, informationRates = c(0.5, 1),
             alpha = 0.05, typeAlphaSpending = "sfOF",
             rateRatioLower = 2/3, rateRatioUpper = 3/2,
             accrualIntensity = 1956/1.25,
             kappa1 = 5, kappa2 = 5,
             lambda1 = 0.125, lambda2 = 0.125,
             gamma1 = 0, gamma2 = 0,
             accrualDuration = 1.25,
             followupTime = 2.75, fixedFollowup = FALSE,
             nullVariance = 1)

# Example 2: Fixed follow-up design
nbpowerequiv(kMax = 2, informationRates = c(0.5, 1),
             alpha = 0.05, typeAlphaSpending = "sfOF",
             rateRatioLower = 0.5, rateRatioUpper = 2,
             accrualIntensity = 220/1.5,
             stratumFraction = c(0.2, 0.8),
             kappa1 = 3, kappa2 = 3,
             lambda1 = c(8.4, 10.2),
             lambda2 = c(8.0, 11.5),
             gamma1 = 0, gamma2 = 0,
             accrualDuration = 1.5,
             followupTime = 0.5, fixedFollowup = TRUE)

</code></pre>

<hr>
<h2 id='nbsamplesize'>Sample size for negative binomial rate ratio</h2><span id='topic+nbsamplesize'></span>

<h3>Description</h3>

<p>Obtains the needed accrual duration given power and
follow-up time, the needed follow-up time given power and
accrual duration, or the needed absolute accrual rates given
power, accrual duration, follow-up duration, and relative accrual
rates in a two-group negative binomial design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbsamplesize(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  rateRatioH0 = 1,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  kappa1 = NA_real_,
  kappa2 = NA_real_,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L,
  nullVariance = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbsamplesize_+3A_beta">beta</code></td>
<td>
<p>Type II error. Defaults to 0.2.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_rateratioh0">rateRatioH0</code></td>
<td>
<p>Rate ratio under the null hypothesis.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_kappa1">kappa1</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape
parameter of the gamma mixing distribution) for the active treatment
group by stratum.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_kappa2">kappa2</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape
parameter of the gamma mixing distribution) for the control group by
stratum.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_lambda1">lambda1</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the active treatment group by stratum.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_lambda2">lambda2</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the control group by stratum.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupDuration, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size.
Defaults to 1 for sample size rounding.</p>
</td></tr>
<tr><td><code id="nbsamplesize_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to calculate the variance for log rate ratio
under the null hypothesis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two components:
</p>

<ul>
<li> <p><code>resultsUnderH1</code>: An S3 class <code>nbpower</code> object under the
alternative hypothesis.
</p>
</li>
<li> <p><code>resultsUnderH0</code>: An S3 class <code>nbpower</code> object under the
null hypothesis.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nbpower">nbpower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Obtains follow-up duration given power, accrual intensity,
# and accrual duration for variable follow-up

nbsamplesize(beta = 0.2, kMax = 2,
             informationRates = c(0.5, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             accrualIntensity = 1956/1.25,
             kappa1 = 5, kappa2 = 5,
             lambda1 = 0.0875, lambda2 = 0.125,
             gamma1 = 0, gamma2 = 0,
             accrualDuration = 1.25,
             followupTime = NA, fixedFollowup = FALSE)

# Example 2: Obtains accrual intensity given power, accrual duration, and
# follow-up duration for variable follow-up

nbsamplesize(beta = 0.2, kMax = 2,
             informationRates = c(0.5, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             accrualIntensity = 100,
             kappa1 = 5, kappa2 = 5,
             lambda1 = 0.0875, lambda2 = 0.125,
             gamma1 = 0, gamma2 = 0,
             accrualDuration = 1.25,
             followupTime = 2.25, fixedFollowup = FALSE)


# Example 3: Obtains accrual duration given power, accrual intensity, and
# follow-up duration for fixed follow-up

nbsamplesize(beta = 0.2, kMax = 2,
             informationRates = c(0.5, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             accrualIntensity = 1667,
             stratumFraction = c(0.2, 0.8),
             kappa1 = 5, kappa2 = 5,
             lambda1 = c(0.7*0.125, 0.75*0.25),
             lambda2 = c(0.125, 0.25),
             gamma1 = 0, gamma2 = 0,
             accrualDuration = NA,
             followupTime = 0.5, fixedFollowup = TRUE)

</code></pre>

<hr>
<h2 id='nbsamplesize1s'>Sample size for one-sample negative binomial rate</h2><span id='topic+nbsamplesize1s'></span>

<h3>Description</h3>

<p>Obtains the needed accrual duration given power and
follow-up time, the needed follow-up time given power and
accrual duration, or the needed absolute accrual rates given
power, accrual duration, follow-up duration, and relative accrual
rates in a one-group negative binomial design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbsamplesize1s(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  lambdaH0 = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  kappa = NA_real_,
  lambda = NA_real_,
  gamma = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbsamplesize1s_+3A_beta">beta</code></td>
<td>
<p>Type II error. Defaults to 0.2.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_lambdah0">lambdaH0</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
under the null hypothesis.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_kappa">kappa</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape parameter
of the gamma mixing distribution) of the negative binomial
distribution by stratum.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_lambda">lambda</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
under the alternative hypothesis by stratum.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout or a vector of
hazard rates for piecewise exponential dropout by stratum.
Defaults to 0 for no dropout.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupDuration, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="nbsamplesize1s_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size.
Defaults to 1 for sample size rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two components:
</p>

<ul>
<li> <p><code>resultsUnderH1</code>: An S3 class <code>nbpower1s</code> object under the
alternative hypothesis.
</p>
</li>
<li> <p><code>resultsUnderH0</code>: An S3 class <code>nbpower1s</code> object under the
null hypothesis.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nbpower1s">nbpower1s</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Obtains follow-up duration given power, accrual intensity,
# and accrual duration for variable follow-up

nbsamplesize1s(beta = 0.2, kMax = 2,
               informationRates = c(0.5, 1),
               alpha = 0.025, typeAlphaSpending = "sfOF",
               lambdaH0 = 0.125, accrualIntensity = 500,
               stratumFraction = c(0.2, 0.8),
               kappa = c(3, 5), lambda = c(0.0875, 0.085),
               gamma = 0, accrualDuration = 1.25,
               followupTime = NA, fixedFollowup = FALSE)

# Example 2: Obtains accrual intensity given power, accrual duration, and
# follow-up duration for variable follow-up

nbsamplesize1s(beta = 0.2, kMax = 2,
               informationRates = c(0.5, 1),
               alpha = 0.025, typeAlphaSpending = "sfOF",
               lambdaH0 = 0.125, accrualIntensity = 100,
               kappa = 5, lambda = 0.0875,
               gamma = 0, accrualDuration = 1.25,
               followupTime = 2.25, fixedFollowup = FALSE)


# Example 3: Obtains accrual duration given power, accrual intensity, and
# follow-up duration for fixed follow-up

nbsamplesize1s(beta = 0.2, kMax = 2,
               informationRates = c(0.5, 1),
               alpha = 0.025, typeAlphaSpending = "sfOF",
               lambdaH0 = 8.4, accrualIntensity = 40,
               kappa = 3, lambda = 4.2,
               gamma = 0, accrualDuration = NA,
               followupTime = 0.5, fixedFollowup = TRUE)

</code></pre>

<hr>
<h2 id='nbsamplesizeequiv'>Sample size for equivalence in negative binomial rate ratio</h2><span id='topic+nbsamplesizeequiv'></span>

<h3>Description</h3>

<p>Obtains the sample size for equivalence in negative binomial
rate ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbsamplesizeequiv(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  rateRatioLower = NA_real_,
  rateRatioUpper = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  kappa1 = NA_real_,
  kappa2 = NA_real_,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L,
  nullVariance = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbsamplesizeequiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_rateratiolower">rateRatioLower</code></td>
<td>
<p>The lower equivalence limit of rate ratio.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_rateratioupper">rateRatioUpper</code></td>
<td>
<p>The upper equivalence limit of rate ratio.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_kappa1">kappa1</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape parameter
of the gamma mixing distribution) for the active treatment group by
stratum.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_kappa2">kappa2</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape parameter
of the gamma mixing distribution) for the control group by stratum.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_lambda1">lambda1</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the active treatment group by stratum.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_lambda2">lambda2</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the control group by stratum.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupDuration, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size.
Defaults to 1 for sample size rounding.</p>
</td></tr>
<tr><td><code id="nbsamplesizeequiv_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to calculate the variance for log rate ratio
under the null hypothesis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>nbpowerequiv</code> object
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nbpowerequiv">nbpowerequiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: Variable follow-up design and solve for follow-up time
nbsamplesizeequiv(beta = 0.1, kMax = 2, informationRates = c(0.5, 1),
                  alpha = 0.05, typeAlphaSpending = "sfOF",
                  rateRatioLower = 2/3, rateRatioUpper = 3/2,
                  accrualIntensity = 1956/1.25,
                  stratumFraction = c(0.2, 0.8),
                  kappa1 = c(3, 5),
                  kappa2 = c(2, 3),
                  lambda1 = c(0.125, 0.165),
                  lambda2 = c(0.135, 0.175),
                  gamma1 = -log(1-0.05),
                  gamma2 = -log(1-0.10),
                  accrualDuration = 1.25,
                  followupTime = NA, fixedFollowup = FALSE,
                  nullVariance = 1)

# Example 2: Fixed follow-up design and solve for accrual duration
nbsamplesizeequiv(beta = 0.2, kMax = 2, informationRates = c(0.5, 1),
                  alpha = 0.05, typeAlphaSpending = "sfOF",
                  rateRatioLower = 0.5, rateRatioUpper = 2,
                  accrualIntensity = 220/1.5,
                  kappa1 = 3, kappa2 = 3,
                  lambda1 = 8.4, lambda2 = 8.4,
                  gamma1 = 0, gamma2 = 0,
                  accrualDuration = NA,
                  followupTime = 0.5, fixedFollowup = TRUE)

</code></pre>

<hr>
<h2 id='nbstat'>Negative binomial rate ratio</h2><span id='topic+nbstat'></span>

<h3>Description</h3>

<p>Obtains the number of subjects accrued, number of events,
number of dropouts, number of subjects reaching the maximum
follow-up, total exposure, and variance for log rate in each group,
rate ratio, variance, and Wald test statistic of
log rate ratio at given calendar times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbstat(
  time = NA_real_,
  rateRatioH0 = 1,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  kappa1 = NA_real_,
  kappa2 = NA_real_,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  nullVariance = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbstat_+3A_time">time</code></td>
<td>
<p>A vector of calendar times for data cut.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_rateratioh0">rateRatioH0</code></td>
<td>
<p>Rate ratio under the null hypothesis.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="nbstat_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_kappa1">kappa1</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape
parameter of the gamma mixing distribution) for the active treatment
group by stratum.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_kappa2">kappa2</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape
parameter of the gamma mixing distribution) for the control group by
stratum.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_lambda1">lambda1</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the active treatment group by stratum.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_lambda2">lambda2</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the control group by stratum.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="nbstat_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to calculate the variance for log rate ratio
under the null hypothesis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability mass function for a negative binomial distribution with
dispersion parameter <code class="reqn">\kappa_i</code> and rate parameter <code class="reqn">\lambda_i</code>
is given by
</p>
<p style="text-align: center;"><code class="reqn">P(Y_{ij} = y) = \frac{\Gamma(y+1/\kappa_i)}{\Gamma(1/\kappa_i) y!}
\left(\frac{1}{1 + \kappa_i \lambda_i t_{ij}}\right)^{1/\kappa_i}
\left(\frac{\kappa_i \lambda_i t_{ij}}
{1 + \kappa_i \lambda_i t_{ij}}\right)^{y},</code>
</p>

<p>where <code class="reqn">Y_{ij}</code> is the event count for subject <code class="reqn">j</code> in
treatment group <code class="reqn">i</code>, and <code class="reqn">t_{ij}</code> is the exposure time for
the subject. If <code class="reqn">\kappa_i=0</code>, the negative binomial distribution
reduces to the Poisson distribution.
</p>
<p>For treatment group <code class="reqn">i</code>, let <code class="reqn">\beta_i = \log(\lambda_i)</code>.
The likelihood for <code class="reqn">\{(\kappa_i, \beta_i):i=1,2\}</code> can be written as
</p>
<p style="text-align: center;"><code class="reqn">l = \sum_{i=1}^{2}\sum_{j=1}^{n_{i}}
\{\log \Gamma(y_{ij} + 1/\kappa_i) - \log \Gamma(1/\kappa_i) + y_{ij}
(\log(\kappa_i) + \beta_i) - (y_{ij} + 1/\kappa_i)
\log(1+ \kappa_i \exp(\beta_i) t_{ij})\}.</code>
</p>

<p>It follows that
</p>
<p style="text-align: center;"><code class="reqn">\frac{\partial l}{\partial \beta_i} = \sum_{j=1}^{n_i}
\left\{y_{ij} - (y_{ij} + 1/\kappa_i)
\frac{\kappa_i \exp(\beta_i) t_{ij}}
{1 + \kappa_i \exp(\beta_i)t_{ij}}\right\},</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">-\frac{\partial^2 l}{\partial \beta_i^2} =
\sum_{j=1}^{n_i} (y_{ij} + 1/\kappa_i) \frac{\kappa_i \lambda_i t_{ij}}
{(1 + \kappa_i \lambda_i t_{ij})^2}.</code>
</p>

<p>The Fisher information for <code class="reqn">\beta_i</code> is
</p>
<p style="text-align: center;"><code class="reqn">E\left(-\frac{\partial^2 l}{\partial \beta_i^2}\right)
= n_i E\left(\frac{\lambda_i t_{ij}}
{1 + \kappa_i \lambda_i t_{ij}}\right).</code>
</p>

<p>In addition, we can show that
</p>
<p style="text-align: center;"><code class="reqn">E\left(-\frac{\partial^2 l}
{\partial \beta_i \partial \kappa_i}\right) = 0.</code>
</p>

<p>Therefore, the variance of <code class="reqn">\hat{\beta}_i</code> is
</p>
<p style="text-align: center;"><code class="reqn">Var(\hat{\beta}_i) = \frac{1}{n_i} \left\{
E\left(\frac{\lambda_i t_{ij}}{1 + \kappa_i \lambda_i t_{ij}}\right)
\right\}^{-1}.</code>
</p>

<p>To evaluate the integral, we need to obtain the distribution of the
exposure time,
</p>
<p style="text-align: center;"><code class="reqn">t_{ij} = \min(\tau - W_{ij}, C_{ij}, T_{fmax}),</code>
</p>

<p>where <code class="reqn">\tau</code> denotes the calendar time since trial start,
<code class="reqn">W_{ij}</code> denotes the enrollment time for subject <code class="reqn">j</code>
in treatment group <code class="reqn">i</code>, <code class="reqn">C_{ij}</code> denotes the time to dropout
after enrollment for subject <code class="reqn">j</code> in treatment group <code class="reqn">i</code>, and
<code class="reqn">T_{fmax}</code> denotes the maximum follow-up time for
all subjects. Therefore,
</p>
<p style="text-align: center;"><code class="reqn">P(t_{ij} \geq t) = P(W_{ij} \leq \tau - t)P(C_{ij} \geq t)
I(t\leq T_{fmax}).</code>
</p>

<p>Let <code class="reqn">H</code> denote the distribution function of the enrollment time,
and <code class="reqn">G_i</code> denote the survival function of the dropout time for
treatment group <code class="reqn">i</code>. By the change of variables, we have
</p>
<p style="text-align: center;"><code class="reqn">E\left(\frac{\lambda_i t_{ij}}{1 + \kappa_i \lambda_i t_{ij}}
\right) = \int_{0}^{\tau \wedge T_{fmax}}
\frac{\lambda_i}{(1 + \kappa_i \lambda_i t)^2} H(\tau - t) G_i(t) dt.</code>
</p>

<p>A numerical integration algorithm for a univariate function can be
used to evaluate the above integral.
</p>
<p>For the restricted maximum likelihood (reml) estimate of
<code class="reqn">(\beta_1,\beta_2)</code> subject to the
constraint that <code class="reqn">\beta_1 - \beta_2 = \Delta</code>, we express the
log-likelihood in terms of <code class="reqn">(\beta_2,\Delta,\kappa_1,\kappa_2)</code>,
and takes the derivative of the log-likelihood function with respect
to <code class="reqn">\beta_2</code>. The resulting score equation has asymptotic limit
</p>
<p style="text-align: center;"><code class="reqn">E\left(\frac{\partial l}{\partial \beta_2}\right) = s_1 + s_2,</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">s_1 = n r E\left\{\lambda1_1 t_{1j} - \left(\lambda_1t_{1j}
+ \frac{1}{\kappa_1}\right) \frac{\kappa_1 e^{\tilde{\beta}_2 +
\Delta}t_{1j}}{1 + \kappa_1 e^{\tilde{\beta}_2 +\Delta}t_{1j}}\right\},</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">s_2 = n (1-r) E\left\{\lambda_2 t_{2j} -
\left(\lambda_2 t_{2j} + \frac{1}{\kappa_2}\right)
\frac{\kappa_2 e^{\tilde{\beta}_2} t_{2j}}
{1 + \kappa_2 e^{\tilde{\beta}_2}t_{2j}}\right\}.</code>
</p>

<p>Here <code class="reqn">r</code> is the randomization probability for the active
treatment group. The asymptotic limit of the reml of <code class="reqn">\beta_2</code>
is the solution <code class="reqn">\tilde{\beta}_2</code> to
<code class="reqn">E\left(\frac{\partial l}{\partial \beta_2}\right) = 0.</code>
</p>


<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li> <p><code>resultsUnderH1</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>time</code>: The analysis time since trial start.
</p>
</li>
<li> <p><code>subjects</code>: The number of enrolled subjects.
</p>
</li>
<li> <p><code>nevents</code>: The total number of events.
</p>
</li>
<li> <p><code>nevents1</code>: The number of events in the active treatment
group.
</p>
</li>
<li> <p><code>nevents2</code>: The number of events in the control group.
</p>
</li>
<li> <p><code>ndropouts</code>: The total number of dropouts.
</p>
</li>
<li> <p><code>ndropouts1</code>: The number of dropouts in the active treatment
group.
</p>
</li>
<li> <p><code>ndropouts2</code>: The number of dropouts in the control group.
</p>
</li>
<li> <p><code>nfmax</code>: The total number of subjects reaching maximum
follow-up.
</p>
</li>
<li> <p><code>nfmax1</code>: The number of subjects reaching maximum follow-up
in the active treatment group.
</p>
</li>
<li> <p><code>nfmax2</code>: The number of subjects reaching maximum follow-up
in the control group.
</p>
</li>
<li> <p><code>exposure</code>: The total exposure time.
</p>
</li>
<li> <p><code>exposure1</code>: The exposure time for the active treatment group.
</p>
</li>
<li> <p><code>exposure2</code>: The exposure time for the control group.
</p>
</li>
<li> <p><code>rateRatio</code>: The rate ratio of the active treatment group
versus the control group.
</p>
</li>
<li> <p><code>vlogRate1</code>: The variance for the log rate
parameter for the active treatment group.
</p>
</li>
<li> <p><code>vlogRate2</code>: The variance for the log rate
parameter for the control group.
</p>
</li>
<li> <p><code>vlogRR</code>: The variance of log rate ratio.
</p>
</li>
<li> <p><code>information</code>: The information of log rate ratio.
</p>
</li>
<li> <p><code>zlogRR</code>: The Z-statistic for log rate ratio.
</p>
</li></ul>

</li>
<li> <p><code>resultsUnderH0</code> when <code>nullVariance = TRUE</code>: A data frame
with the following variables:
</p>

<ul>
<li> <p><code>time</code>: The analysis time since trial start.
</p>
</li>
<li> <p><code>lambda1H0</code>: The restricted maximum likelihood estimate
of the event rate for the active treatment group.
</p>
</li>
<li> <p><code>lambda2H0</code>: The restricted maximum likelihood estimate
of the event rate for the control group.
</p>
</li>
<li> <p><code>rateRatioH0</code>: The rate ratio under H0.
</p>
</li>
<li> <p><code>vlogRate1H0</code>: The variance for the log rate
parameter for the active treatment group under H0.
</p>
</li>
<li> <p><code>vlogRate2H0</code>: The variance for the log rate
parameter for the control group under H0.
</p>
</li>
<li> <p><code>vlogRRH0</code>: The variance of log rate ratio under H0.
</p>
</li>
<li> <p><code>informationH0</code>: The information of log rate ratio under H0.
</p>
</li>
<li> <p><code>zlogRRH0</code>: The Z-statistic for log rate ratio with variance
evaluated under H0.
</p>
</li>
<li> <p><code>varianceRatio</code>: The ratio of the variance under H0 versus
the variance under H1.
</p>
</li>
<li> <p><code>lambda1</code>: The true event rate for the active treatment group.
</p>
</li>
<li> <p><code>lambda2</code>: The true event rate for the control group.
</p>
</li>
<li> <p><code>rateRatio</code>: The true rate ratio.
</p>
</li></ul>

</li>
<li> <p><code>resultsUnderH0</code> when <code>nullVariance = FALSE</code>: A data frame
with the following variables:
</p>

<ul>
<li> <p><code>time</code>: The analysis time since trial start.
</p>
</li>
<li> <p><code>rateRatioH0</code>: The rate ratio under H0.
</p>
</li>
<li> <p><code>varianceRatio</code>: Equal to 1.
</p>
</li>
<li> <p><code>lambda1</code>: The true event rate for the active treatment group.
</p>
</li>
<li> <p><code>lambda2</code>: The true event rate for the control group.
</p>
</li>
<li> <p><code>rateRatio</code>: The true rate ratio.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Variable follow-up design

nbstat(time = c(1, 1.25, 2, 3, 4),
       accrualIntensity = 1956/1.25,
       kappa1 = 5,
       kappa2 = 5,
       lambda1 = 0.7*0.125,
       lambda2 = 0.125,
       gamma1 = 0,
       gamma2 = 0,
       accrualDuration = 1.25,
       followupTime = 2.75)

# Example 2: Fixed follow-up design

nbstat(time = c(0.5, 1, 1.5, 2),
       accrualIntensity = 220/1.5,
       stratumFraction = c(0.2, 0.8),
       kappa1 = 3,
       kappa2 = 3,
       lambda1 = c(0.5*8.4, 0.6*10.5),
       lambda2 = c(8.4, 10.5),
       gamma1 = 0,
       gamma2 = 0,
       accrualDuration = 1.5,
       followupTime = 0.5,
       fixedFollowup = 1,
       nullVariance = 1)

</code></pre>

<hr>
<h2 id='nbstat1'>Negative binomial rate ratio by stratum</h2><span id='topic+nbstat1'></span>

<h3>Description</h3>

<p>Obtains the number of subjects accrued, number of events,
number of dropouts, number of subjects reaching the maximum
follow-up, total exposure, rate and variance for log rate in each group,
rate ratio and variance for log rate ratio by stratum at a given
calendar time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbstat1(
  time = NA_real_,
  rateRatioH0 = 1,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  kappa1 = NA_real_,
  kappa2 = NA_real_,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  nullVariance = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbstat1_+3A_time">time</code></td>
<td>
<p>The calendar time for data cut.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_rateratioh0">rateRatioH0</code></td>
<td>
<p>Rate ratio under the null hypothesis.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_kappa1">kappa1</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape
parameter of the gamma mixing distribution) for the active treatment
group by stratum.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_kappa2">kappa2</code></td>
<td>
<p>The dispersion parameter (reciprocal of the shape
parameter of the gamma mixing distribution) for the control group by
stratum.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_lambda1">lambda1</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the active treatment group by stratum.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_lambda2">lambda2</code></td>
<td>
<p>The rate parameter of the negative binomial distribution
for the control group by stratum.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="nbstat1_+3A_nullvariance">nullVariance</code></td>
<td>
<p>Whether to calculate the variance for log rate ratio
under the null hypothesis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components:
</p>

<ul>
<li> <p><code>resultsUnderH1</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The calendar time since trial start.
</p>
</li>
<li> <p><code>subjects</code>: The number of enrolled subjects.
</p>
</li>
<li> <p><code>nevents</code>: The total number of events.
</p>
</li>
<li> <p><code>nevents1</code>: The number of events in the active treatment
group.
</p>
</li>
<li> <p><code>nevents2</code>: The number of events in the control group.
</p>
</li>
<li> <p><code>ndropouts</code>: The total number of dropouts.
</p>
</li>
<li> <p><code>ndropouts1</code>: The number of dropouts in the active treatment
group.
</p>
</li>
<li> <p><code>ndropouts2</code>: The number of dropouts in the control group.
</p>
</li>
<li> <p><code>nfmax</code>: The total number of subjects reaching maximum
follow-up.
</p>
</li>
<li> <p><code>nfmax1</code>: The number of subjects reaching maximum follow-up
in the active treatment group.
</p>
</li>
<li> <p><code>nfmax2</code>: The number of subjects reaching maximum follow-up
in the control group.
</p>
</li>
<li> <p><code>exposure</code>: The total exposure time.
</p>
</li>
<li> <p><code>exposure1</code>: The exposure time for the active treatment group.
</p>
</li>
<li> <p><code>exposure2</code>: The exposure time for the control group.
</p>
</li>
<li> <p><code>rateRatio</code>: The rate ratio of the active treatment group
versus the control group.
</p>
</li>
<li> <p><code>vlogRate1</code>: The variance for the log rate parameter for the
active treatment group.
</p>
</li>
<li> <p><code>vlogRate2</code>: The variance for the log rate parameter for the
control group.
</p>
</li>
<li> <p><code>vlogRR</code>: The variance of log rate ratio.
</p>
</li></ul>

</li>
<li> <p><code>resultsUnderH0</code> when <code>nullVariance = TRUE</code>: A data frame
with the following variables:
</p>

<ul>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The analysis time since trial start.
</p>
</li>
<li> <p><code>lambda1H0</code>: The restricted maximum likelihood estimate
of the event rate for the active treatment group.
</p>
</li>
<li> <p><code>lambda2H0</code>: The restricted maximum likelihood estimate
of the event rate for the control group.
</p>
</li>
<li> <p><code>rateRatioH0</code>: The rate ratio under H0.
</p>
</li>
<li> <p><code>vlogRate1H0</code>: The variance for the log rate parameter for
the active treatment group under H0.
</p>
</li>
<li> <p><code>vlogRate2H0</code>: The variance for the log rate parameter for
the control group under H0.
</p>
</li>
<li> <p><code>vlogRRH0</code>: The variance of log rate ratio under H0.
</p>
</li>
<li> <p><code>lambda1</code>: The true event rate for the active treatment group.
</p>
</li>
<li> <p><code>lambda2</code>: The true event rate for the control group.
</p>
</li>
<li> <p><code>rateRatio</code>: The true rate ratio.
</p>
</li></ul>

</li>
<li> <p><code>resultsUnderH0</code> when <code>nullVariance = FALSE</code>: A data frame
with the following variables:
</p>

<ul>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The analysis time since trial start.
</p>
</li>
<li> <p><code>rateRatioH0</code>: The rate ratio under H0.
</p>
</li>
<li> <p><code>lambda1</code>: The true event rate for the active treatment group.
</p>
</li>
<li> <p><code>lambda2</code>: The true event rate for the control group.
</p>
</li>
<li> <p><code>rateRatio</code>: The true rate ratio.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Variable follow-up design

nbstat1(time = 2,
       accrualIntensity = 1956/1.25,
       kappa1 = 5,
       kappa2 = 5,
       lambda1 = 0.7*0.125,
       lambda2 = 0.125,
       gamma1 = 0,
       gamma2 = 0,
       accrualDuration = 1.25,
       followupTime = 2.75)

# Example 2: Fixed follow-up design

nbstat1(time = 1.8,
       accrualIntensity = 220/1.5,
       stratumFraction = c(0.2, 0.8),
       kappa1 = 3,
       kappa2 = 3,
       lambda1 = c(0.5*8.4, 0.7*10.2),
       lambda2 = c(8.4, 10.2),
       gamma1 = 0.05,
       gamma2 = 0.05,
       accrualDuration = 1.5,
       followupTime = 0.5,
       fixedFollowup = 1,
       nullVariance = 1)

</code></pre>

<hr>
<h2 id='nevent'>Number of subjects having an event</h2><span id='topic+nevent'></span>

<h3>Description</h3>

<p>Obtains the number of subjects having an event by given
analysis times for each treatment group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nevent(
  time = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  minFollowupTime = NA_real_,
  maxFollowupTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nevent_+3A_time">time</code></td>
<td>
<p>A vector of analysis times at which to calculate the number
of patients having an event.</p>
</td></tr>
<tr><td><code id="nevent_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="nevent_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="nevent_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="nevent_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="nevent_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event for the
active treatment group. One for each analysis time interval.</p>
</td></tr>
<tr><td><code id="nevent_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event for the
control group. One for each analysis time interval.</p>
</td></tr>
<tr><td><code id="nevent_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the active
treatment group.</p>
</td></tr>
<tr><td><code id="nevent_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the control group.</p>
</td></tr>
<tr><td><code id="nevent_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="nevent_+3A_minfollowuptime">minFollowupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="nevent_+3A_maxfollowuptime">maxFollowupTime</code></td>
<td>
<p>Follow-up time for the first enrolled subject.
For fixed followup, <code>maxFollowupTime = minFollowupTime</code>.
For variable followup,
<code>maxFollowupTime = accrualDuration + minFollowupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the number of patients having an event at the
specified analysis times (row) for each treatment group (column).
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.

nevent(time = c(9, 24), allocationRatioPlanned = 1,
       accrualTime = c(0, 3), accrualIntensity = c(10, 20),
       piecewiseSurvivalTime = c(0, 6),
       lambda1 = c(0.0533, 0.0309), lambda2 = c(0.0533, 0.0533),
       gamma1 = -log(1-0.05)/12, gamma2 = -log(1-0.05)/12,
       accrualDuration = 12, minFollowupTime = 18,
       maxFollowupTime = 30)

</code></pre>

<hr>
<h2 id='nevent2'>Number of subjects having an event by calendar time</h2><span id='topic+nevent2'></span>

<h3>Description</h3>

<p>Obtains the number of subjects having an event by given
calendar times for each treatment group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nevent2(
  time = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  minFollowupTime = NA_real_,
  maxFollowupTime = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nevent2_+3A_time">time</code></td>
<td>
<p>A vector of calendar times at which to calculate the number
of patients having an event.</p>
</td></tr>
<tr><td><code id="nevent2_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="nevent2_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="nevent2_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="nevent2_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="nevent2_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event for the
active treatment group. One for each analysis time interval.</p>
</td></tr>
<tr><td><code id="nevent2_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event for the
control group. One for each analysis time interval.</p>
</td></tr>
<tr><td><code id="nevent2_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the active
treatment group.</p>
</td></tr>
<tr><td><code id="nevent2_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the control group.</p>
</td></tr>
<tr><td><code id="nevent2_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="nevent2_+3A_minfollowuptime">minFollowupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="nevent2_+3A_maxfollowuptime">maxFollowupTime</code></td>
<td>
<p>Follow-up time for the first enrolled subject.
For fixed followup, <code>maxFollowupTime = minFollowupTime</code>.
For variable followup,
<code>maxFollowupTime = accrualDuration + minFollowupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the number of patients having an event at the
specified calendar times (row) for each treatment group (column).
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.
nevent2(time = c(9, 24), allocationRatioPlanned = 1,
        accrualTime = c(0, 3), accrualIntensity = c(10, 20),
        piecewiseSurvivalTime = c(0, 6),
        lambda1 = c(0.0533, 0.0309), lambda2 = c(0.0533, 0.0533),
        gamma1 = -log(1-0.05)/12, gamma2 = -log(1-0.05)/12,
        accrualDuration = 12, minFollowupTime = 18,
        maxFollowupTime = 30)

</code></pre>

<hr>
<h2 id='param_accrualDuration'>Parameter Description: accrualDuration</h2><span id='topic+param_accrualDuration'></span>

<h3>Description</h3>

<p>Parameter Description: accrualDuration
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_accrualDuration_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
</table>

<hr>
<h2 id='param_accrualIntensity'>Parameter Description: accrualIntensity</h2><span id='topic+param_accrualIntensity'></span>

<h3>Description</h3>

<p>Parameter Description: accrualIntensity
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_accrualIntensity_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
</table>

<hr>
<h2 id='param_accrualTime'>Parameter Description: accrualTime</h2><span id='topic+param_accrualTime'></span>

<h3>Description</h3>

<p>Parameter Description: accrualTime
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_accrualTime_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
</table>

<hr>
<h2 id='param_allocationRatioPlanned'>Parameter Description: allocationRatioPlanned</h2><span id='topic+param_allocationRatioPlanned'></span>

<h3>Description</h3>

<p>Parameter Description: allocationRatioPlanned
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_allocationRatioPlanned_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
</table>

<hr>
<h2 id='param_alpha'>Parameter Description: alpha</h2><span id='topic+param_alpha'></span>

<h3>Description</h3>

<p>Parameter Description: alpha
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_alpha_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
</table>

<hr>
<h2 id='param_criticalValues'>Parameter Description: criticalValues</h2><span id='topic+param_criticalValues'></span>

<h3>Description</h3>

<p>Parameter Description: criticalValues
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_criticalValues_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
</table>

<hr>
<h2 id='param_efficacyStopping'>Parameter Description: efficacyStopping</h2><span id='topic+param_efficacyStopping'></span>

<h3>Description</h3>

<p>Parameter Description: efficacyStopping
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_efficacyStopping_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
</table>

<hr>
<h2 id='param_estimateHazardRatio'>Parameter Description: estimateHazardRatio</h2><span id='topic+param_estimateHazardRatio'></span>

<h3>Description</h3>

<p>Parameter Description: estimateHazardRatio
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_estimateHazardRatio_+3A_estimatehazardratio">estimateHazardRatio</code></td>
<td>
<p>Whether to estimate the hazard ratio from
weighted Cox regression model and report the stopping boundaries on
the hazard ratio scale.</p>
</td></tr>
</table>

<hr>
<h2 id='param_fixedFollowup'>Parameter Description: fixedFollowup</h2><span id='topic+param_fixedFollowup'></span>

<h3>Description</h3>

<p>Parameter Description: fixedFollowup
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_fixedFollowup_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
</table>

<hr>
<h2 id='param_followupTime'>Parameter Description: followupTime</h2><span id='topic+param_followupTime'></span>

<h3>Description</h3>

<p>Parameter Description: followupTime
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_followupTime_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
</table>

<hr>
<h2 id='param_futilityBounds'>Parameter Description: futilityBounds</h2><span id='topic+param_futilityBounds'></span>

<h3>Description</h3>

<p>Parameter Description: futilityBounds
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_futilityBounds_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
</table>

<hr>
<h2 id='param_futilityStopping'>Parameter Description: futilityStopping</h2><span id='topic+param_futilityStopping'></span>

<h3>Description</h3>

<p>Parameter Description: futilityStopping
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_futilityStopping_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
</table>

<hr>
<h2 id='param_gamma'>Parameter Description: gamma</h2><span id='topic+param_gamma'></span>

<h3>Description</h3>

<p>Parameter Description: gamma
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_gamma_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout.</p>
</td></tr>
</table>

<hr>
<h2 id='param_gamma1'>Parameter Description: gamma1</h2><span id='topic+param_gamma1'></span>

<h3>Description</h3>

<p>Parameter Description: gamma1
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_gamma1_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the active
treatment group.</p>
</td></tr>
</table>

<hr>
<h2 id='param_gamma1_stratified'>Parameter Description: gamma1_stratified</h2><span id='topic+param_gamma1_stratified'></span>

<h3>Description</h3>

<p>Parameter Description: gamma1_stratified
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_gamma1_stratified_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
</table>

<hr>
<h2 id='param_gamma2'>Parameter Description: gamma2</h2><span id='topic+param_gamma2'></span>

<h3>Description</h3>

<p>Parameter Description: gamma2
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_gamma2_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout for the control group.</p>
</td></tr>
</table>

<hr>
<h2 id='param_gamma2_stratified'>Parameter Description: gamma2_stratified</h2><span id='topic+param_gamma2_stratified'></span>

<h3>Description</h3>

<p>Parameter Description: gamma2_stratified
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_gamma2_stratified_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
</table>

<hr>
<h2 id='param_hazardRatioH0'>Parameter Description: hazardRatioH0</h2><span id='topic+param_hazardRatioH0'></span>

<h3>Description</h3>

<p>Parameter Description: hazardRatioH0
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_hazardRatioH0_+3A_hazardratioh0">hazardRatioH0</code></td>
<td>
<p>Hazard ratio under the null hypothesis for the active
treatment versus control. Defaults to 1 for superiority test.</p>
</td></tr>
</table>

<hr>
<h2 id='param_informationRates'>Parameter Description: informationRates</h2><span id='topic+param_informationRates'></span>

<h3>Description</h3>

<p>Parameter Description: informationRates
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_informationRates_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates in terms of number of
events. Fixed prior to the trial. Defaults to <code>(1:kMax) / kMax</code>
if left unspecified.</p>
</td></tr>
</table>

<hr>
<h2 id='param_kMax'>Parameter Description: kMax</h2><span id='topic+param_kMax'></span>

<h3>Description</h3>

<p>Parameter Description: kMax
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_kMax_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
</table>

<hr>
<h2 id='param_lambda'>Parameter Description: lambda</h2><span id='topic+param_lambda'></span>

<h3>Description</h3>

<p>Parameter Description: lambda
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_lambda_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event. One for
each analysis time interval.</p>
</td></tr>
</table>

<hr>
<h2 id='param_lambda1'>Parameter Description: lambda1</h2><span id='topic+param_lambda1'></span>

<h3>Description</h3>

<p>Parameter Description: lambda1
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_lambda1_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event for the
active treatment group. One for each analysis time interval.</p>
</td></tr>
</table>

<hr>
<h2 id='param_lambda1_stratified'>Parameter Description: lambda1_stratified</h2><span id='topic+param_lambda1_stratified'></span>

<h3>Description</h3>

<p>Parameter Description: lambda1_stratified
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_lambda1_stratified_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
</table>

<hr>
<h2 id='param_lambda2'>Parameter Description: lambda2</h2><span id='topic+param_lambda2'></span>

<h3>Description</h3>

<p>Parameter Description: lambda2
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_lambda2_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event for the
control group. One for each analysis time interval.</p>
</td></tr>
</table>

<hr>
<h2 id='param_lambda2_stratified'>Parameter Description: lambda2_stratified</h2><span id='topic+param_lambda2_stratified'></span>

<h3>Description</h3>

<p>Parameter Description: lambda2_stratified
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_lambda2_stratified_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
</table>

<hr>
<h2 id='param_maxFollowupTime'>Parameter Description: maxFollowupTime</h2><span id='topic+param_maxFollowupTime'></span>

<h3>Description</h3>

<p>Parameter Description: maxFollowupTime
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_maxFollowupTime_+3A_maxfollowuptime">maxFollowupTime</code></td>
<td>
<p>Follow-up time for the first enrolled subject.
For fixed followup, <code>maxFollowupTime = minFollowupTime</code>.
For variable followup,
<code>maxFollowupTime = accrualDuration + minFollowupTime</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='param_minFollowupTime'>Parameter Description: minFollowupTime</h2><span id='topic+param_minFollowupTime'></span>

<h3>Description</h3>

<p>Parameter Description: minFollowupTime
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_minFollowupTime_+3A_minfollowuptime">minFollowupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
</table>

<hr>
<h2 id='param_numSubintervals'>Parameter Description: numSubintervals</h2><span id='topic+param_numSubintervals'></span>

<h3>Description</h3>

<p>Parameter Description: numSubintervals
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_numSubintervals_+3A_numsubintervals">numSubintervals</code></td>
<td>
<p>Number of sub-intervals to approximate the mean
and variance of the weighted log-rank test score statistic.
Defaults to 300. Specify a larger number for better approximation.</p>
</td></tr>
</table>

<hr>
<h2 id='param_parameterAlphaSpending'>Parameter Description: parameterAlphaSpending</h2><span id='topic+param_parameterAlphaSpending'></span>

<h3>Description</h3>

<p>Parameter Description: parameterAlphaSpending
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_parameterAlphaSpending_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='param_parameterBetaSpending'>Parameter Description: parameterBetaSpending</h2><span id='topic+param_parameterBetaSpending'></span>

<h3>Description</h3>

<p>Parameter Description: parameterBetaSpending
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_parameterBetaSpending_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='param_piecewiseSurvivalTime'>Parameter Description: piecewiseSurvivalTime</h2><span id='topic+param_piecewiseSurvivalTime'></span>

<h3>Description</h3>

<p>Parameter Description: piecewiseSurvivalTime
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_piecewiseSurvivalTime_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
</table>

<hr>
<h2 id='param_rho1'>Parameter Description: rho1</h2><span id='topic+param_rho1'></span>

<h3>Description</h3>

<p>Parameter Description: rho1
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_rho1_+3A_rho1">rho1</code></td>
<td>
<p>The first parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
</table>

<hr>
<h2 id='param_rho2'>Parameter Description: rho2</h2><span id='topic+param_rho2'></span>

<h3>Description</h3>

<p>Parameter Description: rho2
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_rho2_+3A_rho2">rho2</code></td>
<td>
<p>The second parameter of the Fleming-Harrington family of
weighted log-rank test. Defaults to 0 for conventional log-rank test.</p>
</td></tr>
</table>

<hr>
<h2 id='param_stratumFraction'>Parameter Description: stratumFraction</h2><span id='topic+param_stratumFraction'></span>

<h3>Description</h3>

<p>Parameter Description: stratumFraction
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_stratumFraction_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
</table>

<hr>
<h2 id='param_typeAlphaSpending'>Parameter Description: typeAlphaSpending</h2><span id='topic+param_typeAlphaSpending'></span>

<h3>Description</h3>

<p>Parameter Description: typeAlphaSpending
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_typeAlphaSpending_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='param_typeBetaSpending'>Parameter Description: typeBetaSpending</h2><span id='topic+param_typeBetaSpending'></span>

<h3>Description</h3>

<p>Parameter Description: typeBetaSpending
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_typeBetaSpending_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='param_typeOfComputation'>Parameter Description: typeOfComputation</h2><span id='topic+param_typeOfComputation'></span>

<h3>Description</h3>

<p>Parameter Description: typeOfComputation
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_typeOfComputation_+3A_typeofcomputation">typeOfComputation</code></td>
<td>
<p>The type of computation,
either &quot;direct&quot; for the direct approximation method,
or &quot;schoenfeld&quot; for the Schoenfeld method.
Defaults to &quot;direct&quot;. Can use &quot;Schoenfeld&quot;
under proportional hazards and conventional log-rank test.</p>
</td></tr>
</table>

<hr>
<h2 id='param_userAlphaSpending'>Parameter Description: userAlphaSpending</h2><span id='topic+param_userAlphaSpending'></span>

<h3>Description</h3>

<p>Parameter Description: userAlphaSpending
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_userAlphaSpending_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
</table>

<hr>
<h2 id='param_userBetaSpending'>Parameter Description: userBetaSpending</h2><span id='topic+param_userBetaSpending'></span>

<h3>Description</h3>

<p>Parameter Description: userBetaSpending
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_userBetaSpending_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
</table>

<hr>
<h2 id='patrisk'>Probability of being at risk</h2><span id='topic+patrisk'></span>

<h3>Description</h3>

<p>Obtains the probability of being at risk at given analysis
times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patrisk(
  time = NA_real_,
  piecewiseSurvivalTime = 0L,
  lambda = NA_real_,
  gamma = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="patrisk_+3A_time">time</code></td>
<td>
<p>A vector of analysis times at which to calculate the
probability of being at risk.</p>
</td></tr>
<tr><td><code id="patrisk_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="patrisk_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event. One for
each analysis time interval.</p>
</td></tr>
<tr><td><code id="patrisk_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of probabilities of being at risk at the specified
analysis times after enrollment for a patient in a treatment group with
specified piecewise exponential survival and dropout distributions.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise exponential survival with hazard 0.0533 in the first 6
# months, and hazard 0.0309 thereafter, and 5% dropout by the end of
# 1 year.

patrisk(time = c(3, 9), piecewiseSurvivalTime = c(0, 6),
        lambda = c(0.0533, 0.0309), gamma = -log(1-0.05)/12)

</code></pre>

<hr>
<h2 id='pd'>Integrated event probability over an interval</h2><span id='topic+pd'></span>

<h3>Description</h3>

<p>Obtains the integration of the probability of having an
event during an interval. The specified analysis time interval can span
more than one analysis time interval with constant hazard.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pd(
  t1 = NA_real_,
  t2 = NA_real_,
  piecewiseSurvivalTime = 0L,
  lambda = NA_real_,
  gamma = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pd_+3A_t1">t1</code></td>
<td>
<p>Lower bound of the analysis time interval.</p>
</td></tr>
<tr><td><code id="pd_+3A_t2">t2</code></td>
<td>
<p>Upper bound of the analysis time interval.</p>
</td></tr>
<tr><td><code id="pd_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="pd_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event. One for
each analysis time interval.</p>
</td></tr>
<tr><td><code id="pd_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value for the integrated probability of having an event
during an interval for a treatment group with specified
piecewise exponential survival and dropout distributions.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise exponential survival with hazard 0.0533 in the first 6
# months, and hazard 0.0309 thereafter, and 5% dropout by the end of
# 1 year.

pd(t1 = 1, t2 = 8, piecewiseSurvivalTime = c(0, 6),
   lambda = c(0.0533, 0.0309), gamma = -log(1-0.05)/12)

</code></pre>

<hr>
<h2 id='pevent'>Probability of having an event</h2><span id='topic+pevent'></span>

<h3>Description</h3>

<p>Obtains the probability of having an event at given analysis
times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pevent(
  time = NA_real_,
  piecewiseSurvivalTime = 0L,
  lambda = NA_real_,
  gamma = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pevent_+3A_time">time</code></td>
<td>
<p>A vector of analysis times at which to calculate the
probability of having an event.</p>
</td></tr>
<tr><td><code id="pevent_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="pevent_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event. One for
each analysis time interval.</p>
</td></tr>
<tr><td><code id="pevent_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout, or a vector of
hazard rates for piecewise exponential dropout.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of probabilities of having an event at the specified
analysis times after enrollment for a patient in a treatment group with
specified piecewise exponential survival and dropout distributions.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise exponential survival with hazard 0.0533 in the first 6
# months, and hazard 0.0309 thereafter, and 5% dropout by the end of
# 1 year.

pevent(time = c(3, 9), piecewiseSurvivalTime = c(0, 6),
       lambda = c(0.0533, 0.0309), gamma = -log(1-0.05)/12)

</code></pre>

<hr>
<h2 id='phregr'>Proportional hazards regression model</h2><span id='topic+phregr'></span>

<h3>Description</h3>

<p>Obtains the hazard ratio estimates from the proportional
hazards regression model with right censored or counting process data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phregr(
  data,
  rep = "rep",
  stratum = "stratum",
  time = "time",
  time2 = "time2",
  event = "event",
  covariates = "treat",
  weight = "weight",
  id = "id",
  ties = "efron",
  robust = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phregr_+3A_data">data</code></td>
<td>
<p>The input data frame that contains the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication for by-group processing.
</p>
</li>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The follow-up time for right censored data, or
the left end of each interval for counting process data.
</p>
</li>
<li> <p><code>time2</code>: The right end of each interval for counting process
data only. Intervals are assumed to be open on the left
and closed on the right, and event indicates whether an event
occurred at the right end of each interval.
</p>
</li>
<li> <p><code>event</code>: The event indicator, normally 1=event, 0=no event.
</p>
</li>
<li> <p><code>covariates</code>: The values of baseline covariates (and
time-dependent covariates in each interval for counting
process data). This is the full-rank design matrix for the Cox
model, assuming that factor variables have already been
expanded into dummy variables.
</p>
</li>
<li> <p><code>weight</code>: The weight for each observation.
</p>
</li>
<li> <p><code>id</code>: The optional subject ID for counting process data
with time-dependent covariates.
</p>
</li></ul>
</td></tr>
<tr><td><code id="phregr_+3A_rep">rep</code></td>
<td>
<p>The name of the replication variable in the input data.</p>
</td></tr>
<tr><td><code id="phregr_+3A_stratum">stratum</code></td>
<td>
<p>The name of the stratum variable in the input data.</p>
</td></tr>
<tr><td><code id="phregr_+3A_time">time</code></td>
<td>
<p>The name of the time variable or the left end of each
interval for counting process data in the input data.</p>
</td></tr>
<tr><td><code id="phregr_+3A_time2">time2</code></td>
<td>
<p>The name of the right end of each interval for counting
process data in the input data.</p>
</td></tr>
<tr><td><code id="phregr_+3A_event">event</code></td>
<td>
<p>The name of the event variable in the input data.</p>
</td></tr>
<tr><td><code id="phregr_+3A_covariates">covariates</code></td>
<td>
<p>The vector of names of baseline and time-dependent
covariates in the input data.</p>
</td></tr>
<tr><td><code id="phregr_+3A_weight">weight</code></td>
<td>
<p>The name of the weighting variable in the input data.</p>
</td></tr>
<tr><td><code id="phregr_+3A_id">id</code></td>
<td>
<p>The name of the id variable in the input data.</p>
</td></tr>
<tr><td><code id="phregr_+3A_ties">ties</code></td>
<td>
<p>The method for handling ties with options including
&quot;breslow&quot; and &quot;efron&quot; (default).</p>
</td></tr>
<tr><td><code id="phregr_+3A_robust">robust</code></td>
<td>
<p>Whether a robust sandwich variance estimate should be
computed. The default is TRUE if there are fractional weights or
there is at least 1 id with &gt;1 event. In the presence of the id
variable, the score residual will be aggregated for each id when
computing the robust sandwich variance estimate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>sumstat</code>: The data frame of summary statistics of model fit
with the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication.
</p>
</li>
<li> <p><code>n</code>: The number of observations.
</p>
</li>
<li> <p><code>nevents</code>: The number of events.
</p>
</li>
<li> <p><code>loglik0</code>: The log-likelihood under null.
</p>
</li>
<li> <p><code>loglik1</code>: The maximum log-likelihood.
</p>
</li>
<li> <p><code>scoretest</code>: The score test statistic.
</p>
</li></ul>

</li>
<li> <p><code>parest</code>: The data frame of parameter estimates with the
following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication.
</p>
</li>
<li> <p><code>param</code>: The name of the covariate for the parameter estimate.
</p>
</li>
<li> <p><code>beta</code>: The log hazard ratio estimate.
</p>
</li>
<li> <p><code>sebeta</code>: The standard error of log hazard ratio estimate.
</p>
</li>
<li> <p><code>rsebeta</code>: The robust standard error of log hazard ratio
estimate if robust variance is requested.
</p>
</li>
<li> <p><code>z</code>: The Wald test statistic for log hazard ratio. The
<code>rsebeta</code> will be used if robust variance is requested.
</p>
</li>
<li> <p><code>hazardRatio</code>: The hazard ratio estimate.
</p>
</li>
<li> <p><code>vbeta</code>: The covariance matrix for parameter estimates.
</p>
</li>
<li> <p><code>rvbeta</code>: The robust covariance matrix for parameter
estimates if robust variance is requested.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

# Example 1 with right-censored data
phregr(data = rawdata %&gt;% mutate(treat = 1*(treatmentGroup == 1)),
       rep = "iterationNumber", stratum = "stratum",
       time = "timeUnderObservation", event = "event",
       covariates = "treat")

# Example 2 with counting process data and robust variance estimate
phregr(data = heart %&gt;% mutate(rx = as.numeric(transplant) - 1),
       time = "start", time2 = "stop", event = "event",
       covariates = c("rx", "age"), id = "id", robust = 1)

</code></pre>

<hr>
<h2 id='powerFisherExact'>Power for Fisher's exact test for two proportions</h2><span id='topic+powerFisherExact'></span>

<h3>Description</h3>

<p>Obtains the power given sample size for Fisher's exact
test for two proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerFisherExact(
  n = NA_integer_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerFisherExact_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="powerFisherExact_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="powerFisherExact_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="powerFisherExact_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="powerFisherExact_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- powerFisherExact(
  n = 136, pi1 = 0.25, pi2 = 0.05, alpha = 0.05))

</code></pre>

<hr>
<h2 id='powerOnePropExact'>Power for binomial one-sample exact test</h2><span id='topic+powerOnePropExact'></span>

<h3>Description</h3>

<p>Obtains the power for binomial one-sample exact test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerOnePropExact(
  n = NA_integer_,
  piH0 = NA_real_,
  pi = NA_real_,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerOnePropExact_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="powerOnePropExact_+3A_pih0">piH0</code></td>
<td>
<p>The response probability under the null hypothesis.</p>
</td></tr>
<tr><td><code id="powerOnePropExact_+3A_pi">pi</code></td>
<td>
<p>The response probability under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="powerOnePropExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the critical value of the number of
responses for rejecting the null hypothesis, the attained type I
error, the power for the exact test, the sample size, the
response probabilities under the null and alternative hypotheses,
and the direction of the alternative.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>powerOnePropExact(n = 110, piH0 = 0.15, pi = 0.25, alpha = 0.05)

</code></pre>

<hr>
<h2 id='powerOneRateExact'>Power for Poisson one-sample exact test</h2><span id='topic+powerOneRateExact'></span>

<h3>Description</h3>

<p>Obtains the power for Poisson one-sample exact test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerOneRateExact(
  n = NA_integer_,
  lambdaH0 = NA_real_,
  lambda = NA_real_,
  D = 1,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerOneRateExact_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="powerOneRateExact_+3A_lambdah0">lambdaH0</code></td>
<td>
<p>The Poisson rate under the null hypothesis.</p>
</td></tr>
<tr><td><code id="powerOneRateExact_+3A_lambda">lambda</code></td>
<td>
<p>The Poisson rate under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="powerOneRateExact_+3A_d">D</code></td>
<td>
<p>The average exposure per subject.</p>
</td></tr>
<tr><td><code id="powerOneRateExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the critical value of the number of
events for rejecting the null hypothesis, the attained type I
error, the power for the exact test, the sample size,
the Poisson rates under the null and alternative hypotheses,
the average exposure, and the direction of the alternative.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>powerOneRateExact(n = 525, lambdaH0 = 0.049, lambda = 0.012,
                  D = 0.5, alpha = 0.025)

</code></pre>

<hr>
<h2 id='powerRiskDiffExact'>Power for exact unconditional test of risk difference</h2><span id='topic+powerRiskDiffExact'></span>

<h3>Description</h3>

<p>Obtains the power given sample size for exact unconditional
test of risk difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerRiskDiffExact(
  n = NA_integer_,
  riskDiffH0 = 0,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.025,
  calculateAttainedAlpha = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerRiskDiffExact_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExact_+3A_riskdiffh0">riskDiffH0</code></td>
<td>
<p>The risk difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExact_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExact_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExact_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExact_+3A_calculateattainedalpha">calculateAttainedAlpha</code></td>
<td>
<p>Whether to calculate the attained alpha.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified one-sided significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained one-sided significance level if
requested.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskDiffH0</code>: The risk difference under the null hypothesis.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskDiffBound</code>: The critical value on the scale of
score test statistic for risk difference.
</p>
</li>
<li> <p><code>pi2star</code>: The response probability in the control group
at which the critical value of the test statistic is attained.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
powerRiskDiffExact(n = 68, pi1 = 0.6, pi2 = 0.25, alpha = 0.05)

</code></pre>

<hr>
<h2 id='powerRiskDiffExactEquiv'>Power for exact unconditional test of equivalence in risk
difference</h2><span id='topic+powerRiskDiffExactEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size for exact unconditional
test of equivalence in risk difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerRiskDiffExactEquiv(
  n = NA_integer_,
  riskDiffLower = NA_real_,
  riskDiffUpper = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.05,
  calculateAttainedAlpha = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerRiskDiffExactEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExactEquiv_+3A_riskdifflower">riskDiffLower</code></td>
<td>
<p>The lower equivalence limit of risk difference.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExactEquiv_+3A_riskdiffupper">riskDiffUpper</code></td>
<td>
<p>The upper equivalence limit of risk difference.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExactEquiv_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExactEquiv_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExactEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExactEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="powerRiskDiffExactEquiv_+3A_calculateattainedalpha">calculateAttainedAlpha</code></td>
<td>
<p>Whether to calculate the attained alpha.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified significance level for each of the two
one-sided tests.
</p>
</li>
<li> <p><code>attainedAlphaH10</code>: The attained significance level under H10
if requested.
</p>
</li>
<li> <p><code>attainedAlphaH20</code>: The attained significance level under H20
if requested.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskDiffLower</code>: The lower equivalence limit of risk difference.
</p>
</li>
<li> <p><code>riskDiffUpper</code>: The upper equivalence limit of risk difference.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>riskDiff</code>: The risk difference.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskDiffLower</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>zstatRiskDiffUpper</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
powerRiskDiffExactEquiv(
  n = 200, riskDiffLower = -0.2, riskDiffUpper = 0.2,
  pi1 = 0.775, pi2 = 0.775, alpha = 0.05)

</code></pre>

<hr>
<h2 id='powerRiskRatioExact'>Power for exact unconditional test of risk ratio</h2><span id='topic+powerRiskRatioExact'></span>

<h3>Description</h3>

<p>Obtains the power given sample size for exact unconditional
test of risk ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerRiskRatioExact(
  n = NA_integer_,
  riskRatioH0 = 1,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.025,
  calculateAttainedAlpha = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerRiskRatioExact_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExact_+3A_riskratioh0">riskRatioH0</code></td>
<td>
<p>The risk ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExact_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExact_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExact_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExact_+3A_calculateattainedalpha">calculateAttainedAlpha</code></td>
<td>
<p>Whether to calculate the attained alpha.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified one-sided significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained one-sided significance level if
requested.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskRatioH0</code>: The risk ratio under the null hypothesis.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskRatioBound</code>: The critical value on the scale of
score test statistic for risk ratio.
</p>
</li>
<li> <p><code>pi2star</code>: The response probability in the control group
at which the critical value of the test statistic is attained.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
powerRiskRatioExact(n = 68, pi1 = 0.6, pi2 = 0.25, alpha = 0.05)

</code></pre>

<hr>
<h2 id='powerRiskRatioExactEquiv'>Power for exact unconditional test of equivalence in risk
ratio</h2><span id='topic+powerRiskRatioExactEquiv'></span>

<h3>Description</h3>

<p>Obtains the power given sample size for exact unconditional
test of equivalence in risk ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerRiskRatioExactEquiv(
  n = NA_integer_,
  riskRatioLower = NA_real_,
  riskRatioUpper = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.05,
  calculateAttainedAlpha = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerRiskRatioExactEquiv_+3A_n">n</code></td>
<td>
<p>The total sample size.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExactEquiv_+3A_riskratiolower">riskRatioLower</code></td>
<td>
<p>The lower equivalence limit of risk ratio.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExactEquiv_+3A_riskratioupper">riskRatioUpper</code></td>
<td>
<p>The upper equivalence limit of risk ratio.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExactEquiv_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExactEquiv_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExactEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExactEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="powerRiskRatioExactEquiv_+3A_calculateattainedalpha">calculateAttainedAlpha</code></td>
<td>
<p>Whether to calculate the attained alpha.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified significance level for each of the two
one-sided tests.
</p>
</li>
<li> <p><code>attainedAlphaH10</code>: The attained significance level under H10
if requested.
</p>
</li>
<li> <p><code>attainedAlphaH20</code>: The attained significance level under H20
if requested.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskRatioLower</code>: The lower equivalence limit of risk ratio.
</p>
</li>
<li> <p><code>riskRatioUpper</code>: The upper equivalence limit of risk ratio.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>riskRatio</code>: The risk ratio.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskRatioLower</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>zstatRiskRatioUpper</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
powerRiskRatioExactEquiv(
  n = 200, riskRatioLower = 0.8, riskRatioUpper = 1.25,
  pi1 = 0.775, pi2 = 0.775, alpha = 0.05)

</code></pre>

<hr>
<h2 id='print.adaptDesign'>Print adaptive group sequential design</h2><span id='topic+print.adaptDesign'></span>

<h3>Description</h3>

<p>Prints the primary and second trial information for
an adaptive group sequential design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'adaptDesign'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.adaptDesign_+3A_x">x</code></td>
<td>
<p>The adaptDesign object to print.</p>
</td></tr>
<tr><td><code id="print.adaptDesign_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.BOINTable'>Print the decision table for the BOIN design</h2><span id='topic+print.BOINTable'></span>

<h3>Description</h3>

<p>Prints the decision table of the Bayesian optimal interval
design for MTD finding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BOINTable'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BOINTable_+3A_x">x</code></td>
<td>
<p>The BOINTable object to print.</p>
</td></tr>
<tr><td><code id="print.BOINTable_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.design'>Print group sequential design</h2><span id='topic+print.design'></span>

<h3>Description</h3>

<p>Prints the stopping boundaries and information inflation
factor for group sequential design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'design'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.design_+3A_x">x</code></td>
<td>
<p>The design object to print.</p>
</td></tr>
<tr><td><code id="print.design_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designAgreement'>Print the power and sample size for Cohen's kappa.</h2><span id='topic+print.designAgreement'></span>

<h3>Description</h3>

<p>Prints the power and sample size for Cohen's kappa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designAgreement'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designAgreement_+3A_x">x</code></td>
<td>
<p>The designAgreement object to print.</p>
</td></tr>
<tr><td><code id="print.designAgreement_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designANOVA'>Print the power and sample size for one-way ANOVA</h2><span id='topic+print.designANOVA'></span>

<h3>Description</h3>

<p>Prints the power and sample size for one-way analysis
of variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designANOVA'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designANOVA_+3A_x">x</code></td>
<td>
<p>The designANOVA object to print.</p>
</td></tr>
<tr><td><code id="print.designANOVA_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designANOVAContrast'>Print the power and sample size for a single contrast in
one-way ANOVA</h2><span id='topic+print.designANOVAContrast'></span>

<h3>Description</h3>

<p>Prints the power and sample size for a single contrast in
one-way analysis of variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designANOVAContrast'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designANOVAContrast_+3A_x">x</code></td>
<td>
<p>The designANOVAContrast object to print.</p>
</td></tr>
<tr><td><code id="print.designANOVAContrast_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designEquiv'>Print group sequential equivalence design</h2><span id='topic+print.designEquiv'></span>

<h3>Description</h3>

<p>Prints the stopping boundaries for group sequential
equivalence design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designEquiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designEquiv_+3A_x">x</code></td>
<td>
<p>The design object to print.</p>
</td></tr>
<tr><td><code id="print.designEquiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designLogistic'>Print the power and sample size for logistic regression</h2><span id='topic+print.designLogistic'></span>

<h3>Description</h3>

<p>Prints the power and sample size for logistic regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designLogistic'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designLogistic_+3A_x">x</code></td>
<td>
<p>The designLogistic object to print.</p>
</td></tr>
<tr><td><code id="print.designLogistic_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designMeanDiff'>Print power and sample size results for two-sample mean difference</h2><span id='topic+print.designMeanDiff'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
two-sample mean difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designMeanDiff'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designMeanDiff_+3A_x">x</code></td>
<td>
<p>The designMeanDiff object to print.</p>
</td></tr>
<tr><td><code id="print.designMeanDiff_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designMeanDiffCarryover'>Print power and sample size results for direct treatment effects
in crossover trials accounting for carryover effects</h2><span id='topic+print.designMeanDiffCarryover'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
direct treatment effects in crossover trials accounting for
carryover effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designMeanDiffCarryover'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designMeanDiffCarryover_+3A_x">x</code></td>
<td>
<p>The designMeanDiffCarryover object to print.</p>
</td></tr>
<tr><td><code id="print.designMeanDiffCarryover_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designMeanDiffEquiv'>Print power and sample size results for equivalence in
two-sample mean difference</h2><span id='topic+print.designMeanDiffEquiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in two-sample mean difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designMeanDiffEquiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designMeanDiffEquiv_+3A_x">x</code></td>
<td>
<p>The designMeanDiffEquiv object to print.</p>
</td></tr>
<tr><td><code id="print.designMeanDiffEquiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designMeanDiffMMRM'>Print power and sample size results for two-sample mean difference
at the last time point from the MMRM model</h2><span id='topic+print.designMeanDiffMMRM'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
two-sample mean difference at the last time point from the MMRM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designMeanDiffMMRM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designMeanDiffMMRM_+3A_x">x</code></td>
<td>
<p>The designMeanDiffMMRM object to print.</p>
</td></tr>
<tr><td><code id="print.designMeanDiffMMRM_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designMeanDiffXO'>Print power and sample size results for mean difference in 2x2
crossover</h2><span id='topic+print.designMeanDiffXO'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
mean difference in 2x2 crossover.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designMeanDiffXO'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designMeanDiffXO_+3A_x">x</code></td>
<td>
<p>The designMeanDiffXO object to print.</p>
</td></tr>
<tr><td><code id="print.designMeanDiffXO_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designMeanDiffXOEquiv'>Print power and sample size results for equivalence in
mean difference in 2x2 crossover</h2><span id='topic+print.designMeanDiffXOEquiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in mean difference in 2x2 crossover.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designMeanDiffXOEquiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designMeanDiffXOEquiv_+3A_x">x</code></td>
<td>
<p>The designMeanDiffXOEquiv object to print.</p>
</td></tr>
<tr><td><code id="print.designMeanDiffXOEquiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designMeanRatio'>Print power and sample size results for two-sample mean ratio</h2><span id='topic+print.designMeanRatio'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
two-sample mean ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designMeanRatio'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designMeanRatio_+3A_x">x</code></td>
<td>
<p>The designMeanRatio object to print.</p>
</td></tr>
<tr><td><code id="print.designMeanRatio_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designMeanRatioEquiv'>Print power and sample size results for equivalence in
two-sample mean ratio</h2><span id='topic+print.designMeanRatioEquiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in two-sample mean ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designMeanRatioEquiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designMeanRatioEquiv_+3A_x">x</code></td>
<td>
<p>The designMeanRatioEquiv object to print.</p>
</td></tr>
<tr><td><code id="print.designMeanRatioEquiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designMeanRatioXO'>Print power and sample size results for mean ratio in 2x2 crossover</h2><span id='topic+print.designMeanRatioXO'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
mean ratio in 2x2 crossover.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designMeanRatioXO'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designMeanRatioXO_+3A_x">x</code></td>
<td>
<p>The designMeanRatioXO object to print.</p>
</td></tr>
<tr><td><code id="print.designMeanRatioXO_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designMeanRatioXOEquiv'>Print power and sample size results for equivalence in
mean ratio in 2x2 crossover</h2><span id='topic+print.designMeanRatioXOEquiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in mean ratio in 2x2 crossover.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designMeanRatioXOEquiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designMeanRatioXOEquiv_+3A_x">x</code></td>
<td>
<p>The designMeanRatioXOEquiv object to print.</p>
</td></tr>
<tr><td><code id="print.designMeanRatioXOEquiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designOddsRatio'>Print power and sample size results for two-sample odds ratio</h2><span id='topic+print.designOddsRatio'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
two-sample odds ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designOddsRatio'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designOddsRatio_+3A_x">x</code></td>
<td>
<p>The designOddsRatio object to print.</p>
</td></tr>
<tr><td><code id="print.designOddsRatio_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designOddsRatioEquiv'>Print power and sample size results for equivalence in
two-sample odds ratio</h2><span id='topic+print.designOddsRatioEquiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in two-sample odds ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designOddsRatioEquiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designOddsRatioEquiv_+3A_x">x</code></td>
<td>
<p>The designOddsRatioEquiv object to print.</p>
</td></tr>
<tr><td><code id="print.designOddsRatioEquiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designOneMean'>Print power and sample size results for one-sample mean</h2><span id='topic+print.designOneMean'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
one-sample mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designOneMean'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designOneMean_+3A_x">x</code></td>
<td>
<p>The designOneMean object to print.</p>
</td></tr>
<tr><td><code id="print.designOneMean_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designOneMultinom'>Print the power and sample size for one-sample multinomial response</h2><span id='topic+print.designOneMultinom'></span>

<h3>Description</h3>

<p>Prints the power and sample size for one-sample multinomial
response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designOneMultinom'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designOneMultinom_+3A_x">x</code></td>
<td>
<p>The designOneMultinom object to print.</p>
</td></tr>
<tr><td><code id="print.designOneMultinom_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designOneProportion'>Print power and sample size results for one-sample proportion</h2><span id='topic+print.designOneProportion'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
one-sample proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designOneProportion'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designOneProportion_+3A_x">x</code></td>
<td>
<p>The designOneProportion object to print.</p>
</td></tr>
<tr><td><code id="print.designOneProportion_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designOneSlope'>Print power and sample size results for one-sample slope</h2><span id='topic+print.designOneSlope'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
one-sample slope.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designOneSlope'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designOneSlope_+3A_x">x</code></td>
<td>
<p>The designOneSlope object to print.</p>
</td></tr>
<tr><td><code id="print.designOneSlope_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designOrderedBinom'>Print the power and sample size for Cochran-Armitage trend test
for ordered multi-sample binomial response</h2><span id='topic+print.designOrderedBinom'></span>

<h3>Description</h3>

<p>Prints the power and sample size for Cochran-Armitage
trend test for ordered multi-sample binomial response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designOrderedBinom'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designOrderedBinom_+3A_x">x</code></td>
<td>
<p>The designOrderedBinom object to print.</p>
</td></tr>
<tr><td><code id="print.designOrderedBinom_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designPairedMeanDiff'>Print power and sample size results for paired mean difference</h2><span id='topic+print.designPairedMeanDiff'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
paired mean difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designPairedMeanDiff'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designPairedMeanDiff_+3A_x">x</code></td>
<td>
<p>The designPairedMeanDiff object to print.</p>
</td></tr>
<tr><td><code id="print.designPairedMeanDiff_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designPairedMeanDiffEquiv'>Print power and sample size results for equivalence in paired
mean difference</h2><span id='topic+print.designPairedMeanDiffEquiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in paired mean difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designPairedMeanDiffEquiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designPairedMeanDiffEquiv_+3A_x">x</code></td>
<td>
<p>The designPairedMeanDiffEquiv object to print.</p>
</td></tr>
<tr><td><code id="print.designPairedMeanDiffEquiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designPairedMeanRatio'>Print power and sample size results for paired mean ratio</h2><span id='topic+print.designPairedMeanRatio'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
paired mean ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designPairedMeanRatio'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designPairedMeanRatio_+3A_x">x</code></td>
<td>
<p>The designPairedMeanRatio object to print.</p>
</td></tr>
<tr><td><code id="print.designPairedMeanRatio_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designPairedMeanRatioEquiv'>Print power and sample size results for equivalence in paired
mean ratio</h2><span id='topic+print.designPairedMeanRatioEquiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in paired mean ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designPairedMeanRatioEquiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designPairedMeanRatioEquiv_+3A_x">x</code></td>
<td>
<p>The designPairedMeanRatioEquiv object to print.</p>
</td></tr>
<tr><td><code id="print.designPairedMeanRatioEquiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designPairedPropMcNemar'>Print power and sample size results for McNemar's test for paired
proportions</h2><span id='topic+print.designPairedPropMcNemar'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
McNemar's test for paired proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designPairedPropMcNemar'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designPairedPropMcNemar_+3A_x">x</code></td>
<td>
<p>The designPairedPropMcNemar object to print.</p>
</td></tr>
<tr><td><code id="print.designPairedPropMcNemar_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designRepeatedANOVA'>Print the power and sample size for one-way repeated measures ANOVA</h2><span id='topic+print.designRepeatedANOVA'></span>

<h3>Description</h3>

<p>Prints the power and sample size for one-way repeated
measures analysis of variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designRepeatedANOVA'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designRepeatedANOVA_+3A_x">x</code></td>
<td>
<p>The designRepeatedANOVA object to print.</p>
</td></tr>
<tr><td><code id="print.designRepeatedANOVA_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designRepeatedANOVAContrast'>Print the power and sample size for a single contrast in
one-way repeated measures ANOVA</h2><span id='topic+print.designRepeatedANOVAContrast'></span>

<h3>Description</h3>

<p>Prints the power and sample size for a single contrast in
one-way repeated measures analysis of variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designRepeatedANOVAContrast'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designRepeatedANOVAContrast_+3A_x">x</code></td>
<td>
<p>The designRepeatedANOVAContrast object to print.</p>
</td></tr>
<tr><td><code id="print.designRepeatedANOVAContrast_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designRiskDiff'>Print power and sample size results for two-sample risk difference</h2><span id='topic+print.designRiskDiff'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
two-sample risk difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designRiskDiff'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designRiskDiff_+3A_x">x</code></td>
<td>
<p>The designRiskDiff object to print.</p>
</td></tr>
<tr><td><code id="print.designRiskDiff_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designRiskDiffEquiv'>Print power and sample size results for equivalence in
two-sample risk difference</h2><span id='topic+print.designRiskDiffEquiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in two-sample risk difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designRiskDiffEquiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designRiskDiffEquiv_+3A_x">x</code></td>
<td>
<p>The designRiskDiffEquiv object to print.</p>
</td></tr>
<tr><td><code id="print.designRiskDiffEquiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designRiskRatio'>Print power and sample size results for two-sample risk ratio</h2><span id='topic+print.designRiskRatio'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
two-sample risk ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designRiskRatio'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designRiskRatio_+3A_x">x</code></td>
<td>
<p>The designRiskRatio object to print.</p>
</td></tr>
<tr><td><code id="print.designRiskRatio_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designRiskRatioEquiv'>Print power and sample size results for equivalence in
two-sample risk ratio</h2><span id='topic+print.designRiskRatioEquiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in two-sample risk ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designRiskRatioEquiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designRiskRatioEquiv_+3A_x">x</code></td>
<td>
<p>The designRiskRatioEquiv object to print.</p>
</td></tr>
<tr><td><code id="print.designRiskRatioEquiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designRiskRatioFM'>Print power and sample size results for two-sample risk ratio
based on the Farrington-Manning score test</h2><span id='topic+print.designRiskRatioFM'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
two-sample risk ratio based on the Farrington-Manning score test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designRiskRatioFM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designRiskRatioFM_+3A_x">x</code></td>
<td>
<p>The designRiskRatioFM object to print.</p>
</td></tr>
<tr><td><code id="print.designRiskRatioFM_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designSlopeDiff'>Print power and sample size results for two-sample slope difference</h2><span id='topic+print.designSlopeDiff'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
two-sample slope difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designSlopeDiff'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designSlopeDiff_+3A_x">x</code></td>
<td>
<p>The designSlopeDiff object to print.</p>
</td></tr>
<tr><td><code id="print.designSlopeDiff_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designSlopeDiffMMRM'>Print power and sample size results for two-sample slope difference
at the last time point from the MMRM model</h2><span id='topic+print.designSlopeDiffMMRM'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
two-sample slope difference at the last time point from the MMRM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designSlopeDiffMMRM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designSlopeDiffMMRM_+3A_x">x</code></td>
<td>
<p>The designSlopeDiffMMRM object to print.</p>
</td></tr>
<tr><td><code id="print.designSlopeDiffMMRM_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designTwoMultinom'>Print the power and sample size for difference in two-sample
multinomial response</h2><span id='topic+print.designTwoMultinom'></span>

<h3>Description</h3>

<p>Prints the power and sample size for difference in
two-sample multinomial response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designTwoMultinom'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designTwoMultinom_+3A_x">x</code></td>
<td>
<p>The designTwoMultinom object to print.</p>
</td></tr>
<tr><td><code id="print.designTwoMultinom_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designTwoOrdinal'>Print the power and sample size for Wilcoxon test for two-sample
ordinal response.</h2><span id='topic+print.designTwoOrdinal'></span>

<h3>Description</h3>

<p>Prints the power and sample size for Wilcoxon test for
two-sample ordinal response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designTwoOrdinal'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designTwoOrdinal_+3A_x">x</code></td>
<td>
<p>The designTwoOrdinal object to print.</p>
</td></tr>
<tr><td><code id="print.designTwoOrdinal_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designTwoWayANOVA'>Print the power and sample size for two-way ANOVA</h2><span id='topic+print.designTwoWayANOVA'></span>

<h3>Description</h3>

<p>Prints the power and sample size for two-way analysis
of variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designTwoWayANOVA'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designTwoWayANOVA_+3A_x">x</code></td>
<td>
<p>The designTwoWayANOVA object to print.</p>
</td></tr>
<tr><td><code id="print.designTwoWayANOVA_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designUnorderedBinom'>Print the power and sample size for unordered multi-sample
binomial response</h2><span id='topic+print.designUnorderedBinom'></span>

<h3>Description</h3>

<p>Prints the power and sample size for unordered multi-sample
binomial response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designUnorderedBinom'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designUnorderedBinom_+3A_x">x</code></td>
<td>
<p>The designUnorderedBinom object to print.</p>
</td></tr>
<tr><td><code id="print.designUnorderedBinom_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designUnorderedMultinom'>Print the power and sample size for unordered multi-sample
multinomial response</h2><span id='topic+print.designUnorderedMultinom'></span>

<h3>Description</h3>

<p>Prints the power and sample size for unordered multi-sample
multinomial response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designUnorderedMultinom'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designUnorderedMultinom_+3A_x">x</code></td>
<td>
<p>The designUnorderedMultinom object to print.</p>
</td></tr>
<tr><td><code id="print.designUnorderedMultinom_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.designWilcoxon'>Print power and sample size results for two-sample Wilcoxon test</h2><span id='topic+print.designWilcoxon'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
two-sample Wilcoxon test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designWilcoxon'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.designWilcoxon_+3A_x">x</code></td>
<td>
<p>The designWilcoxon object to print.</p>
</td></tr>
<tr><td><code id="print.designWilcoxon_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.estimateCI'>Print the point estimate and confidence interval</h2><span id='topic+print.estimateCI'></span>

<h3>Description</h3>

<p>Prints the point estimate and confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estimateCI'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.estimateCI_+3A_x">x</code></td>
<td>
<p>The estimateCI object to print.</p>
</td></tr>
<tr><td><code id="print.estimateCI_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.kmpower'>Print power and sample size results for milestone survival
difference</h2><span id='topic+print.kmpower'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kmpower'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.kmpower_+3A_x">x</code></td>
<td>
<p>The kmpower object to print.</p>
</td></tr>
<tr><td><code id="print.kmpower_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.kmpower1s'>Print power and sample size results for one-sample milestone
survival probability</h2><span id='topic+print.kmpower1s'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
one-sample milestone survival probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kmpower1s'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.kmpower1s_+3A_x">x</code></td>
<td>
<p>The kmpower1s object to print.</p>
</td></tr>
<tr><td><code id="print.kmpower1s_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.kmpowerequiv'>Print power and sample size results for equivalence in milestone
survival probability difference</h2><span id='topic+print.kmpowerequiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in milestone survival probability difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kmpowerequiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.kmpowerequiv_+3A_x">x</code></td>
<td>
<p>The kmpowerequiv object to print.</p>
</td></tr>
<tr><td><code id="print.kmpowerequiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.lrpower'>Print power and sample size results for log-rank tests</h2><span id='topic+print.lrpower'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lrpower'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.lrpower_+3A_x">x</code></td>
<td>
<p>The lrpower object to print.</p>
</td></tr>
<tr><td><code id="print.lrpower_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.lrpowerequiv'>Print power and sample size results for equivalence in hazard
ratio</h2><span id='topic+print.lrpowerequiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in hazard ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lrpowerequiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.lrpowerequiv_+3A_x">x</code></td>
<td>
<p>The lrpowerequiv object to print.</p>
</td></tr>
<tr><td><code id="print.lrpowerequiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.lrsim'>Print simulation results for log-rank tests</h2><span id='topic+print.lrsim'></span>

<h3>Description</h3>

<p>Prints the summary statistics from simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lrsim'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.lrsim_+3A_x">x</code></td>
<td>
<p>The lrsim object to print.</p>
</td></tr>
<tr><td><code id="print.lrsim_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from simulation runs.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.mTPI2Table'>Print the decision table for the mTPI-2 design</h2><span id='topic+print.mTPI2Table'></span>

<h3>Description</h3>

<p>Prints the decision table of the modified toxicity
probability-2 (mTPI-2) design for MTD finding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mTPI2Table'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mTPI2Table_+3A_x">x</code></td>
<td>
<p>The mTPI2Table object to print.</p>
</td></tr>
<tr><td><code id="print.mTPI2Table_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the design elements.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.nbpower'>Print power and sample size results for negative binomial rate
ratio</h2><span id='topic+print.nbpower'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
negative binomial rate ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nbpower'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.nbpower_+3A_x">x</code></td>
<td>
<p>The nbpower object to print.</p>
</td></tr>
<tr><td><code id="print.nbpower_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.nbpower1s'>Print power and sample size results for one-sample negative
binomial rate</h2><span id='topic+print.nbpower1s'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
one-sample negative binomial rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nbpower1s'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.nbpower1s_+3A_x">x</code></td>
<td>
<p>The nbpower1s object to print.</p>
</td></tr>
<tr><td><code id="print.nbpower1s_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.nbpowerequiv'>Print power and sample size results for equivalence in negative
binomial rate ratio</h2><span id='topic+print.nbpowerequiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in negative binomial rate ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nbpowerequiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.nbpowerequiv_+3A_x">x</code></td>
<td>
<p>The nbpowerequiv object to print.</p>
</td></tr>
<tr><td><code id="print.nbpowerequiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.rmpower'>Print power and sample size results for restricted mean survival
time difference</h2><span id='topic+print.rmpower'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rmpower'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rmpower_+3A_x">x</code></td>
<td>
<p>The rmpower object to print.</p>
</td></tr>
<tr><td><code id="print.rmpower_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.rmpower1s'>Print power and sample size results for one-sample restricted
mean survival time</h2><span id='topic+print.rmpower1s'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
one-sample restricted mean survival time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rmpower1s'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rmpower1s_+3A_x">x</code></td>
<td>
<p>The rmpower1s object to print.</p>
</td></tr>
<tr><td><code id="print.rmpower1s_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='print.rmpowerequiv'>Print power and sample size results for equivalence in restricted
mean survival time difference</h2><span id='topic+print.rmpowerequiv'></span>

<h3>Description</h3>

<p>Prints the summary statistics from power calculation of
equivalence in restricted mean survival time difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rmpowerequiv'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rmpowerequiv_+3A_x">x</code></td>
<td>
<p>The rmpowerequiv object to print.</p>
</td></tr>
<tr><td><code id="print.rmpowerequiv_+3A_...">...</code></td>
<td>
<p>Ensures that all arguments starting from &quot;...&quot; are named.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tabular printout of the summary statistics from power
calculation.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='ptpwexp'>Distribution function of truncated piecewise exponential
distribution</h2><span id='topic+ptpwexp'></span>

<h3>Description</h3>

<p>Obtains the probability of a truncated piecewise exponential
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptpwexp(
  q,
  piecewiseSurvivalTime = 0,
  lambda = 0.0578,
  lowerBound = 0,
  lower.tail = TRUE,
  log.p = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptpwexp_+3A_q">q</code></td>
<td>
<p>The vector of quantiles.</p>
</td></tr>
<tr><td><code id="ptpwexp_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="ptpwexp_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event. One for
each analysis time interval.</p>
</td></tr>
<tr><td><code id="ptpwexp_+3A_lowerbound">lowerBound</code></td>
<td>
<p>The left truncation time point for the survival time.
Defaults to 0 for no truncation.</p>
</td></tr>
<tr><td><code id="ptpwexp_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical; if TRUE (default), probabilities are P(X &lt;= x),
otherwise, P(X &gt; x).</p>
</td></tr>
<tr><td><code id="ptpwexp_+3A_log.p">log.p</code></td>
<td>
<p>Logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The probability p such that
P(X &gt; q | X &gt; lowerBound) = 1 - p.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ptpwexp(q = c(8, 18), piecewiseSurvivalTime = c(0, 6, 9, 15),
        lambda = c(0.025, 0.04, 0.015, 0.007))

</code></pre>

<hr>
<h2 id='pwexpcuts'>Piecewise exponential approximation to a survival distribution</h2><span id='topic+pwexpcuts'></span>

<h3>Description</h3>

<p>Obtains the piecewise exponential distribution that
approximates a survival distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pwexpcuts(S, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pwexpcuts_+3A_s">S</code></td>
<td>
<p>The survival function of a univariate survival time.</p>
</td></tr>
<tr><td><code id="pwexpcuts_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to S.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three components:
</p>

<ul>
<li> <p><code>piecewiseSurvivalTime</code>: A vector that specifies the starting
time of piecewise exponential survival time intervals.
Must start with 0, e.g., c(0, 6) breaks the time axis into 2 event
intervals: [0, 6) and [6, Inf).
</p>
</li>
<li> <p><code>lambda</code>: A vector of hazard rates for the event. One for
each analysis time interval.
</p>
</li>
<li> <p><code>loglik</code>: The sequence of the asymptotic limit of the
piecewise exponential log-likelihood for an increasing number
of change points.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: Piecewise exponential 
pwexpcuts(ptpwexp, piecewiseSurvivalTime = c(0, 3.4, 5.5), 
          lambda = c(0.0168, 0.0833, 0.0431), lowerBound = 0,
          lower.tail = FALSE) 
 
# Example 2: Weibull
pwexpcuts(pweibull, shape = 1.37, scale = 1/0.818, lower.tail = FALSE)

</code></pre>

<hr>
<h2 id='pwexploglik'>Profile log-likelihood function for the change points in
piecewise exponential approximation</h2><span id='topic+pwexploglik'></span>

<h3>Description</h3>

<p>Obtains the profile log-likelihood function for the
change points in the piecewise exponential approximation to
a survival function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pwexploglik(tau, S, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pwexploglik_+3A_tau">tau</code></td>
<td>
<p>The numeric vector of change points.</p>
</td></tr>
<tr><td><code id="pwexploglik_+3A_s">S</code></td>
<td>
<p>The survival function of a univariate survival time.</p>
</td></tr>
<tr><td><code id="pwexploglik_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to S.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following three components:
</p>

<ul>
<li> <p><code>piecewiseSurvivalTime</code>: A vector that specifies the starting
time of piecewise exponential survival time intervals.
</p>
</li>
<li> <p><code>lambda</code>: A vector of hazard rates for the event. One for
each analysis time interval.
</p>
</li>
<li> <p><code>loglik</code>: The value of the profile log-likelihood.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pwexploglik(tau = c(0.5, 1.2, 2.8), pweibull, 
            shape = 1.37, scale = 1/0.818, lower.tail = FALSE)

</code></pre>

<hr>
<h2 id='qtpwexp'>Quantile function of truncated piecewise exponential distribution</h2><span id='topic+qtpwexp'></span>

<h3>Description</h3>

<p>Obtains the quantile of a truncated piecewise exponential
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qtpwexp(
  p,
  piecewiseSurvivalTime = 0,
  lambda = 0.0578,
  lowerBound = 0,
  lower.tail = TRUE,
  log.p = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qtpwexp_+3A_p">p</code></td>
<td>
<p>The vector of probabilities.</p>
</td></tr>
<tr><td><code id="qtpwexp_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="qtpwexp_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event. One for
each analysis time interval.</p>
</td></tr>
<tr><td><code id="qtpwexp_+3A_lowerbound">lowerBound</code></td>
<td>
<p>The left truncation time point for the survival time.
Defaults to 0 for no truncation.</p>
</td></tr>
<tr><td><code id="qtpwexp_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical; if TRUE (default), probabilities are P(X &lt;= x),
otherwise, P(X &gt; x).</p>
</td></tr>
<tr><td><code id="qtpwexp_+3A_log.p">log.p</code></td>
<td>
<p>Logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The quantile q such that
P(X &gt; q | X &gt; lowerBound) = 1 - p.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>qtpwexp(p = c(0.205, 0.317), piecewiseSurvivalTime = c(0, 6, 9, 15),
        lambda = c(0.025, 0.04, 0.015, 0.007))

</code></pre>

<hr>
<h2 id='rawdata'>A simulated time-to-event data set with 10 replications</h2><span id='topic+rawdata'></span>

<h3>Description</h3>

<p>A simulated data set with stratification and delayed treatment effect:
</p>

<dl>
<dt><code>iterationNumber</code></dt><dd><p>The iteration number</p>
</dd>
<dt><code>arrivalTime</code></dt><dd><p>The enrollment time for the subject</p>
</dd>
<dt><code>stratum</code></dt><dd><p>The stratum for the subject</p>
</dd>
<dt><code>treatmentGroup</code></dt><dd><p>The treatment group for the subject</p>
</dd>
<dt><code>timeUnderObservation</code></dt><dd><p>The time under observation since
randomization</p>
</dd>
<dt><code>event</code></dt><dd><p>Whether the subject experienced the event</p>
</dd>
<dt><code>dropoutEvent</code></dt><dd><p>Whether the subject dropped out</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>rawdata
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 4910 rows and 7 columns.
</p>

<hr>
<h2 id='remlOddsRatio'>REML estimates of individual proportions with specified odds
ratio</h2><span id='topic+remlOddsRatio'></span>

<h3>Description</h3>

<p>Obtains the restricted maximum likelihood estimates of
individual proportions with specified odds ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remlOddsRatio(
  oddsRatioH0 = 1,
  n1 = NA_real_,
  y1 = NA_real_,
  n2 = NA_real_,
  y2 = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remlOddsRatio_+3A_oddsratioh0">oddsRatioH0</code></td>
<td>
<p>The specified odds ratio.</p>
</td></tr>
<tr><td><code id="remlOddsRatio_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="remlOddsRatio_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="remlOddsRatio_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="remlOddsRatio_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the restricted maximum likelihood estimates
of the response probabilities for the two treatment groups.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
remlOddsRatio(oddsRatioH0 = 1.25, n1 = 10, y1 = 4, n2 = 20, y2 = 2)

</code></pre>

<hr>
<h2 id='remlRateDiff'>REML estimates of individual rates with specified rate
difference</h2><span id='topic+remlRateDiff'></span>

<h3>Description</h3>

<p>Obtains the restricted maximum likelihood estimates of
individual proportions with specified rate difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remlRateDiff(
  rateDiffH0 = 0,
  t1 = NA_real_,
  y1 = NA_real_,
  t2 = NA_real_,
  y2 = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remlRateDiff_+3A_ratediffh0">rateDiffH0</code></td>
<td>
<p>The specified rate difference.</p>
</td></tr>
<tr><td><code id="remlRateDiff_+3A_t1">t1</code></td>
<td>
<p>The exposure for the active treatment group.</p>
</td></tr>
<tr><td><code id="remlRateDiff_+3A_y1">y1</code></td>
<td>
<p>The number of events for the active treatment group.</p>
</td></tr>
<tr><td><code id="remlRateDiff_+3A_t2">t2</code></td>
<td>
<p>The exposure for the control group.</p>
</td></tr>
<tr><td><code id="remlRateDiff_+3A_y2">y2</code></td>
<td>
<p>The number of events for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the restricted maximum likelihood estimates
of the incidence rates for the two treatment groups.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
remlRateDiff(rateDiffH0 = 0.1, t1 = 10, y1 = 4, t2 = 20, y2 = 2)

</code></pre>

<hr>
<h2 id='remlRateRatio'>REML estimates of individual rates with specified rate
ratio</h2><span id='topic+remlRateRatio'></span>

<h3>Description</h3>

<p>Obtains the restricted maximum likelihood estimates of
individual proportions with specified rate ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remlRateRatio(
  rateRatioH0 = 1,
  t1 = NA_real_,
  y1 = NA_real_,
  t2 = NA_real_,
  y2 = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remlRateRatio_+3A_rateratioh0">rateRatioH0</code></td>
<td>
<p>The specified rate ratio.</p>
</td></tr>
<tr><td><code id="remlRateRatio_+3A_t1">t1</code></td>
<td>
<p>The exposure for the active treatment group.</p>
</td></tr>
<tr><td><code id="remlRateRatio_+3A_y1">y1</code></td>
<td>
<p>The number of events for the active treatment group.</p>
</td></tr>
<tr><td><code id="remlRateRatio_+3A_t2">t2</code></td>
<td>
<p>The exposure for the control group.</p>
</td></tr>
<tr><td><code id="remlRateRatio_+3A_y2">y2</code></td>
<td>
<p>The number of events for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the restricted maximum likelihood estimates
of the incidence rates for the two treatment groups.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
remlRateRatio(rateRatioH0 = 1.1, t1 = 10, y1 = 4, t2 = 20, y2 = 2)

</code></pre>

<hr>
<h2 id='remlRiskDiff'>REML estimates of individual proportions with specified risk
difference</h2><span id='topic+remlRiskDiff'></span>

<h3>Description</h3>

<p>Obtains the restricted maximum likelihood estimates of
individual proportions with specified risk difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remlRiskDiff(
  riskDiffH0 = 0,
  n1 = NA_real_,
  y1 = NA_real_,
  n2 = NA_real_,
  y2 = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remlRiskDiff_+3A_riskdiffh0">riskDiffH0</code></td>
<td>
<p>The specified risk difference.</p>
</td></tr>
<tr><td><code id="remlRiskDiff_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="remlRiskDiff_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="remlRiskDiff_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="remlRiskDiff_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the restricted maximum likelihood estimates
of the response probabilities for the two treatment groups.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
remlRiskDiff(riskDiffH0 = 0.1, n1 = 10, y1 = 4, n2 = 20, y2 = 0)

</code></pre>

<hr>
<h2 id='remlRiskRatio'>REML estimates of individual proportions with specified risk
ratio</h2><span id='topic+remlRiskRatio'></span>

<h3>Description</h3>

<p>Obtains the restricted maximum likelihood estimates of
individual proportions with specified risk ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remlRiskRatio(
  riskRatioH0 = 1,
  n1 = NA_real_,
  y1 = NA_real_,
  n2 = NA_real_,
  y2 = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remlRiskRatio_+3A_riskratioh0">riskRatioH0</code></td>
<td>
<p>The specified risk ratio.</p>
</td></tr>
<tr><td><code id="remlRiskRatio_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="remlRiskRatio_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="remlRiskRatio_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="remlRiskRatio_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the restricted maximum likelihood estimates
of the response probabilities for the two treatment groups.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
remlRiskRatio(riskRatioH0 = 1.2, n1 = 10, y1 = 4, n2 = 20, y2 = 2)

</code></pre>

<hr>
<h2 id='repeatedPValue'>Repeated p-values for group sequential design</h2><span id='topic+repeatedPValue'></span>

<h3>Description</h3>

<p>Obtains the repeated p-values for a group sequential design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>repeatedPValue(
  kMax,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA,
  maxInformation = 1,
  p,
  information,
  spendingTime = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="repeatedPValue_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="repeatedPValue_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="repeatedPValue_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="repeatedPValue_+3A_maxinformation">maxInformation</code></td>
<td>
<p>The target maximum information. Defaults to 1,
in which case, <code>information</code> represents <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="repeatedPValue_+3A_p">p</code></td>
<td>
<p>The raw p-values at look 1 to look <code>k</code>. It can be a matrix
with <code>k</code> columns for <code>k &lt;= kMax</code>.</p>
</td></tr>
<tr><td><code id="repeatedPValue_+3A_information">information</code></td>
<td>
<p>The observed information by look. It can be a matrix
with <code>k</code> columns.</p>
</td></tr>
<tr><td><code id="repeatedPValue_+3A_spendingtime">spendingTime</code></td>
<td>
<p>The error spending time at each analysis, must be
increasing and less than or equal to 1. Defaults to NULL,
in which case, it is the same as <code>informationRates</code> derived from
<code>information</code> and <code>maxInformation</code>. It can be a matrix with
<code>k</code> columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The repeated p-values at look 1 to look <code>k</code>.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: informationRates different from spendingTime
repeatedPValue(kMax = 3, typeAlphaSpending = "sfOF",
               maxInformation = 800,
               p = c(0.2, 0.15, 0.1),
               information = c(529, 700, 800),
               spendingTime = c(0.6271186, 0.8305085, 1))

# Example 2: Maurer &amp; Bretz (2013), current look is not the last look
repeatedPValue(kMax = 3, typeAlphaSpending = "sfOF",
               p = matrix(c(0.0062, 0.017,
                            0.009, 0.13,
                            0.0002, 0.0035,
                            0.002, 0.06),
                          nrow=4, ncol=2),
               information = c(1/3, 2/3))

</code></pre>

<hr>
<h2 id='riskDiffExactCI'>Exact unconditional confidence interval for risk difference</h2><span id='topic+riskDiffExactCI'></span>

<h3>Description</h3>

<p>Obtains the exact unconditional confidence interval for
risk difference based on the standardized score statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>riskDiffExactCI(
  n1 = NA_integer_,
  y1 = NA_integer_,
  n2 = NA_integer_,
  y2 = NA_integer_,
  cilevel = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="riskDiffExactCI_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="riskDiffExactCI_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="riskDiffExactCI_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="riskDiffExactCI_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
<tr><td><code id="riskDiffExactCI_+3A_cilevel">cilevel</code></td>
<td>
<p>The confidence interval level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables:
</p>

<ul>
<li> <p><code>scale</code>: The scale of treatment effect.
</p>
</li>
<li> <p><code>estimate</code>: The point estimate.
</p>
</li>
<li> <p><code>lower</code>: The lower limit of the confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper limit of the confidence interval.
</p>
</li>
<li> <p><code>cilevel</code>: The confidence interval level.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
riskDiffExactCI(n1 = 68, y1 = 2, n2 = 65, y2 = 1, cilevel = 0.95)

</code></pre>

<hr>
<h2 id='riskDiffExactPValue'>P-value for exact unconditional test of risk difference</h2><span id='topic+riskDiffExactPValue'></span>

<h3>Description</h3>

<p>Obtains the p-value for exact unconditional
test of risk difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>riskDiffExactPValue(
  riskDiffH0 = 0,
  directionUpper = 1L,
  n1 = NA_integer_,
  y1 = NA_integer_,
  n2 = NA_integer_,
  y2 = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="riskDiffExactPValue_+3A_riskdiffh0">riskDiffH0</code></td>
<td>
<p>The risk difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="riskDiffExactPValue_+3A_directionupper">directionUpper</code></td>
<td>
<p>Whether larger values represent better
responses.</p>
</td></tr>
<tr><td><code id="riskDiffExactPValue_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="riskDiffExactPValue_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="riskDiffExactPValue_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="riskDiffExactPValue_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables:
</p>

<ul>
<li> <p><code>riskDiffH0</code>: The risk difference under the null hypothesis.
</p>
</li>
<li> <p><code>directionUpper</code>: Whether larger values represent better
responses.
</p>
</li>
<li> <p><code>riskDiff</code>: The observed risk difference.
</p>
</li>
<li> <p><code>zstat</code>: The observed value of the Z test statistic.
</p>
</li>
<li> <p><code>pvalue</code>: The one-sided p-value for the unconditional exact test.
</p>
</li>
<li> <p><code>pi2star</code>: The value of pi2 that yields the p-value.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
riskDiffExactPValue(riskDiffH0 = 0, directionUpper = 1,
                    n1 = 68, y1 = 2, n2 = 65, y2 = 1)

</code></pre>

<hr>
<h2 id='riskRatioExactCI'>Exact unconditional confidence interval for risk ratio</h2><span id='topic+riskRatioExactCI'></span>

<h3>Description</h3>

<p>Obtains the exact unconditional confidence interval for
risk ratio based on the standardized score statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>riskRatioExactCI(
  n1 = NA_integer_,
  y1 = NA_integer_,
  n2 = NA_integer_,
  y2 = NA_integer_,
  cilevel = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="riskRatioExactCI_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="riskRatioExactCI_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="riskRatioExactCI_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="riskRatioExactCI_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
<tr><td><code id="riskRatioExactCI_+3A_cilevel">cilevel</code></td>
<td>
<p>The confidence interval level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables:
</p>

<ul>
<li> <p><code>scale</code>: The scale of treatment effect.
</p>
</li>
<li> <p><code>estimate</code>: The point estimate.
</p>
</li>
<li> <p><code>lower</code>: The lower limit of the confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper limit of the confidence interval.
</p>
</li>
<li> <p><code>cilevel</code>: The confidence interval level.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
riskRatioExactCI(n1 = 68, y1 = 2, n2 = 65, y2 = 1, cilevel = 0.95)

</code></pre>

<hr>
<h2 id='riskRatioExactPValue'>P-value for exact unconditional test of risk ratio</h2><span id='topic+riskRatioExactPValue'></span>

<h3>Description</h3>

<p>Obtains the p-value for exact unconditional
test of risk ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>riskRatioExactPValue(
  riskRatioH0 = 1,
  directionUpper = 1L,
  n1 = NA_integer_,
  y1 = NA_integer_,
  n2 = NA_integer_,
  y2 = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="riskRatioExactPValue_+3A_riskratioh0">riskRatioH0</code></td>
<td>
<p>The risk ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="riskRatioExactPValue_+3A_directionupper">directionUpper</code></td>
<td>
<p>Whether larger values represent better
responses.</p>
</td></tr>
<tr><td><code id="riskRatioExactPValue_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="riskRatioExactPValue_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="riskRatioExactPValue_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="riskRatioExactPValue_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables:
</p>

<ul>
<li> <p><code>riskRatioH0</code>: The risk ratio under the null hypothesis.
</p>
</li>
<li> <p><code>directionUpper</code>: Whether larger values represent better
responses.
</p>
</li>
<li> <p><code>riskRatio</code>: The observed risk ratio.
</p>
</li>
<li> <p><code>zstat</code>: The observed value of the Z test statistic.
</p>
</li>
<li> <p><code>pvalue</code>: The one-sided p-value for the unconditional exact test.
</p>
</li>
<li> <p><code>pi2star</code>: The value of pi2 that yields the p-value.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
riskRatioExactPValue(riskRatioH0 = 1, directionUpper = 1,
                     n1 = 68, y1 = 2, n2 = 65, y2 = 1)

</code></pre>

<hr>
<h2 id='rmdiff'>Estimate of restricted mean survival time difference</h2><span id='topic+rmdiff'></span>

<h3>Description</h3>

<p>Obtains the estimate of restricted mean survival time
difference between two treatment groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmdiff(
  data,
  rep = "rep",
  stratum = "stratum",
  treat = "treat",
  time = "time",
  event = "event",
  milestone = NA_real_,
  rmstDiffH0 = 0,
  confint = 0.95,
  biascorrection = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmdiff_+3A_data">data</code></td>
<td>
<p>The input data frame that contains the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication for by-group processing.
</p>
</li>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>treat</code>: The treatment.
</p>
</li>
<li> <p><code>time</code>: The possibly right-censored survival time.
</p>
</li>
<li> <p><code>event</code>: The event indicator.
</p>
</li></ul>
</td></tr>
<tr><td><code id="rmdiff_+3A_rep">rep</code></td>
<td>
<p>The name of the replication variable in the input data.</p>
</td></tr>
<tr><td><code id="rmdiff_+3A_stratum">stratum</code></td>
<td>
<p>The name of the stratum variable in the input data.</p>
</td></tr>
<tr><td><code id="rmdiff_+3A_treat">treat</code></td>
<td>
<p>The name of the treatment variable in the input data.</p>
</td></tr>
<tr><td><code id="rmdiff_+3A_time">time</code></td>
<td>
<p>The name of the time variable in the input data.</p>
</td></tr>
<tr><td><code id="rmdiff_+3A_event">event</code></td>
<td>
<p>The name of the event variable in the input data.</p>
</td></tr>
<tr><td><code id="rmdiff_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
restricted mean survival time.</p>
</td></tr>
<tr><td><code id="rmdiff_+3A_rmstdiffh0">rmstDiffH0</code></td>
<td>
<p>The difference in restricted mean survival times
under the null hypothesis. Defaults to 0 for superiority test.</p>
</td></tr>
<tr><td><code id="rmdiff_+3A_confint">confint</code></td>
<td>
<p>The level of the two-sided confidence interval for
the difference in restricted mean survival times. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="rmdiff_+3A_biascorrection">biascorrection</code></td>
<td>
<p>Whether to apply bias correction for the
variance estimate of individual restricted mean survival times.
Defaults to no bias correction.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication number.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>rmstDiffH0</code>: The difference in restricted mean survival times
under the null hypothesis.
</p>
</li>
<li> <p><code>rmst1</code>: The estimated restricted mean survival time for
the treatment group.
</p>
</li>
<li> <p><code>rmst2</code>: The estimated restricted mean survival time for
the control group.
</p>
</li>
<li> <p><code>rmstDiff</code>: The estimated difference in restricted mean
survival times.
</p>
</li>
<li> <p><code>vrmst1</code>: The variance for rmst1.
</p>
</li>
<li> <p><code>vrmst2</code>: The variance for rmst2.
</p>
</li>
<li> <p><code>vrmstDiff</code>: The variance for rmstDiff.
</p>
</li>
<li> <p><code>rmstDiffZ</code>: The Z-statistic value.
</p>
</li>
<li> <p><code>rmstDiffPValue</code>: The one-sided p-value.
</p>
</li>
<li> <p><code>lower</code>: The lower bound of confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper bound of confidence interval.
</p>
</li>
<li> <p><code>confint</code>: The level of confidence interval.
</p>
</li>
<li> <p><code>biascorrection</code>: Whether to apply bias correction for the
variance estimate of individual restricted mean survival times.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- rmdiff(data = rawdata, rep = "iterationNumber",
             stratum = "stratum", treat = "treatmentGroup",
             time = "timeUnderObservation", event = "event",
             milestone = 12)
head(df)

</code></pre>

<hr>
<h2 id='rmest'>Estimate of restricted mean survival time</h2><span id='topic+rmest'></span>

<h3>Description</h3>

<p>Obtains the estimate of restricted means survival time
for each stratum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmest(
  data,
  rep = "rep",
  stratum = "stratum",
  time = "time",
  event = "event",
  milestone = NA_real_,
  confint = 0.95,
  biascorrection = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmest_+3A_data">data</code></td>
<td>
<p>The input data frame that contains the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication for by-group processing.
</p>
</li>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The possibly right-censored survival time.
</p>
</li>
<li> <p><code>event</code>: The event indicator.
</p>
</li></ul>
</td></tr>
<tr><td><code id="rmest_+3A_rep">rep</code></td>
<td>
<p>The name of the replication variable in the input data.</p>
</td></tr>
<tr><td><code id="rmest_+3A_stratum">stratum</code></td>
<td>
<p>The name of the stratum variable in the input data.</p>
</td></tr>
<tr><td><code id="rmest_+3A_time">time</code></td>
<td>
<p>The name of the time variable in the input data.</p>
</td></tr>
<tr><td><code id="rmest_+3A_event">event</code></td>
<td>
<p>The name of the event variable in the input data.</p>
</td></tr>
<tr><td><code id="rmest_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
restricted mean survival time.</p>
</td></tr>
<tr><td><code id="rmest_+3A_confint">confint</code></td>
<td>
<p>The level of the two-sided confidence interval for
the survival probabilities. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="rmest_+3A_biascorrection">biascorrection</code></td>
<td>
<p>Whether to apply bias correction for the
variance estimate. Defaults to no bias correction.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>rep</code>: The replication.
</p>
</li>
<li> <p><code>stratum</code>: The stratum variable.
</p>
</li>
<li> <p><code>size</code>: The number of subjects in the stratum.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>rmst</code>: The estimate of restricted mean survival time.
</p>
</li>
<li> <p><code>stderr</code>: The standard error of the estimated rmst.
</p>
</li>
<li> <p><code>lower</code>: The lower bound of confidence interval if requested.
</p>
</li>
<li> <p><code>upper</code>: The upper bound of confidence interval if requested.
</p>
</li>
<li> <p><code>confint</code>: The level of confidence interval if requested.
</p>
</li>
<li> <p><code>biascorrection</code>: Whether to apply bias correction for the
variance estimate.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rmest(data = aml, stratum = "x",
      time = "time", event = "status", milestone = 24)

</code></pre>

<hr>
<h2 id='rmpower'>Power for difference in restricted mean survival times</h2><span id='topic+rmpower'></span>

<h3>Description</h3>

<p>Estimates the power for testing the difference in
restricted mean survival times in a two-sample survival design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmpower(
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  milestone = NA_real_,
  rmstDiffH0 = 0,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  spendingTime = NA_real_,
  studyDuration = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmpower_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock
type spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and &quot;none&quot; for no
early futility stopping. Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
restricted mean survival time.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_rmstdiffh0">rmstDiffH0</code></td>
<td>
<p>The difference in restricted mean survival times
under the null hypothesis. Defaults to 0 for superiority test.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="rmpower_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="rmpower_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>rmpower</code> object with 3 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>(rmstDiff - rmstDiffH0)*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up duration.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>rmstDiffH0</code>: The difference in restricted mean survival
times under the null hypothesis.
</p>
</li>
<li> <p><code>rmst1</code>: The restricted mean survival time for the
treatment group.
</p>
</li>
<li> <p><code>rmst2</code>: The restricted mean survival time for the
control group.
</p>
</li>
<li> <p><code>rmstDiff</code>: The difference in restricted mean survival times,
equal to <code>rmst1 - rmst2</code>.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacyRmstDiff</code>: The efficacy boundaries on the restricted
mean survival time difference scale.
</p>
</li>
<li> <p><code>futilityRmstDiff</code>: The futility boundaries on the restricted
mean survival time difference scale.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>typeBetaSpending</code>,
<code>parameterBetaSpending</code>, <code>allocationRatioPlanned</code>,
<code>accrualTime</code>, <code>accuralIntensity</code>,
<code>piecewiseSurvivalTime</code>, <code>stratumFraction</code>,
<code>lambda1</code>, <code>lambda2</code>, <code>gamma1</code>, <code>gamma2</code>,
and <code>spendingTime</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survival, and 5% dropout by
# the end of 1 year.

rmpower(kMax = 2, informationRates = c(0.8, 1),
        alpha = 0.025, typeAlphaSpending = "sfOF",
        milestone = 18,
        allocationRatioPlanned = 1, accrualTime = seq(0, 8),
        accrualIntensity = 100/9*seq(1, 9),
        piecewiseSurvivalTime = c(0, 6),
        stratumFraction = c(0.2, 0.8),
        lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
        lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
        gamma1 = -log(1-0.05)/12,
        gamma2 = -log(1-0.05)/12, accrualDuration = 22,
        followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='rmpower1s'>Power for one-sample restricted mean survival time</h2><span id='topic+rmpower1s'></span>

<h3>Description</h3>

<p>Estimates the power, stopping probabilities, and expected
sample size in a one-group survival design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmpower1s(
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  milestone = NA_real_,
  rmstH0 = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda = NA_real_,
  gamma = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  spendingTime = NA_real_,
  studyDuration = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmpower1s_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock
type spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, and &quot;none&quot; for no
early futility stopping. Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
restricted mean survival time.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_rmsth0">rmstH0</code></td>
<td>
<p>The restricted mean survival time under the null
hypothesis.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout or a vector of
hazard rates for piecewise exponential dropout. Defaults to 0 for
no dropout.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="rmpower1s_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>rmpower1s</code> object with 3 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>drift</code>: The drift parameter, equal to
<code>(rmst - rmstH0)*sqrt(information)</code>.
</p>
</li>
<li> <p><code>inflationFactor</code>: The inflation factor (relative to the
fixed design).
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up duration.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>rmstH0</code>: The restricted mean survival time under the null
hypothesis.
</p>
</li>
<li> <p><code>rmst</code>: The restricted mean survival time under the
alternative hypothesis.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale.
</p>
</li>
<li> <p><code>futilityBounds</code>: The futility boundaries on the Z-scale.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>futilityPerStage</code>: The probability for futility stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeFutility</code>: The cumulative probability for futility
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha spent.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacyRmst</code>: The efficacy boundaries on the restricted
mean survival time.
</p>
</li>
<li> <p><code>futilityRmst</code>: The futility boundaries on the restricted
mean survival time.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy boundaries on the p-value scale.
</p>
</li>
<li> <p><code>futilityP</code>: The futility boundaries on the p-value scale.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li>
<li> <p><code>efficacyStopping</code>: Whether to allow efficacy stopping.
</p>
</li>
<li> <p><code>futilityStopping</code>: Whether to allow futility stopping.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>typeBetaSpending</code>,
<code>parameterBetaSpending</code>, <code>accrualTime</code>,
<code>accuralIntensity</code>, <code>piecewiseSurvivalTime</code>,
<code>stratumFraction</code>, <code>lambda</code>, <code>gamma</code>,
and <code>spendingTime</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmstat">rmstat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rmpower1s(kMax = 2, informationRates = c(0.8, 1),
          alpha = 0.025, typeAlphaSpending = "sfOF",
          milestone = 18, rmstH0 = 10,
          accrualTime = seq(0, 8),
          accrualIntensity = 26/9*seq(1, 9),
          piecewiseSurvivalTime = c(0, 6),
          stratumFraction = c(0.2, 0.8),
          lambda = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
          gamma = -log(1-0.05)/12, accrualDuration = 22,
          followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='rmpowerequiv'>Power for equivalence in restricted mean survival time difference</h2><span id='topic+rmpowerequiv'></span>

<h3>Description</h3>

<p>Obtains the power for equivalence in restricted mean
survival time difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmpowerequiv(
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  milestone = NA_real_,
  rmstDiffLower = NA_real_,
  rmstDiffUpper = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  spendingTime = NA_real_,
  studyDuration = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmpowerequiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
restricted mean survival time.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_rmstdifflower">rmstDiffLower</code></td>
<td>
<p>The lower equivalence limit of restricted mean
survival time difference.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_rmstdiffupper">rmstDiffUpper</code></td>
<td>
<p>The upper equivalence limit of restricted mean
survival time difference.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="rmpowerequiv_+3A_studyduration">studyDuration</code></td>
<td>
<p>Study duration for fixed follow-up design.
Defaults to missing, which is to be replaced with the sum of
<code>accrualDuration</code> and <code>followupTime</code>. If provided,
the value is allowed to be less than the sum of <code>accrualDuration</code>
and <code>followupTime</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>rmpowerequiv</code> object with 3 components:
</p>

<ul>
<li> <p><code>overallResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>overallReject</code>: The overall rejection probability.
</p>
</li>
<li> <p><code>alpha</code>: The overall significance level.
</p>
</li>
<li> <p><code>attainedAlphaH10</code>: The attained significance level under H10.
</p>
</li>
<li> <p><code>attainedAlphaH20</code>: The attained significance level under H20.
</p>
</li>
<li> <p><code>numbeOfSubjects</code>: The total number of subjects.
</p>
</li>
<li> <p><code>studyDuration</code>: The total study duration.
</p>
</li>
<li> <p><code>information</code>: The maximum information.
</p>
</li>
<li> <p><code>expectedNumberOfSubjects</code>: The expected number of subjects.
</p>
</li>
<li> <p><code>expectedStudyDuration</code>: The expected study duration.
</p>
</li>
<li> <p><code>expectedInformation</code>: The expected information.
</p>
</li>
<li> <p><code>kMax</code>: The number of stages.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>rmstDiffLower</code>: The lower equivalence limit of restricted
mean survival time difference.
</p>
</li>
<li> <p><code>rmstDiffUpper</code>: The upper equivalence limit of restricted
mean survival time difference.
</p>
</li>
<li> <p><code>rmst1</code>: The restricted mean survival time for the
treatment group.
</p>
</li>
<li> <p><code>rmst2</code>: The restricted mean survival time for the
control group.
</p>
</li>
<li> <p><code>rmstDiff</code>: The restricted mean survival time difference.
</p>
</li>
<li> <p><code>accrualDuration</code>: The accrual duration.
</p>
</li>
<li> <p><code>followupTime</code>: The follow-up duration.
</p>
</li>
<li> <p><code>fixedFollowup</code>: Whether a fixed follow-up design is used.
</p>
</li></ul>

</li>
<li> <p><code>byStageResults</code>: A data frame containing the following variables:
</p>

<ul>
<li> <p><code>informationRates</code>: The information rates.
</p>
</li>
<li> <p><code>efficacyBounds</code>: The efficacy boundaries on the Z-scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>rejectPerStage</code>: The probability for efficacy stopping.
</p>
</li>
<li> <p><code>cumulativeRejection</code>: The cumulative probability for efficacy
stopping.
</p>
</li>
<li> <p><code>cumulativeAlphaSpent</code>: The cumulative alpha for each of
the two one-sided tests.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH10</code>: The cumulative alpha attained
under <code>H10</code>.
</p>
</li>
<li> <p><code>cumulativeAttainedAlphaH20</code>: The cumulative alpha attained
under <code>H20</code>.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li>
<li> <p><code>analysisTime</code>: The average time since trial start.
</p>
</li>
<li> <p><code>efficacyRmstDiffLower</code>: The efficacy boundaries on the
restricted mean survival time difference scale for the one-sided
null hypothesis at the lower equivalence limit.
</p>
</li>
<li> <p><code>efficacyRmstDiffUpper</code>: The efficacy boundaries on the
restricted mean survival time difference scale for the one-sided
null hypothesis at the upper equivalence limit.
</p>
</li>
<li> <p><code>efficacyP</code>: The efficacy bounds on the p-value scale for
each of the two one-sided tests.
</p>
</li>
<li> <p><code>information</code>: The cumulative information.
</p>
</li></ul>

</li>
<li> <p><code>settings</code>: A list containing the following input parameters:
<code>typeAlphaSpending</code>, <code>parameterAlphaSpending</code>,
<code>userAlphaSpending</code>, <code>allocationRatioPlanned</code>,
<code>accrualTime</code>, <code>accuralIntensity</code>,
<code>piecewiseSurvivalTime</code>, <code>stratumFraction</code>,
<code>lambda1</code>, <code>lambda2</code>, <code>gamma1</code>, <code>gamma2</code>,
and <code>spendingTime</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmstat">rmstat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rmpowerequiv(kMax = 2, informationRates = c(0.5, 1),
             alpha = 0.05, typeAlphaSpending = "sfOF",
             milestone = 18,
             rmstDiffLower = -2, rmstDiffUpper = 2,
             allocationRatioPlanned = 1, accrualTime = seq(0, 8),
             accrualIntensity = 100/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12, accrualDuration = 22,
             followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='rmsamplesize'>Sample size for difference in restricted mean survival times</h2><span id='topic+rmsamplesize'></span>

<h3>Description</h3>

<p>Obtains the needed accrual duration given power,
accrual intensity, and follow-up time, the needed follow-up time
given power, accrual intensity, and accrual duration, or the needed
absolute accrual intensity given power, relative accrual intensity,
accrual duration, and follow-up time in a two-group survival design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmsamplesize(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  milestone = NA_real_,
  rmstDiffH0 = 0,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmsamplesize_+3A_beta">beta</code></td>
<td>
<p>Type II error. Defaults to 0.2.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
restricted mean survival time.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_rmstdiffh0">rmstDiffH0</code></td>
<td>
<p>The difference in restricted mean survival times
under the null hypothesis. Defaults to 0 for superiority test.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupTime, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="rmsamplesize_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size.
Defaults to 1 for sample size rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two components:
</p>

<ul>
<li> <p><code>resultsUnderH1</code>: An S3 class <code>rmpower</code> object under the
alternative hypothesis.
</p>
</li>
<li> <p><code>resultsUnderH0</code>: An S3 class <code>rmpower</code> object under the
null hypothesis.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmpower">rmpower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Obtains follow-up time given power, accrual intensity,
# and accrual duration for variable follow-up. Of note, the power
# reaches the maximum when the follow-up time equals milestone.

rmsamplesize(beta = 0.2, kMax = 2, informationRates = c(0.8, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             milestone = 18,
             allocationRatioPlanned = 1, accrualTime = seq(0, 8),
             accrualIntensity = 100/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12, accrualDuration = 22,
             followupTime = NA, fixedFollowup = FALSE)

# Example 2: Obtains accrual intensity given power, accrual duration, and
# follow-up time for variable follow-up

rmsamplesize(beta = 0.2, kMax = 2, informationRates = c(0.8, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             milestone = 18,
             allocationRatioPlanned = 1, accrualTime = seq(0, 8),
             accrualIntensity = 100/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12, accrualDuration = 22,
             followupTime = 18, fixedFollowup = FALSE)


# Example 3: Obtains accrual duration given power, accrual intensity, and
# follow-up time for fixed follow-up

rmsamplesize(beta = 0.2, kMax = 2, informationRates = c(0.8, 1),
             alpha = 0.025, typeAlphaSpending = "sfOF",
             milestone = 18,
             allocationRatioPlanned = 1, accrualTime = seq(0, 8),
             accrualIntensity = 100/9*seq(1, 9),
             piecewiseSurvivalTime = c(0, 6),
             stratumFraction = c(0.2, 0.8),
             lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
             lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
             gamma1 = -log(1-0.05)/12,
             gamma2 = -log(1-0.05)/12, accrualDuration = NA,
             followupTime = 18, fixedFollowup = TRUE)

</code></pre>

<hr>
<h2 id='rmsamplesize1s'>Sample size for one-sample restricted mean survival time</h2><span id='topic+rmsamplesize1s'></span>

<h3>Description</h3>

<p>Obtains the needed accrual duration given power and
follow-up time, the needed follow-up time given power and
accrual duration, or the needed absolute accrual rates given
power, accrual duration, follow-up duration, and relative accrual
rates in a one-group survival design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmsamplesize1s(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  efficacyStopping = NA_integer_,
  futilityStopping = NA_integer_,
  criticalValues = NA_real_,
  alpha = 0.025,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  futilityBounds = NA_real_,
  typeBetaSpending = "none",
  parameterBetaSpending = NA_real_,
  userBetaSpending = NA_real_,
  milestone = NA_real_,
  rmstH0 = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda = NA_real_,
  gamma = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmsamplesize1s_+3A_beta">beta</code></td>
<td>
<p>Type II error. Defaults to 0.2.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_efficacystopping">efficacyStopping</code></td>
<td>
<p>Indicators of whether efficacy stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_futilitystopping">futilityStopping</code></td>
<td>
<p>Indicators of whether futility stopping is allowed
at each stage. Defaults to true if left unspecified.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. Defaults to 0.025.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_futilitybounds">futilityBounds</code></td>
<td>
<p>Lower boundaries on the z-test statistic scale
for stopping for futility at stages 1, ..., <code>kMax-1</code>. Defaults to
<code>rep(-6, kMax-1)</code> if left unspecified. The futility bounds are
non-binding for the calculation of critical values.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_typebetaspending">typeBetaSpending</code></td>
<td>
<p>The type of beta spending. One of the following:
&quot;sfOF&quot; for O'Brien-Fleming type spending function, &quot;sfP&quot; for Pocock type
spending function, &quot;sfKD&quot; for Kim &amp; DeMets spending function,
&quot;sfHSD&quot; for Hwang, Shi &amp; DeCani spending function, &quot;user&quot; for
user defined spending, and &quot;none&quot; for no early futility stopping.
Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_parameterbetaspending">parameterBetaSpending</code></td>
<td>
<p>The parameter value for the beta spending.
Corresponds to rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_userbetaspending">userBetaSpending</code></td>
<td>
<p>The user defined beta spending. Cumulative beta
spent up to each stage.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
restricted survival time.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_rmsth0">rmstH0</code></td>
<td>
<p>The restricted mean survival time under the null
hypothesis.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_gamma">gamma</code></td>
<td>
<p>The hazard rate for exponential dropout or a vector of
hazard rates for piecewise exponential dropout. Defaults to 0 for
no dropout.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupDuration, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="rmsamplesize1s_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size.
Defaults to 1 for sample size rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two components:
</p>

<ul>
<li> <p><code>resultsUnderH1</code>: An S3 class <code>rmpower1s</code> object under the
alternative hypothesis.
</p>
</li>
<li> <p><code>resultsUnderH0</code>: An S3 class <code>rmpower1s</code> object under the
null hypothesis.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmpower1s">rmpower1s</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Obtains follow-up duration given power, accrual intensity,
# and accrual duration for variable follow-up

rmsamplesize1s(beta = 0.2, kMax = 2,
               informationRates = c(0.8, 1),
               alpha = 0.025, typeAlphaSpending = "sfOF",
               milestone = 18, rmstH0 = 10,
               accrualTime = seq(0, 8),
               accrualIntensity = 26/9*seq(1, 9),
               piecewiseSurvivalTime = c(0, 6),
               stratumFraction = c(0.2, 0.8),
               lambda = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
               gamma = -log(1-0.05)/12, accrualDuration = 22,
               followupTime = NA, fixedFollowup = FALSE)

# Example 2: Obtains accrual intensity given power, accrual duration, and
# follow-up duration for variable follow-up

rmsamplesize1s(beta = 0.2, kMax = 2,
               informationRates = c(0.8, 1),
               alpha = 0.025, typeAlphaSpending = "sfOF",
               milestone = 18, rmstH0 = 10,
               accrualTime = seq(0, 8),
               accrualIntensity = 26/9*seq(1, 9),
               piecewiseSurvivalTime = c(0, 6),
               stratumFraction = c(0.2, 0.8),
               lambda = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
               gamma = -log(1-0.05)/12, accrualDuration = 22,
               followupTime = 18, fixedFollowup = FALSE)


# Example 3: Obtains accrual duration given power, accrual intensity, and
# follow-up duration for fixed follow-up

rmsamplesize1s(beta = 0.2, kMax = 2,
               informationRates = c(0.8, 1),
               alpha = 0.025, typeAlphaSpending = "sfOF",
               milestone = 18, rmstH0 = 10,
               accrualTime = seq(0, 8),
               accrualIntensity = 26/9*seq(1, 9),
               piecewiseSurvivalTime = c(0, 6),
               stratumFraction = c(0.2, 0.8),
               lambda = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
               gamma = -log(1-0.05)/12, accrualDuration = NA,
               followupTime = 18, fixedFollowup = TRUE)

</code></pre>

<hr>
<h2 id='rmsamplesizeequiv'>Sample size for equivalence in restricted mean survival time
difference</h2><span id='topic+rmsamplesizeequiv'></span>

<h3>Description</h3>

<p>Obtains the sample size for equivalence in restricted
mean survival time difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmsamplesizeequiv(
  beta = 0.2,
  kMax = 1L,
  informationRates = NA_real_,
  criticalValues = NA_real_,
  alpha = 0.05,
  typeAlphaSpending = "sfOF",
  parameterAlphaSpending = NA_real_,
  userAlphaSpending = NA_real_,
  milestone = NA_real_,
  rmstDiffLower = NA_real_,
  rmstDiffUpper = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L,
  interval = as.numeric(c(0.001, 240)),
  spendingTime = NA_real_,
  rounding = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmsamplesizeequiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_kmax">kMax</code></td>
<td>
<p>The maximum number of stages.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_informationrates">informationRates</code></td>
<td>
<p>The information rates.
Defaults to <code>(1:kMax) / kMax</code> if left unspecified.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_criticalvalues">criticalValues</code></td>
<td>
<p>Upper boundaries on the z-test statistic scale
for stopping for efficacy.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_typealphaspending">typeAlphaSpending</code></td>
<td>
<p>The type of alpha spending. One of the following:
&quot;OF&quot; for O'Brien-Fleming boundaries, &quot;P&quot; for Pocock boundaries,
&quot;WT&quot; for Wang &amp; Tsiatis boundaries, &quot;sfOF&quot; for O'Brien-Fleming type
spending function, &quot;sfP&quot; for Pocock type spending function,
&quot;sfKD&quot; for Kim &amp; DeMets spending function, &quot;sfHSD&quot; for Hwang,
Shi &amp; DeCani spending function, &quot;user&quot; for user defined spending,
and &quot;none&quot; for no early efficacy stopping. Defaults to &quot;sfOF&quot;.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_parameteralphaspending">parameterAlphaSpending</code></td>
<td>
<p>The parameter value for the alpha spending.
Corresponds to Delta for &quot;WT&quot;, rho for &quot;sfKD&quot;, and gamma for &quot;sfHSD&quot;.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_useralphaspending">userAlphaSpending</code></td>
<td>
<p>The user defined alpha spending. Cumulative alpha
spent up to each stage.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
restricted mean survival time.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_rmstdifflower">rmstDiffLower</code></td>
<td>
<p>The lower equivalence limit of restricted mean
survival time difference.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_rmstdiffupper">rmstDiffUpper</code></td>
<td>
<p>The upper equivalence limit of restricted mean
survival time difference.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_interval">interval</code></td>
<td>
<p>The interval to search for the solution of
accrualDuration, followupDuration, or the proportionality constant
of accrualIntensity. Defaults to <code>c(0.001, 240)</code>.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_spendingtime">spendingTime</code></td>
<td>
<p>A vector of length <code>kMax</code> for the error spending
time at each analysis. Defaults to missing, in which case, it is the
same as <code>informationRates</code>.</p>
</td></tr>
<tr><td><code id="rmsamplesizeequiv_+3A_rounding">rounding</code></td>
<td>
<p>Whether to round up sample size.
Defaults to 1 for sample size rounding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 class <code>rmpowerequiv</code> object
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmpowerequiv">rmpowerequiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rmsamplesizeequiv(beta = 0.1, kMax = 2, informationRates = c(0.5, 1),
                  alpha = 0.05, typeAlphaSpending = "sfOF",
                  milestone = 18,
                  rmstDiffLower = -2, rmstDiffUpper = 2,
                  allocationRatioPlanned = 1, accrualTime = seq(0, 8),
                  accrualIntensity = 26/9*seq(1, 9),
                  piecewiseSurvivalTime = c(0, 6),
                  stratumFraction = c(0.2, 0.8),
                  lambda1 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
                  lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
                  gamma1 = -log(1-0.05)/12,
                  gamma2 = -log(1-0.05)/12, accrualDuration = NA,
                  followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='rmst'>Restricted mean survival time</h2><span id='topic+rmst'></span>

<h3>Description</h3>

<p>Obtains the restricted mean survival time over an interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmst(t1 = 0, t2 = NA_real_, piecewiseSurvivalTime = 0L, lambda = NA_real_)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmst_+3A_t1">t1</code></td>
<td>
<p>Lower bound of the analysis time interval.</p>
</td></tr>
<tr><td><code id="rmst_+3A_t2">t2</code></td>
<td>
<p>Upper bound of the analysis time interval.</p>
</td></tr>
<tr><td><code id="rmst_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="rmst_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event. One for
each analysis time interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The integral of the survival function from <code>t1</code> to <code>t2</code>
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rmst(t1 = 0, t2 = 7, piecewiseSurvivalTime = c(0, 6),
     lambda = c(0.0533, 0.0309))

</code></pre>

<hr>
<h2 id='rmstat'>Stratified difference in restricted mean survival times</h2><span id='topic+rmstat'></span>

<h3>Description</h3>

<p>Obtains the stratified restricted mean survival times
and difference in restricted mean survival times at given calendar
times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmstat(
  time = NA_real_,
  milestone = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmstat_+3A_time">time</code></td>
<td>
<p>A vector of calendar times at which to calculate the
restricted mean survival time.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
restricted mean survival time.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="rmstat_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="rmstat_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables:
</p>

<ul>
<li> <p><code>time</code>: The calendar time at which to calculate the restricted
mean survival time.
</p>
</li>
<li> <p><code>subjects</code>: The number of enrolled subjects.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>rmst1</code>: The restricted mean survival time for the treatment
group.
</p>
</li>
<li> <p><code>rmst2</code>: The restricted mean survival time for the control group.
</p>
</li>
<li> <p><code>rmstDiff</code>: The difference in restricted mean survival times,
i.e., <code>rmst1 - rmst2</code>.
</p>
</li>
<li> <p><code>vrmst1</code>: The variance for <code>rmst1</code>.
</p>
</li>
<li> <p><code>vrmst2</code>: The variance for <code>rmst2</code>.
</p>
</li>
<li> <p><code>vrmstDiff</code>: The variance for <code>rmstDiff</code>.
</p>
</li>
<li> <p><code>information</code>: The information for <code>rmstDiff</code>, equal to
<code>1/vrmstDiff</code>.
</p>
</li>
<li> <p><code>rmstDiffZ</code>: The Z-statistic value, i.e.,
<code>rmstDiff/sqrt(vrmstDiff)</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.

rmstat(time = c(22, 40),
       milestone = 18,
       allocationRatioPlanned = 1,
       accrualTime = seq(0, 8),
       accrualIntensity = 26/9*seq(1, 9),
       piecewiseSurvivalTime = c(0, 6),
       stratumFraction = c(0.2, 0.8),
       lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
       lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
       gamma1 = -log(1-0.05)/12,
       gamma2 = -log(1-0.05)/12,
       accrualDuration = 22,
       followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='rmstat1'>Restricted mean survival time by stratum</h2><span id='topic+rmstat1'></span>

<h3>Description</h3>

<p>Obtains the restricted mean survival time and associated
variance by treatment group and by stratum at a given calendar time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmstat1(
  time = NA_real_,
  milestone = NA_real_,
  allocationRatioPlanned = 1,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  piecewiseSurvivalTime = 0L,
  stratumFraction = 1L,
  lambda1 = NA_real_,
  lambda2 = NA_real_,
  gamma1 = 0L,
  gamma2 = 0L,
  accrualDuration = NA_real_,
  followupTime = NA_real_,
  fixedFollowup = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmstat1_+3A_time">time</code></td>
<td>
<p>The calendar time for data cut.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_milestone">milestone</code></td>
<td>
<p>The milestone time at which to calculate the
restricted mean survival time.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_lambda1">lambda1</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_lambda2">lambda2</code></td>
<td>
<p>A vector of hazard rates for the event in each analysis
time interval by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_gamma1">gamma1</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the active treatment group.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_gamma2">gamma2</code></td>
<td>
<p>The hazard rate for exponential dropout, a vector of hazard
rates for piecewise exponential dropout applicable for all strata, or a
vector of hazard rates for dropout in each analysis time interval
by stratum for the control group.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_accrualduration">accrualDuration</code></td>
<td>
<p>Duration of the enrollment period.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_followuptime">followupTime</code></td>
<td>
<p>Follow-up time for the last enrolled subject.</p>
</td></tr>
<tr><td><code id="rmstat1_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>Whether a fixed follow-up design is used.
Defaults to 0 for variable follow-up.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables:
</p>

<ul>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The calendar time since trial start.
</p>
</li>
<li> <p><code>subjects</code>: The number of enrolled subjects.
</p>
</li>
<li> <p><code>milestone</code>: The milestone time relative to randomization.
</p>
</li>
<li> <p><code>rmst1</code>: The restricted mean survival time for the treatment
group.
</p>
</li>
<li> <p><code>rmst2</code>: The restricted mean survival time for the control group.
</p>
</li>
<li> <p><code>rmstDiff</code>: The difference in restricted mean survival times,
i.e., <code>rmst1 - rmst2</code>.
</p>
</li>
<li> <p><code>vrmst1</code>: The variance for <code>rmst1</code>.
</p>
</li>
<li> <p><code>vrmst2</code>: The variance for <code>rmst2</code>.
</p>
</li>
<li> <p><code>vrmstDiff</code>: The variance for <code>rmstDiff</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Piecewise accrual, piecewise exponential survivals, and 5% dropout by
# the end of 1 year.

rmstat1(time = 40,
        milestone = 18,
        allocationRatioPlanned = 1,
        accrualTime = seq(0, 8),
        accrualIntensity = 26/9*seq(1, 9),
        piecewiseSurvivalTime = c(0, 6),
        stratumFraction = c(0.2, 0.8),
        lambda1 = c(0.0533, 0.0309, 1.5*0.0533, 1.5*0.0309),
        lambda2 = c(0.0533, 0.0533, 1.5*0.0533, 1.5*0.0533),
        gamma1 = -log(1-0.05)/12,
        gamma2 = -log(1-0.05)/12,
        accrualDuration = 22,
        followupTime = 18, fixedFollowup = FALSE)

</code></pre>

<hr>
<h2 id='rpsft'>Rank preserving structured failure time model (RPSFTM) for
treatment switching</h2><span id='topic+rpsft'></span>

<h3>Description</h3>

<p>Obtains the causal parameter estimate of the RPSFTM from
the log-rank test and the hazard ratio estimate from the Cox model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpsft(
  data,
  stratum = "stratum",
  time = "time",
  event = "event",
  treat = "treat",
  rx = "rx",
  censor_time = "censor_time",
  base_cov = "none",
  low_psi = -1,
  hi_psi = 1,
  n_eval_z = 100L,
  alpha = 0.05,
  treat_modifier = 1,
  recensor = 1L,
  autoswitch = 1L,
  gridsearch = 0L,
  boot = 0L,
  n_boot = 1000L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpsft_+3A_data">data</code></td>
<td>
<p>The input data frame that contains the following variables:
</p>

<ul>
<li> <p><code>stratum</code>: The stratum.
</p>
</li>
<li> <p><code>time</code>: The survival time for right censored data.
</p>
</li>
<li> <p><code>event</code>: The event indicator, 1=event, 0=no event.
</p>
</li>
<li> <p><code>treat</code>: The randomized treatment indicator, 1=treatment,
0=control.
</p>
</li>
<li> <p><code>rx</code>: The proportion of time on active treatment.
</p>
</li>
<li> <p><code>censor_time</code>: The administrative censoring time. It should
be provided for all subjects including those who had events.
</p>
</li>
<li> <p><code>base_cov</code>: The values of baseline covariates.
This is the full-rank design matrix (excluding treat)
for the Cox model, assuming that factor variables
have already been expanded into dummy variables.
</p>
</li></ul>
</td></tr>
<tr><td><code id="rpsft_+3A_stratum">stratum</code></td>
<td>
<p>The name of the stratum variable in the input data.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_time">time</code></td>
<td>
<p>The name of the time variable in the input data.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_event">event</code></td>
<td>
<p>The name of the event variable in the input data.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_treat">treat</code></td>
<td>
<p>The name of the treatment variable in the input data.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_rx">rx</code></td>
<td>
<p>The name of the rx variable in the input data.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_censor_time">censor_time</code></td>
<td>
<p>The name of the censor_time variable in the input data.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_base_cov">base_cov</code></td>
<td>
<p>The vector of names of baseline covariates (excluding
treat) in the input data.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_low_psi">low_psi</code></td>
<td>
<p>The lower limit of the causal parameter of RPSFTM.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_hi_psi">hi_psi</code></td>
<td>
<p>The upper limit of the causal parameter of RPSFTM.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_n_eval_z">n_eval_z</code></td>
<td>
<p>The number of points between low_psi and hi_psi at which
to evaluate the log-rank Z-statistics.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_alpha">alpha</code></td>
<td>
<p>The significance level to calculate confidence intervals.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_treat_modifier">treat_modifier</code></td>
<td>
<p>The optional sensitivity parameter for the
constant treatment effect assumption.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_recensor">recensor</code></td>
<td>
<p>Whether to apply recensoring to counter-factual
survival times. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_autoswitch">autoswitch</code></td>
<td>
<p>Whether to exclude recensoring for treatment arms
with no switching. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_gridsearch">gridsearch</code></td>
<td>
<p>Whether to use grid search to estimate the causal
parameter psi. Defaults to <code>FALSE</code>, in which case, a root
finding algorithm will be used.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_boot">boot</code></td>
<td>
<p>Whether to use bootstrap to obtain the confidence
interval for hazard ratio. Defaults to <code>FALSE</code>, in which case,
the confidence interval will be constructed to match the log-rank
test p-value.</p>
</td></tr>
<tr><td><code id="rpsft_+3A_n_boot">n_boot</code></td>
<td>
<p>The number of bootstrap samples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We use the following steps to obtain the hazard ratio estimate
and confidence interval had there been no treatment switching:
</p>

<ul>
<li><p> use RPSFTM to estimate the causal parameter psi based on the log-rank
test for counter-factual untreated survival times for both arms:
<code class="reqn">U = T_{off} + T_{on} e^{\psi}</code>.
</p>
</li>
<li><p> Fit the Cox proportional hazards model to the observed survival times
on the treatment arm and the counter-factual untreated survival times
on the control arm to obtain the hazard ratio estimate.
</p>
</li>
<li><p> Use either the log-rank test p-value for the treatment policy strategy
or bootstrap to construct the confidence interval for hazard ratio.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>psi</code>: The estimated causal parameter for RPSFTM.
</p>
</li>
<li> <p><code>psi_CI</code>: The confidence interval for psi.
</p>
</li>
<li> <p><code>psi_type</code>: The type of psi estimate, either &quot;grid search&quot; or
&quot;root finding&quot;.
</p>
</li>
<li> <p><code>Sstar</code>: A data frame containing the counter-factual untreated
survival times and the event indicators.
</p>
</li>
<li> <p><code>kmstar</code>: A data frame containing the Kaplan-Meier estimates
based on the counter-factual untreated survival times by treatment arm.
</p>
</li>
<li> <p><code>eval_z</code>: A data frame containing the log-rank test Z-statistics
evaluated at a sequence of psi values. Used to plot and to check
if the range of psi values to search for the solution and
limits of confidence interval of psi need be modified.
</p>
</li>
<li> <p><code>pvalue</code>: The p-value of the log-rank test based on
the treatment policy strategy.
</p>
</li>
<li> <p><code>hr</code>: The estimated hazard ratio from the Cox model.
</p>
</li>
<li> <p><code>hr_CI</code>: The confidence interval for hazard ratio.
</p>
</li>
<li> <p><code>hr_CI_type</code>: The type of confidence interval for hazard ratio,
either &quot;log-rank p-value&quot; or &quot;bootstrap quantile&quot;.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

data &lt;- immdef %&gt;% mutate(rx = 1-xoyrs/progyrs)

fit &lt;- rpsft(data, time = "progyrs", event = "prog", treat = "imm",
             rx = "rx", censor_time = "censyrs", boot = 0)

c(fit$hr, fit$hr_CI)

</code></pre>

<hr>
<h2 id='rtpwexp'>Random number generation function of truncated piecewise
exponential distribution</h2><span id='topic+rtpwexp'></span>

<h3>Description</h3>

<p>Obtains random samples from a truncated piecewise
exponential distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtpwexp(n, piecewiseSurvivalTime = 0, lambda = 0.0578, lowerBound = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtpwexp_+3A_n">n</code></td>
<td>
<p>The number of observations.</p>
</td></tr>
<tr><td><code id="rtpwexp_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise exponential survival time intervals. Must start with 0, e.g.,
<code>c(0, 6)</code> breaks the time axis into 2 event intervals:
[0, 6) and [6, Inf).
Defaults to 0 for exponential distribution.</p>
</td></tr>
<tr><td><code id="rtpwexp_+3A_lambda">lambda</code></td>
<td>
<p>A vector of hazard rates for the event. One for
each analysis time interval.</p>
</td></tr>
<tr><td><code id="rtpwexp_+3A_lowerbound">lowerBound</code></td>
<td>
<p>The left truncation time point for the survival time.
Defaults to 0 for no truncation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The random numbers from truncated piecewise exponential
distribution.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rtpwexp(n = 10, piecewiseSurvivalTime = c(0, 6, 9, 15),
        lambda = c(0.025, 0.04, 0.015, 0.007))

</code></pre>

<hr>
<h2 id='runShinyApp'>Run Shiny app</h2><span id='topic+runShinyApp'></span>

<h3>Description</h3>

<p>Runs the log-rank test power and sample size calculation
Shiny app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runShinyApp()
</code></pre>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>

<hr>
<h2 id='samplesizeFisherExact'>Sample size for Fisher's exact test for two proportions</h2><span id='topic+samplesizeFisherExact'></span>

<h3>Description</h3>

<p>Obtains the sample size given power for Fisher's exact
test for two proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesizeFisherExact(
  beta = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesizeFisherExact_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="samplesizeFisherExact_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="samplesizeFisherExact_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="samplesizeFisherExact_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="samplesizeFisherExact_+3A_alpha">alpha</code></td>
<td>
<p>The two-sided significance level. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The two-sided significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(design1 &lt;- samplesizeFisherExact(
  beta = 0.1, pi1 = 0.25, pi2 = 0.05, alpha = 0.05))

</code></pre>

<hr>
<h2 id='samplesizeOnePropExact'>Sample size for binomial one-sample exact test</h2><span id='topic+samplesizeOnePropExact'></span>

<h3>Description</h3>

<p>Obtains the sample size for binomial one-sample exact test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesizeOnePropExact(
  beta = 0.2,
  piH0 = NA_real_,
  pi = NA_real_,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesizeOnePropExact_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="samplesizeOnePropExact_+3A_pih0">piH0</code></td>
<td>
<p>The response probability under the null hypothesis.</p>
</td></tr>
<tr><td><code id="samplesizeOnePropExact_+3A_pi">pi</code></td>
<td>
<p>The response probability under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="samplesizeOnePropExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the critical value of the number of
responses for rejecting the null hypothesis, the attained type I
error, the power for the exact test, the sample size, the
response probabilities under the null and alternative hypotheses,
and the direction of the alternative.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samplesizeOnePropExact(beta = 0.2, piH0 = 0.15, pi = 0.25, alpha = 0.025)

</code></pre>

<hr>
<h2 id='samplesizeOneRateExact'>Sample size for Poisson one-sample exact test</h2><span id='topic+samplesizeOneRateExact'></span>

<h3>Description</h3>

<p>Obtains the sample size for Poisson one-sample exact test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesizeOneRateExact(
  beta = 0.2,
  lambdaH0 = NA_real_,
  lambda = NA_real_,
  D = 1,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesizeOneRateExact_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="samplesizeOneRateExact_+3A_lambdah0">lambdaH0</code></td>
<td>
<p>The Poisson rate under the null hypothesis.</p>
</td></tr>
<tr><td><code id="samplesizeOneRateExact_+3A_lambda">lambda</code></td>
<td>
<p>The Poisson rate under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="samplesizeOneRateExact_+3A_d">D</code></td>
<td>
<p>The average exposure per subject.</p>
</td></tr>
<tr><td><code id="samplesizeOneRateExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level. Defaults to 0.025.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the critical value of the number of
events for rejecting the null hypothesis, the attained type I
error, the power for the exact test, the sample size,
the Poisson rates under the null and alternative hypotheses,
the average exposure, and the direction of the alternative.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>samplesizeOneRateExact(beta = 0.2, lambdaH0 = 0.2, lambda = 0.3,
                       D = 1, alpha = 0.05)

</code></pre>

<hr>
<h2 id='samplesizeRiskDiffExact'>Sample size for exact unconditional test of risk difference</h2><span id='topic+samplesizeRiskDiffExact'></span>

<h3>Description</h3>

<p>Obtains the sample size given power for exact unconditional
test of risk difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesizeRiskDiffExact(
  beta = NA_real_,
  riskDiffH0 = 0,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesizeRiskDiffExact_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExact_+3A_riskdiffh0">riskDiffH0</code></td>
<td>
<p>The risk difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExact_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExact_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExact_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified one-sided significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained one-sided significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskDiffH0</code>: The risk difference under the null hypothesis.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskDiffBound</code>: The critical value on the scale of
score test statistic for risk difference.
</p>
</li>
<li> <p><code>pi2star</code>: The response probability in the control group
at which the critical value of the test statistic is attained.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
samplesizeRiskDiffExact(beta = 0.2, riskDiffH0 = -0.2,
                        pi1 = 0.8, pi2 = 0.8, alpha = 0.025)

</code></pre>

<hr>
<h2 id='samplesizeRiskDiffExactEquiv'>Sample size for exact unconditional test of equivalence in risk
difference</h2><span id='topic+samplesizeRiskDiffExactEquiv'></span>

<h3>Description</h3>

<p>Obtains the sample size given power for exact unconditional
test of equivalence in risk difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesizeRiskDiffExactEquiv(
  beta = NA_real_,
  riskDiffLower = NA_real_,
  riskDiffUpper = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesizeRiskDiffExactEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExactEquiv_+3A_riskdifflower">riskDiffLower</code></td>
<td>
<p>The lower equivalence limit of risk difference.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExactEquiv_+3A_riskdiffupper">riskDiffUpper</code></td>
<td>
<p>The upper equivalence limit of risk difference.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExactEquiv_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExactEquiv_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExactEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="samplesizeRiskDiffExactEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified significance level for each of the two
one-sided tests.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskDiffLower</code>: The lower equivalence limit of risk difference.
</p>
</li>
<li> <p><code>riskDiffUpper</code>: The upper equivalence limit of risk difference.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>riskDiff</code>: The risk difference.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskDiffLower</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>zstatRiskDiffUpper</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
samplesizeRiskDiffExactEquiv(
  beta = 0.2, riskDiffLower = -0.3, riskDiffUpper = 0.3,
  pi1 = 0.85, pi2 = 0.85, alpha = 0.05)

</code></pre>

<hr>
<h2 id='samplesizeRiskRatioExact'>Sample size for exact unconditional test of risk ratio</h2><span id='topic+samplesizeRiskRatioExact'></span>

<h3>Description</h3>

<p>Obtains the sample size given power for exact unconditional
test of risk ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesizeRiskRatioExact(
  beta = NA_real_,
  riskRatioH0 = 1,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.025
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesizeRiskRatioExact_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExact_+3A_riskratioh0">riskRatioH0</code></td>
<td>
<p>The risk ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExact_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExact_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExact_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExact_+3A_alpha">alpha</code></td>
<td>
<p>The one-sided significance level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified one-sided significance level.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained one-sided significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskRatioH0</code>: The risk ratio under the null hypothesis.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskRatioBound</code>: The critical value on the scale of
score test statistic for risk ratio.
</p>
</li>
<li> <p><code>pi2star</code>: The response probability in the control group
at which the critical value of the test statistic is attained.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
samplesizeRiskRatioExact(beta = 0.2, riskRatioH0 = 0.833,
                         pi1 = 0.9, pi2 = 0.9, alpha = 0.05)

</code></pre>

<hr>
<h2 id='samplesizeRiskRatioExactEquiv'>Sample size for exact unconditional test of equivalence in risk
ratio</h2><span id='topic+samplesizeRiskRatioExactEquiv'></span>

<h3>Description</h3>

<p>Obtains the sample size given power for exact unconditional
test of equivalence in risk ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplesizeRiskRatioExactEquiv(
  beta = NA_real_,
  riskRatioLower = NA_real_,
  riskRatioUpper = NA_real_,
  pi1 = NA_real_,
  pi2 = NA_real_,
  allocationRatioPlanned = 1,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplesizeRiskRatioExactEquiv_+3A_beta">beta</code></td>
<td>
<p>The type II error.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExactEquiv_+3A_riskratiolower">riskRatioLower</code></td>
<td>
<p>The lower equivalence limit of risk ratio.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExactEquiv_+3A_riskratioupper">riskRatioUpper</code></td>
<td>
<p>The upper equivalence limit of risk ratio.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExactEquiv_+3A_pi1">pi1</code></td>
<td>
<p>The assumed probability for the active treatment group.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExactEquiv_+3A_pi2">pi2</code></td>
<td>
<p>The assumed probability for the control group.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExactEquiv_+3A_allocationratioplanned">allocationRatioPlanned</code></td>
<td>
<p>Allocation ratio for the active treatment
versus control. Defaults to 1 for equal randomization.</p>
</td></tr>
<tr><td><code id="samplesizeRiskRatioExactEquiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for each of the two one-sided
tests. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following variables:
</p>

<ul>
<li> <p><code>alpha</code>: The specified significance level for each of the two
one-sided tests.
</p>
</li>
<li> <p><code>attainedAlpha</code>: The attained significance level.
</p>
</li>
<li> <p><code>power</code>: The power.
</p>
</li>
<li> <p><code>n</code>: The sample size.
</p>
</li>
<li> <p><code>riskRatioLower</code>: The lower equivalence limit of risk ratio.
</p>
</li>
<li> <p><code>riskRatioUpper</code>: The upper equivalence limit of risk ratio.
</p>
</li>
<li> <p><code>pi1</code>: The assumed probability for the active treatment group.
</p>
</li>
<li> <p><code>pi2</code>: The assumed probability for the control group.
</p>
</li>
<li> <p><code>riskRatio</code>: The risk ratio.
</p>
</li>
<li> <p><code>allocationRatioPlanned</code>: Allocation ratio for the active
treatment versus control.
</p>
</li>
<li> <p><code>zstatRiskRatioLower</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
lower equivalence limit.
</p>
</li>
<li> <p><code>zstatRiskRatioUpper</code>: The efficacy boundaries on the
z-test statistic scale for the one-sided null hypothesis on the
upper equivalence limit.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
samplesizeRiskRatioExactEquiv(
  beta = 0.2, riskRatioLower = 0.7, riskRatioUpper = 1/0.7,
  pi1 = 0.85, pi2 = 0.85, alpha = 0.05)

</code></pre>

<hr>
<h2 id='simon2stage'>Simon's two-stage design</h2><span id='topic+simon2stage'></span>

<h3>Description</h3>

<p>Obtains Simon's two-stage minimax, admissible, and
optimal designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simon2stage(
  alpha = NA_real_,
  beta = NA_real_,
  piH0 = NA_real_,
  pi = NA_real_,
  n_max = 110L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simon2stage_+3A_alpha">alpha</code></td>
<td>
<p>Type I error rate (one-sided).</p>
</td></tr>
<tr><td><code id="simon2stage_+3A_beta">beta</code></td>
<td>
<p>Type II error rate (1-power).</p>
</td></tr>
<tr><td><code id="simon2stage_+3A_pih0">piH0</code></td>
<td>
<p>Response probability under the null hypothesis.</p>
</td></tr>
<tr><td><code id="simon2stage_+3A_pi">pi</code></td>
<td>
<p>Response probability under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="simon2stage_+3A_n_max">n_max</code></td>
<td>
<p>Upper limit for sample size, defaults to 110.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the following variables:
</p>

<ul>
<li> <p><code>piH0</code>: Response probability under the null hypothesis.
</p>
</li>
<li> <p><code>pi</code>: Response probability under the alternative hypothesis.
</p>
</li>
<li> <p><code>alpha</code>: The specified one-sided significance level.
</p>
</li>
<li> <p><code>beta</code>: The specified type II error.
</p>
</li>
<li> <p><code>n</code>: Total sample size.
</p>
</li>
<li> <p><code>n1</code>: Stage 1 sample size.
</p>
</li>
<li> <p><code>r1</code>: Futility boundary for stage 1.
</p>
</li>
<li> <p><code>r</code>: Futility boundary for stage 2.
</p>
</li>
<li> <p><code>EN0</code>: Expected sample size under the null hypothesis.
</p>
</li>
<li> <p><code>attainedAlpha</code>: Attained type 1 error.
</p>
</li>
<li> <p><code>power</code>: Attained power.
</p>
</li>
<li> <p><code>PET0</code>: Probability of early stopping under the null hypothesis.
</p>
</li>
<li> <p><code>w_lower</code>: Lower bound of the interval for <code>w</code>.
</p>
</li>
<li> <p><code>w_upper</code>: Upper bound of the interval for <code>w</code>.
</p>
</li>
<li> <p><code>design</code>: Description of the design, e.g., minimax, admissible,
or optimal.
</p>
</li></ul>

<p>Here <code>w</code> is the weight in the objective function:
<code>w*n + (1-w)*EN0</code>.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simon2stage(0.05, 0.15, 0.1, 0.3)

</code></pre>

<hr>
<h2 id='simonBayesAnalysis'>Analysis of Simon's Bayesian basket trials</h2><span id='topic+simonBayesAnalysis'></span>

<h3>Description</h3>

<p>Obtains the prior and posterior probabilities for
Simon's Bayesian basket discovery trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simonBayesAnalysis(
  nstrata = NA_integer_,
  r = NA_integer_,
  n = NA_integer_,
  lambda = NA_real_,
  gamma = NA_real_,
  phi = NA_real_,
  plo = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simonBayesAnalysis_+3A_nstrata">nstrata</code></td>
<td>
<p>The number of strata.</p>
</td></tr>
<tr><td><code id="simonBayesAnalysis_+3A_r">r</code></td>
<td>
<p>The vector of number of responders across strata.</p>
</td></tr>
<tr><td><code id="simonBayesAnalysis_+3A_n">n</code></td>
<td>
<p>The vector of number of subjects across strata.</p>
</td></tr>
<tr><td><code id="simonBayesAnalysis_+3A_lambda">lambda</code></td>
<td>
<p>The prior probability that the drug activity is
homogeneous across strata.</p>
</td></tr>
<tr><td><code id="simonBayesAnalysis_+3A_gamma">gamma</code></td>
<td>
<p>The prior probability that the drug is active in a
stratum.</p>
</td></tr>
<tr><td><code id="simonBayesAnalysis_+3A_phi">phi</code></td>
<td>
<p>The response probability for an active drug.</p>
</td></tr>
<tr><td><code id="simonBayesAnalysis_+3A_plo">plo</code></td>
<td>
<p>The response probability for an inactive drug.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following five components:
</p>

<ul>
<li> <p><code>case</code>: The matrix with each row corresponding to a combination
of drug activity over strata represented by the columns.
</p>
</li>
<li> <p><code>prior_case</code>: The vector of joint prior probabilities
for the stratum-specific response rates.
</p>
</li>
<li> <p><code>prior_stratum</code>: The vector of marginal prior probabilities
for the stratum-specific response rates.
</p>
</li>
<li> <p><code>post_case</code>: The vector of joint posterior probabilities
for the stratum-specific response rates.
</p>
</li>
<li> <p><code>post_stratum</code>: The vector of marginal posterior probabilities
for the stratum-specific response rates.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
a = simonBayesAnalysis(
  nstrata = 10,
  r = c(8,0,1,1,6,2,0,0,3,3),
  n = c(19,10,26,8,14,7,8,5,4,14),
  lambda = 0.5, gamma = 0.33,
  phi = 0.35, plo = 0.15)

a$post_stratum

</code></pre>

<hr>
<h2 id='simonBayesSim'>Simulation of Simon's Bayesian basket trials</h2><span id='topic+simonBayesSim'></span>

<h3>Description</h3>

<p>Obtains the simulated raw and summary data for Simon's
Bayesian basket discovery trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simonBayesSim(
  p = NA_real_,
  accrualTime = 0L,
  accrualIntensity = NA_real_,
  stratumFraction = 1L,
  lambda = NA_real_,
  gamma = NA_real_,
  phi = NA_real_,
  plo = NA_real_,
  T = NA_real_,
  maxSubjects = NA_integer_,
  plannedSubjects = NA_integer_,
  maxNumberOfIterations = 1000L,
  maxNumberOfRawDatasets = 1L,
  seed = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simonBayesSim_+3A_p">p</code></td>
<td>
<p>The vector of true response probabilities across strata.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_accrualtime">accrualTime</code></td>
<td>
<p>A vector that specifies the starting time of
piecewise Poisson enrollment time intervals. Must start with 0, e.g.,
<code>c(0, 3)</code> breaks the time axis into 2 accrual intervals:
[0, 3) and [3, Inf).</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_accrualintensity">accrualIntensity</code></td>
<td>
<p>A vector of accrual intensities. One for
each accrual time interval.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_stratumfraction">stratumFraction</code></td>
<td>
<p>A vector of stratum fractions that sum to 1.
Defaults to 1 for no stratification.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_lambda">lambda</code></td>
<td>
<p>The prior probability that the drug activity is
homogeneous across strata.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_gamma">gamma</code></td>
<td>
<p>The prior probability that the drug is active in a
stratum.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_phi">phi</code></td>
<td>
<p>The response probability for an active drug.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_plo">plo</code></td>
<td>
<p>The response probability for an inactive drug.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_t">T</code></td>
<td>
<p>The threshold for a conclusive posterior probability to
stop enrollment.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_maxsubjects">maxSubjects</code></td>
<td>
<p>The maximum total sample size.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_plannedsubjects">plannedSubjects</code></td>
<td>
<p>The planned cumulative number of subjects
at each stage.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_maxnumberofiterations">maxNumberOfIterations</code></td>
<td>
<p>The number of simulation iterations.
Defaults to 1000.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_maxnumberofrawdatasets">maxNumberOfRawDatasets</code></td>
<td>
<p>The number of raw datasets to extract.</p>
</td></tr>
<tr><td><code id="simonBayesSim_+3A_seed">seed</code></td>
<td>
<p>The seed to reproduce the simulation results.
The seed from the environment will be used if left unspecified,</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following four components:
</p>

<ul>
<li> <p><code>rawdata</code>: A data frame for subject-level data, containing
the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage number.
</p>
</li>
<li> <p><code>subjectId</code>: The subject ID.
</p>
</li>
<li> <p><code>arrivalTime</code>: The enrollment time for the subject.
</p>
</li>
<li> <p><code>stratum</code>: The stratum for the subject.
</p>
</li>
<li> <p><code>y</code>: Whether the subject was a responder (1) or
nonresponder (0).
</p>
</li></ul>

</li>
<li> <p><code>sumdata1</code>: A data frame for simulation and stratum-level
summary data, containing the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>stageNumber</code>: The stage number.
</p>
</li>
<li> <p><code>stratum</code>: The stratum number.
</p>
</li>
<li> <p><code>active</code>: Whether the drug is active in the stratum.
</p>
</li>
<li> <p><code>n</code>: The number of subjects in the stratum.
</p>
</li>
<li> <p><code>r</code>: The number of responders in the stratum.
</p>
</li>
<li> <p><code>posterior</code>: The posterior probability that the drug is
active in the stratum.
</p>
</li>
<li> <p><code>open</code>: Whether the stratum is still open for enrollment.
</p>
</li>
<li> <p><code>positive</code>: Whether the stratum has been determined to be
a positive stratum.
</p>
</li>
<li> <p><code>negative</code>: Whether the stratum has been determined to be
a negative stratum.
</p>
</li></ul>

</li>
<li> <p><code>sumdata2</code>: A data frame for the simulation level summary data,
containing the following variables:
</p>

<ul>
<li> <p><code>iterationNumber</code>: The iteration number.
</p>
</li>
<li> <p><code>numberOfStrata</code>: The total number of strata.
</p>
</li>
<li> <p><code>n_active_strata</code>: The number of active strata.
</p>
</li>
<li> <p><code>true_positive</code>: The number of true positive strata.
</p>
</li>
<li> <p><code>false_negative</code>: The number of false negative strata.
</p>
</li>
<li> <p><code>false_positive</code>: The number of false positive strata.
</p>
</li>
<li> <p><code>true_negative</code>: The number of true negative strata.
</p>
</li>
<li> <p><code>n_indet_strata</code>: The number of indeterminate strata.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The number of subjects.
</p>
</li></ul>

</li>
<li> <p><code>overview</code>: A data frame for the summary across simulations,
containing the following variables:
</p>

<ul>
<li> <p><code>numberOfStrata</code>: The total number of strata.
</p>
</li>
<li> <p><code>n_active_strata</code>: The average number of active strata.
</p>
</li>
<li> <p><code>true_positive</code>: The average number of true positive strata.
</p>
</li>
<li> <p><code>false_negative</code>: The average number of false negative strata.
</p>
</li>
<li> <p><code>false_positive</code>: The average number of false positive strata.
</p>
</li>
<li> <p><code>true_negative</code>: The average number of true negative strata.
</p>
</li>
<li> <p><code>n_indet_strata</code>: The average number of indeterminate strata.
</p>
</li>
<li> <p><code>numberOfSubjects</code>: The average number of subjects.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sim1 = simonBayesSim(
  p = c(0.25, 0.25, 0.05),
  accrualIntensity = 5,
  stratumFraction = c(1/3, 1/3, 1/3),
  lambda = 0.33, gamma = 0.5,
  phi = 0.25, plo = 0.05,
  T = 0.8, maxSubjects = 50,
  plannedSubjects = seq(5, 50, 5),
  maxNumberOfIterations = 1000,
  maxNumberOfRawDatasets = 1,
  seed = 314159)

sim1$overview

</code></pre>

<hr>
<h2 id='survQuantile'>Brookmeyer-Crowley confidence interval for quantiles of
right-censored time-to-event data</h2><span id='topic+survQuantile'></span>

<h3>Description</h3>

<p>Obtains the Brookmeyer-Crowley confidence
interval for quantiles of right-censored time-to-event data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survQuantile(
  time = NA_real_,
  event = NA_real_,
  cilevel = 0.95,
  transform = "loglog",
  probs = c(0.25, 0.5, 0.75)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survQuantile_+3A_time">time</code></td>
<td>
<p>The vector of possibly right-censored survival times.</p>
</td></tr>
<tr><td><code id="survQuantile_+3A_event">event</code></td>
<td>
<p>The vector of event indicators.</p>
</td></tr>
<tr><td><code id="survQuantile_+3A_cilevel">cilevel</code></td>
<td>
<p>The confidence interval level. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="survQuantile_+3A_transform">transform</code></td>
<td>
<p>The transformation of the survival function to use
to construct the confidence interval. Options include &quot;linear&quot;,
&quot;loglog&quot;, &quot;log&quot;, &quot;asinsqrt&quot;, and &quot;logit&quot;. Defaults to &quot;loglog&quot;.</p>
</td></tr>
<tr><td><code id="survQuantile_+3A_probs">probs</code></td>
<td>
<p>The vector of probabilities to calculate the quantiles.
Defaults to c(0.25, 0.5, 0.75).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the estimated quantile and
confidence interval corresponding to each specified probability.
It includes the following variables:
</p>

<ul>
<li> <p><code>prob</code>: The probability to calculate the quantile.
</p>
</li>
<li> <p><code>quantile</code>: The estimated quantile.
</p>
</li>
<li> <p><code>lower</code>: The lower limit of the confidence interval.
</p>
</li>
<li> <p><code>upper</code>: The upper limit of the confidence interval.
</p>
</li>
<li> <p><code>cilevel</code>: The confidence interval level.
</p>
</li>
<li> <p><code>transform</code>: The transformation of the survival function to use
to construct the confidence interval.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
survQuantile(
  time = c(33.7, 3.9, 10.5, 5.4, 19.5, 23.8, 7.9, 16.9, 16.6,
           33.7, 17.1, 7.9, 10.5, 38),
  event = c(0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1),
  probs = c(0.25, 0.5, 0.75))

</code></pre>

<hr>
<h2 id='tobin'>Tobin's tobit data from the survival package</h2><span id='topic+tobin'></span>

<h3>Description</h3>

<p>Data from Tobin's original paper.
</p>

<dl>
<dt><code>durable</code></dt><dd><p>Durable goods purchase</p>
</dd>
<dt><code>age</code></dt><dd><p>Age in years</p>
</dd>
<dt><code>quant</code></dt><dd><p>Liquidity ratio (x 1000)</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>tobin
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 20 rows and 3 columns.
</p>

<hr>
<h2 id='updateGraph'>Update graph for graphical approaches</h2><span id='topic+updateGraph'></span>

<h3>Description</h3>

<p>Updates the weights and transition matrix for graphical
approaches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateGraph(w, G, I, j)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateGraph_+3A_w">w</code></td>
<td>
<p>The current vector of weights for elementary hypotheses.</p>
</td></tr>
<tr><td><code id="updateGraph_+3A_g">G</code></td>
<td>
<p>The current transition matrix.</p>
</td></tr>
<tr><td><code id="updateGraph_+3A_i">I</code></td>
<td>
<p>The set of indices for yet to be rejected hypotheses.</p>
</td></tr>
<tr><td><code id="updateGraph_+3A_j">j</code></td>
<td>
<p>The hypothesis to remove from index set <code>I</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the new vector of weights, the new
transition matrix for the graph, and the new set of indices of yet
to be rejected hypotheses.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>updateGraph(w = c(0.5, 0.5, 0, 0),
            G = matrix(c(0, 0.5, 0.5, 0,  0.5, 0, 0, 0.5,
                         0, 1, 0, 0,  1, 0, 0, 0),
                       nrow=4, ncol=4, byrow=TRUE),
            I = c(1, 2, 3, 4),
            j = 1)

</code></pre>

<hr>
<h2 id='zstatOddsRatio'>Miettinen-Nurminen score test statistic for two-sample odds ratio</h2><span id='topic+zstatOddsRatio'></span>

<h3>Description</h3>

<p>Obtains the Miettinen-Nurminen score test statistic for
two-sample odds ratio possibly with stratification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zstatOddsRatio(
  oddsRatioH0 = 1,
  n1 = NA_real_,
  y1 = NA_real_,
  n2 = NA_real_,
  y2 = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zstatOddsRatio_+3A_oddsratioh0">oddsRatioH0</code></td>
<td>
<p>The odds ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="zstatOddsRatio_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="zstatOddsRatio_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="zstatOddsRatio_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="zstatOddsRatio_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mantel-Haenszel sample size weights are used for stratified
samples.
</p>


<h3>Value</h3>

<p>The value of the score test statistic.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
zstatOddsRatio(oddsRatioH0 = 1, n1 = c(10,10), y1 = c(4,3),
               n2 = c(20,10), y2 = c(2,0))

</code></pre>

<hr>
<h2 id='zstatRateDiff'>Miettinen-Nurminen score test statistic for two-sample rate
difference</h2><span id='topic+zstatRateDiff'></span>

<h3>Description</h3>

<p>Obtains the Miettinen-Nurminen score test statistic for
two-sample rate difference possibly with stratification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zstatRateDiff(
  rateDiffH0 = 0,
  t1 = NA_real_,
  y1 = NA_real_,
  t2 = NA_real_,
  y2 = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zstatRateDiff_+3A_ratediffh0">rateDiffH0</code></td>
<td>
<p>The rate difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="zstatRateDiff_+3A_t1">t1</code></td>
<td>
<p>The exposure for the active treatment group.</p>
</td></tr>
<tr><td><code id="zstatRateDiff_+3A_y1">y1</code></td>
<td>
<p>The number of events for the active treatment group.</p>
</td></tr>
<tr><td><code id="zstatRateDiff_+3A_t2">t2</code></td>
<td>
<p>The exposure for the control group.</p>
</td></tr>
<tr><td><code id="zstatRateDiff_+3A_y2">y2</code></td>
<td>
<p>The number of events for the control group.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mantel-Haenszel weights are used for stratified samples.
</p>


<h3>Value</h3>

<p>The value of the score test statistic.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
zstatRateDiff(rateDiffH0 = 0, t1 = c(10,10), y1 = c(4,3),
              t2 = c(20,10), y2 = c(2,0))

</code></pre>

<hr>
<h2 id='zstatRateRatio'>Miettinen-Nurminen score test statistic for two-sample rate ratio</h2><span id='topic+zstatRateRatio'></span>

<h3>Description</h3>

<p>Obtains the Miettinen-Nurminen score test statistic for
two-sample rate ratio possibly with stratification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zstatRateRatio(
  rateRatioH0 = 1,
  t1 = NA_real_,
  y1 = NA_real_,
  t2 = NA_real_,
  y2 = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zstatRateRatio_+3A_rateratioh0">rateRatioH0</code></td>
<td>
<p>The rate ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="zstatRateRatio_+3A_t1">t1</code></td>
<td>
<p>The exposure for the active treatment group.</p>
</td></tr>
<tr><td><code id="zstatRateRatio_+3A_y1">y1</code></td>
<td>
<p>The number of events for the active treatment group.</p>
</td></tr>
<tr><td><code id="zstatRateRatio_+3A_t2">t2</code></td>
<td>
<p>The exposure for the control group.</p>
</td></tr>
<tr><td><code id="zstatRateRatio_+3A_y2">y2</code></td>
<td>
<p>The number of events for the control group.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mantel-Haenszel weights are used for stratified samples.
</p>


<h3>Value</h3>

<p>The value of the score test statistic.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
zstatRateRatio(rateRatioH0 = 1, t1 = c(10,10), y1 = c(4,3),
               t2 = c(20,10), y2 = c(2,0))

</code></pre>

<hr>
<h2 id='zstatRiskDiff'>Miettinen-Nurminen score test statistic for two-sample risk
difference</h2><span id='topic+zstatRiskDiff'></span>

<h3>Description</h3>

<p>Obtains the Miettinen-Nurminen score test statistic
for two-sample risk difference possibly with stratification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zstatRiskDiff(
  riskDiffH0 = 0,
  n1 = NA_real_,
  y1 = NA_real_,
  n2 = NA_real_,
  y2 = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zstatRiskDiff_+3A_riskdiffh0">riskDiffH0</code></td>
<td>
<p>The risk difference under the null hypothesis.
Defaults to 0.</p>
</td></tr>
<tr><td><code id="zstatRiskDiff_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="zstatRiskDiff_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="zstatRiskDiff_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="zstatRiskDiff_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mantel-Haenszel sample size weights are used for stratified
samples.
</p>


<h3>Value</h3>

<p>The value of the score test statistic.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
zstatRiskDiff(riskDiffH0 = 0, n1 = c(10,10), y1 = c(4,3),
              n2 = c(20,10), y2 = c(2,0))

</code></pre>

<hr>
<h2 id='zstatRiskRatio'>Miettinen-Nurminen score test statistic for two-sample risk ratio</h2><span id='topic+zstatRiskRatio'></span>

<h3>Description</h3>

<p>Obtains the Miettinen-Nurminen score test statistic for
two-sample risk ratio possibly with stratification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zstatRiskRatio(
  riskRatioH0 = 1,
  n1 = NA_real_,
  y1 = NA_real_,
  n2 = NA_real_,
  y2 = NA_real_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zstatRiskRatio_+3A_riskratioh0">riskRatioH0</code></td>
<td>
<p>The risk ratio under the null hypothesis.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="zstatRiskRatio_+3A_n1">n1</code></td>
<td>
<p>The sample size for the active treatment group.</p>
</td></tr>
<tr><td><code id="zstatRiskRatio_+3A_y1">y1</code></td>
<td>
<p>The number of responses for the active treatment group.</p>
</td></tr>
<tr><td><code id="zstatRiskRatio_+3A_n2">n2</code></td>
<td>
<p>The sample size for the control group.</p>
</td></tr>
<tr><td><code id="zstatRiskRatio_+3A_y2">y2</code></td>
<td>
<p>The number of responses for the control group.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mantel-Haenszel sample size weights are used for stratified
samples.
</p>


<h3>Value</h3>

<p>The value of the score test statistic.
</p>


<h3>Author(s)</h3>

<p>Kaifeng Lu, <a href="mailto:kaifenglu@gmail.com">kaifenglu@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
zstatRiskRatio(riskRatioH0 = 1, n1 = c(10,10), y1 = c(4,3),
               n2 = c(20,10), y2 = c(2,0))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
