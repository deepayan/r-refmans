<!DOCTYPE html><html lang="en"><head><title>Help for package utile.visuals</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {utile.visuals}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#append_table'><p>Append a ggplot2 table to the bottom of a ggplot2 plot</p></a></li>
<li><a href='#geom_stepconfint'><p>Step function confidence intervals for ggplot2</p></a></li>
<li><a href='#ggrisktable'><p>Create a ggplot2 table showing the number at risk</p></a></li>
<li><a href='#panel_border'><p>Add a panel border to a ggplot2 plot</p></a></li>
<li><a href='#theme_basic'><p>Minimalist theme for ggplot2</p></a></li>
<li><a href='#theme_risk'><p>Minimalist risk table theme for ggplot2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Create Visuals for Publication</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.3</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of functions to aid in the production of visuals in ggplot2.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2">LGPL-2</a> | <a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://efinite.github.io/utile.visuals/">https://efinite.github.io/utile.visuals/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/efinite/utile.visuals/issues">https://github.com/efinite/utile.visuals/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2 (&ge; 0.3.4), gridExtra, purrr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>survival, broom, grid</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-24 00:42:07 UTC; Eric</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric Finnesgard [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric Finnesgard &lt;efinite@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-24 01:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='append_table'>Append a ggplot2 table to the bottom of a ggplot2 plot</h2><span id='topic+append_table'></span>

<h3>Description</h3>

<p>Aligns axes and combines a ggplot2 plot and table into a single plot.
Can handle legends.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>append_table(
  plot = NULL,
  table = NULL,
  plot.height = 1,
  table.height = 0.1,
  plot.width = 1,
  extract.legend = TRUE,
  legend.width = 0.2,
  legend.offset = -15
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="append_table_+3A_plot">plot</code></td>
<td>
<p>Required. ggplot2::ggplot() object. If a legend is present, it will be
extracted.</p>
</td></tr>
<tr><td><code id="append_table_+3A_table">table</code></td>
<td>
<p>Required. ggplot2::ggplot object. If a legend is present, it will
be removed and ignored.</p>
</td></tr>
<tr><td><code id="append_table_+3A_plot.height">plot.height</code></td>
<td>
<p>Optional. Numeric. Height of plot relative to table. Defaults
to 1.</p>
</td></tr>
<tr><td><code id="append_table_+3A_table.height">table.height</code></td>
<td>
<p>Optional. Numeric. Height of table relative to plot. Defaults
to 0.1.</p>
</td></tr>
<tr><td><code id="append_table_+3A_plot.width">plot.width</code></td>
<td>
<p>Optional. Numeric. Width of plot relative to legend. Ignored
if no legend present in plot. Defaults to 1.</p>
</td></tr>
<tr><td><code id="append_table_+3A_extract.legend">extract.legend</code></td>
<td>
<p>Optional. Logical. Indicates whether to extract the legend
from the plot and reinsert it adjacent to the final combined plot. May be undesired
if legend already embedded within the plot area. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="append_table_+3A_legend.width">legend.width</code></td>
<td>
<p>Optional. Numeric. Width of legend relative to plot. Ignored
if no legend present in plot or 'extract.legend'=FALSE. Defaults 0.2.</p>
</td></tr>
<tr><td><code id="append_table_+3A_legend.offset">legend.offset</code></td>
<td>
<p>Optional. Numeric. Vertical offset of legend. Used to raise
or lower. Ignored if no legend present in plot or 'extract.legend'=FALSE. Defaults
to -15.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 tableGrob object. Use grid::grid.draw() to open in RStudio viewer.
Works with ggplot2::ggsave() out of the box.
</p>


<h3>Note</h3>

<p>To ensure proper alignment, double check that both plots use the same scale
and breaks!
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
library(ggplot2)
library(broom) # tidy() model data
library(grid) # grid.draw() finished plot

# Data with group names specified
data_diabetic &lt;- diabetic
data_diabetic$trt &lt;- as.factor(data_diabetic$trt)
levels(data_diabetic$trt) &lt;- c('None', 'Laser')

# Survival Model
fit &lt;- survfit(Surv(time, status) ~ trt, data = data_diabetic)

# Kaplan Meier (KM) Plot
plot_km &lt;- ggplot(
 data = tidy(fit),
 mapping = aes(x = time, y = estimate)
) +
  geom_step(aes(color = strata)) +
  geom_stepconfint(aes(ymin = conf.low, ymax = conf.high, fill = strata), alpha = 0.3) +
  coord_cartesian(c(0, 50)) + # Note scale set here!
  scale_x_continuous(expand = c(0.02,0)) +
  labs(x = 'Time', y = 'Freedom From Event') +
  scale_color_manual(
    values = c('#d83641', '#1A45A7'),
    name = 'Treatment',
    labels = c('Laser', 'None'),
    aesthetics = c('colour', 'fill')) +
  theme_basic()

# Risk Table
tbl_risk &lt;- ggrisktable(fit, c(0, 10, 20, 30, 40, 50)) +
  coord_cartesian(c(0, 50)) +
  scale_x_continuous(expand = c(0.02,0)) +
  theme_risk()

# Combine KM plot and risk table
plot_cmbd &lt;- append_table(
  plot = plot_km,
  table = tbl_risk
)

# Draw in RStudio viewer
grid.newpage()
grid.draw(plot_cmbd)
</code></pre>

<hr>
<h2 id='geom_stepconfint'>Step function confidence intervals for ggplot2</h2><span id='topic+geom_stepconfint'></span>

<h3>Description</h3>

<p>Produces a step function confidence interval for survival curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_stepconfint(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  na.rm = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geom_stepconfint_+3A_mapping">mapping</code></td>
<td>
<p>Aesthetic mappings with aes() function. Like geom_ribbon(), you must provide
columns for x, ymin (lower limit), ymax (upper limit).</p>
</td></tr>
<tr><td><code id="geom_stepconfint_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. Can inherit from ggplot parent.</p>
</td></tr>
<tr><td><code id="geom_stepconfint_+3A_stat">stat</code></td>
<td>
<p>The statistical transformation to use on the data for this layer, as a string.
Defaults to 'identity'.</p>
</td></tr>
<tr><td><code id="geom_stepconfint_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of a call to a
position adjustment function.</p>
</td></tr>
<tr><td><code id="geom_stepconfint_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE, the default, missing values are removed with a warning. If TRUE,
missing values are silently removed.</p>
</td></tr>
<tr><td><code id="geom_stepconfint_+3A_...">...</code></td>
<td>
<p>Optional. Any other ggplot geom_ribbon() arguments.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Adapted from the survminer package &lt;https://github.com/kassambara/survminer&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
library(broom)
library(ggplot2)

fit &lt;- survfit(Surv(time, status) ~ trt, data = diabetic)
fit &lt;- survfit0(fit) # connect origin

ggplot(
  data = tidy(fit),
  mapping = aes(x = time, y = estimate)
) +
  geom_step(aes(color = strata)) +
  geom_stepconfint(aes(ymin = conf.low, ymax = conf.high, fill = strata), alpha = 0.3) +
  coord_cartesian(c(0, 50)) +
  scale_x_continuous(expand = c(0.02,0)) +
  labs(x = 'Time', y = 'Freedom From Event') +
  scale_color_manual(
    values = c('#d83641', '#1A45A7'),
    name = 'Treatment',
    labels = c('None', 'Laser'),
    aesthetics = c('colour', 'fill')) +
  theme_basic()
</code></pre>

<hr>
<h2 id='ggrisktable'>Create a ggplot2 table showing the number at risk</h2><span id='topic+ggrisktable'></span>

<h3>Description</h3>

<p>A simple wrapper function which calculates the
numbers at risk for a survival model and a given set of time points then
creates a ggplot2 table with them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggrisktable(
  fit = NULL,
  times = NULL,
  text.color = "black",
  strata.order = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggrisktable_+3A_fit">fit</code></td>
<td>
<p>Required. survival::survfit() object.</p>
</td></tr>
<tr><td><code id="ggrisktable_+3A_times">times</code></td>
<td>
<p>Required. Numeric. One or more time points to calculate
the number at risk for.</p>
</td></tr>
<tr><td><code id="ggrisktable_+3A_text.color">text.color</code></td>
<td>
<p>Optional. Character. Color of text within table. Defaults
to 'black'.</p>
</td></tr>
<tr><td><code id="ggrisktable_+3A_strata.order">strata.order</code></td>
<td>
<p>Optional. Character. Ordered names of strata factor
levels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An unformatted ggplot2 table showing the number at risk.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)

fit &lt;- survfit(Surv(time, status) ~ trt, data = diabetic)

ggrisktable(
   fit = fit,
   times = c(0, 10, 20, 30, 40, 50),
   strata.order = c('0', '1')
) + theme_risk()
</code></pre>

<hr>
<h2 id='panel_border'>Add a panel border to a ggplot2 plot</h2><span id='topic+panel_border'></span>

<h3>Description</h3>

<p>A simple <code>ggplot2</code> theme which replaces the axis lines with
a bordered panel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>panel_border(base_size = 12, base_color = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="panel_border_+3A_base_size">base_size</code></td>
<td>
<p>A numeric. Base size. Used to calculate line size and spacing.</p>
</td></tr>
<tr><td><code id="panel_border_+3A_base_color">base_color</code></td>
<td>
<p>A character. Base color for lines.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This should be placed after the primary theme for the plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

ggplot(datasets::mtcars, aes(x = wt, y = hp, color = as.factor(cyl))) +
  geom_point() +
  facet_wrap(~as.logical(am)) +
  theme_basic() +
  panel_border()
</code></pre>

<hr>
<h2 id='theme_basic'>Minimalist theme for ggplot2</h2><span id='topic+theme_basic'></span>

<h3>Description</h3>

<p>A minimalist <code>ggplot2</code> theme which removes most background elements and
lines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_basic(
  base_size = 12,
  base_family = NULL,
  base_color = "black",
  base_line_size = base_size/12,
  base_rect_size = base_size/12
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="theme_basic_+3A_base_size">base_size</code></td>
<td>
<p>A numeric. Base font size.</p>
</td></tr>
<tr><td><code id="theme_basic_+3A_base_family">base_family</code></td>
<td>
<p>A numeric. Base font family.</p>
</td></tr>
<tr><td><code id="theme_basic_+3A_base_color">base_color</code></td>
<td>
<p>A character. Base color for lines and text.</p>
</td></tr>
<tr><td><code id="theme_basic_+3A_base_line_size">base_line_size</code></td>
<td>
<p>A numeric. Base line element size.</p>
</td></tr>
<tr><td><code id="theme_basic_+3A_base_rect_size">base_rect_size</code></td>
<td>
<p>A numeric. Base rectangle element size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Recommend exporting as PNG or TIFF to preserve
background transparency.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

ggplot(datasets::mtcars, aes(x = wt, y = hp, color = as.factor(cyl))) +
  geom_point() +
  theme_basic()
</code></pre>

<hr>
<h2 id='theme_risk'>Minimalist risk table theme for ggplot2</h2><span id='topic+theme_risk'></span>

<h3>Description</h3>

<p>A minimalist <code>ggplot2</code> theme which removes most background elements and
lines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_risk(
  base_size = 12,
  base_family = NULL,
  base_color = "black",
  base_line_size = base_size/12,
  base_rect_size = base_size/12
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="theme_risk_+3A_base_size">base_size</code></td>
<td>
<p>A numeric. Base font size.</p>
</td></tr>
<tr><td><code id="theme_risk_+3A_base_family">base_family</code></td>
<td>
<p>A numeric. Base font family.</p>
</td></tr>
<tr><td><code id="theme_risk_+3A_base_color">base_color</code></td>
<td>
<p>A character. Base color for lines and text.</p>
</td></tr>
<tr><td><code id="theme_risk_+3A_base_line_size">base_line_size</code></td>
<td>
<p>A numeric. Base line element size.</p>
</td></tr>
<tr><td><code id="theme_risk_+3A_base_rect_size">base_rect_size</code></td>
<td>
<p>A numeric. Base rectangle element size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Recommend exporting as PNG or TIFF to preserve
background transparency.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggrisktable">ggrisktable</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
