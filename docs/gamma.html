<!DOCTYPE html><html lang="en"><head><title>Help for package gamma</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gamma}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gamma-package'><p>gamma: Dose Rate Estimation from in-Situ Gamma-Ray Spectrometry Measurements</p></a></li>
<li><a href='#AIX_NaI_1'><p>CEREGE Calibration Curve (NaI)</p></a></li>
<li><a href='#baseline'><p>Baseline Estimation and Removal</p></a></li>
<li><a href='#Baseline-class'><p>An S4 Class to Represent a Spectrum Baseline</p></a></li>
<li><a href='#BDX_LaBr_1'><p>CRP2A Calibration Curve (LaBr)</p></a></li>
<li><a href='#CalibrationCurve-class'><p>An S4 class to Represent a Dose Rate Calibration Curve</p></a></li>
<li><a href='#clermont'><p>Clermont Reference Data</p></a></li>
<li><a href='#clermont_2024'><p>Clermont Reference Data 2024</p></a></li>
<li><a href='#coerce'><p>Coerce</p></a></li>
<li><a href='#decay'><p>Nuclear Decay Data</p></a></li>
<li><a href='#decay_La'><p>Lanthanum Decay Data</p></a></li>
<li><a href='#doserate'><p>Dose Rate Estimation</p></a></li>
<li><a href='#energy'><p>Energy Scale Calibration</p></a></li>
<li><a href='#GammaSpectra-class'><p>An S4 Class to Represent a Collection of Gamma Sectra</p></a></li>
<li><a href='#GammaSpectrum-class'><p>An S4 Class to Represent a Gamma Spectrum</p></a></li>
<li><a href='#mutator'><p>Get or Set Parts of an Object</p></a></li>
<li><a href='#operator'><p>Common Operations on GammaSpectrum Objects</p></a></li>
<li><a href='#PeakPosition-class'><p>An S4 Class to Represent a Set of Peaks</p></a></li>
<li><a href='#peaks_find'><p>Find Peaks</p></a></li>
<li><a href='#peaks_search'><p>Search Peaks</p></a></li>
<li><a href='#plot'><p>Plot</p></a></li>
<li><a href='#read'><p>Data Input</p></a></li>
<li><a href='#signal_integrate'><p>Signal Integration</p></a></li>
<li><a href='#signal_slice'><p>Choose channels by Position</p></a></li>
<li><a href='#signal_split'><p>Split</p></a></li>
<li><a href='#signal_stabilize'><p>Transform Intensities</p></a></li>
<li><a href='#smooth'><p>Smooth</p></a></li>
<li><a href='#subset'><p>Extract or Replace Parts of an Object</p></a></li>
<li><a href='#summarise'><p>Summarize</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Dose Rate Estimation from in-Situ Gamma-Ray Spectrometry
Measurements</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Archéosciences Bordeaux &lt;services-archeosciences@u-bordeaux-montaigne.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Process in-situ Gamma-Ray Spectrometry for Luminescence
    Dating. This package allows to import, inspect and correct the energy
    shifts of gamma-ray spectra. It provides methods for estimating the
    gamma dose rate by the use of a calibration curve as described in
    Mercier and Falguères (2007). The package only supports Canberra CNF
    and TKA and Kromek SPE files.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://crp2a.github.io/gamma/">https://crp2a.github.io/gamma/</a>, <a href="https://github.com/crp2a/gamma">https://github.com/crp2a/gamma</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/crp2a/gamma/issues">https://github.com/crp2a/gamma/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, graphics, IsoplotR, methods, rlang, rxylib, stats,
tools, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown, testthat (&ge; 3.0.0), vdiffr (&ge;
1.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>false</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Collate:</td>
<td>'AllClasses.R' 'AllGenerics.R' 'baseline.R'
'baseline_linear.R' 'baseline_rubberband.R' 'baseline_snip.R'
'coerce.R' 'data.R' 'dose_fit.R' 'dose_predict.R'
'energy_calibrate.R' 'gamma-package.R' 'initialize.R'
'mutators.R' 'operators.R' 'peaks_find.R' 'peaks_search.R'
'plot.R' 'read.R' 'show.R' 'signal_integrate.R'
'signal_slice.R' 'signal_split.R' 'signal_stabilize.R'
'smooth.R' 'smooth_rectangular.R' 'smooth_savitzky.R'
'smooth_triangular.R' 'subset.R' 'summarize.R' 'utilities.R'
'validate.R' 'zzz.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-23 19:26:18 UTC; nicolas</td>
</tr>
<tr>
<td>Author:</td>
<td>Nicolas Frerebeau <a href="https://orcid.org/0000-0001-5759-4944"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Brice Lebrun <a href="https://orcid.org/0000-0001-7503-8685"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Guilhem Paradol <a href="https://orcid.org/0000-0002-8561-4903"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Magali Rizza <a href="https://orcid.org/0000-0003-2364-5621"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Christelle Lahaye <a href="https://orcid.org/0000-0003-2215-9015"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Sebastian Kreutzer
    <a href="https://orcid.org/0000-0002-0734-2199"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Archéosciences Bordeaux [cre],
  Université Bordeaux Montaigne [cph, fnd],
  CNRS [fnd],
  LabEx Sciences archéologiques de Bordeaux [fnd],
  Idex Aix-Marseille [fnd]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-23 22:00:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='gamma-package'>gamma: Dose Rate Estimation from in-Situ Gamma-Ray Spectrometry Measurements</h2><span id='topic+gamma-package'></span><span id='topic+gamma'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Process in-situ Gamma-Ray Spectrometry for Luminescence Dating. This package allows to import, inspect and correct the energy shifts of gamma-ray spectra. It provides methods for estimating the gamma dose rate by the use of a calibration curve as described in Mercier and Falguères (2007). The package only supports Canberra CNF and TKA and Kromek SPE files.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
<strong>Package:</strong> </td><td style="text-align: left;"> gamma </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Type:</strong> </td><td style="text-align: left;"> Package </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Version:</strong> </td><td style="text-align: left;"> 1.1.0 </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>License:</strong> </td><td style="text-align: left;"> GPL-3 </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Zenodo:</strong> </td><td style="text-align: left;"> <a href="https://doi.org/10.5281/zenodo.2652393">doi:10.5281/zenodo.2652393</a>
</td>
</tr>

</table>



<h3>Note</h3>

<p>This work received a state financial support managed by the Agence Nationale
de la Recherche (France) through the program <em>Investissements d'avenir</em>
(ref. ANR-10-LABX-52 and 11-IDEX-0001).
</p>


<h3>Author(s)</h3>

<p><strong>Full list of authors and contributors</strong> (alphabetic order)
</p>

<table>
<tr>
 <td style="text-align: left;">
Nicolas Frerebeau </td><td style="text-align: left;"> <em>Université Bordeaux Montaigne, France</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
Sebastian Kreutzer </td><td style="text-align: left;"> <em>Universität Heidelberg, Germany</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
Christelle Lahaye </td><td style="text-align: left;"> <em>Université Bordeaux Montaigne, France</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
Brice Lebrun </td><td style="text-align: left;"> <em>Université Bordeaux Montaigne, France</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
Guilhem Paradol </td><td style="text-align: left;"> <em>Commissariat à l'Énergie Atomique, France</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
Magali Rizza </td><td style="text-align: left;"> <em>Aix-Marseille Université, France</em>
</td>
</tr>

</table>

<p><strong>Package maintainer</strong>
</p>
<p>Nicolas Frerebeau<br />
<a href="mailto:services-archeosciences@u-bordeaux-montaigne.fr">services-archeosciences@u-bordeaux-montaigne.fr</a>
</p>
<p>Archéosciences Bordeaux (UMR 6034)<br />
Maison de l'Archéologie<br />
Université Bordeaux Montaigne<br />
F-33607 Pessac cedex<br />
France
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://crp2a.github.io/gamma/">https://crp2a.github.io/gamma/</a>
</p>
</li>
<li> <p><a href="https://github.com/crp2a/gamma">https://github.com/crp2a/gamma</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/crp2a/gamma/issues">https://github.com/crp2a/gamma/issues</a>
</p>
</li></ul>


<hr>
<h2 id='AIX_NaI_1'>CEREGE Calibration Curve (NaI)</h2><span id='topic+AIX_NaI_1'></span>

<h3>Description</h3>

<p>CEREGE Calibration Curve (NaI)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AIX_NaI_1)
</code></pre>


<h3>Format</h3>

<p>An object of class <a href="#topic+CalibrationCurve-class">CalibrationCurve</a>.
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Laboratory</strong> </td><td style="text-align: left;"> CEREGE </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Instrument</strong> </td><td style="text-align: left;"> Canberra Inspector 1000 </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Detector</strong> </td><td style="text-align: left;"> NaI </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Authors</strong> </td><td style="text-align: left;"> CEREGE Luminescence Team
</td>
</tr>

</table>



<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+BDX_LaBr_1">BDX_LaBr_1</a></code>,
<code><a href="#topic+clermont">clermont</a></code>,
<code><a href="#topic+clermont_2024">clermont_2024</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load the curve
data(AIX_NaI_1, package = "gamma")
plot(AIX_NaI_1)
</code></pre>

<hr>
<h2 id='baseline'>Baseline Estimation and Removal</h2><span id='topic+baseline'></span><span id='topic+signal_baseline'></span><span id='topic+baseline-method'></span><span id='topic+signal_correct'></span><span id='topic+signal_correct-method'></span><span id='topic+baseline_snip'></span><span id='topic+baseline_snip-method'></span><span id='topic+baseline_rubberband'></span><span id='topic+baseline_rubberband-method'></span><span id='topic+baseline_linear'></span><span id='topic+baseline_linear-method'></span><span id='topic+signal_baseline+2CGammaSpectrum-method'></span><span id='topic+signal_baseline+2CGammaSpectra-method'></span><span id='topic+signal_correct+2CGammaSpectrum-method'></span><span id='topic+signal_correct+2CGammaSpectra-method'></span><span id='topic+baseline_linear+2CGammaSpectrum-method'></span><span id='topic+baseline_linear+2CGammaSpectra-method'></span><span id='topic+baseline_rubberband+2CGammaSpectrum-method'></span><span id='topic+baseline_rubberband+2CGammaSpectra-method'></span><span id='topic+baseline_snip+2CGammaSpectrum-method'></span><span id='topic+baseline_snip+2CGammaSpectra-method'></span>

<h3>Description</h3>

<p>Baseline Estimation and Removal
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signal_baseline(object, ...)

signal_correct(object, ...)

baseline_snip(object, ...)

baseline_rubberband(object, ...)

baseline_linear(object, ...)

## S4 method for signature 'GammaSpectrum'
signal_baseline(object, method = c("SNIP", "rubberband", "linear"), ...)

## S4 method for signature 'GammaSpectra'
signal_baseline(object, method = c("SNIP", "rubberband", "linear"), ...)

## S4 method for signature 'GammaSpectrum'
signal_correct(object, method = c("SNIP", "rubberband", "linear"), ...)

## S4 method for signature 'GammaSpectra'
signal_correct(object, method = c("SNIP", "rubberband", "linear"), ...)

## S4 method for signature 'GammaSpectrum'
baseline_linear(object, from = NULL, to = NULL)

## S4 method for signature 'GammaSpectra'
baseline_linear(object, from = NULL, to = NULL)

## S4 method for signature 'GammaSpectrum'
baseline_rubberband(object, noise = 0, spline = TRUE, ...)

## S4 method for signature 'GammaSpectra'
baseline_rubberband(object, noise = 0, spline = TRUE, ...)

## S4 method for signature 'GammaSpectrum'
baseline_snip(object, LLS = FALSE, decreasing = FALSE, n = 100, ...)

## S4 method for signature 'GammaSpectra'
baseline_snip(object, LLS = FALSE, decreasing = FALSE, n = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="baseline_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or <a href="#topic+GammaSpectra-class">GammaSpectra</a>
object.</p>
</td></tr>
<tr><td><code id="baseline_+3A_...">...</code></td>
<td>
<p>Extra parameters to be passed to further methods.</p>
</td></tr>
<tr><td><code id="baseline_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the method to be used for
baseline estimation (see details). Any unambiguous substring can be given.</p>
</td></tr>
<tr><td><code id="baseline_+3A_from">from</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the first channel to be used for linear
interpolation. If <code>NULL</code> (the default), channel <code class="reqn">1</code> is used.
Only used if <code>method</code> is &quot;<code>linear</code>&quot;.</p>
</td></tr>
<tr><td><code id="baseline_+3A_to">to</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the last channel to be used for linear
interpolation. If <code>NULL</code> (the default), channel <code class="reqn">max</code> is used.
Only used if <code>method</code> is &quot;<code>linear</code>&quot;.</p>
</td></tr>
<tr><td><code id="baseline_+3A_noise">noise</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the noise level.
Only used if <code>method</code> is &quot;<code>rubberband</code>&quot;.</p>
</td></tr>
<tr><td><code id="baseline_+3A_spline">spline</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should spline interpolation through the
support points be used instead of linear interpolation?
Only used if <code>method</code> is &quot;<code>rubberband</code>&quot;.</p>
</td></tr>
<tr><td><code id="baseline_+3A_lls">LLS</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the LLS operator be applied on <code>x</code>
before employing SNIP algorithm? Only used if <code>method</code> is &quot;<code>SNIP</code>&quot;.</p>
</td></tr>
<tr><td><code id="baseline_+3A_decreasing">decreasing</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should a decreasing clipping window
be used? Only used if <code>method</code> is &quot;<code>SNIP</code>&quot;.</p>
</td></tr>
<tr><td><code id="baseline_+3A_n">n</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> value giving the number of iterations.
Only used if <code>method</code> is &quot;<code>SNIP</code>&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following methods are available for baseline estimation:
</p>

<dl>
<dt><code>SNIP</code></dt><dd><p>Sensitive Nonlinear Iterative Peak clipping algorithm.</p>
</dd>
<dt><code>rubberband</code></dt><dd><p>A convex envelope of the spectrum is determined and the
baseline is estimated as the part of the convex envelope lying below the
spectrum. Note that the rubber band does not enter the concave regions
(if any) of the spectrum.</p>
</dd>
<dt><code>linear</code></dt><dd><p>Linear baseline estimation.</p>
</dd>
</dl>



<h3>Value</h3>


<ul>
<li> <p><code style="white-space: pre;">&#8288;baseline_*()&#8288;</code> returns a <a href="#topic+BaseLine-class">BaseLine</a> object.
</p>
</li>
<li> <p><code>signal_correct()</code> returns a corrected <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or
<a href="#topic+GammaSpectra-class">GammaSpectra</a> object (same as <code>object</code>).
</p>
</li></ul>



<h3>Note</h3>

<p><code>baseline_rubberband()</code> is slightly modified from C. Beleites'
<code><a href="hyperSpec.html#topic+spc-rubberband">hyperSpec::spc.rubberband()</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Liland, K. H. (2015). 4S Peak Filling - baseline estimation by iterative
mean suppression. <em>MethodsX</em>, 2, 135-140. <a href="https://doi.org/10.1016/j.mex.2015.02.009">doi:10.1016/j.mex.2015.02.009</a>.
</p>
<p>Morháč, M., Kliman, J., Matoušek, V., Veselský, M. &amp; Turzo, I. (1997).
Background elimination methods for multidimensional gamma-ray spectra.
<em>Nuclear Instruments and Methods in Physics Research Section A:
Accelerators, Spectrometers, Detectors and Associated Equipment</em>, 401(1),
p. 113-132. <a href="https://doi.org/10.1016/S0168-9002%2897%2901023-1">doi:10.1016/S0168-9002(97)01023-1</a>
</p>
<p>Morháč, M. &amp; Matoušek, V. (2008). Peak Clipping Algorithms for Background
Estimation in Spectroscopic Data. <em>Applied Spectroscopy</em>, 62(1), p. 91-106.
<a href="https://doi.org/10.1366/000370208783412762">doi:10.1366/000370208783412762</a>
</p>
<p>Ryan, C. G., Clayton, E., Griffin, W. L., Sie, S. H. &amp; Cousens, D. R.
(1988). SNIP, a statistics-sensitive background treatment for the
quantitative analysis of PIXE spectra in geoscience applications.
<em>Nuclear Instruments and Methods in Physics Research Section B:
Beam Interactions with Materials and Atoms</em>, 34(3), p. 396-402.
<a href="https://doi.org/10.1016/0168-583X%2888%2990063-8">doi:10.1016/0168-583X(88)90063-8</a>
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code><a href="#topic+peaks_find">peaks_find</a>()</code>,
<code><a href="#topic+peaks_search">peaks_search</a>()</code>,
<code><a href="#topic+signal_integrate">signal_integrate</a>()</code>,
<code><a href="#topic+signal_slice">signal_slice</a>()</code>,
<code><a href="#topic+signal_split">signal_split</a>()</code>,
<code><a href="#topic+signal_stabilize">signal_stabilize</a>()</code>,
<code><a href="#topic+smooth">smooth</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import a CNF file
spc_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
spc &lt;- read(spc_file)

## Remove the first 35 channels
spc &lt;- signal_slice(spc, -c(1:35))

## Linear baseline
bsl_linear &lt;- baseline_linear(spc, from = 250, to = 750)
plot(spc, bsl_linear)

## SNIP baseline
bsl_snip &lt;- baseline_snip(spc, LLS = FALSE, decreasing = FALSE, n = 100)
plot(spc, bsl_snip)

## Rubberband baseline
bsl_rubber &lt;- baseline_rubberband(spc)
plot(spc, bsl_rubber)

## Remove baseline
spc_clean1 &lt;- signal_correct(spc)
spc_clean2 &lt;- spc - bsl_snip
all(spc_clean1 == spc_clean2)

plot(spc_clean1)
</code></pre>

<hr>
<h2 id='Baseline-class'>An S4 Class to Represent a Spectrum Baseline</h2><span id='topic+Baseline-class'></span><span id='topic+.Baseline'></span><span id='topic+BaseLine-class'></span>

<h3>Description</h3>

<p>An S4 Class to Represent a Spectrum Baseline
</p>


<h3>Note</h3>

<p>This class extends the <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> class.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other class: 
<code><a href="#topic+CalibrationCurve-class">CalibrationCurve-class</a></code>,
<code><a href="#topic+GammaSpectra-class">GammaSpectra-class</a></code>,
<code><a href="#topic+GammaSpectrum-class">GammaSpectrum-class</a></code>,
<code><a href="#topic+PeakPosition-class">PeakPosition-class</a></code>,
<code><a href="#topic+coerce">coerce</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import a CNF file
spc_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
spc &lt;- read(spc_file)

## Remove the first 35 channels
spc &lt;- signal_slice(spc, -c(1:35))

## Linear baseline
bsl_linear &lt;- baseline_linear(spc, from = 250, to = 750)
plot(spc, bsl_linear)

## SNIP baseline
bsl_snip &lt;- baseline_snip(spc, LLS = FALSE, decreasing = FALSE, n = 100)
plot(spc, bsl_snip)

## Rubberband baseline
bsl_rubber &lt;- baseline_rubberband(spc)
plot(spc, bsl_rubber)

## Remove baseline
spc_clean1 &lt;- signal_correct(spc)
spc_clean2 &lt;- spc - bsl_snip
all(spc_clean1 == spc_clean2)

plot(spc_clean1)
</code></pre>

<hr>
<h2 id='BDX_LaBr_1'>CRP2A Calibration Curve (LaBr)</h2><span id='topic+BDX_LaBr_1'></span>

<h3>Description</h3>

<p>CRP2A Calibration Curve (LaBr)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BDX_LaBr_1)
</code></pre>


<h3>Format</h3>

<p>An object of class <a href="#topic+CalibrationCurve-class">CalibrationCurve</a>.
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Laboratory</strong> </td><td style="text-align: left;"> IRAMAT-CRP2A (UMR 5060) </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Instrument</strong> </td><td style="text-align: left;"> Canberra Inspector 1000 </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Detector</strong> </td><td style="text-align: left;"> LaBr </td>
</tr>
<tr>
 <td style="text-align: left;">
<strong>Authors</strong> </td><td style="text-align: left;"> CRP2A Luminescence Team
</td>
</tr>

</table>



<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+AIX_NaI_1">AIX_NaI_1</a></code>,
<code><a href="#topic+clermont">clermont</a></code>,
<code><a href="#topic+clermont_2024">clermont_2024</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load the curve
data(BDX_LaBr_1, package = "gamma")
plot(BDX_LaBr_1)
</code></pre>

<hr>
<h2 id='CalibrationCurve-class'>An S4 class to Represent a Dose Rate Calibration Curve</h2><span id='topic+CalibrationCurve-class'></span><span id='topic+DoseRateModel-class'></span><span id='topic+.DoseRateModel'></span><span id='topic+.CalibrationCurve'></span>

<h3>Description</h3>

<p>An S4 class to Represent a Dose Rate Calibration Curve
</p>


<h3>Slots</h3>


<dl>
<dt><code>Ni</code></dt><dd><p>A <a href="#topic+DoseRateModel-class">DoseRateModel</a> object.</p>
</dd>
<dt><code>NiEi</code></dt><dd><p>A <a href="#topic+DoseRateModel-class">DoseRateModel</a> object.</p>
</dd>
<dt><code>details</code></dt><dd><p>A <code><a href="base.html#topic+list">list</a></code> of length-one vector giving the curve metadata.</p>
</dd>
<dt><code>slope</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</dd>
<dt><code>intercept</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</dd>
<dt><code>covariance</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</dd>
<dt><code>MSWD</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</dd>
<dt><code>df</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</dd>
<dt><code>p_value</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</dd>
<dt><code>data</code></dt><dd><p>A <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
<dt><code>range</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</dd>
<dt><code>background</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.</p>
</dd>
</dl>


<h3>Subset</h3>

<p>In the code snippets below, <code>x</code> is a <code>CalibrationCurve</code> object.
</p>

<dl>
<dt><code>x[[i]]</code></dt><dd><p>Extracts information from a slot selected by subscript <code>i</code>.
<code>i</code> is a <code>character</code> vector of length one.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other class: 
<code><a href="#topic+Baseline-class">Baseline-class</a></code>,
<code><a href="#topic+GammaSpectra-class">GammaSpectra-class</a></code>,
<code><a href="#topic+GammaSpectrum-class">GammaSpectrum-class</a></code>,
<code><a href="#topic+PeakPosition-class">PeakPosition-class</a></code>,
<code><a href="#topic+coerce">coerce</a>()</code>
</p>

<hr>
<h2 id='clermont'>Clermont Reference Data</h2><span id='topic+clermont'></span>

<h3>Description</h3>

<p>Clermont Reference Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("clermont")
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with tabulated data and conversion factor reference.
</p>


<h3>Source</h3>

<p>Guérin, G., Mercier, N. &amp; Adamiec, G. (2011). Dose-Rate Conversion Factors:
Update. <em>Ancient TL</em>, 29(1), p. 5-8.
</p>
<p>Miallier, D., Guérin, G., Mercier, N., Pilleyre, T. &amp; Sanzelle, S.
(2009). The Clermont Radiometric Reference Rocks: A Convenient Tool
for Dosimetric Purposes. <em>Ancient TL</em>, 27(2), p. 37-44.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+AIX_NaI_1">AIX_NaI_1</a></code>,
<code><a href="#topic+BDX_LaBr_1">BDX_LaBr_1</a></code>,
<code><a href="#topic+clermont_2024">clermont_2024</a></code>
</p>

<hr>
<h2 id='clermont_2024'>Clermont Reference Data 2024</h2><span id='topic+clermont_2024'></span>

<h3>Description</h3>

<p>An updated version for the <code>clermont</code> dataset with additional columns
for the applied dose rate conversion factors and their reference. The dataset
also contains gamma dose rate values and uncertainties for different published
conversion factors. Please note that the values for the conversion factors
applied in the original <code>clermont</code> dataset differ slightly due to rounding
errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("clermont_2024")
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with tabulated data and conversion factor reference.
</p>


<h3>Source</h3>

<p>Adamiec, G. &amp; Aitken, M.J. (1998).
Dose-rate conversion factors: update. <em>Ancient TL</em>, 16, p. 37–50.
</p>
<p>Cresswell, A.J., Carter, J. &amp; Sanderson, D.C.W. (2018). Dose rate
conversion parameters: Assessment of nuclear data.
<em>Radiation Measurements</em>, 120, p. 195–201.
</p>
<p>Guérin, G., Mercier, N. &amp; Adamiec, G. (2011). Dose-Rate Conversion Factors:
Update. <em>Ancient TL</em>, 29(1), p. 5-8.
</p>
<p>Liritzis, I., Stamoulis, K., Papachristodoulou, C. &amp; Ioannides, K. (2013).
A re-evaluation of radiation dose-rate conversion factors.
<em>Mediterranean Archaeology and Archaeometry</em>, 12, p. 1–15.
</p>
<p>Miallier, D., Guérin, G., Mercier, N., Pilleyre, T. &amp; Sanzelle, S.
(2009). The Clermont Radiometric Reference Rocks: A Convenient Tool
for Dosimetric Purposes. <em>Ancient TL</em>, 27(2), p. 37-44.
</p>


<h3>See Also</h3>

<p>Other datasets: 
<code><a href="#topic+AIX_NaI_1">AIX_NaI_1</a></code>,
<code><a href="#topic+BDX_LaBr_1">BDX_LaBr_1</a></code>,
<code><a href="#topic+clermont">clermont</a></code>
</p>

<hr>
<h2 id='coerce'>Coerce</h2><span id='topic+coerce'></span><span id='topic+as.matrix.GammaSpectrum'></span>

<h3>Description</h3>

<p>Coerce
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GammaSpectrum'
as.matrix(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coerce_+3A_x">x</code></td>
<td>
<p>An object to be coerced.</p>
</td></tr>
<tr><td><code id="coerce_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A coerced object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other class: 
<code><a href="#topic+Baseline-class">Baseline-class</a></code>,
<code><a href="#topic+CalibrationCurve-class">CalibrationCurve-class</a></code>,
<code><a href="#topic+GammaSpectra-class">GammaSpectra-class</a></code>,
<code><a href="#topic+GammaSpectrum-class">GammaSpectrum-class</a></code>,
<code><a href="#topic+PeakPosition-class">PeakPosition-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import a Canberra CNF file
spc_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
spc &lt;- read(spc_file)

## Coerce
mtx &lt;- as.matrix(spc)
df &lt;- as.data.frame(spc)
head(df)
</code></pre>

<hr>
<h2 id='decay'>Nuclear Decay Data</h2><span id='topic+decay'></span>

<h3>Description</h3>

<p>An internal dataset containing the decay data for the following isotopes:
232-Th, 235-U, 238-U and 40-K.
</p>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with the following columns (absolute errors):
</p>

<dl>
<dt>decay_chain</dt><dd></dd>
<dt>isotope</dt><dd></dd>
<dt>occurrence</dt><dd></dd>
<dt>occurrence_error</dt><dd></dd>
<dt>post_radon</dt><dd></dd>
<dt>half_life</dt><dd></dd>
<dt>half_life_error</dt><dd></dd>
<dt>energy</dt><dd><p>Energy in keV.</p>
</dd>
<dt>energy_error</dt><dd></dd>
<dt>gamma_intensity</dt><dd></dd>
<dt>gamma_intensity_error</dt><dd></dd>
<dt>counts_chain</dt><dd></dd>
<dt>counts_chain_error</dt><dd></dd>
</dl>



<h3>Source</h3>

<p>Nuclides And Isotopes : Chart of the Nuclides.
</p>

<hr>
<h2 id='decay_La'>Lanthanum Decay Data</h2><span id='topic+decay_La'></span>

<h3>Description</h3>

<p>An internal dataset containing the decay data for the Lanthanum isotopes.
</p>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> with the following columns (absolute errors):
</p>

<dl>
<dt>decay_chain</dt><dd></dd>
<dt>isotope</dt><dd></dd>
<dt>occurrence</dt><dd></dd>
<dt>occurrence_error</dt><dd></dd>
<dt>post_radon</dt><dd></dd>
<dt>half_life</dt><dd></dd>
<dt>half_life_error</dt><dd></dd>
<dt>energy</dt><dd><p>Energy in keV.</p>
</dd>
<dt>energy_error</dt><dd></dd>
<dt>gamma_intensity</dt><dd></dd>
<dt>gamma_intensity_error</dt><dd></dd>
</dl>



<h3>Source</h3>

<p>Nuclides And Isotopes : Chart of the Nuclides.
</p>

<hr>
<h2 id='doserate'>Dose Rate Estimation</h2><span id='topic+doserate'></span><span id='topic+dose_fit'></span><span id='topic+dose_fit-method'></span><span id='topic+dose_predict'></span><span id='topic+dose_predict-method'></span><span id='topic+dose_fit+2CGammaSpectra+2CGammaSpectrumOrNumeric+2Cmatrix-method'></span><span id='topic+dose_fit+2CGammaSpectra+2CGammaSpectrum+2Cmatrix-method'></span><span id='topic+dose_fit+2CGammaSpectra+2CGammaSpectrumOrNumeric+2Cdata.frame-method'></span><span id='topic+dose_fit+2CGammaSpectra+2Cdata.frame-method'></span><span id='topic+dose_predict+2CCalibrationCurve+2Cmissing-method'></span><span id='topic+dose_predict+2CCalibrationCurve+2CGammaSpectrum-method'></span><span id='topic+dose_predict+2CCalibrationCurve+2CGammaSpectra-method'></span>

<h3>Description</h3>


<ul>
<li> <p><code>dose_fit()</code> builds a calibration curve for gamma dose rate estimation.
</p>
</li>
<li> <p><code>dose_predict()</code> predicts in situ gamma dose rate.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>dose_fit(object, background, doses, ...)

dose_predict(object, spectrum, ...)

## S4 method for signature 'GammaSpectra,GammaSpectrumOrNumeric,matrix'
dose_fit(
  object,
  background,
  doses,
  range_Ni,
  range_NiEi,
  details = list(authors = "", date = Sys.time())
)

## S4 method for signature 'GammaSpectra,GammaSpectrumOrNumeric,data.frame'
dose_fit(
  object,
  background,
  doses,
  range_Ni,
  range_NiEi,
  details = list(authors = "", date = Sys.time())
)

## S4 method for signature 'CalibrationCurve,missing'
dose_predict(
  object,
  sigma = 1,
  epsilon = 0.015,
  water_content = NULL,
  use_MC = FALSE
)

## S4 method for signature 'CalibrationCurve,GammaSpectrum'
dose_predict(
  object,
  spectrum,
  sigma = 1,
  epsilon = 0.015,
  water_content = NULL,
  use_MC = FALSE
)

## S4 method for signature 'CalibrationCurve,GammaSpectra'
dose_predict(
  object,
  spectrum,
  sigma = 1,
  epsilon = 0.015,
  water_content = NULL,
  use_MC = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="doserate_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectra-class">GammaSpectra</a> or <a href="#topic+CalibrationCurve-class">CalibrationCurve</a> object.</p>
</td></tr>
<tr><td><code id="doserate_+3A_background">background</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> object or a length-two <code><a href="base.html#topic+numeric">numeric</a></code>
vector giving the background noise integration value and error,
respectively. If no background subtraction is wanted, you can set <code>background = c(0,0,)</code></p>
</td></tr>
<tr><td><code id="doserate_+3A_doses">doses</code></td>
<td>
<p>A <code><a href="base.html#topic+matrix">matrix</a></code> or <code><a href="base.html#topic+data.frame">data.frame</a></code> object with gamma dose values and uncertainties.
The row names must match the names of the spectrum.</p>
</td></tr>
<tr><td><code id="doserate_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="doserate_+3A_spectrum">spectrum</code></td>
<td>
<p>An optional <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or <a href="#topic+GammaSpectra-class">GammaSpectra</a>
object in which to look for variables with which to predict. If omitted,
the fitted values are used.</p>
</td></tr>
<tr><td><code id="doserate_+3A_range_ni">range_Ni</code>, <code id="doserate_+3A_range_niei">range_NiEi</code></td>
<td>
<p>A length-two <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the energy
range to integrate within (in keV).</p>
</td></tr>
<tr><td><code id="doserate_+3A_details">details</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> of length-one vector specifying additional
informations about the instrument for which the curve is built.</p>
</td></tr>
<tr><td><code id="doserate_+3A_sigma">sigma</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> value giving the confidence level of which the error from the
slope is considered in the final uncertainty calculation</p>
</td></tr>
<tr><td><code id="doserate_+3A_epsilon">epsilon</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> value giving an extra relative error term,
introduced by the calibration of the energy scale of the spectrum,
e.g., <code>0.015</code> for an additional 1.5% error</p>
</td></tr>
<tr><td><code id="doserate_+3A_water_content">water_content</code></td>
<td>
<p><code><a href="base.html#topic+numeric">numeric</a></code> or <code><a href="base.html#topic+matrix">matrix</a></code> gravimetric field water content to correct
the gamma-dose rate to using the correction factor by Aitken (1985) to obtain the dry gamma-dose
rate. Example: <code>c(0.05,0.0001)</code> for water content of 5% +/- 0.01 %. The default is <code>NULL</code> (nothing is corrected).
The correction only works on the final dose rate. For more information see details.</p>
</td></tr>
<tr><td><code id="doserate_+3A_use_mc">use_MC</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> parameter, enabling/disabling Monte Carlo simulations for estimating
the dose rate uncertainty</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To estimate the gamma dose rate, one of the calibration curves distributed
with this package can be used. These built-in curves are in use in several
luminescence dating laboratories and can be used to replicate published
results. As these curves are instrument specific, the user may have to build
its own curve.
</p>
<p>The construction of a calibration curve requires a set of reference spectra
for which the gamma dose rate is known and a background noise measurement.
First, each reference spectrum is integrated over a given interval, then
normalized to active time and corrected for background noise. The dose rate
is finally modelled by the integrated signal value used as a linear
predictor (York <em>et al.</em>, 2004).
</p>


<h3>Value</h3>


<ul>
<li> <p><code>dose_fit()</code> returns a <a href="#topic+CalibrationCurve-class">CalibrationCurve</a> object.
</p>
</li>
<li> <p><code>dose_predict()</code> returns a <code><a href="base.html#topic+data.frame">data.frame</a></code> with the following columns:
</p>

<dl>
<dt><code>name</code></dt><dd><p>(<code><a href="base.html#topic+character">character</a></code>) the name of the spectra.</p>
</dd>
<dt><code>signal_Ni</code></dt><dd><p>(<code><a href="base.html#topic+numeric">numeric</a></code>) the integrated signal value (according to
the value of <code>threshold</code>; see <code><a href="#topic+signal_integrate">signal_integrate()</a></code>) for <code>energy = FALSE</code></p>
</dd>
<dt><code>signal_err_Ni</code></dt><dd><p>(<code><a href="base.html#topic+numeric">numeric</a></code>) the integrated signal error value
(according to the value of <code>threshold</code>; see <code><a href="#topic+signal_integrate">signal_integrate()</a></code>) for <code>energy = FALSE</code>.</p>
</dd>
<dt><code>dose_Ni</code></dt><dd><p>(<code><a href="base.html#topic+numeric">numeric</a></code>) the predicted gamma dose rate for <code>energy = FALSE</code>.</p>
</dd>
<dt><code>dose_err_Ni</code></dt><dd><p>(<code><a href="base.html#topic+numeric">numeric</a></code>) the predicted gamma dose rate error for <code>energy = FALSE</code>.</p>
</dd>
<dt><code>signal_Ni</code></dt><dd><p>(<code><a href="base.html#topic+numeric">numeric</a></code>) the integrated signal value (according to
the value of <code>threshold</code>; see <code><a href="#topic+signal_integrate">signal_integrate()</a></code>).</p>
</dd>
<dt><code>signal_err_NiEi</code></dt><dd><p>(<code><a href="base.html#topic+numeric">numeric</a></code>) the integrated signal error value
(according to the value of <code>threshold</code>; see <code><a href="#topic+signal_integrate">signal_integrate()</a></code>) for <code>energy = TRUE</code>.</p>
</dd>
<dt><code>dose_NiEi</code></dt><dd><p>(<code><a href="base.html#topic+numeric">numeric</a></code>) the predicted gamma dose rate for <code>energy = TRUE</code>.</p>
</dd>
<dt><code>dose_err_NiEi</code></dt><dd><p>(<code><a href="base.html#topic+numeric">numeric</a></code>) the predicted gamma dose rate error for <code>energy = TRUE</code>.</p>
</dd>
<dt><code>dose_final</code></dt><dd><p>(<code><a href="base.html#topic+numeric">numeric</a></code>) the predicted final gamma dose rate as the mean of <code>dose_Ni</code> and <code>dose_NiEi</code></p>
</dd>
<dt><code>dose_err_final</code></dt><dd><p>(<code><a href="base.html#topic+numeric">numeric</a></code>) the predicted final gamma dose rate error as
<code class="reqn">SE(\dot{D}_{\gamma}) = \sqrt{(\frac{SE(\dot{D}_{\gamma\mathrm{Ni}})}{\dot{D}_{\gamma\mathrm{Ni}}})^2 +
   (\frac{SE(\dot{D}_{\gamma\mathrm{NiEi}})}{\dot{D}_{\gamma\mathrm{NiEi}}})^2}</code></p>
</dd>
</dl>

</li></ul>



<h3>Uncertainty calculation of the gamma-dose rate</h3>

<p>The analytical uncertainties of the final gamma-dose rate (<code class="reqn">SE(\dot{D}_{\gamma})</code>) are calculated as
follows:
</p>
<p style="text-align: center;"><code class="reqn">
 \sigma_{\dot{D_\gamma}} = \sqrt((\frac{m_{\delta}s}{m})^2 + (\frac{s_{\delta}}{s})^2 + \epsilon^2)
 </code>
</p>

<p>with <code class="reqn">m</code> and <code class="reqn">m_{\delta}</code> being the slope of the fit an its uncertainty,
<code class="reqn">\sigma</code> the error scaler for the slope uncertainty, <code class="reqn">s</code> and <code class="reqn">s_{\delta}</code>
the integrated signal and its uncertainty, and <code class="reqn">\epsilon</code> an additional relative uncertainty
term that can be set by the user using the argument <code>epsilon</code>.
</p>
<p>If the parameter <code>use_MC</code> is set to <code>TRUE</code>, the a Monte Carlo sampling approach
is chosen to approximate the uncertainties on the dose rate:
</p>
<p style="text-align: center;"><code class="reqn">
   \sigma_{\dot{D_\gamma}} :=
   \sqrt((\frac{SD(\mathcal{N}(\mu_{slope}, \sigma_{slope}) \times \mathcal{N}(\mu_{signal}, \sigma_{signal}) +
   \mathcal{N}(\mu_{intercept}, \sigma_{intercept})) * \rho}{\dot{D_\gamma}})^2 +
   \epsilon^2) * \dot{D_\gamma}
 </code>
</p>

<p><code class="reqn">\ rho</code> is the parameter <code>sigma</code> provided with the function call, <code class="reqn">SD</code> equals the
the call to <code>sd()</code>, i.e. the calculation of the standard deviation. To achieve a good
Gaussian normal approximation with sample 1+e06 times (the values is fixed).
</p>


<h3>Water content correction</h3>

<p>If gamma-dose rates are measured in the field, they are measured at  &quot;as-is&quot;
conditions. In dating studies, however, using the dry dose rate is often
more desirable to model the long-term effect of different assumptions for
the water content. If the parameter <code>water_content</code>, either as <a href="base.html#topic+numeric">numeric</a>
vector or as <a href="base.html#topic+matrix">matrix</a> with the number of rows equal to the number of
processed spectra,  if different values are desired, the <strong>final</strong>
gamma-dose rate is corrected for the water content provided. Final
uncertainties are obtained using the square root of the summed squared
relative uncertainties of the dose rate and the water content.
</p>
<p>A word of caution: When estimating the water content in the laboratory,
the water analytical uncertainty is usually minimal, and it does not make
sense to correct with a relative water content of, e.g., c(0.02,0.02)
(2% +/- 2%) because this massively inflates the final dose rate error.
</p>


<h3>Note</h3>

<p>See <code>vignette(doserate)</code> for a reproducible example.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Aitken, M.J. (1985). <em>Thermoluminescence dating</em>. London: Academic Press.
</p>
<p>Mercier, N. &amp; Falguères, C. (2007). Field Gamma Dose-Rate Measurement with
a NaI(Tl) Detector: Re-Evaluation of the &quot;Threshold&quot; Technique.
<em>Ancient TL</em>, 25(1), p. 1-4.
</p>
<p>York, D., Evensen, N. M., Martínez, M. L. &amp; De Basabe Delgado, J. (2004).
Unified Equations for the Slope, Intercept, and Standard Errors of the Best
Straight Line. <em>American Journal of Physics</em>, 72(3), p. 367-75.
<a href="https://doi.org/10.1119/1.1632486">doi:10.1119/1.1632486</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+signal_integrate">signal_integrate()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import CNF files
## Spectra
spc_dir &lt;- system.file("extdata/BDX_LaBr_1/calibration", package = "gamma")
spc &lt;- read(spc_dir)

## Background
bkg_dir &lt;- system.file("extdata/BDX_LaBr_1/background", package = "gamma")
bkg &lt;- read(bkg_dir)

## Get dose rate values
data("clermont")
(doses &lt;- clermont[, c("gamma_dose", "gamma_error")])

## Build the calibration curve
calib_curve &lt;- dose_fit(spc, bkg, doses,
                        range_Ni = c(300, 2800),
                        range_NiEi = c(165, 2800))

## Plot the curve
plot(calib_curve, threshold = "Ni")

## Estimate gamma dose rates
dose_predict(calib_curve, spc)
</code></pre>

<hr>
<h2 id='energy'>Energy Scale Calibration</h2><span id='topic+energy'></span><span id='topic+energy_calibrate'></span><span id='topic+energy_calibrate-method'></span><span id='topic+has_energy'></span><span id='topic+has_calibration'></span><span id='topic+energy_calibrate+2CGammaSpectrum+2Clm-method'></span><span id='topic+energy_calibrate+2CGammaSpectrum+2CGammaSpectrum-method'></span><span id='topic+energy_calibrate+2CGammaSpectrum+2CCalibrationCurve-method'></span><span id='topic+energy_calibrate+2CGammaSpectrum+2Clist-method'></span><span id='topic+energy_calibrate+2CGammaSpectrum+2CPeakPosition-method'></span><span id='topic+energy_calibrate+2CGammaSpectra+2Clist-method'></span><span id='topic+energy_calibrate+2CGammaSpectra+2CPeakPosition-method'></span><span id='topic+energy_calibrate+2CGammaSpectra+2Clm-method'></span><span id='topic+energy_calibrate+2CGammaSpectra+2CGammaSpectrum-method'></span><span id='topic+energy_calibrate+2CGammaSpectra+2CCalibrationCurve-method'></span><span id='topic+has_energy+2CGammaSpectrum-method'></span><span id='topic+has_energy+2CGammaSpectra-method'></span><span id='topic+has_calibration+2CGammaSpectrum-method'></span><span id='topic+has_calibration+2CGammaSpectra-method'></span><span id='topic+has_calibration+2CCalibrationCurve-method'></span>

<h3>Description</h3>

<p>Calibrates the energy scale of a gamma spectrum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>energy_calibrate(object, lines, ...)

has_energy(object)

has_calibration(object)

## S4 method for signature 'GammaSpectrum,lm'
energy_calibrate(object, lines, ...)

## S4 method for signature 'GammaSpectrum,GammaSpectrum'
energy_calibrate(object, lines, ...)

## S4 method for signature 'GammaSpectrum,CalibrationCurve'
energy_calibrate(object, lines, ...)

## S4 method for signature 'GammaSpectrum,list'
energy_calibrate(object, lines, ...)

## S4 method for signature 'GammaSpectrum,PeakPosition'
energy_calibrate(object, lines, ...)

## S4 method for signature 'GammaSpectra,list'
energy_calibrate(object, lines, ...)

## S4 method for signature 'GammaSpectra,PeakPosition'
energy_calibrate(object, lines, ...)

## S4 method for signature 'GammaSpectra,lm'
energy_calibrate(object, lines, ...)

## S4 method for signature 'GammaSpectra,GammaSpectrum'
energy_calibrate(object, lines, ...)

## S4 method for signature 'GammaSpectra,CalibrationCurve'
energy_calibrate(object, lines, ...)

## S4 method for signature 'GammaSpectrum'
has_energy(object)

## S4 method for signature 'GammaSpectra'
has_energy(object)

## S4 method for signature 'GammaSpectrum'
has_calibration(object)

## S4 method for signature 'GammaSpectra'
has_calibration(object)

## S4 method for signature 'CalibrationCurve'
has_calibration(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="energy_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or <a href="#topic+GammaSpectra-class">GammaSpectra</a> object.</p>
</td></tr>
<tr><td><code id="energy_+3A_lines">lines</code></td>
<td>
<p>A <a href="#topic+PeakPosition-class">PeakPosition</a> object or a <code><a href="base.html#topic+list">list</a></code> of length two. If a
<code>list</code> is provided, each element must be a named numeric vector giving the
observed peak position (&quot;<code>channel</code>&quot;) and the corresponding expected
&quot;<code>energy</code>&quot; value (in keV). Alternatively, the function accepts the <a href="stats.html#topic+lm">stats::lm</a>
object from a another calibration or a <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> object from which such
calibration is copied. With this, energy calibrations can be transferred from one object
to another.</p>
</td></tr>
<tr><td><code id="energy_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The energy calibration of a spectrum is the most tricky part. To do this,
the user must specify the position of at least three observed peaks and the
corresponding energy value (in keV). A second order polynomial model is
fitted on these energy <em>vs</em> channel values, then used to predict the
new energy scale of the spectrum.
</p>
<p>The package allows to provide the channel-energy pairs to be use. However,
the spectrum can be noisy so it is difficult to properly determine the peak
channel. In this case, a better approach may be to pre-process the spectrum
(variance-stabilization, smoothing and baseline correction) and perform a
peak detection. Once the identified peaks are satisfactory, you can set the
corresponding energy values (in keV) and use these lines to calibrate the
energy scale of the spectrum.
</p>
<p>Regardless of the approach you choose, it is strongly recommended to check
the result before proceeding.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>energy_calibrate()</code> returns either a <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or a <a href="#topic+GammaSpectra-class">GammaSpectra</a>
object depending on the input#
</p>
</li>
<li> <p><code>has_energy()</code> and <code>has_calibration()</code> return a <code><a href="base.html#topic+logical">logical</a></code> vector.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import a CNF file
spc_file &lt;- system.file("extdata/LaBr.TKA", package = "gamma")
(spc &lt;- read(spc_file))

## Set peak positions (channel) and expected energy values
calib_lines &lt;- list(
  channel = c(86, 495, 879),
  energy = c(238, 1461, 2615)
)

## Adjust the energy scale
(spc1 &lt;- energy_calibrate(spc, lines = calib_lines))

## Inspect results
plot(spc1, xaxis = "energy", yaxis = "count") +
  ggplot2::geom_vline(xintercept = c(238, 1461, 2615), linetype = 3)
</code></pre>

<hr>
<h2 id='GammaSpectra-class'>An S4 Class to Represent a Collection of Gamma Sectra</h2><span id='topic+GammaSpectra-class'></span><span id='topic+.GammaSpectra'></span>

<h3>Description</h3>

<p>Represents a collection of spectra of gamma ray spectrometry measurements.
</p>


<h3>Details</h3>

<p>This class extends the base <code><a href="base.html#topic+list">list</a></code> and can only contains
<a href="#topic+GammaSpectrum-class">GammaSpectrum</a> objects.
</p>


<h3>Access</h3>

<p>In the code snippets below, <code>x</code> is a <code>GammaSpectra</code> object.
</p>

<dl>
<dt><code>length(x)</code></dt><dd><p>Get the number of elements in <code>x</code>.</p>
</dd>
<dt><code>lengths(x)</code></dt><dd><p>Get the number of channels in each element of <code>x</code>.</p>
</dd>
<dt><code>get_names(x)</code>, <code>set_names(x) &lt;- value</code></dt><dd><p>Retrieves or sets
the names of <code>x</code> according to <code>value</code>.</p>
</dd>
<dt><code>get_hash(x)</code></dt><dd><p>Get the MD5 hash of the raw data files.</p>
</dd>
<dt><code>get_channels(x)</code></dt><dd><p>Get the number of channels in each element of <code>x</code>.</p>
</dd>
<dt><code>get_counts(x)</code></dt><dd><p>Get the counts of each element of <code>x</code>.</p>
</dd>
<dt><code>get_energy(x)</code></dt><dd><p>Get the energy range of each element of <code>x</code>.</p>
</dd>
<dt><code>get_rates(x)</code></dt><dd><p>Get the count rates of each element of <code>x</code>.</p>
</dd>
</dl>



<h3>Subset</h3>

<p>In the code snippets below, <code>x</code> is a <code>GammaSpectra</code> object.
</p>

<dl>
<dt><code>x[i]</code></dt><dd><p>Extracts the elements selected by subscript <code>i</code>.
<code>i</code> can be <code>missing</code> or <code>NULL</code>, <code>numeric</code> or <code>character</code> vector or a
<code>factor</code>. Returns a new <code>GammaSpectra</code> object.</p>
</dd>
<dt><code>x[i, j]</code></dt><dd><p>Like the above but allows to select a slot thru <code>j</code> (see
examples). <code>j</code> is a <code>character</code> vector of length one. Returns a <code>list</code>.</p>
</dd>
<dt><code>x[[i]]</code></dt><dd><p>Extracts the elements selected by subscript <code>i</code>.
<code>i</code> can be a <code>numeric</code> or <code>character</code> vector of length one. Returns the
corresponding <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> object.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other class: 
<code><a href="#topic+Baseline-class">Baseline-class</a></code>,
<code><a href="#topic+CalibrationCurve-class">CalibrationCurve-class</a></code>,
<code><a href="#topic+GammaSpectrum-class">GammaSpectrum-class</a></code>,
<code><a href="#topic+PeakPosition-class">PeakPosition-class</a></code>,
<code><a href="#topic+coerce">coerce</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import all CNF files in a given directory
spc_dir &lt;- system.file("extdata/BDX_LaBr_1/calibration", package = "gamma")
(spc &lt;- read(spc_dir))

## Access
get_hash(spc)
get_names(spc)
get_livetime(spc)
get_realtime(spc)

lengths(spc)
range_energy(spc)

## Subset
spc[] # All spectra
spc[NULL] # All spectra
spc[1] # The first spectrum
spc[-6] # Delete the sixth spectrum
spc[1:3] # The first three spectra
spc[c(1, 3)] # The first and third spectra
spc["BRIQUE"] # The spectrum named 'BRIQUE'
spc[c("BRIQUE", "C347")] # The spectra named 'BRIQUE' and 'C347'
spc[1:3, "energy"] # The slot 'energy' of the first three spectra
spc[[1]]
spc[["BRIQUE"]]
</code></pre>

<hr>
<h2 id='GammaSpectrum-class'>An S4 Class to Represent a Gamma Spectrum</h2><span id='topic+GammaSpectrum-class'></span><span id='topic+.GammaSpectrum'></span>

<h3>Description</h3>

<p>Represents a single spectrum of a gamma ray spectrometry measurement.
</p>


<h3>Slots</h3>


<dl>
<dt><code>hash</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> string giving the 32-byte MD5 hash of
the imported file.</p>
</dd>
<dt><code>name</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> string the measurement reference.</p>
</dd>
<dt><code>date</code></dt><dd><p>A <code><a href="base.html#topic+POSIXct">POSIXct</a></code> element giving the measurement date and time.</p>
</dd>
<dt><code>instrument</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> string giving the instrument name.</p>
</dd>
<dt><code>file_format</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> string giving the format of the
imported file.</p>
</dd>
<dt><code>live_time</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> value.</p>
</dd>
<dt><code>real_time</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> value.</p>
</dd>
<dt><code>channel</code></dt><dd><p>A <code><a href="base.html#topic+integer">integer</a></code> vector giving the channel number.
Numeric values are coerced to integer as by <code><a href="base.html#topic+as.integer">as.integer()</a></code>
(and hence truncated towards zero).</p>
</dd>
<dt><code>energy</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the gamma ray's energy (in keV).</p>
</dd>
<dt><code>count</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the counts number for each channel.
Numeric values are coerced to integer as by <code><a href="base.html#topic+as.integer">as.integer()</a></code> (and hence
truncated towards zero).</p>
</dd>
<dt><code>rate</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector the count rate (<code class="reqn">1/s</code>) for each channel.</p>
</dd>
<dt><code>calibration</code></dt><dd><p>A <a href="stats.html#topic+lm">linear model</a> used for energy scale
calibration (see <code><a href="#topic+energy_calibrate">energy_calibrate()</a></code>).</p>
</dd>
</dl>


<h3>Access</h3>

<p>In the code snippets below, <code>x</code> is a <code>GammaSpectrum</code> object.
</p>

<dl>
<dt><code>length(x)</code></dt><dd><p>Get number of channel in <code>x</code>.</p>
</dd>
<dt><code>get_hash(x)</code></dt><dd><p>Get the MD5 hash of the raw data file.</p>
</dd>
<dt><code>get_names(x)</code>, <code>set_names(x) &lt;- value</code></dt><dd><p>Retrieves or sets
the name of <code>x</code> according to <code>value</code>.</p>
</dd>
<dt><code>get_channels(x)</code></dt><dd><p>Get the number of channels in <code>x</code>.</p>
</dd>
<dt><code>get_counts(x)</code></dt><dd><p>Get the counts of <code>x</code>.</p>
</dd>
<dt><code>get_energy(x)</code></dt><dd><p>Get the energy range of <code>x</code>.</p>
</dd>
<dt><code>get_rates(x)</code></dt><dd><p>Get the count rates of <code>x</code>.</p>
</dd>
</dl>



<h3>Coerce</h3>

<p>In the code snippets below, <code>x</code> is a <code>GammaSpectrum</code> object.
</p>

<dl>
<dt><code>as.matrix(x)</code></dt><dd><p>Coerces <code>x</code> to a <code><a href="base.html#topic+matrix">matrix</a></code>.</p>
</dd>
<dt><code>as.data.frame(x)</code></dt><dd><p>Coerces <code>x</code> to a <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
</dl>



<h3>Subset</h3>

<p>In the code snippets below, <code>x</code> is a <code>GammaSpectrum</code> object.
</p>

<dl>
<dt><code>x[[i]]</code></dt><dd><p>Extracts information from a slot selected by subscript <code>i</code>.
<code>i</code> is a <code>character</code> vector of length one and will be matched to the name of
the slots.</p>
</dd>
</dl>



<h3>Note</h3>

<p>This class retains copy construction.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other class: 
<code><a href="#topic+Baseline-class">Baseline-class</a></code>,
<code><a href="#topic+CalibrationCurve-class">CalibrationCurve-class</a></code>,
<code><a href="#topic+GammaSpectra-class">GammaSpectra-class</a></code>,
<code><a href="#topic+PeakPosition-class">PeakPosition-class</a></code>,
<code><a href="#topic+coerce">coerce</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import a Canberra CNF file
spc_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
(spc &lt;- read(spc_file))

## Access
get_hash(spc)
get_names(spc)
get_livetime(spc)
get_realtime(spc)

length(spc)
range_energy(spc)

## Subset
spc[["date"]]
spc[["instrument"]]
spc[["file_format"]]
</code></pre>

<hr>
<h2 id='mutator'>Get or Set Parts of an Object</h2><span id='topic+mutator'></span><span id='topic+get'></span><span id='topic+set'></span><span id='topic+get_hash'></span><span id='topic+get_hash-method'></span><span id='topic+get_names'></span><span id='topic+get_names-method'></span><span id='topic+set_names+3C-'></span><span id='topic+set_names-method'></span><span id='topic+get_energy_calibration'></span><span id='topic+get_energy_calibration-method'></span><span id='topic+set_energy_calibration+3C-'></span><span id='topic+set_energy_calibration-method'></span><span id='topic+get_livetime'></span><span id='topic+get_livetime-method'></span><span id='topic+get_realtime'></span><span id='topic+get_realtime-method'></span><span id='topic+get_channels'></span><span id='topic+get_channels-method'></span><span id='topic+get_counts'></span><span id='topic+get_counts-method'></span><span id='topic+get_rates'></span><span id='topic+get_rates-method'></span><span id='topic+get_energy'></span><span id='topic+get_energy-method'></span><span id='topic+set_energy+3C-'></span><span id='topic+set_energy-method'></span><span id='topic+get_method'></span><span id='topic+get_method-method'></span><span id='topic+set_method+3C-'></span><span id='topic+set_method-method'></span><span id='topic+get_residuals'></span><span id='topic+get_residuals-method'></span><span id='topic+range_channels'></span><span id='topic+range_channels-method'></span><span id='topic+range_energy'></span><span id='topic+range_energy-method'></span><span id='topic+length+2CGammaSpectrum-method'></span><span id='topic+get_hash+2CGammaSpectrum-method'></span><span id='topic+get_names+2CGammaSpectrum-method'></span><span id='topic+get_livetime+2CGammaSpectrum-method'></span><span id='topic+get_realtime+2CGammaSpectrum-method'></span><span id='topic+get_channels+2CGammaSpectrum-method'></span><span id='topic+get_counts+2CGammaSpectrum-method'></span><span id='topic+get_rates+2CGammaSpectrum-method'></span><span id='topic+get_energy+2CGammaSpectrum-method'></span><span id='topic+range_energy+2CGammaSpectrum-method'></span><span id='topic+range_channels+2CGammaSpectrum-method'></span><span id='topic+get_method+2CBaseline-method'></span><span id='topic+set_method+2CBaseline-method'></span><span id='topic+get_hash+2CGammaSpectra-method'></span><span id='topic+get_names+2CGammaSpectra-method'></span><span id='topic+get_livetime+2CGammaSpectra-method'></span><span id='topic+get_realtime+2CGammaSpectra-method'></span><span id='topic+get_channels+2CGammaSpectra-method'></span><span id='topic+get_counts+2CGammaSpectra-method'></span><span id='topic+get_rates+2CGammaSpectra-method'></span><span id='topic+get_energy+2CGammaSpectra-method'></span><span id='topic+range_energy+2CGammaSpectra-method'></span><span id='topic+range_channels+2CGammaSpectra-method'></span><span id='topic+get_residuals+2CDoseRateModel-method'></span><span id='topic+get_hash+2CPeakPosition-method'></span><span id='topic+get_channels+2CPeakPosition-method'></span><span id='topic+get_energy+2CPeakPosition-method'></span><span id='topic+set_names+3C-+2CGammaSpectrum-method'></span><span id='topic+set_names+2CGammaSpectrum-method'></span><span id='topic+set_energy_calibration+3C-+2CGammaSpectrum-method'></span><span id='topic+set_energy_calibration+2CGammaSpectrum-method'></span><span id='topic+get_energy_calibration+2CGammaSpectrum-method'></span><span id='topic+set_method+3C-+2CBaseline-method'></span><span id='topic+set_names+3C-+2CGammaSpectra-method'></span><span id='topic+set_name+2CGammaSpectra-method'></span><span id='topic+set_energy_calibration+3C-+2CGammaSpectra-method'></span><span id='topic+set_energy_calibration+2CGammaSpectra-method'></span><span id='topic+get_energy_calibration+2CGammaSpectra-method'></span><span id='topic+set_energy+3C-+2CPeakPosition+2Cnumeric-method'></span><span id='topic+set_energy+2CPeakPosition+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Getters and setters to extract or replace parts of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_hash(x)

get_names(x)

set_names(x) &lt;- value

get_energy_calibration(x)

set_energy_calibration(x) &lt;- value

get_livetime(x)

get_realtime(x)

get_channels(x)

get_counts(x)

get_rates(x)

get_energy(x, ...)

set_energy(x) &lt;- value

get_method(x)

set_method(x) &lt;- value

get_residuals(x)

range_channels(x, ...)

range_energy(x, ...)

## S4 method for signature 'GammaSpectrum'
length(x)

## S4 method for signature 'GammaSpectrum'
get_hash(x)

## S4 method for signature 'GammaSpectrum'
get_names(x)

## S4 method for signature 'GammaSpectrum'
get_livetime(x)

## S4 method for signature 'GammaSpectrum'
get_realtime(x)

## S4 method for signature 'GammaSpectrum'
get_channels(x)

## S4 method for signature 'GammaSpectrum'
get_counts(x)

## S4 method for signature 'GammaSpectrum'
get_rates(x)

## S4 method for signature 'GammaSpectrum'
get_energy(x)

## S4 method for signature 'GammaSpectrum'
range_energy(x, na.rm = FALSE)

## S4 method for signature 'GammaSpectrum'
range_channels(x, na.rm = FALSE)

## S4 method for signature 'Baseline'
get_method(x)

## S4 method for signature 'GammaSpectra'
get_hash(x)

## S4 method for signature 'GammaSpectra'
get_names(x)

## S4 method for signature 'GammaSpectra'
get_livetime(x)

## S4 method for signature 'GammaSpectra'
get_realtime(x)

## S4 method for signature 'GammaSpectra'
get_channels(x)

## S4 method for signature 'GammaSpectra'
get_counts(x)

## S4 method for signature 'GammaSpectra'
get_rates(x)

## S4 method for signature 'GammaSpectra'
get_energy(x)

## S4 method for signature 'GammaSpectra'
range_energy(x, na.rm = FALSE)

## S4 method for signature 'GammaSpectra'
range_channels(x, na.rm = FALSE)

## S4 method for signature 'DoseRateModel'
get_residuals(x)

## S4 method for signature 'PeakPosition'
get_hash(x)

## S4 method for signature 'PeakPosition'
get_channels(x)

## S4 method for signature 'PeakPosition'
get_energy(x, expected = FALSE)

## S4 replacement method for signature 'GammaSpectrum'
set_names(x) &lt;- value

## S4 replacement method for signature 'GammaSpectrum'
set_energy_calibration(x) &lt;- value

## S4 method for signature 'GammaSpectrum'
get_energy_calibration(x)

## S4 replacement method for signature 'Baseline'
set_method(x) &lt;- value

## S4 replacement method for signature 'GammaSpectra'
set_names(x) &lt;- value

## S4 replacement method for signature 'GammaSpectra'
set_energy_calibration(x) &lt;- value

## S4 method for signature 'GammaSpectra'
get_energy_calibration(x)

## S4 replacement method for signature 'PeakPosition,numeric'
set_energy(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mutator_+3A_x">x</code></td>
<td>
<p>An object from which to get or set element(s).</p>
</td></tr>
<tr><td><code id="mutator_+3A_value">value</code></td>
<td>
<p>A possible value for the element(s) of <code>x</code>.</p>
</td></tr>
<tr><td><code id="mutator_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="mutator_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should <code><a href="base.html#topic+NA">NA</a></code> be omitted?</p>
</td></tr>
<tr><td><code id="mutator_+3A_expected">expected</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the expected values be returned
instead of observed values?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same sort as <code>x</code> with the new values assigned.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutator: 
<code><a href="#topic+subset">subset</a>()</code>
</p>

<hr>
<h2 id='operator'>Common Operations on GammaSpectrum Objects</h2><span id='topic+operator'></span><span id='topic+Arith+2CGammaSpectrum+2CGammaSpectrum-method'></span><span id='topic+Arith+2CGammaSpectrum+2Cnumeric-method'></span><span id='topic+Compare+2CGammaSpectrum+2CGammaSpectrum-method'></span><span id='topic+Compare+2CGammaSpectrum+2Cnumeric-method'></span><span id='topic+Logic+2CGammaSpectrum+2CGammaSpectrum-method'></span><span id='topic+Logic+2CGammaSpectrum+2Cnumeric-method'></span><span id='topic+Logic+2CGammaSpectrum+2Clogical-method'></span><span id='topic+Math+2CGammaSpectrum-method'></span><span id='topic+Math2+2CGammaSpectrum-method'></span><span id='topic+Summary+2CGammaSpectrum-method'></span>

<h3>Description</h3>

<p>Performs common operations on <code>GammaSpectrum</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'GammaSpectrum,GammaSpectrum'
Arith(e1, e2)

## S4 method for signature 'GammaSpectrum,numeric'
Arith(e1, e2)

## S4 method for signature 'GammaSpectrum,GammaSpectrum'
Compare(e1, e2)

## S4 method for signature 'GammaSpectrum,numeric'
Compare(e1, e2)

## S4 method for signature 'GammaSpectrum,GammaSpectrum'
Logic(e1, e2)

## S4 method for signature 'GammaSpectrum,numeric'
Logic(e1, e2)

## S4 method for signature 'GammaSpectrum,logical'
Logic(e1, e2)

## S4 method for signature 'GammaSpectrum'
Math(x)

## S4 method for signature 'GammaSpectrum'
Math2(x, digits)

## S4 method for signature 'GammaSpectrum'
Summary(x, ..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="operator_+3A_x">x</code>, <code id="operator_+3A_e1">e1</code>, <code id="operator_+3A_e2">e2</code></td>
<td>
<p>An object (typically a <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> object).</p>
</td></tr>
<tr><td><code id="operator_+3A_digits">digits</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the number of digits to
be used in <code><a href="base.html#topic+round">round()</a></code> or <code><a href="base.html#topic+signif">signif()</a></code>.</p>
</td></tr>
<tr><td><code id="operator_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from methods.</p>
</td></tr>
<tr><td><code id="operator_+3A_na.rm">na.rm</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should missing values (including <code>NaN</code>) be
omitted from the calculations?</p>
</td></tr>
</table>


<h3>Group Generics</h3>

<p><a href="#topic+GammaSpectrum-class">GammaSpectrum</a> objects have support for S4 group generic
functionality to operate within elements across objects:
</p>

<dl>
<dt><code>Arith</code></dt><dd><p>&quot;<code>+</code>&quot;, &quot;<code>-</code>&quot;, &quot;<code>*</code>&quot;, &quot;<code>^</code>&quot;, &quot;<code style="white-space: pre;">&#8288;\%\%&#8288;</code>&quot;, &quot;<code style="white-space: pre;">&#8288;\%/\%&#8288;</code>&quot;, &quot;<code>/</code>&quot;</p>
</dd>
<dt><code>Compare</code></dt><dd><p>&quot;<code>==</code>&quot;, &quot;<code>&gt;</code>&quot;, &quot;<code>&lt;</code>&quot;, &quot;<code>!=</code>&quot;, &quot;<code>&lt;=</code>&quot;, &quot;<code>&gt;=</code>&quot;</p>
</dd>
<dt><code>Logic</code></dt><dd><p>&quot;<code>&amp;</code>&quot;, &quot;<code>|</code>&quot;</p>
</dd>
<dt><code>Math</code></dt><dd><p>&quot;<code>abs</code>&quot;, &quot;<code>sign</code>&quot;, &quot;<code>sqrt</code>&quot;, &quot;<code>ceiling</code>&quot;, &quot;<code>floor</code>&quot;,
&quot;<code>trunc</code>&quot;, &quot;<code>cummax</code>&quot;, &quot;<code>cummin</code>&quot;, &quot;<code>cumprod</code>&quot;, &quot;<code>cumsum</code>&quot;, &quot;<code>log</code>&quot;,
&quot;<code>log10</code>&quot;, &quot;<code>log2</code>&quot;, &quot;<code>log1p</code>&quot;, &quot;<code>acos</code>&quot;, &quot;<code>acosh</code>&quot;, &quot;<code>asin</code>&quot;, &quot;<code>asinh</code>&quot;,
&quot;<code>atan</code>&quot;, &quot;<code>atanh</code>&quot;, &quot;<code>exp</code>&quot;, &quot;<code>expm1</code>&quot;, &quot;<code>cos</code>&quot;, &quot;<code>cosh</code>&quot;, &quot;<code>cospi</code>&quot;,
&quot;<code>sin</code>&quot;, &quot;<code>sinh</code>&quot;, &quot;<code>sinpi</code>&quot;, &quot;<code>tan</code>&quot;, &quot;<code>tanh</code>&quot;, &quot;<code>tanpi</code>&quot;, &quot;<code>gamma</code>&quot;,
&quot;<code>lgamma</code>&quot;, &quot;<code>digamma</code>&quot;, &quot;<code>trigamma</code>&quot;</p>
</dd>
<dt><code>Math2</code></dt><dd><p>&quot;<code>round</code>&quot;, &quot;<code>signif</code>&quot;</p>
</dd>
<dt><code>Ops</code></dt><dd><p>&quot;<code>Arith</code>&quot;, &quot;<code>Compare</code>&quot;, &quot;<code>Logic</code>&quot;</p>
</dd>
<dt><code>Summary</code></dt><dd><p>&quot;<code>min</code>&quot;, &quot;<code>max</code>&quot;, &quot;<code>range</code>&quot;, &quot;<code>prod</code>&quot;, &quot;<code>sum</code>&quot;, &quot;<code>any</code>&quot;,
&quot;<code>all</code>&quot;</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## No examples
</code></pre>

<hr>
<h2 id='PeakPosition-class'>An S4 Class to Represent a Set of Peaks</h2><span id='topic+PeakPosition-class'></span><span id='topic+.PeakPosition'></span>

<h3>Description</h3>

<p>An S4 Class to Represent a Set of Peaks
</p>


<h3>Slots</h3>


<dl>
<dt><code>hash</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> string giving the 32-byte MD5 hash of the imported
spectrum file.</p>
</dd>
<dt><code>noise_method</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> string specifying the method used for peak
detection.</p>
</dd>
<dt><code>noise_threshold</code></dt><dd><p>A length one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the noise
threshold.</p>
</dd>
<dt><code>window</code></dt><dd><p>A length one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the half-window size.</p>
</dd>
<dt><code>channel</code></dt><dd><p>A <code><a href="base.html#topic+integer">integer</a></code> vector giving the channel number. Numeric values
are coerced to integer as by <code><a href="base.html#topic+as.integer">as.integer()</a></code> (and hence truncated towards
zero).</p>
</dd>
<dt><code>energy_observed</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the observed gamma ray
energy (in keV).</p>
</dd>
<dt><code>energy_expected</code></dt><dd><p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the expected gamma ray
energy (in keV).</p>
</dd>
</dl>


<h3>Access</h3>

<p>In the code snippets below, <code>x</code> is a <code>PeakPosition</code> object.
</p>

<dl>
<dt><code>get_hash(x)</code></dt><dd><p>Get the MD5 hash of the raw data file.</p>
</dd>
<dt><code>get_channels(x)</code></dt><dd><p>Get the channels of <code>x</code>.</p>
</dd>
<dt><code>get_energy(x)</code>, <code>set_energy(x) &lt;- value</code></dt><dd><p>Retrieves or sets
the energy scale of <code>x</code> according to <code>value</code>.</p>
</dd>
</dl>



<h3>Coerce</h3>

<p>In the code snippets below, <code>x</code> is a <code>PeakPosition</code> object.
</p>

<dl>
<dt><code>as.matrix(x)</code></dt><dd><p>Coerces <code>x</code> to a <code><a href="base.html#topic+matrix">matrix</a></code>.</p>
</dd>
<dt><code>as.data.frame(x)</code></dt><dd><p>Coerces <code>x</code> to a <code><a href="base.html#topic+data.frame">data.frame</a></code>.</p>
</dd>
</dl>



<h3>Subset</h3>

<p>In the code snippets below, <code>x</code> is a <code>PeakPosition</code> object.
</p>

<dl>
<dt><code>x[[i]]</code></dt><dd><p>Extracts information from a slot selected by subscript <code>i</code>.
<code>i</code> is a <code>character</code> vector of length one and will be matched to the name of
the slots.</p>
</dd>
</dl>



<h3>Note</h3>

<p>This class retains copy construction.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other class: 
<code><a href="#topic+Baseline-class">Baseline-class</a></code>,
<code><a href="#topic+CalibrationCurve-class">CalibrationCurve-class</a></code>,
<code><a href="#topic+GammaSpectra-class">GammaSpectra-class</a></code>,
<code><a href="#topic+GammaSpectrum-class">GammaSpectrum-class</a></code>,
<code><a href="#topic+coerce">coerce</a>()</code>
</p>

<hr>
<h2 id='peaks_find'>Find Peaks</h2><span id='topic+peaks_find'></span><span id='topic+peaks_find-method'></span><span id='topic+peaks_find+2CGammaSpectrum-method'></span>

<h3>Description</h3>

<p>Finds local maxima in sequential data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peaks_find(object, ...)

## S4 method for signature 'GammaSpectrum'
peaks_find(object, method = c("MAD"), SNR = 2, span = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="peaks_find_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> object.</p>
</td></tr>
<tr><td><code id="peaks_find_+3A_...">...</code></td>
<td>
<p>Extra parameters to be passed to internal methods.</p>
</td></tr>
<tr><td><code id="peaks_find_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the method to be used for
background noise estimation (see below).</p>
</td></tr>
<tr><td><code id="peaks_find_+3A_snr">SNR</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the signal-to-noise-ratio for peak detection
(see below).</p>
</td></tr>
<tr><td><code id="peaks_find_+3A_span">span</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the half window size (in number of
channels). If <code>NULL</code>, 5\
window size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A local maximum has to be the highest one in the given window and has to be
higher than <code class="reqn">SNR \times noise</code> to be recognized as peak.
</p>
<p>The following methods are available for noise estimation:
</p>

<dl>
<dt><code>MAD</code></dt><dd><p>Median Absolute Deviation.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A <a href="#topic+PeakPosition-class">PeakPosition</a> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code><a href="#topic+baseline">baseline</a></code>,
<code><a href="#topic+peaks_search">peaks_search</a>()</code>,
<code><a href="#topic+signal_integrate">signal_integrate</a>()</code>,
<code><a href="#topic+signal_slice">signal_slice</a>()</code>,
<code><a href="#topic+signal_split">signal_split</a>()</code>,
<code><a href="#topic+signal_stabilize">signal_stabilize</a>()</code>,
<code><a href="#topic+smooth">smooth</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import a LaBr spectrum
LaBr_file &lt;- system.file("extdata/LaBr.TKA", package = "gamma")
LaBr_spc &lt;- read(LaBr_file)

## Find peaks by channel
(LaBr_pks &lt;- peaks_find(LaBr_spc)) # Ugly
plot(LaBr_spc, LaBr_pks)

## Search peaks by channel
(LaBr_pks &lt;- peaks_search(LaBr_spc, index = c(86L, 207L, 496L), span = 7))
plot(LaBr_spc, LaBr_pks, split = TRUE)

## Import a BEGe spectrum
BEGe_file &lt;- system.file("extdata/BEGe.CNF", package = "gamma")
BEGe_spc &lt;- read(BEGe_file)

## Search peaks by energy
(BEGe_pks &lt;- peaks_search(BEGe_spc, index = c(47, 63, 911, 1460)))
plot(BEGe_spc, BEGe_pks, split = TRUE)
</code></pre>

<hr>
<h2 id='peaks_search'>Search Peaks</h2><span id='topic+peaks_search'></span><span id='topic+peaks_search-method'></span><span id='topic+peaks_search+2CGammaSpectrum+2Cinteger-method'></span><span id='topic+peaks_search+2CGammaSpectrum+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Search the maxima in sequential data around a given value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peaks_search(object, index, ...)

## S4 method for signature 'GammaSpectrum,integer'
peaks_search(object, index, span = 10, tolerance = 0.025)

## S4 method for signature 'GammaSpectrum,numeric'
peaks_search(object, index, span = 10, tolerance = 0.025)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="peaks_search_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> object.</p>
</td></tr>
<tr><td><code id="peaks_search_+3A_index">index</code></td>
<td>
<p>A vector giving the expected peak position.
If <code>index</code> is a <code><a href="base.html#topic+numeric">numeric</a></code> vector, peaks are searched by energy (<code>index</code> is
assumed to be expressed in keV). If <code>index</code> is an <code><a href="base.html#topic+integer">integer</a></code> vector, peaks
are searched by channel.</p>
</td></tr>
<tr><td><code id="peaks_search_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="peaks_search_+3A_span">span</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> value giving the half window size for searching.
If <code>index</code> is a <code><a href="base.html#topic+numeric">numeric</a></code> vector, <code>span</code> is expressed in keV.
If <code>index</code> is an <code><a href="base.html#topic+integer">integer</a></code> vector, <code>span</code> is expressed in channel.</p>
</td></tr>
<tr><td><code id="peaks_search_+3A_tolerance">tolerance</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> value giving the threshold above which a
warning/error is raised.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="#topic+PeakPosition-class">PeakPosition</a> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code><a href="#topic+baseline">baseline</a></code>,
<code><a href="#topic+peaks_find">peaks_find</a>()</code>,
<code><a href="#topic+signal_integrate">signal_integrate</a>()</code>,
<code><a href="#topic+signal_slice">signal_slice</a>()</code>,
<code><a href="#topic+signal_split">signal_split</a>()</code>,
<code><a href="#topic+signal_stabilize">signal_stabilize</a>()</code>,
<code><a href="#topic+smooth">smooth</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import a LaBr spectrum
LaBr_file &lt;- system.file("extdata/LaBr.TKA", package = "gamma")
LaBr_spc &lt;- read(LaBr_file)

## Find peaks by channel
(LaBr_pks &lt;- peaks_find(LaBr_spc)) # Ugly
plot(LaBr_spc, LaBr_pks)

## Search peaks by channel
(LaBr_pks &lt;- peaks_search(LaBr_spc, index = c(86L, 207L, 496L), span = 7))
plot(LaBr_spc, LaBr_pks, split = TRUE)

## Import a BEGe spectrum
BEGe_file &lt;- system.file("extdata/BEGe.CNF", package = "gamma")
BEGe_spc &lt;- read(BEGe_file)

## Search peaks by energy
(BEGe_pks &lt;- peaks_search(BEGe_spc, index = c(47, 63, 911, 1460)))
plot(BEGe_spc, BEGe_pks, split = TRUE)
</code></pre>

<hr>
<h2 id='plot'>Plot</h2><span id='topic+plot'></span><span id='topic+plot-method'></span><span id='topic+plot+2CGammaSpectrum+2Cmissing-method'></span><span id='topic+plot+2CGammaSpectrum+2CBaseline-method'></span><span id='topic+plot+2CGammaSpectra+2Cmissing-method'></span><span id='topic+plot+2CGammaSpectrum+2CPeakPosition-method'></span><span id='topic+plot+2CCalibrationCurve+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'GammaSpectrum,missing'
plot(x, xaxis = c("channel", "energy"), yaxis = c("count", "rate"), ...)

## S4 method for signature 'GammaSpectrum,Baseline'
plot(x, y, xaxis = c("channel", "energy"), yaxis = c("count", "rate"), ...)

## S4 method for signature 'GammaSpectra,missing'
plot(
  x,
  xaxis = c("channel", "energy"),
  yaxis = c("count", "rate"),
  select = NULL,
  facet = FALSE,
  nrow = c("fixed", "auto")
)

## S4 method for signature 'GammaSpectrum,PeakPosition'
plot(x, y, split = FALSE, span = 25)

## S4 method for signature 'CalibrationCurve,missing'
plot(
  x,
  error_ellipse = TRUE,
  error_bar = FALSE,
  energy = FALSE,
  level = 0.95,
  n = 50,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code>, <code id="plot_+3A_y">y</code></td>
<td>
<p>Objects to be plotted.</p>
</td></tr>
<tr><td><code id="plot_+3A_xaxis">xaxis</code>, <code id="plot_+3A_yaxis">yaxis</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the data to be plotted
along each axis. It must be one of &quot;<code>energy</code>&quot; or &quot;<code>channel</code>&quot; (<code>x</code> axis) and
&quot;<code>counts</code>&quot; or &quot;<code>rate</code>&quot; (<code>y</code> axis). Any unambiguous substring can be given.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="plot_+3A_select">select</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> or <code><a href="base.html#topic+character">character</a></code> vector giving the selection of
the spectrum that are drawn.</p>
</td></tr>
<tr><td><code id="plot_+3A_facet">facet</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should a matrix of panels defined by
spectrum be drawn?</p>
</td></tr>
<tr><td><code id="plot_+3A_nrow">nrow</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the number of rows.
It must be one of &quot;<code>fixed</code>&quot; or &quot;<code>auto</code>&quot;. Any unambiguous substring can be
given. Only used if <code>facet</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_split">split</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should.</p>
</td></tr>
<tr><td><code id="plot_+3A_span">span</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the half window size (in number of
channels). Only used if <code>split</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_error_ellipse">error_ellipse</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should error ellipses be plotted?</p>
</td></tr>
<tr><td><code id="plot_+3A_error_bar">error_bar</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should error bars be plotted?</p>
</td></tr>
<tr><td><code id="plot_+3A_energy">energy</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar plotting the count threshold value or the
energy threshold value</p>
</td></tr>
<tr><td><code id="plot_+3A_level">level</code></td>
<td>
<p>length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the the probability cutoff
for the error ellipses.</p>
</td></tr>
<tr><td><code id="plot_+3A_n">n</code></td>
<td>
<p>A length-one <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the resolution of the error
ellipses.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot2::ggplot</a> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="IsoplotR.html#topic+ellipse">IsoplotR::ellipse()</a></code>, <code><a href="IsoplotR.html#topic+isochron">IsoplotR::isochron()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import CNF files
spc_dir &lt;- system.file("extdata/BDX_LaBr_1/calibration", package = "gamma")
spc &lt;- read(spc_dir)

# Plot all spectra
plot(spc, yaxis = "rate", facet = FALSE) +
  ggplot2::theme_bw()

# Plot the spectrum named 'BRIQUE'
plot(spc, xaxis = "energy", yaxis = "count", select = "BRIQUE") +
  ggplot2::theme_bw()

# Plot the first three spectra
plot(spc, xaxis = "channel", yaxis = "rate", select = 1:3, facet = TRUE) +
  ggplot2::theme_bw()
</code></pre>

<hr>
<h2 id='read'>Data Input</h2><span id='topic+read'></span><span id='topic+read-method'></span><span id='topic+read+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Reads a gamma ray spectrum file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read(file, ...)

## S4 method for signature 'character'
read(file, extensions = c("cnf", "tka", "spe"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_+3A_file">file</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string giving the path of files to be imported.</p>
</td></tr>
<tr><td><code id="read_+3A_...">...</code></td>
<td>
<p>Extra parameters to be passed to <code><a href="rxylib.html#topic+read_xyData">rxylib::read_xyData()</a></code>.</p>
</td></tr>
<tr><td><code id="read_+3A_extensions">extensions</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector specifying the possible
file extensions. It must be one or more of &quot;<code>cnf</code>&quot;, &quot;<code>tka</code>&quot;, &quot;<code>spe</code>&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="#topic+GammaSpectra-class">GammaSpectra</a> object if more than one spectrum are imported
at once, else a <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> object.
</p>


<h3>Note</h3>

<p>Supports Canberra CNF and TKA and Kromek SPE files.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code><a href="rxylib.html#topic+read_xyData">rxylib::read_xyData()</a></code>
</p>
<p>Other IO: 
<code><a href="#topic+summarise">summarise</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import a Canberra CNF file
cnf_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
(cnf_spc &lt;- read(cnf_file))

## Import a TKA file
tka_file &lt;- system.file("extdata/LaBr.TKA", package = "gamma")
(tka_spc &lt;- read(tka_file))

## Import all files in a given directory
spc_dir &lt;- system.file("extdata/BDX_LaBr_1/calibration", package = "gamma")
(spc &lt;- read(spc_dir))
</code></pre>

<hr>
<h2 id='signal_integrate'>Signal Integration</h2><span id='topic+signal_integrate'></span><span id='topic+signal_integrate-method'></span><span id='topic+signal_integrate+2CGammaSpectrum+2Cmissing-method'></span><span id='topic+signal_integrate+2CGammaSpectrum+2CGammaSpectrum-method'></span><span id='topic+signal_integrate+2CGammaSpectrum+2Cnumeric-method'></span><span id='topic+signal_integrate+2CGammaSpectra+2Cmissing-method'></span><span id='topic+signal_integrate+2CGammaSpectra+2CGammaSpectrum-method'></span><span id='topic+signal_integrate+2CGammaSpectra+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Integration of the spectrum including uncertainty calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signal_integrate(object, background, ...)

## S4 method for signature 'GammaSpectrum,missing'
signal_integrate(object, range = NULL, energy = FALSE)

## S4 method for signature 'GammaSpectrum,GammaSpectrum'
signal_integrate(object, background, range = NULL, energy = FALSE)

## S4 method for signature 'GammaSpectrum,numeric'
signal_integrate(object, background, range = NULL, energy = FALSE)

## S4 method for signature 'GammaSpectra,missing'
signal_integrate(object, range = NULL, energy = FALSE, simplify = TRUE)

## S4 method for signature 'GammaSpectra,GammaSpectrum'
signal_integrate(
  object,
  background,
  range = NULL,
  energy = FALSE,
  simplify = TRUE
)

## S4 method for signature 'GammaSpectra,numeric'
signal_integrate(
  object,
  background,
  range = NULL,
  energy = FALSE,
  simplify = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signal_integrate_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or <a href="#topic+GammaSpectra-class">GammaSpectra</a> object.</p>
</td></tr>
<tr><td><code id="signal_integrate_+3A_background">background</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> object.</p>
</td></tr>
<tr><td><code id="signal_integrate_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="signal_integrate_+3A_range">range</code></td>
<td>
<p>A length-two <code><a href="base.html#topic+numeric">numeric</a></code> vector giving the energy range to
integrate within (in keV).</p>
</td></tr>
<tr><td><code id="signal_integrate_+3A_energy">energy</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: use the energy or count threshold for the signal integration</p>
</td></tr>
<tr><td><code id="signal_integrate_+3A_simplify">simplify</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> scalar: should the result be simplified to a
<code><a href="base.html#topic+matrix">matrix</a></code>? The default value, <code>FALSE</code>, returns a <code><a href="base.html#topic+list">list</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function supports two integration techniques (see Guérin &amp; Mercier 2011),
the (1) count threshold integration and the (2) energy integration method:
</p>
<p>The count integration technique (<code>energy = FALSE</code>) integrates
all counts in given <code>range</code>:
</p>
<p style="text-align: center;"><code class="reqn">
   A = \frac{\Sigma_{i}^{N}S_i}{t_{live}}
 </code>
</p>

<p>Contrary, the energy integration techniques is the integrated cross-product
of counts and corresponding energy per channel:
</p>
<p style="text-align: center;"><code class="reqn">
  A = \frac{\Sigma_{i}^{N}S_i \times E_i}{t_{live}}
 </code>
</p>

<p><code class="reqn">A</code> is the area, <code class="reqn">S_i</code> is the signal in the <code class="reqn">i^{th}</code> channel,
<code class="reqn">N</code> the number of channels, <code class="reqn">E_i</code> the energy of the corresponding
channel in keV. <code class="reqn">t_{live}</code> is the live time of the measurement in <em>s</em>.
</p>
<p>For calculating the uncertainties, Poisson statistics are assumed and hence
the errors is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">
 \sigma_A = \frac{\sqrt{A}}{t_{live}}
 </code>
</p>



<h3>Value</h3>

<p>If <code>simplify</code> is <code>FALSE</code> (the default) returns a <code><a href="base.html#topic+list">list</a></code> of numeric vectors
(the signal value and its error), else returns a <code><a href="base.html#topic+matrix">matrix</a></code>.
</p>


<h3>Note</h3>

<p>The integration assumes that each spectrum has an energy scale.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Guérin, G. &amp; Mercier, M. (2011). Determining Gamma Dose Rates by Field Gamma
Spectroscopy in Sedimentary Media: Results of Monte Carlo Simulations.
<em>Radiation Measurements</em>, 46(2), p. 190-195.
<a href="https://doi.org/10.1016/j.radmeas.2010.10.003">doi:10.1016/j.radmeas.2010.10.003</a>.
</p>
<p>Mercier, N. &amp; Falguères, C. (2007). Field Gamma Dose-Rate Measurement with
a NaI(Tl) Detector: Re-Evaluation of the &quot;Threshold&quot; Technique.
<em>Ancient TL</em>, 25(1), p. 1-4.
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code><a href="#topic+baseline">baseline</a></code>,
<code><a href="#topic+peaks_find">peaks_find</a>()</code>,
<code><a href="#topic+peaks_search">peaks_search</a>()</code>,
<code><a href="#topic+signal_slice">signal_slice</a>()</code>,
<code><a href="#topic+signal_split">signal_split</a>()</code>,
<code><a href="#topic+signal_stabilize">signal_stabilize</a>()</code>,
<code><a href="#topic+smooth">smooth</a>()</code>
</p>

<hr>
<h2 id='signal_slice'>Choose channels by Position</h2><span id='topic+signal_slice'></span><span id='topic+signal_slice-method'></span><span id='topic+signal_slice+2CGammaSpectrum-method'></span><span id='topic+signal_slice+2CGammaSpectra-method'></span>

<h3>Description</h3>

<p>Choose channels by position.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signal_slice(object, ...)

## S4 method for signature 'GammaSpectrum'
signal_slice(object, ...)

## S4 method for signature 'GammaSpectra'
signal_slice(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signal_slice_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or <a href="#topic+GammaSpectra-class">GammaSpectra</a>
object.</p>
</td></tr>
<tr><td><code id="signal_slice_+3A_...">...</code></td>
<td>
<p><code><a href="base.html#topic+integer">integer</a></code> values giving the channels of the spectrum to be
kept/dropped (see below). Numeric values are coerced to integer as by
<code><a href="base.html#topic+as.integer">as.integer()</a></code> (and hence truncated towards zero).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either positive values to keep, or negative values to drop, should be
provided. The values provided must be either all positive or all negative.
</p>
<p>If no value is provided, an attempt is made to define the number
of channels to skip at the beginning of the spectrum. This drops all
channels before the highest count maximum. This is intended to deal with the
artefact produced by the rapid growth of random background noise towards low
energies.
</p>


<h3>Value</h3>

<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or <a href="#topic+GammaSpectra-class">GammaSpectra</a> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code><a href="#topic+baseline">baseline</a></code>,
<code><a href="#topic+peaks_find">peaks_find</a>()</code>,
<code><a href="#topic+peaks_search">peaks_search</a>()</code>,
<code><a href="#topic+signal_integrate">signal_integrate</a>()</code>,
<code><a href="#topic+signal_split">signal_split</a>()</code>,
<code><a href="#topic+signal_stabilize">signal_stabilize</a>()</code>,
<code><a href="#topic+smooth">smooth</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import CNF files
spc_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
spc &lt;- read(spc_file)

## Plot spectrum
plot(spc)

## Slice
sliced &lt;- signal_slice(spc)
plot(sliced)

sliced &lt;- signal_slice(spc, -c(1:35))
plot(sliced)

sliced &lt;- signal_slice(sliced, 450:550)
plot(sliced)

## Split
g &lt;- rep(c("A", "B", "C"), c(250, 500, 274))
splited &lt;- signal_split(spc, g)
plot(splited, facet = TRUE)
</code></pre>

<hr>
<h2 id='signal_split'>Split</h2><span id='topic+signal_split'></span><span id='topic+signal_split-method'></span><span id='topic+signal_split+2CGammaSpectrum-method'></span>

<h3>Description</h3>

<p>Split
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signal_split(object, ...)

## S4 method for signature 'GammaSpectrum'
signal_split(object, groups)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signal_split_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> object.</p>
</td></tr>
<tr><td><code id="signal_split_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
<tr><td><code id="signal_split_+3A_groups">groups</code></td>
<td>
<p>A a <code><a href="base.html#topic+factor">factor</a></code> in the sense that <code>as.factor(groups)</code> defines
the grouping (see <code><a href="base.html#topic+split">split</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="#topic+GammaSpectra-class">GammaSpectra</a> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code><a href="#topic+baseline">baseline</a></code>,
<code><a href="#topic+peaks_find">peaks_find</a>()</code>,
<code><a href="#topic+peaks_search">peaks_search</a>()</code>,
<code><a href="#topic+signal_integrate">signal_integrate</a>()</code>,
<code><a href="#topic+signal_slice">signal_slice</a>()</code>,
<code><a href="#topic+signal_stabilize">signal_stabilize</a>()</code>,
<code><a href="#topic+smooth">smooth</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import CNF files
spc_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
spc &lt;- read(spc_file)

## Plot spectrum
plot(spc)

## Slice
sliced &lt;- signal_slice(spc)
plot(sliced)

sliced &lt;- signal_slice(spc, -c(1:35))
plot(sliced)

sliced &lt;- signal_slice(sliced, 450:550)
plot(sliced)

## Split
g &lt;- rep(c("A", "B", "C"), c(250, 500, 274))
splited &lt;- signal_split(spc, g)
plot(splited, facet = TRUE)
</code></pre>

<hr>
<h2 id='signal_stabilize'>Transform Intensities</h2><span id='topic+signal_stabilize'></span><span id='topic+signal_stabilize-method'></span><span id='topic+signal_stabilize+2CGammaSpectrum-method'></span><span id='topic+signal_stabilize+2CGammaSpectra-method'></span>

<h3>Description</h3>

<p>Transform Intensities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signal_stabilize(object, ...)

## S4 method for signature 'GammaSpectrum'
signal_stabilize(object, f, ...)

## S4 method for signature 'GammaSpectra'
signal_stabilize(object, f, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signal_stabilize_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> object.</p>
</td></tr>
<tr><td><code id="signal_stabilize_+3A_...">...</code></td>
<td>
<p>Extra arguments to be passed to <code>f</code>.</p>
</td></tr>
<tr><td><code id="signal_stabilize_+3A_f">f</code></td>
<td>
<p>A <code><a href="base.html#topic+function">function</a></code> that takes a numeric vector as
argument and returns a numeric vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The stabilization step aims at improving the identification of peaks with a
low signal-to-noise ratio. This particularly targets higher energy peaks.
</p>


<h3>Value</h3>

<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or <a href="#topic+GammaSpectra-class">GammaSpectra</a> object with
transformed intensities.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code><a href="#topic+baseline">baseline</a></code>,
<code><a href="#topic+peaks_find">peaks_find</a>()</code>,
<code><a href="#topic+peaks_search">peaks_search</a>()</code>,
<code><a href="#topic+signal_integrate">signal_integrate</a>()</code>,
<code><a href="#topic+signal_slice">signal_slice</a>()</code>,
<code><a href="#topic+signal_split">signal_split</a>()</code>,
<code><a href="#topic+smooth">smooth</a>()</code>
</p>

<hr>
<h2 id='smooth'>Smooth</h2><span id='topic+smooth'></span><span id='topic+signal_smooth'></span><span id='topic+signal_smooth-method'></span><span id='topic+smooth_rectangular'></span><span id='topic+smooth_rectangular-method'></span><span id='topic+smooth_triangular'></span><span id='topic+smooth_triangular-method'></span><span id='topic+smooth_savitzky'></span><span id='topic+smooth_savitzky-method'></span><span id='topic+signal_smooth+2CGammaSpectrum-method'></span><span id='topic+signal_smooth+2CGammaSpectra-method'></span><span id='topic+smooth_rectangular+2CGammaSpectrum-method'></span><span id='topic+smooth_rectangular+2CGammaSpectra-method'></span><span id='topic+smooth_savitzky+2CGammaSpectrum-method'></span><span id='topic+smooth_savitzky+2CGammaSpectra-method'></span><span id='topic+smooth_triangular+2CGammaSpectrum-method'></span><span id='topic+smooth_triangular+2CGammaSpectra-method'></span>

<h3>Description</h3>

<p>Smoothes intensities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signal_smooth(object, ...)

smooth_rectangular(object, ...)

smooth_triangular(object, ...)

smooth_savitzky(object, ...)

## S4 method for signature 'GammaSpectrum'
signal_smooth(object, method = c("rectangular", "triangular", "savitzky"), ...)

## S4 method for signature 'GammaSpectra'
signal_smooth(object, method = c("rectangular", "triangular", "savitzky"), ...)

## S4 method for signature 'GammaSpectrum'
smooth_rectangular(object, m = 3, ...)

## S4 method for signature 'GammaSpectra'
smooth_rectangular(object, m = 3, ...)

## S4 method for signature 'GammaSpectrum'
smooth_savitzky(object, m = 3, p = 2, ...)

## S4 method for signature 'GammaSpectra'
smooth_savitzky(object, m = 3, p = 2, ...)

## S4 method for signature 'GammaSpectrum'
smooth_triangular(object, m = 3, ...)

## S4 method for signature 'GammaSpectra'
smooth_triangular(object, m = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smooth_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or <a href="#topic+GammaSpectra-class">GammaSpectra</a>
object.</p>
</td></tr>
<tr><td><code id="smooth_+3A_...">...</code></td>
<td>
<p>Extra parameters to be passed to further methods.</p>
</td></tr>
<tr><td><code id="smooth_+3A_method">method</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string specifying the smoothing method to be
used. It must be one of &quot;<code>unweighted</code>&quot; (default), &quot;<code>weighted</code>&quot; or
&quot;<code>savitzky</code>&quot; (see details). Any unambiguous substring can be given.</p>
</td></tr>
<tr><td><code id="smooth_+3A_m">m</code></td>
<td>
<p>An odd <code><a href="base.html#topic+integer">integer</a></code> giving the number of adjacent points to be used.</p>
</td></tr>
<tr><td><code id="smooth_+3A_p">p</code></td>
<td>
<p>An <code><a href="base.html#topic+integer">integer</a></code> giving the polynomial degree. Only used if <code>method</code>
is &quot;<code>savitzky</code>&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following smoothing methods are available:
</p>

<dl>
<dt><code>rectangular</code></dt><dd><p>Unweighted sliding-average or rectangular smooth.
It replaces each point in the signal with the average of <code class="reqn">m</code> adjacent
points.</p>
</dd>
<dt><code>triangular</code></dt><dd><p>Weighted sliding-average or triangular smooth.
It replaces each point in the signal with the weighted mean of <code class="reqn">m</code>
adjacent points.</p>
</dd>
<dt><code>savitzky</code></dt><dd><p>Savitzky-Golay filter. This method is based on the
least-squares fitting of polynomials to segments of <code class="reqn">m</code> adjacent
points.</p>
</dd>
</dl>

<p>There will be <code class="reqn">(m - 1) / 2</code> points both at the beginning and at the end
of the spectrum for which a complete <code class="reqn">m</code>-width smooth cannot be
calculated. To prevent data loss, progressively smaller smooths are used at
the ends of the spectrum if <code>method</code> is <code>unweighted</code> or <code>weighted</code>. If the
Savitzky-Golay filter is used, the original <code class="reqn">(m - 1) / 2</code> points at the
ends of the spectrum are preserved.
</p>


<h3>Value</h3>

<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or <a href="#topic+GammaSpectra-class">GammaSpectra</a> object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>References</h3>

<p>Gorry, P. A. (1990). General Least-Squares Smoothing and Differentiation by
the Convolution (Savitzky-Golay) Method. <em>Analytical Chemistry</em>, 62(6),
p. 570-573. <a href="https://doi.org/10.1021/ac00205a007">doi:10.1021/ac00205a007</a>.
</p>
<p>Savitzky, A. &amp; Golay, M. J. E. (1964). Smoothing and Differentiation of
Data by Simplified Least Squares Procedures. <em>Analytical Chemistry</em>,
36(8), p. 1627-1639. <a href="https://doi.org/10.1021/ac60214a047">doi:10.1021/ac60214a047</a>.
</p>


<h3>See Also</h3>

<p>Other signal processing: 
<code><a href="#topic+baseline">baseline</a></code>,
<code><a href="#topic+peaks_find">peaks_find</a>()</code>,
<code><a href="#topic+peaks_search">peaks_search</a>()</code>,
<code><a href="#topic+signal_integrate">signal_integrate</a>()</code>,
<code><a href="#topic+signal_slice">signal_slice</a>()</code>,
<code><a href="#topic+signal_split">signal_split</a>()</code>,
<code><a href="#topic+signal_stabilize">signal_stabilize</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import CNF files
spc_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
spc &lt;- read(spc_file)
spc &lt;- signal_slice(spc, -c(1:35))

# Plot raw spectrum
spc_clean &lt;- signal_correct(spc)
plot(spc_clean)

# Rectangular smooth
spc_unweighted &lt;- smooth_rectangular(spc, m = 3)
spc_unweighted_clean &lt;- signal_correct(spc_unweighted)
plot(spc_unweighted_clean)

# Triangular smooth
spc_weighted &lt;- smooth_triangular(spc, m = 5)
spc_weighted_clean &lt;- signal_correct(spc_weighted)
plot(spc_weighted_clean)

# Savitzky–Golay
spc_savitzky &lt;- smooth_savitzky(spc, m = 21, p = 2)
spc_savitzky_clean &lt;- signal_correct(spc_savitzky)
plot(spc_savitzky_clean)
</code></pre>

<hr>
<h2 id='subset'>Extract or Replace Parts of an Object</h2><span id='topic+subset'></span><span id='topic++5B+5B+2CGammaSpectrum-method'></span><span id='topic++5B+2CGammaSpectra-method'></span><span id='topic++5B+5B+2CDoseRateModel-method'></span><span id='topic++5B+5B+2CCalibrationCurve-method'></span><span id='topic++5B+5B+2CPeakPosition-method'></span>

<h3>Description</h3>

<p>Operators acting on objects to extract or replace parts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'GammaSpectrum'
x[[i]]

## S4 method for signature 'GammaSpectra'
x[i, j]

## S4 method for signature 'DoseRateModel'
x[[i]]

## S4 method for signature 'CalibrationCurve'
x[[i]]

## S4 method for signature 'PeakPosition'
x[[i]]
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subset_+3A_x">x</code></td>
<td>
<p>An object from which to extract element(s) or in which to
replace element(s).</p>
</td></tr>
<tr><td><code id="subset_+3A_i">i</code>, <code id="subset_+3A_j">j</code></td>
<td>
<p>Indices specifying elements to extract or replace. Indices are
<code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+integer">integer</a></code> or <code><a href="base.html#topic+character">character</a></code> vectors or empty (missing) or
<code>NULL</code>. Numeric values are coerced to <code><a href="base.html#topic+integer">integer</a></code> as by <code><a href="base.html#topic+as.integer">as.integer()</a></code> (and
hence truncated towards zero). Character vectors will be matched to the name
of the elements. An empty index (a comma separated blank) indicates that all
entries in that dimension are selected.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subsetted object.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other mutator: 
<code><a href="#topic+mutator">mutator</a></code>
</p>

<hr>
<h2 id='summarise'>Summarize</h2><span id='topic+summarise'></span><span id='topic+summarise-method'></span><span id='topic+summarise+2CGammaSpectrum-method'></span><span id='topic+summarise+2CGammaSpectra-method'></span><span id='topic+summarise+2CDoseRateModel-method'></span><span id='topic+summarise+2CCalibrationCurve-method'></span>

<h3>Description</h3>

<p>Summarize
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarise(object, ...)

## S4 method for signature 'GammaSpectrum'
summarise(object)

## S4 method for signature 'GammaSpectra'
summarise(object)

## S4 method for signature 'DoseRateModel'
summarise(object)

## S4 method for signature 'CalibrationCurve'
summarise(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summarise_+3A_object">object</code></td>
<td>
<p>A <a href="#topic+GammaSpectrum-class">GammaSpectrum</a> or <a href="#topic+GammaSpectra-class">GammaSpectra</a> object.</p>
</td></tr>
<tr><td><code id="summarise_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p>Other IO: 
<code><a href="#topic+read">read</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Import a Canberra CNF file
cnf_file &lt;- system.file("extdata/LaBr.CNF", package = "gamma")
spc &lt;- read(cnf_file)
summarise(spc)

## Import all CNF files in a given directory
spc_dir &lt;- system.file("extdata/BDX_LaBr_1/calibration", package = "gamma")
spc &lt;- read(spc_dir)
summarise(spc)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
