<!DOCTYPE html><html><head><title>Help for package msaFACE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {msaFACE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GiFACE'>
<p>Longterm time series of a Free Air Carbon Enrichment experiment (FACE)</p></a></li>
<li><a href='#moving_subset_analysis'>
<p>Moving subset analysis</p></a></li>
<li><a href='#msaFACE-package'>
<p>Moving Subset Analysis GiFACE</p></a></li>
<li><a href='#plot.MSA_coef'>
<p>Plot function for moving subset analysis</p></a></li>
<li><a href='#print.MSA_coef'>
<p>Print MSA_coef</p></a></li>
<li><a href='#summary.MSA_coef'>
<p>Summary for MSA_coef</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Moving Subset Analysis FACE</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-11-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Wolfgang A. Obermeier [cre, aut],
  Lukas W. Lehnert [cre, aut], 
  Joerg Bendix [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lukas W. Lehnert &lt;lukaslehnert@googlemail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>The new methodology "moving subset analysis" provides functions to investigate the effect of environmental conditions on the CO2 fertilization effect within longterm free air carbon enrichment (FACE)  experiments. In general, the functionality is applicable to derive the influence of a third variable (forcing experiment-support variable) on the relation between a dependent and an independent variable.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-11-08 16:06:13 UTC; lehnert</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-11-08 18:36:03</td>
</tr>
</table>
<hr>
<h2 id='GiFACE'>
Longterm time series of a Free Air Carbon Enrichment experiment (FACE)
</h2><span id='topic+GiFACE'></span>

<h3>Description</h3>

<p>The dataset contains aggregated data from one of the globally longest time series (1998-2013) from a Free Air Carbon Enrichment experiment, settled in Giessen, Germany (GiFACE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GiFACE)
</code></pre>


<h3>Format</h3>

<p><code>list</code></p>


<h3>Details</h3>

<p>Within the experiment, a permanent temperate grassland is treated with elevated CO2 (~20% during daylight hours). In three rings the air is enriched with CO2 (-&gt; elevated) while other three rings act under atmospheric CO2 (-&gt; ambient). The late-summer yields as well as the CO2 concentrations (averaged in the three months before harvest) were measured ring-wise and can be used as dependent and independent variables within the Moving Subset Analysis. Experiment-support variables describing the environmental conditions were aggregated to their average in the three months preceding harvest (respectively sum for solar radiation and precipitation). These environmental variables can be used (1) as forcing variables to derive the subsets (where regression within the moving subset is performed) and (2) be plotted as accompanying variables to get a clear picture of the environmental conditions within the respective subset. 
</p>


<h3>Author(s)</h3>

<p>Wolfgang A. Obermeier, Lukas W. Lehnert, Joerg Bendix
</p>


<h3>References</h3>

<p>W. A. Obermeier, L. W. Lehnert, C. I. Kammann, C. Mueller, L.
Gruenhage, J. Luterbacher, M. Erbs, G. Moser, R. Seibert, N. Yuan,
J. Bendix (under review) Reduced CO2 fertilization in temperate C3 grasslands
under more extreme weather conditions. Nature Climate Change
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Workaround to import the data from the DOI (10.5678\LCRS\DAT.265)

## Load data from http://dx.doi.org/10.5678/LCRS/DAT.265 and extract csv-file
## Define variable 'filename' so that it points to the csv-file
filename &lt;- ""

## Import data
import &lt;- read.csv(filename,
                   stringsAsFactors = FALSE)

## Delete every second column (quality flag of database)
data &lt;- import[,seq(1, ncol(import), 2)]

## Create a vector containing the years of data acquistion 
year_vec &lt;- substr(data[,1],1,4)

## Delete further unnecessary columns
data &lt;- data[,-c(1,2,13)]

## Perform Moving Subset Analysis for all forcing experiment support variables (default) with
## independent variable CO2 Concentration (CO2), dependent variable biomass (BY_T), 30 observations
## within each subset and the years as grouping factor
MSA_GiFACE &lt;- moving_subset_analysis(data, "CO2", "BY_T", 30, group =  year_vec)

## Show summary
summary(MSA_GiFACE)

## End(Not run)
</code></pre>

<hr>
<h2 id='moving_subset_analysis'>
Moving subset analysis
</h2><span id='topic+moving_subset_analysis'></span>

<h3>Description</h3>

<p>The moving subset analysis quantifies the influence of a third variable (forcing experiment-support variable) on the relation between a dependent and an independent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moving_subset_analysis(x, treatment_var, response_var, window_size,
                       group = 1:nrow(x), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moving_subset_analysis_+3A_x">x</code></td>
<td>

<p>Matrix or dataframe with dependent, independent and any experiment-support variables
</p>
</td></tr>
<tr><td><code id="moving_subset_analysis_+3A_treatment_var">treatment_var</code></td>
<td>

<p>Name of treatment variable. All but treatment and response variable are defined as experiment-support variables.
</p>
</td></tr>
<tr><td><code id="moving_subset_analysis_+3A_response_var">response_var</code></td>
<td>

<p>Name of response variable
</p>
</td></tr>
<tr><td><code id="moving_subset_analysis_+3A_window_size">window_size</code></td>
<td>

<p>Number of observations within one subset. Must be a multiple of the number of observations within one group.
</p>
</td></tr>
<tr><td><code id="moving_subset_analysis_+3A_group">group</code></td>
<td>

<p>Group factor identifying independent observations. Note that the number of observations within each group must be identical.
</p>
</td></tr>
<tr><td><code id="moving_subset_analysis_+3A_...">...</code></td>
<td>

<p>Further arguments (currently ignored)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function derives the CO2-fertilization effect (CFE) and relates it to the variable environmental conditions. The CFE is calculated by the regression between a dependent variable such as total aboveground biomass and the CO2 concentration in the air. Please note the the value of the function <code><a href="#topic+moving_subset_analysis">moving_subset_analysis</a></code> is of class '<code>MSA_coef</code>' for which several methods are available to plot and print the results.
</p>
<p>Each experiment-support variable can be used as forcing variable, for which the influence on the CFE is analyzed through the following steps:
</p>

<ol>
<li><p>In the first step, the dataset is rearranged in ascending order of the forcing experiment-support variable. The total dataset is then partitioned into subsets where each contains observations featuring similar environmental characteristics. Taking the rainfall as an example, the first subset will encompass the driest years. For the second one, the year with the lowest rainfall sum is dropped and replaced by the year with the next lowest rainfall sum. This is repeated until the last subset is reached which encompasses the wettest years. For the GiFACE dataset with 16 years (1998-2013) of available data, 12 subsets are created for a window size of 30 observations (each subset encompassing six rings and five years).
</p>
</li>
<li><p>The CFE is then derived as the slope of the regression model between the CO2 concentration of the air and the selected dependent variable, which is calculated separately within each of the subsets defined above.
</p>
</li>
<li><p>By presenting the slope and its significance against the average of the forcing experiment-support variable in the subset, the influence of the respective variable on the CFE is revealed. However, situated in natural environments, most of the experiment-support variables will be highly correlated and, thus, the influence of the forcing variable has to be interpreted carefully. Therefore, the <span class="pkg">msaFACE</span> contains the possibility to plot the averages of the accompanying experiment-support variables in the subsets, enabling a comprehensive picture of the prevailing environmental conditions. All this can easily be achieved by the function <code><a href="#topic+plot.MSA_coef">plot.MSA_coef</a></code>.
</p>
</li></ol>



<h3>Value</h3>

<p>Object of class <code>MSA_coef</code>. Internally stored as a list. This object contains one element for each experiment-support variable. Those elements are data.frames with the subset-wise outputs:
</p>

<ul>
<li> <p>CFE: Slope of linear model in subset
</p>
</li>
<li> <p>Pval: Significance value of linear model in subset
</p>
</li>
<li> <p> Mean of the dependent variable in subset
</p>
</li>
<li> <p>MEAN_&quot;i-th_exp_var&quot;: Mean of the i-th experiment-support variable in subset
</p>
</li>
<li> <p>...
</p>
</li>
<li> <p>Min_&quot;i-th_var&quot;: Minimum of the forcing variable in subset
</p>
</li>
<li> <p>Max_&quot;i-th_var&quot;: Maximum of the forcing variable in subset
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Wolfgang A. Obermeier, Lukas W. Lehnert, Joerg Bendix
</p>


<h3>References</h3>

<p>W. A. Obermeier, L. W. Lehnert, C. I. Kammann, C. Mueller, L.
Gruenhage, J. Luterbacher, M. Erbs, G. Moser, R. Seibert, N. Yuan,
J. Bendix (under review) Reduced CO2 fertilization in temperate C3 grasslands
under more extreme weather conditions. Nature Climate Change
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.MSA_coef">plot.MSA_coef</a></code>, <code><a href="#topic+GiFACE">GiFACE</a></code>, <code><a href="#topic+summary.MSA_coef">summary.MSA_coef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GiFACE)

msa_data &lt;- moving_subset_analysis(GiFACE$data, "CO2A_Mean", "BYT", 30, group = GiFACE$year)

</code></pre>

<hr>
<h2 id='msaFACE-package'>
Moving Subset Analysis GiFACE
</h2><span id='topic+msaFACE-package'></span>

<h3>Description</h3>

 

<p>The package <span class="pkg">msaFACE</span> provides a new methodology called &quot;<span class="pkg">m</span>oving <span class="pkg">s</span>ubset <span class="pkg">a</span>nalysis&quot; to investigate the effect of environmental conditions on the CO2 fertilization effect within longterm free air carbon enrichment experiments. More generally, the functionality is applicable to derive the influence of a third variable (forcing experiment-support variable)  on the relation between a dependent and an independent variable.
</p>


<h3>Details</h3>

<p>The main part of the package is the function <code><a href="#topic+moving_subset_analysis">moving_subset_analysis</a></code> which derives the CO2-fertilization effect (CFE) and relates it to the variable environmental conditions. The   CFE is calculated by the regression between a dependent variable such as total aboveground biomass and the CO2 concentration in the air. Please note that the value of the function <code><a href="#topic+moving_subset_analysis">moving_subset_analysis</a></code> is of class '<code>MSA_coef</code>' for which several methods are available to plot and print the results.
</p>
<p>Each experiment-support variable can be used as forcing variable, for which the influence on the CFE is analyzed through the following steps:
</p>

<ol>
<li><p>In the first step, the dataset is rearranged in ascending order of the forcing experiment-support variable. The total dataset is then partitioned into subsets where each contains observations featuring similar environmental characteristics. Taking the rainfall as an example, the first subset will encompass the driest years. For the second one, the year with the lowest rainfall sum is dropped and replaced by the year with the next lowest rainfall sum. This is repeated until the last subset is reached which encompasses the wettest years. For the GiFACE dataset with 16 years (1998-2013) of available data, 12 subsets are created for a window size of 30 observations (each subset encompassing six rings and five years).
</p>
</li>
<li><p>The CFE is then derived as the slope of the regression model between the CO2 concentration of the air and the selected dependent variable, which is calculated separately within each of the subsets defined above.
</p>
</li>
<li><p>By presenting the slope and its significance against the average of the forcing experiment-support variable in the subset, the influence of the respective variable on the CFE is revealed. However, situated in natural environments, most of the experiment-support variables will be highly correlated and, thus, the influence of the forcing variable has to be interpreted carefully. Therefore, the <span class="pkg">msaFACE</span> contains the possibility to plot the averages of the accompanying experiment-support variables in the subsets, enabling a comprehensive picture of the prevailing environmental conditions. All this can easily be achieved by the function <code><a href="#topic+plot.MSA_coef">plot.MSA_coef</a></code>.
</p>
</li></ol>


<p>To see the preferable citation of the package, type
<code>citation("msaFACE")</code>.  
</p>


<h3>Author(s)</h3>

<p>Wolfgang A. Obermeier, Lukas W. Lehnert, Joerg Bendix
</p>


<h3>References</h3>

<p>W. A. Obermeier, L. W. Lehnert, C. I. Kammann, C. Mueller, L.
Gruenhage, J. Luterbacher, M. Erbs, G. Moser, R. Seibert, N. Yuan,
J. Bendix (under review) Reduced CO2 fertilization in temperate C3 grasslands
under more extreme weather conditions. Nature Climate Change
</p>


<h3>See Also</h3>

<p><code><a href="#topic+moving_subset_analysis">moving_subset_analysis</a></code>, <code><a href="#topic+GiFACE">GiFACE</a></code>, <code><a href="#topic+plot.MSA_coef">plot.MSA_coef</a></code>, <code><a href="#topic+print.MSA_coef">print.MSA_coef</a></code>,
</p>
<p><code><a href="#topic+summary.MSA_coef">summary.MSA_coef</a></code>
</p>

<hr>
<h2 id='plot.MSA_coef'>
Plot function for moving subset analysis
</h2><span id='topic+plot.MSA_coef'></span>

<h3>Description</h3>

<p>Create main or accompanying plot(s) of the moving subset analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MSA_coef'
plot(x, i_var = 1:length(x), main_plot = TRUE, i_acc = 1, 
     axis.param = list(), label.param = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.MSA_coef_+3A_x">x</code></td>
<td>

<p>Object of class <code>MSA_coef</code>. Output of <code><a href="#topic+moving_subset_analysis">moving_subset_analysis</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.MSA_coef_+3A_i_var">i_var</code></td>
<td>

<p>Column number or name of the forcing variable used to define the subset which will be plotted. Default is to plot all available variables.
</p>
</td></tr>
<tr><td><code id="plot.MSA_coef_+3A_main_plot">main_plot</code></td>
<td>

<p>Flag to determine whether to plot the main plot(s) (default) or the accompanying plot(s)
</p>
</td></tr>
<tr><td><code id="plot.MSA_coef_+3A_i_acc">i_acc</code></td>
<td>

<p>If main_plot = FALSE, column number(s) of the experiment-support variable(s) to be plotted as accompanying variable(s)
</p>
</td></tr>
<tr><td><code id="plot.MSA_coef_+3A_axis.param">axis.param</code></td>
<td>

<p>List containing the axis parameters (e.g. lty, col, tck). By default for main plots, first entry represents x-axis (forcing variable), second entry represents first y-axis (regression result), and third entry the second y-axis (dependent variable). See example section.
</p>
</td></tr>
<tr><td><code id="plot.MSA_coef_+3A_label.param">label.param</code></td>
<td>

<p>List containing the label parameters (e.g. line, cex). For order of the list refer to axis.param. See example section.
</p>
</td></tr>   
<tr><td><code id="plot.MSA_coef_+3A_...">...</code></td>
<td>

<p>Parameters passed to generic plot function
</p>
</td></tr>

</table>


<h3>Author(s)</h3>

<p>Wolfgang A. Obermeier, Lukas W. Lehnert, Joerg Bendix
</p>


<h3>See Also</h3>

<p><code><a href="#topic+moving_subset_analysis">moving_subset_analysis</a></code>, <code><a href="#topic+GiFACE">GiFACE</a></code>, <code><a href="#topic+summary.MSA_coef">summary.MSA_coef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GiFACE)

### Perform Moving Subset Analysis
msa_data &lt;- moving_subset_analysis(GiFACE$data, "CO2A_Mean", "BYT", 30, group = GiFACE$year)

## Plot all final plots
plot(msa_data)

## Not run: 
## Example to produce similar plots as in article
pdf("Plot_NCC_1.pdf", width = 15, height = 20)
par(mfcol = c(9,4), mar = c(4,4,1,4), las = 0)
for(i in 1:4){
  plot(msa_data, i_var = i, ylim = list(c(0,2.5), c(200,350)), 
       legend = i == 1)
  plot(msa_data, i_var = i, main_plot = F, i_acc = 1:8)
}
dev.off()

## End(Not run)

## Not run: 
## Example to adjust axis and label parameters
par(mar = c(3.2,3.5,1,3), mfrow = c(2,1))
## Plot default for comparison
plot(msa_data, i_var = 2)     

## Change default axis (all parameters are passed to internal function "axis")
## Define x-axis specifications
xaxt_spec  &lt;- list(tck = -0.02, padj = -0.3, cex.axis = 1.5, lwd = 2)
## Define 1st y-axis specifications 
yaxt1_spec &lt;- list(at = c(0,1,2), tck = -0.02, padj = 0.5, cex.axis = 1.5, lwd = 2)
## Define 2nd y-axis specifications 
yaxt2_spec &lt;- list(tck = -0.02, padj = -0.3, col = "gray50", col.axis = "gray50",
                   cex.axis = 1.5, lwd = 2)

## Change default labeling (all parameters are passed to internal function "mtext")
## Define x-axis label specifications 
xlab_spec &lt;- list(side = 1, line = 2, cex = 1.5)
## Define 1st y-axis label specifications
ylab1_spec &lt;- list(side = 2, line = 2, cex = 1.5)
## Define 2nd y-axis label specifications 
ylab2_spec &lt;- list(side = 4, line = 2, cex = 1.5, col = "gray50")
                   
                   
## Define variable to be plotted, y-axis limits
plot(msa_data, i_var = 2, ylim = list(c(0,2.5), c(200,350)),                                     
     axis.param = list(xaxt_spec, yaxt1_spec, yaxt2_spec),
     label.param = list(xlab_spec, ylab1_spec, ylab2_spec),
     ## Define line width for horizontal lines (1) and the dependent variable (2)
     lwd = c(1,2),       
     ## Define point symbol
     pch = 20)                                                                                   
dev.off()

## End(Not run)
</code></pre>

<hr>
<h2 id='print.MSA_coef'>
Print MSA_coef
</h2><span id='topic+print.MSA_coef'></span><span id='topic+show.MSA_coef'></span>

<h3>Description</h3>

<p>Print function for output of moving subset analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MSA_coef'
print(x, ...)
## S3 method for class 'MSA_coef'
show(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.MSA_coef_+3A_x">x</code>, <code id="print.MSA_coef_+3A_object">object</code></td>
<td>

<p>List of class <code>MSA_coef</code>
</p>
</td></tr>
<tr><td><code id="print.MSA_coef_+3A_...">...</code></td>
<td>

<p>Parameters passed to generic functions (currently ignored)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prints the column numbers for each experiment-support variable
</p>


<h3>Author(s)</h3>

<p>Wolfgang A. Obermeier, Lukas W. Lehnert, Joerg Bendix
</p>


<h3>See Also</h3>

<p><code><a href="#topic+moving_subset_analysis">moving_subset_analysis</a></code>, <code><a href="#topic+GiFACE">GiFACE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GiFACE)

## Perform Moving Subset Analysis
msa_data &lt;- moving_subset_analysis(GiFACE$data, "CO2A_Mean", "BYT", 30, group = GiFACE$year)

msa_data

</code></pre>

<hr>
<h2 id='summary.MSA_coef'>
Summary for MSA_coef
</h2><span id='topic+summary.MSA_coef'></span>

<h3>Description</h3>

<p>Summary function for output of moving subset analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MSA_coef'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.MSA_coef_+3A_object">object</code></td>
<td>

<p>List of class <code>MSA_coef</code>
</p>
</td></tr>
<tr><td><code id="summary.MSA_coef_+3A_...">...</code></td>
<td>

<p>Parameters passed to generic summary function
</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p>Variable: Name of the forcing experiment-support variable
</p>
</li>
<li> <p>CFEmax: Maximum CO2 fertilization effect
</p>
</li>
<li> <p>CFEmin: Minimum CO2 fertilization effect
</p>
</li>
<li> <p>Cond_for_CFEmax: Forcing variable at maximum CO2 fertilization effect
</p>
</li>
<li> <p>Cond_for_CFEmin: Forcing variable at minimum CO2 fertilization effect
</p>
</li>
<li> <p>Dependent_Max: Maximum of dependent variable
</p>
</li>
<li> <p>Dependent_Min: Minimum of dependent variable
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Wolfgang A. Obermeier, Lukas W. Lehnert, Joerg Bendix
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.MSA_coef">plot.MSA_coef</a></code>, <code><a href="#topic+moving_subset_analysis">moving_subset_analysis</a></code>, <code><a href="#topic+GiFACE">GiFACE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load data
data(GiFACE)

## Perform Moving Subset Analysis
msa_data &lt;- moving_subset_analysis(GiFACE$data, "CO2A_Mean", "BYT", 30, group = GiFACE$year)

## Show summary
summary(msa_data)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
