<!DOCTYPE html><html><head><title>Help for package sMSROC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sMSROC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#auc_ci_boot-internal'><p>Confidence intervals for the AUC (bootstrap)</p></a></li>
<li><a href='#auc_ci_empr-internal'><p>Confidence intervals for the AUC (empirical variance estimation)</p></a></li>
<li><a href='#auc_ci_nvar-internal'><p>Confidence intervals for the AUC (theoretical variance estimation)</p></a></li>
<li><a href='#check_ci_cl-internal'><p>Check confidence level for AUC's confidence intervals</p></a></li>
<li><a href='#check_conf_int-internal'><p>Checks for parameters to compute the confidence intervals for the AUC</p></a></li>
<li><a href='#check_grid-internal'><p>Check grid</p></a></li>
<li><a href='#check_marke_timeic-internal'><p>Check of prognosis scenarios under interval censorship</p></a></li>
<li><a href='#check_marker_binout-internal'><p>Checks of diagnosis scenarios</p></a></li>
<li><a href='#check_marker_timerc-internal'><p>Check of prognosis scenarios under right censorship</p></a></li>
<li><a href='#check_meth-internal'><p>Check the method for estimating the predictive model</p></a></li>
<li><a href='#check_nboots-internal'><p>Check number of bootstrap samples</p></a></li>
<li><a href='#check_ncpus-internal'><p>Check number of CPUs</p></a></li>
<li><a href='#check_tim-internal'><p>Check tim</p></a></li>
<li><a href='#check_type_outcome-internal'><p>Check the type of scenario (diagnosis/prognosis)</p></a></li>
<li><a href='#compute_ROC-internal'><p>Weighted empirical ROC curve estimator</p></a></li>
<li><a href='#conf_int_print'><p>AUC and confidence intervals</p></a></li>
<li><a href='#diabet'><p>Diabetes dataset</p></a></li>
<li><a href='#evol_auc'><p>Evolution of the AUCs</p></a></li>
<li><a href='#explore_plot'><p>Graphical exploratory data analysis</p></a></li>
<li><a href='#explore_table'><p>Exploratory data analysis</p></a></li>
<li><a href='#fibrosis'><p>Fibrosis dataset</p></a></li>
<li><a href='#ktfs'><p>KTFS dataset</p></a></li>
<li><a href='#pred_model_binout-internal'><p>Predictive model estimation in diagnosis scenarios</p></a></li>
<li><a href='#pred_model_emp-internal'><p>Predictive model (naive estimation)</p></a></li>
<li><a href='#pred_model_timeic-internal
'><p>Predictive model in prognosis scenarios (I)</p></a></li>
<li><a href='#pred_model_timerc-internal'><p>Predictive model in prognosis scenarios (II)</p></a></li>
<li><a href='#print.sMSROC'><p>Print sMSROC</p></a></li>
<li><a href='#probs_pred'><p>Plot of the predictive model</p></a></li>
<li><a href='#sMS_binout-internal'><p>sMS estimator for diagnostic biomarkers</p></a></li>
<li><a href='#sMS_timeic-internal'><p>sMS estimator for prognostic biomarkers and interval censoring</p></a></li>
<li><a href='#sMS_timerc'><p>sMS estimator for prognostic biomarkers and right censorship</p></a></li>
<li><a href='#sMSROC'><p>sMS ROC curve estimator computation</p></a></li>
<li><a href='#sMSROC_plot'><p>Plot of the sMS ROC curve estimate</p></a></li>
<li><a href='#variance_probs-internal'><p>Variance of the predictive model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Assessment of Diagnostic and Prognostic Markers</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides estimations of the Receiver Operating Characteristic (ROC) curve and the Area Under the Curve (AUC) based on the two-stages mixed-subjects ROC curve estimator (Diaz-Coto et al. (2020) &lt;<a href="https://doi.org/10.1515%2Fijb-2019-0097">doi:10.1515/ijb-2019-0097</a>&gt; and Diaz-Coto et al. (2020) &lt;<a href="https://doi.org/10.1080%2F00949655.2020.1736071">doi:10.1080/00949655.2020.1736071</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, rms, foreach, ggplot2, flextable, plotROC, icenReg,
thregI</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-07 15:27:37 UTC; SCoto</td>
</tr>
<tr>
<td>Author:</td>
<td>Susana Diaz-Coto [aut],
  Susana Diaz-Coto [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Susana Diaz-Coto &lt;susanacoto@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-07 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='auc_ci_boot-internal'>Confidence intervals for the AUC (bootstrap)
</h2><span id='topic+auc_ci_boot'></span>

<h3>Description</h3>

<p>Computation of confidence intervals for the AUC based on Bootstrap Percentile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc_ci_boot(marker, outcome, status, observed.time, left, right, time,
                    data_type, meth, grid, probs, ci.cl, ci.nboots, parallel,
                    ncpus, all)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auc_ci_boot-internal_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_outcome">outcome</code></td>
<td>
<p>vector with the condition of the subjects as positive, negative or unknown at the considered time <code>time</code>.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_status">status</code></td>
<td>
<p>response vector.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_observed.time">observed.time</code></td>
<td>
<p>vector with the observed times for each subject.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_left">left</code></td>
<td>
<p>vector with the lower edges of the observed intervals.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_time">time</code></td>
<td>
<p>point of time at which the sMS ROC curve estimator will be computed.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_data_type">data_type</code></td>
<td>
<p>scenario handled.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_meth">meth</code></td>
<td>
<p>method for approximating the predictive model <code class="reqn">P(D|X=x)</code>.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_grid">grid</code></td>
<td>
<p>grid size.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_probs">probs</code></td>
<td>
<p>vector containing the probabilities estimated through the predictive model.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_ci.cl">ci.cl</code></td>
<td>
<p>confidence level at which the confidence intervals will be computed.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_ci.nboots">ci.nboots</code></td>
<td>
<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_parallel">parallel</code></td>
<td>
<p>indicates whether parallel computing will be performed or not.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_ncpus">ncpus</code></td>
<td>
<p>number of CPUs to use if parallel computing is performed.
</p>
</td></tr>
<tr><td><code id="auc_ci_boot-internal_+3A_all">all</code></td>
<td>
<p>indicates whether the probabilities from the predictive model will be considered for all individuals, or only for those whose outcome value (condition) is unknown.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with two components:
</p>
<table>
<tr><td><code>ic.l</code></td>
<td>
<p> lower edge of the confidence interval.</p>
</td></tr>
<tr><td><code>ic.u</code></td>
<td>
<p> upper edge of the confidence interval.</p>
</td></tr>
</table>

<hr>
<h2 id='auc_ci_empr-internal'>Confidence intervals for the AUC (empirical variance estimation)
</h2><span id='topic+auc_ci_empr'></span>

<h3>Description</h3>

<p>Computation of confidence intervals for the AUC by implementing the empirical
procedure for estimating the variance of the AUC, as described in <a href="https://doi.org/10.1515/ijb-2019-0097">doi:10.1515/ijb-2019-0097</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc_ci_empr(SE, SP, auc, probs, controls, cases, ci.cl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auc_ci_empr-internal_+3A_se">SE</code></td>
<td>
<p>vector containing the values of the sensitivity returned from the <code><a href="#topic+sMSROC">sMSROC</a></code> function.
</p>
</td></tr>
<tr><td><code id="auc_ci_empr-internal_+3A_sp">SP</code></td>
<td>
<p>vector containing the values of the specificity.
</p>
</td></tr>
<tr><td><code id="auc_ci_empr-internal_+3A_auc">auc</code></td>
<td>
<p>value with the AUC estimate.
</p>
</td></tr>
<tr><td><code id="auc_ci_empr-internal_+3A_probs">probs</code></td>
<td>
<p>vector containing the probabilities estimated through the predictive model.
</p>
</td></tr>
<tr><td><code id="auc_ci_empr-internal_+3A_controls">controls</code></td>
<td>
<p>number of negative individuals.</p>
</td></tr>
<tr><td><code id="auc_ci_empr-internal_+3A_cases">cases</code></td>
<td>
<p>number of positive individuals.</p>
</td></tr>
<tr><td><code id="auc_ci_empr-internal_+3A_ci.cl">ci.cl</code></td>
<td>
<p>confidence level at which confidence intervals will be computed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with two components:
</p>
<table>
<tr><td><code>ic.l</code></td>
<td>
<p>lower edge of the confidence interval.</p>
</td></tr>
<tr><td><code>ic.u</code></td>
<td>
<p>upper edge of the confidence interval.</p>
</td></tr>
</table>

<hr>
<h2 id='auc_ci_nvar-internal'>Confidence intervals for the AUC (theoretical variance estimation)
</h2><span id='topic+auc_ci_nvar'></span>

<h3>Description</h3>

<p>Computation of confidence intervals for the AUC by implementing the theoretical procedure for estimating the variance of the AUC, as described in  <a href="https://doi.org/10.1515/ijb-2019-0097">doi:10.1515/ijb-2019-0097</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc_ci_nvar(marker, outcome, status, observed.time, left, right, time,
                    meth, data_type, grid, probs, sd.probs, ci.cl, nboots,
                    SE, SP, auc, parallel, ncpus, all)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auc_ci_nvar-internal_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_outcome">outcome</code></td>
<td>
<p>vector with the condition of the subjects as positive, negative or unknown at the considered time <code>time</code>.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_status">status</code></td>
<td>
<p>response vector.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_observed.time">observed.time</code></td>
<td>
<p>vector with the observed times for each subject.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_left">left</code></td>
<td>
<p>vector with the lower edges of the observed intervals.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_time">time</code></td>
<td>
<p>point of time at which the sMS ROC curve estimator will be computed.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_meth">meth</code></td>
<td>
<p>method for approximating the predictive model <code class="reqn">P(D|X=x)</code>.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_data_type">data_type</code></td>
<td>
<p>scenario handled.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_grid">grid</code></td>
<td>
<p>grid size.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_probs">probs</code></td>
<td>
<p>vector containing the probabilities estimated through the predictive model.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_sd.probs">sd.probs</code></td>
<td>
<p>vector containing the standard deviation of the probabilities of the predictive model.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_ci.cl">ci.cl</code></td>
<td>
<p>confidence levet at which the confidence intervals will be computed.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_nboots">nboots</code></td>
<td>
<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_se">SE</code></td>
<td>
<p>vector containing the values of the sensitivity returned from <code><a href="#topic+sMSROC">sMSROC</a></code> function.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_sp">SP</code></td>
<td>
<p>vector containing the values of the specificity.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_auc">auc</code></td>
<td>
<p>value with the AUC estimate.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_parallel">parallel</code></td>
<td>
<p>indicates whether parallel computing will be performed or not.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_ncpus">ncpus</code></td>
<td>
<p>number of CPUs to use if parallel computing is performed.
</p>
</td></tr>
<tr><td><code id="auc_ci_nvar-internal_+3A_all">all</code></td>
<td>
<p>parameter indicating whether all probabilities given by the predictive model should be considered (value <b>&ldquo;T&rdquo;</b>) or just those corresponding to individuals whose condition as positive or negative is unknown (<b>&ldquo;F&rdquo;</b>). The default value is (<b>&ldquo;T&rdquo;</b>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with two components:
</p>
<table>
<tr><td><code>ic.l</code></td>
<td>
<p>lower edge of the confidence interval.</p>
</td></tr>
<tr><td><code>ic.u</code></td>
<td>
<p>upper edge of the confidence interval.</p>
</td></tr>
</table>

<hr>
<h2 id='check_ci_cl-internal'>Check confidence level for AUC's confidence intervals</h2><span id='topic+check_ci_cl'></span>

<h3>Description</h3>

<p>Checks the validity of the value entered as confidence level for computing the confidence intervals for the AUC.</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_ci_cl(ci.cl)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_ci_cl-internal_+3A_ci.cl">ci.cl</code></td>
<td>
<p>confidence level at which the confidence intervals for the AUC will be computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Verifies that the value entered as confidence level ranges between 0 and 1. The 0.95 confidence level is taken as default.
</p>


<h3>Value</h3>

<p>A list with two components:
</p>
<table>
<tr><td><code>ci.cl</code></td>
<td>
<p>value entered as confidence level for the AUC.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>table with the warning messages generated by the function.</p>
</td></tr>
</table>

<hr>
<h2 id='check_conf_int-internal'>Checks for parameters to compute the confidence intervals for the AUC</h2><span id='topic+check_conf_int'></span>

<h3>Description</h3>

<p>Check of the consistency of the parameters indicated to compute the confidence intervals for the AUC.</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_conf_int(conf.int, ci.cl, ci.meth, ci.nboots, parallel, ncpus)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_conf_int-internal_+3A_conf.int">conf.int</code></td>
<td>
<p>parameter indicating whether confidence intervals for the AUC will be computed (<strong>&ldquo;T&rdquo;</strong>) or not  (<strong>&ldquo;F&rdquo;</strong>). The default is &ldquo;F&rdquo;.</p>
</td></tr>
<tr><td><code id="check_conf_int-internal_+3A_ci.cl">ci.cl</code></td>
<td>
<p>confidence level at which the confidence intervals for the AUC will be calculated. The default value is 0.95.</p>
</td></tr>
<tr><td><code id="check_conf_int-internal_+3A_ci.meth">ci.meth</code></td>
<td>
<p>method for computing the confidence intervals according to <a href="https://doi.org/10.1515/ijb-2019-0097">doi:10.1515/ijb-2019-0097</a>. There are three options:
</p>

<ul>
<li> <p><b>&ldquo;E&rdquo;</b>, for the <b>E</b>mpirical variance estimation.
</p>
</li>
<li> <p><b>&ldquo;V&rdquo;</b>, for the theoretical <b>V</b>ariance estimation.
</p>
</li>
<li> <p><b>&ldquo;B&rdquo;</b>, for the <b>B</b>ootstrap Percentile.
</p>
</li></ul>

<p>The empirical method <b>E</b> is taken as default. This parameter is ignored if <code>conf.int</code> is set to &ldquo;F&rdquo;.
</p>
</td></tr>
<tr><td><code id="check_conf_int-internal_+3A_ci.nboots">ci.nboots</code></td>
<td>
<p>number of bootstrap samples to be generated when the chosen <code>ci.meth</code> is <strong>&ldquo;B&rdquo;.</strong> The default values is 500.</p>
</td></tr>
<tr><td><code id="check_conf_int-internal_+3A_parallel">parallel</code></td>
<td>
<p>indicates whether parallel computing will be done (<b>&ldquo;T&rdquo;</b>) or not (<b>&ldquo;F&rdquo;</b>), when computing the variance of the AUC through the methods <strong>&ldquo;V&rdquo;</strong> and <strong>&ldquo;B&rdquo;</strong>.</p>
</td></tr>
<tr><td><code id="check_conf_int-internal_+3A_ncpus">ncpus</code></td>
<td>
<p>number of CPUS that will be used when parallel computing is chosen.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>ci.cl</code></td>
<td>
<p>value entered as confidence level for the AUC.</p>
</td></tr>
<tr><td><code>ci.meth</code></td>
<td>
<p>value entered as method for computing the confidence intervals.</p>
</td></tr>
<tr><td><code>ci.nboots</code></td>
<td>
<p>value entered as number of bootstrap samples.</p>
</td></tr>
<tr><td><code>ci.ncpus</code></td>
<td>
<p>value entered as number of CPUs chosen.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>table with the warning messages generated by the function.</p>
</td></tr>
</table>

<hr>
<h2 id='check_grid-internal'>Check grid</h2><span id='topic+check_grid'></span>

<h3>Description</h3>

<p>Cheking of the parameter grid.</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_grid(grid)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_grid-internal_+3A_grid">grid</code></td>
<td>
<p> grid size for computing the ROC curve estimate. The default value is 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Verifies if the parameter entered as grid is a numerical value greater than 0.
</p>


<h3>Value</h3>

<p>A list with two components:
</p>
<table>
<tr><td><code>grid</code></td>
<td>
<p> grid size entered.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>table with the warning messages generated by the function.</p>
</td></tr>
</table>

<hr>
<h2 id='check_marke_timeic-internal'>Check of prognosis scenarios under interval censorship
</h2><span id='topic+check_marker_timeic'></span>

<h3>Description</h3>

<p>Checks the consistency of the parameters entered for prognosis scenarios under interval censorship.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_marker_timeic(marker, left, right, time, probs, sd.probs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_marke_timeic-internal_+3A_marker">marker</code></td>
<td>
<p> vector with the biomarker values. It is a mandatory parameter.</p>
</td></tr>
<tr><td><code id="check_marke_timeic-internal_+3A_left">left</code></td>
<td>
<p>vector containing the lower edges of the observed intervals. It is mandatory in prognosis scenarios and interval censorship and ignored in other situations.</p>
</td></tr>
<tr><td><code id="check_marke_timeic-internal_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals. It is mandatory as well in prognosis scenarios and interval censorship and ignored in other situations.</p>
</td></tr>
<tr><td><code id="check_marke_timeic-internal_+3A_time">time</code></td>
<td>
<p> point of time at which the sMS ROC curve estimator will be computed. It is a mandatory parameter. The default value is 1.</p>
</td></tr>
<tr><td><code id="check_marke_timeic-internal_+3A_probs">probs</code></td>
<td>
<p> vector containing the probabilities corresponding to the predictive model when it has been externally computed. Only values between [0,1] are admissible.</p>
</td></tr>
<tr><td><code id="check_marke_timeic-internal_+3A_sd.probs">sd.probs</code></td>
<td>
<p> vector with the standard deviations of the probabilities entered in <code>probs</code>. It is an optional parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following components:
</p>
<table>
<tr><td><code>marker</code></td>
<td>
<p> vector containing the biomarker values.</p>
</td></tr>
<tr><td><code>left</code></td>
<td>
<p> vector containing the lower edges of the observed intervals.</p>
</td></tr>
<tr><td><code>right</code></td>
<td>
<p> vector containing the upper edges of the observed intervals.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p> vector with the probabilities corresponding to the predictive model.</p>
</td></tr>
<tr><td><code>sd.probs</code></td>
<td>
<p> vector containing the standard deviations of the predictive model if they have been manually entered.</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>vector with the condition of the subjects at the time <code>time</code>, as positive, negative or unknown.</p>
</td></tr>
<tr><td><code>controls</code></td>
<td>
<p> number of negative subjects.</p>
</td></tr>
<tr><td><code>cases</code></td>
<td>
<p> number of positive subjects.</p>
</td></tr>
<tr><td><code>misout</code></td>
<td>
<p> number of subjects whose condition is unknown.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p> table containing the warning messages generated during the execution of the function.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>check_marker_binout</code> and <code>check_marker_timerc</code>
</p>

<hr>
<h2 id='check_marker_binout-internal'>Checks of diagnosis scenarios</h2><span id='topic+check_marker_binout'></span>

<h3>Description</h3>

<p>Checks the consistency of the parameters entered for diagnosis scenarios.</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_marker_binout(marker, status, probs, sd.probs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_marker_binout-internal_+3A_marker">marker</code></td>
<td>
<p> vector with the biomarker values. It is a mandatory parameter.
</p>
</td></tr>
<tr><td><code id="check_marker_binout-internal_+3A_status">status</code></td>
<td>
<p> numeric response vector. Only two values will be taken into account. The highest one is assumed to stand for the subjects having the event under study. The lowest value, for those who do not. Any other value will not be considered. It is a mandatory parameter in diagnosis scenarios.
</p>
</td></tr>
<tr><td><code id="check_marker_binout-internal_+3A_probs">probs</code></td>
<td>
<p> vector containing the probabilities corresponding to the predictive model when it has been externally computed. Obviosly, only values between [0,1] are admissible.</p>
</td></tr>
<tr><td><code id="check_marker_binout-internal_+3A_sd.probs">sd.probs</code></td>
<td>
<p> vector with the standard deviations of the probabilities entered in <code>probs</code>. It is an optional parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The ouput is a list with the following components:
</p>
<table>
<tr><td><code>marker</code></td>
<td>
<p>vector containing the biomarker values.</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>vector with the condition of the subjects as positive or negative.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>vector with the probabilities corresponding to the predictive model.</p>
</td></tr>
<tr><td><code>sd.probs</code></td>
<td>
<p> vector containing the standard deviations of the predictive model if they have been manually entered.</p>
</td></tr>
<tr><td><code>controls</code></td>
<td>
<p> number of negative subjects.</p>
</td></tr>
<tr><td><code>cases</code></td>
<td>
<p> number of negative subjects.</p>
</td></tr>
<tr><td><code>misout</code></td>
<td>
<p> number of subjects whose outcome value is not known.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p> table containing the warning messages generated during the execution of the function.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>check_marker_timerc</code> and <code>check_marker_timeic</code>
</p>

<hr>
<h2 id='check_marker_timerc-internal'>Check of prognosis scenarios under right censorship</h2><span id='topic+check_marker_timerc'></span>

<h3>Description</h3>

<p>Checks the consistency of the parameters entered for prognosis scenarios under right censorship.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_marker_timerc(marker, status, observed.time, time, probs, sd.probs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_marker_timerc-internal_+3A_marker">marker</code></td>
<td>
<p> vector with the biomarker values. It is a mandatory parameter.</p>
</td></tr>
<tr><td><code id="check_marker_timerc-internal_+3A_status">status</code></td>
<td>
<p> numeric response vector. Only two values will be taken into account. The highest one is assumed to stand for the subjects having the event under study. The lowest value, for those who do not. Any other value will not be considered. It is mandatory in prognosis scenarios and right censorship.</p>
</td></tr>
<tr><td><code id="check_marker_timerc-internal_+3A_observed.time">observed.time</code></td>
<td>
<p> vector with the observed times for each subject. These values can be the event times or the censoring times. It is mandatory when dealing with time-dependent outcomes under right censorship.</p>
</td></tr>
<tr><td><code id="check_marker_timerc-internal_+3A_time">time</code></td>
<td>
<p> point of time at which the sMS ROC curve estimator will be computed. It is a mandatory parameter. The default value is 1.</p>
</td></tr>
<tr><td><code id="check_marker_timerc-internal_+3A_probs">probs</code></td>
<td>
<p> vector containing the probabilities corresponding to the predictive model when it has been externally computed. Only values between [0,1] are admissible.</p>
</td></tr>
<tr><td><code id="check_marker_timerc-internal_+3A_sd.probs">sd.probs</code></td>
<td>
<p> vector with the standard deviations of the probabilities entered in <code>probs</code>. It is an optional parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following components:
</p>
<table>
<tr><td><code>marker</code></td>
<td>
<p> vector containing the biomarker values.</p>
</td></tr>
<tr><td><code>status</code></td>
<td>
<p> response vector.</p>
</td></tr>
<tr><td><code>observed.time</code></td>
<td>
<p> vector containing the observed time. Recall event/censoring time.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p> vector with the probabilities corresponding to the predictive model.</p>
</td></tr>
<tr><td><code>sd.probs</code></td>
<td>
<p> vector containing the standard deviations of the predictive model if they have been manually entered.</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>vector with the condition of the subjects at the time given in <code>time</code> as positive, negative or unknown.</p>
</td></tr>
<tr><td><code>controls</code></td>
<td>
<p> number of negative subjects.</p>
</td></tr>
<tr><td><code>cases</code></td>
<td>
<p> number of positive subjects.</p>
</td></tr>
<tr><td><code>misout</code></td>
<td>
<p> number of unknown subjects.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p> table containing the warning messages generated during the execution of the function.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>check_marker_binout</code> and <code>check_marker_timeic</code>
</p>

<hr>
<h2 id='check_meth-internal'>Check the method for estimating the predictive model</h2><span id='topic+check_meth'></span>

<h3>Description</h3>

<p>When the predictive model is entered manually by the user, this function ensures that no other method by default is used to compute it.</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_meth(meth, probs)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_meth-internal_+3A_meth">meth</code></td>
<td>
<p> method for approximating the predictive model <code class="reqn">P (D | X=x)</code>.</p>
</td></tr>
<tr><td><code id="check_meth-internal_+3A_probs">probs</code></td>
<td>
<p> vector containing the probabilities corresponding to the predictive model when it is entered manually by the user.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the predicitve model has been manually indicated, this function sets the parameter to <strong>&quot;M&quot;</strong> ignoring other options. In this way, none of the function computing the predictive model will be called.
</p>


<h3>Value</h3>

<p>A list with one component:
</p>
<table>
<tr><td><code>meth</code></td>
<td>
<p> value set up for the method parameter.It can take eiter the value entered by the user or its default, if the predictive model was not manually indicated, or the value <strong>&quot;M&quot;</strong>, when the predicitive model was entered in the parameter <code>probs</code>.
</p>
</td></tr>
</table>

<hr>
<h2 id='check_nboots-internal'>Check number of bootstrap samples</h2><span id='topic+check_nboots'></span>

<h3>Description</h3>

<p>This function checks if the value entered as number of bootstrap samples is correct.</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_nboots(nboots)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_nboots-internal_+3A_nboots">nboots</code></td>
<td>
<p> number of bootstrap samples to be run. The default value is 500.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components:
</p>
<table>
<tr><td><code>nboots</code></td>
<td>
<p> value entered as number of bootstrap samples.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>table with the warning messages generated by the function.</p>
</td></tr>
</table>

<hr>
<h2 id='check_ncpus-internal'>Check number of CPUs</h2><span id='topic+check_ncpus'></span>

<h3>Description</h3>

<p>Checks the number of CPUs to be used when parallel computing is performed. The default value is 1 and the maximum is 2.</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_ncpus(ncpus)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_ncpus-internal_+3A_ncpus">ncpus</code></td>
<td>
<p> number of CPUs to be used when performing parallel computing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components:
</p>
<table>
<tr><td><code>ncpus</code></td>
<td>
<p> value entered as number of CPUs chosen.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>table with the warning messages generated by the function.</p>
</td></tr>
</table>

<hr>
<h2 id='check_tim-internal'>Check tim</h2><span id='topic+check_tim'></span>

<h3>Description</h3>

<p>Cheking of the parameter time.</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_tim(time)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_tim-internal_+3A_time">time</code></td>
<td>
<p> point of time at which the ROC curve estimate in prognosis scenarios will be computed. It is mandatory in this scenario.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components:
</p>
<table>
<tr><td><code>time</code></td>
<td>
<p> value entered as time.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>table with the warning messages generated by the function.</p>
</td></tr>
</table>

<hr>
<h2 id='check_type_outcome-internal'>Check the type of scenario (diagnosis/prognosis)
</h2><span id='topic+check_type_outcome'></span>

<h3>Description</h3>

<p>Determines the type of scenario handled: diagnosis or prognosis, under right or interval censorship, according to the parameters entered by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_type_outcome(status, observed.time, left, right)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_type_outcome-internal_+3A_status">status</code></td>
<td>
<p>numeric response vector. Only two values will be taken into account. The highest one is assumed to stand for the subjects having the event under study. The lowest value, for those who do not. Any other value will not be considered.</p>
</td></tr>
<tr><td><code id="check_type_outcome-internal_+3A_observed.time">observed.time</code></td>
<td>
<p>vector with the observed times for each subject, when dealing with time-dependent outcomes under right censorship. These values can be the event times or the censoring times.</p>
</td></tr>
<tr><td><code id="check_type_outcome-internal_+3A_left">left</code></td>
<td>
<p>vector containing the lower edges of the observed intervals. It is mandatory when dealing with prognosis scenarios and interval censorship, and will be ignored in other situations.</p>
</td></tr>
<tr><td><code id="check_type_outcome-internal_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals. It is mandatory as well in prognosis scenarios and interval censorship and ignored in other situations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If both the vectors status and observed time are indicated the funtion assumes a prognosis scenario and right censorship. When only the vector status is entered, a diagnosis scenario is set up. If none of these parameters are indicated but the left and right ones, a prognosis scenario and interval censorship is assumed. Any other case, the function is not able to determine the type of scenario.
</p>


<h3>Value</h3>

<p>A list with a single component:
</p>
<table>
<tr><td><code>type.outcome</code></td>
<td>
<p> string of length 6 with the following values:
</p>

<ul>
<li> <p><b>&quot;binout&quot;</b>, in the case of diagnosis scenarios.
</p>
</li>
<li> <p><b>&quot;timerc&quot;</b>, for prognosis scenarios and right censorship.
</p>
</li>
<li> <p><b>&quot;timeic&quot;</b>, for prognosis scenarios and interval censorship.
</p>
</li>
<li> <p><b>&quot;unknow&quot;</b>, if it is not possible to determine the type of scenario.
</p>
</li></ul>

</td></tr>
</table>

<hr>
<h2 id='compute_ROC-internal'>Weighted empirical ROC curve estimator
</h2><span id='topic+compute_ROC'></span>

<h3>Description</h3>

<p>Computes the weighted empirical ROC curve estimator associated to the input biomarker.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ROC(marker, probs, grid)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_ROC-internal_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.</p>
</td></tr>
<tr><td><code id="compute_ROC-internal_+3A_probs">probs</code></td>
<td>
<p>vector containing the probabilities corresponding to the predictive model.</p>
</td></tr>
<tr><td><code id="compute_ROC-internal_+3A_grid">grid</code></td>
<td>
<p>grid size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p> This function computes the weighted empirical estimators for the sensitivity (SE) and specificity (SP) using as weights the probabilities given by the predictive model. Then, the ROC curve is approximated through linear interpolation of 1 - SP and SE and computed at a partition of the <code class="reqn">[0,1]</code> interval of size <code>grid</code>.
</p>


<h3>Value</h3>

<p> The returned value is a list with the following components:
</p>
<table>
<tr><td><code>SE</code></td>
<td>
<p> vector with the weighted empirical estimator of the sensitivity.</p>
</td></tr>
<tr><td><code>SP</code></td>
<td>
<p> vector with the weighted empirical estimator of the specificity.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p> vector containing the points between 0 and 1 at which the ROC curve estimator will be computed. Its size is determined by the <code>grid</code> parameter.</p>
</td></tr>
<tr><td><code>ROC</code></td>
<td>
<p> ROC curve approximated at each point of the vector <code>u</code>.</p>
</td></tr>
<tr><td><code>auc</code></td>
<td>
<p> area under the weighted empirical ROC curve estimator.</p>
</td></tr>
<tr><td><code>marker</code></td>
<td>
<p> vector with the ordered biomarker values.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p> vector with the probabilities of the predictive model corresponding to each biomarker value.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>sMSbinout</code>, <code>sMStimerc</code> and <code>sMStimeic</code>
</p>

<hr>
<h2 id='conf_int_print'>AUC and confidence intervals
</h2><span id='topic+conf_int_print'></span>

<h3>Description</h3>

<p>Prints the AUC estimate value and its confidence intervals computed by the <code><a href="#topic+sMSROC">sMSROC</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conf_int_print(sMS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conf_int_print_+3A_sms">sMS</code></td>
<td>
<p>object of class <code>sMS</code> returned by the function <code><a href="#topic+sMSROC">sMSROC</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function reads the AUC, lower and upper edges of its confidence intervals and the confidence level at which they were computed and prints this information in a single line.
</p>


<h3>Value</h3>

<p>Printed string in the console containing the AUC, its confidence intervals and the confidence level at which they were computed.
</p>


<h3>See Also</h3>

<p><code>sMSROC</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(diabet)
roc &lt;- sMSROC(marker=diabet$stab.glu, status=diabet$glyhb, conf.int="T")
conf_int_print(roc)
</code></pre>

<hr>
<h2 id='diabet'>Diabetes dataset
</h2><span id='topic+diabet'></span>

<h3>Description</h3>

<p>This dataset contains part of the Diabetes Dataset (see References), courtesy of Dr John Schorling from the Department of Medicine, University of Virginia School of Medicine.
This version contains 3 variables on 403 subjects interviewed to understand the prevalence of several cardiovascular risks factors in central Virginia for African Americans.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("diabet")</code></pre>


<h3>Format</h3>

<p>A data frame with 403 observations on the following 3 variables.
</p>

<dl>
<dt><code>stab.glu</code></dt><dd><p>a numeric vector indicating the level of stabilized glucose.</p>
</dd>
<dt><code>glyhb</code></dt><dd><p>a numeric vector indicating the level of glycosolated hemoglobin.</p>
</dd>
<dt><code>age</code></dt><dd><p>age in years of the participants.</p>
</dd>
<dt><code>diab</code></dt><dd><p>a numeric vector indicating whether the subject is diagnosed as diabetic (value = 1) or not (value = 0). </p>
</dd>
</dl>



<h3>Details</h3>

<p>The <b>diab</b> variable is not present in the original dataset. Here, values of glycosolated hemoglobin &gt; 7.0 were taken as a positive diagnosis of diabetes (<b>diab</b> = 1) and those of glycosolated hemoglobin &lt;= 7.0 as a negative diagnosis (<b>diab</b> = 0).
</p>


<h3>Source</h3>

<p>Full dataset can be downloaded at <a href="https://hbiostat.org/data">https://hbiostat.org/data</a>.
</p>


<h3>References</h3>

<p>Willems JP, Saunders JT, Hunt DE, Schorling JB. Prevalence of coronary heart disease risk factors among rural blacks: a community-based study. South Med J. 1997 Aug;90(8):814-20. PMID: 9258308.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(diabet)
summary(diabet)
</code></pre>

<hr>
<h2 id='evol_auc'>Evolution of the AUCs
</h2><span id='topic+evol_auc'></span>

<h3>Description</h3>

<p>Plots, in prognosis scenarios, the areas under the ROC curves computed by the sMSROC estimator for a sequence of times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evol_auc(marker, status, observed.time, left, right,
         time = 1, meth = c("L", "S", "E"), grid = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evol_auc_+3A_marker">marker</code></td>
<td>
<p> vector with the biomarker values.
</p>
</td></tr>
<tr><td><code id="evol_auc_+3A_status">status</code></td>
<td>
<p>  numeric response vector. Only two values will be taken into account. The highest one is assumed to stand for the subjects having the event under study. The lowest value, for those who do not. Any other value will not be considered. It is mandatory in prognosis scenarios and right censorship.
</p>
</td></tr>
<tr><td><code id="evol_auc_+3A_observed.time">observed.time</code></td>
<td>
<p> vector with the observed times for each subject, for prognosis scenarios under right censorship. Notice that these values may be the event times or the censoring times.
</p>
</td></tr>
<tr><td><code id="evol_auc_+3A_left">left</code></td>
<td>
<p>vector containing the lower edges of the observed intervals. It is mandatory in prognosis scenarios under interval censorship and ignored in other situations.
</p>
</td></tr>
<tr><td><code id="evol_auc_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals. It is mandatory in prognosis scenarios under interval censorship and ignored in other situations. The infinity is admissible as value (indicated as <b>inf</b>).
</p>
</td></tr>
<tr><td><code id="evol_auc_+3A_time">time</code></td>
<td>
<p>vector of times at which the sMS ROC curve estimator will be computed. The default value is 1.</p>
</td></tr>
<tr><td><code id="evol_auc_+3A_meth">meth</code></td>
<td>
<p>method for approximating the predictive model <code class="reqn">P(D|X=x)</code>. There are several options available:
</p>

<ul>
<li> <p><b>&ldquo;E&rdquo;,</b> allocates to each individual their own status value as having the event of interest or not. Those with missing status values or censored at a fixed point of time <b>t</b> are dismissed.
</p>
</li>
<li> <p><b>&ldquo;L&rdquo;,</b> for proportional hazards regression models.
</p>
</li>
<li> <p><b>&ldquo;S&rdquo;,</b> for smooth models.
</p>
</li></ul>

</td></tr>
<tr><td><code id="evol_auc_+3A_grid">grid</code></td>
<td>
<p>grid size for computing the AUC. Default value 500.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls the <code><a href="#topic+sMSROC">sMSROC</a></code> function at each of the times indicated in the vector <code>time</code>, and the AUC is computed according to the parameters indicated.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>evol.auc</code></td>
<td>
<p>object of class <code><a href="rms.html#topic+ggplot">ggplot</a></code>. A graphic line plotting the AUCs at the considered times.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>vector with the ordered values of the <code>time</code> entered as parameter.</p>
</td></tr>
<tr><td><code>auc</code></td>
<td>
<p>vector with the values of the AUCs computed at the times indicated at the <code>time</code> parameter.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>sMSROC</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example of the use of the evol.AUC function
data(ktfs)
DT = ktfs
aucs &lt;- evol_auc(marker = DT$score,
                 status = DT$failure,
                 observed.time = DT$time,
                 time = seq(2:3),
                 meth = "E")
aucs$evol.auc
</code></pre>

<hr>
<h2 id='explore_plot'>Graphical exploratory data analysis</h2><span id='topic+explore_plot'></span>

<h3>Description</h3>

<p>Plots the kernel density estimations of the biomarker distributions on positive and negative individuals.</p>


<h3>Usage</h3>

<pre><code class='language-R'>explore_plot(marker, status, observed.time, left, right, time)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="explore_plot_+3A_marker">marker</code></td>
<td>
<p> vector with the biomarker values.</p>
</td></tr>
<tr><td><code id="explore_plot_+3A_status">status</code></td>
<td>
<p>numeric response vector. The highest value is assumed to stand for the subjects having the event under study. The lowest value, for those who do not. Any other value will not be considered.</p>
</td></tr>
<tr><td><code id="explore_plot_+3A_observed.time">observed.time</code></td>
<td>
<p> vector with the observed times for each subject, for prognosis scenarios under right censorship. Notice that these values may be the event times or the censoring times.</p>
</td></tr>
<tr><td><code id="explore_plot_+3A_left">left</code></td>
<td>
<p>vector containing the lower edges of the observed intervals. It is mandatory in prognosis scenarios under interval censorship and ignored in other situations.</p>
</td></tr>
<tr><td><code id="explore_plot_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals. It is mandatory in prognosis scenarios under interval censorship and ignored in other situations. The infinity is admissible as value (indicated as <strong>inf</strong>).</p>
</td></tr>
<tr><td><code id="explore_plot_+3A_time">time</code></td>
<td>
<p>point of time at which the sMS ROC curve estimator will be computed. The default value is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The ouput is a list with three components:
</p>
<table>
<tr><td><code>plot</code></td>
<td>
<p>object of class <code>ggplot</code>.</p>
</td></tr>
<tr><td><code>neg</code></td>
<td>
<p>vector with the biomarker values on negative individuals.</p>
</td></tr>
<tr><td><code>pos</code></td>
<td>
<p>vector with the marker values on positive individuals.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>explore_table</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(diabet)
explore_plot(marker=diabet$stab.glu, status=diabet$diab)
</code></pre>

<hr>
<h2 id='explore_table'>Exploratory data analysis</h2><span id='topic+explore_table'></span>

<h3>Description</h3>

<p>This function provides descriptive statistics for the pooled sample and the samples of positive, negative individuals and those whose condition is unknown.</p>


<h3>Usage</h3>

<pre><code class='language-R'>explore_table(marker, status, observed.time, left, right, time, d, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="explore_table_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values. It is a mandatory parameter.</p>
</td></tr>
<tr><td><code id="explore_table_+3A_status">status</code></td>
<td>
<p>numeric response vector. The highest value is assumed to stand for the subjects having the event under study. The lowest value, for those who do not. Any other value will not be considered.</p>
</td></tr>
<tr><td><code id="explore_table_+3A_observed.time">observed.time</code></td>
<td>
<p>vector with the observed times for each subject, for prognosis scenarios under right censorship. Notice that these values may be the event times or the censoring times.</p>
</td></tr>
<tr><td><code id="explore_table_+3A_left">left</code></td>
<td>
<p>vector containing the lower edges of the observed intervals. It is mandatory in prognosis scenarios under interval censorship and ignored in other situations.</p>
</td></tr>
<tr><td><code id="explore_table_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals. It is mandatory in prognosis scenarios under interval censorship and ignored in other situations. The infinity is admissible as value (indicated as <strong>inf</strong>).</p>
</td></tr>
<tr><td><code id="explore_table_+3A_time">time</code></td>
<td>
<p>point of time at which the sMS ROC curve estimator will be computed. The default value is 1.</p>
</td></tr>
<tr><td><code id="explore_table_+3A_d">d</code></td>
<td>
<p>number of decimal figures to which the results will be rounded.</p>
</td></tr>
<tr><td><code id="explore_table_+3A_...">...</code></td>
<td>
<p>additional parameters of the <code>flextable</code> function which allow to customize the output table.</p>
</td></tr></table>


<h3>Details</h3>

<p>The function computes the following descriptive statistics for the pooled sample and the samples of the different groups of individuals: minimum, maximun, mean, variance, standard deviation, and first, second and third quartiles.</p>


<h3>Value</h3>

<p>The ouput is a list with two components:
</p>
<table>
<tr><td><code>summary</code></td>
<td>
<p> matrix whose columns are the statistics described above and the rows show the corresponding results for each sample.</p>
</td></tr>
<tr><td><code>table</code></td>
<td>
<p>object of class <code><a href="flextable.html#topic+flextable">flextable</a></code> that represent the matrix in <code>summary</code> in a customizable table.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>explore_plot</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(diabet)
explore_table(marker=diabet$stab.glu, status=diabet$diab)
</code></pre>

<hr>
<h2 id='fibrosis'>Fibrosis dataset
</h2><span id='topic+fibrosis'></span>

<h3>Description</h3>

<p>Synthetic dataset generated to simulate data from a study that aimed to assess the predictive ability of a constructed score to determine the worsening in the fibrosis stage in individuals infected by the hepatitis C (HC) virus. When participants underwent a target revision, their fibrosis stage, certain polymorphisms, and other clinical variables were collected. Highest stages of fibrosis were considered a worsening in the disease. See References for more information about the study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("fibrosis")</code></pre>


<h3>Format</h3>

<p>A data frame with 722 observations and the following variables:
</p>

<dl>
<dt><code>Id</code></dt><dd><p>Identification label for each participant.
</p>
</dd>
<dt><code>Score</code></dt><dd><p>Score proposed to stratify participants infected by the HC virus according to the risk of a worsening in their fibrosis stage.
</p>
</dd>
<dt><code>Start</code></dt><dd><p>Lower edge of the observable interval.
</p>
</dd>
<dt><code>Stop</code></dt><dd><p>Upper edge of the observable interval. It can take the value infinity, represented as Inf.
</p>
</dd>
</dl>



<h3>Source</h3>

<p>Synthetic dataset.
</p>


<h3>References</h3>

<p>Vidal-Castineira JR. al. Genetic contribution of endoplasmic reticulum aminopeptidase 1 polymorphisms to liver fibrosis progression in patients with HCV infection. Journal of Molecular Medicine, 98:1245-1254, 2020. <a href="https://doi.org/10.1007/s00109-020-01948-1">doi:10.1007/s00109-020-01948-1</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fibrosis)
summary(fibrosis)
</code></pre>

<hr>
<h2 id='ktfs'>KTFS dataset
</h2><span id='topic+ktfs'></span>

<h3>Description</h3>

<p>Dataset originally delivered in the <code>RISCA</code> package. It contains data from kidney transplant recipients for whom the Kidney Transplant Failure Score (KTFS) was collected. The KTFS is a score proposed by Foucher et al. (2010) (see References) to assess the recipients according to their risk of returning in dialysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ktfs")</code></pre>


<h3>Format</h3>

<p>A data frame with 2169 observations and the following 3 variables:
</p>

<dl>
<dt><code>time</code></dt><dd><p>a numeric vector depicting the follow-up time in years.
</p>
</dd>
<dt><code>failure</code></dt><dd><p>a numeric vector indicating the graft failure at the end of the follow-up (1-Yes, 0-Censoring).
</p>
</dd>
<dt><code>score</code></dt><dd><p>a numeric vector representing the  KTFS value.
</p>
</dd>
</dl>



<h3>Source</h3>

<p>This dataset is available at <code>RISCA</code> package. More information about the KTFS score can be found at <a href="https://www.divat.fr">https://www.divat.fr</a>.
</p>


<h3>References</h3>

<p>Foucher Y. al. A clinical scoring system highly predictive of long-term kidney graft survival. Kidney International, 78:1288-94, 2020. <a href="https://doi.org/10.1038/ki.2010.232">doi:10.1038/ki.2010.232</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ktfs)
summary(ktfs)
</code></pre>

<hr>
<h2 id='pred_model_binout-internal'>Predictive model estimation in diagnosis scenarios</h2><span id='topic+pred_model_binout'></span>

<h3>Description</h3>

<p>Estimation of the predictive models in diagnosis scenarios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_model_binout(marker, status, meth)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_model_binout-internal_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.
</p>
</td></tr>
<tr><td><code id="pred_model_binout-internal_+3A_status">status</code></td>
<td>
<p>numeric response vector. The highest value is assumed to stand for the subjects having the event under study. The lowest value, for those who do not. Any other value will not be considered.
</p>
</td></tr>
<tr><td><code id="pred_model_binout-internal_+3A_meth">meth</code></td>
<td>
<p> method for approximating the predictive model <code class="reqn">P(D|X=x)</code>. The options are:
</p>

<ul>
<li> <p><b>&ldquo;L&rdquo;,</b> for <b>L</b>inear logistic regression models.
</p>
</li>
<li> <p><b>&ldquo;S&rdquo;,</b> for <b>S</b>mooth models.
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> If <code>meth</code> = <b>&ldquo;L&rdquo;</b>, the logit transformation of the predicitive model is approximated by a linear logistic regression model:
</p>
<p style="text-align: center;"><code class="reqn">P (D|X=x) = 1/(1 + \exp{- \{ \beta_0 + \beta_1 x \}),}</code>
</p>

<p>with <code class="reqn">\beta_0, \beta_1 \in {\cal R}</code>.
</p>
</li>
<li><p> If <code>meth</code> = <b>&ldquo;S&rdquo;</b>, the logit transformation of the predicitive model is estimated by the smooth logistic regression,
</p>
<p style="text-align: center;"><code class="reqn"> P(D | X=x) = 1 / ( 1 + \exp \{ - s(x) \}),</code>
</p>
<p> being <code class="reqn">s(\cdot)</code> the smooth function (splines, <a href="https://doi.org/10.1002/sim.4780080504">doi:10.1002/sim.4780080504</a>).
</p>
</li></ul>



<h3>Value</h3>

<p>The returned value is a list with the two components:
</p>
<table>
<tr><td><code>marker</code></td>
<td>
<p>vector containing the ordered marker values.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>vector with the probabilities corresponding to each marker value estimated through the predictive model.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>sMS_binout</code> and <code>sMSROC</code>
</p>

<hr>
<h2 id='pred_model_emp-internal'>Predictive model (naive estimation) </h2><span id='topic+pred_model_emp'></span>

<h3>Description</h3>

<p>Naive estimation of the predictive model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_model_emp(marker, status)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_model_emp-internal_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.
</p>
</td></tr>
<tr><td><code id="pred_model_emp-internal_+3A_status">status</code></td>
<td>
<p>numeric response vector. The highest value is assumed to stand for the subjects having the event under study. The lowest value, for those who do not. Any other value will not be considered.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method for estimating the predictive model is used in both diagnosis and prognosis scenarios. It allocates individuals their own condition as positive or negative. Those with unknown condition are dismissed.
</p>


<h3>Value</h3>

<p>The returned value is a list with two components:
</p>
<table>
<tr><td><code>marker</code></td>
<td>
<p>vector containing the ordered marker values.
</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>vector with the probabilities corresponding to each marker value estimated through the predictive model.
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>sMS_binout</code>, <code>sMS_timerc</code>, <code>sMS_timeic</code> and <code>sMSROC</code>
</p>

<hr>
<h2 id='pred_model_timeic-internal+0A'>Predictive model in prognosis scenarios (I)
</h2><span id='topic+pred_model_timeic'></span>

<h3>Description</h3>

<p>Estimation of the predictive model in prognosis scenarios under interval censorship.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_model_timeic(marker, left, right, outcome, time, meth)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_model_timeic-internal+2B0A_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.
</p>
</td></tr>
<tr><td><code id="pred_model_timeic-internal+2B0A_+3A_left">left</code></td>
<td>
<p>vector containing the lower edges of the observed intervals. It is mandatory in prognosis scenarios and interval censorship and ignored in other situations.
</p>
</td></tr>
<tr><td><code id="pred_model_timeic-internal+2B0A_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals. It is mandatory as well in prognosis scenarios and interval censorship and ignored in other situations.
</p>
</td></tr>
<tr><td><code id="pred_model_timeic-internal+2B0A_+3A_outcome">outcome</code></td>
<td>
<p>vector with the condition of the subjects as positive, negative or unknown at the considered time <code>time</code>.
</p>
</td></tr>
<tr><td><code id="pred_model_timeic-internal+2B0A_+3A_time">time</code></td>
<td>
<p>point of time at which the sMS ROC curve estimator will be computed.
</p>
</td></tr>
<tr><td><code id="pred_model_timeic-internal+2B0A_+3A_meth">meth</code></td>
<td>
<p> method for approximating the predictive model <code class="reqn">P(D|X=x)</code>. The options are:
</p>

<ul>
<li> <p><b>&ldquo;L&rdquo;,</b> for proportional hazards regression models taking into account the observation intervals (see Details).
</p>
</li>
<li> <p><b>&ldquo;S&rdquo;,</b> for proportional hazards regression models <b>without</b> taking into account the observation intervals (see Details).
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> If <code>meth</code> = <b>&ldquo;L&rdquo;</b>, the event times are assumed to come from a Cox proportional hazards regression model and the predictive model is estimated as indicated in
<a href="https://doi.org/10.1080/00949655.2020.1736071">doi:10.1080/00949655.2020.1736071</a>.
</p>
<p style="text-align: center;"><code class="reqn"> P (T \leq t \;|\; X=x) = \frac{S(U|x) - S(t|x) }{S(U|x) - S(V|x)},</code>
</p>
<p> where <code class="reqn">U = \min{\{t, L\}}</code> and <code class="reqn">V = \max {\{t, R\}}</code>, being L and R the random variables that stand for the edges of the observable interval containing the event time.
</p>
</li>
<li><p> If <code>meth</code> = <b>&ldquo;S&rdquo;</b>, the approximation is done by </p>
<p style="text-align: center;"><code class="reqn">P (T\leq t \;|\; X=x) = 1 - S(t|x),</code>
</p>
<p> being <code class="reqn">S(\cdot)</code> the survival function at time <b>t</b> given the marker value, estimated through a proportional hazard model for interval censored data according to <a href="https://doi.org/10.2307/2530698">doi:10.2307/2530698</a>.
</p>
</li></ul>



<h3>Value</h3>

<p>The returned value is a list with three components:
</p>
<table>
<tr><td><code>marker</code></td>
<td>
<p>vector containing the ordered marker values.
</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>vector with the probabilities corresponding to each marker value estimated through the predictive model.
</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>vector with the condition of the subjects as positive, negative or censored at the considered time <code>time</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>sMS_timeic</code> and <code>sMSROC</code>
</p>

<hr>
<h2 id='pred_model_timerc-internal'>Predictive model in prognosis scenarios (II)</h2><span id='topic+pred_model_timerc'></span>

<h3>Description</h3>

<p>Estimation of the predictive model in prognosis scenarios under right censorship.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_model_timerc(marker, status, observed.time, outcome, time, meth)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_model_timerc-internal_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.</p>
</td></tr>
<tr><td><code id="pred_model_timerc-internal_+3A_status">status</code></td>
<td>
<p>numeric response vector. The highest value is assumed to stand for the subjects having the event under study. The lowest value, for those who do not. Any other value will not be considered.
</p>
</td></tr>
<tr><td><code id="pred_model_timerc-internal_+3A_observed.time">observed.time</code></td>
<td>
<p> vector with the observed times for each subject. Notice that these values may be the event times or the censoring times.</p>
</td></tr>
<tr><td><code id="pred_model_timerc-internal_+3A_outcome">outcome</code></td>
<td>
<p>vector with the status of the subjects as positive, negative or censored (unknown) at the considered time <code>time</code>.</p>
</td></tr>
<tr><td><code id="pred_model_timerc-internal_+3A_time">time</code></td>
<td>
<p>point of time at which the sMS ROC curve estimator will be computed.</p>
</td></tr>
<tr><td><code id="pred_model_timerc-internal_+3A_meth">meth</code></td>
<td>
<p>method for approximating the predictive model <code class="reqn">P(D|X=x)</code>. The options are:
</p>

<ul>
<li> <p><b>&ldquo;L&rdquo;,</b> for proportional hazards regression models (see Details).
</p>
</li>
<li> <p><b>&ldquo;S&rdquo;,</b> for smooth models (see Details).
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> If <code>meth</code> = <b>&ldquo;L&rdquo;</b>, the event times are assumed to come from a Cox proportional hazards regression model:
</p>
<p style="text-align: center;"><code class="reqn"> P (T \leq t \;|\; X=x) = 1 - \exp \{ - \Delta_0(t) \cdot \exp \{ \beta_0 + \beta_1 \cdot \log(x)\}\},</code>
</p>
<p> where <code class="reqn">\Delta_0(\cdot)</code> is the baseline hazard function and <code class="reqn">\beta_0, \beta_1 \in {\cal R}</code>.
</p>
</li>
<li><p> If <code>meth</code> = <b>&ldquo;S&rdquo;</b>, the approximation is done by </p>
<p style="text-align: center;"><code class="reqn">P (T\leq t \;|\; X=x) = 1 - \exp \{ - \Delta_0(t) \cdot \exp \{ s(x)\}\} </code>
</p>
<p> being <code class="reqn">s(\cdot)</code> the smooth function (penalized splines, <a href="https://doi.org/10.1111/1467-9868.00125">doi:10.1111/1467-9868.00125</a>).</p>
</li></ul>



<h3>Value</h3>

<p>The returned value is a list with three components:
</p>
<table>
<tr><td><code>marker</code></td>
<td>
<p>vector containing the ordered marker values.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>vector with the probabilities corresponding to each marker value estimated through the predictive model.</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>vector with the status of the subjects as positive, negative or censored at the considered time <code>time</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>sMS_timerc</code> and <code>sMSROC</code>
</p>

<hr>
<h2 id='print.sMSROC'>Print sMSROC
</h2><span id='topic+print.sMSROC'></span>

<h3>Description</h3>

<p>Prints the estimated AUC and the probabilistic model used to compute the predictive model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sMSROC'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.sMSROC_+3A_x">x</code></td>
<td>
<p>object of class <code>sMS</code> returned by the function <code><a href="#topic+sMSROC">sMSROC</a></code>.
</p>
</td></tr>
<tr><td><code id="print.sMSROC_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prints the estimated area under the ROC curve computed through the sMSROC estimator and the probabilistic model used to compute the predictive model.
</p>


<h3>Value</h3>

<p>Printed output in the console containing the information described above.
</p>


<h3>See Also</h3>

<p><code>sMSROC</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(diabet)
roc &lt;- sMSROC(marker=diabet$stab.glu, status=diabet$glyhb, conf.int="T")
print(roc)
</code></pre>

<hr>
<h2 id='probs_pred'>Plot of the predictive model</h2><span id='topic+probs_pred'></span>

<h3>Description</h3>

<p>This function plots the predicted probabilities for each marker value computed through the predictive model together, with 95% pointwise confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probs_pred(sMS, var, nboots, parallel, ncpus)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probs_pred_+3A_sms">sMS</code></td>
<td>
<p>object of class <code>sMS</code> returned from function <code><a href="#topic+sMSROC">sMSROC</a></code>.
</p>
</td></tr>
<tr><td><code id="probs_pred_+3A_var">var</code></td>
<td>
<p>parameter indicating whether 95% pointwise confidence intervals for the predictive model will be plotted (value <b>&quot;T&quot;</b>) or not (value <b>&quot;F&quot;</b>). The default value is &quot;F&quot;.
</p>
</td></tr>
<tr><td><code id="probs_pred_+3A_nboots">nboots</code></td>
<td>
<p>number of bootstrap samples to be generated for computing the pointwise confidence intervals. The default value is 500.
</p>
</td></tr>
<tr><td><code id="probs_pred_+3A_parallel">parallel</code></td>
<td>
<p>parameter indicating whether parallel computing will be performed (value <b>&quot;T&quot;</b>) or not (value <b>&quot;F&quot;</b>). The default is &ldquo;F&rdquo;.
</p>
</td></tr>
<tr><td><code id="probs_pred_+3A_ncpus">ncpus</code></td>
<td>
<p>number of CPUS to be used in the case of carrying out parallel computing. The default value is 1 and the maximum is 2.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots the probability function estimation of the predictive model versus the biomaker. It also computes and plots 95% pointwise confidence intervals on the same graphic when the <code>var</code> parameter is set to &quot;T&quot;.
</p>
<p>The variance of the probability estimates, obtained by the predictive model, is computed via bootstrap with <code>nboots</code> samples.
</p>


<h3>Value</h3>

<p>A list with these components:
</p>
<table>
<tr><td><code>plot</code></td>
<td>
<p>object of class <code><a href="rms.html#topic+ggplot">ggplot</a></code> (graphical output).</p>
</td></tr>
<tr><td><code>thres</code></td>
<td>
<p>ordered biomarker values (x-axis coordinates).</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>predicted probabilities (y-axis coordinates).</p>
</td></tr>
<tr><td><code>sd.probs</code></td>
<td>
<p>estimates of the standard deviation of the predicted probabilities.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>pred_model_binout</code>, <code>pred_model_timerc</code> and <code>pred_model_timeic</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ktfs)
DT &lt;- ktfs
roc &lt;- sMSROC(marker = DT$score,
              status = DT$failure,
              observed.time = DT$time,
              time = 5,
              meth = "S")
probs &lt;- probs_pred(sMS = roc)
probs$plot
</code></pre>

<hr>
<h2 id='sMS_binout-internal'>sMS estimator for diagnostic biomarkers</h2><span id='topic+sMS_binout'></span>

<h3>Description</h3>

<p>Wrap function for computing the sMS estimator in diagnosis scenarios.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sMS_binout(marker, status, meth, grid, probs, all)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sMS_binout-internal_+3A_marker">marker</code></td>
<td>
<p> vector with the biomarker values.</p>
</td></tr>
<tr><td><code id="sMS_binout-internal_+3A_status">status</code></td>
<td>
<p> numeric response vector.</p>
</td></tr>
<tr><td><code id="sMS_binout-internal_+3A_meth">meth</code></td>
<td>
<p> method for approximating the predictive model <code class="reqn">P(D|X=x)</code>.
</p>

<ul>
<li> <p><b>&ldquo;E&rdquo;,</b> allocates to each individual their own condition as positive or negative. Those whose condition is unknown at time <code>time</code> are dismissed.
</p>
</li>
<li> <p><b>&ldquo;L&rdquo;,</b> for <b>L</b>inear logistic regression models (see details in <code><a href="#topic+sMSROC">sMSROC</a></code>).
</p>
</li>
<li> <p><b>&ldquo;S&rdquo;,</b> for <b>S</b>mooth models (see details <code><a href="#topic+sMSROC">sMSROC</a></code>).</p>
</li></ul>

</td></tr>
<tr><td><code id="sMS_binout-internal_+3A_grid">grid</code></td>
<td>
<p> grid size.
</p>
</td></tr>
<tr><td><code id="sMS_binout-internal_+3A_probs">probs</code></td>
<td>
<p>vector with the probabilities from the predictive model when it is manually entered.
</p>
</td></tr>
<tr><td><code id="sMS_binout-internal_+3A_all">all</code></td>
<td>
<p>parameter indicating whether all probabilities given by the predictive model should be considered (value <b>&ldquo;T&rdquo;</b>) or just those corresponding to individuals whose condition as positive or negative is unknown (<b>&ldquo;F&rdquo;</b>). The default value is (<b>&ldquo;T&rdquo;</b>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The function obtains the probabilities corresponding to the predictive model (first stage of the sMS ROC curve estimator). If they were not manually entered, the functions <code>pred.mod.emp</code> or <code>pred.mod.binout</code> are called depending on the chosen <code>meth</code>. Then, it calls the function <code>computeROC</code> to compute the weighted empirical ROC curve estimator (second stage).</p>


<h3>Value</h3>

<p> The returned value is a list with the following components:
</p>
<table>
<tr><td><code>SE</code></td>
<td>
<p> vector with the weighted empirical estimator of the sensitivity.</p>
</td></tr>
<tr><td><code>SP</code></td>
<td>
<p> vector with the weighted empirical estimator of the specificity.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p> vector containing the points between 0 and 1 at which the ROC curve estimator will be computed. Its size is determined by the <code>grid</code> parameter.</p>
</td></tr>
<tr><td><code>ROC</code></td>
<td>
<p> ROC curve approximated at each point of the vector <code>u</code>.</p>
</td></tr>
<tr><td><code>auc</code></td>
<td>
<p> area under the weighted empirical ROC curve estimator.</p>
</td></tr>
<tr><td><code>marker</code></td>
<td>
<p> vector with the ordered biomarker values.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p> vector with the probabilities of the predictive model corresponding to each biomarker value.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>pred_mod_emp</code>, <code>pred_mod_binout</code>,
<code>computeROC</code>, <code>sMS_timerc</code> and <code>sMS_timeic</code>
</p>

<hr>
<h2 id='sMS_timeic-internal'>sMS estimator for prognostic biomarkers and interval censoring</h2><span id='topic+sMS_timeic'></span>

<h3>Description</h3>

<p>Wrap function for computing the sMS estimator in prognosis scenarios under interval censorship.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sMS_timeic(marker, left, right, outcome, time, meth, grid, probs, all)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sMS_timeic-internal_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.</p>
</td></tr>
<tr><td><code id="sMS_timeic-internal_+3A_left">left</code></td>
<td>
<p>vector containing the lower edges of the observed intervals.</p>
</td></tr>
<tr><td><code id="sMS_timeic-internal_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals. The infinity is admissible as value (indicated as <strong>inf</strong>).</p>
</td></tr>
<tr><td><code id="sMS_timeic-internal_+3A_outcome">outcome</code></td>
<td>
<p> vector containing the condition of the individuals as positive, negative or censored at the time <code>time</code>.</p>
</td></tr>
<tr><td><code id="sMS_timeic-internal_+3A_time">time</code></td>
<td>
<p>point of time at which the sMSROC curve estimator will be computed.</p>
</td></tr>
<tr><td><code id="sMS_timeic-internal_+3A_meth">meth</code></td>
<td>
<p>method for approximating the predictive model <code class="reqn">P(D|X=x)</code>.
</p>

<ul>
<li> <p><b>&ldquo;E&rdquo;,</b> allocates to each individual their own condition as positive or negative. Those whose condition is unknown at time <code>time</code> are dismissed.
</p>
</li>
<li> <p><b>&ldquo;L&rdquo;,</b> for proportional hazards regression models taking into account the observation intervals (see Details <code><a href="#topic+sMSROC">sMSROC</a></code>).
</p>
</li>
<li> <p><b>&ldquo;S&rdquo;,</b> for proportional hazards regression models <b>without</b> taking into account the observation intervals (see Details <code><a href="#topic+sMSROC">sMSROC</a></code>).
</p>
</li></ul>

</td></tr>
<tr><td><code id="sMS_timeic-internal_+3A_grid">grid</code></td>
<td>
<p>grid size.</p>
</td></tr>
<tr><td><code id="sMS_timeic-internal_+3A_probs">probs</code></td>
<td>
<p>vector with the probabilities from the predictive model when it is manually entered.</p>
</td></tr>
<tr><td><code id="sMS_timeic-internal_+3A_all">all</code></td>
<td>
<p>parameter indicating whether all probabilities given by the predictive model should be considered (value <b>&ldquo;T&rdquo;</b>) or just those corresponding to individuals whose condition as positive or negative is unknown (<b>&ldquo;F&rdquo;</b>). The default value is (<b>&ldquo;T&rdquo;</b>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function gets the probabilities corresponding to the predictive model (first stage of the sMS ROC curve estimator). If they were not manually entered, the functions <code>pred.mod.emp</code> or <code>pred.mod.timeic</code> are called depending on the chosen <code>meth</code>. Then, it calls the function <code>computeROC</code> to compute the weighted empirical ROC curve estimator (second stage).</p>


<h3>Value</h3>

<p>The returned value is a list with the following components:
</p>
<table>
<tr><td><code>SE</code></td>
<td>
<p>vector with the weighted empirical estimator of the sensitivity.</p>
</td></tr>
<tr><td><code>SP</code></td>
<td>
<p>vector with the weighted empirical estimator of the specificity.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>vector containing the points between 0 and 1 at which the ROC curve estimator will be computed. Its size is determined by the <code>grid</code> parameter.</p>
</td></tr>
<tr><td><code>ROC</code></td>
<td>
<p>ROC curve approximated at each point of the vector <code>u</code>.</p>
</td></tr>
<tr><td><code>auc</code></td>
<td>
<p>area under the weighted empirical ROC curve estimator.</p>
</td></tr>
<tr><td><code>marker</code></td>
<td>
<p>vector with the ordered biomarker values.</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p>vector with the condition of the individuals at time <code>time</code> as positive, negative or unknown.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>vector with the probabilities of the predictive model corresponding to each biomarker value.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>pred.mod.emp</code>, <code>pred.mod.binout</code>,
<code>computeROC</code>, <code>sMS.binout</code> and <code>sMS.timerc</code>
</p>

<hr>
<h2 id='sMS_timerc'>sMS estimator for prognostic biomarkers and right censorship</h2><span id='topic+sMS_timerc'></span>

<h3>Description</h3>

<p>Wrap function for computing the sMS estimator in prognosis scenarios under right censorship.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sMS_timerc(marker, status, observed.time, outcome, time,
           meth, grid, probs, all)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sMS_timerc_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.</p>
</td></tr>
<tr><td><code id="sMS_timerc_+3A_status">status</code></td>
<td>
<p>numeric response vector.</p>
</td></tr>
<tr><td><code id="sMS_timerc_+3A_observed.time">observed.time</code></td>
<td>
<p>vector with the observed times. These values may be the event times or the censoring times.</p>
</td></tr>
<tr><td><code id="sMS_timerc_+3A_outcome">outcome</code></td>
<td>
<p>vector containing the condition of the individuals as positive, negative or censored (unknown) at the time <code>time</code>.</p>
</td></tr>
<tr><td><code id="sMS_timerc_+3A_time">time</code></td>
<td>
<p>point of time at which the sMSROC curve estimator will be computed.</p>
</td></tr>
<tr><td><code id="sMS_timerc_+3A_meth">meth</code></td>
<td>
<p> method for approximating the predictive model <code class="reqn">P(D|X=x)</code>.
</p>

<ul>
<li> <p><b>&ldquo;E&rdquo;,</b> allocates to each individual their own condition as positive or negative. Those whose condition is unknown at time <code>time</code> are dismissed.
</p>
</li>
<li> <p><b>&ldquo;L&rdquo;,</b> for <b>L</b>inear proportional hazards regression models (see details in <code><a href="#topic+sMSROC">sMSROC</a></code>).
</p>
</li>
<li> <p><b>&ldquo;S&rdquo;,</b> for <b>S</b>mooth models (see details in <code><a href="#topic+sMSROC">sMSROC</a></code>).
</p>
</li></ul>

</td></tr>
<tr><td><code id="sMS_timerc_+3A_grid">grid</code></td>
<td>
<p>grid size.
</p>
</td></tr>
<tr><td><code id="sMS_timerc_+3A_probs">probs</code></td>
<td>
<p>vector with the probabilities from the predictive model when it is manually entered.
</p>
</td></tr>
<tr><td><code id="sMS_timerc_+3A_all">all</code></td>
<td>
<p>parameter indicating whether all probabilities given by the predictive model should be considered (value <b>&ldquo;T&rdquo;</b>) or just those corresponding to individuals whose condition as positive or negative is unknown (<b>&ldquo;F&rdquo;</b>). The default value is (<b>&ldquo;T&rdquo;</b>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> This function gets the probabilities corresponding to the predictive model (first stage of the sMS ROC curve estimator). If they were not manually entered, the functions <code>pred.mod.emp</code> or <code>pred.mod.timerc</code> are called depending on the chosen <strong>meth</strong>. Then, it calls the function <code>computeROC</code> to compute the weighted empirical ROC curve estimator (second stage).</p>


<h3>Value</h3>

<p> The returned value is a list with the following components:
</p>
<table>
<tr><td><code>SE</code></td>
<td>
<p> vector with the weighted empirical estimator of the sensitivity.</p>
</td></tr>
<tr><td><code>SP</code></td>
<td>
<p> vector with the weighted empirical estimator of the specificity.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p> vector containing the points between 0 and 1 at which the ROC curve estimator will be computed. Its size is determined by the <code>grid</code> parameter.</p>
</td></tr>
<tr><td><code>ROC</code></td>
<td>
<p> ROC curve approximated at each point of the vector <code>u</code>.</p>
</td></tr>
<tr><td><code>auc</code></td>
<td>
<p> area under the weighted empirical ROC curve estimator.</p>
</td></tr>
<tr><td><code>marker</code></td>
<td>
<p> vector with the ordered biomarker values.</p>
</td></tr>
<tr><td><code>outcome</code></td>
<td>
<p> vector with the condition of the individuals at time <code>time</code> as positive, negative or cenrored (unknown).</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p> vector with the probabilities of the predictive model corresponding to each biomarker value.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>pred.mod.emp</code>, <code>pred.mod.binout</code>,
<code>computeROC</code>, <code>sMS.timerc</code>, <code>sMS.timeic</code>
</p>

<hr>
<h2 id='sMSROC'>sMS ROC curve estimator computation</h2><span id='topic+sMSROC'></span>

<h3>Description</h3>

<p>Core function for computing the sMS ROC estimator which fits the estimation of the ROC curve when the outcome of interest is time-dependent (<b>prognosis</b> scenarios) and when it is not (<b>diagnosis</b> scenarios).</p>


<h3>Usage</h3>

<pre><code class='language-R'>sMSROC(marker, status, observed.time, left, right, time,
       meth, grid, probs, sd.probs,
       conf.int, ci.cl, ci.meth, ci.nboots, parallel, ncpus, all)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sMSROC_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_status">status</code></td>
<td>
<p>numeric response vector. The highest value is assumed to stand for the subjects having the event under study. The lowest one, for those who do not. Any other value will not be considered. It is a mandatory parameter in diagnosis scenarios.</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_observed.time">observed.time</code></td>
<td>
<p>vector with the observed times for each subject, for prognosis scenarios under right censorship. Notice that these values may be the event times or the censoring times.</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_left">left</code></td>
<td>
<p>vector containing the lower edges of the observed intervals. It is mandatory in prognosis scenarios under interval censorship and ignored in other situations.</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals. It is mandatory in prognosis scenarios under interval censorship and ignored in other situations. The infinity is admissible as value (indicated as <b>inf</b>).</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_time">time</code></td>
<td>
<p> point of time at which the sMS ROC curve estimator will be computed. The default value is 1.</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_meth">meth</code></td>
<td>
<p> method for approximating the predictive model <code class="reqn">P(D|X=x)</code>. There are several options available:
</p>

<ul>
<li> <p><b>&ldquo;E&rdquo;,</b> allocates to each individual their own condition as positive or negative. Those whose condition is unknown at time <code>time</code> are dismissed.
</p>
</li>
<li> <p><b>&ldquo;L&rdquo;,</b> for <b>L</b>inear logistic regression and proportional hazards regression models (see Details).
</p>
</li>
<li> <p><b>&ldquo;S&rdquo;,</b> for <b>S</b>mooth models (see Details).
</p>
</li></ul>

</td></tr>
<tr><td><code id="sMSROC_+3A_probs">probs</code></td>
<td>
<p> vector containing the probabilities corresponding to the predictive model when it has been externally computed. Only values within [0,1] are admissible.</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_sd.probs">sd.probs</code></td>
<td>
<p> vector with the standard deviations of the probabilities entered in <code>probs</code>. It is an optional parameter.</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_grid">grid</code></td>
<td>
<p>grid size for computing the AUC. Default value 1000.</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_conf.int">conf.int</code></td>
<td>
<p>indicates whethet a conficence interval for the AUC will be computed (<b>&ldquo;T&rdquo;</b>) or not (<b>&ldquo;F&rdquo;</b>). The default value is (<b>&ldquo;F&rdquo;</b>).</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_ci.cl">ci.cl</code></td>
<td>
<p>confidence level at which the confidence interval for the AUC will be provided. The default value is 95%. This parameter is ignored when <code>conf.int</code> is set to <b>&ldquo;F&rdquo;</b>.
</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_ci.meth">ci.meth</code></td>
<td>
<p>method for computing the confidence interval for the AUC. There are three options:
</p>

<ul>
<li> <p><b>&ldquo;E&rdquo;</b>, for the <b>E</b>mpirical variance estimation.
</p>
</li>
<li> <p><b>&ldquo;V&rdquo;</b>, for the theoretical <b>V</b>ariance estimation.
</p>
</li>
<li> <p><b>&ldquo;B&rdquo;</b>, for the <b>B</b>ootstrap percentile approximation.
</p>
<p>The empirical method <b>E</b> is taken as default value and the parameter is ignored too when <code>ci.cl</code> value is <b>&ldquo;F&rdquo;</b>.
</p>
</li></ul>

</td></tr>
<tr><td><code id="sMSROC_+3A_ci.nboots">ci.nboots</code></td>
<td>
<p>number of boostrap samples to be run when <b>B</b>oostrap is set as <code>ci.meth</code> parameter. The default value is 500 and it is not taken into account when no confidence interval is computed.</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_parallel">parallel</code></td>
<td>
<p>indicates whether parallel computing will be done (<b>&ldquo;T&rdquo;</b>) or not (<b>&ldquo;F&rdquo;</b>) when computing the variance of the AUC through the methods <b>&ldquo;V&rdquo;</b> and <b>&ldquo;B&rdquo;</b>.
</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_ncpus">ncpus</code></td>
<td>
<p>number of CPUS that will be used when parallel computing is chosen. The default value is 1 and the maximum is 2.
</p>
</td></tr>
<tr><td><code id="sMSROC_+3A_all">all</code></td>
<td>
<p>parameter indicating whether all probabilities given by the predictive model should be considered (value <b>&ldquo;T&rdquo;</b>) or just those corresponding to individuals whose condition as positive or negative is unknown (<b>&ldquo;F&rdquo;</b>). The default value is (<b>&ldquo;T&rdquo;</b>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Two-stages mixed-subjects (sMSROC) ROC curve estimator links diagnosis and prognosis scenarios through a general predictive model (first
stage) and the weighted empirical estimator of the cumulative distribution function of the biomarker
(second stage).
</p>
<p>The predictive model <code class="reqn">P(D|X=x)</code> depicts the relationship between the biomarker and the binary response variable. It is approximated through the most suitable probabilistic model.
</p>
<p>For <b>diagnosis</b> scenarios:
</p>

<ul>
<li><p> If <code>meth</code> = <b>&ldquo;L&rdquo;</b>, the logit transformation of the predicitive model is approximated by a linear logistic regression model:
</p>
<p style="text-align: center;"><code class="reqn">P (D|X=x) = 1/(1 + \exp{- \{ \beta_0 + \beta_1 x \}),}</code>
</p>

<p>with <code class="reqn">\beta_0, \beta_1 \in {\cal R}</code>.
</p>
</li>
<li><p> If <code>meth</code> = <b>&ldquo;S&rdquo;</b>, the logit transformation of the predicitive model is estimated by the smooth logistic regression,
</p>
<p style="text-align: center;"><code class="reqn"> P(D | X=x) = 1 / ( 1 + \exp \{ - s(x) \}),</code>
</p>
<p> being <code class="reqn">s(\cdot)</code> the smooth function (splines, <a href="https://doi.org/10.1002/sim.4780080504">doi:10.1002/sim.4780080504</a>).
</p>
</li></ul>

<p>Notice that the predictive model allows to compute the probability of being positive/negative even when the actual belonging group is unknown.
</p>
<p>For <b>prognosis</b> scenarios and right censorship:
</p>

<ul>
<li><p> If <code>meth</code> = <b>&ldquo;L&rdquo;</b>, the event times are assumed to come from a Cox proportional hazards regression model:
</p>
<p style="text-align: center;"><code class="reqn"> P (T \leq t \;|\; X=x) = 1 - \exp \{ - \Delta_0(t) \cdot \exp \{ \beta_0 + \beta_1 \cdot \log(x)\}\},</code>
</p>
<p> where <code class="reqn">\Delta_0(\cdot)</code> is the baseline hazard function and <code class="reqn">\beta_0, \beta_1 \in {\cal R}</code>.
</p>
</li>
<li><p> If <code>meth</code> = <b>&ldquo;S&rdquo;</b>, the approximation is done by </p>
<p style="text-align: center;"><code class="reqn">P (T\leq t \;|\; X=x) = 1 - \exp \{ - \Delta_0(t) \cdot \exp \{ s(x)\}\} </code>
</p>
<p> being <code class="reqn">s(\cdot)</code> the smooth function (penalized splines, <a href="https://doi.org/10.1111/1467-9868.00125">doi:10.1111/1467-9868.00125</a>).</p>
</li></ul>

<p>Finally, for <b>prognosis</b> scenarios and interval censorship:
</p>

<ul>
<li><p>If <code>meth</code> = <b>&ldquo;L&rdquo;</b>, the event times are assumed to come from a Cox proportional hazards regression model and the predictive model is estimated as indicated in <a href="https://doi.org/10.1080/00949655.2020.1736071">doi:10.1080/00949655.2020.1736071</a>.
</p>
<p style="text-align: center;"><code class="reqn"> P (T \leq t \;|\; X=x) = \frac{S(U|x) - S(t|x) }{S(U|x) - S(V|x)},</code>
</p>
<p> where <code class="reqn">U = \min{\{t, L\}}</code> and <code class="reqn">V = \max {\{t, R\}}</code>, being L and R the random variables that stand for the edges of the observable interval containing the event time.

</p>
</li>
<li><p>If <code>meth</code> = <b>&ldquo;S&rdquo;</b>, the approximation is done by </p>
<p style="text-align: center;"><code class="reqn">P (T\leq t \;|\; X=x) = 1 - S(t|x),</code>
</p>
<p> being <code class="reqn">S(\cdot)</code> the survival function at time <b>t</b> given the marker value, estimated through a proportional hazard model for interval censored data according to <a href="https://doi.org/10.2307/2530698">doi:10.2307/2530698</a>.

</p>
</li></ul>

<p>The confidence intervals for the AUC can be computed in three different ways according to parameter <code>ci.meth</code>. When it is set to <b>&quot;E&quot;</b> the variance of the AUC is estimated by the empirical
procedure and when the chosen option is <b>&quot;V&quot;</b>, the theoretical approximation is used (see <a href="https://doi.org/10.1515/ijb-2019-0097">doi:10.1515/ijb-2019-0097</a>). The third option in by using the Bootstrap percentile.
</p>


<h3>Value</h3>

<p>The ouput is an objetc of class <code>sMSROC</code> with the following components:
</p>
<table>
<tr><td><code>thres</code></td>
<td>
<p>vector containing the biomarker values for which sensitivity and specificity were computed.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>vector with the estimates of the sensitivity.</p>
</td></tr>
<tr><td><code>SP</code></td>
<td>
<p>vector with the estimates of the specificity.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>vector with the probabilities corresponding to the predictive model.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>vector containing the points between 0 and 1 at which the ROC curve estimator will be computed. Its size is determined by the <code>grid</code> parameter.</p>
</td></tr>
<tr><td><code>ROC</code></td>
<td>
<p>ROC curve approximated at each point of the vector <code>u</code>.</p>
</td></tr>
<tr><td><code>auc</code></td>
<td>
<p> area under sMSROC curve estimator.</p>
</td></tr>
<tr><td><code>auc.ci.l</code></td>
<td>
<p>lower edge of the confidence interval for the AUC.</p>
</td></tr>
<tr><td><code>auc.ci.u</code></td>
<td>
<p>upper edge of the confidence interval for the AUC.</p>
</td></tr>
<tr><td><code>ci.cl</code></td>
<td>
<p>confidence level at which the confidence interval for the AUC were computed.</p>
</td></tr>
<tr><td><code>ci.meth</code></td>
<td>
<p>method chosen for computing the confidence interval for the AUC.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>point of time at which the sMS ROC curve estimator was computed in prognosis scenarios.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>list contaning several parameters used in the internal functions, when applicable:
</p>

<ul>
<li><p> data_type - type of scenario handled (diagnosis/prognosis, under right or interval censorship).
</p>
</li>
<li><p> grid - grid size.
</p>
</li>
<li><p> marker - vector with the biomarker values.
</p>
</li>
<li><p> outcome  - vector with the condition of the individuals at time <code>time</code> as positive, negative or unknown.
</p>
</li>
<li><p> ncpus - CPUs used if parallel computing was performed.
</p>
</li>
<li><p> ci.nboots - number of bootstrap samples generated for computing the confidence intervals for the AUC.
</p>
</li>
<li><p> parallel - was parallel computing performed?
</p>
</li>
<li><p> meth - method used to compute the predictive model.
</p>
</li>
<li><p> status - response vector.
</p>
</li>
<li><p> observed.time - vector with the observed times for each subject.
</p>
</li>
<li><p> left - vector with the lower edges of the observed intervals.
</p>
</li>
<li><p> right - vector with the upper edges of the observed intervals.
</p>
</li></ul>

</td></tr>
<tr><td><code>message</code></td>
<td>
<p>table containing the warning messages generated during the execution of the function.</p>
</td></tr>
</table>


<h3>References</h3>

<p>S. Díaz-Coto, P. Martínez-Camblor, and N. O. Corral-Blanco. Cumulative/dynamic ROC curve
estimation under interval censorship. Journal of Statistical Computation and Simulation, 90(9):1570–
1590, 2020. <a href="https://doi.org/10.1080/00949655.2020.1736071">doi:10.1080/00949655.2020.1736071</a>.

</p>

<p>S. Díaz-Coto, N. O. Corral-Blanco, and P. Martínez-Camblor. Two-stage receiver operating-characteristic
curve estimator for cohort studies. The International Journal of Biostatistics, 17:117–137, 2021. <a href="https://doi.org/10.1515/ijb-2019-0097">doi:10.1515/ijb-2019-0097</a>.

</p>
<p>Finkelstein, Dianne M. A Proportional Hazards Model for Interval-Censored Failure Time Data. Biometrics 42, no. 4 (1986): 845–54. <a href="https://doi.org/10.2307/2530698">doi:10.2307/2530698</a>.

</p>
<p>Durrleman S, Simon R. Flexible regression models with cubic splines. Statistics in Medicine 1989; 8(5): 551-561.<a href="https://doi.org/10.1002/sim.4780080504">doi:10.1002/sim.4780080504</a>

</p>
<p>Hurvich C, Simonoff J, Tsai CL. Smoothing parameter selection in nonparametric regression using an improved Akaike 1998. J.R. Statist. Soc. 60 271-293. <a href="https://doi.org/10.1111/1467-9868.00125">doi:10.1111/1467-9868.00125</a>

</p>
<p>B. Efron and R. J. Tibshirani. An Introduction to the Bootstrap. CRC press, 1994.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ktfs)
DT &lt;- ktfs
sROC &lt;- sMSROC(marker = DT$score, status = DT$failure,
               observed.time = DT$time, time = 5, meth = "L", conf.int = "T",
               ci.cl =0.90, ci.meth = "E")
</code></pre>

<hr>
<h2 id='sMSROC_plot'>Plot of the sMS ROC curve estimate
</h2><span id='topic+sMSROC_plot'></span>

<h3>Description</h3>

<p>Provides informative plots of the sMS ROC curve estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sMSROC_plot(sMS, m.value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sMSROC_plot_+3A_sms">sMS</code></td>
<td>
<p>object of class <code>sMS</code> returned from function <code><a href="#topic+sMSROC">sMSROC</a></code>.
</p>
</td></tr>
<tr><td><code id="sMSROC_plot_+3A_m.value">m.value</code></td>
<td>
<p>marker value. It is an optional parameter that, when indicated, adds over the graphic of the ROC curve, the point which corresponds to that marker value.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function provides two types of graphics:
</p>

<ul>
<li><p>A basic plot approximating the ROC curve by the pairs given by the sequences <b>1 - SP</b> and <b>SE</b>, from the <code>sMSROC</code> object. The layers <code>geom_roc()</code> and <code>roc_style()</code> from the <code><a href="plotROC.html#topic+plotROC">plotROC</a></code> package  were added to this plot, which make possible to take advantage of the functionality of this package.

</p>
</li>
<li><p>A customized graphic of the ROC curve whose class is <code>ggplot</code>, obtained approximating the sequences <b>1 - SP</b> and <b>SE</b>. When te parameter <code>m.value</code> is indicated, the final plot displays over the ROC curve estimate the point that corresponds to the entered value.

</p>
</li></ul>



<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>basic.plot</code></td>
<td>
<p>object that can be used and customized by the tools from the <code><a href="plotROC.html#topic+plotROC">plotROC</a></code>  package.
</p>
</td></tr>
<tr><td><code>roc.plot</code></td>
<td>
<p>object of class  <code>ggplot</code>. Although it is already customized (title, colors, axis labels, ..., etc.) the end-users can make their own changes by adding the corresponding layers, with the available tools from the <code>ggplot2</code> package.
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>sMSROC</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  Example of the use of the plot.sMSROC function
data(ktfs)
DT = ktfs
ROC &lt;- sMSROC(marker = DT$score,
              status = DT$failure,
              observed.time = DT$time,
              time = 5,
              meth = "S")
plot &lt;- sMSROC_plot(sMS = ROC, m.value = 4.2)
plot$basicplot; plot$rocplot
</code></pre>

<hr>
<h2 id='variance_probs-internal'>Variance of the predictive model
</h2><span id='topic+variance_probs'></span>

<h3>Description</h3>

<p>Estimation of the variance of the predictive model by bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variance_probs(marker, outcome, status, observed.time, left, right, time,
               meth, data_type, grid, probs, ci.nboots, parallel, ncpus, all)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variance_probs-internal_+3A_marker">marker</code></td>
<td>
<p>vector with the biomarker values.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_outcome">outcome</code></td>
<td>
<p>vector with the condition of the subjects as positive, negative or unknown at the considered time <code>time</code>.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_status">status</code></td>
<td>
<p>response vector with the outcome values. The highest one is assumed to stand for the subjects having the event under study.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_observed.time">observed.time</code></td>
<td>
<p>vector with the observed times for each subject.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_left">left</code></td>
<td>
<p>vector with the lower edges of the observed intervals.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_right">right</code></td>
<td>
<p>vector with the upper edges of the observed intervals.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_time">time</code></td>
<td>
<p>point of time at which the sMS ROC curve estimator will be computed.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_meth">meth</code></td>
<td>
<p>method for approximating the predictive model <code class="reqn">P(D|X=x)</code>.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_data_type">data_type</code></td>
<td>
<p>scenario handled.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_grid">grid</code></td>
<td>
<p>grid size.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_probs">probs</code></td>
<td>
<p>vector containing the probabilities estimated through to the predictive model.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_ci.nboots">ci.nboots</code></td>
<td>
<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_parallel">parallel</code></td>
<td>
<p>indicates whether parallel computing will be done or not.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_ncpus">ncpus</code></td>
<td>
<p>number of CPUs to use if parallel computing is performed.
</p>
</td></tr>
<tr><td><code id="variance_probs-internal_+3A_all">all</code></td>
<td>
<p>indicates whether the probabilities from the predictive model should be considered or not.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with a single component:
</p>
<table>
<tr><td><code>sd.probs</code></td>
<td>
<p>vector containing the standard deviation of the probabilities of the predictive model.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
