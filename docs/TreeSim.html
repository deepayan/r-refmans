<!DOCTYPE html><html><head><title>Help for package TreeSim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TreeSim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#TreeSim-package'>
<p>TreeSim: Simulating Phylogenetic Trees</p></a></li>
<li><a href='#corsim'><p>corsim: Simulating the missing speciation events in an incomplete phylogenies.</p></a></li>
<li><a href='#cuttree'>
<p>cuttree: Cutting off the tree to prune recent branches.</p></a></li>
<li><a href='#getx'>
<p>getx: Calculating the vector of speciation / transmission times and sampling times for a phylogenetic tree.</p></a></li>
<li><a href='#LTT.plot'><p>LTT.plot: Plots the lineages through time of a set of phylogenetic trees.</p></a></li>
<li><a href='#LTT.plot.gen'><p>LTT.plot.gen: Calculates the number of lineages through time for each input tree, as well as the average number of lineages over all trees.</p></a></li>
<li><a href='#sim.bd.age'><p>sim.bd.age: Simulating birth-death trees of a fixed age.</p></a></li>
<li><a href='#sim.bd.taxa'><p>sim.bd.taxa: Simulating birth-death trees on a fixed number of extant taxa.</p></a></li>
<li><a href='#sim.bd.taxa.age'><p>sim.bd.taxa.age: Simulating birth-death trees with a given age on a fixed number of extant taxa.</p></a></li>
<li><a href='#sim.bdsky.stt'><p>sim.bdsky.stt: Simulating sequentially sampled birth-death, SIS, SIR or SIRS trees where birth and death rates are changing through time.</p></a></li>
<li><a href='#sim.bdtypes.stt.taxa'><p>sim.bdtypes.stt.taxa: Simulating multitype birth-death trees with a fixed number of tips sampled through time.</p></a></li>
<li><a href='#sim.genespeciestree'><p>sim.genespeciestree: Simulating birth-death species trees with nested coalescent gene trees.</p></a></li>
<li><a href='#sim.genetree'><p>sim.genetree: Simulating coalescent gene trees.</p></a></li>
<li><a href='#sim.gsa.taxa'>
<p>sim.gsa.taxa: Sampling trees on n tips from bigger trees.</p></a></li>
<li><a href='#sim.rateshift.taxa'><p>sim.rateshift.taxa: Simulating trees incorporating mass extinction events and rate shifts.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulating Phylogenetic Trees</td>
</tr>
<tr>
<td>Version:</td>
<td>2.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-03-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Tanja Stadler</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tanja Stadler &lt;tanja.stadler@bsse.ethz.ch&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>ape, geiger</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulation methods for phylogenetic trees where (i) all tips are sampled at one time point or (ii) tips are sampled sequentially through time. (i) For sampling at one time point, simulations are performed under a constant rate birth-death process, conditioned on having a fixed number of final tips (sim.bd.taxa()), or a fixed age (sim.bd.age()), or a fixed age and number of tips (sim.bd.taxa.age()). When conditioning on the number of final tips, the method allows for shifts in rates and mass extinction events during the birth-death process (sim.rateshift.taxa()). The function sim.bd.age() (and sim.rateshift.taxa() without extinction) allow the speciation rate to change in a density-dependent way. The LTT plots of the simulations can be displayed using LTT.plot(), LTT.plot.gen() and LTT.average.root(). TreeSim further samples trees with n final tips from a set of trees generated by the common sampling algorithm stopping when a fixed number m&gt;&gt;n of tips is first reached (sim.gsa.taxa()). This latter method is appropriate for m-tip trees generated under a big class of models (details in the sim.gsa.taxa() man page). For incomplete phylogeny, the missing speciation events can be added through simulations (corsim()). (ii) sim.rateshifts.taxa() is generalized to sim.bdsky.stt() for serially sampled trees, where the trees are conditioned on either the number of sampled tips or the age. Furthermore, for a multitype-branching process with sequential sampling, trees on a fixed number of tips can be simulated using sim.bdtypes.stt.taxa(). This function further allows to simulate under epidemiological models with an exposed class. The function sim.genespeciestree() simulates coalescent gene trees within birth-death species trees, and sim.genetree() simulates coalescent gene trees.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-08 11:16:27 UTC; tstadler</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-08 16:52:56 UTC</td>
</tr>
</table>
<hr>
<h2 id='TreeSim-package'>
TreeSim: Simulating Phylogenetic Trees</h2><span id='topic+TreeSim-package'></span><span id='topic+TreeSim'></span>

<h3>Description</h3>

<p>Simulation methods for phylogenetic trees where (i) all tips are sampled at one time point or (ii) tips are sampled sequentially through time. (i) For sampling at one time point, simulations are performed under a constant rate birth-death process, conditioned on having a fixed number of final tips (sim.bd.taxa()), or a fixed age (sim.bd.age()), or a fixed age and number of tips (sim.bd.taxa.age()). When conditioning on the number of final tips, the method allows for shifts in rates and mass extinction events during the birth-death process (sim.rateshift.taxa()). The function sim.bd.age() (and sim.rateshift.taxa() without extinction) allow the speciation rate to change in a density-dependent way. The LTT plots of the simulations can be displayed using LTT.plot(), LTT.plot.gen() and LTT.average.root(). TreeSim further samples trees with n final tips from a set of trees generated by the common sampling algorithm stopping when a fixed number m&gt;&gt;n of tips is first reached (sim.gsa.taxa()). This latter method is appropriate for m-tip trees generated under a big class of models (details in the sim.gsa.taxa() man page). For incomplete phylogeny, the missing speciation events can be added through simulations (corsim()). (ii) sim.rateshifts.taxa() is generalized to sim.bdsky.stt() for serially sampled trees, where the trees are conditioned on either the number of sampled tips or the age. Furthermore, for a multitype-branching process with sequential sampling, trees on a fixed number of tips can be simulated using sim.bdtypes.stt.taxa(). This function further allows to simulate under epidemiological models with an exposed class. The function sim.genespeciestree() simulates coalescent gene trees within birth-death species trees, and sim.genetree() simulates coalescent gene trees.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> TreeSim</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-03-08</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2  </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Tanja Stadler
&lt;http://www.bsse.ethz.ch/cEvo&gt;
</p>


<h3>References</h3>

<p>T. Stadler. Simulating trees on a fixed number of extant species. Syst. Biol., 60: 676-684, 2011.</p>


<h3>See Also</h3>

<p><code>ape</code>
<code>geiger</code>
</p>

<hr>
<h2 id='corsim'>corsim: Simulating the missing speciation events in an incomplete phylogenies.</h2><span id='topic+corsim'></span>

<h3>Description</h3>

<p>corsim simulates the missing speciation event in an incomplete phylogeny assuming a constant speciation and extinction rate. These rates can be estimated with the functions bd.shifts.optim (if random speciation events are missing) and bd.groups.optim (if only young speciation events are missing) provided in TreePar. corsim allows to specify an upper and lower bound for the times of the missing speciation events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corsim(x,lambda,mu,missing,told=0,tyoung=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corsim_+3A_x">x</code></td>
<td>
<p>Vector of the speciation times in the incomplete phylogeny (where time is measured such that 0 is the present and increasing going into the past).</p>
</td></tr>
<tr><td><code id="corsim_+3A_lambda">lambda</code></td>
<td>
<p>Speciation rate.</p>
</td></tr>
<tr><td><code id="corsim_+3A_mu">mu</code></td>
<td>
<p>Extincion rate.</p>
</td></tr>
<tr><td><code id="corsim_+3A_missing">missing</code></td>
<td>
<p>Number of missing species (i.e. missing speciation events).</p>
</td></tr>
<tr><td><code id="corsim_+3A_told">told</code></td>
<td>
<p>Upper bound for the time of missing speciation events. Default is 0 which means no upper bound.</p>
</td></tr>
<tr><td><code id="corsim_+3A_tyoung">tyoung</code></td>
<td>
<p>Lower bound for the time of missing speciation events. Default is 0 which means no lower bound. tyoung&lt;told unless tyoung=told=0 is required.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>Vector of speciation times: input and simulated speciation times.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tanja Stadler </p>


<h3>References</h3>

<p>N. Cusimano, T. Stadler, S. Renner. A new method for handling missing species in diversification analysis applicable to randomly or non-randomly sampled phylogenies. Syst. Biol., 61(5): 785-792, 2012.
</p>


<h3>See Also</h3>

<p> sim.bd.age, sim.rateshift.taxa, sim.gsa.taxa, birthdeath.tree </p>


<h3>Examples</h3>

<pre><code class='language-R'># Speciation times of a tree with five species:
x&lt;-c(1,1.5,3,5)
# We simulate using the following parameters:
lambda&lt;-2
mu&lt;-1
tyoung&lt;-0.5
told&lt;-4.5
# We simulate 5 additional speciation times (i.e. five additional species):
missing&lt;-5

# xcompleted is x plus 5 additional speciation events between 0.5 and 4.5 timesteps 
# in the past. xcompleted corresponds to a 10-species tree:
xcompleted&lt;-corsim(x,lambda,mu,missing,told,tyoung)
</code></pre>

<hr>
<h2 id='cuttree'>
cuttree: Cutting off the tree to prune recent branches.
</h2><span id='topic+cuttree'></span>

<h3>Description</h3>

<p>cuttree takes as input a tree and a cuttime, and then prunes all lineages more recent than cuttime.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cuttree(tree,cuttime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cuttree_+3A_tree">tree</code></td>
<td>

<p>Phylogenetic tree.
</p>
</td></tr>
<tr><td><code id="cuttree_+3A_cuttime">cuttime</code></td>
<td>
<p>Time before present at which all descendent lineages are deleted. Value between 0 (the present i.e. nothing is deleted) and the age of the tree (i.e. the whole tree is deleted).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>tree</code></td>
<td>
<p>Tree where all branches more recent than cuttime are pruned from the input tree.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tanja Stadler 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-10
lambda &lt;- 2.0
mu &lt;- 0.5
frac &lt;-0.6
numbsim&lt;-2
age&lt;-2

##
# Simulating numbsim reconstructed trees with n sampled species under a
# birth-death process with speciation rate lambda, extinction rate mu,
# sampling probability frac, and time age since origin:

trees&lt;-sim.bd.taxa.age(n, numbsim, lambda, mu, frac, age, mrca = FALSE)

treec&lt;-cuttree(trees[[1]],0.3)

plot(trees[[1]])
plot(treec)
</code></pre>

<hr>
<h2 id='getx'>
getx: Calculating the vector of speciation / transmission times and sampling times for a phylogenetic tree.</h2><span id='topic+getx'></span>

<h3>Description</h3>

<p>getx calculates the vector of branching (speciation / transmission) times and sampling times for a phylogenetic tree (which may have polytomies). This vector is the input for the TreePar methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getx(datatree,sersampling)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getx_+3A_datatree">datatree</code></td>
<td>

<p>Phylogenetic tree.
</p>
</td></tr>
<tr><td><code id="getx_+3A_sersampling">sersampling</code></td>
<td>
<p>Set sersampling = 0 if all tips are from one timepoint; 1 otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>Vector of branching times where 0 is the present and time increasing into the past; If sersampling = 1: Vector of branching and tip sampling times. Second column indicates for each time if branching event (1) or tip (0).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tanja Stadler 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### tree with tips sampled at one timepoint
n&lt;-10
lambda &lt;- 2.0
mu &lt;- 0.5
frac &lt;-0.6
numbsim&lt;-1
trees&lt;-sim.bd.taxa(n, numbsim, lambda, mu, frac,complete=FALSE,stochsampling=TRUE)
branching&lt;-getx(trees[[1]])

### tree with tips sampled sequentially through time
set.seed(1)
n&lt;-10
lambda &lt;- c(2,1,2)
mu &lt;- c(1,0.5,1.5)
sampprob &lt;-c(0.5,0.5,0.5)
times&lt;-c(0,1,2)
numbsim&lt;-2
trees&lt;-lapply(rep(n,numbsim),sim.bdsky.stt,lambdasky=lambda,deathsky=mu,
timesky=times,sampprobsky=sampprob,rho=0,timestop=0)
branchingserial&lt;-getx(trees[[1]][[1]],sersampling=1)
</code></pre>

<hr>
<h2 id='LTT.plot'>LTT.plot: Plots the lineages through time of a set of phylogenetic trees.</h2><span id='topic+LTT.plot'></span>

<h3>Description</h3>

<p>LTT.plot plots the lineages through time (LTT) for a set of phylogenetic trees in black (complete or reconstructed; with or without polytomies) together with the average LTT plot in red. The trees may be simulated using any function in TreeSim, or may be empirical trees. The method works for ultrametric and non-ultrametric trees which are binary or have polytomies. NOTE: you probably need to adapt the code such that the plot is pretty for your particular data (range of axes etc).</p>


<h3>Usage</h3>

<pre><code class='language-R'>LTT.plot(trees,width,precalc,bound=10^(-12),timemax,nmax,avg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LTT.plot_+3A_trees">trees</code></td>
<td>
<p>List with one or two entries. First component: list of phylogenetic trees; second component: vector with time of origins (can be empty).</p>
</td></tr>
<tr><td><code id="LTT.plot_+3A_width">width</code></td>
<td>
<p>Width of lines in plot.</p>
</td></tr>
<tr><td><code id="LTT.plot_+3A_precalc">precalc</code></td>
<td>
<p>Default = 0. If = 1, then parse 'LTT.plot.gen(trees)' instead of 'trees' for the input variable 'trees'.</p>
</td></tr>
<tr><td><code id="LTT.plot_+3A_bound">bound</code></td>
<td>
<p>Determines the value by which leaf times may differ in an ultrametric tree. If two tips are further apart than 'bound', they are considered as sequentially sampled tips.</p>
</td></tr>
<tr><td><code id="LTT.plot_+3A_timemax">timemax</code></td>
<td>
<p>Time axis is drawn from present=0 to timemax years in the past.</p>
</td></tr>
<tr><td><code id="LTT.plot_+3A_nmax">nmax</code></td>
<td>
<p>Axis with number of species is drawn from 1 to nmax.</p>
</td></tr>
<tr><td><code id="LTT.plot_+3A_avg">avg</code></td>
<td>
<p>Default=FALSE. If true then the average LTT plot of all individual LTT plots is drawn in red.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tanja Stadler </p>


<h3>References</h3>

<p> T. Stadler. Simulating trees on a fixed number of extant species. Syst. Biol., 60: 676-684, 2011.
</p>


<h3>See Also</h3>

<p>LTT.plot.gen, sim.bd.taxa, sim.bd.age, sim.rateshift.taxa, sim.gsa.taxa, birthdeath.tree </p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulation of a tree of age 10 under the density-dependent model
numbsim&lt;-3
age&lt;-10
lambda&lt;-0.3
mu&lt;-0
K&lt;-40
tree&lt;- sim.bd.age(age,numbsim,lambda,mu,mrca=FALSE,complete=FALSE,K=K)
# Plot of tree
LTT.plot(c(list(tree),list(c(age,age,age))))
#
# Simulation of a tree with 10 tips under the constant rate birth-death model
numbsim&lt;-3
n&lt;-10
lambda&lt;-0.3
mu&lt;-0
tree&lt;- sim.bd.taxa(10,numbsim,lambda,mu,complete=FALSE,stochsampling=TRUE)
# Plot of tree
ages&lt;-c()
for (i in 1:length(tree)){
	ages&lt;-c(ages,tree[[i]]$root.edge+max(getx(tree[[i]])))
}
LTT.plot(c(list(tree),list(ages)),avg=TRUE)
</code></pre>

<hr>
<h2 id='LTT.plot.gen'>LTT.plot.gen: Calculates the number of lineages through time for each input tree, as well as the average number of lineages over all trees.</h2><span id='topic+LTT.plot.gen'></span>

<h3>Description</h3>

<p>LTT.plot.gen calculates the number of lineages through time for each input tree, as well as the average number of lineages over all trees. The trees may be simulated using any function in TreeSim, or may be empirical trees. The method works for ultrametric and non-ultrametric trees which are binary or have polytomies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LTT.plot.gen(trees,bound=10^(-12))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LTT.plot.gen_+3A_trees">trees</code></td>
<td>
<p>List with one or two entries. First component: list of phylogenetic trees; second component: vector with time of origins (can be empty).</p>
</td></tr>
<tr><td><code id="LTT.plot.gen_+3A_bound">bound</code></td>
<td>
<p>Determines the value by which leaf times may differ in an ultrametric tree. If two tips are further apart, they are considered as sequentially sampled tips.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>out[[1]]: First column are the branching times of ALL input trees. Second column is the number of lineages after the branching time. out[[i]]: Equivalent vector as out [[1]], but for tree i-1.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tanja Stadler </p>


<h3>References</h3>

<p> T. Stadler. Simulating trees on a fixed number of extant species. Syst. Biol., 60: 676-684, 2011.
</p>


<h3>See Also</h3>

<p> LTT.plot,sim.bd.taxa, sim.bd.age, sim.rateshift.taxa, sim.gsa.taxa, birthdeath.tree </p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulation of a tree with a mrca at time 10 in the past, 
# under the density-dependent model
numbsim&lt;-10
age&lt;-10
lambda&lt;-0.3
mu&lt;-0.2
K&lt;-40
# You can produce LTT plots as follows. 
# (for now this is un-commented, as some combinations of geiger / TreeSim on certain platforms 
# produce problems. If this is the case for you, please report to tanjs.stadler@bsse.ethz.ch).

</code></pre>

<hr>
<h2 id='sim.bd.age'>sim.bd.age: Simulating birth-death trees of a fixed age.</h2><span id='topic+sim.bd.age'></span>

<h3>Description</h3>

<p>sim.bd.age simulates trees conditioned on (i) the time since origin or (ii) the time since the most recent common ancestor of the extant tips. The method allows for incomplete sampling: only a fixed fraction of all tips is included in the sampled tree. The method assumes constant birth and death rates, or allows for a density-dependent birth rate. If you want to have species-age dependent rates, use sim.age in R package TreeSimGM.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.bd.age(age, numbsim, lambda, mu, frac = 1, mrca = FALSE,
 complete = TRUE, K = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.bd.age_+3A_age">age</code></td>
<td>
<p>Time since origin / most recent common ancestor.</p>
</td></tr>
<tr><td><code id="sim.bd.age_+3A_numbsim">numbsim</code></td>
<td>
<p>Number of trees to simulate.</p>
</td></tr>
<tr><td><code id="sim.bd.age_+3A_lambda">lambda</code></td>
<td>
<p>Speciation rate.</p>
</td></tr>
<tr><td><code id="sim.bd.age_+3A_k">K</code></td>
<td>
<p>If K=0, then lambda is constant. If K&gt;0, density-dependent speciation is assumed, with speciation rate = lambda(1-m/K) when there are m extant species.</p>
</td></tr>
<tr><td><code id="sim.bd.age_+3A_mu">mu</code></td>
<td>
<p>Extinction rate.</p>
</td></tr>
<tr><td><code id="sim.bd.age_+3A_frac">frac</code></td>
<td>
<p>Sampling fraction: The actual number of tips is n/frac, but only n tips are included (incomplete sampling).</p>
</td></tr>  
<tr><td><code id="sim.bd.age_+3A_mrca">mrca</code></td>
<td>
<p>If mrca=FALSE: age is the time since origin. If mrca=TRUE: age is the time since most recent common ancestor of the extant tips.</p>
</td></tr>
<tr><td><code id="sim.bd.age_+3A_complete">complete</code></td>
<td>
<p>If complete = TRUE, the tree with the extinct and non-sampled lineages is returned. If complete = FALSE, the extinct and non-sampled lineages are suppressed.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>treearray</code></td>
<td>
<p>Array of 'numbsim' trees with the time since origin / most recent common ancestor being 'age'. If tree goes extinct or no tips are sampled (only possible when mrca = FALSE), return value is '0'. If only one extant and no extinct tips are sampled, return value is '1'.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tanja Stadler</p>


<h3>References</h3>

<p>T. Stadler. Simulating trees on a fixed number of extant species. Syst. Biol., 60: 676-684, 2011.</p>


<h3>See Also</h3>

<p> sim.bd.taxa, sim.rateshift.taxa, sim.gsa.taxa, birthdeath.tree, sim.age </p>


<h3>Examples</h3>

<pre><code class='language-R'>age&lt;-2
lambda &lt;- 2.0
mu &lt;- 0.5
frac &lt;-0.6
numbsim&lt;-3

##
# Simulating trees with time age since the origin:

sim.bd.age(age,numbsim,lambda,mu,mrca=FALSE,complete=TRUE)


</code></pre>

<hr>
<h2 id='sim.bd.taxa'>sim.bd.taxa: Simulating birth-death trees on a fixed number of extant taxa.</h2><span id='topic+sim.bd.taxa'></span>

<h3>Description</h3>

<p>sim.bd.taxa simulates trees on n species under the constant rate birth-death process. The method allows for incomplete sampling, i.e. (i) only a fixed fraction of all extant tips is included in the sampled tree or (ii) each extant tip from a complete tree is included with a fixed probability. In both cases, the tree is conditioned to have n tips after sampling. If you want to relax the assumption of constant rates, this function will not work. If you want to change rates through time use sim.rateshift.taxa. If you want to have species-age dependent rates, use sim.taxa in R package TreeSimGM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.bd.taxa(n, numbsim, lambda, mu, frac = 1, complete = TRUE,
 stochsampling = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.bd.taxa_+3A_n">n</code></td>
<td>
<p>Number of extant sampled tips.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa_+3A_numbsim">numbsim</code></td>
<td>
<p>Number of trees to simulate.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa_+3A_lambda">lambda</code></td>
<td>
<p>Speciation rate.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa_+3A_mu">mu</code></td>
<td>
<p>Extinction rate.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa_+3A_frac">frac</code></td>
<td>
<p>When complete = FALSE and stochsampling=FALSE: The actual number of tips is n/frac, but only n tips are included (incomplete sampling). When complete = FALSE and stochsampling=TRUE: Each tip is included into the final tree with probability frac. When complete = TRUE: all extinct and non-sampled lineages are included, i.e. the tree has n/frac extant tips.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa_+3A_complete">complete</code></td>
<td>
<p>If TRUE, the tree with the extinct and non-sampled lineages is returned. If FALSE, the extinct lineages are suppressed.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa_+3A_stochsampling">stochsampling</code></td>
<td>
<p>See frac.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>List of numbsim simulated trees with n extant sampled tips.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>For stochsampling = TRUE: The algorithm is fast for the critical process, lambda=mu.
</p>


<h3>Author(s)</h3>

<p>Tanja Stadler </p>


<h3>References</h3>

<p> T. Stadler. Simulating trees on a fixed number of extant species. Syst. Biol., 60: 676-684, 2011.
</p>
<p>T. Stadler. On incomplete sampling under birth-death models and connections to the sampling-based coalescent. Jour. Theo. Biol. 261: 58-66, 2009.</p>


<h3>See Also</h3>

<p> sim.bd.age, sim.rateshift.taxa, sim.gsa.taxa, birthdeath.tree, sim.taxa </p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-10
lambda &lt;- 2.0
mu &lt;- 0.5
frac &lt;-0.6
numbsim&lt;-2

##
# Simulating numbsim trees with n species under a birth-death process with 
# speciation rate lambda an extinction rate mu:

sim.bd.taxa(n,numbsim,lambda,mu)

# Each extant species is included in final tree with probability frac 
# (the tree has n species AFTER sampling):

sim.bd.taxa(n,numbsim,lambda,mu,frac,complete=FALSE,stochsampling=TRUE)

# A fraction frac of the extant species is included into the final tree 
# (the tree has n species AFTER sampling):

sim.bd.taxa(n,numbsim,lambda,mu,frac,complete=FALSE,stochsampling=FALSE)

</code></pre>

<hr>
<h2 id='sim.bd.taxa.age'>sim.bd.taxa.age: Simulating birth-death trees with a given age on a fixed number of extant taxa.</h2><span id='topic+sim.bd.taxa.age'></span>

<h3>Description</h3>

<p>sim.bd.taxa.age simulates trees on n species with a (i) fixed time since origin or (ii) fixed time since the most recent common ancestor of the sampled species under the constant rate birth-death process. The method allows for incomplete sampling, i.e. each extant tip from a complete tree is included with a fixed probability. The tree is conditioned to have n tips after sampling and a fixed time since origin or since the most recent common ancestor of the sampled species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.bd.taxa.age(n, numbsim, lambda, mu, frac = 1, age, mrca = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.bd.taxa.age_+3A_n">n</code></td>
<td>
<p>Number of extant sampled tips.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa.age_+3A_numbsim">numbsim</code></td>
<td>
<p>Number of trees to simulate.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa.age_+3A_lambda">lambda</code></td>
<td>
<p>Speciation rate.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa.age_+3A_mu">mu</code></td>
<td>
<p>Extinction rate.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa.age_+3A_frac">frac</code></td>
<td>
<p> Each tip is included into the final tree with probability frac.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa.age_+3A_age">age</code></td>
<td>
<p>The time since origin / most recent common ancestor.</p>
</td></tr>
<tr><td><code id="sim.bd.taxa.age_+3A_mrca">mrca</code></td>
<td>
<p>If mrca = FALSE: The time since the origin of the process. If mrca = TRUE: The time since the most recent common ancestor of the sampled species.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>treearray</code></td>
<td>
<p>Array of numbsim trees with n&gt;1 tips with a given age. The extinct lineages are not included.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The algorithm is fast for the critical process, lambda=mu.
</p>


<h3>Author(s)</h3>

<p>Tanja Stadler </p>


<h3>References</h3>

<p>T. Stadler: On incomplete sampling under birth-death models and connections to the sampling-based coalescent.
J. Theo. Biol. (2009) 261: 58-66.</p>


<h3>See Also</h3>

<p>sim.bd.age, sim.rateshift.taxa, sim.gsa.taxa, birthdeath.tree 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-10
lambda &lt;- 2.0
mu &lt;- 0.5
frac &lt;-0.6
numbsim&lt;-2
age&lt;-2

##
# Simulating numbsim reconstructed trees with n sampled species under a
# birth-death process with speciation rate lambda, extinction rate mu,
# sampling probability frac, and time age since origin:

sim.bd.taxa.age(n, numbsim, lambda, mu, frac, age, mrca = FALSE)

# Simulating numbsim reconstructed trees with n sampled species under a
# birth-death process with speciation rate lambda, extinction rate mu,
# sampling probability frac, and time age since the most recent 
# common ancestor of the extant sampled species:

sim.bd.taxa.age(n, numbsim, lambda, mu, frac, age, mrca = TRUE)

</code></pre>

<hr>
<h2 id='sim.bdsky.stt'>sim.bdsky.stt: Simulating sequentially sampled birth-death, SIS, SIR or SIRS trees where birth and death rates are changing through time.</h2><span id='topic+sim.bdsky.stt'></span>

<h3>Description</h3>

<p>sim.bdsky.stt simulates birth-death trees with tips being sampled sequentially. The birth and death rates may change in a piecewise fashion. The birth rates may additionally depend on the number of susceptible individuals in an epidemic, corresponding to epidemiological SIS, SIR or SIRS dynamics. The trees are conditioned on a fixed number of tips or a fixed age.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.bdsky.stt(n,lambdasky,deathsky,timesky,sampprobsky,omegasky=rep(0,length(timesky)),
rho=0,timestop=0,model="BD",N=0,trackinfecteds=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.bdsky.stt_+3A_n">n</code></td>
<td>
<p>If n&gt;0, then the simulation is stopped once 'n' tips are sampled sequentially through time. If n=0, the simulation is stopped after time 'timestop'.</p>
</td></tr>
<tr><td><code id="sim.bdsky.stt_+3A_lambdasky">lambdasky</code></td>
<td>
<p>Vector of dimension k, where k is the number of different birth rates. An individual between time (timesky[i],timesky[i+1]) has birth rate lambdasky[i].</p>
</td></tr>
<tr><td><code id="sim.bdsky.stt_+3A_deathsky">deathsky</code></td>
<td>
<p>Vector of dimension k, where k is the number of different death rates. An individual between time (timesky[i],timesky[i+1]) has death rate deathsky[i].</p>
</td></tr>
<tr><td><code id="sim.bdsky.stt_+3A_timesky">timesky</code></td>
<td>
<p>Vector of dimension k, containing the times of rate shifts. Time is measured forward in time (unlike the function sim.rateshift.taxa where shifts are measured backward in time), with the origin of the tree being at time 0, i.e. timesky[1]=0.</p>
</td></tr>
<tr><td><code id="sim.bdsky.stt_+3A_sampprobsky">sampprobsky</code></td>
<td>
<p>Vector of dimension k, an individual dying during time (timesky[i],timesky[i+1]) is sampled with probability sampprobsky[i], i.e. is being included into the final tree.</p>
</td></tr>
<tr><td><code id="sim.bdsky.stt_+3A_omegasky">omegasky</code></td>
<td>
<p>Leave to default unless SIRS model simulation is being performed. omegasky is a vector of dimension k, where k is the number of different loose immunity rates (i.e. the rates of R-&gt;S transition in SIRS model). An individual between time (timesky[i],timesky[i+1]) has loose immunity rate omegasky[i].</p>
</td></tr>
<tr><td><code id="sim.bdsky.stt_+3A_rho">rho</code></td>
<td>
<p>Default is rho=0. If rho&gt;0 and timestop&gt;0, then the process is stopped after timestop and each individual alive at time timestop is included into the final tree with probability rho.</p>
</td></tr>
<tr><td><code id="sim.bdsky.stt_+3A_timestop">timestop</code></td>
<td>
<p>Default is timestop=0, meaning the simulation is stopped once n tips are sampled. If timestop&gt;0, then the simulation is stopped after time timestop.</p>
</td></tr>
<tr><td><code id="sim.bdsky.stt_+3A_n">N</code></td>
<td>
<p>Total population size is N. Set N&gt;0 when simulating under either of SIS/SIR/SIRS models.</p>
</td></tr>
<tr><td><code id="sim.bdsky.stt_+3A_model">model</code></td>
<td>
<p>Should be set to desired model. Default=&quot;BD&quot; (birth-death skyline model). The paramter accepts values &quot;BD&quot;,&quot;SIS&quot;,&quot;SIR&quot; or &quot;SIRS&quot;. For all the models but &quot;BD&quot; N&gt;0 should be set.</p>
</td></tr>
<tr><td><code id="sim.bdsky.stt_+3A_trackinfecteds">trackinfecteds</code></td>
<td>
<p>Set to TRUE records prevalence and incidence data, i.e. number of overall infecteds and times of infections in epidemiological terms, or overall number of species in that clade since time of origin, and times of speciations in macroevolutionary terms.</p>
</td></tr>	
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>List containing the phylogenetic tree with n sampled tips or a fixed age timestop for trackinfecteds=FALSE. If trackinfecteds=TRUE, the list contains also a second item, a list that tracks numbers of susceptible/infected/recovered/sampled individuals over the course of the tree growth. This list consist of: $timesky - times of rate changes, $eventtimes - times dating events happening in the tree, i.e. bifurcation, death, sampling, or loose immunity, $infecteds - the number of infected infividuals at $eventtimes, $cumulativeinfecteds - the cumulative number of infected individuals at $eventtimes, $cumulativesampleds - the cumulative number of sampled individuals at $eventtimes, and in case of SIR/SIRS model, the list also contains: $susceptibles - the number of susceptible individuals at $eventtimes, and $recovereds - the number of recovered individuals at $eventtimes. Times $timesky and $eventtimes are stated backward-in-time, such that time=0 is the time of the most recent sample, and time is increasing into the past. This allows for determining precisely the times of rate changes for skyline tree analyses. The counts in $infecteds,$cumulativeinfecteds, $cumulativesampleds, $susceptibles and $recovereds represent the number of individuals in each category prior to (more ancestral than) the $eventtimes.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>A large number of trees can be obtained using the R function lapply. The tree can be plotted using the R package ape function plot(tree).  sim.bdsky.stt function extends the function sim.rateshift.taxa to trees which contain tips being sampled sequentially.</p>


<h3>Author(s)</h3>

<p>Tanja Stadler, Veronika Boskova</p>


<h3>References</h3>

<p> T. Stadler, D. Kuehnert, S. Bonhoeffer, A. Drummond. Birth-death skyline plot reveals temporal changes of epidemic spread in HIV and hepatitis C virus (HCV). Proc. Nat. Acad. Sci., 110(1): 228-233, 2013.
</p>
<p>V. Boskova, S. Bonhoeffer, T. Stadler. Inference of epidemiological dynamics based on simulated phylogenies using birth-death and coalescent models. Manuscript.
</p>


<h3>See Also</h3>

<p>sim.bdtypes.stt.taxa</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Set the values for birth rates (lambda), deathrates (mu),
# sampling proportion (sampprob) and times of rate shifts (times).
# Also set the number of sampled tips in the final tree (n) and
# the number of simulations (numbsim).
set.seed(1)
n&lt;-10
lambda &lt;- c(2,1,2)
mu &lt;- c(1,0.5,1.5)
sampprob &lt;-c(0.5,0.5,0.5)
times&lt;-c(0,1,2)
numbsim&lt;-2
# Simulate trees under the birth-death skyline model
trees&lt;-lapply(rep(n,numbsim),sim.bdsky.stt,lambdasky=lambda,deathsky=mu,
timesky=times,sampprobsky=sampprob,rho=0,timestop=0)

### Simulate 10 trees with 100 tips under the SIRS model with 
# total population size N=500
trees&lt;-lapply(rep(100,10),sim.bdsky.stt,lambdasky=c(3,0.5,3,0.5,3),
deathsky=c(0.5,0.5,0.5,0.5,0.5),sampprobsky=c(0.5,0.5,0.5,0.5,0.5),
timesky=c(0,1,2,3,4),trackinfecteds=TRUE,model="SIRS",N=500,
omegasky=c(0,0.5,0.5,0.5,0))

### Simulate 1 tree with 100 tips under the SIRS model with 
# total population size N=500 and plot the S,I,R classes
trees&lt;-sim.bdsky.stt(100,lambdasky=c(3,0.5,3,0.5,3),deathsky=c(0.5,0.5,0.5,0.5,0.5),
sampprobsky=c(0.5,0.5,0.5,0.5,0.5),timesky=c(0,2,2.5,3,3.2),trackinfecteds=TRUE,
model="SIRS",N=500,omegasky=c(0,0.5,0.5,0.5,0.5))
plot(trees[[2]]$eventtimes,trees[[2]]$infecteds,xlim=rev(range(trees[[2]]$eventtimes)),
type="l",col="red",ylim=c(min(trees[[2]]$recovereds,trees[[2]]$infecteds,trees[[2]]$susceptibles),
max(trees[[2]]$recovereds,trees[[2]]$infecteds,trees[[2]]$susceptibles)),
xlab="time",ylab="Number of individuals")
abline(v=trees[[2]]$timesky,lty=2)
points(trees[[2]]$eventtimes,trees[[2]]$recovereds,type="l",col="green")
points(trees[[2]]$eventtimes,trees[[2]]$susceptibles,type="l",col="blue")
points(trees[[2]]$eventtimes,trees[[2]]$cumulativesampleds,type="l",col="grey")
legend("topleft",c("S","I","R","samples","rate changes"),
col=c("blue","red","green","grey","black"),lty=c(1,1,1,1,2))
</code></pre>

<hr>
<h2 id='sim.bdtypes.stt.taxa'>sim.bdtypes.stt.taxa: Simulating multitype birth-death trees with a fixed number of tips sampled through time.</h2><span id='topic+sim.bdtypes.stt.taxa'></span>

<h3>Description</h3>

<p>sim.bdtypes.stt.taxa simulates trees on n tips sampled through time under a multitype birth-death process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.bdtypes.stt.taxa(n,lambdavector,deathvector,
sampprobvector,init=-1,EI=FALSE,eliminate=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.bdtypes.stt.taxa_+3A_n">n</code></td>
<td>
<p>Number of sampled tips.</p>
</td></tr>
<tr><td><code id="sim.bdtypes.stt.taxa_+3A_lambdavector">lambdavector</code></td>
<td>
<p>Matrix of dimension kxk, where k is the number of different states. The entry (i,j) is the rate with which an individual in state i gives rise to a new lineage of state j.</p>
</td></tr>
<tr><td><code id="sim.bdtypes.stt.taxa_+3A_deathvector">deathvector</code></td>
<td>
<p>Vector of dimension k, the entry i is the death rate of an individual in state i.</p>
</td></tr>
<tr><td><code id="sim.bdtypes.stt.taxa_+3A_sampprobvector">sampprobvector</code></td>
<td>
<p>Vector of dimension k, the entry i is the probability of an individual in state i being sampled upon death, i.e. being included into the final tree.</p>
</td></tr>
<tr><td><code id="sim.bdtypes.stt.taxa_+3A_init">init</code></td>
<td>
<p>Default is -1, meaning the initial individual is in a random state (which is chosen from the equilibrium distribution of states). If init&gt;0, then the initial state is 'init'.</p>
</td></tr>
<tr><td><code id="sim.bdtypes.stt.taxa_+3A_ei">EI</code></td>
<td>
<p>If EI=TRUE a model with two types, namely exposed and infectious individuals, is assumed. Infectious individuals transmit and give rise to exposed individuals with rate lambdavector[2,1], and exposed individuals become infectious with rate lambdavector[1,2]. Exposed individuals have a 0 death rate and cannot be sampled. For an example simulation see below.</p>
</td></tr>
<tr><td><code id="sim.bdtypes.stt.taxa_+3A_eliminate">eliminate</code></td>
<td>
<p>Only relevant if EI=TRUE. Under EI=TRUE all sampled tips are in state 2. If eliminate&gt;0, the first eliminate tips are marked with state 1. This facilitates further analysis, e.g. we now can easily prune these first eliminate tips to mimic no sampling close to the epidemic outbreak.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>Phylogenetic tree with 'n' sampled tips. In out$states, the states for the tips are stored.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>A large number of trees can be obtained using the R function lapply. The tree can be plotted using the R package ape function plot(out). sim.bdtypes.stt.taxa function extends the simulator in the R package diversitree to trees which contain tips being sampled sequentially.</p>


<h3>Author(s)</h3>

<p>Tanja Stadler</p>


<h3>References</h3>

<p> T. Stadler, S. Bonhoeffer. Uncovering epidemiological dynamics in heterogeneous host populations using phylogenetic methods. Phil. Trans. Roy. Soc. B, 368 (1614): 20120198, 2013.
</p>


<h3>See Also</h3>

<p> sim.bdsky.stt </p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate two trees with 10 tips
set.seed(1)
n&lt;-10
lambda &lt;- rbind(c(2,1),c(3,4))
mu &lt;- c(1,1)
sampprob &lt;-c(0.5,0.5)
numbsim&lt;-2
trees&lt;-lapply(rep(n,numbsim),sim.bdtypes.stt.taxa,
lambdavector=lambda,deathvector=mu,sampprobvector=sampprob)

# Testing the model with exposed class (EI = TRUE)
set.seed(2)
# simulate tree with expected incubation period of 14 days, 
# infectious period of 7 days, and R0 of 1.5:
mu &lt;- c(0,1/7)
lambda &lt;- rbind(c(0,1/14),c(1.5/7,0))
# sampling probability of infectious individuals is 0.35:
sampprob &lt;-c(0,0.35)
# we stop once we have 20 samples:
n &lt;- 20
# we simulate one tree:
numbsim&lt;-1
# We mark first eliminate=10 tips such that we can easily drop them later
# (if deleting these 10 tips, we mimic no sampling close to the outbreak)
trees&lt;-lapply(rep(n,numbsim),sim.bdtypes.stt.taxa,lambdavector=lambda,deathvector=mu,
sampprobvector=sampprob,EI=TRUE,eliminate=10)
</code></pre>

<hr>
<h2 id='sim.genespeciestree'>sim.genespeciestree: Simulating birth-death species trees with nested coalescent gene trees.</h2><span id='topic+sim.genespeciestree'></span>

<h3>Description</h3>

<p>sim.genespeciestree simulates birth-death species trees (using sim.bd.taxa or sim.bd.taxa.age). Within each species tree, a gene tree is simulated, assuming a coalescent with coalescent rate being 1. The method returns summary statistics for the gene tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.genespeciestree(n, numbsim, lambda, mu, frac = 1, age=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.genespeciestree_+3A_n">n</code></td>
<td>
<p>Number of extant sampled tips.</p>
</td></tr>
<tr><td><code id="sim.genespeciestree_+3A_numbsim">numbsim</code></td>
<td>
<p>Number of trees to simulate.</p>
</td></tr>
<tr><td><code id="sim.genespeciestree_+3A_lambda">lambda</code></td>
<td>
<p>Speciation rate.</p>
</td></tr>
<tr><td><code id="sim.genespeciestree_+3A_mu">mu</code></td>
<td>
<p>Extinction rate.</p>
</td></tr>
<tr><td><code id="sim.genespeciestree_+3A_frac">frac</code></td>
<td>
<p> Each tip is included into the final species tree with probability frac.</p>
</td></tr>
<tr><td><code id="sim.genespeciestree_+3A_age">age</code></td>
<td>
<p>The time since origin / most recent common ancestor. If age = 0 (default) a uniform prior for the time since origin is assumed.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>statistics</code></td>
<td>
<p>For each simulated gene tree the following statistics are returned (with &quot;gammaspecies&quot; being the gamma statistic for the corresponding species tree): &quot;Colless&quot;,&quot;s&quot;,&quot;Sackin&quot;,&quot;cherries&quot;,&quot;matching of species tree and gene tree&quot;,&quot;gammaspecies&quot;,&quot;gamma&quot;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tanja Stadler </p>


<h3>References</h3>

<p>T. Stadler, J. Degnan, N. Rosenberg. Manuscript.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Simulate two gene trees within two species trees:
n&lt;-10
lambda &lt;- 2.0
mu &lt;- 0.5
frac &lt;-0.6
numbsim&lt;-2
age&lt;-2

# Simulation is conditioned on 10 final tips
sim.genespeciestree(n, numbsim, lambda, mu, frac, 0)

# Simulation is conditioned on 10 final tips and tree age 2
sim.genespeciestree(n, numbsim, lambda, mu, frac, age)
</code></pre>

<hr>
<h2 id='sim.genetree'>sim.genetree: Simulating coalescent gene trees.</h2><span id='topic+sim.genetree'></span>

<h3>Description</h3>

<p>sim.genetree simulates a gene tree assuming the coalescent with coalescent rate being 1. The method returns summary statistics of the gene tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.genetree(n, numbsim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.genetree_+3A_n">n</code></td>
<td>
<p>Number of extant sampled tips.</p>
</td></tr>
<tr><td><code id="sim.genetree_+3A_numbsim">numbsim</code></td>
<td>
<p>Number of trees to simulate.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>statistics</code></td>
<td>
<p>For each simulated gene tree the following statistics are returned: &quot;Colless&quot;,&quot;s&quot;,&quot;Sackin&quot;,&quot;cherries&quot;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tanja Stadler </p>


<h3>References</h3>

<p>T. Stadler, J. Degnan, N. Rosenberg. Manuscript.</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-10
numbsim&lt;-2

sim.genetree(n, numbsim)

</code></pre>

<hr>
<h2 id='sim.gsa.taxa'>
sim.gsa.taxa: Sampling trees on n tips from bigger trees.</h2><span id='topic+sim.gsa.taxa'></span>

<h3>Description</h3>

<p>sim.gsa.taxa samples trees on n tips (using the GSA approach, see references) from trees with m tips where m&gt;n, given the m-tip trees are simulated under the simple sampling approach (i.e. simulating until first m&gt;&gt;n tips are reached or the tree is extinct).
The TreeSim methods to simulate n-tip trees, sim.bd.taxa and sim.rateshift.taxa, are implemented such that sim.gsa.taxa is not necessary. sim.gsa.taxa is needed for post processing of trees generated NOT in TreeSim: if the aim is to simulate trees with n co-existing tips, then typically simulators stop once the first time n co-existing lineages are reached. However, due to death, we can observe n tips later (e.g. n+1 lineages followed by death leads n lineages). sim.gsa.taxa produces an appropriate set of n-tip trees where the input are m-tip trees with m&gt;&gt;n and the m-tip trees are simulated under these typical simulators.
</p>
<p>sim.gsa.taxa works for m-tip trees generated under a model where: (i) the number of tips eventually tends to zero or stays bigger than n and (ii) birth / death rate changes do not depend on the time between the change and the present - e.g. one cannot model a mass extinction event 1 million years BEFORE the present. But one can model a mass extinction event 1 million years AFTER the origin of the tree. The package TreeSimGM uses sim.gsa.taxa to obtain n-tip trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.gsa.taxa(treearray, n, frac = 1, sampling = 1, complete = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.gsa.taxa_+3A_treearray">treearray</code></td>
<td>
<p>Array of trees with a fixed number of tips.</p>
</td></tr>
<tr><td><code id="sim.gsa.taxa_+3A_n">n</code></td>
<td>
<p>Number of tips in sampled trees.</p>
</td></tr>
<tr><td><code id="sim.gsa.taxa_+3A_frac">frac</code></td>
<td>
<p>Relevant when complete = FALSE: The actual number of tips is n/frac, but only n tips are included (incomplete sampling).
When complete = TRUE: We set frac = 1.</p>
</td></tr>
<tr><td><code id="sim.gsa.taxa_+3A_sampling">sampling</code></td>
<td>
<p>Parameter determining how close the returned trees in treearray are to the &quot;true&quot; distribution. The higher 'sampling', the closer the output trees to the 'true' distribution. Default is 40. Higher values of sampling return fewer output trees meaning a larger input treearray is needed.</p>
</td></tr>
<tr><td><code id="sim.gsa.taxa_+3A_complete">complete</code></td>
<td>
<p>If TRUE, the tree with the extinct lineages is returned. If FALSE, the extinct lineages are suppressed.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>treearray</code></td>
<td>
<p>Array of sampled trees with n  extant sampled tips. Note that the number of trees in the output is significantly smaller than the number of trees in the input (in order to ensure correct tree sampling).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tanja Stadler</p>


<h3>References</h3>

<p>K. Hartmann, D. Wong, T. Stadler. Sampling trees from evolutionary models. Syst. Biol., 59(4): 465-476, 2010.
</p>
<p>T. Stadler. Simulating trees on a fixed number of extant species. Syst. Biol., 60: 676-684, 2011.</p>


<h3>See Also</h3>

<p>sim.bd.age, sim.bd.taxa, sim.rateshift.taxa, birthdeath.tree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
# First 100 trees on 9 tips under a birth-death process are generated.
# Then trees on 5 species are sampled from these 100 trees using the GSA
# (see references). 
# You can easily simulate trees on m species with the simple sampling
# approach (see references) under a variety of models. Then use the
# provided GSA algorithm to get a correct sample of trees on n&lt;&lt;m species:

m&lt;-9
n&lt;-5
numbsim&lt;-100
lambda &lt;- 2.0
mu &lt;- 0.5

t&lt;-sim.bd.taxa(m,numbsim,lambda,mu)
t2&lt;-sim.gsa.taxa(t,n)
</code></pre>

<hr>
<h2 id='sim.rateshift.taxa'>sim.rateshift.taxa: Simulating trees incorporating mass extinction events and rate shifts.</h2><span id='topic+sim.rateshift.taxa'></span>

<h3>Description</h3>

<p>sim.rateshift.taxa simulates trees on n species under the constant rate birth-death process. At user-specified points in the past, the rates can shift. Further, mass extinction events can be incorporated. The method further allows for incomplete sampling, i.e. only a fixed fraction of all tips is included in the sampled tree. The tree is conditioned to have n tips after sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.rateshift.taxa(n, numbsim, lambda, mu, frac, times, complete = TRUE, K=0, norm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.rateshift.taxa_+3A_n">n</code></td>
<td>
<p>Number of extant sampled tips.</p>
</td></tr>
<tr><td><code id="sim.rateshift.taxa_+3A_numbsim">numbsim</code></td>
<td>
<p>Number of trees to simulate.</p>
</td></tr>
<tr><td><code id="sim.rateshift.taxa_+3A_lambda">lambda</code></td>
<td>
<p>Vector of speciation rates, the rate in entry i is the speciation rate prior (ancestral) to time times[i].</p>
</td></tr>
<tr><td><code id="sim.rateshift.taxa_+3A_mu">mu</code></td>
<td>
<p>Vector of extinction rates, the rate in entry i is the extinction rate prior (ancestral) to time times[i].</p>
</td></tr>
<tr><td><code id="sim.rateshift.taxa_+3A_frac">frac</code></td>
<td>
<p>Vector of proportion of species surviving mass extinction event. Entry i corresponds to the mass extinction at time times[i]. If frac[i]=1, only rate shift but no mass extinction at time times[i].
</p>
</td></tr>
<tr><td><code id="sim.rateshift.taxa_+3A_times">times</code></td>
<td>
<p>Vector of mass extinction and rate shift times. Time is 0 today and increasing going backwards in time. Specify the vector as times[i]&lt;times[i+1]. times[1]=0 (today).</p>
</td></tr>
<tr><td><code id="sim.rateshift.taxa_+3A_complete">complete</code></td>
<td>
<p>If TRUE, the tree including the extinct lineages and non-sampled lineages is returned (so the tree has round(n/frac[1]) extant tips). If FALSE, the extinct lineages and non-sampled lineages are suppressed.</p>
</td></tr>
<tr><td><code id="sim.rateshift.taxa_+3A_k">K</code></td>
<td>
<p>If K&gt;0, then a density-dependent speciation rate = lambda*(1-numberspecies/K) is used. Only works currently for mu=0.</p>
</td></tr>
<tr><td><code id="sim.rateshift.taxa_+3A_norm">norm</code></td>
<td>
<p>If norm = TRUE the simulations are exact. If norm = FALSE tree is always returned once N=0 in Stadler 2011, p.678, point (7).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>List of numbsim simulated trees with n extant sampled tips.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tanja Stadler </p>


<h3>References</h3>

<p>T. Stadler. Simulating trees on a fixed number of extant species. Syst. Biol., 60: 676-684, 2011.
</p>


<h3>See Also</h3>

<p>sim.bd.age, sim.bd.taxa, sim.gsa.taxa, birthdeath.tree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-10
numbsim&lt;-1

##
# Simulating trees with a fixed number of species having shifts in rate
# and mass extinction events.
# Between today and time 0.3 in the past, we have speciation rate 2,
# extinction rate 0. At time 0.3, we have a mass extinction event which
# 10% of the species survive. Prior to 0.3, we have a speciation rate 
# of 1 and an extinction rate of 0.3:

sim.rateshift.taxa(n,numbsim,c(2,1),c(0,0.3),
c(1,0.1),c(0,0.3),complete=TRUE)

# The fraction 0.6 of the extant species is included into the final tree
# (the tree has n species AFTER sampling, extinct and
# non-sampled lineages are not included):

sim.rateshift.taxa(n,numbsim,c(2,1),c(0,0.3),
c(0.6,0.1),c(0,0.3),complete=FALSE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
