<!DOCTYPE html><html><head><title>Help for package photosynthesis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {photosynthesis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#A_supply'><p>CO2 supply and demand function (mol / m^2 s)</p></a></li>
<li><a href='#analyze_sensitivity'><p>Running 2-parameter sensitivity analyses</p></a></li>
<li><a href='#aq_response'><p>Non-rectangular hyperbolic model of light responses</p></a></li>
<li><a href='#bake'><p>Leaf parameter temperature responses</p></a></li>
<li><a href='#bake_par'><p>S3 class bake_par</p></a></li>
<li><a href='#baked-class'><p>S3 class baked</p></a></li>
<li><a href='#calculate_jmax'><p>Inverse non-rectangular hyperbola for J_max calculation</p></a></li>
<li><a href='#calculated-parameters'><p>Get default functions for calculated parameters in photosynthesis</p></a></li>
<li><a href='#CO2_conductance'><p>Conductance to CO2 (mol / m^2 / s)</p></a></li>
<li><a href='#compile_data'><p>Compiling outputs from lists</p></a></li>
<li><a href='#compute_sensitivity'><p>Computing measures of sensitivity</p></a></li>
<li><a href='#constants'><p>S3 class constants</p></a></li>
<li><a href='#enviro_par'><p>S3 class enviro_par</p></a></li>
<li><a href='#fit_aci_response'><p>Fitting ACi curves</p></a></li>
<li><a href='#fit_aq_response'><p>Fitting light responses of net CO2 assimilation</p></a></li>
<li><a href='#fit_aq_response2'><p>Fit photosynthetic light-response curves</p></a></li>
<li><a href='#fit_g_mc_variableJ'><p>Fitting mesophyll conductance with the variable J method</p></a></li>
<li><a href='#fit_gs_model'><p>Fitting stomatal conductance models</p></a></li>
<li><a href='#fit_hydra_vuln_curve'><p>Fitting hydraulic vulnerability curves</p></a></li>
<li><a href='#fit_many'><p>Fitting many functions across groups</p></a></li>
<li><a href='#fit_photosynthesis'><p>Fit photosynthetic models with gas-exchange data</p></a></li>
<li><a href='#fit_PV_curve'><p>Fitting pressure-volume curves</p></a></li>
<li><a href='#fit_r_light_kok'><p>Estimating light respiration</p></a></li>
<li><a href='#fit_r_light2'><p>Fit models to estimate light respiration (<code class="reqn">R_\mathrm{d}</code>)</p></a></li>
<li><a href='#fit_t_response'><p>Fitting temperature responses</p></a></li>
<li><a href='#FvCB'><p>Farquhar-von Caemmerer-Berry (FvCB) C3 photosynthesis model</p></a></li>
<li><a href='#get_default_model'><p>Get default model</p></a></li>
<li><a href='#gs_mod_ballberry'><p>Stomatal conductance models</p></a></li>
<li><a href='#J'><p>J: Rate of electron transport (umol/m^2/s)</p></a></li>
<li><a href='#leaf_par'><p>S3 class leaf_par</p></a></li>
<li><a href='#make_parameters'><p>Make lists of parameters for <code>photosynthesis</code></p></a></li>
<li><a href='#parameter_names'><p>Get vector of parameter names</p></a></li>
<li><a href='#photo_parameters'><p>Input parameters to simulate C3 photosynthesis using <code>photosynthesis()</code></p></a></li>
<li><a href='#photosynthesis'><p>Simulate C3 photosynthesis</p></a></li>
<li><a href='#photosynthesis-package'><p><code>photosynthesis</code> package</p></a></li>
<li><a href='#ppm2pa'><p>Convert pressure from PPM to Pascals</p></a></li>
<li><a href='#print_graphs'><p>Printing graphs to system</p></a></li>
<li><a href='#read_li6800'><p>Read a LI-COR file</p></a></li>
<li><a href='#read_licor'><p>Read a LI-COR file</p></a></li>
<li><a href='#required_variables'><p>Variables required for <strong>photosynthesis</strong> models</p></a></li>
<li><a href='#simulate_error'><p>Simulate gas exchange data with measurement error</p></a></li>
<li><a href='#t_response_arrhenius'><p>Temperature response functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-15</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Plant Ecophysiology &amp; Modeling</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), ggplot2 (&ge; 3.4.0), minpack.lm (&ge; 1.2-1), units
(&ge; 0.6.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate (&ge; 2.0.0), crayon (&ge; 1.3.4), dplyr (&ge; 0.8.5),
furrr (&ge; 0.1.0), glue (&ge; 1.4.0), graphics (&ge; 4.0.0),
grDevices (&ge; 4.0.0), gunit (&ge; 1.0.2), lifecycle (&ge; 1.0.0),
magrittr (&ge; 1.5.0), methods (&ge; 3.5.0), nlme (&ge; 3.1-147),
progress (&ge; 1.2.0), purrr (&ge; 0.3.3), readr (&ge; 2.0.0), rlang
(&ge; 0.4.6), stats (&ge; 4.0.0), stringr (&ge; 1.4.0), tealeaves (&ge;
1.0.5), utils (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>brms, broom, future, knitr, rmarkdown, testthat, tibble,
tidyr, tidyselect</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains modeling and analytical tools for plant ecophysiology.
    MODELING: Simulate C3 photosynthesis using the Farquhar, von Caemmerer,
    Berry (1980) &lt;<a href="https://doi.org/10.1007%2FBF00386231">doi:10.1007/BF00386231</a>&gt; model as described in Buckley and
    Diaz-Espejo (2015) &lt;<a href="https://doi.org/10.1111%2Fpce.12459">doi:10.1111/pce.12459</a>&gt;. It uses units to ensure that
    parameters are properly specified and transformed before calculations.
    Temperature response functions get automatically "baked" into all
    parameters based on leaf temperature following Bernacchi et al. (2002)
    &lt;<a href="https://doi.org/10.1104%2Fpp.008250">doi:10.1104/pp.008250</a>&gt;. The package includes boundary layer, cuticular,
    stomatal, and mesophyll conductances to CO2, which each can vary on the
    upper and lower portions of the leaf. Use straightforward functions to
    simulate photosynthesis over environmental gradients such as Photosynthetic
    Photon Flux Density (PPFD) and leaf temperature, or over trait gradients
    such as CO2 conductance or photochemistry. 
    ANALYTICAL TOOLS: Fit ACi (Farquhar et al. (1980) &lt;<a href="https://doi.org/10.1007%2FBF00386231">doi:10.1007/BF00386231</a>&gt;)
    and AQ curves (Marshall &amp; Biscoe (1980) &lt;<a href="https://doi.org/10.1093%2Fjxb%2F31.1.29">doi:10.1093/jxb/31.1.29</a>&gt;),
    temperature responses (Heskel et al. (2016) &lt;<a href="https://doi.org/10.1073%2Fpnas.1520282113">doi:10.1073/pnas.1520282113</a>&gt;;
    Kruse et al. (2008) &lt;<a href="https://doi.org/10.1111%2Fj.1365-3040.2008.01809.x">doi:10.1111/j.1365-3040.2008.01809.x</a>&gt;, Medlyn et al.
    (2002) &lt;<a href="https://doi.org/10.1046%2Fj.1365-3040.2002.00891.x">doi:10.1046/j.1365-3040.2002.00891.x</a>&gt;, Hobbs et al. (2013)
    &lt;<a href="https://doi.org/10.1021%2Fcb4005029">doi:10.1021/cb4005029</a>&gt;), respiration in the light (Kok (1956)
    &lt;<a href="https://doi.org/10.1016%2F0006-3002%2856%2990003-8">doi:10.1016/0006-3002(56)90003-8</a>&gt;, Walker &amp; Ort (2015) &lt;<a href="https://doi.org/10.1111%2Fpce.12562">doi:10.1111/pce.12562</a>&gt;,
    Yin et al. (2009) &lt;<a href="https://doi.org/10.1111%2Fj.1365-3040.2009.01934.x">doi:10.1111/j.1365-3040.2009.01934.x</a>&gt;, Yin et al. (2011)
    &lt;<a href="https://doi.org/10.1093%2Fjxb%2Ferr038">doi:10.1093/jxb/err038</a>&gt;), mesophyll conductance (Harley et al. (1992)
    &lt;<a href="https://doi.org/10.1104%2Fpp.98.4.1429">doi:10.1104/pp.98.4.1429</a>&gt;), pressure-volume curves (Koide et al. (2000)
    &lt;<a href="https://doi.org/10.1007%2F978-94-009-2221-1_9">doi:10.1007/978-94-009-2221-1_9</a>&gt;, Sack et al. (2003)
    &lt;<a href="https://doi.org/10.1046%2Fj.0016-8025.2003.01058.x">doi:10.1046/j.0016-8025.2003.01058.x</a>&gt;, Tyree et al. (1972)
    &lt;<a href="https://doi.org/10.1093%2Fjxb%2F23.1.267">doi:10.1093/jxb/23.1.267</a>&gt;), hydraulic vulnerability curves (Ogle et al. (2009)
    &lt;<a href="https://doi.org/10.1111%2Fj.1469-8137.2008.02760.x">doi:10.1111/j.1469-8137.2008.02760.x</a>&gt;, Pammenter et al. (1998)
    &lt;<a href="https://doi.org/10.1093%2Ftreephys%2F18.8-9.589">doi:10.1093/treephys/18.8-9.589</a>&gt;), and tools for running sensitivity
    analyses particularly for variables with uncertainty (e.g. g_mc(), gamma_star(),
    R_d()).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/cdmuir/photosynthesis">https://github.com/cdmuir/photosynthesis</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/cdmuir/photosynthesis/issues">https://github.com/cdmuir/photosynthesis/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-15 05:09:23 UTC; cdmuir</td>
</tr>
<tr>
<td>Author:</td>
<td>Joseph Stinziano <a href="https://orcid.org/0000-0002-7628-4201"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Cassaundra Roback [aut],
  Demi Sargent [aut],
  Bridget Murphy [aut],
  Patrick Hudson [aut, dtc],
  Chris Muir <a href="https://orcid.org/0000-0003-2555-3878"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chris Muir &lt;cdmuir@wisc.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-15 07:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='A_supply'>CO2 supply and demand function (mol / m^2 s)</h2><span id='topic+A_supply'></span><span id='topic+A_demand'></span>

<h3>Description</h3>

<p>This function is not intended to be called by users directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>A_supply(C_chl, pars, unitless = FALSE, use_legacy_version = FALSE)

A_demand(C_chl, pars, unitless = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="A_supply_+3A_c_chl">C_chl</code></td>
<td>
<p>Chloroplastic CO2 concentration in Pa of class <code>units</code></p>
</td></tr>
<tr><td><code id="A_supply_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id="A_supply_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should <code>units</code> be set? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
<tr><td><code id="A_supply_+3A_use_legacy_version">use_legacy_version</code></td>
<td>
<p>Logical. Should legacy model (&lt;2.1.0) be used? See <a href="https://github.com/cdmuir/photosynthesis/blob/master/NEWS.md">NEWS</a> for further information. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Supply function:</strong>
<br />
</p>
<p style="text-align: center;"><code class="reqn">A = g_\mathrm{tc} (C_\mathrm{air} - C_\mathrm{chl})</code>
</p>

<p><strong>Demand function:</strong>
<br />
</p>
<p style="text-align: center;"><code class="reqn">A = (1 - \Gamma* / C_\mathrm{chl}) \mathrm{min}(W_\mathrm{carbox}, W_\mathrm{regen}, W_\mathrm{tpu}) - R_\mathrm{d}</code>
</p>


<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">A</code> </td><td style="text-align: left;"> <code>A</code> </td><td style="text-align: left;"> photosynthetic rate </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol CO2 / (m^2 s) </td><td style="text-align: left;"> calculated </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">g_\mathrm{tc}</code> </td><td style="text-align: left;"> <code>g_tc</code> </td><td style="text-align: left;"> total conductance to CO2 </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol CO2 / (m<code class="reqn">^2</code> s Pa) </td><td style="text-align: left;"> <a href="#topic+.get_gtc">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">C_\mathrm{air}</code> </td><td style="text-align: left;"> <code>C_air</code> </td><td style="text-align: left;"> atmospheric CO2 concentration </td><td style="text-align: left;"> Pa </td><td style="text-align: left;"> 41 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">C_\mathrm{chl}</code> </td><td style="text-align: left;"> <code>C_chl</code> </td><td style="text-align: left;"> chloroplastic CO2 concentration </td><td style="text-align: left;"> Pa </td><td style="text-align: left;"> calculated</td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">R_\mathrm{d}</code> </td><td style="text-align: left;"> <code>R_d</code> </td><td style="text-align: left;"> nonphotorespiratory CO2 release </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol CO2 / (m<code class="reqn">^2</code> s) </td><td style="text-align: left;"> 2 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\Gamma*</code> </td><td style="text-align: left;"> <code>gamma_star</code> </td><td style="text-align: left;"> chloroplastic CO2 compensation point </td><td style="text-align: left;"> Pa </td><td style="text-align: left;"> 3.743
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in mol / (m^2 s) of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bake_par = make_bakepar()
constants = make_constants(use_tealeaves = FALSE)
enviro_par = make_enviropar(use_tealeaves = FALSE)
leaf_par = make_leafpar(use_tealeaves = FALSE)
leaf_par = bake(leaf_par, enviro_par, bake_par, constants)
# Or bake with piping (need library(magrittr))
# leaf_par %&lt;&gt;% bake(enviro_par, bake_par, constants)
enviro_par$T_air = leaf_par$T_leaf

pars = c(leaf_par, enviro_par, constants)
C_chl = set_units(350, umol/mol)

A_supply(C_chl, pars)

A_demand(C_chl, pars)
</code></pre>

<hr>
<h2 id='analyze_sensitivity'>Running 2-parameter sensitivity analyses</h2><span id='topic+analyze_sensitivity'></span>

<h3>Description</h3>

<p>Running 2-parameter sensitivity analyses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyze_sensitivity(
  data,
  funct,
  test1 = NA,
  values1,
  test2 = NA,
  values2,
  element_out = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyze_sensitivity_+3A_data">data</code></td>
<td>
<p>Dataframe</p>
</td></tr>
<tr><td><code id="analyze_sensitivity_+3A_funct">funct</code></td>
<td>
<p>Function to use - do not use parentheses</p>
</td></tr>
<tr><td><code id="analyze_sensitivity_+3A_test1">test1</code></td>
<td>
<p>Input parameter to vary and test</p>
</td></tr>
<tr><td><code id="analyze_sensitivity_+3A_values1">values1</code></td>
<td>
<p>Values of test1 to use</p>
</td></tr>
<tr><td><code id="analyze_sensitivity_+3A_test2">test2</code></td>
<td>
<p>Input parameter to vary and test</p>
</td></tr>
<tr><td><code id="analyze_sensitivity_+3A_values2">values2</code></td>
<td>
<p>Values of test2 to use</p>
</td></tr>
<tr><td><code id="analyze_sensitivity_+3A_element_out">element_out</code></td>
<td>
<p>List element to compile</p>
</td></tr>
<tr><td><code id="analyze_sensitivity_+3A_...">...</code></td>
<td>
<p>Additional arguments required for the function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>analyze_sensitivity runs a 2-parameter sensitivity analysis.
Note that any parameter value combinations that break the input function
WILL break this function. For 1-parameter sensitivity analysis, use test1
only.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data &lt;- read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Define a grouping factor based on light intensity to split the ACi
# curves
data$Q_2 &lt;- as.factor((round(data$Qin, digits = 0)))

# Convert leaf temperature to K
data$T_leaf &lt;- data$Tleaf + 273.15

# Run a sensitivity analysis on gamma_star and mesophyll conductance
# at 25 Celsius for one individual curve
# pars &lt;- analyze_sensitivity(
#   data = data[data$Q_2 == 1500, ],
#   funct = fit_aci_response,
#   varnames = list(
#     A_net = "A",
#     T_leaf = "T_leaf",
#     C_i = "Ci",
#     PPFD = "Qin"
#   ),
#   useg_mct = TRUE,
#   test1 = "gamma_star25",
#   element_out = 1,
#   test2 = "g_mc25",
#   fitTPU = TRUE,
#   Ea_gamma_star = 0,
#   Ea_g_mc = 0,
#   values1 = seq(
#     from = 20,
#     to = 40,
#     by = 2
#   ),
#   values2 = seq(
#     from = 0.5,
#     to = 2,
#     by = 0.1
#   )
# )

# Graph V_cmax
# ggplot(pars, aes(x = gamma_star25, y = g_mc25, z = V_cmax)) +
#   geom_tile(aes(fill = V_cmax)) +
#   labs(
#     x = expression(Gamma * "*"[25] ~ "(" * mu * mol ~ mol^
#       {
#         -1
#       } * ")"),
#     y = expression(g[m][25] ~ "(" * mu * mol ~ m^{
#       -2
#     } ~ s^{
#       -1
#     } ~ Pa^
#       {
#         -1
#       } * ")")
#   ) +
#   scale_fill_distiller(palette = "Greys") +
#   geom_contour(colour = "Black", size = 1) +
#   theme_bw()
# 

</code></pre>

<hr>
<h2 id='aq_response'>Non-rectangular hyperbolic model of light responses</h2><span id='topic+aq_response'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p>Please use <code>marshall_biscoe_1980()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aq_response(k_sat, phi_J, Q_abs, theta_J)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aq_response_+3A_k_sat">k_sat</code></td>
<td>
<p>Light saturated rate of process k</p>
</td></tr>
<tr><td><code id="aq_response_+3A_phi_j">phi_J</code></td>
<td>
<p>Quantum efficiency of process k</p>
</td></tr>
<tr><td><code id="aq_response_+3A_q_abs">Q_abs</code></td>
<td>
<p>Absorbed light intensity (umol m-2 s-1)</p>
</td></tr>
<tr><td><code id="aq_response_+3A_theta_j">theta_J</code></td>
<td>
<p>Curvature of the light response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>aq_response is used to describe the response of a process to
absorbed light intensity. Assumes that input is absorbed light. Note
that if absorbed light is not used, then the meaning of phi_J becomes
unclear. This function is designed to be used with fit_aq_response,
however it could easily be fed into a different fitting approach (e.g.
Bayesian approaches). Originally from Marshall et al. 1980.
</p>


<h3>References</h3>

<p>Marshall B, Biscoe P. 1980. A model for C3 leaves describing the
dependence of net photosynthesis on irradiance. J Ex Bot 31:29-39
</p>

<hr>
<h2 id='bake'>Leaf parameter temperature responses</h2><span id='topic+bake'></span><span id='topic+temp_resp1'></span><span id='topic+temp_resp2'></span>

<h3>Description</h3>

<p>'bake' leaf parameters using temperature response functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bake(leaf_par, enviro_par, bake_par, constants, assert_units = TRUE)

temp_resp1(par25, E_a, R, T_leaf, T_ref, unitless)

temp_resp2(par25, D_s, E_a, E_d, R, T_leaf, T_ref, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bake_+3A_leaf_par">leaf_par</code></td>
<td>
<p>A list of leaf parameters inheriting class <code>leaf_par</code>. This can be generated using the <code>make_leafpar</code> function.</p>
</td></tr>
<tr><td><code id="bake_+3A_enviro_par">enviro_par</code></td>
<td>
<p>A list of environmental parameters inheriting class <code>enviro_par</code>. This can be generated using the <code>make_enviropar</code> function.</p>
</td></tr>
<tr><td><code id="bake_+3A_bake_par">bake_par</code></td>
<td>
<p>A list of temperature response parameters inheriting class <code>bake_par</code>. This can be generated using the <code>make_bakepar</code> function.</p>
</td></tr>
<tr><td><code id="bake_+3A_constants">constants</code></td>
<td>
<p>A list of physical constants inheriting class <code>constants</code>. This can be generated using the <code>make_constants</code> function.</p>
</td></tr>
<tr><td><code id="bake_+3A_assert_units">assert_units</code></td>
<td>
<p>Logical. Should parameter <code>units</code> be checked? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
<tr><td><code id="bake_+3A_par25">par25</code></td>
<td>
<p>Parameter value at 25 째C of class <code>units</code>.</p>
</td></tr>
<tr><td><code id="bake_+3A_e_a">E_a</code></td>
<td>
<p>Empirical temperature response value in J/mol of class
<code>units</code>.</p>
</td></tr>
<tr><td><code id="bake_+3A_r">R</code></td>
<td>
<p>Ideal gas constant in J / (mol K) of class <code>units</code>. See
<code><a href="#topic+make_constants">make_constants()</a></code>.</p>
</td></tr>
<tr><td><code id="bake_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in K of class <code>units</code>. Will be converted
to 째C.</p>
</td></tr>
<tr><td><code id="bake_+3A_t_ref">T_ref</code></td>
<td>
<p>Reference temperature in K of class <code>units</code>.</p>
</td></tr>
<tr><td><code id="bake_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should <code>units</code> be set? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
<tr><td><code id="bake_+3A_d_s">D_s</code></td>
<td>
<p>Empirical temperature response value in J / (mol K) of class
<code>units</code>.</p>
</td></tr>
<tr><td><code id="bake_+3A_e_d">E_d</code></td>
<td>
<p>Empirical temperature response value in J/mol of class
<code>units</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several leaf parameters (<code><a href="#topic+leaf_par">leaf_par()</a></code>) are temperature sensitive.
Temperature-sensitive parameters are input at a reference temperature of
25 째C. These parameters are provided as <code>par_name25</code> and then &quot;baked&quot;
using the appropriate temperature response function and parameters in
<code><a href="#topic+bake_par">bake_par()</a></code>. The &quot;baked&quot; parameter will have the name without &quot;25&quot;
appended (<code>par_name</code>). E.g. <code>V_cmax25</code> becomes <code>V_cmax</code>. <br />
<br />
Temperature response functions following Buckley and  Diaz-Espejo (2015) <br />
<br />
Temperature response function 1 (<code>temp_response1</code>): <br />
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{par}(T_\mathrm{leaf}) = \mathrm{par25}~\mathrm{exp}(E_\mathrm{a} / (R T_\mathrm{ref}) (T_\mathrm{leaf} - 25) / (T_\mathrm{leaf} + 273.15))</code>
</p>

<p><code class="reqn">T_\mathrm{ref}</code> is the reference temperature in K <br />
<code class="reqn">T_\mathrm{leaf}</code> is the leaf temperature in 째C <br />
<br />
Temperature response function 2 (<code>temp_response2</code>) is the above equation multiplied by: <br />
</p>
<p style="text-align: center;"><code class="reqn">(1 + \mathrm{exp}((D_\mathrm{s} / R - E_\mathrm{d} / (R T_\mathrm{ref})))) / (1 + \mathrm{exp}((D_\mathrm{s} / R) - (E_\mathrm{d} / (R (T_\mathrm{leaf} + 273.15)))))</code>
</p>

<p>Function 1 increases exponentially with temperature; Function 2 peaks a particular temperature.
</p>


<h3>Value</h3>

<p>Constructor function for <code>baked</code> class. This will also inherit class
<code><a href="#topic+leaf_par">leaf_par()</a></code> and <code><a href="base.html#topic+list">list()</a></code>. This function ensures that
temperature is &quot;baked in&quot; to leaf parameter calculations <code>T_leaf</code> using
temperature response functions detailed below.
</p>


<h3>References</h3>

<p>Buckley TN, Diaz-Espejo A. 2015. Partitioning changes in photosynthetic rate
into contributions from different variables. Plant, Cell and Environment 38:
1200-1211.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bake_par = make_bakepar()
constants = make_constants(use_tealeaves = FALSE)
enviro_par = make_enviropar(use_tealeaves = FALSE)
leaf_par = make_leafpar(
  replace = list(T_leaf = set_units(293.15, K)),
  use_tealeaves = FALSE
)
baked_leafpar = bake(leaf_par, enviro_par, bake_par, constants)

baked_leafpar$V_cmax25
baked_leafpar$V_cmax
</code></pre>

<hr>
<h2 id='bake_par'>S3 class bake_par</h2><span id='topic+bake_par'></span>

<h3>Description</h3>

<p>S3 class bake_par
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bake_par(.x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bake_par_+3A_.x">.x</code></td>
<td>
<p>A list to be constructed into <strong>bake_par</strong>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Constructor function for bake_par class. This function ensures that leaf
temperature gets properly &quot;baked&quot; into leaf parameters.
</p>

<hr>
<h2 id='baked-class'>S3 class baked</h2><span id='topic+baked-class'></span>

<h3>Description</h3>

<p>See <code><a href="#topic+bake">bake()</a></code>
</p>

<hr>
<h2 id='calculate_jmax'>Inverse non-rectangular hyperbola for J_max calculation</h2><span id='topic+calculate_jmax'></span><span id='topic+calculate_j'></span>

<h3>Description</h3>

<p>Inverse non-rectangular hyperbola for J_max calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_jmax(PPFD, alpha, J, theta_J)

calculate_j(PPFD, alpha, J_max, theta_J)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_jmax_+3A_ppfd">PPFD</code></td>
<td>
<p>light intensity in umol m-2 s-1</p>
</td></tr>
<tr><td><code id="calculate_jmax_+3A_alpha">alpha</code></td>
<td>
<p>initial slope of the light response</p>
</td></tr>
<tr><td><code id="calculate_jmax_+3A_j">J</code></td>
<td>
<p>electron transport rate in umol m-2 s-1</p>
</td></tr>
<tr><td><code id="calculate_jmax_+3A_theta_j">theta_J</code></td>
<td>
<p>curvature of the light response</p>
</td></tr>
<tr><td><code id="calculate_jmax_+3A_j_max">J_max</code></td>
<td>
<p>maximum rate of electron transport in umol m-2 s-1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>calculate_jmax calculates J_max given PPFD and J.
It is necessary for the electron transport component of the
fit_aci_response function.
</p>
<p>calculate_j provides a model of the light response of J.
It is necessary for fitting the electron transport component
of the photosynthetic CO2 response curves in fit_aci_response.
</p>

<hr>
<h2 id='calculated-parameters'>Get default functions for calculated parameters in <a href="#topic+photosynthesis">photosynthesis</a></h2><span id='topic+calculated-parameters'></span><span id='topic+get_f_parameter'></span>

<h3>Description</h3>

<p>Get default functions for calculated parameters in <a href="#topic+photosynthesis">photosynthesis</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_f_parameter(.f_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculated-parameters_+3A_.f_name">.f_name</code></td>
<td>
<p>character string of function</p>
</td></tr>
</table>

<hr>
<h2 id='CO2_conductance'>Conductance to CO2 (mol / m^2 / s)</h2><span id='topic+CO2_conductance'></span><span id='topic+.get_gtc'></span><span id='topic+.get_guc'></span><span id='topic+.get_gbc'></span><span id='topic+.get_gmc'></span><span id='topic+.get_gsc'></span>

<h3>Description</h3>

<p>Conductance to CO2 (mol / m^2 / s)
</p>

<ul>
<li><p> g_tc: total conductance to CO2
</p>
</li></ul>


<ul>
<li><p> g_uc: cuticular conductance to CO2
</p>
</li></ul>


<ul>
<li><p> g_bc: boundary layer conductance to CO2
</p>
</li></ul>


<ul>
<li><p> g_mc: mesophyll conductance to CO2
</p>
</li></ul>


<ul>
<li><p> g_sc: stomatal conductance to CO2
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>.get_gtc(pars, unitless, use_legacy_version)

.get_guc(pars, surface, unitless)

.get_gbc(pars, surface, unitless, use_legacy_version)

.get_gmc(pars, surface, unitless)

.get_gsc(pars, surface, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CO2_conductance_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id="CO2_conductance_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should <code>units</code> be set? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
<tr><td><code id="CO2_conductance_+3A_use_legacy_version">use_legacy_version</code></td>
<td>
<p>Logical. Should legacy model (&lt;2.1.0) be used? See <a href="https://github.com/cdmuir/photosynthesis/blob/master/NEWS.md">NEWS</a> for further information. Default is FALSE.</p>
</td></tr>
<tr><td><code id="CO2_conductance_+3A_surface">surface</code></td>
<td>
<p>Leaf surface (lower or upper)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Default conductance model</strong>
</p>
<p>The conductance model described in this section is used by default unless
additional anatomical parameters described in the next section are provided.
</p>
<p>Total conductance to CO2 is the sum of parallel conductances on the lower
(<code class="reqn">g_\mathrm{c,lower}</code>) and upper
(<code class="reqn">g_\mathrm{c,upper}</code>) leaf portions:
</p>
<p style="text-align: center;"><code class="reqn">g_\mathrm{c,total} = g_\mathrm{c,lower} + g_\mathrm{c,upper}</code>
</p>

<p>Each partial conductance consists of two parallel conductances, the
cuticular conductance (<code class="reqn">g_\mathrm{u,c}</code>) and the in-series
conductances through mesophyll (<code class="reqn">g_\mathrm{m,c}</code>), stomata (<code class="reqn">g_\mathrm{s,c}</code>), and boundary layer (<code class="reqn">g_\mathrm{b,c}</code>). To simplify the formula, I use substitute resistance where <code class="reqn">r_x = 1 / g_x</code>. For surface <code class="reqn">i</code>:
</p>
<p style="text-align: center;"><code class="reqn">g_{\mathrm{c},i} = g_{\mathrm{u},i} + (1 / (r_{\mathrm{m},i} + r_{\mathrm{s},i} + r_{\mathrm{b},i}))</code>
</p>

<p>The cuticular, stomatal, and mesophyll conductances can be the same or
different for upper and lower. The partitioning factors (<code class="reqn">k_x</code>) divide the conductance between surfaces while keeping the total conductance constant:
</p>
<p style="text-align: center;"><code class="reqn">g_{x,\mathrm{lower}} = g_x (1 / (1 + k_x))</code>
</p>

<p style="text-align: center;"><code class="reqn">g_{x,\mathrm{upper}} = g_x (k_x / (1 + k_x))</code>
</p>

<p style="text-align: center;"><code class="reqn">g_x = g_{x,\mathrm{lower}} + g_{x,\mathrm{upper}}</code>
</p>

<p>How the partitioning factors work: <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<code class="reqn">k_x</code> </td><td style="text-align: left;"> description </td>
</tr>
<tr>
 <td style="text-align: left;">
0 </td><td style="text-align: left;"> all conductance on <strong>lower</strong> surface/portion </td>
</tr>
<tr>
 <td style="text-align: left;">
0.5 </td><td style="text-align: left;"> 2/3 conductance on <strong>lower</strong> surface </td>
</tr>
<tr>
 <td style="text-align: left;">
1 </td><td style="text-align: left;"> conductance evenly divided between surfaces/portions </td>
</tr>
<tr>
 <td style="text-align: left;">
2 </td><td style="text-align: left;"> 2/3 conductance on <strong>upper</strong> surface </td>
</tr>
<tr>
 <td style="text-align: left;">
Inf </td><td style="text-align: left;"> all conductance on <strong>upper</strong> surface/portion
</td>
</tr>

</table>

<p>The boundary layer conductances for each are calculated on the basis of mass
and heat transfer (see <code><a href="#topic+.get_gbc">.get_gbc()</a></code>).
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">g_\mathrm{mc}</code> </td><td style="text-align: left;"> <code>g_mc</code> </td><td style="text-align: left;"> mesophyll conductance to CO2 (T_leaf) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <a href="#topic+bake">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">g_\mathrm{sc}</code> </td><td style="text-align: left;"> <code>g_sc</code> </td><td style="text-align: left;"> stomatal conductance to CO2 </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 0.4 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">g_\mathrm{uc}</code> </td><td style="text-align: left;"> <code>g_uc</code> </td><td style="text-align: left;"> cuticular conductance to CO2 </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 0.01 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">k_\mathrm{mc}</code> </td><td style="text-align: left;"> <code>k_mc</code> </td><td style="text-align: left;"> partition of <code class="reqn">g_\mathrm{mc}</code> to lower mesophyll </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">k_\mathrm{sc}</code> </td><td style="text-align: left;"> <code>k_sc</code> </td><td style="text-align: left;"> partition of <code class="reqn">g_\mathrm{sc}</code> to lower surface </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">k_\mathrm{uc}</code> </td><td style="text-align: left;"> <code>k_uc</code> </td><td style="text-align: left;"> partition of <code class="reqn">g_\mathrm{uc}</code> to lower surface </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>New conductance model</strong>
</p>
<p>The conductance model described in this section is implemented in
<strong>photosynthesis</strong> (&gt;= 2.1.0) if parameters to calculate the internal
airspace and liquid-phase conductances (<code>A_mes_A</code>, <code>g_liqc</code>) are
provided. These parameters are 1) the effective path lengths through the
lower and upper leaf internal airspaces (<code>delta_ias_lower</code>,
<code>delta_ias_upper</code>) and 2) the mesophyll area per leaf area
(<code>A_mes_A</code>) and liquid-phase conductance per mesophyll cell area
(<code>g_liqc</code>).
</p>
<p>Two parallel diffusion pathways, one from each leaf surface, converge to a
single CO2 concentration at the mesophyll cell boundary. We use a single
liquid-phase resistance to represent the combined cell wall, plasmalemma, and
chloroplast resistances. The gas-phase resistance through boundary layer,
cuticle/stomata, and internal airspace is <code class="reqn">r_\mathrm{gas,c}</code>; the
liquid-phase intracellular resistance is <code class="reqn">r_\mathrm{i,c}</code>.
</p>
<p style="text-align: center;"><code class="reqn">r_\mathrm{total,c} = r_\mathrm{gas,c} + r_\mathrm{i,c}</code>
</p>

<p>The gas-phase resistance occurs through two parallel pathways, which we refer
to as the 'lower' and 'upper' pathways because horizontally oriented leaves
often have different anatomical properties on each surface. The gas-phase
resistance through pathway <code class="reqn">i \in \{\textrm{lower,upper\}}</code> is:
</p>
<p style="text-align: center;"><code class="reqn">r_{\mathrm{gas,c},i} = r_{\mathrm{b,c},i} + r_{\mathrm{u+s,c},i} + r_{\mathrm{ias,c},i}</code>
</p>

<p>The subscripts <code class="reqn">_\mathrm{b}</code>, <code class="reqn">_\mathrm{u+s}</code>, and <code class="reqn">_\mathrm{ias}</code>
denote boundary layer, cuticular + stomatal, and internal airspace,
respectively. The subscript <code class="reqn">_\mathrm{c}</code> indicates we are considering
the conductance to CO2 rather than another molecular species.
</p>
<p>Cuticular and stomatal conductances (1 / resistance) are parallel, so:
</p>
<p style="text-align: center;"><code class="reqn">1 / r_{\mathrm{u+s,c},i} = g_{\mathrm{u+s,c},i} = g_{\mathrm{u,c},i} + g_{\mathrm{s,c},i}</code>
</p>

<p>Substituting the above expression into the equation for <code class="reqn">r_{\mathrm{gas,c},i}</code>:
</p>
<p style="text-align: center;"><code class="reqn">r_{\mathrm{gas,c},i} = r_{\mathrm{b,c},i} + 1 / (g_{\mathrm{u,c},i} = g_{\mathrm{s,c},i}) + r_{\mathrm{ias,c},i}</code>
</p>

<p>The total gas-phase resistance is the inverse of the sum of the parallel
lower and upper conductances:
</p>
<p style="text-align: center;"><code class="reqn">1 / r_{\mathrm{gas,c}} = g_\mathrm{gas,c,lower} + g_\mathrm{gas,c,upper}</code>
</p>

<p>The cuticular, stomatal, and mesophyll conductances can be the same or
different for upper and lower. The partitioning factors <code class="reqn">k_u</code> and <code class="reqn">k_s</code>
divide the total cuticular and stomatal conductances, respectively, between
surfaces while keeping the total conductance constant:
</p>
<p style="text-align: center;"><code class="reqn">g_{x,\mathrm{lower}} = g_x (1 / (1 + k_x))</code>
</p>

<p style="text-align: center;"><code class="reqn">g_{x,\mathrm{upper}} = g_x (k_x / (1 + k_x))</code>
</p>

<p style="text-align: center;"><code class="reqn">g_x = g_{x,\mathrm{lower}} + g_{x,\mathrm{upper}}</code>
</p>

<p>How the partitioning factors work: <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<code class="reqn">k_x</code> </td><td style="text-align: left;"> description </td>
</tr>
<tr>
 <td style="text-align: left;">
0 </td><td style="text-align: left;"> all conductance on <strong>lower</strong> surface/portion </td>
</tr>
<tr>
 <td style="text-align: left;">
0.5 </td><td style="text-align: left;"> 2/3 conductance on <strong>lower</strong> surface </td>
</tr>
<tr>
 <td style="text-align: left;">
1 </td><td style="text-align: left;"> conductance evenly divided between surfaces/portions </td>
</tr>
<tr>
 <td style="text-align: left;">
2 </td><td style="text-align: left;"> 2/3 conductance on <strong>upper</strong> surface </td>
</tr>
<tr>
 <td style="text-align: left;">
Inf </td><td style="text-align: left;"> all conductance on <strong>upper</strong> surface/portion
</td>
</tr>

</table>

<p>The internal airspace conductance is the diffusivity of CO2 at a given
temperature and pressure divided by the effective path length:
</p>
<p style="text-align: center;"><code class="reqn">g_\mathrm{ias,c,lower} = D_\mathrm{c} / \delta_\mathrm{ias,lower}</code>
</p>

<p style="text-align: center;"><code class="reqn">g_\mathrm{ias,c,upper} = D_\mathrm{c} / \delta_\mathrm{ias,upper}</code>
</p>

<p><code>g_iasc_lower</code> and <code>g_iasc_upper</code> are calculated in the <a href="#topic+bake">bake</a>
function. See <code><a href="tealeaves.html#topic+dot-get_Dx">tealeaves::.get_Dx()</a></code> for calculating <code>D_c</code>.
</p>
<p>The liquid-phase intracellular resistance is given by:
</p>
<p style="text-align: center;"><code class="reqn">1 / r_\mathrm{i,c} = g_\mathrm{i,c} = g_\mathrm{liq,c} A_\mathrm{mes} / A</code>
</p>

<p><code class="reqn">g_\mathrm{liq,c}</code> is temperature sensitive. See <code><a href="#topic+bake">bake()</a></code>.
</p>
<p>The boundary layer conductances for each are calculated on the basis of mass
and heat transfer (see <code><a href="#topic+.get_gbc">.get_gbc()</a></code>).
</p>

<hr>
<h2 id='compile_data'>Compiling outputs from lists</h2><span id='topic+compile_data'></span>

<h3>Description</h3>

<p>Compiling outputs from lists
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compile_data(data, output_type = "list", list_element)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compile_data_+3A_data">data</code></td>
<td>
<p>List of elements</p>
</td></tr>
<tr><td><code id="compile_data_+3A_output_type">output_type</code></td>
<td>
<p>Type of desired output. For graphs or models, use &quot;list&quot;,
for parameters, use &quot;dataframe&quot;.</p>
</td></tr>
<tr><td><code id="compile_data_+3A_list_element">list_element</code></td>
<td>
<p>Which elements of the sublists do you wish to compile?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>compile_data converts the outputs of fit_many into a form more
readily usable for analysis. Can be used to create dataframe of all
fitted parameters, a list of model outputs, a list of graphs for plotting.
This function is NOT restricted to compiling outputs from plantecophystools
but could be used to compile elements from ANY list of lists.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data &lt;- read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Define a grouping factor based on light intensity to split the ACi
# curves
data$Q_2 &lt;- as.factor((round(data$Qin, digits = 0)))

# Convert leaf temperature to K
data$T_leaf &lt;- data$Tleaf + 273.15

# Fit many curves
fits &lt;- fit_many(
  data = data,
  varnames = list(
    A_net = "A",
    T_leaf = "T_leaf",
    C_i = "Ci",
    PPFD = "Qin"
  ),
  funct = fit_aci_response,
  group = "Q_2"
)

# Compile graphs into a list for plotting
fits_graphs &lt;- compile_data(fits,
  list_element = 2
)

# Plot one graph from the compiled list
plot(fits_graphs[[1]])

</code></pre>

<hr>
<h2 id='compute_sensitivity'>Computing measures of sensitivity</h2><span id='topic+compute_sensitivity'></span>

<h3>Description</h3>

<p>Computing measures of sensitivity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_sensitivity(
  data,
  varnames = list(Par = "Par", test1 = "test1", test2 = "test2"),
  test1_ref,
  test2_ref
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_sensitivity_+3A_data">data</code></td>
<td>
<p>Dataframe with output from sensitivity_analysis()</p>
</td></tr>
<tr><td><code id="compute_sensitivity_+3A_varnames">varnames</code></td>
<td>
<p>Variable names</p>
</td></tr>
<tr><td><code id="compute_sensitivity_+3A_test1_ref">test1_ref</code></td>
<td>
<p>Reference value for parameter</p>
</td></tr>
<tr><td><code id="compute_sensitivity_+3A_test2_ref">test2_ref</code></td>
<td>
<p>Reference value for parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>compute_sensitivity calculates two sets of sensitivity measures:
parameter effect (Bauerle et al., 2014), and control coefficient (Capaldo &amp;
Pandis, 1997). This function is useful in determining how much a given
input (assumed or otherwise) can affect the model output and conclusions.
Particularly useful if a given parameter is unknown during a fitting or
modeling process.
</p>


<h3>References</h3>

<p>Bauerle WL, Daniels AB, Barnard DM. 2014. Carbon and water flux responses to
physiology by environment interactions: a sensitivity analysis of variation
in climate on photosynthetic and stomatal parameters. Climate Dynamics 42:
2539-2554.
</p>
<p>Capaldo KP, Pandis SN 1997. Dimethylsulfide chemistry in the remote marine
atmosphere: evaluation and sensitivity analysis of available mechanisms.
J Geophys Res 102:23251-23267
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data &lt;- read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Define a grouping factor based on light intensity to split the ACi
# curves
data$Q_2 &lt;- as.factor((round(data$Qin, digits = 0)))

# Convert leaf temperature to K
data$T_leaf &lt;- data$Tleaf + 273.15

# Run a sensitivity analysis on gamma_star and mesophyll conductance
# at 25 Celsius for one individual curve
# pars &lt;- analyze_sensitivity(
#   data = data[data$Q_2 == 1500, ],
#   funct = fit_aci_response,
#   varnames = list(
#     A_net = "A",
#     T_leaf = "T_leaf",
#     C_i = "Ci",
#     PPFD = "Qin"
#   ),
#   useg_mct = TRUE,
#   test1 = "gamma_star25",
#   element_out = 1,
#   test2 = "g_mc25",
#   fitTPU = TRUE,
#   Ea_gamma_star = 0,
#   Ea_g_mc = 0,
#   values1 = seq(
#     from = 20,
#     to = 60,
#     by = 2
#   ),
#   values2 = seq(
#     from = 0.2,
#     to = 2,
#     by = 0.1
#   )
# )
# Compute measures of sensitivity
# par2 &lt;- compute_sensitivity(
#   data = pars,
#   varnames = list(
#     Par = "V_cmax",
#     test1 = "gamma_star25",
#     test2 = "g_mc25"
#   ),
#   test1_ref = 42,
#   test2_ref = 1
# )
# # Plot control coefficients
# ggplot(par2, aes(y = CE_gamma_star25, x = CE_g_mc25, colour = V_cmax)) +
#   geom_point() +
#   theme_bw()
# # Note that in this case a missing point appears due to an infinity

</code></pre>

<hr>
<h2 id='constants'>S3 class constants</h2><span id='topic+constants'></span>

<h3>Description</h3>

<p>S3 class constants
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constants(.x, use_tealeaves)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constants_+3A_.x">.x</code></td>
<td>
<p>A list to be constructed into <strong>constants</strong>.</p>
</td></tr>
<tr><td><code id="constants_+3A_use_tealeaves">use_tealeaves</code></td>
<td>
<p>Logical. Should leaf energy balance be used to calculate leaf temperature (T_leaf)? If TRUE, <code><a href="tealeaves.html#topic+tleaves">tleaf()</a></code> calculates T_leaf. If FALSE, user-defined T_leaf is used. Additional parameters and constants are required, see <code><a href="#topic+make_parameters">make_parameters()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Constructor function for constants class. This function ensures that
physical constant inputs are properly formatted.
</p>

<hr>
<h2 id='enviro_par'>S3 class enviro_par</h2><span id='topic+enviro_par'></span>

<h3>Description</h3>

<p>S3 class enviro_par
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enviro_par(.x, use_tealeaves)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="enviro_par_+3A_.x">.x</code></td>
<td>
<p>A list to be constructed into <strong>enviro_par</strong>.</p>
</td></tr>
<tr><td><code id="enviro_par_+3A_use_tealeaves">use_tealeaves</code></td>
<td>
<p>Logical. Should leaf energy balance be used to calculate leaf temperature (T_leaf)? If TRUE, <code><a href="tealeaves.html#topic+tleaves">tleaf()</a></code> calculates T_leaf. If FALSE, user-defined T_leaf is used. Additional parameters and constants are required, see <code><a href="#topic+make_parameters">make_parameters()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Constructor function for enviro_par class. This function ensures that environmental parameter inputs are properly formatted.
</p>

<hr>
<h2 id='fit_aci_response'>Fitting ACi curves</h2><span id='topic+fit_aci_response'></span>

<h3>Description</h3>

<p>Fitting ACi curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_aci_response(
  data,
  varnames = list(A_net = "A_net", T_leaf = "T_leaf", C_i = "C_i", PPFD = "PPFD", g_mc =
    "g_mc"),
  P = 100,
  fitTPU = TRUE,
  alpha_g = 0,
  R_d_meas = NULL,
  useR_d = FALSE,
  useg_mc = FALSE,
  useg_mct = FALSE,
  usegamma_star = FALSE,
  useK_M = FALSE,
  useK_C_K_O = FALSE,
  alpha = 0.24,
  theta_J = 0.85,
  gamma_star25 = 42.75,
  Ea_gamma_star = 37830,
  K_M25 = 718.4,
  Ea_K_M = 65508.28,
  g_mc25 = 0.08701,
  Ea_g_mc = 0,
  K_C25 = NULL,
  Ea_K_C = NULL,
  K_O25 = NULL,
  Ea_K_O = NULL,
  Oconc = 21,
  gamma_star_set = NULL,
  K_M_set = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_aci_response_+3A_data">data</code></td>
<td>
<p>Dataframe for A-Ci curve fitting</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_varnames">varnames</code></td>
<td>
<p>List of variable names. varnames = list(A_net = &quot;A_net&quot;,
T_leaf = &quot;T_leaf&quot;, C_i = &quot;C_i&quot;, PPFD = &quot;PPFD&quot;, g_mc = &quot;g_mc&quot;), where A_net
is net CO2 assimilation, T_leaf is leaf temperature in Celsius, C_i is
intercellular CO2 concentration in umol/mol, PPFD is incident irradiance
in umol m-2 s-1 (note that it is ASSUMED to be absorbed irradiance, so be
sure to adjust according to light absorbance and PSI/PSII partitioning
accordingly OR interpret the resultant values of J and J_max with caution),
g_mc is mesophyll conductance to CO2 in mol m-2 s-1 Pa-1.</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_p">P</code></td>
<td>
<p>Atmospheric pressure in kPa</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_fittpu">fitTPU</code></td>
<td>
<p>Should triose phosphate utilization (V_TPU) be fit?</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_alpha_g">alpha_g</code></td>
<td>
<p>Fraction of respiratory glycolate carbon that is not returned
to the chloroplast (von Caemmerer, 2000). If ACi curves show high-CO2
decline, then this value should be &gt; 0.</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_r_d_meas">R_d_meas</code></td>
<td>
<p>Measured value of respiratory CO2 efflux in umol m-2 s-1.
Input value should be positive to work as expected with the equations.</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_user_d">useR_d</code></td>
<td>
<p>Use a measured value of R_d? Set to TRUE if using R_d_meas.</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_useg_mc">useg_mc</code></td>
<td>
<p>Use mesophyll conductance? Set to TRUE if specifying g_mc
in varnames above.</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_useg_mct">useg_mct</code></td>
<td>
<p>Use mesophyll conductance temperature response? Set to TRUE
if using a temperature response of mesophyll conductance.</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_usegamma_star">usegamma_star</code></td>
<td>
<p>Specify gamma_star value? If FALSE, uses a temperature
response function with Nicotiana tabacum defaults from Bernacchi et al.
2001.</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_usek_m">useK_M</code></td>
<td>
<p>Specify K_M? If FALSE, uses an Arrhenius temperature response
function with Nicotiana tabacum defaults from Bernacchi et al. 2001.</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_usek_c_k_o">useK_C_K_O</code></td>
<td>
<p>Use individual carboxylation/oxygenation constants for
rubisco? If TRUE, need to specify values at 25C and activation energy for
the Arrhenius temperature response function.</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_alpha">alpha</code></td>
<td>
<p>Quantum yield of CO2 assimilation</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_theta_j">theta_J</code></td>
<td>
<p>Curvature of the photosynthetic light response curve</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_gamma_star25">gamma_star25</code></td>
<td>
<p>gamma_star at 25C in umol mol-1</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_ea_gamma_star">Ea_gamma_star</code></td>
<td>
<p>Activation energy of gamma_star in J mol-1</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_k_m25">K_M25</code></td>
<td>
<p>Michaelis-Menten constant for rubisco at 25C</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_ea_k_m">Ea_K_M</code></td>
<td>
<p>Activation energy for K_M in J mol-1</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_g_mc25">g_mc25</code></td>
<td>
<p>Mesophyll conductance at 25C in mol m-2 s-1</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_ea_g_mc">Ea_g_mc</code></td>
<td>
<p>Activation energy of g_mc in J mol-1</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_k_c25">K_C25</code></td>
<td>
<p>Michaelis-Menten constant for rubisco carboxylation at 25C</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_ea_k_c">Ea_K_C</code></td>
<td>
<p>Activation energy for K_C in J mol-1</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_k_o25">K_O25</code></td>
<td>
<p>Michaelis-Menten constant for rubisco oxygenation at 25C</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_ea_k_o">Ea_K_O</code></td>
<td>
<p>Activation energy for K_O in J mol-2</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_oconc">Oconc</code></td>
<td>
<p>O2 concentration in %. Used with P to calculate
intracellular O2 when using K_C_K_O</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_gamma_star_set">gamma_star_set</code></td>
<td>
<p>Value of gamma_star to use (in ppm) if
usegamma_star = TRUE</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_k_m_set">K_M_set</code></td>
<td>
<p>Value of K_M to use if useK_M = TRUE</p>
</td></tr>
<tr><td><code id="fit_aci_response_+3A_...">...</code></td>
<td>
<p>Other arguments to pass on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit_aci_response fits ACi curves using an approach similar to
Gu et al. 2010. Iterates all possible C_i transition points and checks for
inadmissible curve fits. If no curves are admissible (either due to poor data
or poor assumed parameters), the output will include a dataframe of NA values.
Default parameters are all from Bernacchi et al. 2001, 2002.
</p>


<h3>References</h3>

<p>Bernacchi CJ, Singsaas EL, Pimentel C, Portis AR, Long SP. 2001. Improved
temperature response functions for models of rubisco-limited photosynthesis.
Plant Cell Environment 24:253-259.
</p>
<p>Bernacchi CJ, Portis AR, Nakano H, von Caemmerer S, Long SP. 2002. Temperature
response of mesophyll conductance. Implications for the determination of rubisco
enzyme kinetics and for limitations to photosynthesis in vivo. Plant Physiology
130:1992-1998.
</p>
<p>Gu L, Pallardy SG, Tu K, Law BE, Wullschleger SD. 2010. Reliable estimation
of biochemical parameters from C3 leaf photosynthesis-intercellular carbon
dioxide response curves. Plant Cell Environment 33:1852-1874.
</p>
<p>von Caemmerer S. 2000. Biochemical models of leaf photosynthesis. CSIRO
Publishing, Collingwood.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data &lt;- read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Define a grouping factor based on light intensity to split the ACi
# curves
data$Q_2 &lt;- as.factor((round(data$Qin, digits = 0)))

# Convert leaf temperature to K
data$T_leaf &lt;- data$Tleaf + 273.15

# Fit ACi curve. Note that we are subsetting the dataframe
# here to fit for a single value of Q_2
fit &lt;- fit_aci_response(data[data$Q_2 == 1500, ],
  varnames = list(
    A_net = "A",
    T_leaf = "T_leaf",
    C_i = "Ci",
    PPFD = "Qin"
  )
)

# View fitted parameters
fit[[1]]

# View graph
fit[[2]]

# View data with modelled parameters attached
fit[[3]]

# Fit many curves
fits &lt;- fit_many(
  data = data,
  varnames = list(
    A_net = "A",
    T_leaf = "T_leaf",
    C_i = "Ci",
    PPFD = "Qin"
  ),
  funct = fit_aci_response,
  group = "Q_2"
)

# Print the parameters
# First set of double parentheses selects an individual group value
# Second set selects an element of the sublist
fits[[3]][[1]]

# Print the graph
fits[[3]][[2]]

# Compile graphs into a list for plotting
fits_graphs &lt;- compile_data(fits,
  list_element = 2
)

# Compile parameters into dataframe for analysis
fits_pars &lt;- compile_data(fits,
  output_type = "dataframe",
  list_element = 1
)

</code></pre>

<hr>
<h2 id='fit_aq_response'>Fitting light responses of net CO2 assimilation</h2><span id='topic+fit_aq_response'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p>Please use <code>fit_aq_response2()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_aq_response(
  data,
  varnames = list(A_net = "A_net", PPFD = "PPFD"),
  usealpha_Q = FALSE,
  alpha_Q = 0.84,
  title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_aq_response_+3A_data">data</code></td>
<td>
<p>Dataframe containing CO2 assimilation light response</p>
</td></tr>
<tr><td><code id="fit_aq_response_+3A_varnames">varnames</code></td>
<td>
<p>Variable names where varnames = list(A_net = &quot;A_net&quot;,
PPFD = &quot;PPFD&quot;). A_net is net CO2 assimilation in umol m-2 s-1, PPFD is
incident irradiance. PPFD can be corrected for light absorbance by using
useapha_Q and setting alpha_Q.</p>
</td></tr>
<tr><td><code id="fit_aq_response_+3A_usealpha_q">usealpha_Q</code></td>
<td>
<p>Correct light intensity for absorbance? Default is FALSE.</p>
</td></tr>
<tr><td><code id="fit_aq_response_+3A_alpha_q">alpha_Q</code></td>
<td>
<p>Absorbance of incident light. Default value is 0.84.</p>
</td></tr>
<tr><td><code id="fit_aq_response_+3A_title">title</code></td>
<td>
<p>Title for graph</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit_aq_response fits the light response of net CO2 assimilation.
Output is a dataframe containing light saturated net CO2 assimilation,
quantum yield of CO2 assimilation (phi_J), curvature of the light response
(theta_J), respiration (Rd), light compensation point (LCP), and residual
sum of squares (resid_SS). Note that Rd fitted in this way is essentially
the same as the Kok method, and represents a respiration value in the
light that may not be accurate. Rd output should thus be interpreted more
as a residual parameter to ensure an accurate fit of the light response
parameters. Model originally from Marshall &amp; Biscoe 1980.
</p>


<h3>References</h3>

<p>Marshall B, Biscoe P. 1980. A model for C3 leaves describing the
dependence of net photosynthesis on irradiance. J Ex Bot 31:29-39
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data = read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Fit many AQ curves
# Set your grouping variable
# Here we are grouping by CO2_s and individual
data$C_s = (round(data$CO2_s, digits = 0))

# For this example we need to round sequentially due to CO2_s setpoints
data$C_s = as.factor(round(data$C_s, digits = -1))

# To fit one AQ curve
fit = fit_aq_response(data[data$C_s == 600, ],
  varnames = list(
    A_net = "A",
    PPFD = "Qin"
  )
)

# Print model summary
summary(fit[[1]])

# Print fitted parameters
fit[[2]]

# Print graph
fit[[3]]

# Fit many curves
fits = fit_many(
  data = data,
  varnames = list(
    A_net = "A",
    PPFD = "Qin",
    group = "C_s"
  ),
  funct = fit_aq_response,
  group = "C_s"
)

# Look at model summary for a given fit
# First set of double parentheses selects an individual group value
# Second set selects an element of the sublist
summary(fits[[3]][[1]])

# Print the parameters
fits[[3]][[2]]

# Print the graph
fits[[3]][[3]]

# Compile graphs into a list for plotting
fits_graphs = compile_data(fits,
  list_element = 3
)

# Compile parameters into dataframe for analysis
fits_pars = compile_data(fits,
  output_type = "dataframe",
  list_element = 2
)


</code></pre>

<hr>
<h2 id='fit_aq_response2'>Fit photosynthetic light-response curves</h2><span id='topic+fit_aq_response2'></span>

<h3>Description</h3>

<p>We recommend using <code><a href="#topic+fit_photosynthesis">fit_photosynthesis()</a></code> with argument <code>.photo_fun = "aq_response"</code> rather than calling this function directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_aq_response2(
  .data,
  .model = "default",
  .method = "ls",
  usealpha_Q = FALSE,
  alpha_Q = 0.84,
  quiet = FALSE,
  brm_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_aq_response2_+3A_.data">.data</code></td>
<td>
<p>A data frame containing plant ecophysiological data. See <code><a href="#topic+required_variables">required_variables()</a></code> for the variables required for each model.</p>
</td></tr>
<tr><td><code id="fit_aq_response2_+3A_.model">.model</code></td>
<td>
<p>A character string of model name to use. See <code><a href="#topic+get_all_models">get_all_models()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_aq_response2_+3A_.method">.method</code></td>
<td>
<p>A character string of the statistical method to use: 'ls' for least-squares and 'brms' for Bayesian model using <code><a href="brms.html#topic+brm">brms::brm()</a></code>. Default is 'ls'.</p>
</td></tr>
<tr><td><code id="fit_aq_response2_+3A_usealpha_q">usealpha_Q</code></td>
<td>
<p>Flag. Should light intensity be multiplied by <code>alpha_Q</code> before fitting? Default is FALSE (i.e. assume that '.Q' is absorbed light).</p>
</td></tr>
<tr><td><code id="fit_aq_response2_+3A_alpha_q">alpha_Q</code></td>
<td>
<p>Number. Absorbance of incident light. Default value is 0.84. Ignored if <code>usealpha_Q = FALSE</code>.</p>
</td></tr>
<tr><td><code id="fit_aq_response2_+3A_quiet">quiet</code></td>
<td>
<p>Flag. Should messages be suppressed? Default is FALSE.</p>
</td></tr>
<tr><td><code id="fit_aq_response2_+3A_brm_options">brm_options</code></td>
<td>
<p>A list of options passed to <code><a href="brms.html#topic+brm">brms::brm()</a></code> if <code>.method = "brms"</code>. Default is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> If <code>.method = 'ls'</code>: an <code><a href="stats.html#topic+nls">stats::nls()</a></code> object.
</p>
</li>
<li><p> If <code>.method = 'brms'</code>: a <code><a href="brms.html#topic+brmsfit-class">brms::brmsfit()</a></code> object.
</p>
</li></ul>



<h3>Note</h3>

<p>Rd fitted in this way is essentially the same as the Kok (1956) method, and
represents a respiration value in the light that may not be accurate.
Rd output should thus be interpreted more as a residual parameter to ensure
an accurate fit of the light response parameters. Model originally from
Marshall &amp; Biscoe (1980).
</p>


<h3>References</h3>

<p>Marshall B, Biscoe P. 1980. A model for C3 leaves describing the
dependence of net photosynthesis on irradiance. J Ex Bot 31:29-39
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(broom)
library(dplyr)
library(photosynthesis)

# Read in your data
dat = system.file("extdata", "A_Ci_Q_data_1.csv", package = "photosynthesis") |&gt;
  read.csv() |&gt;
  # Set grouping variable
  mutate(group = round(CO2_s, digits = 0)) |&gt;
  # For this example, round sequentially due to CO2_s set points
  mutate(group = as.factor(round(group, digits = -1)))

# Fit one light-response curve
fit = fit_photosynthesis(
  .data = filter(dat, group == 600),
  .photo_fun = "aq_response",
  .vars = list(.A = A, .Q = Qabs),
)

# The 'fit' object inherits class 'nls' and many methods can be used

## Model summary:
summary(fit)

## Estimated parameters:
coef(fit)

## 95% confidence intervals:
confint(fit)

## Tidy summary table using 'broom::tidy()'
tidy(fit, conf.int = TRUE, conf.level = 0.95)

# Fit multiple curves with **photosynthesis** and **purrr**

library(purrr)

fits = dat |&gt;
  split(~ group) |&gt;
  map(fit_photosynthesis, .photo_fun = "aq_response", .vars = list(.A = A, .Q = Qabs))



</code></pre>

<hr>
<h2 id='fit_g_mc_variableJ'>Fitting mesophyll conductance with the variable J method</h2><span id='topic+fit_g_mc_variableJ'></span>

<h3>Description</h3>

<p>Fitting mesophyll conductance with the variable J method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_g_mc_variableJ(
  data,
  varnames = list(A_net = "A_net", J_etr = "J_etr", C_i = "C_i", PPFD = "PPFD", phi_PSII
    = "phi_PSII"),
  usealpha_Q = FALSE,
  alpha_Q = 0.84,
  beta_Q = 0.5,
  gamma_star,
  R_d,
  P = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_g_mc_variableJ_+3A_data">data</code></td>
<td>
<p>Dataframe</p>
</td></tr>
<tr><td><code id="fit_g_mc_variableJ_+3A_varnames">varnames</code></td>
<td>
<p>Variable names to fit g_mc. varnames = list(A_net = &quot;A_net&quot;,
J_etr = &quot;J_etr&quot;, C_i = &quot;C_i&quot;, PPFD = &quot;PPFD&quot;, phi_PSII = &quot;phi_PSII&quot;), where
A_net is net CO2 assimilation in umol m-2 s-1, J_etr is linear electron
transport flux in umol m-2 s-1, C_i is intercellular CO2 concentration in
umol mol-1, PPFD is incident irradiance in umol m-2 s-1, phi_PSII is
the operating efficiency of photosystem II.</p>
</td></tr>
<tr><td><code id="fit_g_mc_variableJ_+3A_usealpha_q">usealpha_Q</code></td>
<td>
<p>Recalculate electron transport with new absorbance value?</p>
</td></tr>
<tr><td><code id="fit_g_mc_variableJ_+3A_alpha_q">alpha_Q</code></td>
<td>
<p>Absorbance of photosynthetically active radiation</p>
</td></tr>
<tr><td><code id="fit_g_mc_variableJ_+3A_beta_q">beta_Q</code></td>
<td>
<p>Partitioning of absorbed light energy between PSI and PSII</p>
</td></tr>
<tr><td><code id="fit_g_mc_variableJ_+3A_gamma_star">gamma_star</code></td>
<td>
<p>Photorespiratory CO2 compensation point in umol mol-1</p>
</td></tr>
<tr><td><code id="fit_g_mc_variableJ_+3A_r_d">R_d</code></td>
<td>
<p>Respiration rate in umol m-2 s-1</p>
</td></tr>
<tr><td><code id="fit_g_mc_variableJ_+3A_p">P</code></td>
<td>
<p>Atmospheric pressure in kPa</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit_g_mc_variableJ fits mesophyll conductance according
to Harley et al. 1992. It also tests the reliability of the
calculation and calculates a mean with only reliable values.
Note that the output is in units of umol m-2 s-1 Pa-1.
</p>


<h3>References</h3>

<p>Harley PC, Loreto F, Di Marco G, Sharkey TD. 1992. Theoretical
considerations when estimating mesophyll conductance to CO2 flux
by analysis of the response of photosynthesis to CO2. Plant Physiol
98:1429 - 1436.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data &lt;- read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Note: there will be issues here if the alpha value used
# for calculating ETR is off, if gamma_star is incorrect,
# if R_d is incorrect.
data &lt;- fit_g_mc_variableJ(data,
  varnames = list(
    A_net = "A",
    J_etr = "ETR",
    C_i = "Ci",
    PPFD = "Qin",
    phi_PSII = "PhiPS2"
  ),
  gamma_star = 46,
  R_d = 0.153,
  usealpha_Q = TRUE,
  alpha_Q = 0.84,
  beta_Q = 0.5,
  P = 84
)

# Note that many g_mc values from this method can be unreliable
ggplot(data, aes(x = CO2_s, y = g_mc, colour = reliable)) +
  labs(
    x = expression(CO[2] ~ "(" * mu * mol ~ mol^
      {
        -1
      } * ")"),
    y = expression(g[m] ~ "(mol" ~ m^{
      -2
    } ~ s^{
      -1
    } ~ Pa^
      {
        -1
      } * ")")
  ) +
  geom_point(size = 2) +
  theme_bw() +
  theme(legend.position = "bottom")

# Plot QAQC graph according to Harley et al. 1992
ggplot(data, aes(x = CO2_s, y = dCcdA, colour = reliable)) +
  labs(
    x = expression(CO[2] ~ "(" * mu * mol ~ mol^
      {
        -1
      } * ")"),
    y = expression(delta * C[chl] * "/" * delta * A)
  ) +
  geom_hline(yintercept = 10) +
  geom_point(size = 2) +
  theme_bw() +
  theme(legend.position = "bottom")

</code></pre>

<hr>
<h2 id='fit_gs_model'>Fitting stomatal conductance models</h2><span id='topic+fit_gs_model'></span>

<h3>Description</h3>

<p>Fitting stomatal conductance models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_gs_model(
  data,
  varnames = list(A_net = "A_net", C_air = "C_air", g_sw = "g_sw", RH = "RH", VPD =
    "VPD"),
  model = c("BallBerry", "Leuning", "Medlyn_partial", "Medlyn_full"),
  D0 = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_gs_model_+3A_data">data</code></td>
<td>
<p>Dataframe</p>
</td></tr>
<tr><td><code id="fit_gs_model_+3A_varnames">varnames</code></td>
<td>
<p>Variable names
</p>
<p>For the Ball-Berry model: varnames = list(A_net = &quot;A_net&quot;, C_air = &quot;C_air&quot;,
g_sw = &quot;g_sw&quot;, RH = &quot;RH&quot;) where A_net is net CO2 assimilation, C_air is CO2
concentration at the leaf surface in umol mol-1, g_sw is stomatal
conductance to H2O, and RH is relative humidity as a proportion.
</p>
<p>For the Leuning model: varnames = list(A_net = &quot;A_net&quot;, C_air = &quot;C_air&quot;,
g_sw = &quot;g_sw&quot;, VPD = &quot;VPD&quot;) where A_net is net CO2 assimilation, C_air is
CO2 concentration at the leaf surface in umol mol-1, g_sw is stomatal
conductance to H2O, and VPD is leaf to air vapor pressure deficit in kPa.
</p>
<p>For the Medlyn et al. 2011 models: varnames = list(A_net = &quot;A_net&quot;,
C_air = &quot;C_air&quot;, g_sw = &quot;g_sw&quot;, VPD = &quot;VPD&quot;) where A_net is net CO2
assimilation, C_air is CO2 concentration at the leaf surface in umol mol-1,
g_sw is stomatal conductance to H2O, and VPD is leaf to air vapor pressure
deficit in kPa.</p>
</td></tr>
<tr><td><code id="fit_gs_model_+3A_model">model</code></td>
<td>
<p>Which model(s) to fit? Defaults to all models. Available
options are &quot;BallBerry&quot;, &quot;Leuning&quot;, &quot;Medlyn_partial&quot;, and &quot;Medlyn_full&quot;,
from Ball et al. (1987), Leuning (1995), and Medlyn et al. (2011).</p>
</td></tr>
<tr><td><code id="fit_gs_model_+3A_d0">D0</code></td>
<td>
<p>Vapor pressure sensitivity of stomata (Leuning 1995)</p>
</td></tr>
<tr><td><code id="fit_gs_model_+3A_...">...</code></td>
<td>
<p>Arguments to pass on to the nlsLM() function for the Medlyn
models.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit_gs_model fits one or more stomatal conductance models to the
data. The top level of the output list is named after the fitted model,
while the second level contains the Model, Parameters, and Graph, in that
order.
</p>


<h3>References</h3>

<p>Ball JT, Woodrow IE, Berry JA. 1987. A model predicting stomatal
conductance and its contribution to the control of photosynthesis
under different environmental conditions, in Progress in
Photosynthesis Research, Proceedings of the VII International
Congress on Photosynthesis, vol. 4, edited by I. Biggins, pp.
221224, Martinus Nijhoff, Dordrecht, Netherlands.
</p>
<p>Leuning R. 1995. A critical appraisal of a coupled stomatal-
photosynthesis model for C3 plants. Plant Cell Environ 18:339-357
</p>
<p>Medlyn BE, Duursma RA, Eamus D, Ellsworth DS, Prentice IC, Barton
CVM, Crous KY, Angelis PD, Freeman M, Wingate L. 2011. Reconciling
the optimal and empirical approaches to modeling stomatal
conductance. Glob Chang Biol 17:2134-2144
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data &lt;- read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Convert RH to a proportion
data$RH &lt;- data$RHcham / 100

# Fit stomatal conductance models
# Can specify a single model, or all as below
fits &lt;- fit_gs_model(
  data = data,
  varnames = list(
    A_net = "A",
    C_air = "Ca",
    g_sw = "gsw",
    RH = "RH",
    VPD = "VPDleaf"
  ),
  model = c(
    "BallBerry",
    "Leuning",
    "Medlyn_partial",
    "Medlyn_full"
  ),
  D0 = 3
)

# Look at BallBerry model summary:
summary(fits[["BallBerry"]][["Model"]])

# Look at BallBerry parameters
fits[["BallBerry"]][["Parameters"]]

# Look at BallBerry plot
fits[["BallBerry"]][["Graph"]]

# Fit many g_sw models
# Set your grouping variable
# Here we are grouping by Qin and individual
data$Q_2 &lt;- as.factor((round(data$Qin, digits = 0)))

fits &lt;- fit_many(data,
  varnames = list(
    A_net = "A",
    C_air = "Ca",
    g_sw = "gsw",
    RH = "RH",
    VPD = "VPDleaf"
  ),
  funct = fit_gs_model,
  group = "Q_2"
)

# Look at the Medlyn_partial outputs at 750 PAR
# Model summary
summary(fits[["750"]][["Medlyn_partial"]][["Model"]])

# Model parameters
fits[["750"]][["Medlyn_partial"]][["Parameters"]]

# Graph
fits[["750"]][["Medlyn_partial"]][["Graph"]]

# Compile parameter outputs for BallBerry model
# Note that it's the first element for each PAR value
# First compile list of BallBerry fits
bbmods &lt;- compile_data(
  data = fits,
  output_type = "list",
  list_element = 1
)
# Now compile the parameters (2nd element) into a dataframe
bbpars &lt;- compile_data(
  data = bbmods,
  output_type = "dataframe",
  list_element = 2
)

# Convert group variable back to numeric
bbpars$ID &lt;- as.numeric(bbpars$ID)

# Take quick look at light response of intercept parameters
plot(g0 ~ ID, bbpars)

# Compile graphs
graphs &lt;- compile_data(
  data = bbmods,
  output_type = "list",
  list_element = 3
)

# Look at 3rd graph
graphs[[3]]

</code></pre>

<hr>
<h2 id='fit_hydra_vuln_curve'>Fitting hydraulic vulnerability curves</h2><span id='topic+fit_hydra_vuln_curve'></span>

<h3>Description</h3>

<p>Fitting hydraulic vulnerability curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_hydra_vuln_curve(
  data,
  varnames = list(psi = "psi", PLC = "PLC"),
  start_weibull = list(a = 2, b = 2),
  title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_hydra_vuln_curve_+3A_data">data</code></td>
<td>
<p>Dataframe</p>
</td></tr>
<tr><td><code id="fit_hydra_vuln_curve_+3A_varnames">varnames</code></td>
<td>
<p>List of variable names. varnames = list(psi = &quot;psi&quot;,
PLC = &quot;PLC&quot;) where psi is water potential in MPa, and PLC is percent
loss conductivity.</p>
</td></tr>
<tr><td><code id="fit_hydra_vuln_curve_+3A_start_weibull">start_weibull</code></td>
<td>
<p>starting values for the nls fitting routine
for the Weibull curve</p>
</td></tr>
<tr><td><code id="fit_hydra_vuln_curve_+3A_title">title</code></td>
<td>
<p>Title for the output graph</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit_hydra_vuln_curve fits a sigmoidal function (Pammenter &amp; Van der
Willigen, 1998) linearized according to Ogle et al. (2009). Output is a list
containing the sigmoidal model in element 1 and Weibull model in element 4,
the fit parameters with 95% confidence interval for both models are in
element 2, and hydraulic parameters in element 3 (including P25, P50, P88,
P95, S50, Pe, Pmax, DSI). Px (25 to 95): water potential at which x% of
conductivity is lost. S50: slope at 50% loss of conductivity. Pe: air
entry point. Pmax: hydraulic failure threshold. DSI: drought stress interval.
Element 5 is a graph showing the fit, P50, Pe, and Pmax.
</p>


<h3>References</h3>

<p>Ogle K, Barber JJ, Willson C, Thompson B. 2009. Hierarchical statistical
modeling of xylem vulnerability to cavitation. New Phytologist 182:541-554
</p>
<p>Pammenter NW, Van der Willigen CV. 1998. A mathematical and statistical
analysis of the curves illustrating vulnerability of xylem to cavitation.
Tree Physiology 18:589-593
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in data
data &lt;- read.csv(system.file("extdata", "hydraulic_vulnerability.csv",
  package = "photosynthesis"
))

# Fit hydraulic vulnerability curve
fit &lt;- fit_hydra_vuln_curve(data[data$Tree == 4 &amp; data$Plot == "Control", ],
  varnames = list(
    psi = "P",
    PLC = "PLC"
  ),
  title = "Control 4"
)

# Return Sigmoidal model summary
summary(fit[[1]])

# Return Weibull model summary
summary(fit[[4]])

# Return model parameters with 95\% confidence intervals
fit[[2]]

# Return hydraulic parameters
fit[[3]]

# Return graph
fit[[5]]

# Fit many curves
fits &lt;- fit_many(
  data = data,
  varnames = list(
    psi = "P",
    PLC = "PLC"
  ),
  group = "Tree",
  funct = fit_hydra_vuln_curve
)

# To select individuals from the many fits
# Return model summary
summary(fits[[1]][[1]]) # Returns model summary

# Return sigmoidal model output
fits[[1]][[2]]

# Return hydraulic parameters
fits[[1]][[3]]

# Return graph
fits[[1]][[5]]

# Compile parameter outputs
pars &lt;- compile_data(
  data = fits,
  output_type = "dataframe",
  list_element = 3
)

# Compile graphs
graphs &lt;- compile_data(
  data = fits,
  output_type = "list",
  list_element = 5
)

</code></pre>

<hr>
<h2 id='fit_many'>Fitting many functions across groups</h2><span id='topic+fit_many'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p>We are no longer updating this function. Please use generic methods like <code><a href="purrr.html#topic+map">map</a></code> instead. See <code>vignette("light-response")</code> for an example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_many(data, funct, group, progress = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_many_+3A_data">data</code></td>
<td>
<p>Dataframe</p>
</td></tr>
<tr><td><code id="fit_many_+3A_funct">funct</code></td>
<td>
<p>Function to fit</p>
</td></tr>
<tr><td><code id="fit_many_+3A_group">group</code></td>
<td>
<p>Grouping variables</p>
</td></tr>
<tr><td><code id="fit_many_+3A_progress">progress</code></td>
<td>
<p>Flag. Show progress bar?</p>
</td></tr>
<tr><td><code id="fit_many_+3A_...">...</code></td>
<td>
<p>Arguments for the function to fit. Use ?functionname
to read the help file on available arguments for a given function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit_many fits a function across every instance of
a grouping variable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data = read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Define a grouping factor based on light intensity to split the ACi
# curves
data$Q_2 = as.factor((round(data$Qin, digits = 0)))

# Convert leaf temperature to K
data$T_leaf = data$Tleaf + 273.15

# Fit many curves
fits = fit_many(
  data = data,
  varnames = list(
    A_net = "A",
    T_leaf = "T_leaf",
    C_i = "Ci",
    PPFD = "Qin"
  ),
  funct = fit_aci_response,
  group = "Q_2"
)

# Print the parameters
# First set of double parentheses selects an individual group value
# Second set selects an element of the sublist
fits[[3]][[1]]

# Print the graph
fits[[3]][[2]]

# Compile graphs into a list for plotting
fits_graphs = compile_data(fits,
  list_element = 2
)


# Compile parameters into dataframe for analysis
fits_pars = compile_data(fits,
  output_type = "dataframe",
  list_element = 1
)


</code></pre>

<hr>
<h2 id='fit_photosynthesis'>Fit photosynthetic models with gas-exchange data</h2><span id='topic+fit_photosynthesis'></span>

<h3>Description</h3>

<p>Fit photosynthetic models with gas-exchange data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_photosynthesis(
  .data,
  .photo_fun,
  .model = "default",
  .vars = NULL,
  .method = "ls",
  ...,
  quiet = FALSE,
  brm_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_photosynthesis_+3A_.data">.data</code></td>
<td>
<p>A data frame containing plant ecophysiological data. See <code><a href="#topic+required_variables">required_variables()</a></code> for the variables required for each model.</p>
</td></tr>
<tr><td><code id="fit_photosynthesis_+3A_.photo_fun">.photo_fun</code></td>
<td>
<p>A character string of <strong>photosynthesis</strong> function to call. One of: <code style="white-space: pre;">&#8288;aq_response, r_light&#8288;</code>.</p>
</td></tr>
<tr><td><code id="fit_photosynthesis_+3A_.model">.model</code></td>
<td>
<p>A character string of model name to use. See <code><a href="#topic+get_all_models">get_all_models()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_photosynthesis_+3A_.vars">.vars</code></td>
<td>
<p>A list to rename variables in .data. See <code><a href="#topic+required_variables">required_variables()</a></code> for the accepted variable names.</p>
</td></tr>
<tr><td><code id="fit_photosynthesis_+3A_.method">.method</code></td>
<td>
<p>A character string of the statistical method to use: 'ls' for least-squares and 'brms' for Bayesian model using <code><a href="brms.html#topic+brm">brms::brm()</a></code>. Default is 'ls'.</p>
</td></tr>
<tr><td><code id="fit_photosynthesis_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to specific models. See specific help pages for each type of photosynthetic model:
</p>

<ul>
<li><p> Light-response curves <code><a href="#topic+fit_aq_response2">fit_aq_response2()</a></code>
</p>
</li>
<li><p> Light respiration <code><a href="#topic+fit_r_light2">fit_r_light2()</a></code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_photosynthesis_+3A_quiet">quiet</code></td>
<td>
<p>Flag. Should messages be suppressed? Default is FALSE.</p>
</td></tr>
<tr><td><code id="fit_photosynthesis_+3A_brm_options">brm_options</code></td>
<td>
<p>A list of options passed to <code><a href="brms.html#topic+brm">brms::brm()</a></code> if <code>.method = "brms"</code>. Default is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A fitted model object
</p>

<ul>
<li><p> class 'lm' or 'nls' if <code>method = 'ls'</code>
</p>
</li>
<li><p> class 'brmsfit' if <code>method = 'brms'</code>
</p>
</li></ul>



<h3>Note</h3>

<p>This function will fit models to data but several methods require post-processing to extract meaningful parameter estimates and confidence intervals. See vignettes for further explanation and examples.
</p>

<ul>
<li><p> Light-response curves: <code>vignette("light-response", package = "photosynthesis")</code>
</p>
</li>
<li><p> Light respiration: <code>vignette("light-respiration", package = "photosynthesis")</code>
</p>
</li></ul>


<hr>
<h2 id='fit_PV_curve'>Fitting pressure-volume curves</h2><span id='topic+fit_PV_curve'></span>

<h3>Description</h3>

<p>Fitting pressure-volume curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_PV_curve(
  data,
  varnames = list(psi = "psi", mass = "mass", leaf_mass = "leaf_mass", bag_mass =
    "bag_mass", leaf_area = "leaf_area"),
  title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_PV_curve_+3A_data">data</code></td>
<td>
<p>Dataframe</p>
</td></tr>
<tr><td><code id="fit_PV_curve_+3A_varnames">varnames</code></td>
<td>
<p>Variable names. varnames = list(psi = &quot;psi&quot;, mass =
&quot;mass&quot;, leaf_mass = &quot;leaf_mass&quot;, bag_mass = &quot;bag_mass&quot;, leaf_area =
&quot;leaf_area&quot;) where psi is leaf water potential in MPa, mass is the
weighed mass of the bag and leaf in g, leaf_mass is the mass of the
leaf in g, bag_mass is the mass of the bag in g, and leaf_area is
the area of the leaf in cm2.</p>
</td></tr>
<tr><td><code id="fit_PV_curve_+3A_title">title</code></td>
<td>
<p>Graph title</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit_PV_curve fits pressure-volume curve data to determine:
SWC: saturated water content per leaf mass (g H2O g leaf dry mass ^ -1),
PI_o: osmotic potential at full turgor (MPa), psi_TLP: leaf water
potential at turgor loss point (TLP) (MPa), RWC_TLP: relative water
content at TLP (%), eps: modulus of elasticity at full turgor (MPa),
C_FT: relative capacitance at full turgor (MPa ^ -1), C_TLP: relative
capacitance at TLP (MPa ^ -1), and C_FTStar: absolute capacitance per
leaf area (g m ^ -2 MPa ^ -1). Element 1 of the output list contains
the fitted parameters, element 2 contains the water-psi graph, and
element 3 contains the 1/psi-100-RWC graph.
</p>


<h3>References</h3>

<p>Koide RT, Robichaux RH, Morse SR, Smith CM. 2000. Plant water status,
hydraulic resistance and capacitance. In: Plant Physiological Ecology:
Field Methods and Instrumentation (eds RW Pearcy, JR Ehleringer, HA
Mooney, PW Rundel), pp. 161-183. Kluwer, Dordrecht, the Netherlands
</p>
<p>Sack L, Cowan PD, Jaikumar N, Holbrook NM. 2003. The 'hydrology' of
leaves: co-ordination of structure and function in temperate woody
species. Plant, Cell and Environment, 26, 1343-1356
</p>
<p>Tyree MT, Hammel HT. 1972. Measurement of turgor pressure and water
relations of plants by pressure bomb technique. Journal of Experimental
Botany, 23, 267
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in data
data &lt;- read.csv(system.file("extdata", "PV_curve.csv",
  package = "photosynthesis"
))

# Fit one PV curve
fit &lt;- fit_PV_curve(data[data$ID == "L2", ],
  varnames = list(
    psi = "psi",
    mass = "mass",
    leaf_mass = "leaf_mass",
    bag_mass = "bag_mass",
    leaf_area = "leaf_area"
  )
)

# See fitted parameters
fit[[1]]

# Plot water mass graph
fit[[2]]

# Plot PV Curve
fit[[3]]

# Fit all PV curves in a file
fits &lt;- fit_many(data,
  group = "ID",
  funct = fit_PV_curve,
  varnames = list(
    psi = "psi",
    mass = "mass",
    leaf_mass = "leaf_mass",
    bag_mass = "bag_mass",
    leaf_area = "leaf_area"
  )
)

# See parameters
fits[[1]][[1]]

# See water mass - water potential graph
fits[[1]][[2]]

# See PV curve
fits[[1]][[3]]

# Compile parameter outputs
pars &lt;- compile_data(
  data = fits,
  output_type = "dataframe",
  list_element = 1
)

# Compile the water mass - water potential graphs
graphs1 &lt;- compile_data(
  data = fits,
  output_type = "list",
  list_element = 2
)

# Compile the PV graphs
graphs2 &lt;- compile_data(
  data = fits,
  output_type = "list",
  list_element = 3
)

</code></pre>

<hr>
<h2 id='fit_r_light_kok'>Estimating light respiration</h2><span id='topic+fit_r_light_kok'></span><span id='topic+fit_r_light_WalkerOrt'></span><span id='topic+fit_r_light_yin'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p>Please use <code>fit_r_light2()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_r_light_kok(
  data,
  varnames = list(A_net = "A_net", PPFD = "PPFD"),
  PPFD_lower = 40,
  PPFD_upper = 100
)

fit_r_light_WalkerOrt(
  data,
  varnames = list(A_net = "A_net", C_i = "C_i", PPFD = "PPFD"),
  P = 100,
  C_i_threshold = 300
)

fit_r_light_yin(
  data,
  varnames = list(A_net = "A_net", PPFD = "PPFD", phi_PSII = "phi_PSII"),
  PPFD_lower = 40,
  PPFD_upper = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_r_light_kok_+3A_data">data</code></td>
<td>
<p>Dataframe</p>
</td></tr>
<tr><td><code id="fit_r_light_kok_+3A_varnames">varnames</code></td>
<td>
<p>List of variable names</p>
</td></tr>
<tr><td><code id="fit_r_light_kok_+3A_ppfd_lower">PPFD_lower</code></td>
<td>
<p>Lower light intensity limit for estimating Rlight
(Kok &amp; Yin)</p>
</td></tr>
<tr><td><code id="fit_r_light_kok_+3A_ppfd_upper">PPFD_upper</code></td>
<td>
<p>Upper light intensity limit for estimating Rlight
(Kok &amp; Yin)</p>
</td></tr>
<tr><td><code id="fit_r_light_kok_+3A_p">P</code></td>
<td>
<p>Atmospheric pressure in kPa (Walker &amp; Ort, 2015)</p>
</td></tr>
<tr><td><code id="fit_r_light_kok_+3A_c_i_threshold">C_i_threshold</code></td>
<td>
<p>Threshold C_i (in umol / mol) to cut data to
linear region for fitting light respiration and gamma_star
(Walker &amp; Ort, 2015)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit_r_light_kok estimates light respiration using the Kok method
(Kok, 1956). The Kok method involves looking for a breakpoint in the
light response of net CO2 assimilation at very low light intensities
and extrapolating from data above the breakpoint to estimate light
respiration as the y-intercept. r_light value should be negative,
denoting an efflux of CO2.
</p>
<p>fit_r_light_WalkerOrt estimates light respiration and
GammaStar according to Walk &amp; Ort (2015) using a slope-
intercept regression method to find the intercept of multiple
ACi curves run at multiple light intensities. Output GammaStar and
respiration should be negative If output respiration is positive
this could indicate issues (i.e. leaks) in the gas exchange
measurements. GammaStar is output in umol mol-1, and respiration
is output in umol m-2 s-1 of respiratory flux. Output is a list
containing the slope intercept regression model, a graph of the fit,
and estimates of the coefficients. NOTE: if using C_i, the output value
is technically C_istar. You need to use Cc to get GammaStar. Also note,
however, that the convention in the field is to completely ignore this note.
</p>
<p>fit_r_light_yin estimates light respiration according
to the Yin et al. (2009, 2011) modifications of the Kok
method. The modification uses fluorescence data to get a
better estimate of light respiration. Note that respiration
output should be negative here to denote an efflux of CO2.
</p>


<h3>References</h3>

<p>Kok B. 1956. On the inhibition of photosynthesis by intense light.
Biochimica et Biophysica Acta 21: 234244
</p>
<p>Walker BJ, Ort DR. 2015. Improved method for measuring the apparent
CO2 photocompensation point resolves the impact of multiple internal
conductances to CO2 to net gas exchange. Plant Cell Environ 38:2462-
2474
</p>
<p>Yin X, Struik PC, Romero P, Harbinson J, Evers JB, van der Putten
PEL, Vos J. 2009. Using combined measurements of gas exchange and
chlorophyll fluorescence to estimate parameters of a biochemical C3
photosynthesis model: a critical appraisal and a new integrated
approach applied to leaves in a wheat (Triticum aestivum) canopy.
Plant Cell Environ 32:448-464
</p>
<p>Yin X, Sun Z, Struik PC, Gu J. 2011. Evaluating a new method to
estimate the rate of leaf respiration in the light by analysis of
combined gas exchange and chlorophyll fluorescence measurements.
Journal of Experimental Botany 62: 34893499
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# FITTING KOK METHOD
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data = read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Fit light respiration with Kok method
r_light = fit_r_light_kok(
  data = data,
  varnames = list(
    A_net = "A",
    PPFD = "Qin"
  ),
  PPFD_lower = 20,
  PPFD_upper = 150
)
# Return r_light
r_light

# FITTING WALKER-ORT METHOD
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data = read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Fit the Walker-Ort method for GammaStar and light respiration
walker_ort = fit_r_light_WalkerOrt(data,
  varnames = list(
    A_net = "A",
    C_i = "Ci",
    PPFD = "Qin"
  )
)
# Extract model
summary(walker_ort[[1]])

# View graph
walker_ort[[2]]

# View coefficients
walker_ort[[3]]

# FITTING THE YIN METHOD
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data = read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Fit light respiration with Yin method
r_light = fit_r_light_yin(
  data = data,
  varnames = list(
    A_net = "A",
    PPFD = "Qin",
    phi_PSII = "PhiPS2"
  ),
  PPFD_lower = 20,
  PPFD_upper = 250
)


</code></pre>

<hr>
<h2 id='fit_r_light2'>Fit models to estimate light respiration (<code class="reqn">R_\mathrm{d}</code>)</h2><span id='topic+fit_r_light2'></span>

<h3>Description</h3>

<p>We recommend using <code><a href="#topic+fit_photosynthesis">fit_photosynthesis()</a></code> with argument <code>.photo_fun = "r_light"</code> rather than calling this function directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_r_light2(
  .data,
  .model = "default",
  .method = "ls",
  Q_lower = NA,
  Q_upper = NA,
  Q_levels = NULL,
  C_upper = NA,
  quiet = FALSE,
  brm_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_r_light2_+3A_.data">.data</code></td>
<td>
<p>A data frame containing plant ecophysiological data. See <code><a href="#topic+required_variables">required_variables()</a></code> for the variables required for each model.</p>
</td></tr>
<tr><td><code id="fit_r_light2_+3A_.model">.model</code></td>
<td>
<p>A character string of model name to use. See <code><a href="#topic+get_all_models">get_all_models()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_r_light2_+3A_.method">.method</code></td>
<td>
<p>A character string of the statistical method to use: 'ls' for least-squares and 'brms' for Bayesian model using <code><a href="brms.html#topic+brm">brms::brm()</a></code>. Default is 'ls'.</p>
</td></tr>
<tr><td><code id="fit_r_light2_+3A_q_lower">Q_lower</code></td>
<td>
<p>Lower light intensity limit for estimating Rd using <code>kok_1956</code> and <code>yin_etal_2011</code> models.</p>
</td></tr>
<tr><td><code id="fit_r_light2_+3A_q_upper">Q_upper</code></td>
<td>
<p>Upper light intensity limit for estimating Rd using <code>kok_1956</code> and <code>yin_etal_2011</code> models</p>
</td></tr>
<tr><td><code id="fit_r_light2_+3A_q_levels">Q_levels</code></td>
<td>
<p>A numeric vector of light intensity levels (<code class="reqn">\mu</code>mol / mol) for estimating <code class="reqn">R_\mathrm{d}</code> from the linear region of the A-C curve using the <code>walker_ort_2015</code> model.</p>
</td></tr>
<tr><td><code id="fit_r_light2_+3A_c_upper">C_upper</code></td>
<td>
<p>Upper C (<code class="reqn">\mu</code>mol / mol) limit for estimating <code class="reqn">R_\mathrm{d}</code> from the linear region of the A-C curve using the <code>walker_ort_2015</code> model.</p>
</td></tr>
<tr><td><code id="fit_r_light2_+3A_quiet">quiet</code></td>
<td>
<p>Flag. Should messages be suppressed? Default is FALSE.</p>
</td></tr>
<tr><td><code id="fit_r_light2_+3A_brm_options">brm_options</code></td>
<td>
<p>A list of options passed to <code><a href="brms.html#topic+brm">brms::brm()</a></code> if <code>.method = "brms"</code>. Default is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> If <code>.method = 'ls'</code>: an <code><a href="stats.html#topic+nls">stats::nls()</a></code> or <code><a href="stats.html#topic+lm">stats::lm()</a></code> object.
</p>
</li>
<li><p> If <code>.method = 'brms'</code>: a <code><a href="brms.html#topic+brmsfit-class">brms::brmsfit()</a></code> object.
</p>
</li></ul>



<h3>Note</h3>

<p>Confusingly, <code class="reqn">R_\mathrm{d}</code> typically denotes respiration in the light, but you might see <code class="reqn">R_\mathrm{day}</code> or <code class="reqn">R_\mathrm{light}</code>.
</p>
<p><strong>Models</strong>
</p>
<p><em>Kok (1956)</em>
</p>
<p>The <code>kok_1956</code> model estimates light respiration using the Kok method
(Kok, 1956). The Kok method involves looking for a breakpoint in the
light response of net CO2 assimilation at very low light intensities
and extrapolating from data above the breakpoint to estimate light
respiration as the y-intercept. Rd value should be negative,
denoting an efflux of CO2.
</p>
<p><em>Yin et al. (2011)</em>
</p>
<p>The <code>yin_etal_2011</code> model estimates light respiration according
to the Yin <em>et al.</em> (2009, 2011) modifications of the Kok
method. The modification uses fluorescence data to get a
better estimate of light respiration. Rd values should be negative here to
denote an efflux of CO2.
</p>
<p><em>Walker &amp; Ort (2015)</em>
</p>
<p>The <code>walker_ort_2015</code> model estimates light respiration and
<code class="reqn">\Gamma*</code> according to Walker &amp; Ort (2015) using a slope-
intercept regression method to find the intercept of multiple
A-C curves run at multiple light intensities. The method estimates
<code class="reqn">\Gamma*</code> and <code class="reqn">R_\mathrm{d}</code>. If estimated  <code class="reqn">R_\mathrm{d}</code> is
positive this could indicate issues (i.e. leaks) in the gas exchange
measurements. <code class="reqn">\Gamma*</code> is in units of umol / mol and <code class="reqn">R_\mathrm{d}</code>
is in units of <code class="reqn">\mu</code>mol m<code class="reqn">^{-2}</code> s<code class="reqn">^{-1}</code> of respiratory flux.
If using <code class="reqn">C_\mathrm{i}</code>, the estimated value is technically <code class="reqn">C_\mathrm{i}</code>*.
You need to use <code class="reqn">C_\mathrm{c}</code> to get <code class="reqn">\Gamma*</code> Also note, however,
that the convention in the field is to completely ignore this note.
</p>


<h3>References</h3>

<p>Kok B. 1956. On the inhibition of photosynthesis by intense light.
Biochimica et Biophysica Acta 21: 234244
</p>
<p>Walker BJ, Ort DR. 2015. Improved method for measuring the apparent
CO2 photocompensation point resolves the impact of multiple internal
conductances to CO2 to net gas exchange. Plant Cell Environ 38:2462-
2474
</p>
<p>Yin X, Struik PC, Romero P, Harbinson J, Evers JB, van der Putten
PEL, Vos J. 2009. Using combined measurements of gas exchange and
chlorophyll fluorescence to estimate parameters of a biochemical C3
photosynthesis model: a critical appraisal and a new integrated
approach applied to leaves in a wheat (Triticum aestivum) canopy.
Plant Cell Environ 32:448-464
</p>
<p>Yin X, Sun Z, Struik PC, Gu J. 2011. Evaluating a new method to
estimate the rate of leaf respiration in the light by analysis of
combined gas exchange and chlorophyll fluorescence measurements.
Journal of Experimental Botany 62: 34893499
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Walker &amp; Ort (2015) model

library(broom)
library(dplyr)
library(photosynthesis)

acq_data = system.file("extdata", "A_Ci_Q_data_1.csv", package = "photosynthesis") |&gt; 
  read.csv()

fit = fit_photosynthesis(
  .data = acq_data,
  .photo_fun = "r_light",
  .model = "walker_ort_2015",
  .vars = list(.A = A, .Q = Qin, .C = Ci),
  C_upper = 300,
  # Irradiance levels used in experiment
  Q_levels =  c(1500, 750, 375, 125, 100, 75, 50, 25),
)

# The 'fit' object inherits class 'lm' and many methods can be used

## Model summary:
summary(fit)

## Estimated parameters:
coef(fit)

## 95% confidence intervals:
## n.b. these confidence intervals are not correct because the regression is fit 
## sequentially. It ignores the underlying data and uncertainty in estimates of 
## slopes and intercepts with each A-C curve. Use '.method = "brms"' to properly 
## calculate uncertainty. 
confint(fit)

## Tidy summary table using 'broom::tidy()'
tidy(fit, conf.int = TRUE, conf.level = 0.95)

## Calculate residual sum-of-squares
sum(resid(fit)^2)

# Yin et al. (2011) model

fit = fit_photosynthesis(
  .data = acq_data,
  .photo_fun = "r_light",
  .model = "yin_etal_2011",
  .vars = list(.A = A, .phiPSII = PhiPS2, .Q = Qin),
  Q_lower = 20,
  Q_upper = 250
)

# The 'fit' object inherits class 'lm' and many methods can be used

## Model summary:
summary(fit)

## Estimated parameters:
coef(fit)

## 95% confidence intervals:
confint(fit)

## Tidy summary table using 'broom::tidy()'
tidy(fit, conf.int = TRUE, conf.level = 0.95)

## Calculate residual sum-of-squares
sum(resid(fit)^2)

# Kok (1956) model

fit = fit_photosynthesis(
  .data = acq_data,
  .photo_fun = "r_light",
  .model = "kok_1956",
  .vars = list(.A = A, .Q = Qin),
  Q_lower = 20,
  Q_upper = 150
)

# The 'fit' object inherits class 'lm' and many methods can be used

## Model summary:
summary(fit)

## Estimated parameters:
coef(fit)

## 95% confidence intervals:
confint(fit)

## Tidy summary table using 'broom::tidy()'
tidy(fit, conf.int = TRUE, conf.level = 0.95)

## Calculate residual sum-of-squares
sum(resid(fit)^2)


</code></pre>

<hr>
<h2 id='fit_t_response'>Fitting temperature responses</h2><span id='topic+fit_t_response'></span>

<h3>Description</h3>

<p>Fitting temperature responses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_t_response(
  data,
  varnames = list(Par = "Par", T_leaf = "T_leaf"),
  model = c("Arrhenius", "Kruse", "Heskel", "Medlyn", "MMRT", "Quadratic", "Topt"),
  start = list(a = 1, b = 1, c = 1, dEa = 1, Ea_ref = 1, Par_ref = 1, Ea = 40000, Par25 =
    50, Hd = 2e+05, dS = 650, dCp = 1, dG = 1, dH = 1),
  setvar = "none",
  hdset = 2e+05,
  dSset = 650,
  title = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_t_response_+3A_data">data</code></td>
<td>
<p>Dataframe with temperature response variables</p>
</td></tr>
<tr><td><code id="fit_t_response_+3A_varnames">varnames</code></td>
<td>
<p>Variable names, where Par is the parameter of interest, and
T_leaf is the leaf temperature in K.</p>
</td></tr>
<tr><td><code id="fit_t_response_+3A_model">model</code></td>
<td>
<p>Which temperature response model do you want to use? Defaults
to all: Arrhenius, Heskel, Kruse, Medlyn, MMRT, Quadratic, and Topt.</p>
</td></tr>
<tr><td><code id="fit_t_response_+3A_start">start</code></td>
<td>
<p>List of starting parameters for the nls model fits. a, b, and c
are needed for the Heskel model, dEa, Ea_ref, and Par_ref are needed for the
Kruse model, Ea, Par25, and Hd are all needed for the Medlyn and Topt models
while the Medlyn model also requires dS, and dCP, dG, and dH are all for the
MMRT model.</p>
</td></tr>
<tr><td><code id="fit_t_response_+3A_setvar">setvar</code></td>
<td>
<p>Which variable to set as constant for the Medlyn model?
Defaults to &quot;none&quot;, while &quot;Hd&quot; and &quot;dS&quot; options are available.</p>
</td></tr>
<tr><td><code id="fit_t_response_+3A_hdset">hdset</code></td>
<td>
<p>Which value should Hd be set to when setvar = &quot;Hd&quot;? Specify
in J/mol.</p>
</td></tr>
<tr><td><code id="fit_t_response_+3A_dsset">dSset</code></td>
<td>
<p>Which value should dS be set to when setvar = &quot;dS&quot;? Specify
in J/mol/K.</p>
</td></tr>
<tr><td><code id="fit_t_response_+3A_title">title</code></td>
<td>
<p>Title of output graphs</p>
</td></tr>
<tr><td><code id="fit_t_response_+3A_...">...</code></td>
<td>
<p>Further arguments to pass on to the nlsLM() function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit_t_response fits one or more temperature response models to a
dataset, returning a list of lists. The parent list contains the models,
while the child list for each model contains the fitted model in element
1, the coefficients in element 2, and a graph in element 3.
</p>


<h3>References</h3>

<p>Arrhenius S. 1915. Quantitative laws in biological chemistry. Bell.
</p>
<p>Heskel MA, O'Sullivan OS, Reich PB, Tjoelker MG, Weerasinghe LK,
Penillard A, Egerton JJG, Creek D, Bloomfield KJ, Xiang J, Sinca F,
Stangl ZR, la Torre AM, Griffin KL, Huntingford C, Hurry V, Meir P,
Turnbull MH, Atkin OK. 2016. Convergence in the temperature response
of leaf respiration across biomes and plant functional types. PNAS
113:3832-3837
</p>
<p>Hobbs JK, Jiao W, Easter AD, Parker EJ, Schipper LA, Arcus VL.
2013. Change in heat capacity for enzyme catalysis determines
temperature dependence of enzyme catalyzed rates. ACS Chemical
Biology 8:2388-2393.
</p>
<p>Kruse J, Adams MA. 2008. Three parameters comprehensively describe
the temperature response of respiratory oxygen reduction. Plant
Cell Environ 31:954-967
</p>
<p>Liang LL, Arcus VL, Heskel MA, O'Sullivan OS, Weerasinghe LK,
Creek D, Egerton JJG, Tjoelker MG, Atkin OK, Schipper LA. 2018.
Macromolecular rate theory (MMRT) provides a thermodynamics
rationale to underpin the convergent temperature response in
plant leaf respiration. Glob Chang Biol 24:1538-1547
</p>
<p>Medlyn BE, Dreyer E, Ellsworth D, Forstreuter M, Harley PC,
Kirschbaum MUF, Le Roux X, Montpied P, Strassemeyer J, Walcroft A,
Wang K, Loutstau D. 2002. Temperature response of parameters of a
biochemically based model of photosynthesis. II. A review of
experimental data. Plant Cell Environ 25:1167-1179
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in data
data &lt;- read.csv(system.file("extdata", "A_Ci_T_data.csv",
  package = "photosynthesis"
),
stringsAsFactors = FALSE
)

library(tidyr)

# Round temperatures to group them appropriately
# Use sequential rounding
data$T2 &lt;- round(data$Tleaf, 1)
data$T2 &lt;- round(data$Tleaf, 0)

# Look at unique values to detect rounding issues
unique(data$T2)

# Some still did not round correctly,
# manually correct
for (i in 1:nrow(data)) {
  if (data$T2[i] == 18) {
    data$T2[i] &lt;- 17
  }
  if (data$T2[i] == 23) {
    data$T2[i] &lt;- 22
  }
  if (data$T2[i] == 28) {
    data$T2[i] &lt;- 27
  }
  if (data$T2[i] == 33) {
    data$T2[i] &lt;- 32
  }
  if (data$T2[i] == 38) {
    data$T2[i] &lt;- 37
  }
}

# Make sure it is a character string for grouping
data$T2 &lt;- as.character(data$T2)

# Create grouping variable by ID and measurement temperature
data &lt;- unite(data,
  col = "ID2", c("ID", "T2"),
  sep = "_"
)

# Split by temperature group
data &lt;- split(data, data$ID2)

# Obtain mean temperature for group so temperature
# response fitting is acceptable later, round to
# 2 decimal places
for (i in 1:length(data)) {
  data[[i]]$Curve_Tleaf &lt;- round(mean(data[[i]]$Tleaf), 2)
}

# Convert from list back to dataframe
data &lt;- do.call("rbind", data)

# Parse grouping variable by ID and measurement temperature
data &lt;- separate(data,
  col = "ID2", into = c("ID", "T2"),
  sep = "_"
)

# Make sure number of values matches number of measurement
# temperatures. May vary slightly if plants had slightly
# different leaf temperatures during the measurements
unique(data$Curve_Tleaf)

# Create ID column to curve fit by ID and temperature
data &lt;- unite(data,
  col = "ID2", c("ID", "Curve_Tleaf"),
  sep = "_"
)

# Convert leaf temperature to K
data$T_leaf &lt;- data$Tleaf + 273.15

# Fit many CO2 response curves
fits2 &lt;- fit_many(
  data = data,
  group = "ID2",
  varnames = list(
    A_net = "A",
    C_i = "Ci",
    T_leaf = "T_leaf",
    PPFD = "Qin",
    g_mc = "g_mc"
  ),
  funct = fit_aci_response,
  alphag = 0
)

# Extract ACi parameters
pars &lt;- compile_data(fits2,
  output_type = "dataframe",
  list_element = 1
)

# Extract ACi graphs
graphs &lt;- compile_data(fits2,
  output_type = "list",
  list_element = 2
)

# Parse the ID variable
pars &lt;- separate(pars, col = "ID", into = c("ID", "Curve_Tleaf"), sep = "_")

# Make sure curve leaf temperature is numeric
pars$Curve_Tleaf &lt;- as.numeric(pars$Curve_Tleaf)
pars$T_leaf &lt;- pars$Curve_Tleaf + 273.15

# Fit all models, set Hd to constant in Medlyn model
out &lt;- fit_t_response(
  data = pars[pars$ID == "S2", ],
  varnames = list(
    Par = "V_cmax",
    T_leaf = "T_leaf"
  ),
  setvar = "Hd",
  hdset = 200000
)

out[["Arrhenius"]][["Graph"]]
out[["Heskel"]][["Graph"]]
out[["Kruse"]][["Graph"]]
out[["Medlyn"]][["Graph"]]
out[["MMRT"]][["Graph"]]
out[["Quadratic"]][["Graph"]]
out[["Topt"]][["Graph"]]

</code></pre>

<hr>
<h2 id='FvCB'>Farquhar-von Caemmerer-Berry (FvCB) C3 photosynthesis model</h2><span id='topic+FvCB'></span><span id='topic+W_carbox'></span><span id='topic+W_regen'></span><span id='topic+W_tpu'></span>

<h3>Description</h3>

<p>Farquhar-von Caemmerer-Berry (FvCB) C3 photosynthesis model
</p>
<p>Rubisco-limited assimilation rate
</p>
<p>RuBP regeneration-limited assimilation rate
</p>
<p>TPU-limited assimilation rate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FvCB(C_chl, pars, unitless = FALSE)

W_carbox(C_chl, pars, unitless = FALSE)

W_regen(C_chl, pars, unitless = FALSE)

W_tpu(C_chl, pars, unitless = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FvCB_+3A_c_chl">C_chl</code></td>
<td>
<p>Chloroplastic CO2 concentration in Pa of class <code>units</code></p>
</td></tr>
<tr><td><code id="FvCB_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id="FvCB_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should <code>units</code> be set? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equations following Buckley and Diaz-Espejo (2015): <br />
<br />
<strong>Rubisco-limited assimilation rate:</strong> <br />
<br />
</p>
<p style="text-align: center;"><code class="reqn">W_\mathrm{carbox} = V_\mathrm{c,max} C_\mathrm{chl} / (C_\mathrm{chl} + K_\mathrm{m})</code>
</p>

<p>where:
</p>
<p style="text-align: center;"><code class="reqn">K_\mathrm{m} = K_\mathrm{C} (1 + O / K_\mathrm{O})</code>
</p>

<p><strong>RuBP regeneration-limited assimilation rate:</strong> <br />
<br />
</p>
<p style="text-align: center;"><code class="reqn">W_\mathrm{regen} = J C_\mathrm{chl} / (4 C_\mathrm{chl} + 8 \Gamma*)</code>
</p>

<p>where <code class="reqn">J</code> is a function of PPFD, obtained by solving the equation:
</p>
<p style="text-align: center;"><code class="reqn">0 = \theta_J J ^ 2 - J (J_\mathrm{max} + \phi_J PPFD) + J_\mathrm{max} \phi_J PPFD</code>
</p>

<p><strong>TPU-limited assimilation rate:</strong> <br />
</p>
<p style="text-align: center;"><code class="reqn">W_\mathrm{tpu} = 3 V_\mathrm{tpu} C_\mathrm{chl} / (C_\mathrm{chl} - \Gamma*)</code>
</p>

<p><br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">C_\mathrm{chl}</code> </td><td style="text-align: left;"> <code>C_chl</code> </td><td style="text-align: left;"> chloroplastic CO2 concentration </td><td style="text-align: left;"> Pa </td><td style="text-align: left;"> input </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\Gamma*</code> </td><td style="text-align: left;"> <code>gamma_star</code> </td><td style="text-align: left;"> chloroplastic CO2 compensation point (T_leaf) </td><td style="text-align: left;"> Pa </td><td style="text-align: left;"> <a href="#topic+bake">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">J_\mathrm{max}</code> </td><td style="text-align: left;"> <code>J_max</code> </td><td style="text-align: left;"> potential electron transport (T_leaf) </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol CO2 / (m<code class="reqn">^2</code> s) </td><td style="text-align: left;"> <a href="#topic+bake">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">K_\mathrm{C}</code> </td><td style="text-align: left;"> <code>K_C</code> </td><td style="text-align: left;"> Michaelis constant for carboxylation (T_leaf) </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol / mol </td><td style="text-align: left;"> <a href="#topic+bake">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">K_\mathrm{O}</code> </td><td style="text-align: left;"> <code>K_O</code> </td><td style="text-align: left;"> Michaelis constant for oxygenation (T_leaf) </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol / mol </td><td style="text-align: left;"> <a href="#topic+bake">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">O</code> </td><td style="text-align: left;"> <code>O</code> </td><td style="text-align: left;"> atmospheric O2 concentration </td><td style="text-align: left;"> kPa </td><td style="text-align: left;"> 21.27565 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\phi_J</code> </td><td style="text-align: left;"> <code>phi_J</code> </td><td style="text-align: left;"> initial slope of the response of J to PPFD </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.331 </td>
</tr>
<tr>
 <td style="text-align: left;">
PPFD </td><td style="text-align: left;"> <code>PPFD</code> </td><td style="text-align: left;"> photosynthetic photon flux density </td><td style="text-align: left;"> umol quanta / (m^2 s) </td><td style="text-align: left;"> 1500 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">R_\mathrm{d}</code> </td><td style="text-align: left;"> <code>R_d</code> </td><td style="text-align: left;"> nonphotorespiratory CO2 release (T_leaf) </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol CO2 / (m<code class="reqn">^2</code> s) </td><td style="text-align: left;"> <a href="#topic+bake">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\theta_J</code> </td><td style="text-align: left;"> <code>theta_J</code> </td><td style="text-align: left;"> curvature factor for light-response curve </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.825 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">V_\mathrm{c,max}</code> </td><td style="text-align: left;"> <code>V_cmax</code> </td><td style="text-align: left;"> maximum rate of carboxylation (T_leaf) </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol CO2 / (m<code class="reqn">^2</code> s) </td><td style="text-align: left;"> <a href="#topic+bake">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">V_\mathrm{tpu}</code> </td><td style="text-align: left;"> <code>V_tpu</code> </td><td style="text-align: left;"> rate of triose phosphate utilization (T_leaf) </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol CO2 / (m<code class="reqn">^2</code> s) </td><td style="text-align: left;"> <a href="#topic+bake">calculated</a>
</td>
</tr>

</table>



<h3>Value</h3>

<p>A list of four values with units umol CO2 / (m^2 s) of class <code>units</code>:
<br />
</p>

<ul>
<li> <p><code>W_carbox</code>: Rubisco-limited assimilation rate <br />
</p>
</li>
<li> <p><code>W_regen</code>: RuBP regeneration-limited assimilation rate <br />
</p>
</li>
<li> <p><code>W_tpu</code>: TPU-limited assimilation rate <br />
</p>
</li>
<li> <p><code>A</code>: minimum of W_carbox, W_regen, and W_tpu
</p>
</li></ul>



<h3>References</h3>

<p>Buckley TN and Diaz-Espejo A. 2015. Partitioning changes in photosynthetic
rate into contributions from different variables. Plant, Cell &amp; Environment
38: 1200-11.
</p>
<p>Farquhar GD, Caemmerer S, Berry JA. 1980. A biochemical model of
photosynthetic CO2 assimilation in leaves of C3 species. Planta 149: 7890.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bake_par = make_bakepar()
constants = make_constants(use_tealeaves = FALSE)
enviro_par = make_enviropar(use_tealeaves = FALSE)
leaf_par = make_leafpar(use_tealeaves = FALSE)
leaf_par = bake(leaf_par, enviro_par, bake_par, constants)

pars = c(leaf_par, enviro_par, constants)
C_chl = set_units(246.0161, umol / mol)
FvCB(C_chl, pars)
</code></pre>

<hr>
<h2 id='get_default_model'>Get default model</h2><span id='topic+get_default_model'></span><span id='topic+get_all_models'></span><span id='topic+marshall_biscoe_1980'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Get the name of the default model used for different plant ecophysiological data analysis methods implemented in <strong>photosynthesis</strong>. Currently only used for <code><a href="#topic+fit_aq_response2">fit_aq_response2()</a></code> and <code><a href="#topic+fit_r_light2">fit_r_light2()</a></code>.
</p>
<p><strong>Light response models:</strong>
</p>

<ul>
<li> <p><code>marshall_biscoe_1980()</code>: Non-rectangular hyperbolic model of light responses
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>get_default_model(.photo_fun)

get_all_models(method)

marshall_biscoe_1980(Q_abs, k_sat, phi_J, theta_J)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_default_model_+3A_.photo_fun">.photo_fun</code></td>
<td>
<p>A character string of <strong>photosynthesis</strong> function to call. One of: <code style="white-space: pre;">&#8288;aq_response, r_light&#8288;</code>.</p>
</td></tr>
<tr><td><code id="get_default_model_+3A_method">method</code></td>
<td>
<p>A character string of the statistical method to use: 'ls' for least-squares and 'brms' for Bayesian model using <code><a href="brms.html#topic+brm">brms::brm()</a></code>. Default is 'ls'.</p>
</td></tr>
<tr><td><code id="get_default_model_+3A_q_abs">Q_abs</code></td>
<td>
<p>Absorbed light intensity (<code class="reqn">\mu</code>mol m<code class="reqn">^{-2}</code> s<code class="reqn">^{-1}</code>)</p>
</td></tr>
<tr><td><code id="get_default_model_+3A_k_sat">k_sat</code></td>
<td>
<p>Light saturated rate of process k</p>
</td></tr>
<tr><td><code id="get_default_model_+3A_phi_j">phi_J</code></td>
<td>
<p>Quantum efficiency of process k</p>
</td></tr>
<tr><td><code id="get_default_model_+3A_theta_j">theta_J</code></td>
<td>
<p>Curvature of the light response</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string with name of model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_default_model("aq_response")
get_default_model("r_light")

</code></pre>

<hr>
<h2 id='gs_mod_ballberry'>Stomatal conductance models</h2><span id='topic+gs_mod_ballberry'></span><span id='topic+gs_mod_leuning'></span><span id='topic+gs_mod_opti'></span><span id='topic+gs_mod_optifull'></span>

<h3>Description</h3>

<p>Stomatal conductance models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gs_mod_ballberry(A_net, C_air, RH)

gs_mod_leuning(A_net, C_air, D0, VPD)

gs_mod_opti(g0, g1, VPD, A_net, C_air)

gs_mod_optifull(g0, g1, gk, VPD, A_net, C_air)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gs_mod_ballberry_+3A_a_net">A_net</code></td>
<td>
<p>Net CO2 assimilation in umol m-2 s-1</p>
</td></tr>
<tr><td><code id="gs_mod_ballberry_+3A_c_air">C_air</code></td>
<td>
<p>CO2 concentration at the leaf surface in umol mol-1</p>
</td></tr>
<tr><td><code id="gs_mod_ballberry_+3A_rh">RH</code></td>
<td>
<p>Relative humidity as a proportion</p>
</td></tr>
<tr><td><code id="gs_mod_ballberry_+3A_d0">D0</code></td>
<td>
<p>Vapor pressure sensitivity of stomata (Leuning 1995)</p>
</td></tr>
<tr><td><code id="gs_mod_ballberry_+3A_vpd">VPD</code></td>
<td>
<p>Vapor pressure deficit (kPa)</p>
</td></tr>
<tr><td><code id="gs_mod_ballberry_+3A_g0">g0</code></td>
<td>
<p>Optimization model intercept term (Medlyn et al. 2011)</p>
</td></tr>
<tr><td><code id="gs_mod_ballberry_+3A_g1">g1</code></td>
<td>
<p>Optimization model slope term (Medlyn et al. 2011)</p>
</td></tr>
<tr><td><code id="gs_mod_ballberry_+3A_gk">gk</code></td>
<td>
<p>Optimization model root term (Medlyn et al. 2011)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>gs_mod_ballberry is used for fitting the Ball et al. (1987) model
of stomatal conductance
</p>
<p>gs_mod_leuning is used for fitting the Leuning (1995) model
of stomatal conductance
</p>
<p>gs_mod_opti fits the optimal stomatal conductance model according to
Medlyn et al. 2011
</p>
<p>gs_mod_optifull fits the full optimal stomatal conductance model according
to Medlyn et al. 2011
</p>


<h3>References</h3>

<p>Ball JT, Woodrow IE, Berry JA. 1987. A model predicting stomatal
conductance and its contribution to the control of photosynthesis
under different environmental conditions, in Progress in
Photosynthesis Research, Proceedings of the VII International
Congress on Photosynthesis, vol. 4, edited by I. Biggins, pp.
221224, Martinus Nijhoff, Dordrecht, Netherlands.
</p>
<p>Leuning R. 1995. A critical appraisal of a coupled stomatal-
photosynthesis model for C3 plants. Plant Cell Environ 18:339-357
</p>
<p>Medlyn BE, Duursma RA, Eamus D, Ellsworth DS, Prentice IC, Barton
CVM, Crous KY, Angelis PD, Freeman M, Wingate L. 2011. Reconciling
the optimal and empirical approaches to modeling stomatal
conductance. Glob Chang Biol 17:2134-2144
</p>

<hr>
<h2 id='J'>J: Rate of electron transport (umol/m^2/s)</h2><span id='topic+J'></span>

<h3>Description</h3>

<p>Calculate the rate of electron transport as a function of photosynthetic photon flux density (PPFD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>J(pars, unitless = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="J_+3A_pars">pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td></tr>
<tr><td><code id="J_+3A_unitless">unitless</code></td>
<td>
<p>Logical. Should <code>units</code> be set? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">J</code> as a function of PPFD is the solution to the quadratic expression:
</p>
<p style="text-align: center;"><code class="reqn">0 = \theta_J J ^ 2 - J (J_\mathrm{max} + \phi_J PPFD) + J_\mathrm{max} \phi_J PPFD</code>
</p>


<table>
<tr>
 <td style="text-align: left;">
<em>Symbol</em> </td><td style="text-align: left;"> <em>R</em> </td><td style="text-align: left;"> <em>Description</em> </td><td style="text-align: left;"> <em>Units</em> </td><td style="text-align: left;"> <em>Default</em></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">J_\mathrm{max}</code> </td><td style="text-align: left;"> <code>J_max</code> </td><td style="text-align: left;"> potential electron transport (T_leaf) </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol CO2 / (m<code class="reqn">^2</code> s) </td><td style="text-align: left;"> <a href="#topic+bake">calculated</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\phi_J</code> </td><td style="text-align: left;"> <code>phi_J</code> </td><td style="text-align: left;"> initial slope of the response of J to PPFD </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.331 </td>
</tr>
<tr>
 <td style="text-align: left;">
PPFD </td><td style="text-align: left;"> <code>PPFD</code> </td><td style="text-align: left;"> photosynthetic photon flux density </td><td style="text-align: left;"> <code class="reqn">\mu</code>mol quanta / (m^2 s) </td><td style="text-align: left;"> 1500 </td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\theta_J</code> </td><td style="text-align: left;"> <code>theta_J</code> </td><td style="text-align: left;"> curvature factor for light-response curve </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.825
</td>
</tr>

</table>



<h3>Value</h3>

<p>Value in <code class="reqn">\mu</code>mol/ (m^2 s) of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)
library(photosynthesis)

bake_par = make_bakepar()
constants = make_constants(use_tealeaves = FALSE)
enviro_par = make_enviropar(use_tealeaves = FALSE)
leaf_par = make_leafpar(use_tealeaves = FALSE)
enviro_par$T_air = leaf_par$T_leaf
leaf_par %&lt;&gt;% bake(enviro_par, bake_par, constants)

pars = c(leaf_par, enviro_par, constants)
J(pars, FALSE)
</code></pre>

<hr>
<h2 id='leaf_par'>S3 class leaf_par</h2><span id='topic+leaf_par'></span>

<h3>Description</h3>

<p>S3 class leaf_par
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leaf_par(.x, use_tealeaves)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leaf_par_+3A_.x">.x</code></td>
<td>
<p>A list to be constructed into <strong>leaf_par</strong>.</p>
</td></tr>
<tr><td><code id="leaf_par_+3A_use_tealeaves">use_tealeaves</code></td>
<td>
<p>Logical. Should leaf energy balance be used to calculate leaf temperature (T_leaf)? If TRUE, <code><a href="tealeaves.html#topic+tleaves">tleaf()</a></code> calculates T_leaf. If FALSE, user-defined T_leaf is used. Additional parameters and constants are required, see <code><a href="#topic+make_parameters">make_parameters()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Constructor function for leaf_par class. This function ensures that leaf
parameter inputs are properly formatted.
</p>

<hr>
<h2 id='make_parameters'>Make lists of parameters for <code>photosynthesis</code></h2><span id='topic+make_parameters'></span><span id='topic+make_leafpar'></span><span id='topic+make_enviropar'></span><span id='topic+make_bakepar'></span><span id='topic+make_constants'></span>

<h3>Description</h3>

<p>Make lists of parameters for <code>photosynthesis</code>
</p>
<p>make_leafpar
</p>
<p>make_enviropar
</p>
<p>make_bakepar
</p>
<p>make_constants
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_leafpar(replace = NULL, use_tealeaves)

make_enviropar(replace = NULL, use_tealeaves)

make_bakepar(replace = NULL)

make_constants(replace = NULL, use_tealeaves)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_parameters_+3A_replace">replace</code></td>
<td>
<p>A named list of parameters to replace defaults.
If <code>NULL</code>, defaults will be used.</p>
</td></tr>
<tr><td><code id="make_parameters_+3A_use_tealeaves">use_tealeaves</code></td>
<td>
<p>Logical. Should leaf energy balance be used to calculate leaf temperature (T_leaf)? If TRUE, <code><a href="tealeaves.html#topic+tleaves">tleaf()</a></code> calculates T_leaf. If FALSE, user-defined T_leaf is used. Additional parameters and constants are required, see <code><a href="#topic+make_parameters">make_parameters()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Constants:</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_{\mathrm{c},0}</code> </td><td style="text-align: left;"> <code>D_c0</code> </td><td style="text-align: left;"> diffusion coefficient for CO2 in air at 0 째C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <code class="reqn">1.29\times 10^{-5}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_{\mathrm{h},0}</code> </td><td style="text-align: left;"> <code>D_h0</code> </td><td style="text-align: left;"> diffusion coefficient for heat in air at 0 째C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <code class="reqn">1.90\times 10^{-5}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_{\mathrm{m},0}</code> </td><td style="text-align: left;"> <code>D_m0</code> </td><td style="text-align: left;"> diffusion coefficient for momentum in air at 0 째C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <code class="reqn">1.33\times 10^{-5}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_{\mathrm{w},0}</code> </td><td style="text-align: left;"> <code>D_w0</code> </td><td style="text-align: left;"> diffusion coefficient for water vapor in air at 0 째C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <code class="reqn">2.12\times 10^{-5}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\epsilon</code> </td><td style="text-align: left;"> <code>epsilon</code> </td><td style="text-align: left;"> ratio of water to air molar masses </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.622 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">G</code> </td><td style="text-align: left;"> <code>G</code> </td><td style="text-align: left;"> gravitational acceleration </td><td style="text-align: left;"> m / s<code class="reqn">^2</code> </td><td style="text-align: left;"> 9.8 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">eT</code> </td><td style="text-align: left;"> <code>eT</code> </td><td style="text-align: left;"> exponent for temperature dependence of diffusion </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1.75 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">R</code> </td><td style="text-align: left;"> <code>R</code> </td><td style="text-align: left;"> ideal gas constant </td><td style="text-align: left;"> J / mol / K </td><td style="text-align: left;"> 8.31 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\sigma</code> </td><td style="text-align: left;"> <code>sigma</code> </td><td style="text-align: left;"> Stephan-Boltzmann constant </td><td style="text-align: left;"> W / m<code class="reqn">^2</code> / K<code class="reqn">^4</code> </td><td style="text-align: left;"> <code class="reqn">5.67\times 10^{-8}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">f_\mathrm{Sh}</code> </td><td style="text-align: left;"> <code>f_sh</code> </td><td style="text-align: left;"> function to calculate constant(s) for Sherwood number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">f_\mathrm{Nu}</code> </td><td style="text-align: left;"> <code>f_nu</code> </td><td style="text-align: left;"> function to calculate constant(s) for Nusselt number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Baking (i.e. temperature response) parameters:</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_\mathrm{s,gmc}</code> </td><td style="text-align: left;"> <code>Ds_gmc</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol / K </td><td style="text-align: left;"> 487 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_\mathrm{s,Jmax}</code> </td><td style="text-align: left;"> <code>Ds_Jmax</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol / K </td><td style="text-align: left;"> 388 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,\Gamma *}</code> </td><td style="text-align: left;"> <code>Ea_gammastar</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 24500 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,gmc}</code> </td><td style="text-align: left;"> <code>Ea_gmc</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 68900 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,Jmax}</code> </td><td style="text-align: left;"> <code>Ea_Jmax</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 56100 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,KC}</code> </td><td style="text-align: left;"> <code>Ea_KC</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 81000 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,KO}</code> </td><td style="text-align: left;"> <code>Ea_KO</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 23700 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,Rd}</code> </td><td style="text-align: left;"> <code>Ea_Rd</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 40400 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,Vcmax}</code> </td><td style="text-align: left;"> <code>Ea_Vcmax</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 52200 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,Vtpu}</code> </td><td style="text-align: left;"> <code>Ea_Vtpu</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 52200 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{d,gmc}</code> </td><td style="text-align: left;"> <code>Ed_gmc</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 149000 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{d,Jmax}</code> </td><td style="text-align: left;"> <code>Ed_Jmax</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 121000 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Environment parameters:</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">C_\mathrm{air}</code> </td><td style="text-align: left;"> <code>C_air</code> </td><td style="text-align: left;"> atmospheric CO2 concentration </td><td style="text-align: left;"> umol/mol </td><td style="text-align: left;"> 420 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">O</code> </td><td style="text-align: left;"> <code>O</code> </td><td style="text-align: left;"> atmospheric O2 concentration </td><td style="text-align: left;"> mol/mol </td><td style="text-align: left;"> 0.21 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">P</code> </td><td style="text-align: left;"> <code>P</code> </td><td style="text-align: left;"> atmospheric pressure </td><td style="text-align: left;"> kPa </td><td style="text-align: left;"> 101 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\mathrm{PPFD}</code> </td><td style="text-align: left;"> <code>PPFD</code> </td><td style="text-align: left;"> photosynthetic photon flux density </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 1500 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\mathrm{RH}</code> </td><td style="text-align: left;"> <code>RH</code> </td><td style="text-align: left;"> relative humidity </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">u</code> </td><td style="text-align: left;"> <code>wind</code> </td><td style="text-align: left;"> windspeed </td><td style="text-align: left;"> m / s </td><td style="text-align: left;"> 2 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Leaf parameters:</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">d</code> </td><td style="text-align: left;"> <code>leafsize</code> </td><td style="text-align: left;"> leaf characteristic dimension </td><td style="text-align: left;"> m </td><td style="text-align: left;"> 0.1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\Gamma*</code> </td><td style="text-align: left;"> <code>gamma_star</code> </td><td style="text-align: left;"> chloroplastic CO2 compensation point (T_leaf) </td><td style="text-align: left;"> umol/mol </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\Gamma*_{25}</code> </td><td style="text-align: left;"> <code>gamma_star25</code> </td><td style="text-align: left;"> chloroplastic CO2 compensation point (25 째C) </td><td style="text-align: left;"> umol/mol </td><td style="text-align: left;"> 37.9 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{mc}</code> </td><td style="text-align: left;"> <code>g_mc</code> </td><td style="text-align: left;"> mesophyll conductance to CO2 (T_leaf) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{mc,25}</code> </td><td style="text-align: left;"> <code>g_mc25</code> </td><td style="text-align: left;"> mesophyll conductance to CO2 (25 째C) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 0.4 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{sc}</code> </td><td style="text-align: left;"> <code>g_sc</code> </td><td style="text-align: left;"> stomatal conductance to CO2 </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 0.4 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{uc}</code> </td><td style="text-align: left;"> <code>g_uc</code> </td><td style="text-align: left;"> cuticular conductance to CO2 </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 0.01 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">J_\mathrm{max,25}</code> </td><td style="text-align: left;"> <code>J_max25</code> </td><td style="text-align: left;"> potential electron transport (25 째C) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 200 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">J_\mathrm{max}</code> </td><td style="text-align: left;"> <code>J_max</code> </td><td style="text-align: left;"> potential electron transport (T_leaf) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">k_\mathrm{mc}</code> </td><td style="text-align: left;"> <code>k_mc</code> </td><td style="text-align: left;"> partition of g_mc to lower mesophyll </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">k_\mathrm{sc}</code> </td><td style="text-align: left;"> <code>k_sc</code> </td><td style="text-align: left;"> partition of g_sc to lower surface </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">k_\mathrm{uc}</code> </td><td style="text-align: left;"> <code>k_uc</code> </td><td style="text-align: left;"> partition of g_uc to lower surface </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">K_\mathrm{C,25}</code> </td><td style="text-align: left;"> <code>K_C25</code> </td><td style="text-align: left;"> Michaelis constant for carboxylation (25 째C) </td><td style="text-align: left;"> umol / mol </td><td style="text-align: left;"> 268 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">K_\mathrm{C}</code> </td><td style="text-align: left;"> <code>K_C</code> </td><td style="text-align: left;"> Michaelis constant for carboxylation (T_leaf) </td><td style="text-align: left;"> umol / mol </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">K_\mathrm{O,25}</code> </td><td style="text-align: left;"> <code>K_O25</code> </td><td style="text-align: left;"> Michaelis constant for oxygenation (25 째C) </td><td style="text-align: left;"> umol / mol </td><td style="text-align: left;"> 165000 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">K_\mathrm{O}</code> </td><td style="text-align: left;"> <code>K_O</code> </td><td style="text-align: left;"> Michaelis constant for oxygenation (T_leaf) </td><td style="text-align: left;"> umol / mol </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\phi_J</code> </td><td style="text-align: left;"> <code>phi_J</code> </td><td style="text-align: left;"> initial slope of the response of J to PPFD </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.331 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">R_\mathrm{d,25}</code> </td><td style="text-align: left;"> <code>R_d25</code> </td><td style="text-align: left;"> nonphotorespiratory CO2 release (25 째C) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 2 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">R_\mathrm{d}</code> </td><td style="text-align: left;"> <code>R_d</code> </td><td style="text-align: left;"> nonphotorespiratory CO2 release (T_leaf) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\theta_J</code> </td><td style="text-align: left;"> <code>theta_J</code> </td><td style="text-align: left;"> curvature factor for light-response curve </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.825 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">T_\mathrm{leaf}</code> </td><td style="text-align: left;"> <code>T_leaf</code> </td><td style="text-align: left;"> leaf temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> 298 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">V_\mathrm{c,max,25}</code> </td><td style="text-align: left;"> <code>V_cmax25</code> </td><td style="text-align: left;"> maximum rate of carboxylation (25 째C) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 150 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">V_\mathrm{c,max}</code> </td><td style="text-align: left;"> <code>V_cmax</code> </td><td style="text-align: left;"> maximum rate of carboxylation (T_leaf) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">V_\mathrm{tpu,25}</code> </td><td style="text-align: left;"> <code>V_tpu25</code> </td><td style="text-align: left;"> rate of triose phosphate utilization (25 째C) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 200 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">V_\mathrm{tpu}</code> </td><td style="text-align: left;"> <code>V_tpu</code> </td><td style="text-align: left;"> rate of triose phosphate utilisation (T_leaf) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>If <code>use_tealeaves = TRUE</code>, additional parameters are:
</p>
<p><strong>Constants:</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">c_p</code> </td><td style="text-align: left;"> <code>c_p</code> </td><td style="text-align: left;"> heat capacity of air </td><td style="text-align: left;"> J / g / K </td><td style="text-align: left;"> 1.01 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">R_\mathrm{air}</code> </td><td style="text-align: left;"> <code>R_air</code> </td><td style="text-align: left;"> specific gas constant for dry air </td><td style="text-align: left;"> J / kg / K </td><td style="text-align: left;"> 287 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Baking (i.e. temperature response) parameters:</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Environment parameters:</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_q</code> </td><td style="text-align: left;"> <code>E_q</code> </td><td style="text-align: left;"> energy per mole quanta </td><td style="text-align: left;"> kJ / mol </td><td style="text-align: left;"> 220 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">f_\mathrm{PAR}</code> </td><td style="text-align: left;"> <code>f_par</code> </td><td style="text-align: left;"> fraction of incoming shortwave radiation that is photosynthetically active radiation (PAR) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">r</code> </td><td style="text-align: left;"> <code>r</code> </td><td style="text-align: left;"> reflectance for shortwave irradiance (albedo) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.2 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">T_\mathrm{air}</code> </td><td style="text-align: left;"> <code>T_air</code> </td><td style="text-align: left;"> air temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> 298 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">T_\mathrm{sky}</code> </td><td style="text-align: left;"> <code>T_sky</code> </td><td style="text-align: left;"> sky temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Leaf parameters:</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\alpha_\mathrm{l}</code> </td><td style="text-align: left;"> <code>abs_l</code> </td><td style="text-align: left;"> absorbtivity of longwave radiation (4 - 80 um) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.97 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\alpha_\mathrm{s}</code> </td><td style="text-align: left;"> <code>abs_s</code> </td><td style="text-align: left;"> absorbtivity of shortwave radiation (0.3 - 4 um) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{sw}</code> </td><td style="text-align: left;"> <code>g_sw</code> </td><td style="text-align: left;"> stomatal conductance to H2O </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{uw}</code> </td><td style="text-align: left;"> <code>g_uw</code> </td><td style="text-align: left;"> cuticular conductance to H2O </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\mathrm{logit}(sr)</code> </td><td style="text-align: left;"> <code>logit_sr</code> </td><td style="text-align: left;"> stomatal ratio (logit transformed) </td><td style="text-align: left;"> none </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><strong>Optional leaf parameters:</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\delta_\mathrm{ias,lower}</code> </td><td style="text-align: left;"> <code>delta_ias_lower</code> </td><td style="text-align: left;"> effective distance through lower internal airspace </td><td style="text-align: left;"> um </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\delta_\mathrm{ias,upper}</code> </td><td style="text-align: left;"> <code>delta_ias_upper</code> </td><td style="text-align: left;"> effective distance through upper internal airspace </td><td style="text-align: left;"> um </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">A_\mathrm{mes} / A</code> </td><td style="text-align: left;"> <code>A_mes_A</code> </td><td style="text-align: left;"> mesophyll surface area per unit leaf area </td><td style="text-align: left;"> none </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{liq,c,25}</code> </td><td style="text-align: left;"> <code>g_liqc25</code> </td><td style="text-align: left;"> liquid-phase conductance to CO2 (25 째C) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{liq,c}</code> </td><td style="text-align: left;"> <code>g_liqc</code> </td><td style="text-align: left;"> liquid-phase conductance to CO2 (T_leaf) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{ias,c,lower}</code> </td><td style="text-align: left;"> <code>g_iasc_lower</code> </td><td style="text-align: left;"> internal airspace conductance to CO2 in lower part of leaf (T_leaf) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{ias,c,upper}</code> </td><td style="text-align: left;"> <code>g_iasc_upper</code> </td><td style="text-align: left;"> internal airspace conductance to CO2 in upper part of leaf (T_leaf) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p><code>make_leafpar</code>: An object inheriting from class <code><a href="#topic+leaf_par">leaf_par()</a></code><br />
<code>make_enviropar</code>: An object inheriting from class <code><a href="#topic+enviro_par">enviro_par()</a></code><br />
<code>make_bakepar</code>: An object inheriting from class <code><a href="#topic+bake_par">bake_par()</a></code><br />
<code>make_constants</code>: An object inheriting from class <code><a href="#topic+constants">constants()</a></code>
</p>


<h3>References</h3>

<p>Buckley TN and Diaz-Espejo A. 2015. Partitioning changes in photosynthetic
rate into contributions from different variables. Plant, Cell &amp; Environment
38: 1200-11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bake_par = make_bakepar()
constants = make_constants(use_tealeaves = FALSE)
enviro_par = make_enviropar(use_tealeaves = FALSE)
leaf_par = make_leafpar(use_tealeaves = FALSE)

leaf_par = make_leafpar(
  replace = list(
    g_sc = set_units(0.3, mol / m^2 / s),
    V_cmax25 = set_units(100, umol / m^2 / s)
  ), use_tealeaves = FALSE
)
</code></pre>

<hr>
<h2 id='parameter_names'>Get vector of parameter names</h2><span id='topic+parameter_names'></span>

<h3>Description</h3>

<p>Get vector of parameter names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parameter_names(which, use_tealeaves)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parameter_names_+3A_which">which</code></td>
<td>
<p>A character string indicating which parameter names to retrieve: &quot;leaf&quot;, &quot;enviro&quot;, &quot;bake&quot;, or &quot;constants&quot;. Partial matching allowed.</p>
</td></tr>
<tr><td><code id="parameter_names_+3A_use_tealeaves">use_tealeaves</code></td>
<td>
<p>Logical. Should leaf energy balance be used to calculate leaf temperature (T_leaf)? If TRUE, <code><a href="tealeaves.html#topic+tleaves">tleaf()</a></code> calculates T_leaf. If FALSE, user-defined T_leaf is used. Additional parameters and constants are required, see <code><a href="#topic+make_parameters">make_parameters()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector with parameter names associated with each type, &quot;leaf&quot;, &quot;enviro&quot;, &quot;bake&quot;, or &quot;constants&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
parameter_names("leaf", use_tealeaves = FALSE)
</code></pre>

<hr>
<h2 id='photo_parameters'>Input parameters to simulate C3 photosynthesis using <code><a href="#topic+photosynthesis">photosynthesis()</a></code></h2><span id='topic+photo_parameters'></span>

<h3>Description</h3>

<p>A table of input parameters used in <code><a href="#topic+photosynthesis">photosynthesis()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>photo_parameters
</code></pre>


<h3>Format</h3>



<h4><code>photo_parameters</code></h4>

<p>A data frame with 73 rows and 11  columns:
</p>

<dl>
<dt>country</dt><dd><p>Country name</p>
</dd>
<dt>iso2, iso3</dt><dd><p>2 &amp; 3 letter ISO country codes</p>
</dd>
<dt>year</dt><dd><p>Year</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p><a href="https://www.who.int/teams/global-tuberculosis-programme/data">https://www.who.int/teams/global-tuberculosis-programme/data</a>
</p>

<hr>
<h2 id='photosynthesis'>Simulate C3 photosynthesis</h2><span id='topic+photosynthesis'></span><span id='topic+photo'></span>

<h3>Description</h3>

<p><code>photosynthesis</code>: simulate C3 photosynthesis over multiple parameter sets
</p>
<p><code>photo</code>: simulate C3 photosynthesis over a single parameter set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>photosynthesis(
  leaf_par,
  enviro_par,
  bake_par,
  constants,
  use_tealeaves,
  progress = TRUE,
  quiet = FALSE,
  assert_units = TRUE,
  check = TRUE,
  parallel = FALSE,
  use_legacy_version = FALSE
)

photo(
  leaf_par,
  enviro_par,
  bake_par,
  constants,
  use_tealeaves,
  quiet = FALSE,
  assert_units = TRUE,
  check = TRUE,
  prepare_for_tleaf = use_tealeaves,
  use_legacy_version = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="photosynthesis_+3A_leaf_par">leaf_par</code></td>
<td>
<p>A list of leaf parameters inheriting class <code>leaf_par</code>. This can be generated using the <code>make_leafpar</code> function.</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_enviro_par">enviro_par</code></td>
<td>
<p>A list of environmental parameters inheriting class <code>enviro_par</code>. This can be generated using the <code>make_enviropar</code> function.</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_bake_par">bake_par</code></td>
<td>
<p>A list of temperature response parameters inheriting class <code>bake_par</code>. This can be generated using the <code>make_bakepar</code> function.</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_constants">constants</code></td>
<td>
<p>A list of physical constants inheriting class <code>constants</code>. This can be generated using the <code>make_constants</code> function.</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_use_tealeaves">use_tealeaves</code></td>
<td>
<p>Logical. Should leaf energy balance be used to calculate leaf temperature (T_leaf)? If TRUE, <code><a href="tealeaves.html#topic+tleaves">tleaf()</a></code> calculates T_leaf. If FALSE, user-defined T_leaf is used. Additional parameters and constants are required, see <code><a href="#topic+make_parameters">make_parameters()</a></code>.</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_progress">progress</code></td>
<td>
<p>Logical. Should a progress bar be displayed?</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_quiet">quiet</code></td>
<td>
<p>Logical. Should messages be displayed?</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_assert_units">assert_units</code></td>
<td>
<p>Logical. Should parameter <code>units</code> be checked? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_check">check</code></td>
<td>
<p>Logical. Should arguments checks be done? This is intended to be disabled when <code><a href="#topic+photo">photo()</a></code> is called from <code><a href="#topic+photosynthesis">photosynthesis()</a></code> Default is TRUE.</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_parallel">parallel</code></td>
<td>
<p>Logical. Should parallel processing be used via <code><a href="furrr.html#topic+future_map">furrr::future_map()</a></code>?</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_use_legacy_version">use_legacy_version</code></td>
<td>
<p>Logical. Should legacy model (&lt;2.1.0) be used? See <a href="https://github.com/cdmuir/photosynthesis/blob/master/NEWS.md">NEWS</a> for further information. Default is FALSE.</p>
</td></tr>
<tr><td><code id="photosynthesis_+3A_prepare_for_tleaf">prepare_for_tleaf</code></td>
<td>
<p>Logical. Should arguments additional calculations for <code><a href="tealeaves.html#topic+tleaves">tleaf()</a></code>? This is intended to be disabled when <code><a href="#topic+photo">photo()</a></code> is called from <code><a href="#topic+photosynthesis">photosynthesis()</a></code>. Default is <code>use_tealeaves</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>photo</code>: This function takes simulates photosynthetic rate using the Farquhar-von Caemmerer-Berry (<code><a href="#topic+FvCB">FvCB()</a></code>) model of C3 photosynthesis for single combined set of leaf parameters (<code><a href="#topic+leaf_par">leaf_par()</a></code>), environmental parameters (<code><a href="#topic+enviro_par">enviro_par()</a></code>), and physical constants (<code><a href="#topic+constants">constants()</a></code>). Leaf parameters are provided at reference temperature (25 째C) and then &quot;baked&quot; to the appropriate leaf temperature using temperature response functions (see <code><a href="#topic+bake">bake()</a></code>). <br />
<br />
<code>photosynthesis</code>: This function uses <code>photo</code> to simulate photosynthesis over multiple parameter sets that are generated using <code><a href="purrr.html#topic+cross">cross_df()</a></code>. <br />
</p>


<h3>Value</h3>

<p>A data.frame with the following <code>units</code> columns <br />
</p>
<p><strong>Inputs:</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_{\mathrm{c},0}</code> </td><td style="text-align: left;"> <code>D_c0</code> </td><td style="text-align: left;"> diffusion coefficient for CO2 in air at 0 째C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <code class="reqn">1.29\times 10^{-5}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_{\mathrm{h},0}</code> </td><td style="text-align: left;"> <code>D_h0</code> </td><td style="text-align: left;"> diffusion coefficient for heat in air at 0 째C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <code class="reqn">1.90\times 10^{-5}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_{\mathrm{m},0}</code> </td><td style="text-align: left;"> <code>D_m0</code> </td><td style="text-align: left;"> diffusion coefficient for momentum in air at 0 째C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <code class="reqn">1.33\times 10^{-5}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_{\mathrm{w},0}</code> </td><td style="text-align: left;"> <code>D_w0</code> </td><td style="text-align: left;"> diffusion coefficient for water vapor in air at 0 째C </td><td style="text-align: left;"> m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> <code class="reqn">2.12\times 10^{-5}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\epsilon</code> </td><td style="text-align: left;"> <code>epsilon</code> </td><td style="text-align: left;"> ratio of water to air molar masses </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.622 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">G</code> </td><td style="text-align: left;"> <code>G</code> </td><td style="text-align: left;"> gravitational acceleration </td><td style="text-align: left;"> m / s<code class="reqn">^2</code> </td><td style="text-align: left;"> 9.8 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">eT</code> </td><td style="text-align: left;"> <code>eT</code> </td><td style="text-align: left;"> exponent for temperature dependence of diffusion </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1.75 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">R</code> </td><td style="text-align: left;"> <code>R</code> </td><td style="text-align: left;"> ideal gas constant </td><td style="text-align: left;"> J / mol / K </td><td style="text-align: left;"> 8.31 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\sigma</code> </td><td style="text-align: left;"> <code>sigma</code> </td><td style="text-align: left;"> Stephan-Boltzmann constant </td><td style="text-align: left;"> W / m<code class="reqn">^2</code> / K<code class="reqn">^4</code> </td><td style="text-align: left;"> <code class="reqn">5.67\times 10^{-8}</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">f_\mathrm{Sh}</code> </td><td style="text-align: left;"> <code>f_sh</code> </td><td style="text-align: left;"> function to calculate constant(s) for Sherwood number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">f_\mathrm{Nu}</code> </td><td style="text-align: left;"> <code>f_nu</code> </td><td style="text-align: left;"> function to calculate constant(s) for Nusselt number </td><td style="text-align: left;"> none </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_\mathrm{s,gmc}</code> </td><td style="text-align: left;"> <code>Ds_gmc</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol / K </td><td style="text-align: left;"> 487 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">D_\mathrm{s,Jmax}</code> </td><td style="text-align: left;"> <code>Ds_Jmax</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol / K </td><td style="text-align: left;"> 388 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,\Gamma *}</code> </td><td style="text-align: left;"> <code>Ea_gammastar</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 24500 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,gmc}</code> </td><td style="text-align: left;"> <code>Ea_gmc</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 68900 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,Jmax}</code> </td><td style="text-align: left;"> <code>Ea_Jmax</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 56100 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,KC}</code> </td><td style="text-align: left;"> <code>Ea_KC</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 81000 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,KO}</code> </td><td style="text-align: left;"> <code>Ea_KO</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 23700 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,Rd}</code> </td><td style="text-align: left;"> <code>Ea_Rd</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 40400 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,Vcmax}</code> </td><td style="text-align: left;"> <code>Ea_Vcmax</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 52200 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{a,Vtpu}</code> </td><td style="text-align: left;"> <code>Ea_Vtpu</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 52200 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{d,gmc}</code> </td><td style="text-align: left;"> <code>Ed_gmc</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 149000 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">E_\mathrm{d,Jmax}</code> </td><td style="text-align: left;"> <code>Ed_Jmax</code> </td><td style="text-align: left;"> empirical temperature response parameter </td><td style="text-align: left;"> J / mol </td><td style="text-align: left;"> 121000 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">C_\mathrm{air}</code> </td><td style="text-align: left;"> <code>C_air</code> </td><td style="text-align: left;"> atmospheric CO2 concentration </td><td style="text-align: left;"> umol/mol </td><td style="text-align: left;"> 420 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">O</code> </td><td style="text-align: left;"> <code>O</code> </td><td style="text-align: left;"> atmospheric O2 concentration </td><td style="text-align: left;"> mol/mol </td><td style="text-align: left;"> 0.21 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">P</code> </td><td style="text-align: left;"> <code>P</code> </td><td style="text-align: left;"> atmospheric pressure </td><td style="text-align: left;"> kPa </td><td style="text-align: left;"> 101 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\mathrm{PPFD}</code> </td><td style="text-align: left;"> <code>PPFD</code> </td><td style="text-align: left;"> photosynthetic photon flux density </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 1500 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\mathrm{RH}</code> </td><td style="text-align: left;"> <code>RH</code> </td><td style="text-align: left;"> relative humidity </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">u</code> </td><td style="text-align: left;"> <code>wind</code> </td><td style="text-align: left;"> windspeed </td><td style="text-align: left;"> m / s </td><td style="text-align: left;"> 2 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">d</code> </td><td style="text-align: left;"> <code>leafsize</code> </td><td style="text-align: left;"> leaf characteristic dimension </td><td style="text-align: left;"> m </td><td style="text-align: left;"> 0.1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\Gamma*_{25}</code> </td><td style="text-align: left;"> <code>gamma_star25</code> </td><td style="text-align: left;"> chloroplastic CO2 compensation point (25 째C) </td><td style="text-align: left;"> umol/mol </td><td style="text-align: left;"> 37.9 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{mc,25}</code> </td><td style="text-align: left;"> <code>g_mc25</code> </td><td style="text-align: left;"> mesophyll conductance to CO2 (25 째C) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 0.4 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{sc}</code> </td><td style="text-align: left;"> <code>g_sc</code> </td><td style="text-align: left;"> stomatal conductance to CO2 </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 0.4 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{uc}</code> </td><td style="text-align: left;"> <code>g_uc</code> </td><td style="text-align: left;"> cuticular conductance to CO2 </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 0.01 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">J_\mathrm{max,25}</code> </td><td style="text-align: left;"> <code>J_max25</code> </td><td style="text-align: left;"> potential electron transport (25 째C) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 200 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">k_\mathrm{mc}</code> </td><td style="text-align: left;"> <code>k_mc</code> </td><td style="text-align: left;"> partition of g_mc to lower mesophyll </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">k_\mathrm{sc}</code> </td><td style="text-align: left;"> <code>k_sc</code> </td><td style="text-align: left;"> partition of g_sc to lower surface </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">k_\mathrm{uc}</code> </td><td style="text-align: left;"> <code>k_uc</code> </td><td style="text-align: left;"> partition of g_uc to lower surface </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">K_\mathrm{C,25}</code> </td><td style="text-align: left;"> <code>K_C25</code> </td><td style="text-align: left;"> Michaelis constant for carboxylation (25 째C) </td><td style="text-align: left;"> umol / mol </td><td style="text-align: left;"> 268 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">K_\mathrm{O,25}</code> </td><td style="text-align: left;"> <code>K_O25</code> </td><td style="text-align: left;"> Michaelis constant for oxygenation (25 째C) </td><td style="text-align: left;"> umol / mol </td><td style="text-align: left;"> 165000 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\phi_J</code> </td><td style="text-align: left;"> <code>phi_J</code> </td><td style="text-align: left;"> initial slope of the response of J to PPFD </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.331 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">R_\mathrm{d,25}</code> </td><td style="text-align: left;"> <code>R_d25</code> </td><td style="text-align: left;"> nonphotorespiratory CO2 release (25 째C) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 2 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\theta_J</code> </td><td style="text-align: left;"> <code>theta_J</code> </td><td style="text-align: left;"> curvature factor for light-response curve </td><td style="text-align: left;"> none </td><td style="text-align: left;"> 0.825 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">T_\mathrm{leaf}</code> </td><td style="text-align: left;"> <code>T_leaf</code> </td><td style="text-align: left;"> leaf temperature </td><td style="text-align: left;"> K </td><td style="text-align: left;"> 298 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">V_\mathrm{c,max,25}</code> </td><td style="text-align: left;"> <code>V_cmax25</code> </td><td style="text-align: left;"> maximum rate of carboxylation (25 째C) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 150 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">V_\mathrm{tpu,25}</code> </td><td style="text-align: left;"> <code>V_tpu25</code> </td><td style="text-align: left;"> rate of triose phosphate utilization (25 째C) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> 200 </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\delta_\mathrm{ias,lower}</code> </td><td style="text-align: left;"> <code>delta_ias_lower</code> </td><td style="text-align: left;"> effective distance through lower internal airspace </td><td style="text-align: left;"> um </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\delta_\mathrm{ias,upper}</code> </td><td style="text-align: left;"> <code>delta_ias_upper</code> </td><td style="text-align: left;"> effective distance through upper internal airspace </td><td style="text-align: left;"> um </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">A_\mathrm{mes} / A</code> </td><td style="text-align: left;"> <code>A_mes_A</code> </td><td style="text-align: left;"> mesophyll surface area per unit leaf area </td><td style="text-align: left;"> none </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{liq,c,25}</code> </td><td style="text-align: left;"> <code>g_liqc25</code> </td><td style="text-align: left;"> liquid-phase conductance to CO2 (25 째C) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <strong>Baked Inputs:</strong> </td><td style="text-align: left;">  </td><td style="text-align: left;">  </td><td style="text-align: left;">  </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
   Symbol </td><td style="text-align: left;"> R </td><td style="text-align: left;"> Description </td><td style="text-align: left;"> Units </td><td style="text-align: left;"> Default </td>
</tr>
<tr>
 <td style="text-align: left;">
   :---------------------------- </td><td style="text-align: left;"> :------------------- </td><td style="text-align: left;"> :------------------------------------------------------------------- </td><td style="text-align: left;"> :-------------------- </td><td style="text-align: left;"> :------- </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">\Gamma*</code> </td><td style="text-align: left;"> <code>gamma_star</code> </td><td style="text-align: left;"> chloroplastic CO2 compensation point (T_leaf) </td><td style="text-align: left;"> umol/mol </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{mc}</code> </td><td style="text-align: left;"> <code>g_mc</code> </td><td style="text-align: left;"> mesophyll conductance to CO2 (T_leaf) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">J_\mathrm{max}</code> </td><td style="text-align: left;"> <code>J_max</code> </td><td style="text-align: left;"> potential electron transport (T_leaf) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">K_\mathrm{C}</code> </td><td style="text-align: left;"> <code>K_C</code> </td><td style="text-align: left;"> Michaelis constant for carboxylation (T_leaf) </td><td style="text-align: left;"> umol / mol </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">K_\mathrm{O}</code> </td><td style="text-align: left;"> <code>K_O</code> </td><td style="text-align: left;"> Michaelis constant for oxygenation (T_leaf) </td><td style="text-align: left;"> umol / mol </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">R_\mathrm{d}</code> </td><td style="text-align: left;"> <code>R_d</code> </td><td style="text-align: left;"> nonphotorespiratory CO2 release (T_leaf) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">V_\mathrm{c,max}</code> </td><td style="text-align: left;"> <code>V_cmax</code> </td><td style="text-align: left;"> maximum rate of carboxylation (T_leaf) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">V_\mathrm{tpu}</code> </td><td style="text-align: left;"> <code>V_tpu</code> </td><td style="text-align: left;"> rate of triose phosphate utilisation (T_leaf) </td><td style="text-align: left;"> umol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{liq,c}</code> </td><td style="text-align: left;"> <code>g_liqc</code> </td><td style="text-align: left;"> liquid-phase conductance to CO2 (T_leaf) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{ias,c,lower}</code> </td><td style="text-align: left;"> <code>g_iasc_lower</code> </td><td style="text-align: left;"> internal airspace conductance to CO2 in lower part of leaf (T_leaf) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code class="reqn">g_\mathrm{ias,c,upper}</code> </td><td style="text-align: left;"> <code>g_iasc_upper</code> </td><td style="text-align: left;"> internal airspace conductance to CO2 in upper part of leaf (T_leaf) </td><td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td><td style="text-align: left;"> NA </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<table>
<tr>
 <td style="text-align: left;">

<strong>Output:</strong> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>A</code> </td><td style="text-align: left;"> photosynthetic rate at <code>C_chl</code> (<code class="reqn">\mu</code>mol CO2 / m<code class="reqn">^2</code> / s) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>C_chl</code> </td><td style="text-align: left;"> chloroplastic CO2 concentration where <code>A_supply</code> intersects <code>A_demand</code> (<code class="reqn">mu</code>mol / mol) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>C_i</code> </td><td style="text-align: left;"> intercellular CO2 concentration where <code>A_supply</code> intersects <code>A_demand</code> (<code class="reqn">mu</code>mol / mol) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>g_tc</code> </td><td style="text-align: left;"> total conductance to CO2 at <code>T_leaf</code> (mol / m<code class="reqn">^2</code> / s)) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>value</code> </td><td style="text-align: left;"> <code>A_supply</code> - <code>A_demand</code> (<code class="reqn">\mu</code>mol / (m<code class="reqn">^2</code> s)) at <code>C_chl</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>convergence</code> </td><td style="text-align: left;"> convergence code (0 = converged)
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># Single parameter set with 'photo'

bake_par = make_bakepar()
constants = make_constants(use_tealeaves = FALSE)
enviro_par = make_enviropar(use_tealeaves = FALSE)
leaf_par = make_leafpar(use_tealeaves = FALSE)
photo(leaf_par, enviro_par, bake_par, constants,
  use_tealeaves = FALSE
)

# Multiple parameter sets with 'photosynthesis'

leaf_par = make_leafpar(
  replace = list(
    T_leaf = set_units(c(293.14, 298.15), "K")
  ), use_tealeaves = FALSE
)
photosynthesis(leaf_par, enviro_par, bake_par, constants,
  use_tealeaves = FALSE
)
</code></pre>

<hr>
<h2 id='photosynthesis-package'><code>photosynthesis</code> package</h2><span id='topic+photosynthesis-package'></span>

<h3>Description</h3>

<p>Tools for Plant Ecophysiology &amp; Modeling
</p>


<h3>Details</h3>

<p>See the README on
<a href="https://github.com/cdmuir/photosynthesis">GitHub</a>
</p>

<hr>
<h2 id='ppm2pa'>Convert pressure from PPM to Pascals</h2><span id='topic+ppm2pa'></span>

<h3>Description</h3>

<p>Convert pressure from PPM to Pascals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppm2pa(ppm, P)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppm2pa_+3A_ppm">ppm</code></td>
<td>
<p>Pressure value in umol/mol of class <code>units</code></p>
</td></tr>
<tr><td><code id="ppm2pa_+3A_p">P</code></td>
<td>
<p>Atmospheric pressure value in kPa of class <code>units</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">\mathrm{Press}(kPa) = \mathrm{Press}(ppm) P(kPa)</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathrm{Press}(Pa) = 1000 \mathrm{Press}(kPa)</code>
</p>



<h3>Value</h3>

<p>Value in Pa of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ppm = set_units(400, "umol/mol")
P = set_units(101.325, "kPa")
ppm2pa(ppm, P)
</code></pre>

<hr>
<h2 id='print_graphs'>Printing graphs to system</h2><span id='topic+print_graphs'></span>

<h3>Description</h3>

<p>Printing graphs to system
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_graphs(
  data,
  path,
  output_type = "jpeg",
  height = 5,
  width = 5,
  res = 600,
  units = "in",
  pdf_filename,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_graphs_+3A_data">data</code></td>
<td>
<p>List of graphs</p>
</td></tr>
<tr><td><code id="print_graphs_+3A_path">path</code></td>
<td>
<p>File path for printing our graphs. Use &quot;./&quot; to set to current
working directory</p>
</td></tr>
<tr><td><code id="print_graphs_+3A_output_type">output_type</code></td>
<td>
<p>Type of output file, jpeg or pdf</p>
</td></tr>
<tr><td><code id="print_graphs_+3A_height">height</code></td>
<td>
<p>Height of jpegs</p>
</td></tr>
<tr><td><code id="print_graphs_+3A_width">width</code></td>
<td>
<p>Width of jpegs</p>
</td></tr>
<tr><td><code id="print_graphs_+3A_res">res</code></td>
<td>
<p>Resolution of jpegs</p>
</td></tr>
<tr><td><code id="print_graphs_+3A_units">units</code></td>
<td>
<p>Units of height and width</p>
</td></tr>
<tr><td><code id="print_graphs_+3A_pdf_filename">pdf_filename</code></td>
<td>
<p>Filename for pdf option</p>
</td></tr>
<tr><td><code id="print_graphs_+3A_...">...</code></td>
<td>
<p>Further arguments for jpeg() and pdf()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>print_graphs creates graph files in current working directory
from a list of graphs
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data &lt;- read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Fit many AQ curves
# Set your grouping variable
# Here we are grouping by CO2_s and individual
data$C_s &lt;- (round(data$CO2_s, digits = 0))

# For this example we need to round sequentially due to CO2_s setpoints
data$C_s &lt;- as.factor(round(data$C_s, digits = -1))

# To fit one AQ curve
fit &lt;- fit_aq_response(data[data$C_s == 600, ],
  varnames = list(
    A_net = "A",
    PPFD = "Qin"
  )
)

# Print model summary
summary(fit[[1]])

# Print fitted parameters
fit[[2]]

# Print graph
fit[[3]]

# Fit many curves
fits &lt;- fit_many(
  data = data,
  varnames = list(
    A_net = "A",
    PPFD = "Qin",
    group = "C_s"
  ),
  funct = fit_aq_response,
  group = "C_s"
)

# Look at model summary for a given fit
# First set of double parentheses selects an individual group value
# Second set selects an element of the sublist
summary(fits[[3]][[1]])

# Print the parameters
fits[[3]][[2]]

# Print the graph
fits[[3]][[3]]

# Compile graphs into a list for plotting
fits_graphs &lt;- compile_data(fits,
  list_element = 3
)

# Print graphs to pdf
# Uncomment to run
# print_graphs(data = fits_graphs,
#            output_type = "pdf",
#            path = tempdir(),
#            pdf_filename = "mygraphs.pdf")

</code></pre>

<hr>
<h2 id='read_li6800'>Read a LI-COR file</h2><span id='topic+read_li6800'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p>We are no longer updating this function. Please use <code><a href="#topic+read_licor">read_licor</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_li6800(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_li6800_+3A_x">x</code></td>
<td>
<p>File name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame from raw LI-COR files. Current support
for LI-COR LI-6800 files only.
</p>

<hr>
<h2 id='read_licor'>Read a LI-COR file</h2><span id='topic+read_licor'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Reads a raw LI-COR LI6800 file, including remarks. This function was
developed using output from Bluestem v.2.0.04 to v.2.1.08. We cannot
guarantee backward compatibility with earlier versions of Bluestem. We will
try to update code when new versions are released, but there maybe a
time-lag, so inspect results carefully.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_licor(
  file,
  bluestem_version = get_bluestem_version(file, n_max = 10L),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_licor_+3A_file">file</code></td>
<td>
<p>Path to a raw LI6800 file</p>
</td></tr>
<tr><td><code id="read_licor_+3A_bluestem_version">bluestem_version</code></td>
<td>
<p>Character string of Bluestem software version number. By default, the function will try to pull the version number from file.</p>
</td></tr>
<tr><td><code id="read_licor_+3A_...">...</code></td>
<td>
<p>Argument passed to <code><a href="readr.html#topic+read_lines">read_lines</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="tibble.html#topic+tibble">tibble</a></code> from raw LI-COR LI6800 files.
</p>

<hr>
<h2 id='required_variables'>Variables required for <strong>photosynthesis</strong> models</h2><span id='topic+required_variables'></span>

<h3>Description</h3>

<p>Variables required for <strong>photosynthesis</strong> models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>required_variables(.model, quiet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="required_variables_+3A_.model">.model</code></td>
<td>
<p>A character string of model name to use. See <code><a href="#topic+get_all_models">get_all_models()</a></code>.</p>
</td></tr>
<tr><td><code id="required_variables_+3A_quiet">quiet</code></td>
<td>
<p>Flag. Should messages be suppressed? Default is FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='simulate_error'>Simulate gas exchange data with measurement error</h2><span id='topic+simulate_error'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_error(
  ph_out,
  chamber_pars,
  n = 1L,
  use_tealeaves = ("T_air" %in% colnames(ph_out))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_error_+3A_ph_out">ph_out</code></td>
<td>
<p>A data frame of output from <code>photo()</code> or <code>photosynthesis()</code>
with units.</p>
</td></tr>
<tr><td><code id="simulate_error_+3A_chamber_pars">chamber_pars</code></td>
<td>
<p>A data frame with a single row of chamber parameters.
See Note below for table of required parameters.</p>
</td></tr>
<tr><td><code id="simulate_error_+3A_n">n</code></td>
<td>
<p>Integer. Number of replicated simulations per row of <code>ph_out</code>.</p>
</td></tr>
<tr><td><code id="simulate_error_+3A_use_tealeaves">use_tealeaves</code></td>
<td>
<p>Flag. The <strong>tealeaves</strong> package uses a slightly
different equation to calculate the saturating water content of air as a
function temperature and pressure than LI-COR. If FALSE, the function uses
LI-COR's equation in the LI6800 manual. If TRUE, it uses the <strong>tealeaves</strong>
function for internal consistency. The function attempts to guess whether
<code>ph_out</code> was run with <strong>tealeaves</strong>, but this can be manually overridden by
providing a value for the argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with <code>n * nrow(ph_out)</code> rows. It contains all the
original output in <code>ph_out</code> as well as a column <code>.rep</code> indicating replicate
number from 1 to <code>n</code>. Other new columns are assumed or measured chamber
parameters and 'measured' values estimated from synthetic data with
measurement error:</p>

<table>
<tr>
 <td style="text-align: left;">
   column name </td><td style="text-align: left;"> assumed or derived? </td><td style="text-align: left;"> description </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>flow</code> </td><td style="text-align: left;"> assumed </td><td style="text-align: left;"> chamber flow rate </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>leaf_area</code> </td><td style="text-align: left;"> assumed </td><td style="text-align: left;"> leaf area in chamber </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>sigma_CO2_r</code> </td><td style="text-align: left;"> assumed </td><td style="text-align: left;"> standard deviation of measurement error in CO2_r </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>sigma_CO2_s</code> </td><td style="text-align: left;"> assumed </td><td style="text-align: left;"> standard deviation of measurement error in CO2_s </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>sigma_H2O_r</code> </td><td style="text-align: left;"> assumed </td><td style="text-align: left;"> standard deviation of measurement error in H2O_r </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>sigma_H2O_s</code> </td><td style="text-align: left;"> assumed </td><td style="text-align: left;"> standard deviation of measurement error in H2O_s </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>c_0</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> CO<code class="reqn">_2</code> concentration before entering chamber [<code class="reqn">\mu</code>mol / mol] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>w_i</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Water vapor concentration within leaf [mmol / mol] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>w_a</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Water vapor concentration in chamber [mmol / mol] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>w_0</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Water vapor concentration before entering chamber [mmol / mol] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>g_tw</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Leaf conductance to water vapor [mol/m<code class="reqn">^2</code>/s] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>E_area</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Evaporation rate per area [mmol/m<code class="reqn">^2</code>/s] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>E</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Total evaporation rate [mmol/s] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>CO2_r</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> CO<code class="reqn">_2</code> concentration before entering chamber with measurement error [<code class="reqn">\mu</code>mol / mol] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>CO2_s</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> CO<code class="reqn">_2</code> concentration in chamber with measurement error [<code class="reqn">\mu</code>mol / mol] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>H2O_s</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Water vapor concentration in chamber with measurement error [mmol / mol] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>H2O_r</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Water vapor concentration before entering chamber with measurement error [mmol / mol] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>E_meas</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Total evaporation rate (measured) [mmol/s] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>E_area_meas</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Evaporation rate per area (measured) [mmol/m<code class="reqn">^2</code>/s] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>g_tw_meas</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Leaf conductance to water vapor (measured) [mol/m<code class="reqn">^2</code>/s] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>g_sc_meas</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Stomatal conductance to CO<code class="reqn">_2</code> (measured) [mol/m<code class="reqn">^2</code>/s] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>g_tc_meas</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Leaf conductance to CO<code class="reqn">_2</code> (measured) [mol/m<code class="reqn">^2</code>/s] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>A_meas</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Net photosynthetic CO<code class="reqn">_2</code> assimilation (measured) [<code class="reqn">\mu</code>mol/m<code class="reqn">^2</code>/s] </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>C_i</code> </td><td style="text-align: left;"> derived </td><td style="text-align: left;"> Intercellular CO<code class="reqn">_2</code> concentration (measured) [<code class="reqn">\mu</code>mol/mol] </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Note</h3>

<p>The required parameters for the <code>chamber_pars</code> argument are:
</p>

<ul>
<li> <p><code>flow</code> [<code class="reqn">\mu</code>mol / s]: chamber flow rate
</p>
</li>
<li> <p><code>leaf_area</code> [cm ^ 2]: leaf area in chamber
</p>
</li>
<li> <p><code>sigma_CO2_s</code> [<code class="reqn">\mu</code>mol / mol]: standard deviation of sample [CO<code class="reqn">_2</code>] measurement error
</p>
</li>
<li> <p><code>sigma_CO2_r</code> [<code class="reqn">\mu</code>mol / mol]: standard deviation of reference [CO<code class="reqn">_2</code>]
</p>
</li>
<li> <p><code>sigma_H2O_s</code> [mmol / mol]: standard deviation of sample [H<code class="reqn">_2</code>O] measurement error
</p>
</li>
<li> <p><code>sigma_H2O_r</code> [mmol / mol]: standard deviation of sample [H<code class="reqn">_2</code>O] measurement error
</p>
</li></ul>

<p>Units for <code>flow</code> and <code>leaf_area</code> should be provided; units are implied for sigma's but not necessary to specify because <code>rnorm()</code> drop units.
</p>
<p>To evaluate the accuracy and precision of parameter estimation methods, it
may be useful to simulate data with realistic measurement error. This
function takes output from from <code>photo()</code> or <code>photosynthesis()</code> models, adds
measurement error in CO<code class="reqn">_2</code> and H<code class="reqn">_2</code>O concentrations, and calculates
parameter estimates with synthetic data. Currently, the function assumes a
simplified 1-dimensional CO<code class="reqn">_2</code> and H<code class="reqn">_2</code>O conductance model: zero
cuticular conductance, infinite boundary layer conductance, and infinite
airspace conductance. Other assumptions include:
</p>

<ul>
<li><p> chamber flow rate, leaf area, leaf temperature, and air pressure are known
without error
</p>
</li>
<li><p> measurement error is normally distributed mean 0 and standard deviation
specified in <code>chamber_pars</code>
</p>
</li></ul>

<p>This function was designed with the LI-COR LI6800 instrument in mind, but in
principle applies to any open path gas exchange system.
</p>
<p>[COQyjnqgugpiWjwbNIBuz5yhp7XSctzgs1-5-]: R:COQyjnqgugpiWjwbNIBuz5yhp7XSctzgs1-5-%5C
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(photosynthesis)

# Use photosynthesis() to simulate 'real' values
# `replace = ...` sets parameters to meet assumptions of `simulate_error()`
lp = make_leafpar(replace = list(
  g_sc = set_units(0.1, mol/m^2/s),
  g_uc = set_units(0, mol/m^2/s),
  k_mc = set_units(0, 1),
  k_sc = set_units(0, 1),
  k_uc = set_units(0, 1)
  ),
  use_tealeaves = FALSE)
   
 ep = make_enviropar(replace = list(
   wind = set_units(Inf, m/s)
 ), use_tealeaves = FALSE) 
 bp = make_bakepar()
 cs = make_constants(use_tealeaves = FALSE)
 
 chamber_pars = data.frame(
   flow = set_units(600, umol / s),
   leaf_area = set_units(6, cm ^ 2),
   sigma_CO2_s = 0.1,
   sigma_CO2_r = 0.1,
   sigma_H2O_s = 0.1,
   sigma_H2O_r = 0.1
 )
   
ph = photosynthesis(lp, ep, bp, cs, use_tealeaves = FALSE, quiet = TRUE) |&gt;
  simulate_error(chamber_pars, n = 1L)
  
</code></pre>

<hr>
<h2 id='t_response_arrhenius'>Temperature response functions</h2><span id='topic+t_response_arrhenius'></span><span id='topic+t_response_arrhenius_kruse'></span><span id='topic+t_response_arrhenius_medlyn'></span><span id='topic+t_response_arrhenius_topt'></span><span id='topic+t_response_calc_dS'></span><span id='topic+t_response_calc_topt'></span><span id='topic+t_response_heskel'></span><span id='topic+t_response_mmrt'></span>

<h3>Description</h3>

<p>Temperature response functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t_response_arrhenius(T_leaf, Ea)

t_response_arrhenius_kruse(dEa, Ea_ref, Par_ref, T2)

t_response_arrhenius_medlyn(T_leaf, Ea, Hd, dS)

t_response_arrhenius_topt(T_leaf, Ea, Hd, Topt)

t_response_calc_dS(Ea, Hd, Topt)

t_response_calc_topt(Hd, dS, Ea)

t_response_heskel(T_leaf, a, b, c)

t_response_mmrt(dCp, dG, dH, T_leaf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t_response_arrhenius_+3A_t_leaf">T_leaf</code></td>
<td>
<p>Leaf temperature in K</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_ea">Ea</code></td>
<td>
<p>Activation energy in J mol-1 (Medlyn et al. 2002)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_dea">dEa</code></td>
<td>
<p>Temperature-dependent change in Ea in K^2 (Kruse et al. 2008)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_ea_ref">Ea_ref</code></td>
<td>
<p>Activation energy in J mol-1 (Kruse et al. 2008)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_par_ref">Par_ref</code></td>
<td>
<p>Parameter at reference temperature of 25 Celsius (Kruse et
al. 2008)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_t2">T2</code></td>
<td>
<p>Leaf temperature term (Kruse et al. 2008)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_hd">Hd</code></td>
<td>
<p>Deactivation energy in J mol-1 (Medlyn et al. 2002)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_ds">dS</code></td>
<td>
<p>Entropy parameter in J mol-1 (Medlyn et al. 2002)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_topt">Topt</code></td>
<td>
<p>Optimum temperature of the process in K (Medlyn et al.
2002)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_a">a</code></td>
<td>
<p>Constant to minimize residuals (Heskel et al. 2016)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_b">b</code></td>
<td>
<p>Linear coefficient to minimize residuals (Heskel et al. 2016)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_c">c</code></td>
<td>
<p>Quadratic coefficient to minimize residuals (Heskel et al. 2016)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_dcp">dCp</code></td>
<td>
<p>Change in heat capacity of the enzyme between the
enzyme-substrate #' and enzyme-transition states in J mol-1 K-1 (Hobbs et
al. 2013)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_dg">dG</code></td>
<td>
<p>Change in Gibbs free energy of the reaction at 25 C in J mol-1
(Hobbs et al. 2013)</p>
</td></tr>
<tr><td><code id="t_response_arrhenius_+3A_dh">dH</code></td>
<td>
<p>Change in enthalpy of the reaction at 25 C in J mol-1 (Hobbs et
al. 2013)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>t_response_arrhenius calculates the rate of a process based on an
Arrhenius-type curve
</p>
<p>t_response_arrhenius_kruse fits a peaked Arrhenius response according to
Kruse et al. 2008.
</p>
<p>t_response_arrhenius_medlyn is a peaked Arrhenius response as found in
Medlyn et al. 2002.
</p>
<p>t_response_arrhenius_topt is a peaked Arrhenius temperature response
function.
</p>
<p>t_response_calc_dS calculates dS from the fitted Topt model.
</p>
<p>t_response_calc_topt calculates Topt for a process from Arrhenius
parameters.
</p>
<p>t_response_heskel is a quadratic temperature response according to
Heskel et al. 2016.
</p>
<p>t_response_mmrt is a macromolecular rate theory temperature response
according to Hobbs et al. 2013.
</p>


<h3>References</h3>

<p>Arrhenius S. 1915. Quantitative laws in biological chemistry. Bell.
</p>
<p>Heskel et al. 2016. Convergence in the temperature response of leaf
respiration across biomes and plant functional types. PNAS 113:3832-3837
</p>
<p>Hobbs et al. 2013. Change in heat capacity for enzyme catalysis
determines temperature dependence of enzyme catalyzed rates. ACS Chemical
Biology 8:2388-2393
</p>
<p>Kruse J, Adams MA. 2008. Three parameters comprehensively describe
the temperature response of respiratory oxygen reduction. Plant
Cell Environ 31:954-967
</p>
<p>Medlyn BE, Dreyer E, Ellsworth D, Forstreuter M, Harley PC,
Kirschbaum MUF, Le Roux X, Montpied P, Strassemeyer J, Walcroft A,
Wang K, Loutstau D. 2002. Temperature response of parameters of a
biochemically based model of photosynthesis. II. A review of
experimental data. Plant Cell Environ 25:1167-1179
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
