<!DOCTYPE html><html><head><title>Help for package WACS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {WACS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ClimateSeries'><p>Synthetic climate series of a french town between 1995 and 2012.</p></a></li>
<li><a href='#WACS'><p>WACS: Multivariate Weather-state Approach Conditionally Skew-normal Generator</p></a></li>
<li><a href='#WACScompare'><p>Performs comparisons between two WACS data structures, or between two WACS simulation series</p></a></li>
<li><a href='#WACSdata'><p>Format data for WACS</p></a></li>
<li><a href='#WACSestim'><p>Estimation of the parameters of a WACS model</p></a></li>
<li><a href='#WACSplot'><p>Produces validation and/or WACS comparison plots</p></a></li>
<li><a href='#WACSplotdensity'><p>For plotting fitted bivariate densities of residuals</p></a></li>
<li><a href='#WACSreadAgroclim'><p>Function that reads a file of format Agroclim</p></a></li>
<li><a href='#WACSsimul'><p>Performs simulations based on estimated parameters of the WACS model</p></a></li>
<li><a href='#WACSvalid'><p>Performs validations of WACS simulations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Weather-State Approach Conditionally Skew-Normal
Generator</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-06-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Denis Allard [aut, cre], Ronan Trépos [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ronan Trépos &lt;ronan.trepos@inrae.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A multivariate weather generator for daily climate variables based 
    on weather-states (Flecher et al. (2010) &lt;<a href="https://doi.org/10.1029%2F2009WR008098">doi:10.1029/2009WR008098</a>&gt;). 
    It uses a Markov chain for modeling the succession of weather states. 
    Conditionally to the weather states, the multivariate variables are modeled using the family 
    of Complete Skew-Normal distributions. Parameters are estimated on measured series. Must 
    include the variable 'Rain' and can accept as many other variables as desired.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://miat.inrae.fr/site/Ronan_TREPOS">https://miat.inrae.fr/site/Ronan_TREPOS</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>mclust, mnormt, tmvtnorm, mvtnorm</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-05 10:27:59 UTC; rtrepos</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-05 12:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='ClimateSeries'>Synthetic climate series of a french town between 1995 and 2012.</h2><span id='topic+ClimateSeries'></span>

<h3>Description</h3>

<p>year : Year
</p>


<h3>Details</h3>

<p>month : Month
</p>
<p>day : Day 
</p>
<p>ETPP : Evaporation and sweating (mm)
</p>
<p>RG : Radiance (Joules/cm²)
</p>
<p>rain : Height of precipitation (mm)
</p>
<p>tmin : Minimum temperature (degré Celsius)
</p>
<p>tmax : Maximum temperature (degré Celsius)
</p>
<p>V : Wind speed (meters per second)
</p>

<hr>
<h2 id='WACS'>WACS: Multivariate Weather-state Approach Conditionally Skew-normal Generator</h2><span id='topic+WACS'></span>

<h3>Description</h3>

<p>WACS is a multivariate weather generator for daily climate variables based
on weather-states that uses a Markov chain for modeling the succession of 
weather states. Conditionally to the weather states,
the multivariate variables are modeled using the family of
Complete Skew-Normal distributions. Parameters are estimated on measured series. 
Must include a 'Rain' variable and can accept as many other variables as desired.
</p>


<h3>WACS functions</h3>


<ul>
<li><p>WACSdata: Builds a data structure compatible with WACS functions
</p>
</li>
<li><p>WACSestim: Estimation of the parameters of a WACS model
</p>
</li>
<li><p>WACSsimul: Performs simulations based on estimated parameters of the WACS model
</p>
</li>
<li><p>WACSvalid: Performs validations of WACS simulations
</p>
</li>
<li><p>WACScompare: Performs comparisons between two WACS data structures, or between two WACS simulation series
</p>
</li>
<li><p>WACSplot: Plots validation figures from WACSvalid and from WACScompare
</p>
</li>
<li><p>WACSplotdensity: Plots fitted bivariate densities of residuals
</p>
</li></ul>



<h3>Authors</h3>

<p>Denis Allard, Ronan Trépos
</p>


<h3>Reference</h3>


<ul>
<li> <p>Flecher C., Naveau P., Allard D., Brisson N.(2010) 
A stochastic weather generator for skewed data. Water Resource Research, 46, W07519
</p>
</li>
<li> <p>WACSgen: model, methods and algorithms (2015). Allard D.,
Biostatistiques et Processus Spatiaux, INRA, Avignon, France. Available at denis.biosp.org
</p>
</li>
<li><p> Flecher, C., Naveau, Ph. and Allard, D. (2009) Estimating the Closed Skew-Normal 
distributions parameters using weighted moments&quot;,  Statistics and Probability Letters, 79, 1977-1984.  
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
  data(ClimateSeries)
  ThisData = WACSdata(ClimateSeries, from="1995-01-01", to="2012-12-31")
  ThisPar  = WACSestim(ThisData)
  ThisSim  = WACSsimul(ThisPar, from="1995-01-01", to="2012-12-31")
  ThisVal  = WACSvalid(what="Sim",wacsdata = ThisData, wacspar = ThisPar, 
                       wacssimul = ThisSim,varname="tmin")
  WACSplot(ThisVal,file="ThisFile.pdf")

## End(Not run)

</code></pre>

<hr>
<h2 id='WACScompare'>Performs comparisons between two WACS data structures, or between two WACS simulation series</h2><span id='topic+WACScompare'></span>

<h3>Description</h3>

<p>The comparison is based on different types of 
statistics computed on WACSdata1 and WACSdata2, or WACSsim1 and WACSsim2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WACScompare(
  what = what,
  wacs1 = wacs1,
  wacspar = wacspar,
  wacs2 = wacs2,
  varname = varname,
  varname2 = NULL,
  base = 0,
  above = T,
  months = 1:12
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WACScompare_+3A_what">what</code></td>
<td>
<p>Type of validation. Possible choices are:
</p>

<table>
<tr>
 <td style="text-align: left;">
<span class="env">="Sim"</span> </td><td style="text-align: left;"> Compares a simulation run to data </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="Rain"</span></td><td style="text-align: left;"> qq-plots of rainfall, per season </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="MeanSd"</span></td><td style="text-align: left;"> Compares monthly mean and standard deviations </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="BiVar"</span></td><td style="text-align: left;"> Compares bivariate correlations </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="CorTemp"</span></td><td style="text-align: left;"> Compares temporal correlations </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="SumBase"</span></td><td style="text-align: left;"> Compares sums above a threshold </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="Persistence"</span></td><td style="text-align: left;"> Compares persistence of a variable above (or below) a threshold </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="WACScompare_+3A_wacs1">wacs1</code></td>
<td>
<p>Either WACS data obtained when calling <a href="#topic+WACSdata">WACSdata</a>, or WACS simulations obtained
when calling <a href="#topic+WACSsimul">WACSsimul</a>.</p>
</td></tr>
<tr><td><code id="WACScompare_+3A_wacspar">wacspar</code></td>
<td>
<p>WACS parameters estimated when calling <a href="#topic+WACSestim">WACSestim</a> on <code>wacs1</code></p>
</td></tr>
<tr><td><code id="WACScompare_+3A_wacs2">wacs2</code></td>
<td>
<p>Either WACS data obtained when calling <a href="#topic+WACSdata">WACSdata</a>, or WACS simulations obtained
when calling <a href="#topic+WACSsimul">WACSsimul</a>. Must be of the same class as <code>wacs1</code></p>
</td></tr>
<tr><td><code id="WACScompare_+3A_varname">varname</code></td>
<td>
<p>Variable on which the validation is performed</p>
</td></tr>
<tr><td><code id="WACScompare_+3A_varname2">varname2</code></td>
<td>
<p>Second variable on which validation is performed (only needed if <code>what=BiVar</code>)</p>
</td></tr>
<tr><td><code id="WACScompare_+3A_base">base</code></td>
<td>
<p>Threshold used for &quot;SumBase&quot; and &quot;Persistence&quot;</p>
</td></tr>
<tr><td><code id="WACScompare_+3A_above">above</code></td>
<td>
<p>Boolean value used for &quot;Persistence&quot;: 
<code>TRUE</code> if data is considered above threshold; 
<code>FALSE</code> otherwise</p>
</td></tr>
<tr><td><code id="WACScompare_+3A_months">months</code></td>
<td>
<p>Months to which the analysis should be restricted (only for &quot;SumBase&quot; and &quot;Persistence&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing all information needed for plots; contains also the type of validation, as a class
</p>


<h3>Note</h3>

<p><code>wacs1</code> and <code>wacs2</code> must be of the same <code>WACS</code> class. 
We must either have 
</p>
<p><code>class(wacs1)=class(wacs2)=class(WACSdata)</code>, 
</p>
<p>or <code>class(wacs1)=class(wacs2)=class(WACSsimul)</code>.
</p>
<p>If <code>what="sim"</code>, data and simulations are displayed as a function of the day of the year, from 1 to 365. 
Smoothed versions daily average and daily envelopes (defined by average +/- 2. standard deviations) are also displayed. 
</p>
<p>If <code>what="rain"</code>, qq-plots and superimposition of histograms and models of rain are produced for each season.
</p>
<p>If <code>what="MeanSd"</code>, boxplots of monthly means and monthly standard deviations are compared. 
The median value of the monthly mean, resp. monthly standard deviation, of the data are displayed 
on top of the boxplots computed on the simulations.
</p>
<p>If <code>what="BiVar"</code>, boxplots of monthly correlations coefficients between <code>varname</code> and <code>varname2</code>
are compared. The median value of the correlation coefficient computed on the data is displayed 
on top of the boxplots computed on the simulations.
</p>
<p>If <code>what="CorTemp"</code>, boxplots of monthly 1-day auto correlation are compared. The median value of the 
auto-correlation coefficient computed on the data is displayed 
on top of the boxplots computed on the simulations.
</p>
<p>If <code>what="SumBase"</code>, boxplots of the sum of the variable <code>varname</code> above a given threshold, <code>base</code>,
is computed during the months provided in the variable <code>months</code>.
</p>
<p>If <code>what="Persistence"</code>, histograms of consecutive days of the variable <code>varname</code> above (or below) a given
threshold,  <code>base</code>, are compared. If <code>above=TRUE</code>, consecutive days above the threshold are computed, 
whereas days below the threshold are computed if <code>above=FALSE</code>. Months can be selected 
with the variable <code>months</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## Simple example
  data(ClimateSeries)
  ThisData = WACSdata(ClimateSeries,from="1995-01-01", to="2005-12-31")
  ThisPar  = WACSestim(ThisData)
  ThatData = WACSdata(ClimateSeries,from="2002-01-01", to="2012-12-31")
  Comp = WACScompare(what="Sim", wacs1=ThisData, wacspar=ThisPar,
                     wacs2=ThatData, varname="tmin")
  WACSplot(Comp)
  Comp = WACScompare(what="MeanSd",wacs1=ThisData, wacspar=ThisPar,
                     wacs2=ThatData, varname="RG")
  WACSplot(Comp)
  Comp = WACScompare(what="SumBase", wacs1=ThisData, wacspar=ThisPar,
                     wacs2=ThatData, varname="tmoy", base=5, months=2:5)
  WACSplot(Comp)
  Comp = WACScompare(what="Persistence",wacs1=ThisData, wacspar=ThisPar,
                     wacs2=ThatData, varname="tmin", base=0, above=FALSE)
  WACSplot(Comp)

## End(Not run)
 
</code></pre>

<hr>
<h2 id='WACSdata'>Format data for WACS</h2><span id='topic+WACSdata'></span>

<h3>Description</h3>

<p><code>WACSdata</code> Builds a data structure compatible with WACS functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WACSdata(
  data,
  mapping = NULL,
  bounds = NULL,
  from = NULL,
  to = NULL,
  skip = NULL,
  Trange = FALSE,
  seasons = c("03-01", "06-01", "09-01", "12-01")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WACSdata_+3A_data">data</code></td>
<td>
<p>A dataframe containing series of values for each variable</p>
</td></tr>
<tr><td><code id="WACSdata_+3A_mapping">mapping</code></td>
<td>
<p>The names of special variables: year, month, day, rain, 
tmin and tmax. Eg. list(RR = &quot;rain&quot;, Tmin = &quot;tmin&quot;) [optional; default is NULL]</p>
</td></tr>
<tr><td><code id="WACSdata_+3A_bounds">bounds</code></td>
<td>
<p>A list of lists indicating the bounds for some variables
eg. list(rain=list(min=0, max=7)) [optional; default is NULL]
If not provided is set automatically according to data</p>
</td></tr>
<tr><td><code id="WACSdata_+3A_from">from</code></td>
<td>
<p>Date at which the estimation should begin [optional; default is NULL]</p>
</td></tr>
<tr><td><code id="WACSdata_+3A_to">to</code></td>
<td>
<p>Date at which the estimation should stop [optional; default is NULL]</p>
</td></tr>
<tr><td><code id="WACSdata_+3A_skip">skip</code></td>
<td>
<p>Vector of column names to skip[optional; default is NULL]</p>
</td></tr>
<tr><td><code id="WACSdata_+3A_trange">Trange</code></td>
<td>
<p>Boolean value. When 
<code>Trange=TRUE</code>, the couple <code>(tmin, trange=tmax-tmin)</code> is modeled. When
<code>Trange=FALSE</code>, he couple <code>(tmin, tmax)</code> is modeled. Default is <code>Trange=FALSE</code></p>
</td></tr>
<tr><td><code id="WACSdata_+3A_seasons">seasons</code></td>
<td>
<p>Vector of string of format 'mm-dd', gives the dates
of change of seasons 
(default: is c(&quot;03-01&quot;, &quot;06-01&quot;, &quot;09-01&quot;,&quot;12-01&quot;))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame structure, which will be used to call <a href="#topic+WACSestim">WACSestim</a>, the function that estimates the parameters of the statistical model.
</p>


<h3>Note</h3>

<p><code>bounds</code> can be provided as a list, as shown above.  If <code>bounds=NULL</code>, bounds are computed from the data. Some variables will have minimal values set automatically to 0
(<code>trange,V,RG,ETPP</code>) and maximal values to 100 (<code>ETPP</code>). Other minimum (resp. maximum) values are computed by adding (resp. subtracting) to 
the maximum (resp. minimum value) its difference to the 10th largest (resp. lowest) value.
</p>
<p><code>from</code> and <code>to</code> must be provided with format 'yyyy-mm-dd' (e.g. '2012-01-30').
</p>
<p>There can be as many seasons as desired, with unequal length. There can also be one single season, in which case a single date is entered. 
</p>
<p>Default is <code>seasons = c("03-01","06-01","09-01","12-01")</code>.
</p>


<h3>Author(s)</h3>

<p>D. Allard, BioSP, Ronan Trépos MIA-T, INRA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## Simple example
  ThisData = WACSdata(ClimateSeries,from="1995-01-01",to="2012-12-31",
                      Trange=F,seasons=c("03-01","06-01","09-01","12-01"))
 
## End(Not run)
 
</code></pre>

<hr>
<h2 id='WACSestim'>Estimation of the parameters of a WACS model</h2><span id='topic+WACSestim'></span>

<h3>Description</h3>

<p>Estimation of the parameters of a WACS model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WACSestim(
  wacsdata,
  spar = 0.7,
  trend.norm = "L2",
  rain.model = "Gamma",
  method = "MLE",
  Vsel = NULL,
  Nclusters = NULL,
  clustering = "soft",
  plot.it = FALSE,
  DIR = "./"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WACSestim_+3A_wacsdata">wacsdata</code></td>
<td>
<p>Data, as returned by WACSdata</p>
</td></tr>
<tr><td><code id="WACSestim_+3A_spar">spar</code></td>
<td>
<p>Smoothing parameter for estimating annual cycle</p>
</td></tr>
<tr><td><code id="WACSestim_+3A_trend.norm">trend.norm</code></td>
<td>
<p>Type of norm used in for computing central tendency
and variation. Must be  <code>"L1"</code> or <code>"L2"</code>.</p>
</td></tr>
<tr><td><code id="WACSestim_+3A_rain.model">rain.model</code></td>
<td>
<p>Model for precipitation. Must be <code>"Gamma"</code> or <code>"None"</code></p>
</td></tr>
<tr><td><code id="WACSestim_+3A_method">method</code></td>
<td>
<p><code>"MLE"</code> or <code>"MOM"</code>. Estimation method for the rain model.</p>
</td></tr>
<tr><td><code id="WACSestim_+3A_vsel">Vsel</code></td>
<td>
<p>Variables (other than rain) on which clustering is 
performed when <code>Vsel=NULL</code>, all variables are considered.</p>
</td></tr>
<tr><td><code id="WACSestim_+3A_nclusters">Nclusters</code></td>
<td>
<p>Number of clusters to consider. When <code>Nclusters = NULL</code>,
absolute best clustering is sought for wet and dry weather
states in each season (up to 4).</p>
</td></tr>
<tr><td><code id="WACSestim_+3A_clustering">clustering</code></td>
<td>
<p>Indicates whether <code>"hard"</code> or <code>"soft"</code> clustering is
considered.</p>
</td></tr>
<tr><td><code id="WACSestim_+3A_plot.it">plot.it</code></td>
<td>
<p>Boolean indicating whether plots are produced</p>
</td></tr>
<tr><td><code id="WACSestim_+3A_dir">DIR</code></td>
<td>
<p>Directory in which placing plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing all parameters; see the user guide for details.
</p>


<h3>Note</h3>

<p>Larger values of <code>spar</code> produce smoother estimates. Smaller values produce less smooth estimates. <code>spar=0.7</code> 
is a good compromise
</p>
<p>Soft clustering means that days have probabilities to belong to each weather state. With hard clustering, 
this probability is set to 1 to the most likely weather state and 0 to all others. Density parameter estimates 
are more robust with <code>clustering="soft"</code>. Clustering is done by means of the mclust package with 
<span class="env">modelNames="VVV"</span>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

 ## For an estimation with default setting 
 ThisPar  = WACSestim(ThisData)

 ## For an estimation with max. 2 dry and wet weather types per season, 
 ## and production of plots
 ThisPar  = WACSestim(ThisData, Nclusters = 1:2, plot.it = TRUE) 

 ## For an estimation with exactly 2 dry and wet weather states per season, 
 ## clustering on variables 3 and 5 only and no production of plots
 ThisPar  = WACSestim(ThisData, Nclusters = 2, Vsel = c(3,5)) 
 
## End(Not run)


</code></pre>

<hr>
<h2 id='WACSplot'>Produces validation and/or WACS comparison plots</h2><span id='topic+WACSplot'></span>

<h3>Description</h3>

<p>For plotting validation figures from outputs generated when calling <a href="#topic+WACSvalid">WACSvalid</a> or <a href="#topic+WACScompare">WACScompare</a>.
Figures are either displayed or printed in a file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WACSplot(wacsvalid, file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WACSplot_+3A_wacsvalid">wacsvalid</code></td>
<td>
<p>Output, as obtained when calling <a href="#topic+WACSvalid">WACSvalid</a> or <a href="#topic+WACScompare">WACScompare</a></p>
</td></tr>
<tr><td><code id="WACSplot_+3A_file">file</code></td>
<td>
<p>File in which to write the figure. Default is <code>NULL</code>. If <code>file=NULL</code>, no file 
is produced; the figure is only produced in the graphical interface</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return. A Figure is either displayed or printed in a file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## Simple example
  data(ClimateSeries)
  ThisData = WACSdata(ClimateSeries)
  ThisPar  = WACSestim(ThisData)
  ThisSim  = WACSsimul(ThisPar, from="1995-01-01", to="2012-12-31")
  ThisVal  = WACSvalid(what="Sim",wacsdata = ThisData, wacspar = ThisPar, 
                       wacssimul = ThisSim,varname="tmin")
  WACSplot(ThisVal,file="ThisFile.pdf")

## End(Not run)

</code></pre>

<hr>
<h2 id='WACSplotdensity'>For plotting fitted bivariate densities of residuals</h2><span id='topic+WACSplotdensity'></span>

<h3>Description</h3>

<p>For plotting fitted bivariate densities of residuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WACSplotdensity(
  wacsdata = NULL,
  wacspar = NULL,
  season,
  dimens = c(1, 2),
  dry = T,
  DIR = "./"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WACSplotdensity_+3A_wacsdata">wacsdata</code></td>
<td>
<p>WACS data obtained when calling <a href="#topic+WACSdata">WACSdata</a> on original climate series</p>
</td></tr>
<tr><td><code id="WACSplotdensity_+3A_wacspar">wacspar</code></td>
<td>
<p>WACS parameters estimated when calling <a href="#topic+WACSestim">WACSestim</a></p>
</td></tr>
<tr><td><code id="WACSplotdensity_+3A_season">season</code></td>
<td>
<p>season to be considered (a scalar)</p>
</td></tr>
<tr><td><code id="WACSplotdensity_+3A_dimens">dimens</code></td>
<td>
<p>a vector of length 1 or 2 indicating the marginals to be plotted</p>
</td></tr>
<tr><td><code id="WACSplotdensity_+3A_dry">dry</code></td>
<td>
<p>indicates whether dry weather states (if <code>dry=TRUE</code>) or wet weather states (if <code>dry=FALSE</code>) must be considered</p>
</td></tr>
<tr><td><code id="WACSplotdensity_+3A_dir">DIR</code></td>
<td>
<p>Directory in which saving the Figures</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If <code>length(dimens)=1</code>, the bivariate density of the variable at days <code>(d,d+1)</code> is plotted. 
If <code>length(dimens)=2</code>, the same-day bivariate density of the pair of variables is plotted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## Simple example
  data(ClimateSeries)
  ThisData = WACSdata(ClimateSeries)
  ThisPar  = WACSestim(ThisData)
  WACSplotdensity(ThisData,ThisPar,season=2,dimens=c(2,3),dry=TRUE) 

## End(Not run)

</code></pre>

<hr>
<h2 id='WACSreadAgroclim'>Function that reads a file of format Agroclim</h2><span id='topic+WACSreadAgroclim'></span>

<h3>Description</h3>

<p>Function that reads a file of format Agroclim
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WACSreadAgroclim(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WACSreadAgroclim_+3A_filename">filename</code></td>
<td>
<p>path to the filemane to read</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 2 objects:
</p>

<ul>
<li><p>dataThe table data
</p>
</li>
<li><p>mappingThe names of special var: year, month, day rain,
tmin and tmax
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  # using an agroclim format file
  WACSdata(WACSreadAgroclim("myfile.csv"))

## End(Not run)
</code></pre>

<hr>
<h2 id='WACSsimul'>Performs simulations based on estimated parameters of the WACS model</h2><span id='topic+WACSsimul'></span>

<h3>Description</h3>

<p>Performs simulations based on estimated parameters of the WACS model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WACSsimul(wacspar, from, to, first.day = NULL, REJECT = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WACSsimul_+3A_wacspar">wacspar</code></td>
<td>
<p>Parameters of the WACS model estimated with WACSestim</p>
</td></tr>
<tr><td><code id="WACSsimul_+3A_from">from</code></td>
<td>
<p>Starting date of the simulation (format: &quot;yyyy-mm-dd&quot;)</p>
</td></tr>
<tr><td><code id="WACSsimul_+3A_to">to</code></td>
<td>
<p>Ending date of the simulation (format: &quot;yyyy-mm-dd&quot;)</p>
</td></tr>
<tr><td><code id="WACSsimul_+3A_first.day">first.day</code></td>
<td>
<p>Conditioning values for first day (optional)</p>
</td></tr>
<tr><td><code id="WACSsimul_+3A_reject">REJECT</code></td>
<td>
<p>Boolean indicating whether a rejection technique is used to guarantee variables within bounds.
Default is FALSE. In this case, values outside bounds are forced to the bounds.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the simulation results
</p>


<h3>Note</h3>

<p>Variables are simulated sequentially: day d is simulated conditionally on the values at day (d-1).
If <code>REJECT=TRUE</code>, a rejection technique is used to force simulated variables within the bounds. 
If <code>REJECT=FALSE</code>, variables that could have been simulated outside the bounds are forced to the limits.
The rejection technique tends to produce biases. <code>REJECT=FALSE</code> is thus recommended
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## Simple example
  data(ClimateSeries)
  ThisData = WACSdata(ClimateSeries)
  ThisPar  = WACSestim(ThisData)
  ThisSim  = WACSsimul(ThisPar, from="1995-01-01", to="2012-12-31")

## End(Not run)
</code></pre>

<hr>
<h2 id='WACSvalid'>Performs validations of WACS simulations</h2><span id='topic+WACSvalid'></span>

<h3>Description</h3>

<p>The validation is based on different types of 
statistics computed on  WACS data, WACS parameters and WACS simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WACSvalid(
  what = "Sim",
  wacsdata = NULL,
  wacspar = NULL,
  wacssimul = NULL,
  varname = NULL,
  varname2 = NULL,
  base = 0,
  above = TRUE,
  months = 1:12
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WACSvalid_+3A_what">what</code></td>
<td>
<p>Type of validation. Possible choices are:
</p>

<table>
<tr>
 <td style="text-align: left;">
<span class="env">="Sim"</span> </td><td style="text-align: left;"> Compares a simulation run to data </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="Rain"</span></td><td style="text-align: left;"> qq-plots of rainfall, per season </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="MeanSd"</span></td><td style="text-align: left;"> Compares monthly mean and standard deviations </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="BiVar"</span></td><td style="text-align: left;"> Compares monthly variate correlations </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="CorTemp"</span></td><td style="text-align: left;"> Compares monthly temporal correlations </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="SumBase"</span></td><td style="text-align: left;"> Compares sums above a threshold </td>
</tr>
<tr>
 <td style="text-align: left;">
<span class="env">="Persistence"</span></td><td style="text-align: left;"> Compares persistence of a variable above (or below) a threshold </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="WACSvalid_+3A_wacsdata">wacsdata</code></td>
<td>
<p>WACS data obtained when calling <a href="#topic+WACSdata">WACSdata</a></p>
</td></tr>
<tr><td><code id="WACSvalid_+3A_wacspar">wacspar</code></td>
<td>
<p>WACS parameters estimated when calling <a href="#topic+WACSestim">WACSestim</a></p>
</td></tr>
<tr><td><code id="WACSvalid_+3A_wacssimul">wacssimul</code></td>
<td>
<p>WACS simulation obtained when calling <a href="#topic+WACSsimul">WACSsimul</a></p>
</td></tr>
<tr><td><code id="WACSvalid_+3A_varname">varname</code></td>
<td>
<p>Variable on which the validation is performed</p>
</td></tr>
<tr><td><code id="WACSvalid_+3A_varname2">varname2</code></td>
<td>
<p>Second variable on which validation is performed (only needed if <code>what=BiVar</code>)</p>
</td></tr>
<tr><td><code id="WACSvalid_+3A_base">base</code></td>
<td>
<p>Threshold used for &quot;SumBase&quot; and &quot;Persistence&quot;</p>
</td></tr>
<tr><td><code id="WACSvalid_+3A_above">above</code></td>
<td>
<p>Boolean value used for &quot;Persistence&quot;: 
TRUE if data is considered above threshold; 
FALSE otherwise</p>
</td></tr>
<tr><td><code id="WACSvalid_+3A_months">months</code></td>
<td>
<p>Months to which the analysis should be restricted (only for &quot;SumBase&quot; and &quot;Persistence&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing all information needed for plots; contains also the type of validation, as a class
</p>


<h3>Note</h3>

<p>If <code>what=sim</code>, data and simulations are displayed as a function of the day of the year, from 1 to 365. 
Smoothed versions of daily average and daily envelopes (defined by average +/- 2. standard deviations) are also displayed. 
</p>
<p>If <code>what=rain</code>, qq-plots and superimposition of histograms and models of rain are produced for each season.
</p>
<p>If <code>what=MeanSd</code>, boxplots of monthly means and monthly standard deviations are compared. 
The median value of the monthly mean, resp. monthly standard deviation, of the data are displayed 
on top of the boxplots computed on the simulations.
</p>
<p>#' If <code>what=BiVar</code>, boxplots of monthly correlations coefficients between <code>varname</code> and <code>varname2</code>
are compared. The median value of the correlation coefficient computed on the data is displayed 
on top of the boxplots computed on the simulations.
</p>
<p>If <code>what=CorTemp</code>, boxplots of monthly 1-day auto correlation are compared. The median value of the 
auto-correlation coefficient computed on the data is displayed 
on top of the boxplots computed on the simulations.
</p>
<p>If <code>what=SumBase</code>, boxplots of the sum of the variable <code>varname</code> above a given threshold, <code>base</code>,
is computed during the months provided in the variable <code>months</code>.
</p>
<p>If <code>what=Persistence</code>, histograms of consecutive days of the variable <code>varname</code> above (or below) a given
threshold,  <code>base</code>, are compared. If <code>above=TRUE</code>, consecutive days above the threshold are computed, 
whereas days below the threshold are computed if <code>above=FALSE</code>. Months can be selected 
with the variable <code>months</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## Simple example
  data(ClimateSeries)
  ThisData = WACSdata(ClimateSeries)
  ThisPar  = WACSestim(ThisData)
  ThisSim  = WACSsimul(ThisPar, from="1995-01-01", to="2012-12-31")
  Val1 = WACSvalid(what="Sim",wacsdata = ThisData, 
                   wacspar = ThisPar, wacssimul = ThisSim, varname="tmin")
  Val2 = WACSvalid(what="MeanSd",wacsdata = ThisData, 
                   wacssimul = ThisSim, varname="RG")
  Val3 = WACSvalid(what="SumBase", wacsdata = ThisData,  
                   wacssimul = ThisSim, varname="tmoy", base=5, month=2:5)
  Val4 = WACSvalid(what="Persistence",wacsdata = ThisData,  
                   wacssimul = ThisSim, varname="tmin", base=0, above=FALSE)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
