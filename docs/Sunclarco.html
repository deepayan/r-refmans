<!DOCTYPE html><html><head><title>Help for package Sunclarco</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Sunclarco}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#insem'><p>Insemination Data</p></a></li>
<li><a href='#Sunclarco'><p>Survival analysis for unbalanced clusters using archimedes copula's.</p></a></li>
<li><a href='#SunclarcoModel'><p>Sunclarco Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Survival Analysis using Copulas</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-10-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Leen Prenen, Roel Braekers, Luc Duchateau and Ewoud De Troyer</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Roel Braekers &lt;roel.braekers@uhasselt.be&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Survival analysis for unbalanced clusters using Archimedean copulas (Prenen et al. (2016) &lt;<a href="https://doi.org/10.1111%2Frssb.12174">doi:10.1111/rssb.12174</a>&gt;).</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, stats, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-10-04 13:40:39 UTC; lucp8394</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-10-04 17:15:48 UTC</td>
</tr>
</table>
<hr>
<h2 id='insem'>Insemination Data</h2><span id='topic+insem'></span>

<h3>Description</h3>

<p>In dairy cattle, the calving interval (the time between two calvings) should be optimally 
between 12 and 13 months.
One of the main factors determining the length of the calving interval is the time from parturition
to the time of first insemination (Time variable in the data set).
The data set includes 181 clusters (Herd variable in the data set) of different sizes.
The parity of the cow (0 if multiparous; 1 if primiparous) is added as a covariate (Heifer in the data set).
</p>


<h3>Format</h3>

<p>A dataframe with 10513 rows and 5 columns.</p>

<hr>
<h2 id='Sunclarco'>Survival analysis for unbalanced clusters using archimedes copula's.</h2><span id='topic+Sunclarco'></span><span id='topic+Sunclarco-package'></span>

<h3>Description</h3>

<p>Multivariate survival data occur in many different disciplines. 
If the correlation in the data is of interest by itself, two main modeling tools exist, the frailty model (Duchateau and Janssen, 2008) and the copula model.
The use of copula modeling has been restricted due to the lack of software on the one hand.     
On the other hand, copula models mainly deal theoretically with small clusters, all of equal size, i.e., containing the same number of subjects.    
The Sunclarco package can handle large unbalanced clusters, i.e., of varying size.
This allows the use of copula models to data sets that could previously not be handled, e.g., multicentre cancer clinical trials.
Furthermore, the Sunclarco package is flexible in terms of the baseline hazard (Weibull, piecewise exponential, unspecified (using partial likelihood) and in terms of the copula function (Clayton and Gumbel-Hougaard).
</p>


<h3>Author(s)</h3>

<p>Leen Prenen
</p>
<p>Ewoud De Troyer
</p>
<p>Roel Braekers
</p>
<p>Luc Duchateau
</p>


<h3>References</h3>

<p>Prenen L, Braekers R, Duchateau L (2017). Extending the Archimedean copula methodology to model multivariate survival data grouped in clusters of variable size. Journal of the Royal Statistical Society, 6, 1-24.
</p>
<p>Duchateau L, Janssen P. (2008). The frailty model. Spinger Verlag.
</p>

<hr>
<h2 id='SunclarcoModel'>Sunclarco Model</h2><span id='topic+SunclarcoModel'></span>

<h3>Description</h3>

<p>Model for Survival Analysis of Unbalanced Clusters using Archimedes Copula's.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SunclarcoModel(data, time, status, clusters, covariates, stage = 1,
  copula = "Clayton", marginal = "Weibull", n.piecewise = 20,
  init.values = NULL, baselevels = NULL, verbose = TRUE,
  summary.print = TRUE, optim.method = NULL, optim.bounds = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SunclarcoModel_+3A_data">data</code></td>
<td>
<p>Input dataframe containing all variables.</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_time">time</code></td>
<td>
<p>Which variable name is the time covariate?</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_status">status</code></td>
<td>
<p>The status indicator, 0=alive, 1=dead.</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_clusters">clusters</code></td>
<td>
<p>The variable name describing the clusters.</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_covariates">covariates</code></td>
<td>
<p>A vector of one or more covariates to be included in the model. Categorical covariates should be a factor in this data frame.</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_stage">stage</code></td>
<td>
<p>Denotes whether the one-stage (<code>stage=1</code>, default) or the two-stage (<code>stage=2</code>) approach should be used. See Details for more information.</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_copula">copula</code></td>
<td>
<p>Denotes which copula to use. Can be <code>"Clayton"</code> (default) or <code>"GH"</code> for Gumbel-Hougaard.</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_marginal">marginal</code></td>
<td>
<p>Denotes which marginal survival function to use. Can be <code>"Weibull"</code> (default), <code>"PiecewiseExp"</code> for Piecewise Exponential or <code>"Cox"</code> for non-parametric.</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_n.piecewise">n.piecewise</code></td>
<td>
<p>For <code>marginal="PiecewiseExp"</code>, denotes how many pieces the Piecewise Exponential should have (Default = 20).</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_init.values">init.values</code></td>
<td>
<p>A List object which contains the initial values for the parameters. This depends on the choice of the parameters <code>stage</code>, <code>copula</code> and <code>marginal</code>. See the <em>Initial Values</em> Section for more information. If no initial parameters are given, they will be chosen automatically (See Details for more information).</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_baselevels">baselevels</code></td>
<td>
<p>Denotes the level of a categorical covariate in the <code>covariates</code> vector to be used as baseline. If not set, the first appearing level will be used as the baseline level. The specification should be done as a character vector and the names of this vector should coincide with the chosen factor variable (e.g. <code>c(disease='Other',region='Region1')</code> in which <code>disease</code> and <code>region</code> are factor covariates).</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_verbose">verbose</code></td>
<td>
<p>Print some in-between results as well as computation progress.</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_summary.print">summary.print</code></td>
<td>
<p>Logical value to print a short summary at the end of the computation.</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_optim.method">optim.method</code></td>
<td>
<p>Method used for optimization in one-stage estimation or in second stage of two-stage estimation. Can either be <code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code> or <code>"Brent"</code>. Default in one-stage estimation is <code>"Nelder-Mead"</code> with Weibull margins and <code>"BFGS"</code> with piecewise exponential margins. Default in two-stage estimation is <code>"Brent"</code>, except for the combination of Gumbel copula with Weibull margins, where the default is <code>"BFGS"</code>.</p>
</td></tr>
<tr><td><code id="SunclarcoModel_+3A_optim.bounds">optim.bounds</code></td>
<td>
<p>Lower and upper bounds on the variables for the <code>"L-BFGS-B"</code> method, or bounds in which to search for method <code>"Brent"</code>. Should be a vector of length 2 in which the first element is the lower and the second the upper bound (e.g. <code>c(-Inf,Inf)</code>). 
If <code>optim.method = NULL</code> and <code>"Brent"</code> is used, then default bounds will be chosen. Otherwise, <code>optim.bounds</code> is defaulted to <code>c(-Inf,Inf)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All copula models, regardless the choice of the marginal survival function, can be fitted with the two-stage approach.
The one-stage approach, however, is only available for the <code>"Weibull"</code> and <code>"PiecewiseExp"</code> marginal survival functions choice.
The one-stage approach is preferred as it leads to less biased estimates in the case of small sample sizes.  
When no initial values for the parameters are given, initial values for the optimisation procedure will be derived in the following way.
Initial values for the marginal survival functions are obtained by estimating the parameters marginally, i.e., without taking into consideration the copula function.
In the two-stage approach, these estimates are fixed, whereas in the one-stage approach, they are parameters in the optimisation.
The association parameter is set arbitrarily to 0.5 for <code>"Clayton"</code> 0.55 for <code>"GH"</code>.
An initial value for the association parameter can be supplied as <code>c(theta=value)</code> 
Initial values for the marginal survival function parameters can only be supplied for the <code>"Weibull"</code> choice as <code>c(lambda=value,rho=value)</code>
Initial values for the beta parameters from continuous covariates can be supplied as <code>c(beta_variablename=value)</code>
Initial values for the beta parameters from categorical covariates can be supplied as <code>c(beta_variablename_level=value)</code>
</p>


<h3>Value</h3>

<p>S3 List object
</p>

<ul>
<li> <p><code>Parameters</code>: Data frame containing estimates and standard errors of parameters.
</p>
</li>
<li> <p><code>Kendall_Tau</code>: Vector containing estimate and standard error of Kendall's Tau.
</p>
</li>
<li> <p><code>ParametersCov</code>: If available, covariance matrix of the parameters. For 2-stage approaches this is only available for the Weibull marginal.
</p>
</li>
<li> <p><code>logllh</code>: The log-likelihood value.
</p>
</li>
<li> <p><code>parameter.call</code>: A list containing all arguments given to the function, as well as the initial parameter values and the elapsed time.
</p>
</li></ul>



<h3>Initial Values</h3>

<p>Initial values are provided in a <code>list()</code> object as following:
</p>
<p><code>list(lambda=c(0.5),
           rho=0.5,
           theta=0.5
           beta=c(0.5))</code>
</p>
<p><strong>Not all initial values need to be provided!</strong> If only some of the initial values are provided, all initial parameters will be estimated (see Details),
but the provided initial values will overwrite the generated ones.
</p>
<p>Depending on the <code>stage</code> and <code>marginal</code> parameter,
different initial values can be provided:
</p>

<ul>
<li> <p><em>One-Stage</em>:
</p>

<ul>
<li><p> Weibull Marginal
</p>

<ul>
<li> <p><code>lambda</code>: Single initial value for marginal survival function.
</p>
</li>
<li> <p><code>rho</code>: Single initial value for marginal survival function.
</p>
</li>
<li> <p><code>theta</code>: Single initial value for the association parameter.
</p>
</li>
<li> <p><code>beta:</code>  Vector of multiple initial values for the continuous/categorical covariates.
</p>
</li></ul>

</li>
<li><p> Piecewise Exponential Marginal
</p>

<ul>
<li> <p><code>lambda</code>: Vector of multiple initial value for marginal survival function. The length of this vector should be the number of <code>n.piecewise</code> (see note down below).
</p>
</li>
<li> <p><code>theta</code>: Single initial value for the association parameter.
</p>
</li>
<li> <p><code>beta:</code>  Vector of multiple initial values for the continuous/categorical covariates.
</p>
</li></ul>
 
</li></ul>

</li>
<li> <p><em>Two-Stage</em>:
</p>

<ul>
<li><p> Weibull or Cox Marginal
</p>

<ul>
<li> <p><code>theta</code>: Single initial value for the association parameter.
</p>
</li></ul>

</li>
<li><p> Piecewise Exponential Marginal
</p>

<ul>
<li> <p><code>lambda</code>: Vector of multiple initial value for marginal survival function. The length of this vector should be the number of <code>n.piecewise</code> (see note down below).
</p>
</li>
<li> <p><code>theta</code>: Single initial value for the association parameter.
</p>
</li>
<li> <p><code>beta:</code>  Vector of multiple initial values for the continuous/categorical covariates.
</p>
</li></ul>

</li></ul>
 
</li></ul>

<p><strong>Initial Values Boundaries</strong>
</p>

<ul>
<li> <p><code class="reqn">\lambda&gt;0</code>
</p>
</li>
<li> <p><code class="reqn">\rho&gt;0</code>
</p>
</li>
<li> <p><code class="reqn">\theta</code>:
</p>

<ul>
<li><p> GH Copula: <code class="reqn">\theta&gt;0</code> &amp; <code class="reqn">\theta&lt;1</code> 
</p>
</li>
<li><p> Clayton Copula: <code class="reqn">\theta&gt;0</code>
</p>
</li></ul>

</li></ul>

<p><strong>Note on <code>lambda</code> and <code>beta</code></strong>
</p>
<p>For the Piecewise Exponential marginal, multiple <code class="reqn">\lambda</code>'s should be provided
in the <code>lambda</code> slot as a vector. This vector can have a maximum length of the
number of pieces there were chosen (<code>n.piecewise</code>). In the scenario not all <code class="reqn">\lambda</code>'s
are provided, only the first few <code class="reqn">\lambda</code>'s are overwritten.
</p>
<p>In the <code>beta</code> slot, as many <code class="reqn">\beta</code>'s should be provided as there are 
<code>covariates</code> (as well as in the same order of the <code>covariates</code> parameter). If one of the covariates is a
categorical variable (<code>factor</code>), multiple <code class="reqn">\beta</code>'s should be provided for
a single covariate (namely the number of levels minus 1). In the scenario not all <code class="reqn">\beta</code>'s
are provided, only the first few <code class="reqn">\beta</code>'s are overwritten.
</p>


<h3>References</h3>

<p>Prenen L, Braekers R, Duchateau L (2017). Extending the Archimedean copula methodology to model multivariate survival data grouped in clusters of variable size. Journal of the Royal Statistical Society, 6, 1-24.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
## Not run: 
data("insem",package="Sunclarco")
result1 &lt;- SunclarcoModel(data=insem,time="Time",status="Status",
                          clusters="Herd",covariates="Heifer",
                          stage=1,copula="Clayton",marginal="Weibull")

summary(result1)

result2 &lt;- SunclarcoModel(data=insem,time="Time",status="Status",
                          clusters="Herd",covariates="Heifer",
                          stage=1,copula="GH",marginal="PiecewiseExp")
summary(result2)


result3 &lt;- SunclarcoModel(data=kidney,time="time",status="status",
                          clusters="id",covariates="sex",
                          stage=2,copula="Clayton",marginal="Weibull")

summary(result3)

result4 &lt;- SunclarcoModel(data=kidney,time="time",status="status",
                          clusters="id",covariates="sex",
                          stage=2,copula="Clayton",marginal="Cox")

summary(result4)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
