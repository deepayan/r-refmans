<!DOCTYPE html><html lang="en"><head><title>Help for package NestMRMC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NestMRMC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AUC_cov_2reader_nest'><p>Function for calculating 2 reader AUC covariance</p></a></li>
<li><a href='#AUC_per_reader_nest'><p>MRMC analysis in nested data problem</p></a></li>
<li><a href='#cov_m8_f1'><p>covariance 8th moment middle calculation part one</p></a></li>
<li><a href='#cov_m8_f2'><p>covariance 8th moment middle calculation part two</p></a></li>
<li><a href='#data_MRMC'><p>Simulation function</p></a></li>
<li><a href='#delete_diag'><p>Delete diagonal term function</p></a></li>
<li><a href='#expected_data'><p>The test demo data to be included in my package</p></a></li>
<li><a href='#m11_f'><p>function for calculating the 11th moment</p></a></li>
<li><a href='#m8_f'><p>function for calculating the 8th moment</p></a></li>
<li><a href='#simu_config'><p>Configuration function</p></a></li>
<li><a href='#success_score'><p>Calculate the success score</p></a></li>
<li><a href='#sum_diag'><p>sum the diagonal terms</p></a></li>
<li><a href='#true_AUC_var_abitrary'><p>Calculate the between-cases AUC estimator's theoretical variance and covariance</p></a></li>
<li><a href='#true_AUC_var_abitrary_Rcpp'><p>Calculate the between-cases AUC estimator's theoretical variance and covariance</p></a></li>
<li><a href='#var_coef'><p>Calculate the each moments coefficient in variance</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Single Reader Between-Cases AUC Estimator in Nested Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>This R package provides a calculation of between-cases AUC estimate, corresponding covariance, and variance estimate in the nested data problem.  Also, the package has the function to simulate the nested data. The calculated between-cases AUC estimate is used to evaluate the reader's diagnostic performance in clinical tasks with nested data. For more details on the above methods, please refer to the paper by H Du, S Wen, Y Guo, F Jin, BD Gallas (2022) &lt;<a href="https://doi.org/10.1177%2F09622802221111539">doi:10.1177/09622802221111539</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>magrittr, dplyr, mvtnorm, iMRMC, Rcpp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-21 01:19:20 UTC; duson</td>
</tr>
<tr>
<td>Author:</td>
<td>Hongfei Du <a href="https://orcid.org/0000-0002-0633-594X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hongfei Du &lt;hongfei@gwmail.gwu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-21 15:07:51 UTC</td>
</tr>
</table>
<hr>
<h2 id='AUC_cov_2reader_nest'>Function for calculating 2 reader AUC covariance</h2><span id='topic+AUC_cov_2reader_nest'></span>

<h3>Description</h3>

<p>Function for calculating 2 reader AUC covariance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AUC_cov_2reader_nest(success_score)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AUC_cov_2reader_nest_+3A_success_score">success_score</code></td>
<td>
<p>The success score for nested data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the covariance between two readers' AUC
</p>

<hr>
<h2 id='AUC_per_reader_nest'>MRMC analysis in nested data problem</h2><span id='topic+AUC_per_reader_nest'></span>

<h3>Description</h3>

<p>This function takes nested data as a data frame and runs a multi-reader multi-case analysis for single reader in nested
data problem based on modified U-statistics as described in the following paper:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AUC_per_reader_nest(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AUC_per_reader_nest_+3A_data">data</code></td>
<td>
<p>The nested data for analysis. This dataset should have specified columns:
&quot;patient&quot;,&quot;reader1&quot;,&quot;reader2&quot;,&quot;reader3&quot;,&quot;reader4&quot;,&quot;reader5&quot;,&quot;truth&quot;,&quot;mod&quot;,&quot;region&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a <a href="base.html#topic+list">list</a> containing three dataframes.
</p>
<div class="sourceCode"><pre>    Here is a quick summary:

        AUC_per_reader [data.frame] this data frame contains the AUC estimates for each reader under different modalities (Mod1 denotes modality 1 and Mod2 denotes modality 2). 

        AUC_Var_per_reader [data.frame] this data frame contains the AUC variance estimates for each reader under different modalities.
        
        numROI [data.frame] this data frame contains the number of positive and negative ROIs in each case. 
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>
 
data = NestMRMC::expected_data

Outputs = AUC_per_reader_nest(data)


</code></pre>

<hr>
<h2 id='cov_m8_f1'>covariance 8th moment middle calculation part one</h2><span id='topic+cov_m8_f1'></span>

<h3>Description</h3>

<p>covariance 8th moment middle calculation part one
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_m8_f1(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov_m8_f1_+3A_m">m</code></td>
<td>
<p>input matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the middle values for calculating covariance 8th moment
</p>

<hr>
<h2 id='cov_m8_f2'>covariance 8th moment middle calculation part two</h2><span id='topic+cov_m8_f2'></span>

<h3>Description</h3>

<p>covariance 8th moment middle calculation part two
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_m8_f2(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov_m8_f2_+3A_m">m</code></td>
<td>
<p>input matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the middle values for calculating covariance 8th moment
</p>

<hr>
<h2 id='data_MRMC'>Simulation function</h2><span id='topic+data_MRMC'></span>

<h3>Description</h3>

<p>Simulation function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_MRMC(sim.config)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_MRMC_+3A_sim.config">sim.config</code></td>
<td>
<p>list contains following parameters:
I  num The number of patients.
k  num The number of ROIs in each patient.
R num The number of readers.
correlation_t num The correlation for simulating truth label.
potential_correlation_s num The correlation for simulating reading scores.
AUC_all num The theoretical AUC values.
sameclustersize boolean The binary variable to decide whether we have same number of ROIs in each patient.
rho num The scale parameter that infulence the covariance matrix in multivariate normal distribution.
fix_design boolean Binary variable to decide whether fix the truth label in simulation.
stream num The integer control the random number generator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list and the only element in the list is the simulated data with following columns:
&quot;clusterID&quot;,&quot;unitID&quot;,&quot;reader1&quot;,...,&quot;truth&quot;
</p>

<hr>
<h2 id='delete_diag'>Delete diagonal term function</h2><span id='topic+delete_diag'></span>

<h3>Description</h3>

<p>Delete diagonal term function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delete_diag(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="delete_diag_+3A_m">m</code></td>
<td>
<p>the input matrix for deleting diagonal term</p>
</td></tr>
</table>


<h3>Value</h3>

<p>diagonal term removed matrix
</p>

<hr>
<h2 id='expected_data'>The test demo data to be included in my package</h2><span id='topic+expected_data'></span>

<h3>Description</h3>

<p>The test demo data to be included in my package
</p>


<h3>Author(s)</h3>

<p>Hongfei Du <a href="mailto:hongfei@gwu.edu">hongfei@gwu.edu</a>
</p>

<hr>
<h2 id='m11_f'>function for calculating the 11th moment</h2><span id='topic+m11_f'></span>

<h3>Description</h3>

<p>function for calculating the 11th moment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m11_f(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="m11_f_+3A_m">m</code></td>
<td>
<p>input matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the 11th moment
</p>

<hr>
<h2 id='m8_f'>function for calculating the 8th moment</h2><span id='topic+m8_f'></span>

<h3>Description</h3>

<p>function for calculating the 8th moment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m8_f(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="m8_f_+3A_m">m</code></td>
<td>
<p>input matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the 8th moment
</p>

<hr>
<h2 id='simu_config'>Configuration function</h2><span id='topic+simu_config'></span>

<h3>Description</h3>

<p>Configuration function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simu_config(
  I = 100,
  k = 10,
  R = 2,
  correlation_t = 0,
  potential_correlation_s = rep(0.5, 4),
  AUC_all = rep(0.7, 2),
  sameclustersize = TRUE,
  rho = 0.5,
  fix_design = FALSE,
  stream = 20220210,
  initial_seed = 20220222
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simu_config_+3A_i">I</code></td>
<td>
<p>The number of patients.</p>
</td></tr>
<tr><td><code id="simu_config_+3A_k">k</code></td>
<td>
<p>The number of ROIs in each patient.</p>
</td></tr>
<tr><td><code id="simu_config_+3A_r">R</code></td>
<td>
<p>The number of readers.</p>
</td></tr>
<tr><td><code id="simu_config_+3A_correlation_t">correlation_t</code></td>
<td>
<p>The correlation for simulating truth label.</p>
</td></tr>
<tr><td><code id="simu_config_+3A_potential_correlation_s">potential_correlation_s</code></td>
<td>
<p>The correlation for simulating reading scores.</p>
</td></tr>
<tr><td><code id="simu_config_+3A_auc_all">AUC_all</code></td>
<td>
<p>The theoretical AUC values.</p>
</td></tr>
<tr><td><code id="simu_config_+3A_sameclustersize">sameclustersize</code></td>
<td>
<p>The binary variable to decide whether we have same number of ROIs in each patient.</p>
</td></tr>
<tr><td><code id="simu_config_+3A_rho">rho</code></td>
<td>
<p>The scale parameter that influence the covariance matrix in multivariate normal distribution.</p>
</td></tr>
<tr><td><code id="simu_config_+3A_fix_design">fix_design</code></td>
<td>
<p>Binary variable to decide whether fix the truth label in simulation.</p>
</td></tr>
<tr><td><code id="simu_config_+3A_stream">stream</code></td>
<td>
<p>The integer control the random number generator.</p>
</td></tr>
<tr><td><code id="simu_config_+3A_initial_seed">initial_seed</code></td>
<td>
<p>The integer control the random seed for truth label generation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of above parameters
</p>

<hr>
<h2 id='success_score'>Calculate the success score</h2><span id='topic+success_score'></span>

<h3>Description</h3>

<p>Calculate the success score
</p>


<h3>Usage</h3>

<pre><code class='language-R'>success_score(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="success_score_+3A_data">data</code></td>
<td>
<p>the nested MRMC data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The success score and number of ROIs in each case
</p>

<hr>
<h2 id='sum_diag'>sum the diagonal terms</h2><span id='topic+sum_diag'></span>

<h3>Description</h3>

<p>sum the diagonal terms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_diag(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sum_diag_+3A_m">m</code></td>
<td>
<p>input matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sum of diagonal terms
</p>

<hr>
<h2 id='true_AUC_var_abitrary'>Calculate the between-cases AUC estimator's theoretical variance and covariance</h2><span id='topic+true_AUC_var_abitrary'></span>

<h3>Description</h3>

<p>This function calculates between-cases AUC estimator's theoretical variance and covariance based on all the truths, namely, the ROI's truth labels, AUC values, covariance between ROI scores
within same reader, scale factor that influences the covariance between ROI scores between readers and the variances for
positive and negative ROI scores. Detailed formulas are available in following paper:
Single Reader Between-Cases AUC Estimator with Nested Data. Statistical Methods in Medical Research. https://doi.org/10.1177/09622802221111539.
There is also a Rcpp version of this function in this package. The function name is 'true_AUC_var_abitrary_Rcpp', which is much faster than current version. They produce the exact same results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>true_AUC_var_abitrary(
  numROI,
  AUC = 0.7,
  cov = 0.5,
  rho = 0.5,
  sigma_pos = 1,
  sigma_neg = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="true_AUC_var_abitrary_+3A_numroi">numROI</code></td>
<td>
<p>The number of positive and negative ROIs in all the patients.</p>
</td></tr>
<tr><td><code id="true_AUC_var_abitrary_+3A_auc">AUC</code></td>
<td>
<p>The AUC values used in simulated data.</p>
</td></tr>
<tr><td><code id="true_AUC_var_abitrary_+3A_cov">cov</code></td>
<td>
<p>The covariance used in simulating reading scores.</p>
</td></tr>
<tr><td><code id="true_AUC_var_abitrary_+3A_rho">rho</code></td>
<td>
<p>The scale factor used in simulating reading scores.</p>
</td></tr>
<tr><td><code id="true_AUC_var_abitrary_+3A_sigma_pos">sigma_pos</code></td>
<td>
<p>The variacne for positive ROI's reading score, defalut is 1.</p>
</td></tr>
<tr><td><code id="true_AUC_var_abitrary_+3A_sigma_neg">sigma_neg</code></td>
<td>
<p>The variacne for negative ROI's reading score, defalut is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The theoretical AUC estimator's (co)variance based on the simulation settings.
</p>

<hr>
<h2 id='true_AUC_var_abitrary_Rcpp'>Calculate the between-cases AUC estimator's theoretical variance and covariance</h2><span id='topic+true_AUC_var_abitrary_Rcpp'></span>

<h3>Description</h3>

<p>This function calculates between-cases AUC estimator's theoretical variance and covariance based on all the truths, namely, the ROI's truth labels, AUC values, covariance between ROI scores
within same reader, scale factor that influences the covariance between ROI scores between readers and the variances for
positive and negative ROI scores. Detailed formulas are available in following paper: Single Reader Between-Cases AUC Estimator with Nested Data. Statistical Methods in Medical Research. https://doi.org/10.1177/09622802221111539.
There is also a none Rcpp version of this function in this package. The function name is 'true_AUC_var_abitrary', which is slower but no need to install Rcpp. They produce the exact same results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>true_AUC_var_abitrary_Rcpp(
  numROI,
  AUC = 0.7,
  cov = 0.5,
  rho = 0.5,
  sigma_pos = 1,
  sigma_neg = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="true_AUC_var_abitrary_Rcpp_+3A_numroi">numROI</code></td>
<td>
<p>The number of positive and negative ROIs in all the patients.</p>
</td></tr>
<tr><td><code id="true_AUC_var_abitrary_Rcpp_+3A_auc">AUC</code></td>
<td>
<p>The AUC values used in simulated data.</p>
</td></tr>
<tr><td><code id="true_AUC_var_abitrary_Rcpp_+3A_cov">cov</code></td>
<td>
<p>The covariance used in simulating reading scores.</p>
</td></tr>
<tr><td><code id="true_AUC_var_abitrary_Rcpp_+3A_rho">rho</code></td>
<td>
<p>The scale factor used in simulating reading scores.</p>
</td></tr>
<tr><td><code id="true_AUC_var_abitrary_Rcpp_+3A_sigma_pos">sigma_pos</code></td>
<td>
<p>The variacne for positive ROI's reading score, defalut is 1.</p>
</td></tr>
<tr><td><code id="true_AUC_var_abitrary_Rcpp_+3A_sigma_neg">sigma_neg</code></td>
<td>
<p>The variacne for negative ROI's reading score, defalut is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The theoretical AUC estimator's (co)variance based on the simulation settings.
</p>

<hr>
<h2 id='var_coef'>Calculate the each moments coefficient in variance</h2><span id='topic+var_coef'></span>

<h3>Description</h3>

<p>Calculate the each moments coefficient in variance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_coef(numROI)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_coef_+3A_numroi">numROI</code></td>
<td>
<p>number of ROIs in each case</p>
</td></tr>
</table>


<h3>Value</h3>

<p>all the coefficients
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
