<!DOCTYPE html><html><head><title>Help for package highmean</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {highmean}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#highmean-package'>
<p>Two-Sample Tests for High-Dimensional Mean Vectors</p></a></li>
<li><a href='#apval_aSPU'>
<p>Asymptotics-Based p-values of the SPU and aSPU Tests</p></a></li>
<li><a href='#apval_Bai1996'>
<p>Asymptotics-Based p-value of the Test Proposed by Bai and Saranadasa (1996)</p></a></li>
<li><a href='#apval_Cai2014'>
<p>Asymptotics-Based p-value of the Test Proposed by Cai et al (2014)</p></a></li>
<li><a href='#apval_Chen2010'>
<p>Asymptotics-Based p-value of the Test Proposed by Chen and Qin (2010)</p></a></li>
<li><a href='#apval_Chen2014'>
<p>Asymptotics-Based p-value of the Test Proposed by Chen et al (2014)</p></a></li>
<li><a href='#apval_Sri2008'>
<p>Asymptotics-Based p-value of the Test Proposed by Srivastava and Du (2008)</p></a></li>
<li><a href='#cpval_aSPU'>
<p>Permutation-And-Asymptotics-Based p-values of the SPU and aSPU Tests</p></a></li>
<li><a href='#epval_aSPU'>
<p>Empirical Permutation- or Resampling-Based p-values of the SPU and aSPU Tests</p></a></li>
<li><a href='#epval_Bai1996'>
<p>Empirical Permutation-Based p-value of the Test Proposed by Bai and Saranadasa (1996)</p></a></li>
<li><a href='#epval_Cai2014'>
<p>Empirical Permutation- or Resampling-Based p-value of the Test Proposed by Cai et al (2014)</p></a></li>
<li><a href='#epval_Chen2010'>
<p>Empirical Permutation- or Resampling-Based p-value of the Test Proposed by Chen and Qin (2010)</p></a></li>
<li><a href='#epval_Chen2014'>
<p>Empirical Permutation- or Resampling-Based p-value of the Test Proposed by Chen et al (2014)</p></a></li>
<li><a href='#epval_Sri2008'>
<p>Empirical Permutation-Based p-value of the Test Proposed by Srivastava and Du (2008)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Two-Sample Tests for High-Dimensional Mean Vectors</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-10-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Lifeng Lin and Wei Pan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lifeng Lin &lt;linl@umn.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.9.0), mvtnorm (&ge; 1.0-0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, mnormt</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides various tests for comparing high-dimensional mean vectors in two sample populations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-10-13 22:19:28 UTC; Lifeng</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-10-14 00:35:09</td>
</tr>
</table>
<hr>
<h2 id='highmean-package'>
Two-Sample Tests for High-Dimensional Mean Vectors
</h2><span id='topic+highmean-package'></span><span id='topic+highmean'></span>

<h3>Description</h3>

<p>Provides various tests for comparing high-dimensional mean vectors in two sample populations.
</p>


<h3>Details</h3>

<p>Several two-sample tests for high-dimensional mean vectors have been proposed recently; see, e.g., Bai and Saranadasa (1996), Srivastava and Du (2008), Chen and Qin (2010), Cai et al (2014), and Chen et al (2014). However, these tests are powerful only against certain and limited alternative hypotheses. In practice, since the true alternative hypothesis is unknown, it is unclear how to choose one of these tests to yield high power. Accordingly, Pan et al (2014) and Xu et al (2016) proposed an adaptive test that may maintain high power across a wide range of situations; the asymptotic property of this test was also studied. This package provides functions to calculate p-values of the foregoing tests, using their asymptotic properties and the empirical (permutation or parametric bootstrap resampling) technique.
</p>


<h3>Author(s)</h3>

<p>Lifeng Lin and Wei Pan
</p>
<p>Maintainer: Lifeng Lin &lt;linl@umn.edu&gt;
</p>


<h3>References</h3>

<p>Bai ZD and Saranadasa H (1996). &quot;Effect of high dimension: by an example of a two sample problem.&quot; <em>Statistica Sinica</em>, <b>6</b>(2), 311&ndash;329.
</p>
<p>Cai TT, Liu W, and Xia Y (2014). &quot;Two-sample test of high dimensional means under dependence.&quot; <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>76</b>(2), 349&ndash;372.
</p>
<p>Chen SX and Qin YL (2010). &quot;A two-sample test for high-dimensional data with applications to gene-set testing.&quot; <em>The Annals of Statistics</em>, <b>38</b>(2), 808&ndash;835.
</p>
<p>Chen SX, Li J, and Zhong PS (2014). &quot;Two-Sample Tests for High Dimensional Means with Thresholding and Data Transformation.&quot; arXiv preprint arXiv:1410.2848.
</p>
<p>Pan W, Kim J, Zhang Y, Shen X, and Wei P (2014). &quot;A powerful and adaptive association test for rare variants.&quot; <em>Genetics</em>, <b>197</b>(4), 1081&ndash;1095.
</p>
<p>Srivastava MS and Du M (2008). &quot;A test for the mean vector with fewer observations than the dimension.&quot; <em>Journal of Multivariate Analysis</em>, <b>99</b>(3), 386&ndash;402.
</p>
<p>Xu G, Lin L, Wei P, and Pan W (2016). &quot;An adaptive two-sample test for high-dimensional means.&quot; <em>Biometrika</em>, <b>103</b>(3), 609&ndash;624.
</p>

<hr>
<h2 id='apval_aSPU'>
Asymptotics-Based p-values of the SPU and aSPU Tests
</h2><span id='topic+apval_aSPU'></span>

<h3>Description</h3>

<p>Calculates p-values of the sum-of-powers (SPU) and adaptive SPU (aSPU) tests based on the asymptotic distributions of the test statistics (Xu et al, 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apval_aSPU(sam1, sam2, pow = c(1:6, Inf), eq.cov = TRUE, cov.est,
           cov1.est, cov2.est, bandwidth, bandwidth1, bandwidth2,
           cv.fold = 5, norm = "F")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apval_aSPU_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_pow">pow</code></td>
<td>

<p>a numeric vector indicating the candidate powers <code class="reqn">\gamma</code> in the SPU tests. It should contain <code>Inf</code> and both odd and even integers. The default is <code>c(1:6, Inf)</code>.
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_eq.cov">eq.cov</code></td>
<td>

<p>a logical value. The default is <code>TRUE</code>, indicating that the two sample populations have same covariance; otherwise, the covariances are assumed to be different. 
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_cov.est">cov.est</code></td>
<td>

<p>a consistent estimate of the common covariance matrix when <code>eq.cov</code> is <code>TRUE</code>. This can be obtained from various apporoaches (e.g., banding, tapering, and thresholding; see Pourahmadi 2013). If not specified, this function uses a banding approach proposed by Bickel and Levina (2008) to estimate the covariance matrix.
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_cov1.est">cov1.est</code></td>
<td>

<p>a consistent estimate of the covariance matrix of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. It is similar with the argument <code>cov.est</code>.
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_cov2.est">cov2.est</code></td>
<td>

<p>a consistent estimate of the covariance matrix of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>. It is similar with the argument <code>cov.est</code>.
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_bandwidth">bandwidth</code></td>
<td>

<p>a vector of nonnegative integers indicating the candidate bandwidths to be used in the banding approach (Bickel and Levina, 2008) for estimating the common covariance when <code>eq.cov</code> is <code>TRUE</code>. This argument is effective only if <code>cov.est</code> is not provided. The default is a vector containing 50 candidate bandwidths chosen from {0, 1, 2, ..., p}.
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_bandwidth1">bandwidth1</code></td>
<td>

<p>similar with the argument <code>bandwidth</code>; it is used to specify candidate bandwidths for estimating the covariance of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_bandwidth2">bandwidth2</code></td>
<td>

<p>similar with the argument <code>bandwidth</code>; it is used to specify candidate bandwidths for estimating the covariance of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_cv.fold">cv.fold</code></td>
<td>

<p>an integer greater than or equal to 2 indicating the fold of cross-validation. The default is 5. See page 211 in Bickel and Levina (2008).
</p>
</td></tr>
<tr><td><code id="apval_aSPU_+3A_norm">norm</code></td>
<td>

<p>a character string indicating the type of matrix norm for the calculation of risk function in cross-validation. This argument will be passed to the <code><a href="base.html#topic+norm">norm</a></code> function. The default is the Frobenius norm (<code>"F"</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that the two groups of <code class="reqn">p</code>-dimensional independent and identically distributed samples <code class="reqn">\{X_{1i}\}_{i=1}^{n_1}</code> and <code class="reqn">\{X_{2j}\}_{j=1}^{n_2}</code> are observed; we consider high-dimensional data with <code class="reqn">p \gg n := n_1 + n_2 - 2</code>. Assume that the covariances of the two sample populations are <code class="reqn">\Sigma_1 = (\sigma_{1, ij})</code> and <code class="reqn">\Sigma_2 = (\sigma_{2, ij})</code>. The primary object is to test <code class="reqn">H_{0}: \mu_1 = \mu_2</code> versus <code class="reqn">H_{A}: \mu_1 \neq \mu_2</code>. Let <code class="reqn">\bar{X}_{k}</code> be the sample mean for group <code class="reqn">k = 1, 2</code>. For a vector <code class="reqn">v</code>, we denote <code class="reqn">v^{(i)}</code> as its <code class="reqn">i</code>th element.
</p>
<p>For any <code class="reqn">1 \le \gamma &lt; \infty</code>, the sum-of-powers (SPU) test statistic is defined as:
</p>
<p style="text-align: center;"><code class="reqn">L(\gamma) = \sum_{i = 1}^{p} (\bar{X}_1^{(i)} - \bar{X}_2^{(i)})^\gamma.</code>
</p>

<p>For <code class="reqn">\gamma = \infty</code>,
</p>
<p style="text-align: center;"><code class="reqn">L (\infty) = \max_{i = 1, \ldots, p} (\bar{X}_1^{(i)} - \bar{X}_2^{(i)})^2/(\sigma_{1,ii}/n_1 + \sigma_{2,ii}/n_2).</code>
</p>

<p>The adaptive SPU (aSPU) test combines the SPU tests and improve the test power:
</p>
<p style="text-align: center;"><code class="reqn">T_{aSPU} = \min_{\gamma \in \Gamma} P_{SPU(\gamma)},</code>
</p>

<p>where <code class="reqn">P_{SPU(\gamma)}</code> is the p-value of SPU(<code class="reqn">\gamma</code>) test, and <code class="reqn">\Gamma</code> is a candidate set of <code class="reqn">\gamma</code>'s. Note that <code class="reqn">T_{aSPU}</code> is no longer a genuine p-value. The asymptotic properties of the SPU and aSPU tests are studied in Xu et al (2016).
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>pow</code></td>
<td>

<p>the powers <code class="reqn">\gamma</code> used for the SPU tests.
</p>
</td></tr>
<tr><td><code>opt.bw</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>TRUE</code> and <code>cov.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>opt.bw1</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov1.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>opt.bw2</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov2.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>spu.stat</code></td>
<td>

<p>the observed SPU test statistics.
</p>
</td></tr>
<tr><td><code>spu.e</code></td>
<td>

<p>the asymptotic means of SPU test statistics with finite <code class="reqn">\gamma</code> under the null hypothesis.
</p>
</td></tr>
<tr><td><code>spu.var</code></td>
<td>

<p>the asymptotic variances of SPU test statistics with finite <code class="reqn">\gamma</code> under the null hypothesis.
</p>
</td></tr>
<tr><td><code>spu.corr.odd</code></td>
<td>

<p>the asymptotic correlations between SPU test statistics with odd <code class="reqn">\gamma</code>.
</p>
</td></tr>
<tr><td><code>spu.corr.even</code></td>
<td>

<p>the asymptotic correlations between SPU test statistics with even <code class="reqn">\gamma</code>.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this was specified by the argument <code>eq.cov</code>.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using the asymptotic distributions of test statistics.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-values of the SPU tests and the aSPU test.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bickel PJ and Levina E (2008). &quot;Regularized estimation of large covariance matrices.&quot; <em>The Annals of Statistics</em>, <b>36</b>(1), 199&ndash;227.
</p>
<p>Pan W, Kim J, Zhang Y, Shen X, and Wei P (2014). &quot;A powerful and adaptive association test for rare variants.&quot; <em>Genetics</em>, <b>197</b>(4), 1081&ndash;1095.
</p>
<p>Pourahmadi M (2013). <em>High-Dimensional Covariance Estimation</em>. John Wiley &amp; Sons, Hoboken, NJ.
</p>
<p>Xu G, Lin L, Wei P, and Pan W (2016). &quot;An adaptive two-sample test for high-dimensional means.&quot; <em>Biometrika</em>, <b>103</b>(3), 609&ndash;624.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cpval_aSPU">cpval_aSPU</a></code>, <code><a href="#topic+epval_aSPU">epval_aSPU</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(1234)
n1 &lt;- n2 &lt;- 50
p &lt;- 200
mu1 &lt;- rep(0, p)
mu2 &lt;- mu1
mu2[1:10] &lt;- 0.2
true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
# use true covariance matrix
apval_aSPU(sam1, sam2, cov.est = true.cov)
# fix bandwidth as 10
apval_aSPU(sam1, sam2, bandwidth = 10)
# use the optimal bandwidth from a candidate set
#apval_aSPU(sam1, sam2, bandwidth = 0:20)

# the two sample populations have different covariances
#true.cov1 &lt;- 0.2^(abs(outer(1:p, 1:p, "-")))
#true.cov2 &lt;- 0.6^(abs(outer(1:p, 1:p, "-")))
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov1)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov2)
#apval_aSPU(sam1, sam2, eq.cov = FALSE,
#	bandwidth1 = 10, bandwidth2 = 10)
</code></pre>

<hr>
<h2 id='apval_Bai1996'>
Asymptotics-Based p-value of the Test Proposed by Bai and Saranadasa (1996)
</h2><span id='topic+apval_Bai1996'></span>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Bai and Saranadasa (1996) based on the asymptotic distribution of the test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apval_Bai1996(sam1, sam2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apval_Bai1996_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="apval_Bai1996_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that the two groups of <code class="reqn">p</code>-dimensional independent and identically distributed samples <code class="reqn">\{X_{1i}\}_{i=1}^{n_1}</code> and <code class="reqn">\{X_{2j}\}_{j=1}^{n_2}</code> are observed; we consider high-dimensional data with <code class="reqn">p \gg n := n_1 + n_2 - 2</code>. Assume that the two groups share a common covariance matrix. The primary object is to test <code class="reqn">H_{0}: \mu_1 = \mu_2</code> versus <code class="reqn">H_{A}: \mu_1 \neq \mu_2</code>. Let <code class="reqn">\bar{X}_{k}</code> be the sample mean for group <code class="reqn">k = 1, 2</code>. Also, let <code class="reqn">S = n^{-1} \sum_{k = 1}^{2} \sum_{i = 1}^{n_{k}} (X_{ki} - \bar{X}_k) (X_{ki} - \bar{X}_k)^T</code> be the pooled sample covariance matrix from the two groups.
</p>
<p>Bai and Saranadasa (1996) proposed the following test statistic:
</p>
<p style="text-align: center;"><code class="reqn">T_{BS} = \frac{(n_1^{-1} + n_2^{-1})^{-1} (\bar{X}_1 - \bar{X}_2)^T (\bar{X}_1 - \bar{X}_2) - tr S}{\sqrt{2 n (n + 1) (n - 1)^{-1} (n + 2)^{-1} [tr S^2 - n^{-1} (tr S)^2]}},</code>
</p>

<p>and its asymptotic distribution is normal under the null hypothesis.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>this output reminds users that the two sample populations have a common covariance matrix.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using the asymptotic distributions of test statistics.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Bai and Saranadasa (1996).
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The asymptotic distribution of the test statistic was derived under normality assumption in Bai and Saranadasa (1996). Also, this function assumes that the two sample populations have a common covariance matrix.
</p>


<h3>References</h3>

<p>Bai ZD and Saranadasa H (1996). &quot;Effect of high dimension: by an example of a two sample problem.&quot; <em>Statistica Sinica</em>, <b>6</b>(2), 311&ndash;329.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epval_Bai1996">epval_Bai1996</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(1234)
n1 &lt;- n2 &lt;- 50
p &lt;- 200
mu1 &lt;- rep(0, p)
mu2 &lt;- mu1
mu2[1:10] &lt;- 0.2
true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
apval_Bai1996(sam1, sam2)
</code></pre>

<hr>
<h2 id='apval_Cai2014'>
Asymptotics-Based p-value of the Test Proposed by Cai et al (2014)
</h2><span id='topic+apval_Cai2014'></span>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Cai et al (2014) based on the asymptotic distribution of the test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apval_Cai2014(sam1, sam2, eq.cov = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apval_Cai2014_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="apval_Cai2014_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="apval_Cai2014_+3A_eq.cov">eq.cov</code></td>
<td>

<p>a logical value. The default is <code>TRUE</code>, indicating that the two sample populations have same covariance; otherwise, the covariances are assumed to be different. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that the two groups of <code class="reqn">p</code>-dimensional independent and identically distributed samples <code class="reqn">\{X_{1i}\}_{i=1}^{n_1}</code> and <code class="reqn">\{X_{2j}\}_{j=1}^{n_2}</code> are observed; we consider high-dimensional data with <code class="reqn">p \gg n := n_1 + n_2 - 2</code>. Assume that the covariances of the two sample populations are <code class="reqn">\Sigma_1 = (\sigma_{1, ij})</code> and <code class="reqn">\Sigma_2 = (\sigma_{2, ij})</code>. The primary object is to test <code class="reqn">H_{0}: \mu_1 = \mu_2</code> versus <code class="reqn">H_{A}: \mu_1 \neq \mu_2</code>. Let <code class="reqn">\bar{X}_{k}</code> be the sample mean for group <code class="reqn">k = 1, 2</code>. For a vector <code class="reqn">v</code>, we denote <code class="reqn">v^{(i)}</code> as its <code class="reqn">i</code>th element.
</p>
<p>Cai et al (2014) proposed the following test statistic:
</p>
<p style="text-align: center;"><code class="reqn">T_{CLX} = \max_{i = 1, \ldots, p} (\bar{X}_1^{(i)} - \bar{X}_2^{(i)})^2/(\sigma_{1,ii}/n_1 + \sigma_{2, ii}/n_2),</code>
</p>

<p>This test statistic follows an extreme value distribution under the null hypothesis.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this was specified by the argument <code>eq.cov</code>.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using the asymptotic distributions of test statistics.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Cai et al (2014).
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function does not transform the data with their precision matrix (see Cai et al, 2014). To calculate the p-value of the test statisic with transformation, users can use transformed samples for <code>sam1</code> and <code>sam2</code>.
</p>


<h3>References</h3>

<p>Cai TT, Liu W, and Xia Y (2014). &quot;Two-sample test of high dimensional means under dependence.&quot; <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>76</b>(2), 349&ndash;372.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epval_Cai2014">epval_Cai2014</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(1234)
n1 &lt;- n2 &lt;- 50
p &lt;- 200
mu1 &lt;- rep(0, p)
mu2 &lt;- mu1
mu2[1:10] &lt;- 0.2
true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
apval_Cai2014(sam1, sam2)

# the two sample populations have different covariances
true.cov1 &lt;- 0.2^(abs(outer(1:p, 1:p, "-")))
true.cov2 &lt;- 0.6^(abs(outer(1:p, 1:p, "-")))
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov1)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov2)
apval_Cai2014(sam1, sam2, eq.cov = FALSE)
</code></pre>

<hr>
<h2 id='apval_Chen2010'>
Asymptotics-Based p-value of the Test Proposed by Chen and Qin (2010)
</h2><span id='topic+apval_Chen2010'></span>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Chen and Qin (2010) based on the asymptotic distribution of the test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apval_Chen2010(sam1, sam2, eq.cov = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apval_Chen2010_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="apval_Chen2010_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="apval_Chen2010_+3A_eq.cov">eq.cov</code></td>
<td>

<p>a logical value. The default is <code>TRUE</code>, indicating that the two sample populations have same covariance; otherwise, the covariances are assumed to be different. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that the two groups of <code class="reqn">p</code>-dimensional independent and identically distributed samples <code class="reqn">\{X_{1i}\}_{i=1}^{n_1}</code> and <code class="reqn">\{X_{2j}\}_{j=1}^{n_2}</code> are observed; we consider high-dimensional data with <code class="reqn">p \gg n := n_1 + n_2 - 2</code>. The primary object is to test <code class="reqn">H_{0}: \mu_1 = \mu_2</code> versus <code class="reqn">H_{A}: \mu_1 \neq \mu_2</code>. Let <code class="reqn">\bar{X}_{k}</code> be the sample mean for group <code class="reqn">k = 1, 2</code>.
</p>
<p>Chen and Qin (2010) proposed the following test statistic:
</p>
<p style="text-align: center;"><code class="reqn">T_{CQ} = \frac{\sum_{i \neq j}^{n_1} X_{1i}^T X_{1j}}{n_1 (n_1 - 1)} + \frac{\sum_{i \neq j}^{n_2} X_{2i}^T X_{2j}}{n_2 (n_2 - 1)} - 2 \frac{\sum_{i = 1}^{n_1} \sum_{j = 1}^{n_2} X_{1i}^T X_{2j}}{n_1 n_2},</code>
</p>

<p>and its asymptotic distribution is normal under the null hypothesis.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this was specified by the argument <code>eq.cov</code>.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using the asymptotic distributions of test statistics.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Chen and Qin (2010).
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chen SX and Qin YL (2010). &quot;A two-sample test for high-dimensional data with applications to gene-set testing.&quot; <em>The Annals of Statistics</em>, <b>38</b>(2), 808&ndash;835.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epval_Chen2010">epval_Chen2010</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(1234)
n1 &lt;- n2 &lt;- 50
p &lt;- 200
mu1 &lt;- rep(0, p)
mu2 &lt;- mu1
mu2[1:10] &lt;- 0.2
true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
apval_Chen2010(sam1, sam2)

# the two sample populations have different covariances
true.cov1 &lt;- 0.2^(abs(outer(1:p, 1:p, "-")))
true.cov2 &lt;- 0.6^(abs(outer(1:p, 1:p, "-")))
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov1)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov2)
apval_Chen2010(sam1, sam2, eq.cov = FALSE)
</code></pre>

<hr>
<h2 id='apval_Chen2014'>
Asymptotics-Based p-value of the Test Proposed by Chen et al (2014)
</h2><span id='topic+apval_Chen2014'></span>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Chen et al (2014) based on the asymptotic distribution of the test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apval_Chen2014(sam1, sam2, eq.cov = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apval_Chen2014_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="apval_Chen2014_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="apval_Chen2014_+3A_eq.cov">eq.cov</code></td>
<td>

<p>a logical value. The default is <code>TRUE</code>, indicating that the two sample populations have same covariance; otherwise, the covariances are assumed to be different. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that the two groups of <code class="reqn">p</code>-dimensional independent and identically distributed samples <code class="reqn">\{X_{1i}\}_{i=1}^{n_1}</code> and <code class="reqn">\{X_{2j}\}_{j=1}^{n_2}</code> are observed; we consider high-dimensional data with <code class="reqn">p \gg n := n_1 + n_2 - 2</code>. Assume that the covariances of the two sample populations are <code class="reqn">\Sigma_1 = (\sigma_{1, ij})</code> and <code class="reqn">\Sigma_2 = (\sigma_{2, ij})</code>. The primary object is to test <code class="reqn">H_{0}: \mu_1 = \mu_2</code> versus <code class="reqn">H_{A}: \mu_1 \neq \mu_2</code>. Let <code class="reqn">\bar{X}_{k}</code> be the sample mean for group <code class="reqn">k = 1, 2</code>. For a vector <code class="reqn">v</code>, we denote <code class="reqn">v^{(i)}</code> as its <code class="reqn">i</code>th element.
</p>
<p>Chen et al (2014) proposed removing estimated zero components in the mean difference through thresholding; they considered
</p>
<p style="text-align: center;"><code class="reqn">T_{CLZ}(s) = \sum_{i = 1}^{p} \left\{ \frac{(\bar{X}_1^{(i)} - \bar{X}_2^{(i)})^2}{\sigma_{1,ii}/n_1 + \sigma_{2,ii}/n_2} - 1 \right\} I \left\{ \frac{(\bar{X}_1^{(i)} - \bar{X}_2^{(i)})^2}{\sigma_{1,ii}/n_1 + \sigma_{2,ii}/n_2} &gt; \lambda_{p} (s) \right\},</code>
</p>

<p>where the threshold level is <code class="reqn">\lambda_p(s) := 2 s \log p</code> and <code class="reqn">I(\cdot)</code> is the indicator function. Since an optimal choice of the threshold is unknown, they proposed trying all possible threshold values, then choosing the most significant one as their final test statistic:
</p>
<p style="text-align: center;"><code class="reqn">T_{CLZ} = \max_{s \in (0, 1 - \eta)} \{ T_{CLZ}(s) - \hat{\mu}_{T_{CLZ}(s), 0}\}/\hat{\sigma}_{T_{CLZ}(s), 0},</code>
</p>

<p>where <code class="reqn">\hat{\mu}_{T_{CLZ}(s), 0}</code> and <code class="reqn">\hat{\sigma}_{T_{CLZ}(s), 0}</code> are estimates of the mean and standard deviation of <code class="reqn">T_{CLZ}(s)</code> under the null hypothesis. They derived its asymptotic null distribution as an extreme value distribution.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this was specified by the argument <code>eq.cov</code>.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using the asymptotic distributions of test statistics.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Chen et al (2014).
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function does not transform the data with their precision matrix (see Chen et al, 2014). To calculate the p-value of the test statisic with transformation, users can use transformed samples for <code>sam1</code> and <code>sam2</code>.
</p>


<h3>References</h3>

<p>Chen SX, Li J, and Zhong PS (2014). &quot;Two-Sample Tests for High Dimensional Means with Thresholding and Data Transformation.&quot; arXiv preprint arXiv:1410.2848.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epval_Chen2014">epval_Chen2014</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(1234)
n1 &lt;- n2 &lt;- 50
p &lt;- 200
mu1 &lt;- rep(0, p)
mu2 &lt;- mu1
mu2[1:10] &lt;- 0.2
true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
apval_Chen2014(sam1, sam2)

# the two sample populations have different covariances
true.cov1 &lt;- 0.2^(abs(outer(1:p, 1:p, "-")))
true.cov2 &lt;- 0.6^(abs(outer(1:p, 1:p, "-")))
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov1)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov2)
apval_Chen2014(sam1, sam2, eq.cov = FALSE)
</code></pre>

<hr>
<h2 id='apval_Sri2008'>
Asymptotics-Based p-value of the Test Proposed by Srivastava and Du (2008)
</h2><span id='topic+apval_Sri2008'></span>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Srivastava and Du (2008) based on the asymptotic distribution of the test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apval_Sri2008(sam1, sam2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apval_Sri2008_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="apval_Sri2008_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that the two groups of <code class="reqn">p</code>-dimensional independent and identically distributed samples <code class="reqn">\{X_{1i}\}_{i=1}^{n_1}</code> and <code class="reqn">\{X_{2j}\}_{j=1}^{n_2}</code> are observed; we consider high-dimensional data with <code class="reqn">p \gg n := n_1 + n_2 - 2</code>. Assume that the two groups share a common covariance matrix. The primary object is to test <code class="reqn">H_{0}: \mu_1 = \mu_2</code> versus <code class="reqn">H_{A}: \mu_1 \neq \mu_2</code>. Let <code class="reqn">\bar{X}_{k}</code> be the sample mean for group <code class="reqn">k = 1, 2</code>. Also, let <code class="reqn">S = n^{-1} \sum_{k = 1}^{2} \sum_{i = 1}^{n_{k}} (X_{ki} - \bar{X}_k) (X_{ki} - \bar{X}_k)^T</code> be the pooled sample covariance matrix from the two groups.
</p>
<p>Srivastava and Du (2008) proposed the following test statistic:
</p>
<p style="text-align: center;"><code class="reqn">T_{SD} = \frac{(n_1^{-1} + n_2^{-1})^{-1} (\bar{X}_1 - \bar{X}_2)^T D_S^{-1} (\bar{X}_1 - \bar{X}_2) - (n - 2)^{-1} n p}{\sqrt{2 (tr R^2 - p^2 n^{-1}) c_{p, n}}},</code>
</p>

<p>where <code class="reqn">D_S = diag (s_{11}, s_{22}, ..., s_{pp})</code>, <code class="reqn">s_{ii}</code>'s are the diagonal elements of <code class="reqn">S</code>, <code class="reqn">R = D_S^{-1/2} S D_S^{-1/2}</code> is the sample correlation matrix and <code class="reqn">c_{p, n} = 1 + tr R^2 p^{-3/2}</code>. This test statistic follows normal distribution under the null hypothesis.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>this output reminds users that the two sample populations have a common covariance matrix.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using the asymptotic distributions of test statistics.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Srivastava and Du (2008).
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The asymptotic distribution of the test statistic was derived under normality assumption in Bai and Saranadasa (1996). Also, this function assumes that the two sample populations have a common covariance matrix.
</p>


<h3>References</h3>

<p>Srivastava MS and Du M (2008). &quot;A test for the mean vector with fewer observations than the dimension.&quot; <em>Journal of Multivariate Analysis</em>, <b>99</b>(3), 386&ndash;402.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epval_Sri2008">epval_Sri2008</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(1234)
n1 &lt;- n2 &lt;- 50
p &lt;- 200
mu1 &lt;- rep(0, p)
mu2 &lt;- mu1
mu2[1:10] &lt;- 0.2
true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
apval_Sri2008(sam1, sam2)
</code></pre>

<hr>
<h2 id='cpval_aSPU'>
Permutation-And-Asymptotics-Based p-values of the SPU and aSPU Tests
</h2><span id='topic+cpval_aSPU'></span>

<h3>Description</h3>

<p>Calculates p-values of the sum-of-powers (SPU) and adaptive SPU (aSPU) tests based on the combination of permutation method and asymptotic distributions of the test statistics (Xu et al, 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpval_aSPU(sam1, sam2, pow = c(1:6, Inf), n.iter = 1000, seeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cpval_aSPU_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="cpval_aSPU_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="cpval_aSPU_+3A_pow">pow</code></td>
<td>

<p>a numeric vector indicating the candidate powers <code class="reqn">\gamma</code> in the SPU tests. It should contain <code>Inf</code> and both odd and even integers. The default is <code>c(1:6, Inf)</code>.
</p>
</td></tr>
<tr><td><code id="cpval_aSPU_+3A_n.iter">n.iter</code></td>
<td>

<p>a numeric integer indicating the number of permutation iterations for calculating the means, variances, covariances of SPU test statistics' asymptotic distributions. The default is 1,000.
</p>
</td></tr>
<tr><td><code id="cpval_aSPU_+3A_seeds">seeds</code></td>
<td>

<p>a vector of seeds for each permutation iteration; this is optional.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that the two groups of <code class="reqn">p</code>-dimensional independent and identically distributed samples <code class="reqn">\{X_{1i}\}_{i=1}^{n_1}</code> and <code class="reqn">\{X_{2j}\}_{j=1}^{n_2}</code> are observed; we consider high-dimensional data with <code class="reqn">p \gg n := n_1 + n_2 - 2</code>. Assume that the covariances of the two sample populations are <code class="reqn">\Sigma_1 = (\sigma_{1, ij})</code> and <code class="reqn">\Sigma_2 = (\sigma_{2, ij})</code>. The primary object is to test <code class="reqn">H_{0}: \mu_1 = \mu_2</code> versus <code class="reqn">H_{A}: \mu_1 \neq \mu_2</code>. Let <code class="reqn">\bar{X}_{k}</code> be the sample mean for group <code class="reqn">k = 1, 2</code>. For a vector <code class="reqn">v</code>, we denote <code class="reqn">v^{(i)}</code> as its <code class="reqn">i</code>th element.
</p>
<p>For any <code class="reqn">1 \le \gamma &lt; \infty</code>, the sum-of-powers (SPU) test statistic is defined as:
</p>
<p style="text-align: center;"><code class="reqn">L(\gamma) = \sum_{i = 1}^{p} (\bar{X}_1^{(i)} - \bar{X}_2^{(i)})^\gamma.</code>
</p>

<p>For <code class="reqn">\gamma = \infty</code>,
</p>
<p style="text-align: center;"><code class="reqn">L (\infty) = \max_{i = 1, \ldots, p} (\bar{X}_1^{(i)} - \bar{X}_2^{(i)})^2/(\sigma_{1,ii}/n_1 + \sigma_{2,ii}/n_2).</code>
</p>

<p>The adaptive SPU (aSPU) test combines the SPU tests and improve the test power:
</p>
<p style="text-align: center;"><code class="reqn">T_{aSPU} = \min_{\gamma \in \Gamma} P_{SPU(\gamma)},</code>
</p>

<p>where <code class="reqn">P_{SPU(\gamma)}</code> is the p-value of SPU(<code class="reqn">\gamma</code>) test, and <code class="reqn">\Gamma</code> is a candidate set of <code class="reqn">\gamma</code>'s. Note that <code class="reqn">T_{aSPU}</code> is no longer a genuine p-value.
</p>
<p>The asymptotic properties of the SPU and aSPU tests are studied in Xu et al (2016). When using the theoretical means, variances, and covarainces of <code class="reqn">L (\gamma)</code> to calculate the p-values of SPU and aSPU tests (<code class="reqn">1 \le \gamma &lt; \infty</code>), the high-dimensional covariance matrix of the samples needs to be consistently estimated; such estimation is usually time-consuming.
</p>
<p>Alternatively, assuming that the two sample groups have same covariance, the permutation method can be applied to efficiently estimate the means, variances, and covarainces of <code class="reqn">L (\gamma)</code>'s asymptotic distributions, which then yield the p-values of SPU and aSPU tests based on the combination of permutation method and asymptotic distributions.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>pow</code></td>
<td>

<p>the powers <code class="reqn">\gamma</code> used for the SPU tests.
</p>
</td></tr>
<tr><td><code>spu.stat</code></td>
<td>

<p>the observed SPU test statistics.
</p>
</td></tr>
<tr><td><code>spu.e</code></td>
<td>

<p>the asymptotic means of SPU test statistics with finite <code class="reqn">\gamma</code> under the null hypothesis.
</p>
</td></tr>
<tr><td><code>spu.var</code></td>
<td>

<p>the asymptotic variances of SPU test statistics with finite <code class="reqn">\gamma</code> under the null hypothesis.
</p>
</td></tr>
<tr><td><code>spu.corr.odd</code></td>
<td>

<p>the asymptotic correlations between SPU test statistics with odd <code class="reqn">\gamma</code>.
</p>
</td></tr>
<tr><td><code>spu.corr.even</code></td>
<td>

<p>the asymptotic correlations between SPU test statistics with even <code class="reqn">\gamma</code>.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this reminders users that <code>cpval_aSPU()</code> assumes that the two sample groups have same covariance.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using the asymptotic distributions of test statistics.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-values of the SPU tests and the aSPU test.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The permutation technique assumes that the distributions of the two sample populations are the same under the null hypothesis.
</p>


<h3>References</h3>

<p>Bickel PJ and Levina E (2008). &quot;Regularized estimation of large covariance matrices.&quot; <em>The Annals of Statistics</em>, <b>36</b>(1), 199&ndash;227.
</p>
<p>Pan W, Kim J, Zhang Y, Shen X, and Wei P (2014). &quot;A powerful and adaptive association test for rare variants.&quot; <em>Genetics</em>, <b>197</b>(4), 1081&ndash;1095.
</p>
<p>Pourahmadi M (2013). <em>High-Dimensional Covariance Estimation</em>. John Wiley &amp; Sons, Hoboken, NJ.
</p>
<p>Xu G, Lin L, Wei P, and Pan W (2016). &quot;An adaptive two-sample test for high-dimensional means.&quot; <em>Biometrika</em>, <b>103</b>(3), 609&ndash;624.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+apval_aSPU">apval_aSPU</a></code>, <code><a href="#topic+epval_aSPU">epval_aSPU</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(1234)
n1 &lt;- n2 &lt;- 50
p &lt;- 200
mu1 &lt;- rep(0, p)
mu2 &lt;- mu1
mu2[1:10] &lt;- 0.2
true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
cpval_aSPU(sam1, sam2, n.iter = 100)
</code></pre>

<hr>
<h2 id='epval_aSPU'>
Empirical Permutation- or Resampling-Based p-values of the SPU and aSPU Tests
</h2><span id='topic+epval_aSPU'></span>

<h3>Description</h3>

<p>Calculates p-values of the sum-of-powers (SPU) and adaptive SPU (aSPU) tests based on permutation or parametric bootstrap resampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epval_aSPU(sam1, sam2, pow = c(1:6, Inf), eq.cov = TRUE, n.iter = 1000, cov1.est,
           cov2.est, bandwidth1, bandwidth2, cv.fold = 5, norm = "F", seeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epval_aSPU_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_pow">pow</code></td>
<td>

<p>a numeric vector indicating the candidate values for the power <code class="reqn">\gamma</code> in SPU tests. It should contain <code>Inf</code> and both odd and even integers. The default is <code>c(1:6, Inf)</code>.
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_eq.cov">eq.cov</code></td>
<td>

<p>a logical value. The default is <code>TRUE</code>, indicating that the two sample populations have same covariance; otherwise, the covariances are assumed to be different. If <code>eq.cov</code> is <code>TRUE</code>, the permutation method is used to calculate p-values; otherwise, the parametric bootstrap resampling is used.
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_n.iter">n.iter</code></td>
<td>

<p>a numeric integer indicating the number of permutation/resampling iterations. The default is 1,000.
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_cov1.est">cov1.est</code></td>
<td>

<p>This and the following arguments are only effective when <code>eq.cov = FALSE</code> and the parametric bootstrap resampling is used to calculate p-values. This argument specifies a consistent estimate of the covariance matrix of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. This can be obtained from various apporoaches (e.g., banding, tapering, and thresholding; see Pourahmadi 2013). If not specified, this function uses a banding approach proposed by Bickel and Levina (2008) to estimate the covariance matrix.
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_cov2.est">cov2.est</code></td>
<td>

<p>a consistent estimate of the covariance matrix of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>. It is similar with the argument <code>cov1.est</code>.
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_bandwidth1">bandwidth1</code></td>
<td>

<p>a vector of nonnegative integers indicating the candidate bandwidths to be used in the banding approach (Bickel and Levina, 2008) for estimating the covariance of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. This argument is effective when <code>cov1.est</code> is not provided. The default is a vector containing 50 candidate bandwidths chosen from {0, 1, 2, ..., p}.
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_bandwidth2">bandwidth2</code></td>
<td>

<p>similar with the argument <code>bandwidth1</code>; it is used to specify candidate bandwidths for estimating the covariance of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_cv.fold">cv.fold</code></td>
<td>

<p>an integer greater than or equal to 2 indicating the fold of cross-validation. The default is 5. See page 211 in Bickel and Levina (2008).
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_norm">norm</code></td>
<td>

<p>a character string indicating the type of matrix norm for the calculation of risk function in cross-validation. This argument will be passed to the <code><a href="base.html#topic+norm">norm</a></code> function. The default is the Frobenius norm (<code>"F"</code>).
</p>
</td></tr>
<tr><td><code id="epval_aSPU_+3A_seeds">seeds</code></td>
<td>

<p>a vector of seeds for each permutation or parametric bootstrap resampling iteration; this is optional.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the details in <code><a href="#topic+apval_aSPU">apval_aSPU</a></code>.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>pow</code></td>
<td>

<p>the powers <code class="reqn">\gamma</code> used for the SPU tests.
</p>
</td></tr>
<tr><td><code>opt.bw1</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov1.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>opt.bw2</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov2.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this was specified by the argument <code>eq.cov</code>.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using permutation or parametric bootstrap resampling.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-values of the SPU tests and the aSPU test.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bickel PJ and Levina E (2008). &quot;Regularized estimation of large covariance matrices.&quot; <em>The Annals of Statistics</em>, <b>36</b>(1), 199&ndash;227.
</p>
<p>Pan W, Kim J, Zhang Y, Shen X, and Wei P (2014). &quot;A powerful and adaptive association test for rare variants.&quot; <em>Genetics</em>, <b>197</b>(4), 1081&ndash;1095.
</p>
<p>Pourahmadi M (2013). <em>High-Dimensional Covariance Estimation</em>. John Wiley &amp; Sons, Hoboken, NJ.
</p>
<p>Xu G, Lin L, Wei P, and Pan W (2016). &quot;An adaptive two-sample test for high-dimensional means.&quot; <em>Biometrika</em>, <b>103</b>(3), 609&ndash;624.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+apval_aSPU">apval_aSPU</a></code>, <code><a href="#topic+cpval_aSPU">cpval_aSPU</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(1234)
n1 &lt;- n2 &lt;- 50
p &lt;- 200
mu1 &lt;- rep(0, p)
mu2 &lt;- mu1
mu2[1:10] &lt;- 0.2
true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
# increase n.iter to reduce Monte Carlo error
epval_aSPU(sam1, sam2, n.iter = 10)

# the two sample populations have different covariances
#true.cov1 &lt;- 0.2^(abs(outer(1:p, 1:p, "-")))
#true.cov2 &lt;- 0.6^(abs(outer(1:p, 1:p, "-")))
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov1)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov2)
# increase n.iter to reduce Monte Carlo error
#epval_aSPU(sam1, sam2, eq.cov = FALSE, n.iter = 10,
#	bandwidth1 = 10, bandwidth2 = 10)
</code></pre>

<hr>
<h2 id='epval_Bai1996'>
Empirical Permutation-Based p-value of the Test Proposed by Bai and Saranadasa (1996)
</h2><span id='topic+epval_Bai1996'></span>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Bai and Saranadasa (1996) based on permutation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epval_Bai1996(sam1, sam2, n.iter = 1000, seeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epval_Bai1996_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_Bai1996_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_Bai1996_+3A_n.iter">n.iter</code></td>
<td>

<p>a numeric integer indicating the number of permutation iterations. The default is 1,000.
</p>
</td></tr>
<tr><td><code id="epval_Bai1996_+3A_seeds">seeds</code></td>
<td>

<p>a vector of seeds for each permutation or parametric bootstrap resampling iteration; this is optional.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the details in <code><a href="#topic+apval_Bai1996">apval_Bai1996</a></code>.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>this output reminds users that the two sample populations have a common covariance matrix.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using permutation.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Bai and Saranadasa (1996).
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The permutation technique assumes that the distributions of the two sample populations are the same under the null hypothesis.
</p>


<h3>References</h3>

<p>Bai ZD and Saranadasa H (1996). &quot;Effect of high dimension: by an example of a two sample problem.&quot; <em>Statistica Sinica</em>, <b>6</b>(2), 311&ndash;329.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+apval_Bai1996">apval_Bai1996</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#library(MASS)
#set.seed(1234)
#n1 &lt;- n2 &lt;- 50
#p &lt;- 200
#mu1 &lt;- rep(0, p)
#mu2 &lt;- mu1
#mu2[1:10] &lt;- 0.2
#true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
# increase n.iter to reduce Monte Carlo error.
#epval_Bai1996(sam1, sam2, n.iter = 10)
</code></pre>

<hr>
<h2 id='epval_Cai2014'>
Empirical Permutation- or Resampling-Based p-value of the Test Proposed by Cai et al (2014)
</h2><span id='topic+epval_Cai2014'></span>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Cai et al (2014) based on permutation or parametric bootstrap resampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epval_Cai2014(sam1, sam2, eq.cov = TRUE, n.iter = 1000, cov1.est, cov2.est,
              bandwidth1, bandwidth2, cv.fold = 5, norm = "F", seeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epval_Cai2014_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_Cai2014_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_Cai2014_+3A_eq.cov">eq.cov</code></td>
<td>

<p>a logical value. The default is <code>TRUE</code>, indicating that the two sample populations have same covariance; otherwise, the covariances are assumed to be different. If <code>eq.cov</code> is <code>TRUE</code>, the permutation method is used to calculate p-values; otherwise, the parametric bootstrap resampling is used.
</p>
</td></tr>
<tr><td><code id="epval_Cai2014_+3A_n.iter">n.iter</code></td>
<td>

<p>a numeric integer indicating the number of permutation/resampling iterations. The default is 1,000.
</p>
</td></tr>
<tr><td><code id="epval_Cai2014_+3A_cov1.est">cov1.est</code></td>
<td>

<p>This and the following arguments are only effective when <code>eq.cov = FALSE</code> and the parametric bootstrap resampling is used to calculate p-values. This argument specifies a consistent estimate of the covariance matrix of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. This can be obtained from various apporoaches (e.g., banding, tapering, and thresholding; see Pourahmadi 2013). If not specified, this function uses a banding approach proposed by Bickel and Levina (2008) to estimate the covariance matrix.
</p>
</td></tr>
<tr><td><code id="epval_Cai2014_+3A_cov2.est">cov2.est</code></td>
<td>

<p>a consistent estimate of the covariance matrix of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>. It is similar with the argument <code>cov1.est</code>.
</p>
</td></tr>
<tr><td><code id="epval_Cai2014_+3A_bandwidth1">bandwidth1</code></td>
<td>

<p>a vector of nonnegative integers indicating the candidate bandwidths to be used in the banding approach (Bickel and Levina, 2008) for estimating the covariance of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. This argument is effective when <code>cov1.est</code> is not provided. The default is a vector containing 50 candidate bandwidths chosen from {0, 1, 2, ..., p}.
</p>
</td></tr>
<tr><td><code id="epval_Cai2014_+3A_bandwidth2">bandwidth2</code></td>
<td>

<p>similar with the argument <code>bandwidth1</code>; it is used to specify candidate bandwidths for estimating the covariance of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="epval_Cai2014_+3A_cv.fold">cv.fold</code></td>
<td>

<p>an integer greater than or equal to 2 indicating the fold of cross-validation. The default is 5. See page 211 in Bickel and Levina (2008).
</p>
</td></tr>
<tr><td><code id="epval_Cai2014_+3A_norm">norm</code></td>
<td>

<p>a character string indicating the type of matrix norm for the calculation of risk function in cross-validation. This argument will be passed to the <code><a href="base.html#topic+norm">norm</a></code> function. The default is the Frobenius norm (<code>"F"</code>).
</p>
</td></tr>
<tr><td><code id="epval_Cai2014_+3A_seeds">seeds</code></td>
<td>

<p>a vector of seeds for each permutation or parametric bootstrap resampling iteration; this is optional.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the details in <code><a href="#topic+apval_Cai2014">apval_Cai2014</a></code>.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>opt.bw1</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov1.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>opt.bw2</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov2.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this was specified by the argument <code>eq.cov</code>.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using permutation or parametric bootstrap resampling.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Cai et al (2014).
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function does not transform the data with their precision matrix (see Cai et al, 2014). To calculate the p-value of the test statisic with transformation, users can input transformed samples to <code>sam1</code> and <code>sam2</code>.
</p>


<h3>References</h3>

<p>Bickel PJ and Levina E (2008). &quot;Regularized estimation of large covariance matrices.&quot; <em>The Annals of Statistics</em>, <b>36</b>(1), 199&ndash;227.
</p>
<p>Cai TT, Liu W, and Xia Y (2014). &quot;Two-sample test of high dimensional means under dependence.&quot; <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>76</b>(2), 349&ndash;372.
</p>
<p>Pourahmadi M (2013). <em>High-Dimensional Covariance Estimation</em>. John Wiley &amp; Sons, Hoboken, NJ.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+apval_Cai2014">apval_Cai2014</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#library(MASS)
#set.seed(1234)
#n1 &lt;- n2 &lt;- 50
#p &lt;- 200
#mu1 &lt;- rep(0, p)
#mu2 &lt;- mu1
#mu2[1:10] &lt;- 0.2
#true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
# increase n.iter to reduce Monte Carlo error
#epval_Cai2014(sam1, sam2, n.iter = 10)

# the two sample populations have different covariances
#true.cov1 &lt;- 0.2^(abs(outer(1:p, 1:p, "-")))
#true.cov2 &lt;- 0.6^(abs(outer(1:p, 1:p, "-")))
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov1)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov2)
# increase n.iter to reduce Monte Carlo error
#epval_Cai2014(sam1, sam2, eq.cov = FALSE, n.iter = 10,
#	bandwidth1 = 10, bandwidth2 = 10)
</code></pre>

<hr>
<h2 id='epval_Chen2010'>
Empirical Permutation- or Resampling-Based p-value of the Test Proposed by Chen and Qin (2010)
</h2><span id='topic+epval_Chen2010'></span>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Chen and Qin (2010) based on permutation or parametric bootstrap resampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epval_Chen2010(sam1, sam2, eq.cov = TRUE, n.iter = 1000, cov1.est, cov2.est,
               bandwidth1, bandwidth2, cv.fold = 5, norm = "F", seeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epval_Chen2010_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_Chen2010_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_Chen2010_+3A_eq.cov">eq.cov</code></td>
<td>

<p>a logical value. The default is <code>TRUE</code>, indicating that the two sample populations have same covariance; otherwise, the covariances are assumed to be different. If <code>eq.cov</code> is <code>TRUE</code>, the permutation method is used to calculate p-values; otherwise, the parametric bootstrap resampling is used.
</p>
</td></tr>
<tr><td><code id="epval_Chen2010_+3A_n.iter">n.iter</code></td>
<td>

<p>a numeric integer indicating the number of permutation/resampling iterations. The default is 1,000.
</p>
</td></tr>
<tr><td><code id="epval_Chen2010_+3A_cov1.est">cov1.est</code></td>
<td>

<p>This and the following arguments are only effective when <code>eq.cov = FALSE</code> and the parametric bootstrap resampling is used to calculate p-values. This argument specifies a consistent estimate of the covariance matrix of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. This can be obtained from various apporoaches (e.g., banding, tapering, and thresholding; see Pourahmadi 2013). If not specified, this function uses a banding approach proposed by Bickel and Levina (2008) to estimate the covariance matrix.
</p>
</td></tr>
<tr><td><code id="epval_Chen2010_+3A_cov2.est">cov2.est</code></td>
<td>

<p>a consistent estimate of the covariance matrix of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>. It is similar with the argument <code>cov1.est</code>.
</p>
</td></tr>
<tr><td><code id="epval_Chen2010_+3A_bandwidth1">bandwidth1</code></td>
<td>

<p>a vector of nonnegative integers indicating the candidate bandwidths to be used in the banding approach (Bickel and Levina, 2008) for estimating the covariance of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. This argument is effective when <code>cov1.est</code> is not provided. The default is a vector containing 50 candidate bandwidths chosen from {0, 1, 2, ..., p}.
</p>
</td></tr>
<tr><td><code id="epval_Chen2010_+3A_bandwidth2">bandwidth2</code></td>
<td>

<p>similar with the argument <code>bandwidth1</code>; it is used to specify candidate bandwidths for estimating the covariance of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="epval_Chen2010_+3A_cv.fold">cv.fold</code></td>
<td>

<p>an integer greater than or equal to 2 indicating the fold of cross-validation. The default is 5. See page 211 in Bickel and Levina (2008).
</p>
</td></tr>
<tr><td><code id="epval_Chen2010_+3A_norm">norm</code></td>
<td>

<p>a character string indicating the type of matrix norm for the calculation of risk function in cross-validation. This argument will be passed to the <code><a href="base.html#topic+norm">norm</a></code> function. The default is the Frobenius norm (<code>"F"</code>).
</p>
</td></tr>
<tr><td><code id="epval_Chen2010_+3A_seeds">seeds</code></td>
<td>

<p>a vector of seeds for each permutation or parametric bootstrap resampling iteration; this is optional.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the details in <code><a href="#topic+apval_Chen2010">apval_Chen2010</a></code>.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>opt.bw1</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov1.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>opt.bw2</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov2.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this was specified by the argument <code>eq.cov</code>.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using permutation or parametric bootstrap resampling.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Chen and Qin (2010).
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bickel PJ and Levina E (2008). &quot;Regularized estimation of large covariance matrices.&quot; <em>The Annals of Statistics</em>, <b>36</b>(1), 199&ndash;227.
</p>
<p>Chen SX and Qin YL (2010). &quot;A two-sample test for high-dimensional data with applications to gene-set testing.&quot; <em>The Annals of Statistics</em>, <b>38</b>(2), 808&ndash;835.
</p>
<p>Pourahmadi M (2013). <em>High-Dimensional Covariance Estimation</em>. John Wiley &amp; Sons, Hoboken, NJ.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+apval_Chen2010">apval_Chen2010</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#library(MASS)
#set.seed(1234)
#n1 &lt;- n2 &lt;- 50
#p &lt;- 200
#mu1 &lt;- rep(0, p)
#mu2 &lt;- mu1
#mu2[1:10] &lt;- 0.2
#true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
# increase n.iter to reduce Monte Carlo error.
#epval_Chen2010(sam1, sam2, n.iter = 10)

# the two sample populations have different covariances
#true.cov1 &lt;- 0.2^(abs(outer(1:p, 1:p, "-")))
#true.cov2 &lt;- 0.6^(abs(outer(1:p, 1:p, "-")))
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov1)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov2)
# increase n.iter to reduce Monte Carlo error
#epval_Chen2010(sam1, sam2, eq.cov = FALSE, n.iter = 10,
#	bandwidth1 = 10, bandwidth2 = 10)
</code></pre>

<hr>
<h2 id='epval_Chen2014'>
Empirical Permutation- or Resampling-Based p-value of the Test Proposed by Chen et al (2014)
</h2><span id='topic+epval_Chen2014'></span>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Chen et al (2014) based on permutation or parametric bootstrap resampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epval_Chen2014(sam1, sam2, eq.cov = TRUE, n.iter = 1000, cov1.est, cov2.est,
               bandwidth1, bandwidth2, cv.fold = 5, norm = "F", seeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epval_Chen2014_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_Chen2014_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_Chen2014_+3A_eq.cov">eq.cov</code></td>
<td>

<p>a logical value. The default is <code>TRUE</code>, indicating that the two sample populations have same covariance; otherwise, the covariances are assumed to be different. If <code>eq.cov</code> is <code>TRUE</code>, the permutation method is used to calculate p-values; otherwise, the parametric bootstrap resampling is used.
</p>
</td></tr>
<tr><td><code id="epval_Chen2014_+3A_n.iter">n.iter</code></td>
<td>

<p>a numeric integer indicating the number of permutation/resampling iterations. The default is 1,000.
</p>
</td></tr>
<tr><td><code id="epval_Chen2014_+3A_cov1.est">cov1.est</code></td>
<td>

<p>This and the following arguments are only effective when <code>eq.cov = FALSE</code> and the parametric bootstrap resampling is used to calculate p-values. This argument specifies a consistent estimate of the covariance matrix of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. This can be obtained from various apporoaches (e.g., banding, tapering, and thresholding; see Pourahmadi 2013). If not specified, this function uses a banding approach proposed by Bickel and Levina (2008) to estimate the covariance matrix.
</p>
</td></tr>
<tr><td><code id="epval_Chen2014_+3A_cov2.est">cov2.est</code></td>
<td>

<p>a consistent estimate of the covariance matrix of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>. It is similar with the argument <code>cov1.est</code>.
</p>
</td></tr>
<tr><td><code id="epval_Chen2014_+3A_bandwidth1">bandwidth1</code></td>
<td>

<p>a vector of nonnegative integers indicating the candidate bandwidths to be used in the banding approach (Bickel and Levina, 2008) for estimating the covariance of sample population 1 when <code>eq.cov</code> is <code>FALSE</code>. This argument is effective when <code>cov1.est</code> is not provided. The default is a vector containing 50 candidate bandwidths chosen from {0, 1, 2, ..., p}.
</p>
</td></tr>
<tr><td><code id="epval_Chen2014_+3A_bandwidth2">bandwidth2</code></td>
<td>

<p>similar with the argument <code>bandwidth1</code>; it is used to specify candidate bandwidths for estimating the covariance of sample population 2 when <code>eq.cov</code> is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="epval_Chen2014_+3A_cv.fold">cv.fold</code></td>
<td>

<p>an integer greater than or equal to 2 indicating the fold of cross-validation. The default is 5. See page 211 in Bickel and Levina (2008).
</p>
</td></tr>
<tr><td><code id="epval_Chen2014_+3A_norm">norm</code></td>
<td>

<p>a character string indicating the type of matrix norm for the calculation of risk function in cross-validation. This argument will be passed to the <code><a href="base.html#topic+norm">norm</a></code> function. The default is the Frobenius norm (<code>"F"</code>).
</p>
</td></tr>
<tr><td><code id="epval_Chen2014_+3A_seeds">seeds</code></td>
<td>

<p>a vector of seeds for each permutation or parametric bootstrap resampling iteration; this is optional.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the details in <code><a href="#topic+apval_Chen2014">apval_Chen2014</a></code>.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>opt.bw1</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov1.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>opt.bw2</code></td>
<td>

<p>the optimal bandwidth determined by the cross-validation when <code>eq.cov</code> was <code>FALSE</code> and <code>cov2.est</code> was not specified.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>the equality assumption on the covariances of the two sample populations; this was specified by the argument <code>eq.cov</code>.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using permutation or parametric bootstrap resampling.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Chen et al (2014).
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function does not transform the data with their precision matrix (see Chen et al, 2014). To calculate the p-value of the test statisic with transformation, users can input transformed samples to <code>sam1</code> and <code>sam2</code>.
</p>


<h3>References</h3>

<p>Bickel PJ and Levina E (2008). &quot;Regularized estimation of large covariance matrices.&quot; <em>The Annals of Statistics</em>, <b>36</b>(1), 199&ndash;227.
</p>
<p>Chen SX, Li J, and Zhong PS (2014). &quot;Two-Sample Tests for High Dimensional Means with Thresholding and Data Transformation.&quot; arXiv preprint arXiv:1410.2848.
</p>
<p>Pourahmadi M (2013). <em>High-Dimensional Covariance Estimation</em>. John Wiley &amp; Sons, Hoboken, NJ.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+apval_Chen2014">apval_Chen2014</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#library(MASS)
#set.seed(1234)
#n1 &lt;- n2 &lt;- 50
#p &lt;- 200
#mu1 &lt;- rep(0, p)
#mu2 &lt;- mu1
#mu2[1:10] &lt;- 0.2
#true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
# increase n.iter to reduce Monte Carlo error
#epval_Chen2014(sam1, sam2, n.iter = 10)

# the two sample populations have different covariances
#true.cov1 &lt;- 0.2^(abs(outer(1:p, 1:p, "-")))
#true.cov2 &lt;- 0.6^(abs(outer(1:p, 1:p, "-")))
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov1)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov2)
# increase n.iter to reduce Monte Carlo error
#epval_Chen2014(sam1, sam2, eq.cov = FALSE, n.iter = 10,
#	bandwidth1 = 10, bandwidth2 = 10)
</code></pre>

<hr>
<h2 id='epval_Sri2008'>
Empirical Permutation-Based p-value of the Test Proposed by Srivastava and Du (2008)
</h2><span id='topic+epval_Sri2008'></span>

<h3>Description</h3>

<p>Calculates p-value of the test for testing equality of two-sample high-dimensional mean vectors proposed by Srivastava and Du (1996) based on permutation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epval_Sri2008(sam1, sam2, n.iter = 1000, seeds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epval_Sri2008_+3A_sam1">sam1</code></td>
<td>

<p>an n1 by p matrix from sample population 1. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_Sri2008_+3A_sam2">sam2</code></td>
<td>

<p>an n2 by p matrix from sample population 2. Each row represents a <code class="reqn">p</code>-dimensional sample.
</p>
</td></tr>
<tr><td><code id="epval_Sri2008_+3A_n.iter">n.iter</code></td>
<td>

<p>a numeric integer indicating the number of permutation iterations. The default is 1,000.
</p>
</td></tr>
<tr><td><code id="epval_Sri2008_+3A_seeds">seeds</code></td>
<td>

<p>a vector of seeds for each permutation or parametric bootstrap resampling iteration; this is optional.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the details in <code><a href="#topic+apval_Sri2008">apval_Sri2008</a></code>.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>sam.info</code></td>
<td>

<p>the basic information about the two groups of samples, including the samples sizes and dimension.
</p>
</td></tr>
<tr><td><code>cov.assumption</code></td>
<td>

<p>this output reminds users that the two sample populations have a common covariance matrix.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>this output reminds users that the p-values are obtained using permutation.
</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>the p-value of the test proposed by Srivastava and Du (2008).
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The permutation technique assumes that the distributions of the two sample populations are the same under the null hypothesis.
</p>


<h3>References</h3>

<p>Srivastava MS and Du M (2008). &quot;A test for the mean vector with fewer observations than the dimension.&quot; <em>Journal of Multivariate Analysis</em>, <b>99</b>(3), 386&ndash;402.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+apval_Sri2008">apval_Sri2008</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#library(MASS)
#set.seed(1234)
#n1 &lt;- n2 &lt;- 50
#p &lt;- 200
#mu1 &lt;- rep(0, p)
#mu2 &lt;- mu1
#mu2[1:10] &lt;- 0.2
#true.cov &lt;- 0.4^(abs(outer(1:p, 1:p, "-"))) # AR1 covariance
#sam1 &lt;- mvrnorm(n = n1, mu = mu1, Sigma = true.cov)
#sam2 &lt;- mvrnorm(n = n2, mu = mu2, Sigma = true.cov)
# increase n.iter to reduce Monte Carlo error.
#epval_Sri2008(sam1, sam2, n.iter = 10)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
