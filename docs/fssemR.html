<!DOCTYPE html><html lang="en"><head><title>Help for package fssemR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fssemR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cv.multiFSSEMiPALM'><p>cv.multiFSSEMiPALM</p></a></li>
<li><a href='#cv.multiFSSEMiPALM2'><p>cv.multiFSSEMiPALM2</p></a></li>
<li><a href='#cv.multiNFSSEMiPALM2'><p>cv.multiNFSSEMiPALM2</p></a></li>
<li><a href='#cv.multiRegression'><p>cv.multiRegression</p></a></li>
<li><a href='#cwiseGradient4FSSEM'><p>cwiseGradient4FSSEM</p></a></li>
<li><a href='#FDR'><p>FDR</p></a></li>
<li><a href='#flinvB'><p>flinvB</p></a></li>
<li><a href='#floneB'><p>floneB</p></a></li>
<li><a href='#fssemR'><p>Solving Sparse Structural Equation Model</p></a></li>
<li><a href='#implFSSEM'><p>implFSSEM</p></a></li>
<li><a href='#initLambdaiPALM'><p>initLambdaiPALM</p></a></li>
<li><a href='#initLambdaiPALM2'><p>initLambdaiPALM2</p></a></li>
<li><a href='#initLambdaiPALM3'><p>initLambdaiPALM3</p></a></li>
<li><a href='#initRhoiPALM'><p>initRhoiPALM</p></a></li>
<li><a href='#initRhoiPALM2'><p>initRhoiPALM2</p></a></li>
<li><a href='#initRhoiPALM3'><p>initRhoiPALM3</p></a></li>
<li><a href='#inverseB'><p>inverseB</p></a></li>
<li><a href='#invoneB'><p>invoneB</p></a></li>
<li><a href='#logLikFSSEM'><p>logLikFSSEM</p></a></li>
<li><a href='#logLikNFSSEM'><p>logLikNFSSEM</p></a></li>
<li><a href='#multiFSSEMiPALM'><p>multiFSSEMiPALM</p></a></li>
<li><a href='#multiFSSEMiPALM2'><p>multiFSSEMiPALM2</p></a></li>
<li><a href='#multiNFSSEMiPALM2'><p>multiNFSSEMiPALM2</p></a></li>
<li><a href='#multiRegression'><p>multiRegression</p></a></li>
<li><a href='#obj.multiRegression'><p>obj.multiRegression</p></a></li>
<li><a href='#opt.multiFSSEMiPALM'><p>opt.multiFSSEMiPALM</p></a></li>
<li><a href='#opt.multiFSSEMiPALM2'><p>opt.multiFSSEMiPALM2</p></a></li>
<li><a href='#opt.multiNFSSEMiPALM2'><p>opt.multiNFSSEMiPALM2</p></a></li>
<li><a href='#pninvB'><p>pninvB</p></a></li>
<li><a href='#pnoneB'><p>pnoneB</p></a></li>
<li><a href='#proc.centerFSSEM'><p>proc.centerFSSEM</p></a></li>
<li><a href='#proc.centerFSSEM2'><p>proc.centerFSSEM2</p></a></li>
<li><a href='#randomFSSEMdata'><p>randomFSSEMdata</p></a></li>
<li><a href='#randomFSSEMdata2'><p>randomFSSEMdata2</p></a></li>
<li><a href='#randomFSSEMdata4Cor'><p>randomFSSEMdata4Cor</p></a></li>
<li><a href='#TPR'><p>TPR</p></a></li>
<li><a href='#transx'><p>transx</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Fused Sparse Structural Equation Models to Jointly Infer Gene
Regulatory Network</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.8</td>
</tr>
<tr>
<td>Author:</td>
<td>Xin Zhou, Xiaodong Cai</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xin Zhou &lt;xxz220@miami.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An optimizer of Fused-Sparse Structural Equation Models, which is 
 the state of the art jointly fused sparse maximum likelihood function 
 for structural equation models proposed by Xin Zhou and Xiaodong Cai (2018 
 &lt;<a href="https://doi.org/10.1101%2F466623">doi:10.1101/466623</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, Matrix, stats, igraph, mvtnorm, qtl, stringr, glmnet,
MASS, qpdf</td>
</tr>
<tr>
<td>Suggests:</td>
<td>plotly, knitr, rmarkdown, network, ggnetwork</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Ivis4ml/fssemR">https://github.com/Ivis4ml/fssemR</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-11 10:02:31 UTC; xxzhou</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-11 13:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cv.multiFSSEMiPALM'>cv.multiFSSEMiPALM</h2><span id='topic+cv.multiFSSEMiPALM'></span>

<h3>Description</h3>

<p>cv.multiFSSEMiPALM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.multiFSSEMiPALM(
  Xs,
  Ys,
  Bs,
  Fs,
  Sk,
  sigma2,
  nlambda = 20,
  nrho = 20,
  nfold = 5,
  p,
  q,
  wt = TRUE,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.multiFSSEMiPALM_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_nlambda">nlambda</code></td>
<td>
<p>number of hyper-parameter of lasso term in CV</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_nrho">nrho</code></td>
<td>
<p>number of hyper-parameter of fused-lasso term in CV</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_nfold">nfold</code></td>
<td>
<p>CVfold number. Default 5/10</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_q">q</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_wt">wt</code></td>
<td>
<p>use adaptive lasso or not. Default TRUE.</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM_+3A_plot">plot</code></td>
<td>
<p>plot contour of cvmean or not. Default FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of cross-validation result
</p>

<hr>
<h2 id='cv.multiFSSEMiPALM2'>cv.multiFSSEMiPALM2</h2><span id='topic+cv.multiFSSEMiPALM2'></span>

<h3>Description</h3>

<p>cv.multiFSSEMiPALM2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.multiFSSEMiPALM2(
  Xs,
  Ys,
  Bs,
  Fs,
  Sk,
  sigma2,
  nlambda = 20,
  nrho = 20,
  nfold = 5,
  p,
  q,
  wt = TRUE,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_nlambda">nlambda</code></td>
<td>
<p>number of hyper-parameter of lasso term in CV</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_nrho">nrho</code></td>
<td>
<p>number of hyper-parameter of fused-lasso term in CV</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_nfold">nfold</code></td>
<td>
<p>CVfold number. Default 5/10</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_q">q</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_wt">wt</code></td>
<td>
<p>use adaptive lasso or not. Default TRUE.</p>
</td></tr>
<tr><td><code id="cv.multiFSSEMiPALM2_+3A_plot">plot</code></td>
<td>
<p>plot contour of cvmean or not. Default FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of cross-validation result
</p>

<hr>
<h2 id='cv.multiNFSSEMiPALM2'>cv.multiNFSSEMiPALM2</h2><span id='topic+cv.multiNFSSEMiPALM2'></span>

<h3>Description</h3>

<p>cv.multiNFSSEMiPALM2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.multiNFSSEMiPALM2(
  Xs,
  Ys,
  Bs,
  Fs,
  Sk,
  sigma2,
  nlambda = 20,
  nrho = 20,
  nfold = 5,
  p,
  q,
  wt = TRUE,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_nlambda">nlambda</code></td>
<td>
<p>number of hyper-parameter of lasso term in CV</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_nrho">nrho</code></td>
<td>
<p>number of hyper-parameter of fused-lasso term in CV</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_nfold">nfold</code></td>
<td>
<p>CVfold number. Default 5/10</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_q">q</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_wt">wt</code></td>
<td>
<p>use adaptive lasso or not. Default TRUE.</p>
</td></tr>
<tr><td><code id="cv.multiNFSSEMiPALM2_+3A_plot">plot</code></td>
<td>
<p>plot contour of cvmean or not. Default FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of cross-validation result for NFSSEM
</p>

<hr>
<h2 id='cv.multiRegression'>cv.multiRegression</h2><span id='topic+cv.multiRegression'></span>

<h3>Description</h3>

<p>cv.multiRegression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.multiRegression(Xs, Ys, Sk, ngamma = 20, nfold = 5, n, p, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.multiRegression_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="cv.multiRegression_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="cv.multiRegression_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="cv.multiRegression_+3A_ngamma">ngamma</code></td>
<td>
<p>number of hyper-parameter in CV</p>
</td></tr>
<tr><td><code id="cv.multiRegression_+3A_nfold">nfold</code></td>
<td>
<p>CVfold number. Default 5/10</p>
</td></tr>
<tr><td><code id="cv.multiRegression_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="cv.multiRegression_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="cv.multiRegression_+3A_k">k</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>gamma_min optimal gamma to minimize cross-validation error
</p>

<hr>
<h2 id='cwiseGradient4FSSEM'>cwiseGradient4FSSEM</h2><span id='topic+cwiseGradient4FSSEM'></span>

<h3>Description</h3>

<p>function generator function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cwiseGradient4FSSEM(n, c, Y, R, Y2norm, sigma2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cwiseGradient4FSSEM_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="cwiseGradient4FSSEM_+3A_c">c</code></td>
<td>
<p>cofactor vector</p>
</td></tr>
<tr><td><code id="cwiseGradient4FSSEM_+3A_y">Y</code></td>
<td>
<p>Matrix of gene expression</p>
</td></tr>
<tr><td><code id="cwiseGradient4FSSEM_+3A_r">R</code></td>
<td>
<p>Residual matrix</p>
</td></tr>
<tr><td><code id="cwiseGradient4FSSEM_+3A_y2norm">Y2norm</code></td>
<td>
<p>Column of YtY</p>
</td></tr>
<tr><td><code id="cwiseGradient4FSSEM_+3A_sigma2">sigma2</code></td>
<td>
<p>noise variance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>function whose argument is column vector bi
</p>

<hr>
<h2 id='FDR'>FDR</h2><span id='topic+FDR'></span>

<h3>Description</h3>

<p>False discovery rate for network prediction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FDR(X, B, PREC = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FDR_+3A_x">X</code></td>
<td>
<p>list of predicted network matrices</p>
</td></tr>
<tr><td><code id="FDR_+3A_b">B</code></td>
<td>
<p>list of true network matrices</p>
</td></tr>
<tr><td><code id="FDR_+3A_prec">PREC</code></td>
<td>
<p>precision threshold for FDR test. Default 0.</p>
</td></tr>
</table>

<hr>
<h2 id='flinvB'>flinvB</h2><span id='topic+flinvB'></span>

<h3>Description</h3>

<p>inversed difference of two B matrices. For adaptive fused lasso penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flinvB(Bs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flinvB_+3A_bs">Bs</code></td>
<td>
<p>list of network matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>inversed difference matrices
</p>

<hr>
<h2 id='floneB'>floneB</h2><span id='topic+floneB'></span>

<h3>Description</h3>

<p>if you do not want adaptive fused lasso penalty, floneB replace flinvB
</p>


<h3>Usage</h3>

<pre><code class='language-R'>floneB(Bs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="floneB_+3A_bs">Bs</code></td>
<td>
<p>list of network matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix whose entries are all 1
</p>

<hr>
<h2 id='fssemR'>Solving Sparse Structural Equation Model</h2><span id='topic+fssemR'></span><span id='topic+package-fssemR'></span>

<h3>Description</h3>

<p>An optimizer of Fused-Sparse Structural Equation Models, which is 
the state of the art jointly fused sparse maximum likelihood function 
for structural equation models proposed by Xin Zhou and Xiaodong Cai (2018 
&lt;doi:10.1101/466623&gt;)
</p>


<h3>Author(s)</h3>

<p>Xin Zhou &lt;<a href="mailto:xxz220@miami.edu">xxz220@miami.edu</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seed = as.numeric(Sys.time())
N = 100                                           # sample size
Ng = 5                                            # gene number
Nk = 5 * 3                                        # eQTL number
Ns = 1                                            # sparse ratio
sigma2 = 0.01                                     # sigma2
set.seed(seed)
library(fssemR)
data = randomFSSEMdata(n = N, p = Ng, k = Nk, sparse = Ns, df = 0.3, sigma2 = sigma2,
                       u = 5, type = "DG", nhub = 1, dag = TRUE)
gamma = cv.multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, ngamma = 20, nfold = 5,
                           N, Ng, Nk)
fit   = multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, gamma, N, Ng, Nk,
                      trans = FALSE)
Xs    = data$Data$X
Ys    = data$Data$Y
Sk    = data$Data$Sk

## cross-validation
## cvfitc &lt;- cv.multiFSSEMiPALM(Xs = Xs, Ys = Ys, Bs = fit$Bs, Fs = fit$Fs, Sk = Sk,
##                              sigma2 = fit$sigma2, nlambda = 10, nrho = 10,
##                              nfold = 5, p = Ng, q = Nk, wt = TRUE)

fitm &lt;- opt.multiFSSEMiPALM(Xs = Xs, Ys = Ys, Bs = fit$Bs, Fs = fit$Fs, Sk = Sk,
                           sigma2 = fit$sigma2, nlambda = 10, nrho = 10,
                           p = Ng, q = Nk, wt = TRUE)

fitc0 &lt;- fitm$fit

(TPR(fitc0$Bs[[1]], data$Vars$B[[1]]) + TPR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
(FDR(fitc0$Bs[[1]], data$Vars$B[[1]]) + FDR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
TPR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
FDR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
</code></pre>

<hr>
<h2 id='implFSSEM'>implFSSEM</h2><span id='topic+implFSSEM'></span>

<h3>Description</h3>

<p>implementor function of FSSEM solver
</p>


<h3>Usage</h3>

<pre><code class='language-R'>implFSSEM(data = NULL, method = c("CV", "BIC"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="implFSSEM_+3A_data">data</code></td>
<td>
<p>Data archive of experiment measurements, includeing
eQTL matrices, Gene expression matrices of different conditions,
marker of eQTLs and data generation SEM model</p>
</td></tr>
<tr><td><code id="implFSSEM_+3A_method">method</code></td>
<td>
<p>Use cross-validation (CV) or bayesian-information-criterion(BIC)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of TPR and FDR
</p>

<hr>
<h2 id='initLambdaiPALM'>initLambdaiPALM</h2><span id='topic+initLambdaiPALM'></span>

<h3>Description</h3>

<p>initLambdaiPALM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initLambdaiPALM(Xs, Ys, Bs, Fs, Sk, sigma2, Wl, Wf, p, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initLambdaiPALM_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="initLambdaiPALM_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="initLambdaiPALM_+3A_wl">Wl</code></td>
<td>
<p>weight matrices for adaptive lasso terms</p>
</td></tr>
<tr><td><code id="initLambdaiPALM_+3A_wf">Wf</code></td>
<td>
<p>weight matrix for adaptive fused lasso term</p>
</td></tr>
<tr><td><code id="initLambdaiPALM_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="initLambdaiPALM_+3A_k">k</code></td>
<td>
<p>number of eQTL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lambda_max
</p>

<hr>
<h2 id='initLambdaiPALM2'>initLambdaiPALM2</h2><span id='topic+initLambdaiPALM2'></span>

<h3>Description</h3>

<p>initLambdaiPALM2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initLambdaiPALM2(Xs, Ys, Bs, Fs, Sk, sigma2, Wl, Wf, p, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initLambdaiPALM2_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM2_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM2_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM2_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM2_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="initLambdaiPALM2_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="initLambdaiPALM2_+3A_wl">Wl</code></td>
<td>
<p>weight matrices for adaptive lasso terms</p>
</td></tr>
<tr><td><code id="initLambdaiPALM2_+3A_wf">Wf</code></td>
<td>
<p>weight matrix for adaptive fused lasso term</p>
</td></tr>
<tr><td><code id="initLambdaiPALM2_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="initLambdaiPALM2_+3A_k">k</code></td>
<td>
<p>number of eQTL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lambda_max
</p>

<hr>
<h2 id='initLambdaiPALM3'>initLambdaiPALM3</h2><span id='topic+initLambdaiPALM3'></span>

<h3>Description</h3>

<p>initLambdaiPALM3
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initLambdaiPALM3(Xs, Ys, Bs, Fs, Sk, sigma2, Wl, Wf, p, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initLambdaiPALM3_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM3_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM3_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM3_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="initLambdaiPALM3_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="initLambdaiPALM3_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="initLambdaiPALM3_+3A_wl">Wl</code></td>
<td>
<p>weight matrices for adaptive lasso terms</p>
</td></tr>
<tr><td><code id="initLambdaiPALM3_+3A_wf">Wf</code></td>
<td>
<p>weight matrix for adaptive fused lasso term</p>
</td></tr>
<tr><td><code id="initLambdaiPALM3_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="initLambdaiPALM3_+3A_k">k</code></td>
<td>
<p>number of eQTL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lambda_max
</p>

<hr>
<h2 id='initRhoiPALM'>initRhoiPALM</h2><span id='topic+initRhoiPALM'></span>

<h3>Description</h3>

<p>initRhoiPALM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initRhoiPALM(Xs, Ys, Bs, Fs, Sk, sigma2, Wl, Wf, lambda, n, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initRhoiPALM_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="initRhoiPALM_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="initRhoiPALM_+3A_wl">Wl</code></td>
<td>
<p>weight matrices for adaptive lasso terms</p>
</td></tr>
<tr><td><code id="initRhoiPALM_+3A_wf">Wf</code></td>
<td>
<p>weight matrix for adaptive fused lasso term</p>
</td></tr>
<tr><td><code id="initRhoiPALM_+3A_lambda">lambda</code></td>
<td>
<p>lambda w.r.t. rho_max</p>
</td></tr>
<tr><td><code id="initRhoiPALM_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="initRhoiPALM_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rho_max
</p>

<hr>
<h2 id='initRhoiPALM2'>initRhoiPALM2</h2><span id='topic+initRhoiPALM2'></span>

<h3>Description</h3>

<p>initRhoiPALM2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initRhoiPALM2(Xs, Ys, Bs, Fs, Sk, sigma2, Wl, Wf, lambda, n, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initRhoiPALM2_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM2_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM2_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM2_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM2_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="initRhoiPALM2_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="initRhoiPALM2_+3A_wl">Wl</code></td>
<td>
<p>weight matrices for adaptive lasso terms</p>
</td></tr>
<tr><td><code id="initRhoiPALM2_+3A_wf">Wf</code></td>
<td>
<p>weight matrix for adaptive fused lasso term</p>
</td></tr>
<tr><td><code id="initRhoiPALM2_+3A_lambda">lambda</code></td>
<td>
<p>lambda w.r.t. rho_max</p>
</td></tr>
<tr><td><code id="initRhoiPALM2_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="initRhoiPALM2_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rho_max
</p>

<hr>
<h2 id='initRhoiPALM3'>initRhoiPALM3</h2><span id='topic+initRhoiPALM3'></span>

<h3>Description</h3>

<p>initRhoiPALM3
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initRhoiPALM3(Xs, Ys, Bs, Fs, Sk, sigma2, Wl, Wf, lambda, n, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initRhoiPALM3_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM3_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM3_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM3_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="initRhoiPALM3_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="initRhoiPALM3_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="initRhoiPALM3_+3A_wl">Wl</code></td>
<td>
<p>weight matrices for adaptive lasso terms</p>
</td></tr>
<tr><td><code id="initRhoiPALM3_+3A_wf">Wf</code></td>
<td>
<p>weight matrix for adaptive perturbation group lasso term</p>
</td></tr>
<tr><td><code id="initRhoiPALM3_+3A_lambda">lambda</code></td>
<td>
<p>lambda w.r.t. rho_max</p>
</td></tr>
<tr><td><code id="initRhoiPALM3_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="initRhoiPALM3_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rho_max
</p>

<hr>
<h2 id='inverseB'>inverseB</h2><span id='topic+inverseB'></span>

<h3>Description</h3>

<p>inverse matrices of B network for adaptive FSSEM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inverseB(Bs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inverseB_+3A_bs">Bs</code></td>
<td>
<p>list of network matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of inversed B matrices
</p>

<hr>
<h2 id='invoneB'>invoneB</h2><span id='topic+invoneB'></span>

<h3>Description</h3>

<p>if you do not want to get inversed B matrces, invoneB gives you a matrix with constant 1 instead in FSSEM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invoneB(Bs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="invoneB_+3A_bs">Bs</code></td>
<td>
<p>list of network matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of invone B matrices
</p>

<hr>
<h2 id='logLikFSSEM'>logLikFSSEM</h2><span id='topic+logLikFSSEM'></span>

<h3>Description</h3>

<p>logLikFSSEM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLikFSSEM(Bs, Wl, Wf, lambda, rho, sigma2, Dets, n, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLikFSSEM_+3A_bs">Bs</code></td>
<td>
<p>Network matrices</p>
</td></tr>
<tr><td><code id="logLikFSSEM_+3A_wl">Wl</code></td>
<td>
<p>Weights for lasso term</p>
</td></tr>
<tr><td><code id="logLikFSSEM_+3A_wf">Wf</code></td>
<td>
<p>Weights for fused term</p>
</td></tr>
<tr><td><code id="logLikFSSEM_+3A_lambda">lambda</code></td>
<td>
<p>Hyperparameter of lasso term</p>
</td></tr>
<tr><td><code id="logLikFSSEM_+3A_rho">rho</code></td>
<td>
<p>Hyperparameter of fused lasso term</p>
</td></tr>
<tr><td><code id="logLikFSSEM_+3A_sigma2">sigma2</code></td>
<td>
<p>noise variance</p>
</td></tr>
<tr><td><code id="logLikFSSEM_+3A_dets">Dets</code></td>
<td>
<p>determinants of I-B matrices</p>
</td></tr>
<tr><td><code id="logLikFSSEM_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="logLikFSSEM_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>objective value of FSSEM with specified hyper-paramters
</p>

<hr>
<h2 id='logLikNFSSEM'>logLikNFSSEM</h2><span id='topic+logLikNFSSEM'></span>

<h3>Description</h3>

<p>logLikNFSSEM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLikNFSSEM(Bs, Wl, Wf, lambda, rho, sigma2, Dets, n, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLikNFSSEM_+3A_bs">Bs</code></td>
<td>
<p>Network matrices</p>
</td></tr>
<tr><td><code id="logLikNFSSEM_+3A_wl">Wl</code></td>
<td>
<p>Weights for lasso term</p>
</td></tr>
<tr><td><code id="logLikNFSSEM_+3A_wf">Wf</code></td>
<td>
<p>Weights for group perturb lasso term</p>
</td></tr>
<tr><td><code id="logLikNFSSEM_+3A_lambda">lambda</code></td>
<td>
<p>Hyperparameter of lasso term</p>
</td></tr>
<tr><td><code id="logLikNFSSEM_+3A_rho">rho</code></td>
<td>
<p>Hyperparameter of group fused lasso term</p>
</td></tr>
<tr><td><code id="logLikNFSSEM_+3A_sigma2">sigma2</code></td>
<td>
<p>noise variance</p>
</td></tr>
<tr><td><code id="logLikNFSSEM_+3A_dets">Dets</code></td>
<td>
<p>determinants of I-B matrices</p>
</td></tr>
<tr><td><code id="logLikNFSSEM_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="logLikNFSSEM_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>objective value of NFSSEM with specified hyper-paramters
</p>

<hr>
<h2 id='multiFSSEMiPALM'>multiFSSEMiPALM</h2><span id='topic+multiFSSEMiPALM'></span>

<h3>Description</h3>

<p>Implementing FSSELM algorithm for network inference. If Xs is identify for different conditions, multiFSSEMiPALM will be use, otherwise, please
use <code>multiFSSEMiPALM2</code> for general cases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiFSSEMiPALM(
  Xs,
  Ys,
  Bs,
  Fs,
  Sk,
  sigma2,
  lambda,
  rho,
  Wl,
  Wf,
  p,
  maxit = 100,
  inert = inert_opt("linear"),
  threshold = 1e-06,
  verbose = TRUE,
  sparse = TRUE,
  trans = FALSE,
  B2norm = NULL,
  strict = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiFSSEMiPALM_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance from ridge regression</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_lambda">lambda</code></td>
<td>
<p>Hyperparameter of lasso term in FSSEM</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_rho">rho</code></td>
<td>
<p>Hyperparameter of fused-lasso term in FSSEM</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_wl">Wl</code></td>
<td>
<p>weight matrices for adaptive lasso terms</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_wf">Wf</code></td>
<td>
<p>weight matrix for adaptive fused lasso term</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_maxit">maxit</code></td>
<td>
<p>maximum iteration number. Default 100</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_inert">inert</code></td>
<td>
<p>inertial function for iPALM. Default as k-1/k+2</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_threshold">threshold</code></td>
<td>
<p>convergence threshold. Default 1e-6</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_verbose">verbose</code></td>
<td>
<p>Default TRUE</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_sparse">sparse</code></td>
<td>
<p>Sparse Matrix or not</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_trans">trans</code></td>
<td>
<p>Fs matrix is transposed to k x p or not. If Fs from ridge regression, trans = TRUE, else, trans = FALSE</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_b2norm">B2norm</code></td>
<td>
<p>B2norm matrices generated from ridge regression. Default NULL.</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM_+3A_strict">strict</code></td>
<td>
<p>Converge strictly or not. Default False</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit List of FSSEM model
</p>

<dl>
<dt>Bs</dt><dd><p> coefficient matrices of gene regulatory networks</p>
</dd>
<dt>Fs</dt><dd><p> coefficient matrices of eQTL-gene effect</p>
</dd>
<dt>mu</dt><dd><p> Bias vector</p>
</dd>
<dt>sigma2</dt><dd><p> estimate of covariance in SEM</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>seed = 1234
N = 100                                           # sample size
Ng = 5                                            # gene number
Nk = 5 * 3                                        # eQTL number
Ns = 1                                            # sparse ratio
sigma2 = 0.01                                     # sigma2
set.seed(seed)
library(fssemR)
data = randomFSSEMdata(n = N, p = Ng, k = Nk, sparse = Ns, df = 0.3, sigma2 = sigma2,
                       u = 5, type = "DG", nhub = 1, dag = TRUE)
## If we assume that different condition has different genetics perturbations (eQTLs)
## gamma = cv.multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, ngamma = 20, nfold = 5,
##                            N, Ng, Nk)
gamma = 0.6784248     ## optimal gamma computed by cv.multiRegression
fit   = multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, gamma, N, Ng, Nk,
                      trans = FALSE)
Xs    = data$Data$X
Ys    = data$Data$Y
Sk    = data$Data$Sk


cvfitc &lt;- cv.multiFSSEMiPALM(Xs = Xs, Ys = Ys, Bs = fit$Bs, Fs = fit$Fs, Sk = Sk,
                             sigma2 = fit$sigma2, nlambda = 5, nrho = 5,
                             nfold = 5, p = Ng, q = Nk, wt = TRUE)

fitc0 &lt;- multiFSSEMiPALM(Xs = Xs, Ys = Ys, Bs = fit$Bs, Fs = fit$Fs, Sk = Sk,
                         sigma2 = fit$sigma2, lambda = cvfitc$lambda, rho = cvfitc$rho,
                         Wl = inverseB(fit$Bs), Wf = flinvB(fit$Bs),
                         p = Ng, maxit = 100, threshold = 1e-5, sparse = TRUE, 
                         verbose = TRUE, trans = TRUE, strict = TRUE)


(TPR(fitc0$Bs[[1]], data$Vars$B[[1]]) + TPR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
(FDR(fitc0$Bs[[1]], data$Vars$B[[1]]) + FDR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
TPR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
FDR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
</code></pre>

<hr>
<h2 id='multiFSSEMiPALM2'>multiFSSEMiPALM2</h2><span id='topic+multiFSSEMiPALM2'></span>

<h3>Description</h3>

<p>Implementing FSSELM algorithm for network inference. If Xs is identify for different conditions, multiFSSEMiPALM will be use, otherwise, please
use <code>multiFSSEMiPALM2</code> for general cases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiFSSEMiPALM2(
  Xs,
  Ys,
  Bs,
  Fs,
  Sk,
  sigma2,
  lambda,
  rho,
  Wl,
  Wf,
  p,
  maxit = 100,
  inert = inert_opt("linear"),
  threshold = 1e-06,
  verbose = TRUE,
  sparse = TRUE,
  trans = FALSE,
  B2norm = NULL,
  strict = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiFSSEMiPALM2_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance from ridge regression</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_lambda">lambda</code></td>
<td>
<p>Hyperparameter of lasso term in FSSEM</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_rho">rho</code></td>
<td>
<p>Hyperparameter of fused-lasso term in FSSEM</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_wl">Wl</code></td>
<td>
<p>weight matrices for adaptive lasso terms</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_wf">Wf</code></td>
<td>
<p>weight matrix for adaptive fused lasso term</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_maxit">maxit</code></td>
<td>
<p>maximum iteration number. Default 100</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_inert">inert</code></td>
<td>
<p>inertial function for iPALM. Default as k-1/k+2</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_threshold">threshold</code></td>
<td>
<p>convergence threshold. Default 1e-6</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_verbose">verbose</code></td>
<td>
<p>Default TRUE</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_sparse">sparse</code></td>
<td>
<p>Sparse Matrix or not</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_trans">trans</code></td>
<td>
<p>Fs matrix is transposed to k x p or not. If Fs from ridge regression, trans = TRUE, else, trans = FALSE</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_b2norm">B2norm</code></td>
<td>
<p>B2norm matrices generated from ridge regression. Default NULL.</p>
</td></tr>
<tr><td><code id="multiFSSEMiPALM2_+3A_strict">strict</code></td>
<td>
<p>Converge strictly or not. Default False</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit List of FSSEM model
</p>

<dl>
<dt>Bs</dt><dd><p> coefficient matrices of gene regulatory networks</p>
</dd>
<dt>Fs</dt><dd><p> coefficient matrices of eQTL-gene effect</p>
</dd>
<dt>mu</dt><dd><p> Bias vector</p>
</dd>
<dt>sigma2</dt><dd><p> estimate of covariance in SEM</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>seed = 1234
N = 100                                           # sample size
Ng = 5                                            # gene number
Nk = 5 * 3                                        # eQTL number
Ns = 1                                            # sparse ratio
sigma2 = 0.01                                     # sigma2
set.seed(seed)
library(fssemR)
data = randomFSSEMdata(n = N, p = Ng, k = Nk, sparse = Ns, df = 0.3, sigma2 = sigma2,
                       u = 5, type = "DG", nhub = 1, dag = TRUE)
## If we assume that different condition has different genetics perturbations (eQTLs)
data$Data$X = list(data$Data$X, data$Data$X)
## gamma = cv.multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, ngamma = 20, nfold = 5,
##                            N, Ng, Nk)
gamma = 0.6784248     ## optimal gamma computed by cv.multiRegression
fit   = multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, gamma, N, Ng, Nk,
                      trans = FALSE)
Xs    = data$Data$X
Ys    = data$Data$Y
Sk    = data$Data$Sk


cvfitc &lt;- cv.multiFSSEMiPALM2(Xs = Xs, Ys = Ys, Bs = fit$Bs, Fs = fit$Fs, Sk = Sk,
                             sigma2 = fit$sigma2, nlambda = 5, nrho = 5,
                             nfold = 5, p = Ng, q = Nk, wt = TRUE)

fitc0 &lt;- multiFSSEMiPALM2(Xs = Xs, Ys = Ys, Bs = fit$Bs, Fs = fit$Fs, Sk = Sk,
                          sigma2 = fit$sigma2, lambda = cvfitc$lambda, rho = cvfitc$rho,
                          Wl = inverseB(fit$Bs), Wf = flinvB(fit$Bs),
                          p = Ng, maxit = 100, threshold = 1e-5, sparse = TRUE, 
                          verbose = TRUE, trans = TRUE, strict = TRUE)


(TPR(fitc0$Bs[[1]], data$Vars$B[[1]]) + TPR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
(FDR(fitc0$Bs[[1]], data$Vars$B[[1]]) + FDR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
TPR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
FDR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
</code></pre>

<hr>
<h2 id='multiNFSSEMiPALM2'>multiNFSSEMiPALM2</h2><span id='topic+multiNFSSEMiPALM2'></span>

<h3>Description</h3>

<p>Implementing NFSSEM algorithm for network inference. If Xs is identify for different conditions, multiNFSSEMiPALM will be use, otherwise, please
use <code>multiNFSSEMiPALM2</code> for general cases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiNFSSEMiPALM2(
  Xs,
  Ys,
  Bs,
  Fs,
  Sk,
  sigma2,
  lambda,
  rho,
  Wl,
  Wf,
  p,
  maxit = 100,
  inert = inert_opt("linear"),
  threshold = 1e-06,
  verbose = TRUE,
  sparse = TRUE,
  trans = FALSE,
  B2norm = NULL,
  strict = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiNFSSEMiPALM2_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance from ridge regression</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_lambda">lambda</code></td>
<td>
<p>Hyperparameter of lasso term in NFSSEM</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_rho">rho</code></td>
<td>
<p>Hyperparameter of fused-lasso term in NFSSEM</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_wl">Wl</code></td>
<td>
<p>weight matrices for adaptive lasso terms</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_wf">Wf</code></td>
<td>
<p>weight matrix for columnwise l2 norm adaptive group lasso</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_maxit">maxit</code></td>
<td>
<p>maximum iteration number. Default 100</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_inert">inert</code></td>
<td>
<p>inertial function for iPALM. Default as k-1/k+2</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_threshold">threshold</code></td>
<td>
<p>convergence threshold. Default 1e-6</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_verbose">verbose</code></td>
<td>
<p>Default TRUE</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_sparse">sparse</code></td>
<td>
<p>Sparse Matrix or not</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_trans">trans</code></td>
<td>
<p>Fs matrix is transposed to k x p or not. If Fs from ridge regression, trans = TRUE, else, trans = FALSE</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_b2norm">B2norm</code></td>
<td>
<p>B2norm matrices generated from ridge regression. Default NULL.</p>
</td></tr>
<tr><td><code id="multiNFSSEMiPALM2_+3A_strict">strict</code></td>
<td>
<p>Converge strictly or not. Default False</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit List of NFSSEM model
</p>

<dl>
<dt>Bs</dt><dd><p> coefficient matrices of gene regulatory networks</p>
</dd>
<dt>Fs</dt><dd><p> coefficient matrices of eQTL-gene effect</p>
</dd>
<dt>mu</dt><dd><p> Bias vector</p>
</dd>
<dt>sigma2</dt><dd><p> estimate of covariance in SEM</p>
</dd>
</dl>


<hr>
<h2 id='multiRegression'>multiRegression</h2><span id='topic+multiRegression'></span>

<h3>Description</h3>

<p>Ridge regression on multiple conditions, initialization of FSSEM algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiRegression(Xs, Ys, Sk, gamma, n, p, k, trans = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiRegression_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices. eQTL matrix can be matrix/list of multiple conditions</p>
</td></tr>
<tr><td><code id="multiRegression_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="multiRegression_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="multiRegression_+3A_gamma">gamma</code></td>
<td>
<p>Hyperparameter for ridge regression</p>
</td></tr>
<tr><td><code id="multiRegression_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="multiRegression_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="multiRegression_+3A_k">k</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
<tr><td><code id="multiRegression_+3A_trans">trans</code></td>
<td>
<p>if rows for sample, trans = TRUE, otherwise, trans = FALSE. Default FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fit List of SEM model
</p>

<dl>
<dt>Bs</dt><dd><p> coefficient matrices of gene regulatory networks</p>
</dd>
<dt>fs</dt><dd><p> eQTL's coefficients w.r.t each gene</p>
</dd>
<dt>Fs</dt><dd><p> coefficient matrices of eQTL-gene effect</p>
</dd>
<dt>mu</dt><dd><p> Bias vector</p>
</dd>
<dt>sigma2</dt><dd><p> estimate of covariance in SEM</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>seed = 1234
N = 100                                           # sample size
Ng = 5                                            # gene number
Nk = 5 * 3                                        # eQTL number
Ns = 1                                            # sparse ratio
sigma2 = 0.01                                     # sigma2
set.seed(seed)
data = randomFSSEMdata(n = N, p = Ng, k = Nk, sparse = Ns, df = 0.3, sigma2 = sigma2,
                       u = 5, type = "DG", nhub = 1, dag = TRUE)
## If we assume that different condition has different genetics perturbations (eQTLs)
## data$Data$X = list(data$Data$X, data$Data$X)
gamma = cv.multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, ngamma = 20, nfold = 5,
                           N, Ng, Nk)
fit   = multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, gamma, N, Ng, Nk,
                      trans = FALSE)
</code></pre>

<hr>
<h2 id='obj.multiRegression'>obj.multiRegression</h2><span id='topic+obj.multiRegression'></span>

<h3>Description</h3>

<p>obj.multiRegression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obj.multiRegression(Xs, Ys, fit, trans = F)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="obj.multiRegression_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="obj.multiRegression_+3A_ys">Ys</code></td>
<td>
<p>gene expression matrices</p>
</td></tr>
<tr><td><code id="obj.multiRegression_+3A_fit">fit</code></td>
<td>
<p>regression fit result object</p>
</td></tr>
<tr><td><code id="obj.multiRegression_+3A_trans">trans</code></td>
<td>
<p>if rows for sample, trans = TRUE, otherwise, trans = FALSE. Default FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>error squared norm of ||(I-B)Y - FX||_2^2
</p>

<hr>
<h2 id='opt.multiFSSEMiPALM'>opt.multiFSSEMiPALM</h2><span id='topic+opt.multiFSSEMiPALM'></span>

<h3>Description</h3>

<p>optimize multiFSSEMiPALM's parameters by minimize BIC,
when feature size is large (&gt; 300), BIC methods will be much faster than Cross-validation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opt.multiFSSEMiPALM(
  Xs,
  Ys,
  Bs,
  Fs,
  Sk,
  sigma2,
  nlambda = 20,
  nrho = 20,
  p,
  q,
  wt = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="opt.multiFSSEMiPALM_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM_+3A_nlambda">nlambda</code></td>
<td>
<p>number of hyper-parameter of lasso term in CV</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM_+3A_nrho">nrho</code></td>
<td>
<p>number of hyper-parameter of fused-lasso term in CV</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM_+3A_q">q</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM_+3A_wt">wt</code></td>
<td>
<p>use adaptive lasso or not. Default TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of model selection result
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seed = 1234
N = 100                                           # sample size
Ng = 5                                            # gene number
Nk = 5 * 3                                        # eQTL number
Ns = 1                                            # sparse ratio
sigma2 = 0.01                                     # sigma2
set.seed(seed)
library(fssemR)
data = randomFSSEMdata(n = N, p = Ng, k = Nk, sparse = Ns, df = 0.3, sigma2 = sigma2,
                       u = 5, type = "DG", nhub = 1, dag = TRUE)
## If we assume that different condition has different genetics perturbations (eQTLs)
## data$Data$X = list(data$Data$X, data$Data$X)
## gamma = cv.multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, ngamma = 20, nfold = 5,
##                            N, Ng, Nk)
gamma = 0.6784248     ## optimal gamma computed by cv.multiRegression
fit   = multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, gamma, N, Ng, Nk,
                      trans = FALSE)
Xs    = data$Data$X
Ys    = data$Data$Y
Sk    = data$Data$Sk

fitm &lt;- opt.multiFSSEMiPALM(Xs = Xs, Ys = Ys, Bs = fit$Bs, Fs = fit$Fs, Sk = Sk,
                           sigma2 = fit$sigma2, nlambda = 10, nrho = 10,
                           p = Ng, q = Nk, wt = TRUE)

fitc0 &lt;- fitm$fit

(TPR(fitc0$Bs[[1]], data$Vars$B[[1]]) + TPR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
(FDR(fitc0$Bs[[1]], data$Vars$B[[1]]) + FDR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
TPR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
FDR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
</code></pre>

<hr>
<h2 id='opt.multiFSSEMiPALM2'>opt.multiFSSEMiPALM2</h2><span id='topic+opt.multiFSSEMiPALM2'></span>

<h3>Description</h3>

<p>optimize multiFSSEMiPALM's parameters by minimize BIC,
when feature size is large (&gt; 300), BIC methods will be much faster than Cross-validation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opt.multiFSSEMiPALM2(
  Xs,
  Ys,
  Bs,
  Fs,
  Sk,
  sigma2,
  nlambda = 20,
  nrho = 20,
  p,
  q,
  wt = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_nlambda">nlambda</code></td>
<td>
<p>number of hyper-parameter of lasso term in CV</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_nrho">nrho</code></td>
<td>
<p>number of hyper-parameter of fused-lasso term in CV</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_q">q</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
<tr><td><code id="opt.multiFSSEMiPALM2_+3A_wt">wt</code></td>
<td>
<p>use adaptive lasso or not. Default TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of model selection result
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seed = 1234
N = 100                                           # sample size
Ng = 5                                            # gene number
Nk = 5 * 3                                        # eQTL number
Ns = 1                                            # sparse ratio
sigma2 = 0.01                                     # sigma2
set.seed(seed)
library(fssemR)
data = randomFSSEMdata(n = N, p = Ng, k = Nk, sparse = Ns, df = 0.3, sigma2 = sigma2,
                       u = 5, type = "DG", nhub = 1, dag = TRUE)
## If we assume that different condition has different genetics perturbations (eQTLs)
data$Data$X = list(data$Data$X, data$Data$X)
## gamma = cv.multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, ngamma = 20, nfold = 5,
##                            N, Ng, Nk)
gamma = 0.6784248     ## optimal gamma computed by cv.multiRegression
fit   = multiRegression(data$Data$X, data$Data$Y, data$Data$Sk, gamma, N, Ng, Nk,
                      trans = FALSE)
Xs    = data$Data$X
Ys    = data$Data$Y
Sk    = data$Data$Sk

fitm &lt;- opt.multiFSSEMiPALM2(Xs = Xs, Ys = Ys, Bs = fit$Bs, Fs = fit$Fs, Sk = Sk,
                           sigma2 = fit$sigma2, nlambda = 10, nrho = 10,
                           p = Ng, q = Nk, wt = TRUE)

fitc0 &lt;- fitm$fit

(TPR(fitc0$Bs[[1]], data$Vars$B[[1]]) + TPR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
(FDR(fitc0$Bs[[1]], data$Vars$B[[1]]) + FDR(fitc0$Bs[[2]], data$Vars$B[[2]])) / 2
TPR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
FDR(fitc0$Bs[[1]] - fitc0$Bs[[2]], data$Vars$B[[1]] - data$Vars$B[[2]])
</code></pre>

<hr>
<h2 id='opt.multiNFSSEMiPALM2'>opt.multiNFSSEMiPALM2</h2><span id='topic+opt.multiNFSSEMiPALM2'></span>

<h3>Description</h3>

<p>optimize multiNFSSEMiPALM's parameters by minimize BIC,
when feature size is large (&gt; 300), BIC methods will be much faster than Cross-validation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opt.multiNFSSEMiPALM2(
  Xs,
  Ys,
  Bs,
  Fs,
  Sk,
  sigma2,
  nlambda = 20,
  nrho = 20,
  p,
  q,
  wt = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_ys">Ys</code></td>
<td>
<p>Gene expression matrices</p>
</td></tr>
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_bs">Bs</code></td>
<td>
<p>initialized GRN-matrices</p>
</td></tr>
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_fs">Fs</code></td>
<td>
<p>initialized eQTL effect matrices</p>
</td></tr>
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_sk">Sk</code></td>
<td>
<p>eQTL index of genes</p>
</td></tr>
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_sigma2">sigma2</code></td>
<td>
<p>initialized noise variance</p>
</td></tr>
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_nlambda">nlambda</code></td>
<td>
<p>number of hyper-parameter of lasso term in CV</p>
</td></tr>
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_nrho">nrho</code></td>
<td>
<p>number of hyper-parameter of fused-lasso term in CV</p>
</td></tr>
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_q">q</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
<tr><td><code id="opt.multiNFSSEMiPALM2_+3A_wt">wt</code></td>
<td>
<p>use adaptive lasso or not. Default TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of model selection result
</p>

<hr>
<h2 id='pninvB'>pninvB</h2><span id='topic+pninvB'></span>

<h3>Description</h3>

<p>inversed column l2 norm for perturbed group lasso penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pninvB(Bs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pninvB_+3A_bs">Bs</code></td>
<td>
<p>list of network matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>inversed l2 norm of B2 - B1
</p>

<hr>
<h2 id='pnoneB'>pnoneB</h2><span id='topic+pnoneB'></span>

<h3>Description</h3>

<p>if you do not want adaptive group lasso penalty, pnoneB replace pninvB
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pnoneB(Bs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pnoneB_+3A_bs">Bs</code></td>
<td>
<p>list of network matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>inversed l2 norm of B2 - B1 with all entries is 1
</p>

<hr>
<h2 id='proc.centerFSSEM'>proc.centerFSSEM</h2><span id='topic+proc.centerFSSEM'></span>

<h3>Description</h3>

<p>proc.centerFSSEM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proc.centerFSSEM(Xs, Ys)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="proc.centerFSSEM_+3A_xs">Xs</code></td>
<td>
<p>eQTL matrices</p>
</td></tr>
<tr><td><code id="proc.centerFSSEM_+3A_ys">Ys</code></td>
<td>
<p>list of gene expression matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>centered Xs and Ys and mean vectors
</p>

<hr>
<h2 id='proc.centerFSSEM2'>proc.centerFSSEM2</h2><span id='topic+proc.centerFSSEM2'></span>

<h3>Description</h3>

<p>proc.centerFSSEM2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proc.centerFSSEM2(Xs, Ys)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="proc.centerFSSEM2_+3A_xs">Xs</code></td>
<td>
<p>list of eQTL matrices</p>
</td></tr>
<tr><td><code id="proc.centerFSSEM2_+3A_ys">Ys</code></td>
<td>
<p>list of gene expression matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>centered Xs and Ys and mean vectors
</p>

<hr>
<h2 id='randomFSSEMdata'>randomFSSEMdata</h2><span id='topic+randomFSSEMdata'></span>

<h3>Description</h3>

<p>randomFSSEMdata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomFSSEMdata(
  n,
  p,
  k,
  sparse = 0.1,
  df = 0.2,
  sigma2 = 0.01,
  u = 5,
  type = c("DG", "ER"),
  dag = TRUE,
  coef = c(0.2, 0.4),
  nhub = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randomFSSEMdata_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="randomFSSEMdata_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="randomFSSEMdata_+3A_k">k</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
<tr><td><code id="randomFSSEMdata_+3A_sparse">sparse</code></td>
<td>
<p>ratio of edges / gene_number</p>
</td></tr>
<tr><td><code id="randomFSSEMdata_+3A_df">df</code></td>
<td>
<p>ratio of differential edges among two network</p>
</td></tr>
<tr><td><code id="randomFSSEMdata_+3A_sigma2">sigma2</code></td>
<td>
<p>noise variance of error</p>
</td></tr>
<tr><td><code id="randomFSSEMdata_+3A_u">u</code></td>
<td>
<p>variance of bias in SEM model.</p>
</td></tr>
<tr><td><code id="randomFSSEMdata_+3A_type">type</code></td>
<td>
<p>type of generated network, can be selected as DG, ER, Scale-free network</p>
</td></tr>
<tr><td><code id="randomFSSEMdata_+3A_dag">dag</code></td>
<td>
<p>network is directed-acyclic or not. Default TRUE</p>
</td></tr>
<tr><td><code id="randomFSSEMdata_+3A_coef">coef</code></td>
<td>
<p>Range of absolute value of coefficients in simulated network matrices. Default (0.2, 0.4), or (0.5, 1)</p>
</td></tr>
<tr><td><code id="randomFSSEMdata_+3A_nhub">nhub</code></td>
<td>
<p>If you select to generate ER network, nhub is the number of pre-defined hub node number. Default 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of generated data
</p>

<dl>
<dt>Data</dt><dd><p> List of observed, Xs, Ys, Sk </p>
</dd>
<dt>Vars</dt><dd><p> List of model, Bs, Fs, mu, n, p, k </p>
</dd>
</dl>


<hr>
<h2 id='randomFSSEMdata2'>randomFSSEMdata2</h2><span id='topic+randomFSSEMdata2'></span>

<h3>Description</h3>

<p>randomFSSEMdata2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomFSSEMdata2(
  n,
  p,
  k,
  sparse = 0.1,
  df = 0.2,
  sigma2 = 0.01,
  u = 5,
  type = c("DG", "ER"),
  dag = TRUE,
  coef = c(0.2, 0.4),
  nhub = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randomFSSEMdata2_+3A_n">n</code></td>
<td>
<p>number of observations. Vector for unbalance observations</p>
</td></tr>
<tr><td><code id="randomFSSEMdata2_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="randomFSSEMdata2_+3A_k">k</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
<tr><td><code id="randomFSSEMdata2_+3A_sparse">sparse</code></td>
<td>
<p>ratio of edges / gene_number</p>
</td></tr>
<tr><td><code id="randomFSSEMdata2_+3A_df">df</code></td>
<td>
<p>ratio of differential edges among two network</p>
</td></tr>
<tr><td><code id="randomFSSEMdata2_+3A_sigma2">sigma2</code></td>
<td>
<p>noise variance of error</p>
</td></tr>
<tr><td><code id="randomFSSEMdata2_+3A_u">u</code></td>
<td>
<p>variance of bias in SEM model.</p>
</td></tr>
<tr><td><code id="randomFSSEMdata2_+3A_type">type</code></td>
<td>
<p>type of generated network, can be selected as DG, ER, Scale-free network</p>
</td></tr>
<tr><td><code id="randomFSSEMdata2_+3A_dag">dag</code></td>
<td>
<p>network is directed-acyclic or not. Default TRUE</p>
</td></tr>
<tr><td><code id="randomFSSEMdata2_+3A_coef">coef</code></td>
<td>
<p>Range of absolute value of coefficients in simulated network matrices. Default (0.2, 0.4), or (0.5, 1)</p>
</td></tr>
<tr><td><code id="randomFSSEMdata2_+3A_nhub">nhub</code></td>
<td>
<p>If you select to generate ER network, nhub is the number of pre-defined hub node number. Default 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of generated data
</p>

<dl>
<dt>Data</dt><dd><p> List of observed, Xs, Ys, Sk </p>
</dd>
<dt>Vars</dt><dd><p> List of model, Bs, Fs, mu, n, p, k </p>
</dd>
</dl>


<hr>
<h2 id='randomFSSEMdata4Cor'>randomFSSEMdata4Cor</h2><span id='topic+randomFSSEMdata4Cor'></span>

<h3>Description</h3>

<p>randomFSSEMdata4Cor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomFSSEMdata4Cor(
  n,
  p,
  k,
  sparse = 0.1,
  df = 0.2,
  sigma2 = 0.01,
  u = 5,
  type = c("DG", "ER"),
  dag = TRUE,
  coef = c(0.2, 0.4),
  nhub = 2,
  r = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randomFSSEMdata4Cor_+3A_n">n</code></td>
<td>
<p>number of observations. Vector for unbalance observations</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_p">p</code></td>
<td>
<p>number of genes</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_k">k</code></td>
<td>
<p>number of eQTLs</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_sparse">sparse</code></td>
<td>
<p>ratio of edges / gene_number</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_df">df</code></td>
<td>
<p>ratio of differential edges among two network</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_sigma2">sigma2</code></td>
<td>
<p>noise variance of error</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_u">u</code></td>
<td>
<p>variance of bias in SEM model.</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_type">type</code></td>
<td>
<p>type of generated network, can be selected as DG, ER, Scale-free network</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_dag">dag</code></td>
<td>
<p>network is directed-acyclic or not. Default TRUE</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_coef">coef</code></td>
<td>
<p>Range of absolute value of coefficients in simulated network matrices. Default (0.2, 0.4), or (0.5, 1)</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_nhub">nhub</code></td>
<td>
<p>If you select to generate ER network, nhub is the number of pre-defined hub node number. Default 2</p>
</td></tr>
<tr><td><code id="randomFSSEMdata4Cor_+3A_r">r</code></td>
<td>
<p>correlation between different observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of generated data
</p>

<dl>
<dt>Data</dt><dd><p> List of observed, Xs, Ys, Sk </p>
</dd>
<dt>Vars</dt><dd><p> List of model, Bs, Fs, mu, n, p, k </p>
</dd>
</dl>


<hr>
<h2 id='TPR'>TPR</h2><span id='topic+TPR'></span>

<h3>Description</h3>

<p>Power of detection for network prediction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TPR(X, B, PREC = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TPR_+3A_x">X</code></td>
<td>
<p>list of predicted network matrices</p>
</td></tr>
<tr><td><code id="TPR_+3A_b">B</code></td>
<td>
<p>list of true network matrices</p>
</td></tr>
<tr><td><code id="TPR_+3A_prec">PREC</code></td>
<td>
<p>precision threshold for FDR test. Default 0.</p>
</td></tr>
</table>

<hr>
<h2 id='transx'>transx</h2><span id='topic+transx'></span>

<h3>Description</h3>

<p>transx
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transx(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transx_+3A_data">data</code></td>
<td>
<p>Collecting data structure generated by randomFSSEMdata function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>transformed list of eQTL matrices
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
