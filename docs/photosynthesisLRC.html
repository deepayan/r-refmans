<!DOCTYPE html><html lang="en"><head><title>Help for package photosynthesisLRC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {photosynthesisLRC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eq1'><p>Calculate Photosynthetic Rates Using a Nonlinear Model EQ1</p></a></li>
<li><a href='#eq11'><p>Calculate Photosynthetic Rates Using a Nonlinear Model EQ11</p></a></li>
<li><a href='#eq2'><p>Calculate Photosynthetic Rates Using a Nonlinear Model EQ2</p></a></li>
<li><a href='#eq3'><p>Calculate Photosynthetic Rates Using a Nonlinear Model EQ3</p></a></li>
<li><a href='#eq4'><p>Calculate Photosynthetic Rates Using a Nonlinear Model EQ4</p></a></li>
<li><a href='#eq5'><p>Calculate Photosynthetic Rates Using a Nonlinear Model EQ5</p></a></li>
<li><a href='#eq6'><p>Calculate Photosynthetic Rates Using a Nonlinear Model EQ6</p></a></li>
<li><a href='#eq8'><p>Calculate Photosynthetic Rates Using a Nonlinear Model EQ8</p></a></li>
<li><a href='#eq9'><p>Calculate Photosynthetic Rates Using a Nonlinear Model EQ9</p></a></li>
<li><a href='#nls_results'><p>Array of Results from all NLS Models eq1-eq11</p></a></li>
<li><a href='#plot_eq'><p>Plot Photosynthetic Models</p></a></li>
<li><a href='#sunflowers'><p>Light Response Curves from a Common Garden Experiment in <em>Helianthus</em></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Nonlinear Least Squares Models for Photosynthetic Light Response</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for modeling, comparing, and visualizing photosynthetic light response curves using established mechanistic and empirical models like the rectangular hyperbola Michaelis-Menton based models ((eq1 (Baly (1935) &lt;<a href="https://doi.org/10.1098%2Frspb.1935.0026">doi:10.1098/rspb.1935.0026</a>&gt;)) (eq2 (Kaipiainenn (2009) &lt;<a href="https://doi.org/10.1134%2FS1021443709040025">doi:10.1134/S1021443709040025</a>&gt;)) (eq3 (Smith (1936) &lt;<a href="https://doi.org/10.1073%2Fpnas.22.8.504">doi:10.1073/pnas.22.8.504</a>&gt;))), hyperbolic tangent based models ((eq4 (Jassby &amp; Platt (1976) &lt;<a href="https://doi.org/10.4319%2FLO.1976.21.4.0540">doi:10.4319/LO.1976.21.4.0540</a>&gt;)) (eq5 (Abe et al. (2009) &lt;<a href="https://doi.org/10.1111%2Fj.1444-2906.2008.01619.x">doi:10.1111/j.1444-2906.2008.01619.x</a>&gt;))), the non-rectangular hyperbola model (eq6 (Prioul &amp; Chartier (1977) &lt;<a href="https://doi.org/10.1093%2Foxfordjournals.aob.a085354">doi:10.1093/oxfordjournals.aob.a085354</a>&gt;)), exponential based models ((eq8 (Webb et al. (1974) &lt;<a href="https://doi.org/10.1007%2FBF00345747">doi:10.1007/BF00345747</a>&gt;)), (eq9 (Prado &amp; de Moraes (1997) &lt;<a href="https://doi.org/10.1007%2FBF02982542">doi:10.1007/BF02982542</a>&gt;))), and finally the Ye model (eq11 (Ye (2007) &lt;<a href="https://doi.org/10.1007%2Fs11099-007-0110-5">doi:10.1007/s11099-007-0110-5</a>&gt;)). Each of these nonlinear least squares models are commonly used to express photosynthetic response under changing light conditions and has been well supported in the literature, but distinctions in each mathematical model represent moderately different assumptions about physiology and trait relationships which ultimately produce different calculated functional trait values. These models were all thoughtfully discussed and curated by Lobo et al. (2013) &lt;<a href="https://doi.org/10.1007%2Fs11099-013-0045-y">doi:10.1007/s11099-013-0045-y</a>&gt; to express the importance of selecting an appropriate model for analysis, and methods were established in Davis et al. (in review) to evaluate the impact of analytical choice in phylogenetic analysis of the function-valued traits. Gas exchange data on 28 wild sunflower species from Davis et al.are included as an example data set here. </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rebekah Davis &lt;rebekah.davis.evoecophys@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2), dplyr (&ge; 1.1.4), tidyr (&ge; 1.3.1), stats (&ge;
4.2.3), graphics (&ge; 4.2.3)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/heliotropichuman/photosynthesisLRC">https://github.com/heliotropichuman/photosynthesisLRC</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-24 19:54:01 UTC; rebek</td>
</tr>
<tr>
<td>Author:</td>
<td>Rebekah Davis [aut, cre],
  Eric Goolsby [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-25 17:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='eq1'>Calculate Photosynthetic Rates Using a Nonlinear Model EQ1</h2><span id='topic+eq1'></span>

<h3>Description</h3>

<p>Uses the nonlinear least squares Michaelis-Menton model equation 1 from Lobo et. al (2013) to transform measured photosynthetic data into a smoothed function-valued trait with the following function:
A~((phi_I0)(PARi)(Pgmax))/(phi_I0*PARi+Pgmax))-Rd
The function will return predicted values, calculated quantities, or both.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eq1(pars = c(Pgmax = 19.5,phi_I0 = .0899,Rd = 1.8),
     data,
     PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
     return = c("predict","calc","all")[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eq1_+3A_pars">pars</code></td>
<td>
<p>A named vector of parameters. Default values are Pgmax = 19.5, phi_I0 = 0.0899, and Rd = 1.8. These serve as initial starting parameters for the function to rapidly assess your data through an iterative process. These values may be changed to fall within the minimum and maximum parameter values of your study system.</p>
</td></tr>
<tr><td><code id="eq1_+3A_data">data</code></td>
<td>
<p>A data frame containing the experimental data with at least two columns: 'PARi' for the incident light and 'A' for the measured photosynthetic rate.</p>
</td></tr>
<tr><td><code id="eq1_+3A_pari">PARi</code></td>
<td>
<p>A numeric vector of incident light values. Defaults to a sequence from 0 to 2500.</p>
</td></tr>
<tr><td><code id="eq1_+3A_return">return</code></td>
<td>
<p>Character string indicating what the function should return. Options are &quot;predict&quot; for predicted values, &quot;calc&quot; for calculated quantities, and &quot;all&quot; for both. Defaults to &quot;predict&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the provided data to estimate the parameters Pgmax, phi_I0, and Rd by minimizing the squared differences between observed and predicted photosynthetic rates. The model is then used to calculate a range of derived functional trait quantities such as the dark respiration rate (Rd), light compensation point (Icomp), maximum photosynthetic rate (Pmax), and curve derived parameters (Ix) among other calculated quantities.
</p>


<h3>Value</h3>

<p>Depending on the 'return' argument, the function returns:
</p>

<ul>
<li> <p><code>"predict"</code>: A numeric vector of predicted photosynthetic rates.
</p>
</li>
<li> <p><code>"calc"</code>: A named vector of calculated quantities:
Pgmax,
Pmax,
Icomp,
phi_I0 (quantum yield calculated at I0),
phi_Icomp (quantum yield calculated at Icomp),
phi_I0_Icomp (quantum yield calculated by the range
of values between I0 and Icomp),
phi_Icomp_I200 (quantum yield calculated by the
range between Icomp and I200),
Rd (dark respiration),
Imax (Imax calculated),
Imax_obs (Imax observed),
P_Imax (assimilation value at maximum light),
Isat_x, x = .25, .50, .75, .85, .90, .95 (light
saturation at x percent of Pmax),
Ix, x = .25, .50, .75, .85, .90, .95 (light
intensity at x percent of Pmax)
</p>
</li>
<li> <p><code>"all"</code>: A list containing both the predicted values, calculated quantities, and model fit statistics.
</p>
</li></ul>



<h3>References</h3>

<div class="sourceCode"><pre>Lobo, F. de A., M. P. de Barros, H. J. Dalmagro,  .C. Dalmolin, W. E. Pereira, É.C. de Souza, G. L. Vourlitis and C. E. Rodriguez Ortiz 2013 Fitting net photosynthetic light-response curves with Microsoft Excel – a critical look at the models. Photosynthetica 51 (3): 445-456.

Baly, E.C.C. 1935 The kinetics of photosynthesis. Proc. R. Soc. Lond. B. 117: 218-239.

Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of photosynthetic light response curve: approaches and pitfalls in phylogenetic modeling of a function-valued trait. IJPS, in review
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example dataset
    example_data &lt;- data.frame(
      PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
      A = c(1.8, 4.2, 7.5, 12.8, 16.2, 18.5, 19.3, 19.4, 19.5)
    )

    # Predict photosynthetic rates given the parameters
    predicted_values &lt;- eq1(pars = c(Pgmax = 20, phi_I0 = 0.09, Rd = 2),
                       PARi = c(0, 100, 200, 400, 800), return = "predict")
    print(predicted_values)

    # Use experimental data to predict photosynthetic rates and estimate
    # linear parameters
    result &lt;- eq1(data = example_data, return = "all")
    print(result$calc)  # View calculated quantities
    print(result$fit)   # View fit statistics and optimized parameters

    # Get calculated quantities directly
    calculated_quantities &lt;- eq1(data = example_data, return = "calc")
    print(calculated_quantities)

</code></pre>

<hr>
<h2 id='eq11'>Calculate Photosynthetic Rates Using a Nonlinear Model EQ11</h2><span id='topic+eq11'></span>

<h3>Description</h3>

<p>Uses the nonlinear least squares Ye model equation 11 from Lobo et. al (2013) to transform measured photosynthetic data into a smoothed function-valued trait with the following function:
A~phi_I0_Icomp((1-beta(PARi))/(1+gamma(PARi)))(PARi-Icomp)
The function will return predicted values, calculated quantities, or both.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eq11(pars = c(phi_I0_Icomp = .0756, beta = .0000432, gamma = .0039, Icomp = 22.6),
     data,
     PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
     return = c("predict","calc","all")[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eq11_+3A_pars">pars</code></td>
<td>
<p>A named vector of parameters. Default values are phi_I0_Icomp = .0756, beta = .0000432, gamma = .0039, Icomp = 22.6. These serve as initial starting parameters for the function to rapidly assess your data through an iterative process. The empirical values beta and gamma range between 0 and 1, and are not explicitly described by Ye (2007) but are independent coefficients of I implemented to incorporate a more dynamic response to light. All of these values may be changed to fall within the minimum and maximum parameter values of your study system.</p>
</td></tr>
<tr><td><code id="eq11_+3A_data">data</code></td>
<td>
<p>A data frame containing the experimental data with at least two columns: 'PARi' for the incident light and 'A' for the photosynthetic rate.</p>
</td></tr>
<tr><td><code id="eq11_+3A_pari">PARi</code></td>
<td>
<p>A numeric vector of incident light values. Defaults to a sequence from 0 to 2500.</p>
</td></tr>
<tr><td><code id="eq11_+3A_return">return</code></td>
<td>
<p>Character string indicating what the function should return. Options are &quot;predict&quot; for predicted values, &quot;calc&quot; for calculated quantities, and &quot;all&quot; for both. Defaults to &quot;predict&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the provided data to estimate the parameters phi_I0_Icomp, Icomp, and empirical parameters beta and gamma by minimizing the squared differences between observed and predicted photosynthetic rates. The model is then used to calculate a range of derived functional trait quantities such as the dark respiration rate (Rd), light compensation point (Icomp), maximum photosynthetic rate (Pmax), and curve derived parameters (Ix) among other calculated quantities.
</p>


<h3>Value</h3>

<p>Depending on the 'return' argument, the function returns:
</p>

<ul>
<li> <p><code>"predict"</code>: A numeric vector of predicted photosynthetic rates.
</p>
</li>
<li> <p><code>"calc"</code>: A named vector of calculated quantities:
Pgmax,
Pmax,
Icomp,
phi_I0 (quantum yield calculated at I0),
phi_Icomp (quantum yield calculated at Icomp),
phi_I0_Icomp (quantum yield calculated by the range of values between I0 and Icomp),
phi_Icomp_I200 (quantum yield calculated by the range between Icomp and I200),
Rd (dark respiration),
Imax (Imax calculated),
Imax_obs (Imax observed),
P_Imax (assimilation value at maximum light),
Isat_x, x = .25, .50, .75, .85, .90, .95 (light saturation at x percent of Pmax),
Ix, x = .25, .50, .75, .85, .90, .95 (light intensity at x percent of Pmax)
</p>
</li>
<li> <p><code>"all"</code>: A list containing both the predicted values, calculated quantities, and model fit statistics.
</p>
</li></ul>



<h3>References</h3>

<div class="sourceCode"><pre>Lobo, F. de A., M. P. de Barros, H. J. Dalmagro,  .C. Dalmolin, W. E. Pereira, É.C. de Souza, G. L. Vourlitis and C. E. Rodriguez Ortiz 2013 Fitting net photosynthetic light-response curves with Microsoft Excel – a critical look at the models. Photosynthetica 51 (3): 445-456.

Ye, Z.-P. 2007 A new model for relationship between irradiance and the rate of photosynthesis in *Oryza sativa*. Photosynthetica 45: 637-640.

Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of photosynthetic light response curve: approaches and pitfalls in phylogenetic modeling of a function-valued trait. IJPS, in review
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example dataset
    data(sunflowers)
    example_data &lt;- sunflowers |&gt; filter(SampleID==SampleID[1])
    # Predict photosynthetic rates given the parameters
    predicted_values &lt;- eq11(return = "predict")
    print(predicted_values)

    # Use experimental data to predict photosynthetic rates and estimate linear parameters
    result &lt;- eq11(data = example_data, return = "all")
    print(result$calc)  # View calculated quantities
    print(result$fit)   # View fit statistics and optimized parameters

    # Get calculated quantities directly
    calculated_quantities &lt;- eq11(data = example_data, return = "calc")
    print(calculated_quantities)

</code></pre>

<hr>
<h2 id='eq2'>Calculate Photosynthetic Rates Using a Nonlinear Model EQ2</h2><span id='topic+eq2'></span>

<h3>Description</h3>

<p>Uses the nonlinear least squares Michaelis-Menton model equation 2 from Lobo et. al (2013) to transform measured photosynthetic data into a smoothed function-valued trait with the following function:
A~((Pgmax*PARi)/(PARi+I50))-Rd
The function will return predicted values, calculated quantities, or both.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eq2(pars = c(Pgmax = 19.5,I50 = 216.4,Rd = 1.8),
    data,
    PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
    return = c("predict","calc","all")[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eq2_+3A_pars">pars</code></td>
<td>
<p>A named vector of parameters. Default values are Pgmax = 19.5,I50 = 216.4, and Rd = 1.8. These serve as initial starting parameters for the function to rapidly assess your data through an iterative process. These values may be changed to fall within the minimum and maximum parameter values of your study system.</p>
</td></tr>
<tr><td><code id="eq2_+3A_data">data</code></td>
<td>
<p>A data frame containing the experimental data with at least two columns: 'PARi' for the incident light and 'A' for the photosynthetic rate.</p>
</td></tr>
<tr><td><code id="eq2_+3A_pari">PARi</code></td>
<td>
<p>A numeric vector of incident light values. Defaults to a sequence from 0 to 2500.</p>
</td></tr>
<tr><td><code id="eq2_+3A_return">return</code></td>
<td>
<p>Character string indicating what the function should return. Options are &quot;predict&quot; for predicted values, &quot;calc&quot; for calculated quantities, and &quot;all&quot; for both. Defaults to &quot;predict&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the provided data to estimate the parameters Pgmax, assimilation at half the maximum assimilation rate (I50), and Rd by minimizing the squared differences between observed and predicted photosynthetic rates. The model is then used to calculate a range of derived functional trait quantities such as the dark respiration rate (Rd), light compensation point (Icomp), maximum photosynthetic rate (Pmax), and curve derived parameters (Ix) among other calculated quantities.
</p>


<h3>Value</h3>

<p>Depending on the 'return' argument, the function returns:
</p>

<ul>
<li> <p><code>"predict"</code>: A numeric vector of predicted photosynthetic rates.
</p>
</li>
<li> <p><code>"calc"</code>: A named vector of calculated quantities:
Pgmax,
Pmax,
Icomp,
phi_I0 (quantum yield calculated at I0),
phi_Icomp (quantum yield calculated at Icomp),
phi_I0_Icomp (quantum yield calculated by the range of values between I0 and Icomp),
phi_Icomp_I200 (quantum yield calculated by the range between Icomp and I200),
Rd (dark respiration),
Imax (Imax calculated),
Imax_obs (Imax observed),
P_Imax (assimilation value at maximum light),
Isat_x, x = .25, .50, .75, .85, .90, .95 (light saturation at x percent of Pmax),
Ix, x = .25, .50, .75, .85, .90, .95 (light intensity at x percent of Pmax)
</p>
</li>
<li> <p><code>"all"</code>: A list containing both the predicted values, calculated quantities, and model fit statistics.
</p>
</li></ul>



<h3>References</h3>

<div class="sourceCode"><pre>Lobo, F. de A., M. P. de Barros, H. J. Dalmagro,  .C. Dalmolin, W. E. Pereira, É.C. de Souza, G. L. Vourlitis and C. E. Rodriguez Ortiz 2013 Fitting net photosynthetic light-response curves with Microsoft Excel – a critical look at the models. Photosynthetica 51 (3): 445-456.

Kaipiainen, E.L. 2009 Parameters of photosynthesis light curve in *Salix dasyclados* and their changes during the growth season. Russ. J. Plant Physiol. 56: 445-453

Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of photosynthetic light response curve: approaches and pitfalls in phylogenetic modeling of a function-valued trait. IJPS, in review
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'># Example dataset
    example_data &lt;- data.frame(
      PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
      A = c(1.8, 4.2, 7.5, 12.8, 16.2, 18.5, 19.3, 19.4, 19.5)
    )

    # Predict photosynthetic rates given the parameters
    predicted_values &lt;- eq2(pars = c(Pgmax = 20, I50 = 216.4, Rd = 2),
                       PARi = c(0, 100, 200, 400, 800), return = "predict")
    print(predicted_values)

    # Use experimental data to predict photosynthetic rates and estimate
    # linear parameters
    result &lt;- eq2(data = example_data, return = "all")
    print(result$calc)  # View calculated quantities
    print(result$fit)   # View fit statistics and optimized parameters

    # Get calculated quantities directly
    calculated_quantities &lt;- eq2(data = example_data, return = "calc")
    print(calculated_quantities)

</code></pre>

<hr>
<h2 id='eq3'>Calculate Photosynthetic Rates Using a Nonlinear Model EQ3</h2><span id='topic+eq3'></span>

<h3>Description</h3>

<p>Uses the nonlinear least squares Michaelis-Menton model equation 3 from Lobo et. al (2013) to transform measured photosynthetic data into a smoothed function-valued trait with the following function:
A~((phi_I0)(PARi)(Pgmax))/(((Pgmax^2)+(phi_I0^2)*(PARi^2))^0.5)-Rd
The function will return predicted values, calculated quantities, or both.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eq3(pars = c(Pgmax = 19.5,phi_I0 = .0493,Rd = 1.8),
    data,
    PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
    return = c("predict","calc","all")[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eq3_+3A_pars">pars</code></td>
<td>
<p>A named vector of parameters. Default values are Pgmax = 19.5, phi_I0 = .0493, and Rd = 1.8. These serve as initial starting parameters for the function to rapidly assess your data through an iterative process. These values may be changed to fall within the minimum and maximum parameter values of your study system.</p>
</td></tr>
<tr><td><code id="eq3_+3A_data">data</code></td>
<td>
<p>A data frame containing the experimental data with at least two columns: 'PARi' for the incident light and 'A' for the photosynthetic rate.</p>
</td></tr>
<tr><td><code id="eq3_+3A_pari">PARi</code></td>
<td>
<p>A numeric vector of incident light values. Defaults to a sequence from 0 to 2500.</p>
</td></tr>
<tr><td><code id="eq3_+3A_return">return</code></td>
<td>
<p>Character string indicating what the function should return. Options are &quot;predict&quot; for predicted values, &quot;calc&quot; for calculated quantities, and &quot;all&quot; for both. Defaults to &quot;predict&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the provided data to estimate the parameters Pgmax, phi_I0, and Rd by minimizing the squared differences between observed and predicted photosynthetic rates. The model is then used to calculate a range of derived functional trait quantities such as the dark respiration rate (Rd), light compensation point (Icomp), maximum photosynthetic rate (Pmax), and curve derived parameters (Ix) among other calculated quantities.
</p>


<h3>Value</h3>

<p>Depending on the 'return' argument, the function returns:
</p>

<ul>
<li> <p><code>"predict"</code>: A numeric vector of predicted photosynthetic rates.
</p>
</li>
<li> <p><code>"calc"</code>: A named vector of calculated quantities:
Pgmax,
Pmax,
Icomp,
phi_I0 (quantum yield calculated at I0),
phi_Icomp (quantum yield calculated at Icomp),
phi_I0_Icomp (quantum yield calculated by the range of values between I0 and Icomp),
phi_Icomp_I200 (quantum yield calculated by the range between Icomp and I200),
Rd (dark respiration),
Imax (Imax calculated),
Imax_obs (Imax observed),
P_Imax (assimilation value at maximum light),
Isat_x, x = .25, .50, .75, .85, .90, .95 (light saturation at x percent of Pmax),
Ix, x = .25, .50, .75, .85, .90, .95 (light intensity at x percent of Pmax)
</p>
</li>
<li> <p><code>"all"</code>: A list containing both the predicted values, calculated quantities, and model fit statistics.
</p>
</li></ul>



<h3>References</h3>

<div class="sourceCode"><pre>Lobo, F. de A., M. P. de Barros, H. J. Dalmagro,  .C. Dalmolin, W. E. Pereira, É.C. de Souza, G. L. Vourlitis and C. E. Rodriguez Ortiz 2013 Fitting net photosynthetic light-response curves with Microsoft Excel – a critical look at the models. Photosynthetica 51 (3): 445-456.

Smith, E. L. 1936 Photosynthesis in relation to light and carbon dioxide. PNAS 22: 504-511.

Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of photosynthetic light response curve: approaches and pitfalls in phylogenetic modeling of a function-valued trait. IJPS, in review
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example dataset
    example_data &lt;- data.frame(
      PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
      A = c(1.8, 4.2, 7.5, 12.8, 16.2, 18.5, 19.3, 19.4, 19.5)
    )

    # Predict photosynthetic rates given the parameters
    predicted_values &lt;- eq3(pars = c(Pgmax = 20, phi_I0 = .0493, Rd = 2),
                       PARi = c(0, 100, 200, 400, 800), return = "predict")
    print(predicted_values)

    # Use experimental data to predict photosynthetic rates and estimate
    # linear parameters
    result &lt;- eq3(data = example_data, return = "all")
    print(result$calc)  # View calculated quantities
    print(result$fit)   # View fit statistics and optimized parameters

    # Get calculated quantities directly
    calculated_quantities &lt;- eq3(data = example_data, return = "calc")
    print(calculated_quantities)

</code></pre>

<hr>
<h2 id='eq4'>Calculate Photosynthetic Rates Using a Nonlinear Model EQ4</h2><span id='topic+eq4'></span>

<h3>Description</h3>

<p>Uses the nonlinear least squares hyperbolic tangent model equation 4 from Lobo et. al (2013) to transform measured photosynthetic data into a smoothed function-valued trait with the following function:
A~Pgmax*tanh((phi_I0)PARi/Pgmax)-Rd
The function will return predicted values, calculated quantities, or both.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eq4(pars = c(Pgmax = 19.5,phi_I0 = .0493,Rd = 1.8),
    data,
    PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
    return = c("predict","calc","all")[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eq4_+3A_pars">pars</code></td>
<td>
<p>A named vector of parameters. Default values are Pgmax = 19.5, phi_I0 = 0.0493, and Rd = 1.8. These serve as initial starting parameters for the function to rapidly assess your data through an iterative process. These values may be changed to fall within the minimum and maximum parameter values of your study system.</p>
</td></tr>
<tr><td><code id="eq4_+3A_data">data</code></td>
<td>
<p>A data frame containing the experimental data with at least two columns: 'PARi' for the incident light and 'A' for the photosynthetic rate.</p>
</td></tr>
<tr><td><code id="eq4_+3A_pari">PARi</code></td>
<td>
<p>A numeric vector of incident light values. Defaults to a sequence from 0 to 2500.</p>
</td></tr>
<tr><td><code id="eq4_+3A_return">return</code></td>
<td>
<p>Character string indicating what the function should return.Options are &quot;predict&quot; for predicted values, &quot;calc&quot; for calculated quantities, and &quot;all&quot; for both. Defaults to &quot;predict&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the provided data to estimate the parameters Pgmax, phi_I0, and Rd by minimizing the squared differences between observed and predicted photosynthetic rates. The model is then used to calculate a range of derived functional trait quantities such as the dark respiration rate (Rd), light compensation point (Icomp), maximum photosynthetic rate (Pmax), and curve derived parameters (Ix) among other calculated quantities.
</p>


<h3>Value</h3>

<p>Depending on the 'return' argument, the function returns:
</p>

<ul>
<li> <p><code>"predict"</code>: A numeric vector of predicted photosynthetic rates.
</p>
</li>
<li> <p><code>"calc"</code>: A named vector of calculated quantities:
Pgmax,
Pmax,
Icomp,
phi_I0 (quantum yield calculated at I0),
phi_Icomp (quantum yield calculated at Icomp),
phi_I0_Icomp (quantum yield calculated by the range of values between I0 and Icomp),
phi_Icomp_I200 (quantum yield calculated by the range between Icomp and I200),
Rd (dark respiration),
Imax (Imax calculated),
Imax_obs (Imax observed),
P_Imax (assimilation value at maximum light),
Isat_x, x = .25, .50, .75, .85, .90, .95 (light saturation at x percent of Pmax),
Ix, x = .25, .50, .75, .85, .90, .95 (light intensity at x percent of Pmax)
</p>
</li>
<li> <p><code>"all"</code>: A list containing both the predicted values, calculated quantities, and model fit statistics.
</p>
</li></ul>



<h3>References</h3>

<div class="sourceCode"><pre>Lobo, F. de A., M. P. de Barros, H. J. Dalmagro,  .C. Dalmolin, W. E. Pereira, É.C. de Souza, G. L. Vourlitis and C. E. Rodriguez Ortiz 2013 Fitting net photosynthetic light-response curves with Microsoft Excel – a critical look at the models. Photosynthetica 51 (3): 445-456.

Abe, M., K. Yokota, A. Kurashima, M. Maegawa 2009 High water temperature tolerance in photosynthetic activity of *Zostera japonica* Ascherson and Graebner seedlings from Ago Bay, Mio Prefecture, central Japan. – Fish. Sci. 75: 1117-1123

Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of photosynthetic light response curve: approaches and pitfalls in phylogenetic modeling of a function-valued trait. IJPS, in review
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example dataset
    example_data &lt;- data.frame(
      PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
      A = c(1.8, 4.2, 7.5, 12.8, 16.2, 18.5, 19.3, 19.4, 19.5)
    )

    # Predict photosynthetic rates given the parameters
    predicted_values &lt;- eq4(pars = c(Pgmax = 20, phi_I0 = 0.09, Rd = 2),
                       PARi = c(0, 100, 200, 400, 800), return = "predict")
    print(predicted_values)

    # Use experimental data to predict photosynthetic rates and estimate
    # linear parameters
    result &lt;- eq4(data = example_data, return = "all")
    print(result$calc)  # View calculated quantities
    print(result$fit)   # View fit statistics and optimized parameters

    # Get calculated quantities directly
    calculated_quantities &lt;- eq4(data = example_data, return = "calc")
    print(calculated_quantities)

</code></pre>

<hr>
<h2 id='eq5'>Calculate Photosynthetic Rates Using a Nonlinear Model EQ5</h2><span id='topic+eq5'></span>

<h3>Description</h3>

<p>Uses the nonlinear least squares hyperbolic tangent model equation 5 from Lobo et. al (2013) to transform measured photosynthetic data into a smoothed function-valued trait with the following function:
A~Pgmax*tanh(PARi/Isat)-Rd
The function will return predicted values, calculated quantities, or both.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eq5(pars = c(Pgmax = 15.5,Isat = 359.2,Rd = .9),
    data,
    PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
    return = c("predict","calc","all")[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eq5_+3A_pars">pars</code></td>
<td>
<p>A named vector of parameters. Default values are Pgmax = 15.5, Isat = 359.2, and Rd = 0.9. These serve as initial starting parameters for the function to rapidly assess your data through an iterative process. These values may be changed to fall within the minimum and maximum parameter values of your study system.</p>
</td></tr>
<tr><td><code id="eq5_+3A_data">data</code></td>
<td>
<p>A data frame containing the experimental data with at least two columns: 'PARi' for the incident light and 'A' for the photosynthetic rate.</p>
</td></tr>
<tr><td><code id="eq5_+3A_pari">PARi</code></td>
<td>
<p>A numeric vector of incident light values. Defaults to a sequence from 0 to 2500.</p>
</td></tr>
<tr><td><code id="eq5_+3A_return">return</code></td>
<td>
<p>Character string indicating what the function should return. Options are &quot;predict&quot; for predicted values, &quot;calc&quot; for calculated quantities, and &quot;all&quot; for both. Defaults to &quot;predict&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the provided data to estimate the parameters Pgmax, Isat, and Rd by minimizing the squared differences between observed and predicted photosynthetic rates. The model is then used to calculate a range of derived functional trait quantities such as the dark respiration rate (Rd), light compensation point (Icomp), maximum photosynthetic rate (Pmax), and curve derived parameters (Ix) among other calculated quantities.
</p>


<h3>Value</h3>

<p>Depending on the 'return' argument, the function returns:
</p>

<ul>
<li> <p><code>"predict"</code>: A numeric vector of predicted photosynthetic rates.
</p>
</li>
<li> <p><code>"calc"</code>: A named vector of calculated quantities:
Pgmax,
Pmax,
Icomp,
phi_I0 (quantum yield calculated at I0),
phi_Icomp (quantum yield calculated at Icomp),
phi_I0_Icomp (quantum yield calculated by the range of values between I0 and Icomp),
phi_Icomp_I200 (quantum yield calculated by the range between Icomp and I200),
Rd (dark respiration),
Imax (Imax calculated),
Imax_obs (Imax observed),
P_Imax (assimilation value at maximum light),
Isat_x, x = .25, .50, .75, .85, .90, .95 (light saturation at x percent of Pmax),
Ix, x = .25, .50, .75, .85, .90, .95 (light intensity at x percent of Pmax)
</p>
</li>
<li> <p><code>"all"</code>: A list containing both the predicted values, calculated quantities, and model fit statistics.
</p>
</li></ul>



<h3>References</h3>

<div class="sourceCode"><pre>Lobo, F. de A., M. P. de Barros, H. J. Dalmagro,  .C. Dalmolin, W. E. Pereira, É.C. de Souza, G. L. Vourlitis and C. E. Rodriguez Ortiz 2013 Fitting net photosynthetic light-response curves with Microsoft Excel – a critical look at the models. Photosynthetica 51 (3): 445-456.

Jassby, A.D. and T. Platt 1976 Mathematical formulation of the relationship between photosynthesis and light for phytoplankton. Limnol. Oceanogr. 21: 540-547.

Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of photosynthetic light response curve: approaches and pitfalls in phylogenetic modeling of a function-valued trait. IJPS, in review
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example dataset
    example_data &lt;- data.frame(
      PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
      A = c(1.8, 4.2, 7.5, 12.8, 16.2, 18.5, 19.3, 19.4, 19.5)
    )

    # Predict photosynthetic rates given the parameters
    predicted_values &lt;- eq5(pars = c(Pgmax = 15.5, Isat = 360, Rd = .9),
                       PARi = c(0, 100, 200, 400, 800), return = "predict")
    print(predicted_values)

    # Use experimental data to predict photosynthetic rates and estimate linear parameters
    result &lt;- eq5(data = example_data, return = "all")
    print(result$calc)  # View calculated quantities
    print(result$fit)   # View fit statistics and optimized parameters

    # Get calculated quantities directly
    calculated_quantities &lt;- eq5(data = example_data, return = "calc")
    print(calculated_quantities)

</code></pre>

<hr>
<h2 id='eq6'>Calculate Photosynthetic Rates Using a Nonlinear Model EQ6</h2><span id='topic+eq6'></span>

<h3>Description</h3>

<p>Uses the nonlinear least squares non-rectangular hyperbola model equation 6 from Lobo et. al (2013) to transform measured photosynthetic data into a smoothed function-valued trait with the following function:
A~((((PARi)(phi_I0)+Pgmax)-((((phi_I0)(PARi)+Pgmax)^2)- (4(phi_I0)(Pgmax)(theta)(PARi))^0.5))/(2*theta))-exp(Rd)
The function will return predicted values, calculated quantities, or both.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eq6(pars = c(Pgmax = 15.5,phi_I0 = .0493,theta = .433,Rd = .9),
    data,
    PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
    return = c("predict","calc","all")[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eq6_+3A_pars">pars</code></td>
<td>
<p>A named vector of parameters. Default values are Pgmax= 15.5, phi_I0= 0.0493, theta= 0.433, and Rd= 0.9. These serve as initial starting parameters for the function to rapidly assess your data through an iterative process. The empirical coefficient theta falls between 0 and 1, and represents the various resistances faced by CO2 as it diffuses through the leaf mesophyll and is eventually bound by carboxylation enzymes. All of these values may be changed to fall within the minimum and maximum parameter values of your study system.</p>
</td></tr>
<tr><td><code id="eq6_+3A_data">data</code></td>
<td>
<p>A data frame containing the experimental data with at least two columns: 'PARi' for the incident light and 'A' for the photosynthetic rate.</p>
</td></tr>
<tr><td><code id="eq6_+3A_pari">PARi</code></td>
<td>
<p>A numeric vector of incident light values. Defaults to a sequence from 0 to 2500.</p>
</td></tr>
<tr><td><code id="eq6_+3A_return">return</code></td>
<td>
<p>Character string indicating what the function should return. Options are &quot;predict&quot; for predicted values, &quot;calc&quot; for calculated quantities, and &quot;all&quot; for both. Defaults to &quot;predict&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the provided data to estimate the parameters Pgmax, phi_I0, and Rd by minimizing the squared differences between observed and predicted photosynthetic rates. The model is then used to calculate a range of derived functional trait quantities such as the dark respiration rate (Rd), light compensation point (Icomp), maximum photosynthetic rate (Pmax), and curve derived parameters (Ix) among other calculated quantities.
</p>


<h3>Value</h3>

<p>Depending on the 'return' argument, the function returns:
</p>

<ul>
<li> <p><code>"predict"</code>: A numeric vector of predicted photosynthetic rates.
</p>
</li>
<li> <p><code>"calc"</code>: A named vector of calculated quantities:
Pgmax,
Pmax,
Icomp,
phi_I0 (quantum yield calculated at I0),
phi_Icomp (quantum yield calculated at Icomp),
phi_I0_Icomp (quantum yield calculated by the range of values between I0 and Icomp),
phi_Icomp_I200 (quantum yield calculated by the range between Icomp and I200),
Rd (dark respiration),
Imax (Imax calculated),
Imax_obs (Imax observed),
P_Imax (assimilation value at maximum light),
Isat_x, x = .25, .50, .75, .85, .90, .95 (light saturation at x percent of Pmax),
Ix, x = .25, .50, .75, .85, .90, .95 (light intensity at x percent of Pmax)
</p>
</li>
<li> <p><code>"all"</code>: A list containing both the predicted values, calculated quantities, and model fit statistics.
</p>
</li></ul>



<h3>References</h3>

<div class="sourceCode"><pre>Lobo, F. de A., M. P. de Barros, H. J. Dalmagro,  .C. Dalmolin, W. E. Pereira, É.C. de Souza, G. L. Vourlitis and C. E. Rodriguez Ortiz 2013 Fitting net photosynthetic light-response curves with Microsoft Excel – a critical look at the models. Photosynthetica 51 (3): 445-456.

Prioul, J. L., P. Chartier 1977 Partitioning of transfer and carboxylation components of intracellular resistance to photosynthetic CO2 fixation: A critical analysis of the methods used. Ann. Bot. 41: 789-800.

Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of photosynthetic light response curve: approaches and pitfalls in phylogenetic modeling of a function-valued trait. IJPS, in review
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example dataset
    example_data &lt;- data.frame(
      PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
      A = c(1.8, 4.2, 7.5, 12.8, 16.2, 18.5, 19.3, 19.4, 19.5)
    )

    # Predict photosynthetic rates given the parameters
    predicted_values &lt;- eq6(pars = c(Pgmax = 15.5, phi_I0 = .0493,
      theta = .433,Rd = .9),PARi = c(0, 100, 200, 400, 800),
      return= "predict")
    print(predicted_values)

    # Use experimental data to predict photosynthetic rates and estimate linear parameters
    result &lt;- eq6(data = example_data, return = "all")
    print(result$calc)  # View calculated quantities
    print(result$fit)   # View fit statistics and optimized parameters

    # Get calculated quantities directly
    calculated_quantities &lt;- eq6(data = example_data, return = "calc")
    print(calculated_quantities)

</code></pre>

<hr>
<h2 id='eq8'>Calculate Photosynthetic Rates Using a Nonlinear Model EQ8</h2><span id='topic+eq8'></span>

<h3>Description</h3>

<p>Uses the nonlinear least squares exponential model equation 8 from Lobo et. al (2013) to transform measured photosynthetic data into a smoothed function-valued trait with the following function:
A~(Pgmax*(1-exp(-phi_I0(PARi)/Pgmax)))-Rd
The function will return predicted values, calculated quantities or both.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eq8(pars = c(Pgmax = 16.2,phi_I0 = .0597,Rd = 1.3),
    data,
    PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
    return = c("predict","calc","all")[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eq8_+3A_pars">pars</code></td>
<td>
<p>A named vector of parameters. Default values are Pgmax = 16.2, phi_I0 = .0597, and Rd = 1.3. These serve as initial starting parameters for the function to rapidly assess your data through an iterative process. These values may be changed to fall within the minimum and maximum parameter values of your study system.</p>
</td></tr>
<tr><td><code id="eq8_+3A_data">data</code></td>
<td>
<p>A data frame containing the experimental data with at least two columns: 'PARi' for the incident light and 'A' for the photosynthetic rate.</p>
</td></tr>
<tr><td><code id="eq8_+3A_pari">PARi</code></td>
<td>
<p>A numeric vector of incident light values. Defaults to a sequence from 0 to 2500.</p>
</td></tr>
<tr><td><code id="eq8_+3A_return">return</code></td>
<td>
<p>Character string indicating what the function should return. Options are &quot;predict&quot; for predicted values, &quot;calc&quot; for calculated quantities, and &quot;all&quot; for both. Defaults to &quot;predict&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the provided data to estimate the parameters Pgmax, phi_I0, and Rd by minimizing the squared differences between observed and predicted photosynthetic rates. The model is then used to calculate a range of derived functional trait quantities such as the dark respiration rate (Rd), light compensation point (Icomp), maximum photosynthetic rate (Pmax), and curve derived parameters (Ix) among other calculated quantities.
</p>


<h3>Value</h3>

<p>Depending on the 'return' argument, the function returns:
</p>

<ul>
<li> <p><code>"predict"</code>: A numeric vector of predicted photosynthetic rates.
</p>
</li>
<li> <p><code>"calc"</code>: A named vector of calculated quantities:
Pgmax,
Pmax,
Icomp,
phi_I0 (quantum yield calculated at I0),
phi_Icomp (quantum yield calculated at Icomp),
phi_I0_Icomp (quantum yield calculated by the range of values between I0 and Icomp),
phi_Icomp_I200 (quantum yield calculated by the range between Icomp and I200),
Rd (dark respiration),
Imax (Imax calculated),
Imax_obs (Imax observed),
P_Imax (assimilation value at maximum light),
Isat_x, x = .25, .50, .75, .85, .90, .95 (light saturation at x percent of Pmax),
Ix, x = .25, .50, .75, .85, .90, .95 (light intensity at x percent of Pmax)
</p>
</li>
<li> <p><code>"all"</code>: A list containing both the predicted values, calculated quantities, and model fit statistics.
</p>
</li></ul>



<h3>References</h3>

<div class="sourceCode"><pre>Lobo, F. de A., M. P. de Barros, H. J. Dalmagro,  .C. Dalmolin, W. E. Pereira, É.C. de Souza, G. L. Vourlitis and C. E. Rodriguez Ortiz 2013 Fitting net photosynthetic light-response curves with Microsoft Excel – a critical look at the models. Photosynthetica 51 (3): 445-456.

Webb, W. L., M. Newton, D. Starr 1974 Carbon dioxide exchange of *Alnus rubra*: a mathematical model. Oecologia 17: 281- 291.

Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of photosynthetic light response curve: approaches and pitfalls in phylogenetic modeling of a function-valued trait. IJPS, in review
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example dataset
    example_data &lt;- data.frame(
      PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
      A = c(1.8, 4.2, 7.5, 12.8, 16.2, 18.5, 19.3, 19.4, 19.5)
    )

    # Predict photosynthetic rates given the parameters
    predicted_values &lt;- eq8(pars = c(Pgmax = 16, phi_I0 = .0597, Rd = 1.3),
                       PARi = c(0, 100, 200, 400, 800), return = "predict")
    print(predicted_values)

    # Use experimental data to predict photosynthetic rates and estimate linear parameters
    result &lt;- eq8(data = example_data, return = "all")
    print(result$calc)  # View calculated quantities
    print(result$fit)   # View fit statistics and optimized parameters

    # Get calculated quantities directly
    calculated_quantities &lt;- eq8(data = example_data, return = "calc")
    print(calculated_quantities)

</code></pre>

<hr>
<h2 id='eq9'>Calculate Photosynthetic Rates Using a Nonlinear Model EQ9</h2><span id='topic+eq9'></span>

<h3>Description</h3>

<p>Uses the nonlinear least squares exponential model equation 9 from Lobo et. al (2013) to transform measured photosynthetic data into a smoothed function-valued trait with the following function:
A~Pgmax((1-exp(-k*(PARi-Icomp))))-Rd
The function will return predicted values, calculated quantities, or both.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eq9(pars = c(Pgmax = 22,Icomp = 10,k = .0015,Rd = .1),
    data,
    PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
    return = c("predict","calc","all")[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eq9_+3A_pars">pars</code></td>
<td>
<p>A named vector of parameters. Default values are Pgmax = 22, Icomp = 10, k = .0015, and Rd = .1. These serve as initial starting parameters for the function to rapidly assess your data through an iterative process. The coefficient k relates the photosynthetic capacity of a plant to the specific leaf mass, and may increase with an increasing potential for photosynthetic activity per unit leaf mass. All initial parameter values may be changed to fall within the minimum and maximum parameter values of your study system.</p>
</td></tr>
<tr><td><code id="eq9_+3A_data">data</code></td>
<td>
<p>A data frame containing the experimental data with at least two columns: 'PARi' for the incident light and 'A' for the photosynthetic rate.</p>
</td></tr>
<tr><td><code id="eq9_+3A_pari">PARi</code></td>
<td>
<p>A numeric vector of incident light values. Defaults to a sequence from 0 to 2500.</p>
</td></tr>
<tr><td><code id="eq9_+3A_return">return</code></td>
<td>
<p>Character string indicating what the function should return. Options are &quot;predict&quot; for predicted values, &quot;calc&quot; for calculated quantities, and &quot;all&quot; for both. Defaults to &quot;predict&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the provided data to estimate the parameters Pgmax, Icomp, Rd, and k by minimizing the squared differences between observed and predicted photosynthetic rates. The model is then used to calculate a range of derived functional trait quantities such as the dark respiration rate (Rd), light compensation point (Icomp), maximum photosynthetic rate (Pmax), and curve derived parameters (Ix) among other calculated quantities.
</p>


<h3>Value</h3>

<p>Depending on the 'return' argument, the function returns:
</p>

<ul>
<li> <p><code>"predict"</code>: A numeric vector of predicted photosynthetic rates.
</p>
</li>
<li> <p><code>"calc"</code>: A named vector of calculated quantities:
Pgmax,
Pmax,
Icomp,
phi_I0 (quantum yield calculated at I0),
phi_Icomp (quantum yield calculated at Icomp),
phi_I0_Icomp (quantum yield calculated by the range of values between I0 and Icomp),
phi_Icomp_I200 (quantum yield calculated by the range between Icomp and I200),
Rd (dark respiration),
Imax (Imax calculated),
Imax_obs (Imax observed),
P_Imax (assimilation value at maximum light),
Isat_x, x = .25, .50, .75, .85, .90, .95 (light saturation at x percent of Pmax),
Ix, x = .25, .50, .75, .85, .90, .95 (light intensity at x percent of Pmax)
</p>
</li>
<li> <p><code>"all"</code>: A list containing both the predicted values, calculated quantities, and model fit statistics.
</p>
</li></ul>



<h3>References</h3>

<div class="sourceCode"><pre>Lobo, F. de A., M. P. de Barros, H. J. Dalmagro,  .C. Dalmolin, W. E. Pereira, É.C. de Souza, G. L. Vourlitis and C. E. Rodriguez Ortiz 2013 Fitting net photosynthetic light-response curves with Microsoft Excel – a critical look at the models. Photosynthetica 51 (3): 445-456.

Prado, C. H. B. A., J. P. A. P. V. de Moraes 1997 Photosynthetic capacity and specific leaf mass in twenty woody species of cerrado vegetation under field conditions. Photosynthetica 33: 103-112.

Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of photosynthetic light response curve: approaches and pitfalls in phylogenetic modeling of a function-valued trait. IJPS, in review
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>    # Example dataset
    example_data &lt;- data.frame(
      PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
      A = c(1.8, 4.2, 7.5, 12.8, 16.2, 18.5, 19.3, 19.4, 19.5)
    )

    # Predict photosynthetic rates given the parameters
    predicted_values &lt;- eq9(pars= c(Pgmax = 20,Icomp = 20,k = .0015,Rd = .2),
                       PARi = c(0, 100, 200, 400, 800), return = "predict")
    print(predicted_values)

    # Use experimental data to predict photosynthetic rates and estimate linear parameters
    result &lt;- eq9(data = example_data, return = "all")
    print(result$calc)  # View calculated quantities
    print(result$fit)   # View fit statistics and optimized parameters

    # Get calculated quantities directly
    calculated_quantities &lt;- eq9(data = example_data, return = "calc")
    print(calculated_quantities)

</code></pre>

<hr>
<h2 id='nls_results'>Array of Results from all NLS Models eq1-eq11</h2><span id='topic+nls_results'></span>

<h3>Description</h3>

<p>This function generates an array of results from the NLS models
presented in Lobo et al. (2013) and Davis et al. (2024). The array
includes all calculated values/model parameters for each NLS model (eq),
predicted values of the NLS curve, and goodness of fit statistics -
mean squared error (MSE) and r2 values- for each predicted curve and
calculated value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nls_results(
    data,
    species_col,
    sample_col,
    A_col,
    specs = NULL,
    dat_wide = NULL,
    PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500),
    PARi_fine = seq(0,6000,by = .1),
    eqs = paste("eq", c(1, 2, 3, 4, 5, 6, 8, 9, 11), sep = ""),
    par_names = c("Pgmax", "Pmax", "phi_I0", "phi_I0_Icomp", "phi_Icomp",
                   "phi_Icomp_200", "Rd", "Icomp", "Isat", "Isat_25",
                   "Isat_50", "Isat_75", "Isat_85", "Isat_90", "Isat_95",
                   "I5", "I10", "I15", "I25", "I50", "I75", "I85", "I90",
                   "I95", "Imax", "Imax_obs", "P_Imax",
                   "beta", "gamma", "theta", "k"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nls_results_+3A_data">data</code></td>
<td>
<p>A data frame of measured input data with a column
for each unique plant observed, a column to indicate a common identifier
among each unique observation a column of light intensities at measured
PARi values, and a column for measured measured carbon assimilation
values.</p>
</td></tr>
<tr><td><code id="nls_results_+3A_species_col">species_col</code></td>
<td>
<p>Identify the column in your data set for the Species
name, or the common identifier for each sample (Ex. H.Debilis)</p>
</td></tr>
<tr><td><code id="nls_results_+3A_sample_col">sample_col</code></td>
<td>
<p>Identify the column in your data set with the Sample ID,
or the unique identifier for each observation (Ex. H.Debilis_2_Oct1).</p>
</td></tr>
<tr><td><code id="nls_results_+3A_a_col">A_col</code></td>
<td>
<p>Identify the column in your data set corresponding to the
measured carbon assimilation value (A).</p>
</td></tr>
<tr><td><code id="nls_results_+3A_specs">specs</code></td>
<td>
<p>A character or factor vector to subset individual identifiers,
defaults to all unique samples in the data set.</p>
</td></tr>
<tr><td><code id="nls_results_+3A_dat_wide">dat_wide</code></td>
<td>
<p>A wide-format data frame used to extract observed <code>PARi</code> and
<code>A</code> values for each <code>Species</code> and <code>Sample</code> taken, defaults to
transform <code>dat_wide</code> from <code>data</code> automatically.</p>
</td></tr>
<tr><td><code id="nls_results_+3A_pari">PARi</code></td>
<td>
<p>A numeric vector of <code>PARi</code> values in which carbon assimilation
was measured.
Defaults to c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500).</p>
</td></tr>
<tr><td><code id="nls_results_+3A_pari_fine">PARi_fine</code></td>
<td>
<p>A finer numeric vector of <code>PARi</code> values for estimating
response across a continuous light range, defaults to seq(0,6000,by = .1)
for fine scale predictions.</p>
</td></tr>
<tr><td><code id="nls_results_+3A_eqs">eqs</code></td>
<td>
<p>A character vector of equation names to be fitted. Defaults to the
9 equations programmed in this package:
(<code>eq1</code>, <code>eq2</code>, <code>eq3</code>, <code>eq4</code>, <code>eq5</code>, <code>eq6</code>, <code>eq8</code>, <code>eq9</code>, <code>eq11</code>).</p>
</td></tr>
<tr><td><code id="nls_results_+3A_par_names">par_names</code></td>
<td>
<p>A character or factor vector of parameters calculated from
the NLS models to include in the array of results. Defaults to parameters
calculated from all 9 models in this package unless otherwise specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function fits each equation from the <code>eqs</code> list to the subset
of <code>data</code> corresponding to each unique sample. It then returns
calculated parameters, predicted values, and observed <code>PARi</code> values for
the given individual(s). The results are stored in an array, and the
goodness-of-fit metrics (<code>r2</code> and <code>mse</code>) are saved in separate matrices.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>

<dl>
<dt>res</dt><dd><p>An array of results. The array dimensions are:
number of photosynthetic models (eq) tested x
(number of parameters + 2 * length(PARi)) x length(inds).</p>
</dd>
<dt>fitted_curves</dt><dd><p>A list of fitted curves for each equation and
individual.</p>
</dd>
<dt>r2</dt><dd><p>A matrix of <code>r2</code> values for each individual and equation.</p>
</dd>
<dt>mse</dt><dd><p>A matrix of <code>mse</code> values for each individual and equation.</p>
</dd>
</dl>



<h3>References</h3>

<div class="sourceCode"><pre>Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of
photosynthetic light response curve: approaches and pitfalls in
phylogenetic modeling of a function-valued trait. IJPS, in review

Lobo, F. de A., M. P. de Barros, H. J. Dalmagro,  .C. Dalmolin,
W. E. Pereira, É.C. de Souza, G. L. Vourlitis and C. E. Rodriguez Ortiz
2013 Fitting net photosynthetic light-response curves with Microsoft
Excel – a critical look at the models. Photosynthetica 51 (3): 445-456.
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'># Example dataset
data(sunflowers)
data &lt;- sunflowers |&gt;filter(SampleID==SampleID)

# Specify arguments
PARi = c(0, 50, 100, 250, 500, 1000, 1500, 2000, 2500)
PARifine &lt;- seq(0, 1500, by = 1)
par_names &lt;- c("Pmax", "Icomp", "phi_Icomp", "Rd", "I15, I25", "I85", "I95")
dat_wide &lt;- data %&gt;% pivot_wider(id_cols = c(Species,SampleID),
                                 names_from = PARi, names_prefix = "PARi_",values_from = A)
subset &lt;- first_five &lt;- unique(data$SampleID[1:43])

# Process light response curve data for all model equations
my_results &lt;- nls_results(data = data, species_col = "Species",
                          sample_col = "SampleID", A_col = "A", PARi_fine = PARifine,
                         specs = subset, dat_wide = dat_wide, par_names = par_names)

# Access the results array
result_array &lt;- my_results$res
# Access the fitted curves
fitted_curves &lt;- my_results$fitted_curves
# Access r2 and mse matrices
r2_matrix &lt;- my_results$r2
mse_matrix &lt;- my_results$mse

</code></pre>

<hr>
<h2 id='plot_eq'>Plot Photosynthetic Models</h2><span id='topic+plot_eq'></span>

<h3>Description</h3>

<p>This function plots the fit of a given photosynthetic light
response equation for all or select species in a data set. This base R
plot includes the SampleID and the equation number in the title.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_eq(eqX,
       eq_name,
       i,
       data,
       title,
       species_subset = NULL,
       A_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_eq_+3A_eqx">eqX</code></td>
<td>
<p>A function representing the photosynthetic light response equation
(e.g., <code>eq1</code>, <code>eq2</code>).</p>
</td></tr>
<tr><td><code id="plot_eq_+3A_eq_name">eq_name</code></td>
<td>
<p>A character string representing the name of the equation, to
be included in the plot title.</p>
</td></tr>
<tr><td><code id="plot_eq_+3A_i">i</code></td>
<td>
<p>An integer specifying the index of the species in the <code>inds</code>
vector.</p>
</td></tr>
<tr><td><code id="plot_eq_+3A_data">data</code></td>
<td>
<p>A data frame containing the experimental data with at least two
columns: <code>PARi</code> for the incident light and <code>A</code> for the measured
photosynthetic rate.</p>
</td></tr>
<tr><td><code id="plot_eq_+3A_title">title</code></td>
<td>
<p>An optional character string specifying the title of the plot
(defaults to title in the format <code>i SampleID Equation X</code>.</p>
</td></tr>
<tr><td><code id="plot_eq_+3A_species_subset">species_subset</code></td>
<td>
<p>An optional vector of species names from <code>inds</code>
to be plotted. If <code>NULL</code>, all species in <code>inds</code> will be used
(default is <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="plot_eq_+3A_a_col">A_col</code></td>
<td>
<p>Allows data column with assimilation measurements to be specified
and defaults to <code>A</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes the equation of photosynthetic light response
models and fits it to the data for a given species. It then plots the
observed and predicted values, highlighting specific points on the curve
(such as the model curve paramaters <code>I15</code>, <code>I25</code>, <code>I85</code>,
and <code>I95</code>), where the number (X) is the carbon assimilation rate at
X percent of the maximum assimilation in the measured data. The equation
name is included in the plot title, and an optional subset of
species can be selected for plotting. The function also calculates
various fit statistics and adds both the original and reconstructed
predictions as curves to the plot.
</p>


<h3>Value</h3>

<p>A plot of the measured data points for the selected species (open
points), with curve parameters from the fitted equation (black points),
the NLS curve (red line), and the model fit (dashed blue line). It will
also return the reconstructed model fit as a list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example with eq1 and all species
# Please note, it may take more than 10 seconds to plot graphs with all species

data(sunflowers)
my_observed_data &lt;- sunflowers
inds &lt;- unique(my_observed_data$SampleID)

# Example with eq1 and all species

for (i in 1:length(inds)) {
   plot_eq(eq1, "eq1", i, data = my_observed_data)
 }

# Example of using the function for all equations with all species or a subset of species

LRCdata &lt;- sunflowers |&gt; filter(SampleID==SampleID)
highlight &lt;- c("Agrestis_1_29/10/19", "Atrorubens_3_11/11/2019", "Divaricatus_2_29/10/19",
"Gracilentus_2_3/11/2019", "Gracilentus_5_5/11/2019", "Silphiodias_1_3/11/2019")
par(mfrow = c(3, 3))

for (i in 1:length(highlight)) {
  # Add equation names to the function calls
  plot_eq(eq1, "eq1", i, data = LRCdata, species_subset = highlight)
  plot_eq(eq2, "eq2", i, data = LRCdata, species_subset = highlight)
  plot_eq(eq3, "eq3", i, data = LRCdata, species_subset = highlight)
  plot_eq(eq4, "eq4", i, data = LRCdata, species_subset = highlight)
  plot_eq(eq5, "eq5", i, data = LRCdata, species_subset = highlight)
  plot_eq(eq6, "eq6", i, data = LRCdata, species_subset = highlight)
  plot_eq(eq8, "eq8", i, data = LRCdata, species_subset = highlight)
  plot_eq(eq9, "eq9", i, data = LRCdata, species_subset = highlight)
  plot_eq(eq11, "eq11", i, data = LRCdata, species_subset = highlight)
  dev.off()
    }
    oldpar&lt;- par(mfrow = c(1,2))
    par(oldpar)
    on.exit()


</code></pre>

<hr>
<h2 id='sunflowers'>Light Response Curves from a Common Garden Experiment in <em>Helianthus</em></h2><span id='topic+sunflowers'></span>

<h3>Description</h3>

<p>This dataset contains photosynthetic light response curves for
28 sunflower species in the genus <em>Helianthus</em>. The data was gathered in
a common garden to evaluate phylogenetic change to photosynthetic
response across as a function-valued trait (Davis et al. 2024).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sunflowers
</code></pre>


<h3>Format</h3>

<p>A data frame with 666 rows and 22 variables:
</p>

<dl>
<dt>SampleID</dt><dd><p>A unique identifier for each sample, a combination of
Species_Replicate_Date (character).</p>
</dd>
<dt>Species</dt><dd><p>The species name of the sunflower (character).</p>
</dd>
<dt>Replicate</dt><dd><p>The number assigned to indicate repeated individuals of
the same species (numeric).</p>
</dd>
<dt>Date</dt><dd><p>The day at which the measurement was taken (character,
DD:MM:YY format).</p>
</dd>
<dt>Time</dt><dd><p>The time at which the measurement was taken (character,
HH:MM format).</p>
</dd>
<dt>CO2r</dt><dd><p>The TARGAS-1 reference CO2 (µmol CO2 mol^-1, numeric).</p>
</dd>
<dt>CO2a</dt><dd><p>The TARGAS-1 ambient CO2 reading (µmol CO2 mol^-1, numeric).</p>
</dd>
<dt>H2Or</dt><dd><p>Humidity reading measured by the TARGAS-1 reference during
the time of measurement (mb, numeric).</p>
</dd>
<dt>H2Oa</dt><dd><p>Humidity reading measured in the air by the TARGAS-1 during
the time of measurement (mb, numeric).</p>
</dd>
<dt>atm</dt><dd><p>Atmospheric pressured at the measurement (mb, numeric).</p>
</dd>
<dt>Flow.Supply</dt><dd><p>Air flow moving through the TARGAS-1 (cc/min, numeric).</p>
</dd>
<dt>Flow.sample</dt><dd><p>Air flow passing back into the TARGAS-1 from the PLC
(cc/min, numeric).</p>
</dd>
<dt>PARe</dt><dd><p>Photosynthetically Active Radiation levels in the environment,
measured at the PLC (µmol m^-2 s^-1, numeric).</p>
</dd>
<dt>PARi</dt><dd><p>Photosynthetically Active Radiation levels on the leaf
(µmol m^-2 s^-1, numeric).</p>
</dd>
<dt>Tleaf</dt><dd><p>Leaf temperature in the PLC during the measurement
(degrees Celsius, numeric).</p>
</dd>
<dt>Trans</dt><dd><p>Transpiration rate (mmol H2O m^-2 s^-1, numeric).</p>
</dd>
<dt>VPD</dt><dd><p>Vapor pressure deficit during the measurement (mb, numeric).</p>
</dd>
<dt>gs</dt><dd><p>Stomatal conductance (mmol H2O m^-2 s^-1, numeric).</p>
</dd>
<dt>A</dt><dd><p>Photosynthetic rate (µmol CO2 m^-2 s^-1, numeric).</p>
</dd>
<dt>Ci</dt><dd><p>Concentration of leaf internal CO2 (µmol CO2 mol^-1, numeric).</p>
</dd>
<dt>Area</dt><dd><p>The area of the leaf measured (cm^2, numeric).</p>
</dd>
</dl>



<h3>Details</h3>

<p>All plants were grown in fertilized 1 gallon pots during August-
December 2019 at the University of Central Florida's Transgenic
Greenhouse. Measurements were taken for two hours before and after solar
noon with the Portable Photosynthetic Systems (PPS) TARGAS-1 on the most
recently expanded full leaf during the juvenile stage just before
flowering (V4-6) (NDSU Stages of Sunflower Development).  The TARGAS-1
portable leaf cuvette (PLC) was clamped on the leaf perpendicular to the
leaf margin, and photosynthetic measurements were taken at approximately
420 ppm CO2, ambient humidity, and 500 ppm flow. Photosynthetic responses
were recorded at 9 levels with an acclimation of 2-5 minutes at PARi 0,
PARi 50, PARi 100, PARi 250, PARi 500, PARi 1000, PARi 2000,
PARi 2500 (µmol s/m2). The data was manually curated such that duplicate
instantaneous assimilation points were removed and only one single
representative sample from each replicate was used in analysis. The data
set includes the Sample name, the species name, the replicate number,
and 19 other variables obtained from the TARGAS-1 measurement.
</p>


<h3>Author(s)</h3>

<p>Rebekah Davis, University of Central Florida
</p>


<h3>Source</h3>

<p>Data collected by Rebekah Davis at the University of Central Florida.
</p>


<h3>References</h3>

<div class="sourceCode"><pre>Davis, R.E., C. M. Mason, E. W. Goolsby 2024 Comparative evolution of
photosynthetic light response curve: approaches and pitfalls in
phylogenetic modeling of a function-valued trait. IJPS, in review

Kandel, H., A. A. Schneiter, J. F. Miller, D. R. Berglund 2019 Stages of
Sunflower Development. North Dakota State University Extension
(https://www.ndsu.edu/agriculture/extension/publications/stages-
sunflower-development)
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'># Load the dataset
data(sunflowers)

# View the first few rows
head(sunflowers)

# Summary statistics for photosynthetic rate (A)
summary(sunflowers$A)

# Plot the photosynthetic rate vs. PARi
plot(sunflowers$PARi, sunflowers$A,
     xlab = "PAR (µmol m^-2 s^-1)",
     ylab = "Photosynthetic rate (µmol CO2 m^-2 s^-1)")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
