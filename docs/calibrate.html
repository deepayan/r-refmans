<!DOCTYPE html><html lang="en"><head><title>Help for package calibrate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {calibrate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bplot'><p>General function for making biplots</p></a></li>
<li><a href='#calibrate'><p>Calibration of Biplot and Scatterplot Axis</p></a></li>
<li><a href='#calves'><p>Delivery of Dutch Calves</p></a></li>
<li><a href='#canocor'><p>Canonical correlation analysis</p></a></li>
<li><a href='#circle'><p>Draw a circle</p></a></li>
<li><a href='#dlines'><p>Connect two sets of points by lines</p></a></li>
<li><a href='#goblets'><p>Size measurements of archeological goblets</p></a></li>
<li><a href='#heads'><p>Dimensions of heads of first and second sons for 25 families</p></a></li>
<li><a href='#linnerud'><p>Linnerud's exercise and body measurements</p></a></li>
<li><a href='#ones'><p>Generates a matrix of ones</p></a></li>
<li><a href='#origin'><p>Origin</p></a></li>
<li><a href='#PrinCoor'><p>Function for Principal Coordinate Analysis</p></a></li>
<li><a href='#rad2degree'>
<p>Convert radians to degrees.</p></a></li>
<li><a href='#rda'><p>Redundancy analysis</p></a></li>
<li><a href='#shiftvector'>
<p>Compute a shift vector for a calibrated axis.</p></a></li>
<li><a href='#spaindist'><p>Road distances between Spanish cities</p></a></li>
<li><a href='#storks'><p>Frequencies of nesting storks in Denmark</p></a></li>
<li><a href='#textxy'><p> Nice placement of labels in a plot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.7.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-06-18</td>
</tr>
<tr>
<td>Title:</td>
<td>Calibration of Scatterplot and Biplot Axes</td>
</tr>
<tr>
<td>Author:</td>
<td>Jan Graffelman &lt;jan.graffelman@upc.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Graffelman &lt;jan.graffelman@upc.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>Package for drawing calibrated scales with tick marks on (non-orthogonal) 
             variable vectors in scatterplots and biplots. Also provides some functions for biplot creation and
	     for multivariate analysis such as principal coordinate analysis.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-18 19:36:22 UTC; jangr</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-19 05:40:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='bplot'>General function for making biplots </h2><span id='topic+bplot'></span>

<h3>Description</h3>

<p>Function <code>bplot</code> creates biplots on the basis matrices of row
and column markers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bplot(Fr,G,rowlab=rownames(Fr),collab=rownames(G),qlt=rep(1,nrow(Fr)),
refaxis=TRUE,ahead=T,xl=NULL,yl=NULL,frame=F,qltlim=0,rowch=19,
colch=19,qltvar=NULL,rowcolor="red",colcolor="blue",rowmark=TRUE,
colmark=TRUE,rowarrow=FALSE,colarrow=TRUE,markrowlab=TRUE,
markcollab=TRUE,xlab="",ylab="",cex.rowlab=1,cex.rowdot=0.75,
cex.collab=1,cex.coldot=0.75,cex.axis=0.75,lwd=1,arrowangle=10,...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bplot_+3A_fr">Fr</code></td>
<td>
<p>matrix with coordinates of the row markers.</p>
</td></tr>
<tr><td><code id="bplot_+3A_g">G</code></td>
<td>
<p>matrix with coordinates of the column markers.</p>
</td></tr>
<tr><td><code id="bplot_+3A_rowlab">rowlab</code></td>
<td>
<p>vector with labels for the rows.</p>
</td></tr>
<tr><td><code id="bplot_+3A_collab">collab</code></td>
<td>
<p>vector with labels for the columns.</p>
</td></tr>
<tr><td><code id="bplot_+3A_qlt">qlt</code></td>
<td>
<p>goodness of fit of the rows.</p>
</td></tr>
<tr><td><code id="bplot_+3A_refaxis">refaxis</code></td>
<td>
<p>draw coordinate system <code>refaxis=TRUE</code> or not.</p>
</td></tr>
<tr><td><code id="bplot_+3A_ahead">ahead</code></td>
<td>
<p>put a head on the vectors <code>ahead=TRUE</code> or not.</p>
</td></tr>
<tr><td><code id="bplot_+3A_xl">xl</code></td>
<td>
<p>limits for the x-axis.</p>
</td></tr>
<tr><td><code id="bplot_+3A_yl">yl</code></td>
<td>
<p>limits for the y-axis.</p>
</td></tr>
<tr><td><code id="bplot_+3A_frame">frame</code></td>
<td>
<p>draw a box around the plot <code>frame=TRUE</code> or not.</p>
</td></tr>
<tr><td><code id="bplot_+3A_qltlim">qltlim</code></td>
<td>
<p>draw only the vectors with a goodness of fit larger than <code>qltlim</code>.</p>
</td></tr>
<tr><td><code id="bplot_+3A_rowch">rowch</code></td>
<td>
<p>character used for the row markers.</p>
</td></tr>
<tr><td><code id="bplot_+3A_colch">colch</code></td>
<td>
<p>character used for the column markers.</p>
</td></tr>
<tr><td><code id="bplot_+3A_qltvar">qltvar</code></td>
<td>
<p>vector with the goodness of fit of each variable.</p>
</td></tr>
<tr><td><code id="bplot_+3A_rowcolor">rowcolor</code></td>
<td>
<p>colour used for the row markers.</p>
</td></tr>
<tr><td><code id="bplot_+3A_colcolor">colcolor</code></td>
<td>
<p>colour used for the column markers.</p>
</td></tr>
<tr><td><code id="bplot_+3A_rowmark">rowmark</code></td>
<td>
<p>show row markers (<code>rowmark=TRUE</code>) or not.</p>
</td></tr>
<tr><td><code id="bplot_+3A_colmark">colmark</code></td>
<td>
<p>show column markers (<code>colmark=TRUE</code>) or not.</p>
</td></tr>
<tr><td><code id="bplot_+3A_rowarrow">rowarrow</code></td>
<td>
<p>draw vectors from the origin to the row markers (<code>rowarrow=TRUE</code>) or not.</p>
</td></tr>
<tr><td><code id="bplot_+3A_colarrow">colarrow</code></td>
<td>
<p>draw vectors from the origin to the column markers (<code>colarrow=TRUE</code>) or not.</p>
</td></tr>
<tr><td><code id="bplot_+3A_markrowlab">markrowlab</code></td>
<td>
<p>depict row marker labels (<code>rowlab=TRUE</code>) or not.</p>
</td></tr>
<tr><td><code id="bplot_+3A_markcollab">markcollab</code></td>
<td>
<p>depict column marker labels (<code>collab=TRUE</code>) or not.</p>
</td></tr>
<tr><td><code id="bplot_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x-axis.</p>
</td></tr>
<tr><td><code id="bplot_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y-axis.</p>
</td></tr>
<tr><td><code id="bplot_+3A_cex.rowlab">cex.rowlab</code></td>
<td>
<p>expansion factor for the row labels.</p>
</td></tr>
<tr><td><code id="bplot_+3A_cex.rowdot">cex.rowdot</code></td>
<td>
<p>expansion factor for the row markers.</p>
</td></tr>
<tr><td><code id="bplot_+3A_cex.collab">cex.collab</code></td>
<td>
<p>expansion factor for the column labels.</p>
</td></tr>
<tr><td><code id="bplot_+3A_cex.coldot">cex.coldot</code></td>
<td>
<p>expansion factor for the column markers.</p>
</td></tr>
<tr><td><code id="bplot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>expansion factor for the axis.</p>
</td></tr>
<tr><td><code id="bplot_+3A_lwd">lwd</code></td>
<td>
<p>line width for biplot vectors.</p>
</td></tr>
<tr><td><code id="bplot_+3A_arrowangle">arrowangle</code></td>
<td>
<p>angle for the edges of the arrowhead.</p>
</td></tr>
<tr><td><code id="bplot_+3A_...">...</code></td>
<td>
<p>extra arguments for plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. The function produces a graphic.</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
X &lt;- matrix(runif(40),byrow=TRUE,ncol=4)
colnames(X) &lt;- paste("X",1:ncol(X),sep="")
out.pca &lt;- princomp(X,cor=TRUE)
Fp &lt;- out.pca$scores
Gs &lt;- as.matrix(unclass(out.pca$loadings))
bplot(Fp,Gs,colch=NA)
</code></pre>

<hr>
<h2 id='calibrate'>Calibration of Biplot and Scatterplot Axis</h2><span id='topic+calibrate'></span>

<h3>Description</h3>

<p>Routine for the calibration of any axis (variable vector) in a biplot or a scatterplot</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate(g,y,tm,Fr,tmlab=tm,tl=0.05,dt=TRUE,dp=FALSE,
    lm=TRUE,verb=TRUE,axislab="",reverse=FALSE,
    alpha=NULL,labpos=1,weights=diag(rep(1,length(y))),
    axiscol="blue",cex.axislab=0.75,graphics=TRUE,where=3,
    laboffset=c(0,0),m=matrix(c(0,0),nrow=1),markerpos=3,
    showlabel=TRUE,lwd=1,shiftvec=c(0,0),shiftdir="none",shiftfactor=1.05) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibrate_+3A_g">g</code></td>
<td>
<p> the vector to be calibrated (2 x 1). </p>
</td></tr>
<tr><td><code id="calibrate_+3A_y">y</code></td>
<td>
<p> the data vector corresponding to <code>g</code>, appropriately centred and/or standardized. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_tm">tm</code></td>
<td>
<p> the vector of tick marks, appropiately centred and/or scaled. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_fr">Fr</code></td>
<td>
<p> the coordinates of the rows markers in the biplot. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_tmlab">tmlab</code></td>
<td>
<p> a list or vector of tick mark labels. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_tl">tl</code></td>
<td>
<p> the tick length. By default, the tick markers have length 0.05.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_dt">dt</code></td>
<td>
<p> draw ticks. By default, ticks markers are drawn. Set dt=F in order to compute
calibration results without actually drawing the calibrated scale. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_dp">dp</code></td>
<td>
<p> drop perpendiculars. With dp=T perpendicular lines will be drawn from the row markers 
specified by Fr onto the calibrated axis. This is a graphical aid to read off the values in the
corresponding scale. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_lm">lm</code></td>
<td>
<p> label markers. By default, all tick marks are labelled. Setting lm=F turns off the labelling
of the tick marks. This allows for creating tick marks without labels. It is particularly useful for
creating finer scales of tickmarks without labels.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_verb">verb</code></td>
<td>
<p> verbose parameter (F=be quiet, T=show results). </p>
</td></tr>
<tr><td><code id="calibrate_+3A_axislab">axislab</code></td>
<td>
<p> a label for the calibrated axis. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_reverse">reverse</code></td>
<td>
<p> puts the tick marks and tick mark labels on the other side of the axis. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_alpha">alpha</code></td>
<td>
<p> a value for the calibration factor. This parameter should only be specified if
a calibration is required that is different from the one that is optimal for data recovery.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_labpos">labpos</code></td>
<td>
<p> position of the label for the calibrated axis (1,2,3 or 4). </p>
</td></tr>
<tr><td><code id="calibrate_+3A_laboffset">laboffset</code></td>
<td>
<p> offset vector for the axis label. If specified, shifts the label by the specified amounts with respect to the current position. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_weights">weights</code></td>
<td>
<p> a matrix of weights (optional).  </p>
</td></tr>
<tr><td><code id="calibrate_+3A_axiscol">axiscol</code></td>
<td>
<p> color of the calibrated axis. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_cex.axislab">cex.axislab</code></td>
<td>
<p> character expansion factor for axis label and tick mark labels. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_graphics">graphics</code></td>
<td>
<p> do graphics or not (F=no graphical output, T=draws calibrated scale). </p>
</td></tr>
<tr><td><code id="calibrate_+3A_where">where</code></td>
<td>
<p> label placement (1=beginning,2=middle,3=end). </p>
</td></tr>
<tr><td><code id="calibrate_+3A_m">m</code></td>
<td>
<p> vector of means. </p>
</td></tr>
<tr><td><code id="calibrate_+3A_markerpos">markerpos</code></td>
<td>
<p> position specifier for the tick mark labels (1,2,3 or 4). </p>
</td></tr>
<tr><td><code id="calibrate_+3A_showlabel">showlabel</code></td>
<td>
<p> show axis label in graph (T) or not (F). </p>
</td></tr>
<tr><td><code id="calibrate_+3A_lwd">lwd</code></td>
<td>
<p> line with for the calibrated axis </p>
</td></tr>
<tr><td><code id="calibrate_+3A_shiftvec">shiftvec</code></td>
<td>
<p> a shift vector for the calibrated axis ((0,0) by
default) </p>
</td></tr>
<tr><td><code id="calibrate_+3A_shiftdir">shiftdir</code></td>
<td>
<p> indicates in which direction the axis should be
shifted (&quot;left&quot;,&quot;right&quot; or &quot;none&quot;). This direction is w.r.t. vector <code>g</code></p>
</td></tr>
<tr><td><code id="calibrate_+3A_shiftfactor">shiftfactor</code></td>
<td>
<p> scalar by which the shift vector is stretched (or
shrunken). By default, the length of the shift vector is stretched
by 5 percent (<code>shiftfactor</code> = 1.05)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This program calibrates variable vectors in biplots and scatterplots, by drawing tick marks along 
a given the vector and labelling the tick marks with specified values. The optimal calibration is
found by (generalized) least squares. Non-optimal calibrations are possible by specifying a 
calibration factor (alpha).
</p>


<h3>Value</h3>

<p>Returns a list with calibration results
</p>
<table role = "presentation">
<tr><td><code>useralpha</code></td>
<td>
<p>calibration factor specified by the user</p>
</td></tr>
<tr><td><code>optalpha</code></td>
<td>
<p>optimal calibration factor</p>
</td></tr>
<tr><td><code>lengthoneunit</code></td>
<td>
<p>length in the plot of one unit in the scale of the calibrated variable</p>
</td></tr>
<tr><td><code>gof</code></td>
<td>
<p>goodness of fit (as in regression)</p>
</td></tr>
<tr><td><code>gos</code></td>
<td>
<p>goodness of scale</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>coordinates of the tick markers</p>
</td></tr>
<tr><td><code>ang</code></td>
<td>
<p>angle in degrees of the biplot axis with the positive
x-axis</p>
</td></tr>
<tr><td><code>shiftvec</code></td>
<td>
<p>the supplied or computed shift vector</p>
</td></tr>
<tr><td><code>yt</code></td>
<td>
<p>fitted values for the variable according to the calibration</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>errors according to the calibration</p>
</td></tr>
<tr><td><code>Fpr</code></td>
<td>
<p>coordinates of the projections of the row markers onto the calibrated axis</p>
</td></tr>
<tr><td><code>Mn</code></td>
<td>
<p>coordinates of the tick marker end points</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman <a href="mailto:jan.graffelman@upc.edu">jan.graffelman@upc.edu</a> </p>


<h3>References</h3>

<p>Gower, J.C. and Hand, D.J., (1996) Biplots. Chapman &amp; Hall, London
</p>
<p>Graffelman, J. and van Eeuwijk, F.A. (2005) Calibration of multivariate scatter plots for 
exploratory analysis of relations within and between sets of variables in genomic research
Biometrical Journal, 47(6) pp. 863-879.
</p>
<p>Graffelman, J. (2006) A guide to biplot calibration.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+biplot">biplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(20,1)
y &lt;- rnorm(20,1)
x &lt;- x - mean(x)
y &lt;- y - mean(y)
z &lt;- x + y
b &lt;- c(1,1)
plot(x,y,asp=1,pch=19)
tm&lt;-seq(-2,2,by=0.5)
Calibrate.z &lt;- calibrate(b,z,tm,cbind(x,y),axislab="Z",graphics=TRUE)
</code></pre>

<hr>
<h2 id='calves'>Delivery of Dutch Calves</h2><span id='topic+calves'></span>

<h3>Description</h3>

<p>This data set gives a cross classification of 7275
calves born in the late nineties according to type
of production and type of delivery.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(calves)</code></pre>


<h3>Format</h3>

<p>A data frame containing a contingency table of 7275 observations.</p>


<h3>Source</h3>

<p>Holland Genetics.  <a href="http://www.hg.nl">http://www.hg.nl</a> </p>


<h3>References</h3>

<p>Graffelman, J. (2005) <em>A guide to scatterplot and biplot calibration</em>.
</p>

<hr>
<h2 id='canocor'>Canonical correlation analysis</h2><span id='topic+canocor'></span>

<h3>Description</h3>

<p><code>canocor</code> performs canonical correlation analysis on the
basis of the standardized variables and stores extensive output
in a list object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>canocor(X, Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="canocor_+3A_x">X</code></td>
<td>
<p> a matrix containing the X variables </p>
</td></tr>
<tr><td><code id="canocor_+3A_y">Y</code></td>
<td>
<p> a matrix containing the Y variables </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>canocor</code> computes the solution by a singular value 
decomposition of the transformed between set correlation matrix.
</p>


<h3>Value</h3>

<p>Returns a list with the following results
</p>
<table role = "presentation">
<tr><td><code>ccor</code></td>
<td>
<p> the canonical correlations </p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p> canonical weights of the x variables </p>
</td></tr> 
<tr><td><code>B</code></td>
<td>
<p> canonical weights of the y variables </p>
</td></tr> 
<tr><td><code>U</code></td>
<td>
<p> canonical x variates </p>
</td></tr> 
<tr><td><code>V</code></td>
<td>
<p> canonical y variates </p>
</td></tr> 
<tr><td><code>Fs</code></td>
<td>
<p> biplot markers for x variables (standard coordinates) </p>
</td></tr>
<tr><td><code>Gs</code></td>
<td>
<p> biplot markers for y variables (standard coordinates) </p>
</td></tr>
<tr><td><code>Fp</code></td>
<td>
<p> biplot markers for x variables (principal coordinates) </p>
</td></tr>
<tr><td><code>Gp</code></td>
<td>
<p> biplot markers for y variables (principal coordinates) </p>
</td></tr>
<tr><td><code>fitRxy</code></td>
<td>
<p> goodness of fit of the between-set correlation matrix </p>
</td></tr>
<tr><td><code>fitXs</code></td>
<td>
<p> adequacy coefficients of x variables </p>
</td></tr> 
<tr><td><code>fitXp</code></td>
<td>
<p> redundancy coefficients of x variables </p>
</td></tr> 
<tr><td><code>fitYs</code></td>
<td>
<p> adequacy coefficients of y variables </p>
</td></tr> 
<tr><td><code>fitYp</code></td>
<td>
<p> redundancy coefficients of y variables</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman <a href="mailto:jan.graffelman@upc.edu">jan.graffelman@upc.edu</a> </p>


<h3>References</h3>

 
<p>Hotelling, H. (1935) The most predictable criterion. Journal of Educational 
Psychology (26) pp. 139-142.
</p>
<p>Hotelling, H. (1936) Relations between two sets of variates. Biometrika
(28) pp. 321-377.
</p>
<p>Johnson, R. A. and Wichern, D. W. (2002) Applied Multivariate Statistical Analysis.
New Jersey: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cancor">cancor</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
X &lt;- matrix(runif(75),ncol=3)
Y &lt;- matrix(runif(75),ncol=3)
cca.results &lt;- canocor(X,Y)
</code></pre>

<hr>
<h2 id='circle'>Draw a circle</h2><span id='topic+circle'></span>

<h3>Description</h3>

<p><code>circle</code> draws a circle in an existing plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circle(radius,origin)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circle_+3A_radius">radius</code></td>
<td>
<p> the radius of the circle </p>
</td></tr>
<tr><td><code id="circle_+3A_origin">origin</code></td>
<td>
<p> the origin of the circle </p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL
</p>


<h3>Author(s)</h3>

<p> Jan Graffelman <a href="mailto:jan.graffelman@upc.edu">jan.graffelman@upc.edu</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>   set.seed(123)
   X &lt;- matrix(rnorm(20),ncol=2)
   plot(X[,1],X[,2])
   circle(1,c(0,0))
</code></pre>

<hr>
<h2 id='dlines'>Connect two sets of points by lines</h2><span id='topic+dlines'></span>

<h3>Description</h3>

<p><code>dlines</code> connects two sets of points by lines in
a rowwise manner.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlines(SetA, SetB, lin = "dotted")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlines_+3A_seta">SetA</code></td>
<td>
<p>matrix with the first set of points</p>
</td></tr>
<tr><td><code id="dlines_+3A_setb">SetB</code></td>
<td>
<p>matrix with teh second set of points</p>
</td></tr>
<tr><td><code id="dlines_+3A_lin">lin</code></td>
<td>
<p>linestyle for the connecting lines</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL
</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+lines">lines</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(runif(20),ncol=2)
Y &lt;- matrix(runif(20),ncol=2)
plot(rbind(X,Y))
text(X[,1],X[,2],paste("X",1:10,sep=""))
text(Y[,1],Y[,2],paste("Y",1:10,sep=""))
dlines(X,Y)
</code></pre>

<hr>
<h2 id='goblets'>Size measurements of archeological goblets</h2><span id='topic+goblets'></span>

<h3>Description</h3>

<p>This data set gives 6 different size measurements of 25 goblets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(goblets)</code></pre>


<h3>Format</h3>

<p>A data frame containing 25 observations.</p>


<h3>Source</h3>

<p>Manly, 1989</p>


<h3>References</h3>

<p>Manly, B. F. J. (1989) <em>Multivariate statistical methods: a primer</em>.
London: Chapman and Hall, London
</p>

<hr>
<h2 id='heads'>Dimensions of heads of first and second sons for 25 families</h2><span id='topic+heads'></span>

<h3>Description</h3>

<p>Variables X1 and X2 are the head length and head breadth of the first son and 
Y1 and Y2 are the same variables for the second son. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(heads)</code></pre>


<h3>Format</h3>

<p>A data frame containing 25 observations.</p>


<h3>Source</h3>

<p>Mardia, 1979, p. 121</p>


<h3>References</h3>

<p>Frets, G. P. (1921) <em>Heredity of head form in man</em>,
Genetica 3, pp. 193-384.
</p>
<p>Mardia, K. V. and Kent, J. T. and Bibby, J. M. (1979) <em>Multivariate Analysis</em>.
Academic Press London.
</p>
<p>Anderson, T. W. (1984) <em>An Introduction to Multivariate Statistical Analysis</em>.
New York: John Wiley, Second edition.
</p>

<hr>
<h2 id='linnerud'>Linnerud's exercise and body measurements</h2><span id='topic+linnerud'></span>

<h3>Description</h3>

<p>The data set consist of 3 exercise variables (Tractions a la barre
fixe, Flexions, Sauts) and 3 body measurements (Poids, Tour de talle,
Pouls) of 20 individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(linnerud)</code></pre>


<h3>Format</h3>

<p>A data frame containing 20 observations.</p>


<h3>Source</h3>

<p>Tenenhaus, 1998, table 1, page 15</p>


<h3>References</h3>

<p>Tenenhaus, M. (1998) <em>La Regression PLS</em>.
Paris: Editions Technip.
</p>

<hr>
<h2 id='ones'>Generates a matrix of ones</h2><span id='topic+ones'></span>

<h3>Description</h3>

<p><code>ones</code> generates a matrix of ones. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ones(n, p = n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ones_+3A_n">n</code></td>
<td>
<p> number of rows </p>
</td></tr>
<tr><td><code id="ones_+3A_p">p</code></td>
<td>
<p> number of columns </p>
</td></tr>
</table>


<h3>Details</h3>

<p>if only n is specified, the resulting matrix will be square.
</p>


<h3>Value</h3>

<p>a matrix filled with ones.
</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+matrix">matrix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>Id &lt;- ones(3)
print(Id)
</code></pre>

<hr>
<h2 id='origin'>Origin</h2><span id='topic+origin'></span>

<h3>Description</h3>

<p>Draws coordinate axes in a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>origin(m=c(0,0), ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="origin_+3A_m">m</code></td>
<td>
<p> the coordinates of the means (2 x 1). </p>
</td></tr>
<tr><td><code id="origin_+3A_...">...</code></td>
<td>
<p> other arguments passed on to the <code>lines</code> function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+lines">lines</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   X &lt;- matrix(runif(40),ncol=2)
   plot(X[,1],X[,2])
   origin(m=c(mean(X[,1]),mean(X[,2])))
</code></pre>

<hr>
<h2 id='PrinCoor'>Function for Principal Coordinate Analysis
</h2><span id='topic+PrinCoor'></span>

<h3>Description</h3>

<p>Function <code>PrinCoor</code> implements Principal Coordinate Analysis, also known as classical metric multidimensional scaling or
classical scaling. In comparison with other software, it offers refined statistics for goodness-of-fit at the level of individual observations and pairs of observartions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PrinCoor(Dis, eps = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PrinCoor_+3A_dis">Dis</code></td>
<td>
<p>A distance matrix or dissimilarity matrix</p>
</td></tr>
<tr><td><code id="PrinCoor_+3A_eps">eps</code></td>
<td>
<p>A tolerance criterion for deciding if eigenvalues are zero or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculations are based on the spectral decomposition of the scalar product matrix B, derived from the distance matrix.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>The coordinates of the the solution</p>
</td></tr>
<tr><td><code>la</code></td>
<td>
<p>The eigenvalues of the solution</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>The scalar product matrix</p>
</td></tr>
<tr><td><code>standard.decom</code></td>
<td>
<p>Standard overall goodness-of-fit table using all eigenvalues</p>
</td></tr>
<tr><td><code>positive.decom</code></td>
<td>
<p>Overall goodness-of-fit table using only positive eigenvalues</p>
</td></tr>
<tr><td><code>absolute.decom</code></td>
<td>
<p>Overall goodness-of-fit table using absolute values of eigenvalues</p>
</td></tr>
<tr><td><code>squared.decom</code></td>
<td>
<p>Overall goodness-of-fit table using squared eigenvalues</p>
</td></tr>
<tr><td><code>RowStats</code></td>
<td>
<p>Detailed goodness-of-fit statistics for each row</p>
</td></tr>
<tr><td><code>PairStats</code></td>
<td>
<p>Detailed goodness-of-fit statistics for each pair</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman <a href="mailto:jan.graffelman@upc.edu">jan.graffelman@upc.edu</a> </p>


<h3>References</h3>

<p>Graffelman, J. (2019) Goodness-of-fit filtering in classical metric multidimensional scaling with large
datasets. &lt;doi: 10.1101/708339&gt;
</p>
<p>Graffelman, J. and van Eeuwijk, F.A. (2005) Calibration of multivariate scatter plots for 
exploratory analysis of relations within and between sets of variables in genomic research
Biometrical Journal, 47(6) pp. 863-879.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+princomp">princomp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   data(spaindist)
   results &lt;- PrinCoor(as.matrix(spaindist))
</code></pre>

<hr>
<h2 id='rad2degree'>
Convert radians to degrees.
</h2><span id='topic+rad2degree'></span>

<h3>Description</h3>

<p><code>rad2degree converts radians to degrees.</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rad2degree(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rad2degree_+3A_x">x</code></td>
<td>
<p>an angle in radians</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the angle with the positive x-axis in degrees.
</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>Examples</h3>

<pre><code class='language-R'>   x &lt;- pi/2
   a &lt;- rad2degree(x)
   cat("angle is",a,"degrees\n")
</code></pre>

<hr>
<h2 id='rda'>Redundancy analysis</h2><span id='topic+rda'></span>

<h3>Description</h3>

<p><code>rda</code> performs redundancy analysis and stores extensive output
in a list object. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rda(X, Y, scaling = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rda_+3A_x">X</code></td>
<td>
<p>a matrix of x variables</p>
</td></tr>
<tr><td><code id="rda_+3A_y">Y</code></td>
<td>
<p>a matrix of y variables</p>
</td></tr>
<tr><td><code id="rda_+3A_scaling">scaling</code></td>
<td>
<p>scaling used for x and y variables. 0: x and y only centered. 1: x and y standardized</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Results are computed by doing a principal component analyis of the
fitted values of the regression of y on x.
</p>
<p>Plotting the first two columns of Gxs and Gyp, or of Gxp and Gys provides a biplots of 
the matrix of regression coefficients.
</p>
<p>Plotting the first two columns of Fs and Gp or of Fp and Gs provides a biplot of the
matrix of fitted values.
</p>


<h3>Value</h3>

<p>Returns a list with the following results
</p>
<table role = "presentation">
<tr><td><code>Yh</code></td>
<td>
<p> fitted values of the regression of y on x </p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p> regression coefficients of the regresson of y on x </p>
</td></tr>
<tr><td><code>decom</code></td>
<td>
<p> variance decomposition/goodness of fit of the fitted values AND of
the regression coefficients </p>
</td></tr>
<tr><td><code>Fs</code></td>
<td>
<p> biplot markers of the rows of Yh (standard coordinates) </p>
</td></tr>
<tr><td><code>Fp</code></td>
<td>
<p> biplot markers of the rows of Yh (principal coordinates) </p>
</td></tr>
<tr><td><code>Gys</code></td>
<td>
<p> biplot markers for the y variables (standard coordinates) </p>
</td></tr>
<tr><td><code>Gyp</code></td>
<td>
<p> biplot markers for the y variables (principal coordinates) </p>
</td></tr>
<tr><td><code>Gxs</code></td>
<td>
<p> biplot markers for the x variables (standard coordinates) </p>
</td></tr>
<tr><td><code>Gxp</code></td>
<td>
<p> biplot markers for the x variables (principal coordinates) </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Van den Wollenberg, A.L. (1977) Redundancy Analysis, an alternative for canonical 
correlation analysis. Psychometrika 42(2): pp. 207-219.
</p>
<p>Ter Braak, C. J. F. and Looman, C. W. N. (1994) Biplots in Reduced-Rank Regression.
Biometrical Journal 36(8): pp. 983-1003.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+princomp">princomp</a></code>,<code><a href="#topic+canocor">canocor</a></code>,<code><a href="stats.html#topic+biplot">biplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(rnorm(75),ncol=3)
Y &lt;- matrix(rnorm(75),ncol=3)
rda.results &lt;- rda(X,Y)
</code></pre>

<hr>
<h2 id='shiftvector'>
Compute a shift vector for a calibrated axis.
</h2><span id='topic+shiftvector'></span>

<h3>Description</h3>

<p><code>shiftvector</code> computes two shift vectors perpendicular to the
supplied biplot or scatterplot axis <code>g</code>. The vector norm is
computed from the two most extreme data points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiftvector(g, X, x = c(1, 0), verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shiftvector_+3A_g">g</code></td>
<td>
<p>a biplot or scatterplot axis</p>
</td></tr>
<tr><td><code id="shiftvector_+3A_x">X</code></td>
<td>
<p>a n by 2 matrix of scatterplot or biplot coordinates</p>
</td></tr>
<tr><td><code id="shiftvector_+3A_x">x</code></td>
<td>
<p>reference axis, (1,0) by default</p>
</td></tr>
<tr><td><code id="shiftvector_+3A_verbose">verbose</code></td>
<td>
<p>print information or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>shiftvector</code> locates the tow most extreme datapoints in the
direction perpendicular to axis <code>g</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dr</code></td>
<td>
<p>the right (w.r.t. the direction of <code>g</code>) shift vector</p>
</td></tr>
<tr><td><code>dl</code></td>
<td>
<p>the left (w.r.t. the direction of <code>g</code>) shift vector</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Graffelman, J. and van Eeuwijk, F.A. (2005) Calibration of multivariate scatter plots for 
exploratory analysis of relations within and between sets of variables in genomic research
Biometrical Journal, 47(6) pp. 863-879.
</p>
<p>Graffelman, J. (2006) A guide to biplot calibration.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calibrate">calibrate</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(rnorm(100),ncol=2)
Xs &lt;- scale(X)

g &lt;- c(1,1)

plot(Xs[,1],Xs[,2],asp=1,pch=19)
textxy(Xs[,1],Xs[,2],1:nrow(X))

arrows(0,0,g[1],g[2])
text(g[1],g[2],"g",pos=1)

out &lt;- shiftvector(g,X,verbose=TRUE)
dr &lt;- out$dr
dl &lt;- out$dl

arrows(0,0,dl[1],dl[2])
text(dl[1],dl[2],"dl",pos=1)

arrows(0,0,dr[1],dr[2])
text(dr[1],dr[2],"dr",pos=1)
</code></pre>

<hr>
<h2 id='spaindist'>Road distances between Spanish cities</h2><span id='topic+spaindist'></span>

<h3>Description</h3>

<p>Road distances in kilometers between 47 Spanish cities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spaindist)</code></pre>


<h3>Format</h3>

<p>A data frame containing 47 observations.</p>


<h3>References</h3>

<p>Graffelman, J. (2019) Goodness-of-fit filtering in classical metric multidimensional scaling with large
datasets. &lt;doi: 10.1101/708339&gt;
</p>

<hr>
<h2 id='storks'>Frequencies of nesting storks in Denmark</h2><span id='topic+storks'></span>

<h3>Description</h3>

<p>Danish data from 1953-1977 giving the frequency of nesting storks,
the human birth rate and the per capita electricity consumption.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(storks)</code></pre>


<h3>Format</h3>

<p>A data frame containing 25 observations.</p>


<h3>Source</h3>

<p>Gabriel and Odoroff, Table 1.</p>


<h3>References</h3>

<p>Gabriel, K. R. and Odoroff, C. L. (1990) Biplots in biomedical research.
<em>Statistics in Medicine</em> 9(5): pp. 469-485.
</p>

<hr>
<h2 id='textxy'> Nice placement of labels in a plot</h2><span id='topic+textxy'></span>

<h3>Description</h3>

<p>Function <code>textxy</code> calls function <code>text</code> in order to add text
to points in a graph. <code>textxy</code> chooses a different position 
for the text depending on the quadrant. This tends to 
produces better readable plots, with labels fanning away from the origin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>textxy(X, Y, labs, m = c(0, 0), cex = 0.5, offset = 0.8, ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="textxy_+3A_x">X</code></td>
<td>
<p>x coordinates of a set of points</p>
</td></tr>
<tr><td><code id="textxy_+3A_y">Y</code></td>
<td>
<p>y coordinates of a set of points</p>
</td></tr>
<tr><td><code id="textxy_+3A_labs">labs</code></td>
<td>
<p>labels to be placed next to the points</p>
</td></tr>
<tr><td><code id="textxy_+3A_m">m</code></td>
<td>
<p>coordinates of the origin of the plot (default (0,0))</p>
</td></tr>
<tr><td><code id="textxy_+3A_cex">cex</code></td>
<td>
<p>character expansion factor</p>
</td></tr>
<tr><td><code id="textxy_+3A_offset">offset</code></td>
<td>
<p>controls the distance between the label and the point. A
value of 0 will plot labels on top of the point. Larger values give
larger separation between point and label. The default value is 0.8</p>
</td></tr>
<tr><td><code id="textxy_+3A_...">...</code></td>
<td>
<p>additiona arguments for function <code>text</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL
</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p> Graffelman, J. (2006) A guide to biplot calibration. </p>


<h3>See Also</h3>

 <p><code><a href="graphics.html#topic+text">text</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(50)
y &lt;- rnorm(50)
plot(x,y,asp=1)
textxy(x,y,1:50,m=c(mean(x),mean(y)))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
