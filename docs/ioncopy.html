<!DOCTYPE html><html lang="en"><head><title>Help for package ioncopy</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ioncopy}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ioncopy-package'>
<p>Calling copy number alterations in amplicon sequencing data</p></a></li>
<li><a href='#assess.CNA'>
<p>Significance assessment of copy number alterations</p></a></li>
<li><a href='#calculate.CN'>
<p>Calculation of copy numbers</p></a></li>
<li><a href='#call.CNA'>
<p>Gene-wise or amplicon-wise calling of copy number alterations</p></a></li>
<li><a href='#coverage'>
<p>Coverage data of 154 amplicons in 184 breast carcinomas</p></a></li>
<li><a href='#heatmap.CNA'>
<p>Visualization of Copy Number and CNA Calls</p></a></li>
<li><a href='#read.coverages'>
<p>Helper function to read coverages from file system</p></a></li>
<li><a href='#runIoncopy'>
<p>Shiny app for Ioncopy</p></a></li>
<li><a href='#summarize.CNA'>
<p>Summary of CNA calls</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calling Copy Number Alterations in Amplicon Sequencing Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-08-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Jan Budczies, Eva Romanovsky</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Budczies &lt;jan.budczies@med.uni-heidelberg.de&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>shiny, zip</td>
</tr>
<tr>
<td>Description:</td>
<td>Method for the calculation of copy numbers and calling of copy number alterations. The algorithm uses coverage data from amplicon sequencing of a sample cohort as input. The method includes significance assessment, correction for multiple testing and does not depend on normal DNA controls. Budczies (2016 Mar 15) &lt;<a href="https://doi.org/10.18632%2Foncotarget.7451">doi:10.18632/oncotarget.7451</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-08-10 21:44:42 UTC; evka</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-08-11 14:50:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='ioncopy-package'>
Calling copy number alterations in amplicon sequencing data
</h2><span id='topic+ioncopy-package'></span><span id='topic+ioncopy'></span>

<h3>Description</h3>

<p>Method for the calculation of copy numbers and calling of copy number alterations. The algorithm uses coverage data from amplicon sequencing of a sample cohort as input. The method includes significance assessment, correction for multiple testing and does not depend on normal DNA controls.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> ioncopy</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.2.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-08-07</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Maintainer: Jan Budczies &lt;jan.budczies@med.uni-heidelberg.de&gt;<br />
Eva Romanovsky &lt;eva.romanovsky@rambler.ru&gt;
</p>


<h3>References</h3>

<p>Jan Budczies, Nicole Pfarr, Albrecht Stenzinger, Denise Treue, Volker Endris, Fakher Ismaeel, Nikola Bangemann, Jens-Uwe Blohmer, Manfred Dietel, Sibylle Loibl, Wilko Weichert, Carsten Denkert: <em>Ioncopy: a novel method for calling copy number alterations in amplicon sequencing data including significance assessment.</em> Oncotarget 7(11):13236-47, 2016, doi: 10.18632/oncotarget.7451.
</p>
<p>Jan Budczies, Nicole Pfarr, Eva Romanovsky, Volker Endris, Albrecht Stenzinger, and Carsten Denkert: <em>Ioncopy: an R Shiny app to call copy number alterations in targeted NGS data.</em> Submitted.
</p>

<hr>
<h2 id='assess.CNA'>
Significance assessment of copy number alterations
</h2><span id='topic+assess.CNA'></span>

<h3>Description</h3>

<p>Starting from a matrix of coverages, the corresponding matrix of copy numbers is calculated.
A null model for significance assessment of copy number alterations is fitted. Each amplicon
in each sample is assessed for significance. Summarized copy numbers and p-values for genes
are calculated as descibed below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assess.CNA(coverage.target, coverage.source=NULL, method.pooled="amplicon", thres.cov=100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assess.CNA_+3A_coverage.target">coverage.target</code></td>
<td>

<p>A numeric matrix containing the target coverages of each amplicon (rows) in each sample (columns).
The target data are investigated for copy number alterations.
</p>
</td></tr>
<tr><td><code id="assess.CNA_+3A_coverage.source">coverage.source</code></td>
<td>

<p>A numeric matrix containing the source coverages of each amplicon (rows) in each sample (columns).
The source data are used to fit a null model. If <code>NULL</code>, the target data are used to fit the
null model.
</p>
</td></tr>
<tr><td><code id="assess.CNA_+3A_method.pooled">method.pooled</code></td>
<td>

<p>Method used for the estimation of the null model. Either one common null model for all amplicons
(<code>pooled</code>) or individual null models for each of the amplicons (<code>amplicon</code>) are fitted.
</p>
</td></tr>
<tr><td><code id="assess.CNA_+3A_thres.cov">thres.cov</code></td>
<td>

<p>Theshold for the minimal mean coverage of an amplicon to be included in the analysis.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the following elements: Matrix of copy numbers with the estimated null model (<code>"model"</code>), estimates of copy numbers (<code>"CN.a"</code> and <code>"CN.g"</code>) for amplicons and genes as well as p-values of copy number alterations (<code>"P.a"</code> and <code>"P.g"</code>) for amplicons and genes. Copy numbers for genes are calculated as average of the copy numbers of all amplicons interrogating the gene, p-values for genes are calculated using Fisher's method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(coverage)
CNA &lt;- assess.CNA(coverage)

## End(Not run)

</code></pre>

<hr>
<h2 id='calculate.CN'>
Calculation of copy numbers
</h2><span id='topic+calculate.CN'></span>

<h3>Description</h3>

<p>Starting from a matrix of coverages, the corresponding matrix of copy numbers is calculated.
The caluculation includes a sample normalization step and a amplicon normalization step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate.CN(coverage, scale.amplicon=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate.CN_+3A_coverage">coverage</code></td>
<td>

<p>A numeric matrix containing the coverages of each amplicon (rows) in each sample (columns).
</p>
</td></tr>
<tr><td><code id="calculate.CN_+3A_scale.amplicon">scale.amplicon</code></td>
<td>

<p>Method for amplicon normalization. If <code>NULL</code> the scaling factors are estimated from <code>coverage</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of copy numbers with the amplicon scaling factors (<code>"scale.amplicon"</code>) as attribute.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(coverage)
CN &lt;- calculate.CN(coverage)

## End(Not run)

</code></pre>

<hr>
<h2 id='call.CNA'>
Gene-wise or amplicon-wise calling of copy number alterations
</h2><span id='topic+call.CNA'></span>

<h3>Description</h3>

<p>Copy number alteration calling after (possible) multiple testing correction for samples and/or amplicons/genes.
P-values are controlled either for the number of samples, the number of amplicons/genes or both.
Different methods of multiple testing can be chosen to control either FWER or FDR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>call.CNA(CNA, analysis.mode="gene-wise", method.p="samples_genes/amplicons",
method.mt="bonferroni", thres.p=0.05, sig.call=0, sig.per=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="call.CNA_+3A_cna">CNA</code></td>
<td>

<p>List of CNA assessments generated by <code><a href="#topic+assess.CNA">assess.CNA</a></code>.
</p>
</td></tr>
<tr><td><code id="call.CNA_+3A_analysis.mode">analysis.mode</code></td>
<td>

<p>The Mode of the analysis: (<code>"gene-wise"</code>) or (<code>"amplicon-wise"</code>)
</p>
</td></tr>
<tr><td><code id="call.CNA_+3A_method.p">method.p</code></td>
<td>

<p>The multiple testing method used for detection:
Usage of uncorrected p-values (<code>"p"</code>), p-values corrected for samples (<code>"p_samples"</code>),
p-values corrected for amplicons/genes (<code>"p_genes/amplicons"</code>) or p-values corrected for samples and
amplicons/genes (<code>"p_samples_genes/amplicons"</code>).
</p>
</td></tr>
<tr><td><code id="call.CNA_+3A_method.mt">method.mt</code></td>
<td>

<p>Method for multiple testing correction: must be equal to <code>bonferroni</code>, <code>holm</code>,
<code>hochberg</code>, <code>fdr</code>, <code>BH</code>, <code>BY</code>, <code>hommel</code> or <code>none</code>
as described in the package <code>stats</code>.
</p>
</td></tr>
<tr><td><code id="call.CNA_+3A_thres.p">thres.p</code></td>
<td>

<p>Significance level for calling of copy number alterations.
</p>
</td></tr>
<tr><td><code id="call.CNA_+3A_sig.call">sig.call</code></td>
<td>

<p>An integer &gt;= 0. Only used if <code>analysis.mode="gene-wise"</code>. Required minimum number of amplicons supporting a gene CNA call.
</p>
</td></tr>
<tr><td><code id="call.CNA_+3A_sig.per">sig.per</code></td>
<td>

<p>An integer &gt;= 0. Only used if <code>analysis.mode="gene-wise"</code>. Required minimum percentage of amplicons supporting a gene CNA call.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Table containing the status (GAIN, LOSS or NORMAL) of each amplicon or gene in each sample (<code>"tab"</code>). Matrix of copy number estimates in each sample and each amplicon or gene (<code>"CN"</code>). Indicator matrix of detected gains in each sample and each amplicon or gene (<code>"gain"</code>) and the same for losses (<code>"loss"</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(coverage)
CN &lt;- calculate.CN(coverage)
CNA &lt;- assess(CN)
calls &lt;- call.CNA(CNA)

## End(Not run)

</code></pre>

<hr>
<h2 id='coverage'>
Coverage data of 154 amplicons in 184 breast carcinomas
</h2><span id='topic+coverage'></span>

<h3>Description</h3>

<p>A matrix of sequencing coverages from semiconductor sequencing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(coverage)</code></pre>


<h3>Format</h3>

<p>Matrix containing the sequencing coverages of 154 samples (breast carcinomas)
and 184 variables (amplicons).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(coverage)
</code></pre>

<hr>
<h2 id='heatmap.CNA'>
Visualization of Copy Number and CNA Calls
</h2><span id='topic+heatmap.CNA'></span>

<h3>Description</h3>

<p>Heatmap visualization including optional hierarchical clustering of amplicons/genes and samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatmap.CNA(CNA, thres.percent=1, cluster.genes=TRUE, cluster.samples=TRUE,
type="CNA calls", method.dist="manhattan", method.link="average", mar=3, cex=0.50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="heatmap.CNA_+3A_cna">CNA</code></td>
<td>

<p>Indicator matrix of CNAs generated by <code><a href="#topic+call.CNA">call.CNA</a></code>.
</p>
</td></tr>
<tr><td><code id="heatmap.CNA_+3A_thres.percent">thres.percent</code></td>
<td>

<p>Number between 0 and 100. Only genes with a minimum percentage of
amplified and/or deleted samples are included into the heatmap.
</p>
</td></tr>
<tr><td><code id="heatmap.CNA_+3A_cluster.genes">cluster.genes</code></td>
<td>

<p>Logical value. If <code>TRUE</code> hierarchical cluster of genes is executed.
</p>
</td></tr>
<tr><td><code id="heatmap.CNA_+3A_cluster.samples">cluster.samples</code></td>
<td>

<p>Logical value. If <code>TRUE</code> hierarchical cluster of samples is executed.
</p>
</td></tr>
<tr><td><code id="heatmap.CNA_+3A_type">type</code></td>
<td>

<p>Heatmap of copy numbers <code>"Copy Number"</code> or CNA calls <code>"CNA Calls"</code>.
</p>
</td></tr>
<tr><td><code id="heatmap.CNA_+3A_method.dist">method.dist</code></td>
<td>

<p>Character. Method for calculation of the distance between genes/amplicons and between samples.
</p>
</td></tr>
<tr><td><code id="heatmap.CNA_+3A_method.link">method.link</code></td>
<td>

<p>Character. Linkage method to calculate the distance between clusters.
</p>
</td></tr>
<tr><td><code id="heatmap.CNA_+3A_mar">mar</code></td>
<td>

<p>Numeric value. Margins for row names and column names.
</p>
</td></tr>
<tr><td><code id="heatmap.CNA_+3A_cex">cex</code></td>
<td>

<p>Numerical value. Shrinkage factor for row names and column names.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on <code>"type"</code> heatmap of CNAs (color coding: LOSS=green, NORMAL=black, GAIN=red) or
heatmap of copy numbers (color coding CN&lt;1: green, CN&lt;2: darkgreen, CN&gt;3: darkred, CN&gt;4: red, CN&gt;5: orange, CN&gt;10: yellow).
</p>

<hr>
<h2 id='read.coverages'>
Helper function to read coverages from file system
</h2><span id='topic+read.coverages'></span>

<h3>Description</h3>

<p>Coverages are read from tab separated files and stored in a coverage matrix.
All coverage files need to refer to the same panel of targets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.coverages(chip.names, file.names, anno.col="Target")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.coverages_+3A_chip.names">chip.names</code></td>
<td>

<p>A character vector comprizing the chip names.
</p>
</td></tr>
<tr><td><code id="read.coverages_+3A_file.names">file.names</code></td>
<td>

<p>A character vector compizing the names of tab separated files.
Each file should contain the coverages of the same sequencing
panel (rows) in a cohort of samples (columns).
</p>
</td></tr>
<tr><td><code id="read.coverages_+3A_anno.col">anno.col</code></td>
<td>

<p>The column in input files that compizes the names of the targets.
The targets must belong to the same sequencing panel for all input files.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of coverages of each target sequence (rows) in each sample (colums).
</p>

<hr>
<h2 id='runIoncopy'>
Shiny app for Ioncopy
</h2><span id='topic+runIoncopy'></span>

<h3>Description</h3>

<p>Running Ioncopy as web application.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runIoncopy()
</code></pre>

<hr>
<h2 id='summarize.CNA'>
Summary of CNA calls
</h2><span id='topic+summarize.CNA'></span>

<h3>Description</h3>

<p>CNA calls are summarized to tables of all amplifications in each sample and to all amplifications in each amplicon/gene.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize.CNA(calls)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summarize.CNA_+3A_calls">calls</code></td>
<td>

<p>List of CNA calls generated by <code><a href="#topic+call.CNA">call.CNA</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of summary matrices for samples (<code>"samples"</code>) and amplicons (<code>"amplicon"</code>) or genes <code>"gene"</code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
