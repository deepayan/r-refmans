<!DOCTYPE html><html lang="en"><head><title>Help for package RmdConcord</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RmdConcord}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#commonmark_document'>
<p>R Markdown drivers to add concordance</p></a></li>
<li><a href='#html_with_concordance'>
<p>Convert an R Markdown driver to one that handles concordances.</p></a></li>
<li><a href='#processConcordance'>
<p>Get the concordance from the &quot;datapos&quot; values and record it in</p>
a file.</a></li>
<li><a href='#processLatexConcordance'>
<p>Process a LaTeX concordance file.</p></a></li>
<li><a href='#test_packages'>
<p>Test for sufficient versions of supporting packages</p></a></li>
<li><a href='#tidy_validate'>
<p>Reproduce tidy validation done in R 4.3.0.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Concordances for 'R Markdown'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Supports concordances in 'R Markdown' 
  documents.  This currently allows the original source
  location in the '.Rmd' file of errors detected by 'HTML tidy'
  to be found more easily, and potentially allows forward
  and reverse search in 'HTML' and 'LaTeX' documents
  produced from 'R Markdown'.  The 'LaTeX' support
  has been included in the most recent development 
  version of the 'patchDVI' package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/dmurdoch/RmdConcord">https://github.com/dmurdoch/RmdConcord</a>,
<a href="https://dmurdoch.github.io/RmdConcord/">https://dmurdoch.github.io/RmdConcord/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dmurdoch/RmdConcord/issues">https://github.com/dmurdoch/RmdConcord/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>rmarkdown, tools, knitr (&ge; 1.42)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>markdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>pandoc (&gt;=2.11.3 with 'commonmark_x' processing and
'sourcepos' extension, needed for 'rmarkdown' formats).</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-10 16:57:00 UTC; murdoch</td>
</tr>
<tr>
<td>Author:</td>
<td>Duncan Murdoch [aut, cre],
  Heather Turner [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Duncan Murdoch &lt;murdoch.duncan@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-10 17:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='commonmark_document'>
R Markdown drivers to add concordance
</h2><span id='topic+html_documentC'></span><span id='topic+html_vignetteC'></span><span id='topic+pdf_documentC0'></span><span id='topic+html_formatC'></span><span id='topic+latex_formatC'></span>

<h3>Description</h3>

<p>These drivers replace the like-named <span class="pkg">rmarkdown</span>
or <span class="pkg">markdown</span>
drivers with ones that output Commonmark rather than Pandoc Markdown.
Commonmark is a dialect of Markdown.  The Pandoc driver
for Commonmark supports output of source position information.
By using this function as your output driver, you can get that
in your own documents.
</p>
<p>A replacement for <code>markdown::latex_format</code> is not planned; see the note below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>html_documentC(sourcepos = TRUE, ...)
html_vignetteC(sourcepos = TRUE, ...)
pdf_documentC0(latex_engine = "pdflatex",
           sourcepos = TRUE,
           defineSconcordance = TRUE,
           ...)
html_formatC(options = list(sourcepos = TRUE), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="commonmark_document_+3A_latex_engine">latex_engine</code></td>
<td>

<p>Command to convert &lsquo;<span class="file">.tex</span>&rsquo; file to &lsquo;<span class="file">.pdf</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="commonmark_document_+3A_definesconcordance">defineSconcordance</code></td>
<td>

<p>If <code>TRUE</code>, insert a definition of the <code style="white-space: pre;">&#8288;\Sconcordance&#8288;</code>
macro just before <code style="white-space: pre;">&#8288;\begin{document}&#8288;</code>.
</p>
</td></tr>
<tr><td><code id="commonmark_document_+3A_sourcepos">sourcepos</code></td>
<td>
<p>Whether to include source position information.</p>
</td></tr>
<tr><td><code id="commonmark_document_+3A_options">options</code></td>
<td>

<p>The options argument to pass to the base driver.  If
<code>options$sourcepos</code> is not specified, it will default to
<code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="commonmark_document_+3A_...">...</code></td>
<td>

<p>Other arguments to pass to the base driver.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each driver modifies the standard driver from <span class="pkg">rmarkdown</span> or
<span class="pkg">markdown</span>, e.g.
<code>html_documentC</code> is similar to
<code><a href="rmarkdown.html#topic+html_document">html_document</a></code>, but uses Commonmark
and adds concordances.
</p>


<h3>Value</h3>

<p>An R Markdown output format object which will add concordance
information.
</p>


<h3>Note</h3>

<p>The <code>pdf_documentC0</code> function adds the concordances,
but they won't be interpreted by LaTeX or PDF previewers.
To get that to happen, use <code>patchDVI::pdf_documentC</code>.
</p>
<p>The <code>html_formatC</code> function requires <span class="pkg">markdown</span>
version 1.12.1 or higher.  If a lower version of that
package is installed
<code>html_formatC</code> will still run, but will issue a
warning and not add any concordances.
</p>
<p>The concordances produced by <code>html_formatC</code> tend to
be off by a few lines as the underlying Commonmark
processor only issues source position records once per
paragraph.
</p>
<p>A <code>latex_formatC</code> driver appears as if it would be
quite messy and is not currently planned.  The issues are:
</p>

<ul>
<li><p><span class="pkg">commonmark</span> doesn't support
source position attributes in LaTeX output
</p>
</li>
<li><p>It doesn't allow edits between the parsing and rendering steps.  This is what <code>pdf_documentC</code> does.
</p>
</li>
<li><p> A possible strategy would be to render first to XML
(which does keep source position attributes), then convert
the XML to LaTeX with macros inserted to record source
positions.  However, <code>markdown::latex_format</code> produces
the final LaTeX document in several steps, and would have to
support this two-stage rendering on some but not all of
the steps.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Duncan Murdoch
</p>

<hr>
<h2 id='html_with_concordance'>
Convert an R Markdown driver to one that handles concordances.
</h2><span id='topic+html_with_concordance'></span><span id='topic+pdf_with_concordance'></span>

<h3>Description</h3>

<p>These functions produce a new driver which matches the old
one in most respects, but adds an argument <code>sourcepos</code>
(and possibly others).
If that argument is <code>TRUE</code> (the default) then concordances
are handled by the new driver.
</p>
<p>These functions are used to produce <code><a href="#topic+html_documentC">html_documentC</a></code> and similar drivers
in this package, but should also work on other drivers that produce
HTML output using Pandoc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>html_with_concordance(driver)
pdf_with_concordance(driver)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="html_with_concordance_+3A_driver">driver</code></td>
<td>

<p>An R Markdown driver that produces HTML, LaTeX or PDF using Pandoc.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new driver function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>html_with_concordance(rmarkdown::html_fragment)
pdf_with_concordance(rmarkdown::latex_fragment)
</code></pre>

<hr>
<h2 id='processConcordance'>
Get the concordance from the &quot;datapos&quot; values and record it in
a file.
</h2><span id='topic+processConcordance'></span>

<h3>Description</h3>

<p>Pandoc can record concordance information in
<code>datapos</code> attributes
when converting Commonmark documents to HTML.  This retrieves
that information, and rewrites it as standard R concordance
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>processConcordance(filename, newfilename = filename,
                      rename = NULL,
                      followConcordance = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="processConcordance_+3A_filename">filename</code></td>
<td>

<p>The filename of the HTML file produced by Pandoc.
</p>
</td></tr>
<tr><td><code id="processConcordance_+3A_newfilename">newfilename</code></td>
<td>

<p>A filename in which to write the changed data.
</p>
</td></tr>
<tr><td><code id="processConcordance_+3A_rename">rename</code></td>
<td>

<p>A named character vector.  Names are the names in the <code>datapos</code>
attributes; values are the names that should be included in the
concordance instead. This might be used since <span class="pkg">knitr</span> produces a
Markdown file and renames it later.
</p>
</td></tr>
<tr><td><code id="processConcordance_+3A_followconcordance">followConcordance</code></td>
<td>

<p>If <code>filename</code> already contains concordance data, assume
that the Rmd file was produced automatically, and chain the
concordances.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for the side effect of rewriting the concordance, it returns
<code>newfilename</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This example works on the file inst/sample/Sample.Rmd,
# which should be a copy of the vignette Sample.Rmd.  This
# is convenient because RStudio doesn't install vignettes by default.

# First, see the results without concordances:

library(RmdConcord)
dir &lt;- tempdir()
intermediates &lt;- tempfile()

infile &lt;- system.file("sample/Sample.Rmd", package = "RmdConcord")
outfile1 &lt;- file.path(dir, "html_vignette.html")

rmarkdown::render(infile,
                  intermediates_dir = intermediates,
                  output_file = outfile1,
                  quiet = TRUE)
tidy_validate(outfile1)

# Next, see them with concordances by setting
# the output format to use RmdConcord::html_documentC
# which post-processes the document with processConcordance.

dir &lt;- tempdir()
outfile2 &lt;- file.path(dir, "commonmark.html")
rmarkdown::render(infile,
                  intermediates_dir = intermediates,
                  output_file = outfile2,
                  output_format = html_documentC(),
                  quiet = TRUE)
tidy_validate(outfile2)
unlink(c(intermediates, outfile1, outfile2), recursive = TRUE)
</code></pre>

<hr>
<h2 id='processLatexConcordance'>
Process a LaTeX concordance file.
</h2><span id='topic+processLatexConcordance'></span>

<h3>Description</h3>

<p>Pandoc can record concordance information in <code>\datapos</code> macros
when converting Commonmark documents to LaTeX.  This retrieves
that information, and rewrites it as standard R concordance
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>processLatexConcordance(filename,
                        newfilename = filename,
                        rename = NULL,
                        followConcordance = NULL,
                        defineSconcordance = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="processLatexConcordance_+3A_filename">filename</code></td>
<td>

<p>The filename of the LaTeX file produced by Pandoc.
</p>
</td></tr>
<tr><td><code id="processLatexConcordance_+3A_newfilename">newfilename</code></td>
<td>

<p>A filename in which to write the changed data.
</p>
</td></tr>
<tr><td><code id="processLatexConcordance_+3A_rename">rename</code></td>
<td>

<p>A named character vector.  Names are the names in the <code>datapos</code>
attributes; values are the names that should be included in the
concordance instead. This might be used since <span class="pkg">knitr</span> produces a
Markdown file and renames it later.
</p>
</td></tr>
<tr><td><code id="processLatexConcordance_+3A_followconcordance">followConcordance</code></td>
<td>

<p>If <code>filename</code> already contains concordance data, assume
that the Rmd file was produced automatically, and chain the
concordances.
</p>
</td></tr>
<tr><td><code id="processLatexConcordance_+3A_definesconcordance">defineSconcordance</code></td>
<td>

<p>Whether to insert the definition of the <code style="white-space: pre;">&#8288;\Sconcordance&#8288;</code> macro.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for the side effect of rewriting the concordance, it returns
<code>newfilename</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch
</p>

<hr>
<h2 id='test_packages'>
Test for sufficient versions of supporting packages
</h2><span id='topic+test_packages'></span>

<h3>Description</h3>

<p>This function tests for the presence of packages
that will support <span class="pkg">RmdConcord</span> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_packages(error = TRUE, pandoc = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test_packages_+3A_error">error</code></td>
<td>
<p>If <code>TRUE</code>, missing
requirements will result in an error.  If <code>FALSE</code>, they result in a warning.</p>
</td></tr>
<tr><td><code id="test_packages_+3A_pandoc">pandoc</code></td>
<td>
<p>Is Pandoc needed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value indicating that the
requirements are present.  Will never return
<code>FALSE</code> if <code>error</code> is  <code>TRUE</code>,
it will just trigger an error.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test_packages()
</code></pre>

<hr>
<h2 id='tidy_validate'>
Reproduce tidy validation done in R 4.3.0.
</h2><span id='topic+tidy_validate'></span>

<h3>Description</h3>

<p>This function is taken from R-devel, to test the
use of <span class="pkg">RmdConcord</span> in checking packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidy_validate(f, tidy = "tidy")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tidy_validate_+3A_f">f</code></td>
<td>

<p>An &lsquo;<span class="file">HTML</span>&rsquo; file to test.
</p>
</td></tr>
<tr><td><code id="tidy_validate_+3A_tidy">tidy</code></td>
<td>

<p>The name of the <code>HTML Tidy</code> executable.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object showing issues in the file and
locations in the source file.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
