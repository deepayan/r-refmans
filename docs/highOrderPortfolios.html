<!DOCTYPE html><html lang="en"><head><title>Help for package highOrderPortfolios</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {highOrderPortfolios}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#highOrderPortfolios-package'><p>highOrderPortfolios: Design of High-Order Portfolios via Mean, Variance, Skewness, and Kurtosis</p></a></li>
<li><a href='#design_MVSK_portfolio_via_sample_moments'><p>Design high-order portfolio based on weighted linear combination of first four moments</p></a></li>
<li><a href='#design_MVSK_portfolio_via_skew_t'><p>Design MVSK portfolio without shorting based on the parameters of generalized hyperbolic skew-t distribution</p></a></li>
<li><a href='#design_MVSKtilting_portfolio_via_sample_moments'><p>Design high-order portfolio by tilting a given portfolio to the MVSK efficient frontier</p></a></li>
<li><a href='#estimate_sample_moments'><p>Estimate first four moment parameters of multivariate observations</p></a></li>
<li><a href='#estimate_skew_t'><p>Estimate the parameters of skew-t distribution from multivariate observations</p></a></li>
<li><a href='#eval_portfolio_moments'><p>Evaluate first four moments of a given portfolio</p></a></li>
<li><a href='#X100'><p>Synthetic 500x100 matrix dataset</p></a></li>
<li><a href='#X200'><p>Synthetic 1000x200 matrix dataset</p></a></li>
<li><a href='#X50'><p>Synthetic 250x50 matrix dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Design of High-Order Portfolios Including Skewness and Kurtosis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-20</td>
</tr>
<tr>
<td>Description:</td>
<td>The classical Markowitz's mean-variance portfolio formulation ignores 
    heavy tails and skewness. High-order portfolios use higher order moments to
    better characterize the return distribution. Different formulations and fast 
    algorithms are proposed for high-order portfolios based on the mean, variance, 
    skewness, and kurtosis.
    The package is based on the papers:
    R. Zhou and D. P. Palomar (2021). "Solving High-Order Portfolios via 
    Successive Convex Approximation Algorithms." &lt;<a href="https://doi.org/10.48550/arXiv.2008.00863">doi:10.48550/arXiv.2008.00863</a>&gt;.
    X. Wang, R. Zhou, J. Ying, and D. P. Palomar (2022). "Efficient and Scalable 
    High-Order Portfolios Design via Parametric Skew-t Distribution." &lt;<a href="https://doi.org/10.48550/arXiv.2206.02412">doi:10.48550/arXiv.2206.02412</a>&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel P. Palomar &lt;daniel.p.palomar@gmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/dppalomar/highOrderPortfolios">https://github.com/dppalomar/highOrderPortfolios</a>,
<a href="https://www.danielppalomar.com">https://www.danielppalomar.com</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dppalomar/highOrderPortfolios/issues">https://github.com/dppalomar/highOrderPortfolios/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>ECOSolveR, lpSolveAPI, nloptr, PerformanceAnalytics, quadprog,
fitHeavyTail (&ge; 0.1.4), stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, ggplot2, rmarkdown, R.rsp, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown, R.rsp</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-20 10:07:10 UTC; palomar</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel P. Palomar [cre, aut],
  Rui Zhou [aut],
  Xiwen Wang [aut]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-20 11:35:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='highOrderPortfolios-package'>highOrderPortfolios: Design of High-Order Portfolios via Mean, Variance, Skewness, and Kurtosis</h2><span id='topic+highOrderPortfolios-package'></span>

<h3>Description</h3>

<p>The classical Markowitz's mean-variance portfolio formulation ignores 
heavy tails and skewness. High-order portfolios use higher order moments to
better characterize the return distribution. Different formulations and fast 
algorithms are proposed for high-order portfolios based on the mean, variance, 
skewness, and kurtosis.
</p>


<h3>Functions</h3>

<p><code><a href="#topic+design_MVSK_portfolio_via_sample_moments">design_MVSK_portfolio_via_sample_moments</a>()</code>, <code><a href="#topic+design_MVSK_portfolio_via_skew_t">design_MVSK_portfolio_via_skew_t</a>()</code>,
and <code><a href="#topic+design_MVSKtilting_portfolio_via_sample_moments">design_MVSKtilting_portfolio_via_sample_moments</a>()</code>
</p>


<h3>Help</h3>

<p>For a quick help see the README file:
<a href="https://github.com/dppalomar/highOrderPortfolios/blob/master/README.md">GitHub-README</a>.
</p>


<h3>Author(s)</h3>

<p>Rui Zhou, Xiwen Wang, and Daniel P. Palomar
</p>


<h3>References</h3>

<p>R. Zhou and D. P. Palomar, &quot;Solving High-Order Portfolios via Successive Convex Approximation Algorithms,&quot; 
in <em>IEEE Transactions on Signal Processing</em>, vol. 69, pp. 892-904, 2021.
&lt;https://doi.org/10.1109/TSP.2021.3051369&gt;.
</p>
<p>X. Wang, R. Zhou, J. Ying, and D. P. Palomar, &quot;Efficient and Scalable High-Order Portfolios Design via Parametric Skew-t Distribution,&quot; 
Available in arXiv, 2022. &lt;https://arxiv.org/pdf/2206.02412.pdf&gt;.
</p>

<hr>
<h2 id='design_MVSK_portfolio_via_sample_moments'>Design high-order portfolio based on weighted linear combination of first four moments</h2><span id='topic+design_MVSK_portfolio_via_sample_moments'></span>

<h3>Description</h3>

<p>Design high-order portfolio based on weighted linear combination of first four moments
(i.e., mean, variance, skewness, and kurtosis):
</p>
<pre>
  minimize     - lmd1*(w'*mu) + lmd2*(w'*Sigma*w) 
               - lmd3*(w'*Phi*w*w) + lmd4*(w'*Psi*w*w*w)
  subject to   ||w||_1 &lt;= leverage, sum(w) == 1.
</pre>


<h3>Usage</h3>

<pre><code class='language-R'>design_MVSK_portfolio_via_sample_moments(
  lmd = rep(1, 4),
  X_moments,
  w_init = rep(1/length(X_moments$mu), length(X_moments$mu)),
  leverage = 1,
  method = c("Q-MVSK", "MM", "DC"),
  tau_w = 0,
  gamma = 1,
  zeta = 1e-08,
  maxiter = 100,
  ftol = 1e-05,
  wtol = 1e-04,
  stopval = -Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_lmd">lmd</code></td>
<td>
<p>Numerical vector of length 4 indicating the weights of first four moments.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_x_moments">X_moments</code></td>
<td>
<p>List of moment parameters, see <code><a href="#topic+estimate_sample_moments">estimate_sample_moments</a>()</code>.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_w_init">w_init</code></td>
<td>
<p>Numerical vector indicating the initial value of portfolio weights.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_leverage">leverage</code></td>
<td>
<p>Number (&gt;= 1) indicating the leverage of portfolio.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_method">method</code></td>
<td>
<p>String indicating the algorithm method, must be one of: &quot;Q-MVSK&quot;, &quot;MM&quot;, &quot;DC&quot;.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_tau_w">tau_w</code></td>
<td>
<p>Number (&gt;= 0) guaranteeing the strong convexity of approximating function.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_gamma">gamma</code></td>
<td>
<p>Number (0 &lt; gamma &lt;= 1) indicating the initial value of gamma.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_zeta">zeta</code></td>
<td>
<p>Number (0 &lt; zeta &lt; 1) indicating the diminishing paramater of gamma.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_maxiter">maxiter</code></td>
<td>
<p>Positive integer setting the maximum iteration.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_ftol">ftol</code></td>
<td>
<p>Positive number setting the convergence criterion of function objective.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_wtol">wtol</code></td>
<td>
<p>Positive number setting the convergence criterion of portfolio weights.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_sample_moments_+3A_stopval">stopval</code></td>
<td>
<p>Number setting the stop value of objective.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>w</code></td>
<td>
<p>Optimal portfolio vector.</p>
</td></tr>
<tr><td><code>cpu_time_vs_iterations</code></td>
<td>
<p>Time usage over iterations.</p>
</td></tr>
<tr><td><code>objfun_vs_iterations</code></td>
<td>
<p>Objective function over iterations.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>Iterations index.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>Boolean flag to indicate whether or not the optimization converged.</p>
</td></tr>
<tr><td><code>moments</code></td>
<td>
<p>Moments of portfolio return at optimal portfolio weights.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rui Zhou and Daniel P. Palomar
</p>


<h3>References</h3>

<p>R. Zhou and D. P. Palomar, &quot;Solving High-Order Portfolios via Successive Convex Approximation Algorithms,&quot; 
in <em>IEEE Transactions on Signal Processing</em>, vol. 69, pp. 892-904, 2021.
&lt;doi:10.1109/TSP.2021.3051369&gt;.
</p>
<p>X. Wang, R. Zhou, J. Ying, and D. P. Palomar, &quot;Efficient and Scalable High-Order Portfolios Design via Parametric Skew-t Distribution,&quot; 
Available in arXiv, 2022. &lt;https://arxiv.org/pdf/2206.02412v1.pdf&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(highOrderPortfolios)
data(X50)

# estimate moments
X_moments &lt;- estimate_sample_moments(X50[, 1:10])

# decide moment weights
xi &lt;- 10
lmd &lt;- c(1, xi/2, xi*(xi+1)/6, xi*(xi+1)*(xi+2)/24)

# portfolio optimization
sol &lt;- design_MVSK_portfolio_via_sample_moments(lmd, X_moments)

</code></pre>

<hr>
<h2 id='design_MVSK_portfolio_via_skew_t'>Design MVSK portfolio without shorting based on the parameters of generalized hyperbolic skew-t distribution</h2><span id='topic+design_MVSK_portfolio_via_skew_t'></span>

<h3>Description</h3>

<p>Design MVSK portfolio without shorting based on the parameters of generalized hyperbolic skew-t distribution:
</p>
<pre>
  minimize     - lambda1*phi1(w) + lambda2*phi2(w)
               - lambda3*phi3(w) + lambda4*phi4(w)
  subject to   w&gt;=0, sum(w) == 1.
</pre>


<h3>Usage</h3>

<pre><code class='language-R'>design_MVSK_portfolio_via_skew_t(
  lambda,
  X_skew_t_params,
  w_init = rep(1/length(X_skew_t_params$mu), length(X_skew_t_params$mu)),
  method = c("L-MVSK", "DC", "Q-MVSK", "SQUAREM", "RFPA", "PGD"),
  gamma = 1,
  zeta = 1e-08,
  tau_w = 0,
  beta = 0.5,
  tau = 1e+05,
  initial_eta = 5,
  maxiter = 1000,
  ftol = 1e-06,
  wtol = 1e-06,
  stopval = -Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_lambda">lambda</code></td>
<td>
<p>Numerical vector of length 4 indicating the weights of first four moments.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_x_skew_t_params">X_skew_t_params</code></td>
<td>
<p>List of fitted parameters, including location vector, skewness vector, scatter matrix, and the degree of freedom,
see <code><a href="#topic+estimate_skew_t">estimate_skew_t</a>()</code>.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_w_init">w_init</code></td>
<td>
<p>Numerical vector indicating the initial value of portfolio weights.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_method">method</code></td>
<td>
<p>String indicating the algorithm method, must be one of: &quot;L-MVSK&quot;, &quot;DC&quot;, &quot;Q-MVSK&quot;, &quot;SQUAREM&quot;, &quot;RFPA&quot;, &quot;PGD&quot;.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_gamma">gamma</code></td>
<td>
<p>Number (0 &lt; gamma &lt;= 1) indicating the initial value of gamma for the Q-MVSK method.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_zeta">zeta</code></td>
<td>
<p>Number (0 &lt; zeta &lt; 1) indicating the diminishing parameter of gamma for the Q-MVSK method.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_tau_w">tau_w</code></td>
<td>
<p>Number (&gt;= 0) guaranteeing the strong convexity of approximating function.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_beta">beta</code></td>
<td>
<p>Number (0 &lt; beta &lt; 1) decreasing the step size of the projected gradient methods.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_tau">tau</code></td>
<td>
<p>Number (tau &gt; 0) hyper-parameters for the fixed-point acceleration.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_initial_eta">initial_eta</code></td>
<td>
<p>Initial eta for projected gradient methods</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_maxiter">maxiter</code></td>
<td>
<p>Positive integer setting the maximum iteration.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_ftol">ftol</code></td>
<td>
<p>Positive number setting the convergence criterion of function objective.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_wtol">wtol</code></td>
<td>
<p>Positive number setting the convergence criterion of portfolio weights.</p>
</td></tr>
<tr><td><code id="design_MVSK_portfolio_via_skew_t_+3A_stopval">stopval</code></td>
<td>
<p>Number setting the stop value of objective.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>w</code></td>
<td>
<p>Optimal portfolio vector.</p>
</td></tr>
<tr><td><code>cpu_time_vs_iterations</code></td>
<td>
<p>Time usage over iterations.</p>
</td></tr>
<tr><td><code>objfun_vs_iterations</code></td>
<td>
<p>Objective function over iterations.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>Iterations index.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>Boolean flag to indicate whether or not the optimization converged.</p>
</td></tr>
<tr><td><code>moments</code></td>
<td>
<p>Moments of portfolio return at optimal portfolio weights.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Xiwen Wang, Rui Zhou and Daniel P. Palomar
</p>


<h3>References</h3>

<p>X. Wang, R. Zhou, J. Ying, and D. P. Palomar, &quot;Efficient and Scalable High-Order Portfolios Design via Parametric Skew-t Distribution,&quot;
Available in arXiv, 2022. &lt;https://arxiv.org/pdf/2206.02412.pdf&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(highOrderPortfolios)
data(X50)

# estimate skew t distribution
X_skew_t_params &lt;- estimate_skew_t(X50)

# decide moment weights
xi &lt;- 10
lambda &lt;- c(1, 4, 10, 20)

# portfolio optimization
sol &lt;- design_MVSK_portfolio_via_skew_t(lambda, X_skew_t_params, method = "RFPA", tau = 10)

</code></pre>

<hr>
<h2 id='design_MVSKtilting_portfolio_via_sample_moments'>Design high-order portfolio by tilting a given portfolio to the MVSK efficient frontier</h2><span id='topic+design_MVSKtilting_portfolio_via_sample_moments'></span>

<h3>Description</h3>

<p>Design high-order portfolio by tilting a given portfolio to the MVSK efficient frontier
(i.e., mean, variance, skewness, and kurtosis):
</p>
<pre>
  minimize     - delta
               m1(w) &gt;= m1(w0) + delta*d1
               m2(w) &lt;= m2(w0) - delta*d2
               m3(w) &gt;= m3(w0) + delta*d3
               m4(w) &lt;= m4(w0) - delta*d4
               (w-w0)'Sigma(w-w0) &lt;= kappa^2
  subject to   ||w||_1 &lt;= leverage, sum(w) == 1.
</pre>


<h3>Usage</h3>

<pre><code class='language-R'>design_MVSKtilting_portfolio_via_sample_moments(
  d = rep(1, 4),
  X_moments,
  w_init = rep(1/length(X_moments$mu), length(X_moments$mu)),
  w0 = w_init,
  w0_moments = NULL,
  leverage = 1,
  kappa = 0,
  method = c("Q-MVSKT", "L-MVSKT"),
  tau_w = 1e-05,
  tau_delta = 1e-05,
  gamma = 1,
  zeta = 1e-08,
  maxiter = 100,
  ftol = 1e-05,
  wtol = 1e-05,
  theta = 0.5,
  stopval = -Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_d">d</code></td>
<td>
<p>Numerical vector of length 4 indicating the weights of first four moments.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_x_moments">X_moments</code></td>
<td>
<p>List of moment parameters, see <code><a href="#topic+estimate_sample_moments">estimate_sample_moments</a>()</code>.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_w_init">w_init</code></td>
<td>
<p>Numerical vector indicating the initial value of portfolio weights.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_w0">w0</code></td>
<td>
<p>Numerical vector indicating the reference portfolio vector.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_w0_moments">w0_moments</code></td>
<td>
<p>Numerical vector indicating the reference moments.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_leverage">leverage</code></td>
<td>
<p>Number (&gt;= 1) indicating the leverage of portfolio.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_kappa">kappa</code></td>
<td>
<p>Number indicating the maximum tracking error volatility.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_method">method</code></td>
<td>
<p>String indicating the algorithm method, must be one of: &quot;Q-MVSK&quot;, &quot;MM&quot;, &quot;DC&quot;.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_tau_w">tau_w</code></td>
<td>
<p>Number (&gt;= 0) guaranteeing the strong convexity of approximating function.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_tau_delta">tau_delta</code></td>
<td>
<p>Number (&gt;= 0) guaranteeing the strong convexity of approximating function.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_gamma">gamma</code></td>
<td>
<p>Number (0 &lt; gamma &lt;= 1) indicating the initial value of gamma.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_zeta">zeta</code></td>
<td>
<p>Number (0 &lt; zeta &lt; 1) indicating the diminishing paramater of gamma.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_maxiter">maxiter</code></td>
<td>
<p>Positive integer setting the maximum iteration.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_ftol">ftol</code></td>
<td>
<p>Positive number setting the convergence criterion of function objective.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_wtol">wtol</code></td>
<td>
<p>Positive number setting the convergence criterion of portfolio weights.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_theta">theta</code></td>
<td>
<p>Number (0 &lt; theta &lt; 1) setting the combination coefficient when enlarge feasible set.</p>
</td></tr>
<tr><td><code id="design_MVSKtilting_portfolio_via_sample_moments_+3A_stopval">stopval</code></td>
<td>
<p>Number setting the stop value of objective.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>w</code></td>
<td>
<p>Optimal portfolio vector.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>Maximum tilting distance of the optimal portfolio.</p>
</td></tr>
<tr><td><code>cpu_time_vs_iterations</code></td>
<td>
<p>Time usage over iterations.</p>
</td></tr>
<tr><td><code>objfun_vs_iterations</code></td>
<td>
<p>Objective function over iterations.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>Iterations index.</p>
</td></tr>
<tr><td><code>moments</code></td>
<td>
<p>Moments of portfolio return at optimal portfolio weights.</p>
</td></tr>
<tr><td><code>improvement</code></td>
<td>
<p>The relative improvement of moments of designed portfolio w.r.t. the reference portfolio.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rui Zhou and Daniel P. Palomar
</p>


<h3>References</h3>

<p>R. Zhou and D. P. Palomar, &quot;Solving High-Order Portfolios via Successive Convex Approximation Algorithms,&quot; 
in <em>IEEE Transactions on Signal Processing</em>, vol. 69, pp. 892-904, 2021.
&lt;doi:10.1109/TSP.2021.3051369&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(highOrderPortfolios)
data(X50)

# estimate moments
X_moments &lt;- estimate_sample_moments(X50[, 1:10])

# decide problem setting
w0 &lt;- rep(1/10, 10)
w0_moments &lt;- eval_portfolio_moments(w0, X_moments)
d &lt;- abs(w0_moments) 
kappa &lt;- 0.3 * sqrt(w0 %*% X_moments$Sgm %*% w0)

# portfolio optimization
sol &lt;- design_MVSKtilting_portfolio_via_sample_moments(d, X_moments, w_init = w0, w0 = w0, 
                                                       w0_moments = w0_moments, kappa = kappa)


</code></pre>

<hr>
<h2 id='estimate_sample_moments'>Estimate first four moment parameters of multivariate observations</h2><span id='topic+estimate_sample_moments'></span>

<h3>Description</h3>

<p>Estimate first four moments of multivariate observations, namely,
mean vector, covariance matrix, coskewness matrix, and cokurtosis matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_sample_moments(X, adjust_magnitude = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_sample_moments_+3A_x">X</code></td>
<td>
<p>Data matrix.</p>
</td></tr>
<tr><td><code id="estimate_sample_moments_+3A_adjust_magnitude">adjust_magnitude</code></td>
<td>
<p>Boolean indicating whether to adjust the order of magnitude of parameters.
Note: this is specially designed for the function <code><a href="#topic+design_MVSKtilting_portfolio_via_sample_moments">design_MVSKtilting_portfolio_via_sample_moments</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>Mean vector.</p>
</td></tr>
<tr><td><code>Sgm</code></td>
<td>
<p>Covariance matrix.</p>
</td></tr>
<tr><td><code>Phi_mat</code></td>
<td>
<p>Co-skewness matrix.</p>
</td></tr>
<tr><td><code>Psi_mat</code></td>
<td>
<p>Co-kurtosis matrix.</p>
</td></tr>
<tr><td><code>Phi</code></td>
<td>
<p>Co-skewness matrix in vector form (collecting only the unique elements).</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>Co-kurtosis matrix in vector form (collecting only the unique elements).</p>
</td></tr>
<tr><td><code>Phi_shred</code></td>
<td>
<p>Partition on <code>Phi</code> (see reference).</p>
</td></tr>
<tr><td><code>Psi_shred</code></td>
<td>
<p>Partition on <code>Psi</code> (see reference).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rui Zhou and Daniel P. Palomar
</p>


<h3>References</h3>

<p>R. Zhou and D. P. Palomar, &quot;Solving High-Order Portfolios via Successive Convex Approximation Algorithms,&quot; 
in <em>IEEE Transactions on Signal Processing</em>, vol. 69, pp. 892-904, 2021.
&lt;doi:10.1109/TSP.2021.3051369&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(highOrderPortfolios)
data(X50)

X_moments &lt;- estimate_sample_moments(X50[, 1:10])


</code></pre>

<hr>
<h2 id='estimate_skew_t'>Estimate the parameters of skew-t distribution from multivariate observations</h2><span id='topic+estimate_skew_t'></span>

<h3>Description</h3>

<p>Using the package fitHeavyTail to estimate the parameters of ghMST distribution from multivariate observations, namely,
location vector (mu), skewness vector (gamma), scatter matrix (scatter), degree of freedom (nu), parameters a,
and the Cholesky decomposition of the scatter matrix (chol_Sigma).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_skew_t(
  X,
  initial = NULL,
  nu_lb = 9,
  max_iter = 100,
  ptol = 0.001,
  ftol = Inf,
  PXEM = TRUE,
  return_iterates = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_skew_t_+3A_x">X</code></td>
<td>
<p>Data matrix containing the multivariate time series (each column is one time series).</p>
</td></tr>
<tr><td><code id="estimate_skew_t_+3A_initial">initial</code></td>
<td>
<p>List of initial values of the parameters for the iterative estimation method.
Possible elements include:
</p>
<ul>
<li><p><code>nu</code>: default is <code>4</code>,
</p>
</li>
<li><p><code>mu</code>: default is the data sample mean,
</p>
</li>
<li><p><code>gamma</code>: default is the sample skewness vector,
</p>
</li>
<li><p><code>scatter</code>: default follows from the scaled sample covariance matrix,
</p>
</li></ul>
</td></tr>
<tr><td><code id="estimate_skew_t_+3A_nu_lb">nu_lb</code></td>
<td>
<p>Minimum value for the degree of freedom to maintain the existence of high-order moments (default is <code>9</code>).</p>
</td></tr>
<tr><td><code id="estimate_skew_t_+3A_max_iter">max_iter</code></td>
<td>
<p>Integer indicating the maximum number of iterations for the iterative estimation
method (default is <code>100</code>).</p>
</td></tr>
<tr><td><code id="estimate_skew_t_+3A_ptol">ptol</code></td>
<td>
<p>Positive number indicating the relative tolerance for the change of the variables
to determine convergence of the iterative method (default is <code>1e-3</code>).</p>
</td></tr>
<tr><td><code id="estimate_skew_t_+3A_ftol">ftol</code></td>
<td>
<p>Positive number indicating the relative tolerance for the change of the log-likelihood
value to determine convergence of the iterative method (default is <code>Inf</code>, so it is
not active). Note that using this argument might have a computational cost as a convergence
criterion due to the computation of the log-likelihood (especially when <code>X</code> is high-dimensional).</p>
</td></tr>
<tr><td><code id="estimate_skew_t_+3A_pxem">PXEM</code></td>
<td>
<p>Logical value indicating whether to use the parameter expansion (PX) EM method to accelerating the convergence.</p>
</td></tr>
<tr><td><code id="estimate_skew_t_+3A_return_iterates">return_iterates</code></td>
<td>
<p>Logical value indicating whether to record the values of the parameters (and possibly the
log-likelihood if <code>ftol &lt; Inf</code>) at each iteration (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="estimate_skew_t_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether to allow the function to print messages (default is <code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>Location vector estimate (not the mean).</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Skewness vector estimate.</p>
</td></tr>
<tr><td><code>scatter</code></td>
<td>
<p>Scatter matrix estimate.</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>Degrees of freedom estimate.</p>
</td></tr>
<tr><td><code>chol_Sigma</code></td>
<td>
<p>Choleski decomposition of the Scatter matrix estimate.</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>A list of coefficients useful for later computation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Xiwen Wang, Rui Zhou, and Daniel P. Palomar
</p>


<h3>References</h3>

<p>Aas, Kjersti and Ingrid Hobæk Haff. &quot;The generalized hyperbolic skew student’st-distribution,&quot;
Journal of financial econometrics, pp. 275-309, 2006.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(highOrderPortfolios)
data("X50")
X_skew_t_params &lt;- estimate_skew_t(X50)

</code></pre>

<hr>
<h2 id='eval_portfolio_moments'>Evaluate first four moments of a given portfolio</h2><span id='topic+eval_portfolio_moments'></span>

<h3>Description</h3>

<p>Evaluate first four moments of a given portfolio's return, namely,
mean, variance, skewness, and kurtosis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_portfolio_moments(w, X_statistics)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eval_portfolio_moments_+3A_w">w</code></td>
<td>
<p>Numerical vector with portfolio weights.</p>
</td></tr>
<tr><td><code id="eval_portfolio_moments_+3A_x_statistics">X_statistics</code></td>
<td>
<p>Argument characterizing the constituents assets. 
Either the sample parameters as obtained by function <code><a href="#topic+estimate_sample_moments">estimate_sample_moments</a>()</code> or
the multivariate skew t parameters as obtained by function <code><a href="#topic+estimate_skew_t">estimate_skew_t</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Four moments of the given portfolio.
</p>


<h3>Author(s)</h3>

<p>Rui Zhou, Xiwen Wang, and Daniel P. Palomar
</p>


<h3>References</h3>

<p>R. Zhou and D. P. Palomar, &quot;Solving High-Order Portfolios via Successive Convex Approximation Algorithms,&quot; 
in <em>IEEE Transactions on Signal Processing</em>, vol. 69, pp. 892-904, 2021.
&lt;doi:10.1109/TSP.2021.3051369&gt;.
</p>
<p>X. Wang, R. Zhou, J. Ying, and D. P. Palomar, &quot;Efficient and Scalable High-Order Portfolios Design via Parametric Skew-t Distribution,&quot; 
Available in arXiv, 2022. &lt;https://arxiv.org/pdf/2206.02412v1.pdf&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(highOrderPortfolios)
data(X50)

# nonparametric case
X_moments &lt;- estimate_sample_moments(X50[, 1:10])
w_moments &lt;- eval_portfolio_moments(w = rep(1/10, 10), X_statistics = X_moments)

# parametric case (based on the multivariate skew t distribution)
X_skew_t_params &lt;- estimate_skew_t(X50[, 1:10])
w_moments &lt;- eval_portfolio_moments(w = rep(1/10, 10), X_statistics = X_skew_t_params)


</code></pre>

<hr>
<h2 id='X100'>Synthetic 500x100 matrix dataset</h2><span id='topic+X100'></span>

<h3>Description</h3>

<p>Synthetic 500x100 matrix dataset containing 500 realizations
of 100 variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(X100)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>xts</code> (inherits from <code>zoo</code>) with 500 rows and 100 columns.
</p>

<hr>
<h2 id='X200'>Synthetic 1000x200 matrix dataset</h2><span id='topic+X200'></span>

<h3>Description</h3>

<p>Synthetic 1000x200 matrix dataset containing 1000 realizations
of 200 variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(X200)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>xts</code> (inherits from <code>zoo</code>) with 1000 rows and 100 columns.
</p>

<hr>
<h2 id='X50'>Synthetic 250x50 matrix dataset</h2><span id='topic+X50'></span>

<h3>Description</h3>

<p>Synthetic 250x50 matrix dataset containing 250 realizations
of 50 variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(X50)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 250 rows and 50 columns.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
