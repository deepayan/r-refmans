<!DOCTYPE html><html lang="en"><head><title>Help for package immer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {immer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#immer-package'>
<p>Item Response Models for Multiple Ratings</p></a></li>
<li><a href='#data.immer'>
<p>Some Example Datasets for the <span class="pkg">immer</span> Package</p></a></li>
<li><a href='#data.ptam'>
<p>Example Datasets for Robitzsch and Steinfeld (2018)</p></a></li>
<li><a href='#immer_agree2'>
<p>Agreement Statistics for 2 Raters</p></a></li>
<li><a href='#immer_ccml'>
<p>Composite Conditional Maximum Likelihood Estimation for the Partial Credit Model</p>
with a Design Matrix for Item Parameters</a></li>
<li><a href='#immer_cml'>
<p>Conditional Maximum Likelihood Estimation for the Linear Logistic</p>
Partial Credit Model</a></li>
<li><a href='#immer_FACETS'>
<p>Wrapper to FACDOS</p></a></li>
<li><a href='#immer_hrm'>
<p>Hierarchical Rater Model (Patz et al., 2002)</p></a></li>
<li><a href='#immer_hrm_simulate'>
<p>Simulating the Hierarchical Rater Model (Patz et al., 2002)</p></a></li>
<li><a href='#immer_install'>
<p>Support for the installation of the DOS-version from FACETS</p></a></li>
<li><a href='#immer_jml'>
<p>Joint Maximum Likelihood Estimation for the Partial Credit Model</p>
with a Design Matrix for Item Parameters
and <code class="reqn">\varepsilon</code>-Adjustment Bias Correction</a></li>
<li><a href='#immer_latent_regression'>
<p>Unidimensional Latent Regression</p></a></li>
<li><a href='#immer_opcat'>
<p>Estimation of Integer Item Discriminations</p></a></li>
<li><a href='#immer_proc_data'>
<p>Processing Datasets and Creating Design Matrices for Rating Data</p></a></li>
<li><a href='#immer_reshape_wideformat'>
<p>Creating a Rating Dataset in Wide Format</p></a></li>
<li><a href='#immer_unique_patterns'>
<p>Extracts Unique Item Response Patterns</p></a></li>
<li><a href='#lc2_agreement'>
<p>A Latent Class Model for Agreement of Two Raters</p></a></li>
<li><a href='#probs2logits'>
<p>Conversion of Probabilities into Logits</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Item Response Models for Multiple Ratings</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5-13</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-21 15:57:11</td>
</tr>
<tr>
<td>Author:</td>
<td>
    Alexander Robitzsch [aut, cre], Jan Steinfeld [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexander Robitzsch &lt;robitzsch@ipn.uni-kiel.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Implements some item response models for multiple
    ratings, including the hierarchical rater model, 
    conditional maximum likelihood estimation of linear 
    logistic partial credit model and a wrapper function
    to the commercial FACETS program. See Robitzsch and
    Steinfeld (2018) for a description of the functionality
    of the package. 
    See Wang, Su and Qiu (2014; &lt;<a href="https://doi.org/10.1111%2Fjedm.12045">doi:10.1111/jedm.12045</a>&gt;)
    for an overview of modeling alternatives.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0-0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>CDM, coda, graphics, methods, psychotools, Rcpp, sirt, stats,
TAM</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS</td>
</tr>
<tr>
<td>Enhances:</td>
<td>eRm, lme4</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/alexanderrobitzsch/immer">https://github.com/alexanderrobitzsch/immer</a>,
<a href="https://sites.google.com/site/alexanderrobitzsch2/software">https://sites.google.com/site/alexanderrobitzsch2/software</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-21 14:59:23 UTC; sunpn563</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-21 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='immer-package'>
Item Response Models for Multiple Ratings
</h2><span id='topic+immer-package'></span><span id='topic+immer'></span>

<h3>Description</h3>


<p>    Implements some item response models for multiple
    ratings, including the hierarchical rater model, 
    conditional maximum likelihood estimation of linear 
    logistic partial credit model and a wrapper function
    to the commercial FACETS program. See Robitzsch and
    Steinfeld (2018) for a description of the functionality
    of the package. 
    See Wang, Su and Qiu (2014; &lt;doi:10.1111/jedm.12045&gt;)
    for an overview of modeling alternatives.
</p>


<h3>Details</h3>

<p>The <span class="pkg">immer</span> package has following features: 
</p>
   
<ul>
<li><p> Estimation of the hierarchical rater model (Patz et al., 2002) with 
<code><a href="#topic+immer_hrm">immer_hrm</a></code> and simulation of it with <code><a href="#topic+immer_hrm_simulate">immer_hrm_simulate</a></code>.
</p>
</li>
<li><p> The linear logistic partial credit model as an extension to the 
linear logistic test model (LLTM) for dichotomous data can be estimated with
conditional maximum likelihood (Andersen, 1995) using <code><a href="#topic+immer_cml">immer_cml</a></code>.
</p>
</li>
<li><p> The linear logistic partial credit model can be estimated with
composite conditional maximum likelihood (Varin, Reid &amp; Firth, 2011) using the
<code><a href="#topic+immer_ccml">immer_ccml</a></code> function. 
</p>
</li>
<li><p> The linear logistic partial credit model can be estimated with a bias-corrected 
joint maximum likelihood method (Bertoli-Barsotti, Lando &amp; Punzo, 2014)
using the <code><a href="#topic+immer_jml">immer_jml</a></code> function.  
</p>
</li>
<li><p> Wrapper function <code><a href="#topic+immer_FACETS">immer_FACETS</a></code> to the commercial
program FACETS (Linacre, 1999) for analyzing multi-faceted Rasch models.
</p>
</li>
<li> <p>...
</p>
</li></ul>



<h3>Author(s)</h3>


<p>    Alexander Robitzsch [aut, cre], Jan Steinfeld [aut]
</p>
<p>Maintainer: Alexander Robitzsch &lt;robitzsch@ipn.uni-kiel.de&gt;
</p>


<h3>References</h3>

<p>Andersen, E. B. (1995). Polytomous Rasch models and their estimation.
In G. H. Fischer &amp; I. W. Molenaar (Eds.). <em>Rasch Models</em> (pp. 39-52).
New York: Springer.    
</p>
<p>Bertoli-Barsotti, L., Lando, T., &amp; Punzo, A. (2014). Estimating a Rasch Model via 
fuzzy empirical probability functions. In D. Vicari, A. Okada, G. Ragozini &amp; 
C. Weihs (Eds.). 
<em>Analysis and Modeling of Complex Data in Behavioral and Social Sciences</em>, 
Springer.
</p>
<p>Linacre, J. M. (1999). <em>FACETS</em> (Version 3.17)[Computer software]. Chicago: MESA.
</p>
<p>Patz, R. J., Junker, B. W., Johnson, M. S., &amp; Mariano, L. T. (2002). 
The hierarchical rater model for rated test items and its 
application to large-scale educational assessment data. 
<em>Journal of Educational and Behavioral Statistics, 27</em>(4), 341-384.
</p>
<p>Robitzsch, A., &amp; Steinfeld, J. (2018). Item response models for human ratings: Overview, 
estimation methods, and implementation in R. 
<em>Psychological Test and Assessment Modeling, 60</em>(1), 101-139.
</p>
<p>Varin, C., Reid, N., &amp; Firth, D. (2011). An overview of composite likelihood methods. 
<em>Statistica Sinica, 21</em>, 5-42.
</p>
<p>Wang, W. C., Su, C. M., &amp; Qiu, X. L. (2014). Item response models for local dependence 
among multiple ratings. <em>Journal of Educational Measurement, 51</em>(3), 260-280.
</p>


<h3>See Also</h3>

<p>For estimating the Rasch multi-facets model with marginal
maximum likelihood see also the
<code><a href="TAM.html#topic+tam.mml.mfr">TAM::tam.mml.mfr</a></code> and
<code><a href="sirt.html#topic+rm.facets">sirt::rm.facets</a></code> functions.
</p>
<p>For estimating the hierarchical rater model based on signal
detection theory see <code><a href="sirt.html#topic+rm.sdt">sirt::rm.sdt</a></code>.
</p>
<p>For conditional maximum likelihood estimation of linear logistic
partial credit models see the <span class="pkg">eRm</span> (e.g. <code><a href="eRm.html#topic+LPCM">eRm::LPCM</a></code>)
and the <span class="pkg">psychotools</span> (e.g. <code><a href="psychotools.html#topic+pcmodel">psychotools::pcmodel</a></code>)
packages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   
  ##  
  ##  
  ##  immer 0.0-16 (2015-06-27)
  ##  
  ##   
  ##      #@#################################################################@   
  ##     :#@##################################################################`  
  ##     #####################################################################+  
  ##     #####################################################################@  
  ##    .##########@###########################################################` 
  ##    +######@+;'@##########################################################@: 
  ##    ######'     +@########################################################## 
  ##    #####+ ##'  `##########################################################@ 
  ##    ####@ ####  +@#@##################################################@##### 
  ##   .#####.#####@######@#########@#@######@@####@##@############@######@#####`
  ##   :####+:###@:,@##@,;##@+@##@+'###@;.'##@##@##@''@#####@@'+@###,;##@;######.
  ##   ;####@ @##   ##@  ,;    :,    .#    ':    :.    ,@@#'     ';   ,+   @####.
  ##   '#####`:##   #@   : ''    ++   @@;  ` +;    +'   #@' `+@   #@  .    #####,
  ##   +######, #   : ,   @#@   +#@  `##,   @#@   @##  `#@  `##   @#`  +,  @####:
  ##   +#######@@  :+@`  ;##'  `##@  .@#   +##:  `###  .@.  @#+   #:  .##@@#####:
  ##   '########:  ##@   @#@,  ;##;  ;#@   @##`  +##,  +#       `@#`  ##########,
  ##   ;########   @##   ###`  @##`  @#+  `###   @##   ##   ,;'@##@   @#########,
  ##   :#######@  `##+  ,##@   @#@   @#,  '##@   ##@   @@  `#######  `##########.
  ##   .#######+  ,##.  @##+  `##@  .##`  @##;  ,##@  `##   ###; #;  :#@,+###### 
  ##    #######'    #   @##:  ,##;  ;##   @##`  +###   `@:     `;#.  @@:  ###### 
  ##    #######@,`,##.`,###,..###,  #@#..,##@,..####:` +#@'  ``#+#` `@#+ :#####@ 
  ##    #########################:   ,###################@#####@###@#@#########@ 
  ##    '########################@+;+##########################################: 
  ##    ,######################################################################` 
  ##     ##@##################################################################@  
</code></pre>

<hr>
<h2 id='data.immer'>
Some Example Datasets for the <span class="pkg">immer</span> Package
</h2><span id='topic+data.immer01a'></span><span id='topic+data.immer01b'></span><span id='topic+data.immer02'></span><span id='topic+data.immer03'></span><span id='topic+data.immer04a'></span><span id='topic+data.immer04b'></span><span id='topic+data.immer05'></span><span id='topic+data.immer06'></span><span id='topic+data.immer07'></span><span id='topic+data.immer08'></span><span id='topic+data.immer09'></span><span id='topic+data.immer10'></span><span id='topic+data.immer11'></span><span id='topic+data.immer12'></span>

<h3>Description</h3>

<p>Some example rating datasets for the <span class="pkg">immer</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data.immer01a)
data(data.immer01b)
data(data.immer02)
data(data.immer03)
data(data.immer04a)
data(data.immer04b)
data(data.immer05)
data(data.immer06)
data(data.immer07)
data(data.immer08)
data(data.immer09)
data(data.immer10)
data(data.immer11)
data(data.immer12)
</code></pre>


<h3>Format</h3>


<ul>
<li><p> The format of the dataset <code>data.immer01a</code> is:
</p>
<p><code>'data.frame':   23904 obs. of  8 variables:</code> <br />
<code> $ idstud: int  10001 10001 10003 10003 10003 10004 10004 10005 10005 10006 ...</code> <br />
<code> $ type  : Factor w/ 2 levels "E","I": 1 2 1 1 2 1 2 1 2 1 ...</code> <br />
<code> $ rater : Factor w/ 57 levels "R101","R102",..: 1 36 33 20 21 57 36 9 31 21 ...</code> <br />
<code> $ k1    : int  2 1 0 0 0 2 2 1 2 0 ...</code> <br />
<code> $ k2    : int  1 1 0 0 0 1 1 1 2 0 ...</code> <br />
<code> $ k3    : int  1 1 0 0 0 1 1 1 2 1 ...</code> <br />
<code> $ k4    : int  2 2 1 0 0 1 1 1 2 1 ...</code> <br />
<code> $ k5    : int  1 2 0 0 0 2 1 2 3 2 ...</code> <br />
</p>
</li>
<li><p> The format of the dataset <code>data.immer01b</code> is:
</p>
<p><code>'data.frame':   4244 obs. of  8 variables:</code> <br />
<code> $ idstud: int  10001 10003 10005 10007 10009 10016 10018 10022 10024 10029 ...</code> <br />
<code> $ type  : Factor w/ 1 level "E": 1 1 1 1 1 1 1 1 1 1 ...</code> <br />
<code> $ rater : Factor w/ 20 levels "R101","R102",..: 1 20 9 5 14 19 20 6 10 10 ...</code> <br />
<code> $ k1    : int  2 0 1 2 2 2 3 1 3 2 ...</code> <br />
<code> $ k2    : int  1 0 1 2 2 1 3 2 2 1 ...</code> <br />
<code> $ k3    : int  1 0 1 1 3 2 2 1 3 1 ...</code> <br />
<code> $ k4    : int  2 0 1 2 3 2 2 2 3 2 ...</code> <br />
<code> $ k5    : int  1 0 2 1 3 1 2 3 3 1 ...</code>
</p>
<p>This dataset is a subset of <code>data.immer01a</code>. <br />
</p>
</li>
<li><p> The format of the dataset <code>data.immer02</code> is:
</p>
<p><code>'data.frame':   6105 obs. of  6 variables:</code> <br />
<code> $ idstud: int  10002 10004 10005 10006 10007 10008 10009 10010 10013 10014 ...</code> <br />
<code> $ rater : Factor w/ 44 levels "DR101","DR102",..: 43 15 12 21 9 3 35 24 11 17 ...</code> <br />
<code> $ a1    : int  3 1 2 1 0 2 1 2 1 1 ...</code> <br />
<code> $ a2    : int  3 0 3 1 0 3 0 2 2 1 ...</code> <br />
<code> $ a3    : int  1 2 0 1 2 3 2 2 1 1 ...</code> <br />
<code> $ a4    : int  2 1 2 1 1 3 1 2 2 1 ...</code> <br />
</p>
</li>
<li><p> The format of the dataset <code>data.immer03</code> is:
</p>
<p><code>'data.frame':   6466 obs. of  6 variables:</code> <br />
<code> $ idstud: int  10001 10002 10003 10004 10005 10006 10007 10009 10010 10012 ...</code> <br />
<code> $ rater : Factor w/ 44 levels "R101","R102",..: 18 10 8 25 19 31 16 22 29 6 ...</code> <br />
<code> $ b1    : int  1 2 1 3 3 2 3 2 2 1 ...</code> <br />
<code> $ b2    : int  2 1 0 3 3 1 1 2 2 1 ...</code> <br />
<code> $ b3    : int  2 3 1 2 3 1 2 2 2 2 ...</code> <br />
<code> $ b4    : int  1 2 0 2 2 2 3 2 3 1 ...</code> <br />
</p>
</li>
<li><p> The format of the dataset <code>data.immer04a</code> is:
</p>
<p><code>'data.frame':   25578 obs. of  7 variables:</code> <br />
<code> $ idstud: int  10001 10001 10001 10002 10002 10002 10003 10003 10004 10004 ...</code> <br />
<code> $ task  : Factor w/ 4 levels "l1","l2","s1",..: 1 4 4 1 1 3 1 3 2 2 ...</code> <br />
<code> $ rater : Factor w/ 43 levels "R101","R102",..: 14 31 25 39 35 19 43 27 12 4 ...</code> <br />
<code> $ TA    : int  5 2 4 0 0 0 2 6 5 3 ...</code> <br />
<code> $ CC    : int  4 1 3 1 0 0 2 6 4 3 ...</code> <br />
<code> $ GR    : int  4 1 2 1 0 0 1 7 5 2 ...</code> <br />
<code> $ VOC   : int  4 2 3 1 0 0 1 6 5 3 ...</code> <br />
</p>
</li>
<li><p> The format of the dataset <code>data.immer04b</code> is:
</p>
<p><code>'data.frame':   2975 obs. of  7 variables:</code> <br />
<code> $ idstud: int  10002 10004 10010 10013 10015 10016 10024 10025 10027 10033 ...</code> <br />
<code> $ task  : Factor w/ 1 level "s1": 1 1 1 1 1 1 1 1 1 1 ...</code> <br />
<code> $ rater : Factor w/ 20 levels "R101","R102",..: 19 1 5 16 13 13 8 10 19 5 ...</code> <br />
<code> $ TA    : int  0 3 5 5 3 2 3 6 4 5 ...</code> <br />
<code> $ CC    : int  0 3 4 5 4 1 4 7 3 3 ...</code> <br />
<code> $ GR    : int  0 3 3 6 5 2 3 6 3 2 ...</code> <br />
<code> $ VOC   : int  0 2 4 6 5 2 3 6 3 2 ...</code>
</p>
<p>This dataset is a subset of <code>data.immer04a</code>. <br />
</p>
</li>
<li><p> The format of the dataset <code>data.immer05</code> is:
</p>
<p><code>'data.frame':   21398 obs. of  9 variables:</code> <br />
<code> $ idstud     : int  10001 10001 10002 10002 10003 10003 10004 10004 10005 10005 ...</code> <br />
<code> $ type       : Factor w/ 2 levels "l","s": 2 1 2 1 2 1 2 1 2 1 ...</code> <br />
<code> $ task       : Factor w/ 6 levels "l1","l4","l5",..: 5 2 6 3 5 1 5 1 5 2 ...</code> <br />
<code> $ rater      : Factor w/ 41 levels "ER101","ER102",..: 1 40 38 23 37 33 2 33 21 27 ...</code> <br />
<code> $ idstud_task: Factor w/ 19484 levels "10001l4","10001s3",..: 2 1 4 3 6 5 8 7 10 9 ...</code> <br />
<code> $ TA         : int  3 4 6 6 4 2 0 3 1 3 ...</code> <br />
<code> $ CC         : int  5 4 5 5 3 3 0 2 5 3 ...</code> <br />
<code> $ GR         : int  4 4 5 6 5 3 0 4 5 4 ...</code> <br />
<code> $ VO         : int  6 4 6 6 4 3 0 3 4 3 ...</code> <br />
</p>
</li>
<li><p> The dataset <code>data.immer06</code> is a string containing
an input syntax for the FACETS program.
</p>
</li>
<li><p> The format of the dataset <code>data.immer07</code> is:
</p>
<p><code>'data.frame':   1500 obs. of  6 variables:</code> <br />
<code> $ pid  : int  1 1 1 2 2 2 3 3 3 4 ...</code> <br />
<code> $ rater: chr  "R1" "R2" "R3" "R1" ...</code> <br />
<code> $ I1   : num  1 1 2 1 1 1 0 1 1 2 ...</code> <br />
<code> $ I2   : num  0 1 1 2 1 2 1 1 2 1 ...</code> <br />
<code> $ I3   : num  1 1 2 0 0 1 1 0 2 1 ...</code> <br />
<code> $ I4   : num  0 0 1 0 0 1 0 1 2 0 ...</code> <br />
</p>
</li>
<li><p> The format of the dataset <code>data.immer08</code> (example in
Schuster &amp; Smith, 2006) is
</p>
<p><code>'data.frame':   16 obs. of  3 variables:</code> <br />
<code> $ Facility: int  1 1 1 1 2 2 2 2 3 3 ...</code> <br />
<code> $ Research: int  1 2 3 4 1 2 3 4 1 2 ...</code> <br />
<code> $ weights : int  40 6 4 15 4 25 1 5 4 2 ...</code> <br />
</p>
</li>
<li><p> The dataset <code>data.immer09</code> contains reviewer ratings for
conference papers (Kuhlisch et al., 2016):
</p>
<p><code>'data.frame':   128 obs. of  3 variables:</code> <br />
<code> $ idpaper   : int  1 1 1 2 2 3 3 3 4 4 ...</code> <br />
<code> $ idreviewer: int  11 15 20 1 10 11 15 20 13 16 ...</code> <br />
<code> $ score     : num  7 7 7 7 7 7 7 7 7 7 ...</code> <br />
</p>
</li>
<li><p> The dataset <code>data.immer10</code> contains standard setting
ratings of 13 raters on 61 items (including item identifier <code>item</code>
and item difficulty <code>itemdiff</code>)
</p>
<p><code>'data.frame':   61 obs. of  15 variables:</code> <br />
<code> $ item    : chr  "I01" "I02" "I03" "I04" ...</code> <br />
<code> $ itemdiff: num  380 388 397 400 416 425 427 434 446 459 ...</code> <br />
<code> $ R01     : int  1 3 2 2 1 3 2 2 3 1 ...</code> <br />
<code> $ R02     : int  1 1 1 1 1 2 1 2 2 1 ...</code> <br />
<code> $ R03     : int  1 1 1 1 1 1 2 2 3 1 ...</code> <br />
<code> $ R04     : int  1 2 1 3 2 2 2 2 3 2 ...</code> <br />
<code> $ R05     : int  1 1 2 1 1 1 2 2 3 2 ...</code> <br />
<code> $ R06     : int  1 2 1 1 1 2 2 2 3 2 ...</code> <br />
<code> $ R07     : int  1 2 1 2 1 1 2 1 3 1 ...</code> <br />
<code> $ R08     : int  2 2 1 2 1 1 2 2 3 2 ...</code> <br />
<code> $ R09     : int  2 1 1 2 1 2 1 2 3 1 ...</code> <br />
<code> $ R10     : int  2 2 2 2 1 2 2 3 3 2 ...</code> <br />
<code> $ R11     : int  2 2 1 2 1 2 2 2 3 2 ...</code> <br />
<code> $ R12     : int  2 2 1 3 1 2 2 2 3 2 ...</code> <br />
<code> $ R13     : int  1 1 1 1 1 1 1 1 2 1 ...</code> <br />
</p>
</li>
<li><p> The dataset <code>data.immer11</code> contains ratings of 148 cases (screening
mammogram samples) diagnoses by 110 raters (Zhang &amp; Petersen, xxxx). The codes of the
polytomous rating are normal (code 0), benign (code 1), probably benign (code 2),
possibly malignant (code 3), and probably malignant (code 4). The dataset was extracted
from an image plot in Figure 2 by using the processing function
<code>png::readPNG</code>. The format of the dataset is
</p>
<p><code>'data.frame':   148 obs. of  110 variables:</code> <br />
<code> $ R001: num  2 1 3 2 1 2 0 0 0 2 ...</code> <br />
<code> $ R002: num  1 3 4 4 0 4 0 0 3 0 ...</code> <br />
<code> $ R003: num  0 0 0 4 0 2 3 0 0 0 ...</code> <br />
<code> $ R004: num  1 2 1 4 2 2 2 0 4 4 ...</code> <br />
<code> [... ]</code> <br />
</p>
</li>
<li><p> The dataset <code>data.immer12</code> contains ratings of the 2002 olympic pairs
figure skating competition. This dataset has been used in Lincare (2009).  The items
are <code>ST</code> (short program, technical merit),
<code>SA</code> (short program, artistic impression),
<code>FT</code> (free program, technical merit), and
<code>FA</code> (free program, artistic impression). The format of the dataset is
</p>
<p><code>'data.frame':   180 obs. of  7 variables:</code> <br />
<code> $ idpair: int  1 1 1 1 1 1 1 1 1 2 ...</code> <br />
<code> $ pair  : chr  "BB-Svk" "BB-Svk" "BB-Svk" "BB-Svk" ...</code> <br />
<code> $ judge : chr  "RUS" "CHI" "USA" "FRA" ...</code> <br />
<code> $ ST    : int  58 57 57 56 55 55 50 51 51 47 ...</code> <br />
<code> $ SA    : int  58 57 57 56 55 55 50 51 51 47 ...</code> <br />
<code> $ FT    : int  58 57 57 56 55 55 50 51 51 47 ...</code> <br />
<code> $ FA    : int  58 57 57 56 55 55 50 51 51 47 ...</code> <br />
</p>
</li></ul>



<h3>References</h3>

<p>Kuhlisch, W., Roos, M., Rothe, J., Rudolph, J., Scheuermann, B., &amp;
Stoyan, D. (2016). A statistical approach to calibrating the scores of
biased reviewers of scientific papers.
<em>Metrika, 79</em>, 37-57.
</p>
<p>Linacre, J. M. (2009). Local independence and residual covariance: A study of
Olympic figure skating ratings. <em>Journal of Applied Measurement, 10</em>(2), 157-169.
</p>
<p>Schuster, C., &amp; Smith, D. A. (2006). Estimating with a latent
class model the reliability of nominal judgments upon which
two raters agree. <em>Educational and Psychological Measurement, 66</em>(5), 739-747.
</p>
<p>Zhang, S., &amp; Petersen, J. H. (XXXX). Quantifying rater variation for ordinal data using
a rating scale model. <em>Statistics in Medicine, XX</em>(xx), xxx-xxx.
</p>

<hr>
<h2 id='data.ptam'>
Example Datasets for Robitzsch and Steinfeld (2018)
</h2><span id='topic+data.ptam1'></span><span id='topic+data.ptam2'></span><span id='topic+data.ptam3'></span><span id='topic+data.ptam4'></span><span id='topic+data.ptam4long'></span><span id='topic+data.ptam4wide'></span>

<h3>Description</h3>

<p>Example datasets for Robitzsch and Steinfeld (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data.ptam1)
data(data.ptam2)
data(data.ptam3)
data(data.ptam4)
data(data.ptam4long)
data(data.ptam4wide)
</code></pre>


<h3>Format</h3>


<ul>
<li><p> The dataset <code>data.ptam1</code> is a subset of the dataset from Example 3
of the ConQuest manual and
contains 9395 ratings for 6877 students and 9 raters
on 2 items (<code>OP</code> and <code>TF</code>). The format is
</p>
<p><code>'data.frame':   9395 obs. of  4 variables:</code> <br />
<code> $ pid  : int  1508 1564 1565 1566 1567 1568 1569 1629 1630 1631 ...</code> <br />
<code> $ rater: num  174 124 124 124 124 124 124 114 114 114 ...</code> <br />
<code> $ OP   : int  2 1 2 1 1 1 2 2 2 3 ...</code> <br />
<code> $ TF   : int  3 1 2 2 1 1 2 2 2 3 ...</code> <br />
</p>
</li>
<li><p> The dataset <code>data.ptam2</code> contains 1043 ratings for
262 students and 17 raters on 19 items (<code>A1</code>, ..., <code>D9</code>). The format is
</p>
<p><code>'data.frame':   1043 obs. of  21 variables:</code> <br />
<code> $ idstud : int  1001 1001 1001 1001 1002 1002 1002 1002 1003 1003 ...</code> <br />
<code> $ idrater: int  101 108 212 215 104 108 209 211 103 104 ...</code> <br />
<code> $ A1     : int  1 1 1 1 1 1 1 1 1 1 ...</code> <br />
<code> $ A2     : int  1 1 1 1 0 0 0 1 1 1 ...</code> <br />
<code> $ A3     : int  1 1 1 1 1 1 0 1 0 0 ...</code> <br />
<code> [...]</code> <br />
<code> $ D9     : int  2 2 2 2 2 2 2 2 1 0 ...</code> <br />
</p>
</li>
<li><p> The dataset <code>data.ptam3</code> contains 523 ratings for
262 students and 8 raters on 23 items (<code>A1</code>, ..., <code>J0</code>). The format is
</p>
<p><code>'data.frame':   523 obs. of  25 variables:</code> <br />
<code> $ idstud : int  1001 1001 1002 1002 1003 1003 1004 1004 1005 1005 ...</code> <br />
<code> $ idrater: int  101 108 104 108 103 104 102 104 102 108 ...</code> <br />
<code> $ A1     : int  1 1 1 1 1 1 1 1 1 1 ...</code> <br />
<code> $ A2     : int  1 1 0 0 1 1 NA 0 1 1 ...</code> <br />
<code> $ A3     : int  1 1 1 1 0 0 0 0 0 0 ...</code> <br />
<code> [...]</code> <br />
<code> $ J0     : int  2 3 3 2 0 0 2 2 0 1 ...</code> <br />
</p>
</li>
<li><p> The dataset <code>data.ptam4</code> contains 592 ratings for
209 students and 10 raters on 3 items (<code>crit2</code>, <code>crit3</code> and
<code>crit4</code>). The format is
</p>
<p><code>'data.frame':   592 obs. of  5 variables:</code> <br />
<code> $ idstud: num  10005 10009 10010 10010 10014 ...</code> <br />
<code> $ rater : num  802 802 844 802 837 824 820 803 816 844 ...</code> <br />
<code> $ crit2 : int  3 2 0 2 1 0 2 1 1 0 ...</code> <br />
<code> $ crit3 : int  3 2 1 2 2 2 2 2 2 2 ...</code> <br />
<code> $ crit4 : int  2 1 2 1 2 2 2 2 2 2 ...</code> <br />
</p>
</li>
<li><p> The dataset <code>data.ptam4long</code> is the dataset <code>data.ptam4</code> which has been
converted into a long format for analysis with mixed effects models in the
<span class="pkg">lme4</span> package. The format is
</p>
<p><code>'data.frame':   1776 obs. of  17 variables:</code> <br />
<code> $ idstud : num  10005 10005 10005 10009 10009 ...</code> <br />
<code> $ rater  : num  802 802 802 802 802 802 844 802 844 802 ...</code> <br />
<code> $ item   : Factor w/ 3 levels "crit2","crit3",..: 1 2 3 1 2 3 1 1 2 2 ...</code> <br />
<code> $ value  : int  3 3 2 2 2 1 0 2 1 2 ...</code> <br />
<code> $ I_crit2: num  1 0 0 1 0 0 1 1 0 0 ...</code> <br />
<code> $ I_crit3: num  0 1 0 0 1 0 0 0 1 1 ...</code> <br />
<code> $ I_crit4: num  0 0 1 0 0 1 0 0 0 0 ...</code> <br />
<code> $ R_802  : num  1 1 1 1 1 1 0 1 0 1 ...</code> <br />
<code> $ R_803  : num  0 0 0 0 0 0 0 0 0 0 ...</code> <br />
<code> [...] </code> <br />
<code> $ R_844  : num  0 0 0 0 0 0 1 0 1 0 ...</code> <br />
</p>
</li>
<li><p> The dataset <code>data.ptam4wide</code> contains multiple ratings of
40 students from the dataset <code>data.ptam4</code> from the item <code>crit2</code>.
Each column corresponds to one rater. The format is
</p>
<p><code>'data.frame':   40 obs. of  11 variables:</code> <br />
<code> $ pid : chr  "10014" "10085" "10097" "10186" ...</code> <br />
<code> $ R802: int  2 3 2 2 2 1 1 2 2 2 ...</code> <br />
<code> $ R803: int  1 1 3 1 2 0 0 0 1 0 ...</code> <br />
<code> $ R810: int  1 2 2 2 1 0 1 1 2 1 ...</code> <br />
<code> $ R816: int  1 2 3 2 2 0 1 1 2 1 ...</code> <br />
<code> $ R820: int  2 2 2 2 1 1 1 1 1 1 ...</code> <br />
<code> $ R824: int  0 3 2 3 2 0 0 1 2 1 ...</code> <br />
<code> $ R831: int  1 2 2 2 1 0 0 0 1 1 ...</code> <br />
<code> $ R835: int  0 1 2 2 1 1 0 0 2 1 ...</code> <br />
<code> $ R837: int  1 2 3 2 2 0 1 1 2 2 ...</code> <br />
<code> $ R844: int  0 2 3 2 2 0 0 0 1 3 ...</code> <br />
</p>
</li></ul>



<h3>References</h3>

<p>Robitzsch, A., &amp; Steinfeld, J. (2018). Item response models for human ratings: Overview,
estimation methods, and implementation in R.
<em>Psychological Test and Assessment Modeling, 60</em>(1), 101-139.
</p>

<hr>
<h2 id='immer_agree2'>
Agreement Statistics for 2 Raters
</h2><span id='topic+immer_agree2'></span><span id='topic+summary.immer_agree2'></span>

<h3>Description</h3>

<p>Some agreement statistics for two raters, including raw
agreement, Scott's Pi, Cohen's Kappa, Gwets AC1 and
Aickens Alpha (see Gwet, 2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_agree2(y, w=rep(1, nrow(y)), symmetrize=FALSE, tol=c(0, 1))

## S3 method for class 'immer_agree2'
summary(object, digits=3,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_agree2_+3A_y">y</code></td>
<td>

<p>Data frame with responses for two raters
</p>
</td></tr>
<tr><td><code id="immer_agree2_+3A_w">w</code></td>
<td>

<p>Optional vector of frequency weights
</p>
</td></tr>
<tr><td><code id="immer_agree2_+3A_symmetrize">symmetrize</code></td>
<td>

<p>Logical indicating whether contingency table should
be symmetrized
</p>
</td></tr>
<tr><td><code id="immer_agree2_+3A_tol">tol</code></td>
<td>

<p>Vector of integers indicating tolerance for raw agreement
</p>
</td></tr>
<tr><td><code id="immer_agree2_+3A_object">object</code></td>
<td>
<p>Object of class <code>immer_agree2</code></p>
</td></tr>
<tr><td><code id="immer_agree2_+3A_digits">digits</code></td>
<td>
<p>Number of digits after decimal for rounding</p>
</td></tr>
<tr><td><code id="immer_agree2_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with entries
</p>
<table role = "presentation">
<tr><td><code>agree_raw</code></td>
<td>
<p>Raw agreement</p>
</td></tr>
<tr><td><code>agree_stats</code></td>
<td>
<p>Agreement statistics</p>
</td></tr>
<tr><td><code>agree_table</code></td>
<td>
<p>Contingency table</p>
</td></tr>
<tr><td><code>marg</code></td>
<td>
<p>Marginal frequencies</p>
</td></tr>
<tr><td><code>Pe</code></td>
<td>
<p>Expected chance agreement probabilities</p>
</td></tr>
<tr><td><code>PH</code></td>
<td>
<p>Probabilities for hard-to-classify
subjects according to Aicken</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>Number of observations</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gwet, K. L. (2010). <em>Handbook of inter-rater reliability</em>.
Gaithersburg: Advanced Analytics.
</p>


<h3>See Also</h3>

<p>For more inter-rater agreement statistics see the <span class="rlang"><b>R</b></span> packages
<span class="pkg">agRee</span>,
<span class="pkg">Agreement</span>,
<span class="pkg">agrmt</span>,
<span class="pkg">irr</span>,
<span class="pkg">obs.agree</span>,
<span class="pkg">rel</span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Dataset in Schuster &amp; Smith (2006)
#############################################################################

data(data.immer08)
dat &lt;- data.immer08

y &lt;- dat[,1:2]
w &lt;- dat[,3]
# agreement statistics
res &lt;- immer::immer_agree2( y=y, w=w )
summary(res)
# extract some output values
res$agree_stats
res$agree_raw
</code></pre>

<hr>
<h2 id='immer_ccml'>
Composite Conditional Maximum Likelihood Estimation for the Partial Credit Model
with a Design Matrix for Item Parameters
</h2><span id='topic+immer_ccml'></span><span id='topic+summary.immer_ccml'></span><span id='topic+coef.immer_ccml'></span><span id='topic+vcov.immer_ccml'></span>

<h3>Description</h3>

<p>Estimates the partial credit model with a design matrix for item
parameters with composite conditional maximum likelihood estimation.
The estimation uses pairs of items <code class="reqn">X_i</code> and <code class="reqn">X_j</code> and considers conditional
likelihoods <code class="reqn">P(X_i=k, X_j=h | \theta) / P( X_i + X_j=k+h| \theta )</code>. By using
this strategy, the trait <code class="reqn">\theta</code> cancels out (like in conditional maximum
likelihood estimation). The proposed strategy is a generalization of the Zwinderman (1995)
composite conditional maximum likelihood approach of the Rasch model to the
partial credit model. See Varin, Reid and Firth (2011) for a general introduction to
composite conditional maximum likelihood estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_ccml( dat, weights=NULL, irtmodel="PCM", A=NULL, b_fixed=NULL, control=NULL )

## S3 method for class 'immer_ccml'
summary(object, digits=3, file=NULL, ...)

## S3 method for class 'immer_ccml'
coef(object, ...)

## S3 method for class 'immer_ccml'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_ccml_+3A_dat">dat</code></td>
<td>

<p>Data frame with polytomous item responses <code class="reqn">0,1,\ldots, K</code>
</p>
</td></tr>
<tr><td><code id="immer_ccml_+3A_weights">weights</code></td>
<td>

<p>Optional vector of sampling weights
</p>
</td></tr>
<tr><td><code id="immer_ccml_+3A_irtmodel">irtmodel</code></td>
<td>
<p>Model string for specifying the item response model</p>
</td></tr>
<tr><td><code id="immer_ccml_+3A_a">A</code></td>
<td>

<p>Design matrix (items <code class="reqn">\times</code> categories <code class="reqn">\times</code> basis parameters).
Entries for categories are for <code class="reqn">1,\ldots,K</code>
</p>
</td></tr>
<tr><td><code id="immer_ccml_+3A_b_fixed">b_fixed</code></td>
<td>

<p>Matrix with fixed <code class="reqn">b</code> parameters
</p>
</td></tr>
<tr><td><code id="immer_ccml_+3A_control">control</code></td>
<td>
<p>Control arguments for optimization function
<code><a href="stats.html#topic+nlminb">stats::nlminb</a></code>
</p>
</td></tr>
<tr><td><code id="immer_ccml_+3A_object">object</code></td>
<td>
<p>Object of class <code>immer_ccml</code></p>
</td></tr>
<tr><td><code id="immer_ccml_+3A_digits">digits</code></td>
<td>
<p>Number of digits after decimal to print</p>
</td></tr>
<tr><td><code id="immer_ccml_+3A_file">file</code></td>
<td>
<p>Name of a file in which the output should be sunk</p>
</td></tr>
<tr><td><code id="immer_ccml_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates the partial credit model as
<code class="reqn">P(X_i=h | \theta ) \propto \exp( h \theta - b_{ih} )</code> with
<code class="reqn">b_{ih}=\sum_l a_{ihl} \xi_l</code> where the values <code class="reqn">a_{ihl}</code>
are included in the design matrix <code>A</code> and <code class="reqn">\xi_l</code> denotes
basis item parameters.
</p>


<h3>Value</h3>

<p>List with following entries (selection)
</p>
<table role = "presentation">
<tr><td><code>coef</code></td>
<td>
<p>Item parameters</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>Covariance matrix for item parameters</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Standard errors for item parameters</p>
</td></tr>
<tr><td><code>nlminb_result</code></td>
<td>
<p>Output from optimization with
<code><a href="stats.html#topic+nlminb">stats::nlminb</a></code></p>
</td></tr>
<tr><td><code>suff_stat</code></td>
<td>
<p>Used sufficient statistics</p>
</td></tr>
<tr><td><code>ic</code></td>
<td>
<p>Information criteria</p>
</td></tr>
</table>


<h3>References</h3>

<p>Varin, C., Reid, N., &amp; Firth, D. (2011). An overview of composite likelihood methods.
<em>Statistica Sinica, 21</em>, 5-42.
</p>
<p>Zwinderman, A. H. (1995). Pairwise parameter estimation in Rasch models.
<em>Applied Psychological Measurement, 19</em>(4), 369-375.
</p>


<h3>See Also</h3>

<p>See <code><a href="sirt.html#topic+rasch.pairwise.itemcluster">sirt::rasch.pairwise.itemcluster</a></code>
of an implementation of the composite conditional maximum likelihood approach for the
Rasch model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Partial credit model with CCML estimation
#############################################################################

library(TAM)

data(data.gpcm, package="TAM")
dat &lt;- data.gpcm

#-- initial MML estimation in TAM to create a design matrix
mod1a &lt;- TAM::tam.mml(dat, irtmodel="PCM2")
summary(mod1a)

#* define design matrix
A &lt;- - mod1a$A[,-1,-1]
A &lt;- A[,,-1]
str(A)

#-- estimate model
mod1b &lt;- immer::immer_ccml( dat, A=A)
summary(mod1b)
</code></pre>

<hr>
<h2 id='immer_cml'>
Conditional Maximum Likelihood Estimation for the Linear Logistic
Partial Credit Model
</h2><span id='topic+immer_cml'></span><span id='topic+summary.immer_cml'></span><span id='topic+logLik.immer_cml'></span><span id='topic+anova.immer_cml'></span><span id='topic+coef.immer_cml'></span><span id='topic+vcov.immer_cml'></span>

<h3>Description</h3>

<p>Conditional maximum likelihood estimation for the linear logistic
partial credit model (Molenaar, 1995; Andersen, 1995; Fischer, 1995).
The <code>immer_cml</code> function allows for known
integer discrimination parameters like in the one-parameter logistic
model (Verhelst &amp; Glas, 1995).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_cml(dat, weights=NULL, W=NULL, b_const=NULL, par_init=NULL,
    a=NULL, irtmodel=NULL, normalization="first", nullcats="zeroprob",
    diff=FALSE, use_rcpp=FALSE, ...)

## S3 method for class 'immer_cml'
summary(object, digits=3, file=NULL, ...)

## S3 method for class 'immer_cml'
logLik(object,...)

## S3 method for class 'immer_cml'
anova(object,...)

## S3 method for class 'immer_cml'
coef(object,...)

## S3 method for class 'immer_cml'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_cml_+3A_dat">dat</code></td>
<td>

<p>Data frame with item responses
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_weights">weights</code></td>
<td>

<p>Optional vector of sample weights
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_w">W</code></td>
<td>

<p>Design matrix <code class="reqn">\bold{W}</code> for linear logistic partial credit model. Every
row corresponds to a parameter for item <code class="reqn">i</code> in category <code class="reqn">h</code>
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_b_const">b_const</code></td>
<td>

<p>Optional vector of parameter constants <code class="reqn">b_{0ih}</code> which can be
used for parameter fixings.
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_par_init">par_init</code></td>
<td>

<p>Optional vector of initial parameter estimates
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_a">a</code></td>
<td>

<p>Optional vector of integer item discriminations
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_irtmodel">irtmodel</code></td>
<td>

<p>Type of item response model. <code>irtmodel="PCM"</code> and <code>irtmodel="PCM2"</code>
follow the conventions of the <span class="pkg">TAM</span> package.
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_normalization">normalization</code></td>
<td>

<p>The type of normalization in partial credit models. Can be <code>"first"</code>
for the first item or <code>"sum"</code> for a sum constraint.
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_nullcats">nullcats</code></td>
<td>

<p>A string indicating whether categories with zero frequencies should
have a probability of zero (by fixing the constant parameter to a large
value of <code>99</code>).
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_diff">diff</code></td>
<td>

<p>Logical indicating whether the difference algorithm should be used. See
<code><a href="psychotools.html#topic+elementary_symmetric_functions">psychotools::elementary_symmetric_functions</a></code>
for details.
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_use_rcpp">use_rcpp</code></td>
<td>
<p>Logical indicating whether <span class="pkg">Rcpp</span> package should be
used for computation.</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_...">...</code></td>
<td>

<p>Further arguments to be passed to <code><a href="stats.html#topic+optim">stats::optim</a></code>.
</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_object">object</code></td>
<td>
<p>Object of class <code>immer_cml</code></p>
</td></tr>
<tr><td><code id="immer_cml_+3A_digits">digits</code></td>
<td>
<p>Number of digits after decimal to be rounded.</p>
</td></tr>
<tr><td><code id="immer_cml_+3A_file">file</code></td>
<td>
<p>Name of a file in which the output should be sunk</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The partial credit model can be written as
</p>
<p style="text-align: center;"><code class="reqn">P(X_{pi}=h ) \propto \exp( a_i h \theta_p - b_{ih}) </code>
</p>

<p>where the item-category parameters <code class="reqn">b_{ih}</code> are linearly
decomposed according to
</p>
<p style="text-align: center;"><code class="reqn"> b_{ih}=\sum_{v} w_{ihv} \beta_v + b_{0ih}</code>
</p>

<p>with unknown basis parameters <code class="reqn">\beta_v</code> and fixed values <code class="reqn">w_{ihv}</code>
of the design matrix <code class="reqn">\bold{W}</code> (specified in <code>W</code>)
and constants <code class="reqn">b_{0ih}</code> (specified in <code>b_const</code>).
</p>


<h3>Value</h3>

<p>List with following entries:
</p>
<table role = "presentation">
<tr><td><code>item</code></td>
<td>
<p>Data frame with item-category parameters</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>Item-category parameters <code class="reqn">b_{ih}</code></p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>Estimated basis parameters <code class="reqn">\beta_{v}</code></p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>Covariance matrix of basis parameters <code class="reqn">\beta_{v}</code></p>
</td></tr>
<tr><td><code>par_summary</code></td>
<td>
<p>Summary for basis parameters</p>
</td></tr>
<tr><td><code>loglike</code></td>
<td>
<p>Value of conditional log-likelihood</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>Deviance</p>
</td></tr>
<tr><td><code>result_optim</code></td>
<td>
<p>Result from optimization in <code><a href="stats.html#topic+optim">stats::optim</a></code></p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>Used design matrix <code class="reqn">\bold{W}</code></p>
</td></tr>
<tr><td><code>b_const</code></td>
<td>
<p>Used constant vector <code class="reqn">b_{0ih}</code></p>
</td></tr>
<tr><td><code>par_init</code></td>
<td>
<p>Used initial parameters</p>
</td></tr>
<tr><td><code>suffstat</code></td>
<td>
<p>Sufficient statistics</p>
</td></tr>
<tr><td><code>score_freq</code></td>
<td>
<p>Score frequencies</p>
</td></tr>
<tr><td><code>dat</code></td>
<td>
<p>Used dataset</p>
</td></tr>
<tr><td><code>used_persons</code></td>
<td>
<p>Used persons</p>
</td></tr>
<tr><td><code>NP</code></td>
<td>
<p>Number of missing data patterns</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of persons</p>
</td></tr>
<tr><td><code>I</code></td>
<td>
<p>Number of items</p>
</td></tr>
<tr><td><code>maxK</code></td>
<td>
<p>Maximum number of categories per item</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Maximum score of all items</p>
</td></tr>
<tr><td><code>npars</code></td>
<td>
<p>Number of estimated parameters</p>
</td></tr>
<tr><td><code>pars_info</code></td>
<td>
<p>Information of definition of item-category parameters <code class="reqn">b_{ih}</code></p>
</td></tr>
<tr><td><code>parm_index</code></td>
<td>
<p>Parameter indices</p>
</td></tr>
<tr><td><code>item_index</code></td>
<td>
<p>Item indices</p>
</td></tr>
<tr><td><code>score</code></td>
<td>
<p>Raw score for each person</p>
</td></tr>
</table>


<h3>References</h3>

<p>Andersen, E. B. (1995). Polytomous Rasch models and their estimation.
In G. H. Fischer &amp; I. W. Molenaar (Eds.). <em>Rasch Models</em> (pp. 39&ndash;52).
New York: Springer.
</p>
<p>Fischer, G. H. (1995). The linear logistic test model.
In G. H. Fischer &amp; I. W. Molenaar (Eds.). <em>Rasch Models</em> (pp. 131&ndash;156).
New York: Springer.
</p>
<p>Molenaar, I. W. (1995). Estimation of item parameters.
In G. H. Fischer &amp; I. W. Molenaar (Eds.). <em>Rasch Models</em> (pp. 39&ndash;52).
New York: Springer.
</p>
<p>Verhelst, N. D. &amp;, Glas, C. A. W. (1995). The one-parameter logistic model.
In G. H. Fischer &amp; I. W. Molenaar (Eds.). <em>Rasch Models</em> (pp. 215&ndash;238).
New York: Springer.
</p>


<h3>See Also</h3>

<p>For CML estimation see also the <span class="pkg">eRm</span> and <span class="pkg">psychotools</span> packages and the
functions <code><a href="eRm.html#topic+RM">eRm::RM</a></code> and
<code><a href="psychotools.html#topic+raschmodel">psychotools::raschmodel</a></code> for the Rasch model
and <code><a href="eRm.html#topic+PCM">eRm::PCM</a></code> and
<code><a href="psychotools.html#topic+pcmodel">psychotools::pcmodel</a></code> for the partial
credit model.
</p>
<p>See <code><a href="eRm.html#topic+LLTM">eRm::LLTM</a></code> for the linear logistic test model
and <code><a href="eRm.html#topic+LPCM">eRm::LPCM</a></code> for the linear logistic partial
credit model in the <span class="pkg">eRm</span> package for CML implementations.
</p>
<p>The <code>immer_cml</code> function makes use of
<code><a href="psychotools.html#topic+elementary_symmetric_functions">psychotools::elementary_symmetric_functions</a></code>.
</p>
<p>For CML estimation with sample weights see also the
<span class="pkg">RM.weights</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Dichotomous data data.read
#############################################################################

library(sirt)
library(psychotools)
library(TAM)
library(CDM)

data(data.read, package="sirt")
dat &lt;- data.read
I &lt;- ncol(dat)

#----------------------------------------------------------------
#--- Model 1: Rasch model, setting first item difficulty to zero
mod1a &lt;- immer::immer_cml( dat=dat)
summary(mod1a)
logLik(mod1a) # extract log likelihood
coef(mod1a)   # extract coefficients

## Not run: 
library(eRm)

# estimate model in psychotools package
mod1b &lt;- psychotools::raschmodel(dat)
summary(mod1b)
logLik(mod1b)

# estimate model in eRm package
mod1c &lt;- eRm::RM(dat, sum0=FALSE)
summary(mod1c)
mod1c$etapar

# compare estimates of three packages
cbind( coef(mod1a), coef(mod1b), mod1c$etapar )

#----------------------------------------------------------------
#-- Model 2: Rasch model sum normalization
mod2a &lt;- immer::immer_cml( dat=dat, normalization="sum")
summary(mod2a)

# compare estimation in TAM
mod2b &lt;- tam.mml( dat, constraint="items"  )
summary(mod2b)
mod2b$A[,2,]

#----------------------------------------------------------------
#--- Model 3: some fixed item parameters
# fix item difficulties of items 1,4,8
# define fixed parameters in constant parameter vector
b_const &lt;- rep(0,I)
fix_items &lt;- c(1,4,8)
b_const[ fix_items ] &lt;- c( -2.1, .195, -.95 )
# design matrix
W &lt;- matrix( 0, nrow=12, ncol=9)
W[ cbind( setdiff( 1:12, fix_items ), 1:9 ) ] &lt;- 1
colnames(W) &lt;- colnames(dat)[ - fix_items ]
# estimate model
mod3 &lt;- immer::immer_cml( dat=dat, W=W, b_const=b_const)
summary(mod3)

#----------------------------------------------------------------
#--- Model 4: One parameter logistic model
# estimate non-integer item discriminations with 2PL model
I &lt;- ncol(dat)
mod4a &lt;- sirt::rasch.mml2( dat, est.a=1:I )
summary(mod4a)
a &lt;- mod4a$item$a     # extract (non-integer) item discriminations
# estimate integer item discriminations ranging from 1 to 3
a_integer &lt;- immer::immer_opcat( a, hmean=2, min=1, max=3 )
# estimate one-parameter model with fixed integer item discriminations
mod4 &lt;- immer::immer_cml( dat=dat, a=a_integer )
summary(mod4)

#----------------------------------------------------------------
#--- Model 5: Linear logistic test model

# define design matrix
W &lt;- matrix( 0, nrow=12, ncol=5 )
colnames(W) &lt;- c("B","C", paste0("Pos", 2:4))
rownames(W) &lt;- colnames(dat)
W[ 5:8, "B" ] &lt;- 1
W[ 9:12, "C" ] &lt;- 1
W[ c(2,6,10), "Pos2" ] &lt;- 1
W[ c(3,7,11), "Pos3" ] &lt;- 1
W[ c(4,8,12), "Pos4" ] &lt;- 1

# estimation with immer_cml
mod5a &lt;- immer::immer_cml( dat, W=W )
summary(mod5a)

# estimation in eRm package
mod5b &lt;- eRm::LLTM( dat, W=W )
summary(mod5b)

# compare models 1 and 5 by a likelihood ratio test
anova( mod1a, mod5a )

#############################################################################
# EXAMPLE 2: Polytomous data | data.Students
#############################################################################

data(data.Students,package="CDM")
dat &lt;- data.Students
dat &lt;- dat[, grep("act", colnames(dat) ) ]
dat &lt;- dat[1:400,]  # select a subdataset
dat &lt;- dat[ rowSums( 1 - is.na(dat) ) &gt; 1, ]
    # remove persons with less than two valid responses

#----------------------------------------------------------------
#--- Model 1: Partial credit model with constraint on first parameter
mod1a &lt;- immer::immer_cml( dat=dat )
summary(mod1a)
# compare pcmodel function from psychotools package
mod1b &lt;- psychotools::pcmodel( dat )
summary(mod1b)
# estimation in eRm package
mod1c &lt;- eRm::PCM( dat, sum0=FALSE )
  # -&gt; subjects with only one valid response must be removed
summary(mod1c)

#----------------------------------------------------------------
#-- Model 2: Partial credit model with sum constraint on item difficulties
mod2a &lt;- immer::immer_cml( dat=dat, irtmodel="PCM2", normalization="sum")
summary(mod2a)
# compare with estimation in TAM
mod2b &lt;- TAM::tam.mml( dat, irtmodel="PCM2", constraint="items")
summary(mod2b)

#----------------------------------------------------------------
#-- Model 3: Partial credit model with fixed integer item discriminations
mod3 &lt;- immer::immer_cml( dat=dat, normalization="first", a=c(2,2,1,3,1) )
summary(mod3)

#############################################################################
# EXAMPLE 3: Polytomous data | Extracting the structure of W matrix
#############################################################################

data(data.mixed1, package="sirt")
dat &lt;- data.mixed1

# use non-exported function "lpcm_data_prep" to extract the meaning
# of the rows in W which are contained in value "pars_info"
res &lt;- immer:::lpcm_data_prep( dat, weights=NULL, a=NULL )
pi2 &lt;- res$pars_info

# create design matrix with some restrictions on item parameters
W &lt;- matrix( 0, nrow=nrow(pi2), ncol=2 )
colnames(W) &lt;- c( "P2", "P3" )
rownames(W) &lt;- res$parnames

# joint item parameter for items I19 and I20 fixed at zero
# item parameter items I21 and I22
W[ 3:10, 1 ] &lt;- pi2$cat[ 3:10 ]
# item parameters I23, I24 and I25
W[ 11:13, 2] &lt;- 1

# estimate model with design matrix W
mod &lt;- immer::immer_cml( dat, W=W)
summary(mod)

#############################################################################
# EXAMPLE 4: Partial credit model with raters
#############################################################################

data(data.immer07)
dat &lt;- data.immer07

#*** reshape dataset for one variable
dfr1 &lt;- immer::immer_reshape_wideformat( dat$I1, rater=dat$rater, pid=dat$pid )

#-- extract structure of design matrix
res &lt;- immer:::lpcm_data_prep( dat=dfr1[,-1], weights=NULL, a=NULL)
pars_info &lt;- res$pars_info

# specify design matrix for partial credit model and main rater effects
# -&gt; set sum of all rater effects to zero
W &lt;- matrix( 0, nrow=nrow(pars_info), ncol=3+2 )
rownames(W) &lt;- rownames(pars_info)
colnames(W) &lt;- c( "Cat1", "Cat2", "Cat3", "R1", "R2" )
# define item parameters
W[ cbind( pars_info$index, pars_info$cat ) ] &lt;- 1
# define rater parameters
W[ paste(pars_info$item)=="R1", "R1" ] &lt;- 1
W[ paste(pars_info$item)=="R2", "R2" ] &lt;- 1
W[ paste(pars_info$item)=="R3", c("R1","R2") ] &lt;- -1
# set parameter of first category to zero for identification constraints
W &lt;- W[,-1]

# estimate model
mod &lt;- immer::immer_cml( dfr1[,-1], W=W)
summary(mod)

#############################################################################
# EXAMPLE 5: Multi-faceted Rasch model | Estimation with a design matrix
#############################################################################

data(data.immer07)
dat &lt;- data.immer07

#*** reshape dataset
dfr1 &lt;- immer::immer_reshape_wideformat( dat[, paste0("I",1:4) ], rater=dat$rater,
                pid=dat$pid )

#-- structure of design matrix
res &lt;- immer:::lpcm_data_prep( dat=dfr1[,-1], weights=NULL, a=NULL)
pars_info &lt;- res$pars_info

#--- define design matrix for multi-faceted Rasch model with only main effects
W &lt;- matrix( 0, nrow=nrow(pars_info), ncol=3+2+2 )
parnames &lt;- rownames(W) &lt;- rownames(pars_info)
colnames(W) &lt;- c( paste0("I",1:3), paste0("Cat",1:2), paste0("R",1:2) )
#+ define item effects
for (ii in c("I1","I2","I3") ){
    ind &lt;- grep( ii, parnames )
    W[ ind, ii ] &lt;- pars_info$cat[ind ]
                }
ind &lt;- grep( "I4", parnames )
W[ ind, c("I1","I2","I3") ] &lt;- -pars_info$cat[ind ]
#+ define step parameters
for (cc in 1:2 ){
    ind &lt;- which( pars_info$cat==cc )
    W[ ind, paste0("Cat",1:cc) ] &lt;- 1
                }
#+ define rater effects
for (ii in c("R1","R2") ){
    ind &lt;- grep( ii, parnames )
    W[ ind, ii ] &lt;- pars_info$cat[ind ]
                }
ind &lt;- grep( "R3", parnames )
W[ ind, c("R1","R2") ] &lt;- -pars_info$cat[ind ]

#--- estimate model with immer_cml
mod1 &lt;- immer::immer_cml( dfr1[,-1], W=W, par_init=rep(0,ncol(W) ) )
summary(mod1)

#--- comparison with estimation in TAM
resp &lt;- dfr1[,-1]
mod2 &lt;- TAM::tam.mml.mfr( resp=dat[,-c(1:2)], facets=dat[, "rater", drop=FALSE ],
            pid=dat$pid, formulaA=~ item + step + rater )
summary(mod2)

## End(Not run)
</code></pre>

<hr>
<h2 id='immer_FACETS'>
Wrapper to FACDOS
</h2><span id='topic+immer_FACETS'></span><span id='topic+summary.immer_FACETS'></span>

<h3>Description</h3>

<p>This Function is a wrapper do the DOS version of FACETS (Linacre, 1999).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_FACETS(title=NULL, convergence=NULL, totalscore=NULL, facets=NULL,
  noncenter=NULL,  arrange=NULL,entered_in_data=NULL, models=NULL,
  inter_rater=NULL, pt_biserial=NULL, faire_score=NULL, unexpected=NULL,
  usort=NULL, positive=NULL, labels=NULL, fileinput=NULL, data=NULL,
  path.dosbox=NULL, path.facets="", model.name=NULL, facetsEXE=NULL )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_FACETS_+3A_title">title</code></td>
<td>

<p>title of the analysis
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_convergence">convergence</code></td>
<td>

<p>convergence criteria
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_totalscore">totalscore</code></td>
<td>

<p>show the total score with each observation
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_facets">facets</code></td>
<td>

<p>number of specified facets
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_noncenter">noncenter</code></td>
<td>

<p>specified the non centered facet here
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_arrange">arrange</code></td>
<td>

<p>control the ordering in each table/output
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_entered_in_data">entered_in_data</code></td>
<td>

<p>optional specification for facets
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_models">models</code></td>
<td>

<p>model to be used in the analysis
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_inter_rater">inter_rater</code></td>
<td>

<p>Specify rater facet number for the agreement report among raters
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_pt_biserial">pt_biserial</code></td>
<td>

<p>correlation between the raw-score for each element
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_faire_score">faire_score</code></td>
<td>

<p>intended for communicating the measures as adjusted ratings
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_unexpected">unexpected</code></td>
<td>

<p>size of smallest standardized residual
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_usort">usort</code></td>
<td>

<p>order in which the unexpected observation are listed
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_positive">positive</code></td>
<td>

<p>specifies which facet is positively oriented
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_labels">labels</code></td>
<td>

<p>name of each facet, followed by a list of elements
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_fileinput">fileinput</code></td>
<td>

<p>optional argument, if your data are stored within a separate file
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_data">data</code></td>
<td>

<p>Input of the data in long-format
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_path.dosbox">path.dosbox</code></td>
<td>

<p>Path to the installed DOSBox. If <code>NULL</code>: the function assumed that you have
purchased FACETS and would like to use this version (currently only for Windows-User)
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_path.facets">path.facets</code></td>
<td>

<p>Path to FACDOS or FACETS if the path.dosbox is &quot;NULL&quot;
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_model.name">model.name</code></td>
<td>

<p>Name of the configuration file for FACETS
</p>
</td></tr>
<tr><td><code id="immer_FACETS_+3A_facetsexe">facetsEXE</code></td>
<td>

<p>optional argument to specifie specific FACETS.exe
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Within the function <code>immer_FACETS</code> it is either possible to pass existing
FACETS input files or to specify the Input within the function.
To run the estimation in FACETS it is necessary to provide both the path to the
DosBox and FACDOS (it is recommended to use the function <code>immer_install</code> for the
installation process). After the estimation process is finished the Exports are
in the Facets folder.
</p>


<h3>References</h3>

<p>Linacre, J. M. (1999). <em>FACETS</em> (Version 3.17)[Computer software]. Chicago: MESA.
</p>


<h3>See Also</h3>

<p>Install FACDOS and DOSBox <code><a href="#topic+immer_install">immer_install</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
################################
# 1. Example on Windows
################################
# define data generating parameters
set.seed(1997)
N &lt;- 500  # number of persons
I &lt;- 4    # number of items
R &lt;- 3    # number of raters
K &lt;- 3    # maximum score
sigma &lt;- 2  # standard deviation
theta &lt;- rnorm( N, sd=sigma )  # abilities
# item intercepts
b &lt;- outer( seq( -1.5, 1.5, len=I), seq( -2, 2, len=K), "+" )
# item loadings
a &lt;- rep(1,I)
# rater severity parameters
phi &lt;- matrix( c(-.3, -.2, .5), nrow=I, ncol=R, byrow=TRUE )
phi &lt;- phi + rnorm( phi, sd=.3 )
phi &lt;- phi - rowMeans(phi)
# rater variability parameters
psi &lt;- matrix( c(.1, .4, .8), nrow=I, ncol=R, byrow=TRUE )
# simulate HRM data
data &lt;- immer::immer_hrm_simulate( theta, a, b, phi=phi, psi=psi )

# prepare data for FACETS
data2FACETS &lt;- function(data){
  tmp &lt;- match(c("pid","rater"),colnames(data))
  items &lt;- grep("I",colnames(data))
cbind(data[, match(c("pid","rater"),
colnames(data))],gr=paste0("1-",length(items)),data[,items])
}
facets_in &lt;- data2FACETS(data)

# Example of FACETS
mod1.a &lt;- immer::immer_FACETS(
  title="Example 1 with simulated data",
  convergence=NULL,
  totalscore="YES",
  facets=3,
  noncenter=NULL,
  arrange="m,N",
  entered_in_data="2,1,1",
  models="?$,?$,?$,R4",
  inter_rater=NULL,
  pt_biserial=NULL,
  faire_score="Zero",
  unexpected=2,
  usort=NULL,
  positive=1,
  labels=c("1,Persons","1-500","2,Rater","1-3","3,Item","1-4"),
  fileinput=NULL,
  data=facets_in,
  path.dosbox=NULL,
  path.facets="C:\\Facets",
  model.name="Example.SD",
  facetsEXE=NULL
  )

################################
# 2. Example on Windows using existing input-files of FACETS
################################
data(data.immer06)

mod1b &lt;- immer::immer_FACETS(
  fileinput=data.immer06,
  path.facets="C:\\Facets",
  model.name="Example.SD",
  facetsEXE=NULL
  )

## End(Not run)
</code></pre>

<hr>
<h2 id='immer_hrm'>
Hierarchical Rater Model (Patz et al., 2002)
</h2><span id='topic+immer_hrm'></span><span id='topic+summary.immer_hrm'></span><span id='topic+plot.immer_hrm'></span><span id='topic+logLik.immer_hrm'></span><span id='topic+IRT.likelihood.immer_hrm'></span><span id='topic+IRT.posterior.immer_hrm'></span><span id='topic+anova.immer_hrm'></span>

<h3>Description</h3>

<p>Estimates the hierarchical rater model (HRM; Patz et al., 2002; see Details) with
Markov Chain Monte Carlo using a Metropolis-Hastings algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_hrm(dat, pid, rater, iter, burnin, N.save=3000, prior=NULL,  est.a=FALSE,
           est.sigma=TRUE,  est.mu=FALSE, est.phi="a", est.psi="a",
           MHprop=NULL, theta_like=seq(-10,10,len=30), sigma_init=1, print_iter=20 )

## S3 method for class 'immer_hrm'
summary(object, digits=3, file=NULL, ...)

## S3 method for class 'immer_hrm'
plot(x,...)

## S3 method for class 'immer_hrm'
logLik(object,...)

## S3 method for class 'immer_hrm'
anova(object,...)

## S3 method for class 'immer_hrm'
IRT.likelihood(object,...)

## S3 method for class 'immer_hrm'
IRT.posterior(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_hrm_+3A_dat">dat</code></td>
<td>

<p>Data frame with item responses
</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_pid">pid</code></td>
<td>

<p>Person identifiers
</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_rater">rater</code></td>
<td>

<p>Rater identifiers
</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_iter">iter</code></td>
<td>

<p>Number of iterations
</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_burnin">burnin</code></td>
<td>

<p>Number of burnin iterations
</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_n.save">N.save</code></td>
<td>
<p>Maximum number of samples to be saved.</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_prior">prior</code></td>
<td>

<p>Parameters for prior distributions
</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_est.a">est.a</code></td>
<td>
<p>Logical indicating whether <code class="reqn">a</code> parameter should be estimated.</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_est.sigma">est.sigma</code></td>
<td>
<p>Logical indicating whether <code class="reqn">\sigma</code> parameter should be
estimated.</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_est.mu">est.mu</code></td>
<td>
<p>Optional logical indicating whether the mean <code class="reqn">\mu</code>
of the trait <code class="reqn">\theta</code> should be estimated.</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_est.phi">est.phi</code></td>
<td>
<p>Type of <code class="reqn">\phi _{ir}</code> parameters to be estimated.
If <code>est.phi="a"</code>, then <code class="reqn">\phi_{ir}</code> is estimated for all items and
all raters. If <code>est.phi="r"</code>, then <code class="reqn">\phi_{ir}=\phi_r</code> is
rater specific, while for <code>est.phi="i"</code> it is item specific
(<code class="reqn">\phi_{ir}=\phi_i</code>). In case of <code>est.phi="n"</code>, no <code class="reqn">\phi</code>
parameters are estimated and all <code class="reqn">\phi</code> parameters are fixed at 0.
</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_est.psi">est.psi</code></td>
<td>
<p>Type of <code class="reqn">\psi_{ir}</code> parameters to be estimated. The
arguments follow the same conventions as <code>est.phi</code>, but also
allows <code>est.psi="e"</code> (exchangeable) which means <code class="reqn">\psi_{ir}=\psi</code>,
i.e assuming the same <code class="reqn">\psi</code> parameter for all items and raters.
</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_mhprop">MHprop</code></td>
<td>

<p>Parameters for Metropolis Hastings sampling. The standard deviation of the
proposal distribution is adaptively computed (Browne &amp; Draper, 2000).
</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_theta_like">theta_like</code></td>
<td>
<p>Grid of <code class="reqn">\theta</code> values to be used for likelihood
approximation</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_sigma_init">sigma_init</code></td>
<td>
<p>Initial value for <code>sigma</code></p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_print_iter">print_iter</code></td>
<td>
<p>Integer indicating that after each <code>print_iter</code>th
iteration output on the console should be displayed.</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_object">object</code></td>
<td>
<p>Object of class <code>immer_hrm</code></p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_digits">digits</code></td>
<td>
<p>Number of digits after decimal to print</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_file">file</code></td>
<td>
<p>Name of a file in which the output should be sunk</p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_x">x</code></td>
<td>
<p>Object of class <code>immer_hrm</code></p>
</td></tr>
<tr><td><code id="immer_hrm_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed. See
<code><a href="sirt.html#topic+plot.mcmc.sirt">sirt::plot.mcmc.sirt</a></code> for options in <code>plot</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The hierarchical rater model is defined at the level of persons
</p>
<p style="text-align: center;"><code class="reqn">P( \xi _{pi}=\xi  | \theta_p ) \propto \exp ( \xi
    \cdot a_i \cdot \theta_p - b_{ik}  ) </code>
</p>
<p> where <code class="reqn">\theta_p</code>
is normally distributed with mean <code class="reqn">\mu</code> and standard deviation <code class="reqn">\sigma</code>.
</p>
<p>At the level of ratings, the model is defined as
</p>
<p style="text-align: center;"><code class="reqn">P( X_{pir}=x | \theta_p, \xi_{pi} ) \propto \exp(
- ( x - \xi_{pi} - \phi_{ir} )^2 / ( 2 \cdot \psi_{ir} ) ) </code>
</p>



<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>person</code></td>
<td>
<p>Data frame with estimated person parameters</p>
</td></tr>
<tr><td><code>item</code></td>
<td>
<p>Data frame with estimated item parameters</p>
</td></tr>
<tr><td><code>rater_pars</code></td>
<td>
<p>Data frame with estimated rater parameters</p>
</td></tr>
<tr><td><code>est_pars</code></td>
<td>
<p>Estimated item and trait distribution parameters arranged
in vectors and matrices.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Estimated standard deviation <code class="reqn">\sigma</code> of trait <code class="reqn">\theta</code></p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>Estimated mean <code class="reqn">\mu</code> of trait <code class="reqn">\theta</code></p>
</td></tr>
<tr><td><code>mcmcobj</code></td>
<td>
<p>Object of class <code>mcmc.list</code> for <span class="pkg">coda</span> package.</p>
</td></tr>
<tr><td><code>summary.mcmcobj</code></td>
<td>
<p>Summary of all parameters</p>
</td></tr>
<tr><td><code>EAP.rel</code></td>
<td>
<p>EAP reliability</p>
</td></tr>
<tr><td><code>ic</code></td>
<td>
<p>Parameters for information criteria</p>
</td></tr>
<tr><td><code>f.yi.qk</code></td>
<td>
<p>Individual likelihood evaluated at <code>theta_like</code></p>
</td></tr>
<tr><td><code>f.qk.yi</code></td>
<td>
<p>Individual posterior evaluated at <code>theta_like</code></p>
</td></tr>
<tr><td><code>theta_like</code></td>
<td>
<p>Grid of <code class="reqn">\theta</code> values for likelihood approximation</p>
</td></tr>
<tr><td><code>pi.k</code></td>
<td>
<p>Discretized <code class="reqn">\theta</code> distribution</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>Log-likelihood value</p>
</td></tr>
<tr><td><code>MHprop</code></td>
<td>
<p>Updated parameters in Metropolis-Hastings sampling</p>
</td></tr>
</table>


<h3>References</h3>

<p>Browne, W. J., &amp; Draper, D. (2000). Implementation and performance issues in
the Bayesian and likelihood fitting of multilevel models.
<em>Computational Statistics, 15</em>, 391-420.
</p>
<p>Patz, R. J., Junker, B. W., Johnson, M. S., &amp; Mariano, L. T. (2002).
The hierarchical rater model for rated test items and its
application to large-scale educational assessment data.
<em>Journal of Educational and Behavioral Statistics, 27</em>(4), 341-384.
</p>


<h3>See Also</h3>

<p>Simulate the HRM with <code><a href="#topic+immer_hrm_simulate">immer_hrm_simulate</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(sirt)
library(TAM)

#############################################################################
# EXAMPLE 1: Simulated data using the immer::immer_hrm_simulate() function
#############################################################################

# define data generating parameters
set.seed(1997)
N &lt;- 500  # number of persons
I &lt;- 4    # number of items
R &lt;- 3    # number of raters
K &lt;- 3    # maximum score
sigma &lt;- 2  # standard deviation
theta &lt;- stats::rnorm( N, sd=sigma )  # abilities
# item intercepts
b &lt;- outer( seq( -1.5, 1.5, len=I), seq( -2, 2, len=K), "+" )
# item loadings
a &lt;- rep(1,I)
# rater severity parameters
phi &lt;- matrix( c(-.3, -.2, .5), nrow=I, ncol=R, byrow=TRUE )
phi &lt;- phi + stats::rnorm( phi, sd=.3 )
phi &lt;- phi - rowMeans(phi)
# rater variability parameters
psi &lt;- matrix( c(.1, .4, .8), nrow=I, ncol=R, byrow=TRUE )
# simulate HRM data
data &lt;- immer::immer_hrm_simulate( theta, a, b, phi=phi, psi=psi )
pid &lt;- data$pid
rater &lt;- data$rater
dat &lt;- data[, - c(1:2) ]

#----------------------------------------------------------------
#*** Model 1: estimate HRM with equal item slopes
iter &lt;- 3000
burnin &lt;- 500
mod1 &lt;- immer::immer_hrm( dat, pid, rater, iter=iter,  burnin=burnin )
summary(mod1)
plot(mod1,layout=2,ask=TRUE)

# relations among convergence diagnostic statistics
par(mfrow=c(1,2))
plot( mod1$summary.mcmcobj$PercVarRatio, log(mod1$summary.mcmcobj$effSize), pch=16)
plot( mod1$summary.mcmcobj$PercVarRatio, mod1$summary.mcmcobj$Rhat, pch=16)
par(mfrow=c(1,1))

# extract individual likelihood
lmod1 &lt;- IRT.likelihood(mod1)
str(lmod1)
# extract log-likelihood value
logLik(mod1)

# write coda files into working directory
sirt::mcmclist2coda(mod1$mcmcobj, name="hrm_mod1")

#----------------------------------------------------------------
#*** Model 2: estimate HRM with estimated item slopes
mod2 &lt;- immer::immer_hrm( dat, pid, rater, iter=iter,  burnin=burnin,
            est.a=TRUE, est.sigma=FALSE)
summary(mod2)
plot(mod2,layout=2,ask=TRUE)

# model comparison
anova( mod1, mod2 )

#----------------------------------------------------------------
#*** Model 3: Some prior specifications
prior &lt;- list()
# prior on mu
prior$mu$M &lt;- .7
prior$mu$SD &lt;- 5
# fixed item parameters for first item
prior$b$M &lt;-  matrix( 0, nrow=4, ncol=3 )
prior$b$M[1,] &lt;- c(-2,0,2)
prior$b$SD &lt;-  matrix( 10, nrow=4, ncol=3 )
prior$b$SD[1,] &lt;- 1E-4
# estimate model
mod3 &lt;- immer::immer_hrm( dat, pid, rater, iter=iter,  burnin=burnin, prior=prior)
summary(mod3)
plot(mod3)

#----------------------------------------------------------------
#*** Model 4: Multi-faceted Rasch models in TAM package

# create facets object
facets &lt;- data.frame( "rater"=rater )

#-- Model 4a: only main rater effects
form &lt;- ~ item*step + rater
mod4a &lt;- TAM::tam.mml.mfr( dat, pid=pid, facets=facets, formulaA=form)
summary(mod4a)

#-- Model 4b: item specific rater effects
form &lt;- ~ item*step + item*rater
mod4b &lt;- TAM::tam.mml.mfr( dat, pid=pid, facets=facets, formulaA=form)
summary(mod4b)

#----------------------------------------------------------------
#*** Model 5: Faceted Rasch models with sirt::rm.facets

#--- Model 5a: Faceted Rasch model with only main rater effects
mod5a &lt;- sirt::rm.facets( dat, pid=pid, rater=rater )
summary(mod5a)

#--- Model 5b: allow rater slopes for different rater discriminations
mod5b &lt;- sirt::rm.facets( dat, pid=pid, rater=rater, est.a.rater=TRUE )
summary(mod5b)

#############################################################################
# EXAMPLE 2: data.ratings1 (sirt package)
#############################################################################

data(data.ratings1, package="sirt")
dat &lt;- data.ratings1

# set number of iterations and burnin iterations
set.seed(87)
iter &lt;- 1000
burnin &lt;- 500
# estimate model
mod &lt;- immer::immer_hrm( dat[,  paste0("k",1:5) ], pid=dat$idstud, rater=dat$rater,
             iter=iter, burnin=burnin )
summary(mod)
plot(mod, layout=1, ask=TRUE)
plot(mod, layout=2, ask=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='immer_hrm_simulate'>
Simulating the Hierarchical Rater Model (Patz et al., 2002)
</h2><span id='topic+immer_hrm_simulate'></span>

<h3>Description</h3>

<p>Simulates the hierarchical rater model (Patz et al., 2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_hrm_simulate(theta, a, b, phi, psi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_hrm_simulate_+3A_theta">theta</code></td>
<td>

<p>Vector of <code class="reqn">\theta</code> parameters
</p>
</td></tr>
<tr><td><code id="immer_hrm_simulate_+3A_a">a</code></td>
<td>

<p>Vector of <code class="reqn">a</code> parameters
</p>
</td></tr>
<tr><td><code id="immer_hrm_simulate_+3A_b">b</code></td>
<td>

<p>Matrix of <code class="reqn">b</code> parameters
</p>
</td></tr>
<tr><td><code id="immer_hrm_simulate_+3A_phi">phi</code></td>
<td>

<p>Matrix of <code class="reqn">\phi</code> parameters
</p>
</td></tr>
<tr><td><code id="immer_hrm_simulate_+3A_psi">psi</code></td>
<td>

<p>Matrix of <code class="reqn">\psi</code> parameters
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+immer_hrm">immer_hrm</a></code> for more details of the hierarchical rater model.
</p>


<h3>Value</h3>

<p>Dataset with simulated item responses as well as vectors of person
and rater identifiers
</p>


<h3>References</h3>

<p>Patz, R. J., Junker, B. W., Johnson, M. S., &amp; Mariano, L. T. (2002).
The hierarchical rater model for rated test items and its
application to large-scale educational assessment data.
<em>Journal of Educational and Behavioral Statistics, 27</em>(4), 341-384.
</p>


<h3>See Also</h3>

<p>See Example 1 in <code><a href="#topic+immer_hrm">immer_hrm</a></code> for applying the
<code>immer_hrm_simulate</code> function.
</p>

<hr>
<h2 id='immer_install'>
Support for the installation of the DOS-version from FACETS
</h2><span id='topic+immer_install'></span>

<h3>Description</h3>

<p>This function supports the installation process of the DOS-version from FACETS
and also the necessary DOSBox in Windows, Linux (Ubuntu) and OS X
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_install(DosBox_path=NULL, Facets_path=NULL )


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_install_+3A_dosbox_path">DosBox_path</code></td>
<td>

<p>optional argument for the specification of the path where the DosBox should be saved</p>
</td></tr>
<tr><td><code id="immer_install_+3A_facets_path">Facets_path</code></td>
<td>

<p>optional argument for the specification of the path where FACETS should be saved
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides assistance for the installation process of the FACDOS
(DOS version of FACETS) and the required DosBox. Currently supported operating
systems are: Windows, Mac OS X and Ubuntu (Linux).
</p>


<h3>References</h3>

<p>Linacre, J. M. (1999). <em>FACETS</em> (Version 3.17) [Computer software]. Chicago: MESA.
</p>
<p>Veenstra, P., Froessman, T., Wohlers, U. (2015): <em>DOSBox</em> (Version 0.74)
[Computer Software]. Arizona: Scottsdale.
</p>


<h3>See Also</h3>

<p>Install FACDOS and DOSBox <code><a href="#topic+immer_FACETS">immer_FACETS</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
    immer::immer_install( DosBox_path=NULL, Facets_path=NULL )
  
## End(Not run)
</code></pre>

<hr>
<h2 id='immer_jml'>
Joint Maximum Likelihood Estimation for the Partial Credit Model
with a Design Matrix for Item Parameters
and <code class="reqn">\varepsilon</code>-Adjustment Bias Correction
</h2><span id='topic+immer_jml'></span><span id='topic+summary.immer_jml'></span><span id='topic+IRT.likelihood.immer_jml'></span><span id='topic+logLik.immer_jml'></span>

<h3>Description</h3>

<p>Estimates the partial credit model with a design matrix for item
parameters with joint maximum likelihood (JML). The  <code class="reqn">\varepsilon</code>-adjustment
bias correction is implemented with reduces bias of the
JML estimation method (Bertoli-Barsotti, Lando &amp; Punzo, 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_jml(dat, A=NULL, maxK=NULL, center_theta=TRUE, b_fixed=NULL, weights=NULL,
     irtmodel="PCM", pid=NULL, rater=NULL, eps=0.3, est_method="eps_adj", maxiter=1000,
     conv=1e-05, max_incr=3, incr_fac=1.1, maxiter_update=10, maxiter_line_search=6,
     conv_update=1e-05, verbose=TRUE, use_Rcpp=TRUE, shortcut=TRUE)

## S3 method for class 'immer_jml'
summary(object, digits=3, file=NULL, ...)

## S3 method for class 'immer_jml'
logLik(object, ...)

## S3 method for class 'immer_jml'
IRT.likelihood(object, theta=seq(-9,9,len=41), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_jml_+3A_dat">dat</code></td>
<td>

<p>Data frame with polytomous item responses <code class="reqn">0,1,\ldots, K</code>
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_a">A</code></td>
<td>

<p>Design matrix (items <code class="reqn">\times</code> categories <code class="reqn">\times</code> basis parameters).
Entries for categories are for <code class="reqn">1,\ldots,K</code>
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_maxk">maxK</code></td>
<td>
<p>Optional vector with maximum category per item</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_center_theta">center_theta</code></td>
<td>

<p>Logical indicating whether the trait estimates should be centered
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_b_fixed">b_fixed</code></td>
<td>

<p>Matrix with fixed <code class="reqn">b</code> parameters
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_irtmodel">irtmodel</code></td>
<td>
<p>Specified item response model. Can be one of the two
partial credit model parametrizations <code>PCM</code> and <code>PCM2</code>.
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_weights">weights</code></td>
<td>
<p>Optional vector of sampling weights</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_pid">pid</code></td>
<td>
<p>Person identifier</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_rater">rater</code></td>
<td>
<p>Optional rater identifier</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_eps">eps</code></td>
<td>

<p>Adjustment parameter <code class="reqn">\varepsilon</code>
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_est_method">est_method</code></td>
<td>

<p>Estimation method. Can be <code>'eps_adj'</code> for the <code class="reqn">\varepsilon</code>-adjustment,
<code>'jml'</code> for the JML without bias correction and
<code>'jml_bc'</code> for JML with bias correction.
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_maxiter">maxiter</code></td>
<td>

<p>Maximum number of iterations
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_conv">conv</code></td>
<td>

<p>Convergence criterion
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_max_incr">max_incr</code></td>
<td>

<p>Maximum increment
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_incr_fac">incr_fac</code></td>
<td>
<p>Factor for shrinking increments from <code>max_incr</code>
in every iteration</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_maxiter_update">maxiter_update</code></td>
<td>

<p>Maximum number of iterations for parameter updates
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_maxiter_line_search">maxiter_line_search</code></td>
<td>
<p>Maximum number of iterations within line search</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_conv_update">conv_update</code></td>
<td>

<p>Convergence criterion for updates
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_verbose">verbose</code></td>
<td>

<p>Logical indicating whether convergence progress should be displayed
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_use_rcpp">use_Rcpp</code></td>
<td>

<p>Logical indicating whether <span class="pkg">Rcpp</span> package should be used
for computation.
</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_shortcut">shortcut</code></td>
<td>
<p>Logical indicating whether a computational shortcut should be used
for efficiency reasons</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_object">object</code></td>
<td>
<p>Object of class <code>immer_jml</code></p>
</td></tr>
<tr><td><code id="immer_jml_+3A_digits">digits</code></td>
<td>
<p>Number of digits after decimal to print</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_file">file</code></td>
<td>
<p>Name of a file in which the output should be sunk</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_theta">theta</code></td>
<td>
<p>Grid of <code class="reqn">\theta</code> values</p>
</td></tr>
<tr><td><code id="immer_jml_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the partial credit model as
<code class="reqn">P(X_i=h | \theta ) \propto \exp( h \theta - b_{ih} )</code> with
<code class="reqn">b_{ih}=\sum_l a_{ihl} \xi_l</code> where the values <code class="reqn">a_{ihl}</code>
are included in the design matrix <code>A</code> and <code class="reqn">\xi_l</code> denotes
basis item parameters.
</p>
<p>The adjustment parameter <code class="reqn">\varepsilon</code> is applied to the sum score
as the sufficient statistic for the person parameter. In more detail,
extreme scores <code class="reqn">S_p=0</code> (minimum score) or <code class="reqn">S_p=M_p</code> (maximum score)
are adjusted to <code class="reqn">S_p^\ast=\varepsilon</code> or <code class="reqn">S_p^\ast=M_p - \varepsilon</code>,
respectively. Therefore, the adjustment possesses more influence on
parameter estimation for datasets with a small number of items.
</p>


<h3>Value</h3>

<p>List with following entries
</p>
<table role = "presentation">
<tr><td><code>b</code></td>
<td>
<p>Item parameters <code class="reqn">b_{ih}</code></p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>Person parameters</p>
</td></tr>
<tr><td><code>theta_se</code></td>
<td>
<p>Standard errors for person parameters</p>
</td></tr>
<tr><td><code>xsi</code></td>
<td>
<p>Basis parameters</p>
</td></tr>
<tr><td><code>xsi_se</code></td>
<td>
<p>Standard errors for bias parameters</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>Predicted item response probabilities</p>
</td></tr>
<tr><td><code>person</code></td>
<td>
<p>Data frame with person scores</p>
</td></tr>
<tr><td><code>dat_score</code></td>
<td>
<p>Scoring matrix</p>
</td></tr>
<tr><td><code>score_pers</code></td>
<td>
<p>Sufficient statistics for persons</p>
</td></tr>
<tr><td><code>score_items</code></td>
<td>
<p>Sufficient statistics for items</p>
</td></tr>
<tr><td><code>loglike</code></td>
<td>
<p>Log-likelihood value</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bertoli-Barsotti, L., Lando, T., &amp; Punzo, A. (2014). Estimating a Rasch Model via
fuzzy empirical probability functions. In D. Vicari, A. Okada, G. Ragozini &amp;
C. Weihs (Eds.).
<em>Analysis and Modeling of Complex Data in Behavioral and Social Sciences</em>,
Springer.
</p>


<h3>See Also</h3>

<p>See <code><a href="TAM.html#topic+tam.jml">TAM::tam.jml</a></code> for
joint maximum likelihood estimation. The <code class="reqn">varepsilon</code>-adjustment
is also implemented in <code><a href="sirt.html#topic+mle.pcm.group">sirt::mle.pcm.group</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Rasch model
#############################################################################

data(data.read, package="sirt")
dat &lt;- data.read

#---  Model 1: Rasch model with JML and epsilon-adjustment
mod1a &lt;- immer::immer_jml(dat)
summary(mod1a)

## Not run: 
#- JML estimation, only handling extreme scores
mod1b &lt;- immer::immer_jml( dat, est_method="jml")
summary(mod1b)

#- JML estimation with (I-1)/I bias correction
mod1c &lt;- immer::immer_jml( dat, est_method="jml_bc" )
summary(mod1c)

# compare different estimators
round( cbind( eps=mod1a$xsi, JML=mod1b$xsi, BC=mod1c$xsi ), 2 )

#---  Model 2: LLTM by defining a design matrix for item difficulties
A &lt;- array(0, dim=c(12,1,3) )
A[1:4,1,1] &lt;- 1
A[5:8,1,2] &lt;- 1
A[9:12,1,3] &lt;- 1

mod2 &lt;- immer::immer_jml(dat, A=A)
summary(mod2)

#############################################################################
# EXAMPLE 2: Partial credit model
#############################################################################

library(TAM)
data(data.gpcm, package="TAM")
dat &lt;- data.gpcm

#-- JML estimation in TAM
mod0 &lt;- TAM::tam.jml(resp=dat, bias=FALSE)
summary(mod0)

# extract design matrix
A &lt;- mod0$A
A &lt;- A[,-1,]

#-- JML estimation
mod1 &lt;- immer::immer_jml(dat, A=A, est_method="jml")
summary(mod1)

#-- JML estimation with epsilon-adjusted bias correction
mod2 &lt;- immer::immer_jml(dat, A=A, est_method="eps_adj")
summary(mod2)

#############################################################################
# EXAMPLE 3: Rating scale model with raters | Use design matrix from TAM
#############################################################################

data(data.ratings1, package="sirt")
dat &lt;- data.ratings1

facets &lt;- dat[,"rater", drop=FALSE]
resp &lt;- dat[,paste0("k",1:5)]

#* Model 1: Rating scale model in TAM
formulaA &lt;- ~ item + rater + step
mod1 &lt;- TAM::tam.mml.mfr(resp=resp, facets=facets, formulaA=formulaA,
                pid=dat$idstud)
summary(mod1)

#* Model 2: Same model estimated with JML
resp0 &lt;- mod1$resp
A0 &lt;- mod1$A[,-1,]
mod2 &lt;- immer::immer_jml(dat=resp0, A=A0, est_method="eps_adj")
summary(mod2)

## End(Not run)
</code></pre>

<hr>
<h2 id='immer_latent_regression'>
Unidimensional Latent Regression
</h2><span id='topic+immer_latent_regression'></span><span id='topic+summary.immer_latent_regression'></span><span id='topic+coef.immer_latent_regression'></span><span id='topic+vcov.immer_latent_regression'></span><span id='topic+logLik.immer_latent_regression'></span><span id='topic+anova.immer_latent_regression'></span>

<h3>Description</h3>

<p>Fits a unidimensional latent regression
<code class="reqn">\theta_{ig}=Y_{ig} \bm{\beta} + \varepsilon_{ig}</code>
with group-specific variances <code class="reqn">Var(\varepsilon _{ig} )=\sigma^2_g</code> based on
the individual likelihood of a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_latent_regression(like, theta=NULL, Y=NULL, group=NULL, weights=NULL,
   conv=1e-05, maxit=200, verbose=TRUE)

## S3 method for class 'immer_latent_regression'
summary(object, digits=3, file=NULL, ...)

## S3 method for class 'immer_latent_regression'
coef(object, ...)

## S3 method for class 'immer_latent_regression'
vcov(object, ...)

## S3 method for class 'immer_latent_regression'
logLik(object, ...)

## S3 method for class 'immer_latent_regression'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_latent_regression_+3A_like">like</code></td>
<td>

<p>Matrix containing the individual likelihood <code class="reqn">L( \bm{X} | \theta )</code>
</p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_theta">theta</code></td>
<td>

<p>Grid of <code class="reqn">\bm{\theta}</code> values
</p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_y">Y</code></td>
<td>

<p>Predictor matrix
</p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_group">group</code></td>
<td>

<p>Group identifiers
</p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_weights">weights</code></td>
<td>

<p>Optional vector of weights
</p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_conv">conv</code></td>
<td>

<p>Convergence criterion
</p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_maxit">maxit</code></td>
<td>

<p>Maximum number of iterations
</p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_verbose">verbose</code></td>
<td>

<p>Logical indicating whether progress should be displayed
</p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_object">object</code></td>
<td>
<p>Object of class <code>immer_latent_regression</code></p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_digits">digits</code></td>
<td>
<p>Number of digits after decimal to print</p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_file">file</code></td>
<td>
<p>Name of a file in which the output should be sunk</p>
</td></tr>
<tr><td><code id="immer_latent_regression_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing values (selection)
</p>
<table role = "presentation">
<tr><td><code>coef</code></td>
<td>
<p>Parameter vector</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>Covariance matrix for estimated parameters</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Regression coefficients</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Standard deviations</p>
</td></tr>
<tr><td><code>beta_stat</code></td>
<td>
<p>Data frame with <code class="reqn">\bm{\beta}</code> parameters</p>
</td></tr>
<tr><td><code>gamma_stat</code></td>
<td>
<p>Data frame with standard deviations</p>
</td></tr>
<tr><td><code>ic</code></td>
<td>
<p>Information criteria</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>Deviance</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of persons</p>
</td></tr>
<tr><td><code>G</code></td>
<td>
<p>Number of groups</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>Group identifier</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The <code>IRT.likelihood</code> method can be used for
extracting the individual likelihood.
</p>


<h3>References</h3>

<p>Adams, R. J., &amp; Wu, M. L. (2007). The mixed-coefficients multinomial logit model.
A generalized form of the Rasch model. In M. von Davier &amp; C. H. Carstensen (Eds.):
<em>Multivariate and mixture distribution Rasch models: Extensions and applications</em>
(pp. 55-76). New York: Springer.
</p>


<h3>See Also</h3>

<p>See <code><a href="TAM.html#topic+tam.latreg">TAM::tam.latreg</a></code> for latent regression estimation
in the <span class="pkg">TAM</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#############################################################################
# EXAMPLE 1: Latent regression for Rasch model with simulated data
#############################################################################

library(sirt)

#-- simulate data
set.seed(9877)
I &lt;- 15  # number of items
N &lt;- 700 # number of persons per group
G &lt;- 3   # number of groups
b &lt;- seq(-2,2,len=I)
group &lt;- rep( 1:G, each=N)
mu &lt;- seq(0,1, length=G)
sigma &lt;- seq(1, 1.5, length=G)
dat &lt;- sirt::sim.raschtype( stats::rnorm( N*G, mean=mu[group], sd=sigma[group] ), b)

#-- estimate Rasch model with JML
mod1 &lt;- immer::immer_jml( dat )
summary(mod1)

#-- compute individual likelihood
like1 &lt;- IRT.likelihood(mod1)

#-- estimate latent regression
mod2 &lt;- immer::immer_latent_regression( like=like1, group=group)
summary(mod2)

## End(Not run)
</code></pre>

<hr>
<h2 id='immer_opcat'>
Estimation of Integer Item Discriminations
</h2><span id='topic+immer_opcat'></span>

<h3>Description</h3>

<p>Estimates integer item discriminations like in the one-parameter
logistic model (OPLM; Verhelst &amp; Glas, 1995).
See Verhelst, Verstralen and Eggen (1991) for computational
details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_opcat(a, hmean, min=1, max=10, maxiter=200)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_opcat_+3A_a">a</code></td>
<td>

<p>Vector of estimated item discriminations
</p>
</td></tr>
<tr><td><code id="immer_opcat_+3A_hmean">hmean</code></td>
<td>

<p>Prespecified harmonic mean
</p>
</td></tr>
<tr><td><code id="immer_opcat_+3A_min">min</code></td>
<td>

<p>Minimum integer item discrimination
</p>
</td></tr>
<tr><td><code id="immer_opcat_+3A_max">max</code></td>
<td>

<p>Maximum integer item discrimination
</p>
</td></tr>
<tr><td><code id="immer_opcat_+3A_maxiter">maxiter</code></td>
<td>

<p>Maximum number of iterations
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector containing integer item discriminations
</p>


<h3>References</h3>

<p>Verhelst, N. D. &amp;, Glas, C. A. W. (1995). The one-parameter logistic model.
In G. H. Fischer &amp; I. W. Molenaar (Eds.). <em>Rasch Models</em> (pp. 215&ndash;238).
New York: Springer.
</p>
<p>Verhelst, N. D., Verstralen, H. H. F. M., &amp; Eggen, T. H. J. M. (1991).
<em>Finding starting values for the item parameters and suitable discrimination
indices in the one-parameter logistic model</em>.
CITO Measurement and Research Department Reports, 91-10.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+immer_cml">immer_cml</a></code> for using <code>immer_opcat</code> to estimate
the one-parameter logistic model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Estimating integer item discriminations for dichotomous data
#############################################################################

library(sirt)
data(data.read, package="sirt")
dat &lt;- data.read
I &lt;- ncol(dat)

#--- estimate 2PL model
mod &lt;- sirt::rasch.mml2( dat, est.a=1:I, mmliter=30)
summary(mod)
a &lt;- mod$item$a        # extract (non-integer) item discriminations

#--- estimate integer item discriminations under different conditions
a1 &lt;- immer::immer_opcat( a, hmean=3, min=1, max=6 )
table(a1)
a2 &lt;- immer::immer_opcat( a, hmean=2, min=1, max=3 )
a3 &lt;- immer::immer_opcat( a, hmean=1.5, min=1, max=2 )
#--- compare results
cbind( a, a1, a2, a3)
</code></pre>

<hr>
<h2 id='immer_proc_data'>
Processing Datasets and Creating Design Matrices for Rating Data
</h2><span id='topic+immer_proc_data'></span><span id='topic+immer_create_design_matrix_formula'></span>

<h3>Description</h3>

<p>The function <code>immer_proc_data</code> processes datasets containing rating data
into a dataset into a long format of pseudoitems (item <code class="reqn">\times</code> raters).
</p>
<p>The function <code>immer_create_design_matrix_formula</code> creates a design matrix
for a processed dataset and a provided formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_proc_data(dat, pid=NULL, rater=NULL, weights=NULL, maxK=NULL)

immer_create_design_matrix_formula( itemtable, formulaA )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_proc_data_+3A_dat">dat</code></td>
<td>

<p>Datasets with integer item responses
</p>
</td></tr>
<tr><td><code id="immer_proc_data_+3A_pid">pid</code></td>
<td>

<p>Vector with person identifiers
</p>
</td></tr>
<tr><td><code id="immer_proc_data_+3A_rater">rater</code></td>
<td>

<p>Vector with rater identifiers
</p>
</td></tr>
<tr><td><code id="immer_proc_data_+3A_weights">weights</code></td>
<td>

<p>Vector with sampling weights
</p>
</td></tr>
<tr><td><code id="immer_proc_data_+3A_maxk">maxK</code></td>
<td>
<p>Optional vector with maximum category per item</p>
</td></tr>
<tr><td><code id="immer_proc_data_+3A_itemtable">itemtable</code></td>
<td>
<p>Processed item table. The table must include the column
<code>item</code> (an integer item identifier) and <code>maxK</code> (maximum number of
categories per item). Optional columns are <code>rater</code>
(an integer rater identifier),<code>item_name</code> and <code>rater_name</code>.
</p>
</td></tr>
<tr><td><code id="immer_proc_data_+3A_formulaa">formulaA</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> formula. The facets <code>item</code>, <code>step</code> and
<code>rater</code> are treated as numeric. However, numeric transformation can
be applied for the step parameter by using the arguments <code>item_num</code>,
<code>step_num</code> or <code>rater_num</code> in <code>formulaA</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output of <code>immer_proc_data</code> is a list with several entries (selection)
</p>
<table role = "presentation">
<tr><td><code>dat2</code></td>
<td>
<p>Dataset containing pseudoitems</p>
</td></tr>
<tr><td><code>dat2.resp</code></td>
<td>
<p>Dataset containing response indicators for pseudoitems</p>
</td></tr>
<tr><td><code>dat2.NA</code></td>
<td>
<p>Dataset containing pseudoitems and missing responses coded as <code>NA</code></p>
</td></tr>
<tr><td><code>dat</code></td>
<td>
<p>Original dataset</p>
</td></tr>
<tr><td><code>person.index</code></td>
<td>
<p>Person identifiers</p>
</td></tr>
<tr><td><code>rater.index</code></td>
<td>
<p>Rater identifiers</p>
</td></tr>
<tr><td><code>VV</code></td>
<td>
<p>Number of items</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of persons</p>
</td></tr>
<tr><td><code>RR</code></td>
<td>
<p>Number of raters</p>
</td></tr>
<tr><td><code>dat2.ind.resp</code></td>
<td>
<p>Array containing indicators of pseudoitems and categories</p>
</td></tr>
<tr><td><code>ND</code></td>
<td>
<p>Number of person-rater interactions</p>
</td></tr>
<tr><td><code>itemtable</code></td>
<td>
<p>Information about processed data</p>
</td></tr>
</table>
<p>The output of <code>immer_create_design_matrix_formula</code> is a list with several
entries (selection)
</p>
<table role = "presentation">
<tr><td><code>A</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code>itemtable2</code></td>
<td>
<p>Processed item table</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Processing rating data
#############################################################################

data(data.immer01a, package="immer")
dat &lt;- data.immer01a

res &lt;- immer::immer_proc_data( dat=dat[,paste0("k",1:5)], pid=dat$idstud,
             rater=dat$rater)
str(res, max.level=1)

## Not run: 
#############################################################################
# EXAMPLE 2: Creating several design matrices for rating data
#############################################################################

data(data.ratings1, package="sirt")
dat &lt;- data.ratings1
resp &lt;- dat[,-c(1,2)]
#- redefine the second and third item such that the maximum category score is 2
for (vv in c(2,3)){
    resp[ resp[,vv] &gt;=2,vv ] &lt;- 2
}

#--- process data
res0 &lt;- immer::immer_proc_data( dat=resp, pid=dat$idstud,  rater=dat$rater)

#--- rating scale model
des1 &lt;- immer::immer_create_design_matrix_formula( itemtable=res0$itemtable,
                formulaA=~ item + step )
des1$des

#--- partial scale model
des2 &lt;- immer::immer_create_design_matrix_formula( itemtable=res0$itemtable,
                formulaA=~ item + item:step )
des2$des

#--- multi-facets Rasch model
des3 &lt;- immer::immer_create_design_matrix_formula( itemtable=res0$itemtable,
                formulaA=~ item + item:step + rater )
des3$des

#--- polytomous model with quadratic step effects
des4 &lt;- immer::immer_create_design_matrix_formula( itemtable=res0$itemtable,
                formulaA=~ item + item:I(step_num^2) )
des4$des

## End(Not run)
</code></pre>

<hr>
<h2 id='immer_reshape_wideformat'>
Creating a Rating Dataset in Wide Format
</h2><span id='topic+immer_reshape_wideformat'></span>

<h3>Description</h3>

<p>Converts a rating dataset from a long format into a wide format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_reshape_wideformat(y, pid, rater, Nmin_ratings=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_reshape_wideformat_+3A_y">y</code></td>
<td>

<p>Vector or a data frame containing ratings
</p>
</td></tr>
<tr><td><code id="immer_reshape_wideformat_+3A_pid">pid</code></td>
<td>

<p>Person identifier
</p>
</td></tr>
<tr><td><code id="immer_reshape_wideformat_+3A_rater">rater</code></td>
<td>

<p>Rater identifier
</p>
</td></tr>
<tr><td><code id="immer_reshape_wideformat_+3A_nmin_ratings">Nmin_ratings</code></td>
<td>

<p>Minimum number of ratings used for selection
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with ratings. Each row corresponds to a person, and each
of the columns (except the first one containing the person
identifier) to one rater.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Reshaping ratings of one variable into wide format
#############################################################################

data(data.immer03)
dat &lt;- data.immer03

# select variable "b" and persons which have at least 10 ratings
dfr &lt;- immer::immer_reshape_wideformat( y=dat$b2, pid=dat$idstud, rater=dat$rater,
                    Nmin_ratings=10 )
head(dfr)

#############################################################################
# EXAMPLE 2: Reshaping ratings of a data frame into wide format
#############################################################################

data(data.immer07)
dat &lt;- data.immer07

#*** Dataset 1: Wide format for item I1
dfr1 &lt;- immer::immer_reshape_wideformat( dat$I1, rater=dat$rater, pid=dat$pid)

#*** Dataset 2: Wide format for four items I1, I2, I3 and I4
dfr2 &lt;- immer::immer_reshape_wideformat( dat[, paste0("I",1:4) ],
              rater=dat$rater, pid=dat$pid )
str(dfr2)
</code></pre>

<hr>
<h2 id='immer_unique_patterns'>
Extracts Unique Item Response Patterns
</h2><span id='topic+immer_unique_patterns'></span>

<h3>Description</h3>

<p>Extracts unique item response patterns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>immer_unique_patterns(dat, w=rep(1, nrow(dat)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="immer_unique_patterns_+3A_dat">dat</code></td>
<td>

<p>Data frame containing integer item responses
</p>
</td></tr>
<tr><td><code id="immer_unique_patterns_+3A_w">w</code></td>
<td>

<p>Optional vector of weights
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with entries
</p>
<table role = "presentation">
<tr><td><code>y</code></td>
<td>
<p>Data frame with unique item response patterns</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>Vector of frequency weights</p>
</td></tr>
<tr><td><code>y_string</code></td>
<td>
<p>Item response pattern coded as a string</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>See <code>mirt::expand.table</code> for back-converting
unique item response patterns into a data frame with item responses.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Unique item response patterns data.read
#############################################################################

data( data.read, package="sirt")
dat &lt;- data.read

# extract item response patterns
res &lt;- immer::immer_unique_patterns(dat)

## Not run: 
# back-conversion with expand.table
dat2 &lt;- mirt::expand.table( cbind( res$y, res$w ) )
# check correctness
colMeans(dat)
colMeans(dat2)

## End(Not run)
</code></pre>

<hr>
<h2 id='lc2_agreement'>
A Latent Class Model for Agreement of Two Raters
</h2><span id='topic+lc2_agreement'></span><span id='topic+summary.lc2_agreement'></span><span id='topic+logLik.lc2_agreement'></span><span id='topic+anova.lc2_agreement'></span>

<h3>Description</h3>

<p>Estimates a latent class model for agreement of two raters
(Schuster &amp; Smith, 2006). See Details for the description of
the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lc2_agreement(y, w=rep(1, nrow(y)), type="homo", method="BFGS", ...)

## S3 method for class 'lc2_agreement'
summary(object, digits=3,...)

## S3 method for class 'lc2_agreement'
logLik(object, ...)

## S3 method for class 'lc2_agreement'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lc2_agreement_+3A_y">y</code></td>
<td>

<p>A data frame containing the values of two raters in columns
</p>
</td></tr>
<tr><td><code id="lc2_agreement_+3A_w">w</code></td>
<td>

<p>Optional vector of weights
</p>
</td></tr>
<tr><td><code id="lc2_agreement_+3A_type">type</code></td>
<td>

<p>Type of model specification. Can be <code>"unif"</code>, <code>"equal"</code>,
<code>"homo"</code> or <code>"hete"</code>. See Details.
</p>
</td></tr>
<tr><td><code id="lc2_agreement_+3A_method">method</code></td>
<td>

<p>Optimization method used in <code><a href="stats.html#topic+optim">stats::optim</a></code>
</p>
</td></tr>
<tr><td><code id="lc2_agreement_+3A_...">...</code></td>
<td>

<p>Further arguments passed to <code><a href="stats.html#topic+optim">stats::optim</a></code>
</p>
</td></tr>
<tr><td><code id="lc2_agreement_+3A_object">object</code></td>
<td>
<p>Object of class <code>l2_agreement</code></p>
</td></tr>
<tr><td><code id="lc2_agreement_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The latent class model for two raters decomposes a portion of ratings
which conform to true agreement and another portion of ratings which
conform to a random rating of a category. Let <code class="reqn">X_r</code> denote the rating of
rater <code class="reqn">r</code>, then for <code class="reqn"> i \neq j</code>, it is assumed that
</p>
<p style="text-align: center;"><code class="reqn">P(X_1=i, X_2=j)=\phi_{1i}  \phi_{2j} ( 1 - \gamma )</code>
</p>

<p>For <code class="reqn">i=j</code> it is assumed that
</p>
<p style="text-align: center;"><code class="reqn">P(X_1=i, X_2=i)=\tau_i \gamma + \phi_{1i} \phi_{2i} ( 1 - \gamma )</code>
</p>

<p>where <code class="reqn">\gamma</code> denotes the proportion of true ratings.
</p>
<p>All <code class="reqn">\tau_i</code> and <code class="reqn">\phi_{ri}</code> parameters are estimated
using <code>type="hete"</code>. If the <code class="reqn">\phi</code> parameters are assumed
as invariant across the two raters (i.e. <code class="reqn">\phi_{1i}=\phi_{2i}=\phi_{i}</code>),
then <code>type="homo"</code> must be specified. The constraint <code class="reqn">\tau_i=\phi_i</code>
is imposed by <code>type="equal"</code>. All <code class="reqn">\phi_i</code> parameters
are set equal to each other using <code>type="unif"</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>model_output</code></td>
<td>
<p>Output of the fitted model</p>
</td></tr>
<tr><td><code>saturated_output</code></td>
<td>
<p>Output of the saturated model</p>
</td></tr>
<tr><td><code>LRT_output</code></td>
<td>
<p>Output of the likelihood ratio test of model fit</p>
</td></tr>
<tr><td><code>partable</code></td>
<td>
<p>Parameter table</p>
</td></tr>
<tr><td><code>parmsummary</code></td>
<td>
<p>Parameter summary</p>
</td></tr>
<tr><td><code>agree_true</code></td>
<td>
<p>True agreement index shich is the <code class="reqn">\gamma</code> parameter</p>
</td></tr>
<tr><td><code>agree_chance</code></td>
<td>
<p>Agreement by chance</p>
</td></tr>
<tr><td><code>rel_agree</code></td>
<td>
<p>Conditional reliability of agreement</p>
</td></tr>
<tr><td><code>optim_output</code></td>
<td>
<p>Output of <code>optim</code> from the fitted model</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Model type</p>
</td></tr>
<tr><td><code>ic</code></td>
<td>
<p>Information criteria</p>
</td></tr>
<tr><td><code>loglike</code></td>
<td>
<p>Log-likelihood</p>
</td></tr>
<tr><td><code>npars</code></td>
<td>
<p>Number of parameters</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Used dataset</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>Used weights</p>
</td></tr>
</table>


<h3>References</h3>

<p>Schuster, C., &amp; Smith, D. A. (2006). Estimating with a latent
class model the reliability of nominal judgments upon which
two raters agree. <em>Educational and Psychological Measurement, 66</em>(5), 739-747.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Dataset in Schuster and Smith (2006)
#############################################################################

data(data.immer08)
dat &lt;- data.immer08

# select ratings and frequency weights
y &lt;- dat[,1:2]
w &lt;- dat[,3]

#*** Model 1: Uniform distribution phi parameters
mod1 &lt;- immer::lc2_agreement( y=y, w=w, type="unif")
summary(mod1)

#*** Model 2: Equal phi and tau parameters
mod2 &lt;- immer::lc2_agreement( y=y, w=w, type="equal")
summary(mod2)

## Not run: 
#*** Model 3: Homogeneous rater model
mod3 &lt;- immer::lc2_agreement( y=y, w=w, type="homo")
summary(mod3)

#*** Model 4: Heterogeneous rater model
mod4 &lt;- immer::lc2_agreement( y=y, w=w, type="hete")
summary(mod4)

#--- some model comparisons
anova(mod3,mod4)
IRT.compareModels(mod1,mod2,mod3,mod4)

## End(Not run)
</code></pre>

<hr>
<h2 id='probs2logits'>
Conversion of Probabilities into Logits
</h2><span id='topic+probs2logits'></span><span id='topic+logits2probs'></span>

<h3>Description</h3>

<p>Converts probabilities into logits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probs2logits(probs)

logits2probs(y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probs2logits_+3A_probs">probs</code></td>
<td>

<p>Vector containing probabilities
</p>
</td></tr>
<tr><td><code id="probs2logits_+3A_y">y</code></td>
<td>

<p>Vector containing logits
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with logits or probabilities
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Probability-logit-conversions: a toy example
#############################################################################

# define vector of probabilities
probs &lt;- c( .3, .25, .25, .2)
sum(probs)

# convert probabilities into logits
y &lt;- immer::probs2logits( probs )
# retransform logits into probabilities
immer::logits2probs(y)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
