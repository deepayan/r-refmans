<!DOCTYPE html><html><head><title>Help for package adehabitatHS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {adehabitatHS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adehabitatHS-internal'><p>Internal adehabitatHS objects</p></a></li>
<li><a href='#bauges'><p>Census of chamois (Rupicapra rupicapra) in the Bauges mountains</p></a></li>
<li><a href='#bighorn'><p> Radio-Tracking of Bighorn Sheeps</p></a></li>
<li><a href='#biv.test'><p>Bivariate Test</p></a></li>
<li><a href='#canomi'>
<p>Canonical OMI analysis</p></a></li>
<li><a href='#chamois'><p>Location of Chamois Groups in the Chartreuse Mountains</p></a></li>
<li><a href='#compana'><p>Compositional Analysis of Habitat Use</p></a></li>
<li><a href='#domain'><p>Estimation of the Potential Distribution of a Species</p></a></li>
<li><a href='#dunnfa'><p>Factorial Analysis of the Specialization in Habitat Selection</p>
Studies.  Unpublished Work of James Dunn (University of Arkansas)</a></li>
<li><a href='#eisera'><p>Eigenanalysis of Selection Ratios</p></a></li>
<li><a href='#enfa'><p>Ecological Niche Factor Analysis</p></a></li>
<li><a href='#engen2008II'><p>Measuring Habitat Selection Using the Method of Engen et al. (2008)</p></a></li>
<li><a href='#gnesfa'><p>General Niche-Environment System Factor Analysis</p></a></li>
<li><a href='#histniche'><p>Histograms of the Ecological Niche</p></a></li>
<li><a href='#kselect'><p> K-Select Analysis: a Method to Analyse the Habitat Selection by</p>
Animals</a></li>
<li><a href='#madifa'><p>The MADIFA: a Factorial Decomposition of the Mahalanobis Distances</p></a></li>
<li><a href='#mahasuhab'><p>Habitat Suitability Mapping with Mahalanobis Distances.</p></a></li>
<li><a href='#niche.test'><p>Monte-Carlo Test on Parameters of the Ecological Niche</p></a></li>
<li><a href='#pheasant'><p>Radio-Tracking of Pheasants</p></a></li>
<li><a href='#predict.enfa'><p>Habitat Suitability Maps Built from the ENFA</p></a></li>
<li><a href='#puech'><p>Radio-Tracking Data of Wild Boar (2)</p></a></li>
<li><a href='#puechdesIII'><p>Habitat Selection by the Wild Boar at Puechabon</p></a></li>
<li><a href='#rand.kselect'><p>Test of the Third-Order Habitat Selection</p></a></li>
<li><a href='#randtest.enfa'><p>Randomisation Test for the Ecological Niche Factor Analysis</p></a></li>
<li><a href='#scatter.enfa'><p>Scatter Plot of the Results of the ENFA</p></a></li>
<li><a href='#scatterniche'><p>Display the Niche in the Ecological Space</p></a></li>
<li><a href='#squirrel'><p>Radio-Tracking Data of Squirrels</p></a></li>
<li><a href='#squirreloc'><p>Radio-tracking of squirrels</p></a></li>
<li><a href='#vanoise'><p>Habitat Use by Three Species of Galliformes in the Vanoise</p>
National Parc</a></li>
<li><a href='#wi'><p>Computation of Selection Ratios for Habitat Selection Studies.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.3.17</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-06</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1), sp, methods, ade4, adehabitatMA, adehabitatHR</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tkrplot, MASS</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, stats</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Habitat Selection by Animals</td>
</tr>
<tr>
<td>Author:</td>
<td>Clement Calenge, contributions from Mathieu Basille</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Clement Calenge &lt;clement.calenge@ofb.gouv.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of tools for the analysis of habitat selection.</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-06 13:41:41 UTC; calenge</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-06 14:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='adehabitatHS-internal'>Internal adehabitatHS objects</h2><span id='topic+profilehab'></span>

<h3>Description</h3>

<p>Internal adehabitatHS objects.</p>


<h3>Details</h3>

<p>These are not to be called by the user.</p>

<hr>
<h2 id='bauges'>Census of chamois (Rupicapra rupicapra) in the Bauges mountains</h2><span id='topic+bauges'></span>

<h3>Description</h3>

<p>This data set contains the relocations of 198 chamois groups in the
Bauges mountains, as well as maps of 7 environmental variables on the
study area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bauges)</code></pre>


<h3>Details</h3>

<p>This dataset contains a subsample of the data collected by volunteers
and professionals working in various French wildlife and forest
management, from 1994 to 2004 in the wildlife reserve of &quot;les Bauges&quot;
(French Alps). Note that both the maps and the relocations have been
slightly destroyed to preserve copyright on the data.
</p>


<h3>Source</h3>

<p>Daniel Maillard, Office National de la chasse et de la faune sauvage,
95 rue Pierre Flourens, 34000 Montpellier, France
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bauges)

mimage(bauges$map)
image(bauges$map, 1)
points(bauges$locs)

</code></pre>

<hr>
<h2 id='bighorn'> Radio-Tracking of Bighorn Sheeps</h2><span id='topic+bighorn'></span>

<h3>Description</h3>

<p>This data set describes the habitat use and availability for 6 bighorn
sheeps monitored by radio-tracking (Arnett et al. 1989, in Manly et al.,
2003, p. 67-74). 10 habitat types are considered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bighorn)
</code></pre>


<h3>Details</h3>

<p>The object <code>bighorn</code> is a list, with the following components:
</p>

<dl>
<dt><code>used</code></dt><dd><p>the number of resource units used by each animal (in rows)
in each habitat category (in columns).</p>
</dd>
<dt><code>availTrue</code></dt><dd><p>the availability of each habitat category.</p>
</dd>
<dt><code>availEstimated</code></dt><dd><p>a sample of available resource units in each
habitat category.</p>
</dd>
</dl>



<h3>References</h3>

<p>Manly, B.F.J., McDonald, L.L., Thomas, D.L., McDonald, T.L. &amp; Erickson,
W.P. (2003) <em>Resource selection by animals - Statistical design and
Analysis for field studies. Second edition.</em>
London: Kluwer academic publishers. 
</p>

<hr>
<h2 id='biv.test'>Bivariate Test</h2><span id='topic+biv.plot'></span><span id='topic+biv.test'></span>

<h3>Description</h3>

<p><code>biv.plot</code> displays a bivariate plot.
<code>biv.test</code> displays the results of a bivariate randomisation test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>biv.plot(dfxy, br = 10, points = TRUE, density = TRUE, 
         kernel = TRUE, o.include = FALSE, pch, cex, col, h, sub, 
         side = c("top", "bottom", "none"), ...)
biv.test(dfxy, point, br = 10, points = TRUE, density = TRUE, 
         kernel = TRUE, o.include = FALSE, pch, cex, col, Pcol, h, sub, 
         side = c("top", "bottom", "none"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="biv.test_+3A_dfxy">dfxy</code></td>
<td>
<p>a data frame with N lines (couples of values) and two
columns</p>
</td></tr>
<tr><td><code id="biv.test_+3A_br">br</code></td>
<td>
<p>a parameter used to define the numbers of breaks of the
histograms.  A larger value leads to a larger number of breaks</p>
</td></tr>
<tr><td><code id="biv.test_+3A_points">points</code></td>
<td>
<p>logical.  Whether the points should be displayed</p>
</td></tr>
<tr><td><code id="biv.test_+3A_density">density</code></td>
<td>
<p>logical.  Whether the kernel density estimation should be 
displayed for the marginal histograms</p>
</td></tr>
<tr><td><code id="biv.test_+3A_kernel">kernel</code></td>
<td>
<p>logical.  Whether the kernel density estimation should be 
displayed for the bivariate plot</p>
</td></tr>
<tr><td><code id="biv.test_+3A_o.include">o.include</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the origin is included in
the plot</p>
</td></tr>
<tr><td><code id="biv.test_+3A_pch">pch</code></td>
<td>
<p>plotting &quot;character&quot;, i.e., symbol to use for the points.  (see 
<code>?points</code>)</p>
</td></tr>
<tr><td><code id="biv.test_+3A_cex">cex</code></td>
<td>
<p>character expansion for the points</p>
</td></tr>
<tr><td><code id="biv.test_+3A_col">col</code></td>
<td>
<p>color code or name for the points, see <code>?par</code></p>
</td></tr>
<tr><td><code id="biv.test_+3A_h">h</code></td>
<td>
<p>vector of bandwidths for x and y directions, used in the
function <code>kde2d</code> of the package <code>MASS</code>.  Defaults to normal
reference bandwidth (see <code>?kde2d</code>)</p>
</td></tr>
<tr><td><code id="biv.test_+3A_sub">sub</code></td>
<td>
<p>a character string to be inserted in the plot as a title</p>
</td></tr>
<tr><td><code id="biv.test_+3A_side">side</code></td>
<td>
<p>if <code>"top"</code>, the x and y scales of the grid are upside, 
if <code>"bottom"</code> they are downside, if <code>"none"</code> no legend</p>
</td></tr>
<tr><td><code id="biv.test_+3A_point">point</code></td>
<td>
<p>a vector of length 2, representing the observation to be 
compared with the simulated values of the randomisation test</p>
</td></tr>
<tr><td><code id="biv.test_+3A_pcol">Pcol</code></td>
<td>
<p>color code or name for the observed point</p>
</td></tr>
<tr><td><code id="biv.test_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>biv.test</code> is used to display the results of a bivariate
randomisation test.  An example of use of the function is provided in
the function <code>niche.test</code>.
</p>
<p>The x-axis of the main window corresponds to the first column of
<code>dfxy</code>; the y-axis corresponds to the second column.  Kernel
density is estimated to indicate the contours of the distribution of
randomised values.  The two marginal histograms correspond to the
univariate tests on each axis, for which the p-values are computed with
<code>as.randtest</code> (package ade4, one-sided tests).
</p>


<h3>Warning</h3>

<p><code>biv.plot</code> and <code>biv.test</code> use the function <code>kde2d</code> of the 
package <code>MASS</code>.
</p>


<h3>Author(s)</h3>

<p>Mathieu Basille <a href="mailto:basille@ase-research.org">basille@ase-research.org</a></p>


<h3>See Also</h3>

<p><code><a href="ade4.html#topic+as.randtest">as.randtest</a></code> (package ade4)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x = rnorm(1000,2)
y = 2*x+rnorm(1000,2)
dfxy = data.frame(x, y)

biv.plot(dfxy)
biv.plot(dfxy, points=FALSE, col="lightblue", br=20)

p = c(3, 4)
biv.test(dfxy, p)
biv.test(dfxy, p, points=FALSE, Pcol="darkred", col="lightblue", br=20)

</code></pre>

<hr>
<h2 id='canomi'>
Canonical OMI analysis
</h2><span id='topic+canomi'></span><span id='topic+print.canomi'></span><span id='topic+plot.canomi'></span>

<h3>Description</h3>

<p>This function performs a canonical OMI analysis (outlying mean index).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>canomi(dudiX, Y, scannf = TRUE, nf = 2)
## S3 method for class 'canomi'
print(x, ...)
## S3 method for class 'canomi'
 plot(x, xax = 1, yax = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="canomi_+3A_dudix">dudiX</code></td>
<td>
<p>an object of class <code>dudi</code></p>
</td></tr>
<tr><td><code id="canomi_+3A_y">Y</code></td>
<td>
<p>a a data frame Resource units-animals according to
<code>dudiX$tab</code> with no columns of zero</p>
</td></tr>
<tr><td><code id="canomi_+3A_scannf">scannf</code></td>
<td>
<p>a logical value indicating whether the eigenvalues bar plot
should be displayed</p>
</td></tr>
<tr><td><code id="canomi_+3A_nf">nf</code></td>
<td>
<p>if scannf FALSE, an integer indicating the number of kept
axes</p>
</td></tr>
<tr><td><code id="canomi_+3A_x">x</code></td>
<td>
<p>an object of class <code>canomi</code> returned by the function
<code>canomi</code></p>
</td></tr>
<tr><td><code id="canomi_+3A_xax">xax</code></td>
<td>
<p>the number of the x-axis</p>
</td></tr>
<tr><td><code id="canomi_+3A_yax">yax</code></td>
<td>
<p>the number of the x-axis</p>
</td></tr>
<tr><td><code id="canomi_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The canonical OMI analysis is similar to the function <code>niche</code>,
from the package <code>ade4</code>.  The principle of this analysis is the
following.  A set of N resource units (RUs) are available to the
animals of the study.  Each resource unit is described by P
environmental variables.  Therefore, the N resource units define a
cloud of N points in the P-dimensionnal space defined by the P
variables. We call this space &quot;ecological space&quot;.
</p>
<p>Moreover, the use of the N resource units is known (or sampled) for
a sample of K animals (e.g., using radio-tracking).  These utilization
weights for each RU (rows) and each animal (column) define a table
<code>Y</code>.  For a given animal, the set of resource units used define
the &quot;niche&quot; of the animal.  The vector connecting the centroid (mean)
of the available RUs to the centroid of the RUs used by this animal is
named &quot;marginality vector&quot; (and its squared length is named
&quot;marginality&quot; or &quot;outlying mean index&quot;).
</p>
<p>The <code>canomi</code> first distorts the ecological space so that the
available resource units take a standard spherical shape (by first
performing a principal component analysis). Then, in this distorted
space, a non-centred principal component analysis of the marginality
vectors is performed. The canonical OMI analysis finds the directions
in the distorted ecological space where the marginality is, in
average, the largest.
</p>


<h3>Value</h3>

<p><code>canomi</code> returns a list of the class <code>canomi</code>, with the
following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>original call.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>an integer indicating the rank of the studied matrix</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>an integer indicating the number of kept axes</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>a vector with all the eigenvalues of the analysis.</p>
</td></tr>  
<tr><td><code>tab</code></td>
<td>
<p>a data frame with n rows (n animals) and p columns (p
environmental variables).</p>
</td></tr>
<tr><td><code>li</code></td>
<td>
<p>animals coordinates, data frame with n rows and nf columns.</p>
</td></tr>
<tr><td><code>l1</code></td>
<td>
<p>animals normed coordinates, data frame with n rows and nf columns.</p>
</td></tr>
<tr><td><code>c1</code></td>
<td>
<p>column scores, data frame with p rows and nf columns.</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p>the correlation between the canomi axes and the original
variables</p>
</td></tr>
<tr><td><code>ls</code></td>
<td>
<p>a data frame with the resource units coordinates</p>
</td></tr>
<tr><td><code>cm</code></td>
<td>
<p>The variables metric used in the analysis (e.g.
<code>ls = dudiX\$tab%*%cm%*%c1</code>)</p>
</td></tr>
<tr><td><code>as</code></td>
<td>
<p>a data frame with the axis upon niche axis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a> </p>


<h3>References</h3>

<p>Chessel, D. 2006. Calcul de l'outlier mean index. Consultation
statistique avec le logiciel R.
</p>


<h3>See Also</h3>

<p><code><a href="ade4.html#topic+dudi">dudi</a></code> for class <code>dudi</code>,
<code><a href="ade4.html#topic+niche">niche</a></code> for classical OMI analysis
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The data
data(puech)
locs &lt;- puech$relocations
maps &lt;- puech$maps

## the maps
mimage(maps)

## the relocations of the wild boar:
image(maps)
points(locs, col=as.numeric(slot(locs, "data")[,1]))


## count the number of relocations
## in each pixel of the maps
cp &lt;- count.points(locs, maps)

## gets the data:
dfavail &lt;- slot(maps, "data")
dfused &lt;- slot(cp, "data")

## a preliminary principal component analysis of the data:
dud &lt;- dudi.pca(dfavail, scannf=FALSE)

## The analysis:
nic &lt;- canomi(dud, dfused, scannf=FALSE)
nic

## Plot the results:
plot(nic)


</code></pre>

<hr>
<h2 id='chamois'>Location of Chamois Groups in the Chartreuse Mountains</h2><span id='topic+chamois'></span>

<h3>Description</h3>

<p>This data set describes the habitat use and availability by the
chamois of the Chartreuse mountains (Isere, France), in 1992 and 1997.
These data have been gathered during the hunting season (Fall).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(chamois)
</code></pre>


<h3>Details</h3>

<p>The object <code>chamois</code> is a list containing the following
components:
</p>
<p><code>locs</code> is a data frame containing the x and y coordinates
of 198 chamois groups.
</p>
<p><code>map</code> is a map of class <code>kasc</code> describing the
vegetation (Forest or Open areas), the distance from the ecotone
Open/Forest and the slopes on the area.
</p>


<h3>References</h3>

<p>Federation Departementale des Chasseurs de l'Isere,
65 av Jean Jaures, 38320 Eybens. France.
</p>

<hr>
<h2 id='compana'>Compositional Analysis of Habitat Use</h2><span id='topic+compana'></span><span id='topic+print.compana'></span>

<h3>Description</h3>

<p><code>compana</code> performs a classical compositional analysis of habitat
use (Aebischer et al., 1993).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compana(used, avail, test = c("randomisation", "parametric"),
        rnv = 0.01, nrep = 500, alpha = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compana_+3A_used">used</code></td>
<td>
<p>a matrix or a data frame describing the percentage of use
of habitats (in columns) by animals (in rows). </p>
</td></tr>
<tr><td><code id="compana_+3A_avail">avail</code></td>
<td>
<p>a matrix or a data frame describing the percentage of
availability of habitats (in columns) by animals (in rows). </p>
</td></tr>
<tr><td><code id="compana_+3A_test">test</code></td>
<td>
<p>a character string.  If <code>"randomisation"</code>,
randomisation tests are performed for
both the  habitat ranking and
the test of habitat selection.
If <code>"parametric"</code>, usual
parametric tests are performed (chi-square for the test of habitat
selection and t-tests for habitat ranking).</p>
</td></tr>
<tr><td><code id="compana_+3A_rnv">rnv</code></td>
<td>
<p>the number replacing the 0 values occurring in the
matrix <code>used</code>. </p>
</td></tr>
<tr><td><code id="compana_+3A_nrep">nrep</code></td>
<td>
<p>the number of repetitions in the
randomisation tests. </p>
</td></tr>
<tr><td><code id="compana_+3A_alpha">alpha</code></td>
<td>
<p>the alpha level for the tests. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The compositional analysis of habitat use has been recommended by
Aebischer et al. (1993) for the analysis of habitat selection by
several animals, when the resources are defined by several categories
(e.g. vegetation types).
</p>
<p>This analysis is carried out in two steps: first the significance of
habitat selection is tested (using a Wilks lambda). Then, a ranking
matrix is built, indicating whether the habitat type in row is
significantly used more or less than the habitat type in column.
When this analysis is performed on radio-tracking data, Aebischer et
al. recommend to study habitat selection at two levels: (i) selection
of the home range within the study area, and (ii) selection of the
relocations within the home range.  The first level is termed
second-order habitat selection on Johnson's scale (1980), and the
second one, third-order habitat selection.
</p>
<p>When zero values are found
in the matrix of used habitats, they are replaced by a small value (by
default, 0.01), according to the recommendations of Aebischer et al.
(1993).
</p>
<p>When zero values are found in the matrix of available habitats, the
function <code>compana</code> uses the procedure termed
&quot;weighted mean lambda&quot; described in Aebischer et al.
(1993: Appendix 2), instead of the usual lambda (see examples). Zero
values can be found in the matrix of available habitats when the
third-order habitat selection is under focus. In this case, it may
occur that some habitat types are available to some animals and not to
the others.
</p>
<p>Note that this method rely on the following hypotheses: (i)
independence between animals, and (ii) all animals are selecting
habitat in the same way (in addition to &quot;traditional&quot; hypotheses in
these kinds of studies: no territoriality, all animals having equal
access to all available resource units, etc.).  The function
<code>eisera</code> can be used as a preliminary to identify whether this is
indeed the case (see examples). 
</p>


<h3>Value</h3>

<p>Returns a list of the class <code>compana</code>:
</p>
<table>
<tr><td><code>used</code></td>
<td>
<p>the matrix of used habitats</p>
</td></tr>
<tr><td><code>avail</code></td>
<td>
<p>the matrix of available habitats</p>
</td></tr>
<tr><td><code>type.test</code></td>
<td>
<p>a character string.  Either <code>"randomisation"</code> or
<code>"parametric"</code></p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>the results of the test of habitat selection</p>
</td></tr>
<tr><td><code>rm</code></td>
<td>
<p>the ranking matrix: a square matrix with <code>nh</code> rows and
<code>nh</code> columns, where <code>nh</code> is the number of habitat types
under study.  At the intersection of the row <code>i</code> and of the
column <code>j</code>, there is a <code>"+"</code> when the habitat <code>i</code> is
more used than the habitat in column, and <code>"-"</code> otherwise.
When the difference is significant, the sign is tripled.</p>
</td></tr>
<tr><td><code>rmnb</code></td>
<td>
<p>the matrix containing the number of animals used to
perform the tests in <code>rm</code>.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>the rank of the habitat types.  It is equal to the number
of <code>"+"</code> for each habitat type in row of <code>rm</code>.</p>
</td></tr>
<tr><td><code>rmv</code></td>
<td>
<p>the matrix of statistics used to build <code>rm</code>.
If <code>(test = "parametric")</code>, the matrix contains the
values of <code>t</code>, in the t-test comparing the row and the column
habitat.  If <code>(test = "randomisation")</code>, the matrix contains
the mean difference between the used and available log-ratios (see
Aebischer et al., 1993).</p>
</td></tr>
<tr><td><code>profile</code></td>
<td>
<p>the profile of preferences: resource types are sorted
so that the left type is the most preferred and the right type is
the most avoided.  Habitats for which the intensity of habitat
selection is similar (no significant difference) are connected by a
line.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>In the examples below, the results differ from those published in
Aebischer et al. (squirrel example, selection of the relocations within
the home range). In fact, there has been a confusion in the column names
in the paper. Actually, Aebischer (pers. com.) indicated that the
ranking matrix given in this example is correct.
</p>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a></p>


<h3>References</h3>

<p>Aebischer, N. J. and Robertson, P. A. (1992) Practical aspects of
compositional analysis as applied to pheasant habitat
utilisation. pp. 285&ndash;293 In: Priede, G. and Swift, S. M. <em>Wildlife
telemetry, remote monitoring and tracking of animals</em>. 
</p>
<p>Aebischer, N. J., Robertson, P. A. and Kenward, R. E. (1993)
Compositional analysis of habitat use from animal radiotracking
data. <em>Ecology</em>, <b>74</b>, 1313&ndash;1325.
</p>
<p>Johnson, D. H. (1980) The comparison of usage and availability
measurements for evaluating resource preference. <em>Ecology</em>, <b>61</b>,
65&ndash;71.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+eisera">eisera</a></code> to perform an eigenanalysis of selection
ratios, preliminary to the use of compositional analysis. </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The examples presented here
## are the same as those presented in
## the paper of Aebischer et al. (1993)


#############################
## Pheasant dataset: first
## example in Aebischer et al.

data(pheasant)

## Second order habitat selection
## Selection of home range within the
## study area (example of parametric test)
pheana2 &lt;- compana(pheasant$mcp, pheasant$studyarea,
                   test = "parametric")
pheana2

## The ranking matrix:
print(pheana2$rm, quote = FALSE)

## Third order habitat selection
## (relocation within home range)
## We remove the first pheasant of the analysis
## (as in the paper of Aebischer et al.)
## before the analysis
pheana3 &lt;- compana(pheasant$locs[-1,], pheasant$mcp[-1,c(1,2,4)])
pheana3

## The ranking matrix:
print(pheana3$rm, quote = FALSE)



#############################
## Squirrel data set: second
## example in Aebischer et al.

data(squirrel)

## Second order habitat selection
## Selection of home range within the
## study area
squiana2 &lt;- compana(squirrel$mcp, squirrel$studyarea)
squiana2

## The ranking matrix:
print(squiana2$rm, quote = FALSE)


## However, note that here, the hypothesis of identical use 
## on which this analysis relies is likely to be false.
## Indeed, an eisera indicates:

us &lt;- round(30 * squirrel$locs / 100)
av &lt;- squirrel$studyarea
ii &lt;- eisera(us, av, scannf = FALSE)
scatter(ii, grid = FALSE, clab = 0.7)

## There are clearly two groups of animals.  In such cases,
## compositional analysis is to be avoided in this case.




## Third order habitat selection
## (relocation within home range)
## We remove the second column
## (as in the paper of Aebischer et al.)
squiana3 &lt;- compana(squirrel$locs[,-2], squirrel$mcp[,-2])
squiana3

## The ranking matrix:
print(squiana3$rm, quote = FALSE)


</code></pre>

<hr>
<h2 id='domain'>Estimation of the Potential Distribution of a Species </h2><span id='topic+domain'></span>

<h3>Description</h3>

<p><code>domain</code> uses the DOMAIN algorithm to estimate the potential
distribution of a species based on a list of species occurrences and on
maps of the area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>domain(x, pts, type = c("value", "potential"), thresh = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="domain_+3A_x">x</code></td>
<td>
<p>an object of class <code>SpatialPixelsDataFrame</code></p>
</td></tr>
<tr><td><code id="domain_+3A_pts">pts</code></td>
<td>
<p>a data frame giving the x and y coordinates of the species
occurrences.</p>
</td></tr>
<tr><td><code id="domain_+3A_type">type</code></td>
<td>
<p>a character string. The <code>"value"</code> of the suitability
may be returned 
or the <code>"potential"</code> area of distribution</p>
</td></tr>
<tr><td><code id="domain_+3A_thresh">thresh</code></td>
<td>
<p>if <code>value = "potential"</code>, a threshold value should be
supplied for the suitability (by default 0.95)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the DOMAIN algorithm described in Carpenter
et al. (1993).
</p>


<h3>Value</h3>

<p>Returns an object of class <code>SpatialPixelsDataFrame</code>.
</p>


<h3>Warning </h3>

<p><code>domain</code> is restricted to maps
containing only numerical variables (i.e. no factors).
</p>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a> </p>


<h3>References</h3>

<p>Carpenter, G., Gillison, A.N. and Winter, J. (1993)
DOMAIN: a flexible modelling
procedure for mapping potential distributions of plants and
animals. <em>Biodiversity and conservation</em>, <b>2</b>, 667&ndash;680.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+mahasuhab">mahasuhab</a></code>   </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Preparation of the data
data(lynxjura)
map &lt;- lynxjura$map
pts &lt;- lynxjura$locs

## View of the data
image(map)
title(main="Elevation")
points(pts, pch = 3)

## Estimation of habitat suitability map
hsm &lt;- domain(map, pts)

image(hsm, col = grey((1:256)/256))
contour(hsm, add = TRUE)

## Lighter areas are the most used areas

## Potential distribution
hsm &lt;- domain(map, pts, type = "potential", thresh = 0.98)
image(hsm, col = "orange")
title(main = "Habitat suitability map")
points(pts, pch = 3)

</code></pre>

<hr>
<h2 id='dunnfa'>Factorial Analysis of the Specialization in Habitat Selection
Studies.  Unpublished Work of James Dunn (University of Arkansas)</h2><span id='topic+dunnfa'></span><span id='topic+print.dunnfa'></span>

<h3>Description</h3>

<p><code>dunnfa</code> performs a factorial decomposition of the Mahalanobis
distances in habitat selection studies (see details). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dunnfa(dudi, pr, scannf = TRUE, nf = 2)
## S3 method for class 'dunnfa'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dunnfa_+3A_dudi">dudi</code></td>
<td>
<p>an object of class <code>pca</code></p>
</td></tr>
<tr><td><code id="dunnfa_+3A_pr">pr</code></td>
<td>
<p>a vector giving the utilization weights associated to
each unit</p>
</td></tr>
<tr><td><code id="dunnfa_+3A_scannf">scannf</code></td>
<td>
<p>logical.  Whether the eigenvalues barplot should be
displayed</p>
</td></tr>
<tr><td><code id="dunnfa_+3A_nf">nf</code></td>
<td>
<p>an integer indicating the number of kept axes</p>
</td></tr>
<tr><td><code id="dunnfa_+3A_x">x</code></td>
<td>
<p>an object of class <code>dunnfa</code></p>
</td></tr>
<tr><td><code id="dunnfa_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the function
<code>print</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This analysis is in essence very similar to the MADIFA (see
<code>?madifa</code>).   The Mahalanobis distances are often used in the
context of niche-environment studies (Clark et al. 1993, see the
function  <code>mahasuhab</code>).  Each resource unit takes a value on a
set of environmental variables.  Each environmental variable defines a
dimension in a multidimensionnal space, namely the ecological space.
A set of points (resource units) describes what is available to the
species.  For each point, a &quot;utilization weight&quot; measures the
intensity of use of the point by the species.  The set of points for
which the utilization weight is greater than zero defines the
&quot;niche&quot;. The Mahalanobis distance between any resource unit in this
space (e.g. the point defined by the values of environmental variables
in a pixel of a raster map) and the centroid of the niche (the
distribution of used resource units) can be used to give a value of
eccentricity to this point.
</p>
<p>For a given distribution of available resource units, for which a
measure of Mahalanobis distances is desired, the MADIFA (MAhalanobis
DIstances Factor Analysis) partitions the ecological space into a set
of axes, so that the first axes maximises the average proportion of
their squared Mahalanobis distances.  James Dunn (formerly University
of Arkansas) proposed the analysis programmed in the function
<code>dunnfa</code>, as an alternative to the MADIFA (unpublished
results).  This analysis is closely related to both the ENFA
(Ecological niche factor analysis, Hirzel et al. 2002) and the
MADIFA.
</p>
<p>The analysis proposed by James Dunn searches, in the multidimensional
space defined by environmental variables, synthesis variables which
maximise the ratio (variance of the scores of available resource
units) / (variance of the scores of used resource units).  This ratio
is sometimes called &quot;specialization&quot; in the ecological literature
(Hirzel et al. 2002).  It is therefore very similar to the ENFA (which
also maximises the specialization), except that the factorial axes
returned by this analysis are not required to be *orthogonal to the
marginality axis*.
</p>
<p>James Dunn demonstrated that this analysis also partitions the
Mahalanobis distances into uncorrelated axes, which makes it similar
to the MADIFA (the difference is that the MADIFA maximises the mean
squared Mahalanobis distances on the first axes, whereas the DUNNFA
maximises the specialization on the first axes).  Therefore, as for
the MADIFA, the DUNNFA can be used to build reduced rank habitat
suitability map.
</p>
<p>Note that although this analysis could theoretically be used with all
kinds of variables, it it currently implemented only for numeric
variables.
</p>


<h3>Value</h3>

<p><code>dunnfa</code> returns a list of class <code>dunnfa</code> containing the
following components: 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>original call.</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>a data frame with n rows and p columns (original data frame
centered by column for the uniform weighting).</p>
</td></tr>
<tr><td><code>pr</code></td>
<td>
<p>a vector of length n containing the number of points in each
pixel of the map.</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>the number of kept axes.</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>a vector with all the eigenvalues of the analysis.</p>
</td></tr>
<tr><td><code>liA</code></td>
<td>
<p>row coordinates (centering on the centroid of the cloud of
available points), data frame with n rows and nf columns.</p>
</td></tr>
<tr><td><code>liU</code></td>
<td>
<p>row coordinates (centering on the centroid of the cloud of
available points), data frame with p rows and nf columns.</p>
</td></tr>
<tr><td><code>mahasu</code></td>
<td>
<p>a vector of length n containing the reduced-rank squared
Mahalanobis distances for the n units.</p>
</td></tr>
<tr><td><code>co</code></td>
<td>
<p>column (environmental variables) coordinates, a data frame
with p rows and nf columns</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p>the correlation between the DUNNFA axes and the original
variable</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This analysis was developed by James Dunn during an e-mail discussion
on the MADIFA, and is still unpublished work.  Implemented in
adehabitatHS with his autorization.
</p>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a>
</p>


<h3>References</h3>

<p>Clark, J.D., Dunn, J.E. and Smith, K.G. (1993) A multivariate model of
female black bear habitat use for a geographic information
system. <em>Journal of Wildlife Management</em>, <b>57</b>, 519&ndash;526.<br />
</p>
<p>Hirzel, A.H., Hausser, J., Chessel, D. &amp; Perrin, N. (2002)
Ecological-niche factor analysis: How to compute habitat-suitability
maps without absence data? <em>Ecology</em>, <b>83</b>, 2027&ndash;2036.  
</p>
<p>Calenge, C., Darmon, G., Basille, M., Loison, A. and Jullien
J.M. (2008) The factorial decomposition of the Mahalanobis distances
in habitat selection studies. <em>Ecology</em>, <b>89</b>, 555&ndash;566.<br />
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+madifa">madifa</a></code>, <code><a href="#topic+enfa">enfa</a></code> and
<code><a href="#topic+gnesfa">gnesfa</a></code> for related methods.  <code><a href="#topic+mahasuhab">mahasuhab</a></code> for
details about the Mahalanobis distances.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(bauges)

map &lt;- bauges$map
locs &lt;- bauges$loc

## We prepare the data for the analysis
tab &lt;- slot(map, "data")
pr &lt;- slot(count.points(locs, map), "data")[,1]

## We then perform the PCA before the analysis
pc &lt;- dudi.pca(tab, scannf = FALSE)
(dun &lt;- dunnfa(pc, pr, nf=2,
               scannf = FALSE))

## We should keep one axis:
barplot(dun$eig)

## The correlation of the variables with the first two axes:
s.arrow(dun$cor)

## A factorial map of the niche (centering on the available points)
scatterniche(dun$liA, dun$pr, pts=TRUE)

## a map of the reduced rank Mahalanobis distances
## (here, with one axis)
dun2 &lt;- dunnfa(pc, pr, nf=1,
              scannf = FALSE)
df &lt;- data.frame(MD=dun2$mahasu)
coordinates(df) &lt;- coordinates(map)
gridded(df) &lt;- TRUE
image(df)


## Compute the specialization on the row scores of
## the analysis:
apply(dun$liA, 2, function(x) {
   varav &lt;- sum((x - mean(x))^2) / length(x)
   meanus &lt;- sum(dun$pr*x)/sum(dun$pr)
   varus &lt;- sum(dun$pr * (x - meanus )^2)/sum(dun$pr)
   return(varav/varus)
})
## The eigenvalues:
dun$eig


## End(Not run)


</code></pre>

<hr>
<h2 id='eisera'>Eigenanalysis of Selection Ratios</h2><span id='topic+eisera'></span><span id='topic+print.esr'></span><span id='topic+scatter.esr'></span>

<h3>Description</h3>

<p>Performs an eigenanalysis of selection ratios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eisera(used, available, scannf = TRUE, nf = 2)
## S3 method for class 'esr'
print(x, ...)
## S3 method for class 'esr'
scatter(x, xax = 1, yax = 2, 
            csub = 1, possub = "bottomleft", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eisera_+3A_used">used</code></td>
<td>
<p>a data frame containing the *number* of relocations of
each animal (rows) in each habitat type (columns) </p>
</td></tr>
<tr><td><code id="eisera_+3A_available">available</code></td>
<td>
<p>a data frame containing the *proportion* of
availability of each habitat type (columns) to each animal (rows)</p>
</td></tr>
<tr><td><code id="eisera_+3A_scannf">scannf</code></td>
<td>
<p>logical.  Whether the eigenvalues bar plot should be
displayed</p>
</td></tr>
<tr><td><code id="eisera_+3A_nf">nf</code></td>
<td>
<p>if <code>scannf = FALSE</code>, an integer indicating the number
of kept axes</p>
</td></tr>
<tr><td><code id="eisera_+3A_x">x</code></td>
<td>
<p>an object of class <code>esr</code></p>
</td></tr>
<tr><td><code id="eisera_+3A_xax">xax</code></td>
<td>
<p>the column number for the x-axis</p>
</td></tr>
<tr><td><code id="eisera_+3A_yax">yax</code></td>
<td>
<p>the column number for the y-axis</p>
</td></tr>
<tr><td><code id="eisera_+3A_csub">csub</code></td>
<td>
<p>a character size for the legend, used with 
<code>par("cex")*csub</code></p>
</td></tr>
<tr><td><code id="eisera_+3A_possub">possub</code></td>
<td>
<p>a string of characters indicating the sub-title 
position (&quot;topleft&quot;, &quot;topright&quot;, &quot;bottomleft&quot;, 
&quot;bottomright&quot;)</p>
</td></tr>
<tr><td><code id="eisera_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The eigenanalysis of selection ratios has been developped to explore
habitat selection by animals monitored using radio-tracking, when
habitat is defined by several categories (e.g. several vegetation
types, see Calenge and Dufour 2006).<br />
</p>
<p>This analysis can be used for both designs II (same availability for
all animals, e.g. selection of the home range within the study area)
and designs III (different availability, e.g. selection of the sites
within the home range).  In the latter case, when some available
proportions are equal to zero, the selection ratios are replaced by
their expectation under random habitat use, following the
recommendations of Calenge and Dufour (2006).
</p>


<h3>Value</h3>

<p>A list of class <code>esr</code> and <code>dudi</code> containing also:
</p>
<table>
<tr><td><code>available</code></td>
<td>
<p>available proportions</p>
</td></tr>
<tr><td><code>used</code></td>
<td>
<p>number of relocations</p>
</td></tr>
<tr><td><code>wij</code></td>
<td>
<p>selection ratios</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a> </p>


<h3>References</h3>

<p>Calenge, C. and Dufour, A.B. (2006) Eigenanalysis of selection ratios
from animal radio-tracking data. <em>Ecology</em>. <b>87</b>,
2349&ndash;2355.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+wi">wi</a></code> for further information about the
selection ratios, <code><a href="#topic+compana">compana</a></code> for compositional analysis.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###########################################################
###########################################################
###
###  Example given in Calenge and Dufour 2006 (design II)


data(squirrel)

## computation of the number of relocations in each habitat type
## from the data given by Aebischer et al. (1993).
## squirrel$locs give the percentage of relocations in each habitat
## type, and Aebischer et al. (1993) indicate that there are 30
## relocations per animal.
## We therefore compute the number of relocations in each habitat type
## using:
us &lt;- round(30 * squirrel$locs / 100)

## Habitat availability 
av &lt;- squirrel$studyarea

## Eigenanalysis of selection ratios
ii &lt;- eisera(us, av, scannf = FALSE)

scatter(ii, grid = FALSE, clab = 0.7)


## The following graph may help the interpretation
## (see Calenge and Dufour 2006)
data(squirreloc)
locs &lt;- squirreloc$locs
are &lt;- squirreloc$map

ind &lt;- levels(slot(locs, "data")$id)
opar &lt;- par(mfrow=n2mfrow(length(ind)), mar=c(0,0,2,0))

tmp &lt;- lapply(1:length(ind), function(i) {
     plot(are, col = as.data.frame(are)[,2])
     title(main = ind[i])
     points(locs[slot(locs, "data")[,1]==ind[i],], pch=16, cex=1.5)
box()
})
plot(0,0, axes=FALSE, ty="n", xlim=c(-1,1), asp=1)
legend(-0.8,0.8, unique(slot(are,"data")[,1]),
       fill=unique(slot(are,"data")[,2]))
par(opar)


###########################################################
###########################################################
###
###  Example of design III

iii &lt;- eisera(us, squirrel$mcp, scannf = FALSE)
scatter(iii, grid = FALSE, clab = 0.7)

</code></pre>

<hr>
<h2 id='enfa'>Ecological Niche Factor Analysis</h2><span id='topic+enfa'></span><span id='topic+hist.enfa'></span><span id='topic+print.enfa'></span>

<h3>Description</h3>

<p><code>enfa</code> performs an Ecological Niche Factor Analysis.
<code>hist.enfa</code> draws histograms of the row scores or of the initial
variables of the ENFA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enfa(dudi, pr, scannf = TRUE, nf = 1)
## S3 method for class 'enfa'
hist(x, scores = TRUE, type = c("h", "l"), adjust = 1,
                    Acol, Ucol, Aborder, Uborder, Alwd = 1, Ulwd = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="enfa_+3A_dudi">dudi</code></td>
<td>
<p>a duality diagram, object of class <code>dudi</code> (see Details)</p>
</td></tr>
<tr><td><code id="enfa_+3A_pr">pr</code></td>
<td>
<p>a vector giving the utilization weights associated to each unit</p>
</td></tr>
<tr><td><code id="enfa_+3A_scannf">scannf</code></td>
<td>
<p>logical.  Whether the eigenvalues barplot should be displayed</p>
</td></tr>
<tr><td><code id="enfa_+3A_nf">nf</code></td>
<td>
<p>an integer indicating the number of kept
specialization axes </p>
</td></tr>
<tr><td><code id="enfa_+3A_x">x</code></td>
<td>
<p>an object of class <code>enfa</code></p>
</td></tr>
<tr><td><code id="enfa_+3A_scores">scores</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the histograms display
the row scores of the ENFA.  If <code>FALSE</code>, they display the
niche on the environmental variables (in this case, this is equivalent to
<code>histniche</code>)</p>
</td></tr>
<tr><td><code id="enfa_+3A_type">type</code></td>
<td>
<p>what type of plot should be drawn.  Possible types are:<br />
<code>"h"</code> for histograms,<br />
<code>"l"</code> for kernel density estimates (see <code>?density</code>).<br />
By default, <code>type = "h"</code> is used.  If <code>type = "l"</code> is used,
the position of the mean of each distribution is indicated by dotted
lines</p>
</td></tr>
<tr><td><code id="enfa_+3A_adjust">adjust</code></td>
<td>
<p>if <code>type = "l"</code>, a parameter used to control the
bandwidth of the density estimates (see <code>?density</code>)</p>
</td></tr>
<tr><td><code id="enfa_+3A_acol">Acol</code></td>
<td>
<p>if <code>type = "h"</code>, a color to be used to fill the histogram
of the available pixels. if <code>type = "l"</code>, a color to be used for the
kernel density estimates of the available pixels</p>
</td></tr>
<tr><td><code id="enfa_+3A_ucol">Ucol</code></td>
<td>
<p>if <code>type = "h"</code>, a color to be used to fill the histogram
of the used pixels. if <code>type = "l"</code>, a color to be used for the
kernel density estimates of the used pixels</p>
</td></tr>
<tr><td><code id="enfa_+3A_aborder">Aborder</code></td>
<td>
<p>color for the border of the histograms of the available
pixels</p>
</td></tr>
<tr><td><code id="enfa_+3A_uborder">Uborder</code></td>
<td>
<p>color for the border of the histograms of the used
pixels</p>
</td></tr>
<tr><td><code id="enfa_+3A_alwd">Alwd</code></td>
<td>
<p>if <code>type = "l"</code>, the line width of the kernel density 
estimates of the available pixels</p>
</td></tr>
<tr><td><code id="enfa_+3A_ulwd">Ulwd</code></td>
<td>
<p>if <code>type = "l"</code>, the line width of the kernel density 
estimates of the used pixels</p>
</td></tr>
<tr><td><code id="enfa_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The niche concept, as defined by Hutchinson (1957), considers the
ecological niche of a species as an hypervolume in the multidimensional
space defined by environmental variables, within
which the populations of a species can persist.  The Ecological Niche
Factor Analysis (ENFA) has been developped by Hirzel et al. (2002) to
analyse the position of the niche in the ecological space.  Nicolas
Perrin (1984) described the position of the niche in the n-dimensional
space using two measures: the M-specialization (hereafter termed marginality)
and the S-specialization (hereafter termed specialization).  The
marginality represents the squared distance of the niche barycentre from
the mean available habitat.  A large specialization corresponds to a
narrow niche relative to the habitat conditions available to the species.
</p>
<p>The ENFA first extracts an axis of marginality (vector from the average
of available habitat conditions to the average used habitat conditions).
Then the analysis extracts successives orthogonal axes (i.e. uncorrelated),
which maximises the specialization of the species.  The calculations
used in the function are described in Hirzel et al. (2002).
</p>
<p>The function <code>enfa</code> can be used on both quantitative variables and
qualitative variables (though the interpretation of the results of the
ENFA for qualitative variables is still under research), provided that
the table containing the values of habitat variables (columns) for
each resource unit (rows) is correctly transformed
(e.g. column-centered and standardised for tables containing only
quantitative variables), and that appropriate column weights are given
(e.g. the sum of the weights for
the levels of a factor should be the same as the weight of one
quantitative variable). Therefore, the function <code>enfa</code> requires
that a preliminary multivariate analysis is performed on the table
(using analysis of the family of duality diagram, e.g. principal
component analysis or Hill and Smith analysis). The object returned
by this preliminary analysis contains the appropriate weights and
transformation of the original data frame. For example, 
the function <code>dudi.mix</code> can be used first on the data.frame
containing the value of both quantitative (e.g. slope, elevation) and
qualitative habitat variables (e.g. vegetation) for each pixel of a
raster map. The result of this analysis can then be passed as argument
to the function <code>enfa</code> (see examples below).<br />
</p>


<h3>Value</h3>

<p><code>enfa</code> returns a list of class <code>enfa</code> containing the
following components: 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>original call.</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>a data frame with n rows and p columns.</p>
</td></tr>
<tr><td><code>pr</code></td>
<td>
<p>a vector of length n containing the number of points in each
pixel of the map.</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>the number of kept specialization axes.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>the marginality (squared length of the marginality vector).</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>a vector with all the eigenvalues of the analysis.</p>
</td></tr>
<tr><td><code>lw</code></td>
<td>
<p>row weights, a vector with n components.</p>
</td></tr>
<tr><td><code>li</code></td>
<td>
<p>row coordinates, data frame with n rows and nf columns.</p>
</td></tr>
<tr><td><code>cw</code></td>
<td>
<p>column weights, a vector with p components.</p>
</td></tr>
<tr><td><code>co</code></td>
<td>
<p>column coordinates, data frame with p rows and nf columns.</p>
</td></tr>
<tr><td><code>mar</code></td>
<td>
<p>coordinates of the marginality vector.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mathieu Basille <a href="mailto:basille@ase-research.org">basille@ase-research.org</a> </p>


<h3>References</h3>

<p>Hutchinson, G.E. (1957) Concluding Remarks. <em>Cold Spring Harbor
Symposium on Quantitative Biology</em>, <b>22</b>: 415&ndash;427. 
</p>
<p>Perrin, N. (1984) Contribution a l'ecologie du genre Cepaea
(Gastropoda) : Approche descriptive et experimentale de l'habitat et
de la niche ecologique. These de Doctorat. Universite de Lausanne,
Lausanne. 
</p>
<p>Hirzel, A.H., Hausser, J., Chessel, D. and Perrin, N. (2002)
Ecological-niche factor analysis: How to compute habitat-suitability
maps without absence data? <em>Ecology</em>, <b>83</b>, 2027&ndash;2036.
</p>
<p>Basille, M., Calenge, C., Marboutin, E., Andersen, R. and Gaillard,
J.M. (2008) Assessing habitat selection using multivariate statistics:
Some refinements of the ecological-niche factor
analysis. <em>Ecological Modelling</em>, <b>211</b>, 233&ndash;240.
</p>


<h3>See Also</h3>

<p><code><a href="ade4.html#topic+niche">niche</a></code>, <code><a href="#topic+kselect">kselect</a></code> for other types of
analysis of the niche, when several species are under studies,
and <code><a href="#topic+scatter.enfa">scatter.enfa</a></code> to have a
graphical display of objects of class
<code>enfa</code>.  See <code><a href="#topic+madifa">madifa</a></code> for another factorial analysis of
the ecological niche.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(lynxjura)

map &lt;- lynxjura$map

## We keep only "wild" indices.
locs &lt;- lynxjura$locs
locs &lt;- locs[slot(locs, "data")[,2]!="D",]

hist(map, type = "l")
## The variable artif is far from symetric

## We perform a square root transformation
## of this variable
## We therefore normalize the variable 'artif'
slot(map,"data")[,4] &lt;- sqrt(slot(map,"data")[,4])
hist(map, type = "l")

## We prepare the data for the ENFA
tab &lt;- slot(map, "data")
pr &lt;- slot(count.points(locs, map), "data")[,1]


## We then perform the PCA before the ENFA
pc &lt;- dudi.pca(tab, scannf = FALSE)

## The object 'pc' contains the transformed table (i.e.
## centered so that all columns have a mean of 0
## and scaled so that all columns have a variance of 1
## 'pc' also contains the weights of the habitat variables,
## and the weights of the pixels in the analysis

(enfa1 &lt;- enfa(pc, pr,
               scannf = FALSE))
hist(enfa1)
hist(enfa1, scores = FALSE, type = "l")


## scatterplot
scatter(enfa1)


## randomization test
## Not run: 
(renfa &lt;- randtest(enfa1))
plot(renfa)

## End(Not run)

</code></pre>

<hr>
<h2 id='engen2008II'>Measuring Habitat Selection Using the Method of Engen et al. (2008) </h2><span id='topic+engen2008II'></span><span id='topic+engen2008I'></span><span id='topic+print.engenetalI'></span><span id='topic+print.engenetalII'></span>

<h3>Description</h3>

<p>These functions implements the method described by Engen et al. to
measure the preference of animals for habitat variables in habitat
selection studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>engen2008II(us, av, id, nsim = 500, nsimra = 500)

engen2008I(us, av, nsimra=500)

## S3 method for class 'engenetalI'
print(x, ...)

## S3 method for class 'engenetalII'
print(x, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="engen2008II_+3A_us">us</code></td>
<td>
<p>a data frame containing the value of numeric habitat
variables (columns) in each site (rows) used by the animals.</p>
</td></tr>
<tr><td><code id="engen2008II_+3A_av">av</code></td>
<td>
<p>a data frame containing the value of numeric habitat
variables (columns) in each site (rows) available to the animals.</p>
</td></tr>
<tr><td><code id="engen2008II_+3A_id">id</code></td>
<td>
<p>a factor with as many elements as there are rows in
<code>us</code>, indicating the ID of the animal that used the
corresponding rows in <code>us</code>.</p>
</td></tr>
<tr><td><code id="engen2008II_+3A_nsim">nsim</code></td>
<td>
<p>the number of randomizations used in
the calculation of the total variance.</p>
</td></tr>
<tr><td><code id="engen2008II_+3A_nsimra">nsimra</code></td>
<td>
<p>the number of random allocation of ranks used in the
calculation of the normal score (see details). </p>
</td></tr>
<tr><td><code id="engen2008II_+3A_x">x</code></td>
<td>
<p>an object of class <code>engenetalI</code> or <code>engenetalII</code></p>
</td></tr>
<tr><td><code id="engen2008II_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to other functions
(currently unused)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Engen et al. (2008) proposed an original approach to measure the
preference of animals for values of each particular variable of a
multivariate set of environmental variables.  Their approach was
originally developed for the case where there is a sample of used site
is for each animal in a sample of identified animals (e.g. using
radiotelemetry or GPS), with several sites per animal (i.e., design II
according to the classification of Thomas and Taylor, 1990).  However,
we extended this approach to also include the case where habitat use
is described by a sample of used site, with one site per unidentified
animal (i.e., design I).
</p>
<p>The original approach is the following: first, a normal score
transformation of each habitat variable is performed: for each
variable, the empirical cumulative distribution is computed, by
dividing the rank of the value of each available site by the number of
observations.  Note that the ties are ranked randomly.  Then, the
inverse of the standard normal integral (see <code>?qnorm</code>) of the
cumulative distribution function is computed for all available sites:
this results into a perfectly normal distribution of the habitat
variables for the available sites.  Then, the value of the cumulative
distribution &ndash; estimated from the available sites &ndash; is computed for
each used site.  Then, the inverse of the standard normal integral is
computed for each one.
</p>
<p>Engen et al. (2008) suppose the following model describing how habitat
use results from habitat availability.  Let </p>
<p style="text-align: center;"><code class="reqn">Z_{ij}</code>
</p>
<p> be
the value of a given habitat variable (transformed according to the
normal score) for the j-th site used by the i-th animal.  Then this
value can be described by the model:
</p>
<p style="text-align: center;"><code class="reqn">Z_{ij} = \mu + U_i + V_{ij}</code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">\mu</code>
</p>
<p> is the preference for the habitat variable (0
indicates a non-preference), </p>
<p style="text-align: center;"><code class="reqn">U_i</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">V_{ij}</code>
</p>

<p>are normal distributions with means equal to zero and variances equal
to </p>
<p style="text-align: center;"><code class="reqn">\sigma^2</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">\tau^2</code>
</p>
<p> respectively.
Engen et al. give fomula for the estimation of these parameters.
Their estimation is done by first estimating the total variance
</p>
<p style="text-align: center;"><code class="reqn">\sigma^2+ \tau^2</code>
</p>
<p> (this variance is estimated
by sampling randomly one observation per animal &ndash; the parameter
<code>nsim</code> controls the number of samples used in this computation;
see Engen et al. 2008).  Note that the correlation between the value
observed for two used units sampled from all the units used by a given
animal is </p>
<p style="text-align: center;"><code class="reqn">\rho = \sigma^2/(\sigma^2 + \tau^2)</code>
</p>
<p>.  A large value of rho indicates a large variation
in the habitat used between animals (or a small within-animal
variation).  The main parameter of concern is here the preference.
The function <code>engen2008II</code> allows to estimate these
parameters.
</p>
<p>The function <code>engen2008I</code> extends this model for design I
studies (a sample of used sites and a sample of available sites,
animals not identified), by considering the following model for these
studies:
</p>
<p style="text-align: center;"><code class="reqn">Z_{ij} = \mu + V_{ij}</code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">\mu</code>
</p>
<p> is the preference for the habitat variable (0
indicates a non-preference), and </p>
<p style="text-align: center;"><code class="reqn">V_{ij}</code>
</p>

<p>are normal distributions with means equal to zero and variances equal
to </p>
<p style="text-align: center;"><code class="reqn">\sigma^2</code>
</p>
<p>.
</p>
<p>Note that the habitat variables may be correlated on the study
area. In this case, observed preference for a given variable may be
an artefact of other variables prefered by animals.  Supposing that
the data.frame containing the </p>
<p style="text-align: center;"><code class="reqn">Z_{ij}</code>
</p>
<p>'s is a realization
of a multivariate normal distribution, we can compute, for each
habitat variable and each used site, the *conditional* mean
</p>
<p style="text-align: center;"><code class="reqn">m_{ij}</code>
</p>
<p> and *conditional* standard deviation
</p>
<p style="text-align: center;"><code class="reqn">s_{ij}</code>
</p>
<p> of this variable at this site, *given* the values
of the other habitat variables at this site (this is done using the
algorithm described by Ripley, 1987, p.98).  We then compute the
standardized values </p>
<p style="text-align: center;"><code class="reqn">P_{ij} = (Z_{ij} - m_{ij})/s_{ij}</code>
</p>
<p>.  The preference is then computed using these
standardized values.
</p>
<p>Because there may be ties in the distribution of values of habitat
variables, the results may vary depending on the random order chosen
for ties when computing the normal scores.  Engen et al. recommended
to repeat the function a large number of times, and to use the mean
values as estimates of the parameters.  This is what the function
does, and the number of randomization is controlled by the parameter
<code>nsimra</code>.
</p>
<p>Note that all these methods rely on the following hypotheses: (i)
independence between animals, (ii) independence between sites, and
(iii) all animals are selecting habitat in the same way (in addition
to &quot;traditional&quot; hypotheses in these kinds of studies: no
territoriality, all animals having equal access to all available
resource units, etc., see Manly et al. 2002 for further details).
</p>
<p>That the examples below provide an illustration and discussion of
interesting and (at first sight) surprising properties of this
method.
</p>


<h3>Value</h3>

<p><code>engen2008I</code> returns a list of class <code>engenetalI</code>, and
<code>engen2008II</code> returns a list of class <code>engenetalII</code>.  Both
types of list contain two elements:
</p>
<table>
<tr><td><code>raw</code></td>
<td>
<p>this is a list containing one data frame per habitat
variable, containing the value of the correlation rho (for
<code>engenetalII</code> objects), mean preferences and standard error of
these preferences (columns) for each randomization performed (rows);</p>
</td></tr>
<tr><td><code>results</code></td>
<td>
<p>a data frame containing the mean values over all
the randomizations, of these parameters (columns) for each habitat
variable (rows).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Be patient! these functions can be very long (depending on the number of
sites and on the value of <code>simra</code>)  
</p>


<h3>Author(s)</h3>

<p> Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a> </p>


<h3>References</h3>

<p>Engen, S., Grotan, V., Halley, D. and Nygard, T. (2008) An efficient
multivariate approach for estimating preference when individual
observations are dependent. <em>Journal of Animal Ecology</em>,
<b>77</b>: 958&ndash;965.
</p>
<p>Thomas, D. and Taylor, E. (1990) Study designs and tests for comparing
resource use and availability. <em>Journal of Wildlife Management</em>,
<b>54</b>, 322&ndash;330.
</p>
<p>Ripley, B. (1987) Stochastic Simulation. John Wiley and Sons.   
</p>


<h3>See Also</h3>

 <p><code><a href="ade4.html#topic+niche">niche</a></code>, <code><a href="#topic+madifa">madifa</a></code>,
<code><a href="#topic+gnesfa">gnesfa</a></code> for another approach to tackle the study of
habitat selection.  For categorical variables, see
<code><a href="#topic+kselect">kselect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

#################################
#################################
#################################

## Practical use of engen2008II

data(puechabonsp)
map &lt;- puechabonsp$map

## Removes the aspect (no factor allowed in the function)
slot(map,"data")$Aspect &lt;- NULL

## engen2008II:
avail &lt;- slot(map, "data")
use &lt;- join(puechabonsp$relocs, map)
id &lt;- slot(puechabonsp$relocs, "data")$Name

## This function can be very long:
engen2008II(use, avail, id, nsimra=10)




## Practical use of engen2008I

data(lynxjura)
ma &lt;- lynxjura$map
lo &lt;- lynxjura$locs
av &lt;- slot(ma, "data")
us &lt;- join(lo, ma)
us &lt;- us[!is.na(us[,1]),]

## Idem, be patient here:
engen2008I(us, av, nsimra=10)




#################################
#################################
#################################
##
##  For a deeper discussion on
##  this method... a simulation:



#################################
##
## First, simulation of a dataset
## copy and paste this part into R,
## but skip the reading of the
## comments if you are not interested
## into this simulation

## simulate the available points

suppressWarnings(RNGversion("3.5.0"))
set.seed(235)
av &lt;- cbind(rnorm(1000, mean=0, sd=3), rnorm(1000, mean=0, sd=0.5))
tt &lt;- cbind(c(cos(-pi/4),sin(-pi/4)),c(cos(pi/4), sin(pi/4)))
av &lt;- as.data.frame(as.matrix(av)%*%tt)

## simulate the used points: we simulate a selection on the first
## principal component of the PCA of the data.frame describing the
## availability. In other words, we simulate the case where the
## habitat selection occurs on the "common part" of the two habitat
## variable (no preference for one particular variable).

us &lt;- do.call("rbind", lapply(1:5, function(i) {
    us1 &lt;- cbind(rnorm(30, mean=rnorm(1, -4, 1), sd=0.5),
                 rnorm(30, mean=rnorm(1, 0, 0.5), sd=0.2))

    return(us1%*%tt)
}))
colnames(us) &lt;- colnames(av) &lt;- c("var1", "var2")
id &lt;- gl(5,30)


#################################
##
## Study of the habitat selection on these data
## The data are:
## - us: a matrix containing the used sites for two
##       habitat variables
## - av: a matrix containing the available sites for two
##       habitat variables
## - id: a vector containing the id of 5 animals

## First illustrate the use and availability of the two variables:

plot(av, xlab="Habitat variable 1", ylab="Habitat variable 2",
     col="grey", pch=16)
lius &lt;- split(as.data.frame(us), id)
junk &lt;- lapply(1:5, function(i) points(lius[[i]], pch=16, col=i))

## -----&gt; ***It is very clear that there is a selection***:
## the animals select the low values of both habitat variables.
## (this is what we actually simulated)


## Now perform the method of Engen et al. (2008):
engen2008II(us, av, id)


## Surprisingly, the method seems to fail to identify the clear
## habitat selection identified graphically...
##
## In fact, it does not fail:
## this method identifies the part of habitat selection that is clearly
## attributable to a given variable.  Here the animals select the
## the common factor expressed in the two variables, and it is impossible
## to identify whether the selection is due only to the variable 1 or to
## the variable 2: it is caused by both variable simultaneously.
## Once the selection on the variable 2 (including the common part)
## has been removed, there is no longer appearant selection on
## variable 1.  Once the selection caused by the variable 1
## (including the common part) has been removed, there is no
## longer selection on variable 2...
##
## For this reason, Engen et al. recommended to use this method
## concurrently with other factor analyses of the habitat selection
## such as madifa, kselect, niche (in ade4 package), etc.
##
## Note also the strong correlation between the value of two random
## points used by a given animal. This indicates a strong variability
## among animals...




## End(Not run)


</code></pre>

<hr>
<h2 id='gnesfa'>General Niche-Environment System Factor Analysis</h2><span id='topic+gnesfa'></span><span id='topic+print.gnesfa'></span>

<h3>Description</h3>

<p>The function <code>gnesfa</code> allows to perform a general
niche-environment system factor analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gnesfa(dudi, Focus, Reference,
       centering = c("single", "twice"),
       scannf = TRUE, nfFirst = 2, nfLast = 0)
## S3 method for class 'gnesfa'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gnesfa_+3A_dudi">dudi</code></td>
<td>
<p>an object of class <code>dudi</code></p>
</td></tr>
<tr><td><code id="gnesfa_+3A_focus">Focus</code></td>
<td>
<p>a vector containing the focus weights</p>
</td></tr>
<tr><td><code id="gnesfa_+3A_reference">Reference</code></td>
<td>
<p>a vector containing the reference weights</p>
</td></tr>
<tr><td><code id="gnesfa_+3A_centering">centering</code></td>
<td>
<p>a character string indicating the type of centering
(see details)</p>
</td></tr>
<tr><td><code id="gnesfa_+3A_scannf">scannf</code></td>
<td>
<p>a logical value indicating whether the eigenvalues bar
plot should be displayed</p>
</td></tr>
<tr><td><code id="gnesfa_+3A_nffirst">nfFirst</code></td>
<td>
<p>the number of first axes to be kept</p>
</td></tr>
<tr><td><code id="gnesfa_+3A_nflast">nfLast</code></td>
<td>
<p>the number of last axes to be kept</p>
</td></tr>
<tr><td><code id="gnesfa_+3A_x">x</code></td>
<td>
<p>an object of class GNESFA</p>
</td></tr>
<tr><td><code id="gnesfa_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to other functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The GNESFA is an algorithm which generalises several factor analyses
of the ecological niche.  A table X gives the values of
P environmental variables in N resource units (e.g. the pixels of a
raster map).  A distribution of weights D describes the availability
of the resource units to the species (if not specified, these weights
are considered to be uniform).  Another distribution of weights Dp
describes the use of the resource units by the species (for example
the proportion of relocations in each pixel of a raster map).
</p>
<p>Each environmental variable defines a dimension in a multidimensional
space, the ecological space. The N resource units define a cloud of
points in this space.  Each point is associated to two weights.
The GNESFA finds, in the ecological space, the directions on which
these two distributions of weights are the most different.
</p>
<p>The GNESFA relies on a choice of the analyst, followed by three
steps.  Before all, the analyst has to choose one distribution of
weights as the Reference distribution, and the other one as the Focus
distribution;  (i) The first table X is centred on the centroid of the
Reference distribution;  (ii) a principal component analysis of this
Reference distribution is performed;  (iii) the cloud of points is
distorted, so that the Reference distribution takes a standard
spherical shape;  (iv) a non centred principal component analysis of
the Focus distribution allows to identify the directions of the
ecological space where the two distributions are the most different.
</p>
<p>Depending on the distribution chosen as Reference, this algorithm
returns results with different meanings (see examples).  This
algorithm is closely related to several common analyses of habitat
selection/niche (ENFA, MADIFA, Mahalanobis distances, selection
ratios, etc.).  The examples below give some examples of the
mathematical properties of this algorithm.  
</p>
<p>Note that the function takes a parameter named <code>centering</code>.
Indeed, two types of centering can be performed prior to the GNESFA.
The choice <code>"single"</code> consists in the centering of the cloud of
point in the ecological space on the centroid of the Reference
distribution.   The choice <code>"twice"</code> consist to center the cloud
of points on both the centroid of the Reference distribution and the
centroid of the Focus distribution.  This is done by projecting the
cloud of points on the hyperplane orthogonal to the marginality vector
(the vector connecting the two centroids.  If this choice is done, the
GNESFA is identical to the commonly used Ecological Niche Factor
Analysis (see examples).
</p>


<h3>Value</h3>

<p><code>gnesfa</code> returns a list of class <code>gnesfa</code> containing the
following components: 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>original call.</p>
</td></tr>
<tr><td><code>centering</code></td>
<td>
<p>The type of centering required.</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>a data frame with n rows and p columns.</p>
</td></tr>
<tr><td><code>Reference</code></td>
<td>
<p>a vector of length n containing the Reference
weights.</p>
</td></tr>
<tr><td><code>Focus</code></td>
<td>
<p>a vector of length n containing the Focus
weights.</p>
</td></tr>
<tr><td><code>nfFirst</code></td>
<td>
<p>the number of kept first axes.</p>
</td></tr>
<tr><td><code>nfLast</code></td>
<td>
<p>the number of kept last axes.</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>a vector with all the eigenvalues of the analysis.</p>
</td></tr>
<tr><td><code>li</code></td>
<td>
<p>row coordinates, data frame with n rows and nf columns.</p>
</td></tr>
<tr><td><code>l1</code></td>
<td>
<p>row normed coordinates, data frame with n rows and nf columns.</p>
</td></tr>
<tr><td><code>co</code></td>
<td>
<p>column scores, data frame with p rows and nf columns.</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p>the correlation between the GNESFA axes and the original
variables</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a></p>


<h3>References</h3>

<p>Calenge, C. and Basille, M. (2008) A General Framework for the
Statistical Exploration of the Ecological Niche. <em>Journal of
Theoretical Biology</em>, <b>252</b>: 674-685.
</p>
<p>Calenge, C., Darmon, G., Basille, M., Loison, A. and Jullien,
J.M. (2008) The factorial decomposition of the Mahalanobis distances
in habitat selection studies. <em>Ecology</em>, <b>89</b>, 555-566.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+madifa">madifa</a></code>, <code><a href="#topic+mahasuhab">mahasuhab</a></code>,
<code><a href="#topic+enfa">enfa</a></code>, <code><a href="#topic+wi">wi</a></code> for closely related methods (see
Examples)</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

################################################################
##
## Study of the habitat selection by the chamois in the French
## mountains of Les Bauges


## Loads the data
data(bauges)
names(bauges)
map &lt;- bauges$map
locs &lt;- bauges$locs


## displays the data
mimage(map)
image(map,1)
points(locs, pch = 3)


## Prepares the data for the GNESFA:
tab &lt;- slot(map, "data")
Dp &lt;- slot(count.points(locs,map), "data")[,1]
pc &lt;- dudi.pca(tab, scannf = FALSE)


## Example of use with Dp = Reference
gn &lt;- gnesfa(pc, Reference = Dp, scannf=FALSE)

## One main axis:
barplot(gn$eig)

## The correlation with variables indicate that
## the elevation, the proximity to grass and to
## deciduous forests:
s.arrow(gn$cor)

## The factorial map of the niche...
scatterniche(gn$li, Dp, pts = TRUE)

## The chamois is rather located at high elevation,
## in the grass, far from deciduous forests




##########################################################
##########################################################
##
##
##       Some interesting properties of the GNESFA
##
##
##########################################################
##########################################################



################################
################################
##
## Interesting properties of the
## choice: Dp as Reference
## identical to the MADIFA
## (Calenge et al. 2008),
## See the help page of the function madifa
## for other properties)

gn &lt;- gnesfa(pc, Reference = Dp, scannf=FALSE,
             nfFirst = 7)
gn

## This is the same as the MADIFA:
mad &lt;- madifa(pc, Dp, scannf=FALSE)

## Indeed:
plot(gn$li[,1], mad$li[,1])
cor(gn$li[,1], mad$li[,1])


## And consequently the sum of the squared scores,
## On the axes of the GNESFA...
su &lt;- apply(gn$l1,1,function(x) sum(x^2))


## ... is equal to the Mahalanobis distances between
## the points and the centroid of the niche
## (Clark et al. 1993, see the help page of mahasuhab)

su2 &lt;- slot(mahasuhab(map, locs), "data")[,1]


## Indeed:
all(su - su2 &lt; 1e-7)
plot(su, su2)




################################
################################
##
## Centering twice is identical to
## the ENFA (Hirzel et al. 2002, see the help
## page of the function enfa)...


#######
##
## ... If Dp is the Reference:

gn &lt;- gnesfa(pc, Reference = Dp, center = "twice", scannf = FALSE)
gn

enf &lt;- enfa(pc, Dp, scannf = FALSE)
plot(enf$li[,2], gn$li[,1])
cor(enf$li[,2], gn$li[,1])

## The first specialization axis of the ENFA
## is the first axis of the GNESFA!


#######
##
## ... If Dp is the Focus:

gn &lt;- gnesfa(pc, Focus = Dp, center = "twice",
             scannf = FALSE, nfFirst = 6)
plot(enf$li[,2], gn$li[,6])
cor(enf$li[,2], gn$li[,6])

## The first specialization axis of the ENFA
## is the last axis of the GNESFA!


#######
##
## Whatever the distribution chosen as Reference,
## projecting the cloud of points on the hyperplane
## orthogonal to the marginality axis, and performing
## a GNESFA in this subspace is identical to an ENFA!


## The marginality axis of the ENFA is identical
## to the component "projmar" of the GNESFA

plot(enf$li[,1],gn$projmar)
cor(enf$li[,1],gn$projmar)




################################
################################
##
## Interesting properties of the
## case: Dp as Focus, one categorical
## variable. Relationships with the selection
## ratios of Manly et al. (1972, see the
## help page of wi)


## For example, take the Elevation, and
## define a factor with 4 levels
elev &lt;- data.frame(el = cut(slot(map, "data")$Elevation, 4))

## Now, compute the complete disjonctive table
dis &lt;- acm.disjonctif(elev)
head(dis)

## Now perform the GNESFA with Dp as Focus:
pc &lt;- dudi.pca(dis, scannf = FALSE)
gn &lt;- gnesfa(pc, Dp, scannf = FALSE, nfFirst = 3)


#######
##
## This analysis is closely related to the concept of
## selection ratios

## Compute the percentage of use of each level:
us &lt;- apply(dis, 2, function(x) sum(x*Dp)/sum(Dp))
av &lt;- apply(dis, 2, function(x) sum(x)/length(x))

## The selection ratios
wi &lt;- widesI(us, av)$wi

## Compute the sum of the eigenvalue
sum(gn$eig)

## Compute the sum of the selection ratios - 1
sum(wi) - 1

## In other words, when the GNESFA (Dp as Focus) is
## applied on only one categorical variable, this
## analysis finds a set of axes which partition the
## sum of the selection ratios so that it is maximum
## on the first axes!!



## End(Not run)

</code></pre>

<hr>
<h2 id='histniche'>Histograms of the Ecological Niche</h2><span id='topic+histniche'></span>

<h3>Description</h3>

<p><code>histniche</code> draws histograms of the niche-environment system: an
histogram of the available resource units (environment) is drawn on
the same graph as an histogram of the used resource units (i.e. the
niche), for comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>histniche(x, pr, type = c("h", "l"), adjust = 1,
          Acol, Ucol, Aborder, Uborder, Alwd = 1,
          Ulwd = 1, ylim, ncla = 15, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="histniche_+3A_x">x</code></td>
<td>
<p>a data frame giving the value of environmental variables
(columns) in resource units (rows, e.g. the pixels of a
raster map)</p>
</td></tr>
<tr><td><code id="histniche_+3A_pr">pr</code></td>
<td>
<p>a vector of integers with the same length as <code>nrow(x)</code>
(giving for example the number of detections in the pixels)</p>
</td></tr>
<tr><td><code id="histniche_+3A_type">type</code></td>
<td>
<p>what type of plot should be drawn.  Possible types are:<br />
* <code>"h"</code> for histograms,<br />
* <code>"l"</code> for kernel density estimates (see <code>?density</code>).<br />
By default, <code>type = "h"</code> is used.  If <code>type = "l"</code> is used,
the position of the mean of each distribution is indicated by dotted
lines</p>
</td></tr>
<tr><td><code id="histniche_+3A_adjust">adjust</code></td>
<td>
<p>if <code>type = "l"</code>, a parameter used to control the
bandwidth of the density estimate (see <code>?density</code>)</p>
</td></tr>
<tr><td><code id="histniche_+3A_acol">Acol</code></td>
<td>
<p>color for the histograms of the available pixels</p>
</td></tr>
<tr><td><code id="histniche_+3A_ucol">Ucol</code></td>
<td>
<p>color for the histograms of the used pixels</p>
</td></tr>
<tr><td><code id="histniche_+3A_aborder">Aborder</code></td>
<td>
<p>if <code>type = "h"</code>, color for the border of the
histograms of the available pixels (see <code>help(hist.default)</code>)</p>
</td></tr>
<tr><td><code id="histniche_+3A_uborder">Uborder</code></td>
<td>
<p>if <code>type = "h"</code>, color for the border of the
histograms of the used pixels (see <code>help(hist.default)</code>)</p>
</td></tr> 
<tr><td><code id="histniche_+3A_alwd">Alwd</code></td>
<td>
<p>if <code>type = "l"</code>, line width for the density estimate
of the available pixels</p>
</td></tr> 
<tr><td><code id="histniche_+3A_ulwd">Ulwd</code></td>
<td>
<p>if <code>type = "l"</code>, line width for the density estimate
of the used pixels</p>
</td></tr> 
<tr><td><code id="histniche_+3A_ylim">ylim</code></td>
<td>
<p>the limits for the y axis</p>
</td></tr>
<tr><td><code id="histniche_+3A_ncla">ncla</code></td>
<td>
<p>The number of classes of the histogram</p>
</td></tr> 
<tr><td><code id="histniche_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mathieu Basille <a href="mailto:basille@ase-research.org">basille@ase-research.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

data(puechabonsp)
cp &lt;- count.points(puechabonsp$relocs, puechabonsp$map)
puechabonsp$map

histniche(slot(puechabonsp$map, "data"), slot(cp, "data")[,1])
histniche(slot(puechabonsp$map, "data"), slot(cp, "data")[,1],
          ty="l")


## End(Not run)
</code></pre>

<hr>
<h2 id='kselect'> K-Select Analysis: a Method to Analyse the Habitat Selection by
Animals  </h2><span id='topic+kselect'></span><span id='topic+print.kselect'></span><span id='topic+hist.kselect'></span><span id='topic+kplot.kselect'></span><span id='topic+plot.kselect'></span><span id='topic+prepksel'></span>

<h3>Description</h3>

<p>Performs a multivariate analysis of ecological data (K-select analysis).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kselect(dudi, factor, weight, scannf = TRUE, nf = 2, ewa = FALSE)
## S3 method for class 'kselect'
print(x, ...)
## S3 method for class 'kselect'
kplot(object, xax = 1, yax = 2, csub = 2, possub = c("topleft",
              "bottomleft", "bottomright", "topright"),
              addval = TRUE, cpoint = 1, csize = 1, clegend = 2, ...)
## S3 method for class 'kselect'
hist(x, xax = 1, mar=c(0.1,0.1,0.1,0.1),
             ncell=TRUE, csub=2,
             possub=c("bottomleft", "topleft",
                      "bottomright", "topright"),
             ncla=15, ...)
## S3 method for class 'kselect'
plot(x, xax = 1, yax = 2, ...)
prepksel(sa, hr, locs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kselect_+3A_dudi">dudi</code></td>
<td>
<p>an object of class <code>dudi</code></p>
</td></tr>
<tr><td><code id="kselect_+3A_factor">factor</code></td>
<td>
<p>a factor with the same length as <code>nrow(dudi$tab)</code></p>
</td></tr>
<tr><td><code id="kselect_+3A_weight">weight</code></td>
<td>
<p>a numeric vector of integer values giving the weight
associated to the rows of <code>dudi$tab</code></p>
</td></tr>
<tr><td><code id="kselect_+3A_scannf">scannf</code></td>
<td>
<p>logical. Whether the eigenvalues bar plot
should be displayed</p>
</td></tr>
<tr><td><code id="kselect_+3A_nf">nf</code></td>
<td>
<p>if <code>scannf = FALSE</code>, an integer indicating the number
of kept axes</p>
</td></tr>
<tr><td><code id="kselect_+3A_ewa">ewa</code></td>
<td>
<p>logical. If <code>TRUE</code>, uniform weights are given
to all animals in the analysis. If <code>FALSE</code>, animal weights are
given by the proportion of relocations of each animal (i.e. an
animal with 10 relocations has a weight 10 times lower than an
animal with 100 relocations)</p>
</td></tr>
<tr><td><code id="kselect_+3A_x">x</code>, <code id="kselect_+3A_object">object</code></td>
<td>
<p>an object of class <code>kselect</code></p>
</td></tr>
<tr><td><code id="kselect_+3A_xax">xax</code></td>
<td>
<p>the column number for the x-axis</p>
</td></tr>
<tr><td><code id="kselect_+3A_yax">yax</code></td>
<td>
<p>the column number for the y-axis</p>
</td></tr>
<tr><td><code id="kselect_+3A_addval">addval</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the frequency of the
relocations per animal is displayed (see examples)</p>
</td></tr>
<tr><td><code id="kselect_+3A_cpoint">cpoint</code></td>
<td>
<p>the size of the points (if 0, the points where no
relocations are found are not displayed)</p>
</td></tr>
<tr><td><code id="kselect_+3A_mar">mar</code></td>
<td>
<p>the margin parameter (see <code>help(par)</code>)</p>
</td></tr>
<tr><td><code id="kselect_+3A_ncell">ncell</code></td>
<td>
<p>logical. If <code>TRUE</code>, the histogram shows the
distribution of the cells of 
the raster map where at least one relocation is found. If
<code>FALSE</code>, the histogram shows the distribution of the
relocations</p>
</td></tr>
<tr><td><code id="kselect_+3A_csub">csub</code></td>
<td>
<p>the character size for the legend, used with
<code>par("cex")*csub</code></p>
</td></tr>
<tr><td><code id="kselect_+3A_csize">csize</code></td>
<td>
<p>the size coefficient for the points</p>
</td></tr>
<tr><td><code id="kselect_+3A_clegend">clegend</code></td>
<td>
<p>the character size for the legend used by
<code>par("cex")*clegend</code></p>
</td></tr>
<tr><td><code id="kselect_+3A_possub">possub</code></td>
<td>
<p>a character string indicating the sub-title position
<code>("topleft", "topright", "bottomleft", "bottomright")</code></p>
</td></tr>
<tr><td><code id="kselect_+3A_ncla">ncla</code></td>
<td>
<p>the number of classes of the histograms</p>
</td></tr>
<tr><td><code id="kselect_+3A_sa">sa</code></td>
<td>
<p>an object of class <code>SpatialPixelsDataFrame</code> containing
the values of the environmental variables on the study area</p>
</td></tr>
<tr><td><code id="kselect_+3A_hr">hr</code></td>
<td>
<p>an object of class <code>SpatialPixelsDataFrame</code> with the
same number of rows as <code>sa</code>, for which the pixels contain 1
inside the home ranges of the animals (one animal per column) and
<code>NA</code> otherwise</p>
</td></tr>
<tr><td><code id="kselect_+3A_locs">locs</code></td>
<td>
<p>an object of class <code>SpatialPixelsDataFrame</code> with the
same dimensions as <code>hr</code>, containing the number of relocations
of the animals (columns) in each pixel of <code>sa</code> (rows)</p>
</td></tr>
<tr><td><code id="kselect_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the generic function
<code>histniche</code>, <code>print</code> or, in the case of <code>plot.kselect</code>,
<code>s.distri</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The K-select analysis is intended for hindcasting studies of habitat
selection by animals using radio-tracking data.  Each habitat variable
defines one dimension in the ecological space.  For each animal, the
difference between the vector of average available habitat conditions
and the vector of average used conditions defines the marginality
vector. Its size is proportional to the importance of habitat
selection, and its direction indicates which variables are
selected. By performing a non-centered principal component analysis of
the table containing the coordinates of the marginality vectors of
each animal (row) on the habitat variables (column), the K-select
analysis returns a linear combination of habitat variables for which
the average marginality is greatest. It is a synthesis of variables
which contributes the most to the habitat selection. As with principal
component analysis, the biological significance of the factorial axes is
deduced from the loading of variables.
</p>
<p><code>prepksel</code> allows to prepare the data for the kselect analysis
(see examples).
</p>
<p><code>plot.kselect</code> returns a summary of the analysis: it displays (i)
a graph of the correlations between the principal axes of the PCA of
the objects of class <code>dudi</code> passed as argument and the factorial
axes of the K-select analysis; (ii) a graph giving the scores of the
habitat variables on the factorial axes of the K-select analysis;
(iii) the barplot of the eigenvalues of the analysis (each eigenvalue
measure the mean marginality explained by the axis; (iv) the
projection of the non-recentred marginality vectors on the factorial
plane (the origin of the arrow indicates the average available habitat
conditions, and the end of the arrow indicates the average used
conditions); (v) the projection of the resource units available to
each animal on the first factorial plane and (vi) the coordinates of
the recentred marginality vectors (i.e. recentred so that they have a
common origin) on the first factorial plane.
</p>
<p><code>kplot.kselect</code> returns one graph per animal showing the
projections of the available resource units on the factorial plane, as
well as their use by the animal.  <code>hist.kselect</code> does the same
thing, but on one dimension instead of two.
</p>


<h3>Value</h3>

<p><code>kselect</code> returns a list of the class <code>kselect</code> and
<code>dudi</code> (see <code><a href="ade4.html#topic+dudi">dudi</a></code>). 
</p>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a> </p>


<h3>References</h3>

<p>Calenge, C., Dufour, A.B. and Maillard, D. (2005) K-select analysis: a
new method to analyse habitat selection in radio-tracking
studies. <em>Ecological modelling</em>, <b>186</b>, 143&ndash;153.
</p>


<h3>See Also</h3>

<p><code><a href="ade4.html#topic+s.distri">s.distri</a></code>, and
<code><a href="ade4.html#topic+dudi">dudi</a></code> for class <code>dudi</code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## Load the data
data(puechabonsp)

locs &lt;- puechabonsp$relocs
map &lt;- puechabonsp$map


## compute the home range of animals (e.g. using the minimum convex
## polygon)
pc &lt;- mcp(locs[,"Name"])

## rasterize it
hr &lt;- hr.rast(pc, map)


## Compute the number of relocation in each pixel of the map
cp &lt;- count.points(locs[,"Name"], map)

## prepares the data for the kselect analysis
x &lt;- prepksel(map, hr, cp)
tab &lt;- x$tab

## Example of analysis with two variables: the slope and the elevation.
## Have a look at the use and availability of the two variables
## for the 4 animals
tab &lt;- tab[,((names(tab) == "Slope")|(names(tab) == "Elevation"))]
tab &lt;- scale(tab)
tmp &lt;- split.data.frame(tab, x$factor)
wg &lt;- split(x$weight, x$factor)
opar &lt;- par(mfrow = n2mfrow(nlevels(x$factor)))
for (i in names(tmp))
  s.distri(scale(tmp[[i]]), wg[[i]])
par(opar)

## We call a new graphic window
x11()
## A K-select analysis
acp &lt;- dudi.pca(tab, scannf = FALSE, nf = 2)
kn &lt;- kselect(acp, x$factor, x$weight,
 scannf = FALSE, nf = 2)

# use of the generic function scatter
scatter(kn)

# Displays the first factorial plane
kplot(kn)
kplot(kn, cellipse = 0, cpoint = 0)
kplot(kn, addval = FALSE, cstar = 0)

# this factorial plane can be compared with
# the other graph to see the rotation proposed by
# the analysis
graphics.off()

# Displays the first factorial axis
hist(kn)

# Displays the second factorial axis
hist(kn, xax = 2)

# Summary of the analysis
plot(kn)

## End(Not run)
</code></pre>

<hr>
<h2 id='madifa'>The MADIFA: a Factorial Decomposition of the Mahalanobis Distances </h2><span id='topic+madifa'></span><span id='topic+print.madifa'></span><span id='topic+hist.madifa'></span><span id='topic+scatter.madifa'></span><span id='topic+predict.madifa'></span><span id='topic+plot.madifa'></span><span id='topic+s.madifa'></span>

<h3>Description</h3>

<p>The MADIFA allows a factorial decomposition of the Mahalanobis
distances.  This method is presented here in the framework of
niche-environment studies.
</p>
<p><code>predict.madifa</code> allows the computation of the Mahalanobis
Distances based on a restricted number of factorial axes.<br />
All other functions allow various graphical displays of the results of
the MADIFA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>madifa(dudi, pr, scannf = TRUE, nf = 2)
## S3 method for class 'madifa'
print(x, ...)
## S3 method for class 'madifa'
scatter(x, xax = 1, yax = 2, pts = FALSE, percent = 95,
               clabel = 1, side = c("top", "bottom", "none"),
               Adensity, Udensity, Aangle, Uangle, Aborder,
               Uborder, Acol, Ucol, Alty,
               Ulty, Abg, Ubg, Ainch, Uinch, ...)
## S3 method for class 'madifa'
hist(x, scores = TRUE, type = c("h", "l"), adjust = 1, Acol,
            Ucol, Aborder, Uborder, Alwd = 1, Ulwd = 1, ...)
## S3 method for class 'madifa'
predict(object, map, nf, ...)
s.madifa(x, xax = 1, yax = 2, cgrid = 1, clab = 1, ...)
## S3 method for class 'madifa'
plot(x, map, xax = 1, yax = 2, cont = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="madifa_+3A_dudi">dudi</code></td>
<td>
<p>a duality diagram, an object of class <code>dudi</code></p>
</td></tr>
<tr><td><code id="madifa_+3A_pr">pr</code></td>
<td>
<p>a vector giving the utilization weights associated to each
unit</p>
</td></tr>
<tr><td><code id="madifa_+3A_scannf">scannf</code></td>
<td>
<p>logical.  Whether the eigenvalues barplot should be
displayed</p>
</td></tr>
<tr><td><code id="madifa_+3A_nf">nf</code></td>
<td>
<p>an integer indicating the number of kept
factorial axes</p>
</td></tr>
<tr><td><code id="madifa_+3A_x">x</code>, <code id="madifa_+3A_object">object</code></td>
<td>
<p>an object of class <code>madifa</code></p>
</td></tr>
<tr><td><code id="madifa_+3A_xax">xax</code></td>
<td>
<p>the column number for the x-axis</p>
</td></tr>
<tr><td><code id="madifa_+3A_yax">yax</code></td>
<td>
<p>the column number for the y-axis</p>
</td></tr>
<tr><td><code id="madifa_+3A_pts">pts</code></td>
<td>
<p>logical. Whether the points should be drawn.  If
<code>FALSE</code>, minimum convex polygons are displayed</p>
</td></tr>
<tr><td><code id="madifa_+3A_percent">percent</code></td>
<td>
<p>100 minus the proportion of outliers to be excluded
from the computation of the minimum convex polygons</p>
</td></tr>
<tr><td><code id="madifa_+3A_clabel">clabel</code></td>
<td>
<p>a character size for the columns</p>
</td></tr>
<tr><td><code id="madifa_+3A_side">side</code></td>
<td>
<p>if <code>"top"</code>, the legend of the kept axis is upside, if
<code>"bottom"</code> it is downside, if <code>"none"</code> no legend</p>
</td></tr>
<tr><td><code id="madifa_+3A_adensity">Adensity</code></td>
<td>
<p>the density of shading lines, in lines per inch, for
the available pixels polygon. See <code><a href="graphics.html#topic+polygon">polygon</a></code> for more
details</p>
</td></tr>
<tr><td><code id="madifa_+3A_udensity">Udensity</code></td>
<td>
<p>the density of shading lines, in lines per inch, for
the used pixels polygon. See <code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="madifa_+3A_aangle">Aangle</code></td>
<td>
<p>the slope of shading lines, given as an angle in degrees
(counter-clockwise), for the available pixels polygon</p>
</td></tr>
<tr><td><code id="madifa_+3A_uangle">Uangle</code></td>
<td>
<p>the slope of shading lines, given as an angle in degrees
(counter-clockwise), for the used pixels polygon</p>
</td></tr>
<tr><td><code id="madifa_+3A_aborder">Aborder</code></td>
<td>
<p>the color for drawing the border of the available pixels 
polygon (or of the bars of the histogram) . See
<code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="madifa_+3A_uborder">Uborder</code></td>
<td>
<p>the color for drawing the border of the used pixels
polygon (or of the bars of the histogram).  See
<code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="madifa_+3A_acol">Acol</code></td>
<td>
<p>the color for filling the available pixels polygon. 
if <code>pts == FALSE</code>, the color for the points corresponding to
available pixels</p>
</td></tr>
<tr><td><code id="madifa_+3A_ucol">Ucol</code></td>
<td>
<p>the color for filling the used pixels polygon. 
if <code>pts == FALSE</code>, the color for the points corresponding to used
pixels</p>
</td></tr>
<tr><td><code id="madifa_+3A_alty">Alty</code></td>
<td>
<p>the line type for the available pixels polygon, as in
<code>par</code></p>
</td></tr>
<tr><td><code id="madifa_+3A_ulty">Ulty</code></td>
<td>
<p>the line type for the used pixels polygon, as in
<code>par</code></p>
</td></tr>
<tr><td><code id="madifa_+3A_abg">Abg</code></td>
<td>
<p>if <code>pts == TRUE</code>, background color for open plot symbols
of available pixels</p>
</td></tr>
<tr><td><code id="madifa_+3A_ubg">Ubg</code></td>
<td>
<p>if <code>pts == TRUE</code>, background color for open plot symbols
of  used pixels</p>
</td></tr>
<tr><td><code id="madifa_+3A_ainch">Ainch</code></td>
<td>
<p>if <code>pts == TRUE</code>, heigth in inches of the available
pixels</p>
</td></tr>
<tr><td><code id="madifa_+3A_uinch">Uinch</code></td>
<td>
<p>if <code>pts == TRUE</code>, heigth in inches of the largest used
pixels</p>
</td></tr>
<tr><td><code id="madifa_+3A_scores">scores</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the histograms display
the row scores of the MADIFA.  If <code>FALSE</code>, they display the
niche on the environmental variables (in this case, this is
equivalent to <code>histniche</code>)</p>
</td></tr>
<tr><td><code id="madifa_+3A_type">type</code></td>
<td>
<p>what type of plot should be drawn.  Possible types are:<br />
* <code>"h"</code> for histograms,<br />
* <code>"l"</code> for kernel density estimates (see <code>?density</code>).<br />
By default, <code>type = "h"</code> is used.  If <code>type = "l"</code> is
used, the position of the mean of each distribution is indicated by
dotted lines</p>
</td></tr>
<tr><td><code id="madifa_+3A_adjust">adjust</code></td>
<td>
<p>if <code>type = "l"</code>, a parameter used to control the
bandwidth of the density estimates (see <code>?density</code>)</p>
</td></tr>
<tr><td><code id="madifa_+3A_alwd">Alwd</code></td>
<td>
<p>if <code>type = "l"</code>, the line width of the kernel density 
estimates of the available pixels</p>
</td></tr>
<tr><td><code id="madifa_+3A_ulwd">Ulwd</code></td>
<td>
<p>if <code>type = "l"</code>, the line width of the kernel density 
estimates of the used pixels</p>
</td></tr>
<tr><td><code id="madifa_+3A_cgrid">cgrid</code></td>
<td>
<p>a character size, parameter used with par(&quot;cex&quot;)*
<code>cgrid</code> to indicate the mesh of the grid</p>
</td></tr>
<tr><td><code id="madifa_+3A_clab">clab</code></td>
<td>
<p>if not NULL, a character size for the labels, used with
<code>par("cex")*clab</code></p>
</td></tr>
<tr><td><code id="madifa_+3A_map">map</code></td>
<td>
<p>an object of class <code>SpatialPixelsDataFrame</code></p>
</td></tr>
<tr><td><code id="madifa_+3A_cont">cont</code></td>
<td>
<p>logical.  Whether contour lines should be added to the maps</p>
</td></tr>
<tr><td><code id="madifa_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the functions
<code>print</code>, <code>scatter</code>, and <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mahalanobis distances are often used in the context of
niche-environment studies (Clark et al. 1993, see the function 
<code>mahasuhab</code>).  Each environmental variable defines a dimension in
a multidimensionnal space, namely the ecological space.  The
Mahalanobis distance between any resource unit in this space (e.g. the
point defined by the values of environmental variables in a pixel of a
raster map) and the centroid of the niche (the distribution of used
resource units) can be used to give a value of eccentricity to this
point.
</p>
<p>For a given distribution of available resource units, for which a
measure of Mahalanobis distances is desired, the MADIFA (MAhalanobis
DIstances Factor Analysis) partitions the ecological space into a set
of axes, so that the first axes maximises the average proportion of
their squared Mahalanobis distances.  Note that the sum of the squared
scores of any resource unit on all the axes of the analysis is equal
to the squared Mahalanobis distances for this resource unit.  Thus,
the MADIFA partitions the Mahalanobis distances into several axes of
biological meaning (see examples).  <code>predict.madifa</code> allows to
compute approximate Mahalanobis distances from the axes of the
MADIFA.
</p>
<p><code>plot.madifa</code> returns a graphical summary of the analysis: it
returns graphs of (i) the eigenvalues of the analysis (each eigenvalue
measures the average Mahalanobis distance explained by each factorial
axis); (ii) the scores of the habitat variables (i.e. the coefficients
associated to each environmental variable in the linear combination
defining the axes) - note that as the ecological space is distorted to
&quot;sphericize&quot; the niche, the factorial axes are no longer orthogonals,
and the scores of the variables are distributed within an ellipsoid
instead of an hypersphere of radius equal to one in classical PCA. The
limits of this ellipsoid is displayed on this graph, to see the amount
of distortion done by the analysis (further research needs yet to be
done on this graph); (iii) The projection of the available and used
points on the factorial plane of the MADIFA; (iv) The map of the
Mahalanobis distances computed from the original environmental
variables; (v) the map of the approximated Mahalanobis distances
computed from the two axes displayed in this plot; the correlations
between the original environmental variables and the factorial axes;
(v) the map of the first factorial axis and (vi) the map of the second
factorial axis.
</p>
<p><code>hist.madifa</code> returns a graph of the niche and the available
resource units on the factorial axes of the analysis.
</p>


<h3>Value</h3>

<p><code>madifa</code> returns a list of class <code>madifa</code> containing the
following components: 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>original call.</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>a data frame with n rows and p columns.</p>
</td></tr>
<tr><td><code>pr</code></td>
<td>
<p>a vector of length n containing the number of points in each
pixel of the map.</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>the number of kept factorial axes.</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>a vector with all the eigenvalues of the analysis.</p>
</td></tr>
<tr><td><code>lw</code></td>
<td>
<p>row weights, a vector with n components.</p>
</td></tr>
<tr><td><code>li</code></td>
<td>
<p>row coordinates, data frame with n rows and nf columns.</p>
</td></tr>
<tr><td><code>l1</code></td>
<td>
<p>row normed coordinates, data frame with n rows and nf columns.</p>
</td></tr>
<tr><td><code>cw</code></td>
<td>
<p>column weights, a vector with p components.</p>
</td></tr>
<tr><td><code>co</code></td>
<td>
<p>column coordinates, data frame with p rows and nf columns.</p>
</td></tr>
<tr><td><code>mahasu</code></td>
<td>
<p>a vector of length n containing the squared Mahalanobis
distances for the n units.</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p>the correlation between the MADIFA axes and the original
variable</p>
</td></tr>
</table>
<p><code>predict.madifa</code> returns a matrix of class <code>SpatialPixelsDataFrame</code>. 
</p>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a>
</p>


<h3>References</h3>

<p>Clark, J.D., Dunn, J.E. and Smith, K.G. (1993) A multivariate model of
female black bear habitat use for a geographic information
system. <em>Journal of Wildlife Management</em>, <b>57</b>, 519&ndash;526.
</p>
<p>Calenge, C., Darmon, G., Basille, M., Loison, A. and Jullien
J.M. (2008) The factorial decomposition of the Mahalanobis distances
in habitat selection studies. <em>Ecology</em>, <b>89</b>, 555&ndash;566.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mahasuhab">mahasuhab</a></code> for a detailed description of the
Mahalanobis distances, <code><a href="#topic+enfa">enfa</a></code> and <code><a href="#topic+gnesfa">gnesfa</a></code> for
closely related methods.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

data(bauges)

map &lt;- bauges$map
locs &lt;- bauges$loc

## We prepare the data for the MADIFA
tab &lt;- slot(map, "data")
pr &lt;- slot(count.points(locs, map), "data")[,1]


## We then perform the PCA before the MADIFA
pc &lt;- dudi.pca(tab, scannf = FALSE)
(mad &lt;- madifa(pc, pr, nf=7,
               scannf = FALSE))

#########################################
##                                     ##
## Graphical exploration of the MADIFA ##
##                                     ##
#########################################

hist(mad)

plot(mad, map)

## this plot represents:
##  - the eigenvalues diagram
##  - the scores of the columns on the axes
##  - a graph of the niche in the available space
##  - a map of the Mahalanobis distances computed
##    using all environmental variables
##  - a map of the Mahalanobis distances computed
##    using the two factorial axes used in the
##    previous graphs
##  - the correlation between habitat variables
##    and factorial axes
##  - the geographical maps of the two
##    factorial axes

## predict with just the first axis
pred &lt;- predict(mad, map, nf=1)
image(pred)



#########################################
##                                     ##
## Mathematical properties of  MADIFA  ##
##                                     ##
#########################################

## mad$li is equal to mad$l1, up to a constant (mad$l1 is normed)
plot(mad$li[,1],mad$l1[,1])

## This constant is the square root of the corresponding eigenvalue:
## the variance of mad$l1 is equal to the eigenvalue
apply(mad$l1,2,function(x) sum(x^2))/nrow(mad$li)

## the variance of mad$l1 weighted by pr is equal to 1
apply(mad$l1,2,function(x) sum(mad$pr*x^2)/sum(mad$pr))

## Therefore, the eigenvalues are equal to the average of Mahalanobis
## distance for the available resource units on each axis
mean(mahalanobis(matrix(mad$l1[,1], ncol=1), 0, 1))
mad$eig[1]

## Computation of the Mahalanobis distances
ma1 &lt;- mahasuhab(map, locs)

## The sum of squared scores for a given Resource unit is equal to the
## Mahalanobis distances
ma2 &lt;- apply(mad$l1,1, function(x) sum(x^2))
plot(ma2, slot(ma1, "data")[,1])


## End(Not run)

</code></pre>

<hr>
<h2 id='mahasuhab'>Habitat Suitability Mapping with Mahalanobis Distances.</h2><span id='topic+mahasuhab'></span>

<h3>Description</h3>

<p>This function computes the habitat suitability map of an area
for a species, given a set of locations of the species occurences (Clark
et al. 1993).  This function is
to be used in habitat selection studies, when animals are not
identified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mahasuhab(x, pts, type = c("distance", "probability"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mahasuhab_+3A_x">x</code></td>
<td>
<p>a raster map of class <code>SpatialPixelsDataFrame</code></p>
</td></tr>
<tr><td><code id="mahasuhab_+3A_pts">pts</code></td>
<td>
<p>a data frame with two columns, giving the coordinates
of the species locations</p>
</td></tr>
<tr><td><code id="mahasuhab_+3A_type">type</code></td>
<td>
<p>a character string. Whether the raw <code>"distance"</code> should be
returned, or rather the <code>"probability"</code> (see details). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let assume that a set of locations of the species on an area is available
(gathered on transects, or during the monitoring of the population,
etc.).  If we assume that the probability of detecting an individual
is independent from the habitat variables, then we can consider that
the habitat found at these sites reflects the habitat use by the animals.
</p>
<p>The Mahalanobis distances method has become more and more popular
during the past few years to derive habitat suitability maps.  The
niche of a species is defined as the probability density function of
presence of a species in the multidimensionnal space defined by the
habitat variables.  If this function can be assumed to
be multivariate normal, then the mean vector of this distribution
corresponds to the optimum for the species.
</p>
<p>The function <code>mahasuhab</code> first computes this mean vector as well
as the variance-covariance matrix of the niche density function, based
on the value of habitat variables in the sample of locations.
Then, the *squared* Mahalanobis distance from this optimum is computed
for each pixel of the map.  Thus, the smaller this squared
distance is for a given pixel, and the better is the habitat in this
pixel.
</p>
<p>Assuming multivariate normality, squared Mahalanobis distances are
approximately distributed as Chi-square with n degrees of freedom,
where n equals the number of habitat characteristics (see the section
note below on this question).  If the
argument <code>type = "probability"</code>, maps of these p-values are
returned by the function. As such these are the probabilities of a
larger squared Mahalanobis distance than that observed when x is
sampled from the niche.
</p>


<h3>Value</h3>

<p>Returns a raster map of class <code>SpatialPixelsDataFrame</code>.
</p>


<h3>Note</h3>

<p>The computation of the squared Mahalanobis distances inverts the
variance-covariance matrix of the niche density function (see
<code>?mahalanobis</code>).
It is therefore important that the habitat variables considered
are not too correlated among each other.  When the habitat variables
are too correlated, the variance-covariance matrix is singular and
cannot be inverted.
</p>
<p>Note also that it is recommended to scale the variables before the
computation, so that they all have the same variance, and therefore
the same weight in the analysis (see examples below).
</p>
<p>Finally, note that in versions of adehabitatHS prior to 0.3.16,
<code>mahasuhab</code> incorrectly calculated the probability, when
<code>type = "probability"</code>, based on a Chi-square with (n-1) degrees
of freedom instead of n degrees of freedom (see Etherington 2019 on
this issue). 
</p>


<h3>Author(s)</h3>

<p> Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a> </p>


<h3>References</h3>

<p>Clark, J.D., Dunn, J.E. and Smith, K.G. (1993) A multivariate model of
female black bear habitat use for a geographic information
system. <em>Journal of Wildlife Management</em>, <b>57</b>, 519&ndash;526.
</p>
<p>Etherington, T.R. (2019) Mahalanobis distances and ecological niche
modelling: correcting a chi-squared probability error. <em>Peer J</em>,
<b>7</b>, e6678.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+madifa">madifa</a></code> and <code><a href="#topic+dunnfa">dunnfa</a></code> for factor
analyses of the Mahalanobis distances, <code><a href="#topic+domain">domain</a></code> for
another method of habitat suitability mapping,
<code><a href="stats.html#topic+mahalanobis">mahalanobis</a></code> for
information on the computation of Mahalanobis distances. </p>


<h3>Examples</h3>

<pre><code class='language-R'>## loads the data
data(lynxjura)
ma &lt;- lynxjura$map
lo &lt;- lynxjura$locs[,1:2]

## We first scale the maps
slot(ma, "data") &lt;- dudi.pca(slot(ma, "data"), scannf=FALSE)$tab

## habitat suitability mapping
hsm &lt;- mahasuhab(ma, lo, type = "probability")
image(hsm)
title(main = "Habitat suitability map for the Lynx")
points(lo, pch = 3)

</code></pre>

<hr>
<h2 id='niche.test'>Monte-Carlo Test on Parameters of the Ecological Niche</h2><span id='topic+niche.test'></span>

<h3>Description</h3>

<p><code>niche.test</code> tests for the significance of two parameters of the
ecological niche of a species (marginality and tolerance), using
Monte-Carlo methods.  This is a bivariate test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>niche.test(x, pts, nrep = 999, o.include = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="niche.test_+3A_x">x</code></td>
<td>
<p>a raster map of class <code>SpatialPixelsDataFrame</code></p>
</td></tr>
<tr><td><code id="niche.test_+3A_pts">pts</code></td>
<td>
<p>an object inheriting the class <code>SpatialPoints</code></p>
</td></tr>
<tr><td><code id="niche.test_+3A_nrep">nrep</code></td>
<td>
<p>the number of permutations</p>
</td></tr>
<tr><td><code id="niche.test_+3A_o.include">o.include</code></td>
<td>
<p>logical, passed to <code>biv.test</code>.  If <code>TRUE</code>,
the origin is included in the plot</p>
</td></tr>
<tr><td><code id="niche.test_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>biv.test</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>niche.test</code> tests the significance of two parameters describing
the ecological niche: the marginality
(squared length of the vector linking the average available habitat
conditions to the average used habitat conditions in the ecological
space defined by the habitat variables), and the tolerance (inertia of
the niche in the ecological space, i.e. the sum over all variables of
the variance of used pixels). 
</p>
<p>At each step of the randomisation procedure, 
the test randomly allocates the n points in the pixels of the map.
The marginality and the tolerance are then recomputed on this
randomised data set.
</p>
<p>Actual values are compared to random values with the help of the
function <code>biv.test</code>.
</p>


<h3>Value</h3>

<p>Returns a list containing the following
components: 
</p>
<table>
<tr><td><code>dfxy</code></td>
<td>
<p>a data frame with the randomized values of marginality
(first column) and tolerance (second column).</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>the actual value of marginality and tolerance.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p><code>biv.test</code> uses the function <code>kde2d</code> of the package <code>MASS</code>.
</p>


<h3>Author(s)</h3>

<p>Mathieu Basille <a href="mailto:basille@ase-research.org">basille@ase-research.org</a><br />
Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+biv.test">biv.test</a></code> for more details on bivariate tests. 
<code><a href="#topic+histniche">histniche</a></code> for the histograms of the variables of the niche.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(chamois)

niche &lt;- niche.test(chamois$map,
                    chamois$locs,
                    side = "bottom")
names(niche)

## End(Not run)
</code></pre>

<hr>
<h2 id='pheasant'>Radio-Tracking of Pheasants</h2><span id='topic+pheasant'></span>

<h3>Description</h3>

<p>This data set describes the use and availability of 5 habitat types for
13 pheasants monitored using radio-tracking. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pheasant)</code></pre>


<h3>Format</h3>

<p>This list has three components:
</p>

<dl>
<dt><code>studyarea</code></dt><dd><p>a data frame giving the proportion of each
habitat type (columns) on the study area.  These habitat types are
<code>Scrub</code>, <code>Broadleaf</code>, <code>Coniferous</code>,
<code>Grassland</code> and <code>Crop</code>.  These proportions are
repeated by rows, for all animals (rows)</p>
</dd>
<dt><code>mcp</code></dt><dd><p>a data frame giving the proportion of
each habitat type (columns) in the home range of each animal
(rows)</p>
</dd>
<dt><code>locs</code></dt><dd><p>a data frame giving the proportion of relocations
of each animal (rows) reported in 3 of the 5 habitat types
(columns). Indeed, <code>Coniferous</code> and <code>Crops</code> were not
used by most of the animals.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Aebischer, N. J., Robertson, P. A. and Kenward, R. E. (1993)
Compositional analysis of habitat use from animal radiotracking
data. <em>Ecology</em>, <b>74</b>, 1313&ndash;1325.
</p>

<hr>
<h2 id='predict.enfa'>Habitat Suitability Maps Built from the ENFA</h2><span id='topic+predict.enfa'></span>

<h3>Description</h3>

<p><code>predict.enfa</code> computes habitat suitability maps using the
Ecological-Niche Factor Analysis and the Mahalanobis distances
method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'enfa'
predict(object, map, nf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.enfa_+3A_object">object</code></td>
<td>
<p>an object of class <code>enfa</code></p>
</td></tr>
<tr><td><code id="predict.enfa_+3A_map">map</code></td>
<td>
<p>an object of class <code>SpatialPixelsDataFrame</code>.</p>
</td></tr> 
<tr><td><code id="predict.enfa_+3A_nf">nf</code></td>
<td>
<p>the number of axes of specialization kept for the
predictions.  By default, all axes kept in <code>object</code> are
used</p>
</td></tr>
<tr><td><code id="predict.enfa_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The predictions are based on the position of the niche defined by the
ENFA within the multidimensional space of environmental variables.  The
ENFA produces row coordinates for each pixel, which are used with the
function <code>mahalanobis</code>.  For each pixel, this function computes the
Mahalanobis distances from the barycentre of the niche.
</p>
<p>Actually, the function <code>predict.enfa</code> is identical to the function
<code>mahasuhab</code>, except that the habitat suitability map is computed
using the axes of the ENFA, instead of the raw data.
</p>
<p>Note that the MADIFA allows a more consistent factorial decomposition of
the Mahalanobis distances.
</p>


<h3>Value</h3>

<p>Returns a raster map of class <code>SpatialPixelsDataFrame</code>.
</p>


<h3>Author(s)</h3>

<p>Mathieu Basille <a href="mailto:basille@ase-research.org">basille@ase-research.org</a></p>


<h3>References</h3>

<p>Clark, J.D., Dunn, J.E. and Smith, K.G. (1993) A multivariate model of
female black bear habitat use for a geographic information
system. <em>Journal of Wildlife Management</em>, <b>57</b>, 519&ndash;526.
</p>
<p>Hirzel, A.H., Hausser, J., Chessel, D. &amp; Perrin, N. (2002)
Ecological-niche factor analysis: How to compute habitat-suitability
maps without absence data? <em>Ecology</em>, <b>83</b>, 2027&ndash;2036.  
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+mahalanobis">mahalanobis</a></code> for information on the computation of
Mahalanobis distances.  <code><a href="#topic+mahasuhab">mahasuhab</a></code> for more details on the
computation of habitat suitability maps using the Mahalanobis distances.
<code><a href="#topic+madifa">madifa</a></code> for a more consistent factorial decomposition of
the Mahalanobis distances
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(lynxjura)

map &lt;- lynxjura$map

## We keep only "wild" indices.
locs &lt;- lynxjura$locs
locs &lt;- locs[slot(locs, "data")[,2]!="D",]

pr &lt;- slot(count.points(locs, map), "data")[,1]

(enfa1 &lt;- enfa(dudi.pca(slot(map, "data"), scannf=FALSE),
               pr, scannf = FALSE))

## Compute the prediction
pred &lt;- predict(enfa1, map)
image(pred)
contour(pred, col="green", add=TRUE)
points(locs, pch = 3)


## End(Not run)
</code></pre>

<hr>
<h2 id='puech'>Radio-Tracking Data of Wild Boar (2)</h2><span id='topic+puech'></span>

<h3>Description</h3>

<p>This data set stores the results of the monitoring of 6 wild boar at
Puechabon (Mediterranean habitat, South of France). These data have
been collected by Daniel Maillard (Office national de la chasse et de
la faune sauvage).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(puech)</code></pre>


<h3>Details</h3>

<p>The list <code>puech</code> has two components:
</p>
<p><code>puech$relocations</code> is an object of class
<code>SpatialPixelsDataFrame</code> containing the relocations of the wild
boar resting sites in summer.  It contains the coordinates of the
relocations and the name of the corresponding wild boar.
</p>
<p><code>puech$map</code> is n object of class <code>SpatialPixelsDataFrame</code>
that describe nine environmental variables on the study area (the
elevation, the tree cover, the shrub cover, the distance to
recreational trails, the distance to crops, the distance to water
points, the grass cover, the slope and the sunshine).
</p>
<p>Note that both the maps and the relocations have been slightly
&quot;damaged&quot; to preserve the copyright on the data.
</p>


<h3>References</h3>

<p>Maillard, D. (1996). <em>Occupation et utilisation de la garrigue et
du vignoble mediterraneens par le Sanglier</em>.
Universite d'Aix-Marseille III: PhD thesis.
</p>

<hr>
<h2 id='puechdesIII'>Habitat Selection by the Wild Boar at Puechabon</h2><span id='topic+puechdesIII'></span>

<h3>Description</h3>

<p>This data set contains two data frames describing the use and the
availability of 3 elevation classes for 6 wild boars (<em>Sus scrofa</em>
L.) monitored using radio-tracking at Puechabon (South of France).
These data have been collected by Daniel Maillard (Office national de la
chasse et de la faune sauvage).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(puechdesIII)</code></pre>


<h3>Details</h3>

<p>The list <code>puechdesIII</code> has two components: <br />
The data frame <code>used</code> describes the number of telemetry
relocations  for each of the 6 animals in each of the three elevation
classes. <br />
The data frame <code>available</code> describes a sample 
of random points placed in the areas available to these wild boars 
(a buffer area of 200 m around the relocations).
</p>


<h3>Source</h3>

<p>Maillard, D. (1996) <em>Occupation et utilisation de la garrigue et du
vignoble mediterraneens par le Sanglier</em>.
Universite d'Aix-Marseille III:  PhD thesis.
</p>

<hr>
<h2 id='rand.kselect'>Test of the Third-Order Habitat Selection </h2><span id='topic+rand.kselect'></span><span id='topic+print.rand.kselect'></span>

<h3>Description</h3>

<p><code>rand.kselect</code> tests whether the marginality vector of animals
is significantly larger than what is expected under the hypothesis of
random habitat use (third-order habitat selection:
selection by the animals of the relocations within their home range;
the habitat availability is measured for each animal).  The effect of
each variable  on individual marginality is also tested. 
Finally, the pertinence of a K-select analysis is also tested.  This is
a randomisation test.  The alpha-level of the tests is
ajusted using the Bonferroni inequality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rand.kselect(dudi, factor, weight, nrep = 200, alpha = 0.05, ewa = FALSE)
## S3 method for class 'rand.kselect'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rand.kselect_+3A_dudi">dudi</code></td>
<td>
<p>an object of class <code>dudi</code>.</p>
</td></tr>
<tr><td><code id="rand.kselect_+3A_factor">factor</code></td>
<td>
<p>a factor defining the animals identity</p>
</td></tr>
<tr><td><code id="rand.kselect_+3A_weight">weight</code></td>
<td>
<p>a weight vector of integer values (number of relocations
counted in each resource unit in row of the object dudi)</p>
</td></tr>
<tr><td><code id="rand.kselect_+3A_nrep">nrep</code></td>
<td>
<p>the number of repetitions of the test</p>
</td></tr>
<tr><td><code id="rand.kselect_+3A_alpha">alpha</code></td>
<td>
<p>the alpha level for the tests.</p>
</td></tr>
<tr><td><code id="rand.kselect_+3A_ewa">ewa</code></td>
<td>
<p>logical. If <code>TRUE</code>, uniform weights are given
to all animals in the analysis. If <code>FALSE</code>, animal weights are
given by the proportion of relocations of each animal (i.e. an
animal with 10 relocations has a weight 10 times lower than an
animal with 100 relocations)</p>
</td></tr>
<tr><td><code id="rand.kselect_+3A_x">x</code></td>
<td>
<p>an object of the class <code>rand.kselect</code>.</p>
</td></tr>
<tr><td><code id="rand.kselect_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the generic function 
<code>print</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This test is carried out by simulating a random use of space by
animals. <code>rand.kselect</code> is closely related to the function
<code>kselect</code> (same  arguments). 
</p>
<p>At each step  of the randomisation procedure, and for each
animal, the test randomly allocates the nk relocations (where nk is the
sum of the weight vector for the animal k) in the Ik pixels available
to this animal (where Ik is the length of the weight vector for animal
k).
</p>
<p>The length of the marginality vector is 
recomputed at each step of the randomisation procedure and for each
animal. The effect of each variable on the use of pixels by each
animal is measured by the criterion &quot;(average habitat variable j
used by animal i) minus (average habitat variable j available to
animal i)&quot;. Finally the value of the first eigenvalue of the 
K-select analysis provides a criterion to test the pertinence of the
K-select analysis. 
</p>
<p>All these values are then compared to the observed values to assess
the significance of theses effects.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>rand.kselect</code>. This list has three
components: 
</p>
<table>
<tr><td><code>global</code></td>
<td>
<p>a vector of length 2 
giving the results of the randomisation procedure for the first
eigenvalue of the K-select analysis.</p>
</td></tr>
<tr><td><code>marg</code></td>
<td>
<p>a matrix giving the significance of the marginality of
each animal.</p>
</td></tr> 
<tr><td><code>per.ind</code></td>
<td>
<p>a list giving the results of the randomisation test for the 
coordinates of the marginality vector for each animal
on each habitat variable.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the alpha level of the tests.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a> </p>


<h3>References</h3>

<p>Calenge, C., Dufour, A.B. and Maillard, D. (2005) K-select analysis: a
new method to analyse habitat selection in radio-tracking
studies. <em>Ecological modelling</em>, <b>186</b>, 143&ndash;153.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+kselect">kselect</a></code> to perform a K-select analysis. </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Loads the data
data(puechabonsp)

locs &lt;- puechabonsp$relocs
map &lt;- puechabonsp$map


## compute the home range of animals (e.g. using the minimum convex
## polygon)
pc &lt;- mcp(locs[,"Name"])

## rasterize it
hr &lt;- do.call("data.frame", lapply(1:nrow(pc), function(i) {
    overlay(map, geometry(pc[i,]))
}))
names(hr) &lt;- slot(pc, "data")$id
coordinates(hr) &lt;- coordinates(map)
gridded(hr) &lt;- TRUE


## Compute the number of relocation in each pixel of the map
cp &lt;- count.points(locs[,"Name"], map)

## prepares the data for the kselect analysis
x &lt;- prepksel(map, hr, cp)
tab &lt;- x$tab
dud &lt;- dudi.mix(tab, scannf = FALSE, nf = 2)

## the randomisation tests
## be patient, this can be very long on some machines
(te &lt;- rand.kselect(dud, x$factor, x$weight, nrep = 500))


## End(Not run)
</code></pre>

<hr>
<h2 id='randtest.enfa'>Randomisation Test for the Ecological Niche Factor Analysis </h2><span id='topic+randtest.enfa'></span>

<h3>Description</h3>

<p><code>randtest.enfa</code> performs a randomisation test for the Ecological
Niche Factor analysis (ENFA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'enfa'
randtest(xtest, nrepet = 999, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randtest.enfa_+3A_xtest">xtest</code></td>
<td>
<p>an object of class <code>enfa</code></p>
</td></tr>
<tr><td><code id="randtest.enfa_+3A_nrepet">nrepet</code></td>
<td>
<p>the number of iterations for the randomisation test</p>
</td></tr>
<tr><td><code id="randtest.enfa_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the generic function
<code>randtest</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This test is carried out by simulating a random distribution of the
species occurrences in the pixels of a map.
</p>
<p>At each step  of the randomisation procedure, the test randomly
allocates the nk occurrences (where nk is the 
sum of the occurrence vector <code>pr</code> of the object of class <code>enfa</code>)
in the Ik pixels of the focus area (where Ik is the length of this occurrence
vector).
</p>
<p>At each step of the procedure, the first eigenvalue of the ENFA
performed on the randomised data set is recomputed. This
value provides a criterion to test the pertinence of the ENFA
analysis.
</p>


<h3>Value</h3>

<p>returns a list of class <code>randtest</code>
</p>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a>
</p>


<h3>References</h3>

<p>Manly, B.F.J. (1997) <em>Randomization, Bootstrap and Monte Carlo
Methods in Biology</em>. London: Chapman &amp; Hall.
</p>
<p>Hirzel, A.H., Hausser, J., Chessel, D. and Perrin, N. (2002)
Ecological-niche factor analysis: How to compute habitat suitability
maps without absence data? <em>Ecology</em>, <b>83</b>, 2027&ndash;2036.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+enfa">enfa</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(chamois)
locs &lt;- chamois$locs
map &lt;- chamois$map

## prepare the data
tab &lt;- slot(map, "data")
tab$Vegetation &lt;- NULL
pr &lt;- slot(count.points(locs, map), "data")[,1]

en &lt;- enfa(dudi.pca(tab, scannf=FALSE), pr, scannf = FALSE)
(tutu &lt;- randtest(en, nrepet = 100))
plot(tutu)


## End(Not run)
</code></pre>

<hr>
<h2 id='scatter.enfa'>Scatter Plot of the Results of the ENFA</h2><span id='topic+scatter.enfa'></span>

<h3>Description</h3>

<p>Performs the scatter diagrams of objects of class <code>enfa</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'enfa'
scatter(x, xax = 1, yax = 2, pts = FALSE, nc = TRUE, 
             percent = 95, clabel = 1, side = c("top", "bottom", "none"),
             Adensity, Udensity, Aangle, Uangle, Aborder, Uborder, 
             Acol, Ucol, Alty, Ulty, Abg, Ubg, Ainch, Uinch, ...) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scatter.enfa_+3A_x">x</code></td>
<td>
<p>an object of class <code>enfa</code></p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_xax">xax</code></td>
<td>
<p>the column number for the x-axis</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_yax">yax</code></td>
<td>
<p>the column number for the y-axis</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_pts">pts</code></td>
<td>
<p>logical. Whether the points should be drawn.  If
<code>FALSE</code>, minimum convex polygons are displayed</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_nc">nc</code></td>
<td>
<p>whether or not the niche center should be displayed</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_percent">percent</code></td>
<td>
<p>100 minus the proportion of outliers to be excluded from the
computation of the minimum convex polygons</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_clabel">clabel</code></td>
<td>
<p>a character size for the columns</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_side">side</code></td>
<td>
<p>if <code>"top"</code>, the legend of the kept axis is upside, if
<code>"bottom"</code> it is downside, if <code>"none"</code> no legend</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_adensity">Adensity</code></td>
<td>
<p>the density of shading lines, in lines per inch, for the 
available pixels polygon. See <code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_udensity">Udensity</code></td>
<td>
<p>the density of shading lines, in lines per inch, for the 
used pixels polygon. See <code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_aangle">Aangle</code></td>
<td>
<p>the slope of shading lines, given as an angle in degrees
(counter-clockwise), for the available pixels polygon</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_uangle">Uangle</code></td>
<td>
<p>the slope of shading lines, given as an angle in degrees
(counter-clockwise), for the used pixels polygon</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_aborder">Aborder</code></td>
<td>
<p>the color for drawing the border of the available pixels 
polygon. See <code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_uborder">Uborder</code></td>
<td>
<p>the color for drawing the border of the used pixels polygon. 
See <code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_acol">Acol</code></td>
<td>
<p>the color for filling the available pixels polygon. 
if <code>pts == FALSE</code>, the color for the points corresponding to available
pixels</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_ucol">Ucol</code></td>
<td>
<p>the color for filling the used pixels polygon. 
if <code>pts == FALSE</code>, the color for the points corresponding to used 
pixels</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_alty">Alty</code></td>
<td>
<p>the line type for the available pixels polygon, as in <code>par</code></p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_ulty">Ulty</code></td>
<td>
<p>the line type for the used pixels polygon, as in <code>par</code></p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_abg">Abg</code></td>
<td>
<p>if <code>pts == TRUE</code>, background color for open plot symbols of 
available pixels</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_ubg">Ubg</code></td>
<td>
<p>if <code>pts == TRUE</code>, background color for open plot symbols of 
used pixels</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_ainch">Ainch</code></td>
<td>
<p>if <code>pts == TRUE</code>, heigth in inches of the available pixels</p>
</td></tr> 
<tr><td><code id="scatter.enfa_+3A_uinch">Uinch</code></td>
<td>
<p>if <code>pts == TRUE</code>, heigth in inches of the largest used pixels</p>
</td></tr>
<tr><td><code id="scatter.enfa_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>scatter.enfa</code> displays a factorial map of pixels, as well as the
projection of the vectors of the canonical basis multiplied by a
constant of rescaling.
The kept axes for the plot are specified in a corner.
</p>


<h3>Author(s)</h3>

<p>Mathieu Basille <a href="mailto:basille@ase-research.org">basille@ase-research.org</a></p>


<h3>References</h3>

<p>Basille, M., Calenge, C., Marboutin, E., Andersen, R. &amp; Gaillard,
J.M. (2008) Assessing habitat selection using multivariate statistics:
Some refinements of the ecological-niche factor
analysis. <em>Ecological Modelling</em>, <b>211</b>, 233&ndash;240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+enfa">enfa</a></code>, <code><a href="ade4.html#topic+scatter">scatter</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lynxjura)

map &lt;- lynxjura$map

## We keep only "wild" indices.
locs &lt;- lynxjura$locs
locs &lt;- locs[slot(locs, "data")[,2]!="D",]

hist(map, type = "l")
## The variable artif is far from symetric

## We perform a square root transformation
## of this variable
## We therefore normalize the variable 'artif'
slot(map,"data")[,4] &lt;- sqrt(slot(map,"data")[,4])
hist(map, type = "l")

## We prepare the data for the ENFA
tab &lt;- slot(map, "data")
pr &lt;- slot(count.points(locs, map), "data")[,1]


## We then perform the PCA before the ENFA
pc &lt;- dudi.pca(tab, scannf = FALSE)

## We perform the ENFA
(enfa1 &lt;- enfa(pc, pr, scannf = FALSE))

scatter(enfa1)


</code></pre>

<hr>
<h2 id='scatterniche'>Display the Niche in the Ecological Space </h2><span id='topic+scatterniche'></span>

<h3>Description</h3>

<p><code>scatterniche</code> displays the niche in the Ecological space
(multidimensional space defined by habitat variables).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scatterniche(x, pr, xax = 1, yax = 2, pts = FALSE,
             percent = 95, clabel = 1,
             side = c("top", "bottom", "none"),
             Adensity, Udensity, Aangle, Uangle, Aborder,
             Uborder, Acol, Ucol, Alty, Ulty, Abg,
             Ubg, Ainch, Uinch, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scatterniche_+3A_x">x</code></td>
<td>
<p>a data frame giving the value of environmental variables
(columns) in resource units (rows, e.g. the pixels of a raster map)</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_pr">pr</code></td>
<td>
<p>a vector giving the utilisation weight for each resource
unit</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_xax">xax</code></td>
<td>
<p>the column number for the x-axis</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_yax">yax</code></td>
<td>
<p>the column number for the y-axis</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_pts">pts</code></td>
<td>
<p>logical. Whether the points should be drawn.  If
<code>FALSE</code>, minimum convex polygons are displayed</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_percent">percent</code></td>
<td>
<p>100 minus the proportion of outliers to be excluded from the
computation of the minimum convex polygons</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_clabel">clabel</code></td>
<td>
<p>a character size for the columns</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_side">side</code></td>
<td>
<p>if <code>"top"</code>, the legend of the kept axis is upside, if
<code>"bottom"</code> it is downside, if <code>"none"</code> no legend</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_adensity">Adensity</code></td>
<td>
<p>the density of shading lines, in lines per inch, for the 
available pixels polygon. See <code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_udensity">Udensity</code></td>
<td>
<p>the density of shading lines, in lines per inch, for the 
used pixels polygon. See <code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_aangle">Aangle</code></td>
<td>
<p>the slope of shading lines, given as an angle in degrees
(counter-clockwise), for the available pixels polygon</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_uangle">Uangle</code></td>
<td>
<p>the slope of shading lines, given as an angle in degrees
(counter-clockwise), for the used pixels polygon</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_aborder">Aborder</code></td>
<td>
<p>the color to draw the border of the available pixels 
polygon. See <code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_uborder">Uborder</code></td>
<td>
<p>the color to draw the border of the used pixels polygon. 
See <code><a href="graphics.html#topic+polygon">polygon</a></code> for more details</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_acol">Acol</code></td>
<td>
<p>the color for filling the available pixels polygon. 
if <code>pts==FALSE</code>, the color for the points corresponding to
available pixels</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_ucol">Ucol</code></td>
<td>
<p>the color for filling the used pixels polygon. 
if <code>pts==FALSE</code>, the color for the points corresponding to used 
pixels</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_alty">Alty</code></td>
<td>
<p>the line type for the available pixels polygon, as in
<code>par</code>.</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_ulty">Ulty</code></td>
<td>
<p>the line type for the used pixels polygon, as in <code>par</code>.</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_abg">Abg</code></td>
<td>
<p>if <code>pts==TRUE</code>, background color for open plot symbols of 
available pixels</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_ubg">Ubg</code></td>
<td>
<p>if <code>pts==TRUE</code>, background color for open plot symbols of 
used pixels</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_ainch">Ainch</code></td>
<td>
<p>if <code>pts==TRUE</code>, heigth in inches of the available pixels</p>
</td></tr> 
<tr><td><code id="scatterniche_+3A_uinch">Uinch</code></td>
<td>
<p>if <code>pts==TRUE</code>, heigth in inches of the largest used
pixels</p>
</td></tr>
<tr><td><code id="scatterniche_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mathieu Basille <a href="mailto:basille@ase-research.org">basille@ase-research.org</a><br />
Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chamois)
cpi &lt;- slot(count.points(chamois$locs, chamois$map),"data")[,1]
chamois$map

tab &lt;- slot(chamois$map, "data")

## we focus on the distance to ecotone and on the slope,
## after centring and scaling (with the help of a PCA)
scatterniche(dudi.pca(tab[,2:3], scannf=FALSE)$tab, cpi)
scatterniche(dudi.pca(tab[,2:3], scannf=FALSE)$tab, cpi, pts=TRUE)

</code></pre>

<hr>
<h2 id='squirrel'>Radio-Tracking Data of Squirrels</h2><span id='topic+squirrel'></span>

<h3>Description</h3>

<p>This data set describes the use and availability of 5 habitat types for
17 squirrels monitored using radio-tracking.  See also the dataset
<code>squirreloc</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(squirrel)</code></pre>


<h3>Format</h3>

<p>This list has three components: </p>

<dl>
<dt><code>studyarea</code></dt><dd><p>a data frame giving the proportion of each
habitat type (columns) on the study area. These proportions are
repeated by rows, for all animals</p>
</dd>
<dt><code>mcp</code></dt><dd><p>a data frame giving the proportion of
each habitat type (columns) in the home range of each animal (rows)</p>
</dd>
<dt><code>locs</code></dt><dd><p>a data frame giving the proportion of relocations
of each animal (rows) reported in each habitat type (columns).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Aebischer, N. J., Robertson, P. A. and Kenward, R. E. (1993)
Compositional analysis of habitat use from animal radiotracking
data. <em>Ecology</em>, <b>74</b>, 1313&ndash;1325.
</p>

<hr>
<h2 id='squirreloc'>Radio-tracking of squirrels</h2><span id='topic+squirreloc'></span>

<h3>Description</h3>

<p>This data set contains the trajectories of 15 radio-monitored
squirrels, as well as the vector maps of habitat composition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(squirreloc)</code></pre>


<h3>Format</h3>

<p>This data set is a list of two objects:
<code>locs</code> is a <code>SpatialPointsDataFrame</code> containing the
relocations of 15 squirrels
</p>
<p><code>map</code> is an object of class <code>SpatialPolygonsDataFrame</code>
containing the habitat composition of the area. The habitat types
and colour coding are stored in the data.frame
</p>


<h3>Details</h3>

<p>The dataset <code>squirreloc</code> comes from the Ranges VI software.  It
has been used to illustrate the compositional analysis (see
<code>?compana</code>) and the eigenanalysis of selection ratios (see
<code>?eisera</code>).  See also the dataset <code>squirrel</code>.
</p>


<h3>Source</h3>

<p>Kenward, R.E., South, A.B. and Walls, S.S. (2003). Ranges6 v1.2 : For
the analysis of tracking and location data. Online manual. Anatrack
Ltd. Wareham, UK. ISBN 0-9546327-0-2.
</p>

<hr>
<h2 id='vanoise'>Habitat Use by Three Species of Galliformes in the Vanoise
National Parc</h2><span id='topic+vanoise'></span>

<h3>Description</h3>

<p>This data frame describes the habitat use by the Black Grouse
(<em>Tetrao tetrix</em>), the Rock Partridge (<em>Alectoris graeca</em>)
and the Rock Ptarmigan (<em>Lagopus mutus</em>), in the Vanoise National
Park (French Alps), from 1990 to 2000.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vanoise)</code></pre>


<h3>Format</h3>

<p>This data frame has 3110 rows and eight columns describing the habitat
composition 
for each occurrence of three species of Galliformes. For each
located occurrence (in rows), the employees of the national park have noted:
the species, the elevation (in metres), the aspect (8 classes), the
habitat type (7 categories, <code>FR</code> means &quot;fallen rocks&quot;) and the
date (season, day, month and year).
</p>


<h3>Source</h3>

<p>Calenge, C., Martinot, J.P. and Lebreton, P. (2003)
Ecological niche separation among mountain Galliformes in the Vanoise
National Parc. <em>Game and Wildlife Science</em>, 20, 259-285.
</p>

<hr>
<h2 id='wi'>Computation of Selection Ratios for Habitat Selection Studies.</h2><span id='topic+widesI'></span><span id='topic+widesII'></span><span id='topic+widesIII'></span><span id='topic+print.wiI'></span><span id='topic+print.wiII'></span><span id='topic+print.wiIII'></span><span id='topic+plot.wi'></span><span id='topic+wi'></span><span id='topic+wiI'></span><span id='topic+wiII'></span><span id='topic+wiIII'></span>

<h3>Description</h3>

<p>These functions compute the resource selection ratios (wi) for design I, II
and III data types, with resources defined by several categories.
Basic tests are also provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>widesI(u, a, avknown = TRUE, alpha = 0.05)
widesII(u, a, avknown = TRUE, alpha = 0.05)
widesIII(u, a, avknown = TRUE, alpha = 0.05)
## S3 method for class 'wiI'
print(x, ...)
## S3 method for class 'wiII'
print(x, ...)
## S3 method for class 'wiIII'
print(x, ...)
## S3 method for class 'wi'
plot(x, caxis = 0.7, clab = 1, ylog = FALSE, errbar = c("CI", "SE"),
        main = "Manly selectivity measure", noorder = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wi_+3A_u">u</code></td>
<td>
<p>for <code>widesI</code>, a vector with named elements describing
the sample of used resource units.  For <code>widesII</code> and
<code>widesIII</code> a matrix or a data frame giving the number of used
resource units for each animal (in rows) in each resource category
(in columns)</p>
</td></tr>
<tr><td><code id="wi_+3A_a">a</code></td>
<td>
<p>for <code>widesI</code> and <code>widesII</code>, a vector with named
elements describing the sample or the proportion of available
resource units.  For <code>widesIII</code> a matrix or a
data frame giving the number or the proportion of available resource
units for each animal (in rows) in each resource category (in
columns)</p>
</td></tr>
<tr><td><code id="wi_+3A_avknown">avknown</code></td>
<td>
<p>logical. <code>TRUE</code> if the available
proportions are known, and <code>FALSE</code> if they are estimated</p>
</td></tr>
<tr><td><code id="wi_+3A_alpha">alpha</code></td>
<td>
<p>the threshold value for the tests and confidence
intervals</p>
</td></tr>
<tr><td><code id="wi_+3A_x">x</code></td>
<td>
<p>an object of class <code>wi</code></p>
</td></tr>
<tr><td><code id="wi_+3A_caxis">caxis</code></td>
<td>
<p>character size on axes to be passed to
<code>par("cex.axis")</code></p>
</td></tr>
<tr><td><code id="wi_+3A_clab">clab</code></td>
<td>
<p>character size of axes labels to be passed to
<code>par("cex.lab")</code></p>
</td></tr>
<tr><td><code id="wi_+3A_ylog">ylog</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the selection ratios are plotted
on a log scale</p>
</td></tr>
<tr><td><code id="wi_+3A_errbar">errbar</code></td>
<td>
<p>a character string.  Type of error bars: either <code>"CI"</code>
for confidence intervals or <code>"SE"</code> for standard errors</p>
</td></tr>
<tr><td><code id="wi_+3A_main">main</code></td>
<td>
<p>a character string. The title of the graph</p>
</td></tr>
<tr><td><code id="wi_+3A_noorder">noorder</code></td>
<td>
<p>logical. If <code>TRUE</code>, the habitat categories are
ordered on the graph in decreasing order of their preference. If
FALSE, they are not ordered (i.e. they are in the same order as the
columns in <code>used</code> and <code>available</code></p>
</td></tr>
<tr><td><code id="wi_+3A_...">...</code></td>
<td>
<p>additionnal arguments to be passed to the function
<code>plot</code></p>
</td></tr> 
</table>


<h3>Details</h3>

<p><code>widesI</code> may be used to explore resource selection by
animals, when designs I are involved (habitat use and availability are
measured at the population level - animals are not identified).  The
function tests habitat selection with the Khi2 of Pearson
and log-likelihood Khi2 (recommended, see Manly et al. 2003).  The
Manly selectivity measure (selection ratio = used/available) is
computed, the preference / avoidance is tested for
each habitat, and the differences between selection ratios are computed
and tested. 
</p>
<p><code>widesII</code> computes the selection ratios with design II
data (same availability for all animals, but use measured for each one).
Tests of identical habitat use for all animals, and of habitat
selection are also provided.
</p>
<p><code>widesIII</code> computes the
selection ratios for design III data (when the use and the
availability are measured for each animal - 
see examples on the wild boar below).  Habitat selection is tested
using a Chi-square for each animal, and the overall habitat selection
is also tested.
</p>
<p>Note that all these methods rely on the following hypotheses: (i)
independence between animals, and (ii) all animals are selecting
habitat in the same way (in addition to &quot;traditional&quot; hypotheses in
these kinds of studies: no territoriality, all animals having equal
access to all available resource units, etc., see Manly et al. 2002
for further details).
</p>


<h3>Value</h3>

<p><code>widesI</code> returns a list of the class <code>wiI</code>.  <code>widesII</code>
returns a list of class <code>wiII</code>.  <code>widesIII</code>
returns a list of class <code>wiIII</code>.  These objects are all
inheriting from the class <code>wi</code>.  They have the following components:
</p>
<table>
<tr><td><code>used.prop</code></td>
<td>
<p>the proportion of use for each resource type.</p>
</td></tr>
<tr><td><code>avail.prop</code></td>
<td>
<p>the proportion of available resources.</p>
</td></tr>
<tr><td><code>wi</code></td>
<td>
<p>the Manly selectivity measure (selection ratio:
used/available).</p>
</td></tr>
<tr><td><code>se.wi</code></td>
<td>
<p>the standard error of the selection ratios.</p>
</td></tr>
<tr><td><code>comparisons</code></td>
<td>
<p>a list with the following components:</p>

<dl>
<dt><code>diffwi</code></dt><dd><p>a matrix with the differences of the selection
ratios for each pair of resource type.</p>
</dd>
<dt><code>ICdiffupper</code></dt><dd><p>a matrix containing the upper limit of confidence
interval on the differences of the selection ratios between each
pair of resource type.</p>
</dd>
<dt><code>ICdifflower</code></dt><dd><p>a matrix containing the lower limit of confidence
interval on the differences of the selection ratios between each
pair of resource type.</p>
</dd>
<dt><code>signif</code></dt><dd><p>the ranking matrix, with the sign of the differences
between the resource type in row and the resource type in
column.  When the difference is significant, the sign is
tripled.</p>
</dd>
</dl>

</td></tr>
<tr><td><code>profile</code></td>
<td>
<p>the profile of preferences: resource types are sorted
so that the left type is the most preferred and the right type is
the most avoided.  Habitats for which the selection ratios are not
significant are connected by a line.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the parameter <code>alpha</code> of this function.</p>
</td></tr>
<tr><td><code>avknown</code></td>
<td>
<p>the parameter <code>avknown</code> of this function.</p>
</td></tr>
<tr><td><code>se.used</code></td>
<td>
<p>only for designs I, the standard error of
the proportion of use.</p>
</td></tr>
<tr><td><code>se.avail</code></td>
<td>
<p>only for designs I, the standard error of
the available proportion.</p>
</td></tr>
<tr><td><code>chisquwi</code></td>
<td>
<p>only for designs I, the results of Chi-Square tests of the
hypothesis that the selection ratios are in average equals to zero.</p>
</td></tr>
<tr><td><code>Bi</code></td>
<td>
<p>only for designs I, equals to <code>wi/sum(wi)</code>.</p>
</td></tr>
<tr><td><code>Khi2P</code></td>
<td>
<p>only for designs I, test of random resource use (Pearson
statistic).</p>
</td></tr>
<tr><td><code>Khi2L</code></td>
<td>
<p>For designs I, test of random resource use
(Log-likelihood statistic).  For design III, global test of random 
resource use (Log-likelihood statistic)</p>
</td></tr>
<tr><td><code>Khi2L1</code></td>
<td>
<p>only for designs II, test of identical use of habitat by all
animals.</p>
</td></tr>
<tr><td><code>Khi2L2</code></td>
<td>
<p>only for designs II, test of overall habitat selection.</p>
</td></tr>
<tr><td><code>Khi2L2MinusL1</code></td>
<td>
<p>only for designs II, test of hypothesis that animals
are on average using resources in proportion to availability,
irrespective of whether they are the same or not (= Khi2L2 -
Khi2L1).</p>
</td></tr>
<tr><td><code>wij</code></td>
<td>
<p>only for designs II and III, a matrix with the selection
ratios for all animals and all resource categories.</p>
</td></tr>
<tr><td><code>ICwiupper</code></td>
<td>
<p>only for designs II and III, the upper limit of the
confidence intervals on the selection ratios.</p>
</td></tr>
<tr><td><code>ICwilower</code></td>
<td>
<p>only for designs II and III, the lower limit of the
confidence intervals on the selection ratios.</p>
</td></tr>
<tr><td><code>Khi2Lj</code></td>
<td>
<p>only for designs III, the test of habitat selection for each
animal.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a></p>


<h3>References</h3>

<p>Manly B.F.J., McDonald L.L., Thomas, D.L., McDonald, T.L. &amp; Erickson,
W.P. (2003) <em>Resource selection by animals - Statistical design and
Analysis for field studies. Second edition</em>
London: Kluwer academic publishers.
</p>
<p>Thomas D. L. and Taylor E. J. (1990) Study designs and tests for
comparing resource use and availability. <em>Journal of Wildlife
Management</em>, <b>54</b>, 322&ndash;330.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compana">compana</a></code> for compositional analysis, and
<code><a href="#topic+eisera">eisera</a></code> to perform an eigenanalysis of selection
ratios.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
############################
## Example of moose (Manly et al., 2003, p.52)
## Known available proportions on design I data
moose.avail &lt;- c(0.34, 0.101, 0.104, 0.455)
moose.used &lt;- c(25, 22, 30, 40)
names(moose.used) &lt;- c("InBurnInterior",
                     "InBurnEdge",
                     "OutOfBurnEdge",
                     "OutOfBurnFurther")
names(moose.avail) &lt;- names(moose.used)
## Computation of wi
(wiRatio &lt;- widesI(moose.used, moose.avail))

## plot the values of the selection ratios
opar &lt;- par(mfrow=c(2,2))
plot(wiRatio)

par(opar)




############################
## Example of Elk (Manly et al., 2003, p.62)
## Estimated available proportions on design I data
elk.avail &lt;- c(15, 61, 84, 40)
elk.used &lt;- c(3, 90, 181, 51)
names(elk.used) &lt;- c("0%", "1-25%", "26-75%", "&gt;75%")
names(elk.avail) &lt;- names(elk.used)
## Computation of wi
(wiRatio &lt;- widesI(elk.used, elk.avail, avknown=FALSE))

## plot the values of the selection ratios
opar &lt;- par(mfrow=c(2,2))
plot(wiRatio)

par(opar)




############################
## Example of Bighorn (Manly et al., 2003, p.67)
## Known available proportions on design II data
data(bighorn)
## Computation of wi
(wi &lt;- widesII(bighorn$used, bighorn$availT, alpha = 0.1))

## plot the values of the selection ratios
opar &lt;- par(mfrow=c(2,2))
plot(wi)



############################
## Example of Bighorn (Manly et al., 2003, p.74)
## Estimated available proportions on design II data
## Computation of wi
(wi &lt;- widesII(bighorn$used, bighorn$availE, avknown = FALSE, alpha = 0.1))

## plot the values of the selection ratios
plot(wi)

par(opar)


############################
## Example of Wild boar
## Estimated available proportions on design III data
data(puechdesIII)
used &lt;- puechdesIII$used
available &lt;- puechdesIII$available

## calculation of the selectio ratios
## with sampled availability
(i &lt;- widesIII(used,available, avknown = FALSE, alpha = 0.1))

opar &lt;- par(mfrow = c(2,2))
plot(i)

par(opar)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
