<!DOCTYPE html><html><head><title>Help for package LPM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LPM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ar.egls'><p> Subset Autoregressive Model</p></a></li>
<li><a href='#hourly.rainfall.series'><p>  hourly rainfall series</p></a></li>
<li><a href='#IDFcurve'><p> Intensity duration frequency curve</p></a></li>
<li><a href='#IDFcurve2'><p> Intensity duration frequency curve for maximum annual rainfall series of different duration</p></a></li>
<li><a href='#lpm'><p> Linear Parametric Model</p></a></li>
<li><a href='#LPM-package'><p>LPM</p></a></li>
<li><a href='#milano'><p>  Maximum annual rainfall series for different durations</p></a></li>
<li><a href='#mlpm'><p> Multivariate Linear Parametric Model</p></a></li>
<li><a href='#Pistoia'><p> Dataset of Pistoia (Italy)</p></a></li>
<li><a href='#PWN'><p> Crop Water requirement</p></a></li>
<li><a href='#rain.adapt'><p> Rainfall Adaptor</p></a></li>
<li><a href='#restrict'><p>Support function</p></a></li>
<li><a href='#series.rainfall'><p>  Daily Rainfall Series</p></a></li>
<li><a href='#series.runoff'><p> Daily Runoff Series</p></a></li>
<li><a href='#WNeeds'><p> Crop water requirement</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Linear Parametric Models Applied to Hydrological Series</td>
</tr>
<tr>
<td>Version:</td>
<td>3.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-15</td>
</tr>
<tr>
<td>Description:</td>
<td>Apply Univariate Long Memory Models,
    Apply Multivariate Short Memory Models To Hydrological Dataset,
    Estimate Intensity Duration Frequency curve to rainfall series.
    NEW &ndash; Calculate the monthly water requirement for herbaceous and arboreal 
    plants.</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, grDevices, fracdiff, powdist, MASS</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Corrado Tallerini &lt;corrado.tallerini@gmx.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.corradotallerini.altervista.org/LPM.html">http://www.corradotallerini.altervista.org/LPM.html</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="http://www.corradotallerini.altervista.org/Contatti.html">http://www.corradotallerini.altervista.org/Contatti.html</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Corrado Tallerini [aut, cre],
  Salvatore Grimaldi [aut]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-15 15:01:37 UTC; Corrado</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-15 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ar.egls'> Subset Autoregressive Model </h2><span id='topic+ar.egls'></span>

<h3>Description</h3>

<p>Estimate VAR(p) model fixing some parameter values to zero</p>


<h3>Usage</h3>

<pre><code class='language-R'>ar.egls(x, R, order.max , na.action = na.fail, series = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ar.egls_+3A_x">x</code></td>
<td>
<p> Univariate or multivariate series with nil mean </p>
</td></tr>
<tr><td><code id="ar.egls_+3A_r">R</code></td>
<td>
<p> Matrices of parameters selection </p>
</td></tr>
<tr><td><code id="ar.egls_+3A_order.max">order.max</code></td>
<td>
<p> Model order </p>
</td></tr>
<tr><td><code id="ar.egls_+3A_na.action">na.action</code></td>
<td>
<p> Function to be called to handle missing values </p>
</td></tr>
<tr><td><code id="ar.egls_+3A_series">series</code></td>
<td>
<p> Names for the series.  Defaults to 'deparse(substitute(x))'</p>
</td></tr>
<tr><td><code id="ar.egls_+3A_...">...</code></td>
<td>
<p> See ar.ols </p>
</td></tr>
</table>


<h3>Details</h3>

<p>R matrix is a list of p matrices, with p the autoregressive order. In R value '1' allows parameter estimation, '0' fix the parameter value to zero. </p>


<h3>Value</h3>

<p> See ar.ols
</p>


<h3>Note</h3>

<p> Function is created modifing ar.ols by Adrian Trapletti and Brian Ripley </p>


<h3>Author(s)</h3>

<p> Corrado Tallerini </p>


<h3>References</h3>

<p> Grimaldi  S. , Serinaldi F. &amp; Tallerini C. (2004)  'Multivariate linear parametric models applied to daily rainfall time series'  Mediterranean Storms, 6rd EGU Plinius Conference held in Mediterranean Sea, Italy, October 2004
</p>
<p>Lutkepohl, H. (1993) Introduction to Multiple Time Series
Analysis 2nd Edition ._ Springer Verlag, NY</p>


<h3>Examples</h3>

<pre><code class='language-R'>##	S1=matrix(0,3,3)
##	S1[1,1]=1
##	S1[1,2]=1
##	S=list()
##	S[[1]]=S1
##	S[[2]]=S1
##	ar.egls(series.rainfall[,1:3],S,order.max=2)
## --&gt; Apply a Subset VAR(2) model restricted to 4 parameters (position (1,1)
## --&gt; and (1,2) in both matrices) to first 3 series of series.rainfall 
## --&gt; dataset  </code></pre>

<hr>
<h2 id='hourly.rainfall.series'>  hourly rainfall series </h2><span id='topic+hourly.rainfall.series'></span>

<h3>Description</h3>

<p>Hourly rainfall series recorded in Burlington (US) during the period 2012-2015.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hourly.rainfall.series)</code></pre>


<h3>Details</h3>

<p>Dataset is available on The Iowa Environmental Mesonet (IEM) website</p>


<h3>Source</h3>

<p>https://mesonet.agron.iastate.edu/request/download.phtml?</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hourly.rainfall.series)
## maybe str(series.rainfall) ; plot(series.rainfall) ...
</code></pre>

<hr>
<h2 id='IDFcurve'> Intensity duration frequency curve </h2><span id='topic+IDFcurve'></span>

<h3>Description</h3>

<p>Estimate IDF curve fitting a [mm/h], m ,n, b[h] parameters </p>


<h3>Usage</h3>

<pre><code class='language-R'>IDFcurve(rain, g, s, tc, stvalue1 = 1, stvalue2 = fre, fre, Tr = 200,
                      MP=F, Trplot=F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IDFcurve_+3A_rain">rain</code></td>
<td>
<p> Observed Univariate rainfall series non cumulative </p>
</td></tr>
<tr><td><code id="IDFcurve_+3A_g">g</code></td>
<td>
<p> Maximum bound for cumulative series. For daily series g = 7 is recommended, for hourly series g=24 is racommended </p>
</td></tr>
<tr><td><code id="IDFcurve_+3A_s">s</code></td>
<td>
<p> Threshold for defining &quot;event&quot;. If  &quot;10&quot;, only h &gt; = 10 mm values are considered</p>
</td></tr>
<tr><td><code id="IDFcurve_+3A_tc">tc</code></td>
<td>
<p> Time of concentration of Basin [h]</p>
</td></tr>
<tr><td><code id="IDFcurve_+3A_stvalue1">stvalue1</code>, <code id="IDFcurve_+3A_stvalue2">stvalue2</code></td>
<td>
<p> Starting values of estimation algorithm. Deault stvalue1=1, stvalue2=fre </p>
</td></tr>
<tr><td><code id="IDFcurve_+3A_fre">fre</code></td>
<td>
<p> Series frequency [h]. For daily series fre=24, for hourly series fre=1</p>
</td></tr>
<tr><td><code id="IDFcurve_+3A_tr">Tr</code></td>
<td>
<p> Return period [y]. Default Tr=200</p>
</td></tr>
<tr><td><code id="IDFcurve_+3A_mp">MP</code></td>
<td>
<p>logical: TRUE for 3 parameters formula i=a/(b+t)^m , FALSE for 2 parameters formula  i=a*t^(n-1), Default MP=False </p>
</td></tr>
<tr><td><code id="IDFcurve_+3A_trplot">Trplot</code></td>
<td>
<p>logical: TRUE for plotting Tr values of a(Tr) parameter. Default Trplot=False </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimate parameters of Intensity Duration Frequency curves </p>


<h3>Value</h3>

<table>
<tr><td><code>par</code></td>
<td>
<p>List of estimated parameters: a(tr), m, b, h(t) [mm], i(t) [mm/h], Offset of least squares optimizer</p>
</td></tr>
<tr><td><code>Curve</code></td>
<td>
<p>IDF curve Scattered point matrix [mm/h]  </p>
</td></tr>
</table>


<h3>Note</h3>

<p>a(tr) is defined by Gumbel distribution.  </p>


<h3>Author(s)</h3>

<p> Corrado Tallerini </p>


<h3>See Also</h3>

  <p><code><a href="#topic+IDFcurve2">IDFcurve2</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##    data(hourly.rainfall.series)
##    res = IDFcurve(hourly.rainfall.series ,24, 15, 1, fre=1, Tr=200, MP=F)
## --&gt; 2 parameters IDF curve estimation of a hourly rainfall series applying
## --&gt; a Threshold "15 mm"  and Time of concentration t=1 h
##    res = IDFcurve(hourly.rainfall.series ,24, 15, 1, fre=1, Tr=200, MP=T)
## --&gt; 3 parameters IDF curve estimation of a hourly rainfall series applying
## --&gt; a Threshold "15 mm"  and Time of concentration t=1 h
## --&gt; It's obvious the best performance of the 3 parameters formula</code></pre>

<hr>
<h2 id='IDFcurve2'> Intensity duration frequency curve for maximum annual rainfall series of different duration</h2><span id='topic+IDFcurve2'></span>

<h3>Description</h3>

<p>Estimate IDF curve fitting a [mm/h], m ,n, b[h] parameters of maximum annual rainfall series </p>


<h3>Usage</h3>

<pre><code class='language-R'>IDFcurve2(rain, tc, stvalue1 = 1, stvalue2 = 1, t, Tr = 200, MP = F, Trplot = F)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IDFcurve2_+3A_rain">rain</code></td>
<td>
<p> Observed Maximum annual rainfall series [mm] of increasing duration  </p>
</td></tr>
<tr><td><code id="IDFcurve2_+3A_tc">tc</code></td>
<td>
<p> Time of concentration of Basin [h] , maybe h(t) and i(t) duration must be calculated </p>
</td></tr>
<tr><td><code id="IDFcurve2_+3A_stvalue1">stvalue1</code>, <code id="IDFcurve2_+3A_stvalue2">stvalue2</code></td>
<td>
<p> Starting values of estimation algorithm. Deault stvalue1=1, stvalue2=1 </p>
</td></tr>
<tr><td><code id="IDFcurve2_+3A_t">t</code></td>
<td>
<p>observed rainfall series duration [h] example t=c(1,3,6,12,24) for durations 1,3,6,12,24 hours</p>
</td></tr>
<tr><td><code id="IDFcurve2_+3A_tr">Tr</code></td>
<td>
<p> Return period [y]. Default Tr=200</p>
</td></tr>
<tr><td><code id="IDFcurve2_+3A_mp">MP</code></td>
<td>
<p>logical: TRUE for 3 parameters formula i=a/(b+t)^m , FALSE for 2 parameters formula  i=a*t^(n-1), Default MP=False </p>
</td></tr>
<tr><td><code id="IDFcurve2_+3A_trplot">Trplot</code></td>
<td>
<p>logical: TRUE for plotting Tr values of a(Tr) parameter. Default Trplot=False </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimate parameters of Intensity Duration Frequency curves for maximum annual rainfall series of different duration </p>


<h3>Value</h3>

<table>
<tr><td><code>par</code></td>
<td>
<p>List of estimated parameters: a(Tr), m, b, h(t) [mm], i(t) [mm/h], Offset of least squares optimizer</p>
</td></tr>
<tr><td><code>I</code></td>
<td>
<p>I(t) curve scattered point matrix [mm/h]  </p>
</td></tr>
<tr><td><code>Curve</code></td>
<td>
<p>IDF curve scattered point matrix [mm/h] </p>
</td></tr>
</table>


<h3>Note</h3>

<p>a(Tr) is defined by Gumbel distribution.  </p>


<h3>Author(s)</h3>

<p> Corrado Tallerini </p>


<h3>See Also</h3>

  <p><code><a href="#topic+IDFcurve">IDFcurve</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##     data(milano)
##     ris=IDFcurve2(milano, 1, stvalue1 = 1, stvalue2 = 1,
##     t=c(0.25,0.5,0.75,1,1.25,1.5,2,2.5,3,4,6), Tr = 200, MP=F)
## --&gt; 2 parameters IDF curve estimation of annual maximum rainfall
##     series recorded in Palazzo Marino - Milan (Italy)
##     ris=IDFcurve2(milano, 1, stvalue1 = 1, stvalue2 = 1,
##     t=c(0.25,0.5,0.75,1,1.25,1.5,2,2.5,3,4,6), Tr = 200, MP=T)
## --&gt; 3 parameters IDF curve estimation of annual maximum rainfall
##     series recorded in Palazzo Marino - Milan (Italy)
## --&gt; It's obvious the best performance of the 3 parameters formula</code></pre>

<hr>
<h2 id='lpm'> Linear Parametric Model </h2><span id='topic+lpm'></span>

<h3>Description</h3>

<p>Estimate ARMA and FARMA models, make simulations and ed eventually apply a corrective procedure to rainfall synthetic series. Besides you can remove seasonal components with STL modified method. </p>


<h3>Usage</h3>

<pre><code class='language-R'>lpm(x, p, q, n, smean, svar, outer=0, prob = 0.95, fre = 365, 
fractional = F, Plag = 20, lsign=0.05, n1 = 399, trasfo = F, des = T, rain = F, graph = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lpm_+3A_x">x</code></td>
<td>
<p> Univariate series </p>
</td></tr>
<tr><td><code id="lpm_+3A_p">p</code></td>
<td>
<p> AR order </p>
</td></tr>
<tr><td><code id="lpm_+3A_q">q</code></td>
<td>
<p> MA order </p>
</td></tr>
<tr><td><code id="lpm_+3A_n">n</code></td>
<td>
<p> Number of series to simulate </p>
</td></tr>
<tr><td><code id="lpm_+3A_outer">outer</code></td>
<td>
<p> Number of outer loops for STL modified method. Default outer = 0  </p>
</td></tr>
<tr><td><code id="lpm_+3A_smean">smean</code>, <code id="lpm_+3A_svar">svar</code></td>
<td>
<p> Mean and Variance smoothing windows of STL modified method </p>
</td></tr>
<tr><td><code id="lpm_+3A_prob">prob</code></td>
<td>
<p> Parameter confidence interval. Default prob = 0.95   </p>
</td></tr>
<tr><td><code id="lpm_+3A_fre">fre</code></td>
<td>
<p> Series frequency. Default fre = 365 (for daily series)  </p>
</td></tr>
<tr><td><code id="lpm_+3A_fractional">fractional</code></td>
<td>
<p> Logical variable: T to apply FARMA model. Default fractional = F </p>
</td></tr>
<tr><td><code id="lpm_+3A_plag">Plag</code></td>
<td>
<p> Maximum lag of ACF used in the Portmanteau test. Default Plag = 20 </p>
</td></tr>
<tr><td><code id="lpm_+3A_lsign">lsign</code></td>
<td>
<p>Portmanteau Test significance level. Default lsign = 0.05  </p>
</td></tr>
<tr><td><code id="lpm_+3A_n1">n1</code></td>
<td>
<p> Number of parameters of infinite MA model . Default n1 = 399 </p>
</td></tr>
<tr><td><code id="lpm_+3A_trasfo">trasfo</code></td>
<td>
<p> Logical variable: T for preventive logarithmical trasformation. Default trasfo = F</p>
</td></tr>
<tr><td><code id="lpm_+3A_des">des</code></td>
<td>
<p> Logical variable: T to remove seasonal components. Default des = T </p>
</td></tr>
<tr><td><code id="lpm_+3A_rain">rain</code></td>
<td>
<p> Logical variable: T to apply the corrective procedure to daily rainfall simulated series. Default rain = F </p>
</td></tr>
<tr><td><code id="lpm_+3A_graph">graph</code></td>
<td>
<p> Logical variable: T to receive some graphics. Default graph = F </p>
</td></tr></table>


<h3>Details</h3>

<p> Need integer periodical dataset. Function to complete modelling univariate series. </p>


<h3>Value</h3>

 
<table>
<tr><td><code>para</code></td>
<td>
<p>List of estimated parameters</p>
</td></tr>
<tr><td><code>res</code></td>
<td>
<p>Residual series</p>
</td></tr>
<tr><td><code>simdes</code></td>
<td>
<p>List of simulated series without application of corrective procedure </p>
</td></tr>
<tr><td><code>sim</code></td>
<td>
<p> List of simulated series </p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p> Bayesian Information criterion index of estimated model</p>
</td></tr>
</table>


<h3>Note</h3>

<p> Portmonteau test and BIC index are displaied during application. Portmonteau Test is positive if Q &lt; chi square </p>


<h3>Author(s)</h3>

<p> Salvatore Grimaldi </p>


<h3>References</h3>

<p> Grimaldi, S., 'Linear parametric models applied on daily hydrological series', Journal of Hydrologic Engineering, Vol.9, No 5, September  2004.
</p>
<p>Grimaldi S., F. Napolitano, L. Ubertini, 'A procedure to use linear parametric models for daily rainfall series simulation' 
</p>
<p>Brockwell, P.J and Davis, R.A. (1990) Time Series: Theory and Methods 2nd edition, Springer, NY.
</p>
<p>Hipel, K.W. and McLeod, A.I., (1994) Time Series Modelling of Water Resources and Enviromental Systems, Reading, UK.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+rain.adapt">rain.adapt</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>##---  lpm(series.runoff,1,1,0,30,30,fractional=T,trasfo=T)
##--   Apply a FARMA(1,d,1) model to series.runoff after e preventive 
##     logarithmical trasformation and deseasonalization with smoothing 30. 

</code></pre>

<hr>
<h2 id='LPM-package'>LPM</h2><span id='topic+LPM'></span>

<h3>Description</h3>

<p>Apply Univariate Long Memory Models,
Apply Multivariate Short Memory Models To Hydrological Dataset,
Estimate Intensity Duration Frequency curve to rainfall series.
NEW &ndash; Calculate the monthly water requirement for herbaceous and arboreal
plants.</p>


<h3>Details</h3>

<p>See
<code><a href="#topic+ar.egls">ar.egls</a></code>,
<code><a href="#topic+lpm">lpm</a></code>,
<code><a href="#topic+mlpm">mlpm</a></code>
<code><a href="#topic+rain.adapt">rain.adapt</a></code>
<code><a href="#topic+WNeeds">WNeeds</a></code>
<code><a href="#topic+PWN">PWN</a></code>
</p>


<h3>Author(s)</h3>

<p>Authors: Salvatore Grimaldi and Corrado Tallerini
</p>
<p>Maintainer: Corrado Tallerini
</p>


<h3>References</h3>

<p>Grimaldi S., Tallerini C., Serinaldi F. (2004)  'Modelli multivariati lineari per la generazione di serie di precipitazioni giornaliere' Giornata di Studio: Metodi Statistici e Matematici per l'Analisi Idrologiche  Napoli 2004
</p>
<p>Grimaldi  S. , Serinaldi F. &amp; Tallerini C. (2004)  'Multivariate linear parametric models applied to daily rainfall time series'  Mediterranean Storms, 6rd EGU Plinius Conference held in Mediterranean Sea, Italy, October 2004
</p>
<p>Lutkepohl, H. (1993) Introduction to Multiple Time Series Analysis 2nd edition, Springer-Verlag, Berlin.
</p>
<p>Grimaldi, S.,  'Linear parametric models applied on daily hydrological series', Journal of Hydrologic Engineering, Vol. 9, No 5 , September 2004.
</p>
<p>Brockwell, P.J and Davis, R.A. (1990) Time Series: Theory and Methods 2nd edition, Springer, NY.
</p>
<p>Hipel, K.W. and McLeod, A.I., (1994) Time Series Modelling of Water Resources and Enviromental Systems, Reading, UK.
</p>
<p>Hosking, J.R.M. (1980) 'The Multivariate Portmanteau Statistic' Journal of the American Statistical Association, Vol.75, N.371, 502-608.
</p>
<p>United States Department of Agricolture (USDA - SCS). IRRIGATION - National Engineering handbook.
</p>
<p>Fao irrigation and dreinage paper N. 24 - Crop water requirement, Food and agriculture organization of the united nations ROME, rivisited 1977
</p>
<p>Moisello U.  &quot;Idrologia Tecnica&quot; La Goliardica Pavese.
</p>
<p>Genovesi R., Bottau D. &quot;L'importanza della falda nell' alimentazione idrica delle colture nella pianura emiliano-romagnola.&quot;
</p>
<p>Regione Campania - Assessorato Agricoltura - Settore S.I.R.C.A. La tessitura del suolo (foglio divulgativo novembre - dicembre 2002)
</p>

<hr>
<h2 id='milano'>  Maximum annual rainfall series for different durations </h2><span id='topic+milano'></span>

<h3>Description</h3>

<p>Maximum annual rainfall series for different durations recorded 
at the pluviograph of Palazzo Marino, Milan (Italy)  </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(milano)</code></pre>


<h3>Details</h3>

<p>Maximum annual precipitation series for 0.25, 0.5, 0.75, 1, 1.25, 1.50, 2, 2.5, 3, 4, 6 [h] 1931-1970 </p>


<h3>Source</h3>

<p>dataset of Palazzo Marino pluviograph , Milan (Italy)</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(milano)
## maybe str(series.rainfall) ; plot(series.rainfall) ...
</code></pre>

<hr>
<h2 id='mlpm'> Multivariate Linear Parametric Model </h2><span id='topic+mlpm'></span>

<h3>Description</h3>

<p>Multivariate modelling using VAR(p) and SVAR(p) different estimation methods, simulation, daily rainfall simulated series correction and deseasonalization are performed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlpm(x, p, prob, nsim, smean, svar, fre = 365, outer = 0,plot = F, 
rain = T, over = T, estimate = "ols", CCFlag = 20, Plag = 20, lsign = 0.05, des = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlpm_+3A_x">x</code></td>
<td>
<p> Multivariate series </p>
</td></tr>
<tr><td><code id="mlpm_+3A_p">p</code></td>
<td>
<p> Model order </p>
</td></tr>
<tr><td><code id="mlpm_+3A_prob">prob</code></td>
<td>
<p> Condifidence interval used to fix parameters in SVAR(p) model  </p>
</td></tr>
<tr><td><code id="mlpm_+3A_nsim">nsim</code></td>
<td>
<p> Number of series to simulated </p>
</td></tr>
<tr><td><code id="mlpm_+3A_smean">smean</code>, <code id="mlpm_+3A_svar">svar</code></td>
<td>
<p> Mean and Variance smoothing windows of STL modified method </p>
</td></tr>
<tr><td><code id="mlpm_+3A_fre">fre</code></td>
<td>
<p> Series frequency. Default fre = 365 </p>
</td></tr>
<tr><td><code id="mlpm_+3A_outer">outer</code></td>
<td>
<p> Outer loops of STL modified method. Default outer = 0 </p>
</td></tr>
<tr><td><code id="mlpm_+3A_plot">plot</code></td>
<td>
<p> Logical variable: T to receive some graphics. Default plot = F  </p>
</td></tr>
<tr><td><code id="mlpm_+3A_rain">rain</code></td>
<td>
<p> Logical variable: T to apply rain adaptor to simulated series. Default rain = F  </p>
</td></tr>
<tr><td><code id="mlpm_+3A_over">over</code></td>
<td>
<p> Logical variable: T to use SVAR(p) model estimated with EGLS method. Need estimate = 'ols'  Default over = T  </p>
</td></tr>
<tr><td><code id="mlpm_+3A_estimate">estimate</code></td>
<td>
<p> Define VAR(p) estimation method. 'ols', 'burg', 'yw' (Yule-Walker). Default estimate = 'ols' </p>
</td></tr>
<tr><td><code id="mlpm_+3A_ccflag">CCFlag</code></td>
<td>
<p> Lag of (Partial) Auto-CrossCorrelation function graphics . Default CCFlag = 20 </p>
</td></tr>
<tr><td><code id="mlpm_+3A_plag">Plag</code></td>
<td>
<p> Maximum lag of A-CCF used in the Portmanteau Test. Default Plag = 20 </p>
</td></tr>
<tr><td><code id="mlpm_+3A_lsign">lsign</code></td>
<td>
<p>Portmanteau Test significance level. Default lsign = 0.05  </p>
</td></tr>
<tr><td><code id="mlpm_+3A_des">des</code></td>
<td>
<p> Logical variable: T to remove seasonal components  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Need integer periodical datasets.
Simulation use Lutkepohl algorithm with a residuals vectorial permutation to obtain innovations.
Parameters selections of EGLS method is defined by t-ratio approach.
</p>


<h3>Value</h3>

<table>
<tr><td><code>coeff</code></td>
<td>
<p>List of estimated coefficients matrix</p>
</td></tr>
<tr><td><code>coeffstd</code></td>
<td>
<p> List of estimated standard deviations coefficients matrix. Only for OLS and EGLS method</p>
</td></tr>
<tr><td><code>struct</code></td>
<td>
<p> List of 'structure' of SVAR(p) model (1 define position of estimated parameter). Only for EGLS method
</p>
</td></tr>
<tr><td><code>res</code></td>
<td>
<p>Residual series </p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>Output List of ar function</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike Information Criterion index </p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Portmonteau statistic </p>
</td></tr>
<tr><td><code>sim</code></td>
<td>
<p>List of simulated series  </p>
</td></tr>
</table>


<h3>Note</h3>

<p> Portmonteau test, AIC e SBC index are displaied during application. Portmonteau test is positive if Q &lt; chi square. </p>


<h3>Author(s)</h3>

<p>Corrado Tallerini  </p>


<h3>References</h3>

<p> Grimaldi S., Tallerini C., Serinaldi F. (2004)  'Modelli multivariati lineari per la generazione di serie di precipitazioni giornaliere' Giornata di Studio: Metodi Statistici e Matematici per l'Analisi Idrologiche  Napoli 2004
</p>
<p>Grimaldi  S. , Serinaldi F. &amp; Tallerini C. (2004)  'Multivariate linear parametric models applied to daily rainfall time series'  Mediterranean Storms, 6rd EGU Plinius Conference held in Mediterranean Sea, Italy, October 2004
</p>
<p>Lutkepohl, H. (1993) Introduction to Multiple Time Series Analysis 2nd edition, Springer-Verlag, Berlin.
</p>
<p>Grimaldi, S.,  'Linear parametric models applied on daily hydrological series', Journal of Hydrologic Engineering, Vol. 9, No 5 , September 2004.
</p>
<p>Brockwell, P.J and Davis, R.A. (1990) Time Series: Theory and Methods 2nd edition, Springer, NY.
</p>
<p>Hipel, K.W. and McLeod, A.I., (1994) Time Series Modelling of Water Resources and Enviromental Systems, Reading, UK.
</p>
<p>Hosking, J.R.M. (1980) 'The Multivariate Portmanteau Statistic' Journal of the American Statistical Association, Vol.75, N.371, 502-608.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+lpm">lpm</a></code>, <code><a href="#topic+ar.egls">ar.egls</a></code>, <code><a href="#topic+rain.adapt">rain.adapt</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##-- Mrain=mlpm(series.rainfall,3,0.95,0,120,120)
##-- Apply a SVAR(3) model with selection probability 95 % to series.rainfall
##-- after preventive deseasonalization with smoothing 120.

</code></pre>

<hr>
<h2 id='Pistoia'> Dataset of Pistoia (Italy)
</h2><span id='topic+Pistoia'></span>

<h3>Description</h3>

<p> Bivariate series of observed rainfall-temperature for Pistoia (Italy) during the period 1951-2012
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Pistoia)</code></pre>


<h3>Format</h3>

<p>A data frame with 744 observations on the following 2 variables.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>Monthly cumulative rainfall (mm)</p>
</dd>
<dt><code>V2</code></dt><dd><p>Average monthly temperature (degree)</p>
</dd>
</dl>



<h3>Source</h3>

<p> Ce.Spe.Vi. (Centro sperimentale per il vivaismo)
Web: http://www.cespevi.it
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Pistoia)
## maybe str(Pistoia) ; plot(Pistoia) ...
</code></pre>

<hr>
<h2 id='PWN'> Crop Water requirement
</h2><span id='topic+PWN'></span>

<h3>Description</h3>

<p> Calculate the monthly irrigation requirement of crops based on  cumulative probability [p] and daily watering duration of irrigation [h]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PWN(x1, frvol, R, p, irr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PWN_+3A_x1">x1</code></td>
<td>
<p> Bivariate series of monthly cumulative rainfall and average monthly temperatures
</p>
</td></tr>
<tr><td><code id="PWN_+3A_frvol">frvol</code></td>
<td>

<p>Volume fraction of the soil. It is 0.10 for sandy soil, 0.20 fpr loamy soil, 0.18 for clayey soil, 0.13 for medium-textured soil
</p>
</td></tr>
<tr><td><code id="PWN_+3A_r">R</code></td>
<td>
<p>Length of plant roots [cm] &mdash; see FAO-24 Mannini reworked, maximum extraction depth
</p>
</td></tr>
<tr><td><code id="PWN_+3A_p">p</code></td>
<td>
<p> Cumulative probability of plant's water requirement [percent]
</p>
</td></tr>
<tr><td><code id="PWN_+3A_irr">irr</code></td>
<td>
<p> Daily watering duration of irrigation [h]
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Values</code></td>
<td>
<p>Monthly water requirement values [m3/ha] relating to the cumulative probability indicated (p)</p>
</td></tr>
<tr><td><code>Flow</code></td>
<td>
<p>Irrigation flow [l/s/ha] relating to the daily watering duration (irr) and cumulative probability (p)  </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Corrado Tallerini
</p>


<h3>References</h3>

<p>United States Department of Agricolture (USDA - SCS). IRRIGATION - National Engineering handbook.
</p>
<p>Moisello U.  &quot;Idrologia Tecnica&quot; La Goliardica Pavese.
</p>
<p>Genovesi R., Bottau D. &quot;L'importanza della falda nell' alimentazione idrica delle colture nella pianura emiliano-romagnola.&quot;
</p>
<p>Regione Campania - Assessorato Agricoltura - Settore S.I.R.C.A. La tessitura del suolo (foglio divulgativo novembre - dicembre 2002)
</p>
<p>Fao irrigation and dreinage paper N. 24 - Crop water requirement, Food and agriculture organization of the united nations ROME, rivisited 1977
</p>
<p>Grimaldi, S. Tallerini, C., Serinaldi, F.,  &quot;Modelli multivariati lineari per la generazione di serie di precipitazioni giornaliere&quot;, Giornata di Studio: Metodi Statistici e Matematici per l'Analisi delle Serie Idrologiche, Napoli, maggio 2004
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- data(Pistoia)
##---- PWN(Pistoia,0.13,40,75,16)
##---- Calculate the monthly irrigation requirement of a plant (Length of plant roots 40 cm in
##---- a medium-textured soil) based on a 75% cumulative probability and 16 hours daily irrigation
</code></pre>

<hr>
<h2 id='rain.adapt'> Rainfall Adaptor  </h2><span id='topic+rain.adapt'></span>

<h3>Description</h3>

<p>Apply a corrective procedure to daily rainfall series to enforce actual caracteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rain.adapt(x, a, ser)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rain.adapt_+3A_x">x</code></td>
<td>
<p> Observed series </p>
</td></tr>
<tr><td><code id="rain.adapt_+3A_a">a</code></td>
<td>
<p> Univariate series to modify (simulated series) </p>
</td></tr>
<tr><td><code id="rain.adapt_+3A_ser">ser</code></td>
<td>
<p> Series identification number  </p>
</td></tr>
</table>


<h3>Details</h3>

<p> The no-rain frequency consequentally the total rainfall depth of the observed series are enforced on the synthetic series
</p>


<h3>Value</h3>

<p>Corrected series
</p>


<h3>Author(s)</h3>

<p>Salvatore Grimaldi </p>


<h3>References</h3>

<p> Grimaldi S., F. Napolitano, L. Ubertini, 'A procedure to use linear parametric models for daily rainfall series simulation'  </p>


<h3>Examples</h3>

<pre><code class='language-R'>##   rain=lpm(series.rainfall[,1],1,1,1,120,120)
##   rain.adapt(series.rainfall[,1],rain$sim[[1]],1)
##-- ==&gt;  Apply rain adaptor to a simulated series with a ARMA(1,1) model

</code></pre>

<hr>
<h2 id='restrict'>Support function</h2><span id='topic+restrict'></span><span id='topic+sync'></span><span id='topic+vec'></span><span id='topic+unvec'></span><span id='topic+modarma'></span><span id='topic+modfarma'></span><span id='topic+Stagiona'></span><span id='topic+arfimainf'></span><span id='topic+Arinf'></span><span id='topic+farima.err'></span><span id='topic+Mainf1'></span><span id='topic+Mainf3'></span><span id='topic+prova1'></span><span id='topic+prova2'></span><span id='topic+prova4'></span><span id='topic+prova7'></span><span id='topic+coeffd2'></span><span id='topic+filter.frac'></span><span id='topic+bd1'></span><span id='topic+Prodpoly1'></span><span id='topic+stlstu'></span><span id='topic+multides'></span><span id='topic+multipro'></span><span id='topic+multistag'></span><span id='topic+ClearRow'></span><span id='topic+id'></span><span id='topic+M'></span><span id='topic+permres'></span><span id='topic+PortBIC'></span><span id='topic+Portmanteau'></span><span id='topic+restrict'></span><span id='topic+sigmaZ'></span><span id='topic+simvar'></span><span id='topic+somdiag'></span><span id='topic+startvalue'></span><span id='topic+varcoeff'></span><span id='topic+Corrmatrix'></span><span id='topic+zero'></span><span id='topic+dippermres'></span><span id='topic+count'></span><span id='topic+Contazeri'></span><span id='topic+contaleva'></span><span id='topic+Levaneg'></span><span id='topic+aggiustam'></span><span id='topic+aggiusta'></span><span id='topic+Hreg'></span><span id='topic+Hreg1'></span><span id='topic+Ireg'></span><span id='topic+Ireg1'></span><span id='topic+eventi'></span><span id='topic+eventi2'></span><span id='topic+f1'></span><span id='topic+f2'></span><span id='topic+f3'></span><span id='topic+f4'></span><span id='topic+f5'></span><span id='topic+vb'></span><span id='topic+annualmax'></span><span id='topic+Df'></span><span id='topic+FIdrico2'></span><span id='topic+Index1'></span><span id='topic+MSeason'></span><span id='topic+Pe1'></span><span id='topic+Thornthwaite'></span><span id='topic+contaleva2'></span><span id='topic+PW'></span>

<h3>Description</h3>

<p>Support function</p>

<hr>
<h2 id='series.rainfall'>  Daily Rainfall Series </h2><span id='topic+series.rainfall'></span>

<h3>Description</h3>

<p>Group of 5 daily rainfall series recorded in Tuscany region of Italy during the period 1958-1979. </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(series.rainfall)</code></pre>


<h3>Details</h3>

<p>Dataset is created removing lacking years and replacing lacking days with the mean of previous and successive value. Beside 29 february day values are removed   to obtain integer periodical dataset.</p>


<h3>Source</h3>

<p>Rudari, R. 'Predicibilita' del clima europeo ed influenze delle forzanti a scala sinottica su eventi regionali di precipitazione intensa', PDh Thesis 2001</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(series.rainfall)
## maybe str(series.rainfall) ; plot(series.rainfall) ...
</code></pre>

<hr>
<h2 id='series.runoff'> Daily Runoff Series </h2><span id='topic+series.runoff'></span>

<h3>Description</h3>

<p>Daily runoff series of Tiber river observed to Ripetta station during the period 1930-1983 </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(series.runoff)</code></pre>


<h3>Details</h3>

<p>29 february day values are removed to obtain integer periodical dataset 
</p>


<h3>Source</h3>

<p>Available on the web site www.gndci.cnr.it. &quot;Gruppo nazionale per la difesa delle catastrofi idrogeologiche&quot; 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(series.runoff)
## maybe str(series.runoff) ; plot(series.runoff) ...
</code></pre>

<hr>
<h2 id='WNeeds'> Crop water requirement
</h2><span id='topic+WNeeds'></span>

<h3>Description</h3>

<p>Calculates the water requirement [m3/ha] of herbaceous or arboreal crops</p>


<h3>Usage</h3>

<pre><code class='language-R'>WNeeds(x, frvol, R)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WNeeds_+3A_x">x</code></td>
<td>
<p> Bivariate series of monthly cumulative rainfall [mm] and average monthly temperatures [degree]
</p>
</td></tr>
<tr><td><code id="WNeeds_+3A_frvol">frvol</code></td>
<td>

<p>Volume fraction of the soil. It is 0.10 for sandy soil, 0.20 fpr loamy soil, 0.18 for clayey soil, 0.13 for medium-textured soil
</p>
</td></tr>
<tr><td><code id="WNeeds_+3A_r">R</code></td>
<td>
<p>Length of plant roots [cm] &mdash; see FAO-24 Mannini reworked, maximum extraction depth
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Corrado Tallerini
</p>


<h3>References</h3>

<p>United States Department of Agricolture (USDA - SCS). IRRIGATION - National Engineering handbook.
</p>
<p>Moisello U.  &quot;Idrologia Tecnica&quot; La Goliardica Pavese.
</p>
<p>Genovesi R., Bottau D. &quot;L'importanza della falda nell' alimentazione idrica delle colture nella pianura emiliano-romagnola.&quot;
</p>
<p>Regione Campania - Assessorato Agricoltura - Settore S.I.R.C.A. La tessitura del suolo (foglio divulgativo novembre - dicembre 2002)
</p>
<p>Fao irrigation and dreinage paper N. 24 - Crop water requirement, Food and agriculture organization of the united nations ROME, rivisited 1977
</p>
<p>Grimaldi, S. Tallerini, C., Serinaldi, F.,  &quot;Modelli multivariati lineari per la generazione di serie di precipitazioni giornaliere&quot;, Giornata di Studio: Metodi Statistici e Matematici per l'Analisi delle Serie Idrologiche, Napoli, maggio 2004
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data(Pistoia)
## A1=WNeeds(Pistoia,0.13,60)
## edit(A1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
