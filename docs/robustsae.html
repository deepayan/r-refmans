<!DOCTYPE html><html><head><title>Help for package robustsae</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {robustsae}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#robustsae-package'><p>Robust Bayesian Small Area Estimation</p></a></li>
<li><a href='#BZdata'><p>Brazilian data</p></a></li>
<li><a href='#corndata'><p>Corn data in 8 counties in Iowa.</p></a></li>
<li><a href='#robustsae'><p>Robust Small Area Estimation Modeling Both Means and Variances</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Bayesian Small Area Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-12-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Malay Ghosh, Jiyoun Myung, Fernando Moura</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiyoun Myung &lt;jiyoun@ufl.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for Robust Bayesian Small Area Estimation.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.1.0), MCMCpack, coda, lattice, mvtnorm, pscl</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-12-06 04:41:37 UTC; yongator</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-12-06 07:52:43</td>
</tr>
</table>
<hr>
<h2 id='robustsae-package'>Robust Bayesian Small Area Estimation </h2><span id='topic+robustsae-package'></span>

<h3>Description</h3>

<p>The package provides a function <code>robustsae</code> for full non-subjective Bayesian analysis for the general area level small area models. This considers small area modeling of both the population means and the population variances. This is possible due to the availability of additional data purported to estimate the error variances. Also, in order to induce some robustness of the procedure, t-prior for the random effects is used. When the data set includes true values for interest parameter, this function returns the comparison criteria.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> robustsae</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-12-05</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This package provides function for full Bayesian analysis of small area models. 
</p>


<h3>Author(s)</h3>

<p>Malay Ghosh, Jiyoun Myung, Fernando Moura
</p>
<p>Maintainer: Jiyoun Myung &lt;jiyoun@ufl.edu&gt;
</p>


<h3>References</h3>

<p>Chip, S., and Green berg, E. (1995). Understanding the Metropolis-Hastings Algorithm.
<em>The American Statistician</em>, <b>49</b>, 327-335.
</p>
<p>Rao, J. N. K. (2003) <em> Small Area Estimation</em>. John Wiley and Sons.
</p>
<p>You, Y. and Chapman, B. (2006) Small Area Estimation Using Area Level Models and Estimated Sampling 
Variances. <em> Survey Methodology,</em> <b> 32:</b> 97-103.
</p>
<p>Malay Ghosh, Jiyoun Myung, and Fernando Moura. (submitted) Robust Bayesian Small Area Estimation.
</p>

<hr>
<h2 id='BZdata'>Brazilian data</h2><span id='topic+BZdata'></span>

<h3>Description</h3>

<p> The data set is selected by a 10% random sampling of households in each area from a test demographic census completed in one municipality in Brazil consisting of 140 enumeration districts. This data set includes two centered auxiliary covariates, sampling means, sampling variances and true means for all areas. The contained information is available only at the area level.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("BZdata")</code></pre>


<h3>Format</h3>

<p>A data frame with 140 observations on the following 6 variables.
</p>

<dl>
<dt><code>ni</code>:</dt><dd><p> sample size for each district.</p>
</dd>
<dt><code>X1</code>:</dt><dd><p> respective small area population means of the educational attainment of the head of                          household, centered auxiliary covariate.</p>
</dd>
<dt><code>X2</code>:</dt><dd><p> respective average number of rooms in households, centered auxiliary covariate</p>
</dd>
<dt><code>S2</code>:</dt><dd><p> respective sampling variances income of head of the household.</p>
</dd>
<dt><code>y</code>:</dt><dd><p> respective average mean income of head of the household.</p>
</dd>
<dt><code>truemean</code>:</dt><dd><p> respective true mean income of head of the household.</p>
</dd>
</dl>


<hr>
<h2 id='corndata'>Corn data in 8 counties in Iowa.</h2><span id='topic+corndata'></span>

<h3>Description</h3>

<p> Survey and satellite data for corn and soy beans in 12 Iowa counties, obtained from the 1978 June Enumerative Survey of the U.S. Department of Agriculture and from land observatory satellites (LANDSAT) during the 1978 growing season.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("corndata")</code></pre>


<h3>Format</h3>

<p>A data frame with 8 observations on the following 6 variables.
</p>

<dl>
<dt><code>County</code>:</dt><dd><p> county names.</p>
</dd>
<dt><code>ni</code>:</dt><dd><p> sample size for each county.</p>
</dd>
<dt><code>Xi</code>:</dt><dd><p> mean of reported hectares of corn from the survey, direct survey estimate.</p>
</dd>
<dt><code>Z1i</code>:</dt><dd><p> mean of pixels of corn for each, from satellite data.</p>
</dd>
<dt><code>Z2i</code>:</dt><dd><p> mean of pixels of soy bean for each county, from satellite data.</p>
</dd>
<dt><code>Si</code>:</dt><dd><p> square root of sample variance of reported hectares of corn from the survey.</p>
</dd>
</dl>



<h3>Details</h3>

<p> While the original dataset includes survey and satellite data for corn in 12 Iowa counties, this dataset contains only 8 counties' information where sample sizes are greater than 1.
</p>


<h3>Source</h3>

 
<p>- Battesse, G.E., Harter, R.M. and Fuller, W.A. (1988). An Error-Components Model for Prediction of County Crop Areas Using Survey and Satellite Data. <em> Journal of the American Statistical Association</em>, <b> 83</b>, 28-36.
</p>
<p>- You, Y. and Chapman, B. (2006) Small Area Estimation Using Area Level Models and Estimated Sampling
Variances. <em> Survey Methodology</em>, <b> 32</b>, 97-103.
</p>

<hr>
<h2 id='robustsae'>Robust Small Area Estimation Modeling Both Means and Variances</h2><span id='topic+robustsae'></span>

<h3>Description</h3>

<p>This function provides full Bayesian Analysis for specific area-level small area models when data are provided for modeling both the mean and the variance.</p>


<h3>Usage</h3>

<pre><code class='language-R'>robustsae(formula, S2, ni, nsim = 1000, burnin = 500, data, truemean)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robustsae_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be fitted. The details of model
specification are given under Details.</p>
</td></tr>
<tr><td><code id="robustsae_+3A_s2">S2</code></td>
<td>
<p>a vector contain the sampling variances which are given for estimating the true variances.</p>
</td></tr>
<tr><td><code id="robustsae_+3A_ni">ni</code></td>
<td>
<p>a vector containing the sample sizes for each area.</p>
</td></tr>
<tr><td><code id="robustsae_+3A_nsim">nsim</code></td>
<td>
<p>user-specified number of MCMC draws. See German (2006).</p>
</td></tr>
<tr><td><code id="robustsae_+3A_burnin">burnin</code></td>
<td>
<p>the number of burning iterations for the sampler. See German (2006).</p>
</td></tr>

<tr><td><code id="robustsae_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables named in <code>formula</code>, <code>S2</code> and <code>ni</code>.</p>
</td></tr>
<tr><td><code id="robustsae_+3A_truemean">truemean</code></td>
<td>
<p>true mean values for each area.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\theta_i</code> denotes interest parameter for each area i, <code class="reqn">x_i</code> the available area-specific auxiliary data, <code class="reqn">\beta</code> the regression coefficients and <code class="reqn">m</code> the number of small areas. A typical area level model is given by
</p>
<p style="text-align: center;"><code class="reqn">y_i= x_i \beta + u_i + e_i, (i = 1, \ldots, m).</code>
</p>

<p>Assume that the random effects <code class="reqn">u_i</code> and the sampling errors <code class="reqn">e_i</code> are to be independently distributed  with the <code class="reqn">u_i ~ N(0, \sigma^2)</code> and the <code class="reqn">e_i ~ N(0, v_i)</code>. To foster robustness in small area estimation procedures, student t distribution is used for the random effects. Also, due to the availability of additional data purported to estimate the error variances, this considers modeling of both the means and the variances. 
</p>
<p>The robust Bayesian small area estimation model is
</p>
<p style="text-align: center;"><code class="reqn">y_i | \theta_i ~ N(\theta_i, v_i)</code>
</p>

<p style="text-align: center;"><code class="reqn">S_i^2 | v_i  ~ Gamma((n_i-1)/2,  1/(2v_i))</code>
</p>

<p style="text-align: center;"><code class="reqn"> \theta_i | \beta, \sigma^2, df ~ t(x_i\beta, \sigma^2, df)</code>
</p>
<p>,
where <code class="reqn">df</code> is degrees of freedom parameter.
For a full Bayesian analysis, this function uses the modified Jeffrey' prior which is the product of the general Jeffrey' prior and <code class="reqn">e^(-a/(2*\sigma^2))</code> where <code class="reqn">a</code> is chosen as 1:
</p>
<p style="text-align: center;"><code class="reqn">\pi(\beta) ~ 1</code>
</p>

<p style="text-align: center;"><code class="reqn">\pi(v_i)~ 1/v_i</code>
</p>

<p style="text-align: center;"><code class="reqn">\sigma^2 ~ Inv-Gamma(p/2, a/2),  for a&gt;0</code>
</p>

<p style="text-align: center;"><code class="reqn">\pi(df) ~ df^{-1/2} (df+1)^{p/2 -1} (df+3)^{- p/2 - 1/2}   </code>
</p>

<p>The estimates of interest parameters are obtained by Rao-Balackwellization with Gibbs sampling with Metropolis-Hastings algorithm.
</p>


<h3>Value</h3>

<p>The function returns a object of class <code>"robustsae"</code> containing the following components:
</p>
<table>
<tr><td><code>mean</code></td>
<td>
<p> Rao-Balackwellization estimates of theta's</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p> Rao-Balackwellization estimates of v's</p>
</td></tr>
<tr><td><code>Criteria</code></td>
<td>
<p> a list containing the following comparison criteria : Returns NA if <code>truemean</code> is not provided. 
</p>

<ul>
<li><p><code>ASD</code>:  average squared deviation, defined as <code class="reqn">1/m \sum_{i=1}^{m} (\hat{\theta}_i - \theta_i)^2</code>
</p>
</li>
<li><p><code>AAB</code>:  average absolute bias, defined as <code class="reqn">1/m \sum_{i=1}^{m} |\hat{\theta}_i - \theta_i|</code>
</p>
</li>
<li><p><code>ASRB</code>:  average squared relative bias, defined as <code class="reqn">1/m \sum_{i=1}^{m} ((\hat{\theta}_i - \theta_i)/{\theta_i})^2</code>
</p>
</li>
<li><p><code>ARB</code>:  average relative bias, defined as <code class="reqn">1/m \sum_{i=1}^{m}
|(\hat{\theta}_i - \theta_i)/\theta_i|</code>
</p>
</li></ul>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Malay Ghosh, Jiyoun Myung, Fernando Moura
</p>


<h3>References</h3>

<p>Rao, J. N. K. (2003) <em> Small Area Estimation</em>. John Wiley and Sons.
</p>
<p>Chip, S., and Green berg, E. (1995). Understanding the Metropolis-Hastings Algorithm.
<em>The American Statistician</em>, <b>49</b>, 327-335.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># If there is truemean data,
# load data set
data(BZdata)
attach(BZdata)

result &lt;- robustsae(y ~ X1 + X2, S2, ni = BZdata$ni, nsim = 1000, burnin = 500, 
                      data = BZdata, truemean = truemean)
result

detach(BZdata)

# If there is no truemean data,
#load data set
data(corndata)
attach(corndata)

result2 &lt;- robustsae(Xi ~ Z1i, Si^2, ni=corndata$ni, data = corndata) # no truemean
result2$mean
result2$variance

detach(corndata)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
