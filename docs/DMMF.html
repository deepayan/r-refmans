<!DOCTYPE html><html><head><title>Help for package DMMF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DMMF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DMMF'><p>Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) soil erosion model</p></a></li>
<li><a href='#DMMF_Simple'><p>Simplified Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) soil erosion model for one element during a day</p></a></li>
<li><a href='#DMMF-package'>
<p>Daily Based Morgan&ndash;Morgan&ndash;Finney (DMMF) Soil Erosion Model</p></a></li>
<li><a href='#DMMFc'><p>Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) soil erosion model</p></a></li>
<li><a href='#MapChecker'><p>Map checker for raster layers</p></a></li>
<li><a href='#Potato.Concave'><p>Example data from the concave potato field from Arnhold et al. (2013)</p></a></li>
<li><a href='#Potato.Convex'><p>Example data from the convex potato field from Arnhold et al. (2013)</p></a></li>
<li><a href='#SinkFill'><p>Sinkfill algorithm based on Wang and Liu (2006)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Daily Based Morgan-Morgan-Finney (DMMF) Soil Erosion Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Kwanghun Choi [aut, cre],
  Sebastian Arnhold [dtc, ctb],
  Bjoern Reineking [ths, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kwanghun Choi &lt;kwanghun.choi@yahoo.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the daily based Morgan-Morgan-Finney (DMMF) soil erosion model (Choi et al., 2017 &lt;<a href="https://doi.org/10.3390%2Fw9040278">doi:10.3390/w9040278</a>&gt;) for estimating surface runoff and sediment budgets from a field or a catchment on a daily basis.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.3), raster, methods</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-25 21:32:17 UTC; kwanghun</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-26 04:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='DMMF'>Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) soil erosion model</h2><span id='topic+DMMF'></span>

<h3>Description</h3>

<p>Estimating surface runoff and sediment budget using the Daily based Morgan&ndash;Morgan&ndash;Finney soil erosion model using the algorithm from Choi et al. (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DMMF(DEM, R, RI, ET, P_c, P_z, P_s, theta_init, theta_sat, theta_fc, 
     SD, K, P_I, n_s, CC, GC, IMP, PH, D, NV, d_a = 0.005, 
     DK_c = 0.1, DK_z = 0.5, DK_s = 0.3, 
     DR_c = 1.0, DR_z = 1.6, DR_s = 1.5, 
     Breaking, Init_point, Sinks, R_Type = 0, slpMode = 2, ALL = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DMMF_+3A_dem">DEM</code></td>
<td>
<p>RasterLayer object of digital elevation model (DEM)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_r">R</code></td>
<td>
<p>Numeric vector or RasterBrick object of daily rainfall per unit area (unit: mm)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_ri">RI</code></td>
<td>
<p>Numeric vector or RasterBrick object of mean hourly rainfall intensity during a day (unit: mm/h)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_et">ET</code></td>
<td>
<p>Numeric vector or RasterBrick object of evapotranspiration per unit area (unit: mm)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_p_c">P_c</code></td>
<td>
<p>Numeric vector or RasterLayer object of proportion of clay particles in surface soil (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_p_z">P_z</code></td>
<td>
<p>Numeric vector or RasterLayer object of proportion of silt particles in surface soil (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_p_s">P_s</code></td>
<td>
<p>Numeric vector or RasterLayer object of proportion of sand particles in surface soil (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_theta_init">theta_init</code></td>
<td>
<p>Numeric vector or RasterBrick object of initial soil water content of entire soil profile per unit area (unit: vol/vol)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_theta_sat">theta_sat</code></td>
<td>
<p>Numeric vector or RasterLayer object of saturated soil water content of entire soil profile per unit area (unit: vol/vol)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_theta_fc">theta_fc</code></td>
<td>
<p>Numeric vector or RasterLayer object of soil water content at field capacity of entire soil profile per unit area (unit: vol/vol)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_sd">SD</code></td>
<td>
<p>Numeric vector or RasterLayer object of soil depth of entire soil profile (unit: m)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_k">K</code></td>
<td>
<p>Numeric vector or RasterLayer object of saturated lateral hydraulic conductivity of entire soil profile (unit: m/d)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_p_i">P_I</code></td>
<td>
<p>Numeric vector or Raster* object of proportion of permanent interception area of rainfall (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_n_s">n_s</code></td>
<td>
<p>Numeric vector or Raster* object of Manning's roughness coefficient of the soil surface (unit: <code class="reqn">\mathrm{s}/{\mathrm{m}^{1/3}}</code>)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_cc">CC</code></td>
<td>
<p>Numeric vector or Raster* object of proportion of area with canopy cover (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_gc">GC</code></td>
<td>
<p>Numeric vector or Raster* object of proportion of area with pervious vegetated ground cover (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_imp">IMP</code></td>
<td>
<p>Numeric vector or Raster* object of proportion of area with impervious ground cover (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_ph">PH</code></td>
<td>
<p>Numeric vector or Raster* object of average height of vegetation or crop cover where leaf drainage start to fall (unit: m)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_d">D</code></td>
<td>
<p>Numeric vector or Raster* object of average diameter of individual plant elements at the surface (unit: m)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_nv">NV</code></td>
<td>
<p>Numeric vector or Raster* object of number of individual plant elements per unit area (unit: <code class="reqn">\mathrm{number}/\mathrm{m^2}</code>)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_d_a">d_a</code></td>
<td>
<p>Numeric vector or Raster* object of typical flow depth of surface runoff (unit: m)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_dk_c">DK_c</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of clay particles by rainfall (unit: g/J)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_dk_z">DK_z</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of silt particles by rainfall (unit: g/J)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_dk_s">DK_s</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of sand particles by rainfall (unit: g/J)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_dr_c">DR_c</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of clay particles by surface runoff (unit: g/mm)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_dr_z">DR_z</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of silt particles by surface runoff (unit: g/mm)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_dr_s">DR_s</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of sand particles by surface runoff (unit: g/mm)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_breaking">Breaking</code></td>
<td>
<p>Numeric vector of starting points of each simulation period (0: during the period points, 1: breaking points), If <code>breaking</code> is missing, by default the first day is set to 1 and the other days are set to 0.</p>
</td></tr>
<tr><td><code id="DMMF_+3A_init_point">Init_point</code></td>
<td>
<p>Numeric vector of starting points of each rainfall event (0: during the period points, 1: breaking points), If <code>Init_point</code> is missing, <code>Init_point</code> is set to <code>Breaking</code> by default.</p>
</td></tr>
<tr><td><code id="DMMF_+3A_sinks">Sinks</code></td>
<td>
<p>RasterLayer object of sinks (e.g., streams, reservoirs, and lakes) of sediments and surface runoff (optional).</p>
</td></tr>
<tr><td><code id="DMMF_+3A_r_type">R_Type</code></td>
<td>
<p>Integer object of each rainfall type for estimating kinetic energy of direct throughfall (DT) (0-8) (see details)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_slpmode">slpMode</code></td>
<td>
<p>Integer object of slope calculation algorithm (2: second order, 3: third order)</p>
</td></tr>
<tr><td><code id="DMMF_+3A_all">ALL</code></td>
<td>
<p>Logical object of selection for the entire output results</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>R_Type</code> can be chosen among options appropriate for each regions according to Morgan (2001) and Morgan (2005). Default option adopts recent universal relationships between kinetic energy density and mean hourly rainfall intensity (<code>RI</code>) from Shin et al. (2016). Default option is recommended when users have measured <code>RI</code>. Detailed descriptions are described below.
</p>

<table>
<tr>
 <td style="text-align: center;">
        Option</td><td style="text-align: left;"> Region             </td><td style="text-align: left;"> Kinetic energy density of throughfall [<code class="reqn">\mathrm{J/m^{2}/mm}</code>] </td>
</tr>
<tr>
 <td style="text-align: center;">
        0     </td><td style="text-align: left;"> Universal (Default)</td><td style="text-align: left;"> <code class="reqn">10.3 \cdot \mathrm{RI}^{2/9}</code> </td>
</tr>
<tr>
 <td style="text-align: center;"> 
        1     </td><td style="text-align: left;"> North America      </td><td style="text-align: left;"> <code class="reqn">11.87 + 8.73 \cdot \log_{10}(\mathrm{RI})</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        2     </td><td style="text-align: left;"> North-west Europe  </td><td style="text-align: left;"> <code class="reqn">8.95 + 8.44 \cdot \log_{10}(\mathrm{RI})</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        3     </td><td style="text-align: left;"> Mediterranean      </td><td style="text-align: left;"> <code class="reqn">9.81 + 11.25 \cdot \log_{10}(\mathrm{RI})</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        4     </td><td style="text-align: left;"> West Mediterranean </td><td style="text-align: left;"> <code class="reqn">35.9 \cdot (1.0 - 0.56 \cdot \exp(-0.034 \cdot \mathrm{RI}))</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        5     </td><td style="text-align: left;"> Tropics            </td><td style="text-align: left;"> <code class="reqn">29.8 - ( 127.5 / \mathrm{RI} )</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        6     </td><td style="text-align: left;"> East Asia          </td><td style="text-align: left;"> <code class="reqn">9.81 + 10.60 \cdot \log_{10}( \mathrm{RI} )</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        7     </td><td style="text-align: left;"> Temperate Southern hemisphere </td><td style="text-align: left;"> <code class="reqn">29.0 \cdot ( 1.0 - 0.6 \cdot \exp( -0.04 \cdot \mathrm{RI} ) )</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        8    </td><td style="text-align: left;"> Universal          </td><td style="text-align: left;">  <code class="reqn">28.3 \cdot ( 1.0 - 0.52 \cdot \exp( -0.042 \cdot \mathrm{RI} ) )</code>
       </td>
</tr>

</table>

<p>Multi-flow direction algorithm (MD<code class="reqn">\infty</code>) from Seibert and McGlynn (2007) is built in the <code><a href="#topic+DMMF">DMMF</a></code> model. 
</p>


<h3>Value</h3>

<p>The output of the function <code>DMMF</code> is a list of RasterLayer or RasterBrick objects containing the following elements:<br />
</p>

<ul>
<li> <p><code>A</code>: Surface area size of each element considering slope (unit: <code class="reqn">\mathrm{m^2}</code>)
</p>
</li>
<li> <p><code>Rf</code>: The amount of effective rainfall reaching each element (unit: <code class="reqn">\mathrm{mm}</code>)
</p>
</li>
<li> <p><code>SW_c</code>: Surface water infiltration capacity of each element (unit: <code class="reqn">\mathrm{mm}</code>
</p>
</li>
<li> <p><code>theta_r</code>: Remaining soil water content of each element (unit: vol/vol)
</p>
</li>
<li> <p><code>TC</code>: Transport capacity of the runoff of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)
</p>
</li>
<li> <p><code>Q_in</code>: Volume of surface runoff flowing into each element (unit: L)
</p>
</li>
<li> <p><code>Q_out</code>: Volume of surface runoff flowing from each element (unit: L)
</p>
</li>
<li> <p><code>IF_in</code>: Volume of subsurface water flowing into each element (unit: L)
</p>
</li>
<li> <p><code>IF_out</code>: Volume of subsurface water flowing from each element (unit: L)
</p>
</li>
<li> <p><code>SS_c</code>: Area density of clay delivered to surface runoff in unit area of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)  
</p>
</li>
<li> <p><code>SS_z</code>: Area density of silt delivered to surface runoff in unit area of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)  
</p>
</li>
<li> <p><code>SS_s</code>: Area density of sand delivered to surface runoff of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)  
</p>
</li>
<li> <p><code>G_c</code>: Area density of available clay for transport by surface runoff of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)
</p>
</li>
<li> <p><code>G_z</code>: Area density of available silt for transport by surface runoff of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)
</p>
</li>
<li> <p><code>G_s</code>: Area density of available sand for transport by surface runoff of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)
</p>
</li>
<li> <p><code>SL_c_in</code>: Mass of clay inputs into each element (unit: kg)
</p>
</li>
<li> <p><code>SL_z_in</code>: Mass of silt inputs into each element (unit: kg)
</p>
</li>
<li> <p><code>SL_s_in</code>: Mass of sand inputs into each element (unit: kg) 
</p>
</li>
<li> <p><code>SL_in</code>: Mass of sum of total sediments inputs into each element (unit: kg)
</p>
</li>
<li> <p><code>SL_c_out</code>: Mass of clay outputs from each element (unit: kg)
</p>
</li>
<li> <p><code>SL_z_out</code>: Mass of silt outputs from each element (unit: kg)
</p>
</li>
<li> <p><code>SL_s_out</code>: Mass of sand outputs from each element (unit: kg) 
</p>
</li>
<li> <p><code>SL_out</code>: Mass of sum of total sediments outputs from each element (unit: kg)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kwanghun Choi and Bjoern Reineking
</p>


<h3>References</h3>

<p>Choi, K., Arnhold, S., Huwe, B., Reineking, B. (2017). 
Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) model: A spatially distributed conceptual soil erosion model to simulate complex soil surface configurations. <em>Water</em>, 9(4), 278. 
</p>
<p>Shin, S. S., Park, S. D., and Choi, B. K. (2016). 
Universal power law for relationship between rainfall kinetic energy and rainfall intensity. <em>Advances in Meteorology</em>, Article ID 2494681, 11 pages.
</p>
<p>Seibert, J., McGlynn, B. L. (2007). 
A new triangular multiple flow direction algorithm for computing upslope areas from gridded digital elevation models. <em>Water Resources Research</em>, 43(4):W04501.
</p>
<p>Morgan, R. P. C. (2005). 
Soil erosion and conservation. Blackwell Publishing, Malden, MA, 3rd ed. ISBN 1-4051-1781-8
</p>
<p>Morgan, R. P. C. (2001)
A simple approach to soil loss prediction: a revised Morgan&ndash;Morgan&ndash;Finney model. <em>Catena</em>, 44(4):305&ndash;322.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DMMF_Simple">DMMF_Simple</a></code> for one element during a day.
<code><a href="#topic+Potato.Convex">Potato.Convex</a></code> for the description of the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Load example data for test running DMMF model
data(Potato.Convex)
attach(Potato.Convex)
## Run DMMF function using Potato.Convex data
Result &lt;- DMMF(DEM = s.map$DEM, R = d.var$R, RI = d.var$RI, ET = d.var$ET, 
               P_c = s.var$P_c, P_z = s.var$P_z, P_s = s.var$P_s, 
               theta_init = d.map$theta_init, theta_sat = s.var$theta_sat, 
               theta_fc = s.var$theta_fc,
               SD = s.var$SD, K = s.var$K, P_I = s.var$P_I, n_s = s.map$n_s, 
               CC = d.var$CC, GC = s.var$GC, IMP = s.map$IMP, PH = d.var$PH, 
               D = s.var$D, NV = s.var$NV, d_a = s.var$d_a,
               DK_c = s.var$DK_c, DK_z = s.var$DK_z, DK_s = s.var$DK_s, 
               DR_c = s.var$DR_c, DR_z = s.var$DR_z, DR_s = s.var$DR_s, 
               Breaking = d.var$Breaking, Init_point = d.var$Init_point, 
               R_Type = 0, slpMode = 2, ALL = TRUE)
## Check results
## 1-a. Total volume of runoff generated from each element
plot(Result$Q_out)
## 1-b. Total volume of runoff per unit surface area generated from each element
plot(Result$Q_out/Result$A)

## 2-a. Total mass of eroded soil from each element
plot(Result$SL_out)
## 2-a. Total mass of eroded soil per unit surface area from each element
plot(Result$SL_out/Result$A)

## End(Not run)
</code></pre>

<hr>
<h2 id='DMMF_Simple'>Simplified Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) soil erosion model for one element during a day</h2><span id='topic+DMMF_Simple'></span>

<h3>Description</h3>

<p>This is the simplified version of <code><a href="#topic+DMMF">DMMF</a></code> for simple one element (cell) during a day
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DMMF_Simple( W, L = W/cos(S), S, R, RI, ET, 
            P_c, P_z, P_s, theta_init, theta_sat, theta_fc, 
            SD, K, P_I, n_s, CC, GC, IMP, PH, D, NV, d_a = 0.005, 
            DK_c = 0.1, DK_z = 0.5, DK_s = 0.3, DR_c = 1.0, DR_z = 1.6, DR_s = 1.5, 
            Q_in = 0, IF_in = 0, SL_c_in = 0, SL_z_in = 0, SL_s_in = 0, R_type = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DMMF_Simple_+3A_w">W</code></td>
<td>
<p>Width of an element (cell) (unit: m)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_l">L</code></td>
<td>
<p>Length of an element (cell) (unit: m). If <code>L</code> is not specified, the function assumes <code>L</code> as <code>W</code>/cos(<code>S</code>) (i.e., The function assumes a cell as a subset of DEM with slope angle of <code>S</code>).</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_s">S</code></td>
<td>
<p>Slope angle of an element (cell) (unit: rad)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_r">R</code></td>
<td>
<p>Daily rainfall per unit area (unit: mm)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_ri">RI</code></td>
<td>
<p>Mean hourly rainfall intensity during a day (unit: mm/h)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_et">ET</code></td>
<td>
<p>Evapotranspiration per unit area (unit: mm)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_p_c">P_c</code></td>
<td>
<p>Proportion of clay particles in surface soil (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_p_z">P_z</code></td>
<td>
<p>Proportion of silt particles in surface soil (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_p_s">P_s</code></td>
<td>
<p>Proportion of sand particles in surface soil (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_theta_init">theta_init</code></td>
<td>
<p>Initial soil water content of entire soil profile per unit area (unit: vol/vol)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_theta_sat">theta_sat</code></td>
<td>
<p>Saturated soil water content of entire soil profile per unit area (unit: vol/vol)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_theta_fc">theta_fc</code></td>
<td>
<p>Soil water content at field capacity of entire soil profile per unit area (unit: vol/vol)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_sd">SD</code></td>
<td>
<p>Soil depth of entire soil profile (unit: m)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_k">K</code></td>
<td>
<p>Saturated lateral hydraulic conductivity of entire soil profile (unit: m/d)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_p_i">P_I</code></td>
<td>
<p>Proportion of permanent interception area of rainfall (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_n_s">n_s</code></td>
<td>
<p>Manning's roughness coefficient of the soil surface (unit: <code class="reqn">\mathrm{s/m^{1/3}}</code>)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_cc">CC</code></td>
<td>
<p>Proportion of area with canopy cover (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_gc">GC</code></td>
<td>
<p>Proportion of area with pervious vegetated ground cover (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_imp">IMP</code></td>
<td>
<p>Proportion of area with impervious ground cover (0-1)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_ph">PH</code></td>
<td>
<p>Average height of vegetation or crop cover where leaf drainage start to fall (unit: m)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_d">D</code></td>
<td>
<p>Average diameter of individual plant elements at the surface (unit: m)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_nv">NV</code></td>
<td>
<p>A number of individual plant elements per unit area (unit: <code class="reqn">\mathrm{number/m^2}</code>)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_d_a">d_a</code></td>
<td>
<p>Typical flow depth of surface runoff (unit: m)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_dk_c">DK_c</code></td>
<td>
<p>Detachability of clay particles by rainfall (unit: g/J)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_dk_z">DK_z</code></td>
<td>
<p>Detachability of silt particles by rainfall (unit: g/J)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_dk_s">DK_s</code></td>
<td>
<p>Detachability of sand particles by rainfall (unit: g/J)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_dr_c">DR_c</code></td>
<td>
<p>Detachability of clay particles by surface runoff (unit: g/mm)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_dr_z">DR_z</code></td>
<td>
<p>Detachability of silt particles by surface runoff (unit: g/mm)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_dr_s">DR_s</code></td>
<td>
<p>Detachability of sand particles by surface runoff (unit: g/mm)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_q_in">Q_in</code></td>
<td>
<p>The volume of surface runoff from outside of an element (cell) (unit: L)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_if_in">IF_in</code></td>
<td>
<p>The volume of subsurface interflow from outside of an element (cell) (unit: L)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_sl_c_in">SL_c_in</code></td>
<td>
<p>The mass of clay particles from outside of an element (cell) (unit: kg)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_sl_z_in">SL_z_in</code></td>
<td>
<p>The mass of silt particles from outside of an element (cell) (unit: kg)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_sl_s_in">SL_s_in</code></td>
<td>
<p>The mass of sand particles from outside of an element (cell) (unit: kg)</p>
</td></tr>
<tr><td><code id="DMMF_Simple_+3A_r_type">R_type</code></td>
<td>
<p>Integer object of each rainfall type for estimating kinetic energy of direct throughfall (DT) (0-8) (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Detailed information about options of <code>R_type</code> can be found in details of <code><a href="#topic+DMMF">DMMF</a></code>.<br />
This function is suitable for projecting the DMMF model for a field represented in one element during a day. 
</p>


<h3>Value</h3>

<p>The output of the function <code>DMMF_Simple</code> is a data frame that contains following numeric elements:<br />
</p>

<ul>
<li> <p><code>Q_out</code>: Volume of surface runoff flowing from the element (unit: L)
</p>
</li>
<li> <p><code>IF_out</code>: Volume of subsurface water flowing from the element (unit: L)
</p>
</li>
<li> <p><code>theta_r</code>: Remaining soil water content of the element (unit: vol/vol) 
</p>
</li>
<li> <p><code>SL_c_out</code>: Mass of clay outputs from the element (unit: kg) 
</p>
</li>
<li> <p><code>SL_z_out</code>: Mass of silt outputs from the element (unit: kg)
</p>
</li>
<li> <p><code>SL_s_out</code>: Mass of sand outputs from the element (unit: kg)
</p>
</li>
<li> <p><code>A</code>: Surface area of the element (unit: <code class="reqn">\mathrm{m^2}</code>)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kwanghun Choi and Bjoern Reineking
</p>


<h3>References</h3>

<p>Choi, K., Arnhold, S., Huwe, B., Reineking, B. (2017). 
Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) model: A spatially distributed conceptual soil erosion model to simulate complex soil surface configurations. <em>Water</em>, 9(4), 278. 
</p>
<p>Shin, S. S., Park, S. D., and Choi, B. K. (2016). 
Universal power law for relationship between rainfall kinetic energy and rainfall intensity. <em>Advances in Meteorology</em>, Article ID 2494681, 11 pages.
</p>
<p>Arnhold, S., Ruidisch, M., Bartsch, S., Shope, C., Huwe, B. (2013). 
Simulation of runoff patterns and soil erosion on mountainous farmland with and without plastic-covered ridge-furrow cultivation in South Korea. <em>Transactions of the ASABE</em>, 56(2):667&ndash;679.
</p>
<p>Morgan, R. P. C. (2005). 
Soil erosion and conservation. Blackwell Publishing, Malden, MA, 3rd ed. ISBN 1-4051-1781-8
</p>
<p>Morgan, R. P. C. (2001)
A simple approach to soil loss prediction: a revised Morgan&ndash;Morgan&ndash;Finney model. <em>Catena</em>, 44(4):305&ndash;322.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DMMF">DMMF</a></code> for fields and catchments with more than one element.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Load example data for test running DMMF_Simple function
data(Potato.Convex)
attach(Potato.Convex)
## Make toy dataset using summary statistics of field datasets of "Potato.Convex" data.
## The width and slope of the field are set according to the slope length of the convex field 
## from Arnhold et al. (2013)
W = 25
L = 25 
## The slope of the field is set as the average slope angle of the field from Arnhold et al. (2013)
S &lt;- pi/180 * 9
## The proportion of impervious areas are estimated as the mean value of the IMP map.
IMP &lt;- cellStats(s.map$IMP, stat='mean', na.rm=TRUE)
## "n_s" estimated using the guide value of RFR using paraplough (10cm/m) 
## and conversion equation from RFR to Manning's n from Morgan and Duzant (2008).
n_s &lt;- 0.171  
## Using the ridge height of the field from Arnhold et al. (2013) 
## as the hydrological radius (flow depth) of the field.
d_a &lt;- 0.15
## We use dynamic variables of the 12th day that has enough rainfall to produce soil erosion.
d.var_12&lt;- d.var[12,]

## Run DMMF_Simple function
Output &lt;- DMMF_Simple( W = W, L = L, S = S, R = d.var_12$R, RI = d.var_12$RI, ET = d.var_12$ET, 
                      P_c = s.var$P_c, P_z = s.var$P_z, P_s = s.var$P_s, 
                      theta_init = s.var$theta_fc, theta_sat = s.var$theta_sat, 
                      theta_fc = s.var$theta_fc, SD = s.var$SD, K = s.var$K, P_I = s.var$P_I, 
                      n_s = n_s, CC = d.var_12$CC, GC = s.var$GC, IMP = IMP, PH = d.var_12$PH, 
                      D = s.var$D, NV = s.var$NV, d_a = d_a, 
                      DK_c = s.var$DK_c, DK_z = s.var$DK_z, DK_s = s.var$DK_s, 
                      DR_c = s.var$DR_c, DR_z = s.var$DR_z, DR_s = s.var$DR_s, 
                      Q_in = 0, IF_in = 0, SL_c_in = 0, SL_z_in = 0, SL_s_in = 0, R_type = 0)

## Print outputs.
Output
## Calculate per unit surface area
## Runoff per surface area of the field
Output$Q_out / Output$A 
## Interflow per surface area of the field
Output$IF_out / Output$A 
## Soil loss per surface area of the field
(Output$SL_c_out + Output$SL_z_out + Output$SL_s_out) / Output$A 

## End(Not run)
</code></pre>

<hr>
<h2 id='DMMF-package'>
Daily Based Morgan&ndash;Morgan&ndash;Finney (DMMF) Soil Erosion Model
</h2><span id='topic+DMMF-package'></span>

<h3>Description</h3>

<p>Implements the daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) soil erosion model for estimating surface runoff and sediments budgets from a field or a catchment on a daily basis.
</p>


<h3>Details</h3>

<p>This package is the implementation of the daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) soil erosion model to estimate surface runoff and sediment budget of a field and a catchment on a daily basis.
</p>
<p>The DMMF model is one of the variant of the widely used Morgan&ndash;Morgan&ndash;Finney soil erosion model and largely based on the modified MMF model with several modifications (see details in Choi et al. (2017)). 
</p>
<p>This <span class="rlang"><b>R</b></span> implementation of the DMMF model is suitable for estimating surface runoff and sediment budgets of fields or catchments represented by raster.
</p>
<p>The package provides the <code><a href="#topic+DMMF">DMMF</a></code> function that estimates surface runoff and soil erosion using DMMF model, <code><a href="#topic+DMMF_Simple">DMMF_Simple</a></code> function which is the simpler version of the <code><a href="#topic+DMMF">DMMF</a></code> and <code><a href="#topic+SinkFill">SinkFill</a></code> function that generates sink free map for the DMMF model based on the sink fill algorithm from Wang and Liu (2006) and the SAGA-GIS module of &ldquo;Module Fill Sinks (Wang &amp; Liu)&rdquo; by Volker Wichmann (2007).
</p>


<h3>Author(s)</h3>

<p>Kwanghun Choi, Sebastian Arnhold, Bjoern Reineking
</p>
<p>Maintainer: Kwanghun Choi (<a href="mailto:kwanghun.choi@yahoo.com">kwanghun.choi@yahoo.com</a>) 
</p>


<h3>References</h3>

<p>Choi, K., Arnhold, S., Huwe, B., Reineking, B. (2017). 
Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) model: A spatially distributed conceptual soil erosion model to simulate complex soil surface configurations. <em>Water</em>, 9(4), 278. 
</p>
<p>Shin, S. S., Park, S. D., and Choi, B. K. (2016). 
Universal power law for relationship between rainfall kinetic energy and rainfall intensity. <em>Advances in Meteorology</em>, Article ID 2494681, 11 pages.
</p>
<p>Arnhold, S., Ruidisch, M., Bartsch, S., Shope, C., Huwe, B. (2013). 
Simulation of runoff patterns and soil erosion on mountainous farmland with and without plastic-covered ridge-furrow cultivation in South Korea. <em>Transactions of the ASABE</em>, 56(2):667&ndash;679.
</p>
<p>Morgan, R. P. C. and Duzant, J. H. (2008). 
Modified MMF (Morgan&ndash;Morgan&ndash;Finney) model for evaluating effects of crops and vegetation cover on soil erosion. <em>Earth Surface Processes and Landforms</em>, 32(1):90&ndash;106.
</p>
<p>Seibert, J., McGlynn, B. L. (2007). 
A new triangular multiple flow direction algorithm for computing upslope areas from gridded digital elevation models. <em>Water Resources Research</em>, 43(4):W04501. W04501.
</p>
<p>Volker Wichmann (2007). 
Module Fill Sinks (Wang &amp; Liu). SAGA-GIS Module Library Documentation (v2.1.3) [ cited 2015. 08. 15 ], Available from: <a href="https://saga-gis.sourceforge.io/saga_tool_doc/2.1.3/ta_preprocessor_4.html">https://saga-gis.sourceforge.io/saga_tool_doc/2.1.3/ta_preprocessor_4.html</a>
</p>
<p>Wang, L. and Liu, H. (2006). 
An efficient method for identifying and filling surface depressions in digital elevation models for hydrologic analysis and modelling. <em>International Journal of Geographical Information Science</em>, 20(2):193&ndash;213.
</p>
<p>Morgan, R. P. C. (2001) 
A simple approach to soil loss prediction: a revised Morgan&ndash;Morgan&ndash;Finney model. <em>Catena</em>, 44(4):305&ndash;322.
</p>
<p>Morgan, R. P. C., Morgan, D. D. V., and Finney, H. J. (1984) 
A predictive model for the assessment of soil erosion risk. <em>Journal of Agricultural Engineering Research</em>, 30(0):245&ndash;253.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DMMF">DMMF</a></code> to run the DMMF model, 
<code><a href="#topic+DMMF_Simple">DMMF_Simple</a></code> to run the DMMF model for simple one element during a day,
<code><a href="#topic+SinkFill">SinkFill</a></code> to generate sink free map for the DMMF model
</p>

<hr>
<h2 id='DMMFc'>Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) soil erosion model</h2><span id='topic+DMMFc'></span>

<h3>Description</h3>

<p>Estimating surface runoff and sediment budget using the Daily based Morgan&ndash;Morgan&ndash;Finney soil erosion model using the algorithm from Choi et al. (2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DMMFc(DEM, R, RI, ET, P_c, P_z, P_s, theta_init, theta_sat, theta_fc, SD, K, 
      P_I, n_s, CC, GC, IMP, PH, D, NV, d_a, DK_c, DK_z, DK_s, DR_c, DR_z, DR_s, 
      SoilMap, LULCMap, Breaking, Init_point, Sinks, R_Type = 0, slpMode = 2, ALL = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DMMFc_+3A_dem">DEM</code></td>
<td>
<p>RasterLayer object of digital elevation model (DEM)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_r">R</code></td>
<td>
<p>Numeric vector or RasterBrick object of daily rainfall per unit area (unit: mm)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_ri">RI</code></td>
<td>
<p>Numeric vector or RasterBrick object of mean hourly rainfall intensity during a day (unit: mm/h)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_et">ET</code></td>
<td>
<p>Numeric vector or RasterBrick object of evapotranspiration per unit area (unit: mm)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_p_c">P_c</code></td>
<td>
<p>Numeric vector or RasterLayer object of proportion of clay particles in surface soil (0-1)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_p_z">P_z</code></td>
<td>
<p>Numeric vector or RasterLayer object of proportion of silt particles in surface soil (0-1)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_p_s">P_s</code></td>
<td>
<p>Numeric vector or RasterLayer object of proportion of sand particles in surface soil (0-1)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_theta_init">theta_init</code></td>
<td>
<p>Numeric vector or RasterBrick object of initial soil water content of entire soil profile per unit area (unit: vol/vol)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_theta_sat">theta_sat</code></td>
<td>
<p>Numeric vector or RasterLayer object of saturated soil water content of entire soil profile per unit area (unit: vol/vol)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_theta_fc">theta_fc</code></td>
<td>
<p>Numeric vector or RasterLayer object of soil water content at field capacity of entire soil profile per unit area (unit: vol/vol)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_sd">SD</code></td>
<td>
<p>Numeric vector or RasterLayer object of soil depth of entire soil profile (unit: m)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_k">K</code></td>
<td>
<p>Numeric vector or RasterLayer object of saturated lateral hydraulic conductivity of entire soil profile (unit: m/d)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_p_i">P_I</code></td>
<td>
<p>Numeric vector or Raster* object of proportion of permanent interception area of rainfall (0-1)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_n_s">n_s</code></td>
<td>
<p>Numeric vector or Raster* object of Manning's roughness coefficient of the soil surface (unit: <code class="reqn">\mathrm{s}/{\mathrm{m}^{1/3}}</code>)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_cc">CC</code></td>
<td>
<p>Numeric vector or Raster* object of proportion of area with canopy cover (0-1)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_gc">GC</code></td>
<td>
<p>Numeric vector or Raster* object of proportion of area with pervious vegetated ground cover (0-1)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_imp">IMP</code></td>
<td>
<p>Numeric vector or Raster* object of proportion of area with impervious ground cover (0-1)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_ph">PH</code></td>
<td>
<p>Numeric vector or Raster* object of average height of vegetation or crop cover where leaf drainage start to fall (unit: m)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_d">D</code></td>
<td>
<p>Numeric vector or Raster* object of average diameter of individual plant elements at the surface (unit: m)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_nv">NV</code></td>
<td>
<p>Numeric vector or Raster* object of number of individual plant elements per unit area (unit: <code class="reqn">\mathrm{number}/\mathrm{m^2}</code>)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_d_a">d_a</code></td>
<td>
<p>Numeric vector or Raster* object of typical flow depth of surface runoff (unit: m)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_dk_c">DK_c</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of clay particles by rainfall (unit: g/J)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_dk_z">DK_z</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of silt particles by rainfall (unit: g/J)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_dk_s">DK_s</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of sand particles by rainfall (unit: g/J)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_dr_c">DR_c</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of clay particles by surface runoff (unit: g/mm)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_dr_z">DR_z</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of silt particles by surface runoff (unit: g/mm)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_dr_s">DR_s</code></td>
<td>
<p>Numeric vector or RasterLayer object of detachability of sand particles by surface runoff (unit: g/mm)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_soilmap">SoilMap</code></td>
<td>
<p>Categorical raster map for soil characteristics</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_lulcmap">LULCMap</code></td>
<td>
<p>Categorical raster map for Land use and vegetation types</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_breaking">Breaking</code></td>
<td>
<p>Numeric vector of starting points of each simulation period (0: during the period points, 1: breaking points), If <code>breaking</code> is missing, by default the first day is set to 1 and the other days are set to 0.</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_init_point">Init_point</code></td>
<td>
<p>Numeric vector of starting points of each rainfall event (0: during the period points, 1: breaking points), If <code>Init_point</code> is missing, <code>Init_point</code> is set to <code>Breaking</code> by default.</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_sinks">Sinks</code></td>
<td>
<p>RasterLayer object of sinks (e.g., streams, reservoirs, and lakes) of sediments and surface runoff (optional).</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_r_type">R_Type</code></td>
<td>
<p>Integer object of each rainfall type for estimating kinetic energy of direct throughfall (DT) (0-8) (see details)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_slpmode">slpMode</code></td>
<td>
<p>Integer object of slope calculation algorithm (2: second order, 3: third order)</p>
</td></tr>
<tr><td><code id="DMMFc_+3A_all">ALL</code></td>
<td>
<p>Logical object of selection for the entire output results</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>R_Type</code> can be chosen among options appropriate for each regions according to Morgan (2001) and Morgan (2005). Default option adopts recent universal relationships between kinetic energy density and mean hourly rainfall intensity (<code>RI</code>) from Shin et al. (2016). Default option is recommended when users have measured <code>RI</code>. Detailed descriptions are described below.
</p>

<table>
<tr>
 <td style="text-align: center;">
        Option</td><td style="text-align: left;"> Region             </td><td style="text-align: left;"> Kinetic energy density of throughfall [<code class="reqn">\mathrm{J/m^{2}/mm}</code>] </td>
</tr>
<tr>
 <td style="text-align: center;">
        0     </td><td style="text-align: left;"> Universal (Default)</td><td style="text-align: left;"> <code class="reqn">10.3 \cdot \mathrm{RI}^{2/9}</code> </td>
</tr>
<tr>
 <td style="text-align: center;"> 
        1     </td><td style="text-align: left;"> North America      </td><td style="text-align: left;"> <code class="reqn">11.87 + 8.73 \cdot \log_{10}(\mathrm{RI})</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        2     </td><td style="text-align: left;"> North-west Europe  </td><td style="text-align: left;"> <code class="reqn">8.95 + 8.44 \cdot \log_{10}(\mathrm{RI})</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        3     </td><td style="text-align: left;"> Mediterranean      </td><td style="text-align: left;"> <code class="reqn">9.81 + 11.25 \cdot \log_{10}(\mathrm{RI})</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        4     </td><td style="text-align: left;"> West Mediterranean </td><td style="text-align: left;"> <code class="reqn">35.9 \cdot (1.0 - 0.56 \cdot \exp(-0.034 \cdot \mathrm{RI}))</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        5     </td><td style="text-align: left;"> Tropics            </td><td style="text-align: left;"> <code class="reqn">29.8 - ( 127.5 / \mathrm{RI} )</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        6     </td><td style="text-align: left;"> East Asia          </td><td style="text-align: left;"> <code class="reqn">9.81 + 10.60 \cdot \log_{10}( \mathrm{RI} )</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        7     </td><td style="text-align: left;"> Temperate Southern hemisphere </td><td style="text-align: left;"> <code class="reqn">29.0 \cdot ( 1.0 - 0.6 \cdot \exp( -0.04 \cdot \mathrm{RI} ) )</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
        8    </td><td style="text-align: left;"> Universal          </td><td style="text-align: left;">  <code class="reqn">28.3 \cdot ( 1.0 - 0.52 \cdot \exp( -0.042 \cdot \mathrm{RI} ) )</code>
       </td>
</tr>

</table>

<p>Multi-flow direction algorithm (MD<code class="reqn">\infty</code>) from Seibert and McGlynn (2007) is built in the <code><a href="#topic+DMMF">DMMF</a></code> model. 
</p>


<h3>Value</h3>

<p>The output of the function <code>DMMF</code> is a list of RasterLayer or RasterBrick objects containing the following elements:<br />
</p>

<ul>
<li> <p><code>A</code>: Surface area size of each element considering slope (unit: <code class="reqn">\mathrm{m^2}</code>)
</p>
</li>
<li> <p><code>Rf</code>: The amount of effective rainfall reaching each element (unit: <code class="reqn">\mathrm{mm}</code>)
</p>
</li>
<li> <p><code>SW_c</code>: Surface water infiltration capacity of each element (unit: <code class="reqn">\mathrm{mm}</code>
</p>
</li>
<li> <p><code>theta_r</code>: Remaining soil water content of each element (unit: vol/vol)
</p>
</li>
<li> <p><code>TC</code>: Transport capacity of the runoff of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)
</p>
</li>
<li> <p><code>Q_in</code>: Volume of surface runoff flowing into each element (unit: L)
</p>
</li>
<li> <p><code>Q_out</code>: Volume of surface runoff flowing from each element (unit: L)
</p>
</li>
<li> <p><code>IF_in</code>: Volume of subsurface water flowing into each element (unit: L)
</p>
</li>
<li> <p><code>IF_out</code>: Volume of subsurface water flowing from each element (unit: L)
</p>
</li>
<li> <p><code>SS_c</code>: Area density of clay delivered to surface runoff in unit area of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)  
</p>
</li>
<li> <p><code>SS_z</code>: Area density of silt delivered to surface runoff in unit area of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)  
</p>
</li>
<li> <p><code>SS_s</code>: Area density of sand delivered to surface runoff of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)  
</p>
</li>
<li> <p><code>G_c</code>: Area density of available clay for transport by surface runoff of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)
</p>
</li>
<li> <p><code>G_z</code>: Area density of available silt for transport by surface runoff of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)
</p>
</li>
<li> <p><code>G_s</code>: Area density of available sand for transport by surface runoff of each element (unit: <code class="reqn">\mathrm{kg/m^2}</code>)
</p>
</li>
<li> <p><code>SL_c_in</code>: Mass of clay inputs into each element (unit: kg)
</p>
</li>
<li> <p><code>SL_z_in</code>: Mass of silt inputs into each element (unit: kg)
</p>
</li>
<li> <p><code>SL_s_in</code>: Mass of sand inputs into each element (unit: kg) 
</p>
</li>
<li> <p><code>SL_in</code>: Mass of sum of total sediments inputs into each element (unit: kg)
</p>
</li>
<li> <p><code>SL_c_out</code>: Mass of clay outputs from each element (unit: kg)
</p>
</li>
<li> <p><code>SL_z_out</code>: Mass of silt outputs from each element (unit: kg)
</p>
</li>
<li> <p><code>SL_s_out</code>: Mass of sand outputs from each element (unit: kg) 
</p>
</li>
<li> <p><code>SL_out</code>: Mass of sum of total sediments outputs from each element (unit: kg)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kwanghun Choi and Bjoern Reineking
</p>


<h3>References</h3>

<p>Choi, K., Arnhold, S., Huwe, B., Reineking, B. (2017). 
Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) model: A spatially distributed conceptual soil erosion model to simulate complex soil surface configurations. <em>Water</em>, 9(4), 278. 
</p>
<p>Shin, S. S., Park, S. D., and Choi, B. K. (2016). 
Universal power law for relationship between rainfall kinetic energy and rainfall intensity. <em>Advances in Meteorology</em>, Article ID 2494681, 11 pages.
</p>
<p>Seibert, J., McGlynn, B. L. (2007). 
A new triangular multiple flow direction algorithm for computing upslope areas from gridded digital elevation models. <em>Water Resources Research</em>, 43(4):W04501.
</p>
<p>Morgan, R. P. C. (2005). 
Soil erosion and conservation. Blackwell Publishing, Malden, MA, 3rd ed. ISBN 1-4051-1781-8
</p>
<p>Morgan, R. P. C. (2001)
A simple approach to soil loss prediction: a revised Morgan&ndash;Morgan&ndash;Finney model. <em>Catena</em>, 44(4):305&ndash;322.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DMMF">DMMF</a></code> for general use of the algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Datasets for DMMFc will be uploaded.

## End(Not run)
</code></pre>

<hr>
<h2 id='MapChecker'>Map checker for raster layers</h2><span id='topic+MapChecker'></span>

<h3>Description</h3>

<p>Simple boundary, sink and stand checker for DEMs (Digital Elevation Models).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    MapChecker( DEM )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MapChecker_+3A_dem">DEM</code></td>
<td>
<p>RasterLayer object of digital elevation model (DEM) which needs sinkfill for DMMF model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simple boundary, sink and stand checker for DEMs (Digital Elevation Models).
The code defines a cell as a
</p>

<ul>
<li> <p><code>boundary</code>: when there are at least one NA values and at least one cell with valid value in adjacent cells.
</p>
</li>
<li> <p><code>sink</code>: when all adjacent cells of it are higher than the target cell. 
</p>
</li>
<li> <p><code>stand</code>: when all adjacent cells of it are higher than or equal to the target cell. 
</p>
</li></ul>



<h3>Value</h3>

<p>The output of the function <code>MapChecker</code> is a RasterLayer object of the <code>boundary</code>, <code>sink</code>, and <code>stand</code>.
</p>


<h3>Author(s)</h3>

<p>Kwanghun Choi
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Potato.Convex">Potato.Convex</a></code> for the description of the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Load example data for test running B_Checker function
data(Potato.Convex)
attach(Potato.Convex)
## Run B_Checker function with original DEM which has internal sinks.
DEM &lt;- s.map$DEM_original
MapCheck &lt;- MapChecker( DEM )
## Check maps
par(mfrow=c(2,2))
plot(DEM)
plot(MapCheck$boundary)
plot(MapCheck$sink)
plot(MapCheck$stand)

## End(Not run)
</code></pre>

<hr>
<h2 id='Potato.Concave'>Example data from the concave potato field from Arnhold et al. (2013)</h2><span id='topic+Potato.Concave'></span>

<h3>Description</h3>

<p>Example input data for running the <code><a href="#topic+DMMF">DMMF</a></code> function. This data is based on the field data from the concave potato field described in Arnhold et al. (2013) with optimized parameters described in Choi et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Potato.Concave)
</code></pre>


<h3>Value</h3>

<p><code>Potato.Concave</code> contains input data for the <code><a href="#topic+DMMF">DMMF</a></code> including map type and numeric type variables. Static variables are fixed and do not change with time (or period). Dynamic variables change with time (or period).<br />
<code>s.map</code>: Static input maps for the <code><a href="#topic+DMMF">DMMF</a></code> model.<br />
</p>

<ul>
<li> <p><code>DEM_original</code>: RasterLayer object of original digital elevation model (DEM) of the concave potato field before filling sinks.
</p>
</li>
<li> <p><code>DEM</code>: RasterLayer object of DEM after applying sinkfill algorithm.
</p>
</li>
<li> <p><code>IMP</code>: RasterLayer object of the proportion of area covered with impervious surface cover.
</p>
</li>
<li> <p><code>n_s</code>: RasterLayer object of the Manning's roughness coefficient of the soil surface.
</p>
</li></ul>

<p><code>d.map</code>: Dynamic input maps for the <code><a href="#topic+DMMF">DMMF</a></code> model.<br />
</p>

<ul>
<li> <p><code>theta_init</code>: RasterStack object of the initial soil water content of entire soil profile for each rainfall period.
</p>
</li></ul>

<p><code>s.var</code>: Static input numeric variables for the <code><a href="#topic+DMMF">DMMF</a></code> model.<br />
</p>

<ul>
<li> <p><code>P_c</code>: Numeric object of proportion of clay particles in surface area.
</p>
</li>
<li> <p><code>P_z</code>: Numeric object of proportion of silt particles in surface area.
</p>
</li>
<li> <p><code>P_s</code>: Numeric object of proportion of sand particles in surface area.
</p>
</li>
<li> <p><code>theta_sat</code>: Numeric object of saturated soil water content of entire soil profile. 
</p>
</li>
<li> <p><code>theta_fc</code>: Numeric object of soil water content at field capacity of entire soil profile. 
</p>
</li>
<li> <p><code>SD</code>: Numeric object of soil depth.
</p>
</li>
<li> <p><code>K</code>: Numeric object of saturated lateral hydraulic conductivity which is obtained from model calibration described in Choi et al. (2017).
</p>
</li>
<li> <p><code>P_I</code>: Numeric object of proportion of permanent interception area of rainfall.  
</p>
</li>
<li> <p><code>GC</code>: Numeric object of proportion of area with pervious vegetated ground cover.
</p>
</li>
<li> <p><code>D</code>: Numeric object of average diameter of individual plant elements at the surface.  
</p>
</li>
<li> <p><code>NV</code>: Numeric object of number of individual plant elements per unit area. 
</p>
</li>
<li> <p><code>d_a</code>: Numeric object of typical flow depth of surface runoff.
</p>
</li>
<li> <p><code>DK_c</code>: Numeric of detachability of clay particles by rainfall.
</p>
</li>
<li> <p><code>DK_z</code>: Numeric of detachability of silt particles by rainfall.
</p>
</li>
<li> <p><code>DK_s</code>: Numeric of detachability of sand particles by rainfall.
</p>
</li>
<li> <p><code>DR_c</code>: Numeric of detachability of clay particles by surface runoff.
</p>
</li>
<li> <p><code>DR_z</code>: Numeric of detachability of silt particles by surface runoff.
</p>
</li>
<li> <p><code>DR_s</code>: Numeric of detachability of sand particles by surface runoff.
</p>
</li></ul>

<p><code>d.var</code>: Dynamic input numeric variables for the <code><a href="#topic+DMMF">DMMF</a></code> model.<br />
</p>

<ul>
<li> <p><code>R</code>: Numeric vector object of daily rainfall per unit area.
</p>
</li>
<li> <p><code>RI</code>: Numeric vector object of mean hourly rainfall intensity during a day.
</p>
</li>
<li> <p><code>ET</code>: Numeric vector object of evapotranspiration per unit area.
</p>
</li>
<li> <p><code>CC</code>: Numeric vector object of proportion of area with canopy cover.
</p>
</li>
<li> <p><code>PH</code>: Numeric vector or object of average height of vegetation or crop cover where leaf drainage start to fall
</p>
</li>
<li> <p><code>Breaking</code>: Numeric vector of starting points of each simulation period.
</p>
</li>
<li> <p><code>Init_point</code>: Numeric vector of starting points of each rainfall event.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kwanghun Choi and Sebastian Arnhold
</p>


<h3>References</h3>

<p>Choi, K., Arnhold, S., Huwe, B., Reineking, B. (2017). 
Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) model: A spatially distributed conceptual soil erosion model to simulate complex soil surface configurations. <em>Water</em>, 9(4), 278. 
</p>
<p>Arnhold, S., Ruidisch, M., Bartsch, S., Shope, C., Huwe, B. (2013). 
Simulation of runoff patterns and soil erosion on mountainous farmland with and without plastic-covered ridge-furrow cultivation in South Korea. <em>Transactions of the ASABE</em>, 56(2):667&ndash;679.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DMMF">DMMF</a></code> for details of variables.
</p>

<hr>
<h2 id='Potato.Convex'>Example data from the convex potato field from Arnhold et al. (2013)</h2><span id='topic+Potato.Convex'></span>

<h3>Description</h3>

<p>Example input data for running the <code><a href="#topic+DMMF">DMMF</a></code> function. This data is based on the field data from the convex potato field described in Arnhold et al. (2013) with optimized parameters described in Choi et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Potato.Convex)
</code></pre>


<h3>Value</h3>

<p><code>Potato.Convex</code> contains input data for the <code><a href="#topic+DMMF">DMMF</a></code> including map type and numeric type variables. Static variables are fixed and do not change with time (or period). Dynamic variables change with time (or period).<br />
<code>s.map</code>: Static input maps for the <code><a href="#topic+DMMF">DMMF</a></code> model.<br />
</p>

<ul>
<li> <p><code>DEM_original</code>: RasterLayer object of original digital elevation model (DEM) of the convex potato field before filling sinks.
</p>
</li>
<li> <p><code>DEM</code>: RasterLayer object of DEM after applying sinkfill algorithm.
</p>
</li>
<li> <p><code>IMP</code>: RasterLayer object of the proportion of area covered with impervious surface cover.
</p>
</li>
<li> <p><code>n_s</code>: RasterLayer object of the Manning's roughness coefficient of the soil surface.
</p>
</li></ul>

<p><code>d.map</code>: Dynamic input maps for the <code><a href="#topic+DMMF">DMMF</a></code> model.<br />
</p>

<ul>
<li> <p><code>theta_init</code>: RasterStack object of the initial soil water content of entire soil profile for each rainfall period.
</p>
</li></ul>

<p><code>s.var</code>: Static input numeric variables for the <code><a href="#topic+DMMF">DMMF</a></code> model.<br />
</p>

<ul>
<li> <p><code>P_c</code>: Numeric object of proportion of clay particles in surface area.
</p>
</li>
<li> <p><code>P_z</code>: Numeric object of proportion of silt particles in surface area.
</p>
</li>
<li> <p><code>P_s</code>: Numeric object of proportion of sand particles in surface area.
</p>
</li>
<li> <p><code>theta_sat</code>: Numeric object of saturated soil water content of entire soil profile. 
</p>
</li>
<li> <p><code>theta_fc</code>: Numeric object of soil water content at field capacity of entire soil profile. 
</p>
</li>
<li> <p><code>SD</code>: Numeric object of soil depth.
</p>
</li>
<li> <p><code>K</code>: Numeric object of saturated lateral hydraulic conductivity which is obtained from model calibration described in Choi et al. (2017).
</p>
</li>
<li> <p><code>P_I</code>: Numeric object of proportion of permanent interception area of rainfall.  
</p>
</li>
<li> <p><code>GC</code>: Numeric object of proportion of area with pervious vegetated ground cover.
</p>
</li>
<li> <p><code>D</code>: Numeric object of average diameter of individual plant elements at the surface.  
</p>
</li>
<li> <p><code>NV</code>: Numeric object of number of individual plant elements per unit area. 
</p>
</li>
<li> <p><code>d_a</code>: Numeric object of typical flow depth of surface runoff.
</p>
</li>
<li> <p><code>DK_c</code>: Numeric of detachability of clay particles by rainfall.
</p>
</li>
<li> <p><code>DK_z</code>: Numeric of detachability of silt particles by rainfall.
</p>
</li>
<li> <p><code>DK_s</code>: Numeric of detachability of sand particles by rainfall.
</p>
</li>
<li> <p><code>DR_c</code>: Numeric of detachability of clay particles by surface runoff.
</p>
</li>
<li> <p><code>DR_z</code>: Numeric of detachability of silt particles by surface runoff.
</p>
</li>
<li> <p><code>DR_s</code>: Numeric of detachability of sand particles by surface runoff.
</p>
</li></ul>

<p><code>d.var</code>: Dynamic input numeric variables for the <code><a href="#topic+DMMF">DMMF</a></code> model.<br />
</p>

<ul>
<li> <p><code>R</code>: Numeric vector object of daily rainfall per unit area.
</p>
</li>
<li> <p><code>RI</code>: Numeric vector object of mean hourly rainfall intensity during a day.
</p>
</li>
<li> <p><code>ET</code>: Numeric vector object of evapotranspiration per unit area.
</p>
</li>
<li> <p><code>CC</code>: Numeric vector object of proportion of area with canopy cover.
</p>
</li>
<li> <p><code>PH</code>: Numeric vector or object of average height of vegetation or crop cover where leaf drainage start to fall
</p>
</li>
<li> <p><code>Breaking</code>: Numeric vector of starting points of each simulation period.
</p>
</li>
<li> <p><code>Init_point</code>: Numeric vector of starting points of each rainfall event.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Kwanghun Choi and Sebastian Arnhold
</p>


<h3>References</h3>

<p>Choi, K., Arnhold, S., Huwe, B., Reineking, B. (2017). 
Daily based Morgan&ndash;Morgan&ndash;Finney (DMMF) model: A spatially distributed conceptual soil erosion model to simulate complex soil surface configurations. <em>Water</em>, 9(4), 278. 
</p>
<p>Arnhold, S., Ruidisch, M., Bartsch, S., Shope, C., Huwe, B. (2013). 
Simulation of runoff patterns and soil erosion on mountainous farmland with and without plastic-covered ridge-furrow cultivation in South Korea. <em>Transactions of the ASABE</em>, 56(2):667&ndash;679.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DMMF">DMMF</a></code> for details of variables.
</p>

<hr>
<h2 id='SinkFill'>Sinkfill algorithm based on Wang and Liu (2006)</h2><span id='topic+SinkFill'></span>

<h3>Description</h3>

<p>Implementation of sinkfill algorithm based on Wang and Liu (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    SinkFill( DEM, Boundary, min_angle = 0.00001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SinkFill_+3A_dem">DEM</code></td>
<td>
<p>RasterLayer object of digital elevation model (DEM) which needs sinkfill for DMMF model</p>
</td></tr>
<tr><td><code id="SinkFill_+3A_boundary">Boundary</code></td>
<td>
<p>RasterLayer object for setting the locations of local sinks in the DEM, if <code>Boundary</code> is missing, every boundary cells of the map are set as potential sinks of the map.</p>
</td></tr>
<tr><td><code id="SinkFill_+3A_min_angle">min_angle</code></td>
<td>
<p>Numeric object of angle to make slope between cells (unit: rad)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is the implementation of sink-fill algorithm from Wang and Liu (2006), which is already implemented as a SAGA-GIS module (see Wichmann (2007)).<br />
The function <code>SinkFill</code> is modified from the original algorithm with including the option to set the initial boundary manually (e.g., global sink of the field).  
</p>


<h3>Value</h3>

<p>If <code>Boundary</code> is missing, function automatically identifies internal and external boundary of the input DEM which is in contact with cells having NaN value. 
The output of the function <code>SinkFill</code> is a list of RasterLayer objects of the sinkfilled DEM (<code>$nosink</code>) and partitions (<code>$partition</code>) of the area for the <code><a href="#topic+DMMF">DMMF</a></code> model.
</p>


<h3>Author(s)</h3>

<p>Kwanghun Choi
</p>


<h3>References</h3>

<p>Volker Wichmann (2007). 
Module Fill Sinks (Wang &amp; Liu). SAGA-GIS Module Library Documentation (v2.1.3) [ cited 2015. 08. 15 ], Available from: <a href="https://saga-gis.sourceforge.io/saga_tool_doc/2.1.3/ta_preprocessor_4.html">https://saga-gis.sourceforge.io/saga_tool_doc/2.1.3/ta_preprocessor_4.html</a>
</p>
<p>Wang, L. and Liu, H. (2006). 
An efficient method for identifying and filling surface depressions in digital elevation models for hydrologic analysis and modelling. <em>International Journal of Geographical Information Science</em>, 20(2):193&ndash;213.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Potato.Convex">Potato.Convex</a></code> for the description of the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Load example data for test running SinkFill function
data(Potato.Convex)
attach(Potato.Convex)
## Run SinkFill function with original DEM which has internal sinks.
DEM_with_sink &lt;- s.map$DEM_original
DEM_sinkfilled &lt;- SinkFill( DEM_with_sink )
DEM_nosink &lt;- DEM_sinkfilled$nosink
partitions &lt;- DEM_sinkfilled$partition
## Check maps
par(mfrow=c(2,2))
plot(DEM_with_sink)
plot(DEM_nosink)
plot(DEM_with_sink - DEM_nosink)
plot(partitions)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
