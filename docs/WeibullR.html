<!DOCTYPE html><html lang="en"><head><title>Help for package WeibullR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {WeibullR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#WeibullR-package'>
<p>Weibull-R : Weibull Analysis on R</p></a></li>
<li><a href='#AbPval'><p>Determination of the percentile of r and r-squared, by correlation.  Here designated &quot;Abernethy's P-value&quot;</p></a></li>
<li><a href='#BBB'><p>Beta Binomial Bounds</p></a></li>
<li><a href='#contour.wblr'>
<p>S3 Likelihood Ratio Contour Maps From <code>wblr</code> Objects</p></a></li>
<li><a href='#FMbounds'><p>Fisher Matrix bounds</p></a></li>
<li><a href='#getCCC2'><p>Determination of the square of the &quot;Critical Correlation Coefficient&quot; (CCC2).</p></a></li>
<li><a href='#getPercentilePlottingPositions'><p> Determination of percentile plotting positions for linear regression with many optional methods</p></a></li>
<li><a href='#getPPP'><p>Alias for <code>getPercentilePlottingPositions</code>, sets data into the format required by lslr.</p></a></li>
<li><a href='#hrbu'><p>Hirose and Ross beta unbias factors for Weibull MLE</p></a></li>
<li><a href='#LLln'><p>Log Likelihood for log-normal fitted data, failures and suspensions only</p></a></li>
<li><a href='#LLw'><p>Log Likelihood for weibull fitted data, failures and suspensions only</p></a></li>
<li><a href='#LRbounds'><p>Likelihood Ratio bounds</p></a></li>
<li><a href='#lslr'><p>Least squares linear regression with many optional methods</p></a></li>
<li><a href='#MLEcontour'><p>Likelihood Ratio Contour for Weibull and Lognormal Fitted Data</p></a></li>
<li><a href='#mlefit'><p>Maximum likelihood regression on Weibull and Lognormal distributions</p></a></li>
<li><a href='#mleframe'><p>Set life(time) data into the format required by mlefit</p></a></li>
<li><a href='#MLEln2p'><p>Quick Fit, Maximum Likelihood Estimate for 2-parameter lognormal distributions</p></a></li>
<li><a href='#MLEln3p'><p>Quick Fit, Maximum Likelihood Estimate for 3-parameter lognormal distributions</p></a></li>
<li><a href='#MLEw2p'><p>Quick Fit, Maximum Likelihood Estimate for 2-parameter weibull distributions</p></a></li>
<li><a href='#MLEw3p'><p>Quick Fit, Maximum Likelihood Estimation for weibull distribution in 3-parameters</p></a></li>
<li><a href='#MRRln2p'><p>Quick Fit, Median rank regression for 2-parameter log-normal distributions</p></a></li>
<li><a href='#MRRln3p'><p>Quick Fit, Median rank regression for log-normal distribution with third parameter optimization</p></a></li>
<li><a href='#MRRw2p'><p>Quick Fit, Median rank regression for 2-parameter weibull distributions</p></a></li>
<li><a href='#MRRw3p'><p>Quick Fit, Median rank regression for weibull distribution in 3-parameters</p></a></li>
<li><a href='#options.wblr'>
<p>Options list for <code>wblr</code> Objects</p></a></li>
<li><a href='#p2y'><p>Transform Probability Value to the Y-Axis of a <code>"plot.wblr"</code> Canvas</p></a></li>
<li><a href='#pivotal.rr'><p>Pivotal 'Monte Carlo' re-sampling of least squares linear regression models</p></a></li>
<li><a href='#plot_contour'>
<p>Plotting of Likelihood Ratio Contours from <code>wblr</code> Objects</p></a></li>
<li><a href='#plot.wblr'>
<p>S3 <code>wblr</code> Object Plotting on pretty canvax</p></a></li>
<li><a href='#rba'><p>Reduced Bias Adjustment for Weibull and Lognormal MLE</p></a></li>
<li><a href='#wblr'>
<p>Create a <code>wblr</code> Object for Life Data Analysis</p></a></li>
<li><a href='#wblr.conf'><p>Add Confidence Interval Bounds to <code>wblr</code> Objects</p></a></li>
<li><a href='#wblr.fit'>
<p>Add Fit Distributions to <code>wblr</code> Objects</p></a></li>
<li><a href='#wblrLoglike'><p>Log likelihood for Weibull and Lognormal fitted data including intervals</p></a></li>
<li><a href='#weibayes'>
<p>Fitting for Minimal Failure Datasets</p></a></li>
<li><a href='#weibayes.mle'>
<p>Fitting for Minimal Failure Datasets using likelihood optimization</p></a></li>
<li><a href='#xbounds'>
<p>Extract a bounds dataframe from a <code>wblr</code> Object</p></a></li>
<li><a href='#xfit'>
<p>Extract a Fit Summary from a <code>wblr</code> Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-6-24</td>
</tr>
<tr>
<td>Title:</td>
<td>Weibull Analysis for Reliability Engineering</td>
</tr>
<tr>
<td>Description:</td>
<td>Life data analysis in the graphical tradition of Waloddi Weibull. Methods derived from Robert B. Abernethy (2008, ISBN 0-965306-3-2), Wayne Nelson (1982, ISBN: 9780471094586), William Q. Meeker and  Lois A. Escobar (1998, ISBN: 1-471-14328-6), John I. McCool, (2012, ISBN: 9781118217986).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>copyright (c) OpenReliability.org 2011-2019</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.openreliability.org/weibull-r-weibull-analysis-on-r/">http://www.openreliability.org/weibull-r-weibull-analysis-on-r/</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp (&ge; 0.11.1)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Author:</td>
<td>David Silkworth [aut],
  Jurgen Symynck [aut],
  Jacob Ormerod [cre],
  OpenReliability.org [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jacob Ormerod &lt;jake@openreliability.org&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-25 16:52:08 UTC; djsil</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-25 18:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='WeibullR-package'>
Weibull-R : Weibull Analysis on R
</h2><span id='topic+WeibullR-package'></span>

<h3>Description</h3>

<p>Life data analysis in the graphical tradition of Waloddi Weibull
</p>


<h3>Details</h3>

<p>The WeibullR package provides a flexible data entry capability with three levels of usage.
</p>

<dl>
<dt><em>Quick Fit</em> Functions</dt><dd><p>Functions with intuitive names <code><a href="#topic+MLEw2p">MLEw2p</a></code> through <code><a href="#topic+MRRln3p">MRRln3p</a></code> for preparing simple fits, bounds, and displays using default options. Only data sets with exact failure times and/or suspensions are processed.
The quick fit functions return a simple named vector of the fitted parameters with appropriate goodness of fit measure(s).
Optional preparation of appropriate interval bounds (at 90% confidence), or a display of fit and bounds are controlled by two final arguments taking logical entry,
Such that  a function call like <code>MLEw2p(input_data, T, T)</code> will generate a plot with the fitted data and confidence interval bounds.
When the first logical for bounds is set to TRUE, the returned object will be a list with the fitted parameter vector first and dataframe of bounds values second.
</p>
</dd>
<dt>wblr Object Model</dt><dd><p>Construction of a wblr object is initiated by providing a data set through function <code><a href="#topic+wblr">wblr</a></code>.
Modification of the object with the progressive addition of fits and confidence interval bounds is made via functions <code><a href="#topic+wblr.fit">wblr.fit</a></code> and <code><a href="#topic+wblr.conf">wblr.conf</a></code>. 
Fine control over many aspects of fit, confidence, and display are made possible using a flexible options mechanism.
Display for single object models is via S3 methods <code>plot</code> or <code>contour</code>, while multiple objects <em>(provided as a list)</em> can be displayed on a single plot using <code><a href="#topic+plot.wblr">plot.wblr</a></code>, <code><a href="#topic+plot_contour">plot_contour</a></code>, or <code><a href="#topic+contour.wblr">contour.wblr</a></code>.
</p>
</dd>
<dt>Backend Functions</dt><dd><p>Access to backend functions providing all the functionality of the upper levels of usage are provided as exported functions.
These functions may provide advanced users with resources to expand analysis further than has been implemented in the WeibullR package.
</p>
</dd>
</dl>

<p>Data entry is made through the Quick Fit functions, <code><a href="#topic+wblr">wblr</a></code>, or on the backend through <code><a href="#topic+getPPP">getPPP</a></code> for rank regression, <code><a href="#topic+mleframe">mleframe</a></code> for mle processing.
In all cases the primary argument <code>x</code> can be a vector of exact time failures or a dataframe with <code>time</code>, and <code>event</code> columns as a minimum. An additional column <code>qty</code> may optionally be used to record duplicated data.
If the dataframe entry is not used (in favor of an exact time failure vector), a second argument, <code>s</code>, can be used to enter a vector of last observed success times for right censored data (suspensions).<br />
Beyond the entry of the first two data types, interval data (including discoveries with last known success time=0) are entered via argument <code>interval</code> as a dataframe with columns <code>left</code>, and <code>right</code> as a minimum.
As with the primary argument dataframe entry, an additional column <code>qty</code> may optionally be used to record duplicated interval data.
Such interval data entry is not supported with the Quick Fit functions.
</p>


<h3>Author(s)</h3>

<p>David J. Silkworth &lt;djsilk@openreliability.org&gt;
Jurgen Symynck &lt;email withheld&gt;
</p>

<hr>
<h2 id='AbPval'>Determination of the percentile of r and r-squared, by correlation.  Here designated &quot;Abernethy's P-value&quot;</h2><span id='topic+AbPval'></span>

<h3>Description</h3>

<p>The percentile of r and r-squared (prr) generated by pivotal Monte Carlo analysis has been promoted as a goodness of fit measure by Robert B. Abernethy. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AbPval(F,R2,model="weibull")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AbPval_+3A_f">F</code></td>
<td>
<p>The quantity of complete failure data points under consideration.</p>
</td></tr>
<tr><td><code id="AbPval_+3A_r2">R2</code></td>
<td>
<p>The square of the correlation coefficient derived from residuals of the linear model.</p>
</td></tr>
<tr><td><code id="AbPval_+3A_model">model</code></td>
<td>
<p>A string defining the distribution under consideration. Only entry of &quot;lnorm&quot;, or &quot;lognormal&quot; will alter the default of &quot;weibull&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value returned is derived from a correlation developed from previously run pivotal analysis with 10^8 random samples.  Only the prr derived from 2 parameter models is judged to have usefullness in comparitive analysis. For validity of a 3rd parameter optimization on a given model over its 2 parameter fit, only the Likelihood Ratio Test should be considered.  
</p>


<h3>Value</h3>

<p>Returns a vector containing the  P-value and the square of CCC (for comparison with R squared).
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
</p>
<p>Wes Fulton, (2005) &quot;Improved Goodness of Fit: P-value of the Correlation Coefficient&quot;
</p>
<p>Chi-Chao Lui, (1997) &quot;A Comparison Between The Weibull And Lognormal Models Used To Analyse Reliability Data&quot;
(dissertation from University of Nottingham)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>AbernethyPvalue&lt;-AbPval(50, 0.996, "lnorm")
</code></pre>

<hr>
<h2 id='BBB'>Beta Binomial Bounds</h2><span id='topic+BBB'></span>

<h3>Description</h3>

<p>Generates confidence inference bounds by means of the beta binomial distribution applied to data ranks.</p>


<h3>Usage</h3>

<pre><code class='language-R'>BBB(xdata, xfit,n=NULL, CI=.90, unrel=NULL, type="horizontal", nknots=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BBB_+3A_xdata">xdata</code></td>
<td>
<p>A list containing either dpoints and/or dlines such as available from a wblr object.
</p>
</td></tr>
<tr><td><code id="BBB_+3A_xfit">xfit</code></td>
<td>
<p>A list containing dist and fit elements. A suitable object can be extracted from a wblr object containing the resuult of at least one modifying wblr.fit call.
Function <code>xfit</code> has been provided to return such a list.
</p>
</td></tr>
<tr><td><code id="BBB_+3A_n">n</code></td>
<td>
<p>The total number of data entries fail, suspension, discovery and interval. This value is only required to be provided
if not available from either xdata (as sum(xdata$lrq_frame$qty) or xfit (as attr(xfit$fit)$n), however, an entry
for this argument will take precidence over the other argument sources.
</p>
</td></tr>  
<tr><td><code id="BBB_+3A_ci">CI</code></td>
<td>
<p>A scalar for the double-sided confidence interval of interest. Default = 0.9, for 90
</p>
</td></tr>
<tr><td><code id="BBB_+3A_unrel">unrel</code></td>
<td>
<p>An optional vector of unreliability values to be used as the descriptive percentiles at which the bound quantiles will be calculated.
</p>
</td></tr>
<tr><td><code id="BBB_+3A_type">type</code></td>
<td>
<p>A string indicating the adjustment direction(s) for application of the beta binomial. Since both &quot;horizontal&quot; and &quot;vertical&quot; directions
on the rank positions of failure data are considered valid, a smoothed spline can be created by appling both directions using &quot;valid&quot;.
An extrapolation of the smoothed spline is provided by using &quot;extrapolated&quot;.
</p>
</td></tr>
<tr><td><code id="BBB_+3A_nknots">nknots</code></td>
<td>
<p>An optional number of knots to be used to form the smooth spline in the event that disjoints are formed
at the junction of horizontal and vertical bounds. Usually, applying 75 to 80
result in a pleasing smoothness.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This non-parametric approach calculates confidence bounds for quantiles and/or
failure probabilities applying the CFD of the beta distribution at ranks and reverse ranks of the failure data including intervals.
Although a result is provided for 3-parameter models, it does not reflect uncertainty in the third, translation parameter.
</p>


<h3>Value</h3>

<p>Returns a dataframe holding values of Prob, Lower, Fit, and Upper values for the bounds.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>
<p>Tim-Gunnar Hensel, (2017) &quot;weibulltools&quot;, A package on CRAN.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(4321)
obj&lt;-wblr.fit(wblr(rweibull(10,1,1)))
beta_binomial_bounds&lt;-BBB(obj$data,xfit(obj))
</code></pre>

<hr>
<h2 id='contour.wblr'>
S3 Likelihood Ratio Contour Maps From <code>wblr</code> Objects
</h2><span id='topic+contour.wblr'></span>

<h3>Description</h3>

<p>This function adds the <code>.wblr</code> method to <code><a href="graphics.html#topic+contour">contour</a></code>
from the <span class="pkg">graphics</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wblr'
contour(x, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contour.wblr_+3A_x">x</code></td>
<td>

<p>Object of class <code>"wblr"</code> or a list of <code>wblr</code> objects.
</p>
</td></tr>
<tr><td><code id="contour.wblr_+3A_...">...</code></td>
<td>

<p>Entry for a limited set of graphic parameters (col, lty, lwd, xlim, ylim, main and sub)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides S3 object functionality for plotting a likelihood ratio contour map for
any single wblr object with just the contour function.
</p>
<p>Contour parameters are drawn from a contour existing in the object(s) passed in, or 
from the base object (sometimes just defaults) if no contour exists in the object.
</p>
<p>In order to plot contour maps from multiple objects onto a single canvas
it is necessary to call contour.wblr specifically with a list of wblr objects as primary argument.
</p>
<p>Unlike the <code><a href="graphics.html#topic+contour">contour</a></code> this map is not prepared from a matrix of z-values.
Rather the specific x,y points for each CL level (Z-value) are provided for plotting lines
connecting the points.
</p>


<h3>Value</h3>

<p>The contour.wblr function itself returns no value, however, the full output of contour points and
parameters from the internally called WeibullR::plot_contour function is displayed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
da2 &lt;- wblr.conf(wblr.fit(wblr(runif(5,100,1000),col="red")))
da3 &lt;- wblr.conf(wblr.fit(wblr(rweibull(5,3,1000),col="green4")))

## Not run: 
contour.wblr(list(da2,da3))

## End(Not run)
</code></pre>

<hr>
<h2 id='FMbounds'>Fisher Matrix bounds</h2><span id='topic+FMbounds'></span>

<h3>Description</h3>

<p>Generates the asymptotic bounds by means of the information matrix.</p>


<h3>Usage</h3>

<pre><code class='language-R'>FMbounds(x, dist="weibull", CI=.90, unrel=NULL, debias="none", show=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FMbounds_+3A_x">x</code></td>
<td>
<p>A dataframe such as generated by mleframe with column names 'left', 'right' and optionally 'qty'.
Exact failure data (occurrences) have same time entered in both 'left' and 'right' columns.
Suspension data has last known life[time] entered in 'left' column and -1 entered in 'right' column.
The left(early) interval bound for left-censored data must be entered as zero. (NA is not accepted).
</p>
</td></tr>
<tr><td><code id="FMbounds_+3A_dist">dist</code></td>
<td>
<p>A string defining a distribution to be fit. Implemented distributions are &quot;weibull&quot; (default) and &quot;lognormal&quot;.
(Only 2-parameter models are accepted.)
</p>
</td></tr>
<tr><td><code id="FMbounds_+3A_ci">CI</code></td>
<td>
<p>A scalar for the double-sided confidence interval of interest. Default = 0.9, for 90
</p>
</td></tr>
<tr><td><code id="FMbounds_+3A_unrel">unrel</code></td>
<td>
<p>An optional vector of unreliability values to be used as the descriptive quantiles at which the bounds will be calculated.
</p>
</td></tr>
<tr><td><code id="FMbounds_+3A_debias">debias</code></td>
<td>
<p>A string argument indicating the adjustment to be applied to the shape or standard deviation
parameter of the fitted data.
</p>
</td></tr>
<tr><td><code id="FMbounds_+3A_show">show</code></td>
<td>
<p>A logical determining whether a crude graphic of the bounds shall be displayed.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>An &quot;observed&quot; information matrix is derived numerically as the hessian by means of optimHess.  From the variance-covariance matrix (inverse of the hessian) variation of life(-time) at given quantiles is determined.
</p>
<p>Application of a bias adjustment alters the calculation of the hessian, thus the bounds are based on a &quot;modified&quot; Fisher Matrix.
</p>


<h3>Value</h3>

<p>Returns a dataframe holding values of percentiles, lower, datum, and upper values of the bound.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(4321)
data&lt;-rlnorm(30,2,1.2)
asymptotic_bounds&lt;-FMbounds(mleframe(data[7:30],data[1:6]), dist="lognormal")
</code></pre>

<hr>
<h2 id='getCCC2'>Determination of the square of the &quot;Critical Correlation Coefficient&quot; (CCC2).</h2><span id='topic+getCCC2'></span>

<h3>Description</h3>

<p>Abernethy has promoted the 10th percentile of Correlation Coefficients generated by pivotal Monte Carlo analysis as a critical measure by which a fit should be designated suitable for further analysis.  According to his practice, the difference between the square of the Correlation Coefficient and the CCC2 (R^2 - CCC^2) is used to make comparitive judgments between weibull and lognormal fitting on the same data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCCC2(F, model="weibull") 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCCC2_+3A_f">F</code></td>
<td>
<p>The quantity of complete failure data points under consideration.</p>
</td></tr>
<tr><td><code id="getCCC2_+3A_model">model</code></td>
<td>
<p>A string defining the distribution under consideration. Only a value of &quot;lnorm&quot; will be treated any differently from default of &quot;weibull&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value returned is derived from a correlation developed from previously run pivotal analysis with 10^8 random samples.  Project &quot;Abernethy Reliability Methods&quot; has judged that only the CCC^2 derived from 2 parameter models to have usefullness in such analysis.  This is seen from the &quot;Detect Power&quot; presentations in Appendix D of &quot;The New Weibull Handbook, Fifth Edition&quot;.  For validity of a 3rd parameter optimization on a given model over its 2 parameter fit, only the Likelihood Ratio Test will be applied.  This validity check requires an LRT-P greater than 50
</p>


<h3>Value</h3>

<p>Returns a single valued vector for the square of CCC (for comparison with R squared).
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
</p>
<p>Wes Fulton, (2005) &quot;Improved Goodness of Fit: P-value of the Correlation Coefficient&quot;
</p>
<p>Chi-Chao Lui, (1997) &quot;A Comparison Between The Weibull And Lognormal Models Used To Analyse Reliability Data&quot;
(dissertation from University of Nottingham)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>thisCCC2&lt;-getCCC2(50, "lnorm")
</code></pre>

<hr>
<h2 id='getPercentilePlottingPositions'> Determination of percentile plotting positions for linear regression with many optional methods</h2><span id='topic+getPercentilePlottingPositions'></span>

<h3>Description</h3>

<p>Determination of plotting positions to be used for linear regression of life data analysis is a highly debated topic.
This function implements a wide assortment of options for the Weibull-R project.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPercentilePlottingPositions(x, s=NULL, interval=NULL, ppos="beta",
 aranks="Johnson", ties="none") 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPercentilePlottingPositions_+3A_x">x</code></td>
<td>

<p>Either a dataframe containing at least <code>$time</code> and <code>$event</code>
columns and optionally a <code>$qty</code> column, or a vector of class <code>"numeric"</code> or <code>"integer"</code> with
(life-)time observations.
</p>
</td></tr>
<tr><td><code id="getPercentilePlottingPositions_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="getPercentilePlottingPositions_+3A_interval">interval</code></td>
<td>
<p>reserved argument for interval censored data - NOT YET IMPLEMENTED.</p>
</td></tr>  
<tr><td><code id="getPercentilePlottingPositions_+3A_ppos">ppos</code></td>
<td>
<p>A string defining a plotting position method.  Implemented options include &quot;beta&quot; the incomplete beta function (as default), &quot;Benard&quot;, &quot;mean&quot; also known as Herd-Johnson, &quot;Hazen&quot; or modified Kaplan-Meier, &quot;Kaplan-Meier&quot; with modification for final complete failure, and &quot;Blom.</p>
</td></tr>
<tr><td><code id="getPercentilePlottingPositions_+3A_aranks">aranks</code></td>
<td>
<p>A string defining the method for establishing adjusted ranks when suspension data (right censored) are present. Implemented options include &quot;Johnson&quot; (as default) and &quot;KMestimator&quot;</p>
</td></tr>
<tr><td><code id="getPercentilePlottingPositions_+3A_ties">ties</code></td>
<td>
<p>A string defining a method of eliminating ties, or duplicate time valued data, from plotting. Implemented options include &quot;highest&quot; (used as 'Inspection Option #1' by Abernethy), &quot;mean&quot;, &quot;lowest&quot;, and &quot;sequential&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with the failure data (as potentially reduced by ties argument), the probability plotting positions, and adjusted ranks.
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
</p>
<p>Leonard C. Johnson (1964) &quot;The Statistical Treatment of Fatigue Experiments&quot;  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
median_percentile_ranks&lt;-getPPP(failures,suspensions)[,2]
</code></pre>

<hr>
<h2 id='getPPP'>Alias for <code>getPercentilePlottingPositions</code>, sets data into the format required by lslr.</h2><span id='topic+getPPP'></span>

<h3>Description</h3>

<p>Determination of plotting positions to be used for linear regression of life data analysis is a highly debated topic.
This function implements a wide assortment of options for the Weibull-R project.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPPP(x, s=NULL, interval=NULL, ppos="beta", aranks="Johnson", ties="none")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPPP_+3A_x">x</code></td>
<td>

<p>Either a dataframe containing at least <code>$time</code> and <code>$event</code>
columns and optionally a <code>$qty</code> column, or a vector of class <code>"numeric"</code> or <code>"integer"</code> with
(life-)time observations.
</p>
</td></tr>
<tr><td><code id="getPPP_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="getPPP_+3A_interval">interval</code></td>
<td>
<p>reserved argument for interval censored data - NOT YET IMPLEMENTED.</p>
</td></tr>
<tr><td><code id="getPPP_+3A_ppos">ppos</code></td>
<td>
<p>A string defining a plotting position method.  Implemented options include &quot;beta&quot; the incomplete beta function (as default), &quot;Benard&quot;, &quot;mean&quot; also known as Herd-Johnson, &quot;Hazen&quot; or modified Kaplan-Meier, &quot;Kaplan-Meier&quot; with modification for final complete failure, and &quot;Blom.</p>
</td></tr>
<tr><td><code id="getPPP_+3A_aranks">aranks</code></td>
<td>
<p>A string defining the method for establishing adjusted ranks when suspension data (right censored) are present. Implemented options include &quot;Johnson&quot; (as default) and &quot;KMestimator&quot;</p>
</td></tr>
<tr><td><code id="getPPP_+3A_ties">ties</code></td>
<td>
<p>A string defining a method of eliminating ties, or duplicate time valued data, from plotting. Implemented options include &quot;highest&quot; (used as 'Inspection Option #1' by Abernethy), &quot;mean&quot;, &quot;lowest&quot;, and &quot;sequential&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with the failure data (as potentially reduced by ties argument), the probability plotting positions, and adjusted ranks.
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
Leonard C. Johnson (1964) &quot;The Statistical Treatment of Fatigue Experiments&quot;  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
median_percentile_ranks&lt;-getPPP(failures, suspensions)[,2]
</code></pre>

<hr>
<h2 id='hrbu'>Hirose and Ross beta unbias factors for Weibull MLE</h2><span id='topic+hrbu'></span>

<h3>Description</h3>

<p><code>hrbu</code> generates the reduction factor based on the mean bias of the weibull MLE beta parameter(roughly C4^6) for complete failure
samples, modestly increased correction as number of suspensions increases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> hrbu(Qx, Qs=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hrbu_+3A_qx">Qx</code></td>
<td>
<p>The quantity of actual failures</p>
</td></tr>
<tr><td><code id="hrbu_+3A_qs">Qs</code></td>
<td>
<p>An optional quantity of suspensions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This, as many references, discuss the bias reduction in terms of mean.
</p>


<h3>Value</h3>

<p>A factor to be multiplied to the MLE Beta account for known bias.
</p>


<h3>References</h3>

<p>Hirose, H. (1999) &quot;Bias Correction for the Maximum Likelihood Estimation in Two-parameter Weibull Distribution&quot; IEEE Transactions on Dielectrics and Electrical Insulation, Vol. 6, No.1
Ross, R. (1996) &quot;Bias and Standard Deviation Due to Weibull Parameter Estimation for Small Data Sets&quot; IEEE Transactions on Dielectrics and Electrical Insulation, Vol. 3, No.1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
MLEfit&lt;-mlefit(mleframe(failures,suspensions))
MLE_Unbiased&lt;-c(MLEfit[1],MLEfit[2]*hrbu(length(failures),length(suspensions)))
</code></pre>

<hr>
<h2 id='LLln'>Log Likelihood for log-normal fitted data, failures and suspensions only</h2><span id='topic+LLln'></span>

<h3>Description</h3>

<p>Determination of log-likelihood values for the basic distributions covered by R should be ubiquitous, but an implementation is provided here to enable likelihood ratio testing particularly for comparison of 3-parameter optimized models with their 2-parameter counterpart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LLln(x, s=NULL, Mulog, Sigmalog)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LLln_+3A_x">x</code></td>
<td>
<p>A vector of failure data.</p>
</td></tr>
<tr><td><code id="LLln_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="LLln_+3A_mulog">Mulog</code></td>
<td>
<p>The mean parameter from a log-normal fit.</p>
</td></tr>
<tr><td><code id="LLln_+3A_sigmalog">Sigmalog</code></td>
<td>
<p>The standard deviation parameter from a log-normal fit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function LLln can only handle datasets with failure and suspension data. For data including intervals <code>wblrLikelihood</code> can be used.
This function is somewhat unique among likelihood functions in that it will scan the suspension data for
removal of negative values. Such negative values are likely to be entered as data is provided
for a 3-parameter fit by explicitly providing the original data with vector subtraction by the optimized t0.
The primary intention for likelihood determination is to permit likelihood ratio testing for comparison
of 3-parameter optimized models with their 2-parameter counterpart.</p>


<h3>Value</h3>

<p>Returns a log-likelihood value.
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
</p>
<p>Marie Laure Delignette-Muller, Christophe Dutang (2015). &quot;fitdistrplus: An R Package for Fitting Distributions&quot;.
Journal of Statistical Software, 64(4), 1-34. URL http://www.jstatsoft.org/v64/i04/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
fit&lt;-lslr(getPPP(failures, suspensions),dist="lnorm")
LL&lt;-LLln(failures, suspensions, fit[1], fit[2])
</code></pre>

<hr>
<h2 id='LLw'>Log Likelihood for weibull fitted data, failures and suspensions only</h2><span id='topic+LLw'></span>

<h3>Description</h3>

<p>Determination of log-likelihood values for the basic distributions covered by R should be ubiquitous, but an implementation is provided here to enable likelihood ratio testing particularly for comparison of 3-parameter optimized models with their 2-parameter counterpart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LLw(x, s=NULL, Eta, Beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LLw_+3A_x">x</code></td>
<td>
<p>A vector of failure data.</p>
</td></tr>
<tr><td><code id="LLw_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="LLw_+3A_eta">Eta</code></td>
<td>
<p>The scale parameter from a weibull fit.</p>
</td></tr>
<tr><td><code id="LLw_+3A_beta">Beta</code></td>
<td>
<p>The shape parameter from a weibull fit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function LLw can only handle datasets with failure and suspension data. For data including intervals <code>wblrLikelihood</code> can be used.
This function is somewhat unique among likelihood functions in that it will scan the suspension data for
removal of negative values. Such negative values are likely to be entered as data is provided
for a 3-parameter fit by explicitly providing the original data with vector subtraction by the optimized t0.
The primary intention for likelihood determination is to permit likelihood ratio testing for comparison
of 3-parameter optimized models with their 2-parameter counterpart. 
</p>


<h3>Value</h3>

<p>Returns a log-likelihood value.
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
</p>
<p>Marie Laure Delignette-Muller, Christophe Dutang (2015). &quot;fitdistrplus: An R Package for Fitting Distributions&quot;.
Journal of Statistical Software, 64(4), 1-34. URL http://www.jstatsoft.org/v64/i04/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
fit&lt;-lslr(getPPP(failures, suspensions))
LL&lt;-LLw(failures, suspensions, fit[1], fit[2])
</code></pre>

<hr>
<h2 id='LRbounds'>Likelihood Ratio bounds</h2><span id='topic+LRbounds'></span>

<h3>Description</h3>

<p>Generates bounds across a double-sided confidence interval based on a likelihood ratio contour.</p>


<h3>Usage</h3>

<pre><code class='language-R'>LRbounds(x,  dist="weibull", CL=0.9, unrel=NULL,  contour=NULL, dof=1,
                control=NULL, debias="none", show=c(FALSE,FALSE))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LRbounds_+3A_x">x</code></td>
<td>
<p>A dataframe such as generated by mleframe with column names 'left', 'right' and optionally 'qty'.
Exact failure data (occurrences) have same time entered in both 'left' and 'right' columns.
Suspension data has last known life[time] entered in 'left' column and -1 entered in 'right' column.
The left(early) interval bound for left-censored data must be entered as zero. (NA is not accepted).
</p>
</td></tr>
<tr><td><code id="LRbounds_+3A_dist">dist</code></td>
<td>
<p>A string defining a distribution to be fit. Implemented distributions are &quot;weibull&quot; (default) and &quot;lognormal&quot;.
(Only 2-parameter models are accepted.)
</p>
</td></tr>
<tr><td><code id="LRbounds_+3A_cl">CL</code></td>
<td>
<p>A scalar for the double-sided confidence interval of interest. Default = 0.9, for 90
</p>
</td></tr>
<tr><td><code id="LRbounds_+3A_unrel">unrel</code></td>
<td>
<p>An optional vector of unreliability values to be used as the descriptive quantiles at which the bounds will be calculated.
</p>
</td></tr>
<tr><td><code id="LRbounds_+3A_contour">contour</code></td>
<td>
<p>An optional dataframe object previously generated by MLEcontour on x, consistent with CL and dist.
</p>
</td></tr>
<tr><td><code id="LRbounds_+3A_dof">dof</code></td>
<td>
<p>An integer value indicating degrees of freedom to apply to the Chi square test, which defaults to dof=1 for
confidence interval bound use. Should be set to 2 for comparison of two models each with 2 parameters.
</p>
</td></tr>
<tr><td><code id="LRbounds_+3A_control">control</code></td>
<td>
<p> A list having specifically named options for control of the bounds preparation. List item 'ptDensity' 
an integer value for the number of points to be plotted around the circumference of the (each) 2p contour. List item
'tzpoints' controls the number of t0 trials in a 3p iteration (see Details). List item RadLimit a convergence limit
for the contour radials based on specific units such as Eta/Eta_hat and Beta/Beta_hat.
</p>
</td></tr>
<tr><td><code id="LRbounds_+3A_debias">debias</code></td>
<td>
<p>A place holder for an optional string argument indicating the adjustment to be applied to the shape or standard deviation
parameter of the fitted data.
</p>
</td></tr>
<tr><td><code id="LRbounds_+3A_show">show</code></td>
<td>
<p>A vector of logicals determining whether and how a graphic of the bounds shall be displayed.
For 2-parameter bounds only the first element is considered and a crude graphic is provided for the bounds.
For 3-parameter bounds the first element determines whether a wblr graphic is displayed for the bounds, while
the second element determines whether the series of contours generated to develop the bounds is displayed.
</p>
</td></tr> 
</table>


<h3>Details</h3>

  
<p>The approach used for 3p bounds has been to vary the threshold value through a selection of increments from the optimized MLE toward zero.
Then 2-parameter contours based on a likelihood ratio determined from the optimized MLE are plotted as if looking down
on a 3 dimensional plot with threshold values in the z-direction. The bounds are then derived from the farthest extent of all the contours.
tzpoints is a control argument that can be used to alter the number of threshold values (tz's) to be sampled. The tzpoints
control argument is a vector having 3 elements. The first element controls the number of positive tz values to be sampled.
The second and third elements of the tzpoints vector control the sequence of negative tz values according to the relationship
tzpoints_neg&lt;-seq(tzpoints[3],tzpoints[2], by=tzpoints[3]).
</p>
<p>A bias adjustment, if specified, is applied to the shape parameter of generated contours. In this way such
adjustment is passed into the bounds preparation.Abernethy's &quot;Justified Likelihood Function&quot; has not been demonstrated 
to be academically accepted. For this reason no attempt has been made to implement similar modification related to bias adjustment.
Contribution of evidence or a method contrary to this position will gladly be reviewed by the package maintainer.
</p>


<h3>Value</h3>

<p>Returns a dataframe holding values of percentiles, lower, datum, and upper values of the bound.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(4321)
data&lt;-rlnorm(30,2,1.2)
bounds&lt;-LRbounds(mleframe(data[7:30],data[1:6]), dist="lognormal")
</code></pre>

<hr>
<h2 id='lslr'>Least squares linear regression with many optional methods</h2><span id='topic+lslr'></span>

<h3>Description</h3>

<p>This function implements a wide assortment of options for linear regression fitting of distributions specific to reliability analysis for the Abernethy Reliability Methods project.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lslr(x, dist="weibull", npar=2, reg_method="XonY", abpval=TRUE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lslr_+3A_x">x</code></td>
<td>
<p>A dataframe such as generated by getPPP with column names 'data' and 'ppp'.</p>
</td></tr>
<tr><td><code id="lslr_+3A_dist">dist</code></td>
<td>
<p>A string defining a distribution to be fit. Implemented distributions are &quot;weibull&quot; (default), &quot;lnorm&quot;, and &quot;gumbel&quot; (Extreme Value Type 1)</p>
</td></tr>
<tr><td><code id="lslr_+3A_npar">npar</code></td>
<td>
<p>Number of parameters to evaluate. This really is only looking for potential value of 3 for 3rd parameter optimization.  Any other value will resolve the same as default of 2.</p>
</td></tr>
<tr><td><code id="lslr_+3A_reg_method">reg_method</code></td>
<td>
<p>A string defining the order of axes presented for regression, whether &quot;XonY&quot; axis(default) or &quot;YonX&quot; axis for alternative study.</p>
</td></tr>
<tr><td><code id="lslr_+3A_abpval">abpval</code></td>
<td>
<p>A logical indicating whether to include the Abernethy P value in the result. When set to False the output vector will further be returned unnamed. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a named vector with parameters of the distribution fit and goodness of fit in terms of R squared.
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
Leonard C. Johnson (1964) &quot;The Statistical Treatment of Fatique Experiments&quot;  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
default_weibull_fit&lt;-lslr(getPPP(failures,suspensions))
</code></pre>

<hr>
<h2 id='MLEcontour'>Likelihood Ratio Contour for Weibull and Lognormal Fitted Data</h2><span id='topic+MLEcontour'></span>

<h3>Description</h3>

<p><code>MLEcontour</code> This function generates points for a display of the likelihood contour at given confidence limit
for the 2-parameter Weibull or lognormal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLEcontour(x,  dist="weibull", CL=0.9,dof=1,MLLx=NULL, MLEfit=NULL,
              RadLimit=1e-5,ptDensity=120, debias="none", show=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLEcontour_+3A_x">x</code></td>
<td>
<p>A dataframe such as generated by mleframe with column names 'left', 'right' and optionally 'qty'.
Exact failure data (occurrences) have same time entered in both 'left' and 'right' columns.
Suspension data has last known life[time] entered in 'left' column and -1 entered in 'right' column.
The left(early) interval bound for left-censored data must be entered as zero. (NA is not accepted).
</p>
</td></tr>
<tr><td><code id="MLEcontour_+3A_dist">dist</code></td>
<td>
<p>A string defining a distribution to be fit. Implemented distributions are &quot;weibull&quot; (default) and &quot;lognormal&quot;.
</p>
</td></tr>
<tr><td><code id="MLEcontour_+3A_cl">CL</code></td>
<td>
<p>a confidence limit to be applied to the Chi square test.</p>
</td></tr>
<tr><td><code id="MLEcontour_+3A_dof">dof</code></td>
<td>
<p>an integer value indicating degrees of freedom to apply to the Chi square test, which defaults to dof=1 for
confidence interval bound use. Should be set to 2 for comparison of two models each with 2 parameters.</p>
</td></tr>
<tr><td><code id="MLEcontour_+3A_mllx">MLLx</code></td>
<td>
<p>an optional argument intended for 3p modelling so that the maximum log-likelihood from an optimized
3rd parameter fit can be used to generate subsequent contours with variation in the translation parameter.
</p>
</td></tr>
<tr><td><code id="MLEcontour_+3A_mlefit">MLEfit</code></td>
<td>
<p>an optional argument to use a fit made external to the function. Disaster awaits any mismatch between data
entered and this fit. When provided, the MLEfit shall be a vector in the order of scale(or logmean), shape (or std dev) and Loglikelihood.
</p>
</td></tr>
<tr><td><code id="MLEcontour_+3A_ptdensity">ptDensity</code></td>
<td>
<p>an integer value for the number of points to be plotted around the circumference of the contour.</p>
</td></tr>
<tr><td><code id="MLEcontour_+3A_radlimit">RadLimit</code></td>
<td>
<p>a convergence limit for the contour radials based on specific units such as Eta/Eta_hat and Beta/Beta_hat.</p>
</td></tr>
<tr><td><code id="MLEcontour_+3A_debias">debias</code></td>
<td>
<p>An optional string argument indicating the adjustment to be applied to the shape or standard deviation
parameter of the fitted data. Recognized values are &quot;rba&quot;, &quot;mean&quot;, or &quot;hrbu&quot;.
</p>
</td></tr>
<tr><td><code id="MLEcontour_+3A_show">show</code></td>
<td>
<p>a logical value indicating whether a graphical output is desired (independent of wblr activity).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The contour points (p1,p2) identified as satisfying the root of the equation,
(log(ML(p1_hat,p2_hat))-log(RL(p1,p2)) - chisquare(CL,DF)/2=0,where ML is Maximum Likelihood for the data,and RL
is Ratioed Likelihood for the data at selected points for the contour.
The algorithm for this function (executed in compiled C++ code) uses a quinary search for the root optimization of each radial
on a polar coordinate loop. It is believed to be unique from commercial implementations and appears to have improved stability
for this notoriously challenging calculation.
</p>


<h3>Value</h3>

<p>A dataframe of plotting points for the contour.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fig3cF&lt;-c(1500,2250,4000,4300,7000)
fig3cS&lt;-c(1750,5000)
Contour&lt;-MLEcontour(mleframe(fig3cF,fig3cS))
</code></pre>

<hr>
<h2 id='mlefit'>Maximum likelihood regression on Weibull and Lognormal distributions</h2><span id='topic+mlefit'></span>

<h3>Description</h3>

<p>Maximum likelihood regression on weibull and lognormal distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlefit(x, dist="weibull", npar = 2, debias="none", optcontrol=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mlefit_+3A_x">x</code></td>
<td>
<p>A dataframe such as generated by mleframe with column names 'left', 'right' and optionally 'qty'.
Exact failure data (occurrences) have same time entered in both 'left' and 'right' columns.
Suspension data has last known life[time] entered in 'left' column and -1 entered in 'right' column.
The left(early) interval bound for left-censored data must be entered as zero. (NA is not accepted).
</p>
</td></tr>
<tr><td><code id="mlefit_+3A_dist">dist</code></td>
<td>
<p>A string defining a distribution to be fit. Implemented distributions are &quot;weibull&quot; (default),&quot;lognormal&quot;,
&quot;weibull3p&quot; and &quot;lognormal3p&quot;.
</p>
</td></tr>
<tr><td><code id="mlefit_+3A_npar">npar</code></td>
<td>
<p>An optional argument for specifying 3p optimization. Priority is given to any suffix to the distribution name.</p>
</td></tr>
<tr><td><code id="mlefit_+3A_debias">debias</code></td>
<td>
<p>An optional string argument indicating the adjustment to be applied to the shape or standard deviation
parameter of the fitted data. Adjustments recognized are: &quot;rba&quot; (default), &quot;mean&quot;, and &quot;hrbu&quot; (for hirose-ross beta unbias). Any entry for debias
with the lognormal distribution will be processed as &quot;rba&quot; with a warning if it was not clearly specified.
</p>
</td></tr>
<tr><td><code id="mlefit_+3A_optcontrol">optcontrol</code></td>
<td>
<p>An optional list of arguments for control of the MLE optimization.  The strict naming convention for the list items are:
'vstart', a vector holding starting estimate for parameters in the order used by the underlying R distribution [CAUTION: for weibull
the order of parameters is (shape, scope)], 'limit', the convergence limit, 'maxit', the maximum number of interations permitted in
the simplex optimization, and 'listout' a logical indicating whether output should list both the fit and the optimization progress as a dataframe. 
Additional list items 'num_points', 'err_t0_limit', and 'err_gor_limit' are handled for 3rd parameter processing -see details.
</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The negative log-likelihood is minimized by the Nelder-Meade, simplex, algorithm.  This algorithm requires a reasonable starting point
for the estimate.  Such a reasonable estimate is attempted by default, but in some cases this may be inadequate for proper function.
the optcontrol argument has been provided to give debug developers a means of altering and examining the progress of the optimization.
For 3rd parameter processing defaults are used for the simplex options, while 'num_points' can be used to alter the seek points, 
'err_t0_limit', and 'err_gor_limit' control cut-offs for unstable optiimizations, while 'list_out' provides a different output on the
optimization progress.
</p>


<h3>Value</h3>

<p>Returns a named vector with parameters of the distribution fit and goodness of fit in terms of log likelihood.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>
<p>Marie Laure Delignette-Muller, Christophe Dutang (2015). &quot;fitdistrplus: An R Package for Fitting Distributions&quot;.
Journal of Statistical Software, 64(4), 1-34. URL http://www.jstatsoft.org/v64/i04/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
weibull_fit&lt;-mlefit(mleframe(failures,suspensions))
</code></pre>

<hr>
<h2 id='mleframe'>Set life(time) data into the format required by mlefit</h2><span id='topic+mleframe'></span>

<h3>Description</h3>

<p>Validate input data by types and build a dataframe to be used as the primary argument object to mlefit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mleframe(x, s=NULL, interval=NULL) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mleframe_+3A_x">x</code></td>
<td>
<p>An expected vector of failure data. Alternative support is provided for a dataframe holding time and event columns,
where event markers for failure occurrences are 1 and suspensions (right censored data) are 0.</p>
</td></tr>
<tr><td><code id="mleframe_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="mleframe_+3A_interval">interval</code></td>
<td>
<p>A dataframe holding interval bounds for failure data in columns named 'left' and 'right'.
The left(early) interval bound for left-censored data must be entered as zero (NA is not accepted).
An optional column named 'qty' may contain the integer quantity of data entries having same interval values.</p>
</td></tr>  
</table>


<h3>Value</h3>

<p>Returns a dataframe of the life[time] data in columns named 'left', 'right', and 'qty' with an attribute of fsiq set to TRUE.
Exact failure data (occurrences) have same time entered in both 'left' and 'right' columns.  
Suspension data has last known life[time] entered in 'left' column and -1 entered in 'right' column.  
The interval dataframe argument is appended.  The 'qty' field is populated with a value of 1 for all failure
and suspension entries and interval rows where qty was not provided. 
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>
<p>Marie Laure Delignette-Muller, Christophe Dutang (2015). &quot;fitdistrplus: An R Package for Fitting Distributions&quot;.
Journal of Statistical Software, 64(4), 1-34. URL http://www.jstatsoft.org/v64/i04/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fail&lt;-c(10,40,40,50)
susp&lt;-c(20,60)
left&lt;-c(0,0,0,20,10)
right&lt;-c(30,70,100,80,85)
qty&lt;-c(2,1,1,2,1)
interval_ex&lt;-data.frame(left,right,qty)
input_frame&lt;-mleframe(fail,susp,interval_ex)
## time_event dataframe argument
failDF&lt;-data.frame(time=fail, event=1)
suspDF&lt;-data.frame(time=susp, event=0)
time_event_frame&lt;-rbind(failDF, suspDF)
input_frame2&lt;-mleframe(time_event_frame)
## now a time_event_qty dataframe argument
fa&lt;-c(10,40,50)
fq&lt;-c(1,2,1)
su&lt;-susp
faDF&lt;-data.frame(time=fa, event=rep(1,length(fa)), qty=fq)
## note: data.frame is forgiving about repeated single column entry
suDF&lt;-data.frame(time=su, event=0, qty=1)
time_event_qty&lt;-rbind(faDF, suDF)
input_frame3&lt;-mleframe(time_event_qty)
</code></pre>

<hr>
<h2 id='MLEln2p'>Quick Fit, Maximum Likelihood Estimate for 2-parameter lognormal distributions</h2><span id='topic+MLEln2p'></span>

<h3>Description</h3>

<p>Determination of lognormal fitting parameters, goodness of fit measures and confidence interval bounds with optional graphical display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLEln2p(x, s=NULL, bounds=FALSE, show=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLEln2p_+3A_x">x</code></td>
<td>
<p>A vector of failure data, or a dataframe wit time, event and optionally qty columns</p>
</td></tr>
<tr><td><code id="MLEln2p_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="MLEln2p_+3A_bounds">bounds</code></td>
<td>
<p>A logical argument defining whether confidence interval bounds should be calculated by pivotal analysis.</p>
</td></tr> 
<tr><td><code id="MLEln2p_+3A_show">show</code></td>
<td>
<p>A logical argument defining whether a simple graphical output is desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to provide a simple casual method of standard lognormal fitting based on default methods, without options. 
</p>


<h3>Value</h3>

<p>When the bounds argument is set to FALSE this function returns a vector with named elements for Mulog, Sigmalog,
and LL (log-likelihood).  When the bounds argument is set to TRUE a list is returned 
containing the vector as described and a dataframe of confidence interval bound values at a fixed set of descriptive quantiles,
suitable for comparison with other software.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
fit&lt;-MLEln2p(failures, suspensions)
</code></pre>

<hr>
<h2 id='MLEln3p'>Quick Fit, Maximum Likelihood Estimate for 3-parameter lognormal distributions</h2><span id='topic+MLEln3p'></span>

<h3>Description</h3>

<p>Determination of lognormal fitting parameters with third, translation parameter optimization.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLEln3p(x, s=NULL, bounds=FALSE, show=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLEln3p_+3A_x">x</code></td>
<td>
<p>A vector of failure data, or a dataframe wit time, event and optionally qty columns</p>
</td></tr>
<tr><td><code id="MLEln3p_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="MLEln3p_+3A_bounds">bounds</code></td>
<td>
<p>A logical argument defining whether confidence interval bounds should be calculated by pivotal analysis.</p>
</td></tr> 
<tr><td><code id="MLEln3p_+3A_show">show</code></td>
<td>
<p>A logical argument defining whether a simple graphical output is desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to provide a simple casual method of standard lognormal fitting based on default methods, without options. 
</p>


<h3>Value</h3>

<p>When the bounds argument is set to FALSE this function returns a vector with named elements for Mulog, Sigmalog,
and LL (log-likelihood).  Bounds are not determined for 3p models, hence any bounds argument is simply ignored.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
fit&lt;-MLEln3p(failures, suspensions)
</code></pre>

<hr>
<h2 id='MLEw2p'>Quick Fit, Maximum Likelihood Estimate for 2-parameter weibull distributions</h2><span id='topic+MLEw2p'></span>

<h3>Description</h3>

<p>Determination of Weibull fitting parameters, goodness of fit measures and confidence interval bounds with optional graphical display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLEw2p(x, s=NULL, bounds=FALSE, show=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLEw2p_+3A_x">x</code></td>
<td>
<p>A vector of failure data, or a dataframe wit time, event and optionally qty columns</p>
</td></tr>
<tr><td><code id="MLEw2p_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="MLEw2p_+3A_bounds">bounds</code></td>
<td>
<p>A logical argument defining whether confidence interval bounds should be calculated by pivotal analysis.</p>
</td></tr> 
<tr><td><code id="MLEw2p_+3A_show">show</code></td>
<td>
<p>A logical argument defining whether a simple graphical output is desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to provide a simple casual method of standard weibull analysis based on default methods, without options.
</p>


<h3>Value</h3>

<p>When the bounds argument is set to FALSE this function returns a vector with named elements for Eta, Beta,
and LL (log-likelihood).  When the bounds argument is set to TRUE a list is returned 
containing the vector as described and a dataframe of confidence interval bound values at a fixed set of descriptive quantiles,
suitable for comparison with other software.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
fit&lt;-MLEw2p(failures, suspensions)
</code></pre>

<hr>
<h2 id='MLEw3p'>Quick Fit, Maximum Likelihood Estimation for weibull distribution in 3-parameters </h2><span id='topic+MLEw3p'></span>

<h3>Description</h3>

<p>Determination of Weibull fitting parameters with third, translation parameter optimization. 
Result provided with goodness of fit measures with optional graphical display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLEw3p(x, s=NULL, bounds=FALSE, show=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLEw3p_+3A_x">x</code></td>
<td>
<p>A vector of failure data.</p>
</td></tr>
<tr><td><code id="MLEw3p_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="MLEw3p_+3A_bounds">bounds</code></td>
<td>
<p>A logical argument defining whether confidence interval bounds should be calculated by pivotal analysis.</p>
</td></tr>
<tr><td><code id="MLEw3p_+3A_show">show</code></td>
<td>
<p>A logical argument defining whether a simple graphical output is desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to provide a simple casual method of standard weibull analysis based on default methods, without options.
</p>


<h3>Value</h3>

<p>When the bounds argument is set to FALSE this function returns a vector with named elements for Eta, Beta,
and LL (log-likelihood).  Bounds are not determined for 3p models, hence any bounds argument is simply ignored.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
fit&lt;-MLEw3p(failures, suspensions)
</code></pre>

<hr>
<h2 id='MRRln2p'>Quick Fit, Median rank regression for 2-parameter log-normal distributions</h2><span id='topic+MRRln2p'></span>

<h3>Description</h3>

<p>Determination of fitting parameters, goodness of fit measures and confidence interval bounds with optional graphical display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MRRln2p(x, s=NULL, bounds=FALSE, show=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MRRln2p_+3A_x">x</code></td>
<td>
<p>A vector of failure data.</p>
</td></tr>
<tr><td><code id="MRRln2p_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="MRRln2p_+3A_bounds">bounds</code></td>
<td>
<p>A logical argument defining whether confidence interval bounds should be calculated by pivotal analysis.</p>
</td></tr>
<tr><td><code id="MRRln2p_+3A_show">show</code></td>
<td>
<p>A logical argument defining whether a simple graphical output is desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to provide a simple casual method of standard lognormal fitting based on default methods,
without options.  It also provides an example for handling the pivotal values returned from pivotalMC. 
</p>


<h3>Value</h3>

<p>When bounds is set to FALSE this function returns a vector with named elements for Mulog, Sigmalog, Rsqr,
AbPval (Abernethy's P-value), and LL (log-likelihood).  When the bounds argument is set to TRUE a list is returned with
the vector as described and a dataframe of confidence interval bound values at a fixed set of descriptive quantiles,
dq&lt;-c(.01, .02, .05, .10, .15, .20, .30, .40, .50,  .60, .70, .80, .90, .95, .99), suitable for comparison with other software.
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
Leonard C. Johnson (1964) &quot;The Statistical Treatment of Fatigue Experiments&quot;  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
fit&lt;-MRRln2p(failures, suspensions)
</code></pre>

<hr>
<h2 id='MRRln3p'>Quick Fit, Median rank regression for log-normal distribution with third parameter optimization</h2><span id='topic+MRRln3p'></span>

<h3>Description</h3>

<p>Determination of log-normal fitting parameterswith third parameter optimization.
Goodness of fit measures and confidence interval bounds can be returned with optional graphical display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MRRln3p(x, s=NULL, bounds=FALSE, show=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MRRln3p_+3A_x">x</code></td>
<td>
<p>A vector of failure data.</p>
</td></tr>
<tr><td><code id="MRRln3p_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="MRRln3p_+3A_bounds">bounds</code></td>
<td>
<p>A logical argument defining whether confidence interval bounds should be calculated by pivotal analysis.</p>
</td></tr>
<tr><td><code id="MRRln3p_+3A_show">show</code></td>
<td>
<p>A logical argument defining whether a simple graphical output is desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to provide a simple casual method of standard lognoirmal fitting based on default methods,
without options.  It also provides an example for handling the pivotal values returned from pivotalMC and the likelihood ratio test. 
</p>


<h3>Value</h3>

<p>When bounds is set to FALSE this function returns a vector with named elements for Eta, Beta, Rsqr,
AbPval (Abernethy's P-value), and LL (log-likelihood).  When the bounds argument is set to TRUE a list is returned with
the vector as described and a dataframe of confidence interval bound values at a fixed set of descriptive quantiles,
dq&lt;-c(.01, .02, .05, .10, .15, .20, .30, .40, .50,  .60, .70, .80, .90, .95, .99), suitable for comparison with other software.
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
Leonard C. Johnson (1964) &quot;The Statistical Treatment of Fatigue Experiments&quot;  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
fit&lt;-MRRln3p(failures, suspensions)
</code></pre>

<hr>
<h2 id='MRRw2p'>Quick Fit, Median rank regression for 2-parameter weibull distributions</h2><span id='topic+MRRw2p'></span>

<h3>Description</h3>

<p>Determination of Weibull fitting parameters, goodness of fit measures and confidence interval bounds with optional graphical display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MRRw2p(x, s=NULL, bounds=FALSE, show=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MRRw2p_+3A_x">x</code></td>
<td>
<p>A vector of failure data.</p>
</td></tr>
<tr><td><code id="MRRw2p_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="MRRw2p_+3A_bounds">bounds</code></td>
<td>
<p>A logical argument defining whether confidence interval bounds should be calculated by pivotal analysis.</p>
</td></tr>
<tr><td><code id="MRRw2p_+3A_show">show</code></td>
<td>
<p>A logical argument defining whether a simple graphical output is desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to provide a simple casual method of standard weibull analysis based on default methods, without options.  It also provides an example for handling the pivotal values returned from pivotalMC. 
</p>


<h3>Value</h3>

<p>When the bounds argument is set to FALSE this function returns a vector with named elements for Eta, Beta, Rsqr,
AbPval (Abernethy's P-value), and LL (log-likelihood).  When the bounds argument is set to TRUE a list is returned 
containing the vector as described and a dataframe of confidence interval bound values at a fixed set of descriptive quantiles,
dq&lt;-c(.01, .02, .05, .10, .15, .20, .30, .40, .50,  .60, .70, .80, .90, .95, .99), suitable for comparison with other software.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
Leonard C. Johnson (1964) &quot;The Statistical Treatment of Fatigue Experiments&quot;  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
fit&lt;-MRRw2p(failures, suspensions)
</code></pre>

<hr>
<h2 id='MRRw3p'>Quick Fit, Median rank regression for weibull distribution in 3-parameters </h2><span id='topic+MRRw3p'></span>

<h3>Description</h3>

<p>Determination of Weibull fitting parameters with third, translation parameter optimization. Result provided with goodness
of fit measures and confidence interval bounds with optional graphical display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MRRw3p(x, s=NULL, bounds=FALSE, show=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MRRw3p_+3A_x">x</code></td>
<td>
<p>A vector of failure data.</p>
</td></tr>
<tr><td><code id="MRRw3p_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="MRRw3p_+3A_bounds">bounds</code></td>
<td>
<p>A logical argument defining whether confidence interval bounds should be calculated by pivotal analysis.</p>
</td></tr>
<tr><td><code id="MRRw3p_+3A_show">show</code></td>
<td>
<p>A logical argument defining whether a simple graphical output is desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to provide a simple casual method of standard weibull analysis based on default methods, without options.
It also provides examples for handling the pivotal values returned from pivotalMC and performance of the likelihood ratio test. 
</p>


<h3>Value</h3>

<p>When the bounds argument is set to FALSE this function returns a vector with named elements for Eta, Beta, Rsqr,
AbPval (Abernethy's P-value), and LL (log-likelihood).  When the bounds argument is set to TRUE a list is returned 
containing the vector as described and a dataframe of confidence interval bound values at a fixed set of descriptive quantiles,
dq&lt;-c(.01, .02, .05, .10, .15, .20, .30, .40, .50,  .60, .70, .80, .90, .95, .99), suitable for comparison with other software.
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
Leonard C. Johnson (1964) &quot;The Statistical Treatment of Fatigue Experiments&quot;  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
fit&lt;-MRRw3p(failures, suspensions)
</code></pre>

<hr>
<h2 id='options.wblr'>
Options list for <code>wblr</code> Objects
</h2><span id='topic+options.wblr'></span>

<h3>Description</h3>

<p>This function handles the various calculation, printing and plotting options
for wblr objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>options.wblr(...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="options.wblr_+3A_...">...</code></td>
<td>

<p>Options for calculating, printing and plotting <code>wblr</code> objects using the <span class="pkg">WeibullR</span>
package.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Typical usage of <code>wblr</code> objects involves calling a sequence of functions each forming
the object, then modifying it in this typical manner:
</p>
<p><code>da &lt;- wblr(c(10,11,27), col="red")</code><br />
<code>da &lt;- wblr.fit(da, col="darkgreen")</code><br />
<code>da &lt;- wblr.conf(da), col="blue"</code><br />
<code>plot(da)</code>
</p>
<p>The correct time to specify an option is when it is needed for the first
time. For example, when the color setting option <code>col = "red"</code> is
passed as an argument of function <code>wblr</code>, it will be used for
data points, fitted lines and confidence interval bounds. If supplied to <code><a href="#topic+wblr.conf">wblr.conf</a></code>,
only the confidence bounds will have the re-specified color, hereby overriding
any previously inherited color settings from <code><a href="#topic+wblr.fit">wblr.fit</a></code>
or <code><a href="#topic+wblr">wblr</a></code>.
</p>
<p>Do not call <code>options.wblr</code> in between these functions because some
options are locked and cannot be altered further in this chain. This is an
implication of the way the <code>wblr</code> object is structured.
</p>
<p>As a function, options.wblr, borrows its internal structure from
the <code><a href="graphics.html#topic+par">par</a></code> function of package <span class="pkg">graphics</span>.
It can be used independently of the typical wblr, wblr.fit, wblr.conf sequence,
but this is discouraged. However, when used independently the following guidance is
provided:
</p>
<p><code>options.wblr()</code>
</p>
<p>Returns the currently used options and their values.
</p>
<p><code>options.wblr()$dist </code>
<code>options.wblr("dist")</code>
</p>
<p>Returns the current value of an option.
</p>
<p><code>options.wblr(ci=0.95) </code>
<code>options.wblr(list(ci=0.95,S=5e4))</code>
</p>
<p>Sets the specified options.
</p>
<p>Currently, there is no way to reset the options to the default values using
this function.  One might, before changing any options, store the option
list in a temporary variable like
</p>
<p><code>wblr.defaults &lt;- options.wblr()</code>
</p>
<p>for restoring it later by running <code>options.wblr(wblr.defaults)</code>.
</p>
<p>The function creates a globally accessible list named  <code>options_wblr</code>,
holding the options.  One should always use the  <code>options.wblr</code>
function to access the option list, do not access this list directly.
</p>


<h3>Value</h3>

<p>Executing <code>options.wblr</code> without arguments returns a named list
containing the currently active global options of the <code>wblr</code> object.<br />
When arguments are supplied, these are returned in a named list.
</p>


<h3>wblr options</h3>

<p>Options specific to initial <code><a href="#topic+wblr">wblr</a></code> object creation with data prepared for graphical display
</p>

<dl>
<dt><code>dist</code></dt><dd>
<p>A character string defining the distribution target. When used to establish the basis for
contour mapping (without using wblr.conf with method.conf=&quot;lrb&quot;) only &quot;weibull&quot; (default)
and &quot;lognormal&quot; are recognized.<br />
Also used with <code><a href="#topic+wblr.fit">wblr.fit</a></code> for specific fitting control.
</p>
</dd>
<dt><code>pp</code></dt><dd>
<p>Plotting position method, it is a character string describing the method of determining
vertical plot positions. Implemented methods are &quot;median&quot; (default), &quot;benard&quot;,&quot;hazen&quot;,&quot;mean&quot;, &quot;kaplan-meier&quot;, and &quot;blom&quot;.
</p>
</dd>
<dt><code>rank.adj</code></dt><dd>
<p>The method employed for determining rank of failures when suspensions (right censored data)
are present in the data set. Implemented methods are &quot;johnson&quot; (default) and &quot;KMestimator&quot;.
</p>
</dd>
<dt><code>ties.handler</code></dt><dd>
<p>The method employed for handling duplicate values in the data set.<br />
Implemented methods are &quot;none&quot; (default) &quot;highest&quot;, &quot;lowest&quot;, &quot;mean&quot;, and &quot;sequential&quot;.<br />
It is expected that ties handling will be applied to large data sets that will be fitted
using the maximum likelihood estimation method, where the effect is only on the graphical
presentation. Employing a ties handler on a rank regression model will effectively remove data
from the data set, which is likely not intended.<br />
Use of simply <code>ties</code> as an argument to function <code>wblr</code> will silently be accepted as <code>ties.handler</code>.
</p>
</dd>
<dt>Options for graphical control over data points see <code><a href="graphics.html#topic+par">par</a></code></dt><dd>

<ul>
<li><p><code>pch</code> Point choice defaults to <code>1</code>. For more info, see
<code><a href="graphics.html#topic+points">points</a></code>.

</p>
</li>
<li><p><code>cex.points</code> Point size defaults to <code>1</code>.

</p>
</li>
<li><p><code>lwd.points</code> Line width defaults to <code>2</code>.

</p>
</li></ul>

</dd>
<dt>Independent graphical control over interval lines</dt><dd>

<ul>
<li><p><code>interval.col</code> Color defaults to <code>"black"</code>.

</p>
</li>
<li><p><code>interval.lty</code> Line type, defaults to <code>"dashed"</code>.

</p>
</li>
<li><p><code>interval.lwd</code> Line width defaults to <code>1</code>.

</p>
</li></ul>

</dd>
</dl>

<p>Options specific to <code><a href="#topic+wblr.fit">wblr.fit</a></code>
</p>

<dl>
<dt><code>dist</code></dt><dd>
<p>A character string defining the distribution target. Recognized values are
&quot;weibull&quot; (default), &quot;lognormal&quot;,&quot;lnorm&quot;,&quot;lognormal2p&quot;, &quot;weibull2p&quot;,&quot;lognormal3p&quot;, and &quot;weibull3p&quot;.
</p>
</dd>
<dt><code>method.fit</code></dt><dd>
<p>A vector of class <code>"character"</code> with fitting options. Recognized values are &quot;rr-xony&quot; (default),
&quot;rr&quot;,&quot;rr-yonx&quot;, &quot;mle&quot;,&quot;mle-rba&quot;, and &quot;mle-unbias&quot;.
</p>
</dd>
</dl>

<p>Options specific to <code><a href="#topic+wblr.conf">wblr.conf</a></code>
</p>

<dl>
<dt><code>method.conf</code></dt><dd>
<p>A character string describing the techniques used for calculating confidence interval bounds.
Implemented methods are &quot;pivotal-rr&quot; (default), &quot;bbb&quot;, &quot;fm&quot; &quot;fmbounds&quot;, and &quot;lrb&quot;.
Methods must conform to the method.fit in the wblr.fit call immediately preceding the wblr.conf call.
Method &quot;pivotal-rr&quot; requires a rank regression fit method. Methods &quot;fm&quot;, &quot;fmbounds&quot;, and &quot;lrb&quot; require a mle based fit.
</p>
</dd>
<dt><code>dq</code></dt><dd>
<p>A named series of quantiles at which confidence interval bounds will be calculated.
</p>

<ul>
<li><p><code>"abrem"</code> 
Default. This is the original default by Jurgen Symynck for predecessor package abrem
it produces evenly spaced points across the y limits of a weibull canvas
attempting to hold a constant number of points (see <code>num_dq</code> below).

</p>
</li>
<li><p><code>"minitab"</code> 
Quantiles matching Minitab(TM) unchangeable defaults (27 values).

</p>
</li>
<li><p><code>"supersmith"</code> 
Quantiles for comparison with SuperSMITH(TM) (limit of 15 values)

</p>
</li>
<li><p><code>"user"</code> 
Provides for a user defined series of quantiles. (see <code>user_dq</code> below).

</p>
</li></ul>

</dd>
<dt><code>num_dq</code></dt><dd>
<p>The number of points used for the <code>"abrem"</code> dq determination.
</p>
</dd>
<dt><code>user_dq</code></dt><dd>
<p>A vector of quantiles set by user. Default <code>c(seq(.01,.09,by=.01),seq(.10,.90,by=.10),seq(.91,.99, by=.01))</code>.
</p>
</dd>
<dt><code>ci</code></dt><dd>
<p>The double-sided confidence interval, also chi sq confidence level for likelihood ratio.
Must be in a range &lt;1 &amp;&amp; &gt;0, default is <code>0.9</code>.
</p>
</dd>
<dt><code>blife.pts</code></dt><dd>
<p>The probability points at which to report Blife on legend.
</p>
</dd>
<dt>Specific controls for pivotal analysis only</dt><dd>

<ul>
<li><p><code>seed</code>
The RNG seed integer such that results are duplicated between runs, default is <code>1234</code>.

</p>
</li>
<li><p><code>S</code>
The number of samples to be run during pivotal analysis, default is <code>1e4</code>.

</p>
</li></ul>

</dd>
<dt>Specific controls for likelihood ratio contour and bounds only</dt><dd>

<ul>
<li><p><code>dof</code>
The degrees of freedom, <code>dof=1</code> (default) for confidence interval, <code>dof=2</code> for comparison.

</p>
</li>
<li><p><code>ptDensity</code>
The number of points calculated to form the contour outline, default is <code>120</code>.

</p>
</li></ul>

</dd>
</dl>

<p>General graphical options
</p>

<dl>
<dt>Graphical control for fitted lines, confidence bounds, or contours can be set at
wblr, wblr.fit, or wblr.conf functions for individual object control. See <code><a href="graphics.html#topic+par">par</a></code></dt><dd>

<ul>
<li><p><code>col</code> Color defaults to <code>"black"</code>.

</p>
</li>
<li><p><code>lty</code> Line type, defaults to <code>"solid"</code>.

</p>
</li>
<li><p><code>lwd</code> Line width defaults to <code>2</code>.

</p>
</li></ul>

</dd>
<dt>Graphical controls typically used with <code>plot</code> or <code><a href="#topic+plot.wblr">plot.wblr</a></code></dt><dd>

<ul>
<li><p><code>canvas</code>
The plotting canvas to be used. This does not necessarily have to match the fit distribution.
Only <code>"weibull"</code> (default) or <code>"lognormal"</code> are recognized.

</p>
</li>
<li><p><code>mar</code> Margins defaults to <code>c(5.1,4.1,5.1,2.1),</code>.

</p>
</li>
<li><p><code>main</code> Title, defaults to <code>"Probability Plot"</code>.

</p>
</li>
<li><p><code>main.contour</code> Contour plot title defaults to <code>"Contour Plot"</code>.

</p>
</li>
<li><p><code>sub</code> Subtitle defaults to <code>NULL</code>.

</p>
</li>
<li><p><code>sub.contour</code> Contour subtitle defaults to <code>NULL</code>.

</p>
</li>
<li><p><code>xlim</code> Plot x limits override to be presented as a vector c(lo,hi), default <code>NULL</code>.

</p>
</li>
<li><p><code>ylim</code> Plot y limits override to be presented as a vector c(lo,hi), default <code>NULL</code>.

</p>
</li>
<li><p><code>xlab</code> X axis label defaults to <code>"Time To Failure"</code>.

</p>
</li>
<li><p><code>ylab</code> Y axis label defaults to <code>"Unreliability [%]"</code>.

</p>
</li>
<li><p><code>coordinate.text.size</code> default <code>0.7</code>.

</p>
</li>
<li><p><code>signif</code> Used to control display of numbers in Legend, default <code>4</code>.

</p>
</li>
<li><p><code>col.grid</code> Color for chart gridlines defaults <code>"grey"</code>.

</p>
</li>
<li><p><code>is.plot.grid</code> default <code>TRUE</code>.

</p>
</li>
<li><p><code>is.plot.fit</code> default <code>TRUE</code>.

</p>
</li>
<li><p><code>is.plot.pp</code> default <code>TRUE</code>.

</p>
</li>
<li><p><code>is.plot.ppcoordinates</code> default <code>FALSE</code>.

</p>
</li>
<li><p><code>is.plot.legend</code> default <code>TRUE</code>.

</p>
</li>
<li><p><code>legend.position</code> default <code>"bottomright"</code>. See <code><a href="graphics.html#topic+legend">legend</a></code> Details.

</p>
</li>
<li><p><code>legend.inset</code> default <code>c(0,0)</code>. legend inset values are fractions of graph width and height.

</p>
</li>
<li><p><code>legend.text.size</code> default <code>0.7</code>.

</p>
</li>
<li><p><code>label</code> defaults to <code>""</code>.

</p>
</li>
<li><p><code>in.legend</code> default <code>TRUE</code>.

</p>
</li>
<li><p><code>in.legend.blives</code> default <code>TRUE</code>.

</p>
</li>
<li><p><code>in.legend.gof</code> default <code>TRUE</code>.

</p>
</li>
<li><p><code>is.plot.cb</code> default <code>TRUE</code>.

</p>
</li>
<li><p><code>persistent</code> default <code>TRUE</code>.

</p>
</li></ul>

</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## backup options ##
wblr.defaults &lt;- options.wblr()

## setting new options ##
options.wblr(S=5e5,ci=0.99)

## listing options ##
options.wblr()
options.wblr()$main

## restore options ##
options.wblr(wblr.defaults)
</code></pre>

<hr>
<h2 id='p2y'>Transform Probability Value to the Y-Axis of a <code>"plot.wblr"</code> Canvas</h2><span id='topic+p2y'></span>

<h3>Description</h3>

<p>This function used to transform a probability value to the y-axis of a plot canvas. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'> p2y(p,canvas="weibull")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p2y_+3A_p">p</code></td>
<td>
<p>The percentile or probability value</p>
</td></tr>
<tr><td><code id="p2y_+3A_canvas">canvas</code></td>
<td>
<p>The name of the wblr canvas to plot to. (Does not have to match the fit distribution. 
Use of this transformation permits distributions to appear as curves on unrelated canvas.)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This applies the inverse Cumulative Distribution function. When applying the default <code>"weibull"</code> canvas
this function is equivalent to <code>SPLEDA::qsev</code>. It is particularly handy when adding points and lines
to plots generated on wblr objects.
</p>


<h3>Value</h3>

<p>The transformed y-axis value for a <code>"plot.wblr"</code> Canvas.
</p>

<hr>
<h2 id='pivotal.rr'>Pivotal 'Monte Carlo' re-sampling of least squares linear regression models</h2><span id='topic+pivotal.rr'></span>

<h3>Description</h3>

<p>This function implements a fast pivotal engine enabling a wide assortment of options for linear regression models  for the Abernethy Reliability Methods project. Pivotal analysis is used to determine a goodness of fit measure and confidence interval bounds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pivotal.rr(x, event=NULL, dist="weibull", reg_method="XonY", R2, CI, unrel=NULL,
  P1=1.0, P2=1.0, npar=2, S=10^4, seed=1234, ProgRpt=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pivotal.rr_+3A_x">x</code></td>
<td>
<p>A dataframe such as generated by getPPP with column names 'data' and 'ppp'.</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_event">event</code></td>
<td>
<p>An optional integer vector with 0's identifying the rank position of suspension data for sample masking.  Event masking will modestly narrow the confidence interval consistent with the addition of information.  The user has full control over determination of significance of the suspension data for this process.</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_dist">dist</code></td>
<td>
<p>A string defining a distribution to be fit. Implemented distributions are &quot;weibull&quot; (default), &quot;lnorm&quot;, &quot;weibull3p&quot;, and lognormal3p&quot; are implemented. [&quot;gumbel&quot; (Extreme Value Type 1) experimental support is currently suspended]</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_reg_method">reg_method</code></td>
<td>
<p>A string defining the order of regression whether &quot;XonY&quot; axis(default and &quot;best practice for standard small sample fitting) or &quot;YonX&quot; axis for alternative study (&quot;YonX&quot; recommended for an inspection option by Abernethy).</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_r2">R2</code></td>
<td>
<p>Output control: for prr and ccc2 the explained variance (R squared) from a linear regression of a data sample of interest. An entry of 0 (zero) suppresses output, 1.0 requests the entire vector of r^2 values.</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_ci">CI</code></td>
<td>
<p>Output control: for the bounds provide the double sided confidence interval of interest. An entry of 0 (zero) suppresses output, 1.0 requests an entire matrix of generated values.</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_unrel">unrel</code></td>
<td>
<p>An optional vector of unreliability values to be used as the descriptive quantiles at which the bounds will be calculated.</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_p1">P1</code></td>
<td>
<p>The scale parameter to be used in random sampling.  Default = 1.0 (For lnorm or gumbel distributions this most likely will be preferred to be set to zero.)</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_p2">P2</code></td>
<td>
<p>The shape parameter to be used in random sampling. Default = 1.0</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_npar">npar</code></td>
<td>
<p>An alternate way to identify the number of distribution parameters (2 or 3 are only possibilities). A dist of &quot;weibull3p&quot; or &quot;lognormal3p&quot; will override any value entered as npar. </p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_s">S</code></td>
<td>
<p>The number of random samples to be drawn for Monte Carlo simulation. S must be a multiple 
of 10.  If S is less than 1,000 R2 and/or CI will be altered from non-zero quantities to 1.0 to return the full vector of R2 CDF or the full matrix of pivotal values.  The default of 10^4 is adequate for most instances. S is implemented as an unsigned int in C++ code.  The maximum limit is 4x10^9 if system memory permits.</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_seed">seed</code></td>
<td>
<p>an integer used to set the RNG seed.  Default = 1234</p>
</td></tr>
<tr><td><code id="pivotal.rr_+3A_progrpt">ProgRpt</code></td>
<td>
<p>A boolean value to control the generation of percent completion feedback in the R terminal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Pivotal quantities are determined by establishing the x-axis value at each descriptive quantile position for each sampled regression.  The output pivotals determined at the double sided confidence interval must be interpreted for application to any given data fit.
</p>


<h3>Value</h3>

<p>Returns an appropriate object for the input R2 and CI values.  There are 8 output configurations that can be generated depending on the argument values for R2 (for r^2, coefficient of determination) and CI (for confidence interval).   When either of these values is entered as zero, no output for the corresponding prr value or confidence interval are generated.  Specifically defined input values for either argument are in the range 0.0&lt;value&lt;1.0 .  When a specifically defined value has been provided the output for R2 will be a vector containing the prr value and the CCC^2.  The output for a specifically defined CI will be a dataframe containing the pivotal quantities.  Should an absolute value of 1.0 be given for either R2 or CI then a full vector of the r^2 CDF, or the full matrix of pivotal quantities generated for all samples will be returned.  When non-zero entries are provided for both R2 and CI the appropriate output objects are returned in a list.
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
</p>
<p>Jerald F. Lawless, (2003) &quot;Statistical Models and Methods for Lifelime Data, Second Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>
<p>Chi-Chao Lui, &quot;A Comparison Between The Weibull And Lognormal Models Used To Analyse Reliability Data&quot;
(dissertation from University of Nottingham, 1997)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
data_positions&lt;-getPPP(failures,suspensions)
fit&lt;-lslr(data_positions)
prr_value&lt;-pivotal.rr(data_positions,R2=fit[3],CI=0, unrel=.5)
## note: unrel value has no meaning when CI=0
</code></pre>

<hr>
<h2 id='plot_contour'>
Plotting of Likelihood Ratio Contours from <code>wblr</code> Objects
</h2><span id='topic+plot_contour'></span>

<h3>Description</h3>

<p>Plots likelihood ratio contours from a <code>wblr</code> object or a list of <code>wblr</code> objects. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_contour(x, CL=NULL, AL=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_contour_+3A_x">x</code></td>
<td>

<p>Object of class <code>"wblr"</code> or a list of <code>"wblr"</code> objects.
</p>
</td></tr>
<tr><td><code id="plot_contour_+3A_cl">CL</code></td>
<td>
<p>An optional argument for establishing the confidence limit(s) for calculated contours. A vector of values may be provided to generate concentric contours on a single object.
</p>
</td></tr>
<tr><td><code id="plot_contour_+3A_al">AL</code></td>
<td>
<p>A Logical defining whether parameters of lognormal contours should be presented as AntiLog values.
</p>
</td></tr>
<tr><td><code id="plot_contour_+3A_...">...</code></td>
<td>

<p>Entry for a limited set of graphic parameters (col, lty, lwd, xlim, ylim, main and sub)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no CL argument is provided, the contours generated in the provided <code>wblr</code> objects for likelihood confidence bounds will be plotted.
If a vector is provided for CL, multiple contours for each provided object will be calculated to display concentric contours according to values in the CL vector.
In all cases options for distribution, degrees of freedom and graphic options will be extracted from the underlying objects.
</p>


<h3>Value</h3>

<p>This function returns the list of contours that were prepared for plotting.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
fail&lt;-rweibull(5,2,10)
ctest&lt;-wblr(fail)
ctest&lt;-wblr.fit(ctest, method.fit="mle")
ctest&lt;-wblr.conf(ctest, method.conf="lrb",col="red")
fail2&lt;-c(10,40,40,50)
susp&lt;-c(20,60)
ctest2&lt;-wblr(fail2, susp)
ctest2&lt;-wblr.fit(ctest2, method.fit="mle")
ctest2&lt;-wblr.conf(ctest2, method.conf="lrb",col="blue")
## Not run: 
 plot_contour(list(ctest, ctest2))

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.wblr'>
S3 <code>wblr</code> Object Plotting on pretty canvax
</h2><span id='topic+plot.wblr'></span>

<h3>Description</h3>

<p>This function adds the <code>.wblr</code> method to <code><a href="graphics.html#topic+plot.default">plot.default</a></code>
from the <span class="pkg">graphics</span> package.
</p>
<p>Currently, the function plots the (life-)time observations, fits (if any)
and confidence bounds for B-lives (if any) of an
<code>wblr</code> object or a list of <code>wblr</code> objects on Weibull or
Lognormal probability paper. 
</p>
<p>For each fit in the (list of) <code>wblr</code> object(s), legends are added to
the plot, displaying the fit parameters and (if available) goodness-of-fit
indicators and confidence information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wblr'
plot(x, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.wblr_+3A_x">x</code></td>
<td>

<p>Object of class <code>"wblr"</code> or a list of <code>wblr</code> objects.
</p>
</td></tr>
<tr><td><code id="plot.wblr_+3A_...">...</code></td>
<td>

<p>Options for plotting the <code>wblr</code> object; see section &quot;Details&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>...</code> argument can be any graphical parameter that can be
supplied to <code><a href="graphics.html#topic+plot.default">plot.default</a></code>, and any option that can be
set by the function <code><a href="#topic+options.wblr">options.wblr</a></code>. The options set
in this way are applied to all graphical elements of the plot, overriding
any previously supplied options.<br />
</p>
<p>One can pass a list of <code>wblr</code> objects to <code>plot.wblr</code>; in
that case it is mandatory to use the full method name: <code>plot.wblr(...)</code>
and not <code>plot(...)</code>.<br />
</p>
<p>The calculated Weibull or Lognormal distribution fits are plotted
on Weibull probability paper by default, but by passing the argument
<code>canvas = "lognormal"</code> to the function, Lognormal paper is used.<br />
</p>
<p>When a <em>list</em> of wblr objects is passed, the plot window is generated
with the options of the first <code>wblr</code> object in the list.<br />
</p>
<p>Graphical controls typically used with <code>plot</code> or <code>plot.wblr</code>:
</p>

<dl>
<dt><code>canvas</code></dt><dd>
<p>The plotting canvas to be used. This does not necessarily have to match the fit distribution.
Only <code>"weibull"</code> (default) or <code>"lognormal"</code> are recognized.
</p>
</dd>
<dt><code>mar</code></dt><dd><p> Margins defaults to <code>c(5.1,4.1,5.1,2.1),</code>.
</p>
</dd>
<dt><code>main</code></dt><dd><p> Title, defaults to <code>"Probability Plot"</code>.
</p>
</dd>
<dt><code>main.contour</code></dt><dd><p> Contour plot title defaults to <code>"Contour Plot"</code>.
</p>
</dd>
<dt><code>sub</code></dt><dd><p> Subtitle defaults to <code>NULL</code>.
</p>
</dd>
<dt><code>sub.contour</code></dt><dd><p> Contour subtitle defaults to <code>NULL</code>.
</p>
</dd>
<dt><code>xlim</code></dt><dd><p> Plot x limits override to be presented as a vector c(lo,hi), default <code>NULL</code>.
</p>
</dd>
<dt><code>ylim</code></dt><dd><p> Plot y limits override to be presented as a vector c(lo,hi), default <code>NULL</code>.
</p>
</dd>
<dt><code>xlab</code></dt><dd><p> X axis label defaults to <code>"Time To Failure"</code>.
</p>
</dd>
<dt><code>ylab</code></dt><dd><p> Y axis label defaults to <code>"Unreliability [%]"</code>.
</p>
</dd>
<dt><code>coordinate.text.size</code></dt><dd><p> default <code>0.7</code>.
</p>
</dd>
<dt><code>signif</code></dt><dd><p> Used to control display of numbers in Legend, default <code>4</code>.
</p>
</dd>
<dt><code>col.grid</code></dt><dd><p> Color for chart gridlines defaults <code>"grey"</code>.
</p>
</dd>
<dt><code>is.plot.grid</code></dt><dd><p> default <code>TRUE</code>.
</p>
</dd>
<dt><code>is.plot.fit</code></dt><dd><p> default <code>TRUE</code>.
</p>
</dd>
<dt><code>is.plot.pp</code></dt><dd><p> default <code>TRUE</code>.
</p>
</dd>
<dt><code>is.plot.ppcoordinates</code></dt><dd><p> default <code>FALSE</code>.
</p>
</dd>
<dt><code>is.plot.legend</code></dt><dd><p> default <code>TRUE</code>.
</p>
</dd>
<dt><code>legend.position</code></dt><dd><p> default <code>"bottomright"</code>. See <code><a href="graphics.html#topic+legend">legend</a></code> Details.
</p>
</dd>
<dt><code>legend.inset</code></dt><dd><p> default <code>c(0,0)</code>. legend inset values are fractions of graph width and height.
</p>
</dd>
<dt><code>legend.text.size</code></dt><dd><p> default <code>0.7</code>.
</p>
</dd>
<dt><code>label</code></dt><dd><p> defaults to <code>""</code>.
</p>
</dd>
<dt><code>in.legend</code></dt><dd><p> default <code>TRUE</code>.
</p>
</dd>
<dt><code>in.legend.blives</code></dt><dd><p> default <code>TRUE</code>.
</p>
</dd>
<dt><code>in.legend.gof</code></dt><dd><p> default <code>TRUE</code>.
</p>
</dd>
<dt><code>is.plot.cb</code></dt><dd><p> default <code>TRUE</code>.
</p>
</dd>
<dt><code>persistent</code></dt><dd><p> default <code>TRUE</code>.
</p>
</dd>
</dl>



<h3>Value</h3>

<p>Currently, the function returns no value.
</p>


<h3>References</h3>

<p>Jurgen Symynck, Filip De Bal, Weibull analysis using R, in a nutshell (New Technologies and Products in Machine Manufacturing Technology, Stefan cel Mare University of Suceava, 2010).
</p>
<p>Jurgen Symynck, Filip De Bal, Monte Carlo pivotal confidence bounds for Weibull analysis, with implementations in R (New Technologies and Products in Machine Manufacturing Technology, Stefan cel Mare University of Suceava, 2011).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>options.wblr(blives=0.1) # make the legend boxes a bit shorter...
da2 &lt;- wblr.conf(wblr.fit(wblr(runif(5,10,100),col="red")))
da3 &lt;- wblr.conf(wblr.fit(wblr(rweibull(5,2,1000),col="green4",pch=3)))
da4 &lt;- wblr.conf(wblr.fit(wblr(rlnorm(5,log(500),log(2)),col="blue3",pch=8),
    dist="lognormal"))
## Not run: 
plot.wblr(list(da2,da3,da4),xlim=c(1,1e6),
    main="Uniformly distributed observations")

## End(Not run)
</code></pre>

<hr>
<h2 id='rba'>Reduced Bias Adjustment for Weibull and Lognormal MLE</h2><span id='topic+rba'></span>

<h3>Description</h3>

<p><code>rba</code> This function generates reduction factors based on the median bias of the Weibull Beta parameter MLE (C4^3.5),
alternatively based on the mean bias(C4^6), and a single factor for both median and mean of the symmetrical lognormal distribution.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'> rba(Qx, dist="weibull", basis="median")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rba_+3A_qx">Qx</code></td>
<td>
<p>The quantity of failures in data (right-censored data, or suspensions excluded)</p>
</td></tr>
<tr><td><code id="rba_+3A_dist">dist</code></td>
<td>
<p>A string defining a distribution to be fit. Implemented distributions are &quot;weibull&quot; (default) and &quot;lognormal&quot;.
</p>
</td></tr>
<tr><td><code id="rba_+3A_basis">basis</code></td>
<td>
<p>a string value indicating the basis for bias reduction, &quot;median&quot; is the default, but &quot;mean&quot; may be chosen.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Many references discuss the bias reduction in terms of mean reduction.  Abernethy has promoted consideration of the
RBA in terms of median bias reduction.
</p>


<h3>Value</h3>

<p>A factor to be multiplied to the MLE Beta or log-Sigma for bias reduction.
</p>


<h3>References</h3>

<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
MLEfit&lt;-mlefit(mleframe(failures,suspensions))
MLE_RBA&lt;-c(MLEfit[1],MLEfit[2]*rba(length(failures)))
</code></pre>

<hr>
<h2 id='wblr'>
Create a <code>wblr</code> Object for Life Data Analysis
</h2><span id='topic+wblr'></span>

<h3>Description</h3>

<p>This function creates an object of class <code>"wblr"</code> for further processing
by the other functions of <span class="pkg">wblr</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wblr(x, s=NULL, interval=NULL,...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wblr_+3A_x">x</code></td>
<td>

<p>Either a dataframe containing at least <code>$time</code> and <code>$event</code>
columns and optionally a <code>$qty</code> column, or a vector of class <code>"numeric"</code> or <code>"integer"</code> with
(life-)time observations.
</p>
</td></tr>
<tr><td><code id="wblr_+3A_s">s</code></td>
<td>

<p>An optional vector of right-censored data, or suspensions. 
</p>
</td></tr>
<tr><td><code id="wblr_+3A_interval">interval</code></td>
<td>

<p>An optional dataframe of interval data having columns specifically named &quot;left&quot; and &quot;right&quot;. 
Left values are the last time at which no failure was evident and may be zero for discovery.
Right values are the earliest time at which failure was observed.
</p>
</td></tr>
<tr><td><code id="wblr_+3A_...">...</code></td>
<td>

<p>Graphical options for plotting the <code>wblr</code> object.
See section &quot;Details&quot; for other data passing arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are several methods to passing arguments for building an <code>wblr</code>
object.
</p>

<ul>
<li><p> If argument <code>x</code> is of class <code>"data.frame"</code>,
then it must contain <code>$time</code> and <code>$event</code>
columns. Additional columns in the dataframe will be ignored.
</p>
</li>
<li><p> When a single unnamed vector of class <code>"numeric"</code>
or <code>"integer"</code> is supplied, it is treated as a vector
of (life-)time observations.
</p>
</li>
<li><p> If argument <code>time</code> or <code>fail</code> is provided, it is treated as
a vector of (life-)time observations. Take care NOT to supply both
<code>time</code> and <code>fail</code> in the same function call.
</p>
</li>
<li><p> If argument <code>event</code> is provided, it is treated as
a vector of event indicators with possible values of
<code>0</code> and <code>1</code>. See section &quot;Value&quot; for more details on
event vectors.
</p>
</li>
<li><p> If the <code>x</code> argument is not provided as a dataframe and <code>susp</code> is provided, 
it is treated as a vector of right-censored (life-)time observations 
(also called suspended observations or suspensions).
</p>
</li></ul>

<p><code>wblr</code> always generates (probability) plot positions for graphically
displaying the (life-)time observations and for (possible) later usage
by <code><a href="#topic+wblr.fit">wblr.fit</a></code>. The following optiona arguments are most appropriate for
passing in with <code>wblr</code>:
</p>

<dl>
<dt><code>dist</code></dt><dd>
<p>A character string defining the distribution target. When used to establish the basis for
contour mapping (without using <code><a href="#topic+wblr.conf">wblr.conf</a></code> with method.conf=&quot;lrb&quot;) only &quot;weibull&quot; (default)
and &quot;lognormal&quot; are recognized.<br />
Also used with <code><a href="#topic+wblr.fit">wblr.fit</a></code> for specific fitting control.
</p>
</dd>
<dt><code>pp</code></dt><dd>
<p>Plotting position method, it is a character string describing the method of determining
vertical plot positions. Implemented methods are &quot;median&quot; (default), &quot;benard&quot;,&quot;hazen&quot;,&quot;mean&quot;, &quot;kaplan-meier&quot;, and &quot;blom&quot;.
</p>
</dd>
<dt><code>rank.adj</code></dt><dd>
<p>The method employed for determining rank of failures when suspensions (right censored data)
are present in the data set. Implemented methods are &quot;johnson&quot; (default) and &quot;KMestimator&quot;.
</p>
</dd>
<dt><code>ties.handler</code></dt><dd>
<p>The method employed for handling duplicate values in the data set.<br />
Implemented methods are &quot;none&quot; (default) &quot;highest&quot;, &quot;lowest&quot;, &quot;mean&quot;, and &quot;sequential&quot;.<br />
It is expected that ties handling will be applied to large data sets that will be fitted
using the maximum likelihood estimation method, where the effect is only on the graphical
presentation. Employing a ties handler on a rank regression model will effectively remove data
from the data set, which is likely not intended.<br />
Use of simply <code>ties</code> as an argument to function <code>wblr</code> will silently be accepted as <code>ties.handler</code>.
</p>
</dd>
<dt>Options for graphical control over data points see <code><a href="graphics.html#topic+par">par</a></code></dt><dd>

<ul>
<li><p><code>pch</code> Point choice defaults to <code>1</code>. For more info, see
<code><a href="graphics.html#topic+points">points</a></code>.

</p>
</li>
<li><p><code>cex.points</code> Point size defaults to <code>1</code>.

</p>
</li>
<li><p><code>lwd.points</code> Line width defaults to <code>2</code>.

</p>
</li></ul>

</dd>
<dt>Independent graphical control over interval lines</dt><dd>

<ul>
<li><p><code>interval.col</code> Color defaults to <code>"black"</code>.

</p>
</li>
<li><p><code>interval.lty</code> Line type, defaults to <code>"dashed"</code>.

</p>
</li>
<li><p><code>interval.lwd</code> Line width defaults to <code>1</code>.

</p>
</li></ul>

</dd>
</dl>

<p>Subsequent calls to <code>wblr.fit</code> and <code>wblr.conf</code> will inherit these options.
</p>


<h3>Value</h3>

<p>A named list of class <code>"wblr"</code>. The first list
item (<code>$data</code>) is a list with up to least three items:
</p>

<dl>
<dt><code>$lrq_frame</code></dt><dd>
<p>A dataframe containing the provided data formatted with <code>"left"</code>, <code>"right"</code>, and <code>"qty"</code> columns.
This is the output of WeibullR function <code>"mleframe"</code>.
</p>
</dd>
<dt><code>$data$dpoints</code></dt><dd>
<p>A dataframe contianing graphical data for exact failure point with their probability plotting positions and adjusted ranks.
</p>
</dd>
<dt><code>$data$dlines</code></dt><dd>
<p>If interval data has been provided this dataframe will contain the graphical data for display 
similar to <code>$data$dpoints</code>, but with endpoints t1 and t2 for the interval.
</p>
</dd>
</dl>



<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>
<p>Jurgen Symynck, Filip De Bal, Weibull analysis using R, in a nutshell (New Technologies and Products in Machine Manufacturing Technology, Stefan cel Mare University of Suceava, 2010).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## These code lines all generate the same object ##
wblr(c(500,1200,900,1300,510))
wblr(time=c(500,1200,900,1300,510))
## this input format works, but not recommended.
wblr(time=c(500,1200,900,1300,510),event=c(1,1,1,1,1))
wblr(fail=c(500,1200,900,1300,510))
wblr(fail=c(500,1200,900,1300,510),susp=c())
da1 &lt;- data.frame(
    serial=c("S12","S16","S17","S3","S5"),
    time=c(500,1200,900,1300,510),
    event=c(1,1,1,1,1))
## it is best practice set named objects
obj1 &lt;- wblr(da1,label="complete dataset",pch=3,col="orange3")
obj2 &lt;- wblr(da1,label="complete dataset",pch=4,pp="benard",col="red")


## Generate a similar dataset, but with suspensions ##
wblr(time=c(500,1200,900,1300,510),event=c(1,1,1,0,0))
wblr(data.frame(time=c(500,1200,900,1300,510),event=c(1,1,1,0,0)))
wblr(fail=c(500,1200,900),susp=c(1300,510))
wblr(time=c(500,1200,900),susp=c(1300,510))
da3 &lt;- wblr(fail=c(500,1200,900,1300,510),
    event=c(1,1,1,0,0),label="censored dataset",pch=1,col="blue")

## plot datasets ##
## Not run: 
plot.wblr(list(da1,da3))

## End(Not run)

</code></pre>

<hr>
<h2 id='wblr.conf'>Add Confidence Interval Bounds to <code>wblr</code> Objects</h2><span id='topic+wblr.conf'></span>

<h3>Description</h3>

<p>This function adds confidence calculations to the last fit entity in a <code>wblr</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wblr.conf(x,...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wblr.conf_+3A_x">x</code></td>
<td>
<p>Object of class <code>"wblr"</code>.</p>
</td></tr>
<tr><td><code id="wblr.conf_+3A_...">...</code></td>
<td>
<p>Options for calculating confidence, and for plotting the results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function adds confidence calculations to the last fit entity in a
<code>wblr</code> object and adds the result to the object alongside any pre-existing
confidence calculations.<br />
</p>
<p>Certain confidence calculations pertain to specific fit methods. The pivotal.rr confidence method
can only apply to a rank regression fit, while a likelihood ratio calculation can only be
performed on an mle fit.<br />
</p>
<p>Option arguments suitable for passing into wblr.conf:
</p>

<dl>
<dt><code>method.conf</code></dt><dd>
<p>A character string describing the techniques used for calculating confidence interval bounds.
Implemented methods are &quot;pivotal-rr&quot; (default), &quot;bbb&quot;, &quot;fm&quot; &quot;fmbounds&quot;, and &quot;lrb&quot;.
Methods must conform to the method.fit in the wblr.fit call immediately preceding the wblr.conf call.
Method &quot;pivotal-rr&quot; requires a rank regression fit method. Methods &quot;fm&quot;, &quot;fmbounds, and &quot;lrb&quot; require a mle based fit.
</p>
</dd>
<dt><code>dq</code></dt><dd>
<p>A named series of quantiles at which confidence interval bounds will be calculated.
</p>

<ul>
<li><p><code>"abrem"</code> 
Default. This is the original default by Jurgen Symynck for predecessor package abrem
it produces evenly spaced points across the y limits of a weibull canvas
attempting to hold a constant number of points (see <code>num_dq</code> below).

</p>
</li>
<li><p><code>"minitab"</code> 
Quantiles matching Minitab(TM) unchangeable defaults (27 values).

</p>
</li>
<li><p><code>"supersmith"</code> 
Quantiles for comparison with SuperSMITH(TM) (limit of 15 values)

</p>
</li>
<li><p><code>"user"</code> 
Provides for a user defined series of quantiles. (see <code>user_dq</code> below).

</p>
</li></ul>

</dd>
<dt><code>num_dq</code></dt><dd>
<p>The number of points used for the <code>"abrem"</code> dq determination.
</p>
</dd>
<dt><code>user_dq</code></dt><dd>
<p>A vector of quantiles set by user. Default <code>c(seq(.01,.09,by=.01),seq(.10,.90,by=.10),seq(.91,.99, by=.01))</code>.
</p>
</dd>
<dt><code>ci</code></dt><dd>
<p>The double-sided confidence interval, also chi sq confidence level for likelihood ratio.
Must be in a range &lt;1 &amp;&amp; &gt;0, default is <code>0.9</code>.
</p>
</dd>
<dt><code>blife.pts</code></dt><dd>
<p>The probability points at which to report Blife on legend.
</p>
</dd>
<dt>Specific controls for pivotal analysis only</dt><dd>

<ul>
<li><p><code>seed</code>
The RNG seed integer such that results are duplicated between runs, default is <code>1234</code>.

</p>
</li>
<li><p><code>S</code>
The number of samples to be run during pivotal analysis, default is <code>1e4</code>.

</p>
</li></ul>

</dd>
<dt>Specific controls for likelihood ratio contour and bounds only</dt><dd>

<ul>
<li><p><code>dof</code>
The degrees of freedom, <code>dof=1</code> (default) for confidence interval, <code>dof=2</code> for comparison.

</p>
</li>
<li><p><code>ptDensity</code>
The number of points calculated to form the contour outline, default is <code>120</code>.

</p>
</li></ul>

</dd>
</dl>

<p>Additionally, graphical control options for the confidence interval bounds can be passed in with the following options:
</p>
 
<ul>
<li><p><code>col</code> Color defaults to <code>"black"</code>.

</p>
</li>
<li><p><code>lty</code> Line type, defaults to <code>"solid"</code>.

</p>
</li>
<li><p><code>lwd</code> Line width defaults to <code>2</code>.

</p>
</li></ul>

<p>Subsequent calls to <code>wblr.fit</code> and <code>wblr.conf</code> will inherit these options.
</p>


<h3>Value</h3>

<p>The function returns its argument <code>x</code>, extended with the confidence
calculations and any optional graphical and calculation arguments
as passed to the function.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## full dataset ##
da1 &lt;- wblr(runif(10,100,1e4),label="Complete data")
da1 &lt;- wblr.fit(da1)
da1 &lt;- wblr.conf(da1,method.conf="pivotal-rr",col="red")
da1 &lt;- wblr.conf(da1,method.conf="bbb",col="orange")
da1 &lt;- wblr.fit(da1, method.fit="mle")
da1 &lt;- wblr.conf(da1,method.conf="lrb",col="yellow3")

## plot datasets ##
## Not run: 
plot(da1,main="Comparison between different bound types.")

## End(Not run)

## with right-censored data
da2 &lt;- runif(8,100,1e4)
da2 &lt;- wblr(fail=da2,susp=rep(max(da2),2),label="Type II right-censored data")
da2 &lt;- wblr.fit(da2)
da2 &lt;- wblr.conf(da2,method.conf="pivotal-rr",col="blue1")
da2 &lt;- wblr.conf(da2,method.conf="bbb",col="steelblue")
da2 &lt;- wblr.fit(da2, method.fit="mle")
da2 &lt;- wblr.conf(da2,method.conf="lrb",col="cyan3")
## Not run: 
plot(da2,main="Comparison between different bound types with right-censored data.")

## End(Not run)
</code></pre>

<hr>
<h2 id='wblr.fit'>
Add Fit Distributions to <code>wblr</code> Objects
</h2><span id='topic+wblr.fit'></span>

<h3>Description</h3>

<p>This function fits probability distributions to <code>wblr</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wblr.fit(x, modify.by.t0=FALSE, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wblr.fit_+3A_x">x</code></td>
<td>

<p>Object of class <code>"wblr"</code>.
</p>
</td></tr>
<tr><td><code id="wblr.fit_+3A_modify.by.t0">modify.by.t0</code></td>
<td>

<p>A logical value to signifying whether to revise object data by subtraction of the &quot;t0&quot; (translation) parameter of a 3-parameter fit.
A value of TRUE generates a linearized view of the fit on its base distribution canvas. It is recommended that
the resulting object have an altered name perhaps adding a &quot;.3p&quot; suffix to the original wblr object to preserve original data.
</p>
</td></tr>
<tr><td><code id="wblr.fit_+3A_...">...</code></td>
<td>

<p>Options for fitting the (life-)time observations, and for plotting the results.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates fits for the (life-)time observations in the
<code>wblr</code> object and adds them to the object alongside any
pre-existing fits.
</p>
<p>Fitting options are passed with the <code>dist</code> and <code>method.fit</code>
arguments:
</p>

<dl>
<dt><code>dist</code></dt><dd>
<p>A character string with the target distribution for fitting.
Possible values are <code>"weibull"</code>, <code>"weibull2p"</code>,
<code>"weibull3p"</code> (three parameter Weibull), <code>"lognormal"</code>
, <code>"lognormal2p"</code>or <code>"lognormal3p"</code>.
</p>
<p>Defaults to <code>"weibull"</code>.
</p>
</dd>
<dt><code>in.legend</code></dt><dd>
<p>Logical value controlling the inclusion of various elements in 
the legend. 
</p>
<p>If <code>in.legend=FALSE</code> is passed,
the resulting fit calculations will be omitted from the legend, 
leaving only observation summary data.
</p>
<p>Defaults to <code>TRUE</code>.
</p>
</dd>
<dt><code>method.fit</code></dt><dd>
<p>A vector of class <code>"character"</code> with fitting options.
</p>
<p>Defaults to <code>"rr-xony"</code>.
</p>

<ul>
<li> <p><code>"rr"</code>: Rank Regression (RR). Depending on the method for
calculating probability plot positions chosen during the creation of the
<code>wblr</code> object (see option <code>pp</code> and
function <code><a href="#topic+wblr">wblr</a></code>), this can
either be &quot;exact median rank regression&quot; or
&quot;Benard's approximate median rank regression&quot;.
If this method is used then it is mandatory to additionally specify
either X-on-Y or Y-on-X regression.
</p>
</li>
<li> <p><code>"xony"</code>,<code>"yonx"</code>: Differentiate between X-on-Y and Y-on-X
regression, respectively. For rank regression in lifetime analysis,
it is best practice to use the X values ((life-)time observations)
as the response variables whose horizontal distance to the fit line
must be minimized, and the Y values (unreliabilities) as the
explanatory variable.
</p>
</li>
<li> <p><code>"mle"</code>: Maximum Likelihood Estimation (MLE), using
many functions of the <span class="pkg">debias</span> package.
</p>
</li>
<li> <p><code>"mle-rba"</code>: Maximum Likelihood Estimation with Reduced Bias Adjustment
as popularized by Abernethy based on the median bias of MLE fitted distributions.
</p>
</li>
<li> <p><code>"mle-unbias"</code>: Maximum Likelihood Estimation with bias adjustment
as popularized by Reliasoft software based on the mean bias of MLE fitted distributions.
</p>
</li></ul>

</dd>
</dl>
<p>Additionally, one can pass any options available from <code>options.wblr</code>,
such as <code>col</code> or <code>is.plot.legend</code>. The graphical options
will be used when plotting the (life-)time observations using <code>plot.wblr</code>.
Subsequent calls to <code>wblr.conf</code> will inherit these options.
</p>
<p>Currently, there is no graceful error recovery after attempting to fit
lifetime data including negative time observations, for example 
<code>wblr.fit(wblr(-5:10)).</code>
</p>



<h3>Value</h3>

<p>The function returns its argument object <code>x</code>, extended with the
calculated fit and the optional graphical and calculation arguments as
provided to the function.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>
<p>Marie Laure Delignette-Muller, Christophe Dutang (2015). &quot;fitdistrplus: An R Package for Fitting Distributions&quot;.
Journal of Statistical Software, 64(4), 1-34. URL http://www.jstatsoft.org/v64/i04/.
</p>

<hr>
<h2 id='wblrLoglike'>Log likelihood for Weibull and Lognormal fitted data including intervals</h2><span id='topic+wblrLoglike'></span>

<h3>Description</h3>

<p>This function generates the Log likelihood for Wiebull and lognormal distributions from life(-time)
data containing fixed time occurrences, and suspensions (progressive right-censored data), discoveries (left-censored data),
and interval censored data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wblrLoglike(par, x, dist="weibull", sign=1, tz=0 )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wblrLoglike_+3A_par">par</code></td>
<td>
<p>A vector of parameters taken in the same order as the underlying R distribution.
That is, for weibull the order of parameters is (shape, scale).  For lognormal (meanlog, sdlog).
(Unsuitable parameters cannot be pre-tested, but may cause the function to fail with NaN, or inf values.)
</p>
</td></tr>
<tr><td><code id="wblrLoglike_+3A_x">x</code></td>
<td>
<p>A dataframe such as generated by mleframe with column names 'left', 'right' and optionally 'qty'.
Exact failure data (occurrences) have same time entered in both 'left' and 'right' columns.
Suspension data has last known life[time] entered in 'left' column and -1 entered in 'right' column.
The left(early) interval bound for left-censored data must be entered as zero. (NA is not accepted).
</p>
</td></tr>
<tr><td><code id="wblrLoglike_+3A_dist">dist</code></td>
<td>
<p>A string defining a distribution to be fit. Implemented distributions are &quot;weibull&quot; (default) and &quot;lognormal&quot;.
(Only 2-parameter models are accepted.)
</p>
</td></tr>
<tr><td><code id="wblrLoglike_+3A_sign">sign</code></td>
<td>
<p>An integer of 1 or -1 assigning a multiplier for the returned value. A value of -1 results in a minimization
function suitable for use as an argument to optim.
</p>
</td></tr>
<tr><td><code id="wblrLoglike_+3A_tz">tz</code></td>
<td>
<p>A scalar vector with the translation parameter, t0, to be applied to data.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a scalar vector holding the value of log-likelihood.  Unsuitable parameters may cause generation of NaN.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>Marie Laure Delignette-Muller, Christophe Dutang (2015). &quot;fitdistrplus: An R Package for Fitting Distributions&quot;.
Journal of Statistical Software, 64(4), 1-34. URL http://www.jstatsoft.org/v64/i04/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>failures&lt;-c(90,96,30,49,82)
suspensions&lt;-c(100,45,10)
weibull_loglike&lt;-wblrLoglike(c( 2.26, 4900), mleframe(failures,suspensions))
</code></pre>

<hr>
<h2 id='weibayes'>
Fitting for Minimal Failure Datasets
</h2><span id='topic+weibayes'></span>

<h3>Description</h3>

<p>A simplistic fitting method also called &quot;1-parameter Weibull&quot; based on a &quot;prior&quot; known beta value. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibayes(x, s=NULL, beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weibayes_+3A_x">x</code></td>
<td>

<p>Either a vector of class <code>"numeric"</code> or <code>"integer"</code> with
(life-)time observations, or a dataframe containing at least <code>$time</code> and <code>$event</code>
columns and optionally a <code>$qty</code> column.
</p>
</td></tr>
<tr><td><code id="weibayes_+3A_s">s</code></td>
<td>
<p>An optional vector of suspension data.</p>
</td></tr>
<tr><td><code id="weibayes_+3A_beta">beta</code></td>
<td>

<p>A weibull shape parameter based on prior like kind study.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements a very simplistic relationship defined by two lines of R code:<br />
<code>t_eta&lt;-(times^beta)/nfail</code><br />
<code>out_val&lt;-sum(t_eta)^(1/beta)</code><br />
Note: for a single failure dataset, with beta = 1, the return is simply the sum of the failure time value plus sum of all suspension times.
Should no failures exist, then the nfail will be set to 1 for a pessimistic solution.<br />
</p>


<h3>Value</h3>

<p>Returns the Weibull scale, Eta, paramater value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fail&lt;-5
susp&lt;-rweibull(10, 1, 10)
eta&lt;-weibayes(fail, susp, beta=1)
</code></pre>

<hr>
<h2 id='weibayes.mle'>
Fitting for Minimal Failure Datasets using likelihood optimization
</h2><span id='topic+weibayes.mle'></span>

<h3>Description</h3>

<p>An optimized search method for &quot;1-parameter Weibull&quot; modeling based on a &quot;prior&quot; known beta, or eta value. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibayes.mle(x, beta=NULL, eta=NULL, incr=1e-7, listout=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weibayes.mle_+3A_x">x</code></td>
<td>
<p>A dataframe such as generated by mleframe with column names 'left', 'right' and optionally 'qty'.
Exact failure data (occurrences) have same time entered in both 'left' and 'right' columns.
Suspension data has last known life[time] entered in 'left' column and -1 entered in 'right' column.
The left(early) interval bound for left-censored data must be entered as zero. (NA is not accepted).
</p>
</td></tr>
<tr><td><code id="weibayes.mle_+3A_beta">beta</code></td>
<td>

<p>A weibull shape parameter based on prior like kind study.
</p>
</td></tr>
<tr><td><code id="weibayes.mle_+3A_eta">eta</code></td>
<td>

<p>A weibull scope parameter based on prior like kind study.
</p>
</td></tr>
<tr><td><code id="weibayes.mle_+3A_incr">incr</code></td>
<td>

<p>An increment used to establish the slope of the contour at given points.
</p>
</td></tr>
<tr><td><code id="weibayes.mle_+3A_listout">listout</code></td>
<td>

<p>A logical determining whether details of the optimization loop should be presented in a list output. (For debugging purposes.)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function searches the contour map to identify the local maximum liklihood on a given axis through the contour. 
Since this function takes the lrq_frame for data input, it will handle interval data as well as exact time failures and suspensions.
This function has been written in pure R, hence, is expected to be too slow for production work. It is intended to be usefull
as a study tool.
</p>


<h3>Value</h3>

<p>Returns either the Weibull scale, Eta, paramater value if known beta is provided, 
or the Weibull shape, Beta, parameter if knonw eta is provided.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fail&lt;-5
susp&lt;-rweibull(10, 1, 10)
eta&lt;-weibayes.mle(mleframe(fail, susp), beta=1)
</code></pre>

<hr>
<h2 id='xbounds'>
Extract a bounds dataframe from a <code>wblr</code> Object
</h2><span id='topic+xbounds'></span>

<h3>Description</h3>

<p>Creates a list of bounds and ,if appropriate, t0 modifier from a <code>wblr</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xbounds(obj, fit_num=1, conf_num)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xbounds_+3A_obj">obj</code></td>
<td>

<p>An object created by wblr and the result of at least one modifying wblr.fit call.
</p>
</td></tr>
<tr><td><code id="xbounds_+3A_fit_num">fit_num</code></td>
<td>

<p>The numbered fit in the wblr object.
</p>
</td></tr>
<tr><td><code id="xbounds_+3A_conf_num">conf_num</code></td>
<td>

<p>The numbered confidence calculation in the specified fit of the wblr object.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list holding the bounds dataframe and, if modified.by.t0, the t0 value as extracted from the <code>wblr</code> object.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>
<p>Jurgen Symynck, Filip De Bal, Weibull analysis using R, in a nutshell (New Technologies and Products in Machine Manufacturing Technology, Stefan cel Mare University of Suceava, 2010).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	obj&lt;-wblr.fit(wblr(rweibull(10,1,1)))
	obj&lt;-wblr.conf(obj)
	xbounds(obj)
</code></pre>

<hr>
<h2 id='xfit'>
Extract a Fit Summary from a <code>wblr</code> Object
</h2><span id='topic+xfit'></span>

<h3>Description</h3>

<p>Creates a list of distribution and fit elements from a <code>wblr</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xfit(obj, fit_num=1)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xfit_+3A_obj">obj</code></td>
<td>

<p>An object created by wblr and the result of at least one modifying wblr.fit call.
</p>
</td></tr>
<tr><td><code id="xfit_+3A_fit_num">fit_num</code></td>
<td>

<p>The numbered fit in the wblr object.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list holding <code>dist</code> the distribution name and <code>fit</code> a vector as extracted from the <code>wblr</code> object.
</p>


<h3>References</h3>

<p>William Q. Meeker and Luis A. Escobar, (1998) &quot;Statistical Methods for Reliability Data&quot;, Wiley-Interscience, New York
</p>
<p>Robert B. Abernethy, (2008) &quot;The New Weibull Handbook, Fifth Edition&quot; 
</p>
<p>John I. McCool, (2012) &quot;Using the Weibull Distribution: Reliability, Modeling and Inference&quot;
</p>
<p>Jurgen Symynck, Filip De Bal, Weibull analysis using R, in a nutshell (New Technologies and Products in Machine Manufacturing Technology, Stefan cel Mare University of Suceava, 2010).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	obj&lt;-wblr.fit(wblr(rweibull(10,1,1)))
	xfit(obj)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
