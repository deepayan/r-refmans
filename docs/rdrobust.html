<!DOCTYPE html><html><head><title>Help for package rdrobust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rdrobust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rdbwselect'><p>Bandwidth Selection Procedures for Local Polynomial Regression Discontinuity Estimators</p></a></li>
<li><a href='#rdbwselect_2014'><p>Deprecated Bandwidth Selection Procedures for Local-Polynomial Regression-Discontinuity Estimators.</p></a></li>
<li><a href='#rdplot'><p>Data-Driven Regression Discontinuity Plots</p></a></li>
<li><a href='#rdrobust'><p>Local-Polynomial RD Estimation with Robust Confidence Intervals</p></a></li>
<li><a href='#rdrobust_RDsenate'><p>RD Senate Data</p></a></li>
<li><a href='#rdrobust-package'><p>Robust Data-Driven Statistical Inference in RD Designs</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Data-Driven Statistical Inference in
Regression-Discontinuity Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastian Calonico &lt;sebastian.calonico@columbia.edu&gt;, Matias D. Cattaneo &lt;cattaneo@princeton.edu&gt;, Max H. Farrell &lt;maxhfarrell@ucsb.edu&gt;, Rocio Titiunik &lt;titiunik@princeton.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sebastian Calonico &lt;sebastian.calonico@columbia.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Regression-discontinuity (RD) designs are quasi-experimental research designs popular in social, behavioral and natural sciences. The RD design is usually employed to study the (local) causal effect of a treatment, intervention or policy. This package provides tools for data-driven graphical and analytical statistical inference in RD	designs: rdrobust() to construct local-polynomial point estimators and robust confidence intervals for average treatment effects at the 	cutoff in Sharp, Fuzzy and Kink RD settings, rdbwselect() to perform bandwidth selection for the different procedures implemented, and rdplot() to conduct exploratory data analysis (RD plots).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, MASS</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-03 17:15:53 UTC; SC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-03 20:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rdbwselect'>Bandwidth Selection Procedures for Local Polynomial Regression Discontinuity Estimators</h2><span id='topic+rdbwselect'></span><span id='topic+print.rdbwselect'></span><span id='topic+summary.rdbwselect'></span>

<h3>Description</h3>

<p><code><a href="#topic+rdbwselect">rdbwselect</a></code> implements bandwidth selectors for local polynomial Regression Discontinuity (RD) point estimators and inference procedures developed in Calonico, Cattaneo and Titiunik (2014a), Calonico, Cattaneo and Farrell (2018), Calonico, Cattaneo, Farrell and Titiunik (2019) and Calonico, Cattaneo and Farrell (2020).
</p>
<p>Companion commands are: <code><a href="#topic+rdrobust">rdrobust</a></code> for point estimation and inference procedures, and <code><a href="#topic+rdplot">rdplot</a></code> for data-driven RD plots (see Calonico, Cattaneo and Titiunik (2015a) for details).
</p>
<p>A detailed introduction to this command is given in Calonico, Cattaneo and Titiunik (2015b) and Calonico, Cattaneo, Farrell and Titiunik (2019). A companion <code>Stata</code> package is described in Calonico, Cattaneo and Titiunik (2014b).
</p>
<p>For more details, and related Stata and R packages useful for analysis of RD designs, visit <a href="https://rdpackages.github.io/">https://rdpackages.github.io/</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdbwselect(y, x, c = NULL,  fuzzy = NULL, 
              deriv = NULL, p = NULL, q = NULL, 
              covs = NULL, covs_drop = TRUE, ginv.tol = 1e-20,
              kernel = "tri", weights = NULL, bwselect = "mserd", 
              vce = "nn",  cluster = NULL, nnmatch = 3, 
              scaleregul = 1, sharpbw = FALSE, 
              all = NULL, subset = NULL, 
              masspoints = "adjust", bwcheck = NULL,
              bwrestrict = TRUE, stdvars = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rdbwselect_+3A_y">y</code></td>
<td>
<p>is the dependent variable.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_x">x</code></td>
<td>
<p>is the running variable (a.k.a. score or forcing variable).</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_c">c</code></td>
<td>
<p>specifies the RD cutoff in <code>x</code>; default is <code>c = 0</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_fuzzy">fuzzy</code></td>
<td>
<p>specifies the treatment status variable used to implement fuzzy RD estimation (or Fuzzy Kink RD if <code>deriv=1</code> is also specified). Default is Sharp RD design and hence this option is not used.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_deriv">deriv</code></td>
<td>
<p>specifies the order of the derivative of the regression functions to be estimated. Default is <code>deriv=0</code> (for Sharp RD, or for Fuzzy RD if <code>fuzzy</code> is also specified). Setting <code>deriv=1</code> results in estimation of a Kink RD design (up to scale), or Fuzzy Kink RD if <code>fuzzy</code> is also specified.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_p">p</code></td>
<td>
<p>specifies the order of the local-polynomial used to construct the point-estimator; default is <code>p = 1</code> (local linear regression).</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_q">q</code></td>
<td>
<p>specifies the order of the local-polynomial used to construct the bias-correction; default is <code>q = 2</code> (local quadratic regression).</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_covs">covs</code></td>
<td>
<p>specifies additional covariates to be used for estimation and inference.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_covs_drop">covs_drop</code></td>
<td>
<p>if TRUE, it checks for collinear additional covariates and drops them. Default is TRUE.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_ginv.tol">ginv.tol</code></td>
<td>
<p>tolerance used to invert matrices involving covariates when <code>covs_drop=TRUE</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_kernel">kernel</code></td>
<td>
<p>is the kernel function used to construct the local-polynomial estimator(s). Options are <code>triangular</code> (default option), <code>epanechnikov</code> and <code>uniform</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_weights">weights</code></td>
<td>
<p>is the variable used for optional weighting of the estimation procedure. The unit-specific weights multiply the kernel function.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_bwselect">bwselect</code></td>
<td>
<p>specifies the bandwidth selection procedure to be used. Options are:
</p>
<p><code>mserd</code> one common MSE-optimal bandwidth selector for the RD treatment effect estimator.
</p>
<p><code>msetwo</code> two different MSE-optimal bandwidth selectors (below and above the cutoff) for the RD treatment effect estimator.
</p>
<p><code>msesum</code> one common MSE-optimal bandwidth selector for the sum of regression estimates (as opposed to difference thereof).
</p>
<p><code>msecomb1</code> for min(<code>mserd</code>,<code>msesum</code>).
</p>
<p><code>msecomb2</code> for median(<code>msetwo</code>,<code>mserd</code>,<code>msesum</code>), for each side of the cutoff separately.
</p>
<p><code>cerrd</code> one common CER-optimal bandwidth selector for the RD treatment effect estimator.
</p>
<p><code>certwo</code> two different CER-optimal bandwidth selectors (below and above the cutoff) for the RD treatment effect estimator.
</p>
<p><code>cersum</code> one common CER-optimal bandwidth selector for the sum of regression estimates (as opposed to difference thereof).
</p>
<p><code>cercomb1</code> for min(<code>cerrd</code>,<code>cersum</code>).
</p>
<p><code>cercomb2</code> for median(<code>certwo</code>,<code>cerrd</code>,<code>cersum</code>), for each side of the cutoff separately.
</p>
<p>Note: MSE = Mean Square Error; CER = Coverage Error Rate.
Default is <code>bwselect=mserd</code>. For details on implementation see Calonico, Cattaneo and Titiunik (2014a), Calonico, Cattaneo and Farrell (2018), and Calonico, Cattaneo, Farrell and Titiunik (2017), and the companion software articles.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_vce">vce</code></td>
<td>
<p>specifies the procedure used to compute the variance-covariance matrix estimator.
Options are:
</p>
<p><code>nn</code> for heteroskedasticity-robust nearest neighbor variance estimator with <code>nnmatch</code> the (minimum) number of neighbors to be used.
</p>
<p><code>hc0</code> for heteroskedasticity-robust plug-in residuals variance estimator without weights.
</p>
<p><code>hc1</code> for heteroskedasticity-robust plug-in residuals variance estimator with <code>hc1</code> weights.
</p>
<p><code>hc2</code> for heteroskedasticity-robust plug-in residuals variance estimator with <code>hc2</code> weights.
</p>
<p><code>hc3</code> for heteroskedasticity-robust plug-in residuals variance estimator with <code>hc3</code> weights.
</p>
<p>Default is <code>vce=nn</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_cluster">cluster</code></td>
<td>
<p>indicates the cluster ID variable used for cluster-robust variance estimation with degrees-of-freedom weights. By default it is combined with <code>vce=nn</code> for cluster-robust nearest neighbor variance estimation. Another option is plug-in residuals combined with <code>vce=hc0</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_nnmatch">nnmatch</code></td>
<td>
<p>to be combined with for <code>vce=nn</code> for heteroskedasticity-robust nearest neighbor variance estimator with <code>nnmatch</code> indicating the minimum number of neighbors to be used. Default is <code>nnmatch=3</code></p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_scaleregul">scaleregul</code></td>
<td>
<p>specifies scaling factor for the regularization term added to the denominator of the bandwidth selectors. Setting <code>scaleregul = 0</code> removes the regularization term from the bandwidth selectors; default is <code>scaleregul = 1</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_sharpbw">sharpbw</code></td>
<td>
<p>option to perform fuzzy RD estimation using a bandwidth selection procedure for the sharp RD model. This option is automatically selected if there is perfect compliance at either side of the threshold.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_all">all</code></td>
<td>
<p>if specified, <code><a href="#topic+rdbwselect">rdbwselect</a></code> reports all available bandwidth selection procedures.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_masspoints">masspoints</code></td>
<td>
<p>checks and controls for repeated observations in the running variable. Options are:
</p>
<p>(i)  <code>off</code>: ignores the presence of mass points; 
</p>
<p>(ii) <code>check</code>: looks for and reports the number of unique observations at each side of the cutoff. 
</p>
<p>(iii) <code>adjust</code>: controls that the preliminary bandwidths used in the calculations contain a minimal number of unique observations. By default it uses 10 observations, but it can be manually adjusted with the option <code>bwcheck</code>). 
</p>
<p>Default option is <code>masspoints=adjust</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_bwcheck">bwcheck</code></td>
<td>
<p>if a positive integer is provided, the preliminary bandwidth used in the calculations is enlarged so that at least <code>bwcheck</code> unique observations are used.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_bwrestrict">bwrestrict</code></td>
<td>
<p>if <code>TRUE</code>, computed bandwidths are restricted to lie within the range of <code>x</code>; default is <code>bwrestrict = TRUE</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_+3A_stdvars">stdvars</code></td>
<td>
<p>if <code>TRUE</code>, <code>x</code> and <code>y</code> are standardized before computing the bandwidths; default is <code>stdvars = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>N</code></td>
<td>
<p>vector with sample sizes to the left and to the righst of the cutoff.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>cutoff value.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>order of the local-polynomial used to construct the point-estimator.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>order of the local-polynomial used to construct the bias-correction estimator.</p>
</td></tr>
<tr><td><code>bws</code></td>
<td>
<p>matrix containing the estimated bandwidths for each selected procedure.</p>
</td></tr>
<tr><td><code>bwselect</code></td>
<td>
<p>bandwidth selection procedure employed.</p>
</td></tr>
<tr><td><code>kernel</code></td>
<td>
<p>kernel function used to construct the local-polynomial estimator(s).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of California, Santa Barbara, CA. <a href="mailto:maxhfarrell@ucsb.edu">maxhfarrell@ucsb.edu</a>.
</p>
<p>Rocio Titiunik, Princeton University, Princeton, NJ.  <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2018. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2018_JASA.pdf">On the Effect of Bias Estimation on Coverage Accuracy in Nonparametric Inference.</a> <em>Journal of the American Statistical Association</em>, 113(522): 767-779. 
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2020. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Farrell_2020_ECTJ.pdf">Optimal Bandwidth Choice for Robust Bias Corrected Inference in Regression Discontinuity Designs.</a> <em>Econometrics Journal</em>, 23(2): 192-210.
</p>
<p>Calonico, S., M. D. Cattaneo, M. H. Farrell, and R. Titiunik. 2017. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Farrell-Titiunik_2017_Stata.pdf">rdrobust: Software for Regression Discontinuity Designs.</a> <em>Stata Journal</em> 17(2): 372-404.
</p>
<p>Calonico, S., M. D. Cattaneo, M. H. Farrell, and R. Titiunik. 2019. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Farrell-Titiunik_2019_RESTAT.pdf">Regression Discontinuity Designs using Covariates.</a> <em>Review of Economics and Statistics</em>, 101(3): 442-451. 
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2014a. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2014_ECMA.pdf">Robust Nonparametric Confidence Intervals for Regression-Discontinuity Designs.</a> <em>Econometrica</em> 82(6): 2295-2326.
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2014b. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2014_Stata.pdf">Robust Data-Driven Inference in the Regression-Discontinuity Design.</a> <em>Stata Journal</em> 14(4): 909-946.
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2015a. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2015_JASA.pdf">Optimal Data-Driven Regression Discontinuity Plots.</a> <em>Journal of the American Statistical Association</em> 110(512): 1753-1769.
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2015b. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2015_R.pdf">rdrobust: An R Package for Robust Nonparametric Inference in Regression-Discontinuity Designs.</a> <em>R Journal</em> 7(1): 38-51.
</p>
<p>Cattaneo, M. D., B. Frandsen, and R. Titiunik. 2015. <a href="https://rdpackages.github.io/references/Cattaneo-Frandsen-Titiunik_2015_JCI.pdf">Randomization Inference in the Regression Discontinuity Design: An Application to the Study of Party Advantages in the U.S. Senate.</a> <em>Journal of Causal Inference</em> 3(1): 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rdrobust">rdrobust</a></code>, <code><a href="#topic+rdplot">rdplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-runif(1000,-1,1)
y&lt;-5+3*x+2*(x&gt;=0)+rnorm(1000)
rdbwselect(y,x)
</code></pre>

<hr>
<h2 id='rdbwselect_2014'>Deprecated Bandwidth Selection Procedures for Local-Polynomial Regression-Discontinuity Estimators.</h2><span id='topic+rdbwselect_2014'></span><span id='topic+print.rdbwselect_2014'></span><span id='topic+summary.rdbwselect_2014'></span>

<h3>Description</h3>

<p><code><a href="#topic+rdbwselect_2014">rdbwselect_2014</a></code> is a deprecated command implementing three bandwidth selectors for local polynomial Regression Discontinuity (RD) point estimators and inference procedures, as described in Calonico, Cattaneo and Titiunik (2014).
</p>
<p>This command is no longer supported or updated, and it is made available only for backward compatibility purposes. Please use <code><a href="#topic+rdbwselect">rdbwselect</a></code> instead.
</p>
<p>The latest version of the rdrobust package includes the following commands:
<code><a href="#topic+rdrobust">rdrobust</a></code> for point estimation and inference procedures.
<code><a href="#topic+rdbwselect">rdbwselect</a></code> for data-driven bandwidth selection.
<code><a href="#topic+rdplot">rdplot</a></code> for data-driven RD plots.
</p>
<p>For more details, and related Stata and R packages useful for analysis of RD designs, visit <a href="https://rdpackages.github.io/">https://rdpackages.github.io/</a></p>


<h3>Usage</h3>

<pre><code class='language-R'>rdbwselect_2014(y, x, subset = NULL, c = 0, p = 1, q = 2, deriv = 0,
              rho = NULL, kernel = "tri", bwselect = "CCT", scaleregul = 1,
              delta = 0.5, cvgrid_min = NULL, cvgrid_max = NULL, 
              cvgrid_length = NULL, cvplot = FALSE, vce = "nn", matches = 3, 
              all = FALSE, precalc = TRUE )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rdbwselect_2014_+3A_y">y</code></td>
<td>
<p>is the dependent variable.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_x">x</code></td>
<td>
<p>is the running variable (a.k.a. score or forcing variable).</p>
</td></tr>  
<tr><td><code id="rdbwselect_2014_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_c">c</code></td>
<td>
<p>specifies the RD cutoff in <code>x</code>; default is <code>c = 0</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_p">p</code></td>
<td>
<p>specifies the order of the local-polynomial used to construct the point-estimator; default is <code>p = 1</code> (local linear regression).</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_q">q</code></td>
<td>
<p>specifies the order of the local-polynomial used to construct the bias-correction; default is <code>q = 2</code> (local quadratic regression).</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_deriv">deriv</code></td>
<td>
<p>specifies the order of the derivative of the regression function to be estimated; default is <code>deriv = 0</code> (Sharp RD, or Fuzzy RD if <code>fuzzy</code> is also specified). Setting it equal to 1 results in estimation of a Kink RD design (or Fuzzy Kink RD if <code>fuzzy</code> is also specified).</p>
</td></tr>  
<tr><td><code id="rdbwselect_2014_+3A_rho">rho</code></td>
<td>
<p>if specified, sets the pilot bandwidth <code>b</code> equal to <code>h/rho</code>, where <code>h</code> is computed using the method and options chosen below.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_kernel">kernel</code></td>
<td>
<p>is the kernel function used to construct the local-polynomial estimator(s). Options are <code>triangular</code> (default option), <code>epanechnikov</code> and <code>uniform</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_bwselect">bwselect</code></td>
<td>
<p>selects the bandwidth selection procedure to be used. By default it computes both <code>h</code> and <code>b</code>, unless <code>rho</code> is specified, in which case it only computes <code>h</code> and sets <code>b</code> = <code>h/rho</code>. Options are:
</p>
<p><code>CCT</code> for bandwidth selector proposed by Calonico, Cattaneo and Titiunik (2014)  (default option).
</p>
<p><code>IK</code> for bandwidth selector proposed by Imbens and Kalyanaraman (2012) (only available for Sharp RD design).
</p>
<p><code>CV</code> for cross-validation method proposded by Ludwig and Miller (2007) (only available for Sharp RD design).</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_scaleregul">scaleregul</code></td>
<td>
<p>specifies scaling factor for the regularization terms of <code>CCT</code> and <code>IK</code> bandwidth selectors. Setting <code>scaleregul = 0</code> removes the regularization term from the bandwidth selectors; default is <code>scaleregul = 1</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_delta">delta</code></td>
<td>
<p>sets the quantile that defines the sample used in the cross-validation procedure. This option is used only if <code>bwselect(CV)</code> is specified; default is <code>delta = 0.5</code>, that is, the median of the control and treated samples.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_cvgrid_min">cvgrid_min</code></td>
<td>
<p>sets the minimum value of the bandwidth grid used in the cross-validation procedure. This option is used only if <code>bwselect = "CV"</code> is specified.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_cvgrid_max">cvgrid_max</code></td>
<td>
<p>sets the maximum value of the bandwidth grid used in the cross-validation procedure. This option is used only if <code>bwselect = "CV"</code> is specified.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_cvgrid_length">cvgrid_length</code></td>
<td>
<p>sets the bin length of the (evenly-spaced) bandwidth grid used in the cross-validation procedure. This option is used only if <code>bwselect = "CV"</code> is specified.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_cvplot">cvplot</code></td>
<td>
<p>generates a graph of the CV objective function. This option is used only if <code>bwselect = "CV"</code> is specified.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_vce">vce</code></td>
<td>
<p>specifies the procedure used to compute the variance-covariance matrix estimator. This option is used only if <code>CCT</code> or <code>IK</code> bankdwith procedures are employed. Options are:
</p>
<p><code>nn</code> for nearest-neighbor matches residuals using <code>matches</code> number of matches. This is the default option (with <code>matches = 3</code>, see below).
</p>
<p><code>resid</code> for estimated plug-in residuals using <code>h</code> bandwidth.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_matches">matches</code></td>
<td>
<p>specifies the number of matches in the nearest-neighbor based variance-covariance matrix estimator. This options is used only when nearest-neighbor matches residuals are employed; default is <code>matches = 3</code>.</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_all">all</code></td>
<td>
<p>if specified, <code><a href="#topic+rdbwselect_2014">rdbwselect_2014</a></code> reports  three different procedures: 
</p>
<p><code>CCT</code> for bandwidth selector proposed by Calonico, Cattaneo and Titiunik (2014).
</p>
<p><code>IK</code> for bandwidth selector proposed by Imbens and Kalyanaraman (2012).
</p>
<p><code>CV</code> for cross-validation method proposed by Ludwig and Miller (2007).</p>
</td></tr>
<tr><td><code id="rdbwselect_2014_+3A_precalc">precalc</code></td>
<td>
<p>internal option.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>bws</code></td>
<td>
<p>matrix containing the estimated bandwidths for each selected procedure.</p>
</td></tr>
<tr><td><code>bwselect</code></td>
<td>
<p>bandwidth selection procedure employed.</p>
</td></tr>
<tr><td><code>kernel</code></td>
<td>
<p>kernel function used to construct the local-polynomial estimator(s).</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>order of the local-polynomial used to construct the point-estimator.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>order of the local-polynomial used to construct the bias-correction estimator.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of California, Santa Barbara, CA. <a href="mailto:maxhfarrell@ucsb.edu">maxhfarrell@ucsb.edu</a>.
</p>
<p>Rocio Titiunik, Princeton University, Princeton, NJ.  <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., Cattaneo, M. D., and R. Titiunik. 2014. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2014_Stata.pdf">Robust Nonparametric Confidence Intervals for Regression-Discontinuity Designs.</a> <em>Econometrica</em> 82(6): 2295-2326.   .
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rdrobust">rdrobust</a></code>, <code><a href="#topic+rdplot">rdplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-runif(1000,-1,1)
y&lt;-5+3*x+2*(x&gt;=0)+rnorm(1000)
rdbwselect_2014(y,x)
</code></pre>

<hr>
<h2 id='rdplot'>Data-Driven Regression Discontinuity Plots</h2><span id='topic+rdplot'></span><span id='topic+print.rdplot'></span><span id='topic+summary.rdplot'></span>

<h3>Description</h3>

<p><code><a href="#topic+rdplot">rdplot</a></code>  implements several data-driven Regression Discontinuity (RD) plots, using either evenly-spaced or quantile-spaced partitioning. Two type of RD plots are constructed: (i) RD plots with binned sample means tracing out the underlying regression function, and (ii) RD plots with binned sample means mimicking the underlying variability of the data. For technical and methodological details see Calonico, Cattaneo and Titiunik (2015a).
</p>
<p>Companion commands are: <code><a href="#topic+rdrobust">rdrobust</a></code> for point estimation and inference procedures, and <code><a href="#topic+rdbwselect">rdbwselect</a></code> for data-driven bandwidth selection.
</p>
<p>A detailed introduction to this command is given in Calonico, Cattaneo and Titiunik (2015b) and Calonico, Cattaneo, Farrell and Titiunik (2017). A companion <code>Stata</code> package is described in Calonico, Cattaneo and Titiunik (2014).
</p>
<p>For more details, and related Stata and R packages useful for analysis of RD designs, visit <a href="https://rdpackages.github.io/">https://rdpackages.github.io/</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdplot(y, x, c = 0, p = 4, nbins = NULL, binselect = "esmv",  
          scale = NULL, kernel = "uni", weights = NULL, h = NULL, 
          covs = NULL, covs_eval = "mean", covs_drop = TRUE, ginv.tol = 1e-20,
          support = NULL, subset = NULL, masspoints = "adjust",
          hide = FALSE, ci = NULL, shade = FALSE, title = NULL, 
          x.label = NULL, y.label = NULL, x.lim = NULL, y.lim = NULL, 
          col.dots = NULL, col.lines = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rdplot_+3A_y">y</code></td>
<td>
<p>is the dependent variable.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_x">x</code></td>
<td>
<p>is the running variable (a.k.a. score or forcing variable).</p>
</td></tr>
<tr><td><code id="rdplot_+3A_c">c</code></td>
<td>
<p>specifies the RD cutoff in <code>x</code>; default is <code>c = 0</code>.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_p">p</code></td>
<td>
<p>specifies the order of the global-polynomial used to approximate the population conditional mean functions for control and treated units; default is <code>p = 4</code>.</p>
</td></tr> 
<tr><td><code id="rdplot_+3A_nbins">nbins</code></td>
<td>
<p>specifies the number of bins used to the left of the cutoff, denoted <code class="reqn">J_-</code>, and to the right of the cutoff, denoted <code class="reqn">J_+</code>, respectively. If not specified, <code class="reqn">J_+</code> and <code class="reqn">J_-</code> are estimated using the method and options chosen below.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_binselect">binselect</code></td>
<td>
<p>specifies the procedure to select the number of bins. This option is available only if <code class="reqn">J_-</code> and <code class="reqn">J_+</code> are not set manually. Options are:  
</p>
<p><code>es</code>: IMSE-optimal evenly-spaced method using spacings estimators.
</p>
<p><code>espr</code>: IMSE-optimal evenly-spaced method using polynomial regression.
</p>
<p><code>esmv</code>: mimicking variance evenly-spaced method using spacings estimators. This is the default option.
</p>
<p><code>esmvpr</code>: mimicking variance evenly-spaced method using polynomial regression.
</p>
<p><code>qs</code>: IMSE-optimal quantile-spaced method using spacings estimators.
</p>
<p><code>qspr</code>: IMSE-optimal quantile-spaced method using polynomial regression.
</p>
<p><code>qsmv</code>: mimicking variance quantile-spaced method using spacings estimators.
</p>
<p><code>qsmvpr</code>: mimicking variance quantile-spaced method using polynomial regression.
</p>
</td></tr>
<tr><td><code id="rdplot_+3A_scale">scale</code></td>
<td>
<p>specifies a multiplicative factor to be used with the optimal numbers of bins selected. Specifically, the number of bins used for the treatment and control groups will be <code>scale</code><code class="reqn">\times \hat{J}_+</code> and <code>scale</code><code class="reqn">\times \hat{J}_-</code>, where <code class="reqn">\hat{J}_\cdot</code> denotes the estimated optimal numbers of bins originally computed for each group; default is <code>scale = 1</code>.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_kernel">kernel</code></td>
<td>
<p>specifies the kernel function used to construct the local-polynomial estimator(s). Options are: <code>triangular</code>, <code>epanechnikov</code>, and <code>uniform</code>. Default is <code>kernel=uniform</code> (i.e., equal/no weighting to all observations on the support of the kernel).</p>
</td></tr>
<tr><td><code id="rdplot_+3A_weights">weights</code></td>
<td>
<p>is the variable used for optional weighting of the estimation procedure. The unit-specific weights multiply the kernel function.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_h">h</code></td>
<td>
<p>specifies the bandwidth used to construct the (global) polynomial fits given the kernel choice <code>kernel</code>.
If not specified, the bandwidths are chosen to span the full support of the data. If two bandwidths are specified, the first bandwidth is used for the data below the cutoff and the second bandwidth is used for the data above the cutoff.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_covs">covs</code></td>
<td>
<p>specifies additional covariates to be used in the polynomial regression.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_covs_eval">covs_eval</code></td>
<td>
<p>sets the evaluation points for the additional covariates, when included in the estimation. Options are: <code>covs_eval = 0</code> and <code>covs_eval = "mean"</code> (default)</p>
</td></tr>
<tr><td><code id="rdplot_+3A_covs_drop">covs_drop</code></td>
<td>
<p>if TRUE, it checks for collinear additional covariates and drops them. Default is TRUE.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_ginv.tol">ginv.tol</code></td>
<td>
<p>tolerance used to invert matrices involving covariates when <code>covs_drop=TRUE</code>.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_support">support</code></td>
<td>
<p>specifies an optional extended support of the running variable to be used in the construction of the bins;  default is the sample range.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_masspoints">masspoints</code></td>
<td>
<p>checks and controls for repeated observations in the running variable. Options are:
</p>
<p>(i)  <code>off</code>: ignores the presence of mass points; 
</p>
<p>(ii) <code>check</code>: looks for and reports the number of unique observations at each side of the cutoff. 
</p>
<p>(iii) <code>adjust</code>: sets <code>binselect()</code> as polynomial regression when mass points are present. 
</p>
<p>Default option is <code>masspoints=adjust</code>.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_hide">hide</code></td>
<td>
<p>logical. If <code>TRUE</code>, it omits the RD plot; default is <code>hide = FALSE</code>.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_ci">ci</code></td>
<td>
<p>optional graphical option to display confidence intervals of selected level for each bin.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_shade">shade</code></td>
<td>
<p>optional graphical option to replace confidence intervals with shaded areas.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_title">title</code></td>
<td>
<p>optional title for the RD plot.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_x.label">x.label</code></td>
<td>
<p>optional label for the x-axis of the RD plot.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_y.label">y.label</code></td>
<td>
<p>optional label for the y-axis of the RD plot.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_x.lim">x.lim</code></td>
<td>
<p>optional setting for the range of the x-axis in the RD plot.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_y.lim">y.lim</code></td>
<td>
<p>optional setting for the range of the y-axis in the RD plot.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_col.dots">col.dots</code></td>
<td>
<p>optional setting for the color of the dots in the RD plot.</p>
</td></tr>
<tr><td><code id="rdplot_+3A_col.lines">col.lines</code></td>
<td>
<p>optional setting for the color of the lines in the RD plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>binselect</code></td>
<td>
<p>method used to compute the optimal number of bins.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>sample sizes used to the left and right of the cutoff.</p>
</td></tr>
<tr><td><code>Nh</code></td>
<td>
<p>effective sample sizes used to the left and right of the cutoff.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>cutoff value.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>order of the global polynomial used.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>bandwidth used to the left and right of the cutoff.</p>
</td></tr>
<tr><td><code>kernel</code></td>
<td>
<p>kernel used.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>selected number of bins to the left and right of the cutoff.</p>
</td></tr>
<tr><td><code>J_IMSE</code></td>
<td>
<p>IMSE optimal number of bins to the left and right of the cutoff.</p>
</td></tr>
<tr><td><code>J_MV</code></td>
<td>
<p>Mimicking variance number of bins to the left and right of the cutoff.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>matrix containing the coefficients of the <code class="reqn">p^{th}</code> order global polynomial estimated both sides of the cutoff.</p>
</td></tr>
<tr><td><code>coef_covs</code></td>
<td>
<p>coefficients of the additional covariates, only returned when <code>covs()</code> are used.</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>selected scale value.</p>
</td></tr>
<tr><td><code>rscale</code></td>
<td>
<p>implicit scale value.</p>
</td></tr>
<tr><td><code>bin_avg</code></td>
<td>
<p>average bin length.</p>
</td></tr>
<tr><td><code>bin_med</code></td>
<td>
<p>median bin length.</p>
</td></tr>
<tr><td><code>vars_bins</code></td>
<td>
<p>data frame containing the variables used to construct the bins: bin id, cutoff values, mean of x and y within each bin, cutoff points and confidence interval bounds.</p>
</td></tr>
<tr><td><code>vars_poly</code></td>
<td>
<p>data frame containing the variables used to construct the global polynomial plot.</p>
</td></tr>
<tr><td><code>rdplot</code></td>
<td>
<p>a standard <code>ggplot</code> object that can be used for further customization.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of California, Santa Barbara, CA. <a href="mailto:maxhfarrell@ucsb.edu">maxhfarrell@ucsb.edu</a>.
</p>
<p>Rocio Titiunik, Princeton University, Princeton, NJ.  <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, M. H. Farrell, and R. Titiunik. 2017. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Farrell-Titiunik_2017_Stata.pdf">rdrobust: Software for Regression Discontinuity Designs.</a> <em>Stata Journal</em> 17(2): 372-404. 
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2014. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2014_Stata.pdf">Robust Data-Driven Inference in the Regression-Discontinuity Design.</a> <em>Stata Journal</em> 14(4): 909-946.
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2015a. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2015_JASA.pdf">Optimal Data-Driven Regression Discontinuity Plots.</a> <em>Journal of the American Statistical Association</em> 110(512): 1753-1769.
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2015b. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2015_R.pdf">rdrobust: An R Package for Robust Nonparametric Inference in Regression-Discontinuity Designs.</a> <em>R Journal</em> 7(1): 38-51.
</p>
<p>Cattaneo, M. D., B. Frandsen, and R. Titiunik. 2015. <a href="https://rdpackages.github.io/references/Cattaneo-Frandsen-Titiunik_2015_JCI.pdf">Randomization Inference in the Regression Discontinuity Design: An Application to the Study of Party Advantages in the U.S. Senate.</a> <em>Journal of Causal Inference</em> 3(1): 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rdbwselect">rdbwselect</a></code>, <code><a href="#topic+rdrobust">rdrobust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-runif(1000,-1,1)
y&lt;-5+3*x+2*(x&gt;=0)+rnorm(1000)
rdplot(y,x)
</code></pre>

<hr>
<h2 id='rdrobust'>Local-Polynomial RD Estimation with Robust Confidence Intervals</h2><span id='topic+rdrobust'></span><span id='topic+print.rdrobust'></span><span id='topic+summary.rdrobust'></span>

<h3>Description</h3>

<p><code><a href="#topic+rdrobust">rdrobust</a></code> implements local polynomial Regression Discontinuity (RD) point estimators with robust bias-corrected confidence intervals and inference procedures developed in Calonico, Cattaneo and Titiunik (2014a), Calonico, Cattaneo and Farrell (2018), Calonico, Cattaneo, Farrell and Titiunik (2019), and Calonico, Cattaneo and Farrell (2020). It also computes alternative estimation and inference procedures available in the literature. 
</p>
<p>Companion commands are: <code><a href="#topic+rdbwselect">rdbwselect</a></code> for data-driven bandwidth selection, and <code><a href="#topic+rdplot">rdplot</a></code> for data-driven RD plots (see Calonico, Cattaneo and Titiunik (2015a) for details).
</p>
<p>A detailed introduction to this command is given in Calonico, Cattaneo and Titiunik (2015b), and Calonico, Cattaneo, Farrell and Titiunik (2017). A companion <code>Stata</code> package is described in Calonico, Cattaneo and Titiunik (2014b).
</p>
<p>For more details, and related Stata and R packages useful for analysis of RD designs, visit <a href="https://rdpackages.github.io/">https://rdpackages.github.io/</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdrobust(y, x, c = NULL,  fuzzy = NULL, 
          deriv = NULL, p = NULL, q = NULL, 
          h = NULL, b = NULL, rho = NULL, 
          covs = NULL,  covs_drop = TRUE, ginv.tol = 1e-20,
          kernel = "tri", weights = NULL, bwselect = "mserd", 
          vce = "nn", cluster = NULL, 
          nnmatch = 3, level = 95, scalepar = 1, scaleregul = 1, 
          sharpbw = FALSE, all = NULL, subset = NULL,
          masspoints = "adjust", bwcheck = NULL,
          bwrestrict = TRUE, stdvars = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rdrobust_+3A_y">y</code></td>
<td>
<p>is the dependent variable.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_x">x</code></td>
<td>
<p>is the running variable (a.k.a. score or forcing variable).</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_c">c</code></td>
<td>
<p>specifies the RD cutoff in <code>x</code>; default is <code>c = 0</code>.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_fuzzy">fuzzy</code></td>
<td>
<p>specifies the treatment status variable used to implement fuzzy RD estimation (or Fuzzy Kink RD if <code>deriv=1</code> is also specified). Default is Sharp RD design and hence this option is not used.</p>
</td></tr> 
<tr><td><code id="rdrobust_+3A_deriv">deriv</code></td>
<td>
<p>specifies the order of the derivative of the regression functions to be estimated. Default is <code>deriv=0</code> (for Sharp RD, or for Fuzzy RD if <code>fuzzy</code> is also specified). Setting <code>deriv=1</code> results in estimation of a Kink RD design (up to scale), or Fuzzy Kink RD if <code>fuzzy</code> is also specified.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_p">p</code></td>
<td>
<p>specifies the order of the local-polynomial used to construct the point-estimator; default is <code>p = 1</code> (local linear regression).</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_q">q</code></td>
<td>
<p>specifies the order of the local-polynomial used to construct the bias-correction; default is <code>q = 2</code> (local quadratic regression).</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_h">h</code></td>
<td>
<p>specifies the main bandwidth used to construct the RD point estimator. If not specified, bandwidth <code>h</code> is computed by the companion command <code><a href="#topic+rdbwselect">rdbwselect</a></code>. If two bandwidths are specified, the first bandwidth is used for the data below the cutoff and the second bandwidth is used for the data above the cutoff.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_b">b</code></td>
<td>
<p>specifies the bias bandwidth used to construct the bias-correction estimator. If not specified, bandwidth <code>b</code> is computed by the companion command <code><a href="#topic+rdbwselect">rdbwselect</a></code>. If two bandwidths are specified, the first bandwidth is used for the data below the cutoff and the second bandwidth is used for the data above the cutoff.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_rho">rho</code></td>
<td>
<p>specifies the value of <code>rho</code>, so that the bias bandwidth <code>b</code> equals <code>h/rho</code>. Default is <code>rho = 1</code> if <code>h</code> is specified but <code>b</code> is not.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_covs">covs</code></td>
<td>
<p>specifies additional covariates to be used for estimation and inference.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_covs_drop">covs_drop</code></td>
<td>
<p>if TRUE, it checks for collinear additional covariates and drops them. Default is TRUE.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_ginv.tol">ginv.tol</code></td>
<td>
<p>tolerance used to invert matrices involving covariates when <code>covs_drop=TRUE</code>.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_kernel">kernel</code></td>
<td>
<p>is the kernel function used to construct the local-polynomial estimator(s). Options are <code>triangular</code> (default option), <code>epanechnikov</code> and <code>uniform</code>.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_weights">weights</code></td>
<td>
<p>is the variable used for optional weighting of the estimation procedure. The unit-specific weights multiply the kernel function.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_bwselect">bwselect</code></td>
<td>
<p>specifies the bandwidth selection procedure to be used. By default it computes both <code>h</code> and <code>b</code>, unless <code>rho</code> is specified, in which case it only computes <code>h</code> and sets <code>b=h/rho</code>.</p>
</td></tr>
</table>
<p>Options are:
</p>
<p><code>mserd</code> one common MSE-optimal bandwidth selector for the RD treatment effect estimator.
</p>
<p><code>msetwo</code> two different MSE-optimal bandwidth selectors (below and above the cutoff) for the RD treatment effect estimator.
</p>
<p><code>msesum</code> one common MSE-optimal bandwidth selector for the sum of regression estimates (as opposed to difference thereof).
</p>
<p><code>msecomb1</code> for min(<code>mserd</code>,<code>msesum</code>).
</p>
<p><code>msecomb2</code> for median(<code>msetwo</code>,<code>mserd</code>,<code>msesum</code>), for each side of the cutoff separately.
</p>
<p><code>cerrd</code> one common CER-optimal bandwidth selector for the RD treatment effect estimator.
</p>
<p><code>certwo</code> two different CER-optimal bandwidth selectors (below and above the cutoff) for the RD treatment effect estimator.
</p>
<p><code>cersum</code> one common CER-optimal bandwidth selector for the sum of regression estimates (as opposed to difference thereof).
</p>
<p><code>cercomb1</code> for min(<code>cerrd</code>,<code>cersum</code>).
</p>
<p><code>cercomb2</code> for median(<code>certwo</code>,<code>cerrd</code>,<code>cersum</code>), for each side of the cutoff separately.
</p>
<p>Note: MSE = Mean Square Error; CER = Coverage Error Rate.
Default is <code>bwselect=mserd</code>. For details on implementation see Calonico, Cattaneo and Titiunik (2014a), Calonico, Cattaneo and Farrell (2018), and Calonico, Cattaneo, Farrell and Titiunik (2019), and the companion software articles.
</p>
<table>
<tr><td><code id="rdrobust_+3A_vce">vce</code></td>
<td>
<p>specifies the procedure used to compute the variance-covariance matrix estimator.
Options are:
</p>
<p><code>nn</code> for heteroskedasticity-robust nearest neighbor variance estimator with <code>nnmatch</code> the (minimum) number of neighbors to be used.
</p>
<p><code>hc0</code> for heteroskedasticity-robust plug-in residuals variance estimator without weights.
</p>
<p><code>hc1</code> for heteroskedasticity-robust plug-in residuals variance estimator with <code>hc1</code> weights.
</p>
<p><code>hc2</code> for heteroskedasticity-robust plug-in residuals variance estimator with <code>hc2</code> weights.
</p>
<p><code>hc3</code> for heteroskedasticity-robust plug-in residuals variance estimator with <code>hc3</code> weights.
</p>
<p>Default is <code>vce=nn</code>.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_cluster">cluster</code></td>
<td>
<p>indicates the cluster ID variable used for cluster-robust variance estimation with degrees-of-freedom weights. By default it is combined with <code>vce=nn</code> for cluster-robust nearest neighbor variance estimation. Another option is plug-in residuals combined with <code>vce=hc0</code>.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_nnmatch">nnmatch</code></td>
<td>
<p>to be combined with for <code>vce=nn</code> for heteroskedasticity-robust nearest neighbor variance estimator with <code>nnmatch</code> indicating the minimum number of neighbors to be used. Default is <code>nnmatch=3</code></p>
</td></tr>
<tr><td><code id="rdrobust_+3A_level">level</code></td>
<td>
<p>sets the confidence level for confidence intervals; default is <code>level = 95</code>.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_scalepar">scalepar</code></td>
<td>
<p>specifies scaling factor for RD parameter of interest. This option is useful when the population parameter of interest involves a known multiplicative factor (e.g., sharp kink RD).  Default is <code>scalepar = 1</code> (no scaling).</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_scaleregul">scaleregul</code></td>
<td>
<p>specifies scaling factor for the regularization term added to the denominator of the bandwidth selectors. Setting <code>scaleregul = 0</code> removes the regularization term from the bandwidth selectors; default is <code>scaleregul = 1</code>.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_sharpbw">sharpbw</code></td>
<td>
<p>option to perform fuzzy RD estimation using a bandwidth selection procedure for the sharp RD model. This option is automatically selected if there is perfect compliance at either side of the cutoff.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_all">all</code></td>
<td>
<p>if specified, <code><a href="#topic+rdrobust">rdrobust</a></code> reports three different procedures:
</p>
<p>(i) conventional RD estimates with conventional standard errors.
</p>
<p>(ii) bias-corrected estimates with conventional standard errors.
</p>
<p>(iii) bias-corrected estimates with robust standard errors.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_masspoints">masspoints</code></td>
<td>
<p>checks and controls for repeated observations in the running variable. Options are:
</p>
<p>(i)  <code>off</code>: ignores the presence of mass points; 
</p>
<p>(ii) <code>check</code>: looks for and reports the number of unique observations at each side of the cutoff. 
</p>
<p>(iii) <code>adjust</code>: controls that the preliminary bandwidths used in the calculations contain a minimal number of unique observations. By default it uses 10 observations, but it can be manually adjusted with the option <code>bwcheck</code>). 
</p>
<p>Default option is <code>masspoints=adjust</code>.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_bwcheck">bwcheck</code></td>
<td>
<p>if a positive integer is provided, the preliminary bandwidth used in the calculations is enlarged so that at least <code>bwcheck</code> unique observations are used.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_bwrestrict">bwrestrict</code></td>
<td>
<p>if <code>TRUE</code>, computed bandwidths are restricted to lie within the range of <code>x</code>; default is <code>bwrestrict = TRUE</code>.</p>
</td></tr>
<tr><td><code id="rdrobust_+3A_stdvars">stdvars</code></td>
<td>
<p>if <code>TRUE</code>, <code>x</code> and <code>y</code> are standardized before computing the bandwidths; default is <code>stdvars = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>N</code></td>
<td>
<p>vector with the sample sizes used to the left and to the right of the cutoff.</p>
</td></tr>
<tr><td><code>N_h</code></td>
<td>
<p>vector with the effective sample sizes used to the left and to the right of the cutoff.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>cutoff value.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>order of the polynomial used for estimation of the regression function.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>order of the polynomial used for estimation of the bias of the regression function.</p>
</td></tr>
<tr><td><code>bws</code></td>
<td>
<p>matrix containing the bandwidths used.</p>
</td></tr>
<tr><td><code>tau_cl</code></td>
<td>
<p>conventional local-polynomial estimate to the left and to the right of the cutoff.</p>
</td></tr>
<tr><td><code>tau_bc</code></td>
<td>
<p>bias-corrected local-polynomial estimate to the left and to the right of the cutoff.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>vector containing conventional and bias-corrected local-polynomial RD estimates.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>vector containing conventional and robust standard errors of the local-polynomial RD estimates.</p>
</td></tr>
<tr><td><code>bias</code></td>
<td>
<p>estimated bias for the local-polynomial RD estimator below and above the cutoff.</p>
</td></tr>
<tr><td><code>beta_Y_p_l</code></td>
<td>
<p>conventional p-order local-polynomial estimates to the left of the cutoff for the outcome variable.</p>
</td></tr>
<tr><td><code>beta_Y_p_r</code></td>
<td>
<p>conventional p-order local-polynomial estimates to the right of the cutoff for the outcome variable.</p>
</td></tr>
<tr><td><code>beta_T_p_l</code></td>
<td>
<p>conventional p-order local-polynomial estimates to the left of the cutoff for the first stage (fuzzy RD).</p>
</td></tr>
<tr><td><code>beta_T_p_r</code></td>
<td>
<p>conventional p-order local-polynomial estimates to the right of the cutoff for the first stage (fuzzy RD).</p>
</td></tr>
<tr><td><code>beta_covs</code></td>
<td>
<p>coefficients of the additional covariates, only returned when <code>covs()</code> are used.</p>
</td></tr>
<tr><td><code>V_cl_l</code></td>
<td>
<p>conventional variance-covariance matrix estimated below the cutoff.</p>
</td></tr>
<tr><td><code>V_cl_r</code></td>
<td>
<p>conventional variance-covariance matrix estimated above the cutoff.</p>
</td></tr>
<tr><td><code>V_rb_l</code></td>
<td>
<p>robust variance-covariance matrix estimated below the cutoff.</p>
</td></tr>
<tr><td><code>V_rb_r</code></td>
<td>
<p>robust variance-covariance matrix estimated above the cutoff.</p>
</td></tr>
<tr><td><code>pv</code></td>
<td>
<p>vector containing the p-values associated with conventional, bias-corrected and robust local-polynomial RD estimates.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>matrix containing the confidence intervals associated with conventional, bias-corrected and robust local-polynomial RD estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of California, Santa Barbara, CA. <a href="mailto:maxhfarrell@ucsb.edu">maxhfarrell@ucsb.edu</a>.
</p>
<p>Rocio Titiunik, Princeton University, Princeton, NJ.  <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2018. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2018_JASA.pdf">On the Effect of Bias Estimation on Coverage Accuracy in Nonparametric Inference.</a> <em>Journal of the American Statistical Association</em>, 113(522): 767-779.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2020. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Farrell_2020_ECTJ.pdf">Optimal Bandwidth Choice for Robust Bias Corrected Inference in Regression Discontinuity Designs.</a> <em>Econometrics Journal</em>, 23(2): 192-210.
</p>
<p>Calonico, S., M. D. Cattaneo, M. H. Farrell, and R. Titiunik. 2017. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Farrell-Titiunik_2017_Stata.pdf">rdrobust: Software for Regression Discontinuity Designs.</a> <em>Stata Journal</em>, 17(2): 372-404.
</p>
<p>Calonico, S., M. D. Cattaneo, M. H. Farrell, and R. Titiunik. 2019. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Farrell-Titiunik_2019_RESTAT.pdf">Regression Discontinuity Designs using Covariates.</a> <em>Review of Economics and Statistics</em>, 101(3): 442-451. 
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2014a. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2014_ECMA.pdf">Robust Nonparametric Confidence Intervals for Regression-Discontinuity Designs.</a> <em>Econometrica</em> 82(6): 2295-2326.
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2014b. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2014_Stata.pdf">Robust Data-Driven Inference in the Regression-Discontinuity Design.</a> <em>Stata Journal</em> 14(4): 909-946.
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2015a. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2015_JASA.pdf">Optimal Data-Driven Regression Discontinuity Plots.</a> <em>Journal of the American Statistical Association</em> 110(512): 1753-1769.
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. 2015b. <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2015_R.pdf">rdrobust: An R Package for Robust Nonparametric Inference in Regression-Discontinuity Designs.</a> <em>R Journal</em> 7(1): 38-51.
</p>
<p>Cattaneo, M. D., B. Frandsen, and R. Titiunik. 2015. <a href="https://rdpackages.github.io/references/Cattaneo-Frandsen-Titiunik_2015_JCI.pdf">Randomization Inference in the Regression Discontinuity Design: An Application to the Study of Party Advantages in the U.S. Senate.</a> <em>Journal of Causal Inference</em> 3(1): 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rdbwselect">rdbwselect</a></code>, <code><a href="#topic+rdplot">rdplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
x&lt;-runif(1000,-1,1)
y&lt;-5+3*x+2*(x&gt;=0)+rnorm(1000)
rdrobust(y,x)
</code></pre>

<hr>
<h2 id='rdrobust_RDsenate'>RD Senate Data</h2><span id='topic+rdrobust_RDsenate'></span>

<h3>Description</h3>

<p>Extract of the dataset constructed by Cattaneo, Frandsen, and Titiunik (2015), which include measures of incumbency advantage in the U.S. Senate for the period 1914-2010.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rdrobust_RDsenate)</code></pre>


<h3>Format</h3>

 
<p>A data frame with 1390 observations on the following 2 variables.
</p>

<dl>
<dt><code>margin</code></dt><dd><p>a numeric vector.</p>
</dd> 
<dt><code>vote</code></dt><dd><p>a numeric vector.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Cattaneo, M. D., Frandsen, B., and R. Titiunik. 2015. <a href="https://rdpackages.github.io/references/Cattaneo-Frandsen-Titiunik_2015_JCI.pdf">Randomization Inference in the Regression Discontinuity Design: An Application to the Study of Party Advantages in the U.S. Senate.</a> <em>Journal of Causal Inference</em> 3(1): 1-24.   
</p>


<h3>References</h3>

<p>Cattaneo, M. D., Frandsen, B., and R. Titiunik. 2015. <a href="https://rdpackages.github.io/references/Cattaneo-Frandsen-Titiunik_2015_JCI.pdf">Randomization Inference in the Regression Discontinuity Design: An Application to the Study of Party Advantages in the U.S. Senate.</a> <em>Journal of Causal Inference</em> 3(1): 1-24.
</p>

<hr>
<h2 id='rdrobust-package'>Robust Data-Driven Statistical Inference in RD Designs</h2><span id='topic+rdrobust-package'></span>

<h3>Description</h3>

<p>Regression-discontinuity (RD) designs are quasi-experimental research designs popular in social, behavioral and natural sciences. The RD design is usually employed to study the (local) causal effect of a treatment, intervention or policy. This package provides tools for data-driven graphical and analytical statistical inference in RD designs: <code><a href="#topic+rdrobust">rdrobust</a></code> to construct local-polynomial point estimators and robust confidence intervals for average treatment effects at the cutoff in Sharp, Fuzzy and Kink RD settings, <code><a href="#topic+rdbwselect">rdbwselect</a></code> to perform bandwidth selection for the different procedures implemented, and <code><a href="#topic+rdplot">rdplot</a></code> to conduct exploratory data analysis (RD plots).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> rdrobust</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.2</td>
</tr>
<tr>
 <td style="text-align: left;"> 
Date: </td><td style="text-align: left;"> 2023-11-03</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Function for statistical inference: <code><a href="#topic+rdrobust">rdrobust</a></code><br />
Function for bandwidths selection: <code><a href="#topic+rdbwselect">rdbwselect</a></code><br />
Function for exploratory data analysis (RD plots): <code><a href="#topic+rdplot">rdplot</a></code>
</p>


<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of California, Santa Barbara, CA. <a href="mailto:maxhfarrell@ucsb.edu">maxhfarrell@ucsb.edu</a>.
</p>
<p>Rocio Titiunik, Princeton University, Princeton, NJ.  <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
