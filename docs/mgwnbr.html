<!DOCTYPE html><html><head><title>Help for package mgwnbr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mgwnbr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#georgia'><p>Georgia dataset</p></a></li>
<li><a href='#mgwnbr'><p>Multiscale Geographically Weighted Negative Binomial Regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiscale Geographically Weighted Negative Binomial Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Juliana Rosa &lt;julianamrosa00@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits a geographically weighted regression model with different scales
	for each covariate. Uses the negative binomial distribution as default,
	but also accepts the normal, Poisson, or logistic distributions.
	Can fit the global versions of each regression and also the geographically
	weighted alternatives with only one scale, since they are all particular
	cases of the multiscale approach.
	Hanchen Yu (2024). "Exploring Multiscale Geographically Weighted Negative Binomial Regression", Annals of the American Association of Geographers &lt;<a href="https://doi.org/10.1080%2F24694452.2023.2289986">doi:10.1080/24694452.2023.2289986</a>&gt;.
	Fotheringham AS, Yang W, Kang W (2017). "Multiscale Geographically Weighted Regression (MGWR)", Annals of the American Association of Geographers &lt;<a href="https://doi.org/10.1080%2F24694452.2017.1352480">doi:10.1080/24694452.2017.1352480</a>&gt;.
	Da Silva AR, Rodrigues TCV (2014). "Geographically Weighted Negative Binomial Regression - incorporating overdispersion", Statistics and Computing &lt;<a href="https://doi.org/10.1007%2Fs11222-013-9401-9">doi:10.1007/s11222-013-9401-9</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>sp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-26 14:50:06 UTC; Juliana Rosa</td>
</tr>
<tr>
<td>Author:</td>
<td>Juliana Rosa [aut, cre],
  JÃ©ssica Vasconcelos [aut],
  Alan da Silva [aut]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-26 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='georgia'>Georgia dataset</h2><span id='topic+georgia'></span>

<h3>Description</h3>

<p>The Georgia census data set from Fotheringham et al. (2002) in dataframe format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(georgia)
</code></pre>


<h3>Format</h3>

<p>A data frame with with 159 observations on the following 13 variables:
</p>

<ul>
<li> <p><code>AreaKey</code> - an identification number for each county
</p>
</li>
<li> <p><code>Latitude</code> - the latitude of the county centroid
</p>
</li>
<li> <p><code>Longitud</code> - the longitude of the county centroid
</p>
</li>
<li> <p><code>TotPop90</code> - population of the county in 1990
</p>
</li>
<li> <p><code>PctRural</code> - percentage of the county population defined as rural
</p>
</li>
<li> <p><code>PctBach</code> - percentage of the county population with a bachelors degree
</p>
</li>
<li> <p><code>PctEld</code> - percentage of the county population aged 65 or over
</p>
</li>
<li> <p><code>PctFB</code> - percentage of the county population born outside the US
</p>
</li>
<li> <p><code>PctPov</code> - percentage of the county population living below the poverty line
</p>
</li>
<li> <p><code>PctBlack</code> - percentage of the county population who are black
</p>
</li>
<li> <p><code>ID</code> - a numeric vector of IDs
</p>
</li>
<li> <p><code>X</code> - a numeric vector of x coordinates
</p>
</li>
<li> <p><code>Y</code> - a numeric vector of y coordinates
</p>
</li></ul>


<hr>
<h2 id='mgwnbr'>Multiscale Geographically Weighted Negative Binomial Regression</h2><span id='topic+mgwnbr'></span>

<h3>Description</h3>

<p>Fits a geographically weighted regression model with different scales for each covariate. Uses the negative binomial distribution as default, but also accepts the normal, Poisson, or logistic distributions. Can fit the global versions of each regression and also the geographically weighted alternatives with only one scale, since they are all particular cases of the multiscale approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mgwnbr(
  data,
  formula,
  weight = NULL,
  lat,
  long,
  globalmin = TRUE,
  method,
  model = "negbin",
  mgwr = TRUE,
  bandwidth = "cv",
  offset = NULL,
  distancekm = FALSE,
  int = 50,
  h = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mgwnbr_+3A_data">data</code></td>
<td>
<p>name of the dataset.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_formula">formula</code></td>
<td>
<p>regression model formula as in <code>lm</code>.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_weight">weight</code></td>
<td>
<p>name of the variable containing the sample weights, default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_lat">lat</code></td>
<td>
<p>name of the variable containing the latitudes in the dataset.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_long">long</code></td>
<td>
<p>name of the variable containing the longitudes in the dataset.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_globalmin">globalmin</code></td>
<td>
<p>logical value indicating whether to find a global minimum in the optimization process, default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_method">method</code></td>
<td>
<p>indicates the method to be used for the bandwidth calculation (<code>adaptive_bsq</code>, <code>fixed_bsq</code>, <code>fixed_g</code>).</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_model">model</code></td>
<td>
<p>indicates the model to be used for the regression (<code>gaussian</code>, <code>poisson</code>, <code>negbin</code>, <code>logistic</code>), default value is<code>"negbin"</code>.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_mgwr">mgwr</code></td>
<td>
<p>logical value indicating if multiscale should be used (<code>TRUE</code>, <code>FALSE</code>), default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_bandwidth">bandwidth</code></td>
<td>
<p>indicates the criterion to be used for the bandwidth calculation (<code>cv</code>, <code>aic</code>), default value is <code>"cv"</code>.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_offset">offset</code></td>
<td>
<p>name of the variable containing the offset values, if null then is set to a vector of zeros, default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_distancekm">distancekm</code></td>
<td>
<p>logical value indicating whether to calculate the distances in km, default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_int">int</code></td>
<td>
<p>integer indicating the number of iterations, default value is <code>50</code>.</p>
</td></tr>
<tr><td><code id="mgwnbr_+3A_h">h</code></td>
<td>
<p>integer indicating a predetermined bandwidth value, default value is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that contains:
</p>

<ul>
<li> <p><code>general_bandwidth</code> - General bandwidth value.
</p>
</li>
<li> <p><code>band</code> - Bandwidth values for each covariate.
</p>
</li>
<li> <p><code>measures</code> - Goodness of fit statistics.
</p>
</li>
<li> <p><code>ENP</code> - Effective number of parameters.
</p>
</li>
<li> <p><code>mgwr_param_estimates</code> - MGWR parameter estimates.
</p>
</li>
<li> <p><code>qntls_mgwr_param_estimates</code> - Quantiles of MGWR parameter estimates.
</p>
</li>
<li> <p><code>descript_stats_mgwr_param_estimates</code> - Descriptive statistics of MGWR parameter estimates.
</p>
</li>
<li> <p><code>p_values</code> - P-values for the t tests on parameter significance.
</p>
</li>
<li> <p><code>t_critical</code> - Critical values for the t tests on parameter significance.
</p>
</li>
<li> <p><code>mgwr_se</code> - MGWR standard errors.
</p>
</li>
<li> <p><code>qntls_mgwr_se</code> - Quantiles of MGWR standard errors.
</p>
</li>
<li> <p><code>descript_stats_se</code> - Descriptive statistics of MGWR standard errors.
</p>
</li>
<li> <p><code>global_param_estimates</code> - Parameter estimates for the global model.
</p>
</li>
<li> <p><code>t_test_dfs</code> - Denominator degrees of freedom for the t tests.
</p>
</li>
<li> <p><code>global_measures</code> - Goodness of fit statistics for the global model.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Data


data(georgia)

for (var in c("PctFB", "PctBlack")){
  georgia[, var] &lt;- as.data.frame(scale(georgia[, var]))
}


## Model

mod &lt;- mgwnbr(data=georgia, formula=PctBach~PctBlack+PctFB,
 lat="Y", long="X", globalmin=FALSE, method="adaptive_bsq", bandwidth="cv",
  model="gaussian", mgwr=FALSE, h=136)

## Bandwidths
mod$general_bandwidth

## Goodness of fit measures
mod$measures

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
