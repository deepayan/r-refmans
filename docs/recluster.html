<!DOCTYPE html><html><head><title>Help for package recluster</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {recluster}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dataisl'>
<p>West Mediterranean island butterflies provided with the package recluster</p></a></li>
<li><a href='#datamod'>
<p>Virtual island faunas provided with the package recluster</p></a></li>
<li><a href='#multiboot'>
<p>A multiboot result obtained with the dataisl dataset.</p></a></li>
<li><a href='#recluster'>
<p>Ordination methods for biodiversity patterns.</p></a></li>
<li><a href='#recluster.boot'>
<p>Bootstrap nodes of consensus trees</p></a></li>
<li><a href='#recluster.check'>
<p>An internal workaround for the new ape package</p></a></li>
<li><a href='#recluster.col'>
<p>Projecting a two dimensional plot in RGB space</p></a></li>
<li><a href='#recluster.cons'>
<p>Consensus tree among re-sampled trees</p></a></li>
<li><a href='#recluster.dist'>
<p>Compute a dissimilarity matrix using a battery of beta-diversity indices</p></a></li>
<li><a href='#recluster.expl'>
<p>Computes the dissimilarity contained in a distance matrix which is explained by a clustering solution.</p></a></li>
<li><a href='#recluster.expl.diss'>
<p>Cuts a phylogenetic tree to a given series of nodes and computes explained dissimilarity.</p></a></li>
<li><a href='#recluster.fst'>
<p>Compute some indexes of genetic differentiation</p></a></li>
<li><a href='#recluster.fst.pair'>
<p>Compute pairwise indexes of genetic differentiation among populations</p></a></li>
<li><a href='#recluster.group.col'>
<p>Computes mean coordinate values and RGB colours.</p></a></li>
<li><a href='#recluster.hist'>
<p>Histogram of dissimilarity with tied and zero values</p></a></li>
<li><a href='#recluster.identify.nodes'>
<p>Evaluating solutions in multiscale bootstrap</p></a></li>
<li><a href='#recluster.line'>
<p>Identifies a line in a configuration and computes its intercept and angular coefficient</p></a></li>
<li><a href='#recluster.multi'>
<p>Multiscale bootstrap based on a consensus tree</p></a></li>
<li><a href='#recluster.node.strength'>
<p>Evaluating order row bias in a cluster</p></a></li>
<li><a href='#recluster.plot'>
<p>A plotter for recluster bootstrapped objects</p></a></li>
<li><a href='#recluster.plot.col'>
<p>Plotting data in RGB space</p></a></li>
<li><a href='#recluster.plot.matrix'>
<p>Plot the values of the cells of a matrix in grey scale</p></a></li>
<li><a href='#recluster.plot.pie'>
<p>Plotting pies with RGB colours on a custom coordinate space</p></a></li>
<li><a href='#recluster.plot.sites.col'>
<p>Plotting RGB dots on a custom coordinate space</p></a></li>
<li><a href='#recluster.procrustes'>
<p>Computes a procrustes analysis between two matrices even if only a subset of cases are shared.</p></a></li>
<li><a href='#recluster.region'>
<p>A new clustering method based on continuous consensus.</p></a></li>
<li><a href='#recluster.rotate'>
<p>Rotates a bidimensional configuration according to a line</p></a></li>
<li><a href='#recluster.test.dist'>
<p>Test variation lost by a bidimensional configuration when the coordinates of the elements are reduced to the configuration of the barycentres of a given series of groups.</p></a></li>
<li><a href='#treebut'>
<p>Phylogenetic tree for the butterfly species included in dataisl dataset</p></a></li>
<li><a href='#treemod'>
<p>Hypothetical phylogenetic tree for the virtual island faunas provided with the package recluster</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Ordination Methods for the Analysis of Beta-Diversity Indices</td>
</tr>
<tr>
<td>Version:</td>
<td>2.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-07-25</td>
</tr>
<tr>
<td>Depends:</td>
<td>ape</td>
</tr>
<tr>
<td>Imports:</td>
<td>vegan, picante, phangorn, phytools, cluster, plotrix</td>
</tr>
<tr>
<td>Author:</td>
<td>Leonardo Dapporto, Matteo Ramazzotti, Simone Fattorini, Roger
        Vila, Gerard Talavera, Roger H.L. Dennis</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Leonardo Dapporto &lt;leondap@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The analysis of different aspects of biodiversity requires specific algorithms. 
	For example, in regionalisation analyses, the high frequency of ties and zero values in 
	dissimilarity matrices produced by Beta-diversity turnover produces hierarchical 
	cluster dendrograms whose topology and bootstrap supports are affected by the order of 
	rows in the original matrix. Moreover, visualisation of biogeographical regionalisation 
	can be facilitated by a combination of hierarchical clustering and multi-dimensional 
	scaling. The recluster package provides robust techniques to visualise and analyse 
	pattern of biodiversity and to improve occurrence data for cryptic taxa. 
	Other functions 	related to recluster (e.g. the biodecrypt family) are currently 
	available in GitHub at <a href="https://github.com/leondap/recluster">https://github.com/leondap/recluster</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/leondap/recluster">https://github.com/leondap/recluster</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-07-26 09:06:52 UTC; matteo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-07-26 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dataisl'>
West Mediterranean island butterflies provided with the package recluster 
</h2><span id='topic+dataisl'></span>

<h3>Description</h3>

<p>This dataset represents occurrence data of butterfly species in 30 West-Mediterranean islands
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataisl)
</code></pre>


<h3>Details</h3>

<p>A data frame with 30 observations (islands) on 123 binary variables (species).
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Roger Vila
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>

<hr>
<h2 id='datamod'>
Virtual island faunas provided with the package recluster 
</h2><span id='topic+datamod'></span>

<h3>Description</h3>

<p>This dataset represents a series of virtual faunas in different sites
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(datamod)
</code></pre>


<h3>Details</h3>

<p>A data frame with 9 observations (sites) on 31 binary variables (species).
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>

<hr>
<h2 id='multiboot'>
A multiboot result obtained with the dataisl dataset.
</h2><span id='topic+multiboot'></span>

<h3>Description</h3>

<p>This dataset represents an output for a multiscale bootstrap composed of 30 scales (x1-x30). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataisl)
</code></pre>


<h3>Details</h3>

<p>A data frame with 29 nodes (rows) and 30 different scales of bootstrap(columns). NAs values represent collapsed nodes
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>Source</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>

<hr>
<h2 id='recluster'>
Ordination methods for biodiversity patterns.
</h2><span id='topic+recluster'></span><span id='topic+reCluster'></span>

<h3>Description</h3>

<p>The analysis of different aspects of biodiversity requires specific algorithms. 
For example, in regionalisation analyses, the high frequency of ties and zero values in 
dissimilarity matrices produced by Beta-diversity turnover produces hierarchical 
cluster dendrograms whose topology and bootstrap supports are affected by the order of 
rows in the original matrix. Moreover, visualisation of biogeographical regionalisation 
can be facilitated by a combination of hierarchical clustering and multi-dimensional 
scaling. The recluster package provides robust techniques to visualise and analyse 
pattern of biodiversity and to improve occurrence data for cryptic taxa. Other functions related to recluster (e.g. the biodecrypt family) are currently available in GitHub at https://github.com/leondap/recluster.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> recluster</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.9</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-07-25</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Leonardo Dapporto, Matteo Ramazzotti, Simone Fattorini, Roger Vila, Gerard Talavera, 
Roger H.L. Dennis
Maintainer: Leonardo Dapporto &lt;leondap@gmail.com&gt;
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>
<p>Dapporto, L., Fattorini, S., Voda, R., Dinca, V., Vila, R. &quot;Biogeography of western 
Mediterranean butterflies: combining turnover and nestedness components of faunal 
dissimilarity.&quot; 
J Biogeogr (2014), 41: 1639-1650.
</p>
<p>Dapporto L., Voda R., Dinca V., Vila R.
&quot;Comparing population patterns for genetic and morphological markers with uneven sample 
sizes. An example for the butterfly Maniola jurtina&quot;
Methods Ecol Evol (2014), 5, 834-843.
</p>
<p>Platania L., Menchetti M. Dinca V., Corbella C., Kay-Lavelle I., Vila R., Wiemers M., 
Schweiger O., Dapporto L. &quot;Assigning occurrence data to cryptic taxa improves climatic 
niche assessments: biodecrypt, a new tool tested on European butterflies&quot;. Glocal 
Ecology and Biogeography (2020).
</p>
<p><a href="https://github.com/leondap/recluster">https://github.com/leondap/recluster</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load model data provided with the package 
## Not run: 
data(datamod)

#explore zero and tied values in the data set
simpdiss&lt;- recluster.dist(datamod)
recluster.hist(simpdiss)

#create and view unbiased consensus tree (100
constree_full&lt;-recluster.cons(datamod, tr=10, p=1)
plot(constree_full$cons,direction="downwards")

#compute and view node strength
recluster.node.strength(datamod, tr=10)

#create and view unbiased consensus tree (50
constree_half&lt;-recluster.cons(datamod, tr=10, p=0.5)
plot(constree_half$cons, direction="downwards")

#the latter is the correct tree
tree&lt;-constree_half$cons

#perform and view bootstrap on nodes
boot&lt;-recluster.boot(tree, datamod, tr=10, p=0.5, boot=50)
recluster.plot(tree,boot)

#perform and view multiscale bootstrap on nodes
multiboot&lt;- recluster.multi(tree, datamod, tr=10, boot=50, levels=2, step=1)
recluster.plot(tree,multiboot,low=1,high=2, direction="downwards")

#project and plot a bi-dimensional plot in the RGB colour space
sordiss&lt;- recluster.dist(datamod,dist="sorensen")
points&lt;-cmdscale(sordiss)
col&lt;-recluster.col(points)
recluster.plot.col(col)

#inspect explained diversity for different cuts of a tree
tree&lt;-recluster.cons(datamod, dist="sorensen",tr=10, p=0.5)
expl_div&lt;-recluster.expl.diss(tree$cons,sordiss)
expl_div

#Select cut #4 and group data in RGB space
ncol&lt;-recluster.group.col(col,expl_div$matrix[,4])

#Plot mean values for clusters
recluster.plot.col(ncol$aggr)

#Plot mean colours for sites in the geographic space
lat&lt;-c(2,2,2,1,3,1,1,3,3)
long&lt;-c(1,5,3,3,3,1,5,1,5)
recluster.plot.sites.col(long, lat, ncol$all,text=TRUE)

#Use recluster.region procedure on island butterflies
data(dataisl)
simpson&lt;-recluster.dist(dataisl)
turn_cl&lt;-recluster.region(simpson,tr=10,rettree=TRUE)
turn_cl

#Select solution with three cluster and plot the tree.
plot(turn_cl$tree[[2]])
turn_cl$grouping

#Perform a procrustes with uneven sample size
#Create and plot a target matrix
ex1 &lt;-rbind(c(1,5),c(5,5),c(3,4),c(3,6))
plot(ex1,col=c(1:4),pch=19,xlim=c(0,6),ylim=c(0,6),cex=2)
#Create and plot a matrix to be rotated. Only the points 1-4 are shared
ex2&lt;-rbind(c(3,1),c(3,3),c(2.5,2),c(3.5,2),c(3,4))
plot(ex2,col=c(1:5),pch=19,xlim=c(0,6),ylim=c(0,6),cex=2)

#Perform the procrustes on points 1-4
#Apply the transformation to point 5 of ex2 and plot the matrices
procr1&lt;-recluster.procrustes(ex1,ex2,num=4)
plot(procr1$X,col=c(1:4),pch=19,xlim=c(-4,4),ylim=c(-4,4),cex=2)
plot(procr1$Yrot,col=c(1:5),pch=19,xlim=c(-4,4),ylim=c(-4,4),cex=2)

## End(Not run)
</code></pre>

<hr>
<h2 id='recluster.boot'>
Bootstrap nodes of consensus trees
</h2><span id='topic+recluster.boot'></span>

<h3>Description</h3>

<p>Given an initial tree and a data matrix, this function computes bootstrap for nodes. Each tree used for bootstrap is constructed by re-sampling the row order several times and by applying a consensus rule as done by recluster.cons. The number of sampled columns (species) can be varied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.boot(tree, mat, phylo = NULL, tr = 100, p = 0.5, 
dist = "simpson", method = "average", boot = 1000, level = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.boot_+3A_tree">tree</code></td>
<td>

<p>A reference phylo tree for sites presumably constructed with recluster.cons function.
</p>
</td></tr>
<tr><td><code id="recluster.boot_+3A_mat">mat</code></td>
<td>

<p>The matrix used to construct the tree.
</p>
</td></tr>
<tr><td><code id="recluster.boot_+3A_phylo">phylo</code></td>
<td>

<p>An ultrametric and rooted tree for species phylogeny having the same labels of the mat columns. Only required for phylogenetic beta-diversity indices.
</p>
</td></tr>
<tr><td><code id="recluster.boot_+3A_tr">tr</code></td>
<td>

<p>The number of trees to be included in the consensus.
</p>
</td></tr>
<tr><td><code id="recluster.boot_+3A_p">p</code></td>
<td>

<p>A numeric value between 0.5 and 1 giving the proportion for a clade to be represented in the consensus tree.
</p>
</td></tr>
<tr><td><code id="recluster.boot_+3A_dist">dist</code></td>
<td>

<p>A beta-diversity index (the Simpson index by default) included in recluster.dist or any custom binary dissimilarity to be specified according to the syntax of designdist function of the vegan package.
</p>
</td></tr>
<tr><td><code id="recluster.boot_+3A_method">method</code></td>
<td>

<p>Any clustering method allowed by hclust.
</p>
</td></tr>
<tr><td><code id="recluster.boot_+3A_boot">boot</code></td>
<td>

<p>The number of trees used for bootstrap computation.
</p>
</td></tr>
<tr><td><code id="recluster.boot_+3A_level">level</code></td>
<td>

<p>The ratio between the number of species to be included in the analysis and the original number of species in the mat matrix.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computation can be time consuming due to the high number of trees required for analysis. It is suggested to assess the degree of row bias by recluster.hist and recluster.node.strength to optimize the number of required consensus trees before starting the analysis.
</p>


<h3>Value</h3>

<p>A vector indicating the percentage of bootstrap trees replicating each original node.
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
tree&lt;-recluster.cons(datamod,tr=10)
boot&lt;-recluster.boot(tree$cons,tr=5,boot=50,datamod)
recluster.plot(tree$cons,boot,direction="downwards")

data(treemod)
tree&lt;-recluster.cons(datamod,treemod, dist="phylosort", tr=10)
boot&lt;-recluster.boot(tree$cons, datamod, treemod,tr=5,boot=50)
recluster.plot(tree$cons,boot,direction="downwards")

</code></pre>

<hr>
<h2 id='recluster.check'>
An internal workaround for the new ape package
</h2><span id='topic+recluster.check'></span>

<h3>Description</h3>

<p>This function solve a label problem producing unreliable low values of bootstrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.check(tree, tip)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.check_+3A_tree">tree</code></td>
<td>

<p>An object of class phylo
</p>
</td></tr>
<tr><td><code id="recluster.check_+3A_tip">tip</code></td>
<td>

<p>A tip name
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An oject of the class phylo
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>

<hr>
<h2 id='recluster.col'>
Projecting a two dimensional plot in RGB space
</h2><span id='topic+recluster.col'></span>

<h3>Description</h3>

<p>This function projects a two dimensional matrix into a RGB space with red, green, yellow and blue at its four corners. RGB combination for each case corresponding to its position in this space is provided together with new coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.col(mat,st=TRUE,rot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.col_+3A_mat">mat</code></td>
<td>

<p>A matrix containing two dimensional coordinates for cases.
</p>
</td></tr>
<tr><td><code id="recluster.col_+3A_st">st</code></td>
<td>

<p>Logical, if TRUE then values in axes are standardized between 0 and 1, if FALSE then original values are maintained.
</p>
</td></tr>
<tr><td><code id="recluster.col_+3A_rot">rot</code></td>
<td>

<p>Logical, if TRUE then the axis with highest variance is oriented on the x-axis.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the first two columns representing the coordinates and the third, fourth and fifth representing the red, green and blue components, respectively. 	
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Kreft H., Jetz, W. 
&quot;A framework for delineating biogeographic regions based on species distributions&quot; 
J Biogeogr (2010),37: 2029-2053.
</p>
<p>Dapporto, L., Fattorini, S., Voda, R., Dinca, V., Vila, R. &quot;Biogeography of western Mediterranean butterflies: combining turnover and nestedness components of faunal dissimilarity.&quot; 
J Biogeogr (2014), 41: 1639-1650.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
sordiss&lt;- recluster.dist(datamod,dist="sorensen")
points&lt;-cmdscale(sordiss)
col&lt;-recluster.col(points)
col
</code></pre>

<hr>
<h2 id='recluster.cons'>
Consensus tree among re-sampled trees 
</h2><span id='topic+recluster.cons'></span>

<h3>Description</h3>

<p>This function creates a series of trees by resampling the order of sites in the original dissimilarity matrix. Then, it computes a consensus among them. The resulting tree is independent of the original row order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.cons(mat, phylo = NULL, tr = 100, p = 0.5, 
dist = "simpson", method = "average", blenghts=TRUE, select=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.cons_+3A_mat">mat</code></td>
<td>

<p>A matrix containing sites (rows) and species (columns) or any dissimilarity matrix.
</p>
</td></tr>
<tr><td><code id="recluster.cons_+3A_phylo">phylo</code></td>
<td>

<p>An ultrametric and rooted tree for species phylogeny having the same labels as in mat columns. Only required to compute phylogenitic beta-diversity indexes.
</p>
</td></tr>
<tr><td><code id="recluster.cons_+3A_tr">tr</code></td>
<td>

<p>The number of trees to be used for the consensus.
</p>
</td></tr>
<tr><td><code id="recluster.cons_+3A_p">p</code></td>
<td>

<p>A numeric value between 0.5 and 1 giving the proportion for a clade to be represented in the consensus tree.
</p>
</td></tr>
<tr><td><code id="recluster.cons_+3A_dist">dist</code></td>
<td>

<p>A beta-diversity index (the Simpson index by default) included in recluster.dist or any custom binary dissimilarity to be specified according to the syntax of designdist function of the vegan package.
</p>
</td></tr>
<tr><td><code id="recluster.cons_+3A_method">method</code></td>
<td>

<p>Any clustering method allowed by hclust.
</p>
</td></tr>
<tr><td><code id="recluster.cons_+3A_blenghts">blenghts</code></td>
<td>

<p>A logical indicating if non-negative least squares branch lengths should be computed.
</p>
</td></tr>
<tr><td><code id="recluster.cons_+3A_select">select</code></td>
<td>

<p>A logical indicating if only trees having a fit higher than the median value in the least squares regression should be included in the consensus analysis.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>According to the primitive &quot;consensus&quot; function from the &quot;ape&quot; package, p must range between 0.5 and 1. Select = TRUE can allow lowering polytomies by removing trees with topology showing particularly low correlation with the distance matrix. Row names are required.
</p>


<h3>Value</h3>

<table>
<tr><td><code>cons</code></td>
<td>

<p>The consensus tree, an object of class phylo.
</p>
</td></tr>
<tr><td><code>trees</code></td>
<td>

<p>The trees used to construct the final consensus tree.
</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>

<p>The Residual Sum of Squares for the trees resulting if select=TRUE.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Faunistic beta diversity
data(datamod,treemod)
tree&lt;-recluster.cons(datamod,tr=10)
plot(tree$cons,direction="downwards")

#Phylogenetic beta diversity
tree_p&lt;-recluster.cons(datamod,treemod,dist="phylosort",tr=10)
plot(tree_p$cons, direction="downwards")
</code></pre>

<hr>
<h2 id='recluster.dist'>
Compute a dissimilarity matrix using a battery of beta-diversity indices
</h2><span id='topic+recluster.dist'></span>

<h3>Description</h3>

<p>This function computes dissimilarity matrices based on the two most popular partitions of faunistic and phylogenitic beta-diversity. In particular Jaccard = beta3 + richness (Carvalho et al. 2012), Jaccard = Jturnover + Jnestedness (Baselga, 2012) and Sorensen = Simpson + nestedness (Baselga 2010) for faunistic indexes and Unifrac = Unifrac_turn + Unifrac_PD and PhyloSor = PhyloSor_turn + Phylosor_PD (Leprieur et al. 2012). Any other binary index can be included in brackets by using the syntax of designdist function of the vegan package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.dist(mat, phylo=NULL, dist="simpson")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.dist_+3A_mat">mat</code></td>
<td>

<p>A matrix containing sites (rows) and species (columns).
</p>
</td></tr>
<tr><td><code id="recluster.dist_+3A_phylo">phylo</code></td>
<td>

<p>An ultrametric and rooted phylogenetic tree for species having the same labels as in mat columns. Only required for phylogenitic beta-diversity indexes.
</p>
</td></tr>
<tr><td><code id="recluster.dist_+3A_dist">dist</code></td>
<td>

<p>One among the 14 beta-diversity indexes <code>"simpson" "sorensen" "nestedness" "beta3" "richness" "jaccard" "jturnover" "jnestedness" "phylosor" "phylosort" "phylosorpd" "unifrac" "unifract" "unifracpd"</code>. Any custom binary dissimilarity can also be specified according to the syntax of designdist function of the vegan package.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Syntax for binary indices in vegdist: J, number of common species; A and B, number of species exclusive of the first and of the second site. 
</p>


<h3>Value</h3>

<p>An object of class dist (see vegan:designdist for further details)
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Baselga A. 
&quot;Partitioning the turnover and nestedness components of beta diversity.&quot; 
Global Ecol Biogeogr (2010), 19: 134-143.
</p>
<p>Carvalho J. C., Cardoso P., Gomes P. 
&quot;Determining the relative roles of species replacement and species richness differences in generating beta-diversity patterns.&quot; 
Global Ecol Biogeogr (2012), 21: 760-771. 
</p>
<p>Leprieur F., Albouy C., De Bortoli J., Cowman P.F., Bellwood D.R., Mouillot D.  
&quot;Quantifying Phylogenetic Beta Diversity: Distinguishing between 'True' Turnover of Lineages and Phylogenetic Diversity Gradients.&quot;
Plos One (2012), 7
</p>

<hr>
<h2 id='recluster.expl'>
Computes the dissimilarity contained in a distance matrix which is explained by a clustering solution.
</h2><span id='topic+recluster.expl'></span>

<h3>Description</h3>

<p>This function computes the fraction of the distances contained in a dissimilarity matrix which is explained by a clustering solution of the elements. The value is obtained by computing the sum of all the dissimilarity values among elements belonging to different clusters and divided by the sum of all the cells of the original dissimilarity matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.expl(mat, clust)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.expl_+3A_mat">mat</code></td>
<td>

<p>A dissimilarity matrix
</p>
</td></tr>
<tr><td><code id="recluster.expl_+3A_clust">clust</code></td>
<td>

<p>A clustering solution for the cases contained in the dissimilarity matrix.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A number ranging between 0 and 1 indicating the fraction of explained dissimilarity.
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Holt, B.G. et al 
&quot;An Update of Wallace's Zoogeographic Regions of the World.&quot;
Science, 339:74-78.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
sor_tree&lt;- recluster.cons(datamod, dist="sorensen")
sor_diss &lt;- recluster.dist (datamod, dist="sorensen")
expl_diss &lt;- recluster.expl.diss (sor_tree$cons,sor_diss)
expl_diss 
</code></pre>

<hr>
<h2 id='recluster.expl.diss'>
Cuts a phylogenetic tree to a given series of nodes and computes explained dissimilarity.
</h2><span id='topic+recluster.expl.diss'></span>

<h3>Description</h3>

<p>This function cuts a phylogenetic tree at any given series of nodes, provides membership for each element in the series of resulting clusters and computes the fraction of dissimilarity explained by each cut.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.expl.diss(tree, dist, maxcl=NULL, mincl=NULL, expld=TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.expl.diss_+3A_tree">tree</code></td>
<td>

<p>A phylo tree
</p>
</td></tr>
<tr><td><code id="recluster.expl.diss_+3A_dist">dist</code></td>
<td>

<p>A dissimilarity matrix.
</p>
</td></tr>
<tr><td><code id="recluster.expl.diss_+3A_maxcl">maxcl</code></td>
<td>

<p>A custom number indicating the most external node to be cut. If NULL all the nodes are cut.
</p>
</td></tr>
<tr><td><code id="recluster.expl.diss_+3A_mincl">mincl</code></td>
<td>

<p>A custom number indicated the most internal node to be cut. If NULL the root is used
</p>
</td></tr>
<tr><td><code id="recluster.expl.diss_+3A_expld">expld</code></td>
<td>

<p>A logical. If TRUE then the matrix for explained dissimilarity is computed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When polytomic nodes are involved in a cut the number of clusters at that cut will increase more than one unit. Holt at al. (2013) identified levels of explained dissimilarity to be used as a reliable threshold to assess a tree cut. When cases are highly numerous maxcl can be set in order to avoid a very long computation
</p>


<h3>Value</h3>

<table>
<tr><td><code>matrix</code></td>
<td>

<p>A matrix indicating cluster membership of each site in each cut of the tree.
</p>
</td></tr>
<tr><td><code>expl.div</code></td>
<td>

<p>A vector indicating the explained dissimilarity for each cut.
</p>
</td></tr>
<tr><td><code>nclust</code></td>
<td>

<p>A vector indicating the number of clusters resulting from each cut.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Dapporto L., Ciolli G., Dennis R.L.H., Fox R., Shreeve, T.G. &quot;A new procedure for extrapolating turnover regionalization at mid?small spatial scales, tested on B ritish butterflies.&quot;
Methods in Ecology and Evolution (2015), 6:1287-1297.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
sor_tree&lt;- recluster.cons(datamod, dist="sorensen")
sor_diss &lt;- recluster.dist (datamod, dist="sorensen")
expl_diss &lt;- recluster.expl.diss (sor_tree$cons,sor_diss)
expl_diss 
</code></pre>

<hr>
<h2 id='recluster.fst'>
Compute some indexes of genetic differentiation
</h2><span id='topic+recluster.fst'></span>

<h3>Description</h3>

<p>This function computes some indexes of genetic differentiation based on a distance matrix and on a vector for populations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.fst(dist,vect,setzero=F,setnazero=F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.fst_+3A_dist">dist</code></td>
<td>

<p>A distance matrix.
</p>
</td></tr>
<tr><td><code id="recluster.fst_+3A_vect">vect</code></td>
<td>

<p>A vector indicating population membership. Cases must be in the some order of the distance matrix.
</p>
</td></tr>
<tr><td><code id="recluster.fst_+3A_setzero">setzero</code></td>
<td>

<p>A logical indicating if negative values should be set to zero
</p>
</td></tr>
<tr><td><code id="recluster.fst_+3A_setnazero">setnazero</code></td>
<td>

<p>A logical indicating if NA values should be set to zero
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There has been a large dabate around FST like indexes. Two main indexes are culcalated by this function: the absolute differentiation (Dst) and the standardized differentiation (Gst) (Nei, 1987) .Dst is calculated as: 
Dst = Ht - Hs
where Ht represents the average distances among all the specimens in the sample, and Hs is the average of the intra-area (or intra-sub-area) distances. Thus, Dst represents the average genetic differentiation among areas in p-distance units. Gst is a standardized index defined as:
Gst = Dst/Ht
representing the fraction of the total genetic differentiation encompassed by the differentiation among areas (Nei, 1987). This index ranges from negative values to 1 (complete differentiation). 
Negative values in Gst and Dst (intra-area differentiation higher than inter-area differentiation) can have different subtle meanings, but are most often generated as bias due to relatively small sample sizes; usually they are set to zero (Meirmans &amp; Hedrick, 2011) and we applied this solution. 
In the species showing no mutations in the sample, Gst returns a NA value (while Dst equals to zero). These cases can be also set to zero
The use of Dst and Gst has been debated as a measure of population diversification for extremely variable markers (as micro-satellites) as it tends to underestimate differentiation among populations and to strongly depend on intra-population variability (Jost, 2008; Whitlock, 2011). D and G-st indices are less affected by high values of Hs 
</p>


<h3>Value</h3>

<table>
<tr><td><code>Ht</code></td>
<td>

<p>The average distances among all the specimens in the sample.
</p>
</td></tr>
<tr><td><code>lengthHt</code></td>
<td>

<p>The number of distances among all the specimens in the sample.
</p>
</td></tr>
<tr><td><code>Hs</code></td>
<td>

<p>The average distances among the specimens of the same populations.
</p>
</td></tr>
<tr><td><code>lengthHs</code></td>
<td>

<p>The number of distances among the specimens of the same populations.
</p>
</td></tr>
<tr><td><code>Dst</code></td>
<td>

<p>The Dst value.
</p>
</td></tr>
<tr><td><code>Gst</code></td>
<td>

<p>The Gst value.
</p>
</td></tr>
<tr><td><code>D</code></td>
<td>

<p>The D value.
</p>
</td></tr>
<tr><td><code>G1st</code></td>
<td>

<p>The G'st value.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Jost L. 
&quot;GST and its relatives do not measure differentiation.&quot;
Mol Ecol (2008), 17:4015-4026.
</p>
<p>Meirmans P. G., Hedrick P. W. 
&quot;Assessing population structure: FST and related measures: Invited Technical Reviwev.&quot;
Mol Ecol Res (2011), 11: 5-18.
</p>
<p>Nei M. 
Molecular evolutionary genetics (1987), Columbia University Press.
</p>
<p>Whitlock M.C. 
&quot;G'ST and D do not replace FST.&quot; Mol Ecol (2011), 20: 1083-1091.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>datavirtual&lt;-data.frame(replicate(10,sample(0:1,30,rep=TRUE)))
dist&lt;-recluster.dist(datavirtual)
population&lt;-c(rep(1,20),rep(2,20),rep(3,20))
recluster.fst(dist,population)
</code></pre>

<hr>
<h2 id='recluster.fst.pair'>
Compute pairwise indexes of genetic differentiation among populations
</h2><span id='topic+recluster.fst.pair'></span>

<h3>Description</h3>

<p>This function computes pairwise indexes of genetic differentiation among populations based on a distance matrix and on a vector for populations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.fst.pair(dist,vect,setzero=F,setnazero=F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.fst.pair_+3A_dist">dist</code></td>
<td>

<p>A distance matrix.
</p>
</td></tr>
<tr><td><code id="recluster.fst.pair_+3A_vect">vect</code></td>
<td>

<p>A vector indicating population membership. Cases must be in the some order of the distance matrix.
</p>
</td></tr>
<tr><td><code id="recluster.fst.pair_+3A_setzero">setzero</code></td>
<td>

<p>A logical indicating if negative values should be set to zero
</p>
</td></tr>
<tr><td><code id="recluster.fst.pair_+3A_setnazero">setnazero</code></td>
<td>

<p>A logical indicating if NA values should be set to zero
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formulas used for pairwise calculations between i and j populations are 
Dstij = Htij - Hsij
Gstij = Dstij/Ht
Dij = (Dstij/(1-Hsij))*2
G'stij = Gstij/((1-Hsij)/(1+Hsij))
see also recluster.fst for a discussion of indexes
</p>


<h3>Value</h3>

<table>
<tr><td><code>Dstm</code></td>
<td>

<p>The Dst distance matrix.
</p>
</td></tr>
<tr><td><code>Gstm</code></td>
<td>

<p>The Gst distance matrix.
</p>
</td></tr>
<tr><td><code>Dm</code></td>
<td>

<p>The D distance matrix.
</p>
</td></tr>
<tr><td><code>G1stm</code></td>
<td>

<p>The G'st distance matrix.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Jost L. 
&quot;GST and its relatives do not measure differentiation.&quot;
Mol Ecol (2008), 17:4015-4026.
</p>
<p>Meirmans P. G., Hedrick P. W. 
&quot;Assessing population structure: FST and related measures: Invited Technical Reviwev.&quot;
Mol Ecol Res (2011), 11: 5-18.
</p>
<p>Nei M. 
Molecular evolutionary genetics (1987), Columbia University Press.
</p>
<p>Whitlock M.C. 
&quot;G'ST and D do not replace FST.&quot; Mol Ecol (2011), 20: 1083-1091.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>datavirtual&lt;-data.frame(replicate(20,sample(0:1,60,rep=TRUE)))
dist&lt;-recluster.dist(datavirtual)
population&lt;-c(rep(1,20),rep(2,20),rep(3,20))
recluster.fst.pair(dist,population)
</code></pre>

<hr>
<h2 id='recluster.group.col'>
Computes mean coordinate values and RGB colours.
</h2><span id='topic+recluster.group.col'></span>

<h3>Description</h3>

<p>This function computes barycenters and their RGB colours for cases belonging to the same group from an original RGB colour matrix obtained by recluster.col.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.group.col(mat,member)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.group.col_+3A_mat">mat</code></td>
<td>

<p>An inherited matrix from recluster.col containing the original RGB colour space.
</p>
</td></tr>
<tr><td><code id="recluster.group.col_+3A_member">member</code></td>
<td>

<p>A vector indicating group membership for each case.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>aggr</code></td>
<td>

<p>A matrix in the recluster.col format with mean values for coordinates and RGB colours for groups.
</p>
</td></tr>
<tr><td><code>all</code></td>
<td>

<p>A matrix in the recluster.col format reporting mean RGB colours of the group of each original case.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Kreft H., Jetz, W.
&quot;A framework for delineating biogeographic regions based on species distributions&quot; 
J Biogeogr (2010),37: 2029-2053.
</p>
<p>Dapporto, L., Fattorini, S., Voda, R., Dinca, V., Vila, R. &quot;Biogeography of western Mediterranean butterflies: combining turnover and nestedness components of faunal dissimilarity.&quot; 
J Biogeogr (2014), 41: 1639-1650. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
sordiss&lt;- recluster.dist(datamod,dist="sorensen")
points&lt;-cmdscale(sordiss)
col&lt;-recluster.col(points)
group&lt;-c(1,2,3,3,3,1,2,1,2)
ncol&lt;-recluster.group.col(col,group)
recluster.plot.col(ncol$aggr)
</code></pre>

<hr>
<h2 id='recluster.hist'>
Histogram of dissimilarity with tied and zero values
</h2><span id='topic+recluster.hist'></span>

<h3>Description</h3>

<p>This function creates a histogram with the values of a dissimilarity matrix where the number of cells with zero value are explicitely showed in the first bar. Moreover, it provides the percentage of cells having equal values in the matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.hist(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.hist_+3A_x">x</code></td>
<td>

<p>A dissimilarity matrix.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An histogram with supplementary information. The first bar only shows the zero values.
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
simpdiss&lt;- recluster.dist(datamod)
recluster.hist(simpdiss)
</code></pre>

<hr>
<h2 id='recluster.identify.nodes'>
Evaluating solutions in multiscale bootstrap
</h2><span id='topic+recluster.identify.nodes'></span>

<h3>Description</h3>

<p>This function helps to understand different behaviours of node supports in multiscale bootstrap by i) plotting trends of support values in different bootstrap scales, ii) identifying the boostrap scale with highest diversification between two groups of nodes and iii) identifying nodes into two classes according to the best bootstrap level identified in (ii) and ploting their mean support values. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.identify.nodes(mat, low=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.identify.nodes_+3A_mat">mat</code></td>
<td>

<p>A matrix containing nodes (rows) and bootstrap levels (columns) as obtained by recluster.multi.
</p>
</td></tr>
<tr><td><code id="recluster.identify.nodes_+3A_low">low</code></td>
<td>

<p>A logical value indicating if lower scales should be favoured in the selection.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function recognizes nodes showing different trends of support in multiscale bootstrap. In the analysis of turnover in biogeography some nodes may show a substantial increase in support in a multiscale bootstrap. Areas connected by these nodes may host a few species responsible for turnover, but the biogeographic pattern with respect is clear. Other nodes may show a slow (or no) increase in support. In this case, the links among areas can be considered as uncertain. Partitioning Around Medioids is used to identify two classes of nodes at each level, then the bootstrap scale showing the best diversification in two classes is identified by silhouette scores weighted by differences in mean values between classes. If &quot;low&quot; is set to TRUE the function favours low scales. 
</p>


<h3>Value</h3>

<p>A plot with bootstrap supports and their means (diamonds) for the best combination of two groups of nodes (black and red).
</p>
<table>
<tr><td><code>scale</code></td>
<td>

<p>The best bootstrap scale to identify two groups of nodes.
</p>
</td></tr>
<tr><td><code>nodes</code></td>
<td>

<p>A vector containing classification for nodes in the best bootstrap scale.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(multiboot)
recluster.identify.nodes(multiboot)
</code></pre>

<hr>
<h2 id='recluster.line'>
Identifies a line in a configuration and computes its intercept and angular coefficient</h2><span id='topic+recluster.line'></span>

<h3>Description</h3>

<p>This function identifies a line in a configuration based on different criteria and produces its slope and intercept values. I can be used together with recluster.rotate to rotate a configuration based on a custom line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.line(mat,type="maxd",X1=NULL,X2=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.line_+3A_mat">mat</code></td>
<td>

<p>The bidimensional configuration.
</p>
</td></tr>
<tr><td><code id="recluster.line_+3A_type">type</code></td>
<td>

<p>The type of line to be computed: &quot;maxd&quot; is the line connecting the most distant points, &quot;regression&quot; is the regression line between X and Y values, &quot;points&quot; is the line connecting two custom points of the configuration (X1 and X2).
</p>
</td></tr>
<tr><td><code id="recluster.line_+3A_x1">X1</code></td>
<td>

<p>The row number in mat of the first custom point.
</p>
</td></tr>
<tr><td><code id="recluster.line_+3A_x2">X2</code></td>
<td>

<p>The row number in mat of the second custom point.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>m</code></td>
<td>

<p>The slope of the line.
</p>
</td></tr>
<tr><td><code>q</code></td>
<td>

<p>The intercept of the line.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Dapporto L., Voda R., Dinca V., Vila R.
&quot;Comparing population patterns for genetic and morphological markers with uneven sample sizes. An example for the butterfly Maniola jurtina&quot;
Methods Ecol Evol (2014), 5, 834-843.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataisl)
#Compute bidimensional representation for islands
pcoa&lt;-cmdscale(recluster.dist(dataisl))
#Compute the line
lin&lt;-recluster.line(pcoa)
</code></pre>

<hr>
<h2 id='recluster.multi'>
Multiscale bootstrap based on a consensus tree
</h2><span id='topic+recluster.multi'></span>

<h3>Description</h3>

<p>Given an initial tree and a data matrix, this function computes bootstrap for nodes as done by recluster.boot. Different levels of bootstrap can be computed by varying the proportions of species sampled from the original matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.multi(tree, mat, phylo = NULL, tr = 100, p = 0.5, 
dist = "simpson", method = "average", boot = 1000, levels = 2, step = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.multi_+3A_tree">tree</code></td>
<td>

<p>A reference phylo tree for sites presumably constructed with recluster.cons function.
</p>
</td></tr>
<tr><td><code id="recluster.multi_+3A_mat">mat</code></td>
<td>

<p>The matrix used to construct the tree.
</p>
</td></tr>
<tr><td><code id="recluster.multi_+3A_phylo">phylo</code></td>
<td>

<p>An ultrametric and rooted phylo tree for species having the same labels as in mat columns. Only required for phylogenetic beta-diversity indexes.
</p>
</td></tr>
<tr><td><code id="recluster.multi_+3A_tr">tr</code></td>
<td>

<p>The number of trees to be included in the consensus.
</p>
</td></tr>
<tr><td><code id="recluster.multi_+3A_p">p</code></td>
<td>

<p>A numeric value between 0.5 and 1 giving the proportion for a clade to be represented in the consensus tree.
</p>
</td></tr>
<tr><td><code id="recluster.multi_+3A_dist">dist</code></td>
<td>

<p>One among the twelve beta-diversity indexes <code>"simpson" "sorensen" "nestedness" "beta3" "richness" "jaccard" "phylosor" "phylosort" "phylosorpd" "unifrac" "unifract" "unifractpd"</code>. Any custom binary dissimilarity can also be specified according to the syntax of designdist function of the vegan package.
</p>
</td></tr>
<tr><td><code id="recluster.multi_+3A_method">method</code></td>
<td>

<p>Any clustering method allowed by hclust.
</p>
</td></tr>
<tr><td><code id="recluster.multi_+3A_boot">boot</code></td>
<td>

<p>The number of trees used for bootstrap computation.
</p>
</td></tr>
<tr><td><code id="recluster.multi_+3A_levels">levels</code></td>
<td>

<p>The number of levels to be used in multiscale bootstrap.
</p>
</td></tr>
<tr><td><code id="recluster.multi_+3A_step">step</code></td>
<td>

<p>The increase in ratio between the first level (x1) and the next ones.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computation can be time consuming. It is suggested to assess the degree of row bias by recluster.hist and recluster.node.strength to optimize the number of consensus trees before starting the analysis.
</p>


<h3>Value</h3>

<p>A matrix indicating the percentage of bootstrap trees replicating each node for each level.
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
tree&lt;-recluster.cons(datamod,tr=10)
multiboot&lt;-recluster.multi(tree$cons,tr=10,boot=50,datamod,levels=2,step=1)
recluster.plot(tree$cons,multiboot,1,2,direction="downwards")
</code></pre>

<hr>
<h2 id='recluster.node.strength'>
Evaluating order row bias in a cluster
</h2><span id='topic+recluster.node.strength'></span>

<h3>Description</h3>

<p>This function helps to understand the magnitude of row bias by computing a first tree with the original order of areas. Then it creates a default series of six trees by recluster.cons with increasing consensus rule from 50
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.node.strength(mat, phylo = NULL, dist = "simpson", 
nodelab.cex=0.8, tr = 100, levels=6, method = "average", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.node.strength_+3A_mat">mat</code></td>
<td>

<p>A matrix containing sites (rows) and species (columns).
</p>
</td></tr>
<tr><td><code id="recluster.node.strength_+3A_phylo">phylo</code></td>
<td>

<p>An ultrametric and rooted phylogenetic tree for species having the same labels as in mat columns. Only required for phylogenitic beta-diversity indexes.
</p>
</td></tr>
<tr><td><code id="recluster.node.strength_+3A_tr">tr</code></td>
<td>

<p>The number of trees to be used for the consensus.
</p>
</td></tr>
<tr><td><code id="recluster.node.strength_+3A_dist">dist</code></td>
<td>

<p>A beta-diversity index (the Simpson index by default) included in recluster.dist or any custom binary dissimilarity to be specified according to the syntax of designdist function of the vegan package.
</p>
</td></tr>
<tr><td><code id="recluster.node.strength_+3A_nodelab.cex">nodelab.cex</code></td>
<td>

<p>the cex() parameter for controlling the size of the labels on the nodes (see <code>?nodelabels</code>).
</p>
</td></tr>
<tr><td><code id="recluster.node.strength_+3A_levels">levels</code></td>
<td>

<p>The number of levels of different consensus threshold to be used.
</p>
</td></tr>
<tr><td><code id="recluster.node.strength_+3A_method">method</code></td>
<td>

<p>Any clustering method allowed by hclust.
</p>
</td></tr>
<tr><td><code id="recluster.node.strength_+3A_...">...</code></td>
<td>

<p>Arguments to be passed to plot.phylo methods, see the ape package manual and <code>?plot.phylo</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It has to be noted that values obtained by this function are not bootstrap supports for nodes but a crude indication of the magnitude of the row bias. Nodes with low value in this analysis can have strong bootstrap support and vice versa. This preliminary analysis can avoid that the use of a strict consensus (100
</p>


<h3>Value</h3>

<p>A cluster with percentages of recurrence over different consensus runs for each node.
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
recluster.node.strength(datamod, tr=10)
</code></pre>

<hr>
<h2 id='recluster.plot'>
A plotter for recluster bootstrapped objects
</h2><span id='topic+recluster.plot'></span>

<h3>Description</h3>

<p>This function produces plots for recluster trees and assignes single or pairs of support values belonging to single or multiscale analyses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.plot(tree, data, low = 1, high = 0, id=NULL, 
nodelab.cex=0.8, direction="downwards",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.plot_+3A_tree">tree</code></td>
<td>

<p>A phylo tree presumably constructed with recluster.cons function.
</p>
</td></tr>
<tr><td><code id="recluster.plot_+3A_data">data</code></td>
<td>

<p>A matrix belonging to recluster.multi.
</p>
</td></tr>
<tr><td><code id="recluster.plot_+3A_id">id</code></td>
<td>

<p>A vector used to mark node supports (low and high) with different colours. Such classificarion is presumably made by recluster.identify.nodes.
</p>
</td></tr>
<tr><td><code id="recluster.plot_+3A_low">low</code></td>
<td>

<p>The low scale level for which bootstrap values should be indicated in the tree.
</p>
</td></tr>
<tr><td><code id="recluster.plot_+3A_high">high</code></td>
<td>

<p>The high scale level for which bootstrap values should be indicated in the tree.
</p>
</td></tr>
<tr><td><code id="recluster.plot_+3A_nodelab.cex">nodelab.cex</code></td>
<td>

<p>the cex() parameter for controlling the size of the labels on the nodes (see <code>?nodelabels</code>).
</p>
</td></tr>
<tr><td><code id="recluster.plot_+3A_direction">direction</code></td>
<td>

<p>the <code>direction</code> parameter for controlling the orientation of the plot, see the ape package manual and <code>?plot.phylo</code>.
This parameters also controls the display of the labels on nodes.
</p>
</td></tr>
<tr><td><code id="recluster.plot_+3A_...">...</code></td>
<td>

<p>Arguments to be passed to plot.phylo methods, see the ape package manual and <code>?plot.phylo</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to print on a tree, one or two labels for bootstrap values and optimize their layout.
This is done with the <code>nodelabels</code> ape function, by specifying the <code>adj</code> parameters in the appropriate way.
</p>


<h3>Value</h3>

<p>A plot representing the tree with pairs of bootstrap values, below (usually x1 BP above) and high, above.
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
tree&lt;-recluster.cons(datamod, tr=10)
boot&lt;-recluster.boot(tree$cons,datamod, tr=10, boot=50)
recluster.plot(tree$cons,boot,direction="downwards")
</code></pre>

<hr>
<h2 id='recluster.plot.col'>
Plotting data in RGB space
</h2><span id='topic+recluster.plot.col'></span>

<h3>Description</h3>

<p>This function plots a matrix obtained by recluster.col in the RGB space. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.plot.col(mat,cext=0.3,cex=1,cex.axis=0.7,cex.lab=0.8,pch=16,text=TRUE,
add=F,xlim=NULL,ylim=NULL,ylab="Axis 2",xlab="Axis 1",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.plot.col_+3A_mat">mat</code></td>
<td>

<p>A matrix inherited by recluster.col.
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_cext">cext</code></td>
<td>

<p>Dimension for labels of row names.
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_cex">cex</code></td>
<td>

<p>Dimension of dots.
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_cex.axis">cex.axis</code></td>
<td>

<p>Dimension of axis labels.
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_cex.lab">cex.lab</code></td>
<td>

<p>Dimension of labels.
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_text">text</code></td>
<td>

<p>A logical indicating if row names should be plotted.
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_pch">pch</code></td>
<td>

<p>The shape of the dots (See par()).
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_add">add</code></td>
<td>

<p>A logical indicating if the plot should be added to a precedent graph.
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_xlim">xlim</code></td>
<td>

<p>The limit values for x-axis, if NULL the values in the orignal matrix is used.
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_ylim">ylim</code></td>
<td>

<p>The limit values for y-axis, if NULL the values in the orignal matrix is used.
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_ylab">ylab</code></td>
<td>

<p>The label of the y-axis
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_xlab">xlab</code></td>
<td>

<p>The label of the x-axis
</p>
</td></tr>
<tr><td><code id="recluster.plot.col_+3A_...">...</code></td>
<td>

<p>See par() for other graphical parameters
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A colour plot. 
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Kreft H., Jetz, W. 2010. 
&quot;A framework for delineating biogeographic regions based on species distributions&quot; 
J Biogeogr (2010),37: 2029-2053.
</p>
<p>Dapporto, L., Fattorini, S., Voda, R., Dinca, V., Vila, R. &quot;Biogeography of western Mediterranean butterflies: combining turnover and nestedness components of faunal dissimilarity.&quot; 
J Biogeogr (2014), 41: 1639-1650. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
sordiss&lt;- recluster.dist(datamod,dist="sorensen")
points&lt;-cmdscale(sordiss)
col&lt;-recluster.col(points)
recluster.plot.col(col)
</code></pre>

<hr>
<h2 id='recluster.plot.matrix'>
Plot the values of the cells of a matrix in grey scale
</h2><span id='topic+recluster.plot.matrix'></span>

<h3>Description</h3>

<p>This function plots the values of the cells of a matrix in grey scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.plot.matrix(mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.plot.matrix_+3A_mat">mat</code></td>
<td>

<p>A dissimilarity matrix.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of cell values.
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto, L., Fattorini, S., Voda, R., Dinca, V., Vila, R. &quot;Biogeography of western Mediterranean butterflies: combining turnover and nestedness components of faunal dissimilarity.&quot; 
J Biogeogr (2014), 41: 1639-1650. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
simpdiss&lt;- recluster.dist(datamod)
recluster.plot.matrix(simpdiss)
</code></pre>

<hr>
<h2 id='recluster.plot.pie'>
Plotting pies with RGB colours on a custom coordinate space
</h2><span id='topic+recluster.plot.pie'></span>

<h3>Description</h3>

<p>This function groups cases based on a space grid in a user defined set of coordinates 
(usually longitude and latitude) and plot them in pies using RGB colours. The function 
can either use an output from recluster.col function or compute colours based on any 
distance matrix where the cases are in the same order as in the latitude and longitude 
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.plot.pie(long, lat, mat=NULL, distance=NULL, loc=NULL, areas=NULL, square=2,
                   map=NULL,add=FALSE,minsize=NULL,proportional=T,xlim=NULL,ylim=NULL,
                   main=NULL,xlab=NULL,ylab=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.plot.pie_+3A_long">long</code></td>
<td>

<p>A vector indicating longitude for cases.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_lat">lat</code></td>
<td>

<p>A vector indicating latitude for cases.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_mat">mat</code></td>
<td>

<p>A matrix inherited by recluster.col.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_distance">distance</code></td>
<td>

<p>A dissimilarity matrix for cases.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_loc">loc</code></td>
<td>

<p>A list of localities to group cases, if available.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_square">square</code></td>
<td>

<p>The grid to be used to divide cases into groups (2 degrees latitude and longitude by 
default).
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_areas">areas</code></td>
<td>

<p>An additional vector to divide groups (e.g. islands versus continents).
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_map">map</code></td>
<td>

<p>A map to be plotted.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_add">add</code></td>
<td>

<p>A logical. If TRUE then the points are added to an existing graph.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_minsize">minsize</code></td>
<td>

<p>Dimension for the dimension of a single-case pie.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_proportional">proportional</code></td>
<td>

<p>A logical. If TRUE then the point area is proportional to the number of cases.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_xlim">xlim</code></td>
<td>

<p>Limits of the plot in the x-axis.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_ylim">ylim</code></td>
<td>

<p>Limits of the plot in the y-axis.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_main">main</code></td>
<td>

<p>The title of the graph.
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_xlab">xlab</code></td>
<td>

<p>The label of x-axis
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_ylab">ylab</code></td>
<td>

<p>The label of y-axis
</p>
</td></tr>
<tr><td><code id="recluster.plot.pie_+3A_...">...</code></td>
<td>

<p>See par() for other graphical parameters
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A colour plot. 
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Hernandez Roldan J.L., Dapporto L., Dinca V, Vicente J.C., Hornett E.A., Sichova J., 
Lukhtanov V.L., Talavera G. &amp; Vila, R. Integrative analyses unveil speciation linked to host plant shift in Spialia butterflies. Molecular Ecology (2016) 25: 4267-4284.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create a virtual dataset and a corresponding distance matrix
lat&lt;-runif(50,min=20,max=40)
long&lt;-runif(50,min=20,max=40)
datavirtual&lt;-data.frame(replicate(20,sample(0:1,50,rep=TRUE)))
dist&lt;-recluster.dist(datavirtual)

# Make a plot using a custom distance
recluster.plot.pie(long,lat,distance=dist,xlab="Longitude",ylab="Latitude")

# Make a plot using a recluster.col matrix
colours&lt;-recluster.col(cmdscale(dist))
recluster.plot.pie(long,lat,mat=colours,xlab="Longitude",ylab="Latitude")

# Make points of equal size
recluster.plot.pie(long,lat,mat=colours,xlab="Longitude", proportional=FALSE,
ylab="Latitude")

# Reduce the grid
recluster.plot.pie(long,lat,distance=dist,square=1, xlab="Longitude",ylab="Latitude")

# Reduce the size of the plots
recluster.plot.pie(long,lat,distance=dist,xlab="Longitude",ylab="Latitude", minsize=0.5)
# Use a custom colour matrix
pcoa&lt;-cmdscale(dist)
colour&lt;-recluster.col(pcoa)
recluster.plot.col(colour)
recluster.plot.pie(long,lat,mat=colour,xlab="Longitude",ylab="Latitude")

# Include an additional factor for separating dots in groups(e.g. two continents)
continent&lt;-rep(1,50)
continent[which(long&gt;25)]&lt;-2
recluster.plot.pie(long,lat,distance=dist,xlab="Longitude",ylab="Latitude", 
areas=continent)
</code></pre>

<hr>
<h2 id='recluster.plot.sites.col'>
Plotting RGB dots on a custom coordinate space
</h2><span id='topic+recluster.plot.sites.col'></span>

<h3>Description</h3>

<p>This function plots the RGB dots belonging to a matrix obtained by recluster.col on a user defined set of coordinates (usually longitude and latitude) for original sites. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.plot.sites.col (long, lat, mat, cext = 0.3, cex = 1, cex.axis = 0.7, 
cex.lab = 0.8, text = FALSE, pch=21, add = FALSE,...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.plot.sites.col_+3A_long">long</code></td>
<td>

<p>A vector indicating longitude for cases.
</p>
</td></tr>
<tr><td><code id="recluster.plot.sites.col_+3A_lat">lat</code></td>
<td>

<p>A vector indicating latitude for cases.
</p>
</td></tr>
<tr><td><code id="recluster.plot.sites.col_+3A_mat">mat</code></td>
<td>

<p>A matrix inherited by recluster.col.
</p>
</td></tr>
<tr><td><code id="recluster.plot.sites.col_+3A_text">text</code></td>
<td>

<p>A logical indicating if row names should be plotted.
</p>
</td></tr>
<tr><td><code id="recluster.plot.sites.col_+3A_cext">cext</code></td>
<td>

<p>Dimension for row names.
</p>
</td></tr>
<tr><td><code id="recluster.plot.sites.col_+3A_cex">cex</code></td>
<td>

<p>Dimension of dots.
</p>
</td></tr>
<tr><td><code id="recluster.plot.sites.col_+3A_cex.axis">cex.axis</code></td>
<td>

<p>Dimension of axis labels.
</p>
</td></tr>
<tr><td><code id="recluster.plot.sites.col_+3A_cex.lab">cex.lab</code></td>
<td>

<p>Dimension of labels.
</p>
</td></tr>
<tr><td><code id="recluster.plot.sites.col_+3A_add">add</code></td>
<td>

<p>A logical. If TRUE then the points are added to an existing graph.
</p>
</td></tr>
<tr><td><code id="recluster.plot.sites.col_+3A_pch">pch</code></td>
<td>

<p>The symbol to use when plotting points
</p>
</td></tr>
<tr><td><code id="recluster.plot.sites.col_+3A_...">...</code></td>
<td>

<p>See par() for other graphical parameters
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A colour plot. 
</p>


<h3>Author(s)</h3>

<p>Leonardo Dapporto and Matteo Ramazzotti
</p>


<h3>References</h3>

<p>Dapporto, L., Fattorini, S., Vod?, R., Dinc?, V., Vila, R. &quot;Biogeography of western Mediterranean butterflies: combining turnover and nestedness components of faunal dissimilarity.&quot; 
J Biogeogr (2014), 41: 1639-1650. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamod)
sordiss&lt;- recluster.dist(datamod, dist="sorensen")
lat&lt;-c(2,2,2,1,3,1,1,3,3)
long&lt;-c(1,5,3,3,3,1,5,1,5)
points&lt;-cmdscale(sordiss)
col&lt;-recluster.col(points)
recluster.plot.sites.col(long, lat, col,text=TRUE)
</code></pre>

<hr>
<h2 id='recluster.procrustes'>
Computes a procrustes analysis between two matrices even if only a subset of cases are shared.
</h2><span id='topic+recluster.procrustes'></span>

<h3>Description</h3>

<p>This function computes a procrustes analysis (as done by the vegan procrustes function) but it also allows including a subset of cases shared between the two matrices and some unshared cases. The shared cases must be listed first and in the same order in the two matrices. Moreover, the number of shared cases must be indicated. The function applies a procrustes analysis by scaling, mirroring ad rotating the second matrix to minimizing its dissimilarity from the first on the basis of shared cases. Then, the same transformation is applied to the unshared cases of the second matrix. Finally, it allows including the matrices of coordinates for variables as obtained, for example, by PCA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.procrustes(X, Y, Yv=FALSE, num=nrow(X), scale = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.procrustes_+3A_x">X</code></td>
<td>

<p>Target matrix.
</p>
</td></tr>
<tr><td><code id="recluster.procrustes_+3A_y">Y</code></td>
<td>

<p>Matrix to be rotated.
</p>
</td></tr>
<tr><td><code id="recluster.procrustes_+3A_yv">Yv</code></td>
<td>

<p>Matrix of variables for the matrix to be rotated.
</p>
</td></tr>
<tr><td><code id="recluster.procrustes_+3A_num">num</code></td>
<td>

<p>number of shared cases between the target matrix and the matrix to be rotated (by default all).
</p>
</td></tr>
<tr><td><code id="recluster.procrustes_+3A_scale">scale</code></td>
<td>

<p>number of shared cases between the target matrix and the matrix to be rotated (by default all).
</p>
</td></tr>
<tr><td><code id="recluster.procrustes_+3A_...">...</code></td>
<td>

<p>See procrustes() for other parameters
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>recluster.procrustes uses the vegan function procrustes to rotate a configuration (Y) to maximum similarity with another target matrix configuration (X) on the basis of a series of shared objects (rows). These objects must be in the same order in the two X and Y matrices. In case of additional cases (rows) in both the X and Y matrices, the same transformation is applied to the case of the Y matrices which are not shared with X. Moreover, the same transformation can be applied to an additional Yv matrix likely representing the coordinates of variables as obtained for example by PCA or other ordination methods. The functions returns an object of the class &quot;procrustes&quot; as implemented in vegan.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Yrot</code></td>
<td>

<p>Rotated matrix Y.
</p>
</td></tr>
<tr><td><code>X</code></td>
<td>

<p>Target matrix.
</p>
</td></tr>
<tr><td><code>Yvrot</code></td>
<td>

<p>Rotated matrix of variables Yv.
</p>
</td></tr>
<tr><td><code>ss</code></td>
<td>

<p>Sum of squared differences between X and Yrot on the basis of shared objects.
</p>
</td></tr>
<tr><td><code>rotation</code></td>
<td>

<p>Orthogonal rotation matrix on the basis of shared objects.
</p>
</td></tr>
<tr><td><code>translation</code></td>
<td>

<p>Translation of the origin on the basis of shared objects.
</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>

<p>Scaling factor on the basis of shared objects.
</p>
</td></tr>
<tr><td><code>xmean</code></td>
<td>

<p>The centroid of the target on the basis of shared objects.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Dapporto L., Voda R., Dinca V., Vila R.
&quot;Comparing population patterns for genetic and morphological markers with uneven sample sizes. An example for the butterfly Maniola jurtina&quot;
Methods Ecol Evol (2014), 5, 834-843.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Create and plot a target matrix
ex1 &lt;-rbind(c(1,5),c(5,5),c(3,4),c(3,6))
plot(ex1,col=c(1:4),pch=19,xlim=c(0,6),ylim=c(0,6),cex=2)
#Create and plot a matrix to be rotated. Only the points 1-4 are shared
ex2&lt;-rbind(c(3,1),c(3,3),c(2.5,2),c(3.5,2),c(3,4))
plot(ex2,col=c(1:5),pch=19,xlim=c(0,6),ylim=c(0,6),cex=2)

#Perform the procrustes and plot the matrices
procr1&lt;-recluster.procrustes(ex1,ex2,num=4)
plot(procr1$X,col=c(1:4),pch=19,xlim=c(-4,4),ylim=c(-4,4),cex=2)
plot(procr1$Yrot,col=c(1:5),pch=19,xlim=c(-4,4),ylim=c(-4,4),cex=2)
</code></pre>

<hr>
<h2 id='recluster.region'>
A new clustering method based on continuous consensus.
</h2><span id='topic+recluster.region'></span>

<h3>Description</h3>

<p>This function is specifically designed to allow regionalization analysis when occurrence of zero and tied values are particularly numerous. This often occurs when using turnover indices at small or mid-spatial scales where huge barriers do not occur. The function requires as an input a matrix having areas in rows and species occurrence (1,0) in columns. It also allows for inclusion of a phylogenetic tree to compute phylogenetic beta-diversity. The indices to be used are those allowed by recluster.dist, but custom indices can be introduced (see recluster.dist). Alternatively a dissimilarity metrix obtained with any function can be provided. The function requires the input of a custom number of trees (n=50 by default) and of an interval of mincl-maxcl values (by default 2-3) indicating the number of regions to be identified. Clustering methods implemented by hclust are allowed as well as Partition Around Medoids and DIANA. The ward.2D default method is generally the best performing method, but ward.D, complete clustering, Partition Around Medoids and DIANA can also perform well. The function produces n trees by randomly re-ordering the original row order. Then, the trees are cut to different nodes (from the mincl-1th to the maxcl-1th node), thus producing an increasing number of clusters. Then, the function compares clustering solutions among the same cuts in different re-sampled trees. This produces a dissimilarity matrix among cells represented by the times each pair of areas is located in different clusters over the different solutions extracted for different trees for the same cut. This dissimilarity is standardised by the number of re-sampled trees to produce values ranging from 0 (for pairs of cells always belonging to the same cluster) to 1 (pairs never belonging to the same cluster). A final hierarchical clustering is applied generating an interval of maxcl-mincl. Since the number of clusters requested by the user interval cannot precisely match the mean number of clusters obtained by the tree cuts, the clustering solution for each k value is obtained by selecting the dissimilarity matrix obtained from the nearest mean number of clustering solutions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.region (mat,tr=50,dist="simpson",method="ward.D2",phylo=NULL, mincl=2,maxcl=3,
rettree=FALSE,retmat=FALSE,retmemb=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.region_+3A_mat">mat</code></td>
<td>

<p>A binary presence-absence community matrix or any dissimilarity matrix.
</p>
</td></tr>
<tr><td><code id="recluster.region_+3A_tr">tr</code></td>
<td>

<p>The number of trees to be included in the consensus.
</p>
</td></tr>
<tr><td><code id="recluster.region_+3A_dist">dist</code></td>
<td>

<p>One among the beta-diversity indexes allowed by recluster.dist or a custom binary dissimilarity specified according to the syntax of designdist function of the vegan package. Not required when the input is a dissimilarity matrix.
</p>
</td></tr>
<tr><td><code id="recluster.region_+3A_method">method</code></td>
<td>

<p>Any clustering method allowed by hclust but also &quot;pam&quot; and &quot;diana&quot;.
</p>
</td></tr>
<tr><td><code id="recluster.region_+3A_phylo">phylo</code></td>
<td>

<p>An ultrametric and rooted phylogenetic tree for species having the same labels as in mat columns. Only required for phylogenetic beta-diversity indices.
</p>
</td></tr>
<tr><td><code id="recluster.region_+3A_mincl">mincl</code></td>
<td>

<p>The minimum number of regions requested
</p>
</td></tr>
<tr><td><code id="recluster.region_+3A_maxcl">maxcl</code></td>
<td>

<p>The maximum number of regions requested
</p>
</td></tr>
<tr><td><code id="recluster.region_+3A_rettree">rettree</code></td>
<td>

<p>Logical, if TRUE the final trees are returned. 
</p>
</td></tr>
<tr><td><code id="recluster.region_+3A_retmat">retmat</code></td>
<td>

<p>Logical, if TRUE the new dissimilarity matrices are returned. 
</p>
</td></tr>
<tr><td><code id="recluster.region_+3A_retmemb">retmemb</code></td>
<td>

<p>Logical, if TRUE the memberships for areas in different random trees is returned. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Like other evaluators for goodness of clustering solutions, the funtion provides silhouette values and the explained dissimilarity. The explained dissimilarity (sensu Holt et al. 2013) is represented by the ratio between sums of mean dissimilarities among members of different clusters and the sum of all dissimilarities of the matrix. This value clearly tends to 1 when all areas are considered as independent groups. Silhouette width measures the strength of any partition of objects from a dissimilarity matrix by comparing the minimum distance between each cell and the most similar cell belonging to any other cluster and the mean distance between that cell and the others belonging to the same cluster (see silhouette function in the cluster package). Silhouette values range between -1 and +1, with a negative value suggesting that most cells are probably located in an incorrect cluster. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>memb</code></td>
<td>

<p>An array with different matrices indicating for each area (rows) the membership in each random tree (columns) in each cut (matrix).
</p>
</td></tr>
<tr><td><code>matrices</code></td>
<td>

<p>The new dissimilarity matrices. Up-right cells provided as NAs.
</p>
</td></tr>
<tr><td><code>nclust</code></td>
<td>

<p>Mean number of clusters among random trees obtained by different cuts.
</p>
</td></tr>
<tr><td><code>solutions</code></td>
<td>

<p>A matrix providing number of clusters for each solution (k), the associated mean number of clusters obtained by cuts (clust), the silhouette (silh) value and the explained dissimilarity (ex.diss).
</p>
</td></tr>
<tr><td><code>grouping</code></td>
<td>

<p>A matrix indicating cluster membership of each site in each solution for different numbers of clusters.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Dapporto L. et al.
A new procedure for extrapolating turnover regionalization at mid-small spatial scales, tested on  British butterflies.
Methods Ecol Evol (2015), 6, 1287-1297
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataisl)
simpson&lt;-recluster.dist(dataisl)
turn_cl&lt;-recluster.region(simpson,tr=10,rettree=TRUE)
#plot the three for three clusters
plot(turn_cl$tree[[2]])
#inspect cluster membership
turn_cl$grouping
</code></pre>

<hr>
<h2 id='recluster.rotate'>
Rotates a bidimensional configuration according to a line
</h2><span id='topic+recluster.rotate'></span>

<h3>Description</h3>

<p>This function rotates the points of a configuration to a new configuration where a line identified by its intercept and its angular coefficient is rotated to become horizontal. The function can also flip or centre a configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.rotate(table,m=FALSE,q=FALSE,flip="none",centre=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.rotate_+3A_table">table</code></td>
<td>

<p>The bidimensional configuration.
</p>
</td></tr>
<tr><td><code id="recluster.rotate_+3A_m">m</code></td>
<td>

<p>The line slope.
</p>
</td></tr>
<tr><td><code id="recluster.rotate_+3A_q">q</code></td>
<td>

<p>The line intercept
</p>
</td></tr>
<tr><td><code id="recluster.rotate_+3A_flip">flip</code></td>
<td>

<p>The kind of flip, no flip, &quot;none&quot;; &quot;hor&quot;, flip horizontally; &quot;ver&quot;, flip vertically; &quot;both&quot;, flip vertically and horizontally.
</p>
</td></tr>
<tr><td><code id="recluster.rotate_+3A_centre">centre</code></td>
<td>

<p>A logical. If TRUE the configuration, after transformation is centered to the mean X and Y values.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>table2</code></td>
<td>

<p>The transformed bidimensional configuration.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Dapporto L., Voda R., Dinca V., Vila R.
&quot;Comparing population patterns for genetic and morphological markers with uneven sample sizes. An example for the butterfly Maniola jurtina&quot;
Methods Ecol Evol (2014), 5, 834-843.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataisl)
#Compute bidimensional representation for islands
pcoa&lt;-cmdscale(recluster.dist(dataisl))
plot (pcoa)
#Compute the line
lin&lt;-recluster.line(pcoa)
transf&lt;-recluster.rotate(pcoa,m=lin$m,q=lin$q)
plot(transf)
</code></pre>

<hr>
<h2 id='recluster.test.dist'>
Test variation lost by a bidimensional configuration when the coordinates of the elements are reduced to the configuration of the barycentres of a given series of groups.
</h2><span id='topic+recluster.test.dist'></span>

<h3>Description</h3>

<p>This function evaluates the amount of variation maintained by a bidimensional configuration after the elements are reduced to the barycentres according to a grouping variable. If elements of different groups are randomly scattered in the configuration, almost all barycentres are expected to attain a rather central position with respect to the original elements, which would result in a small mean distance between barycentres. Conversely, if the elements of different groups are strictly clustered in the representation, the distances among barycentres are expected to be similar to the distances among original elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recluster.test.dist(mat1,mat2,member,perm=1000,elev=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recluster.test.dist_+3A_mat1">mat1</code></td>
<td>

<p>The bidimensional configuration before computing barycentres for groups.
</p>
</td></tr>
<tr><td><code id="recluster.test.dist_+3A_mat2">mat2</code></td>
<td>

<p>The bidimensional configuration after computing barycentres for groups.
</p>
</td></tr>
<tr><td><code id="recluster.test.dist_+3A_member">member</code></td>
<td>

<p>A vector indicating group membership for each element.
</p>
</td></tr>
<tr><td><code id="recluster.test.dist_+3A_perm">perm</code></td>
<td>

<p>The number of permutations.
</p>
</td></tr>
<tr><td><code id="recluster.test.dist_+3A_elev">elev</code></td>
<td>

<p>The power of distances (by default 2:squared distances).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces a ratio between the mean squared pairwise distance for all elements and the mean squared pairwise distance for barycentres. This ratio is calculated for the overall configuration and for the two axes separately. The function also provides a test for the significance of the variation preserved by barycentres by creating a custom number of matrices (1000 by default) by randomly sampling the original vector defining groups. Then it computes the frequency of mean squared distance ratios in random configurations higher than the observed ratio. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>ratio</code></td>
<td>

<p>The ratio between mean distances among original elements and barycentres over the overall configuration.
</p>
</td></tr>
<tr><td><code>ratioX</code></td>
<td>

<p>The ratio between mean distances among original elements and barycentres on the X axis.
</p>
</td></tr>
<tr><td><code>ratioY</code></td>
<td>

<p>The ratio between mean distances among original elements and barycentres on the Y axis.
</p>
</td></tr>
<tr><td><code>test</code></td>
<td>

<p>The permutation test for variation maintained over the overall configuration.
</p>
</td></tr>
<tr><td><code>testX</code></td>
<td>

<p>The permutation test for variation maintained along the X axis.
</p>
</td></tr>
<tr><td><code>testY</code></td>
<td>

<p>The permutation test for variation maintained along the Y axis.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonardo Dapporto
</p>


<h3>References</h3>

<p>Dapporto L., Voda R., Dinca V., Vila R.
&quot;Comparing population patterns for genetic and morphological markers with uneven sample sizes. An example for the butterfly Maniola jurtina&quot;
Methods Ecol Evol (2014), 5, 834-843.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataisl)
#Define groups of islands
memb&lt;-c(2,3,5,7,5,3,1,1,2,5,1,3,1,1,5,2,2,1,2,4,1,3,1,5,2,1,7,6,1,1,1) 
#Compute bidimensional representation for elements
pcoa&lt;-cmdscale(recluster.dist(dataisl))
bar&lt;-aggregate(pcoa~memb,FUN="mean")[,2:3]
# test if the variation has been significantly lost
recluster.test.dist(pcoa,bar,memb,perm=100)
</code></pre>

<hr>
<h2 id='treebut'>
Phylogenetic tree for the butterfly species included in dataisl dataset 
</h2><span id='topic+treebut'></span>

<h3>Description</h3>

<p>This phylogenetic tree has been created based on known phylogeny of butterflies at family and subfamily level and on COI sequences at genus and species level. Branch lenghts have been calculated by Graphen method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(treemod)
</code></pre>


<h3>Details</h3>

<p>A phylogenetic tree of butterfly species occurring on Western Mediterranean islands.
</p>


<h3>Author(s)</h3>

<p>Gerard Talavera and Roger Vila
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>

<hr>
<h2 id='treemod'>
Hypothetical phylogenetic tree for the virtual island faunas provided with the package recluster 
</h2><span id='topic+treemod'></span>

<h3>Description</h3>

<p>This phylogenetic tree has been created from the datamod dataset representing a series of virtual faunas in different sites
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(treemod)
</code></pre>


<h3>Details</h3>

<p>A phylogenetic tree of 31 species taken from 9 sites.
</p>


<h3>Author(s)</h3>

<p>Gerard Talavera
</p>


<h3>References</h3>

<p>Dapporto L., Ramazzotti M., Fattorini S., Talavera G., Vila R., Dennis R. 
&quot;recluster: an unbiased clustering procedure for beta-diversity turnover&quot;
Ecography (2013), 36:1070-1075.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
