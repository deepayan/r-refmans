<!DOCTYPE html><html><head><title>Help for package rQCC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rQCC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#attributes.chart.unbalanced'><p>Attributes control chart with balanced/unbalanced samples</p></a></li>
<li><a href='#empirical.variance'><p>Empirical variances of robust estimators</p></a></li>
<li><a href='#factors.for.chart'><p>Factors for constructing control charts</p></a></li>
<li><a href='#finite.sample.breakdown'><p>Finite-sample breakdown point</p></a></li>
<li><a href='#Hodges-Lehmann'><p>Hodges-Lehmann estimator</p></a></li>
<li><a href='#MAD'><p>Median absolute deviation (MAD)</p></a></li>
<li><a href='#n.times.eBias'><p>Empirical biases (times n)</p></a></li>
<li><a href='#n.times.eVar'><p>Empirical variances (times n)</p></a></li>
<li><a href='#plot'><p>Plot quality control chart</p></a></li>
<li><a href='#pooled.Estimator'><p>Pooled Estimator</p></a></li>
<li><a href='#relative.efficiency'><p>Relative efficiency (RE)</p></a></li>
<li><a href='#robust.attributes.chart.unbalanced'><p>Robust attributes control charts with balanced/unbalanced samples</p></a></li>
<li><a href='#robust.chart.unbalanced'><p>Robust quality control chart with balanced/unbalanced samples</p></a></li>
<li><a href='#sd.unbiased'><p>Unbiased standard deviation</p></a></li>
<li><a href='#Shamos'><p>Shamos estimator</p></a></li>
<li><a href='#unbiasing.factor'><p>Finite-sample unbiasing factor</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Robust Quality Control Chart</td>
</tr>
<tr>
<td>Version:</td>
<td>2.22.12</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-12-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Chanseok Park <a href="https://orcid.org/0000-0002-2208-3498"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Min Wang <a href="https://orcid.org/0000-0002-9233-7844"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chanseok Park &lt;statpnu@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.3)</td>
</tr>
<tr>
<td>Description:</td>
<td>Constructs various robust quality control charts based on the median or Hodges-Lehmann estimator (location) and the median absolute deviation (MAD) or Shamos estimator (scale). The estimators used for the robust control charts are all unbiased with a sample of finite size. For more details, see Park, Kim and Wang (2022) &lt;<a href="https://doi.org/10.1080%2F03610918.2019.1699114">doi:10.1080/03610918.2019.1699114</a>&gt;. In addition, using this R package, the conventional quality control charts such as X-bar, S, R, p, np, u, c, g, h, and t charts are also easily constructed. This work was supported by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MSIT) (No. 2022R1A2C1091319).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://AppliedStat.GitHub.io/R/">https://AppliedStat.GitHub.io/R/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://GitHub.com/AppliedStat/R/issues">https://GitHub.com/AppliedStat/R/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-22 08:19:22 UTC; cp</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-22 08:50:23 UTC</td>
</tr>
</table>
<hr>
<h2 id='attributes.chart.unbalanced'>Attributes control chart with balanced/unbalanced samples</h2><span id='topic+acc'></span><span id='topic+print.acc'></span><span id='topic+summary.acc'></span>

<h3>Description</h3>

<p>Constructs the attributes control charts with balanced/unbalanced samples.</p>


<h3>Usage</h3>

<pre><code class='language-R'>acc (x, n, type=c("p","np","c","u","g","h","t"), parameter, pEstimator=c("Wald","Wilson"),
     gEstimator = c("ML", "MVU"), tModel=c("E","W"), location.shift = 0,
     sigmaFactor=3, nk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="attributes.chart.unbalanced_+3A_x">x</code></td>
<td>
<p>a numeric vector of the number of nonconforming units.</p>
</td></tr>
<tr><td><code id="attributes.chart.unbalanced_+3A_n">n</code></td>
<td>
<p>a numeric vector of sample sizes.</p>
</td></tr>
<tr><td><code id="attributes.chart.unbalanced_+3A_type">type</code></td>
<td>
<p>a character string specifying the type of control chart.</p>
</td></tr>
<tr><td><code id="attributes.chart.unbalanced_+3A_parameter">parameter</code></td>
<td>
<p>a known Bernoulli parameter value for the corresponding chart.
If not known, it is estimated. For more details, refer to <code>vignette("acc", package="rQCC")</code>.</p>
</td></tr>
<tr><td><code id="attributes.chart.unbalanced_+3A_pestimator">pEstimator</code></td>
<td>
<p>a method for estimating the Bernoulli parameter for <code class="reqn">p</code> and <code class="reqn">np</code> charts.</p>
</td></tr>
<tr><td><code id="attributes.chart.unbalanced_+3A_gestimator">gEstimator</code></td>
<td>
<p>a method for estimating the Bernoulli parameter for <code class="reqn">g</code> and <code class="reqn">h</code> charts.</p>
</td></tr>
<tr><td><code id="attributes.chart.unbalanced_+3A_tmodel">tModel</code></td>
<td>
<p>Probability model for <code class="reqn">t</code> chart. &quot;E&quot; for Exponential and &quot;W&quot; for Weibull.</p>
</td></tr>
<tr><td><code id="attributes.chart.unbalanced_+3A_location.shift">location.shift</code></td>
<td>
<p>a known location shift parameter value for  <code class="reqn">g</code> and <code class="reqn">h</code> charts.</p>
</td></tr>
<tr><td><code id="attributes.chart.unbalanced_+3A_sigmafactor">sigmaFactor</code></td>
<td>
<p>a factor for the standard deviation (<code class="reqn">\sigma</code>).  
For example, the American Standard uses &quot;<em>3*sigma</em>&quot; limits (0.27% false alarm rate),
while the British Standard uses &quot;<em>3.09*sigma</em>&quot; limits (0.20% false alarm rate).</p>
</td></tr>
<tr><td><code id="attributes.chart.unbalanced_+3A_nk">nk</code></td>
<td>
<p>sample size for Phase-II. If <code>nk</code> is missing, the average of the subsample sizes is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>acc</code> constructs the attributes control charts 
for nonconforming units (<code class="reqn">p</code> and <code class="reqn">np</code> charts)
and for nonconformities per unit (<code class="reqn">c</code> and <code class="reqn">u</code> charts).</p>


<h3>Value</h3>

<p><code>acc</code> returns an object of <a href="base.html#topic+class">class</a> &quot;acc&quot;.
The function <code>summary</code> is used to obtain and print a summary of the results
and the function <code>plot</code> is used to plot the control chart.
</p>


<h3>Author(s)</h3>

<p>Chanseok Park</p>


<h3>References</h3>

<p>ASTM (2010).
<em>Manual on Presentation of Data and Control Chart Analysis</em> (STP 15-D), 8th edition. 
American Society for Testing and Materials, West Conshohocken, PA.
</p>
<p>Kaminsky, F. C., J. C. Benneyan and R. D. Davis (1992).
Statistical Control Charts Based on a Geometric Distribution.
<em>Journal of Quality Technology</em>, <b>24</b>, 63-69.
</p>
<p>Montgomery, D. C. (2013). 
<em>Statistical Quality Control: An Modern Introduction</em>, 7th edition.
John Wiley &amp; Sons, New York, NY.
</p>
<p>Park, C. (2013).
An Improved <em>p</em> Chart Based on the Wilson Interval.
<em>Journal of Statistics and Management Systems</em>, <b>16</b>(2-03), 201-221.<br />
doi: <a href="https://doi.org/10.1080/09720510.2013.777576">10.1080/09720510.2013.777576</a>
</p>
<p>Park, C. and M. Wang (2022). 
A study on the g and h control charts. 
<em>Communications in Statistics - Theory and Methods</em>, <b>To Appear</b>.<br />
doi: <a href="https://doi.org/10.1080/03610926.2022.2044492">10.1080/03610926.2022.2044492</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ==============================
# Example 1a: p chart (balanced)
# ------------------------------
# Refer to Table 31 of ASTM (2010).
x = c(1, 3, 0, 7, 2, 0, 1, 0, 8, 5, 2, 0, 1, 0, 3)
n = 400

# The conventional p chart with the balanced samples.
# Print LCL, CL, UCL.
result = acc(x, n)
print(result)

# Summary of a control chart.
summary(result)

# Plot of a control chart.
plot(result, cex.text=0.8)
text(15, 0.5, labels="p chart (with balanced sample)" )

# The p chart based on the Wilson confidence interval.
acc(x, n, pEstimator="Wilson")


# ===============================
# Example 1b: np chart (balanced)
# -------------------------------
# The data are the same as in Example 1a.
# The conventional np chart with the balanced samples.
# Print LCL, CL, UCL.
result = acc(x, n, type="np")
print(result)
summary(result)
plot(result, cex.text=0.8)
text(15, 25, labels="np chart" )

# The np chart based on the Wilson confidence interval.
acc(x, n, type="np", pEstimator="Wilson")


# ================================
# Example 2a: p chart (unbalanced)
# --------------------------------
# Refer to Table 32 of ASTM (2010).
x = c( 9, 7, 3, 9,13,14,14,10,12,14, 6,12, 7,11, 5,
       4, 2, 4, 7, 9, 7,12, 8, 5,18, 7, 8, 8,15, 3, 5)
n = c( 580, 550, 580, 640, 880, 880, 640, 550, 580, 880,
       800, 800, 580, 580, 550, 330, 330, 640, 580, 550,
       510, 640, 300, 330, 880, 880, 800, 580, 880, 880, 330)

# The conventional p chart with the unbalanced samples.
# Print LCL, CL, UCL.
result = acc(x, n, nk=880)
print(result)

# Summary of a control chart.
summary(result)

# Plot of a control chart.
plot(result, cex.text=0.8)
text(15, 0.2, labels="p chart (with unbalanced sample)" )


# ================================
# Example 2b: p chart (unbalanced)
# --------------------------------
# Refer to Table 7.4 of Montgomery (2013).
x = c(12, 8, 6, 9, 10, 12, 11, 16, 10, 6, 20, 15, 9, 8, 6, 8, 10, 7, 5, 8, 5, 8, 10, 6, 9)
n = c(100,80,80,100,110,110,100,100,90,90,110,120,120,120,110,80,80,80,90,100,100,100,100,90,90)

# The conventional p chart with the unbalanced samples.
# Print LCL, CL, UCL.
# If nk is missing, the average sample size is used.
result = acc(x, n)
print(result)

# Summary of a control chart.
summary(result)

# Plot of a control chart.
# Refer to Figure 7.8 of Montgomery (2013).
plot(result, cex.text=0.8)
text(15, 0.2, labels="p chart (with unbalanced sample)" )


# ================================
# Example 2c: p chart (unbalanced)
#             p is known 
# --------------------------------
# Refer to Table 41 of ASTM (2010).
x = c(2, 2, 1, 1, 5, 2, 0, 3, 0, 15, 7, 2, 5, 2, 0, 3, 0, 4, 8, 4)
n = c(600,1300,2000,2500,1550,2000,1550,780,260,2000,1550,950,950,950,35,330,200,600,1300,780)

# The fraction nonconforming is known as 0.0020
# The control limits at the size nk=600.
# If nk (sample size for Phase II) is unknown, the average of subsample sizes is used.
result = acc(x, n, parameter=0.002, nk=600)
summary(result)


# ===============================
# Example 3a: u chart (balanced)
# -------------------------------
# Refer to Table 33 of ASTM (2010).
x = c(17, 14, 6, 23,  5,  7, 10, 19, 29, 18, 25, 5,
       8, 11, 18, 13, 22, 6, 23, 22,  9, 15, 20, 6, 24)
n = 10

# The u chart with the balanced samples.
# Print LCL, CL, UCL.
result = acc(x, n, type="u")
print(result)

# Summary of a control chart
summary(result)

# Plot of a control chart
plot(result, cex.text=0.8)
text(13, 3, labels="u chart" )


# ================================
# Example 3b: u chart (unbalanced)
# --------------------------------
# Refer to Table 34 of ASTM (2010).
x = c(72, 38, 76, 35, 62, 81, 97, 78, 103, 56,
      47, 55, 49, 62, 71, 47, 41, 52, 128, 84)
n = c(20, 20, 40, 25, 25, 25, 40, 40, 40, 40,
      25, 25, 25, 25, 25, 20, 20, 20, 40, 40)

# The u chart with the unbalanced samples.
# Print LCL, CL, UCL.
result = acc(x, n, type="u", nk=20)
print(result)

# Summary of a control chart
summary(result)

# Plot of a control chart
plot(result, cex.text=0.8)
text(12, 3.5, labels="u chart (with unbalanced sample)" )


# ===============================
# Example 4: c chart 
# -------------------------------
# Refer to Table 35 of ASTM (2010).
x = c(0, 1, 1, 0, 2, 1, 3, 4, 5, 3, 0, 1, 1, 1, 2, 4, 0, 1, 1, 0,
      6, 4, 3, 2, 0, 0, 9,10, 8, 8, 6,14, 0, 1, 2, 4, 5, 7, 1, 3,
      3, 2, 0, 1, 5, 3, 4, 3, 5, 4, 2, 0, 1, 2, 5, 9, 4, 2, 5, 3)

# Print LCL, CL, UCL.
result = acc(x, type="c")
print(result)

# Summary of a control chart
summary(result)

# Plot of a control chart
plot(result, cex.text=0.8)
text(40, 14, labels="c chart" )


# ===============================
# Example 5: g and h charts
# -------------------------------
# Refer to Kaminsky et al. (1992).
tmp = c(
11,  2,  8,  2, 4,   1,  1, 11,  2, 1,   1,  7,  1,  1, 9, 
 5,  1,  3,  6, 5,  13,  2,  3,  3, 4,   3,  2,  6,  1, 5,  
 2,  2,  8,  3, 1,   1,  3,  4,  6, 5,   2,  8,  1,  1, 4,  
13, 10, 15,  5, 2,   3,  6,  1,  5, 8,   9,  1, 18,  3, 1,  
 3,  7, 14,  3, 1,   7,  7,  1,  8, 1,   4,  1,  6,  1, 1, 
 1, 14,  2,  3, 7,  19,  9,  7,  1, 8,   5,  1,  1,  6, 1,  
 9,  5,  6,  2, 2,   8, 15,  2,  3, 3,   4,  7, 11,  4, 6,  
 7,  5,  1, 14, 8,   3,  3,  5, 21,10,  11,  1,  6,  1, 2,  
 4,  1,  2, 11, 5,   3,  5,  4, 10, 3,   1,  4,  7,  3, 2, 
 3,  5,  4,  2, 3,   5,  1,  4, 11,17,   1, 13, 13,  2, 1)  
data = matrix(tmp, byrow=TRUE, ncol=5)

# g chart with ML method.
# Print LCL, CL, UCL.
result = acc(data, type="g", location=1)
print(result)

# Summary of a control chart
summary(result)

plot(result, cex.text=0.8)

# h chart with MVU method.
acc(data, type="h", location=1, gEstimator="MVU")


# ===============================
# Example 6: g and h charts (unbalanced data)
# -------------------------------
x1 = c(11, 2,  8,  2, 4)
x2 = c(1,  1, 11,  2, 1)
x3 = c(1,  7,  1)
x4 = c(5,  1,  3,  6, 5)
x5 = c(13, 2,  3,  3)
x6 = c(3,  2,  6,  1, 5)
x7 = c(2,  2,  8,  3, 1)
x8 = c(1,  3,  4,  6, 5)
x9 = c(2,  8,  1,  1, 4)
data = list(x1, x2, x3, x4, x5, x6, x7, x8, x9)

result = acc(data, type="g", location=1, gEstimator="MVU", nk=5)
summary(result)
plot(result)


# ===============================
# Example 7: t charts 
# -------------------------------
x = c(0.35, 0.92, 0.59, 4.28, 0.21, 0.79, 1.75, 0.07, 3.3, 
1.7, 0.33, 0.97, 0.96, 2.23, 0.88, 0.37, 1.3, 0.4, 0.19, 1.59)

# Exponential t chart
result = acc(x, type="t", tModel="E")
summary(result)

plot(result, cex.text=0.8)
text(10, 6, labels="Exponential t chart" )


# Weibull t chart
result = acc(x, type="t", tModel="W")
summary(result)

plot(result, cex.text=0.8)
text(10, 6, labels="Weibull t chart" )

</code></pre>

<hr>
<h2 id='empirical.variance'>Empirical variances of robust estimators</h2><span id='topic+evar'></span>

<h3>Description</h3>

<p>This function calculate or estimate the variances of the mean, median, Hodges-Lehmann (HL1, HL2, HL3), standard deviation, range,
median absolute deviation (MAD) and Shamos estimators.</p>


<h3>Usage</h3>

<pre><code class='language-R'>evar (n, estimator=c("mean","median","HL1","HL2","HL3", "sd","range","mad","shamos"),
         poolType=c("A","B","C"), correction=TRUE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="empirical.variance_+3A_n">n</code></td>
<td>
<p>a vector of sample sizes.
For <code>"HL1"</code>, <code>"sd"</code>, <code>"range"</code> and <code>"shamos"</code>, <code class="reqn">n \ge 2</code>.
For others, <code class="reqn">n \ge 2</code>.</p>
</td></tr>
<tr><td><code id="empirical.variance_+3A_estimator">estimator</code></td>
<td>
<p>a character string specifying the estimator, must be 
one of <code>"mean"</code> (default), <code>"median"</code>, <code>"HL1"</code>, <code>"HL2"</code>, <code>"HL3"</code>, <code>"sd"</code>, <code>"range"</code>, <code>"mad"</code>, 
and <code>"shamos"</code>.</p>
</td></tr>
<tr><td><code id="empirical.variance_+3A_pooltype">poolType</code></td>
<td>
<p>Type for how to pool estimators, must be
one of <code>"A"</code> (default), <code>"B"</code>, and <code>"C"</code>.</p>
</td></tr>
<tr><td><code id="empirical.variance_+3A_correction">correction</code></td>
<td>
<p>logical. A finite-sample bias correction for the estimator with a single sample.
<code>TRUE</code> (default) adjusts a finite-sample bias correction for a scale estimator
using <code>c4.factor</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates or estimates 
the variance of a specific estimator 
when a random sample is from the standard normal distribution.
</p>
<p>For the mean, standard deviation (sd) and range, their exact variances
are calculated, but the others are empirically estimated through 
the extensive Monte Carlo simulation with 1E07 replicates
for  <code class="reqn">n=1,2,\ldots,100</code>. 
For the case of <code class="reqn">n &gt; 100</code>, 
the empirical variances are obtained using the method of Hayes (2014).
</p>


<h3>Value</h3>

<p>It returns a numeric value.</p>


<h3>Author(s)</h3>

<p>Chanseok Park and Min Wang</p>


<h3>References</h3>

<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators.
<em>Communications in Statistics - Simulation and Computation</em>, 
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>
<p>Hayes, K. (2014).
Finite-sample bias-correction factors for the median absolute deviation.
<em>Communications in Statistics: Simulation and Computation</em>,
<b>43</b>, 2205&ndash;2212.
</p>


<h3>See Also</h3>

<p><code>RE</code>{rQCC} for the relative efficiency. <br /> 
<code>n.times.eVar.of.HL1</code>{rQCC} for the empirical variance of the HL1 estimator (times n). <br />
<code>n.times.eVar.of.HL2</code>{rQCC} for the empirical variance of the HL2 estimator (times n). <br />
<code>n.times.eVar.of.HL3</code>{rQCC} for the empirical variance of the HL3 estimator (times n). <br />
<code>n.times.eVar.of.mad</code>{rQCC} for the empirical variance of the MAD estimator (times n). <br />
<code>n.times.eVar.of.median</code>{rQCC} for the empirical variance of the median estimator (times n). <br />
<code>n.times.eVar.of.shamos</code>{rQCC} for the empirical variance of the Shamos estimator (times n). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Empirical variance of the Hodges-Lehmann estimator (HL2) under the standard normal distribution.
evar (n=10, estimator="HL2")

# Multiple samples
evar (n=c(4,5), estimator="mad", poolType="C")
</code></pre>

<hr>
<h2 id='factors.for.chart'>Factors for constructing control charts</h2><span id='topic+factors.cc'></span>

<h3>Description</h3>

 
<p>Factors for constructing control charts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>factors.cc(n, factor=c( "A","A1","A2","A3", "B1","B2","B3","B4","B5","B6", "c2","c4",
                        "d2","d3","D1","D2","D3","D4", "E1", "E2", "E3"), sigmaFactor=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="factors.for.chart_+3A_n">n</code></td>
<td>
<p>sample size (<code class="reqn">n \ge 1</code>).</p>
</td></tr>
<tr><td><code id="factors.for.chart_+3A_factor">factor</code></td>
<td>
<p>a character string specifying the foctor. <br />
<code>"c2"</code>, <code>"c4"</code>, <code>"d2"</code>, <code>"d3"</code> for control chart lines;
<code>"A"</code>, <code>"A1"</code>, <code>"A2"</code>, <code>"A3"</code> 
for averages for computing control limits; 
<code>"B1"</code>, <code>"B2"</code>, <code>"B3"</code>, <code>"B4"</code>, <code>"B5"</code>, <code>"B6"</code>
for standard devations; 
<code>"D1"</code>, <code>"D2"</code>, <code>"D3"</code>, <code>"D4"</code> for ranges;
and 
<code>"E1"</code>, <code>"E2"</code>, <code>"E3"</code> for individuals. 
For <code>"d3"</code>, the calculation is not accurate when <code class="reqn">n&gt;100</code>.</p>
</td></tr>
<tr><td><code id="factors.for.chart_+3A_sigmafactor">sigmaFactor</code></td>
<td>
<p>a factor for the standard deviation (<code class="reqn">\sigma</code>). <br /> 
For example, the American Standard uses &quot;<em>3*sigma</em>&quot; limits (0.27% false alarm rate),
while the British Standard uses &quot;<em>3.09*sigma</em>&quot; limits (0.20% false alarm rate).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values of the factors are used for constructing 
various control charts.
</p>
<p>For example, the conventional <code class="reqn">\bar{X}</code> chart 
with the sample standard deviation is given by
</p>
<p style="text-align: center;"><code class="reqn">\bar{\bar{X}} \pm A_3 \bar{S}.</code>
</p>

<p>For more details, refer to <code>vignette("factors.cc", package="rQCC")</code>.
</p>


<h3>Value</h3>

<p>It returns a numeric value.</p>


<h3>Author(s)</h3>

<p>Chanseok Park</p>


<h3>References</h3>

<p>ASTM (2010).
<em>Manual on Presentation of Data and Control Chart Analysis</em> (STP 15-D),
8th edition. 
American Society for Testing and Materials, West Conshohocken, PA.
</p>
<p>ASTM (1951).
<em>Manual on Quality Control of Materials</em> (STP 15-C), 
American Society for Testing and Materials, Philadelphia, PA.
</p>


<h3>See Also</h3>

<p><code>c4.factor</code>{rQCC} for <code class="reqn">c_4</code> factor
for the finite-sample unbiasing factor to estimate 
the standard deviation (<code class="reqn">\sigma</code>) under the normal distribution
using various estimators such as the sample standard deviation,
the sample range, the median absolute deviation (MAD), and 
the Shamos estimator.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## A3 is used for constructing the conventional X-bar chart 
#  with the sample standard deviation.
factors.cc(n=10, factor="A3")


## Unbiasing factor for the standard deviation 
#           using the sample standard deviation.
factors.cc(n=10, factor="c4")
#  The above is the same as below:
c4.factor(n=10, estimator="sd")


## Unbiasing factor for the standard deviation 
#           using the sample range. 
factors.cc(n=10, factor="d2")
#  The above is the same as below:
c4.factor(n=10, estimator="range") 


## Table B2 in Supplement B of ASTM (1951).
char = c("A","A1","A2","c2", "B1","B2","B3","B4", "d2","d3","D1","D2","D3","D4")
nn = 2L:25L

res=NULL
for(n in nn){tmp=NULL;for(ch in char) tmp=c(tmp,factors.cc(n,ch));res=rbind(res,tmp)}
rownames(res) = paste0("n=",nn)
round(res,4)


## Table 49 in Chapter 3 of ASTM (2010).
char = c("A","A2","A3","c4", "B3","B4","B5","B6", "d2","d3","D1","D2","D3","D4")
nn = 2L:25L

res=NULL
for(n in nn){tmp=NULL;for(ch in char) tmp=c(tmp,factors.cc(n,ch));res=rbind(res,tmp)}
rownames(res) = paste0("n=",nn)
round(res,4)


## Table 50 in Chapter 3 of ASTM (2010).
char = c("E2", "E3")
nn = 2L:25L

res=NULL
for(n in nn){tmp=NULL;for(ch in char) tmp=c(tmp,factors.cc(n,ch));res=rbind(res,tmp)}
rownames(res) = paste0("n=",nn)
round(res,3)
</code></pre>

<hr>
<h2 id='finite.sample.breakdown'>Finite-sample breakdown point</h2><span id='topic+finite.breakdown'></span>

<h3>Description</h3>

<p>Calculates the finite-sample breakdown point of the mean,
median, Hodges-Lehmann estimators (HL1, HL2, HL3), standard deviation, range, 
MAD (median absolute deviation) and Shamos estimators.
Note that for the case of the mean, standard deviation and  range, 
the finite-sample breakdown points
are always zero.</p>


<h3>Usage</h3>

<pre><code class='language-R'>finite.breakdown (n, estimator=c("mean","median","HL1","HL2","HL3",
                                 "sd","range","mad","shamos") )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="finite.sample.breakdown_+3A_n">n</code></td>
<td>
<p>a numeric vector of sample sizes.</p>
</td></tr>
<tr><td><code id="finite.sample.breakdown_+3A_estimator">estimator</code></td>
<td>
<p>a character string specifying the estimator, must be 
one of <code>"mean"</code> (default), <code>"median"</code>, <code>"HL1"</code>, <code>"HL2"</code>, <code>"HL3"</code>, 
<code>"sd"</code>, <code>"range"</code>, <code>"mad"</code>, and <code>"shamos"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>finite.breakdown</code> gives the finite-sample breakdown point
of the specified estimator.
</p>
<p>The Hodges-Lehmann (HL1) is defined as 
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{HL1} = \mathop{\mathrm{median}}_{i&lt;j} \Big( \frac{X_i+X_j}{2} \Big)</code>
</p>
  
<p>where <code class="reqn">i,j=1,2,\ldots,n</code>.
</p>
<p>The Hodges-Lehmann (HL2) is defined as 
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{HL2} = \mathop{\mathrm{median}}_{i \le j}\Big(\frac{X_i+X_j}{2} \Big).</code>
</p>

<p>The Hodges-Lehmann (HL3) is defined as 
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{HL3} = \mathop{\mathrm{median}}_{\forall(i,j)} \Big( \frac{X_i+X_j}{2} \Big).</code>
</p>



<h3>Value</h3>

<p>It returns a numeric value.</p>


<h3>Author(s)</h3>

<p>Chanseok Park and Min Wang</p>


<h3>References</h3>

<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators.
<em>Communications in Statistics - Simulation and Computation</em>, 
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>
<p>Hodges, Jr., J. L. (1967).
Efficiency in normal samples and tolerance of extreme values 
for some estimators of location.
<em>Proceedings of the Fifth Berkeley Symposium on Mathematical
Statistics and Probability</em>, Vol. <b>1</b>, 163&ndash;186.
University of California Press, Berkeley.
</p>
<p>Hampel, F. R., Ronchetti, E., Rousseeuw, P. J., and Stahel, W. A. (1986).
<em>Robust Statistics: The Approach Based on Influence Functions</em>,
Subsection 2.2a.  John Wiley &amp; Sons, New York.
</p>


<h3>See Also</h3>

<p><code>HL</code>{rQCC} for the Hodges-Lehmann estimator.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># finite-sample breakdown point of the Hodges-Lehmann (HL1) with size n=10.
finite.breakdown(n=10, estimator="HL2")

# finite-sample breakdown points of the median with sizes n=4,5,6 
finite.breakdown(n=4:6, estimator="median")
</code></pre>

<hr>
<h2 id='Hodges-Lehmann'>Hodges-Lehmann estimator</h2><span id='topic+HL'></span>

<h3>Description</h3>

<p>Calculates the Hodges-Lehmann estimator.</p>


<h3>Usage</h3>

<pre><code class='language-R'>HL(x, estimator = c("HL1", "HL2", "HL3"), na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hodges-Lehmann_+3A_x">x</code></td>
<td>
<p>a numeric vector of observations.</p>
</td></tr>
<tr><td><code id="Hodges-Lehmann_+3A_estimator">estimator</code></td>
<td>
<p>a character string specifying the estimator, must be 
one of <code>"HL1"</code> (default), <code>"HL2"</code> and <code>"HL3"</code>.</p>
</td></tr>
<tr><td><code id="Hodges-Lehmann_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped before the computation proceeds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>HL</code> computes the Hodges-Lehmann estimators (one of <code>"HL1"</code>, <code>"HL2"</code>, <code>"HL3"</code>).
</p>
<p>The Hodges-Lehmann (HL1) is defined as 
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{HL1} = \mathop{\mathrm{median}}_{i&lt;j} \Big( \frac{X_i+X_j}{2} \Big)</code>
</p>
  
<p>where <code class="reqn">i,j=1,2,\ldots,n</code>.
</p>
<p>The Hodges-Lehmann (HL2) is defined as 
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{HL2} = \mathop{\mathrm{median}}_{i \le j}\Big(\frac{X_i+X_j}{2} \Big).</code>
</p>

<p>The Hodges-Lehmann (HL3) is defined as 
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{HL3} = \mathop{\mathrm{median}}_{\forall(i,j)} \Big( \frac{X_i+X_j}{2} \Big).</code>
</p>



<h3>Value</h3>

<p>It returns a numeric value.</p>


<h3>Author(s)</h3>

<p>Chanseok Park and Min Wang</p>


<h3>References</h3>

<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators.
<em>Communications in Statistics - Simulation and Computation</em>, 
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>
<p>Hodges, J. L. and E. L. Lehmann (1963).
Estimates of location based on rank tests.
<em>Annals of Mathematical Statistics</em>, <b>34</b>, 598&ndash;611.
</p>


<h3>See Also</h3>

<p><a href="base.html#topic+mean">mean</a>{base} for calculating sample mean and 
<a href="stats.html#topic+median">median</a>{stats} for calculating sample median. 
</p>
<p><code>finite.breakdown</code>{rQCC} for calculating the finite-sample breakdown point.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = c(0:10, 50)
HL(x, estimator="HL2")
</code></pre>

<hr>
<h2 id='MAD'>Median absolute deviation (MAD)</h2><span id='topic+mad.unbiased'></span><span id='topic+mad2.unbiased'></span>

<h3>Description</h3>

<p>Calculates the unbiased median absolute deviation (MAD)
estimator and the unbiased squared MAD under the normal distribution which are adjusted by 
the Fisher-consistency and finite-sample unbiasing factors.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mad.unbiased (x, center = median(x), constant=1.4826, na.rm = FALSE)

mad2.unbiased(x, center = median(x), constant=1.4826, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MAD_+3A_x">x</code></td>
<td>
<p>a numeric vector of observations.</p>
</td></tr>
<tr><td><code id="MAD_+3A_center">center</code></td>
<td>
<p>pptionally, the center: defaults to the median.</p>
</td></tr>
<tr><td><code id="MAD_+3A_constant">constant</code></td>
<td>
<p>correction factor for the Fisher-consistency under the normal distribution</p>
</td></tr>
<tr><td><code id="MAD_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped before the computation proceeds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The unbiased MAD (<code>mad.unbiased</code>)
is defined as the <a href="stats.html#topic+mad">mad</a>{stats} divided by <code class="reqn">c_5(n)</code>,
where  <code class="reqn">c_5(n)</code> is the finite-sample unbiasing factor.
Note that <code class="reqn">c_5(n)</code> notation is used in Park et. al (2022),
and <code class="reqn">c_5(n)</code> is calculated 
using the function <code>c4.factor</code>{rQCC} with <code>estimator="mad"</code> option.
The default value (<code>constant=1.4826</code>) ensures the Fisher-consistency 
under the normal distribution. 
Note that the original MAD was proposed by Hampel (1974).
</p>
<p>The unbiased squared MAD (<code>mad2.unbiased</code>) is defined as the
squared <a href="stats.html#topic+mad">mad</a>{stats} divided by <code class="reqn">w_5(n)</code> where 
<code class="reqn">w_5(n)</code> is the finite-sample unbiasing  factor. 
Note that <code class="reqn">w_5(n)</code> notation is used in Park et. al (2022),
and <code class="reqn">w_5(n)</code> is calculated 
using the function <code>w4.factor</code>{rQCC} with <code>estimator="mad2"</code> option.
The default value (<code>constant=1.4826</code>) ensures the Fisher-consistency
under the normal distribution.
Note that the square of the conventional MAD is
Fisher-consistent for the variance (<code class="reqn">\sigma^2</code>) under the normal distribution, but
it is not unbiased with a sample of finite size.
</p>


<h3>Value</h3>

<p>They return a numeric value.</p>


<h3>Author(s)</h3>

<p>Chanseok Park and Min Wang</p>


<h3>References</h3>

<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators.
<em>Communications in Statistics - Simulation and Computation</em>, 
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>
<p>Hampel, F. R. (1974).
The influence curve and its role in robust estimation.
<em>Journal of the American Statistical Association</em>, <b>69</b>, 383&ndash;393.
</p>


<h3>See Also</h3>

<p><code>c4.factor</code>{rQCC} for finite-sample unbiasing  factor for the standard deviation
under the normal distribution. 
</p>
<p><code>w4.factor</code>{rQCC} for finite-sample unbiasing  factor
for the variance under the normal distribution.
</p>
<p><code>shamos</code>{rQCC} for robust Fisher-consistent estimator
of the standard deviation under the normal distribution. 
</p>
<p><code>shamos.unbiased</code>{rQCC} for robust finite-sample unbiased estimator
of the standard deviation under the normal distribution. 
</p>
<p><a href="stats.html#topic+mad">mad</a>{stats} for calculating the sample MAD. 
</p>
<p><code>finite.breakdown</code>{rQCC} for calculating the finite-sample breakdown point.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = c(0:10, 50)

# Fisher-consistent MAD, but not unbiased with a finite sample.
mad(x)

# Unbiased MAD.
mad.unbiased(x)

# Fisher-consistent squared MAD, but not unbiased.
mad(x)^2

# Unbiased squared MAD.
mad2.unbiased(x)
</code></pre>

<hr>
<h2 id='n.times.eBias'>Empirical biases (times n)</h2><span id='topic+n.times.eBias.of.mad'></span><span id='topic+n.times.eBias.of.shamos'></span>

<h3>Description</h3>

<p><code class="reqn">n</code> times the empirical biases of the median absolute deviation (MAD) 
and Shamos estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n.times.eBias.of.mad

n.times.eBias.of.shamos
</code></pre>


<h3>Details</h3>

<p><code class="reqn">n</code> times the empirical biases of the median absolute deviation (MAD) 
and Shamos estimators  
under the standard normal distribution, where <code class="reqn">n</code> is the sample size
and <code class="reqn">n</code> is from 1 to 100.
For the MAD estimator, <a href="stats.html#topic+mad">mad</a>{stats} is used.  
For the Shamos estimator, the Fisher-consistent Shamos estimator, <code>shamos</code>{rQCC}, is used.
</p>
<p>These estimators are not unbiased with a finite sample.
The empirical biases are obtained using the extensive Monte Carlo simulation
with 1E07 replicates.
</p>


<h3>Value</h3>

<p>They return a vector of 100 values.</p>


<h3>Author(s)</h3>

<p>Chanseok Park and Min Wang</p>


<h3>References</h3>

<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators.
<em>Communications in Statistics - Simulation and Computation</em>, 
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>
<p>Shamos, M. I. (1976).  Geometry and statistics: Problems at the interface. 
In Traub, J. F., editor,
<em>Algorithms and Complexity: New Directions and Recent Results</em>,
pages 251&ndash;280. Academic Press, New York.
</p>
<p>Lèvy-Leduc, C., Boistard, H., Moulines, E., Taqqu, M. S.,
and Reisen, V. A.  (2011).
Large sample behaviour of some well-known robust estimators under
long-range dependence.
<em>Statistics</em>, <b>45</b>, 59&ndash;71.
</p>

<hr>
<h2 id='n.times.eVar'>Empirical variances (times n)</h2><span id='topic+n.times.eVar.of.HL1'></span><span id='topic+n.times.eVar.of.HL2'></span><span id='topic+n.times.eVar.of.HL3'></span><span id='topic+n.times.eVar.of.mad'></span><span id='topic+n.times.eVar.of.median'></span><span id='topic+n.times.eVar.of.shamos'></span>

<h3>Description</h3>

<p><code class="reqn">n</code> times the empirical variances of the Hodges-Lehmann (HL1, HL2, HL3), 
the median, the median absolute deviation (MAD), and the Shamos estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n.times.eVar.of.HL1

n.times.eVar.of.HL2

n.times.eVar.of.HL3

n.times.eVar.of.median

n.times.eVar.of.mad

n.times.eVar.of.shamos
</code></pre>


<h3>Details</h3>

<p><code class="reqn">n</code> times the empirical variances of the Hodges-Lehmann (HL1, HL2, HL3), the median,
the median absolute deviation (MAD), and the Shamos estimators
under the standard normal distribution,
where <code class="reqn">n</code> is the sample size and <code class="reqn">n</code> is from 1 to 100.
</p>
<p>For the MAD estimators, <a href="stats.html#topic+mad">mad</a>{stats} is used. 
For the Hodges-Lehmann, <code>HL</code>{rQCC} is used.
For the Shamos, the Fisher-consistent Shamos estimator, <code>shamos</code>{rQCC}, is used.
</p>
<p>The empirical variances  are obtained using the Monte Carlo simulation
with 1E07 replicates. 
</p>


<h3>Value</h3>

<p>They return a vector of 100 values.</p>


<h3>Author(s)</h3>

<p>Chanseok Park and Min Wang</p>


<h3>References</h3>

<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators.
<em>Communications in Statistics - Simulation and Computation</em>, 
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>
<p>Hodges, J. L. and E. L. Lehmann (1963).
Estimates of location based on rank tests.
<em>Annals of Mathematical Statistics</em>, <b>34</b>, 598&ndash;611.
</p>
<p>Shamos, M. I. (1976).  Geometry and statistics: Problems at the interface.
In Traub, J. F., editor,
<em>Algorithms and Complexity: New Directions and Recent Results</em>,
pages 251&ndash;280. Academic Press, New York.
</p>
<p>Lèvy-Leduc, C., Boistard, H., Moulines, E., Taqqu, M. S.,      
and Reisen, V. A.  (2011).
Large sample behaviour of some well-known robust estimators under
long-range dependence.
<em>Statistics</em>, <b>45</b>, 59&ndash;71.
</p>

<hr>
<h2 id='plot'>Plot quality control chart</h2><span id='topic+plot.rcc'></span><span id='topic+plot.acc'></span><span id='topic+plot.racc'></span>

<h3>Description</h3>

<p>Plot method for an object of class <code>"acc"</code>, <code>"rcc"</code>, and <code>"racc"</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'acc'
plot(x, digits= getOption("digits")-2, col.line="cyan4", 
                   col.background="ivory", col.boundary="ivory4",
                   cex.text=0.7, x.text, text.offset=0, LCL, CL, UCL, ...)

## S3 method for class 'rcc'
plot(x, digits= getOption("digits")-2, col.line="cyan4", 
                   col.background="ivory", col.boundary="ivory4", 
                   cex.text=0.7, x.text, text.offset=0, LCL, CL, UCL, ...)

## S3 method for class 'racc'
plot(x, digits= getOption("digits")-2, col.line="cyan4",
                   col.background="ivory", col.boundary="ivory4",
                   cex.text=0.7, x.text, text.offset=0, LCL, CL, UCL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>an object of <a href="base.html#topic+class">class</a> <code>"rcc"</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_digits">digits</code></td>
<td>
<p>number of significant digits to use, see <a href="base.html#topic+print">print</a>.</p>
</td></tr>
<tr><td><code id="plot_+3A_col.line">col.line</code></td>
<td>
<p>line color connecting subgroup estimates.</p>
</td></tr>
<tr><td><code id="plot_+3A_col.background">col.background</code></td>
<td>
<p>background color for in-control region.</p>
</td></tr>
<tr><td><code id="plot_+3A_col.boundary">col.boundary</code></td>
<td>
<p>boundary color for in-control region.</p>
</td></tr>
<tr><td><code id="plot_+3A_cex.text">cex.text</code></td>
<td>
<p>magnification to be used for the text labels (LCL, CL, UCL).</p>
</td></tr>
<tr><td><code id="plot_+3A_x.text">x.text</code></td>
<td>
<p>a vector of x-coordinates where the text labels (LCL, CL, UCL) should be written.
If missing, the text labels will be written on the right side.</p>
</td></tr>
<tr><td><code id="plot_+3A_text.offset">text.offset</code></td>
<td>
<p>an offset value for the text labes (LCL, CL, UCL).</p>
</td></tr>
<tr><td><code id="plot_+3A_lcl">LCL</code></td>
<td>
<p>lower control limit. If missing, use the value from an object of class <code>"rcc"</code> or <code>"acc"</code>.</p>
</td></tr> 
<tr><td><code id="plot_+3A_cl">CL</code></td>
<td>
<p>center line.  If missing, use the value from an object of class <code>"rcc"</code> or <code>"acc"</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_ucl">UCL</code></td>
<td>
<p>upper control limit. If missing, use the value from an object of class <code>"rcc"</code> or <code>"acc"</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>additional parameters to plot.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chanseok Park</p>


<h3>See Also</h3>

<p><code>acc</code>{rQCC}, <code>rcc</code>{rQCC},  <code>racc</code>{rQCC},  <a href="graphics.html#topic+plot">plot</a>
</p>

<hr>
<h2 id='pooled.Estimator'>Pooled Estimator</h2><span id='topic+pooledEstimator'></span>

<h3>Description</h3>

<p>This function calculates the pooled estimator
based on the unbiased estimators such as the  mean, median, Hodges-Lehmann (HL1, HL2, HL3),
standard deviation, range,  
median absolute deviation (MAD) and Shamos estimators.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pooledEstimator(x, estimator = c("mean", "median", "HL1", "HL2", "HL3", 
                                 "sd", "range", "mad", "shamos"), 
                   poolType=c("A", "B", "C") )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pooled.Estimator_+3A_x">x</code></td>
<td>
<p>a numeric list of observations.</p>
</td></tr>
<tr><td><code id="pooled.Estimator_+3A_estimator">estimator</code></td>
<td>
<p>a character string specifying the estimator, must be
one of <code>"mean"</code> (default), <code>"median"</code>, <code>"HL1"</code>, <code>"HL2"</code>, <code>"HL3"</code>,
<code>"sd"</code>, <code>"range"</code>, <code>"mad"</code>, and <code>"shamos"</code>.</p>
</td></tr>
<tr><td><code id="pooled.Estimator_+3A_pooltype">poolType</code></td>
<td>
<p>Type for how to pool estimators, must be
one of <code>"A"</code> (default), <code>"B"</code>, and <code>"C"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the pooled estimator based on 
one of <code>"mean"</code> (default), <code>"median"</code>, <code>"HL1"</code>, <code>"HL2"</code>, <code>"HL3"</code>, 
<code>"sd"</code>, <code>"mad"</code>, and <code>"shamos"</code>, which are all unbiased. 
There are three different methods of pooling the estimators, denoted by 
<code>"A"</code> (default), <code>"B"</code>, and <code>"C"</code>.
For more details on how to pool them, refer to vignette.
</p>


<h3>Value</h3>

<p>They return a numeric value.</p>


<h3>Author(s)</h3>

<p>Chanseok Park</p>


<h3>References</h3>

<p>Park, C. and M. Wang (2020).
A study on the X-bar and S control charts with unequal sample sizes.
<em>Mathematics</em>, <b>8</b>(5), 698. <br />
doi: <a href="https://doi.org/10.3390/math8050698">10.3390/math8050698</a>
</p>
<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators.
<em>Communications in Statistics - Simulation and Computation</em>,
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 = c(1,2,3,4,5)
x2 = c(6,7)
x  = list(x1,x2)

# Pooled sample mean (default) by type "A" pooling
pooledEstimator(x) 
pooledEstimator(x, "mean", "A") # same as the above 

# Pooled sample mean by type "B" pooling
pooledEstimator(x, "mean", "B")


# Pooled sample sd by type "B" pooling
pooledEstimator(x, estimator="sd", pool="B")
</code></pre>

<hr>
<h2 id='relative.efficiency'>Relative efficiency (RE)</h2><span id='topic+RE'></span>

<h3>Description</h3>

<p><code>RE</code> calculates the relative efficiency value
of a location estimator (<code>"median"</code>, <code>"HL1"</code>, <code>"HL2"</code>, <code>"HL3"</code>)
with respect to the sample mean and
that of a scale estimator (<code>"range"</code>, <code>"mad"</code>, <code>"shamos"</code>)
with respect to the sample standard deviation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>RE(n, estimator=c("mean", "median", "HL1", "HL2", "HL3", "sd", "range", "mad", "shamos"),
      poolType =c("A", "B", "C"), 
      baseEstimator, basePoolType, correction=TRUE, correctionBase)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relative.efficiency_+3A_n">n</code></td>
<td>
<p>a vector of sample sizes (<code class="reqn">n_i \ge 1</code>).</p>
</td></tr>
<tr><td><code id="relative.efficiency_+3A_estimator">estimator</code></td>
<td>
<p>a character string specifying the estimator, must be 
one of <code>"mean"</code> (default), <code>"median"</code>, <code>"HL1"</code>, <code>"HL2"</code>, <code>"HL3"</code>, 
<code>"sd"</code>, <code>"range"</code>, <code>"mad"</code>, and <code>"shamos"</code>.</p>
</td></tr>
<tr><td><code id="relative.efficiency_+3A_pooltype">poolType</code></td>
<td>
<p>Type for how to pool estimators, must be 
one of <code>"A"</code> (default), <code>"B"</code>, and <code>"C"</code>.</p>
</td></tr>
<tr><td><code id="relative.efficiency_+3A_baseestimator">baseEstimator</code></td>
<td>
<p>a character string specifying the baseline estimator 
on the numerator of the relative efficiency, must be
one of <code>"mean"</code> (default), <code>"median"</code>, <code>"HL1"</code>, <code>"HL2"</code>, <code>"HL3"</code>,
<code>"sd"</code>, <code>"range"</code>, <code>"mad"</code>, and <code>"shamos"</code>.</p>
</td></tr>
<tr><td><code id="relative.efficiency_+3A_basepooltype">basePoolType</code></td>
<td>
<p>Type for how to pool baseline estimator, must be 
one of <code>"A"</code>, <code>"B"</code>, and <code>"C"</code>. 
If missing, <code>basePoolType &lt;- poolType</code> is used.</p>
</td></tr>
<tr><td><code id="relative.efficiency_+3A_correction">correction</code></td>
<td>
<p>logical. A finite-sample bias correction for the estimator with a single sample.
<code>TRUE</code> (default) adjusts a finite-sample bias correction for a scale estimator using <code>c4.factor</code> function.</p>
</td></tr>
<tr><td><code id="relative.efficiency_+3A_correctionbase">correctionBase</code></td>
<td>
<p>logical. 
A finite-sample bias correction for the baseline estimator with a single sample. 
If missing, <code>correctionBase &lt;- correction</code> is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under the assumption of the normal distribution, 
the function calculates the relative efficiency value of 
the mean, median and Hodges-Lehmann (HL1, HL2, HL3) estimators with respect to the selected baseline
estimator (default is the sample mean)
and that of the standard deviation, range, median absolute deviation (MAD) and 
Shamos estimators with respect to the selected baseline estimator 
(default is the sample standard deviation).
</p>
<p>For the case of the sample mean, standard deviation and range, 
it is possible to derive their variances in analytic form, 
but, for the other case, it may be impossible.
In this case, 
the variances with <code class="reqn">n=1,2,\ldots,100</code> are obtained
using the extensive Monte Carlo simulation with 1E07 replicates.
For <code class="reqn">n &gt; 100</code>, the variances are approximated based on the method of Hayes (2014).
</p>
<p>To obtain the relative efficiency value of the unbiased scale estimators, 
use <code>correction=TRUE</code> option.
Note that the location estimators 
(<code>"mean"</code>, <code>"median"</code>, <code>"HL1"</code>, <code>"HL2"</code>, <code>"HL3"</code>) are unbiased. 
</p>
<p>If <code>n</code> is a vector of multiple values (multiple samples), the <code>RE</code> function calculates 
the relative efficiency value of the pooled estimator. In this case, only unbiased pooled estimator
and baseline estimator are considered. 
That is, we use <code>correction=TURE</code> and <code>correctionBase=TURE</code> for multiple samples. 
</p>
<p>Note that the relative efficiency (RE) of <code class="reqn">\hat{\theta}_2</code> with respect to 
<code class="reqn">\hat{\theta}_1</code> is defined as 
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{RE}(\hat{\theta}_2 | \hat{\theta}_1) 
=\frac{\mathrm{Var}(\hat{\theta}_1)}{\mathrm{Var}(\hat{\theta}_2)}.</code>
</p>



<h3>Value</h3>

<p>It returns a numeric value.</p>


<h3>Author(s)</h3>

<p>Chanseok Park</p>


<h3>References</h3>

<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators.
<em>Communications in Statistics - Simulation and Computation</em>, 
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>
<p>Hayes, K. (2014).
Finite-sample bias-correction factors for the median absolute deviation.
<em>Communications in Statistics: Simulation and Computation</em>,
<b>43</b>, 2205&ndash;2212.
</p>


<h3>See Also</h3>

<p><code>n.times.eVar.of.HL1</code>{rQCC} 
for the empirical variance of the HL1 estimator (times <code class="reqn">n</code>).<br />
<code>n.times.eVar.of.HL2</code>{rQCC} 
for the empirical variance of the HL2 estimator (times <code class="reqn">n</code>).<br />
<code>n.times.eVar.of.HL3</code>{rQCC} 
for the empirical variance of the HL3 estimator (times <code class="reqn">n</code>).<br />
<code>n.times.eVar.of.mad</code>{rQCC} 
for the empirical variance of the MAD estimator (times <code class="reqn">n</code>).<br />
<code>n.times.eVar.of.median</code>{rQCC} 
for the empirical variance of the median estimator (times <code class="reqn">n</code>).<br />
<code>n.times.eVar.of.shamos</code>{rQCC} 
for the empirical variance of the Shamos estimator (times <code class="reqn">n</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#################
# Single sample #
#################

# RE of the Hodges-Lehmann (HL2) estimator 
#  with respect to the sample standard deviation under the normal distribution.
RE(n=5, estimator="HL2")

# RE of the unbiased Shamos estimator 
# with respect to the unbiased sample standard deviation under the normal distribution.
RE(n=5, estimator="shamos")

# RE of the original Shamos estimator 
# with respect to the sample standard deviation under the normal distribution.
RE(n=5, estimator="shamos", correction=FALSE)

# RE of the unbiased range ( (maximum - minimum) / d2 )
# with respect to the unibased sample standard deviation under the normal distribution.
RE(n=6, estimator="range")

# RE of the original range (maximum minus minimum)
# with respect to the sample standard deviation under the normal distribution.
RE(n=6, estimator="range", correction=FALSE)


####################
# Multiple samples #
####################
# With multiple samples, only the unbiased pooled estimators are considered.

# RE of the pooled median (pooling type A) with respect to the mean (pooling type A)
RE( n=c(4,5), estimator="median" )

# RE of the pooled median (pooling type A) with respect to the median (pooling type C)
RE( n=c(4,5), estimator="median", baseEstimator="median", basePoolType="C")

# RE of the pooled mad (pooling type A) with respect to the standard deviation (pooling type A)
RE( n=c(4,5), estimator="mad")

# RE of the pooled mad (pooling type A) with respect to the standard deviation (pooling type C)
RE( n=c(4,5), estimator="mad", basePoolType="C")

# RE of the pooled standard deviation (pooling type A) with respect to the sd (pooling type C)
RE( n=c(4,5), estimator="sd", baseEstimator="sd", basePoolType="C" )
</code></pre>

<hr>
<h2 id='robust.attributes.chart.unbalanced'>Robust attributes control charts with balanced/unbalanced samples</h2><span id='topic+racc'></span><span id='topic+print.racc'></span><span id='topic+summary.racc'></span>

<h3>Description</h3>

<p>Constructs the robust g and h attributes control charts with balanced/unbalanced samples.</p>


<h3>Usage</h3>

<pre><code class='language-R'>racc (x, gamma, type=c("g","h","t"), parameter, gEstimator=c("cdf", "MM"), 
      tModel=c("E", "W"), location.shift = 0, sigmaFactor=3, nk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robust.attributes.chart.unbalanced_+3A_x">x</code></td>
<td>
<p>a numeric vector of the number of nonconforming units.</p>
</td></tr>
<tr><td><code id="robust.attributes.chart.unbalanced_+3A_gamma">gamma</code></td>
<td>
<p>a numeric value for a inlier proportion.
gamma should be between 0 and 1 (smaller value means more trimming). </p>
</td></tr>
<tr><td><code id="robust.attributes.chart.unbalanced_+3A_type">type</code></td>
<td>
<p>a character string specifying the type of control chart.</p>
</td></tr>
<tr><td><code id="robust.attributes.chart.unbalanced_+3A_parameter">parameter</code></td>
<td>
<p>a known Bernoulli parameter value for the <code class="reqn">g</code> and <code class="reqn">h</code> charts.
If not known, it is estimated. For more details, refer to <code>vignette("racc", package="rQCC")</code>.</p>
</td></tr>
<tr><td><code id="robust.attributes.chart.unbalanced_+3A_gestimator">gEstimator</code></td>
<td>
<p>a method for estimating the Bernoulli parameter for <code class="reqn">g</code> and <code class="reqn">h</code> charts.
&quot;cdf&quot; is based on the memoryless property and &quot;MM&quot; is based on the truncated geometric distribution.
</p>
</td></tr>
<tr><td><code id="robust.attributes.chart.unbalanced_+3A_tmodel">tModel</code></td>
<td>
<p>Probability model for <code class="reqn">t</code> chart. &quot;E&quot; for Exponential and &quot;W&quot; for Weibull.</p>
</td></tr>
<tr><td><code id="robust.attributes.chart.unbalanced_+3A_location.shift">location.shift</code></td>
<td>
<p>a known location shift parameter value for  <code class="reqn">g</code> and <code class="reqn">h</code> charts.</p>
</td></tr>
<tr><td><code id="robust.attributes.chart.unbalanced_+3A_sigmafactor">sigmaFactor</code></td>
<td>
<p>a factor for the standard deviation (<code class="reqn">\sigma</code>).  
For example, the American Standard uses &quot;<em>3*sigma</em>&quot; limits (0.27% false alarm rate),
while the British Standard uses &quot;<em>3.09*sigma</em>&quot; limits (0.20% false alarm rate).</p>
</td></tr>
<tr><td><code id="robust.attributes.chart.unbalanced_+3A_nk">nk</code></td>
<td>
<p>sample size for Phase-II. If <code>nk</code> is missing, the average of the subsample sizes is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>racc</code> constructs the attributes control charts 
for nonconforming units (<code class="reqn">p</code> and <code class="reqn">np</code> charts)
and for nonconformities per unit (<code class="reqn">c</code> and <code class="reqn">u</code> charts).</p>


<h3>Value</h3>

<p><code>racc</code> returns an object of <a href="base.html#topic+class">class</a> &quot;racc&quot;.
The function <code>summary</code> is used to obtain and print a summary of the results
and the function <code>plot</code> is used to plot the control chart.
</p>


<h3>Author(s)</h3>

<p>Chanseok Park</p>


<h3>References</h3>

<p>Park, C., L. Ouyang, and M. Wang (2021).
Robust g-type quality control charts for monitoring nonconformities. 
<em>Computers and Industrial Engineering</em>, <b>162</b>, 107765.
</p>
<p>Kaminsky, F. C., J. C. Benneyan and R. D. Davis (1992).
Statistical Control Charts Based on a Geometric Distribution.
<em>Journal of Quality Technology</em>, <b>24</b>, 63-69.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ===============================
# Example 1: g and h charts
# -------------------------------
# Refer to Kaminsky et al. (1992) and Table 2 of Park, et al. (2021).
tmp = c(
11,  2,  8,  2, 4,   1,  1, 11,  2, 1,   1,  7,  1,  1, 9, 
 5,  1,  3,  6, 5,  13,  2,  3,  3, 4,   3,  2,  6,  1, 5,  
 2,  2,  8,  3, 1,   1,  3,  4,  6, 5,   2,  8,  1,  1, 4,  
13, 10, 15,  5, 2,   3,  6,  1,  5, 8,   9,  1, 18,  3, 1,  
 3,  7, 14,  3, 1,   7,  7,  1,  8, 1,   4,  1,  6,  1, 1, 
 1, 14,  2,  3, 7,  19,  9,  7,  1, 8,   5,  1,  1,  6, 1,  
 9,  5,  6,  2, 2,   8, 15,  2,  3, 3,   4,  7, 11,  4, 6,  
 7,  5,  1, 14, 8,   3,  3,  5, 21,10,  11,  1,  6,  1, 2,  
 4,  1,  2, 11, 5,   3,  5,  4, 10, 3,   1,  4,  7,  3, 2, 
 3,  5,  4,  2, 3,   5,  1,  4, 11,17,   1, 13, 13,  2, 1)  
data = matrix(tmp, byrow=TRUE, ncol=5)

# g chart with cdf (trimming) method.
# Print LCL, CL, UCL.
result = racc(data, gamma=0.9, type="g", location=1)
print(result)

# Summary of a control chart
summary(result)

plot(result, cex.text=0.8)

# h chart with MM (truncated geometric) method.
racc(data, gamma=0.9, type="h", location=1, gEstimator="MM")


# ===============================
# Example 2: g and h charts (unbalanced data)
# -------------------------------
x1 = c(11, 2,  8,  2, 4)
x2 = c(1,  1, 11,  2, 1)
x3 = c(1,  7,  1)
x4 = c(5,  1,  3,  6, 5)
x5 = c(13, 2,  3,  3)
x6 = c(3,  2,  6,  1, 5)
x7 = c(2,  2,  8,  3, 1)
x8 = c(1,  3,  4,  6, 5)
x9 = c(2,  8,  1,  1, 4)
data = list(x1, x2, x3, x4, x5, x6, x7, x8, x9)

result = racc(data, gamma=0.9, type="g", location=1, gEstimator="cdf", nk=5)
summary(result)
plot(result)


# ===============================
# Example 3: t charts 
# -------------------------------
x = c(0.35, 0.92, 0.59, 4.28, 0.21, 0.79, 1.75, 0.07, 3.3,
1.7, 0.33, 0.97, 0.96, 2.23, 0.88, 0.37, 1.3, 0.4, 0.19, 1.59)

# Exponential t chart
result = racc(x, type="t", tModel="E")
summary(result)

plot(result, cex.text=0.8)
text(10, 6, labels="Robust exponential t chart" )


# Weibull t chart
result = racc(x, type="t", tModel="W")
summary(result)

plot(result, cex.text=0.8)
text(10, 5.5, labels="Robust Weibull t chart" )

</code></pre>

<hr>
<h2 id='robust.chart.unbalanced'>Robust quality control chart with balanced/unbalanced samples</h2><span id='topic+rQCC'></span><span id='topic+rcc'></span><span id='topic+print.rcc'></span><span id='topic+summary.rcc'></span>

<h3>Description</h3>

<p>Constructs the robust control charts with balanced/unbalanced samples.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcc (x, location = c("mean", "median", "HL1", "HL2", "HL3"), 
     scale = c("sd", "range", "mad", "shamos"), type = c("Xbar", "S", "R"), 
     poolLoc = c("A", "B", "C"), poolScale = c("A", "B", "C"), sigmaFactor=3, nk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robust.chart.unbalanced_+3A_x">x</code></td>
<td>
<p>a numeric matrix or list of vectors. Each row or vector contains a sub-sample.</p>
</td></tr>
<tr><td><code id="robust.chart.unbalanced_+3A_location">location</code></td>
<td>
<p>a character string specifying the location estimator, must be 
one of <code>"mean"</code> (default), <code>"median"</code>, <code>"HL1"</code>, <code>"HL2"</code> and <code>"HL3"</code>.</p>
</td></tr>
<tr><td><code id="robust.chart.unbalanced_+3A_scale">scale</code></td>
<td>
<p>a character string specifying the scale estimator, must be 
one of <code>"sd"</code> (default), <code>"range"</code>, <code>"mad"</code> and <code>"shamos"</code>.</p>
</td></tr>
<tr><td><code id="robust.chart.unbalanced_+3A_type">type</code></td>
<td>
<p>a character string specifying the type of control chart.</p>
</td></tr>
<tr><td><code id="robust.chart.unbalanced_+3A_poolloc">poolLoc</code></td>
<td>
<p>pooling type for location.</p>
</td></tr>
<tr><td><code id="robust.chart.unbalanced_+3A_poolscale">poolScale</code></td>
<td>
<p>pooling type for scale.</p>
</td></tr>
<tr><td><code id="robust.chart.unbalanced_+3A_sigmafactor">sigmaFactor</code></td>
<td>
<p>a factor for the standard deviation (<code class="reqn">\sigma</code>).  
For example, the American Standard uses &quot;<em>3*sigma</em>&quot; limits (0.27% false alarm rate),
while the British Standard uses &quot;<em>3.09*sigma</em>&quot; limits (0.20% false alarm rate).</p>
</td></tr>
<tr><td><code id="robust.chart.unbalanced_+3A_nk">nk</code></td>
<td>
<p>sample size for Phase-II. If <code>nk</code> is missing, the average sample size is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rcc</code> constructs the robust X-bar, S and R control charts.
Using various robust location and scale estimators, one can construct the robust control charts.
For more details on the control charts, refer to <code>vignette("rcc", package="rQCC")</code>.
</p>
<p>Note that the location and scale estimators used in this fuction are all unbiased.
For more details on how to pool the location and scale estimators, refer to 
<code>vignette("pooledEstimator", package="rQCC")</code>.
</p>
<p>In addition, one can also construct the conventional <code class="reqn">\bar{X}</code> chart with <code class="reqn">S</code> and 
<code class="reqn">\bar{X}</code> chart with <code class="reqn">R</code>.
</p>


<h3>Value</h3>

<p><code>rcc</code> returns an object of <a href="base.html#topic+class">class</a> &quot;rcc&quot;.
The function <code>summary</code> is used to obtain and print a summary of the results
and the function <code>plot</code> is used to plot the control chart.
</p>


<h3>Author(s)</h3>

<p>Chanseok Park and Min Wang</p>


<h3>References</h3>

<p>Park, C., L. Ouyang, and M. Wang (2022).
Development of robust X-bar charts with unequal sample sizes.
<em>ArXiv e-prints</em>,	2212.10731.  <br /> 
doi: <a href="https://doi.org/10.48550/arXiv.2212.10731">10.48550/arXiv.2212.10731</a>
</p>
<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators. 
<em>Communications in Statistics - Simulation and Computation</em>, 
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>
<p>ASTM (2010).
<em>Manual on Presentation of Data and Control Chart Analysis</em> (STP 15-D),
8th edition. 
American Society for Testing and Materials, West Conshohocken, PA.
</p>
<p>Ryan (2000). 
<em>Statistical Methods For Quality Improvement</em>, 2nd edition.
John Wiley &amp; Sons, New York, NY.
</p>
<p>Montgomery (2013). 
<em>Statistical Quality Control: An Modern Introduction</em>, 7th edition. 
John Wiley &amp; Sons, New York, NY.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###############
# X-bar chart #
###############

# ========== 
# Example 1a 
# ---------- 
# The conventional X-bar chart with the standard deviation. 
# Refer to Example 3 in Section 3.31 of ASTM (2010). 

# The data below are from Table 29 in Section 3.31 of ASTM (2010). 
# Each subgroup has a sample of size n=6. There are m=10 subgroups.
x1 = c(0.5005, 0.5000, 0.5008, 0.5000, 0.5005, 0.5000)
x2 = c(0.4998, 0.4997, 0.4998, 0.4994, 0.4999, 0.4998)
x3 = c(0.4995, 0.4995, 0.4995, 0.4995, 0.4995, 0.4996)
x4 = c(0.4998, 0.5005, 0.5005, 0.5002, 0.5003, 0.5004)
x5 = c(0.5000, 0.5005, 0.5008, 0.5007, 0.5008, 0.5010)
x6 = c(0.5008, 0.5009, 0.5010, 0.5005, 0.5006, 0.5009)
x7 = c(0.5000, 0.5001, 0.5002, 0.4995, 0.4996, 0.4997)
x8 = c(0.4993, 0.4994, 0.4999, 0.4996, 0.4996, 0.4997)
x9 = c(0.4995, 0.4995, 0.4997, 0.4992, 0.4995, 0.4992)
x10= c(0.4994, 0.4998, 0.5000, 0.4990, 0.5000, 0.5000)
data1 = rbind(x1, x2, x3, x4, x5, x6, x7, x8, x9, x10)

# Print LCL, CL, UCL.
# The mean and standard deviation are used.
result = rcc(data1, loc="mean", scale="sd", type="Xbar") 
print(result)

# Note: X-bar chart is a default with the mean and sd
#       so the below is the same as the above.
rcc(data1) 

# Summary of a control chart
summary(result)
RE(n=6, estimator="sd", correction=TRUE)

# The above limits are also calculated as 
A3 = factors.cc(n=6, "A3")

xbarbar = mean(data1)
 # xbarbar = mean(unlist(data1)) # for list

sbar = mean( apply(data1, 1, sd) )
c(xbarbar-A3*sbar, xbarbar, xbarbar+A3*sbar)

# Plot a control chart
plot(result, cex.text=0.8)
abline(v=5.5, lty=1, lwd=2, col="gold")
text( c(3,8), c(0.5005, 0.5005), labels=c("Group 1", "Group 2") )

# ==========
# Example 1b 
# ----------
# The conventional X-bar chart with the range.
# Refer to Example 5 in Section 3.31 of ASTM (2010).
# The data are the same as in Example 1a.

# Print LCL, CL, UCL.
# The range is used for the scale estimator.
result = rcc(data1, loc="mean", scale="range")
print(result)

# Summary of a control chart
# Note: the RE is calculated based on the unbiased estimators.
summary(result)
RE(n=6, estimator="range", correction=TRUE)

# The above limits are also calculated as 
A2 = factors.cc(n=6, "A2")

xbarbar = mean(data1)
 # xbarbar = mean(unlist(data1)) # for list

Rbar = mean( apply(data1, 1, function(x) {diff(range(x))}) )
 # Rbar = mean( apply(sapply(data1,range),2,diff) ) # for list

c(xbarbar-A2*Rbar, xbarbar, xbarbar+A2*Rbar)

# Plot a control chart
plot(result, cex.text=0.8)
abline(v=5.5, lty=1, lwd=2, col="gold")
text( c(3,8), c(0.5005, 0.5005), labels=c("Group 1", "Group 2") )

# ==========
# Example 1c 
# ----------
# The median-MAD chart.
# Refer to Table 4.2 in Section 4.7 of Ryan (2000).
# Data: 20 subgroups with 4 observations each.
tmp = c(
72, 84, 79, 49, 56, 87, 33, 42, 55, 73, 22, 60, 44, 80, 54, 74,
97, 26, 48, 58, 83, 89, 91, 62, 47, 66, 53, 58, 88, 50, 84, 69,
57, 47, 41, 46, 13, 10, 30, 32, 26, 39, 52, 48, 46, 27, 63, 34,
49, 62, 78, 87, 71, 63, 82, 55, 71, 58, 69, 70, 67, 69, 70, 94,
55, 63, 72, 49, 49, 51, 55, 76, 72, 80, 61, 59, 61, 74, 62, 57 )
data2 = matrix(tmp, ncol=4, byrow=TRUE)

# Print LCL, CL, UCL.
# The median (location) and MAD (scale) are used.
rcc(data2, loc="median", scale="mad")

# Note: the RE is calculated based on the unbiased estimators.
RE(n=4, estimator="median", correction=TRUE)

# ==========
# Example 1d 
# ----------
# The HL2-Shamos chart.
# The data are the same as in Example 1c.

# Print LCL, CL, UCL.
# The HL2 (location) and Shamos (scale) are used.
rcc(data2, loc="HL2", scale="shamos")

# Note: the RE is calculated based on the unbiased estimators.
RE(n=4, estimator="HL2", correction=TRUE)


############
# S chart  #
############

# ==========
# Example 2a 
# ----------
# The conventional S chart with the standard deviation.
# Refer to Example 3 in Section 3.31 of ASTM (2010). 
# The data are the same as in Example 1a.

# Print LCL, CL, UCL.
# The standard deviaion (default) is used for the scale estimator.
result = rcc(data1, type="S")
print(result)

# The above limits are also calculated as 
B3 = factors.cc(n=6, "B3")
B4 = factors.cc(n=6, "B4")
sbar = mean( apply(data1, 1, sd) )
c(B3*sbar, sbar, B4*sbar)

# Plot a control chart
plot(result, cex.text=0.8)
abline(v=5.5, lty=1, lwd=2, col="gold")
text( c(3,8), c(0.0005, 0.0005), labels=c("Group 1", "Group 2") )


# ==========
# Example 2b
# ----------
# The S-type chart with the MAD.
# The data are the same as in Example 2a.

# Print LCL, CL, UCL.
# The mad (scale) are used.
result = rcc(data1, scale="mad", type="S")
print(result)

# Plot a control chart
plot(result, cex.text=0.8)
abline(v=5.5, lty=1, lwd=2, col="gold")
text( c(3,8), c(0.00045, 0.00045), labels=c("Group 1", "Group 2") )


############
# R chart  #
############

# ==========
# Example 3a 
# ----------
# The conventional R chart with the range.
# Refer to Example 5 in Section 3.31 of ASTM (2010). 
# The data are the same as in Example 1a.

# Print LCL, CL, UCL.
# The range is used for the scale estimator.
# Unlike the S chart, scale="range" is not a default. 
# Thus, for the conventional R chart, use the option (scale="range") as below.
result = rcc(data1, scale="range", type="R")
print(result)

# The above limits are also calculated as 
D3 = factors.cc(n=6, "D3")
D4 = factors.cc(n=6, "D4")

Rbar = mean( apply(data1, 1, function(x) {diff(range(x))}) )
 # Rbar = mean( apply(sapply(data1,range),2,diff) ) # for list

c(D3*Rbar, Rbar, D4*Rbar)

# Plot a control chart
plot(result, cex.text=0.8)
abline(v=5.5, lty=1, lwd=2, col="gold")
text( c(3,8), c(0.00135, 0.00135), labels=c("Group 1", "Group 2") )


# ==========
# Example 3b
# ----------
# The R-type chart with the Shamos.
# Refer to Example 5 in Section 3.31 of ASTM (2010). 
# The data are the same as in Example 3a.

# Print LCL, CL, UCL.
# The mad (scale) are used.
result = rcc(data1, scale="shamos", type="R")
print(result)

# Plot a control chart
plot(result, cex.text=0.8)
abline(v=5.5, lty=1, lwd=2, col="gold")
text( c(3,8), c(0.00135, 0.00135), labels=c("Group 1", "Group 2") )


###################
# Unbalanced Data #
###################

# ==========
# Example 4
# ----------
# Refer to Example 4 in Section 3.31 of ASTM (2010).
# Data set is from Table 30 in Section 3.31 of ASTM (2010).
 x1 = c( 73, 73, 73, 75, 75)
 x2 = c( 70, 71, 71, 71, 72)
 x3 = c( 74, 74, 74, 74, 75)
 x4 = c( 70, 70, 70, 72, 73)
 x5 = c( 70, 70, 70, 70, 70)
 x6 = c( 65, 65, 66, 69, 70)
 x7 = c( 72, 72, 74, 76)
 x8 = c( 69, 70, 71, 73, 73)
 x9 = c( 71, 71, 71, 71, 72)
x10 = c( 71, 71, 71, 71, 72)
x11 = c( 71, 71, 72, 72, 72)
x12 = c( 70, 71, 71, 72, 72)
x13 = c( 73, 74, 74, 75, 75)
x14 = c( 74, 74, 75, 75, 75)
x15 = c( 72, 72, 72, 73, 73)
x16 = c( 75, 75, 75, 76)
x17 = c( 68, 69, 69, 69, 70)
x18 = c( 71, 71, 72, 72, 73)
x19 = c( 72, 73, 73, 73, 73)
x20 = c( 68, 69, 70, 71, 71)
x21 = c( 69, 69, 69, 69, 69)

# For unbalanced data set, use list.
data = list(x1, x2,  x3, x4,  x5,  x6,  x7,  x8,  x9, x10,
            x11,x12,x13,x14, x15, x16, x17, x18, x19, x20, x21)

# Xbar chart (witn nk=5)
rcc(data, nk=5)

# S chart (witn nk=4)
rcc(data, type="S", nk=4)

# ==========
# Example 5a
# ----------
# Data set is from Example 6.4 of Montgomery (2013)
#    Statistical Quality Control (7th ed), Wiley.
# Data set for Phase I
 x1 = c(74.030, 74.002, 74.019, 73.992, 74.008)
 x2 = c(73.995, 73.992, 74.001)
 x3 = c(73.988, 74.024, 74.021, 74.005, 74.002)
 x4 = c(74.002, 73.996, 73.993, 74.015, 74.009)
 x5 = c(73.992, 74.007, 74.015, 73.989, 74.014)
 x6 = c(74.009, 73.994, 73.997, 73.985)
 x7 = c(73.995, 74.006, 73.994, 74.000)
 x8 = c(73.985, 74.003, 73.993, 74.015, 73.988)
 x9 = c(74.008, 73.995, 74.009, 74.005)
x10 = c(73.998, 74.000, 73.990, 74.007, 73.995)
x11 = c(73.994, 73.998, 73.994, 73.995, 73.990)
x12 = c(74.004, 74.000, 74.007, 74.000, 73.996)
x13 = c(73.983, 74.002, 73.998) 
x14 = c(74.006, 73.967, 73.994, 74.000, 73.984)
x15 = c(74.012, 74.014, 73.998) 
x16 = c(74.000, 73.984, 74.005, 73.998, 73.996)
x17 = c(73.994, 74.012, 73.986, 74.005) 
x18 = c(74.006, 74.010, 74.018, 74.003, 74.000)
x19 = c(73.984, 74.002, 74.003, 74.005, 73.997)
x20 = c(74.000, 74.010, 74.013) 
x21 = c(73.982, 74.001, 74.015, 74.005, 73.996)
x22 = c(74.004, 73.999, 73.990, 74.006, 74.009)
x23 = c(74.010, 73.989, 73.990, 74.009, 74.014)
x24 = c(74.015, 74.008, 73.993, 74.000, 74.010)
x25 = c(73.982, 73.984, 73.995, 74.017, 74.013) 

# For unbalanced data set, use list.
data = list(x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15, 
           x16, x17, x18, x19, x20, x21, x22, x23, x24, x25)

# Xbar chart (witn nk=5)
rcc(data, nk=5)

# Xbar chart (witn nk=5) with different pooling methods
rcc(data, nk=5, poolLoc="C", poolScale="C")

# S chart (witn nk=5)
rcc(data, type="S", nk=5)

# S chart (witn nk=5) with plling method C.
rcc(data, type="S", nk=5, poolScale="C")

# ==========
# Example 5b
# ----------
# With contaminated data set. 
# Two contaminated observations are added 
#   in the first subgroup (70.5, 77.0) of Example 5a.
datan = data
datan[[1]] = c(data[[1]], 70.5, 77.0)

# Xbar chart with non-robust estimators 
rcc(datan, nk=5)

# robust Xbar chart (median and mad estimates)
rcc(datan, loc="median", sc="mad", nk=5)

# robust Xbar chart (median and mad estimates) with different pooling methods
rcc(datan, loc="median", sc="mad", nk=5, poolLoc="C", poolScale="C")

# robust S chart (mad estimate) with different pooling methods
rcc(datan, type="S", sc="mad", nk=5, poolScale="B")
rcc(datan, type="S", sc="mad", nk=5, poolScale="C")
</code></pre>

<hr>
<h2 id='sd.unbiased'>Unbiased standard deviation</h2><span id='topic+sd.unbiased'></span>

<h3>Description</h3>

<p>This function computes the unbiased standard deviation of the values in <code>x</code>.
If <code>na.rm</code> is <code>TRUE</code>, then missing values are removed before computation proceeds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sd.unbiased(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sd.unbiased_+3A_x">x</code></td>
<td>
<p>a numeric vector or an <span class="rlang"><b>R</b></span> object which is coercible to one
by <code>as.double(x)</code>.</p>
</td></tr>
<tr><td><code id="sd.unbiased_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.  If <code>TRUE</code>, then missing values are removed before computation proceeds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="stats.html#topic+sd">sd</a></code> is not unbiased. 
This function computes <code><a href="stats.html#topic+sd">sd</a></code> divided by <code class="reqn">c_4(n)</code>, where <code class="reqn">c_4(n)</code>
is obtained by <code>c4.factor(n, estimator="sd")</code>{rQCC}.
</p>


<h3>Author(s)</h3>

<p>Chanseok Park</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+sd">sd</a></code> for the square root of <code><a href="stats.html#topic+var">var</a></code>, but it is biased. <br />
Refer to <code>mad.unbiased</code>{rQCC} for finite-sample unbiased median absolute deviation 
(MAD) estimator, the most robust alternative. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sd.unbiased(1:2)
</code></pre>

<hr>
<h2 id='Shamos'>Shamos estimator</h2><span id='topic+shamos'></span><span id='topic+shamos.unbiased'></span><span id='topic+shamos2.unbiased'></span>

<h3>Description</h3>

<p>Calculates the conventional Shamos, unbiased Shamos and unbiased squared 
Shamos estimators.
The conventional Shamos is calculated by <code>shamos</code>
which is Fisher-consistent under the normal distribution.
Note that it is not unbiased with a sample of finite size.
The unbiased Shamos estimator under the normal distribution is
calculated by <code>shamos.unbiased</code> with a finite-sample unbiasing factor.
The unbiased <em>squared</em> Shamos estimator under the normal distribution is
calculated by <code>shamos2.unbiased</code> with a finite-sample unbiasing factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shamos(x, constant=1.048358, na.rm = FALSE,  IncludeEqual=FALSE)

shamos.unbiased(x, constant=1.048358, na.rm = FALSE,  IncludeEqual=FALSE)

shamos2.unbiased(x, constant=1.048358, na.rm = FALSE, IncludeEqual=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Shamos_+3A_x">x</code></td>
<td>
<p>a numeric vector of observations.</p>
</td></tr>
<tr><td><code id="Shamos_+3A_constant">constant</code></td>
<td>
<p>Correction factor for the Fisher-consistency under the normal distribution</p>
</td></tr>
<tr><td><code id="Shamos_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped before the computation proceeds.</p>
</td></tr>
<tr><td><code id="Shamos_+3A_includeequal">IncludeEqual</code></td>
<td>
<p><code>FALSE</code> (default) calculates median of 
<code class="reqn">|X_i-X_j|</code> with <code class="reqn">i &lt; j</code>, 
while <code>TRUE</code> calculates median of <code class="reqn">|X_i-X_j|</code> with <code class="reqn">i \le j</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The Shamos estimator is defined as 
</p>
<p style="text-align: center;"><code class="reqn">\textrm{Shamos}=\code{constant}\times\mathop{\mathrm{median}}_{i &lt; j} \big(|X_i-X_j|\big)</code>
</p>
 
<p>where <code class="reqn">i,j=1,2,\ldots,n</code>. 
The default value (<code>constant=1.048358</code>) ensures the Fisher-consistency under the normal distribution.
Note that 
<code class="reqn">\code{constant}=1/\{\sqrt{2}\,\Phi^{-1}(3/4)\}\approx 1.048358</code>.
</p>
<p>The unbiased Shamos is defined as
</p>
<p style="text-align: center;"><code class="reqn">\textrm{Shamos}=\code{constant}\times\mathop{\mathrm{median}}_{i &lt; j} \big(|X_i-X_j|\big)/{c_6(n)}</code>
</p>

<p>for <code class="reqn">i,j=1,2,\ldots,n</code>, where 
<code class="reqn">c_6(n)</code> is the finite-sample unbiasing factor.
Note that <code class="reqn">c_6(n)</code> notation is used in Park et. al (2022), and 
<code class="reqn">c_6(n)</code> is calculated using the function <code>c4.factor</code>{rQCC} with <code>estimator="shamos"</code> option.
</p>
<p>The unbiased squared Shamos is defined as the
squared <code>shamos</code>{rQCC} divided by  <code class="reqn">w_6(n)</code> where 
<code class="reqn">w_6(n)</code> is the finite-sample unbiasing factor.
Note that <code class="reqn">w_6(n)</code> notation is used in Park et. al (2022), and 
<code class="reqn">w_6(n)</code> is calculated using the function <code>w4.factor</code>{rQCC} 
with <code>estimator="shamos2"</code> option.
Note that the square of the conventional Shamos estimator is
Fisher-consistent for the variance (<code class="reqn">\sigma^2</code>) under the normal distribution, but
it is not unbiased with a sample of finite size.
</p>


<h3>Value</h3>

<p>They return a numeric value.</p>


<h3>Author(s)</h3>

<p>Chanseok Park and Min Wang</p>


<h3>References</h3>

<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators.
<em>Communications in Statistics - Simulation and Computation</em>, 
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>
<p>Shamos, M. I. (1976).  Geometry and statistics: Problems at the interface.
In Traub, J. F., editor,
<em>Algorithms and Complexity: New Directions and Recent Results</em>,
pages 251&ndash;280. Academic Press, New York.
</p>
<p>Lèvy-Leduc, C., Boistard, H., Moulines, E., Taqqu, M. S.,
and Reisen, V. A.  (2011).
Large sample behaviour of some well-known robust estimators under
long-range dependence.
<em>Statistics</em>, <b>45</b>, 59&ndash;71.
</p>


<h3>See Also</h3>

<p><code>mad.unbiased</code>{rQCC} for calculating the <em>unbiased</em> sample MAD.
</p>
<p><a href="stats.html#topic+mad">mad</a>{stats} for calculating the Fisher-consistent sample MAD.
</p>
<p><code>c4.factor</code>{rQCC} for finite-sample unbiasing 
factor for the standard deviation (<code class="reqn">\sigma</code>) under the normal distribution.
</p>
<p><code>w4.factor</code>{rQCC} for finite-sample unbiasing  factor for the squared Shamos estimator
of the variance (<code class="reqn">\sigma^2</code>) under the normal distribution.
</p>
<p><code>finite.breakdown</code>{rQCC} for calculating the finite-sample breakdown point.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = c(0:10, 50)

# Fisher-consistent Shamos, but not unbiased with a finite sample. 
shamos(x)

# Unbiased Shamos. 
shamos.unbiased(x)

# Fisher-consistent squared Shamos, but not unbiased with a finite sample. 
shamos(x)^2 

# Unbiased squared Shamos. 
shamos2.unbiased(x)
</code></pre>

<hr>
<h2 id='unbiasing.factor'>Finite-sample unbiasing factor</h2><span id='topic+c4.factor'></span><span id='topic+w4.factor'></span>

<h3>Description</h3>

<p>Finite-sample unbiasing factor for estimating the standard deviation (<code class="reqn">\sigma</code>)
and the variance (<code class="reqn">\sigma^2</code>) under the normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>c4.factor(n, estimator=c("sd","range", "mad","shamos"))
w4.factor(n, estimator=c("mad2","shamos2"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unbiasing.factor_+3A_n">n</code></td>
<td>
<p>sample size (<code class="reqn">n \ge 1</code>).</p>
</td></tr>
<tr><td><code id="unbiasing.factor_+3A_estimator">estimator</code></td>
<td>
<p>a character string specifying the estimator, must be
one of <code>"sd"</code> (default), <code>"range"</code>, <code>"mad"</code>, <code>"shamos"</code> 
for <code>c4.factor</code>, and one of <code>"mad2"</code> (default), <code>"shamos2"</code> for <code>w4.factor</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The conventional sample standard deviation, range, median absolute deviation (MAD)
and Shamos estimators are Fisher-consistent under the normal distribution, 
but they are not unbiased with a sample of finite size.
</p>
<p>Using the sample standard deviation,
an unbiased estimator of the standard deviation (<code class="reqn">\sigma</code>) is calculated by <br />
<code>sd(x)/c4.factor(length(x), estimator="sd")</code> <br />
</p>
<p>Using the range (maximum minus minimum), 
an unbiased estimator of <code class="reqn">\sigma</code> is calculated by <br />
<code>diff(range(x))/c4.factor(length(x), estimator="range")</code>
</p>
<p>Using the median absolute deviation (<a href="stats.html#topic+mad">mad</a>{stats}),
an unbiased estimator of <code class="reqn">\sigma</code> is calculated by <br />
<code>mad(x)/c4.factor(length(x), estimator="mad")</code>
</p>
<p>Using the Shamos estimator (<code>shamos</code>{rQCC}), 
an unbiased estimator of <code class="reqn">\sigma</code> is calculated by <br /> 
<code>shamos(x)/c4.factor(length(x), estimator="shamos")</code>
</p>
<p>Note that the formula for the unbiasing factor <code class="reqn">c_4(n)</code> is given by 
</p>
<p style="text-align: center;"><code class="reqn">c_4(n) = \sqrt{\frac{2}{n-1}}\cdot\frac{\Gamma(n/2)}{\Gamma((n-1)/2)}.</code>
</p>
  <p><br />
</p>
<p>The <em>squared</em> MAD and <em>squared</em> Shamos are Fisher-consistent for the variance
(<code class="reqn">\sigma^2</code>) under the normal distribution,
but they are not unbiased with a sample of finite size.
</p>
<p>An unbiased estimator of the variance (<code class="reqn">\sigma^2</code>)
is obtained using the finite-sample unbiasing factor (<code>w4.factor</code>).
</p>
<p>Using the squared MAD, an unbiased estimator of <code class="reqn">\sigma^2</code> is calculated by <br />
<code>mad(x)^2/w4.factor(length(x), estimator="mad2")</code>
</p>
<p>Using the squared Shamos estimator,
an unbiased estimator of <code class="reqn">\sigma^2</code> is calculated by <br />
<code>shamos(x)^2/w4.factor(length(x), estimator="shamos2")</code>
</p>
<p>The finite-sample unbiasing factors for the median absolute deviation (MAD)  
and Shamos estimators 
are obtained for <code class="reqn">n=1,2,\ldots,100</code> 
using the extensive Monte Carlo simulation with 1E07 replicates. 
For the case of <code class="reqn">n &gt; 100</code>, they are obtained 
using the method of Hayes (2014).
</p>


<h3>Value</h3>

<p>It returns a numeric value.</p>


<h3>Author(s)</h3>

<p>Chanseok Park</p>


<h3>References</h3>

<p>Park, C., H. Kim, and M. Wang (2022).
Investigation of finite-sample properties of robust location and scale estimators.
<em>Communications in Statistics - Simulation and Computation</em>,
<b>51</b>, 2619-2645. <br /> 
doi: <a href="https://doi.org/10.1080/03610918.2019.1699114">10.1080/03610918.2019.1699114</a>
</p>
<p>Shamos, M. I. (1976).  Geometry and statistics: Problems at the interface.
In Traub, J. F., editor,
<em>Algorithms and Complexity: New Directions and Recent Results</em>,
251&ndash;280. Academic Press, New York.
</p>
<p>Hayes, K. (2014).
Finite-sample bias-correction factors for the median absolute deviation.
<em>Communications in Statistics: Simulation and Computation</em>,
<b>43</b>, 2205&ndash;2212.
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+mad">mad</a>{stats} for the Fisher-consistent median absolute deviation (MAD) estimator 
of the standard deviation (<code class="reqn">\sigma</code>) under the normal distribution.
</p>
<p><code>mad.unbiased</code>{rQCC} for finite-sample unbiased median absolute deviation (MAD) estimator
of the standard deviation (<code class="reqn">\sigma</code>) under the normal distribution.
</p>
<p><code>shamos</code>{rQCC} for the Fisher-consistent Shamos estimator 
of the standard deviation (<code class="reqn">\sigma</code>) under the normal distribution.
</p>
<p><code>shamos.unbiased</code>{rQCC} for finite-sample unbiased Shamos estimator
of the standard deviation (<code class="reqn">\sigma</code>) under the normal distribution.
</p>
<p><code>n.times.eBias.of.mad</code>{rQCC} for the values of the empirical bias of 
the median absolute deviation (MAD) estimator under the standard normal distribution. 
</p>
<p><code>n.times.eBias.of.shamos</code>{rQCC} for the values of the empirical bias of 
the Shamos estimator under the standard normal distribution.   <br /> 
</p>
<p><code>mad2.unbiased</code>{rQCC} for finite-sample unbiased squared
MAD estimator of the variance (<code class="reqn">\sigma^2</code>) under the normal distribution.
</p>
<p><code>shamos2.unbiased</code>{rQCC} for finite-sample unbiased squared Shamos estimator
of the variance (<code class="reqn">\sigma^2</code>) under the normal distribution.
</p>
<p><code>n.times.evar.of.mad</code>{rQCC} for the values of the empirical variance of
the median absolute deviation (MAD) estimator under the standard normal distribution.
</p>
<p><code>n.times.evar.of.shamos</code>{rQCC} for the values of the empirical variance of
the Shamos estimator under the standard normal distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># unbiasing factor for estimating the standard deviation
c4.factor(n=10, estimator="sd")
c4.factor(n=10, estimator="mad")
c4.factor(n=10, estimator="shamos")

# Note: d2 notation is widely used for the bias-correction of the range.
d2 = c4.factor(n=10, estimator="range") 
d2

# unbiasing factor for estimating the variance
w4.factor(n=10, "mad2")
w4.factor(n=10, "shamos2")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
