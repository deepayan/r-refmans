<!DOCTYPE html><html><head><title>Help for package multipleNCC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multipleNCC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Chenprob'>
<p>Sampling probabilities estimated with local averaging.</p></a></li>
<li><a href='#CVD_Accidents'>
<p>Causes of death in three counties in Norway in 1974-2000</p></a></li>
<li><a href='#GAMprob'>
<p>Sampling probabilities estimated with generalized additive models.</p></a></li>
<li><a href='#GLMprob'>
<p>Sampling probabilities estimated with logistic regression.</p></a></li>
<li><a href='#KMprob'>
<p>Sampling probabilities estimated with a Kaplan-Meier type formula</p></a></li>
<li><a href='#ModelbasedVar'>
<p>Modelbased variance using Kaplan-Meier weights</p></a></li>
<li><a href='#multipleNCC-internal'>
<p>Internal function</p></a></li>
<li><a href='#multipleNCC-package'>
<p>Weighted partial likelihood for nested case-control data</p></a></li>
<li><a href='#pChen'>
<p>Chen-weights</p></a></li>
<li><a href='#pGAM'>
<p>Generlaized additive model weights</p></a></li>
<li><a href='#pGLM'>
<p>Logistic regression weights</p></a></li>
<li><a href='#pKM'>
<p>Kaplan-Meier weights</p></a></li>
<li><a href='#PoststratVar'>
<p>Modelbased variance using Chen-weights</p></a></li>
<li><a href='#print.wpl'>
<p>Print a wpl object</p></a></li>
<li><a href='#summary.wpl'>
<p>Summary method for wpl</p></a></li>
<li><a href='#wpl'>
<p>Weighted partial likelihood for nested case-control data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Weighted Cox-Regression for Nested Case-Control Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Nathalie C. Stoer, Sven Ove Samuelsen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nathalie C. Stoer &lt;nathalie.c.stoer@kreftregisteret.no&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit Cox proportional hazard models with a weighted 
  partial likelihood. It handles one or multiple endpoints, additional matching 
  and makes it possible to reuse controls for other endpoints 
  Stoer NC and Samuelsen SO (2016) &lt;<a href="https://doi.org/10.32614%2Frj-2016-030">doi:10.32614/rj-2016-030</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>survival, mgcv</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-12 14:28:20 UTC; nacst</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-12 20:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='Chenprob'>
Sampling probabilities estimated with local averaging.
</h2><span id='topic+Chenprob'></span>

<h3>Description</h3>

<p>Estimates sampling probabilities with local averaging (Chen, 2001). 
The weights included in the Cox-regressions (wpl) and which could be used for
other procedures are inverse sampling probabilities i.e. the inverse of these
probabilities. The probabilties are estimated for all subjects in the cohort.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Chenprob(survtime, samplestat, no.intervals = 10, left.time = 0, 
no.intervals.left = c(3,4))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Chenprob_+3A_survtime">survtime</code></td>
<td>

<p>Follow-up time for all cohort subjects
</p>
</td></tr>
<tr><td><code id="Chenprob_+3A_samplestat">samplestat</code></td>
<td>

<p>A vector containing sampling and status information: 0 represents non-sampled 
subjects in the cohort, 1: sampled controls, 2,3,... indicate different events. 
Cohort dimension. 
</p>
</td></tr>
<tr><td><code id="Chenprob_+3A_no.intervals">no.intervals</code></td>
<td>

<p>Number of intervals for censoring times for Chen-weights with only right 
censoring
</p>
</td></tr>
<tr><td><code id="Chenprob_+3A_left.time">left.time</code></td>
<td>

<p>Entry time if the survival times are left-truncated. Cohort dimension. 
</p>
</td></tr>
<tr><td><code id="Chenprob_+3A_no.intervals.left">no.intervals.left</code></td>
<td>

<p>Number of intervals for Chen-weights with left-truncation. A vector on the form 
[number of intervals for left truncated time, number of intervals for survival time].
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of cohort dimension of sampling probabilities. 
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>References</h3>

<p>Chen KN (2001) Generalized case-cohort sampling. J Roy Stat Soc Ser B 63(4):791-809 <br />
Stoer NC and Samuelsen SO (2012): Comparison of estimators in nested case-control 
studies with multiple outcomes. Lifetime Data Analysis, 18(3), 261-283.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>, <code><a href="survival.html#topic+coxph">coxph</a></code>, <code><a href="#topic+GAMprob">GAMprob</a></code>, <code><a href="#topic+GLMprob">GLMprob</a></code>, 
<code><a href="#topic+KMprob">KMprob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   

data(CVD_Accidents)
attach(CVD_Accidents)
Chenprob(agestop,samplestat,left.time=agestart)
Chenprob(agestop,samplestat,left.time=agestart,no.intervals.left=c(3,4))

function (survtime, samplestat, no.intervals, left.time = 0, no.intervals.left = 0) 
{
    n.cohort = length(survtime)
    status = rep(0, n.cohort)
    status[samplestat &gt; 1] = 1
    samplestat[samplestat &gt; 1] = 1
    ind.no = 1:length(samplestat)
    p = pChen(status, survtime, samplestat, ind.no, n.cohort, 
        no.intervals, left.time, no.intervals.left)
    p[status == 1] = 1
    p
  }
</code></pre>

<hr>
<h2 id='CVD_Accidents'>
Causes of death in three counties in Norway in 1974-2000
</h2><span id='topic+CVD_Accidents'></span>

<h3>Description</h3>

<p>Causes of death from 1974-2000 for all men and women participating in a 
cardiovascular health screening in 1974-1978 in three counties in Norway.
All variables are know for all cohort members and it is thus a synthetic 
nested case-control stidy. One control per case is sampled for cardiovascular 
disease cases and subjects who died from alcohol abuse, liver disease, and
accidents and violence. The controls are matched sex and BMI plus/minus 2 
in addition to being alive at the time the case died.                                 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CVD_Accidents)</code></pre>


<h3>Format</h3>

<p>A data frame with 3933 observations on the following 23 variables.
</p>

<dl>
<dt><code>agestart</code></dt><dd><p>Age at health survey, inclusion time</p>
</dd>
<dt><code>agestop</code></dt><dd><p>Age at censoring</p>
</dd>
<dt><code>dead</code></dt><dd><p>Indicator for death from any cause (0=censored, 1=dead)</p>
</dd>
<dt><code>dead1</code></dt><dd><p>Indicator for cancer death (0=censored or dead from 
other cause than cancer, 1=dead from cancer)</p>
</dd>
<dt><code>dead2</code></dt><dd><p>Indicator for death from cardiovascular disease, 
including sudden death (0=censored or dead from other causes than 
cardiovascular diseas, 1=dead from cardiovascular diseas)</p>
</dd>
<dt><code>dead3</code></dt><dd><p>Indicator for death from other medical causes 
(0=censored or dead from cancer, cardiovascular diseas, alcohol abuse, 
liver disease, violence or accidents, 1=dead from other medical causes)</p>
</dd>
<dt><code>dead4</code></dt><dd><p>Indicator for death from alcohol abuse, liver disease,
violence and accidents (0=censored or death from other medical causes than 
alcohol abuse, liver disase, violence or accidents, 1=death from alcohol
abuse, liver disease, violence and accidents)</p>
</dd>
<dt><code>sex</code></dt><dd><p>sex (1=male, 2=female)</p>
</dd>
<dt><code>county</code></dt><dd><p>county in Norway (5=Oppland, 14=Sogn og Fjordane, 
20=Finnmark)</p>
</dd>
<dt><code>sbp</code></dt><dd><p>Systolic blood pressure at health screening</p>
</dd>
<dt><code>bmi</code></dt><dd><p>Body mass index at helth screening</p>
</dd>
<dt><code>smkstart</code></dt><dd><p>Age started smoking</p>
</dd>
<dt><code>smkgr</code></dt><dd><p>Smoking group (1=never smoked, 2=former smoker, 3=1-9 
cigaretts per day, 4=10-19 cigaretts per day, 5=20+ cigaretts per day, 
6=pipe or cigar)</p>
</dd>
<dt><code>smoking3gr</code></dt><dd><p>Smoking 3 groups (1=never smoked, 2=former smoker, 
3=smoker)</p>
</dd>
<dt><code>samplestat</code></dt><dd><p>Indicator for sampling and events (0=non-sampled subjects
in the cohort, 1=sampled controls, 2=dead from cardiovascular disease, 3=dead 
from alcohol abuse, liver disease, violence or accidents</p>
</dd>
<dt><code>dead24</code></dt><dd><p>Indicator for death from either cardiovascular disease
or alcohol abuse, liver disease, violence or accidents (0=censored or dead 
from other causes than cardiovascular disease, alcohol abuse, liver disease,
violence or accidents, 1=death from cardiovascular disease, alcohol abuse, 
liver disease,violence or accidents)</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://folk.uio.no/borgan/abg-2008/data/data.html
</p>

<hr>
<h2 id='GAMprob'>
Sampling probabilities estimated with generalized additive models.
</h2><span id='topic+GAMprob'></span>

<h3>Description</h3>

<p>Estimates sampling probabilities with generalized additive models. 
The weights included in the Cox-regressions (wpl) and which could be used for
other procedures are inverse sampling probabilities i.e. the inverse of these
probabilities. The probabilties are estimated for all subjects in the cohort.
</p>
<p><code>survtime</code>, <code>left.time</code> and continuous matching variables will be 
smoothed on while categorical matching variables are taken as factors.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GAMprob(survtime, samplestat, left.time = 0, match.var = 0, match.int = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GAMprob_+3A_survtime">survtime</code></td>
<td>

<p>Follow-up time for all cohort subjects
</p>
</td></tr>
<tr><td><code id="GAMprob_+3A_samplestat">samplestat</code></td>
<td>

<p>A vector containing sampling and status information: 0 represents non-sampled 
subjects in the cohort, 1: sampled controls, 2,3,... indicate different events. 
Cohort dimension. 
</p>
</td></tr>
<tr><td><code id="GAMprob_+3A_left.time">left.time</code></td>
<td>

<p>Entry time if the survival times are left-truncated. Cohort dimension. 
</p>
</td></tr>
<tr><td><code id="GAMprob_+3A_match.var">match.var</code></td>
<td>

<p>If the controls are matched to the cases (on other variables than time), 
match.var is the vector of matching variables. Cohort dimension.
</p>
</td></tr>
<tr><td><code id="GAMprob_+3A_match.int">match.int</code></td>
<td>

<p>A vector of length 2*number of matching variables. For caliper matching 
(matched on value pluss/minus epsilon) match.int should consist of 
c(-epsilon,epsilon). For exact matching match.int should consist of c(0,0). 
</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>A vector of cohort dimension of sampling probabilities. 
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>References</h3>

<p>Stoer NC and Samuelsen SO (2013): Inverse probability weighting in nested case-control
studies with additional matching - a simulation study. Statistics in Medicine, 
32(30), 5328-5339.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>, <code><a href="survival.html#topic+coxph">coxph</a></code>, <code><a href="#topic+Chenprob">Chenprob</a></code>, <code><a href="#topic+GLMprob">GLMprob</a></code>, 
<code><a href="#topic+KMprob">KMprob</a></code>, <code><a href="mgcv.html#topic+gam">gam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CVD_Accidents)
attach(CVD_Accidents)
GAMprob(agestop,samplestat,agestart)
GAMprob(agestop,samplestat,agestop,match.var=cbind(sex,bmi),match.int=c(0,0,-2,2))

## The function is currently defined as
function (survtime, samplestat, left.time = 0, match.var = 0, match.int = 0) 
{
    n.cohort = length(survtime)
    status = rep(0, n.cohort)
    status[samplestat &gt; 1] = 1
    samplestat[samplestat &gt; 1] = 1
    pgam = pGAM(status, survtime, samplestat, n.cohort, left.time)
    p = rep(1, n.cohort)
    p[status == 0] = pgam
    p
  }
</code></pre>

<hr>
<h2 id='GLMprob'>
Sampling probabilities estimated with logistic regression.
</h2><span id='topic+GLMprob'></span>

<h3>Description</h3>

<p>Estimates sampling probabilities with logistic regression. 
The weights included in the Cox-regressions (wpl) and which could be used for
other procedures are inverse sampling probabilities i.e. the inverse of these
probabilities. The probabilties are estimated for all subjects in the cohort.
</p>
<p><code>survtime</code>, <code>left.time</code> and continuous matching variables are 
included in the logistic regression as continuous variables while 
categorical matching variables are taken as factors. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GLMprob(survtime, samplestat, left.time = 0, match.var = 0, match.int = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GLMprob_+3A_survtime">survtime</code></td>
<td>

<p>Follow-up time for all cohort subjects
</p>
</td></tr>
<tr><td><code id="GLMprob_+3A_samplestat">samplestat</code></td>
<td>

<p>A vector containing sampling and status information: 0 represents non-sampled 
subjects in the cohort, 1: sampled controls, 2,3,... indicate different events. 
Cohort dimension. 
</p>
</td></tr>
<tr><td><code id="GLMprob_+3A_left.time">left.time</code></td>
<td>

<p>Entry time if the survival times are left-truncated. Cohort dimension. 
</p>
</td></tr>
<tr><td><code id="GLMprob_+3A_match.var">match.var</code></td>
<td>

<p>If the controls are matched to the cases (on other variables than time), 
match.var is the vector of matching variables. Cohort dimension.
</p>
</td></tr>
<tr><td><code id="GLMprob_+3A_match.int">match.int</code></td>
<td>

<p>A vector of length 2*number of matching variables. For caliper matching 
(matched on value pluss/minus epsilon) match.int should consist of 
c(-epsilon,epsilon). For exact matching match.int should consist of c(0,0). 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of cohort dimension of sampling probabilities. 
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>References</h3>

<p>Stoer NC and Samuelsen SO (2013): Inverse probability weighting in nested case-control
studies with additional matching - a simulation study. Statistics in Medicine, 
32(30), 5328-5339.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>, <code><a href="survival.html#topic+coxph">coxph</a></code>, <code><a href="#topic+Chenprob">Chenprob</a></code>, <code><a href="#topic+GAMprob">GAMprob</a></code>, 
<code><a href="#topic+KMprob">KMprob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CVD_Accidents)
attach(CVD_Accidents)
GLMprob(agestop,samplestat,agestart)
GLMprob(agestop,samplestat,agestart,match.var=cbind(sex,bmi),match.int=c(0,0,-2,2))

## The function is currently defined as
function (survtime, samplestat, left.time = 0, match.var = 0, 
    match.int = 0) 
{
    n.cohort = length(survtime)
    status = rep(0, n.cohort)
    status[samplestat &gt; 1] = 1
    samplestat[samplestat &gt; 1] = 1
    pglm = pGLM(status, survtime, samplestat, n.cohort, left.time, 
        match.var, match.int)
    p = rep(1, n.cohort)
    p[status == 0] = pglm
    p
  }
</code></pre>

<hr>
<h2 id='KMprob'>
Sampling probabilities estimated with a Kaplan-Meier type formula
</h2><span id='topic+KMprob'></span>

<h3>Description</h3>

<p>Estimates sampling probabilities with a Kaplan-Meier type formula. 
The weights included in the Cox-regressions (wpl) and which could be used for
other procedures are inverse sampling probabilities i.e. the inverse of these
probabilities. The probabilties are estimated for all subjects in the cohort.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KMprob(survtime, samplestat, m, left.time = 0, match.var = 0, match.int = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KMprob_+3A_survtime">survtime</code></td>
<td>

<p>Follow-up time for all cohort subjects
</p>
</td></tr>
<tr><td><code id="KMprob_+3A_samplestat">samplestat</code></td>
<td>

<p>A vector containing sampling and status information: 0 represents non-sampled 
subjects in the cohort, 1: sampled controls, 2,3,... indicate different events. 
Cohort dimension. 
</p>
</td></tr>
<tr><td><code id="KMprob_+3A_m">m</code></td>
<td>

<p>Number of sampled controls. A scalar if equal number of controls for all case. 
If unequal number of controls per case: A vector of length number of cases. The 
vector must be in the same order as the cases in the samplestat-vector.
</p>
</td></tr>
<tr><td><code id="KMprob_+3A_left.time">left.time</code></td>
<td>

<p>Entry time if the survival times are left-truncated. Cohort dimension. 
</p>
</td></tr>
<tr><td><code id="KMprob_+3A_match.var">match.var</code></td>
<td>

<p>If the controls are matched to the cases (on other variables than time), 
match.var is the vector of matching variables. Cohort dimension.
</p>
</td></tr>
<tr><td><code id="KMprob_+3A_match.int">match.int</code></td>
<td>

<p>A vector of length 2*number of matching variables. For caliper matching 
(matched on value pluss/minus epsilon) match.int should consist of 
c(-epsilon,epsilon). For exact matching match.int should consist of c(0,0). 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of cohort dimension of sampling probabilities. 
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>References</h3>

<p>Samuelsen SO. A pseudolikelihood approach to analysis of nested case-control studies.
Biometrika, 84(2):379-394, 1997. <br />
Stoer NC and Samuelsen SO (2013): Inverse probability weighting in nested case-control
studies with additional matching - a simulation study. Statistics in Medicine, 
32(30), 5328-5339.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>, <code><a href="survival.html#topic+coxph">coxph</a></code>, <code><a href="#topic+Chenprob">Chenprob</a></code>, <code><a href="#topic+GLMprob">GLMprob</a></code>, 
<code><a href="#topic+GAMprob">GAMprob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CVD_Accidents)
attach(CVD_Accidents)
KMprob(agestop,samplestat,m=1,agestart)
KMprob(agestop,samplestat,m=1,agestart,match.var=cbind(bmi),match.int=c(-2,2))

## The function is currently defined as
function (survtime, samplestat, m,  left.time = 0, match.var = 0, match.int = 0) 
{
    n.cohort = length(survtime)
    status = rep(0, n.cohort)
    status[samplestat &gt; 1] = 1
    o = order(survtime)
    status = status[o]
    survtime = survtime[o]
    if (length(left.time) == n.cohort) {
        left.time = left.time[o]
    }
    if (length(match.var) == n.cohort) {
        match.var = match.var[o]
    }
    if (length(match.var) &gt; n.cohort) {
        match.var = match.var[o, ]
    }
    tilbakestill = (1:n.cohort)[o]
    p = pKM(status, survtime, m, n.cohort, left.time, match.var, 
        match.int)
    p[status &gt; 0] = 1
    p = p[order(tilbakestill)]
    p
  }
</code></pre>

<hr>
<h2 id='ModelbasedVar'>
Modelbased variance using Kaplan-Meier weights
</h2><span id='topic+ModelbasedVar'></span>

<h3>Description</h3>

<p>For internal use only
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer and Sven Ove Samuelsen
</p>

<hr>
<h2 id='multipleNCC-internal'>
Internal function
</h2><span id='topic+multipleNCC-internal'></span><span id='topic+wpl.default'></span><span id='topic+wpl.formula'></span><span id='topic+wplEst'></span>

<h3>Description</h3>

<p>Internal function
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>

<hr>
<h2 id='multipleNCC-package'>
Weighted partial likelihood for nested case-control data
</h2><span id='topic+multipleNCC-package'></span><span id='topic+multipleNCC'></span>

<h3>Description</h3>

<p>Fits Cox proportional hazards models with a weigthed partial likelihood. 
It handles competing risks (with one endpoint being a special situation). 
It uses cases and controls from other endpoints as additional controls for 
each endpoint. See <code><a href="#topic+wpl">wpl</a></code> for help. 
</p>
<p>Four weight estimators are implemented; Kaplan-Meier type <code><a href="#topic+KMprob">KMprob</a></code>,
GAM (<code><a href="#topic+GAMprob">GAMprob</a></code>), GLM (<code><a href="#topic+GLMprob">GLMprob</a></code>) and local averaging
(<code><a href="#topic+Chenprob">Chenprob</a></code>)
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> multipleNCC</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2-1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-04-16</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>
<p>Maintainer: &lt;nathalie.c.stoer@kreftregisteret.no&gt;
</p>


<h3>References</h3>

<p>Samuelsen, SO. (1997) A pseudolikelihood approach to analysis of nested case-control studies. <em>Biometrika</em> <b>84(2)</b>, 379-394 <br />
Samuelsen, SO., et al. (2007) Stratified case-cohort analysis of general cohort sampling designs. <em>Scand J Stat</em> <b>34(1)</b>, 103-119 <br />
Chen, KN. (2001) Generalized case-cohort sampling. <em>J Roy Stat Soc Ser B</em> <b>63(4)</b>, 791 - 809 <br />
Stoer NC and Samuelsen SO (2012): Comparison of estimators in nested case-control 
studies with multiple outcomes. Lifetime Data Analysis, 18(3), 261-283.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>, <code><a href="survival.html#topic+coxph">coxph</a></code>, <code><a href="#topic+Chenprob">Chenprob</a></code>, <code><a href="#topic+GLMprob">GLMprob</a></code>, <code><a href="#topic+GAMprob">GAMprob</a></code>, <code><a href="#topic+KMprob">KMprob</a></code>
</p>

<hr>
<h2 id='pChen'>
Chen-weights 
</h2><span id='topic+pChen'></span>

<h3>Description</h3>

<p>Estimates Chen-weights. For internal use only. Users should use the 
wrapper <code><a href="#topic+Chenprob">Chenprob</a></code>.
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>, <code><a href="#topic+Chenprob">Chenprob</a></code>
</p>

<hr>
<h2 id='pGAM'>
Generlaized additive model weights 
</h2><span id='topic+pGAM'></span>

<h3>Description</h3>

<p>Estimates GAM-weights. For internal use only. Users should use the 
wrapper <code><a href="#topic+GAMprob">GAMprob</a></code>.
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>, <code><a href="#topic+GAMprob">GAMprob</a></code>, <code><a href="mgcv.html#topic+gam">gam</a></code>
</p>

<hr>
<h2 id='pGLM'>
Logistic regression weights 
</h2><span id='topic+pGLM'></span>

<h3>Description</h3>

<p>Estimates GLM-weights. For internal use only. Users should use the 
wrapper <code><a href="#topic+GLMprob">GLMprob</a></code>.
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>, <code><a href="#topic+GLMprob">GLMprob</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>
</p>

<hr>
<h2 id='pKM'>
Kaplan-Meier weights 
</h2><span id='topic+pKM'></span>

<h3>Description</h3>

<p>Estimates Kaplan-Meier weights. For internal use only. Users should use the 
wrapper <code><a href="#topic+KMprob">KMprob</a></code>.
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>, <code><a href="#topic+KMprob">KMprob</a></code>
</p>

<hr>
<h2 id='PoststratVar'>
Modelbased variance using Chen-weights 
</h2><span id='topic+PoststratVar'></span>

<h3>Description</h3>

<p>For internal use only.
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer and Sven Ove Samuelsen
</p>

<hr>
<h2 id='print.wpl'>
Print a wpl object
</h2><span id='topic+print.wpl'></span>

<h3>Description</h3>

<p>Prints the fit of (each) weighted Cox-regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'wpl'
print(x,...)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.wpl_+3A_x">x</code></td>
<td>

<p>The result of a call to wpl
</p>
</td></tr>
<tr><td><code id="print.wpl_+3A_...">...</code></td>
<td>

<p>For future methods
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>
</p>

<hr>
<h2 id='summary.wpl'>
Summary method for wpl
</h2><span id='topic+summary.wpl'></span>

<h3>Description</h3>

<p>produces a summary of a fitted wpl object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'wpl'
summary(object,...)  
  </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.wpl_+3A_object">object</code></td>
<td>

<p>the result of a wpl fit
</p>
</td></tr>
<tr><td><code id="summary.wpl_+3A_...">...</code></td>
<td>

<p>for future methods
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wpl">wpl</a></code>
</p>

<hr>
<h2 id='wpl'>
Weighted partial likelihood for nested case-control data 
</h2><span id='topic+wpl'></span>

<h3>Description</h3>

<p>Fits Cox proportional hazards models for nested case-control data 
with a weigthed partial likelihood. Matching between cases and 
controls is broken which enables the controls to be reused for other endpoints. It 
handles competing risks (with simple survival data with one endpoint being a
special case) and cases and controls from one endpoint are being used as 
additional controls for another endpoint. There are four choices of weights; 
Samuelsen (1997) <code>KM</code>, estimated with logistic regression (<code>glm</code>), logistic 
genralized additive model (<code>gam</code>) and local averaging (Chen, 2001) 
<code>(Chen)</code>. <code>KM</code>, <code>glm</code> and <code>gam</code> handle additional matching,
while all of them handle left-truncation. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  
wpl(x, data, samplestat, m = 1, weight.method = "KM", no.intervals = 10, 
variance = "robust", no.intervals.left = c(3, 4), match.var = 0, match.int = 0)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wpl_+3A_x">x</code></td>
<td>

<p>A formula object, with the response on the left of a ~ operator, and the terms 
on the right. The response must be a survival object as returned by the Surv 
function. The status variable going in to Surv is not actually used but should 
have 1 for cases and zero for controls and non-sampled subjetcs. All elements 
going into the formula should have lenght equal to the number of subjects in the
cohort. Generally some of the covariates are not known for all subjects in the 
cohort (due to the NCC-sampling). The covariate values for those subjects should 
just be given some value e.g. 0 (not NA). Which value choosen is not important 
as the values are never used. 
</p>
</td></tr>
<tr><td><code id="wpl_+3A_data">data</code></td>
<td>

<p>data.frame in which to interpret the variables named in the formula.
</p>
</td></tr>
<tr><td><code id="wpl_+3A_samplestat">samplestat</code></td>
<td>

<p>A vector containing sampling and status information: 0 represents non-sampled 
subjects in the cohort, 1: sampled controls, 2,3,... indicate different events. 
Cohort dimension. 
</p>
</td></tr>
<tr><td><code id="wpl_+3A_m">m</code></td>
<td>

<p>Number of sampled controls. A scalar if equal number of controls for all cases. 
If unequal number of controls per case: A vector of length number of cases. The 
vector must be in the same order as the cases in the samplestat-vector.
</p>
</td></tr>
<tr><td><code id="wpl_+3A_weight.method">weight.method</code></td>
<td>

<p>Which weigths should be used, possibilities <code>"KM"</code>, <code>"gam"</code>, 
<code>"glm"</code>, <code>"Chen"</code>
</p>
</td></tr>
<tr><td><code id="wpl_+3A_no.intervals">no.intervals</code></td>
<td>

<p>Number of intervals for censoring times for Chen-weights with only right 
censoring
</p>
</td></tr>
<tr><td><code id="wpl_+3A_variance">variance</code></td>
<td>

<p>Default is robust variances, but model based variance (only for KM-weights), 
<code>"Modelbased"</code> and variance based on stratified case-cohort 
<code>"Poststrat"</code> (only for Chen-weights) is also possible. 
<code>Pseudo</code>-variance and <code>Strat</code>-variance will appear under 
&quot;est.se(coef)&quot; in the output.
</p>
</td></tr>
<tr><td><code id="wpl_+3A_no.intervals.left">no.intervals.left</code></td>
<td>

<p>Number of intervals for Chen-weights with left-truncation. A vector on the form 
[number of intervals for left truncated time, number of intervals for survival time].
</p>
</td></tr>
<tr><td><code id="wpl_+3A_match.var">match.var</code></td>
<td>

<p>If the controls are matched to the cases (on other variables than time), 
match.var is the vector or matrix of matching variables. Cohort dimension.
</p>
</td></tr>
<tr><td><code id="wpl_+3A_match.int">match.int</code></td>
<td>

<p>A vector of length 2*number of matching variables. For caliper matching 
(matched on value pluss/minus epsilon) match.int should consist of 
c(-epsilon,epsilon). For exact matching match.int should consist of c(0,0). 
</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>An object of class wpl representing the fit. Objects of this class have methods 
for the functions <code>print</code> and <code>summary</code>.
The wpl-object consists of the following elements which are repeated for each 
endpoint. Unfortunately only the values for the first endpoint can be reached 
by $-operator(ex. fit$coefficients only return the coefficients for the first 
endpoint)

</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>The vector of coefficients.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>Robust or estimated variance</p>
</td></tr>
<tr><td><code>weighted.loglik</code></td>
<td>
<p>A vector of length 2 containing the log-likelihood with 
the initial values and with the final values of the coefficients.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations used</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>The vector of linear predictors, one per subject. 
Note that this vector has been centered, see predict.coxph for more details</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>The martingale residuals</p>
</td></tr>
<tr><td><code>means</code></td>
<td>
<p>Vector of column means of the X matrix</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The computation method used</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The number of observations used in the fit</p>
</td></tr>
<tr><td><code>nevent</code></td>
<td>
<p>The number of events (usually deaths) used in the fit</p>
</td></tr>
<tr><td><code>naive.var</code></td>
<td>
<p>naive.var</p>
</td></tr>
<tr><td><code>rscore</code></td>
<td>
<p>The robust log-rank statistic</p>
</td></tr>
<tr><td><code>wald.test</code></td>
<td>
<p>The Wald test of whether the final coefficients differ from 
the initial values</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Inclusion time and event/censoring time</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>The vector of weights, which are inverse sampling probabilities</p>
</td></tr>
<tr><td><code>est.var</code></td>
<td>
<p>Estimated variance (T) or robust variance (F)</p>
</td></tr>
</table>
<p>.<br />
.<br />
.<br />
</p>


<h3>Author(s)</h3>

<p>Nathalie C. Stoer
</p>


<h3>References</h3>

<p>Samuelsen SO. A pseudolikelihood approach to analysis of nested case-control studies.
Biometrika, 84(2):379-394, 1997. <br />
Stoer NC and Samuelsen SO (2013): Inverse probability weighting in nested case-control
studies with additional matching - a simulation study. Statistics in Medicine, 
32(30), 5328-5339.
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>, <code><a href="#topic+Chenprob">Chenprob</a></code>, <code><a href="#topic+GLMprob">GLMprob</a></code>, <code><a href="#topic+GAMprob">GAMprob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CVD_Accidents)
wpl(Surv(agestart,agestop,dead24)~factor(smoking3gr)+bmi+factor(sex),data=CVD_Accidents,
samplestat=CVD_Accidents$samplestat,weight.method="gam")

wpl(Surv(agestart,agestop,dead24)~factor(smoking3gr)+bmi+factor(sex),data=CVD_Accidents,
samplestat=CVD_Accidents$samplestat,m=1,match.var=cbind(CVD_Accidents$sex,
CVD_Accidents$bmi),match.int=c(0,0,-2,2),weight.method="glm")


## The function is currently defined as
function (x, data, samplestat, m = 1, weight.method = "KM", no.intervals = 10, 
    variance = "robust", no.intervals.left = c(3, 4), match.var = 0, 
    match.int = 0) 
{
    UseMethod("wpl")
  }
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
