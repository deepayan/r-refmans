<!DOCTYPE html><html><head><title>Help for package LS2Wstat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LS2Wstat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#LS2Wstat-package'>
<p>Stationarity testing for locally stationary wavelet fields</p></a></li>
<li><a href='#avespecvar'>
<p>A test statistic for spatial stationarity.</p></a></li>
<li><a href='#compareImages'><p>Assesses whether two textured images are the same texture.</p></a></li>
<li><a href='#countTextures'><p>countTextures</p></a></li>
<li><a href='#cropimage'>
<p>Crops a rectangular image to a specified (square) dimension</p></a></li>
<li><a href='#getpval'>
<p>Computes a p-value for the output of the test for stationarity.</p></a></li>
<li><a href='#imageQT'>
<p>Performs an image quadtree decomposition.</p></a></li>
<li><a href='#lincurve'>
<p>A linear function between two constant values.</p></a></li>
<li><a href='#mix2images'>
<p>Insert one image into another.</p></a></li>
<li><a href='#plot.imageQT'>
<p>A plot function for quadtree decompositions.</p></a></li>
<li><a href='#plotmtx'>
<p>Image manipulation</p></a></li>
<li><a href='#print.imageQT'><p>Print out information about a imageQT object in readable form.</p></a></li>
<li><a href='#print.TOS2D'><p>Print out information about a TOS2D object in readable form.</p></a></li>
<li><a href='#scurve'>
<p>An S curve function between two constant values.</p></a></li>
<li><a href='#simTexture'>
<p>simTextureulation function for LS2W processes.</p></a></li>
<li><a href='#TOS2D'>
<p>Perform bootstrap stationarity test for images.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Multiscale Test of Spatial Stationarity for LS2W Processes</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1-5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-20</td>
</tr>
<tr>
<td>Depends:</td>
<td>LS2W(&ge; 1.3-1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>matrixStats, spdep</td>
</tr>
<tr>
<td>Description:</td>
<td>Wavelet-based methods for testing stationarity and quadtree segmenting of images, see Taylor et al (2014) &lt;<a href="https://doi.org/10.1080%2F00401706.2013.823890">doi:10.1080/00401706.2013.823890</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Author:</td>
<td>Sarah Taylor [aut],
  Matt Nunes [aut, cre],
  Idris Eckley [ctb, ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matt Nunes &lt;nunesrpackages@gmail.com&gt;</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-17 08:20:54 UTC; matt</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-17 08:52:36 UTC</td>
</tr>
</table>
<hr>
<h2 id='LS2Wstat-package'>
Stationarity testing for locally stationary wavelet fields
</h2><span id='topic+LS2Wstat-package'></span><span id='topic+LS2Wstat'></span>

<h3>Description</h3>

<p>This package contains functions for testing for stationarity within images, specifically locally stationary wavelet (LS2W) fields. In addition the package contains functions for implementing quadtree image decompositions, as well as code for simulating LS2W processes for a given spectral structure.
</p>


<h3>Author(s)</h3>

<p>Sarah L. Taylor and Matt Nunes
</p>
<p>Maintainer: Matthew Nunes &lt;nunesrpackages@gmail.com&gt;
</p>


<h3>References</h3>

<p>For details on testing LS2W fields for stationarity, see
</p>
<p>Taylor, S.L., Eckley, I.A., and Nunes, M.A. (2014) A Test of Stationarity for Textured Images. <em>Technometrics</em>, <b>56</b> (3), 291-301.<br />
</p>
<p>For further information on LS2W processes, see
</p>
<p>Eckley, I.A., Nason, G.P., and Treloar, R.L. (2010) Locally stationary wavelet fields with application to the modelling and analysis of image texture <em>Journal of the Royal Statistical Society Series C</em>, <b>59</b>, 595-616.
</p>

<hr>
<h2 id='avespecvar'>
A test statistic for spatial stationarity.
</h2><span id='topic+avespecvar'></span>

<h3>Description</h3>

<p>Calculates a test statistic for a test of stationarity based on the local wavelet spectrum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>avespecvar(spectrum)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="avespecvar_+3A_spectrum">spectrum</code></td>
<td>

<p>A local wavelet spectrum estimate, i.e. a <code>cddews</code> object.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic given by Taylor et al. (2014) for a test for stationarity is computed for use in the boostrap testing procedure (<code><a href="#topic+TOS2D">TOS2D</a></code>). 
</p>


<h3>Value</h3>

<table>
<tr><td><code>statistic</code></td>
<td>
<p>The value of the test statistic for the given spectrum.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah L. Taylor                         
</p>


<h3>References</h3>

<p>Taylor, S.L., Eckley, I.A., and Nunes, M.A. (2014) A Test of Stationarity for Textured Images. <em>Technometrics</em>, <b>56</b> (3), 291-301.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TOS2D">TOS2D</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Generate a cddews object
#
X &lt;- Haar2MA.diag(64)

testspec&lt;-cddews(X,smooth=FALSE)

#Find the value of the test statistic
#
avespecvar(testspec)
#
</code></pre>

<hr>
<h2 id='compareImages'>Assesses whether two textured images are the same texture. </h2><span id='topic+compareImages'></span>

<h3>Description</h3>

<p>The function combines two images together, and then tests the montage for stationarity.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>compareImages(Im1, Im2, testsize = min(nrow(Im1), nrow(Im2)), alpha=0.05,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compareImages_+3A_im1">Im1</code></td>
<td>
<p>The first image to be compared.</p>
</td></tr>
<tr><td><code id="compareImages_+3A_im2">Im2</code></td>
<td>
<p>The second image to be compared.</p>
</td></tr>
<tr><td><code id="compareImages_+3A_testsize">testsize</code></td>
<td>
<p>The size of the combined image montage to be tested for stationarity.</p>
</td></tr>
<tr><td><code id="compareImages_+3A_alpha">alpha</code></td>
<td>
<p>The significance of the stationarity test.</p>
</td></tr>
<tr><td><code id="compareImages_+3A_...">...</code></td>
<td>
<p>Any other optional arguments to <code>TOS2D</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An image <em>montage</em> of two images is created, and the homogeneity measure <code>TOS2D</code> is used in combination with <code>getpval</code> to assess stationarity of the montage.  If the image is assessed as stationary, the two images are considered as the same texture. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>montageres</code></td>
<td>
<p>A boolean value indicating whether the montage of <code>Im1</code> and <code>Im2</code> is stationary.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah L. Taylor and Matt Nunes 
</p>


<h3>References</h3>

<p>Taylor, S.L., Eckley, I.A., and Nunes, M.A. (2014) A Test of Stationarity for Textured Images. <em>Technometrics</em>, <b>56</b> (3), 291-301.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TOS2D">TOS2D</a></code>, <code><a href="#topic+countTextures">countTextures</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# create two images to be compared:
X1&lt;-simTexture(32,K=1,imtype="S1")[[1]]
X2&lt;-simTexture(32,K=1,imtype="S1", sd=1.6)[[1]]
                             
# use the test to compare them:

test&lt;-compareImages(X1,X2,nsamples=100, smooth=FALSE)

</code></pre>

<hr>
<h2 id='countTextures'>countTextures</h2><span id='topic+countTextures'></span>

<h3>Description</h3>

<p>Groups a list of (stationary) images into texture classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	countTextures(Imgs, medpol = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="countTextures_+3A_imgs">Imgs</code></td>
<td>
<p>A list of images to classify into textures.</p>
</td></tr>
<tr><td><code id="countTextures_+3A_medpol">medpol</code></td>
<td>
<p>A boolean value indicating whether to zero mean the images (with Tukey's median polish) prior to classification.</p>
</td></tr>
<tr><td><code id="countTextures_+3A_...">...</code></td>
<td>
<p>Any other optional arguments to the classification function <code>compareImages</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The procedure recursively uses the function <code>compareImages</code> to decide whether two images are of the same texture or not.  More specifically, the first image is sequentially tested with all others in the list, assigning the images the label &quot;1&quot; if assessed as the same texture as the first image.  All other (unclassified) images are then similarly compared with candidates from different texture classes, until all images have been assigned a group label.  Testing recursively in this way, there are at most <code>choose(length(Imgs),2)</code> comparisons performed, but in reality the number could be a lot fewer.</p>


<h3>Value</h3>

<table>
<tr><td><code>Iclass</code></td>
<td>
<p>A vector (of length <code>length(Imgs)</code>) of texture labels corresponding to each image in <code>Imgs</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah L. Taylor and Matt Nunes 
</p>


<h3>References</h3>

<p>Taylor, S.L., Eckley, I.A., and Nunes, M.A. (2014) A Test of Stationarity for Textured Images. <em>Technometrics</em>, <b>56</b> (3), 291-301.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compareImages">compareImages</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
 X1&lt;-simTexture(128,K=1,imtype="S1")[[1]]
 X2&lt;-simTexture(128,K=1,imtype="S1")[[1]]
 X3&lt;-simTexture(128,K=1,imtype="S1",sd=1.6)[[1]]

 Xlist&lt;-list(X1,X2,X3)

 Xlist.class&lt;-countTextures(Xlist, bs=100)

## End(Not run)

</code></pre>

<hr>
<h2 id='cropimage'>
Crops a rectangular image to a specified (square) dimension 
</h2><span id='topic+cropimage'></span>

<h3>Description</h3>

<p>If the input image is not of dimension <code class="reqn">2^n \times 2^n</code>, for some <em>n</em>, then the image is cropped to an optionally specified size.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cropimage(image, newsize = NULL, pos = "e")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cropimage_+3A_image">image</code></td>
<td>
<p>The image you wish to crop.</p>
</td></tr>
<tr><td><code id="cropimage_+3A_newsize">newsize</code></td>
<td>
<p>An optional dimension (smaller than the original image dimension), to which the image should be cropped.</p>
</td></tr>
<tr><td><code id="cropimage_+3A_pos">pos</code></td>
<td>
<p>The position of the subimage to take when cropping an image. See the documentation for <code><a href="#topic+mix2images">mix2images</a></code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As we often wish to work with images whose dimensions are some power of 2, this function will determine whether the image is of an appropriate size and if not it will crop the image so that it is. The optional <code>pos</code> argument specifies the position of the cropped subimage to be returned; for example <code>pos="e"</code> specifies the central region.  See <code><a href="#topic+mix2images">mix2images</a></code> for more details on the positioning argument.
</p>


<h3>Value</h3>

<table>
<tr><td><code>subim</code></td>
<td>
<p>A square image with dimension <code class="reqn">2^n \times 2^n</code>, where <code>n</code> is either <code>newsize</code> or the largest feasible dyadic power smaller than the original image dimensions.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Matt Nunes
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mix2images">mix2images</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
#Create an image with dimensions not a power of two
#
testimage &lt;- matrix(rnorm(300^2),nrow=300,ncol=300)
#
#Crop the image
#
Newimage &lt;- cropimage(testimage)
#
# Check new dimension size.
#
dim(Newimage)
#        
</code></pre>

<hr>
<h2 id='getpval'>
Computes a p-value for the output of the test for stationarity.
</h2><span id='topic+getpval'></span>

<h3>Description</h3>

<p>Computes and returns a p-value from the output of the bootstrap test for stationarity. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getpval(statvec, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getpval_+3A_statvec">statvec</code></td>
<td>

<p>A vector of test statistics, such as that given by <code><a href="#topic+TOS2D">TOS2D</a></code>. The first value must be the value of the test statistic for the original image.
</p>
</td></tr>
<tr><td><code id="getpval_+3A_verbose">verbose</code></td>
<td>

<p>If TRUE then the p-value is printed and a sentance declaring &quot;stationary&quot; or &quot;not stationary&quot; is printed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>p</code></td>
<td>
<p>The p-value of the test.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah L. Taylor
</p>


<h3>References</h3>

<p>Taylor, S.L., Eckley, I.A., and Nunes, M.A. (2014) A Test of Stationarity for Textured Images. <em>Technometrics</em>, <b>56</b> (3), 291-301.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TOS2D">TOS2D</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Generate a stationary image

testimage &lt;- matrix(rnorm(64*64), nrow=64, ncol=64)

# Run test of stationarity

## Not run: TestofStat&lt;-TOS2D(testimage)

# Obtain p-value

getpval(TestofStat$samples)

## End(Not run)

</code></pre>

<hr>
<h2 id='imageQT'>
Performs an image quadtree decomposition.
</h2><span id='topic+imageQT'></span>

<h3>Description</h3>

<p>The quadtree decomposition is achieved by recursively splitting subimages into regions of stationarity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imageQT(image, test = TOS2D, minsize = 64,alpha=0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="imageQT_+3A_image">image</code></td>
<td>
<p>An image to be decomposed.</p>
</td></tr>
<tr><td><code id="imageQT_+3A_test">test</code></td>
<td>
<p>A function for assessing regions of spatial homogeneity, for example <br /> <code>TOS2D</code>.</p>
</td></tr>
<tr><td><code id="imageQT_+3A_minsize">minsize</code></td>
<td>
<p>The smallest region to test for homogeneity.</p>
</td></tr>
<tr><td><code id="imageQT_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for the homogeneity test <code>test</code>.</p>
</td></tr>
<tr><td><code id="imageQT_+3A_...">...</code></td>
<td>
<p>Any other (optional) arguments to <code>TOS2D</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function works by assessing an image for homogeneity.  If it is not homogeneous, the image is split into its four subquadrants.  Each of these is then tested for homogeneity.  The heterogeneous subimages are then again subdivided and tested again.  This procedure is repeated until either all subimages are deemed stationary or the minimum testing size <code>minsize</code> is reached.
</p>


<h3>Value</h3>

<p>An object of class <code>imageQT</code> with the following components:
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>The image analysed.</p>
</td></tr>
<tr><td><code>indl</code></td>
<td>
<p>The index representation of the nonstationary images in the quadtree decomposition.</p>
</td></tr>  
<tr><td><code>resl</code></td>
<td>
<p>The results of the stationarity testing (from <code>binfun</code>) during the quadtree decomposition. The results giving 0 match those contained in the <code>indl</code> component and the results giving 1 match those contained in the <code>indS</code> component.</p>
</td></tr>
<tr><td><code>imsize</code></td>
<td>
<p>The original image dimension.</p>
</td></tr>
<tr><td><code>imS</code></td>
<td>
<p>The stationary subimages in the quadtree decomposition.</p>
</td></tr>
<tr><td><code>indS</code></td>
<td>
<p>The index representation of the stationary images in the quadtree decomposition.</p>
</td></tr>
<tr><td><code>minsize</code></td>
<td>
<p>The minimum testing region used during the quadtree decomposition.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah L. Taylor and Matt Nunes
</p>


<h3>References</h3>

<p>Sonka, M., Boyle, R., and Hlavic, V. (1999) Image processing, analysis and machine vision. 2nd Edition, PWS Publishing.<br />
Taylor, S.L., Eckley, I.A., and Nunes, M.A. (2014) A Test of Stationarity for Textured Images. <em>Technometrics</em>, <b>56</b> (3), 291-301.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.imageQT">plot.imageQT</a></code>, <code><a href="#topic+TOS2D">TOS2D</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate an image:
X&lt;-simTexture(128,K=1,imtype="NS1", sd = 3)[[1]]

## Not run: XQT&lt;-imageQT(X,binfun=TOS2D.bin)

</code></pre>

<hr>
<h2 id='lincurve'>
A linear function between two constant values.
</h2><span id='topic+lincurve'></span>

<h3>Description</h3>

<p>A function with which to generate nonstationary covariance structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lincurve(x, start = 1, end = 2, a = 0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lincurve_+3A_x">x</code></td>
<td>
<p>a sequence of x-values.</p>
</td></tr>
<tr><td><code id="lincurve_+3A_start">start</code></td>
<td>
<p>a starting value for the linear function.</p>
</td></tr>
<tr><td><code id="lincurve_+3A_end">end</code></td>
<td>
<p>an ending value for the linear function.</p>
</td></tr>
<tr><td><code id="lincurve_+3A_a">a</code></td>
<td>
<p>a proportion of the x-values for the linear part of the function.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>the y-values associated to the linear function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Nunes
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scurve">scurve</a></code>,
<code><a href="#topic+simTexture">simTexture</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x&lt;-seq(0,1,length=128)

y&lt;-lincurve(x,start=1,end=2,a=.25)

plot(x,y,type="l")

</code></pre>

<hr>
<h2 id='mix2images'>
Insert one image into another.
</h2><span id='topic+mix2images'></span>

<h3>Description</h3>

<p>Image A is re-sized to a specified proportion of Image B, then inserted into Image B at a given position. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix2images(imageA, imageB, prop = 0.25, pos = "e")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix2images_+3A_imagea">imageA</code></td>
<td>

<p>The first image which is resized and placed inside the second image.
</p>
</td></tr>
<tr><td><code id="mix2images_+3A_imageb">imageB</code></td>
<td>

<p>The second image, into which the first is placed.
</p>
</td></tr>
<tr><td><code id="mix2images_+3A_prop">prop</code></td>
<td>

<p>The proportion of Image B to be taken up by Image A.
</p>
</td></tr>
<tr><td><code id="mix2images_+3A_pos">pos</code></td>
<td>

<p>The exact position of image A in image B. Possible options are &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot; which corresponds to (a) top-right, (b) bottom-right, (c) top-left, (d) bottom-left and (e) centred. A more exact location may be specified by inputting <code>pos=c(x,y)</code>, which represents the position in pixels from the top-left of the image (i.e. <code>c(x,y)</code> puts Image A <code>x</code> pixels down and <code>y</code> pixels across from the top-left corner of Image B.) 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function first of all crops Image A to be a given proportion of Image B and then inserts it into image B at the specified location. If image B is too small for the size of image A required then the whole of image A is placed in image B. Both must be dyadic in length and square images.
</p>


<h3>Value</h3>

<table>
<tr><td><code>ImageB</code></td>
<td>
<p>A matrix with the specified values selected exchanged to those of Image A.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Sarah L. Taylor
</p>


<h3>References</h3>

<p>Taylor, S.L., Eckley, I.A., and Nunes, M.A. (2014) A Test of Stationarity for Textured Images. <em>Technometrics</em>, <b>56</b> (3), 291-301.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate 2 images.
#
ImageA &lt;- matrix(rnorm(256^2), nrow=256, ncol=256)
ImageB &lt;- matrix(rnorm(256^2, sd=2.8), nrow=256, ncol=256)
#
# Insert Image A into Image B at a proportion of 0.25
#
MixImaImb &lt;- mix2images(ImageA, ImageB, prop=0.25, pos="e")
#
</code></pre>

<hr>
<h2 id='plot.imageQT'>
A plot function for quadtree decompositions.
</h2><span id='topic+plot.imageQT'></span>

<h3>Description</h3>

<p>A plot function for quadtree decompositions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'imageQT'
plot(x, cires, unclassval = 0, class = FALSE, QT = TRUE, 
		return = FALSE, qtl = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.imageQT_+3A_x">x</code></td>
<td>
<p>A quadtree decomposition object, such as output from <code>imageQT</code>.</p>
</td></tr>
<tr><td><code id="plot.imageQT_+3A_cires">cires</code></td>
<td>
<p>Results of <code>countTextures</code> for the classification of subimages produced by the quadtree decomposition.</p>
</td></tr>
<tr><td><code id="plot.imageQT_+3A_unclassval">unclassval</code></td>
<td>
<p>A value for unclassified values in a quadtree decomposition.</p>
</td></tr>
<tr><td><code id="plot.imageQT_+3A_class">class</code></td>
<td>
<p>A boolean value indicating whether to plot the results from <code>countTextures</code>.</p>
</td></tr>
<tr><td><code id="plot.imageQT_+3A_qt">QT</code></td>
<td>
<p>A boolean value indicating whether to plot the quadtree decomposition.</p>
</td></tr>
<tr><td><code id="plot.imageQT_+3A_return">return</code></td>
<td>
<p>A boolean value indicating whether to return the matrix associated to the plotted image.</p>
</td></tr>
<tr><td><code id="plot.imageQT_+3A_qtl">qtl</code></td>
<td>
<p>Colour specification for the lines drawn in the image segmentation (for <code>QT=TRUE</code>).</p>
</td></tr>
<tr><td><code id="plot.imageQT_+3A_...">...</code></td>
<td>
<p>Any other optional arguments to <code><a href="graphics.html#topic+image">image</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots the chosen quadtree decomposition, and optionally the textured region classification output from <code>countTextures</code>.  If the classification output is plotted (<code>class=TRUE</code>), each textured region is uniquely coloured according to its texture group.</p>


<h3>Value</h3>

<table>
<tr><td><code>immat</code></td>
<td>
<p>the matrix associated to the plotted image.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah L. Taylor and Matt Nunes
</p>


<h3>See Also</h3>

<p><code><a href="#topic+imageQT">imageQT</a></code>, <code><a href="#topic+countTextures">countTextures</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

X&lt;-simTexture(256,K=1,imtype="NS2")[[1]]

XQT&lt;-imageQT(X, bs=100, smooth=FALSE)

XCI &lt;- Tex(XQT$imS, bs=100, smooth=FALSE)

plot(XQT, XCI, QT=T, class=T)

## End(Not run)

</code></pre>

<hr>
<h2 id='plotmtx'>
Image manipulation
</h2><span id='topic+plotmtx'></span>

<h3>Description</h3>

<p>A function which rearranges image content for nice plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotmtx(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotmtx_+3A_m">m</code></td>
<td>
<p>An image (matrix) for converting so that it can be plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to the input and plotting output of the R base function <code><a href="graphics.html#topic+image">image</a></code>, this function reorders the pixels within an image such that, when used, the <code><a href="graphics.html#topic+image">image</a></code> function produces a plot of a image (matrix) &quot;as is&quot;.</p>


<h3>Value</h3>

<table>
<tr><td><code>m.out</code></td>
<td>
<p>The manipulated image corresponding to the input image.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Matt Nunes
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+image">image</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Im&lt;-simTexture(n=256,type="NS4",K=1)[[1]]

image(plotmtx(Im))

</code></pre>

<hr>
<h2 id='print.imageQT'>Print out information about a imageQT object in readable form.</h2><span id='topic+print.imageQT'></span>

<h3>Description</h3>

<p>This function prints out information about a imageQT object in a nice human-readable form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'imageQT'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.imageQT_+3A_x">x</code></td>
<td>
<p>An object of class 'imageQT' about which you wish to print information.</p>
</td></tr>
<tr><td><code id="print.imageQT_+3A_...">...</code></td>
<td>
<p>This argument actually does nothing in this function!</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Nunes</p>


<h3>See Also</h3>

 <p><code><a href="#topic+imageQT">imageQT</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#
# Generate a imageQT object for a HaarMontage realisation 
#
X&lt;-simTexture(n=256,K=1,imtype="S1")[[1]]

Xres &lt;- imageQT(X)

print(Xres)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.TOS2D'>Print out information about a TOS2D object in readable form.</h2><span id='topic+print.TOS2D'></span><span id='topic+summary.TOS2D'></span>

<h3>Description</h3>

<p>This function prints out information about a TOS2D object in a nice human-readable form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TOS2D'
print(x, ...)
## S3 method for class 'TOS2D'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.TOS2D_+3A_x">x</code>, <code id="print.TOS2D_+3A_object">object</code></td>
<td>
<p>An object of class 'TOS2D' about which you wish to print information.</p>
</td></tr>
<tr><td><code id="print.TOS2D_+3A_...">...</code></td>
<td>
<p>This argument actually does nothing in this function!</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Nunes</p>


<h3>See Also</h3>

 <p><code><a href="#topic+TOS2D">TOS2D</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#
# Generate a TOS2D object for a HaarMontage realisation 
#
X&lt;-simTexture(n=256,K=1,imtype="S1")[[1]]

Xres &lt;- TOS2D(X)

summary(Xres)

## End(Not run)
</code></pre>

<hr>
<h2 id='scurve'>
An S curve function between two constant values.
</h2><span id='topic+scurve'></span>

<h3>Description</h3>

<p>A function with which to generate nonstationary covariance structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scurve(x, a = 1, start = 1, end = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scurve_+3A_x">x</code></td>
<td>
<p>a sequence of x-values.</p>
</td></tr>
<tr><td><code id="scurve_+3A_a">a</code></td>
<td>
<p>The coefficient of slope of the curve.</p>
</td></tr>
<tr><td><code id="scurve_+3A_start">start</code></td>
<td>
<p>a starting value for the curve</p>
</td></tr>
<tr><td><code id="scurve_+3A_end">end</code></td>
<td>
<p>an ending value for the curve</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>the function values associated to <code>x</code> depicting an S-curve.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Nunes
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lincurve">lincurve</a></code>, <code><a href="#topic+simTexture">simTexture</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x&lt;-seq(0,1,length=100)

y&lt;-scurve(x,.4,1,2)

plot(x,y,type="l")

</code></pre>

<hr>
<h2 id='simTexture'>
simTextureulation function for LS2W processes.
</h2><span id='topic+simTexture'></span>

<h3>Description</h3>

<p>This function will generate images of a specified type 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simTexture(n = 256, sd = 1, K = 150, imtype = "S1", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simTexture_+3A_n">n</code></td>
<td>

<p>The dimension of the image to be generated.
</p>
</td></tr>
<tr><td><code id="simTexture_+3A_sd">sd</code></td>
<td>

<p>The standard deviation of the increments of the LS2W process to be generated.
</p>
</td></tr>
<tr><td><code id="simTexture_+3A_k">K</code></td>
<td>

<p>The number of images to generate.
</p>
</td></tr>
<tr><td><code id="simTexture_+3A_imtype">imtype</code></td>
<td>

<p>The type of image(s) to create.  Must be one of &quot;S1&quot;,&quot;S2&quot;,&quot;S3&quot;,&quot;S4&quot;, &quot;NS1&quot;,&quot;NS2&quot;,
&quot;NS3&quot;, &quot;NS4&quot;,&quot;NS5&quot;,&quot;NS6&quot;, &quot;NS7&quot;.  See details for descriptions of the processes.
</p>
</td></tr>
<tr><td><code id="simTexture_+3A_...">...</code></td>
<td>

<p>Any other optional arguments needed for the image generation (see details).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several different processes can be generated with the <code>simTexture</code> function.   The stationary processes are: a random normal process of specified standard deviation, <code>sd</code> (<code>S1</code>); a spatial moving average process with parameter <code>rho</code> (<code>S2</code>); an isotropic random field with a Matern covariance with shape parameter <code>nu</code> (<code>S3</code>) and a <em>diagonal Haar moving average</em> process of a specified order <code>order</code> and standard deviation <code>sd</code> (<code>S4</code>) (see the <code><a href="LS2W.html#topic+Haar2MA.diag">Haar2MA.diag</a></code> function in the <code>LS2W</code> package for more details).<br />  
The nonstationary processes are: a random field with unit standard deviation on the first half-plane, concatenated with a random normal half-plane of standard deviation <code>sd</code> (<code>NS1</code>); a white noise half-plane concatenated with a Matern stationary process (<code>NS2</code>); a <em>Haar Montage</em> of specified standard deviation <code>sd</code> (<code>NS3</code>) (see the <code>LS2W</code> <code><a href="LS2W.html#topic+HaarMontage">HaarMontage</a></code> function for more details);  a process with a slowly-varying covariance structure (<code>NS4</code>); a white noise process with a central subregion of random Normal deviates with non-unit standard deviation <code>sd</code> (<code>NS5</code>); a white noise process with a subregion of random Normal deviates with non-unit standard deviation in the middle section of the top left quadrant <code>sd</code> (<code>NS6</code>); the final process is similar to <code>NS5</code>, except that there is an additional texture in a subregion of the image.  In other words, the image is a montage of three two-dimensional Normal processes with differing standard deviations.  The base texture is again of unit variance, whereas the other two textures have standard deviations <code>sd</code> and 
<code>sd2</code> (<code>NS7</code>).
</p>
<p>The other optional arguments for <code>simTexture</code> are as follows:<br />
<code>type</code> - the type of neighbourhood dependence for the random field, either <code>"queen"</code> or <code>"rook"</code> (see the <code><a href="spdep.html#topic+cell2nb">cell2nb</a></code> function documentation in the <code>spdep</code> package for more details).<br />
<code>rho</code> - moving average parameter for the process <code>S2</code>.<br />
<code>nu</code> - shape parameter for the Matern covariance for process <code>S3</code>.<br />
<code>order</code> - Haar moving average order for <code>S4</code>.<br />
<code>fn</code>  - <code>scurve</code> or <code>lincurve</code> for <code>NS4</code>.<br />
<code>start</code> - start value for <code>NS4</code> (passed into <code>scurve</code> or <code>lincurve</code>).<br />
<code>end</code> - end value for <code>NS4</code> (passed into <code>scurve</code> or <code>lincurve</code>).<br />
<code>a</code> - &quot;gradient&quot; for <code>NS4</code> (passed into <code>scurve</code> or <code>lincurve</code>).<br />
<code>prop</code> - proportion of inserted subimage for <code>NS5</code>, <code>NS6</code> and the first subimage (<code>NS7</code>).<br />
<code>sd2</code> - standard deviation of second inserted subimage for <code>NS7</code>.<br />
<code>prop2</code> - proportion of second inserted subimage for <code>NS7</code>.<br />
<code>pos1</code> - position of first inserted subimage for <code>NS7</code>.<br />
<code>pos2</code> - position of second inserted subimage for <code>NS7</code>.
</p>


<h3>Value</h3>

  
<table>
<tr><td><code>images</code></td>
<td>
<p>A list of length <code>K</code>, with each list entry being an image of dimension <code>n x n</code> with the chosen spectral structure.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Generating lots of images of high dimension may take a long time!<br />
Note that as of version 2.1-4 (2022-05-09), textures S3 and NS2 have been temporarily removed (commented out) from the functionality of this function, due to a broken package (<span class="pkg">RandomFields</span>).
</p>


<h3>Author(s)</h3>

<p>Sarah L. Taylor and Matt Nunes
</p>


<h3>References</h3>

<p>Matern, B. (1960) Spatial variation. Stochastic models and their application to some problems in forest surveys and other sampling investigations <em>Meddleanden fran statens Skogsforskningsinstitut</em> <b>49</b> (5). <br />
Eckley, I.A., Nason, G.P., and Treloar, R.L. (2010) Locally stationary wavelet fields with application to the modelling and analysis of image texture <em>Journal of the Royal Statistical Society Series C</em>, <b>59</b>, 595-616.<br />
Taylor, S.L., Eckley, I.A., and Nunes, M.A. (2014) A Test of Stationarity for Textured Images. <em>Technometrics</em>, <b>56</b> (3), 291-301.
</p>


<h3>See Also</h3>

<p><code><a href="LS2W.html#topic+HaarMontage">HaarMontage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
X1 &lt;- simTexture(128,K=1,imtype="S4",order=3)
X2 &lt;- simTexture(128,K=1,imtype="NS4",fn=lincurve,a=.25,start=1,end=2)
X3 &lt;- simTexture(128,K=1,imtype="NS5",sd=1.6,prop=.25)
X4 &lt;- simTexture(128,K=1,imtype="NS7",sd=1.6,prop=.25,sd2=2.8, prop2=0.25, 
pos1=c(10,10),pos2="e")
        
# try plotting the images:

## Not run: image(plotmtx(X1[[1]]))

</code></pre>

<hr>
<h2 id='TOS2D'>
Perform bootstrap stationarity test for images.
</h2><span id='topic+TOS2D'></span>

<h3>Description</h3>

<p>For a given image this function performs bootstrapping to test the hypothesis that the image is stationary. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TOS2D(image, detrend = FALSE, nsamples = 100, theTS = avespecvar, verbose = TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TOS2D_+3A_image">image</code></td>
<td>

<p>The image you want to analyse.
</p>
</td></tr>
<tr><td><code id="TOS2D_+3A_detrend">detrend</code></td>
<td>

<p>This specifies whether to use Tukey's median polish to remove the image trend.
</p>
</td></tr>
<tr><td><code id="TOS2D_+3A_nsamples">nsamples</code></td>
<td>

<p>Number of bootstrap simulations to carry out.
</p>
</td></tr>
<tr><td><code id="TOS2D_+3A_thets">theTS</code></td>
<td>

<p>Specifies the particular test statistic to be used.  This function should measure the departure from constancy of the wavelet spectrum.
</p>
</td></tr>
<tr><td><code id="TOS2D_+3A_verbose">verbose</code></td>
<td>

<p>If TRUE informative messages are printed.
</p>
</td></tr>
<tr><td><code id="TOS2D_+3A_...">...</code></td>
<td>
<p>Any other arguments supplied to the LS2W function <code>cddews</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function first of all crops the image (if necessary) to have dyadic dimensions. The test statistic (<code>theTS</code>), which should be based upon the local wavelet spectrum, is calculated for this original image and the local wavelet spectrum under the null hypothesis is calculated, so as to be able to simulate realisations under the null hypothesis. <code>nsamples</code> images are simulated and test statistic is found for each. The function returns all the test statistic values which may be passed to <code><a href="#topic+getpval">getpval</a></code> in order to find a p-value for the test. For full details on this testing procedure see Taylor et al. (2014).
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>data.name</code></td>
<td>
<p>The name of the image analysed.</p>
</td></tr>
<tr><td><code>samples</code></td>
<td>
<p>A vector of length <code>nsamples+1</code>. The first entry is the value of the test statistic computed on the original image while the remaining entries are test statistic values for the simulated images.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>The name of the test statistic used.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The bootstrap p-value for the test.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah L. Taylor
</p>


<h3>References</h3>

<p>Taylor, S.L., Eckley, I.A., and Nunes, M.A. (2014) A Test of Stationarity for Textured Images. <em>Technometrics</em>, <b>56</b> (3), 291-301.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+avespecvar">avespecvar</a></code>, <code><a href="#topic+getpval">getpval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a stationary image
# 
testimage &lt;- matrix(rnorm(64*64), nrow=64, ncol=64)
#
#Run test of stationarity

## Not run: TestofStat&lt;-TOS2D(testimage)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
