<!DOCTYPE html><html><head><title>Help for package covatest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {covatest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#blocks-class'><p>Class &quot;blocks&quot;</p></a></li>
<li><a href='#couples-class'><p>Class &quot;couples&quot;</p></a></li>
<li><a href='#covablocks-class'><p>Class &quot;covablocks&quot;</p></a></li>
<li><a href='#covaprop-class'><p>Class &quot;covaprop&quot;</p></a></li>
<li><a href='#covastat-class'><p>Class &quot;covastat&quot;</p></a></li>
<li><a href='#covastatM-class'><p>Class &quot;covastatM&quot;</p></a></li>
<li><a href='#read.STdata'><p>Imports a text file in R</p></a></li>
<li><a href='#sepindex-class'><p>Class &quot;sepindex&quot;</p></a></li>
<li><a href='#setzero'><p>setzero</p></a></li>
<li><a href='#vv_13'><p>Precomputed variogram for PM10 in data set air</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tests on Properties of Space-Time Covariance Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Tests on properties of space-time covariance functions.
    Tests on symmetry, separability and for assessing 
    different forms of non-separability are available. Moreover tests on 
    some classes of covariance functions, such that the classes of 
    product-sum models, Gneiting models and integrated product models have 
    been provided.  It is the companion R package to the papers of  
    Cappello, C., De Iaco, S., Posa, D., 2018, Testing the type of non-separability 
    and some classes of space-time covariance function models &lt;<a href="https://doi.org/10.1007%2Fs00477-017-1472-2">doi:10.1007/s00477-017-1472-2</a>&gt;
    and Cappello, C., De Iaco, S., Posa, D., 2020, covatest: an R package for
    selecting a class of space-time covariance functions &lt;<a href="https://doi.org/10.18637%2Fjss.v094.i01">doi:10.18637/jss.v094.i01</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, stats, graphics, mathjaxr, methods, lubridate, V8, zoo,
gstat, sp (&ge; 0.9-72), spacetime (&ge; 1.0-0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>sf</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>mathjaxr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Collate:</td>
<td>'sepindex.R' 'couples.R' 'blocks.R' 'covablocks.R'
'covastat.R' 'covaprop.R' 'covastatM.R' 'read.STdata.R'
'vv_13.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-01 12:51:11 UTC; claudiacappello</td>
</tr>
<tr>
<td>Author:</td>
<td>Sandra De Iaco [aut, cre],
  Claudia Cappello [aut],
  Donato Posa [aut],
  Sabrina Maggio [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sandra De Iaco &lt;sandra.deiaco@unisalento.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-03 09:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='blocks-class'>Class &quot;blocks&quot;</h2><span id='topic+blocks-class'></span><span id='topic+blocks'></span><span id='topic+boxplot+2Cblocks-method'></span><span id='topic+blocks-method'></span><span id='topic+boxplot'></span><span id='topic+show+2Cblocks-method'></span><span id='topic++5B+2Cblocks-method'></span><span id='topic+summary+2Cblocks-method'></span>

<h3>Description</h3>

<p>A class for overlapped blocks of the time series associated with the given
spatial points specified through the function <code>couples</code>. Thus, it is
necessary to execute <a href="#topic+couples-class">couples</a> first and then <a href="#topic+blocks-class">blocks</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blocks(lb, ls, matdata, pardata1, pardata2, stpairs)

## S4 method for signature 'blocks'
boxplot(x, i, j, ...)

## S4 method for signature 'blocks'
show(object)

## S4 method for signature 'blocks'
x[i, j, drop = FALSE]

## S4 method for signature 'blocks'
summary(object, i, j)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blocks-class_+3A_lb">lb</code></td>
<td>
<p>integer, length of each block. The number of terms in each block
must be greater than 5 and smaller than the quarter part of the length of
each time series</p>
</td></tr>
<tr><td><code id="blocks-class_+3A_ls">ls</code></td>
<td>
<p>integer, number of overlapped data between two consecutive blocks.
The number of overlapped terms between two consecutive blocks must in the
interval <code class="reqn">[0, lb/2]</code></p>
</td></tr>
<tr><td><code id="blocks-class_+3A_matdata">matdata</code></td>
<td>
<p>STFDF/STSDF or <code>data.frame</code>, which contains the
coordinates of the spatial points, the identification code of the spatial
points, the indentification code of the temporal points and the values of
the variable, typically output from <code>read.STdata</code></p>
</td></tr>
<tr><td><code id="blocks-class_+3A_pardata1">pardata1</code></td>
<td>
<p>integer, it represents the column in which the spatial ID is
stored (if the spatio-temporal data set is given as data.frame) or the number
of variables in the STFDF/STSDF (if the data are given as a STFDF/STSDF)</p>
</td></tr>
<tr><td><code id="blocks-class_+3A_pardata2">pardata2</code></td>
<td>
<p>integer, it represents the column in which the values of the
variable are stored (if the spatio-temporal data set is given as data.frame)
or the slot in which the values of the variable of interest are stored
(if the data are given as a STFDF/STSDF). Note that for STFDF/STSDF the
argument is set, by default, equal to 1 if the number of variables is equal
to 1</p>
</td></tr>
<tr><td><code id="blocks-class_+3A_stpairs">stpairs</code></td>
<td>
<p>object of class <code>couples</code>, containing the spatial
points and the corresponding temporal lags to be analyzed</p>
</td></tr>
<tr><td><code id="blocks-class_+3A_x">x</code></td>
<td>
<p>object of class <code>blocks</code> for methods <code>boxplot</code> and <code>extract</code></p>
</td></tr>
<tr><td><code id="blocks-class_+3A_i">i</code></td>
<td>
<p>index specifying the block to be selected. If <code>i=0</code> all blocks are
selected automatically (option available only for <code>boxplot</code> and <code>summary</code>
methods)</p>
</td></tr>
<tr><td><code id="blocks-class_+3A_j">j</code></td>
<td>
<p>index specifying the spatial point to be selected. If <code>j=0</code> all
spatial points are selected automatically (option available only for <code>boxplot</code>
and <code>summary</code> methods)</p>
</td></tr>
<tr><td><code id="blocks-class_+3A_...">...</code></td>
<td>
<p>any arguments that will be passed to the panel plotting functions</p>
</td></tr>
<tr><td><code id="blocks-class_+3A_object">object</code></td>
<td>
<p>object of class <code>blocks</code> for methods <code>show</code> and <code>summary</code></p>
</td></tr>
<tr><td><code id="blocks-class_+3A_drop">drop</code></td>
<td>
<p>logical, the argument is set, by default, equal to <code>FALSE</code> to
preserve the structure of the object. It is advisable not to change this option</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A message informs the user of the number of blocks extracted
</p>


<h3>Slots</h3>


<dl>
<dt><code>mat.block</code></dt><dd><p>matrix of dimension (<em>lb</em> x <em>overall
number of blocks</em>); the columns of this matrix are associated with the
different blocks, of length equal to <code>lb</code>, that can be extracted
from the time series related to the selected spatial points
defined in the slot <code>stpairs</code> of <code>couples</code>, identified
as  <code>stpairs@sel.staz</code></p>
</dd>
<dt><code>array.block</code></dt><dd><p>array of dimension (<em>lb</em> x <em>number of
blocks for each selected spatial points</em> x <em>number of spatial points</em>).
In each table of this array, the overlapped blocks for each spatial location
are available</p>
</dd>
<dt><code>sel.staz</code></dt><dd><p>numeric or character; contains the ID codes of the selected
spatial points</p>
</dd>
</dl>


<h3>Note</h3>


<ul>
<li><p> &quot;Error in matdata<code class="reqn">[, clvr]</code>: subscript out of bounds&quot; appears if <code>pardata2</code>
does not exist in the argument <code>matdata</code>
</p>
</li>
<li><p> If &quot;Error in matdata<code class="reqn">[, clvr]</code>&quot; appears, no data for some of the
spatial points, specified in <code>stpairs</code>, are available. The user has to
go back to <code>couples</code> and revise the vector of the selected spatial points
(<code>sel.staz</code> and <code>sp.couples.in</code> arguments)
</p>
</li>
<li><p> A stop occurs if more than 75% of consecutive data are missing in the time
series, since a large number of missing values do not guarantee the reliability
of the tests
</p>
</li>
<li><p> A stop occurs if the length of the time series for each
spatial points is less than 29
</p>
</li>
<li><p> A message appears if the length of the time series for each
spatial point is greater than 29 and less than 89, since the length of the
time series is low and may not guarantee the reliability of the tests
</p>
</li>
<li><p> A stop occurs if more than 80% of consecutive data are missing in one
of the blocks, since the estimation of the covariance matrix is not reliable,
when a large number of missing values occur
</p>
</li>
<li><p> If, in the last block of each selected spatial point, more than 15%
of data are missing a warning message appears, since the estimation of the
covariance matrix, when a large number of missing values occurs, is not
reliable
</p>
</li>
<li><p> A warning message appears if the number of blocks, computed by fixing
<code>lb</code> and <code>ls</code>, is less than 5. It is convenient that the number of
blocks is close to the number of spatio-temporal comparisons defined in
<code>couples</code>. This avoids singolarity in computing test statistics
</p>
</li></ul>



<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2018, Testing the type of
non-separability and some classes of space-time covariance function models.
Stochastic Environmental Research and Risk Assessment,
<b>32</b> 17&ndash;35
</p>
<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1&ndash;42.
</p>
<p>De Iaco, S., Palma, M., Posa, D., 2016. A general procedure for selecting a
class of fully symmetric space-time covariance functions.
Environmentrics, <b>27(4)</b> 212&ndash;224.
</p>
<p>Li, B., Genton, M.G., Sherman, M., 2007, A nonparametric assessment
of properties of spacetime covariance functions.
Journal of the American Statistical Association, <b>102</b> 736&ndash;744.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+couples">couples</a></code>
</p>
<p><code><a href="#topic+read.STdata">read.STdata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)
#library(gstat)
data(air)
ls()
if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))
rr = rural[,"2005::2010"]
unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))
r5to10 = rr[-unsel,]
rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #


sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

block.sym &lt;- blocks(lb = 40, ls = 10, matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.sym)

### methods for blocks
#1. show
block.sym

#2. [  extract
block.sym[1,] #select the 1st block of each spatial location
block.sym[,1] #select all blocks of the 1st spatial location
block.sym[1:2, 1:3] #select the first two blocks of the first 3 spatial locations

#3. summary
summary(block.sym, 1:2, 1:3) #to obtain the summary associated to the first
#two blocks of the first 3 spatial locations

summary(block.sym, 0, 1) #to obtain the summary associated to all blocks of
#the 1st spatial location

#4. boxplot
boxplot(block.sym, 1:5, 1:2) #boxplots of the first 5 blocks of associated to
#the first 2 spatial locations

boxplot(block.sym, 0 ,1) #boxplots of all blocks of associated to the 1st
#spatial location

</code></pre>

<hr>
<h2 id='couples-class'>Class &quot;couples&quot;</h2><span id='topic+couples-class'></span><span id='topic+couples'></span><span id='topic+show+2Ccouples-method'></span><span id='topic+couples-method'></span><span id='topic+show'></span><span id='topic++5B+2Ccouples-method'></span><span id='topic+select'></span><span id='topic+summary+2Ccouples-method'></span><span id='topic+summary'></span>

<h3>Description</h3>

<p>A class for spatial points and the corresponding temporal lags to be
analyzed in order to test some covariance properties and some well known
classes of space-time covariance functions models
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>couples(
  sel.staz,
  sp.couples.in,
  t.couples.in,
  typetest = "sym",
  typecode = numeric()
)

## S4 method for signature 'couples'
show(object)

## S4 method for signature 'couples'
x[i, by.row = FALSE, drop = FALSE]

## S4 method for signature 'couples'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="couples-class_+3A_sel.staz">sel.staz</code></td>
<td>
<p>vector, the sequence of ID codes which denote the spatial
points to be analyzed</p>
</td></tr>
<tr><td><code id="couples-class_+3A_sp.couples.in">sp.couples.in</code></td>
<td>
<p>two-column matrix: rows corresponding to the couples
of different spatial points, chosen among the ones fixed in <code>sel.staz</code>
argument, to be compared</p>
</td></tr>
<tr><td><code id="couples-class_+3A_t.couples.in">t.couples.in</code></td>
<td>
<p>vector of only positive (negative) temporal lags to be
analyzed. The corresponding negative (positive) temporal lags are included
authomatically for <code>typetest = "sym", "sep", "tnSep"</code>. If some temporal
lags, corresponding to some couples of spatial points, are not required for
the specific test, they can be set equal to zero, through the specific
<code><a href="#topic+setzero">setzero</a></code> method</p>
</td></tr>
<tr><td><code id="couples-class_+3A_typetest">typetest</code></td>
<td>
<p>character, set <code>typetest = "sym"</code> for symmetry test
(default choice), <code>typetest = "sep"</code> for separability test,
<code>typetest = "tnSep"</code> for type of non separability test,
<code>typetest = "productSum"</code> for the test on the product-sum class of models,
<code>typetest = "intProduct"</code> for the test on the integrated product class
of models, <code>typetest = "gneiting"</code> for the test on the Gneiting class
of models</p>
</td></tr>
<tr><td><code id="couples-class_+3A_typecode">typecode</code></td>
<td>
<p>type of object, i.e. numeric() or character(), specifies the
type of codification of the spatial points in the <code>data frame</code> or in the
STFDF/STSDF</p>
</td></tr>
<tr><td><code id="couples-class_+3A_object">object</code></td>
<td>
<p>object of class <code>couples</code> for methods <code>show</code> and <code>summary</code></p>
</td></tr>
<tr><td><code id="couples-class_+3A_x">x</code></td>
<td>
<p>object of class <code>couples</code> for method <code>extract</code></p>
</td></tr>
<tr><td><code id="couples-class_+3A_i">i</code></td>
<td>
<p>index specifying rows or columns of the slot <code>@couples.st</code>.
Rows or columns depending on the logical parameter <code>by.row</code> to be set</p>
</td></tr>
<tr><td><code id="couples-class_+3A_by.row">by.row</code></td>
<td>
<p>logical, if <code>TRUE</code> rows of the slot <code>@couples.st</code> are
selected (the temporal lags associated to the i-th spatial couple are given).
If <code>FALSE</code> (the default) columns of the slot <code>@couples.st</code> are
selected. In particular, the spatial couples associated to the i-th temporal
lag (i &gt;= 3, temporal lags are stored from the third column) are given</p>
</td></tr>
<tr><td><code id="couples-class_+3A_drop">drop</code></td>
<td>
<p>logical, the argument is set, by default, equal to <code>FALSE</code> to
preserve the structure of the object. It is advisable not to change this option</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is important to point out that:
</p>

<ul>
<li><p> both positive and negative temporal lags are automatically considered in
the slot <code>@couples.st</code> and <code>@tl.couples</code> for symmetry test
(<code>typetest = "sym"</code>), separability test (<code>typetest = "sep"</code>) and
type of non separability tests
(<code>typetest = "tnSep"</code>). If the symmetry hyphotesis has not been rejected, only
positive temporal lags might be considered for the test on separability and type
of non separability (<code>typetest = "sep"</code> and <code>typetest = "tnSep"</code>), hence the
specific <code><a href="#topic+setzero">setzero</a></code> method must be used to set the negative temporal
lags equal to zero
</p>
</li>
<li><p> for <code>typetest = "tnSep"</code> the temporal lags should be chosen according to
the results of the sample non separability ratios, plotted through a boxplot
classified for temporal lags (see <a href="#topic+sepindex-class">sepindex</a> for more details)
</p>
</li>
<li><p> for model tests (<code>typetest</code> equal to <code>"productSum"</code>,
<code>"intProduct"</code> and <code>"gneiting"</code>), the number of analyzed spatial
points must be used to create at least 3 spatial couples or multiple of 3,
such that each triplet satisfies the condition
\[||\mathbf{h}_{1}||^{2\gamma} - ||\mathbf{h}_{2}||^{2\gamma} = ||\mathbf{h}_{2}||^{2\gamma}-||\mathbf{h}_{3}||^{2\gamma}\]
where \(\gamma \in ]0,1]\) only for <code>typetest = "intProduct"</code>
and <code>"gneiting"</code>.
The number of positive temporal lags must be at least 3, or multiple
of 3, too. The condition \[u_{1}^{2\alpha}-u_{2}^{2\alpha}=u_{2}^{2\alpha}-u_{3}^{2\alpha}\]
where \(\alpha \in ]0,1]\) must be satisfied for each triplet
(only for <code>typetest = "intProduct"</code> and <code>"gneiting"</code>), as clarified
in Cappello et al., 2018. The values of \(\gamma\) and \(\alpha\)  are usually fixed
equal to 0.5 or 1 according that the behavior near the origin of the spatial
and temporal marginal covariograms is linear or quadratic, respectively.
Note that for each spatial triplet and each temporal triplet, 6 contrasts can
be defined. However, for <code>typetest = "intProduct"</code> (test on the integrated
model) the user has to set arbitrarily one temporal lag equal to zero for each
spatial triplet in order to delete redundant contrasts, through the specific
<code><a href="#topic+setzero">setzero</a></code> method
</p>
</li></ul>



<h3>Slots</h3>


<dl>
<dt><code>couples.st</code></dt><dd><p>matrix, in which the first two columns contain the
couples of spatial points (denoted with order numbers) to be analyzed
and the other columns the temporal lags associated with each spatial couples</p>
</dd>
<dt><code>sel.staz</code></dt><dd><p>numeric or character, contains the ID codes of the
selected spatial points</p>
</dd>
<dt><code>sp.couples</code></dt><dd><p>data.frame, contains the couples of order numbers
associated with the spatial points to be analyzed and the couples of the
ID codes</p>
</dd>
<dt><code>tl.couples</code></dt><dd><p>numeric, contains the temporal lags associated to the
couples of the selected spatial points</p>
</dd>
<dt><code>typetest</code></dt><dd><p>character; contains the code of the test to be performed</p>
</dd>
</dl>


<h3>Note</h3>


<p>Errors occur if
</p>

<ul>
<li><p> some spatial points, given in the sequence at the beginning of the
function, have not been used to generate the couples of spatial points
</p>
</li>
<li><p> there is at least one spatial couple with no specification of
temporal lags
</p>
</li>
<li><p> no temporal lags have been specified
</p>
</li>
<li><p> the number of spatial points fixed in <code>sel.staz</code> is less than 2
</p>
</li>
<li><p> the construction of the <code>sp.couples.in</code> is not consistent with the
test to be performed
</p>
</li></ul>




<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1&ndash;42.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setzero">setzero</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

### methods for couples
#1. show
couples.sym

#2. [ extract
couples.sym[3, by.row = FALSE]
couples.sym[3, by.row = TRUE]

#3. summary
summary(couples.sym)

</code></pre>

<hr>
<h2 id='covablocks-class'>Class &quot;covablocks&quot;</h2><span id='topic+covablocks-class'></span><span id='topic+covablocks'></span><span id='topic+show+2Ccovablocks-method'></span><span id='topic+covablocks-method'></span>

<h3>Description</h3>

<p>A class for the sample spatio-temporal covariances to be computed for each
block of data and for the selected spatial and temporal lags fixed
in <code>stpairs</code> (output from <code>couples</code>). Depending on the type of
test the empirical variance, the sample spatial and temporal marginal
covariances for each block of data are also computed. Moreover, the sample
covariances between the spatio-temporal covariances at the specified spatial
and temporal lags are determined.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covablocks(stblocks, stpairs, typetest = "sym")

## S4 method for signature 'covablocks'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covablocks-class_+3A_stblocks">stblocks</code></td>
<td>
<p>object of class <code>blocks</code></p>
</td></tr>
<tr><td><code id="covablocks-class_+3A_stpairs">stpairs</code></td>
<td>
<p>object of class <code>couples</code>, containing the spatial
points and the corresponding temporal lags to be analyzed</p>
</td></tr>
<tr><td><code id="covablocks-class_+3A_typetest">typetest</code></td>
<td>
<p>character, set <code>typetest ="sym"</code> for symmetry test
(default choice), <code>typetest ="sep"</code> for separability test, <code>typetest ="tnSep"</code>
for type of non separability test,<code>typetest ="productSum"</code> for the test
on the product-sum class of models, <code>typetest ="intProduct"</code> for the test
on the integrated product class of models, <code>typetest ="gneiting"</code> for the
test on the Gneiting class of models</p>
</td></tr>
<tr><td><code id="covablocks-class_+3A_object">object</code></td>
<td>
<p>object of class <code>covablocks</code> for method <code>show</code></p>
</td></tr>
</table>


<h3>Details</h3>



<ul>
<li><p> If <code>typetest</code> is equal to <code>"sym"</code> (symmetry test) or <code>"intProduct"</code>
(test on the integrated product class of models) <code>mat.cova.h</code> and <code>mat.cova.u</code>
are not available
</p>
</li>
<li><p> If <code>typetest</code> is equal to <code>"gneiting"</code> (test on the Gneiting
class of models) <code>mat.cova.h</code> is not available
</p>
</li>
<li><p> If temporal lags in <code>stpairs</code> are not consistent with block length
(<code>lb</code>) in <code>stblocks</code> an error message will be returned
</p>
</li>
<li><p> If the proportion between the maximum temporal lag in <code>stpairs</code> and
the block length (<code>lb</code>) in <code>stblocks</code> is greater than 0.25 a warning
message will be returned since the covariance estimation might not be reliable
</p>
</li></ul>




<h3>Slots</h3>


<dl>
<dt><code>mat.cova</code></dt><dd><p>matrix of sample spatio-temporal covariances for each block,
computed for the spatial and temporal lags given in <code>stpairs</code>
(object of class <code>couples</code>)</p>
</dd>
<dt><code>mat.cova.h</code></dt><dd><p>matrix of sample spatial marginal covariances
for the specified lags</p>
</dd>
<dt><code>mat.cova.u</code></dt><dd><p>matrix of sample temporal marginal covariances
for the specified lags</p>
</dd>
<dt><code>mat.cova.cova</code></dt><dd><p>matrix of sample covariances between space-time
covariances for each block, computed for the spatial and temporal lags given
in <code>stpairs</code> (object of class <code>couples</code>)</p>
</dd>
<dt><code>typetest</code></dt><dd><p>character, contains the code of the test to be performed</p>
</dd>
</dl>


<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2018, Testing the type of
non-separability and some classes of space-time covariance function models.
Stochastic Environmental Research and Risk Assessment,
<b>32</b> 17&ndash;35
</p>
<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1&ndash;42.
</p>
<p>De Iaco, S., Palma, M., Posa, D., 2016. A general procedure for selecting a
class of fully symmetric space-time covariance functions.
Environmentrics, <b>27(4)</b> 212&ndash;224.
</p>
<p>Li, B., Genton, M.G., Sherman, M., 2007, A nonparametric assessment
of properties of spacetime covariance functions.
Journal of the American Statistical Association, <b>102</b> 736&ndash;744.
</p>


<h3>See Also</h3>

<p><a href="#topic+blocks-class">blocks</a>
</p>
<p><a href="#topic+couples-class">couples</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)
#library(gstat)
data(air)
ls()
if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))
rr = rural[,"2005::2010"]
unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))
r5to10 = rr[-unsel,]
rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #

sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

block.sym &lt;- blocks(lb = 40, ls = 10, matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.sym)

covabl.sym &lt;- covablocks(stblocks = block.sym, stpairs = couples.sym, typetest = "sym")

### method for covablock
#1. show
covabl.sym

</code></pre>

<hr>
<h2 id='covaprop-class'>Class &quot;covaprop&quot;</h2><span id='topic+covaprop-class'></span><span id='topic+covaprop'></span><span id='topic+show+2Ccovaprop-method'></span><span id='topic+covaprop-method'></span>

<h3>Description</h3>

<p>A function for testing some properties (symmetry, separability, type of
non-separability) of spatio-temporal covariance functions and some classes
of space-time covariance models
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covaprop(cblock, cstat, nonseptype = NULL, sign.level = 0.05)

## S4 method for signature 'covaprop'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covaprop-class_+3A_cblock">cblock</code></td>
<td>
<p>object of class <code>covablocks</code></p>
</td></tr>
<tr><td><code id="covaprop-class_+3A_cstat">cstat</code></td>
<td>
<p>object of class <code>covastat</code> or <code>covastatM</code></p>
</td></tr>
<tr><td><code id="covaprop-class_+3A_nonseptype">nonseptype</code></td>
<td>
<p>integer, this argumet is required only for objects
(<code>cblock</code> and <code>cstat</code>) defined to perform the type of non
separability test, otherwise it has to be set equal to <code>NULL</code> (default choice).
Set <code>nonseptype=0</code> for testing the null hypothesis that the non
separability is non positive; set <code>nonseptype=1</code> for testing the null
hypothesis that the non separability is non negative</p>
</td></tr>
<tr><td><code id="covaprop-class_+3A_sign.level">sign.level</code></td>
<td>
<p>numeric, level of significance</p>
</td></tr>
<tr><td><code id="covaprop-class_+3A_object">object</code></td>
<td>
<p>object of class <code>covaprop</code> for method <code>show</code></p>
</td></tr>
</table>


<h3>Details</h3>



<ul>
<li><p> A message helps to decide for either reject the null hypothesis in favor of
the alternative or not reject it, at a specific level of significance
</p>
</li>
<li><p> The test on full symmetry (when the slot <code>@typetest</code> is
equal to <code>"sym"</code>) represents the first step
for the selection of a suitable class of spatio-temporal covariance functions.
According to the definition of full symmetry, the null hypothesis to be
tested is \[H_0: C(\mathbf{h},u) - C(\mathbf{h},-u)=0\]
</p>
</li>
<li><p> The test of separability (when the slot <code>@typetest</code> is
equal to <code>"sep"</code>) represents the second
step of the testing procedure. According to the definition of separability,
the null hypothesis to be tested is
\[H_0: C(\mathbf{h}, u)/C(\mathbf{h}, 0) - C(\mathbf{0}, u)/C(\mathbf{0},0)=0\]
</p>
</li>
<li><p> The test on the type of non separability (when the slot
<code>@typetest</code> is equal to <code>"tnSep"</code>)
represents the third step for the selection of a suitable class of space-time
covariance functions.
According to the definition of type of non separability, the null hypothesis
to be tested is that the non separability is non negative
\[H_0: C(\mathbf{h},u)/C(\mathbf{h},0) - C(\mathbf{0},u)/C(\mathbf{0},0) > 0\]
or
\[H_0: C(\mathbf{h},u)/C(\mathbf{h},0) - C(\mathbf{0},u)/C(\mathbf{0},0) < 0\]
if the null hypothesis to test is that the non separability is non positive
</p>
</li>
<li><p> If the slot <code>@typetest</code> is equal to <code>"productSum"</code>
<code>"intProduct"</code> or <code>"gneiting"</code>, the goodness of a specific class of
space-time covariance function will be tested. For this testing procedure
the generic null hypothesis is: \[H_0: \mathbf{Af(G)}=0\]
</p>
</li></ul>

<p>For the analytic expression of each test statistic and its probability
distribution see Cappello et al. (2018). In the same contribution the
different <code>f(G)</code> are given for each test to be computed.

</p>


<h3>Slots</h3>


<dl>
<dt><code>test.statistics</code></dt><dd><p>numeric, the value of the test statistic</p>
</dd>
<dt><code>p.value</code></dt><dd><p>numeric, the lower tail p value of the test statistic</p>
</dd>
<dt><code>df</code></dt><dd><p>numeric, the degrees of freedom, if available</p>
</dd>
<dt><code>typetest</code></dt><dd><p>character, contains the code of the test to be performed</p>
</dd>
</dl>


<h3>Note</h3>



<ul>
<li><p> A stop occurs if the type of test set in <code>cblock</code> is not consistent
with the type of test set in <code>cstat</code>.
</p>
</li>
<li><p> If the message <code>Error in solve.default(): system is computationally singular:...</code>
appears, the inverse of the matrix involved in the test statistic
in (9) of Cappello et al. (2020) is computationally singular.
In order to overcome this numerical problem often related to the tests on the
models, the object <code>stpairs</code> (of class
<code>couples</code>) has to be modified. In particular, by considering that for each spatial
triplet and each temporal triplet 6 contrasts can be defined, it is advisable
to adopt one of the following options: 1) set equal to zero one of the
highest temporal lags, for each spatial and each temporal triplet, through the
specific <code><a href="#topic+setzero">setzero</a></code> method, 2) substitute triplets associated with long spatial
or temporal distances with others characterized by lower distances.
Then, the user has to run again <code><a href="#topic+blocks">blocks</a></code>, <code><a href="#topic+covablocks">covablocks</a></code>,
<code><a href="#topic+covastatM">covastatM</a></code> and <code><a href="#topic+covaprop">covaprop</a></code>.
The above error message also occurs if there are at least two spatial triplets, where:
</p>

<ul>
<li><p> two couples are replicated;
</p>
</li>
<li><p> one couple is replicated.
</p>
</li></ul>

<p>In such cases it is enough to set equal to zero one temporal lag for each temporal
triplet associated to the couples involved in the replications.
</p>
</li></ul>




<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2018, Testing the type of
non-separability and some classes of space-time covariance function models.
Stochastic Environmental Research and Risk Assessment,
<b>32</b> 17&ndash;35
</p>
<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1&ndash;42.
</p>
<p>De Iaco, S., Palma, M., Posa, D., 2016. A general procedure for selecting a
class of fully symmetric space-time covariance functions.
Environmentrics, <b>27(4)</b> 212&ndash;224.
</p>
<p>Li, B., Genton, M.G., Sherman, M., 2007, A nonparametric assessment
of properties of spacetime covariance functions.
Journal of the American Statistical Association, <b>102</b> 736&ndash;744.
</p>


<h3>See Also</h3>

<p><a href="#topic+couples-class">couples</a>
</p>
<p><a href="#topic+blocks-class">blocks</a>
</p>
<p><a href="#topic+covablocks-class">covablocks</a>
</p>
<p><a href="#topic+covastat-class">covastat</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)
#library(gstat)
data(air)
ls()
if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))
rr = rural[,"2005::2010"]
unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))
r5to10 = rr[-unsel,]
rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #

#--Example 1: test on symmetry--#

sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

block.sym &lt;- blocks(lb = 40, ls = 10, matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.sym)

covabl.sym &lt;- covablocks(stblocks = block.sym, stpairs = couples.sym, typetest = "sym")

covast.sym &lt;- covastat(matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.sym, typetest = "sym")

test.sym &lt;- covaprop(cblock = covabl.sym, cstat = covast.sym, nonseptype = NULL,
sign.level = 0.05)

#--Example 2: test on the Gneiting model--#
sel.staz.mod &lt;- c("DETH061", "DEBY047", "DEHE051", "DEUB029", "DENI019",
"DENI051", "DETH026", "DESN049")

sp.couples.in.mod &lt;- matrix(data = c("DETH061", "DEBY047",
                                    "DEHE051", "DEUB029",
                                    "DENI019", "DENI051",
                                    "DEHE051", "DETH026",
                                    "DEBY047", "DESN049",
                                    "DETH026", "DETH061"),
                           ncol = 2, byrow = TRUE)
                           t.couples.in.mod &lt;- c(1, 2, 3)

couples.mod &lt;- couples(sel.staz = sel.staz.mod,
sp.couples.in = sp.couples.in.mod, t.couples.in = t.couples.in.mod,
typetest = "gneiting", typecode = character())

zero.index &lt;- matrix(data = c(3, 7, 6, 7), ncol = 2, byrow = TRUE)

couples.mod &lt;- setzero(x = couples.mod, zero = FALSE, index = zero.index, value = 0)

block.mod &lt;- blocks(lb = 60, ls = 10, matdata = rr_13, pardata1 = 1,
pardata2 = 1, stpairs = couples.mod)

covabl.gn &lt;- covablocks(stblocks = block.mod, stpairs = couples.mod,
typetest = "gneiting")

covast.gn &lt;- covastatM(matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.mod, typetest = "gneiting", beta.data = seq(0.5, 1, by=0.1))

test.gn &lt;- covaprop(cblock = covabl.gn, cstat = covast.gn, nonseptype = NULL,
sign.level = 0.05)

### method for covaprop
#1. show
test.sym

</code></pre>

<hr>
<h2 id='covastat-class'>Class &quot;covastat&quot;</h2><span id='topic+covastat-class'></span><span id='topic+covastat'></span><span id='topic+show+2Ccovastat-method'></span><span id='topic+covastat-method'></span>

<h3>Description</h3>

<p>A class for the sample spatio-temporal covariances for the specified spatial
and temporal lags, given in <code>stpairs</code> (object of class <code>couples</code>),
for symmetry, separability and type of non separability tests.
Depending on the type of test, the empirical variance, the sample spatial
and temporal marginal covariances are also computed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covastat(matdata, pardata1, pardata2, stpairs, typetest = "sym")

## S4 method for signature 'covastat'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covastat-class_+3A_matdata">matdata</code></td>
<td>
<p>STFDF/STSDF or <code>data.frame</code>, which contains the
coordinates of the spatial points, the identification code of the spatial
points, the indentification code of the temporal points and the values of
the variable, typically output from <code>read.STdata</code></p>
</td></tr>
<tr><td><code id="covastat-class_+3A_pardata1">pardata1</code></td>
<td>
<p>integer, it represents the column in which the spatial ID is
stored (if the spatio-temporal data set is given as data.frame) or the number of
variables in the STFDF/STSDF (if the data are given as a STFDF/STSDF)</p>
</td></tr>
<tr><td><code id="covastat-class_+3A_pardata2">pardata2</code></td>
<td>
<p>integer, it represents the column in which the values of the
variable are stored (if the spatio-temporal data set is given as data.frame) or
the slot in which the values of the variable of interest are stored
(if the data are given as a STFDF/STSDF). Note that for STFDF/STSDF the
argument is set, by default, equal to 1 if the number of variables is equal to 1</p>
</td></tr>
<tr><td><code id="covastat-class_+3A_stpairs">stpairs</code></td>
<td>
<p>object of class <code>couples</code>, containing the spatial
points and the corresponding temporal lags to be analyzed</p>
</td></tr>
<tr><td><code id="covastat-class_+3A_typetest">typetest</code></td>
<td>
<p>character, set <code>typetest = "sym"</code> for symmetry test
(default choice), <code>typetest = "sep"</code> for separability test, <code>typetest = "tnSep"</code>
for type of non separability test</p>
</td></tr>
<tr><td><code id="covastat-class_+3A_object">object</code></td>
<td>
<p>object of class <code>covastat</code> for method <code>show</code></p>
</td></tr>
</table>


<h3>Details</h3>



<ul>
<li><p> A message appears on the user's console if the <code>G</code> vector
contains spatio-temporal negative covariances. The message returns the negative
value/values and it will help to identify the spatial and the temporal lags
involved
</p>
</li>
<li><p> If <code>typetest = "sym"</code> (symmetry test) <code>cova.h</code>, <code>cova.u</code>,
<code>f.G</code> and <code>B</code> are not available
</p>
</li></ul>




<h3>Slots</h3>


<dl>
<dt><code>G</code></dt><dd><p>matrix, containing the spatio-temporal covariances for the specified
lags. For all tests, except for the symmetry test (<code>typetest = "sym"</code>), the
sample variance and the sample spatial and temporal marginal covariances are
also computed and stored in <code>G</code></p>
</dd>
<dt><code>cova.h</code></dt><dd><p>matrix, containing the sample spatial marginal covariances
for the specified lags</p>
</dd>
<dt><code>cova.u</code></dt><dd><p>matrix, containing the sample temporal marginal covariances
for the specified lags</p>
</dd>
<dt><code>f.G</code></dt><dd><p>array, containing the computation of specific functions of the
elements of <code>G</code>, see references</p>
</dd>
<dt><code>B</code></dt><dd><p>matrix, containing the computation of the derivatives of each element
of <code>f.G</code> with respect to each element of <code>G</code></p>
</dd>
<dt><code>A</code></dt><dd><p>contrast matrix</p>
</dd>
<dt><code>typetest</code></dt><dd><p>character, contains the code of the test to be performed</p>
</dd>
</dl>


<h3>Note</h3>


<ul>
<li><p> A stop occurs if the number of spatial points fixed in <code>stpairs</code>
(object of class <code>couples</code>) is less than 2
</p>
</li>
<li><p> A stop occurs if more than 75\
series, since a large number of missing values do not guarantee the reliability
of the tests
</p>
</li></ul>



<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2018, Testing the type of
non-separability and some classes of space-time covariance function models.
Stochastic Environmental Research and Risk Assessment,
<b>32</b> 17&ndash;35
</p>
<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1&ndash;42.
</p>
<p>De Iaco, S., Palma, M., Posa, D., 2016. A general procedure for selecting a
class of fully symmetric space-time covariance functions.
Environmentrics, <b>27(4)</b> 212&ndash;224.
</p>
<p>Li, B., Genton, M.G., Sherman, M., 2007, A nonparametric assessment
of properties of spacetime covariance functions.
Journal of the American Statistical Association, <b>102</b> 736&ndash;744.
</p>


<h3>See Also</h3>

<p><a href="#topic+couples-class">couples</a>
</p>
<p><code><a href="#topic+read.STdata">read.STdata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)
#library(gstat)
data(air)
ls()
if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))
rr = rural[,"2005::2010"]
unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))
r5to10 = rr[-unsel,]
rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #

sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

covast.sym &lt;- covastat(matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.sym, typetest = "sym")

### method for covastat
#1. show
covast.sym

</code></pre>

<hr>
<h2 id='covastatM-class'>Class &quot;covastatM&quot;</h2><span id='topic+covastatM-class'></span><span id='topic+covastatM'></span><span id='topic+show+2CcovastatM-method'></span><span id='topic+covastatM-method'></span>

<h3>Description</h3>

<p>A class for the sample spatio-temporal covariances for the specified spatial
and temporal lags, given in <code>stpairs</code> (object of class <code>couple</code>),
for the test on the type of class of models.
Depending on the type of test, the empirical variance, the sample spatial
and temporal marginal covariances are also computed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covastatM(
  matdata,
  pardata1,
  pardata2,
  stpairs,
  typetest = "productSum",
  beta.data = NULL
)

## S4 method for signature 'covastatM'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covastatM-class_+3A_matdata">matdata</code></td>
<td>
<p>STFDF/STSDF or <code>data.frame</code>, which contains the
coordinates of the spatial points, the identification code of the spatial
points, the indentification code of the temporal points and the values of
the variable, typically output from <code>read.STdata</code></p>
</td></tr>
<tr><td><code id="covastatM-class_+3A_pardata1">pardata1</code></td>
<td>
<p>integer, it represents the column in which the spatial ID is
stored (if the spatio-temporal data set is given as data.frame) or the number of
variables in the STFDF/STSDF (if the data are given as a STFDF/STSDF)</p>
</td></tr>
<tr><td><code id="covastatM-class_+3A_pardata2">pardata2</code></td>
<td>
<p>integer, it represents the column in which the values of the
variable are stored (if the spatio-temporal data set is given as data.frame) or
the slot in which the values of the variable of interest are stored
(if the data are given as a STFDF/STSDF). Note that for STFDF/STSDF the
argument is set, by default, equal to 1 if the number of variables is equal to 1</p>
</td></tr>
<tr><td><code id="covastatM-class_+3A_stpairs">stpairs</code></td>
<td>
<p>object of class <code>couples</code>, containing the spatial
points and the corresponding temporal lags to be analyzed</p>
</td></tr>
<tr><td><code id="covastatM-class_+3A_typetest">typetest</code></td>
<td>
<p>character, set <code>typetest = "productSum"</code> for the test
on the product-sum class of models (default choice), <code>typetest = "intProduct"</code>
for the test on the integrated product class of models, <code>typetest = "gneiting"</code>
for the test on the Gneiting class of models</p>
</td></tr>
<tr><td><code id="covastatM-class_+3A_beta.data">beta.data</code></td>
<td>
<p>vector, this argument is required only for <code>typetest = "gneiting"</code>,
otherwise it has to be set equal to NULL (default choice). It contains the
different values of the parameter beta, which can assume values in the range 0-1</p>
</td></tr>
<tr><td><code id="covastatM-class_+3A_object">object</code></td>
<td>
<p>object of class <code>covastatM</code> for method <code>show</code></p>
</td></tr>
</table>


<h3>Details</h3>



<ul>
<li><p> If <code>typetest = "intProduct"</code> (test on the integrated product class
of models) <code>cova.h</code> and <code>cova.u</code> are not available
</p>
</li>
<li><p> If <code>typetest = "gneiting"</code> (test on the Gneiting class of models),
<code>cova.h</code> is not available
</p>
</li>
<li><p> A message appears on the user's console if the <code>G</code> vector
contains spatio-temporal negative covariances. The message returns the negative
value/values and it will help to identify the spatial and the temporal lags
involved
</p>
</li></ul>




<h3>Slots</h3>


<dl>
<dt><code>G</code></dt><dd><p>matrix, containing the spatio-temporal covariances for the specified
lags. For all tests, the sample variance and the sample spatial and temporal
marginal covariances are also computed and stored in <code>G</code></p>
</dd>
<dt><code>cova.h</code></dt><dd><p>matrix, containing the sample spatial marginal covariances
for the specified lags</p>
</dd>
<dt><code>cova.u</code></dt><dd><p>matrix, containing the sample temporal marginal covariances
for the specified lags</p>
</dd>
<dt><code>f.G</code></dt><dd><p>array, containing the computation of specific functions of the
elements of <code>G</code>, see references</p>
</dd>
<dt><code>B</code></dt><dd><p>matrix, containing the computation of the derivatives of each element
of <code>f.G</code> with respect to each element of <code>G</code></p>
</dd>
<dt><code>A</code></dt><dd><p>contrast matrix</p>
</dd>
<dt><code>beta.data</code></dt><dd><p>vector, containing the different values of the parameter beta,
available only for the test on the Gneiting class of model (<code>typetest = "gneiting"</code>)</p>
</dd>
<dt><code>typetest</code></dt><dd><p>character, contains the code of the test to be performed</p>
</dd>
</dl>


<h3>Note</h3>



<ul>
<li><p> A stop occurs if the number of spatial points fixed in <code>stpairs</code>
(object of class <code>couples</code>) is less than 2
</p>
</li>
<li><p> A stop occurs if more than 75\
series, since a large number of missing values do not guarantee the reliability
of the tests
</p>
</li></ul>




<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2018, Testing the type of
non-separability and some classes of space-time covariance function models.
Stochastic Environmental Research and Risk Assessment,
<b>32</b> 17&ndash;35
</p>
<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1&ndash;42.
</p>
<p>De Iaco, S., Palma, M., Posa, D., 2016. A general procedure for selecting a
class of fully symmetric space-time covariance functions.
Environmentrics, <b>27(4)</b> 212&ndash;224.
</p>
<p>Li, B., Genton, M.G., Sherman, M., 2007, A nonparametric assessment
of properties of spacetime covariance functions.
Journal of the American Statistical Association, <b>102</b> 736&ndash;744.
</p>


<h3>See Also</h3>

<p><a href="#topic+couples-class">couples</a>
</p>
<p><code><a href="#topic+read.STdata">read.STdata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)
#library(gstat)
data(air)
ls()
if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))
rr = rural[,"2005::2010"]
unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))
r5to10 = rr[-unsel,]
rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #

sel.staz.mod &lt;- c("DERP016", "DENW065", "DENW063", "DEHE046", "DEUB029",
"DETH061", "DENW068", "DETH026", "DENI051")

sp.couples.in.mod &lt;- matrix(data = c("DERP016", "DENW065", "DENW063", "DEHE046",
                                    "DEUB029", "DETH061", "DEHE046", "DENW063",
                                    "DERP016", "DENW068", "DETH026", "DENI051",
                                    "DEUB029", "DETH061", "DENI051", "DETH061",
                                    "DERP016", "DEUB029"),
                           ncol = 2, byrow = TRUE)

t.couples.in.mod &lt;- c(1, 2, 3)

couples.mod &lt;- couples(sel.staz = sel.staz.mod, sp.couples.in =
                        sp.couples.in.mod, t.couples.in = t.couples.in.mod,
                      typetest = "productSum", typecode = character())

zero.index &lt;- matrix(data=c(3, 7, 6, 7, 9, 7), ncol=2, byrow = TRUE)

couples.mod &lt;- setzero(x = couples.mod, zero = FALSE, index = zero.index, value = 0)

covast.ps &lt;- covastatM(matdata = rr_13, pardata1 = 1, pardata2 = 1,
                       stpairs = couples.mod, typetest = "productSum", beta.data = NULL)

### method for covastat
#1. show
covast.ps

</code></pre>

<hr>
<h2 id='read.STdata'>Imports a text file in R</h2><span id='topic+read.STdata'></span>

<h3>Description</h3>

<p>A function for importing a text file containing spatio-temporal data.
In particular, it (a) generates the spatial and temporal IDs,
(b) converts the time series of each spatial point (with non-existing values
for some dates) into a regularly spaced object
within the observed time period, by filling the missing dates with ‘NA’
(c) converts the data into a <code>STFDF</code>, according to the standard of the
<code>spacetime</code> package, or into a data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.STdata(
  file,
  header = FALSE,
  dec = ".",
  sep = "",
  iclx,
  icly,
  iclt,
  icldate = c(icl.date = 0, iclty = 0, icltm = 0, icltd = 0),
  icltime = c(icl.time = 0, icltH = 0, icltM = 0, icltS = 0),
  iclvr,
  iclsp = 0,
  missing.v = NA,
  save.as = "data.frame",
  date.format = c("code", format = NA),
  bytime = NA,
  tlag,
  time.zone = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.STdata_+3A_file">file</code></td>
<td>
<p>the name of the data file and its extension. The file is searched
in the current working directory, otherwise the absolute path has to be included
in the file name. Note that data for each spatial point and
each temporal point are given by row; each row of the file contains at least
the x and y coordinates of a spatial point, the temporal code (or date) and
the measurement of the variable of interest.</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_header">header</code></td>
<td>
<p>logical, value indicating whether the file contains the names
of the variables in the first line. If this argument is missing, header is
set to <code>FALSE</code> (default choice)</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_dec">dec</code></td>
<td>
<p>character, used to indicate decimal points</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_sep">sep</code></td>
<td>
<p>field separator character. If sep = &quot;&quot; (default choice)
columns of the file are separated by white space or tabs (see <code><a href="utils.html#topic+read.table">read.table</a></code>
for more details)</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_iclx">iclx</code></td>
<td>
<p>numeric, the column in which the x-coordinate of the spatial points are
stored</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_icly">icly</code></td>
<td>
<p>numeric, the column in which the y-coordinate of the spatial points are
stored</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_iclt">iclt</code></td>
<td>
<p>numeric, the column in which numeric temporal codes are stored.
This argument is provided  only if the <code>icldate</code> argument is not available:
<code>iclt</code> and <code>icldate</code>  are mutually exclusive. This argument is set
equal to <code>0</code>, if not available</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_icldate">icldate</code></td>
<td>
<p>numeric vector to set the columns in which the dates are stored.
The user has to set <code>icl.date</code> if the date is stored in a single column, otherwise
the user has to specify the colunn in which the years (<code>iclty</code>), the months
(<code>icltm</code>) or the days (<code>icltd</code>) are stored separately.
This argument is set equal to <code>0</code> (default choice) if not available</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_icltime">icltime</code></td>
<td>
<p>numeric vector to set the columns in which the time component
(hour, minute, second) of a date (if available) is stored. The user has to
set <code>icl.time</code> if the time is stored in a single column, otherwise the
user has to specify the column in which the hours (<code>icltH</code>), the minutes
(<code>icltM</code>) or the seconds (<code>icltS</code>) are stored separately.
This argument is set equal to <code>0</code> (default choice) if not available</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_iclvr">iclvr</code></td>
<td>
<p>numeric, the column in which the values of the variable are stored</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_iclsp">iclsp</code></td>
<td>
<p>numeric, the column in which the identification codes (IDs) for the
spatial locations are stored. This argument is set equal to <code>0</code> (default
choice) if IDs for the spatial locations are not available</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_missing.v">missing.v</code></td>
<td>
<p>code used to indicate the presence of missing values in
the imported data. By default this argument is set equal to <code>NA</code></p>
</td></tr>
<tr><td><code id="read.STdata_+3A_save.as">save.as</code></td>
<td>
<p>character, indicating the class of the data to be returned.
It is allowed to choose between two options for saving the file (<code>"STFDF"</code>
or <code>"data.frame"</code>)</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_date.format">date.format</code></td>
<td>
<p>vector, whose first element <code>date.format[1]</code> denotes the class of
the temporal component to be imported and the second one <code>date.format[2]</code> represents
the corresponding format. Note that the supported class of dates are
<code>"yearmon"</code>, <code>"yearqtr"</code>,
<code>"Date"</code>, <code>"POSIX"</code> (see <span class="pkg">Base</span>, <span class="pkg">lubridate</span>, <span class="pkg">zoo</span>);
moreover the personalized options <code>"year"</code> and <code>"code"</code> are also admissible and
are used if the temporal coordinate is given by year or as a numerical code,
respectively. By default, the argument <code>date.format</code> is set equal to <code>("code", format = NA)</code>.
If the temporal component, provided for example in year and month, is given in
separeted columns in the text file,
the required format in <code>date.format[2]</code> is of the type <code>"%Y %m"</code>;
in general the format requires the use of white spaces between two consecutive time units</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_bytime">bytime</code></td>
<td>
<p>character, which denotes the time disaggregation of interest,
set <code>NA</code> (default choice) for numeric temporal code, otherwise <code>"%Y"</code>
or <code>"%y"</code> if values are taken by year, <code>"%m"</code> if values are taken by
month, <code>"%d"</code> if values are taken by day, <code>"%q"</code> if values
are taken by quarter, <code>"%H"</code> if values are taken by hour, <code>"%M"</code>
if values are taken by minute and <code>"%S"</code> if values are taken by seconds</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_tlag">tlag</code></td>
<td>
<p>numeric, time increment/lag between two temporal observations</p>
</td></tr>
<tr><td><code id="read.STdata_+3A_time.zone">time.zone</code></td>
<td>
<p>character, time zone for dates with time component</p>
</td></tr>
</table>


<h3>Details</h3>



<ul>
<li><p> Uncomplete time series, for each spatial point, are filled with NA
</p>
</li>
<li><p> Some checks on the admissibility of the supported classes of dates are
implemented
</p>
</li>
<li><p> Time indexes for temporal points are coded for data.frame output by using
consecutive numbers starting from 1 (column 'timeIndex')
</p>
</li>
<li><p> The spatial points are coded by using the string 'id' and the consecutive numbers
starting from 1 (column 'spatialIndex')
</p>
</li></ul>




<h3>Value</h3>

<p>object of the <code>STFDF</code>-class or <code>data.frame</code>, which contains
coordinates of the spatial points, the spatial IDs, the temporal IDs, the dates
(if available in the input file) and the observed values of the variable of interest
</p>


<h3>References</h3>

<p>Bivand, R. S., Pebesma, E., Gomez-Rubio, V., 2013,
<em>Applied spatial data analysis with R</em>, Second edition. New York: Springer.
<a href="https://asdar-book.org/">https://asdar-book.org/</a>
</p>
<p>Grolemund, G, Wickham, H., 2011, Dates and Times Made Easy with lubridate.
Journal of Statistical Software, <b>40(3)</b> 1&ndash;25.
</p>
<p>Pebesma, E.J., 2012, spacetime: Spatio-Temporal Data in R.
Journal of Statistical Software, <b>51(7)</b> 1&ndash;30.
</p>
<p>Zeileis, A., Grothendieck. G., 2005, zoo: S3 Infrastructure for Regular and
Irregular Time Series.
Journal of Statistical Software, <b>14(6)</b> 1&ndash;27.
</p>


<h3>See Also</h3>

<p><code><a href="spacetime.html#topic+STFDF-class">STFDF-class</a></code>
</p>
<p><code><a href="utils.html#topic+read.table">read.table</a></code>
</p>
<p><code><a href="zoo.html#topic+yearmon">yearmon</a></code>
</p>
<p><code><a href="zoo.html#topic+yearqtr">yearqtr</a></code>
</p>
<p><code><a href="base.html#topic+Dates">Dates</a></code> for dates without times
</p>
<p><code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code>
</p>
<p><code><a href="base.html#topic+timezones">timezones</a></code> for OlsonNames
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#example 1: import a text file, with dates stored in a single column (the 4th)
# and fill missing time points in monthly time series, with time lag equal to one


## Not run
## To run example 1 paste and copy the following lines (without the symbol '#')
## in the console:
#file_date &lt;- system.file("extdata", "file_date.txt", package = "covatest")
#db.date &lt;- read.STdata(file = file_date, header = TRUE, iclx = 2, icly = 3, iclt = 0,
#icldate = c(icl.date = 4, iclty = 0, icltm = 0, icltd = 0),
#icltime = c(icl.time = 0, icltH =0, icltM = 0, icltS = 0),
#iclvr = 5, iclsp = 1, missing.v = -99999, save.as = "data.frame",
#date.format = c("Date", "%d-%m-%Y"), bytime = "%m", tlag = 1)


#example 2: import a text file, with dates and times stored in different columns
# (from the 4th to the 9th) and fill missing time points in hourly time series,
# with time lag equal to three

## Not run
## To run example 2 paste and copy the following lines (without the symbol '#')
## in the console:
#file_datetime &lt;- system.file("extdata", "file_datetime.txt", package = "covatest")
#db.datetime &lt;- read.STdata(file = file_datetime, header = TRUE, iclx = 2, icly = 3, iclt = 0,
#icldate = c(icl.date = 0, iclty = 6, icltm = 5, icltd = 4),
#icltime = c(icl.time = 0, icltH = 7, icltM = 8, icltS = 9),
#iclvr = 10, iclsp = 1, missing.v = -99999, save.as = "data.frame",
#date.format = c("POSIX", "%Y %m %d %H %M %S"), bytime = "%H", tlag = 3)


#example 3: import a text file, with dates and times stored in different columns
# (from the 4th to the 9th) and fill missing time points in quarterly time series,
# with time lag equal to one

## Not run
## To run example 3 paste and copy the following lines (without the symbol '#')
## in the console:
#file_yq &lt;- system.file("extdata", "file_yq.txt", package = "covatest")
#db.yq &lt;- read.STdata(file = file_yq, header = TRUE, iclx = 2, icly = 3, iclt = 0,
#icldate = c(icl.date = 4, iclty = 0, icltm = 0, icltd = 0),
#icltime = c(icl.time = 0, icltH =0, icltM = 0, icltS = 0),
#iclvr = 5, iclsp = 1, missing.v = -99999, save.as = "data.frame",
#date.format = c("yearqtr", "%Y-Q%q"), bytime = "%q", tlag = 1)


</code></pre>

<hr>
<h2 id='sepindex-class'>Class &quot;sepindex&quot;</h2><span id='topic+sepindex-class'></span><span id='topic+sepindex'></span><span id='topic+boxplot+2Csepindex-method'></span><span id='topic+sepindex-method'></span><span id='topic+show+2Csepindex-method'></span><span id='topic++5B+2Csepindex-method'></span><span id='topic+summary+2Csepindex-method'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>A class for the non separability index (r) for different spatial
and temporal lags:
\[r(\mathbf{h}, u, \Theta)= \rho(\mathbf{h}, u;\Theta)/ [\rho(\mathbf{h},0;\Theta)\rho(\mathbf{0},u;\Theta)]\]
with \(\rho(\mathbf{h}, u;\Theta)>0\);
\(\rho(\mathbf{h},0;\Theta)>0\) and
\(\rho(\mathbf{0},u;\Theta)>0\).
On the basis of this index, the type of non separability of the covariance
function can be analyzed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sepindex(vario_st, nt, ns, globalSill)

## S4 method for signature 'sepindex'
boxplot(x, ...)

## S4 method for signature 'sepindex'
show(object)

## S4 method for signature 'sepindex'
x[i, j, drop = FALSE]

## S4 method for signature 'sepindex'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sepindex-class_+3A_vario_st">vario_st</code></td>
<td>
<p>object of class <code>StVariogram</code>, containing the
spatio-temporal sample variogram, output from the function <code>variogramST</code>
of the package <code>gstat</code></p>
</td></tr>
<tr><td><code id="sepindex-class_+3A_nt">nt</code></td>
<td>
<p>integer, the number of temporal lags in <code>vario_st</code></p>
</td></tr>
<tr><td><code id="sepindex-class_+3A_ns">ns</code></td>
<td>
<p>integer, the number of spatial lags in <code>vario_st</code></p>
</td></tr>
<tr><td><code id="sepindex-class_+3A_globalsill">globalSill</code></td>
<td>
<p>numeric, the value of the sample variance</p>
</td></tr>
<tr><td><code id="sepindex-class_+3A_x">x</code></td>
<td>
<p>object of class <code>sepindex</code> for methods <code>boxplot</code> and <code>extract</code></p>
</td></tr>
<tr><td><code id="sepindex-class_+3A_...">...</code></td>
<td>
<p>any arguments that will be passed to the panel plotting functions</p>
</td></tr>
<tr><td><code id="sepindex-class_+3A_object">object</code></td>
<td>
<p>object of class <code>sepindex</code> for methods <code>show</code> and <code>summary</code></p>
</td></tr>
<tr><td><code id="sepindex-class_+3A_i">i</code></td>
<td>
<p>index specifying elements to extract. Each row includes data for specific
spatio-temporal lags</p>
</td></tr>
<tr><td><code id="sepindex-class_+3A_j">j</code></td>
<td>
<p>index specifying elements to extract. Set <code>1</code> for spatial lags (hs),
<code>2</code> for temporal lags (ht) and <code>3</code> for the nonseparability index
(SepIndex)</p>
</td></tr>
<tr><td><code id="sepindex-class_+3A_drop">drop</code></td>
<td>
<p>logical, the argument is set, by default, equal to <code>FALSE</code> to
preserve the structure of the object. It is advisable not to change this option</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>sep.index.ratio</code></dt><dd><p>the empirical non separability index ratio and the
corresponding spatio-temporal lags</p>
</dd>
<dt><code>cov.st</code></dt><dd><p>the spatio-temporal sample covariance function and the
corresponding spatio-temporal lags</p>
</dd>
<dt><code>cov.tm</code></dt><dd><p>the purely temporal sample covariance function and the
corresponding temporal lags</p>
</dd>
<dt><code>cov.sp</code></dt><dd><p>the purely spatial sample covariance function and the
corresponding spatial lags</p>
</dd>
</dl>


<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1&ndash;42.
</p>
<p>De Iaco, S., Posa, D., 2013, Positive and negative non-separability
for space-time covariance models. Journal of Statistical Planning and
Inference, <b>143</b> 378&ndash;391.
</p>
<p>Gräler, B., Pebesma, E.J., Heuvelink G., 2016, Spatio-Temporal
Interpolation Using gstat. The R Journal, <b>8(1)</b> 204&ndash;218.
</p>
<p>Pebesma, E.J., 2004, Multivariable geostatistics in S: the gstat
package. Computers &amp; Geosciences, <b>30</b> 683&ndash;691.
</p>
<p>Rodriguez, A., Diggle, P.J., 2010, A class of convolution-based
models for spatio-temporal processes with non-separable covariance structure.
Scandinavian Journal of Statistics, <b>37(4)</b> 553&ndash;567.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)
#library(gstat)
data(air)
ls()
if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))
rr = rural[,"2005::2010"]
unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))
r5to10 = rr[-unsel,]
rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #

#compute the Global Sill
C00_13 &lt;- var(rr_13[,,"PM10"]@data[[1]], na.rm = TRUE)

#estimate the spatio-temporal variogram by using the function variogramST
#of the package gstat.
#For this aim see vv_13.Rd
data(vv_13)
nonsep.index &lt;- sepindex(vario_st = vv_13, nt = 16, ns = 4, globalSill = C00_13)

##methods for sepindex

#1. show
nonsep.index

#2. summary
summary(nonsep.index)

#3. boxplot
boxplot(nonsep.index, ylab="Non-separability ratio")

#4. [ extract
nonsep.index[1:8, ] #selection of the first 8 rows
nonsep.index[1:8, 1:2] #selection of the first 2 columns
</code></pre>

<hr>
<h2 id='setzero'>setzero</h2><span id='topic+setzero'></span><span id='topic+setzero+2Ccouples-method'></span><span id='topic+setzero+2CANY+2CANY-method'></span>

<h3>Description</h3>

<p>Through the function <a href="#topic+couples">couples</a>, <code>m</code> spatial couples and <code>n</code>
temporal lags are provided, hence a set of <code>m x n</code> spatio-temporal lags
are defined. If some of these lags are not required for the specific test, they
can be set equal to zero by using the <code>setzero</code> method for object of class
<code>couples</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setzero(x, zero = TRUE, index = NULL, value)

## S4 method for signature 'couples'
setzero(x, zero = TRUE, index = NULL, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setzero_+3A_x">x</code></td>
<td>
<p>object of class <code>couples</code></p>
</td></tr>
<tr><td><code id="setzero_+3A_zero">zero</code></td>
<td>
<p>logical, if <code>TRUE</code> (the default) all negative temporal
lags are replaced with zero. If <code>x@typetest</code> is equal to
<code>"sym"</code> (symmetry test) the argument <code>setzero</code> is ignored because
both positive and negative temporal lags are required for computing the test</p>
</td></tr>
<tr><td><code id="setzero_+3A_index">index</code></td>
<td>
<p>two column matrix. Each row of the matrix <code>index</code> contains
the specific row and column, of the slot <code>@couples.st</code>, for which the
spatio-temporal covariance is not required</p>
</td></tr>
<tr><td><code id="setzero_+3A_value">value</code></td>
<td>
<p>numeric, the value to be replaced. Note that this method is reasonable
to be used only to replace a value equal to zero</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+couples">couples</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

zero.index &lt;- matrix(data=c(1,3,1,4,2,5,2,6), ncol=2, byrow = TRUE)

setzero(couples.sym, zero = FALSE, index = zero.index, value = 0)

</code></pre>

<hr>
<h2 id='vv_13'>Precomputed variogram for PM10 in data set air</h2><span id='topic+vv_13'></span>

<h3>Description</h3>

<p>Precomputed variogram for PM10 in a subset of the air quality data set
<code><a href="spacetime.html#topic+air">air</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vv_13)
</code></pre>


<h3>Format</h3>

<p>Object of class StVariogram
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)


data(air)

ls()

if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))

rr &lt;- rural[,"2005::2010"]

unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))

r5to10 = rr[-unsel,]

rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #

## Not run
## To estimate the spatio-temporal variogram, paste and copy the following lines
## (without the symbol '#') in the console:
#
## vv_13 is obtained by running the function variogramST of the package gstat,
## as follows
#
# vv_13 &lt;- gstat::variogramST(PM10~1, rr_13, width=60, cutoff = 220, tlags=0:15)
## End (Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
