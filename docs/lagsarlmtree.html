<!DOCTYPE html><html><head><title>Help for package lagsarlmtree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lagsarlmtree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GrowthNUTS2'><p>Determinants of Regional Economic Growth</p></a></li>
<li><a href='#lagsarlmtree'><p>Spatial Lag Model Trees</p></a></li>
<li><a href='#WeightsNUTS2'><p>Spatial Weights for European Union NUTS2 Regions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Spatial Lag Model Trees</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-04-06</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-1</td>
</tr>
<tr>
<td>Description:</td>
<td>Model-based linear model trees adjusting for spatial correlation using a
             simultaneous autoregressive spatial lag, Wagner and Zeileis (2019)
	     &lt;<a href="https://doi.org/10.1111%2Fgeer.12146">doi:10.1111/geer.12146</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0), partykit, spatialreg</td>
</tr>
<tr>
<td>Imports:</td>
<td>Formula (&ge; 1.2-1)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-06 20:03:40 UTC; zeileis</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Wagner [aut],
  Achim Zeileis <a href="https://orcid.org/0000-0003-0918-3766"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Roger Bivand <a href="https://orcid.org/0000-0003-2392-6140"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Achim Zeileis &lt;Achim.Zeileis@R-project.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-08 08:36:49 UTC</td>
</tr>
</table>
<hr>
<h2 id='GrowthNUTS2'>Determinants of Regional Economic Growth</h2><span id='topic+GrowthNUTS2'></span>

<h3>Description</h3>

<p>Growth regression data for NUTS2 regions in the European Union.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("GrowthNUTS2")</code></pre>


<h3>Format</h3>

<p>A data frame containing 255 observations on 58 variables.
</p>

<dl>
<dt>ggdpcap</dt><dd><p>numeric. Average annual growth rate of real GDP per capita over the period 1995-2005.</p>
</dd>
<dt>accessair</dt><dd><p>numeric. Measure for potential accessability by air.</p>
</dd>
<dt>accessrail</dt><dd><p>numeric. Measure for potential accessability by rail.</p>
</dd>
<dt>accessroad</dt><dd><p>numeric. Measure for potential accessability by road.</p>
</dd>
<dt>airportdens</dt><dd><p>numeric. Airport density (number of airports per sqkm).</p>
</dd>
<dt>airports</dt><dd><p>factor. Number of airports.</p>
</dd>
<dt>arh0</dt><dd><p>numeric. Initial activity rate, highly educated.</p>
</dd>
<dt>arl0</dt><dd><p>numeric. Initial activity rate, low educated.</p>
</dd>
<dt>arm0</dt><dd><p>numeric. Initial activity rate, medium educated.</p>
</dd>
<dt>art0</dt><dd><p>numeric. Initial activity rate, total.</p>
</dd>
<dt>capital</dt><dd><p>factor. Does the region host country capital city?</p>
</dd>
<dt>connectair</dt><dd><p>numeric. Connectivity to comm. airports by car of the capital or centroid of region.</p>
</dd>
<dt>connectsea</dt><dd><p>numeric. Connectivity to comm. seaports by car of the capital or centroid of region.</p>
</dd>
<dt>distcap</dt><dd><p>numeric. Distance to capital city of respective country.</p>
</dd>
<dt>distde71</dt><dd><p>numeric. Distance to Frankfurt.</p>
</dd>
<dt>empdens0</dt><dd><p>numeric. Initial employment density.</p>
</dd>
<dt>ereh0</dt><dd><p>numeric. Initial employment rate, highly educated.</p>
</dd>
<dt>erel0</dt><dd><p>numeric. Initial employment rate, low educated.</p>
</dd>
<dt>erem0</dt><dd><p>numeric. Initial employment rate, medium educated.</p>
</dd>
<dt>eret0</dt><dd><p>numeric. Initial employment rate, total.</p>
</dd>
<dt>gdpcap0</dt><dd><p>numeric. Real GDP per capita in logs in 1995.</p>
</dd>
<dt>gpop</dt><dd><p>numeric. Growth rate of population.</p>
</dd>
<dt>hazard</dt><dd><p>numeric. Sum of all weighted hazard values.</p>
</dd>
<dt>hrstcore</dt><dd><p>numeric. Human resources in science and technology (core).</p>
</dd>
<dt>intf</dt><dd><p>numeric. Proportion of firms with own website regression.</p>
</dd>
<dt>outdens0</dt><dd><p>numeric. Initial output density.</p>
</dd>
<dt>popdens0</dt><dd><p>numeric. Initial population density.</p>
</dd>
<dt>raildens</dt><dd><p>numeric. Rail density (length of railroad network in km per sqkm).</p>
</dd>
<dt>regboarder</dt><dd><p>factor. Border region?</p>
</dd>
<dt>regcoast</dt><dd><p>factor. Coastal region?</p>
</dd>
<dt>regobj1</dt><dd><p>factor. Is the region within an Objective 1 region?</p>
</dd>
<dt>regpent27</dt><dd><p>factor. Pentagon EU 27 region? (London, Paris, Munich, Milan, Hamburg.)</p>
</dd>
<dt>roaddens</dt><dd><p>numeric. Road density (length of road network in km per sqkm).</p>
</dd>
<dt>seaports</dt><dd><p>factor. Does the region have a seaport?</p>
</dd>
<dt>settl</dt><dd><p>factor. Settlement structure.</p>
</dd>
<dt>shab0</dt><dd><p>numeric. Initial share of NACE A and B (Agriculture) in GVA.</p>
</dd>
<dt>shce0</dt><dd><p>numeric. Initial share of NACE C to E (Mining, Manufacturing and Energy) in GVA.</p>
</dd>
<dt>shgfcf</dt><dd><p>numeric. Share of gross fixed capital formation in gross value added.</p>
</dd>
<dt>shjk0</dt><dd><p>numeric. Initial share of NACE J to K (Business services) in GVA.</p>
</dd>
<dt>shsh</dt><dd><p>numeric. Share of highly educated in working age population.</p>
</dd>
<dt>shsl</dt><dd><p>numeric. Share of low educated in working age population.</p>
</dd>
<dt>shlll</dt><dd><p>numeric. Life long learning.</p>
</dd>
<dt>shsm</dt><dd><p>numeric. Share of medium educated in working age population.</p>
</dd>
<dt>telf</dt><dd><p>factor. A typology of estimated levels of business telecommunications access and uptake.</p>
</dd>
<dt>temp</dt><dd><p>numeric. Extreme temperatures.</p>
</dd>
<dt>urh0</dt><dd><p>numeric. Initial unemployment rate, highly educated.</p>
</dd>
<dt>url0</dt><dd><p>numeric. Initial unemployment rate, low educated.</p>
</dd>
<dt>urm0</dt><dd><p>numeric. Initial unemployment rate, medium educated.</p>
</dd>
<dt>urt0</dt><dd><p>numeric. Initial unemployment rate, total.</p>
</dd>
<dt>country</dt><dd><p>factor. Country within which the region is located.</p>
</dd>
<dt>cee</dt><dd><p>factor. Is the region within a Central and Eastearn European country?</p>
</dd>
<dt>piigs</dt><dd><p>factor. Is the region within a PIIGS country? (Portugal, Ireland, Italy, Greece, Spain.)</p>
</dd>
<dt>de</dt><dd><p>factor. Is the region within Germany?</p>
</dd>
<dt>es</dt><dd><p>factor. Is the region within Spain?</p>
</dd>
<dt>fr</dt><dd><p>factor. Is the region within France?</p>
</dd>
<dt>it</dt><dd><p>factor. Is the region within Italy?</p>
</dd>
<dt>pl</dt><dd><p>factor. Is the region within Poland?</p>
</dd>
<dt>uk</dt><dd><p>factor. Is the region within the United Kingdom?</p>
</dd>
</dl>



<h3>References</h3>

<p>Schneider U, Wagner M (2012).
Catching Growth Determinants with the Adaptive Lasso.
<em>German Economic Review</em>, <b>13</b>(1), 71-85.
doi: <a href="http://doi.org/10.1111/j.1468-0475.2011.00541.x">10.1111/j.1468-0475.2011.00541.x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("GrowthNUTS2")
summary(GrowthNUTS2)
</code></pre>

<hr>
<h2 id='lagsarlmtree'>Spatial Lag Model Trees</h2><span id='topic+lagsarlmtree'></span><span id='topic+print.lagsarlmtree'></span><span id='topic+plot.lagsarlmtree'></span><span id='topic+coef.lagsarlmtree'></span><span id='topic+logLik.lagsarlmtree'></span><span id='topic+predict.lagsarlmtree'></span><span id='topic+sctest.lagsarlmtree'></span><span id='topic+impacts.lagsarlmtree'></span>

<h3>Description</h3>

<p>Model-based recursive partitioning based on linear regression
adjusting for a (global) spatial simultaneous autoregressive lag.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lagsarlmtree(formula, data, listw = NULL, method = "eigen",
  zero.policy = NULL, interval = NULL, control = list(),
  rhowystart = NULL, abstol = 0.001, maxit = 100, 
  dfsplit = TRUE, verbose = FALSE, plot = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lagsarlmtree_+3A_formula">formula</code></td>
<td>
<p>formula specifying the response variable and regressors
and partitioning variables, respectively. For details see below.</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_data">data</code></td>
<td>
<p>data.frame to be used for estimating the model tree.</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_listw">listw</code></td>
<td>
<p>a weights object for the spatial lag part of the model.</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_method">method</code></td>
<td>
<p>&quot;eigen&quot; (default) - the Jacobian is computed as the product 
of (1 - rho*eigenvalue) using <code>eigenw</code>, and &quot;spam&quot; or &quot;Matrix_J&quot; for strictly symmetric weights lists of styles &quot;B&quot; and &quot;C&quot;, or made symmetric by similarity (Ord, 1975, Appendix C) if possible for styles &quot;W&quot; and &quot;S&quot;, using code from the spam or Matrix packages to calculate the determinant; &ldquo;Matrix&rdquo; and &ldquo;spam_update&rdquo; provide updating Cholesky decomposition methods; &quot;LU&quot; provides an alternative sparse matrix decomposition approach. In addition, there are &quot;Chebyshev&quot; and Monte Carlo &quot;MC&quot; approximate log-determinant methods; the Smirnov/Anselin (2009) trace approximation is available as &quot;moments&quot;. Three methods: &quot;SE_classic&quot;, &quot;SE_whichMin&quot;, and &quot;SE_interp&quot; are provided experimentally, the first to attempt to emulate the behaviour of Spatial Econometrics toolbox ML fitting functions. All use grids of log determinant values, and the latter two attempt to ameliorate some features of &quot;SE_classic&quot;.
</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_zero.policy">zero.policy</code></td>
<td>
<p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without 
neighbours, if FALSE (default) assign NA - causing <code>lagsarlm()</code> to terminate with an error</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_interval">interval</code></td>
<td>
<p>default is NULL, search interval for autoregressive parameter</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_control">control</code></td>
<td>
<p>list of extra control arguments - see <code><a href="spdep.html#topic+lagsarlm">lagsarlm</a></code></p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_rhowystart">rhowystart</code></td>
<td>
<p>numeric. A vector of length <code>nrow(data)</code>, to be used as
an offset in estimation of the first tree. <code>NULL</code> by default,
which results in an initialization with the root model (without partitioning).</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_abstol">abstol</code></td>
<td>
<p>numeric. The convergence criterion used for estimation of the model.
When the difference in log-likelihoods of the model from two consecutive
iterations is smaller than <code>abstol</code>, estimation of the model tree has
converged.</p>
</td></tr> 
<tr><td><code id="lagsarlmtree_+3A_maxit">maxit</code></td>
<td>
<p>numeric. The maximum number of iterations to be performed in
estimation of the model tree.</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_dfsplit">dfsplit</code></td>
<td>
<p>logical or numeric. <code>as.integer(dfsplit)</code> is the
degrees of freedom per selected split employed when extracting
the log-likelihood.</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_verbose">verbose</code></td>
<td>
<p>Should the log-likelihood value of the estimated
model be printed for every iteration of the estimation?</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_plot">plot</code></td>
<td>
<p>Should the tree be plotted at every iteration of the estimation?
Note that selecting this option slows down execution of the function.</p>
</td></tr>
<tr><td><code id="lagsarlmtree_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>lmtree()</code>.
See <code><a href="partykit.html#topic+mob_control">mob_control</a></code> documentation for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Spatial lag trees learn a tree where each terminal node is associated with
different regression coefficients while adjusting for a (global) spatial
simultaneous autoregressive lag. This allows for detection of subgroup-specific
coefficients with respect to selected covariates, while adjusting for spatial
correlations in the data. The estimation algorithm iterates between (1) estimation
of the tree given an offset of the spatial lag effect, and (2) estimation of the
spatial lag model given the tree structure.
</p>
<p>The code is still under development and might change in future versions.
</p>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>
<table>
<tr><td><code>formula</code></td>
<td>
<p>The formula as specified with the <code>formula</code> argument.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>tree</code></td>
<td>
<p>The final <code>lmtree</code>.</p>
</td></tr>
<tr><td><code>lagsarlm</code></td>
<td>
<p>The final <code>lagsarlm</code> model.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The dataset specified with the <code>data</code> argument
including added auxiliary variables <code>.rhowy</code> and <code>.tree</code>
from the last iteration.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>The log-likelihood value of the last iteration.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Degrees of freedom.</p>
</td></tr>
<tr><td><code>dfsplit</code></td>
<td>
<p>degrees of freedom per selected split as specified with the <code>dfsplit</code>
argument.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>The number of iterations used to estimate the <code>lagsarlmtree</code>.</p>
</td></tr> 
<tr><td><code>maxit</code></td>
<td>
<p>The maximum number of iterations specified with the <code>maxit</code> argument.</p>
</td></tr>
<tr><td><code>rhowystart</code></td>
<td>
<p>Offset in estimation of the first tree as specified in the <code>rhowystart</code> 
argument.</p>
</td></tr>
<tr><td><code>abstol</code></td>
<td>
<p>The prespecified value for the change in log-likelihood to evaluate
convergence, as specified with the <code>abstol</code> argument.</p>
</td></tr> 
<tr><td><code>listw</code></td>
<td>
<p>The <code>listw</code> object used.</p>
</td></tr>
<tr><td><code>mob.control</code></td>
<td>
<p>A list containing control parameters passed to
<code>lmtree()</code>, as specified with ....</p>
</td></tr>
</table>


<h3>References</h3>

 
<p>Wagner M, Zeileis A (2019).
Heterogeneity and Spatial Dependence of Regional Growth in the EU: A Recursive Partitioning Approach.
German Economic Review, <b>20</b>(1), 67&ndash;82.
doi: <a href="http://doi.org/10.1111/geer.12146">10.1111/geer.12146</a>
<a href="https://eeecon.uibk.ac.at/~zeileis/papers/Wagner+Zeileis-2019.pdf">https://eeecon.uibk.ac.at/~zeileis/papers/Wagner+Zeileis-2019.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="spdep.html#topic+lagsarlm">lagsarlm</a></code>, <code><a href="partykit.html#topic+lmtree">lmtree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## data and spatial weights
data("GrowthNUTS2", package = "lagsarlmtree")
data("WeightsNUTS2", package = "lagsarlmtree")

## spatial lag model tree
system.time(tr &lt;- lagsarlmtree(ggdpcap ~ gdpcap0 + shgfcf + shsh + shsm |
    gdpcap0 + accessrail + accessroad + capital + regboarder + regcoast + regobj1 + cee + piigs,
  data = GrowthNUTS2, listw = WeightsNUTS2$invw,
  minsize = 12, alpha = 0.05))
print(tr)
plot(tr, tp_args = list(which = 1))

## query coefficients
coef(tr, model = "tree")
coef(tr, model = "rho")
coef(tr, model = "all")
system.time({
ev &lt;- eigenw(WeightsNUTS2$invw)
tr1 &lt;- lagsarlmtree(ggdpcap ~ gdpcap0 + shgfcf + shsh + shsm |
    gdpcap0 + accessrail + accessroad + capital + regboarder + regcoast + regobj1 + cee + piigs,
  data = GrowthNUTS2, listw = WeightsNUTS2$invw, method = "eigen",
  control = list(pre_eig = ev), minsize = 12, alpha = 0.05)
})
coef(tr1, model = "rho")
</code></pre>

<hr>
<h2 id='WeightsNUTS2'>Spatial Weights for European Union NUTS2 Regions</h2><span id='topic+WeightsNUTS2'></span>

<h3>Description</h3>

<p>Spatial weight matrices for NUTS2 regions in the European Union.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("WeightsNUTS2")</code></pre>


<h3>Format</h3>

<p>A list containing 40 listw weight matrices.
</p>


<h3>Source</h3>

<p>Journal of Applied Econometrics Data Archive. 
</p>
<p><a href="http://qed.econ.queensu.ca/jae/2013-v28.4/cuaresma-feldkircher/">http://qed.econ.queensu.ca/jae/2013-v28.4/cuaresma-feldkircher/</a>
</p>


<h3>References</h3>

<p>Crespo Cuaresma J, Feldkircher M (2013).
Spatial Filtering, Model Uncertainty and the Speed of Income Convergence in Europe.
<em>Journal of Applied Econometrics</em>, <b>28</b>(4), 720-741.
doi: <a href="http://doi.org/10.1002/jae.2277">10.1002/jae.2277</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
