<!DOCTYPE html><html><head><title>Help for package rifreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rifreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#check_weights'><p>Check weights</p></a></li>
<li><a href='#compute_generalized_lorenz_ordinates'><p>Generalized Lorenz ordinates</p></a></li>
<li><a href='#compute_gini'><p>Compute Gini coefficient</p></a></li>
<li><a href='#compute_weighted_ecdf'><p>Weighted ECDF value</p></a></li>
<li><a href='#get_rif'><p>Estimate Recentered Influence Functions</p></a></li>
<li><a href='#get_rif_gini'><p>Estimate RIF of Gini coefficient</p></a></li>
<li><a href='#get_rif_interquantile_range'><p>Estimate RIF of interquantile range</p></a></li>
<li><a href='#get_rif_interquantile_ratio'><p>Estimate RIF of interquantile ratio</p></a></li>
<li><a href='#get_rif_mean'><p>Estimate RIF at the Mean</p></a></li>
<li><a href='#get_rif_quantiles'><p>Estimate RIF at Quantiles</p></a></li>
<li><a href='#get_rif_variance'><p>Estimate RIF of variance</p></a></li>
<li><a href='#integrate_generalized_lorenz_curve'><p>Integrate generalized Lorenz curve</p></a></li>
<li><a href='#men8385'><p>Sample of male wage data from the CPS 1983-1985</p></a></li>
<li><a href='#plot.rifreg'><p>Plot the coefficients of a <code>rifreg</code> object</p></a></li>
<li><a href='#print.rifreg'><p>Print method for class &quot;rifreg&quot;</p></a></li>
<li><a href='#rifreg'><p>RIF regression</p></a></li>
<li><a href='#summary.rifreg'><p>summary method for class &quot;rifreg&quot;</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimate Recentered Influence Function Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Samuel Meier &lt;samuel.meier+cran@immerda.ch&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to compute recentered influence functions
    (RIF) of a distributional variable at the mean, quantiles, variance,
    gini or any custom functional of interest. The package allows to
    regress the RIF on any number of covariates. Generic print, plot and
    summary functions are also provided. Reference: Firpo, Sergio, Nicole M. Fortin, and Thomas Lemieux. (2009) &lt;<a href="https://doi.org/10.3982%2FECTA6822">doi:10.3982/ECTA6822</a>&gt;. "Unconditional Quantile Regressions.".</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>ggplot2, R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Formula, Hmisc, methods, parallel, pbapply, sandwich, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-30 12:57:59 UTC; tercy</td>
</tr>
<tr>
<td>Author:</td>
<td>David Gallusser [aut],
  Samuel Meier [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-01 18:42:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='check_weights'>Check weights</h2><span id='topic+check_weights'></span>

<h3>Description</h3>

<p>Helper function to check a weights vector. Makes sure the weights
are positive numeric values (not all zeros) and of the same length as the
dependent variable <code>dep_var</code>. Replaces all <code>NA</code>s with 0 and sets
all weights to 1 if weights is set to NULL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_weights(dep_var, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_weights_+3A_dep_var">dep_var</code></td>
<td>
<p>dependent variable of distributional function.
Can be any discrete or continuous vector of length 1 or more.</p>
</td></tr>
<tr><td><code id="check_weights_+3A_weights">weights</code></td>
<td>
<p>positive numeric vector of <code>length(dep_var)</code>
containing the weights or <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>positive numeric vector of <code>length(dep_var)</code>
containing the checked weights. If <code>weights = NULL</code>, all weights are set to 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dep_var &lt;- c(1, 3, 9, 16, 3, 7, 4, 9)
weights &lt;- c(2, 1, 3, 4, 4, 1, 6, 3)
check_weights(dep_var, weights)

</code></pre>

<hr>
<h2 id='compute_generalized_lorenz_ordinates'>Generalized Lorenz ordinates</h2><span id='topic+compute_generalized_lorenz_ordinates'></span>

<h3>Description</h3>

<p>Compute the generalized Lorenz ordinates of <code>dep_var</code> (i.e. the
share of total income observations up to each value in <code>dep_var</code> amass
scaled by the mean income).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_generalized_lorenz_ordinates(dep_var, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_generalized_lorenz_ordinates_+3A_dep_var">dep_var</code></td>
<td>
<p>dependent variable of a distributional function. Discrete or continuous numeric vector.</p>
</td></tr>
<tr><td><code id="compute_generalized_lorenz_ordinates_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>thes generalized Lorenz ordinates for a vector <code>dep_var</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dep_var &lt;- c(1, 3, 9, 16, 3, 7, 4, 9)
weights &lt;- c(2, 1, 3, 4, 4, 1, 6, 3)
generalized_lorenz_ordinates &lt;-
  compute_generalized_lorenz_ordinates(
    dep_var = dep_var,
    weights = weights
  )

</code></pre>

<hr>
<h2 id='compute_gini'>Compute Gini coefficient</h2><span id='topic+compute_gini'></span>

<h3>Description</h3>

<p>Compute a weighted Gini coefficient by integrating the
generalized Lorenz curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_gini(dep_var, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_gini_+3A_dep_var">dep_var</code></td>
<td>
<p>values of a non-negative continuous variable</p>
</td></tr>
<tr><td><code id="compute_gini_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The numeric value indicating the weighted Gini coefficient of the the dependent variable.
</p>


<h3>References</h3>

<p>Firpo, Sergio P., Nicole M. Fortin, and Thomas Lemieux. 2018. “Decomposing Wage Distributions Using Recentered
Influence Function Regressions.” <em>Econometrics</em> 6(2), 28.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
dep_var &lt;- rlnorm(100)
weights &lt;- rep(1, 100)
compute_gini(dep_var, weights)

</code></pre>

<hr>
<h2 id='compute_weighted_ecdf'>Weighted ECDF value</h2><span id='topic+compute_weighted_ecdf'></span>

<h3>Description</h3>

<p>Compute values of the ECDF for a vector <code>dep_var</code> (i.e. the
empirical probability for each observation in <code>dep_var</code> that a value
in <code>dep_var</code> is smaller or equal).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_weighted_ecdf(dep_var, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_weighted_ecdf_+3A_dep_var">dep_var</code></td>
<td>
<p>dependent variable of a distributional function. Discrete or continuous numeric vector.</p>
</td></tr>
<tr><td><code id="compute_weighted_ecdf_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the values of ECDF for a vector <code>dep_var</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dep_var &lt;- c(1, 3, 9, 16, 3, 7, 4, 9)
weights &lt;- c(2, 1, 3, 4, 4, 1, 6, 3)
value_of_ecdf &lt;-
  compute_weighted_ecdf(
    dep_var = dep_var,
    weights = weights
  )

</code></pre>

<hr>
<h2 id='get_rif'>Estimate Recentered Influence Functions</h2><span id='topic+get_rif'></span>

<h3>Description</h3>

<p>This function estimates the recentered influence function (RIF) of a chosen distributional statistic
(e.g. quantiles, variance or gini).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rif(
  dep_var,
  weights = NULL,
  statistic,
  probs = NULL,
  custom_rif_function = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rif_+3A_dep_var">dep_var</code></td>
<td>
<p>dependent variable of distributional function. Discrete or continuous numeric vector.</p>
</td></tr>
<tr><td><code id="get_rif_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.
The default (<code>NULL)</code> is equivalent to <code>weights = rep(1, length(dep_var))</code>.</p>
</td></tr>
<tr><td><code id="get_rif_+3A_statistic">statistic</code></td>
<td>
<p>string containing the distributional statistic for which to compute the RIF. Can be one of
&quot;mean&quot;, &quot;variance&quot;, &quot;quantiles&quot;, &quot;gini&quot;, &quot;interquantile_range&quot;, &quot;interquantile_ratio&quot;, or &quot;custom&quot;. If &quot;custom&quot;
is selected a <code>custom_rif_function</code> needs to be provided.</p>
</td></tr>
<tr><td><code id="get_rif_+3A_probs">probs</code></td>
<td>
<p>a vector of length 1 or more with quantile positions to calculate the RIF.
Each quantile is indicated with value between 0 and 1. Only required if <code>statistic = "quantiles"</code>.</p>
</td></tr>
<tr><td><code id="get_rif_+3A_custom_rif_function">custom_rif_function</code></td>
<td>
<p>the RIF function to compute the RIF of the custom distributional statistic.
Default is NULL. Only needs to be provided if <code>statistic = "custom"</code>.
Every custom_rif_function needs the parameters <code>dep_var</code>, <code>weights</code> and <code>probs</code>.
If they are not needed they must be set to NULL in the function definition (e.g. <code>probs = NULL</code>).
A custom function must return a data frame containing at least a &quot;rif&quot; and &quot;weights&quot; column.
See <code>examples</code> for further details.</p>
</td></tr>
<tr><td><code id="get_rif_+3A_...">...</code></td>
<td>
<p>additional parameters passed to the <code>custom_rif_function</code>.
Apart from <code>dep_var</code>, <code>weights</code> and <code>probs</code> they must have a different name than the the ones in
<code>rif</code>. For instance, if you want to pass a parameter <code>statistic</code> to the
<code>custom_rif_function</code>, name it <code>custom_statistic</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with the RIF value for each observation and in the case of several quantiles
a column for each quantile.
</p>


<h3>References</h3>

<p>Firpo, Sergio P., Nicole M. Fortin, and Thomas Lemieux. 2009. “Unconditional Quantile
Regressions.” <em>Econometrica</em> 77(3): 953–73.
</p>
<p>Cowell, Frank A., and Emmanuel Flachaire. 2015. “Statistical Methods for Distributional Analysis.”
In Anthony B. Atkinson and François Bourguignon (eds.), <em>Handbook of Income Distribution</em>. Amsterdam: Elsevier.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dep_var &lt;- c(1, 3, 9, 16, 3, 7, 4, 9)
probs &lt;- seq(1:9) / 10
weights &lt;- c(2, 1, 3, 4, 4, 1, 6, 3)
rif &lt;- get_rif(
  dep_var = dep_var,
  weights = weights,
  statistic = "quantiles",
  probs = probs
)

# custom function
custom_variance_function &lt;- function(dep_var, weights, probs = NULL) {
  weighted_mean &lt;- weighted.mean(x = dep_var, w = weights)
  rif &lt;- (dep_var - weighted_mean)^2
  rif &lt;- data.frame(rif, weights)
  names(rif) &lt;- c("rif_variance", "weights")
  return(rif)
}

set.seed(123)
dep_var &lt;- rlnorm(100)
weights &lt;- rep(1, 100)

# custom function top 10% percent income share
# (see Essam-Nassah &amp; Lambert, 2012, and Rios-Avila, 2020)
custom_top_income_share_function &lt;- function(dep_var, weights, probs = 0.1) {
  probs &lt;- 1 - probs
  weighted_mean &lt;- weighted.mean(x = dep_var, w = weights)
  weighted_quantile &lt;- Hmisc::wtd.quantile(x = dep_var, weights = weights, probs = probs)
  lorenz_ordinate &lt;-
    sum(dep_var[which(dep_var &lt;= weighted_quantile)] *
      weights[which(dep_var &lt;= weighted_quantile)]) / sum(dep_var * weights)
  if_lorenz_ordinate &lt;- -(dep_var / weighted_mean) * lorenz_ordinate +
    ifelse(dep_var &lt; weighted_quantile,
      dep_var - (1 - probs) * weighted_quantile,
      probs * weighted_quantile
    ) / weighted_mean
  rif_top_income_share &lt;- (1 - lorenz_ordinate) - if_lorenz_ordinate
  rif &lt;- data.frame(rif_top_income_share, weights)
  names(rif) &lt;- c("rif_top_income_share", "weights")
  return(rif_top_income_share)
}

rif_custom &lt;- get_rif(
  dep_var = dep_var,
  weights = weights,
  statistic = "custom",
  custom_rif_function = custom_variance_function
)

</code></pre>

<hr>
<h2 id='get_rif_gini'>Estimate RIF of Gini coefficient</h2><span id='topic+get_rif_gini'></span>

<h3>Description</h3>

<p>Compute the recentered influence function (RIF) of a weighted
Gini coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rif_gini(dep_var, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rif_gini_+3A_dep_var">dep_var</code></td>
<td>
<p>values of a non-negative continuous dependent variable</p>
</td></tr>
<tr><td><code id="get_rif_gini_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one column containing the RIF of the Gini coefficient for each observation.
</p>


<h3>References</h3>

<p>Cowell, Frank A., and Emmanuel Flachaire. 2007. &quot;Income distribution and inequality measurement: The problem of extreme values.&quot;
<em>Journal of Econometrics</em>, 141(2), 1044-1072.
</p>
<p>Firpo, Sergio P., Nicole M. Fortin, and Thomas Lemieux. 2018. “Decomposing Wage Distributions Using Recentered
Influence Function Regressions.” <em>Econometrics</em> 6(2), 28.
</p>
<p>Monti, Anna Clara. 1991. &quot;The study of the Gini concentration ratio by means of the influence function.&quot;  <em>Statistica</em> 51(4),
561–577.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
dep_var &lt;- rlnorm(100)
weights &lt;- rep(1, 100)
rif_gini &lt;- get_rif_gini(dep_var = dep_var, weights = weights)
rif_gini

gini &lt;- compute_gini(dep_var = dep_var, weights = weights)
all.equal(gini, mean(rif_gini$rif_gini))

</code></pre>

<hr>
<h2 id='get_rif_interquantile_range'>Estimate RIF of interquantile range</h2><span id='topic+get_rif_interquantile_range'></span>

<h3>Description</h3>

<p>Compute the recentered influence function (RIF) of a weighted
interquantile range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rif_interquantile_range(dep_var, weights, probs, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rif_interquantile_range_+3A_dep_var">dep_var</code></td>
<td>
<p>dependent variable of distributional function. Discrete or continuous numeric vector.</p>
</td></tr>
<tr><td><code id="get_rif_interquantile_range_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.
The default (<code>NULL)</code> is equivalent to <code>weights = rep(1, length(dep_var))</code>.</p>
</td></tr>
<tr><td><code id="get_rif_interquantile_range_+3A_probs">probs</code></td>
<td>
<p>a vector of length 2 with probabilities corresponding to the limits of the interquantile range of interest.
The interquantile range is defined as difference between the quantile with the larger probability and the one
with the lower probability.</p>
</td></tr>
<tr><td><code id="get_rif_interquantile_range_+3A_...">...</code></td>
<td>
<p>further arguments passed on to <a href="stats.html#topic+density">density</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one column containing the RIF of the interquantile range for each observation and one column containing the weights.
</p>


<h3>References</h3>

<p>Firpo, Sergio P., Nicole M. Fortin, and Thomas Lemieux. 2018. “Decomposing Wage Distributions Using Recentered
Influence Function Regressions.” <em>Econometrics</em> 6(2), 28.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
dep_var &lt;- rlnorm(100)
weights &lt;- rep(1, 100)
get_rif_interquantile_range(dep_var, probs = c(0.1, 0.9), weights = weights)

</code></pre>

<hr>
<h2 id='get_rif_interquantile_ratio'>Estimate RIF of interquantile ratio</h2><span id='topic+get_rif_interquantile_ratio'></span>

<h3>Description</h3>

<p>Compute the recentered influence function (RIF) of a weighted
interquantile ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rif_interquantile_ratio(dep_var, weights, probs, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rif_interquantile_ratio_+3A_dep_var">dep_var</code></td>
<td>
<p>dependent variable of a distributional function. Discrete or continuous numeric vector.</p>
</td></tr>
<tr><td><code id="get_rif_interquantile_ratio_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.
The default (<code>NULL)</code> is equivalent to <code>weights = rep(1, length(dep_var))</code>.</p>
</td></tr>
<tr><td><code id="get_rif_interquantile_ratio_+3A_probs">probs</code></td>
<td>
<p>a vector of length 2 with probabilities corresponding to the quantiles in the ratio's numerator and the denominator.
The function defines the interquantile ratio as the ratio between the quantile with the larger probability (numerator) and
the quantile with the lower probability (denominator).</p>
</td></tr>
<tr><td><code id="get_rif_interquantile_ratio_+3A_...">...</code></td>
<td>
<p>further arguments passed on to <a href="stats.html#topic+density">density</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one column containing the RIF of the interquantile ratio for each observation.
</p>


<h3>References</h3>

<p>Chung, Choe, and Philippe Van Kerm. 2018. &quot;Foreign workers and the wage distribution: What
does the infuence function reveal?&quot;, <em>Econometrics</em> 6(3), 41.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
dep_var &lt;- rlnorm(100)
weights &lt;- rep(1, 100)
get_rif_interquantile_ratio(dep_var, probs = c(0.1, 0.9), weights = weights)

</code></pre>

<hr>
<h2 id='get_rif_mean'>Estimate RIF at the Mean</h2><span id='topic+get_rif_mean'></span>

<h3>Description</h3>

<p>Function to estimate the recentered influence function (RIF) at the mean
of a weighted distribution of a dependent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rif_mean(dep_var)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rif_mean_+3A_dep_var">dep_var</code></td>
<td>
<p>dependent variable of a distributional function. Discrete or continuous numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one column of <code>length(dep_var)</code> containing the RIF at the mean.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dep_var &lt;- c(1, 3, 9, 16, 3, 7, 4, 9)
get_rif_mean(dep_var)

</code></pre>

<hr>
<h2 id='get_rif_quantiles'>Estimate RIF at Quantiles</h2><span id='topic+get_rif_quantiles'></span><span id='topic+get_rif_quantile'></span>

<h3>Description</h3>

<p>Function to estimate the recentered influence function (RIF) at one or several specified quantiles
of a weighted distribution of a dependent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rif_quantiles(dep_var, weights, probs, ...)

get_rif_quantile(dep_var, weights, probs, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rif_quantiles_+3A_dep_var">dep_var</code></td>
<td>
<p>dependent variable of a distributional function. Discrete or continuous numeric vector.</p>
</td></tr>
<tr><td><code id="get_rif_quantiles_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.
The default (<code>NULL)</code> is equivalent to <code>weights = rep(1, length(dep_var))</code>.</p>
</td></tr>
<tr><td><code id="get_rif_quantiles_+3A_probs">probs</code></td>
<td>
<p>the specific quantile at which to estimate the RIF.</p>
</td></tr>
<tr><td><code id="get_rif_quantiles_+3A_...">...</code></td>
<td>
<p>further arguments passed on to <a href="stats.html#topic+density">density</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the number of columns equaling the length of vector <code>probs</code> and an additional column containing the weights.
Each column contains the RIF values at the quantile's probabilities.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>get_rif_quantile()</code>: Helper function to estimate the RIF values at a specific quantile.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>dep_var &lt;- c(1, 3, 9, 16, 3, 7, 4, 9)
probs &lt;- seq(1:9) / 10
weights &lt;- c(2, 1, 3, 4, 4, 1, 6, 3)
get_rif_quantiles(dep_var, probs, weights = weights)

</code></pre>

<hr>
<h2 id='get_rif_variance'>Estimate RIF of variance</h2><span id='topic+get_rif_variance'></span>

<h3>Description</h3>

<p>Function to estimate the recentered influence function (RIF) of the variance
of a weighted distribution of a dependent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rif_variance(dep_var, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rif_variance_+3A_dep_var">dep_var</code></td>
<td>
<p>dependent variable of a distributional function. Discrete or continuous numeric vector.</p>
</td></tr>
<tr><td><code id="get_rif_variance_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.
The default (<code>NULL)</code> is equivalent to <code>weights = rep(1, length(dep_var))</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one column containing the RIF of the variance for each observation and one column containing the weights.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dep_var &lt;- c(1, 3, 9, 16, 3, 7, 4, 9)
weights &lt;- c(2, 1, 3, 4, 4, 1, 6, 3)
get_rif_variance(dep_var, weights = weights)

</code></pre>

<hr>
<h2 id='integrate_generalized_lorenz_curve'>Integrate generalized Lorenz curve</h2><span id='topic+integrate_generalized_lorenz_curve'></span>

<h3>Description</h3>

<p>Computes the area under the lorenz curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate_generalized_lorenz_curve(dep_var, weights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integrate_generalized_lorenz_curve_+3A_dep_var">dep_var</code></td>
<td>
<p>dependent variable of a distributional function. Discrete or continuous numeric vector.</p>
</td></tr>
<tr><td><code id="integrate_generalized_lorenz_curve_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.
The default (<code>NULL)</code> is equivalent to <code>weights = rep(1, length(dep_var))</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the size of the area under the lorenz curve (the integrated lorenz curve).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dep_var &lt;- c(1, 3, 9, 16, 3, 7, 4, 9)
weights &lt;- c(2, 1, 3, 4, 4, 1, 6, 3)
integrated_lorenz_curve &lt;-
  integrate_generalized_lorenz_curve(
    dep_var = dep_var,
    weights = weights
  )

</code></pre>

<hr>
<h2 id='men8385'>Sample of male wage data from the CPS 1983-1985</h2><span id='topic+men8385'></span>

<h3>Description</h3>

<p>A sample of the the Merged Outgoing Rotation Group of the
Current Population Survey of 1983, 1984 and 1985 used by
Firpo, Fortin &amp; Lemieux (2009). The data contains a selection of 10 variables
and a sample of 26,695 observations of male workers &ndash; corresponding to a tenth of the
original 266,956 observations. See Lemieux (2006) for details on data selection and recoding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>men8385
</code></pre>


<h3>Format</h3>

<p>A data frame with 26,695 rows and 10 variables.
</p>

<dl>
<dt>wage</dt><dd><p>Hourly wage in US dollars at constant prices</p>
</dd>
<dt>union</dt><dd><p>Union status indicator</p>
</dd>
<dt>nonwhite</dt><dd><p>Non-white indicator</p>
</dd>
<dt>married</dt><dd><p>Married indicator</p>
</dd>
<dt>education</dt><dd><p>Factor variable with 6 education levels: high-school graduates (reference), elementary, high-school dropouts , some college, college graduates, post college graduates</p>
</dd>
<dt>experience</dt><dd><p>Factor variable with 9 potential experience levels, each of five years gap, 20 to 24 years as reference level)</p>
</dd>
<dt>weights</dt><dd><p>CPS sample weights</p>
</dd>
<dt>age</dt><dd><p>Age in years</p>
</dd>
<dt>education_in_years</dt><dd><p>Education in years</p>
</dd>
<dt>experience_in_years</dt><dd><p>Experience in years</p>
</dd>
</dl>



<h3>Source</h3>

<p>Sergio Firpo, Nicole M. Fortin, and Thomas Lemieux, &quot;Unconditional
Quantile Regressions&quot;, Econometrica, Vol. 77, No. 3 (May, 2009), pp.
953-973.
</p>
<p>Replication files:
&lt;https://www.econometricsociety.org/publications/econometrica/2009/05/01/unconditional-quantile-regressions&gt;
</p>
<p>Thoms Lemieux, &quot;Increasing Residual Wage Inequality: Composition Effects,
Noisy Data, or Rising Demand for Skill?&quot;, American Economic Review, Vol. 96,
No. 3 (June, 2006), pp. 461-498.
</p>

<hr>
<h2 id='plot.rifreg'>Plot the coefficients of a <code>rifreg</code> object</h2><span id='topic+plot.rifreg'></span>

<h3>Description</h3>

<p>Coefficients are plotted for each quantile and each covariate.
Specific covariates can be selected and standard errors displayed if desired.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rifreg'
plot(
  x,
  varselect = NULL,
  confidence_level = 0.05,
  vcov = sandwich::sandwich,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.rifreg_+3A_x">x</code></td>
<td>
<p>an object of class &quot;rifreg&quot;, usually, a result of a call to <a href="#topic+rifreg">rifreg</a> with <code>statistic = "quantiles"</code>.</p>
</td></tr>
<tr><td><code id="plot.rifreg_+3A_varselect">varselect</code></td>
<td>
<p>vector of length 1 or more containig the names of the covariates to display.</p>
</td></tr>
<tr><td><code id="plot.rifreg_+3A_confidence_level">confidence_level</code></td>
<td>
<p>numeric value between 0 and 1 (default = 0.95) that defines the confidence interval
plotted as a ribbon and defined as <code>qnorm(confidence_level/2)</code> * standard error.</p>
</td></tr>
<tr><td><code id="plot.rifreg_+3A_vcov">vcov</code></td>
<td>
<p>Function to estimate covariance matrix of rifreg coefficients if covariance matrix has not been bootstrapped.
Per default, heteroscedasticity-consistent (HC) standard errors are calculated using <a href="sandwich.html#topic+sandwich">sandwich</a>.
Note: These standard errors do not take the variance introduced by estimating RIF into account.</p>
</td></tr>
<tr><td><code id="plot.rifreg_+3A_...">...</code></td>
<td>
<p>other parameters to be passed to plotting function. See <a href="ggplot2.html#topic+ggplot">ggplot</a> for further information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a &quot;ggplot&quot; containing the coefficients for each (selected) covariate
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rifreg &lt;- rifreg(
  formula = log(wage) ~ union +
    nonwhite +
    married +
    education +
    experience,
  data = men8385,
  statistic = "quantiles",
  probs = seq(0.1, 0.9, 0.1),
  weights = weights
)

plot(rifreg)

plot(rifreg, varselect = c("age", "unionyes"), confidence_level = 0.1)

</code></pre>

<hr>
<h2 id='print.rifreg'>Print method for class &quot;rifreg&quot;</h2><span id='topic+print.rifreg'></span>

<h3>Description</h3>

<p>Print method for class &quot;rifreg&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rifreg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rifreg_+3A_x">x</code></td>
<td>
<p>an object of class &quot;rifreg&quot;, usually, a result of a call to <a href="#topic+rifreg">rifreg</a>.</p>
</td></tr>
<tr><td><code id="print.rifreg_+3A_...">...</code></td>
<td>
<p>other parameters to be passed to printing function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the function <code>print.rifreg()</code> returns the the covariates' coefficients
of the RIF regressions derived from  the fitted linear model given in object <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rifreg &lt;- rifreg(
  formula = log(wage) ~ union +
    nonwhite +
    married +
    education +
    experience,
  data = men8385,
  statistic = "quantiles",
  probs = seq(0.1, 0.9, 0.1),
  weights = weights
)

print(rifreg)

</code></pre>

<hr>
<h2 id='rifreg'>RIF regression</h2><span id='topic+rifreg'></span>

<h3>Description</h3>

<p>Estimate a recentered influence function (RIF) regression for a
distributional statistic of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rifreg(
  formula,
  data,
  statistic = "quantiles",
  weights = NULL,
  probs = c(1:9)/10,
  custom_rif_function = NULL,
  na.action = na.omit,
  bootstrap = FALSE,
  bootstrap_iterations = 100,
  cores = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rifreg_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot;. See <a href="stats.html#topic+lm">lm</a> for further details.</p>
</td></tr>
<tr><td><code id="rifreg_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="rifreg_+3A_statistic">statistic</code></td>
<td>
<p>string containing the distributional statistic for which to compute the RIF. Can be one of
&quot;quantiles&quot;, &quot;mean&quot;, &quot;variance&quot;, &quot;gini&quot;, &quot;interquantile_range&quot;, &quot;interquantile_ratio&quot;, or &quot;custom&quot;.
Default is &quot;quantiles&quot;. If &quot;custom&quot; is selected, a <code>custom_rif_function</code> needs to be provided.</p>
</td></tr>
<tr><td><code id="rifreg_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights, hence of same length as <code>dep_var</code>.
The default (<code>NULL</code>) is equivalent to <code>weights = rep(1, length(dep_var))</code>.</p>
</td></tr>
<tr><td><code id="rifreg_+3A_probs">probs</code></td>
<td>
<p>a vector of length 1 or more with probabilities of quantiles. Each quantile is indicated with a value between 0 and 1.
Default is <code>c(1:9)/10</code>. If <code>statistic = "quantiles"</code>, a single RIF regression for every quantile in <code>probs</code>
is estimated. An interquantile ratio (range) is defined by the ratio (difference) between the <code>max(probs)</code>-quantile and
the <code>min(probs)</code>-quantile.</p>
</td></tr>
<tr><td><code id="rifreg_+3A_custom_rif_function">custom_rif_function</code></td>
<td>
<p>the RIF function to compute the RIF of the custom distributional statistic.
Default is NULL. Only needs to be provided if <code>statistic = "custom"</code>.
Every custom_rif_function needs the parameters <code>dep_var</code>, <code>weights</code> and <code>probs</code>.
If they are not needed, they must be set to NULL in the function definition (e.g. <code>probs = NULL</code>).
A custom function must return a data frame containing at least a &quot;rif&quot; and &quot;weights&quot; column.
See <code>examples</code> for further details.</p>
</td></tr>
<tr><td><code id="rifreg_+3A_na.action">na.action</code></td>
<td>
<p>generic function that defines how NAs in the data should be handled.
Default is <code>na.omit</code>, leading to exclusion of observations that contain one or more missings.
See <a href="stats.html#topic+na.action">na.action</a> for further details.</p>
</td></tr>
<tr><td><code id="rifreg_+3A_bootstrap">bootstrap</code></td>
<td>
<p>boolean (default = FALSE) indicating if bootstrapped standard errors will be computed</p>
</td></tr>
<tr><td><code id="rifreg_+3A_bootstrap_iterations">bootstrap_iterations</code></td>
<td>
<p>positive integer indicating the number of bootstrap iterations to execute.
Only required if <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code id="rifreg_+3A_cores">cores</code></td>
<td>
<p>positive integer indicating the number of cores to use when computing bootstrapped standard errors.
Only required if <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code id="rifreg_+3A_...">...</code></td>
<td>
<p>additional parameters passed to the <code>custom_rif_function</code>.
Apart from <code>dep_var</code>, <code>weights</code> and <code>probs</code> they must have a different name than the the ones in
<code>rifreg</code>. For instance, if you want to pass a parameter <code>statistic</code> to the
<code>custom_rif_function</code>, name it <code>custom_statistic</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rifreg</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"rifreg"</code>.
</p>
<p>A <code>"rifreg"</code> object is a list containing the following components:
</p>
<table>
<tr><td><code>estimates</code></td>
<td>
<p>a matrix of RIF regression coefficients for each
covariate and the intercept. In case of several quantiles,
coefficient estimates for each quantile are provided.
Equivalent to <code>coef()</code> call of an object of class <code>"lm"</code>.</p>
</td></tr>
<tr><td><code>rif_lm</code></td>
<td>
<p>one or several objects of class <code>"lm"</code>,
containing the detailed RIF regression results.</p>
</td></tr>
<tr><td><code>rif</code></td>
<td>
<p>a data frame containing the RIF for each observation. </p>
</td></tr>
<tr><td><code>bootstrap_se</code></td>
<td>
<p>bootstrapped standard errors for each coefficient.
Only provided if <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code>bootstrap_vcov</code></td>
<td>
<p>the bootstrapped variance-covariance matrix for each coefficient.
Only provided if <code>bootstrap = TRUE</code>.</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the distributional statistic for which the RIF was computed.</p>
</td></tr>
<tr><td><code>custom_rif_function</code></td>
<td>
<p>The custom RIF function in case it was provided.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>the probabilities of the quantiles that were computed, in case the distributional
statistic requires quantiles.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Firpo, Sergio P., Nicole M. Fortin, and Thomas Lemieux. 2009. “Unconditional Quantile
Regressions.” <em>Econometrica</em> 77(3): 953–73.
</p>
<p>Cowell, Frank A., and Emmanuel Flachaire. 2015. “Statistical Methods for Distributional Analysis.”
In Anthony B. Atkinson and François Bourguignon (eds.), <em>Handbook of Income Distribution</em>. Amsterdam: Elsevier.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rifreg &lt;- rifreg(
  formula = log(wage) ~ union +
    nonwhite +
    married +
    education +
    experience,
  data = men8385,
  statistic = "quantiles",
  weights = weights,
  probs = seq(0.1, 0.9, 0.1),
  bootstrap = FALSE
)


# custom function
custom_variance_function &lt;- function(dep_var, weights, probs = NULL) {
  weighted_mean &lt;- weighted.mean(x = dep_var, w = weights)
  rif &lt;- (dep_var - weighted_mean)^2
  rif &lt;- data.frame(rif, weights)
  names(rif) &lt;- c("rif_variance", "weights")
  return(rif)
}

rifreg &lt;- rifreg(
  formula = log(wage) ~ union + nonwhite + married + education + experience,
  data = men8385,
  statistic = "custom",
  weights = weights,
  probs = NULL,
  custom_rif_function = custom_variance_function,
  bootstrap = FALSE
)

</code></pre>

<hr>
<h2 id='summary.rifreg'>summary method for class &quot;rifreg&quot;</h2><span id='topic+summary.rifreg'></span>

<h3>Description</h3>

<p>summary method for class &quot;rifreg&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rifreg'
summary(object, vcov = sandwich::sandwich, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.rifreg_+3A_object">object</code></td>
<td>
<p>an object of class &quot;rifreg&quot;, usually, a result of a call to <a href="#topic+rifreg">rifreg</a>.</p>
</td></tr>
<tr><td><code id="summary.rifreg_+3A_vcov">vcov</code></td>
<td>
<p>Function to estimate covariance matrix of rifreg coefficients if covariance matrix has not been bootstrapped.
Per default, heteroscedasticity-consistent (HC) standard errors are calculated using <a href="sandwich.html#topic+sandwich">sandwich</a>.
Note: These standard errors do not take the variance introduced by estimating RIF into account.</p>
</td></tr>
<tr><td><code id="summary.rifreg_+3A_...">...</code></td>
<td>
<p>other parameters to be passed to summary functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the function <code>summary.rifreg()</code> returns a list of summary statistics derived from
the rifreg object given in <code>object</code>. For further details see <a href="stats.html#topic+summary.lm">summary.lm</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rifreg &lt;- rifreg(
  formula = log(wage) ~ union +
    nonwhite +
    married +
    education +
    experience,
  data = men8385,
  statistic = "quantiles",
  probs = seq(0.1, 0.9, 0.1),
  weights = weights
)
summary(rifreg)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
