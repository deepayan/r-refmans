<!DOCTYPE html><html><head><title>Help for package smoothHR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {smoothHR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#smoothHR-package'><p>Smooth Hazard Ratio Curves Taking a Reference Value</p></a></li>
<li><a href='#dfmacox'><p>Degrees of freedom in multivariate additive Cox models</p></a></li>
<li><a href='#plot.HR'><p>Flexible hazard ratio curves taking a specific covariate value as reference</p></a></li>
<li><a href='#predict.HR'><p>predict method for an object of class 'HR'.</p></a></li>
<li><a href='#print.HR'><p>print method for a Smooth Hazard Ratio Object</p></a></li>
<li><a href='#smoothHR'><p>Smooth Hazard Ratio Curves Taking a Reference Value</p></a></li>
<li><a href='#whas500'><p>Worcester Heart Attack Study WHAS500 Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-25</td>
</tr>
<tr>
<td>Title:</td>
<td>Smooth Hazard Ratio Curves Taking a Reference Value</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.12.0), survival, splines</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides flexible hazard ratio curves allowing non-linear
  relationships between continuous predictors and survival.
  To better understand the effects that each continuous covariate
  has on the outcome, results are expressed in terms of hazard
  ratio curves, taking a specific covariate value as reference.
  Confidence bands for these curves are also derived.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/arturstat/smoothHR">https://github.com/arturstat/smoothHR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/arturstat/smoothHR/issues">https://github.com/arturstat/smoothHR/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-25 18:18:37 UTC; User</td>
</tr>
<tr>
<td>Author:</td>
<td>Artur Araujo <a href="https://orcid.org/0000-0003-1419-4208"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Luis Meira-Machado
    <a href="https://orcid.org/0000-0002-8577-7665"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Artur Araujo &lt;artur.stat@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-25 18:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='smoothHR-package'>Smooth Hazard Ratio Curves Taking a Reference Value</h2><span id='topic+smoothHR-package'></span>

<h3>Description</h3>

<p>Provides flexible hazard ratio curves allowing non-linear relationships between continuous predictors and survival.
To better understand the effects that each continuous covariate has on the outcome, results are expressed in terms of hazard ratio curves,
taking a specific covariate value as reference. Confidence bands for these curves are also derived.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
		Package: </td><td style="text-align: left;"> smoothHR</td>
</tr>
<tr>
 <td style="text-align: left;">
		Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
		Version: </td><td style="text-align: left;"> 1.0.5</td>
</tr>
<tr>
 <td style="text-align: left;">
		Date: </td><td style="text-align: left;"> 2024-02-25</td>
</tr>
<tr>
 <td style="text-align: left;">
		License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
		LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
		LazyData: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Artur Araújo and Luís Meira-Machado <a href="mailto:lmachado@math.uminho.pt">lmachado@math.uminho.pt</a><br />
Maintainer: Artur Araújo <a href="mailto:artur.stat@gmail.com">artur.stat@gmail.com</a>
</p>


<h3>References</h3>

<p>Cadarso-Suarez, C. and Meira-Machado, L. and Kneib, T. and Gude, F. (2010). Flexible hazard ratio curves for continuous predictors in multi-state models: an application to breast cancer data. <em>Statistical Modelling</em>, <b>10</b>(3), 291-314. <a href="https://doi.org/10.1177/1471082X0801000303">doi:10.1177/1471082X0801000303</a>
</p>
<p>Eilers, Paul H. and Marx, Brian D. (1996). Flexible smoothing with B-splines and penalties. <em>Statistical Science</em>, <b>11</b>(2), 89-121. <a href="https://doi.org/10.1214/ss/1038425655">doi:10.1214/ss/1038425655</a>
</p>
<p>Hosmer, D. W. and Lemeshow, S. and May, S. (2008). <em>Applied Survival Analysis: Regression Modeling of Time to Event Data: Second Edition</em>, John Wiley and Sons Inc., New York, NY.
</p>
<p>Hurvich, C. M. and Simonoff, J. S. and Tsai, Chih-Ling (1998). Smoothing parameter selection in nonparametric regression using an improved Akaike information criterion. <em>JRSSB</em>, <b>60</b>(2), 271-293. <a href="https://doi.org/10.1111/1467-9868.00125">doi:10.1111/1467-9868.00125</a>
</p>
<p>Meira-Machado, L. and Cadarso-Suárez, C. and Gude, F. and Araújo, A. (2013). smoothHR: An R Package for Pointwise Nonparametric Estimation of Hazard Ratio Curves of Continuous Predictors. <em>Computational and Mathematical Methods in Medicine</em>, <b>2013</b>, 11 pages. <a href="https://doi.org/10.1155/2013/745742">doi:10.1155/2013/745742</a>
</p>

<hr>
<h2 id='dfmacox'>Degrees of freedom in multivariate additive Cox models</h2><span id='topic+dfmacox'></span>

<h3>Description</h3>

<p>Provides the degrees of freedom for flexible continuous covariates in multivariate additive Cox models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfmacox(time, time2=NULL, status, nl.predictors, other.predictors,
smoother, method, mindf=NULL, maxdf=NULL, ntimes=NULL, data)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfmacox_+3A_time">time</code></td>
<td>
<p>For right censored data, this is the follow up time. For interval data, the first argument is the starting time for the interval.</p>
</td></tr>
<tr><td><code id="dfmacox_+3A_time2">time2</code></td>
<td>
<p>Ending time of the interval for interval censored or counting process data only.
Intervals are assumed to be open on the left and closed on the right, (start, end].
For counting process data, event indicates whether an event occurred at the end of the interval.</p>
</td></tr>
<tr><td><code id="dfmacox_+3A_status">status</code></td>
<td>
<p>The status indicator, normally 0=alive, 1=dead. Other choices are TRUE/FALSE (TRUE = death) or 1/2 (2=death).
For interval censored data, the status indicator is 0=right censored, 1=event at time, 2=left censored, 3=interval censored.
Although unusual, the event indicator can be omitted, in which case all subjects are assumed to have an event.</p>
</td></tr>
<tr><td><code id="dfmacox_+3A_nl.predictors">nl.predictors</code></td>
<td>
<p>Vector with covariates to be introduced in the additive Cox model with a nonlinear effect.</p>
</td></tr>
<tr><td><code id="dfmacox_+3A_other.predictors">other.predictors</code></td>
<td>
<p>Vector with remaining covariates to be introduced in the additive Cox model.
This will include qualitative covariates or continuous covariates with a linear effect.</p>
</td></tr>
<tr><td><code id="dfmacox_+3A_smoother">smoother</code></td>
<td>
<p>Smoothing method to be used in the additive Cox model.
Possible options are ‘ns’ for natural spline smoothing or ‘pspline’ for penalized spline smoothing.</p>
</td></tr>
<tr><td><code id="dfmacox_+3A_method">method</code></td>
<td>
<p>The desired method to obtain the optimal degrees of freedom.
If method =&quot;AIC&quot;, then the AIC = (loglik -df) is used to choose the &quot;optimal&quot; degrees of freedom.
The corrected AIC of Hurvich et. al. (method=&quot;AICc&quot;) and the BIC criterion (method = &quot;BIC&quot;) can also be used.</p>
</td></tr>
<tr><td><code id="dfmacox_+3A_mindf">mindf</code></td>
<td>
<p>Vector with minimum degrees of freedom for each nonlinear predictor.
By default this value is a vector of of the same length of nl.predictors all with value 1, if smoother is 'ns';
a vector with the same length of nl.predictors all with value 1.5, if smoother is 'pspline'.</p>
</td></tr>
<tr><td><code id="dfmacox_+3A_maxdf">maxdf</code></td>
<td>
<p>Vector with maximum degrees of freedom for each nonlinear predictor.
By default, when penalized spline is used (smoother='pspline'),
the corrected AIC from Hurvich obtained in the corresponding univariate additive Cox model is used.
When penalized spline is used (smoother='ns') a vector with the same length of nl.predictors all with values 1.5.</p>
</td></tr>
<tr><td><code id="dfmacox_+3A_ntimes">ntimes</code></td>
<td>
<p>Internel procedure which involves repetion of some convergence steps to attain the optimal degrees of freedom. By deafault is 5.</p>
</td></tr>
<tr><td><code id="dfmacox_+3A_data">data</code></td>
<td>
<p>A data.frame in which to interpret the variables named in the arguments <code>time</code>, <code>time2</code>, and <code>status</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>list</code>, basically a list including the elements:
</p>
<table>
<tr><td><code>df</code></td>
<td>
<p>Degrees of freedom of the 'nl.predictors'.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike’s Information Criterion score of the fitted model.</p>
</td></tr>
<tr><td><code>AICc</code></td>
<td>
<p>Corrected Akaike’s Information Criterion score of the fitted model.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian Information Criterion score of the fitted model.</p>
</td></tr>
<tr><td><code>myfit</code></td>
<td>
<p>Fitted (additive Cox) model based on the chosen degrees of freedom.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method used for obtaining the degrees of freedom.</p>
</td></tr>
<tr><td><code>nl.predictors</code></td>
<td>
<p>Vector with the nonlinear predictors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artur Araújo and Luís Meira-Machado</p>


<h3>References</h3>

<p>Eilers, Paul H. and Marx, Brian D. (1996). Flexible smoothing with B-splines and penalties. <em>Statistical Science</em>, <b>11</b>(2), 89-121. <a href="https://doi.org/10.1214/ss/1038425655">doi:10.1214/ss/1038425655</a>
</p>
<p>Hurvich, C. M. and Simonoff, J. S. and Tsai, Chih-Ling (1998). Smoothing parameter selection in nonparametric regression using an improved Akaike information criterion. <em>JRSSB</em>, <b>60</b>(2), 271–293. <a href="https://doi.org/10.1111/1467-9868.00125">doi:10.1111/1467-9868.00125</a>
</p>
<p>Meira-Machado, L. and Cadarso-Suárez, C. and Gude, F. and Araújo, A. (2013). smoothHR: An R Package for Pointwise Nonparametric Estimation of Hazard Ratio Curves of Continuous Predictors. <em>Computational and Mathematical Methods in Medicine</em>, <b>2013</b>, 11 pages. <a href="https://doi.org/10.1155/2013/745742">doi:10.1155/2013/745742</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
library(survival)
data(whas500)
mydf_ns &lt;- dfmacox(time="lenfol", status="fstat", nl.predictors=c("los", "bmi"),
other.predictors=c("age", "hr", "gender", "diasbp"), smoother="ns", data=whas500)
print(mydf_ns)

# Example 2
mydf_ps &lt;- dfmacox(time="lenfol", status="fstat", nl.predictors=c("los", "bmi"),
other.predictors=c("age", "hr", "gender", "diasbp"), smoother="pspline", data=whas500)
print(mydf_ps)
</code></pre>

<hr>
<h2 id='plot.HR'>Flexible hazard ratio curves taking a specific covariate value as reference</h2><span id='topic+plot.HR'></span>

<h3>Description</h3>

<p>Plots flexible hazard ratio curves allowing non-linear relationships between continuous predictors and survival.
To better understand the effects that each continuous covariate has on the outcome, results are expressed in terms of hazard ratio curves,
taking a specific covariate value as reference. Confidence bands for these curves are also derived.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HR'
plot(x, predictor, prob=NULL, pred.value=NULL, conf.level=0.95, round.x=NULL,
ref.label=NULL, col, main, xlab, ylab, lty, xlim, ylim, xx, ylog=TRUE,
log=ifelse(ylog, "", "y"), ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.HR_+3A_x">x</code></td>
<td>
<p>An object of class HR</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_predictor">predictor</code></td>
<td>
<p>Variable named in the formula or included as a predictor in the <code>coxfit</code>.
Usually a continuous predictor of survival for which the results are expressed in terms of hazard ratio curves,
taking a specific covariate value as reference.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_prob">prob</code></td>
<td>
<p>Value between 0 and 1. If <code>prob=0</code> the reference value will be the minimum of the hazard ratio curve.
If <code>prob=1</code> the reference value will be the maximum of the hazard ratio curve.
For values between 0 and 1 the reference value will be the corresponding quantile of the variable <code>predictor</code>.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_pred.value">pred.value</code></td>
<td>
<p>Value from the variable <code>predictor</code> to be taken as the reference value.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_round.x">round.x</code></td>
<td>
<p>Rounding of numbers in the plot.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_ref.label">ref.label</code></td>
<td>
<p>Label for the reference covariate. By default is the name of the covariate.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_col">col</code></td>
<td>
<p>Vector of dimension 3 for the colors to plot.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_main">main</code></td>
<td>
<p>These arguments to title have useful defaults here.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_xlab">xlab</code></td>
<td>
<p>The range of x and y values with sensible defaults.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_ylab">ylab</code></td>
<td>
<p>The range of x and y values with sensible defaults.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_lty">lty</code></td>
<td>
<p>Vector of dimension 2 for the line type.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_xlim">xlim</code></td>
<td>
<p>The range of x and y values with sensible defaults.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_ylim">ylim</code></td>
<td>
<p>The range of x and y values with sensible defaults.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_xx">xx</code></td>
<td>
<p>Vector of values (from the variable <code>predictor</code>) to be shown in the x axis.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_ylog">ylog</code></td>
<td>
<p>If <code>TRUE</code> plots natural logarithm of hazard ratio.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_log">log</code></td>
<td>
<p>Axis logarithmic scale. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code> for details.</p>
</td></tr>
<tr><td><code id="plot.HR_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the plot data, a data.frame including the elements:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Predictor.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Hazard ratio or log hazard ratio.</p>
</td></tr>
<tr><td><code>y.lower</code></td>
<td>
<p>Lower bound of confidence interval.</p>
</td></tr>
<tr><td><code>y.upper</code></td>
<td>
<p>Upper bound of confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artur Araújo and Luís Meira-Machado</p>


<h3>References</h3>

<p>Cadarso-Suarez, C. and Meira-Machado, L. and Kneib, T. and Gude, F. (2010). Flexible hazard ratio curves for continuous predictors in multi-state models: an application to breast cancer data. <em>Statistical Modelling</em>, <b>10</b>(3), 291-314. <a href="https://doi.org/10.1177/1471082X0801000303">doi:10.1177/1471082X0801000303</a>
</p>
<p>Meira-Machado, L. and Cadarso-Suárez, C. and Gude, F. and Araújo, A. (2013). smoothHR: An R Package for Pointwise Nonparametric Estimation of Hazard Ratio Curves of Continuous Predictors. <em>Computational and Mathematical Methods in Medicine</em>, <b>2013</b>, 11 pages. <a href="https://doi.org/10.1155/2013/745742">doi:10.1155/2013/745742</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smoothHR">smoothHR</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
library(survival)
data(whas500)
fit &lt;- coxph(Surv(lenfol, fstat)~age+hr+gender+diasbp+pspline(bmi)+pspline(los),
data=whas500, x=TRUE)
hr1 &lt;- smoothHR(data=whas500, coxfit=fit)
plot(hr1, predictor="bmi", prob=0, conf.level=0.95)

# Example 2
hr2 &lt;- smoothHR( data=whas500, time="lenfol", status="fstat", formula=~age+hr+gender+diasbp+
pspline(bmi)+pspline(los) )
plot(hr2, predictor="los", pred.value=7, conf.level=0.95, xlim=c(0,30), round.x=1,
ref.label="Ref.", xaxt="n")
xx &lt;- c(0, 5, 10, 15, 20, 25, 30)
axis(1, xx)
</code></pre>

<hr>
<h2 id='predict.HR'>predict method for an object of class 'HR'.</h2><span id='topic+predict.HR'></span>

<h3>Description</h3>

<p>predict method for an object of class 'HR'.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HR'
predict(object, predictor, prob=NULL, pred.value=NULL, conf.level=0.95,
prediction.values=NULL, round.x=NULL, ref.label=NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.HR_+3A_object">object</code></td>
<td>
<p>An object of class HR.</p>
</td></tr>
<tr><td><code id="predict.HR_+3A_predictor">predictor</code></td>
<td>
<p>Variable named in the formula or included as a predictor in the <code>coxfit</code>.
Usually a continuous predictor of survival for which the results are expressed in terms of hazard ratio curves,
taking a specific covariate value as reference.</p>
</td></tr>
<tr><td><code id="predict.HR_+3A_prob">prob</code></td>
<td>
<p>Value between 0 and 1. If <code>prob=0</code> the reference value will be the minimum of the hazard ratio curve.
If <code>prob=1</code> the reference value will be the maximum of the hazard ratio curve.
For values between 0 and 1 the reference value will be the corresponding quantile of the variable <code>predictor</code>.</p>
</td></tr>
<tr><td><code id="predict.HR_+3A_pred.value">pred.value</code></td>
<td>
<p>Value from the variable <code>predictor</code> to be taken as the reference value.</p>
</td></tr>
<tr><td><code id="predict.HR_+3A_conf.level">conf.level</code></td>
<td>
<p>Level of confidence. Defaults to 0.95 (corresponding to 95%).</p>
</td></tr>
<tr><td><code id="predict.HR_+3A_prediction.values">prediction.values</code></td>
<td>
<p>Vector of values ranging between minimum and maximum of the variable <code>predictor</code>.</p>
</td></tr>
<tr><td><code id="predict.HR_+3A_round.x">round.x</code></td>
<td>
<p>Rounding of numbers in the predict.</p>
</td></tr>
<tr><td><code id="predict.HR_+3A_ref.label">ref.label</code></td>
<td>
<p>Label for the reference covariate. By default is the name of the covariate.</p>
</td></tr>
<tr><td><code id="predict.HR_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix with the prediction values.</p>


<h3>Author(s)</h3>

<p>Artur Araújo and Luís Meira-Machado</p>


<h3>References</h3>

<p>Cadarso-Suarez, C. and Meira-Machado, L. and Kneib, T. and Gude, F. (2010). Flexible hazard ratio curves for continuous predictors in multi-state models: an application to breast cancer data. <em>Statistical Modelling</em>, <b>10</b>(3), 291-314. <a href="https://doi.org/10.1177/1471082X0801000303">doi:10.1177/1471082X0801000303</a>
</p>
<p>Meira-Machado, L. and Cadarso-Suárez, C. and Gude, F. and Araújo, A. (2013). smoothHR: An R Package for Pointwise Nonparametric Estimation of Hazard Ratio Curves of Continuous Predictors. <em>Computational and Mathematical Methods in Medicine</em>, <b>2013</b>, 11 pages. <a href="https://doi.org/10.1155/2013/745742">doi:10.1155/2013/745742</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smoothHR">smoothHR</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
library(survival)
data(whas500)
fit &lt;- coxph(Surv(lenfol, fstat)~age+hr+gender+diasbp+pspline(bmi)+pspline(los),
data=whas500, x=TRUE)
hr1 &lt;- smoothHR(data=whas500, coxfit=fit)
predict(hr1, predictor="bmi", prob=0, conf.level=0.95)

# Example 2
hr2 &lt;- smoothHR( data=whas500, time="lenfol", status="fstat", formula=~age+hr+gender+diasbp+
pspline(bmi)+pspline(los) )
pdval &lt;- c(1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 15, 18, 22, 25)
predict(hr2, predictor="los", pred.value=7, conf.level=0.95, prediction.values=pdval,
ref.label="Ref.")
</code></pre>

<hr>
<h2 id='print.HR'>print method for a Smooth Hazard Ratio Object</h2><span id='topic+print.HR'></span>

<h3>Description</h3>

<p>This class of objects is returned by the HR class of functions to represent smooth hazard ratio curve. Objects of this class have methods for <code>print</code>, <code>predict</code> and <code>plot</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HR'
print(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.HR_+3A_x">x</code></td>
<td>
<p>An object of class HR.</p>
</td></tr>
<tr><td><code id="print.HR_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned.</p>


<h3>Author(s)</h3>

<p>Artur Araújo and Luís Meira-Machado</p>


<h3>References</h3>

<p>Meira-Machado, L. and Cadarso-Suárez, C. and Gude, F. and Araújo, A. (2013). smoothHR: An R Package for Pointwise Nonparametric Estimation of Hazard Ratio Curves of Continuous Predictors. <em>Computational and Mathematical Methods in Medicine</em>, <b>2013</b>, 11 pages. <a href="https://doi.org/10.1155/2013/745742">doi:10.1155/2013/745742</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smoothHR">smoothHR</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
library(survival)
data(whas500)
fit &lt;- coxph(Surv(lenfol, fstat)~age+hr+gender+diasbp+pspline(bmi)+pspline(los),
data=whas500, x=TRUE)
hr1 &lt;- smoothHR(data=whas500, coxfit=fit)
print(hr1)

# Example 2
hr2 &lt;- smoothHR( data=whas500, time="lenfol", status="fstat", formula=~age+hr+gender+diasbp+
pspline(bmi)+pspline(los) )
print(hr2)
</code></pre>

<hr>
<h2 id='smoothHR'>Smooth Hazard Ratio Curves Taking a Reference Value</h2><span id='topic+smoothHR'></span>

<h3>Description</h3>

<p>Provides flexible hazard ratio curves allowing non-linear relationships between continuous predictors and survival.
To better understand the effects that each continuous covariate has on the outcome, results are expressed in terms of hazard ratio curves,
taking a specific covariate value as reference. Confidence bands for these curves are also derived.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothHR(data, time=NULL, time2=NULL, status=NULL, formula=NULL, coxfit,
status.event=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smoothHR_+3A_data">data</code></td>
<td>
<p>A data.frame in which to interpret the variables named in the formula or in the arguments <code>time</code>, <code>time2</code>, <code>status</code> and <code>coxfit</code>.</p>
</td></tr>
<tr><td><code id="smoothHR_+3A_time">time</code></td>
<td>
<p>For right censored data, this is the follow up time. For interval data, the first argument is the starting time for the interval.</p>
</td></tr>
<tr><td><code id="smoothHR_+3A_time2">time2</code></td>
<td>
<p>Ending time of the interval for interval censored or counting process data only.
Intervals are assumed to be open on the left and closed on the right, (start, end].
For counting process data, event indicates whether an event occurred at the end of the interval.</p>
</td></tr>
<tr><td><code id="smoothHR_+3A_status">status</code></td>
<td>
<p>The status indicator, normally 0=alive, 1=dead. Other choices are TRUE/FALSE (TRUE = death) or 1/2 (2=death).
For interval censored data, the status indicator is 0=right censored, 1=event at time, 2=left censored, 3=interval censored.
Although unusual, the event indicator can be omitted, in which case all subjects are assumed to have an event.</p>
</td></tr>
<tr><td><code id="smoothHR_+3A_formula">formula</code></td>
<td>
<p>A formula object, with the terms on the right after the ~ operator.</p>
</td></tr>
<tr><td><code id="smoothHR_+3A_coxfit">coxfit</code></td>
<td>
<p>An object of class coxph. This argument is optional, being an alternative to the arguments  <code>time</code>, <code>time2</code>, <code>status</code> and <code>formula</code>.</p>
</td></tr>
<tr><td><code id="smoothHR_+3A_status.event">status.event</code></td>
<td>
<p>The status indicator is a qualitative variable where usually the highest value is left for the event of interest (usually 0=alive, 1=dead).
If that is not the case the <code>status.event</code> indicates which value denotes the event of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>HR</code>. There are methods for <code>print</code>, <code>predict</code> and <code>plot</code>.
<code>HR</code> objects are implemented as a list with elements:
</p>
<table>
<tr><td><code>dataset</code></td>
<td>
<p>Dataset used.</p>
</td></tr>
<tr><td><code>coxfit</code></td>
<td>
<p>The object of class 'coxph' used.</p>
</td></tr>
<tr><td><code>phtest</code></td>
<td>
<p>Result from testing the proportional hazards assumption.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Artur Araújo and Luís Meira-Machado</p>


<h3>References</h3>

<p>Cadarso-Suarez, C. and Meira-Machado, L. and Kneib, T. and Gude, F. (2010). Flexible hazard ratio curves for continuous predictors in multi-state models: an application to breast cancer data. <em>Statistical Modelling</em>, <b>10</b>(3), 291-314. <a href="https://doi.org/10.1177/1471082X0801000303">doi:10.1177/1471082X0801000303</a>
</p>
<p>Meira-Machado, L. and Cadarso-Suárez, C. and Gude, F. and Araújo, A. (2013). smoothHR: An R Package for Pointwise Nonparametric Estimation of Hazard Ratio Curves of Continuous Predictors. <em>Computational and Mathematical Methods in Medicine</em>, <b>2013</b>, 11 pages. <a href="https://doi.org/10.1155/2013/745742">doi:10.1155/2013/745742</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
library(survival)
data(whas500)
fit &lt;- coxph(Surv(lenfol, fstat)~age+hr+gender+diasbp+pspline(bmi)+pspline(los), data=whas500,
x=TRUE)
hr1 &lt;- smoothHR(data=whas500, coxfit=fit)
print(hr1)

# Example 2
hr2 &lt;- smoothHR( data=whas500, time="lenfol", status="fstat", formula=~age+hr+gender+diasbp+
pspline(bmi)+pspline(los) )
print(hr2)
</code></pre>

<hr>
<h2 id='whas500'>Worcester Heart Attack Study WHAS500 Data</h2><span id='topic+whas500'></span>

<h3>Description</h3>

<p>Data from the Worcester Heart Attack Study</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(whas500)</code></pre>


<h3>Format</h3>

<p>A data frame with 500 observations with 22 variables.</p>


<h3>Details</h3>

<p>Data from the Worcester Heart Attack Study whose main goal was to describe factors associated
with trends over time in the incidence and survival rates following
hospital admission for acute myocardial infarction.
</p>


<h3>Source</h3>

<p>Worcester Heart Attack Study data from Dr. Robert J. Goldberg of
the Department of Cardiology at the University of Massachusetts Medical
School.
</p>


<h3>References</h3>

<p>Hosmer, D. W. and Lemeshow, S. and May, S. (2008). <em>Applied Survival Analysis: Regression Modeling of Time to Event Data: Second Edition</em>, John Wiley and Sons Inc., New York, NY.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(whas500)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
