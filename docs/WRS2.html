<!DOCTYPE html><html><head><title>Help for package WRS2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {WRS2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ancova'><p>Robust ANCOVA</p></a></li>
<li><a href='#binband'><p>Comparison of discrete distributions</p></a></li>
<li><a href='#bush'><p>Bushtucker Foods</p></a></li>
<li><a href='#bwtrim'><p>A robust two-way mixed ANOVA using trimmed means.</p></a></li>
<li><a href='#chile'><p>Chile Heat and Length</p></a></li>
<li><a href='#diet'><p>Diet and Weight Loss</p></a></li>
<li><a href='#electric'><p>The Electric Company</p></a></li>
<li><a href='#essays'><p>Academic Writing Data</p></a></li>
<li><a href='#eurosoccer'><p>European Soccer Leagues</p></a></li>
<li><a href='#goggles'><p>Beer Goggles Effect</p></a></li>
<li><a href='#hangover'><p>Hangover Symptoms</p></a></li>
<li><a href='#invisibility'><p>Cloaks of Invisibility</p></a></li>
<li><a href='#Leerkes'><p>Maternal Self-Efficacy</p></a></li>
<li><a href='#med1way'>
<p>Heteroscedastic one-way ANOVA for medians.</p></a></li>
<li><a href='#med2way'><p>A two-way ANOVA for medians.</p></a></li>
<li><a href='#movie'><p>Movies and Aggressive Affect</p></a></li>
<li><a href='#onesampb'><p>One-sample percentile bootstrap</p></a></li>
<li><a href='#pbcor'><p>Robust correlation coefficients.</p></a></li>
<li><a href='#picture'><p>Profile Pictures</p></a></li>
<li><a href='#Pygmalion'><p>Pygmalion Data</p></a></li>
<li><a href='#Qanova'><p>Quantile ANOVA</p></a></li>
<li><a href='#rmanova'><p> A heteroscedastic one-way repeated measures ANOVA for trimmed means.</p></a></li>
<li><a href='#rmanovab'><p> A heteroscedastic one-way repeated measures bootstrap ANOVA for trimmed means.</p></a></li>
<li><a href='#runmean'><p>Running Interval Smoother</p></a></li>
<li><a href='#spider'><p>Arachnophobes</p></a></li>
<li><a href='#swimming'><p>Optimistic and Pessimistic Swimmers</p></a></li>
<li><a href='#t1way'><p>A heteroscedastic one-way ANOVA for trimmed means.</p></a></li>
<li><a href='#t1waybt'>
<p>Bootstrap version of the heteroscedastic one-way ANOVA for trimmed means.</p></a></li>
<li><a href='#t2way'><p>A two-way ANOVA for trimmed means, M-estimators, and medians.</p></a></li>
<li><a href='#t3way'><p>A three-way ANOVA for trimmed means.</p></a></li>
<li><a href='#trimcibt'><p>Bootstrap-t method for one-sample test</p></a></li>
<li><a href='#trimse'><p>Robust location measures and their standard errors (se).</p></a></li>
<li><a href='#twocor'><p>Confidence intervals for two-sided tests on correlation coefficients.</p></a></li>
<li><a href='#viagra'><p>Effects of Viagra</p></a></li>
<li><a href='#WineTasting'><p>Wine Tasting</p></a></li>
<li><a href='#wmcpAKP'>
<p>Effect size for dependent samples ANOVA</p></a></li>
<li><a href='#yuen'><p>Independent samples t-tests on robust location measures including effect sizes.</p></a></li>
<li><a href='#yuend'><p>Paired samples robust t-tests.</p></a></li>
<li><a href='#ZYmediate'><p>Robust mediation test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Collection of Robust Statistical Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-14</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of robust statistical methods based on Wilcox' WRS functions. It implements robust t-tests (independent and dependent samples), robust ANOVA (including between-within subject designs), quantile ANOVA, robust correlation, robust mediation, and nonparametric ANCOVA models based on robust location measures.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-forge.r-project.org/projects/psychor/">https://r-forge.r-project.org/projects/psychor/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, reshape, plyr, stats, graphics, grDevices, utils</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, car, ggplot2, colorspace, mediation, GGally, codetools</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-14 15:39:14 UTC; patrick</td>
</tr>
<tr>
<td>Author:</td>
<td>Patrick Mair [cre, aut],
  Rand Wilcox [aut],
  Indrajeet Patil [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Patrick Mair &lt;mair@fas.harvard.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-15 08:36:23 UTC</td>
</tr>
</table>
<hr>
<h2 id='ancova'>Robust ANCOVA
</h2><span id='topic+ancova'></span><span id='topic+ancboot'></span><span id='topic+print.ancova'></span>

<h3>Description</h3>

<p>This function computes robust ANCOVA for 2 independent groups and one covariate. It compares trimmed means. No parametric assumption (e.g. homogeneity) is made about the form of the regression lines. A running interval smoother is used. A bootstrap version which computes
confidence intervals using a percentile t-bootstrap is provided as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ancova(formula, data, tr = 0.2, fr1 = 1, fr2 = 1, pts = NA, ...)

ancboot(formula, data, tr = 0.2, nboot = 599, fr1 = 1, fr2 = 1, pts = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ancova_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="ancova_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="ancova_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td></tr>
<tr><td><code id="ancova_+3A_fr1">fr1</code></td>
<td>

<p>values of the span for the first group (1 means unspecified)
</p>
</td></tr>
<tr><td><code id="ancova_+3A_fr2">fr2</code></td>
<td>

<p>values of the span for the second group (1 means unspecified)
</p>
</td></tr>
<tr><td><code id="ancova_+3A_pts">pts</code></td>
<td>

<p>can be used to specify the design points where the regression lines are to be compared; if <code>NA</code> design points are chosen.
</p>
</td></tr>
<tr><td><code id="ancova_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples
</p>
</td></tr>
<tr><td><code id="ancova_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>ancova</code> containing:
</p>
<table>
<tr><td><code>evalpts</code></td>
<td>
<p>covariate values (including points close to these values) where the test statistic is evaluated</p>
</td></tr>
<tr><td><code>n1</code></td>
<td>
<p>number of subjects at evaluation point (first group)</p>
</td></tr>
<tr><td><code>n2</code></td>
<td>
<p>number of subjects at evaluation point (first group)</p>
</td></tr>
<tr><td><code>trDiff</code></td>
<td>
<p>trimmed mean differences</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>standard errors for trimmed mean differences</p>
</td></tr>
<tr><td><code>ci.low</code></td>
<td>
<p>lower confidence limit for trimmed mean differences</p>
</td></tr>
<tr><td><code>ci.hi</code></td>
<td>
<p>upper confidence limit for trimmed mean differences</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>values of the test statistic</p>
</td></tr>
<tr><td><code>crit.vals</code></td>
<td>
<p>critical values</p>
</td></tr>
<tr><td><code>p.vals</code></td>
<td>
<p>p-values</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>fitted values from interval smoothing</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t2way">t2way</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(invisibility)
ancova(mischief2 ~ cloak + mischief1, data = invisibility)

## specifying covariate evaluation points
ancova(mischief2 ~ cloak + mischief1, data = invisibility, pts = c(3, 4, 8, 1))

## bootstrap version
ancboot(mischief2 ~ cloak + mischief1, data = invisibility)
</code></pre>

<hr>
<h2 id='binband'>Comparison of discrete distributions
</h2><span id='topic+binband'></span><span id='topic+discANOVA'></span><span id='topic+discmcp'></span><span id='topic+discstep'></span>

<h3>Description</h3>

<p><code>binband</code> compares two independent variables in terms of their probability function. <code>discANOVA</code> Tests the global hypothesis that for two or more independent groups, the corresponding discrete distributions are identical. That is, test the hypothesis that independent groups have identical multinomial distributions. <code>discmcp</code> provides multiple comparisons for J independent groups having discrete distributions. <code>discstep</code> implements the step-down multiple comparison procedure for comparing J independent discrete random variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binband(x, y, KMS = FALSE, alpha = 0.05, ADJ.P = FALSE, ...)
discANOVA(formula, data, nboot = 500, ...)
discmcp(formula, data, alpha = 0.05, nboot = 500, ...)
discstep(formula, data, nboot = 500, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binband_+3A_x">x</code></td>
<td>

<p>an numeric vector of data values for group 1.
</p>
</td></tr>
<tr><td><code id="binband_+3A_y">y</code></td>
<td>

<p>an numeric vector of data values for group 2.
</p>
</td></tr>
<tr><td><code id="binband_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="binband_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="binband_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="binband_+3A_alpha">alpha</code></td>
<td>

<p>alpha level.
</p>
</td></tr>
<tr><td><code id="binband_+3A_kms">KMS</code></td>
<td>

<p>whether the Kulinskaya-Morgenthaler-Staudte method for comparing binomials should be used.
</p>
</td></tr>
<tr><td><code id="binband_+3A_adj.p">ADJ.P</code></td>
<td>

<p>whether the critical p-value should be adjusted to control FWE when the sample size is small (&lt;50)
</p>
</td></tr>
<tr><td><code id="binband_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>discANOVA</code> returns an object of class <code>"med1way"</code> containing:
</p>
<table>
<tr><td><code>test</code></td>
<td>
<p>value of the test statistic</p>
</td></tr>
<tr><td><code>crit.val</code></td>
<td>
<p>critical value</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>
<p>The remaining functions return an object of class <code>"robtab"</code> containing:
</p>
<table>
<tr><td><code>partable</code></td>
<td>
<p>parameter table</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>
<p>Kulinskaya, E., Morgenthaler, S. and Staudte, R. (2010). Variance stabilizing the difference of two binomial proportions. American Statistician, 64, p. 350-356.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t1way">t1way</a></code>, <code><a href="#topic+Qanova">Qanova</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Consider a study aimed at comparing two methods for reducing shoulder pain after surgery.
## For the first method, the shoulder pain measures are:
x1 &lt;- c(2, 4, 4, 2, 2, 2, 4, 3, 2, 4, 2, 3, 2, 4, 3, 2, 2, 3, 5, 5, 2, 2)
## and for the second method they are:
x2 &lt;- c(5, 1, 4, 4, 2, 3, 3, 1, 1, 1, 1, 2, 2, 1, 1, 5, 3, 5)

fit1 &lt;- binband(x1, x2)
fit1

fit2 &lt;- binband(x1, x2, KMS = TRUE, alpha = 0.01)
fit2

## More than two groups:
discANOVA(libido ~ dose, viagra, nboot = 200)

## Multiple comparisons:
discmcp(libido ~ dose, viagra)

discstep(libido ~ dose, viagra)

</code></pre>

<hr>
<h2 id='bush'>Bushtucker Foods</h2><span id='topic+bush'></span>

<h3>Description</h3>

<p>In the TV show &quot;I'm a celebrity, get me out of here&quot; the celebrities had to eat things like stick insects, fish eyes, etc.
This dataset records the time taken to retch when eating these things.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bush</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables and 8 observations:
</p>

<dl>
<dt><code>participant</code></dt><dd><p>participant ID</p>
</dd>
<dt><code>stick_insect</code></dt><dd><p>time taken to retch when eating a stick insect</p>
</dd>
<dt><code>kangaroo_testicle</code></dt><dd><p>time taken to retch when eating a kangaroo testicle</p>
</dd>
<dt><code>fish_eye</code></dt><dd><p>time taken to retch when eating a fish eye</p>
</dd>
<dt><code>witchetty_grub</code></dt><dd><p>time taken to retch when eating a witchetty grub</p>
</dd>
</dl>



<h3>Details</h3>

<p>Dataset from Field et al. book (p. 557).   
</p>


<h3>References</h3>

<p>Field, A., Miles, J., &amp; Field, Z. (2012). Discovering Statistics Using R. Sage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bush
summary(bush)
</code></pre>

<hr>
<h2 id='bwtrim'>A robust two-way mixed ANOVA using trimmed means.
</h2><span id='topic+bwtrim'></span><span id='topic+tsplit'></span><span id='topic+sppba'></span><span id='topic+sppbb'></span><span id='topic+sppbi'></span>

<h3>Description</h3>

<p>The <code>bwtrim</code> function computes a two-way between-within subjects ANOVA on the trimmed means. It is designed for one between-subjects variable and one within-subjects variable. The functions <code>sppba</code>, <code>sppbb</code>, and <code>sppbi</code> compute the main fixed effect, the main within-subjects effect, and the interaction effect only, respectively, using bootstrap. For these 3 functions the user can choose
an M-estimator for group comparisons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bwtrim(formula, id, data, tr = 0.2, ...)
tsplit(formula, id, data, tr = 0.2, ...)
sppba(formula, id, data, est = "mom", avg = TRUE, nboot = 500, MDIS = FALSE, ...)
sppbb(formula, id, data, est = "mom", nboot = 500, ...)
sppbi(formula, id, data, est = "mom", nboot = 500, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bwtrim_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="bwtrim_+3A_id">id</code></td>
<td>

<p>subject ID.
</p>
</td></tr>
<tr><td><code id="bwtrim_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="bwtrim_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td></tr>
<tr><td><code id="bwtrim_+3A_est">est</code></td>
<td>

<p>Estimate to be used for the group comparisons: either <code>"onestep"</code> for one-step M-estimator of location using Huber's Psi, <code>"mom"</code> for the modified one-step (MOM) estimator of location based on Huber's Psi, or <code>"median"</code>.
</p>
</td></tr>
<tr><td><code id="bwtrim_+3A_avg">avg</code></td>
<td>

<p>If <code>TRUE</code>, the analysis is done by averaging K measures of location for each level of the fixed effect, and then comparing averages by testing the hypothesis that all pairwise differences are equal to zero. If <code>FALSE</code> the analysis is done by testing whether K equalities are simultaneously true.
</p>
</td></tr>
<tr><td><code id="bwtrim_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="bwtrim_+3A_mdis">MDIS</code></td>
<td>

<p>if <code>TRUE</code> the depths of the points in the bootstrap cloud are based on Mahalanobis distance, if <code>FALSE</code> a projection distance is used.
</p>
</td></tr>
<tr><td><code id="bwtrim_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>tsplit</code> function is doing exactly the same thing as <code>bwtrim</code>. It is kept in the package in order to be consistent with older versions of the Wilcox (2012) book.
For <code>sppba</code>, <code>sppbb</code>, and <code>sppbi</code> the analysis is carried out on the basis of all pairs of difference scores. The null hypothesis is that all such differences have a robust location value of zero. In the formula interface it is required to specify full model.
</p>


<h3>Value</h3>

<p><code>bwtrim</code> returns an object of class <code>"bwtrim"</code> containing:
</p>
<table>
<tr><td><code>Qa</code></td>
<td>
<p>first main effect</p>
</td></tr>
<tr><td><code>A.p.value</code></td>
<td>
<p>p-value first main effect</p>
</td></tr>
<tr><td><code>A.df</code></td>
<td>
<p>df F-distribution first main effect</p>
</td></tr>
<tr><td><code>Qb</code></td>
<td>
<p>second main effect</p>
</td></tr>
<tr><td><code>B.p.value</code></td>
<td>
<p>p-value second main effect</p>
</td></tr>
<tr><td><code>B.df</code></td>
<td>
<p>df F-distribution second main effect</p>
</td></tr>
<tr><td><code>Qab</code></td>
<td>
<p>interaction effect</p>
</td></tr>
<tr><td><code>AB.p.value</code></td>
<td>
<p>p-value interaction effect</p>
</td></tr>
<tr><td><code>AB.df</code></td>
<td>
<p>df F-distribution interaction</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
<tr><td><code>varnames</code></td>
<td>
<p>variable names</p>
</td></tr>
</table>
<p><code>sppba</code>, <code>sppbb</code>, and <code>sppbi</code> returns an object of class <code>"spp"</code> containing:
</p>
<table>
<tr><td><code>test</code></td>
<td>
<p>value of the test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>contrasts matrix</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2017). Introduction to Robust Estimation and Hypothesis Testing (4th ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t2way">t2way</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data need to be on long format
pictureLong &lt;- reshape(picture, direction = "long", varying = list(3:4), idvar = "case",
timevar = c("pictype"), times = c("couple", "alone"))
pictureLong$pictype &lt;- as.factor(pictureLong$pictype)
colnames(pictureLong)[4] &lt;- "friend_requests"

## 2-way within-between subjects ANOVA
bwtrim(friend_requests ~ relationship_status*pictype, id = case, data = pictureLong)

## between groups effect only (MOM estimator)
sppba(friend_requests ~ relationship_status*pictype, case, data = pictureLong)

## within groups effect only (MOM estimator)
sppbb(friend_requests ~ relationship_status*pictype, case, data = pictureLong)

## interaction effect only (MOM estimator)
sppbi(friend_requests ~ relationship_status*pictype, case, data = pictureLong)

</code></pre>

<hr>
<h2 id='chile'>Chile Heat and Length</h2><span id='topic+chile'></span>

<h3>Description</h3>

<p>Originally from pepperjoe.com, this dataset contains the name, length, and heat of chiles. Heat is measured on a scale from 0-11. 
(0-2 ... for sissys, 3-4 ... sort of hot, 5-6 ... fairly hot, 7-8 ... real hot, 9.5-9 ... torrid, 9.5-11 ... nuclear). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chile</code></pre>


<h3>Format</h3>

 
<p>A data frame with 3 variables and 85 observations:
</p>

<dl>
<dt><code>name</code></dt><dd><p>name of the chile</p>
</dd>
<dt><code>length</code></dt><dd><p>length in cm</p>
</dd>
<dt><code>heat</code></dt><dd><p>heat of the chile</p>
</dd>
</dl>



<h3>References</h3>

<p>Wright, D. B., &amp; London, K. (2009). Modern Regression Techniques Using R. Sage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(chile)
</code></pre>

<hr>
<h2 id='diet'>Diet and Weight Loss</h2><span id='topic+diet'></span>

<h3>Description</h3>

<p>Weight loss is studied for three different types of diets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bush</code></pre>


<h3>Format</h3>

<p>A data frame with 7 variables and 78 observations:
</p>

<dl>
<dt><code>gender</code></dt><dd><p>gender</p>
</dd>
<dt><code>age</code></dt><dd><p>age</p>
</dd>
<dt><code>height</code></dt><dd><p>body height</p>
</dd>
<dt><code>diet.type</code></dt><dd><p>three types of diet</p>
</dd>
<dt><code>initial.weight</code></dt><dd><p>initial weight before diet</p>
</dd>
<dt><code>final.weight</code></dt><dd><p>final weight after diet</p>
</dd>
<dt><code>weight.loss</code></dt><dd><p>weight loss</p>
</dd>
</dl>



<h3>References</h3>

<p>Couturier, D. L., Nicholls, R., and Fernandes, M. (2018). ANOVA with R: analysis of the diet dataset. Retrieved online. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(diet)
</code></pre>

<hr>
<h2 id='electric'>The Electric Company</h2><span id='topic+electric'></span>

<h3>Description</h3>

<p>These data are based on an educational TV show for children called &quot;The Electric Company&quot;. In each of four grades, the classes were 
randomized into treated (TV show) and control groups (no TV show). At the beginning and at the end of the school year, students in all the classes were given a reading test. The average test scores per class were recorded. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>electric</code></pre>


<h3>Format</h3>

 
<p>A data frame with 5 variables and 192 observations:
</p>

<dl>
<dt><code>City</code></dt><dd><p>Fresno and Youngstown</p>
</dd>
<dt><code>Grade</code></dt><dd><p>grade</p>
</dd>
<dt><code>Pretest</code></dt><dd><p>reading scores at the beginning of the semester</p>
</dd>
<dt><code>Posttest</code></dt><dd><p>reading scores at the end of the semester</p>
</dd>
<dt><code>Group</code></dt><dd><p>treatment vs. control</p>
</dd>
</dl>



<h3>References</h3>

<p>Gelman, A., &amp; Hill, J. (2007). Data Analysis Using Regression and Multilevel/Hierarchical Models. Cambridge University Press: New York, NY. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(electric)
</code></pre>

<hr>
<h2 id='essays'>Academic Writing Data</h2><span id='topic+essays'></span>

<h3>Description</h3>

<p>This study looked at the effects of two forms of written corrective feedback on lexico-grammatical accuracy in the academic writing of English as a foreign language university students. It had a 3x4 within-by-between design with three groups (two treatment and one control) measured over four occasions (pretest/treatment, treatment, posttest, delayed posttest).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bush</code></pre>


<h3>Format</h3>

<p>A data frame with 4 variables and 120 observations:
</p>

<dl>
<dt><code>id</code></dt><dd><p>participant ID</p>
</dd>
<dt><code>group</code></dt><dd><p>control, direct, indirect</p>
</dd>
<dt><code>essay</code></dt><dd><p>four measurement occasions</p>
</dd>
<dt><code>errorRatio</code></dt><dd><p>error ratio</p>
</dd>
</dl>



<h3>References</h3>

<p>McGrath, D. (2016). The Effects of Comprehensive Direct and Indirect Written Corrective Feedback on Accuracy in English as a Foreign Language Students' Writing (Unpublished master's thesis). Macquarie University, Sydney, Australia.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(essays)
summary(essays)
</code></pre>

<hr>
<h2 id='eurosoccer'>European Soccer Leagues</h2><span id='topic+eurosoccer'></span>

<h3>Description</h3>

<p>Contains various team stats from five European soccer leagues (2008/09 season).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eurosoccer</code></pre>


<h3>Format</h3>

<p>A data frame with 11 variables and 96 teams:
</p>

<dl>
<dt><code>League</code></dt><dd><p>Country</p>
</dd>                  
<dt><code>Team</code></dt><dd><p>Team</p>
</dd> 
<dt><code>Games</code></dt><dd><p>Number of games</p>
</dd> 
<dt><code>Won</code></dt><dd><p>Games won</p>
</dd> 
<dt><code>Tied</code></dt><dd><p>Games tied</p>
</dd> 
<dt><code>Lost</code></dt><dd><p>Games lost</p>
</dd> 
<dt><code>GoalsScored</code></dt><dd><p>Goals scored</p>
</dd> 
<dt><code>GoalsConceded</code></dt><dd><p>Goals conceded</p>
</dd> 
<dt><code>GoalDifference</code></dt><dd><p>Goal difference</p>
</dd> 
<dt><code>Points</code></dt><dd><p>Final amount of points</p>
</dd> 
<dt><code>GoalsGame</code></dt><dd><p>Goal scored per game</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>head(eurosoccer)
</code></pre>

<hr>
<h2 id='goggles'>Beer Goggles Effect</h2><span id='topic+goggles'></span>

<h3>Description</h3>

<p>This dataset is about the effects of alcohol on mate selection in night-clubs. The hypothesis is that after alcohol had been consumed, subjective perceptions of physical attractiveness would become more inaccurate (beer-goggles effect). There are 48 participants: 24 males, 24 
females. The reseacher took 3 groups of 8 participants to a night club. One group got no alcohol, one group 2 pints, and one group 4 pints. 
At the end of the evening the researcher took a photograph of the person the participant was chatting up. The attractiveness of the person 
on the photo was then evaluated by independent judges. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>goggles</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables and 48 observations:
</p>

<dl>
<dt><code>gender</code></dt><dd><p>24 male, 24 female students</p>
</dd>
<dt><code>alcohol</code></dt><dd><p>amount of alcohol consumed</p>
</dd>
<dt><code>attractiveness</code></dt><dd><p>attractiveness rating (0-100)</p>
</dd>
</dl>



<h3>Details</h3>

<p>Dataset from Field et al. book (p. 501).   
</p>


<h3>References</h3>

<p>Field, A., Miles, J, &amp; Field, Z. (2012). Discovering Statistics Using R. Sage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>goggles
summary(goggles)
</code></pre>

<hr>
<h2 id='hangover'>Hangover Symptoms</h2><span id='topic+hangover'></span>

<h3>Description</h3>

<p>In a study on the effect of consuming alcohol, hangover symptoms were measured for two independent groups, with each subject consuming alcohol and being measured on three different occasions. One group consisted of sons of alcoholics and the other was a control group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hangover</code></pre>


<h3>Format</h3>

 
<p>A data frame with 4 variables and 120 observations:
</p>

<dl>
<dt><code>symptoms</code></dt><dd><p>number of hangover symptoms</p>
</dd>
<dt><code>group</code></dt><dd><p>son of alcoholic vs. control</p>
</dd>
<dt><code>time</code></dt><dd><p>measurement occasion</p>
</dd>
<dt><code>id</code></dt><dd><p>subject ID</p>
</dd>
</dl>



<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(hangover)
</code></pre>

<hr>
<h2 id='invisibility'>Cloaks of Invisibility</h2><span id='topic+invisibility'></span>

<h3>Description</h3>

<p>We are interested in the effect that wearing a cloak of invisibility has on people's tendency to mischief. 80 participants were placed in an enclosed community. Hidden cameras recorded mischievous acts. It was recorded how many mischievous acts were conducted in the first 3 weeks (mischief1). After 3 weeks 34 participants were told that the cameras were switched off so that no one would be able to see what they're getting up to. The remaining 46 subjects were given a cloak of invisibility. These people were told not to tell anyone else about their cloak and they could wear it whenever they liked. The number of mischievous acts were recorded over the next 3 weeks (mischief2).</p>


<h3>Usage</h3>

<pre><code class='language-R'>invisibility</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables and 80 observations:
</p>

<dl>
<dt><code>cloak</code></dt><dd><p>factor with 34 subjects in the no cloak condition, 46 in the cloak condition</p>
</dd>
<dt><code>mischief1</code></dt><dd><p>number of mischievous acts during the first 3 weeks</p>
</dd>
<dt><code>mischief2</code></dt><dd><p>number of mischievous acts during the second 3 weeks</p>
</dd>
</dl>



<h3>Details</h3>

<p>Fictional dataset from Field et al. book (p. 485).   
</p>


<h3>References</h3>

<p>Field, A., Miles, J., &amp; Field, Z. (2012). Discovering Statistics Using R. Sage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>invisibility
summary(invisibility)
</code></pre>

<hr>
<h2 id='Leerkes'>Maternal Self-Efficacy</h2><span id='topic+Leerkes'></span>

<h3>Description</h3>

<p>TIn this dataset (n = 92) the relationship between how girls were raised by there own mother and their later feelings of maternal self-efficacy, i.e. our belief in our ability to succeed in specific situations. The other variable is self-esteem (can act as mediator). All variables are scored on a continuous scale from 1 to 4. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Leerkes</code></pre>


<h3>Format</h3>

 
<p>A data frame with 3 variables and 92 observations:
</p>

<dl>
<dt><code>MatCare</code></dt><dd><p>maternal care</p>
</dd>
<dt><code>Efficacy</code></dt><dd><p>maternal self-efficacy</p>
</dd>
<dt><code>Esteem</code></dt><dd><p>self-esteen</p>
</dd>
</dl>



<h3>References</h3>

<p>Leerkes, E.M. &amp; Crockenberg, S.C. (2002). The development of maternal self-efficacy and its impact on maternal behavior. Infancy, 3, 227-247.
</p>
<p>Howell, D.C. (2012). Statistical Methods for Psychology (8th edition). Wadsworth, Belmont, CA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(Leerkes)
</code></pre>

<hr>
<h2 id='med1way'>
Heteroscedastic one-way ANOVA for medians.
</h2><span id='topic+med1way'></span><span id='topic+print.med1way'></span>

<h3>Description</h3>

<p>This function computes a one-way ANOVA for the medians. Homoscedasticity assumption not required. There shouldn't be too many ties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>med1way(formula, data, iter = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="med1way_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="med1way_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="med1way_+3A_iter">iter</code></td>
<td>

<p>number of iterations to determine critical value.
</p>
</td></tr>
<tr><td><code id="med1way_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Evaluating the test statistic using the df proposed in the literature can result in the actual level being less than the nominal level, (i.e., around 0.02-0.025 when testing at the 0.05 level and the sample size is small). A better strategy is to simulate the critical
value and computing the p-value accordingly, as implemented in this function.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>med1way</code> containing:
</p>
<table>
<tr><td><code>test</code></td>
<td>
<p>F-value of the test statistic</p>
</td></tr>
<tr><td><code>crit.val</code></td>
<td>
<p>critical value</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t1way">t1way</a></code>,<code><a href="#topic+t1waybt">t1waybt</a></code>, <code><a href="#topic+Qanova">Qanova</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
med1way(libido ~ dose, data = viagra, iter = 3000)
</code></pre>

<hr>
<h2 id='med2way'>A two-way ANOVA for medians.
</h2><span id='topic+med2way'></span>

<h3>Description</h3>

<p>This function computes a two-way ANOVA medians with interactions effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>med2way(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="med2way_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="med2way_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="med2way_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There should not be too many ties in the data. The test statistics for the main effects in <code>med2way</code> are F-distributed, the (heteroscedastic) test for the interaction is chi-square distributed. Post hoc tests can be performed using
<code>mcp2a</code>.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>t2way</code> containing:
</p>
<table>
<tr><td><code>Qa</code></td>
<td>
<p>first main effect</p>
</td></tr>
<tr><td><code>A.p.value</code></td>
<td>
<p>p-value first main effect</p>
</td></tr>
<tr><td><code>Qb</code></td>
<td>
<p>second main effect</p>
</td></tr>
<tr><td><code>B.p.value</code></td>
<td>
<p>p-value second main effect</p>
</td></tr>
<tr><td><code>Qab</code></td>
<td>
<p>interaction effect</p>
</td></tr>
<tr><td><code>AB.p.value</code></td>
<td>
<p>p-value interaction effect</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
<tr><td><code>varnames</code></td>
<td>
<p>variable names</p>
</td></tr>
<tr><td><code>dim</code></td>
<td>
<p>design dimensions</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t2way">t2way</a></code>, <code><a href="#topic+med1way">med1way</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>med2way(attractiveness ~ gender*alcohol, data = goggles)
mcp2a(attractiveness ~ gender*alcohol, data = goggles, est = "median")
</code></pre>

<hr>
<h2 id='movie'>Movies and Aggressive Affect</h2><span id='topic+movie'></span>

<h3>Description</h3>

<p>Participants are randomly assigned to one of two groups. The first group watches a violent film, and the other watches a nonviolent film. Afterwards, the aggressive affect is measured, and it is desired to compare three groups, taking gender and degress into account as well.</p>


<h3>Usage</h3>

<pre><code class='language-R'>movie</code></pre>


<h3>Format</h3>

<p>A data frame with 4 variables and 68 observations:
</p>

<dl>
<dt><code>degree</code></dt><dd><p>no degree vs. degree</p>
</dd>
<dt><code>gender</code></dt><dd><p>36 males, 32 females</p>
</dd>
<dt><code>type</code></dt><dd><p>violend vs. nonviolent</p>
</dd>
<dt><code>aggressive</code></dt><dd><p>aggressive affect</p>
</dd>
</dl>



<h3>Details</h3>

<p>Artificial dataset from Wilcox book (p. 316).   
</p>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>movie
summary(movie)
</code></pre>

<hr>
<h2 id='onesampb'>One-sample percentile bootstrap</h2><span id='topic+onesampb'></span>

<h3>Description</h3>

<p>Tests whether a robust location measure (median, Huber Psi) differs from a null value and reports a 95% confidence interval based on percentile bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>onesampb(x, est = "onestep", nboot = 2000, nv = 0, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="onesampb_+3A_x">x</code></td>
<td>

<p>a numeric vector.
</p>
</td></tr>
<tr><td><code id="onesampb_+3A_est">est</code></td>
<td>

<p>robust estimator to be used (<code>"onestep"</code>, <code>"mom"</code>, or <code>"median"</code>).
</p>
</td></tr>
<tr><td><code id="onesampb_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="onesampb_+3A_nv">nv</code></td>
<td>

<p>value under H0.
</p>
</td></tr>
<tr><td><code id="onesampb_+3A_alpha">alpha</code></td>
<td>

<p>alpha level.
</p>
</td></tr>
<tr><td><code id="onesampb_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>"onesampb"</code> containing:
</p>
<table>
<tr><td><code>ci</code></td>
<td>
<p>95% confidence interval</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>robust location sample estimate</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of effective observations</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2017). Introduction to Robust Estimation and Hypothesis Testing (4th ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t1way">t1way</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x &lt;- rnorm(30)
onesampb(x, nboot = 100)    ## H0: Psi = 0

set.seed(123)
x &lt;- rlnorm(30)
onesampb(x, est = "median", nv = 1)   ## H0: median = 1
</code></pre>

<hr>
<h2 id='pbcor'>Robust correlation coefficients.
</h2><span id='topic+pbcor'></span><span id='topic+wincor'></span><span id='topic+winall'></span><span id='topic+pball'></span><span id='topic+print.pbcor'></span>

<h3>Description</h3>

<p>The <code>pbcor</code> function computes the percentage bend correlation coefficient, <code>wincor</code> the Winsorized correlation,
<code>pball</code> the percentage bend correlation matrix, <code>winall</code> the Winsorized correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pbcor(x, y = NULL, beta = 0.2, ci = FALSE, nboot = 500, alpha = 0.05, ...)
pball(x, beta = 0.2, ...)
wincor(x, y = NULL, tr = 0.2, ci = FALSE, nboot = 500, alpha = 0.05, ...)
winall(x, tr = 0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pbcor_+3A_x">x</code></td>
<td>

<p>a numeric vector, a matrix or a data frame.
</p>
</td></tr>
<tr><td><code id="pbcor_+3A_y">y</code></td>
<td>

<p>a second numeric vector (for correlation functions).
</p>
</td></tr>
<tr><td><code id="pbcor_+3A_beta">beta</code></td>
<td>

<p>bending constant.
</p>
</td></tr>
<tr><td><code id="pbcor_+3A_tr">tr</code></td>
<td>

<p>amount of Winsorization.
</p>
</td></tr>
<tr><td><code id="pbcor_+3A_ci">ci</code></td>
<td>

<p>whether boostrap CI should be computed or not.
</p>
</td></tr>
<tr><td><code id="pbcor_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples for CI computation.
</p>
</td></tr>
<tr><td><code id="pbcor_+3A_alpha">alpha</code></td>
<td>

<p>alpha level for CI computation.
</p>
</td></tr>
<tr><td><code id="pbcor_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It tested is whether the correlation coefficient equals 0 (null hypothesis) or not. Missing values are deleted pairwise. The tests are sensitive to heteroscedasticity. The test statistic H in <code>pball</code> tests the hypothesis that all correlations are equal to zero.
</p>


<h3>Value</h3>

<p><code>pbcor</code> and <code>wincor</code> return an object of class <code>"pbcor"</code> containing:
</p>
<table>
<tr><td><code>cor</code></td>
<td>
<p>robust correlation coefficient</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p>value of the test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of effective observations</p>
</td></tr>
<tr><td><code>cor_ci</code></td>
<td>
<p>bootstrap confidence interval</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>
<p><code>pball</code> and <code>winall</code> return an object of class <code>"pball"</code> containing:
</p>
<table>
<tr><td><code>pbcorm</code></td>
<td>
<p>robust correlation matrix</p>
</td></tr>
<tr><td><code>p.values</code></td>
<td>
<p>p-values</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>H-statistic</p>
</td></tr>
<tr><td><code>H.p.value</code></td>
<td>
<p>p-value H-statistic</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>variance-covariance matrix</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+twocor">twocor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 &lt;- subset(hangover, subset = (group == "control" &amp; time == 1))$symptoms
x2 &lt;- subset(hangover, subset = (group == "control" &amp; time == 2))$symptoms

pbcor(x1, x2)
pbcor(x1, x2, beta = 0.1, ci = TRUE)

wincor(x1, x2)
wincor(x1, x2, tr = 0.1, ci = TRUE)

require(reshape)
hanglong &lt;- subset(hangover, subset = group == "control")
hangwide &lt;- cast(hanglong, id ~ time, value = "symptoms")[,-1]

pball(hangwide)
winall(hangwide)
</code></pre>

<hr>
<h2 id='picture'>Profile Pictures</h2><span id='topic+picture'></span>

<h3>Description</h3>

<p>This dataset examines how the profile pictures on social network platforms affect the number of friend requests when females are in a relationship. The relationship status is a between-subject variable (part of the participants did set their status to relationship). For the first 3 weeks the subjects had a picture of their own in their profiles. For the following 3 weeks they posted a picture with a man.</p>


<h3>Usage</h3>

<pre><code class='language-R'>picture</code></pre>


<h3>Format</h3>

<p>A data frame with 4 variables and 40 observations:
</p>

<dl>
<dt><code>case</code></dt><dd><p>subject id</p>
</dd>
<dt><code>relationship_status</code></dt><dd><p>Relationship status on social network platform</p>
</dd>
<dt><code>couple</code></dt><dd><p>amount of friend requests when profile picture as couple</p>
</dd>
<dt><code>alone</code></dt><dd><p>amount of friend requests when profile picture as single</p>
</dd>
</dl>



<h3>Details</h3>

<p>Dataset from Field et al. book (p. 644).   
</p>


<h3>References</h3>

<p>Field, A., Miles, J., &amp; Field, Z. (2012). Discovering Statistics Using R. Sage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>picture
summary(picture)
</code></pre>

<hr>
<h2 id='Pygmalion'>Pygmalion Data</h2><span id='topic+Pygmalion'></span>

<h3>Description</h3>

<p>The Pygmalion effect is the phenomenon where higher expectations lead to an increase in performance. For instance, when teachers expect students to do well and show intellectual growth, they do; when teachers do not have such expectations, performance and growth are not so encouraged and may in fact be discouraged in a variety of ways. This dataset contains reasoning IQ scores of children. For the experimental group, positive expectancies 
had been suggested to teachers after the pretest. For the experimental group, no expectancies had been suggested after the pretest. 
For both groups we have reasoning IQ posttest scores. The dataset is taken from Elashoff and Snow (1970). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pygmalion</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables and 114 observations:
</p>

<dl>
<dt><code>Pretest</code></dt><dd><p>pretest score</p>
</dd>
<dt><code>Posttest</code></dt><dd><p>posttest score</p>
</dd>
<dt><code>Group</code></dt><dd><p>treatment vs. control</p>
</dd>
</dl>



<h3>References</h3>

<p>Elashoff, J. D., &amp; Snow, R. E. (1970). A case study in statistical inference: Reconsideration of the Rosenthal-Jacobson data on teacher 
expectancy. Technical Report No. 15, School of Education, Stanford University.
</p>
<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(Pygmalion)
</code></pre>

<hr>
<h2 id='Qanova'>Quantile ANOVA
</h2><span id='topic+Qanova'></span>

<h3>Description</h3>

<p>One-way ANOVA based on quantiles. Only known method to work well when tied values are likely to occur.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qanova(formula, data, q = 0.5, nboot = 600, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qanova_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="Qanova_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="Qanova_+3A_q">q</code></td>
<td>

<p>quantile (or vector of quantiles) to be used.
</p>
</td></tr>
<tr><td><code id="Qanova_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples
</p>
</td></tr>
<tr><td><code id="Qanova_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Test global hypothesis that J independent groups have equal quantiles (default: median) using the Harrell-Davis estimator. Performs well when there are tied values.
</p>


<h3>Value</h3>

<p><code>Qanova</code> an object of class <code>"qanova"</code> containing:
</p>
<table>
<tr><td><code>psihat</code></td>
<td>
<p>value of the test statistics</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>contrasts</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcomhd">qcomhd</a></code>, <code><a href="#topic+t1way">t1way</a></code>, <code><a href="#topic+discANOVA">discANOVA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## median comparison
set.seed(123)
fitmed &lt;- Qanova(libido ~ dose, viagra, nboot = 200)
fitmed

## 1st, 3rd quartile comparison
set.seed(123)
fitquart &lt;- Qanova(libido ~ dose, viagra, q = c(0.25, 0.75), nboot = 200)
fitquart



</code></pre>

<hr>
<h2 id='rmanova'> A heteroscedastic one-way repeated measures ANOVA for trimmed means.
</h2><span id='topic+rmanova'></span><span id='topic+rmmcp'></span>

<h3>Description</h3>

<p>The <code>rmanova</code> function computes a one-way repeated measures ANOVA for the trimmed means. Homoscedasticity assumption not required. Corresponding post hoc tests can be performed using <code>rmmcp</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmanova(y, groups, blocks, tr = 0.2, ...)
rmmcp(y, groups, blocks, tr = 0.2, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmanova_+3A_y">y</code></td>
<td>

<p>a numeric vector of data values (response).
</p>
</td></tr>
<tr><td><code id="rmanova_+3A_groups">groups</code></td>
<td>

<p>a vector giving the group of the corresponding elements of y.
</p>
</td></tr>
<tr><td><code id="rmanova_+3A_blocks">blocks</code></td>
<td>

<p>a vector giving the block of the corresponding elements of y.
</p>
</td></tr>
<tr><td><code id="rmanova_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td></tr>
<tr><td><code id="rmanova_+3A_alpha">alpha</code></td>
<td>

<p>alpha level for post hoc comparisons.
</p>
</td></tr>
<tr><td><code id="rmanova_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rmanova</code> an object of class <code>"t1way"</code> containing:
</p>
<table>
<tr><td><code>test</code></td>
<td>
<p>value of the test statistic</p>
</td></tr>
<tr><td><code>df1</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
<tr><td><code>df2</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>
<p><code>rmmcp</code> returns an object of class <code>"mcp1"</code> containing:
</p>
<table>
<tr><td><code>comp</code></td>
<td>
<p>inference for all pairwise comparisons</p>
</td></tr>
<tr><td><code>fnames</code></td>
<td>
<p>names of the factor levels</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmanovab">rmanovab</a></code>, <code><a href="#topic+med1way">med1way</a></code>, <code><a href="#topic+t1way">t1way</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(WineTasting)
rmanova(WineTasting$Taste, WineTasting$Wine, WineTasting$Taster)

## post hoc
rmmcp(WineTasting$Taste, WineTasting$Wine, WineTasting$Taster)

head(bush)
require(reshape)
bushLong &lt;- melt(bush, id.var = "participant", variable_name = "food")
rmanova(bushLong$value, bushLong$food, bushLong$participant)

## post hoc
rmmcp(bushLong$value, bushLong$food, bushLong$participant)


</code></pre>

<hr>
<h2 id='rmanovab'> A heteroscedastic one-way repeated measures bootstrap ANOVA for trimmed means.
</h2><span id='topic+rmanovab'></span><span id='topic+pairdepb'></span>

<h3>Description</h3>

<p>The <code>rmanovab</code> function computes a bootstrap version of the one-way repeated measures ANOVA for the trimmed means. Homoscedasticity assumption not required. Corresponding post hoc tests can be performed using <code>pairdepb</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmanovab(y, groups, blocks, tr = 0.2, nboot = 599, ...)
pairdepb(y, groups, blocks, tr = 0.2, nboot = 599, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmanovab_+3A_y">y</code></td>
<td>

<p>a numeric vector of data values (response).
</p>
</td></tr>
<tr><td><code id="rmanovab_+3A_groups">groups</code></td>
<td>

<p>a vector giving the group of the corresponding elements of y.
</p>
</td></tr>
<tr><td><code id="rmanovab_+3A_blocks">blocks</code></td>
<td>

<p>a vector giving the block of the corresponding elements of y.
</p>
</td></tr>
<tr><td><code id="rmanovab_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td></tr>
<tr><td><code id="rmanovab_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="rmanovab_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>rmanovab</code> an object of class <code>"rmanovab"</code> containing:
</p>
<table>
<tr><td><code>test</code></td>
<td>
<p>value of the test statistic</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>critical value</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>
<p><code>pairdepb</code> returns an object of class <code>"mcp2"</code> containing:
</p>
<table>
<tr><td><code>comp</code></td>
<td>
<p>inference for all pairwise comparisons</p>
</td></tr>
<tr><td><code>fnames</code></td>
<td>
<p>names of the factor levels</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmanova">rmanova</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
rmanovab(WineTasting$Taste, WineTasting$Wine, WineTasting$Taster, nboot = 300)

## post hoc
set.seed(123)
pairdepb(WineTasting$Taste, WineTasting$Wine, WineTasting$Taster, nboot = 300)

</code></pre>

<hr>
<h2 id='runmean'>Running Interval Smoother
</h2><span id='topic+runmean'></span><span id='topic+rungen'></span><span id='topic+runmbo'></span>

<h3>Description</h3>

<p>The <code>runmean</code> implements a running interval smoother on the trimmed mean, <code>rungen</code> uses general M-estimators, <code>runmbo</code> performs
interval smoothing on M-estimators with bagging.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runmean(x, y, fr = 1, tr = 0.2, ...)
rungen(x, y, fr = 1, est = "mom", ...)
runmbo(x, y, fr = 1, est = "mom", nboot = 40, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runmean_+3A_x">x</code></td>
<td>

<p>a numeric vector of data values (predictor)
</p>
</td></tr>
<tr><td><code id="runmean_+3A_y">y</code></td>
<td>

<p>a numeric vector of data values (response)
</p>
</td></tr>
<tr><td><code id="runmean_+3A_fr">fr</code></td>
<td>

<p>smoothing factor (see details)
</p>
</td></tr>
<tr><td><code id="runmean_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean
</p>
</td></tr>
<tr><td><code id="runmean_+3A_est">est</code></td>
<td>

<p>type of M-estimator (<code>"mom"</code>, <code>"onestep"</code>, or <code>"median"</code>)
</p>
</td></tr>
<tr><td><code id="runmean_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples
</p>
</td></tr>
<tr><td><code id="runmean_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The larger the smoothing factor, the stronger the smoothing. Often the choice <code>fr = 1</code> gives good results; the general strategy is
to find the smallest constant so that the plot looks reasonably smooth.
</p>


<h3>Value</h3>

<p>Returns the fitted values.
</p>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ancova">ancova</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## trimmed mean smoother
fitmean &lt;- runmean(Pygmalion$Pretest, Pygmalion$Posttest)
## MOM smoother
fitmest &lt;- rungen(Pygmalion$Pretest, Pygmalion$Posttest)
## median smoother
fitmed &lt;- rungen(Pygmalion$Pretest, Pygmalion$Posttest, est = "median")
## bagged onestep smoother
fitbag &lt;- runmbo(Pygmalion$Pretest, Pygmalion$Posttest, est = "onestep")

## plot smoothers
plot(Pygmalion$Pretest, Pygmalion$Posttest, col = "gray", xlab = "Pretest", ylab = "Posttest",
     main = "Pygmalion Smoothing")
orderx &lt;- order(Pygmalion$Pretest)
lines(Pygmalion$Pretest[orderx], fitmean[orderx], lwd = 2)
lines(Pygmalion$Pretest[orderx], fitmest[orderx], lwd = 2, col = 2)
lines(Pygmalion$Pretest[orderx], fitmed[orderx], lwd = 2, col = 3)
lines(Pygmalion$Pretest[orderx], fitbag[orderx], lwd = 2, col = 4)
legend("topleft", legend = c("Trimmed Mean", "MOM", "Median", "Bagged Onestep"), col = 1:4, lty = 1)
</code></pre>

<hr>
<h2 id='spider'>Arachnophobes</h2><span id='topic+spider'></span>

<h3>Description</h3>

<p>24 arachnophobes were used in all. 12 were asked to play with a big hairy tarantula spider with big fangs and an evil look. Their subsequent anxiety was measured. The remaining 12 were shown only picture of the same hairy tarantula. Again, the anxiety was measured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spider</code></pre>


<h3>Format</h3>

<p>A data frame with 2 variables and 24 observations:
</p>

<dl>
<dt><code>Group</code></dt><dd><p>picture vs. real spider</p>
</dd>
<dt><code>Anxiety</code></dt><dd><p>anxiety measure</p>
</dd>
</dl>



<h3>Details</h3>

<p>Dataset from Field et al. book (p. 362).   
</p>


<h3>References</h3>

<p>Field, A., Miles, J., &amp; Field, Z. (2012). Discovering Statistics Using R. Sage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spider
</code></pre>

<hr>
<h2 id='swimming'>Optimistic and Pessimistic Swimmers</h2><span id='topic+swimming'></span>

<h3>Description</h3>

<p>At a swimming team practice, all participants were asked to swim their best event as far as possible, but in each case the time that was reported was falsified to indicate poorer than expected performance (i.e., each swimmer was disappointed). 30 min later, they did the same performance. The authors predicted that on the second trial more pessimistic swimmers would do worse than on their first trial,
whereas optimistic swimmers would do better. The response is ratio = Time1/Time2 (&gt; 1 means that a swimmer did better in trial 2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swimming</code></pre>


<h3>Format</h3>

<p>A data frame with 4 variables and 58 observations:
</p>

<dl>
<dt><code>Optim</code></dt><dd><p>Optimists and pessimists</p>
</dd>
<dt><code>Sex</code></dt><dd><p>Gender of the swimmer</p>
</dd>
<dt><code>Event</code></dt><dd><p>Swimming event: freestyle, breaststroke, backstroke</p>
</dd>
<dt><code>Ratio</code></dt><dd><p>Ratio between the swimming times</p>
</dd>
</dl>



<h3>References</h3>

<p>Seligman, M. E. P., Nolen-Hoeksema, S., Thornton, N., &amp; Thornton, C. M. (1990). Explanatory style as a mechanism of disappointing athletic 
performance. Psychological Science, 1, 143-146. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(swimming)
</code></pre>

<hr>
<h2 id='t1way'>A heteroscedastic one-way ANOVA for trimmed means.
</h2><span id='topic+t1way'></span><span id='topic+lincon'></span><span id='topic+print.t1way'></span>

<h3>Description</h3>

<p>The <code>t1way</code> function computes a one-way ANOVA on trimmed means. Homoscedasticity assumption not required. It uses a generalization of Welch's method. Corresponding post hoc tests can be performed using <code>lincon</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t1way(formula, data, tr = 0.2, alpha = 0.05, nboot = 100, ...)
lincon(formula, data, tr = 0.2, alpha = 0.05, method = "hochberg", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t1way_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="t1way_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="t1way_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td></tr>
<tr><td><code id="t1way_+3A_alpha">alpha</code></td>
<td>

<p>alpha level for CI computation.
</p>
</td></tr>
<tr><td><code id="t1way_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples for effect size CI computation.
</p>
</td></tr>
<tr><td><code id="t1way_+3A_method">method</code></td>
<td>

<p>method to correct the p-value (see <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>)
</p>
</td></tr>
<tr><td><code id="t1way_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the post hoc computations, confidence intervals and p-values are adjusted to control FWE. The default for the p-values is to use Hochberg's 1988 sharper Bonferroni procedure.
</p>


<h3>Value</h3>

<p><code>t1way</code> returns an object of class <code>"t1way"</code> containing:
</p>
<table>
<tr><td><code>test</code></td>
<td>
<p>value of the test statistic (F-statistic)</p>
</td></tr>
<tr><td><code>df1</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
<tr><td><code>df2</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>effsize</code></td>
<td>
<p>explanatory measure of effect size</p>
</td></tr>
<tr><td><code>effsize_ci</code></td>
<td>
<p>boostrap effect size CI</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>
<p><code>lincon</code> returns an object of class <code>"mcp1"</code> containing:
</p>
<table>
<tr><td><code>comp</code></td>
<td>
<p>inference for all pairwise comparisons</p>
</td></tr>
<tr><td><code>fnames</code></td>
<td>
<p>names of the factor levels</p>
</td></tr>
</table>
<p><code>linconv2</code> returns an object of class <code>"linconv2"</code> containing:
</p>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+med1way">med1way</a></code>,<code><a href="#topic+t1waybt">t1waybt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
t1way(libido ~ dose, data = viagra)

## post hoc tests
lincon(libido ~ dose, data = viagra)
</code></pre>

<hr>
<h2 id='t1waybt'>
Bootstrap version of the heteroscedastic one-way ANOVA for trimmed means.
</h2><span id='topic+t1waybt'></span><span id='topic+mcppb20'></span><span id='topic+print.t1waybt'></span>

<h3>Description</h3>

<p>Test the hypothesis of equal trimmed means using a percentile t bootstrap method. Corresponding post hoc tests are provided in <code>mcppb20</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t1waybt(formula, data, tr = 0.2, nboot = 599, ...)
mcppb20(formula, data, tr = 0.2, nboot = 599, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t1waybt_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="t1waybt_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="t1waybt_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td></tr>
<tr><td><code id="t1waybt_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="t1waybt_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>t1waybt</code> containing:
</p>
<table>
<tr><td><code>test</code></td>
<td>
<p>value of the test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>Var.Explained</code></td>
<td>
<p>explained amount of variance</p>
</td></tr>
<tr><td><code>Effect.Size</code></td>
<td>
<p>effect size</p>
</td></tr>
<tr><td><code>nboot.eff</code></td>
<td>
<p>effective number of bootstrap samples</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>
<p><code>mcppb20</code> returns an object of class <code>"mcp1"</code> containing:
</p>
<table>
<tr><td><code>comp</code></td>
<td>
<p>inference for all pairwise comparisons</p>
</td></tr>
<tr><td><code>fnames</code></td>
<td>
<p>names of the factor levels</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t1way">t1way</a></code>,<code><a href="#topic+med1way">med1way</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t1waybt(libido ~ dose, data = viagra)

## post hoc
mcppb20(libido ~ dose, data = viagra)
</code></pre>

<hr>
<h2 id='t2way'>A two-way ANOVA for trimmed means, M-estimators, and medians.
</h2><span id='topic+t2way'></span><span id='topic+pbad2way'></span><span id='topic+mcp2a'></span><span id='topic+mcp2atm'></span><span id='topic+print.t2way'></span><span id='topic+print.mcp'></span><span id='topic+model.matrix.mcp'></span>

<h3>Description</h3>

<p>The <code>t2way</code> function computes a two-way ANOVA for trimmed means with interactions effects. Corresponding post hoc tests are in <code>mcp2atm</code>. <code>pbad2way</code> performs a two-way ANOVA using M-estimators for location with <code>mcp2a</code> for post hoc tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t2way(formula, data, tr = 0.2, ...)
pbad2way(formula, data, est = "mom", nboot = 599, pro.dis = FALSE, ...)
mcp2atm(formula, data, tr = 0.2, ...)
mcp2a(formula, data, est = "mom", nboot = 599, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t2way_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="t2way_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="t2way_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td></tr>
<tr><td><code id="t2way_+3A_est">est</code></td>
<td>

<p>Estimate to be used for the group comparisons: either <code>"onestep"</code> for one-step M-estimator of location using Huber's Psi, <code>"mom"</code> for the modified one-step (MOM) estimator of location based on Huber's Psi, or <code>"median"</code>.
</p>
</td></tr>
<tr><td><code id="t2way_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="t2way_+3A_pro.dis">pro.dis</code></td>
<td>

<p>If <code>FALSE</code>, Mahalanobis distances are used; if <code>TRUE</code> projection distances are computed.
</p>
</td></tr>
<tr><td><code id="t2way_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>t2way</code> does not report any degrees of freedom since an adjusted critical value is used.
<code>pbad2way</code> returns p-values only; if it happens that the variance-covariance matrix in the Mahalanobis distance computation is singular, it is suggested to use the projection distances by setting <code>pro.dis = TRUE</code>.
</p>


<h3>Value</h3>

<p>The functions <code>t2way</code> and <code>pbad2way</code> return an object of class <code>t2way</code> containing:
</p>
<table>
<tr><td><code>Qa</code></td>
<td>
<p>first main effect</p>
</td></tr>
<tr><td><code>A.p.value</code></td>
<td>
<p>p-value first main effect</p>
</td></tr>
<tr><td><code>Qb</code></td>
<td>
<p>second main effect</p>
</td></tr>
<tr><td><code>B.p.value</code></td>
<td>
<p>p-value second main effect</p>
</td></tr>
<tr><td><code>Qab</code></td>
<td>
<p>interaction effect</p>
</td></tr>
<tr><td><code>AB.p.value</code></td>
<td>
<p>p-value interaction effect</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
<tr><td><code>varnames</code></td>
<td>
<p>variable names</p>
</td></tr>
<tr><td><code>dim</code></td>
<td>
<p>design dimensions</p>
</td></tr>
</table>
<p>The functions <code>mcp2atm</code> and <code>mcp2a</code> return an object of class <code>mcp</code> containing:
</p>
<table>
<tr><td><code>effects</code></td>
<td>
<p>list with post hoc comparisons for all effects</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>design matrix</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t1way">t1way</a></code>, <code><a href="#topic+med1way">med1way</a></code>, <code><a href="#topic+t2way">t2way</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 2-way ANOVA on trimmed means
t2way(attractiveness ~ gender*alcohol, data = goggles)

## post hoc tests
mcp2atm(attractiveness ~ gender*alcohol, data = goggles)

## 2-way ANOVA on MOM estimator
pbad2way(attractiveness ~ gender*alcohol, data = goggles)

## post hoc tests
mcp2a(attractiveness ~ gender*alcohol, data = goggles)

## 2-way ANOVA on medians
pbad2way(attractiveness ~ gender*alcohol, data = goggles, est = "median")

## post hoc tests
mcp2a(attractiveness ~ gender*alcohol, data = goggles, est = "median")

## extract design matrix
model.matrix(mcp2a(attractiveness ~ gender*alcohol, data = goggles, est = "median"))
</code></pre>

<hr>
<h2 id='t3way'>A three-way ANOVA for trimmed means.
</h2><span id='topic+t3way'></span><span id='topic+print.t3way'></span>

<h3>Description</h3>

<p>This function computes a three-way ANOVA for trimmed means with all interactions effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t3way(formula, data, tr = 0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t3way_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="t3way_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="t3way_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td></tr>
<tr><td><code id="t3way_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>t3way</code> containing:
</p>
<table>
<tr><td><code>Qa</code></td>
<td>
<p>first main effect</p>
</td></tr>
<tr><td><code>A.p.value</code></td>
<td>
<p>p-value first main effect</p>
</td></tr>
<tr><td><code>Qb</code></td>
<td>
<p>second main effect</p>
</td></tr>
<tr><td><code>B.p.value</code></td>
<td>
<p>p-value second main effect</p>
</td></tr>
<tr><td><code>Qc</code></td>
<td>
<p>third main effect</p>
</td></tr>
<tr><td><code>C.p.value</code></td>
<td>
<p>p-value third main effect</p>
</td></tr>
<tr><td><code>Qab</code></td>
<td>
<p>first two-way interaction effect</p>
</td></tr>
<tr><td><code>AB.p.value</code></td>
<td>
<p>p-value first two-way interaction effect</p>
</td></tr>
<tr><td><code>Qac</code></td>
<td>
<p>second two-way interaction effect</p>
</td></tr>
<tr><td><code>AC.p.value</code></td>
<td>
<p>p-value second two-way interaction effect</p>
</td></tr>
<tr><td><code>Qbc</code></td>
<td>
<p>third two-way interaction effect</p>
</td></tr>
<tr><td><code>BC.p.value</code></td>
<td>
<p>p-value third two-way interaction effect</p>
</td></tr>
<tr><td><code>Qabc</code></td>
<td>
<p>three-way interaction effect</p>
</td></tr>
<tr><td><code>ABC.p.value</code></td>
<td>
<p>p-value three-way interaction effect</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
<tr><td><code>varnames</code></td>
<td>
<p>variable names</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t1way">t1way</a></code>, <code><a href="#topic+t2way">t2way</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t3way(aggressive ~ degree*gender*type, data = movie)
</code></pre>

<hr>
<h2 id='trimcibt'>Bootstrap-t method for one-sample test</h2><span id='topic+trimcibt'></span>

<h3>Description</h3>

<p>Compute a 1-alpha confidence interval for the trimmed mean using a bootstrap percentile t method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trimcibt(x, nv = 0, tr = 0.2, alpha = 0.05, nboot = 200, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trimcibt_+3A_x">x</code></td>
<td>

<p>a numeric vector.
</p>
</td></tr>
<tr><td><code id="trimcibt_+3A_nv">nv</code></td>
<td>

<p>value under H0.
</p>
</td></tr>
<tr><td><code id="trimcibt_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td></tr>
<tr><td><code id="trimcibt_+3A_alpha">alpha</code></td>
<td>

<p>alpha level.
</p>
</td></tr>
<tr><td><code id="trimcibt_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="trimcibt_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>"trimcibt"</code> containing:
</p>
<table>
<tr><td><code>ci</code></td>
<td>
<p>95% confidence interval</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>trimmed mean</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>test.stat</code></td>
<td>
<p>t-statistic</p>
</td></tr>
<tr><td><code>tr</code></td>
<td>
<p>trimming level</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of effective observations</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2017). Introduction to Robust Estimation and Hypothesis Testing (4th ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+onesampb">onesampb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(123)
  x &lt;- rnorm(30)
  trimcibt(x, nboot = 100)    ## H0: Psi = 0
</code></pre>

<hr>
<h2 id='trimse'>Robust location measures and their standard errors (se).
</h2><span id='topic+trimse'></span><span id='topic+winmean'></span><span id='topic+winse'></span><span id='topic+msmedse'></span><span id='topic+mest'></span><span id='topic+mestse'></span><span id='topic+winvar'></span><span id='topic+onestep'></span><span id='topic+mom'></span>

<h3>Description</h3>

<p>The following functions for estimating robust location measures and their standard errors are provided: <code>winmean</code>
for the Winsorized mean, <code>winse</code> for its se, <code>trimse</code> for the trimmend mean se, <code>msmedse</code> for the median se,
<code>mest</code> for the M-estimator with se in <code>mestse</code>. The functions <code>onestep</code> and <code>mom</code> compute the one-step and
modified one-step (MOM) M-estimator. The Winsorized variance is implemented in <code>winvar</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>winmean(x, tr = 0.2, na.rm = FALSE, ...)
winvar(x, tr = 0.2, na.rm = FALSE, STAND = NULL, ...)
winse(x, tr = 0.2, ...)
trimse(x, tr = 0.2, na.rm = FALSE, ...)
msmedse(x, sewarn = TRUE, ...)
mest(x, bend = 1.28, na.rm = FALSE, ...)
mestse(x, bend = 1.28, ...)
onestep(x, bend = 1.28, na.rm = FALSE, MED = TRUE, ...)
mom(x, bend = 2.24, na.rm = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trimse_+3A_x">x</code></td>
<td>

<p>a numeric vector containing the values whose measure is to be computed.
</p>
</td></tr>
<tr><td><code id="trimse_+3A_tr">tr</code></td>
<td>

<p>trim lor Winsorizing level.
</p>
</td></tr>
<tr><td><code id="trimse_+3A_na.rm">na.rm</code></td>
<td>

<p>a logical value indicating whether NA values should be stripped before the computation proceeds.
</p>
</td></tr>
<tr><td><code id="trimse_+3A_sewarn">sewarn</code></td>
<td>

<p>a logical value indicating whether warnings for ties should be printed.
</p>
</td></tr>
<tr><td><code id="trimse_+3A_bend">bend</code></td>
<td>

<p>bending constant for M-estimator.
</p>
</td></tr>
<tr><td><code id="trimse_+3A_med">MED</code></td>
<td>

<p>if <code>TRUE</code>, median is used as initial estimate.
</p>
</td></tr>
<tr><td><code id="trimse_+3A_stand">STAND</code></td>
<td>

<p>no functionality, kept for WRS compatibility purposes.
</p>
</td></tr>
<tr><td><code id="trimse_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The standard error for the median is computed according to McKean and Shrader (1984).
</p>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>
<p>McKean, J. W., &amp; Schrader, R. M. (1984). A comparison of methods for studentizing the sample median.
Communications in Statistics - Simulation and Computation, 13, 751-773.
</p>
<p>Dana, E. (1990). Salience of the self and salience of standards: Attempts to match self to standard.
Unpublished PhD thesis, Department of Psychology, University of Southern California.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Self-awareness data (Dana, 1990): Time persons could keep a portion of an
## apparatus in contact with a specified range.
self &lt;- c(77, 87, 88, 114, 151, 210, 219, 246, 253, 262, 296, 299, 306, 376,
          428, 515, 666, 1310, 2611)
mean(self, 0.1)     ## .10 trimmed mean
trimse(self, 0.1)   ## se trimmed mean
winmean(self, 0.1)  ## Winsorized mean (.10 Winsorizing amount)
winse(self, 0.1)    ## se Winsorized mean
winvar(self, 0.1)   ## Winsorized variance
median(self)        ## median
msmedse(self)       ## se median
mest(self)          ## Huber M-estimator
mestse(self)
onestep(self)       ## one-step M-estimator
mom(self)           ## modified one-step M-estimator
</code></pre>

<hr>
<h2 id='twocor'>Confidence intervals for two-sided tests on correlation coefficients.
</h2><span id='topic+twocor'></span><span id='topic+twopcor'></span><span id='topic+print.twocor'></span>

<h3>Description</h3>

<p>The <code>twopcor</code> function tests whether the difference between two Pearson correlations is 0. The <code>twocor</code> function performs the same test on a robust correlation coefficient (percentage bend correlation or Winsorized correlation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twopcor(x1, y1, x2, y2, nboot = 599, ...)
twocor(x1, y1, x2, y2, corfun = "pbcor", nboot = 599, tr = 0.2, beta = 0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twocor_+3A_x1">x1</code></td>
<td>

<p>a numeric vector.
</p>
</td></tr>
<tr><td><code id="twocor_+3A_y1">y1</code></td>
<td>

<p>a numeric vector.
</p>
</td></tr>
<tr><td><code id="twocor_+3A_x2">x2</code></td>
<td>

<p>a numeric vector.
</p>
</td></tr>
<tr><td><code id="twocor_+3A_y2">y2</code></td>
<td>

<p>a numeric vector.
</p>
</td></tr>
<tr><td><code id="twocor_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="twocor_+3A_corfun">corfun</code></td>
<td>

<p>Either <code>"pbcor"</code> for percentage based correlation or <code>"wincor"</code> for Winsorized correlation.
</p>
</td></tr>
<tr><td><code id="twocor_+3A_tr">tr</code></td>
<td>

<p>amount of Winsorization.
</p>
</td></tr>
<tr><td><code id="twocor_+3A_beta">beta</code></td>
<td>

<p>bending constant.
</p>
</td></tr>
<tr><td><code id="twocor_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is tested whether the first correlation coefficient (based on <code>x1</code> and <code>y1</code>) equals to the second correlation coefficient (based on <code>x2</code> and <code>y2</code>). Both approaches return percentile bootstrap CIs.
</p>


<h3>Value</h3>

<p><code>twopcor</code> and <code>twocor</code> return an object of class <code>"twocor"</code> containing:
</p>
<table>
<tr><td><code>r1</code></td>
<td>
<p>robust correlation coefficient</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>value of the test statistic</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>confidence interval</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbcor">pbcor</a></code>, <code><a href="#topic+wincor">wincor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ct1 &lt;- subset(hangover, subset = (group == "control" &amp; time == 1))$symptoms
ct2 &lt;- subset(hangover, subset = (group == "control" &amp; time == 2))$symptoms
at1 &lt;- subset(hangover, subset = (group == "alcoholic" &amp; time == 1))$symptoms
at2 &lt;- subset(hangover, subset = (group == "alcoholic" &amp; time == 2))$symptoms

set.seed(111)
twopcor(ct1, ct2, at1, at2)
set.seed(123)
twocor(ct1, ct2, at1, at2, corfun = "pbcor", beta = 0.15)
set.seed(224)
twocor(ct1, ct2, at1, at2, corfun = "wincor", tr = 0.15, nboot = 50)
</code></pre>

<hr>
<h2 id='viagra'>Effects of Viagra</h2><span id='topic+viagra'></span>

<h3>Description</h3>

<p>Participants were assigned randomly to three viagra dosages (placebo, low dosage, high dosage). The dependent variable was an objective measure of libido.</p>


<h3>Usage</h3>

<pre><code class='language-R'>viagra</code></pre>


<h3>Format</h3>

<p>A data frame with 2 variables and 15 observations:
</p>

<dl>
<dt><code>dose</code></dt><dd><p>viagra dosage</p>
</dd>
<dt><code>libido</code></dt><dd><p>objective measure of libido</p>
</dd>
</dl>



<h3>Details</h3>

<p>Artificial dataset from Field et al. book (p. 401).   
</p>


<h3>References</h3>

<p>Field, A., Miles, J., &amp; Field, Z. (2012). Discovering Statistics Using R. Sage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>viagra
</code></pre>

<hr>
<h2 id='WineTasting'>Wine Tasting</h2><span id='topic+WineTasting'></span>

<h3>Description</h3>

<p>In this hypothetical dataset we have three types of wine (A, B and C). We asked 22 friends to taste each of the three wines (in a blind fold fashion), and then to give a grade of 1 to 7. We asked them to rate the wines 5 times each, and then averaged their results to give a number for a persons preference for each wine. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WineTasting</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables and 66 observations:
</p>

<dl>
<dt><code>Taste</code></dt><dd><p>Taste Rating</p>
</dd>
<dt><code>Wine</code></dt><dd><p>Wine (A, B, C)</p>
</dd>
<dt><code>Taster</code></dt><dd><p>Taster (index)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>WineTasting
summary(WineTasting)
</code></pre>

<hr>
<h2 id='wmcpAKP'>
Effect size for dependent samples ANOVA
</h2><span id='topic+wmcpAKP'></span>

<h3>Description</h3>

<p>Compute an AKP-type effect size for dependent sample ANOVA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wmcpAKP(x, tr = 0.2, nboot = 200, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wmcpAKP_+3A_x">x</code></td>
<td>

<p>data frame in wide format (no missing values allowed)
</p>
</td></tr>
<tr><td><code id="wmcpAKP_+3A_tr">tr</code></td>
<td>

<p>trim level for the means.
</p>
</td></tr>
<tr><td><code id="wmcpAKP_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="wmcpAKP_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The computation is based on a modification of the Algina-Keselman-Penfield effect size for J dependent samples.
</p>


<h3>References</h3>

<p>Algina, J., Keselman, H.J., &amp; Penfield, R.D. (2005). An alternative to Cohen's standardized mean difference effect size: A robust parameter and confidence interval in the two independent groups case. Psychological Methods, 10, 317-328.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmanova">rmanova</a></code>, <code><a href="#topic+yuend">yuend</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
require(reshape)
WineLong &lt;- cast(WineTasting, Taster ~ Wine, value = "Taste")[,-1]
set.seed(123)
effsize &lt;- wmcpAKP(WineLong, nboot = 20)
effsize

## End(Not run)
</code></pre>

<hr>
<h2 id='yuen'>Independent samples t-tests on robust location measures including effect sizes.
</h2><span id='topic+yuen'></span><span id='topic+yuenbt'></span><span id='topic+yuenbt'></span><span id='topic+pb2gen'></span><span id='topic+medpb2'></span><span id='topic+qcomhd'></span><span id='topic+akp.effect'></span><span id='topic+yuen.effect.ci'></span><span id='topic+print.yuen'></span><span id='topic+print.pb2'></span>

<h3>Description</h3>

<p>The function <code>yuen</code> performs Yuen's test for trimmed means, <code>yuenbt</code> is a bootstrap version of it. <code>akp.effect</code> and <code>yuen.effect.ci</code> can be used for effect size computation. The <code>pb2gen</code> function performs a t-test based on various robust estimators, <code>medpb2</code> compares two independent groups using medians, and <code>qcomhd</code> compares arbitrary quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yuen(formula, data, tr = 0.2, ...)
yuenbt(formula, data, tr = 0.2, nboot = 599, side = TRUE, ...)
akp.effect(formula, data, EQVAR = TRUE, tr = 0.2, nboot = 200, alpha = 0.05, ...)
yuen.effect.ci(formula, data, tr = 0.2, nboot = 400, alpha = 0.05, ...)
pb2gen(formula, data, est = "mom", nboot = 599, ...)
medpb2(formula, data, nboot = 2000, ...)
qcomhd(formula, data, q = c(0.1, 0.25, 0.5, 0.75, 0.9),
       nboot = 2000, alpha = 0.05, ADJ.CI = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yuen_+3A_formula">formula</code></td>
<td>

<p>an object of class formula.
</p>
</td></tr>
<tr><td><code id="yuen_+3A_data">data</code></td>
<td>

<p>an optional data frame for the input data.
</p>
</td></tr>
<tr><td><code id="yuen_+3A_tr">tr</code></td>
<td>

<p>trim level for the mean.
</p>
</td></tr>
<tr><td><code id="yuen_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="yuen_+3A_side">side</code></td>
<td>

<p><code>side = TRUE</code> indicates two-sided method using absolute value of the  test statistics within the bootstrap; otherwise the equal-tailed method is used.
</p>
</td></tr>
<tr><td><code id="yuen_+3A_est">est</code></td>
<td>

<p>estimate to be used for the group comparisons: either <code>"onestep"</code> for one-step M-estimator of location using Huber's Psi, <code>"mom"</code> for the modified one-step (MOM) estimator of location based on Huber's Psi, or <code>"median"</code>, <code>"mean"</code>.
</p>
</td></tr>
<tr><td><code id="yuen_+3A_q">q</code></td>
<td>

<p>quantiles to be used for comparison.
</p>
</td></tr>
<tr><td><code id="yuen_+3A_alpha">alpha</code></td>
<td>

<p>alpha level.
</p>
</td></tr>
<tr><td><code id="yuen_+3A_adj.ci">ADJ.CI</code></td>
<td>

<p>whether CIs should be adjusted.
</p>
</td></tr>
<tr><td><code id="yuen_+3A_eqvar">EQVAR</code></td>
<td>

<p>whether variances are assumed to be equal across groups.
</p>
</td></tr>
<tr><td><code id="yuen_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>yuenbt</code> is used, p-value computed only when <code>side = TRUE</code>. <code>medpb2</code> is just a wrapper function for <code>pb2gen</code> with the median
as M-estimator. It is the only known method to work well in simulations when tied values are likely to occur.<code>qcomhd</code> returns p-values and critical p-values based on Hochberg's method.
</p>


<h3>Value</h3>

<p>Returns objects of classes <code>"yuen"</code> or <code>"pb2"</code> containing:
</p>
<table>
<tr><td><code>test</code></td>
<td>
<p>value of the test statistic (t-statistic)</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>confidence interval</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degress of freedom</p>
</td></tr>
<tr><td><code>diff</code></td>
<td>
<p>trimmed mean difference</p>
</td></tr>
<tr><td><code>effsize</code></td>
<td>
<p>explanatory measure of effect size</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>
<p><code>qcomhd</code> returns an object of class <code>"robtab"</code> containing:
</p>
<table>
<tr><td><code>partable</code></td>
<td>
<p>parameter table</p>
</td></tr>
</table>


<h3>References</h3>

<p>Algina, J., Keselman, H.J., &amp; Penfield, R.D. (2005). An alternative to Cohen's standardized mean difference effect size: A robust parameter and confidence interval in the two independent groups case. Psychological Methods, 10, 317-328.
</p>
<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>
<p>Wilcox, R., &amp; Tian, T. (2011). Measuring effect size: A robust heteroscedastic approach for two or more groups. Journal of Applied Statistics, 38, 1359-1368.
</p>
<p>Yuen, K. K. (1974). The two sample trimmed t for unequal population variances. Biometrika, 61, 165-170.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t1way">t1way</a></code>,<code><a href="#topic+t1waybt">t1waybt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
## Yuen's test
yuen(Anxiety ~ Group, data = spider)

## Bootstrap version of Yuen's test (symmetric CIs)
yuenbt(Anxiety ~ Group, data = spider)

## Robust Cohen's delta
akp.effect(Anxiety ~ Group, data = spider)

## Using an M-estimator
pb2gen(Anxiety ~ Group, data = spider, est = "mom")
pb2gen(Anxiety ~ Group, data = spider, est = "mean")
pb2gen(Anxiety ~ Group, data = spider, est = "median")

## Using the median
medpb2(Anxiety ~ Group, data = spider)

## Quantiles
set.seed(123)
qcomhd(Anxiety ~ Group, data = spider, q = c(0.8, 0.85, 0.9), nboot = 500)
</code></pre>

<hr>
<h2 id='yuend'>Paired samples robust t-tests.
</h2><span id='topic+yuend'></span><span id='topic+Dqcomhd'></span><span id='topic+dep.effect'></span>

<h3>Description</h3>

<p>The function <code>yuend</code> performs Yuen's test on trimmed means for dependent samples. <code>Dqcomhd</code> compares the quantiles of the marginal distributions associated with two dependent groups via hd estimator. Tied values are allowed.
<code>dep.effect</code> computes various effect sizes and confidence intervals for two dependent samples (see Details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yuend(x, y, tr = 0.2, ...)
Dqcomhd(x, y, q = c(1:9)/10, nboot = 1000, na.rm = TRUE, ...)
dep.effect(x, y, tr = 0.2, nboot = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yuend_+3A_x">x</code></td>
<td>

<p>an numeric vector of data values (e.g. for time 1).
</p>
</td></tr>
<tr><td><code id="yuend_+3A_y">y</code></td>
<td>

<p>an numeric vector of data values (e.g. for time 2).
</p>
</td></tr>
<tr><td><code id="yuend_+3A_tr">tr</code></td>
<td>

<p>trim level for the means.
</p>
</td></tr>
<tr><td><code id="yuend_+3A_q">q</code></td>
<td>

<p>quantiles to be compared.
</p>
</td></tr>
<tr><td><code id="yuend_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="yuend_+3A_na.rm">na.rm</code></td>
<td>

<p>whether missing values should be removed.
</p>
</td></tr>
<tr><td><code id="yuend_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic is a paired samples generalization of Yuen's independent samples t-test on trimmed means.
</p>
<p><code>dep.effect</code> computes the following effect sizes:
</p>
<p>AKP: robust standardized difference similar to  Cohen's d
</p>
<p>QS:  Quantile shift based on the median of the distribution of difference scores,
</p>
<p>QStr: Quantile shift based on the trimmed mean of the distribution of X-Y
</p>
<p>SIGN:  P(X&lt;Y), probability that for a random pair, the first is less than the second.
</p>


<h3>Value</h3>

<p><code>yuend</code> returns an object of class <code>"yuen"</code> containing:
</p>
<table>
<tr><td><code>test</code></td>
<td>
<p>value of the test statistic (t-statistic)</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>confidence interval</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degress of freedom</p>
</td></tr>
<tr><td><code>diff</code></td>
<td>
<p>trimmed mean difference</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>
<p><code>Dqcomhd</code> returns an object of class <code>"robtab"</code> containing:
</p>
<table>
<tr><td><code>partable</code></td>
<td>
<p>parameter table</p>
</td></tr>
</table>
<p><code>dep.effect</code> returns a matrix with the null value of the effect size, the estimated effect size, small/medium/large conventions, and lower/upper CI bounds.
</p>


<h3>References</h3>

<p>Wilcox, R. (2012). Introduction to Robust Estimation and Hypothesis Testing (3rd ed.). Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+yuen">yuen</a></code>, <code><a href="#topic+qcomhd">qcomhd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Cholesterol data from Wilcox (2012, p. 197)
before &lt;- c(190, 210, 300,240, 280, 170, 280, 250, 240, 220)
after &lt;- c(210, 210, 340, 190, 260, 180, 200, 220, 230, 200)
yuend(before, after)

set.seed(123)
Dqcomhd(before, after, nboot = 200, q = c(0.25, 0.5, 0.75))

set.seed(123)
dep.effect(before, after)
</code></pre>

<hr>
<h2 id='ZYmediate'>Robust mediation test
</h2><span id='topic+ZYmediate'></span>

<h3>Description</h3>

<p>Performs a robust mediation test according to the method proposed by Zu &amp; Yuan (2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ZYmediate(x, y, med, nboot = 2000, alpha = 0.05, kappa = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ZYmediate_+3A_x">x</code></td>
<td>

<p>vector with predictor values.
</p>
</td></tr>
<tr><td><code id="ZYmediate_+3A_y">y</code></td>
<td>

<p>vector with response values.
</p>
</td></tr>
<tr><td><code id="ZYmediate_+3A_med">med</code></td>
<td>

<p>vector with mediator values.
</p>
</td></tr>
<tr><td><code id="ZYmediate_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap samples.
</p>
</td></tr>
<tr><td><code id="ZYmediate_+3A_alpha">alpha</code></td>
<td>

<p>alpha level.
</p>
</td></tr>
<tr><td><code id="ZYmediate_+3A_kappa">kappa</code></td>
<td>

<p>the percent of cases to be controlled when robust method is used.
</p>
</td></tr>
<tr><td><code id="ZYmediate_+3A_...">...</code></td>
<td>

<p>currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ZYmediate</code> returns an object of class <code>"robmed"</code> containing:
</p>
<table>
<tr><td><code>a.est</code></td>
<td>
<p>effect of predictor on mediator)</p>
</td></tr>
<tr><td><code>b.est</code></td>
<td>
<p>effect of mediator on response (in multiple regression model which includes the predictor as well)</p>
</td></tr>
<tr><td><code>ab.est</code></td>
<td>
<p>indirect effect (mediation effect)</p>
</td></tr>
<tr><td><code>CI.ab</code></td>
<td>
<p>confidence interval mediation effect</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value mediation test</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zu J., Yuan, K.-H. (2010). Local influence and robust procedures for mediation analysis. Multivariate Behavioral Research, 45, 1-44.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Leerkes data:
## Y: Efficacy
## X: MatCare
## M: Esteem

## fitting robust mediator regressions
require(MASS)
summary(rlm(Efficacy ~ MatCare, data = Leerkes))
summary(rlm(Esteem ~ MatCare, data = Leerkes))
summary(rlm(Efficacy ~ MatCare + Esteem, data = Leerkes))

## robust testing of mediating effect (indirect effect)
with(Leerkes, ZYmediate(MatCare, Efficacy, Esteem))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
