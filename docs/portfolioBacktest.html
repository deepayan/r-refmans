<!DOCTYPE html><html lang="en"><head><title>Help for package portfolioBacktest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {portfolioBacktest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#portfolioBacktest-package'><p>portfolioBacktest: Automated Backtesting of Portfolios over Multiple Datasets</p></a></li>
<li><a href='#add_performance'><p>Add a new performance measure to backtests</p></a></li>
<li><a href='#backtestBoxPlot'><p>Create boxplot from backtest results</p></a></li>
<li><a href='#backtestChartCumReturn'><p>Chart of the cumulative returns or wealth for a single backtest</p></a></li>
<li><a href='#backtestChartDrawdown'><p>Chart of the drawdown for a single backtest</p></a></li>
<li><a href='#backtestChartSharpeRatio'><p>Chart of the rolling Sharpe ratio over time for a single backtest</p></a></li>
<li><a href='#backtestChartStackedBar'><p>Chart of the weight allocation over time for a portfolio over a single backtest</p></a></li>
<li><a href='#backtestLeaderboard'><p>Leaderboard of portfolios from the backtest results</p></a></li>
<li><a href='#backtestSelector'><p>Selector of portfolio backtest results</p></a></li>
<li><a href='#backtestSummary'><p>Summary of portfolio backtest</p></a></li>
<li><a href='#backtestTable'><p>Table with portfolio backtest results</p></a></li>
<li><a href='#dataset10'><p>Ten datasets obtained by resampling the S&amp;P 500</p></a></li>
<li><a href='#financialDataResample'><p>Generate random resamples from financial data</p></a></li>
<li><a href='#genRandomFuns'><p>Generate multiple versions of a function with randomly chosen parameters</p></a></li>
<li><a href='#listPortfoliosWithFailures'><p>List portfolios with failures</p></a></li>
<li><a href='#plotPerformanceVsParams'><p>Plot performance of portfolio function vs choice of parameters</p></a></li>
<li><a href='#portfolioBacktest'><p>Backtest multiple portfolios over multiple datasets of stock prices in a rolling-window basis</p></a></li>
<li><a href='#SP500_symbols'><p>Stock symbols of the S&amp;P 500 constituents</p></a></li>
<li><a href='#stockDataDownload'><p>Download stock data from the Internet</p></a></li>
<li><a href='#stockDataResample'><p>Generate random resamples from financial data</p></a></li>
<li><a href='#summaryBarPlot'><p>Create barplot from backtest summary</p></a></li>
<li><a href='#summaryTable'><p>Create table from backtest summary</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Automated Backtesting of Portfolios over Multiple Datasets</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-22</td>
</tr>
<tr>
<td>Description:</td>
<td>Automated backtesting of multiple portfolios over multiple 
    datasets of stock prices in a rolling-window fashion. Intended for 
    researchers and practitioners to backtest a set of different portfolios, 
    as well as by a course instructor to assess the students in their portfolio 
    design in a fully automated and convenient manner, with results conveniently 
    formatted in tables and plots. Each portfolio design is easily defined as a
    function that takes as input a window of the stock prices and outputs the 
    portfolio weights. Multiple portfolios can be easily specified as a list 
    of functions or as files in a folder. Multiple datasets can be conveniently 
    extracted randomly from different markets, different time periods, and 
    different subsets of the stock universe. The results can be later assessed 
    and ranked with tables based on a number of performance criteria (e.g., 
    expected return, volatility, Sharpe ratio, drawdown, turnover rate, return 
    on investment, computational time, etc.), as well as plotted in a number of 
    ways with nice barplots and boxplots.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel P. Palomar &lt;daniel.p.palomar@gmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=portfolioBacktest">https://CRAN.R-project.org/package=portfolioBacktest</a>,
<a href="https://github.com/dppalomar/portfolioBacktest">https://github.com/dppalomar/portfolioBacktest</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dppalomar/portfolioBacktest/issues">https://github.com/dppalomar/portfolioBacktest/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>digest, evaluate, ggplot2, pbapply, PerformanceAnalytics,
parallel, quadprog, quantmod, R.utils, rlang, stats, utils,
xts, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>CVXR, DT, ggfortify, gridExtra, knitr, prettydoc, readtext,
rmarkdown, R.rsp, scales, stringi, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown, R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-22 02:21:55 UTC; palomar</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel P. Palomar [cre, aut],
  Rui Zhou [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-22 08:30:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='portfolioBacktest-package'>portfolioBacktest: Automated Backtesting of Portfolios over Multiple Datasets</h2><span id='topic+portfolioBacktest-package'></span>

<h3>Description</h3>

<p>Automated backtesting of multiple portfolios over multiple 
datasets of stock prices in a rolling-window fashion. Intended for 
researchers and practitioners to backtest a set of different portfolios, 
as well as by a course instructor to assess the students in their portfolio 
design in a fully automated and convenient manner, with results conveniently 
formatted in tables and plots. Each portfolio design is easily defined as a
function that takes as input a window of the stock prices and outputs the 
portfolio weights. Multiple portfolios can be easily specified as a list 
of functions or as files in a folder. Multiple datasets can be conveniently 
extracted randomly from different markets, different time periods, and 
different subsets of the stock universe. The results can be later assessed 
and ranked with tables based on a number of performance criteria (e.g., 
expected return, volatility, Sharpe ratio, drawdown, turnover rate, return 
on investment, computational time, etc.), as well as plotted in a number of 
ways with nice barplots and boxplots.
</p>


<h3>Functions</h3>

<p><code><a href="#topic+stockDataDownload">stockDataDownload</a></code>, <code><a href="#topic+financialDataResample">financialDataResample</a></code>,
<code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>, <code><a href="#topic+backtestSelector">backtestSelector</a></code>,
<code><a href="#topic+backtestTable">backtestTable</a></code>, <code><a href="#topic+backtestBoxPlot">backtestBoxPlot</a></code>, <code><a href="#topic+backtestLeaderboard">backtestLeaderboard</a></code>,
<code><a href="#topic+backtestChartCumReturn">backtestChartCumReturn</a></code>, <code><a href="#topic+backtestChartDrawdown">backtestChartDrawdown</a></code>, <code><a href="#topic+backtestChartStackedBar">backtestChartStackedBar</a></code>
<code><a href="#topic+backtestSummary">backtestSummary</a></code>, <code><a href="#topic+summaryTable">summaryTable</a></code>, <code><a href="#topic+summaryBarPlot">summaryBarPlot</a></code>
</p>


<h3>Data</h3>

<p><code><a href="#topic+dataset10">dataset10</a></code>, <code><a href="#topic+SP500_symbols">SP500_symbols</a></code>
</p>


<h3>Help</h3>

<p>For a quick help see the README file:
<a href="https://github.com/dppalomar/portfolioBacktest/blob/master/README.md">GitHub-README</a>.
</p>
<p>For more details see the vignette:
<a href="https://CRAN.R-project.org/package=portfolioBacktest/vignettes/PortfolioBacktest.html">CRAN-vignette</a>.
</p>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui ZHOU
</p>

<hr>
<h2 id='add_performance'>Add a new performance measure to backtests</h2><span id='topic+add_performance'></span>

<h3>Description</h3>

<p>Add a new performance measure to backtests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_performance(bt, name, fun, desired_direction = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_performance_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="add_performance_+3A_name">name</code></td>
<td>
<p>String with name of new performance measure.</p>
</td></tr>
<tr><td><code id="add_performance_+3A_fun">fun</code></td>
<td>
<p>Function to compute new performance measure from any element returned by 
<code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>, e.g., <code>return</code>, <code>wealth</code>, and <code>w_bop</code>.</p>
</td></tr>
<tr><td><code id="add_performance_+3A_desired_direction">desired_direction</code></td>
<td>
<p>Number indicating whether the new measure is desired to be larger (1),
which is the default, or smaller (-1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the portfolio backtest results, see <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.
</p>


<h3>Author(s)</h3>

<p>Daniel P. Palomar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
EWP_portfolio &lt;- function(dataset, ...) {
  N &lt;- ncol(dataset$adjusted)
  return(rep(1/N, N))
}

# do backtest
bt &lt;- portfolioBacktest(list("EWP" = EWP_portfolio), dataset10)

# add a new performance measure
bt &lt;- add_performance(bt, name = "SR arithmetic", 
                      fun = function(return, ...) 
                               PerformanceAnalytics::SharpeRatio.annualized(return, 
                                                                            geometric = FALSE))
                               
bt &lt;- add_performance(bt, name = "avg leverage", desired_direction = -1,
                      fun = function(w_bop, ...)
                               if(anyNA(w_bop)) NA else mean(rowSums(abs(w_bop))))


</code></pre>

<hr>
<h2 id='backtestBoxPlot'>Create boxplot from backtest results</h2><span id='topic+backtestBoxPlot'></span>

<h3>Description</h3>

<p>Create boxplot from a portfolio backtest obtained with the function 
<code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>. By default the boxplot is based on the 
package <code>ggplot2</code> (also plots a dot for each single backtest), but the user can also 
specify a simple base plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backtestBoxPlot(
  bt,
  measure = "Sharpe ratio",
  ref_portfolio = NULL,
  type = c("ggplot2", "simple"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backtestBoxPlot_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="backtestBoxPlot_+3A_measure">measure</code></td>
<td>
<p>String to select a performane measure from
<code>"Sharpe ratio"</code>, <code>"max drawdown"</code>, <code>"annual return"</code>, <code>"annual volatility"</code>, 
<code>"Sterling ratio"</code>, <code>"Omega ratio"</code>, and <code>"ROT bps"</code>.
Default is <code>"Sharpe ratio"</code>.</p>
</td></tr>
<tr><td><code id="backtestBoxPlot_+3A_ref_portfolio">ref_portfolio</code></td>
<td>
<p>Reference portfolio (whose measure will be subtracted). Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="backtestBoxPlot_+3A_type">type</code></td>
<td>
<p>Type of plot. Valid options: <code>"ggplot2", "simple"</code>. Default is 
<code>"ggplot2"</code>.</p>
</td></tr>
<tr><td><code id="backtestBoxPlot_+3A_...">...</code></td>
<td>
<p>Additional parameters. For example: 
<code>mar</code> for margins as in <code>par()</code> (for the case of plot <code>type = "simple"</code>); and
<code>alpha</code> for the alpha of each backtest dot (for the case of plot <code>type = "ggplot2"</code>), 
set to <code>0</code> to remove the dots.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summaryBarPlot">summaryBarPlot</a></code>, <code><a href="#topic+backtestChartCumReturn">backtestChartCumReturn</a></code>, 
<code><a href="#topic+backtestChartDrawdown">backtestChartDrawdown</a></code>, <code><a href="#topic+backtestChartStackedBar">backtestChartStackedBar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
quintile_portfolio &lt;- function(data, ...) {
  X &lt;- diff(log(data$adjusted))[-1]  
  N &lt;- ncol(X)
  ranking &lt;- sort(colMeans(X), decreasing = TRUE, index.return = TRUE)$ix
  w &lt;- rep(0, N)
  w[ranking[1:round(N/5)]] &lt;- 1/round(N/5)
  return(w)
}

# do backtest
bt &lt;- portfolioBacktest(list("Quintile" = quintile_portfolio), dataset10,
                        benchmark = c("1/N", "index"))

# now we can plot
backtestBoxPlot(bt, "Sharpe ratio")
backtestBoxPlot(bt, "Sharpe ratio", type = "simple")


</code></pre>

<hr>
<h2 id='backtestChartCumReturn'>Chart of the cumulative returns or wealth for a single backtest</h2><span id='topic+backtestChartCumReturn'></span>

<h3>Description</h3>

<p>Create chart of the cumulative returns or wealth for a single backtest
obtained with the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.
By default the chart is based on the package <code>ggplot2</code>, but the user can also 
specify a plot based on <code>PerformanceAnalytics</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backtestChartCumReturn(
  bt,
  portfolios = names(bt),
  dataset_num = 1,
  type = c("ggplot2", "simple"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backtestChartCumReturn_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="backtestChartCumReturn_+3A_portfolios">portfolios</code></td>
<td>
<p>String with portfolio names to be charted. 
Default charts all portfolios in the backtest.</p>
</td></tr>
<tr><td><code id="backtestChartCumReturn_+3A_dataset_num">dataset_num</code></td>
<td>
<p>Dataset index to be charted. Default is <code>dataset_num = 1</code>.</p>
</td></tr>
<tr><td><code id="backtestChartCumReturn_+3A_type">type</code></td>
<td>
<p>Type of plot. Valid options: <code>"ggplot2", "simple"</code>. Default is 
<code>"ggplot2"</code>.</p>
</td></tr>
<tr><td><code id="backtestChartCumReturn_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summaryBarPlot">summaryBarPlot</a></code>, <code><a href="#topic+backtestBoxPlot">backtestBoxPlot</a></code>, 
<code><a href="#topic+backtestChartDrawdown">backtestChartDrawdown</a></code>, <code><a href="#topic+backtestChartStackedBar">backtestChartStackedBar</a></code>, <code><a href="#topic+backtestChartSharpeRatio">backtestChartSharpeRatio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
quintile_portfolio &lt;- function(data, ...) {
  X &lt;- diff(log(data$adjusted))[-1]  
  N &lt;- ncol(X)
  ranking &lt;- sort(colMeans(X), decreasing = TRUE, index.return = TRUE)$ix
  w &lt;- rep(0, N)
  w[ranking[1:round(N/5)]] &lt;- 1/round(N/5)
  return(w)
}

# do backtest
bt &lt;- portfolioBacktest(list("Quintile" = quintile_portfolio), dataset10,
                        benchmark = c("1/N", "index"))

# now we can chart
backtestChartCumReturn(bt)


</code></pre>

<hr>
<h2 id='backtestChartDrawdown'>Chart of the drawdown for a single backtest</h2><span id='topic+backtestChartDrawdown'></span>

<h3>Description</h3>

<p>Create chart of the drawdown for a single backtest
obtained with the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.
By default the chart is based on the package <code>ggplot2</code>, but the user can also 
specify a plot based on <code>PerformanceAnalytics</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backtestChartDrawdown(
  bt,
  portfolios = names(bt),
  dataset_num = 1,
  type = c("ggplot2", "simple"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backtestChartDrawdown_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="backtestChartDrawdown_+3A_portfolios">portfolios</code></td>
<td>
<p>String with portfolio names to be charted. 
Default charts all portfolios in the backtest.</p>
</td></tr>
<tr><td><code id="backtestChartDrawdown_+3A_dataset_num">dataset_num</code></td>
<td>
<p>Dataset index to be charted. Default is <code>dataset_num = 1</code>.</p>
</td></tr>
<tr><td><code id="backtestChartDrawdown_+3A_type">type</code></td>
<td>
<p>Type of plot. Valid options: <code>"ggplot2", "simple"</code>. Default is 
<code>"ggplot2"</code>.</p>
</td></tr>
<tr><td><code id="backtestChartDrawdown_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summaryBarPlot">summaryBarPlot</a></code>, <code><a href="#topic+backtestBoxPlot">backtestBoxPlot</a></code>, 
<code><a href="#topic+backtestChartCumReturn">backtestChartCumReturn</a></code>, <code><a href="#topic+backtestChartStackedBar">backtestChartStackedBar</a></code>, <code><a href="#topic+backtestChartSharpeRatio">backtestChartSharpeRatio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
quintile_portfolio &lt;- function(data, ...) {
  X &lt;- diff(log(data$adjusted))[-1]  
  N &lt;- ncol(X)
  ranking &lt;- sort(colMeans(X), decreasing = TRUE, index.return = TRUE)$ix
  w &lt;- rep(0, N)
  w[ranking[1:round(N/5)]] &lt;- 1/round(N/5)
  return(w)
}

# do backtest
bt &lt;- portfolioBacktest(list("Quintile" = quintile_portfolio), dataset10,
                        benchmark = c("1/N", "index"))

# now we can chart
backtestChartDrawdown(bt)


</code></pre>

<hr>
<h2 id='backtestChartSharpeRatio'>Chart of the rolling Sharpe ratio over time for a single backtest</h2><span id='topic+backtestChartSharpeRatio'></span>

<h3>Description</h3>

<p>Create chart of the rolling Sharpe ratio over time for a single backtest
obtained with the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.
By default the chart is based on the package <code>ggplot2</code>, but the user can also 
specify a plot based on <code>PerformanceAnalytics</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backtestChartSharpeRatio(
  bt,
  portfolios = names(bt),
  dataset_num = 1,
  lookback = 100,
  by = 1,
  gap = lookback,
  bars_per_year = 252,
  type = c("ggplot2", "simple"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backtestChartSharpeRatio_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="backtestChartSharpeRatio_+3A_portfolios">portfolios</code></td>
<td>
<p>String with portfolio names to be charted. 
Default charts all portfolios in the backtest.</p>
</td></tr>
<tr><td><code id="backtestChartSharpeRatio_+3A_dataset_num">dataset_num</code></td>
<td>
<p>Dataset index to be charted. Default is <code>dataset_num = 1</code>.</p>
</td></tr>
<tr><td><code id="backtestChartSharpeRatio_+3A_lookback">lookback</code></td>
<td>
<p>Length of the lookback rolling window in periods (default is <code>100</code>).</p>
</td></tr>
<tr><td><code id="backtestChartSharpeRatio_+3A_by">by</code></td>
<td>
<p>Intervals at which the Sharpe ratio is to be calculated (default is equal to <code>1</code>).</p>
</td></tr>
<tr><td><code id="backtestChartSharpeRatio_+3A_gap">gap</code></td>
<td>
<p>Initial number of periods to skip (default is equal to <code>lookback</code>).</p>
</td></tr>
<tr><td><code id="backtestChartSharpeRatio_+3A_bars_per_year">bars_per_year</code></td>
<td>
<p>Number of bars/periods per year (default is <code>252</code>).</p>
</td></tr>
<tr><td><code id="backtestChartSharpeRatio_+3A_type">type</code></td>
<td>
<p>Type of plot. Valid options: <code>"ggplot2", "simple"</code>. Default is 
<code>"ggplot2"</code>.</p>
</td></tr>
<tr><td><code id="backtestChartSharpeRatio_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summaryBarPlot">summaryBarPlot</a></code>, <code><a href="#topic+backtestBoxPlot">backtestBoxPlot</a></code>, 
<code><a href="#topic+backtestChartCumReturn">backtestChartCumReturn</a></code>, <code><a href="#topic+backtestChartStackedBar">backtestChartStackedBar</a></code>, <code><a href="#topic+backtestChartDrawdown">backtestChartDrawdown</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
quintile_portfolio &lt;- function(data, ...) {
  X &lt;- diff(log(data$adjusted))[-1]  
  N &lt;- ncol(X)
  ranking &lt;- sort(colMeans(X), decreasing = TRUE, index.return = TRUE)$ix
  w &lt;- rep(0, N)
  w[ranking[1:round(N/5)]] &lt;- 1/round(N/5)
  return(w)
}

# do backtest
bt &lt;- portfolioBacktest(list("Quintile" = quintile_portfolio), dataset10,
                        benchmark = c("1/N", "index"))

# now we can chart
backtestChartSharpeRatio(bt)


</code></pre>

<hr>
<h2 id='backtestChartStackedBar'>Chart of the weight allocation over time for a portfolio over a single backtest</h2><span id='topic+backtestChartStackedBar'></span>

<h3>Description</h3>

<p>Create chart of the weight allocation over time for a portfolio over a single 
backtest obtained with the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.
By default the chart is based on the package <code>ggplot2</code>, but the user can also 
specify a plot based on <code>PerformanceAnalytics</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backtestChartStackedBar(
  bt,
  portfolio = names(bt[1]),
  dataset_num = 1,
  num_bars = 100,
  type = c("ggplot2", "simple"),
  legend = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backtestChartStackedBar_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="backtestChartStackedBar_+3A_portfolio">portfolio</code></td>
<td>
<p>String with portfolio name to be charted. 
Default charts the first portfolio in the backtest.</p>
</td></tr>
<tr><td><code id="backtestChartStackedBar_+3A_dataset_num">dataset_num</code></td>
<td>
<p>Dataset index to be charted. Default is <code>dataset_num = 1</code>.</p>
</td></tr>
<tr><td><code id="backtestChartStackedBar_+3A_num_bars">num_bars</code></td>
<td>
<p>Number of bars shown over time (basically a downsample of the possibly long sequence).</p>
</td></tr>
<tr><td><code id="backtestChartStackedBar_+3A_type">type</code></td>
<td>
<p>Type of plot. Valid options: <code>"ggplot2", "simple"</code>. Default is 
<code>"ggplot2"</code>.</p>
</td></tr>
<tr><td><code id="backtestChartStackedBar_+3A_legend">legend</code></td>
<td>
<p>Boolean to choose whether legend is plotted or not. Default is <code>legend = FALSE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summaryBarPlot">summaryBarPlot</a></code>, <code><a href="#topic+backtestBoxPlot">backtestBoxPlot</a></code>, 
<code><a href="#topic+backtestChartCumReturn">backtestChartCumReturn</a></code>, <code><a href="#topic+backtestChartDrawdown">backtestChartDrawdown</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# for better illustration, let's use only the first 5 stocks
dataset10_5stocks &lt;- lapply(dataset10, function(x) {x$adjusted &lt;- x$adjusted[, 1:5]; return(x)})

# define GMVP (with heuristic not to allow shorting)
GMVP_portfolio_fun &lt;- function(dataset, ...) {
  X &lt;- diff(log(dataset$adjusted))[-1]  # compute log returns
  Sigma &lt;- cov(X)  # compute SCM
  # design GMVP
  w &lt;- solve(Sigma, rep(1, nrow(Sigma)))
  w &lt;- abs(w)/sum(abs(w))
  return(w)
}

# backtest
bt &lt;- portfolioBacktest(list("GMVP" = GMVP_portfolio_fun), dataset10_5stocks, rebalance_every = 20)

# now we can chart
backtestChartStackedBar(bt, "GMVP", type = "simple")
backtestChartStackedBar(bt, "GMVP", type = "simple", legend = TRUE)
backtestChartStackedBar(bt, "GMVP")
backtestChartStackedBar(bt, "GMVP", legend = TRUE)


</code></pre>

<hr>
<h2 id='backtestLeaderboard'>Leaderboard of portfolios from the backtest results</h2><span id='topic+backtestLeaderboard'></span>

<h3>Description</h3>

<p>Leaderboard of portfolios according to the backtesting results 
and a ranking based on the combination of several performance criteria.
Since the different performance measures hava different ranges and distributions, 
each is first transformed according to its empirical distribution function (along 
the empirical distribution of the portfolios being ranked) to obtain percentile 
scores. After that transformation, each of the measures has an empirical uniform 
distribution in the interval <code>[0, 100]</code> and can be weighted to obtain the final ranking.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backtestLeaderboard(
  bt = NA,
  weights = list(),
  summary_fun = median,
  show_benchmark = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backtestLeaderboard_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="backtestLeaderboard_+3A_weights">weights</code></td>
<td>
<p>List of weights for the different performance measures as obtained 
in <code><a href="#topic+backtestSummary">backtestSummary</a>()$performance</code> (i.e., 
<code>"Sharpe ratio"</code>, <code>"max drawdown"</code>, <code>"annual return"</code>, <code>"annual volatility"</code>, 
<code>"Sterling ratio"</code>, <code>"Omega ratio"</code>, <code>"ROT bps"</code>, as well as
<code>"cpu time"</code> and <code>"failure rate"</code>.
For example: <code>weights = list("Sharpe ratio" = 8, "max drawdown" = 4)</code>.</p>
</td></tr>
<tr><td><code id="backtestLeaderboard_+3A_summary_fun">summary_fun</code></td>
<td>
<p>Summary function to be employed (e.g., <code>median</code> or <code>mean</code>).</p>
</td></tr>
<tr><td><code id="backtestLeaderboard_+3A_show_benchmark">show_benchmark</code></td>
<td>
<p>Logical value indicating whether to include benchmarks in the summary (default is <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table role = "presentation">
<tr><td><code>leaderboard_scores</code></td>
<td>
<p>Matrix with the individual scores for the portfolios (as chosen in <code>weights</code>) and the final score.</p>
</td></tr>
<tr><td><code>leaderboard_performance</code></td>
<td>
<p>Matrix with all the performance measures for the portfolios.</p>
</td></tr>
<tr><td><code>error_summary</code></td>
<td>
<p>Error messages generated by each portfolio on each dataset. 
Useful for debugging and give feedback to the portfolio managers of the 
different portfolios.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
quintile_portfolio &lt;- function(data, ...) {
  X &lt;- diff(log(data$adjusted))[-1]  
  N &lt;- ncol(X)
  ranking &lt;- sort(colMeans(X), decreasing = TRUE, index.return = TRUE)$ix
  w &lt;- rep(0, N)
  w[ranking[1:round(N/5)]] &lt;- 1/round(N/5)
  return(w)
}

# do backtest
bt &lt;- portfolioBacktest(quintile_portfolio, dataset10,
                        benchmark = c("1/N", "index"))

# see all performance measures available for the ranking
backtestSummary(bt)$performance

# show leaderboard
leaderboard &lt;- backtestLeaderboard(bt, weights = list("Sharpe ratio"  = 6,
                                                      "max drawdown"  = 1,
                                                      "ROT (bps)"     = 1,
                                                      "cpu time"      = 1,
                                                      "failure rate"  = 1))
leaderboard$leaderboard_scores


</code></pre>

<hr>
<h2 id='backtestSelector'>Selector of portfolio backtest results</h2><span id='topic+backtestSelector'></span>

<h3>Description</h3>

<p>Select the results from a portfolio backtest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backtestSelector(
  bt,
  portfolio_index = NULL,
  portfolio_name = NULL,
  measures = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backtestSelector_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="backtestSelector_+3A_portfolio_index">portfolio_index</code></td>
<td>
<p>Index number of a portfolio, e.g., <code>1</code> means to select the performance 
of the first portfolio recorded in <code>bt</code>.</p>
</td></tr>
<tr><td><code id="backtestSelector_+3A_portfolio_name">portfolio_name</code></td>
<td>
<p>String name of a portfolio, e.g., <code>"GMVP"</code> means to select the performance 
of portfolio with name <code>"GMVP"</code> in <code>bt</code>. 
Only considered when <code>portfolio_index</code> is not passed.</p>
</td></tr>
<tr><td><code id="backtestSelector_+3A_measures">measures</code></td>
<td>
<p>String vector to select performane measures (default is all) from
<code>"Sharpe ratio"</code>, <code>"max drawdown"</code>, <code>"annual return"</code>, <code>"annual volatility"</code>, 
<code>"Sterling ratio"</code>, <code>"Omega ratio"</code>, and <code>"ROT bps"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table role = "presentation">
<tr><td><code>performance</code></td>
<td>
<p>Performance measures selected by argument <code>measures</code>.</p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>Error status (<code>TRUE</code> or <code>FALSE</code>) of portfolio over each dataset
(<code>TRUE</code> is when the portfolio function generates an error or the maximum CPU time is exceeded).</p>
</td></tr>
<tr><td><code>error_message</code></td>
<td>
<p>Error messages generated by portfolio function over each dataset.
Useful for debugging purposes.</p>
</td></tr>
<tr><td><code>cpu time</code></td>
<td>
<p>CPU usage by portfolio function over each dataset.</p>
</td></tr>
<tr><td><code>portfolio</code></td>
<td>
<p>Portfolio weights generated by portfolio function over each dataset.</p>
</td></tr>
<tr><td><code>return</code></td>
<td>
<p>Portfolio returns over each dataset.</p>
</td></tr>
<tr><td><code>wealth</code></td>
<td>
<p>Portfolio wealth (aka cumulative returns or cumulative P&amp;L) over each dataset.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rui Zhou and Daniel P. Palomar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data("dataset10")  # load dataset

# define your own portfolio function
EWP_portfolio &lt;- function(dataset, ...) {
  N &lt;- ncol(dataset$adjusted)
  return(rep(1/N, N))
}

# do backtest
bt &lt;- portfolioBacktest(list("EWP" = EWP_portfolio), dataset10)

# extract your interested portfolio result
bt_sel &lt;- backtestSelector(bt, portfolio_name = "EWP")
names(bt_sel)


</code></pre>

<hr>
<h2 id='backtestSummary'>Summary of portfolio backtest</h2><span id='topic+backtestSummary'></span>

<h3>Description</h3>

<p>Summarize the results from a portfolio backtest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backtestSummary(
  bt,
  portfolio_indexes = NA,
  portfolio_names = NA,
  summary_fun = median,
  show_benchmark = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backtestSummary_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="backtestSummary_+3A_portfolio_indexes">portfolio_indexes</code></td>
<td>
<p>Numerical vector of portfolio indexes whose performance will be summarized, 
e.g., <code>c(1, 2)</code> means to summarize the performance of the first and 
second portfolios recorded in <code>bt</code>.</p>
</td></tr>
<tr><td><code id="backtestSummary_+3A_portfolio_names">portfolio_names</code></td>
<td>
<p>String vector of portfolio names whose performance will be summarized, 
e.g., <code>c("EWP", "GMVP")</code> means to summarize the performance of portfolios
with names <code>"EWP"</code> and <code>"GMVP"</code> in <code>bt</code> (default is 
<code>names(bt)</code> except the benchmark names). Only considered when 
<code>portfolio_indexes</code> is not passed.</p>
</td></tr>
<tr><td><code id="backtestSummary_+3A_summary_fun">summary_fun</code></td>
<td>
<p>Summary function to be employed (e.g., <code>median</code> or <code>mean</code>).</p>
</td></tr>
<tr><td><code id="backtestSummary_+3A_show_benchmark">show_benchmark</code></td>
<td>
<p>Logical value indicating whether to include benchmarks in the summary (default is <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table role = "presentation">
<tr><td><code>performance_summary</code></td>
<td>
<p>Performance criteria: 
<code>"Sharpe ratio"</code>, <code>"max drawdown"</code>, <code>"annual return"</code>, <code>"annual volatility"</code>, 
<code>"Sterling ratio"</code>, <code>"Omega ratio"</code>, <code>"ROT bps"</code>, <code>"VaR (0.95)"</code>, <code>"CVaR (0.95)"</code>, <code>"cpu time"</code>, and <code>"failure rate"</code>.
Default is <code>"Sharpe ratio"</code>.</p>
</td></tr>
<tr><td><code>error_message</code></td>
<td>
<p>Error messages generated by each portfolio function over each dataset.
Useful for debugging purposes.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rui Zhou and Daniel P. Palomar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
EWP_portfolio &lt;- function(dataset, ...) {
  N &lt;- ncol(dataset$adjusted)
  return(rep(1/N, N))
}

# do backtest
bt &lt;- portfolioBacktest(list("EWP" = EWP_portfolio), dataset10)

# show the summary
bt_sum &lt;- backtestSummary(bt)
names(bt_sum)
bt_sum$performance_summary


</code></pre>

<hr>
<h2 id='backtestTable'>Table with portfolio backtest results</h2><span id='topic+backtestTable'></span>

<h3>Description</h3>

<p>Create table with the results from a portfolio backtest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backtestTable(
  bt,
  portfolio_indexes = NA,
  portfolio_names = NA,
  show_benchmark = TRUE,
  measures = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="backtestTable_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="backtestTable_+3A_portfolio_indexes">portfolio_indexes</code></td>
<td>
<p>Numerical vector of portfolio indexes whose performance will be summarized, 
e.g., <code>c(1, 2)</code> means to summarize the performance of the first and 
second portfolios recorded in <code>bt</code>.</p>
</td></tr>
<tr><td><code id="backtestTable_+3A_portfolio_names">portfolio_names</code></td>
<td>
<p>String vector of portfolio names whose performance will be summarized, 
e.g., <code>c("EWP", "GMVP")</code> means to summarize the performance of portfolios
with names <code>"EWP"</code> and <code>"GMVP"</code> in <code>bt</code> (default is 
<code>names(bt)</code> except the benchmark names). Only considered when 
<code>portfolio_indexes</code> is not passed.</p>
</td></tr>
<tr><td><code id="backtestTable_+3A_show_benchmark">show_benchmark</code></td>
<td>
<p>Logical value indicating whether to include benchmarks in the summary (default is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="backtestTable_+3A_measures">measures</code></td>
<td>
<p>String vector to select performane measures (default is all) from
<code>"Sharpe ratio"</code>, <code>"max drawdown"</code>, <code>"annual return"</code>, <code>"annual volatility"</code>, 
<code>"Sterling ratio"</code>, <code>"Omega ratio"</code>, <code>"ROT bps"</code>,
<code>"error"</code>, <code>"cpu time"</code>, and <code>"error_message"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table role = "presentation">
<tr><td><code>&lt;performance criterion&gt;</code></td>
<td>
<p>One item per performance measures as selected by argument <code>measures</code>.</p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>Error status (<code>TRUE</code> or <code>FALSE</code>) for each portfolio over each dataset
(<code>TRUE</code> is when the portfolio function generates an error or the maximum CPU time is exceeded).</p>
</td></tr>
<tr><td><code>cpu time</code></td>
<td>
<p>CPU usage by each portfolio function over each dataset.</p>
</td></tr>
<tr><td><code>error_message</code></td>
<td>
<p>Error messages generated by each portfolio function over each dataset.
Useful for debugging purposes.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rui Zhou and Daniel P. Palomar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
EWP_portfolio &lt;- function(dataset, ...) {
  N &lt;- ncol(dataset$adjusted)
  return(rep(1/N, N))
}

# do backtest
bt &lt;- portfolioBacktest(list("EWP" = EWP_portfolio), dataset10)

# show the backtest results in table
bt_tab &lt;- backtestTable(bt)
bt_tab[c("Sharpe ratio", "max drawdown")]


</code></pre>

<hr>
<h2 id='dataset10'>Ten datasets obtained by resampling the S&amp;P 500</h2><span id='topic+dataset10'></span>

<h3>Description</h3>

<p>Ten datasets of stock market data resampled from the S&amp;P 500. 
Each resample contains a random selection of 50 stocks from the S&amp;P 500 
universe and a period of two years with a random initial point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataset10)
</code></pre>


<h3>Format</h3>

<p>List of 10 datasets, each contains two <code>xts</code> objects:
</p>

<dl>
<dt>adjusted</dt><dd><p>505 x 50 <code>xts</code> with the adjusted prices of the 50 stocks</p>
</dd>
<dt>index</dt><dd><p>505 x 1 <code>xts</code> with the market index prices</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://finance.yahoo.com">Yahoo! Finance</a>
</p>

<hr>
<h2 id='financialDataResample'>Generate random resamples from financial data</h2><span id='topic+financialDataResample'></span>

<h3>Description</h3>

<p>This function resamples the financial data (e.g., downloaded 
with <code><a href="#topic+stockDataDownload">stockDataDownload</a></code>) to obtain many datasets for a 
subsequent backtesting with <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.
Given the original data, each resample is obtained by randomly
choosing a subset of the financial instruments and randomly choosing a
time period over the available long period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>financialDataResample(
  X,
  N_sample = 50,
  T_sample = 2 * 252,
  num_datasets = 10,
  rm_stocks_with_na = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="financialDataResample_+3A_x">X</code></td>
<td>
<p>List of <code>xts</code> objects matching the structure returned by the function <code><a href="#topic+stockDataDownload">stockDataDownload</a></code>.</p>
</td></tr>
<tr><td><code id="financialDataResample_+3A_n_sample">N_sample</code></td>
<td>
<p>Desired number of financial instruments in each resample.</p>
</td></tr>
<tr><td><code id="financialDataResample_+3A_t_sample">T_sample</code></td>
<td>
<p>Desired length of each resample (consecutive samples with a random initial time).</p>
</td></tr>
<tr><td><code id="financialDataResample_+3A_num_datasets">num_datasets</code></td>
<td>
<p>Number of resampled datasets (chosen randomly among the financial instrument universe).</p>
</td></tr>
<tr><td><code id="financialDataResample_+3A_rm_stocks_with_na">rm_stocks_with_na</code></td>
<td>
<p>Logical value indicating whether to remove instruments with inner missing 
values. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of datasets resampled from <code>X</code>.
</p>


<h3>Author(s)</h3>

<p>Rui Zhou and Daniel P. Palomar
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stockDataDownload">stockDataDownload</a></code>, <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(portfolioBacktest)
data(SP500_symbols)

# download data from internet
SP500_data &lt;- stockDataDownload(stock_symbols = SP500_symbols, 
                                from = "2009-01-01", to = "2009-12-31") 
                                
# generate 20 resamples from data, each with 10 stocks and one quarter continuous data
my_dataset_list &lt;- financialDataResample(SP500_data, N = 10, T = 252/4, num_datasets = 20)

## End(Not run)

</code></pre>

<hr>
<h2 id='genRandomFuns'>Generate multiple versions of a function with randomly chosen parameters</h2><span id='topic+genRandomFuns'></span>

<h3>Description</h3>

<p>Portfolio functions usually contain some parameters that can be tuned. 
This function creates multiple versions of a function with randomly chosen parameters.
After backtesting those portfolios, the plotting function <code><a href="#topic+plotPerformanceVsParams">plotPerformanceVsParams</a></code> 
can be used to show the performance vs parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genRandomFuns(portfolio_fun, params_grid, name = "portfolio", N_funs = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genRandomFuns_+3A_portfolio_fun">portfolio_fun</code></td>
<td>
<p>Portfolio function with parameters unspecified.</p>
</td></tr>
<tr><td><code id="genRandomFuns_+3A_params_grid">params_grid</code></td>
<td>
<p>Named list containing for each parameter the possible values it can take.</p>
</td></tr>
<tr><td><code id="genRandomFuns_+3A_name">name</code></td>
<td>
<p>String with the name of the portfolio function.</p>
</td></tr>
<tr><td><code id="genRandomFuns_+3A_n_funs">N_funs</code></td>
<td>
<p>Number of functions to be generated.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotPerformanceVsParams">plotPerformanceVsParams</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(portfolioBacktest)

# define GMVP with parameters "delay", "lookback", and "regularize"
GMVP_portfolio_fun &lt;- function(dataset, ...) {
  prices &lt;- tail(lag(dataset$adjusted, delay), lookback)
  X &lt;- diff(log(prices))[-1]
  Sigma &lt;- cov(X)
  if (regularize)
    Sigma &lt;- Sigma + 0.1 * mean(diag(Sigma)) * diag(ncol(Sigma))
  # design GMVP
  w &lt;- solve(Sigma, rep(1, ncol(Sigma)))
  return(w/sum(w))
}

# generate the functions with random parameters
portfolio_list &lt;- genRandomFuns(portfolio_fun = GMVP_portfolio_fun, 
                                params_grid = list(lookback = c(100, 120, 140, 160),
                                                   delay = c(0, 5, 10, 15, 20),
                                                   regularize = c(FALSE, TRUE)),
                                name = "GMVP", 
                                N_funs = 40)
names(portfolio_list)
portfolio_list[[1]]
rlang::env_print(portfolio_list[[1]])
rlang::fn_env(portfolio_list[[1]])$lookback
rlang::fn_env(portfolio_list[[1]])$delay
rlang::fn_env(portfolio_list[[1]])$regularize

</code></pre>

<hr>
<h2 id='listPortfoliosWithFailures'>List portfolios with failures</h2><span id='topic+listPortfoliosWithFailures'></span>

<h3>Description</h3>

<p>List portfolios with failures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listPortfoliosWithFailures(bt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="listPortfoliosWithFailures_+3A_bt">bt</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
portfolio_with_errors &lt;- function(dataset, ...) {
  return(NA)
}

# do backtest
bt &lt;- portfolioBacktest(list("Portfolio with errors" = portfolio_with_errors), dataset10)

listPortfoliosWithFailures(bt)


</code></pre>

<hr>
<h2 id='plotPerformanceVsParams'>Plot performance of portfolio function vs choice of parameters</h2><span id='topic+plotPerformanceVsParams'></span>

<h3>Description</h3>

<p>Portfolio functions usually contain some parameters that can be tuned. 
After generating multiple versions of a portfolio function with randomly chosen parameters
with the function <code><a href="#topic+genRandomFuns">genRandomFuns</a></code> and doing the backtesting, this function
can be used to plot the performance vs choice of parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPerformanceVsParams(
  bt_all_portfolios,
  params_subset = NULL,
  name_performance = "Sharpe ratio",
  summary_fun = median
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPerformanceVsParams_+3A_bt_all_portfolios">bt_all_portfolios</code></td>
<td>
<p>Backtest results as produced by the function <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code>.</p>
</td></tr>
<tr><td><code id="plotPerformanceVsParams_+3A_params_subset">params_subset</code></td>
<td>
<p>List of named parameters with a subset of the values to be considered. By 
default all the possible values will be considered.</p>
</td></tr>
<tr><td><code id="plotPerformanceVsParams_+3A_name_performance">name_performance</code></td>
<td>
<p>String with the name of the performance measure to be used.</p>
</td></tr>
<tr><td><code id="plotPerformanceVsParams_+3A_summary_fun">summary_fun</code></td>
<td>
<p>Summary function to be employed (e.g., median or mean). Defult is median.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code><a href="#topic+genRandomFuns">genRandomFuns</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)

# define GMVP with parameters "delay", "lookback", and "regularize"
GMVP_portfolio_fun &lt;- function(dataset, ...) {
  prices &lt;- tail(lag(dataset$adjusted, delay), lookback)
  X &lt;- diff(log(prices))[-1]
  Sigma &lt;- cov(X)
  if (regularize)
    Sigma &lt;- Sigma + 0.01*diag(ncol(Sigma))
  # design GMVP
  w &lt;- solve(Sigma, rep(1, ncol(Sigma)))
  return(w/sum(w))
}

# generate the functions with random parameters
portfolio_list &lt;- genRandomFuns(portfolio_fun = GMVP_portfolio_fun, 
                                params_grid = list(lookback = c(100, 120, 140, 160),
                                                   delay = c(0, 5, 10, 15, 20),
                                                   regularize = c(FALSE, TRUE)),
                                name = "GMVP", 
                                N_funs = 40)
                                
# backtest portfolios
bt &lt;- portfolioBacktest(portfolio_list, dataset10)

# plot
plotPerformanceVsParams(bt)
plotPerformanceVsParams(bt, params_subset = list(regularize = TRUE))
plotPerformanceVsParams(bt, params_subset = list(delay = 5))
plotPerformanceVsParams(bt, params_subset = list(delay = 5, regularize = TRUE))


</code></pre>

<hr>
<h2 id='portfolioBacktest'>Backtest multiple portfolios over multiple datasets of stock prices in a rolling-window basis</h2><span id='topic+portfolioBacktest'></span>

<h3>Description</h3>

<p>Automated backtesting of multiple portfolios over multiple 
datasets of stock prices in a rolling-window fashion. 
Each portfolio design is easily defined as a
function that takes as input a window of the stock prices and outputs the 
portfolio weights. Multiple portfolios can be easily specified as a list 
of functions or as files in a folder. Multiple datasets can be conveniently 
obtained with the function <code><a href="#topic+financialDataResample">financialDataResample</a></code> that resamples
the data downloaded with the function <code><a href="#topic+stockDataDownload">stockDataDownload</a></code>.
The results can be later assessed and arranged with tables and plots.
The backtesting can be highly time-consuming depending on the number of 
portfolios and datasets can be performed with parallel computation over
multiple cores. Errors in functions are properly catched and handled so
that the execution of the overal backtesting is not stopped (error messages
are stored for debugging purposes). See 
<a href="https://CRAN.R-project.org/package=portfolioBacktest/vignettes/PortfolioBacktest.html">vignette</a>
for a detailed explanation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>portfolioBacktest(
  portfolio_funs = NULL,
  dataset_list,
  folder_path = NULL,
  source_to_local = TRUE,
  price_name = NULL,
  paral_portfolios = 1,
  paral_datasets = 1,
  show_progress_bar = FALSE,
  benchmarks = NULL,
  shortselling = TRUE,
  leverage = Inf,
  lookback = 252,
  T_rolling_window = NULL,
  optimize_every = 20,
  rebalance_every = 1,
  bars_per_year = 252,
  execution = c("same period", "next period"),
  cost = list(buy = 0, sell = 0, short = 0, long_leverage = 0),
  cpu_time_limit = Inf,
  return_portfolio = TRUE,
  return_returns = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="portfolioBacktest_+3A_portfolio_funs">portfolio_funs</code></td>
<td>
<p>List of functions (can also be a single function), each of them taking as input 
a dataset containing a list of <code>xts</code> objects (following the format of each 
element of the argument <code>dataset_list</code>) properly windowed (following the
rolling-window approach) and returning the portfolio as a vector of normalized
weights. See 
<a href="https://CRAN.R-project.org/package=portfolioBacktest/vignettes/PortfolioBacktest.html">vignette</a>
for details.</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_dataset_list">dataset_list</code></td>
<td>
<p>List of datasets, each containing a list of <code>xts</code> objects, as generated
by the function <code><a href="#topic+financialDataResample">financialDataResample</a></code>.</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_folder_path">folder_path</code></td>
<td>
<p>If <code>portfolio_funs</code> is not defined, this should contain the path to a folder 
containing the portfolio functions saved in files. See 
<a href="https://CRAN.R-project.org/package=portfolioBacktest/vignettes/PortfolioBacktest.html">vignette</a>
for details.</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_source_to_local">source_to_local</code></td>
<td>
<p>Logical value indicating whether to source files to local environment (default is <code>TRUE</code>).
It might be dangerous to set it to <code>FALSE</code> as in such case the global environment may be changed.
We suggest only to allow <code>FALSE</code> when the code in the source files does not work when locally 
sourced, e.g., with some versions of package <code>CVXR</code>. In that case, we further recommend to set 
<code>paral_portfolios &gt; 1</code> to avoid changing the global environment.</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_price_name">price_name</code></td>
<td>
<p>Name of the <code>xts</code> object in each dataset that contains the prices to be used in the portfolio return 
computation (default is the name of the first <code>xts</code> object).</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_paral_portfolios">paral_portfolios</code></td>
<td>
<p>Interger indicating number of portfolios to be evaluated in parallel (default is <code>1</code>),
see <a href="https://CRAN.R-project.org/package=portfolioBacktest/vignettes/PortfolioBacktest.html#parallel-backtesting">vignette-paralle-mode</a> for details.</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_paral_datasets">paral_datasets</code></td>
<td>
<p>Interger indicating number of datasets to be evaluated in parallel (default is <code>1</code>),
see <a href="https://CRAN.R-project.org/package=portfolioBacktest/vignettes/PortfolioBacktest.html#parallel-backtesting">vignette-paralle-mode</a> for details.</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_show_progress_bar">show_progress_bar</code></td>
<td>
<p>Logical value indicating whether to show progress bar (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_benchmarks">benchmarks</code></td>
<td>
<p>String vector indicating the benchmark portfolios to be incorporated, currently supports:
</p>
<ul>
<li><p><code>1/N</code> - the 1/N portfolio, <code class="reqn">w = [1/N, ..., 1/N]</code> with <code class="reqn">N</code> be number of stocks;
</p>
</li>
<li><p><code>IVP</code> - the inverse-volatility portfolio, with weights be inversely proportional the standard deviation of returns;
</p>
</li>
<li><p><code>index</code> - the market index, requires an <code>xts</code> named 'index' in the datasets.</p>
</li></ul>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_shortselling">shortselling</code></td>
<td>
<p>Logical value indicating whether shortselling is allowed or not 
(default is <code>TRUE</code>, so no control for shorselling in the backtesting).</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_leverage">leverage</code></td>
<td>
<p>Amount of leverage as in <code class="reqn">||w||_1 &lt;= leverage</code> 
(default is <code>Inf</code>, so no control for leverage in the backtesting).</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_lookback">lookback</code></td>
<td>
<p>Length of the lookback rolling window in periods (default is <code>252</code>).</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_t_rolling_window">T_rolling_window</code></td>
<td>
<p>Deprecated: use <code>lookback</code> instead.</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_optimize_every">optimize_every</code></td>
<td>
<p>How often the portfolio is to be optimized in periods (default is <code>20</code>).</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_rebalance_every">rebalance_every</code></td>
<td>
<p>How often the portfolio is to be rebalanced in periods (default is <code>1</code>).</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_bars_per_year">bars_per_year</code></td>
<td>
<p>Number of bars/periods per year. By default it will be calculated automatically 
(e.g., for daily data there are 252 bars/periods per year).</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_execution">execution</code></td>
<td>
<p>String that can be either <code>"same period"</code> (default) or <code>"next period"</code>. 
At the rebalancing period <code>t</code>, the portfolio has used information up to (and including)
period <code>t</code>. Same period execution means one can get into the position at that period <code>t</code>,
whereas the next period execution means that one can only get into the position the following period.</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_cost">cost</code></td>
<td>
<p>List containing four different types of transaction costs (common for all assets) 
for buying, selling, shorting, and long leveraging. The default is 
<code>cost = list(buy = 0e-4, sell = 0e-4, short = 0e-4, long_leverage = 0e-4)</code>.
If some elements are not specified then they will be automatically set to zero.</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_cpu_time_limit">cpu_time_limit</code></td>
<td>
<p>Time limit for executing each portfolio function over a single data set 
(default is <code>Inf</code>, so no time limit).</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_return_portfolio">return_portfolio</code></td>
<td>
<p>Logical value indicating whether to return the portfolios (default is <code>TRUE</code>).
Three portfolio series are returned: 
<code>w_optimized</code> is the optimized portfolio at each given optimization period 
(using all the information up to and including that period, which can be executed 
either on the same period or the following period), 
<code>w_rebalanced</code> is the rebalanced portfolio at each given rebalancing period,
and <code>w_bop</code> is the &quot;beginning-of-period&quot; portfolio (i.e., at each period it contains 
the weights held in the market in the previous period so that the portfolio return at 
that period is just the product of the asset returns and <code>w_bop</code> at that period.)</p>
</td></tr>
<tr><td><code id="portfolioBacktest_+3A_return_returns">return_returns</code></td>
<td>
<p>Logical value indicating whether to return the portfolio returns (default is <code>TRUE</code>).
Three series are returned: 
<code>return</code> with the portfolio returns, 
<code>wealth</code> with the portfolio wealth (aka cumulative P&amp;L), and
<code>X_lin</code> with the returns of the assets in the universe (note that the portfolio returns
can also be obtained as <code>rowSums(X_lin * w_bop)</code> in the absence of transaction costs).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the portfolio backtest results, see 
<a href="https://CRAN.R-project.org/package=portfolioBacktest/vignettes/PortfolioBacktest.html#result-format">vignette-result-format</a>
for details. It can be accessed directly, but we highly recommend the use of the package specific functions to extract 
any required information, namely, <code><a href="#topic+backtestSelector">backtestSelector</a></code>, <code><a href="#topic+backtestTable">backtestTable</a></code>, 
<code><a href="#topic+backtestBoxPlot">backtestBoxPlot</a></code>, <code><a href="#topic+backtestLeaderboard">backtestLeaderboard</a></code>,
<code><a href="#topic+backtestSummary">backtestSummary</a></code>, <code><a href="#topic+summaryTable">summaryTable</a></code>, <code><a href="#topic+summaryBarPlot">summaryBarPlot</a></code>.
</p>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stockDataDownload">stockDataDownload</a></code>, <code><a href="#topic+financialDataResample">financialDataResample</a></code>,
<code><a href="#topic+backtestSelector">backtestSelector</a></code>, <code><a href="#topic+backtestTable">backtestTable</a></code>, 
<code><a href="#topic+backtestBoxPlot">backtestBoxPlot</a></code>, <code><a href="#topic+backtestLeaderboard">backtestLeaderboard</a></code>,
<code><a href="#topic+backtestSummary">backtestSummary</a></code>, <code><a href="#topic+summaryTable">summaryTable</a></code>, <code><a href="#topic+summaryBarPlot">summaryBarPlot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
ewp_portfolio &lt;- function(dataset, ...) {
  N &lt;- ncol(dataset$adjusted)
  return(rep(1/N, N))
}

# do backtest
bt &lt;- portfolioBacktest(list("EWP" = ewp_portfolio), dataset10)

# check your result
names(bt)
backtestSelector(bt, portfolio_name = "EWP", measures = c("Sharpe ratio", "max drawdown"))
backtestTable(bt, measures = c("Sharpe ratio", "max drawdown"))
bt_summary &lt;- backtestSummary(bt)
summaryTable(bt_summary)


</code></pre>

<hr>
<h2 id='SP500_symbols'>Stock symbols of the S&amp;P 500 constituents</h2><span id='topic+SP500_symbols'></span>

<h3>Description</h3>

<p>Stock symbols of the S&amp;P 500 constituents
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SP500_symbols)
</code></pre>


<h3>Format</h3>

<p>String vector of stock symbols of the S&amp;P 500 constituents. 
The market index symbol is concluded as the attribute &quot;index_symbol&quot;.
</p>


<h3>Source</h3>

<p><a href="https://finance.yahoo.com">Yahoo! Finance</a>
</p>

<hr>
<h2 id='stockDataDownload'>Download stock data from the Internet</h2><span id='topic+stockDataDownload'></span>

<h3>Description</h3>

<p>This function is basically a robust wrapper for 
<code><a href="quantmod.html#topic+getSymbols">quantmod:getSymbols</a></code> to download stock 
data from the internet. It will return 6 <code>xts</code> objects of the same 
dimensions named 'open', 'high', 'low', 'close', 'volume', 'adjusted' 
and 'index'. Additionally, it can return an <code>xts</code> object with an 
index. If the download for some stock fails after a few attempts they 
will be ignored and reported. Also, stocks with missing values can be 
optionally removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stockDataDownload(
  stock_symbols,
  index_symbol = NULL,
  from,
  to,
  rm_stocks_with_na = TRUE,
  local_file_path = getwd(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stockDataDownload_+3A_stock_symbols">stock_symbols</code></td>
<td>
<p>String vector containing the symbols of the stocks to be downloaded.
User can pass the market index symbol as its attribute 'index_symbol&ldquo; 
(only considered when argument 'index_symbol' is not passed).</p>
</td></tr>
<tr><td><code id="stockDataDownload_+3A_index_symbol">index_symbol</code></td>
<td>
<p>String of the market index symbol.</p>
</td></tr>
<tr><td><code id="stockDataDownload_+3A_from">from</code></td>
<td>
<p>String as the starting date, e.g., &quot;2017-08-17&quot;.</p>
</td></tr>
<tr><td><code id="stockDataDownload_+3A_to">to</code></td>
<td>
<p>String as the ending date (not included), e.g., &quot;2017-09-17&quot;.</p>
</td></tr>
<tr><td><code id="stockDataDownload_+3A_rm_stocks_with_na">rm_stocks_with_na</code></td>
<td>
<p>Logical value indicating whether to remove stocks with missing values 
(ignoring leading missing values). Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="stockDataDownload_+3A_local_file_path">local_file_path</code></td>
<td>
<p>Path where the stock data will be saved after the first time is downloaded, 
so that in future retrievals it will be locally loaded (if the same 
arguments are used). Default is <code>getwd()</code>. If local caching is not 
desired, it can be deactivated by setting <code>local_file_path = NULL</code>.</p>
</td></tr>
<tr><td><code id="stockDataDownload_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="quantmod.html#topic+getSymbols">quantmod:getSymbols</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of 7 <code>xts</code> objects named 'open', 'high', 'low', 'close', 'volume', 
'adjusted' and 'index'. Note that 'index' will only be returned when correct index symbols is passed.
</p>


<h3>Author(s)</h3>

<p>Rui Zhou and Daniel P. Palomar
</p>


<h3>See Also</h3>

<p><code><a href="#topic+financialDataResample">financialDataResample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(portfolioBacktest)
data(SP500_symbols)

# download data from internet
SP500_data &lt;- stockDataDownload(stock_symbols = SP500_symbols,
                                from = "2009-01-01", to = "2009-12-31")

## End(Not run)

</code></pre>

<hr>
<h2 id='stockDataResample'>Generate random resamples from financial data</h2><span id='topic+stockDataResample'></span>

<h3>Description</h3>

<p>This function is deprecated. Use instead <code><a href="#topic+financialDataResample">financialDataResample</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stockDataResample(
  X,
  N_sample = 50,
  T_sample = 2 * 252,
  num_datasets = 10,
  rm_stocks_with_na = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stockDataResample_+3A_x">X</code></td>
<td>
<p>List of <code>xts</code> objects matching the structure returned by the function <code><a href="#topic+stockDataDownload">stockDataDownload</a></code>.</p>
</td></tr>
<tr><td><code id="stockDataResample_+3A_n_sample">N_sample</code></td>
<td>
<p>Desired number of financial instruments in each resample.</p>
</td></tr>
<tr><td><code id="stockDataResample_+3A_t_sample">T_sample</code></td>
<td>
<p>Desired length of each resample (consecutive samples with a random initial time).</p>
</td></tr>
<tr><td><code id="stockDataResample_+3A_num_datasets">num_datasets</code></td>
<td>
<p>Number of resampled datasets (chosen randomly among the financial instrument universe).</p>
</td></tr>
<tr><td><code id="stockDataResample_+3A_rm_stocks_with_na">rm_stocks_with_na</code></td>
<td>
<p>Logical value indicating whether to remove instruments with inner missing 
values. Default is <code>TRUE</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='summaryBarPlot'>Create barplot from backtest summary</h2><span id='topic+summaryBarPlot'></span>

<h3>Description</h3>

<p>After performing a backtest with <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code> 
and obtaining a summary of the performance measures with 
<code><a href="#topic+backtestSummary">backtestSummary</a></code>, this function creates a barplot from the summary. 
By default the plot is based on the package <code>ggplot2</code>, but the user
can also specify a simple base plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summaryBarPlot(bt_summary, measures = NULL, type = c("ggplot2", "simple"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summaryBarPlot_+3A_bt_summary">bt_summary</code></td>
<td>
<p>Backtest summary as obtained from the function <code>backtestSummary</code>.</p>
</td></tr>
<tr><td><code id="summaryBarPlot_+3A_measures">measures</code></td>
<td>
<p>String vector to select performane measures (default is all) from
'Sharpe ratio', 'max drawdown', 'annual return', 'annual volatility', 
'Sterling ratio', 'Omega ratio', 'ROT bps', etc.</p>
</td></tr>
<tr><td><code id="summaryBarPlot_+3A_type">type</code></td>
<td>
<p>Type of plot. Valid options: <code>"ggplot2", "simple"</code>. Default is 
<code>"ggplot2"</code>.</p>
</td></tr>
<tr><td><code id="summaryBarPlot_+3A_...">...</code></td>
<td>
<p>Additional parameters (only used for plot <code>type = "simple"</code>); 
for example: <code>mar</code> for margins as in <code>par()</code>,
<code>inset</code> for the legend inset as in <code>legend()</code>,
<code>legend_loc</code> for the legend location as in <code>legend()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summaryTable">summaryTable</a></code>, <code><a href="#topic+backtestBoxPlot">backtestBoxPlot</a></code>,
<code><a href="#topic+backtestChartCumReturn">backtestChartCumReturn</a></code>, <code><a href="#topic+backtestChartDrawdown">backtestChartDrawdown</a></code>,
<code><a href="#topic+backtestChartStackedBar">backtestChartStackedBar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
quintile_portfolio &lt;- function(data, ...) {
  X &lt;- diff(log(data$adjusted))[-1]  
  N &lt;- ncol(X)
  ranking &lt;- sort(colMeans(X), decreasing = TRUE, index.return = TRUE)$ix
  w &lt;- rep(0, N)
  w[ranking[1:round(N/5)]] &lt;- 1/round(N/5)
  return(w)
}

# do backtest
bt &lt;- portfolioBacktest(list("Quintile" = quintile_portfolio), dataset10,
                        benchmark = c("1/N", "index"))
                        
# now we can obtain the table
bt_summary_median &lt;- backtestSummary(bt)
summaryBarPlot(bt_summary_median, measures = c("max drawdown", "annual volatility"))
summaryBarPlot(bt_summary_median, measures = c("max drawdown", "annual volatility"), 
               type = "simple")


</code></pre>

<hr>
<h2 id='summaryTable'>Create table from backtest summary</h2><span id='topic+summaryTable'></span>

<h3>Description</h3>

<p>After performing a backtest with <code><a href="#topic+portfolioBacktest">portfolioBacktest</a></code> 
and obtaining a summary of the performance measures with 
<code><a href="#topic+backtestSummary">backtestSummary</a></code>, this function creates a table from the summary. 
By default the table is a simple matrix, but if the user has installed the 
package <code>DT</code> or <code>grid.table</code> nicer tables can be generated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summaryTable(
  bt_summary,
  measures = NULL,
  caption = "Performance table",
  type = c("simple", "DT", "kable", "grid.table"),
  digits = 2,
  order_col = NULL,
  order_dir = c("asc", "desc"),
  page_length = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summaryTable_+3A_bt_summary">bt_summary</code></td>
<td>
<p>Backtest summary as obtained from the function <code>backtestSummary</code>.</p>
</td></tr>
<tr><td><code id="summaryTable_+3A_measures">measures</code></td>
<td>
<p>String vector to select performane measures (default is all) from
'Sharpe ratio', 'max drawdown', 'annual return', 'annual volatility', 
'Sterling ratio', 'Omega ratio', 'ROT bps', etc.</p>
</td></tr>
<tr><td><code id="summaryTable_+3A_caption">caption</code></td>
<td>
<p>Table caption (only works for <code>type = "DT"</code>).</p>
</td></tr>
<tr><td><code id="summaryTable_+3A_type">type</code></td>
<td>
<p>Type of table. Valid options: <code>"simple", "DT", "kable", "grid.table"</code>. Default is 
<code>"simple"</code> and generates a simple matrix (with the other choices the 
corresponding package must be installed).</p>
</td></tr>
<tr><td><code id="summaryTable_+3A_digits">digits</code></td>
<td>
<p>Integer indicating the number of decimal places when rounding (default is 2).</p>
</td></tr>
<tr><td><code id="summaryTable_+3A_order_col">order_col</code></td>
<td>
<p>Column number or column name of the performance measure to be used to 
sort the rows (only used for table <code>type = "DT"</code>). By default the 
last column will be used.</p>
</td></tr>
<tr><td><code id="summaryTable_+3A_order_dir">order_dir</code></td>
<td>
<p>Direction to be used to sort the rows (only used for table 
<code>type = "DT"</code>). Valid options: <code>"asc", "desc"</code>. 
Default is <code>"asc"</code>.</p>
</td></tr>
<tr><td><code id="summaryTable_+3A_page_length">page_length</code></td>
<td>
<p>Page length for the table (only used for table <code>type = "DT"</code>). 
Default is <code>10</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summaryBarPlot">summaryBarPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
library(portfolioBacktest)
data(dataset10)  # load dataset

# define your own portfolio function
quintile_portfolio &lt;- function(data, ...) {
  X &lt;- diff(log(data$adjusted))[-1]  
  N &lt;- ncol(X)
  ranking &lt;- sort(colMeans(X), decreasing = TRUE, index.return = TRUE)$ix
  w &lt;- rep(0, N)
  w[ranking[1:round(N/5)]] &lt;- 1/round(N/5)
  return(w)
}

# do backtest
bt &lt;- portfolioBacktest(list("Quintile" = quintile_portfolio), 
                        dataset10,
                        benchmark = c("1/N", "index"))

# now we can obtain the table
bt_summary_median &lt;- backtestSummary(bt)
summaryTable(bt_summary_median, measures = c("max drawdown", "annual volatility"))
summaryTable(bt_summary_median, measures = c("max drawdown", "annual volatility"), type = "DT")
summaryTable(bt_summary_median, type = "kable") 
# this returned kable object can be combined with: " |&gt; kableExtra::kable_styling()"


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
