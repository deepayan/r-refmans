<!DOCTYPE html><html lang="en"><head><title>Help for package metagam</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {metagam}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#metagam-package'><p>metagam: Meta-analysis of generalized additive models.</p></a></li>
<li><a href='#getmasd'><p>Get maximum of the absolute standard deviations</p></a></li>
<li><a href='#make_heterogeneity_data'><p>Prepare heterogeneity data</p></a></li>
<li><a href='#metagam'><p>Meta-analysis of generalized additive models</p></a></li>
<li><a href='#plot_between_study_sd'><p>Plot between-study standard deviation</p></a></li>
<li><a href='#plot_dominance'><p>Dominance plot</p></a></li>
<li><a href='#plot_heterogeneity'><p>Heterogeneity Plot</p></a></li>
<li><a href='#plot_heterogeneity_p'><p>Heterogeneity p-plot</p></a></li>
<li><a href='#plot_heterogeneity_q'><p>Heterogeneity Q-plot</p></a></li>
<li><a href='#plot.metagam'><p>Plot estimated smooth terms</p></a></li>
<li><a href='#print.metagam'><p>Print method for metagam objects.</p></a></li>
<li><a href='#print.striprawdata'><p>Print method for striprawdata</p></a></li>
<li><a href='#print.summary.metagam'><p>Print output from summary of metagam fit.</p></a></li>
<li><a href='#strip_rawdata'><p>Strip rawdata from a generalized additive model</p></a></li>
<li><a href='#summary.metagam'><p>Summary method for metagam objects</p></a></li>
<li><a href='#summary.striprawdata'><p>Summary method for GAMs stripped for rawdata</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Meta-Analysis of Generalized Additive Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Meta-analysis of generalized additive
    models and generalized additive mixed models. A typical use case is
    when data cannot be shared across locations, and an overall meta-analytic
    fit is sought. 'metagam' provides functionality for removing individual
    participant data from models computed using the 'mgcv' and 'gamm4' packages such
    that the model objects can be shared without exposing individual data.
    Furthermore, methods for meta-analysing these fits are provided. The implemented
    methods are described in Sorensen et al. (2020), &lt;<a href="https://doi.org/10.1016%2Fj.neuroimage.2020.117416">doi:10.1016/j.neuroimage.2020.117416</a>&gt;,
    extending previous works by Schwartz and Zanobetti (2000)
    and Crippa et al. (2018) &lt;<a href="https://doi.org/10.6000%2F1929-6029.2018.07.02.1">doi:10.6000/1929-6029.2018.07.02.1</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>mgcv, ggplot2, metafor, rlang</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>roxygen2, knitr, rmarkdown, devtools, covr, testthat (&ge;
2.1.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://lifebrain.github.io/metagam/">https://lifebrain.github.io/metagam/</a>,
<a href="https://github.com/Lifebrain/metagam">https://github.com/Lifebrain/metagam</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Lifebrain/metagam/issues">https://github.com/Lifebrain/metagam/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-05 18:06:44 UTC; oyss</td>
</tr>
<tr>
<td>Author:</td>
<td>Oystein Sorensen <a href="https://orcid.org/0000-0003-0724-3542"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Andreas M. Brandmaier
    <a href="https://orcid.org/0000-0001-8765-6982"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Athanasia Mo Mowinckel
    <a href="https://orcid.org/0000-0002-5756-0223"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Oystein Sorensen &lt;oystein.sorensen@psykologi.uio.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-05 18:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='metagam-package'>metagam: Meta-analysis of generalized additive models.</h2><span id='topic+metagam-package'></span>

<h3>Description</h3>

<p>The main functions in the metagam package are described below.
</p>


<h3>Stripping rawdata</h3>

<p>The function <code><a href="#topic+strip_rawdata">strip_rawdata</a></code> takes a
fit produced by functions in packages <code>mgcv</code> or <code>gamm4</code> and
removes all individual participants data.
</p>


<h3>Meta-analysis</h3>

<p>The function <code><a href="#topic+metagam">metagam</a></code> takes a list of
fits produced by <code><a href="#topic+strip_rawdata">strip_rawdata</a></code> and computes meta-analytic
fits.
</p>


<h3>Plotting</h3>

<p>The functions <code><a href="#topic+plot_dominance">plot_dominance</a></code> and
<code><a href="#topic+plot_heterogeneity">plot_heterogeneity</a></code> can be used to study the meta-analytic fit
computed by <code><a href="#topic+strip_rawdata">strip_rawdata</a></code>.
</p>

<hr>
<h2 id='getmasd'>Get maximum of the absolute standard deviations</h2><span id='topic+getmasd'></span>

<h3>Description</h3>

<p>This code is based on Dr. Gavin Simpson's blog post https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmasd(mod, newdat, nsim, term)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getmasd_+3A_mod">mod</code></td>
<td>
<p>Object of class &quot;striprawdata&quot;, returned from <code><a href="#topic+strip_rawdata">strip_rawdata</a></code>.</p>
</td></tr>
<tr><td><code id="getmasd_+3A_newdat">newdat</code></td>
<td>
<p>Grid of values over which to create a simultaneous confidence interval.</p>
</td></tr>
<tr><td><code id="getmasd_+3A_nsim">nsim</code></td>
<td>
<p>Number of Monte Carlo samples.</p>
</td></tr>
<tr><td><code id="getmasd_+3A_term">term</code></td>
<td>
<p>Character vector of smooth terms.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of maxima of absolute standard deviations.
</p>

<hr>
<h2 id='make_heterogeneity_data'>Prepare heterogeneity data</h2><span id='topic+make_heterogeneity_data'></span>

<h3>Description</h3>

<p>Internal function to prepare
data for heterogeneity plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_heterogeneity_data(x, term, xvar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_heterogeneity_data_+3A_x">x</code></td>
<td>
<p>Object returned by <code><a href="#topic+metagam">metagam</a></code>.</p>
</td></tr>
<tr><td><code id="make_heterogeneity_data_+3A_term">term</code></td>
<td>
<p>Character specifying which smooth term to plot. Defaults to <code>NULL</code>; if <code>x</code>
was fitted with a single term, this one is taken.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>

<hr>
<h2 id='metagam'>Meta-analysis of generalized additive models</h2><span id='topic+metagam'></span>

<h3>Description</h3>

<p>Meta-analysis of generalized additive models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metagam(
  models,
  grid = NULL,
  grid_size = 100,
  type = "iterms",
  terms = NULL,
  method = "FE",
  nsim = NULL,
  ci_alpha = 0.05,
  restrict_range = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="metagam_+3A_models">models</code></td>
<td>
<p>List of generalized additive models, each of which has been
returned by <code><a href="#topic+strip_rawdata">strip_rawdata</a></code>. If the list is named, the names
will be used in the output.</p>
</td></tr>
<tr><td><code id="metagam_+3A_grid">grid</code></td>
<td>
<p>Grid of values of the explanatory variables over which to compute
the estimated smooth terms. Defaults to <code>NULL</code>, which means that a
grid is set up for the smooth terms defined by the <code>terms</code> argument,
with length given by <code>grid_size</code> for numeric variables and a single
value of each factor variable.</p>
</td></tr>
<tr><td><code id="metagam_+3A_grid_size">grid_size</code></td>
<td>
<p>Numeric value giving the number of elements to use in the
grid of explanatory variables when <code>grid=NULL</code>. When multiple terms
are supplied, each combination of values of explanatory variables are
generated, and the number of grid points becomes <code>grid_size</code> to the
power of the number of terms.</p>
</td></tr>
<tr><td><code id="metagam_+3A_type">type</code></td>
<td>
<p>Type of prediction to use. Defaults to <code>"iterms"</code>. Available
options are <code>"iterms"</code>, <code>"link"</code>, and <code>"response"</code>. See the
documentation of <code>mgcv::predict.gam</code> for details. Note that
<code>type="terms"</code> is not supported, since it may result in estimated zero
standard deviation for smooth terms.</p>
</td></tr>
<tr><td><code id="metagam_+3A_terms">terms</code></td>
<td>
<p>Character vector of terms, smooth or parametric, to be included
in function estimate. Only used if <code>type="iterms"</code>. Defaults to
<code>NULL</code>, which means that the first smooth term when listed in
alphabetic order is taken.</p>
</td></tr>
<tr><td><code id="metagam_+3A_method">method</code></td>
<td>
<p>Method of meta analysis, passed on to <code>metafor::rma.uni</code>.
Defaults to <code>"FE"</code>. See the documentation to <code>metafor::rma</code> for
all available options.</p>
</td></tr>
<tr><td><code id="metagam_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations to conduct in order to compute p-values and
simultaneous confidence bands for the meta-analytic fit. Defaults to
<code>NULL</code>, which means that no simulations are performed. Only used if
<code>type="iterms"</code>.</p>
</td></tr>
<tr><td><code id="metagam_+3A_ci_alpha">ci_alpha</code></td>
<td>
<p>Significance level for simultaneous confidence bands. Ignored
if <code>nsim</code> is <code>NULL</code>, and defaults to 0.05.</p>
</td></tr>
<tr><td><code id="metagam_+3A_restrict_range">restrict_range</code></td>
<td>
<p>Character vector of explanatory variables to restrict
such that only values within the range for each cohort contribute to the
meta-analysis. Default to <code>NULL</code>, which means that each model
contributes across the whole range specified by <code>grid</code>. Currently not
implemented.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is currently assumed that all models have been fit with the same
smooth terms, although they do not need to have the same basis functions or
knot placement. Future versions will also include meta-analysis of
parametric terms in the models.
</p>
<p>p-values are truncated below at 1e-16 before computing meta-analytic
p-values to ensure that no values are identically zero, which would imply
that the alternative hypothesis be true with no uncertainty.
</p>


<h3>Value</h3>

<p>An object of type metagam.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(metagam)
library(mgcv)

## Create 5 datasets
set.seed(1234)
datasets &lt;- lapply(1:5, function(x) gamSim(scale = 5, verbose = FALSE))

## Fit a GAM in each dataset, then use strip_rawdata() to remove
## individual participant data
models &lt;- lapply(datasets, function(dat){
  ## This uses the gam() function from mgcv
  model &lt;- gam(y ~ s(x0, bs = "cr") + s(x1, bs = "cr") + s(x2, bs = "cr"), data = dat)
  ## This uses strip_rawdata() from metagam
  strip_rawdata(model)
})

## Next, we meta-analyze the models.
## It is often most convenient to analyze a single term at a time. We focus on s(x1).
meta_analysis &lt;- metagam(models, terms = "s(x1)", grid_size = 30)

## We can print some information
summary(meta_analysis)

## We can plot the meta-analytic fit together with the individual fits
plot(meta_analysis)
plot(meta_analysis, ci = "pointwise")

## We can also compute p-values and simultaneous confidence intervals, by setting the nsim argument.
## For details, see the separate vignette.
## Not run: 
  meta_analysis &lt;- metagam(models, terms = "s(x0)", grid_size = 30, nsim = 1000)
  summary(meta_analysis)
  plot(meta_analysis, ci = "both")
  plot(meta_analysis, ci = "simultaneous")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_between_study_sd'>Plot between-study standard deviation</h2><span id='topic+plot_between_study_sd'></span>

<h3>Description</h3>

<p>When a random effects meta analysis has been used, this function
visualizes how the between-study standard deviation depends on the
explanatory variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_between_study_sd(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_between_study_sd_+3A_x">x</code></td>
<td>
<p>Object returned from <code><a href="#topic+metagam">metagam</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("mgcv")
set.seed(1233)
shifts &lt;- c(0, .5, 1, 0, -1)
datasets &lt;- lapply(shifts, function(x) {
  ## Simulate data
  dat &lt;- gamSim(scale = .1, verbose = FALSE)
  ## Add a shift
  dat$y &lt;- dat$y + x * dat$x2^2
  ## Return data
  dat
})

models &lt;- lapply(datasets, function(dat){
  b &lt;- gam(y ~ s(x2, bs = "cr"), data = dat)
  strip_rawdata(b)
})

meta_analysis &lt;- metagam(models, method = "REML")

plot_between_study_sd(meta_analysis)


</code></pre>

<hr>
<h2 id='plot_dominance'>Dominance plot</h2><span id='topic+plot_dominance'></span>

<h3>Description</h3>

<p>Plots the (relative) contribution of the individual GAMs to each data point
on a given axis. It shows whether and how parts of the axis are dominated by
certain individual GAMs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_dominance(x, term = NULL, relative = TRUE, width = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_dominance_+3A_x">x</code></td>
<td>
<p>Object returned by <code><a href="#topic+metagam">metagam</a></code>.</p>
</td></tr>
<tr><td><code id="plot_dominance_+3A_term">term</code></td>
<td>
<p>Character specifying which smooth term to plot. Default to
<code>NULL</code> which means that the first term (in alphabetic order) is taken.</p>
</td></tr>
<tr><td><code id="plot_dominance_+3A_relative">relative</code></td>
<td>
<p>Logical specifying whether to have relative or absolute
scales. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_dominance_+3A_width">width</code></td>
<td>
<p>Width of bars. Default to <code>NULL</code>, which means it is
automatically determined based on the minimum grid spacing in <code>x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette, either at https://lifebrain.github.io/metagam/articles/articles/dominance.html
# or by typing the following in the console:
# vignette("Dominance")


</code></pre>

<hr>
<h2 id='plot_heterogeneity'>Heterogeneity Plot</h2><span id='topic+plot_heterogeneity'></span>

<h3>Description</h3>

<p>Heterogeneity Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_heterogeneity(x, term = NULL, type = "Q", alpha_thresh = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_heterogeneity_+3A_x">x</code></td>
<td>
<p>Object returned by <code><a href="#topic+metagam">metagam</a></code>.</p>
</td></tr>
<tr><td><code id="plot_heterogeneity_+3A_term">term</code></td>
<td>
<p>Character specifying which smooth term to plot. Defaults to <code>NULL</code>; if <code>x</code>
was fitted with a single term, this one is taken.</p>
</td></tr>
<tr><td><code id="plot_heterogeneity_+3A_type">type</code></td>
<td>
<p>Character specifying which type of plot. Either <code>"Q"</code> for the test statistic
or <code>"p"</code> for the p-value. Defaults to <code>"Q"</code>.</p>
</td></tr>
<tr><td><code id="plot_heterogeneity_+3A_alpha_thresh">alpha_thresh</code></td>
<td>
<p>Significance level. Defaults to <code>.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot visualizes the heterogeneity along the given axis, using Cochran's Q test.
</p>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette, either at https://lifebrain.github.io/metagam/articles/heterogeneity.html
# or by typing the following in the console:
# vignette("heterogeneity")


</code></pre>

<hr>
<h2 id='plot_heterogeneity_p'>Heterogeneity p-plot</h2><span id='topic+plot_heterogeneity_p'></span>

<h3>Description</h3>

<p>Internal function to plot
the heterogeneity p values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_heterogeneity_p(data, xvar, alpha_thresh)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_heterogeneity_p_+3A_data">data</code></td>
<td>
<p>data made by <code><a href="#topic+make_heterogeneity_data">make_heterogeneity_data</a></code>.</p>
</td></tr>
<tr><td><code id="plot_heterogeneity_p_+3A_alpha_thresh">alpha_thresh</code></td>
<td>
<p>Significance level. Defaults to <code>.05</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggproto object
</p>

<hr>
<h2 id='plot_heterogeneity_q'>Heterogeneity Q-plot</h2><span id='topic+plot_heterogeneity_q'></span>

<h3>Description</h3>

<p>Internal function to plot
the heterogeneity Q values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_heterogeneity_q(data, xvar, alpha_thresh)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_heterogeneity_q_+3A_data">data</code></td>
<td>
<p>data made by <code><a href="#topic+make_heterogeneity_data">make_heterogeneity_data</a></code>.</p>
</td></tr>
<tr><td><code id="plot_heterogeneity_q_+3A_alpha_thresh">alpha_thresh</code></td>
<td>
<p>Significance level. Defaults to <code>.05</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggproto object
</p>

<hr>
<h2 id='plot.metagam'>Plot estimated smooth terms</h2><span id='topic+plot.metagam'></span>

<h3>Description</h3>

<p>Plot the meta-analytic estimate of a smooth term along with the separate fits
in each cohort.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metagam'
plot(x, term = NULL, ci = "none", legend = FALSE, only_meta = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.metagam_+3A_x">x</code></td>
<td>
<p>Object returned by <code><a href="#topic+metagam">metagam</a></code>.</p>
</td></tr>
<tr><td><code id="plot.metagam_+3A_term">term</code></td>
<td>
<p>The smooth term to plot. Defaults to <code>NULL</code>, which means
that the first term is plotted.</p>
</td></tr>
<tr><td><code id="plot.metagam_+3A_ci">ci</code></td>
<td>
<p>Type of confidence bands to plot around the meta-analytic fit.
Defaults to &quot;none&quot;, which means the no bands are plotted. Other options are
&quot;simultaneous&quot;, &quot;pointwise&quot;, and &quot;both&quot;. Simultaneous confidence bands
require that <code><a href="#topic+metagam">metagam</a></code> was run with <code>nsim</code> not equal to
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.metagam_+3A_legend">legend</code></td>
<td>
<p>Logical specifying whether or not to plot a legend. Defaults to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.metagam_+3A_only_meta">only_meta</code></td>
<td>
<p>Logical specifying whether to include the fits for each
study, or to only plot the meta-analytic fit. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.metagam_+3A_...">...</code></td>
<td>
<p>Other arguments to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function is called for its side effect of producing a plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(metagam)
library(mgcv)

## Create 5 datasets
set.seed(1234)
datasets &lt;- lapply(1:5, function(x) gamSim(scale = 5, verbose = FALSE))

## Fit a GAM in each dataset, then use strip_rawdata() to remove
## individual participant data
models &lt;- lapply(datasets, function(dat){
  ## This uses the gam() function from mgcv
  model &lt;- gam(y ~ s(x0, bs = "cr") + s(x1, bs = "cr") + s(x2, bs = "cr"), data = dat)
  ## This uses strip_rawdata() from metagam
  strip_rawdata(model)
})

## Next, we meta-analyze the models.
## It is often most convenient to analyze a single term at a time. We focus on s(x1).
meta_analysis &lt;- metagam(models, terms = "s(x1)", grid_size = 30)

## We can print some information
summary(meta_analysis)

## We can plot the meta-analytic fit together with the individual fits
plot(meta_analysis)
plot(meta_analysis, ci = "pointwise")

## We can also compute p-values and simultaneous confidence intervals, by setting the nsim argument.
## For details, see the separate vignette.
## Not run: 
  meta_analysis &lt;- metagam(models, terms = "s(x0)", grid_size = 30, nsim = 1000)
  summary(meta_analysis)
  plot(meta_analysis, ci = "both")
  plot(meta_analysis, ci = "simultaneous")

## End(Not run)
</code></pre>

<hr>
<h2 id='print.metagam'>Print method for metagam objects.</h2><span id='topic+print.metagam'></span>

<h3>Description</h3>

<p>Print method for metagam objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metagam'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.metagam_+3A_x">x</code></td>
<td>
<p>Object of class metagam.</p>
</td></tr>
<tr><td><code id="print.metagam_+3A_...">...</code></td>
<td>
<p>Other arguments (not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function invisibly returns its input argument <code>x</code>.
</p>

<hr>
<h2 id='print.striprawdata'>Print method for striprawdata</h2><span id='topic+print.striprawdata'></span>

<h3>Description</h3>

<p>Print method for striprawdata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'striprawdata'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.striprawdata_+3A_x">x</code></td>
<td>
<p>Object of class <code>striprawdata</code>.</p>
</td></tr>
<tr><td><code id="print.striprawdata_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function invisibly returns its argument.
</p>

<hr>
<h2 id='print.summary.metagam'>Print output from summary of metagam fit.</h2><span id='topic+print.summary.metagam'></span>

<h3>Description</h3>

<p>Print output from summary of metagam fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.metagam'
print(x, digits = 8, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.metagam_+3A_x">x</code></td>
<td>
<p>A summary.metagam object</p>
</td></tr>
<tr><td><code id="print.summary.metagam_+3A_digits">digits</code></td>
<td>
<p>Number of digits to print for meta-analytic p-values</p>
</td></tr>
<tr><td><code id="print.summary.metagam_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function invisibly returns its input argument <code>x</code>.
</p>

<hr>
<h2 id='strip_rawdata'>Strip rawdata from a generalized additive model</h2><span id='topic+strip_rawdata'></span><span id='topic+strip_rawdata.list'></span><span id='topic+strip_rawdata.gamm'></span><span id='topic+strip_rawdata.bam'></span><span id='topic+strip_rawdata.gam'></span>

<h3>Description</h3>

<p>This function removes all individual participant data from a generalized additive
model object, while keeping aggregated quantities. The resulting object can be
shared without exposing individual participant data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strip_rawdata(model, path = NULL, save_ranges = TRUE, ...)

## S3 method for class 'list'
strip_rawdata(model, path = NULL, save_ranges = TRUE, ...)

## S3 method for class 'gamm'
strip_rawdata(model, path = NULL, save_ranges = TRUE, ...)

## S3 method for class 'bam'
strip_rawdata(model, path = NULL, save_ranges = TRUE, ...)

## S3 method for class 'gam'
strip_rawdata(model, path = NULL, save_ranges = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strip_rawdata_+3A_model">model</code></td>
<td>
<p>A model fitted using <code>mgcv::gam</code>, <code>mgcv::bam</code>,
<code>mgcv::gamm</code>, or <code>gamm4::gamm4</code>.</p>
</td></tr>
<tr><td><code id="strip_rawdata_+3A_path">path</code></td>
<td>
<p>Optional path in which to save the object as a <code>.rds</code> file.</p>
</td></tr>
<tr><td><code id="strip_rawdata_+3A_save_ranges">save_ranges</code></td>
<td>
<p>Logical specifying whether to save the ranges of each
variable used by the model. For numeric variables this amounts to the minimum
and maximum, and for factors all levels are saved. The values will be in the
list element <code>var.summary</code> of the returned object.</p>
</td></tr>
<tr><td><code id="strip_rawdata_+3A_...">...</code></td>
<td>
<p>Other arguments (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Thin plate regression splines (<code>bs='tp'</code> and <code>bs='ts'</code>) and Duchon splines <code>bs='ds'</code>
are currently not supported, since for these splines <code>mgcv</code>
requires the unique values of the explanatory variables for each smooth term for the <code>predict</code>
method to work. Future updates to this package will fix this.
</p>


<h3>Value</h3>

<p>Model object with individual participant data removed.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>strip_rawdata(list)</code>: Strip rawdata from list object returned by gamm4
</p>
</li>
<li> <p><code>strip_rawdata(gamm)</code>: Strip rawdata from gamm object
</p>
</li>
<li> <p><code>strip_rawdata(bam)</code>: Strip rawdata from gam object
</p>
</li>
<li> <p><code>strip_rawdata(gam)</code>: Strip rawdata from gam object
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>library(metagam)
library(mgcv)

## Create 5 datasets
set.seed(1234)
datasets &lt;- lapply(1:5, function(x) gamSim(scale = 5, verbose = FALSE))

## Fit a GAM in each dataset, then use strip_rawdata() to remove
## individual participant data
models &lt;- lapply(datasets, function(dat){
  ## This uses the gam() function from mgcv
  model &lt;- gam(y ~ s(x0, bs = "cr") + s(x1, bs = "cr") + s(x2, bs = "cr"), data = dat)
  ## This uses strip_rawdata() from metagam
  strip_rawdata(model)
})

## Next, we meta-analyze the models.
## It is often most convenient to analyze a single term at a time. We focus on s(x1).
meta_analysis &lt;- metagam(models, terms = "s(x1)", grid_size = 30)

## We can print some information
summary(meta_analysis)

## We can plot the meta-analytic fit together with the individual fits
plot(meta_analysis)
plot(meta_analysis, ci = "pointwise")

## We can also compute p-values and simultaneous confidence intervals, by setting the nsim argument.
## For details, see the separate vignette.
## Not run: 
  meta_analysis &lt;- metagam(models, terms = "s(x0)", grid_size = 30, nsim = 1000)
  summary(meta_analysis)
  plot(meta_analysis, ci = "both")
  plot(meta_analysis, ci = "simultaneous")

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.metagam'>Summary method for metagam objects</h2><span id='topic+summary.metagam'></span>

<h3>Description</h3>

<p>Summary method for metagam objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metagam'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.metagam_+3A_object">object</code></td>
<td>
<p>A metagam object as returned by <code><a href="#topic+metagam">metagam</a></code>.</p>
</td></tr>
<tr><td><code id="summary.metagam_+3A_...">...</code></td>
<td>
<p>other arguments (not used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>summary.metagam</code> containing the following information:
</p>

<ul>
<li> <p><code>meta_pvals</code>: dataframe with p-values from each individual fit. These can be meta-analytically
combined using the <code>metap</code> package.
</p>
</li>
<li> <p><code>terms</code>: smooth terms that have been meta-analyzed.
</p>
</li>
<li> <p><code>method</code>: method used for meta-analysis. See the <code>metafor</code> package for detailed description.
</p>
</li>
<li> <p><code>intercept</code>: logical specifying whether or not the intercept has been included in the meta-analysis.
</p>
</li>
<li> <p><code>cohorts</code>: Number of datasets (&quot;cohorts&quot;) used in the meta-analysis.
</p>
</li></ul>


<hr>
<h2 id='summary.striprawdata'>Summary method for GAMs stripped for rawdata</h2><span id='topic+summary.striprawdata'></span>

<h3>Description</h3>

<p>Summary method for GAMs stripped for rawdata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'striprawdata'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.striprawdata_+3A_object">object</code></td>
<td>
<p>Object returned by <code><a href="#topic+strip_rawdata">strip_rawdata</a></code>.</p>
</td></tr>
<tr><td><code id="summary.striprawdata_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns its input argument, which is printed to the console.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
