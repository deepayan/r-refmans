<!DOCTYPE html><html><head><title>Help for package CausalModels</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CausalModels}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#doubly_robust'><p>Doubly Robust Model</p></a></li>
<li><a href='#gestimation'><p>One Parameter G-Estimation of Structural Nested Mean Models</p></a></li>
<li><a href='#init_params'><p>Initialize CausalModels Package</p></a></li>
<li><a href='#ipweighting'><p>Parametric IP Weighting</p></a></li>
<li><a href='#iv_est'><p>Standard Instrumental Variable Estimator</p></a></li>
<li><a href='#outcome_regression'><p>Outcome Regression</p></a></li>
<li><a href='#propensity_matching'><p>Propensity Matching</p></a></li>
<li><a href='#propensity_scores'><p>Propensity Scores</p></a></li>
<li><a href='#standardization'><p>Parametric Standardization</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Causal Inference Modeling for Estimation of Causal Effects</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joshua Anderson &lt;jwanderson198@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>
  Provides an array of statistical models common in causal inference such as 
  standardization, IP weighting, propensity matching, outcome regression, and doubly-robust 
  estimators. Estimates of the average treatment effects from each model are given with the 
  standard error and a 95% Wald confidence interval (Hernan, Robins (2020) <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/</a>).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ander428/CausalModels">https://github.com/ander428/CausalModels</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ander428/CausalModels/issues">https://github.com/ander428/CausalModels/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, causaldata, boot, multcomp, geepack</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-23 21:09:17 UTC; joshu</td>
</tr>
<tr>
<td>Author:</td>
<td>Joshua Anderson [aut, cre, cph],
  Cyril Rakovski [rev],
  Yesha Patel [rev],
  Erin Lee [rev]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-23 21:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='doubly_robust'>Doubly Robust Model</h2><span id='topic+doubly_robust'></span>

<h3>Description</h3>

<p><code>`doubly_robust`</code> trains both an outcome model and a propensity model to generate predictions
for the outcome and probability of treatment respectively. By default, the model uses
<code><a href="#topic+standardization">standardization</a></code> and <code><a href="#topic+propensity_scores">propensity_scores</a></code> to form a
doubly-robust model between standardization and IP weighting. Alternatively, any outcome and treatment
models can be provided instead, but must be compatible with the <code><a href="stats.html#topic+predict">predict</a></code> generic function in R.
Since many propensity models may not predict probabilities without additional arguments into the
predict function, the predictions themselves can be given for both the outcome and propensity scores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doubly_robust(
  data,
  out.mod = NULL,
  p.mod = NULL,
  f = NA,
  family = gaussian(),
  simple = pkg.env$simple,
  scores = NA,
  p.f = NA,
  p.simple = pkg.env$simple,
  p.family = binomial(),
  p.scores = NA,
  n.boot = 50,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="doubly_robust_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.
This should be the same data used in <code><a href="#topic+init_params">init_params</a></code>.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_out.mod">out.mod</code></td>
<td>
<p>(optional) a regression model that predicts the outcome. NOTE: the model given
must be compatible with the <code><a href="stats.html#topic+predict">predict</a></code> generic function.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_p.mod">p.mod</code></td>
<td>
<p>(optional) a propensity model that predicts the probability of treatment. NOTE: the model given
must be compatible with the <code><a href="stats.html#topic+predict">predict</a></code> generic function.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_f">f</code></td>
<td>
<p>(optional) an object of class &quot;formula&quot; that overrides the default parameter</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_family">family</code></td>
<td>
<p>the family to be used in the general linear model.
By default, this is set to <code><a href="stats.html#topic+gaussian">gaussian</a></code>.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_simple">simple</code></td>
<td>
<p>a boolean indicator to build default formula with interactions.
If true, interactions will be excluded. If false, interactions will be included. By
default, simple is set to false.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_scores">scores</code></td>
<td>
<p>(optional) use calculated outcome estimates.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_p.f">p.f</code></td>
<td>
<p>(optional) an object of class &quot;formula&quot; that overrides the default formula for the denominator of the IP
weighting function.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_p.simple">p.simple</code></td>
<td>
<p>a boolean indicator to build default formula with interactions for the propensity models.
If true, interactions will be excluded. If false, interactions will be included. By
default, simple is set to false.
NOTE: if this is changed, the coefficient for treatment may not accurately represent the average causal effect.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_p.family">p.family</code></td>
<td>
<p>the family to be used in the underlying propensity model.
By default, this is set to <code><a href="stats.html#topic+gaussian">binomial</a></code>.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_p.scores">p.scores</code></td>
<td>
<p>(optional) use calculated propensity scores.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_n.boot">n.boot</code></td>
<td>
<p>an integer value that indicates number of bootstrap iterations to calculate standard error.</p>
</td></tr>
<tr><td><code id="doubly_robust_+3A_...">...</code></td>
<td>
<p>additional arguments that may be passed to the underlying <code><a href="stats.html#topic+glm">glm</a></code> model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>doubly_robust</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;doubly_robust&quot;.
</p>
<p>The functions <code>print</code>, <code>summary</code>, and <code>predict</code> can be used to interact with
the underlying <code>glm</code> model.
</p>
<p>An object of class <code>"doubly_robust"</code> is a list containing the following:
</p>
<table>
<tr><td><code>out.call</code></td>
<td>
<p>the matched call of the outcome model.</p>
</td></tr>
<tr><td><code>p.call</code></td>
<td>
<p>the matched call of the propensity model.</p>
</td></tr>
<tr><td><code>out.model</code></td>
<td>
<p>the underlying outcome model.</p>
</td></tr>
<tr><td><code>p.model</code></td>
<td>
<p>the underlying propensity model.</p>
</td></tr>
<tr><td><code>y_hat</code></td>
<td>
<p>the estimated outcome values.</p>
</td></tr>
<tr><td><code>p.scores</code></td>
<td>
<p>the estimated propensity scores.</p>
</td></tr>
<tr><td><code>ATE</code></td>
<td>
<p>the estimated average treatment effect (risk difference).</p>
</td></tr>
<tr><td><code>ATE.summary</code></td>
<td>
<p>a data frame containing the ATE, SE, and 95% CI of the ATE. </p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data frame used to train the model.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(causaldata)
data(nhefs)
nhefs.nmv &lt;- nhefs[which(!is.na(nhefs$wt82)), ]
nhefs.nmv$qsmk &lt;- as.factor(nhefs.nmv$qsmk)

confounders &lt;- c(
  "sex", "race", "age", "education", "smokeintensity",
  "smokeyrs", "exercise", "active", "wt71"
)

init_params(wt82_71, qsmk,
  covariates = confounders,
  data = nhefs.nmv
)

# model using all defaults
model &lt;- doubly_robust(data = nhefs.nmv)
summary(model)

# use alternative outcome model
out.mod &lt;- propensity_matching(data = nhefs.nmv)
db.model &lt;- doubly_robust(
  out.mod = out.mod,
  data = nhefs.nmv
)
db.model

# give calculated outcome predictions and give formula for propensity scores
db.model &lt;- doubly_robust(
  scores = predict(out.mod),
  p.f = qsmk ~ sex + race + age,
  data = nhefs.nmv
)
db.model

</code></pre>

<hr>
<h2 id='gestimation'>One Parameter G-Estimation of Structural Nested Mean Models</h2><span id='topic+gestimation'></span>

<h3>Description</h3>

<p>'gestimation' uses the <code><a href="#topic+propensity_scores">propensity_scores</a></code> function to generate inverse probability
weights. The weights can either be standardized weights or non-standardized weights. A grid search is done on <code class="reqn">\alpha</code>
to construct the best <code class="reqn">\beta</code> coefficient in the structural nested mean model. Alternatively, a linear mean model can be used
for a closed form estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gestimation(
  data,
  grid,
  ids = list(),
  f = NA,
  family = binomial(),
  simple = pkg.env$simple,
  p.f = NA,
  p.simple = pkg.env$simple,
  p.family = binomial(),
  p.scores = NA,
  SW = TRUE,
  n.boot = 100,
  type = "one.grid",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gestimation_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.
This should be the same data used in <code><a href="#topic+init_params">init_params</a></code>.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_grid">grid</code></td>
<td>
<p>a list of possible <code class="reqn">\beta</code> values that will be used in the grid search.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_ids">ids</code></td>
<td>
<p>(optional) see documentation for <code><a href="geepack.html#topic+geeglm">geeglm</a></code>. By default rownames of the data will be used.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_f">f</code></td>
<td>
<p>(optional) an object of class &quot;formula&quot; that overrides the default parameter. NOTE: for g-estimation this should be
a propensity formula.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_family">family</code></td>
<td>
<p>the family to be used in the general linear model.
By default, this is set to <code><a href="stats.html#topic+gaussian">gaussian</a></code>.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_simple">simple</code></td>
<td>
<p>(optional) a boolean indicator to build default formula with interactions for the g-estimation model.
If true, interactions will be excluded. If false, interactions will be included. By default, simple is set to false.
NOTE: <code class="reqn">\beta</code>  will be appended to the end of the formula</p>
</td></tr>
<tr><td><code id="gestimation_+3A_p.f">p.f</code></td>
<td>
<p>(optional) an object of class &quot;formula&quot; that overrides the default formula for the denominator of the IP
weighting function.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_p.simple">p.simple</code></td>
<td>
<p>(optional) a boolean indicator to build default formula with interactions for the propensity models.
If true, interactions will be excluded. If false, interactions will be included. By
default, simple is set to false.
NOTE: if this is changed, the coefficient for treatment may not accurately represent the average causal effect.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_p.family">p.family</code></td>
<td>
<p>the family to be used in the underlying propensity model.
By default, this is set to <code><a href="stats.html#topic+binomial">binomial</a></code>.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_p.scores">p.scores</code></td>
<td>
<p>(optional) use calculated propensity scores for the weights. If using standardized weights,
the numerator will still be modeled.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_sw">SW</code></td>
<td>
<p>a boolean indicator to indicate the use of standardized weights. By default, this is set to true.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_n.boot">n.boot</code></td>
<td>
<p>(optional) an integer value that indicates number of bootstrap iterations to calculate standard error.
If no value is given, the standard error from the underlying linear model will be used. NOTE: when type is 'one.grid'
bootstrapping is not performed. By default, this is set to 100.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_type">type</code></td>
<td>
<p>the type of g-estimation to perform. It must be one of <code>"one.grid"</code> or <code>"one.linear"</code> for a
one parameter grid and linear mean model estimation respectively.</p>
</td></tr>
<tr><td><code id="gestimation_+3A_...">...</code></td>
<td>
<p>additional arguments that may be passed to the underlying model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>gestimation</code> returns an object of <code><a href="base.html#topic+class">class</a> "gestimation"</code>.
</p>
<p>The functions <code>print</code>, <code>summary</code>, and <code>predict</code> can be used to interact with
the underlying <code>glm</code> or <code>geeglm</code> model.
</p>
<p>An object of class <code>"gestimation"</code> is a list containing the following:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula used in the model.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the underlying glm model. If the model performed a grid search, this will be renamed 'best.model'</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>the estimated IP weights.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>returns the value used for the 'type' parameter.</p>
</td></tr>
<tr><td><code>ATE</code></td>
<td>
<p>the estimated average treatment effect (risk difference).</p>
</td></tr>
<tr><td><code>ATE.summary</code></td>
<td>
<p>a data frame containing the ATE, SE, and 95% CI of the ATE. </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(causaldata)
data(nhefs)
nhefs.nmv &lt;- nhefs[which(!is.na(nhefs$wt82)), ]
nhefs.nmv$qsmk &lt;- as.factor(nhefs.nmv$qsmk)

confounders &lt;- c(
  "sex", "race", "age", "education", "smokeintensity",
  "smokeyrs", "exercise", "active", "wt71"
)

init_params(wt82_71, qsmk,
  covariates = confounders,
  data = nhefs.nmv
)

gest.model &lt;- gestimation(nhefs.nmv, type = "one.linear", n.boot = 150)
gest.model$ATE.summary
</code></pre>

<hr>
<h2 id='init_params'>Initialize CausalModels Package</h2><span id='topic+init_params'></span>

<h3>Description</h3>

<p>This function is required to be run first before any other function can run.
This will set within the package the global outcome, treatment, and covariate functions for each model to use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>init_params(outcome, treatment, covariates, data, simple = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="init_params_+3A_outcome">outcome</code></td>
<td>
<p>the outcome variable of interest (must be continuous).</p>
</td></tr>
<tr><td><code id="init_params_+3A_treatment">treatment</code></td>
<td>
<p>the treatment with the causal effect of interest on the outcome.</p>
</td></tr>
<tr><td><code id="init_params_+3A_covariates">covariates</code></td>
<td>
<p>a list/vector of covariate names to be use for confounding adjustment.</p>
</td></tr>
<tr><td><code id="init_params_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="init_params_+3A_simple">simple</code></td>
<td>
<p>a boolean indicator to build default formula with interactions.
If true, interactions will be excluded. If false, interactions will be included. By
default, simple is set to false.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Called for parameter initialization.
</p>

<hr>
<h2 id='ipweighting'>Parametric IP Weighting</h2><span id='topic+ipweighting'></span>

<h3>Description</h3>

<p>'ipweighting' uses the <code><a href="#topic+propensity_scores">propensity_scores</a></code> function to generate inverse probability
weights. The weights can either be standardized weights or non-standardized weights. The weights are used to train a
general linear model whose coefficient for treatment represents the average treatment effect on the additive scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipweighting(
  data,
  f = NA,
  family = gaussian(),
  p.f = NA,
  p.simple = pkg.env$simple,
  p.family = binomial(),
  p.scores = NA,
  SW = TRUE,
  n.boot = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipweighting_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.
This should be the same data used in <code><a href="#topic+init_params">init_params</a></code>.</p>
</td></tr>
<tr><td><code id="ipweighting_+3A_f">f</code></td>
<td>
<p>(optional) an object of class &quot;formula&quot; that overrides the default parameter</p>
</td></tr>
<tr><td><code id="ipweighting_+3A_family">family</code></td>
<td>
<p>the family to be used in the general linear model.
By default, this is set to <code><a href="stats.html#topic+gaussian">gaussian</a></code>.</p>
</td></tr>
<tr><td><code id="ipweighting_+3A_p.f">p.f</code></td>
<td>
<p>(optional) an object of class &quot;formula&quot; that overrides the default formula for the denominator of the IP
weighting function.</p>
</td></tr>
<tr><td><code id="ipweighting_+3A_p.simple">p.simple</code></td>
<td>
<p>a boolean indicator to build default formula with interactions for the propensity models.
If true, interactions will be excluded. If false, interactions will be included. By
default, simple is set to false.
NOTE: if this is changed, the coefficient for treatment may not accurately represent the average causal effect.</p>
</td></tr>
<tr><td><code id="ipweighting_+3A_p.family">p.family</code></td>
<td>
<p>the family to be used in the underlying propensity model.
By default, this is set to <code><a href="stats.html#topic+binomial">binomial</a></code>.</p>
</td></tr>
<tr><td><code id="ipweighting_+3A_p.scores">p.scores</code></td>
<td>
<p>(optional) use calculated propensity scores for the weights. If using standardized weights,
the numerator will still be modeled.</p>
</td></tr>
<tr><td><code id="ipweighting_+3A_sw">SW</code></td>
<td>
<p>a boolean indicator to indicate the use of standardized weights. By default, this is set to true.</p>
</td></tr>
<tr><td><code id="ipweighting_+3A_n.boot">n.boot</code></td>
<td>
<p>(optional) an integer value that indicates number of bootstrap iterations to calculate standard error.
If no value is given, the standard error from the underlying linear model will be used.</p>
</td></tr>
<tr><td><code id="ipweighting_+3A_...">...</code></td>
<td>
<p>additional arguments that may be passed to the underlying <code><a href="stats.html#topic+glm">glm</a></code> model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ipweighting</code> returns an object of <code><a href="base.html#topic+class">class</a> "ipweighting"</code>.
</p>
<p>The functions <code>print</code>, <code>summary</code>, and <code>predict</code> can be used to interact with
the underlying <code>glm</code> model.
</p>
<p>An object of class <code>"ipweighting"</code> is a list containing the following:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula used in the model.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the underlying glm model.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>the estimated IP weights.</p>
</td></tr>
<tr><td><code>ATE</code></td>
<td>
<p>the estimated average treatment effect (risk difference).</p>
</td></tr>
<tr><td><code>ATE.summary</code></td>
<td>
<p>a data frame containing the ATE, SE, and 95% CI of the ATE. </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(causaldata)
data(nhefs)
nhefs.nmv &lt;- nhefs[which(!is.na(nhefs$wt82)), ]
nhefs.nmv$qsmk &lt;- as.factor(nhefs.nmv$qsmk)

confounders &lt;- c(
  "sex", "race", "age", "education", "smokeintensity",
  "smokeyrs", "exercise", "active", "wt71"
)

init_params(wt82_71, qsmk,
  covariates = confounders,
  data = nhefs.nmv
)

# model using all defaults
model &lt;- ipweighting(data = nhefs.nmv)
summary(model)

# Model using calculated propensity scores and manual outcome formula
p.scores &lt;- propensity_scores(nhefs.nmv)$p.scores
model &lt;- ipweighting(wt82_71 ~ qsmk, p.scores = p.scores, data = nhefs.nmv)
summary(model)

</code></pre>

<hr>
<h2 id='iv_est'>Standard Instrumental Variable Estimator</h2><span id='topic+iv_est'></span>

<h3>Description</h3>

<p>'iv_est' calculates the standard IV estimand using the conditional means on a given instrumental variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iv_est(IV, data, n.boot = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iv_est_+3A_iv">IV</code></td>
<td>
<p>the instrumental variable to be used in the conditional means. Must be a factor with no more than 2 levels.
It is assumed the second level is the positive level, i.e., the binary equivalent of the second factor level should be 1
and the first should be 0.</p>
</td></tr>
<tr><td><code id="iv_est_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.
This should be the same data used in <code><a href="#topic+init_params">init_params</a></code>.</p>
</td></tr>
<tr><td><code id="iv_est_+3A_n.boot">n.boot</code></td>
<td>
<p>an integer value that indicates number of bootstrap iterations to calculate standard error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>iv_est</code> returns a data frame containing the standard IV estimate, standard error, and Wald 95
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(causaldata)
data(nhefs)
nhefs.nmv &lt;- nhefs[which(!is.na(nhefs$wt82)), ]
nhefs.nmv$qsmk &lt;- as.factor(nhefs.nmv$qsmk)

confounders &lt;- c(
  "sex", "race", "age", "education", "smokeintensity",
  "smokeyrs", "exercise", "active", "wt71"
)
nhefs.iv &lt;- nhefs[which(!is.na(nhefs$wt82) &amp; !is.na(nhefs$price82)), ]
nhefs.iv$highprice &lt;- as.factor(ifelse(nhefs.iv$price82 &gt;= 1.5, 1, 0))
nhefs.iv$qsmk &lt;- as.factor(nhefs.iv$qsmk)
init_params(wt82_71, qsmk,
            covariates = confounders,
            data = nhefs.iv)

iv_est("highprice", nhefs.iv)
</code></pre>

<hr>
<h2 id='outcome_regression'>Outcome Regression</h2><span id='topic+outcome_regression'></span>

<h3>Description</h3>

<p>'outcome_regression' builds a linear model using all covariates. The treatment effects are stratified
within the levels of the covariates. The model will automatically provide all discrete covariates in a contrast matrix.
To view estimated change in treatment effect from continuous variables, a list called <code>contrasts</code>, needs to be given
with specific values to estimate. A vector of values can be given for any particular continuous variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outcome_regression(
  data,
  f = NA,
  simple = pkg.env$simple,
  family = gaussian(),
  contrasts = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outcome_regression_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.
This should be the same data used in <code><a href="#topic+init_params">init_params</a></code>.</p>
</td></tr>
<tr><td><code id="outcome_regression_+3A_f">f</code></td>
<td>
<p>(optional) an object of class &quot;formula&quot; that overrides the default parameter</p>
</td></tr>
<tr><td><code id="outcome_regression_+3A_simple">simple</code></td>
<td>
<p>a boolean indicator to build default formula with interactions.
If true, interactions will be excluded. If false, interactions will be included. By
default, simple is set to false.</p>
</td></tr>
<tr><td><code id="outcome_regression_+3A_family">family</code></td>
<td>
<p>the family to be used in the general linear model.
By default, this is set to <code><a href="stats.html#topic+gaussian">gaussian</a></code>.
NOTE: if this is changed, the assumptions about the model output may be incorrect and may not provide
accurate treatment effects.</p>
</td></tr>
<tr><td><code id="outcome_regression_+3A_contrasts">contrasts</code></td>
<td>
<p>a list of continuous covariates and values in the model to be included in the contrast matrix
(e.g. <code>list(age = c(18, 25, 40), weight = c(90, 159))</code>).</p>
</td></tr>
<tr><td><code id="outcome_regression_+3A_...">...</code></td>
<td>
<p>additional arguments that may be passed to the underlying <code><a href="multcomp.html#topic+glht">glht</a></code> model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>outcome_regression</code> returns an object of <code><a href="base.html#topic+class">class</a> "outcome_regression"</code>
</p>
<p>The functions <code>print</code>, <code>summary</code>, and <code>predict</code> can be used to interact with
the underlying <code>glht</code> model.
</p>
<p>An object of class <code>"outcome_regression"</code> is a list containing the following:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula used in the model.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the underlying glht model.</p>
</td></tr>
<tr><td><code>ATE</code></td>
<td>
<p>a data frame containing the ATE, SE, and 95% CI of the ATE. </p>
</td></tr>
<tr><td><code>ATE.summary</code></td>
<td>
<p>a more detailed summary of the ATE estimations from glht. </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(causaldata)
library(multcomp)

data(nhefs)
nhefs.nmv &lt;- nhefs[which(!is.na(nhefs$wt82)), ]
nhefs.nmv$qsmk &lt;- as.factor(nhefs.nmv$qsmk)

confounders &lt;- c(
  "sex", "race", "age", "education", "smokeintensity",
  "smokeyrs", "exercise", "active", "wt71"
)

init_params(wt82_71, qsmk,
  covariates = confounders,
  data = nhefs.nmv
)

out.mod &lt;- outcome_regression(nhefs.nmv, contrasts = list(
  age = c(21, 55),
  smokeintensity = c(5, 20, 40)
))
print(out.mod)
summary(out.mod)
head(data.frame(preds = predict(out.mod)))

</code></pre>

<hr>
<h2 id='propensity_matching'>Propensity Matching</h2><span id='topic+propensity_matching'></span>

<h3>Description</h3>

<p>'propensity_matching' uses either stratification or standardization to model an outcome
conditional on the propensity scores. In stratification, the model will break the propensity scores
into groups and output a <code><a href="multcomp.html#topic+glht">glht</a></code> model based off a contrast matrix which
estimates the change in average causal effect within groups of propensity scores. In standardization,
the model will output a <code><a href="#topic+standardization">standardization</a></code> model that conditions on the
propensity strata rather than the covariates. The model can also predict the expected outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>propensity_matching(
  data,
  f = NA,
  simple = pkg.env$simple,
  p.scores = NA,
  p.simple = pkg.env$simple,
  type = "strata",
  grp.width = 0.1,
  quant = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="propensity_matching_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.
This should be the same data used in <code><a href="#topic+init_params">init_params</a></code>.</p>
</td></tr>
<tr><td><code id="propensity_matching_+3A_f">f</code></td>
<td>
<p>(optional) an object of class &quot;formula&quot; that overrides the default parameter</p>
</td></tr>
<tr><td><code id="propensity_matching_+3A_simple">simple</code></td>
<td>
<p>a boolean indicator to build default formula with interactions.
If true, interactions will be excluded. If false, interactions will be included. By
default, simple is set to false.</p>
</td></tr>
<tr><td><code id="propensity_matching_+3A_p.scores">p.scores</code></td>
<td>
<p>(optional) use calculated propensity scores for matching. Otherwise, propensity scores
will be automatically modeled.</p>
</td></tr>
<tr><td><code id="propensity_matching_+3A_p.simple">p.simple</code></td>
<td>
<p>a boolean indicator to build default formula with interactions for the propensity models.
If true, interactions will be excluded. If false, interactions will be included. By
default, simple is set to false.</p>
</td></tr>
<tr><td><code id="propensity_matching_+3A_type">type</code></td>
<td>
<p>a string representing the type of propensity model to be used. By default, the function will stratify. Standardization with
propensity scores may also be used. The value given for <code>type</code> must be in <code>c("strata", "stdm")</code>.</p>
</td></tr>
<tr><td><code id="propensity_matching_+3A_grp.width">grp.width</code></td>
<td>
<p>a decimal value to specify the range to stratify the propensity scores. If option <code>quant</code> is set to true,
this will represent the spread of percentiles. If false, it will represent the spread of raw values of propensity
scores. Must be a decimal between 0 and 1. By default, this is set to 0.1. This option is ignored for standardization.</p>
</td></tr>
<tr><td><code id="propensity_matching_+3A_quant">quant</code></td>
<td>
<p>a boolean indicator to specify the type of stratification. If true (default), the model will stratify by
percentiles. If false, the scores will be grouped by a range of their raw values. This option is ignored for standardization.</p>
</td></tr>
<tr><td><code id="propensity_matching_+3A_...">...</code></td>
<td>
<p>additional arguments that may be passed to the underlying <code><a href="#topic+propensity_scores">propensity_scores</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>propensity_matching</code> returns an object of <code><a href="base.html#topic+class">class</a> "propensity_matching"</code>
</p>
<p>The functions <code>print</code>, <code>summary</code>, and <code>predict</code> can be used to interact with the underlying <code>glht</code> or
<code>standardization</code> model.
</p>
<p>An object of class <code>"propensity_matching"</code> is a list containing the following:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula used in the model.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>either the underlying <code>glht</code> or <code>standardization</code> model.</p>
</td></tr>
<tr><td><code>p.scores</code></td>
<td>
<p>the estimated propensity scores</p>
</td></tr>
<tr><td><code>ATE</code></td>
<td>
<p>a data frame containing the ATE, SE, and 95% CI of the ATE. </p>
</td></tr>
<tr><td><code>ATE.summary</code></td>
<td>
<p>either a data frame containing the <code>glht</code> or <code>standardization</code> summary. </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(causaldata)
library(multcomp)

data(nhefs)
nhefs.nmv &lt;- nhefs[which(!is.na(nhefs$wt82)), ]
nhefs.nmv$qsmk &lt;- as.factor(nhefs.nmv$qsmk)

confounders &lt;- c(
  "sex", "race", "age", "education", "smokeintensity",
  "smokeyrs", "exercise", "active", "wt71"
)

init_params(wt82_71, qsmk,
  covariates = confounders,
  data = nhefs.nmv
)

pm.model &lt;- propensity_matching(nhefs.nmv)
pm.model$ATE.summary
summary(pm.model)
head(data.frame(preds = predict(pm.model)))

</code></pre>

<hr>
<h2 id='propensity_scores'>Propensity Scores</h2><span id='topic+propensity_scores'></span>

<h3>Description</h3>

<p>'propensity_scores' builds a logistic regression with the target as the treatment variable
and the covariates as the independent variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>propensity_scores(
  data,
  f = NA,
  simple = pkg.env$simple,
  family = binomial(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="propensity_scores_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.
This should be the same data used in <code><a href="#topic+init_params">init_params</a></code>.</p>
</td></tr>
<tr><td><code id="propensity_scores_+3A_f">f</code></td>
<td>
<p>(optional) an object of class &quot;formula&quot; that overrides the default parameter</p>
</td></tr>
<tr><td><code id="propensity_scores_+3A_simple">simple</code></td>
<td>
<p>a boolean indicator to build default formula with interactions.
If true, interactions will be excluded. If false, interactions will be included. By
default, simple is set to false.</p>
</td></tr>
<tr><td><code id="propensity_scores_+3A_family">family</code></td>
<td>
<p>the family to be used in the general linear model.
By default, this is set to <code><a href="stats.html#topic+binomial">binomial</a></code>
NOTE: if this is changed, the outcome of the model may not be the probabilities and the results will not be valid.</p>
</td></tr>
<tr><td><code id="propensity_scores_+3A_...">...</code></td>
<td>
<p>additional arguments that may be passed to the underlying <code><a href="stats.html#topic+glm">glm</a></code> model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>propensity_scores</code> returns an object of <code><a href="base.html#topic+class">class</a> "propensity_scores"</code>
</p>
<p>The functions <code>print</code>, <code>summary</code>, and <code>predict</code> can be used to interact with
the underlying <code>glm</code> model.
</p>
<p>An object of class <code>"propensity_scores"</code> is a list containing the following:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula used in the model.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the underlying glm model.</p>
</td></tr>
<tr><td><code>p.scores</code></td>
<td>
<p>the estimated propensity scores.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(causaldata)
data(nhefs)
nhefs.nmv &lt;- nhefs[which(!is.na(nhefs$wt82)), ]
nhefs.nmv$qsmk &lt;- as.factor(nhefs.nmv$qsmk)

confounders &lt;- c(
  "sex", "race", "age", "education", "smokeintensity",
  "smokeyrs", "exercise", "active", "wt71"
)

init_params(wt82_71, qsmk,
  covariates = confounders,
  data = nhefs.nmv
)

p.score &lt;- propensity_scores(nhefs.nmv)
p.score

</code></pre>

<hr>
<h2 id='standardization'>Parametric Standardization</h2><span id='topic+standardization'></span>

<h3>Description</h3>

<p>'standardization' uses a standard <code><a href="stats.html#topic+glm">glm</a></code> linear model to perform parametric standardization
by adjusting bias through including all confounders as covariates. The model will calculate during training both the risk difference
and the risk ratio. Both can be accessed from the model as well as estimates of the counterfactuals of treatment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>standardization(
  data,
  f = NA,
  family = gaussian(),
  simple = pkg.env$simple,
  n.boot = 50,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="standardization_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.
This should be the same data used in <code><a href="#topic+init_params">init_params</a></code>.</p>
</td></tr>
<tr><td><code id="standardization_+3A_f">f</code></td>
<td>
<p>(optional) an object of class &quot;formula&quot; that overrides the default parameter</p>
</td></tr>
<tr><td><code id="standardization_+3A_family">family</code></td>
<td>
<p>the family to be used in the general linear model.
By default, this is set to <code><a href="stats.html#topic+gaussian">gaussian</a></code>.</p>
</td></tr>
<tr><td><code id="standardization_+3A_simple">simple</code></td>
<td>
<p>a boolean indicator to build default formula with interactions.
If true, interactions will be excluded. If false, interactions will be included. By
default, simple is set to false.
NOTE: if this is changed, the coefficient for treatment may not accurately represent the average causal effect.</p>
</td></tr>
<tr><td><code id="standardization_+3A_n.boot">n.boot</code></td>
<td>
<p>an integer value that indicates number of bootstrap iterations to calculate standard error.</p>
</td></tr>
<tr><td><code id="standardization_+3A_...">...</code></td>
<td>
<p>additional arguments that may be passed to the underlying <code><a href="stats.html#topic+glm">glm</a></code> model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>standardization</code> returns an object of <code><a href="base.html#topic+class">class</a> "standardization"</code>.
</p>
<p>The functions <code>print</code>, <code>summary</code>, and <code>predict</code> can be used to interact with
the underlying <code>glm</code> model.
</p>
<p>An object of class <code>"standardization"</code> is a list containing the following:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula used in the model.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the underlying glm model.</p>
</td></tr>
<tr><td><code>ATE</code></td>
<td>
<p>a data frame containing estimates of the treatment effect
of the observed, counterfactuals, and risk metrics.</p>
</td></tr>
<tr><td><code>ATE.summary</code></td>
<td>
<p>a data frame containing the ATE, SE, and 95% CI of the ATE. </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(causaldata)

data(nhefs)
nhefs.nmv &lt;- nhefs[which(!is.na(nhefs$wt82)), ]
nhefs.nmv$qsmk &lt;- as.factor(nhefs.nmv$qsmk)

confounders &lt;- c(
  "sex", "race", "age", "education", "smokeintensity",
  "smokeyrs", "exercise", "active", "wt71"
)

init_params(wt82_71, qsmk,
  covariates = confounders,
  data = nhefs.nmv
)

# model using all defaults
model &lt;- standardization(data = nhefs.nmv)
print(model)
summary(model)
print(model$ATE.summary)
print(model$ATE.summary$Estimate[[2]] -
  model$ATE.summary$Estimate[[3]]) # manually calculate risk difference

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
