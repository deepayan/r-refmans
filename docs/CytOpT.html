<!DOCTYPE html><html><head><title>Help for package CytOpT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CytOpT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#barplot_prop'><p>Function to display a bland plot in order to visually assess the agreement between CytOpt estimation</p>
of the class proportions and the estimate of the class proportions provided through manual gating.</a></li>
<li><a href='#Bland_Altman'><p>Bland &amp; Altman plot</p></a></li>
<li><a href='#CytOpT'><p>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s</p>
by using the classification Lab_source from an other cytometry data set X_s. With this function
the computation of the estimate of the class proportions is done with a descent ascent or minmax
or two algorithms.</a></li>
<li><a href='#cytopt_desasc_r'><p>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s</p>
by using the classification Lab_source from an other cytometry data set X_s. With this function
the computation of the estimate of the class proportions is done with a descent ascent algorithm.</a></li>
<li><a href='#cytopt_minmax_r'><p>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s</p>
by using the classification Lab_source from an other cytometry data set X_s. With this function
an additional regularization parameter on the class proportions enables a faster computation of the
estimator.</a></li>
<li><a href='#HIPC_Stanford'><p>HIPC_Stanford data</p></a></li>
<li><a href='#KL_plot'><p>Kullback-Leibler divergence plot</p></a></li>
<li><a href='#Label_Prop_sto_r'><p>Computes a classification on the target data</p></a></li>
<li><a href='#plot.CytOpt'><p>CytOpt plot</p></a></li>
<li><a href='#print.CytOpt'><p>CytOpt print</p></a></li>
<li><a href='#print.summary.CytOpt'><p>CytOpt print summary</p></a></li>
<li><a href='#summary.CytOpt'><p>CytOpt summary</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Optimal Transport for Gating Transfer in Cytometry Data with
Domain Adaptation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-02-08</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Boris Hejblum &lt;boris.hejblum@u-bordeaux.fr&gt;</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Python (&gt;= 3.7)</td>
</tr>
<tr>
<td>Description:</td>
<td>Supervised learning from a source distribution (with known segmentation into cell sub-populations) 
             to fit a target distribution with unknown segmentation. It relies regularized optimal transport to directly 
             estimate the different cell population proportions from a biological sample characterized with flow cytometry 
             measurements. It is based on the regularized Wasserstein metric to compare cytometry measurements from 
             different samples, thus accounting for possible mis-alignment of a given cell population across sample 
             (due to technical variability from the technology of measurements). Supervised learning technique based 
             on the Wasserstein metric that is used to estimate an optimal re-weighting of class proportions in a 
             mixture model Details are presented in Freulon P, Bigot J and Hejblum BP (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2006.09003">doi:10.48550/arXiv.2006.09003</a>&gt;.</td>
</tr>
<tr>
<td>Config/reticulate:</td>
<td>list( packages = list( list(package = "numpy"),
list(package = "scikit-learn"), list(package = "scipy") ) )</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://sistm.github.io/CytOpT-R/">https://sistm.github.io/CytOpT-R/</a>,
<a href="https://github.com/sistm/CytOpT-R/">https://github.com/sistm/CytOpT-R/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.0.0), MetBrewer, patchwork, reshape2,
reticulate, stats, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, covr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-09 16:32:16 UTC; boris</td>
</tr>
<tr>
<td>Author:</td>
<td>Boris Hejblum [aut, cre],
  Paul Freulon [aut],
  Kalidou Ba [aut, trl]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-09 17:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='barplot_prop'>Function to display a bland plot in order to visually assess the agreement between CytOpt estimation
of the class proportions and the estimate of the class proportions provided through manual gating.</h2><span id='topic+barplot_prop'></span>

<h3>Description</h3>

<p>Function to display a bland plot in order to visually assess the agreement between CytOpt estimation
of the class proportions and the estimate of the class proportions provided through manual gating.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>barplot_prop(proportions, title = "", xaxis_angle = 45)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barplot_prop_+3A_proportions">proportions</code></td>
<td>
<p><code>data.frame</code> of (true and) estimated proportions from <code>CytOpt()</code></p>
</td></tr>
<tr><td><code id="barplot_prop_+3A_title">title</code></td>
<td>
<p>plot title. Default is <code>""</code>, i.e. no title.</p>
</td></tr>
<tr><td><code id="barplot_prop_+3A_xaxis_angle">xaxis_angle</code></td>
<td>
<p>scalar indicating an angle to tilt the labels of x_axis. Default is <code>45</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

res &lt;- CytOpT(X_s = HIPC_Stanford_1228_1A, X_t = HIPC_Stanford_1369_1A, 
             Lab_source = HIPC_Stanford_1228_1A_labels,
             eps = 0.0001, lbd = 0.0001, n_iter = 10000, n_stoc=10,
             step_grad = 10, step = 5, power = 0.99, 
             method='minmax')
barplot_prop(res$proportions)

}
</code></pre>

<hr>
<h2 id='Bland_Altman'>Bland &amp; Altman plot</h2><span id='topic+Bland_Altman'></span>

<h3>Description</h3>

<p>Function to display a Bland &amp; Altman plot in order to visually assess the agreement between CytOpt estimation
of the class proportions and the estimate of the class proportions provided through manual gating. 
Requires that either <code>theta_true</code> or <code>Lab_target</code> was provided when running <code><a href="#topic+CytOpT">CytOpT</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bland_Altman(proportions, additional_info_shape = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bland_Altman_+3A_proportions">proportions</code></td>
<td>
<p><code>data.frame</code> of true and estimated proportion returned from <code><a href="#topic+CytOpT">CytOpT</a>()</code>.</p>
</td></tr>
<tr><td><code id="Bland_Altman_+3A_additional_info_shape">additional_info_shape</code></td>
<td>
<p>vector of additional information to be used for shape in the plot. Not implemented yet.
</p>
<p>#'@return a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+CytOpT">CytOpT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

gold_standard_manual_prop &lt;- c(table(HIPC_Stanford_1369_1A_labels) /
 length(HIPC_Stanford_1369_1A_labels))
res &lt;- CytOpT(X_s = HIPC_Stanford_1228_1A, X_t = HIPC_Stanford_1369_1A, 
             Lab_source = HIPC_Stanford_1228_1A_labels,
             theta_true = gold_standard_manual_prop,
             eps = 0.0001, lbd = 0.0001, n_iter = 10000, n_stoc=10,
             step_grad = 10, step = 5, power = 0.99, 
             method='both')
Bland_Altman(res$proportions)

}
</code></pre>

<hr>
<h2 id='CytOpT'>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s
by using the classification Lab_source from an other cytometry data set X_s. With this function
the computation of the estimate of the class proportions is done with a descent ascent or minmax
or two algorithms.</h2><span id='topic+CytOpT'></span>

<h3>Description</h3>

<p>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s
by using the classification Lab_source from an other cytometry data set X_s. With this function
the computation of the estimate of the class proportions is done with a descent ascent or minmax
or two algorithms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CytOpT(
  X_s,
  X_t,
  Lab_source,
  Lab_target = NULL,
  theta_true = NULL,
  method = c("minmax", "desasc", "both"),
  eps = 1e-04,
  n_iter = 10000,
  power = 0.99,
  step_grad = 10,
  step = 5,
  lbd = 1e-04,
  n_out = 5000,
  n_stoc = 10,
  minMaxScaler = TRUE,
  monitoring = FALSE,
  thresholding = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CytOpT_+3A_x_s">X_s</code></td>
<td>
<p>a cytometry dataframe with only <code>d</code> numerical variables for <code>ns</code> observations. 
The columns correspond to the different biological markers measured.
One line corresponds to the cytometry measurements performed on one cell. The classification
of this Cytometry data set must be provided with the Lab_source parameters.</p>
</td></tr>
<tr><td><code id="CytOpT_+3A_x_t">X_t</code></td>
<td>
<p>a cytometry dataframe with only <code>d</code> numerical variables for <code>nt</code> observations. 
The columns correspond to the different biological markers measured.
One line corresponds to the cytometry measurements performed on one cell. The CytOpT algorithm
targets the cell type proportion in this Cytometry data set</p>
</td></tr>
<tr><td><code id="CytOpT_+3A_lab_source">Lab_source</code></td>
<td>
<p>a vector of length <code>ns</code> Classification of the X_s cytometry data set</p>
</td></tr>
<tr><td><code id="CytOpT_+3A_lab_target">Lab_target</code></td>
<td>
<p>a vector of length <code>nt</code> Classification of the X_s cytometry data set</p>
</td></tr>
<tr><td><code id="CytOpT_+3A_theta_true">theta_true</code></td>
<td>
<p>If available, gold-standard proportions in the target data 
set <code>X_t</code> derived from manual gating. It allows to assess the gap between 
the estimate and the gold-standard. Default is <code>NULL</code>, in which case no 
assessment is performed.</p>
</td></tr>
<tr><td><code id="CytOpT_+3A_method">method</code></td>
<td>
<p>a character string indicating which method to use to
compute the cytopt, either <code>'minmax'</code>, <code>'desasc'</code>
or  <code>'both'</code> for comparing both Min-max swapping and descent-ascent procedures.
Default is <code>'minmax'</code>.</p>
</td></tr>
<tr><td><code id="CytOpT_+3A_eps">eps</code></td>
<td>
<p>a float value of regularization parameter of the Wasserstein distance. Default is <code>1e-04</code></p>
</td></tr>
<tr><td><code id="CytOpT_+3A_n_iter">n_iter</code></td>
<td>
<p>an integer Constant that iterate method select. Default is <code>10000</code></p>
</td></tr>
<tr><td><code id="CytOpT_+3A_power">power</code></td>
<td>
<p>a float constant the step size policy of the gradient ascent method is step/n^power. Default is <code>0.99</code></p>
</td></tr>
<tr><td><code id="CytOpT_+3A_step_grad">step_grad</code></td>
<td>
<p>an integer number step size of the gradient descent algorithm of the outer loop.
Default is <code>10</code></p>
</td></tr>
<tr><td><code id="CytOpT_+3A_step">step</code></td>
<td>
<p>an integer constant that multiply the step-size policy. Default is <code>5</code></p>
</td></tr>
<tr><td><code id="CytOpT_+3A_lbd">lbd</code></td>
<td>
<p>a float constant that multiply the step-size policy. Default is <code>1e-04</code></p>
</td></tr>
<tr><td><code id="CytOpT_+3A_n_out">n_out</code></td>
<td>
<p>an integer number of iterations in the outer loop. This loop corresponds to the gradient
descent algorithm to minimize the regularized Wasserstein distance between the source and
target data sets. Default is <code>1000</code></p>
</td></tr>
<tr><td><code id="CytOpT_+3A_n_stoc">n_stoc</code></td>
<td>
<p>an integer number of iterations in the inner loop. This loop corresponds to the stochastic
algorithm that approximates a maximizer of the semi dual problem. Default is <code>10</code></p>
</td></tr>
<tr><td><code id="CytOpT_+3A_minmaxscaler">minMaxScaler</code></td>
<td>
<p>a logical flag indicating to whether to scale observations 
between 0 and 1. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="CytOpT_+3A_monitoring">monitoring</code></td>
<td>
<p>a logical flag indicating to possibly monitor the gap between the estimated proportions and the manual
gold-standard. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="CytOpT_+3A_thresholding">thresholding</code></td>
<td>
<p>a logical flag indicating whether to threshold negative 
values.  Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a object of class <code>CytOpt</code>, which is a list of two elements:</p>

<ul>
<li> <p><code>proportions</code> a <code>data.frame</code> with the (optionally true and) 
estimated proportions for each <code>method</code>
</p>
</li>
<li> <p><code>monitoring</code> a list of estimates over the optimization iterations
for each <code>method</code> (listed within)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

res &lt;- CytOpT(X_s = HIPC_Stanford_1228_1A, X_t = HIPC_Stanford_1369_1A, 
             Lab_source = HIPC_Stanford_1228_1A_labels,
             method='minmax')
summary(res)
plot(res)

}
</code></pre>

<hr>
<h2 id='cytopt_desasc_r'>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s
by using the classification Lab_source from an other cytometry data set X_s. With this function
the computation of the estimate of the class proportions is done with a descent ascent algorithm.</h2><span id='topic+cytopt_desasc_r'></span>

<h3>Description</h3>

<p>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s
by using the classification Lab_source from an other cytometry data set X_s. With this function
the computation of the estimate of the class proportions is done with a descent ascent algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cytopt_desasc_r(
  X_s,
  X_t,
  Lab_source,
  theta_true = NULL,
  eps = 1e-04,
  n_out = 5000,
  n_stoc = 10,
  step_grad = 10,
  monitoring = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cytopt_desasc_r_+3A_x_s">X_s</code></td>
<td>
<p>a cytometry dataframe. The columns correspond to the different biological markers tracked.
One line corresponds to the cytometry measurements performed on one cell. The classification
of this Cytometry data set must be provided with the Lab_source parameters.</p>
</td></tr>
<tr><td><code id="cytopt_desasc_r_+3A_x_t">X_t</code></td>
<td>
<p>a cytometry dataframe. The columns correspond to the different biological markers tracked.
One line corresponds to the cytometry measurements performed on one cell. The CytOpT algorithm
targets the cell type proportion in this Cytometry data set</p>
</td></tr>
<tr><td><code id="cytopt_desasc_r_+3A_lab_source">Lab_source</code></td>
<td>
<p>a vector of length <code>n</code> Classification of the X_s cytometry data set</p>
</td></tr>
<tr><td><code id="cytopt_desasc_r_+3A_theta_true">theta_true</code></td>
<td>
<p>If available, gold-standard proportions in the target data 
set <code>X_t</code> derived from manual gating. It allows to assess the gap between 
the estimate and the gold-standard. Default is <code>NULL</code>, in which case no 
assessment is performed.</p>
</td></tr>
<tr><td><code id="cytopt_desasc_r_+3A_eps">eps</code></td>
<td>
<p>an float value of regularization parameter of the Wasserstein distance. Default is <code>1e-04</code>.</p>
</td></tr>
<tr><td><code id="cytopt_desasc_r_+3A_n_out">n_out</code></td>
<td>
<p>an integer number of iterations in the outer loop. This loop corresponds to the gradient
descent algorithm to minimize the regularized Wasserstein distance between the source and
target data sets. Default is <code>5000</code>.</p>
</td></tr>
<tr><td><code id="cytopt_desasc_r_+3A_n_stoc">n_stoc</code></td>
<td>
<p>an integer number of iterations in the inner loop. This loop corresponds to the stochastic
algorithm that approximates a maximizer of the semi-dual problem. Default is <code>10</code>.</p>
</td></tr>
<tr><td><code id="cytopt_desasc_r_+3A_step_grad">step_grad</code></td>
<td>
<p>an integer number step size of the gradient descent algorithm 
of the outer loop. Default is <code>10</code>.</p>
</td></tr>
<tr><td><code id="cytopt_desasc_r_+3A_monitoring">monitoring</code></td>
<td>
<p>boolean indicating whether Kullback-Leibler divergence should be 
monitored and store throughout the optimization iterations. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:<code>h_hat</code>
</p>

<hr>
<h2 id='cytopt_minmax_r'>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s
by using the classification Lab_source from an other cytometry data set X_s. With this function
an additional regularization parameter on the class proportions enables a faster computation of the
estimator.</h2><span id='topic+cytopt_minmax_r'></span>

<h3>Description</h3>

<p>Function to estimate the type cell proportions in an unclassified cytometry data set denoted X_s
by using the classification Lab_source from an other cytometry data set X_s. With this function
an additional regularization parameter on the class proportions enables a faster computation of the
estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cytopt_minmax_r(
  X_s,
  X_t,
  Lab_source,
  theta_true = NULL,
  eps = 1e-04,
  lbd = 1e-04,
  n_iter = 10000,
  step = 5,
  power = 0.99,
  monitoring = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cytopt_minmax_r_+3A_x_s">X_s</code></td>
<td>
<p>Cytometry data set. The columns correspond to the different biological markers tracked.
One line corresponds to the cytometry measurements performed on one cell. The classification
of this Cytometry data set must be provided with the Lab_source parameters.</p>
</td></tr>
<tr><td><code id="cytopt_minmax_r_+3A_x_t">X_t</code></td>
<td>
<p>Cytometry data set. The columns correspond to the different biological markers tracked.
One line corresponds to the cytometry measurements performed on one cell. The CytOpT algorithm
targets the cell type proportion in this Cytometry data set.</p>
</td></tr>
<tr><td><code id="cytopt_minmax_r_+3A_lab_source">Lab_source</code></td>
<td>
<p>Classification of the X_s Cytometry data set</p>
</td></tr>
<tr><td><code id="cytopt_minmax_r_+3A_theta_true">theta_true</code></td>
<td>
<p>If available, gold-standard proportions in the target data 
set <code>X_t</code> derived from manual gating. It allows to assess the gap between 
the estimate and the gold-standard. Default is <code>NULL</code>, in which case no 
assessment is performed.</p>
</td></tr>
<tr><td><code id="cytopt_minmax_r_+3A_eps">eps</code></td>
<td>
<p>Regularization parameter of the Wasserstein distance</p>
</td></tr>
<tr><td><code id="cytopt_minmax_r_+3A_lbd">lbd</code></td>
<td>
<p>an float constant that multiply the step-size policy. Default is <code>1e-04</code>.</p>
</td></tr>
<tr><td><code id="cytopt_minmax_r_+3A_n_iter">n_iter</code></td>
<td>
<p>an integer Constant that iterate method select. Default is <code>10000</code>.</p>
</td></tr>
<tr><td><code id="cytopt_minmax_r_+3A_step">step</code></td>
<td>
<p>Constant that multiply the step-size policy. Default is <code>5</code>.</p>
</td></tr>
<tr><td><code id="cytopt_minmax_r_+3A_power">power</code></td>
<td>
<p>the step size policy of the gradient ascent method is step/n^power.
Default is <code>0.99</code>.</p>
</td></tr>
<tr><td><code id="cytopt_minmax_r_+3A_monitoring">monitoring</code></td>
<td>
<p>boolean indicating whether Kullback-Leibler divergence should be 
monitored and store throughout the optimization iterations. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:<code>Results_Minmax</code>
</p>

<hr>
<h2 id='HIPC_Stanford'>HIPC_Stanford data</h2><span id='topic+HIPC_Stanford'></span><span id='topic+HIPC_Stanford_1228_1A'></span><span id='topic+HIPC_Stanford_1228_1A_labels'></span><span id='topic+HIPC_Stanford_1369_1A'></span><span id='topic+HIPC_Stanford_1369_1A_labels'></span>

<h3>Description</h3>

<p>HIPC T cell data set from HIPC program for patients 1228 and 1369 (replicate 1A from Stanford).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HIPC_Stanford)
</code></pre>


<h3>Format</h3>

<p>The data are composed of 4 objects:
</p>

<dl>
<dt><code>HIPC_Stanford_1228_1A</code>: </dt><dd><p>a <code>data.frame</code> of 31342 cells and 7 markers.</p>
</dd>
<dt><code>HIPC_Stanford_1228_1A_labels</code>: </dt><dd><p>a <code>factor</code> vector with the cell type
of each of the 31342 observed cells.</p>
</dd>
<dt><code>HIPC_Stanford_1369_1A</code>: </dt><dd><p>a <code>data.frame</code> of 33992 cells and 7 markers.</p>
</dd>
<dt><code>HIPC_Stanford_1369_1A_labels</code>: </dt><dd><p>a <code>factor</code> vector with the cell type
of each of the 33992 observed cells.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This immunophenotyping T cell panel from the Lyoplate HIPC dataset 
was used as part of the FlowCAP III Lyoplate challenge.
</p>
<p>Flow cytometry data set from the HIPC T-cell panel study. In the 
HIPC T-cell panel study, Flow cytometry was measured in 3 samples for each 
3 patients (IDs: 1228, 1349 and 1369) with 3 replicates each (1A, 2B and 3C) 
in 7 centers (NHLBI, Yale, UCLA, CIMR, Baylor, Stanford and Miami), i.e. 63 
data sets in total. Manual gating was performed in the different centers to 
cluster te observed cells into one of 10 cellular populations: 
</p>

<ol>
<li><p>CD8 Effector
</p>
</li>
<li><p>CD8 Naive
</p>
</li>
<li><p>CD8 Central Memory
</p>
</li>
<li><p>CD8 Effector Memory
</p>
</li>
<li><p>CD8 Activated
</p>
</li>
<li><p>CD4 Effector
</p>
</li>
<li><p>CD4 Naive
</p>
</li>
<li><p>CD4 Central Memory
</p>
</li>
<li><p>CD4 Effector Memory
</p>
</li>
<li><p>CD4 Activated
</p>
</li></ol>



<h3>Source</h3>

<p><a href="https://www.immuneprofiling.org/hipc/page/show">https://www.immuneprofiling.org/hipc/page/show</a> 
<a href="https://www.immunespace.org/">https://www.immunespace.org/</a> 
<a href="https://www.immunespace.org/project/HIPC/Lyoplate/begin.view?pageId=study.DATA_ANALYSIS">https://www.immunespace.org/project/HIPC/Lyoplate/begin.view?pageId=study.DATA_ANALYSIS</a>
</p>


<h3>References</h3>

<p>Maecker HT, McCoy JP &amp; Nussenblatt R (2012). Standardizing 
immunophenotyping for the human immunology project. Nature Reviews Immunology, 
12(3):191&ndash;200. DOI: 10.1038/nri3158
</p>
<p>Finak G, Langweiler M, Jaimes M, Malek M, Taghiyar J, Korin Y, Raddassi K, 
Devine L, Obermoser G, Pekalski ML, Pontikos N, Diaz A, Heck S, Villanova F, 
Terrazzini N, Kern F, Qian Y, Stanton R, Wang K, Brandes A, Ramey J, 
Aghaeepour N, Mosmann T, Scheuermann RH, Reed E, Palucka K, Pascual V, 
Blomberg BB, Nestle F, Nussenblatt RB, Brinkman RR, Gottardo R, Maecker H &amp; 
McCoy JP (2016). Standardizing Flow Cytometry Immunophenotyping Analysis from the Human 
ImmunoPhenotyping Consortium. Scientific Reports. 10(6):20686. DOI: 10.1038/srep20686.
</p>

<hr>
<h2 id='KL_plot'>Kullback-Leibler divergence plot</h2><span id='topic+KL_plot'></span>

<h3>Description</h3>

<p>A plotting function for displaying Kullback-Liebler (KL) divergence across 
iterations of the optimization algorithm(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KL_plot(
  monitoring,
  n_0 = 10,
  n_stop = 1000,
  title = "Kullback-Liebler divergence trace"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KL_plot_+3A_monitoring">monitoring</code></td>
<td>
<p><code>list</code> of monitoring estimates from <code>CytOpt()</code> output.</p>
</td></tr>
<tr><td><code id="KL_plot_+3A_n_0">n_0</code></td>
<td>
<p>first iteration to plot. Default is 10.</p>
</td></tr>
<tr><td><code id="KL_plot_+3A_n_stop">n_stop</code></td>
<td>
<p>last iteration to plot. Default is 1000.</p>
</td></tr>
<tr><td><code id="KL_plot_+3A_title">title</code></td>
<td>
<p>plot title. Default is <code>"Kullback-Liebler divergence trace"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){

gold_standard_manual_prop &lt;- c(table(HIPC_Stanford_1369_1A_labels) / 
 length(HIPC_Stanford_1369_1A_labels))
res &lt;- CytOpT(X_s = HIPC_Stanford_1228_1A, X_t = HIPC_Stanford_1369_1A, 
             Lab_source = HIPC_Stanford_1228_1A_labels,
             theta_true = gold_standard_manual_prop,
             eps = 0.0001, lbd = 0.0001, n_iter = 10000, n_stoc=10,
             step_grad = 10, step = 5, power = 0.99, 
             method='both', monitoring = TRUE)
plot(res)

}
</code></pre>

<hr>
<h2 id='Label_Prop_sto_r'>Computes a classification on the target data</h2><span id='topic+Label_Prop_sto_r'></span>

<h3>Description</h3>

<p>Computes a classification on the target data thanks to the approximation of 
the transport plan and the classification of the source data.
Transport plan is approximated with the stochastic algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Label_Prop_sto_r(
  X_s,
  X_t,
  Lab_source,
  eps = 1e-04,
  const = 0.1,
  n_iter = 4000,
  minMaxScaler = TRUE,
  monitoring = TRUE,
  thresholding = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Label_Prop_sto_r_+3A_x_s">X_s</code></td>
<td>
<p>a cytometry dataframe. The columns correspond to the different biological markers tracked.
One line corresponds to the cytometry measurements performed on one cell. The classification
of this Cytometry data set must be provided with the Lab_source parameters.</p>
</td></tr>
<tr><td><code id="Label_Prop_sto_r_+3A_x_t">X_t</code></td>
<td>
<p>a cytometry dataframe. The columns correspond to the different biological markers tracked.
One line corresponds to the cytometry measurements performed on one cell. The CytOpT algorithm
targets the cell type proportion in this Cytometry data set</p>
</td></tr>
<tr><td><code id="Label_Prop_sto_r_+3A_lab_source">Lab_source</code></td>
<td>
<p>a vector of length <code>n</code> Classification of the X_s cytometry data set</p>
</td></tr>
<tr><td><code id="Label_Prop_sto_r_+3A_eps">eps</code></td>
<td>
<p>an float value of regularization parameter of the Wasserstein distance. Default is <code>1e-04</code></p>
</td></tr>
<tr><td><code id="Label_Prop_sto_r_+3A_const">const</code></td>
<td>
<p>an float constant. Default is <code>1e-01</code></p>
</td></tr>
<tr><td><code id="Label_Prop_sto_r_+3A_n_iter">n_iter</code></td>
<td>
<p>an integer Constant that iterate method select. Default is <code>4000</code></p>
</td></tr>
<tr><td><code id="Label_Prop_sto_r_+3A_minmaxscaler">minMaxScaler</code></td>
<td>
<p>a logical flag indicating to possibly Scaler</p>
</td></tr>
<tr><td><code id="Label_Prop_sto_r_+3A_monitoring">monitoring</code></td>
<td>
<p>a logical flag indicating to possibly monitor the gap between the estimated proportions and the manual
gold-standard. Default is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="Label_Prop_sto_r_+3A_thresholding">thresholding</code></td>
<td>
<p>a logical flag.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object
</p>
<p>a vector of length <code>nrow(X_t)</code> with the propagated labels
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(interactive()){

res &lt;- Label_Prop_sto_r(X_s = HIPC_Stanford_1228_1A, X_t = HIPC_Stanford_1369_1A, 
             Lab_source = HIPC_Stanford_1228_1A_labels)

}

</code></pre>

<hr>
<h2 id='plot.CytOpt'>CytOpt plot</h2><span id='topic+plot.CytOpt'></span>

<h3>Description</h3>

<p>plot S3 method for CytOpt object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CytOpt'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.CytOpt_+3A_x">x</code></td>
<td>
<p>an object of class <code>CytOpt</code> to plot.</p>
</td></tr>
<tr><td><code id="plot.CytOpt_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. Not implemented.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object, potentially composed through 
<code><a href="patchwork.html#topic+patchwork">patchwork</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

res &lt;- CytOpT(X_s = HIPC_Stanford_1228_1A, X_t = HIPC_Stanford_1369_1A, 
             Lab_source = HIPC_Stanford_1228_1A_labels,
             eps = 0.0001, lbd = 0.0001, n_iter = 10000, n_stoc=10,
             step_grad = 10, step = 5, power = 0.99, 
             method='minmax')
plot(res)

}
</code></pre>

<hr>
<h2 id='print.CytOpt'>CytOpt print</h2><span id='topic+print.CytOpt'></span>

<h3>Description</h3>

<p>print S3 method for CytOpt object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CytOpt'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.CytOpt_+3A_x">x</code></td>
<td>
<p>an object of class <code>CytOpt</code> to print.</p>
</td></tr>
<tr><td><code id="print.CytOpt_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. Not implemented.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the proportions <code>data.frame</code> from <code>x</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

res &lt;- CytOpT(X_s = HIPC_Stanford_1228_1A, X_t = HIPC_Stanford_1369_1A, 
             Lab_source = HIPC_Stanford_1228_1A_labels,
             eps = 0.0001, lbd = 0.0001, n_iter = 10000, n_stoc=10,
             step_grad = 10, step = 5, power = 0.99, 
             method='minmax')
print(res)

}
</code></pre>

<hr>
<h2 id='print.summary.CytOpt'>CytOpt print summary</h2><span id='topic+print.summary.CytOpt'></span>

<h3>Description</h3>

<p>print S3 method for summary.CytOpt object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.CytOpt'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.CytOpt_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.CytOpt</code> to print.</p>
</td></tr>
<tr><td><code id="print.summary.CytOpt_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. Not implemented.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.CytOpt'>CytOpt summary</h2><span id='topic+summary.CytOpt'></span>

<h3>Description</h3>

<p>summary S3 method for CytOpt object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CytOpt'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.CytOpt_+3A_object">object</code></td>
<td>
<p>an object of class <code>CytOpt</code> to summarized.</p>
</td></tr>
<tr><td><code id="summary.CytOpt_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. Not implemented.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>list</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

res &lt;- CytOpT(X_s = HIPC_Stanford_1228_1A, X_t = HIPC_Stanford_1369_1A, 
             Lab_source = HIPC_Stanford_1228_1A_labels,
             eps = 0.0001, lbd = 0.0001, n_iter = 10000, n_stoc=10,
             step_grad = 10, step = 5, power = 0.99, 
             method='minmax', monitoring=TRUE)
summary(res)

}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
