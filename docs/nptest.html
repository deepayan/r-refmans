<!DOCTYPE html><html><head><title>Help for package nptest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nptest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#nptest-package'>
<p>Nonparametric Bootstrap and Permutation Tests</p></a></li>
<li><a href='#flipn'>
<p>Generate All Sign-Flips of n Elements</p></a></li>
<li><a href='#mcse'>
<p>Monte Carlo Standard Errors for Tests</p></a></li>
<li><a href='#np.boot'>
<p>Nonparametric Bootstrap Resampling</p></a></li>
<li><a href='#np.cor.test'>
<p>Nonparametric Tests of Correlation Coefficients</p></a></li>
<li><a href='#np.loc.test'>
<p>Nonparametric Tests of Location Parameters</p></a></li>
<li><a href='#np.reg.test'>
<p>Nonparametric Tests of Regression Coefficients</p></a></li>
<li><a href='#nptest-internal'>
<p>Internal 'nptest' Functions</p></a></li>
<li><a href='#permn'>
<p>Generate All Permutations of n Elements</p></a></li>
<li><a href='#plot'>
<p>Plots Permutation Distribution for Nonparametric Tests</p></a></li>
<li><a href='#StartupMessage'><p>Startup Message for nptest</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Bootstrap and Permutation Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-14</td>
</tr>
<tr>
<td>Author:</td>
<td>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Robust nonparametric bootstrap and permutation tests for location, correlation, and regression problems, as described in Helwig (2019a) &lt;<a href="https://doi.org/10.1002%2Fwics.1457">doi:10.1002/wics.1457</a>&gt; and Helwig (2019b) &lt;<a href="https://doi.org/10.1016%2Fj.neuroimage.2019.116030">doi:10.1016/j.neuroimage.2019.116030</a>&gt;. Univariate and multivariate tests are supported. For each problem, exact tests and Monte Carlo approximations are available. Five different nonparametric bootstrap confidence intervals are implemented. Parallel computing is implemented via the 'parallel' package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-14 17:12:52 UTC; nate</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-14 19:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='nptest-package'>
Nonparametric Bootstrap and Permutation Tests
</h2><span id='topic+nptest-package'></span><span id='topic+nptest'></span>

<h3>Description</h3>

<p>Robust nonparametric bootstrap and permutation tests for location, correlation, and regression problems, as described in Helwig (2019a) &lt;doi:10.1002/wics.1457&gt; and Helwig (2019b) &lt;doi:10.1016/j.neuroimage.2019.116030&gt;. Univariate and multivariate tests are supported. For each problem, exact tests and Monte Carlo approximations are available. Five different nonparametric bootstrap confidence intervals are implemented. Parallel computing is implemented via the 'parallel' package.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> nptest</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Nonparametric Bootstrap and Permutation Tests</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-04-14</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Nathaniel E. Helwig &lt;helwig@umn.edu&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Nathaniel E. Helwig &lt;helwig@umn.edu&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Robust nonparametric bootstrap and permutation tests for location, correlation, and regression problems, as described in Helwig (2019a) &lt;doi:10.1002/wics.1457&gt; and Helwig (2019b) &lt;doi:10.1016/j.neuroimage.2019.116030&gt;. Univariate and multivariate tests are supported. For each problem, exact tests and Monte Carlo approximations are available. Five different nonparametric bootstrap confidence intervals are implemented. Parallel computing is implemented via the 'parallel' package.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
StartupMessage          Startup Message for nptest
flipn                   Generate All Sign-Flips of n Elements
mcse                    Monte Carlo Standard Errors for Tests
np.boot                 Nonparametric Bootstrap Resampling
np.cor.test             Nonparametric Tests of Correlation Coefficients
np.loc.test             Nonparametric Tests of Location Parameters
np.reg.test             Nonparametric Tests of Regression Coefficients
nptest-package          Nonparametric Bootstrap and Permutation Tests
permn                   Generate All Permutations of n Elements
plot                    Plots Permutation Distribution for
                        Nonparametric Tests
</pre>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>
<p>Maintainer: Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Blair, R. C., Higgins, J. J., Karniski, W., &amp; Kromrey, J. D. (1994). A study of multivariate permutation tests which may replace Hotelling's T2 test in prescribed circumstances. Multivariate Behavioral Research, 29(2), 141-163. doi: 10.1207/s15327906mbr2902_2
</p>
<p>Carpenter, J., &amp; Bithell, J. (2000). Bootstrap confidence intervals: when, which, what? A practical guide for medical statisticians. <em>Statistics in Medicine, 19</em>(9), 1141-1164. doi: 10.1002/(SICI)1097-0258(20000515)19:9%3C1141::AID-SIM479%3E3.0.CO;2-F
</p>
<p>Chung, E., &amp; Romano, J. P. (2016). Asymptotically valid and exact permutation tests based on two-sample U-statistics. Journal of Statistical Planning and Inference, 168, 97-105. doi: 10.1016/j.jspi.2015.07.004
</p>
<p>Davison, A. C., &amp; Hinkley, D. V. (1997). <em>Bootstrap Methods and Their Application</em>. Cambridge University Press. doi: 10.1017/CBO9780511802843
</p>
<p>DiCiccio, C. J., &amp; Romano, J. P. (2017). Robust permutation tests for correlation and regression coefficients. Journal of the American Statistical Association, 112(519), 1211-1220. doi: 10.1080/01621459.2016.1202117
</p>
<p>Draper, N. R., &amp; Stoneman, D. M. (1966). Testing for the inclusion of variables in linear regression by a randomisation technique. Technometrics, 8(4), 695-699. doi: 10.2307/1266641
</p>
<p>Efron, B., &amp; Tibshirani, R. J. (1994). <em>An Introduction to the Boostrap</em>. Chapman &amp; Hall/CRC. doi: 10.1201/9780429246593
</p>
<p>Fisher, R. A. (1925). Statistical methods for research workers. Edinburgh: Oliver and Boyd.
</p>
<p>Freedman, D., &amp; Lane, D. (1983). A nonstochastic interpretation of reported significance levels. Journal of Business and Economic Statistics, 1(4), 292-298. doi: 10.2307/1391660
</p>
<p>Helwig, N. E. (2019a). Statistical nonparametric mapping: Multivariate permutation tests for location, correlation, and regression problems in neuroimaging. WIREs Computational Statistics, 11(2), e1457. doi: 10.1002/wics.1457
</p>
<p>Helwig, N. E. (2019b). Robust nonparametric tests of general linear model coefficients: A comparison of permutation methods and test statistics. NeuroImage, 201, 116030. doi: 10.1016/j.neuroimage.2019.116030
</p>
<p>Huh, M.-H., &amp; Jhun, M. (2001). Random permutation testing in multiple linear regression. Communications in Statistics - Theory and Methods, 30(10), 2023-2032. doi: 10.1081/STA-100106060
</p>
<p>Janssen, A. (1997). Studentized permutation tests for non-i.i.d. hypotheses and the generalized Behrens-Fisher problem. Statistics &amp; Probability Letters , 36 (1), 9-21. doi: 10.1016/S0167-7152(97)00043-6
</p>
<p>Johnson, N. J. (1978). Modified t tests and confidence intervals for asymmetrical populations. Journal of the American Statistical Association, 73 (363), 536-544. doi: 10.2307/2286597
</p>
<p>Kennedy, P. E., &amp; Cade, B. S. (1996). Randomization tests for multiple regression. Communications in Statistics - Simulation and Computation, 25(4), 923-936. doi: 10.1080/03610919608813350
</p>
<p>Manly, B. (1986). Randomization and regression methods for testing for associations with geographical, environmental and biological distances between populations. Researches on Population Ecology, 28(2), 201-218. doi: 10.1007/BF02515450
</p>
<p>Mann, H. B., &amp; Whitney, D. R. (1947). On a test of whether one of two random variables is stochastically larger than the other. Annals Of Mathematical Statistics, 18(1), 50-60. doi: 10.1214/aoms/1177730491
</p>
<p>Meyer, D., Dimitriadou, E., Hornik, K., Weingessel, A., &amp; Leisch, F. (2018). e1071: Misc Functions of the Department of Statistics, Probability Theory Group (Formerly: E1071), TU Wien. R package version 1.7-0. https://CRAN.R-project.org/package=e1071
</p>
<p>Nichols, T. E., Ridgway, G. R., Webster, M. G., &amp; Smith, S. M. (2008). GLM permutation: nonparametric inference for arbitrary general linear models. NeuroImage, 41(S1), S72.
</p>
<p>O'Gorman, T. W. (2005). The performance of randomization tests that use permutations of independent variables. Communications in Statistics - Simulation and Computation, 34(4), 895-908. doi: 10.1080/03610910500308230
</p>
<p>Pitman, E. J. G. (1937a). Significance tests which may be applied to samples from any populations. Supplement to the Journal of the Royal Statistical Society, 4(1), 119-130. doi: 10.2307/2984124
</p>
<p>Pitman, E. J. G. (1937b). Significance tests which may be applied to samples from any populations. ii. the correlation coefficient test. Supplement to the Journal of the Royal Statistical Society, 4(2), 225-232. doi: 10.2307/2983647
</p>
<p>Romano, J. P. (1990). On the behavior of randomization tests without a group invariance assumption. Journal of the American Statistical Association, 85(411), 686-692. doi: 10.1080/01621459.1990.10474928
</p>
<p>Still, A. W., &amp; White, A. P. (1981). The approximate randomization test as an alternative to the F test in analysis of variance. British Journal of Mathematical and Statistical Psychology, 34(2), 243-252. doi: 10.1111/j.2044-8317.1981.tb00634.x
</p>
<p>Student. (1908). The probable error of a mean. Biometrika, 6(1), 1-25. doi: 10.2307/2331554
</p>
<p>ter Braak, C. J. F. (1992). Permutation versus bootstrap significance tests in multiple regression and ANOVA. In K. H. J\&quot;ockel, G. Rothe, &amp; W. Sendler (Eds.), Bootstrapping and related techniques. lecture notes in economics and mathematical systems, vol 376 (pp. 79-86). Springer.
</p>
<p>Welch, B. L. (1938). The significance of the difference between two means when the population variances are unequal. Biometrika, 39(3/4), 350-362. doi: 10.2307/2332010
</p>
<p>Wilcoxon, F. (1945). Individual comparisons by ranking methods. Biometrics Bulletin, 1(6), 80-83. doi: 10.2307/3001968
</p>
<p>White, H. (1980). A heteroscedasticity-consistent covariance matrix and a direct test for heteroscedasticity. Econometrica, 48(4), 817-838. doi: 10.2307/1912934
</p>
<p>Winkler, A. M., Ridgway, G. R., Webster, M. A., Smith, S. M., &amp; Nichols, T. E. (2014). Permutation inference for the general linear model. NeuroImage, 92, 381-397. doi: 10.1016/j.neuroimage.2014.01.060
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples for... 
#   flipn        (generate all sign flip vectors)
#   mcse         (Monte Carlo standard errors)
#   np.boot      (nonparametric bootstrap resampling)
#   np.cor.test  (nonparametric correlation tests)
#   np.loc.test  (nonparametric location tests)
#   np.reg.test  (nonparametric regression tests)
#   permn        (generate all permutation vectors)
</code></pre>

<hr>
<h2 id='flipn'>
Generate All Sign-Flips of n Elements
</h2><span id='topic+flipn'></span>

<h3>Description</h3>

<p>Generates all <code class="reqn">2^n</code> vectors of length <code class="reqn">n</code> consisting of the elements -1 and 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flipn(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flipn_+3A_n">n</code></td>
<td>

<p>Number of elements.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adapted from the &quot;bincombinations&quot; function in the <a href="https://CRAN.R-project.org/package=e1071">e1071</a> R package.
</p>


<h3>Value</h3>

<p>Matrix of dimension <code class="reqn">n</code> by <code class="reqn">2^n</code> where each column contains a unique sign-flip vector.
</p>


<h3>Warning </h3>

<p>For large <code>n</code> this function will consume a lot of memory and may even crash R.
</p>


<h3>Note</h3>

<p>Used for exact tests in <code><a href="#topic+np.loc.test">np.loc.test</a></code> and <code><a href="#topic+np.reg.test">np.reg.test</a></code>.
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Meyer, D., Dimitriadou, E., Hornik, K., Weingessel, A., &amp; Leisch, F. (2018). e1071: Misc Functions of the Department of Statistics, Probability Theory Group (Formerly: E1071), TU Wien. R package version 1.7-0. https://CRAN.R-project.org/package=e1071
</p>


<h3>Examples</h3>

<pre><code class='language-R'>flipn(2)
flipn(3)
</code></pre>

<hr>
<h2 id='mcse'>
Monte Carlo Standard Errors for Tests
</h2><span id='topic+mcse'></span>

<h3>Description</h3>

<p>This function calculates Monte Carlo standard errors for (non-exact) nonparametric tests. The MCSEs can be used to determine (i) the accuracy of a test for a given number of resamples, or (ii) the number of resamples needed to achieve a test with a given accuracy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcse(R, delta, conf.level = 0.95, sig.level = 0.05,
     alternative = c("two.sided", "one.sided"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcse_+3A_r">R</code></td>
<td>

<p>Number of resamples (positive integer).
</p>
</td></tr>
<tr><td><code id="mcse_+3A_delta">delta</code></td>
<td>

<p>Accuracy of the approximation (number between 0 and 1).
</p>
</td></tr>
<tr><td><code id="mcse_+3A_conf.level">conf.level</code></td>
<td>

<p>Confidence level for the approximation (number between 0 and 1).
</p>
</td></tr>
<tr><td><code id="mcse_+3A_sig.level">sig.level</code></td>
<td>

<p>Significance level of the test (number between 0 and 1).
</p>
</td></tr>
<tr><td><code id="mcse_+3A_alternative">alternative</code></td>
<td>

<p>Alternative hypothesis (two-sided or one-sided).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note: either <code>R</code> or <code>delta</code> must be provided.
</p>
<p>Let <code class="reqn">F(x)</code> denote the distribution function for the full permutation distribution, and let <code class="reqn">G(x)</code> denote the approximation obtained from <code class="reqn">R</code> resamples. The <em>Monte Carlo standard error</em> is given by 
</p>
<p style="text-align: center;"><code class="reqn">
\sigma(x) = \sqrt{ F(x) [1 - F(x)] / R }
</code>
</p>

<p>which is the standard deviation of <code class="reqn">G(x)</code>. 
</p>
<p>A symmetric confidence interval for <code class="reqn">F(x)</code> can be approximated as
</p>
<p style="text-align: center;"><code class="reqn">
G(x) +/- C \sigma(x)
</code>
</p>

<p>where <code class="reqn">C</code> is some quantile of the standard normal distribution. Note that the critical value <code class="reqn">C</code> corresponds to the confidence level (<code>conf.level</code>) of the approximation.
</p>
<p>Let <code class="reqn">\alpha</code> denote the significance level (<code>sig.level</code>) for a one-sided test (<code class="reqn">\alpha</code> is one-half the significance level for two-sided tests). Define <code class="reqn">a</code> to be the value of the test statistic such that <code class="reqn">F(a) = \alpha</code>. 
</p>
<p>The parameter <code class="reqn">\delta</code> (<code>delta</code>) quantifies the accuracy of the approximation, such that 
</p>
<p style="text-align: center;"><code class="reqn">
|G(a) - \alpha| &lt; \alpha \delta
</code>
</p>

<p>with a given confidence, which is controlled by the <code>conf.level</code> argument.
</p>


<h3>Value</h3>

<table>
<tr><td><code>mcse</code></td>
<td>
<p>Monte Carlo standard error.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Number of resamples.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>Accuracy of approximation.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code>sig.level</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>Alternative hypothesis.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is only relevant for non-exact tests. For exact tests, <code class="reqn">F(x) = G(x)</code> so the Monte Carlo standard error is zero.
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Helwig, N. E. (2019). Statistical nonparametric mapping: Multivariate permutation tests for location, correlation, and regression problems in neuroimaging. WIREs Computational Statistics, 11(2), e1457. doi: 10.1002/wics.1457
</p>


<h3>See Also</h3>

<p><code><a href="#topic+np.cor.test">np.cor.test</a></code>, <code><a href="#topic+np.loc.test">np.loc.test</a></code>, <code><a href="#topic+np.reg.test">np.reg.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###***###   EXAMPLE 1   ###***###

# get the Monte Carlo standard error and the 
# accuracy (i.e., delta) for given R = 10000
# using the default two-sided alternative hypothesis,
# the default confidence level (conf.level = 0.95),
# and the default significance level (sig.level = 0.05)

mcse(R = 10000)

# se = 0.0016
# delta = 0.1224


###***###   EXAMPLE 2   ###***###

# get the Monte Carlo standard error and the 
# number of resamples (i.e., R) for given delta = 0.01
# using a one-sided alternative hypothesis,
# the default confidence level (conf.level = 0.95),
# and the default significance level (sig.level = 0.05)

mcse(delta = 0.1, alternative = "one.sided")

# se = 0.0026
# R = 7299

</code></pre>

<hr>
<h2 id='np.boot'>
Nonparametric Bootstrap Resampling
</h2><span id='topic+np.boot'></span>

<h3>Description</h3>

<p>Nonparametric bootstrap resampling for univariate and multivariate statistics. Computes bootstrap estimates of the standard error, bias, and covariance. Also computes five different types of bootstrap confidence intervals: normal approximation interval, basic (reverse percentile) interval, percentile interval, studentized (bootstrap-<em>t</em>) interval, and bias-corrected and accelerated (BCa) interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>np.boot(x, statistic, ..., R = 9999, level = c(0.9, 0.95, 0.99),
        method = c("norm", "basic", "perc", "stud", "bca")[-4], 
        sdfun = NULL, sdrep = 99, jackknife = NULL, 
        parallel = FALSE, cl = NULL, boot.dist = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="np.boot_+3A_x">x</code></td>
<td>

<p>vector of data (for univariate data) or vector of row indices (for multivariate data). See examples for bootstrapping multivariate data.
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_statistic">statistic</code></td>
<td>

<p>function that takes in <code>x</code> (and possibly additional arguments passed using <code>...</code>) and returns a vector containing the statistic(s). See examples.
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_...">...</code></td>
<td>

<p>additional named arguments for the <code>statistic</code> function.  
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_r">R</code></td>
<td>

<p>number of bootstrap replicates  
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_level">level</code></td>
<td>

<p>desired confidence level(s) for the computed intervals. Default computes 90%, 95%, and 99% confidence intervals.  
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_method">method</code></td>
<td>

<p>method(s) for computing confidence intervals. Partial matching is allowed. Any subset of allowable methods is permitted (default computes all intervals except studentized). Set <code>method = NULL</code> to produce no confidence intervals.
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_sdfun">sdfun</code></td>
<td>

<p>function for computing the standard deviation of <code>statistic</code>. Should produce a vector the same length as the output of <code>statistic</code>. Only applicable if <code>"stud" %in% method</code>. If <code>NULL</code>, an inner bootstrap is used to estimate the standard deviation.
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_sdrep">sdrep</code></td>
<td>

<p>number of bootstrap replicates for the inner bootstrap used to estimate the standard deviation of <code>statistic</code>. Only applicable if <code>"stud" %in% method</code> and <code>sdfun = NULL</code>. Larger values produce more accurate estimates (see Note).
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_jackknife">jackknife</code></td>
<td>

<p>function that takes in <code>x</code> (and possibly additional arguments passed using <code>...</code>) and returns a vector containing the jackknife statistic(s). Should produce a vector the same length as the output of <code>statistic</code>. Only applicable if <code>"bca" %in% method</code>. If <code>NULL</code>, the jackknife function is defined as the statistic function (default). See the last example for a case when <code>statistic</code> and <code>jackknife</code> are different.
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_parallel">parallel</code></td>
<td>

<p>Logical indicating if the <code><a href="lattice.html#topic+parallel">parallel</a></code> package should be used for parallel computing (of the bootstrap distribution). Defaults to <code>FALSE</code>, which implements sequential computing.
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_cl">cl</code></td>
<td>

<p>Cluster for parallel computing, which is used when <code>parallel = TRUE</code>. Note that if <code>parallel = TRUE</code> and <code>cl = NULL</code>, then the cluster is defined as <code>makeCluster(2L)</code> to use two cores. To make use of all available cores, use the code <code>cl = makeCluster(detectCores())</code>.
</p>
</td></tr>
<tr><td><code id="np.boot_+3A_boot.dist">boot.dist</code></td>
<td>

<p>Logical indicating if the bootstrap distribution should be returned (see Note).  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first three intervals (normal, basic, and percentile) are only first-order accurate, whereas the last two intervals (studentized and BCa) are both second-order accurate. Thus, the results from the studentized and BCa intervals tend to provide more accurate coverage rates.
</p>
<p>Unless the standard deviation function for the studentized interval is input via the <code>sdfun</code> argument, the studentized interval can be quite computationally costly. This is because an inner bootstrap is needed to estimate the standard deviation of the statistic for each (outer) bootstrap replicate&mdash;and you may want to increase the default number of inner bootstrap replicates (see Note).
</p>
<p>The efficiency of the BCa interval will depend on the sample size <code class="reqn">n</code> and the computational complexity of the (jackknife) statistic estimate. Assuming that <code class="reqn">n</code> is not too large and the jackknife statistic is not too difficult to compute, the BCa interval can be computed reasonably quickly&mdash;especially in comparison the studentized interval with an inner bootstrap.
</p>
<p>Computational details of the various confidence intervals are described in Efron and Tibshirani (1994) and in Davison and Hinkley (1997). For a useful and concise discussion of the various intervals, see Carpenter and Bithell (2000).
</p>


<h3>Value</h3>

<table>
<tr><td><code>t0</code></td>
<td>
<p>Observed statistic, computed using <code>statistic(x, ...)</code></p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Bootstrap estimate of the standard error.</p>
</td></tr>
<tr><td><code>bias</code></td>
<td>
<p>Bootstrap estimate of the bias.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>Bootstrap estimate of the covariance (for multivariate statistics).</p>
</td></tr>
<tr><td><code>normal</code></td>
<td>
<p>Normal approximation confidence interval(s).</p>
</td></tr>
<tr><td><code>basic</code></td>
<td>
<p>Basic (reverse percentile) confidence interval(s).</p>
</td></tr>
<tr><td><code>percent</code></td>
<td>
<p>Percentile confidence interval(s).</p>
</td></tr>
<tr><td><code>student</code></td>
<td>
<p>Studentized (bootstrap-<em>t</em>) confidence interval(s).</p>
</td></tr>
<tr><td><code>bca</code></td>
<td>
<p>Bias-corrected and accelerated (BCa) confidence interval(s).</p>
</td></tr>
<tr><td><code>z0</code></td>
<td>
<p>Bias-correction factor(s). Only provided if <code>bca %in% method</code>.</p>
</td></tr>
<tr><td><code>acc</code></td>
<td>
<p>Acceleration factor(s). Only provided if <code>bca %in% method</code>.</p>
</td></tr>
<tr><td><code>boot.dist</code></td>
<td>
<p>Bootstrap distribution of statistic(s). Only provided if <code>boot.dist = TRUE</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Number of bootstrap replicates (same as input).</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Confidence level (same as input).</p>
</td></tr>
<tr><td><code>sdfun</code></td>
<td>
<p>Standard deviation function for statistic (same as input).</p>
</td></tr>
<tr><td><code>sdrep</code></td>
<td>
<p>Number of inner bootstrap replicates (same as input).</p>
</td></tr>
<tr><td><code>jackknife</code></td>
<td>
<p>Jackknife function (same as input).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If <code>boot.dist = TRUE</code>, the output <code>boot.dist</code> will be a matrix of dimension <code>R</code> by <code>length(statistic(x, ...))</code> if the statistic is multivariate. Otherwise the bootstrap distribution will be a vector of length <code>R</code>.
</p>
<p>For the <code>"stud"</code> method, the default of <code>sdrep = 99</code> may produce a crude estimate of the standard deviation of the statistic(s). For more accurate estimates, the value of <code>sdrep</code> may need to be set substantially larger, e.g., <code>sdrep = 999</code>. 
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Carpenter, J., &amp; Bithell, J. (2000). Bootstrap confidence intervals: when, which, what? A practical guide for medical statisticians. <em>Statistics in Medicine, 19</em>(9), 1141-1164. doi: 10.1002/(SICI)1097-0258(20000515)19:9%3C1141::AID-SIM479%3E3.0.CO;2-F 
</p>
<p>Davison, A. C., &amp; Hinkley, D. V. (1997). <em>Bootstrap Methods and Their Application</em>. Cambridge University Press. doi: 10.1017/CBO9780511802843
</p>
<p>Efron, B., &amp; Tibshirani, R. J. (1994). <em>An Introduction to the Boostrap</em>. Chapman &amp; Hall/CRC. doi: 10.1201/9780429246593
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######***######   UNIVARIATE DATA   ######***######

### Example 1: univariate statistic (median)

# generate 100 standard normal observations
set.seed(1)
n &lt;- 100
x &lt;- rnorm(n)

# nonparametric bootstrap
npbs &lt;- np.boot(x = x, statistic = median)
npbs


### Example 2: multivariate statistic (quartiles)

# generate 100 standard normal observations
set.seed(1)
n &lt;- 100
x &lt;- rnorm(n)

# nonparametric bootstrap
npbs &lt;- np.boot(x = x, statistic = quantile, 
                probs = c(0.25, 0.5, 0.75))
npbs



######***######   MULTIVARIATE DATA   ######***######

### Example 1: univariate statistic (correlation)

# correlation matrix square root (with rho = 0.5)
rho &lt;- 0.5
val &lt;- c(sqrt(1 + rho), sqrt(1 - rho))
corsqrt &lt;- matrix(c(val[1], -val[2], val), 2, 2) / sqrt(2)

# generate 100 bivariate observations (with rho = 0.5)
n &lt;- 100
set.seed(1)
data &lt;- cbind(rnorm(n), rnorm(n)) %*% corsqrt

# define statistic function
statfun &lt;- function(x, data) cor(data[x,1], data[x,2])

# nonparametric bootstrap
npbs &lt;- np.boot(x = 1:n, statistic = statfun, data = data)
npbs


### Example 2: multivariate statistic (variances and covariance)

# correlation matrix square root (with rho = 0.5)
rho &lt;- 0.5
val &lt;- c(sqrt(1 + rho), sqrt(1 - rho))
corsqrt &lt;- matrix(c(val[1], -val[2], val), 2, 2) / sqrt(2)

# generate 100 bivariate observations (with rho = 0.5)
n &lt;- 100
set.seed(1)
data &lt;- cbind(rnorm(n), rnorm(n)) %*% corsqrt

# define statistic function
statfun &lt;- function(x, data) {
  cmat &lt;- cov(data[x,])
  ltri &lt;- lower.tri(cmat, diag = TRUE)
  cvec &lt;- cmat[ltri]
  names(cvec) &lt;- c("var(x1)", "cov(x1,x2)", "var(x2)")
  cvec
}

# nonparametric bootstrap
npbs &lt;- np.boot(x = 1:n, statistic = statfun, data = data)
npbs



## Not run: 

######***######   REGRESSION   ######***######

### Example 1: bootstrap cases

# generate 100 observations
n &lt;- 100
set.seed(1)
x &lt;- seq(0, 1, length.out = n)
y &lt;- 1 + 2 * x + rnorm(n)
data &lt;- data.frame(x = x, y = y)

# define statistic function
statfun &lt;- function(x, data) {
  xmat &lt;- cbind(1, data$x[x])
  xinv &lt;- solve(crossprod(xmat)) %*% t(xmat)
  coef &lt;- as.numeric(xinv %*% data$y[x])
  names(coef) &lt;- c("(Intercept)", "x")
  coef
}

# nonparametric bootstrap
npbs &lt;- np.boot(x = 1:n, statistic = statfun, data = data)
npbs


### Example 2: bootstrap residuals

# generate 100 observations
n &lt;- 100
set.seed(1)
x &lt;- seq(0, 1, length.out = n)
y &lt;- 1 + 2 * x + rnorm(n)

# prepare data
xmat &lt;- cbind(1, x)
xinv &lt;- solve(crossprod(xmat)) %*% t(xmat)
fit &lt;- xmat %*% xinv %*% y
data &lt;- list(fit = fit, resid = y - fit, xinv = xinv, x = x)

# define statistic function
statfun &lt;- function(x, data) {
  ynew &lt;- data$fit + data$resid[x]
  coef &lt;- as.numeric(data$xinv %*% ynew)
  names(coef) &lt;- c("(Intercept)", "x")
  coef
}

# define jackknife function
jackfun &lt;- function(x, data){
  ynew &lt;- data$fit[x] + data$resid[x]
  xmat &lt;- cbind(1, data$x[x])
  xinv &lt;- solve(crossprod(xmat)) %*% t(xmat)
  coef &lt;- as.numeric(xinv %*% ynew)
  names(coef) &lt;- c("(Intercept)", "x")
  coef
}

# nonparametric bootstrap
npbs &lt;- np.boot(x = 1:n, statistic = statfun, data = data, 
                jackknife = jackfun)
npbs

## End(Not run)

</code></pre>

<hr>
<h2 id='np.cor.test'>
Nonparametric Tests of Correlation Coefficients
</h2><span id='topic+np.cor.test'></span>

<h3>Description</h3>

<p>Denoting the Pearson product-moment correlation coefficient as
</p>
<p style="text-align: center;"><code class="reqn">\rho = Cov(X, Y) / \sqrt{Var(X) Var(Y)}</code>
</p>
 
<p>this function implements permutation tests of <code class="reqn">H_0: \rho = \rho_0</code> where <code class="reqn">\rho_0</code> is the user-specified null value. Can also implement tests of partial correlations, semi-partial (or part) correlations, and independence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>np.cor.test(x, y, z = NULL,
            alternative = c("two.sided", "less", "greater"),
            rho = 0, independent = FALSE, partial = TRUE,
            R = 9999, parallel = FALSE, cl = NULL,
            perm.dist = TRUE, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="np.cor.test_+3A_x">x</code></td>
<td>

<p><code class="reqn">X</code> vector (<code>n</code> by 1).
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_y">y</code></td>
<td>

<p><code class="reqn">Y</code> vector (<code>n</code> by 1).
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_z">z</code></td>
<td>

<p>Optional <code class="reqn">Z</code> matrix (<code>n</code> by <code>q</code>). If provided, the partial (or semi-partial if <code>partial = FALSE</code>) correlation is calculated between <code>x</code> and <code>y</code> controlling for <code>z</code>.
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_alternative">alternative</code></td>
<td>

<p>Alternative hypothesis. Must be either &quot;two.sided&quot; (<code class="reqn">H_1: \rho \neq \rho_0</code>), &quot;less&quot; (<code class="reqn">H_1: \rho &lt; \rho_0</code>), or &quot;greater&quot; (<code class="reqn">H_1: \rho &gt; \rho_0</code>).
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_rho">rho</code></td>
<td>

<p>Null hypothesis value <code class="reqn">\rho_0</code>. Defaults to zero.
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_independent">independent</code></td>
<td>

<p>If <code>FALSE</code> (default), the null hypothesis is <code class="reqn">H_0: \rho = \rho_0</code>. Otherwise, the null hythpothesis is that <code class="reqn">X</code> and <code class="reqn">Y</code> are independent, i.e., <code class="reqn">H_0: F_{XY}(x,y) = F_X(x) F_Y(y)</code>.
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_partial">partial</code></td>
<td>

<p>Only applicable if <code>z</code> is provided. If <code>TRUE</code> (default), the partial correlation between <code>x</code> and <code>y</code> controlling for <code>z</code> is tested. Otherwise the semi-partial correlation is tested. See Details. 
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_r">R</code></td>
<td>

<p>Number of resamples for the permutation test (positive integer). 
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_parallel">parallel</code></td>
<td>

<p>Logical indicating if the <code><a href="lattice.html#topic+parallel">parallel</a></code> package should be used for parallel computing (of the permutation distribution). Defaults to <code>FALSE</code>, which implements sequential computing.
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_cl">cl</code></td>
<td>

<p>Cluster for parallel computing, which is used when <code>parallel = TRUE</code>. Note that if <code>parallel = TRUE</code> and <code>cl = NULL</code>, then the cluster is defined as <code>makeCluster(2L)</code> to use two cores. To make use of all available cores, use the code <code>cl = makeCluster(detectCores())</code>.
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_perm.dist">perm.dist</code></td>
<td>

<p>Logical indicating if the permutation distribution should be returned.  
</p>
</td></tr>
<tr><td><code id="np.cor.test_+3A_na.rm">na.rm</code></td>
<td>

<p>If <code>TRUE</code> (default), the arguments <code>x</code> and <code>y</code> (and <code>z</code> if provided) are passed to the <code><a href="stats.html#topic+na.omit">na.omit</a></code> function to remove cases with missing data.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Default use of this function tests the Pearson correlation between <code class="reqn">X</code> and <code class="reqn">Y</code> using the studentized test statistic proposed by DiCiccio and Romano (2017). If <code>independent = TRUE</code>, the classic (unstudentized) test statistic is used to test the null hypothesis of independence.
</p>
<p>If <code class="reqn">Z</code> is provided, the partial or semi-partial correlation between <code class="reqn">X</code> and <code class="reqn">Y</code> controlling for <code class="reqn">Z</code> is tested. For the semi-partial correlation, the effect of <code class="reqn">Z</code> is partialled out of <code class="reqn">X</code>. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>statistic</code></td>
<td>

<p>Test statistic value.
</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>

<p>p-value for testing <code class="reqn">H_0: \rho = \rho_0</code> or <code class="reqn">H_0: F_{XY}(x,y) = F_X(x) F_Y(y)</code>.
</p>
</td></tr>
<tr><td><code>perm.dist</code></td>
<td>

<p>Permutation distribution of <code>statistic</code>. 
</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>

<p>Alternative hypothesis.
</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>

<p>Null hypothesis value for <code class="reqn">\rho</code>.
</p>
</td></tr>
<tr><td><code>independent</code></td>
<td>

<p>Independence test?
</p>
</td></tr>
<tr><td><code>R</code></td>
<td>

<p>Number of resamples.
</p>
</td></tr>
<tr><td><code>exact</code></td>
<td>

<p>Exact permutation test? See Note.
</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>

<p>Sample estimate of correlation coefficient <code class="reqn">\rho</code>.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The permutation test will be exact when the requested number of resamples <code>R</code> is greater than <code>factorial(n)</code> minus one. In this case, the permutation distribution <code>perm.dist</code> contains all <code>factorial(n)</code> possible values of the test statistic.
</p>
<p>If <code>z = NULL</code>, the result will be the same as using <code><a href="#topic+np.reg.test">np.reg.test</a></code> with <code>method = "perm"</code>.
</p>
<p>If <code>z</code> is supplied and <code>partial = TRUE</code>, the result will be the same as using <code><a href="#topic+np.reg.test">np.reg.test</a></code> with <code>method = "KC"</code> and <code>homosced = FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>DiCiccio, C. J., &amp; Romano, J. P. (2017). Robust permutation tests for correlation and regression coefficients. Journal of the American Statistical Association, 112(519), 1211-1220. doi: 10.1080/01621459.2016.1202117
</p>
<p>Helwig, N. E. (2019). Statistical nonparametric mapping: Multivariate permutation tests for location, correlation, and regression problems in neuroimaging. WIREs Computational Statistics, 11(2), e1457. doi: 10.1002/wics.1457
</p>
<p>Pitman, E. J. G. (1937b). Significance tests which may be applied to samples from any populations. ii. the correlation coefficient test. Supplement to the Journal of the Royal Statistical Society, 4(2), 225-232. doi: 10.2307/2983647
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.np.cor.test">plot.np.cor.test</a></code> S3 plotting method for visualizing the results
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate data
rho &lt;- 0.5
val &lt;- c(sqrt(1 + rho), sqrt(1 - rho))
corsqrt &lt;- matrix(c(val[1], -val[2], val), 2, 2) / sqrt(2)
set.seed(1)
n &lt;- 10
z &lt;- cbind(rnorm(n), rnorm(n)) %*% corsqrt
x &lt;- z[,1]
y &lt;- z[,2]

# test H0: rho = 0
set.seed(0)
np.cor.test(x, y)

# test H0: X and Y are independent
set.seed(0)
np.cor.test(x, y, independent = TRUE)

</code></pre>

<hr>
<h2 id='np.loc.test'>
Nonparametric Tests of Location Parameters
</h2><span id='topic+np.loc.test'></span>

<h3>Description</h3>

<p>Performs one and two sample nonparametric (randomization) tests of location parameters, i.e., means and medians. Implements univariate and multivariate tests using eight different test statistics: Student's one-sample t-test, Johnson's modified t-test, Wilcoxon's Signed Rank test, Fisher's Sign test, Student's two-sample t-test, Welch's t-test, Wilcoxon's Rank Sum test (i.e., Mann-Whitney's <code class="reqn">U</code> test), and a studentized Wilcoxon test for unequal variances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>np.loc.test(x, y = NULL,
            alternative = c("two.sided", "less", "greater"),
            mu = 0, paired = FALSE, var.equal = FALSE, 
            median.test = FALSE, symmetric = TRUE,
            R = 9999, parallel = FALSE, cl = NULL,
            perm.dist = TRUE, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="np.loc.test_+3A_x">x</code></td>
<td>

<p>Numeric vector (or matrix) of data values.
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_y">y</code></td>
<td>

<p>Optional numeric vector (or matrix) of data values.
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_alternative">alternative</code></td>
<td>

<p>Alternative hypothesis. Must be either &quot;two.sided&quot; (<code class="reqn">H_1: \mu \neq \mu_0</code>), &quot;less&quot; (<code class="reqn">H_1: \mu &lt; \mu_0</code>), or &quot;greater&quot; (<code class="reqn">H_1: \mu &gt; \mu_0</code>).
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_mu">mu</code></td>
<td>

<p>Null hypothesis value <code class="reqn">\mu_0</code>. Defaults to zero.
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_paired">paired</code></td>
<td>

<p>Logical indicating whether you want a paired location test.  
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_var.equal">var.equal</code></td>
<td>

<p>Logical indicating whether to treat the two variances as being equal.
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_median.test">median.test</code></td>
<td>

<p>Logical indicating whether the location test is for the median. Default is <code>FALSE</code>, i.e., <code class="reqn">\mu</code> is the mean.
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_symmetric">symmetric</code></td>
<td>

<p>Logical indicating if the distribution of <code>x</code> should be assumed to be symmetric around <code class="reqn">\mu</code>. Only used for one (or paired) sample tests.
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_r">R</code></td>
<td>

<p>Number of resamples for the permutation test (positive integer). 
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_parallel">parallel</code></td>
<td>

<p>Logical indicating if the <code><a href="lattice.html#topic+parallel">parallel</a></code> package should be used for parallel computing (of the permutation distribution). Defaults to <code>FALSE</code>, which implements sequential computing.
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_cl">cl</code></td>
<td>

<p>Cluster for parallel computing, which is used when <code>parallel = TRUE</code>. Note that if <code>parallel = TRUE</code> and <code>cl = NULL</code>, then the cluster is defined as <code>makeCluster(2L)</code> to use two cores. To make use of all available cores, use the code <code>cl = makeCluster(detectCores())</code>.
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_perm.dist">perm.dist</code></td>
<td>

<p>Logical indicating if the permutation distribution should be returned.  
</p>
</td></tr>
<tr><td><code id="np.loc.test_+3A_na.rm">na.rm</code></td>
<td>

<p>If <code>TRUE</code> (default), the arguments <code>x</code> (and <code>y</code> if provided) are passed to the <code><a href="stats.html#topic+na.omit">na.omit</a></code> function to remove cases with missing data.
</p>
</td></tr>
</table>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
One sample </td><td style="text-align: left;"> <code class="reqn">\mu</code> is the mean (or median) of <code class="reqn">X</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
Paired </td><td style="text-align: left;"> <code class="reqn">\mu</code> is the mean (or median) of <code class="reqn">X - Y</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
Two sample </td><td style="text-align: left;"> <code class="reqn">\mu</code> is the mean difference <code class="reqn">E(X) - E(Y)</code> </td>
</tr>
<tr>
 <td style="text-align: left;"> 
 </td><td style="text-align: left;"> or the median of the differences <code class="reqn">X - Y</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>For one (or paired) sample tests, the different test statistics can be obtained using
</p>

<table>
<tr>
 <td style="text-align: left;">
 </td><td style="text-align: left;"> <code>median.test = F</code> </td><td style="text-align: left;"> <code>median.test = T</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>symmetric = F</code> </td><td style="text-align: left;"> Johnson t test </td><td style="text-align: left;"> Fisher sign test </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>symmetric = T</code> </td><td style="text-align: left;"> Student t test </td><td style="text-align: left;"> Wilcoxon signed rank test </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>For two sample tests, the different test statistics can be obtained using
</p>

<table>
<tr>
 <td style="text-align: left;">
 </td><td style="text-align: left;"> <code>median.test = F</code> </td><td style="text-align: left;"> <code>median.test = T</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>var.equal = F</code> </td><td style="text-align: left;"> Welch t test </td><td style="text-align: left;"> Studentized Wilcoxon test </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>var.equal = T</code> </td><td style="text-align: left;"> Student t test </td><td style="text-align: left;"> Wilcoxon rank sum test </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<table>
<tr><td><code>statistic</code></td>
<td>

<p>Test statistic value.
</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>

<p>p-value for testing <code class="reqn">H_0: \mu = \mu_0</code>.
</p>
</td></tr>
<tr><td><code>perm.dist</code></td>
<td>

<p>Permutation distribution of <code>statistic</code>.
</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>

<p>Alternative hypothesis.
</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>

<p>Null hypothesis value for <code class="reqn">\mu</code>.
</p>
</td></tr>
<tr><td><code>var.equal</code></td>
<td>

<p>Assuming equal variances? Only for two sample tests.
</p>
</td></tr>
<tr><td><code>median.test</code></td>
<td>

<p>Testing the median?
</p>
</td></tr>
<tr><td><code>symmetric</code></td>
<td>

<p>Assuming symmetry? Only for one sample and paired tests.
</p>
</td></tr>
<tr><td><code>R</code></td>
<td>

<p>Number of resamples.
</p>
</td></tr>
<tr><td><code>exact</code></td>
<td>

<p>Exact permutation test? See Note.
</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>

<p>Estimate of parameter <code class="reqn">\mu</code>.
</p>
</td></tr>
<tr><td><code>univariate</code></td>
<td>

<p>Univariate test statistic value for <code class="reqn">j</code>-th variable (for multivariate input).
</p>
</td></tr>
<tr><td><code>adj.p.value</code></td>
<td>

<p>Adjusted p-value for testing significance of <code class="reqn">j</code>-th variable (for multivariate input).
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>Method used for permutation test. See Details.
</p>
</td></tr>
</table>


<h3>Multivariate Tests </h3>

<p>If the input <code>x</code> (and possibly <code>y</code>) is a matrix with <code class="reqn">m &gt; 1</code> columns, the multivariate test statistic is defined as 
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>alternative</code> </td><td style="text-align: left;"> <code>statistic</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>two.sided</code> </td><td style="text-align: left;"> <code>max(abs(univariate))</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>less</code> </td><td style="text-align: left;"> <code>min(univariate)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>greater</code> </td><td style="text-align: left;"> <code>max(univariate)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The global null hypothesis (across all <code class="reqn">m</code> variables) is tested by comparing the observed <code>statistic</code> to the permutation distribution <code>perm.dist</code>. This produces the <code>p.value</code> for testing the global null hypothesis.
</p>
<p>The local null hypothesis (separately for each variable) is tested by comparing the <code>univariate</code> test statistic to <code>perm.dist</code>. This produces the adjusted p-values (<code>adj.p.values</code>), which control the familywise Type I error rate across the <code class="reqn">m</code> tests.
</p>


<h3>Note</h3>

<p>For one sample (or paired) tests, the permutation test will be exact when the requested number of resamples <code>R</code> is greater than <code>2^n</code> minus one. In this case, the permutation distribution <code>perm.dist</code> contains all <code>2^n</code> possible values of the test statistic.
</p>
<p>For two sample tests, the permutation test will be exact when the requested number of resamples <code>R</code> is greater than <code>choose(N, n)</code> minus one, where <code>m = length(x)</code>, <code>n = length(y)</code>, and <code>N = m + n</code>. In this case, the permutation distribution <code>perm.dist</code> contains all <code>choose(N, n)</code> possible values of the test statistic.
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Blair, R. C., Higgins, J. J., Karniski, W., &amp; Kromrey, J. D. (1994). A study of multivariate permutation tests which may replace Hotelling's T2 test in prescribed circumstances. Multivariate Behavioral Research, 29(2), 141-163. doi: 10.1207/s15327906mbr2902_2
</p>
<p>Chung, E., &amp; Romano, J. P. (2016). Asymptotically valid and exact permutation tests based on two-sample U-statistics. Journal of Statistical Planning and Inference, 168, 97-105. doi: 10.1016/j.jspi.2015.07.004
</p>
<p>Fisher, R. A. (1925). Statistical methods for research workers. Edinburgh: Oliver and Boyd.
</p>
<p>Helwig, N. E. (2019). Statistical nonparametric mapping: Multivariate permutation tests for location, correlation, and regression problems in neuroimaging. WIREs Computational Statistics, 11(2), e1457. doi: 10.1002/wics.1457
</p>
<p>Janssen, A. (1997). Studentized permutation tests for non-i.i.d. hypotheses and the generalized Behrens-Fisher problem. Statistics &amp; Probability Letters , 36 (1), 9-21. doi: 10.1016/S0167-7152(97)00043-6
</p>
<p>Johnson, N. J. (1978). Modified t tests and confidence intervals for asymmetrical populations. Journal of the American Statistical Association, 73 (363), 536-544. doi: 10.2307/2286597
</p>
<p>Mann, H. B., &amp; Whitney, D. R. (1947). On a test of whether one of two random variables is stochastically larger than the other. Annals Of Mathematical Statistics, 18(1), 50-60. doi: 10.1214/aoms/1177730491
</p>
<p>Pitman, E. J. G. (1937a). Significance tests which may be applied to samples from any populations. Supplement to the Journal of the Royal Statistical Society, 4(1), 119-130. doi: 10.2307/2984124
</p>
<p>Romano, J. P. (1990). On the behavior of randomization tests without a group invariance assumption. Journal of the American Statistical Association, 85(411), 686-692. doi: 10.1080/01621459.1990.10474928
</p>
<p>Student. (1908). The probable error of a mean. Biometrika, 6(1), 1-25. doi: 10.2307/2331554
</p>
<p>Welch, B. L. (1938). The significance of the difference between two means when the population variances are unequal. Biometrika, 39(3/4), 350-362. doi: 10.2307/2332010
</p>
<p>Wilcoxon, F. (1945). Individual comparisons by ranking methods. Biometrics Bulletin, 1(6), 80-83. doi: 10.2307/3001968
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.np.loc.test">plot.np.loc.test</a></code> S3 plotting method for visualizing the results
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
######******######   UNIVARIATE   ######******######

###***###   ONE SAMPLE   ###***###

# generate data
set.seed(1)
n &lt;- 10
x &lt;- rnorm(n, mean = 0.5)

# one sample t-test
set.seed(0)
np.loc.test(x)

# Johnson t-test
set.seed(0)
np.loc.test(x, symmetric = FALSE)

# Wilcoxon signed rank test
set.seed(0)
np.loc.test(x, median.test = TRUE)

# Fisher sign test
set.seed(0)
np.loc.test(x, median.test = TRUE, symmetric = FALSE)


###***###   PAIRED SAMPLE   ###***###

# generate data
set.seed(1)
n &lt;- 10
x &lt;- rnorm(n, mean = 0.5)
y &lt;- rnorm(n)

# paired t-test
set.seed(0)
np.loc.test(x, y, paired = TRUE)

# paired Johnson t-test
set.seed(0)
np.loc.test(x, y, paired = TRUE, symmetric = FALSE)

# paired Wilcoxon signed rank test
set.seed(0)
np.loc.test(x, y, paired = TRUE, median.test = TRUE)

# paired Fisher sign test
set.seed(0)
np.loc.test(x, y, paired = TRUE, median.test = TRUE, symmetric = FALSE)


###***###   TWO SAMPLE   ###***###

# generate data
set.seed(1)
m &lt;- 7
n &lt;- 8
x &lt;- rnorm(m, mean = 0.5)
y &lt;- rnorm(n)

# Welch t-test
set.seed(0)
np.loc.test(x, y)

# Student t-test
set.seed(0)
np.loc.test(x, y, var.equal = TRUE)

# Studentized Wilcoxon test
set.seed(0)
np.loc.test(x, y, median.test = TRUE)

# Wilcoxon rank sum test
set.seed(0)
np.loc.test(x, y, var.equal = TRUE, median.test = TRUE)



## Not run: 

######******######   MULTIVARIATE   ######******######

###***###   ONE SAMPLE   ###***###

# generate data
set.seed(1)
n &lt;- 10
x &lt;- cbind(rnorm(n, mean = 0.5), 
           rnorm(n, mean = 1), 
           rnorm(n, mean = 1.5))

# multivariate one sample t-test
set.seed(0)
ptest &lt;- np.loc.test(x)
ptest
ptest$univariate
ptest$adj.p.values


###***###   PAIRED SAMPLE   ###***###

# generate data
set.seed(1)
n &lt;- 10
x &lt;- cbind(rnorm(n, mean = 0.5), 
           rnorm(n, mean = 1), 
           rnorm(n, mean = 1.5))
y &lt;- matrix(rnorm(n * 3), nrow = n, ncol = 3)

# multivariate paired t-test
set.seed(0)
ptest &lt;- np.loc.test(x, y, paired = TRUE)
ptest
ptest$univariate
ptest$adj.p.values


###***###   TWO SAMPLE   ###***###

# generate data
set.seed(1)
m &lt;- 7
n &lt;- 8
x &lt;- cbind(rnorm(m, mean = 0.5), 
           rnorm(m, mean = 1), 
           rnorm(m, mean = 1.5))
y &lt;- matrix(rnorm(n * 3), nrow = n, ncol = 3)

# multivariate Welch t-test
set.seed(0)
ptest &lt;- np.loc.test(x, y)
ptest
ptest$univariate
ptest$adj.p.values


## End(Not run)

</code></pre>

<hr>
<h2 id='np.reg.test'>
Nonparametric Tests of Regression Coefficients
</h2><span id='topic+np.reg.test'></span>

<h3>Description</h3>

<p>Assuming a linear model of the form 
</p>
<p style="text-align: center;"><code class="reqn">Y = \alpha + X \beta + \epsilon</code>
</p>

<p>or
</p>
<p style="text-align: center;"><code class="reqn">Y = \alpha + X \beta + Z \gamma + \epsilon</code>
</p>

<p>this function implements permutation tests of <code class="reqn">H_0: \beta = \beta_0</code> where <code class="reqn">\beta_0</code> is the user-specified null vector. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>np.reg.test(x, y, z = NULL, method = NULL,
            beta = NULL, homosced = FALSE, lambda = 0, 
            R = 9999, parallel = FALSE, cl = NULL,
            perm.dist = TRUE, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="np.reg.test_+3A_x">x</code></td>
<td>

<p>Matrix of predictor variables (<code>n</code> by <code>p</code>). 
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_y">y</code></td>
<td>

<p>Response vector or matrix (<code>n</code> by <code>m</code>).
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_z">z</code></td>
<td>

<p>Optional matrix of nuisance variables (<code>n</code> by <code>q</code>). 
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_method">method</code></td>
<td>

<p>Permutation method. See Details.
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_beta">beta</code></td>
<td>

<p>Null hypothesis value for <code class="reqn">\beta</code> (<code>p</code> by <code>m</code>). Defaults to matrix of zeros.
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_homosced">homosced</code></td>
<td>

<p>Are the <code class="reqn">\epsilon</code> terms homoscedastic? If <code>FALSE</code> (default), a robust Wald test statistic is used. Otherwise the classic <code class="reqn">F</code> test statistic is used.
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_lambda">lambda</code></td>
<td>

<p>Scalar or vector of ridge parameter(s). Defaults to vector of zeros.
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_r">R</code></td>
<td>

<p>Number of resamples for the permutation test (positive integer). 
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_parallel">parallel</code></td>
<td>

<p>Logical indicating if the <code><a href="lattice.html#topic+parallel">parallel</a></code> package should be used for parallel computing (of the permutation distribution). Defaults to <code>FALSE</code>, which implements sequential computing.
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_cl">cl</code></td>
<td>

<p>Cluster for parallel computing, which is used when <code>parallel = TRUE</code>. Note that if <code>parallel = TRUE</code> and <code>cl = NULL</code>, then the cluster is defined as <code>makeCluster(2L)</code> to use two cores. To make use of all available cores, use the code <code>cl = makeCluster(detectCores())</code>.
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_perm.dist">perm.dist</code></td>
<td>

<p>Logical indicating if the permutation distribution should be returned.  
</p>
</td></tr>
<tr><td><code id="np.reg.test_+3A_na.rm">na.rm</code></td>
<td>

<p>If <code>TRUE</code> (default), the arguments <code>x</code> and <code>y</code> (and <code>z</code> if provided) are passed to the <code><a href="stats.html#topic+na.omit">na.omit</a></code> function to remove cases with missing data.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With no nuisance variables in the model (i.e., <code>z = NULL</code>), there are three possible options for the <code>method</code> argument:
</p>

<table>
<tr>
 <td style="text-align: left;">
Method </td><td style="text-align: left;"> Model </td>
</tr>
<tr>
 <td style="text-align: left;">
perm </td><td style="text-align: left;"> <code class="reqn">P Y = \alpha + X \beta + \epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
flip </td><td style="text-align: left;"> <code class="reqn">S Y = \alpha + X \beta + \epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
both </td><td style="text-align: left;"> <code class="reqn">P S Y = \alpha + X \beta + \epsilon</code>
</td>
</tr>

</table>

<p>where <code class="reqn">P</code> is a permutation matrix and <code class="reqn">S</code> is a sign-flipping matrix.
</p>
<p>With nuisance variables in the model, there are eight possible options for the <code>method</code> argument:
</p>

<table>
<tr>
 <td style="text-align: left;">
Method </td><td style="text-align: left;"> Name </td><td style="text-align: left;"> Model </td>
</tr>
<tr>
 <td style="text-align: left;">
HJ </td><td style="text-align: left;"> Huh-Jhun </td><td style="text-align: left;"> <code class="reqn">P Q' R_z Y = \alpha + Q' R_z X \beta + \epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
KC </td><td style="text-align: left;"> Kennedy-Cade </td><td style="text-align: left;"> <code class="reqn">P R_z Y = \alpha + R_z X \beta + \epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
SW </td><td style="text-align: left;"> Still-White </td><td style="text-align: left;"> <code class="reqn">P R_z Y = \alpha + X \beta + \epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
TB </td><td style="text-align: left;"> ter Braak </td><td style="text-align: left;"> <code class="reqn">(P R_m + H_m) Y = \alpha + X \beta + Z \gamma + \epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
FL </td><td style="text-align: left;"> Freedman-Lane </td><td style="text-align: left;"> <code class="reqn">(P R_z + H_z) Y = \alpha + X \beta + Z \gamma + \epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
MA </td><td style="text-align: left;"> Manly </td><td style="text-align: left;"> <code class="reqn">P Y = \alpha + X \beta + Z \gamma + \epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
OS </td><td style="text-align: left;"> O'Gorman-Smith </td><td style="text-align: left;"> <code class="reqn">Y = \alpha + P R_z X \beta + Z \gamma + \epsilon</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
DS </td><td style="text-align: left;"> Draper-Stoneman </td><td style="text-align: left;"> <code class="reqn">Y = \alpha + P X \beta + Z \gamma + \epsilon</code> 
</td>
</tr>

</table>

<p>where <code class="reqn">P</code> is permutation matrix and <code class="reqn">Q</code> is defined as <code class="reqn">R_z = Q Q'</code> with <code class="reqn">Q'Q = I</code>. 
</p>
<p>Note that <code class="reqn">H_z</code> is the hat matrix for the nuisance variable design matrix, and <code class="reqn">R_z = I - H_z</code> is the corresponding residual forming matrix. Similarly, <code class="reqn">H_m</code> and <code class="reqn">R_m</code> are the hat and residual forming matrices for the full model including the predictor and nuisance variables.
</p>


<h3>Value</h3>

<table>
<tr><td><code>statistic</code></td>
<td>

<p>Test statistic value.
</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>

<p>p-value for testing <code class="reqn">H_0: \beta = \beta_0</code>.
</p>
</td></tr>
<tr><td><code>perm.dist</code></td>
<td>

<p>Permutation distribution of <code>statistic</code>.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>

<p>Permutation method.
</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>

<p>Null hypothesis value for <code class="reqn">\beta</code>.
</p>
</td></tr>
<tr><td><code>homosced</code></td>
<td>

<p>Homoscedastic errors?
</p>
</td></tr>
<tr><td><code>R</code></td>
<td>

<p>Number of resamples.
</p>
</td></tr>
<tr><td><code>exact</code></td>
<td>

<p>Exact permutation test? See Note.
</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>

<p>Least squares estimates of <code class="reqn">\alpha</code>, <code class="reqn">\beta</code>, and <code class="reqn">\gamma</code> (if applicable).
</p>
</td></tr>
<tr><td><code>univariate</code></td>
<td>

<p>Univariate test statistic value for <code class="reqn">j</code>-th variable (for multivariate inputs).
</p>
</td></tr>
<tr><td><code>adj.p.value</code></td>
<td>

<p>Adjusted p-value for testing significance of <code class="reqn">j</code>-th variable (for multivariate inputs).
</p>
</td></tr>
</table>


<h3>Multivariate Tests </h3>

<p>If the input <code>y</code> is a matrix with <code class="reqn">m &gt; 1</code> columns, the multivariate test statistic is defined as <code>statistic = max(univariate)</code> given that the <code>univariate</code> test statistics are non-negative. 
</p>
<p>The global null hypothesis (across all <code class="reqn">m</code> variables) is tested by comparing the observed <code>statistic</code> to the permutation distribution <code>perm.dist</code>. This produces the <code>p.value</code> for testing the global null hypothesis.
</p>
<p>The local null hypothesis (separately for each variable) is tested by comparing the <code>univariate</code> test statistic to <code>perm.dist</code>. This produces the adjusted p-values (<code>adj.p.values</code>), which control the familywise Type I error rate across the <code class="reqn">m</code> tests.
</p>


<h3>Note</h3>

<p>If <code>method = "flip"</code>, the permutation test will be exact when the requested number of resamples <code>R</code> is greater than <code>2^n</code> minus one. In this case, the permutation distribution <code>perm.dist</code> contains all <code>2^n</code> possible values of the test statistic.
</p>
<p>If <code>method = "both"</code>, the permutation test will be exact when the requested number of resamples <code>R</code> is greater than <code>factorial(n) * (2^n)</code> minus one. In this case, the permutation distribution <code>perm.dist</code> contains all <code>factorial(n) * (2^n)</code> possible values of the test statistic.
</p>
<p>If <code>method = "HJ"</code>, the permutation test will be exact when the requested number of resamples <code>R</code> is greater than <code>factorial(n-q-1)</code> minus one. In this case, the permutation distribution <code>perm.dist</code> contains all <code>factorial(n-q-1)</code> possible values of the test statistic.
</p>
<p>Otherwise the permutation test will be exact when the requested number of resamples <code>R</code> is greater than <code>factorial(n)</code> minus one. In this case, the permutation distribution <code>perm.dist</code> contains all <code>factorial(n)</code> possible values of the test statistic. 
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>DiCiccio, C. J., &amp; Romano, J. P. (2017). Robust permutation tests for correlation and regression coefficients. Journal of the American Statistical Association, 112(519), 1211-1220. doi: 10.1080/01621459.2016.1202117
</p>
<p>Draper, N. R., &amp; Stoneman, D. M. (1966). Testing for the inclusion of variables in linear regression by a randomisation technique. Technometrics, 8(4), 695-699. doi: 10.2307/1266641
</p>
<p>Freedman, D., &amp; Lane, D. (1983). A nonstochastic interpretation of reported significance levels. Journal of Business and Economic Statistics, 1(4), 292-298. doi: 10.2307/1391660
</p>
<p>Helwig, N. E. (2019a). Statistical nonparametric mapping: Multivariate permutation tests for location, correlation, and regression problems in neuroimaging. WIREs Computational Statistics, 11(2), e1457. doi: 10.1002/wics.1457
</p>
<p>Helwig, N. E. (2019b). Robust nonparametric tests of general linear model coefficients: A comparison of permutation methods and test statistics. NeuroImage, 201, 116030. doi: 10.1016/j.neuroimage.2019.116030
</p>
<p>Huh, M.-H., &amp; Jhun, M. (2001). Random permutation testing in multiple linear regression. Communications in Statistics - Theory and Methods, 30(10), 2023-2032. doi: 10.1081/STA-100106060
</p>
<p>Kennedy, P. E., &amp; Cade, B. S. (1996). Randomization tests for multiple regression. Communications in Statistics - Simulation and Computation, 25(4), 923-936. doi: 10.1080/03610919608813350
</p>
<p>Manly, B. (1986). Randomization and regression methods for testing for associations with geographical, environmental and biological distances between populations. Researches on Population Ecology, 28(2), 201-218. doi: 10.1007/BF02515450
</p>
<p>Nichols, T. E., Ridgway, G. R., Webster, M. G., &amp; Smith, S. M. (2008). GLM permutation: nonparametric inference for arbitrary general linear models. NeuroImage, 41(S1), S72.
</p>
<p>O'Gorman, T. W. (2005). The performance of randomization tests that use permutations of independent variables. Communications in Statistics - Simulation and Computation, 34(4), 895-908. doi: 10.1080/03610910500308230
</p>
<p>Still, A. W., &amp; White, A. P. (1981). The approximate randomization test as an alternative to the F test in analysis of variance. British Journal of Mathematical and Statistical Psychology, 34(2), 243-252. doi: 10.1111/j.2044-8317.1981.tb00634.x
</p>
<p>ter Braak, C. J. F. (1992). Permutation versus bootstrap significance tests in multiple regression and ANOVA. In K. H. J\&quot;ockel, G. Rothe, &amp; W. Sendler (Eds.), Bootstrapping and related techniques. lecture notes in economics and mathematical systems, vol 376 (pp. 79-86). Springer.
</p>
<p>White, H. (1980). A heteroscedasticity-consistent covariance matrix and a direct test for heteroscedasticity. Econometrica, 48(4), 817-838. doi: 10.2307/1912934
</p>
<p>Winkler, A. M., Ridgway, G. R., Webster, M. A., Smith, S. M., &amp; Nichols, T. E. (2014). Permutation inference for the general linear model. NeuroImage, 92, 381-397. doi: 10.1016/j.neuroimage.2014.01.060
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.np.reg.test">plot.np.reg.test</a></code> S3 plotting method for visualizing the results
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
######******######   UNIVARIATE   ######******######

###***###   TEST ALL COEFFICIENTS   ###***###

# generate data
set.seed(1)
n &lt;- 10
x &lt;- cbind(rnorm(n), rnorm(n))
y &lt;- rnorm(n)

# Wald test (method = "perm")
set.seed(0)
np.reg.test(x, y)

# F test (method = "perm")
set.seed(0)
np.reg.test(x, y, homosced = TRUE)


###***###   TEST SUBSET OF COEFFICIENTS   ###***###

# generate data
set.seed(1)
n &lt;- 10
x &lt;- rnorm(n)
z &lt;- rnorm(n)
y &lt;- 3 + 2 * z + rnorm(n)

# Wald test (method = "HJ")
set.seed(0)
np.reg.test(x, y, z)

# F test (method = "HJ")
set.seed(0)
np.reg.test(x, y, z, homosced = TRUE)


## Not run: 

######******######   MULTIVARIATE   ######******######

###***###   TEST ALL COEFFICIENTS   ###***###

# generate data
set.seed(1)
n &lt;- 10
x &lt;- cbind(rnorm(n), rnorm(n))
y &lt;- matrix(rnorm(n * 3), nrow = n, ncol = 3)

# multivariate Wald test (method = "perm")
set.seed(0)
np.reg.test(x, y)

# multivariate F test (method = "perm")
set.seed(0)
np.reg.test(x, y, homosced = TRUE)


###***###   TEST SUBSET OF COEFFICIENTS   ###***###

# generate data
set.seed(1)
n &lt;- 10
x &lt;- rnorm(n)
z &lt;- rnorm(n)
y &lt;- cbind(1 + 3 * z + rnorm(n),
           2 + 2 * z + rnorm(n),
           3 + 1 * z + rnorm(n))
           
# multivariate Wald test (method = "HJ")
set.seed(0)
np.reg.test(x, y, z)

# multivariate F test (method = "HJ")
set.seed(0)
np.reg.test(x, y, z, homosced = TRUE)


## End(Not run)

</code></pre>

<hr>
<h2 id='nptest-internal'>
Internal 'nptest' Functions
</h2><span id='topic+psdinv'></span><span id='topic+print.mcse'></span><span id='topic+print.np.boot'></span><span id='topic+print.np.cor.test'></span><span id='topic+print.np.loc.test'></span><span id='topic+print.np.reg.test'></span><span id='topic+rand.test.cor'></span><span id='topic+rand.test.lm1'></span><span id='topic+rand.test.lm2'></span><span id='topic+rand.test.one'></span><span id='topic+rand.test.two'></span><span id='topic+Tstat.cor'></span><span id='topic+Tstat.lm1'></span><span id='topic+Tstat.lm2'></span><span id='topic+Tstat.one'></span><span id='topic+Tstat.two'></span><span id='topic+Tstat.lm1.mv'></span><span id='topic+Tstat.lm2.mv'></span><span id='topic+Tstat.one.mv'></span><span id='topic+Tstat.two.mv'></span><span id='topic+Tperm.cor'></span><span id='topic+Tperm.lm1'></span><span id='topic+Tperm.lm2'></span><span id='topic+Tperm.one'></span><span id='topic+Tperm.two'></span><span id='topic+Tperm.lm1.mv'></span><span id='topic+Tperm.lm2.mv'></span><span id='topic+Tperm.one.mv'></span><span id='topic+Tperm.two.mv'></span>

<h3>Description</h3>

<p>Internal functions for 'nptest' package.
</p>


<h3>Details</h3>

<p>These functions are not to be called by the user.
</p>

<hr>
<h2 id='permn'>
Generate All Permutations of n Elements
</h2><span id='topic+permn'></span>

<h3>Description</h3>

<p>Generates all <code class="reqn">n!</code> vectors of length <code class="reqn">n</code> consisting of permutations of the integers 1 to <code class="reqn">n</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permn(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permn_+3A_n">n</code></td>
<td>

<p>Number of elements.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adapted from the &quot;permutations&quot; function in the <a href="https://CRAN.R-project.org/package=e1071">e1071</a> R package.
</p>


<h3>Value</h3>

<p>Matrix of dimension <code class="reqn">n</code> by <code class="reqn">n!</code> where each column contains a unique permutation vector.
</p>


<h3>Warning </h3>

<p>For large <code>n</code> this function will consume a lot of memory and may even crash R.
</p>


<h3>Note</h3>

<p>Used for exact tests in <code><a href="#topic+np.cor.test">np.cor.test</a></code> and <code><a href="#topic+np.reg.test">np.reg.test</a></code>.
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Meyer, D., Dimitriadou, E., Hornik, K., Weingessel, A., &amp; Leisch, F. (2018). e1071: Misc Functions of the Department of Statistics, Probability Theory Group (Formerly: E1071), TU Wien. R package version 1.7-0. https://CRAN.R-project.org/package=e1071
</p>


<h3>Examples</h3>

<pre><code class='language-R'>permn(2)
permn(3)
</code></pre>

<hr>
<h2 id='plot'>
Plots Permutation Distribution for Nonparametric Tests
</h2><span id='topic+plot'></span><span id='topic+plot.np.cor.test'></span><span id='topic+plot.np.loc.test'></span><span id='topic+plot.np.reg.test'></span>

<h3>Description</h3>

<p><code>plot</code> methods for object classes &quot;np.cor.test&quot;, &quot;np.loc.test&quot;, and &quot;np.reg.test&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'np.cor.test'
plot(x, alpha = 0.05, col = "grey", col.rr = "red",
     col.stat = "black", lty.stat = 2, lwd.stat = 2, 
     xlab = "Test Statistic", main = "Permutation Distribution", 
     breaks = "scott", border = NA, box = TRUE, ...)
           
## S3 method for class 'np.loc.test'
plot(x, alpha = 0.05, col = "grey", col.rr = "red",
     col.stat = "black", lty.stat = 2, lwd.stat = 2, 
     xlab = "Test Statistic", main = "Permutation Distribution", 
     breaks = "scott", border = NA, box = TRUE, ...)
           
## S3 method for class 'np.reg.test'
plot(x, alpha = 0.05, col = "grey", col.rr = "red",
     col.stat = "black", lty.stat = 2, lwd.stat = 2, 
     xlab = "Test Statistic", main = "Permutation Distribution", 
     breaks = "scott", border = NA, box = TRUE, SQRT = TRUE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>

<p>an object of class &quot;np.cor.test&quot; output by the <code><a href="#topic+np.cor.test">np.cor.test</a></code> function, &quot;np.loc.test&quot; output by the <code><a href="#topic+np.loc.test">np.loc.test</a></code> function, or &quot;np.reg.test&quot; output by the <code><a href="#topic+np.reg.test">np.reg.test</a></code> function
</p>
</td></tr>
<tr><td><code id="plot_+3A_alpha">alpha</code></td>
<td>

<p>significance level of the nonparametric test
</p>
</td></tr>
<tr><td><code id="plot_+3A_col">col</code></td>
<td>

<p>color for plotting the non-rejection region
</p>
</td></tr>
<tr><td><code id="plot_+3A_col.rr">col.rr</code></td>
<td>

<p>color for plotting the rejection region
</p>
</td></tr>
<tr><td><code id="plot_+3A_col.stat">col.stat</code></td>
<td>

<p>color for plotting the observed test statistic
</p>
</td></tr>
<tr><td><code id="plot_+3A_lty.stat">lty.stat</code></td>
<td>

<p>line type for plotting the observed test statistic
</p>
</td></tr>
<tr><td><code id="plot_+3A_lwd.stat">lwd.stat</code></td>
<td>

<p>line width for plotting the observed test statistic
</p>
</td></tr>
<tr><td><code id="plot_+3A_xlab">xlab</code></td>
<td>

<p>x-axis label for the plot
</p>
</td></tr>
<tr><td><code id="plot_+3A_main">main</code></td>
<td>

<p>title for the plot
</p>
</td></tr>
<tr><td><code id="plot_+3A_breaks">breaks</code></td>
<td>

<p>defines the breaks of the histogram (see <code><a href="graphics.html#topic+hist">hist</a></code>)
</p>
</td></tr>
<tr><td><code id="plot_+3A_border">border</code></td>
<td>

<p>color of the border around the bars
</p>
</td></tr>
<tr><td><code id="plot_+3A_box">box</code></td>
<td>

<p>should a box be drawn around the plot?
</p>
</td></tr>
<tr><td><code id="plot_+3A_sqrt">SQRT</code></td>
<td>

<p>for regression tests, should the permutation distribution (and test statistic) be plotted on the square-root scale?
</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to <code><a href="graphics.html#topic+hist">hist</a></code>  
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots a histogram of the permutation distribution and the observed test statistic. The argument 'alpha' controls the rejection region of the nonparametric test, which is plotted using a separate color (default is red).
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Helwig, N. E. (2019). Statistical nonparametric mapping: Multivariate permutation tests for location, correlation, and regression problems in neuroimaging. WIREs Computational Statistics, 11(2), e1457. doi: 10.1002/wics.1457
</p>


<h3>See Also</h3>

<p><code><a href="#topic+np.cor.test">np.cor.test</a></code> for information on nonparametric correlation tests
</p>
<p><code><a href="#topic+np.loc.test">np.loc.test</a></code> for information on nonparametric location tests
</p>
<p><code><a href="#topic+np.reg.test">np.reg.test</a></code> for information on nonparametric regression tests
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
######******######   np.cor.test   ######******######

# generate data
rho &lt;- 0.5
val &lt;- c(sqrt(1 + rho), sqrt(1 - rho))
corsqrt &lt;- matrix(c(val[1], -val[2], val), 2, 2) / sqrt(2)
set.seed(1)
n &lt;- 50
z &lt;- cbind(rnorm(n), rnorm(n)) %*% corsqrt
x &lt;- z[,1]
y &lt;- z[,2]

# test H0: rho = 0
set.seed(0)
test &lt;- np.cor.test(x, y)

# plot results
plot(test)


######******######   np.loc.test   ######******######

# generate data
set.seed(1)
n &lt;- 50
x &lt;- rnorm(n, mean = 0.5)

# one sample t-test
set.seed(0)
test &lt;- np.loc.test(x)

# plot results
plot(test)


######******######   np.reg.test   ######******######

# generate data
set.seed(1)
n &lt;- 50
x &lt;- cbind(rnorm(n), rnorm(n))
beta &lt;- c(0.25, 0.5)
y &lt;- x %*% beta + rnorm(n)

# Wald test (method = "perm")
set.seed(0)
test &lt;- np.reg.test(x, y)

# plot results
plot(test)

</code></pre>

<hr>
<h2 id='StartupMessage'>Startup Message for nptest</h2><span id='topic+StartupMessage'></span><span id='topic+nptestStartupMessage'></span>

<h3>Description</h3>

<p>Prints the startup message when nptest is loaded. Not intended to be called by the user.
</p>


<h3>Details</h3>

<p>The &lsquo;nptest&rsquo; ascii start-up message was created using the taag software.
</p>


<h3>References</h3>

<p>https://patorjk.com/software/taag/
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
