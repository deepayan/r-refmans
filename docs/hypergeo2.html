<!DOCTYPE html><html lang="en"><head><title>Help for package hypergeo2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hypergeo2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hypergeo2-package'><p>hypergeo2: Generalized Hypergeometric Function with Tunable High Precision</p></a></li>
<li><a href='#genhypergeo'><p>Generalized hypergeometric function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Generalized Hypergeometric Function with Tunable High Precision</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Computation of generalized hypergeometric function with tunable high precision in a vectorized manner, with the floating-point datatypes from 'mpfr' or 'gmp' library. The computation is limited to real numbers.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, hypergeo, microbenchmark, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH, Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/zhuxr11/hypergeo2">https://github.com/zhuxr11/hypergeo2</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/zhuxr11/hypergeo2/issues">https://github.com/zhuxr11/hypergeo2/issues</a></td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>gmp, mpfr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-14 15:42:13 UTC; Admin</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiurui Zhu [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiurui Zhu &lt;zxr6@163.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-14 16:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='hypergeo2-package'>hypergeo2: Generalized Hypergeometric Function with Tunable High Precision</h2><span id='topic+hypergeo2'></span><span id='topic+hypergeo2-package'></span>

<h3>Description</h3>

<p>Computation of generalized hypergeometric function with tunable high precision in a vectorized manner, with the floating-point datatypes from 'mpfr' or 'gmp' library. The computation is limited to real numbers.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Xiurui Zhu <a href="mailto:zxr6@163.com">zxr6@163.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/zhuxr11/hypergeo2">https://github.com/zhuxr11/hypergeo2</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/zhuxr11/hypergeo2/issues">https://github.com/zhuxr11/hypergeo2/issues</a>
</p>
</li></ul>


<hr>
<h2 id='genhypergeo'>Generalized hypergeometric function</h2><span id='topic+genhypergeo'></span>

<h3>Description</h3>

<p><code>genhypergeo</code> computes generalized hypergeometric function with vectorized input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genhypergeo(
  U,
  L,
  z,
  prec = NULL,
  check_mode = TRUE,
  log = FALSE,
  backend = c("mpfr", "gmp")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genhypergeo_+3A_u">U</code>, <code id="genhypergeo_+3A_l">L</code></td>
<td>
<p>List of numeric vectors for upper and lower values.</p>
</td></tr>
<tr><td><code id="genhypergeo_+3A_z">z</code></td>
<td>
<p>Numeric vector as common ratios.</p>
</td></tr>
<tr><td><code id="genhypergeo_+3A_prec">prec</code></td>
<td>
<p>List of <code>NULL</code> or (unsigned) integers as precision level during computation,
a.k.a the number of precise digits of floating-point datatypes.
This argument is vectorized: you may use different precision settings for different input elements.
If <code>NULL</code>, double precision (default) is used.</p>
</td></tr>
<tr><td><code id="genhypergeo_+3A_check_mode">check_mode</code></td>
<td>
<p>Logical vector indicating whether the mode of <code>x</code>
should be checked for obvious convergence failures.
This argument is vectorized: you may use different check modes for different input elements.</p>
</td></tr>
<tr><td><code id="genhypergeo_+3A_log">log</code></td>
<td>
<p>Logical (1L) indicating whether result is given as log(result).
This argument is <strong>NOT</strong> vectorized: only its first element is used.</p>
</td></tr>
<tr><td><code id="genhypergeo_+3A_backend">backend</code></td>
<td>
<p>One of the following: 'mpfr' (default) or 'gmp', for the realization of
floating-point datatype of tunable precision. This argument is <strong>NOT</strong> vectorized:
you may only input character (1L).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes, computing generalized hypergeometric function in double precision is not sufficient,
even though we only need 6-8 accurate digits in the results (see example). Here, two floating-point
datatypes are provided: <code>mpfr_float</code> ('mpfr') and <code>gmp_float</code> ('gmp'). By comparison,
the 'mpfr' backend is safer, since it defines <code>Inf</code> while the 'gmp' backend throws overflow
exception (see references). But the 'gmp' backend results in more accurate results at the same precision,
since it usually uses higher precision than set (see reference and validate it on yourself with the examples).
</p>
<p><code>genhypergeo</code> is available in <code><a href="Rcpp.html#topic+Rcpp-package">Rcpp</a></code>
as <code>hypergeo2::genhypergeo_vec()</code>; its non-vectorized version is named
in <code><a href="Rcpp.html#topic+Rcpp-package">Rcpp</a></code> as <code>hypergeo2::genhypergeo_cpp()</code>.
</p>
<p>Its non-vectorized version is available in
<code><a href="Rcpp.html#topic+Rcpp-package">Rcpp</a></code> as <code>hypergeo2::genhypergeo_&lt;int SXP, typename T1, typename T2&gt;()</code>,
where <code>SXP</code> is the type of <code>Rcpp::Vector</code>, <code>T1</code> is the input/output datatype
and <code>T2</code> is the datatype used in computation (see references for example datatypes).
</p>
<p>To use them, please use <code>[[Rcpp::depends(hypergeo2)]]</code> and <code>#include &lt;hypergeo2.h&gt;</code>
in your C++ source files, and add <code>@importFrom hypergeo2 genhypergeo</code>
to <code>R/*-package.R</code> file, just like <code><a href="Rcpp.html#topic+Rcpp-package">Rcpp</a></code>.
</p>


<h3>Value</h3>

<p>Numeric vector as the results of computation (at <code>double</code> precision).
Warnings are issued if failing to converge.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>References</h3>

<p>For the floating-point datatypes of tunable precision:
</p>

<ul>
<li><p> Documentation about <a href="https://www.boost.org/doc/libs/master/libs/multiprecision/doc/html/boost_multiprecision/tut/floats/mpfr_float.html"><code>mpfr_float</code></a>,
with datatype <code>boost::multiprecision::number&lt;boost::multiprecision::backends::mpfr_float_backend&lt;0&gt;&gt;</code>
</p>
</li>
<li><p> Documentation about <a href="https://www.boost.org/doc/libs/master/libs/multiprecision/doc/html/boost_multiprecision/tut/floats/gmp_float.html"><code>gmp_float</code></a>,
with datatype <code>boost::multiprecision::number&lt;boost::multiprecision::backends::gmp_float&lt;0&gt;&gt;</code>
</p>
</li>
<li><p> Documentation about <a href="https://www.mpfr.org/faq.html#:~:text=What%20are%20the%20differences%20between%20MPF%20from%20GMP,minimum%20value%20%28MPF%20generally%20uses%20a%20higher%20precision%29">higher precision of <code>gmp_float</code> datatype</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>U &lt;- c(-28.2, 11.8, 15.8)
L &lt;- c(12.8, 17.8)
z &lt;- 1
# hypergeo results
if (length(find.package("hypergeo", quiet = TRUE)) &gt; 0L) {
  hypergeo::genhypergeo(U = U, L = L, z = z)
}
# Default (double) precision: this may result in cancellation error on some platforms
tryCatch(
  genhypergeo(U = U, L = L, z = z),
  error = function(err) {
    if (grepl("Cancellation is so severe that no bits in the result are correct",
              conditionMessage(err)) == TRUE) {
      message("! Cancellation error on your platform: ",
              "you may need a higher [prec] than double ([prec = NULL]): ",
              conditionMessage(err))
    } else {
      stop(err)
    }
  }
)
# Precision of 20 digits, default ('mpfr') backend
genhypergeo(U = U, L = L, z = z, prec = 20L)
# Precision of 20 digits, 'gmp' backend
genhypergeo(U = U, L = L, z = z, prec = 20L, backend = "gmp")
# Precision of 25 digits, default ('mpfr') backend
genhypergeo(U = U, L = L, z = z, prec = 25L)
# Precision of 25 digits, 'gmp' backend
genhypergeo(U = U, L = L, z = z, prec = 25L, backend = "gmp")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
