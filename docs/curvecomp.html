<!DOCTYPE html><html><head><title>Help for package curvecomp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {curvecomp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#param.boot'><p>Parameteric Bootstrap Multiple Curve Comparisons for Independent Groups</p></a></li>
<li><a href='#param.boot.rm'><p>Parameteric Bootstrap Multiple Curve Comparisons for Repeated Measures</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiple Curve Comparisons Using Parametric Bootstrap</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Kimihiro Noguchi &lt;kimihiro.noguchi@wwu.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christopher Murphy &lt;cmurphy0313@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs multiple comparison procedures on curve observations among different treatment groups. The methods are applicable in a variety of situations (such as independent groups with equal or unequal sample sizes, or repeated measures) by using parametric bootstrap. References to these procedures can be found at Konietschke, Gel, and Brunner (2014) &lt;<a href="https://doi.org/10.1090%2Fconm%2F622%2F12431">doi:10.1090/conm/622/12431</a>&gt; and Westfall (2011) &lt;<a href="https://doi.org/10.1080%2F10543406.2011.607751">doi:10.1080/10543406.2011.607751</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>multcomp (&ge; 0.4-8.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-09-19 04:23:46 UTC; Chris</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-09-19 08:25:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='param.boot'>Parameteric Bootstrap Multiple Curve Comparisons for Independent Groups</h2><span id='topic+param.boot'></span>

<h3>Description</h3>

<p>Resampling-based multiple comparisons of adjusted p-values for curve observations with independent groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>param.boot(data, group, nboot = 1000, type, Cmat = NULL,
  comparison.names = NULL, option = "p", plot.results = TRUE,
  conf.level = 0.95, xlab = "", adj = 1.5, rounds = 3, start = 0.05,
  end = 0.8, alphas = c(0.01, 0.05, 0.1), fix.seed = FALSE,
  description = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="param.boot_+3A_data">data</code></td>
<td>
<p>A matrix specifying data. Each row in the data represents all observations from a specific subject. The number of rows in the data must be the same as the length of the group vector.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_group">group</code></td>
<td>
<p>A vector specifying which treatment group each subject belongs to. Must have the same length as the number of rows in data.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_nboot">nboot</code></td>
<td>
<p>An integer specifying the number of bootstraps. The default option is 1000.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_type">type</code></td>
<td>
<p>A character string specifying the contrast matrix type corresponding to the ones in <code>contrMat()</code> in the multcomp package.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_cmat">Cmat</code></td>
<td>
<p>A matrix specifying the contrast matrix. Useful if it is none of the ones in <code>contrMat()</code>. Either &lsquo;type&rsquo; or &lsquo;Cmat&rsquo; must be specified. The default option is NULL.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_comparison.names">comparison.names</code></td>
<td>
<p>A character vector supplying names for the comparisons implied in the contrast matrix.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_option">option</code></td>
<td>
<p>A character specifying whether MinP or MaxT should be used for the adjusted p-value calculation. &quot;p&quot; for MinP and &quot;t&quot; for MaxT.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_plot.results">plot.results</code></td>
<td>
<p>A boolean specifying whether or not the visuals for the results should be created. The default option is TRUE. All the visuals (simultaneous confidence bands, adjusted p-values, and effect size plots) will be saved in the current directory.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_conf.level">conf.level</code></td>
<td>
<p>A numeric that specifies the confidence level of the simultaneous confidence bands. It is one minus the familywise error rate. The default option is 0.95.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_xlab">xlab</code></td>
<td>
<p>A character string specifying the name to be used for the x-axis label of the plots. The default option is the empty character string.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_adj">adj</code></td>
<td>
<p>A numeric specifying the adjustment factor for the plots. By increasing the number, more white spaces will be created in the plots. The default option is 1.5.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_rounds">rounds</code></td>
<td>
<p>An integer specifying the number of decimal places to be used. The default option is 3.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_start">start</code></td>
<td>
<p>A numeric specifying the greyscale to be used for the plot of the simultaneous confidence bands. The value must be greater than zero and less than the value specified for 'end'. The default option is 0.05.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_end">end</code></td>
<td>
<p>A numeric specifying the greyscale to be used for the plot of the simultaneous confidence bands. The value must be greater than the value specified for 'start' and less than one. The default option is 0.8.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_alphas">alphas</code></td>
<td>
<p>A numeric vector specifying the FWER cut-off values to be displayed in the plot of the adjusted p-values. The default option is c(0.01,0.05,0.10).</p>
</td></tr>
<tr><td><code id="param.boot_+3A_fix.seed">fix.seed</code></td>
<td>
<p>A boolean specifying whether or not the seed for the random number generation should be set. This option is useful from the reproducibility point of view. The default option is FALSE.</p>
</td></tr>
<tr><td><code id="param.boot_+3A_description">description</code></td>
<td>
<p>A character string specifying the experiment. The default option is the empty character string.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>p.value.all</code></td>
<td>
<p>A matrix specifying all the adjusted p-values for each comparison at each time point. Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
<tr><td><code>p.value.comps</code></td>
<td>
<p>A numeric vector specifying all the adjusted p-values for each comparison. This is the same as the minimum adjusted p-values from each row in <code>p.value.all</code>.</p>
</td></tr>
<tr><td><code>p.value.overall</code></td>
<td>
<p>A numeric specifying the adjusted p-value for the overall conclusion. This is the same as the minimum adjusted p-value in <code>p.value.comps</code>.</p>
</td></tr>
<tr><td><code>test.statistic.all</code></td>
<td>
<p>A matrix specifying all the t-test statistics for each comparison at each time point. Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
<tr><td><code>test.statistic.comps</code></td>
<td>
<p>A numeric vector specifying all the test statistics for each comparison. This is the same as the maximum test statistics from each row in <code>test.statistic.all</code>.</p>
</td></tr>
<tr><td><code>test.statistic.overall</code></td>
<td>
<p>A numeric specifying the adjusted p-value for the overall conclusion. This is the same as the maximum test statistic in <code>test.statistic.comps</code>.</p>
</td></tr>
<tr><td><code>mean.diff.mat</code></td>
<td>
<p>A matrix specifying all the mean differences for each comparison at each time point. Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
<tr><td><code>upper.diff.mat</code></td>
<td>
<p>A matrix specifying all the upper bounds of the simultaneous confidence intervals for the mean differences for each comparison at each time point. Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
<tr><td><code>lower.diff.mat</code></td>
<td>
<p>A matrix specifying all the lower bounds of the simultaneous confidence intervals for the mean differences for each comparison at each time point. Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
<tr><td><code>es.mat</code></td>
<td>
<p>A matrix specifying all the effect sizes for each comparison at each time point. <code>es.mat</code> is the mean difference divided by the pooled standard deviation (Cohen's d). Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> #Example with 12 subjects and 3 treatments groups (n1=3, n2=4, n3=5) 
 #having 300 observations per subject.
 #nboot&gt;=1000 is strongly recommended but we use nboot=5 here
 #to cut back on run time.
 nboot&lt;-5
 group&lt;-c(rep(1,3),rep(2,4),rep(3,5))
 group.size&lt;-as.vector(table(group))
 n&lt;-length(group)
 k&lt;-length(group.size)
 m&lt;-360
 range&lt;-c(31:330)
 means&lt;-c(0,0,0)
 sds&lt;-c(0.01,0.015,0.02)

 smoother&lt;-function(data, spar=0.95)
 {
   return(smooth.spline(x=data, spar=spar)$y)
 }

 data&lt;-c()

 set.seed(1)
 for(i in 1:k)
 {
   group.num&lt;-group.size[i]
   mean&lt;-means[i]
   sd&lt;-sds[i]
   datamat&lt;-matrix(rnorm((group.num*m),mean,sd),ncol=m)
   smoothdata&lt;-t(apply(datamat,1,smoother))
   data&lt;-rbind(data,smoothdata[,range])
 }

 #Visualizing the data having three treatment groups
 plot(data[1,]~c(1:300),type='n',main="Simulated Data",
      ylim=c(min(data),max(data)),xlab="Observation",ylab="Data")
 for(j in 1:n)
 {
   lines(data[j,]~c(1:300),col=group[j])
 }

 #Running the test
 #May take a little while to run.
 testresults&lt;-param.boot(data=data,group=group,nboot=nboot,type="Tukey",
 fix.seed=TRUE,description=" (test_ind)")
 testresults


</code></pre>

<hr>
<h2 id='param.boot.rm'>Parameteric Bootstrap Multiple Curve Comparisons for Repeated Measures</h2><span id='topic+param.boot.rm'></span>

<h3>Description</h3>

<p>Resampling-based multiple comparisons of adjusted p-values for curve observations with repeated measures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>param.boot.rm(data, treatment, nboot = 1000, type, Cmat = NULL,
  comparison.names = NULL, plot.results = TRUE, conf.level = 0.95,
  xlab = "", adj = 1.5, rounds = 3, start = 0.05, end = 0.8,
  alphas = c(0.01, 0.05, 0.1), fix.seed = FALSE, description = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="param.boot.rm_+3A_data">data</code></td>
<td>
<p>A matrix specifying data. Each row in the data represents all observations from a specific subject. It is assumed that the same number of observations are stored for each time point.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_treatment">treatment</code></td>
<td>
<p>An integer specifying the number of treatments used for the dataset. <code>treatment</code> gives the number of time points (treatments) used for the dataset.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_nboot">nboot</code></td>
<td>
<p>An integer specifying the number of bootstraps. The default option is 1000. Note that, depending on the number of bootstraps, it may take a little while to compute the results.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_type">type</code></td>
<td>
<p>A character string specifying the contrast matrix type corresponding to the ones in <code>contrMat()</code> in the multcomp package.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_cmat">Cmat</code></td>
<td>
<p>A matrix specifying the contrast matrix. Useful if it is none of the ones in <code>contrMat()</code>. Either &lsquo;type&rsquo; or &lsquo;Cmat&rsquo; must be specified. The default option is NULL.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_comparison.names">comparison.names</code></td>
<td>
<p>A character vector supplying names for the comparisons implied in the contrast matrix. The default option is NULL, in which case, they are automatically generated.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_plot.results">plot.results</code></td>
<td>
<p>A boolean specifying whether or not the visuals for the results should be created. The default option is TRUE. All the visuals (simultaneous confidence bands, adjusted p-values, and effect size plots) will be saved in the current directory.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_conf.level">conf.level</code></td>
<td>
<p>A numeric that specifies the confidence level of the simultaneous confidence bands. It is one minus the familywise error rate. The default option is 0.95.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_xlab">xlab</code></td>
<td>
<p>A character string specifying the name to be used for the x-axis label of the plots. The default option is the empty character string.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_adj">adj</code></td>
<td>
<p>A numeric specifying the adjustment factor for the plots. By increasing the number, more white spaces will be created in the plots. The default option is 1.5.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_rounds">rounds</code></td>
<td>
<p>An integer specifying the number of decimal places to be used. The default option is 3.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_start">start</code></td>
<td>
<p>A numeric specifying the greyscale to be used for the plot of the simultaneous confidence bands. The value must be greater than zero and less than the value specified for 'end'. The default option is 0.05.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_end">end</code></td>
<td>
<p>A numeric specifying the greyscale to be used for the plot of the simultaneous confidence bands. The value must be greater than the value specified for 'start' and less than one. The default option is 0.8.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_alphas">alphas</code></td>
<td>
<p>A numeric vector specifying the FWER cut-off values to be displayed in the plot of the adjusted p-values. The default option is c(0.01,0.05,0.10).</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_fix.seed">fix.seed</code></td>
<td>
<p>A boolean specifying whether or not the seed for the random number generation should be set. This option is useful from the reproducibility point of view. The default option is FALSE.</p>
</td></tr>
<tr><td><code id="param.boot.rm_+3A_description">description</code></td>
<td>
<p>A character string specifying the experiment. The default option is the empty character string.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>p.value.all</code></td>
<td>
<p>A matrix specifying all the adjusted p-values for each comparison at each time point. Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
<tr><td><code>p.value.comps</code></td>
<td>
<p>A numeric vector specifying all the adjusted p-values for each comparison. This is the same as the minimum adjusted p-values from each row in <code>p.value.all</code>.</p>
</td></tr>
<tr><td><code>p.value.overall</code></td>
<td>
<p>A numeric specifying the adjusted p-value for the overall conclusion. This is the same as the minimum adjusted p-value in <code>p.value.comps</code>.</p>
</td></tr>
<tr><td><code>test.statistic.all</code></td>
<td>
<p>A matrix specifying all the t-test statistics for each comparison at each time point. Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
<tr><td><code>test.statistic.comps</code></td>
<td>
<p>A numeric vector specifying all the test statistics for each comparison. This is the same as the maximum test statistics from each row in <code>test.statistic.all</code>.</p>
</td></tr>
<tr><td><code>test.statistic.overall</code></td>
<td>
<p>A numeric specifying the adjusted p-value for the overall conclusion. This is the same as the maximum test statistic in <code>test.statistic.comps</code>.</p>
</td></tr>
<tr><td><code>mean.diff.mat</code></td>
<td>
<p>A matrix specifying all the mean differences for each comparison at each time point. Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
<tr><td><code>upper.diff.mat</code></td>
<td>
<p>A matrix specifying all the upper bounds of the simultaneous confidence intervals for the mean differences for each comparison at each time point. Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
<tr><td><code>lower.diff.mat</code></td>
<td>
<p>A matrix specifying all the lower bounds of the simultaneous confidence intervals for the mean differences for each comparison at each time point. Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
<tr><td><code>es.mat</code></td>
<td>
<p>A matrix specifying all the effect sizes for each comparison at each time point. <code>es.mat</code> is simply <code>test.statistic.all</code> divided by the square root of the number of subjects (analogous to Cohen's d). Each row corresponds to each comparison, and each column corresponds to each time point.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> ### Example with 10 subjects and 3 treatments having 100 observations per treatment.
 #nboot&gt;=1000 is strongly recommended but we use nboot=5 here
 #to cut back on run time.
 nboot&lt;-5
 n&lt;-10
 treatment&lt;-3
 m&lt;-120
 range&lt;-c(11:110)
 means&lt;-c(0,0.003,0.006)
 sds&lt;-c(0.01,0.015,0.02)

 smoother&lt;-function(data, spar=0.95)
 {
   return(smooth.spline(x=data, spar=spar)$y)
 }

 data&lt;-c()

 set.seed(1)
 for(i in 1:treatment)
 {
   mean&lt;-means[i]
   sd&lt;-sds[i]
   datamat&lt;-matrix(rnorm((n*m),mean,sd),ncol=m)
   smoothdata&lt;-t(apply(datamat,1,smoother))
   data&lt;-cbind(data,smoothdata[,range])
 }

 #Visualizing the data having three treatments
 plot(data[1,]~c(1:300),type='n',main="Simulated Data",
      ylim=c(min(data),max(data)),xlab="Observation",ylab="Data")
 for(j in 1:n)
 {
   lines(data[j,c(1:100)]~c(1:100),col=j)
   lines(data[j,c(101:200)]~c(101:200),col=j)
   lines(data[j,c(201:300)]~c(201:300),col=j)
 }
 abline(v=100,lty=2)
 abline(v=200,lty=2)

 #Running the test
 #May take a little while to run.

 testresults&lt;-param.boot.rm(data=data,treatment=treatment,nboot=nboot,
 type="Tukey",fix.seed=TRUE,description=" (test_rm)")
 testresults


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
