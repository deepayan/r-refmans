<!DOCTYPE html><html><head><title>Help for package natural</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {natural}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#getLam_olasso'><p>Get the two (theoretical) values of lambdas used in the organic lasso</p></a></li>
<li><a href='#getLam_slasso'><p>Get the two (theoretical) values of lambdas used in scaled lasso</p></a></li>
<li><a href='#make_sparse_model'><p>Generate sparse linear model and random samples</p></a></li>
<li><a href='#natural'><p>natural: Natural and Organic lasso estimates of error variance in high-dimensional linear models</p></a></li>
<li><a href='#nlasso_cv'><p>Cross-validation for natural lasso</p></a></li>
<li><a href='#nlasso_path'><p>Fit a linear model with natural lasso</p></a></li>
<li><a href='#olasso'><p>Error standard deviation estimation using organic lasso</p></a></li>
<li><a href='#olasso_cv'><p>Cross-validation for organic lasso</p></a></li>
<li><a href='#olasso_path'><p>Fit a linear model with organic lasso</p></a></li>
<li><a href='#olasso_slow'><p>Solve organic lasso problem with a single value of lambda</p>
The lambda values are for slow rates, which could give less satisfying results</a></li>
<li><a href='#plot.natural.cv'><p>plot a natural.cv object</p></a></li>
<li><a href='#plot.natural.path'><p>plot a natural.path object</p></a></li>
<li><a href='#print.natural.path'><p>print a natural.path object</p></a></li>
<li><a href='#standardize'><p>Standardize the n -by- p design matrix X to have</p>
column means zero and ||X_j||_2^2 = n for all j</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating the Error Variance in a High-Dimensional Linear Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guo Yu &lt;gy63@cornell.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the two error variance estimation methods in high-dimensional linear models of Yu, Bien (2017) &lt;<a href="https://arxiv.org/abs/1712.02412">arXiv:1712.02412</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://arxiv.org/abs/1712.02412">https://arxiv.org/abs/1712.02412</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hugogogo/natural/issues">https://github.com/hugogogo/natural/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, glmnet</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-01-16 01:32:01 UTC; hugo</td>
</tr>
<tr>
<td>Author:</td>
<td>Guo Yu [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-01-16 10:35:43 UTC</td>
</tr>
</table>
<hr>
<h2 id='getLam_olasso'>Get the two (theoretical) values of lambdas used in the organic lasso</h2><span id='topic+getLam_olasso'></span>

<h3>Description</h3>

<p>Get the two (theoretical) values of lambdas used in the organic lasso
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLam_olasso(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLam_olasso_+3A_x">x</code></td>
<td>
<p>design matrix</p>
</td></tr>
</table>

<hr>
<h2 id='getLam_slasso'>Get the two (theoretical) values of lambdas used in scaled lasso</h2><span id='topic+getLam_slasso'></span>

<h3>Description</h3>

<p>Get the two (theoretical) values of lambdas used in scaled lasso
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLam_slasso(n, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLam_slasso_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="getLam_slasso_+3A_p">p</code></td>
<td>
<p>number of features</p>
</td></tr>
</table>

<hr>
<h2 id='make_sparse_model'>Generate sparse linear model and random samples</h2><span id='topic+make_sparse_model'></span>

<h3>Description</h3>

<p>Generate design matrix and response following linear models
<code class="reqn">y = X \beta + \epsilon</code>, where
<code class="reqn">\epsilon ~ N(0, \sigma^2)</code>, and <code class="reqn">X ~ N(0, \Sigma)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_sparse_model(n, p, alpha, rho, snr, nsim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_sparse_model_+3A_n">n</code></td>
<td>
<p>the sample size</p>
</td></tr>
<tr><td><code id="make_sparse_model_+3A_p">p</code></td>
<td>
<p>the number of features</p>
</td></tr>
<tr><td><code id="make_sparse_model_+3A_alpha">alpha</code></td>
<td>
<p>sparsity, i.e., <code class="reqn">n^\alpha</code> nonzeros in the true regression coefficient.</p>
</td></tr>
<tr><td><code id="make_sparse_model_+3A_rho">rho</code></td>
<td>
<p>pairwise correlation among features</p>
</td></tr>
<tr><td><code id="make_sparse_model_+3A_snr">snr</code></td>
<td>
<p>signal to noise ratio, defined as <code class="reqn">\beta^T \Sigma \beta / \sigma^2</code></p>
</td></tr>
<tr><td><code id="make_sparse_model_+3A_nsim">nsim</code></td>
<td>
<p>the number of simulations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object containing: </p>

<dl>
<dt><code>x</code>: </dt><dd><p>The <code>n</code> by <code>p</code> design matrix</p>
</dd>
<dt><code>y</code>: </dt><dd><p>The <code>n</code> by <code>nsim</code> matrix of response vector, each column representing one replication of the simulation</p>
</dd>
<dt><code>beta</code>: </dt><dd><p>The true regression coefficient vector</p>
</dd>
<dt><code>sigma</code>: </dt><dd><p>The true error standard deviation</p>
</dd></dl>


<hr>
<h2 id='natural'>natural: Natural and Organic lasso estimates of error variance in high-dimensional linear models</h2><span id='topic+natural'></span><span id='topic+natural-package'></span>

<h3>Description</h3>

<p>The package contains implementation of the two methods introduced in Yu, Bien (2017) <a href="https://arxiv.org/abs/1712.02412">https://arxiv.org/abs/1712.02412</a>.
</p>


<h3>Details</h3>

<p>The main functions are <code><a href="#topic+nlasso_cv">nlasso_cv</a></code>, <code><a href="#topic+olasso_cv">olasso_cv</a></code>, and <code><a href="#topic+olasso">olasso</a></code>.
</p>

<hr>
<h2 id='nlasso_cv'>Cross-validation for natural lasso</h2><span id='topic+nlasso_cv'></span>

<h3>Description</h3>

<p>Provide natural lasso estimate (of the error standard deviation) using cross-validation to select the tuning parameter value
The output also includes the cross-validation result of the naive estimate and the degree of freedom adjusted estimate of the error standard deviation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlasso_cv(x, y, lambda = NULL, intercept = TRUE, nlam = 100,
  flmin = 0.01, nfold = 5, foldid = NULL, thresh = 1e-08,
  glmnet_output = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlasso_cv_+3A_x">x</code></td>
<td>
<p>An <code>n</code> by <code>p</code> design matrix. Each row is an observation of <code>p</code> features.</p>
</td></tr>
<tr><td><code id="nlasso_cv_+3A_y">y</code></td>
<td>
<p>A response vector of size <code>n</code>.</p>
</td></tr>
<tr><td><code id="nlasso_cv_+3A_lambda">lambda</code></td>
<td>
<p>A user specified list of tuning parameter. Default to be NULL, and the program will compute its own <code>lambda</code> path based on <code>nlam</code> and <code>flmin</code>.</p>
</td></tr>
<tr><td><code id="nlasso_cv_+3A_intercept">intercept</code></td>
<td>
<p>Indicator of whether intercept should be fitted. Default to be <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="nlasso_cv_+3A_nlam">nlam</code></td>
<td>
<p>The number of <code>lambda</code> values. Default value is <code>100</code>.</p>
</td></tr>
<tr><td><code id="nlasso_cv_+3A_flmin">flmin</code></td>
<td>
<p>The ratio of the smallest and the largest values in <code>lambda</code>. The largest value in <code>lambda</code> is usually the smallest value for which all coefficients are set to zero. Default to be <code>1e-2</code>.</p>
</td></tr>
<tr><td><code id="nlasso_cv_+3A_nfold">nfold</code></td>
<td>
<p>Number of folds in cross-validation. Default value is 5. If each fold gets too view observation, a warning is thrown and the minimal <code>nfold = 3</code> is used.</p>
</td></tr>
<tr><td><code id="nlasso_cv_+3A_foldid">foldid</code></td>
<td>
<p>A vector of length <code>n</code> representing which fold each observation belongs to. Default to be <code>NULL</code>, and the program will generate its own randomly.</p>
</td></tr>
<tr><td><code id="nlasso_cv_+3A_thresh">thresh</code></td>
<td>
<p>Threshold value for underlying optimization algorithm to claim convergence. Default to be <code>1e-8</code>.</p>
</td></tr>
<tr><td><code id="nlasso_cv_+3A_glmnet_output">glmnet_output</code></td>
<td>
<p>Should the estimate be computed using a user-specified output from <code>cv.glmnet</code>. If not <code>NULL</code>, it should be the output from <code>cv.glmnet</code> call with <code>standardize = TRUE</code> and <code>keep = TRUE</code>, and then the arguments <code>lambda</code>, <code>intercept</code>, <code>nlam</code>, <code>flmin</code>, <code>nfold</code>, <code>foldid</code>, and <code>thresh</code>  will be ignored. Default to be <code>NULL</code>, in which case the function will call <code>cv.glmnet</code> internally.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object containing: </p>

<dl>
<dt><code>n</code> and <code>p</code>: </dt><dd><p>The dimension of the problem.</p>
</dd>
<dt><code>lambda</code>: </dt><dd><p>The path of tuning parameter used.</p>
</dd>
<dt><code>beta</code>: </dt><dd><p>Estimate of the regression coefficients, in the original scale, corresponding to the tuning parameter selected by cross-validation.</p>
</dd>
<dt><code>a0</code>: </dt><dd><p>Estimate of intercept</p>
</dd>
<dt><code>mat_mse</code>: </dt><dd><p>The estimated prediction error on the test sets in cross-validation. A matrix of size <code>nlam</code> by <code>nfold</code>. If <code>glmnet_output</code> is not <code>NULL</code>, then <code>mat_mse</code> will be NULL.</p>
</dd>
<dt><code>cvm</code>: </dt><dd><p>The averaged estimated prediction error on the test sets over K folds.</p>
</dd>
<dt><code>cvse</code>: </dt><dd><p>The standard error of the estimated prediction error on the test sets over K folds.</p>
</dd>
<dt><code>ibest</code>: </dt><dd><p>The index in <code>lambda</code> that attains the minimal mean cross-validated error.</p>
</dd>
<dt><code>foldid</code>: </dt><dd><p>Fold assignment. A vector of length <code>n</code>.</p>
</dd>
<dt><code>nfold</code>: </dt><dd><p>The number of folds used in cross-validation.</p>
</dd>
<dt><code>sig_obj</code>: </dt><dd><p>Natural lasso estimate of standard deviation of the error, with the optimal tuning parameter selected by cross-validation.</p>
</dd>
<dt><code>sig_obj_path</code>: </dt><dd><p>Natural lasso estimates of standard deviation of the error. A vector of length <code>nlam</code>.</p>
</dd>
<dt><code>sig_naive</code>: </dt><dd><p>Naive estimates of the error standard deviation based on lasso regression, i.e., <code class="reqn">||y - X \hat{\beta}||_2 / \sqrt n</code>, selected by cross-validation.</p>
</dd>
<dt><code>sig_naive_path</code>: </dt><dd><p>Naive estimate of standard deviation of the error based on lasso regression. A vector of length <code>nlam</code>.</p>
</dd>
<dt><code>sig_df</code>: </dt><dd><p>Degree-of-freedom adjusted estimate of standard deviation of the error, selected by cross-validation. See Reid, et, al (2016).</p>
</dd>
<dt><code>sig_df_path</code>: </dt><dd><p>Degree-of-freedom adjusted estimate of standard deviation of the error. A vector of length <code>nlam</code>.</p>
</dd>
<dt><code>type</code>: </dt><dd><p>whether the output is of a natural or an organic lasso.</p>
</dd></dl>



<h3>See Also</h3>

<p><code><a href="#topic+nlasso_path">nlasso_path</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
sim &lt;- make_sparse_model(n = 50, p = 200, alpha = 0.6, rho = 0.6, snr = 2, nsim = 1)
nl_cv &lt;- nlasso_cv(x = sim$x, y = sim$y[, 1])
</code></pre>

<hr>
<h2 id='nlasso_path'>Fit a linear model with natural lasso</h2><span id='topic+nlasso_path'></span>

<h3>Description</h3>

<p>Calculate a solution path of the natural lasso estimate (of error standard deviation) with a list of tuning parameter values. In particular, this function solves the lasso problems and returns the lasso objective function values as estimates of the error variance:
<code class="reqn">\hat{\sigma}^2_{\lambda} = \min_{\beta} ||y - X \beta||_2^2 / n + 2 \lambda ||\beta||_1.</code>
The output also includes a path of naive estimates and a path of degree of freedom adjusted estimates of the error standard deviation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlasso_path(x, y, lambda = NULL, nlam = 100, flmin = 0.01,
  thresh = 1e-08, intercept = TRUE, glmnet_output = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlasso_path_+3A_x">x</code></td>
<td>
<p>An <code>n</code> by <code>p</code> design matrix. Each row is an observation of <code>p</code> features.</p>
</td></tr>
<tr><td><code id="nlasso_path_+3A_y">y</code></td>
<td>
<p>A response vector of size <code>n</code>.</p>
</td></tr>
<tr><td><code id="nlasso_path_+3A_lambda">lambda</code></td>
<td>
<p>A user specified list of tuning parameter. Default to be NULL, and the program will compute its own <code>lambda</code> path based on <code>nlam</code> and <code>flmin</code>.</p>
</td></tr>
<tr><td><code id="nlasso_path_+3A_nlam">nlam</code></td>
<td>
<p>The number of <code>lambda</code> values. Default value is <code>100</code>.</p>
</td></tr>
<tr><td><code id="nlasso_path_+3A_flmin">flmin</code></td>
<td>
<p>The ratio of the smallest and the largest values in <code>lambda</code>. The largest value in <code>lambda</code> is usually the smallest value for which all coefficients are set to zero. Default to be <code>1e-2</code>.</p>
</td></tr>
<tr><td><code id="nlasso_path_+3A_thresh">thresh</code></td>
<td>
<p>Threshold value for the underlying optimization algorithm to claim convergence. Default to be <code>1e-8</code>.</p>
</td></tr>
<tr><td><code id="nlasso_path_+3A_intercept">intercept</code></td>
<td>
<p>Indicator of whether intercept should be fitted. Default to be <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="nlasso_path_+3A_glmnet_output">glmnet_output</code></td>
<td>
<p>Should the estimate be computed using a user-specified output from <code>glmnet</code>. If not <code>NULL</code>, it should be the output from <code>glmnet</code> call with <code>standardize = TRUE</code>, and then the arguments <code>lambda</code>, <code>nlam</code>, <code>flmin</code>, <code>thresh</code>, and <code>intercept</code> will be ignored. Default to be <code>NULL</code>, in which case the function will call <code>glmnet</code> internally.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object containing: </p>

<dl>
<dt><code>n</code> and <code>p</code>: </dt><dd><p>The dimension of the problem.</p>
</dd>
<dt><code>lambda</code>: </dt><dd><p>The path of tuning parameters used.</p>
</dd>
<dt><code>beta</code>: </dt><dd><p>Matrix of estimates of the regression coefficients, in the original scale. The matrix is of size <code>p</code> by <code>nlam</code>. The <code>j</code>-th column represents the estimate of coefficient corresponding to the <code>j</code>-th tuning parameter in <code>lambda</code>.</p>
</dd>
<dt><code>a0</code>: </dt><dd><p>Estimate of intercept. A vector of length <code>nlam</code>.</p>
</dd>
<dt><code>sig_obj_path</code>: </dt><dd><p>Natural lasso estimates of the error standard deviation. A vector of length <code>nlam</code>.</p>
</dd>
<dt><code>sig_naive_path</code>: </dt><dd><p>Naive estimates of the error standard deviation based on lasso regression, i.e., <code class="reqn">||y - X \hat{\beta}||_2 / \sqrt n</code>. A vector of length <code>nlam</code>.</p>
</dd>
<dt><code>sig_df_path</code>: </dt><dd><p>Degree-of-freedom adjusted estimate of standard deviation of the error. A vector of length <code>nlam</code>. See Reid, et, al (2016).</p>
</dd>
<dt><code>type</code>: </dt><dd><p>whether the output is of a natural or an organic lasso.</p>
</dd></dl>



<h3>See Also</h3>

<p><code><a href="#topic+nlasso_cv">nlasso_cv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
sim &lt;- make_sparse_model(n = 50, p = 200, alpha = 0.6, rho = 0.6, snr = 2, nsim = 1)
nl_path &lt;- nlasso_path(x = sim$x, y = sim$y[, 1])
</code></pre>

<hr>
<h2 id='olasso'>Error standard deviation estimation using organic lasso</h2><span id='topic+olasso'></span>

<h3>Description</h3>

<p>Solve the organic lasso problem
<code class="reqn">\tilde{\sigma}^2_{\lambda} = \min_{\beta} ||y - X \beta||_2^2 / n + 2 \lambda ||\beta||_1^2</code>
with two pre-specified values of tuning parameter:
<code class="reqn">\lambda_1 = log p / n</code>, and <code class="reqn">\lambda_2</code>, which is a Monte-Carlo estimate of <code class="reqn">||X^T e||_\infty^2 / n^2</code>, where <code class="reqn">e</code> is n-dimensional standard normal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>olasso(x, y, intercept = TRUE, thresh = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="olasso_+3A_x">x</code></td>
<td>
<p>An <code>n</code> by <code>p</code> design matrix. Each row is an observation of <code>p</code> features.</p>
</td></tr>
<tr><td><code id="olasso_+3A_y">y</code></td>
<td>
<p>A response vector of size <code>n</code>.</p>
</td></tr>
<tr><td><code id="olasso_+3A_intercept">intercept</code></td>
<td>
<p>Indicator of whether intercept should be fitted. Default to be <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="olasso_+3A_thresh">thresh</code></td>
<td>
<p>Threshold value for underlying optimization algorithm to claim convergence. Default to be <code>1e-8</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object containing: </p>

<dl>
<dt><code>n</code> and <code>p</code>: </dt><dd><p>The dimension of the problem.</p>
</dd>
<dt><code>lam_1</code>, <code>lam_2</code>: </dt><dd><p><code class="reqn">log(p) / n</code>, and an Monte-Carlo estimate of <code class="reqn">||X^T e||_\infty^2 / n^2</code>, where <code class="reqn">e</code> is n-dimensional standard normal.</p>
</dd>
<dt><code>a0_1</code>, <code>a0_2</code>: </dt><dd><p>Estimate of intercept, corresponding to <code>lam_1</code> and <code>lam_2</code>.</p>
</dd>
<dt><code>beta_1</code>, <code>beta_2</code>: </dt><dd><p>Organic lasso estimate of regression coefficients, corresponding to <code>lam_1</code> and <code>lam_2</code>.</p>
</dd>
<dt><code>sig_obj_1</code>, <code>sig_obj_2</code>: </dt><dd><p>Organic lasso estimate of the error standard deviation, corresponding to <code>lam_1</code> and <code>lam_2</code>.</p>
</dd></dl>



<h3>See Also</h3>

<p><code><a href="#topic+olasso_path">olasso_path</a>, <a href="#topic+olasso_cv">olasso_cv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
sim &lt;- make_sparse_model(n = 50, p = 200, alpha = 0.6, rho = 0.6, snr = 2, nsim = 1)
ol &lt;- olasso(x = sim$x, y = sim$y[, 1])
</code></pre>

<hr>
<h2 id='olasso_cv'>Cross-validation for organic lasso</h2><span id='topic+olasso_cv'></span>

<h3>Description</h3>

<p>Provide organic lasso estimate (of the error standard deviation) using cross-validation to select the tuning parameter value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>olasso_cv(x, y, lambda = NULL, intercept = TRUE, nlam = 100,
  flmin = 0.01, nfold = 5, foldid = NULL, thresh = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="olasso_cv_+3A_x">x</code></td>
<td>
<p>An <code>n</code> by <code>p</code> design matrix. Each row is an observation of <code>p</code> features.</p>
</td></tr>
<tr><td><code id="olasso_cv_+3A_y">y</code></td>
<td>
<p>A response vector of size <code>n</code>.</p>
</td></tr>
<tr><td><code id="olasso_cv_+3A_lambda">lambda</code></td>
<td>
<p>A user specified list of tuning parameter. Default to be NULL, and the program will compute its own <code>lambda</code> path based on <code>nlam</code> and <code>flmin</code>.</p>
</td></tr>
<tr><td><code id="olasso_cv_+3A_intercept">intercept</code></td>
<td>
<p>Indicator of whether intercept should be fitted. Default to be <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="olasso_cv_+3A_nlam">nlam</code></td>
<td>
<p>The number of <code>lambda</code> values. Default value is <code>100</code>.</p>
</td></tr>
<tr><td><code id="olasso_cv_+3A_flmin">flmin</code></td>
<td>
<p>The ratio of the smallest and the largest values in <code>lambda</code>. The largest value in <code>lambda</code> is usually the smallest value for which all coefficients are set to zero. Default to be <code>1e-2</code>.</p>
</td></tr>
<tr><td><code id="olasso_cv_+3A_nfold">nfold</code></td>
<td>
<p>Number of folds in cross-validation. Default value is 5. If each fold gets too view observation, a warning is thrown and the minimal <code>nfold = 3</code> is used.</p>
</td></tr>
<tr><td><code id="olasso_cv_+3A_foldid">foldid</code></td>
<td>
<p>A vector of length <code>n</code> representing which fold each observation belongs to. Default to be <code>NULL</code>, and the program will generate its own randomly.</p>
</td></tr>
<tr><td><code id="olasso_cv_+3A_thresh">thresh</code></td>
<td>
<p>Threshold value for underlying optimization algorithm to claim convergence. Default to be <code>1e-8</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object containing: </p>

<dl>
<dt><code>n</code> and <code>p</code>: </dt><dd><p>The dimension of the problem.</p>
</dd>
<dt><code>lambda</code>: </dt><dd><p>The path of tuning parameter used.</p>
</dd>
<dt><code>beta</code>: </dt><dd><p>Estimate of the regression coefficients, in the original scale, corresponding to the tuning parameter selected by cross-validation.</p>
</dd>
<dt><code>a0</code>: </dt><dd><p>Estimate of intercept</p>
</dd>
<dt><code>mat_mse</code>: </dt><dd><p>The estimated prediction error on the test sets in cross-validation. A matrix of size <code>nlam</code> by <code>nfold</code></p>
</dd>
<dt><code>cvm</code>: </dt><dd><p>The averaged estimated prediction error on the test sets over K folds.</p>
</dd>
<dt><code>cvse</code>: </dt><dd><p>The standard error of the estimated prediction error on the test sets over K folds.</p>
</dd>
<dt><code>ibest</code>: </dt><dd><p>The index in <code>lambda</code> that attains the minimal mean cross-validated error.</p>
</dd>
<dt><code>foldid</code>: </dt><dd><p>Fold assignment. A vector of length <code>n</code>.</p>
</dd>
<dt><code>nfold</code>: </dt><dd><p>The number of folds used in cross-validation.</p>
</dd>
<dt><code>sig_obj</code>: </dt><dd><p>Organic lasso estimate of the error standard deviation, selected by cross-validation.</p>
</dd>
<dt><code>sig_obj_path</code>: </dt><dd><p>Organic lasso estimates of the error standard deviation. A vector of length <code>nlam</code>.</p>
</dd>
<dt><code>type</code>: </dt><dd><p>whether the output is of a natural or an organic lasso.</p>
</dd></dl>



<h3>See Also</h3>

<p><code><a href="#topic+olasso_path">olasso_path</a>, <a href="#topic+olasso">olasso</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
sim &lt;- make_sparse_model(n = 50, p = 200, alpha = 0.6, rho = 0.6, snr = 2, nsim = 1)
ol_cv &lt;- olasso_cv(x = sim$x, y = sim$y[, 1])
</code></pre>

<hr>
<h2 id='olasso_path'>Fit a linear model with organic lasso</h2><span id='topic+olasso_path'></span>

<h3>Description</h3>

<p>Calculate a solution path of the organic lasso estimate (of error standard deviation) with a list of tuning parameter values. In particular, this function solves the squared-lasso problems and returns the objective function values as estimates of the error variance:
<code class="reqn">\tilde{\sigma}^2_{\lambda} = \min_{\beta} ||y - X \beta||_2^2 / n + 2 \lambda ||\beta||_1^2.</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>olasso_path(x, y, lambda = NULL, nlam = 100, flmin = 0.01,
  thresh = 1e-08, intercept = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="olasso_path_+3A_x">x</code></td>
<td>
<p>An <code>n</code> by <code>p</code> design matrix. Each row is an observation of <code>p</code> features.</p>
</td></tr>
<tr><td><code id="olasso_path_+3A_y">y</code></td>
<td>
<p>A response vector of size <code>n</code>.</p>
</td></tr>
<tr><td><code id="olasso_path_+3A_lambda">lambda</code></td>
<td>
<p>A user specified list of tuning parameter. Default to be NULL, and the program will compute its own <code>lambda</code> path based on <code>nlam</code> and <code>flmin</code>.</p>
</td></tr>
<tr><td><code id="olasso_path_+3A_nlam">nlam</code></td>
<td>
<p>The number of <code>lambda</code> values. Default value is <code>100</code>.</p>
</td></tr>
<tr><td><code id="olasso_path_+3A_flmin">flmin</code></td>
<td>
<p>The ratio of the smallest and the largest values in <code>lambda</code>. The largest value in <code>lambda</code> is usually the smallest value for which all coefficients are set to zero. Default to be <code>1e-2</code>.</p>
</td></tr>
<tr><td><code id="olasso_path_+3A_thresh">thresh</code></td>
<td>
<p>Threshold value for underlying optimization algorithm to claim convergence. Default to be <code>1e-8</code>.</p>
</td></tr>
<tr><td><code id="olasso_path_+3A_intercept">intercept</code></td>
<td>
<p>Indicator of whether intercept should be fitted. Default to be <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This package also includes the outputs of the naive and the degree-of-freedom adjusted estimates, in analogy to <code><a href="#topic+nlasso_path">nlasso_path</a></code>.
</p>


<h3>Value</h3>

<p>A list object containing: </p>

<dl>
<dt><code>n</code> and <code>p</code>: </dt><dd><p>The dimension of the problem.</p>
</dd>
<dt><code>lambda</code>: </dt><dd><p>The path of tuning parameter used.</p>
</dd>
<dt><code>a0</code>: </dt><dd><p>Estimate of intercept. A vector of length <code>nlam</code>.</p>
</dd>
<dt><code>beta</code>: </dt><dd><p>Matrix of estimates of the regression coefficients, in the original scale. The matrix is of size <code>p</code> by <code>nlam</code>. The <code>j</code>-th column represents the estimate of coefficient corresponding to the <code>j</code>-th tuning parameter in <code>lambda</code>.</p>
</dd>
<dt><code>sig_obj_path</code>: </dt><dd><p>Organic lasso estimates of the error standard deviation. A vector of length <code>nlam</code>.</p>
</dd>
<dt><code>sig_naive</code>: </dt><dd><p>Naive estimate of the error standard deviation based on the squared-lasso regression. A vector of length <code>nlam</code>.</p>
</dd>
<dt><code>sig_df</code>: </dt><dd><p>Degree-of-freedom adjusted estimate of the error standard deviation, based on the squared-lasso regression. A vector of length <code>nlam</code>. </p>
</dd>
<dt><code>type</code>: </dt><dd><p>whether the output is of a natural or an organic lasso.</p>
</dd></dl>



<h3>See Also</h3>

<p><code><a href="#topic+olasso">olasso</a>, <a href="#topic+olasso_cv">olasso_cv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
sim &lt;- make_sparse_model(n = 50, p = 200, alpha = 0.6, rho = 0.6, snr = 2, nsim = 1)
ol_path &lt;- olasso_path(x = sim$x, y = sim$y[, 1])

</code></pre>

<hr>
<h2 id='olasso_slow'>Solve organic lasso problem with a single value of lambda
The lambda values are for slow rates, which could give less satisfying results</h2><span id='topic+olasso_slow'></span>

<h3>Description</h3>

<p>Solve organic lasso problem with a single value of lambda
The lambda values are for slow rates, which could give less satisfying results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>olasso_slow(x, y, thresh = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="olasso_slow_+3A_x">x</code></td>
<td>
<p>An <code>n</code> by <code>p</code> design matrix. Each row is an observation of <code>p</code> features.</p>
</td></tr>
<tr><td><code id="olasso_slow_+3A_y">y</code></td>
<td>
<p>A response vector of size <code>n</code>.</p>
</td></tr>
<tr><td><code id="olasso_slow_+3A_thresh">thresh</code></td>
<td>
<p>Threshold value for underlying optimization algorithm to claim convergence. Default to be <code>1e-8</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.natural.cv'>plot a natural.cv object</h2><span id='topic+plot.natural.cv'></span>

<h3>Description</h3>

<p>This function is adapted from the <span class="pkg">ggb</span> R package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'natural.cv'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.natural.cv_+3A_x">x</code></td>
<td>
<p>an object of class <code>natural.cv</code>, as returned by
<code><a href="#topic+nlasso_cv">nlasso_cv</a></code> and <code><a href="#topic+olasso_cv">olasso_cv</a></code></p>
</td></tr>
<tr><td><code id="plot.natural.cv_+3A_...">...</code></td>
<td>
<p>additional argument(not used here, only for S3 generic/method consistency)</p>
</td></tr>
</table>

<hr>
<h2 id='plot.natural.path'>plot a natural.path object</h2><span id='topic+plot.natural.path'></span>

<h3>Description</h3>

<p>This function is adapted from the <span class="pkg">ggb</span> R package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'natural.path'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.natural.path_+3A_x">x</code></td>
<td>
<p>an object of class <code>natural.path</code>, as returned by
<code><a href="#topic+nlasso_path">nlasso_path</a></code> and <code><a href="#topic+olasso_path">olasso_path</a></code></p>
</td></tr>
<tr><td><code id="plot.natural.path_+3A_...">...</code></td>
<td>
<p>additional argument(not used here, only for S3 generic/method consistency)</p>
</td></tr>
</table>

<hr>
<h2 id='print.natural.path'>print a natural.path object</h2><span id='topic+print.natural.path'></span>

<h3>Description</h3>

<p>This function is adapted from the <span class="pkg">ggb</span> R package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'natural.path'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.natural.path_+3A_x">x</code></td>
<td>
<p>an object of class <code>natural.path</code>, as returned by
<code><a href="#topic+nlasso_path">nlasso_path</a></code> and <code><a href="#topic+olasso_path">olasso_path</a></code></p>
</td></tr>
<tr><td><code id="print.natural.path_+3A_...">...</code></td>
<td>
<p>additional argument(not used here, only for S3 generic/method consistency)</p>
</td></tr>
</table>

<hr>
<h2 id='standardize'>Standardize the n -by- p design matrix X to have
column means zero and ||X_j||_2^2 = n for all j</h2><span id='topic+standardize'></span>

<h3>Description</h3>

<p>Standardize the n -by- p design matrix X to have
column means zero and ||X_j||_2^2 = n for all j
</p>


<h3>Usage</h3>

<pre><code class='language-R'>standardize(x, center = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="standardize_+3A_x">x</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="standardize_+3A_center">center</code></td>
<td>
<p>should we set column means equal to zero</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
