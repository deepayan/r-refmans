<!DOCTYPE html><html><head><title>Help for package SailoR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SailoR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SailoR-package'>
<p>An Extension of the Taylor Diagram to Two-Dimensional Vector Data</p></a></li>
<li><a href='#Current'>
<p>Ocean Current Data</p></a></li>
<li><a href='#Dragonera'>
<p>Wind data</p></a></li>
<li><a href='#Ensembles'>
<p>Multimodel Ensembles</p></a></li>
<li><a href='#EstacaDeBares'>
<p>Wave Energy Flux data</p></a></li>
<li><a href='#Reanalysis'>
<p>Surface Wind from different Reanalyses</p></a></li>
<li><a href='#SailoR.Indices'>
<p>Calculation of indices for Sailor Diagram</p></a></li>
<li><a href='#SailoR.Plot'>
<p>Sailor Diagram</p></a></li>
<li><a href='#SailoR.Table'>
<p>Summary of indices calculated for the Sailor diagrams</p></a></li>
<li><a href='#Synthetic'>
<p>Ocean Current Data</p></a></li>
<li><a href='#UVError'>
<p>Calculation of the elements of the 2D MSE terms</p></a></li>
<li><a href='#WRF'>
<p>Vertically Integrated Water Vapor Transport Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>An Extension of the Taylor Diagram to Two-Dimensional Vector
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-09-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Jon Sáenz <a href="https://orcid.org/0000-0002-5920-7570"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph],
  Sheila Carreno-Madinabeitia
    <a href="https://orcid.org/0000-0003-4625-6178"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cph],
  Santos J. González-Rojí
    <a href="https://orcid.org/0000-0003-4737-0984"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Ganix Esnaola <a href="https://orcid.org/0000-0001-9058-043X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, cph],
  Gabriel Ibarra-Berastegi
    <a href="https://orcid.org/0000-0001-8681-3755"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb, cph],
  Alain Ulazia <a href="https://orcid.org/0000-0002-4124-2853"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Santos J. González-Rojí &lt;santosjose.gonzalez@ehu.eus&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A new diagram for the verification of vector variables (wind, current, etc) generated by multiple models against a set of observations is presented in this package. It has been designed as a generalization of the Taylor diagram to two dimensional quantities. It is based on the analysis of the two-dimensional structure of the mean squared error matrix between model and observations. The matrix is divided into the part corresponding to the relative rotation and the bias of the empirical orthogonal functions of the data. The full set of diagnostics produced by the analysis of the errors between model and observational vector datasets comprises the errors in the means, the analysis of the total variance of both datasets, the rotation matrix corresponding to the principal components in observation and model, the angle of rotation of model-derived empirical orthogonal functions respect to the ones from observations, the standard deviation of model and observations, the root mean squared error between both datasets and the squared two-dimensional correlation coefficient. See the output of function UVError() in this package.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-23 09:42:25 UTC; Santitxu</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-23 23:50:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='SailoR-package'>
An Extension of the Taylor Diagram to Two-Dimensional Vector Data
</h2><span id='topic+SailoR-package'></span><span id='topic+SailoR'></span>

<h3>Description</h3>

<p>A new diagram for the verification of vector variables (wind, current, etc) generated by multiple models against a set of observations is presented in this package. It has been designed as a generalization of the Taylor diagram to two dimensional quantities. It is based on the analysis of the two-dimensional structure of the mean squared error matrix between model and observations. The matrix is divided into the part corresponding to the relative rotation and the bias of the empirical orthogonal functions of the data. The full set of diagnostics produced by the analysis of the errors between model and observational vector datasets comprises the errors in the means, the analysis of the total variance of both datasets, the rotation matrix corresponding to the principal components in observation and model, the angle of rotation of model-derived empirical orthogonal functions respect to the ones from observations, the standard deviation of model and observations, the root mean squared error between both datasets and the squared two-dimensional correlation coefficient. See the output of function <code>UVError()</code> in this package.
</p>


<h3>Author(s)</h3>

<p>Jon Sáenz, Sheila Carreno-Madinabeitia, Santos J. González-Rojí, 
Ganix Esnaola, Gabriel Ibarra-Berastegi and Alain Ulazia
</p>
<p>Maintainer: Santos J. González-Rojí &lt;santosjose.gonzalez@ehu.eus&gt;
</p>


<h3>References</h3>

<p>J. Sáenz, S. Carreno-Madinabeitia, G. Esnaola, S.J. González-Rojí, G. Ibarra-Berastegi and A. Ulazia (2020). The Sailor diagram - A new diagram for the verification of two-dimensional vector data from multiple models. Geoscientific Model Development, 13(7), 3221-3240. doi: <a href="https://doi.org/10.5194/gmd-13-3221-2020">https://doi.org/10.5194/gmd-13-3221-2020</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UVError">UVError</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------
# Example 1: Figure 5 (left) from Sáenz et al. (2020)
#--------------------------------------------------------

# Load the data
data(Dragonera)

# Parameters
Uxlim=c(-10,10)
Uylim=c(-10,10)
Uxlab&lt;-"U (m/s)"
Uylab&lt;-"V (m/s)"
plotmain&lt;-"Dragonera U10/V10"
sfactor&lt;-1
ref&lt;-Dragonera[["ref"]]
mod&lt;-Dragonera[["mod"]]
    
# Index
SailoR.Indices(ref,mod)

# Plot    
p &lt;- SailoR.Plot(ref,mod,ColourList=NULL,sfactor,docenter=TRUE,
                 Uxlim,Uylim,Uxlab,Uylab,plotmain,plotlegend=TRUE,
                 plotRMSElegend=TRUE,
                 plotscalelegend=TRUE,
                 RMSE_legend_Rounding=1,RMSE_legend_units = " m/s",
                 referenceName="Reference")

#Add segments
segments(-1,-1, x1 = -1, y1 = 1,col="brown",lwd=4)
segments(-1,-1, x1 = 1, y1 = -1,col="brown",lwd=4)
segments(1,-1, x1 = 1, y1 = 1,col="brown",lwd=4)
segments(1,1, x1 = -1, y1 = 1,col="brown",lwd=4)

  </code></pre>

<hr>
<h2 id='Current'>
Ocean Current Data
</h2><span id='topic+Current'></span>

<h3>Description</h3>

<p>Contains the information of the surface ocean currents measured in the Bay of Biscay by the Donostia buoy and the HF-Radar from the Basque Meteorological Agency EUSKALMET. Additionally, it also contains model data from the high resolution global analysis and forecasting system PSY4V3R1 of the Copernicus Marine Environment Monitoring Service (CMEMS). Only the closest spatial grid points to the buoy location (43.6 ºN and 2.0 ºW) in radar and model grids are considered, and only the parts of years 2017 and 2018 which are present in the three sources (8319 hourly observations) are included. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Current")</code></pre>


<h3>Format</h3>

<p>A list with two data frames:
</p>

<dl>
<dt><code>mod</code></dt><dd><p>a data frame including the data from both gridded datasets.</p>
</dd>
<dt><code>ref</code></dt><dd><p>a data frame including the buoy data.</p>
</dd>
</dl>
 
<p>Each of these data frames includes 3 variables:
</p>

<dl>
<dt><code>mod</code></dt><dd><p>a factor defining if the data belong to the observed data (ref), to the radar (rad) or to the ocean modelling product (mod).</p>
</dd>
<dt><code>U</code></dt><dd><p>zonal component of ocean current (m/s).</p>
</dd>
<dt><code>V</code></dt><dd><p>meridional component of ocean current (m/s).</p>
</dd>
</dl>
  


<h3>Source</h3>

<p>The in-situ data belong to the Basque Meteorological Agency EUSKALMET and were downloaded from <a href="https://www.euskoos.eus">https://www.euskoos.eus</a>. The Copernicus Marine Environment Monitoring Service (CMEMS) data can be retrieved from their data portal.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------
# Example 1: Figure 6 (left) from Sáenz et al. (2020)
#--------------------------------------------------------

# Load the data
data(Current)

# Parameters
Uxlim=c(-0.5,0.5)
Uylim=c(-0.5,0.5)
Uxlab&lt;-"Ux (m/s)"
Uylab&lt;-"Uy (m/s)"
plotmain&lt;-"Surface current"
sfactor&lt;-4
ref&lt;-Current[["ref"]]
mod&lt;-Current[["mod"]]
  
# Index
SailoR.Indices(ref,mod)

# Plot
SailoR.Plot(ref, mod, ColourList=NULL, sfactor, docenter=TRUE,
            Uxlim, Uylim, Uxlab, Uylab, plotmain, plotlegend=TRUE,
            plotRMSElegend=TRUE, plotscalelegend=TRUE,
            RMSE_legend_Rounding=2, RMSE_legend_units = " m/s",
            referenceName="Buoy")
</code></pre>

<hr>
<h2 id='Dragonera'>
Wind data
</h2><span id='topic+Dragonera'></span>

<h3>Description</h3>

<p>Contains the information of both zonal and meridional wind components measured in the Mediterranean sea by the in-situ buoy Dragonera, operated by the Spanish State Ports Authority - Puertos del Estado. Data from two WRF downscaling experiments (including the 3DVAR data assimilation every 3 hours - D, and not including it - N), ERA-Interim reanalysis and remote sensing data from the second version of the Cross-Calibrated Multi-platform (CCMPv2) product are also included. Only the closest spatial grid points to the buoy location (39.56 ºN, 2.10 ºE) in the gridded products are considered. The data cover the period 2009-2014 (Ulazia et al., 2017). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Dragonera")</code></pre>


<h3>Format</h3>

<p>A list with two data frames:
</p>

<dl>
<dt><code>ref</code></dt><dd><p>a data frame including the buoy data.</p>
</dd>
<dt><code>mod</code></dt><dd><p>a data frame including the data from gridded datasets.</p>
</dd>
</dl>
 
<p>Each of these data frames includes 3 variables:
</p>

<dl>
<dt><code>mod</code></dt><dd><p>a factor defining if the data belong to the CCMPv2 product (CCMP_SAT), to the reanalysis ERA-Interim (rad) or to any of the WRF downscaling experiments (WRF_D or WRF_N).</p>
</dd>
<dt><code>U</code></dt><dd><p>zonal component of wind (m/s).</p>
</dd>
<dt><code>V</code></dt><dd><p>meridional component of wind (m/s).</p>
</dd>
</dl>
  


<h3>Source</h3>

<p>Both WRF downscaling experiments were created by the authors in previous studies. The in-situ data can be retrieved from <a href="http://www.puertos.es/es-es/oceanografia/Paginas/portus.aspx">http://www.puertos.es/es-es/oceanografia/Paginas/portus.aspx</a>. The CCMPv2 data can be retrieved from <a href="http://www.remss.com/measurements/ccmp/">http://www.remss.com/measurements/ccmp/</a>.
</p>


<h3>References</h3>

<p>A. Ulazia, J. Sáenz, G. Ibarra-Berastegi, S. J. González-Rojí and S. Carreno-Madinabeitia (2017) Using 3DVAR data assimilation to measure offshore wind energy potential at different turbine heights in the West Mediterranean. Applied Energy, 208:1232-1245, doi: <a href="https://doi.org/10.1016/j.apenergy.2017.09.030">https://doi.org/10.1016/j.apenergy.2017.09.030</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the data
data(Dragonera)

# Parameters

Uxlab&lt;-"Ux (m/s)"
Uylab&lt;-"Vy (m/s)"
ref&lt;-Dragonera[["ref"]]
mod&lt;-Dragonera[["mod"]]
    
# Index
SailoR.Indices(ref,mod)
    
#--------------------------------------------------------
# Example 1: Figure 5 (left) from Sáenz et al. (2020)
#--------------------------------------------------------

Uxlim=c(-10,10)
Uylim=c(-10,10)
sfactor&lt;-1
plotmain&lt;-"Dragonera U10/V10"
p &lt;- SailoR.Plot(ref,mod,ColourList=NULL,sfactor,docenter=TRUE,
                 Uxlim,Uylim,Uxlab,Uylab,plotmain,plotlegend=TRUE,
                 plotRMSElegend=TRUE,
                 plotscalelegend=TRUE,
                 RMSE_legend_Rounding=1,RMSE_legend_units = " m/s",
                 referenceName="Reference")

# Add segments
segments(-1,-1, x1 = -1, y1 = 1,col="brown",lwd=4)
segments(-1,-1, x1 = 1, y1 = -1,col="brown",lwd=4)
segments(1,-1, x1 = 1, y1 = 1,col="brown",lwd=4)
segments(1,1, x1 = -1, y1 = 1,col="brown",lwd=4)



#--------------------------------------------------------
# Example 2: Figure 5 (right) from Sáenz et al. (2020)
#--------------------------------------------------------

Uxlim=c(-1,1)
Uylim=c(-1,1)
sfactor&lt;-0.025
plotmain&lt;-"Dragonera U10/V10 (scaled)"
SailoR.Plot(ref,mod,ColourList=NULL,sfactor,docenter=FALSE,
            Uxlim,Uylim,Uxlab,Uylab,plotmain,plotlegend=TRUE,
            plotRMSElegend=TRUE,
            plotscalelegend=TRUE,
            RMSE_legend_Rounding=1,RMSE_legend_units = " m/s",
            referenceName="Reference")

</code></pre>

<hr>
<h2 id='Ensembles'>
Multimodel Ensembles
</h2><span id='topic+Ensembles'></span>

<h3>Description</h3>

<p>Contains the information of both components of surface wind over the Southern Hemisphere during the period 1979-2015 from the historical forcing experiment of CMIP5 repository. Six ensemble members from the IPSL model,  five from the MIROC model and four from the HGEM are included. Additionally, data from the reanalysis ERA5 is also included. All of them have been bilinearly interpolated to a common 1.25º x 1º regular grid. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Ensembles")</code></pre>


<h3>Format</h3>

<p>A list with 16 data frames:
</p>

<dl>
<dt><code>ERA5</code></dt><dd><p>a data frame including the data from reanalysis ERA5.</p>
</dd>
<dt><code>IPSLr1</code></dt><dd><p>first realization of the IPSL model.</p>
</dd>
<dt><code>IPSLr2</code></dt><dd><p>second realization of the IPSL model.</p>
</dd>
<dt><code>IPSLr3</code></dt><dd><p>third realization of the IPSL model.</p>
</dd>
<dt><code>IPSLr4</code></dt><dd><p>fourth realization of the IPSL model.</p>
</dd>
<dt><code>IPSLr5</code></dt><dd><p>fifth realization of the IPSL model.</p>
</dd>
<dt><code>IPSLr6</code></dt><dd><p>sixth realization of the IPSL model.</p>
</dd>
<dt><code>MIROCr1</code></dt><dd><p>first realization of the MIROC model.</p>
</dd>
<dt><code>MIROCr2</code></dt><dd><p>second realization of the MIROC model.</p>
</dd>
<dt><code>MIROCr3</code></dt><dd><p>third realization of the MIROC model.</p>
</dd>
<dt><code>MIROCr4</code></dt><dd><p>fourth realization of the MIROC model.</p>
</dd>
<dt><code>MIROCr5</code></dt><dd><p>fifth realization of the MIROC model.</p>
</dd>
<dt><code>HGEMr1</code></dt><dd><p>first realization of the HadGEM-ES model.</p>
</dd>
<dt><code>HGEMr2</code></dt><dd><p>second realization of the HadGEM-ES model.</p>
</dd>
<dt><code>HGEMr3</code></dt><dd><p>third realization of the HadGEM-ES model.</p>
</dd>
<dt><code>HGEMr4</code></dt><dd><p>fourth realization of the HadGEM-ES model.</p>
</dd>
</dl>

<p>Each of these data frames includes 4 variables:
</p>

<dl>
<dt><code>V1</code></dt><dd><p>a vector with longitude data.</p>
</dd>
<dt><code>V2</code></dt><dd><p>a vector with latitude data.</p>
</dd>
<dt><code>V3</code></dt><dd><p>zonal component of surface wind (m/s).</p>
</dd>
<dt><code>V4</code></dt><dd><p>meridional component of surface wind (m/s).</p>
</dd>
</dl>
  


<h3>References</h3>

<p>W. J. Collins, N. Bellouin, M. Doutriaux-Boucher, N. Gedney, P. Halloran, T. Hinton, ... and G. Martin (2011). Development and evaluation of an Earth-System model–HadGEM2. Geosci. Model Dev. Discuss, 4(2), 997-1062.
</p>
<p>J. L. Dufresne, M. A. Foujols, S. Denvil, A. Caubel, O. Marti, O. Aumont, ... and S. Bony (2013). Climate change projections using the IPSL-CM5 Earth System Model: from CMIP3 to CMIP5. Climate Dynamics, 40(9-10), 2123-2165.
</p>
<p>H. Hersbach, P. de Rosnay, B. Bell, D. Schepers, A. Simmons et al. (2018). Operational global reanalysis: progress, future directions and synergies with NWP. ECMWF Report.
</p>
<p>M. Watanabe, T. Suzuki, R. O’ishi, Y. Komuro, S. Watanabe, S. Emori, ... and K. Takata (2010). Improved climate simulation by MIROC5: mean states, variability, and climate sensitivity. Journal of Climate, 23(23), 6312-6335.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the data
data(Ensembles)

deg2rad&lt;-function(d){
  return(d*pi/180.)
}

# Get area factors from latitudes
Ws&lt;-sqrt(cos(deg2rad(Ensembles$ERA5$V2)))

# Create a ref/ mod object
# ERA5$V3 is zonal component and ERA5$V4 is meridional component
ref&lt;-data.frame("ERA5",Ensembles$ERA5$V3*Ws,Ensembles$ERA5$V4*Ws)
names(ref)&lt;-c("mod","U","V")

# Create an object for the model runs

modA&lt;-data.frame(mod=rep("MIROCr1",nrow(Ensembles$MIROCr1)),
                            U=Ensembles$MIROCr1$V3*Ws,V=Ensembles$MIROCr1$V4*Ws)
modB&lt;-data.frame(mod=rep("MIROC",nrow(Ensembles$MIROCr1)),
                            U=Ensembles$MIROCr1$V3*Ws,V=Ensembles$MIROCr1$V4*Ws)

# In modA every run of the ensemble is considered individually
modA&lt;-rbind(modA,data.frame(mod=rep("MIROCr2",nrow(Ensembles$MIROCr2)),
                 U=Ensembles$MIROCr2$V3*Ws,V=Ensembles$MIROCr2$V4*Ws))
# In modB all the members of the ensemble are taken as a single 
# model run (too long, so that later on, observations will have to be repeated)
modB&lt;-rbind(modB,data.frame(mod=rep("MIROC",nrow(Ensembles$MIROCr2)),
                 U=Ensembles$MIROCr2$V3*Ws,V=Ensembles$MIROCr2$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("MIROCr3",nrow(Ensembles$MIROCr3)),
                            U=Ensembles$MIROCr3$V3*Ws,V=Ensembles$MIROCr3$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("MIROC",nrow(Ensembles$MIROCr3)),
                            U=Ensembles$MIROCr3$V3*Ws,V=Ensembles$MIROCr3$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("MIROCr4",nrow(Ensembles$MIROCr4)),
                            U=Ensembles$MIROCr4$V3*Ws,V=Ensembles$MIROCr4$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("MIROC",nrow(Ensembles$MIROCr4)),
                            U=Ensembles$MIROCr4$V3*Ws,V=Ensembles$MIROCr4$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("MIROCr5",nrow(Ensembles$MIROCr5)),
                            U=Ensembles$MIROCr5$V3*Ws,V=Ensembles$MIROCr5$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("MIROC",nrow(Ensembles$MIROCr5)),
                            U=Ensembles$MIROCr5$V3*Ws,V=Ensembles$MIROCr5$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("IPSLr1",nrow(Ensembles$IPSLr1)),
                            U=Ensembles$IPSLr1$V3*Ws,V=Ensembles$IPSLr1$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("IPSL",nrow(Ensembles$IPSLr1)),
                            U=Ensembles$IPSLr1$V3*Ws,V=Ensembles$IPSLr1$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("IPSLr2",nrow(Ensembles$IPSLr2)),
                            U=Ensembles$IPSLr2$V3*Ws,V=Ensembles$IPSLr2$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("IPSL",nrow(Ensembles$IPSLr2)),
                            U=Ensembles$IPSLr2$V3*Ws,V=Ensembles$IPSLr2$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("IPSLr3",nrow(Ensembles$IPSLr3)),
                            U=Ensembles$IPSLr3$V3*Ws,V=Ensembles$IPSLr3$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("IPSL",nrow(Ensembles$IPSLr3)),
                            U=Ensembles$IPSLr3$V3*Ws,V=Ensembles$IPSLr3$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("IPSLr4",nrow(Ensembles$IPSLr4)),
                            U=Ensembles$IPSLr4$V3*Ws,V=Ensembles$IPSLr4$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("IPSL",nrow(Ensembles$IPSLr4)),
                            U=Ensembles$IPSLr4$V3*Ws,V=Ensembles$IPSLr4$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("IPSLr5",nrow(Ensembles$IPSLr5)),
                            U=Ensembles$IPSLr5$V3*Ws,V=Ensembles$IPSLr5$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("IPSL",nrow(Ensembles$IPSLr5)),
                            U=Ensembles$IPSLr5$V3*Ws,V=Ensembles$IPSLr5$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("IPSLr6",nrow(Ensembles$IPSLr6)),
                            U=Ensembles$IPSLr6$V3*Ws,V=Ensembles$IPSLr6$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("IPSL",nrow(Ensembles$IPSLr6)),
                            U=Ensembles$IPSLr6$V3*Ws,V=Ensembles$IPSLr6$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("HGEMr1",nrow(Ensembles$HGEMr1)),
                            U=Ensembles$HGEMr1$V3*Ws,V=Ensembles$HGEMr1$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("HGEM",nrow(Ensembles$HGEMr1)),
                            U=Ensembles$HGEMr1$V3*Ws,V=Ensembles$HGEMr1$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("HGEMr2",nrow(Ensembles$HGEMr2)),
                            U=Ensembles$HGEMr2$V3*Ws,V=Ensembles$HGEMr2$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("HGEM",nrow(Ensembles$HGEMr2)),
                            U=Ensembles$HGEMr2$V3*Ws,V=Ensembles$HGEMr2$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("HGEMr3",nrow(Ensembles$HGEMr3)),
                            U=Ensembles$HGEMr3$V3*Ws,V=Ensembles$HGEMr3$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("HGEM",nrow(Ensembles$HGEMr3)),
                            U=Ensembles$HGEMr3$V3*Ws,V=Ensembles$HGEMr3$V4*Ws))

modA&lt;-rbind(modA,data.frame(mod=rep("HGEMr4",nrow(Ensembles$HGEMr4)),
                            U=Ensembles$HGEMr4$V3*Ws,V=Ensembles$HGEMr4$V4*Ws))
modB&lt;-rbind(modB,data.frame(mod=rep("HGEM",nrow(Ensembles$HGEMr4)),
                            U=Ensembles$HGEMr4$V3*Ws,V=Ensembles$HGEMr4$V4*Ws))

CMIPA&lt;-list(ref,modA)
names(CMIPA)&lt;-c("ref","mod")
CMIPB&lt;-list(ref,modB)
names(CMIPB)&lt;-c("ref","mod")

#--------------------------------------------------------
# Example 1: Figure 8 (right) from Sáenz et al. (2020)
#--------------------------------------------------------

# Parameters
Uxlim=c(-1,1)
Uylim=c(-0.5,1.5)
Uxlab&lt;-"Ux (m/s)"
Uylab&lt;-"Uy (m/s)"
plotmain&lt;-"CMIP5 samples vs ERA5"
sfactor&lt;-0.2

ref&lt;-CMIPB[["ref"]]
mod&lt;-CMIPB[["mod"]]

sindex&lt;-SailoR.Indices(ref, mod, Ensembles=TRUE)
SailoR.Table(sindex, round_digits = 3)


SailoR.Plot(ref, mod, ColourList=NULL, sfactor, docenter=TRUE,
            Uxlim, Uylim, Uxlab, Uylab, plotmain, plotlegend=TRUE,
            Ensembles=TRUE, plotRMSElegend=TRUE, plotscalelegend=TRUE,
            RMSE_legend_Rounding=2, RMSE_legend_units = " m/s",
            referenceName="ERA5") 

#--------------------------------------------------------
# Example 2: Figure 9 (rigth) from Sáenz et al. (2020)
#--------------------------------------------------------

# Parameters
Uxlim=c(-0.15,0.25)
Uylim=c(0.19,0.61)
Uxlab&lt;-"Ux (m/s)"
Uylab&lt;-"Uy (m/s)"
plotmain&lt;-"CMIP5 samples vs ERA5"
sfactor&lt;-0.01
theColourList&lt;-c("grey40","red","blue","darkolivegreen3",
                 "orange","seagreen3","gold",
                 "purple","pink","magenta",
                 "lightblue","gold4","darkslateblue",
                 "coral","green4","deeppink4")

ref&lt;-CMIPA[["ref"]]
mod&lt;-CMIPA[["mod"]]

sindex&lt;-SailoR.Indices(ref,mod,Ensembles=TRUE)
ST&lt;-SailoR.Table(sindex,round_digits = 1)

p&lt;-SailoR.Plot(ref, mod, ColourList=theColourList, sfactor, docenter=FALSE,
            Uxlim, Uylim, Uxlab, Uylab, plotmain, plotlegend=FALSE,
            Ensembles=TRUE, plotRMSElegend=FALSE, plotscalelegend=TRUE,
            RMSE_legend_Rounding=2, RMSE_legend_units = " m/s",
            referenceName="ERA5")  

#legend
legend(x="topright",
       as.character(ST$modelName),
       col=theColourList,lwd=2,
       lty=c("dashed",rep("solid",15)),cex=1,ncol=2)

#RMSElegend
legend(x="bottomright",
       paste(as.character(unique(mod$mod)),": ",ST$RMSE[-1],"m/s",sep=""),
       col=theColourList,
       pch=16,lwd=3,
       title=expression(bold("RMSE")),
       cex=0.9,ncol=3) 

</code></pre>

<hr>
<h2 id='EstacaDeBares'>
Wave Energy Flux data
</h2><span id='topic+EstacaDeBares'></span>

<h3>Description</h3>

<p>Contains the information of both components of wave energy flux measured by the buoy placed in Estaca de Bares and operated by the Spanish State Ports Authority - Puertos del Estado. Different statistical models were applied to this observed data: analogs, random forests, the combination of both of them, WAM model and the persistence (Ibarra-Berastegi et al., 2015 and 2016).   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("EstacaDeBares")</code></pre>


<h3>Format</h3>

<p>A list with two data frames:
</p>

<dl>
<dt><code>ref</code></dt><dd><p>a data frame including the buoy data.</p>
</dd>
<dt><code>mod</code></dt><dd><p>a data frame including the data from the statistical models.</p>
</dd>
</dl>
 
<p>Each of these data frames includes 4 variables:
</p>

<dl>
<dt><code>date</code></dt><dd><p>date information.</p>
</dd>
<dt><code>mod</code></dt><dd><p>a factor defining if the data belong to the analogs method (analo), to random forests (rf), both techniques combined (analorf), WAM model (wam) or persistence (pers).</p>
</dd>
<dt><code>U</code></dt><dd><p>zonal component of wave energy flux (kW/m).</p>
</dd>
<dt><code>V</code></dt><dd><p>meridional component of wave energy flux (kW/m).</p>
</dd>
</dl>
    


<h3>Source</h3>

<p>The results from the statistical methods were obtained by the authors in previous studies. The in-situ data can be retrieved from <a href="http://www.puertos.es/es-es/oceanografia/Paginas/portus.aspx">http://www.puertos.es/es-es/oceanografia/Paginas/portus.aspx</a>.
</p>


<h3>References</h3>

<p>G. Ibarra-Berastegi, J. Sáenz, G. Esnaola, A. Ezcurra and A. Ulazia (2015) Short-term forecasting of the wave energy flux: Analogues, random forests, and physics-based models. Ocean Engineering, 104:530-539, doi: <a href="https://doi.org/10.1016/j.oceaneng.2015.05.038">https://doi.org/10.1016/j.oceaneng.2015.05.038</a>.
</p>
<p>G. Ibarra-Berastegi, J. Sáenz, G. Esnaola, A. Ezcurra, A. Ulazia, N. Rojo and G. Gallastegui (2016) Wave Energy Forecasting at Three Coastal Buoys in the Bay of Biscay IEEE JOURNAL OF OCEANIC ENGINEERING, 41:923-929, doi: <a href="https://doi.org/10.1109/JOE.2016.2529400">https://doi.org/10.1109/JOE.2016.2529400</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------
# Example 1
#--------------------------------------------------------

# Load the data
data(EstacaDeBares)

# Parameters
Uxlim=c(0,25)
Uylim=c(0,25)
Uxlab&lt;-" "
Uylab&lt;-" "
plotmain&lt;-"Wave Energy Flux. Estaca De Bares."
sfactor&lt;-0.25
plotRMSE&lt;-TRUE
ref&lt;-EstacaDeBares[["ref"]][,c("mod","U","V")]
mod&lt;-EstacaDeBares[["mod"]][,c("mod","U","V")]
  
# Index
SailoR.Indices(ref,mod)
 
# Plot 
SailoR.Plot(ref, mod, ColourList=NULL, sfactor, docenter=TRUE,
            Uxlim, Uylim, Uxlab, Uylab, plotmain, plotlegend=TRUE,
            plotRMSElegend=TRUE, plotscalelegend=TRUE, 
            RMSE_legend_Rounding=0,RMSE_legend_units = " W/m",
            referenceName="Buoy")

</code></pre>

<hr>
<h2 id='Reanalysis'>
Surface Wind from different Reanalyses
</h2><span id='topic+Reanalysis'></span>

<h3>Description</h3>

<p>Contains the information of both components of monthly averaged surface wind in January over the Northern Hemisphere as included in different state-of-the-art reanalyses during the period 2011-2018. ERA5 reanalysis was defined as the reference, and the remaining gridded products were included in the model matrix. Particularly, the original NCEP/NCAR first generation reanalysis, MERRA2, CFSv2 and ERA-Interim. All of them have been bilinearly interpolated to NCEP/NCAR original grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Reanalysis")</code></pre>


<h3>Format</h3>

<p>A list with two matrices:
</p>

<dl>
<dt><code>ref</code></dt><dd><p>a matrix including the data from reanalysis ERA5.</p>
</dd>
<dt><code>mod</code></dt><dd><p>a matrix including the data from other reanalyses.</p>
</dd>
</dl>
 
<p>Each of these data frames includes 5 variables:
</p>

<dl>
<dt><code>V1</code></dt><dd><p>a vector with longitude data.</p>
</dd>
<dt><code>V2</code></dt><dd><p>a vector with latitude data.</p>
</dd>
<dt><code>V3</code></dt><dd><p>a factor defining if the data belong to the reanalysis CFSv2 (cfsv2), ERA-Interim (ei), MERRA2 (merra2) or NCEP/NCAR reanalysis (nnra).</p>
</dd>
<dt><code>V4</code></dt><dd><p>zonal component of surface wind (m/s).</p>
</dd>
<dt><code>V5</code></dt><dd><p>meridional component of surface wind (m/s).</p>
</dd>
</dl>
  


<h3>Examples</h3>

<pre><code class='language-R'># Load the data
data(Reanalysis)

# Parameters
Uxlim=c(-0.5,1)
Uylim=c(-1,0.5)
Uxlab&lt;-"Ux (m/s)"
Uylab&lt;-"Uy (m/s)"
plotmain&lt;-"Reanalyses"
sfactor&lt;-0.15

# Create ref, mod objects

weightWithLat=TRUE

if(weightWithLat){
  dlats=as.numeric(Reanalysis[["ref"]][,2])
  rlats=pi*dlats/180.
  lweights=sqrt(cos(rlats))

  ref&lt;-data.frame(Reanalysis[["ref"]][,3],
                  lweights*as.numeric(Reanalysis[["ref"]][,4]),
                  lweights*as.numeric(Reanalysis[["ref"]][,5]))
}else{

  ref&lt;-data.frame(Reanalysis[["ref"]][,3],
                  as.numeric(Reanalysis[["ref"]][,4]),
                  as.numeric(Reanalysis[["ref"]][,5]))

}
names(ref)&lt;-c("mod","U","V")

mod&lt;-data.frame(Reanalysis[["mod"]][,3],
                as.numeric(Reanalysis[["mod"]][,4]),
                as.numeric(Reanalysis[["mod"]][,5]))
names(mod)&lt;-c("mod","U","V")
  
# Sailors

#--------------------------------------------------------
# Example 1: Figure 7 (left) from Sáenz et al. (2020)
#--------------------------------------------------------

SailoR.Plot(ref, mod, ColourList=NULL, sfactor, docenter=FALSE,
            Uxlim, Uylim, Uxlab, Uylab, plotmain, plotlegend=TRUE,
            plotRMSElegend=TRUE, plotscalelegend=TRUE,
            RMSE_legend_Rounding=1, RMSE_legend_units = " m/s",
            referenceName="ERA5")

#--------------------------------------------------------
# Example 2: Figure 7 (right) from Sáenz et al. (2020)
#--------------------------------------------------------

SailoR.Plot(ref, mod, ColourList=NULL, sfactor, docenter=TRUE,
            Uxlim, Uylim, Uxlab, Uylab, plotmain, plotlegend=TRUE,
            plotRMSElegend=TRUE, plotscalelegend=TRUE,
            RMSE_legend_Rounding=1, RMSE_legend_units = " m/s",
            referenceName="ERA5")
  
</code></pre>

<hr>
<h2 id='SailoR.Indices'>
Calculation of indices for Sailor Diagram
</h2><span id='topic+SailoR.Indices'></span>

<h3>Description</h3>

<p>This function returns a data frame with all the statistics used by the Sailor diagram for the set of different models in data frame <code>mod</code> with the reference in data frame <code>ref</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SailoR.Indices(ref, mod, Ensembles = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SailoR.Indices_+3A_ref">ref</code></td>
<td>

<p>A data frame with the reference observations. It should have 3 columns: name, zonal component and meridional component.
</p>
</td></tr>
<tr><td><code id="SailoR.Indices_+3A_mod">mod</code></td>
<td>

<p>A data frame with the model data. It should have 3 columns: name, zonal component and meridional component. More than one model can be included under different names. Additionally, <code>nrows(mod)</code> must be an integer multiple of <code>nrows(ref)</code>. 
</p>
</td></tr>
<tr><td><code id="SailoR.Indices_+3A_ensembles">Ensembles</code></td>
<td>

<p>If <code>Ensembles</code> is set to <code>TRUE</code>, M different models included in the data frame <code>mod</code> will be taken as a single model and the reference model is repeated M times for the calculation of the Sailor diagram. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result is a data frame with a summary of the statistics obtained:
</p>
<table>
<tr><td><code>meanU</code></td>
<td>
<p>mean of the U dataset.</p>
</td></tr>
<tr><td><code>meanV</code></td>
<td>
<p>mean of the V dataset.</p>
</td></tr>
<tr><td><code>RMSE</code></td>
<td>
<p>root mean square error between U and V.</p>
</td></tr>
<tr><td><code>sdUx</code></td>
<td>
<p>standard deviation of zonal component (U).</p>
</td></tr>
<tr><td><code>sdUy</code></td>
<td>
<p>standard deviation of meridional component (U).</p>
</td></tr>
<tr><td><code>sdVx</code></td>
<td>
<p>standard deviation of zonal component (V).</p>
</td></tr>
<tr><td><code>sdVy</code></td>
<td>
<p>standard deviation of meridional component (V).</p>
</td></tr>
<tr><td><code>Eu</code></td>
<td>
<p>EOF matrix for the U dataset.</p>
</td></tr>
<tr><td><code>Ev</code></td>
<td>
<p>EOF matrix for the V dataset.</p>
</td></tr>
<tr><td><code>Sigmau</code></td>
<td>
<p>matrix with standard deviations of U (2x2 matrix).</p>
</td></tr>
<tr><td><code>Sigmav</code></td>
<td>
<p>matrix with standard deviations of V (2x2 matrix).</p>
</td></tr>
<tr><td><code>TotVarU</code></td>
<td>
<p>total variance of the U dataset.</p>
</td></tr>
<tr><td><code>TotVarV</code></td>
<td>
<p>total variance of the V dataset.</p>
</td></tr>
<tr><td><code>thetau</code></td>
<td>
<p>angle of EOF1 (U) with zonal axis.</p>
</td></tr>
<tr><td><code>thetav</code></td>
<td>
<p>angle of EOF1 (V) with meridional axis.</p>
</td></tr>
<tr><td><code>thetavu</code></td>
<td>
<p>rotation angle from U EOFs to V EOFs.</p>
</td></tr>
<tr><td><code>R2vec</code></td>
<td>
<p>vector correlation squared in 2D as defined by Breaker, Gemmill and Crossby (1994).</p>
</td></tr>
<tr><td><code>Rvu</code></td>
<td>
<p>rotation matrix to express Ev as a rotation from Eu.</p>
</td></tr>
<tr><td><code>EccentricityU</code></td>
<td>
<p>eccentricity of the ellipses from the reference dataset.</p>
</td></tr>
<tr><td><code>EccentricityV</code></td>
<td>
<p>eccentricity of the ellipses from the model dataset.</p>
</td></tr>
<tr><td><code>congruenceEOF</code></td>
<td>
<p>congruence coefficients (absolute value) for EOFs.</p>
</td></tr>
</table>


<h3>References</h3>

<p>L. C. Breaker, W. H. Gemmill and D. S. Crosby (1994). The application of a technique for vector correlation to problems in meteorology and oceanography. Journal of Applied Meteorology, 33(11), 1354-1365.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------
# Example 1
#--------------------------------------------------------

# Load the ocean current data 
data("Current")
  
# Calculate the indices
ref&lt;-Current[["ref"]]
mod&lt;-Current[["mod"]]

SailoR.Indices(ref, mod)
  
</code></pre>

<hr>
<h2 id='SailoR.Plot'>
Sailor Diagram
</h2><span id='topic+SailoR.Plot'></span>

<h3>Description</h3>

<p>This function generates the Sailor diagram. It calls <code>SailoR.Indices()</code> internally. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SailoR.Plot(ref, mod, ColourList = NULL, sfactor = 1, docenter = FALSE, 
xlim = NULL, ylim = NULL, xlab = NULL, ylab = NULL, 
plotmain = NULL, plotlegend = TRUE, plotRMSElegend = TRUE, 
plotscalelegend=TRUE, Ensembles = FALSE, RMSE_legend_units = "", 
RMSE_legend_Rounding = 2, referenceName = NULL,
linestype = NULL, bias_pch = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SailoR.Plot_+3A_ref">ref</code></td>
<td>

<p>a data frame with the reference observations. It should have 3 columns: name, zonal component and meridional component.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_mod">mod</code></td>
<td>

<p>a data frame with the model data. It should have 3 columns: name, zonal component and meridional component. More than one model can be included by using different names. 
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_colourlist">ColourList</code></td>
<td>

<p>a vector with all the colors you want to use for plotting the models. Darkgray will always be used for reference data. If <code>NULL</code>, the default colours are used: c(&quot;gray40&quot;, &quot;red&quot;, &quot;blue&quot;, &quot;darkolivegreen3&quot;, &quot;orange&quot;, &quot;seagreen3&quot;, &quot;gold&quot;, &quot;purple&quot;, &quot;pink&quot;).</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_sfactor">sfactor</code></td>
<td>

<p>a value with the scale factor to be applied to the ellipses of each model.</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_docenter">docenter</code></td>
<td>

<p>if all the ellipses should be plotted over the reference one, this argument should be <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_xlim">xlim</code></td>
<td>

<p>X axis limit for the plot.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_ylim">ylim</code></td>
<td>

<p>Y axis limit for the plot.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_xlab">xlab</code></td>
<td>

<p>a title for the X axis.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_ylab">ylab</code></td>
<td>

<p>a title for the Y axis.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_plotmain">plotmain</code></td>
<td>

<p>an overall title for the plot.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_plotlegend">plotlegend</code></td>
<td>

<p>if a default legend should be added to the plot, this argument should be <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_plotrmselegend">plotRMSElegend</code></td>
<td>

<p>if a legend with a summary of the RMSE values should be added to the plot, this argument should be <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_plotscalelegend">plotscalelegend</code></td>
<td>

<p>if a legend with the scaled factor should be added to the plot, this argument should be <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_ensembles">Ensembles</code></td>
<td>

<p>if <code>Ensembles</code> is set to <code>TRUE</code>, M different models included in the data frame <code>mod</code> will be taken as a single model and the reference model is repeated M times for the calculation of the Sailor diagram.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_rmse_legend_units">RMSE_legend_units</code></td>
<td>

<p>units to be written in the RMSE legend.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_rmse_legend_rounding">RMSE_legend_Rounding</code></td>
<td>

<p>number of decimals to be kept in the RMSE legend.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_referencename">referenceName</code></td>
<td>

<p>external name provided for the reference dataset for the legend.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_linestype">linestype</code></td>
<td>

<p>a vector with the lines types for the model data. The &quot;dashed&quot; option is reserved for the reference. The other options are &quot;solid&quot;, &quot;dotted&quot;, &quot;dotdash&quot;, &quot;longdash&quot; or &quot;twodash&quot;.
</p>
</td></tr>
<tr><td><code id="SailoR.Plot_+3A_bias_pch">bias_pch</code></td>
<td>

<p>a vector with the pch types for the bias symbol. The default opcion provides a circle when docenter is TRUE and a point when it is FALSE.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result is a plot object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SailoR.Indices">SailoR.Indices</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------
# Example 1: Figure 6 (right) from Sáenz et al. (2020)
#--------------------------------------------------------

# Load the Vertically Integrated Water Vapor Transport Data included in the package
data(WRF)

# Parameters
Uxlim=c(60,110)
Uylim=c(0,50)
Uxlab&lt;-"Qx (kg/m/s)"
Uylab&lt;-"Qy (kg/m/s)"
plotmain&lt;-"Water vapour transport"
sfactor&lt;-0.1
ref&lt;-WRF[["ref"]][,c("mod","U","V")]
mod&lt;-WRF[["mod"]][,c("mod","U","V")]

isBad=((is.na(ref$U)) |(is.na(ref$V)))
isOK=(!isBad)
ref&lt;-ref[isOK,]

nmod1&lt;-which(mod$mod=="WrfN")
mod1&lt;-mod[nmod1,][isOK,]
nmod2&lt;-which(mod$mod=="WrfD")
mod2&lt;-mod[nmod2,][isOK,]
nmod3&lt;-which(mod$mod=="ERAI")
mod3&lt;-mod[nmod3,][isOK,]

mod&lt;-rbind(mod1,mod2,mod3)

# Index
sIWRF=SailoR.Indices(ref,mod)

# Index table
sIWRF.table&lt;-SailoR.Table(sIWRF)

# Plot
SailoR.Plot(ref,mod,ColourList=NULL,sfactor,docenter=TRUE,
            Uxlim, Uylim, Uxlab, Uylab, plotmain, plotlegend=TRUE,
            plotRMSElegend=TRUE, RMSE_legend_Rounding=0,
            RMSE_legend_units=" kg/m/s", referenceName="Sounding",
            ,linestype=c("solid", "dotted", "twodash"))
  </code></pre>

<hr>
<h2 id='SailoR.Table'>
Summary of indices calculated for the Sailor diagrams
</h2><span id='topic+SailoR.Table'></span>

<h3>Description</h3>

<p>This function reads the output from <code>SailoR.Indices()</code> and creates a summary data frame of the indices calculated for the Sailor diagram. This can easily be converted to a LaTeX or other formats with external packages (<code>'xtable'</code>, for instance).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SailoR.Table(UV, round_digits = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SailoR.Table_+3A_uv">UV</code></td>
<td>

<p>a list containing the output obtained directly from <code>SailoR.Indices()</code> function.
</p>
</td></tr>
<tr><td><code id="SailoR.Table_+3A_round_digits">round_digits</code></td>
<td>

<p>number of decimals to be kept in the summary table.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result is a data frame with the information from the <code>SailoR.Indices()</code> function in tabular format. Particularly, the indices stated in the table are the following ones:
</p>
<table>
<tr><td><code>modelName</code></td>
<td>
<p>the names of the models datasets.</p>
</td></tr>
<tr><td><code>sdUx</code></td>
<td>
<p>standard deviation of zonal component (U).</p>
</td></tr>
<tr><td><code>sdUy</code></td>
<td>
<p>standard deviation of meridional component (U).</p>
</td></tr>
<tr><td><code>sdVx</code></td>
<td>
<p>standard deviation of zonal component (V).</p>
</td></tr>
<tr><td><code>sdVy</code></td>
<td>
<p>standard deviation of meridional component (V).</p>
</td></tr>
<tr><td><code>Sigmax</code></td>
<td>
<p>a scalar representing the semi-major axis of the ellipse (standard deviation of PC1).</p>
</td></tr>
<tr><td><code>Sigmay</code></td>
<td>
<p>a scalar representing the semi-minor axis of the ellipse (standard deviation of PC2).</p>
</td></tr>
<tr><td><code>thetau</code></td>
<td>
<p>angle of EOF1 (U) with zonal axis.</p>
</td></tr>
<tr><td><code>thetav</code></td>
<td>
<p>angle of EOF1 (V) with meridional axis.</p>
</td></tr>
<tr><td><code>thetavu</code></td>
<td>
<p>rotation angle from U EOFs to V EOFs.</p>
</td></tr>
<tr><td><code>R2vec</code></td>
<td>
<p>vector correlation squared in 2D as defined by Breaker, Gemmill and Crossby (1994).</p>
</td></tr>
<tr><td><code>biasMag</code></td>
<td>
<p>magnitude of the bias vector.</p>
</td></tr>
<tr><td><code>RMSE</code></td>
<td>
<p>root mean square error between U and V.</p>
</td></tr>
<tr><td><code>Eccentricity</code></td>
<td>
<p>eccentricity of the ellipses from the reference and models dataset.</p>
</td></tr>
<tr><td><code>congruenceEOF1</code></td>
<td>
<p>congruence coefficients (absolute value) for EOF1.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------
# Example 1
#--------------------------------------------------------
# Load the ocean current data 
data("Current")
  
# Calculate the statistics
ref&lt;-Current[["ref"]]
mod&lt;-Current[["mod"]]
UV &lt;- SailoR.Indices(ref,mod)

# Obtain the summary of the results
SailoR.Table(UV)

#--------------------------------------------------------
# Example 2: Table 2 from Sáenz et al. (2020)
#--------------------------------------------------------
# Load Synthetic data 
data(Synthetic)

ref&lt;-Synthetic[["ref"]]
mod&lt;-Synthetic[["mod"]]

# Calculate the statistics
UVtable=SailoR.Table(UV,round_digits = 4)
TotVar&lt;-c((UVtable$sdUx^2+UVtable$sdUy^2)[1],
          (UVtable$sdVx^2+UVtable$sdVy^2)[-1])
TotSigma&lt;-UVtable$Sigmax^2+UVtable$Sigmay^2
UVtable&lt;-cbind(UVtable[,1],TotVar,TotSigma,UVtable[,8:15])

UVtable&lt;-round(UVtable[,-1],2)

#If you want to print it as a LaTeX table:
#library(xtable)
#oInfo&lt;-xtable(UVtable)
#print(oInfo,type="latex",file="table.tex")

</code></pre>

<hr>
<h2 id='Synthetic'>
Ocean Current Data
</h2><span id='topic+Synthetic'></span>

<h3>Description</h3>

<p>This dataset contains a one-year long time-series of hourly zonal and meridional wind components in the extratropical Pacific from ERA5. From this dataset (Reference), different synthetic datasets with individual sources of error artificially added to them have been produced. In the first case (MOD1), a constant bias has been added. Next, the error is produced (MOD2) by rotating the zonal and meridional components by 30 degrees counterclockwise (thus also inducing a bias due to the rotation of the mean vector). An unphysical source of error is added in MOD3 by randomly resampling the dataset in order to break the original correlation of the vectors while keeping the bias and EOFs at their original values. Finally, the original data has been multiply by a constant in order to change the variance of the data (MOD4), although the scaling produces a change in the bias, too. The main objective of adding this synthetic dataset is to show the response of the Sailor diagram to different kinds of errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Synthetic")</code></pre>


<h3>Format</h3>

<p>A list with two data frames:
</p>

<dl>
<dt><code>mod</code></dt><dd><p>a data frame including the wind data from ERA5.</p>
</dd>
<dt><code>ref</code></dt><dd><p>a data frame including the synthetic datasets.</p>
</dd>
</dl>
 
<p>Each of these data frames includes 3 variables:
</p>

<dl>
<dt><code>mod</code></dt><dd><p>a factor defining if the data belong to the ERA5 wind data (REF), or to the synthetic datasets MOD1, MOD2, MOD3 or MOD4.</p>
</dd>
<dt><code>U</code></dt><dd><p>zonal component of wind speed (m/s).</p>
</dd>
<dt><code>V</code></dt><dd><p>meridional component of wind speed (m/s).</p>
</dd>
</dl>
  


<h3>Examples</h3>

<pre><code class='language-R'># Load the data
data(Synthetic)

Uxlim=c(0,15)
Uylim=c(-25,10)
Uxlab&lt;-"Ux (m/s)"
Uylab&lt;-"Uy (m/s)"
plotmain&lt;-"Reference and synthetic models"
sfactor&lt;-1
ref&lt;-Synthetic[["ref"]]
mod&lt;-Synthetic[["mod"]]

#--------------------------------------------------------
# Example 1: Figure 4 (left) from Sáenz et al. (2020)
#--------------------------------------------------------

SailoR.Plot(ref, mod, ColourList=NULL, sfactor, docenter=FALSE,
            Uxlim, Uylim, Uxlab, Uylab, plotmain, plotlegend=TRUE,
            Ensembles=TRUE, plotRMSElegend=TRUE, 
            plotscalelegend=TRUE, RMSE_legend_Rounding=2,
            RMSE_legend_units = " m/s")

#--------------------------------------------------------
# Example 2: Figure 4 (right) from Sáenz et al. (2020)
#--------------------------------------------------------

SailoR.Plot(ref, mod, ColourList=NULL, sfactor, docenter=TRUE,
            Uxlim, Uylim, Uxlab, Uylab, plotmain, plotlegend=TRUE,
            Ensembles=TRUE, plotRMSElegend=TRUE,
            plotscalelegend=TRUE, RMSE_legend_Rounding=2,
            RMSE_legend_units = " m/s")
</code></pre>

<hr>
<h2 id='UVError'>
Calculation of the elements of the 2D MSE terms
</h2><span id='topic+UVError'></span>

<h3>Description</h3>

<p>This function calculates the different terms in the 2D MSE equation, the rotation of EOFs and so on for a unique given model. This function is internally used by <code>SailoR.Indices()</code> and external users are not expected to use it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UVError(U, V, Ensembles = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UVError_+3A_u">U</code></td>
<td>

<p>a vector including the zonal and meridional components of the reference dataset.</p>
</td></tr>
<tr><td><code id="UVError_+3A_v">V</code></td>
<td>

<p>a vector including the zonal and meridional components of the model being compared.</p>
</td></tr>
<tr><td><code id="UVError_+3A_ensembles">Ensembles</code></td>
<td>

<p>if <code>Ensembles</code> is set to <code>TRUE</code>, M different models included in the data frame <code>mod</code> will be taken as a single model and the reference model is repeated M times for the calculation of the Sailor diagram. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result is a list with a summary of the statistics obtained:
</p>
<table>
<tr><td><code>meanU</code></td>
<td>
<p>mean of the U dataset.</p>
</td></tr>
<tr><td><code>meanV</code></td>
<td>
<p>mean of the V dataset.</p>
</td></tr>
<tr><td><code>TotVarU</code></td>
<td>
<p>total variance of the U dataset.</p>
</td></tr>
<tr><td><code>TotVarV</code></td>
<td>
<p>total variance of the V dataset.</p>
</td></tr>
<tr><td><code>Eu</code></td>
<td>
<p>EOF matrix for the U dataset.</p>
</td></tr>
<tr><td><code>Ev</code></td>
<td>
<p>EOF matrix for the V dataset.</p>
</td></tr>
<tr><td><code>Rvu</code></td>
<td>
<p>rotation matrix to express Ev as a rotation from Eu.</p>
</td></tr>
<tr><td><code>Sigmau</code></td>
<td>
<p>matrix with standard deviations of U (2x2 matrix).</p>
</td></tr>
<tr><td><code>Sigmav</code></td>
<td>
<p>matrix with standard deviations of V (2x2 matrix).</p>
</td></tr>
<tr><td><code>sdUx</code></td>
<td>
<p>standard deviation of zonal component (U).</p>
</td></tr>
<tr><td><code>sdUy</code></td>
<td>
<p>standard deviation of meridional component (U).</p>
</td></tr>
<tr><td><code>sdVx</code></td>
<td>
<p>standard deviation of zonal component (V).</p>
</td></tr>
<tr><td><code>sdVy</code></td>
<td>
<p>standard deviation of meridional component (V).</p>
</td></tr>
<tr><td><code>thetau</code></td>
<td>
<p>angle of EOF1 (U) with zonal axis.</p>
</td></tr>
<tr><td><code>thetav</code></td>
<td>
<p>angle of EOF1 (V) with meridional axis.</p>
</td></tr>
<tr><td><code>thetavu</code></td>
<td>
<p>rotation angle from U EOFs to V EOFs.</p>
</td></tr>
<tr><td><code>RMSE</code></td>
<td>
<p>root mean square error between U and V.</p>
</td></tr>
<tr><td><code>R2vec</code></td>
<td>
<p>vector correlation squared in 2D as defined by Breaker, Gemmill and Crossby (1994).</p>
</td></tr>
<tr><td><code>EccentricityU</code></td>
<td>
<p>eccentricity of the ellipses from the reference dataset.</p>
</td></tr>
<tr><td><code>EccentricityV</code></td>
<td>
<p>eccentricity of the ellipses from the model dataset.</p>
</td></tr>
<tr><td><code>congruenceEOF</code></td>
<td>
<p>congruence coefficients (absolute value) for EOFs.</p>
</td></tr>
</table>


<h3>References</h3>

<p>L. C. Breaker, W. H. Gemmill, and D. S. Crosby (1994). The application of a technique for vector correlation to problems in meteorology and oceanography. Journal of Applied Meteorology, 33(11), 1354-1365.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SailoR.Indices">SailoR.Indices</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># No examples are given as external users are not expected to use it
</code></pre>

<hr>
<h2 id='WRF'>
Vertically Integrated Water Vapor Transport Data
</h2><span id='topic+WRF'></span>

<h3>Description</h3>

<p>Contains the information of both components of the vertically integrated water vapor transports calculated over A Coruña (43.6 ºN, -8.41 ºE) in the Iberian Peninsula. This quantity is obtained after integrating the product of moisture and both components of wind across the whole vertical dimension of the atmosphere. To do so, moisture and wind components measured by radiosondes were retrieved from the server of the University of Wyoming, and used for its calculation. Data from two WRF downscaling experiments (including the 3DVAR data assimilation every 3 hours - D experiment, and not including it - N experiment) and ERA-Interim data were also used for its calculation. In these cases, only the closest spatial grid points to the station in the gridded products are considered. 12-hourly data from period 2010-2014 are included with missing soundings removed (González-Rojí et al., 2018 and 2019). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("WRF")</code></pre>


<h3>Format</h3>

<p>A list with two data frames:
</p>

<dl>
<dt><code>ref</code></dt><dd><p>a data frame including the vertically integrated water vapor transports calculated by means of radiosonde data.</p>
</dd>
<dt><code>mod</code></dt><dd><p>a data frame including the data from gridded datasets.</p>
</dd>
</dl>
 
<p>Each of these data frames includes 4 variables:
</p>

<dl>
<dt><code>date</code></dt><dd><p>date information.</p>
</dd>
<dt><code>mod</code></dt><dd><p>a factor defining if the values were calculated by means of reanalysis ERA-Interim data (ERAI) or data from WRF downscaling experiments (WrfD or WrfN).</p>
</dd>
<dt><code>U</code></dt><dd><p>zonal component of vertically integrated water vapor transport (kg/m/s).</p>
</dd>
<dt><code>V</code></dt><dd><p>meridional component of vertically integrated water vapor transport (kg/m/s).</p>
</dd>
</dl>
  


<h3>Source</h3>

<p>Both downscaling experiments were created by the authors in previous studies. ERA-Interim were retrieved from the MARS repository at ECMWF.  
</p>


<h3>References</h3>

<p>S. J. González-Rojí, J. Sáenz, G. Ibarra-Berastegi and J. Díaz-Argandoña (2018) Moisture balance over the Iberian Peninsula according to a regional climate model. The impact of 3DVAR data assimilation. Journal of Geophysical Research-Atmospheres, 123:708-729, doi: <a href="https://doi.org/10.1002/2017JD027511">https://doi.org/10.1002/2017JD027511</a>
</p>
<p>S. J. González-Rojí, R. L. Wilby, J. Sáenz and G. Ibarra-Berastegi (2019) Harmonized evaluation of daily precipitation downscaled using SDSM and WRF+WRFDA models over the Iberian Peninsula Climate Dynamics, 53:1413-1433, doi: <a href="https://doi.org/10.1007/s00382-019-04673-9">https://doi.org/10.1007/s00382-019-04673-9</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------
# Example 1: Figure 6 (right) from Sáenz et al. (2020)
#--------------------------------------------------------

# Load the data
data("WRF")

# Parameters
Uxlim=c(60,110)
Uylim=c(0,50)
Uxlab&lt;-"Qx (kg/m/s)"
Uylab&lt;-"Qy (kg/m/s)"
plotmain&lt;-"Water vapour transport"
sfactor&lt;-0.1
ref&lt;-WRF[["ref"]][,c("mod","U","V")]
mod&lt;-WRF[["mod"]][,c("mod","U","V")]

isBad=((is.na(ref$U)) |(is.na(ref$V)))
isOK=(!isBad)
ref&lt;-ref[isOK,]

nmod1&lt;-which(mod$mod=="WrfN")
mod1&lt;-mod[nmod1,][isOK,]
nmod2&lt;-which(mod$mod=="WrfD")
mod2&lt;-mod[nmod2,][isOK,]
nmod3&lt;-which(mod$mod=="ERAI")
mod3&lt;-mod[nmod3,][isOK,]

mod&lt;-rbind(mod1,mod2,mod3)

# Index
sIWRF=SailoR.Indices(ref,mod)

# Index table
sIWRF.table&lt;-SailoR.Table(sIWRF)

# plot
      
SailoR.Plot(ref, mod, ColourList=NULL, sfactor, docenter=TRUE,
            Uxlim, Uylim, Uxlab, Uylab, plotmain, plotlegend=TRUE,
            plotRMSElegend=TRUE, plotscalelegend=TRUE,
            RMSE_legend_Rounding=0, RMSE_legend_units = " kg/m/s",
            referenceName="Sounding")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
