<!DOCTYPE html><html><head><title>Help for package DTComPair</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DTComPair}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DTComPair-package'><p>Comparison of Binary Diagnostic Tests in a Paired Study Design</p></a></li>
<li><a href='#acc.1test'><p>Accuracy of a Single Binary Diagnostic Test</p></a></li>
<li><a href='#acc.paired'><p>Accuracy of Two Binary Diagnostic Tests in a Paired Study Design</p></a></li>
<li><a href='#DLR'><p>Estimating the Capacity for Improvement in Diagnostic Risk Prediction with an additional marker based on the Diagnostic Likelihood Ratio (DLR)</p></a></li>
<li><a href='#dlr.regtest'><p>Differences in Diagnostic Likelihood Ratios</p></a></li>
<li><a href='#ellipse.pv.rpv'><p>Elliptical joint confidence region for relative positive and</p>
negative predictive value</a></li>
<li><a href='#generate.paired'><p>Generate Dataset from &ldquo;tab.paired&rdquo;-Object</p></a></li>
<li><a href='#Paired1'><p>DTComPair-dataset 1</p></a></li>
<li><a href='#print.acc.1test'><p>Print &ldquo;acc.1test&rdquo;-Object</p></a></li>
<li><a href='#print.acc.paired'><p>Print &ldquo;acc.paired&rdquo;-Object</p></a></li>
<li><a href='#print.tab.1test'><p>Print &ldquo;tab.1test&rdquo;-Object</p></a></li>
<li><a href='#print.tab.paired'><p>Print &ldquo;tab.paired&rdquo;-Object</p></a></li>
<li><a href='#pv.gs'><p>Generalized Score Statistic for Comparison of Predictive Values</p></a></li>
<li><a href='#pv.prev'><p>Compute predictive values for theoretical prevalences</p></a></li>
<li><a href='#pv.rpv'><p>Comparison of Predictive Values using Relative Predictive Values</p></a></li>
<li><a href='#pv.wgs'><p>Weighted Generalized Score Statistic for Comparison of Predictive Values</p></a></li>
<li><a href='#read.tab.1test'><p>Read in &ldquo;tab.1test&rdquo;-Objects</p></a></li>
<li><a href='#read.tab.paired'><p>Read in &ldquo;tab.paired&rdquo;-Objects</p></a></li>
<li><a href='#represent.long'><p>Long Representation of Results from Two Binary Diagnostic Tests</p></a></li>
<li><a href='#sesp.diff.ci'><p>Confidence Intervals for Differences in Sensitivity and Specificity</p></a></li>
<li><a href='#sesp.exactbinom'><p>Exact Binomial Test for Differences in Sensitivity and Specificity</p></a></li>
<li><a href='#sesp.gen.mcnemar'><p>Generalized McNemar's test</p></a></li>
<li><a href='#sesp.mcnemar'><p>McNemar Test for Comparison of Sensitivities and Specificities</p></a></li>
<li><a href='#sesp.rel'><p>Comparison of the accuracy of two tests using relative sensitivity and specificity</p></a></li>
<li><a href='#tab.1test'><p>Tabulate Single Binary Diagnostic Test vs. Gold-Standard</p></a></li>
<li><a href='#tab.paired'><p>Tabulate Results from Two Binary Diagnostic Tests in a Paired Study Design</p></a></li>
<li><a href='#tpffpf.rel'><p>Comparison of the accuracy of two tests using relative true positive and false positive fraction</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Comparison of Binary Diagnostic Tests in a Paired Study Design</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Comparison of the accuracy of two binary diagnostic tests in a "paired" study design, i.e. when each test is applied to each subject in the study.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/chstock/DTComPair">https://github.com/chstock/DTComPair</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/chstock/DTComPair/issues">https://github.com/chstock/DTComPair/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>gee, ellipse</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), PropCIs</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-20 13:38:35 UTC; stockch</td>
</tr>
<tr>
<td>Author:</td>
<td>Christian Stock <a href="https://orcid.org/0000-0002-3493-3234"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Thomas Hielscher [aut],
  Andrea Discacciati [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christian Stock &lt;christian.stock@boehringer-ingelheim.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-20 15:32:32 UTC</td>
</tr>
</table>
<hr>
<h2 id='DTComPair-package'>Comparison of Binary Diagnostic Tests in a Paired Study Design</h2><span id='topic+DTComPair-package'></span><span id='topic+DTComPair'></span>

<h3>Description</h3>

<p>Comparison of the accuracy of two binary diagnostic tests in a &ldquo;paired&rdquo; study design, i.e. when each test is applied to each subject in the study. 
</p>


<h3>Details</h3>

<p>The accuracy measures that can be compared in the present version are sensitivity, specificity, positive and negative predictive values, and positive and negative diagnostic likelihood ratios.  
</p>
<p>It is required that results from a binary gold-standard test are also available. 
</p>
<p>Methods for comparison of sensitivity and specificity: McNemar test (McNemar, 1947) and exact binomial test. Further, several methods to compute confidence intervals for differences in sensitivity and specificity are implemented.
</p>
<p>Methods for comparison of positive and negative predictive values: generalized score statistic (Leisenring, Alonzo and Pepe, 2000), weighted generalized score statistic (Kosinski, 2013) and comparison of relative predictive values (Moskowitz and Pepe, 2006).
</p>
<p>Methods for comparison of positive and negative diagnostic likelihood ratios: a regression model approach (Gu and Pepe, 2009).
</p>
<p>For a general introduction into the evaluation of diagnostic tests see e.g. Pepe (2003), Zhou, Obuchowski and McClish (2011).
</p>


<h3>Author(s)</h3>

<p>Christian Stock, Thomas Hielscher and Andrea Discacciati
</p>
<p>Maintainer: Christian Stock &lt;christian.stock@boehringer-ingelheim.com&gt;
</p>


<h3>References</h3>

<p>Gu and Pepe (2009), &quot;Estimating the capacity for improvement in risk prediction with a marker&quot;, &lt;doi:10.1093/biostatistics/kxn025&gt;. 
</p>
<p>Kosinski (2013), &quot;A weighted generalized score statistic for comparison of predictive values of diagnostic tests&quot;, &lt;doi:10.1002/sim.5587&gt;.
</p>
<p>Leisenring, Alonzo and Pepe (2000), &quot;Comparisons of predictive values of binary medical diagnostic tests for paired designs&quot;, &lt;doi:10.1111/j.0006-341X.2000.00345.x&gt;.
</p>
<p>McNemar (1947), &quot;Note on the sampling error of the difference between correlated proportions or percentages&quot;,  &lt;doi:10.1007/BF02295996&gt;.
</p>
<p>Moskowitz and Pepe (2006), &quot;Comparing the predictive values of diagnostic tests: sample size and analysis for paired study designs&quot;, &lt;doi:10.1191/1740774506cn147oa&gt;.
</p>
<p>Pepe (2003, ISBN:978-0198509844), &quot;The statistical evaluation of medical tests for classifcation and prediction&quot;.
</p>
<p>Zhou, Obuchowski and McClish (2011), &quot;Statistical Methods in Diagnostic Medicine&quot;, &lt;doi:10.1002/9780470906514&gt;.
</p>


<h3>See Also</h3>

<p>Data management functions: <code><a href="#topic+tab.1test">tab.1test</a></code>, <code><a href="#topic+tab.paired">tab.paired</a></code>, <code><a href="#topic+read.tab.paired">read.tab.paired</a></code>, <code><a href="#topic+generate.paired">generate.paired</a></code> and <code><a href="#topic+represent.long">represent.long</a></code>.
</p>
<p>Computation of standard accuracy measures for a single test: <code><a href="#topic+acc.1test">acc.1test</a></code> and <code><a href="#topic+acc.paired">acc.paired</a></code>.
</p>
<p>Comparison of sensitivity and specificity: <code><a href="#topic+sesp.mcnemar">sesp.mcnemar</a></code>, <code><a href="#topic+sesp.exactbinom">sesp.exactbinom</a></code> and <code><a href="#topic+sesp.diff.ci">sesp.diff.ci</a></code>.
</p>
<p>Comparison of positive and negative predictive values: <code><a href="#topic+pv.gs">pv.gs</a></code>, <code><a href="#topic+pv.wgs">pv.wgs</a></code> and <code><a href="#topic+pv.rpv">pv.rpv</a></code>.
</p>
<p>Comparison of positive and negative diagnostic likelihood ratios: <code><a href="#topic+dlr.regtest">dlr.regtest</a></code> and <code><a href="#topic+DLR">DLR</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
hsd &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
acc.paired(hsd)
sesp.mcnemar(hsd)
pv.rpv(hsd)
dlr.regtest(hsd)
</code></pre>

<hr>
<h2 id='acc.1test'>Accuracy of a Single Binary Diagnostic Test</h2><span id='topic+acc.1test'></span>

<h3>Description</h3>

<p>Sensitivity and specificity, (positive and negative) predictive values and (positive and negative) diagnostic likelihood ratios of a single binary diagnostic test.</p>


<h3>Usage</h3>

<pre><code class='language-R'>acc.1test(tab, alpha, testname, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acc.1test_+3A_tab">tab</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.1test">tab.1test</a></code>.
</p>
</td></tr>
<tr><td><code id="acc.1test_+3A_alpha">alpha</code></td>
<td>
<p>Significance level alpha for 100(1-alpha)%-confidence intervals, the default is 0.05.
</p>
</td></tr>
<tr><td><code id="acc.1test_+3A_testname">testname</code></td>
<td>
<p>A character variable containing the name of the diagnostic test. 
</p>
</td></tr>
<tr><td><code id="acc.1test_+3A_...">...</code></td>
<td>
<p>Additional arguments (usually not required).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculation of accuracy measures and their variances follows standard methodology, e.g. described in Pepe (2003) or Zhou et al. (2011). Confidence intervals for diagnostic likelihood ratios are computed according to Simel et al. (1991).
</p>


<h3>Value</h3>

<p>A list of class <code><a href="#topic+acc.1test">acc.1test</a></code>:
</p>
<table>
<tr><td><code>tab</code></td>
<td>
<p>A contingency table (matrix) of test results; the same <code>tab</code> that is supplied as an argument. 
</p>

<table>
<tr>
 <td style="text-align: left;">
          </td><td style="text-align: right;"> Diseased </td><td style="text-align: right;"> Non-diseased </td><td style="text-align: right;"> Total </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test pos. </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test neg. </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... </td>
</tr>
<tr>
 <td style="text-align: left;">
 Total     </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... 
 </td>
</tr>

</table>

</td></tr> 
<tr><td><code>sensitivity</code></td>
<td>
<p>A numeric vector containing the estimated sensitivity (<code>est</code>), its standard error (<code>se</code>), lower confidence limit (<code>lcl</code>) and upper confidence limit (<code>ucl</code>).</p>
</td></tr>
<tr><td><code>specificity</code></td>
<td>
<p>A numeric vector containing the estimated specificity (<code>est</code>), its standard error (<code>se</code>), lower confidence limit (<code>lcl</code>) and upper confidence limit (<code>ucl</code>).</p>
</td></tr>
<tr><td><code>ppv</code></td>
<td>
<p>A numeric vector containing the estimated positive predictive value (<code>est</code>), its standard error (<code>se</code>), lower confidence limit (<code>lcl</code>) and upper confidence limit (<code>ucl</code>).</p>
</td></tr>
<tr><td><code>npv</code></td>
<td>
<p>A numeric vector containing the estimated negative predictive value (<code>est</code>), its standard error (<code>se</code>), lower confidence limit (<code>lcl</code>) and upper confidence limit (<code>ucl</code>).</p>
</td></tr>
<tr><td><code>pdlr</code></td>
<td>
<p>A numeric vector containing the estimated positive diagnostic likelihood ratio (<code>est</code>), the standard error of the logarithm of the positive diagnostic likelihood ratio (<code>se.ln</code>), the lower confidence limit (<code>lcl</code>) and the upper confidence limit (<code>ucl</code>).</p>
</td></tr>
<tr><td><code>ndlr</code></td>
<td>
<p>A numeric vector containing the estimated negative diagnostic likelihood ratio (<code>est</code>), the standard error of the logarithm of the negative diagnostic likelihood ratio (<code>se.ln</code>), the lower confidence limit (<code>lcl</code>) and the upper confidence limit (<code>ucl</code>).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The significance level alpha used to compute 100(1-alpha)%-confidence intervals, the default is 0.05.</p>
</td></tr>
<tr><td><code>testname</code></td>
<td>
<p>A character variable containing the name of the diagnostic test. </p>
</td></tr>
</table>


<h3>References</h3>

<p>Pepe, M. (2003). The statistical evaluation of medical tests for classifcation and prediction. Oxford Statistical Science Series. Oxford University Press, 1st edition.
</p>
<p>Simel, D.L., Samsa, G.P., Matchar, D.B. (1991). Likelihood ratios with confidence: sample size estimation for diagnostic test
studies. <em>J Clin Epidemiol</em>, 44(8):763-70.
</p>
<p>Zhou, X., Obuchowski, N., and McClish, D. (2011). Statistical Methods in Diagnostic Medicine. Wiley Series in Probability and Statistics. John Wiley &amp; Sons, Hoboken, New Jersey, 2nd edition.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tab.1test">tab.1test</a></code>,
<code><a href="#topic+print.acc.1test">print.acc.1test</a></code>,
<code><a href="#topic+acc.paired">acc.paired</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
a1 &lt;- tab.1test(d=d, y=y1, data=Paired1)
a2 &lt;- acc.1test(a1)
print(a2)
</code></pre>

<hr>
<h2 id='acc.paired'>Accuracy of Two Binary Diagnostic Tests in a Paired Study Design</h2><span id='topic+acc.paired'></span>

<h3>Description</h3>

<p>Sensitivity and specificity, (positive and negative) predictive values and (positive and negative) diagnostic likelihood ratios of a two binary diagnostic tests in a paired study design.</p>


<h3>Usage</h3>

<pre><code class='language-R'>acc.paired(tab, alpha, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acc.paired_+3A_tab">tab</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>
</td></tr>
<tr><td><code id="acc.paired_+3A_alpha">alpha</code></td>
<td>
<p>Significance level alpha for 100(1-alpha)%-confidence intervals, the default is 0.05.
</p>
</td></tr>
<tr><td><code id="acc.paired_+3A_...">...</code></td>
<td>
<p>Additional arguments, usually not required.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculation of accuracy measures and their variances follows standard methodology, e.g. described in Pepe (2003) or Zhou et al. (2011).
</p>


<h3>Value</h3>

<p>An list of class <code><a href="#topic+acc.paired">acc.paired</a></code>:
</p>
<table>
<tr><td><code>Test1</code></td>
<td>
<p>A list of class <code><a href="#topic+acc.1test">acc.1test</a></code> containing results and accuracy estimates of Test 1.</p>
</td></tr>
<tr><td><code>Test2</code></td>
<td>
<p>A list of class <code><a href="#topic+acc.1test">acc.1test</a></code> containing results and accuracy estimates of Test 2.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pepe, M. (2003). The statistical evaluation of medical tests for classifcation and prediction. Oxford Statistical Science Series. Oxford University Press, 1st edition.
</p>
<p>Zhou, X., Obuchowski, N., and McClish, D. (2011). Statistical Methods in Diagnostic Medicine. Wiley Series in Probability and Statistics. John Wiley &amp; Sons, Hoboken, New Jersey, 2nd edition.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tab.paired">tab.paired</a></code>,
<code><a href="#topic+print.acc.paired">print.acc.paired</a></code>,
<code><a href="#topic+acc.1test">acc.1test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
b1 &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
b2 &lt;- acc.paired(b1)
print(b2)
</code></pre>

<hr>
<h2 id='DLR'>Estimating the Capacity for Improvement in Diagnostic Risk Prediction with an additional marker based on the Diagnostic Likelihood Ratio (DLR)</h2><span id='topic+DLR'></span>

<h3>Description</h3>

<p>This function allows for estimating the log diagnostic likelihood ratio in a regression model approach. 
It can be used to assess the gain in diagnostic accuracy for a new binary or continuous diagnostic marker compared
to established markers, to determine the impact of covariates on the risk prediction model, and to estimate the
DLR for selected marker/covariate values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DLR(basemodel, augmentedmodel, diseasestatus, dataset, clustervar = NULL, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DLR_+3A_basemodel">basemodel</code></td>
<td>
<p>pre-test/base model X, formula character string</p>
</td></tr>
<tr><td><code id="DLR_+3A_augmentedmodel">augmentedmodel</code></td>
<td>
<p>post-test/ augmented model V, formula character string,
this is usually the basemodel X including the additional diagnostic test of interest Y and interactions XY</p>
</td></tr>
<tr><td><code id="DLR_+3A_diseasestatus">diseasestatus</code></td>
<td>
<p>variable name containing disease status, assumed to be a 0/1 variable, for having condition of interest (1) or not (0), character string</p>
</td></tr>
<tr><td><code id="DLR_+3A_dataset">dataset</code></td>
<td>
<p>dataframe, needs to be in wide format with one observation per subject</p>
</td></tr>
<tr><td><code id="DLR_+3A_clustervar">clustervar</code></td>
<td>
<p>optional, cluster variable name in dataset, character string</p>
</td></tr>
<tr><td><code id="DLR_+3A_alpha">alpha</code></td>
<td>
<p>significance level alpha used for confidence intervals, the default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an implementation of the algorithm described in the appendix of Gu and Pepe (2009) using the GEE approach in order to get standard error estimates. The definition of I and Zero matrices is slightly more flexible than the ones described in section 3 in order to allow for models without interaction. 
</p>


<h3>Value</h3>

<p>Returns a list including
</p>
<table>
<tr><td><code>logPreTestModel</code></td>
<td>
<p>logistic regression model output for prior disease using base model X: P(D=1|X). All estimates are on a log scale.</p>
</td></tr>
<tr><td><code>logPostTestModel</code></td>
<td>
<p>logistic regression model output for posterior disease using augmented model V: P(D=1|X,Y),i.e. P(D=1|V). All estimates are on a log scale.</p>
</td></tr>
<tr><td><code>logDLRModel</code></td>
<td>
<p>regression model output for log DLR defined as difference between logPostTestModel and logPreTestModel. All estimates are on a log scale.</p>
</td></tr>
<tr><td><code>DLR</code></td>
<td>
<p>Positive/negative DLR for diagnostic marker Y, with all base covariates X set to 1. Results are only sensible for binary marker Y taking values 0/1.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Hielscher (t.hielscher@dkfz.de) 
</p>


<h3>References</h3>

<p>Gu, W. and Pepe, M. S. (2009). Estimating the capacity for improvement in risk prediction with a marker. <em>Biostatistics</em>, 10(1):172-86.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dlr.regtest">dlr.regtest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(DTComPair)
data(Paired1)

# test y1 conditioned on null model: DLR+(Y1=1) and DLR-(Y1=0)

DLR("~ 1","~ y1","d",Paired1)

# test y1 conditioned on test y2 with interaction, DLR+(Y1=1|Y2=1) and DLR-(Y1=0|Y2=1)

DLR("~ y2","~ y2 * y1","d",Paired1) 
</code></pre>

<hr>
<h2 id='dlr.regtest'>Differences in Diagnostic Likelihood Ratios</h2><span id='topic+dlr.regtest'></span>

<h3>Description</h3>

<p>Performs a test for differences in (positive and negative) diagnostic likelihood ratios (DLRs) of two binary diagnostic tests in a paired study using a regression model approach proposed by Gu and Pepe (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlr.regtest(tab, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dlr.regtest_+3A_tab">tab</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>
</td></tr>
<tr><td><code id="dlr.regtest_+3A_alpha">alpha</code></td>
<td>
<p>Significance level alpha for 100(1-alpha)%-confidence intervals, the default is 0.05.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis rDLR = DLR of Test 1 / DLR of Test 2 = 1 is tested with respect to both positive and negative DLRs of the two diagnostic tests.
</p>
<p>This function calls <code><a href="#topic+DLR">DLR</a></code>, a general implementation of the method proposed by Gu and Pepe (2009).
</p>


<h3>Value</h3>

<p>A list containing 
</p>
<table>
<tr><td><code>pdlr</code></td>
<td>

<p>A list with 
<code>test1</code> (the positive DLR of test 1),
<code>test2</code> (the positive DLR of test 2), 
<code>ratio</code> (the ratio of positive DLRs, computed as <code>test1/test2</code>, 
<code>se.log</code> (the standard error of the logarithm of <code>ratio</code>),
the <code>test.statistic</code> and the corresponding <code>p.value</code>.
</p>
</td></tr>
<tr><td><code>ndlr</code></td>
<td>

<p>A list with 
<code>test1</code> (the negative DLR of test 1),
<code>test2</code> (the negative DLR of test 2), 
<code>ratio</code> (the ratio of negative DLRs, computed as <code>test1/test2</code>, 
<code>se.log</code> (the standard error of the logarithm of <code>ratio</code>),
the <code>test.statistic</code> and the corresponding <code>p.value</code>.
</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The significance level alpha used to compute 100(1-alpha)%-confidence intervals for the <code>ratio</code> of positive and negative DLRs, the default is 0.05.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The name of the method used to compare the positive and negative DLRs, here &ldquo;diagnostic likelihood regression model (regtest)&rdquo;.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gu, W. and Pepe, M. S. (2009). Estimating the capacity for improvement in risk prediction with a marker. <em>Biostatistics</em>, 10(1):172-86.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DLR">DLR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data
ptab &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
ptab
dlr.results &lt;- dlr.regtest(ptab)
str(dlr.results)
dlr.results
</code></pre>

<hr>
<h2 id='ellipse.pv.rpv'>Elliptical joint confidence region for relative positive and
negative predictive value</h2><span id='topic+ellipse.pv.rpv'></span>

<h3>Description</h3>

<p>Returns a 100(1-alpha)% elliptical joint confidence region for the parameter
vector {log(relative positive predictive value), log(relative negative predictive value)}.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellipse.pv.rpv(x, alpha = 0.05, npoints = 100, exponentiate = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipse.pv.rpv_+3A_x">x</code></td>
<td>
<p>an object returned by the <code>pv.rpv</code> function.</p>
</td></tr>
<tr><td><code id="ellipse.pv.rpv_+3A_alpha">alpha</code></td>
<td>
<p>significance level alpha used to compute the 100(1-alpha)% region. The default is 0.05, for a 95% region.</p>
</td></tr>
<tr><td><code id="ellipse.pv.rpv_+3A_npoints">npoints</code></td>
<td>
<p>the number of points used in the ellipse. Default is 100.</p>
</td></tr>
<tr><td><code id="ellipse.pv.rpv_+3A_exponentiate">exponentiate</code></td>
<td>
<p>a logical value indicating whether or not to exponentiate the values for the centre
of the ellipse and for the the ellipsoidal outline. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>centre</code></td>
<td>
<p>the centre of the ellipse.</p>
</td></tr>
<tr><td><code>ellipse</code></td>
<td>
<p>an <code>npoints</code> x 2 matrix with the x and y coordinates for
the ellipsoidal outline. Suitable for <code>plot</code>-ing.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Moskowitz, C.S., and Pepe, M.S. (2006). Comparing the predictive values of diagnostic tests: sample size and analysis for paired study designs. <em>Clin Trials</em>, 3(3):272-9.
</p>


<h3>See Also</h3>

<p><code>pv.rpv</code> and <code>ellipse::ellipse</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data
ftable(Paired1)
paired.layout &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
paired.layout 
rpv.results &lt;- pv.rpv(paired.layout)
ellipse.data &lt;- ellipse.pv.rpv(rpv.results)
if(interactive()){
  plot(ellipse.data$ellipse, type = "l", ylim = c(-0.4, 0.2), xlim = c(-0.2, 0.2))
  points(ellipse.data$centre[1], ellipse.data$centre[2], col = "red", pch = 19)
  abline(h = 0, v = 0, lty = 3)
}

</code></pre>

<hr>
<h2 id='generate.paired'>Generate Dataset from &ldquo;tab.paired&rdquo;-Object</h2><span id='topic+generate.paired'></span>

<h3>Description</h3>

<p>Generates a dataset from contingency tables of binary diagnostic test results in a paired study design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate.paired(tab, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate.paired_+3A_tab">tab</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.paired">tab.paired</a></code>.  
</p>
</td></tr>
<tr><td><code id="generate.paired_+3A_...">...</code></td>
<td>
<p>Additional arguments (usually not required).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing:
</p>
<table>
<tr><td><code>d</code></td>
<td>
<p>A numeric vector specifying the gold-standard results (1 = presence of disease, 0 = absence of disease).
</p>
</td></tr>
<tr><td><code>y1</code></td>
<td>
<p>A numeric vector specifying the results of diagnostic test 1 (1 = positive, 0 = negative).
</p>
</td></tr>
<tr><td><code>y2</code></td>
<td>
<p>A numeric vector specifying the results of diagnostic test 2 (1 = positive, 0 = negative).
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+tab.paired">tab.paired</a></code> and <code><a href="#topic+read.tab.paired">read.tab.paired</a></code>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data
ftable(Paired1)
paired.layout &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
new.df &lt;- generate.paired(paired.layout)
head(new.df)
ftable(new.df)
</code></pre>

<hr>
<h2 id='Paired1'>DTComPair-dataset 1</h2><span id='topic+Paired1'></span>

<h3>Description</h3>

<p>Hypothetical data from a paired study that aims to compare the accuracy of two binary diagnostic tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Paired1</code></pre>


<h3>Format</h3>

<p>A dataframe containing 3 columns (<code>d</code>, <code>y1</code> and <code>y2</code>) and 712 rows.
</p>
<p><code>d</code> is a numeric vector specifying the gold-standard results (1 = presence of disease, 0 = absence of disease).
</p>
<p><code>y1</code> is a numeric vector specifying the results of diagnostic test 1 (1 = positive, 0 = negative).
</p>
<p><code>y2</code> is a numeric vector specifying the results of diagnostic test 1 (1 = positive, 0 = negative).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
ftable(Paired1)
</code></pre>

<hr>
<h2 id='print.acc.1test'>Print &ldquo;acc.1test&rdquo;-Object</h2><span id='topic+print.acc.1test'></span>

<h3>Description</h3>

<p>Prints objects of class <code><a href="#topic+acc.1test">acc.1test</a></code> in an easy-to-read form (S3method).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'acc.1test'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.acc.1test_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+acc.1test">acc.1test</a></code>.
</p>
</td></tr>
<tr><td><code id="print.acc.1test_+3A_...">...</code></td>
<td>
<p>Additional arguments (usually not required).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates a list object from parts of its input that is then printed in a tabular layout.</p>


<h3>See Also</h3>

<p><code><a href="#topic+acc.1test">acc.1test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
a1 &lt;- tab.1test(d=d, y=y1, data=Paired1)
a2 &lt;- acc.1test(a1)
print(a2)
</code></pre>

<hr>
<h2 id='print.acc.paired'>Print &ldquo;acc.paired&rdquo;-Object</h2><span id='topic+print.acc.paired'></span>

<h3>Description</h3>

<p>Prints objects of class <code><a href="#topic+acc.paired">acc.paired</a></code> in an easy-to-read form (S3method).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'acc.paired'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.acc.paired_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+acc.paired">acc.paired</a></code>.
</p>
</td></tr>
<tr><td><code id="print.acc.paired_+3A_...">...</code></td>
<td>
<p>Additional arguments (usually not required).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates a list object from parts of its input that is then printed in a tabular layout.</p>


<h3>See Also</h3>

<p><code><a href="#topic+acc.paired">acc.paired</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
b1 &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
b2 &lt;- acc.paired(b1)
print(b2)
</code></pre>

<hr>
<h2 id='print.tab.1test'>Print &ldquo;tab.1test&rdquo;-Object</h2><span id='topic+print.tab.1test'></span>

<h3>Description</h3>

<p>Prints objects of class <code><a href="#topic+tab.1test">tab.1test</a></code> in an easy-to-read form (S3method).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tab.1test'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.tab.1test_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.1test">tab.1test</a></code>.
</p>
</td></tr>
<tr><td><code id="print.tab.1test_+3A_...">...</code></td>
<td>
<p>Additional arguments (usually not required).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates a list object from parts of its input that is then printed in a tabular layout.</p>


<h3>See Also</h3>

<p><code><a href="#topic+tab.1test">tab.1test</a></code>,
<code><a href="#topic+acc.1test">acc.1test</a></code>,
<code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
a &lt;- tab.1test(d=d, y=y1, data=Paired1)
print(a)
</code></pre>

<hr>
<h2 id='print.tab.paired'>Print &ldquo;tab.paired&rdquo;-Object</h2><span id='topic+print.tab.paired'></span>

<h3>Description</h3>

<p>Prints objects of class <code><a href="#topic+tab.paired">tab.paired</a></code> in an easy-to-read form (S3method).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tab.paired'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.tab.paired_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>
</td></tr>
<tr><td><code id="print.tab.paired_+3A_...">...</code></td>
<td>
<p>Additional arguments (usually not required).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates a list object from parts of its input that is then printed in a tabular layout.</p>


<h3>See Also</h3>

<p><code><a href="#topic+tab.paired">tab.paired</a></code>,
<code><a href="#topic+acc.paired">acc.paired</a></code>,
<code><a href="#topic+tab.1test">tab.1test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
b &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
print(b)
</code></pre>

<hr>
<h2 id='pv.gs'>Generalized Score Statistic for Comparison of Predictive Values</h2><span id='topic+pv.gs'></span>

<h3>Description</h3>

<p>Performs a test for differences in (positive and negative) predictive values of two binary diagnostic tests using a generalized score statistic proposed by Leisenring, Alonzo and Pepe (2000).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pv.gs(tab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pv.gs_+3A_tab">tab</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>ppv</code></td>
<td>
<p>A list with <code>test1</code> (the positive predictive value of test 1), <code>test2</code> (the positive predictive value of test 2), <code>diff</code> (the difference in positive predictive values, computed as <code>test2 - test1</code>), the <code>test.statistic</code> and the corresponding <code>p.value</code>. </p>
</td></tr>
<tr><td><code>npv</code></td>
<td>
<p>A list with <code>test1</code> (the negative predictive value of test 1), <code>test2</code> (the negative predictive value of test 2), <code>diff</code> (the difference in negative predictive values, computed as <code>test2 - test1</code>), the <code>test.statistic</code> and the corresponding <code>p.value</code>. </p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The name of the method used to compare predictive values, here &ldquo;generalized score statistic (gs)&rdquo;. </p>
</td></tr>
</table>


<h3>References</h3>

<p>Leisenring, W., Alonzo, T., and Pepe, M. S. (2000). Comparisons of predictive values of binary medical diagnostic tests for paired designs. <em>Biometrics</em>, 56(2):345-51.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pv.wgs">pv.wgs</a></code> and <code><a href="#topic+pv.rpv">pv.rpv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data
ftable(Paired1)
paired.layout &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
paired.layout 
gs.results &lt;- pv.gs(paired.layout)
str(gs.results)
gs.results
gs.results$ppv["p.value"]
</code></pre>

<hr>
<h2 id='pv.prev'>Compute predictive values for theoretical prevalences</h2><span id='topic+pv.prev'></span>

<h3>Description</h3>

<p>It is often of interest to estimate predcitive values assuming the test were applied to a population with a different prevalance of the disease. Projected predictive values may be calculated using Bayes theorem and the relation between predictive values and diganostic likelihood ratios can be used to derived corresponding confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pv.prev(pi, acc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pv.prev_+3A_pi">pi</code></td>
<td>
<p>A theoretical prevalance of the disease (proportion).</p>
</td></tr>
<tr><td><code id="pv.prev_+3A_acc">acc</code></td>
<td>
<p>An object of class 'acc.1test'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Predictive values, assuming a certain prevalance of the disease, 
are derived using the relation between predictive values and diagnostic likelihood ratios:
</p>
<p>- PPV = 1 / 1 + (1 / pi - 1) / pDLR
- NPV = 1 / 1 + (1 / (1 / pi - 1)) / nDLR. 
</p>
<p>See Newcombe RG (2013). Confidence Intervals for Proportions and Related Measures of Effect Size. Chapman and Hall/ CRC Biostatistics Series (chapters 12.3+5 and 14.9).
</p>
<p>The alpha-level of (1-alpha)-confidence intervals is inherited from 'acc.1test'.
</p>


<h3>Value</h3>

<p>A vector containing the projected values.
</p>


<h3>See Also</h3>

<p>[acc.1test()]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
a1 &lt;- tab.1test(d=d, y=y1, data=Paired1)
a2 &lt;- acc.1test(a1, alpha = 0.05)
pv.prev(pi=0.2, acc=a2)
pv.prev(pi=0.5, acc=a2)

</code></pre>

<hr>
<h2 id='pv.rpv'>Comparison of Predictive Values using Relative Predictive Values</h2><span id='topic+pv.rpv'></span>

<h3>Description</h3>

<p>Performs a test for differences in (positive and negative) predictive values of two binary diagnostic tests in a paired study design using relative predictive values, as proposed by Moskowitz and Pepe (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pv.rpv(tab, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pv.rpv_+3A_tab">tab</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.paired">tab.paired</a></code>.</p>
</td></tr>
<tr><td><code id="pv.rpv_+3A_alpha">alpha</code></td>
<td>
<p>Significance level alpha used to compute 100(1-alpha)%-confidence intervals, the default is 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>ppv</code></td>
<td>
<p>named vector containing <code>test1</code> (the positive predictive value of test 1), <code>test2</code> (the positive predictive value of test 2), <code>rppv</code> (the relative positive predictive value, computed as <code>test2 / test1</code>), <code>se.log.rppv</code> (the standard error of the logarithm of <code>rppv</code>),
<code>lcl.rppv</code> (lower confidence limit of <code>rppv</code>), <code>ucl.rppv</code> (the upper confidence limit of <code>rppv</code>), the <code>test.statistic</code> and the corresponding <code>p.value</code>. </p>
</td></tr>
<tr><td><code>npv</code></td>
<td>
<p>named vector containing <code>test1</code> (the negative predictive value of test 1), <code>test2</code> (the negative predictive value of test 2), <code>rnpv</code> (the relative negative predictive value, computed as <code>test2 / test1</code>), <code>se.log.rnpv</code> (the standard error of the logarithm of <code>rnpv</code>),
<code>lcl.rnpv</code> (the lower confidence limit of <code>rnpv</code>), <code>ucl.rnpv</code> (the upper confidence limit of <code>rnpv</code>), the <code>test.statistic</code> and the corresponding <code>p.value</code>. </p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>Estimated variance-covariance matrix for {log(relative positive predictive value), log(relative negative predictive value)}.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Name of the method used to compare predictive values, here &ldquo;relative predictive values (rpv)&rdquo;. </p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Significance level alpha used to compute 100(1-alpha)%-confidence intervals for <code>rppv</code> and <code>rnpv</code>, the default is 0.05.</p>
</td></tr> 
</table>


<h3>References</h3>

<p>Moskowitz, C.S., and Pepe, M.S. (2006). Comparing the predictive values of diagnostic tests: sample size and analysis for paired study designs. <em>Clin Trials</em>, 3(3):272-9.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pv.gs">pv.gs</a></code> and <code><a href="#topic+pv.wgs">pv.wgs</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data
ftable(Paired1)
paired.layout &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
paired.layout 
rpv.results &lt;- pv.rpv(paired.layout)
str(rpv.results)
rpv.results
rpv.results$ppv["p.value"]
</code></pre>

<hr>
<h2 id='pv.wgs'>Weighted Generalized Score Statistic for Comparison of Predictive Values</h2><span id='topic+pv.wgs'></span>

<h3>Description</h3>

<p>Performs a test for differences in (positive and negative) predictive values of two binary diagnostic tests using a weighted generalized score statistic proposed by Kosinski (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pv.wgs(tab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pv.wgs_+3A_tab">tab</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>ppv</code></td>
<td>
<p>A list with <code>test1</code> (the positive predictive value of test 1), <code>test2</code> (the positive predictive value of test 2), <code>diff</code> (the difference in positive predictive values, computed as <code>test2 - test1</code>, the <code>test.statistic</code> and the corresponding <code>p.value</code>. </p>
</td></tr>
<tr><td><code>npv</code></td>
<td>
<p>A list with <code>test1</code> (the negative predictive value of test 1), <code>test2</code> (the negative predictive value of test 2), <code>diff</code> (the difference in negative predictive values, computed as <code>test2 - test1</code>, the <code>test.statistic</code> and the corresponding <code>p.value</code>. </p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The name of the method used to compare predictive values, here &ldquo;weighted generalized score statistic (wgs)&rdquo;. </p>
</td></tr>
</table>


<h3>References</h3>

<p>Kosinski, A.S. (2013). A weighted generalized score statistic for comparison of predictive values of diagnostic tests. <em>Stat Med</em>, 32(6):964-77.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pv.gs">pv.gs</a></code> and <code><a href="#topic+pv.rpv">pv.rpv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data
ftable(Paired1)
paired.layout &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
paired.layout 
wgs.results &lt;- pv.wgs(paired.layout)
str(wgs.results)
wgs.results
wgs.results$ppv["p.value"]
</code></pre>

<hr>
<h2 id='read.tab.1test'>Read in &ldquo;tab.1test&rdquo;-Objects</h2><span id='topic+read.tab.1test'></span>

<h3>Description</h3>

<p>Reads in objects of class <code><a href="#topic+tab.1test">tab.1test</a> using cell frequencies.</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.tab.1test(a, b, c, d, testname, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.tab.1test_+3A_a">a</code></td>
<td>
<p>The number of diseased subjects with a positive test.</p>
</td></tr>
<tr><td><code id="read.tab.1test_+3A_b">b</code></td>
<td>
<p>The number of non-diseased subjects with a positive test.</p>
</td></tr>
<tr><td><code id="read.tab.1test_+3A_c">c</code></td>
<td>
<p>The number of diseased subjects with a negative test.</p>
</td></tr>
<tr><td><code id="read.tab.1test_+3A_d">d</code></td>
<td>
<p>The number of non-diseased subjects with a negative test.</p>
</td></tr>
<tr><td><code id="read.tab.1test_+3A_testname">testname</code></td>
<td>
<p>An optional vector specifying the name of the diagnostic test, e.g. <code>c("Test A")</code>. If not supplied, the corresponding variable name is used as testname.
</p>
</td></tr>
<tr><td><code id="read.tab.1test_+3A_...">...</code></td>
<td>
<p>Additional arguments (usually not required).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of class <code><a href="#topic+tab.1test">tab.1test</a></code> containing:
</p>
<table>
<tr><td><code>tab.1test</code></td>
<td>
<p>A contingency table (matrix) of test results. 
</p>

<table>
<tr>
 <td style="text-align: left;">
          </td><td style="text-align: right;"> Diseased </td><td style="text-align: right;"> Non-diseased </td><td style="text-align: right;"> Total </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test pos. </td><td style="text-align: right;"> <code>a</code> </td><td style="text-align: right;"> <code>b</code>    </td><td style="text-align: right;"> <code>a</code>+<code>b</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test neg. </td><td style="text-align: right;"> <code>c</code> </td><td style="text-align: right;"> <code>d</code>    </td><td style="text-align: right;"> <code>c</code>+<code>d</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
 Total     </td><td style="text-align: right;"> <code>a</code>+<code>c</code> </td><td style="text-align: right;"> <code>b</code>+<code>d</code>  </td><td style="text-align: right;"> <code>a</code>+<code>b</code>+<code>c</code>+<code>d</code> 
 </td>
</tr>

</table>

</td></tr>
<tr><td><code>testname</code></td>
<td>
<p>The name of the diagnostic test.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>Objects of class <code><a href="#topic+tab.1test">tab.1test</a></code> are required as arguments for <code><a href="#topic+acc.1test">acc.1test</a></code>, a function to compute the accuracy of a binary diagnostic test.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tab.1test">tab.1test</a></code>,
<code><a href="#topic+print.tab.1test">print.tab.1test</a></code>, 
<code><a href="#topic+acc.1test">acc.1test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read.t1 &lt;- read.tab.1test(321, 51, 730, 272, testname="Test1")
class(read.t1)
read.t1
acc.1test(read.t1)
</code></pre>

<hr>
<h2 id='read.tab.paired'>Read in &ldquo;tab.paired&rdquo;-Objects</h2><span id='topic+read.tab.paired'></span>

<h3>Description</h3>

<p>Reads in objects of class <code><a href="#topic+tab.paired">tab.paired</a> using cell frequencies.</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.tab.paired(d.a, d.b, d.c, d.d, nd.a, nd.b, nd.c, nd.d, testnames, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.tab.paired_+3A_d.a">d.a</code></td>
<td>
<p>The number of diseased subjects with a positive test 1 and a positive test 2.
</p>
</td></tr>
<tr><td><code id="read.tab.paired_+3A_d.b">d.b</code></td>
<td>
<p>The number of diseased subjects with a negative test 1 and a positive test 2.
</p>
</td></tr>
<tr><td><code id="read.tab.paired_+3A_d.c">d.c</code></td>
<td>
<p>The number of diseased subjects with a positive test 1 and a negative test 2.
</p>
</td></tr>
<tr><td><code id="read.tab.paired_+3A_d.d">d.d</code></td>
<td>
<p>The number of diseased subjects with a negative test 1 and a negative test 2.
</p>
</td></tr>
<tr><td><code id="read.tab.paired_+3A_nd.a">nd.a</code></td>
<td>
<p>The number of non-diseased subjects with a positive test 1 and a positive test 2.
</p>
</td></tr>
<tr><td><code id="read.tab.paired_+3A_nd.b">nd.b</code></td>
<td>
<p>The number of non-diseased subjects with a negative test 1 and a positive test 2.
</p>
</td></tr>
<tr><td><code id="read.tab.paired_+3A_nd.c">nd.c</code></td>
<td>
<p>The number of non-diseased subjects with a positive test 1 and a negative test 2.
</p>
</td></tr>
<tr><td><code id="read.tab.paired_+3A_nd.d">nd.d</code></td>
<td>
<p>The number of non-diseased subjects with a negative test 1 and a negative test 2.
</p>
</td></tr>
<tr><td><code id="read.tab.paired_+3A_testnames">testnames</code></td>
<td>
<p>An optional vector specifying the names of diagnostic test 1 and diagnostic test 2, e.g. <code>c("Test A","Test B")</code>. If not supplied, the variable names are used as testnames.
</p>
</td></tr>
<tr><td><code id="read.tab.paired_+3A_...">...</code></td>
<td>
<p>Additional arguments (usually not required).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of class <code><a href="#topic+tab.paired">tab.paired</a></code> containing:
</p>
<table>
<tr><td><code>diseased</code></td>
<td>
<p>A contingency table (matrix) of test results among <em>diseased</em> subjects.
</p>

<table>
<tr>
 <td style="text-align: left;">
          </td><td style="text-align: right;"> Test1 pos. </td><td style="text-align: right;"> Test1 neg. </td><td style="text-align: right;"> Total </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test 2 pos. </td><td style="text-align: right;"> <code>d.a</code> </td><td style="text-align: right;"> <code>d.b</code>    </td><td style="text-align: right;"> <code>d.a</code>+<code>d.b</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test 2 neg. </td><td style="text-align: right;"> <code>d.c</code> </td><td style="text-align: right;"> <code>d.d</code>    </td><td style="text-align: right;"> <code>d.c</code>+<code>d.d</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
 Total     </td><td style="text-align: right;"> <code>d.a</code>+<code>d.c</code> </td><td style="text-align: right;"> <code>d.b</code>+<code>d.d</code>  </td><td style="text-align: right;"> <code>d.a</code>+<code>d.b</code>+<code>d.c</code>+<code>d.d</code>
</td>
</tr>

</table>
 
</td></tr>
<tr><td><code>non.diseased</code></td>
<td>
<p>A contingency table (matrix) of test results among <em>non-diseased</em> subjects.
</p>

<table>
<tr>
 <td style="text-align: left;">
          </td><td style="text-align: right;"> Test1 pos. </td><td style="text-align: right;"> Test1 neg. </td><td style="text-align: right;"> Total </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test 2 pos. </td><td style="text-align: right;"> <code>nd.a</code> </td><td style="text-align: right;"> <code>nd.b</code>    </td><td style="text-align: right;"> <code>nd.a</code>+<code>nd.b</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test 2 neg. </td><td style="text-align: right;"> <code>nd.c</code> </td><td style="text-align: right;"> <code>nd.d</code>    </td><td style="text-align: right;"> <code>nd.c</code>+<code>nd.d</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
 Total     </td><td style="text-align: right;"> <code>nd.a</code>+<code>nd.c</code> </td><td style="text-align: right;"> <code>nd.b</code>+<code>nd.d</code>  </td><td style="text-align: right;"> <code>nd.a</code>+<code>nd.b</code>+<code>nd.c</code>+<code>nd.d</code>
</td>
</tr>

</table>

</td></tr>
<tr><td><code>testnames</code></td>
<td>
<p>The names of the diagnostic tests.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>Objects of class <code><a href="#topic+tab.paired">tab.paired</a></code> are essential arguments for various functions in the 
<code><a href="#topic+DTComPair">DTComPair</a></code>-package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tab.paired">tab.paired</a></code>,
<code><a href="#topic+print.tab.paired">print.tab.paired</a></code>, 
<code><a href="#topic+acc.paired">acc.paired</a></code>,
<code><a href="#topic+generate.paired">generate.paired</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read.t2 &lt;- read.tab.paired(321, 51, 730, 272, 
                           120, 8, 74, 109,
                           testnames=c("Test A", "Test B"))
class(read.t2)
read.t2
acc.paired(read.t2)
</code></pre>

<hr>
<h2 id='represent.long'>Long Representation of Results from Two Binary Diagnostic Tests</h2><span id='topic+represent.long'></span>

<h3>Description</h3>

<p>Long representation of results from two binary diagnostic tests.</p>


<h3>Usage</h3>

<pre><code class='language-R'>represent.long(d, y1, y2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="represent.long_+3A_d">d</code></td>
<td>
<p>A numeric vector specifying the gold-standard results (1 = presence of disease, 0 = absence of disease).
</p>
</td></tr>
<tr><td><code id="represent.long_+3A_y1">y1</code></td>
<td>
<p>A numeric vector specifying the results of diagnostic test 1 (1 = positive, 0 = negative).
</p>
</td></tr>
<tr><td><code id="represent.long_+3A_y2">y2</code></td>
<td>
<p>An numeric vector specifying the results of diagnostic test 2 (1 = positive, 0 = negative).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes a long representation of data from a &ldquo;paired&rdquo; study of binary diagnostic tests is required, e.g. to run regression analyses.
</p>
<p>In a <em>wide</em> representation each subject has 1 record in the dataset containing <code>d</code>, <code>y1</code> and <code>y2</code>.
</p>
<p>In a <em>long</em> representation each subjects has 2 records in the dataset, one for each test. The data format is shown below.
</p>


<h3>Value</h3>

<p>A dataframe containing:
</p>
<table>
<tr><td><code>id</code></td>
<td>
<p>A numeric vector specifying the patient identifier.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>A numeric vector specifying the gold-standard results (1 = presence of disease, 0 = absence of disease).
</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>A numeric vector specifying the diagnostic test (1 = test 1, 0 = test 2).
</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>A numeric vector specifying the test results (1 = positive, 0 = negative).
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+tab.paired">tab.paired</a></code> and <code><a href="#topic+read.tab.paired">read.tab.paired</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data
names(Paired1)
new.long &lt;- represent.long(d=Paired1$d, y1=Paired1$y1, y2=Paired1$y2)
str(new.long)
head(new.long)
</code></pre>

<hr>
<h2 id='sesp.diff.ci'>Confidence Intervals for Differences in Sensitivity and Specificity</h2><span id='topic+sesp.diff.ci'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for differences in sensitivity and specificity of two binary diagnostic tests in a paired study design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sesp.diff.ci(tab, ci.method, alpha, cont.corr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sesp.diff.ci_+3A_tab">tab</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>
</td></tr>
<tr><td><code id="sesp.diff.ci_+3A_ci.method">ci.method</code></td>
<td>
<p>The available methods are &ldquo;<code>wald</code>&rdquo; (Altman, 1991), &ldquo;<code>agresti-min</code>&rdquo; (Agresti and Min, 2005), &ldquo;<code>bonett-price</code>&rdquo; (Bonett and Price, 2011), and &ldquo;<code>tango</code>&rdquo; (Tango, 1998), the default is &ldquo;<code>wald</code>&rdquo;.
</p>
</td></tr>
<tr><td><code id="sesp.diff.ci_+3A_alpha">alpha</code></td>
<td>
<p>Significance level alpha for 100(1-alpha)%-confidence intervals for the difference in sensitivity and specificity, the default is 0.05.
</p>
</td></tr>
<tr><td><code id="sesp.diff.ci_+3A_cont.corr">cont.corr</code></td>
<td>
<p>A logical value indicating whether the continuity correction should be used (only available for <code>ci.method="wald"</code>), the default is <code>FALSE</code>.   
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For details and recommendations see Newcombe (2012) and Wenzel and Zapf (2013).
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>sensitivity</code></td>
<td>
<p>A vector containing 
<code>test1</code> (the sensitivity of test 1), 
<code>test2</code> (the specificity of test 2), 
<code>diff</code> (the difference between the two sensitivities, computed as <code>test2 - test1</code>), 
<code>diff.se</code> (the standard error of <code>diff</code>), 
<code>diff.lcl</code> (the lower confidence limit of <code>diff</code>) and 
<code>diff.ucl</code> (the upper confidence limit of <code>diff</code>).
</p>
</td></tr>
<tr><td><code>specificity</code></td>
<td>
<p>A vector containing 
<code>test1</code> (specificity of test 1), 
<code>test2</code> (specificity of test 2), 
<code>diff</code> (the difference between the two specificities, computed as <code>test2 - test1</code>), 
<code>diff.se</code> (the standard error of <code>diff</code>), 
<code>diff.lcl</code> (the lower confidence limit of <code>diff</code>) and 
<code>diff.ucl</code> (the upper confidence limit of <code>diff</code>).
</p>
</td></tr>
<tr><td><code>ci.method</code></td>
<td>
<p>The name of the method used to calculate confidence intervals. </p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The level alpha used to compute 100(1-alpha)%-confidence intervals.</p>
</td></tr>
<tr><td><code>cont.corr</code></td>
<td>
<p>A logical value indicating whether the continuity correction was applied.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Altman, D.G. (1991). Practical statistics for medical research. Chapman &amp; Hall, London.
</p>
<p>Agresti, A. and Min, Y. (2005). Simple improved confidence intervals for comparing matched proportions. <em>Stat Med</em>, 24(5): 729-40.
</p>
<p>Bonett, D.G., and Price, R.M. (2011). Adjusted Wald confidence intervals for a difference of binomial proportions based on paired data. <em>J Educ Behav Stat</em>, 37(4): 479-488.
</p>
<p>Newcombe R.G. (2012). Confidence intervals for proportions and related measures of effect size. Chapman and Hall/CRC Biostatistics Series.
</p>
<p>Tango, T. (1998). Equivalence test and confidence interval for the difference in proportions for the paired-sample design. <em>Stat Med</em>, 17(8): 891-908.
</p>
<p>Wenzel, D., and Zapf, A. (2013).
Difference of two dependent sensitivities and specificities: comparison of various approaches.
<em>Biom J</em>, 55(5): 705-718.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(DTComPair)
t1 &lt;- read.tab.paired(18, 14, 0, 18,
                      18, 12, 2, 18)
t1
sesp.diff.ci(t1, ci.method="wald", cont.corr=FALSE)
sesp.diff.ci(t1, ci.method="wald", cont.corr=TRUE)
sesp.diff.ci(t1, ci.method="agresti-min")
sesp.diff.ci(t1, ci.method="tango")
</code></pre>

<hr>
<h2 id='sesp.exactbinom'>Exact Binomial Test for Differences in Sensitivity and Specificity
</h2><span id='topic+sesp.exactbinom'></span>

<h3>Description</h3>

<p>Performs an exact binomial test for differences in sensitivity and specificity of two binary diagnostic tests in a paired study design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sesp.exactbinom(tab) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sesp.exactbinom_+3A_tab">tab</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>
</td></tr>

</table>


<h3>Details</h3>

<p>The function performs a standard exact binomial test.
</p>
<p>An exact binomial test is recommended when the number of patients with differing results for test 1 and test 2 (discordant pairs) is small, i.e. &lt;20 (Zhou et al., 2011). 
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>sensitivity</code></td>
<td>
<p>A list containing 
<code>test1</code> (sensitivity of test 1), 
<code>test2</code> (specificity of test 2), 
<code>diff</code> (the difference in sensitivity, computed as <code>test2 - test1</code>) 
and the corresponding <code>p.value</code>. </p>
</td></tr>
<tr><td><code>specificity</code></td>
<td>
<p>A list containing 
<code>test1</code> (specificity of test 1), 
<code>test2</code> (specificity of test 2), 
<code>diff</code> (the difference in specificity, computed as <code>test2 - test1</code>)
and the corresponding <code>p.value</code>. </p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The name of the method used to compare sensitivity and specificity, here &ldquo;exactbinom&rdquo;. </p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhou, X., Obuchowski, N., and McClish, D. (2011). Statistical Methods in Diagnostic Medicine. Wiley Series in Probability and Statistics. John Wiley &amp; Sons, Hoboken, New Jersey, 2nd edition.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sesp.mcnemar">sesp.mcnemar</a></code> and <code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data
ftable(Paired1)
paired.layout &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
paired.layout 
exact.results &lt;- sesp.exactbinom(paired.layout)
str(exact.results)
exact.results
exact.results$sensitivity["p.value"]
</code></pre>

<hr>
<h2 id='sesp.gen.mcnemar'>Generalized McNemar's test</h2><span id='topic+sesp.gen.mcnemar'></span>

<h3>Description</h3>

<p>Performs a generalized McNemar's test to jointly compare sensitivity and specificity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sesp.gen.mcnemar(tab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sesp.gen.mcnemar_+3A_tab">tab</code></td>
<td>
<p>An object of class 'tab.paired'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the test statistic and the p-value.
</p>


<h3>References</h3>

<p>Lachenbruch P.A., Lynch C.J. (1998). Assessing screening tests: extensions of McNemar's test. <em>Stat Med</em>, 17(19): 2207-17.
</p>


<h3>See Also</h3>

<p>[tab.paired()], [read.tab.paired()] and [sesp.mcnemar()]
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
data(Paired1) # Hypothetical study data
ftable(Paired1)
paired.layout1 &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
print(paired.layout1)
sesp.gen.mcnemar(paired.layout1)

# Example 2 (from Lachenbruch and Lynch (1998)):
paired.layout2 &lt;- read.tab.paired(
  d.a  = 850, d.b  = 40, d.c  = 60, d.d  =  50, 
  nd.a =  60, nd.b = 25, nd.c = 15, nd.d = 900, 
  testnames = c("T1", "T2")
)
print(paired.layout2)
sesp.gen.mcnemar(paired.layout2)

</code></pre>

<hr>
<h2 id='sesp.mcnemar'>McNemar Test for Comparison of Sensitivities and Specificities</h2><span id='topic+sesp.mcnemar'></span>

<h3>Description</h3>

<p>Performs a McNemar Test for comparison of sensitivities and specificities of two binary diagnostic tests in a paired study design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sesp.mcnemar(tab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sesp.mcnemar_+3A_tab">tab</code></td>
<td>
<p>An object of class <code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>The test is performed as described by McNemar (1947).
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>sensitivity</code></td>
<td>
<p>A list containing 
<code>test1</code> (sensitivity of test 1), 
<code>test2</code> (specificity of test 2), 
<code>diff</code> (the difference in sensitivity, computed as <code>test2 - test1</code>), 
the <code>test.statistic</code> and the corresponding <code>p.value</code>. 
</p>
</td></tr>
<tr><td><code>specificity</code></td>
<td>
<p>A list containing 
<code>test1</code> (specificity of test 1), 
<code>test2</code> (specificity of test 2), 
<code>diff</code> (the difference in specificity, computed as <code>test2 - test1</code>), 
the <code>test.statistic</code> and the corresponding <code>p.value</code>. 
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The name of the method used to compare sensitivity and specificity, here &ldquo;<code>mcnemar</code>&rdquo;.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>McNemar, Q. (1947). Note on the sampling error of the difference between correlated proportions or percentages. <em>Psychometrika</em>, 12(2):153-7.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sesp.exactbinom">sesp.exactbinom</a></code> and <code><a href="#topic+tab.paired">tab.paired</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data
ftable(Paired1)
paired.layout &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
paired.layout 
mcnem.results &lt;- sesp.mcnemar(paired.layout)
str(mcnem.results)
mcnem.results
mcnem.results$sensitivity["p.value"]
</code></pre>

<hr>
<h2 id='sesp.rel'>Comparison of the accuracy of two tests using relative sensitivity and specificity</h2><span id='topic+sesp.rel'></span>

<h3>Description</h3>

<p>Calculates two-sided Wald confidence intervals and performs a Wald test for the relative
sensitivity and specificity of two binary diagnostic tests in a paired study design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sesp.rel(tab, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sesp.rel_+3A_tab">tab</code></td>
<td>
<p>an object of class <code>tab.paired</code>.</p>
</td></tr>
<tr><td><code id="sesp.rel_+3A_alpha">alpha</code></td>
<td>
<p>significance level alpha used to compute two-sided 100(1-alpha)%-confidence intervals, the default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If relative sensitivity&gt;1, the percentage increase in sensitivity for <code>test2</code> relative to <code>test1</code> is computed as 100(relative sensitivity-1)%. If 
relative sensitivity&lt;1 the percentage decrease in sensitivity for <code>test2</code> relative to <code>test1</code> is computed as 100(1-relative sensitivity)%. 
Percentage increase/decrease in specificity is computed in an analogous fashion. 
</p>
<p>Given the independence of relative sensitivity and relative specificity, a possible joint 100(1-alpha)% confidence region for {relative sensitivity, relative specificity}
is formed by the rectangle {<code>lcl.rel.sens</code>, <code>ucl.rel.sens</code>} x {<code>lcl.rel.spec</code>, <code>ucl.rel.spec</code>}, where {<code>lcl.rel.sens</code>, <code>ucl.rel.sens</code>} and
{<code>lcl.rel.spec</code>, <code>ucl.rel.spec</code>} are 100(1-alpha*)% confidence intervals for relative sensitivity and relative specificity, respectively, and alpha*=1-sqrt(1-alpha).
</p>
<p>The McNemar's test implemented in <code>sesp.mcnemar</code> is asymptotically equivalent to the Wald test implemented here.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>sensitivity</code></td>
<td>
<p>a named vector containing <code>test1</code> (the sensitivity for test 1), <code>test2</code> (the sensitivity for test 2), 
<code>rel.sens</code> (the relative difference between the two sensitivities, computed as <code>test2/test1</code>), 
<code>se.log.rel.sens</code> (the standard error for log(<code>rel.sens</code>)), <code>lcl.rel.sens</code> (the lower confidence limit for <code>rel.sens</code>), 
<code>ucl.rel.sens</code> (the upper confidence limit for <code>rel.sens</code>), and <code>pval.rel.sens</code> (the p-value from the test for
the null hypothesis: relative sensitivity=1).</p>
</td></tr>
<tr><td><code>specificity</code></td>
<td>
<p>a named vector containing <code>test1</code> (the specificity for test 1), <code>test2</code> (the specificity for test 2), 
<code>rel.spec</code> (the relative difference between the two specificities, computed as <code>test2/test1</code>), 
<code>se.log.rel.spec</code> (the standard error for log(<code>rel.spec</code>)), <code>lcl.rel.spec</code> (the lower confidence limit for <code>rel.spec</code>), 
<code>ucl.rel.spec</code> (the upper confidence limit for <code>rel.spec</code>), and <code>pval.rel.spec</code> (the p-value from the test for
the null hypothesis: relative specificity=1).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>significance level alpha for 100(1-alpha)%-confidence intervals for <code>rel.sens</code> and <code>rel.spec</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Alonzo, T. A., Pepe, M. S., &amp; Moskowitz, C. S. (2002). Sample size calculations for comparative studies of medical tests for detecting presence of disease. <em>Statistics in medicine</em>, 21(6), 835-852.
</p>


<h3>See Also</h3>

<p><code>sesp.diff.ci</code>, <code>sesp.mcnemar</code>, and <code>sesp.exactbinom</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data
ftable(Paired1)
paired.layout &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
paired.layout 
sesp.rel.results &lt;- sesp.rel(paired.layout)
str(sesp.rel.results)
sesp.rel.results
</code></pre>

<hr>
<h2 id='tab.1test'>Tabulate Single Binary Diagnostic Test vs. Gold-Standard</h2><span id='topic+tab.1test'></span>

<h3>Description</h3>

<p>Produces a contingency table of results from a single binary diagnostic test vs. the gold-standard results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tab.1test(d, y, data = NULL, testname, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tab.1test_+3A_d">d</code></td>
<td>
<p>A numeric vector specifying the gold-standard results (1 = presence of disease, 0 = absence of disease).
</p>
</td></tr>
<tr><td><code id="tab.1test_+3A_y">y</code></td>
<td>
<p>A numeric vector specifying the results of the diagnostic test (1 = positive, 0 = negative).
</p>
</td></tr>
<tr><td><code id="tab.1test_+3A_data">data</code></td>
<td>
<p>An optional data frame, list or environment containing the required variables <code>d</code> and <code>y</code>.
</p>
</td></tr>
<tr><td><code id="tab.1test_+3A_testname">testname</code></td>
<td>
<p>An optional character variable specifying the name of the diagnostic test, e.g. <code>c("Test A")</code>. If not supplied, the variable name is used as the testname.
</p>
</td></tr>
<tr><td><code id="tab.1test_+3A_...">...</code></td>
<td>
<p>Additional arguments (usually not required).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of class <code><a href="#topic+tab.1test">tab.1test</a></code>:
</p>
<table>
<tr><td><code>tab.1test</code></td>
<td>
<p>A contingency table (matrix) of test results. 
</p>

<table>
<tr>
 <td style="text-align: left;">
          </td><td style="text-align: right;"> Diseased </td><td style="text-align: right;"> Non-diseased </td><td style="text-align: right;"> Total </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test pos. </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test neg. </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... </td>
</tr>
<tr>
 <td style="text-align: left;">
 Total     </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... 
 </td>
</tr>

</table>

</td></tr>
<tr><td><code>testname</code></td>
<td>
<p>The name of the diagnostic test.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>Objects of class <code><a href="#topic+tab.1test">tab.1test</a></code> are required as arguments for <code><a href="#topic+acc.1test">acc.1test</a></code>, a function to compute the accuracy of a binary diagnostic test.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tab.paired">tab.paired</a></code>,
<code><a href="#topic+acc.1test">acc.1test</a></code>,
<code><a href="#topic+acc.paired">acc.paired</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
a &lt;- tab.1test(d=d, y=y1, data=Paired1)
str(a)
a$tab.1test
a
</code></pre>

<hr>
<h2 id='tab.paired'>Tabulate Results from Two Binary Diagnostic Tests in a Paired Study Design</h2><span id='topic+tab.paired'></span>

<h3>Description</h3>

<p>Produces contingency tables of results from two binary diagnostic tests evaluated in a paired study design. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tab.paired(d, y1, y2, data = NULL, testnames, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tab.paired_+3A_d">d</code></td>
<td>
<p>A numeric vector specifying the gold-standard results (1 = presence of disease, 0 = absence of disease).
</p>
</td></tr>
<tr><td><code id="tab.paired_+3A_y1">y1</code></td>
<td>
<p>A numeric vector specifying the results of diagnostic test 1 (1 = positive, 0 = negative).
</p>
</td></tr>
<tr><td><code id="tab.paired_+3A_y2">y2</code></td>
<td>
<p>A numeric vector specifying the results of diagnostic test 2 (1 = positive, 0 = negative).
</p>
</td></tr>
<tr><td><code id="tab.paired_+3A_data">data</code></td>
<td>
<p>An optional data frame, list or environment containing the required variables <code>d</code>, <code>y1</code> and <code>y2</code>.
</p>
</td></tr>
<tr><td><code id="tab.paired_+3A_testnames">testnames</code></td>
<td>
<p>An optional vector specifying the names of diagnostic test 1 and diagnostic test 2, e.g. <code>c("Test A","Test B")</code>. If not supplied, the variable names are used as testnames.
</p>
</td></tr>
<tr><td><code id="tab.paired_+3A_...">...</code></td>
<td>
<p>Additional arguments (usually not required).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of class <code><a href="#topic+tab.paired">tab.paired</a></code>:
</p>
<table>
<tr><td><code>diseased</code></td>
<td>
<p>A contingency table (matrix) of test results among <em>diseased</em> subjects.
</p>

<table>
<tr>
 <td style="text-align: left;">
          </td><td style="text-align: right;"> Test1 pos. </td><td style="text-align: right;"> Test1 neg. </td><td style="text-align: right;"> Total </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test2 pos. </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test2 neg. </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... </td>
</tr>
<tr>
 <td style="text-align: left;">
 Total     </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... 
 </td>
</tr>

</table>

</td></tr> 
<tr><td><code>non.diseased</code></td>
<td>
<p>A contingency table (matrix) of test results among <em>non-diseased</em> subjects.
</p>

<table>
<tr>
 <td style="text-align: left;">
          </td><td style="text-align: right;"> Test1 pos. </td><td style="text-align: right;"> Test1 neg. </td><td style="text-align: right;"> Total </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test2 pos. </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... </td>
</tr>
<tr>
 <td style="text-align: left;">
 Test2 neg. </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... </td>
</tr>
<tr>
 <td style="text-align: left;">
 Total     </td><td style="text-align: right;"> ...      </td><td style="text-align: right;"> ...          </td><td style="text-align: right;"> ... 
 </td>
</tr>

</table>

</td></tr>
<tr><td><code>testnames</code></td>
<td>
<p>The names of the diagnostic tests.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Objects of class <code><a href="#topic+tab.paired">tab.paired</a></code> are essential arguments for various functions in the 
<code><a href="#topic+DTComPair">DTComPair</a></code>-package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.tab.paired">print.tab.paired</a></code>, 
<code><a href="#topic+read.tab.paired">read.tab.paired</a></code>, 
<code><a href="#topic+tab.1test">tab.1test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paired1) # Hypothetical study data 
b &lt;- tab.paired(d=d, y1=y1, y2=y2, data=Paired1)
str(b)
b$diseased
b$non.diseased
print(b)
</code></pre>

<hr>
<h2 id='tpffpf.rel'>Comparison of the accuracy of two tests using relative true positive and false positive fraction</h2><span id='topic+tpffpf.rel'></span>

<h3>Description</h3>

<p>Calculates two-sided Wald confidence intervals and performs a Wald test for the relative
true positive fraction (TPF) (sensitivity) and false positive fraction (FPF) (i.e., one minus specificity) 
of two binary diagnostic tests in a paired study design.
</p>
<p>This function is primarily intended for the analysis of paired <b>screen positive</b> studies, i.e. those paired studies where
the disease (outcome) is ascertained using the gold standard test only in subjects who screen positive to 
either or both diagnostic tests. However, this function can also be used with data from standard paired studies, 
i.e. where the gold standard test is applied to all subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tpffpf.rel(tab, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tpffpf.rel_+3A_tab">tab</code></td>
<td>
<p>an object of class <code>tab.paired</code>.</p>
</td></tr>
<tr><td><code id="tpffpf.rel_+3A_alpha">alpha</code></td>
<td>
<p>significance level alpha used to compute two-sided 100(1-alpha)%-confidence intervals, the default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If relative true positive fraction&gt;1, the percentage increase in true positive fraction for Test2 relative to Test1 is computed as 100(relative true positive fraction-1)%. If 
relative true positive fraction&lt;1 the percentage decrease in true positive fraction for Test2 relative to Test1 is computed as 100(1-relative true positive fraction)%. 
Percentage increase/decrease in false positive fraction is computed in an analogous fashion. 
</p>
<p>Given the independence of relative TPR and relative TNR, a possible joint 100(1-alpha)% confidence region for {relative TPF, relative FPF}
is formed by the rectangle {<code>lcl.rel.tpf</code>, <code>ucl.rel.tpf</code>} x {<code>lcl.rel.fpf</code>, <code>ucl.rel.fpf</code>}, where {<code>lcl.rel.tpf</code>, <code>ucl.rel.tpf</code>} and
{<code>lcl.rel.fpf</code>, <code>ucl.rel.fpf</code>} are 100(1-alpha*)% confidence intervals for relative TPF and relative FPF, respectively, and alpha*=1-sqrt(1-alpha).
</p>
<p>In screen positive studies, only relative TPF and relative FPF can be estimated from the data. 
Their constituents, i.e. TPF and FPF for the two tests, are not estimable. 
Relative specificity is not estimable either. Therefore, <code>sesp.rel</code> should not 
be used to attempt to estimate those quantities from studies with a paired screen positive design. 
McNemar's test (<code>sesp.mcnemar</code>) can, however, be used to test the null hypothesis of equality in specificities in 
paired screen positive studies (Schatzkin et al., 1987).
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>tpf</code></td>
<td>
<p>a named vector containing 
<code>rel.tpf</code> (the relative true positive fraction, Test2 vs. Test1), 
<code>se.log.rel.tpf</code> (the standard error for log(<code>rel.tpf</code>)), <code>lcl.rel.tpf</code> (the lower confidence limit for <code>rel.tpf</code>), 
<code>ucl.rel.tpf</code> (the upper confidence limit for <code>rel.tpf</code>), and <code>pval.rel.tpf</code> (the p-value from the test for
the null hypothesis: relative true positive fraction=1).</p>
</td></tr>
<tr><td><code>fpf</code></td>
<td>
<p>a named vector containing 
<code>rel.fpf</code> (the relative false positive fraction, Test2 vs. Test1), 
<code>se.log.rel.fpf</code> (the standard error for log(<code>rel.fpf</code>)), <code>lcl.rel.fpf</code> (the lower confidence limit for <code>rel.fpf</code>), 
<code>ucl.rel.fpf</code> (the upper confidence limit for <code>rel.fpf</code>), and <code>pval.rel.fpf</code> (the p-value from the test for
the null hypothesis: relative false positive fraction=1).</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>significance level alpha for 100(1-alpha)%-confidence intervals for <code>rel.tpf</code> and <code>rel.fpf</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Schatzkin, A., Connor, R. J., Taylor, P. R., &amp; Bunnag, B. (1987). Comparing new and old screening tests when a reference procedure cannot be performed on all screenees: example of automated cytometry for early detection of cervical cancer. <em>American Journal of Epidemiology</em>, 125(4), 672-678.
</p>
<p>Cheng, H., &amp; Macaluso, M. (1997). Comparison of the accuracy of two tests with a confirmatory procedure limited to positive results. <em>Epidemiology</em>, 104-106.
</p>
<p>Alonzo, T. A., Pepe, M. S., &amp; Moskowitz, C. S. (2002). Sample size calculations for comparative studies of medical tests for detecting presence of disease. <em>Statistics in medicine</em>, 21(6), 835-852.
</p>


<h3>See Also</h3>

<p><code>sesp.rel</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data from Cheng and Macaluso (Table 2)
breast.cancer.data &lt;- read.tab.paired(
 10, 24, 21, NA,
 13, 144, 95, NA,
 testnames=c("Mammography", "Physical examination")
)
breast.cancer.data
tpffpf.rel.results &lt;- tpffpf.rel(breast.cancer.data)
str(tpffpf.rel.results)
tpffpf.rel.results
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
