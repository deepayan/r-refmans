<!DOCTYPE html><html><head><title>Help for package nlmixr2rpt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlmixr2rpt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#build_figures'><p>Generates Figures for an <code>nlmixr2</code> Report</p></a></li>
<li><a href='#build_tables'><p>Generates Tables  for an <code>nlmixr2</code> Report</p></a></li>
<li><a href='#eval_str'><p>Evaluate R Code in String</p></a></li>
<li><a href='#fetch_fdim'><p>Gets Figure Dimensions</p></a></li>
<li><a href='#fetch_fit_example'><p>Fetch Fit Example</p></a></li>
<li><a href='#fetch_option'><p>Fetch Analysis Options</p></a></li>
<li><a href='#gen_pest_table'><p>Makes <code>nlmixr2</code> Parameter Estimate Table for Reporting</p></a></li>
<li><a href='#mk_error_fig'><p>Generates <code>ggplot</code> Object with Error Message</p></a></li>
<li><a href='#mk_error_tab'><p>Generates a <code>flextable</code> Object with Error Message</p></a></li>
<li><a href='#process_ph'><p>Substitutes Placehodlers in Strings</p></a></li>
<li><a href='#report_fit'><p>Report <code>nlmixr2</code> Fit Results to PowerPoint and Word</p></a></li>
<li><a href='#write_figure'><p>Writes Figures to File</p></a></li>
<li><a href='#yaml_read_fit'><p>Reads and Checks <code>report_fit.yaml</code> File</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Templated Word and PowerPoint Reporting of 'nlmixr2' Fitting
Results</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John Harrold &lt;john.m.harrold@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This allows you to generate reporting workflows around 'nlmixr2' analyses with outputs in Word and PowerPoint. You can specify figures, tables and report structure in a user-definable 'YAML' file. Also you can use the internal functions to access the figures and tables to allow their including in other outputs (e.g. R Markdown).</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://nlmixr2.github.io/nlmixr2rpt/">https://nlmixr2.github.io/nlmixr2rpt/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nlmixr2/nlmixr2rpt/issues">https://github.com/nlmixr2/nlmixr2rpt/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, dplyr, flextable, ggforce, ggpubr, ggplot2, grDevices,
stringr, nlmixr2, nlmixr2extra (&ge; 2.0.7), onbrand, rxode2,
utils, xpose, xpose.nlmixr2, yaml</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, ggPMX, knitr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-06 01:53:36 UTC; jmh</td>
</tr>
<tr>
<td>Author:</td>
<td>John Harrold <a href="https://orcid.org/0000-0003-2052-4373"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-06 13:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='build_figures'>Generates Figures for an <code>nlmixr2</code> Report</h2><span id='topic+build_figures'></span>

<h3>Description</h3>

<p>Creates figures specified in a rptyaml file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_figures(
  obnd = NULL,
  fit = NULL,
  rptdetails = NULL,
  cat_covars = NULL,
  cont_covars = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="build_figures_+3A_obnd">obnd</code></td>
<td>
<p><code>onbrand</code> report object to have report elements appended to</p>
</td></tr>
<tr><td><code id="build_figures_+3A_fit">fit</code></td>
<td>
<p><code>nlmixr2</code> fit object to be reported</p>
</td></tr>
<tr><td><code id="build_figures_+3A_rptdetails">rptdetails</code></td>
<td>
<p>Object created  when reading in rptyaml file</p>
</td></tr>
<tr><td><code id="build_figures_+3A_cat_covars">cat_covars</code></td>
<td>
<p>character vector of categorical covariates to overwrite defaults in yaml file</p>
</td></tr>
<tr><td><code id="build_figures_+3A_cont_covars">cont_covars</code></td>
<td>
<p>character vector of continuous covariates to overwrite defaults in yaml file</p>
</td></tr>
<tr><td><code id="build_figures_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the figures with the following structure:
</p>

<ul>
<li> <p><code>"rptfigs"</code> - List of figures with names corresponding to the
figure ids in the yaml file. Each figure ID contains the following elements:
</p>

<ul>
<li> <p><code>"figure"</code>       - list of figure file names for the current fid
</p>
</li>
<li> <p><code>"orientation"</code>  - Figure orientation (&quot;portrait&quot; or &quot;landscape&quot;)
</p>
</li>
<li> <p><code>"isgood"</code>       - Boolean variable indicating success or failure
</p>
</li>
<li> <p><code>"skip"</code>         - Boolean variable indicating whether the figure should be skipped during reporting
</p>
</li>
<li> <p><code>"fmsgs"</code>        - Vector of messages
</p>
</li>
<li> <p><code>"cmd"</code>          - Original plot generation command
</p>
</li>
<li> <p><code>"cmd_proc"</code>     - Plot generation command after processing for placeholders
</p>
</li>
<li> <p><code>"height"</code>       - Figure height
</p>
</li>
<li> <p><code>"width"</code>        - Figure width
</p>
</li>
<li> <p><code>"caption"</code>      - Caption for Word
</p>
</li>
<li> <p><code>"caption_proc"</code> - Caption for Word after processing for placeholders
</p>
</li>
<li> <p><code>"title"</code>        - Slide title for PowerPoint
</p>
</li>
<li> <p><code>"title_proc"</code>   - Slide title for PowerPoint after processing for placeholders
</p>
</li></ul>

</li>
<li> <p><code>"isgood"</code> - Boolean variable indicating success or failure
</p>
</li>
<li> <p><code>"msgs"</code> - Vector of messages
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># We need an onbrand object to use below
library(onbrand)  
obnd = read_template(
 template = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.docx"),
 mapping  = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.yaml"))

# We also need an nlmixr fit object
fit = fetch_fit_example()

# This reads in the report details as well
rptdetails = yaml_read_fit(
 obnd    = obnd,
 rptyaml = system.file(package="nlmixr2rpt", "examples", "report_fit_test.yaml"),
 fit     = fit)$rptdetails

# Now we will build the figures
bfres = build_figures(obnd       = obnd,
                     fit        = fit, 
                     rptdetails = rptdetails)
</code></pre>

<hr>
<h2 id='build_tables'>Generates Tables  for an <code>nlmixr2</code> Report</h2><span id='topic+build_tables'></span>

<h3>Description</h3>

<p>Creates tables specified in a rptyaml file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_tables(
  obnd = NULL,
  fit = NULL,
  rptdetails = NULL,
  cat_covars = NULL,
  cont_covars = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="build_tables_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object to have report elements appended to</p>
</td></tr>
<tr><td><code id="build_tables_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit object to be reported</p>
</td></tr>
<tr><td><code id="build_tables_+3A_rptdetails">rptdetails</code></td>
<td>
<p>object creating when reading in rptyaml file</p>
</td></tr>
<tr><td><code id="build_tables_+3A_cat_covars">cat_covars</code></td>
<td>
<p>character vector of categorical covariates to overwrite defaults in yaml file</p>
</td></tr>
<tr><td><code id="build_tables_+3A_cont_covars">cont_covars</code></td>
<td>
<p>character vector of continuous covariates to overwrite defaults in yaml file</p>
</td></tr>
<tr><td><code id="build_tables_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the tables with the following structure:
</p>

<ul>
<li> <p><code>"rpttabs"</code> - List of tables with names corresponding to the
table ids in the yaml file. It contains the elements from the yamle file
and the following elements:
</p>

<ul>
<li> <p><code>"table"</code>        - Result of build (t_res object)
</p>
</li>
<li> <p><code>"orientation"</code>  - Table orientation (&quot;portrait&quot; or &quot;landscape&quot;)
</p>
</li>
<li> <p><code>"isgood"</code>       - Boolean variable indicating success or failure
</p>
</li>
<li> <p><code>"skip"</code>         - Boolean variable indicating whether the table should be skipped during reporting
</p>
</li>
<li> <p><code>"tmsgs"</code>        - Vector of messages
</p>
</li>
<li> <p><code>"cmd"</code>          - Original plot generation command
</p>
</li>
<li> <p><code>"cmd_proc"</code>     - Plot generation command after processing for placeholders
</p>
</li>
<li> <p><code>"height"</code>       - Table height
</p>
</li>
<li> <p><code>"width"</code>        - Table width
</p>
</li>
<li> <p><code>"caption"</code>      - Caption for Word
</p>
</li>
<li> <p><code>"caption_proc"</code> - Caption for Word after processing for placeholders
</p>
</li>
<li> <p><code>"title"</code>        - Slide title for PowerPoint
</p>
</li>
<li> <p><code>"title_proc"</code>   - Slide title for PowerPoint after processing for placeholders
</p>
</li></ul>

</li>
<li> <p><code>"isgood"</code> - Boolean variable indicating success or failure
</p>
</li>
<li> <p><code>"msgs"</code> - Vector of messages
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># We need an onbrand object to use below

library(onbrand)  
obnd = read_template(
 template = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.docx"),
 mapping  = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.yaml"))

# We also need an nlmixr fit object
fit = fetch_fit_example()

# This reads in the report details as well
rptdetails = yaml_read_fit(
 obnd    = obnd,
 rptyaml = system.file(package="nlmixr2rpt", "examples", "report_fit_test.yaml"),
 fit     = fit)$rptdetails

# Now we will build the tables 
btres = build_tables(obnd        = obnd,
                     fit        = fit, 
                     rptdetails = rptdetails)

</code></pre>

<hr>
<h2 id='eval_str'>Evaluate R Code in String</h2><span id='topic+eval_str'></span>

<h3>Description</h3>

<p>Attempts to evaluate a string as a chunk of R code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_str(estr = "", fit = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval_str_+3A_estr">estr</code></td>
<td>
<p>Object creating when reading in rptyaml file</p>
</td></tr>
<tr><td><code id="eval_str_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit object to be reported</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String containing the evaled as a character or the original string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res = eval_str(estr="ls()")
</code></pre>

<hr>
<h2 id='fetch_fdim'>Gets Figure Dimensions</h2><span id='topic+fetch_fdim'></span>

<h3>Description</h3>

<p>For a given figure id and report type this will pull out the
dimensions of the figure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_fdim(obnd = NULL, fid = NULL, fdim = "width", rptdetails = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fetch_fdim_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object to have report elements appended to</p>
</td></tr>
<tr><td><code id="fetch_fdim_+3A_fid">fid</code></td>
<td>
<p>Figure ID used in the figures section of the yaml file</p>
</td></tr>
<tr><td><code id="fetch_fdim_+3A_fdim">fdim</code></td>
<td>
<p>Dimension to fetch either &quot;width&quot; or &quot;height&quot;</p>
</td></tr>
<tr><td><code id="fetch_fdim_+3A_rptdetails">rptdetails</code></td>
<td>
<p>Object creating when reading in rptyaml file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(onbrand)  
obnd = read_template(
 template = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.pptx"),
 mapping  = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.yaml"))

# This will create an example fit object to use in the examples below
fit = fetch_fit_example()

# This reads in the report details as well
rptdetails = yaml_read_fit(
 obnd    = obnd,
 rptyaml = system.file(package="nlmixr2rpt", "examples", "report_fit_test.yaml"),
 fit     = fit)$rptdetails

fetch_fdim(obnd=obnd, fid="bad_figure", fdim="width", rptdetails=rptdetails)

fetch_fdim(obnd=obnd, fid="bad_figure", fdim="height", rptdetails=rptdetails)
</code></pre>

<hr>
<h2 id='fetch_fit_example'>Fetch Fit Example</h2><span id='topic+fetch_fit_example'></span>

<h3>Description</h3>

<p>Creates an nlmixr2 fit example using <code>posthoc</code> estimation
method for testing purposes.
displayed on the terminal
following:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_fit_example(use_cache = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fetch_fit_example_+3A_use_cache">use_cache</code></td>
<td>
<p>Boolean variable used to cache the fit process for the
current R session.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Example nlmixr2 fit object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit = fetch_fit_example()
</code></pre>

<hr>
<h2 id='fetch_option'>Fetch Analysis Options</h2><span id='topic+fetch_option'></span>

<h3>Description</h3>

<p>Fetches analysis options from the report yaml
applies it to strings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_option(rptdetails, option = NULL, fit = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fetch_option_+3A_rptdetails">rptdetails</code></td>
<td>
<p>Object creating when reading in rptyaml file</p>
</td></tr>
<tr><td><code id="fetch_option_+3A_option">option</code></td>
<td>
<p>String containing the option to fetch (see below)</p>
</td></tr>
<tr><td><code id="fetch_option_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit object to be reported</p>
</td></tr>
<tr><td><code id="fetch_option_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to <code>TRUE</code> (default) messages will be
displayed on the terminal
following:</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The option can be one of the following (default: <code>NULL</code>):
</p>

<ul>
<li> <p><code>"output_dir"</code> - Directory to place figures that are generated (default: <code>tempdir()</code>)
</p>
</li>
<li> <p><code>"resolution"</code> - Resolution of figure files (default: <code>300</code>)
</p>
</li></ul>



<h3>Value</h3>

<p>List containing the following information about the output directory
</p>

<ul>
<li> <p><code>"isgood"</code> - Boolean variable indicating success or failure
</p>
</li>
<li> <p><code>"msgs"</code> - Vector of messages
</p>
</li>
<li> <p><code>"value"</code> - The value of the option or the default if not
specified
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(onbrand)  
obnd = read_template(
 template = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.pptx"),
 mapping  = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.yaml"))

# This will create an example fit object to use in the examples below
fit = fetch_fit_example()

# This reads in the report details as well
rptdetails = yaml_read_fit(
 obnd    = obnd,
 rptyaml = system.file(package="nlmixr2rpt", "examples", "report_fit_test.yaml"),
 fit     = fit)$rptdetails


fetch_option(rptdetails, option="output_dir", fit=fit)
</code></pre>

<hr>
<h2 id='gen_pest_table'>Makes <code>nlmixr2</code> Parameter Estimate Table for Reporting</h2><span id='topic+gen_pest_table'></span>

<h3>Description</h3>

<p>Generates a flextable containting the parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_pest_table(obnd = NULL, fit = NULL, rptdetails = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_pest_table_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object to have report elements appended to</p>
</td></tr>
<tr><td><code id="gen_pest_table_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit object to be reported</p>
</td></tr>
<tr><td><code id="gen_pest_table_+3A_rptdetails">rptdetails</code></td>
<td>
<p>object creating when reading in rptyaml file</p>
</td></tr>
<tr><td><code id="gen_pest_table_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements
</p>

<ul>
<li> <p><code>"isgood"</code>  - Boolean variable indicating success or failure
</p>
</li>
<li> <p><code>"msgs"</code>    - Vector of messages
</p>
</li>
<li> <p><code>"ft"</code>      - Parameter estimates as a <code>flextable</code> object
</p>
</li>
<li> <p><code>"df"</code>      - Parameter estimates as a <code>data.frame</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(onbrand)  
obnd = read_template(
 template = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.pptx"),
 mapping  = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.yaml"))

# This will create an example fit object to use in the examples below
fit = fetch_fit_example()

#'# This reads in the report details as well
rptdetails = yaml_read_fit(
 obnd    = obnd,
 rptyaml = system.file(package="nlmixr2rpt", "examples", "report_fit_test.yaml"),
 fit     = fit)$rptdetails

gen_pest_table(obnd = obnd, fit = fit, rptdetails = rptdetails, verbose = TRUE)
</code></pre>

<hr>
<h2 id='mk_error_fig'>Generates <code>ggplot</code> Object with Error Message</h2><span id='topic+mk_error_fig'></span>

<h3>Description</h3>

<p>Takes a vector of messages and returns a ggplot object with the
text in the figure. This can be used in automated figure generation to
cascade an error message to the end user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk_error_fig(msgs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mk_error_fig_+3A_msgs">msgs</code></td>
<td>
<p>Vector of error messages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mk_error_fig("This is an error")
</code></pre>

<hr>
<h2 id='mk_error_tab'>Generates a <code>flextable</code> Object with Error Message</h2><span id='topic+mk_error_tab'></span>

<h3>Description</h3>

<p>Takes a vector of messages and returns a <code>flextable</code> object with the
text in the table. This can be used in automated table generation to
cascade an error message to the end user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk_error_tab(msgs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mk_error_tab_+3A_msgs">msgs</code></td>
<td>
<p>Vector of error messages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with a single <code>flextable</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>error_tab = mk_error_tab("This is an error")
error_tab$ft[[1]]
</code></pre>

<hr>
<h2 id='process_ph'>Substitutes Placehodlers in Strings</h2><span id='topic+process_ph'></span>

<h3>Description</h3>

<p>Takes placeholder information from the rptyaml file and
applies it to strings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_ph(str, rptdetails)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="process_ph_+3A_str">str</code></td>
<td>
<p>String to process</p>
</td></tr>
<tr><td><code id="process_ph_+3A_rptdetails">rptdetails</code></td>
<td>
<p>Object creating when reading in rptyaml file
(default: <code>NULL</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>processed string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(onbrand)  
obnd = read_template(
 template = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.docx"),
 mapping  = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.yaml"))

# We also need an nlmixr fit object
fit = fetch_fit_example()

# This reads in the report details as well
rptdetails = yaml_read_fit(
 obnd    = obnd,
 rptyaml = system.file(package="nlmixr2rpt", "examples", "report_fit_test.yaml"),
 fit     = fit)$rptdetails

str = "This is ===CMPD==="

process_ph(str, rptdetails)
</code></pre>

<hr>
<h2 id='report_fit'>Report <code>nlmixr2</code> Fit Results to PowerPoint and Word</h2><span id='topic+report_fit'></span>

<h3>Description</h3>

<p>Appends <code>nlmixr2</code> fit results to an onbrand report object with the
content and format of the report in the supplied yaml file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report_fit(
  obnd = NULL,
  fit = NULL,
  placeholders = NULL,
  cat_covars = NULL,
  cont_covars = NULL,
  parameters = NULL,
  rptyaml = system.file(package = "nlmixr2rpt", "templates", "report_fit.yaml"),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="report_fit_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object to have report elements appended to.</p>
</td></tr>
<tr><td><code id="report_fit_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit object to be reported.</p>
</td></tr>
<tr><td><code id="report_fit_+3A_placeholders">placeholders</code></td>
<td>
<p>Manual placeholders, see <code><a href="#topic+yaml_read_fit">yaml_read_fit</a></code> for more.</p>
</td></tr>
<tr><td><code id="report_fit_+3A_cat_covars">cat_covars</code></td>
<td>
<p>character vector of categorical covariates to overwrite defaults in yaml file.</p>
</td></tr>
<tr><td><code id="report_fit_+3A_cont_covars">cont_covars</code></td>
<td>
<p>character vector of continuous covariates to overwrite defaults in yaml file.</p>
</td></tr>
<tr><td><code id="report_fit_+3A_parameters">parameters</code></td>
<td>
<p>list with element names for each parameter to overwrite defaults in yaml file.</p>
</td></tr>
<tr><td><code id="report_fit_+3A_rptyaml">rptyaml</code></td>
<td>
<p>yaml file containing the report elements and structure.</p>
</td></tr>
<tr><td><code id="report_fit_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE messages will be .</p>
</td></tr>
</table>


<h3>Value</h3>

<p>onbrand object with the report elements added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(onbrand)  
obnd = read_template(
 template = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.pptx"),
 mapping  = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.yaml"))

# This will create an example fit object to use in the examples below
fit = fetch_fit_example()

# Appening fit results
obnd_pptx = report_fit(
 fit     = fit, 
 rptyaml = system.file(package="nlmixr2rpt", "examples", "report_fit_test.yaml"),
 obnd    = obnd)

# Writing the report to a file
save_report(obnd, file.path(tempdir(), "report.pptx"))

</code></pre>

<hr>
<h2 id='write_figure'>Writes Figures to File</h2><span id='topic+write_figure'></span>

<h3>Description</h3>

<p>Takes a figure object, optionally
stamps the image, and writes to a file
dimensions of the figure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_figure(
  p_res = NULL,
  page = NULL,
  width = 3,
  height = 3,
  resolution = NULL,
  fig_file = NULL,
  fig_stamp = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_figure_+3A_p_res">p_res</code></td>
<td>
<p>ggplot, ggforce paginated object, or ggarrange object.</p>
</td></tr>
<tr><td><code id="write_figure_+3A_page">page</code></td>
<td>
<p>Page number to write or NULL for a ggplot object.</p>
</td></tr>
<tr><td><code id="write_figure_+3A_width">width</code></td>
<td>
<p>Width in inches.</p>
</td></tr>
<tr><td><code id="write_figure_+3A_height">height</code></td>
<td>
<p>Height in inches.</p>
</td></tr>
<tr><td><code id="write_figure_+3A_resolution">resolution</code></td>
<td>
<p>resolution in dpi.</p>
</td></tr>
<tr><td><code id="write_figure_+3A_fig_file">fig_file</code></td>
<td>
<p>File name to write the figure to.</p>
</td></tr>
<tr><td><code id="write_figure_+3A_fig_stamp">fig_stamp</code></td>
<td>
<p>Character object containing the text to stamp on the figure with optional ===file=== placeholder.</p>
</td></tr>
<tr><td><code id="write_figure_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be.
displayed on the terminal</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the following
</p>

<ul>
<li> <p><code>"isgood"</code> - Boolean variable indicating success or failure
</p>
</li>
<li> <p><code>"msgs"</code> - Vector of messages
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
write_figure(
 p_res = ggplot(),
 page = NULL,
 width = 3,
 height = 3,
 resolution = 200,
 fig_file = file.path(tempdir(), "write_figure_example.png"),
 fig_stamp = "stamp",
 verbose = TRUE)
</code></pre>

<hr>
<h2 id='yaml_read_fit'>Reads and Checks <code>report_fit.yaml</code> File</h2><span id='topic+yaml_read_fit'></span>

<h3>Description</h3>

<p>Reads in the report yaml file and looks it to make sure it has all
the necessary fields for the given report.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yaml_read_fit(
  obnd = NULL,
  rptyaml = NULL,
  placeholders = NULL,
  parameters = NULL,
  fit = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yaml_read_fit_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object to have report elements appended to.</p>
</td></tr>
<tr><td><code id="yaml_read_fit_+3A_rptyaml">rptyaml</code></td>
<td>
<p>yaml file containing the report elements and structure.</p>
</td></tr>
<tr><td><code id="yaml_read_fit_+3A_placeholders">placeholders</code></td>
<td>
<p>list of placeholders to overwrite defaults in the yaml file.</p>
</td></tr>
<tr><td><code id="yaml_read_fit_+3A_parameters">parameters</code></td>
<td>
<p>list with element names for each parameter to overwrite at runtime.
with a named list for example RUN may be &quot;RUNN&quot; in the yaml file. To
overwrite this just provide <code>list(RUN="RUN_1")</code>
(default: <code>NULL</code>)</p>
</td></tr>
<tr><td><code id="yaml_read_fit_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit object to be reported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the following information about the report
</p>

<ul>
<li> <p><code>"isgood"</code> - Boolean variable indicating success or failure
</p>
</li>
<li> <p><code>"msgs"</code> - Vector of messages
</p>
</li>
<li> <p><code>"rpttype"</code> - Type of onbrand report (&quot;Word&quot; or &quot;PowerPoint&quot;)
</p>
</li>
<li> <p><code>"rptfigfmt"</code> - Default figure formatting (orientation and dimensions)
</p>
</li>
<li> <p><code>"rpttabfmt"</code> - Default table formatting (orientation and dimensions)
</p>
</li>
<li> <p><code>"rptdetails"</code> - Contents of the yaml file
</p>
</li>
<li> <p><code>"rptcont"</code> - Contents of the report to generate
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># We need an onbrand object to use below
library(onbrand)  
obnd = read_template(
 template = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.docx"),
 mapping  = system.file(package="nlmixr2rpt", "templates","nlmixr_obnd_template.yaml"))

# We also need an nlmixr fit object
fit = fetch_fit_example()

# This reads in the report details
yaml_read_res = yaml_read_fit(
 obnd    = obnd,
 rptyaml = system.file(package="nlmixr2rpt", "examples", "report_fit_test.yaml"),
 fit     = fit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
