<!DOCTYPE html><html lang="en"><head><title>Help for package DNNSIM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DNNSIM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DNNSIM'><p>The 'DNNSIM' package.</p></a></li>
<li><a href='#data_simulation'><p>Simulate data for the DNN-SIM model</p></a></li>
<li><a href='#DNN_model'><p>Define and train the DNN-SIM model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Single-Index Neural Network for Skewed Heavy-Tailed Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Qingyang Liu &lt;rh8liuqy@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a deep neural network model with a monotonic increasing single index function tailored for periodontal disease studies. The residuals are assumed to follow a skewed T distribution, a skewed normal distribution, or a normal distribution. More details can be found at Liu, Huang, and Bai (2024) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2024.108012">doi:10.1016/j.csda.2024.108012</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Python (&gt;= 3.8.0); PyTorch (https://pytorch.org/);
NumPy (https://numpy.org/); SciPy (https://scipy.org/); sklearn
(https://scikit-learn.org/stable/);</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>reticulate (&ge; 1.37.0), stats (&ge; 4.3.0), Rdpack (&ge; 2.6)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-07 04:07:56 UTC; Kevin_Liu</td>
</tr>
<tr>
<td>Author:</td>
<td>Qingyang Liu <a href="https://orcid.org/0000-0003-3265-6330"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Shijie Wang [aut],
  Ray Bai <a href="https://orcid.org/0000-0002-7190-7844"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Dipankar Bandyopadhyay [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-07 16:50:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='DNNSIM'>The 'DNNSIM' package.</h2><span id='topic+DNNSIM-package'></span><span id='topic+DNNSIM'></span>

<h3>Description</h3>

<p>Provides a deep neural network model with a monotonic increasing single index function tailored for periodontal disease studies. The residuals are assumed to follow a skewed T distribution, a skewed normal distribution, or a normal distribution. More details can be found at Liu, Huang, and Bai (2024) <a href="doi:10.1016/j.csda.2024.108012">doi:10.1016/j.csda.2024.108012</a>.
</p>


<h3>Value</h3>

<p>This is the summary page. No return value.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Qingyang Liu <a href="mailto:rh8liuqy@gmail.com">rh8liuqy@gmail.com</a> (<a href="https://orcid.org/0000-0003-3265-6330">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Shijie Wang <a href="mailto:shijiew.usc@gmail.com">shijiew.usc@gmail.com</a>
</p>
</li>
<li><p> Ray Bai <a href="mailto:rbai@mailbox.sc.edu">rbai@mailbox.sc.edu</a> (<a href="https://orcid.org/0000-0002-7190-7844">ORCID</a>)
</p>
</li>
<li><p> Dipankar Bandyopadhyay <a href="mailto:dbandyop@vcu.edu">dbandyop@vcu.edu</a>
</p>
</li></ul>


<hr>
<h2 id='data_simulation'>Simulate data for the DNN-SIM model</h2><span id='topic+data_simulation'></span>

<h3>Description</h3>

<p>Simulate data for the DNN-SIM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_simulation(n, beta, w, sigma, delta, seed)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_simulation_+3A_n">n</code></td>
<td>
<p>an integer. The sample size.</p>
</td></tr>
<tr><td><code id="data_simulation_+3A_beta">beta</code></td>
<td>
<p>a vector. The covariate coefficients.</p>
</td></tr>
<tr><td><code id="data_simulation_+3A_w">w</code></td>
<td>
<p>a number between 0 and 1. The skewness parameter.</p>
</td></tr>
<tr><td><code id="data_simulation_+3A_sigma">sigma</code></td>
<td>
<p>a number larger than 0. The standard deviation parameter.</p>
</td></tr>
<tr><td><code id="data_simulation_+3A_delta">delta</code></td>
<td>
<p>a number larger than 0. The degree of freedom parameter.</p>
</td></tr>
<tr><td><code id="data_simulation_+3A_seed">seed</code></td>
<td>
<p>an integer. The random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a simple data generation function for a simulation study. All elements of the design matrix X follow a uniform distribution from -3.0 and 3.0 independently and identically. The true <code class="reqn">g</code> function is the standard logistic function.
</p>


<h3>Value</h3>

<p>a dataframe of the simulated response variable y and the design matrix X.
</p>


<h3>References</h3>

<p>Liu Q, Huang X, Bai R (2024).
&ldquo;Bayesian Modal Regression Based on Mixture Distributions.&rdquo;
<em>Computational Statistics &amp;amp; Data Analysis</em>, 108012.
<a href="https://doi.org/10.1016/j.csda.2024.108012">doi:10.1016/j.csda.2024.108012</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# check python module dependencies
if (reticulate::py_module_available("torch") &amp;
    reticulate::py_module_available("numpy") &amp;
    reticulate::py_module_available("sklearn") &amp;
    reticulate::py_module_available("scipy")) {
  df1 &lt;- data_simulation(n=50,beta=c(1,1,1),w=0.3,
                         sigma=0.1,delta=4.0,seed=100)
  print(head(df1))
}


</code></pre>

<hr>
<h2 id='DNN_model'>Define and train the DNN-SIM model</h2><span id='topic+DNN_model'></span>

<h3>Description</h3>

<p>Define and train the DNN-SIM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DNN_model(
  formula,
  data,
  model,
  num_epochs,
  verbatim = TRUE,
  CV = FALSE,
  CV_K = 10,
  bootstrap = FALSE,
  bootstrap_B = 1000,
  bootstrap_num_epochs = 100,
  U_new = FALSE,
  U_min = -4,
  U_max = 4,
  random_state = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DNN_model_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;<a href="stats.html#topic+formula">formula</a>&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_data">data</code></td>
<td>
<p>a data frame.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_model">model</code></td>
<td>
<p>the model type. It must be be one of &quot;N-GX-D&quot;,&quot;SN-GX-D&quot;,&quot;ST-GX-D&quot;,&quot;N-GX-B&quot;,&quot;SN-GX-B&quot;,&quot;ST-GX-B&quot;,&quot;N-FX&quot;,&quot;SN-FX&quot;,&quot;ST-FX&quot;.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_num_epochs">num_epochs</code></td>
<td>
<p>an integer. The number of complete passes through the training dataset.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_verbatim">verbatim</code></td>
<td>
<p>TRUE/FALSE.If <code>verbatim</code> is <code>TRUE</code>, then log information from training the DNN-SIM model will be printed.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_cv">CV</code></td>
<td>
<p>TRUE/FALSE. Whether use the cross-validation to measure the prediction accuracy.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_cv_k">CV_K</code></td>
<td>
<p>an integer. The number of folders K-folder cross-validation.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_bootstrap">bootstrap</code></td>
<td>
<p>TRUE/FALSE. Whether use the bootstrap method to quantify the uncertainty. The bootstrap option ONLY works for the &quot;ST-GX-D&quot; model.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_bootstrap_b">bootstrap_B</code></td>
<td>
<p>an integer. The number of bootstrap iteration.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_bootstrap_num_epochs">bootstrap_num_epochs</code></td>
<td>
<p>an integer. The number of complete passes through the training dataset in the bootstrap procedure.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_u_new">U_new</code></td>
<td>
<p>TRUE/FALSE. Whether use self defined U for the estimation of single index function, g(U).</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_u_min">U_min</code></td>
<td>
<p>a numeric value. The minimum of the self defined U.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_u_max">U_max</code></td>
<td>
<p>a numeric value. The maximum of the self defined U.</p>
</td></tr>
<tr><td><code id="DNN_model_+3A_random_state">random_state</code></td>
<td>
<p>an integer. The random seed for initiating the neural network.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The DNNSIM model is defined as:
</p>
<p style="text-align: center;"><code class="reqn">Y = g(\mathbf{X} \boldsymbol{\beta}) + e.</code>
</p>

<p>The residuals <code class="reqn">e</code> follow a skewed T distribution, skewed normal distribution, or normal distribution. The single index function <code class="reqn">g</code> is assumed to be a monotonic increasing function.
</p>


<h3>Value</h3>

<p>A list consisting of the point estimation, g function estimation (optional), cross-validation results (optional) and bootstrap results(optional).
</p>


<h3>References</h3>

<p>Liu Q, Huang X, Bai R (2024).
&ldquo;Bayesian Modal Regression Based on Mixture Distributions.&rdquo;
<em>Computational Statistics &amp;amp; Data Analysis</em>, 108012.
<a href="https://doi.org/10.1016/j.csda.2024.108012">doi:10.1016/j.csda.2024.108012</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# check python module dependencies
if (reticulate::py_module_available("torch") &amp;
    reticulate::py_module_available("numpy") &amp;
    reticulate::py_module_available("sklearn") &amp;
    reticulate::py_module_available("scipy")) {

  # set the random seed
  set.seed(100)

  # simulate some data
  df1 &lt;- data_simulation(n=100,beta=c(1,1,1),w=0.3,
                         sigma=0.1,delta=10.0,seed=100)

  # the cross-validation and bootstrap takes a long time
  DNN_model_output &lt;- DNN_model(y ~ X1 + X2 + X3 - 1,
                                data = df1,
                                model = "ST-GX-D",
                                num_epochs = 5,
                                verbatim = FALSE,
                                CV = TRUE,
                                CV_K = 2,
                                bootstrap = TRUE,
                                bootstrap_B = 2,
                                bootstrap_num_epochs = 5,
                                U_new = TRUE,
                                U_min = -4.0,
                                U_max = 4.0)
  print(DNN_model_output)
}



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
