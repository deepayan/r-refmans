<!DOCTYPE html><html lang="en-GB"><head><title>Help for package ctrdata</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ctrdata}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ctrdata-package'><p>ctrdata: Retrieve and Analyze Clinical Trials in Public Registers</p></a></li>
<li><a href='#ctrdata'><p>Getting started, database connection, function overview</p></a></li>
<li><a href='#ctrdata-registers'><p>Information on clinical trial registers</p></a></li>
<li><a href='#ctrdata-trial-concepts'><p>Trial concepts implemented across registers</p></a></li>
<li><a href='#ctrDb'><p>Check and prepare nodbi connection object for ctrdata</p></a></li>
<li><a href='#ctrFindActiveSubstanceSynonyms'><p>Find synonyms of an active substance</p></a></li>
<li><a href='#ctrGenerateQueries'><p>Generates queries that work across registers</p></a></li>
<li><a href='#ctrGetQueryUrl'><p>Get register name and query parameters from search URL</p></a></li>
<li><a href='#ctrLoadQueryIntoDb'><p>Load and store register trial information</p></a></li>
<li><a href='#ctrOpenSearchPagesInBrowser'><p>Open register to show query results or search page</p></a></li>
<li><a href='#ctrShowOneTrial'><p>Show full structure and all data of a trial</p></a></li>
<li><a href='#dbFindFields'><p>Find names of fields in the database collection</p></a></li>
<li><a href='#dbFindIdsUniqueTrials'><p>Get identifiers of deduplicated trial records</p></a></li>
<li><a href='#dbGetFieldsIntoDf'><p>Create data frame of specified fields from database collection</p></a></li>
<li><a href='#dbQueryHistory'><p>Show history of queries loaded into a database collection</p></a></li>
<li><a href='#dfMergeVariablesRelevel'><p>Merge variables, keeping type, and optionally relevel factors</p></a></li>
<li><a href='#dfName2Value'><p>Get value for variable of interest</p></a></li>
<li><a href='#dfTrials2Long'><p>Convert data frame with trial records into long format</p></a></li>
<li><a href='#f.controlType'><p>Calculate type of control data collected in a study</p></a></li>
<li><a href='#f.isMedIntervTrial'><p>Calculate if study is a medicine-interventional study</p></a></li>
<li><a href='#f.isUniqueTrial'><p>Calculate if record is unique for a study</p></a></li>
<li><a href='#f.likelyPlatformTrial'><p>Calculate if study is likely a platform trial or not</p></a></li>
<li><a href='#f.numSites'><p>Calculate number of sites of a study</p></a></li>
<li><a href='#f.numTestArmsSubstances'><p>Calculate type of control data collected in a study</p></a></li>
<li><a href='#f.primaryEndpointDescription'><p>Calculate details of a primary endpoint of a study</p></a></li>
<li><a href='#f.primaryEndpointResults'><p>Calculate type of control data collected in a study</p></a></li>
<li><a href='#f.resultsDate'><p>Calculate date of results of a study</p></a></li>
<li><a href='#f.sampleSize'><p>Calculate sample size of a study</p></a></li>
<li><a href='#f.sponsorType'><p>Calculate type of control data collected in a study</p></a></li>
<li><a href='#f.startDate'><p>Calculate start date of a study</p></a></li>
<li><a href='#f.statusRecruitment'><p>Calculate status of recruitment of a study</p></a></li>
<li><a href='#f.trialObjectives'><p>Calculate objectives of a study</p></a></li>
<li><a href='#f.trialPhase'><p>Calculate phase of a clinical trial</p></a></li>
<li><a href='#f.trialPopulation'><p>Calculate in- and exclusion criteria and age groups</p></a></li>
<li><a href='#f.trialTitle'><p>Calculate the title of a study</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Retrieve and Analyze Clinical Trials in Public Registers</td>
</tr>
<tr>
<td>Version:</td>
<td>1.21.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>jsonlite, httr, curl (&ge; 5.1.0), clipr, xml2, nodbi (&ge;
0.10.7), stringi, lubridate, jqr, dplyr, zip, V8, readr,
digest, rlang, countrycode, htmlwidgets, tibble, stringdist,
tidyr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cran.r-project.org/package=ctrdata">https://cran.r-project.org/package=ctrdata</a>,
<a href="https://rfhb.github.io/ctrdata/">https://rfhb.github.io/ctrdata/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/rfhb/ctrdata/issues">https://github.com/rfhb/ctrdata/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>A system for querying, retrieving and analyzing
        protocol- and results-related information on clinical trials from
        four public registers, the 'European Union Clinical Trials Register'
        ('EUCTR', <a href="https://www.clinicaltrialsregister.eu/">https://www.clinicaltrialsregister.eu/</a>), 
        'ClinicalTrials.gov' (<a href="https://clinicaltrials.gov/">https://clinicaltrials.gov/</a> and also 
        translating queries the retired classic interface), the 
        'ISRCTN' (<a href="http://www.isrctn.com/">http://www.isrctn.com/</a>) and the
        'European Union Clinical Trials Information System'
        ('CTIS', <a href="https://euclinicaltrials.eu/">https://euclinicaltrials.eu/</a>). 
        Trial information is downloaded, converted and stored in a database 
        ('PostgreSQL', 'SQLite', 'DuckDB' or 'MongoDB'; via package 'nodbi'). 
        Documents in registers associated with trials can also be downloaded. 
        Other functions implement trial concepts canonically across registers,
        identify deduplicated records, easily find and extract variables 
        (fields) of interest even from complex nested data as used by the 
        registers, merge variables and update queries. 
        The package can be used for meta-analysis and trend-analysis of
        the design and conduct as well as of the results of clinical trials 
        across registers.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>devtools, knitr, rmarkdown, RSQLite, mongolite, tinytest (&ge;
1.2.1), RPostgres, duckdb</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-15 19:54:24 UTC; ralfherold</td>
</tr>
<tr>
<td>Author:</td>
<td>Ralf Herold <a href="https://orcid.org/0000-0002-8148-6748"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ralf Herold &lt;ralf.herold@mailbox.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-15 22:10:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='ctrdata-package'>ctrdata: Retrieve and Analyze Clinical Trials in Public Registers</h2><span id='topic+ctrdata-package'></span>

<h3>Description</h3>

<p>A system for querying, retrieving and analyzing protocol- and results-related information on clinical trials from four public registers, the 'European Union Clinical Trials Register' ('EUCTR', <a href="https://www.clinicaltrialsregister.eu/">https://www.clinicaltrialsregister.eu/</a>), 'ClinicalTrials.gov' (<a href="https://clinicaltrials.gov/">https://clinicaltrials.gov/</a> and also translating queries the retired classic interface), the 'ISRCTN' (<a href="http://www.isrctn.com/">http://www.isrctn.com/</a>) and the 'European Union Clinical Trials Information System' ('CTIS', <a href="https://euclinicaltrials.eu/">https://euclinicaltrials.eu/</a>). Trial information is downloaded, converted and stored in a database ('PostgreSQL', 'SQLite', 'DuckDB' or 'MongoDB'; via package 'nodbi'). Documents in registers associated with trials can also be downloaded. Other functions implement trial concepts canonically across registers, identify deduplicated records, easily find and extract variables (fields) of interest even from complex nested data as used by the registers, merge variables and update queries. The package can be used for meta-analysis and trend-analysis of the design and conduct as well as of the results of clinical trials across registers.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Ralf Herold <a href="mailto:ralf.herold@mailbox.org">ralf.herold@mailbox.org</a> (<a href="https://orcid.org/0000-0002-8148-6748">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://cran.r-project.org/package=ctrdata">https://cran.r-project.org/package=ctrdata</a>
</p>
</li>
<li> <p><a href="https://rfhb.github.io/ctrdata/">https://rfhb.github.io/ctrdata/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/rfhb/ctrdata/issues">https://github.com/rfhb/ctrdata/issues</a>
</p>
</li></ul>


<hr>
<h2 id='ctrdata'>Getting started, database connection, function overview</h2><span id='topic+ctrdata'></span>

<h3>Description</h3>

<p><code>ctrdata</code> is a package for aggregating and analysing information on clinical
studies, and for obtaining documents, from public trial registers
</p>


<h3>1 - Database connection</h3>

<p>Package <code>ctrdata</code> retrieves trial information and stores it in a database
collection. Therefore, a database connection object has to be given to
parameter <code>con</code> for several <code>ctrdata</code> functions.
The connection object is built using <code>nodbi</code> which allows to use
different database backends.
Specifying a <code>collection = "&lt;my collection's name&gt;"</code> is
necessary for package <code>ctrdata</code>.
A connection object (here called <code>dbc</code>) is created in almost identical
ways for these supported backends:</p>

<table>
<tr>
 <td style="text-align: left;">
   <em>Database</em> </td><td style="text-align: left;"> <em>Connection object</em> </td>
</tr>
<tr>
 <td style="text-align: left;">
   MongoDB </td><td style="text-align: left;"> <code>dbc &lt;- <a href="nodbi.html#topic+src_mongo">nodbi::src_mongo</a>(db = "my_db", collection = "my_coll")</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   DuckDB </td><td style="text-align: left;"> <code>dbc &lt;- <a href="nodbi.html#topic+src_duckdb">nodbi::src_duckdb</a>(dbname = "my_db", collection = "my_coll")</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   SQLite </td><td style="text-align: left;"> <code>dbc &lt;- <a href="nodbi.html#topic+src_sqlite">nodbi::src_sqlite</a>(dbname = "my_db", collection = "my_coll")</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   PostgreSQL </td><td style="text-align: left;"> <code>dbc &lt;- <a href="nodbi.html#topic+src_postgres">nodbi::src_postgres</a>(dbname = "my_db"); dbc[["collection"]] &lt;- "my_coll"</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>2 - Operate on a clinical trial register</h3>

<p><a href="#topic+ctrOpenSearchPagesInBrowser">ctrOpenSearchPagesInBrowser</a>,
<a href="#topic+ctrLoadQueryIntoDb">ctrLoadQueryIntoDb</a> (load trial records into database collection);
see
<a href="#topic+ctrdata-registers">ctrdata-registers</a> for details on registers and how to search.
</p>


<h3>3 - Get a data frame from the database collection</h3>

<p><a href="#topic+ctrShowOneTrial">ctrShowOneTrial</a> (show widget to explore structure, fields and data of a trial),
<a href="#topic+dbFindFields">dbFindFields</a> (find names of fields of interest in trial records in a collection),
<a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a> (create a data frame with fields of interest and calculated trial concepts from collection),
<a href="#topic+dbFindIdsUniqueTrials">dbFindIdsUniqueTrials</a> (get de-duplicated identifiers of clinical trials' records to subset a data frame).
</p>


<h3>4 - Operate on a data frame with trial information</h3>

<p><a href="#topic+dfTrials2Long">dfTrials2Long</a> (convert fields with nested elements into long format),
<a href="#topic+dfName2Value">dfName2Value</a> (get values for variable(s) of interest).
</p>


<h3>Author(s)</h3>

<p>Ralf Herold <a href="mailto:ralf.herold@mailbox.org">ralf.herold@mailbox.org</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://cran.r-project.org/package=ctrdata">https://cran.r-project.org/package=ctrdata</a>
</p>
</li>
<li> <p><a href="https://rfhb.github.io/ctrdata/">https://rfhb.github.io/ctrdata/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/rfhb/ctrdata/issues">https://github.com/rfhb/ctrdata/issues</a>
</p>
</li></ul>


<hr>
<h2 id='ctrdata-registers'>Information on clinical trial registers</h2><span id='topic+ctrdata-registers'></span>

<h3>Description</h3>

<p>Registers of the four clinical trial registers from which package
<a href="#topic+ctrdata">ctrdata</a> can retrieve, aggregate and analyse protocol- and
result-related information as well as documents, last updated 2025-03-09.
</p>


<h3>1 - Overview</h3>


<ul>
<li> <p><strong>EUCTR</strong>: The EU Clinical Trials Register holds more than 44,300 clinical
trials (at least one investigational medicinal product, IMP; in the European
Union and beyond), including almost 25,000 trials with results, which continue
to be added (can be loaded by <code>ctrdata</code>).
</p>
</li>
<li> <p><strong>CTIS</strong>: The EU Clinical Trials Information System, launched in 2023,
holds more than 8,700 publicly accessible clinical trials, including
around 100 with results or a report (only as PDF files).
<em>No results in a structured electronic format are foreseeably available</em>,
thus <code>ctrdata</code> cannot load any CTIS results.
(To automatically get CTIS search query URLs, see
<a href="https://rfhb.github.io/ctrdata/#id_2-script-to-automatically-copy-users-query-from-web-browser">here</a>)
</p>
</li>
<li> <p><strong>CTGOV2</strong>: ClinicalTrials.gov holds more than 529,000 interventional and
observational studies, including almost 66,000 interventional studies with
results (can be loaded by <code>ctrdata</code>).
</p>
</li>
<li> <p><strong>ISRCTN</strong>: The ISRCTN Registry holds more than 26,000 interventional and
observational health studies, including almost 14,200 studies with
results (only as references).
<em>No results in a structured electronic format are foreseeably available</em>,
thus <code>ctrdata</code> cannot load any ISRCTN results.
</p>
</li></ul>



<h3>2 - Notable changes</h3>

<p>CTGOV &quot;classic&quot; was retired on 2024-06-25; <code>ctrdata</code> subsequently translates
CTGOV queries to CTGOV2 queries. The new website (&quot;CTGOV2&quot;) can be used with
<code>ctrdata</code> since 2023-08-27. Database collections created with CTGOV queries
can still be used since functions in <code>ctrdata</code> continue to support them.
CTIS was relaunched on 2024-06-17, changing the data structure and search
syntax, to which <code>ctrdata</code> was updated.
CTIS can be used with <code>ctrdata</code> since 2023-03-25.
EUCTR removed search parameter <code style="white-space: pre;">&#8288;status=&#8288;</code> as of February 2025.
More information on changes:
<a href="https://rfhb.github.io/ctrdata/news/index.html">here</a>.
</p>


<h3>3 - References</h3>


<table>
<tr>
 <td style="text-align: left;">
   <strong>Material</strong> </td><td style="text-align: center;"> <strong>EUCTR</strong> </td><td style="text-align: center;"> <strong>CTGOV2</strong> </td><td style="text-align: center;"> <strong>ISRCTN</strong> </td><td style="text-align: center;"> <strong>CTIS</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
   About </td><td style="text-align: center;"> <a href="https://www.clinicaltrialsregister.eu/about.html">link</a> </td><td style="text-align: center;"> <a href="https://clinicaltrials.gov/about-site/about-ctg">link</a> </td><td style="text-align: center;"> <a href="https://www.isrctn.com/page/about">link</a> </td><td style="text-align: center;"> <a href="https://euclinicaltrials.eu/about-this-website/">link</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Terms &amp; conditions, disclaimer </td><td style="text-align: center;"> <a href="https://www.clinicaltrialsregister.eu/disclaimer.html">link</a> </td><td style="text-align: center;"> <a href="https://clinicaltrials.gov/about-site/terms-conditions">link</a> </td><td style="text-align: center;"> <a href="https://www.isrctn.com/page/faqs#using-the-isrctn">link</a> </td><td style="text-align: center;"> <a href="https://euclinicaltrials.eu/guidance-and-q-as/">link</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
   How to search </td><td style="text-align: center;"> <a href="https://www.clinicaltrialsregister.eu/doc/How_to_Search_EU_CTR.pdf">link</a> </td><td style="text-align: center;"> <a href="https://clinicaltrials.gov/find-studies/how-to-search">link</a> </td><td style="text-align: center;"> <a href="https://www.isrctn.com/page/search-tips">link</a> </td><td style="text-align: center;"> <a href="https://euclinicaltrials.eu/search-tips-and-guidance/">link</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Search interface </td><td style="text-align: center;"> <a href="https://www.clinicaltrialsregister.eu/ctr-search/search">link</a> </td><td style="text-align: center;"> <a href="https://clinicaltrials.gov/">link</a> </td><td style="text-align: center;"> <a href="https://www.isrctn.com/">link</a> </td><td style="text-align: center;"> <a href="https://euclinicaltrials.eu/search-for-clinical-trials/">link</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Expert / advanced search </td><td style="text-align: center;"> <a href="https://www.clinicaltrialsregister.eu/ctr-search/search">link</a> </td><td style="text-align: center;"> <a href="https://clinicaltrials.gov/expert-search">link</a> </td><td style="text-align: center;"> <a href="https://www.isrctn.com/editAdvancedSearch">link</a> </td><td style="text-align: center;"> <a href="https://euclinicaltrials.eu/ctis-public/search">link</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Glossary / related information </td><td style="text-align: center;"> <a href="https://www.clinicaltrialsregister.eu/doc/EU_Clinical_Trials_Register_Glossary.pdf">link</a> </td><td style="text-align: center;"> <a href="https://clinicaltrials.gov/study-basics/glossary">link</a> </td><td style="text-align: center;"> <a href="https://www.who.int/clinical-trials-registry-platform/network/who-data-set">link</a> </td><td style="text-align: center;"> <a href="https://accelerating-clinical-trials.europa.eu/">link</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
   FAQ, caveats, issues </td><td style="text-align: center;"> <a href="https://www.clinicaltrialsregister.eu/doc/EU_CTR_FAQ.pdf">link</a> </td><td style="text-align: center;"> <a href="https://clinicaltrials.gov/policy/faq">link</a>, <a href="https://clinicaltrials.gov/about-site/selected-publications">link</a> </td><td style="text-align: center;"> <a href="https://www.isrctn.com/page/faqs">link</a> </td><td style="text-align: center;"> <a href="https://euclinicaltrials.eu/website-outages-and-system-releases/">link</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Data dictionaries / definitions / structure reference </td><td style="text-align: center;"> <a href="https://eudract.ema.europa.eu/result.html">link</a> </td><td style="text-align: center;"> <a href="https://cdn.clinicaltrials.gov/documents/xsd/public.xsd">link</a>, <a href="https://clinicaltrials.gov/data-about-studies/study-data-structure">link</a>, <a href="https://cdn.clinicaltrials.gov/documents/tutorial/content/index.html">link</a> </td><td style="text-align: center;"> <a href="https://www.isrctn.com/page/definitions">link</a> </td><td style="text-align: center;"> <a href="https://www.ema.europa.eu/en/human-regulatory-overview/research-development/clinical-trials-human-medicines/clinical-trials-information-system-ctis-training-support">link</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Example* </td><td style="text-align: center;"> <a href="https://www.clinicaltrialsregister.eu/ctr-search/search?query=Infections&amp;age=newborn&amp;age=preterm-new-born-infants">link</a> </td><td style="text-align: center;"> <a href="https://clinicaltrials.gov/search?ageRange=0M_1M&amp;cond=Infections&amp;aggFilters=studyType:int&amp;distance=50&amp;intr=Investigational+Agent">link</a> </td><td style="text-align: center;"> <a href="https://www.isrctn.com/search?q=&amp;filters=ageRange:Neonate,conditionCategory:Infections+and+Infestations&amp;searchType=advanced-search">link</a> </td><td style="text-align: center;"> <a href="https://euclinicaltrials.eu/ctis-public/search#searchCriteria=%7B%22containAll%22:%22infection%22,%22containAny%22:%22neonates%22%7D">link</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Some registers are expanding entered search terms using dictionaries.
</p>


<h3>4 - Example and ctrdata motivation</h3>

<p>*The example is an expert search for interventional trials primarily with
neonates, investigating treatments for infectious conditions. It shows that
searches in the web interface of most registers are not sufficient to
identify the trials of interest:
</p>

<ul>
<li><p> EUCTR retrieves trials with neonates, but not only those exclusively in neonates.
</p>
</li>
<li><p> ISRCTN retrieves studies with interventions other than medicines.
</p>
</li>
<li><p> CTIS retrieves trials that mention the words neonates and infection. (To
show CTIS search results, see <a href="https://rfhb.github.io/ctrdata/#id_2-script-to-automatically-copy-users-query-from-web-browser">here</a>)
</p>
</li></ul>

<p>To address this issue, trials can be retrieved with <a href="#topic+ctrLoadQueryIntoDb">ctrLoadQueryIntoDb</a>
into a database collection and in a second step trials of interest can be
selected based on values of relevant fields, for example:
</p>

<ul>
<li><p> EUCTR field <code>f115_children_211years</code> and other age group criteria
</p>
</li>
<li><p> ISRCTN field <code>interventions.intervention.interventionType</code> for type of study
</p>
</li>
<li><p> CTIS fields <code>ageGroup</code> and <code>authorizedApplication.authorizedPartI.medicalConditions.medicalCondition</code>
</p>
</li></ul>

<p><code>ctrdata</code> supports users in identifying fields with functions
<a href="#topic+dbFindFields">dbFindFields</a> and <a href="#topic+ctrShowOneTrial">ctrShowOneTrial</a>.
</p>


<h3>Author(s)</h3>

<p>Ralf Herold <a href="mailto:ralf.herold@mailbox.org">ralf.herold@mailbox.org</a>
</p>

<hr>
<h2 id='ctrdata-trial-concepts'>Trial concepts implemented across registers</h2><span id='topic+ctrdata-trial-concepts'></span>

<h3>Description</h3>

<p><code>ctrdata</code> includes (since version 1.21.0) functions that implement selected
trial concepts. Concepts of clinical trials, such as their start or status of
recruitment, require to analyse several fields against various
pre-defined values. The structure and value sets of fields differ between
all <a href="#topic+ctrdata-registers">ctrdata-registers</a>. In this situation, the implemented trial
concepts simplify and accelerate a user's analysis workflow and also increase
analysis consistency.
</p>


<h3>Details</h3>

<p>The implementation of trial concepts in <code>ctrdata</code> has not been validated
with any formal approach, but has been checked for plausibility and
against expectations. The implementation is based on current
understanding, on public data models and on scientific papers, as relevant.
As with other <code>R</code> functions, call <code>help("f.startDate")</code> or print its
implementation code by entering the name of the function as command,
e.g. <code>f.startDate</code>.
Please raise an issue <a href="https://github.com/rfhb/ctrdata/issues">here</a>
to ask about or improve a trial concept.
</p>
<p>The following trial concepts can be used by referencing their name when
calling <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a> (parameter <code>calculate</code>).
Concepts will continue to be refined and added;
last updated 2025-03-15.
</p>

<ul>
<li> <p><a href="#topic+f.controlType">f.controlType</a> (factor) which type of internal or concurrent control
is used in the trial? (&quot;none&quot;, &quot;no-treatment&quot;, &quot;placebo&quot;, &quot;active&quot;,
&quot;placebo+active&quot; or &quot;other&quot;)
</p>
</li>
<li> <p><a href="#topic+f.isMedIntervTrial">f.isMedIntervTrial</a> (logical) is the trial interventional and does
it have one or more medicines (drugs or biological) as investigational
(experimental) intervention? (irrespective of status of authorisation and
of study design)
</p>
</li>
<li> <p><a href="#topic+f.isUniqueTrial">f.isUniqueTrial</a> (logical) is the trial record unique in the data
frame of trial, based on default parameters of <a href="#topic+dbFindIdsUniqueTrials">dbFindIdsUniqueTrials</a>?
</p>
</li>
<li> <p><a href="#topic+f.likelyPlatformTrial">f.likelyPlatformTrial</a> (logical) is the trial possibly a (research)
platform trial, and what are related trials? (based on trial title,
f.numTestArmsSubstances, number of periods)
</p>
</li>
<li> <p><a href="#topic+f.numSites">f.numSites</a> (integer) how many sites does the trial have?
</p>
</li>
<li> <p><a href="#topic+f.numTestArmsSubstances">f.numTestArmsSubstances</a> (integer) how many arms or groups have
medicines that are investigational? (cannot be calculated for ISRCTN or
for phase 1 trials)
</p>
</li>
<li> <p><a href="#topic+f.primaryEndpointDescription">f.primaryEndpointDescription</a> (list of character) string containing
protocol definition, details and time frames, concatenated with &quot; == &quot;
</p>
</li>
<li> <p><a href="#topic+f.primaryEndpointResults">f.primaryEndpointResults</a> (columns of number, character, integer)
returning the statistical testing p value and method as well as the number
of subjects included in the test, each in one new column, for the first
primary endpoint only
</p>
</li>
<li> <p><a href="#topic+f.resultsDate">f.resultsDate</a> (date) the planned or achieved date of results availability
</p>
</li>
<li> <p><a href="#topic+f.startDate">f.startDate</a> (date) the planned, authorised or documented date
of start of recruitment
</p>
</li>
<li> <p><a href="#topic+f.sampleSize">f.sampleSize</a> (integer) the achieved (or planned) number of subjects
or participants recruited
</p>
</li>
<li> <p><a href="#topic+f.sponsorType">f.sponsorType</a> (factor) a type or class of main or lead sponsor that
is simplified to &quot;not for profit&quot;, &quot;for profit&quot; or &quot;other&quot;
</p>
</li>
<li> <p><a href="#topic+f.statusRecruitment">f.statusRecruitment</a> (factor) a status that is simplified to
&quot;ongoing&quot; (includes temporarily halted), &quot;completed&quot;, &quot;ended early&quot; (includes
terminated or ended prematurely) and &quot;other&quot; (includes planned, stopped,
withdrawn)
</p>
</li>
<li> <p><a href="#topic+f.trialObjectives">f.trialObjectives</a> (string) identifies with letters those objectives
that could be identified by text fragments, e.g. &quot;E S PD D&quot;, with &quot;E&quot;
(efficacy), &quot;S&quot; (safety), &quot;D&quot; (dose-finding)
</p>
</li>
<li> <p><a href="#topic+f.trialPhase">f.trialPhase</a> (ordered factor) the phase(s) of medicine development
with which a trial is associated
</p>
</li>
<li> <p><a href="#topic+f.trialPopulation">f.trialPopulation</a> (columns of factor, string and string) age groups
(e.g., &quot;P&quot; for paediatric participants, &quot;A&quot; for adults, &quot;E&quot; for older than
65 years, or &quot;P+A&quot;), inclusion and exclusion criteria texts
</p>
</li>
<li> <p><a href="#topic+f.trialTitle">f.trialTitle</a> (string) full or scientific title of the study
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Ralf Herold <a href="mailto:ralf.herold@mailbox.org">ralf.herold@mailbox.org</a>
</p>

<hr>
<h2 id='ctrDb'>Check and prepare nodbi connection object for ctrdata</h2><span id='topic+ctrDb'></span>

<h3>Description</h3>

<p>Check and prepare nodbi connection object for ctrdata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctrDb(con)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ctrDb_+3A_con">con</code></td>
<td>
<p>A database connection object, created with
<code>nodbi</code>. See section '1 - Database connection' in
<a href="#topic+ctrdata">ctrdata</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Connection object as list, with collection
element under root
</p>

<hr>
<h2 id='ctrFindActiveSubstanceSynonyms'>Find synonyms of an active substance</h2><span id='topic+ctrFindActiveSubstanceSynonyms'></span>

<h3>Description</h3>

<p>An active substance can be identified by a recommended international
nonproprietary name (INN), a trade or product name, or a company code(s).
To find likely synonyms, the function retrieves from CTGOV2 the field
protocolSection.armsInterventionsModule.interventions.otherNames.
Note this does not seem to be based on choices from a dictionary but
may be manually filled, thus is not free of error and needs to be checked.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctrFindActiveSubstanceSynonyms(activesubstance = "", verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ctrFindActiveSubstanceSynonyms_+3A_activesubstance">activesubstance</code></td>
<td>
<p>An active substance, in an atomic character vector</p>
</td></tr>
<tr><td><code id="ctrFindActiveSubstanceSynonyms_+3A_verbose">verbose</code></td>
<td>
<p>Print number of studies found in CTGOV2 for 'activesubstance'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of the active substance (input parameter) and
synonyms, or NULL if active substance was not found and may be invalid
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

ctrFindActiveSubstanceSynonyms(activesubstance = "imatinib")
#  [1] "imatinib"          "CGP 57148"         "CGP 57148B"
#  [4] "CGP57148B"         "Gleevec"           "GLIVEC"
#  [7] "Imatinib"          "Imatinib Mesylate" "NSC 716051"
# [10] "ST1571"            "STI 571"           "STI571"

## End(Not run)

</code></pre>

<hr>
<h2 id='ctrGenerateQueries'>Generates queries that work across registers</h2><span id='topic+ctrGenerateQueries'></span>

<h3>Description</h3>

<p>From high-level search terms provided by the user, generate specific queries
for each registers with which ctrdata works, see <a href="#topic+ctrdata-registers">ctrdata-registers</a>.
Search terms that are expanded to concepts such as from MeSH and MedDRA
by the search implementations in registers include the
'intervention' and 'condition', see <a href="#topic+ctrdata-registers">ctrdata-registers</a>.
Logical operators only work with 'searchPhrase'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctrGenerateQueries(
  searchPhrase = NULL,
  condition = NULL,
  intervention = NULL,
  phase = NULL,
  population = NULL,
  recruitment = NULL,
  startBefore = NULL,
  startAfter = NULL,
  completedBefore = NULL,
  completedAfter = NULL,
  onlyWithResults = FALSE,
  registers = c("EUCTR", "ISRCTN", "CTIS", "CTGOV2")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ctrGenerateQueries_+3A_searchphrase">searchPhrase</code></td>
<td>
<p>String with optional logical operators (&quot;AND&quot;, &quot;OR&quot;)
that will be searched in selected fields of registers that can handle logical
operators (general or title fields), should not include quotation marks</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_condition">condition</code></td>
<td>
<p>String with condition / disease</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_intervention">intervention</code></td>
<td>
<p>String with intervention</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_phase">phase</code></td>
<td>
<p>String, e.g. &quot;phase 2&quot; (note that &quot;phase 2+3&quot; is a specific
category, not the union set of &quot;phase 2&quot; and &quot;phase 3&quot;)</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_population">population</code></td>
<td>
<p>String, e.g. &quot;P&quot; (paediatric), &quot;A&quot; (adult), &quot;P+A&quot;
(adult and paediatric), &quot;E&quot; (elderly), &quot;P+A+E&quot; participants can be recruited</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_recruitment">recruitment</code></td>
<td>
<p>String, one of &quot;ongoing&quot;, &quot;completed&quot;, &quot;other&quot; (
which includes &quot;ended early&quot; but this cannot be searched; use trial concept
<a href="#topic+f.statusRecruitment">f.statusRecruitment</a> to identify this status)</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_startbefore">startBefore</code></td>
<td>
<p>String that can be interpreted as date, see example</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_startafter">startAfter</code></td>
<td>
<p>String that can be interpreted as date</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_completedbefore">completedBefore</code></td>
<td>
<p>String that can be interpreted as date (does not work
with EUCTR)</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_completedafter">completedAfter</code></td>
<td>
<p>String that can be interpreted as date (does not work
with EUCTR)</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_onlywithresults">onlyWithResults</code></td>
<td>
<p>Logical</p>
</td></tr>
<tr><td><code id="ctrGenerateQueries_+3A_registers">registers</code></td>
<td>
<p>Vector of register names, default all registers</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named vector of URLs for finding trials in the registers and as
input to functions <a href="#topic+ctrLoadQueryIntoDb">ctrLoadQueryIntoDb</a> and
<a href="#topic+ctrOpenSearchPagesInBrowser">ctrOpenSearchPagesInBrowser</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
urls &lt;- ctrGenerateQueries(
  intervention = "antibody",
  phase = "phase 3",
  startAfter = "2000-01-01")

# open queries in register web interface
sapply(urls, ctrOpenSearchPagesInBrowser)

urls &lt;- ctrGenerateQueries(
  searchPhrase = "antibody AND covid",
  recruitment = "completed")

# count trials found
sapply(urls, ctrLoadQueryIntoDb, only.count = TRUE)

# load queries into database collection
# sapply(urls, ctrLoadQueryIntoDb, con = dbc)

# find research platform and platform trials
urls &lt;- ctrGenerateQueries(
  searchPhrase = paste0(
   "basket OR platform OR umbrella OR master protocol OR ",
   "multiarm OR multistage OR subprotocol OR substudy OR ",
   "multi-arm OR multi-stage OR sub-protocol OR sub-study"),
 startAfter = "2010-01-01")

# open queries in register web interface
sapply(urls, ctrOpenSearchPagesInBrowser)

</code></pre>

<hr>
<h2 id='ctrGetQueryUrl'>Get register name and query parameters from search URL</h2><span id='topic+ctrGetQueryUrl'></span>

<h3>Description</h3>

<p>Extracts query parameters and register name from parameter 'url' or
from the clipboard, into which the URL of a register search was copied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctrGetQueryUrl(url = "", register = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ctrGetQueryUrl_+3A_url">url</code></td>
<td>
<p>URL such as from the browser address bar.
If not specified, clipboard contents will be checked for
a suitable URL.
For automatically copying the user's query of a register
in a web browser to the clipboard, see
<a href="https://rfhb.github.io/ctrdata/#id_2-script-to-automatically-copy-users-query-from-web-browser">here</a>.
Can also contain a query term such as from
<a href="#topic+dbQueryHistory">dbQueryHistory</a>()[&quot;query-term&quot;].
Can also be an identifier of a trial, which based on its
format will indicate to which register it relates.</p>
</td></tr>
<tr><td><code id="ctrGetQueryUrl_+3A_register">register</code></td>
<td>
<p>Optional name of register (one of &quot;EUCTR&quot;, &quot;CTGOV2&quot;
&quot;ISRCTN&quot; or &quot;CTIS&quot;) in case 'url' is a query term but not a full URL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (or tibble, if <code>tibble</code> is loaded)
with column names 'query-term' and 'query-register'.
The data frame (or tibble) can be passed as such as parameter
'queryterm' to <a href="#topic+ctrLoadQueryIntoDb">ctrLoadQueryIntoDb</a> and as parameter
'url' to <a href="#topic+ctrOpenSearchPagesInBrowser">ctrOpenSearchPagesInBrowser</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# user copied into the clipboard the URL from
# the address bar of the browser that shows results
# from a query in one of the trial registers
if (interactive()) try(ctrGetQueryUrl(), silent = TRUE)

# extract query parameters from search result URL
# (URL was cut for the purpose of formatting only)
ctrGetQueryUrl(
    url = paste0(
        "https://classic.clinicaltrials.gov/ct2/results?",
        "cond=&amp;term=AREA%5BMaximumAge%5D+RANGE%5B0+days%2C+28+days%5D",
        "&amp;type=Intr&amp;rslt=&amp;age_v=&amp;gndr=&amp;intr=Drugs%2C+Investigational",
        "&amp;titles=&amp;outc=&amp;spons=&amp;lead=&amp;id=&amp;cntry=&amp;state=&amp;city=&amp;dist=",
        "&amp;locn=&amp;phase=2&amp;rsub=&amp;strd_s=01%2F01%2F2015&amp;strd_e=01%2F01%2F2016",
        "&amp;prcd_s=&amp;prcd_e=&amp;sfpd_s=&amp;sfpd_e=&amp;rfpd_s=&amp;rfpd_e=&amp;lupd_s=&amp;lupd_e=&amp;sort="
    )
)

# other examples
ctrGetQueryUrl("https://www.clinicaltrialsregister.eu/ctr-search/trial/2007-000371-42/results")
ctrGetQueryUrl("https://euclinicaltrials.eu/ctis-public/view/2022-500041-24-00")
ctrGetQueryUrl("https://classic.clinicaltrials.gov/ct2/show/NCT01492673?cond=neuroblastoma")
ctrGetQueryUrl("https://clinicaltrials.gov/ct2/show/NCT01492673?cond=neuroblastoma")
ctrGetQueryUrl("https://clinicaltrials.gov/study/NCT01467986?aggFilters=ages:child")
ctrGetQueryUrl("https://www.isrctn.com/ISRCTN70039829")

# using identifiers of single trials
ctrGetQueryUrl("70039829")
ctrGetQueryUrl("ISRCTN70039829")
ctrGetQueryUrl("NCT00617929")
ctrGetQueryUrl("2022-501142-30-00")
ctrGetQueryUrl("2012-003632-23")

</code></pre>

<hr>
<h2 id='ctrLoadQueryIntoDb'>Load and store register trial information</h2><span id='topic+ctrLoadQueryIntoDb'></span>

<h3>Description</h3>

<p>Retrieves information on clinical trials from registers
and stores it in a collection in a database. Main function
of <a href="#topic+ctrdata">ctrdata</a> for accessing registers.
A collection can store trial information from different queries
or different registers. Query details are stored in the
collection and can be accessed using <a href="#topic+dbQueryHistory">dbQueryHistory</a>.
A previous query can be re-run, which replaces or adds trial
records while keeping any user annotations of trial records.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctrLoadQueryIntoDb(
  queryterm = NULL,
  register = "",
  querytoupdate = NULL,
  forcetoupdate = FALSE,
  euctrresults = FALSE,
  euctrresultshistory = FALSE,
  ctgov2history = FALSE,
  documents.path = NULL,
  documents.regexp = "prot|sample|statist|sap_|p1ar|p2ars|icf|ctalett|lay|^[0-9]+ ",
  annotation.text = "",
  annotation.mode = "append",
  only.count = FALSE,
  con = NULL,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ctrLoadQueryIntoDb_+3A_queryterm">queryterm</code></td>
<td>
<p>Either a string with the full URL of a search
query in a register, or the data frame returned by
<a href="#topic+ctrGetQueryUrl">ctrGetQueryUrl</a> or <a href="#topic+dbQueryHistory">dbQueryHistory</a>,
or an '_id' in the format of one of the trial registers,
or, together with <code>register</code>, a string with query
elements of a search URL.
The query details are recorded in the <code>collection</code> for
later use to update records.
For &quot;CTIS&quot;, <code>queryterm</code> can be an empty string to obtain
all trial records. For automatically copying the user's
query of a register in a web browser to the clipboard, see
<a href="https://rfhb.github.io/ctrdata/#id_2-script-to-automatically-copy-users-query-from-web-browser">here</a></p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_register">register</code></td>
<td>
<p>String with abbreviation of register to query,
either &quot;EUCTR&quot;, &quot;CTGOV2&quot;, &quot;ISRCTN&quot; or &quot;CTIS&quot;. Not needed
if <code>queryterm</code> has a full URL to query results,
or has a single trial identifier, or comes from
<a href="#topic+ctrGetQueryUrl">ctrGetQueryUrl</a> or <a href="#topic+dbQueryHistory">dbQueryHistory</a>.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_querytoupdate">querytoupdate</code></td>
<td>
<p>Either the word &quot;last&quot;, or the row number of
a query in the data frame returned by <a href="#topic+dbQueryHistory">dbQueryHistory</a> that
should be run to retrieve any new or update trial records since
this query was run the last time.
This parameter takes precedence over <code>queryterm</code>.
For &quot;EUCTR&quot;, updates are available only for the last seven days;
the query is run again if more time has passed since it was
run last.
Does not work with &quot;CTIS&quot; at this time.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_forcetoupdate">forcetoupdate</code></td>
<td>
<p>If <code>TRUE</code>, run again the query
given in <code>querytoupdate</code>, irrespective of when it was
run last. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_euctrresults">euctrresults</code></td>
<td>
<p>If <code>TRUE</code>, also download available
results when retrieving and loading trials from EUCTR. This
slows down this function. (For &quot;CTGOV2&quot; and &quot;CTIS&quot;,
available results are always retrieved and loaded into the
collection.)</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_euctrresultshistory">euctrresultshistory</code></td>
<td>
<p>If <code>TRUE</code>, download results and also
the available history of results publication in &quot;EUCTR.&quot;
This somewhat time-consuming. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_ctgov2history">ctgov2history</code></td>
<td>
<p>For trials from CTGOV2, retrieve historic
versions of the record. Default is <code>FALSE</code>, because this
is a time-consuming operation. Use
<code>n</code> for n from all versions (recommended),
<code>1</code> for the first (original) version,
<code>-1</code> for the last-but-one version,
<code>"n:m"</code> for the nth to the mth versions, or
<code>TRUE</code> for all versions
of the trial record to be retrieved. Note that for register
CTIS, historic versions were available in the 'applications'
field only before the register's relaunch on 2024-06-17.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_documents.path">documents.path</code></td>
<td>
<p>If this is a relative or absolute
path to a directory that exists or can be created,
save any documents into it that are directly available from
the register (&quot;EUCTR&quot;, &quot;CTGOV2&quot;, &quot;ISRCTN&quot;, &quot;CTIS&quot;)
such as PDFs on results, analysis plans, spreadsheets,
patient information sheets, assessments or product information.
Default is <code>NULL</code>, which disables saving documents.
For &quot;EUCTR&quot;, sets <code>euctrresults = TRUE</code> since documents
are available only with results.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_documents.regexp">documents.regexp</code></td>
<td>
<p>Regular expression, case insensitive,
to select documents by filename, if saving documents is requested
(see <code>documents.path</code>).
If set to <code>NULL</code>, empty placeholder files are saved for
every document that could be saved, which is useful to get an overview
on the number and types of documents available for download.
Default is
<code>"prot|sample|statist|sap_|p1ar|p2ars|icf|ctalett|lay|^[0-9]+ "</code>.
Used with &quot;CTGOV2&quot;, &quot;ISRCTN&quot; and &quot;CTIS&quot; (for &quot;EUCTR&quot;, all documents
are downloaded since they are few and have non-canonical filenames.)</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_annotation.text">annotation.text</code></td>
<td>
<p>Text to be including into the field
&quot;annotation&quot; in the records retrieved with the query
that is to be loaded into the collection.
The contents of the field &quot;annotation&quot; for a trial record
are preserved e.g. when running this function again and
loading a record of a with an annotation, see parameter
<code>annotation.mode</code>.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_annotation.mode">annotation.mode</code></td>
<td>
<p>One of &quot;append&quot; (default), &quot;prepend&quot;
or &quot;replace&quot; for new annotation.text with respect to any
existing annotation for the records retrieved with the query
that is to be loaded into the collection.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_only.count">only.count</code></td>
<td>
<p>Set to <code>TRUE</code> to return only the
number of trial records found in the register for the query.
Does not load trial information into the database.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_con">con</code></td>
<td>
<p>A database connection object, created with
<code>nodbi</code>. See section '1 - Database connection' in
<a href="#topic+ctrdata">ctrdata</a>.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_verbose">verbose</code></td>
<td>
<p>Printing additional information if set to
<code>TRUE</code>; default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ctrLoadQueryIntoDb_+3A_...">...</code></td>
<td>
<p>Do not use (capture deprecated parameters).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements
'n' (number of trial records newly imported or updated),
&lsquo;success' (a vector of _id&rsquo;s of successfully loaded records),
'failed' (a vector of identifiers of records that failed to load)
and 'queryterm' (the query term used).
The returned list has several attributes (including database and
collection name, as well as the query history of this database
collection) to facilitate documentation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

dbc &lt;- nodbi::src_sqlite(collection = "my_collection")

# Retrieve protocol- and results-related information
# on two specific trials identified by their EU number
ctrLoadQueryIntoDb(
  queryterm = "2005-001267-63+OR+2008-003606-33",
  register = "EUCTR",
  euctrresults = TRUE,
  con = dbc
)

# Count ongoing interventional cancer trials involving children
# Note this query is a classical CTGOV query and is translated
# to a corresponding query for the current CTGOV2 webinterface
ctrLoadQueryIntoDb(
  queryterm = "cond=cancer&amp;recr=Open&amp;type=Intr&amp;age=0",
  register = "CTGOV",
  only.count = TRUE,
  con = dbc
)

# Retrieve all information on more than 40 trials
# that are labelled as phase 3 and that mention
# either neuroblastoma or lymphoma from ISRCTN,
# into the same collection as used before
ctrLoadQueryIntoDb(
  queryterm = paste0(
    "https://www.isrctn.com/search?",
    "q=neuroblastoma+OR+lymphoma&amp;filters=phase%3APhase+III"),
  con = dbc
)

# Retrieve information trials in CTIS mentioning neonates
ctrLoadQueryIntoDb(
  queryterm = paste0("https://euclinicaltrials.eu/ctis-public/",
  "search#searchCriteria={%22containAll%22:%22%22,",
  "%22containAny%22:%22neonates%22,%22containNot%22:%22%22}"),
  con = dbc
)

## End(Not run)

</code></pre>

<hr>
<h2 id='ctrOpenSearchPagesInBrowser'>Open register to show query results or search page</h2><span id='topic+ctrOpenSearchPagesInBrowser'></span>

<h3>Description</h3>

<p>Open advanced search pages of register(s), or execute search in browser
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctrOpenSearchPagesInBrowser(url = "", register = "", copyright = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ctrOpenSearchPagesInBrowser_+3A_url">url</code></td>
<td>
<p>of search results page to show in the browser. To open the
browser with a previous search, the output of <a href="#topic+ctrGetQueryUrl">ctrGetQueryUrl</a>
or <a href="#topic+dbQueryHistory">dbQueryHistory</a> can be used. Can be left as empty string
(default) to open the advanced search page of <code>register</code>.</p>
</td></tr>
<tr><td><code id="ctrOpenSearchPagesInBrowser_+3A_register">register</code></td>
<td>
<p>Register(s) to open, &quot;EUCTR&quot;, &quot;CTGOV2&quot;,
&quot;ISRCTN&quot; or &quot;CTIS&quot;. Default is empty string, and this opens the
advanced search page of the register(s).</p>
</td></tr>
<tr><td><code id="ctrOpenSearchPagesInBrowser_+3A_copyright">copyright</code></td>
<td>
<p>(Optional) If set to <code>TRUE</code>, opens only the
copyright pages of all registers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(String) Full URL corresponding to the shortened <code>url</code>
in conjunction with <code>register</code> if any, or invisibly
<code>TRUE</code> if no <code>url</code> is specified.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Open all and check copyrights before using registers
ctrOpenSearchPagesInBrowser(copyright = TRUE)

# Open specific register advanced search page
ctrOpenSearchPagesInBrowser(register = "CTGOV2")
ctrOpenSearchPagesInBrowser(register = "CTIS")
ctrOpenSearchPagesInBrowser(register = "EUCTR")
ctrOpenSearchPagesInBrowser(register = "ISRCTN")

# Open all queries that were loaded into demo collection
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials",
  flags = RSQLite::SQLITE_RO)

dbh &lt;- dbQueryHistory(con = dbc)

for (r in seq_len(nrow(dbh))) {
    ctrOpenSearchPagesInBrowser(dbh[r, ])
}

</code></pre>

<hr>
<h2 id='ctrShowOneTrial'>Show full structure and all data of a trial</h2><span id='topic+ctrShowOneTrial'></span>

<h3>Description</h3>

<p>If used interactively, the function shows a widget of all data in the trial
as a tree of field names and values. The widget opens in the default browser.
Fields names and values can be search and selected. Selected fields can be
copied to the clipboard for use with function <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.
The trial is retrieved with <a href="#topic+ctrLoadQueryIntoDb">ctrLoadQueryIntoDb</a> if no database
<code>con</code> is provided or if the trial is not in database <code>con</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctrShowOneTrial(identifier = NULL, con = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ctrShowOneTrial_+3A_identifier">identifier</code></td>
<td>
<p>A trial identifier string</p>
</td></tr>
<tr><td><code id="ctrShowOneTrial_+3A_con">con</code></td>
<td>
<p>A database connection object, created with
<code>nodbi</code>. See section '1 - Database connection' in
<a href="#topic+ctrdata">ctrdata</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the widget for CTIS trial 2022-501142-30-00:
</p>

<p><img src="../help/figures/ctrdata_ctrShowOneTrial.jpg" alt="ctrdata_ctrShowOneTrial.jpg" />


</p>


<h3>Value</h3>

<p>Invisibly, the trial data for constructing an HTML widget.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials",
  flags = RSQLite::SQLITE_RO)

# all such identifiers work
id &lt;- "2014-003556-31"
id &lt;- "2014-003556-31-SE"
id &lt;- "76463425"
id &lt;- "ISRCTN76463425"
id &lt;- "NCT03431558"
id &lt;- "2022-501142-30-00"

# the id also works with
# ctrGetQueryUrl(url = id) and
# ctrLoadQueryIntoDb(queryterm = id, ...)

# show widget for user to explore and search content as well as to
# select fields of interest and to click on "Copy names of selected
# fields to clipboard..." to use them with dbGetFieldsIntoDf()
ctrShowOneTrial(identifier = id, con = dbc)

# get sample of identifiers of trials in database
sample(dbFindIdsUniqueTrials(con = dbc), 5L)

</code></pre>

<hr>
<h2 id='dbFindFields'>Find names of fields in the database collection</h2><span id='topic+dbFindFields'></span>

<h3>Description</h3>

<p>Given part of the name of a field of interest to the user, this
function returns the full field names used in records that were
previously loaded into a collection
(using <a href="#topic+ctrLoadQueryIntoDb">ctrLoadQueryIntoDb</a>). Only names of fields that have
a value in the collection can be returned.
Set <code>sample = FALSE</code> to force screening all records in the
collection for field names, see below.
See <a href="#topic+ctrShowOneTrial">ctrShowOneTrial</a> to interactively find fields.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbFindFields(namepart = ".*", con, sample = TRUE, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbFindFields_+3A_namepart">namepart</code></td>
<td>
<p>A character string (can be a regular expression,
including Perl-style) to be searched among all field names (keys)
in the collection, case-insensitive. The default '&quot;.*&quot;' lists all fields.</p>
</td></tr>
<tr><td><code id="dbFindFields_+3A_con">con</code></td>
<td>
<p>A database connection object, created with
<code>nodbi</code>. See section '1 - Database connection' in
<a href="#topic+ctrdata">ctrdata</a>.</p>
</td></tr>
<tr><td><code id="dbFindFields_+3A_sample">sample</code></td>
<td>
<p>If <code>TRUE</code> (default), uses a sample of only 5 trial
records per register to identify fields, to rapidly return a possibly
incomplete set of field names.
If <code>FALSE</code>, uses all trial records in the collection, which will
take more time with more trials but ensures to returns all names of
all fields in the collection.</p>
</td></tr>
<tr><td><code id="dbFindFields_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, prints additional information
(default <code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full names of child fields are returned in dot notation (e.g.,
<code>clinical_results.outcome_list.outcome.measure.class_list.class.title</code>)
In addition, names of parent fields (e.g.,
<code>clinical_results</code>) are returned.
Data in parent fields is typically complex (nested), see
<a href="#topic+dfTrials2Long">dfTrials2Long</a> for easily handling it.
For field definitions of the registers, see
&quot;Definition&quot; in <a href="#topic+ctrdata-registers">ctrdata-registers</a>.
Note: When <code>dbFindFields</code> is first called after
<a href="#topic+ctrLoadQueryIntoDb">ctrLoadQueryIntoDb</a>, it will take a moment.
</p>


<h3>Value</h3>

<p>Vector of strings with full names of field(s) found,
ordered by register and alphabet, see examples. Names of the vector
are the names of the register holding the respective fields. The field
names can be fed into <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a> to extract the
data for the field(s) from the collection into a data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials",
  flags = RSQLite::SQLITE_RO)

dbFindFields(namepart = "date", con = dbc)[1:5]

# view all 1880+ fields from all registers:

allFields &lt;- dbFindFields(con = dbc, sample = FALSE)

if (interactive()) View(data.frame(
  register = names(allFields),
  field = allFields))

</code></pre>

<hr>
<h2 id='dbFindIdsUniqueTrials'>Get identifiers of deduplicated trial records</h2><span id='topic+dbFindIdsUniqueTrials'></span>

<h3>Description</h3>

<p>Records for a clinical trial can be loaded from more than one
register into a collection. This function returns deduplicated
identifiers for all trials in the collection, respecting the
register(s) preferred by the user. All registers are recording
identifiers also from other registers, which are used by this
function to provide a vector of identifiers of deduplicated trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbFindIdsUniqueTrials(
  preferregister = c("CTGOV2", "EUCTR", "CTGOV", "ISRCTN", "CTIS"),
  prefermemberstate = "BE",
  include3rdcountrytrials = TRUE,
  con,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbFindIdsUniqueTrials_+3A_preferregister">preferregister</code></td>
<td>
<p>A vector of the order of preference for
registers from which to generate unique _id's, default
<code>c("CTGOV2", "EUCTR", "CTGOV", "ISRCTN", "CTIS")</code></p>
</td></tr>
<tr><td><code id="dbFindIdsUniqueTrials_+3A_prefermemberstate">prefermemberstate</code></td>
<td>
<p>Code of single EU Member State for which records
should returned. If not available, a record for BE or lacking this, any
random Member State's record for the trial will be returned.
For a list of codes of EU  Member States, please see vector
<code>countriesEUCTR</code>. Specifying &quot;3RD&quot; will return the Third Country
record of trials, where available.</p>
</td></tr>
<tr><td><code id="dbFindIdsUniqueTrials_+3A_include3rdcountrytrials">include3rdcountrytrials</code></td>
<td>
<p>A logical value if trials should be retained
that are conducted exclusively in third countries, that is, outside
the European Union. Ignored if <code>prefermemberstate</code> is set to &quot;3RD&quot;.</p>
</td></tr>
<tr><td><code id="dbFindIdsUniqueTrials_+3A_con">con</code></td>
<td>
<p>A database connection object, created with
<code>nodbi</code>. See section '1 - Database connection' in
<a href="#topic+ctrdata">ctrdata</a>.</p>
</td></tr>
<tr><td><code id="dbFindIdsUniqueTrials_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, prints out the fields of registers used to
find corresponding trial records</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the content of records may differ between registers
(and, for &quot;EUCTR&quot;, between records for different Member States).
Such differences are not considered by this function.
</p>
<p>Note that the trial concept &quot;.isUniqueTrial&quot; (which uses this function)
can be calculated at the time of creating a data frame with
<a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>, which often may be the preferred approach.
</p>


<h3>Value</h3>

<p>A named vector with strings of keys (field &quot;_id&quot;) of
records in the collection that represent unique trials, where
names correspond to the register of the record.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials",
  flags = RSQLite::SQLITE_RO)

dbFindIdsUniqueTrials(con = dbc)[1:10]

# alternative as of ctrdata version 1.21.0,
# using defaults of dbFindIdsUniqueTrials()
df &lt;- dbGetFieldsIntoDf(
  fields = "keyword",
  calculate = "f.isUniqueTrial",
  con = dbc)

# using base R
df[df[[".isUniqueTrial"]], ]

## Not run: 
library(dplyr)
df %&gt;% filter(.isUniqueTrial)

## End(Not run)

</code></pre>

<hr>
<h2 id='dbGetFieldsIntoDf'>Create data frame of specified fields from database collection</h2><span id='topic+dbGetFieldsIntoDf'></span>

<h3>Description</h3>

<p>Fields in the collection are retrieved from all records into a data
frame (or tibble). Within a given trial record, a fields can be
hierarchical and structured, that is, nested.
Th function uses the field names to appropriately type the values
that it returns, harmonising original values (e.g. &quot;Information not present
in EudraCT&quot; to 'NA', &quot;Yes&quot; to 'TRUE', &quot;false&quot; to 'FALSE',
date strings to dates or time differences, number strings to numbers).
The function simplifies the structure of nested data and
may concatenate multiple strings in a field using &quot; / &quot; (see example)
and may have widened the returned data frame with additional columns that
were recursively expanded from simply nested data (e.g., &quot;externalRefs&quot;
to columns &quot;externalRefs.doi&quot;, &quot;externalRefs.eudraCTNumber&quot; etc.).
For an alternative way for handling the complex nested data, see
<a href="#topic+dfTrials2Long">dfTrials2Long</a> followed by <a href="#topic+dfName2Value">dfName2Value</a> for extracting
the sought variable(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbGetFieldsIntoDf(fields = "", calculate = "", con, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbGetFieldsIntoDf_+3A_fields">fields</code></td>
<td>
<p>Vector of one or more strings, with names of sought fields.
See function <a href="#topic+dbFindFields">dbFindFields</a> for how to find names of fields and
<a href="#topic+ctrShowOneTrial">ctrShowOneTrial</a> for interactively selecting field names.
Dot path notation (&quot;field.subfield&quot;) without indices is supported.
If compatibility with 'nodbi::src_postgres()' is needed, specify fewer
than 50 fields, consider also using parent fields e.g., '&quot;a.b&quot;' instead
of 'c(&quot;a.b.c.d&quot;, &quot;a.b.c.e&quot;)', accessing sought fields with
<a href="#topic+dfTrials2Long">dfTrials2Long</a> followed by <a href="#topic+dfName2Value">dfName2Value</a> or other R functions.</p>
</td></tr>
<tr><td><code id="dbGetFieldsIntoDf_+3A_calculate">calculate</code></td>
<td>
<p>Vector of one or more strings, which are names of functions
to calculate certain trial concepts from fields in the collection across
different registers.</p>
</td></tr>
<tr><td><code id="dbGetFieldsIntoDf_+3A_con">con</code></td>
<td>
<p>A database connection object, created with
<code>nodbi</code>. See section '1 - Database connection' in
<a href="#topic+ctrdata">ctrdata</a>.</p>
</td></tr>
<tr><td><code id="dbGetFieldsIntoDf_+3A_verbose">verbose</code></td>
<td>
<p>Printing additional information if set to <code>TRUE</code>;
(default <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="dbGetFieldsIntoDf_+3A_...">...</code></td>
<td>
<p>Do not use (captures deprecated parameter <code>stopifnodata</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (or tibble, if <code>tibble</code> is loaded)
with columns corresponding to the sought fields.
A column for the records' '_id' will always be included.
The maximum number of rows of the returned data frame is equal to,
or less than the number of trial records in the database collection.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials",
  flags = RSQLite::SQLITE_RO)

# get fields that are nested within another field
# and can have multiple values with the nested field
dbGetFieldsIntoDf(
  fields = "b1_sponsor.b31_and_b32_status_of_the_sponsor",
  con = dbc)

# fields that are lists of string values are
# returned by concatenating values with a slash
dbGetFieldsIntoDf(
  fields = "keyword",
  con = dbc)

# calculate new field(s) from data across trials
df &lt;- dbGetFieldsIntoDf(
  fields = "keyword",
  calculate = c("f.statusRecruitment", "f.isUniqueTrial", "f.startDate"),
  con = dbc)

table(df$.statusRecruitment, exclude = NULL)

## Not run: 
library(dplyr)
library(ggplot2)

df %&gt;%
  filter(.isUniqueTrial) %&gt;%
  count(.statusRecruitment)

df %&gt;%
  filter(.isUniqueTrial) %&gt;%
  ggplot() +
  stat_ecdf(aes(
    x = .startDate,
    colour = .statusRecruitment))

## End(Not run)

</code></pre>

<hr>
<h2 id='dbQueryHistory'>Show history of queries loaded into a database collection</h2><span id='topic+dbQueryHistory'></span>

<h3>Description</h3>

<p>Show history of queries loaded into a database collection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbQueryHistory(con, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dbQueryHistory_+3A_con">con</code></td>
<td>
<p>A database connection object, created with
<code>nodbi</code>. See section '1 - Database connection' in
<a href="#topic+ctrdata">ctrdata</a>.</p>
</td></tr>
<tr><td><code id="dbQueryHistory_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, prints additional information
(default <code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (or tibble, if <code>tibble</code> is loaded)
with columns: 'query-timestamp', 'query-register',
'query-records' (note: this is the number of records loaded when last
executing <a href="#topic+ctrLoadQueryIntoDb">ctrLoadQueryIntoDb</a>, not the total record number) and
'query-term', with one row for each time that
<a href="#topic+ctrLoadQueryIntoDb">ctrLoadQueryIntoDb</a> loaded trial records into this collection.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials",
  flags = RSQLite::SQLITE_RO)

dbQueryHistory(con = dbc)

</code></pre>

<hr>
<h2 id='dfMergeVariablesRelevel'>Merge variables, keeping type, and optionally relevel factors</h2><span id='topic+dfMergeVariablesRelevel'></span>

<h3>Description</h3>

<p>Merge variables in a data frame such as returned by <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>
into a new variable, and optionally also map its values to new levels.
See <a href="#topic+ctrdata-trial-concepts">ctrdata-trial-concepts</a> for pre-defined cross-register concepts
that are already implemented based on merging fields from different
registers and calculating a new field.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfMergeVariablesRelevel(df = NULL, colnames = "", levelslist = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dfMergeVariablesRelevel_+3A_df">df</code></td>
<td>
<p>A <a href="base.html#topic+data.frame">data.frame</a> with the variables (columns) to be merged into
one vector.</p>
</td></tr>
<tr><td><code id="dfMergeVariablesRelevel_+3A_colnames">colnames</code></td>
<td>
<p>A vector of names of columns in 'df' that hold the variables
to be merged, or a selection of columns as per <code><a href="dplyr.html#topic+select">select</a></code>.</p>
</td></tr>
<tr><td><code id="dfMergeVariablesRelevel_+3A_levelslist">levelslist</code></td>
<td>
<p>A names list with one slice each for a new value to be
used for a vector of old values (optional).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector, with the type of the columns to be merged
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials",
  flags = RSQLite::SQLITE_RO)
df &lt;- dbGetFieldsIntoDf(
  fields = c(
    "protocolSection.eligibilityModule.healthyVolunteers",
    "f31_healthy_volunteers",
    "eligibility.healthy_volunteers"
  ),
  con = dbc
)

table(
  dfMergeVariablesRelevel(
    df = df,
    colnames = 'matches("healthy")'
))

</code></pre>

<hr>
<h2 id='dfName2Value'>Get value for variable of interest</h2><span id='topic+dfName2Value'></span>

<h3>Description</h3>

<p>Get information for variable of interest  (e.g., clinical endpoints)
from long data frame of protocol- or result-related trial information
as returned by <a href="#topic+dfTrials2Long">dfTrials2Long</a>.
Parameters 'valuename', 'wherename' and 'wherevalue' are
matched using Perl regular expressions and ignoring case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfName2Value(df, valuename = "", wherename = "", wherevalue = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dfName2Value_+3A_df">df</code></td>
<td>
<p>A data frame (or tibble) with four columns ('_id',
'identifier', 'name', 'value') as returned by <a href="#topic+dfTrials2Long">dfTrials2Long</a></p>
</td></tr>
<tr><td><code id="dfName2Value_+3A_valuename">valuename</code></td>
<td>
<p>A character string for the name of the field
that holds the value of the variable of interest
(e.g., a summary measure such as &quot;endPoints.*tendencyValue.value&quot;)</p>
</td></tr>
<tr><td><code id="dfName2Value_+3A_wherename">wherename</code></td>
<td>
<p>(optional) A character string to identify the
variable of interest among those that repeatedly occur in a
trial record (e.g., &quot;endPoints.endPoint.title&quot;)</p>
</td></tr>
<tr><td><code id="dfName2Value_+3A_wherevalue">wherevalue</code></td>
<td>
<p>(optional) A character string with the value of
the variable identified by 'wherename' (e.g., &quot;response&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (or tibble, if <code>tibble</code> is loaded)
that includes the values of interest, with columns
'_id', 'identifier', 'name', 'value' and 'where' (with the
contents of 'wherevalue' found at 'wherename').
Contents of 'value' are strings unless all its elements
are numbers. The 'identifier' is generated by
function <a href="#topic+dfTrials2Long">dfTrials2Long</a> to identify matching elements,
e.g endpoint descriptions and measurements.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials",
  flags = RSQLite::SQLITE_RO)

dfwide &lt;- dbGetFieldsIntoDf(
    fields = c(
        ## ctgov - typical results fields
        # "clinical_results.baseline.analyzed_list.analyzed.count_list.count",
        # "clinical_results.baseline.group_list.group",
        # "clinical_results.baseline.analyzed_list.analyzed.units",
        "clinical_results.outcome_list.outcome",
        "study_design_info.allocation",
        ## euctr - typical results fields
        # "trialInformation.fullTitle",
        # "baselineCharacteristics.baselineReportingGroups.baselineReportingGroup",
        # "trialChanges.hasGlobalInterruptions",
        # "subjectAnalysisSets",
        # "adverseEvents.seriousAdverseEvents.seriousAdverseEvent",
        "endPoints.endPoint",
        "subjectDisposition.recruitmentDetails"
    ), con = dbc
)

dflong &lt;- dfTrials2Long(df = dfwide)

## get values for the endpoint 'response'
dfName2Value(
    df = dflong,
    valuename = paste0(
        "clinical_results.*measurement.value|",
        "clinical_results.*outcome.measure.units|",
        "endPoints.endPoint.*tendencyValue.value|",
        "endPoints.endPoint.unit"
    ),
    wherename = paste0(
        "clinical_results.*outcome.measure.title|",
        "endPoints.endPoint.title"
    ),
    wherevalue = "response"
)

</code></pre>

<hr>
<h2 id='dfTrials2Long'>Convert data frame with trial records into long format</h2><span id='topic+dfTrials2Long'></span>

<h3>Description</h3>

<p>The function works with procotol- and results- related information.
It converts lists and other values that are in a data frame returned
by <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a> into individual rows of a long data frame.
From the resulting long data frame, values of interest can be selected
using <a href="#topic+dfName2Value">dfName2Value</a>.
The function is particularly useful for fields with complex content,
such as node field &quot;<code>clinical_results</code>&quot; from EUCTR, for which
<a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a> returns as a multiply nested list and for
which this function then converts every observation of every (leaf)
field into a row of its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfTrials2Long(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dfTrials2Long_+3A_df">df</code></td>
<td>
<p>Data frame (or tibble) with columns including
the trial identifier (<code>_id</code>) and
one or more variables as obtained from
<a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame  (or tibble, if <code>tibble</code> is loaded)
with the four columns: '_id', 'identifier', 'name', 'value'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials",
  flags = RSQLite::SQLITE_RO)

dfwide &lt;- dbGetFieldsIntoDf(
  fields = "clinical_results.participant_flow",
  con = dbc)

dfTrials2Long(df = dfwide)

</code></pre>

<hr>
<h2 id='f.controlType'>Calculate type of control data collected in a study</h2><span id='topic+f.controlType'></span>

<h3>Description</h3>

<p>Trial concept calculated: type of internal control.
ICH E10 lists as types of control: placebo concurrent control, no-treatment
concurrent control, dose-response concurrent control, active (positive)
concurrent control, external (including historical) control, multiple control
groups. Dose-controlled trials are currently not identified.
External (including historical) controls are so far not identified in specific
register fields. Cross-over designs, where identifiable, have active controls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.controlType(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.controlType_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.controlType', which is
a factor with levels 'none', 'no-treatment', 'placebo', 'active',
'placebo+active' and 'other'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.controlType()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.controlType",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.isMedIntervTrial'>Calculate if study is a medicine-interventional study</h2><span id='topic+f.isMedIntervTrial'></span>

<h3>Description</h3>

<p>Trial concept calculated: Calculates if record is a medicine-interventional
trial, investigating one or more medicine, whether biological or not.
For EUCTR and CTIS, this corresponds to all records as per the definition
of the EU Clinical Trial Regulation.
For CTGOV and CTGOV2, this is based on drug or biological as type
of intervention, and interventional as type of study.
For ISRCTN, this is based on drug or biological as type
of intervention, and interventional as type of study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.isMedIntervTrial(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.isMedIntervTrial_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with colums '_id' and '.isMedIntervTrial', a logical.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.isMedIntervTrial()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.isMedIntervTrial",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.isUniqueTrial'>Calculate if record is unique for a study</h2><span id='topic+f.isUniqueTrial'></span>

<h3>Description</h3>

<p>Trial concept calculated: Applies function dbFindIdsUniqueTrials() with
its defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.isUniqueTrial(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.isUniqueTrial_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.isUniqueTrial', a logical.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.isUniqueTrial()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.isUniqueTrial",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.likelyPlatformTrial'>Calculate if study is likely a platform trial or not</h2><span id='topic+f.likelyPlatformTrial'></span>

<h3>Description</h3>

<p>Trial concept calculated: platform trial, research platform.
As operational definition, at least one of these criteria is true:
a. trial has &quot;platform&quot;, &quot;basket&quot;, &quot;umbrella&quot;, &quot;multi.?arm&quot;, &quot;multi.?stage&quot;
or &quot;master protocol&quot; in its title or description (for ISRCTN, this is the
only criterion; some trials in EUCTR lack data in English),
b. trial has more than 2 active arms with different investigational medicines,
after excluding comparator, auxiliary and placebo medicines (calculated with
<a href="#topic+f.numTestArmsSubstances">f.numTestArmsSubstances</a>; not used for ISRCTN because it cannot be
calculated precisely),
c. trial more than 2 periods, after excluding safety run-in, screening,
enrolling, extension and follow-up periods (for CTGOV and CTGOV2, this
criterion requires results-related data).
Requires that EUCTR results have been included in the collection, using
ctrLoadQueryIntoDb(queryterm = ..., euctrresults = TRUE, con = ...).
Requires packages dplyr and stringdist to be installed; stringdist is used
for evaluating terms in brackets in the trial title, where trials may be
related if the term similarity is 0.7 or higher.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.likelyPlatformTrial(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.likelyPlatformTrial_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Publication references considered:
E-PEARL WP2 2020 https://tinyurl.com/eupearld21terminology (which did not
include all basket trials in the definition, as done here)
Williams RJ et al. 2022 https://doi.org/10.1136/bmj-2021-067745
</p>


<h3>Value</h3>

<p>data frame with columns '_id' and '.likelyPlatformTrial', a logical,
&lsquo;.likelyRelatedTrials', a list (e.g., from CTIS&rsquo; 'associatedClinicalTrials')
and '.maybeRelatedTrials', a list (based on similar short terms within
a first set of brackets or before a colon in the title).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.likelyPlatformTrial()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.likelyPlatformTrial",
  con = dbc)

## End(Not run)


</code></pre>

<hr>
<h2 id='f.numSites'>Calculate number of sites of a study</h2><span id='topic+f.numSites'></span>

<h3>Description</h3>

<p>Trial concept calculated: number of the sites where the trial is conducted.
EUCTR lacks information on number of sites outside of the EEA;
for each non-EEA country mentioned, at least one site is assumed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.numSites(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.numSites_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.numSites', an integer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.numSites()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.numSites",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.numTestArmsSubstances'>Calculate type of control data collected in a study</h2><span id='topic+f.numTestArmsSubstances'></span>

<h3>Description</h3>

<p>Trial concept calculated: number of active arms with different
investigational medicines, after excluding comparator, auxiliary and placebo
arms / medicines.
For ISRCTN, this is imprecise because arms are not identified in a field.
Most registers provide no or only limited information on phase 1 trials,
so that this number typically cannot be calculated for these trials.
Requires packages stringdist to be installed; stringdist is used for
evaluating names of active substances, which are considered similar when
the similarity is 0.8 or higher.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.numTestArmsSubstances(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.numTestArmsSubstances_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.numTestArmsSubstances', an integer
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.controlType()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.numTestArmsSubstances",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.primaryEndpointDescription'>Calculate details of a primary endpoint of a study</h2><span id='topic+f.primaryEndpointDescription'></span>

<h3>Description</h3>

<p>Trial concept calculated: full description of the primary endpoint,
concatenating with &quot; == &quot; its title, description, time frame of assessment.
The details vary by register. The text description can be used for
identifying trials of interest or for analysing trends in primary
endpoints, which among the set of all endpoints are most often used
for determining the number of participants sought for the study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.primaryEndpointDescription(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.primaryEndpointDescription_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.primaryEndpointDescription',
which is a list (that is, one or more items in one vector per row; the
background is that some trials have several endpoints as primary).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.primaryEndpointDescription()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO
)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.primaryEndpointDescription",
  con = dbc
)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.primaryEndpointResults'>Calculate type of control data collected in a study</h2><span id='topic+f.primaryEndpointResults'></span>

<h3>Description</h3>

<p>Trial concept calculated: Calculates several results-related elements of
the primary analysis of the primary endpoint. Requires loading
results-related information.
For CTIS and ISRCTN, such information is not available in structured format.
Recommended to be combined with .controlType, .sampleSize etc. for analyses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.primaryEndpointResults(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.primaryEndpointResults_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and new columns:
'.primaryEndpointFirstPvalue' (discarding any inequality indicator, e.g. &lt;=),
'.primaryEndpointFirstPmethod' (normalised string, e.g. chisquared),
'.primaryEndpointFirstPsize' (number included in test, across assignment groups).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.primaryEndpointResults()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.primaryEndpointResults",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.resultsDate'>Calculate date of results of a study</h2><span id='topic+f.resultsDate'></span>

<h3>Description</h3>

<p>Trial concept calculated: earliest date of results as recorded in the
register. At that date, results may have been incomplete and may have
been changed later.
For EUCTR, requires that results and preferrably also their history of
publication have been included in the collection, using
ctrLoadQueryIntoDb(queryterm = ..., euctrresultshistory = TRUE, con = ...).
Cannot be calculated for ISRCTN, which does not have a corresponding field.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.resultsDate(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.resultsDate_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.resultsDate', a date.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.resultsDate()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.resultsDate",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.sampleSize'>Calculate sample size of a study</h2><span id='topic+f.sampleSize'></span>

<h3>Description</h3>

<p>Trial concept calculated: sample size of the trial, preferring
results-related over protocol-related information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.sampleSize(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.sampleSize_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.sampleSize', an integer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.sampleSize()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.sampleSize",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.sponsorType'>Calculate type of control data collected in a study</h2><span id='topic+f.sponsorType'></span>

<h3>Description</h3>

<p>Trial concept calculated: type or class of the lead or main sponsor of the
trial. Some information is not yet mapped (e.g., &quot;NETWORK&quot; in CTGOV2).
No specific field is available in ISRCTN.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.sponsorType(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.sponsorType_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.sponsorType', which is
a factor with levels 'For profit', 'Not for profit' or 'Other'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.sponsorType()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.sponsorType",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.startDate'>Calculate start date of a study</h2><span id='topic+f.startDate'></span>

<h3>Description</h3>

<p>Trial concept calculated: start of the trial, based on the
documented or planned start of recruitment, or on the date of opinion
of the competent authority.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.startDate(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.startDate_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.startDate', a date.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.startDate()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.startDate",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.statusRecruitment'>Calculate status of recruitment of a study</h2><span id='topic+f.statusRecruitment'></span>

<h3>Description</h3>

<p>Trial concept calculated: status of recruitment at the time of loading
the trial records. Maps the categories that are in fields which specify
the state of recruitment. Simplifies the status into three categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.statusRecruitment(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.statusRecruitment_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.statusRecruitment', which is
a factor with levels 'ongoing' (includes active, not yet recruiting;
temporarily halted; suspended; authorised, not started and similar),
'completed' (includes ended; ongoing, recruitment ended),
'ended early' (includes prematurely ended, terminated early) and
'other' (includes revoked, withdrawn, planned, stopped).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.statusRecruitment()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.statusRecruitment",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.trialObjectives'>Calculate objectives of a study</h2><span id='topic+f.trialObjectives'></span>

<h3>Description</h3>

<p>Trial concept calculated: objectives of the trial, by searching for text
fragments found in fields describing its purpose, objective, background
or hypothesis, after applying .isMedIntervTrial, because the text
fragments are tailored to medicinal product interventional trials.
This is a simplification, and it is expected that the criteria will be
further refined. The text fragments only apply to English.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.trialObjectives(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.trialObjectives_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.trialObjectives', which is
a string with letters separated by a space, such as
E (efficacy, including cure, survival, effectiveness);
A (activity, including reponse, remission, seroconversion);
S (safety); PK; PD (including biomarker);
D (dose-finding, determining recommended dose);
LT (long-term); and FU (follow-up).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.trialObjectives()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.trialObjectives",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.trialPhase'>Calculate phase of a clinical trial</h2><span id='topic+f.trialPhase'></span>

<h3>Description</h3>

<p>Trial concept calculated: phase of a clinical trial as per ICH E8(R1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.trialPhase(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.trialPhase_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.trialPhase', which is
an ordered factor with levels 'phase 1', 'phase 1+2', 'phase 2',
'phase 2+3', 'phase 2+4', 'phase 3', 'phase 3+4', 'phase 1+2+3',
'phase 4', 'phase 1+2+3+4'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.trialPhase()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.trialPhase",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.trialPopulation'>Calculate in- and exclusion criteria and age groups</h2><span id='topic+f.trialPopulation'></span>

<h3>Description</h3>

<p>Trial concept calculated: inclusion and exclusion criteria as well as
age groups that can participate in a trial, based on from protocol-related
information. (See <a href="#topic+dfMergeVariablesRelevel">dfMergeVariablesRelevel</a> example for healthy
volunteers.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.trialPopulation(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.trialPopulation_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and new columns:
'.trialPopulationAgeGroup' (factor, &quot;P&quot;, &quot;A&quot;, &quot;P+A&quot;, &quot;E&quot;, &quot;A+E&quot;, &quot;P+A+E&quot;),
'.trialPopulationInclusion' (string),
'.trialPopulationExclusion' (string).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.trialPopulation()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.trialPopulation",
  con = dbc)

## End(Not run)

</code></pre>

<hr>
<h2 id='f.trialTitle'>Calculate the title of a study</h2><span id='topic+f.trialTitle'></span>

<h3>Description</h3>

<p>Trial concept calculated: scientific or full title of the study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f.trialTitle(df = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f.trialTitle_+3A_df">df</code></td>
<td>
<p>data frame such as from <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>. If 'NULL',
prints fields needed in 'df' for calculating this trial concept, which can
be used with <a href="#topic+dbGetFieldsIntoDf">dbGetFieldsIntoDf</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns '_id' and '.trialTitle', a string.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fields needed
f.resultsDate()

## Not run: 

# apply trial concept when creating data frame
dbc &lt;- nodbi::src_sqlite(
  dbname = system.file("extdata", "demo.sqlite", package = "ctrdata"),
  collection = "my_trials", flags = RSQLite::SQLITE_RO)
trialsDf &lt;- dbGetFieldsIntoDf(
  calculate = "f.trialTitle",
  con = dbc)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
