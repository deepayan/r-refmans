<!DOCTYPE html><html><head><title>Help for package covidmx</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {covidmx}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#covidmx-package'><p>covidmx: Descarga y analiza datos de COVID-19 en México</p></a></li>
<li><a href='#casos'><p>Casos de COVID-19 en Mexico</p></a></li>
<li><a href='#cfr'><p>Case Fatality Rate (CFR)</p></a></li>
<li><a href='#check_sites'><p>Funcion para verificar la existencia de los sitios web de datos de covid</p></a></li>
<li><a href='#chr'><p>Case Hospitalization Rate (CHR)</p></a></li>
<li><a href='#datosabiertos'><p>Datos abiertos de COVID-19</p></a></li>
<li><a href='#descarga_datos_abiertos'><p>Descarga de datos abiertos</p></a></li>
<li><a href='#descarga_datos_red_irag'><p>Descarga la base de datos de ocupacion hospitalaria de la red IRAG</p></a></li>
<li><a href='#descarga_datos_variantes_GISAID'><p>Lee la base de datos de variantes de COVID-19 en Mexico generada por GISAID</p></a></li>
<li><a href='#descarga_db'><p>Auxiliares para la descarga de datos abiertos</p></a></li>
<li><a href='#estima_rt'><p>RT: Número efectivo de reproducción</p></a></li>
<li><a href='#numero_pruebas'><p>Numero de Pruebas</p></a></li>
<li><a href='#plot_covid'><p>Grafica los casos de COVID-19</p></a></li>
<li><a href='#positividad'><p>Positividad</p></a></li>
<li><a href='#read_datos_abiertos'><p>Lee la base de datos de la direccion general de epidemiologia que ya descargaste</p></a></li>
<li><a href='#read_datos_abiertos_zip'><p>Auxiliares de lectura para la base de la Direccion General de Epidemiologia</p></a></li>
<li><a href='#update_covidmx'><p>Actualiza el paquete covidmx</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Descarga y analiza datos de COVID-19 en México</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.7</td>
</tr>
<tr>
<td>Description:</td>
<td>Herramientas para el análisis de datos de COVID-19 en México. Descarga y analiza 
  los datos para COVID-19 de la Direccion General de Epidemiología de México (DGE) 
  <a href="https://www.gob.mx/salud/documentos/datos-abiertos-152127">https://www.gob.mx/salud/documentos/datos-abiertos-152127</a>,
  la Red de Infecciones Respiratorias Agudas Graves (Red IRAG)
  <a href="https://www.gits.igg.unam.mx/red-irag-dashboard/reviewHome">https://www.gits.igg.unam.mx/red-irag-dashboard/reviewHome</a> y la Iniciativa Global 
  para compartir todos los datos de influenza (GISAID)
  <a href="https://gisaid.org/">https://gisaid.org/</a>. 
  English: Downloads and analyzes data  of COVID-19 from the  Mexican General 
  Directorate of Epidemiology (DGE), the Network of 
  Severe Acute Respiratory  Infections (IRAG network),and the Global 
  Initiative on Sharing All Influenza Data GISAID.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>es</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, DBI, dplyr, duckdb (&ge; 0.4.0), fs, pins (&ge; 1.0.1),
RCurl, readr, readxl, rlang, stats, stringr, tibble, tidyr,
tools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, cowplot, crayon, dbplyr, EpiEstim, ggformula, ggplot2,
ggstream, ggtext (&ge; 0.1.0), glue, lubridate, MetBrewer,
remotes, rmarkdown, rstudioapi, scales, sessioninfo, testthat
(&ge; 3.0.0), usethis</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/RodrigoZepeda/covidmx">https://github.com/RodrigoZepeda/covidmx</a>,
<a href="https://rodrigozepeda.github.io/covidmx/">https://rodrigozepeda.github.io/covidmx/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/RodrigoZepeda/covidmx/issues">https://github.com/RodrigoZepeda/covidmx/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-16 16:44:16 UTC; rod</td>
</tr>
<tr>
<td>Author:</td>
<td>Rodrigo Zepeda-Tello
    <a href="https://orcid.org/0000-0003-4471-5270"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Mauricio Hernandez-Avila [aut],
  Alberto Almuiña [ctb] (Author of included zzz fragment),
  Jonah Gabry [ctb] (Author of included cmdstanr fragment),
  Rok Češnovar [ctb] (Author of included cmdstanr fragment),
  Ben Bales [ctb] (Author of included cmdstanr fragment),
  Mitzi Morris [ctb] (Author of included cmdstanr fragment),
  Mikhail Popov [ctb] (Author of included cmdstanr fragment),
  Mike Lawrence [ctb] (Author of included cmdstanr fragment),
  William Michael Landau [ctb] (Author of included cmdstanr fragment),
  Jacob Socolar [ctb] (Author of included cmdstanr fragment),
  Andrew Johnson [ctb] (Author of included cmdstanr fragment),
  Instituto Mexicano del Seguro Social [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rodrigo Zepeda-Tello &lt;rzepeda17@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-17 23:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='covidmx-package'>covidmx: Descarga y analiza datos de COVID-19 en México</h2><span id='topic+covidmx'></span><span id='topic+covidmx-package'></span>

<h3>Description</h3>

<p>Herramientas para el análisis de datos de COVID-19 en México. Descarga y analiza los datos para COVID-19 de la Direccion General de Epidemiología de México (DGE) <a href="https://www.gob.mx/salud/documentos/datos-abiertos-152127">https://www.gob.mx/salud/documentos/datos-abiertos-152127</a>, la Red de Infecciones Respiratorias Agudas Graves (Red IRAG) <a href="https://www.gits.igg.unam.mx/red-irag-dashboard/reviewHome">https://www.gits.igg.unam.mx/red-irag-dashboard/reviewHome</a> y la Iniciativa Global para compartir todos los datos de influenza (GISAID) <a href="https://gisaid.org/">https://gisaid.org/</a>. English: Downloads and analyzes data of COVID-19 from the Mexican General Directorate of Epidemiology (DGE), the Network of Severe Acute Respiratory Infections (IRAG network),and the Global Initiative on Sharing All Influenza Data GISAID.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Rodrigo Zepeda-Tello <a href="mailto:rzepeda17@gmail.com">rzepeda17@gmail.com</a> (<a href="https://orcid.org/0000-0003-4471-5270">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Mauricio Hernandez-Avila
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Alberto Almuiña (Author of included zzz fragment) [contributor]
</p>
</li>
<li><p> Jonah Gabry (Author of included cmdstanr fragment) [contributor]
</p>
</li>
<li><p> Rok Češnovar (Author of included cmdstanr fragment) [contributor]
</p>
</li>
<li><p> Ben Bales (Author of included cmdstanr fragment) [contributor]
</p>
</li>
<li><p> Mitzi Morris (Author of included cmdstanr fragment) [contributor]
</p>
</li>
<li><p> Mikhail Popov (Author of included cmdstanr fragment) [contributor]
</p>
</li>
<li><p> Mike Lawrence (Author of included cmdstanr fragment) [contributor]
</p>
</li>
<li><p> William Michael Landau (Author of included cmdstanr fragment) [contributor]
</p>
</li>
<li><p> Jacob Socolar (Author of included cmdstanr fragment) [contributor]
</p>
</li>
<li><p> Andrew Johnson (Author of included cmdstanr fragment) [contributor]
</p>
</li>
<li><p> Instituto Mexicano del Seguro Social [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/RodrigoZepeda/covidmx">https://github.com/RodrigoZepeda/covidmx</a>
</p>
</li>
<li> <p><a href="https://rodrigozepeda.github.io/covidmx/">https://rodrigozepeda.github.io/covidmx/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/RodrigoZepeda/covidmx/issues">https://github.com/RodrigoZepeda/covidmx/issues</a>
</p>
</li></ul>


<hr>
<h2 id='casos'>Casos de COVID-19 en Mexico</h2><span id='topic+casos'></span>

<h3>Description</h3>

<p><code>casos</code> Calcula el numero de casos registrados por fecha agrupando (o sin hacerlo)
por diferentes covariables. Por default calcula el total de casos (con y sin prueba positiva)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>casos(
  datos_covid,
  entidades = c("AGUASCALIENTES", "BAJA CALIFORNIA", "BAJA CALIFORNIA SUR", "CAMPECHE",
    "CHIAPAS", "CHIHUAHUA", "CIUDAD DE MÉXICO", "COAHUILA DE ZARAGOZA", "COLIMA",
    "DURANGO", "GUANAJUATO", "GUERRERO", "HIDALGO", "JALISCO", "MÉXICO",
    "MICHOACÁN DE OCAMPO", "MORELOS", "NAYARIT", "NUEVO LEÓN", "OAXACA", "PUEBLA",
    "QUERÉTARO", "QUINTANA ROO", "SAN LUIS POTOSÍ", "SINALOA", "SONORA", "TABASCO",
    "TAMAULIPAS", "TLAXCALA", "VERACRUZ DE IGNACIO DE LA LLAVE", "YUCATÁN", "ZACATECAS"),
  group_by_entidad = TRUE,
  entidad_tipo = c("Unidad Medica", "Residencia", "Nacimiento"),
  fecha_tipo = c("Sintomas", "Ingreso", "Defuncion"),
  tipo_clasificacion = c("Sospechosos", "Confirmados COVID", "Negativo a COVID",
    "Inválido", "No realizado"),
  group_by_tipo_clasificacion = FALSE,
  tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO", "NO ESPECIFICADO"),
  group_by_tipo_paciente = FALSE,
  tipo_uci = c("SI", "NO", "NO APLICA", "SE IGNORA", "NO ESPECIFICADO"),
  group_by_tipo_uci = FALSE,
  tipo_sector = c("CRUZ ROJA", "DIF", "ESTATAL", "IMSS", "IMSS-BIENESTAR", "ISSSTE",
    "MUNICIPAL", "PEMEX", "PRIVADA", "SEDENA", "SEMAR", "SSA", "UNIVERSITARIO",
    "NO ESPECIFICADO"),
  group_by_tipo_sector = FALSE,
  defunciones = FALSE,
  edad_cut = NULL,
  as_tibble = TRUE,
  fill_zeros = as_tibble,
  list_name = "casos",
  .grouping_vars = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="casos_+3A_datos_covid">datos_covid</code></td>
<td>
<p>(<strong>obligatorio</strong>) Lista de <code>tibble</code>s o <code>duckdb</code>s resultante de
<code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> o <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code></p>
</td></tr>
<tr><td><code id="casos_+3A_entidades">entidades</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con las entidades de las unidades medicas a analizar.
Opciones: <code>AGUASCALIENTES</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA&#8288;</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA SUR&#8288;</code>,
<code>CAMPECHE</code>, <code>CHIAPAS</code>, <code>CHIHUAHUA</code>, <code style="white-space: pre;">&#8288;CIUDAD DE MEXICO&#8288;</code>,
<code style="white-space: pre;">&#8288;COAHUILA DE ZARAGOZA&#8288;</code> , <code>COLIMA</code>, <code>DURANGO</code>, <code>GUANAJUATO</code>, <code>GUERRERO</code>,
<code>HIDALGO</code>, <code>JALISCO</code>, <code>MEXICO</code>, <code style="white-space: pre;">&#8288;MICHOACAN DE OCAMPO&#8288;</code>, <code>MORELOS</code>,<code>NAYARIT</code>
<code style="white-space: pre;">&#8288;NUEVO LEON&#8288;</code>, <code>OAXACA</code> ,<code>PUEBLA</code>, <code>QUERETARO</code>,<code style="white-space: pre;">&#8288;QUINTANA ROO&#8288;</code>,
<code style="white-space: pre;">&#8288;SAN LUIS POTOSI&#8288;</code>, <code>SINALOA</code>, <code>SONORA</code>, <code>TABASCO</code>, <code>TAMAULIPAS</code>,<code>TLAXCALA</code>,
<code style="white-space: pre;">&#8288;VERACRUZ DE IGNACIO DE LA LLAVE&#8288;</code>, <code>YUCATAN</code>, <code>ZACATECAS</code>.</p>
</td></tr>
<tr><td><code id="casos_+3A_group_by_entidad">group_by_entidad</code></td>
<td>
<p>(<strong>opcional</strong>) <code>TRUE</code> obtiene los casos para cada entidad reportando
en cada fecha la entidad y los casos en dicha entidad. <code>FALSE</code>  junta las <code>entidades</code> sumando
sus casos en una sola observacion por cada fecha.</p>
</td></tr>
<tr><td><code id="casos_+3A_entidad_tipo">entidad_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Indica a que se refiere las <code>entidades</code> seleccionadas. Elige
una de las opciones: <code style="white-space: pre;">&#8288;Unidad Medica&#8288;</code> (entidad de la unidad medica), <code>Nacimiento</code>
(entidad de origen del individuo) o <code>Residencia</code> (entidad donde reside el individuo).</p>
</td></tr>
<tr><td><code id="casos_+3A_fecha_tipo">fecha_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Selecciona si la fecha que se utiliza es la fecha de <code>Ingreso</code>
(si aplica), la fecha de <code>Sintomas</code> o la de <code>Defuncion</code> (si aplica). El default es fecha de <code>Sintomas</code>.</p>
</td></tr>
<tr><td><code id="casos_+3A_tipo_clasificacion">tipo_clasificacion</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con el tipo de clasificaciones (por la prueba)
a incluir:<code>Sospechosos</code>,<code style="white-space: pre;">&#8288;Confirmados COVID&#8288;</code>, <code style="white-space: pre;">&#8288;Negativo a COVID&#8288;</code>, <code style="white-space: pre;">&#8288;Inv\u00e1lido&#8288;</code>, <code style="white-space: pre;">&#8288;No realizado&#8288;</code></p>
</td></tr>
<tr><td><code id="casos_+3A_group_by_tipo_clasificacion">group_by_tipo_clasificacion</code></td>
<td>
<p>(<strong>opcional</strong>)  Booleana determinando si regresa la base
con cada entrada agrupada por <code>tipo_clasificacion</code> (es decir cada fecha
se generan tantos observaciones como grupos de tipo de clasificación) en caso <code>TRUE</code>. Si
<code>FALSE</code> suma todos los casos del tipo de clasificacion por fecha dando un solo numero por fecha.
El defalt es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="casos_+3A_tipo_paciente">tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con el tipo de pacientes a incluir. Opciones:
<code>AMBULATORIO</code>, <code>HOSPITALIZADO</code>, <code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>. Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="casos_+3A_group_by_tipo_paciente">group_by_tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determinando (caso <code>TRUE</code>) si regresa
la base con cada entrada agrupada por <code>tipo_paciente</code> (es decir cada fecha
se genera un renglon para <code>AMBULATORIO</code>, un renglon para <code>HOSPITALIZADO</code>, etc) o bien
si se suman todos los grupos y cada fecha reporta solo la suma de estos
(estilo <code>AMBULATORIO + HOSPITALIZADO</code> segun las categorias de <code>tipo_paciente</code>)
El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="casos_+3A_tipo_uci">tipo_uci</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con el tipo de valores para Unidad de
Cuidado Intensivo (UCI) a incluir:  <code>SI</code>,<code>NO</code>,<code style="white-space: pre;">&#8288;NO APLICA&#8288;</code>,<code style="white-space: pre;">&#8288;SE IGNORA&#8288;</code>,<code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>.
Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="casos_+3A_group_by_tipo_uci">group_by_tipo_uci</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana. El caso <code>TRUE</code> determina si regresa la base
con cada fecha teniendo diferentes renglones uno para cada <code>tipo_uci</code> (es decir cada fecha
se generan tantos observaciones como grupos de tipo de UCI) o bien en una sola fecha
se suman todos los tipos de UCI (<code>FALSE</code>). El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="casos_+3A_tipo_sector">tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con los sectores del sistema de salud a incluir:
<code style="white-space: pre;">&#8288;CRUZ ROJA&#8288;</code>,<code>DIF</code>,<code>ESTATAL</code>,<code>IMSS</code>,<code>IMSS-BIENESTAR</code>,<code>ISSSTE</code>, <code>MUNICIPAL</code>,<code>PEMEX</code>,
<code>PRIVADA</code>,<code>SEDENA</code>,<code>SEMAR</code>,<code>SSA</code>, <code>UNIVERSITARIO</code>,<code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>.
Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="casos_+3A_group_by_tipo_sector">group_by_tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determina en el caso de <code>TRUE</code> si regresa
la base con cada entrada agrupada por <code>tipo_sector</code> (es decir cada fecha
tiene una entrada con los del <code>IMSS</code>, una entrada distinta con los de <code>ISSSTE</code>, etc) o bien
en caso de <code>FALSE</code> se devuelve una sola entrada por fecha con la suma <code>IMSS + ISSSTE + etc</code>
segun los  sectores seleccionados. El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="casos_+3A_defunciones">defunciones</code></td>
<td>
<p>(<strong>opcional</strong>)  Booleana si incluir sólo defunciones <code>TRUE</code> o a todos <code>FALSE</code>.
El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="casos_+3A_edad_cut">edad_cut</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con secuencia de edades para hacer grupos. Por ejemplo
<code>edad_cut = c(0, 10, Inf)</code> arma dos grupos de edad de 0 a 10 y de 10 a infinito o bien
<code>edad_cut = c(15, 20)</code> deja sólo los registros entre 15 y 20 años. Por default es <code>NULL</code>
y no arma grupos etarios.</p>
</td></tr>
<tr><td><code id="casos_+3A_as_tibble">as_tibble</code></td>
<td>
<p>(<strong>opcional</strong>) Regresar como <code>tibble</code> el resultado. En caso de que <code>as_tibble</code>
sea <code>FALSE</code> se devuelve como conexion en <code>duckdb</code>. Se recomienda el default (<code>tibble</code>).</p>
</td></tr>
<tr><td><code id="casos_+3A_fill_zeros">fill_zeros</code></td>
<td>
<p>(<strong>opcional</strong>) En caso de que el resultado sea un <code>tibble</code> regresa
observaciones para todas las combinaciones de variables incluyendo como 0 aquellas fechas
cuando no se observaron casos. En caso contrario no se incluyen las filas donde no se
observaron casos.</p>
</td></tr>
<tr><td><code id="casos_+3A_list_name">list_name</code></td>
<td>
<p>(<strong>opcional</strong>) Asigna un nombre en la lista de datos a la base generada</p>
</td></tr>
<tr><td><code id="casos_+3A_.grouping_vars">.grouping_vars</code></td>
<td>
<p>(<strong>opcional</strong>) Vector de variables adicionales de agrupacion de los
conteos. Por ejemplo si se agrega <code>.grouping_vars = 'DIABETES'</code> entonces para cada fecha habra
dos conteos de casos uno de los que tienen diabetes y uno de los que no.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>La función es un grupo de funciones de <code>dplyr</code> optimizadas para velocidad. Por ejemplo calcular
los casos por entidad se hace lo siguiente
</p>
<div class="sourceCode"><pre>datos_covid |&gt; casos()
</pre></div>
<p>es lo mismo que:
</p>
<div class="sourceCode"><pre>library(dplyr)
datos_covid$casos &lt;- datos_covid$dats |&gt;
    group_by(ENTIDAD_UM, FECHA_SINTOMAS) |&gt;
    tally() |&gt;
    left_join(datos_covid$dict$ENTIDAD_UM, by = c("ENTIDAD_UM" = "CLAVE_ENTIDAD"))
</pre></div>
<p>Elaboraciones mas complicadas en casos tienen su equivalente en dplyr por ejemplo:
</p>
<div class="sourceCode"><pre>datos_covid &lt;- datos_covid |&gt;
  casos(
    entidad_tipo = "Residencia",
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    group_by_tipo_clasificacion = FALSE,
    tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO"),
    group_by_tipo_paciente = TRUE,
    list_name = "bajas"
  )
</pre></div>
<p>es equivalente a
</p>
<div class="sourceCode"><pre>datos_covid$bajas &lt;- datos_covid$dats |&gt;
   filter(ENTIDAD_RES == "02" | ENTIDAD_RES == "03") |&gt; #BC/BCS
   filter(TIPO_PACIENTE == 1 | TIPO_PACIENTE == 2) |&gt; #Ambulatorio/Hospitalizado
   group_by(FECHA_SINTOMAS, ENTIDAD_RES, TIPO_PACIENTE) |&gt;
   tally() |&gt;
   left_join(datos_covid$dict$ENTIDAD_RES, by = c("ENTIDAD_RES" = "CLAVE_ENTIDAD")) |&gt;
   left_join(datos_covid$dict$PACIENTE, by = c("TIPO_PACIENTE" = "CLAVE"))
</pre></div>


<h3>Value</h3>

<p>Une a la lista de <code>datos_covid</code> una nueva entrada de nombre <code>list_name</code>
(default: <code>casos</code>) con una base de datos (<code>tibble</code> o <code>dbConnection</code>) con los
resultados agregados.
</p>

<ul>
<li><p> casos - Base de datos generara con los datos agregados (el nombre cambia si
se usa <code>list_name</code>).
</p>
</li>
<li><p> dict - Diccionario de datos
</p>
</li>
<li><p> dats - Datos originales (conexion a <code>duckdb</code> o <code>tibble</code>)
</p>
</li>
<li><p> disconnect  - Función para desconectarte de <code>duckdb</code>
</p>
</li>
<li><p> ... - Cualquier otro elemento que ya existiera en <code>datos_covid</code>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> <code><a href="#topic+numero_pruebas">numero_pruebas()</a></code> <code><a href="#topic+cfr">cfr()</a></code> <code><a href="#topic+chr">chr()</a></code> <code><a href="#topic+estima_rt">estima_rt()</a></code>
<code><a href="#topic+positividad">positividad()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Para el ejemplo usaremos los datos precargados (datosabiertos) pero tu puedes
# correr el ejemplo descargando informacion mas reciente:
datos_covid &lt;- datosabiertos

# Casos por entidad
datos_covid &lt;- datos_covid |&gt; casos()
head(datos_covid$casos)

# Defunciones por entidad
datos_covid &lt;- datos_covid |&gt; casos(defunciones = TRUE, list_name = "defunciones")
head(datos_covid$defunciones)

# Hospitalizados por entidad
datos_covid &lt;- datos_covid |&gt;
  casos(tipo_paciente = "HOSPITALIZADO", list_name = "hospitalizados")
head(datos_covid$hospitalizados)

# UCI por entidad

datos_covid &lt;- datos_covid |&gt; casos(tipo_uci = "SI", list_name = "uci")
head(datos_covid$uci)

# Solo pacientes IMSS
datos_covid &lt;- datos_covid |&gt; casos(tipo_sector = "IMSS", list_name = "imss")
head(datos_covid$imss)

# Pacientes IMSS y PEMEX separados
datos_covid &lt;- datos_covid |&gt; casos(tipo_sector = c("IMSS", "PEMEX"), list_name = "imss_y_pemex")
head(datos_covid$imss_y_pemex)

# Pacientes IMSS y PEMEX sumados
datos_covid &lt;- datos_covid |&gt;
  casos(
    tipo_sector = c("IMSS", "PEMEX"), list_name = "imss_+_pemex",
    group_by_tipo_sector = TRUE
  )
head(datos_covid$`imss_+_pemex`)

# Solo los de BAJA CALIFORNIA
datos_covid &lt;- datos_covid |&gt;
  casos(entidades = c("BAJA CALIFORNIA"), list_name = "BC")
head(datos_covid$BC)

# Solo los de BAJA CALIFORNIA por residencia
datos_covid &lt;- datos_covid |&gt;
  casos(entidades = c("BAJA CALIFORNIA"), entidad_tipo = "Residencia", list_name = "residencia")
head(datos_covid$residencia)

# Agrupando casos por tipo de clasificacion
datos_covid &lt;- datos_covid |&gt;
  casos(
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    group_by_tipo_clasificacion = TRUE,
    list_name = "BC_BCS"
  )
head(datos_covid$BC_BCS)

# Regresa la suma de los de BC + BCS por tipo de paciente
datos_covid &lt;- datos_covid |&gt;
  casos(
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    group_by_tipo_clasificacion = FALSE,
    tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO"),
    group_by_tipo_paciente = TRUE,
    list_name = "BC_+_BCS"
  )
head(datos_covid$`BC_+_BCS`)

# Si deseas agrupar por una variable que no este en las opciones
datos_covid &lt;- datos_covid |&gt;
  casos(
    group_by_entidad = FALSE,
    tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO"),
    group_by_tipo_paciente = TRUE,
    list_name = "sexo",
    .grouping_vars = c("SEXO")
  )
head(datos_covid$sexo)

# Si no recuerdas la codificacion de los sexos puedes usar el diccionario:
datos_covid$sexo &lt;- datos_covid$sexo |&gt;
  dplyr::left_join(datos_covid$dict$SEXO, by = c("SEXO" = "CLAVE"))
head(datos_covid$sexo)

# Si no recuerdas todas las variables de la base puedes usar glimpse para ver por
# que otras variables puedes clasificar
datos_covid$dats |&gt; dplyr::glimpse()


# Una vez hayas concluido tu trabajo no olvides desconectar
datos_covid$disconnect()

</code></pre>

<hr>
<h2 id='cfr'>Case Fatality Rate (CFR)</h2><span id='topic+cfr'></span>

<h3>Description</h3>

<p>Calcula la proporcion de enfermos que fallecen sobre todos los enfermos confirmados
en distintas categorias (residencia / edad / etc)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cfr(
  datos_covid,
  entidades = c("AGUASCALIENTES", "BAJA CALIFORNIA", "BAJA CALIFORNIA SUR", "CAMPECHE",
    "CHIAPAS", "CHIHUAHUA", "CIUDAD DE MÉXICO", "COAHUILA DE ZARAGOZA", "COLIMA",
    "DURANGO", "GUANAJUATO", "GUERRERO", "HIDALGO", "JALISCO", "MÉXICO",
    "MICHOACÁN DE OCAMPO", "MORELOS", "NAYARIT", "NUEVO LEÓN", "OAXACA", "PUEBLA",
    "QUERÉTARO", "QUINTANA ROO", "SAN LUIS POTOSÍ", "SINALOA", "SONORA", "TABASCO",
    "TAMAULIPAS", "TLAXCALA", "VERACRUZ DE IGNACIO DE LA LLAVE", "YUCATÁN", "ZACATECAS"),
  group_by_entidad = TRUE,
  entidad_tipo = c("Unidad Medica", "Residencia", "Nacimiento"),
  fecha_tipo = c("Sintomas", "Ingreso", "Defuncion"),
  tipo_uci = c("SI", "NO", "NO APLICA", "SE IGNORA", "NO ESPECIFICADO"),
  group_by_tipo_uci = FALSE,
  tipo_clasificacion = c("Confirmados COVID"),
  group_by_tipo_clasificacion = FALSE,
  tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO", "NO ESPECIFICADO"),
  group_by_tipo_paciente = FALSE,
  tipo_sector = c("CRUZ ROJA", "DIF", "ESTATAL", "IMSS", "IMSS-BIENESTAR", "ISSSTE",
    "MUNICIPAL", "PEMEX", "PRIVADA", "SEDENA", "SEMAR", "SSA", "UNIVERSITARIO",
    "NO ESPECIFICADO"),
  group_by_tipo_sector = FALSE,
  edad_cut = NULL,
  fill_NA = TRUE,
  list_name = "case fatality rate",
  .grouping_vars = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cfr_+3A_datos_covid">datos_covid</code></td>
<td>
<p>(<strong>obligatorio</strong>) Lista de <code>tibble</code>s o <code>duckdb</code>s resultante de
<code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> o <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code></p>
</td></tr>
<tr><td><code id="cfr_+3A_entidades">entidades</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con las entidades de las unidades medicas a analizar.
Opciones: <code>AGUASCALIENTES</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA&#8288;</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA SUR&#8288;</code>,
<code>CAMPECHE</code>, <code>CHIAPAS</code>, <code>CHIHUAHUA</code>, <code style="white-space: pre;">&#8288;CIUDAD DE MEXICO&#8288;</code>,
<code style="white-space: pre;">&#8288;COAHUILA DE ZARAGOZA&#8288;</code> , <code>COLIMA</code>, <code>DURANGO</code>, <code>GUANAJUATO</code>, <code>GUERRERO</code>,
<code>HIDALGO</code>, <code>JALISCO</code>, <code>MEXICO</code>, <code style="white-space: pre;">&#8288;MICHOACAN DE OCAMPO&#8288;</code>, <code>MORELOS</code>,<code>NAYARIT</code>
<code style="white-space: pre;">&#8288;NUEVO LEON&#8288;</code>, <code>OAXACA</code> ,<code>PUEBLA</code>, <code>QUERETARO</code>,<code style="white-space: pre;">&#8288;QUINTANA ROO&#8288;</code>,
<code style="white-space: pre;">&#8288;SAN LUIS POTOSI&#8288;</code>, <code>SINALOA</code>, <code>SONORA</code>, <code>TABASCO</code>, <code>TAMAULIPAS</code>,<code>TLAXCALA</code>,
<code style="white-space: pre;">&#8288;VERACRUZ DE IGNACIO DE LA LLAVE&#8288;</code>, <code>YUCATAN</code>, <code>ZACATECAS</code>.</p>
</td></tr>
<tr><td><code id="cfr_+3A_group_by_entidad">group_by_entidad</code></td>
<td>
<p>(<strong>opcional</strong>) <code>TRUE</code> obtiene los casos para cada entidad reportando
en cada fecha la entidad y los casos en dicha entidad. <code>FALSE</code>  junta las <code>entidades</code> sumando
sus casos en una sola observacion por cada fecha.</p>
</td></tr>
<tr><td><code id="cfr_+3A_entidad_tipo">entidad_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Indica a que se refiere las <code>entidades</code> seleccionadas. Elige
una de las opciones: <code style="white-space: pre;">&#8288;Unidad Medica&#8288;</code> (entidad de la unidad medica), <code>Nacimiento</code>
(entidad de origen del individuo) o <code>Residencia</code> (entidad donde reside el individuo).</p>
</td></tr>
<tr><td><code id="cfr_+3A_fecha_tipo">fecha_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Selecciona si la fecha que se utiliza es la fecha de <code>Ingreso</code>
(si aplica), la fecha de <code>Sintomas</code> o la de <code>Defuncion</code> (si aplica). El default es fecha de <code>Sintomas</code>.</p>
</td></tr>
<tr><td><code id="cfr_+3A_tipo_uci">tipo_uci</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con el tipo de valores para Unidad de
Cuidado Intensivo (UCI) a incluir:  <code>SI</code>,<code>NO</code>,<code style="white-space: pre;">&#8288;NO APLICA&#8288;</code>,<code style="white-space: pre;">&#8288;SE IGNORA&#8288;</code>,<code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>.
Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="cfr_+3A_group_by_tipo_uci">group_by_tipo_uci</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana. El caso <code>TRUE</code> determina si regresa la base
con cada fecha teniendo diferentes renglones uno para cada <code>tipo_uci</code> (es decir cada fecha
se generan tantos observaciones como grupos de tipo de UCI) o bien en una sola fecha
se suman todos los tipos de UCI (<code>FALSE</code>). El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cfr_+3A_tipo_clasificacion">tipo_clasificacion</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con el tipo de clasificaciones (por la prueba)
a incluir:<code>Sospechosos</code>,<code style="white-space: pre;">&#8288;Confirmados COVID&#8288;</code>, <code style="white-space: pre;">&#8288;Negativo a COVID&#8288;</code>, <code style="white-space: pre;">&#8288;Inv\u00e1lido&#8288;</code>, <code style="white-space: pre;">&#8288;No realizado&#8288;</code></p>
</td></tr>
<tr><td><code id="cfr_+3A_group_by_tipo_clasificacion">group_by_tipo_clasificacion</code></td>
<td>
<p>(<strong>opcional</strong>)  Booleana determinando si regresa la base
con cada entrada agrupada por <code>tipo_clasificacion</code> (es decir cada fecha
se generan tantos observaciones como grupos de tipo de clasificación) en caso <code>TRUE</code>. Si
<code>FALSE</code> suma todos los casos del tipo de clasificacion por fecha dando un solo numero por fecha.
El defalt es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cfr_+3A_tipo_paciente">tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con el tipo de pacientes a incluir. Opciones:
<code>AMBULATORIO</code>, <code>HOSPITALIZADO</code>, <code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>. Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="cfr_+3A_group_by_tipo_paciente">group_by_tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determinando (caso <code>TRUE</code>) si regresa
la base con cada entrada agrupada por <code>tipo_paciente</code> (es decir cada fecha
se genera un renglon para <code>AMBULATORIO</code>, un renglon para <code>HOSPITALIZADO</code>, etc) o bien
si se suman todos los grupos y cada fecha reporta solo la suma de estos
(estilo <code>AMBULATORIO + HOSPITALIZADO</code> segun las categorias de <code>tipo_paciente</code>)
El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cfr_+3A_tipo_sector">tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con los sectores del sistema de salud a incluir:
<code style="white-space: pre;">&#8288;CRUZ ROJA&#8288;</code>,<code>DIF</code>,<code>ESTATAL</code>,<code>IMSS</code>,<code>IMSS-BIENESTAR</code>,<code>ISSSTE</code>, <code>MUNICIPAL</code>,<code>PEMEX</code>,
<code>PRIVADA</code>,<code>SEDENA</code>,<code>SEMAR</code>,<code>SSA</code>, <code>UNIVERSITARIO</code>,<code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>.
Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="cfr_+3A_group_by_tipo_sector">group_by_tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determina en el caso de <code>TRUE</code> si regresa
la base con cada entrada agrupada por <code>tipo_sector</code> (es decir cada fecha
tiene una entrada con los del <code>IMSS</code>, una entrada distinta con los de <code>ISSSTE</code>, etc) o bien
en caso de <code>FALSE</code> se devuelve una sola entrada por fecha con la suma <code>IMSS + ISSSTE + etc</code>
segun los  sectores seleccionados. El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cfr_+3A_edad_cut">edad_cut</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con secuencia de edades para hacer grupos. Por ejemplo
<code>edad_cut = c(0, 10, Inf)</code> arma dos grupos de edad de 0 a 10 y de 10 a infinito o bien
<code>edad_cut = c(15, 20)</code> deja sólo los registros entre 15 y 20 años. Por default es <code>NULL</code>
y no arma grupos etarios.</p>
</td></tr>
<tr><td><code id="cfr_+3A_fill_na">fill_NA</code></td>
<td>
<p>(<strong>opcional</strong>)  Regresa observaciones para todas las combinaciones de variables
incluyendo como <code>NA</code> donde no se observaron casos en el denominador.  En caso contrario no se
incluyen las filas donde no se observaron casos.</p>
</td></tr>
<tr><td><code id="cfr_+3A_list_name">list_name</code></td>
<td>
<p>(<strong>opcional</strong>) Asigna un nombre en la lista de datos a la base generada</p>
</td></tr>
<tr><td><code id="cfr_+3A_.grouping_vars">.grouping_vars</code></td>
<td>
<p>(<strong>opcional</strong>) Vector de variables adicionales de agrupacion de los
conteos. Por ejemplo si se agrega <code>.grouping_vars = 'DIABETES'</code> entonces para cada fecha habra
dos conteos de casos uno de los que tienen diabetes y uno de los que no.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>El case fatality rate se define como
</p>
<p style="text-align: center;"><code class="reqn">\frac{\# Defunciones}{Total de enfermos}</code>
</p>

<p>Si se utiliza la opción <code>tipo_clasificacion</code> se puede cambiar la definicion de enfermo
(por default se incluyen solamente <code>"Confirmados COVID"</code>).
</p>


<h3>Value</h3>

<p>Une a la lista de <code>datos_covid</code> una nueva entrada de nombre <code>list_name</code>
(default: <code style="white-space: pre;">&#8288;case fatality rate&#8288;</code>) con una base de datos (<code>tibble</code> o <code>duckdb</code>) con los
resultados agregados.
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;case fatality rate&#8288;</code> - Base de datos generara con los datos agregados (el nombre cambia
si se usa <code>list_name</code>).
</p>
</li>
<li><p> dict - Diccionario de datos
</p>
</li>
<li><p> dats - Datos originales (conexion a <code>duckdb</code> o <code>tibble</code>)
</p>
</li>
<li><p> disconnect  - Función para desconectarte de <code>duckdb</code>
</p>
</li>
<li><p> ... - Cualquier otro elemento que ya existiera en <code>datos_covid</code>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> <code><a href="#topic+numero_pruebas">numero_pruebas()</a></code> <code><a href="#topic+chr">chr()</a></code> <code><a href="#topic+estima_rt">estima_rt()</a></code>
<code><a href="#topic+positividad">positividad()</a></code> <code><a href="#topic+casos">casos()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Para el ejemplo usaremos los datos precargados (datosabiertos) pero tu puedes
# correr el ejemplo descargando informacion mas reciente.
datos_covid &lt;- datosabiertos

# Casos a nivel nacional por entidad
datos_covid &lt;- datos_covid |&gt; cfr()
head(datos_covid$`case fatality rate`)

# Agregando todos los estados
datos_covid &lt;- datos_covid |&gt;
  cfr(list_name = "cfr_nacional", group_by_entidad = FALSE)
head(datos_covid$`cfr_nacional`)

# CFR en Baja California
datos_covid &lt;- datos_covid |&gt;
  cfr(entidades = c("BAJA CALIFORNIA"), list_name = "cfr_bc")
head(datos_covid$`cfr_bc`)

# Calcula el CFR suponiendo toda la base son confirmados
datos_covid &lt;- datos_covid |&gt;
  cfr(
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    tipo_clasificacion = c(
      "Sospechosos", "Confirmados COVID",
      "Negativo a COVID", "Inv\u00e1lido", "No realizado"
    ),
    group_by_tipo_clasificacion = TRUE, list_name = "bc_bcs_cfr"
  )
head(datos_covid$`bc_bcs_cfr`) # Los NA es porque no habia observaciones en el denominador

# Distinguiendo entre ambulatorio y hospitalizado
datos_covid &lt;- datos_covid |&gt;
  cfr(
    tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO"),
    group_by_tipo_paciente = TRUE,
    list_name = "cfr_paciente"
  )
head(datos_covid$cfr_paciente)

# CFR en distintos grupos de edad (0 a 20, 20 a 60 y 60+)
datos_covid &lt;- datos_covid |&gt;
  cfr(edad_cut = c(0, 20, 60, Inf), list_name = "cfr_edad")
head(datos_covid$cfr_edad)

# Si deseas agrupar por una variable que no este en las opciones
datos_covid &lt;- datos_covid |&gt;
  cfr(.grouping_vars = c("DIABETES"), list_name = "cfr_diab")
head(datos_covid$cfr_diab)

# Finalmente desconectamos
datos_covid$disconnect()

</code></pre>

<hr>
<h2 id='check_sites'>Funcion para verificar la existencia de los sitios web de datos de covid</h2><span id='topic+check_sites'></span>

<h3>Description</h3>

<p>La funcion recorre cada uno de los sitios y verifica su existencia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_sites(covid_data = TRUE, dictionnary = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_sites_+3A_covid_data">covid_data</code></td>
<td>
<p>(<strong>opcional</strong>) Variable booleana <code>TRUE</code> si verifica los sitios de
datos y <code>FALSE</code> si no los verifica</p>
</td></tr>
<tr><td><code id="check_sites_+3A_dictionnary">dictionnary</code></td>
<td>
<p>(<strong>opcional</strong>) Variable booleana <code>TRUE</code> si verifica los sitios del
diccionario y <code>FALSE</code> si no lo verifica</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Devuelve <code>TRUE</code> si todos los sitios web existen, <code>FALSE</code>en caso de que no.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Verificamos que existan los sitios cambiando a TRUE cualquiera:
check_sites(covid_data = FALSE, dictionnary = FALSE)

</code></pre>

<hr>
<h2 id='chr'>Case Hospitalization Rate (CHR)</h2><span id='topic+chr'></span>

<h3>Description</h3>

<p><code>chr</code> Calcula la proporción de enfermos que resultan hospitalizados sobre todos los enfermos
confirmados en distintas categorías (residencia / edad / etc)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chr(
  datos_covid,
  entidades = c("AGUASCALIENTES", "BAJA CALIFORNIA", "BAJA CALIFORNIA SUR", "CAMPECHE",
    "CHIAPAS", "CHIHUAHUA", "CIUDAD DE MÉXICO", "COAHUILA DE ZARAGOZA", "COLIMA",
    "DURANGO", "GUANAJUATO", "GUERRERO", "HIDALGO", "JALISCO", "MÉXICO",
    "MICHOACÁN DE OCAMPO", "MORELOS", "NAYARIT", "NUEVO LEÓN", "OAXACA", "PUEBLA",
    "QUERÉTARO", "QUINTANA ROO", "SAN LUIS POTOSÍ", "SINALOA", "SONORA", "TABASCO",
    "TAMAULIPAS", "TLAXCALA", "VERACRUZ DE IGNACIO DE LA LLAVE", "YUCATÁN", "ZACATECAS"),
  group_by_entidad = TRUE,
  entidad_tipo = c("Unidad Medica", "Residencia", "Nacimiento"),
  fecha_tipo = c("Sintomas", "Ingreso", "Defuncion"),
  tipo_clasificacion = c("Confirmados COVID"),
  group_by_tipo_clasificacion = FALSE,
  incluir_paciente_no_especificado = FALSE,
  tipo_sector = c("CRUZ ROJA", "DIF", "ESTATAL", "IMSS", "IMSS-BIENESTAR", "ISSSTE",
    "MUNICIPAL", "PEMEX", "PRIVADA", "SEDENA", "SEMAR", "SSA", "UNIVERSITARIO",
    "NO ESPECIFICADO"),
  group_by_tipo_sector = FALSE,
  defunciones = FALSE,
  edad_cut = NULL,
  fill_NA = TRUE,
  list_name = "case hospitalization rate",
  .grouping_vars = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chr_+3A_datos_covid">datos_covid</code></td>
<td>
<p>(<strong>obligatorio</strong>) Lista de <code>tibble</code>s o <code>duckdb</code>s resultante de
<code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> o <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code></p>
</td></tr>
<tr><td><code id="chr_+3A_entidades">entidades</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con las entidades de las unidades medicas a analizar.
Opciones: <code>AGUASCALIENTES</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA&#8288;</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA SUR&#8288;</code>,
<code>CAMPECHE</code>, <code>CHIAPAS</code>, <code>CHIHUAHUA</code>, <code style="white-space: pre;">&#8288;CIUDAD DE MEXICO&#8288;</code>,
<code style="white-space: pre;">&#8288;COAHUILA DE ZARAGOZA&#8288;</code> , <code>COLIMA</code>, <code>DURANGO</code>, <code>GUANAJUATO</code>, <code>GUERRERO</code>,
<code>HIDALGO</code>, <code>JALISCO</code>, <code>MEXICO</code>, <code style="white-space: pre;">&#8288;MICHOACAN DE OCAMPO&#8288;</code>, <code>MORELOS</code>,<code>NAYARIT</code>
<code style="white-space: pre;">&#8288;NUEVO LEON&#8288;</code>, <code>OAXACA</code> ,<code>PUEBLA</code>, <code>QUERETARO</code>,<code style="white-space: pre;">&#8288;QUINTANA ROO&#8288;</code>,
<code style="white-space: pre;">&#8288;SAN LUIS POTOSI&#8288;</code>, <code>SINALOA</code>, <code>SONORA</code>, <code>TABASCO</code>, <code>TAMAULIPAS</code>,<code>TLAXCALA</code>,
<code style="white-space: pre;">&#8288;VERACRUZ DE IGNACIO DE LA LLAVE&#8288;</code>, <code>YUCATAN</code>, <code>ZACATECAS</code>.</p>
</td></tr>
<tr><td><code id="chr_+3A_group_by_entidad">group_by_entidad</code></td>
<td>
<p>(<strong>opcional</strong>) <code>TRUE</code> obtiene los casos para cada entidad reportando
en cada fecha la entidad y los casos en dicha entidad. <code>FALSE</code>  junta las <code>entidades</code> sumando
sus casos en una sola observacion por cada fecha.</p>
</td></tr>
<tr><td><code id="chr_+3A_entidad_tipo">entidad_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Indica a que se refiere las <code>entidades</code> seleccionadas. Elige
una de las opciones: <code style="white-space: pre;">&#8288;Unidad Medica&#8288;</code> (entidad de la unidad medica), <code>Nacimiento</code>
(entidad de origen del individuo) o <code>Residencia</code> (entidad donde reside el individuo).</p>
</td></tr>
<tr><td><code id="chr_+3A_fecha_tipo">fecha_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Selecciona si la fecha que se utiliza es la fecha de <code>Ingreso</code>
(si aplica), la fecha de <code>Sintomas</code> o la de <code>Defuncion</code> (si aplica). El default es fecha de <code>Sintomas</code>.</p>
</td></tr>
<tr><td><code id="chr_+3A_tipo_clasificacion">tipo_clasificacion</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con el tipo de clasificaciones (por la prueba)
a incluir:<code>Sospechosos</code>,<code style="white-space: pre;">&#8288;Confirmados COVID&#8288;</code>, <code style="white-space: pre;">&#8288;Negativo a COVID&#8288;</code>, <code style="white-space: pre;">&#8288;Inv\u00e1lido&#8288;</code>, <code style="white-space: pre;">&#8288;No realizado&#8288;</code></p>
</td></tr>
<tr><td><code id="chr_+3A_group_by_tipo_clasificacion">group_by_tipo_clasificacion</code></td>
<td>
<p>(<strong>opcional</strong>)  Booleana determinando si regresa la base
con cada entrada agrupada por <code>tipo_clasificacion</code> (es decir cada fecha
se generan tantos observaciones como grupos de tipo de clasificación) en caso <code>TRUE</code>. Si
<code>FALSE</code> suma todos los casos del tipo de clasificacion por fecha dando un solo numero por fecha.
El defalt es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="chr_+3A_incluir_paciente_no_especificado">incluir_paciente_no_especificado</code></td>
<td>
<p>(<strong>opcional</strong>)  Si en el denominador se incluyen
los pacientescuyo tipo es  <code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>. Por default es <code>FALSE</code> por lo que sólo
se incluyen <code>AMBULATORIO</code>, <code>HOSPITALIZADO</code>.</p>
</td></tr>
<tr><td><code id="chr_+3A_tipo_sector">tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con los sectores del sistema de salud a incluir:
<code style="white-space: pre;">&#8288;CRUZ ROJA&#8288;</code>,<code>DIF</code>,<code>ESTATAL</code>,<code>IMSS</code>,<code>IMSS-BIENESTAR</code>,<code>ISSSTE</code>, <code>MUNICIPAL</code>,<code>PEMEX</code>,
<code>PRIVADA</code>,<code>SEDENA</code>,<code>SEMAR</code>,<code>SSA</code>, <code>UNIVERSITARIO</code>,<code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>.
Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="chr_+3A_group_by_tipo_sector">group_by_tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determina en el caso de <code>TRUE</code> si regresa
la base con cada entrada agrupada por <code>tipo_sector</code> (es decir cada fecha
tiene una entrada con los del <code>IMSS</code>, una entrada distinta con los de <code>ISSSTE</code>, etc) o bien
en caso de <code>FALSE</code> se devuelve una sola entrada por fecha con la suma <code>IMSS + ISSSTE + etc</code>
segun los  sectores seleccionados. El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="chr_+3A_defunciones">defunciones</code></td>
<td>
<p>(<strong>opcional</strong>)  Booleana si incluir sólo defunciones <code>TRUE</code> o a todos <code>FALSE</code>.
El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="chr_+3A_edad_cut">edad_cut</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con secuencia de edades para hacer grupos. Por ejemplo
<code>edad_cut = c(0, 10, Inf)</code> arma dos grupos de edad de 0 a 10 y de 10 a infinito o bien
<code>edad_cut = c(15, 20)</code> deja sólo los registros entre 15 y 20 años. Por default es <code>NULL</code>
y no arma grupos etarios.</p>
</td></tr>
<tr><td><code id="chr_+3A_fill_na">fill_NA</code></td>
<td>
<p>(<strong>opcional</strong>)  Regresa observaciones para todas las combinaciones de variables
incluyendo como <code>NA</code> donde no se observaron casos en el denominador.  En caso contrario no se
incluyen las filas donde no se observaron casos.</p>
</td></tr>
<tr><td><code id="chr_+3A_list_name">list_name</code></td>
<td>
<p>(<strong>opcional</strong>) Asigna un nombre en la lista de datos a la base generada</p>
</td></tr>
<tr><td><code id="chr_+3A_.grouping_vars">.grouping_vars</code></td>
<td>
<p>(<strong>opcional</strong>) Vector de variables adicionales de agrupacion de los
conteos. Por ejemplo si se agrega <code>.grouping_vars = 'DIABETES'</code> entonces para cada fecha habra
dos conteos de casos uno de los que tienen diabetes y uno de los que no.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>El case hospitalization rate se define como
</p>
<p style="text-align: center;"><code class="reqn">\frac{\# Hospitalizados}{Total de enfermos}</code>
</p>

<p>Si se utiliza la opción <code>incluir_paciente_no_especificado</code> se puede cambiar la definicion
de <strong>Total de enfermos</strong> para incluir a los pacientes que dicen <code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>. Estos
por default se excluyen justo por su naturaleza desconocida.
</p>


<h3>Value</h3>

<p>Une a la lista de <code>datos_covid</code> una nueva entrada de nombre <code>list_name</code>
(default: <code style="white-space: pre;">&#8288;case hospitalization rate&#8288;</code>) con una base de datos (<code>tibble</code> o <code>duckdb</code>) con los
resultados agregados.
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;case hospitalization rate&#8288;</code> - Base de datos generara con los datos agregados (el
nombre cambia si se usa <code>list_name</code>).
</p>
</li>
<li><p> dict - Diccionario de datos
</p>
</li>
<li><p> dats - Datos originales (conexion a <code>duckdb</code> o <code>tibble</code>)
</p>
</li>
<li><p> disconnect  - Función para desconectarte de <code>duckdb</code>
</p>
</li>
<li><p> ... - Cualquier otro elemento que ya existiera en <code>datos_covid</code>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> <code><a href="#topic+numero_pruebas">numero_pruebas()</a></code> <code><a href="#topic+cfr">cfr()</a></code> <code><a href="#topic+estima_rt">estima_rt()</a></code>
<code><a href="#topic+positividad">positividad()</a></code> <code><a href="#topic+casos">casos()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Para el ejemplo usaremos los datos precargados (datosabiertos) pero tu puedes
# correr el ejemplo descargando informacion mas reciente.
datos_covid &lt;- datosabiertos

# Casos a nivel nacional
datos_covid &lt;- datos_covid |&gt; chr()
head(datos_covid$`case hospitalization rate`)

# Nacional

datos_covid &lt;- datos_covid |&gt; chr(list_name = "chr_nacional", group_by_entidad = FALSE)
head(datos_covid$`chr_nacional`)

# CHR en IMSS e ISSSTE
datos_covid &lt;- datos_covid |&gt;
  chr(tipo_sector = c("IMSS", "ISSSTE"), list_name = "chimss", group_by_tipo_sector = TRUE)
head(datos_covid$`chimss`)

# Calcula el CHR sobre toda la base
datos_covid &lt;- datos_covid |&gt;
  chr(
    tipo_clasificacion = c(
      "Sospechosos", "Confirmados COVID",
      "Negativo a COVID", "Inv\u00e1lido", "No realizado"
    ),
    group_by_tipo_clasificacion = TRUE, list_name = "chr_todos"
  )
head(datos_covid$`chr_todos`)

# Distinguiendo sólo entre defunciones
datos_covid &lt;- datos_covid |&gt;
  chr(defunciones = TRUE, list_name = "chr_defun")
head(datos_covid$`chr_defun`)

# Si deseas agrupar por una variable que no este en las opciones
datos_covid &lt;- datos_covid |&gt;
  chr(.grouping_vars = c("DIABETES"), list_name = "chr_diab")
head(datos_covid$chr_diab)

# Finalmente desconectamos
datos_covid$disconnect()

</code></pre>

<hr>
<h2 id='datosabiertos'>Datos abiertos de COVID-19</h2><span id='topic+datosabiertos'></span>

<h3>Description</h3>

<p>Base de datos que contiene una extraccion pequenia de la base de datos
abiertos que se obtiene mediante <code>descarga_datos_abiertos</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datosabiertos
</code></pre>


<h3>Format</h3>

<p>Una lista con tres objetos
</p>

<dl>
<dt>dats</dt><dd><p>Base de datos de la DGE actualizada el 8 septiembre 2022 filtrada a BC,
BCS en julio y agosto del 2022</p>
</dd>
<dt>dict</dt><dd><p>Diccionario de datos</p>
</dd>
<dt>disconnect</dt><dd><p>Funcion que simula desconexion de <code>duckdb</code></p>
</dd>
</dl>



<h3>Details</h3>

<p>El proposito de esta base es poder probar las funciones que se aplican sobre
<code>datos_covid</code>. La base contiene solo las entidades de <code style="white-space: pre;">&#8288;BAJA CALIFORNIA&#8288;</code> y
<code style="white-space: pre;">&#8288;BAJA CALIFORNIA SUR&#8288;</code> durante julio y agosto del 2021.
</p>


<h3>Source</h3>

<p><a href="https://www.gob.mx/salud/documentos/datos-abiertos-152127">https://www.gob.mx/salud/documentos/datos-abiertos-152127</a>
</p>

<hr>
<h2 id='descarga_datos_abiertos'>Descarga de datos abiertos</h2><span id='topic+descarga_datos_abiertos'></span>

<h3>Description</h3>

<p>Funcion para la descarga de datos abiertos de
la Direccion General de Epidemiologia (DGE)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>descarga_datos_abiertos(
  dbdir = tempfile(fileext = ".duckdb"),
  sites.covid = get_sites_covid(),
  site.covid.dic = get_site_dic(),
  read_format = c("duckdb", "tibble"),
  drv = duckdb::duckdb(),
  pragma_memory_limit = Sys.getenv("pragma_memory_limit"),
  tblname = "covidmx",
  colClasses = get_col_class(),
  download_process = c("pins", "download.file"),
  unzip_command = Sys.getenv("unzip_command"),
  unzip_args = Sys.getenv("unzip_args"),
  unzip_args_dict = list(exdir = ".", overwrite = TRUE),
  check_unzip_install = TRUE,
  clear_zip = (download_process[1] != "pins"),
  clear_csv = TRUE,
  use_dict = TRUE,
  datos_abiertos_zip_paths = NULL,
  datos_abiertos_unzipped_path = NULL,
  datos_abiertos_tbl = NULL,
  diccionario_zip_path = NULL,
  diccionario_unzipped_path = NULL,
  diccionario = NULL,
  quiet = FALSE,
  cache_datos = NULL,
  use_cache_on_failure = TRUE,
  cache_diccionario = NULL,
  force_download = FALSE,
  show_warnings = TRUE,
  board_url_name = "datos_abiertos",
  board_url_name_dict = "diccionario_covid",
  download_file_args = list(method = "curl", destfile = tempfile(), quiet = quiet),
  download_file_args_dict = download_file_args,
  descarga_db_datos_abiertos_tbl_args = list(),
  descarga_db_diccionario_ssa_args = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="descarga_datos_abiertos_+3A_dbdir">dbdir</code></td>
<td>
<p>(<strong>opcional</strong>) Direccion donde guardar la base de datos con terminacion <code>.duckdb</code>.
Corresponde al argumento de <code><a href="duckdb.html#topic+duckdb">duckdb::dbConnect__duckdb_driver()</a></code></p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_sites.covid">sites.covid</code></td>
<td>
<p>(<strong>opcional</strong>)  Sitios web con el vinculo a los archivos <code>.zip</code> de l
os datos abiertos. Puedes cambiarlo por uno de los historicos, por ejemplo. La estructura es
<code>c("nombre" = "url", "nombre2" = "url2")</code>. La ultima verificacion del sitio web default fue
el 6 de septiembre del 2022.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_site.covid.dic">site.covid.dic</code></td>
<td>
<p>(<strong>opcional</strong>)  Sitio desde el cual descarga del diccionario de datos.
La ultima verificacion del sitio fue el 6 de septiembre 2022.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_read_format">read_format</code></td>
<td>
<p>(<strong>opcional</strong>) <code>"duckdb"</code> o <code>"tibble"</code> establece el formato
de lectura de la base de datos. En la mayoria de los casos <code>"tibble"</code> va a
resultar en un error de memoria. La opcion de <code>"duckdb"</code> siempre es mas rapida por lo cual
es el default.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_drv">drv</code></td>
<td>
<p>(<strong>opcional</strong>) Un  driver para <code>dbConnect</code> (default <code>duckdb::duckdb()</code>)</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_pragma_memory_limit">pragma_memory_limit</code></td>
<td>
<p>(<strong>opcional</strong>) Limite de memoria para el programa
(ver <a href="https://duckdb.org/docs/sql/pragmas">PRAGMAS</a>). Cambialo a que sea mas o menos la mitad
de tu RAM. La forma mas sencilla es como una variable ambiental con
<code>Sys.setenv('pragma_memory_limit' = '1GB')</code> por ejemplo para un limite de 1 gigabyte.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_tblname">tblname</code></td>
<td>
<p>(<strong>opcional</strong>)  Nombre de la tabla de <code>duckdb</code> donde guardar los datos por
default se llama <code>covidmx</code>. Solo es relevante si estas usando el mismo <code>dbdir</code> para otro
proyecto distinto.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_colclasses">colClasses</code></td>
<td>
<p>(<strong>opcional</strong>) Clases de la columna para leer en <code>duckdb::read_csv_duckdb()</code>.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_download_process">download_process</code></td>
<td>
<p>(<strong>opcional</strong>)  Metodo para descargar ya sea <code>pins</code> o <code>download.file</code>.
Se recomienda <code>pins</code> pues guarda en memoria la fecha de la ultima descarga y analiza
si ha pasado mas de un dia desde la descarga. En caso afirmativo verifica si el
archivo ha cambiado y si hubo cambios entonces lo descarga.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_unzip_command">unzip_command</code></td>
<td>
<p>(<strong>opcional</strong>) Forma de extraer la base de datos de datos abiertos
si <code>unzip</code> falla.
La forma de llamarla es con <code>system2(unzip_command, args = c(unzip_args, file_download_data))</code>.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_unzip_args">unzip_args</code></td>
<td>
<p>(<strong>opcional</strong>) Argumentos de extraccion de la base de datos de datos abiertos
si <code>unzip</code> falla.
La forma de llamarla es con <code>system2(unzip_command, args = c(unzip_args, file_download_data))</code>.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_unzip_args_dict">unzip_args_dict</code></td>
<td>
<p>(<strong>opcional</strong>) Lista de argumentos para usar <code>utils::unzip</code> en el
diccionario de datos.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_check_unzip_install">check_unzip_install</code></td>
<td>
<p>(<strong>opcional</strong>) Bandera de verificacion para checar si tienes
lo necesario para unzippear los datos en el caso de que <code>unzip</code> no sirva.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_clear_zip">clear_zip</code></td>
<td>
<p>(<strong>opcional</strong>) Si borrar los archivos <code>.zip</code> descargados para el diccionario
y los datos abiertos. No se recomienda si estas usando <code>pins</code>. Ve la nota para mas informacion.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_clear_csv">clear_csv</code></td>
<td>
<p>(<strong>opcional</strong>) Si borrar los archivos <code>.csv</code> que se generan despues de abrir
el zip. El default es que si pues en general solo requieres el <code>duckdb</code>.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_use_dict">use_dict</code></td>
<td>
<p>(<strong>opcional</strong>) Si descargar el diccionario de <code>site.covid.dic</code>.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_datos_abiertos_zip_paths">datos_abiertos_zip_paths</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino a los datos abiertos si ya los
descargaste en <code>zip</code></p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_datos_abiertos_unzipped_path">datos_abiertos_unzipped_path</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino a los datos abiertos <code>csv</code> si ya
los descargaste y descomprimiste el archivo <code>zip</code> en un <code>csv</code></p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_datos_abiertos_tbl">datos_abiertos_tbl</code></td>
<td>
<p>(<strong>opcional</strong>) Camino a un archivo <code>.duckdb</code> con los datos formateados</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_diccionario_zip_path">diccionario_zip_path</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino al diccionario si ya losdescargaste en <code>zip</code></p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_diccionario_unzipped_path">diccionario_unzipped_path</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino al diccionario <code>csv</code> si ya
lo descargaste y descomprimiste el archivo <code>zip</code> en un <code>csv</code></p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_diccionario">diccionario</code></td>
<td>
<p>(<strong>opcional</strong>)  Lo que resulta de realizar una descarga del diccionario
usando <code>descarga_diccionario</code></p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_quiet">quiet</code></td>
<td>
<p>(<strong>opcional</strong>) Variable para no mostrar mensajes</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_cache_datos">cache_datos</code></td>
<td>
<p>(<strong>opcional</strong>) Direccion donde guardar los datos en memoria usando <code>pins</code>
para no tener que volver a descargarlos si nada ha cambiado</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_use_cache_on_failure">use_cache_on_failure</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana. Establece que si no se pueden descargar
datos nuevos utilice los que tenga en memoria. Por default es <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_cache_diccionario">cache_diccionario</code></td>
<td>
<p>(<strong>opcional</strong>) Direccion donde guardar el diccionario en memoria
usando <code>pins</code> para no tener que volver a descargarlo si nada ha cambiado</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_force_download">force_download</code></td>
<td>
<p>(<strong>opcional</strong>) Analiza si cambio el pin y descarga datos nuevos en caso
afirmativo aunque haya pasado menos de un dia.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_show_warnings">show_warnings</code></td>
<td>
<p>(<strong>opcional</strong>) si arrojar <code>warnings</code></p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_board_url_name">board_url_name</code></td>
<td>
<p>(<strong>opcional</strong>) Establece el nombre del <code>pins::board_url</code> para
los datos abiertos (si ya usas pins para que no se empalme).
Por default se llama <code>datos_abiertos</code></p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_board_url_name_dict">board_url_name_dict</code></td>
<td>
<p>(<strong>opcional</strong>) Establece el nombre del <code>pins::board_url</code> para los
datos abiertos. Por default se llama <code>diccionario_covid</code></p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_download_file_args">download_file_args</code></td>
<td>
<p>(<strong>opcional</strong>) Lista de argumentos adicionales para <code>download.file</code>
de los datos si se elige este metodo para descargar.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_download_file_args_dict">download_file_args_dict</code></td>
<td>
<p>(<strong>opcional</strong>) Lista de argumentos adicionales
para <code>download.file</code> del diccionario si se elige este metodo de descarga.</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_descarga_db_datos_abiertos_tbl_args">descarga_db_datos_abiertos_tbl_args</code></td>
<td>
<p>(<strong>opcional</strong>) Lista con argumentos adicionales
para el <code>pins::pin_download</code> de datos abiertos</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_descarga_db_diccionario_ssa_args">descarga_db_diccionario_ssa_args</code></td>
<td>
<p>(<strong>opcional</strong>) Lista con argumentos adicionales para el
<code>pins::pin_download</code> de datos abiertos</p>
</td></tr>
<tr><td><code id="descarga_datos_abiertos_+3A_...">...</code></td>
<td>
<p>(<strong>opcional</strong>) Parametros adicionales para <code>DBI::dbConnect</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>La funcion de descarga principal es <code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> llama las siguientes funciones
en orden:
</p>

<ul>
<li> <p><code><a href="#topic+descarga_diccionario">descarga_diccionario()</a></code> Se encarga de descargar y formatear el diccionario de datos
</p>
</li>
<li> <p><code><a href="#topic+descarga_db">descarga_db()</a></code> Se encarga de descargar y formatear la base de datos
</p>
</li>
<li> <p><code><a href="#topic+pega_db_datos_abiertos_tbl_y_diccionario">pega_db_datos_abiertos_tbl_y_diccionario()</a></code> Pega ambos en el formato lista de <code>covidmx</code>
</p>
</li></ul>

<p>A su vez <code><a href="#topic+descarga_diccionario">descarga_diccionario()</a></code> ejecuta las siguientes para obtener el diccionario de datos:
</p>

<ul>
<li> <p><code><a href="#topic+descarga_db_diccionario_ssa">descarga_db_diccionario_ssa()</a></code> Descarga el diccionario de la DGE
</p>
</li>
<li> <p><code><a href="#topic+unzip_db_diccionario_ssa">unzip_db_diccionario_ssa()</a></code> Libera el archivo <code>zip</code> descargado
</p>
</li>
<li> <p><code><a href="#topic+parse_db_diccionario_ssa">parse_db_diccionario_ssa()</a></code> Genera una lista de tiblles con el diccionario por variable
</p>
</li></ul>

<p>Por otro lado,<code><a href="#topic+descarga_db">descarga_db()</a></code> ejecuta las siguientes para obtener los datos abiertos:
</p>

<ul>
<li> <p><code><a href="#topic+descarga_db_datos_abiertos_tbl">descarga_db_datos_abiertos_tbl()</a></code> Descarga las bases de datos de covid de la DGE
</p>
</li>
<li> <p><code><a href="#topic+unzip_db_datos_abiertos_tbl">unzip_db_datos_abiertos_tbl()</a></code> Libera el archivo <code>zip</code> descargado
</p>
</li>
<li> <p><code><a href="#topic+parse_db_datos_abiertos_tbl">parse_db_datos_abiertos_tbl()</a></code> Genera una base de datos en <code>duckdb</code> (o <code>tibble</code>) c
on la informacion
</p>
</li></ul>

<p>Si en algun momento se interrumpio la descarga o hubo problemas de conexion o detuviste
el proceso de generacion de la base de datos abiertos puedes llamar a las funciones
de <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code>.
</p>


<h3>Value</h3>

<p>Lista de valores:
</p>

<ul>
<li><p> dats        - Tabla conectada mediante <code>duckdb::dbConnect__duckdb_driver()</code>
(si <code>duckdb</code>) o tibble (si <code>tibble</code>)
</p>
</li>
<li><p> disconnect  - Funcion para cerrar la conexion a la base de datos.
</p>
</li>
<li><p> dict        - Lista de <code>tibble</code>s con el diccionario de datos para cada variable
</p>
</li></ul>



<h3>Memoria <code>RAM</code></h3>

<p>Si tienes RAM que te sobre puedes no crear una base de datos en <code>duckdb</code> sino leer directo
el archivo <code>csv</code>. Esto se logra con <code>read_format = tibble</code>. No lo recomiendo pues puedes
terminar con tu sesion de <code>R</code> si se te acaba la memoria.
</p>
<p><em>Windows</em> Para abrir el archivo <code>.zip</code> quiza requieras tambien descargar e instalar
<a href="https://www.7-zip.org/"><code style="white-space: pre;">&#8288;7Zip&#8288;</code></a> por default el sistema lo busca en
<code style="white-space: pre;">&#8288;C:\\Program Files\\7-Zip\\7z.exe&#8288;</code> pero si no esta ese directorio es necesario que
en <code>unzip_command</code> especifiques el camino donde se instalo <code style="white-space: pre;">&#8288;7z.exe&#8288;</code>.
</p>


<h3>Uso de <code>pins</code></h3>

<p>Para almacenar los datos se utiliza un pequenio cambio sobre la libreria <code>pins</code>. Los datos
se descargan y se almacenan en cache junto con informacion sobre cuando fue la descarga. Si
no ha pasado un dia desde la ultima descarga no se descarga nada nuevo. Si los datos que
se tienen no han cambiado respecto a lo que esta en linea tampoco se vuelven a descargar aunque
haya pasado mas de un dia.
</p>
<p><strong>Si se te fue el Internet</strong> No te preocupes, <code>pins</code> lee tu descarga mas reciente.
</p>
<p>Para ver donde estan descargados tus datos usa <code>pins::board_cache_path()</code>. Para borrarlos usa
<code>pins::cache_prune()</code>.
</p>


<h3>Metodos de <code>unzip</code></h3>

<p>Por default el programa intenta abrir la base de datos con <code>utils::unzip()</code>. Sin embargo
historicamente la base de datos ha estado codificada de tal forma que <code>utils::unzip()</code> no
pueda abrirla. Para ello se utilizaban diferentes comandos en particular el default que
hemos visto funcionaba son los comandos de terminal <code>unzip</code> (en Linux/OSX) y <code style="white-space: pre;">&#8288;7zip&#8288;</code> (en Windows).
En caso de ser requeridos el sistema te lo hara saber junto con las instrucciones de instalacion
</p>


<h3>Note</h3>

<p>No te recomiendo borrar el cache con <code>clear_zip</code> o editarlo por cualquier otro medio si
estas usando <code>pins</code> pues puede romperse la dependencia. Si accidentalmente lo borraste
usa <code>pins::board_cache_path()</code> para ir al <code>path</code> y borrar manualmente toda la carpeta.
</p>


<h3>References</h3>

<p>Secretaría de Salud (2022). Datos Abiertos de COVID-19
URL: <a href="https://www.gob.mx/salud/documentos/datos-abiertos-152127">https://www.gob.mx/salud/documentos/datos-abiertos-152127</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code>  <code><a href="#topic+descarga_datos_red_irag">descarga_datos_red_irag()</a></code>
<code><a href="#topic+descarga_datos_variantes_GISAID">descarga_datos_variantes_GISAID()</a></code> <code><a href="#topic+casos">casos()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Descarga de la base de datos junto con diccionario en duckdb y la guarda en
# un archivo temporal.
# Puede cambiarse el dlink por el adecuado o dejarse en blanco
# quita la opción de sites.covid t site.covid.dic para descargar los de la DGE. 
# Esto es solo un ejemplo.
file_duck &lt;- tempfile(fileext = ".duckdb")

#Estos links deben omitirse en una corrida normal. Se incluyen por ahora como ejemplo
#pero las opciones site.covid.dic y sites.covid deben eliminarse de abajo.
dlink     &lt;- "https://github.com/RodrigoZepeda/covidmx/raw/main/datos_abiertos_covid19.zip"
diclink   &lt;- "https://github.com/RodrigoZepeda/covidmx/raw/main/diccionario_datos_covid19.zip"

#En el ejemplo de R por normas de CRAN tenemos que hacerlo así pero en tu
#computadora puedes solo usar descargar datos sin el if else
if (RCurl::url.exists(dlink) &amp; RCurl::url.exists(diclink)){
  datos_covid &lt;- descarga_datos_abiertos(
    dbdir = file_duck,
    sites.covid = dlink, 
    site.covid.dic = diclink,
    show_warnings = FALSE
  )
  # Luego haces algo con esos datos...

  # Cuando terminas cierras la sesion:
  datos_covid$disconnect()

  # Despues podras leerlos con read_datos_abiertos cuando quieras:
  datos_covid &lt;- read_datos_abiertos(dbdir = file_duck, site.covid.dic = diclink)
  datos_covid$disconnect()

  # Si no pones `dbdir` nota que los datos se guardan en un archivo temporal que se elimina
  # al cerrar tu sesion
  datos_covid &lt;- descarga_datos_abiertos(sites.covid = dlink, show_warnings = FALSE,
                      site.covid.dic = diclink)

} else {
  datos_covid &lt;- datosabiertos
}

# Desconectamos
datos_covid$disconnect()

</code></pre>

<hr>
<h2 id='descarga_datos_red_irag'>Descarga la base de datos de ocupacion hospitalaria de la red IRAG</h2><span id='topic+descarga_datos_red_irag'></span>

<h3>Description</h3>

<p><code>descarga_datos_red_irag</code> Lee los datos de ocupacion hospitalaria de la <code style="white-space: pre;">&#8288;RED IRAG&#8288;</code>
disponibles en <a href="https://www.gits.igg.unam.mx/red-irag-dashboard/reviewHome#">https://www.gits.igg.unam.mx/red-irag-dashboard/reviewHome#</a>
y analizados a traves de <a href="https://github.com/RodrigoZepeda/CapacidadHospitalariaMX">RodrigoZepeda/CapacidadHospitalariaMX</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>descarga_datos_red_irag(
  nivel = c("Estatal", "Unidad Médica"),
  cache = NULL,
  use_cache_on_failure = TRUE,
  quiet = TRUE,
  force_download = FALSE,
  show_warnings = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="descarga_datos_red_irag_+3A_nivel">nivel</code></td>
<td>
<p>(<strong>opcional</strong>) Regresa la ocupacion <code>"Estatal"</code>(default) o por <code>"Unidad Medica"</code></p>
</td></tr>
<tr><td><code id="descarga_datos_red_irag_+3A_cache">cache</code></td>
<td>
<p>(<strong>opcional</strong>) cache para <code><a href="pins.html#topic+board_url">pins::board_url()</a></code>. Representa el directorio donde
se almacenaran los datos descargados en formato de <code>pins</code>.</p>
</td></tr>
<tr><td><code id="descarga_datos_red_irag_+3A_use_cache_on_failure">use_cache_on_failure</code></td>
<td>
<p>(<strong>opcional</strong>)  parametro para <code><a href="pins.html#topic+board_url">pins::board_url()</a></code>. En caso de
<code>TRUE</code> (default) si no puede descargar nueva informacion utiliza la que ya tiene en memoria
aunque sea vieja.</p>
</td></tr>
<tr><td><code id="descarga_datos_red_irag_+3A_quiet">quiet</code></td>
<td>
<p>(<strong>opcional</strong>) booleana para no imprimir mensajes en la consola.</p>
</td></tr>
<tr><td><code id="descarga_datos_red_irag_+3A_force_download">force_download</code></td>
<td>
<p>(<strong>opcional</strong>)  analiza si cambio el pin y descarga datos nuevos en
caso afirmativo.</p>
</td></tr>
<tr><td><code id="descarga_datos_red_irag_+3A_show_warnings">show_warnings</code></td>
<td>
<p>(<strong>opcional</strong>) si arrojar <code>warnings</code> o callar</p>
</td></tr>
<tr><td><code id="descarga_datos_red_irag_+3A_...">...</code></td>
<td>
<p>parametros adicionales para <code><a href="pins.html#topic+pin_download">pins::pin_download()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Los datos de Red IRAG son descargados diariamente de manera automatica en Github:
<a href="https://github.com/RodrigoZepeda/CapacidadHospitalariaMX">RodrigoZepeda/CapacidadHospitalariaMX</a>
y esta funcion los lee de ahi. Puede que esten un poco rezagados respecto a la pagina de la
<code style="white-space: pre;">&#8288;RED IRAG&#8288;</code> (<a href="https://www.gits.igg.unam.mx/red-irag-dashboard/reviewHome#">https://www.gits.igg.unam.mx/red-irag-dashboard/reviewHome#</a>)
pero el rezago nunca es mayor a un dia.
</p>


<h3>Value</h3>

<p><code>tibble</code> con los datos de ocupacion hospitalaria
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;Unidad médica&#8288;</code> - En caso <code>nivel = "Unidad Medica"</code> la unidad a la que pertenecen los datos
</p>
</li>
<li> <p><code>Institución</code>   - Institucion a la que pertenece la unidad medica
</p>
</li>
<li> <p><code>Estado</code>        - Entidad federativa de la informacion o de la unidad
</p>
</li>
<li> <p><code>CLUES</code>         - La Clave Unica de Establecimientos de Salud para la unidad (si <code>nivel = "Unidad Medica"</code>)
</p>
</li>
<li> <p><code>Fecha</code>         - La fecha a la cual corresponde dicha ocupacion
</p>
</li>
<li> <p><code>Actualizacion</code> - La fecha de actualizacion ultima de los datos.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;Hospitalizados (%)&#8288;</code>    - Porcentaje de ocupacion en camas de hospitalizacion.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;Ventilación (%)&#8288;</code>       - Porcentaje de ocupacion en ventiladores.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;UCI y Ventilación (%)&#8288;</code> - Porcentaje de ocupacion en unidades de cuidado intensivo con ventilacion.
</p>
</li></ul>



<h3>References</h3>

<p>Secretaría de Salud (2022). Sistema de Información de la Red IRAG
URL: <a href="https://www.gits.igg.unam.mx/red-irag-dashboard/reviewHome">https://www.gits.igg.unam.mx/red-irag-dashboard/reviewHome</a>
</p>
<p>Zepeda-Tello, R. (2022). Descarga Automática de Datos de la Red IRAG
URL: <a href="https://github.com/RodrigoZepeda/CapacidadHospitalariaMX">https://github.com/RodrigoZepeda/CapacidadHospitalariaMX</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+descarga_datos_variantes_GISAID">descarga_datos_variantes_GISAID()</a></code> <code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Descarga de datos estatales
url_global &lt;- paste0(
  "https://media.githubusercontent.com/media/RodrigoZepeda/",
  "CapacidadHospitalariaMX/master/processed/"
)

if (RCurl::url.exists(paste0(url_global, "HospitalizacionesMX_estatal.csv"))) {
  ocupacion_hospitalaria &lt;- descarga_datos_red_irag("Estatal", show_warnings = FALSE)
}

# También puedes hacer la descarga por unidad medica
# Descarga de datos por unidad medica
if (RCurl::url.exists(paste0(url_global, "HospitalizacionesMX_unidad_medica.csv"))) {
  ocupacion_unidad &lt;- descarga_datos_red_irag("Unidad Medica", show_warnings = FALSE)
}


</code></pre>

<hr>
<h2 id='descarga_datos_variantes_GISAID'>Lee la base de datos de variantes de COVID-19 en Mexico generada por GISAID</h2><span id='topic+descarga_datos_variantes_GISAID'></span>

<h3>Description</h3>

<p><code>descarga_datos_variantes_GISAID</code> Lee los datos de variantes del reporte nacional diario en
<a href="https://github.com/RodrigoZepeda/VariantesCovid">RodrigoZepeda/VariantesCovid</a>
creado a partir de la informacion de la
<a href="https://gisaid.org/">Global Initiative on Sharing Avian Influenza Data (GISAID)</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>descarga_datos_variantes_GISAID(
  nivel = c("nacional", "cdmx"),
  cache = NULL,
  use_cache_on_failure = TRUE,
  quiet = FALSE,
  force_download = FALSE,
  show_warnings = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="descarga_datos_variantes_GISAID_+3A_nivel">nivel</code></td>
<td>
<p>(<strong>opcional</strong>) si se desea descargar informacion <code>"nacional"</code> (default) o de
la Ciudad de Mexico: <code>"cdmx"</code>.</p>
</td></tr>
<tr><td><code id="descarga_datos_variantes_GISAID_+3A_cache">cache</code></td>
<td>
<p>(<strong>opcional</strong>) cache para <code><a href="pins.html#topic+board_url">pins::board_url()</a></code>. Representa el directorio donde
se almacenaran los datos descargados en formato de <code>pins</code>.</p>
</td></tr>
<tr><td><code id="descarga_datos_variantes_GISAID_+3A_use_cache_on_failure">use_cache_on_failure</code></td>
<td>
<p>(<strong>opcional</strong>)  parametro para <code><a href="pins.html#topic+board_url">pins::board_url()</a></code>. En caso de
<code>TRUE</code> (default) si no puede descargar nueva informacion utiliza la que ya tiene en memoria
aunque sea vieja.</p>
</td></tr>
<tr><td><code id="descarga_datos_variantes_GISAID_+3A_quiet">quiet</code></td>
<td>
<p>(<strong>opcional</strong>) booleana para no imprimir mensajes en la consola.</p>
</td></tr>
<tr><td><code id="descarga_datos_variantes_GISAID_+3A_force_download">force_download</code></td>
<td>
<p>(<strong>opcional</strong>)  analiza si cambio el pin y descarga datos nuevos en
caso afirmativo.</p>
</td></tr>
<tr><td><code id="descarga_datos_variantes_GISAID_+3A_show_warnings">show_warnings</code></td>
<td>
<p>(<strong>opcional</strong>) si arrojar <code>warnings</code> o callar</p>
</td></tr>
<tr><td><code id="descarga_datos_variantes_GISAID_+3A_...">...</code></td>
<td>
<p>parametros adicionales para <code><a href="pins.html#topic+pin_download">pins::pin_download()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cada vez que uses estos datos necesitas citar a <strong>GISAID</strong> (ver referencias) asi como
el reporte en <a href="https://github.com/RodrigoZepeda/VariantesCovid">RodrigoZepeda/VariantesCovid</a>
</p>
<p>Los datos son descargados de manera automatica en mi Github:
<a href="https://github.com/RodrigoZepeda/VariantesCovid">RodrigoZepeda/VariantesCovid</a> el programa
<code>descarga_datos_variantes_GISAID</code> se conecta a dicho repositorio, busca si la informacion esta
actualizada y si si la descarga, si no, utiliza informacion almacenada en el <code>cache</code> local.
</p>
<p>La descarga usa el paquete <code>pins</code>
</p>


<h3>Value</h3>

<p><code>tibble</code> con los datos de porcentuales de variantes
</p>

<ul>
<li> <p><code>variant</code>       - La variante clasificada mediante <a href="https://cov-lineages.org/resources/pangolin.html">Pangolin</a>
</p>
</li>
<li> <p><code>semana</code>        - Semana epidemiologica <code><a href="lubridate.html#topic+week">lubridate::epiweek()</a></code> a la que corresponde la variante
</p>
</li>
<li> <p><code>ano</code>           - Anio al que corresponde la toma de muestra
</p>
</li>
<li> <p><code>n</code>             - El total de muestras de dicha semana registradas para esa variante
</p>
</li>
<li> <p><code>freq</code>          - La proporcion de las variantes de dicha semana ocupada por dicha variante. Se obtiene dividiendo <code>n/sum(n)</code> para cada semana.
</p>
</li>
<li> <p><code>Actualizacion</code> - La fecha de actualizacion ultima de los datos.
</p>
</li>
<li> <p><code>Fuente</code>        - La fuente desde la cual se obtuvo la informacion de dicha variante.
</p>
</li></ul>



<h3>References</h3>

<p>Khare, S., et al (2021) GISAID's Role in Pandemic Response. China CDC Weekly, 3(49):
1049-1051. doi:10.46234/ccdcw2021.255 PMCID: 8668406
</p>
<p>Elbe, S. and Buckland-Merrett, G. (2017) Data, disease and diplomacy: GISAID’s
innovative contribution to global health. Global Challenges, 1:33-46.
doi:10.1002/gch2.1018 PMCID: 31565258
</p>
<p>Shu, Y. and McCauley, J. (2017) GISAID: from vision to reality. EuroSurveillance,
22(13) doi:10.2807/1560-7917.ES.2017.22.13.30494 PMCID: PMC5388101
</p>
<p>Zepeda-Tello, R. (2022). Reporte Nacional de Variantes de COVID-19.
URL: <a href="https://github.com/RodrigoZepeda/VariantesCovid">https://github.com/RodrigoZepeda/VariantesCovid</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+descarga_datos_red_irag">descarga_datos_red_irag()</a></code> <code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Descarga de variantes a nivel nacional
url_global &lt;- "https://raw.githubusercontent.com/RodrigoZepeda/VariantesCovid/main/tablas/"
if (RCurl::url.exists(paste0(url_global, "Proporcion_variantes_nacional.csv"))) {
  variantes_covid &lt;- descarga_datos_variantes_GISAID("nacional")
}

# Descarga de variantes para CDMX
if (RCurl::url.exists(paste0(url_global, "Proporcion_variantes_cdmx.csv"))) {
  variantes_covid &lt;- descarga_datos_variantes_GISAID("cdmx")
}

</code></pre>

<hr>
<h2 id='descarga_db'>Auxiliares para la descarga de datos abiertos</h2><span id='topic+descarga_db'></span><span id='topic+descarga_diccionario'></span><span id='topic+descarga_db_datos_abiertos_tbl'></span><span id='topic+descarga_db_diccionario_ssa'></span><span id='topic+unzip_db_datos_abiertos_tbl'></span><span id='topic+unzip_db_diccionario_ssa'></span><span id='topic+parse_db_diccionario_ssa'></span><span id='topic+parse_db_datos_abiertos_tbl'></span><span id='topic+pega_db_datos_abiertos_tbl_y_diccionario'></span>

<h3>Description</h3>

<p>Conjunto de funciones para apoyar la descarga de datos abiertos de
la Direccion General de Epidemiologia (DGE)
</p>
<p>La funcion de descarga principal es <code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> llama las siguientes funciones
en orden:
</p>

<ul>
<li> <p><code><a href="#topic+descarga_diccionario">descarga_diccionario()</a></code> Se encarga de descargar y formatear el diccionario de datos
</p>
</li>
<li> <p><code><a href="#topic+descarga_db">descarga_db()</a></code> Se encarga de descargar y formatear la base de datos
</p>
</li>
<li> <p><code><a href="#topic+pega_db_datos_abiertos_tbl_y_diccionario">pega_db_datos_abiertos_tbl_y_diccionario()</a></code> Pega ambos en el formato lista de <code>covidmx</code>
</p>
</li></ul>

<p>A su vez <code><a href="#topic+descarga_diccionario">descarga_diccionario()</a></code> ejecuta las siguientes para obtener el diccionario de datos:
</p>

<ul>
<li> <p><code><a href="#topic+descarga_db_diccionario_ssa">descarga_db_diccionario_ssa()</a></code> Descarga el diccionario de la DGE
</p>
</li>
<li> <p><code><a href="#topic+unzip_db_diccionario_ssa">unzip_db_diccionario_ssa()</a></code> Libera el archivo <code>zip</code> descargado
</p>
</li>
<li> <p><code><a href="#topic+parse_db_diccionario_ssa">parse_db_diccionario_ssa()</a></code> Genera una lista de tiblles con el diccionario por variable
</p>
</li></ul>

<p>Por otro lado,<code><a href="#topic+descarga_db">descarga_db()</a></code> ejecuta las siguientes para obtener los datos abiertos:
</p>

<ul>
<li> <p><code><a href="#topic+descarga_db_datos_abiertos_tbl">descarga_db_datos_abiertos_tbl()</a></code> Descarga las bases de datos de covid de la DGE
</p>
</li>
<li> <p><code><a href="#topic+unzip_db_datos_abiertos_tbl">unzip_db_datos_abiertos_tbl()</a></code> Libera el archivo <code>zip</code> descargado
</p>
</li>
<li> <p><code><a href="#topic+parse_db_datos_abiertos_tbl">parse_db_datos_abiertos_tbl()</a></code> Genera una base de datos en <code>duckdb</code> (o <code>tibble</code>) con la informacion
</p>
</li></ul>

<p>Si en algun momento se interrumpio la descarga o hubo problemas de conexion o detuviste
el proceso de generacion de la base de datos abiertos puedes llamar a las funciones
de <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>descarga_db(
  read_format = c("duckdb", "tibble"),
  tblname = "covidmx",
  pragma_memory_limit = Sys.getenv("pragma_memory_limit"),
  drv = duckdb::duckdb(),
  dbdir = tempfile(fileext = ".duckdb"),
  colClasses = get_col_class(),
  sites.covid = get_sites_covid(),
  download_process = c("pins", "download.file"),
  unzip_command = Sys.getenv("unzip_command"),
  unzip_args = Sys.getenv("unzip_args"),
  check_unzip_install = TRUE,
  clear_zip = (download_process[1] != "pins"),
  clear_csv = TRUE,
  force_download = FALSE,
  show_warnings = TRUE,
  datos_abiertos_zip_paths = NULL,
  datos_abiertos_unzipped_path = NULL,
  datos_abiertos_tbl = NULL,
  quiet = FALSE,
  board_url_name = "datos_abiertos",
  cache = NULL,
  use_cache_on_failure = TRUE,
  download_file_args = list(method = "curl", destfile = tempfile(), quiet = quiet),
  descarga_db_datos_abiertos_tbl_args = list(),
  ...
)

descarga_diccionario(
  download_process = c("pins", "download.file"),
  site.covid.dic = get_site_dic(),
  quiet = FALSE,
  clear_zip = download_process[1] != "pins",
  clear_csv = TRUE,
  diccionario_zip_path = NULL,
  diccionario_unzipped_path = NULL,
  diccionario = NULL,
  board_url_name_dict = "diccionario_covid",
  cache_diccionario = NULL,
  use_cache_on_failure = TRUE,
  force_download = FALSE,
  show_warnings = TRUE,
  download_file_args_dict = list(method = "curl", destfile = tempfile(), quiet = quiet),
  unzip_args_dict = list(exdir = ".", overwrite = TRUE),
  descarga_db_diccionario_ssa_args = list()
)

descarga_db_datos_abiertos_tbl(
  download_process = c("pins", "download.file"),
  sites.covid = get_sites_covid(),
  quiet = FALSE,
  board_url_name = "datos_abiertos",
  cache = NULL,
  use_cache_on_failure = TRUE,
  force_download = FALSE,
  show_warnings = TRUE,
  download_file_args = list(method = "curl", destfile = tempfile(), quiet = quiet),
  ...
)

descarga_db_diccionario_ssa(
  download_process = c("pins", "download.file"),
  site.covid.dic = get_site_dic(),
  quiet = FALSE,
  board_url_name_dict = "diccionario_covid",
  cache_diccionario = NULL,
  use_cache_on_failure = TRUE,
  force_download = FALSE,
  show_warnings = TRUE,
  download_file_args_dict = list(method = "curl", destfile = tempfile(), quiet = quiet),
  ...
)

unzip_db_datos_abiertos_tbl(
  datos_abiertos_zip_paths,
  unzip_command = Sys.getenv("unzip_command"),
  unzip_args = Sys.getenv("unzip_args"),
  check_unzip_install = TRUE,
  quiet = FALSE,
  clear_zip = FALSE
)

unzip_db_diccionario_ssa(
  diccionario_zip_path,
  unzip_args_dict = list(exdir = ".", overwrite = TRUE),
  clear_zip = FALSE
)

parse_db_diccionario_ssa(diccionario_unzipped_path, clear_csv = FALSE)

parse_db_datos_abiertos_tbl(
  datos_abiertos_unzipped_path,
  read_format = c("duckdb", "tibble"),
  pragma_memory_limit = Sys.getenv("pragma_memory_limit"),
  dbdir = tempfile(fileext = ".duckdb"),
  drv = duckdb::duckdb(),
  colClasses = get_col_class(),
  tblname = "covidmx",
  quiet = TRUE,
  clear_csv = FALSE,
  ...
)

pega_db_datos_abiertos_tbl_y_diccionario(datos_abiertos_tbl, diccionario)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="descarga_db_+3A_read_format">read_format</code></td>
<td>
<p>(<strong>opcional</strong>) <code>"duckdb"</code> o <code>"tibble"</code> establece el formato
de lectura de la base de datos. En la mayoria de los casos <code>"tibble"</code> va a
resultar en un error de memoria. La opcion de <code>"duckdb"</code> siempre es mas rapida por lo cual
es el default.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_tblname">tblname</code></td>
<td>
<p>(<strong>opcional</strong>)  Nombre de la tabla de <code>duckdb</code> donde guardar los datos por
default se llama <code>covidmx</code>. Solo es relevante si estas usando el mismo <code>dbdir</code> para otro
proyecto distinto.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_pragma_memory_limit">pragma_memory_limit</code></td>
<td>
<p>(<strong>opcional</strong>) Limite de memoria para el programa
(ver <a href="https://duckdb.org/docs/sql/pragmas">PRAGMAS</a>). Cambialo a que sea mas o menos la mitad
de tu RAM. La forma mas sencilla es como una variable ambiental con
<code>Sys.setenv('pragma_memory_limit' = '1GB')</code> por ejemplo para un limite de 1 gigabyte.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_drv">drv</code></td>
<td>
<p>(<strong>opcional</strong>) Un  driver para <code>dbConnect</code> (default <code>duckdb::duckdb()</code>)</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_dbdir">dbdir</code></td>
<td>
<p>(<strong>opcional</strong>) Direccion donde guardar la base de datos con terminacion <code>.duckdb</code>.
Corresponde al argumento de <code><a href="duckdb.html#topic+duckdb">duckdb::dbConnect__duckdb_driver()</a></code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_colclasses">colClasses</code></td>
<td>
<p>(<strong>opcional</strong>) Clases de la columna para leer en <code>duckdb::read_csv_duckdb()</code>.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_sites.covid">sites.covid</code></td>
<td>
<p>(<strong>opcional</strong>)  Sitios web con el vinculo a los archivos <code>.zip</code> de l
os datos abiertos. Puedes cambiarlo por uno de los historicos, por ejemplo. La estructura es
<code>c("nombre" = "url", "nombre2" = "url2")</code>. La ultima verificacion del sitio web default fue
el 6 de septiembre del 2022.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_download_process">download_process</code></td>
<td>
<p>(<strong>opcional</strong>)  Metodo para descargar ya sea <code>pins</code> o <code>download.file</code>.
Se recomienda <code>pins</code> pues guarda en memoria la fecha de la ultima descarga y analiza
si ha pasado mas de un dia desde la descarga. En caso afirmativo verifica si el
archivo ha cambiado y si hubo cambios entonces lo descarga.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_unzip_command">unzip_command</code></td>
<td>
<p>(<strong>opcional</strong>) Forma de extraer la base de datos de datos abiertos
si <code>unzip</code> falla.
La forma de llamarla es con <code>system2(unzip_command, args = c(unzip_args, file_download_data))</code>.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_unzip_args">unzip_args</code></td>
<td>
<p>(<strong>opcional</strong>) Argumentos de extraccion de la base de datos de datos abiertos
si <code>unzip</code> falla.
La forma de llamarla es con <code>system2(unzip_command, args = c(unzip_args, file_download_data))</code>.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_check_unzip_install">check_unzip_install</code></td>
<td>
<p>(<strong>opcional</strong>) Bandera de verificacion para checar si tienes
lo necesario para unzippear los datos en el caso de que <code>unzip</code> no sirva.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_clear_zip">clear_zip</code></td>
<td>
<p>(<strong>opcional</strong>) Si borrar los archivos <code>.zip</code> descargados para el diccionario
y los datos abiertos. No se recomienda si estas usando <code>pins</code>. Ve la nota para mas informacion.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_clear_csv">clear_csv</code></td>
<td>
<p>(<strong>opcional</strong>) Si borrar los archivos <code>.csv</code> que se generan despues de abrir
el zip. El default es que si pues en general solo requieres el <code>duckdb</code>.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_force_download">force_download</code></td>
<td>
<p>(<strong>opcional</strong>) Analiza si cambio el pin y descarga datos nuevos en caso
afirmativo aunque haya pasado menos de un dia.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_show_warnings">show_warnings</code></td>
<td>
<p>(<strong>opcional</strong>) si arrojar <code>warnings</code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_datos_abiertos_zip_paths">datos_abiertos_zip_paths</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino a los datos abiertos si ya los
descargaste en <code>zip</code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_datos_abiertos_unzipped_path">datos_abiertos_unzipped_path</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino a los datos abiertos <code>csv</code> si ya
los descargaste y descomprimiste el archivo <code>zip</code> en un <code>csv</code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_datos_abiertos_tbl">datos_abiertos_tbl</code></td>
<td>
<p>(<strong>opcional</strong>) Camino a un archivo <code>.duckdb</code> con los datos formateados</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_quiet">quiet</code></td>
<td>
<p>(<strong>opcional</strong>) Variable para no mostrar mensajes</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_board_url_name">board_url_name</code></td>
<td>
<p>(<strong>opcional</strong>) Establece el nombre del <code>pins::board_url</code> para
los datos abiertos (si ya usas pins para que no se empalme).
Por default se llama <code>datos_abiertos</code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_cache">cache</code></td>
<td>
<p>parametro para el cache de <code>pins::board_url</code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_use_cache_on_failure">use_cache_on_failure</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana. Establece que si no se pueden descargar
datos nuevos utilice los que tenga en memoria. Por default es <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_download_file_args">download_file_args</code></td>
<td>
<p>(<strong>opcional</strong>) Lista de argumentos adicionales para <code>download.file</code>
de los datos si se elige este metodo para descargar.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_descarga_db_datos_abiertos_tbl_args">descarga_db_datos_abiertos_tbl_args</code></td>
<td>
<p>(<strong>opcional</strong>) Lista con argumentos adicionales
para el <code>pins::pin_download</code> de datos abiertos</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_...">...</code></td>
<td>
<p>Parametros adicionales para <code>pins::pin_download</code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_site.covid.dic">site.covid.dic</code></td>
<td>
<p>(<strong>opcional</strong>)  Sitio desde el cual descarga del diccionario de datos.
La ultima verificacion del sitio fue el 6 de septiembre 2022.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_diccionario_zip_path">diccionario_zip_path</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino al diccionario si ya losdescargaste en <code>zip</code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_diccionario_unzipped_path">diccionario_unzipped_path</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino al diccionario <code>csv</code> si ya
lo descargaste y descomprimiste el archivo <code>zip</code> en un <code>csv</code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_diccionario">diccionario</code></td>
<td>
<p>(<strong>opcional</strong>)  Lo que resulta de realizar una descarga del diccionario
usando <code>descarga_diccionario</code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_board_url_name_dict">board_url_name_dict</code></td>
<td>
<p>(<strong>opcional</strong>) Establece el nombre del <code>pins::board_url</code> para los
datos abiertos. Por default se llama <code>diccionario_covid</code></p>
</td></tr>
<tr><td><code id="descarga_db_+3A_cache_diccionario">cache_diccionario</code></td>
<td>
<p>(<strong>opcional</strong>) Direccion donde guardar el diccionario en memoria
usando <code>pins</code> para no tener que volver a descargarlo si nada ha cambiado</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_download_file_args_dict">download_file_args_dict</code></td>
<td>
<p>(<strong>opcional</strong>) Lista de argumentos adicionales
para <code>download.file</code> del diccionario si se elige este metodo de descarga.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_unzip_args_dict">unzip_args_dict</code></td>
<td>
<p>(<strong>opcional</strong>) Lista de argumentos para usar <code>utils::unzip</code> en el
diccionario de datos.</p>
</td></tr>
<tr><td><code id="descarga_db_+3A_descarga_db_diccionario_ssa_args">descarga_db_diccionario_ssa_args</code></td>
<td>
<p>(<strong>opcional</strong>) Lista con argumentos adicionales para el
<code>pins::pin_download</code> de datos abiertos</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Lista de valores:
</p>

<ul>
<li><p> dats        - Tabla conectada mediante <code>duckdb::dbConnect__duckdb_driver()</code> (si <code>duckdb</code>) o
tibble (si <code>tibble</code>)
</p>
</li>
<li><p> disconnect  - Funcion para cerrar la conexion a la base de datos.
</p>
</li>
<li><p> dict        - Lista de <code>tibble</code>s con el diccionario de datos para cada variable
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code>  <code><a href="#topic+descarga_datos_red_irag">descarga_datos_red_irag()</a></code>
<code><a href="#topic+descarga_datos_variantes_GISAID">descarga_datos_variantes_GISAID()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Estos links deben omitirse en una corrida normal. Se incluyen por ahora como ejemplo
#pero las opciones site.covid.dic y sites.covid deben eliminarse de abajo.
diclink   &lt;- "https://github.com/RodrigoZepeda/covidmx/raw/main/diccionario_datos_covid19.zip"
dlink     &lt;- "https://github.com/RodrigoZepeda/covidmx/raw/main/datos_abiertos_covid19.zip"

#' #En el ejemplo de R por normas de CRAN tenemos que hacerlo así pero en tu
#computadora puedes solo usar descargar datos sin el if else
if (RCurl::url.exists(dlink) &amp; RCurl::url.exists(diclink)){
  
  # Descarga solo el diccionario no oficial (omite el site.covid.dic para el de DGE)
  diccionario &lt;- descarga_diccionario(show_warnings = FALSE, site.covid.dic = diclink)

  # O bien descarga solo los datos abiertos de ejemplo desde Github
  # omite el dlink (o cámbialo por el vínculo correcto) para descargar los datos de la DGE
  datos_abiertos &lt;- descarga_db(sites.covid = dlink, show_warnings = FALSE)

  # Pegalos en el formato que se necesita para el resto de funciones
  datos_covid &lt;- pega_db_datos_abiertos_tbl_y_diccionario(datos_abiertos, diccionario)

  # Desconectamos
  datos_covid$disconnect()

  # Tambien puedes descargar paso por paso
  datos_abiertos &lt;- descarga_db_datos_abiertos_tbl(
    sites.covid = dlink,
    show_warnings = FALSE
  ) |&gt; # Descarga
  unzip_db_datos_abiertos_tbl() |&gt; # Unzippea
  parse_db_datos_abiertos_tbl() # Duckdb

  # O bien el diccionario
  diccionario &lt;- descarga_db_diccionario_ssa(site.covid.dic = diclink) |&gt; # Descarga
  unzip_db_diccionario_ssa() |&gt; # Unzippea
  parse_db_diccionario_ssa() # Tibble

  # Si descargaste cada uno por separado necesitas la funcion pega para
  # juntarlos en un unico objeto
  datos_covid &lt;- pega_db_datos_abiertos_tbl_y_diccionario(datos_abiertos, diccionario)
}

</code></pre>

<hr>
<h2 id='estima_rt'>RT: Número efectivo de reproducción</h2><span id='topic+estima_rt'></span>

<h3>Description</h3>

<p><code>estima_rt</code> Calcula el número efectivo de reproducción por fecha y entidad usando
los metodos de <code><a href="EpiEstim.html#topic+estimate_R">EpiEstim::estimate_R()</a></code>. Por default calcula el número efectivo de
reproducción para cada estado.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estima_rt(
  datos_covid,
  entidades = c("AGUASCALIENTES", "BAJA CALIFORNIA", "BAJA CALIFORNIA SUR", "CAMPECHE",
    "CHIAPAS", "CHIHUAHUA", "CIUDAD DE MÉXICO", "COAHUILA DE ZARAGOZA", "COLIMA",
    "DURANGO", "GUANAJUATO", "GUERRERO", "HIDALGO", "JALISCO", "MÉXICO",
    "MICHOACÁN DE OCAMPO", "MORELOS", "NAYARIT", "NUEVO LEÓN", "OAXACA", "PUEBLA",
    "QUERÉTARO", "QUINTANA ROO", "SAN LUIS POTOSÍ", "SINALOA", "SONORA", "TABASCO",
    "TAMAULIPAS", "TLAXCALA", "VERACRUZ DE IGNACIO DE LA LLAVE", "YUCATÁN", "ZACATECAS"),
  group_by_entidad = TRUE,
  entidad_tipo = c("Unidad Medica", "Residencia", "Nacimiento"),
  fecha_tipo = c("Sintomas", "Ingreso", "Defuncion"),
  tipo_clasificacion = c("Sospechosos", "Confirmados COVID", "Negativo a COVID",
    "Inválido", "No realizado"),
  tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO", "NO ESPECIFICADO"),
  list_name = "estima_rt",
  min_date = as.POSIXct("2020-01-01", tz = Sys.timezone(), format = "%Y-%m-%d"),
  max_date = as.POSIXct(Sys.time()),
  method = "parametric_si",
  config = if (requireNamespace("EpiEstim", quietly = TRUE)) {
    
    EpiEstim::make_config(list(mean_si = 2.5, std_si = 1.6))
 } else {
     NULL
 },
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estima_rt_+3A_datos_covid">datos_covid</code></td>
<td>
<p>(<strong>obligatorio</strong>) Lista de <code>tibble</code>s o <code>duckdb</code>s resultante de
<code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> o <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code></p>
</td></tr>
<tr><td><code id="estima_rt_+3A_entidades">entidades</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con las entidades de las unidades medicas a analizar.
Opciones: <code>AGUASCALIENTES</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA&#8288;</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA SUR&#8288;</code>,
<code>CAMPECHE</code>, <code>CHIAPAS</code>, <code>CHIHUAHUA</code>, <code style="white-space: pre;">&#8288;CIUDAD DE MEXICO&#8288;</code>,
<code style="white-space: pre;">&#8288;COAHUILA DE ZARAGOZA&#8288;</code> , <code>COLIMA</code>, <code>DURANGO</code>, <code>GUANAJUATO</code>, <code>GUERRERO</code>,
<code>HIDALGO</code>, <code>JALISCO</code>, <code>MEXICO</code>, <code style="white-space: pre;">&#8288;MICHOACAN DE OCAMPO&#8288;</code>, <code>MORELOS</code>,<code>NAYARIT</code>
<code style="white-space: pre;">&#8288;NUEVO LEON&#8288;</code>, <code>OAXACA</code> ,<code>PUEBLA</code>, <code>QUERETARO</code>,<code style="white-space: pre;">&#8288;QUINTANA ROO&#8288;</code>,
<code style="white-space: pre;">&#8288;SAN LUIS POTOSI&#8288;</code>, <code>SINALOA</code>, <code>SONORA</code>, <code>TABASCO</code>, <code>TAMAULIPAS</code>,<code>TLAXCALA</code>,
<code style="white-space: pre;">&#8288;VERACRUZ DE IGNACIO DE LA LLAVE&#8288;</code>, <code>YUCATAN</code>, <code>ZACATECAS</code>.</p>
</td></tr>
<tr><td><code id="estima_rt_+3A_group_by_entidad">group_by_entidad</code></td>
<td>
<p>(<strong>opcional</strong>) <code>TRUE</code> obtiene los casos para cada entidad reportando
en cada fecha la entidad y los casos en dicha entidad. <code>FALSE</code>  junta las <code>entidades</code> sumando
sus casos en una sola observacion por cada fecha.</p>
</td></tr>
<tr><td><code id="estima_rt_+3A_entidad_tipo">entidad_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Indica a que se refiere las <code>entidades</code> seleccionadas. Elige
una de las opciones: <code style="white-space: pre;">&#8288;Unidad Medica&#8288;</code> (entidad de la unidad medica), <code>Nacimiento</code>
(entidad de origen del individuo) o <code>Residencia</code> (entidad donde reside el individuo).</p>
</td></tr>
<tr><td><code id="estima_rt_+3A_fecha_tipo">fecha_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Selecciona si la fecha que se utiliza es la fecha de <code>Ingreso</code>
(si aplica), la fecha de <code>Sintomas</code> o la de <code>Defuncion</code> (si aplica). El default es fecha de <code>Sintomas</code>.</p>
</td></tr>
<tr><td><code id="estima_rt_+3A_tipo_clasificacion">tipo_clasificacion</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con el tipo de clasificaciones (por la prueba)
a incluir:<code>Sospechosos</code>,<code style="white-space: pre;">&#8288;Confirmados COVID&#8288;</code>, <code style="white-space: pre;">&#8288;Negativo a COVID&#8288;</code>, <code style="white-space: pre;">&#8288;Inv\u00e1lido&#8288;</code>, <code style="white-space: pre;">&#8288;No realizado&#8288;</code></p>
</td></tr>
<tr><td><code id="estima_rt_+3A_tipo_paciente">tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con el tipo de pacientes a incluir. Opciones:
<code>AMBULATORIO</code>, <code>HOSPITALIZADO</code>, <code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>. Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="estima_rt_+3A_list_name">list_name</code></td>
<td>
<p>(<strong>opcional</strong>) Asigna un nombre en la lista de datos a la base generada</p>
</td></tr>
<tr><td><code id="estima_rt_+3A_min_date">min_date</code></td>
<td>
<p>(<strong>opcional</strong>) Mínima fecha a partir de la cual estimar el RT.</p>
</td></tr>
<tr><td><code id="estima_rt_+3A_max_date">max_date</code></td>
<td>
<p>(<strong>opcional</strong>) Máxima fecha a partir de la cual estimar el RT.</p>
</td></tr>
<tr><td><code id="estima_rt_+3A_method">method</code></td>
<td>
<p>(<strong>opcional</strong>) Metodo para estimar el RT con <code><a href="EpiEstim.html#topic+estimate_R">EpiEstim::estimate_R()</a></code>. Por
default se recomienda el método paramétrico de intervalo serial <code>parametric_si</code>.</p>
</td></tr>
<tr><td><code id="estima_rt_+3A_config">config</code></td>
<td>
<p>(<strong>opcional</strong>) Configuracion para la estimacion del RT usando
<code><a href="EpiEstim.html#topic+make_config">EpiEstim::make_config()</a></code>. Por default se utiliza una media del intervalo serial
de <code>mean_si = 2.5</code> y una desviación estandar de <code>std_si = 1.6</code>. Sin embargo, como el intervalo
serial depende mucho de la variante se recomienda cambiarlo.</p>
</td></tr>
<tr><td><code id="estima_rt_+3A_...">...</code></td>
<td>
<p>(<strong>opcional</strong>) Parámetros adicionales para <code><a href="EpiEstim.html#topic+estimate_R">EpiEstim::estimate_R()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Se sugiere establecer una mínima fecha y una máxima fecha con <code>min_date</code> y
<code>max_date</code> para la estimación pues los intervalos seriales de omicron son distintos
a los de la variante delta.
</p>


<h3>Value</h3>

<p>Une a la lista de <code>datos_covid</code> una nueva entrada de nombre <code>list_name</code>
(default: <code>estima_rt</code>) con una base de datos (<code>tibble</code>) con los
resultados agregados.
</p>

<ul>
<li> <p><code>estima_rt</code> - Base de datos generara con los datos agregados (el nombre cambia si
se usa <code>list_name</code>).
</p>
</li>
<li><p> dict - Diccionario de datos
</p>
</li>
<li><p> dats - Datos originales (conexion a <code>duckdb</code> o <code>tibble</code>)
</p>
</li>
<li><p> disconnect  - Función para desconectarte de <code>duckdb</code>
</p>
</li>
<li><p> ... - Cualquier otro elemento que ya existiera en <code>datos_covid</code>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> <code><a href="#topic+numero_pruebas">numero_pruebas()</a></code> <code><a href="#topic+cfr">cfr()</a></code> <code><a href="#topic+chr">chr()</a></code>
<code><a href="#topic+positividad">positividad()</a></code> <code><a href="#topic+casos">casos()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Para el ejemplo usaremos los datos precargados (datosabiertos) pero tu puedes
# correr el ejemplo descargando informacion mas reciente.
datos_covid &lt;- datosabiertos

# Casos a nivel nacional por estado en todos

suppressWarnings(
  datos_covid &lt;- datos_covid |&gt; estima_rt()
)
head(datos_covid$estima_rt)

# Cambios en la fecha de estimacion siguiendo la recomendacion
# y obtenemos todo a nivel nacional
datos_covid &lt;- datos_covid |&gt; estima_rt(
  min_date = as.POSIXct("2021-07-01"),
  max_date = as.POSIXct("2021-09-01"),
  list_name = "rt_min_max",
  group_by_entidad = FALSE
)
head(datos_covid$rt_min_max)

# Casos a nivel nacional en los confirmados
datos_covid &lt;- datos_covid |&gt;
  estima_rt(
    tipo_clasificacion = "Confirmados COVID",
    group_by_entidad = FALSE,
    list_name = "rt_confirmados"
  )
head(datos_covid$rt_confirmados)

#' # Cambios en los parametros de epiestim
# estos parametros no tienen razon de ser mas alla de mostrar como se cambian
datos_covid &lt;- datos_covid |&gt;
  estima_rt(
    group_by_entidad = FALSE,
    list_name = "config_rt",
    method = "uncertain_si", # Metodo de estimacion
    config = EpiEstim::make_config(
      mean_si = 2.4,
      std_si = 0.3,
      std_mean_si = 0.2,
      min_mean_si = 2,
      max_mean_si = 4,
      std_std_si = 0.1,
      min_std_si = 0.1,
      max_std_si = 1.0
    )
  )
head(datos_covid$config_rt)

# Casos en BC, BCS en los confirmados
datos_covid |&gt;
  estima_rt(
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    tipo_clasificacion = "Confirmados COVID",
    group_by_entidad = TRUE,
    list_name = "rt_bc_bcs"
  ) |&gt;
  plot_covid(
    df_name = "rt_bc_bcs", df_date_index = "FECHA_SINTOMAS",
    df_variable = "Mean(R)", df_covariates = "ENTIDAD_FEDERATIVA"
  )


# Finalmente desconectamos
datos_covid$disconnect()

</code></pre>

<hr>
<h2 id='numero_pruebas'>Numero de Pruebas</h2><span id='topic+numero_pruebas'></span>

<h3>Description</h3>

<p><code>numero_pruebas</code> Calcula el numero total de pruebas por fecha agrupando (o sin hacerlo)
por covariables. Por default calcula la el numero de pruebas de antigeno y PCR por separado
para cada estado.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numero_pruebas(
  datos_covid,
  entidades = c("AGUASCALIENTES", "BAJA CALIFORNIA", "BAJA CALIFORNIA SUR", "CAMPECHE",
    "CHIAPAS", "CHIHUAHUA", "CIUDAD DE MÉXICO", "COAHUILA DE ZARAGOZA", "COLIMA",
    "DURANGO", "GUANAJUATO", "GUERRERO", "HIDALGO", "JALISCO", "MÉXICO",
    "MICHOACÁN DE OCAMPO", "MORELOS", "NAYARIT", "NUEVO LEÓN", "OAXACA", "PUEBLA",
    "QUERÉTARO", "QUINTANA ROO", "SAN LUIS POTOSÍ", "SINALOA", "SONORA", "TABASCO",
    "TAMAULIPAS", "TLAXCALA", "VERACRUZ DE IGNACIO DE LA LLAVE", "YUCATÁN", "ZACATECAS"),
  group_by_entidad = TRUE,
  entidad_tipo = c("Unidad Medica", "Residencia", "Nacimiento"),
  fecha_tipo = c("Sintomas", "Ingreso", "Defuncion"),
  tipo_prueba = c("Antigeno", "PCR"),
  group_by_tipo_prueba = TRUE,
  tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO", "NO ESPECIFICADO"),
  group_by_tipo_paciente = FALSE,
  tipo_uci = c("SI", "NO", "NO APLICA", "SE IGNORA", "NO ESPECIFICADO"),
  group_by_tipo_uci = FALSE,
  tipo_sector = c("CRUZ ROJA", "DIF", "ESTATAL", "IMSS", "IMSS-BIENESTAR", "ISSSTE",
    "MUNICIPAL", "PEMEX", "PRIVADA", "SEDENA", "SEMAR", "SSA", "UNIVERSITARIO",
    "NO ESPECIFICADO"),
  group_by_tipo_sector = FALSE,
  defunciones = FALSE,
  edad_cut = NULL,
  as_tibble = TRUE,
  fill_zeros = as_tibble,
  list_name = "numero_pruebas",
  .grouping_vars = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="numero_pruebas_+3A_datos_covid">datos_covid</code></td>
<td>
<p>(<strong>obligatorio</strong>) Lista de <code>tibble</code>s o <code>duckdb</code>s resultante de
<code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> o <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code></p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_entidades">entidades</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con las entidades de las unidades medicas a analizar.
Opciones: <code>AGUASCALIENTES</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA&#8288;</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA SUR&#8288;</code>,
<code>CAMPECHE</code>, <code>CHIAPAS</code>, <code>CHIHUAHUA</code>, <code style="white-space: pre;">&#8288;CIUDAD DE MEXICO&#8288;</code>,
<code style="white-space: pre;">&#8288;COAHUILA DE ZARAGOZA&#8288;</code> , <code>COLIMA</code>, <code>DURANGO</code>, <code>GUANAJUATO</code>, <code>GUERRERO</code>,
<code>HIDALGO</code>, <code>JALISCO</code>, <code>MEXICO</code>, <code style="white-space: pre;">&#8288;MICHOACAN DE OCAMPO&#8288;</code>, <code>MORELOS</code>,<code>NAYARIT</code>
<code style="white-space: pre;">&#8288;NUEVO LEON&#8288;</code>, <code>OAXACA</code> ,<code>PUEBLA</code>, <code>QUERETARO</code>,<code style="white-space: pre;">&#8288;QUINTANA ROO&#8288;</code>,
<code style="white-space: pre;">&#8288;SAN LUIS POTOSI&#8288;</code>, <code>SINALOA</code>, <code>SONORA</code>, <code>TABASCO</code>, <code>TAMAULIPAS</code>,<code>TLAXCALA</code>,
<code style="white-space: pre;">&#8288;VERACRUZ DE IGNACIO DE LA LLAVE&#8288;</code>, <code>YUCATAN</code>, <code>ZACATECAS</code>.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_group_by_entidad">group_by_entidad</code></td>
<td>
<p>(<strong>opcional</strong>) <code>TRUE</code> obtiene los casos para cada entidad reportando
en cada fecha la entidad y los casos en dicha entidad. <code>FALSE</code>  junta las <code>entidades</code> sumando
sus casos en una sola observacion por cada fecha.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_entidad_tipo">entidad_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Indica a que se refiere las <code>entidades</code> seleccionadas. Elige
una de las opciones: <code style="white-space: pre;">&#8288;Unidad Medica&#8288;</code> (entidad de la unidad medica), <code>Nacimiento</code>
(entidad de origen del individuo) o <code>Residencia</code> (entidad donde reside el individuo).</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_fecha_tipo">fecha_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Selecciona si la fecha que se utiliza es la fecha de <code>Ingreso</code>
(si aplica), la fecha de <code>Sintomas</code> o la de <code>Defuncion</code> (si aplica). El default es fecha de <code>Sintomas</code>.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_tipo_prueba">tipo_prueba</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con el tipo de pruebas a incluir <code>Antigeno</code>, <code>PCR</code>. Por
default se incluyen ambas.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_group_by_tipo_prueba">group_by_tipo_prueba</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determinando si regresa la base
con cada entrada agrupada por <code>tipo_prueba</code>. En caso <code>TRUE</code> (cada fecha
y entidad reporta separado el los casos de PCR y Antigeno). En caso <code>FALSE</code> se juntan
los casos de PCR y Antigeno para devolver un unico numero por fecha.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_tipo_paciente">tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con el tipo de pacientes a incluir. Opciones:
<code>AMBULATORIO</code>, <code>HOSPITALIZADO</code>, <code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>. Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_group_by_tipo_paciente">group_by_tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determinando (caso <code>TRUE</code>) si regresa
la base con cada entrada agrupada por <code>tipo_paciente</code> (es decir cada fecha
se genera un renglon para <code>AMBULATORIO</code>, un renglon para <code>HOSPITALIZADO</code>, etc) o bien
si se suman todos los grupos y cada fecha reporta solo la suma de estos
(estilo <code>AMBULATORIO + HOSPITALIZADO</code> segun las categorias de <code>tipo_paciente</code>)
El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_tipo_uci">tipo_uci</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con el tipo de valores para Unidad de
Cuidado Intensivo (UCI) a incluir:  <code>SI</code>,<code>NO</code>,<code style="white-space: pre;">&#8288;NO APLICA&#8288;</code>,<code style="white-space: pre;">&#8288;SE IGNORA&#8288;</code>,<code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>.
Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_group_by_tipo_uci">group_by_tipo_uci</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana. El caso <code>TRUE</code> determina si regresa la base
con cada fecha teniendo diferentes renglones uno para cada <code>tipo_uci</code> (es decir cada fecha
se generan tantos observaciones como grupos de tipo de UCI) o bien en una sola fecha
se suman todos los tipos de UCI (<code>FALSE</code>). El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_tipo_sector">tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con los sectores del sistema de salud a incluir:
<code style="white-space: pre;">&#8288;CRUZ ROJA&#8288;</code>,<code>DIF</code>,<code>ESTATAL</code>,<code>IMSS</code>,<code>IMSS-BIENESTAR</code>,<code>ISSSTE</code>, <code>MUNICIPAL</code>,<code>PEMEX</code>,
<code>PRIVADA</code>,<code>SEDENA</code>,<code>SEMAR</code>,<code>SSA</code>, <code>UNIVERSITARIO</code>,<code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>.
Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_group_by_tipo_sector">group_by_tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determina en el caso de <code>TRUE</code> si regresa
la base con cada entrada agrupada por <code>tipo_sector</code> (es decir cada fecha
tiene una entrada con los del <code>IMSS</code>, una entrada distinta con los de <code>ISSSTE</code>, etc) o bien
en caso de <code>FALSE</code> se devuelve una sola entrada por fecha con la suma <code>IMSS + ISSSTE + etc</code>
segun los  sectores seleccionados. El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_defunciones">defunciones</code></td>
<td>
<p>(<strong>opcional</strong>)  Booleana si incluir sólo defunciones <code>TRUE</code> o a todos <code>FALSE</code>.
El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_edad_cut">edad_cut</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con secuencia de edades para hacer grupos. Por ejemplo
<code>edad_cut = c(0, 10, Inf)</code> arma dos grupos de edad de 0 a 10 y de 10 a infinito o bien
<code>edad_cut = c(15, 20)</code> deja sólo los registros entre 15 y 20 años. Por default es <code>NULL</code>
y no arma grupos etarios.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_as_tibble">as_tibble</code></td>
<td>
<p>(<strong>opcional</strong>) Regresar como <code>tibble</code> el resultado. En caso de que <code>as_tibble</code>
sea <code>FALSE</code> se devuelve como conexion en <code>duckdb</code>. Se recomienda el default (<code>tibble</code>).</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_fill_zeros">fill_zeros</code></td>
<td>
<p>(<strong>opcional</strong>) En caso de que el resultado sea un <code>tibble</code> regresa
observaciones para todas las combinaciones de variables incluyendo como 0 aquellas fechas
cuando no se observaron casos. En caso contrario no se incluyen las filas donde no se
observaron casos.</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_list_name">list_name</code></td>
<td>
<p>(<strong>opcional</strong>) Asigna un nombre en la lista de datos a la base generada</p>
</td></tr>
<tr><td><code id="numero_pruebas_+3A_.grouping_vars">.grouping_vars</code></td>
<td>
<p>(<strong>opcional</strong>) Vector de variables adicionales de agrupacion de los
conteos. Por ejemplo si se agrega <code>.grouping_vars = 'DIABETES'</code> entonces para cada fecha habra
dos conteos de casos uno de los que tienen diabetes y uno de los que no.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Las pruebas de PCR (polymerase chain reaction) identifican material genetico de un organismo
(por ejemplo un virus como el COVID-19 o la influenza). Las pruebas de antigeno
(o pruebas rapidas) detectan algunas proteinas que conforman el virus.
</p>
<p>Para mas informacion sobre las pruebas y su interpretacion puedes consultar
<a href="https://espanol.cdc.gov/coronavirus/2019-ncov/symptoms-testing/testing.html">las guias del CDC</a>
</p>


<h3>Value</h3>

<p>Adiciona a la lista de <code>datos_covid</code> una nueva entrada de nombre <code>list_name</code>
(default: <code>numero_pruebas</code>) con una base de datos (<code>tibble</code> o <code>duckdb</code>) con los
resultados agregados.
</p>

<ul>
<li><p> numero_pruebas - Base de datos generara con los datos agregados (el nombre cambia si
se usa <code>list_name</code>).
</p>
</li>
<li><p> dict - Diccionario de datos
</p>
</li>
<li><p> dats - Datos originales (conexion a <code>duckdb</code> o <code>tibble</code>)
</p>
</li>
<li><p> disconnect  - Función para desconectarte de <code>duckdb</code>
</p>
</li>
<li><p> ... - Cualquier otro elemento que ya existiera en <code>datos_covid</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# Para el ejemplo usaremos los datos precargados (datosabiertos) pero tu puedes
# correr el ejemplo descargando informacion mas reciente.
datos_covid &lt;- datosabiertos

# Número de pruebas PCR/Antigeno a nivel nacional por estado
datos_covid &lt;- datos_covid |&gt; numero_pruebas()
head(datos_covid$numero_pruebas)

# Número de pruebas nacionales pero sin separar por tipo ni estado
datos_covid &lt;- datos_covid |&gt;
  numero_pruebas(
    group_by_entidad = FALSE, group_by_tipo_prueba = FALSE,
    list_name = "Todas_las_pruebas"
  )
head(datos_covid$Todas_las_pruebas)

# Positivos en Baja California Sur
datos_covid &lt;- datos_covid |&gt;
  numero_pruebas(
    entidades = c("BAJA CALIFORNIA SUR"),
    list_name = "BCS"
  )
head(datos_covid$BCS)

# Si deseas agrupar por una variable que no este en las opciones asi como tipo paciente
datos_covid &lt;- datos_covid |&gt;
  numero_pruebas(
    tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO"),
    group_by_tipo_paciente = TRUE,
    .grouping_vars = c("DIABETES"),
    list_name = "pruebas_diabetes"
  )
head(datos_covid$pruebas_diabetes)

# Una vez hayas concluido tu trabajo no olvides desconectar
datos_covid$disconnect()
</code></pre>

<hr>
<h2 id='plot_covid'>Grafica los casos de COVID-19</h2><span id='topic+plot_covid'></span>

<h3>Description</h3>

<p><code>plot_covid</code> Intenta graficar automaticamente la base de datos de covid generados por <code><a href="#topic+casos">casos()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_covid(
  datos_covid,
  df_name = "casos",
  df_date_index = stringr::str_subset(colnames(datos_covid[df_name][[1]]),
    "FECHA|fecha|Fecha"),
  df_variable = NULL,
  df_covariates = c(),
  facet_scale = "free_y",
  facet_ncol = 4,
  date_break_format = "2 months",
  date_labels_format = "%B-%y",
  type = c("point", "line", "spline", "area"),
  plot_theme = ggplot2::theme(panel.background = ggplot2::element_rect(fill = "white"),
    plot.background = ggplot2::element_rect(fill = "white"), axis.text.x =
    ggplot2::element_text(angle = 90, hjust = 1), axis.line.x =
    ggplot2::element_line(color = "black"), legend.position = "none"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_covid_+3A_datos_covid">datos_covid</code></td>
<td>
<p>(<strong>obligatorio</strong>) Lista de <code>tibble</code>s resultante de <code><a href="#topic+casos">casos()</a></code>, <code><a href="#topic+cfr">cfr()</a></code>,
<code><a href="#topic+chr">chr()</a></code>, <code><a href="#topic+positividad">positividad()</a></code> o <code><a href="stats.html#topic+rt">rt()</a></code></p>
</td></tr>
<tr><td><code id="plot_covid_+3A_df_name">df_name</code></td>
<td>
<p>(<strong>opcional</strong>) Nombre de la base de datos dentro de la lista <code>datos_covid</code></p>
</td></tr>
<tr><td><code id="plot_covid_+3A_df_date_index">df_date_index</code></td>
<td>
<p>(<strong>opcional</strong>) Nombre de la variable que contiene la fecha</p>
</td></tr>
<tr><td><code id="plot_covid_+3A_df_variable">df_variable</code></td>
<td>
<p>(<strong>opcional</strong>) Nombre de la variable que se va a graficar en el eje y</p>
</td></tr>
<tr><td><code id="plot_covid_+3A_df_covariates">df_covariates</code></td>
<td>
<p>(<strong>opcional</strong>) Covariables para el <code>facet_wrap</code> (maximo 2)</p>
</td></tr>
<tr><td><code id="plot_covid_+3A_facet_scale">facet_scale</code></td>
<td>
<p>(<strong>opcional</strong>) Escala para el <code><a href="ggplot2.html#topic+facet_wrap">ggplot2::facet_wrap()</a></code></p>
</td></tr>
<tr><td><code id="plot_covid_+3A_facet_ncol">facet_ncol</code></td>
<td>
<p>(<strong>opcional</strong>)  Numero de columnas para el <code><a href="ggplot2.html#topic+facet_wrap">ggplot2::facet_wrap()</a></code></p>
</td></tr>
<tr><td><code id="plot_covid_+3A_date_break_format">date_break_format</code></td>
<td>
<p>(<strong>opcional</strong>) Breaks para el eje x <code><a href="ggplot2.html#topic+scale_date">ggplot2::scale_x_date()</a></code></p>
</td></tr>
<tr><td><code id="plot_covid_+3A_date_labels_format">date_labels_format</code></td>
<td>
<p>(<strong>opcional</strong>) Formato de fecha para el eje x <code><a href="ggplot2.html#topic+scale_date">ggplot2::scale_x_date()</a></code></p>
</td></tr>
<tr><td><code id="plot_covid_+3A_type">type</code></td>
<td>
<p>(<strong>opcional</strong>) Tipo de grafica (<code>line</code>, <code>area</code>, <code>spline</code> o <code>point</code>)</p>
</td></tr>
<tr><td><code id="plot_covid_+3A_plot_theme">plot_theme</code></td>
<td>
<p>(<strong>opcional</strong>) Tema para el <code>ggplot2</code> (ejemplo <code><a href="ggplot2.html#topic+ggtheme">ggplot2::theme_classic()</a></code>).</p>
</td></tr>
<tr><td><code id="plot_covid_+3A_...">...</code></td>
<td>
<p>(<strong>opcional</strong>) Parametros adicionales para <code><a href="ggformula.html#topic+geom_spline">ggformula::geom_spline()</a></code> en caso de elegir
<code>type="spline"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Un <code>ggplot2</code> con la imagen graficada.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+casos">casos()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Para el ejemplo usaremos los datos precargados (datosabiertos) pero tu puedes
# correr el ejemplo descargando informacion mas reciente:
datos_covid &lt;- datosabiertos

# Aqui muchos aparecen en cero si usas el default de datosabiertos
# porque la base de datosabiertos tiene muy pocos casos
datos_covid |&gt;
  casos(list_name = "casos_for_plot", group_by_entidad = FALSE) |&gt;
  plot_covid(df_name = "casos_for_plot")

# Grafica de casos nacional

datos_covid |&gt;
  casos(group_by_entidad = FALSE, list_name = "plot_nal") |&gt;
  plot_covid(df_name = "plot_nal")

# Ajuste mediante splines
datos_covid |&gt;
  casos(group_by_entidad = FALSE, list_name = "spline_nacional") |&gt;
  plot_covid(df_name = "spline_nacional", type = "spline", spar = 0.5)

# Graficacion por covariables
# el objeto devuelto es un objeto de ggplot2 al que se le puede dar formato
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  datos_covid |&gt;
    chr(
      group_by_entidad = TRUE, list_name = "plot_nal", .grouping_vars = c("SEXO"),
      entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR")
    ) |&gt;
    plot_covid(
      df_name = "plot_nal",
      date_break_format = "1 week",
      date_labels_format = "%d/%B/%Y",
      df_covariates = c("SEXO", "ENTIDAD_FEDERATIVA"),
      type = "area"
    ) +
    ggplot2::ggtitle("Plot nacional")
}

# Puedes tambien primero editar el tibble que usaras por ejemplo poniendo
# los nombres de los sexos
datos_covid &lt;- datos_covid |&gt;
  chr(
    group_by_entidad = TRUE, list_name = "plot_nal", .grouping_vars = c("SEXO"),
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR")
  )


# Finalmente desconectamos
datos_covid$disconnect()

</code></pre>

<hr>
<h2 id='positividad'>Positividad</h2><span id='topic+positividad'></span>

<h3>Description</h3>

<p><code>positividad</code> Calcula la positividad  por fecha agrupando (o sin hacerlo)
por covariables. Por default calcula la positividad de las pruebas
haciendo Antigeno y PCR por separado, cada una por fecha y entidad.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>positividad(
  datos_covid,
  entidades = c("AGUASCALIENTES", "BAJA CALIFORNIA", "BAJA CALIFORNIA SUR", "CAMPECHE",
    "CHIAPAS", "CHIHUAHUA", "CIUDAD DE MÉXICO", "COAHUILA DE ZARAGOZA", "COLIMA",
    "DURANGO", "GUANAJUATO", "GUERRERO", "HIDALGO", "JALISCO", "MÉXICO",
    "MICHOACÁN DE OCAMPO", "MORELOS", "NAYARIT", "NUEVO LEÓN", "OAXACA", "PUEBLA",
    "QUERÉTARO", "QUINTANA ROO", "SAN LUIS POTOSÍ", "SINALOA", "SONORA", "TABASCO",
    "TAMAULIPAS", "TLAXCALA", "VERACRUZ DE IGNACIO DE LA LLAVE", "YUCATÁN", "ZACATECAS"),
  group_by_entidad = TRUE,
  entidad_tipo = c("Unidad Medica", "Residencia", "Nacimiento"),
  fecha_tipo = c("Sintomas", "Ingreso", "Defuncion"),
  tipo_prueba = c("Antigeno", "PCR"),
  group_by_tipo_prueba = TRUE,
  tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO", "NO ESPECIFICADO"),
  group_by_tipo_paciente = FALSE,
  tipo_uci = c("SI", "NO", "NO APLICA", "SE IGNORA", "NO ESPECIFICADO"),
  group_by_tipo_uci = FALSE,
  tipo_sector = c("CRUZ ROJA", "DIF", "ESTATAL", "IMSS", "IMSS-BIENESTAR", "ISSSTE",
    "MUNICIPAL", "PEMEX", "PRIVADA", "SEDENA", "SEMAR", "SSA", "UNIVERSITARIO",
    "NO ESPECIFICADO"),
  group_by_tipo_sector = FALSE,
  defunciones = FALSE,
  edad_cut = NULL,
  fill_NA = TRUE,
  list_name = "positividad",
  remove_inconclusive = TRUE,
  .grouping_vars = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="positividad_+3A_datos_covid">datos_covid</code></td>
<td>
<p>(<strong>obligatorio</strong>) Lista de <code>tibble</code>s o <code>duckdb</code>s resultante de
<code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> o <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code></p>
</td></tr>
<tr><td><code id="positividad_+3A_entidades">entidades</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con las entidades de las unidades medicas a analizar.
Opciones: <code>AGUASCALIENTES</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA&#8288;</code>, <code style="white-space: pre;">&#8288;BAJA CALIFORNIA SUR&#8288;</code>,
<code>CAMPECHE</code>, <code>CHIAPAS</code>, <code>CHIHUAHUA</code>, <code style="white-space: pre;">&#8288;CIUDAD DE MEXICO&#8288;</code>,
<code style="white-space: pre;">&#8288;COAHUILA DE ZARAGOZA&#8288;</code> , <code>COLIMA</code>, <code>DURANGO</code>, <code>GUANAJUATO</code>, <code>GUERRERO</code>,
<code>HIDALGO</code>, <code>JALISCO</code>, <code>MEXICO</code>, <code style="white-space: pre;">&#8288;MICHOACAN DE OCAMPO&#8288;</code>, <code>MORELOS</code>,<code>NAYARIT</code>
<code style="white-space: pre;">&#8288;NUEVO LEON&#8288;</code>, <code>OAXACA</code> ,<code>PUEBLA</code>, <code>QUERETARO</code>,<code style="white-space: pre;">&#8288;QUINTANA ROO&#8288;</code>,
<code style="white-space: pre;">&#8288;SAN LUIS POTOSI&#8288;</code>, <code>SINALOA</code>, <code>SONORA</code>, <code>TABASCO</code>, <code>TAMAULIPAS</code>,<code>TLAXCALA</code>,
<code style="white-space: pre;">&#8288;VERACRUZ DE IGNACIO DE LA LLAVE&#8288;</code>, <code>YUCATAN</code>, <code>ZACATECAS</code>.</p>
</td></tr>
<tr><td><code id="positividad_+3A_group_by_entidad">group_by_entidad</code></td>
<td>
<p>(<strong>opcional</strong>) <code>TRUE</code> obtiene los casos para cada entidad reportando
en cada fecha la entidad y los casos en dicha entidad. <code>FALSE</code>  junta las <code>entidades</code> sumando
sus casos en una sola observacion por cada fecha.</p>
</td></tr>
<tr><td><code id="positividad_+3A_entidad_tipo">entidad_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Indica a que se refiere las <code>entidades</code> seleccionadas. Elige
una de las opciones: <code style="white-space: pre;">&#8288;Unidad Medica&#8288;</code> (entidad de la unidad medica), <code>Nacimiento</code>
(entidad de origen del individuo) o <code>Residencia</code> (entidad donde reside el individuo).</p>
</td></tr>
<tr><td><code id="positividad_+3A_fecha_tipo">fecha_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Selecciona si la fecha que se utiliza es la fecha de <code>Ingreso</code>
(si aplica), la fecha de <code>Sintomas</code> o la de <code>Defuncion</code> (si aplica). El default es fecha de <code>Sintomas</code>.</p>
</td></tr>
<tr><td><code id="positividad_+3A_tipo_prueba">tipo_prueba</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con el tipo de pruebas a incluir <code>Antigeno</code>, <code>PCR</code>. Por
default se incluyen ambas.</p>
</td></tr>
<tr><td><code id="positividad_+3A_group_by_tipo_prueba">group_by_tipo_prueba</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determinando si regresa la base
con cada entrada agrupada por <code>tipo_prueba</code>. En caso <code>TRUE</code> (cada fecha
y entidad reporta separado el los casos de PCR y Antigeno). En caso <code>FALSE</code> se juntan
los casos de PCR y Antigeno para devolver un unico numero por fecha.</p>
</td></tr>
<tr><td><code id="positividad_+3A_tipo_paciente">tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con el tipo de pacientes a incluir. Opciones:
<code>AMBULATORIO</code>, <code>HOSPITALIZADO</code>, <code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>. Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="positividad_+3A_group_by_tipo_paciente">group_by_tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determinando (caso <code>TRUE</code>) si regresa
la base con cada entrada agrupada por <code>tipo_paciente</code> (es decir cada fecha
se genera un renglon para <code>AMBULATORIO</code>, un renglon para <code>HOSPITALIZADO</code>, etc) o bien
si se suman todos los grupos y cada fecha reporta solo la suma de estos
(estilo <code>AMBULATORIO + HOSPITALIZADO</code> segun las categorias de <code>tipo_paciente</code>)
El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="positividad_+3A_tipo_uci">tipo_uci</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con el tipo de valores para Unidad de
Cuidado Intensivo (UCI) a incluir:  <code>SI</code>,<code>NO</code>,<code style="white-space: pre;">&#8288;NO APLICA&#8288;</code>,<code style="white-space: pre;">&#8288;SE IGNORA&#8288;</code>,<code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>.
Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="positividad_+3A_group_by_tipo_uci">group_by_tipo_uci</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana. El caso <code>TRUE</code> determina si regresa la base
con cada fecha teniendo diferentes renglones uno para cada <code>tipo_uci</code> (es decir cada fecha
se generan tantos observaciones como grupos de tipo de UCI) o bien en una sola fecha
se suman todos los tipos de UCI (<code>FALSE</code>). El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="positividad_+3A_tipo_sector">tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con los sectores del sistema de salud a incluir:
<code style="white-space: pre;">&#8288;CRUZ ROJA&#8288;</code>,<code>DIF</code>,<code>ESTATAL</code>,<code>IMSS</code>,<code>IMSS-BIENESTAR</code>,<code>ISSSTE</code>, <code>MUNICIPAL</code>,<code>PEMEX</code>,
<code>PRIVADA</code>,<code>SEDENA</code>,<code>SEMAR</code>,<code>SSA</code>, <code>UNIVERSITARIO</code>,<code style="white-space: pre;">&#8288;NO ESPECIFICADO&#8288;</code>.
Por default se incluyen todos.</p>
</td></tr>
<tr><td><code id="positividad_+3A_group_by_tipo_sector">group_by_tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determina en el caso de <code>TRUE</code> si regresa
la base con cada entrada agrupada por <code>tipo_sector</code> (es decir cada fecha
tiene una entrada con los del <code>IMSS</code>, una entrada distinta con los de <code>ISSSTE</code>, etc) o bien
en caso de <code>FALSE</code> se devuelve una sola entrada por fecha con la suma <code>IMSS + ISSSTE + etc</code>
segun los  sectores seleccionados. El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="positividad_+3A_defunciones">defunciones</code></td>
<td>
<p>(<strong>opcional</strong>)  Booleana si incluir sólo defunciones <code>TRUE</code> o a todos <code>FALSE</code>.
El default es <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="positividad_+3A_edad_cut">edad_cut</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con secuencia de edades para hacer grupos. Por ejemplo
<code>edad_cut = c(0, 10, Inf)</code> arma dos grupos de edad de 0 a 10 y de 10 a infinito o bien
<code>edad_cut = c(15, 20)</code> deja sólo los registros entre 15 y 20 años. Por default es <code>NULL</code>
y no arma grupos etarios.</p>
</td></tr>
<tr><td><code id="positividad_+3A_fill_na">fill_NA</code></td>
<td>
<p>(<strong>opcional</strong>)  Regresa observaciones para todas las combinaciones de variables
incluyendo como <code>NA</code> donde no se observaron casos en el denominador.  En caso contrario no se
incluyen las filas donde no se observaron casos.</p>
</td></tr>
<tr><td><code id="positividad_+3A_list_name">list_name</code></td>
<td>
<p>(<strong>opcional</strong>) Asigna un nombre en la lista de datos a la base generada</p>
</td></tr>
<tr><td><code id="positividad_+3A_remove_inconclusive">remove_inconclusive</code></td>
<td>
<p>(<strong>opcional</strong>)  Si <code>TRUE</code> no considera en el denominador de la
positividad las pruebas cuyo resultado es inconcluso o aún no ha sido otorgado. Si <code>FALSE</code>
considera a todos. Por default es <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="positividad_+3A_.grouping_vars">.grouping_vars</code></td>
<td>
<p>(<strong>opcional</strong>) Vector de variables adicionales de agrupacion de los
conteos. Por ejemplo si se agrega <code>.grouping_vars = 'DIABETES'</code> entonces para cada fecha habra
dos conteos de casos uno de los que tienen diabetes y uno de los que no.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>La positividad se define como
</p>
<p style="text-align: center;"><code class="reqn">\frac{\# Pruebas positivas}{Total de pruebas}</code>
</p>

<p>Si se utiliza la opción <code>remove_inconclusive = TRUE</code> el <strong>Total de pruebas</strong> se calcula
utilizando solo <code>POSITIVOS + NEGATIVOS</code>. Si <code>remove_inconclusive = FALSE</code> se calcula
utilizando todas las personas que tuvieron prueba:
<code style="white-space: pre;">&#8288;POSITIVOS + NEGATIVOS + INCONCLUSOS + SIN RESULTADO&#8288;</code>.
</p>
<p>Si no se realizaron pruebas un dia la positividad no esta definida pues el <strong>Total de pruebas</strong>
es cero. En ese caso si <code>fill_NA = TRUE</code> se devuelven las entradas de esos dias pero
con valor <code>NA</code>.
</p>


<h3>Value</h3>

<p>Une a la lista de <code>datos_covid</code> una nueva entrada de nombre <code>list_name</code>
(default: <code>positividad</code>) con una base de datos (<code>tibble</code>) con los
resultados agregados.
</p>

<ul>
<li><p> positividad - Base de datos generara con los datos agregados (el nombre cambia si
se usa <code>list_name</code>).
</p>
</li>
<li><p> dict - Diccionario de datos
</p>
</li>
<li><p> dats - Datos originales (conexion a <code>duckdb</code> o <code>tibble</code>)
</p>
</li>
<li><p> disconnect  - Función para desconectarte de <code>duckdb</code>
</p>
</li>
<li><p> ... - Cualquier otro elemento que ya existiera en <code>datos_covid</code>
</p>
</li></ul>



<h3>References</h3>

<p>Furuse, Y., Ko, Y. K., Ninomiya, K., Suzuki, M., &amp; Oshitani, H. (2021). Relationship of test
positivity rates with COVID-19 epidemic dynamics. International journal of environmental
research and public health, 18(9), 4655.
</p>
<p>Al Dallal, A., AlDallal, U., &amp; Al Dallal, J. (2021). Positivity rate: an indicator for the
spread of COVID-19. Current Medical Research and Opinion, 37(12), 2067-2076.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code> <code><a href="#topic+numero_pruebas">numero_pruebas()</a></code> <code><a href="#topic+cfr">cfr()</a></code> <code><a href="#topic+chr">chr()</a></code> <code><a href="#topic+estima_rt">estima_rt()</a></code> <code><a href="#topic+casos">casos()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Para el ejemplo usaremos los datos precargados (datosabiertos) pero tu puedes
# correr el ejemplo descargando informacion mas reciente.
datos_covid &lt;- datosabiertos

# Casos a nivel nacional por estado por tipo de prueba
datos_covid &lt;- datos_covid |&gt; positividad()
head(datos_covid$positividad)


# Total nacional sumando todas las pruebas del pais
datos_covid &lt;- datos_covid |&gt;
  positividad(group_by_entidad = FALSE, list_name = "positividad_nacional")
head(datos_covid$positividad_nacional)

# Positivos en Baja California y Baja California Sur
datos_covid &lt;- datos_covid |&gt;
  positividad(
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    list_name = "positividad_californiana"
  )
head(datos_covid$positividad_californiana)

# Agrupando ambas pruebas en una sola positividad global
datos_covid &lt;- datos_covid |&gt;
  positividad(
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    group_by_tipo_prueba = FALSE,
    list_name = "positividad_californiana_2"
  )
head(datos_covid$positividad_californiana_2)

# Regresa la suma de ambos estados pero dividiendo por tipo de paciente
datos_covid &lt;- datos_covid |&gt;
  positividad(
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    group_by_entidad = FALSE,
    tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO"),
    group_by_tipo_paciente = TRUE,
    list_name = "positividad_paciente"
  )
head(datos_covid$positividad_paciente)

# Si deseas agrupar por una variable que no este en las opciones va en .grouping_vars
datos_covid &lt;- datos_covid |&gt;
  positividad(
    tipo_sector = "IMSS",
    .grouping_vars = c("SEXO"),
    list_name = "positividad_imss_sexo"
  )
head(datos_covid$positividad_imss_sexo)


# Una vez hayas concluido tu trabajo no olvides desconectar
datos_covid$disconnect()
</code></pre>

<hr>
<h2 id='read_datos_abiertos'>Lee la base de datos de la direccion general de epidemiologia que ya descargaste</h2><span id='topic+read_datos_abiertos'></span>

<h3>Description</h3>

<p><code>read_datos_abiertos</code> Lee los datos abiertos almacenados en tu base de <code>duckdb</code> que
bajaste con <code>descarga_datos_abiertos</code>. Intenta de manera automática determinar
si los lee de <code>duckdb</code>, <code>csv</code> ó <code>zip</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_datos_abiertos(
  datos_abiertos_path = NULL,
  dbdir = tempfile(fileext = ".duckdb"),
  tblname = "covidmx",
  pragma_memory_limit = Sys.getenv("pragma_memory_limit"),
  drv = duckdb::duckdb(),
  colClasses = get_col_class(),
  read_format = c("duckdb", "tibble"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_datos_abiertos_+3A_datos_abiertos_path">datos_abiertos_path</code></td>
<td>
<p>(<strong>obligatorio</strong>) Camino a los datos abiertos si son un <code>zip</code>,
un <code>csv</code> o un <code>.duckdb</code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_+3A_dbdir">dbdir</code></td>
<td>
<p>(<strong>opcional</strong>) Direccion donde guardar la base de datos con terminacion <code>.duckdb</code>.
Corresponde al argumento de <code><a href="duckdb.html#topic+duckdb">duckdb::dbConnect__duckdb_driver()</a></code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_+3A_tblname">tblname</code></td>
<td>
<p>(<strong>opcional</strong>)  Nombre de la tabla de <code>duckdb</code> donde guardar los datos por
default se llama <code>covidmx</code>. Solo es relevante si estas usando el mismo <code>dbdir</code> para otro
proyecto distinto.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_+3A_pragma_memory_limit">pragma_memory_limit</code></td>
<td>
<p>(<strong>opcional</strong>) Limite de memoria para el programa
(ver <a href="https://duckdb.org/docs/sql/pragmas">PRAGMAS</a>). Cambialo a que sea mas o menos la mitad
de tu RAM. La forma mas sencilla es como una variable ambiental con
<code>Sys.setenv('pragma_memory_limit' = '1GB')</code> por ejemplo para un limite de 1 gigabyte.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_+3A_drv">drv</code></td>
<td>
<p>(<strong>opcional</strong>) Un  driver para <code>dbConnect</code> (default <code>duckdb::duckdb()</code>)</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_+3A_colclasses">colClasses</code></td>
<td>
<p>(<strong>opcional</strong>) Clases de la columna para leer en <code>duckdb::read_csv_duckdb()</code>.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_+3A_read_format">read_format</code></td>
<td>
<p>(<strong>opcional</strong>) <code>"duckdb"</code> o <code>"tibble"</code> establece el formato
de lectura de la base de datos. En la mayoria de los casos <code>"tibble"</code> va a
resultar en un error de memoria. La opcion de <code>"duckdb"</code> siempre es mas rapida por lo cual
es el default.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_+3A_...">...</code></td>
<td>
<p>(<strong>opcional</strong>) parametros adicionales para <code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Lista de valores:
</p>

<ul>
<li><p> dats        - Tabla conectada mediante <code>DBI::dbConnect</code> (si <code>duckdb</code>) o
tibble (si <code>tibble</code>)
</p>
</li>
<li><p> disconnect  - Funcion para cerrar la conexion a la base de datos.
</p>
</li>
<li><p> dict        - Lista de <code>tibble</code>s con el diccionario de datos para cada variable
</p>
</li></ul>



<h3>Note</h3>

<p>Para guardar tu base con <code>duckdb</code> cambia el <code>dbdir</code> a un archivo <code>.duckdb</code>. Como ejemplo
<code>dbdir = "ejemplo.duckdb"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+descarga_datos_abiertos">descarga_datos_abiertos()</a></code>  <code><a href="#topic+descarga_datos_red_irag">descarga_datos_red_irag()</a></code>
<code><a href="#topic+descarga_datos_variantes_GISAID">descarga_datos_variantes_GISAID()</a></code> <code><a href="#topic+casos">casos()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Archivo temporal donde guardar las cosas es cualquier .duckdb
file_duck &lt;- tempfile(fileext = ".duckdb")

#Estos links deben omitirse en una corrida normal. Se incluyen por ahora como ejemplo
#pero las opciones site.covid.dic y sites.covid deben eliminarse de abajo.
dlink   &lt;- "https://github.com/RodrigoZepeda/covidmx/raw/main/datos_abiertos_covid19.zip"
diclink &lt;- "https://github.com/RodrigoZepeda/covidmx/raw/main/diccionario_datos_covid19.zip"

if (RCurl::url.exists(dlink) &amp; RCurl::url.exists(diclink)){
  # EJEMPLO 0: Descarga los datos abiertos en archivo file_duck
  descarga_datos_abiertos(dbdir = file_duck, sites.covid = dlink, show_warnings = FALSE, 
      site.covid.dic = diclink)$disconnect()

  # EJEMPLO 1: Lee los datos de duckdb una vez descargados
  datos_covid &lt;- read_datos_abiertos(file_duck, show_warnings = FALSE, 
                                      site.covid.dic = diclink) # Lee duckdb
  datos_covid$disconnect()

# EJEMPLO 2: Lee los datos desde un zip descargado
# Descarga archivos de la DGE y guarda el zip
direccion_zip &lt;- descarga_db_datos_abiertos_tbl(sites.covid = dlink, show_warnings = FALSE)
# Lee zip
datos_covid &lt;- read_datos_abiertos(direccion_zip, dbdir = file_duck, show_warnings = FALSE,
                    site.covid.dic = diclink)
datos_covid$disconnect()

# EJEMPLO 3: Lee los datos desde un zip descargado
# Descarga archivos zip de la DGE
direccion_zip &lt;- descarga_db_datos_abiertos_tbl(sites.covid = dlink, show_warnings = FALSE)
direccion_csv &lt;- unzip_db_datos_abiertos_tbl(direccion_zip) # Descomprime el zip para tener csv
# Lee los csv
datos_covid &lt;- read_datos_abiertos(direccion_csv, dbdir = file_duck, show_warnings = FALSE,
                                     site.covid.dic = diclink) 
datos_covid$disconnect()

# EJEMPLO 4: Si ya tenias el diccionario lo puedes agregar
# Simula la idea de ya tener el diccionario
diccionario &lt;- descarga_diccionario(show_warnings = FALSE, site.covid.dic = diclink) 
datos_covid &lt;- read_datos_abiertos(file_duck, diccionario = diccionario, show_warnings = FALSE)
datos_covid$disconnect()

# EJEMPLO 5: Si ya tenias el diccionario como archivo zip
# Descarga el diccionario para tenerlo como zip
diccionario_zip &lt;- descarga_db_diccionario_ssa(show_warnings = FALSE, site.covid.dic = diclink) 
datos_covid &lt;- read_datos_abiertos(file_duck, diccionario_zip_path = diccionario_zip, 
                                    show_warnings = FALSE)
datos_covid$disconnect()

# EJEMPLO 6: Si ya tenias el diccionario como archivo xlsx
# Descarga el diccionario para tenerlo como zip
diccionario_zip &lt;- descarga_db_diccionario_ssa(show_warnings = FALSE, site.covid.dic = diclink)
# Abre el csv del diccionario
diccionario_csv &lt;- unzip_db_diccionario_ssa(diccionario_zip) 
datos_covid &lt;- read_datos_abiertos(file_duck,
  diccionario_unzipped_path = diccionario_csv,
  show_warnings = FALSE
)
datos_covid$disconnect()
}

</code></pre>

<hr>
<h2 id='read_datos_abiertos_zip'>Auxiliares de lectura para la base de la Direccion General de Epidemiologia</h2><span id='topic+read_datos_abiertos_zip'></span><span id='topic+read_datos_abiertos_csv'></span><span id='topic+read_datos_abiertos_duckdb'></span>

<h3>Description</h3>

<p>La funcion principal es <code><a href="#topic+read_datos_abiertos">read_datos_abiertos()</a></code> la cual decide si los lee de <code>zip</code>,
<code>duckdb</code> o <code>csv</code> Tambien puedes usar las auxiliares respectivas
</p>

<ul>
<li> <p><code><a href="#topic+read_datos_abiertos_zip">read_datos_abiertos_zip()</a></code>     Si sólo descargaste los datos de la DGE en <code>.zip</code>
</p>
</li>
<li> <p><code><a href="#topic+read_datos_abiertos_csv">read_datos_abiertos_csv()</a></code>     Si descargaste los datos de la DGE en <code>.zip</code> y
los descomprimiste.
</p>
</li>
<li> <p><code><a href="#topic+read_datos_abiertos_duckdb">read_datos_abiertos_duckdb()</a></code>  Si ya creaste tu table en <code>duckdb</code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>read_datos_abiertos_zip(
  datos_abiertos_zip_paths,
  diccionario_zip_path = NULL,
  diccionario_unzipped_path = NULL,
  diccionario = NULL,
  read_format = c("duckdb", "tibble"),
  tblname = "covidmx",
  drv = duckdb::duckdb(),
  dbdir = tempfile(fileext = ".duckdb"),
  colClasses = get_col_class(),
  download_process = c("pins", "download.file"),
  site.covid.dic = paste0("http://datosabiertos.salud.", "gob.mx/gobmx/salud/datos_a",
    "biertos/diccionario_datos_", "covid19.zip"),
  unzip_command = Sys.getenv("unzip_command"),
  unzip_args = Sys.getenv("unzip_args"),
  unzip_args_dict = list(exdir = ".", overwrite = TRUE),
  check_unzip_install = TRUE,
  clear_zip = (download_process[1] != "pins"),
  clear_csv = TRUE,
  use_dict = TRUE,
  quiet = FALSE,
  cache_datos = NULL,
  use_cache_on_failure = TRUE,
  cache_diccionario = NULL,
  force_download = FALSE,
  show_warnings = TRUE,
  board_url_name = "datos_abiertos",
  board_url_name_dict = "diccionario_covid",
  download_file_args = list(method = "curl", destfile = tempfile(), quiet = quiet),
  descarga_db_diccionario_ssa_args = list(),
  ...
)

read_datos_abiertos_csv(
  datos_abiertos_unzipped_path,
  diccionario_zip_path = NULL,
  diccionario_unzipped_path = NULL,
  diccionario = NULL,
  read_format = c("duckdb", "tibble"),
  tblname = "covidmx",
  drv = duckdb::duckdb(),
  dbdir = tempfile(fileext = ".duckdb"),
  colClasses = get_col_class(),
  download_process = c("pins", "download.file"),
  site.covid.dic = paste0("http://datosabiertos.salud.", "gob.mx/gobmx/salud/datos_a",
    "biertos/diccionario_datos_", "covid19.zip"),
  unzip_args_dict = list(exdir = ".", overwrite = TRUE),
  clear_csv = TRUE,
  quiet = FALSE,
  use_cache_on_failure = TRUE,
  cache_diccionario = NULL,
  force_download = FALSE,
  show_warnings = TRUE,
  board_url_name_dict = "diccionario_covid",
  download_file_args = list(method = "curl", destfile = tempfile(), quiet = quiet),
  descarga_db_diccionario_ssa_args = list(),
  ...
)

read_datos_abiertos_duckdb(
  datos_abiertos_tbl,
  drv = duckdb::duckdb(),
  tblname = "covidmx",
  pragma_memory_limit = Sys.getenv("pragma_memory_limit"),
  diccionario_zip_path = NULL,
  diccionario_unzipped_path = NULL,
  diccionario = NULL,
  download_process = c("pins", "download.file"),
  site.covid.dic = paste0("http://datosabiertos.salud.", "gob.mx/gobmx/salud/datos_a",
    "biertos/diccionario_datos_", "covid19.zip"),
  unzip_args_dict = list(exdir = ".", overwrite = TRUE),
  clear_zip = download_process[1] != "pins",
  clear_csv = TRUE,
  use_dict = TRUE,
  quiet = FALSE,
  use_cache_on_failure = TRUE,
  cache_diccionario = NULL,
  force_download = FALSE,
  show_warnings = TRUE,
  board_url_name_dict = "diccionario_covid",
  download_file_args = list(method = "curl", destfile = tempfile(), quiet = quiet),
  descarga_db_diccionario_ssa_args = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_datos_abiertos_zip_+3A_datos_abiertos_zip_paths">datos_abiertos_zip_paths</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino a los datos abiertos si ya los
descargaste en <code>zip</code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_diccionario_zip_path">diccionario_zip_path</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino al diccionario si ya losdescargaste en <code>zip</code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_diccionario_unzipped_path">diccionario_unzipped_path</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino al diccionario <code>csv</code> si ya
lo descargaste y descomprimiste el archivo <code>zip</code> en un <code>csv</code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_diccionario">diccionario</code></td>
<td>
<p>(<strong>opcional</strong>)  Lo que resulta de realizar una descarga del diccionario
usando <code>descarga_diccionario</code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_read_format">read_format</code></td>
<td>
<p>(<strong>opcional</strong>) <code>"duckdb"</code> o <code>"tibble"</code> establece el formato
de lectura de la base de datos. En la mayoria de los casos <code>"tibble"</code> va a
resultar en un error de memoria. La opcion de <code>"duckdb"</code> siempre es mas rapida por lo cual
es el default.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_tblname">tblname</code></td>
<td>
<p>(<strong>opcional</strong>)  Nombre de la tabla de <code>duckdb</code> donde guardar los datos por
default se llama <code>covidmx</code>. Solo es relevante si estas usando el mismo <code>dbdir</code> para otro
proyecto distinto.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_drv">drv</code></td>
<td>
<p>(<strong>opcional</strong>) Un  driver para <code>dbConnect</code> (default <code>duckdb::duckdb()</code>)</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_dbdir">dbdir</code></td>
<td>
<p>(<strong>opcional</strong>) Direccion donde guardar la base de datos con terminacion <code>.duckdb</code>.
Corresponde al argumento de <code><a href="duckdb.html#topic+duckdb">duckdb::dbConnect__duckdb_driver()</a></code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_colclasses">colClasses</code></td>
<td>
<p>(<strong>opcional</strong>) Clases de la columna para leer en <code>duckdb::read_csv_duckdb()</code>.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_download_process">download_process</code></td>
<td>
<p>(<strong>opcional</strong>)  Metodo para descargar ya sea <code>pins</code> o <code>download.file</code>.
Se recomienda <code>pins</code> pues guarda en memoria la fecha de la ultima descarga y analiza
si ha pasado mas de un dia desde la descarga. En caso afirmativo verifica si el
archivo ha cambiado y si hubo cambios entonces lo descarga.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_site.covid.dic">site.covid.dic</code></td>
<td>
<p>(<strong>opcional</strong>)  Sitio desde el cual descarga del diccionario de datos.
La ultima verificacion del sitio fue el 6 de septiembre 2022.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_unzip_command">unzip_command</code></td>
<td>
<p>(<strong>opcional</strong>) Forma de extraer la base de datos de datos abiertos
si <code>unzip</code> falla.
La forma de llamarla es con <code>system2(unzip_command, args = c(unzip_args, file_download_data))</code>.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_unzip_args">unzip_args</code></td>
<td>
<p>(<strong>opcional</strong>) Argumentos de extraccion de la base de datos de datos abiertos
si <code>unzip</code> falla.
La forma de llamarla es con <code>system2(unzip_command, args = c(unzip_args, file_download_data))</code>.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_unzip_args_dict">unzip_args_dict</code></td>
<td>
<p>(<strong>opcional</strong>) Lista de argumentos para usar <code>utils::unzip</code> en el
diccionario de datos.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_check_unzip_install">check_unzip_install</code></td>
<td>
<p>(<strong>opcional</strong>) Bandera de verificacion para checar si tienes
lo necesario para unzippear los datos en el caso de que <code>unzip</code> no sirva.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_clear_zip">clear_zip</code></td>
<td>
<p>(<strong>opcional</strong>) Si borrar los archivos <code>.zip</code> descargados para el diccionario
y los datos abiertos. No se recomienda si estas usando <code>pins</code>. Ve la nota para mas informacion.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_clear_csv">clear_csv</code></td>
<td>
<p>(<strong>opcional</strong>) Si borrar los archivos <code>.csv</code> que se generan despues de abrir
el zip. El default es que si pues en general solo requieres el <code>duckdb</code>.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_use_dict">use_dict</code></td>
<td>
<p>(<strong>opcional</strong>) Si descargar el diccionario de <code>site.covid.dic</code>.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_quiet">quiet</code></td>
<td>
<p>(<strong>opcional</strong>) Variable para no mostrar mensajes</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_cache_datos">cache_datos</code></td>
<td>
<p>(<strong>opcional</strong>) Direccion donde guardar los datos en memoria usando <code>pins</code>
para no tener que volver a descargarlos si nada ha cambiado</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_use_cache_on_failure">use_cache_on_failure</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana. Establece que si no se pueden descargar
datos nuevos utilice los que tenga en memoria. Por default es <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_cache_diccionario">cache_diccionario</code></td>
<td>
<p>(<strong>opcional</strong>) Direccion donde guardar el diccionario en memoria
usando <code>pins</code> para no tener que volver a descargarlo si nada ha cambiado</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_force_download">force_download</code></td>
<td>
<p>(<strong>opcional</strong>) Analiza si cambio el pin y descarga datos nuevos en caso
afirmativo aunque haya pasado menos de un dia.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_show_warnings">show_warnings</code></td>
<td>
<p>(<strong>opcional</strong>) si arrojar <code>warnings</code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_board_url_name">board_url_name</code></td>
<td>
<p>(<strong>opcional</strong>) Establece el nombre del <code>pins::board_url</code> para
los datos abiertos (si ya usas pins para que no se empalme).
Por default se llama <code>datos_abiertos</code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_board_url_name_dict">board_url_name_dict</code></td>
<td>
<p>(<strong>opcional</strong>) Establece el nombre del <code>pins::board_url</code> para los
datos abiertos. Por default se llama <code>diccionario_covid</code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_download_file_args">download_file_args</code></td>
<td>
<p>(<strong>opcional</strong>) Lista de argumentos adicionales para <code>download.file</code>
de los datos si se elige este metodo para descargar.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_descarga_db_diccionario_ssa_args">descarga_db_diccionario_ssa_args</code></td>
<td>
<p>(<strong>opcional</strong>) Lista con argumentos adicionales para el
<code>pins::pin_download</code> de datos abiertos</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_...">...</code></td>
<td>
<p>(<strong>opcional</strong>) Parametros adicionales para <code>DBI::dbConnect</code>.</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_datos_abiertos_unzipped_path">datos_abiertos_unzipped_path</code></td>
<td>
<p>(<strong>opcional</strong>)  Camino a los datos abiertos <code>csv</code> si ya
los descargaste y descomprimiste el archivo <code>zip</code> en un <code>csv</code></p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_datos_abiertos_tbl">datos_abiertos_tbl</code></td>
<td>
<p>(<strong>opcional</strong>) Camino a un archivo <code>.duckdb</code> con los datos formateados</p>
</td></tr>
<tr><td><code id="read_datos_abiertos_zip_+3A_pragma_memory_limit">pragma_memory_limit</code></td>
<td>
<p>(<strong>opcional</strong>) Limite de memoria para el programa
(ver <a href="https://duckdb.org/docs/sql/pragmas">PRAGMAS</a>). Cambialo a que sea mas o menos la mitad
de tu RAM. La forma mas sencilla es como una variable ambiental con
<code>Sys.setenv('pragma_memory_limit' = '1GB')</code> por ejemplo para un limite de 1 gigabyte.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Lista de valores:
</p>

<ul>
<li><p> dats        - Tabla conectada mediante <code>DBI::dbConnect</code> (si <code>duckdb</code>) o
tibble (si <code>tibble</code>)
</p>
</li>
<li><p> disconnect  - Funcion para cerrar la conexion a la base de datos.
</p>
</li>
<li><p> dict        - Lista de <code>tibble</code>s con el diccionario de datos para cada variable
</p>
</li></ul>



<h3>Note</h3>

<p>Para guardar tu base con <code>duckdb</code> cambia el <code>dbdir</code> a un archivo <code>.duckdb</code>. Como ejemplo
<code>dbdir = "ejemplo.duckdb"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Lee los datos de duckdb una vez descargados
# quita la opción de sites.covid para descargar los de la DGE. 
# Esto es solo un ejemplo.
file_ejemplo &lt;- tempfile(fileext = ".duckdb")

#Estos links deben omitirse en una corrida normal. Se incluyen por ahora como ejemplo
#pero las opciones site.covid.dic y sites.covid deben eliminarse de abajo.
dlink        &lt;- "https://github.com/RodrigoZepeda/covidmx/raw/main/datos_abiertos_covid19.zip"
diclink      &lt;- "https://github.com/RodrigoZepeda/covidmx/raw/main/diccionario_datos_covid19.zip"

#En el ejemplo de R por normas de CRAN tenemos que hacerlo así pero en tu
#computadora puedes solo usar descargar datos sin el if else
if (RCurl::url.exists(dlink) &amp; RCurl::url.exists(diclink)){

  #Necesitamos la base para verificar los reads
  datos_covid &lt;- descarga_datos_abiertos(
    dbdir = file_ejemplo,
    sites.covid = dlink, 
    site.covid.dic = diclink,
    show_warnings = FALSE
  )
  datos_covid$disconnect()
  
  datos_covid &lt;- read_datos_abiertos(file_ejemplo, show_warnings = FALSE, 
                    site.covid.dic = diclink)
  datos_covid$disconnect()

   # Es lo mismo que:
  datos_covid &lt;- read_datos_abiertos_duckdb(file_ejemplo, show_warnings = FALSE,
                                            site.covid.dic = diclink)
  datos_covid$disconnect()

  # Descarga los datos y lee de un zip guardandolos a la vez en
  # base de nombre datos_desde_zip.duckdb
  direccion_zip &lt;- descarga_db_datos_abiertos_tbl(sites.covid = dlink, show_warnings = FALSE,
                                                  site.covid.dic = diclink)
                                                 
  datos_covid &lt;- read_datos_abiertos(direccion_zip,
    dbdir = file_ejemplo,
    site.covid.dic = diclink,
    show_warnings = FALSE
  )
  datos_covid$disconnect()

  # Es lo mismo que:
  datos_covid &lt;- read_datos_abiertos_zip(direccion_zip,
    site.covid.dic = diclink,
    dbdir = file_ejemplo,
    show_warnings = FALSE
  )
  datos_covid$disconnect()

  # Descarga los datos y lee de un csv
  direccion_zip &lt;- descarga_db_datos_abiertos_tbl(sites.covid = dlink, show_warnings = FALSE)
  direccion_csv &lt;- unzip_db_datos_abiertos_tbl(direccion_zip)
  datos_covid   &lt;- read_datos_abiertos(direccion_csv, show_warnings = FALSE, 
                                          site.covid.dic = diclink)
  datos_covid$disconnect()

  # Es lo mismo que:
  direccion_csv &lt;- unzip_db_datos_abiertos_tbl(direccion_zip)
  datos_covid   &lt;- read_datos_abiertos_csv(direccion_csv, show_warnings = FALSE,
                          site.covid.dic = diclink)
  datos_covid$disconnect()
}

</code></pre>

<hr>
<h2 id='update_covidmx'>Actualiza el paquete covidmx</h2><span id='topic+update_covidmx'></span>

<h3>Description</h3>

<p>Descarga e instala la version mas reciente de covidmx desde Github
<a href="https://github.com/RodrigoZepeda/covidmx">https://github.com/RodrigoZepeda/covidmx</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_covidmx(quiet = FALSE, force = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_covidmx_+3A_quiet">quiet</code></td>
<td>
<p>(<strong>opcional</strong>) Determina si instalar en silencio</p>
</td></tr>
<tr><td><code id="update_covidmx_+3A_force">force</code></td>
<td>
<p>(<strong>opcional</strong>) Determina si forzar la reinstalacion</p>
</td></tr>
<tr><td><code id="update_covidmx_+3A_...">...</code></td>
<td>
<p>(<strong>opcional</strong>) Parametros adicionales para <code><a href="remotes.html#topic+install_github">remotes::install_github()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Ningún valor. Se llama para actualizar el paquete a la versión más reciente desde Github.
</p>


<h3>Note</h3>

<p>Actualiza el paquete instalando todas las dependencias necesarias.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Actualiza el paquete de coivdmx de Github | Updates the covidmx package from Github
update_covidmx()

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
