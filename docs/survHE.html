<!DOCTYPE html><html lang="en"><head><title>Help for package survHE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {survHE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#survHE-package'><p>survHE: Survival Analysis in Health Economic Evaluation</p></a></li>
<li><a href='#data'><p>A fictional survival trial.</p></a></li>
<li><a href='#digitise'><p>Format digitised data for use in survival analysis</p></a></li>
<li><a href='#fit.models'><p>Fit parametric survival analysis for health economic evaluations</p></a></li>
<li><a href='#make_data_multi_state'><p>make_data_multi_state</p></a></li>
<li><a href='#make_newdata'><p>Creates a 'newdata' list to modify the plots for specific individual</p>
profiles (with respect to the covariates)</a></li>
<li><a href='#make.ipd'><p>Create an individual level dataset from digitised data</p></a></li>
<li><a href='#make.surv'><p>Engine for Probabilistic Sensitivity Analysis on the survival curves</p></a></li>
<li><a href='#make.transition.probs'><p>make.transition.probs</p></a></li>
<li><a href='#markov_trace'><p>Markov trace</p></a></li>
<li><a href='#model.fit.plot'><p>Graphical representation of the measures of model fitting based on</p>
Information Criteria</a></li>
<li><a href='#msmdata'><p>NICE TA174 dataset in multi-state format.</p></a></li>
<li><a href='#plot_transformed_km'><p>Plot to assess suitability of parametric model</p></a></li>
<li><a href='#plot.survHE'><p>Plot survival curves for the models fitted using <code>fit.models</code></p></a></li>
<li><a href='#print.survHE'><p>Print a summary of the survival model(s) fitted by <code>fit.models</code></p></a></li>
<li><a href='#psa.plot'><p>Graphical depiction of the probabilistic sensitivity analysis for the</p>
survival curves</a></li>
<li><a href='#summary.survHE'><p>Prints a summary table for the distribution the mean survival time for a</p>
given model and data</a></li>
<li><a href='#ta174'><p>NICE TA174 dataset.</p></a></li>
<li><a href='#three_state_mm'><p>three_state_mm</p></a></li>
<li><a href='#write.surv'><p>write.surv</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Survival Analysis in Health Economic Evaluation</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-03-05</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/giabaio/survHE">https://github.com/giabaio/survHE</a>,
<a href="https://gianluca.statistica.it/software/survhe/">https://gianluca.statistica.it/software/survhe/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/giabaio/survHE/issues">https://github.com/giabaio/survHE/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Contains a suite of functions for survival analysis in health economics.
    These can be used to run survival models under a frequentist (based on maximum likelihood)
    or a Bayesian approach (both based on Integrated Nested Laplace Approximation or Hamiltonian
    Monte Carlo). To run the Bayesian models, the user needs to install additional modules 
    (packages), i.e. 'survHEinla' and 'survHEhmc'. These can be installed using 
    'remotes::install_github' from their GitHub repositories: 
    (<a href="https://github.com/giabaio/survHEhmc">https://github.com/giabaio/survHEhmc</a> and <a href="https://github.com/giabaio/survHEinla/">https://github.com/giabaio/survHEinla/</a> 
    respectively). 'survHEinla' is based on the package INLA, which is available for download at
    <a href="https://inla.r-inla-download.org/R/stable/">https://inla.r-inla-download.org/R/stable/</a>. The user can specify a set of parametric models 
    using a common notation and select the preferred mode of inference. The results can also be 
    post-processed to produce probabilistic sensitivity analysis and can be used to export the 
    output to an Excel file (e.g. for a Markov model, as often done by modellers and 
    practitioners). &lt;<a href="https://doi.org/10.18637%2Fjss.v095.i14">doi:10.18637/jss.v095.i14</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, R (&ge; 4.1.0), flexsurv, dplyr, ggplot2</td>
</tr>
<tr>
<td>Imports:</td>
<td>rms, xlsx, tools, tibble, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>survHEinla, survHEhmc, INLA, rstan, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://inla.r-inla-download.org/R/stable/">https://inla.r-inla-download.org/R/stable/</a>,
<a href="https://giabaio.r-universe.dev/">https://giabaio.r-universe.dev/</a></td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-03 17:29:50 UTC; gianluca</td>
</tr>
<tr>
<td>Author:</td>
<td>Gianluca Baio [aut, cre],
  Andrea Berardi [ctb],
  Philip Cooney [ctb],
  Andrew Jones [ctb],
  Nathan Green [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gianluca Baio &lt;g.baio@ucl.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-03 17:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='survHE-package'>survHE: Survival Analysis in Health Economic Evaluation</h2><span id='topic+survHE'></span><span id='topic+survHE-package'></span>

<h3>Description</h3>

<p>Contains a suite of functions for survival analysis in health economics. These can be used to run survival models under a frequentist (based on maximum likelihood) or a Bayesian approach (both based on Integrated Nested Laplace Approximation or Hamiltonian Monte Carlo). To run the Bayesian models, the user needs to install additional modules (packages), i.e. 'survHEinla' and 'survHEhmc'. These can be installed using 'remotes::install_github' from their GitHub repositories: (<a href="https://github.com/giabaio/survHEhmc">https://github.com/giabaio/survHEhmc</a> and <a href="https://github.com/giabaio/survHEinla/">https://github.com/giabaio/survHEinla/</a> respectively). 'survHEinla' is based on the package INLA, which is available for download at <a href="https://inla.r-inla-download.org/R/stable/">https://inla.r-inla-download.org/R/stable/</a>. The user can specify a set of parametric models using a common notation and select the preferred mode of inference. The results can also be post-processed to produce probabilistic sensitivity analysis and can be used to export the output to an Excel file (e.g. for a Markov model, as often done by modellers and practitioners). <a href="https://doi.org/10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Gianluca Baio <a href="mailto:g.baio@ucl.ac.uk">g.baio@ucl.ac.uk</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Andrea Berardi <a href="mailto:and.be.like@gmail.com">and.be.like@gmail.com</a> [contributor]
</p>
</li>
<li><p> Philip Cooney <a href="mailto:philip.cooney@hotmail.com">philip.cooney@hotmail.com</a> [contributor]
</p>
</li>
<li><p> Andrew Jones <a href="mailto:andrew.r.johnson@postgrad.curtin.edu.au">andrew.r.johnson@postgrad.curtin.edu.au</a> [contributor]
</p>
</li>
<li><p> Nathan Green <a href="mailto:n.green@ucl.ac.uk">n.green@ucl.ac.uk</a> [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/giabaio/survHE">https://github.com/giabaio/survHE</a>
</p>
</li>
<li> <p><a href="https://gianluca.statistica.it/software/survhe/">https://gianluca.statistica.it/software/survhe/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/giabaio/survHE/issues">https://github.com/giabaio/survHE/issues</a>
</p>
</li></ul>


<hr>
<h2 id='data'>A fictional survival trial.</h2><span id='topic+data'></span>

<h3>Description</h3>

<p>A dataset containing fictional data from a trial, where
the main outcome is in terms of time-to-event and
censoring indicator and with additional covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data
</code></pre>


<h3>Format</h3>

<p>A data frame with 367 rows and 8 variables:
</p>

<dl>
<dt>ID_patient</dt><dd><p>The individual level identifier</p>
</dd>
<dt>time</dt><dd><p>The observed time at which the event happens</p>
</dd>
<dt>censored</dt><dd><p>An indicator to describe whether the
event is fully observed or censored</p>
</dd>
<dt>arm</dt><dd><p>An indicator for the treatment arm, with
0 = control and 1 = active treatment</p>
</dd>
<dt>sex</dt><dd><p>An indicator for the individual's sex, with
0 = male and 1 = female</p>
</dd>
<dt>age</dt><dd><p>A numeric variable with the individual's age</p>
</dd>
<dt>imd</dt><dd><p>A categorical variable representing a measure
of area-level social deprivation</p>
</dd>
<dt>ethnic</dt><dd><p>A categorical variable representing the
individual's ethnic group, as measured from a Census</p>
</dd>
</dl>


<hr>
<h2 id='digitise'>Format digitised data for use in survival analysis</h2><span id='topic+digitise'></span>

<h3>Description</h3>

<p>Produces txt files with Kaplan Meier and individual level survival data from
digitised Kaplan Meier curves obtained by DigitizeIT
</p>


<h3>Usage</h3>

<pre><code class='language-R'>digitise(
  surv_inp,
  nrisk_inp,
  km_output = "KMdata.txt",
  ipd_output = "IPDdata.txt"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="digitise_+3A_surv_inp">surv_inp</code></td>
<td>
<p>a txt file obtained for example by DigitizeIT and containing
the input survival times from graph reading. This file contains 3 columns
'ID' = the row-ID
'time' = the vector of times captured by the digitisation process
'survival' = the vector of survival probabilities captured by the digitisation
process</p>
</td></tr>
<tr><td><code id="digitise_+3A_nrisk_inp">nrisk_inp</code></td>
<td>
<p>a txt file obtained by DigitizeIT and containing the
reported number at risk. This contains the following columns:
'Interval' = the ID of the various intervals included in the analysis (
eg 1, 2, 3, ...)
'Time' = the actual time shown on the x-axis in the digitsed graph
'Lower' = the row of the extracted co-ordinates that the time corresponds
to
'Upper' = the row of the extracted co-ordinates for which the time is less
than the following time at which we have a number at risk
'nrisk' = the actual number at risk as specified in the original data</p>
</td></tr>
<tr><td><code id="digitise_+3A_km_output">km_output</code></td>
<td>
<p>the name of the file to which the KM data will be written</p>
</td></tr>
<tr><td><code id="digitise_+3A_ipd_output">ipd_output</code></td>
<td>
<p>the name of the file to which the individual level data
data will be written</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Patricia Guyot and Gianluca Baio
</p>


<h3>References</h3>

<p>G Baio (2019). survHE: Survival analysis for health economic evaluation
and cost-effectiveness modelling. Journal of Statistical Software (2020). vol 95,
14, 1-47. <a href="doi:10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Defines the txt files to be used as inputs
surv.inp &lt;- system.file("extdata", "survival.txt", package = "survHE")
nrisk.inp &lt;- system.file("extdata", "nrisk.txt", package = "survHE")
# Runs 'digitise' to create the relevant output files
digitise(surv.inp, nrisk.inp)

## End(Not run)
</code></pre>

<hr>
<h2 id='fit.models'>Fit parametric survival analysis for health economic evaluations</h2><span id='topic+fit.models'></span>

<h3>Description</h3>

<p>Runs the survival analysis with several useful options, using either MLE
(via flexsurv) or a Bayesian approach (via R-INLA or rstan)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.models(formula = NULL, data, distr = NULL, method = "mle", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.models_+3A_formula">formula</code></td>
<td>
<p>a formula specifying the model to be used, in the form
<code>Surv(time,event)~treatment[+covariates]</code> for flexsurv, or
<code>inla.surv(time,event)~treatment[+covariates]</code> for INLA</p>
</td></tr>
<tr><td><code id="fit.models_+3A_data">data</code></td>
<td>
<p>A data frame containing the data to be used for the analysis.
This must contain data for the 'event' variable. In case there is no
censoring, then <code>event</code> is a column of 1s.</p>
</td></tr>
<tr><td><code id="fit.models_+3A_distr">distr</code></td>
<td>
<p>a (vector of) string(s) containing the name(s) of the model(s)
to be fitted.  Available options are:
</p>
<p><code>flexsurv</code>:
&quot;exponential&quot;,&quot;gamma&quot;,&quot;genf&quot;,&quot;gengamma&quot;,&quot;gompertz&quot;,&quot;weibull&quot;,
&quot;weibullPH&quot;,&quot;loglogistic&quot;,&quot;lognormal&quot; <code>INLA</code>:
&quot;exponential&quot;,&quot;weibull&quot;,&quot;lognormal&quot;,&quot;loglogistic&quot; <code>hmc</code>:
&quot;exponential&quot;,&quot;gamma&quot;,&quot;genf&quot;,&quot;gengamma&quot;,&quot;gompertz&quot;,&quot;weibull&quot;,&quot;weibullPH&quot;,
&quot;loglogistic&quot;,&quot;lognormal&quot;</p>
</td></tr>
<tr><td><code id="fit.models_+3A_method">method</code></td>
<td>
<p>A string specifying the inferential method (<code>'mle'</code>,
<code>'inla'</code> or <code>'hmc'</code>). If <code>method</code> is set to <code>'hmc'</code>,
then <code>survHE</code> will write suitable model code in the Stan language
(according to the specified distribution), prepare data and initial values
and then run the model.</p>
</td></tr>
<tr><td><code id="fit.models_+3A_...">...</code></td>
<td>
<p>Additional options (for INLA or HMC).
</p>
<p><strong>INLA</strong> specific options <code>dz</code> = defines the step length for the grid
search over the hyperparameters space (default = 0.1) <code>diff.logdens</code> =
defines the difference in the log-density for the hyperparameters to stop
integration (default = 5) <code>control.fixed</code> = defines the default for the
priors, unless specified by the user.  Default values are prior mean = 0 for
<em>all</em> fixed effects prior var = 1000 for <em>all</em> fixed effects prior mean = 0
for the intercept prior prec -&gt; 0 for the intercept <code>control.family</code> =
a list of options. If distr is a vector, then can be provided as a named
list of options, for example something like this:
<code>control.family=list(weibull=list(param=c(.1,.1)),lognormal=list(initial=2))</code>
the names of the elements of the list need to be the same as those given in
the vector <code>distr</code>
</p>
<p><strong>HMC</strong> specific options <code>chains</code> = number of chains to run in the HMC
(default = 2) <code>iter</code> = total number of iterations (default = 2000)
<code>warmup</code> = number of warmup iterations (default = iter/2) <code>thin</code> =
number of thinning (default = 1) <code>control</code> = a list specifying
Stan-related options, eg <code>control=list(adapt_delta=0.85)</code> (default =
NULL) <code>seed</code> = the random seed (to make things replicable) <code>pars</code>
= a vector of parameters (string, default = NA) <code>include</code> = a logical
indicator (if FALSE, then the pars are not saved; default = TRUE)
<code>priors</code> = a list (of lists) specifying the values for the parameters
of the prior distributions in the models <code>save.stan</code> = a logical
indicator (default = FALSE). If TRUE, then saves the data list for Stan and
the model file(s)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>On object in the class <code>survHE</code> containing the following elements
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>models</code></td>
<td>
<p> A list containing the fitted models. These contain
the output from the original inference engine (<code>flexsurv</code>, <code>INLA</code>
or <code>rstan</code>). Can be processed using the methods specific to the
original packages, or via <code>survHE</code>-specific methods (such as
<code>plot</code>, <code>print</code>) or other specialised functions (eg to extrapolate
the survival curves, etc). </p>
</td></tr> <tr><td><code>model.fitting</code></td>
<td>
<p> A list containing the
output of the model-fit statistics (AIC, BIC, DIC). The AIC and BIC are
estimated for all methods, while the DIC is only estimated when using
Bayesian inference. </p>
</td></tr> <tr><td><code>method</code></td>
<td>
<p> A string indicating the method used to
fit the model, ie <code>'mle'</code>, <code>'inla'</code> or <code>'hmc'</code>.  </p>
</td></tr>
<tr><td><code>misc</code></td>
<td>
<p> A list containing the time needed to run the model(s) (in
seconds), the formula used, the results of the Kaplan-Meier analysis (which
is automatically performed using <code>npsurv</code>) and the original data frame.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>G Baio (2019). survHE: Survival analysis for health economic evaluation
and cost-effectiveness modelling. Journal of Statistical Software (2020). vol 95,
14, 1-47. <a href="doi:10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>
</p>


<h3>See Also</h3>

<p><code>make.surv</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Loads an example dataset from 'flexsurv'
data(bc)

# Fits the same model using the 3 inference methods
mle = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr="exp",method="mle")
inla = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr="exp",method="inla")
hmc = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr="exp",method="hmc")
    
# Prints the results in comparable fashion using the survHE method
print(mle)
print(inla)
print(hmc)

# Or visualises the results using the original packages methods
print(mle,original=TRUE)
print(inla,original=TRUE)
print(hmc,original=TRUE)

# Plots the survival curves and estimates
plot(mle)
plot(mle,inla,hmc,labs=c("MLE","INLA","HMC"),colors=c("black","red","blue"))

## End(Not run)

</code></pre>

<hr>
<h2 id='make_data_multi_state'>make_data_multi_state</h2><span id='topic+make_data_multi_state'></span>

<h3>Description</h3>

<p>Takes as input an individual-level dataset including data on both
progression and death time (<strong>jointly</strong>) and manipulates it using
<code>dplyr</code> functions to create a full &quot;multi-state&quot; dataset, in
which all the transitions are tracked. This can then be used
to fit survival models and compute all the estimates for the
whole set of transition probabilities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_data_multi_state(
  data,
  id = "id",
  prog = "prog",
  death = "death",
  prog_t = "prog_t",
  death_t = "death_t",
  keep = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_data_multi_state_+3A_data">data</code></td>
<td>
<p>dataset containing the full ILD with information on both
progression and death. Can be a data.frame or a tibble</p>
</td></tr>
<tr><td><code id="make_data_multi_state_+3A_id">id</code></td>
<td>
<p>The column with the individual identifier. Can be NULL (in
which case, it will be created from scratch)</p>
</td></tr>
<tr><td><code id="make_data_multi_state_+3A_prog">prog</code></td>
<td>
<p>The progression indicator: takes value 1 if the individual
has progressed and 0 otherwise. Defaults to the column named 'prog' in
the dataset</p>
</td></tr>
<tr><td><code id="make_data_multi_state_+3A_death">death</code></td>
<td>
<p>The death indicator: takes value 1 if the individual
has died and 0 otherwise. Defaults to the column named 'death' in
the dataset</p>
</td></tr>
<tr><td><code id="make_data_multi_state_+3A_prog_t">prog_t</code></td>
<td>
<p>The progression time. Defaults to the column named
'prog_t' in the dataset</p>
</td></tr>
<tr><td><code id="make_data_multi_state_+3A_death_t">death_t</code></td>
<td>
<p>The death time. Defaults to the column named
'death_t' in the dataset</p>
</td></tr>
<tr><td><code id="make_data_multi_state_+3A_keep">keep</code></td>
<td>
<p>A vector of strings with the names of the additional
variables from the original dataset to keep into the multistate
dataset. If 'NULL' (default), then keeps all</p>
</td></tr>
<tr><td><code id="make_data_multi_state_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble containing the event history for each individual
and with the following variables: id = Patients ID; from = Initial
state (1=Pre-progression, 2=Progression, 3=Death); to = End state
(1=Pre-progression, 2=Progression, 3=Death); trans = Transition ID:
1=Pre-progression -&gt; Progression; 2=Pre-Progression -&gt; Death;
3=Progression -&gt; Death; Tstart = Entry time (either entry or
progression); Tstop = Exit time (time of event or censoring time);
status = Event indicator (1=yes, 0=censored), <strong>for the specific
event under consideration</strong>; treat = Treatment indicator
All the other original variables are appended to these, but can be
removed
</p>


<h3>Note</h3>

<p>Something will go here
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Something will go here
</p>


<h3>See Also</h3>

<p>Something will go here
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Something will go here

## End(Not run)

</code></pre>

<hr>
<h2 id='make_newdata'>Creates a 'newdata' list to modify the plots for specific individual
profiles (with respect to the covariates)</h2><span id='topic+make_newdata'></span>

<h3>Description</h3>

<p>Creates a 'newdata' list to modify the plots for specific individual
profiles (with respect to the covariates)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_newdata(data, vars, conts = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_newdata_+3A_data">data</code></td>
<td>
<p>The original dataset that has been used as input to the call
to 'fit.models'</p>
</td></tr>
<tr><td><code id="make_newdata_+3A_vars">vars</code></td>
<td>
<p>A vector of strings, including the names of the variables that
are to be used to construct specific profiles of individual covariates</p>
</td></tr>
<tr><td><code id="make_newdata_+3A_conts">conts</code></td>
<td>
<p>A subset of 'vars', which include the named covariates that
are continuous. These will be averaged over, while for the remaining
covariates (assumed to be factors), the specific profiles will be listed.
Defaults to NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>newdata</code></td>
<td>
<p>The list 'newdata' to be passed as optional argument
to a call to the 'plot' method</p>
</td></tr>
<tr><td><code>labs</code></td>
<td>
<p>A vector of labels (say to use in the plot, for each
profile)</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Something will go here
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(bc)

# Fits a model using the 'bc' data
mle = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr="exp",method="mle")
# Now makes the default plot
plot(mle)
# Now creates a 'newdata' list to modify the plot for selected profiles
newdata=make_newdata(data=bc,vars="group")
# And can plot, say, only two of the three treatment arms
plot(mle,newdata=newdata$newdata[c(1,3)],lab.profile=newdata$labs[c(1,3)])

## End(Not run)

</code></pre>

<hr>
<h2 id='make.ipd'>Create an individual level dataset from digitised data</h2><span id='topic+make.ipd'></span>

<h3>Description</h3>

<p>Piles in the simulated IPD resulting from running digitise for more than one
treatment arm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.ipd(ipd_files, ctr = 1, var.labs = c("time", "event", "arm"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.ipd_+3A_ipd_files">ipd_files</code></td>
<td>
<p>a list including the names of the IPD files created as
output of digitise</p>
</td></tr>
<tr><td><code id="make.ipd_+3A_ctr">ctr</code></td>
<td>
<p>the index of the file associated with the control arm (default,
the first file). This will be coded as 0</p>
</td></tr>
<tr><td><code id="make.ipd_+3A_var.labs">var.labs</code></td>
<td>
<p>a vector of labels for the column of the resulting data
matrix. NB these should match the arguments to the formula specified for
fit.models. The user can specify values. These should be 4 elements (ID,
TIME, EVENT, ARM)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Something will go here
</p>


<h3>See Also</h3>

<p>Something will go here
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Defines the txt files to be used as inputs
surv.inp &lt;- system.file("extdata", "survival.txt", package = "survHE")
nrisk.inp &lt;- system.file("extdata", "nrisk.txt", package = "survHE")
# Runs 'digitise' to create the relevant output files
digitise(surv.inp, nrisk.inp, ipd_output = "IPD.txt")
# Now uses 'make.ipd' to create the pseudo-data
make.ipd("IPD.txt", ctr = 1, var.labs = c("time", "event", "arm"))

## End(Not run)
</code></pre>

<hr>
<h2 id='make.surv'>Engine for Probabilistic Sensitivity Analysis on the survival curves</h2><span id='topic+make.surv'></span>

<h3>Description</h3>

<p>Creates the survival curves for the fitted model(s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.surv(fit, mod = 1, t = NULL, newdata = NULL, nsim = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.surv_+3A_fit">fit</code></td>
<td>
<p>the result of the call to the <code>fit.models</code> function,
containing the model fitting (and other relevant information)</p>
</td></tr>
<tr><td><code id="make.surv_+3A_mod">mod</code></td>
<td>
<p>the index of the model. Default value is 1, but the user can
choose which model fit to visualise, if the call to <code>fit.models</code> has a vector
argument for <code>distr</code> (so many models are fitted &amp; stored in the same object)</p>
</td></tr>
<tr><td><code id="make.surv_+3A_t">t</code></td>
<td>
<p>the time vector to be used for the estimation of the survival curve</p>
</td></tr>
<tr><td><code id="make.surv_+3A_newdata">newdata</code></td>
<td>
<p>a list (of lists), specifying the values of the covariates
at which the computation is performed. For example
<code>list(list(arm=0),list(arm=1))</code> will create two survival curves, one
obtained by setting the covariate <code>arm</code> to the value 0 and the other by
setting it to the value 1. In line with <code>flexsurv</code> notation, the user
needs to either specify the value for <em>all</em> the covariates or for none (in
which case, <code>newdata=NULL</code>, which is the default). If some value is
specified and at least one of the covariates is continuous, then a single
survival curve will be computed in correspondence of the average values of
all the covariates (including the factors, which in this case are expanded
into indicators).</p>
</td></tr>
<tr><td><code id="make.surv_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulations from the distribution of the survival
curves. Default at <code>nsim=1</code>, in which case uses the point estimate for
the relevant distributional parameters and computes the resulting survival
curve</p>
</td></tr>
<tr><td><code id="make.surv_+3A_...">...</code></td>
<td>
<p>Additional options</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>G Baio (2019). survHE: Survival analysis for health economic evaluation
and cost-effectiveness modelling. Journal of Statistical Software (2020). vol 95,
14, 1-47. <a href="doi:10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.models">fit.models</a></code>, <code><a href="#topic+psa.plot">psa.plot</a></code>, <code><a href="#topic+write.surv">write.surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
# Loads an example dataset from 'flexsurv'
data(bc)

# Fits the same model using the 3 inference methods
mle &lt;- fit.models(formula=Surv(recyrs,censrec) ~ group, data=bc,
                  distr="exp", method="mle")
p.mle &lt;- make.surv(mle)
psa.plot(p.mle)

# Can also use the main 'plot' function to visualise the survival curves
# and include uncertainty by using a number 'nsim' of simulations
plot(mle, nsim=10)

## End(Not run)

</code></pre>

<hr>
<h2 id='make.transition.probs'>make.transition.probs</h2><span id='topic+make.transition.probs'></span>

<h3>Description</h3>

<p>Computes the transition probabilities (to be passed to a Markov model) from
the cumulative hazard curves obtained using <code>fit.models</code>, using the formula
p(t)=1-exp(H(t-k)/H(t)), where k is the Markov model cycle length (or the
difference across two consecutive times) and t is a generic time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.transition.probs(fit, labs = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.transition.probs_+3A_fit">fit</code></td>
<td>
<p>an object obtained as output of the call to <code>fit.models</code></p>
</td></tr>
<tr><td><code id="make.transition.probs_+3A_labs">labs</code></td>
<td>
<p>a vector with labels to identify the 'profiles' ie the
combination of covariates that have been passed onto the model formula.
If 'NULL' (default), then figures it out from the 'survHE' object.</p>
</td></tr>
<tr><td><code id="make.transition.probs_+3A_...">...</code></td>
<td>
<p>additional arguments. Includes the standard inputs to the
call to <code>make.surv</code>, so <code>mod</code> (the index of the possibly many
models stored in the 'survHE' object), <code>t</code> (the vector of times
over which to compute the survival curves), <code>newdata</code> (a list that
defines the profile of covariates) and <code>nsim</code> (the number of
simulations to use - default is <code>nsim</code>=1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble 'lambda' with an indicator for the treatment arm,
the times at which the probabilities have been computed and <code>nsim</code>
columns each with a simulation of the transition probabilities for
all the times specified by the user
</p>


<h3>Note</h3>

<p>Something will go here
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Something will go here
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.surv">make.surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Something will go here

## End(Not run)

</code></pre>

<hr>
<h2 id='markov_trace'>Markov trace</h2><span id='topic+markov_trace'></span>

<h3>Description</h3>

<p>Plots the Markov Trace from an object generated using <code>three_state_mm</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>markov_trace(mm, interventions = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="markov_trace_+3A_mm">mm</code></td>
<td>
<p>The output of a call to <code>three_state_mm</code></p>
</td></tr>
<tr><td><code id="markov_trace_+3A_interventions">interventions</code></td>
<td>
<p>A vector of labels for the interventions</p>
</td></tr>
<tr><td><code id="markov_trace_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot
</p>


<h3>Note</h3>

<p>Something will go here
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Something will go here
</p>


<h3>See Also</h3>

<p>make.surv, three_state_mm
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Something will go here

## End(Not run)

</code></pre>

<hr>
<h2 id='model.fit.plot'>Graphical representation of the measures of model fitting based on
Information Criteria</h2><span id='topic+model.fit.plot'></span>

<h3>Description</h3>

<p>Plots a summary of the model fit for all the models fitted
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model.fit.plot(..., type = "aic", scale = "absolute", stacked = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model.fit.plot_+3A_...">...</code></td>
<td>
<p>Optional inputs. Must include at least one <code>survHE</code> object.</p>
</td></tr>
<tr><td><code id="model.fit.plot_+3A_type">type</code></td>
<td>
<p>should the AIC, the BIC or the DIC plotted? (values = <code>"aic"</code>,
<code>"bic"</code> or <code>"dic"</code>)</p>
</td></tr>
<tr><td><code id="model.fit.plot_+3A_scale">scale</code></td>
<td>
<p>If <code>scale='absolute'</code> (default), then plot the absolute value
of the *IC. If <code>scale='relative'</code> then plot a rescaled version taking
the percentage increase in the *IC in comparison with the best-fitting model</p>
</td></tr>
<tr><td><code id="model.fit.plot_+3A_stacked">stacked</code></td>
<td>
<p>Should the bars be stacked and grouped by survHE object? (default=F)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Something will go here
</p>


<h3>Value</h3>

<p>A plot with the relevant model fitting statistics
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>G Baio (2019). survHE: Survival analysis for health economic evaluation
and cost-effectiveness modelling. Journal of Statistical Software (2020). vol 95,
14, 1-47. <a href="doi:10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>
</p>


<h3>See Also</h3>

<p><code>fit.models</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
data(bc)

mle = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr=c("exp","wei","lno"),method="mle")
model.fit.plot(mle)

## End(Not run)

</code></pre>

<hr>
<h2 id='msmdata'>NICE TA174 dataset in multi-state format.</h2><span id='topic+msmdata'></span>

<h3>Description</h3>

<p>These are the same data contained in NICE TA174, as
made publicly available as part of the supplementary
material for Williams et al (2017). Medical Decision
Making, 37;427-439. However, the data have been
restructured (by using the function <code>make_data_multi_state()</code>)
to be used for multi-state analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msmdata
</code></pre>


<h3>Format</h3>

<p>A tibble with 1868 rows and 16 variables:
</p>

<dl>
<dt>id</dt><dd><p>A numeric patient identifier</p>
</dd>
<dt>from</dt><dd><p>An indicator of the starting state.
1=Pre-progression; 2=Progression; 3=Death</p>
</dd>
<dt>to</dt><dd><p>An indicator for the arriving state</p>
</dd>
<dt>trans</dt><dd><p>A code for the actual transition considered.
1=Pre-progression -&gt; Progression; 2=Pre-progression -&gt;
Death; 3=Progression -&gt; Death</p>
</dd>
<dt>Tstart</dt><dd><p>The time of entry into the observation</p>
</dd>
<dt>Tstop</dt><dd><p>The time of exit from observation</p>
</dd>
<dt>time</dt><dd><p>The observed time until even (progression or
death), or censoring occurs</p>
</dd>
<dt>status</dt><dd><p>The event indicator; takes value 1 if the
underlying event (which varies depending on which
transition is being considered) happens and 0 otherwise</p>
</dd>
<dt>treat</dt><dd><p>The treatment indicator. 1=rituximab
in combination with fludarabine andcyclophosphamide
(RFC); 0=fludarabine and cyclo-phosphamide alone (FC)</p>
</dd>
<dt>patid</dt><dd><p>The original numeric patient identifier</p>
</dd>
<dt>prog</dt><dd><p>The original indicator to describe whether
the patient has experience a progression</p>
</dd>
<dt>death</dt><dd><p>The original indicator to describe whether
the patient has experience death</p>
</dd>
<dt>prog_t</dt><dd><p>The original observed time at progression,
or the time at which the patient has been censored;
measured in months</p>
</dd>
<dt>death_t</dt><dd><p>The original observed time at death, or
the time at which the patient has been censored;
measured in months</p>
</dd>
<dt>prog_ty</dt><dd><p>The original observed time at progression,
or the time at which the patient has been censored;
measured in years</p>
</dd>
<dt>death_ty</dt><dd><p>The original observed time at death, or
the time at which the patient has been censored;
measured in years</p>
</dd>
</dl>


<hr>
<h2 id='plot_transformed_km'>Plot to assess suitability of parametric model</h2><span id='topic+plot_transformed_km'></span>

<h3>Description</h3>

<p>Perform an exploratory investigation for linearity of
transformed survival models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_transformed_km(fit, mod = 1, add_legend = FALSE, graph = "base", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_transformed_km_+3A_fit">fit</code></td>
<td>
<p>An object of class survHE.</p>
</td></tr>
<tr><td><code id="plot_transformed_km_+3A_mod">mod</code></td>
<td>
<p>Index or name of a model in fit. Defaults to 1.</p>
</td></tr>
<tr><td><code id="plot_transformed_km_+3A_add_legend">add_legend</code></td>
<td>
<p>If <code>TRUE</code>, labels assumptions. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_transformed_km_+3A_graph">graph</code></td>
<td>
<p>Type of plot: base or ggplot2.</p>
</td></tr>
<tr><td><code id="plot_transformed_km_+3A_...">...</code></td>
<td>
<p>Further arguments, passed on to plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the Weibull, twice taking logs of the survivor function
</p>
<p style="text-align: center;"><code class="reqn">log(-log S(t)) = log \lambda + \gamma log t</code>
</p>

<p>A plot of <code class="reqn">log(-log S(t))</code> against <code class="reqn">log(t)</code> would give an approximately
straight line if the Weibull assumption is reasonable.
The plot could also be used to give a rough estimate of the parameters.
</p>
<p>Similarly, for the log-logistic distribution
</p>
<p style="text-align: center;"><code class="reqn">logS(t)/(1 - S(t)) = \theta - \kappa log t</code>
</p>

<p>For the log-normal distribution
</p>
<p style="text-align: center;"><code class="reqn">\Phi^{-1} (1 - S(t)) = (log t - \mu) / \sigma</code>
</p>

<p>We can also check the assumption made with using the Cox regression model
of proportional hazards by inspecting the log-cumulative hazard plot.
</p>
<p style="text-align: center;"><code class="reqn">log H_i(t) = \beta x_i + log H_0(t)</code>
</p>

<p>The transformed curves for different values of the explanatory variables
will be parallel if PH holds.
</p>


<h3>Value</h3>

<p>Diagnostic plot
</p>


<h3>Author(s)</h3>

<p>William Browne, Nathan Green
</p>


<h3>References</h3>

<p>Collett (2015) Modelling Survival Data in Medical Research, CRC Press
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(bc)
form &lt;- formula("Surv(recyrs, censrec) ~ group")

# exponential distribution
fit_exp &lt;- fit.models(form, data = bc,
                  distr = "exp", method = "mle")
plot_transformed_km(fit_exp)
plot_transformed_km(fit_exp, graph = "ggplot2")
                 
# weibull distribution
fit_wei &lt;- fit.models(form, data = bc,
                  distr = "weibull", method = "mle")
plot_transformed_km(fit_wei)
plot_transformed_km(fit_wei, graph = "ggplot2")
                 
# loglogistic distribution
fit_llog &lt;- fit.models(form, data = bc,
                  distr = "loglogistic", method = "mle")
plot_transformed_km(fit_llog)
plot_transformed_km(fit_llog, graph = "ggplot2")
                 
# lognormal distribution
fit_lnorm &lt;- fit.models(form, data = bc,
                  distr = "lognormal", method = "mle")
plot_transformed_km(fit_lnorm)
plot_transformed_km(fit_lnorm, graph = "ggplot2")

## for only one group
form &lt;- formula("Surv(recyrs, censrec) ~ 1")

fit_exp &lt;- fit.models(form, data = bc,
                  distr = "exp", method = "mle")
plot_transformed_km(fit_exp)
plot_transformed_km(fit_exp, graph = "ggplot2")

</code></pre>

<hr>
<h2 id='plot.survHE'>Plot survival curves for the models fitted using <code>fit.models</code></h2><span id='topic+plot.survHE'></span>

<h3>Description</h3>

<p>Plots the results of model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survHE'
plot(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.survHE_+3A_...">...</code></td>
<td>
<p>Must include at least one result object saved as
the call to the <code>fit.models</code> function. Nay include other
optional parameters. These include whether the KM curve should be
added <code>add.km</code> and whether the user specifies a profile of covariates
(in the list <code>newdata</code>). Other possibilities are additional
(mainly graphical) options. These are:
</p>

<ul>
<li> <p><code>xlab</code> = a string with the label for the x-axis (default = &quot;time&quot;)
</p>
</li>
<li> <p><code>ylab</code> = a string with the label for the y-axis (default = &quot;Survival&quot;)
</p>
</li>
<li> <p><code>lab.profile</code> = a (vector of) string(s) indicating the labels associated with the strata defining the different
survival curves to plot. Default to the value used by the Kaplan Meier
estimate given in <code>fit.models</code>.
</p>
</li>
<li> <p><code>newdata</code> = a list (of lists) providing the values for the relevant covariates If NULL, then will use
the mean values for the covariates if at least one is a continuous variable,
or the combination of the categorical covariates.
</p>
</li>
<li> <p><code>xlim</code> = a vector  determining the limits for the x-axis
</p>
</li>
<li> <p><code>colors</code> = a vector of characters defining the colours in which to plot the different survival curves
</p>
</li>
<li> <p><code>what</code> = a string indicating whether the survival, hazard or
cumulative hazard curve should be plotted. Defaults to 'survival', but the
other two options can be specified as 'hazard' or 'cumhazard'
</p>
</li>
<li> <p><code>lab.profile</code> = a vector of characters defining the names of the models fitted
</p>
</li>
<li> <p><code>add.km</code> = TRUE (whether to also add the Kaplan Meier estimates of the data)
</p>
</li>
<li> <p><code>annotate</code> = FALSE (whether to also add text to highlight the observed vs
extrapolated data)
</p>
</li>
<li> <p><code>legend.position</code> = a vector of proportions to place the legend. Default
to 'c(.75,.9)', which means 75% across the x-axis and 90% across the y-axis
</p>
</li>
<li> <p><code>legend.title</code> = suitable instructions to format the title of the legend;
defaults to 'element_text(size=15,face=&quot;bold&quot;)' but there may be other
arguments that can be added (using 'ggplot' facilities)
</p>
</li>
<li> <p><code>legend.text</code> = suitable instructions to format the text of the legend;
defaults to 'element_text(colour=&quot;black&quot;, size=14, face=&quot;plain&quot;)' but there
may be other arguments that can be added (using 'ggplot' facilities)
</p>
</li></ul>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>G Baio (2019). survHE: Survival analysis for health economic evaluation
and cost-effectiveness modelling. Journal of Statistical Software (2020). vol 95,
14, 1-47. <a href="doi:10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit.models">fit.models</a></code>, <code><a href="#topic+write.surv">write.surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(bc)

mle = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr="exp",method="mle")
inla = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr="exp",method="inla")
plot(MLE=mle,INLA=inla)

## End(Not run)

</code></pre>

<hr>
<h2 id='print.survHE'>Print a summary of the survival model(s) fitted by <code>fit.models</code></h2><span id='topic+print.survHE'></span>

<h3>Description</h3>

<p>Prints the summary table for the model(s) fitted, with the estimate of the
parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survHE'
print(x, mod = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.survHE_+3A_x">x</code></td>
<td>
<p>the <code>survHE</code> object (the output of the call to
<code>fit.models</code>)</p>
</td></tr>
<tr><td><code id="print.survHE_+3A_mod">mod</code></td>
<td>
<p>is the index of the model. Default value is 1, but the user can
choose which model fit to visualise, if the call to fit.models has a vector
argument for distr (so many models are fitted &amp; stored in the same object)</p>
</td></tr>
<tr><td><code id="print.survHE_+3A_...">...</code></td>
<td>
<p>additional options, including: <code>digits</code> = number of
significant digits to be shown in the summary table (default = 6)
<code>original</code> = a flag to say whether the <em>original</em> table
from either <code>flexsurv</code> or <code>INLA</code> or <code>rstan</code> should be printed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>G Baio (2019). survHE: Survival analysis for health economic evaluation
and cost-effectiveness modelling. Journal of Statistical Software (2020). vol 95,
14, 1-47. <a href="doi:10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
data(bc)

mle = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr="exp",method="mle")
print(mle)

## End(Not run)

</code></pre>

<hr>
<h2 id='psa.plot'>Graphical depiction of the probabilistic sensitivity analysis for the
survival curves</h2><span id='topic+psa.plot'></span>

<h3>Description</h3>

<p>Plots the survival curves for all the PSA simulations. The function is
actually deprecated - similar graphs can be obtained directly using
the <code>plot</code> method (with options), which allows a finer depiction
of the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psa.plot(psa, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="psa.plot_+3A_psa">psa</code></td>
<td>
<p>the result of the call to the function <code>make.surv</code></p>
</td></tr>
<tr><td><code id="psa.plot_+3A_...">...</code></td>
<td>
<p>Optional graphical parameters, such as:
</p>

<ul>
<li> <p><code>xlab</code> = label for the x-axis
</p>
</li>
<li> <p><code>ylab</code> = label for the y-axis
</p>
</li>
<li> <p><code>col</code> = (vector) of colours for the lines to be plotted
</p>
</li>
<li> <p><code>alpha</code> = the level of transparency for the curves (default = 0.2)
</p>
</li></ul>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>G Baio (2019). survHE: Survival analysis for health economic evaluation
and cost-effectiveness modelling. Journal of Statistical Software (2020). vol 95,
14, 1-47. <a href="doi:10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.surv">make.surv</a></code>, <code><a href="#topic+write.surv">write.surv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
data(bc)

# Fits the same model using the 3 inference methods
mle = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr="exp",method="mle")
p.mle = make.surv(mle,nsim=100)
psa.plot(p.mle)

## End(Not run)

</code></pre>

<hr>
<h2 id='summary.survHE'>Prints a summary table for the distribution the mean survival time for a
given model and data</h2><span id='topic+summary.survHE'></span>

<h3>Description</h3>

<p>Calculates the mean survival time as the area under the survival curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survHE'
summary(object, mod = 1, t = NULL, nsim = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.survHE_+3A_object">object</code></td>
<td>
<p>a <code>survHE</code> object (resulting from the call to
<code>fit.models</code></p>
</td></tr>
<tr><td><code id="summary.survHE_+3A_mod">mod</code></td>
<td>
<p>the model to be analysed (default = 1)</p>
</td></tr>
<tr><td><code id="summary.survHE_+3A_t">t</code></td>
<td>
<p>the vector of times to be used in the computation. Default = NULL,
which means the observed times will be used. NB: the vector of times should
be: i) long enough so that S(t) goes to 0; and ii) dense enough so that the
approximation to the AUC is sufficiently precise</p>
</td></tr>
<tr><td><code id="summary.survHE_+3A_nsim">nsim</code></td>
<td>
<p>the number of simulations from the survival curve distributions
to be used (to compute interval estimates)</p>
</td></tr>
<tr><td><code id="summary.survHE_+3A_...">...</code></td>
<td>
<p>Additional options</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A list comprising of the following elements
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mean.surv</code></td>
<td>
<p> A matrix with the simulated values for the mean
survival times </p>
</td></tr> <tr><td><code>tab</code></td>
<td>
<p> A summary table </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>G Baio (2019). survHE: Survival analysis for health economic evaluation
and cost-effectiveness modelling. Journal of Statistical Software (2020). vol 95,
14, 1-47. <a href="doi:10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>
</p>


<h3>See Also</h3>

<p><code>fit.models</code>, <code>make.surv</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(bc)

mle = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr="exp",method="mle")
summary(mle,nsim=100)

## End(Not run)

</code></pre>

<hr>
<h2 id='ta174'>NICE TA174 dataset.</h2><span id='topic+ta174'></span>

<h3>Description</h3>

<p>A dataset containing the data used for NICE TA174, as
made publicly available as part of the supplementary
material for Williams et al (2017). Medical Decision
Making, 37;427-439.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ta174
</code></pre>


<h3>Format</h3>

<p>A tibble with 810 rows and 8 variables:
</p>

<dl>
<dt>patid</dt><dd><p>A numeric patient identifier</p>
</dd>
<dt>treat</dt><dd><p>The treatment indicator. 1=rituximab
in combination with fludarabine andcyclophosphamide
(RFC); 0=fludarabine and cyclo-phosphamide alone (FC)</p>
</dd>
<dt>prog</dt><dd><p>An indicator to describe whether the
patient has experience a progression</p>
</dd>
<dt>death</dt><dd><p>An indicator to describe whether the
patient has experience death</p>
</dd>
<dt>prog_t</dt><dd><p>The observed time at progression, or
the time at which the patient has been censored;
measured in months</p>
</dd>
<dt>death_t</dt><dd><p>The observed time at death, or
the time at which the patient has been censored;
measured in months</p>
</dd>
<dt>prog_ty</dt><dd><p>The observed time at progression, or
the time at which the patient has been censored;
measured in years</p>
</dd>
<dt>death_ty</dt><dd><p>The observed time at death, or
the time at which the patient has been censored;
measured in years</p>
</dd>
</dl>


<hr>
<h2 id='three_state_mm'>three_state_mm</h2><span id='topic+three_state_mm'></span>

<h3>Description</h3>

<p>General purpose function to run a standard three-state Markov model
(typically used in cancer modelling). The states are typically
'Pre-progression', 'Progressed' and 'Death'. No backward transition
from 'Progressed' to 'Pre-progression' is allowed and 'Death' is
obviously an absorbing state. All other transitions are possible.
The crucial assumption is that <em>individual-level data</em> are available
recording an indicator and the time of progression and death for each
individual. The function returns the full transition matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>three_state_mm(
  m_12,
  m_13,
  m_23,
  nsim = 1,
  start = c(1000, 0, 0),
  basecase = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="three_state_mm_+3A_m_12">m_12</code></td>
<td>
<p>A 'survHE' object (output to a call to <code>fit.models</code>)
estimating the parameters of a model for the transition from
'Pre-progression' (state 1) to 'Progressed' (state 2). Given the
individual level data with the complete event history (in the object
'data'), can be done with a call like 'x=make_data_multi_state(data)'
and then <code>fit.models(Surv(time,status)~...,data=x %&gt;% filter(trans==1),...)</code></p>
</td></tr>
<tr><td><code id="three_state_mm_+3A_m_13">m_13</code></td>
<td>
<p>A 'survHE' object (output to a call to <code>fit.models</code>)
estimating the parameters of a model for the transition from
'Pre-progression' (state 1) to 'Death' (state 3).  Given the
individual level data with the complete event history (in the object
'data'), can be done with a call like 'x=make_data_multi_state(data)'
and then <code>fit.models(Surv(time,status)~...,data=x %&gt;% filter(trans==2),...)</code></p>
</td></tr>
<tr><td><code id="three_state_mm_+3A_m_23">m_23</code></td>
<td>
<p>A 'survHE' object (output to a call to <code>fit.models</code>)
estimating the parameters of a model for the transition from
'Progressed' (state 2) to 'Death' (state 3).  Given the
individual level data with the complete event history (in the object
'data'), can be done with a call like 'x=make_data_multi_state(data)'
and then <code>fit.models(Surv(time,status)~...,data=x %&gt;% filter(trans==3),...)</code></p>
</td></tr>
<tr><td><code id="three_state_mm_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulations for the model parameters that are
used to compute the survival curves. Defaults to <code>nsim</code>=1,
which simply creates one survival curve for each treatment arm.</p>
</td></tr>
<tr><td><code id="three_state_mm_+3A_start">start</code></td>
<td>
<p>A vector of initial state occupancy. By default assumes 1000
individuals, all initially allocated to 'Pre-progression'</p>
</td></tr>
<tr><td><code id="three_state_mm_+3A_basecase">basecase</code></td>
<td>
<p>Should the base case be computed as well, based on the
point estimate of the underlying model parameters? (Default=FALSE)</p>
</td></tr>
<tr><td><code id="three_state_mm_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list including the state occupancy simulations in an object 'm'.
This is a tibble with the number of individuals in each of the 3 states
at each of the times specified by the user. If <code>nsim</code>&gt;1, then the tibble
also contains a simulation index to keep track of that. The list also
includes the computation time to obtain the state occupancy tibble (in the
object 'running_time'). If <code>basecase==TRUE</code>, then the function also
computes the &quot;base case scenario&quot; (based on 1 simulation from of the
underlying survival curves, i.e. the point estimate of the model parameters)
and stores it in the object 'base_case'
</p>


<h3>Note</h3>

<p>Something will go here
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Something will go here
</p>


<h3>See Also</h3>

<p>make.transition.probs make_data_multi_state
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Something will go here

## End(Not run)

</code></pre>

<hr>
<h2 id='write.surv'>write.surv</h2><span id='topic+write.surv'></span>

<h3>Description</h3>

<p>Writes the survival summary to an excel file (helpful to then call the
values in the Markov model)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.surv(object, file, sheet = NULL, what = "surv")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.surv_+3A_object">object</code></td>
<td>
<p>a summary.flexsurvreg object containing the survival curves
(with times, estimates and interval limits)</p>
</td></tr>
<tr><td><code id="write.surv_+3A_file">file</code></td>
<td>
<p>a string with the full path to the file name to be saved</p>
</td></tr>
<tr><td><code id="write.surv_+3A_sheet">sheet</code></td>
<td>
<p>a string with the name of the sheet to be created</p>
</td></tr>
<tr><td><code id="write.surv_+3A_what">what</code></td>
<td>
<p>a string to describe what to be exported. Can either be
'surv' (default), which outputs the simulation(s) for the survival curves
or 'sim', which outputs the simulation(s) for the underlying model
parameters. If there are several 'profiles', they get written in
separate spreadsheets and a clear indication is given as the name of the
spreadsheet</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Something will go here
</p>


<h3>Value</h3>

<p>A spreadsheet file with the simulation(s) of the relevant quantity
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>G Baio (2019). survHE: Survival analysis for health economic evaluation
and cost-effectiveness modelling. Journal of Statistical Software (2020). vol 95,
14, 1-47. <a href="doi:10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>
</p>


<h3>See Also</h3>

<p><code>make.surv</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Loads an example dataset from 'flexsurv'
data(bc)

# Fits the same model using the 3 inference methods
mle = fit.models(formula=Surv(recyrs,censrec)~group,data=bc,
    distr="exp",method="mle")
p.mle = make.surv(mle)
write.surv(p.mle,file="test.xlsx")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
