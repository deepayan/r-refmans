<!DOCTYPE html><html><head><title>Help for package SemiMarkov</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SemiMarkov}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#asthma'><p>Asthma control data</p></a></li>
<li><a href='#hazard'>
<p>Computes hazard rates using an object of class <code>semiMarkov</code> or <code>param.init</code></p></a></li>
<li><a href='#param.init'>
<p>Defines the initial values of  parameters for a semi-Markov model</p></a></li>
<li><a href='#plot.hazard'>
<p>Plot method for objects of class <code>hazard</code></p></a></li>
<li><a href='#print.hazard'>
<p>Print method for object of class <code>hazard</code></p></a></li>
<li><a href='#print.semiMarkov'>
<p>Print method for object of class <code>semiMarkov</code></p></a></li>
<li><a href='#semiMarkov'>
<p>Parametric estimation in multi-state semi-Markov models</p></a></li>
<li><a href='#summary.hazard'>
<p>Summary method for objects of class <code>hazard</code></p></a></li>
<li><a href='#summary.semiMarkov'>
<p>Summary method for objects of class <code>semiMarkov</code></p></a></li>
<li><a href='#table.state'>
<p>Table giving the numbers of observed transitions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multi-States Semi-Markov Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-06-27</td>
</tr>
<tr>
<td>Author:</td>
<td>Agnieszka Listwon-Krol, Philippe Saint-Pierre</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Agnieszka Listwon-Krol &lt;krol@lunenfeld.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for fitting multi-state semi-Markov models to longitudinal data. A parametric maximum likelihood estimation method adapted to deal with Exponential, Weibull and Exponentiated Weibull distributions is considered. Right-censoring can be taken into account and both constant and time-varying covariates can be included using a Cox proportional model. Reference: A. Krol and P. Saint-Pierre (2015) 	&lt;<a href="https://doi.org/10.18637%2Fjss.v066.i06">doi:10.18637/jss.v066.i06</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0), numDeriv, MASS, Rsolnp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-07-02 10:49:51 UTC; agnie</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-07-02 11:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='asthma'>Asthma control data</h2><span id='topic+asthma'></span>

<h3>Description</h3>

<p>Data from a follow-up study of severe asthmatic patients. At each visit, covariates are recorded and asthma was evaluated using the concept of control scores. 
Such scores reflect a global judgement of the disease gravity based on official criteria. Three levels are considered (optimal, suboptimal and unacceptable control) 
and can be used to define the subject's state at each visit. The aim is to investigate the evolution of asthma control and to evaluate the effect of covariates.
The data contains an extraction of 371 patients with at least two visits. The table is presented in long format with one row for each observed transition between two states. 
The rows corresponding to the same subject are ordered chronologically. The last sojourn time is right-censored by the end of the study and represent the time until censoring. A censored transition is defined as a transition to the same state <code>h-&gt;h</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(asthma)</code></pre>


<h3>Format</h3>

<p>A data frame containing 928 rows. 
Each row represents a patient examination and contains several covariates.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Patient identification number</p>
</dd>
<dt><code>state.h</code></dt><dd><p>Starting state (1 for optimal, 2 for suboptimal and 3 for unacceptable control state)</p>
</dd>
<dt><code>state.j</code></dt><dd><p>Arrival state (1 for optimal, 2 for suboptimal and 3 for unacceptable control state)</p>
</dd>
<dt><code>time</code></dt><dd><p>Waiting (sojourn) time in state <code>state.h</code></p>
</dd>
<dt><code>Severity</code></dt><dd><p>Disease severity (1=severe, 0=mild-moderate asthma)</p>
</dd>
<dt><code>BMI</code></dt><dd><p>Body Mass Index (1=BMI&gt;=25, 0=otherwise)</p>
</dd>
<dt><code>Sex</code></dt><dd><p>Sex (1=men, 0=women)</p>
</dd>
</dl>

<p>This presentation of the data implies that, for a given patient, the visited states are the sequence of <code>state.h</code> 
and the follow-up time is the the cumulated sum of <code>time</code>.
</p>


<h3>Source</h3>

<p>ARIA (Association pour la Recherche en Intelligence Artificielle), France.
</p>


<h3>References</h3>

<p>Saint-Pierre P., Combescure C., Daures J.P., Godard P. (2003). The analysis of
asthma control under a Markov assumption with use of covariates. <em>Statistics in Medicine</em>,
22(24):3755-70.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(asthma)
head(asthma)
</code></pre>

<hr>
<h2 id='hazard'>
Computes hazard rates using an object of class <code>semiMarkov</code> or <code>param.init</code>
</h2><span id='topic+hazard'></span>

<h3>Description</h3>

<p>For a given vector of times, the function computes the hazard rates values of an object of class <code>semiMarkov</code> or <code>param.init</code> (which provided the hazard rates). Both, values of hazard rate of waiting time of semi-Markov process can be obtained.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hazard(object, type = "alpha", time = NULL,
      cov = NULL, s = 0, t = "last", Length = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hazard_+3A_object">object</code></td>
<td>

<p>Object of class <code>semiMarkov</code> or <code>param.init</code>. 
</p>
</td></tr>
<tr><td><code id="hazard_+3A_type">type</code></td>
<td>

<p>Type of hazard to be computed: <code>"alpha"</code> for the hazard rates of waiting times of the embedded Markov chain and
<code>"lambda"</code> for the hazard rates of the semi-Markov process. Default is <code>"alpha"</code>. 
</p>
</td></tr>
<tr><td><code id="hazard_+3A_time">time</code></td>
<td>

<p>A vector containing the time values for which the hazard rate is computed.
Default value is a vector <code>seq(0, last, length = Length)</code> where <code>last</code> is the largest duration observed in the data set and <code>Length</code> is the length of the vector.
</p>
</td></tr>
<tr><td><code id="hazard_+3A_cov">cov</code></td>
<td>

<p>A list with one component for each covariate. Each component gives values of covariates that are to be used for the hazard rates computation. For a time-fixed covariate a single value can be given whereas a whole vector of values is required for time dependent covariates. Default is <code>NULL</code> which corresponds to time-independent covariates all equal to 0. Note that the same covariates values are used for all transitions.
</p>
</td></tr>
<tr><td><code id="hazard_+3A_s">s</code></td>
<td>

<p>Starting value of the time interval <code class="reqn">[s, t]</code> which is used to compute the hazard rate. This argument is not considered when the vector <code>time</code> is defined. Default value is 0.
</p>
</td></tr>
<tr><td><code id="hazard_+3A_t">t</code></td>
<td>

<p>Ending value of the time interval <code class="reqn">[s, t]</code> which is used to compute the hazard rate. This argument is not considered when the vector <code>time</code> is defined. Default value is <code>last</code> which is the the largest duration observed in the data set.
</p>
</td></tr>
<tr><td><code id="hazard_+3A_length">Length</code></td>
<td>

<p>The number of points of the time interval <code class="reqn">[s, t]</code> for which the hazard rate is computed. These points are equally distributed in the time interval <code class="reqn">[s, t]</code>. This argument is not considered when the vector <code>time</code> is defined. Default value is 1000.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the hazard rates of waiting (or sojourn) times and the hazard rates of semi-Markov process defined in the parametric multi-state semi-Markov model described in Listwon and Saint-Pierre (2013). Additional details about the methodology behind the <code>SemiMarkov</code> package can be found in Limnios and Oprisan (2001), Foucher <em>et al.</em> (2006) and Perez-Ocon and Ruiz-Castro (1999).
</p>
<p>The hazard rate of waiting time at time <code class="reqn">t</code> represents the conditional probability that a transition from state <code class="reqn">h</code> to state <code class="reqn">j</code> is observed given that no event occurs until time <code class="reqn">t</code>. In a parametric framework, the expression of the hazard rates can easily be obtained as the distributions of waiting time belong to a parametric family. The hazard rate values are calculated using the chosen distribution and the given values of the parameters. The effects of both constant and time-varying covariates on the hazard of waiting time can be studied using a proportional intensities model. The effects of covariates can then be interpreted in terms of relative risk.
</p>
<p>The hazard rate of the semi-Markov process at time <code class="reqn">t</code> represents the conditional probability that a transition into state <code class="reqn">j</code> is observed given that the subject is in state <code class="reqn">h</code> and that no event occurs until time <code class="reqn">t</code>. The hazard rate of the semi-Markov process can be interpreted as the subject's risk of passing from state <code class="reqn">h</code> to state <code class="reqn">j</code>. This quantity can be deduced from the transition probabilities of the embedded Markov chain and from the distributions of waiting times.
</p>
<p>This function can be used to compute the hazard rates for different values of the covariates or different values of the parameters. These hazard rates can then be plotted using <a href="#topic+plot.hazard">plot.hazard</a>.
</p>
<p>Objects of classes <code>semiMarkov</code> and <code>param.init</code> can be used in the function <code>hazard</code>. These objects contain informations on the model and the values of the parameters for the waiting time distribution, the transition probability of Markov chain and the regression coefficients.
</p>



<h3>Value</h3>

<p>Returns an object of class <code>hazard</code>.
</p>
<table>
<tr><td><code>Type</code></td>
<td>

<p>The type of hazard computed by the function <code>hazard</code>: the hazard of waiting time (<code>alpha</code>) or the hazard of the semi-Markov process (<code>lambda</code>).
</p>
</td></tr>
<tr><td><code>vector</code></td>
<td>

<p>A data frame containing one vector for each possible transition. A vector contains values of the hazard rate associated to the vector of times.
</p>
</td></tr>
<tr><td><code>Time</code></td>
<td>

<p>The vector of times used to compute the hazard rate.
</p>
</td></tr>
<tr><td><code>Covariates</code></td>
<td>

<p>A list containing the values of the covariates (fixed or time-dependent).
</p>
</td></tr>
<tr><td><code>Summary</code></td>
<td>

<p>A list of data frames (one for each possible transition). A dataframe contains quantiles, means, minimums and maximums of the hazard rate values.
</p>
</td></tr>
<tr><td><code>Transition_matrix</code></td>
<td>

<p>A matrix containing informations on the model: the possible transitions and the distribution of waiting times for each transition (Exponential, Weibull or Exponentiated Weibull).
</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>

<p>Recall the name of the model.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Agnieszka Listwon-Krol
</p>


<h3>References</h3>

<p>Krol, A., Saint-Pierre P. (2015). <em>SemiMarkov : An R Package for Parametric Estimation in Multi-State Semi-Markov Models</em>. 66(6), 1-16.
</p>
<p>Limnios, N., Oprisan, G. (2001). <em>Semi-Markov processes and reliability</em>. Statistics for Industry and Technology. Birkhauser Boston.
</p>
<p>Foucher, Y., Mathieu, E., Saint-Pierre, P., Durand, J.F., Daures, J.P. (2006). A semi-Markov
model based on Generalized Weibull distribution with an illustration for HIV disease.
<em>Biometrical Journal</em>, 47(6), 825-833.
</p>
<p>Perez-Ocon, R., Ruiz-Castro, J. E. (1999). Semi-markov models and applications,
chapter 14, pages 229-238. <em>Kluwer Academic Publishers</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+plot.hazard">plot.hazard</a>, <a href="#topic+semiMarkov">semiMarkov</a>, <a href="#topic+param.init">param.init</a>, <a href="#topic+summary.hazard">summary.hazard</a>, <a href="#topic+print.hazard">print.hazard</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


## Asthma control data
data(asthma)

## Definition of the model:  states, names, 
# possible transtions and waiting times distributions
states_1 &lt;- c("1","2","3")
mtrans_1 &lt;- matrix(FALSE, nrow = 3, ncol = 3)
mtrans_1[1, 2:3] &lt;- c("E","E")
mtrans_1[2, c(1,3)] &lt;- c("E","E")
mtrans_1[3, c(1,2)] &lt;- c("W","E")

## semi-Markov model without covariates
fit1 &lt;- semiMarkov(data = asthma, states = states_1, mtrans = mtrans_1)

## Hazard rates of waiting time
alpha1 &lt;- hazard(fit1)
plot(alpha1)

## Hazard rates of the semi-Markov process
lambda1 &lt;- hazard(fit1, type = "lambda")
plot(lambda1)

## Defining a vector of equally distributed times 
alpha2 &lt;- hazard(fit1, s=0, t=3, Length=300)
plot(alpha2)

## Considering times observed in the data set
alpha3 &lt;- hazard(fit1, time=sort(unique(asthma$time)))
plot(alpha3)

## semi-Markov model with a covariate "BMI"
fit2 &lt;- semiMarkov(data = asthma, cov = as.data.frame(asthma$BMI), 
        states = states_1, mtrans = mtrans_1)

## Time fixed covariate
## Covariate equal to 0 and 1 for each transition
alpha4 &lt;- hazard(fit2)
alpha5 &lt;- hazard(fit2, cov=1)
plot(alpha4,alpha5)

## Time dependent covariate 
## Suppose that the covariate value is known for all times values
Time&lt;-sort(unique(asthma$time))             # observed times in ascending order
Cov1&lt;-sort(rbinom(length(Time), 1, 0.3))    # simulation of binary covariate
Cov2&lt;-sort(rexp(length(Time), 5))           # simulation of numeric covariate
alpha6 &lt;- hazard(fit2, time=Time, cov=Cov1)
plot(alpha6)
alpha7 &lt;- hazard(fit2, time=Time, cov=Cov2)
plot(alpha7)

## semi-Markov model with two covariates 
## "BMI" affects transitions "1-&gt;3" and "3-&gt;1"
## "Sex" affects transition "3-&gt;1"
SEX &lt;- as.data.frame(asthma$Sex)
BMI &lt;- as.data.frame(asthma$BMI)
fit3 &lt;- semiMarkov(data = asthma, cov = as.data.frame(cbind(BMI,SEX)),
                   states = states_1, mtrans = mtrans_1,
                   cov_tra = list(c("13","31"),c("31")))
alpha8 &lt;- hazard(fit3, cov=c(0,0))
alpha9 &lt;- hazard(fit3, cov=c(1,1))
plot(alpha8,alpha9)


</code></pre>

<hr>
<h2 id='param.init'>
Defines the initial values of  parameters for a semi-Markov model
</h2><span id='topic+param.init'></span>

<h3>Description</h3>

<p>Function defining initial values of parameters of the waiting time distributions, probabilities of the Markov chain and optional regression coefficients associated with covariates. The function can either provides the default initial values (the same as those considered in the function <code>semiMarkov</code>) or can be used to specify particular initial values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>param.init(data = NULL, cov = NULL, states, mtrans, 
           cov_tra = NULL, cens = NULL, dist_init = NULL, 
           proba_init=NULL, coef_init = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="param.init_+3A_data">data</code></td>
<td>

<p>data frame of the form <code>data.frame(id,state.h,state.j,time)</code>, where
</p>

<ul>
<li> <p><code>id</code>: the individual identification number
</p>
</li>
<li> <p><code>state.h</code>: state left by the process
</p>
</li>
<li> <p><code>state.j</code>: state entered by the process
</p>
</li>
<li> <p><code>time</code>: waiting time in state <code>state.h</code>
</p>
</li></ul>

<p>The data.frame containts one row per transition (possibly several rows per patient). The data frame <code>data</code> is not needed if <code>proba_init</code> is provided.
</p>
</td></tr>
<tr><td><code id="param.init_+3A_cov">cov</code></td>
<td>

<p>Optional data frame containing the covariates values.
</p>
</td></tr>
<tr><td><code id="param.init_+3A_states">states</code></td>
<td>

<p>A numeric vector giving the names of the states (names are values used in <code>state.h</code>).
</p>
</td></tr>
<tr><td><code id="param.init_+3A_mtrans">mtrans</code></td>
<td>

<p>A quadratic matrix of characters describing the possible transitions and the distributions of waiting time. 
The rows represent the left states, and the columns represent the entered states.   
If an instantaneous transition is not allowed from state <code>h</code> to state <code>j</code>, then <code>mtrans</code> should have <code class="reqn">(h,j)</code> entry <code>FALSE</code>, otherwise it should be <code>"E"</code> (or <code>"Exp"</code> or <code>"Exponential"</code>) for Exponential distribution, <code>"W"</code> (or <code>"Weibull"</code>) for Weibull distribution or <code>"EW"</code> (or <code>"EWeibull"</code> or <code>"Exponentiated Weibull"</code>) for Exponentiated Weibull distribution. If <code>TRUE</code> is used instead of the name of the distribution, then a Weibull distribution is considered. By definition of a semi-Markov model, the transitions into the same state are not possible. The diagonal elements of <code>mtrans</code> must be set to <code>FALSE</code> otherwise the function will stop. 
</p>
</td></tr>
<tr><td><code id="param.init_+3A_cov_tra">cov_tra</code></td>
<td>

<p>Optional list of vectors: a vector is associated with covariates included in the model. For a given covariate, the vector contains the transitions <code>"hj"</code> for which the covariate have an effect (only the transitions not equal to <code>FALSE</code> in <code>mtrans</code> are allowed). The effect of covariates can then be considered only on specific transitions. By default, the effects of covariates on all the possible transitions are included in a model.
</p>
</td></tr>
<tr><td><code id="param.init_+3A_cens">cens</code></td>
<td>

<p>A character giving the code for censored observations in the column <code>state.j</code> of the data. Default is <code>NULL</code> which means that the censoring is defined as a transition fron state <code class="reqn">h</code> to state <code class="reqn">h</code>.
</p>
</td></tr>
<tr><td><code id="param.init_+3A_dist_init">dist_init</code></td>
<td>

<p>Optional numeric vector giving the initial values of the distribution parameters. Default is 1 for each distribution parameter. The length of the vector depends on the chosen distribution, number of transitions and states.
</p>
</td></tr>
<tr><td><code id="param.init_+3A_proba_init">proba_init</code></td>
<td>

<p>Optional numeric vector giving the initial values of the transition probabilities. The sum of the probabilities in the same raw must be equal to 1. According to semi-Markov model, the probability to stay in the same state must be equal to 0. The default values for the transition probabilities are estimated from the data. If <code>data = NULL</code>, the argument <code>proba_init</code> is obligatory.
</p>
</td></tr>
<tr><td><code id="param.init_+3A_coef_init">coef_init</code></td>
<td>

<p>Optional numeric vector giving the initial values of the regression coefficients associated with the covariates. Default is 0 for each regression coefficient meaning no effect of the covariate.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a data frame containing the initial values of parameters of a semi-Markov model. 
The model parameters are the distribution parameters, the transition probabilities of the Markov chain and the regression coefficients associated with covariates. The number of parameters depends on the chosen model: the distributions of the sojourn times, the number of states and the transitions between states specified with the matrix <code>mtrans</code>, the number of covariates (<code>cov</code>) and their effects or not on transitions (<code>cov_tra</code>).
</p>
<p>The default initial values for the distribution parameters are fixed to 1. As the three possible distributions are nested for respective parameters equal to 1 (See details of the <code>semiMarkov</code> function), the initial distribution corresponds to the exponential distribution with parameter equal to 1 (whatever the chosen distribution). The default initial values for the regression coefficients are fixed to 0 meaning that the covariates have no effect on the hazard rates of the sojourn times. These initial values may be changed using the arguments <code>dist_init</code> and <code>coef_init</code>.
</p>
<p>By default, the initial probabilities are calculated by simple proportions. The probability associated to the transition from <code class="reqn">h</code> to <code class="reqn">j</code> is estimed by the number of observed transitions from state <code class="reqn">h</code> to state <code class="reqn">j</code> divided by the total number of transitions from state <code>h</code> observed in the data. The results are displayed in matrix <code>matrix.P</code>. The number of parameters for transition probabilities is smaller than the number of possible transitions as the probabilities in the same row sum up to one. Considering this point and that the probability to stay in the same state is zero, the user can change the initial values using the argument <code>proba_init</code>. 
</p>


<h3>Value</h3>

<p>This function returns an object of class <code>param.init</code> to be used in functions <a href="#topic+semiMarkov">semiMarkov</a> and <a href="#topic+hazard">hazard</a>. An object of class <code>param.init</code> consists of
</p>
<table>
<tr><td><code>nstates</code></td>
<td>

<p>The length of vector <code>states</code> interpreted as the number of possible states for the process.
</p>
</td></tr>
<tr><td><code>table.state</code></td>
<td>

<p>A table, with starting states as rows and arrival states as columns, which provides the number of times that a transition between two states is observed. This argument is only returned when <code>data</code> is provided. It can be used to quickly summarize multi-state data.
</p>
</td></tr>
<tr><td><code>Ncens</code></td>
<td>

<p>Number of individuals subjected to censoring.
</p>
</td></tr>
<tr><td><code>matrix.P</code></td>
<td>

<p>Quadratic matrix, with starting states as rows and arrival states as columns, giving the default initial values for the transition propabilities of the embedded Markov chain. All diagonal values are zero. The sum of all probabilities of the same row is equal to one.
</p>
</td></tr>
<tr><td><code>last</code></td>
<td>

<p>The largest duration observed in <code>data</code> if <code>data</code> is given.
</p>
</td></tr>
<tr><td><code>Transition_matrix</code></td>
<td>

<p>A matrix containing the informations on the model definition : the possible transitions o and the distribution of waiting times for each transition (Exponential, Weibull or Exponentiated Weibull).
</p>
</td></tr> 
<tr><td><code>dist.init</code></td>
<td>

<p>A data frame giving the names of the parameters, transitions associated with and initial values of the distribution parameters.
</p>
</td></tr>
<tr><td><code>proba.init</code></td>
<td>

<p>A data frame giving names of the parameters, transitions associated with and initial values of the probabilities of the embedded Markov chain.
</p>
</td></tr>
<tr><td><code>coef.init</code></td>
<td>

<p>A data frame giving the names of covariates, transitions associated with and initial values of the regression coefficients.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Agnieszka Listwon-Krol
</p>


<h3>See Also</h3>

<p><a href="#topic+hazard">hazard</a>, <a href="#topic+semiMarkov">semiMarkov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Asthma control data
data(asthma)

## Definition of the model:  states, names,
# possible transtions and waiting time distributions
states_1 &lt;- c("1","2","3")
mtrans_1 &lt;- matrix(FALSE, nrow = 3, ncol = 3)
mtrans_1[1, 2:3] &lt;- c("W","W")
mtrans_1[2, c(1,3)] &lt;- c("EW","EW")
mtrans_1[3, c(1,2)] &lt;- c("W","W")

## Default initial values in a model without covariates
init_1 &lt;- param.init(data = asthma, states = states_1, mtrans = mtrans_1)

## Definition of initial values in a model without covariates
init_2 &lt;- param.init(data = asthma, states = states_1, mtrans = mtrans_1,
          dist_init=c(rep(1.5,6),rep(1.8,6),rep(2,2)),
          proba_init=c(0.2,0.8,0.3,0.7,0.35,0.65))

## Default initial values with a covariate "Sex"
# influencing transitions " 1-&gt;2" and "3-&gt;2"
init_3 &lt;- param.init(data = asthma, cov=as.data.frame(asthma$Sex),
          states = states_1, mtrans = mtrans_1, cov_tra=list(c("12","32")))

## Definition of initial values with a covariate "Sex" 
# influencing transitions " 1-&gt;2" and "3-&gt;2"
init_4 &lt;- param.init(data = asthma, cov=as.data.frame(asthma$Sex),
          states = states_1, mtrans = mtrans_1, cov_tra=list(c("12","32")),
          dist_init=c(rep(1.5,6),rep(1.8,6),rep(2,2)),
          proba_init=c(0.2,0.8,0.3,0.7,0.35,0.65), coef_init=rep(0.3,2))
          
init_5 &lt;- param.init(data = asthma, cov=as.data.frame(asthma$Sex),
          states = states_1, mtrans = mtrans_1, cov_tra=list(c("12","32")),
          coef_init=c(0.2,0.5))          

## Definition of initial values without dataset in an illness-death model
## 1 - healthy, 2 - illness, 3 - death
states_2 &lt;- c("1","2","3")
mtrans_2 &lt;- matrix(FALSE, nrow = 3, ncol = 3)
mtrans_2[1,c(2,3)] &lt;- c("E","W")
mtrans_2[2,c(1,3)] &lt;- c("EW","EW")
init_6&lt;-param.init(states=states_2, mtrans=mtrans_2, proba_init=c(0.7,0.3,0.2,0.8))

</code></pre>

<hr>
<h2 id='plot.hazard'>
Plot method for objects of class <code>hazard</code>
</h2><span id='topic+plot.hazard'></span>

<h3>Description</h3>

<p>Plot method for one or several (maximum 10) objects of class <code>hazard</code>. Depending on the hazard rate chosen in the function <code>hazard</code>, the function plots either the hazard rates of sojourn times or the semi-Markov process hazard rate for each considered transition (one plot for each transition).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hazard'
plot(x, x2 = NULL, x3 = NULL, x4 = NULL, x5 = NULL, x6 = NULL, x7 = NULL, 
      x8 = NULL, x9 = NULL, x10 = NULL, transitions = NULL, names = NULL, 
      legend = TRUE, legend.pos = NULL, cex = NULL, colors = NULL,
	  xlab = "Time", ylab = "Hazard function", lwd = 3, type = "p", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.hazard_+3A_x">x</code></td>
<td>

<p>Object of class <code>hazard</code>. At least one <code>hazard</code> object is needed.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_x2">x2</code></td>
<td>

<p>Object of class <code>hazard</code>. Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_x3">x3</code></td>
<td>

<p>Object of class <code>hazard</code>. Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_x4">x4</code></td>
<td>

<p>Object of class <code>hazard</code>. Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_x5">x5</code></td>
<td>

<p>Object of class <code>hazard</code>. Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_x6">x6</code></td>
<td>

<p>Object of class <code>hazard</code>. Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_x7">x7</code></td>
<td>

<p>Object of class <code>hazard</code>. Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_x8">x8</code></td>
<td>

<p>Object of class <code>hazard</code>. Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_x9">x9</code></td>
<td>

<p>Object of class <code>hazard</code>. Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_x10">x10</code></td>
<td>

<p>Object of class <code>hazard</code>. A maximum of ten <code>hazard</code> objects is possible.  Default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_transitions">transitions</code></td>
<td>

<p>A character vector giving the transitions to be plotted. Default is <code>NULL</code> which means that all the possible transitions are displayed.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_names">names</code></td>
<td>

<p>Names of the hazard rates. Default is <code>NULL</code> which means that the names used in the <code>semiMarkov</code> object are applied. 
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_legend">legend</code></td>
<td>

<p>A logical value specifying if a legend should be added. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_legend.pos">legend.pos</code></td>
<td>

<p>A vector giving the legend position.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_cex">cex</code></td>
<td>

<p>character expansion factor relative to current <code>par("cex")</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_colors">colors</code></td>
<td>

<p>A vector of colours for the hazard rates.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_xlab">xlab</code></td>
<td>

<p>x-axis label. Default is <code>Time</code>. 
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_ylab">ylab</code></td>
<td>

<p>y-axis label. Default is <code>Hazard function</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_lwd">lwd</code></td>
<td>

<p>Thickness of lines or points.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_type">type</code></td>
<td>

<p>Type of graph. Default are points <code>p</code>.
</p>
</td></tr>
<tr><td><code id="plot.hazard_+3A_...">...</code></td>
<td>

<p>Further arguments for plot.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned.
</p>


<h3>Author(s)</h3>

<p>Agnieszka Listwon-Krol
</p>


<h3>See Also</h3>

<p><a href="#topic+hazard">hazard</a>, <a href="#topic+semiMarkov">semiMarkov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


## Asthma control data
data(asthma)

## Definition of the model:  states, names, possible transtions 
# and waiting times distributions
states_1 &lt;- c("1","2","3")
mtrans_1 &lt;- matrix(FALSE, nrow = 3, ncol = 3)
mtrans_1[1, 2:3] &lt;- c("E","E")
mtrans_1[2, c(1,3)] &lt;- c("E","E")
mtrans_1[3, c(1,2)] &lt;- c("W","E")
fit &lt;- semiMarkov(data = asthma, states = states_1, mtrans = mtrans_1)
lambda&lt;-hazard (fit, type = "lambda")

plot(lambda, names = c("lambda"),legend=FALSE)
plot(lambda, transitions = c("13","31"), names = c("lambda"),
legend.pos=c(2,0.09,2,0.4))

## semi-Markov model in each stratum of Severity
fit0 &lt;- semiMarkov(data = asthma[asthma$Severity==0,],
        states = states_1, mtrans = mtrans_1)
fit1 &lt;- semiMarkov(data = asthma[asthma$Severity==1,],
        states = states_1, mtrans = mtrans_1)
lambda0&lt;-hazard (fit0, type = "lambda",s=0,t=5,Length=1000)
lambda1&lt;-hazard (fit1, type = "lambda",s=0,t=5,Length=1000)
plot(lambda0,lambda1, names = c("lambda0", "lambda1"),
legend.pos=c(4,0.18,4,0.8,4,0.2,4,0.09,4,0.7,4,0.21))

## semi-Markov model with covariate "BMI"
fitcov &lt;- semiMarkov(data = asthma, cov = as.data.frame(asthma$BMI),
        states = states_1, mtrans = mtrans_1)
lambda0&lt;-hazard (fitcov, type = "lambda",cov = c(0))
lambda1&lt;-hazard (fitcov, type = "lambda",cov = c(1))
plot(lambda0,lambda1, names = c("lambda0", "lambda1"))


</code></pre>

<hr>
<h2 id='print.hazard'>
Print method for object of class <code>hazard</code>
</h2><span id='topic+print.hazard'></span>

<h3>Description</h3>

<p>Print method for objects of class <code>hazard</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hazard'
print(x, whole = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.hazard_+3A_x">x</code></td>
<td>

<p>An object of class <code>hazard</code>.
</p>
</td></tr>
<tr><td><code id="print.hazard_+3A_whole">whole</code></td>
<td>

<p>A logical value indicating if the whole vectors of the object <code>hazard</code> should be displayed. Default is <code>FALSE</code> which means that only the first six values are returned.
</p>
</td></tr>
<tr><td><code id="print.hazard_+3A_...">...</code></td>
<td>

<p>Further arguments for print or summary.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned.
</p>


<h3>Author(s)</h3>

<p>Agnieszka Listwon-Krol
</p>


<h3>See Also</h3>

<p><a href="#topic+hazard">hazard</a>, <a href="#topic+plot.hazard">plot.hazard</a>
</p>

<hr>
<h2 id='print.semiMarkov'>
Print method for object of class <code>semiMarkov</code>
</h2><span id='topic+print.semiMarkov'></span>

<h3>Description</h3>

<p>Print method for objects of class <code>semiMarkov</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'semiMarkov'
print(x, CI=TRUE, Wald.test=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.semiMarkov_+3A_x">x</code></td>
<td>

<p>An object of class <code>semiMarkov</code>.
</p>
</td></tr>
<tr><td><code id="print.semiMarkov_+3A_ci">CI</code></td>
<td>

<p>A logical value indicating if the confidence intervals for each parameter should be returned. Default is <code>TRUE</code>. The confidence level is chosen in <code>semiMarkov</code>.
</p>
</td></tr>
<tr><td><code id="print.semiMarkov_+3A_wald.test">Wald.test</code></td>
<td>

<p>A logical value indicating if the results of the Wald test for each parameter should be returned. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="print.semiMarkov_+3A_...">...</code></td>
<td>

<p>Further arguments for print or summary.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned.
</p>


<h3>Author(s)</h3>

<p>Agnieszka Listwon-Krol
</p>


<h3>See Also</h3>

<p><a href="#topic+semiMarkov">semiMarkov</a>, <a href="#topic+summary.semiMarkov">summary.semiMarkov</a>
</p>

<hr>
<h2 id='semiMarkov'>
Parametric estimation in multi-state semi-Markov models
</h2><span id='topic+semiMarkov'></span><span id='topic+SemiMarkov'></span>

<h3>Description</h3>

<p>This function computes the parametric maximum likelihood estimation in multi-state semi-Markov models in continuous-time. The effect of time varying or fixed covariates can be studied using a proportional intensities model for the hazard of the sojourn time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semiMarkov(data, cov = NULL, states, mtrans, cov_tra = NULL, 
          cens = NULL, dist_init=NULL, proba_init = NULL, coef_init = NULL, 
          alpha_ci = 0.95, Wald_par = NULL, eqfun = NULL, 
          ineqLB = NULL,ineqUB = NULL, control = list() )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="semiMarkov_+3A_data">data</code></td>
<td>

<p>data frame of the form <code>data.frame(id,state.h,state.j,time)</code>, where
</p>

<ul>
<li> <p><code>id</code>: the individual identification number
</p>
</li>
<li> <p><code>state.h</code>: state left by the process
</p>
</li>
<li> <p><code>state.j</code>: state entered by the process
</p>
</li>
<li> <p><code>time</code>: waiting time in state <code>state.h</code>
</p>
</li></ul>

<p>This data.frame containts one row per transition (possibly several rows per patient).
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_cov">cov</code></td>
<td>

<p>Optional data frame containing covariates values.
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_states">states</code></td>
<td>

<p>A numeric vector giving names of the states (names are values used in <code>state.h</code>).
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_mtrans">mtrans</code></td>
<td>

<p>A quadratic matrix of characters describing the possible transitions and the distributions of waiting time. 
The rows represent the left states, and the columns represent the entered states.   
If an instantaneous transition is not allowed from state <code>h</code> to state <code>j</code>, then <code>mtrans</code> should have <code class="reqn">(h,j)</code> entry <code>FALSE</code>, otherwise it should be <code>"E"</code> (or <code>"Exp"</code> or <code>"Exponential"</code>) for Exponential distribution, <code>"W"</code> (or <code>"Weibull"</code>) for Weibull distribution or <code>"EW"</code> (or <code>"EWeibull"</code> or <code>"Exponentiated Weibull"</code>) for Exponentiated Weibull distribution. If <code>TRUE</code> is used instead of the name of the distribution, then a Weibull distribution is considered. By definition of a semi-Markov model, the transitions into the same state are not possible. The diagonal elements of <code>mtrans</code> must be set to <code>FALSE</code> otherwise the function will stop. 
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_cov_tra">cov_tra</code></td>
<td>

<p>Optional list of vectors: a vector is associated with covariate included in the model. For a given covariate, the vector contains the transitions <code>"hj"</code> for which the covariate have an effect (only the transitions specified in <code>mtrans</code> are allowed). The effect of covariates can then be considered only on specific transitions. By default, the effects of covariates on all the possible transitions are studied.
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_cens">cens</code></td>
<td>

<p>A character giving the code for censored observations in the column <code>state.j</code> of the data. Default is <code>NULL</code> which means that the censoring is defined as a transition fron state <code class="reqn">h</code> to state <code class="reqn">h</code>.
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_dist_init">dist_init</code></td>
<td>

<p>Optional numeric vector giving the initial values of the distribution parameters. Default is 1 for each distribution parameter. The length of the vector depend on the chosen distribution, number of transitions and states.
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_proba_init">proba_init</code></td>
<td>

<p>Optional numeric vector giving the initial values of the transition probabilities. The sum of the probabilities in the same row must be equal to 1. According to semi-Markov model, the probability to stay in the same state must be equal to 0. The default values for the transition probabilities are estimated from the data. If <code>data = NULL</code>, the argument <code>proba_init</code> is obligatory.
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_coef_init">coef_init</code></td>
<td>

<p>Optional numeric vector giving the initial values of the regression coefficients associated with the covariates. Default is 0 for each regression coefficient which means that the covariate has no effect.
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_alpha_ci">alpha_ci</code></td>
<td>

<p>Confidence level to be considered for the confidence intervals. The default value is 0.95. 
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_wald_par">Wald_par</code></td>
<td>

<p>Optional numeric vector giving the values to be tested (null hypothesis) by the Wald test for each parameter. The Wald statistics are evaluated only for the parameters 
of distributions and regression coefficients. The length of this vector must then be equal to the number of those parameters. The order of the values must be as in the 
parameters table given by objects <code>semiMarkov</code> or <code>param.init</code> (excluding the parameters associated to the transition probabilities). The default values for 
the elements of <code>Wald_par</code> vector are 1 for the distribution parameters and 0 for the regression coefficients.




</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_eqfun">eqfun</code></td>
<td>

<p>Optional list given equality constraints between parameters. These constraints are passed using the equality constraint function that can be defined in the <code>solnp</code> optimization function. See below for details.

</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_ineqlb">ineqLB</code></td>
<td>

<p>Optional list given values of lower bound for parameters. These values are used in the inequality constraint that can be defined in the <code>solnp</code> optimization function. See below for details.         
</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_inequb">ineqUB</code></td>
<td>
 
<p>Optional list given values of upper bound for parameters. These values are used in the inequality constraint that can be defined in the <code>solnp</code> optimization function. See below for details.         

</p>
</td></tr>
<tr><td><code id="semiMarkov_+3A_control">control</code></td>
<td>

<p>The control list of optimization parameters for <code>solnp</code> optimization function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits parametric multi-state semi-Markov model described in Listwon and Saint-Pierre (2013) to longitudinal data. Additional details about the methodology behind the <code>SemiMarkov</code> package can be found in Limnios and Oprisan (2001), Foucher <em>et al.</em> (2006) and Perez-Ocon and Ruiz-Castro (1999).
</p>
<p>Consider an homogeneous semi-Markov process with a finite state space. In a parametric framework, distributions of the waiting time belong to parametric families. The distribution of the waiting time can be chosen between the exponential, the Weibull and the exponentiated Weibull distributions. The exponential distribution with scale parameter <code class="reqn">\sigma&gt;0</code> has a density defined as follows
</p>
<p style="text-align: center;"><code class="reqn">f(x) =(1/\sigma) exp(-x/\sigma).</code>
</p>

<p>The Weibull distribution with scale parameter <code class="reqn">\sigma&gt;0</code> and shape parameter <code class="reqn">\nu&gt;0</code> has a density given by (same as one defined in <code>dweibull</code>)
</p>
<p style="text-align: center;"><code class="reqn">g(x) = (\nu/\sigma)(x/\sigma)^{\nu-1} exp(-(x/\sigma)^\nu).</code>
</p>

<p>The exponentiated Weibull distribution (or generalized Weibull) with scale parameter <code class="reqn">\sigma&gt;0</code>, shape parameter <code class="reqn">\nu&gt;0</code> and family parameter equal to <code class="reqn">\theta&gt;0</code> has a density given by (same as one defined in function <code>dgweibull</code> from the R package <code>rmutil</code>)
</p>
<p style="text-align: center;"><code class="reqn">h(x) = \theta(\nu/\sigma)(x/\sigma)^{\nu-1} exp(-(x/\sigma)^\nu) (1-exp(-(x/\sigma)^\nu))^{\theta-1}.</code>
</p>

<p>These three distributions are nested. The exponentiated Weibull density with <code class="reqn">\theta=1</code> gives a Weibull distribution and the Weibull density with <code class="reqn">\nu=1</code> gives the exponential density. 
</p>
<p>Note that the effects of both constant and time-varying covariates on the hazards of sojourn time can be studied using a proportional intensities model. The effects of covariates can then be interpreted in terms of relative risk.
</p>
<p>The model parameters are the distribution parameters, the transition probabilities of the Markov chain and the regression coefficients associated with covariates. The number of parameters depends on the chosen model: the distributions of the sojourn times, the number of states and the transitions between states specified with the matrix <code>mtrans</code>, the number of covariates (<code>cov</code>) and their effects or not on transitions (<code>cov_tra</code>).

</p>
<p>The default initial values for the distribution parameters are fixed to 1. As the three possible distributions are nested for parameters equal to 1 (See details of the <code>semiMarkov</code> function), the initial distribution corresponds to an exponential with parameter equal to 1 (whatever the chosen distribution). The default initial values for the regression coefficients are fixed to 0 meaning that the covariates have no effect on the hazard rates of the sojourn times. These initial values may be changed using the arguments <code>dist_init</code> and <code>coef_init</code>.
</p>
<p>By default, the initial probabilities are calculated by simple proportions. The probability associated to the transition from <code class="reqn">h</code> to <code class="reqn">j</code> is estimed by the number of observed transitions from state <code class="reqn">h</code> to state <code class="reqn">j</code> divided by the total number of transitions from state <code>h</code> observed in the data. The results are displayed in matrix <code>matrix.P</code>. The number of parameters for transition probabilities is smaller than the number of possible transitions as the probabilities in the same row sum up to one. Considering this point and that the probability to stay in the same state is zero, the user can changed the initial values using the argument <code>proba_init</code>.
</p>
<p>The Yinyu Ye optimization solver to nonlinear problem is applied to maximize the log-likelihood using the function <code>solnp</code> created by A. Ghalanos and S. Theussl. In order to modify the optimization parameters refer to the package <code>Rsolnp</code> documentation.
</p>
<p>Some optimization difficulties can arrise when there is not enough information in the data to estimate each transition rate. The users can change the optimization parameters and the initial values. It may be appropriate to reduce the number of states in the model, the number of allowed transitions, or the number of covariate effects, to ensure convergence.
</p>
<p>Some additionals constraints can be introduced using <code>eqfun</code>, <code>ineqLB</code> and <code>ineqUB</code>. These constraints on distribution parameters, transition probabilities 
and regression coefficients can be defined using lists of vectors. 
The argument <code>eqfun</code> gives the possibility to add constraints of type <code class="reqn">par1 = a*par2</code> (<code class="reqn">a</code> is a constant). This equality constraint must be expressed with a vector 
of 3 elements where the first element is the identifier of the parameters type (<code>"dist"</code> for distribution parameters, <code>"proba"</code> for the transition probabilities and 
<code>"coef"</code> for the regression coefficients), the second and the third elements are the index of <code class="reqn">par1</code> and <code class="reqn">par2</code>, respectively. The index values of 
distribution parameters, transition probabilities and regression coefficients can be found in the table provided by an object <code>semiMarkov</code>. The last element of the vector 
corresponds to the constant <code class="reqn">a</code>. The arguments <code>ineqLB</code> and <code>ineqUB</code> allow to add constraints of type <code class="reqn">par \geq a</code> and <code class="reqn">par \leq a</code>, respectively. 
These arguments are lists of vectors of length 3 where the first element is the type of the parameter (<code>"dist"</code>, <code>"proba"</code> or <code>"coef"</code>), the second element 
is the index of parameter <code class="reqn">par</code> and the last one is the constant <code class="reqn">a</code>.
If a chosen constraint corresponds to a transition probability, it should be considered that the last probabilities in a row of the transition matrix are not estimated but 
obtained directly since the sum of transition probabilities in the same row is equal to 1. Thus, no additional constraints related to these parameters are permitted. Moreover, 
note that the argument <code>eqfun</code> does not allowed to define relationships between parameters of different types (for instance, a transition probability can not be equal to 
a regression coefficient). The optional constraints on parameters should be used prudently since they may induce problems in the convergence of the optimization method. In particular, 
the Wald statistic and the standard deviation may not be computed for some parameters due to negative values in the hessian matrix. Note that the default constraints induce by the model 
definition are treated in priority.
</p>





<h3>Value</h3>

<table>
<tr><td><code>call</code></td>
<td>

<p>The original call to <code>semiMarkov</code>.
</p>
</td></tr>
<tr><td><code>minus2loglik</code></td>
<td>

<p>Minus twice the maximized log-likelihood.
</p>
</td></tr>
<tr><td><code>solution</code></td>
<td>

<p>Etimations of the distribution parameters, probabilities of the embedded Markov chain and regression coefficients (if any considered) for each transition specified in the matrix <code>mtrans</code>. This is a data frame with three columns: the label of the parameter, the transition associated with and the estimated value.
</p>
</td></tr>
<tr><td><code>opt.message</code></td>
<td>

<p>The message giving the information on the optimization result returned by the <code>constrOptim.nl</code> function. 
</p>
</td></tr>
<tr><td><code>opt.iter</code></td>
<td>

<p>Number of outer iterations of the optimization method.
</p>
</td></tr>
<tr><td><code>nstates</code></td>
<td>

<p>The length of vector <code>states</code> interpreted as the number of possible states for the process.
</p>
</td></tr>
<tr><td><code>table.state</code></td>
<td>

<p>A table, with starting states as rows and arrival states as columns, which provides the number of observed transitions between two states. This argument can be used to quickly summarize multi-state data.
</p>
</td></tr>
<tr><td><code>Ncens</code></td>
<td>

<p>Number of individuals subjected to censoring.
</p>
</td></tr>
<tr><td><code>Transition_matrix</code></td>
<td>

<p>A matrix containing the informations on the model definition : the possible transitions and the distribution of waiting times for each transition (Exponential, Weibull or Exponentiated Weibull).
</p>
</td></tr> 
<tr><td><code>param.init</code></td>
<td>

<p>Recall the initial values of the parameters. The third column of this object can be used in <code>hazard</code> function.
</p>
</td></tr>
<tr><td><code>table.dist</code></td>
<td>

<p>Statistics for the estimations of distribution parameters of waiting time distributions. For the exponential distribution one data frame for the parameter <code>sigma</code> is returned, for the Weibull distribution two data frames for <code>sigma</code> and <code>nu</code> are returned, and for the Exponentiated Weibull distribution three data frames for <code>sigma</code>, <code>nu</code> and <code>theta</code> are returned. The columns of each data frame are the possible transitions, the estimations, the standard deviations, the lower and upper bounds of confidence intervals, the Wald test null hypothesis, the Wald test statistics and the p-values of the Wald test when testing hypothesis <code>sigma=1</code>, <code>nu=1</code> or <code>theta=1</code>.
</p>
</td></tr>
<tr><td><code>table.proba</code></td>
<td>
 
<p>A data frame giving the estimations of the transition probabilities of the Markov chain and their standard deviations. By definition, the probability associated to the last possible transition of each row of the matrix <code>mtrans</code> is equal to <code class="reqn">1-pr</code>, where <code class="reqn">pr</code> is the sum of all other probabilities from the row.
</p>
</td></tr>  
<tr><td><code>table.coef</code></td>
<td>

<p>If some covariates are included in the model it returns a data frame with the statistics for the estimated values of the regression coefficients. The columns of the data frame are the transitions associated with the coefficients, the estimations, the standard deviations, the lower and upper bounds of confidence intervals, the Wald test null hypothesis, the Wald test statistics and the p-values of the Wald test when testing hypothesis <code>coef=0</code>.
</p>
</td></tr>
<tr><td><code>table.param</code></td>
<td>

<p>Data frame with the statistics for all the model parameters, that is <code>table.dist</code>, <code>table.proba</code> and <code>table.coef</code> in a single data frame.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Printing a <code>semiMarkov</code> object by typing the object's name at the command line implicitly invokes <code>print.semiMarkov</code>.
</p>


<h3>Author(s)</h3>

<p>Agnieszka Listwon-Krol, Philippe Saint-Pierre
</p>


<h3>References</h3>

<p>Krol, A., Saint-Pierre P. (2015). <em>SemiMarkov : An R Package for Parametric Estimation in Multi-State Semi-Markov Models</em>. 66(6), 1-16.
</p>
<p>Ghalanos, A. and Theussl S. (2012). Rsolnp: General Non-linear Optimization Using Augmented Lagrange Multiplier Method. R package version 1.14.
</p>
<p>Limnios, N., Oprisan, G. (2001). <em>Semi-Markov processes and reliability</em>. Statistics for Industry and Technology. Birkhauser Boston.
</p>
<p>Foucher, Y., Mathieu, E., Saint-Pierre, P., Durand, J.F., Daures, J.P. (2006). A semi-Markov
model based on Generalized Weibull distribution with an illustration for HIV disease.
<em>Biometrical Journal</em>, 47(6), 825-833.
</p>
<p>Perez-Ocon, R., Ruiz-Castro, J. E. (1999). Semi-markov models and applications,
chapter 14, pages 229-238. <em>Kluwer Academic Publishers</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+param.init">param.init</a>, <a href="#topic+hazard">hazard</a>, <a href="#topic+summary.semiMarkov">summary.semiMarkov</a>, <a href="#topic+print.semiMarkov">print.semiMarkov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


## Asthma control data
data(asthma)

## Definition of the model:  states, names, possible transtions and waiting time 
## distributions
states_1 &lt;- c("1","2","3")
mtrans_1 &lt;- matrix(FALSE, nrow = 3, ncol = 3)
mtrans_1[1, 2:3] &lt;- c("E","E")
mtrans_1[2, c(1,3)] &lt;- c("E","E")
mtrans_1[3, c(1,2)] &lt;- c("W","E")

## semi-Markov model without covariates
fit1 &lt;- semiMarkov(data = asthma, states = states_1, mtrans = mtrans_1)

## semi-Markov model with one covariate 
## "BMI" affects all transitions
BMI &lt;- as.data.frame(asthma$BMI)
fit2 &lt;- semiMarkov(data = asthma, cov = BMI, states = states_1, mtrans = mtrans_1)
## semi-Markov model with one covariate 
## "BMI" affects the transitions "1-&gt;3" and "3-&gt;1"
fit3 &lt;- semiMarkov(data = asthma, cov = BMI, states = states_1, mtrans = mtrans_1,
                   cov_tra = list(c("13","31")))

## semi-Markov model with two covariates 
## "BMI" affects the transitions "1-&gt;3" and "3-&gt;1"
## "Sex" affects the transition "3-&gt;1"
SEX &lt;- as.data.frame(asthma$Sex)
fit4 &lt;- semiMarkov(data = asthma, cov = as.data.frame(cbind(BMI,SEX)),
                   states = states_1, mtrans = mtrans_1,
                   cov_tra = list(c("13","31"),c("31")))
                   
## semi-Markov model using specific initial values      
## same model as "fit1" but using different initial values
## "fit5" and "fit6" are equivalent

init &lt;- param.init(data = asthma, states = states_1, mtrans = mtrans_1,
        dist_init=c(rep(1.5,6),c(1.8)), proba_init=c(0.2,0.8,0.3,0.7,0.35,0.65))
fit5 &lt;- semiMarkov(data = asthma, states = states_1, mtrans = mtrans_1,
                   dist_init=init$dist.init[,3], proba_init=init$proba.init[,3])
fit6 &lt;- semiMarkov(data = asthma, states = states_1, mtrans = mtrans_1,
                   dist_init=c(rep(1.5,6),c(1.8)), 
                   proba_init=c(0.2,0.8,0.3,0.7,0.35,0.65))                   


## The Wald test null hypothesis is modified
## Wald statistics when testing nullity of distribution parameters
## and regression coefficients equal to -1
fit7 &lt;- semiMarkov(data = asthma, cov = BMI, states = states_1, mtrans = mtrans_1,
                   Wald_par = c(rep(0,7),rep(-1,6)))
            
## semi-Markov model with additional constraints 
## distribution parameters sigma for transition "1-&gt;3" = sigma for transition "2-&gt;1" 
fit8 &lt;- semiMarkov(data = asthma, cov = BMI, states = states_1, mtrans = mtrans_1,
                   eqfun = list(c("dist",2,3,1)))

## semi-Markov model with additional constraints 
## regression coefficients beta for transition "1-&gt;2" = beta for transition "2-&gt;1" 
##                                                    = beta for transition "2-&gt;3"  
fit9 &lt;- semiMarkov(data = asthma, cov = BMI, states = states_1, mtrans = mtrans_1,
                   eqfun = list(c("coef",1,3,1),c("coef",1,4,1)))

## semi-Markov model with additional constraints 
## regression coeficient beta for transition "1-&gt;2" belongs to [-0.2,0.2]
## and regression coeficient beta for transition "2-&gt;3" belongs to [-0.05,0.05]
fit10 &lt;- semiMarkov(data = asthma, cov = BMI, states = states_1, mtrans = mtrans_1,
                    ineqLB = list(c("coef",1,-0.2),c("coef",4,-0.05)),
                    ineqUB = list(c("coef",1,0.2),c("coef",4,0.05)))



</code></pre>

<hr>
<h2 id='summary.hazard'>
Summary method for objects of class <code>hazard</code>
</h2><span id='topic+summary.hazard'></span>

<h3>Description</h3>

<p>Summary method for objects of class hazard.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hazard'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.hazard_+3A_object">object</code></td>
<td>

<p>An object of class <code>hazard</code>.
</p>
</td></tr>
<tr><td><code id="summary.hazard_+3A_...">...</code></td>
<td>

<p>Further arguments for summary.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For an object of class <code>hazard</code>, this function gives the informations on the type of hazard rates (sojourn time or semi-Markov process), the chosen model, the distribution of the sojourn times, the covariates and the vector of times.
</p>


<h3>Value</h3>

<p>No value returned.
</p>


<h3>Author(s)</h3>

<p>Agnieszka Listwon-Krol
</p>


<h3>See Also</h3>

<p><a href="#topic+hazard">hazard</a>, <a href="#topic+print.hazard">print.hazard</a>
</p>

<hr>
<h2 id='summary.semiMarkov'>
Summary method for objects of class <code>semiMarkov</code>
</h2><span id='topic+summary.semiMarkov'></span>

<h3>Description</h3>

<p>Summary method for objects of class <code>semiMarkov</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'semiMarkov'
summary(object, all = TRUE, transitions = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.semiMarkov_+3A_object">object</code></td>
<td>

<p>An object of class <code>semiMarkov</code>.
</p>
</td></tr>
<tr><td><code id="summary.semiMarkov_+3A_all">all</code></td>
<td>

<p>A logical value indicating if the results should be displayed for all the possible transitions. If set to <code>FALSE</code>, the transitions to be displayed must be specified using the argument <code>transitions</code>. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="summary.semiMarkov_+3A_transitions">transitions</code></td>
<td>

<p>A vector of characters specifying the transitions to be displayed when the argument <code>all</code> is set to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="summary.semiMarkov_+3A_...">...</code></td>
<td>

<p>Further arguments for summary.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames giving 
</p>
<table>
<tr><td><code>Transition_matrix</code></td>
<td>

<p>A matrix containing the informations on the model definition : the possible transitions and the distribution of waiting times for each transition (Exponential, Weibull or Exponentiated Weibull).
</p>
</td></tr>
<tr><td><code>param.init</code></td>
<td>

<p>Recall the initial values of the parameters. The third column of this object can be used in <code>hazard</code> function.
</p>
</td></tr>
<tr><td><code>table.state</code></td>
<td>

<p>A table, with starting states as rows and arrival states as columns, which provides the number of observed transitions between two states. This argument can be used to quickly summarize multi-state data.
</p>
</td></tr>
<tr><td><code>Ncens</code></td>
<td>

<p>Number of individuals subjected to censoring.
</p>
</td></tr>






<tr><td><code>table.param</code></td>
<td>

<p>List of data frames (one for each transition). A data frame includes, for each parameter (distribution parameters, the transition probabilities and the regression coefficients), the estimation, the standard deviation, the lower and upper bounds of confidence interval, the Wald test statistic and Wald test p-value (for the distribution parameters and the regression coefficients).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Agnieszka Listwon-Krol
</p>


<h3>See Also</h3>

<p><a href="#topic+semiMarkov">semiMarkov</a>, <a href="#topic+print.semiMarkov">print.semiMarkov</a>
</p>

<hr>
<h2 id='table.state'>
Table giving the numbers of observed transitions
</h2><span id='topic+table.state'></span>

<h3>Description</h3>

<p>Function returning a table with numbers of transitions between two states observed in the data set. This table can be a used to summarize a multi-state data or to define the matrix <code>mtrans</code> required in the <code>semiMarkov</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>table.state( data, states = NULL, mtrans = NULL, cens = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="table.state_+3A_data">data</code></td>
<td>

<p>data frame in form <code>data.frame(id,state.h,state.j,time)</code>, where
</p>

<ul>
<li> <p><code>id</code>: the individual identification number
</p>
</li>
<li> <p><code>state.h</code>: state left by the process
</p>
</li>
<li> <p><code>state.j</code>: state entered by the process
</p>
</li>
<li> <p><code>time</code>: waiting time in state <code>state.h</code>
</p>
</li></ul>

<p>This data.frame containts one row per transition (possibly several rows per patient).
</p>
</td></tr>
<tr><td><code id="table.state_+3A_states">states</code></td>
<td>

<p>A numeric vector giving the names of the states (names are values used in <code>state.h</code>).
</p>
</td></tr>
<tr><td><code id="table.state_+3A_mtrans">mtrans</code></td>
<td>

<p>A quadratic matrix of logical values describing the possible transitions. 
The rows represent the left states, and the columns represent the entered states.   
If an instantaneous transition is not allowed from state <code>h</code> to state <code>j</code>, then <code>mtrans</code> should have <code class="reqn">(h,j)</code> entry <code>FALSE</code>,
otherwise it should be <code>TRUE</code>. Default value is a matrix which allows all the possible transitions between states. 
</p>
</td></tr>
<tr><td><code id="table.state_+3A_cens">cens</code></td>
<td>

<p>A character giving the code for censored observations in the column <code>state.j</code> of the data. Default is <code>NULL</code> which means that the censoring is defined as a transition fron state <code class="reqn">i</code> to state <code class="reqn">i</code> (by definition of a semi-Markov model, the transitions into the same state are not possible).
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>table.state</code></td>
<td>

<p>A table, with starting states as rows and arrival states as columns, which provides the number of observed transitions between two states. This argument can be used to quickly summarize multi-state data.
</p>
</td></tr>
<tr><td><code>Ncens</code></td>
<td>

<p>Number of individuals subjected to censoring.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Agnieszka Listwon-Krol
</p>


<h3>See Also</h3>

<p><a href="#topic+param.init">param.init</a>, <a href="#topic+semiMarkov">semiMarkov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Asthma control data
data(asthma)

# default description
# censoring is implicitly defined as a transition "h-&gt;h"
table.state(asthma)
table.state(asthma)$Ncens

# censoring defined as a transition to state "4"
asthma_bis&lt;-asthma
for(i in 1:dim(asthma)[1]){if(asthma[i,2]==asthma[i,3]) asthma_bis[i,3]&lt;-4}
table.state (asthma_bis, cens = 4)

## Definition of the model: states names and possible transtions
states_1 &lt;- c("1","2","3")
mtrans_1 &lt;- matrix(FALSE, nrow = 3, ncol = 3)
mtrans_1[1, 2:3] &lt;- TRUE
mtrans_1[2, c(1,3)] &lt;- c("W","E")
table.state(asthma, states = states_1, mtrans = mtrans_1)

   </code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
