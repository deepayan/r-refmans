<!DOCTYPE html><html><head><title>Help for package FAmle</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FAmle}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FAmle-package'><p>Maximum Likelihood and Bayesian Estimation of Univariate Probability Distributions</p></a></li>
<li><a href='#boot.mle'><p>Bootstrap Distribution for Fitted Model</p></a></li>
<li><a href='#ColesData'><p>Annual Maximum Sea Levels at Port Pirie, South Australia</p></a></li>
<li><a href='#distr'><p>Distribution functions 4-in-1</p></a></li>
<li><a href='#FAmle-internal'><p>Internal Functions in the FAmle Package</p></a></li>
<li><a href='#floodsNB'><p>New Brunswick (Canada) Flood Dataset</p></a></li>
<li><a href='#metropolis'><p>Bayesian Estimation of Univariate Probability Distributions</p></a></li>
<li><a href='#mle'><p>Maximum Likelihood Estimation of Univariate Probability Distributions</p></a></li>
<li><a href='#plot.metropolis'><p>A Function to Plot metropolis objects</p></a></li>
<li><a href='#plot.mle'><p>Diagnostic Plots for the Fitted Model</p></a></li>
<li><a href='#print.metropolis'><p>Bayesian Estimation of Univariate Probability Distributions</p></a></li>
<li><a href='#print.mle'><p>Maximum Likelihood Estimation of Univariate Probability Distributions</p></a></li>
<li><a href='#Q.boot.ci'><p>Parametric Bootstrap Confidence Intervals for p-th Quantile</p></a></li>
<li><a href='#Q.conf.int'><p>Approximate Confidence Intervals for p-th Quantile</p></a></li>
<li><a href='#station01AJ010'><p>Annual Maximum Daily Mean Flow Data (NB, Canada)</p></a></li>
<li><a href='#yarns'><p>Yarns Failure Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Maximum Likelihood and Bayesian Estimation of Univariate
Probability Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Francois Aucoin</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Petzoldt &lt;thomas.petzoldt@tu-dresden.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>FAdist</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate parameters of univariate probability distributions 
  with maximum likelihood and Bayesian methods.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/tpetzoldt/FAmle">https://github.com/tpetzoldt/FAmle</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-04 00:04:27 UTC; thpe</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-04 00:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='FAmle-package'>Maximum Likelihood and Bayesian Estimation of Univariate Probability Distributions</h2><span id='topic+FAmle-package'></span><span id='topic+FAmle'></span>

<h3>Description</h3>

<p>This package contains a series of functions that might be useful in carrying out maximum likelihood and Bayesian estimations of univariate probability distributions.</p>


<h3>Author(s)</h3>

<p>Francois Aucoin (author and original maintainer),
Thomas Petzoldt (actual maintainer, applied formal changes to pass CRANs
package check). Many thanks to the original author for his agreement.
</p>

<hr>
<h2 id='boot.mle'>Bootstrap Distribution for Fitted Model</h2><span id='topic+boot.mle'></span>

<h3>Description</h3>

<p>This function allows the user to obtain draws from the (parametric) bootstrap distribution of the fitted model's parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot.mle(model, B = 200, seed = NULL, start = NULL,
 method = "Nelder-Mead")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot.mle_+3A_model">model</code></td>
<td>
<p><code><a href="#topic+mle">mle</a></code> object corresponding to the fitted model.</p>
</td></tr>
<tr><td><code id="boot.mle_+3A_b">B</code></td>
<td>
<p>Requested number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="boot.mle_+3A_seed">seed</code></td>
<td>
<p>A seed may be specified (see <code><a href="base.html#topic+set.seed">set.seed</a></code>)</p>
</td></tr>
<tr><td><code id="boot.mle_+3A_start">start</code></td>
<td>
<p>Starting values for the optimization algorithm (if <code>is.null(start)==TRUE</code>, the fitted model's parameters are used as starting values).</p>
</td></tr>
<tr><td><code id="boot.mle_+3A_method">method</code></td>
<td>
<p>The optimization method to be used (see <code><a href="stats.html#topic+optim">optim</a></code> and <code><a href="#topic+mle">mle</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parametric bootstrap &ndash; see References.</p>


<h3>Value</h3>

<table>
<tr><td><code>model</code></td>
<td>
<p><code><a href="#topic+mle">mle</a></code> object corresponding to the fitted model.</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Requested number of bootstrap samples.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>The specified seed (see <code><a href="base.html#topic+set.seed">set.seed</a></code>)</p>
</td></tr>
<tr><td><code>par.star</code></td>
<td>
<p>Array containing realized values from the bootstrap distribution of the maximum likelihood parameter estimators.</p>
</td></tr>
<tr><td><code>gof</code></td>
<td>
<p>The bootstrap distributions of two goodness-of-fit statistics: Anderson-Darling statistic and Pearson's correlation coefficient for the pair (&quot;observed quantiles&quot;,&quot;fitted quantiles&quot;).</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>Bootstrap p-values for the two goodness-of-fit statistics.</p>
</td></tr>
<tr><td><code>failure.rate</code></td>
<td>
<p>The proportion of bootstrap samples for which optimization failed using the specified starting values.</p>
</td></tr>
<tr><td><code>total.time</code></td>
<td>
<p>The total amount of time required to generate <code>B</code> bootstrap samples.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Davison, A.C., and Hinkley, D.V. (1997). Bootstrap methods and their application. Cambridge University Press.</p>


<h3>See Also</h3>

<p><code><a href="#topic+mle">mle</a></code>, <code><a href="#topic+Q.conf.int">Q.conf.int</a></code>, <code><a href="#topic+Q.boot.ci">Q.boot.ci</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(yarns)
x &lt;- yarns$x
fit.x &lt;- mle(x,'weibull',c(.1,.1))
boot.x &lt;- boot.mle(fit.x,B=10)
boot.x$par.star
boot.x$p.value
</code></pre>

<hr>
<h2 id='ColesData'>Annual Maximum Sea Levels at Port Pirie, South Australia</h2><span id='topic+ColesData'></span>

<h3>Description</h3>

<p>This dataset is taken from Coles (2001) (also see references therein), and consists of 64 sea level (in meters) yearly maxima for the time period 1923-1987.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ColesData)</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing two columns named <code>year</code> and <code>sea.level</code> (in meters).</p>


<h3>Source</h3>

<p>Coles (2001), page 4 (also see references therein).</p>


<h3>References</h3>

<p>Coles, S. (2001). An introduction to statistical modeling of extreme values. Springer.
</p>

<hr>
<h2 id='distr'>Distribution functions 4-in-1</h2><span id='topic+distr'></span>

<h3>Description</h3>

<p>This function can be used to call any of the 4 functions specific to a given probability distribution available in <span class="rlang"><b>R</b></span>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>distr(x, dist, param, type = "d", model = NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distr_+3A_x">x</code></td>
<td>
<p>Vector (or array) of quantiles, vector (or array) of probabilities, or number of observations.</p>
</td></tr>
<tr><td><code id="distr_+3A_dist">dist</code></td>
<td>
<p>Distribution name.</p>
</td></tr>
<tr><td><code id="distr_+3A_param">param</code></td>
<td>
<p>Vector (or array) of parameters.</p>
</td></tr>
<tr><td><code id="distr_+3A_type">type</code></td>
<td>
<p>Type of function to be called (<code>'d'</code>, <code>'p'</code>, <code>'q'</code>, or <code>'r'</code>).</p>
</td></tr>
<tr><td><code id="distr_+3A_model">model</code></td>
<td>
<p>Object from the class <code><a href="#topic+mle">mle</a></code> - may be specified instead of <code>param</code> and <code>dist</code>.</p>
</td></tr>
<tr><td><code id="distr_+3A_...">...</code></td>
<td>
<p>Additional arguments <code>log</code>, <code>lower.tail</code>, and <code>log.p</code>, depending on <code>type</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each distribution available in <span class="rlang"><b>R</b></span>, 4 functions can be called. For example, for the normal distribution, the following 4 functions are available: <code><a href="stats.html#topic+dnorm">dnorm</a></code>, <code><a href="stats.html#topic+pnorm">pnorm</a></code>, <code><a href="stats.html#topic+qnorm">qnorm</a></code>, and <code><a href="stats.html#topic+rnorm">rnorm</a></code>. For the normal distribution, based on the argument <code>type</code>, <code>distr</code> may be used to call any one of the previous four functions.</p>


<h3>Value</h3>

<p>Returns the density, the distribution function, the quantile function, or random variates.</p>


<h3>Note</h3>

<p>Most functions in <code><a href="#topic+FAmle">FAmle</a></code> rely upon <code>distr</code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1
dnorm(-4:4,0,1,log=TRUE)
distr(-4:4,'norm',c(0,1),type='d',log=TRUE)

## Example 2
mu.vec &lt;- c(1,100,100)
sigma.vec &lt;- c(1,11,111)
n &lt;- 3
set.seed(123)
rnorm(n,mu.vec,sigma.vec)
set.seed(123)
distr(n,'norm',cbind(mu.vec,sigma.vec),'r')

## Example 3
qnorm(.9,mu.vec,sigma.vec)
distr(.9,'norm',cbind(mu.vec,sigma.vec),'q')

</code></pre>

<hr>
<h2 id='FAmle-internal'>Internal Functions in the FAmle Package</h2><span id='topic+FAmle-internal'></span><span id='topic+cdf.plot'></span><span id='topic+delta.Q'></span><span id='topic+delta.QQ'></span><span id='topic+Diff.1'></span><span id='topic+Diff.2'></span><span id='topic+Diff.3'></span><span id='topic+hist.metropolis'></span><span id='topic+hist.plot'></span><span id='topic+Plot.post.pred'></span><span id='topic+post.pred'></span><span id='topic+Quantile.plot'></span><span id='topic+Return.plot'></span><span id='topic+Carlin'></span>

<h3>Description</h3>

<p>Internal functions in the FAmle package
.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdf.plot(z)
delta.Q(p, model, ln = FALSE)
delta.QQ(model, alpha = 0.1, ln = FALSE)
Diff.1(x, f, h = 1e-04)
Diff.2(k, i, model, p, ln = FALSE)
Diff.3(i, model, p, ln = FALSE)
## S3 method for class 'metropolis'
hist(x, density = TRUE, ...)
## S3 method for class 'plot'
hist(x,...)
Plot.post.pred(x, ...)
post.pred(z, fun = NULL)
Quantile.plot(z, ci = FALSE, alpha = 0.05)
Return.plot(model, ci = FALSE, alpha = 0.05)
Carlin(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FAmle-internal_+3A_z">z</code></td>
<td>
<p>A <code><a href="#topic+mle">mle</a></code> object.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_p">p</code></td>
<td>
<p>A vector of probabilities.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_model">model</code></td>
<td>
<p>A <code><a href="#topic+mle">mle</a></code> object.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_ln">ln</code></td>
<td>
<p>Whether or not (TRUE or FALSE) computations should be carried out on the natural logarithmic scale.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_x">x</code></td>
<td>
<p>Value at which the numerical derivative should be evaluated. For the <code>Carlin</code> function (see References for <code><a href="#topic+metropolis">metropolis</a></code>), this <code>x</code> corresponds to an object from the class <code><a href="#topic+metropolis">metropolis</a></code>.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_f">f</code></td>
<td>
<p>A function to be differentiated.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_h">h</code></td>
<td>
<p>Small number representing a small change in <code>x</code>.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_k">k</code></td>
<td>
<p>Parameter value at which the first derivative should be evaluated.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_i">i</code></td>
<td>
<p>Position of the parameter, within a vector of parameters, with respect to which differentiation should be carried out.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_density">density</code></td>
<td>
<p>Whether or not (TRUE or FALSE) a Kernel density should be added to the histogram - see <code><a href="stats.html#topic+density">density</a></code>.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_...">...</code></td>
<td>
<p>Additional arguments pertaining to <code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_fun">fun</code></td>
<td>
<p>optional argument that may be used to modify the scale on which the histogram will be plotted.</p>
</td></tr>
<tr><td><code id="FAmle-internal_+3A_ci">ci</code></td>
<td>
<p>Whether or not (TRUE or FALSE) approximated <em>100*(1-<code>alpha</code>)</em> confidence intervals should be added to the plot (either <code>Quantile.plot</code> or <code>Return.plot</code>).</p>
</td></tr>
</table>

<hr>
<h2 id='floodsNB'>New Brunswick (Canada) Flood Dataset</h2><span id='topic+floodsNB'></span>

<h3>Description</h3>

<p><code>floodsNB</code> is a <code>list</code> object containing the hydrometric stations considered for analysis... Each element from the <code>list</code> corresponds to an hydrometric station located in the Canadian province of New Brunswick, for which the flow is unregulated. For each station, the following information is available:
</p>

<ul>
<li> <p><code>data</code>: Maximum annual daily mean discharge (in <code class="reqn">m^3/s</code>);
</p>
</li>
<li> <p><code>peak</code>: Maximum annual daily peak discharge (in <code class="reqn">m^3/s</code>);
</p>
</li>
<li> <p><code>ln.drain</code>: Natural logarithm of the drainage area (in <code class="reqn">km^2</code>);
</p>
</li>
<li> <p><code>coor</code>: Coordinates (in latitude and longitude) of the hydrometric station;
</p>
</li>
<li> <p><code>status</code>: Station's status - <code>Active</code> or <code>Inactive</code>;
</p>
</li>
<li> <p><code>Aucoin.2001</code>: Whether or not (<code>TRUE</code> or <code>FALSE</code>) the station is retained for analysis in ....
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(floodsNB)</code></pre>


<h3>Format</h3>

<p>A <code>list</code> object whose elements correspond to distinct hydrometric stations.</p>


<h3>Source</h3>

<p>HYDAT database.</p>


<h3>References</h3>

<p>Environment and Climate Change Canada Historical Hydrometric Data web site, <a href="https://wateroffice.ec.gc.ca/mainmenu/historical_data_index_e.html">https://wateroffice.ec.gc.ca/mainmenu/historical_data_index_e.html</a>
</p>

<hr>
<h2 id='metropolis'>Bayesian Estimation of Univariate Probability Distributions</h2><span id='topic+metropolis'></span>

<h3>Description</h3>

<p>For a given dataset, this function serves to approximate
(using a Metropolis algorithm) the posterior distribution of the
parameters  for some specified parametric probability distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>metropolis(model, iter = 1000, tun = 2, trans.list = NULL,
	start = NULL, variance = NULL, prior = NULL, burn = 0,
	uniroot.interval = c(-100, 100),pass.down.to.C=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metropolis_+3A_model">model</code></td>
<td>
<p><code><a href="#topic+mle">mle</a></code> object corresponding to the fitted (by
maximum likelihood) model.<br />
</p>
<p>A <code>list(x=dataset, dist=distribution)</code> object may also be
provided, but the user will then have to make sure to specify the
arguments <code>start</code> and <code>variance</code>. Moreover, the latter two
arguments will have to be specified on their transformed scales (see
<code>trans.list</code>).</p>
</td></tr>
<tr><td><code id="metropolis_+3A_iter">iter</code></td>
<td>
<p>The requested number of iterations - the Markov Chain's
length.</p>
</td></tr>
<tr><td><code id="metropolis_+3A_tun">tun</code></td>
<td>
<p>A tuning constant; value by which the covariance matrix of
the multivariate normal proposal will be multiplied - see References.</p>
</td></tr>
<tr><td><code id="metropolis_+3A_trans.list">trans.list</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> object containing a function
for each parameter that is to be estimated. For each parameter, the
function must correspond to the inverse transformation that will
determine the parametrization for which the simulation will be carried
out (see Example and Details).</p>
</td></tr>
<tr><td><code id="metropolis_+3A_start">start</code></td>
<td>
<p>A vector of starting values for the algorithm. If
<code>NULL</code>, the maximum likelihood parameter estimates will be used
as starting values for the Markov Chain. If <code>model</code> is not an
object from the class <code>mle</code>, this argument will have to be
specified, along with the argument <code>variance</code>. Moreover, as
already stated above, the user will have to make sure that both
<code>start</code> and <code>variance</code> are those for the transformed
parameters (see <code>trans.list</code>).</p>
</td></tr>
<tr><td><code id="metropolis_+3A_variance">variance</code></td>
<td>
<p>Covariance matrix of the multivariate normal proposal
distribution. If <code>NULL</code>, the observed Fisher's information will
be used and multiplied by the specified <code>tun</code>. As for
<code>start</code>, this argument needs to be specified if <code>model</code> is
not from the class <code>mle</code>.</p>
</td></tr>
<tr><td><code id="metropolis_+3A_prior">prior</code></td>
<td>
<p>A function that corresponds to the joint prior
distribution (see Example). Note that the prior distribution will be
evaluated on the transformed parameter space(s).</p>
</td></tr>
<tr><td><code id="metropolis_+3A_burn">burn</code></td>
<td>
<p>Burn-in period (see References).</p>
</td></tr>
<tr><td><code id="metropolis_+3A_uniroot.interval">uniroot.interval</code></td>
<td>
<p>Default is c(-100,100). This interval is used
by <code>R</code>'s function <code><a href="stats.html#topic+uniroot">uniroot</a></code> to search for the inverse
of each element in <code>trans.list</code>.</p>
</td></tr>
<tr><td><code id="metropolis_+3A_pass.down.to.c">pass.down.to.C</code></td>
<td>
<p>If <code>TRUE</code>, the iterative task is passed
down to a C program for faster implementation of the MCMC
algorithm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses a single block Metropolis algorithm with
multivariate normal proposal. For this function to work properly, all
parameters should be defined on the real line - parameter
transformation(s) might be required. If <code>trans.list</code> is not
specified, the function will assume that the parameter distributions
are all defined on the real line (i.e., <code>function(x) x</code> will be
used for each parameter). If no prior distribution is provided, an
improper prior distribution - uniform on the interval )-Inf,+Inf( -
will be used for all parameters (i.e., prior distribution proportional
to 1 - function(x) 1).
</p>
<p>In order to minimize the number of arguments for <code>metropolis</code>,
the function automatically computes the inverse of <code>trans.list</code>:
this suppresses the need for the user to provide both the
&quot;inverse transformation&quot; and the &quot;transformation&quot;. However, problems
may occur, and it is why the user is allowed to alter
<code>uniroot.interval</code>. Depending on the number of errors reported,
future versions of this package may end up requesting that a list for
both the &quot;inverse transformation&quot; and the &quot;transformation&quot; be provided
by the user.
</p>
<p>A nice list of references is provided below for more information on
topics such as: MCMC algorithms, tuning of Metropolis-Hastings
algorithms, MCMC convergence diagnostics, the Bayesian paradigm ...
</p>


<h3>Value</h3>

<table>
<tr><td><code>rate</code></td>
<td>
<p>MCMC acceptance rate. This value is computed before
applying the burn-in; i.e., it is computed for <code>sims.all</code>.</p>
</td></tr>
<tr><td><code>total.time</code></td>
<td>
<p>Total computation time.</p>
</td></tr>
<tr><td><code>sims.all</code></td>
<td>
<p>Array containing all iterations.</p>
</td></tr>
<tr><td><code>sims</code></td>
<td>
<p>Array containing iterations after burn-in.</p>
</td></tr>
<tr><td><code>input</code></td>
<td>
<p>Inputted <code><a href="#topic+mle">mle</a></code> object.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>Prior distribution.</p>
</td></tr>
<tr><td><code>burn</code></td>
<td>
<p>Integer corresponding to the number of iterations to be
discarded - burn-in period.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>Parameter vector whose elements correspond to the parameter
values (on the scales specified by <code>trans.list</code>) obtained at
the last iteration of the Metropolis sampler;
i.e. <code>sims[iter,]</code>.</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>Covariance matrix computed using, after removing the burn-in
period, the joint posterior distribution of the parameters (on the
scales specified by <code>trans.list</code>). This matrix might be used to
tune the MCMC algorithm.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gelman, A., Carlin, J.B., Stern, H.S., and Rubin,
D.B. (2004). Bayesian data analysis, 2nd edition, Chapman &amp; Hall/CRC.
</p>
<p>Carlin, B.P, and Louis, T.A. (2009). Bayesian methods for data
analysis. Chapman &amp; Hall/CRC.
</p>
<p>Gamerman, D., and Lopes H.F. (2006). Markov Chain Monte Carlo:
Stochastic simulation for Bayesian inference. 2nd edition, Chapman &amp;
Hall/CRC.
</p>
<p>Gilks, W.R., Richardson, S., and Spiegelhalter, D.J. (1996). Markov
Chain Monte Carlo in Practice. Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.metropolis">plot.metropolis</a></code>, <code><a href="#topic+mle">mle</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
### These examples should be re-run with, e.g., iter &gt; 2000.
data(yarns)
x &lt;- yarns$x
fit.x &lt;- mle(x,'gamma',c(.1,.1))
bayes.x.no.prior &lt;- metropolis(model=fit.x,iter=150,
	trans.list=list(function(x) x,function(x) exp(x)))
plot(bayes.x.no.prior)

# examples of prior distributions (note that these prior distribution
#	are specified for the transformated parameters;
#	i.e., in this case, 'meanlog' -&gt; 'meanlog' and 'sdlog' -&gt; 'ln.sdlog')
# for the scale parameter only
prior.1 &lt;- function(x) dnorm(x[2],.8,.1)
# for both parameters (joint but independent in this case)
prior.2 &lt;- function(x) dunif(x[1],3.4,3.6)*dnorm(x[2],1,1)

bayes.x.prior.2 &lt;- metropolis(model=fit.x,iter=150,
	trans.list=list(function(x) x,function(x) exp(x)),prior=prior.2)
plot(bayes.x.prior.2)

# Example where 'model' is not from the class 'mle'; i.e.
# both 'start' and 'variance' need to be specified!
#x &lt;- rweibull(5,2,1)
x &lt;- c(0.9303492,1.0894917,0.9628029,0.6145032,0.4756699)
# Here 'fit.x &lt;- mle(x,'weibull',c(.1,.1))' is not used,
model.x &lt;- list(x=x,dist='weibull')
# and an informative prior distribution is considered to ensure a proper posterior distribution
prior.x &lt;- function(x) dnorm(x[1],log(2),.1)*dnorm(x[2],log(1),.1)
trans.list.x &lt;- list(function(x) exp(x), function(x) exp(x))
bayes.x &lt;- metropolis(model=model.x,iter=150,prior=prior.x,trans.list=trans.list.x,
            pass.down.to.C=TRUE,start=c(0,0),variance=diag(.1,2,2))

</code></pre>

<hr>
<h2 id='mle'>Maximum Likelihood Estimation of Univariate Probability Distributions</h2><span id='topic+mle'></span>

<h3>Description</h3>

<p>For a given dataset, this function serves to find maximum likelihood parameter estimates for some specified parametric probability distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mle(x, dist, start = NULL, method = "Nelder-Mead")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mle_+3A_x">x</code></td>
<td>
<p>A univariate dataset (a vector).</p>
</td></tr>
<tr><td><code id="mle_+3A_dist">dist</code></td>
<td>
<p>Distribution to be fitted to <code>x</code>.</p>
</td></tr>
<tr><td><code id="mle_+3A_start">start</code></td>
<td>
<p>Starting parameter values for the optimization algorithm (see <code><a href="stats.html#topic+optim">optim</a></code>).</p>
</td></tr>
<tr><td><code id="mle_+3A_method">method</code></td>
<td>
<p>The optimization method to be used (see <code><a href="stats.html#topic+optim">optim</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p><code>optim</code> output (see <code><a href="stats.html#topic+optim">optim</a></code>).</p>
</td></tr>
<tr><td><code>x.info</code></td>
<td>
<p>Array that contains the following columns: 
<br /> <code>i</code>: (<code>1:length(x)</code>), 
<br /> <code>x</code>: (original dataset),
<br /> <code>z</code>: (sorted dataset),
<br /> <code>Fx</code>: (CDF of <code>x</code> evaluated at the estimated parameter values),
<br /> <code>Fz</code>: (sorted values of <code>Fx</code>),
<br /> <code>Emp</code>: (<code>i/(length(x)+1)</code>),
<br /> <code>zF</code>: (<code>distr(Emp,'dist',par.hat,'q')</code> evaluated at estimated parameter values (<code>par.hat</code>)),
<br /> <code>fx</code>: (PDF of <code>x</code> evaluated at the estimated parameter values),
<br /> <code>fz</code>: (PDF of <code>z</code> evaluated at the estimated parameter values)
</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>Distribution fitted to <code>x</code>.</p>
</td></tr>
<tr><td><code>par.hat</code></td>
<td>
<p>Vector of estiamted parameters.</p>
</td></tr>
<tr><td><code>cov.hat</code></td>
<td>
<p>Observed Fisher's information matrix.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>Number of parameters</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of observations (i.e., <code>length(x)</code>).</p>
</td></tr>
<tr><td><code>log.like</code></td>
<td>
<p>Log-likelihood value evaluated at the estimated parameter (i.e. <code>par.hat</code>).</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike information criterion computed as <code>2*k - 2*log.like</code>.</p>
</td></tr>
<tr><td><code>ad</code></td>
<td>
<p>Anderson Darling statistic evaluated at the estimated parameter values.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>Name for <code>x</code>.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>Pearson's correlation coefficient computed as <code>cor(x.info[,'z'],x.info[,'zF'])</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="#topic+distr">distr</a></code>, <code><a href="#topic+boot.mle">boot.mle</a></code>, <code><a href="#topic+metropolis">metropolis</a></code>, <code><a href="#topic+Q.conf.int">Q.conf.int</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(yarns)
x &lt;- yarns$x
fit.x &lt;- mle(x,'weibull',c(.1,.1))
fit.x
names(fit.x)
#plot(fit.x)
#plot(fit.x,TRUE,alpha=.01)
p &lt;- c(.9,.95,.99)
distr(p,model=fit.x,type='q')
Q.conf.int(p,fit.x,.01)
Q.conf.int(p,fit.x,.01,TRUE)
</code></pre>

<hr>
<h2 id='plot.metropolis'>A Function to Plot metropolis objects</h2><span id='topic+plot.metropolis'></span>

<h3>Description</h3>

<p>This function allows to user to call different plots for visual assessment of the posterior distribution(s).</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metropolis'
plot(x, plot.type = "carlin", pos = 1:x$iter, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.metropolis_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+mle">mle</a></code> object corresponding to the fitted model.</p>
</td></tr>
<tr><td><code id="plot.metropolis_+3A_plot.type">plot.type</code></td>
<td>
<p>The user may choose betweew:
<br /> <code>carlin</code> returns the same plot as in Carlin and Louis (2009) (see References);
<br /> <code>ts</code> returns <code><a href="stats.html#topic+plot.ts">plot.ts</a></code>;
<br /> <code>pairs</code> returns a <code><a href="graphics.html#topic+pairs">pairs</a></code>;
<br /> <code>hist</code> returns an <code><a href="graphics.html#topic+hist">hist</a></code> for each marginal posterior distribution;
<br /> <code>post.pred</code> returns an histogram of the data's posterior predictive distribution.
</p>
</td></tr>
<tr><td><code id="plot.metropolis_+3A_pos">pos</code></td>
<td>
<p>May be used by the user to plot a subset (i.e. a random subset, <code>sample</code>)) of the posterior distribution when <code>pairs</code> is called. This avoids using too much memory while building the plot.</p>
</td></tr>
<tr><td><code id="plot.metropolis_+3A_...">...</code></td>
<td>
<p>Additional arguments pertaining to function <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>See list of references for <code><a href="#topic+metropolis">metropolis</a></code>.</p>


<h3>See Also</h3>

<p><code><a href="#topic+metropolis">metropolis</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(yarns)
x &lt;- yarns$x
fit.x &lt;- mle(x,'gamma',c(.1,.1))
bayes.x &lt;- metropolis(model=fit.x,iter=100,
	trans.list=list(function(x) exp(x),function(x) exp(x)))
plot(bayes.x)
plot(bayes.x,'hist',col='cyan')
plot(bayes.x,'pairs',cex=.1,pch=19)
plot(bayes.x,'pairs',pos=sample(1:bayes.x$iter,20),col='red')
plot(bayes.x,'post.pred',col='green')
</code></pre>

<hr>
<h2 id='plot.mle'>Diagnostic Plots for the Fitted Model</h2><span id='topic+plot.mle'></span>

<h3>Description</h3>

<p>This function returns diagnotic plots for a <code><a href="#topic+mle">mle</a></code> object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mle'
plot(x, ci = FALSE, alpha = 0.05,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mle_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+mle">mle</a></code> object corresponding to the fitted model.</p>
</td></tr>
<tr><td><code id="plot.mle_+3A_ci">ci</code></td>
<td>
<p>Whether or not approximate confidence intervals should be added to the return period and quantile plots.</p>
</td></tr>
<tr><td><code id="plot.mle_+3A_alpha">alpha</code></td>
<td>
<p><code>1-alpha</code> is the requested coverage probability for the confidence interval.</p>
</td></tr>
<tr><td><code id="plot.mle_+3A_...">...</code></td>
<td>
<p>none...</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+mle">mle</a></code>, <code><a href="#topic+Q.conf.int">Q.conf.int</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(yarns)
x &lt;- yarns$x
fit.1 &lt;- mle(x,'weibull',c(.1,.1))
fit.2 &lt;- mle(x,'logis',c(.1,.1))
plot(fit.1,TRUE,.05)
dev.new();plot(fit.2,TRUE,.05)
</code></pre>

<hr>
<h2 id='print.metropolis'>Bayesian Estimation of Univariate Probability Distributions</h2><span id='topic+print.metropolis'></span>

<h3>Description</h3>

<p>See <code><a href="#topic+metropolis">metropolis</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metropolis'
print(x, stats.fun = NULL,...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.metropolis_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+metropolis">metropolis</a></code> object corresponding to the fitted model.</p>
</td></tr>
<tr><td><code id="print.metropolis_+3A_stats.fun">stats.fun</code></td>
<td>
<p>An optional function that may be provided by the user in order to obtain a posterior summary (see Example).</p>
</td></tr>
<tr><td><code id="print.metropolis_+3A_...">...</code></td>
<td>
<p>none...</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+metropolis">metropolis</a></code>, <code><a href="base.html#topic+print">print</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(yarns)
x &lt;- yarns$x
fit.x &lt;- mle(x,'gamma',c(.1,.1))
bayes.x &lt;- metropolis(fit.x,50,trans.list=
	list(function(x) exp(x), function(x) exp(x)))
print(bayes.x)
print(bayes.x,stats.fun=function(x) c(mean=mean(x),CV=sd(x)/mean(x)))
</code></pre>

<hr>
<h2 id='print.mle'>Maximum Likelihood Estimation of Univariate Probability Distributions</h2><span id='topic+print.mle'></span>

<h3>Description</h3>

<p>See <code><a href="#topic+mle">mle</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mle'
print(x,...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mle_+3A_x">x</code></td>
<td>
<p><code>mle</code> object corresponding to the fitted model.</p>
</td></tr>
<tr><td><code id="print.mle_+3A_...">...</code></td>
<td>
<p>none...</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+mle">mle</a></code>, <code><a href="base.html#topic+print">print</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(yarns)
x &lt;- yarns$x
fit.x &lt;- mle(x,'gamma',c(.1,.1))
print(fit.x)
print.mle(fit.x)
</code></pre>

<hr>
<h2 id='Q.boot.ci'>Parametric Bootstrap Confidence Intervals for p-th Quantile</h2><span id='topic+Q.boot.ci'></span>

<h3>Description</h3>

<p>This function can be used to derive parametric bootstrap confidence intervals for the <code>p</code>-th quantile of the fitted distribution (see <code><a href="#topic+mle">mle</a></code>).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Q.boot.ci(p,boot,alpha=.1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Q.boot.ci_+3A_p">p</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="Q.boot.ci_+3A_boot">boot</code></td>
<td>
<p>An object obtained using <code><a href="#topic+boot.mle">boot.mle</a></code>.</p>
</td></tr>
<tr><td><code id="Q.boot.ci_+3A_alpha">alpha</code></td>
<td>
<p><code>1-alpha</code> is the interval's coverage probability.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This functions returns two types of bootstrap confidence intervals for the <code>p</code>-th quantile - one is based on the &quot;percentile&quot; method, while the other corresponds to the basis bootstrap interval or &quot;reflexion&quot; (see References).</p>


<h3>Note</h3>

<p>See References for other means of deriving bootstrap intervals.</p>


<h3>References</h3>

<p>Davison, A.C., and Hinkley, D.V. (1997) Bootstrap methods and their application. Cambridge University Press.</p>


<h3>See Also</h3>

<p><code><a href="#topic+boot.mle">boot.mle</a></code>, <code><a href="#topic+mle">mle</a></code>, <code><a href="#topic+Q.conf.int">Q.conf.int</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(yarns)
x &lt;- yarns$x
fit.x &lt;- mle(x,'gamma',c(.1,.1))
Q.conf.int(p=c(.5,.9,.95,.99),model=fit.x,alpha=.01,ln=FALSE)
# should be run again with B = 1000, for example...
boot.x &lt;- boot.mle(model=fit.x,B=50)
Q.boot.ci(p=c(.5,.9,.95,.99),boot=boot.x,alpha=.01)
</code></pre>

<hr>
<h2 id='Q.conf.int'>Approximate Confidence Intervals for p-th Quantile</h2><span id='topic+Q.conf.int'></span>

<h3>Description</h3>

<p>This function can be used to derive approximate confidence intervals for the <code>p</code>-th quantile of the fitted distribution (see <code><a href="#topic+mle">mle</a></code>).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Q.conf.int(p, model, alpha = 0.1, ln = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Q.conf.int_+3A_p">p</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="Q.conf.int_+3A_model">model</code></td>
<td>
<p><code>mle</code> object corresponding to the fitted model.</p>
</td></tr>
<tr><td><code id="Q.conf.int_+3A_alpha">alpha</code></td>
<td>
<p><code>1-alpha</code> is the interval's coverage probability.</p>
</td></tr>
<tr><td><code id="Q.conf.int_+3A_ln">ln</code></td>
<td>
<p>whether or not the confidence interval of the <code>p</code>-th quantile should be computed on the natural logarithmic scale (see Details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The p-th quantile confidence interval is derived using the observed Fisher's information matrix in conjuction with the well-known delta method. Here, <code>Q.conf.int</code> allows the user to chose between two types of confidence intervals: one that is computed on the original scale and one that is computed on the quantile's natural logarithmic scale.
</p>


<h3>Value</h3>

<p>The function returns a 3-by-<code>length(p)</code> array containing, for each value of <code>p</code>, the confidence interval's lower and upper bounds, as well as the quantile point estimate (maximum likelihood).</p>


<h3>References</h3>

<p>Rice, J.A. (2006) Mathematical statistics and data analysis. Duxbury Press, 3rd edition (regarding the Delta method).</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.mle">plot.mle</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(yarns)
x &lt;- yarns$x
fit.x &lt;- mle(x,'gamma',c(.1,.1))
Q.conf.int(p=c(.5,.9,.95,.99),model=fit.x,alpha=.01,ln=FALSE)
Q.conf.int(p=c(.5,.9,.95,.99),model=fit.x,alpha=.01,ln=TRUE)
</code></pre>

<hr>
<h2 id='station01AJ010'>Annual Maximum Daily Mean Flow Data (NB, Canada)</h2><span id='topic+station01AJ010'></span>

<h3>Description</h3>

<p>This dataset is taken from the HYDAT database, and corresponds to realized values of annual maximum daily mean flows (in <code class="reqn">m^3/s</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(station01AJ010)</code></pre>


<h3>Format</h3>

<p>A vector of observations.</p>


<h3>Source</h3>

<p>Hydrometric station 01AJ010</p>


<h3>References</h3>

<p>Environment Canada: <a href="https://wateroffice.ec.gc.ca/">https://wateroffice.ec.gc.ca/</a>
</p>

<hr>
<h2 id='yarns'>Yarns Failure Data</h2><span id='topic+yarns'></span>

<h3>Description</h3>

<p>This dataset is taken from Gamerman and Lopes (2006) (also see references therein), and consists of 100 cycles-to-failure times for airplane yarns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(yarns)</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> object - one column of 100 observations.</p>


<h3>Source</h3>

<p>Gamerman and Lopes (2006), page 255 (also see references therein).</p>


<h3>References</h3>

<p>Gamerman, D., and Lopes H.F. (2006). Markov Chain Monte Carlo: Stochastic simulation for Bayesian inference. 2nd edition, Chapman &amp; Hall/CRC.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
