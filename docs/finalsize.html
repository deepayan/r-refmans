<!DOCTYPE html><html lang="en-GB"><head><title>Help for package finalsize</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {finalsize}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#finalsize-package'><p>finalsize: Calculate the Final Size of an Epidemic</p></a></li>
<li><a href='#.final_size'><p>Calculate the final size of an epidemic</p></a></li>
<li><a href='#final_size'><p>Final size of an epidemic</p></a></li>
<li><a href='#polymod_uk'><p>Example POLYMOD social contact data for the U.K.</p></a></li>
<li><a href='#r0_conversions'><p>Converts between epidemiological parameters related to <code class="reqn">R_0</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Calculate the Final Size of an Epidemic</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate the final size of a
    susceptible-infectious-recovered epidemic in a population with
    demographic variation in contact patterns and susceptibility to
    disease, as discussed in Miller (2012)
    &lt;<a href="https://doi.org/10.1007%2Fs11538-012-9749-6">doi:10.1007/s11538-012-9749-6</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/epiverse-trace/finalsize">https://github.com/epiverse-trace/finalsize</a>,
<a href="https://epiverse-trace.github.io/finalsize/">https://epiverse-trace.github.io/finalsize/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/epiverse-trace/finalsize/issues">https://github.com/epiverse-trace/finalsize/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bookdown, colorspace, dplyr, forcats, ggplot2, ggtext, knitr,
purrr, rmarkdown, scales, socialmixr, spelling, testthat (&ge;
3.0.0), tibble, tidyr, xml2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>epiverse-trace/epiversetheme</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-09 16:21:41 UTC; lshpg6</td>
</tr>
<tr>
<td>Author:</td>
<td>Pratik Gupte <a href="https://orcid.org/0000-0001-5294-7819"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Edwin Van Leeuwen <a href="https://orcid.org/0000-0002-2383-5305"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Adam Kucharski <a href="https://orcid.org/0000-0001-8814-9421"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Rosalind Eggo <a href="https://orcid.org/0000-0002-0362-6717"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Hugo Gruson <a href="https://orcid.org/0000-0002-4094-1476"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Thibaut Jombart <a href="https://orcid.org/0000-0003-3796-2097"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Andree Valle-Campos
    <a href="https://orcid.org/0000-0002-7779-481X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Joshua W. Lambert <a href="https://orcid.org/0000-0001-5218-3046"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [rev]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pratik Gupte &lt;pratik.gupte@lshtm.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-09 16:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='finalsize-package'>finalsize: Calculate the Final Size of an Epidemic</h2><span id='topic+finalsize'></span><span id='topic+finalsize-package'></span>

<h3>Description</h3>

<p>Calculate the final size of a susceptible-infectious-recovered epidemic in a population with demographic variation in contact patterns and susceptibility to disease, as discussed in Miller (2012) <a href="https://doi.org/10.1007/s11538-012-9749-6">doi:10.1007/s11538-012-9749-6</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Pratik Gupte <a href="mailto:pratik.gupte@lshtm.ac.uk">pratik.gupte@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-5294-7819">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Edwin Van Leeuwen <a href="mailto:edwin.vanleeuwen@ukhsa.gov.uk">edwin.vanleeuwen@ukhsa.gov.uk</a> (<a href="https://orcid.org/0000-0002-2383-5305">ORCID</a>) [copyright holder]
</p>
</li>
<li><p> Adam Kucharski <a href="mailto:adam.kucharski@lshtm.ac.uk">adam.kucharski@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-8814-9421">ORCID</a>) [copyright holder]
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Rosalind Eggo <a href="mailto:r.eggo@lshtm.ac.uk">r.eggo@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0002-0362-6717">ORCID</a>) [contributor]
</p>
</li>
<li><p> Hugo Gruson <a href="mailto:hugo.gruson@data.org">hugo.gruson@data.org</a> (<a href="https://orcid.org/0000-0002-4094-1476">ORCID</a>) [contributor]
</p>
</li>
<li><p> Thibaut Jombart <a href="mailto:thibaut@data.org">thibaut@data.org</a> (<a href="https://orcid.org/0000-0003-3796-2097">ORCID</a>) [contributor]
</p>
</li>
<li><p> Andree Valle-Campos <a href="mailto:andree.valle-campos@lshtm.ac.uk">andree.valle-campos@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0002-7779-481X">ORCID</a>) [contributor]
</p>
</li>
<li><p> Joshua W. Lambert <a href="mailto:joshua.lambert@lshtm.ac.uk">joshua.lambert@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-5218-3046">ORCID</a>) [reviewer]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/epiverse-trace/finalsize">https://github.com/epiverse-trace/finalsize</a>
</p>
</li>
<li> <p><a href="https://epiverse-trace.github.io/finalsize/">https://epiverse-trace.github.io/finalsize/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/epiverse-trace/finalsize/issues">https://github.com/epiverse-trace/finalsize/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.final_size'>Calculate the final size of an epidemic</h2><span id='topic+.final_size'></span>

<h3>Description</h3>

<p>An internal function that interfaces between the R function
<code>final_size()</code> and functions in the package header.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.final_size(parameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".final_size_+3A_parameters">parameters</code></td>
<td>
<p>A named list of parameters for the final size calculation.
See the R function documentation for details and input checking.</p>
</td></tr>
</table>

<hr>
<h2 id='final_size'>Final size of an epidemic</h2><span id='topic+final_size'></span>

<h3>Description</h3>

<p><code>final_size</code> calculates the final size of an epidemic outbreak
with a given <code class="reqn">R_0</code>, with options for specifying a population with
heterogeneous mixing, and with heterogeneous susceptibility to infection
such as that conferred by an immunisation programme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>final_size(
  r0,
  contact_matrix = matrix(1),
  demography_vector = 1,
  susceptibility = matrix(1),
  p_susceptibility = matrix(1),
  solver = c("iterative", "newton"),
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="final_size_+3A_r0">r0</code></td>
<td>
<p>The basic reproductive number <code class="reqn">R_0</code> of the disease.</p>
</td></tr>
<tr><td><code id="final_size_+3A_contact_matrix">contact_matrix</code></td>
<td>
<p>Social contact matrix. Entry <code class="reqn">m_{ij}</code> gives average
number of contacts in group <code class="reqn">i</code> reported by participants in group <code class="reqn">j</code>
. Defaults to the singleton matrix <code class="reqn">[1]</code>, representing a homogeneously
mixing population.</p>
</td></tr>
<tr><td><code id="final_size_+3A_demography_vector">demography_vector</code></td>
<td>
<p>Demography vector. Entry <code class="reqn">v_{i}</code> gives
proportion of total population in group <code class="reqn">i</code> (model will normalise
if needed).
Defaults to <code>1</code>, representing a population where demographic structure is not
important (or not known), and where all individuals are assumed to belong to
the same demographic group.</p>
</td></tr>
<tr><td><code id="final_size_+3A_susceptibility">susceptibility</code></td>
<td>
<p>A matrix giving the susceptibility of individuals in
demographic group <code class="reqn">i</code> and risk group <code class="reqn">k</code>.
Defaults to the singleton matrix <code class="reqn">[1]</code>, representing a population where
all individuals are fully susceptible to infection.</p>
</td></tr>
<tr><td><code id="final_size_+3A_p_susceptibility">p_susceptibility</code></td>
<td>
<p>A matrix giving the probability that an individual
in demography group <code class="reqn">i</code> is in risk (or susceptibility) group <code class="reqn">k</code>.
Each row represents the overall distribution of individuals in demographic
group <code class="reqn">i</code> across risk groups, and each row <em>must sum to 1.0</em>.
Defaults to the singleton matrix <code class="reqn">[1]</code>, representing a population where
all individuals are fully susceptible.</p>
</td></tr>
<tr><td><code id="final_size_+3A_solver">solver</code></td>
<td>
<p>Which solver to use. Options are &quot;iterative&quot; (default) or
&quot;newton&quot;, for the iterative solver, or the Newton solver, respectively.
Special conditions apply when using the Newton solver, see the <code>control</code>
argument.</p>
</td></tr>
<tr><td><code id="final_size_+3A_control">control</code></td>
<td>
<p>A list of named solver options, see <em>Solver options</em>.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Specifying heterogeneous mixing and susceptibility</h4>

<p><code>final_size()</code> allows for heterogeneous population mixing and susceptibility,
and this is described in the dedicated vignettes:
</p>

<ol>
<li><p> Heterogeneous population mixing: See vignette on
&quot;Modelling heterogeneous social contacts&quot;
(<code>vignette("varying_contacts", package = "finalsize")</code>);
</p>
</li>
<li><p> Heterogeneous susceptibility to infection: See vignette on
&quot;Modelling heterogeneous susceptibility&quot;
(<code>vignette("varying_susceptibility", package = "finalsize")</code>).
</p>
</li></ol>




<h4>Solver options</h4>

<p>The <code>control</code> argument accepts a list of solver options, with the iterative
solver taking two extra arguments than the Newton solver. This is an optional
argument, and default options are used within the solver functions if an
argument is missing. Arguments provided override the solver defaults.
</p>


<h5>Common options</h5>


<ol>
<li> <p><code>iterations</code>: The number of iterations over which to solve for the final
size, unless the error is below the solver tolerance. Default = 10000.
</p>
</li>
<li> <p><code>tolerance</code>: The solver tolerance; solving for final size ends when the
error drops below this tolerance. Defaults to set <code>1e-6</code>. Larger tolerance
values are likely to lead to inaccurate final size estimates.
</p>
</li></ol>





<h4>Iterative solver options</h4>


<ol>
<li> <p><code>step_rate</code>: The solver step rate. Defaults to 1.9 as a value found to
work well.
</p>
</li>
<li> <p><code>adapt_step</code>: Boolean, whether the solver step rate should be changed
based on the solver error. Defaults to TRUE.
</p>
</li></ol>




<h3>Value</h3>

<p>A data.frame of the proportion of infected individuals, within each
demography group and susceptibility group combination.
If the demography groups and susceptibility groups are named, these
names are added to relevant columns. If the groups are not named, synthetic
names are added of the form <code style="white-space: pre;">&#8288;demo_grp_&lt;i&gt;&#8288;</code>, for each demographic group
<code class="reqn">i</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## For a given R_0
r0 &lt;- 2.0
final_size(r0)

## For a population with multiple demographic groups
# load example POLYMOD data included in the package
data(polymod_uk)
contact_matrix &lt;- polymod_uk$contact_matrix
demography_vector &lt;- polymod_uk$demography_vector

# define the number of age and susceptibility groups
n_demo_grps &lt;- length(demography_vector)
n_risk_grps &lt;- 3

# In this example, all risk groups from all age groups are fully
# susceptible, and the final size in each group is influenced only by
# differences in social contacts
susceptibility &lt;- matrix(
  data = 1, nrow = n_demo_grps, ncol = n_risk_grps
)

p_susceptibility &lt;- matrix(
  data = 1, nrow = n_demo_grps, ncol = n_risk_grps
)
# p_susceptibility rows must sum to 1.0
p_susceptibility &lt;- p_susceptibility / rowSums(p_susceptibility)

# using default arguments for `solver` and `control`
final_size(
  r0 = r0,
  contact_matrix = contact_matrix,
  demography_vector = demography_vector,
  susceptibility = susceptibility,
  p_susceptibility = p_susceptibility
)

## Using manually specified solver settings for the iterative solver
control &lt;- list(
  iterations = 100,
  tolerance = 1e-3,
  step_rate = 1.9,
  adapt_step = TRUE
)

final_size(
  r0 = r0,
  contact_matrix = contact_matrix,
  demography_vector = demography_vector,
  susceptibility = susceptibility,
  p_susceptibility = p_susceptibility,
  solver = "iterative",
  control = control
)

## Using manually specified solver settings for the newton solver
control &lt;- list(
  iterations = 100,
  tolerance = 1e-3
)

final_size(
  r0 = r0,
  contact_matrix = contact_matrix,
  demography_vector = demography_vector,
  susceptibility = susceptibility,
  p_susceptibility = p_susceptibility,
  solver = "newton",
  control = control
)
</code></pre>

<hr>
<h2 id='polymod_uk'>Example POLYMOD social contact data for the U.K.</h2><span id='topic+polymod_uk'></span>

<h3>Description</h3>

<p>An example of social contact and demography data for use with <code>finalsize</code>,
accessed from the POLYMOD social contacts dataset using the <code>socialmixr</code>
package. Data are for the United Kingdom, and age limits are set at 0, 20,
and 40 years, with <code>symmetric = TRUE</code>. Code to get these data is
given in <code>data-raw/polymod_uk.R</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polymod_uk
</code></pre>


<h3>Format</h3>



<h4><code>polymod_uk</code></h4>

<p>A list with two named elements:
</p>

<dl>
<dt>contact_matrix</dt><dd><p>A contact matrix with mean contacts between age
groups. This matrix is scaled by its largest real eigenvalue, and  each
row is scaled by the corresponding element in the <code>demography_vector</code>.</p>
</dd>
<dt>demography_vector</dt><dd><p>A vector with the number of individuals in each of
three age groups: 0 &ndash; 20, 20 &ndash; 40, 40+.</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://doi.org/10.1371/journal.pmed.0050074">doi:10.1371/journal.pmed.0050074</a>; obtained using
<code>socialmixr::polymod</code>. See further methods in <code>data-raw/polymod_uk.R</code>.
</p>

<hr>
<h2 id='r0_conversions'>Converts between epidemiological parameters related to <code class="reqn">R_0</code></h2><span id='topic+r0_conversions'></span><span id='topic+lambda_to_r0'></span><span id='topic+r0_to_lambda'></span><span id='topic+r_eff'></span>

<h3>Description</h3>

<p>Converts between <code class="reqn">R_0</code> and the transmission rate
<code class="reqn">\lambda</code>, or calculates
the effective reproduction number <code class="reqn">R_\text{eff}</code> for a population,
while accounting for population characteristics including demographic
heterogeneity in social contacts, heterogeneity in the demographic
distribution, and heterogeneity in susceptibility to infection.
</p>
<p>Uses the R0 (<code class="reqn">R_0</code>), contact matrix (<code class="reqn">C</code>),
population (<code class="reqn">N</code>), and infectious period (<code class="reqn">\gamma</code>)
to calculate the transmission rate using the following equation.
</p>
<p style="text-align: center;"><code class="reqn">\lambda = R_0 / ({Max}(EV(C)) \gamma)</code>
</p>

<p>where <code class="reqn">EV(C)</code> denotes the eigenvalues of the matrix <code class="reqn">C</code> which is
calculated from the social contacts matrix scaled by the number of
individuals in each demographic and susceptibility group in the population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda_to_r0(
  lambda,
  contact_matrix,
  demography_vector,
  susceptibility,
  p_susceptibility,
  infectious_period = 1.8
)

r0_to_lambda(
  r0,
  contact_matrix,
  demography_vector,
  susceptibility,
  p_susceptibility,
  infectious_period = 1.8
)

r_eff(r0, contact_matrix, demography_vector, susceptibility, p_susceptibility)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="r0_conversions_+3A_lambda">lambda</code></td>
<td>
<p>The transmission rate of the disease, also called the 'force of
infection' (<code class="reqn">\lambda</code>). This is different from the effective
transmission rate (<code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="r0_conversions_+3A_contact_matrix">contact_matrix</code></td>
<td>
<p>Social contact matrix. Entry <code class="reqn">m_{ij}</code> gives average
number of contacts in group <code class="reqn">i</code> reported by participants in group <code class="reqn">j</code></p>
</td></tr>
<tr><td><code id="r0_conversions_+3A_demography_vector">demography_vector</code></td>
<td>
<p>Demography vector. Entry <code class="reqn">v_{i}</code> gives
proportion of total population in group <code class="reqn">i</code>.</p>
</td></tr>
<tr><td><code id="r0_conversions_+3A_susceptibility">susceptibility</code></td>
<td>
<p>A matrix giving the susceptibility of individuals in
demographic group <code class="reqn">i</code> and risk group <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code id="r0_conversions_+3A_p_susceptibility">p_susceptibility</code></td>
<td>
<p>A matrix giving the probability that an individual
in demography group <code class="reqn">i</code> is in risk (or susceptibility) group <code class="reqn">k</code>.
Each row represents the overall distribution of individuals in demographic
group <code class="reqn">i</code> across risk groups, and each row <em>must sum to 1.0</em>.</p>
</td></tr>
<tr><td><code id="r0_conversions_+3A_infectious_period">infectious_period</code></td>
<td>
<p>Duration of the infectious period in days.
Default value is 1.8 days.</p>
</td></tr>
<tr><td><code id="r0_conversions_+3A_r0">r0</code></td>
<td>
<p>The basic reproductive number <code class="reqn">R_0</code> of the infection.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given the transmission rate (<code class="reqn">\lambda</code>),
social contacts matrix (<code class="reqn">c</code>), demography (<code class="reqn">N</code>), the
distribution <code class="reqn">P</code> of each demographic group <code class="reqn">i</code> into
susceptibility groups <code class="reqn">S</code>, and the infectious period (<code class="reqn">\gamma</code>)
</p>

<ul>
<li> <p><code>r_eff()</code> calculates the effective reproductive number;
</p>
</li>
<li> <p><code>lamda_to_r0()</code> calculates the <code class="reqn">R_0</code> from the transmission rate as
</p>
<p style="text-align: center;"><code class="reqn">R_0 = {Max}(EV(C)) \times \lambda \gamma</code>
</p>

</li>
<li> <p><code>r0_to_lambda()</code> calculates the transmission rate as
</p>
<p style="text-align: center;"><code class="reqn">\lambda = R_0 / ({Max}(EV(C)) \gamma)</code>
</p>

<p>Note that this is also called the 'force of infection' and is different from
the effective transmission rate often denoted <code class="reqn">\beta</code>.
</p>
</li></ul>

<p>Here, <code class="reqn">EV(C)</code> denotes the eigenvalues of the matrix <code class="reqn">C</code> which is
calculated from the social contacts matrix scaled by the number of
individuals in each demographic and susceptibility group in the population.
</p>


<h3>Value</h3>

<p>Returns a single number for the calculated value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Prepare data ####
# Get example dataset and prepare contact matrix and demography
data(polymod_uk)
contact_matrix &lt;- polymod_uk$contact_matrix
demography_vector &lt;- polymod_uk$demography_vector

# define lambda
lambda &lt;- 0.3

# define infectious period of 5 days
infectious_period &lt;- 5
# define the number of age and susceptibility groups
n_demo_grps &lt;- length(demography_vector)
n_risk_grps &lt;- 3

# In this example, risk varies across groups
susceptibility &lt;- matrix(
  data = c(0.5, 0.7, 1.0), nrow = n_demo_grps, ncol = n_risk_grps
)

# risk does not vary within groups
p_susceptibility &lt;- matrix(
  data = 1, nrow = n_demo_grps, ncol = n_risk_grps
)
# p_susceptibility rows must sum to 1.0
p_susceptibility &lt;- p_susceptibility / rowSums(p_susceptibility)

#### Effective R ####
r0 &lt;- 2.0
r_eff(
  r0 = r0,
  contact_matrix = contact_matrix,
  demography_vector = demography_vector,
  susceptibility = susceptibility,
  p_susceptibility = p_susceptibility
)

#### Transmission rate to R0 ####
lambda_to_r0(
  lambda, contact_matrix, demography_vector,
  susceptibility, p_susceptibility,
  infectious_period
)

#### R0 to Transmission rate ####
r0 &lt;- 1.5
r0_to_lambda(
  r0, contact_matrix, demography_vector,
  susceptibility, p_susceptibility,
  infectious_period
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
