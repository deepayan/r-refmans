<!DOCTYPE html><html lang="en"><head><title>Help for package ATE.ERROR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ATE.ERROR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ATE.ERROR-package'><p>ATE.ERROR: Estimating ATE with Misclassified Outcomes and Mismeasured Covariates</p></a></li>
<li><a href='#ATE.ERROR.XY'><p>ATE.ERROR.XY Function for Estimating Average Treatment Effect (ATE) with Measurement Error in X and Misclassification in Y</p></a></li>
<li><a href='#ATE.ERROR.Y'><p>ATE.ERROR.Y Function for Estimating Average Treatment Effect (ATE) with Misclassification in Y</p></a></li>
<li><a href='#Naive_Estimation'><p>Naive Estimation of Average Treatment Effect</p></a></li>
<li><a href='#Simulated_data'><p>Simulated Data</p></a></li>
<li><a href='#True_Estimation'><p>True Estimation of Average Treatment Effect</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimating ATE with Misclassified Outcomes and Mismeasured
Covariates</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Addressing measurement error in covariates and misclassification in binary outcome variables within causal inference, the 'ATE.ERROR' package implements inverse probability weighted estimation methods proposed by Shu and Yi (2017, &lt;<a href="https://doi.org/10.1177%2F0962280217743777">doi:10.1177/0962280217743777</a>&gt;; 2019, &lt;<a href="https://doi.org/10.1002%2Fsim.8073">doi:10.1002/sim.8073</a>&gt;). These methods correct errors to accurately estimate average treatment effects (ATE). The package includes two main functions: ATE.ERROR.Y() for handling misclassification in the outcome variable and ATE.ERROR.XY() for correcting both outcome misclassification and covariate measurement error. It employs logistic regression for treatment assignment and uses bootstrap sampling to calculate standard errors and confidence intervals, with simulated datasets provided for practical demonstration.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-05 02:37:25 UTC; rezanejad</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, MASS, mvtnorm, rlang, stats</td>
</tr>
<tr>
<td>Author:</td>
<td>Aryan Rezanezhad [aut, cre],
  Grace Y. Yi [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aryan Rezanezhad &lt;Aryan.rzn@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-10 09:10:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='ATE.ERROR-package'>ATE.ERROR: Estimating ATE with Misclassified Outcomes and Mismeasured Covariates</h2><span id='topic+ATE.ERROR'></span><span id='topic+ATE.ERROR-package'></span>

<h3>Description</h3>

<p>Addressing measurement error in covariates and misclassification in binary outcome variables within causal inference, the 'ATE.ERROR' package implements inverse probability weighted estimation methods proposed by Shu and Yi (2017, <a href="https://doi.org/10.1177/0962280217743777">doi:10.1177/0962280217743777</a>; 2019, <a href="https://doi.org/10.1002/sim.8073">doi:10.1002/sim.8073</a>). These methods correct errors to accurately estimate average treatment effects (ATE). The package includes two main functions: ATE.ERROR.Y() for handling misclassification in the outcome variable and ATE.ERROR.XY() for correcting both outcome misclassification and covariate measurement error. It employs logistic regression for treatment assignment and uses bootstrap sampling to calculate standard errors and confidence intervals, with simulated datasets provided for practical demonstration.
</p>
<p>Addressing measurement error in covariates and misclassification in binary outcome variables within causal inference, the 'ATE.ERROR' package implements inverse probability weighted estimation methods proposed by Shu and Yi (2017, <a href="https://doi.org/10.1177/0962280217743777">doi:10.1177/0962280217743777</a>; 2019, <a href="https://doi.org/10.1002/sim.8073">doi:10.1002/sim.8073</a>). These methods correct errors to accurately estimate average treatment effects (ATE). The package includes two main functions: ATE.ERROR.Y() for handling misclassification in the outcome variable and ATE.ERROR.XY() for correcting both outcome misclassification and covariate measurement error. It employs logistic regression for treatment assignment and uses bootstrap sampling to calculate standard errors and confidence intervals, with simulated datasets provided for practical demonstration.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Aryan Rezanezhad <a href="mailto:Aryan.rzn@gmail.com">Aryan.rzn@gmail.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Grace Y. Yi <a href="mailto:gyi5@uwo.ca">gyi5@uwo.ca</a>
</p>
</li></ul>


<hr>
<h2 id='ATE.ERROR.XY'>ATE.ERROR.XY Function for Estimating Average Treatment Effect (ATE) with Measurement Error in X and Misclassification in Y</h2><span id='topic+ATE.ERROR.XY'></span>

<h3>Description</h3>

<p>The <code>ATE.ERROR.XY</code> function implements a method for estimating the Average Treatment Effect (ATE) that accounts for both measurement error in covariates and misclassification in the binary outcome variable Y.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ATE.ERROR.XY(
  Y_star,
  A,
  Z,
  X_star,
  p11,
  p10,
  sigma_epsilon,
  B = 100,
  Lambda = seq(0, 2, by = 0.5),
  extrapolation = "linear",
  bootstrap_number = 250
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ATE.ERROR.XY_+3A_y_star">Y_star</code></td>
<td>
<p>Numeric vector. The observed binary outcome variable, possibly misclassified.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.XY_+3A_a">A</code></td>
<td>
<p>Numeric vector. The treatment indicator (1 if treated, 0 if control).</p>
</td></tr>
<tr><td><code id="ATE.ERROR.XY_+3A_z">Z</code></td>
<td>
<p>Numeric vector. A precisely measured covariate vector.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.XY_+3A_x_star">X_star</code></td>
<td>
<p>Numeric vector. A covariate vector subject to measurement error.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.XY_+3A_p11">p11</code></td>
<td>
<p>Numeric. The probability of correctly classified Y given Y = 1.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.XY_+3A_p10">p10</code></td>
<td>
<p>Numeric. The probability of misclassified Y given Y = 0.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.XY_+3A_sigma_epsilon">sigma_epsilon</code></td>
<td>
<p>Numeric. The covariance matrix Sigma_epsilon for the measurement error model.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.XY_+3A_b">B</code></td>
<td>
<p>Integer. The number of simulated datasets.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.XY_+3A_lambda">Lambda</code></td>
<td>
<p>Numeric vector. A sequence of lambda values for simulated datasets.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.XY_+3A_extrapolation">extrapolation</code></td>
<td>
<p>Character. A regression model used for extrapolation (&quot;linear&quot;, &quot;quadratic&quot;, &quot;nonlinear&quot;).</p>
</td></tr>
<tr><td><code id="ATE.ERROR.XY_+3A_bootstrap_number">bootstrap_number</code></td>
<td>
<p>Numeric. The number of bootstrap samples (default is 250).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>ATE.ERROR.XY</code> function is designed to handle measurement error in covariates and misclassification in outcomes by using the augmented simulation-extrapolation approach.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<dl>
<dt>summary</dt><dd><p>A data frame with the following columns:
</p>

<ul>
<li> <p><code>Naive_ATE</code>: Naive estimate of the ATE.
</p>
</li>
<li> <p><code>Sigma_epsilon</code>: The covariance matrix Sigma_epsilon for the measurement error model.
</p>
</li>
<li> <p><code>p10</code>: The probability of misclassified Y given Y = 0.
</p>
</li>
<li> <p><code>p11</code>: The probability of correctly classified Y given Y = 1.
</p>
</li>
<li> <p><code>Extrapolation</code>:  A regression model used for extrapolation (&quot;linear&quot;, &quot;quadratic&quot;, &quot;nonlinear&quot;).
</p>
</li>
<li> <p><code>ATE</code>: Mean ATE estimate from the bootstrap samples.
</p>
</li>
<li> <p><code>SE</code>: Standard error of the ATE estimate.
</p>
</li>
<li> <p><code>CI</code>: 95% confidence interval for the ATE estimate.
</p>
</li></ul>

</dd>
<dt>boxplot</dt><dd><p>A ggplot object representing the boxplot of the ATE estimates.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
library(ATE.ERROR)
data(Simulated_data)
Y_star &lt;- Simulated_data$Y_star
A &lt;- Simulated_data$T
Z &lt;- Simulated_data$Z
X_star &lt;- Simulated_data$X_star
p11 &lt;- 0.8
p10 &lt;- 0.2
sigma_epsilon &lt;- 0.1
B &lt;- 100
Lambda &lt;- seq(0, 2, by = 0.5)
bootstrap_number &lt;- 10
result &lt;- ATE.ERROR.XY(Y_star, A, Z, X_star, p11, p10, sigma_epsilon, B, Lambda, 
                       "linear", bootstrap_number)
print(result$summary)
print(result$boxplot)


</code></pre>

<hr>
<h2 id='ATE.ERROR.Y'>ATE.ERROR.Y Function for Estimating Average Treatment Effect (ATE) with Misclassification in Y</h2><span id='topic+ATE.ERROR.Y'></span>

<h3>Description</h3>

<p>This function performs estimation of the Average Treatment Effect (ATE) using the ATE.ERROR.Y method,
which accounts for misclassification in the binary outcome variable Y. The method calculates consistent estimates
of the ATE in the presence of misclassified outcomes by leveraging logistic regression and bootstrap sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ATE.ERROR.Y(Y_star, A, Z, X, p11, p10, bootstrap_number = 250)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ATE.ERROR.Y_+3A_y_star">Y_star</code></td>
<td>
<p>Numeric vector. The observed binary outcome variable, which may be subject to misclassification.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.Y_+3A_a">A</code></td>
<td>
<p>Numeric vector. The binary treatment indicator (1 if treated, 0 if control).</p>
</td></tr>
<tr><td><code id="ATE.ERROR.Y_+3A_z">Z</code></td>
<td>
<p>Numeric vector. A precisely measured covariate vector.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.Y_+3A_x">X</code></td>
<td>
<p>Numeric vector. A precisely measured covariate vector.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.Y_+3A_p11">p11</code></td>
<td>
<p>Numeric. The probability of correctly classified Y given Y = 1.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.Y_+3A_p10">p10</code></td>
<td>
<p>Numeric. The probability of misclassified Y given Y = 0.</p>
</td></tr>
<tr><td><code id="ATE.ERROR.Y_+3A_bootstrap_number">bootstrap_number</code></td>
<td>
<p>Integer. The number of bootstrap samples (default is 250) used to obtain the associated variance estimate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first calculates consistent estimates of the ATE, correcting for misclassification in the outcome variable Y.
The logistic model is used to estimate the propensity scores for the treatment assignment, which are then adjusted using the provided
misclassification probabilities p11 and p10. Bootstrap sampling is performed to estimate the variance and construct confidence intervals
for the ATE estimates.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<dl>
<dt>summary</dt><dd><p>A data frame with the following columns:
</p>

<ul>
<li> <p><strong>Naive_ATE</strong>: Naive estimate of the ATE, ignoring misclassification.
</p>
</li>
<li> <p><strong>ATE</strong>: Mean ATE estimate from the bootstrap samples, accounting for misclassification.
</p>
</li>
<li> <p><strong>SE</strong>: Standard error of the ATE estimate.
</p>
</li>
<li> <p><strong>CI</strong>: 95% confidence interval for the ATE estimate.
</p>
</li></ul>

</dd>
<dt>boxplot</dt><dd><p>A ggplot object representing the boxplot of the ATE estimates.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>library(ATE.ERROR)
data(Simulated_data)
Y_star &lt;- Simulated_data$Y_star
A &lt;- Simulated_data$T
Z &lt;- Simulated_data$Z
X &lt;- Simulated_data$X
p11 &lt;- 0.8
p10 &lt;- 0.2
bootstrap_number &lt;- 250
result &lt;- ATE.ERROR.Y(Y_star, A, Z, X, p11, p10, bootstrap_number)
print(result$summary)
print(result$boxplot)

</code></pre>

<hr>
<h2 id='Naive_Estimation'>Naive Estimation of Average Treatment Effect</h2><span id='topic+Naive_Estimation'></span>

<h3>Description</h3>

<p>This function performs a naive estimation of the ATE.
This approach gives us the so-called &quot;naive estimate&quot; by ignoring the difference between
(X*, Y*) and (X, Y).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Naive_Estimation(Y_star, A, Z, X_star)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Naive_Estimation_+3A_y_star">Y_star</code></td>
<td>
<p>A numeric vector of outcomes with potential misclassification.</p>
</td></tr>
<tr><td><code id="Naive_Estimation_+3A_a">A</code></td>
<td>
<p>A numeric vector of treatment assignments.</p>
</td></tr>
<tr><td><code id="Naive_Estimation_+3A_z">Z</code></td>
<td>
<p>A numeric vector of covariate Z.</p>
</td></tr>
<tr><td><code id="Naive_Estimation_+3A_x_star">X_star</code></td>
<td>
<p>A numeric vector of covariate X with measurement error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value representing the estimated treatment effect.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ATE.ERROR)
data(Simulated_data)
Y_star &lt;- Simulated_data$Y_star
A &lt;- Simulated_data$T
Z &lt;- Simulated_data$Z
X_star &lt;- Simulated_data$X_star
Naive_ATE_XY &lt;- Naive_Estimation(Y_star, A, Z, X_star)
print(Naive_ATE_XY)
</code></pre>

<hr>
<h2 id='Simulated_data'>Simulated Data</h2><span id='topic+Simulated_data'></span>

<h3>Description</h3>

<p>A dataset containing simulated data generated by the generate_data function.
This data includes misclassified outcome Y*, treatment assignment T,
and covariates X and Z.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Simulated_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 5000 rows and 6 variables:
</p>

<dl>
<dt>X</dt><dd><p>a numeric vector generated from a standard normal distribution (mean = 0, standard deviation = 1)</p>
</dd>
<dt>X_star</dt><dd><p>a numeric vector where X_star is equal to X plus a random error. The random error is generated from a normal distribution with mean 0 and standard deviation 0.1</p>
</dd>
<dt>Y</dt><dd><p>a numeric vector generated from a Bernoulli distribution with a probability depending on T, Z, and X</p>
</dd>
<dt>Y_star</dt><dd><p>a numeric vector where Y_star is generated from a binomial distribution depending on Y with probabilities 0.8 if Y equals 1 and 0.2 if Y equals 0</p>
</dd>
<dt>T</dt><dd><p>a numeric vector generated from a binomial distribution with probability calculated using the logistic function of the sum of 0.2, Z, and X</p>
</dd>
<dt>Z</dt><dd><p>a numeric vector generated from a standard normal distribution (mean = 0, standard deviation = 1)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Shu D, Yi GY (2019). Weighted causal inference methods with mismeasured covariates and misclassified outcomes. Statistics in Medicine. 38:1835-1854. <a href="https://doi.org/10.1002/sim.8073">doi:10.1002/sim.8073</a>
</p>

<hr>
<h2 id='True_Estimation'>True Estimation of Average Treatment Effect</h2><span id='topic+True_Estimation'></span>

<h3>Description</h3>

<p>This function performs a true estimation of the Average Treatment Effect (ATE) using the generated values for X and Y.
The consistent estimator is calculated as the difference between the expected value of the outcome for the treated group
and the expected value of the outcome for the control group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>True_Estimation(Y, A, Z, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="True_Estimation_+3A_y">Y</code></td>
<td>
<p>A numeric vector of outcomes.</p>
</td></tr>
<tr><td><code id="True_Estimation_+3A_a">A</code></td>
<td>
<p>A numeric vector of treatment assignments.</p>
</td></tr>
<tr><td><code id="True_Estimation_+3A_z">Z</code></td>
<td>
<p>A numeric vector of covariate Z.</p>
</td></tr>
<tr><td><code id="True_Estimation_+3A_x">X</code></td>
<td>
<p>A numeric vector of covariate X.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The expected value for the treated group, E(Y_1), is calculated as the mean of the product of the treatment assignment
and the outcome divided by the estimated propensity score.
</p>
<p>The expected value for the control group, E(Y_0), is calculated as the mean of the product of the control assignment
and the outcome divided by one minus the estimated propensity score.
</p>
<p>The propensity score is estimated by applying a logistic regression model to the true values of the covariates and
treatment assignments.
</p>


<h3>Value</h3>

<p>A numeric value representing the estimated treatment effect.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ATE.ERROR)
data(Simulated_data)
Y &lt;- Simulated_data$Y
A &lt;- Simulated_data$T
Z &lt;- Simulated_data$Z
X &lt;- Simulated_data$X
True_ATE &lt;- True_Estimation(Y, A, Z, X)
print(True_ATE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
