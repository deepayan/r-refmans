<!DOCTYPE html><html lang="en"><head><title>Help for package voronoifortune</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {voronoifortune}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#voronoifortune-package'><p>Fortune Algorithm for Voronoi Diagrams</p></a></li>
<li><a href='#plot.voronoi'><p>Plot Voronoi Tessellation and Delaunay Triangulation</p></a></li>
<li><a href='#voronoi'><p>Voronoi Tessellation and Delaunay Triangulation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-07</td>
</tr>
<tr>
<td>Title:</td>
<td>Voronoi Tessellation by Fortune Algorithm</td>
</tr>
<tr>
<td>Description:</td>
<td>Fortune's (1987, &lt;<a href="https://doi.org/10.1007%2FBF01840357">doi:10.1007/BF01840357</a>&gt;) algorithm is a very efficient method to perform Voronoi tessellation and Delaunay triangulation. This package is a port of the original code published in the early 1990's by Steven Fortune.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/emmanuelparadis/voronoifortune">https://github.com/emmanuelparadis/voronoifortune</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/emmanuelparadis/voronoifortune/issues">https://github.com/emmanuelparadis/voronoifortune/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-07 17:22:52 UTC; paradis</td>
</tr>
<tr>
<td>Author:</td>
<td>Emmanuel Paradis <a href="https://orcid.org/0000-0003-3092-2199"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Steven Fortune [aut, ctb],
  Plan 9 Foundation [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emmanuel Paradis &lt;Emmanuel.Paradis@ird.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-08 15:00:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='voronoifortune-package'>Fortune Algorithm for Voronoi Diagrams</h2><span id='topic+voronoifortune-package'></span>

<h3>Description</h3>

<p><span class="pkg">voronoifortune</span> is a port to <span class="rlang"><b>R</b></span> of Fortune's algorithm, a very
fast method to compute simultaneously the Delaunay triangulaton and
the Voronoi tessellation for a set of sites (points). The algorithm
scales linearly with the number of points whereas most other
algorithms scale polynomially.
</p>
<p>A Voronoi tessellation defines for each site a cell (or region) so
that all points included in the cell are not nearer to any other sites
(distances are meant to be Euclidean distances).
</p>
<p>A Delaunay triangulaton defines a set of triangles with vertices at
the sites so that the circle circumscribed to a given triangle does
not include any other site; see an annotated example in
<code><a href="#topic+voronoi">voronoi</a></code> including a test of this property.
</p>
<p>See the GitHub repository of the present package (link in the
DESCRIPTION file) for some notes on porting this code to <span class="rlang"><b>R</b></span>.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis, Steven Fortune
</p>
<p>Maintainer: Emmanuel Paradis &lt;Emmanuel.Paradis@ird.fr&gt;
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Delaunay_triangulation">https://en.wikipedia.org/wiki/Delaunay_triangulation</a>
</p>
<p><a href="https://en.wikipedia.org/wiki/Voronoi_diagram">https://en.wikipedia.org/wiki/Voronoi_diagram</a>
</p>

<hr>
<h2 id='plot.voronoi'>Plot Voronoi Tessellation and Delaunay Triangulation</h2><span id='topic+plot.voronoi'></span>

<h3>Description</h3>

<p>Plot Voronoi tessellation (VT) and Delaunay triangulation (DT).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'voronoi'
plot(x, delaunay = TRUE, voronoi = TRUE,
     X = NULL, add = FALSE, asp = 1,
     col.delaunay = "red", col.voronoi = "blue", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.voronoi_+3A_x">x</code></td>
<td>
<p>an object of class <code>"voronoi"</code>.</p>
</td></tr>
<tr><td><code id="plot.voronoi_+3A_delaunay">delaunay</code></td>
<td>
<p>a logical value: draw the DT?</p>
</td></tr>
<tr><td><code id="plot.voronoi_+3A_voronoi">voronoi</code></td>
<td>
<p>a logical value: draw the VT?</p>
</td></tr>
<tr><td><code id="plot.voronoi_+3A_x">X</code></td>
<td>
<p>a two-column matrix with the original data (site
coordinates).</p>
</td></tr>
<tr><td><code id="plot.voronoi_+3A_add">add</code></td>
<td>
<p>a logical value. By default, a new plot is made. Setting
<code>add = TRUE</code> is useful to add the tessellation and/or the
triangulation on, e.g., a map.</p>
</td></tr>
<tr><td><code id="plot.voronoi_+3A_asp">asp</code></td>
<td>
<p>a numeric value. By default, both axes are scaled
similarly (isometry). Use <code>asp = NULL</code> to have independent
scaling on both axes (like a standard plot in <span class="rlang"><b>R</b></span>).</p>
</td></tr>
<tr><td><code id="plot.voronoi_+3A_col.delaunay">col.delaunay</code>, <code id="plot.voronoi_+3A_col.voronoi">col.voronoi</code></td>
<td>
<p>the colours used for the segments.</p>
</td></tr>
<tr><td><code id="plot.voronoi_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>...</code> argument makes plotting very flexible.
</p>
<p>The default procedure is to first draw the DT, setting the limits of
the axes according to the data, and then to draw the VT. Playing with
the different options can change the order these two are drawn.
</p>
<p>The Fortune algorithm often adds some vertices which are far from the
data points (sites); so if <code>delaunay = FALSE</code>, the scales are
likely to extend much more than the default.
</p>
<p>The infinite edges of the VT are drawn as dashed lines.
</p>


<h3>Value</h3>

<p>(NULL).</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis</p>


<h3>See Also</h3>

<p><code><a href="#topic+voronoi">voronoi</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(runif(200), 100, 2)
res &lt;- voronoi(X)
plot(res)
plot(res, delaunay = FALSE)

dat &lt;- matrix(runif(40), 20, 2)
tess.dat &lt;- voronoi(dat)
op &lt;- par(mar = rep(0, 4))
## pass the data with the X argument:
plot(tess.dat, X = dat, pch = ".", axes = FALSE, ann = FALSE,
     xlim = c(-1, 2), ylim = c(-1, 2))
legend("topleft", , c("Delaunay triangulation", "Voronoi tessellation"),
       lty = 1, col = c("red", "blue"), bty = "n")
par(op)
</code></pre>

<hr>
<h2 id='voronoi'>Voronoi Tessellation and Delaunay Triangulation</h2><span id='topic+voronoi'></span><span id='topic+print.voronoi'></span>

<h3>Description</h3>

<p>Voronoi tessellation and Delaunay triangulation are performed
simultaneously with the Fortune (1987) algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>voronoi(X, sorted = FALSE, debug = FALSE)
## S3 method for class 'voronoi'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="voronoi_+3A_x">X</code></td>
<td>
<p>a two-column matrix with the coordinates.</p>
</td></tr>
<tr><td><code id="voronoi_+3A_sorted">sorted</code></td>
<td>
<p>a logical: are the coordinates already sorted in
increasing order first by y, then by x? (See
<code><a href="base.html#topic+order">order</a></code>.) If <code>TRUE</code>, this shortens the
running time.</p>
</td></tr>
<tr><td><code id="voronoi_+3A_debug">debug</code></td>
<td>
<p>a logical: if <code>TRUE</code>, some details of the
computation are printed for debugging.</p>
</td></tr>
<tr><td><code id="voronoi_+3A_x">x</code></td>
<td>
<p>an object of class <code>"voronoi"</code>.</p>
</td></tr>
<tr><td><code id="voronoi_+3A_...">...</code></td>
<td>
<p>(unused).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>voronoi()</code> returns an object of class <code>"voronoi"</code> with four
elements:
</p>
<table role = "presentation">
<tr><td><code>Triplets</code></td>
<td>
<p>a three-column matrix of integers giving the triangles
of the Delaunay triangulation (indices from the original data);</p>
</td></tr>
<tr><td><code>Vertices</code></td>
<td>
<p>a two-column matrix of reals giving the coordinates of
the vertices of the Voronoi tessellation;</p>
</td></tr>
<tr><td><code>Edges</code></td>
<td>
<p>a two-column matrix of integers giving the edges of the
tessellation (row indices of the vertices in the previous matrix);</p>
</td></tr>
<tr><td><code>Lines</code></td>
<td>
<p>a description of the previous edges (some of them are
semi-infinite indicated by a 0 in the matrix <code>Edges</code>; this
is used to draw the dashed lines by <code><a href="#topic+plot.voronoi">plot.voronoi</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emmanuel Paradis, Steven Fortune</p>


<h3>References</h3>

<p>Fortune, S. (1987) A sweepline algorithm for Voronoi
diagrams. <em>Algorithmica</em>, <b>2</b>, 153&ndash;174.
<a href="https://doi.org/10.1007/BF01840357">doi:10.1007/BF01840357</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.voronoi">plot.voronoi</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 100L
xx &lt;- runif(n)
yy &lt;- runif(n)
X &lt;- cbind(xx, yy)
(res &lt;- voronoi(X))
str(res)

### show the circumcircle of each Delaunay triangle ###

n &lt;- 10L
X &lt;- cbind(runif(n), runif(n))
res &lt;- voronoi(X)

## if 12 windows not enough par(ask) is set to TRUE
op &lt;- par(mfrow = c(3, 4), ask = interactive())
## to show the circle as disk:
col &lt;- rgb(.5, .5, 1, .3)

## for each triangle:
for (i in 1:nrow(res$Triplets)) {
    plot(res, X = X, voronoi = FALSE, main = i)
    ## get the 3 vertices of the triangle:
    P &lt;- res$Triplets[i, ]
    ## center the coordinates on the 1st vertex:
    ## (B and C are the new coordinates of the 2nd
    ## and 3rd vertices)
    A &lt;- X[P[1], ]
    B &lt;- X[P[2], ] - A
    C &lt;- X[P[3], ] - A
    ## the coordinates of the center of the circumcircle are:
    ## (https://en.wikipedia.org/wiki/Circumcircle)
    cr &lt;- c(C[2] * sum(B^2) - B[2] * sum(C^2),
            B[1] * sum(C^2) - C[1] * sum(B^2))
    cr &lt;- cr / (2 * (B[1] * C[2] - B[2] * C[1]))
    ## since the circle intersects with the new origin,
    ## the radius is simply:
    r &lt;- sqrt(sum(cr^2))
    ## translate back to the original coordinate system:
    cr &lt;- cr + A
    ## draw the circumcircle:
    symbols(cr[1], cr[2], circles = r, inches = FALSE, add = TRUE,
            fg = col, bg = col)
    ## test numerically that no points are inside the circumcircle:
    ## 1/ build a matrix with the coordinates of the center
    ## and all the vertices:
    M &lt;- rbind(cr, X)
    ## 2/ compute the Euclidean distances, we keep only the n first
    ## values which are the distances from the center to the n vertices:
    Dis &lt;- dist(M)[1:n]
    ## 3/ all other points than the 3 in P should be farther
    ## to the center:
    stopifnot(all(Dis[-P] &gt; r))
}

par(op)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
