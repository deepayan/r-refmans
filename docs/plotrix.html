<!DOCTYPE html><html><head><title>Help for package plotrix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {plotrix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plotrix-package'>
<p>Specialized plots and plotting accessories</p></a></li>
<li><a href='#ablineclip'><p>Add a straight line to a plot</p></a></li>
<li><a href='#add.ps'>
<p>add p-values from t-tests</p></a></li>
<li><a href='#addtable2plot'><p>Add a table of values to a plot</p></a></li>
<li><a href='#arctext'><p>Display text on a circular arc</p></a></li>
<li><a href='#axis.break'><p> Place a &quot;break&quot; mark on an axis</p></a></li>
<li><a href='#axis.mult'><p> Display an axis with values having a multiplier</p></a></li>
<li><a href='#barlabels'><p>Label the bars on a barplot</p></a></li>
<li><a href='#barNest'><p>Display a nested breakdown of numeric values</p></a></li>
<li><a href='#barp'><p>A bar plotting routine</p></a></li>
<li><a href='#battleship.plot'><p>Display a matrix of values as the widths of stacked rectangles</p></a></li>
<li><a href='#bin.wind.records'><p>Classify wind direction and speed records</p></a></li>
<li><a href='#binciW'><p>Binomial confidence limits</p></a></li>
<li><a href='#binciWl'><p>Lower binomial confidence limit</p></a></li>
<li><a href='#binciWu'><p>Upper binomial confidence limit</p></a></li>
<li><a href='#box.heresy'><p>Display a sort of box plot</p></a></li>
<li><a href='#boxed.labels'><p> Place labels in boxes</p></a></li>
<li><a href='#brkdn.plot'><p>A point/line plotting routine</p></a></li>
<li><a href='#brkdnNest'><p>Perform a nested breakdown of numeric values</p></a></li>
<li><a href='#bumpchart'><p>Display a &quot;bumps&quot; (sequential ranking) chart</p></a></li>
<li><a href='#categoryReshape'><p>Convert object label/attribute label coding.</p></a></li>
<li><a href='#centipede.plot'><p>Display a centipede plot</p></a></li>
<li><a href='#clean.args'><p>Remove inappropriate arguments from an argument list</p></a></li>
<li><a href='#clock24.plot'><p>Plot values on a 24 hour &quot;clockface&quot;</p></a></li>
<li><a href='#clplot'><p>Plot lines with colors determined by values.</p></a></li>
<li><a href='#cluster.overplot'><p>Shift overlying points into clusters</p></a></li>
<li><a href='#clustered.dotplots'><p>Display the frequencies of two categories</p></a></li>
<li><a href='#color.axis'><p>Display an axis in a specified color</p></a></li>
<li><a href='#color.gradient'><p>Calculate an arbitrary sequence of colors</p></a></li>
<li><a href='#color.id'><p>Identify closest match to a color</p></a></li>
<li><a href='#color.legend'><p>Legend matching categories or values to colors</p></a></li>
<li><a href='#color.scale'><p>Turn values into colors.</p></a></li>
<li><a href='#color.scale.lines'><p>Line segments with scaled colors</p></a></li>
<li><a href='#color2D.matplot'><p>Display a numeric matrix as color matrix</p></a></li>
<li><a href='#corner.label'><p>Find corner locations and optionally display a label</p></a></li>
<li><a href='#count.overplot'><p>Show overlying points as counts</p></a></li>
<li><a href='#cylindrect'><p>Display an apparent cylinder</p></a></li>
<li><a href='#death_reg'><p>Death registrations from 1996 to 2010</p></a></li>
<li><a href='#dendroPlot'><p> Display distributions as dendrites</p></a></li>
<li><a href='#densityGrid'><p>Display a matrix of cell values as symbols.</p></a></li>
<li><a href='#diamondplot'><p>Plot multiple variables as polygons on a radial grid</p></a></li>
<li><a href='#dispersion'><p> Display a measure of dispersion.</p></a></li>
<li><a href='#do.first'><p> Execute a graphic function on a plot</p></a></li>
<li><a href='#dotplot.mtb'><p> Minitab style dotplots.</p></a></li>
<li><a href='#draw.arc'><p> Draw arc</p></a></li>
<li><a href='#draw.circle'><p>Draw a circle</p></a></li>
<li><a href='#draw.ellipse'><p>Draw ellipse</p></a></li>
<li><a href='#draw.radial.line'><p>Draw a radial line</p></a></li>
<li><a href='#draw.tilted.sector'><p>Display a 3D pie sector</p></a></li>
<li><a href='#drawNestedBars'><p>Display nested bars</p></a></li>
<li><a href='#drawSectorAnnulus'><p>Display a radial pie sector</p></a></li>
<li><a href='#ehplot'>
<p>Engelmann-Hecker-Plot - EH-Plot</p></a></li>
<li><a href='#election'><p>Assign party members to seats</p></a></li>
<li><a href='#emptyspace'><p> Find an empty space on a plot</p></a></li>
<li><a href='#fan.plot'><p> Display a fan plot</p></a></li>
<li><a href='#feather.plot'><p> Display vectors along a horizontal reference line</p></a></li>
<li><a href='#fill.corner'>
<p>Fill a &quot;corner&quot; of a matrix with values</p></a></li>
<li><a href='#find_max_cell'><p>Maximum (or minimum) value cell in a matrix.</p></a></li>
<li><a href='#floating.pie'><p>Display a floating pie chart</p></a></li>
<li><a href='#fullaxis'><p>Add an axis with a line to the edge of the plot</p></a></li>
<li><a href='#gantt.chart'><p>Display a Gantt chart</p></a></li>
<li><a href='#gap_barp'>
<p>Display a barplot with a gap (missing range) on one axis</p></a></li>
<li><a href='#gap.barplot'>
<p>Display a barplot with a gap (missing range) on one axis</p></a></li>
<li><a href='#gap.boxplot'><p>Display a boxplot with a gap (missing range)</p></a></li>
<li><a href='#gap.plot'><p>Display a plot with one or two gaps (missing ranges) on one axis</p></a></li>
<li><a href='#get_axispos3d'><p> Get axis positions on a 3D plot</p></a></li>
<li><a href='#get.breaks'><p>Get the breakpoints for a weighted histogram</p></a></li>
<li><a href='#get.gantt.info'><p>Gather the information to create a Gantt chart</p></a></li>
<li><a href='#get.segs'><p>Calculate the midpoints and limits for a centipede plot</p></a></li>
<li><a href='#get.soil.texture'><p>Enter soil texture data</p></a></li>
<li><a href='#get.tablepos'><p>Get the position for a legend or table</p></a></li>
<li><a href='#get.triprop'><p>Enter three proportion data - usually soil textures</p></a></li>
<li><a href='#getFigCtr'><p>Get coordinates in the figure region in user units.</p></a></li>
<li><a href='#getIntersectList'><p>Enter a set intersection list</p></a></li>
<li><a href='#getMarginWidth'><p>Find the margin width necessary to fit text or a legend next to a plot</p></a></li>
<li><a href='#getYmult'><p>Correct for aspect and coordinate ratio</p></a></li>
<li><a href='#gradient.rect'><p>Display a rectangle filled with an arbitrary color gradient</p></a></li>
<li><a href='#hexagon'><p>Draw a hexagon</p></a></li>
<li><a href='#histStack'><p>Histogram &quot;stacked&quot; by categories</p></a></li>
<li><a href='#intersectDiagram'><p>Display set intersections</p></a></li>
<li><a href='#jiggle'><p> Calculate equally spaced values within a range.</p></a></li>
<li><a href='#joyPlot'><p>Display a series of density curves.</p></a></li>
<li><a href='#kiteChart'><p> Magnitude by position chart.</p></a></li>
<li><a href='#l2010'><p>World lightning strike data from 2010</p></a></li>
<li><a href='#labbePlot'><p> Display a L'Abbe plot</p></a></li>
<li><a href='#ladderplot'>
<p>Ladder Plot</p></a></li>
<li><a href='#legendg'><p>Legend with grouped bars, lines or symbols</p></a></li>
<li><a href='#lengthKey'><p>Key for interpreting lengths in a plot</p></a></li>
<li><a href='#makeDensityMatrix'><p>Compute a matrix of counts from a list of x,y positions</p></a></li>
<li><a href='#makeIntersectList'><p>Count set intersections</p></a></li>
<li><a href='#maxEmptyRect'><p> Find an empty space on a plot</p></a></li>
<li><a href='#mtext3d'><p> Display text in the margins of a 3D plot</p></a></li>
<li><a href='#multhist'><p>Plot a multiple histogram, as a barplot</p></a></li>
<li><a href='#multivari'>
<p>Function to draw a multivari chart</p></a></li>
<li><a href='#multsymbolbox'><p>Draw boxes filled with symbols</p></a></li>
<li><a href='#oz.windrose'><p>Display an Australian wind rose</p></a></li>
<li><a href='#oz.windrose.legend'><p>Display an Australian wind rose legend</p></a></li>
<li><a href='#p2p_arrows'><p>Draw arrows between points</p></a></li>
<li><a href='#panes'><p>Prepare a &quot;panel&quot; type layout</p></a></li>
<li><a href='#pasteCols'><p>Paste the columns of a matrix together</p></a></li>
<li><a href='#paxis3d'><p> Display text in the margins of a 3D plot</p></a></li>
<li><a href='#perspx'><p> Display perspective plot</p></a></li>
<li><a href='#pie.labels'><p> Place labels on a pie chart</p></a></li>
<li><a href='#pie3D'><p>Display a 3D pie chart</p></a></li>
<li><a href='#pie3D.labels'><p>Display labels on a 3D pie chart</p></a></li>
<li><a href='#placeLabels'><p> Place labels in boxes</p></a></li>
<li><a href='#plot_bg'><p> Add a background color to a plot</p></a></li>
<li><a href='#plotCI'><p>Plot confidence intervals/error bars</p></a></li>
<li><a href='#plotH'><p>Scatterplot with histogram-like bars.</p></a></li>
<li><a href='#polar.plot'><p>Plot values on a circular grid of 0 to 360 degrees</p></a></li>
<li><a href='#polygon.shadow'><p>Display a shadow effect for an arbitrary polygon</p></a></li>
<li><a href='#print.brklist'><p>Display the output of brkdnNest</p></a></li>
<li><a href='#propbrk'><p>Calculate the proportion of specified values in a vector</p></a></li>
<li><a href='#psegments3d'><p> Draw segments on a 3D plot</p></a></li>
<li><a href='#ptext3d'><p> Display text on a 3D plot</p></a></li>
<li><a href='#pyramid.plot'><p>Pyramid plot</p></a></li>
<li><a href='#radial.grid'><p>Display a radial grid</p></a></li>
<li><a href='#radial.pie'>
<p>Plot sectors/annuli on a circular grid of 0 to 2*pi radians</p></a></li>
<li><a href='#radial.plot'>
<p>Plot values on a circular grid of 0 to 2*pi radians</p></a></li>
<li><a href='#radial.plot.labels'><p>Display labels on a circular grid</p></a></li>
<li><a href='#radialtext'><p>Display text in a radial line</p></a></li>
<li><a href='#raw.means.plot'>
<p>raw.means.plot: Raw-Means Plots for Experimental Designs</p></a></li>
<li><a href='#rectFill'><p>Draw a rectangle filled with symbols</p></a></li>
<li><a href='#rescale'><p>Scale numbers into a new range</p></a></li>
<li><a href='#revaxis'><p> Plot with axis direction(s) reversed</p></a></li>
<li><a href='#ruginv'><p>Add an Inverse Rug to a Plot</p></a></li>
<li><a href='#seats'><p>Arrange N seats in M semicircular rows</p></a></li>
<li><a href='#size_n_color'><p>Display circles with specified size and color</p></a></li>
<li><a href='#sizeplot'><p>Plot with repeated symbols by size</p></a></li>
<li><a href='#sizetree'><p>Display a hierarchical breakdown of disjunct categories</p></a></li>
<li><a href='#sliceArray'><p>Slice an array</p></a></li>
<li><a href='#smoothColors'><p>Build a vector of color values</p></a></li>
<li><a href='#soil.texture'><p>Soil texture triangle plot</p></a></li>
<li><a href='#soil.texture.uk'><p>Soil texture triangle plot using UK conventions</p></a></li>
<li><a href='#soils'><p>Soil texture data from 125 soils</p></a></li>
<li><a href='#spread.labels'><p> Spread labels for irregularly spaced values</p></a></li>
<li><a href='#spreadout'><p>Spread out a vector of numbers to a minimum interval</p></a></li>
<li><a href='#stackpoly'>
<p>Display the columns of a matrix or data frame as stacked polygons</p></a></li>
<li><a href='#staircase.plot'><p>Display a staircase plot</p></a></li>
<li><a href='#staircasePlot'><p>Display a staircase plot</p></a></li>
<li><a href='#starPie'><p>A pie-like graphic object</p></a></li>
<li><a href='#staxlab'><p> Place staggered or angled labels on an axis</p></a></li>
<li><a href='#std.error'><p>Calculate standard error of the mean</p></a></li>
<li><a href='#sumbrk'><p>Count specified values in a vector</p></a></li>
<li><a href='#symbolbarplot'><p>barplot filled with symbols</p></a></li>
<li><a href='#symbolbox'><p>Draw a box filled with symbols</p></a></li>
<li><a href='#tab.title'>
<p>Display the title of a plot as a colored tab</p></a></li>
<li><a href='#taylor.diagram'><p> Taylor diagram</p></a></li>
<li><a href='#textbox'><p>Add text box</p></a></li>
<li><a href='#thigmophobe'><p>Find the direction away from the closest point</p></a></li>
<li><a href='#thigmophobe.labels'><p>Place labels away from the nearest point</p></a></li>
<li><a href='#triax.abline'><p>Lines for triangle plot</p></a></li>
<li><a href='#triax.fill'><p>Triangle plot fill</p></a></li>
<li><a href='#triax.frame'><p>Triangle plot frame</p></a></li>
<li><a href='#triax.plot'><p>Triangle plot</p></a></li>
<li><a href='#triax.points'><p>Triangle plot points</p></a></li>
<li><a href='#tsxpos'><p>Calculate equispaced x positions.</p></a></li>
<li><a href='#twoord.plot'><p> Plot with two ordinates</p></a></li>
<li><a href='#twoord.stackplot'><p>Multiple (stack) plot with two ordinates</p></a></li>
<li><a href='#valid.n'>
<p>Find the number of valid (not NA) values</p></a></li>
<li><a href='#vectorField'><p>Display magnitude/direction vectors</p></a></li>
<li><a href='#violin_plot'><p>Display a &quot;violin&quot; plot</p></a></li>
<li><a href='#weighted.hist'>
<p>Display a weighted histogram</p></a></li>
<li><a href='#zoomInPlot'>
<p>Display a plot with a rectangular section expanded in an adjacent plot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>3.8-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-09</td>
</tr>
<tr>
<td>Title:</td>
<td>Various Plotting Functions</td>
</tr>
<tr>
<td>Author:</td>
<td>Jim Lemon, Ben Bolker, Sander Oom,
	Eduardo Klein, Barry Rowlingson,
	Hadley Wickham, Anupam Tyagi,
	Olivier Eterradossi, Gabor Grothendieck,
	Michael Toews, John Kane, Rolf Turner,
	Carl Witthoft, Julian Stander, Thomas Petzoldt,
	Remko Duursma, Elisa Biancotto, Ofir Levy,
	Christophe Dutang, Peter Solymos, Robby Engelmann, 
	Michael Hecker, Felix Steinbeck, Hans Borchers,
	Henrik Singmann, Ted Toal, Derek Ogle, Darshan Baral,
	Ulrike Groemping, Bill Venables, The CRAN Team,
	Duncan Murdoch</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Duncan Murdoch &lt;murdoch.duncan@gmail.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, graphics, stats, utils</td>
</tr>
<tr>
<td>Description:</td>
<td>Lots of plots, various labeling, axis and color scaling functions. The author/maintainer died in September 2023.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-10 10:10:02 UTC</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/dmurdoch/plotrix">https://github.com/dmurdoch/plotrix</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dmurdoch/plotrix/issues">https://github.com/dmurdoch/plotrix/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-09 16:39:28 UTC; murdoch</td>
</tr>
</table>
<hr>
<h2 id='plotrix-package'>
Specialized plots and plotting accessories
</h2><span id='topic+plotrix-package'></span><span id='topic+plotrix'></span>

<h3>Description</h3>

<p>A large number of specialized plots and accessory functions like color
scaling, text placement and legends.
</p>


<h3>Details</h3>

<p>The plotrix package is intended to provide a method for getting many sorts of
specialized plots quickly, yet allow easy customization of those plots
without learning a great deal of specialized syntax. There are three major
aims that can be represented as follows:
</p>
<p>Fast foods
</p>
<p>Think of plotrix as a graphics vending machine or fast graphics cafe. You walk
in, make your choice and get your lunch. It may not be exactly the lunch you
want, but you do get a pretty good lunch, fast. You can get junk food or
health food, you make the choice.
</p>
<p>Hot rods
</p>
<p>You can customize plotrix as much as you want. Like the ageing machinery that
is usually bolted into hot rods, the base graphics package is fairly easy to
understand. plotrix is modular. You can create a frame for your plot, then
you can add whatever bits you like to it instead of just taking the default
plot that is available. You can have wide wheels and chromed exhaust pipes if
you want.
</p>
<p>No black boxes
</p>
<p>If you want to go from pushing the fast food button to hot rodding, it's not
hard. The source code in the functions is written to be understood. If
something goes wrong, you can usually find where it happened right away and
work on it. This means that you can learn about how the functions do what
they do rather than just what they do. So that's how to write recursive
functions in R!
</p>
<p>Because plotrix encourages users to learn how it works, you usually begin to
do so pretty quickly. Users often decide to write their own versions of
plotrix functions and sometimes they contribute the results back into plotrix.
You may find that you like other graphics systems like grid or lattice better.
That's great, because one idea behind plotrix is that if you get into R and
can get things done quickly and easily, you'll stick with it and soon want to
get things done your way. 
</p>


<h3>Author(s)</h3>

<p>Jim Lemon &lt;drjimlemon@gmail.com&gt;, and many others
</p>
<p>Maintainer: Jim Lemon &lt;drjimlemon@gmail.com&gt;
</p>

<hr>
<h2 id='ablineclip'>Add a straight line to a plot</h2><span id='topic+ablineclip'></span>

<h3>Description</h3>

<p>As &lsquo;<span class="samp">&#8288;abline&#8288;</span>&rsquo;, but has arguments &lsquo;<span class="samp">&#8288;x1,x2,y1,y2&#8288;</span>&rsquo; as in &lsquo;<span class="samp">&#8288;clip&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ablineclip(a=NULL,b=NULL,h=NULL,v=NULL,reg=NULL,coef=NULL,untf=FALSE,
  x1=NULL,x2=NULL,y1=NULL,y2=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ablineclip_+3A_a">a</code></td>
<td>
<p>Intercept.</p>
</td></tr>
<tr><td><code id="ablineclip_+3A_b">b</code></td>
<td>
<p>Slope.</p>
</td></tr>
<tr><td><code id="ablineclip_+3A_h">h</code></td>
<td>
<p>the y-value(s) for horizontal line(s).</p>
</td></tr>
<tr><td><code id="ablineclip_+3A_v">v</code></td>
<td>
<p>the x-value(s) for vertical line(s).</p>
</td></tr>
<tr><td><code id="ablineclip_+3A_reg">reg</code></td>
<td>
<p>Fitted lm object. </p>
</td></tr>
<tr><td><code id="ablineclip_+3A_coef">coef</code></td>
<td>
<p>Coefficients, typically intercept and slope.</p>
</td></tr>
<tr><td><code id="ablineclip_+3A_untf">untf</code></td>
<td>
<p>How to plot on log coordinates, see &lsquo;<span class="samp">&#8288;abline&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="ablineclip_+3A_x1">x1</code>, <code id="ablineclip_+3A_x2">x2</code>, <code id="ablineclip_+3A_y1">y1</code>, <code id="ablineclip_+3A_y2">y2</code></td>
<td>
<p>Clipping limits, see &lsquo;<span class="samp">&#8288;clip&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="ablineclip_+3A_...">...</code></td>
<td>
<p>Further arguments passed to &lsquo;<span class="samp">&#8288;abline&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;ablineclip&#8288;</span>&rsquo; sets a new clipping region and then calls &lsquo;<span class="samp">&#8288;abline&#8288;</span>&rsquo;.
If any of the four clipping limits is NULL, the values from &lsquo;<span class="samp">&#8288;par("usr")&#8288;</span>&rsquo;
are substituted. After the call to &lsquo;<span class="samp">&#8288;abline&#8288;</span>&rsquo;, the old clipping region
is restored. In order to make &lsquo;<span class="samp">&#8288;clip&#8288;</span>&rsquo; work, there is a call to &lsquo;<span class="samp">&#8288;abline&#8288;</span>&rsquo; that draws a line off the plot.
</p>
<p>Multiple lines of the same type can be drawn in a single call, but the clipping region must be the same for each group of lines. Thanks to Berry Boessenkool for pointing this out.
</p>


<h3>Value</h3>

<p>None. Adds to the current plot.
</p>


<h3>Author(s)</h3>

<p> Remko Duursma </p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+abline">abline</a>, <a href="graphics.html#topic+clip">clip</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x &lt;- rnorm(100)
 y &lt;- x + rnorm(100)
 lmfit &lt;- lm(y~x)
 plot(x, y, xlim=c(-3.5, 3.5))
 ablineclip(lmfit, x1 = -2, x2 = 2, lty = 2)
 ablineclip(h = 0, x1 = -2,x2 = 2,lty = 3, col = "red")
 ablineclip(v = 0, y1 = -2.5, y2 = 1.5, lty=4, col = "green")
</code></pre>

<hr>
<h2 id='add.ps'>
add p-values from t-tests
</h2><span id='topic+add.ps'></span>

<h3>Description</h3>

<p>Adds p-values comparing the different cells at each x-axis position with a
reference cell. Uses a syntax similar to &lsquo;<span class="samp">&#8288;raw.means.plot2&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> add.ps(data, col.id, col.offset, col.x, col.value, fun.aggregate = "mean",
 ref.offset = 1, prefixes,alternative = c("two.sided", "less", "greater"),
 mu = 0, paired = FALSE, var.equal = FALSE, lty = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add.ps_+3A_data">data</code></td>
<td>

<p>A &lsquo;<span class="samp">&#8288;data.frame&#8288;</span>&rsquo;
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_col.id">col.id</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;character&#8288;</span>&rsquo; vector specifying the id column.
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_col.offset">col.offset</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;character&#8288;</span>&rsquo; vector specifying the offset column.
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_col.x">col.x</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;character&#8288;</span>&rsquo; vector specifying the x-axis column.
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_col.value">col.value</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;character&#8288;</span>&rsquo; vector specifying the data column.
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_fun.aggregate">fun.aggregate</code></td>
<td>

<p>Function or function name used for aggregating the results. Default is
&lsquo;<span class="samp">&#8288;"mean"&#8288;</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_ref.offset">ref.offset</code></td>
<td>

<p>Scalar &lsquo;<span class="samp">&#8288;numeric&#8288;</span>&rsquo; indicating the reference level to be tested against.
The default is 1 corresponding to &lsquo;<span class="samp">&#8288;levels(factor(d[,col.offset]))[1]&#8288;</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_prefixes">prefixes</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;character&#8288;</span>&rsquo; vector of the indices for the p-values. If missing
corresponds to &lsquo;<span class="samp">&#8288;levels(factor(d.new[,col.offset]))[-ref.offset]&#8288;</span>&rsquo;. 
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_alternative">alternative</code></td>
<td>

<p>same as in <a href="stats.html#topic+t.test">t.test</a>
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_mu">mu</code></td>
<td>

<p>same as in <a href="stats.html#topic+t.test">t.test</a>
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_paired">paired</code></td>
<td>

<p>same as in <a href="stats.html#topic+t.test">t.test</a>
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_var.equal">var.equal</code></td>
<td>

<p>same as in <a href="stats.html#topic+t.test">t.test</a>
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_lty">lty</code></td>
<td>

<p>line type of axis, Default is 0 (i.e., no line).
</p>
</td></tr>
<tr><td><code id="add.ps_+3A_...">...</code></td>
<td>

<p>further arguments passed to axis.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes t-tests comparing the values at each x-axis position
for each condition against the reference condition at and adds the p-values
to the axis.
</p>
<p>This functions uses the same syntax as <a href="#topic+raw.means.plot2">raw.means.plot2</a> and
should be used in addition to it. Note that values are ordered according to
the &lsquo;<span class="samp">&#8288;col.id&#8288;</span>&rsquo; so &lsquo;<span class="samp">&#8288;paired = TRUE&#8288;</span>&rsquo; should be fine.
</p>


<h3>Value</h3>

<p>axis is plotted.
</p>


<h3>Author(s)</h3>

<p>Henrik Singmann
</p>


<h3>See Also</h3>

<p><a href="#topic+raw.means.plot">raw.means.plot</a> as the accompanying main functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#The examples uses the OBrienKaiser dataset from car and needs reshape.
# This extends the examples from raw.means.plot
require(reshape)
require(car)
data(OBrienKaiser)
OBKnew &lt;- cbind(factor(1:nrow(OBrienKaiser)), OBrienKaiser)
colnames(OBKnew)[1] &lt;- "id"
OBK.long &lt;- melt(OBKnew)
OBK.long[, c("measurement", "time")] &lt;-
 t(vapply(strsplit(as.character(OBK.long$variable), "\\."),  "[", c("", "")))

# For this example the position at each x-axis are within-subject comparisons!
raw.means.plot2(OBK.long, "id", "measurement", "gender", "value")
 add.ps(OBK.long, "id", "measurement", "gender", "value", paired = TRUE)
 #reference is "fup"

raw.means.plot2(OBK.long, "id", "measurement", "gender", "value")
add.ps(OBK.long, "id", "measurement", "gender", "value", ref.offset = 2,
 paired = TRUE) #reference is "post"

# Use R's standard (i.e., Welch test)
raw.means.plot2(OBK.long, "id", "treatment", "gender", "value")
add.ps(OBK.long, "id", "treatment", "gender", "value",
 prefixes = c("p(control vs. A)", "p(control vs. B)"))

# Use standard t-test
raw.means.plot2(OBK.long, "id", "treatment", "gender", "value")
add.ps(OBK.long, "id", "treatment", "gender", "value", var.equal = TRUE,
 prefixes = c("p(control vs. A)", "p(control vs. B)"))


## End(Not run)
</code></pre>

<hr>
<h2 id='addtable2plot'>Add a table of values to a plot</h2><span id='topic+addtable2plot'></span>

<h3>Description</h3>

<p>Displays a table of values at a user-specified position on an existing plot</p>


<h3>Usage</h3>

<pre><code class='language-R'> addtable2plot(x,y=NULL,table,lwd=par("lwd"),bty="n",bg=par("bg"),
  cex=1,xjust=0,yjust=1,xpad=0.1,ypad=0.5,box.col=par("fg"),text.col=par("fg"),
  display.colnames=TRUE,display.rownames=FALSE,hlines=FALSE,vlines=FALSE,
  title=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addtable2plot_+3A_x">x</code>, <code id="addtable2plot_+3A_y">y</code></td>
<td>
<p>Either x and y coordinates to locate the table or an
&lsquo;<span class="samp">&#8288;xy.coords&#8288;</span>&rsquo; object.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_table">table</code></td>
<td>
<p>A data frame, matrix or similar object that will be displayed.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_lwd">lwd</code></td>
<td>
<p>The line width for the box and horizontal dividers.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_bty">bty</code></td>
<td>
<p>Whether to draw a box around the table (&quot;o&quot;) or not (&quot;n&quot;).</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_bg">bg</code></td>
<td>
<p>The background color for the table.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_cex">cex</code></td>
<td>
<p>Character expansion for the table.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_xjust">xjust</code>, <code id="addtable2plot_+3A_yjust">yjust</code></td>
<td>
<p>Positioning for the table relative to &lsquo;<span class="samp">&#8288;x,y&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_xpad">xpad</code>, <code id="addtable2plot_+3A_ypad">ypad</code></td>
<td>
<p>The amount of padding around text in the cells as a
proportion of the maximum width and height of the strings in each column.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_box.col">box.col</code></td>
<td>
<p>The color for the box and lines.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_text.col">text.col</code></td>
<td>
<p>The color for the text.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_display.colnames">display.colnames</code></td>
<td>
<p>Whether to display the column names in the table.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_display.rownames">display.rownames</code></td>
<td>
<p>Whether to display the row names in the table.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_hlines">hlines</code></td>
<td>
<p>Whether to draw horizontal lines between each row of the table.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_vlines">vlines</code></td>
<td>
<p>Whether to draw vertical lines between each column of the table.</p>
</td></tr>
<tr><td><code id="addtable2plot_+3A_title">title</code></td>
<td>
<p>Optional title placed over the table.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;addtable2plot&#8288;</span>&rsquo; displays the values in &lsquo;<span class="samp">&#8288;table&#8288;</span>&rsquo; at a position in user
coordinates specified by &lsquo;<span class="samp">&#8288;x,y&#8288;</span>&rsquo;. The two justification arguments,
&lsquo;<span class="samp">&#8288;xjust&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;yjust&#8288;</span>&rsquo; are the same as in the &lsquo;<span class="samp">&#8288;legend&#8288;</span>&rsquo; function,
and &lsquo;<span class="samp">&#8288;addtable2plot&#8288;</span>&rsquo; has been programmed to be as similar to &lsquo;<span class="samp">&#8288;legend&#8288;</span>&rsquo;
as possible. The function now accepts the positional arguments such as
&quot;topright&quot; if passed as &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;. The defaults are those that were most
popular in scientific journals at the time of programming.
</p>
<p>If &lsquo;<span class="samp">&#8288;bg&#8288;</span>&rsquo; is a matrix of colors of the same dimensions as &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;, those
colors will be the backgrounds of the cells. The default is no background color.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Original by John Kane, mods by Jim Lemon and Brian Diggs. Thanks to
Andrija Djurovic for asking for the individual cell colors and Gabor Grothendieck
for alerting me to the problem of widely varying column widths.</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+legend">legend</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> testdf &lt;- data.frame(Before = c(10, 7, 5, 9), During = c(8, 6, 2, 5),
  After = c(5, 3, 4, 3))
 rownames(testdf) &lt;- c("Red", "Green", "Blue", "Lightblue")
 barp(testdf, main = "Test addtable2plot", ylab = "Value",
  names.arg = colnames(testdf), col = 2:5)
 # show most of the options including the christmas tree colors
 abg &lt;- matrix(c(2, 3, 5, 6, 7, 8), nrow=4, ncol=3)
 addtable2plot(2, 8, testdf, bty = "o", display.rownames = TRUE, hlines = TRUE,
  vlines = TRUE, title = "The table", bg = abg)
</code></pre>

<hr>
<h2 id='arctext'>Display text on a circular arc</h2><span id='topic+arctext'></span>

<h3>Description</h3>

<p>Displays a character string on the circumference of an imaginary
circle on an existing plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'> arctext(x,center=c(0,0),radius=1,start=NULL,middle=pi/2,end=NULL,stretch=1,
 clockwise=TRUE,cex=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arctext_+3A_x">x</code></td>
<td>
<p>A character string.</p>
</td></tr>
<tr><td><code id="arctext_+3A_center">center</code></td>
<td>
<p>The center of the circular arc in x/y user units.</p>
</td></tr>
<tr><td><code id="arctext_+3A_radius">radius</code></td>
<td>
<p>The radius of the arc in user units.</p>
</td></tr>
<tr><td><code id="arctext_+3A_start">start</code></td>
<td>
<p>The starting position of the string in radians.</p>
</td></tr>
<tr><td><code id="arctext_+3A_middle">middle</code></td>
<td>
<p>The middle position of the string in radians.</p>
</td></tr>
<tr><td><code id="arctext_+3A_end">end</code></td>
<td>
<p>The end position of the string in radians.</p>
</td></tr>
<tr><td><code id="arctext_+3A_stretch">stretch</code></td>
<td>
<p>How much to stretch the string for appearance.</p>
</td></tr>
<tr><td><code id="arctext_+3A_clockwise">clockwise</code></td>
<td>
<p>Whether to print the string in the clockwise direction.</p>
</td></tr>
<tr><td><code id="arctext_+3A_cex">cex</code></td>
<td>
<p>The character expansion factor.</p>
</td></tr>
<tr><td><code id="arctext_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;arctext&#8288;</span>&rsquo; displays a string along a circular arc, rotating each
letter. This may not work on all devices, as not all graphic devices
can rotate text to arbitrary angles. The output looks best on a 
Postscript or similar device that can rotate text without distortion.
Rotated text often looks very ragged on small bitmaps.
</p>
<p>If the user passes a value for
&lsquo;<span class="samp">&#8288;start&#8288;</span>&rsquo;, this will override any value passed to &lsquo;<span class="samp">&#8288;middle&#8288;</span>&rsquo;.
If the plot area is not square, see &lsquo;<span class="samp">&#8288;par(pty="s")&#8288;</span>&rsquo;, the arc will
be somewhat elliptical.
</p>
<p>If the &lsquo;<span class="samp">&#8288;clockwise&#8288;</span>&rsquo; argument is TRUE, the string will be displayed
in a clockwise direction and the orientation of the characters will be
rotated &lsquo;<span class="samp">&#8288;pi&#8288;</span>&rsquo; radians (180 degrees). This is useful when the string
is to be displayed on the bottom of the circumference.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon - Thanks to Suhas Parandekar for the idea, Ted Toal
for greatly improving the placement of the text and Andy South for
providing the initial code for the clockwise argument.</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+text">text</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(0, xlim = c(1, 5),ylim = c(1, 5),main = "Test of arctext", xlab = "",
  ylab = "", type = "n")
 arctext("bendy like spaghetti", center = c(3,3), col = "blue")
 arctext("bendy like spaghetti", center = c(3,3), radius = 1.5, start = pi,
  cex = 2)
 arctext("bendy like spaghetti", center = c(3, 3),radius = 0.5,
  start = pi/2, stretch = 1.2)
 arctext("bendy like spaghetti", center = c(3, 3), radius = 1.7,
  start = 4 * pi / 3, cex = 1.3, clockwise = FALSE)
</code></pre>

<hr>
<h2 id='axis.break'> Place a &quot;break&quot; mark on an axis </h2><span id='topic+axis.break'></span>

<h3>Description</h3>

<p>Places a &quot;break&quot; mark on an axis on an existing plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> axis.break(axis=1,breakpos=NULL,pos=NULL,bgcol="white",breakcol="black",
  style="slash",brw=0.02)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="axis.break_+3A_axis">axis</code></td>
<td>
<p>which axis to break</p>
</td></tr>
<tr><td><code id="axis.break_+3A_breakpos">breakpos</code></td>
<td>
<p>where to place the break in user units</p>
</td></tr>
<tr><td><code id="axis.break_+3A_pos">pos</code></td>
<td>
<p>position of the axis (see <a href="graphics.html#topic+axis">axis</a>).</p>
</td></tr>
<tr><td><code id="axis.break_+3A_bgcol">bgcol</code></td>
<td>
<p>the color of the plot background</p>
</td></tr>
<tr><td><code id="axis.break_+3A_breakcol">breakcol</code></td>
<td>
<p>the color of the &quot;break&quot; marker</p>
</td></tr>
<tr><td><code id="axis.break_+3A_style">style</code></td>
<td>
<p>Either &lsquo;<span class="samp">&#8288;gap&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;slash&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;zigzag&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="axis.break_+3A_brw">brw</code></td>
<td>
<p>break width relative to plot width</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &lsquo;<span class="samp">&#8288;pos&#8288;</span>&rsquo; argument is not needed unless the user has specified a
different position from the default for the axis to be broken.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>There is some controversy about the propriety of using discontinuous
coordinates for plotting, and thus axis breaks. Discontinuous coordinates
allow widely separated groups of values or outliers to appear without
devoting too much of the plot to empty space. The major objection seems 
to be that the reader will be misled by assuming continuous coordinates.
The &lsquo;<span class="samp">&#8288;gap&#8288;</span>&rsquo; style that clearly separates the two sections of the plot
is probably best for avoiding this.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon and Ben Bolker</p>


<h3>See Also</h3>

<p><a href="#topic+gap.plot">gap.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(3:10, main = "Axis break test")
 # put a break at the default axis and position
 axis.break()
 axis.break(2, 2.9, style = "zigzag")
 twogrp &lt;- c(rnorm(10) + 4, rnorm(10) + 20)
 gap.plot(twogrp,gap = c(8,16), xlab = "Index", ylab = "Group values",
  main = "Two separated groups with gap axis break",
  col = c(rep(2, 10), rep(3, 10)), ytics = c(3, 5, 18, 20))
 legend(12, 6, c("Low group", "High group"), pch = 1, col = 2:3)
</code></pre>

<hr>
<h2 id='axis.mult'> Display an axis with values having a multiplier </h2><span id='topic+axis.mult'></span>

<h3>Description</h3>

<p>An axis is displayed on an existing plot where the tick values are divided
by a multiplier and the multiplier is displayed next to the axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> axis.mult(side=1,at=NULL,labels,mult=1,mult.label,mult.line,
  mult.labelpos=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="axis.mult_+3A_side">side</code></td>
<td>
<p>which side to display</p>
</td></tr>
<tr><td><code id="axis.mult_+3A_at">at</code></td>
<td>
<p>where to place the tick marks - defaults to &lsquo;<span class="samp">&#8288;axTicks()&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="axis.mult_+3A_labels">labels</code></td>
<td>
<p>tick labels - defaults to at/mult</p>
</td></tr>
<tr><td><code id="axis.mult_+3A_mult">mult</code></td>
<td>
<p>the multiplier factor</p>
</td></tr>
<tr><td><code id="axis.mult_+3A_mult.label">mult.label</code></td>
<td>
<p>the label to show the multiplier - defaults to &quot;x mult&quot;</p>
</td></tr>
<tr><td><code id="axis.mult_+3A_mult.line">mult.line</code></td>
<td>
<p>the margin line upon which to show the multiplier</p>
</td></tr>
<tr><td><code id="axis.mult_+3A_mult.labelpos">mult.labelpos</code></td>
<td>
<p>where to place &lsquo;<span class="samp">&#8288;mult.label&#8288;</span>&rsquo; - defaults to centered
and outside the axis tick labels</p>
</td></tr>
<tr><td><code id="axis.mult_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;axis&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;axis.mult&#8288;</span>&rsquo; automates the process of displaying an axis with a 
multiplier applied to the tick values. By default it will divide the
default axis tick labels by &lsquo;<span class="samp">&#8288;mult&#8288;</span>&rsquo; and place &lsquo;<span class="samp">&#8288;mult.label&#8288;</span>&rsquo;
where &lsquo;<span class="samp">&#8288;xlab&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;ylab&#8288;</span>&rsquo; would normally appear. Thus the plot
call should set the relevant label to an empty string in such cases.
It is simplest to call &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo; with &lsquo;<span class="samp">&#8288;axes=FALSE&#8288;</span>&rsquo; and then 
display the box and any standard axes before calling &lsquo;<span class="samp">&#8288;axis.mult&#8288;</span>&rsquo;.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>While &lsquo;<span class="samp">&#8288;axis.mult&#8288;</span>&rsquo; will try to display an axis on any side, the top
and right margins will require adjustment using &lsquo;<span class="samp">&#8288;par&#8288;</span>&rsquo; for
&lsquo;<span class="samp">&#8288;axis.mult&#8288;</span>&rsquo; to display properly.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+axis">axis</a>, <a href="graphics.html#topic+mtext">mtext</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(1:10 * 0.001, 1:10 * 100,axes = FALSE, xlab = "", ylab = "",
  main = "Axis multipliers")
 box()
 axis.mult(1, mult = 0.001)
 axis.mult(2, mult = 100)
</code></pre>

<hr>
<h2 id='barlabels'>Label the bars on a barplot</h2><span id='topic+barlabels'></span>

<h3>Description</h3>

<p>Displays labels on a plot, usually a bar plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'> barlabels(xpos,ypos,labels=NULL,cex=1,prop=0.5,miny=0,offset=0,nobox=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barlabels_+3A_xpos">xpos</code></td>
<td>
<p>A vector, matrix or data frame of x positions for the labels.</p>
</td></tr>
<tr><td><code id="barlabels_+3A_ypos">ypos</code></td>
<td>
<p>A vector, matrix or data frame of y values for the labels.</p>
</td></tr>
<tr><td><code id="barlabels_+3A_labels">labels</code></td>
<td>
<p>The labels to display. Defaults to the values of ypos.</p>
</td></tr>
<tr><td><code id="barlabels_+3A_cex">cex</code></td>
<td>
<p>Relative size of the labels. See &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="barlabels_+3A_prop">prop</code></td>
<td>
<p>The proportion of &lsquo;<span class="samp">&#8288;ypos&#8288;</span>&rsquo; at which to place the labels.
Defaults to 0.5 (the middle).</p>
</td></tr>
<tr><td><code id="barlabels_+3A_miny">miny</code></td>
<td>
<p>The minimum value at which to display labels.</p>
</td></tr>
<tr><td><code id="barlabels_+3A_offset">offset</code></td>
<td>
<p>Amount to horizontally offset successive labels in case
of vertical overlaps.</p>
</td></tr>
<tr><td><code id="barlabels_+3A_nobox">nobox</code></td>
<td>
<p>Whether to call &lsquo;<span class="samp">&#8288;boxed.labels&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="barlabels_+3A_...">...</code></td>
<td>
<p>Extra arguments passed to &lsquo;<span class="samp">&#8288;boxed.labels&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;barlabels&#8288;</span>&rsquo; places labels on a plot at horizontal positions &lsquo;<span class="samp">&#8288;xpos&#8288;</span>&rsquo;
and vertical positions &lsquo;<span class="samp">&#8288;ypos&#8288;</span>&rsquo; * &lsquo;<span class="samp">&#8288;prop&#8288;</span>&rsquo;. The typical use of this
function is to place labels on bars, by default in the middle of the bars.
</p>
<p>To put labels just over the tops of the bars, set &lsquo;<span class="samp">&#8288;prop&#8288;</span>&rsquo; to 1 and add a
constant amount to &lsquo;<span class="samp">&#8288;ypos&#8288;</span>&rsquo;.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+boxed.labels">boxed.labels</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> heights&lt;-c(14,20,9,31,17)
 barpos&lt;-barplot(heights,main="A redundant bar plot")
 # show the usual value labels on the bars
 barlabels(barpos,heights)
 # now with stacked bars and offsets
 heights&lt;-matrix(sample(c(1,2,10,15),20,TRUE),ncol=4)
 barpos&lt;-barplot(heights,main="A redundant stacked bar plot")
 barlabels(barpos,heights,offset=0.1)
 # do it again without stacking
 barpos&lt;-barplot(heights,main="An unstacked redundant bar plot",
  beside=TRUE)
 barlabels(barpos,heights)
 # finally use barp for the plot
 barpos&lt;-barp(heights,main="A fourth and final bar plot",col=2:6,
  names.arg=paste("Day",1:4))
 barlabels(barpos$x,barpos$y,matrix(LETTERS[1:5],nrow=5,ncol=4))
</code></pre>

<hr>
<h2 id='barNest'>Display a nested breakdown of numeric values</h2><span id='topic+barNest'></span>

<h3>Description</h3>

<p>Breaks down the elements of a data frame by one or more
categorical elements and displays the breakdown as a bar plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'> barNest(formula=NULL,data=NULL,FUN=c("mean","sd","sd","valid.n"),ylim=NULL,
 main="",xlab="",ylab="",shrink=0.1,errbars=FALSE,col=NA,
 labelcex=1,lineht=NULL,showall=TRUE,Nwidths=FALSE,barlabels=NULL,
 showlabels=TRUE,mar=NULL,arrow.cap=NULL,trueval=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barNest_+3A_formula">formula</code></td>
<td>
<p>A formula with a numeric element of a data frame on the left and
one or more categorical elements on the right.</p>
</td></tr>
<tr><td><code id="barNest_+3A_data">data</code></td>
<td>
<p>A data frame containing the elements in &lsquo;<span class="samp">&#8288;formula&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="barNest_+3A_fun">FUN</code></td>
<td>
<p>The functions to apply to x.</p>
</td></tr>
<tr><td><code id="barNest_+3A_ylim">ylim</code></td>
<td>
<p>Optional y limits for the plot, usually necessary for counts.</p>
</td></tr>
<tr><td><code id="barNest_+3A_main">main</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
<tr><td><code id="barNest_+3A_xlab">xlab</code>, <code id="barNest_+3A_ylab">ylab</code></td>
<td>
<p>Axis labels for the plot. The x axis label is typically blank</p>
</td></tr>
<tr><td><code id="barNest_+3A_shrink">shrink</code></td>
<td>
<p>The proportion to shrink the width of the bars at each level.</p>
</td></tr>
<tr><td><code id="barNest_+3A_errbars">errbars</code></td>
<td>
<p>Whether to display error bars on the lowest level of breakdown.</p>
</td></tr>
<tr><td><code id="barNest_+3A_col">col</code></td>
<td>
<p>The colors to use to fill the bars. See Details.</p>
</td></tr>
<tr><td><code id="barNest_+3A_labelcex">labelcex</code></td>
<td>
<p>Character size for the group labels.</p>
</td></tr>
<tr><td><code id="barNest_+3A_lineht">lineht</code></td>
<td>
<p>The height of a line of text in the lower margin of the plot in user
units. This will be calculated by the function if a value is not passed.</p>
</td></tr>
<tr><td><code id="barNest_+3A_showall">showall</code></td>
<td>
<p>Whether to display bars for the entire breakdown.</p>
</td></tr>
<tr><td><code id="barNest_+3A_nwidths">Nwidths</code></td>
<td>
<p>Whether to scale the widths of the bars to the number of
observations.</p>
</td></tr>
<tr><td><code id="barNest_+3A_barlabels">barlabels</code></td>
<td>
<p>Optional group labels that may be useful if the factors used to
break down the numeric variable are fairly long strings.</p>
</td></tr>
<tr><td><code id="barNest_+3A_showlabels">showlabels</code></td>
<td>
<p>Whether to display the labels below the bars.</p>
</td></tr>
<tr><td><code id="barNest_+3A_mar">mar</code></td>
<td>
<p>If not NULL, a four element vector to set the plot margins. If new
margins are set, the user must reset the margins after the function exits.</p>
</td></tr>
<tr><td><code id="barNest_+3A_arrow.cap">arrow.cap</code></td>
<td>
<p>The width of the &quot;cap&quot; on error bars in user units,
calculated on the basis of the number of bars in the final breakdown if NA.</p>
</td></tr>
<tr><td><code id="barNest_+3A_trueval">trueval</code></td>
<td>
<p>If this is not NA, the call to &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo; will return the
proportions of the response variable that are equal to &lsquo;<span class="samp">&#8288;trueval&#8288;</span>&rsquo;.
See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;barNest&#8288;</span>&rsquo; displays a bar plot illustrating the hierarchic breakdown of
the elements of a data frame. The breakdown is performed by &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo;
and the actual display is performed by &lsquo;<span class="samp">&#8288;drawNestedBars&#8288;</span>&rsquo;. The heights of
the bars will be proportional to the values returned by the first function in
&lsquo;<span class="samp">&#8288;FUN&#8288;</span>&rsquo;. If &lsquo;<span class="samp">&#8288;showall&#8288;</span>&rsquo; is TRUE, the entire nested breakdown will be
displayed. This can be useful in visualizing the relationship between groups
and subgroups in a compact format.
</p>
<p>&lsquo;<span class="samp">&#8288;barNest&#8288;</span>&rsquo; assumes that there will be four breakdowns in the list
returned by &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo; in the order summary measure, upper dispersion
value, lower dispersion value and number of valid observations. If
&lsquo;<span class="samp">&#8288;Nwidths=FALSE&#8288;</span>&rsquo;, it may work with only three and if &lsquo;<span class="samp">&#8288;errbars=FALSE&#8288;</span>&rsquo;
as well, it may work with only one.
</p>
<p>If &lsquo;<span class="samp">&#8288;Nwidths=TRUE&#8288;</span>&rsquo;, the bar widths will be scaled to the relative number
of observations per group. When the numbers of observations are very different,
the labels for those bars with small numbers of observations will probably
overlap.
</p>
<p>A number of functions can be passed in the &lsquo;<span class="samp">&#8288;FUN&#8288;</span>&rsquo; argument. Three
functions, &lsquo;<span class="samp">&#8288;propbrk&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;sumbrk&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;valid.n&#8288;</span>&rsquo; will work as
summary measures, giving proportions or sums of particular values of a
discrete variable and counts in each group and subgroup respectively.
Binomial confidence limits can be added to the proportions returned by
&lsquo;<span class="samp">&#8288;propbrk&#8288;</span>&rsquo; with &lsquo;<span class="samp">&#8288;binciWl&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;binciWu&#8288;</span>&rsquo; as in the second last
example. If &lsquo;<span class="samp">&#8288;valid.n&#8288;</span>&rsquo; is the first element of &lsquo;<span class="samp">&#8288;FUN&#8288;</span>&rsquo;, the &quot;overall&quot;
bar and label will be suppressed, as they are not informative. It is up to
the user to decide whether any &quot;error bars&quot; displayed are meaningful.
</p>
<p>The colors of the bars are determined by &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo;. If &lsquo;<span class="samp">&#8288;showall&#8288;</span>&rsquo; is
FALSE, the user only need pass a vector of colors, usually the same length
as the number of categories in the final (last on the right side) element in
the formula. If &lsquo;<span class="samp">&#8288;showall&#8288;</span>&rsquo; is TRUE and the user wants to color all of the
bars, a list with as many elements as there are levels in the breakdown
should be passed. Each element should be a vector of colors, again usually
the same length as the number of categories. As the categorical variables are
likely to be factors, it is important to remember that the colors must be in
the correct order for the levels of the factors. When the levels are not in
the default alphanumeric order, it is quite easy to get this wrong. As a
&lsquo;<span class="samp">&#8288;barNest&#8288;</span>&rsquo; plot with more than a few factors and levels in each factor is
quite dense, easily distinguished colors for each level of the breakdown may
be preferable. As with some other plots, trying to cram too much information
into a single illustration may not work well.
</p>


<h3>Value</h3>

<p>The summary list produced by brkdnNest.</p>


<h3>Author(s)</h3>

<p>Jim Lemon and Ofir Levy</p>


<h3>References</h3>

<p>Lemon, J. &amp; Levy, O. (2011) barNest: Illustrating nested summary measures.
Statistical Computing and Graphics Newsletter of the American Statistical
Association, 21(2): 5-10.
</p>


<h3>See Also</h3>

<p><a href="#topic+brkdnNest">brkdnNest</a>, <a href="#topic+drawNestedBars">drawNestedBars</a>, superbarplot(UsingR)</p>


<h3>Examples</h3>

<pre><code class='language-R'> # recreate the Titanic data frame and show the three way breakdown
 titanic&lt;-data.frame(
  class=c(rep("1st",325),rep("2nd",285),rep("3rd",706),rep("Crew",885)),
  age=c(rep("Adult",319),rep("Child",6),rep("Adult",261),rep("Child",24),
  rep("Adult",627),rep("Child",79),rep("Adult",885)),
  sex=c(rep("M",175),rep("F",144),rep("M",5),rep("F",1),
  rep("M",168),rep("F",93),rep("M",11),rep("F",13),
  rep("M",462),rep("F",165),rep("M",48),rep("F",31),
  rep("M",862),rep("F",23)),
  survived=c(rep("Yes",57),rep("No",118),rep("Yes",140),rep("No",4),rep("Yes",6),
  rep("Yes",14),rep("No",154),rep("Yes",80),rep("No",13),rep("Yes",24),
  rep("Yes",75),rep("No",387),rep("Yes",76),rep("No",89),
  rep("Yes",13),rep("No",35),rep("Yes",14),rep("No",17),
  rep("Yes",192),rep("No",670),rep("Yes",20),rep("No",3)))
 require(plotrix)
 titanic.colors&lt;-list("gray90",c("#0000ff","#7700ee","#aa00cc","#dd00aa"),
  c("#ddcc00","#ee9900"),c("pink","lightblue"))
 barNest(survived~class+age+sex,titanic,col=titanic.colors,showall=TRUE,
  main="Titanic survival by class, age and sex",ylab="Proportion surviving",
  FUN=c("propbrk","binciWu","binciWl","valid.n"),shrink=0.15,trueval="Yes")
 barNest(survived~class+age+sex,titanic,col=titanic.colors,showall=TRUE,
  main="Titanic survival by class, age and sex (scaled bar widths)",
  ylab="Proportion surviving",FUN=c("propbrk","binciWu","binciWl","valid.n"),
  shrink=0.15,trueval="Yes",Nwidths=TRUE)
 # now show the actual numbers of passengers
 barNest(survived~class+age+sex,titanic,col=titanic.colors,showall=TRUE,
  main="Titanic passengers and crew by class, age and sex",
  ylab="Number",FUN="valid.n",shrink=0.15)
 # to see this properly displayed, start a wide plot window
 # x11(width=10)
 test.df&lt;-data.frame(Age=rnorm(100,35,10),
  Sex=sample(c("Male","Female"),100,TRUE),
  Marital=sample(c("Div","Mar","Sing","Wid"),100,TRUE),
  Employ=sample(c("FT","PT","Un"),100,TRUE))
 test.col&lt;-list(Overall="gray",Sex=c("pink","lightblue"),
  Marital=c("mediumpurple","orange","tan","lightgreen"),
  Employ=c("#1affd8","#caeecc","#ff90d0"))
 barNest(formula=Age~Sex+Marital+Employ,data=test.df,ylab="Mean age (years)",
  main="Mean age by subgroups",errbars=TRUE,col=test.col)
 barNest(formula=Age~Sex+Marital+Employ,data=test.df,ylab="Mean age (years)",
  main="Mean age by subgroups (widths scaled to Ns)",errbars=TRUE,col=test.col,
  Nwidths=TRUE)
 # set up functions for 20th and 80th percentiles
 q20&lt;-function(x,na.rm=TRUE) return(quantile(x,probs=0.2,na.rm=TRUE))
 q80&lt;-function(x,na.rm=TRUE) return(quantile(x,probs=0.8,na.rm=TRUE))
 # show the asymmetric dispersion measures
 barNest(formula=Age~Sex+Marital+Employ,data=test.df,ylab="Mean age (years)",
  main="Use median and quantiles for dispersion",
  FUN=c("median","q80","q20","valid.n"),
  errbars=TRUE,col=test.col)
 barNest(formula=Employ~Sex+Marital,data=test.df,ylab="Proportion unemployed",
  main="Proportion unemployed by sex and marital status",
  FUN=c("propbrk","binciWu","binciWl","valid.n"),
  errbars=TRUE,col=test.col,trueval="Un")
 barNest(formula=Employ~Sex+Marital,data=test.df,ylab="Proportion unemployed",
  main="Proportion unemployed by sex and marital status (scaled bar widths)",
  FUN=c("propbrk","binciWu","binciWl","valid.n"),
  errbars=TRUE,col=test.col,trueval="Un",Nwidths=TRUE)
 barNest(formula=Age~Sex+Marital+Employ,data=test.df,ylab="Counts",
  main="Show the counts in subgroups (final level only)",FUN="valid.n",
  col=test.col,showall=FALSE,ylim=c(0,10))
 barNest(formula=Age~Sex+Marital+Employ,data=test.df,ylab="Counts",
  main="Show all the counts in subgroups",FUN="valid.n",mar=c(5,5,4,2),
  col=test.col)
 </code></pre>

<hr>
<h2 id='barp'>A bar plotting routine</h2><span id='topic+barp'></span>

<h3>Description</h3>

<p>Display a bar plot</p>


<h3>Usage</h3>

<pre><code class='language-R'> barp(height,width=0.4,names.arg=NULL,legend.lab=NULL,legend.pos=NULL,
 col=NULL,border=par("fg"),main=NULL,xlab="",ylab="",xlim=NULL,ylim=NULL,
 x=NULL,staxx=FALSE,staxy=FALSE, height.at=NULL,height.lab=NULL,
 cex.axis=par("cex.axis"),pch=NULL,cylindrical=FALSE,shadow=FALSE,
 do.first=NULL,ylog=FALSE,srt=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barp_+3A_height">height</code></td>
<td>
<p>A numeric vector, matrix or data frame that will be represented
as the heights of bars.</p>
</td></tr>
<tr><td><code id="barp_+3A_width">width</code></td>
<td>
<p>Half the width of a single bar or group of bars in X axis units.</p>
</td></tr>
<tr><td><code id="barp_+3A_names.arg">names.arg</code></td>
<td>
<p>The labels for the bars or groups of bars.</p>
</td></tr>
<tr><td><code id="barp_+3A_legend.lab">legend.lab</code></td>
<td>
<p>Labels for an optional legend. If NULL, no legend is
displayed.</p>
</td></tr>
<tr><td><code id="barp_+3A_legend.pos">legend.pos</code></td>
<td>
<p>Optional position for the legend as a list with &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;
and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; components. If this is NULL, &lsquo;<span class="samp">&#8288;locator&#8288;</span>&rsquo; will be called.</p>
</td></tr>
<tr><td><code id="barp_+3A_col">col</code></td>
<td>
<p>The fill colors for the bars. The default is no fill.</p>
</td></tr>
<tr><td><code id="barp_+3A_border">border</code></td>
<td>
<p>The border for the bars.</p>
</td></tr>
<tr><td><code id="barp_+3A_main">main</code></td>
<td>
<p>The title at the top of the plot.</p>
</td></tr>
<tr><td><code id="barp_+3A_xlab">xlab</code>, <code id="barp_+3A_ylab">ylab</code></td>
<td>
<p>The labels for the X and Y axes respectively.</p>
</td></tr>
<tr><td><code id="barp_+3A_xlim">xlim</code>, <code id="barp_+3A_ylim">ylim</code></td>
<td>
<p>Optional horizontal and vertical limits for the plot.</p>
</td></tr>
<tr><td><code id="barp_+3A_x">x</code></td>
<td>
<p>Optional horizontal positions for the bars. Defaults to 1:length(height).</p>
</td></tr> 
<tr><td><code id="barp_+3A_staxx">staxx</code>, <code id="barp_+3A_staxy">staxy</code></td>
<td>
<p>Whether to use <a href="#topic+staxlab">staxlab</a> to stagger the 
X or Y axis tick labels. Can also omit the X or Y axes.</p>
</td></tr>
<tr><td><code id="barp_+3A_height.at">height.at</code></td>
<td>
<p>Optional positions of the tick marks on the Y axis.</p>
</td></tr>
<tr><td><code id="barp_+3A_height.lab">height.lab</code></td>
<td>
<p>Optional tick labels for the Y axis.</p>
</td></tr>
<tr><td><code id="barp_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Character expansion for the axis labels.</p>
</td></tr>
<tr><td><code id="barp_+3A_pch">pch</code></td>
<td>
<p>Symbol(s) to fill the bars. See Details.</p>
</td></tr>
<tr><td><code id="barp_+3A_cylindrical">cylindrical</code></td>
<td>
<p>Whether to give the bars a cylindrical appearance
by shading them.</p>
</td></tr>
<tr><td><code id="barp_+3A_shadow">shadow</code></td>
<td>
<p>Whether to place a shadow behind the bars.</p>
</td></tr>
<tr><td><code id="barp_+3A_do.first">do.first</code></td>
<td>
<p>An optional string that will be evaluated before anything
else is displayed on the plot. Useful for background colors or lines.</p>
</td></tr>
<tr><td><code id="barp_+3A_ylog">ylog</code></td>
<td>
<p>Logical for whether a log scale is to be used. see details.</p>
</td></tr>
<tr><td><code id="barp_+3A_srt">srt</code></td>
<td>
<p>Rotation of axis labels if staxx or staxy is TRUE (see
&lsquo;<span class="samp">&#8288;staxlab&#8288;</span>&rsquo;).</p>
</td></tr>
<tr><td><code id="barp_+3A_...">...</code></td>
<td>
<p>arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;</p>
</td></tr></table>
<p>.
</p>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;barp&#8288;</span>&rsquo; displays a bar plot similar to &lsquo;<span class="samp">&#8288;barplot&#8288;</span>&rsquo; but with axes and
horizontal bar positions more like &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;. Bars or groups of bars are
centered on integral X values by default, and so both the width and spacing of
the bars are controlled by a single number. If the user passes explicit &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;
values, those values will determine the spacing. If &lsquo;<span class="samp">&#8288;height&#8288;</span>&rsquo; is a vector,
single bars representing each value will be displayed centered at
&lsquo;<span class="samp">&#8288;1:length(height)&#8288;</span>&rsquo; unless the user has specified &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; values.
If &lsquo;<span class="samp">&#8288;height&#8288;</span>&rsquo; is a matrix, 2D array, or data frame, a group of bars will be
drawn for each column, with the values of the group taken from the rows of that
column. Explicit x values cannot be used with a matrix, however, by adjusting the
values of x, grouped bars can be displayed.
</p>
<p>The values from &lsquo;<span class="samp">&#8288;freq&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;brkdn&#8288;</span>&rsquo; in the prettyR package can
be used as the &lsquo;<span class="samp">&#8288;height&#8288;</span>&rsquo; argument. The value from &lsquo;<span class="samp">&#8288;table&#8288;</span>&rsquo; can also be
passed as &lsquo;<span class="samp">&#8288;height&#8288;</span>&rsquo;, as can a 2D array returned from the &lsquo;<span class="samp">&#8288;by&#8288;</span>&rsquo; function.
</p>
<p>Bars are empty by default but fill colors can be defined in several ways.
If a single color is passed, all bars will be the same color. If &lsquo;<span class="samp">&#8288;height&#8288;</span>&rsquo;
is a vector, colors will be recycled or some will be ignored if the length of
&lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; is
not equal to that of &lsquo;<span class="samp">&#8288;height&#8288;</span>&rsquo;. If &lsquo;<span class="samp">&#8288;height&#8288;</span>&rsquo; is a matrix or data frame,
the user may pass a vector of colors equal to the number of rows in &lsquo;<span class="samp">&#8288;height&#8288;</span>&rsquo;
or a matrix of colors of the same dimensions as &lsquo;<span class="samp">&#8288;height&#8288;</span>&rsquo;. Other sequences
of color will probably not result in an easy to interpret plot.
</p>
<p>&lsquo;<span class="samp">&#8288;barp&#8288;</span>&rsquo; is intended to simplify illustrating categorical data for which both
the variable designations and the categories are names, as on many multiple
choice questions.  &lsquo;<span class="samp">&#8288;height.at&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;height.lab&#8288;</span>&rsquo; allow the user to place
labels on the vertical axis, usually representing the options. If &lsquo;<span class="samp">&#8288;staxx&#8288;</span>&rsquo;
or &lsquo;<span class="samp">&#8288;staxy&#8288;</span>&rsquo; are TRUE, the labels on the horizontal or vertical axes
respectively will be staggered, allowing the user to use many or lengthy variable
or value labels. If &lsquo;<span class="samp">&#8288;srt&#8288;</span>&rsquo; is not NULL, these labels will be rotated 
counterclockwise by that value as angles in degrees instead of staggered.
</p>
<p>If &lsquo;<span class="samp">&#8288;staxx&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;staxy&#8288;</span>&rsquo; are set to NA, the respective axis will not
be displayed.
</p>
<p>&lsquo;<span class="samp">&#8288;barp&#8288;</span>&rsquo; allows two enhancements that may be useful in those areas where fancy
plots are appreciated. One is to give the bars a cylindrical look by shading the
color. The other is to place an apparent shadow behind each bar. Both of these
effects appear as though the light is coming from the upper left, and this is
hard coded. You can add error bars by calling &lsquo;<span class="samp">&#8288;dispersion&#8288;</span>&rsquo;, but many advise
against this.
</p>
<p>If &lsquo;<span class="samp">&#8288;legend.lab&#8288;</span>&rsquo; is not NULL, a legend will be displayed. If 
&lsquo;<span class="samp">&#8288;legend.pos&#8288;</span>&rsquo; is NULL, &lsquo;<span class="samp">&#8288;locator&#8288;</span>&rsquo; is called to place the legend. On 
Windows, the alert may not appear on the console, and the function will 
appear to hang unless the user clicks on the console window or the plot.
</p>
<p>The &lsquo;<span class="samp">&#8288;ylog&#8288;</span>&rsquo; argument produces a log scale on the y axis. Currently,
neither &lsquo;<span class="samp">&#8288;pretty&#8288;</span>&rsquo; nor &lsquo;<span class="samp">&#8288;axTicks&#8288;</span>&rsquo; seems to produce a nice set of axis
ticks, so it is best to pass the positions of these in &lsquo;<span class="samp">&#8288;height.at&#8288;</span>&rsquo;.
</p>
<p>If the &lsquo;<span class="samp">&#8288;pch&#8288;</span>&rsquo; argument is not NULL, barp will display white bars filled
with the symbols specified in &lsquo;<span class="samp">&#8288;pch&#8288;</span>&rsquo;. With grouped bars, this must be a
matrix with the same form as the &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; argument. This option allows a
black and white bar plot to be produced.
</p>


<h3>Value</h3>

<p>A list containing two components of the same form as &lsquo;<span class="samp">&#8288;height&#8288;</span>&rsquo;:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The centers of the bars displayed.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The heights of the bars.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+staxlab">staxlab</a>, <a href="graphics.html#topic+barplot">barplot</a>, <a href="#topic+cylindrect">cylindrect</a>,
<a href="#topic+gradient.rect">gradient.rect</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # get some extra room on the left
 par(mar=c(5,5,4,2))
 # make up some happiness data, as so many seem to do
 happyday&lt;-data.frame(Monday=c(2.3,3.4),Tuesday=c(2.8,3.3),Wednesday=c(3.2,3.1),
 Thursday=c(3.6,2.8),Friday=c(4.2,2.6),Saturday=c(4.5,2.9),Sunday=c(4.1,2.8))
 happylabels&lt;-c("Utterly dashed","Rather mopey","Indifferent","Somewhat elated",
  "Euphoric")
 barp(happyday,names.arg=names(happyday),legend.lab=c("Slaves","Unemployed"),
  legend.pos=list(x=2,y=4.5),col=c("#ee7700","#3333ff"),main="9AM happiness by weekday",
  xlab="Day of week",ylab="Happiness rating",ylim=c(1,5),staxx=TRUE,staxy=TRUE,
  height.at=1:5,height.lab=happylabels,cex.axis=0.9,cylindrical=TRUE,
  shadow=TRUE)
 # now do a plot with colors scaled to the sex ratio (real data!)
 sexratio&lt;-c(0.24,0.35,0.09,0.59,0.63,0.34,0.7,0.6)
 # the fun ratings are once again a pack of lies
 funrating&lt;-c(3.2,3.5,1.5,5.4,4.5,2.7,6.8,4.9)
 funstudy&lt;-c("Astronomy","Chemistry","Economics","Anthropology","Linguistics",
  "Math/Stats","Psychology","Sociology")
 funlabels&lt;-c("Torture","Agony","Boredom","Neutral","Entertaining","Exhilarating",
  "Maniacal")
 # xrange is used to get the colors to match the 0-100% scale
 barp(funrating,names.arg=funstudy,main="Fun ratings for various areas of study",
  col=color.scale(sexratio,c(0.2,1),c(0.2,0.4),c(1,0.4),xrange=c(0,1)),
  xlab="Study",ylab="Rating",height.at=1:7,height.lab=funlabels,ylim=c(1,7),
  staxx=TRUE,staxy=TRUE,cex.axis=0.9)
 # here we want the full scale from zero to one
 color.legend(2,6,4,6.4,legend=c("100% guys","100% girls"),
  rect.col=color.scale(seq(0,1,by=0.25),c(0.2,1),c(0.2,0.4),c(1,0.4)))
 par(mar=c(5,4,4,2))
 # use barp to display a multiple histogram with a shaded background
 # notice how the expression uses local variables inside the barp function
 gradbg&lt;-"gradient.rect(xlim[1],ylim[1],xlim[2],ylim[2],
  c(1,0.5,1),c(1,0.5,1),c(1,0.5,1),gradient=\"y\",nslices=100)"
 h1&lt;-table(cut(rnorm(100,4),breaks=seq(0,8,by=2)))
 h2&lt;-table(cut(rnorm(100,4),breaks=seq(0,8,by=2)))
 h3&lt;-table(cut(rnorm(100,4),breaks=seq(0,8,by=2)))
 hmat&lt;-matrix(c(h1,h2,h3),nrow=3,byrow=TRUE)
 barp(hmat,names.arg=names(h1),width=0.45,col=2:4,do.first=gradbg,
  main="Multiple histogram using barp",xlab="Bins",ylab="Frequency")
 legend(3.8,50,c("h1","h2","h3"),fill=2:4)
 # now display a positive/negative plot
 barp(c(2,-3,4,-5,6,-7,8),main="Positive/negative plot",
  xlab="Alternating colors",ylab="For alternating values",
  col=2+(c(2,-3,4,-5,6,-7,8)&gt;0))
</code></pre>

<hr>
<h2 id='battleship.plot'>Display a matrix of values as the widths of stacked rectangles</h2><span id='topic+battleship.plot'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;battleship.plot&#8288;</span>&rsquo; displays a matrix of rectangles, with widths
proportional to the values in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;. The values are scaled so that half the
width of the largest rectangle is equal to &lsquo;<span class="samp">&#8288;maxxspan&#8288;</span>&rsquo; in user units. This
prevents the rectangles from overlapping. The user can adjust the spacing of the
stacks of rectangles by changing &lsquo;<span class="samp">&#8288;maxxspan&#8288;</span>&rsquo;. Similarly, maxyspan controls
the spacing between rectangles in the vertical direction.
</p>
<p>The labels for each stack of plots (the columns of x) are displayed at the top
of the plot, angled at 45 degrees. The labels for each row of rectangles in the
stacks (the rows of x) are displayed at the left. Long labels for either may
require adjusting the &lsquo;<span class="samp">&#8288;mar&#8288;</span>&rsquo; argument. 
</p>
<p>The function will try to extract the labels &lsquo;<span class="samp">&#8288;xaxlab&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;yaxlab&#8288;</span>&rsquo; from
the matrix column and row names respectively if none are passed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> battleship.plot(x,mar=c(2,5,5,1),col="white",border="black",
 main="",xlab="",ylab="",xaxlab=NULL,yaxlab=NULL,cex.labels=1,
 maxxspan=0.45,maxyspan=0.45)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="battleship.plot_+3A_x">x</code></td>
<td>
<p>A matrix or data frame containing numeric values. See the example.</p>
</td></tr>
<tr><td><code id="battleship.plot_+3A_mar">mar</code></td>
<td>
<p>Margins for the plot.</p>
</td></tr>
<tr><td><code id="battleship.plot_+3A_col">col</code></td>
<td>
<p>The fill colors for the rectangles.</p>
</td></tr>
<tr><td><code id="battleship.plot_+3A_border">border</code></td>
<td>
<p>The border colors for the rectangles.</p>
</td></tr>
<tr><td><code id="battleship.plot_+3A_main">main</code></td>
<td>
<p>The title for the plot (i.e. &lsquo;<span class="samp">&#8288;main&#8288;</span>&rsquo;).</p>
</td></tr>
<tr><td><code id="battleship.plot_+3A_xlab">xlab</code>, <code id="battleship.plot_+3A_ylab">ylab</code></td>
<td>
<p>The x and y axis labels.</p>
</td></tr>
<tr><td><code id="battleship.plot_+3A_xaxlab">xaxlab</code>, <code id="battleship.plot_+3A_yaxlab">yaxlab</code></td>
<td>
<p>Optional labels for the rows and columns.</p>
</td></tr>
<tr><td><code id="battleship.plot_+3A_cex.labels">cex.labels</code></td>
<td>
<p>Character expansion for the row and column labels.</p>
</td></tr>
<tr><td><code id="battleship.plot_+3A_maxxspan">maxxspan</code>, <code id="battleship.plot_+3A_maxyspan">maxyspan</code></td>
<td>
<p>Scaling factor for the widths and heights of the
rectangles so that they don't overlap.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon - thanks to Adam Maltese for the suggestion</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a>, <a href="#topic+staxlab">staxlab</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-matrix(sample(10:50,100,TRUE),10)
 xaxlab=c("One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten")
 yaxlab=c("First","Second","Third","Fourth","Fifth","Sixth","Seventh",
  "Eighth","Ninth","Tenth")
 battleship.plot(x,xlab="The battle has just begun",main="Battleship1",
  xaxlab=xaxlab,yaxlab=yaxlab)
</code></pre>

<hr>
<h2 id='bin.wind.records'>Classify wind direction and speed records</h2><span id='topic+bin.wind.records'></span>

<h3>Description</h3>

<p>Classifies wind direction and speed records into a matrix of
percentages of observations in speed and direction bins.</p>


<h3>Usage</h3>

<pre><code class='language-R'> bin.wind.records(winddir,windspeed,ndir=8,radians=FALSE,
  speed.breaks=c(0,10,20,30))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bin.wind.records_+3A_winddir">winddir</code></td>
<td>
<p>A vector of wind directions.</p>
</td></tr>
<tr><td><code id="bin.wind.records_+3A_windspeed">windspeed</code></td>
<td>
<p>A vector of wind speeds corresponding to the above
directions.</p>
</td></tr>
<tr><td><code id="bin.wind.records_+3A_ndir">ndir</code></td>
<td>
<p>Number of direction bins in a compass circle.</p>
</td></tr>
<tr><td><code id="bin.wind.records_+3A_radians">radians</code></td>
<td>
<p>Whether wind directions are in radians.</p>
</td></tr>
<tr><td><code id="bin.wind.records_+3A_speed.breaks">speed.breaks</code></td>
<td>
<p>Minimum wind speed for each speed bin.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;bin.wind.records&#8288;</span>&rsquo; bins a number of wind direction and speed
records into a matrix of percentages of observations that can be used to
display a cumulative wind rose with &lsquo;<span class="samp">&#8288;oz.windrose&#8288;</span>&rsquo; The defaults are those
used by the Australian Bureau of Meteorology.
</p>


<h3>Value</h3>

<p>A matrix of percentages in which the rows represent wind speed categories and 
the columns represent wind direction categories.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+oz.windrose">oz.windrose</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> winddir&lt;-sample(0:360,100,TRUE)
 windspeed&lt;-sample(0:40,100,TRUE)
 bin.wind.records(winddir,windspeed)
</code></pre>

<hr>
<h2 id='binciW'>Binomial confidence limits</h2><span id='topic+binciW'></span>

<h3>Description</h3>

<p>Calculates binomial confidence limits using the Wilson approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> binciW(x,n,alpha=0.05,cc=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binciW_+3A_x">x</code></td>
<td>
<p>The number of successes or failures for which the CI is to be calculated.</p>
</td></tr>
<tr><td><code id="binciW_+3A_n">n</code></td>
<td>
<p>The number of trials as above.</p>
</td></tr>
<tr><td><code id="binciW_+3A_alpha">alpha</code></td>
<td>
<p>The desired coverage - 0.05 produces 95 percent coverage</p>
</td></tr>
<tr><td><code id="binciW_+3A_cc">cc</code></td>
<td>
<p>Whether to apply a continuity correction</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;binciW&#8288;</span>&rsquo; calculates binomial confidence limits for the
given number of successes and trials. It is mainly to allow binomial
confidence limits to be calculated in the &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo; function,
which is why the upper and lower CIs are called separately.
</p>


<h3>Value</h3>

<p>The lower and upper binomial confidence limits</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+binciWl">binciWl</a>, <a href="#topic+binciWu">binciWu</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> binciW(5,42)
</code></pre>

<hr>
<h2 id='binciWl'>Lower binomial confidence limit</h2><span id='topic+binciWl'></span>

<h3>Description</h3>

<p>Returns the lower binomial confidence limit using the Wilson approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> binciWl(x,n,alpha=0.05,trueval=TRUE,na.rm=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binciWl_+3A_x">x</code></td>
<td>
<p>The number of successes or failures for which the CI is to be calculated.</p>
</td></tr>
<tr><td><code id="binciWl_+3A_n">n</code></td>
<td>
<p>The number of trials as above.</p>
</td></tr>
<tr><td><code id="binciWl_+3A_alpha">alpha</code></td>
<td>
<p>The desired coverage - 0.05 produces 95 percent coverage</p>
</td></tr>
<tr><td><code id="binciWl_+3A_trueval">trueval</code></td>
<td>
<p>The value representing the outcome of interest for the CI.</p>
</td></tr>
<tr><td><code id="binciWl_+3A_na.rm">na.rm</code></td>
<td>
<p>Argument needed to make this work</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;binciWl&#8288;</span>&rsquo; now calls &lsquo;<span class="samp">&#8288;binciW&#8288;</span>&rsquo; and returns the lower limit.
</p>


<h3>Value</h3>

<p>The lower binomial confidence limit</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+binciWu">binciWu</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> binciWl(c(rep(5,TRUE),rep(37,FALSE)))
</code></pre>

<hr>
<h2 id='binciWu'>Upper binomial confidence limit</h2><span id='topic+binciWu'></span>

<h3>Description</h3>

<p>Returns the upper binomial confidence limit using the Wilson approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> binciWu(x,n,alpha=0.05,trueval=TRUE,na.rm=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binciWu_+3A_x">x</code></td>
<td>
<p>The number of successes or failures for which the CI is to be calculated.</p>
</td></tr>
<tr><td><code id="binciWu_+3A_n">n</code></td>
<td>
<p>The number of trials as above.</p>
</td></tr>
<tr><td><code id="binciWu_+3A_alpha">alpha</code></td>
<td>
<p>The desired coverage - 0.05 produces 95 percent coverage</p>
</td></tr>
<tr><td><code id="binciWu_+3A_trueval">trueval</code></td>
<td>
<p>The value representing the outcome of interest for the CI.</p>
</td></tr>
<tr><td><code id="binciWu_+3A_na.rm">na.rm</code></td>
<td>
<p>Argument needed to make this work</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;binciWu&#8288;</span>&rsquo; now calls &lsquo;<span class="samp">&#8288;binciW&#8288;</span>&rsquo; and returns the upper limit.
</p>


<h3>Value</h3>

<p>The upper binomial confidence interval</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+binciWl">binciWl</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> binciWl(c(rep(5,TRUE),rep(37,FALSE)))
</code></pre>

<hr>
<h2 id='box.heresy'>Display a sort of box plot</h2><span id='topic+box.heresy'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;box.heresy&#8288;</span>&rsquo; displays a box plot in which a symbol represents a measure of
central tendency, a surrounding box that represents an &quot;inner&quot; measure of dispersion
(e.g. standard error) and whiskers represent an &quot;outer&quot; measure of dispersion
(e.g. standard deviation). The function is pretty basic at this time and will 
probably change a bit.
</p>
<p>The argument &quot;intervals&quot; is particularly important, and can wreak
havoc on the resulting plot. The default of FALSE means that the
values passed to the inner and outer measures of dispersion are
absolute, not intervals away from the measure of central tendency.
Mixing absolute and relative values will always lead to errors and
typically a very strange looking plot. It is probably easiest to
calculate the absolute values before calling box.heresy. The first and
second examples show how intervals=FALSE and intervals=TRUE can be used.
</p>
<p>One of the first changes is to allow varying box widths. The user can specify
the box widths as a vector of numeric values at least as long as the number
of boxes to be displayed. The usual reason for doing this is to display widths
that are proportional to the number of observations. A useful start is to pass
&lsquo;<span class="samp">&#8288;boxwidth&#8288;</span>&rsquo; as the number of observations and let the function work it out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> box.heresy(x,y,uinner,linner,ulim,llim,boxwidth=NULL,
  intervals=FALSE,arrow.cap=NULL,pch=22,main="",xlab="",ylab="",
  xaxlab=NULL,col="white",do.first=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="box.heresy_+3A_x">x</code>, <code id="box.heresy_+3A_y">y</code></td>
<td>
<p>Vectors of numeric values representing measures of central tendency.</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_uinner">uinner</code>, <code id="box.heresy_+3A_linner">linner</code></td>
<td>
<p>Vectors of numeric values representing &quot;inner&quot; measures of
dispersion.</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_ulim">ulim</code>, <code id="box.heresy_+3A_llim">llim</code></td>
<td>
<p>Vectors of numeric values representing &quot;outer&quot; measures of
dispersion.</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_boxwidth">boxwidth</code></td>
<td>
<p>Optional widths for the boxes.</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_intervals">intervals</code></td>
<td>
<p>Whether the values for dispersion are intervals (TRUE) or
absolute limits (FALSE).</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_arrow.cap">arrow.cap</code></td>
<td>
<p>The width of the cap on the &quot;whiskers&quot; relative to the width
of the plot. Defaults to the same width as the outer box.</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_pch">pch</code></td>
<td>
<p>The symbol to be used to represent the measure(s) of central tendency
in the box.</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_main">main</code></td>
<td>
<p>The title for the plot (i.e. &lsquo;<span class="samp">&#8288;main&#8288;</span>&rsquo;).</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_xlab">xlab</code>, <code id="box.heresy_+3A_ylab">ylab</code></td>
<td>
<p>The x and y axis labels.</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_xaxlab">xaxlab</code></td>
<td>
<p>Optional labels for the boxes.</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_col">col</code></td>
<td>
<p>The fill colors for the &quot;inner&quot; rectangles.</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_do.first">do.first</code></td>
<td>
<p>An expression that will be evaluated before anything is displayed.</p>
</td></tr>
<tr><td><code id="box.heresy_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the &lsquo;<span class="samp">&#8288;dispersion&#8288;</span>&rsquo; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon - thanks to Gianni Lavaredo for the suggestion</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a>, <a href="graphics.html#topic+boxplot">boxplot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> y1&lt;-runif(20,2,10)
 y2&lt;-rnorm(30,6,2)
 y3&lt;-sample(0:20,40,TRUE)
 Ns&lt;-c(20,30,40)
 ymean&lt;-c(mean(y1),mean(y2),mean(y3))
 y1inner&lt;-quantile(y1,probs=c(.16,.84))
 y2inner&lt;-c(ymean[2]+sd(y2),ymean[2]-sd(y2))
 y3inner&lt;-quantile(y3,probs=c(.16,.84))
 uinner&lt;-c(y1inner[1],y2inner[1],y3inner[1])
 linner&lt;-c(y1inner[2],y2inner[2],y3inner[2])
 ulim&lt;-c(max(y1),max(y2),max(y3))
 llim&lt;-c(min(y1),min(y2),min(y3))
 box.heresy(ymean,uinner=uinner,linner=linner,ulim=ulim,llim=llim,boxwidth=Ns,
  main="Boxplot of means, central spread and range",xlab="Distribution",
  xaxlab=c("Uniform","Normal","Sample"))
 y1outer&lt;-
 y&lt;-runif(5)
 ulim&lt;-runif(5)
 llim&lt;-runif(5)
 uinner&lt;-ulim/2
 linner&lt;-llim/2
 box.heresy(y,uinner=uinner,linner=linner,ulim=ulim,llim=llim,
  intervals=TRUE,main="The heretical boxplot",
  xlab="Number of observations",ylab="Value")
</code></pre>

<hr>
<h2 id='boxed.labels'> Place labels in boxes </h2><span id='topic+boxed.labels'></span>

<h3>Description</h3>

<p>Places labels in boxes on an existing plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'> boxed.labels(x,y=NULL,labels,
  bg=ifelse(match(par("bg"),"transparent",0),"white",par("bg")),
  border=TRUE,xpad=1.2,ypad=1.2,srt=0,cex=1,adj=0.5,xlog=FALSE,ylog=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxed.labels_+3A_x">x</code>, <code id="boxed.labels_+3A_y">y</code></td>
<td>
<p>x and y position of the centers of the labels. &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; can be an
<a href="grDevices.html#topic+xy.coords">xy.coords</a> list.</p>
</td></tr>
<tr><td><code id="boxed.labels_+3A_bg">bg</code></td>
<td>
<p>The fill color of the rectangles on which the labels are displayed
(see Details).</p>
</td></tr>
<tr><td><code id="boxed.labels_+3A_labels">labels</code></td>
<td>
<p>Text strings</p>
</td></tr>
<tr><td><code id="boxed.labels_+3A_border">border</code></td>
<td>
<p>Whether to draw borders around the rectangles.</p>
</td></tr>
<tr><td><code id="boxed.labels_+3A_xpad">xpad</code>, <code id="boxed.labels_+3A_ypad">ypad</code></td>
<td>
<p>The proportion of the rectangles to the
extent of the text within.</p>
</td></tr>
<tr><td><code id="boxed.labels_+3A_srt">srt</code></td>
<td>
<p>Rotation of the labels. If 90 or 270 degrees, the box will be
rotated 90 degrees.</p>
</td></tr>
<tr><td><code id="boxed.labels_+3A_cex">cex</code></td>
<td>
<p>Character expansion. See &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="boxed.labels_+3A_adj">adj</code></td>
<td>
<p>left/right adjustment. If this is set outside the function,
the box will not be aligned properly.</p>
</td></tr>
<tr><td><code id="boxed.labels_+3A_xlog">xlog</code></td>
<td>
<p>Whether the X axis is a log axis</p>
</td></tr>
<tr><td><code id="boxed.labels_+3A_ylog">ylog</code></td>
<td>
<p>Whether the Y axis is a log axis</p>
</td></tr>
<tr><td><code id="boxed.labels_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The label(s) are displayed on a rectangular background. This may be useful
for visibility and is the reason that &quot;transparent&quot; background is not available.
With the default &lsquo;<span class="samp">&#8288;textcol=NA&#8288;</span>&rsquo;, the function tries to work out whether white
or black text will be more easily read based on the background color and displays
the text accordingly. If the user specifies text colors in the additional
arguments, these colors will override the automatic white/black above - see the
last example.
</p>
<p>Only right angle rotations are allowed in &lsquo;<span class="samp">&#8288;boxed.labels&#8288;</span>&rsquo;. <em>Important
change</em>: &lsquo;<span class="samp">&#8288;xpad&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;ypad&#8288;</span>&rsquo; are now the full proportion of
the box to text, not half. The user can now call &lsquo;<span class="samp">&#8288;cylindrect&#8288;</span>&rsquo; or
&lsquo;<span class="samp">&#8288;gradient.rect&#8288;</span>&rsquo; for the background rectangle.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>This function is best for regularly spaced labels where overlapping is
not a problem. See <a href="#topic+thigmophobe.labels">thigmophobe.labels</a> for placing labels 
where overlap is likely.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon - thanks to Thorn Thaler for the code allowing
user-specified text colors and Flemming Skjoth for the log axis correction</p>


<h3>See Also</h3>

<p><a href="#topic+spread.labels">spread.labels</a>, <a href="#topic+thigmophobe.labels">thigmophobe.labels</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-rnorm(10)
 y&lt;-rnorm(10)
 plot(x,y,type="p")
 nums&lt;-c("one","two","three","four","five","six","seven","eight","nine","ten")
 boxed.labels(x,y-0.1,nums)
 # now label a barplot
 xpos&lt;-barp(c(1,3,2,4))
 boxed.labels(xpos$x,0.5,nums[1:4])
 # and add labels below the x axis ticks
 boxed.labels(xpos$x,-0.4,c("First","Second","Third","Fourth"))
 # perform a PCA on the "swiss" dataset and plot the first two components
 data(swiss)
 swiss.pca&lt;-prcomp(swiss)
 plot(swiss.pca$rotation[,1:2],xlim=c(-1,0.2),main="PCA of swiss dataset",
  type="n")
 boxed.labels(swiss.pca$rotation[1:6],swiss.pca$rotation[7:12],ypad=1.5,
  colnames(swiss),bg=c("red","purple","blue","blue","darkgreen","red"),
  col="yellow")
</code></pre>

<hr>
<h2 id='brkdn.plot'>A point/line plotting routine</h2><span id='topic+brkdn.plot'></span>

<h3>Description</h3>

<p>Display a point/line plot of breakdowns of one or more variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'> brkdn.plot(vars,groups=NULL,obs=NULL,data,mct="mean",md="std.error",
 stagger=NULL,dispbar=TRUE,main="Breakdown plot",xlab=NULL,ylab=NULL,xaxlab=NA,
 ylim=NA,type="b",pch=1,lty=1,col=par("fg"),staxx=FALSE,yat=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brkdn.plot_+3A_vars">vars</code></td>
<td>
<p>The names or indices of one or more columns in a data frame.
The columns must contain numeric data. If only one variable is to be
broken down, vars can be a formula.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_groups">groups</code></td>
<td>
<p>The name or index of a column in a data frame that classifies
the values in &lsquo;<span class="samp">&#8288;vars&#8288;</span>&rsquo; into different, usually fixed effect, levels.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_obs">obs</code></td>
<td>
<p>The name or index of a column in a data frame that classifies
the values in &lsquo;<span class="samp">&#8288;vars&#8288;</span>&rsquo; into different, usually random effect, levels.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_data">data</code></td>
<td>
<p>The data frame.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_mct">mct</code></td>
<td>
<p>The measure of central tendency to calculate for each group.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_md">md</code></td>
<td>
<p>The measure of dispersion to calculate, NA for none.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_stagger">stagger</code></td>
<td>
<p>The amount to offset the successive values at each horizontal
position as a proportion of the width of the plot. The calculated default
is usually adequate. Pass zero for none.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_dispbar">dispbar</code></td>
<td>
<p>Whether to display the measures of dispersion as bars.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_main">main</code></td>
<td>
<p>The title at the top of the plot.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_xlab">xlab</code>, <code id="brkdn.plot_+3A_ylab">ylab</code></td>
<td>
<p>The labels for the X and Y axes respectively. There are
defaults, but they are basic.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_xaxlab">xaxlab</code></td>
<td>
<p>Optional labels for the horizontal axis ticks.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_ylim">ylim</code></td>
<td>
<p>Optional vertical limits for the plot.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_type">type</code></td>
<td>
<p>Whether to plot symbols, lines or both (as in &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;).</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_pch">pch</code></td>
<td>
<p>Symbol(s) to plot.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_lty">lty</code></td>
<td>
<p>Line type(s) to plot.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_col">col</code></td>
<td>
<p>Color(s) for the symbols and lines.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_staxx">staxx</code></td>
<td>
<p>Whether to call <a href="#topic+staxlab">staxlab</a> to display the X axis
labels.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_yat">yat</code></td>
<td>
<p>Optional y axis tick positions.</p>
</td></tr>
<tr><td><code id="brkdn.plot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;brkdn.plot&#8288;</span>&rsquo; displays a plot useful for visualizing the breakdown of a
response measure by two factors, or more than one response measure by either
a factor representing something like levels of treatment (&lsquo;<span class="samp">&#8288;groups&#8288;</span>&rsquo;) or
something like repeated observations (&lsquo;<span class="samp">&#8288;obs&#8288;</span>&rsquo;). For example, if
observations are made at different times on data objects that receive
different treatments, the &lsquo;<span class="samp">&#8288;groups&#8288;</span>&rsquo; factor will display the measures
of central tendency as points/lines with the same color, symbol and line type,
while the &lsquo;<span class="samp">&#8288;obs&#8288;</span>&rsquo; factor will be represented as horizontal positions on the
plot. If &lsquo;<span class="samp">&#8288;obs&#8288;</span>&rsquo; is numeric, its unique values will be used as the 
positions, if not, 1 to the number of unique values. This is a common way of 
representing changes over time intervals for experimental groups.
</p>
<p>If only one numeric variable is to be broken down, &lsquo;<span class="samp">&#8288;vars&#8288;</span>&rsquo; may be a
formula like &lsquo;<span class="samp">&#8288;var~groups+obs&#8288;</span>&rsquo;. The position of the two factors to break
down the variable is fixed - the second term will be interpreted as &quot;groups&quot;
and the third, if present, will be interpreted as &quot;obs&quot;.
</p>


<h3>Value</h3>

<p>A list of two matrices of dimension &lsquo;<span class="samp">&#8288;length(levels(groups))&#8288;</span>&rsquo; by 
&lsquo;<span class="samp">&#8288;length(levels(obs))&#8288;</span>&rsquo;. The first contains the measures of central
tendency calculated and its name is the name of the function passed as
&lsquo;<span class="samp">&#8288;mct&#8288;</span>&rsquo;. The second contains the measures of dispersion and its name
is the name of the function passed as &lsquo;<span class="samp">&#8288;md&#8288;</span>&rsquo;.
</p>
<p>If both &lsquo;<span class="samp">&#8288;groups&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;obs&#8288;</span>&rsquo; are not NULL, the rows of each matrix
will be the &lsquo;<span class="samp">&#8288;groups&#8288;</span>&rsquo; and the columns the &lsquo;<span class="samp">&#8288;obs&#8288;</span>&rsquo;. If &lsquo;<span class="samp">&#8288;obs&#8288;</span>&rsquo;
is NULL, the rows will be the &lsquo;<span class="samp">&#8288;groups&#8288;</span>&rsquo; and the columns the &lsquo;<span class="samp">&#8288;vars&#8288;</span>&rsquo;.
If &lsquo;<span class="samp">&#8288;groups&#8288;</span>&rsquo; is NULL, the rows will be the &lsquo;<span class="samp">&#8288;vars&#8288;</span>&rsquo; and the columns
the &lsquo;<span class="samp">&#8288;obs&#8288;</span>&rsquo;. That is, if &lsquo;<span class="samp">&#8288;vars&#8288;</span>&rsquo; has more than one element, if
&lsquo;<span class="samp">&#8288;obs&#8288;</span>&rsquo; is NULL, the elements of &lsquo;<span class="samp">&#8288;vars&#8288;</span>&rsquo; will be considered to
represent observations, while if &lsquo;<span class="samp">&#8288;groups&#8288;</span>&rsquo; is NULL, they will be
considered to represent groups. At least one of &lsquo;<span class="samp">&#8288;groups&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;obs&#8288;</span>&rsquo;
must be not NULL or there is no point in using &lsquo;<span class="samp">&#8288;brkdn.plot&#8288;</span>&rsquo;.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+dispersion">dispersion</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> test.df&lt;-data.frame(a=rnorm(80)+4,b=rnorm(80)+4,c=rep(LETTERS[1:4],each=20),
  d=rep(rep(letters[1:4],each=4),5))
 # first use the default values
 brkdn.plot("a","c","d",test.df,pch=1:4,col=1:4)
 # now jazz it up a bit using medians and median absolute deviations
 # and some enhancements
 bp&lt;-brkdn.plot(a~c+d,data=test.df,main="Test of the breakdown plot",
  mct="median",md="mad",xlab="Temperature range", ylab="Cognition",
  xaxlab=c("10-15","16-20","21-25","25-30"),pch=1:4,lty=1:4,col=1:4)
 es&lt;-emptyspace(bp)
 legend(es,legend=c("Sydney","Gosford","Karuah","Brisbane"),pch=1:4,
  col=1:4,lty=1:4,xjust=0.5,yjust=0.5)
</code></pre>

<hr>
<h2 id='brkdnNest'>Perform a nested breakdown of numeric values</h2><span id='topic+brkdnNest'></span>

<h3>Description</h3>

<p>Breaks down a numeric or categorical element of a data frame
by one or more categorical elements.</p>


<h3>Usage</h3>

<pre><code class='language-R'> brkdnNest(formula,data,FUN=c("mean","sd","sd","valid.n"),label1="Overall",
  trueval=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brkdnNest_+3A_formula">formula</code></td>
<td>
<p>A formula with a numeric element of a data frame on the left and
one or more categorical elements on the right.</p>
</td></tr>
<tr><td><code id="brkdnNest_+3A_data">data</code></td>
<td>
<p>A data frame containing the elements in &lsquo;<span class="samp">&#8288;formula&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="brkdnNest_+3A_fun">FUN</code></td>
<td>
<p>The functions to be applied to successive breakdowns.</p>
</td></tr>
<tr><td><code id="brkdnNest_+3A_label1">label1</code></td>
<td>
<p>The label to use for the overall value of the first function.</p>
</td></tr>
<tr><td><code id="brkdnNest_+3A_trueval">trueval</code></td>
<td>
<p>The value to use in calculating proportions or sums of a
categorical response variable. See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo; performs a nested breakdown of an element of a data frame
by one or more categorical elements. For each category and optional
subcategories, the variable on the left of the formula is summarized as
specified by the functions named in &lsquo;<span class="samp">&#8288;FUN&#8288;</span>&rsquo;.
</p>
<p>If &lsquo;<span class="samp">&#8288;trueval&#8288;</span>&rsquo; is not NA, brkdnNest will calculate the proportion of
&lsquo;<span class="samp">&#8288;trueval&#8288;</span>&rsquo; values in the response variable out of the total valid
responses. If the function &lsquo;<span class="samp">&#8288;valid.n&#8288;</span>&rsquo; is the first function in 
&lsquo;<span class="samp">&#8288;FUN&#8288;</span>&rsquo;, the counts of the groups and subgroups will be returned.
</p>
<p>Two specialized summary functions are defined within &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo;.
&lsquo;<span class="samp">&#8288;sumbrk&#8288;</span>&rsquo; returns the count of values in a factor equal to &lsquo;<span class="samp">&#8288;trueval&#8288;</span>&rsquo;,
and &lsquo;<span class="samp">&#8288;propbrk&#8288;</span>&rsquo; returns the proportion of values equal to 
&lsquo;<span class="samp">&#8288;trueval&#8288;</span>&rsquo;. Be aware that if a categorical variable is specified on 
the left of the formula, functions which expect numeric data such as 
&lsquo;<span class="samp">&#8288;mean&#8288;</span>&rsquo; should not be included in &lsquo;<span class="samp">&#8288;FUN&#8288;</span>&rsquo;.
</p>
<p>The user should take care when specifying different summary functions.
&lsquo;<span class="samp">&#8288;barNest&#8288;</span>&rsquo; expects a summary measure as the first component of the list
and measures of dispersion as the second and third. If two different measures
of dispersion are passed, the first must calculate the upper and the second
the lower measure.
</p>


<h3>Value</h3>

<p>A list with as many elements as there are functions in &lsquo;<span class="samp">&#8288;FUN&#8288;</span>&rsquo;. It is
probably best to always specify four functions (summary measure, upper
dispersion measure, lower dispersion measure and number of valid observations)
even if this is redundant as in the default.
</p>
<p>This function is similar to &lsquo;<span class="samp">&#8288;brkdn&#8288;</span>&rsquo; in the <span class="pkg">prettyR</span> package, but
is structured to be used with the &lsquo;<span class="samp">&#8288;barNest&#8288;</span>&rsquo; function. It produces one
or more measures for the overall data, then the subsets of the data defined by
the first variable to the right of the tilde, then the subsets defined by
the first and second variable, and so on.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="base.html#topic+by">by</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> brkdntest&lt;-data.frame(Age=rnorm(100,25,10),
  Sex=factor(sample(c("M","F"),100,TRUE)),
  Marital=sample(c("M","X","S","W"),100,TRUE),
  Employ=sample(c("FT","PT","NO"),100,TRUE))
 brkdnNest(formula=Age~Sex+Marital+Employ,data=brkdntest)
 # show the proportion of unemployed with binomial confidence intervals
 brkdnNest(formula=Employ~Sex+Marital,data=brkdntest,
  FUN=c("propbrk","binciWu","binciWl"),trueval="NO")
</code></pre>

<hr>
<h2 id='bumpchart'>Display a &quot;bumps&quot; (sequential ranking) chart</h2><span id='topic+bumpchart'></span>

<h3>Description</h3>

<p>Display a chart with two of more columns of points in order of ascending values
with lines connecting the points in a row.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> bumpchart(y,top.labels=colnames(y),labels=rep(rownames(y),2),rank=TRUE,
  mar=c(2,8,5,8),pch=19,col=par("fg"),lty=1,lwd=1,arrows=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bumpchart_+3A_y">y</code></td>
<td>
<p>A numeric matrix or data frame which may contain NAs.</p>
</td></tr>
<tr><td><code id="bumpchart_+3A_top.labels">top.labels</code></td>
<td>
<p>The strings that will appear at the top of each column of
points on the plot.</p>
</td></tr>
<tr><td><code id="bumpchart_+3A_labels">labels</code></td>
<td>
<p>The strings that will appear next to the outer columns of
points.</p>
</td></tr>
<tr><td><code id="bumpchart_+3A_rank">rank</code></td>
<td>
<p>Whether to rank the values in &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; before plotting.</p>
</td></tr>
<tr><td><code id="bumpchart_+3A_mar">mar</code></td>
<td>
<p>The margins to use for the bumps chart. Alter to your taste.</p>
</td></tr>
<tr><td><code id="bumpchart_+3A_pch">pch</code></td>
<td>
<p>The symbols to use when plotting the points.</p>
</td></tr>
<tr><td><code id="bumpchart_+3A_col">col</code></td>
<td>
<p>The colors to use.</p>
</td></tr>
<tr><td><code id="bumpchart_+3A_lty">lty</code></td>
<td>
<p>The line types to use.</p>
</td></tr>
<tr><td><code id="bumpchart_+3A_lwd">lwd</code></td>
<td>
<p>The line widths to use.</p>
</td></tr>
<tr><td><code id="bumpchart_+3A_arrows">arrows</code></td>
<td>
<p>Whether to join the points with lines (FALSE) or arrows (TRUE).</p>
</td></tr>
<tr><td><code id="bumpchart_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to &lsquo;<span class="samp">&#8288;matplot&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;arrows&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;bumpchart&#8288;</span>&rsquo; calls &lsquo;<span class="samp">&#8288;matplot&#8288;</span>&rsquo; to plot the values in the transposed
&lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; matrix or data frame, joining the points with lines. At the left and
right edges of the plot, the labels identifying each row of points are
displayed. These labels may now be different for each side of the plot,
for example if the values of &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; are to be included. Remember that
due to the transposition of the values for plotting, the labels on the 
right have to precede those on the left - see the second example.
</p>
<p>This type of plot is often used to show the changing positions of
entities over time, like the ranking in surveys in different years. For a
similar, but more flexible plot, see <a href="#topic+ladderplot">ladderplot</a>.
</p>
<p>Because of the way &lsquo;<span class="samp">&#8288;matplot&#8288;</span>&rsquo; plots the values, the order of everything is
reversed. As the typical display of ranks is with rank 1 at the top, the
actual rank positions are used to plot the values.
This places the lowest scores at the bottom of the plot and the highest at
the top.
</p>
<p>Any arguments that are included in &lsquo;<span class="samp">&#8288;...&#8288;</span>&rsquo; will be passed to &lsquo;<span class="samp">&#8288;matplot&#8288;</span>&rsquo;
if the &lsquo;<span class="samp">&#8288;arrows&#8288;</span>&rsquo; argument is FALSE, and to the &lsquo;<span class="samp">&#8288;arrows&#8288;</span>&rsquo; function if
the &lsquo;<span class="samp">&#8288;arrows&#8288;</span>&rsquo; argument is TRUE as in the first example.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+matplot">matplot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # percentage of those over 25 years having completed high school
 # in 10 cities in the USA in 1990 and 2000
 educattn&lt;-matrix(c(90.4,90.3,75.7,78.9,66,71.8,70.5,70.4,68.4,67.9,
  67.2,76.1,68.1,74.7,68.5,72.4,64.3,71.2,73.1,77.8),ncol=2,byrow=TRUE)
 rownames(educattn)&lt;-c("Anchorage AK","Boston MA","Chicago IL",
  "Houston TX","Los Angeles CA","Louisville KY","New Orleans LA",
  "New York NY","Philadelphia PA","Washington DC")
 colnames(educattn)&lt;-c(1990,2000)
 bumpchart(educattn,main="Rank for high school completion by over 25s",
  arrows=TRUE,length=0.2)
 vallab&lt;-c(paste(educattn[,2],rownames(educattn),sep="-"),
  paste(rownames(educattn),educattn[,1],sep="-"))
 # now show the raw percentages and add central ticks
 bumpchart(educattn,rank=FALSE,labels=vallab,
  main="Percentage high school completion by over 25s",
  lty=1:10,lwd=1,col=rainbow(10))
 # margins have been reset, so use
 par(xpd=TRUE)
 boxed.labels(1.5,seq(65,90,by=5),seq(65,90,by=5))
 par(xpd=FALSE)
</code></pre>

<hr>
<h2 id='categoryReshape'>Convert object label/attribute label coding.</h2><span id='topic+categoryReshape'></span>

<h3>Description</h3>

<p>Convert object label/attribute label coding to an object by
attribute data frame.</p>


<h3>Usage</h3>

<pre><code class='language-R'> categoryReshape(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="categoryReshape_+3A_x">x</code></td>
<td>
<p>A matrix or data frame with at least two columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;categoryReshape&#8288;</span>&rsquo; attempts to convert the first two columns of its input
into a data frame in which rows represent objects and columns attributes. For
each object, a value of 1 indicates that the object has that attribute, and a
value of 0 that it does not. In set membership terms, a 1 indicates that the
object is a member of that set and a 0 that it is not.
</p>


<h3>Value</h3>

<p>A data frame (see Details).</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+makeIntersectList">makeIntersectList</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> ns&lt;-sample(1:8,20,TRUE)
 objects&lt;-0
 for(i in 1:length(ns)) objects&lt;-c(objects,rep(i,ns[i]))
 attributes&lt;-"Z"
 for(i in 1:length(ns)) attributes&lt;-c(attributes,sample(LETTERS[1:8],ns[i]))
 setdf&lt;-data.frame(objects[-1],attributes[-1])
 categoryReshape(setdf)
</code></pre>

<hr>
<h2 id='centipede.plot'>Display a centipede plot</h2><span id='topic+centipede.plot'></span>

<h3>Description</h3>

<p>Displays a centipede plot on the current graphics device.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> centipede.plot(segs,mct="mean",lower.limit="std.error",
  upper.limit=lower.limit,left.labels=NULL,right.labels=NULL,sort.segs=TRUE,
  main="",xlab=NA,pch=21,vgrid=NA,hgrid=NA,gridcol="lightgray",mar=NA,col=par("fg"),
  bg="green",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="centipede.plot_+3A_segs">segs</code></td>
<td>
<p>a matrix of midpoints and limits calculated by
<a href="#topic+get.segs">get.segs</a> OR a &lsquo;<span class="samp">&#8288;dstat&#8288;</span>&rsquo; object returned by
&lsquo;<span class="samp">&#8288;brkdn&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_mct">mct</code></td>
<td>
<p>The function to use in calculating the midpoint of each
segment.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_lower.limit">lower.limit</code></td>
<td>
<p>The functions to use in calculating the
lower limits for each subset of the data.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_upper.limit">upper.limit</code></td>
<td>
<p>The functions to use in calculating the
upper limits.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_left.labels">left.labels</code></td>
<td>
<p>The variable or subset labels to place at the left margin of
the plot. Default values are provided.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_right.labels">right.labels</code></td>
<td>
<p>The variable or subset labels to place at the right margin
of the plot.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_sort.segs">sort.segs</code></td>
<td>
<p>Whether to sort the segments in ascending order.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_main">main</code></td>
<td>
<p>Optional title for the plot.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_xlab">xlab</code></td>
<td>
<p>Optional x axis label for the plot. The default NA
displays a text label showing the midpoint and limit functions.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_pch">pch</code></td>
<td>
<p>The symbols to use when plotting midpoints.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_vgrid">vgrid</code></td>
<td>
<p>Optional vertical line(s) to display on the plot. Defaults to
NA (none).</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_hgrid">hgrid</code></td>
<td>
<p>Optional horizontal grid lines to display on the plot. Defaults
to NA (none).</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_gridcol">gridcol</code></td>
<td>
<p>The color for the vgrid and hgrid lines.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_mar">mar</code></td>
<td>
<p>Margin widths for the plot. Defaults to c(4,5,1,4) or 
c(4,5,3,4) if there is a title.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_col">col</code></td>
<td>
<p>The color(s) of the limit lines and borders of the midpoint
markers.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_bg">bg</code></td>
<td>
<p>The color(s) to fill the midpoint markers.</p>
</td></tr>
<tr><td><code id="centipede.plot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;centipede.plot&#8288;</span>&rsquo; displays one or more midpoints and limits as 
filled circles with horizontal error bars. It places labels on the left and
right sides of the plot. If these labels are long, it may be necessary to
pass explicit values to the &lsquo;<span class="samp">&#8288;mar&#8288;</span>&rsquo; argument to leave enough room.
</p>
<p>The &lsquo;<span class="samp">&#8288;vgrid&#8288;</span>&rsquo; argument is usually used to display an average value for
all of the midpoints. If one or more values are passed in this argument,
they will be displayed as vertical lines spanning the plot. The &lsquo;<span class="samp">&#8288;hgrid&#8288;</span>&rsquo;
argument acts like the &lsquo;<span class="samp">&#8288;grid&#8288;</span>&rsquo; function, drawing dashed horizontal lines
across the plot. If &lsquo;<span class="samp">&#8288;hgrid=NULL&#8288;</span>&rsquo;, these lines will be drawn under the
values displayed, which will be 1 to the number of values on the vertical axis.
The user can pass explicit values if desired. With horizontal and optionally
vertical grid lines, the centipede plot is practically equivalent to a dotplot
with error bars.
</p>
<p>Similarly, centipede plots typically have a large number of subsets, and 
it may be necessary to start the graphics device with an aspect ratio that
will prevent crowding of the labels when over 30 segments are displayed.
</p>
<p>The matrix &lsquo;<span class="samp">&#8288;segs&#8288;</span>&rsquo; may be entered manually or read from a file.
The first row specifies midpoints, the second and third rows the lower
and upper limits respectively and the fourth row the number of valid
observations. If there are no values for number of valid observations,
just pass vector of blank strings with the &lsquo;<span class="samp">&#8288;right.labels&#8288;</span>&rsquo; argument.
If a &lsquo;<span class="samp">&#8288;dstat&#8288;</span>&rsquo; object is passed as &lsquo;<span class="samp">&#8288;segs&#8288;</span>&rsquo;, the function will calculate
the lower and upper values according to the relevant arguments. This type of
plot is also known as a caterpillar plot or a league table. 
</p>


<h3>Value</h3>

<p>nil.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+get.segs">get.segs</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> testcp&lt;-list("",40)
 for(i in 1:40) testcp[[i]]&lt;-rnorm(sample(1:8,1)*50)
 segs&lt;-get.segs(testcp)
 centipede.plot(segs,main="Test centipede plot",vgrid=0)
 # now leave out the number of valid observations, pass x labels and no right labels
 centipede.plot(segs[1:3,],main="Test centipede plot",vgrid=0,mar=c(4,5,3,2),
  left.labels=paste("X",1:40,sep=""),right.labels=rep("",40))
</code></pre>

<hr>
<h2 id='clean.args'>Remove inappropriate arguments from an argument list</h2><span id='topic+clean.args'></span><span id='topic+remove.args'></span>

<h3>Description</h3>

<p>Takes a list of arguments and eliminates those that are not
appropriate for passing to a particular function (and hence
would produce an error if passed).
</p>


<h3>Usage</h3>

<pre><code class='language-R'> clean.args(argstr,fn,exclude.repeats=FALSE,exclude.other=NULL,dots.ok=TRUE)
 remove.args(argstr,fn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean.args_+3A_argstr">argstr</code></td>
<td>
<p>a named list of arguments, e.g. from &lsquo;<span class="samp">&#8288;\dots&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="clean.args_+3A_fn">fn</code></td>
<td>
<p>a function</p>
</td></tr>
<tr><td><code id="clean.args_+3A_exclude.repeats">exclude.repeats</code></td>
<td>
<p>(logical) remove repeated arguments?</p>
</td></tr>
<tr><td><code id="clean.args_+3A_exclude.other">exclude.other</code></td>
<td>
<p>a character vector of names of additional arguments to remove</p>
</td></tr>
<tr><td><code id="clean.args_+3A_dots.ok">dots.ok</code></td>
<td>
<p>should &quot;...&quot; be allowed in the argument list?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>&lsquo;<span class="samp">&#8288;clean.args&#8288;</span>&rsquo; returns a list which is a copy of &lsquo;<span class="samp">&#8288;argstr&#8288;</span>&rsquo; with
arguments inappropriate for &lsquo;<span class="samp">&#8288;fn&#8288;</span>&rsquo; removed; &lsquo;<span class="samp">&#8288;remove.args&#8288;</span>&rsquo;
removes the arguments for &lsquo;<span class="samp">&#8288;fn&#8288;</span>&rsquo; from the list.
</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>Examples</h3>

<pre><code class='language-R'> tststr &lt;- list(n=2,mean=0,sd=1,foo=4,bar=6) 
 clean.args(tststr,rnorm)
 try(do.call("rnorm",tststr))
 do.call("rnorm",clean.args(tststr,rnorm))
 remove.args(tststr,rnorm)
 ## add example of combining arg. lists?
</code></pre>

<hr>
<h2 id='clock24.plot'>Plot values on a 24 hour &quot;clockface&quot;</h2><span id='topic+clock24.plot'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;clock24.plot&#8288;</span>&rsquo; displays a plot of radial lines, symbols or a polygon
centered at the midpoint of the plot frame on a 24 hour 'clockface'. 
In contrast to the default behavior of &lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo;, the positions 
are interpreted as beginning at vertical (000) and moving clockwise.
</p>
<p>If &lsquo;<span class="samp">&#8288;add=TRUE&#8288;</span>&rsquo; is passed as one of the additional arguments, the values
will be added to the current plot. If a &lsquo;<span class="samp">&#8288;radial.lim&#8288;</span>&rsquo; argument was
passed on the initial plot, it must be passed again to add values or the
values will be displayed incorrectly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> clock24.plot(lengths,clock.pos,labels=0:23,minutes=FALSE,
  hm2dec=FALSE,label.pos=NULL,rp.type="r",loglen=FALSE,explab=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clock24.plot_+3A_lengths">lengths</code></td>
<td>
<p>numeric data vector. Magnitudes will be represented as
line lengths, or symbol or polygon vertex positions.</p>
</td></tr>
<tr><td><code id="clock24.plot_+3A_clock.pos">clock.pos</code></td>
<td>
<p>numeric vector of positions on the 'clockface'.
These must be in decimal hours and will be rescaled to radians.</p>
</td></tr>
<tr><td><code id="clock24.plot_+3A_labels">labels</code></td>
<td>
<p>Labels to place at the circumference.</p>
</td></tr>
<tr><td><code id="clock24.plot_+3A_minutes">minutes</code></td>
<td>
<p>Whether to add minutes (&quot;.00&quot;) to the labels.</p>
</td></tr>
<tr><td><code id="clock24.plot_+3A_hm2dec">hm2dec</code></td>
<td>
<p>Whether to convert HH:MM clock positions to decimal hours.</p>
</td></tr>
<tr><td><code id="clock24.plot_+3A_label.pos">label.pos</code></td>
<td>
<p>Radial positions of the labels.</p>
</td></tr>
<tr><td><code id="clock24.plot_+3A_rp.type">rp.type</code></td>
<td>
<p>Whether to plot radial lines, symbols or a polygon.</p>
</td></tr>
<tr><td><code id="clock24.plot_+3A_loglen">loglen</code></td>
<td>
<p>Whether to log transform the &lsquo;<span class="samp">&#8288;length&#8288;</span>&rsquo; values. Only base
10 logs are available.</p>
</td></tr>
<tr><td><code id="clock24.plot_+3A_explab">explab</code></td>
<td>
<p>Whether to use the default fixed (FALSE) or exponential (TRUE)
notation for the radial labels.</p>
</td></tr>
<tr><td><code id="clock24.plot_+3A_...">...</code></td>
<td>
<p>additional arguments are passed to &lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo; and
then to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the parameters altered by <a href="#topic+radial.plot">radial.plot</a>.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+polar.plot">polar.plot</a>,<a href="#topic+radial.plot">radial.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> testlen&lt;-rnorm(24)*2+5
 testpos&lt;-0:23+rnorm(24)/4
 clock24.plot(testlen,testpos,main="Test Clock24 (lines)",show.grid=FALSE,
  line.col="green",lwd=3)
 if(dev.interactive()) par(ask=TRUE)
 # now do a 'daylight' plot
 oldpar&lt;-clock24.plot(testlen[7:19],testpos[7:19],
  main="Test Clock24 daytime (symbols)",
  point.col="blue",rp.type="s",lwd=3)
 # reset everything
 par(oldpar)
</code></pre>

<hr>
<h2 id='clplot'>Plot lines with colors determined by values.</h2><span id='topic+clplot'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;clplot&#8288;</span>&rsquo; displays a plot of lines for which the colors are dependent
upon the x and y values. &lsquo;<span class="samp">&#8288;clplot&#8288;</span>&rsquo; is similar to &lsquo;<span class="samp">&#8288;color.scale.lines&#8288;</span>&rsquo;
except that while the latter calculates a color for each unique value,
&lsquo;<span class="samp">&#8288;clplot&#8288;</span>&rsquo; assigns colors to groups of values within the cutpoints defined
by &lsquo;<span class="samp">&#8288;levels&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> clplot(x,y,ylab=deparse(substitute(y)),xlab=deparse(substitute(x)),
  levels=seq(min(y)+(max(y)-min(y))/5,max(y)-(max(y)-min(y))/5,length.out=4),
  cols=c("black","blue","green","orange","red"),lty=1,showcuts=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clplot_+3A_x">x</code>, <code id="clplot_+3A_y">y</code></td>
<td>
<p>numeric data vectors.</p>
</td></tr>
<tr><td><code id="clplot_+3A_ylab">ylab</code>, <code id="clplot_+3A_xlab">xlab</code></td>
<td>
<p>Labels for the X and Y axes.</p>
</td></tr>
<tr><td><code id="clplot_+3A_levels">levels</code></td>
<td>
<p>Cut points to assign colors to the values of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="clplot_+3A_cols">cols</code></td>
<td>
<p>The colors to be assigned.</p>
</td></tr>
<tr><td><code id="clplot_+3A_lty">lty</code></td>
<td>
<p>The line type.</p>
</td></tr>
<tr><td><code id="clplot_+3A_showcuts">showcuts</code></td>
<td>
<p>Whether to show the positions of the cut points.</p>
</td></tr>
<tr><td><code id="clplot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;lines&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Carl Witthoft</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-seq(1,100)
 y&lt;-sin(x/5)+x/20
 clplot(x,y,main="Test of clplot")
</code></pre>

<hr>
<h2 id='cluster.overplot'>Shift overlying points into clusters</h2><span id='topic+cluster.overplot'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;cluster.overplot&#8288;</span>&rsquo; checks for overlying points in the x and y
coordinates passed. Those points that are overlying are moved to form
a small cluster of up to nine points. For large numbers of overlying
points, see <a href="#topic+count.overplot">count.overplot</a> or <a href="#topic+sizeplot">sizeplot</a>.
If you are unsure of the number of overplots in your data, run
&lsquo;<span class="samp">&#8288;count.overplot&#8288;</span>&rsquo; first to see if there are any potential clusters
larger than nine.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> cluster.overplot(x,y,away=NULL,tol=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cluster.overplot_+3A_x">x</code>, <code id="cluster.overplot_+3A_y">y</code></td>
<td>
<p>Numeric data vectors or the first two columns of a matrix
or data frame. Typically the x/y coordinates of points to be plotted.</p>
</td></tr>
<tr><td><code id="cluster.overplot_+3A_away">away</code></td>
<td>
<p>How far to move overlying points in user units. Defaults to
the width of a lower case &quot;o&quot; in the x direction and 5/8 of the
height of a lower case &quot;o&quot; in the y direction. Must have both values.</p>
</td></tr>
<tr><td><code id="cluster.overplot_+3A_tol">tol</code></td>
<td>
<p>The largest distance between points that will be considered
to be overlying. Defaults to 1/2 of the width of a lower case &quot;o&quot; in 
the x direction and 1/2 of the height of a lower case &quot;o&quot; in the y 
direction.</p>
</td></tr>
<tr><td><code id="cluster.overplot_+3A_...">...</code></td>
<td>
<p>additional arguments returned as they are passed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components. For unique x-y pairs the elements will be 
the same as in the original. For overlying points up to eight additional 
points will be generated that will create a cluster of points instead of one.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon - thanks to Markus Elze for the test for a current graphics
device</p>


<h3>See Also</h3>

<p><a href="#topic+count.overplot">count.overplot</a>,<a href="#topic+sizeplot">sizeplot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> xy.mat&lt;-cbind(sample(1:10,200,TRUE),sample(1:10,200,TRUE))
 clusteredpoints&lt;-
  cluster.overplot(xy.mat,col=rep(c("red","green"),each=100),
  away=rep(0.2,2))
 plot(clusteredpoints,col=clusteredpoints$col,
  main="Cluster overplot test")
</code></pre>

<hr>
<h2 id='clustered.dotplots'>Display the frequencies of two categories</h2><span id='topic+clustered.dotplots'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;clustered.dotplots&#8288;</span>&rsquo; displays a contingency table as clusters of
symbols on a plot. It expects &lsquo;<span class="samp">&#8288;xgroup&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;ygroup&#8288;</span>&rsquo; to contain
all or some of the combinations of their unique values. It also expects
&lsquo;<span class="samp">&#8288;freq&#8288;</span>&rsquo; to contain the number of instances of each combination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> clustered.dotplots(xgroup, ygroup, freq, type = "circles",
 main="",xlab="",ylab="",x_las=1,y_las=1,axes=TRUE,size=1,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clustered.dotplots_+3A_xgroup">xgroup</code>, <code id="clustered.dotplots_+3A_ygroup">ygroup</code></td>
<td>
<p>Vectors that specify the two groupings to be
displayed (see Details).</p>
</td></tr>
<tr><td><code id="clustered.dotplots_+3A_freq">freq</code></td>
<td>
<p>The frequencies in the two groupings.</p>
</td></tr>
<tr><td><code id="clustered.dotplots_+3A_type">type</code></td>
<td>
<p>The type of symbols to use as &quot;dots&quot;.</p>
</td></tr>
<tr><td><code id="clustered.dotplots_+3A_main">main</code>, <code id="clustered.dotplots_+3A_xlab">xlab</code>, <code id="clustered.dotplots_+3A_ylab">ylab</code></td>
<td>
<p>As in plot.</p>
</td></tr>
<tr><td><code id="clustered.dotplots_+3A_x_las">x_las</code>, <code id="clustered.dotplots_+3A_y_las">y_las</code></td>
<td>
<p>Orientation of the axis tick labels.</p>
</td></tr>
<tr><td><code id="clustered.dotplots_+3A_axes">axes</code></td>
<td>
<p>Whether to display axes.</p>
</td></tr>
<tr><td><code id="clustered.dotplots_+3A_size">size</code></td>
<td>
<p>Spacing for the clusters.</p>
</td></tr>
<tr><td><code id="clustered.dotplots_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &quot;points&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Darshan Baral</p>


<h3>See Also</h3>

<p><a href="#topic+cluster.overplot">cluster.overplot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> df &lt;- structure(list(set = c("09t0101 TJ", "09t0102 MW", "09t0201 EH", 
 "09t0202 NH", "09t0101 TJ", "09t0102 MW", "09t0201 EH", "09t0202 NH", 
 "09t0101 TJ", "09t0102 MW", "09t0201 EH", "09t0202 NH", "09t0101 TJ", 
 "09t0102 MW", "09t0201 EH", "09t0202 NH", "09t0202 NH"), grade = c("1", 
 "1", "1", "1", "2", "2", "2", "2", "3", "3", "3", "3", "4", "4", 
 "4", "4", "5"), freq = c(7, 8, 2, 3, 11, 4, 11, 3, 3, 8, 3, 8, 
 3, 9, 3, 2, 5)), .Names = c("set", "grade", "freq"), row.names = c(NA, 
 17L), class = "data.frame")
 clustered.dotplots(xgroup = df$set, ygroup = df$grade, freq = df$freq)
 clustered.dotplots(xgroup = df$set, ygroup = df$grade, freq = df$freq,
  col = "gray")
 clustered.dotplots(xgroup = df$set, ygroup = df$grade, freq = df$freq,
  type = "points")
 clustered.dotplots(xgroup = df$set, ygroup = df$grade, freq = df$freq,
  type = "points", pch = 19, col = "red")
 # this will cause an error
 # clustered.dotplots(xgroup = mtcars$cyl, ygroup = mtcars$gear,
 #  freq = mtcars$carb)
 # how to fix it
 cumcars&lt;-by(mtcars$carb,list(mtcars$cyl,mtcars$gear),valid.n)
 mtcars2&lt;-data.frame(cyl=NA,gear=NA,carb=NA)
 rownum&lt;-1
 for(cyl in dimnames(cumcars)[[1]]) {
  for(gear in dimnames(cumcars)[[2]]) {
   if(!is.na(cumcars[cyl,gear])) {
    mtcars2[rownum,]&lt;-c(as.numeric(cyl),as.numeric(gear),cumcars[cyl,gear])
    rownum&lt;-rownum+1
   }
  }
 }
 clustered.dotplots(xgroup = mtcars2$cyl, ygroup = mtcars2$gear,
  freq = mtcars2$carb,main="Cars by number of cylinders and gears",
  xlab="Number of cylinders",ylab="Number of gears",type="points",pch=5)
</code></pre>

<hr>
<h2 id='color.axis'>Display an axis in a specified color</h2><span id='topic+color.axis'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;color.axis&#8288;</span>&rsquo; displays an axis in the specified color.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> color.axis(side=1,at=NULL,labels=TRUE,axlab=NA,axlab.at=NA,
  col=par("fg"),cex.axis=par("cex.axis"),cex=par("cex"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="color.axis_+3A_side">side</code></td>
<td>
<p>Which axis - see axis.</p>
</td></tr>
<tr><td><code id="color.axis_+3A_at">at</code></td>
<td>
<p>Positions for the tick labels.</p>
</td></tr>
<tr><td><code id="color.axis_+3A_labels">labels</code></td>
<td>
<p>Tick labels.</p>
</td></tr>
<tr><td><code id="color.axis_+3A_axlab">axlab</code></td>
<td>
<p>Optional axis label.</p>
</td></tr>
<tr><td><code id="color.axis_+3A_axlab.at">axlab.at</code></td>
<td>
<p>Where to position the axis label - defaults to centered.</p>
</td></tr>
<tr><td><code id="color.axis_+3A_col">col</code></td>
<td>
<p>Color for the axis.</p>
</td></tr>
<tr><td><code id="color.axis_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Character expansion for the tick labels.</p>
</td></tr>
<tr><td><code id="color.axis_+3A_cex">cex</code></td>
<td>
<p>Character expansion for the axis label.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>

<hr>
<h2 id='color.gradient'>Calculate an arbitrary sequence of colors</h2><span id='topic+color.gradient'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;color.gradient&#8288;</span>&rsquo; is now just a call to &lsquo;<span class="samp">&#8288;color.scale&#8288;</span>&rsquo; with a
vector of equally spaced integers (1:nslices). The function is kept for
backward compatibility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> color.gradient(reds,greens,blues,nslices=50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="color.gradient_+3A_reds">reds</code>, <code id="color.gradient_+3A_greens">greens</code>, <code id="color.gradient_+3A_blues">blues</code></td>
<td>
<p>vectors of the values of the color components
as 0 to 1.</p>
</td></tr>
<tr><td><code id="color.gradient_+3A_nslices">nslices</code></td>
<td>
<p>The number of color &quot;slices&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of hexadecimal color values as used by &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo;.</p>


<h3>Note</h3>

<p>The function is mainly useful for defining a set of colors to represent
a known number of gradations. Such a set can be used to assign a grade
to a small number of values (e.g. points on a scatterplot - but see 
&lsquo;<span class="samp">&#8288;color.scale&#8288;</span>&rsquo; for large numbers) and display a color bar using
&lsquo;<span class="samp">&#8288;gradient.rect&#8288;</span>&rsquo; as a legend.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+rescale">rescale</a>,<a href="stats.html#topic+approx">approx</a>,<a href="#topic+color.scale">color.scale</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # try it with red and blue endpoints and green midpoints.
 color.gradient(c(0,1),c(1,0.6,0.4,0.3,0),c(0.1,0.6))
</code></pre>

<hr>
<h2 id='color.id'>Identify closest match to a color</h2><span id='topic+color.id'></span>

<h3>Description</h3>

<p>Given a color specified as a hex string, find the closest match in the
table of known (named) colors
</p>


<h3>Usage</h3>

<pre><code class='language-R'> color.id(col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="color.id_+3A_col">col</code></td>
<td>
<p>a color specified as a hex string</p>
</td></tr>
</table>


<h3>Details</h3>

<p>finds the color with the minimum squared distance in RGB space
</p>


<h3>Value</h3>

<p>the name of the closest match
</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>See Also</h3>

<p><a href="grDevices.html#topic+col2rgb">col2rgb</a>,<a href="grDevices.html#topic+colors">colors</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> color.id("#cc00cc")
</code></pre>

<hr>
<h2 id='color.legend'>Legend matching categories or values to colors</h2><span id='topic+color.legend'></span>

<h3>Description</h3>

<p>Display a color legend on a plot</p>


<h3>Usage</h3>

<pre><code class='language-R'> color.legend(xl,yb,xr,yt,legend,rect.col,cex=1,align="lt",gradient="x",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="color.legend_+3A_xl">xl</code>, <code id="color.legend_+3A_yb">yb</code>, <code id="color.legend_+3A_xr">xr</code>, <code id="color.legend_+3A_yt">yt</code></td>
<td>
<p>The lower left and upper right coordinates of the
rectange of colors in user coordinates.</p>
</td></tr>
<tr><td><code id="color.legend_+3A_legend">legend</code></td>
<td>
<p>The labels that will appear next to some or all of the colors.</p>
</td></tr>
<tr><td><code id="color.legend_+3A_rect.col">rect.col</code></td>
<td>
<p>The colors that will fill the rectangle.</p>
</td></tr>
<tr><td><code id="color.legend_+3A_cex">cex</code></td>
<td>
<p>Character expansion factor for the labels.</p>
</td></tr>
<tr><td><code id="color.legend_+3A_align">align</code></td>
<td>
<p>How to align the labels relative to the color rectangle.</p>
</td></tr>
<tr><td><code id="color.legend_+3A_gradient">gradient</code></td>
<td>
<p>Whether to have a horizontal (x) or vertical (y) color
gradient.</p>
</td></tr>
<tr><td><code id="color.legend_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;color.legend&#8288;</span>&rsquo; displays a rectangle defined by the first four arguments
filled with smaller rectangles of color defined by the &lsquo;<span class="samp">&#8288;rect.col&#8288;</span>&rsquo; argument.
Labels, defined by the &lsquo;<span class="samp">&#8288;legend&#8288;</span>&rsquo; argument, are placed next to the color
rectangle. The position of the labels is determined by whether the color
rectangle is horizontal or vertical and the &lsquo;<span class="samp">&#8288;align&#8288;</span>&rsquo; argument. The default
value of &lsquo;<span class="samp">&#8288;lt&#8288;</span>&rsquo; places the labels at the left of a vertical rectangle or the
top of a horizontal one. &lsquo;<span class="samp">&#8288;rb&#8288;</span>&rsquo; puts them on the other side. To have the
labels in the same color as the rectangles, include a &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; argument that
will be passed to &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo; as in the example.
</p>
<p>There can be fewer labels than colors. The labels will be evenly spaced along
the rectangle in this case. It is possible to use empty labels to get uneven
spacing. The user can pass more labels than colors, but the labels will almost
certainly be crowded and I have only found one use for this. If the user wants
the labels at the intersection of the boxes rather than in the center, see the
alternative specification for the labels in the example (thanks Claudia Tebaldi).
To have complete control over the labels, see <a href="#topic+gradient.rect">gradient.rect</a> and 
<a href="graphics.html#topic+text">text</a> or <a href="graphics.html#topic+mtext">mtext</a>.
</p>
<p>&lsquo;<span class="samp">&#8288;colorlegend&#8288;</span>&rsquo; in the <span class="pkg">shape</span> package offers a different approach,
creating a large number of colors from a color generating function (a bit
like &lsquo;<span class="samp">&#8288;color.gradient&#8288;</span>&rsquo;) and then allowing the user to specify tick
marks at arbitrary points along the color bar.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+color.gradient">color.gradient</a>, <a href="#topic+gradient.rect">gradient.rect</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # get some extra room
 par(mar=c(7,4,4,6))
 testcol&lt;-color.gradient(c(0,1),0,c(1,0),nslices=5)
 col.labels&lt;-c("Cold","Warm","Hot")
 # this will put the labels at the intersections
 # col.labels&lt;-c("","Cold","","Warm","","Warmer","","Hot","")
 color2D.matplot(matrix(rnorm(100),nrow=10),c(1,0),0,c(0,1),
  main="Test color legends")
 color.legend(11,6,11.8,9,col.labels,testcol,gradient="y")
 color.legend(10.2,2,11,5,col.labels,testcol,align="rb",gradient="y")
 color.legend(0.5,-2,3.5,-1.2,col.labels,testcol)
 color.legend(7,-1.8,10,-1,col.labels,testcol,align="rb",col=testcol[c(1,3,5)])
 par(mar=c(5,4,4,2))
</code></pre>

<hr>
<h2 id='color.scale'>Turn values into colors.</h2><span id='topic+color.scale'></span>

<h3>Description</h3>

<p>Transform numeric values into colors using RGB, HSV or HCL</p>


<h3>Usage</h3>

<pre><code class='language-R'> color.scale(x,cs1=c(0,1),cs2=c(0,1),cs3=c(0,1),alpha=1,
  extremes=NA,na.color=NA,xrange=NULL,color.spec="rgb")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="color.scale_+3A_x">x</code></td>
<td>
<p>a numeric vector, matrix or data frame</p>
</td></tr>
<tr><td><code id="color.scale_+3A_cs1">cs1</code>, <code id="color.scale_+3A_cs2">cs2</code>, <code id="color.scale_+3A_cs3">cs3</code></td>
<td>
<p>color parameters for scaling &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="color.scale_+3A_alpha">alpha</code></td>
<td>
<p>Value for transparency in colors. If more than one value is
passed, the alpha values will be transformed like the colors.</p>
</td></tr>
<tr><td><code id="color.scale_+3A_extremes">extremes</code></td>
<td>
<p>The colors for the extreme values of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; (RGB only).</p>
</td></tr>
<tr><td><code id="color.scale_+3A_na.color">na.color</code></td>
<td>
<p>The color to use for NA values of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="color.scale_+3A_xrange">xrange</code></td>
<td>
<p>An explicit range to use in the transformation.</p>
</td></tr>
<tr><td><code id="color.scale_+3A_color.spec">color.spec</code></td>
<td>
<p>The color specification to use in the transformation.
Anything other than &quot;rgb&quot;, &quot;hsv&quot; or &quot;hcl&quot; will almost certainly fail.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;color.scale&#8288;</span>&rsquo; calculates a sequence of colors by a linear
transformation of the numeric values supplied into the ranges 
for the three color parameters. If only one number is supplied for a
color range, that color remains constant for all values of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.
If more than two values are supplied, the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; values will be
split into equal ranges (one less than the number of colors) and 
the transformation carried out on each range. Values for a color
range must be between 0 and 1 for the RGB or HSV specifications, and 
between 0 and 360 (cs1) and 0 to 100 (cs2 and cs3) for the HCL 
specifications.
</p>
<p>IMPORTANT: If &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; has fewer values than the number of values
in the color parameters, it will usually return incorrect
colors. This is usually only a problem when using &lsquo;<span class="samp">&#8288;color.legend&#8288;</span>&rsquo;
with a small number of rectangles in the legend as &lsquo;<span class="samp">&#8288;color.legend&#8288;</span>&rsquo;
calls &lsquo;<span class="samp">&#8288;color.scale&#8288;</span>&rsquo; to calculate the color rectangles.
</p>
<p>If &lsquo;<span class="samp">&#8288;extremes&#8288;</span>&rsquo; is not NA, the ranges will be calculated from
its values using &lsquo;<span class="samp">&#8288;col2rgb&#8288;</span>&rsquo;, even if ranges are also supplied.
&lsquo;<span class="samp">&#8288;extremes&#8288;</span>&rsquo; allows the user to just pass the extreme color values
in any format that &lsquo;<span class="samp">&#8288;col2rgb&#8288;</span>&rsquo; will accept. Note that this forces
the color specification to RGB.
</p>
<p>If the user wants to specify a range of values with &lsquo;<span class="samp">&#8288;xrange&#8288;</span>&rsquo;,
it must at least include the range of x values. This can be useful
when there is a notional range like 0-100% that the values do not
cover, or when several series of values with different ranges are
to be assigned the same color scale.
</p>
<p>The user may not want the color scheme to be continuous across some
critical point, often zero. In this case, &lsquo;<span class="samp">&#8288;color.scale&#8288;</span>&rsquo; can be called
separately for the values below and above zero. I may get around to
adding an argument to do this in one shot. Until then, see the second
example for &lsquo;<span class="samp">&#8288;color2D.matplot&#8288;</span>&rsquo; and also the &lsquo;<span class="samp">&#8288;diverge.hcl&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;diverge.hsv&#8288;</span>&rsquo; functions in the <span class="pkg">colorspace</span> package.
</p>
<p>When passing more than one alpha value, it will be transformed like the 
colors. This allows matrices with concentrations of high values to be 
overplotted to illustrate group locations and separations. See the iris 
example in &lsquo;<span class="samp">&#8288;color2D.matplot&#8288;</span>&rsquo;.
</p>


<h3>Value</h3>

<p>A vector or matrix of hexadecimal color values.</p>


<h3>Note</h3>

<p>The function is useful for highlighting a numeric dimension or adding
an extra &quot;dimension&quot; to a plot.
</p>
<p>There are quite a few R functions that transform numeric values into
colors or produce colors that can be used to represent values. Two
packages that might be of interest are <span class="pkg">RColorBrewer</span> and 
<span class="pkg">colourschemes</span>. See the last example for approximating other color
scales with &lsquo;<span class="samp">&#8288;color.scale&#8288;</span>&rsquo;.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+rescale">rescale</a>, <a href="grDevices.html#topic+col2rgb">col2rgb</a>, <a href="#topic+smoothColors">smoothColors</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # go from green through yellow to red with no blue
 x&lt;-rnorm(20)
 y&lt;-rnorm(20)
 # use y for the color scale
 plot(x,y,col=color.scale(y,c(0,1,1),c(1,1,0),0),main="Color scale plot",
  pch=16,cex=2)
 plot(1:10,rep(1:3,length.out=10),axes=FALSE,type="n",xlim=c(0,11),ylim=c(0,4),
  main="Test of RGB, HSV and HCL",xlab="",ylab="Color specification")
 axis(2,at=1:3,labels=c("HCL","HSV","RGB"))
 points(1:10,rep(1,10),pch=19,cex=8,col=color.scale(1:10,c(0,300),35,85,
  color.spec="hcl"))
 points(1:10,rep(2,10),pch=19,cex=8,col=color.scale(1:10,c(0,1),
  0.8,1,color.spec="hsv"))
 points(1:10,rep(3,10),pch=19,cex=8,col=color.scale(1:10,c(1,0.5,0),
  c(0,0.5,0),c(0,0,1),color.spec="rgb"))
 ## Not run: 
  # requires viridisLite
  library(viridisLite)
  plot(0,xlim=c(-1,1),ylim=c(-1,1),type="n",axes=FALSE,
   main="Approximating other color scales",xlab="",ylab="")
  gradient.rect(-1,0.8,1,0.95,nslices=50,
   col=color.scale(1:50,1,
   c(0,0.3,0.6,0.8,1,1),
   c(0,0,0,0,0,0,1)))
  text(0,1,"color.scale")
  gradient.rect(-1,0.65,1,0.8,col=heat.colors(50))
  text(0,0.6,"heat.colors")
  gradient.rect(-1,0.3,1,0.45,nslices=50,
   col=color.scale(1:50,c(0,0.2,0.9,0.95,0.95),
   c(0.7,0.8,0.9,0.7,0.95),
   c(0.1,0,0,0.35,0.95)))
  text(0,0.5,"color.scale")
  gradient.rect(-1,0.15,1,0.3,col=terrain.colors(50))
  text(0,0.1,"terrain.colors")
  gradient.rect(-1,-0.2,1,-0.05,nslices=50,
   col=color.scale(1:50,c(0.3,0,0.3,0.1,1,0.95,1),
   c(0,0.3,0.9,1,1,0.85,0.85),
   c(1,1,0.9,0.1,0,0.5,0.5)))
  text(0,0,"color.scale")
  gradient.rect(-1,-0.35,1,-0.2,col=topo.colors(50))
  text(0,-0.4,"topo.colors")
  gradient.rect(-1,-0.7,1,-0.55,nslices=50,
   col=color.scale(1:50,c(0.3,0.2,0,0.4,0.95),
   c(0.1,0.3,0.6,0.75,0.95),
   c(0.3,0.6,0.5,0.4,0)))
  text(0,-0.5,"color.scale")
  gradient.rect(-1,-0.85,1,-0.7,col=viridis(50))
  text(0,-0.9,"viridis")
 
## End(Not run)
</code></pre>

<hr>
<h2 id='color.scale.lines'>Line segments with scaled colors</h2><span id='topic+color.scale.lines'></span>

<h3>Description</h3>

<p>Display line segments with colors scaled to numeric values.</p>


<h3>Usage</h3>

<pre><code class='language-R'> color.scale.lines(x,y,reds,greens,blues,col=NA,colvar=NA,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="color.scale.lines_+3A_x">x</code>, <code id="color.scale.lines_+3A_y">y</code></td>
<td>
<p>Numeric vectors or a list with at least two components,
the first two of which must be named x and y.</p>
</td></tr>
<tr><td><code id="color.scale.lines_+3A_reds">reds</code>, <code id="color.scale.lines_+3A_greens">greens</code>, <code id="color.scale.lines_+3A_blues">blues</code></td>
<td>
<p>Color ranges into which to scale the
numeric values.</p>
</td></tr>
<tr><td><code id="color.scale.lines_+3A_col">col</code></td>
<td>
<p>One or more colors to use for the resultant lines. Will
be recycled if necessary.</p>
</td></tr>
<tr><td><code id="color.scale.lines_+3A_colvar">colvar</code></td>
<td>
<p>A numeric vector from which to scale the colors.</p>
</td></tr>
<tr><td><code id="color.scale.lines_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to &lsquo;<span class="samp">&#8288;segments&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;color.scale.lines&#8288;</span>&rsquo; displays line segments that can be individually
colored according to a variety of methods. In order of precedence, if
&lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; is not NA, the color values passed will be used. If
&lsquo;<span class="samp">&#8288;colvar&#8288;</span>&rsquo; is not NA, the function will call &lsquo;<span class="samp">&#8288;color.scale&#8288;</span>&rsquo; with
the three color range arguments to determine the line colors. If
&lsquo;<span class="samp">&#8288;colvar&#8288;</span>&rsquo; is the same length as &lsquo;<span class="samp">&#8288;length(x)-1&#8288;</span>&rsquo;, exactly enough 
colors for the number of lines displayed will be calculated. If shorter,
some colors will be recycled and if longer, some colors will not be used.
Finally, the values in &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; will be color-scaled if both of the above
arguments are NA. Thus the user can pass predetermined colors, use colors
scaled from an arbitrary vector of numerical values or use the &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;
values. See &lsquo;<span class="samp">&#8288;color.scale&#8288;</span>&rsquo; for an explanation of specifying color
ranges.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>The function is useful for highlighting a numeric dimension or adding
an extra &quot;dimension&quot; to a plot.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+color.scale">color.scale</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # color a random walk "hot" (red) to "cold" (blue) on its distance
 # from the starting point
 x&lt;-c(0,cumsum(rnorm(99)))
 y&lt;-c(0,cumsum(rnorm(99)))
 xydist&lt;-sqrt(x*x+y*y)
 plot(x,y,main="Random walk plot",xlab="X",ylab="Y",type="n")
 color.scale.lines(x,y,c(1,1,0),0,c(0,1,1),colvar=xydist,lwd=2)
 boxed.labels(x,y,labels=1:100,border=FALSE,cex=0.5)
 # now color the lines to show whether each step went away from
 # or toward the starting position
 color.scale.lines(x,y,col=2+(diff(xydist)&gt;0))
 boxed.labels(x,y,labels=1:100,border=FALSE,cex=0.5)
</code></pre>

<hr>
<h2 id='color2D.matplot'>Display a numeric matrix as color matrix</h2><span id='topic+color2D.matplot'></span>

<h3>Description</h3>

<p>Display the values of a numeric 2D matrix or data frame as colored
rectangles or hexagons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> color2D.matplot(x,cs1=c(0,1),cs2=c(0,1),cs3=c(0,1),
  extremes=NA,cellcolors=NA,show.legend=FALSE,nslices=10,xlab="Column",
  ylab="Row",do.hex=FALSE,axes=TRUE,show.values=FALSE,vcol=NA,vcex=1,
  border="black",na.color=NA,xrange=NULL,color.spec="rgb",yrev=TRUE,
  xat=NULL,yat=NULL,Hinton=FALSE,add=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="color2D.matplot_+3A_x">x</code></td>
<td>
<p>data values</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_cs1">cs1</code>, <code id="color2D.matplot_+3A_cs2">cs2</code>, <code id="color2D.matplot_+3A_cs3">cs3</code></td>
<td>
<p>the color parameters that will be scaled to represent
the range of numeric values. (see &lsquo;<span class="samp">&#8288;color.scale&#8288;</span>&rsquo;)</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_extremes">extremes</code></td>
<td>
<p>The colors for the extreme values of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;. Takes
precedence over the color ranges.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_cellcolors">cellcolors</code></td>
<td>
<p>A precalculated matrix of cell colors. This must have
the same number of rows and columns as the matrix or it will be
uninformative. It can be a vector, but be careTakes precedence over both &lsquo;<span class="samp">&#8288;extremes&#8288;</span>&rsquo;
and color ranges.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_show.legend">show.legend</code></td>
<td>
<p>whether to display a color legend with the
extreme numeric values in the lower left corner of the plot. This will
force the color specification to &quot;rgb&quot;, so if this is different from
the color specification requested, call &lsquo;<span class="samp">&#8288;color.legend&#8288;</span>&rsquo; separately.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_nslices">nslices</code></td>
<td>
<p>The number of color &quot;slices&quot; in the legend.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_xlab">xlab</code>, <code id="color2D.matplot_+3A_ylab">ylab</code></td>
<td>
<p>axis labels for the plot.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_do.hex">do.hex</code></td>
<td>
<p>plot packed hexagons instead of rectangles.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_axes">axes</code></td>
<td>
<p>Whether to suppress the default axis labelling.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_show.values">show.values</code></td>
<td>
<p>Whether to display the numeric values of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.
This also controls the number of decimal places displayed.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_vcol">vcol</code></td>
<td>
<p>The color for the value display. If NA, the values are displayed
in black or white depending upon the darkness of the cell color.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_vcex">vcex</code></td>
<td>
<p>The character expansion for the value display.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_border">border</code></td>
<td>
<p>The color(s) for the borders of the cells. Pass NA
if no border is  wanted.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_na.color">na.color</code></td>
<td>
<p>The color to use for NA values of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_xrange">xrange</code></td>
<td>
<p>An explicit range for the transformation of colors.
see &lsquo;<span class="samp">&#8288;color.scale&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_color.spec">color.spec</code></td>
<td>
<p>The color specification system to use.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_yrev">yrev</code></td>
<td>
<p>Whether to reverse the order of the y-axis to display the
cells in &quot;reading&quot; order (left to right and top to bottom) if TRUE,
or in the order of a typical plot (left to right and bottom to top) if
FALSE.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_xat">xat</code>, <code id="color2D.matplot_+3A_yat">yat</code></td>
<td>
<p>Values at which to place tick marks to override &lsquo;<span class="samp">&#8288;pretty&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_hinton">Hinton</code></td>
<td>
<p>Whether to display a Hinton diagram in which the magnitude of
cell values is proportional to the size of the squares and the sign is
indicated by the color of the squares.</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_add">add</code></td>
<td>
<p>If TRUE, no plot is created and the rectangles are displayed over
whatever is on the current device (see the &quot;iris&quot; example).</p>
</td></tr>
<tr><td><code id="color2D.matplot_+3A_...">...</code></td>
<td>
<p>arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a plot with the same number of rectangular or hexagonal cells as
there are numeric values in the matrix or data frame. Each rectangle is
colored to represent its corresponding value. The rectangles are arranged
in the conventional display of a 2D matrix with rows beginning at the top
and columns at the left. To get the rows beginning at the bottom, use
&lsquo;<span class="samp">&#8288;yrev=FALSE&#8288;</span>&rsquo;. The color scale defaults to black for the minimum
value and white for the maximum.
</p>
<p>The user will have to adjust the plot device dimensions to get regular
squares or hexagons, especially when the matrix is not square. As the
margins are not equivalent for all display devices, this is currently
a matter of trial and error. Drawing hexagons is quite slow.
</p>
<p>&lsquo;<span class="samp">&#8288;show.values&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;show.legend&#8288;</span>&rsquo; are also used to control the
number of decimal places displayed if the values or legend are shown.
&lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo; will give one decimal place, &lsquo;<span class="samp">&#8288;2&#8288;</span>&rsquo; two, and so on.
</p>
<p>if &lsquo;<span class="samp">&#8288;Hinton&#8288;</span>&rsquo; is TRUE, a Hinton diagram in which the sizes of the
squares are proportional to the absolute value of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and the colors
of the squares indicate the sign of the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; values will be displayed.
This only works with squares.
</p>
<p>If &lsquo;<span class="samp">&#8288;add&#8288;</span>&rsquo; is true, the color matrix is added to the current plot. This
is probably only useful when displaying plots that are mostly transparent.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>The function <a href="Matrix.html#topic+image">image</a> performs almost the same when passed a
matrix of values without grid positions, except that it assigns values to
a specified list of colors rather than calculating a color for each distinct
value.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon (thanks to Ashoka Polpitiya for &lsquo;<span class="samp">&#8288;axes&#8288;</span>&rsquo;)</p>


<h3>See Also</h3>

<p><a href="#topic+color.scale">color.scale</a>, <a href="#topic+fill.corner">fill.corner</a>, <a href="Matrix.html#topic+image">image</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-matrix(rnorm(1024),nrow=32)
 # simulate a correlation matrix with values -0.5 to 0.5
 x&lt;-rescale(x,c(-0.5,0.5))
 # add a column with the extreme values (-1,1) to calculate
 # the colors, then drop the extra column in the result
 cellcol&lt;-color.scale(cbind(x,c(-1,rep(1,31))),c(0,1),0,c(1,0))[,1:32]
 color2D.matplot(x,cellcolors=cellcol,main="Blue to red correlations")
 # do the legend call separately to get the full range
 color.legend(0,-4,10,-3,legend=c(-1,-0.5,0,0.5,1),
  rect.col=color.scale(c(-1,-0.5,0,0.5,1),c(0,1),0,c(1,0)),align="rb")
 x&lt;-matrix(rnorm(100),nrow=10)
 # generate colors that show negative values in red to brown
 # and positive in blue-green to green
 cellcol&lt;-matrix(rep("#000000",100),nrow=10)
 cellcol[x&lt;0]&lt;-color.scale(x[x&lt;0],c(1,0.8),c(0,0.8),0)
 cellcol[x&gt;0]&lt;-color.scale(x[x&gt;0],0,c(0.8,1),c(0.8,0))
 # now do hexagons without borders
 color2D.matplot(x,cellcolors=cellcol,xlab="Columns",ylab="Rows",
  do.hex=TRUE,main="2D matrix plot (hexagons)",border=NA)
 # for this one, we have to do the color legend separately
 # because of the two part color scaling
 legval&lt;-seq(min(x),max(x),length.out=6)
 legcol&lt;-rep("#000000",6)
 legcol[legval&lt;0]&lt;-color.scale(legval[legval&lt;0],c(1,0.8),c(0,0.8),0)
 legcol[legval&gt;0]&lt;-color.scale(legval[legval&gt;0],0,c(0.8,1),c(0.8,0))
 color.legend(0,-1.8,3,-1.4,round(c(min(x),0,max(x)),1),rect.col=legcol)
 # do a color only association plot
 xt&lt;-table(sample(1:10,100,TRUE),sample(1:10,100,TRUE))
 observed&lt;-xt[,rev(1:dim(xt)[2])]
 expected&lt;-outer(rowSums(observed),colSums(observed),"*")/sum(xt)
 deviates&lt;-(observed-expected)/sqrt(expected)
 cellcol&lt;-matrix(rep("#000000",100),nrow=10)
 cellcol[deviates&lt;0]&lt;-
  color.scale(deviates[deviates&lt;0],c(1,0.8),c(0,0.5),0)
 cellcol[deviates&gt;0]&lt;-
  color.scale(deviates[deviates&gt;0],0,c(0.7,0.8),c(0.5,0))
 color2D.matplot(x=round(deviates,2),cellcolors=cellcol,
  show.values=TRUE,main="Association plot")
 # Hinton diagram
 border.col&lt;-color.scale(x,extremes=2:3)
 color2D.matplot(x,extremes=c(2,3),main="Hinton diagram (green +, red -)",
  Hinton=TRUE,border=border.col)
 # waffle plot of percentages with two contributing elements
 waffle.col&lt;-fill.corner(c(rep("red",18),rep("blue",45)),10,10)
 color2D.matplot(matrix(1:100,nrow=10),cellcolors=waffle.col,yrev=FALSE,
  border="lightgray",xlab="",ylab="",main="Waffle plot",axes=FALSE)
 # coarse density plot of the iris petal data
 spnames&lt;-unique(iris$Species)
 spcols&lt;-c("red","green","blue")
 matmax&lt;-list()
 cindx&lt;-1
 for(isp in spnames) {
  petal_mat&lt;-makeDensityMatrix(iris[iris$Species == isp,"Petal.Length"],
   iris[iris$Species == isp,"Petal.Width"],
   nx=20,ny=20,xlim=c(1,7),ylim=c(0,2.5),geocoord=FALSE)
  # center the maximum markers in the cells
  matmax[[cindx]]&lt;-lapply(find_max_cell(petal_mat),"-",0.5)
  if(isp == "setosa")
   color2D.matplot(petal_mat,main="Iris petal length by petal width",
    xlab="Petal length (cm)",ylab="Petal width (cm)",axes=FALSE,
    cellcolors=color.scale(petal_mat,extremes=spcols[cindx],alpha=c(0,1)),
    border=NA,yrev=FALSE)
  else
   color2D.matplot(petal_mat,border=NA,yrev=FALSE,add=TRUE,
   cellcolors=color.scale(petal_mat,extremes=spcols[cindx],alpha=c(0,1)))
  cindx&lt;-cindx+1
 }
 axis(1,at=seq(0,20,by=3.33),labels=1:7)
 axis(2,at=seq(0,20,length.out=4),labels=seq(1,2.5,by=0.5))
 legend(1,6,paste0(spnames,"(",1:3,")"),fill=c("red","green","blue"))
 for(cindx in 1:3)
  text(matmax[[cindx]],as.character(cindx),col="white",cex=1.5)
</code></pre>

<hr>
<h2 id='corner.label'>Find corner locations and optionally display a label</h2><span id='topic+corner.label'></span>

<h3>Description</h3>

<p>Finds the coordinates in user parameters of a specified corner of the
figure region and optionally displays a label there
</p>


<h3>Usage</h3>

<pre><code class='language-R'> corner.label(label=NULL,x=-1,y=1,xoff=NA,yoff=NA,figcorner=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corner.label_+3A_label">label</code></td>
<td>
<p>Text to display. The default is to display nothing.</p>
</td></tr>
<tr><td><code id="corner.label_+3A_x">x</code></td>
<td>
<p>an integer value: -1 for the left side of the plot, 1 for the
right side</p>
</td></tr>
<tr><td><code id="corner.label_+3A_y">y</code></td>
<td>
<p>an integer value: -1 for the bottom side of the plot, 1 for
the top side</p>
</td></tr>
<tr><td><code id="corner.label_+3A_xoff">xoff</code>, <code id="corner.label_+3A_yoff">yoff</code></td>
<td>
<p>Horizontal and vertical text offsets. Defaults to one
half of the width and height of &quot;m&quot; respectively. </p>
</td></tr>
<tr><td><code id="corner.label_+3A_figcorner">figcorner</code></td>
<td>
<p>Whether to find/display at the corner of the plot or figure.</p>
</td></tr>
<tr><td><code id="corner.label_+3A_...">...</code></td>
<td>
<p>further arguments to the &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo; command for the label</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;corner.label&#8288;</span>&rsquo; finds the specified corner of the plot or figure and if
&lsquo;<span class="samp">&#8288;label&#8288;</span>&rsquo; is not NULL, displays it there. The text justification is specified
so that the label will be justified away from the corner. To get the label
squeezed right into a corner, set &lsquo;<span class="samp">&#8288;xoff&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;yoff&#8288;</span>&rsquo; to zero.
</p>


<h3>Value</h3>

<p>A list of the x and y positions of the corner adjusted for the offsets.
</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(1:10,1:10)
 corner.label("A")
 corner.label(x=1,y=1)
 corner.label("B",y=-1,x=1,figcorner=TRUE,col="red")
</code></pre>

<hr>
<h2 id='count.overplot'>Show overlying points as counts</h2><span id='topic+count.overplot'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;count.overplot&#8288;</span>&rsquo; checks for overlying points defined as points
separated by a maximum of &lsquo;<span class="samp">&#8288;tol&#8288;</span>&rsquo;, a two element numeric vector of
the x and y tolerance.  Defaults to 1/2 of the width of a lower case 
&quot;o&quot; in the x direction and 1/2 of the height of a lower case &quot;o&quot; in 
the y direction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> count.overplot(x,y,tol=NULL,col=par("fg"),pch="1",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="count.overplot_+3A_x">x</code>, <code id="count.overplot_+3A_y">y</code></td>
<td>
<p>Two numeric data vectors or the first two columns of a matrix
or data frame. Typically the x/y coordinates of points to be plotted.</p>
</td></tr>
<tr><td><code id="count.overplot_+3A_tol">tol</code></td>
<td>
<p>The largest distance between points that will be considered
to be overlying.</p>
</td></tr>
<tr><td><code id="count.overplot_+3A_col">col</code></td>
<td>
<p>Color(s) for the points (not the numbers).</p>
</td></tr>
<tr><td><code id="count.overplot_+3A_pch">pch</code></td>
<td>
<p>Symbol(s) to display.</p>
</td></tr>
<tr><td><code id="count.overplot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+cluster.overplot">cluster.overplot</a>,<a href="#topic+sizeplot">sizeplot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> xy.mat&lt;-cbind(sample(1:10,200,TRUE),sample(1:10,200,TRUE))
 count.overplot(xy.mat,main="count.overplot",
  xlab="X values",ylab="Y values")
</code></pre>

<hr>
<h2 id='cylindrect'>Display an apparent cylinder</h2><span id='topic+cylindrect'></span>

<h3>Description</h3>

<p>Display rectangles shaded to appear like cylinders.</p>


<h3>Usage</h3>

<pre><code class='language-R'> cylindrect(xleft,ybottom,xright,ytop,col,border=NA,gradient="x",nslices=50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cylindrect_+3A_xleft">xleft</code></td>
<td>
<p>The position of the left side of the rectangle(s).</p>
</td></tr>
<tr><td><code id="cylindrect_+3A_ybottom">ybottom</code></td>
<td>
<p>The position of the bottom of the rectangle(s).</p>
</td></tr>
<tr><td><code id="cylindrect_+3A_xright">xright</code></td>
<td>
<p>The position of the right side of the rectangle(s).</p>
</td></tr>
<tr><td><code id="cylindrect_+3A_ytop">ytop</code></td>
<td>
<p>The position of the top side of the rectangle(s).</p>
</td></tr>
<tr><td><code id="cylindrect_+3A_col">col</code></td>
<td>
<p>The base color(s) of the rectangles.</p>
</td></tr>
<tr><td><code id="cylindrect_+3A_border">border</code></td>
<td>
<p>Whether to draw a border and what color.</p>
</td></tr>
<tr><td><code id="cylindrect_+3A_gradient">gradient</code></td>
<td>
<p>Whether to vary the shading horizontally (&quot;x&quot; - the default)
or vertically (anything but &quot;x&quot;).</p>
</td></tr>
<tr><td><code id="cylindrect_+3A_nslices">nslices</code></td>
<td>
<p>The number of &quot;slices&quot; of color for shading.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;cylindrect&#8288;</span>&rsquo; displays a rectangle filled with &quot;slices&quot; of color that
simulate the appearance of a cylinder. The slices are calculated so that the 
base color appears at the right or bottom edge of the rectangle, becomes
progressively lighter to a &quot;highlight&quot; at two thirds of the width or height
and then darkens toward the base color again.
</p>
<p>The appearance is of a cylinder lit from above and to the left of the viewer.
The position of the apparent light source is hard coded into the function.
</p>


<h3>Value</h3>

<p>The base color(s) of the rectangle(s).</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+gradient.rect">gradient.rect</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(0,xlim=c(0,5),ylim=c(0,5),main="Examples of pseudocylindrical rectangles",
  xlab="",ylab="",axes=FALSE,type="n")
 cylindrect(0,0,1,5,"red")
 cylindrect(rep(1,3),c(0,2,4),rep(4,3),c(1,3,5),"green",gradient="y")
 cylindrect(4,0,5,5,"#8844aa")
</code></pre>

<hr>
<h2 id='death_reg'>Death registrations from 1996 to 2010</h2><span id='topic+death_reg'></span>

<h3>Description</h3>

<p>Death registrations for underlying cause of death as ICD-10 chapters for 1996
to 2010.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(death_reg)
</code></pre>

<hr>
<h2 id='dendroPlot'> Display distributions as dendrites </h2><span id='topic+dendroPlot'></span>

<h3>Description</h3>

<p>Display the distributions of one or more sets of points as branching
(dendritic) clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> dendroPlot(x,breaks=list(10,10,10),pch=1,col=par("fg"),cex=1,nudge=NA,
  setlabels=NA,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dendroPlot_+3A_x">x</code></td>
<td>
<p>A list or data frame of numeric or factor or character
columns.</p>
</td></tr>
<tr><td><code id="dendroPlot_+3A_breaks">breaks</code></td>
<td>
<p>A list of cutpoints to transform numeric values into factors
(see <a href="base.html#topic+cut">cut</a>). Must be at least one number &gt;= 2.</p>
</td></tr>
<tr><td><code id="dendroPlot_+3A_pch">pch</code></td>
<td>
<p>Symbol(s) to use in plotting the values.</p>
</td></tr>
<tr><td><code id="dendroPlot_+3A_col">col</code></td>
<td>
<p>Color(s) for the symbols.</p>
</td></tr>
<tr><td><code id="dendroPlot_+3A_cex">cex</code></td>
<td>
<p>Size of the symbol(s) to use in plotting.</p>
</td></tr>
<tr><td><code id="dendroPlot_+3A_nudge">nudge</code></td>
<td>
<p>The amount to set each consecutive value in a category away from
the center of the dendrite.</p>
</td></tr>
<tr><td><code id="dendroPlot_+3A_setlabels">setlabels</code></td>
<td>
<p>Labels to place along the abcissa to identify the sets.</p>
</td></tr>
<tr><td><code id="dendroPlot_+3A_...">...</code></td>
<td>
<p>Other arguments passed to plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;dendroPlot&#8288;</span>&rsquo; displays the distributions of categorical values as stacks
of &quot;branches&quot;. The lengths of the branches show the number of values in each
category, rather like the opposed bars in a pyramid plot, except that there
is no separation of groups. The distribution of numeric values can also be
displayed by passing a set of breakpoints to categorize the values. The
breakpoints will usually be equidistant, but unevenly spaced breakpoints can
be passed. If an element of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; is numeric, the values of the
corresponding &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; element will be used to place the points, but the
branches will be defined as the categories formed by applying the breaks to
those numeric values.
</p>
<p>Note that in the first example, the breakpoints for the first and third elements
are used to define the ten branches for each. The second element of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;
is already categorical, so the breakpoints are ignored. When comparing 
distributions with very different ranges it may be necessary to adjust the
breakpoints to get a satisfactory result.
</p>
<p>Each successive point in a category is &lsquo;<span class="samp">&#8288;nudge&#8288;</span>&rsquo;d away from the center
of the dendrite. If &lsquo;<span class="samp">&#8288;nudge&#8288;</span>&rsquo; has more than one value, the points will be
nudged up and down for categorical variables to enable closer packing. The
second value of &lsquo;<span class="samp">&#8288;nudge&#8288;</span>&rsquo; is ignored for numeric variables. The aspect
ratio of the plot, the character expansion and the nudging will have to be
adjusted to give the best point spacing for most dendroPlots.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>The &lsquo;<span class="samp">&#8288;ehplot&#8288;</span>&rsquo; function is a much more versatile instantiation of this
type of plot. &lsquo;<span class="samp">&#8288;dendroPlot&#8288;</span>&rsquo; has been retained as there are currently a few
differences that some users may find valuable. However, it is not impossible
that &lsquo;<span class="samp">&#8288;dendroPlot&#8288;</span>&rsquo; will disappear in the future. Another very useful version
of this type of plot is &lsquo;<span class="samp">&#8288;beeswarm&#8288;</span>&rsquo; in the <span class="pkg">beeswarm</span> package.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+ehplot">ehplot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-list(runif(90,1,3),factor(sample(LETTERS[1:10],100,TRUE)),rnorm(80,mean=5))
 dendroPlot(x,xlab="Groups",ylab="Value of x",main="Test dendroPlot I")
 # now apply a nudge factor and different breaks
 dendroPlot(x,breaks=list(8,10,10),nudge=c(0.05,0.1),
  xlab="Groups",ylab="Value of x",main="Test dendroPlot II")
</code></pre>

<hr>
<h2 id='densityGrid'>Display a matrix of cell values as symbols.</h2><span id='topic+densityGrid'></span>

<h3>Description</h3>

<p>Displays a matrix of values as symbols on an existing image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> densityGrid(x,z=NULL,xrange=NA,zrange=NA,range.cex=c(1,10),
 xlim=c(-180,180),ylim=c(-90,90),red=c(0,1),green=c(0,1),blue=c(0,1),alpha=1,
 pch=".",geocoord=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="densityGrid_+3A_x">x</code></td>
<td>
<p>Matrix of values representing counts in cells (usually locations).</p>
</td></tr>
<tr><td><code id="densityGrid_+3A_z">z</code></td>
<td>
<p>Optional matrix of values attached to the cells in x.</p>
</td></tr>
<tr><td><code id="densityGrid_+3A_xrange">xrange</code>, <code id="densityGrid_+3A_zrange">zrange</code></td>
<td>
<p>Explicit ranges for the counts in x and z. Used to
define a &quot;pretty&quot; set of values to label legends.</p>
</td></tr>
<tr><td><code id="densityGrid_+3A_range.cex">range.cex</code></td>
<td>
<p>The range of expansion for the symbols when this is used to
indicate the number of counts in the cells.</p>
</td></tr>
<tr><td><code id="densityGrid_+3A_xlim">xlim</code></td>
<td>
<p>The extreme coordinates in the horizontal direction (see Details).</p>
</td></tr>
<tr><td><code id="densityGrid_+3A_ylim">ylim</code></td>
<td>
<p>The extreme coordinates in the vertical direction (see Details).</p>
</td></tr>
<tr><td><code id="densityGrid_+3A_red">red</code>, <code id="densityGrid_+3A_green">green</code>, <code id="densityGrid_+3A_blue">blue</code></td>
<td>
<p>Values in an RGB colorspace to use in transforming the
cell values into colors.</p>
</td></tr>
<tr><td><code id="densityGrid_+3A_alpha">alpha</code></td>
<td>
<p>Transparency of the colors.</p>
</td></tr>
<tr><td><code id="densityGrid_+3A_pch">pch</code></td>
<td>
<p>The symbol to use in displaying the observation density. Either
&quot;.&quot; or 15 seem to work well depending upon the resolution of the grid.</p>
</td></tr>
<tr><td><code id="densityGrid_+3A_geocoord">geocoord</code></td>
<td>
<p>Whether the size of the symbols that indicate density when
there are intensity values should be corrected for a Mercator projection.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;densityGrid&#8288;</span>&rsquo; expects one matrix or a list of two matrices containing
values that will be transformed into colors or sizes of the symbols displayed.
The two matrices may be passed as a list. If only one matrix is present, the 
color of the symbols is determined by the values (counts) in the matrix. If
a second matrix is passed, The values in that matrix will be used to determine 
the colors, and the size of the symbols will be proportional to the values in
the first matrix. In the case of only one matrix, the user should set the 
first value of &lsquo;<span class="samp">&#8288;range.cex&#8288;</span>&rsquo; to the desired expansion of the symbols.
</p>
<p>Currently &lsquo;<span class="samp">&#8288;densityGrid&#8288;</span>&rsquo; does not display anything in grid cells that have
zero count values.
</p>
<p>&lsquo;<span class="samp">&#8288;densityGrid&#8288;</span>&rsquo; was developed to allow very large numbers of coordinate 
locations to be accumulated in a matrix for display on a geographic map. Thus
the default limits refer to coordinates as latitude/longitude for the earth.
Because some geographic data are so numerous that memory limits are exceeded,
the underlying &lsquo;<span class="samp">&#8288;makeDensityMatrix&#8288;</span>&rsquo; function can be run on small sections
of the entire data set and the resulting matrices added as long as the initial
coordinate limits are used throughout. Note that if the values for counts
(with one matrix) or for intensity (with two matrices) cover a very large 
range, it may be necessary to trim extreme values (noting this on any legends)
and transform the data (usually log10) to get good color separation.
</p>


<h3>Value</h3>

<p>nil. Displays a grid of symbols on an existing plot device.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+makeDensityMatrix">makeDensityMatrix</a>,<a href="#topic+color.scale">color.scale</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
  data(l2010)
  # log10 transform both density and intensity
  l2010[[1]]&lt;-log10(l2010[[1]])
  l2010[[2]]&lt;-log10(l2010[[2]])
  library(maps)
  x11(width=10)
  par(mar=c(7,3,2,3))
  plot(0,xlim=c(-180,180),ylim=c(-90,90),type="n",axes=FALSE,xlab="",ylab="")
  densityGrid(l2010,pch=".",xrange=c(0,6),zrange=c(2,8),range.cex=c(2,8),
   red=c(0,0.5,1),green=c(0,1,0),blue=c(1,0,0),alpha=1)
  color.legend(-60,-107,60,-97,c("2","3","4","5","6","7","8"),
   rect.col=color.scale(1:7,cs1=c(0,0.5,1),cs2=c(0,1,0),cs3=c(1,0,0),alpha=1),
   cex=0.5)
  par(xpd=TRUE)
  text(0,95,"Lightning strikes 2010")
  text(0,-114,"Mean intensity kVA (10^n)",cex=0.5)
  points(x=seq(-60,60,20),y=rep(-125,7),pch=".",cex=1:7)
  text(x=seq(-60,60,20),y=rep(-132,7),c("&lt;=1","2","3","4","5","6","&gt;6"),cex=0.5)
  text(0,-142,"Cell frequency (10^n)",cex=0.5)
  par(xpd=FALSE)
  map("world",mar=c(7,3,2,3),add=TRUE)
  dev.off()
  # now only Australia
  par(mar=c(7,3,2,3))
  plot(0,xlim=c(112,154),ylim=c(-43.8,-11.1),type="n",axes=FALSE,xlab="",ylab="")
  densityGrid(l2010,pch=".",xrange=c(0,6),zrange=c(2,8),range.cex=c(2,8),
   xlim=c(112,154),ylim=c(-43.8,-11.1),red=c(0,0.5,1),green=c(0,1,0),
   blue=c(1,0,0),alpha=1)
  color.legend(120,-47,146,-45,c("2","3","4","5","6","7","8"),
   rect.col=color.scale(1:7,cs1=c(0,0.5,1),cs2=c(0,1,0),cs3=c(1,0,0),alpha=1),
   cex=0.5)
  par(xpd=TRUE)
  text(133,-9,"Lightning strikes 2010 (Australia)")
  text(133,-48.2,"Mean intensity kVA (10^n)",cex=0.5)
  points(x=seq(121,145,4),y=rep(-50,7),pch=".",cex=1:7)
  text(x=seq(121,145,4),y=rep(-51,7),c("&lt;=1","2","3","4","5","6","&gt;6"),cex=0.5)
  text(133,-52,"Cell frequency (10^n)",cex=0.5)
  par(xpd=FALSE)
  map("world",mar=c(7,3,2,3),xlim=c(112,154),ylim=c(-43.8,-11.1),add=TRUE)
 
## End(Not run)
</code></pre>

<hr>
<h2 id='diamondplot'>Plot multiple variables as polygons on a radial grid</h2><span id='topic+diamondplot'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;diamondplot&#8288;</span>&rsquo; displays a plot of polygons on a radial grid representing
the relationships between one or more attributes of data objects. For a slightly
different style of plot, see the &quot;spiderweb plot&quot; example in &lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> diamondplot(x, bg=gray(0.6), col=rainbow,name="", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diamondplot_+3A_x">x</code></td>
<td>
<p>A data frame containing numeric values that represent attributes
(possibly repeated observations) of data objects. See the example.</p>
</td></tr>
<tr><td><code id="diamondplot_+3A_bg">bg</code></td>
<td>
<p>The background color for the plot.</p>
</td></tr>
<tr><td><code id="diamondplot_+3A_col">col</code></td>
<td>
<p>The colors for the polygons.</p>
</td></tr>
<tr><td><code id="diamondplot_+3A_name">name</code></td>
<td>
<p>The title for the plot (i.e. &lsquo;<span class="samp">&#8288;main&#8288;</span>&rsquo;).</p>
</td></tr>
<tr><td><code id="diamondplot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Elisa Biancotto</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a>, <a href="#topic+radial.plot">radial.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> data(mtcars)
 mysubset&lt;-mtcars[substr(dimnames(mtcars)[[1]],1,1)=="M",c("mpg","hp","wt","disp")]
 diamondplot(mysubset)
</code></pre>

<hr>
<h2 id='dispersion'> Display a measure of dispersion. </h2><span id='topic+dispersion'></span><span id='topic+dispbars'></span>

<h3>Description</h3>

<p>Display lines or capped bars at specified points on a plot representing
measures of dispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> dispersion(x,y,ulim,llim=ulim,intervals=TRUE,arrow.cap=0.01,arrow.gap=NA,
  type="a",fill=NA,lty=NA,pch=NA,border=NA,col=par("fg"),display.na=TRUE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dispersion_+3A_x">x</code>, <code id="dispersion_+3A_y">y</code></td>
<td>
<p>x and y position of the centers of the bars</p>
</td></tr>
<tr><td><code id="dispersion_+3A_ulim">ulim</code>, <code id="dispersion_+3A_llim">llim</code></td>
<td>
<p>The extent of the dispersion measures.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_arrow.cap">arrow.cap</code></td>
<td>
<p>The width of the cap at the outer end of each bar
as a proportion of the width of the plot.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_arrow.gap">arrow.gap</code></td>
<td>
<p>The gap to leave at the inner end of each bar.
Defaults to two thirds of the height of a capital &quot;O&quot;.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_intervals">intervals</code></td>
<td>
<p>Whether the limits are intervals (TRUE) or absolute values
(FALSE).</p>
</td></tr>
<tr><td><code id="dispersion_+3A_type">type</code></td>
<td>
<p>What type of display to use.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_fill">fill</code></td>
<td>
<p>Color to fill between the lines if &lsquo;<span class="samp">&#8288;type&#8288;</span>&rsquo; is not NULL and
&lsquo;<span class="samp">&#8288;fill&#8288;</span>&rsquo; is not NA.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_lty">lty</code></td>
<td>
<p>Line type for redrawing the lines if necessary.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_pch">pch</code></td>
<td>
<p>Symbol for redrawing the points if necessary.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_border">border</code></td>
<td>
<p>Line type for drawing a border on the confidence band.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_col">col</code></td>
<td>
<p>Color for the lines or capped bars.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_display.na">display.na</code></td>
<td>
<p>Whether to display NA values as lines going off the plot.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;arrows&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;lines&#8288;</span>&rsquo;
depending upon &lsquo;<span class="samp">&#8288;type&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;dispersion&#8288;</span>&rsquo; displays a measure of dispersion on an existing plot.
Currently it will display either vertical lines with caps (error bars) or lines
that form a &quot;confidence band&quot; around a line of central tendency. If &lsquo;<span class="samp">&#8288;fill&#8288;</span>&rsquo;
is not NA and &lsquo;<span class="samp">&#8288;type&#8288;</span>&rsquo; is &lsquo;<span class="samp">&#8288;"l"&#8288;</span>&rsquo;, a polygon will be drawn between the
confidence lines. Remember that any points or lines within the confidence band
will be obscured, so pass point and/or line types as in the second example.
</p>
<p>The default behavior is to display an undefined dispersion (e.g. a variance with
only one observation) as a line going off the plot. If &lsquo;<span class="samp">&#8288;display.na&#8288;</span>&rsquo; is FALSE,
NA values will not be displayed, allowing the user to show only upper or lower
dispersion limits.
</p>
<p>The &lsquo;<span class="samp">&#8288;intervals&#8288;</span>&rsquo; argument allows the user to pass the limits as either
intervals (the default) or absolute values.
</p>
<p>If &lsquo;<span class="samp">&#8288;arrow.gap&#8288;</span>&rsquo; is greater than or equal to the upper or lower
limit for a bar, &lsquo;<span class="samp">&#8288;segments&#8288;</span>&rsquo; is used to draw the upper and
lower caps with no bars to avoid zero length arrows.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+arrows">arrows</a>, <a href="graphics.html#topic+segments">segments</a>,<a href="graphics.html#topic+lines">lines</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> disptest&lt;-matrix(rnorm(200),nrow=20)
 disptest.means&lt;-rowMeans(disptest)
 row.order&lt;-order(disptest.means)
 se.disptest&lt;-unlist(apply(disptest,1,std.error))
 plot(disptest.means[row.order],main="Dispersion as error bars",
  ylim=c(min(disptest.means-se.disptest),max(disptest.means+se.disptest)),
  xlab="Occasion",ylab="Value")
 dispersion(1:20,disptest.means[row.order],se.disptest[row.order])
 plot(disptest.means[row.order],main="Dispersion as confidence band",
  ylim=c(min(disptest.means-se.disptest),max(disptest.means+se.disptest)),
  xlab="Occasion",ylab="Value")
 dispersion(1:20,disptest.means[row.order],se.disptest[row.order],type="l",
  fill="#eeccee",lty=2,pch=1)
 disptest2&lt;-matrix(sample(c(TRUE,FALSE),200,TRUE),nrow=10)
 disptest.prop&lt;-rowMeans(disptest2)
 disptest.ulim&lt;-disptest.llim&lt;-rep(NA,10)
 for(i in 1:10) {
  disptest.ulim[i]&lt;-binciWu(disptest2[i,],20)
  disptest.llim[i]&lt;-binciWl(disptest2[i,],20)
 }
 plot(disptest.prop,main="Dispersion as binomial confidence intervals",
  ylim=c(min(disptest.llim),max(disptest.ulim)),
  xlab="Sample",ylab="Proportion")
 dispersion(1:10,disptest.prop,disptest.ulim,disptest.llim,
  interval=FALSE,lty=2,pch=1)
</code></pre>

<hr>
<h2 id='do.first'> Execute a graphic function on a plot </h2><span id='topic+do.first'></span>

<h3>Description</h3>

<p> do.first allows the user to execute one or more commands before
displaying values on a plot. </p>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;do.first&#8288;</span>&rsquo; is an argument in some plotrix functions that allows the user
to do things like add a background color or a grid to the plot before
displaying the other plot elements.
</p>
<p>The value of &lsquo;<span class="samp">&#8288;do.first&#8288;</span>&rsquo; should be a character string that can be parsed
to one or more valid R commands. Remember to enclose the string in quotes,
separate commands with semicolons and escape quotes within the string with
backslashes if necessary.
</p>

<hr>
<h2 id='dotplot.mtb'> Minitab style dotplots. </h2><span id='topic+dotplot.mtb'></span>

<h3>Description</h3>

<p>Create a dotplot of a data vector in the sense of &quot;dotplot&quot; as
used in the Minitab<code class="reqn">\mbox{\copyright}</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dotplot.mtb(x, xlim = NULL, main = NULL, xlab = NULL, ylab = NULL,
            pch = 19, hist = FALSE, yaxis = FALSE, mtbstyle=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dotplot.mtb_+3A_x">x</code></td>
<td>
<p> A numeric vector. </p>
</td></tr>
<tr><td><code id="dotplot.mtb_+3A_xlim">xlim</code></td>
<td>
<p> The x limits of the plot. </p>
</td></tr>
<tr><td><code id="dotplot.mtb_+3A_main">main</code></td>
<td>
<p> A title for the plot; defaults to blank.</p>
</td></tr>
<tr><td><code id="dotplot.mtb_+3A_xlab">xlab</code></td>
<td>
<p> A label for the x axis; defaults to blank.</p>
</td></tr>
<tr><td><code id="dotplot.mtb_+3A_ylab">ylab</code></td>
<td>
<p> A label for the y axis; defaults to blank.</p>
</td></tr>
<tr><td><code id="dotplot.mtb_+3A_pch">pch</code></td>
<td>
<p> The plotting symbol for the dots in the plot;
defaults to a solid disc. </p>
</td></tr>
<tr><td><code id="dotplot.mtb_+3A_hist">hist</code></td>
<td>
<p> Logical scalar; should the plot be done &quot;histogram&quot;
style, i.e. using vertical lines rather than stacks
of dots?</p>
</td></tr>
<tr><td><code id="dotplot.mtb_+3A_yaxis">yaxis</code></td>
<td>
<p> Logical scalar; should a y-axis be produced? </p>
</td></tr>
<tr><td><code id="dotplot.mtb_+3A_mtbstyle">mtbstyle</code></td>
<td>
<p> Logical scalar; should the dotplot be done in
the &quot;Minitab&quot; style?  I.e. should the zero level
be at the vertical midway point? </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The result of <code>hist=TRUE</code> looks less ugly than stacks of
dots for very large data sets.
</p>


<h3>Value</h3>

<p>Nothing.  A plot is produced as a side effect.
</p>


<h3>Warnings</h3>

<p>This function does something toadally different from the <code>dotplot()</code>
(now <code><a href="graphics.html#topic+dotchart">dotchart</a>()</code>) function in the graphics package.
</p>
<p>The labelling of the <code>y</code>-axis is device dependent.
</p>


<h3>Author(s)</h3>

<p> Barry Rowlingson
<a href="mailto:B.Rowlingson@lancaster.ac.uk">B.Rowlingson@lancaster.ac.uk</a>
and Rolf Turner
<a href="mailto:r.turner@auckland.ac.nz">r.turner@auckland.ac.nz</a>
<a href="http://www.stat.auckland.ac.nz/~rolf">http://www.stat.auckland.ac.nz/~rolf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(42)
x &lt;- rpois(100,10)
dotplot.mtb(x,main="No y-axis.")
dotplot.mtb(x,yaxis=TRUE,main="With y-axis displayed.")
dotplot.mtb(x,hist=TRUE,main="An \"h\" style plot.")
dotplot.mtb(x,xlim=c(4,16),main="With the x-axis limited.")
dotplot.mtb(x,yaxis=TRUE,mtbstyle=FALSE,main="Non-Minitab style.")
dotplot.mtb(x,yaxis=TRUE,xlab="x",ylab="count",
            main="With x and y axis labels.")

## End(Not run)
</code></pre>

<hr>
<h2 id='draw.arc'> Draw arc </h2><span id='topic+draw.arc'></span>

<h3>Description</h3>

<p>Draw one or more arcs using classic graphics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> draw.arc(x=1,y=NULL,radius=1,angle1=deg1*pi/180,angle2=deg2*pi/180, 
  deg1=0,deg2=45,n=0.05,col=NA,lwd=NA,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.arc_+3A_x">x</code></td>
<td>
<p> x coordinate of center.  Scalar or vector. </p>
</td></tr>
<tr><td><code id="draw.arc_+3A_y">y</code></td>
<td>
<p> y coordinate of center.  Scalar or vector. </p>
</td></tr>
<tr><td><code id="draw.arc_+3A_radius">radius</code></td>
<td>
<p> radius.  Scalar or vector.  </p>
</td></tr>
<tr><td><code id="draw.arc_+3A_angle1">angle1</code></td>
<td>
<p> Starting angle in radians. Scalar or vector. </p>
</td></tr>
<tr><td><code id="draw.arc_+3A_angle2">angle2</code></td>
<td>
<p> Ending angle in radians. Scalar or vector. </p>
</td></tr>
<tr><td><code id="draw.arc_+3A_deg1">deg1</code></td>
<td>
<p> Starting angle in degrees. Scalar or vector. </p>
</td></tr>
<tr><td><code id="draw.arc_+3A_deg2">deg2</code></td>
<td>
<p> Ending angle in degrees. Scalar or vector. </p>
</td></tr>
<tr><td><code id="draw.arc_+3A_n">n</code></td>
<td>
<p> Number of polygons to use to approximate the arc. </p>
</td></tr>
<tr><td><code id="draw.arc_+3A_col">col</code></td>
<td>
<p> Arc colors. </p>
</td></tr>
<tr><td><code id="draw.arc_+3A_lwd">lwd</code></td>
<td>
<p>Line width for the arc.</p>
</td></tr>
<tr><td><code id="draw.arc_+3A_...">...</code></td>
<td>
<p> Other arguments passed to segments.  Vectorization 
is not supported for these. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Draws one or more arcs from <code>angle1</code> to <code>angle2</code>.
If <code>angle1</code> is numerically greater than <code>angle2</code>,
then the angles are swapped.
</p>
<p>Be sure to use an aspect ratio of 1 as shown in
the example to avoid distortion.  For argument 'n' (which may be
either a scalar or a vector, although most likely you will leave
it at the default value), an integer value means to use that number
of segments to approximate the arc, while a non-integer value means
to use enough segments so that the angle that successive segments
make with one another is no more than n radians.
</p>


<h3>Value</h3>

<p>Returns a matrix of expanded arguments invisibly.
</p>


<h3>Author(s)</h3>

<p>Gabor Grothendieck. Improvements by Ted Toal.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
   plot(1:10, asp = 1,main="Test draw.arc")
   draw.arc(5, 5, 1:10/10, deg2 = 1:10*10, col = "blue")
   draw.arc(8, 8, 1:10/10, deg2 = 1:10*10, col = 1:10)
   draw.arc(5, 5, 3, deg1=100, deg2=170, col="gold", lwd=50, lend=1)
   # example taken from post by Hans Borcher:
   # https://stat.ethz.ch/pipermail/r-help/2009-July/205728.html
   # Note setting of aspect ratio to 1 first.
   curve(sin(x), 0, pi, col="blue", asp=1)
   draw.arc(pi/2, 0, 1, deg1=45, deg2=135, col="red")

</code></pre>

<hr>
<h2 id='draw.circle'>Draw a circle</h2><span id='topic+draw.circle'></span>

<h3>Description</h3>

<p>Draws a circle on an existing plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'> draw.circle(x,y,radius,nv=100,border=NULL,col=NA,lty=1,density=NULL,
  angle=45,lwd=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.circle_+3A_x">x</code>, <code id="draw.circle_+3A_y">y</code></td>
<td>
<p>Coordinates of the center of the circle.</p>
</td></tr>
<tr><td><code id="draw.circle_+3A_radius">radius</code></td>
<td>
<p>Radius (or radii) of the circle(s) in user units.</p>
</td></tr>
<tr><td><code id="draw.circle_+3A_nv">nv</code></td>
<td>
<p>Number of vertices to draw the circle.</p>
</td></tr>
<tr><td><code id="draw.circle_+3A_border">border</code></td>
<td>
<p>Color to use for drawing the circumference.</p>
</td></tr>
<tr><td><code id="draw.circle_+3A_col">col</code></td>
<td>
<p>Color to use for filling the circle.</p>
</td></tr>
<tr><td><code id="draw.circle_+3A_lty">lty</code></td>
<td>
<p>Line type for the circumference.</p>
</td></tr>
<tr><td><code id="draw.circle_+3A_density">density</code></td>
<td>
<p>Density for patterned fill. See &lsquo;<span class="samp">&#8288;polygon&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="draw.circle_+3A_angle">angle</code></td>
<td>
<p>Angle of patterned fill. See &lsquo;<span class="samp">&#8288;polygon&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="draw.circle_+3A_lwd">lwd</code></td>
<td>
<p>Line width for the circumference.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;draw.circle&#8288;</span>&rsquo; uses the dimensions of the plot and the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; coordinates to draw a circle rather than an ellipse.
</p>


<h3>Value</h3>

<p>A list with the x and y coordinates of the points on the circumference
of the last circle displayed.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon, thanks to David Winsemius for the density and angle args</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+polygon">polygon</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(1:5,seq(1,10,length=5),type="n",xlab="",ylab="",main="Test draw.circle")
 draw.circle(2,4,c(1,0.66,0.33),border="purple",
  col=c("#ff00ff","#ff77ff","#ffccff"),lty=1,lwd=1)
 draw.circle(2.5,8,0.6,border="red",lty=3,lwd=3)
 draw.circle(4,3,0.7,border="green",col="yellow",lty=1,
  density=5,angle=30,lwd=10)
 draw.circle(3.5,8,0.8,border="blue",lty=2,lwd=2)
</code></pre>

<hr>
<h2 id='draw.ellipse'>Draw ellipse</h2><span id='topic+draw.ellipse'></span>

<h3>Description</h3>

<p>Draws ellipses on an existing plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.ellipse(x, y, a = 1, b = 1, angle = 0, segment = NULL, 
arc.only = TRUE, deg = TRUE, nv = 100, border = NULL, 
col = NA, lty = 1, lwd = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.ellipse_+3A_x">x</code></td>
<td>

<p>A vector or a matrix (if <code>y</code> is missing).</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_y">y</code></td>
<td>

<p>A vector, can be missing.
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_a">a</code>, <code id="draw.ellipse_+3A_b">b</code></td>
<td>

<p>Vectors, radii of the ellypses along the two axes in user units.
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_angle">angle</code></td>
<td>

<p>Angle of rotation in degrees (if <code>deg=TRUE</code>) or in radians
(if <code>deg=FALSE</code>).
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_segment">segment</code></td>
<td>

<p>Start and endpoints of arc in degrees (if <code>deg=TRUE</code>) or in radians
(if <code>deg=FALSE</code>).
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_arc.only">arc.only</code></td>
<td>

<p>Logical, if <code>segmen</code> the full ellipse is not drawn, radii from the
ends of the arc are drawn to form a sector (see Examples).
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_deg">deg</code></td>
<td>

<p>Logical, if angles are given in degrees (<code>TRUE</code>) or radians.
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_nv">nv</code></td>
<td>

<p>Number of vertices to draw the ellipses.
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_border">border</code></td>
<td>

<p>Color to use for drawing the circumference.
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_col">col</code></td>
<td>

<p>Color to use for filling the circle.
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_lty">lty</code></td>
<td>

<p>Line type for the circumference.
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_lwd">lwd</code></td>
<td>

<p>Line width for the circumference.
</p>
</td></tr>
<tr><td><code id="draw.ellipse_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to <code><a href="graphics.html#topic+polygon">polygon</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Draw ellipses as a side effect.</p>


<h3>Author(s)</h3>

<p>Peter Solymos &lt;solymos@ualberta.ca&gt;</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+polygon">polygon</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(c(0,10), c(0,10), type="n", main="test draw.ellipse")
draw.ellipse(c(3,7), c(8,8), c(0.5,1), c(1,0.5), col=c(2,4),
 angle=c(45,0), segment=rbind(c(0,45),c(45,360)))
draw.ellipse(c(3,7), c(6,6), c(0.5,1), c(1,0.5), col=c(2,4),
 angle=c(45,0), segment=rbind(c(0,45),c(45,360)), arc.only=FALSE)
draw.ellipse(c(3,7), c(4,4), c(0.5,1), c(1,0.5), border=c(2,4),
 angle=c(45,0), segment=rbind(c(0,45),c(45,360)), arc.only=FALSE)
draw.ellipse(c(3,7), c(2,2), c(0.5,1), c(1,0.5), border=1,
 angle=c(45,0), lty=3)
draw.ellipse(c(3,7), c(2,2), c(0.5,1), c(1,0.5), border=c(5,3),
 angle=c(45,0), nv=c(3,4), lty=2, lwd=2)
</code></pre>

<hr>
<h2 id='draw.radial.line'>Draw a radial line</h2><span id='topic+draw.radial.line'></span>

<h3>Description</h3>

<p>Draws a line radiating from a specified center, optionally
expanding the line width as a function of distance from center.</p>


<h3>Usage</h3>

<pre><code class='language-R'> draw.radial.line(start, end, center=c(0, 0), angle=0, deg=NA,
  expand=FALSE, col=NA, lwd=NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.radial.line_+3A_start">start</code></td>
<td>
<p>Distance from center of circular area to start of line in
x/y user units.</p>
</td></tr>
<tr><td><code id="draw.radial.line_+3A_end">end</code></td>
<td>
<p>Distance from center of circular area to end of line in x/y
user units.</p>
</td></tr>
<tr><td><code id="draw.radial.line_+3A_center">center</code></td>
<td>
<p>The center of the circular area in x/y user units.</p>
</td></tr>
<tr><td><code id="draw.radial.line_+3A_angle">angle</code></td>
<td>
<p>The angular position of the line in radians.</p>
</td></tr>
<tr><td><code id="draw.radial.line_+3A_deg">deg</code></td>
<td>
<p>The angular position of the line in degrees
(takes precedence if not NA).</p>
</td></tr>
<tr><td><code id="draw.radial.line_+3A_expand">expand</code></td>
<td>
<p>TRUE to expand line width in proportion to distance from
center.</p>
</td></tr>
<tr><td><code id="draw.radial.line_+3A_col">col</code></td>
<td>
<p>The color of the line, NA for par(&quot;col&quot;).</p>
</td></tr>
<tr><td><code id="draw.radial.line_+3A_lwd">lwd</code></td>
<td>
<p>The width of the line in device-specific units,
NA for par(&quot;lwd&quot;).</p>
</td></tr>
<tr><td><code id="draw.radial.line_+3A_...">...</code></td>
<td>
<p>Arguments passed to 'lines' (expand=FALSE) or 'polygon'
(expand=TRUE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the user passes a value for 'deg', this overrides any value passed
to 'angle'.
</p>
<p>If 'expand' is FALSE, the line width is constant (as specified by par(&quot;lwd&quot;).
</p>
<p>If 'expand' is TRUE, the line width is equal to the lwd value at distance
'end' and contracts as it moves towards 'start'.  When expand is 'TRUE',
lty is ignored.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Ted Toal</p>


<h3>See Also</h3>

<p>\
<code><a href="graphics.html#topic+lines">lines</a></code>,
<code><a href="#topic+draw.arc">draw.arc</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(0, xlim=c(1,5), ylim=c(1,5), main="Test of radial lines", xlab="", ylab="", type="n")
 points(3, 3, pch=20)
 draw.radial.line(1, 2, center=c(3,3))
 draw.radial.line(1, 2, center=c(3,3), angle=pi/4)
 draw.radial.line(1, 2, center=c(3,3), angle=pi/4+0.1, col="blue", lwd=4, lty=3)
 draw.radial.line(0.2, 1.2, center=c(3,3), deg=120, col="red", lwd=10)
 draw.radial.line(0.2, 1.2, center=c(3,3), deg=145, col="purple", lwd=10, lend=1)
 draw.radial.line(0.5, 2, center=c(3,3), deg=225, expand=TRUE, col="gold")
 draw.radial.line(0.7, 1.4, center=c(3,3), deg=180, expand=TRUE, col="orange", lwd=30)
 draw.radial.line(0.5, 1.5, center=c(3,3), deg=235, expand=TRUE, lwd=5, col="brown")
 draw.radial.line(0.1, 1.5, center=c(3,3), deg=325, expand=TRUE, lwd=5, col="green")
</code></pre>

<hr>
<h2 id='draw.tilted.sector'>Display a 3D pie sector</h2><span id='topic+draw.tilted.sector'></span>

<h3>Description</h3>

<p>Displays a 3D pie sector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> draw.tilted.sector(x=0,y=0,edges=NA,radius=1,height=0.1,theta=pi/6,
  start=0,end=pi*2,border=par("fg"),col=par("bg"),explode=0,shade=0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.tilted.sector_+3A_x">x</code>, <code id="draw.tilted.sector_+3A_y">y</code></td>
<td>
<p>Position of the center of the pie sector in user units</p>
</td></tr>
<tr><td><code id="draw.tilted.sector_+3A_edges">edges</code></td>
<td>
<p>Number of edges to draw a complete ellipse</p>
</td></tr>
<tr><td><code id="draw.tilted.sector_+3A_radius">radius</code></td>
<td>
<p>the radius of the pie in user units</p>
</td></tr>
<tr><td><code id="draw.tilted.sector_+3A_height">height</code></td>
<td>
<p>the height of the pie in user units</p>
</td></tr>
<tr><td><code id="draw.tilted.sector_+3A_theta">theta</code></td>
<td>
<p>The angle of viewing in radians</p>
</td></tr>
<tr><td><code id="draw.tilted.sector_+3A_start">start</code></td>
<td>
<p>Starting angle of the sector</p>
</td></tr>
<tr><td><code id="draw.tilted.sector_+3A_end">end</code></td>
<td>
<p>Ending angle of the sector</p>
</td></tr>
<tr><td><code id="draw.tilted.sector_+3A_border">border</code></td>
<td>
<p>The color of the sector border lines</p>
</td></tr>
<tr><td><code id="draw.tilted.sector_+3A_col">col</code></td>
<td>
<p>Color of the sector</p>
</td></tr>
<tr><td><code id="draw.tilted.sector_+3A_explode">explode</code></td>
<td>
<p>How far to &quot;explode&quot; the sectors in user units</p>
</td></tr>
<tr><td><code id="draw.tilted.sector_+3A_shade">shade</code></td>
<td>
<p>If &gt; 0 and &lt; 1, the proportion to reduce the
brightness of the sector color to get a better 3D effect.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;draw.tilted.sector&#8288;</span>&rsquo; displays a single 3D pie sector. It is probably
only useful when called from <a href="#topic+pie3D">pie3D</a>. The &lsquo;<span class="samp">&#8288;shade&#8288;</span>&rsquo;
argument proportionately reduces the brightness of the RGB color of
the sector to produce a top lighted effect.
</p>
<p>If &lsquo;<span class="samp">&#8288;explode&#8288;</span>&rsquo; is zero, only the top and outer side of each
sector will be displayed. This will sometimes fix the problem of a pie with
one huge sector greater than 3*pi/2 that cannot otherwise be drawn.
</p>


<h3>Value</h3>

<p>The bisector of the pie sector in radians.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+pie3D">pie3D</a></p>

<hr>
<h2 id='drawNestedBars'>Display nested bars</h2><span id='topic+drawNestedBars'></span>

<h3>Description</h3>

<p>Displays the nested bars for barNest.</p>


<h3>Usage</h3>

<pre><code class='language-R'> drawNestedBars(x,start,end,shrink=0.1,errbars=FALSE,intervals=TRUE,col=NA,
 labelcex=1,lineht=NULL,showall=TRUE,Nwidths=FALSE,barlabels=NULL,
 showlabels=TRUE,arrow.cap=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawNestedBars_+3A_x">x</code></td>
<td>
<p>One level of the breakdown produced by &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_start">start</code>, <code id="drawNestedBars_+3A_end">end</code></td>
<td>
<p>The left and right x coordinates for the bar or group of bars
to be displayed.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_shrink">shrink</code></td>
<td>
<p>The proportion to shrink the width of the bars at each level.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_errbars">errbars</code></td>
<td>
<p>Whether to display error bars on the bars.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_intervals">intervals</code></td>
<td>
<p>Whether to use offsets or absolute values when displaying
measures of dispersion.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_col">col</code></td>
<td>
<p>The colors to use to fill the bars. See Details.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_labelcex">labelcex</code></td>
<td>
<p>Character size for the group labels.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_lineht">lineht</code></td>
<td>
<p>The height of a margin line in user units.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_showall">showall</code></td>
<td>
<p>Whether to display the bars at any levels above the last.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_nwidths">Nwidths</code></td>
<td>
<p>Whether to scale the widths of the bars to the number of
observations.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_barlabels">barlabels</code></td>
<td>
<p>Optional labels to display below the bars.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_showlabels">showlabels</code></td>
<td>
<p>Whether to display the labels below the bars.</p>
</td></tr>
<tr><td><code id="drawNestedBars_+3A_arrow.cap">arrow.cap</code></td>
<td>
<p>The width of the &quot;cap&quot; on error bars in user units,
defaulting to 0.01 of the width of the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;drawNestedBars&#8288;</span>&rsquo; displays the bars for the nested breakdown performed
by &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo;. It starts at the top of the list and calls itself for
each level of the breakdown. It is unlikely to be useful for anything else.
</p>
<p>The combination of &lsquo;<span class="samp">&#8288;showlabels=TRUE&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;showall=FALSE&#8288;</span>&rsquo; allows
the display of all of the labels below the plot with only the last set of
bars being displayed. To have a set of labels not displayed, pass explicit
&lsquo;<span class="samp">&#8288;barlabels&#8288;</span>&rsquo; and have zero length labels for the level that is not to
have labels.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon and Ofir Levy</p>


<h3>See Also</h3>

<p><a href="#topic+brkdnNest">brkdnNest</a>, <a href="#topic+drawNestedBars">drawNestedBars</a></p>

<hr>
<h2 id='drawSectorAnnulus'>Display a radial pie sector</h2><span id='topic+drawSectorAnnulus'></span>

<h3>Description</h3>

<p>Displays a radial pie sector with optional annuli.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> drawSectorAnnulus(angle1,angle2,radius1,radius2,col,angleinc=0.03)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawSectorAnnulus_+3A_angle1">angle1</code>, <code id="drawSectorAnnulus_+3A_angle2">angle2</code></td>
<td>
<p>Start and end angle for the sector.</p>
</td></tr>
<tr><td><code id="drawSectorAnnulus_+3A_radius1">radius1</code>, <code id="drawSectorAnnulus_+3A_radius2">radius2</code></td>
<td>
<p>Start and end of the radial extent of the annulus.</p>
</td></tr>
<tr><td><code id="drawSectorAnnulus_+3A_col">col</code></td>
<td>
<p>Color of the sector.</p>
</td></tr>
<tr><td><code id="drawSectorAnnulus_+3A_angleinc">angleinc</code></td>
<td>
<p>The angular increment to use in drawing the arcs.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;drawSectorAnnulus&#8288;</span>&rsquo; displays a single radial pie sector. It is probably
only useful when called from <a href="#topic+radial.pie">radial.pie</a>.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+radial.pie">radial.pie</a></p>

<hr>
<h2 id='ehplot'>
Engelmann-Hecker-Plot - EH-Plot
</h2><span id='topic+ehplot'></span>

<h3>Description</h3>

<p>This R function provides a convenient way to visualize the distribution of 
grouped numerical data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ehplot(data, groups, intervals=50, offset=0.1, log=FALSE,
         median=TRUE, box=FALSE, boxborder="grey50",
         xlab="groups", ylab="values", col="black",
         add=FALSE, sort=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ehplot_+3A_data">data</code></td>
<td>

<p>Vector of numerical data.
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_groups">groups</code></td>
<td>

<p>Vector of group names which should have the same length as data.
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_intervals">intervals</code></td>
<td>

<p>The data is splitted into a certain number of intervals. If data
points are in the same interval they are drawn side-by-side.
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_offset">offset</code></td>
<td>

<p>x-distance between two data points at the same interval.
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_log">log</code></td>
<td>

<p>Logarithmic display
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_median">median</code></td>
<td>

<p>To show the median of each group. NAs in data are not considered
for calculating the medians.
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_box">box</code></td>
<td>

<p>To underlay a boxplot.
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_boxborder">boxborder</code></td>
<td>

<p>The color of the boxplot if a boxplot is drawn.
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_xlab">xlab</code></td>
<td>

<p>x-axis label
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_ylab">ylab</code></td>
<td>

<p>y-axis label
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_col">col</code></td>
<td>

<p>vector of colors for the datapoints. (recycled as necessary).
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_add">add</code></td>
<td>

<p>add this plot to an existing one (i.e. do not call plot.new).
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_sort">sort</code></td>
<td>

<p>normally, the groups are sorted by name. To keep the order as provided in
the groups-vector, set this to FALSE
</p>
</td></tr>
<tr><td><code id="ehplot_+3A_...">...</code></td>
<td>

<p>additional plot-parameters will be passed to the plot-function
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Robby Engelmann &lt;robby.engelmann@med.uni-rostock.de&gt; and
Michael Hecker &lt;michael.hecker@rocketmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(iris)
ehplot(iris$Sepal.Length, iris$Species, intervals=20, cex=1.8, pch=20)
ehplot(iris$Sepal.Width, iris$Species, intervals=20, box=TRUE, median=FALSE)
ehplot(iris$Petal.Length, iris$Species, pch=17, col="red", log=TRUE)
ehplot(iris$Petal.Length, iris$Species, offset=0.06, pch=as.numeric(iris$Species))

# Groups don't have to be presorted:
rnd &lt;- sample(150)
plen &lt;- iris$Petal.Length[rnd]
pwid &lt;- abs(rnorm(150, 1.2))
spec &lt;- iris$Species[rnd]
ehplot(plen, spec, pch=19, cex=pwid, col=rainbow(3, alpha=0.6)[as.numeric(spec)])
</code></pre>

<hr>
<h2 id='election'>Assign party members to seats</h2><span id='topic+election'></span>

<h3>Description</h3>

<p>Create a layout for an election result in an assembly</p>


<h3>Usage</h3>

<pre><code class='language-R'> election(seats,result,formula,colours = sample(rainbow(length(counts))))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="election_+3A_seats">seats</code></td>
<td>
<p>A data frame of x and y positions, row numbers and angles
(usually the output from the seats function).</p>
</td></tr>
<tr><td><code id="election_+3A_result">result</code></td>
<td>
<p>A data frame with party names and seat counts.</p>
</td></tr>
<tr><td><code id="election_+3A_formula">formula</code></td>
<td>
<p>A formula with the party name column on the left and the
count column on the right. Think of the twiddle symbol as &quot;got&quot;.</p>
</td></tr>
<tr><td><code id="election_+3A_colours">colours</code></td>
<td>
<p>A vector of colours. If missing a random rainbow is used.
This may cause Green parties to show as red.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame including:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The x positions of the seats to be plotted on semi-circular
arcs.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The y positions of the seats to be plotted on semi-circular
arcs.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>The row numbers for each seat.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>The angle of each seat, going from pi to zero radians.</p>
</td></tr>
<tr><td><code>party</code></td>
<td>
<p>The labels for the party holding each seat.</p>
</td></tr>
<tr><td><code>colour</code></td>
<td>
<p>The colour that has been assigned to the party.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Rowlingson</p>


<h3>See Also</h3>

<p><a href="#topic+seats">seats</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # The EU parliament has 751 seats, and Wikipedia currently shows this
 eu = structure(list(colour = c("#3399FF", "#F0001C", "#0054A5", "#FFD700",
 "#990000", "#909090", "#32CD32", "#40E0D0"), party = c("EPP",
 "S and D", "ECR", "ALDE", "GUE-NGL", "Non-Inscrits", "Greens-EFA",
 "EFDD"), members = c(220L, 191L, 70L, 68L, 52L, 52L, 50L, 48L
 )), .Names = c("colour", "party", "members"), row.names = c(NA,
 -8L), class = "data.frame")
 strasbourg = seats(751, 16)
 eugov = election(strasbourg, eu, party~members, colours=eu$colour)
 oldmar&lt;-par(mar=c(2,4,4,2))
 plot(eugov$x, eugov$y, col=eugov$colour, asp=1, pch=19, ylim=c(-2,2.5),
  xlab="", ylab="", main="EU Parliament 2014", axes=FALSE)
 legend(-0.7,-0.3,eu$party,fill=eu$colour)
 par(oldmar)
 # or using ggplot2
 ## Not run:  
  require(ggplot2)
  blank = theme(axis.line=element_blank(),
        axis.text.x=element_blank(),
  axis.text.y=element_blank(),
  axis.ticks=element_blank(),
  axis.title.x=element_blank(),
  axis.title.y=element_blank(),
  panel.background=element_blank(),
  panel.border=element_blank(),
  panel.grid.major=element_blank(),
  panel.grid.minor=element_blank(),
  plot.background=element_blank())
  ggplot(eugov, aes(x=x,y=y,col=party)) + geom_point() + coord_fixed() + blank
 
## End(Not run)
</code></pre>

<hr>
<h2 id='emptyspace'> Find an empty space on a plot </h2><span id='topic+emptyspace'></span>

<h3>Description</h3>

<p>Try to find the largest empty rectangle on a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> emptyspace(x,y=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emptyspace_+3A_x">x</code>, <code id="emptyspace_+3A_y">y</code></td>
<td>
<p>x and y positions of the points on the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;emptyspace&#8288;</span>&rsquo; searches the pairs of points on the plot to find
the largest rectangular space within which none of the points lie.
It does not guarantee that the space will be large enough to fit a
legend or text.
</p>
<p>Two alternatives are the &lsquo;<span class="samp">&#8288;largest.empty&#8288;</span>&rsquo; function in the 
<span class="pkg">Hmisc</span> package and the &lsquo;<span class="samp">&#8288;maxEmptyRect&#8288;</span>&rsquo; function. While
&lsquo;<span class="samp">&#8288;maxEmptyRect&#8288;</span>&rsquo; will generally outperform &lsquo;<span class="samp">&#8288;emptyspace&#8288;</span>&rsquo;,
&lsquo;<span class="samp">&#8288;emptyspace&#8288;</span>&rsquo; will sometimes find a slightly smaller, but
&quot;squarer&quot; rectangle.
</p>


<h3>Value</h3>

<p>The &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; coordinates of the center of the rectangle
found.
</p>


<h3>Author(s)</h3>

<p>Ray Brownrigg</p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-rnorm(100)
 y&lt;-rnorm(100)
 plot(x,y,main="Find the empty space",xlab="X",ylab="Y")
 es&lt;-emptyspace(x,y)
 # use a transparent background so that any overplotted points are shown
 boxed.labels(es,labels="Here is the\nempty space",bg="transparent")
</code></pre>

<hr>
<h2 id='fan.plot'> Display a fan plot </h2><span id='topic+fan.plot'></span>

<h3>Description</h3>

<p>Displays numerical values as the arcs of overlapping sectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> fan.plot(x,edges=200,radius=1,col=NULL,align.at=NULL,max.span=NULL,
  labels=NULL,labelpos=NULL,label.radius=1.2,align="left",shrink=0.02,
  main="",ticks=NULL,include.sumx=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fan.plot_+3A_x">x</code></td>
<td>
<p>Vector of numbers.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_edges">edges</code></td>
<td>
<p>The number of edges with which to draw a circle.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_radius">radius</code></td>
<td>
<p>The radius of the sectors.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_col">col</code></td>
<td>
<p>The colors with which to fill the sectors.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_align.at">align.at</code></td>
<td>
<p>Where to align the sectors (see Details).</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_max.span">max.span</code></td>
<td>
<p>The angle of the maximal sector in radians. The default
is to scale &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; so that it sums to 2*pi.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_labels">labels</code></td>
<td>
<p>Labels placed around the sector arcs.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_labelpos">labelpos</code></td>
<td>
<p>Optional circumferential positions for the labels.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_label.radius">label.radius</code></td>
<td>
<p>How far away from the sectors the labels will
be placed. May be a vector with a radius for each label.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_align">align</code></td>
<td>
<p>Position of the alignment of sectors (see Details).</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_shrink">shrink</code></td>
<td>
<p>How much to shrink each successive sector in user units.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_main">main</code></td>
<td>
<p>Optional title for the plot.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_ticks">ticks</code></td>
<td>
<p>The number of ticks that would appear if the sectors were on
a pie chart. Default is no ticks, TRUE gives the number of ticks equal to
the integer sum of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;, which is fairly sensible if 
&lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; is a vector of integers.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_include.sumx">include.sumx</code></td>
<td>
<p>Whether to include the sum of all &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; values
as the largest sector.</p>
</td></tr>
<tr><td><code id="fan.plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to &lsquo;<span class="samp">&#8288;polygon&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;fan.plot&#8288;</span>&rsquo; displays sectors much like a pie chart except that the
sectors are overlapped. this allows the angular extents of the sectors to
be visually compared much more accurately by the viewer. Sectors are plotted
from the largest to the smallest, shrinking the radius of each successive
sector.
</p>
<p>When sending output to the postscript device, the resulting image can be
trimmed by changing the values in BoundingBox in the header with a text 
editor.
</p>


<h3>Value</h3>

<p>The circumferential positions of the labels in radians. These are
returned in order of decreasing size of the values plotted.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon, Anupam Tyagi</p>


<h3>Examples</h3>

<pre><code class='language-R'> iucn.df&lt;-data.frame(area=c("Africa","Asia","Europe","N&amp;C America",
  "S America","Oceania"),threatened=c(5994,7737,1987,4716,5097,2093))
 fan.plot(iucn.df$threatened,max.span=pi,
  labels=paste(iucn.df$area,iucn.df$threatened,sep="-"),
  main="Threatened species by geographical area (fan.plot)",ticks=276)
</code></pre>

<hr>
<h2 id='feather.plot'> Display vectors along a horizontal reference line </h2><span id='topic+feather.plot'></span>

<h3>Description</h3>

<p>Displays vectors along a line usually representing time or position.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> feather.plot(r,theta,xpos,yref=0,use.arrows=TRUE,
 col.refline="lightgray",fp.type="s",main="",xlab="",ylab="",
 xlabels=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feather.plot_+3A_r">r</code></td>
<td>
<p>radii of vectors</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_theta">theta</code></td>
<td>
<p>direction of vectors in radians</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_xpos">xpos</code></td>
<td>
<p>where to start each vector along the reference line</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_yref">yref</code></td>
<td>
<p>vertical position to place the reference line</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_use.arrows">use.arrows</code></td>
<td>
<p>whether to put arrow heads on the ends of the vectors</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_col.refline">col.refline</code></td>
<td>
<p>the color of the reference line</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_fp.type">fp.type</code></td>
<td>
<p>whether to use &quot;standard&quot; coordinates (begin at the
right and move counterclockwise) or &quot;meteorological&quot; coordinates
(begin at the top and move clockwise) when interpreting the values
of &lsquo;<span class="samp">&#8288;theta&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_main">main</code></td>
<td>
<p>the title of the plot</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_xlab">xlab</code></td>
<td>
<p>the label for the reference line</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_ylab">ylab</code></td>
<td>
<p>the label for the vertical axis</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_xlabels">xlabels</code></td>
<td>
<p>optional labels for the reference line</p>
</td></tr>
<tr><td><code id="feather.plot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;arrows&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;segments&#8288;</span>&rsquo;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function places vectors of length &lsquo;<span class="samp">&#8288;r&#8288;</span>&rsquo; and angle &lsquo;<span class="samp">&#8288;theta&#8288;</span>&rsquo; 
along a reference line that may represent time or position or some other
value. The user is responsible for spacing the vectors so that they do
not overlap if this is desired.
</p>
<p>Feather plots are typically wider than high. The user will probably want
to specify a graphics device that doesn't leave lots of blank space above
and below the plot.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon, Eduardo Klein</p>


<h3>See Also</h3>

<p><a href="#topic+spread.labels">spread.labels</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> dev.new(width=8,height=3)
 r&lt;-0.6+rnorm(24)/5
 theta&lt;-c(seq(15*pi/16,pi/16,length.out=12),
  seq(17*pi/16,31*pi/16,length.out=12))
 feather.plot(r,theta,xlabels=1:24,
  main="Standard Coordinates",xlab="Time",ylab="Value")
 # rearrange theta for meteorological coordinates
 feather.plot(r,c(theta[19:24],rev(theta[7:18]),theta[1:6]),xlabels=1:24,fp.type="m",
  main="Meteorological Coordinates",xlab="Time",ylab="Value")
 dev.off()
</code></pre>

<hr>
<h2 id='fill.corner'>
Fill a &quot;corner&quot; of a matrix with values
</h2><span id='topic+fill.corner'></span>

<h3>Description</h3>

<p>Fills one corner of a matrix with the supplied values, leaving the rest
filled with a default value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> fill.corner(x,nrow,ncol,na.value=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fill.corner_+3A_x">x</code></td>
<td>
<p>A vector of values.</p>
</td></tr>
<tr><td><code id="fill.corner_+3A_nrow">nrow</code>, <code id="fill.corner_+3A_ncol">ncol</code></td>
<td>
<p>The number of rows and columns in the matrix to be returned.</p>
</td></tr>
<tr><td><code id="fill.corner_+3A_na.value">na.value</code></td>
<td>
<p>The default value for unfilled cells.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;fill.corner&#8288;</span>&rsquo; creates an nrow by ncol matrix and fills the lower left
corner with the values supplied in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;. If there are more values in
&lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; than cells in the matrix, only the first nrow*ncol values will be
inserted.
</p>


<h3>Value</h3>

<p>An nrow by ncol matrix containing the values in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>

<hr>
<h2 id='find_max_cell'>Maximum (or minimum) value cell in a matrix.</h2><span id='topic+find_max_cell'></span>

<h3>Description</h3>

<p>Find the indices of the maximum value in a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> find_max_cell(x,max=TRUE) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_max_cell_+3A_x">x</code></td>
<td>
<p>a numeric matrix</p>
</td></tr>
<tr><td><code id="find_max_cell_+3A_max">max</code></td>
<td>
<p>The default is to return the indices of the maximum value(s).
&lsquo;<span class="samp">&#8288;max=FALSE&#8288;</span>&rsquo; returns those of the minimum.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the column (x) and row (y) indices.
</p>


<h3>Note</h3>

<p>Intended to enable the user to mark cells in &lsquo;<span class="samp">&#8288;color2D.matplot&#8288;</span>&rsquo;.
Remember to subtract 0.5 from both values to center the mark in the cell.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>

<hr>
<h2 id='floating.pie'>Display a floating pie chart</h2><span id='topic+floating.pie'></span>

<h3>Description</h3>

<p>Displays a pie chart at an arbitrary position on an existing plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'> floating.pie(xpos=0,ypos=0,x,edges=200,radius=1,col=NULL,startpos=0,
  shadow=FALSE,shadow.col=c("#ffffff","#cccccc"),explode=0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="floating.pie_+3A_xpos">xpos</code>, <code id="floating.pie_+3A_ypos">ypos</code></td>
<td>
<p>x and y position of the center of the pie chart</p>
</td></tr>
<tr><td><code id="floating.pie_+3A_x">x</code></td>
<td>
<p>a numeric vector for which each value will be a sector</p>
</td></tr>
<tr><td><code id="floating.pie_+3A_edges">edges</code></td>
<td>
<p>the number of lines forming a circle</p>
</td></tr>
<tr><td><code id="floating.pie_+3A_radius">radius</code></td>
<td>
<p>the radius of the pie in user units</p>
</td></tr>
<tr><td><code id="floating.pie_+3A_col">col</code></td>
<td>
<p>the colors of the sectors - defaults to &lsquo;<span class="samp">&#8288;rainbow&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="floating.pie_+3A_startpos">startpos</code></td>
<td>
<p>The starting position for drawing sectors in radians.</p>
</td></tr>
<tr><td><code id="floating.pie_+3A_shadow">shadow</code></td>
<td>
<p>Logical - whether to draw a shadow</p>
</td></tr>
<tr><td><code id="floating.pie_+3A_shadow.col">shadow.col</code></td>
<td>
<p>Colors to use for a shadow.</p>
</td></tr>
<tr><td><code id="floating.pie_+3A_explode">explode</code></td>
<td>
<p>How much to &quot;explode&quot; one or more of the sectors.</p>
</td></tr>
<tr><td><code id="floating.pie_+3A_...">...</code></td>
<td>
<p>graphical parameters passed to &lsquo;<span class="samp">&#8288;polygon&#8288;</span>&rsquo;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;floating.pie&#8288;</span>&rsquo; displays a pie chart with an optional shadow on an
existing plot (see &lsquo;<span class="samp">&#8288;polygon.shadow&#8288;</span>&rsquo;). &lsquo;<span class="samp">&#8288;floating.pie&#8288;</span>&rsquo; now accepts
NAs or zeros in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;, but simply ignores them.
</p>
<p>&lsquo;<span class="samp">&#8288;floating.pie&#8288;</span>&rsquo; can be useful when multiple pie charts are placed on a
plot overlaying something else, like a map.
</p>


<h3>Value</h3>

<p>The bisecting angle of the sectors in radians. Useful for placing
text labels for each sector. If any values in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; were zero or NA,
no angle is returned for that value. This means that the user must adjust
the labels accordingly if &lsquo;<span class="samp">&#8288;pie.labels&#8288;</span>&rsquo; is called.
</p>
<p>If &lsquo;<span class="samp">&#8288;floating.pie&#8288;</span>&rsquo; is called with no graphics device, it will try to
open one with the appropriate dimensions.
</p>
<p>If &lsquo;<span class="samp">&#8288;pie.labels&#8288;</span>&rsquo; is called, ensure that the center of the pie chart
and any &lsquo;<span class="samp">&#8288;explode&#8288;</span>&rsquo; values are the same.
</p>


<h3>Note</h3>

<p>As with most pie charts, simplicity is essential. Trying to display a
complicated breakdown of data rarely succeeds.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+pie.labels">pie.labels</a>, <a href="#topic+boxed.labels">boxed.labels</a>, <a href="#topic+polygon.shadow">polygon.shadow</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(1:5,type="n",main="Floating Pie test",xlab="",ylab="",axes=FALSE)
 box()
 polygon(c(0,0,5.5,5.5),c(0,3,3,0),border="#44aaff",col="#44aaff")
 floating.pie(1.7,3,c(2,4,4,2,8),radius=0.5,
  col=c("#ff0000","#80ff00","#00ffff","#44bbff","#8000ff"))
 floating.pie(3.1,3,c(1,4,5,2,8),radius=0.5,
  col=c("#ff0000","#80ff00","#00ffff","#44bbff","#8000ff"))
 floating.pie(4,1.5,c(3,4,6,7),radius=0.5,
  col=c("#ff0066","#00cc88","#44bbff","#8000ff"))
 draw.circle(3.9,2.1,radius=0.04,col="white")
 draw.circle(3.9,2.1,radius=0.04,col="white")
 draw.circle(3.9,2.1,radius=0.04,col="white")
 draw.circle(4,2.3,radius=0.04,col="white")
 draw.circle(4.07,2.55,radius=0.04,col="white")
 draw.circle(4.03,2.85,radius=0.04,col="white")
 text(c(1.7,3.1,4),c(3.7,3.7,3.7),c("Pass","Pass","Fail"))
 plot(0,xlim=c(-1.5,1.5),ylim=c(-1.5,1.5),type="n",axes=FALSE,
  main="Floating pie with minor explosions",xlab="",ylab="")
 floating.pie(x=1:5,explode=c(0,0.1,0,0.2,0))
</code></pre>

<hr>
<h2 id='fullaxis'>Add an axis with a line to the edge of the plot</h2><span id='topic+fullaxis'></span>

<h3>Description</h3>

<p>As &lsquo;<span class="samp">&#8288;axis&#8288;</span>&rsquo;, but draws a &quot;box&quot; line in the same color as the axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> fullaxis(side=1,at=NULL,labels=TRUE,line=NA,pos=NA,outer=FALSE,
 font=NA,lty="solid",lwd=1,lwd.ticks=lwd,col=NULL,col.ticks=NULL,
 hadj=NA,padj=NA,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fullaxis_+3A_side">side</code></td>
<td>
<p>The side of the plot to draw the axis</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_at">at</code></td>
<td>
<p>Optional positions in user units for the tick marks.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_labels">labels</code></td>
<td>
<p>Optional labels for the tick marks.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_line">line</code></td>
<td>
<p>Optional line into the margin.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_pos">pos</code></td>
<td>
<p>Optional position in user units for the axis. Defaults to the edge.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_outer">outer</code></td>
<td>
<p>Whether to use the outer margin as for &lsquo;<span class="samp">&#8288;axis&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_font">font</code></td>
<td>
<p>Font for the labels.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_lty">lty</code></td>
<td>
<p>Line type.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_lwd">lwd</code></td>
<td>
<p>Line width for the axis.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_lwd.ticks">lwd.ticks</code></td>
<td>
<p>Line width for the ticks.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_col">col</code></td>
<td>
<p>color for the axis and tick marks. See Details for label color.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_col.ticks">col.ticks</code></td>
<td>
<p>Color for the tick marks if different from the axis.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_hadj">hadj</code>, <code id="fullaxis_+3A_padj">padj</code></td>
<td>
<p>Justification for the labels. See &lsquo;<span class="samp">&#8288;axis&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="fullaxis_+3A_...">...</code></td>
<td>
<p>Further arguments passed to &lsquo;<span class="samp">&#8288;axis&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;fullaxis&#8288;</span>&rsquo; draws a line to the edges of the plot and then calls
&lsquo;<span class="samp">&#8288;axis&#8288;</span>&rsquo; to draw an axis. &lsquo;<span class="samp">&#8288;fullaxis&#8288;</span>&rsquo; is mainly useful for drawing a
colored axis on a boxed plot. In order to get the tick labels the same color as
the axis and ticks, pass the &lsquo;<span class="samp">&#8288;col.axis&#8288;</span>&rsquo; argument (as part of ...) as well
as &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo;. See the example for some useful tips.
</p>


<h3>Value</h3>

<p>The positions of the tick marks in user units.
</p>


<h3>Author(s)</h3>

<p> Jim Lemon </p>


<h3>See Also</h3>

 <p><a href="graphics.html#topic+axis">axis</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(runif(20,-1,1),runif(20,-1,1),xlim=c(-1,1.5),main="Demo of fullaxis",
  xlab="X",ylab="Y",axes=FALSE)
 fullaxis(1,col="red",col.axis="red")
 fullaxis(2,col="blue",col.axis="blue")
 fullaxis(4,at=c(-0.5,0,0.5),labels=c("Negative","Zero","Positive"),pos=1.2,
  col="green",las=1)
 # add a top line to complete the "box"
 xylim&lt;-par("usr")
 segments(xylim[1],xylim[4],xylim[2],xylim[4])
</code></pre>

<hr>
<h2 id='gantt.chart'>Display a Gantt chart</h2><span id='topic+gantt.chart'></span>

<h3>Description</h3>

<p>Displays a Gantt chart with priority coloring
</p>


<h3>Usage</h3>

<pre><code class='language-R'> gantt.chart(x=NULL,format="%Y/%m/%d",xlim=NULL,taskcolors=NULL,
  priority.legend=FALSE,vgridpos=NULL,vgridlab=NULL,
  vgrid.format="%Y/%m/%d",
  half.height=0.25,hgrid=FALSE,main="",xlab="",cylindrical=FALSE,
  label.cex=1,border.col=NA,priority.label="Priorities",
  priority.extremes=c("High","Low"),time.axis=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gantt.chart_+3A_x">x</code></td>
<td>
<p>a list of task labels, start/end times and task priorities
as returned by &lsquo;<span class="samp">&#8288;get.gantt.info&#8288;</span>&rsquo;. If this is not present,
<a href="#topic+get.gantt.info">get.gantt.info</a> will be called.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_format">format</code></td>
<td>
<p>the format to be used in entering dates/times
(see <a href="base.html#topic+strptime">strptime</a>).</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_xlim">xlim</code></td>
<td>
<p>the horizontal limits of the plot (see Details).</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_taskcolors">taskcolors</code></td>
<td>
<p>a vector of colors used to illustrate task priority.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_priority.legend">priority.legend</code></td>
<td>
<p>Whether to display a priority color legend.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_vgridpos">vgridpos</code></td>
<td>
<p>optional positions of the vertical grid lines.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_vgridlab">vgridlab</code></td>
<td>
<p>optional labels for the vertical grid lines.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_vgrid.format">vgrid.format</code></td>
<td>
<p>format for the vertical grid labels.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_half.height">half.height</code></td>
<td>
<p>the proportion of the spacing between task bars that
will be filled by the bar on each side - 0.5 will leave no space.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_hgrid">hgrid</code></td>
<td>
<p>logical - whether to display grid lines between the bars.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_main">main</code></td>
<td>
<p>the title of the plot - note that this is actually displayed
using &lsquo;<span class="samp">&#8288;mtext&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_xlab">xlab</code></td>
<td>
<p>horizontal axis label - usually suppressed.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_cylindrical">cylindrical</code></td>
<td>
<p>Whether to give the bars a cylindrical appearance.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_label.cex">label.cex</code></td>
<td>
<p>Relative size for the task labels at the left side.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_border.col">border.col</code></td>
<td>
<p>The color for an optional border for the bars (NA=none).</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_priority.label">priority.label</code></td>
<td>
<p>Label for the priority color legend.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_priority.extremes">priority.extremes</code></td>
<td>
<p>Labels for each end of the priority color legend.</p>
</td></tr>
<tr><td><code id="gantt.chart_+3A_time.axis">time.axis</code></td>
<td>
<p>Where to place the time axis labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because the &quot;time&quot; axis is calculated using POSIXct values, the
values passed as &lsquo;<span class="samp">&#8288;xlim&#8288;</span>&rsquo; must also be POSIXct. See the second plot
in the examples.
</p>
<p>If task priority colors are not wanted, set &lsquo;<span class="samp">&#8288;taskcolors&#8288;</span>&rsquo; to a single
value to suppress the coloring. If this is not done, &lsquo;<span class="samp">&#8288;rainbow&#8288;</span>&rsquo; will
be called to generate a different color for each task. If colors other than
&lsquo;<span class="samp">&#8288;rainbow&#8288;</span>&rsquo; are wanted, remember to pass enough colors for one to the
lowest (highest numerically) priority.
</p>
<p>There can now be more than one time interval for each task. If there is,
more than one bar will be displayed for each interval, which may not be a
task at all, but rather intervals related to the labels. Colors can be
specified for labels or intervals and if there are not as many colors as
intervals, the first &quot;number of unique labels&quot; colors will be assigned to
each unique label. This should make every bar for each label the
same color, but be aware that the colors will be distributed in alphabetical
order of the entity labels. If there are at least as many taskcolors as intervals,
they will be assigned to intervals in the order of the &lsquo;<span class="samp">&#8288;taskcolors&#8288;</span>&rsquo; vector.
The examples should make this clearer.
</p>
<p>Since &lsquo;<span class="samp">&#8288;gantt.chart&#8288;</span>&rsquo; can be used to display things other than prioritized
tasks, the labels for the priority legend can now be specified.
</p>


<h3>Value</h3>

<p>The list used to create the chart - see <a href="#topic+get.gantt.info">get.gantt.info</a> for
details. This can be saved and reused rather than manually entering the 
information each time the chart is displayed.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon (original by Scott Waichler - features by Ulrike Gromping -
added label colors by Nicolas Immelman)</p>


<h3>See Also</h3>

<p><a href="#topic+get.gantt.info">get.gantt.info</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> Ymd.format&lt;-"%Y/%m/%d"
 gantt.info&lt;-list(labels=
  c("First task","Second task","Third task","Fourth task","Fifth task"),
  starts=
  as.POSIXct(strptime(
  c("2004/01/01","2004/02/02","2004/03/03","2004/05/05","2004/09/09"),
  format=Ymd.format)),
  ends=
  as.POSIXct(strptime(
  c("2004/03/03","2004/05/05","2004/05/05","2004/08/08","2004/12/12"),
  format=Ymd.format)),
  priorities=c(1,2,3,4,5))
 vgridpos&lt;-as.POSIXct(strptime(c("2004/01/01","2004/02/01","2004/03/01",
  "2004/04/01","2004/05/01","2004/06/01","2004/07/01","2004/08/01",
  "2004/09/01","2004/10/01","2004/11/01","2004/12/01"),format=Ymd.format))
 vgridlab&lt;-
  c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec")
 gantt.chart(gantt.info,main="Calendar date Gantt chart (2004)",
  priority.legend=TRUE,vgridpos=vgridpos,vgridlab=vgridlab,hgrid=TRUE)
 # add a little extra space on the right side
 gantt.chart(gantt.info,main="Calendar date Gantt chart (2004)",
 priority.legend=TRUE,vgridpos=vgridpos,vgridlab=vgridlab,hgrid=TRUE,
 xlim=as.POSIXct(strptime(c("2004/01/01","2004/12/20"),
 format=Ymd.format)))
 # if both vgidpos and vgridlab are specified,
 # starts and ends don't have to be dates
 info2&lt;-list(labels=c("Jim","Joe","Jim","John","John","Jake","Joe","Jed","Jake"),
  starts=c(8.1,8.7,13.0,9.1,11.6,9.0,13.6,9.3,14.2),
  ends=c(12.5,12.7,16.5,10.3,15.6,11.7,18.1,18.2,19.0))
 gantt.chart(info2,vgridlab=8:19,vgridpos=8:19,
  main="All bars the same color",taskcolors="lightgray")
 gantt.chart(info2,vgridlab=8:19,vgridpos=8:19,
  main="A color for each label",taskcolors=c(2,3,7,4,8))
 gantt.chart(info2,vgridlab=8:19,vgridpos=8:19,
  main="A color for each interval - with borders",
  taskcolors=c(2,3,7,4,8,5,3,6,"purple"),border.col="black")
</code></pre>

<hr>
<h2 id='gap_barp'>
Display a barplot with a gap (missing range) on one axis
</h2><span id='topic+gap_barp'></span>

<h3>Description</h3>

<p>Displays a barplot with a missing range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> gap_barp(height,gap,width=0.4,names.arg=names(height),
 col=NULL,main="",xlab="",ylab="",xlim=NULL,ylim=NULL,x=NULL,
 height.at=pretty(height),height.lab=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gap_barp_+3A_height">height</code></td>
<td>
<p>a vector of data values</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_gap">gap</code></td>
<td>
<p>the range of values to be left out</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_width">width</code></td>
<td>
<p>the proportion of bar width to bar spacing divided by 2.
width=1 means no spaces between the bars.</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_names.arg">names.arg</code></td>
<td>
<p>labels for the bars.</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_col">col</code></td>
<td>
<p>color(s) in which to plot the values</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_main">main</code></td>
<td>
<p>title for the plot.</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_xlab">xlab</code></td>
<td>
<p>label for the x axis</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_ylab">ylab</code></td>
<td>
<p>label for the y axis</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_xlim">xlim</code></td>
<td>
<p>Optional x limits for the plot</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_ylim">ylim</code></td>
<td>
<p>optional y limits for the plot</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_x">x</code></td>
<td>
<p>optional x positions for the bars.</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_height.at">height.at</code></td>
<td>
<p>explicit positions for the y axis ticks</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_height.lab">height.lab</code></td>
<td>
<p>explicit labels for the y axis ticks.</p>
</td></tr>
<tr><td><code id="gap_barp_+3A_...">...</code></td>
<td>
<p>arguments passed to &lsquo;<span class="samp">&#8288;barp&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a barplot omitting a range of values on the X or Y axis. Typically 
used when there is a relatively large gap in the range of values 
represented as bar heights. See <a href="#topic+axis.break">axis.break</a> for a brief 
discussion of plotting on discontinuous coordinates.
</p>
<p>If the user does not ask for specific y limits, the function will calculate
limits based on the range of the data values. If passing specific limits, 
remember to subtract the gap from the upper or lower limit.
</p>


<h3>Value</h3>

<p>The center positions of the bars.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+barp">barp</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> oneout&lt;-c(rnorm(5,sd=5),20,rnorm(5,sd=5))
 gap_barp(oneout,gap=c(8,16),xlab="Index",height.at=c(-5,0,5,20),
  ylab="Group values",main="Barplot with gap above zero")
 oneout[6]&lt;--20
 gap_barp(oneout,gap=c(-8,-16),xlab="Index",height.at=c(-20,-5,0,5),
  ylab="Group values",main="Barplot with gap below zero")
</code></pre>

<hr>
<h2 id='gap.barplot'>
Display a barplot with a gap (missing range) on one axis
</h2><span id='topic+gap.barplot'></span>

<h3>Description</h3>

<p>Displays a barplot with a missing range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> gap.barplot(y,gap,xaxlab,xtics,yaxlab,ytics,xlim=NA,ylim=NA,xlab=NULL,
  ylab=NULL,horiz=FALSE,col,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gap.barplot_+3A_y">y</code></td>
<td>
<p>a vector of data values</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_gap">gap</code></td>
<td>
<p>the range of values to be left out</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_xaxlab">xaxlab</code></td>
<td>
<p>labels for the x axis ticks</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_xtics">xtics</code></td>
<td>
<p>position of the x axis ticks</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_yaxlab">yaxlab</code></td>
<td>
<p>labels for the y axis ticks</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_ytics">ytics</code></td>
<td>
<p>position of the y axis ticks</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_xlim">xlim</code></td>
<td>
<p>Optional x limits for the plot</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_ylim">ylim</code></td>
<td>
<p>optional y limits for the plot</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_xlab">xlab</code></td>
<td>
<p>label for the x axis</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_ylab">ylab</code></td>
<td>
<p>label for the y axis</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_horiz">horiz</code></td>
<td>
<p>whether to have vertical or horizontal bars</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_col">col</code></td>
<td>
<p>color(s) in which to plot the values</p>
</td></tr>
<tr><td><code id="gap.barplot_+3A_...">...</code></td>
<td>
<p>arguments passed to &lsquo;<span class="samp">&#8288;barplot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a barplot omitting a range of values on the X or Y axis. Typically 
used when there is a relatively large gap in the range of values 
represented as bar heights. See <a href="#topic+axis.break">axis.break</a> for a brief 
discussion of plotting on discontinuous coordinates.
</p>
<p>If the user does not ask for specific y limits, the function will calculate
limits based on the range of the data values. If passing specific limits, 
remember to subtract the gap from the upper limit.
</p>


<h3>Value</h3>

<p>The center positions of the bars.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+gap.barplot">gap.barplot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> twogrp&lt;-c(rnorm(10)+4,rnorm(10)+20)
 gap.barplot(twogrp,gap=c(8,16),xlab="Index",ytics=c(3,6,17,20),
  ylab="Group values",main="Barplot with gap")
 gap.barplot(twogrp,gap=c(8,16),xlab="Index",ytics=c(3,6,17,20),
  ylab="Group values",horiz=TRUE,main="Horizontal barplot with gap")
</code></pre>

<hr>
<h2 id='gap.boxplot'>Display a boxplot with a gap (missing range)</h2><span id='topic+gap.boxplot'></span>

<h3>Description</h3>

<p>Displays a boxplot with a missing range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> gap.boxplot(x,...,gap=list(top=c(NA,NA),bottom=c(NA,NA)),
 range=1.5,width=NULL,varwidth=FALSE,notch=FALSE,outline=TRUE,
 names,xlim=NA,ylim=NA,plot=TRUE,border=par("fg"),col=NULL,log="",
 axis.labels=NULL,axes=TRUE,pars=list(boxwex=0.8,staplewex=0.5,outwex=0.5),
 horizontal=FALSE,add=FALSE,at=NULL,main=NULL,xlab="",ylab="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gap.boxplot_+3A_x">x</code></td>
<td>
<p>numeric vector or a list of vectors</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_...">...</code></td>
<td>
<p>arguments passed to <a href="graphics.html#topic+boxplot">boxplot</a>.</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_gap">gap</code></td>
<td>
<p>the range(s) to be omitted - a list with two components,
&lsquo;<span class="samp">&#8288;top&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;bottom&#8288;</span>&rsquo; each specifying a range to omit. The
default range of &lsquo;<span class="samp">&#8288;c(NA,NA)&#8288;</span>&rsquo; means no omitted range</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_range">range</code></td>
<td>
<p>how far to extend the whiskers, (see <a href="graphics.html#topic+boxplot">boxplot</a>)</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_width">width</code></td>
<td>
<p>the relative widths of the boxes</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_varwidth">varwidth</code></td>
<td>
<p>if TRUE, box widths are proportional to the square roots
of the number of observations</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_notch">notch</code></td>
<td>
<p>whether to display the confidence intervals for the
median as notches</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_outline">outline</code></td>
<td>
<p>whether to display outliers</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_names">names</code></td>
<td>
<p>optional names to display beneath each boxplot</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_xlim">xlim</code>, <code id="gap.boxplot_+3A_ylim">ylim</code></td>
<td>
<p>Optional x and y axis limits for the plot.</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_boxwex">boxwex</code></td>
<td>
<p>scale factor for box widths</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_staplewex">staplewex</code></td>
<td>
<p>staple width proportional to box width</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_outwex">outwex</code></td>
<td>
<p>outlier line width</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_plot">plot</code></td>
<td>
<p>dummy argument for consistency with &lsquo;<span class="samp">&#8288;boxplot&#8288;</span>&rsquo; - always
plots</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_border">border</code></td>
<td>
<p>optional color(s) for the box lines</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_col">col</code></td>
<td>
<p>optional color(s) to fill the boxes</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_log">log</code></td>
<td>
<p>whether to use a log scale - currently does nothing</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_axis.labels">axis.labels</code></td>
<td>
<p>Optional axis labels.</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_axes">axes</code></td>
<td>
<p>Whether to display axes.</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_pars">pars</code></td>
<td>
<p>optional parameters for consistency with &lsquo;<span class="samp">&#8288;boxplot&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_horizontal">horizontal</code></td>
<td>
<p>whether to plot horizontal boxplots - currently
does nothing</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_add">add</code></td>
<td>
<p>whether to add the boxplot(s) to an existing plot - currently
does nothing.</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_at">at</code></td>
<td>
<p>optional horizontal locations for the boxplots.</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_main">main</code></td>
<td>
<p>a title for the plot.</p>
</td></tr>
<tr><td><code id="gap.boxplot_+3A_xlab">xlab</code>, <code id="gap.boxplot_+3A_ylab">ylab</code></td>
<td>
<p>X and Y axis labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays boxplot(s) omitting range(s) of values on the top and/or bottom
of the plot. Typically used when there are outliers far from the boxes.
See <a href="graphics.html#topic+boxplot">boxplot</a> for more detailed descriptions of the
arguments. If the gaps specified include any of the values in the &lsquo;<span class="samp">&#8288;stats&#8288;</span>&rsquo;
matrix returned from &lsquo;<span class="samp">&#8288;boxplot&#8288;</span>&rsquo;, the function will exit with an
error message. This prevents generation of NAs in indexing operations,
which would fail anyway. A gap can include part of a box, but it is unlikely 
that this would be intended by the user.
</p>
<p>See <a href="#topic+axis.break">axis.break</a> for a brief discussion 
of plotting on discontinuous coordinates.
</p>


<h3>Value</h3>

<p>A list with the same structure as returned by &lsquo;<span class="samp">&#8288;boxplot&#8288;</span>&rsquo;, except that
the values of elements beyond the gap(s) have their true positions on the
plot rather than the original values. For example, in the second example,
the value returned for the upper staple of the right boxplot is 14 rather
than 20, due to the 6 unit gap.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+gap.barplot">gap.barplot</a>,<a href="#topic+gap.plot">gap.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> twovec&lt;-list(vec1=c(rnorm(30),-6),vec2=c(sample(1:10,40,TRUE),20))
 gap.boxplot(twovec,gap=list(top=c(12,18),bottom=c(-5,-3)),
 main="Show outliers separately")
 if(dev.interactive()) par(ask=TRUE)
 gap.boxplot(twovec,gap=list(top=c(12,18),bottom=c(-5,-3)),range=0,
 main="Include outliers in whiskers")
 par(ask=FALSE)
</code></pre>

<hr>
<h2 id='gap.plot'>Display a plot with one or two gaps (missing ranges) on one axis</h2><span id='topic+gap.plot'></span>

<h3>Description</h3>

<p>Displays a plot with one or two missing ranges on one of the axes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> gap.plot(x,y,gap,gap.axis="y",bgcol="white",breakcol="black",brw=0.02,
  xlim=range(x),ylim=range(y),xticlab,xtics=NA,yticlab,ytics=NA,
  lty=rep(1,length(x)),col=rep(par("col"),length(x)),pch=rep(1,length(x)),
  add=FALSE,stax=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gap.plot_+3A_x">x</code>, <code id="gap.plot_+3A_y">y</code></td>
<td>
<p>data values</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_gap">gap</code></td>
<td>
<p>the range(s) of values to be left out</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_gap.axis">gap.axis</code></td>
<td>
<p>whether the gaps are to be on the x or y axis</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_bgcol">bgcol</code></td>
<td>
<p>the color of the plot background</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_breakcol">breakcol</code></td>
<td>
<p>the color of the &quot;break&quot; marker</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_brw">brw</code></td>
<td>
<p>break width relative to plot width</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_xlim">xlim</code>, <code id="gap.plot_+3A_ylim">ylim</code></td>
<td>
<p>the plot limits.</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_xticlab">xticlab</code></td>
<td>
<p>labels for the x axis ticks</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_xtics">xtics</code></td>
<td>
<p>position of the x axis ticks</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_yticlab">yticlab</code></td>
<td>
<p>labels for the y axis ticks</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_ytics">ytics</code></td>
<td>
<p>position of the y axis ticks</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_lty">lty</code></td>
<td>
<p>line type(s) to use if there are lines</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_col">col</code></td>
<td>
<p>color(s) in which to plot the values</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_pch">pch</code></td>
<td>
<p>symbols to use in plotting.</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_add">add</code></td>
<td>
<p>whether to add values to an existing plot.</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_stax">stax</code></td>
<td>
<p>whether to call staxlab for staggered axis labels.</p>
</td></tr>
<tr><td><code id="gap.plot_+3A_...">...</code></td>
<td>
<p>arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;points&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a plot omitting one or two ranges of values on one axis. 
Typically used when there is a relatively large gap or two in the overall 
range of one set of values, often because of outliers. The function warns
the user if any values may have been omitted by being in the &quot;gap&quot;. See 
<a href="#topic+axis.break">axis.break</a> for a brief discussion of plotting on 
discontinuous coordinates.
</p>
<p>To add more data series to a gap plot, call &lsquo;<span class="samp">&#8288;gap.plot&#8288;</span>&rsquo; with
&lsquo;<span class="samp">&#8288;add = TRUE&#8288;</span>&rsquo;. The same &lsquo;<span class="samp">&#8288;gap&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;gap.axis&#8288;</span>&rsquo; arguments as
in the initial call must be passed or the data will not be displayed
correctly. Remember to pass an explicit &lsquo;<span class="samp">&#8288;xlim&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;ylim&#8288;</span>&rsquo; to
the initial call if the added data exceed the range of the data
initially displayed. Also remember to subtract the width(s) of the gap(s)
if you are passing an explicit &lsquo;<span class="samp">&#8288;xlim&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;ylim&#8288;</span>&rsquo;.
</p>
<p>Because the gaps take up some space, it is possible to have a data value
that is just below a gap plotted in the gap. The answer is to make the lower
gap limit a little higher if this is a problem.
</p>
<p>If at least four values are passed in &lsquo;<span class="samp">&#8288;gap&#8288;</span>&rsquo;, the first four will be
used to calculate two &quot;gaps&quot; in the plot instead of one. The function does
not check whether these values are sensible, so it is quite easy to
ask for a very silly plot.
</p>
<p>The default ticks are usually not ideal, and most users will want to pass
their own tick positions and perhaps labels. Note that &lsquo;<span class="samp">&#8288;lines&#8288;</span>&rsquo; appears
to use only the first &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;lty&#8288;</span>&rsquo; argument value, so if you
must have lines with different colors and types, use &lsquo;<span class="samp">&#8288;add=TRUE&#8288;</span>&rsquo; and add
them separately (see the third example for the problem and the solution).
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon and Ben Bolker (thanks to Zheng Lu for the &quot;add&quot; idea,
and Art Roberts for helping to get the gaps right.)</p>


<h3>See Also</h3>

<p><a href="#topic+gap.barplot">gap.barplot</a>, <a href="#topic+axis.break">axis.break</a>, <a href="#topic+do.first">do.first</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> twogrp&lt;-c(rnorm(5)+4,rnorm(5)+20,rnorm(5)+5,rnorm(5)+22)
 gpcol&lt;-c(2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5)
 gap.plot(twogrp,gap=c(8,16),xlab="Index",ylab="Group values",
  main="Gap on Y axis",col=gpcol)
 gap.plot(twogrp,rnorm(20),gap=c(8,16),gap.axis="x",xlab="X values",
  xtics=c(4,7,17,20),ylab="Y values",main="Gap on X axis with added lines")
 gap.plot(c(seq(3.5,7.5,by=0.5),seq(16.5,22.5,by=0.5)),
  rnorm(22),gap=c(8,16),gap.axis="x",type="l",add=TRUE,col=2,)
 gap.plot(twogrp,gap=c(8,16,25,35),
 xlab="X values",ylab="Y values",xlim=c(1,30),ylim=c(0,42),
 main="Test two gap plot with the lot",xtics=seq(0,30,by=5),
 ytics=c(4,6,18,20,22,38,40,42),
 lty=c(rep(1,10),rep(2,10)),
 pch=c(rep(2,10),rep(3,10)),
 col=c(rep(2,10),rep(3,10)),
 type="b")
 gap.plot(21:30,rnorm(10)+40,gap=c(8,16,25,35),add=TRUE,
  lty=rep(3,10),col=rep(4,10),type="l")
</code></pre>

<hr>
<h2 id='get_axispos3d'> Get axis positions on a 3D plot </h2><span id='topic+get_axispos3d'></span>

<h3>Description</h3>

<p>Calculate the axis positions on a 3D plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> get_axispos3d(edge,pmat,at,pos=NULL, dist=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_axispos3d_+3A_edge">edge</code></td>
<td>
<p> which axis to calculate.</p>
</td></tr>
<tr><td><code id="get_axispos3d_+3A_pmat">pmat</code></td>
<td>
<p> matrix to transform coordinates. </p>
</td></tr>
<tr><td><code id="get_axispos3d_+3A_at">at</code></td>
<td>
<p> position on the axis. </p>
</td></tr>
<tr><td><code id="get_axispos3d_+3A_pos">pos</code></td>
<td>
<p> position of the axis relative to the other axes. </p>
</td></tr>
<tr><td><code id="get_axispos3d_+3A_dist">dist</code></td>
<td>
<p> Offset of the axis. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A position in 2D coordinates</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>

<hr>
<h2 id='get.breaks'>Get the breakpoints for a weighted histogram</h2><span id='topic+get.breaks'></span>

<h3>Description</h3>

<p>Gets the breakpoints for a weighted histogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> get.breaks(x,breaks)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.breaks_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="get.breaks_+3A_breaks">breaks</code></td>
<td>
<p>Either the name of the function to calculate breakpoints, the
number of categories or a vector of breakpoints.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;get.breaks&#8288;</span>&rsquo; either calls the same functions as &lsquo;<span class="samp">&#8288;hist&#8288;</span>&rsquo; to get
breakpoints or calculates a given number or just returns &lsquo;<span class="samp">&#8288;breaks&#8288;</span>&rsquo;
if they are already specified.
</p>


<h3>Value</h3>

<p>A vector of breakpoints.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+hist">hist</a></p>

<hr>
<h2 id='get.gantt.info'>Gather the information to create a Gantt chart</h2><span id='topic+get.gantt.info'></span>

<h3>Description</h3>

<p>Allows the user to enter the information for a Gantt chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> get.gantt.info(format="%Y/%m/%d")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.gantt.info_+3A_format">format</code></td>
<td>
<p>the format to be used in entering dates/times. Defaults to
YYYY/mm/dd. See <a href="base.html#topic+strptime">strptime</a> for various date/time formats.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The list used to create the chart. Elements are:
</p>
<table>
<tr><td><code>labels</code></td>
<td>
<p>The task labels to be displayed at the left of the chart.</p>
</td></tr>
<tr><td><code>starts</code>, <code>ends</code></td>
<td>
<p>The task starts/ends as POSIXct dates/times.</p>
</td></tr>
<tr><td><code>priorities</code></td>
<td>
<p>Task priorities as integers in the range 1 to 10.
There can be less than 10 levels of priority, but if priorities do
not start at 1 (assumed to be the highest), the default priority colors
will be calculated from 1.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+gantt.chart">gantt.chart</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> cat("Enter task times using HH:MM (hour:minute) format\n")
 get.gantt.info("%H:%M")
</code></pre>

<hr>
<h2 id='get.segs'>Calculate the midpoints and limits for a centipede plot</h2><span id='topic+get.segs'></span>

<h3>Description</h3>

<p>Calculates midpoints and limits for a list or data frame for use with
centipede.plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> get.segs(x,mct="mean",lower.limit="std.error",upper.limit=lower.limit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.segs_+3A_x">x</code></td>
<td>
<p>a list or data frame.</p>
</td></tr>
<tr><td><code id="get.segs_+3A_mct">mct</code></td>
<td>
<p>The name of the function to calculate midpoints.</p>
</td></tr>
<tr><td><code id="get.segs_+3A_lower.limit">lower.limit</code>, <code id="get.segs_+3A_upper.limit">upper.limit</code></td>
<td>
<p>The names of the function(s) to calculate 
lower and upper limits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;get.segs&#8288;</span>&rsquo; calls the functions whose names are passed to calculate
midpoints and limits for each list element or data frame column. The
user can define special functions for the central and dispersion measures
if desired.
</p>


<h3>Value</h3>

<p>A matrix with four rows and as many columns as were in the object
&lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;. The first row contains the midpoint values, the second and third
the lower and upper limit values respectively and the fourth row the number
of valid observations in the columns.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+centipede.plot">centipede.plot</a></p>

<hr>
<h2 id='get.soil.texture'>Enter soil texture data</h2><span id='topic+get.soil.texture'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;get.soil.texture&#8288;</span>&rsquo; calls &lsquo;<span class="samp">&#8288;get.triprop&#8288;</span>&rsquo; to allow the user to 
enter soil textures as the proportions or percentages of three 
components, sand, silt and clay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> get.soil.texture(use.percentages=FALSE,cnames=c("sand","silt","clay"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.soil.texture_+3A_use.percentages">use.percentages</code></td>
<td>
<p>Logical - whether to treat the entries as
percentages and scale to proportions.</p>
</td></tr>
<tr><td><code id="get.soil.texture_+3A_cnames">cnames</code></td>
<td>
<p>column names for the resulting three column matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the components of one or more soil samples.</p>


<h3>Author(s)</h3>

<p>Sander Oom and Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+soil.texture">soil.texture</a>,<a href="#topic+get.triprop">get.triprop</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> if(dev.interactive()) {
  newsp&lt;-get.soil.texture()
  # show the soil triangle
  soil.texture()
  # now plot the observations
  show.soil.texture(newsp)
 }
</code></pre>

<hr>
<h2 id='get.tablepos'>Get the position for a legend or table</h2><span id='topic+get.tablepos'></span>

<h3>Description</h3>

<p>Gets the x and y positions and justification for a legend or table in
user units from the string descriptors like &quot;top&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> get.tablepos(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.tablepos_+3A_x">x</code></td>
<td>
<p>A valid position descriptor like &quot;top&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;get.tablepos&#8288;</span>&rsquo; checks for one of the nine valid position descriptors:
</p>
<p>topleft, top, topright, left, center, right, bottomleft, bottom and bottomright.
</p>
<p>If none of these descriptors are found, it will return the center position
and justification.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>x position</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>y position</p>
</td></tr>
<tr><td><code>xjust</code></td>
<td>
<p>x (horizontal) justification</p>
</td></tr>
<tr><td><code>yjust</code></td>
<td>
<p>y (vertical) justification</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+addtable2plot">addtable2plot</a>, <a href="#topic+legendg">legendg</a></p>

<hr>
<h2 id='get.triprop'>Enter three proportion data - usually soil textures</h2><span id='topic+get.triprop'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;get.triprop&#8288;</span>&rsquo; allows the user to enter triplets of proportions
or percentages of three components such as sand, silt and clay in soils.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> get.triprop(use.percentages=FALSE,cnames=c("1st","2nd","3rd"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.triprop_+3A_use.percentages">use.percentages</code></td>
<td>
<p>Logical - whether to treat the entries as
percentages and scale to proportions.</p>
</td></tr>
<tr><td><code id="get.triprop_+3A_cnames">cnames</code></td>
<td>
<p>column names for the resulting three column matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The three proportions of each row must sum to 100 or 1 within 1% or
the function will warn the operator.</p>


<h3>Value</h3>

<p>A matrix of the components of one or more observations.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+triax.plot">triax.plot</a>, <a href="#topic+soil.texture">soil.texture</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> if(dev.interactive()) {
  # get some proportions
  newsp&lt;-get.triprop()
  # show the triangle
  triax.frame(main="Test triax.plot")
  # now plot the observations
  triax.points(newsp)
 }
</code></pre>

<hr>
<h2 id='getFigCtr'>Get coordinates in the figure region in user units.</h2><span id='topic+getFigCtr'></span>

<h3>Description</h3>

<p>Calculates the coordinates of a proportional point of the figure
region in user units.</p>


<h3>Usage</h3>

<pre><code class='language-R'> getFigCtr(pos=c(0.5,0.5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getFigCtr_+3A_pos">pos</code></td>
<td>
<p>The proportion of the figure region to find (see Details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;getFigCtr&#8288;</span>&rsquo; reads parameters about the current plot and calculates the
vertical and horizontal centers of the figure region by default. This is 
typically useful for placing a centered title on plots where the left and
right margins are very different.
</p>
<p>By changing &lsquo;<span class="samp">&#8288;pos&#8288;</span>&rsquo;, any proportional points of the figure region can be
returned. For example, &lsquo;<span class="samp">&#8288;pos=c(0,0)&#8288;</span>&rsquo; will return the left and bottom
coordinates of the figure region.
</p>


<h3>Value</h3>

<p>A two element vector containing the coordinates of the center of the
figure region in user units.</p>


<h3>Author(s)</h3>

<p>Jim Lemon (thanks to Karl Brand for the adjustable coordinates)</p>

<hr>
<h2 id='getIntersectList'>Enter a set intersection list</h2><span id='topic+getIntersectList'></span>

<h3>Description</h3>

<p>Enter the information for a set intersection display.</p>


<h3>Usage</h3>

<pre><code class='language-R'> getIntersectList(nelem,xnames=NULL,sep="+")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getIntersectList_+3A_nelem">nelem</code></td>
<td>
<p>The number of sets for which the intersections will be displayed.</p>
</td></tr>
<tr><td><code id="getIntersectList_+3A_xnames">xnames</code></td>
<td>
<p>The labels for the set intersections. The function creates names
from combinations of the first &lsquo;<span class="samp">&#8288;nelem&#8288;</span>&rsquo; capital letters if none are 
given.</p>
</td></tr>
<tr><td><code id="getIntersectList_+3A_sep">sep</code></td>
<td>
<p>The separator to use when calling &lsquo;<span class="samp">&#8288;paste&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;getIntersectList&#8288;</span>&rsquo; allows the user to manually enter the counts of
set intersections rather than build this information from a matrix of data.
It is probably most useful for producing an intersection diagram when the
counts of the intersections are already known, or when the values are
proportions rather than counts as in the example.
</p>
<p>It is very helpful when there are large numbers of elements, as the
&lsquo;<span class="samp">&#8288;makeIntersectList&#8288;</span>&rsquo; function runs very slowly.
</p>


<h3>Value</h3>

<p>A list of the counts of elements in the set intersections.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+makeIntersectList">makeIntersectList</a>, <a href="#topic+intersectDiagram">intersectDiagram</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # this example is from a haplotype mapping problem submitted by Mao Jianfeng
 ## Not run: 
 hapIntList&lt;-
  getIntersectList(3,xnames=c("hap.Pd","hap.Pt","hap.Py"))
 # enter the data as follows:
 # Number of elements in hap.Pd - 1: 27.586
 # Number of elements in hap.Pt - 1: 20.689
 # Number of elements in hap.Py - 1: 31.035
 # Number of elements in hap.Pd-hap.Pt - 1: 10.345
 # Number of elements in hap.Pd-hap.Py - 1: 10.345
 # Number of elements in hap.Pt-hap.Py - 1: 0
 # Number of elements in hap.Pd-hap.Pt-hap.Py - 1: 0
 # Total number of elements - 1: 100
 
## End(Not run)
 hapIntList&lt;-structure(list(structure(c(27.586, 20.689, 31.035),
  .Names = c("hap.Pd","hap.Pt","hap.Py")),
  structure(c(10.345, 10.345, 0),
  .Names = c("hap.Pd-hap.Pt","hap.Pd-hap.Py","hap.Pt-hap.Py")),
  structure(0, .Names = "hap.Pd-hap.Pt-hap.Py"),100),
  class = "intersectList")
 intersectDiagram(hapIntList)
</code></pre>

<hr>
<h2 id='getMarginWidth'>Find the margin width necessary to fit text or a legend next to a plot</h2><span id='topic+getMarginWidth'></span>

<h3>Description</h3>

<p>Calculates the margin width necessary to fit text or a legend next to a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> getMarginWidth(side=4,labels,is.legend=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMarginWidth_+3A_side">side</code></td>
<td>
<p>Which side of the plot (as in axis).</p>
</td></tr>
<tr><td><code id="getMarginWidth_+3A_labels">labels</code></td>
<td>
<p>The text to place next to the plot.</p>
</td></tr>
<tr><td><code id="getMarginWidth_+3A_is.legend">is.legend</code></td>
<td>
<p>Whether the text is in a legend or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;getMarginWidth&#8288;</span>&rsquo; reads parameters about the current plot and calculates the
left or right (default) margin necessary to fit the strings passed as 
&lsquo;<span class="samp">&#8288;labels&#8288;</span>&rsquo; or a legend containing those strings.
</p>


<h3>Value</h3>

<p>A two element list containing the number of margin lines necessary to
fit the text or legend and the horizontal center of the margin in user units.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(rnorm(10))
 newmarinfo&lt;-getMarginWidth(labels=c("Long label","Even longer label"))
 oldmar&lt;-par("mar")
 par(mar=c(oldmar[1:3],newmarinfo$newmar))
 plot(rnorm(10))
 par(xpd=TRUE)
 text(rep(newmarinfo$marcenter,2),c(0.5,-0.5),
  c("Long label","Even longer label"))
 par(mar=oldmar,xpd=FALSE)
</code></pre>

<hr>
<h2 id='getYmult'>Correct for aspect and coordinate ratio</h2><span id='topic+getYmult'></span>

<h3>Description</h3>

<p>Calculate a multiplication factor for the Y dimension to correct
for unequal plot aspect and coordinate ratios on the current graphics device.</p>


<h3>Usage</h3>

<pre><code class='language-R'> getYmult()
</code></pre>


<h3>Details</h3>

  
<p>&lsquo;<span class="samp">&#8288;getYmult&#8288;</span>&rsquo; retrieves the plot aspect ratio and the coordinate ratio for
the current graphics device, calculates a multiplicative factor to equalize
the X and Y dimensions of a plotted graphic object.
</p>


<h3>Value</h3>

<p>The correction factor for the Y dimension.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+draw.circle">draw.circle</a></p>

<hr>
<h2 id='gradient.rect'>Display a rectangle filled with an arbitrary color gradient</h2><span id='topic+gradient.rect'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;gradient.rect&#8288;</span>&rsquo; draws a rectangle consisting of &lsquo;<span class="samp">&#8288;nslices&#8288;</span>&rsquo;
subrectangles of the colors in &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; or those returned by 
&lsquo;<span class="samp">&#8288;color.gradient&#8288;</span>&rsquo; if &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; is NULL. The rectangle is
'sliced' in the direction specified by &lsquo;<span class="samp">&#8288;gradient&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> gradient.rect(xleft,ybottom,xright,ytop,reds,greens,blues,col=NULL,
  nslices=50,gradient="x",border=par("fg"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gradient.rect_+3A_xleft">xleft</code>, <code id="gradient.rect_+3A_ybottom">ybottom</code>, <code id="gradient.rect_+3A_xright">xright</code>, <code id="gradient.rect_+3A_ytop">ytop</code></td>
<td>
<p>Positions of the relevant corners
of the desired rectangle, as in &lsquo;<span class="samp">&#8288;rect&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="gradient.rect_+3A_reds">reds</code>, <code id="gradient.rect_+3A_greens">greens</code>, <code id="gradient.rect_+3A_blues">blues</code></td>
<td>
<p>vectors of the values of the color components
either as 0 to 1 or ,if any value is greater than 1, 0 to 255.</p>
</td></tr>
<tr><td><code id="gradient.rect_+3A_col">col</code></td>
<td>
<p>Vector of colors. If supplied, this takes precedence over
&lsquo;<span class="samp">&#8288;reds, greens, blues&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;nslices&#8288;</span>&rsquo; will be set to its length.</p>
</td></tr>
<tr><td><code id="gradient.rect_+3A_nslices">nslices</code></td>
<td>
<p>The number of sub-rectangles that will be drawn.</p>
</td></tr>
<tr><td><code id="gradient.rect_+3A_gradient">gradient</code></td>
<td>
<p>whether the gradient should be horizontal (x) or vertical.</p>
</td></tr>
<tr><td><code id="gradient.rect_+3A_border">border</code></td>
<td>
<p>The color of the border around the rectangle (NA for none).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the vector of hexadecimal color values from &lsquo;<span class="samp">&#8288;color.gradient&#8288;</span>&rsquo; or
&lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo;.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>Examples</h3>

<pre><code class='language-R'> # get an empty box
 plot(0:10,type="n",axes=FALSE)
 # run across the three primaries
 gradient.rect(1,0,3,6,reds=c(1,0),
  greens=c(seq(0,1,length=10),seq(1,0,length=10)),
  blues=c(0,1),gradient="y")
 # now a "danger gradient"
 gradient.rect(4,0,6,6,c(seq(0,1,length=10),rep(1,10)),
  c(rep(1,10),seq(1,0,length=10)),c(0,0),gradient="y")
 # now just a smooth gradient across the bar
 gradient.rect(7,0,9,6,col=smoothColors("red",38,"blue"),border=NA)
</code></pre>

<hr>
<h2 id='hexagon'>Draw a hexagon</h2><span id='topic+hexagon'></span>

<h3>Description</h3>

<p>Draws a hexagon on the current graphic device
</p>


<h3>Usage</h3>

<pre><code class='language-R'> hexagon(x,y,unitcell=1,col=NA,border="black")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hexagon_+3A_x">x</code>, <code id="hexagon_+3A_y">y</code></td>
<td>
<p>x and y position of the bottom left corner of the square that
would pack into the same space as the hexagon.</p>
</td></tr>
<tr><td><code id="hexagon_+3A_unitcell">unitcell</code></td>
<td>
<p>The dimension of the side of the abovementioned square.</p>
</td></tr>
<tr><td><code id="hexagon_+3A_col">col</code></td>
<td>
<p>The color to fill the hexagon - default is no fill.</p>
</td></tr>
<tr><td><code id="hexagon_+3A_border">border</code></td>
<td>
<p>The color of the perimeter of the hexagon.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>Draws a hexagon with the same center as a square that would pack into the
same dimensions as the hexagon. That is, given a grid of squares with
alternate rows shifted one half the length of the sides, the hexagons
drawn would be close packed. Its use in the plotrix package is to provide
an alternative unit cell for the &lsquo;<span class="samp">&#8288;color2D.matplot&#8288;</span>&rsquo; function.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+color2D.matplot">color2D.matplot</a></p>

<hr>
<h2 id='histStack'>Histogram &quot;stacked&quot; by categories</h2><span id='topic+histStack'></span><span id='topic+histStack.formula'></span><span id='topic+histStack.default'></span>

<h3>Description</h3>

<p>Histogram of a quantitative variable with bars that are &quot;stacked&quot; by the
values of a factor variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> histStack(x,...)

 ## S3 method for class 'formula'
histStack(x,data,breaks="Sturges",col="rainbow",
  right=TRUE,main="",xlab=NULL,legend.pos=NULL,cex.legend=0.75,...)

 ## Default S3 method:
histStack(x,z,breaks="Sturges",col="rainbow",
  right=TRUE,main="",xlab=NULL,legend.pos=NULL,cex.legend=0.75,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="histStack_+3A_x">x</code></td>
<td>
<p>A vector of quantitative data or a formula of the form x~z
(see z below).</p>
</td></tr>
<tr><td><code id="histStack_+3A_z">z</code></td>
<td>
<p>A vector of categorical data (a factor) that will define the
&ldquo;stacks&rdquo;.</p>
</td></tr>
<tr><td><code id="histStack_+3A_data">data</code></td>
<td>
<p>A data frame that contains both x and z.</p>
</td></tr>
<tr><td><code id="histStack_+3A_breaks">breaks</code></td>
<td>
<p>Breaks to use in categorizing values of x.</p>
</td></tr>
<tr><td><code id="histStack_+3A_col">col</code></td>
<td>
<p>Either a vector of colors in any legitimate form or a
character string that specifies a function that requires only the length
of the vector as an argument and will return a vector of colors with that
length. (see Details)</p>
</td></tr>
<tr><td><code id="histStack_+3A_right">right</code></td>
<td>
<p>A logical that indicates whether the bins are right-open
(left-closed; =TRUE) or right-closed (left-open; =FALSE; default).</p>
</td></tr>
<tr><td><code id="histStack_+3A_main">main</code></td>
<td>
<p>A character string that forms the main title for the plot.</p>
</td></tr>
<tr><td><code id="histStack_+3A_xlab">xlab</code></td>
<td>
<p>A character string for labeling the x-axis.</p>
</td></tr>
<tr><td><code id="histStack_+3A_legend.pos">legend.pos</code></td>
<td>
<p>A character string or two numeric values indicating the
position for the stacking legend.</p>
</td></tr>
<tr><td><code id="histStack_+3A_cex.legend">cex.legend</code></td>
<td>
<p>A numeric character expansion value for the legend.
Values less than 1 will make the legend smaller.</p>
</td></tr>
<tr><td><code id="histStack_+3A_...">...</code></td>
<td>
<p>Additional arguments sent to the hist function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;histStack&#8288;</span>&rsquo; displays a &ldquo;stacked histogram&rdquo; while using many of
the same arguments as hist(). The argument &lsquo;<span class="samp">&#8288;z&#8288;</span>&rsquo; will be converted to a
factor with a warning if it is not already a factor.
</p>
<p>The color functions in <span class="pkg">grDevices</span> (e.g. &quot;gray.colors&quot;) should always
be valid when passed as the &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; argument. Any function that will
return a vector of &lsquo;<span class="samp">&#8288;n&#8288;</span>&rsquo; colors when called with a single argument
&lsquo;<span class="samp">&#8288;n&#8288;</span>&rsquo; and that exists in the current environment should work. An error
will occur if length(col)==1 and the value is not a function as described
for &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; (e.g., &lsquo;<span class="samp">&#8288;col="blue"&#8288;</span>&rsquo; will result in an error).If fewer
colors than levels of &lsquo;<span class="samp">&#8288;z&#8288;</span>&rsquo; are passed, they will be recycled.
</p>


<h3>Value</h3>

<p>nil. A plot is displayed.</p>


<h3>Note</h3>

<p>This function is currently experimental.
</p>


<h3>Author(s)</h3>

<p>Derek Ogle with modifications by Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+hist">hist</a>, <a href="graphics.html#topic+legend">legend</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(409)
 df&lt;-data.frame(len=rnorm(100)+5,
  grp=sample(c("A","B","C","D"),100,replace=TRUE))
 histStack(len~grp,data=df,main="Default (rainbow) colors",
  xlab="Length category")
 histStack(len~grp,data=df,col="heat.colors",main="Heat colors",
  xlab="Length category",legend.pos="topright")
 histStack(len~grp,data=df,col=2:5,main="Colors by number",
  xlab="Length category",legend.pos=c(2.8,18))
</code></pre>

<hr>
<h2 id='intersectDiagram'>Display set intersections</h2><span id='topic+intersectDiagram'></span>

<h3>Description</h3>

<p>Display set intersections as rows of rectangles.</p>


<h3>Usage</h3>

<pre><code class='language-R'> intersectDiagram(x,pct=FALSE,show.nulls=FALSE,xnames=NULL,sep="+",
  mar=c(0,0,3,0),main="Intersection Diagram",cex=1,col=NULL,
  minspacing=NA,all.intersections=FALSE,include=NULL,null.label="Non-set")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intersectDiagram_+3A_x">x</code></td>
<td>
<p>A list containing as many numeric vectors as there are sets. The
first vector contains the counts or percentages of the elements that are
only in one set, the next vector contains the counts or percentages of 
elements that are in two sets and so on. A matrix of set membership
indicators or a two column matrix of object identifiers and attribute
identifiers can be passed - see Details.</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_pct">pct</code></td>
<td>
<p>Whether to display counts (FALSE) or percentages (TRUE) of the
number of entities.</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_show.nulls">show.nulls</code></td>
<td>
<p>Whether to display the number of original objects that 
are not members of any set. Any value that is not NA will become the 
label for this category.</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_xnames">xnames</code></td>
<td>
<p>Optional user supplied names for the set categories (see
Details).</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_sep">sep</code></td>
<td>
<p>The separator to use between category names (see Details).</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_mar">mar</code></td>
<td>
<p>The margins for the diagram. The margins that were in effect when
the function is called are restored.</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_main">main</code></td>
<td>
<p>The title for the diagram.</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_col">col</code></td>
<td>
<p>Colors for the sets (see Details).</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_cex">cex</code></td>
<td>
<p>Character expansion for the intersection labels.</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_minspacing">minspacing</code></td>
<td>
<p>The minimum spacing between the rectangles (see Details).</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_all.intersections">all.intersections</code></td>
<td>
<p>Whether to display all intersections, even if empty
(Dangerous - see Detail).</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_include">include</code></td>
<td>
<p>Which set identifiers to include in the diagram (see Details).</p>
</td></tr>
<tr><td><code id="intersectDiagram_+3A_null.label">null.label</code></td>
<td>
<p>The label for the non-set entities if displayed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;intersectDiagram&#8288;</span>&rsquo; displays rows of optionally colored rectangles that
represent the intersections of set memberships (attributes) of a set of objects.
The topmost row represents the intersections of the fewest sets, and
succeeding rows represent the intersections of more sets. If there were objects
in the original data set that were not members of any set, any percentages
calculated will reflect this. By setting &lsquo;<span class="samp">&#8288;show.nulls&#8288;</span>&rsquo; to TRUE, the counts
or percentages of such objects will be displayed below the intersections over
an empty rectangle scaled to the count or percentage.
</p>
<p>Important - If the &lsquo;<span class="samp">&#8288;all.intersections&#8288;</span>&rsquo; argument is TRUE, all intersections
will be displayed, whether empty or not (see the example). This is mostly for
demonstration purposes, and if the number of sets is large, is likely to produce
a very messy diagram. Similarly, sets with large numbers of
intersections that are populated will require very large displays to be readable,
even if there are small numbers in the intersections. If you would like to see
this in action, pass the data frame &lsquo;<span class="samp">&#8288;setdf&#8288;</span>&rsquo; in the <a href="#topic+categoryReshape">categoryReshape</a>
example to &lsquo;<span class="samp">&#8288;intersectDiagram&#8288;</span>&rsquo; with &lsquo;<span class="samp">&#8288;all.intersections&#8288;</span>&rsquo; TRUE.
</p>
<p>&lsquo;<span class="samp">&#8288;intersectDiagram&#8288;</span>&rsquo; does not attempt to display the set intersections as
a pattern of overlapping geometric figures, but rather the relative numbers of
objects sharing each intersection. More than three intersecting sets generally
produce a complex and difficult to interpret Venn diagram, and this provides an
alternative way to display the size of intersections between larger numbers
of sets.
</p>
<p>&lsquo;<span class="samp">&#8288;intersectDiagram&#8288;</span>&rsquo; now allows the user to display only part of the 
set intersections, which is useful for analyzing very complex intersections.
This is controlled by the &lsquo;<span class="samp">&#8288;include&#8288;</span>&rsquo; argument. This defaults to all sets or 
attributes when &lsquo;<span class="samp">&#8288;include=NULL&#8288;</span>&rsquo;. If one or more of the labels of the sets or 
attributes is passed, only the intersections containing those labels will be 
displayed. See examples 2 and 3 below.
</p>
<p>Each set (attribute) is assigned a color if &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; is not NA. &lsquo;<span class="samp">&#8288;rainbow&#8288;</span>&rsquo;
is called if &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; is NULL, otherwise the colors passed are used. For each
intersection, the colors representing the sets intersecting are included in
the rectangle.
</p>
<p>The strings displayed on each rectangle are taken from the argument
&lsquo;<span class="samp">&#8288;xnames&#8288;</span>&rsquo; unless that is NULL, then the &lsquo;<span class="samp">&#8288;names&#8288;</span>&rsquo; of the intersectList
object passed as &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; or returned from the call to &lsquo;<span class="samp">&#8288;makeIntersectList&#8288;</span>&rsquo;.
</p>
<p>If a matrix or data frame of set membership indicators is passed as &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;,
it will be passed to <a href="#topic+makeIntersectList">makeIntersectList</a> for conversion. Each column must
represent a set, and the values in the columns must be 0 or 1, or FALSE or TRUE.
Similarly, if a matrix or data frame in which the first column is object
identifiers and the second column is attributes, this will be passed to
&lsquo;<span class="samp">&#8288;makeIntersectList&#8288;</span>&rsquo;.
</p>
<p>The spacing between the largest rectangles is controlled by &lsquo;<span class="samp">&#8288;minspacing&#8288;</span>&rsquo;.
&lsquo;<span class="samp">&#8288;minspacing&#8288;</span>&rsquo; is in units of object counts and defaults to 0.1 times the
largest number of objects in an intersection. When the number of objects in
different intersections at a given level varies widely, the labels of
intersections with few objects may overlap if they are wide relative to the
rectangle representing the number of objects. This can be corrected by
passing a &lsquo;<span class="samp">&#8288;minspacing&#8288;</span>&rsquo; argument that will increase the space between
rectangles and/or decreasing the character size of the labels. If the labels
for each set are relatively long, setting &lsquo;<span class="samp">&#8288;namesep="\n"&#8288;</span>&rsquo; may help. Note 
that if a different separator is passed, that separator must be explicitly
passed in any subsequent calls using the same &lsquo;<span class="samp">&#8288;intersectList&#8288;</span>&rsquo; object - see
examples 1 to 3 below.
</p>


<h3>Value</h3>

<p>Returns the intersectionList object invisibly.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+makeIntersectList">makeIntersectList</a>, <a href="#topic+getIntersectList">getIntersectList</a>, <a href="#topic+categoryReshape">categoryReshape</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # create a matrix where each row represents an element and
 # a 1 (or TRUE) in each column indicates that the element is a member
 # of that set.
 druguse&lt;-matrix(c(sample(c(0,1),200,TRUE,prob=c(0.15,0.85)),
  sample(c(0,1),200,TRUE,prob=c(0.35,0.65)),
  sample(c(0,1),200,TRUE,prob=c(0.5,0.5)),
  sample(c(0,1),200,TRUE,prob=c(0.9,0.1))),ncol=4)
 colnames(druguse)&lt;-c("Alc","Tob","THC","Amp")
 druglist&lt;-makeIntersectList(druguse,sep="\n")
 # first display it as counts
 intersectDiagram(druglist,main="Patterns of drug use",sep="\n")
 # then display only the intersections containing "Alc"
 intersectDiagram(druglist,main="Patterns of drug use (Alcohol users only)",
  sep="\n",include="alc")
 # now display only the intersections containing "Amp"
 intersectDiagram(druglist,main="Patterns of drug use (Speed users only)",
  sep="\n",include="amp")
 # then as percent with non.members, passing the initial matrix
 intersectDiagram(druguse,pct=TRUE,show.nulls=TRUE)
 # alter the data to have more multiple intersections
 druguse[which(as.logical(druguse[,1]))[1:40],2]&lt;-1
 druguse[which(as.logical(druguse[,1]))[31:70],3]&lt;-1
 druguse[,4]&lt;-sample(c(0,1),200,TRUE,prob=c(0.9,0.1))
 intersectDiagram(druguse,main="Smaller font in labels",
  col=c("gray20","gray40","gray60","gray80"),cex=0.8)
 # transform the spacing - usually makes it too close, first try minspacing
 intersectDiagram(druguse,col="gray",main="Minimum spacing = 30 cases",
  minspacing=30)
 # then try cex - may need both for large differences
 intersectDiagram(druguse,main="Very boring single color",col="gray",cex=0.8)
 # create a matrix with empty intersections
 druguse&lt;-matrix(c(sample(c(0,1),20,TRUE),
  sample(c(0,1),20,TRUE),
  sample(c(0,1),20,TRUE),
  sample(c(0,1),20,TRUE)),ncol=4)
 # show only the populated intersections
 intersectDiagram(druguse,main="Display only populated intersections")
 # show all intersections
 intersectDiagram(druguse,main="Display empty intersections",all.intersections=TRUE)
</code></pre>

<hr>
<h2 id='jiggle'> Calculate equally spaced values within a range. </h2><span id='topic+jiggle'></span>

<h3>Description</h3>

<p>Calculates a specified number of equally spaced values in a range
</p>


<h3>Usage</h3>

<pre><code class='language-R'> jiggle(n,range=c(-1,1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jiggle_+3A_n">n</code></td>
<td>
<p>The number of values to calculate.</p>
</td></tr>
<tr><td><code id="jiggle_+3A_range">range</code></td>
<td>
<p>The range within which to fit the values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;jiggle&#8288;</span>&rsquo; is an alternative to the &lsquo;<span class="samp">&#8288;jitter&#8288;</span>&rsquo; function. Instead
of using &lsquo;<span class="samp">&#8288;runif&#8288;</span>&rsquo; to provide the values, it calls &lsquo;<span class="samp">&#8288;sample&#8288;</span>&rsquo;
and then scales the resulting values to the range specified. This
guarantees that the values will be evenly spaced.
</p>


<h3>Value</h3>

<p> A vector of n values within the range specified. </p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>Examples</h3>

<pre><code class='language-R'> ahw.df&lt;-data.frame(Age=rnorm(100,35,10),
  Height=rnorm(100,160,15),Weight=rnorm(100,75,20))
 par(mfrow=c(1,3))
 boxplot(ahw.df$Age,main="Age")
 points(jiggle(100,c(0.5,1.5)),ahw.df$Age,col="red")
 boxplot(ahw.df$Height,main="Height")
 points(jiggle(100,c(0.5,1.5)),ahw.df$Height,col="green")
 boxplot(ahw.df$Weight,main="Weight")
 points(jiggle(100,c(0.5,1.5)),ahw.df$Weight,col="blue")
</code></pre>

<hr>
<h2 id='joyPlot'>Display a series of density curves.</h2><span id='topic+joyPlot'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;joyPlot&#8288;</span>&rsquo; displays a matrix of density curves or other two
component lists whose names are &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;. The labels for 
each line/polygon are displayed on the left axis of the plot. 
The labels default to the names of the components of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; if these 
are present.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> joyPlot(x,mar=c(5,4,4,2),newrange=c(0,1),border=NA,fill=NULL,
 main="",xlab="",ylab="",xlim=NA,line_labels=names(x),xat=NULL,
 xaxlab=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="joyPlot_+3A_x">x</code></td>
<td>
<p>A list of density curves or other objects with x and y values.</p>
</td></tr>
<tr><td><code id="joyPlot_+3A_mar">mar</code></td>
<td>
<p>Margins for the plot.</p>
</td></tr>
<tr><td><code id="joyPlot_+3A_newrange">newrange</code></td>
<td>
<p>Passed to &lsquo;<span class="samp">&#8288;rescale&#8288;</span>&rsquo; to scale the values to fit the
bands on the plot. See Details.</p>
</td></tr>
<tr><td><code id="joyPlot_+3A_border">border</code></td>
<td>
<p>The border colors for the polygons.</p>
</td></tr>
<tr><td><code id="joyPlot_+3A_fill">fill</code></td>
<td>
<p>Optional fill colors for the polygons.</p>
</td></tr>
<tr><td><code id="joyPlot_+3A_main">main</code></td>
<td>
<p>Text for the title for the plot.</p>
</td></tr>
<tr><td><code id="joyPlot_+3A_xlab">xlab</code>, <code id="joyPlot_+3A_ylab">ylab</code></td>
<td>
<p>The x and y axis labels.</p>
</td></tr>
<tr><td><code id="joyPlot_+3A_xlim">xlim</code></td>
<td>
<p>Optional limit for the x axis as &lsquo;<span class="samp">&#8288;density&#8288;</span>&rsquo; returns
values outside the range of the values in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="joyPlot_+3A_line_labels">line_labels</code></td>
<td>
<p>Labels for the lines/polygons dieplayed.</p>
</td></tr>
<tr><td><code id="joyPlot_+3A_xat">xat</code></td>
<td>
<p>Optional custom x tick positions.</p>
</td></tr>
<tr><td><code id="joyPlot_+3A_xaxlab">xaxlab</code></td>
<td>
<p>Optional custom x tick labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The density curves or other x/y lists will be scaled so that the largest
will fit into the one user unit band allocated for each curve by default.
If the second value of &lsquo;<span class="samp">&#8288;newrange&#8288;</span>&rsquo; is changed, the heights of the 
curves will change proportionately. See the third exampls.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a>, <a href="#topic+stackpoly">stackpoly</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x1&lt;-c(sample(20:50,20),sample(40:80,30))
 x2&lt;-c(sample(10:40,30),sample(50:90,30))
 x3&lt;-sample(20:90,50)
 xdens1&lt;-density(x1)
 xdens2&lt;-density(x2)
 xdens3&lt;-density(x3)
 joyPlot(list(xdens1,xdens2,xdens3),main="joyPlot with lines",
  xlab="Position",xlim=c(0,100))
 xlist&lt;-list(first=xdens1,second=xdens2,third=xdens3)
 joyPlot(xlist,main="joyPlot with polygons",xlab="Position",
  fill=c("#ffcccc","#ccffcc","#ccccff"),xlim=c(0,100))
 joyPlot(xlist,main="joyPlot with overlapping polygons",
  fill=c("#ffcccc","#ccffcc","#ccccff"),xlim=c(0,100),
  newrange=c(0,1.5),xlab="Position")
</code></pre>

<hr>
<h2 id='kiteChart'> Magnitude by position chart. </h2><span id='topic+kiteChart'></span>

<h3>Description</h3>

<p>Display numeric values as the widths of a polygon along a dimension such as time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> kiteChart(x,xlim=NA,ylim=NA,timex=TRUE,main="Kite chart",
 xlab=ifelse(timex,"Time","Groups"),ylab=ifelse(timex,"Groups","Time"),
 border=par("fg"),col=NULL,varpos=NA,varlabels=NA,varscale=FALSE,
 timepos=NA,timelabels=NA,mar=c(5,4,4,4),axlab=c(1,2,3,4),
 normalize=FALSE,shownorm=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kiteChart_+3A_x">x</code></td>
<td>
<p>Numeric matrix or data frame</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_xlim">xlim</code></td>
<td>
<p>Horizontal extent of the chart. Defaults to 1:dim(x)[2].</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_ylim">ylim</code></td>
<td>
<p>Vertical extent of the chart. Defaults to 0.5:dim(x)[1]+0.5.</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_timex">timex</code></td>
<td>
<p>Whether the &quot;time&quot; axis is x (horizontal) or not.</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_main">main</code>, <code id="kiteChart_+3A_xlab">xlab</code>, <code id="kiteChart_+3A_ylab">ylab</code></td>
<td>
<p>As in &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_border">border</code></td>
<td>
<p>The border color(s) for the polygons.</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_col">col</code></td>
<td>
<p>The fill colors for the polygons.</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_varpos">varpos</code></td>
<td>
<p>Optional positions for the &quot;kite lines&quot;. Defaults to 1:dimx[1].
(see Details)</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_varlabels">varlabels</code></td>
<td>
<p>Labels for the rows of values - defaults to the rownames,
or if these are missing, varpos[1:dim(x)[1]].</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_varscale">varscale</code></td>
<td>
<p>Whether to show the maximum extent of each &quot;kite line&quot;.</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_timepos">timepos</code></td>
<td>
<p>The positions of the values along the x axis, usually times,
defaulting to 1:dim(x)[2].</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_timelabels">timelabels</code></td>
<td>
<p>Labels for the positions, defaulting to &lsquo;<span class="samp">&#8288;timepos&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_mar">mar</code></td>
<td>
<p>Plot margins. These leave space for the normalization multipliers
on the right or top side (see Details).</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_axlab">axlab</code></td>
<td>
<p>Where to put axis tick labels and multipliers. See Details.</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_normalize">normalize</code></td>
<td>
<p>Whether to scale each row of values to a maximum width of 1.</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_shownorm">shownorm</code></td>
<td>
<p>Whether to display the normalization multipliers.</p>
</td></tr>
<tr><td><code id="kiteChart_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;kiteChart&#8288;</span>&rsquo; displays each row of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; as a sequence of widths, allowing
the relationships between those values and the dimension along which they occur
(usually time) to be illustrated.
</p>
<p>The values in x are scaled to a maximum polygon width of 1 if &lsquo;<span class="samp">&#8288;normalize&#8288;</span>&rsquo;
is TRUE. This is to avoid overlapping of the polygons. There may be some cases
where the values can be displayed directly. If normalized, the multipliers will
be displayed for each row on the right or top side of the chart unless &lsquo;<span class="samp">&#8288;shownorm&#8288;</span>&rsquo;
is FALSE. Remember to specify the &lsquo;<span class="samp">&#8288;mar&#8288;</span>&rsquo; argument if more space at the top
is needed.
</p>
<p>The &lsquo;<span class="samp">&#8288;axlab&#8288;</span>&rsquo; argument allows the user to place the axis tick labels and
normalization multipliers on different axes. The default places the tick labels
on the bottom and left sides of the plot and the multipliers on the right or top.
Using &lsquo;<span class="samp">&#8288;axlab=c(3,4,1,2)&#8288;</span>&rsquo; places the tick labels on the top and right and the 
multipliers on the left or bottom. The &lsquo;<span class="samp">&#8288;mar&#8288;</span>&rsquo; argument may have to be adjusted.
</p>
<p>The user can display raw values by default, or by setting &lsquo;<span class="samp">&#8288;varpos&#8288;</span>&rsquo; to TRUE.
Setting &lsquo;<span class="samp">&#8288;varpos&#8288;</span>&rsquo; to a vector of positions will place the &quot;kite lines&quot; on those
values. If there are no row names and the &lsquo;<span class="samp">&#8288;varlabels&#8288;</span>&rsquo; argument is NA, the values
of &lsquo;<span class="samp">&#8288;varpos&#8288;</span>&rsquo; will be used as labels for each &quot;kite line&quot;. The maximum extent of
each &quot;kite line&quot; can be displayed by setting &lsquo;<span class="samp">&#8288;varscale&#8288;</span>&rsquo; to TRUE. If
&lsquo;<span class="samp">&#8288;varscale&#8288;</span>&rsquo; is TRUE, one extra line will be added to the top margin. If
&lsquo;<span class="samp">&#8288;varpos[1]&#8288;</span>&rsquo; is not NA, &lsquo;<span class="samp">&#8288;normalize&#8288;</span>&rsquo; is FALSE by default.
</p>


<h3>Value</h3>

<p>The values of &lsquo;<span class="samp">&#8288;mar&#8288;</span>&rsquo; that were current when &lsquo;<span class="samp">&#8288;kiteChart&#8288;</span>&rsquo; was called.</p>


<h3>Author(s)</h3>

<p>Jim Lemon (Thanks to Michael Bedward for suggestions on the arguments and
Nikolaus Lampadariou for the suggestions on displaying raw values)</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+polygon">polygon</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> testmat&lt;-matrix(c(runif(50),sample(1:50,50),rnorm(50)+5,
  sin(1:50)),ncol=50,byrow=TRUE)
 kiteChart(testmat,varlabels=c("Uniform","Sample","Normal","Sine"),
  timepos=seq(1,50,by=5),timex=FALSE)
 # not enough space for the last label, add it
 mtext("Sine",at=65,side=1,line=2)
 # now show it with kite line maxima
 kiteChart(testmat,varlabels=c("Uniform","Sample","Normal","Sine"),
  timepos=seq(1,50,by=5),timex=FALSE,varscale=TRUE)
 mtext("Sine",at=65,side=1,line=2)
 musicmat&lt;-matrix(c(c(0.5,0.4,0.3,0.25,0.2,0.15,0.1,rep(0.05,44))+runif(51,0,0.05),
  c(0.1,0.2,0.3,0.35,0.4,0.5,0.4,rep(0.5,14),rep(0.4,15),rep(0.3,15))+runif(51,0,0.1),
  rep(0.15,51)+runif(51,0,0.1),
  c(rep(0,29),c(0.1,0.2,0.4,0.5,0.3,0.2,rep(0.05,16))+runif(22,0,0.05)),
  c(rep(0,38),c(rep(0.05,6),0.08,0.15,0.20,0.25,0.2,0.25,0.3)+runif(13,0,0.05))),
  ncol=51,byrow=TRUE)
 kiteChart(musicmat,varlabels=c("Swing","Rock","Jazz","Disco","Rap"),
  main="An utterly imaginary chart of music popularity",
  timepos=seq(1,51,by=10),timelabels=seq(1950,2000,by=10),mar=c(5,4,4,2))
 # now flip it to vertical, normalize and show the normalization factors
 kiteChart(musicmat,varlabels=c("Swing","Rock","Jazz","Disco","Rap"),
  main="An utterly imaginary chart of music popularity",xlab="Style",
  timepos=seq(1,51,by=10),timelabels=seq(1950,2000,by=10),mar=c(5,4,4,2),
  timex=FALSE,normalize=TRUE,shownorm=TRUE)
</code></pre>

<hr>
<h2 id='l2010'>World lightning strike data from 2010</h2><span id='topic+l2010'></span>

<h3>Description</h3>

<p>A list of two 50x100 matrices containing most of the world lightning strike 
data from 2010. It was produced by &lsquo;<span class="samp">&#8288;makeDensityMatrix&#8288;</span>&rsquo; from 171 file 
(about 3 Gb) of data consisting in two geographic coordinates for the 
approximate location of each recorded strike and an estimated intensity of the 
strike in kVA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(l2010)
</code></pre>

<hr>
<h2 id='labbePlot'> Display a L'Abbe plot </h2><span id='topic+labbePlot'></span>

<h3>Description</h3>

<p>Display the percentages of successes for two conditions to be compared as circles,
the area of which is proportional to the number of observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> labbePlot(x,main="L'Abbe plot",xlab="Percent positive response with placebo",
 ylab="Percent positive response with treatment",labels=NULL,col=NA,
 circle.mag=0.5,add=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="labbePlot_+3A_x">x</code></td>
<td>
<p>A list of either 2x2 tables or three element vectors (see Details).</p>
</td></tr>
<tr><td><code id="labbePlot_+3A_main">main</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="labbePlot_+3A_xlab">xlab</code>, <code id="labbePlot_+3A_ylab">ylab</code></td>
<td>
<p>The x and y axis labels as in &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="labbePlot_+3A_labels">labels</code></td>
<td>
<p>Text strings that will be displayed in the center of the circles.</p>
</td></tr>
<tr><td><code id="labbePlot_+3A_col">col</code></td>
<td>
<p>A list of colors for the circles.</p>
</td></tr>
<tr><td><code id="labbePlot_+3A_circle.mag">circle.mag</code></td>
<td>
<p>A fudge factor for very small or very large numbers of
observations.</p>
</td></tr>
<tr><td><code id="labbePlot_+3A_add">add</code></td>
<td>
<p>Whether to add the information in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; to an existing L'Abbe
plot.</p>
</td></tr>
<tr><td><code id="labbePlot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The elements of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; may be tables in which rows represent the conditions
being compared, with the comparison condition first (often &quot;placebo&quot;) and the 
condition of interest (often &quot;intervention&quot;) second. The columns represent the
counts of successes and failures. The elements of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; can also be vectors
with three numeric values, first the percentage of successes for the comparison
condition, second the percentage of successes for the condition of interest and
finally the number of observations. Tables and vectors can be mixed.
</p>
<p>The radius of each circle is the square root of the number of observations
multiplied by &lsquo;<span class="samp">&#8288;circle.mag&#8288;</span>&rsquo;. This allows very small numbers of observations
to be expanded and very large numbers to be reduced in size. As the area of each
circle is proportional to the number of observations, &lsquo;<span class="samp">&#8288;circle.mag&#8288;</span>&rsquo; must be
the same for all circles. The user may wish to expand or contract all the circles
on a plot so that they will fit within the box.
</p>
<p>The labels, if not NULL, are displayed on the circles. The function tries to work
out whether white or black text will be more easily read based on the background
color and displays the text accordingly.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon - thanks to Whitney Melroy for asking for it.</p>


<h3>See Also</h3>

<p><a href="#topic+draw.circle">draw.circle</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # first fake something like the data from a clinical trial
 didf&lt;-data.frame(subject=1:50,interv=rep(c("therapist","ex-drinker"),each=25),
  outcome=sample(c("more","less"),50,TRUE))
 # make it into a table
 didf.tab&lt;-table(didf$interv,didf$outcome)
 # now mix in some raw percentages just for the example
 didf2&lt;-c(74,46,200)
 didf3&lt;-c(33,87,500)
 x&lt;-list(didf.tab,didf2,didf3)
 labbecol&lt;-list("red","green","blue")
 labbePlot(x,main="Ex-drinkers vs therapists",
  xlab="Percent reduced drinking (ex-drinkers)",
  ylab="Percent reduced drinking (therapists)",
 labels=list("A","B52","X117"),col=labbecol)
 labbePlot(list(c(20,40,20)),col=list("purple"),labels=list("Z"),add=TRUE)
</code></pre>

<hr>
<h2 id='ladderplot'>
Ladder Plot
</h2><span id='topic+ladderplot'></span><span id='topic+ladderplot.default'></span>

<h3>Description</h3>

<p>Makes a ladder plot, similar to <a href="MASS.html#topic+parcoord">parcoord</a> but with more
flexibility and graphical options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ladderplot(x, ...)
## Default S3 method:
ladderplot(x, scale=FALSE, col=1, pch=19, lty=1, 
xlim=c(0.5, ncol(x) + 0.5), ylim=range(x), vertical = TRUE, ordered=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ladderplot_+3A_x">x</code></td>
<td>

<p>A matrix or data frame with at least 2 columns.
</p>
</td></tr>
<tr><td><code id="ladderplot_+3A_scale">scale</code></td>
<td>

<p>Logical, if the original data columns should be scaled to the unit (0-1) interval.
</p>
</td></tr>
<tr><td><code id="ladderplot_+3A_col">col</code></td>
<td>

<p>Color values to use for rows of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;. If longer than 1, its value is recycled.
</p>
</td></tr>
<tr><td><code id="ladderplot_+3A_pch">pch</code></td>
<td>

<p>Point type to use. If longer than 1, its value is recycled.
</p>
</td></tr>
<tr><td><code id="ladderplot_+3A_lty">lty</code></td>
<td>

<p>Line type to use. If longer than 1, its value is recycled.
</p>
</td></tr>
<tr><td><code id="ladderplot_+3A_xlim">xlim</code>, <code id="ladderplot_+3A_ylim">ylim</code></td>
<td>

<p>Limits for axes.
</p>
</td></tr>
<tr><td><code id="ladderplot_+3A_vertical">vertical</code></td>
<td>

<p>Logical, if the orientation of the ladderplot should be vertical or horizontal.
</p>
</td></tr>
<tr><td><code id="ladderplot_+3A_ordered">ordered</code></td>
<td>

<p>Logical, if the columns in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; should be ordered.
</p>
</td></tr>
<tr><td><code id="ladderplot_+3A_...">...</code></td>
<td>

<p>Other arguments passed to the function <a href="graphics.html#topic+stripchart">stripchart</a>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses <a href="graphics.html#topic+stripchart">stripchart</a> to plot 1-D scatter plots for each column
in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;. Then points are joined by lines for each rows of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.
</p>


<h3>Value</h3>

<p>Makes a plot as a side effect.
Returns &lsquo;<span class="samp">&#8288;NULL&#8288;</span>&rsquo; invisibly.
</p>


<h3>Author(s)</h3>

<p>Peter Solymos &lt;solymos@ualberta.ca&gt;
</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+lines">lines</a>, <a href="graphics.html#topic+points">points</a>, <a href="graphics.html#topic+stripchart">stripchart</a>
</p>
<p>Almost identical function: <a href="MASS.html#topic+parcoord">parcoord</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-data.frame(A=c(1:10), B=c(2:11)+rnorm(10))
y&lt;-data.frame(x, C=c(1:10)+rnorm(10))
opar &lt;- par(mfrow=c(1,3))
ladderplot(x)
ladderplot(x, col=1:10, vertical=FALSE)
ladderplot(y, col=1:10)
par(opar)

## examples from parcoord
## Not run: 
if (require(MASS)) {
opar &lt;- par(mfrow=c(2,3))
z1 &lt;- state.x77[, c(7, 4, 6, 2, 5, 3)]
parcoord(z1, main="parcoord state.x77")
ladderplot(z1, pch=NA, scale=TRUE, main="ladderplot state.x77 original")
ladderplot(z1, main="ladderplot state.x77 original")
ir &lt;- rbind(iris3[,,1], iris3[,,2], iris3[,,3])
z2 &lt;- log(ir)[, c(3, 4, 2, 1)]
parcoord(z2, col = 1 + (0:149))
ladderplot(z2, scale=TRUE, col = 1 + (0:149),
    main="ladderplot iris original")
ladderplot(z2, col = 1 + (0:149))
par(opar)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='legendg'>Legend with grouped bars, lines or symbols</h2><span id='topic+legendg'></span>

<h3>Description</h3>

<p>Displays a legend with more than one rectangle, symbol or line.</p>


<h3>Usage</h3>

<pre><code class='language-R'> legendg(x,y=NULL,legend,fill=NULL,col=par("col"),          
 border=list("black"),lty,lwd,pch=NULL,angle=45,density=NULL,       
 bty="o",bg=par("bg"),box.lwd=par("lwd"),box.lty=par("lty"), 
 box.col=par("fg"),pt.bg=NA,cex=1,pt.cex=cex,pt.lwd=lwd,  
 pt.space=1,xjust=0,yjust=1,x.intersp=1,y.intersp=1,
 adj=c(0,0.5),text.width=NULL,text.col=par("col"),merge=FALSE,
 trace=FALSE,plot=TRUE,ncol=1,horiz=FALSE,title=NULL,
 inset=0,xpd,title.col=text.col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="legendg_+3A_x">x</code>, <code id="legendg_+3A_y">y</code></td>
<td>
<p>Position of the legend as in &lsquo;<span class="samp">&#8288;legend&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="legendg_+3A_legend">legend</code></td>
<td>
<p>Labels for the legend as in &lsquo;<span class="samp">&#8288;legend&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="legendg_+3A_fill">fill</code></td>
<td>
<p>List of fill colors for the rectangles.</p>
</td></tr>
<tr><td><code id="legendg_+3A_col">col</code></td>
<td>
<p>Color(s), perhaps as a list, for the symbols.</p>
</td></tr>
<tr><td><code id="legendg_+3A_border">border</code></td>
<td>
<p>Border color(s) for the rectangles.</p>
</td></tr>
<tr><td><code id="legendg_+3A_lty">lty</code></td>
<td>
<p>Line type, currently ignored and set to 1.</p>
</td></tr>
<tr><td><code id="legendg_+3A_lwd">lwd</code></td>
<td>
<p>Line width, currently ignored.</p>
</td></tr>
<tr><td><code id="legendg_+3A_pch">pch</code></td>
<td>
<p>List of symbols for the legend.</p>
</td></tr>
<tr><td><code id="legendg_+3A_angle">angle</code>, <code id="legendg_+3A_density">density</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
<tr><td><code id="legendg_+3A_bty">bty</code></td>
<td>
<p>Legend box type to be displayed.</p>
</td></tr>
<tr><td><code id="legendg_+3A_bg">bg</code></td>
<td>
<p>Background color for the legend.</p>
</td></tr>
<tr><td><code id="legendg_+3A_box.lwd">box.lwd</code>, <code id="legendg_+3A_box.lty">box.lty</code>, <code id="legendg_+3A_box.col">box.col</code></td>
<td>
<p>Line width, type and color
for the surrounding box.</p>
</td></tr>
<tr><td><code id="legendg_+3A_cex">cex</code></td>
<td>
<p>Character expansion for text.</p>
</td></tr>
<tr><td><code id="legendg_+3A_pt.bg">pt.bg</code>, <code id="legendg_+3A_pt.cex">pt.cex</code>, <code id="legendg_+3A_pt.lwd">pt.lwd</code></td>
<td>
<p>Background color, character
expansion and line width for the symbols.</p>
</td></tr>
<tr><td><code id="legendg_+3A_pt.space">pt.space</code></td>
<td>
<p>Spacing for the symbols as a multiplier
for &lsquo;<span class="samp">&#8288;strwidth("O")&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="legendg_+3A_xjust">xjust</code>, <code id="legendg_+3A_yjust">yjust</code></td>
<td>
<p>Justification for the legend.</p>
</td></tr>
<tr><td><code id="legendg_+3A_x.intersp">x.intersp</code>, <code id="legendg_+3A_y.intersp">y.intersp</code></td>
<td>
<p>x and y character spacing for
the legend text.</p>
</td></tr>
<tr><td><code id="legendg_+3A_adj">adj</code></td>
<td>
<p>Text adjustment.</p>
</td></tr>
<tr><td><code id="legendg_+3A_text.width">text.width</code>, <code id="legendg_+3A_text.col">text.col</code></td>
<td>
<p>Width and color of the legend text.</p>
</td></tr>
<tr><td><code id="legendg_+3A_merge">merge</code></td>
<td>
<p>Whether to merge points and lines.</p>
</td></tr>
<tr><td><code id="legendg_+3A_trace">trace</code></td>
<td>
<p>Show how the legend is calculated.</p>
</td></tr>
<tr><td><code id="legendg_+3A_plot">plot</code></td>
<td>
<p>Whether to plot the legend.</p>
</td></tr>
<tr><td><code id="legendg_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns in the legend.</p>
</td></tr>
<tr><td><code id="legendg_+3A_horiz">horiz</code></td>
<td>
<p>Whether to display a horizontal legend.</p>
</td></tr>
<tr><td><code id="legendg_+3A_title">title</code></td>
<td>
<p>Title for the legend.</p>
</td></tr>
<tr><td><code id="legendg_+3A_inset">inset</code></td>
<td>
<p>Inset distances for use with keywords.</p>
</td></tr>
<tr><td><code id="legendg_+3A_xpd">xpd</code></td>
<td>
<p>An optional value for &lsquo;<span class="samp">&#8288;par(xpd=)&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="legendg_+3A_title.col">title.col</code></td>
<td>
<p>Color for the legend title.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;legendg&#8288;</span>&rsquo; calls &lsquo;<span class="samp">&#8288;legend&#8288;</span>&rsquo; to display a legend with a
blank space to the left of the labels. It then attempts to display
groups of colored rectangles or symbols in that space depending
upon the contents of either &lsquo;<span class="samp">&#8288;fill&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;pch&#8288;</span>&rsquo;. These
should be in the form of a list with the number of elements equal
to the number of labels, and one or more fills or symbols for each
label. &lsquo;<span class="samp">&#8288;legendg&#8288;</span>&rsquo; will display up to four fills or symbols
next to each label, allowing the user to label a group of these
rather than just one per label.
</p>


<h3>Value</h3>

<p>The value returned by &lsquo;<span class="samp">&#8288;legend&#8288;</span>&rsquo; returned invisibly.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+legend">legend</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(0.5,0.5,xlim=c(0,1),ylim=c(0,1),type="n",
  main="Test of grouped legend function")
 legendg(0.5,0.8,c("one","two","three"),pch=list(1,2:3,4:6),
  col=list(1,2:3,4:6),pt.space=1.5)
 legendg(0.5,0.5,c("one","two","three"),fill=list(1,2:3,4:6))
 # fake a line/point with text points
 legendg(0.2,0.25,c("letter","number"),
  pch=list(c("-","A","-"),c("-","1","-")),
  col=list(rep(2,3),rep(3,3)))
</code></pre>

<hr>
<h2 id='lengthKey'>Key for interpreting lengths in a plot</h2><span id='topic+lengthKey'></span>

<h3>Description</h3>

<p>Key for interpreting lengths in a plot</p>


<h3>Usage</h3>

<pre><code class='language-R'> lengthKey(x,y,tickpos,scale)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lengthKey_+3A_x">x</code>, <code id="lengthKey_+3A_y">y</code></td>
<td>
<p>The position of the left end of the key in user units.</p>
</td></tr>
<tr><td><code id="lengthKey_+3A_tickpos">tickpos</code></td>
<td>
<p>The labels that will appear above the key.</p>
</td></tr>
<tr><td><code id="lengthKey_+3A_scale">scale</code></td>
<td>
<p>A value that will scale the length of the key.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;lengthKey&#8288;</span>&rsquo; displays a line with tick marks and the values in
&lsquo;<span class="samp">&#8288;tickpos&#8288;</span>&rsquo; above those tickmarks. It is useful when line segments
on a plot represent numeric values. Note that if the plot does not have
a 1:1 aspect ratio, a length key is usually misleading.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+segments">segments</a>, <a href="graphics.html#topic+arrows">arrows</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # manufacture a matrix of orientations in radians
 o&lt;-matrix(rep(pi*seq(0.1,0.8,by=0.1),7),ncol=8,byrow=TRUE)
 m&lt;-matrix(rnorm(56)+4,ncol=8,byrow=TRUE)
 # get an empty plot of approximately 1:1 aspect ratio
 plot(0,xlim=c(0.7,8.3),ylim=c(0.7,7.3),type="n")
 vectorField(o,m,vecspec="rad")
 # the scaling usually has to be worked out by trial and error
 lengthKey(0.3,-0.5,c(0,5,10),0.24)
</code></pre>

<hr>
<h2 id='makeDensityMatrix'>Compute a matrix of counts from a list of x,y positions</h2><span id='topic+makeDensityMatrix'></span>

<h3>Description</h3>

<p>Compute a matrix in which the counts in each cell represent the number of 
occurrences of that cell's coordinates in a list of x,y cooordinate values,
optionally computing a second matrix of the average of the values attached
to the coordinate observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> makeDensityMatrix(x,y,z=NULL,nx=100,ny=50,zfun=c("mean","sum"),
 xlim=c(-180,180),ylim=c(-90,90),geocoord=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeDensityMatrix_+3A_x">x</code>, <code id="makeDensityMatrix_+3A_y">y</code></td>
<td>
<p>Vectors of x and y coordinates. These are usually combined in a
matrix or data frame of two columns.</p>
</td></tr>
<tr><td><code id="makeDensityMatrix_+3A_z">z</code></td>
<td>
<p>Optional values attached to each coordinate pair. If these are present,
it can be in a matrix or data frame of three columns, x, y and z.</p>
</td></tr>
<tr><td><code id="makeDensityMatrix_+3A_nx">nx</code></td>
<td>
<p>The number of &quot;x&quot; cells in the output matrix.</p>
</td></tr>
<tr><td><code id="makeDensityMatrix_+3A_ny">ny</code></td>
<td>
<p>The number of &quot;y&quot; cells in the output matrix.</p>
</td></tr>
<tr><td><code id="makeDensityMatrix_+3A_zfun">zfun</code></td>
<td>
<p>The function to apply to the summed values attached to each 
coordinate pair. Currently defaults to mean, otherwise the sum is returned.</p>
</td></tr>
<tr><td><code id="makeDensityMatrix_+3A_xlim">xlim</code></td>
<td>
<p>The extreme coordinates in the horizontal direction (see Details).</p>
</td></tr>
<tr><td><code id="makeDensityMatrix_+3A_ylim">ylim</code></td>
<td>
<p>The extreme coordinates in the vertical direction (see Details).</p>
</td></tr>
<tr><td><code id="makeDensityMatrix_+3A_geocoord">geocoord</code></td>
<td>
<p>Whether to correct the matrix values for the areal distortion
of the Mercator projection.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;makeDensityMatrix&#8288;</span>&rsquo; expects two vectors or a matrix or data frame with 
at least two columns. The function was written for geographic coordinates,
but will also work for other numeric coordinates. An optional third vector 
or column of values for each coordinate will be processed.
</p>
<p>Each coordinate pair adds to the count in that cell of the matrix. If there
is a third element, that value is added to a second matrix in the same 
position. By default, the function computes the mean of all values in each 
cell. If &lsquo;<span class="samp">&#8288;zfun="sum"&#8288;</span>&rsquo;, the sum of values in each cell will be returned.
</p>
<p>As geograhic data sets may be very large, leading to memory problems, 
&lsquo;<span class="samp">&#8288;makeDensityMatrix&#8288;</span>&rsquo; can be run on small sections of the data set and the
resulting matrices added together as long as the coordinate limits are
consistent throughout.
</p>


<h3>Value</h3>

<p>Either a matrix of counts of coordinate pairs within each cell or a list of
two such matrices, the second containing the mean or sum of values associated 
with coordinate pairs.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+densityGrid">densityGrid</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-sample(1:20,400,TRUE)
 y&lt;-sample(1:20,400,TRUE)
 z&lt;-runif(400,5,20)
 xyz&lt;-makeDensityMatrix(x,y,z,nx=20,ny=20,xlim=c(1,10),ylim=c(1,10),
  geocoord=FALSE)
 par(mar=c(7,3,2,3))
 plot(0,xlim=c(1,10),ylim=c(1,10),type="n",xlab="",axes=FALSE)
 box()
 densityGrid(xyz,range.cex=c(1,4),xlim=c(1,10),ylim=c(1,10),
  red=c(0,0.5,0.8,1),green=c(1,0.8,0.5,0),blue=0,pch=15)
 color.legend(3,-0.7,7,-0.2,c(5,10,15,20),
  rect.col=color.scale(1:4,cs1=c(0,0.5,0.8,1),cs2=c(1,0.8,0.5,0),cs3=0,alpha=1))
 par(xpd=TRUE)
 text(5,0.3,"Intensity")
 points(c(3.5,4.5,5.5,6.5),rep(-1.7,4),pch=15,cex=1:4)
 text(c(3.5,4.5,5.5,6.5),rep(-1.3,4),1:4)
 text(5,-1,"Density")
 par(xpd=FALSE)
</code></pre>

<hr>
<h2 id='makeIntersectList'>Count set intersections</h2><span id='topic+makeIntersectList'></span>

<h3>Description</h3>

<p>Create a list of set intersections from a matrix of indicators</p>


<h3>Usage</h3>

<pre><code class='language-R'> makeIntersectList(x,xnames=NULL,sep="+")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeIntersectList_+3A_x">x</code></td>
<td>
<p>A data frame or matrix where rows represent objects and columns
attributes. A &lsquo;<span class="samp">&#8288;1&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo; indicates that the object (row) has
that attribute or is a member of that set (column). &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; can also be
a matrix or data frame in which the first column contains object identifiers
and the second contains attribute codes.</p>
</td></tr>
<tr><td><code id="makeIntersectList_+3A_xnames">xnames</code></td>
<td>
<p>Optional user-supplied names for the attributes of x.</p>
</td></tr>
<tr><td><code id="makeIntersectList_+3A_sep">sep</code></td>
<td>
<p>A character to use as a separator for attribute labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;makeIntersectList&#8288;</span>&rsquo; reads a matrix (or data frame where all values are the
same type) containing dichotomous values (either 0/1 or FALSE/TRUE) or labels
(see next paragraph). In the first type of input, each row represents an object
and each column represents a set. A value of 1 or TRUE indicates that that
object is a member of that set. The function creates a list of vectors that
correspond to all combinations of the sets (set intersections) and inserts the
counts of elements in each combination. If a row of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; is all zeros,
it will not be counted, but the second last element of the list returned
contains the count of rows in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and thus non-members can be calculated.
</p>
<p>If a matrix (or data frame where all values are the same type) containing values 
other than 0/1 or TRUE/FALSE, it will be passed to &lsquo;<span class="samp">&#8288;categoryReshape&#8288;</span>&rsquo; for
conversion to a data frame as described above. See &lsquo;<span class="samp">&#8288;categoryReshape&#8288;</span>&rsquo; for
details of this.
</p>
<p>makeIntersectList combines the set or attribute names to form
intersection names. For the intersection of sets A and B, the name will
be A+B (unless &lsquo;<span class="samp">&#8288;sep&#8288;</span>&rsquo; is changed) and so on. These are the names that will
be displayed by &lsquo;<span class="samp">&#8288;intersectDiagram&#8288;</span>&rsquo;. To change these, use the &lsquo;<span class="samp">&#8288;xnames&#8288;</span>&rsquo;
argument.
</p>


<h3>Value</h3>

<p>A list of the intersection counts or percentages, the total number of
objects and the attribute codes.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+intersectDiagram">intersectDiagram</a>, <a href="#topic+pasteCols">pasteCols</a>,<a href="#topic+categoryReshape">categoryReshape</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # create a matrix where each row represents an element and
 # a 1 (or TRUE) in each column indicates that the element is a member
 # of that set.
 setdf&lt;-data.frame(A=sample(c(0,1),100,TRUE,prob=c(0.7,0.3)),
  B=sample(c(0,1),100,TRUE,prob=c(0.7,0.3)),
  C=sample(c(0,1),100,TRUE,prob=c(0.7,0.3)),
  D=sample(c(0,1),100,TRUE,prob=c(0.7,0.3)))
 makeIntersectList(setdf)
 ns&lt;-sample(1:8,20,TRUE)
 objects&lt;-0
 for(i in 1:length(ns)) objects&lt;-c(objects,rep(i,ns[i]))
 attributes&lt;-"Z"
 for(i in 1:length(ns)) attributes&lt;-c(attributes,sample(LETTERS[1:8],ns[i]))
 setdf2&lt;-data.frame(objects[-1],attributes[-1])
 makeIntersectList(setdf2)
</code></pre>

<hr>
<h2 id='maxEmptyRect'> Find an empty space on a plot </h2><span id='topic+maxEmptyRect'></span>

<h3>Description</h3>

<p>Try to find the largest empty rectangle on a plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> maxEmptyRect(ax,ay,x,y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxEmptyRect_+3A_ax">ax</code>, <code id="maxEmptyRect_+3A_ay">ay</code></td>
<td>
<p>The rectangle within which all of the points are contained.
Usually the limits of a plot.</p>
</td></tr>
<tr><td><code id="maxEmptyRect_+3A_x">x</code>, <code id="maxEmptyRect_+3A_y">y</code></td>
<td>
<p>x and y positions of the points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;maxEmptyRect&#8288;</span>&rsquo; searches the pairs of points on the plot to find
the largest rectangular space within which none of the points lie.
It does not guarantee that the space will be large enough to fit a
legend or text.
</p>
<p>Two alternatives are the &lsquo;<span class="samp">&#8288;largest.empty&#8288;</span>&rsquo; function in the 
<span class="pkg">Hmisc</span> package and the &lsquo;<span class="samp">&#8288;emptyspace&#8288;</span>&rsquo; function. &lsquo;<span class="samp">&#8288;maxEmptyRect&#8288;</span>&rsquo;
appears to outperform &lsquo;<span class="samp">&#8288;emptyspace&#8288;</span>&rsquo;, particularly in running time.
However, &lsquo;<span class="samp">&#8288;emptyspace&#8288;</span>&rsquo; will sometimes find a &quot;squarer&quot; rectangle when 
&lsquo;<span class="samp">&#8288;maxEmptyRect&#8288;</span>&rsquo; finds a slightly larger narrow rectangle.
</p>


<h3>Value</h3>

<p>A list containing the area of the rectangle and the coordinates of the
lower left and upper right corners (as used in &lsquo;<span class="samp">&#8288;rect&#8288;</span>&rsquo;) of the rectangle
found.
</p>


<h3>Author(s)</h3>

<p>Hans Borchers</p>


<h3>References</h3>

<p>A. Naamad, D. T. Lee, and W.-L. Hsu (1984). On the Maximum Empty
Rectangle Problem. Discrete Applied Mathematics, 8: 267-277.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-runif(100)
 y&lt;-runif(100)
 plot(x,y,main="Find the maximum empty rectangle",xlab="X",ylab="Y")
 mer&lt;-maxEmptyRect(c(0,1),c(0,1),x,y)
 rect(mer$rect[1],mer$rect[2],mer$rect[3],mer$rect[4],border="red")
</code></pre>

<hr>
<h2 id='mtext3d'> Display text in the margins of a 3D plot </h2><span id='topic+mtext3d'></span>

<h3>Description</h3>

<p>Display text in the margins of a 3D plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> mtext3d(edge,pmat,labels=TRUE,at=NULL,dist=0.3,xpd=NA,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtext3d_+3A_edge">edge</code></td>
<td>
<p> which axis to calculate.</p>
</td></tr>
<tr><td><code id="mtext3d_+3A_pmat">pmat</code></td>
<td>
<p> matrix to transform coordinates. </p>
</td></tr>
<tr><td><code id="mtext3d_+3A_labels">labels</code></td>
<td>
<p> labels to display in the margin. </p>
</td></tr>
<tr><td><code id="mtext3d_+3A_at">at</code></td>
<td>
<p> position on the axis. </p>
</td></tr>
<tr><td><code id="mtext3d_+3A_dist">dist</code></td>
<td>
<p> Offset of the axis. </p>
</td></tr>
<tr><td><code id="mtext3d_+3A_xpd">xpd</code></td>
<td>
<p> set clipping for display. </p>
</td></tr>
<tr><td><code id="mtext3d_+3A_...">...</code></td>
<td>
<p> additional arguments passed to ptext3d. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>

<hr>
<h2 id='multhist'>Plot a multiple histogram, as a barplot</h2><span id='topic+multhist'></span>

<h3>Description</h3>

<p>Given a list, plots a side-by-side barplot containing the histograms
of the elements
</p>


<h3>Usage</h3>

<pre><code class='language-R'> multhist(x,beside=TRUE,freq=NULL,probability=!freq,plot.it=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multhist_+3A_x">x</code></td>
<td>
<p>a list of numeric vectors</p>
</td></tr>
<tr><td><code id="multhist_+3A_beside">beside</code></td>
<td>
<p>plot histogram bars for groups side-by-side?</p>
</td></tr>
<tr><td><code id="multhist_+3A_freq">freq</code></td>
<td>
<p>logical; if 'TRUE', the histogram graphic is a representation
of frequencies, the 'counts' component of the result; if
'FALSE', probability densities, component 'density', are
plotted (so that the histogram has a total area of one).
Defaults to 'TRUE' if 'probability' is not specified
(does not consider equidistant breaks as in <a href="graphics.html#topic+hist">hist</a>)</p>
</td></tr>
<tr><td><code id="multhist_+3A_probability">probability</code></td>
<td>
<p>an alias for '!freq', for S compatibility</p>
</td></tr>
<tr><td><code id="multhist_+3A_plot.it">plot.it</code></td>
<td>
<p>Whether or not to display the histogram.</p>
</td></tr>
<tr><td><code id="multhist_+3A_...">...</code></td>
<td>
<p>additional arguments to <a href="graphics.html#topic+hist">hist</a> or <a href="graphics.html#topic+barplot">barplot</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list including the return value for the first call to &lsquo;<span class="samp">&#8288;hist&#8288;</span>&rsquo; (itself a list)
and the values for the bar heights.
</p>


<h3>Note</h3>

<p>The 'inside' argument to <a href="graphics.html#topic+barplot">barplot</a> (which is not currently
implemented in barplot anyway) is deleted from the argument list. The
default value of NULL for &lsquo;<span class="samp">&#8288;freq&#8288;</span>&rsquo; is for consistency with &lsquo;<span class="samp">&#8288;hist&#8288;</span>&rsquo;
but is equivalent to TRUE.
</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+hist">hist</a>,<a href="graphics.html#topic+barplot">barplot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(1234)
 l &lt;- list(runif(10)*10,1:10,c(1,1,1,1,4,8))
 multhist(l)
</code></pre>

<hr>
<h2 id='multivari'>
Function to draw a multivari chart
</h2><span id='topic+multivari'></span>

<h3>Description</h3>

<p>A multivari chart of one quantitative response variable depending on two
to four categorical variables can be drawn.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multivari(var, fac1, fac2, fac3 = NULL, fac4 = NULL, data, sort = FALSE,
 fun = mean, pch = list(15, 16, 17), col = list("black", "blue", "red"),
 col0 = "black", cex = 1, fac.cex = 2, xlab.depth = 3, legend = FALSE,
 main = paste("multivari chart of", var), add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multivari_+3A_var">var</code></td>
<td>
<p>variable name (character string) or column index of response
variable, required
</p>
</td></tr>
<tr><td><code id="multivari_+3A_fac1">fac1</code></td>
<td>
<p>variable name (character string) or column index of first
level factor, required; precedes <code>fac2</code> and <code>fac3</code> (if present) in the hierarchy (see Details)
</p>
</td></tr>
<tr><td><code id="multivari_+3A_fac2">fac2</code></td>
<td>
<p>variable name (character string) or column index of second
level factor, required; follows <code>fac1</code> and precedes <code>fac3</code> (if present) 
in the hierarchy (see Details)
</p>
</td></tr>
<tr><td><code id="multivari_+3A_fac3">fac3</code></td>
<td>
<p>variable name (character string) or column index of third
level factor, optional; if present, <code>fac3</code> is the last factor in the hierarchy (see Details)
</p>
</td></tr>
<tr><td><code id="multivari_+3A_fac4">fac4</code></td>
<td>

<p>variable name (character string) or column index of fourth level factor,
optional; can only be specified if there is also a third level factor;
if present, this factor is the first in the hierarchy (see Details), and separate multivari charts for the first three factors are drawn for each level of this factor</p>
</td></tr>
<tr><td><code id="multivari_+3A_data">data</code></td>
<td>

<p>a data frame, required
</p>
</td></tr>
<tr><td><code id="multivari_+3A_sort">sort</code></td>
<td>

<p>logical, specifying whether or not levels are sorted, when converting
character vectors to factors (a single choice for all factors is needed); default: <code>FALSE</code>
</p>
</td></tr>
<tr><td><code id="multivari_+3A_fun">fun</code></td>
<td>

<p>a function to be used in aggregation; default: <code>mean</code>
</p>
</td></tr>
<tr><td><code id="multivari_+3A_pch">pch</code></td>
<td>

<p>a list of length 2 or 3, depending on whether or not <code>fac3</code> is
specified; the ith list element can be an individual plotting symbol
(like the usual <code>pch</code> entry) or a vector of plot symbols for each
level of <code>fac_i</code>
</p>
</td></tr>
<tr><td><code id="multivari_+3A_col">col</code></td>
<td>

<p>a list of length 2 or 3, depending on whether or not <code>fac3</code> is
specified; the ith list element can be an individual color or a vector
of colors for each level of <code>fac_i</code>; this color specification is
used for the plot symbols of <code>fac_i</code> levels and for the lines
connecting the symbols for the next level in the hierarchy
</p>
</td></tr>
<tr><td><code id="multivari_+3A_col0">col0</code></td>
<td>

<p>the color for the first line to be drawn
</p>
</td></tr>
<tr><td><code id="multivari_+3A_cex">cex</code></td>
<td>

<p>the size of axis annotation text
(annotation of the fourth level header is 1.5 times this size)
</p>
</td></tr>
<tr><td><code id="multivari_+3A_fac.cex">fac.cex</code></td>
<td>

<p>a multiplier for <code>cex</code>; plot symbol sizes are <code>fac.cex*cex</code>;
default: 2
</p>
</td></tr>
<tr><td><code id="multivari_+3A_xlab.depth">xlab.depth</code></td>
<td>

<p>labels for the horizontal axis are printed down to this level of the
hierarchy (default: 3); if the depth is reduced, different plot symbols
should be used, and a legend should be drawn
</p>
</td></tr>
<tr><td><code id="multivari_+3A_legend">legend</code></td>
<td>

<p>logical determining whether or not a legend should be drawn (default:
FALSE); the function determines wether top right or bottom right yields
a better position (it is not guaranteed that there is no overlab); if
this does not work well, one can manually draw a legend in the outer
margin
</p>
</td></tr>
<tr><td><code id="multivari_+3A_main">main</code></td>
<td>

<p>title, as usual; a default is provided
</p>
</td></tr>
<tr><td><code id="multivari_+3A_add">add</code></td>
<td>

<p>logical; add to an existing plot (which of course has to have suitable axis limits)?; default: FALSE;
note that horizontal axis labeling will always be printed by function multivari, while vertical axis labeling will be omitted for <code>add=TRUE</code>
</p>
</td></tr>
<tr><td><code id="multivari_+3A_...">...</code></td>
<td>

<p>further arguments to functions <code>plot</code>, <code>lines</code>, <code>points</code>, 
<code>mtext</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is inspired by Minitabs behavior for multivari charts 
(see also Bruno Scibilia's blog which is linked in the references). It
does not attempt to visualize individual observations.
</p>
<p>A multivari chart mainly serves exploratory purposes.
It works particularly well with balanced data, but can also be used for messy data. 
<code>multivari</code> can visualize the dependence of a single quantitative variable on up to four factors (i.e., interactions of order up to four can be visualized). The display is hierarchical: for factors later in the hierarchy, conditional means given level combinations of factors earlier in the hierarchy are displayed. Therefore, the order of the
factors can make a big difference in the display. If there is no natural
order, it may be worthwhile to inspect several orders.
</p>
<p>For interactions with two factors only, it is often preferrable to use
function <code><a href="stats.html#topic+interaction.plot">interaction.plot</a></code> or <code><a href="#topic+raw.means.plot">raw.means.plot</a></code>.
</p>


<h3>Value</h3>

<p>a list of (lists of) data frames with summary statistics to be plotted
</p>


<h3>Author(s)</h3>

<p>Ulrike Groemping
</p>


<h3>References</h3>

<p>Scibilia, Bruno (2013). Using Multi-Vari Charts to Analyze Families of Variations. <a href="https://blog.minitab.com/en/using-variability-charts-to-analyze-call-center-wait-times">https://blog.minitab.com/en/using-variability-charts-to-analyze-call-center-wait-times</a>.
</p>


<h3>See Also</h3>

<p>See also <code><a href="stats.html#topic+interaction.plot">interaction.plot</a></code>, <code><a href="#topic+raw.means.plot">raw.means.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.
## Not run: 
require(car)
multivari("cycles", "len", "load", "amp", data=Wool, 
    col=list("black","red",c("grey70","grey45","grey20")),
    pch=list(15,17,8), legend=TRUE, xlab.depth = 2, lwd=2)
multivari("cycles", "load", "len", "amp", data=Wool, 
    col=list("black",c("red","blue","darkgreen"),
    c("grey70","grey45","grey20")),
    pch=list(15,17,8), legend=TRUE, xlab.depth = 2, lwd=2)
    
## create a fake fourth factor
fakedat &lt;- rbind(cbind(newfac="blabla",Wool),cbind(newfac="albalb",Wool))
## make it character for demonstrating the effect of sort option
fakedat$newfac &lt;- as.character(fakedat$newfac)

## default: sort order in the data is respected (order of unique is used)
multivari("cycles", "load", "len", "amp", "newfac", data=fakedat, 
    col=list("black",c("red","blue","darkgreen"),
    c("grey70","grey45","grey20")),
    pch=list(15,17,8), legend=TRUE, xlab.depth = 2, lwd=2, cex=0.8)
    
## sort=TRUE: levels are sorted (order of sort(unique))
multivari("cycles", "load", "len", "amp", "newfac", data=fakedat, 
    col=list("black",c("red","blue","darkgreen"),
    c("grey70","grey45","grey20")),
    pch=list(15,17,8), legend=TRUE, xlab.depth = 2, lwd=2, cex=0.8,
    sort=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='multsymbolbox'>Draw boxes filled with symbols</h2><span id='topic+multsymbolbox'></span>

<h3>Description</h3>

<p>Draw boxes on the current figure filled with symbols representing
individual counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> multsymbolbox(x1,y1,x2,y2,tot,relw=0.8,fg=par("fg"),bg=par("bg"),
  box=TRUE,debug=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multsymbolbox_+3A_x1">x1</code></td>
<td>
<p>numeric vector: left sides of boxes</p>
</td></tr>
<tr><td><code id="multsymbolbox_+3A_y1">y1</code></td>
<td>
<p>numeric vector: bottom sides of boxes</p>
</td></tr>
<tr><td><code id="multsymbolbox_+3A_x2">x2</code></td>
<td>
<p>numeric vector: right sides of boxes</p>
</td></tr>
<tr><td><code id="multsymbolbox_+3A_y2">y2</code></td>
<td>
<p>numeric vector: top sides of boxes</p>
</td></tr>
<tr><td><code id="multsymbolbox_+3A_tot">tot</code></td>
<td>
<p>numeric vector: total numbers of symbols to put in each box</p>
</td></tr>
<tr><td><code id="multsymbolbox_+3A_relw">relw</code></td>
<td>
<p>relative width (relative to height) of symbols</p>
</td></tr></table>
<p>n
</p>
<table>
<tr><td><code id="multsymbolbox_+3A_fg">fg</code></td>
<td>
<p>foreground color(s)</p>
</td></tr>
<tr><td><code id="multsymbolbox_+3A_bg">bg</code></td>
<td>
<p>background color(s)</p>
</td></tr>
<tr><td><code id="multsymbolbox_+3A_box">box</code></td>
<td>
<p>(logical) draw box borders?</p>
</td></tr>
<tr><td><code id="multsymbolbox_+3A_debug">debug</code></td>
<td>
<p>debug output?</p>
</td></tr>
<tr><td><code id="multsymbolbox_+3A_...">...</code></td>
<td>
<p>additional arguments to polygon() for drawing boxes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(1:10,1:10,type="n")
 multsymbolbox(c(2,4),5,c(4,5),8,tot=c(10,8))
</code></pre>

<hr>
<h2 id='oz.windrose'>Display an Australian wind rose</h2><span id='topic+oz.windrose'></span>

<h3>Description</h3>

<p>Displays a wind rose in the style used by the Australian
Bureau of Meteorology.</p>


<h3>Usage</h3>

<pre><code class='language-R'> oz.windrose(windagg,maxpct=20,wrmar=c(4,5,6,5),scale.factor=30,
  speed.col=c("#dab286","#fe9a66","#ce6733","#986434"),
  speed.width=NA,show.legend=TRUE,legend.pos=NA,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oz.windrose_+3A_windagg">windagg</code></td>
<td>
<p>A matrix of percentages with the rows representing
speed ranges and the columns indicating wind directions.</p>
</td></tr>
<tr><td><code id="oz.windrose_+3A_maxpct">maxpct</code></td>
<td>
<p>The maximum percentage displayed on the radial grid.</p>
</td></tr>
<tr><td><code id="oz.windrose_+3A_wrmar">wrmar</code></td>
<td>
<p>Plot margins for the diagram.</p>
</td></tr>
<tr><td><code id="oz.windrose_+3A_scale.factor">scale.factor</code></td>
<td>
<p>The scale factor for the diagram.</p>
</td></tr>
<tr><td><code id="oz.windrose_+3A_speed.col">speed.col</code></td>
<td>
<p>Colors representing speed ranges.</p>
</td></tr>
<tr><td><code id="oz.windrose_+3A_speed.width">speed.width</code></td>
<td>
<p>Half widths of the bars representing speed ranges.</p>
</td></tr>
<tr><td><code id="oz.windrose_+3A_show.legend">show.legend</code></td>
<td>
<p>Logical indicating whether to display a legend.</p>
</td></tr>
<tr><td><code id="oz.windrose_+3A_legend.pos">legend.pos</code></td>
<td>
<p>The vertical position of the wind rose legend. The
Australian Bureau of Meteorology displays the legend at the top of
the plot</p>
</td></tr>
<tr><td><code id="oz.windrose_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;oz.windrose&#8288;</span>&rsquo; displays a wind rose in the style used by the Australian
Bureau of Meteorology. Each limb represents a bin of wind directions, and 
there are conventionally eight bins. If &lsquo;<span class="samp">&#8288;windagg&#8288;</span>&rsquo; has more than eight
columns, more limbs will be displayed. The rows of &lsquo;<span class="samp">&#8288;windagg&#8288;</span>&rsquo; represent
the speed ranges used by the Australian Bureau of Meteorology (0, 0-10, 
10-20, 20-30 and over 30 in km/hour). The diameter of the central circle is
calculated as (percent calm observations)/(number of direction bins). The
remaining grid circles are spaced from the circumference of the &quot;Calm&quot;
circle.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>If a title is desired, remember to move the legend to the bottom 
of the plot. If the function is passed values that do not sum to 100, the
resulting plot will at best be misleading.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon (thanks to Anna in the Sydney BoM office and Alejo for
finding the problem with heavily prevailing winds.)</p>


<h3>See Also</h3>

<p><a href="#topic+oz.windrose.legend">oz.windrose.legend</a>, <a href="#topic+draw.circle">draw.circle</a>, <a href="#topic+bin.wind.records">bin.wind.records</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> windagg&lt;-matrix(c(8,0,0,0,0,0,0,0,4,6,2,1,6,3,0,4,2,8,5,3,5,2,1,1,
  5,5,2,4,1,4,1,2,1,2,4,0,3,1,3,1),nrow=5,byrow=TRUE)
 oz.windrose(windagg)
</code></pre>

<hr>
<h2 id='oz.windrose.legend'>Display an Australian wind rose legend</h2><span id='topic+oz.windrose.legend'></span>

<h3>Description</h3>

<p>Displays a wind rose legend in the style used by the Australian Bureau 
of Meteorology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> oz.windrose.legend(maxpct=20,scale.factor=30,
  speed.col=c("#dab286","#fe9a66","#ce6733","#986434"),
  speed.width=NA,legend.pos=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oz.windrose.legend_+3A_maxpct">maxpct</code></td>
<td>
<p>The maximum percentage to display on the radial grid.</p>
</td></tr>
<tr><td><code id="oz.windrose.legend_+3A_scale.factor">scale.factor</code></td>
<td>
<p>The scale factor for the plot.</p>
</td></tr>
<tr><td><code id="oz.windrose.legend_+3A_speed.col">speed.col</code></td>
<td>
<p>Colors representing speed ranges.</p>
</td></tr>
<tr><td><code id="oz.windrose.legend_+3A_speed.width">speed.width</code></td>
<td>
<p>Half widths of the bars representing speed ranges.</p>
</td></tr>
<tr><td><code id="oz.windrose.legend_+3A_legend.pos">legend.pos</code></td>
<td>
<p>The vertical position of the wind rose legend. The
Australian Bureau of Meteorology displays the legend at the top of
the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon (thanks to Anna in the Sydney BoM office)</p>


<h3>See Also</h3>

<p><a href="#topic+oz.windrose">oz.windrose</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(0,xlim=c(-20,20),ylim=c(-20,20),type="n",axes=FALSE,xlab="",ylab="")
 par(xpd=TRUE)
 oz.windrose.legend()
 par(xpd=FALSE)
</code></pre>

<hr>
<h2 id='p2p_arrows'>Draw arrows between points</h2><span id='topic+p2p_arrows'></span>

<h3>Description</h3>

<p>Displays arrows on an existing plot between specified
points.</p>


<h3>Usage</h3>

<pre><code class='language-R'> p2p_arrows(x1,y1,x2,y2,space=0.05,col=par("fg"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p2p_arrows_+3A_x1">x1</code></td>
<td>
<p>Starting x positions for the labels.</p>
</td></tr>
<tr><td><code id="p2p_arrows_+3A_y1">y1</code></td>
<td>
<p>Starting y positions for the labels.</p>
</td></tr>
<tr><td><code id="p2p_arrows_+3A_x2">x2</code></td>
<td>
<p>Ending x positions for the labels.</p>
</td></tr>
<tr><td><code id="p2p_arrows_+3A_y2">y2</code></td>
<td>
<p>Ending y positions for the labels.</p>
</td></tr>
<tr><td><code id="p2p_arrows_+3A_space">space</code></td>
<td>
<p>The proportion of the distance between the points to
leave as space before and after the arrow.</p>
</td></tr>
<tr><td><code id="p2p_arrows_+3A_col">col</code></td>
<td>
<p>Color(s) for the arrows.</p>
</td></tr>
<tr><td><code id="p2p_arrows_+3A_...">...</code></td>
<td>
<p>Extra arguments passed to &lsquo;<span class="samp">&#8288;arrows&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;p2p_arrows&#8288;</span>&rsquo; displays arrows on a plot between one or more pairs
of specified points.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+arrows">arrows</a></p>

<hr>
<h2 id='panes'>Prepare a &quot;panel&quot; type layout</h2><span id='topic+panes'></span>

<h3>Description</h3>

<p>Split the graphics device into a &quot;panel&quot; type layout for a group of plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'> panes(mat=NULL,widths=rep(1,ncol(mat)),heights=rep(1,nrow(mat)),
  nrow=2,ncol=2,mar=c(0,0,1.6,0),oma=c(2.5,1,1,1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="panes_+3A_mat">mat</code></td>
<td>
<p>A matrix representing the number of panes to be created and
their order of plotting.</p>
</td></tr>
<tr><td><code id="panes_+3A_widths">widths</code>, <code id="panes_+3A_heights">heights</code></td>
<td>
<p>The widths and heights of the panes.
See &lsquo;<span class="samp">&#8288;layout&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="panes_+3A_nrow">nrow</code>, <code id="panes_+3A_ncol">ncol</code></td>
<td>
<p>The numbers of rows and columns in the layout.
See &lsquo;<span class="samp">&#8288;par(mfrow)&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="panes_+3A_mar">mar</code></td>
<td>
<p>The margins for each plot in the panes.</p>
</td></tr>
<tr><td><code id="panes_+3A_oma">oma</code></td>
<td>
<p>The outer margins for the entire group of panes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;panes&#8288;</span>&rsquo; combines the information for displaying a set of plots in
a &quot;panel&quot; layout. The default values will usually produce the desired
result by calling &lsquo;<span class="samp">&#8288;par(mfrow)&#8288;</span>&rsquo;. If &lsquo;<span class="samp">&#8288;mat&#8288;</span>&rsquo; is not NULL, the
&lsquo;<span class="samp">&#8288;layout&#8288;</span>&rsquo; function will be called instead of &lsquo;<span class="samp">&#8288;par(mfrow)&#8288;</span>&rsquo;.
The two methods are included for the convenience of the user.
</p>
<p>Note that &lsquo;<span class="samp">&#8288;panes&#8288;</span>&rsquo; does not produce any plots and that the user
must call &lsquo;<span class="samp">&#8288;tab.title&#8288;</span>&rsquo; to get the &quot;look&quot; of the panel plot. The
overall title is usually centered at the left edge (as in the example)
or in the center of one of the plots in the bottom row.
</p>


<h3>Value</h3>

<p>The values of &lsquo;<span class="samp">&#8288;par&#8288;</span>&rsquo; options that existed when &lsquo;<span class="samp">&#8288;panes&#8288;</span>&rsquo; was
called. This list is usually used to restore those values.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+par">par</a>,<a href="graphics.html#topic+layout">layout</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> y&lt;-runif(8)
 oldpar&lt;-panes(matrix(1:4,nrow=2,byrow=TRUE))
 par(mar=c(0,2,1.6,0))
 boxplot(y,axes=FALSE)
 axis(2)
 box()
 par(mar=c(0,0,1.6,2))
 tab.title("Boxplot of y",tab.col="#88dd88")
 barplot(y,axes=FALSE,col=2:9)
 axis(4)
 box()
 tab.title("Barplot of y",tab.col="#88dd88")
 par(mar=c(2,2,1.6,0))
 pie(y,col=2:9)
 tab.title("Pie chart of y",tab.col="#88dd88")
 box()
 par(mar=c(2,0,1.6,2))
 plot(y,xaxs="i",xlim=c(0,9),axes=FALSE,col=2:9)
 axis(4)
 box()
 tab.title("Scatterplot of y",tab.col="#88dd88")
 # center the title at the left edge of the last plot
 mtext("Test of panes function",at=0,side=1,line=0.8,cex=1.5)
 panes(matrix(1:3,ncol=1),heights=c(0.7,0.8,1))
 par(mar=c(0,2,2,2))
 plot(sort(runif(7)),type="l",axes=FALSE)
 axis(2,at=seq(0.1,0.9,by=0.2))
 box()
 tab.title("Rising expectations",tab.col="#ee6666")
 barplot(rev(sort(runif(7))),col="blue",axes=FALSE)
 axis(2,at=seq(0.1,0.9,by=0.2))
 box()
 tab.title("Diminishing returns",tab.col="#6666ee")
 par(mar=c(4,2,2,2))
 tso&lt;-c(0.2,0.3,0.5,0.4,0.6,0.8,0.1)
 plot(tso,type="n",axes=FALSE,xlab="")
## Not run: 
 # the following needs a Unicode locale to work (and a suitable font)
 # Few devices can plot these -- and not the default pdf() for checking.
 points(1:7,tso,pch=c(rep(-0x263a,6),-0x2639),cex=2)

## End(Not run)
 axis(1,at=1:7,
  labels=c("Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Monday"))
 axis(2,at=seq(0.1,0.9,by=0.2))
 box()
 tab.title("The sad outcome",tab.col="#66ee66")
 mtext("A lot of malarkey",side=1,line=2.5)

 par(oldpar)
</code></pre>

<hr>
<h2 id='pasteCols'>Paste the columns of a matrix together</h2><span id='topic+pasteCols'></span>

<h3>Description</h3>

<p>Paste the columns of a matrix together to form as
many &quot;words&quot; as there are columns.</p>


<h3>Usage</h3>

<pre><code class='language-R'> pasteCols(x,sep="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pasteCols_+3A_x">x</code></td>
<td>
<p>A matrix.</p>
</td></tr>
<tr><td><code id="pasteCols_+3A_sep">sep</code></td>
<td>
<p>The separator to use in the &lsquo;<span class="samp">&#8288;paste&#8288;</span>&rsquo; command.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;pasteCols&#8288;</span>&rsquo; pastes the columns of a matrix together to form a vector in
which each element is the concatenation of the elements in each of the columns
of the matrix. It is intended for producing identifiers from a matrix returned
by the &lsquo;<span class="samp">&#8288;combn&#8288;</span>&rsquo; function.
</p>


<h3>Value</h3>

<p>A vector of character strings.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+makeIntersectList">makeIntersectList</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # create a matrix of the combinations of the first five letters of the
 # alphabet taken two at a time.
 alpha5&lt;-combn(LETTERS[1:5],2,simplify=TRUE)
 pasteCols(alpha5,sep="+")
</code></pre>

<hr>
<h2 id='paxis3d'> Display text in the margins of a 3D plot </h2><span id='topic+paxis3d'></span>

<h3>Description</h3>

<p>Display text in the margins of a 3D plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> paxis3d(edge,pmat,at=NULL,labels=TRUE,tick=TRUE,
  pos=NULL,nticks=5,ticklen=0.05,labdist=0.15,xpd=NA,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paxis3d_+3A_edge">edge</code></td>
<td>
<p> which axis to calculate.</p>
</td></tr>
<tr><td><code id="paxis3d_+3A_pmat">pmat</code></td>
<td>
<p> matrix to transform coordinates. </p>
</td></tr>
<tr><td><code id="paxis3d_+3A_at">at</code></td>
<td>
<p> position on the axis. </p>
</td></tr>
<tr><td><code id="paxis3d_+3A_labels">labels</code></td>
<td>
<p> labels to display in the margin. </p>
</td></tr>
<tr><td><code id="paxis3d_+3A_tick">tick</code></td>
<td>
<p> whether to draw axis tick marks. </p>
</td></tr>
<tr><td><code id="paxis3d_+3A_pos">pos</code></td>
<td>
<p> axis position relative to other axes. </p>
</td></tr>
<tr><td><code id="paxis3d_+3A_nticks">nticks</code></td>
<td>
<p> number of tick marks. </p>
</td></tr>
<tr><td><code id="paxis3d_+3A_ticklen">ticklen</code></td>
<td>
<p> length of tick marks as a proportion of plot dimensions. </p>
</td></tr>
<tr><td><code id="paxis3d_+3A_labdist">labdist</code></td>
<td>
<p> distance of labels from axis. </p>
</td></tr>
<tr><td><code id="paxis3d_+3A_xpd">xpd</code></td>
<td>
<p> parameter to set plot clipping. </p>
</td></tr>
<tr><td><code id="paxis3d_+3A_...">...</code></td>
<td>
<p> additional arguments passed to ptext3d. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>Examples</h3>

<pre><code class='language-R'> x &lt;- 1:10
 y &lt;- 1:10
 z &lt;- outer(x,y,function(x,y) { 3*sin(2*pi*x)/(2*pi*x)+exp(y/10)+(x*y)/1000 })
 par(mar=c(5,10,2,2))
 pp &lt;- perspx(x,y,z,ticktype="detailed",phi=30,theta=80,nticks=3,r=10,
      axes=FALSE)
 ## axis labels not drawn when axes=FALSE
 paxis3d("X-",pp,at=c(1,2,9))
 paxis3d("Y+",pp)
 paxis3d("Z-",pp)
 mtext3d("X-",pp,expression(alpha^sqrt(beta)))
 ## if you want labels parallel to axis, still have to figure out 'srt'
 ##   by trial and error
 mtext3d("Y+",pp,expression("velocity ("*gamma*", furlongs/fortnight)"),
        xpd=NA,srt=6)
 mtext3d("Z-",pp,"Range\n(r*)",dist=0.5)
</code></pre>

<hr>
<h2 id='perspx'> Display perspective plot </h2><span id='topic+perspx'></span>

<h3>Description</h3>

<p>Display an enhanced perspective plot with additional return values
</p>


<h3>Usage</h3>

<pre><code class='language-R'> perspx(x,y,z,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perspx_+3A_x">x</code>, <code id="perspx_+3A_y">y</code>, <code id="perspx_+3A_z">z</code></td>
<td>
<p> x, y and z coordinates to plot. </p>
</td></tr>
<tr><td><code id="perspx_+3A_...">...</code></td>
<td>
<p> Other arguments passed to &lsquo;<span class="samp">&#8288;persp&#8288;</span>&rsquo;. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays &lsquo;<span class="samp">&#8288;z&#8288;</span>&rsquo; values plotted on an x,y grid.
</p>


<h3>Value</h3>

<p>A list with three elements, the ranges of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;z&#8288;</span>&rsquo;.
</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>Examples</h3>

<pre><code class='language-R'> x &lt;- 1:10
 y &lt;- 1:10
 z &lt;- outer(x,y,function(x,y) { 3*sin(2*pi*x)/(2*pi*x)+exp(y/10)+(x*y)/1000 })
 par(mar=c(5,10,2,2))
 pp &lt;- perspx(x,y,z,ticktype="detailed",phi=30,theta=80,nticks=3,r=10,
  axes=FALSE)
</code></pre>

<hr>
<h2 id='pie.labels'> Place labels on a pie chart </h2><span id='topic+pie.labels'></span>

<h3>Description</h3>

<p>Places labels on a pie chart
</p>


<h3>Usage</h3>

<pre><code class='language-R'> pie.labels(x=0,y=0,angles,labels,radius=1.05,bg="white",border=TRUE,
  minangle=NA,boxed=FALSE,explode=0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pie.labels_+3A_x">x</code>, <code id="pie.labels_+3A_y">y</code></td>
<td>
<p>x and y position of the center of the pie chart</p>
</td></tr>
<tr><td><code id="pie.labels_+3A_angles">angles</code></td>
<td>
<p>A numeric vector representing angles in radians. This is
the return value of &lsquo;<span class="samp">&#8288;floating.pie&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="pie.labels_+3A_labels">labels</code></td>
<td>
<p>Text strings to label each sector.</p>
</td></tr>
<tr><td><code id="pie.labels_+3A_radius">radius</code></td>
<td>
<p>The radius at which to place the labels in user units. The
default is 1.05.</p>
</td></tr>
<tr><td><code id="pie.labels_+3A_bg">bg</code></td>
<td>
<p>The color of the rectangles on which the labels are displayed.</p>
</td></tr>
<tr><td><code id="pie.labels_+3A_border">border</code></td>
<td>
<p>Whether to draw borders around the rectangles.</p>
</td></tr>
<tr><td><code id="pie.labels_+3A_minangle">minangle</code></td>
<td>
<p>Minimum angle between labels.</p>
</td></tr>
<tr><td><code id="pie.labels_+3A_boxed">boxed</code></td>
<td>
<p>Whether to use &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;boxed.labels&#8288;</span>&rsquo; to display
the labels.</p>
</td></tr>
<tr><td><code id="pie.labels_+3A_explode">explode</code></td>
<td>
<p>How much the pie chart has been &quot;exploded&quot;.</p>
</td></tr>
<tr><td><code id="pie.labels_+3A_...">...</code></td>
<td>
<p>Arguments passed to &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;boxed.labels&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Labels may be placed within the pie (radius less than the pie radius),
on the edge or outside as in the examples below. If within the pie, it
is probably best to use &lsquo;<span class="samp">&#8288;boxed=TRUE&#8288;</span>&rsquo;.
</p>
<p>If some labels overlap, passing a value in radians for &lsquo;<span class="samp">&#8288;minangle&#8288;</span>&rsquo;
may be used to spread them out.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>Remember that &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; specify the center of the pie chart and
that the label positions are specified by angles and radii from that 
center.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+floating.pie">floating.pie</a>, <a href="#topic+boxed.labels">boxed.labels</a>, <a href="#topic+spreadout">spreadout</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> pieval&lt;-c(2,1,3,94)
 plot(0,xlim=c(1.5,5),ylim=c(1,5),type="n",axes=FALSE,xlab="",ylab="")
 box()
 bisect.angles&lt;-floating.pie(3,3,pieval,explode=c(0.1,0.2,0.3,0))
 pie.labels(3,3,bisect.angles,c("two","one","three","ninety\nfour"),
  minangle=0.2,,explode=c(0.1,0.2,0.3,0))
</code></pre>

<hr>
<h2 id='pie3D'>Display a 3D pie chart</h2><span id='topic+pie3D'></span>

<h3>Description</h3>

<p>Displays a 3D pie chart with optional labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> pie3D(x,edges=NA,radius=1,height=0.1,theta=pi/6,start=0,border=par("fg"),
  col=NULL,labels=NULL,labelpos=NULL,labelcol=par("fg"),labelcex=1.5,
  sector.order=NULL,explode=0,shade=0.8,mar=c(4,4,4,4),pty="s",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pie3D_+3A_x">x</code></td>
<td>
<p>a numeric vector for which each value will be a sector</p>
</td></tr>
<tr><td><code id="pie3D_+3A_edges">edges</code></td>
<td>
<p>the number of lines forming an ellipse</p>
</td></tr>
<tr><td><code id="pie3D_+3A_radius">radius</code></td>
<td>
<p>the radius of the pie in user units</p>
</td></tr>
<tr><td><code id="pie3D_+3A_height">height</code></td>
<td>
<p>the height of the pie in user units</p>
</td></tr>
<tr><td><code id="pie3D_+3A_theta">theta</code></td>
<td>
<p>The angle of viewing in radians</p>
</td></tr>
<tr><td><code id="pie3D_+3A_start">start</code></td>
<td>
<p>The angle at which to start drawing sectors.</p>
</td></tr>
<tr><td><code id="pie3D_+3A_border">border</code></td>
<td>
<p>The color of the sector border lines</p>
</td></tr>
<tr><td><code id="pie3D_+3A_col">col</code></td>
<td>
<p>The colors of the sectors</p>
</td></tr>
<tr><td><code id="pie3D_+3A_labels">labels</code></td>
<td>
<p>Optional labels for each sector</p>
</td></tr>
<tr><td><code id="pie3D_+3A_labelpos">labelpos</code></td>
<td>
<p>Optional positions for the labels (see examples)</p>
</td></tr>
<tr><td><code id="pie3D_+3A_labelcol">labelcol</code></td>
<td>
<p>The color of the labels</p>
</td></tr>
<tr><td><code id="pie3D_+3A_labelcex">labelcex</code></td>
<td>
<p>The character expansion factor for the labels</p>
</td></tr>
<tr><td><code id="pie3D_+3A_sector.order">sector.order</code></td>
<td>
<p>Allows the operator to specify the order in
which the sectors are drawn.</p>
</td></tr>
<tr><td><code id="pie3D_+3A_explode">explode</code></td>
<td>
<p>The amount to &quot;explode&quot; the pie in user units</p>
</td></tr>
<tr><td><code id="pie3D_+3A_shade">shade</code></td>
<td>
<p>If &gt; 0 and &lt; 1, the proportion to reduce the
brightness of the sector color to get a better 3D effect.</p>
</td></tr>
<tr><td><code id="pie3D_+3A_mar">mar</code></td>
<td>
<p>Margins around the pie.</p>
</td></tr>
<tr><td><code id="pie3D_+3A_pty">pty</code></td>
<td>
<p>Whether to force a square plot region or not. (see Details)</p>
</td></tr>
<tr><td><code id="pie3D_+3A_...">...</code></td>
<td>
<p>graphical parameters passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;pie3D&#8288;</span>&rsquo; scales the values in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; so that they total 2*pi,
dropping zeros and NAs. It then displays an empty plot, calculates
the sequence for drawing the sectors and calls &lsquo;<span class="samp">&#8288;draw.tilted.sector&#8288;</span>&rsquo;
to draw each sector. If labels are supplied, it will call &lsquo;<span class="samp">&#8288;pie3D.label&#8288;</span>&rsquo;
to place these outside each sector. If supplied, the number of labels, label 
positions and sector colors must be at least equal to the number of values 
in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;. If the labels are long, it may help to reduce the radius of
the pie or change the position as in the example below.
</p>
<p>In order to make the dimensions of the pie reasonably accurate, a square plot
region (&lsquo;<span class="samp">&#8288;pty="s"&#8288;</span>&rsquo;) is the default. If &lsquo;<span class="samp">&#8288;pty&#8288;</span>&rsquo; is set to &quot;m&quot;, the user
can change the margins, usually resulting in a non-square plot area. This will
probably distort the pie somewhat.
</p>


<h3>Value</h3>

<p>The bisecting angle of the sectors in radians.
</p>


<h3>Note</h3>

<p>Due to the somewhat primitive method used to draw sectors, a sector that
extends beyond both pi/2 and 3*pi/2 radians in either direction may not
display properly. Setting &lsquo;<span class="samp">&#8288;start&#8288;</span>&rsquo; to pi/2 will often fix this, but
the user may have to adjust &lsquo;<span class="samp">&#8288;start&#8288;</span>&rsquo; and the order of sectors in extreme
cases. The argument &lsquo;<span class="samp">&#8288;sector.order&#8288;</span>&rsquo; allows the user to specify a vector
of integers that will override the calculation of the order in which the
sectors are drawn. This is usually necessary when a very large sector that 
extends past 3*pi/2 is overlapped by a smaller sector next to it. As a last
resort, the user can try setting &lsquo;<span class="samp">&#8288;explode&#8288;</span>&rsquo; to zero. This only draws
the top and outer sides of each sector.
</p>
<p>Also due to the sector drawing method, setting &lsquo;<span class="samp">&#8288;theta&#8288;</span>&rsquo; to values smaller
than about pi/8 or larger than about pi/4 will produce obviously misaligned
sectors.
</p>
<p>Contributed fixes and improvements:
thanks to Jesse Brown for the &quot;shade&quot; fix and Qinghua Zhao for alerting me to
the problem with labels and margins
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+pie3D.labels">pie3D.labels</a>, <a href="#topic+draw.tilted.sector">draw.tilted.sector</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> pieval&lt;-c(2,4,6,8)
 pielabels&lt;-
  c("We hate\n pies","We oppose\n  pies","We don't\n  care","We just love pies")
 # grab the radial positions of the labels
 lp&lt;-pie3D(pieval,radius=0.9,labels=pielabels,explode=0.1,main="3D PIE OPINIONS")
 # lengthen the last label and move it to the left
 pielabels[4]&lt;-"We cannot survive without our pies"
 lp[4]&lt;-4.8
 # specify some new colors
 pie3D(pieval,radius=0.9,labels=pielabels,explode=0.1,main="3D PIE OPINIONS",
  col=c("brown","#ddaa00","pink","#dd00dd"),labelpos=lp)
</code></pre>

<hr>
<h2 id='pie3D.labels'>Display labels on a 3D pie chart</h2><span id='topic+pie3D.labels'></span>

<h3>Description</h3>

<p>Displays labels on a 3D pie chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> pie3D.labels(radialpos,radius=1,height=0.1,theta=pi/6,
  labels,labelcol=par("fg"),labelcex=1.5,labelrad=1.25,minsep=0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pie3D.labels_+3A_radialpos">radialpos</code></td>
<td>
<p>Position of the label in radians</p>
</td></tr>
<tr><td><code id="pie3D.labels_+3A_radius">radius</code></td>
<td>
<p>the radius of the pie in user units</p>
</td></tr>
<tr><td><code id="pie3D.labels_+3A_height">height</code></td>
<td>
<p>the height of the pie in user units</p>
</td></tr>
<tr><td><code id="pie3D.labels_+3A_theta">theta</code></td>
<td>
<p>The angle of viewing in radians</p>
</td></tr>
<tr><td><code id="pie3D.labels_+3A_labels">labels</code></td>
<td>
<p>The label to display</p>
</td></tr>
<tr><td><code id="pie3D.labels_+3A_labelcol">labelcol</code></td>
<td>
<p>The color of the labels</p>
</td></tr>
<tr><td><code id="pie3D.labels_+3A_labelcex">labelcex</code></td>
<td>
<p>The character expansion factor for the labels</p>
</td></tr>
<tr><td><code id="pie3D.labels_+3A_labelrad">labelrad</code></td>
<td>
<p>The expansion for the labels around the pie.</p>
</td></tr>
<tr><td><code id="pie3D.labels_+3A_minsep">minsep</code></td>
<td>
<p>The minimum angular separation between label positions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;pie3D.label&#8288;</span>&rsquo; displays labels on a 3D pie chart. The positions
of the labels are given as angles in radians (usually the bisector of the
pie sectors). As the labels can be passed directly to <a href="#topic+pie3D">pie3D</a>,
this function would probably not be called by the user.
</p>
<p>&lsquo;<span class="samp">&#8288;pie3D.labels&#8288;</span>&rsquo; tries to separate labels that are placed closer than
&lsquo;<span class="samp">&#8288;minsep&#8288;</span>&rsquo; radians. This simple system will handle minor crowding of
labels. If labels are very crowded, capturing the return value of 
&lsquo;<span class="samp">&#8288;pie3D&#8288;</span>&rsquo; and editing the label positions may allow the user to avoid
manually placing labels.
</p>


<h3>Value</h3>

<p>nil
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+pie3D">pie3D</a>, <a href="#topic+draw.tilted.sector">draw.tilted.sector</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> pieval&lt;-c(2,4,6,8)
 bisectors&lt;-pie3D(pieval,explode=0.1,main="3D PIE OPINIONS")
 pielabels&lt;-
  c("We hate\n pies","We oppose\n  pies","We don't\n  care","We just love pies")
 pie3D.labels(bisectors,labels=pielabels)
</code></pre>

<hr>
<h2 id='placeLabels'> Place labels in boxes </h2><span id='topic+placeLabels'></span>

<h3>Description</h3>

<p>Places labels in boxes on an existing plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'> placeLabels(x,y=NA,labels,pointer=TRUE,cex=1,labelcol=par("fg"),
 labelbg="white",border=par("fg"),pointercol=par("fg"),
 pch=1,col=1,bg="white",flagcol="red")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="placeLabels_+3A_x">x</code>, <code id="placeLabels_+3A_y">y</code></td>
<td>
<p>x and y position of the centers of the labels. &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; can be an
<a href="grDevices.html#topic+xy.coords">xy.coords</a> list.</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_labels">labels</code></td>
<td>
<p>Text strings</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_pointer">pointer</code></td>
<td>
<p>Whether to draw a line segment from the label to the 
points labeled.</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_cex">cex</code></td>
<td>
<p>Character expansion. See &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_labelcol">labelcol</code></td>
<td>
<p>The color(s) of the text in the labels.</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_labelbg">labelbg</code></td>
<td>
<p>The background color(s) for the labels.</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_border">border</code></td>
<td>
<p>The color(s) for the borders around the rectangles.</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_pointercol">pointercol</code></td>
<td>
<p>The color(s) of the pointer lines.</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_pch">pch</code></td>
<td>
<p>The symbol(s) to use when redisplaying the original points 
(see Details).</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_col">col</code></td>
<td>
<p>The color(s) of the original points.</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_bg">bg</code></td>
<td>
<p>The background color(s) of the original points.</p>
</td></tr>
<tr><td><code id="placeLabels_+3A_flagcol">flagcol</code></td>
<td>
<p>The color to use for &quot;flagging&quot; each point.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;placeLabels&#8288;</span>&rsquo; steps through the points indexed by &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;, allowing the operator to manually place the labels for each 
point. Each point is &quot;flagged&quot; by displaying a small colored circle (red
by default). When the label for that point has been placed, the original
symbol is displayed and the next point is flagged.
</p>
<p>Each point and label can have different colors and backgrounds.
</p>


<h3>Value</h3>

<p>nil - adds labels to an existing plot.</p>


<h3>Note</h3>

<p>This function is handy for one-off plots with a moderate number of 
points. It can be very useful for plots with clumps of points.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon - thanks to Marna Wagley for the idea.</p>


<h3>See Also</h3>

<p><a href="#topic+spread.labels">spread.labels</a>, <a href="#topic+thigmophobe.labels">thigmophobe.labels</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # won't check because of the call to locator
 ## Not run: 
  x&lt;-rnorm(10)
  y&lt;-rnorm(10)
  plot(x,y)
  placeLabels(x,y,LETTERS[1:10],flagcol="purple")
 
## End(Not run)
</code></pre>

<hr>
<h2 id='plot_bg'> Add a background color to a plot </h2><span id='topic+plot_bg'></span>

<h3>Description</h3>

<p>Displays a colored rectangle over the entire area of a plot</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_bg(col="lightgray")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_bg_+3A_col">col</code></td>
<td>
<p>The color of the background</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;plot_bg&#8288;</span>&rsquo; is probably only useful when part of the &lsquo;<span class="samp">&#8288;do.first&#8288;</span>&rsquo;
argument in another plot function to add a background color to the plot.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>Examples</h3>

<pre><code class='language-R'> barp(1:5,do.first="plot_bg()",col=1:5)
</code></pre>

<hr>
<h2 id='plotCI'>Plot confidence intervals/error bars</h2><span id='topic+plotCI'></span>

<h3>Description</h3>

<p>Given a set of x and y values and upper and lower bounds,
this function plots the points with error bars.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> plotCI(x,y=NULL,uiw,liw=uiw,ui=NULL,li=NULL,err="y",
  sfrac=0.01,gap=0,slty=par("lty"),add=FALSE,scol=NULL,pt.bg=par("bg"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCI_+3A_x">x</code></td>
<td>
<p>The x coordinates of points in the plot</p>
</td></tr>
<tr><td><code id="plotCI_+3A_y">y</code></td>
<td>
<p>The y coordinates of points in the plot</p>
</td></tr>
<tr><td><code id="plotCI_+3A_uiw">uiw</code></td>
<td>
<p>The width of the upper portion of the confidence region,
or (if &lsquo;<span class="samp">&#8288;liw&#8288;</span>&rsquo; is missing) the width of both halves of
the confidence region</p>
</td></tr>
<tr><td><code id="plotCI_+3A_liw">liw</code></td>
<td>
<p>The width of the lower portion of the confidence region (if
missing, the function assumes symmetric confidence bounds)</p>
</td></tr>
<tr><td><code id="plotCI_+3A_ui">ui</code></td>
<td>
<p>The absolute upper limit of the confidence region</p>
</td></tr>
<tr><td><code id="plotCI_+3A_li">li</code></td>
<td>
<p>The absolute lower limit of the confidence region</p>
</td></tr>
<tr><td><code id="plotCI_+3A_err">err</code></td>
<td>
<p>The direction of error bars: &quot;x&quot; for horizontal, &quot;y&quot;
for vertical (&quot;xy&quot; would be nice but is not implemented yet; don't
know quite how everything would be specified.  See examples for
composing a plot with simultaneous horizontal and vertical error bars)</p>
</td></tr>
<tr><td><code id="plotCI_+3A_gap">gap</code></td>
<td>
<p>Size of gap in error bars around points
(default 0;gap=TRUE gives gap size of 0.01)</p>
</td></tr>
<tr><td><code id="plotCI_+3A_sfrac">sfrac</code></td>
<td>
<p>Scaling factor for the size of the &quot;serifs&quot; (end bars) on
the confidence bars, in x-axis units</p>
</td></tr>
<tr><td><code id="plotCI_+3A_add">add</code></td>
<td>
<p>If FALSE (default), create a new plot; if TRUE, add error
bars to an existing plot.</p>
</td></tr>
<tr><td><code id="plotCI_+3A_slty">slty</code></td>
<td>
<p>Line type of error bars</p>
</td></tr>
<tr><td><code id="plotCI_+3A_scol">scol</code></td>
<td>
<p>Color of error bars: if &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; is specified in the
optional arguments, &lsquo;<span class="samp">&#8288;scol&#8288;</span>&rsquo; is set the same; otherwise it's set
to &lsquo;<span class="samp">&#8288;par(col)&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="plotCI_+3A_pt.bg">pt.bg</code></td>
<td>
<p>Background color of points (use pch=21, pt.bg=par(&quot;bg&quot;)
to get open points superimposed on error bars)</p>
</td></tr>
<tr><td><code id="plotCI_+3A_...">...</code></td>
<td>
<p>Any other parameters to be passed through to
<a href="graphics.html#topic+plot.default">plot.default</a>, <a href="graphics.html#topic+points">points</a>,
<a href="graphics.html#topic+arrows">arrows</a>, etc. (e.g. &lsquo;<span class="samp">&#8288;lwd&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;pch&#8288;</span>&rsquo;,
&lsquo;<span class="samp">&#8288;axes&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;xlim&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;ylim&#8288;</span>&rsquo;).  &lsquo;<span class="samp">&#8288;xlim&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;ylim&#8288;</span>&rsquo; are set by default to include all of the data points and
error bars.  &lsquo;<span class="samp">&#8288;xlab&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;ylab&#8288;</span>&rsquo; are set to the names of
&lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;.  If &lsquo;<span class="samp">&#8288;pch==NA&#8288;</span>&rsquo;, no points are drawn
(e.g. leaving room for text labels instead)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible(x,y); creates a plot on the current device.
</p>


<h3>Author(s)</h3>

<p>Ben Bolker (documentation and tweaking of a function provided by
Bill Venables, additional feature ideas from Gregory Warnes)</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+boxplot">boxplot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> y&lt;-runif(10)
 err&lt;-runif(10)
 plotCI(1:10,y,err,main="Basic plotCI")
 plotCI(1:10,y,err,2*err,lwd=2,col="red",scol="blue",
  main="Add colors to the points and error bars")
 err.x&lt;-runif(10)
 err.y&lt;-runif(10)
 plotCI(1:10,y,err.y,pt.bg=par("bg"),pch=21,xlim=c(0,11),
  main="plotCI with extra space on the x axis")
 plotCI(1:10,y,err.x,pt.bg=par("bg"),pch=21,err="x",add=TRUE)
 mtext("for adding horizontal error bars",3,0.5)
 data(warpbreaks)
 attach(warpbreaks)
 wmeans&lt;-by(breaks,tension,mean)
 wsd&lt;-by(breaks,tension,sd)
 ## note that barplot() returns the midpoints of the bars, which plotCI
 ##  uses as x-coordinates
 plotCI(barplot(wmeans,col="gray",ylim=c(0,max(wmeans+wsd))),wmeans,wsd,add=TRUE)
 ## using labels instead of points
 labs&lt;-sample(LETTERS,replace=TRUE,size=10)
 plotCI(1:10,y,err,pch=NA,gap=0.02,main="plotCI with labels at points")
 text(1:10,y,labs)
</code></pre>

<hr>
<h2 id='plotH'>Scatterplot with histogram-like bars.</h2><span id='topic+plotH'></span><span id='topic+plotH.formula'></span><span id='topic+plotH.default'></span>

<h3>Description</h3>

<p>Scatterplot with histogram-like bars; a modification of
&lsquo;<span class="samp">&#8288;plot(...,type="h")&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> plotH(x,...)

 ## S3 method for class 'formula'
plotH(x,data=NULL,xlab=names(mf)[2],ylab=names(mf)[1],...)

 ## Default S3 method:
plotH(x,y,xlab=paste(deparse(substitute(x))),
  ylab=paste(deparse(substitute(y))),width=0.6,ylim=NULL,col="gray",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotH_+3A_x">x</code></td>
<td>
<p>Vector of x-coordinates or a formula of the form y~x
(see below for y).</p>
</td></tr>
<tr><td><code id="plotH_+3A_y">y</code></td>
<td>
<p>Vector of y-coordinates.</p>
</td></tr>
<tr><td><code id="plotH_+3A_xlab">xlab</code></td>
<td>
<p>A string for labeling the x-axis.</p>
</td></tr>
<tr><td><code id="plotH_+3A_ylab">ylab</code></td>
<td>
<p>A string for labeling the y-axis.</p>
</td></tr>
<tr><td><code id="plotH_+3A_data">data</code></td>
<td>
<p>The data frame from which the formula should be evaluated.</p>
</td></tr>
<tr><td><code id="plotH_+3A_width">width</code></td>
<td>
<p>A numeric that indicates the width of the bars.</p>
</td></tr>
<tr><td><code id="plotH_+3A_ylim">ylim</code></td>
<td>
<p>A vector of length two that indicates the limits over which to
plot the y-axis. See details.</p>
</td></tr>
<tr><td><code id="plotH_+3A_col">col</code></td>
<td>
<p>A string that indicates the fill color for the bars.</p>
</td></tr>
<tr><td><code id="plotH_+3A_...">...</code></td>
<td>
<p>Additional arguments sent to the &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;barplot&#8288;</span>&rsquo;
functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;plotH&#8288;</span>&rsquo; is meant to be a modification of the type=&quot;h&quot; version of
&lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo; such that the &quot;bars&quot; appears as actual rectangles rather than
vertical lines. It defaults so that the lower bound of the y-axis is 0;
change to &lsquo;<span class="samp">&#8288;ylim=NULL&#8288;</span>&rsquo; to over-ride this default (and return to the
default used in &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.
</p>
<p>A pass-through to &lsquo;<span class="samp">&#8288;barplot&#8288;</span>&rsquo; is used if the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; (or &quot;RHS&quot;) variable
is categorical.
</p>


<h3>Value</h3>

<p>None, but a plot is produced.</p>


<h3>Note</h3>

<p>This function is currently experimental.</p>


<h3>Author(s)</h3>

<p>Derek Ogle</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a>, <a href="graphics.html#topic+barplot">barplot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>  d&lt;-data.frame(x=c(1,5,10:20),y=runif(13)+1,
                yn1=runif(13)-0.5,yn2=runif(13)-2,
                g=factor(sample(c("A","B","C"),13,replace=TRUE)))
  # new plotH function with formula notation
  plotH(y~x,data=d)
  # old plot() function with formula notation -- for comparison's purpose
  plot(y~x,data=d,type="h")
  # new function over-riding default ylim, increasing bar width,
  # and changing bar color
  plotH(y~x,data=d,ylim=range(d$y),width=0.9,col="red")
  # handling some negative values
  plotH(yn1~x,data=d) # not so good, because of default ylim
  plotH(yn1~x,data=d,ylim=c(0,max(d$yn1)))  # old look
  # handling all negative values
  plotH(yn2~x,data=d)
  plotH(yn2~x,data=d,ylim=range(d$yn2))  # old look
  # example of pass-through to barplot
  smry&lt;-by(d$y,d$g,mean)
  plotH(levels(d$g),smry,ylab="Mean of Random Variable",xlab="Group")
  # example of non-formula usage
  x1 &lt;- d$x
  y1 &lt;- d$y
  plotH(x1,y1,col="blue")
</code></pre>

<hr>
<h2 id='polar.plot'>Plot values on a circular grid of 0 to 360 degrees</h2><span id='topic+polar.plot'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;polar.plot&#8288;</span>&rsquo; displays a plot of radial lines, symbols or a polygon 
centered at the midpoint of the plot frame on a 0:360 circle.
Positions are interpreted as beginning at the right and moving
counterclockwise unless &lsquo;<span class="samp">&#8288;start&#8288;</span>&rsquo; specifies another starting point or
&lsquo;<span class="samp">&#8288;clockwise&#8288;</span>&rsquo; is TRUE.
</p>
<p>If &lsquo;<span class="samp">&#8288;add=TRUE&#8288;</span>&rsquo; is passed as one of the additional arguments, the values
will be added to the current plot. If a &lsquo;<span class="samp">&#8288;radial.lim&#8288;</span>&rsquo; argument was
passed on the initial plot, it must be passed again to add values or the
values will be displayed incorrectly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> polar.plot(lengths,polar.pos=NULL,labels,label.pos=NULL,
  start=0,clockwise=FALSE,rp.type="r",loglen=FALSE,explab=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polar.plot_+3A_lengths">lengths</code></td>
<td>
<p>numeric data vector. Magnitudes will be represented as
the radial positions of symbols, line ends or polygon vertices.</p>
</td></tr>
<tr><td><code id="polar.plot_+3A_polar.pos">polar.pos</code></td>
<td>
<p>numeric vector of positions on a 0:360 degree circle.
These will be converted to radians when passed to &lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="polar.plot_+3A_labels">labels</code></td>
<td>
<p>text labels to place on the periphery of the circle. This 
defaults to labels every 20 degrees. For no labels, pass an empty string.</p>
</td></tr>
<tr><td><code id="polar.plot_+3A_label.pos">label.pos</code></td>
<td>
<p>positions of the peripheral labels in degrees</p>
</td></tr>
<tr><td><code id="polar.plot_+3A_start">start</code></td>
<td>
<p>The position for zero degrees on the plot in degrees.</p>
</td></tr>
<tr><td><code id="polar.plot_+3A_clockwise">clockwise</code></td>
<td>
<p>Whether to increase angles clockwise rather than the
default counterclockwise.</p>
</td></tr>
<tr><td><code id="polar.plot_+3A_rp.type">rp.type</code></td>
<td>
<p>Whether to plot radial lines, symbols or a polygon.</p>
</td></tr>
<tr><td><code id="polar.plot_+3A_loglen">loglen</code></td>
<td>
<p>Whether to log transform the &lsquo;<span class="samp">&#8288;length&#8288;</span>&rsquo; values. Only base
10 logs are available.</p>
</td></tr>
<tr><td><code id="polar.plot_+3A_explab">explab</code></td>
<td>
<p>Whether to use the default fixed (FALSE) or exponential (TRUE)
notation for the radial labels.</p>
</td></tr>
<tr><td><code id="polar.plot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo; and
then to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the parameters altered by <a href="#topic+radial.plot">radial.plot</a>.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+radial.plot">radial.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> testlen&lt;-c(rnorm(36)*2+5)
 testpos&lt;-seq(0,350,by=10)
 polar.plot(testlen,testpos,main="Test Polar Plot",lwd=3,line.col=4)
 oldpar&lt;-polar.plot(testlen,testpos,main="Test Clockwise Polar Plot",
  radial.lim=c(0,15),start=90,clockwise=TRUE,lwd=3,line.col=4)
 # reset everything
 par(oldpar)
</code></pre>

<hr>
<h2 id='polygon.shadow'>Display a shadow effect for an arbitrary polygon</h2><span id='topic+polygon.shadow'></span>

<h3>Description</h3>

<p>Displays a shadow effect on an existing plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'> polygon.shadow(x,y=NULL,offset=NA,inflate=NA,col=c("#ffffff","#cccccc"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polygon.shadow_+3A_x">x</code>, <code id="polygon.shadow_+3A_y">y</code></td>
<td>
<p>x and y coordinate of the vertices of the polygon. &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;
can be missing if &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; is a list with &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; components.</p>
</td></tr>
<tr><td><code id="polygon.shadow_+3A_offset">offset</code></td>
<td>
<p>a vector containing the values of the x and y offsets for the
shadow. Defaults to 1/20 of the maximum x and y dimensions of the polygon.</p>
</td></tr>
<tr><td><code id="polygon.shadow_+3A_col">col</code></td>
<td>
<p>the colors of the shadow from the outer edge to the central part.</p>
</td></tr>
<tr><td><code id="polygon.shadow_+3A_inflate">inflate</code></td>
<td>
<p>the amount to &quot;inflate&quot; the shadow relative to the polygon 
(i.e. the penumbra). Defaults to the values in &lsquo;<span class="samp">&#8288;offset&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;polygon.shadow&#8288;</span>&rsquo; is typically called just before drawing a polygon.
It displays a shadow effect by drawing the polygon ten times, beginning 
with the first color in &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo; and stepping through to the second
color to create a &quot;shadow&quot; (or a &quot;halo&quot; if you prefer). Each successive
polygon is shrunk by 10% of &lsquo;<span class="samp">&#8288;inflate&#8288;</span>&rsquo;. The default shadow effect has
the light at the upper left. This effect may also be used as a text
background.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>The background must be a constant color or the shadow effect will not 
look right. A good starting point for the two colors is the color of the
background and the RGB components of that color multiplied by 0.8. Use a
smaller multiplier for a darker shadow.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+polygon">polygon</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> par(pty="s")
 plot(1:5,type="n",main="Polygon Shadow test",xlab="",ylab="",axes=FALSE)
 box()
 # do a shadow on a yellow square
 polygon(c(1,2.2,2.2,1),c(5,5,3.8,3.8),col="#ffff00")
 polygon.shadow(c(1.2,2,2,1.2),c(4.8,4.8,4,4),col=c("#ffff00","#cccc00"))
 polygon(c(1.2,2,2,1.2),c(4.8,4.8,4,4),col=c("#ff0000"))
 # a green triangle on a light blue square with a big offset
 polygon(c(4,5,5,4),c(2,2,1,1),col="#aaaaff")
 polygon.shadow(c(4.5,4.8,4.2),c(1.7,1.2,1.2),col=c("#aaaaff","#8888cc"),
  offset=c(0.1,-0.1),inflate=c(0.2,0.2))
 polygon(c(4.5,4.8,4.2),c(1.7,1.2,1.2),col=c("#00ff00"))
 # now a circle as a background
 polygon.shadow(cos(seq(0,2*pi,by=pi/20))+3,sin(seq(0,2*pi,by=pi/20))+3,
  offset=c(0,0),inflate=c(0.1,0.1))
 text(3,3,"Polygon shadow\nas a circular\ntext background",cex=1.5)
</code></pre>

<hr>
<h2 id='print.brklist'>Display the output of brkdnNest</h2><span id='topic+print.brklist'></span>

<h3>Description</h3>

<p>Displays the list of values produced by &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'brklist'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.brklist_+3A_x">x</code></td>
<td>
<p>a list of summary values produced by &lsquo;<span class="samp">&#8288;\link{brkdnNest}&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="print.brklist_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;print&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;print.brklist&#8288;</span>&rsquo; displays frequency tables produced by &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo;.
It is mainly for convenience, but does make a nicer display than when passed
directly to &lsquo;<span class="samp">&#8288;print&#8288;</span>&rsquo;
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+brkdnNest">brkdnNest</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> printbrktest&lt;-data.frame(A=c(sample(1:10,99,TRUE),NA),
  B=sample(c("Yes","No"),100,TRUE),
  C=sample(LETTERS[1:3],100,TRUE))
 pbt&lt;-brkdnNest(A~B+C,printbrktest)
 print(pbt)
</code></pre>

<hr>
<h2 id='propbrk'>Calculate the proportion of specified values in a vector</h2><span id='topic+propbrk'></span>

<h3>Description</h3>

<p>Calculates the proportion of values in a vector that are equal to a specified
value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> propbrk(x,trueval=TRUE,na.rm=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="propbrk_+3A_x">x</code></td>
<td>
<p>a character, factor or numeric vector.</p>
</td></tr>
<tr><td><code id="propbrk_+3A_trueval">trueval</code></td>
<td>
<p>the value to be matched in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="propbrk_+3A_na.rm">na.rm</code></td>
<td>
<p>whether to remove NA values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;propbrk&#8288;</span>&rsquo; calculates the proportion of values matching a specified value.
It is mainly to allow proportions to be calculated in the &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo;
function. It always discards NAs in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; when summing the number equal to
&lsquo;<span class="samp">&#8288;trueval&#8288;</span>&rsquo;, but respects the &lsquo;<span class="samp">&#8288;na.rm&#8288;</span>&rsquo; argument when calculating the
total number of values in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+brkdnNest">brkdnNest</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> propbrk(sample(LETTERS,100,TRUE),trueval="M")
</code></pre>

<hr>
<h2 id='psegments3d'> Draw segments on a 3D plot </h2><span id='topic+psegments3d'></span>

<h3>Description</h3>

<p>Draw segments on a 3D plot defined by a list of coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'> psegments3d(x,y=NULL,z=NULL,pmat,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psegments3d_+3A_x">x</code>, <code id="psegments3d_+3A_y">y</code>, <code id="psegments3d_+3A_z">z</code></td>
<td>
<p> x, y and z coordinates to plot. &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; may be a list with
three components.</p>
</td></tr>
<tr><td><code id="psegments3d_+3A_pmat">pmat</code></td>
<td>
<p> matrix to transform coordinates. </p>
</td></tr>
<tr><td><code id="psegments3d_+3A_...">...</code></td>
<td>
<p> Other arguments passed to &lsquo;<span class="samp">&#8288;segments&#8288;</span>&rsquo;. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Draws segments on a perspective plot.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>

<hr>
<h2 id='ptext3d'> Display text on a 3D plot </h2><span id='topic+ptext3d'></span>

<h3>Description</h3>

<p>Display text on a 3D plot defined by a list of coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ptext3d(x,y=NULL,z=NULL,texts,pmat,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptext3d_+3A_x">x</code>, <code id="ptext3d_+3A_y">y</code>, <code id="ptext3d_+3A_z">z</code></td>
<td>
<p> x, y and z coordinates to plot. &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; may be a list with
three components.</p>
</td></tr>
<tr><td><code id="ptext3d_+3A_pmat">pmat</code></td>
<td>
<p> matrix to transform coordinates. </p>
</td></tr>
<tr><td><code id="ptext3d_+3A_texts">texts</code></td>
<td>
<p> text to display. </p>
</td></tr>
<tr><td><code id="ptext3d_+3A_...">...</code></td>
<td>
<p> Other arguments passed to &lsquo;<span class="samp">&#8288;segments&#8288;</span>&rsquo;. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Draws text on a perspective plot.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>

<hr>
<h2 id='pyramid.plot'>Pyramid plot</h2><span id='topic+pyramid.plot'></span>

<h3>Description</h3>

<p>Displays a pyramid (opposed horizontal bar) plot on the current
graphics device.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> pyramid.plot(lx,rx,labels=NULL,top.labels=c("Male","Age","Female"),
  main="",laxlab=NULL,raxlab=NULL,unit="%",lxcol,rxcol,gap=1,space=0.2,
  ppmar=c(4,2,4,2),labelcex=1,add=FALSE,xlim,show.values=FALSE,ndig=1,
  do.first=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pyramid.plot_+3A_lx">lx</code>, <code id="pyramid.plot_+3A_rx">rx</code></td>
<td>
<p>Vectors or a matrix or data frame (see Details) which
should be of equal length.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_labels">labels</code></td>
<td>
<p>Labels for the categories represented by each pair of
bars. There should be a label for each lx or rx value, even if empty.
If &lsquo;<span class="samp">&#8288;labels&#8288;</span>&rsquo; is a matrix or data frame, the first two columns will
be used for the left and right category labels respectively.</p>
</td></tr> 
<tr><td><code id="pyramid.plot_+3A_top.labels">top.labels</code></td>
<td>
<p>The two categories represented on the left and right
sides of the plot and a heading for the labels in the center.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_main">main</code></td>
<td>
<p>Optional title for the plot.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_laxlab">laxlab</code></td>
<td>
<p>Optional labels for the left x axis ticks.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_raxlab">raxlab</code></td>
<td>
<p>Optional labels for the right x axis ticks.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_unit">unit</code></td>
<td>
<p>The label for the units of the plot.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_lxcol">lxcol</code>, <code id="pyramid.plot_+3A_rxcol">rxcol</code></td>
<td>
<p>Color(s) for the left and right sets of bars. Both of
these default to &lsquo;<span class="samp">&#8288;rainbow(length(labels))&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_gap">gap</code></td>
<td>
<p>One half of the space between the two sets of bars for the
&lsquo;<span class="samp">&#8288;labels&#8288;</span>&rsquo; in user units.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_space">space</code></td>
<td>
<p>Space between the bars. Should be 0 &lt;= space &lt; 1.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_ppmar">ppmar</code></td>
<td>
<p>Margins for the plot (see Details).</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_labelcex">labelcex</code></td>
<td>
<p>Expansion for the category labels.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_add">add</code></td>
<td>
<p>Whether to add bars to an existing plot. Usually this
involves overplotting a second set of bars, perhaps transparent.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_xlim">xlim</code></td>
<td>
<p>Optional x limit for the plot (see Details).</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_show.values">show.values</code></td>
<td>
<p>Whether to display &lsquo;<span class="samp">&#8288;lx&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;rx&#8288;</span>&rsquo; at the
ends of the bars.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_ndig">ndig</code></td>
<td>
<p>The number of digits to round the values if displayed.</p>
</td></tr>
<tr><td><code id="pyramid.plot_+3A_do.first">do.first</code></td>
<td>
<p>Optional expression to evaluate before displaying anything.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;pyramid.plot&#8288;</span>&rsquo; is principally intended for population pyramids,
although it can display other types of opposed bar charts with suitable
modification of the arguments. If the user wants a different unit for
the display, just change &lsquo;<span class="samp">&#8288;unit&#8288;</span>&rsquo; accordingly. The default gap of 
two units is usually satisfactory for the four to six percent range 
of most bars on population pyramids. If &lsquo;<span class="samp">&#8288;labels&#8288;</span>&rsquo; is a matrix or
data frame of at least two columns, the first column will be displayed
on the on the left side of the gap in the center, and the second on the
right. This will almost always require increasing the gap width and
perhaps also specifying a wider plotting device. Displaying the values
will usually require increasing the left and/or right margins of the
plot, or setting &lsquo;<span class="samp">&#8288;xlim&#8288;</span>&rsquo; larger than the largest value.
</p>
<p>If a gap width of zero is passed, the category labels will be displayed
at the left and right extents of the plot. This usually requires setting
&lsquo;<span class="samp">&#8288;xlim&#8288;</span>&rsquo; to values larger than the maximum extent of &lsquo;<span class="samp">&#8288;lx&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;rx&#8288;</span>&rsquo;. The user can pass two different values to &lsquo;<span class="samp">&#8288;xlim&#8288;</span>&rsquo;, but
this is almost always a bad idea, as the lengths of the bars will not
be in the same proportion to the values on the left and right sides.
Both the bars and category labels are vertically centered on integer
values, allowing the user to easily add components to the plot.
</p>
<p>&lsquo;<span class="samp">&#8288;lx&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;rx&#8288;</span>&rsquo; are the values specifying the left and right
extents of the left and right bars respectively. If both are matrices
or data frames, &lsquo;<span class="samp">&#8288;pyramid.plot&#8288;</span>&rsquo; will produce opposed stacked bars
with the first columns innermost. In this mode, colors are limited to
one per column. The stacked bar mode will in general not work with the
&lsquo;<span class="samp">&#8288;add&#8288;</span>&rsquo; method or with a gap of zero. Note that the stacked bar
mode can get very messy very quickly.
</p>
<p>The &lsquo;<span class="samp">&#8288;add&#8288;</span>&rsquo; argument allows one or more sets of bars to be plotted
on an existing plot. If these are not transparent, any bar that is
shorter than the bar that overplots it will disappear. Only some graphic
devices (e.g. &lsquo;<span class="samp">&#8288;pdf&#8288;</span>&rsquo;) will handle transparency.
</p>
<p>In order to add bars, the function cannot restore the initial margin values
or the new bars will not plot properly. To automatically restore the plot
margins, call the function as in the example.
</p>


<h3>Value</h3>

<p>The return value of &lsquo;<span class="samp">&#8288;par("mar")&#8288;</span>&rsquo; when the function was called.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon (thanks to Susumu Tanimura for the patch that omits
ticks for NA values in vector input and Igor Rebeiro for the space
argument)</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+rect">rect</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> xy.pop&lt;-c(3.2,3.5,3.6,3.6,3.5,3.5,3.9,3.7,3.9,3.5,3.2,2.8,2.2,1.8,
  1.5,1.3,0.7,0.4)
 xx.pop&lt;-c(3.2,3.4,3.5,3.5,3.5,3.7,4,3.8,3.9,3.6,3.2,2.5,2,1.7,1.5,
  1.3,1,0.8)
 agelabels&lt;-c("0-4","5-9","10-14","15-19","20-24","25-29","30-34",
  "35-39","40-44","45-49","50-54","55-59","60-64","65-69","70-74",
  "75-79","80-44","85+")
 mcol&lt;-color.gradient(c(0,0,0.5,1),c(0,0,0.5,1),c(1,1,0.5,1),18)
 fcol&lt;-color.gradient(c(1,1,0.5,1),c(0.5,0.5,0.5,1),c(0.5,0.5,0.5,1),18)
 par(mar=pyramid.plot(xy.pop,xx.pop,labels=agelabels,
  main="Australian population pyramid 2002",lxcol=mcol,rxcol=fcol,
  gap=0.5,show.values=TRUE))
 # three column matrices
 avtemp&lt;-c(seq(11,2,by=-1),rep(2:6,each=2),seq(11,2,by=-1))
 malecook&lt;-matrix(avtemp+sample(-2:2,30,TRUE),ncol=3)
 femalecook&lt;-matrix(avtemp+sample(-2:2,30,TRUE),ncol=3)
 # group by age
 agegrps&lt;-c("0-10","11-20","21-30","31-40","41-50","51-60",
  "61-70","71-80","81-90","91+")
 oldmar&lt;-pyramid.plot(malecook,femalecook,labels=agegrps,
  unit="Bowls per month",lxcol=c("#ff0000","#eeee88","#0000ff"),
  rxcol=c("#ff0000","#eeee88","#0000ff"),laxlab=c(0,10,20,30),
  raxlab=c(0,10,20,30),top.labels=c("Males","Age","Females"),gap=4,
  do.first="plot_bg(\"#eedd55\")")
 # put a box around it
 box()
 # give it a title
 mtext("Porridge temperature by age and sex of bear",3,2,cex=1.5)
 # stick in a legend
 legend(par("usr")[1],11,c("Too hot","Just right","Too cold"),
  fill=c("#ff0000","#eeee88","#0000ff"))
 # don't forget to restore the margins and background
 par(mar=oldmar,bg="transparent")
</code></pre>

<hr>
<h2 id='radial.grid'>Display a radial grid</h2><span id='topic+radial.grid'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;radial.grid&#8288;</span>&rsquo; displays a radial grid for the &lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;radial.pie&#8288;</span>&rsquo; functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> radial.grid(labels=NA,label.pos=NULL,radlab=FALSE,radial.lim=NULL,
  start=0,clockwise=FALSE,label.prop=1.1,grid.pos=seq(0.25,1,0.25),
  rad.col="gray",grid.col="gray",grid.bg="transparent",show.radial.grid=TRUE,
  start.plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="radial.grid_+3A_labels">labels</code></td>
<td>
<p>The labels to display around the circumference of the grid.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_label.pos">label.pos</code></td>
<td>
<p>Radial positions for the labels.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_radlab">radlab</code></td>
<td>
<p>Whether to rotate the labels to a radial orientation.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_radial.lim">radial.lim</code></td>
<td>
<p>Optional radial limits for the circular plot. If specified,
these must be the same as the radial limits of the original plot.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_start">start</code></td>
<td>
<p>The zero position on the plot in the units of &lsquo;<span class="samp">&#8288;label.pos&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_clockwise">clockwise</code></td>
<td>
<p>Whether to increase angles clockwise rather than the
default counterclockwise.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_label.prop">label.prop</code></td>
<td>
<p>Proportion of &lsquo;<span class="samp">&#8288;radial.lim&#8288;</span>&rsquo; to place the labels.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_grid.pos">grid.pos</code></td>
<td>
<p>Radial positions for the circular grid lines.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_rad.col">rad.col</code></td>
<td>
<p>Color for the radial grid lines.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_grid.col">grid.col</code></td>
<td>
<p>Color for the circumferential grid lines.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_grid.bg">grid.bg</code></td>
<td>
<p>Background color for the radial grid.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_show.radial.grid">show.radial.grid</code></td>
<td>
<p>Whether to display the radial lines on the grid.</p>
</td></tr>
<tr><td><code id="radial.grid_+3A_start.plot">start.plot</code></td>
<td>
<p>If TRUE, sets up a blank radial grid.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>

<hr>
<h2 id='radial.pie'>
Plot sectors/annuli on a circular grid of 0 to 2*pi radians
</h2><span id='topic+radial.pie'></span>

<h3>Description</h3>

<p>Plot numeric values as sectors with optional annuli on a circular field in the
directions defined by angles in radians.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> radial.pie(radial.extents,sector.edges=NULL,
 sector.colors=NULL,cs1=c(0,1),cs2=c(0,1),cs3=c(0,1),
 alpha=1,labels=NA,label.pos=NULL,radlab=FALSE,start=0,
 clockwise=FALSE,label.prop=1.1,radial.lim=NULL,main="",xlab="",ylab="",
 mar=c(2,2,3,2),show.grid=TRUE,show.grid.labels=4,show.radial.grid=TRUE,
 grid.col="gray",grid.bg="transparent",grid.unit=NULL,
 radial.labels=NULL,boxed.radial=TRUE,add=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="radial.pie_+3A_radial.extents">radial.extents</code></td>
<td>
<p>A numeric data vector or list. If &lsquo;<span class="samp">&#8288;radial.extents&#8288;</span>&rsquo;
is a list, the elements of the list will be considered separate data vectors.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_sector.edges">sector.edges</code></td>
<td>
<p>A numeric vector of positions in radians. 
These are interpreted as beginning at the right (0 radians) and moving
counterclockwise unless &lsquo;<span class="samp">&#8288;clockwise&#8288;</span>&rsquo; is TRUE.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_sector.colors">sector.colors</code></td>
<td>
<p>Optional colors for the sectors and annuli. Defaults to
&lsquo;<span class="samp">&#8288;rainbow(nsectors)&#8288;</span>&rsquo; with fading outward if annuli are specified.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_cs1">cs1</code>, <code id="radial.pie_+3A_cs2">cs2</code>, <code id="radial.pie_+3A_cs3">cs3</code>, <code id="radial.pie_+3A_alpha">alpha</code></td>
<td>
<p>Color scaling arguments - see <a href="#topic+color.scale">color.scale</a>.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_labels">labels</code></td>
<td>
<p>Character strings to be placed at the outer ends of
the lines. If set to NA, will suppress printing of labels,
but if missing, the radial positions will be used.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_label.pos">label.pos</code></td>
<td>
<p>The positions of the labels around the plot in radians.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_radlab">radlab</code></td>
<td>
<p>Whether to rotate the outer labels to a radial orientation.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_start">start</code></td>
<td>
<p>Where to place the starting (zero) point. Defaults to the
3 o'clock position.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_clockwise">clockwise</code></td>
<td>
<p>Whether to interpret positive positions as clockwise from
the starting point. The default is counterclockwise.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_label.prop">label.prop</code></td>
<td>
<p>The label position radius as a proportion of the 
maximum line length.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_radial.lim">radial.lim</code></td>
<td>
<p>The inner and outer radial limits for the plot. Defaults
to the range of radial.extents, although zero to &lsquo;<span class="samp">&#8288;max(radial.extents)&#8288;</span>&rsquo;
is often what is wanted.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_main">main</code></td>
<td>
<p>The title for the plot.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_xlab">xlab</code>, <code id="radial.pie_+3A_ylab">ylab</code></td>
<td>
<p>Normally x and y axis labels are suppressed.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_mar">mar</code></td>
<td>
<p>Margins for the plot. Allows the user to leave space for
legends, long labels, etc.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_show.grid">show.grid</code></td>
<td>
<p>Logical - whether to draw a circular grid.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_show.grid.labels">show.grid.labels</code></td>
<td>
<p>Whether and where to display labels for the grid
- see Details.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_show.radial.grid">show.radial.grid</code></td>
<td>
<p>Whether to draw radial lines to the plot labels.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_grid.col">grid.col</code></td>
<td>
<p>Color of the circular grid.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_grid.bg">grid.bg</code></td>
<td>
<p>Fill color of above.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_grid.unit">grid.unit</code></td>
<td>
<p>Optional unit description for the grid.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_radial.labels">radial.labels</code></td>
<td>
<p>Optional labels for the radial grid. The default is
the values of radial.lim.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_boxed.radial">boxed.radial</code></td>
<td>
<p>Whether to use boxed.labels or text for radial labels.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_add">add</code></td>
<td>
<p>Whether to add one or more series to an existing plot.</p>
</td></tr>
<tr><td><code id="radial.pie_+3A_...">...</code></td>
<td>
<p>Additional arguments are passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;radial.pie&#8288;</span>&rsquo; displays a plot of radial sectors with optional annular
sections centered at the midpoint of the plot frame, the lengths corresponding
to the numeric magnitudes of &lsquo;<span class="samp">&#8288;radial.extents&#8288;</span>&rsquo;.
</p>
<p>If more series are added to an existing plot,
&lsquo;<span class="samp">&#8288;radial.pie&#8288;</span>&rsquo; will try to maintain the current plot parameters. However,
it seems unlikely that adding series would be sensible in &lsquo;<span class="samp">&#8288;radial.pie&#8288;</span>&rsquo;.
This argument may be dropped if it proves useless.
</p>
<p>The size of the labels on the outside of the plot can be adjusted by 
setting &lsquo;<span class="samp">&#8288;par(cex.axis=)&#8288;</span>&rsquo; and that of the labels inside by setting
&lsquo;<span class="samp">&#8288;par(cex.lab=)&#8288;</span>&rsquo;. If &lsquo;<span class="samp">&#8288;radlab&#8288;</span>&rsquo; is TRUE, the labels will be rotated
to a radial alignment. This may help when there are many values and labels.
If some labels are still crowded, try running &lsquo;<span class="samp">&#8288;label.pos&#8288;</span>&rsquo; through the
&lsquo;<span class="samp">&#8288;spreadout&#8288;</span>&rsquo; function. If the &lsquo;<span class="samp">&#8288;show.grid.labels&#8288;</span>&rsquo; argument is a number
from 1 to 4, the labels will be placed along a horizontal or vertical radius.
The numbers represent the same positions as in &lsquo;<span class="samp">&#8288;axis&#8288;</span>&rsquo;, with the default
(4) on the right. To suppress these labels, pass zero or FALSE.
</p>
<p>&lsquo;<span class="samp">&#8288;radial.pie&#8288;</span>&rsquo; works somewhat differently from the &lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo;
family and is still under development. I have released it in order to get
feedback to improve both the design and the programming. If successful, I
hope to merge the code with the &lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo; function.
</p>


<h3>Value</h3>

<p>The &lsquo;<span class="samp">&#8288;par&#8288;</span>&rsquo; values that are changed in the function
as they were at the time &lsquo;<span class="samp">&#8288;radial.pie&#8288;</span>&rsquo; was called.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon - thanks to Patrick Jemison for asking for it.</p>


<h3>See Also</h3>

<p><a href="#topic+radial.plot">radial.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> pie1&lt;-c(3,6,5,4,7,8,9,1,4)
 pie2&lt;-list(0:3,1:6,2:5,1:4,0:7,4:8,2:9,0:1,0:4)
 pie3&lt;-sample(10:60,36)
 pie4&lt;-list(sort(sample(1:60,8)))
 for(sector in 2:36) pie4[[sector]]&lt;-sort(sample(1:60,8))
 oldpar&lt;-radial.pie(pie1,labels=LETTERS[1:9])
 radial.pie(pie2,labels=letters[2:10])
 radial.pie(pie3,labels=1:36)
 radial.pie(pie4,labels=1:36)
 # restore the par values
 par(oldpar)
</code></pre>

<hr>
<h2 id='radial.plot'>
Plot values on a circular grid of 0 to 2*pi radians
</h2><span id='topic+radial.plot'></span>

<h3>Description</h3>

<p>Plot numeric values as distances from the center of a circular field in the
directions defined by angles in radians.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> radial.plot(lengths,radial.pos=NULL,labels=NA,label.pos=NULL,radlab=FALSE,
 start=0,clockwise=FALSE,rp.type="r",label.prop=1.1,main="",xlab="",ylab="",
 line.col=par("fg"),lty=par("lty"),lwd=par("lwd"),mar=c(2,2,3,2),
 show.grid=TRUE,show.grid.labels=4,show.radial.grid=TRUE,rad.col="gray",
 grid.col="gray",grid.bg="transparent",grid.left=FALSE,grid.unit=NULL,
 point.symbols=1,point.col=par("fg"),show.centroid=FALSE,radial.lim=NULL,
 radial.labels=NULL,boxed.radial=TRUE,poly.col=NA,add=FALSE,
 loglen=FALSE,explab=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="radial.plot_+3A_lengths">lengths</code></td>
<td>
<p>A numeric data vector or matrix. If &lsquo;<span class="samp">&#8288;lengths&#8288;</span>&rsquo;
is a matrix, the rows will be considered separate data vectors.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_radial.pos">radial.pos</code></td>
<td>
<p>A numeric vector or matrix of positions in radians. 
These are interpreted as beginning at the right (0 radians) and moving
counterclockwise. If &lsquo;<span class="samp">&#8288;radial.pos&#8288;</span>&rsquo; is a matrix, the rows must 
correspond to rows of &lsquo;<span class="samp">&#8288;lengths&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_labels">labels</code></td>
<td>
<p>Character strings to be placed at the outer ends of
the lines. If set to NULL, will suppress printing of labels,
but if missing, the radial positions will be used.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_label.pos">label.pos</code></td>
<td>
<p>The positions of the labels around the plot in radians.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_radlab">radlab</code></td>
<td>
<p>Whether to rotate the outer labels to a radial orientation.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_start">start</code></td>
<td>
<p>Where to place the starting (zero) point. Defaults to the
3 o'clock position.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_clockwise">clockwise</code></td>
<td>
<p>Whether to interpret positive positions as clockwise from
the starting point. The default is counterclockwise.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_rp.type">rp.type</code></td>
<td>
<p>Whether to draw (r)adial lines, a (p)olygon, (s)ymbols, (t)ext,
or some combination of these. If &lsquo;<span class="samp">&#8288;lengths&#8288;</span>&rsquo; is a matrix and rp.type is
a vector, each row of &lsquo;<span class="samp">&#8288;lengths&#8288;</span>&rsquo; can be displayed differently.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_label.prop">label.prop</code></td>
<td>
<p>The label position radius as a proportion of the 
maximum line length.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_main">main</code></td>
<td>
<p>The title for the plot.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_xlab">xlab</code>, <code id="radial.plot_+3A_ylab">ylab</code></td>
<td>
<p>Normally x and y axis labels are suppressed.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_line.col">line.col</code></td>
<td>
<p>The color of the radial lines or polygons drawn.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_lty">lty</code></td>
<td>
<p>The line type(s) to be used for polygons or radial lines.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_lwd">lwd</code></td>
<td>
<p>The line width(s) to be used for polygons or radial lines.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_mar">mar</code></td>
<td>
<p>Margins for the plot. Allows the user to leave space for
legends, long labels, etc.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_show.grid">show.grid</code></td>
<td>
<p>Logical - whether to draw a circular grid.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_show.grid.labels">show.grid.labels</code></td>
<td>
<p>Whether and where to display labels for the grid
- see Details.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_show.radial.grid">show.radial.grid</code></td>
<td>
<p>Whether to draw radial lines to the plot labels.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_rad.col">rad.col</code></td>
<td>
<p>Color of the radial lines on the grid.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_grid.col">grid.col</code></td>
<td>
<p>Color of the circumferential lines on the grid.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_grid.bg">grid.bg</code></td>
<td>
<p>Fill color of above.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_grid.left">grid.left</code></td>
<td>
<p>Whether to place the radial grid labels on the left side.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_grid.unit">grid.unit</code></td>
<td>
<p>Optional unit description for the grid.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_point.symbols">point.symbols</code></td>
<td>
<p>The symbols for plotting (as in pch) or if
&lsquo;<span class="samp">&#8288;rp.type&#8288;</span>&rsquo; is &quot;t&quot;, the text that will be displayed.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_point.col">point.col</code></td>
<td>
<p>Colors for the symbols.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_show.centroid">show.centroid</code></td>
<td>
<p>Whether to display a centroid.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_radial.lim">radial.lim</code></td>
<td>
<p>The range of the grid circle. Defaults to
&lsquo;<span class="samp">&#8288;pretty(range(lengths))&#8288;</span>&rsquo;, but if more than two values are passed, the
exact values will be displayed.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_radial.labels">radial.labels</code></td>
<td>
<p>Optional labels for the radial grid. The default is
the values of radial.lim, or if loglen is TRUE, the corresponding log
values.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_boxed.radial">boxed.radial</code></td>
<td>
<p>Whether to use boxed.labels or text for radial labels.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_poly.col">poly.col</code></td>
<td>
<p>Fill color if polygons are drawn. Use NA for no fill.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_add">add</code></td>
<td>
<p>Whether to add one or more series to an existing plot.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_loglen">loglen</code></td>
<td>
<p>Whether to log transform the &lsquo;<span class="samp">&#8288;length&#8288;</span>&rsquo; values. Only base
10 logs are available. Keep in mind that the values actually plotted will be
the logarithms, although the exponentiated logs are displayed.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_explab">explab</code></td>
<td>
<p>Whether to use the default fixed (FALSE) or exponential (TRUE)
notation for the radial labels.</p>
</td></tr>
<tr><td><code id="radial.plot_+3A_...">...</code></td>
<td>
<p>Additional arguments are passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo; displays a plot of radial lines, polygon(s),
symbols, text or a combination of these centered at the midpoint of
the plot frame, the lengths, vertices or positions corresponding
to the numeric magnitudes of the data values. Note that if log transformation is requested with &lsquo;<span class="samp">&#8288;loglen&#8288;</span>&rsquo;, the values plotted will be the logs, not the values displayed on the plot.
If &lsquo;<span class="samp">&#8288;show.centroid&#8288;</span>&rsquo;
is TRUE, an enlarged point at the centroid of values is displayed. The
centroid is calculated as the average of x and y values unless 
&lsquo;<span class="samp">&#8288;rp.type="p"&#8288;</span>&rsquo;. In this case, the barycenter of the polygon is
calculated. Make sure that these suit your purpose, otherwise calculate
the centroid that you really want and add it with the &lsquo;<span class="samp">&#8288;points&#8288;</span>&rsquo; function.
Note that if the observations are not taken at equal intervals around the
circle, the centroid may not mean much.
</p>
<p>The &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo; option for &lsquo;<span class="samp">&#8288;rp.type&#8288;</span>&rsquo; allows the user to place text at
each point. It is useful for adding labels at arbitrary points on an existing
plot or perhaps labelling points with letters or digits rather than different symbols. See the last example.
</p>
<p>If the user wants to plot several sets of lines, points or symbols by
passing matrices or data frames of &lsquo;<span class="samp">&#8288;lengths&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;radial.pos&#8288;</span>&rsquo;,
remember that these will be grouped by row, so transpose if the data are
grouped by columns.
</p>
<p>If more series are added to an existing plot,
&lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo; will try to maintain the current plot parameters.
Resetting the parameters after doing the initial plot will almost certainly
mess up any series that are added. Series that are added will be plotted
&quot;on top&quot; of the existing plot, possibly overplotting other things. If the
added series have a larger range than the initial series, set &lsquo;<span class="samp">&#8288;radial.lim&#8288;</span>&rsquo;
to account for this in the initial plot, and if &lsquo;<span class="samp">&#8288;radial.lim&#8288;</span>&rsquo; is specified
in the initial plot, remember to repeat it for added series as in the example.
</p>
<p>The size of the labels on the outside of the plot can be adjusted by 
setting &lsquo;<span class="samp">&#8288;par(cex.axis=)&#8288;</span>&rsquo; and that of the labels inside by setting
&lsquo;<span class="samp">&#8288;par(cex.lab=)&#8288;</span>&rsquo;. If &lsquo;<span class="samp">&#8288;radlab&#8288;</span>&rsquo; is TRUE, the labels will be rotated
to a radial alignment. This may help when there are many values and labels.
If some labels are still crowded, try running &lsquo;<span class="samp">&#8288;label.pos&#8288;</span>&rsquo; through the
&lsquo;<span class="samp">&#8288;spreadout&#8288;</span>&rsquo; function. If the &lsquo;<span class="samp">&#8288;show.grid.labels&#8288;</span>&rsquo; argument is a number
from 1 to 4, the labels will be placed along a horizontal or vertical radius.
The numbers represent the same positions as in &lsquo;<span class="samp">&#8288;axis&#8288;</span>&rsquo;, with the default
(4) on the right.
</p>
<p>The radial.plot family of plots is useful for illustrating
cyclic data such as wind direction or speed (but see &lsquo;<span class="samp">&#8288;oz.windrose&#8288;</span>&rsquo;
for both), activity at different times of the day, and so on. While 
&lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo; actually does the plotting, another function is usually 
called for specific types of cyclic data.
</p>


<h3>Value</h3>

<p>The &lsquo;<span class="samp">&#8288;par&#8288;</span>&rsquo; values that are changed in the function
as they were at the time &lsquo;<span class="samp">&#8288;radial.plot&#8288;</span>&rsquo; was called.
</p>


<h3>Note</h3>

<p>Thanks to
Jeremy Claisse and Antonio Hernandez Matias for the
&lsquo;<span class="samp">&#8288;lty&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;rp.type&#8288;</span>&rsquo; suggestions respectively
</p>
<p>Patrick Baker for the request that led to &lsquo;<span class="samp">&#8288;radlab&#8288;</span>&rsquo;
</p>
<p>Thomas Steiner for the request for the &lsquo;<span class="samp">&#8288;radial.lim&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;radial.labels&#8288;</span>&rsquo; modifications
</p>
<p>Evan Daugharty for requesting the &lsquo;<span class="samp">&#8288;add&#8288;</span>&rsquo; argument
</p>
<p>James MacCarthy for requesting better radial labels
</p>
<p>Steve Ellison for noticing that the return values of the functions had changed
</p>
<p>Don Dennerline for requesting the rank clock
</p>
<p>Mehdi Nellen for the different colors for the radial and circumferential lines for the grid
</p>
<p>Mayeul Kauffmann for noticing the radial label bug when a separate radial.grid was included
</p>
<p>Ogbos Okike for requesting a text option for rp.type
</p>
<p>Keziah Conroy for requesting the log option
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+polar.plot">polar.plot</a>,<a href="#topic+clock24.plot">clock24.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> testlen&lt;-runif(10,0,10)
 testpos&lt;-seq(0,18*pi/10,length=10)
 testlab&lt;-letters[1:10]
 oldpar&lt;-radial.plot(testlen,testpos,main="Test Radial Lines",line.col="red",
  lwd=3,rad.col="lightblue")
 testlen&lt;-c(sin(seq(0,1.98*pi,length=100))+2+rnorm(100)/10)
 testpos&lt;-seq(0,1.98*pi,length=100)
 radial.plot(testlen,testpos,rp.type="p",main="Test Polygon",line.col="blue",
  labels=LETTERS[1:8],label.pos=seq(0,14*pi/8,length.out=8))
 # now do a 12 o'clock start with clockwise positive
 radial.plot(testlen,testpos,start=pi/2,clockwise=TRUE,show.grid.labels=2,
  rp.type="s",main="Test Symbols (clockwise)",radial.lim=c(0,3.5),
  point.symbols=16,point.col="green",show.centroid=TRUE,
  labels=LETTERS[1:6],label.pos=seq(0,10*pi/6,length.out=6))
 # one without the circular grid and multiple polygons
 # see the "diamondplot" function for variation on this
 posmat&lt;-matrix(sample(2:9,30,TRUE),nrow=3)
 radial.plot(posmat,labels=paste("X",1:10,sep=""),rp.type="p",
  main="Spiderweb plot",line.col=2:4,show.grid=FALSE,lwd=1:3,
  radial.lim=c(0,10))
 # dissolved ions in water
 ions&lt;-c(3.2,5,1,3.1,2.1,4.5)
 ion.names&lt;-c("Na","Ca","Mg","Cl","HCO3","SO4")
 radial.plot(ions,labels=ion.names,rp.type="p",main="Dissolved ions in water",
  grid.unit="meq/l",radial.lim=c(0,5),poly.col="yellow",show.grid.labels=3)
 # add the names of the ions to the plot
 radial.plot(ions,rp.type="t",point.symbols=ion.names,radial.lim=c(0,5),
  add=TRUE)
 # add points inside the polygon - radial.lim is supplied by plotrix_env
 radial.plot(ions-0.4,rp.type="s",point.symbols=4,point.col="red",add=TRUE)
 radmat&lt;-matrix(c(sample(1:4,4),sample(1:4,4),sample(1:4,4),sample(1:4,4),
  sample(1:4,4),sample(1:4,4),sample(1:4,4),sample(1:4,4),
  sample(1:4,4),sample(1:4,4)),nrow=4)
 # finally a rank clock
 radial.plot(radmat,rp.type="l",radial.pos=seq(0,20*pi/11.1,length.out=10),
  label.pos=seq(0,20*pi/11.1,length.out=10),start=pi/2,clockwise=TRUE,
  labels=2001:2010,radial.lim=c(0.2,4),main="Rank clock")
 legend(-1.7,4,c("Black","Red","Green","Blue"),col=1:4,lty=1)
 par(xpd=oldpar$xpd,mar=oldpar$mar,pty=oldpar$pty)
 # reset the margins
 par(mar=c(5,4,4,2))
</code></pre>

<hr>
<h2 id='radial.plot.labels'>Display labels on a circular grid</h2><span id='topic+radial.plot.labels'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;radial.plot.labels&#8288;</span>&rsquo; displays a labels on a circular plot produced by
one of the radial.plot family of functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> radial.plot.labels(lengths,radial.pos=NULL,units="radians",radial.lim=NULL,
  start=0,clockwise=FALSE,labels,adj=NULL,pos=NULL,boxed.labels=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="radial.plot.labels_+3A_lengths">lengths</code></td>
<td>
<p>numeric data vector. Magnitudes will be represented as
the radial positions of symbols, line ends or polygon vertices.</p>
</td></tr>
<tr><td><code id="radial.plot.labels_+3A_radial.pos">radial.pos</code></td>
<td>
<p>numeric vector of radial positions. These will be 
converted to radians if the &lsquo;<span class="samp">&#8288;units&#8288;</span>&rsquo; argument is not &quot;radians&quot;.</p>
</td></tr>
<tr><td><code id="radial.plot.labels_+3A_units">units</code></td>
<td>
<p>The units of &lsquo;<span class="samp">&#8288;radial.pos&#8288;</span>&rsquo; may be degrees or 24 hour clock
positions. If &lsquo;<span class="samp">&#8288;units&#8288;</span>&rsquo; is &quot;polar&quot; or &quot;clock24&quot; respectively, the
values of radial.pos will be converted into radians.</p>
</td></tr>
<tr><td><code id="radial.plot.labels_+3A_radial.lim">radial.lim</code></td>
<td>
<p>Optional radial limits for the circular plot. These
must be the same as the radial limits of the original plot.</p>
</td></tr>
<tr><td><code id="radial.plot.labels_+3A_start">start</code></td>
<td>
<p>The zero position on the plot in the units of &lsquo;<span class="samp">&#8288;radial.pos&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="radial.plot.labels_+3A_clockwise">clockwise</code></td>
<td>
<p>Whether to increase angles clockwise rather than the
default counterclockwise.</p>
</td></tr>
<tr><td><code id="radial.plot.labels_+3A_labels">labels</code></td>
<td>
<p>text labels to display on the plot.</p>
</td></tr>
<tr><td><code id="radial.plot.labels_+3A_adj">adj</code></td>
<td>
<p>Text justification as in the &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo; function.</p>
</td></tr>
<tr><td><code id="radial.plot.labels_+3A_pos">pos</code></td>
<td>
<p>Text position as in the &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo; function.</p>
</td></tr>
<tr><td><code id="radial.plot.labels_+3A_boxed.labels">boxed.labels</code></td>
<td>
<p>Whether to use &lsquo;<span class="samp">&#8288;boxed.labels&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="radial.plot.labels_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;boxed.labels&#8288;</span>&rsquo; or 
&lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Don't confuse this function with the &lsquo;<span class="samp">&#8288;radial.labels&#8288;</span>&rsquo; argument in
the radial.plot function. This labels the values rather than the grid.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+text">text</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> testlen&lt;-c(rnorm(10)*2+5)
 # do the labels in clock24 units
 testpos&lt;-c(6.74,8.3,10.55,12.33,13.75,15.9,17.15,19.36,21.02,23.27)
 oldpar&lt;-clock24.plot(testlen,testpos,main="Test radial.plot.labels",
  rp.type="s",point.symbols=3,point.col="green")
 radial.plot.labels(testlen,testpos,units="clock24",labels=LETTERS[1:10],
  pos=3,col="red")
 testangle&lt;-c(25,42,67,94,128,173,191,234,268,307)
 # now a polar plot
 polar.plot(testlen,testangle,main="Test radial.plot.labels",rp.type="p",
  poly.col="green")
 radial.plot.labels(testlen,testangle,units="polar",labels=LETTERS[1:10])
 # reset par
 par(oldpar)
</code></pre>

<hr>
<h2 id='radialtext'>Display text in a radial line</h2><span id='topic+radialtext'></span>

<h3>Description</h3>

<p>Displays a string in a radial line, rotating it to flow in the radial
direction and optionally scaling each letter's size according to its
distance from the center.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> radialtext(x, center=c(0,0), start=NA, middle=1, end=NA, angle=0,
  deg=NA, expand=0, stretch=1, nice=TRUE, cex=NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="radialtext_+3A_x">x</code></td>
<td>
<p>A character string.</p>
</td></tr>
<tr><td><code id="radialtext_+3A_center">center</code></td>
<td>
<p>The center of the circular area in x/y user units.</p>
</td></tr>
<tr><td><code id="radialtext_+3A_start">start</code></td>
<td>
<p>The starting distance of the string from the center in
x/y user units.</p>
</td></tr>
<tr><td><code id="radialtext_+3A_middle">middle</code></td>
<td>
<p>The middle distance of the string from the center in
x/y user units.</p>
</td></tr>
<tr><td><code id="radialtext_+3A_end">end</code></td>
<td>
<p>The ending distance of the string from the center in
x/y user units.</p>
</td></tr>
<tr><td><code id="radialtext_+3A_angle">angle</code></td>
<td>
<p>The angular position of the string in radians.</p>
</td></tr>
<tr><td><code id="radialtext_+3A_deg">deg</code></td>
<td>
<p>The angular position of the string in degrees
(takes precedence if not NA).</p>
</td></tr>
<tr><td><code id="radialtext_+3A_expand">expand</code></td>
<td>
<p>Size expansion factor for characters, used only if
&lsquo;<span class="samp">&#8288;start&#8288;</span>&rsquo; specified.</p>
</td></tr>
<tr><td><code id="radialtext_+3A_stretch">stretch</code></td>
<td>
<p>How much to stretch the string for appearance, 1 for none.</p>
</td></tr>
<tr><td><code id="radialtext_+3A_nice">nice</code></td>
<td>
<p>TRUE to auto-flip text to keep it upright, FALSE to let
it be upside down.</p>
</td></tr>
<tr><td><code id="radialtext_+3A_cex">cex</code></td>
<td>
<p>The overall character expansion factor, NA for par(&quot;cex&quot;).</p>
</td></tr>
<tr><td><code id="radialtext_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This may not work on all devices, as not all graphic devices can rotate text to
arbitrary angles. The output looks best on a Postscript or similar device that can
rotate text without distortion. Rotated text often looks very ragged on small bitmaps.
If the user passes a value for &lsquo;<span class="samp">&#8288;start&#8288;</span>&rsquo;, this will override a value for
&lsquo;<span class="samp">&#8288;middle&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;end&#8288;</span>&rsquo;. Likewise, a value for &lsquo;<span class="samp">&#8288;end&#8288;</span>&rsquo; will override a
value for &lsquo;<span class="samp">&#8288;middle&#8288;</span>&rsquo;. Also, a value for &lsquo;<span class="samp">&#8288;deg&#8288;</span>&rsquo; overrides any value passed
to &lsquo;<span class="samp">&#8288;angle&#8288;</span>&rsquo;. If &lsquo;<span class="samp">&#8288;expand&#8288;</span>&rsquo; is 0, all characters will be the same size,
while a value of 1 will scale characters so that one that is twice
as far from the center will be twice as large. Negative values are permitted too,
but &lsquo;<span class="samp">&#8288;expand&#8288;</span>&rsquo; is only used if &lsquo;<span class="samp">&#8288;start&#8288;</span>&rsquo; was specified.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Ted Toal</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+text">text</a>, <a href="#topic+arctext">arctext</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(0, xlim=c(1,5), ylim=c(1,5), main="Test of radialtext",
  xlab="", ylab="", type="n")
 points(3, 3, pch=20)
 radialtext("uncooked spaghetti", center=c(3,3),
  col="blue")
 radialtext("uncooked spaghetti", center=c(3,3),
  start=1.2, angle=pi/4, cex=0.8)
 radialtext("uncooked spaghetti", center=c(3,3),
  middle=1.2, angle=pi/4+0.1, cex=0.8)
 radialtext("uncooked spaghetti", center=c(3,3),
  end=1.2, angle=pi/4+0.2, cex=0.8)
 radialtext("uncooked spaghetti", center=c(3,3),
  start=0.5, deg=135, cex=0.8, col="green")
 radialtext("uncooked spaghetti", center=c(3,3),
  start=0.5, deg=145, cex=0.8, stretch=2)
 radialtext("uncooked spaghetti", center=c(3,3),
  start=0.5, deg=20, expand=0, col="red")
 radialtext("uncooked spaghetti", center=c(3,3),
  start=0.5, deg=250, expand=0.35)
 radialtext("uncooked spaghetti", center=c(3,3),
  start=0.75, deg=225, expand=1, col="gold")
 radialtext("uncooked spaghetti", center=c(3,3),
  start=0.5, deg=325, expand=-0.25, cex=2)
</code></pre>

<hr>
<h2 id='raw.means.plot'>
raw.means.plot: Raw-Means Plots for Experimental Designs
</h2><span id='topic+raw.means.plot'></span><span id='topic+raw.means.plot2'></span>

<h3>Description</h3>

<p>raw.means.plot is a function for visualizing results of experimental designs
with up to two factors. It plots both raw data (background) and factor/cell
means (foreground) to provide a more accurate visualization of the underlying
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raw.means.plot(data, col.offset = 2, col.x = 3, col.value = 4, na.rm = FALSE,
 avoid.overlap = c("y", "x", "both"), y.factor = 1, y.amount = NULL,
 x.amount = 0.05, pch = 21:25, lty = 1:5, bg.b.col = "darkgrey",
 bg.f.col = NULL, fg.b.col = "black",fg.f.col = "black", type = "o",
 pt.cex = 1, lwd = 1, xlab = "", ylab = "", ylim, max.offset = 0.2,
 xaxis = TRUE, x.labels, xaxt = "n", plot = TRUE, legend = TRUE, mar = NULL,
 reset.mar = TRUE, l.pos, yjust = 0.5, l.bty = "n", l.adj = c(0, 0.5), ...)

raw.means.plot2(data, col.id, col.offset, col.x, col.value,
 fun.aggregate = "mean", ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raw.means.plot_+3A_data">data</code></td>
<td>

<p>a &lsquo;<span class="samp">&#8288;data.frame&#8288;</span>&rsquo; in long format (i.e., each datapoint one row,
see &lsquo;<span class="samp">&#8288;\link{reshape}&#8288;</span>&rsquo; or the reshape package) that contains at least
three columns: one column coding the first factor (&lsquo;<span class="samp">&#8288;col.offset&#8288;</span>&rsquo;), one
column coding the second factor (&lsquo;<span class="samp">&#8288;col.x&#8288;</span>&rsquo;), and one column containing
the values (&lsquo;<span class="samp">&#8288;col.value&#8288;</span>&rsquo;).
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_col.id">col.id</code></td>
<td>

<p>a &lsquo;<span class="samp">&#8288;character&#8288;</span>&rsquo; scalar, specifiying the name of the column specifying the
id column. (only for &lsquo;<span class="samp">&#8288;raw.means.plot2&#8288;</span>&rsquo;)
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_col.offset">col.offset</code></td>
<td>

<p>a &lsquo;<span class="samp">&#8288;character&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;numeric&#8288;</span>&rsquo; (only &lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo;) scalar,
specifiying either name or number of the column coding the different lines
(the offset or first factor).
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_col.x">col.x</code></td>
<td>

<p>a &lsquo;<span class="samp">&#8288;character&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;numeric&#8288;</span>&rsquo; (only &lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo;) scalar,
specifiying either name or number of the column coding the x-axis factor.
Default is 3.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_col.value">col.value</code></td>
<td>

<p>a &lsquo;<span class="samp">&#8288;character&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;numeric&#8288;</span>&rsquo; (only &lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo;) scalar,
specifiying either name or number of the data column. Default is 4.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_na.rm">na.rm</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;logical&#8288;</span>&rsquo; indicating whether &lsquo;<span class="samp">&#8288;NA&#8288;</span>&rsquo; values should be stripped before
the computation proceeds. Default is &lsquo;<span class="samp">&#8288;FALSE&#8288;</span>&rsquo;. Throws an error message
if FALSE and NAs are encountered.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_avoid.overlap">avoid.overlap</code></td>
<td>

<p>character. What should happen to datapoints within one cell of the two
factors that have the same value.
</p>

<ul>
<li> <p>&lsquo;<span class="samp">&#8288;"y"&#8288;</span>&rsquo; (the default) <a href="base.html#topic+jitter">jitter</a> is added so that
overlapping points are distinguishable on the <strong>y</strong>-axis
</p>
</li>
<li> <p>&lsquo;<span class="samp">&#8288;"x"&#8288;</span>&rsquo; <a href="base.html#topic+jitter">jitter</a> is added so that overlapping points
are distinguishable on the <strong>x</strong>-axis
</p>
</li>
<li> <p>&lsquo;<span class="samp">&#8288;"both"&#8288;</span>&rsquo; <a href="base.html#topic+jitter">jitter</a> is added so that overlapping points
are distinguishable on both the <strong>y</strong>- and the <strong>x</strong>-axis.
</p>
</li>
<li><p> anything else. No jitter is added.
</p>
</li></ul>

</td></tr>
<tr><td><code id="raw.means.plot_+3A_y.factor">y.factor</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;factor&#8288;</span>&rsquo; for controlling the amount of jitter on the y-axis
(will be passed to <a href="base.html#topic+jitter">jitter</a>).
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_y.amount">y.amount</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;amount&#8288;</span>&rsquo; for controlling the amount of jitter on the y-axis
(will be passed to <a href="base.html#topic+jitter">jitter</a>).
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_x.amount">x.amount</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;amount&#8288;</span>&rsquo; for controlling the amount of jitter on the x-axis
(will be passed to <a href="base.html#topic+jitter">jitter</a>).
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_pch">pch</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;pch&#8288;</span>&rsquo; values (plot symbols) taken for plotting the data. Note that
the same values are taken for raw data and means. see <a href="graphics.html#topic+points">points</a>
for more details. Recycled if too short (with warning). Default is 21:25,
because those are the only values that can be displayed filled and non-filled.
All other values should not be used. 
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_lty">lty</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;lty&#8288;</span>&rsquo; values (line types) for connecting the means. See <a href="graphics.html#topic+par">par</a>
for more details. Recycled if too short (with warning). Default is 1:5.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_bg.b.col">bg.b.col</code></td>
<td>

<p>background border color: border color of raw data points. Silently recycled. Default:
&lsquo;<span class="samp">&#8288;"darkgrey"&#8288;</span>&rsquo; 
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_bg.f.col">bg.f.col</code></td>
<td>

<p>background filling color: fill color of raw data points. Silently recycled. Default:
&lsquo;<span class="samp">&#8288;NULL&#8288;</span>&rsquo;
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_fg.b.col">fg.b.col</code></td>
<td>

<p>foreground border color: border color of mean data points. Silently recycled. Default:
&lsquo;<span class="samp">&#8288;black&#8288;</span>&rsquo;
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_fg.f.col">fg.f.col</code></td>
<td>

<p>foreground fill color: fill color for mean data points. Silently recycled. Default:
&lsquo;<span class="samp">&#8288;black&#8288;</span>&rsquo;
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_type">type</code></td>
<td>

<p>same as type in <a href="graphics.html#topic+plot">plot</a>. Default: &lsquo;<span class="samp">&#8288;o&#8288;</span>&rsquo; (&quot;overplotted&quot;)
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_pt.cex">pt.cex</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;numeric&#8288;</span>&rsquo; specifying the &lsquo;<span class="samp">&#8288;cex&#8288;</span>&rsquo; value used for plotting the points.
Default is 1.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_lwd">lwd</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;numeric&#8288;</span>&rsquo; specifying the &lsquo;<span class="samp">&#8288;lwd&#8288;</span>&rsquo; value used for plotting the lines.
Default is 1.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_xlab">xlab</code></td>
<td>

<p>x-axis label. Default: &lsquo;<span class="samp">&#8288;""&#8288;</span>&rsquo;
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_ylab">ylab</code></td>
<td>

<p>y-axis label. Default: &lsquo;<span class="samp">&#8288;""&#8288;</span>&rsquo;
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_ylim">ylim</code></td>
<td>

<p>the y-axis limits of the plot. If not specified (the default) will be taken
from data so that all raw data points are visible and a warning message is
displayed specifying the ylim.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_max.offset">max.offset</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;numeric&#8288;</span>&rsquo;. maximal offset of factor levels from the offset factor
(&lsquo;<span class="samp">&#8288;col.offset&#8288;</span>&rsquo;) specifying the different lines. The centre of each factor
on the x-axis is at full numbers (starting from 1 to ...). The maximum will
only be reached if the number of factor levels (from &lsquo;<span class="samp">&#8288;col.offset&#8288;</span>&rsquo;) is
even. Default: 0.2.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_xaxis">xaxis</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;logical&#8288;</span>&rsquo; value indicating whether or not the x-axis should be generated
by &lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo;. If &lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo;, labels for the x-axis will be taken
either from the unique values of &lsquo;<span class="samp">&#8288;col.x&#8288;</span>&rsquo; or can be specified with
&lsquo;<span class="samp">&#8288;x.labels&#8288;</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_x.labels">x.labels</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;character&#8288;</span>&rsquo; vector specifiying &lsquo;<span class="samp">&#8288;col.x&#8288;</span>&rsquo; levels. Only relevant if
&lsquo;<span class="samp">&#8288;xaxis=TRUE&#8288;</span>&rsquo;. Then, the values given here will be displayed at the
x-axis for each factor level of &lsquo;<span class="samp">&#8288;col.x&#8288;</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_xaxt">xaxt</code></td>
<td>

<p>A character which specifies whether ot not the x-axis should be plotted by
the call to plot function. Interfers with the aforementioned &lsquo;<span class="samp">&#8288;xaxis&#8288;</span>&rsquo;
argument and the automatic &lsquo;<span class="samp">&#8288;xaxis&#8288;</span>&rsquo; function by &lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo;.
Just there for completeness. Default &lsquo;<span class="samp">&#8288;"n"&#8288;</span>&rsquo; (and should not be changed).
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_plot">plot</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;logical&#8288;</span>&rsquo;. Should the &lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo; be drawn or not. If
&lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo; (the default) plot will be drawn. If &lsquo;<span class="samp">&#8288;FALSE&#8288;</span>&rsquo; only the legend
will be drawn (if &lsquo;<span class="samp">&#8288;legend = TRUE&#8288;</span>&rsquo;) See details.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_legend">legend</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;logical&#8288;</span>&rsquo; indicating whether or not &lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo; should
automatically add a legend on the right outside the plot area indicating
which line and points refer to which &lsquo;<span class="samp">&#8288;col.offset&#8288;</span>&rsquo; factor levels. Default
is &lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_mar">mar</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;NULL&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;numerical&#8288;</span>&rsquo; vector of length 4 indicating the margins of
the plot (see <a href="graphics.html#topic+par">par</a>). If &lsquo;<span class="samp">&#8288;NULL&#8288;</span>&rsquo; (the default) the right
margin (i.e., &lsquo;<span class="samp">&#8288;par("mar")[4]&#8288;</span>&rsquo;) will be (imperfectly) guessed from the
&lsquo;<span class="samp">&#8288;col.offset&#8288;</span>&rsquo; factors for placing the legend right to the plot. If length
is four this value will be taken. Ignored for &lsquo;<span class="samp">&#8288;plot = FALSE&#8288;</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_reset.mar">reset.mar</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;logical&#8288;</span>&rsquo; indicating if the margins (&lsquo;<span class="samp">&#8288;mar&#8288;</span>&rsquo;) shall be resetted after
setting internally. Will be ignored if &lsquo;<span class="samp">&#8288;legend = FALSE&#8288;</span>&rsquo;. Default is
&lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo; and should not be changed (especially with &lsquo;<span class="samp">&#8288;plot = FLASE&#8288;</span>&rsquo;).
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_l.pos">l.pos</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;numeric&#8288;</span>&rsquo; vector of length 2 indicating the position of the legend. If
not specified automatically determined. See details.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_yjust">yjust</code></td>
<td>

<p>how the legend is to be justified relative to the legend y location. A value
of 0 means top, 0.5 means centered and 1 means bottom justified. Default is
0.5.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_l.bty">l.bty</code></td>
<td>

<p>the type of box to be drawn around the legend. The allowed values are
&lsquo;<span class="samp">&#8288;"o"&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;"n"&#8288;</span>&rsquo; (the default).
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_l.adj">l.adj</code></td>
<td>

<p>&lsquo;<span class="samp">&#8288;numeric&#8288;</span>&rsquo; of length 1 or 2; the string adjustment for legend text. Useful
for y-adjustment when labels are plotmath expression. see <a href="graphics.html#topic+legend">legend</a>
and <a href="grDevices.html#topic+plotmath">plotmath</a> for more info.
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_...">...</code></td>
<td>

<p>further arguments which are either passed to plot or legend (or
&lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo; for &lsquo;<span class="samp">&#8288;raw.means.plot2&#8288;</span>&rsquo;). The following arguments
are passed to legend, all others are passed to plot:
&lsquo;<span class="samp">&#8288;"fill", "border", "angle", "density", "box.lwd", "box.lty", "box.col",
 "pt.cex", "pt.lwd", "xjust", "x.intersp", "y.intersp", "text.width",
 "text.col", "merge", "trace", "plot", "ncol", "horiz", "title", "inset",
 "title.col", "title.adj"&#8288;</span>&rsquo;
</p>
</td></tr>
<tr><td><code id="raw.means.plot_+3A_fun.aggregate">fun.aggregate</code></td>
<td>

<p>Function or function name used for aggregating the data across the two
factors. Default is &lsquo;<span class="samp">&#8288;"mean"&#8288;</span>&rsquo;. (only for &lsquo;<span class="samp">&#8288;raw.means.plot2&#8288;</span>&rsquo;)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;raw.means.plot2&#8288;</span>&rsquo; is probably the more useful function, as it allows for
using a data.frame with more than two-factors and aggregates across the other
factors, but needs a column specifying the experimental unit (e.g.,
participant).
</p>
<p>&lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo; is basically an advanced wrapper for two other
functions: <a href="graphics.html#topic+plot">plot</a> and (if &lsquo;<span class="samp">&#8288;legend=TRUE&#8288;</span>&rsquo;)
<a href="graphics.html#topic+legend">legend</a>. Furthermore, raw data is plotted with a call to
<a href="graphics.html#topic+points">points</a> and the means with a call to <a href="graphics.html#topic+lines">lines</a>.
</p>
<p>You can use &lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo; to plot only a legend by setting
&lsquo;<span class="samp">&#8288;plot = FALSE&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;legend = TRUE&#8288;</span>&rsquo;. Then, &lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo;
will draw an invisible plot with &lsquo;<span class="samp">&#8288;xlim = c(0,10)&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;ylim = c(0, 10)&#8288;</span>&rsquo; and place the legend on this invisible plot. You
can specify &lsquo;<span class="samp">&#8288;l.pos&#8288;</span>&rsquo; to position the legend, otherwise it will be plotted
at &lsquo;<span class="samp">&#8288;c(5,5)&#8288;</span>&rsquo; (i.e., in the middle of the plot). Note that
&lsquo;<span class="samp">&#8288;xpd = TRUE&#8288;</span>&rsquo; in the call to &lsquo;<span class="samp">&#8288;legend&#8288;</span>&rsquo; (see <a href="graphics.html#topic+par">par</a>).
</p>


<h3>Value</h3>

<p>Nothing. This function is invoked for its side effects.
</p>


<h3>Author(s)</h3>

<p>Henrik Singmann (<a href="mailto:henrik.singmann@psychologie.uni-freiburg.de">henrik.singmann@psychologie.uni-freiburg.de</a>) with
ideas from Jim Lemon
</p>


<h3>See Also</h3>

<p><a href="#topic+add.ps">add.ps</a> can be used in addition to&lsquo;<span class="samp">&#8288;raw.means.plot&#8288;</span>&rsquo; to
compare the factors at each x-axis position, by adding p-values from t-tests
to the x-axis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- data.frame(id = 1:150, offset = rep(c("Group A", "Group B", "Group C"),
 each = 50), xaxis = sample(c("A", "B", "C", "D"),150, replace = TRUE),
 data = c(rnorm(50, 10, 5), rnorm(50, 15,6), rnorm(50, 20, 5)))

raw.means.plot(x)

raw.means.plot(x, main = "Example", ylab = "Values", xlab = "Factor",
 title = "Groups")

raw.means.plot(x, "offset", "xaxis", "data")

raw.means.plot(x, "xaxis", "offset", "data")

raw.means.plot(x, 3, 2, 4)

# different colors:
raw.means.plot(x, main = "Example", ylab = "Values", xlab = "Factor",
 title = "Groups", fg.f.col = c("red","blue", "green"))

x2 &lt;- data.frame(id = 1:150, offset = rep(c("Group A", "Group B", "Group C"),
 each = 50), xaxis = sample(c("A", "B", "C", "D"),150, replace = TRUE),
 data = c(rnorm(50, 10, 5), rnorm(50, 15,6), rnorm(50, 20, 5)))

layout(matrix(c(1,2,3,3), 2,2,byrow = TRUE), heights = c(7,1))
raw.means.plot(x, main = "Data x1", ylab = "Values", xlab = "Factor",
 legend = FALSE, mar = c(4,4,4,1)+0.1)
raw.means.plot(x2, main = "Data x2", ylab = "Values", xlab = "Factor",
 legend = FALSE, mar = c(4,4,4,1)+0.1)
raw.means.plot(x2, plot = FALSE, title = "Groups")


y &lt;- data.frame(id = 1:300, offset = rep(1, 300),
 axis = sample(LETTERS[1:6],300, replace = TRUE), data = c(rnorm(100, 1),
 rnorm(100), rnorm(100,1)))

par(mfrow = c(2,2))

raw.means.plot(y, legend = FALSE)

raw.means.plot(y, type = "p", legend = FALSE)

raw.means.plot(y, type = "l", legend = FALSE)

raw.means.plot(y, 3, 2, x.labels = "one group only")


# Example with overlapping points
z &lt;- data.frame (id = 1:200, offset = rep(c("C 1", "C 2"), 200),
 axis = sample(LETTERS[1:4], 200, replace = TRUE),
 data = sample(1:20, 200, replace = TRUE))

# x versus y jitter
par(mfrow = c(2,2))
raw.means.plot(z, avoid.overlap = "none", main = "no-jitter")
raw.means.plot(z, main = "y-axis jitter (default)")
raw.means.plot(z, avoid.overlap = "x", main = "x-axis jitter")
raw.means.plot(z, avoid.overlap = "both", main = "both-axis jitter")


# y-axis jitter (default)
par(mfrow = c(2,2))
raw.means.plot(z, avoid.overlap = "none", main = "no jitter")
raw.means.plot(z, y.factor = 0.5, main = "smaller y-jitter")
raw.means.plot(z, main = "standard y-jitter")
raw.means.plot(z, y.factor = 2, main = "bigger y-jitter")


# x-axis jitter (default)
par(mfrow = c(2,2))
raw.means.plot(z, avoid.overlap = "none", main = "no jitter")
raw.means.plot(z, avoid.overlap = "x", x.amount = 0.025,
 main = "smaller x -jitter")
raw.means.plot(z, avoid.overlap = "x", main = "standard x-jitter")
raw.means.plot(z, avoid.overlap = "x", x.amount= 0.1,
 main = "bigger x-jitter")



## Not run: 

#The examples uses the OBrienKaiser dataset from car and needs reshape.
require(reshape)
require(car)
data(OBrienKaiser)
OBKnew &lt;- cbind(factor(1:nrow(OBrienKaiser)), OBrienKaiser)
colnames(OBKnew)[1] &lt;- "id"
OBK.long &lt;- melt(OBKnew)
OBK.long[, c("measurement", "time")] &lt;-
 t(vapply(strsplit(as.character(OBK.long$variable), "\\."),  "[", c("", "")))

raw.means.plot2(OBK.long, "id", "measurement", "gender", "value")

raw.means.plot2(OBK.long, "id", "treatment", "gender", "value")

# also use add.ps:
# For this example the position at each x-axis are within-subject comparisons!
raw.means.plot2(OBK.long, "id", "measurement", "gender", "value")
add.ps(OBK.long, "id", "measurement", "gender", "value", paired = TRUE)
 #reference is "fup"

raw.means.plot2(OBK.long, "id", "measurement", "gender", "value")
add.ps(OBK.long, "id", "measurement", "gender", "value", ref.offset = 2,
 paired = TRUE) #reference is "post"

# Use R's standard (i.e., Welch test)
raw.means.plot2(OBK.long, "id", "treatment", "gender", "value")
add.ps(OBK.long, "id", "treatment", "gender", "value",
 prefixes = c("p(control vs. A)", "p(control vs. B)"))

# Use standard t-test
raw.means.plot2(OBK.long, "id", "treatment", "gender", "value")
add.ps(OBK.long, "id", "treatment", "gender", "value", var.equal = TRUE,
 prefixes = c("p(control vs. A)", "p(control vs. B)"))


## End(Not run)

</code></pre>

<hr>
<h2 id='rectFill'>Draw a rectangle filled with symbols</h2><span id='topic+rectFill'></span>

<h3>Description</h3>

<p>Draws a rectangle on the current figure filled with arbitrary symbols.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> rectFill(x1,y1,x2,y2,fg=par("fg"),bg=par("bg"),xinc=NA,yinc=NA,
  pch=1,pch.cex=1,pch.col=par("fg"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rectFill_+3A_x1">x1</code>, <code id="rectFill_+3A_y1">y1</code>, <code id="rectFill_+3A_x2">x2</code>, <code id="rectFill_+3A_y2">y2</code></td>
<td>
<p>Rectangle limits as in &lsquo;<span class="samp">&#8288;rect&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="rectFill_+3A_fg">fg</code></td>
<td>
<p>Foreground color</p>
</td></tr>
<tr><td><code id="rectFill_+3A_bg">bg</code></td>
<td>
<p>Background color</p>
</td></tr>
<tr><td><code id="rectFill_+3A_xinc">xinc</code>, <code id="rectFill_+3A_yinc">yinc</code></td>
<td>
<p>The x and y increments of spacing for the symbols.</p>
</td></tr>
<tr><td><code id="rectFill_+3A_pch">pch</code></td>
<td>
<p>Which symbol to use</p>
</td></tr>
<tr><td><code id="rectFill_+3A_pch.cex">pch.cex</code></td>
<td>
<p>Character expansion for the symbols.</p>
</td></tr>
<tr><td><code id="rectFill_+3A_pch.col">pch.col</code></td>
<td>
<p>Color(s) for the symbols. </p>
</td></tr>
<tr><td><code id="rectFill_+3A_...">...</code></td>
<td>
<p>Additional arguments to &lsquo;<span class="samp">&#8288;points&#8288;</span>&rsquo; for the symbols.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;rectFill&#8288;</span>&rsquo; draws a rectangle and fills the rectangle with the
symbols requested. It is probably most useful as a substitute for
fill colors in a black and white environment.
</p>


<h3>Value</h3>

<p> nil </p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+rect">rect</a>, <a href="graphics.html#topic+points">points</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(1:7,type="n",xlab="",ylab="",main="Test of rectFill")
 rectFill(1:6,1:6,2:7,2:7,bg=2:7,pch=c("+","*","o",".","#","^"),
  xinc=c(0.2,0.1,0.2,0.1,0.2,0.2),yinc=c(0.2,0.1,0.2,0.1,0.2,0.2),
  pch.col=1:6)
 barp(matrix(runif(9),nrow=3),main="Black and white bar plot",pch=1:3)
</code></pre>

<hr>
<h2 id='rescale'>Scale numbers into a new range</h2><span id='topic+rescale'></span>

<h3>Description</h3>

<p>Scale a vector or matrix of numbers into a new range.</p>


<h3>Usage</h3>

<pre><code class='language-R'> rescale(x,newrange)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rescale_+3A_x">x</code></td>
<td>
<p>A numeric vector, matrix or data frame.</p>
</td></tr>
<tr><td><code id="rescale_+3A_newrange">newrange</code></td>
<td>
<p>The minimum and maximum value of the range into which
&lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; will be scaled.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;rescale&#8288;</span>&rsquo; performs a simple linear conversion of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; into the
range specified by &lsquo;<span class="samp">&#8288;newrange&#8288;</span>&rsquo;. Only numeric vectors, matrices or data
frames with some variation will be accepted. NAs are now preserved - 
formerly the function would fail.
</p>


<h3>Value</h3>

<p>On success, the rescaled object, otherwise the original object.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>Examples</h3>

<pre><code class='language-R'> # scale one vector into the range of another
 normal.counts&lt;-rnorm(100)
 normal.tab&lt;-tabulate(cut(normal.counts,breaks=seq(-3,3,by=1)))
 normal.density&lt;-rescale(dnorm(seq(-3,3,length=100)),range(normal.tab))
 # now plot them
 plot(c(-2.5,-1.5,-0.5,0.5,1.5,2.5),normal.tab,xlab="X values",
  type="h",col="green")
 lines(seq(-3,3,length=100),normal.density,col="blue")
</code></pre>

<hr>
<h2 id='revaxis'> Plot with axis direction(s) reversed </h2><span id='topic+revaxis'></span>

<h3>Description</h3>

<p>Reverses the sense of either or both the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; axes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>revaxis(x, y, xrev=FALSE, yrev=TRUE, xside=if (yrev) 3 else 1,
       yside=if (xrev) 4 else 2, xlab=NULL, ylab=NULL, bty=NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="revaxis_+3A_x">x</code></td>
<td>
<p> Vector of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;-coordinates of the data to be plotted. </p>
</td></tr>
<tr><td><code id="revaxis_+3A_y">y</code></td>
<td>
<p> Vector of &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;-coordinates of the data to be plotted. </p>
</td></tr>
<tr><td><code id="revaxis_+3A_xrev">xrev</code></td>
<td>
<p> Logical scalar; should the sense of the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;-axis
be reversed?</p>
</td></tr>
<tr><td><code id="revaxis_+3A_yrev">yrev</code></td>
<td>
<p> Logical scalar; should the sense of the &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;-axis
be reversed?</p>
</td></tr>
<tr><td><code id="revaxis_+3A_xside">xside</code></td>
<td>
<p> The side of the plot on which the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;-axis labels
should go.</p>
</td></tr>
<tr><td><code id="revaxis_+3A_yside">yside</code></td>
<td>
<p> The side of the plot on which the &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;-axis labels
should go.</p>
</td></tr>
<tr><td><code id="revaxis_+3A_xlab">xlab</code></td>
<td>
<p> Character string for labelling the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;-axis. </p>
</td></tr>
<tr><td><code id="revaxis_+3A_ylab">ylab</code></td>
<td>
<p> Character string for labelling the &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;-axis. </p>
</td></tr>
<tr><td><code id="revaxis_+3A_bty">bty</code></td>
<td>
<p> Single letter indicating the type of box to be drawn
around the plot. See <a href="graphics.html#topic+par">par</a> for the possible letters
and their meaning.</p>
</td></tr>
<tr><td><code id="revaxis_+3A_...">...</code></td>
<td>
<p> Other arguments to be passed to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> nil </p>


<h3>Author(s)</h3>

<p>Rolf Turner</p>


<h3>See Also</h3>

 <p><a href="graphics.html#topic+plot">plot</a>, <a href="graphics.html#topic+box">box</a>, <a href="graphics.html#topic+par">par</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- runif(20)
y &lt;- runif(20)
revaxis(x,y,yside=4)
</code></pre>

<hr>
<h2 id='ruginv'>Add an Inverse Rug to a Plot</h2><span id='topic+ruginv'></span>

<h3>Description</h3>

<p>Adds a <em>rug</em> representation (1D plot) of the data to the plot,
but with the coloring inverted.</p>


<h3>Usage</h3>

<pre><code class='language-R'> ruginv(x,ticksize=0.03,side=1,lwd=0.5,col=par("fg"),col.ticks="white",
 quiet=getOption("warn") &lt; 0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ruginv_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="ruginv_+3A_ticksize">ticksize</code></td>
<td>
<p>The length of the ticks making up the 'rug'. Positive lengths
produce inward ticks.</p>
</td></tr>
<tr><td><code id="ruginv_+3A_side">side</code></td>
<td>
<p>On which side of the plot box the rug will appear. Usually 1
(bottom) or 3 (top).</p>
</td></tr>
<tr><td><code id="ruginv_+3A_lwd">lwd</code></td>
<td>
<p>The line width of the ticks.</p>
</td></tr>
<tr><td><code id="ruginv_+3A_col">col</code></td>
<td>
<p>Color of the background of the ticks.</p>
</td></tr>
<tr><td><code id="ruginv_+3A_col.ticks">col.ticks</code></td>
<td>
<p>The color of the ticks.</p>
</td></tr>
<tr><td><code id="ruginv_+3A_quiet">quiet</code></td>
<td>
<p>Logical indicating if there should be a warning about clipped
values.</p>
</td></tr>
<tr><td><code id="ruginv_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <a href="graphics.html#topic+polygon">polygon</a> when plotting the
background for the ticks.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Solymos</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+rug">rug</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> require(stats)
 plot(density(faithful$eruptions,bw=0.15))
 ruginv(faithful$eruptions,ticksize=-0.05)
 ruginv(jitter(faithful$eruptions,amount=0.01),side=3,col="lightblue")
</code></pre>

<hr>
<h2 id='seats'>Arrange N seats in M semicircular rows</h2><span id='topic+seats'></span>

<h3>Description</h3>

<p>Compute seat positions in a semicircular parliament</p>


<h3>Usage</h3>

<pre><code class='language-R'>seats(N, M, r0 = 2.5)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seats_+3A_n">N</code></td>
<td>
<p>Total number of seats.</p>
</td></tr>
<tr><td><code id="seats_+3A_m">M</code></td>
<td>
<p>Number of semicircular arcs on which to distribute the seats.</p>
</td></tr>
<tr><td><code id="seats_+3A_r0">r0</code></td>
<td>
<p>Radius of the inner arc in user units.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame including:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The x positions of the seats to be plotted on semi-circular
arcs.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The y positions of the seats to be plotted on semi-circular
arcs.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>The row numbers for each seat.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>The angle of each seat, going from pi to zero radians.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Duncan Murdoch and Barry Rowlingson</p>


<h3>See Also</h3>

<p><a href="#topic+election">election</a></p>

<hr>
<h2 id='size_n_color'>Display circles with specified size and color</h2><span id='topic+size_n_color'></span>

<h3>Description</h3>

<p>Display a plot of circles at specified locations, each with a
specified size and color.</p>


<h3>Usage</h3>

<pre><code class='language-R'> size_n_color(x=NULL,y,size,sizefun="sqrt",col,main="",
  xlim=NA,xlab="",xat=NULL,xaxlab=NULL,xcex=1,xlas=0,xgrid=FALSE,
  ylim=NA,ylab="",yat=NULL,yaxlab=NULL,ycex=1,ylas=1,ygrid=TRUE,
  mar=c(5,4,4,2),boxit=TRUE,add=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="size_n_color_+3A_x">x</code>, <code id="size_n_color_+3A_y">y</code></td>
<td>
<p>Vectors or matrices of x and y positions for the symbols.</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_size">size</code></td>
<td>
<p>Sizes for the symbols expressed as numbers.</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_sizefun">sizefun</code></td>
<td>
<p>The function to use for transforming the values to radii
of circles. Square root gives areas proportional to the values.</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_col">col</code></td>
<td>
<p>Colors for the symbols (see Details).</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_main">main</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_xlim">xlim</code>, <code id="size_n_color_+3A_ylim">ylim</code></td>
<td>
<p>Explicit x and y limits for the plot</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="size_n_color_+3A_xlab">xlab</code>, <code id="size_n_color_+3A_ylab">ylab</code></td>
<td>
<p>Labels for the x and y axes.</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_xat">xat</code>, <code id="size_n_color_+3A_yat">yat</code></td>
<td>
<p>Where to place the ticks and tick labels on the axes.</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_xaxlab">xaxlab</code>, <code id="size_n_color_+3A_yaxlab">yaxlab</code></td>
<td>
<p>Tick labels for the x and y axes.</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_xcex">xcex</code>, <code id="size_n_color_+3A_ycex">ycex</code></td>
<td>
<p>Character expansions for the axis tick labels.</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_xlas">xlas</code>, <code id="size_n_color_+3A_ylas">ylas</code></td>
<td>
<p>Orientation for the axis tick labels (see &lsquo;<span class="samp">&#8288;par&#8288;</span>&rsquo;).</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_xgrid">xgrid</code>, <code id="size_n_color_+3A_ygrid">ygrid</code></td>
<td>
<p>Whether to display a grid along the x or y direction.</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_mar">mar</code></td>
<td>
<p>Margins for the plot (see Details).</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_boxit">boxit</code></td>
<td>
<p>Whether to draw a box around the plot.</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_add">add</code></td>
<td>
<p>Whether to draw a new plot (FALSE) or add symbols to an existing
plot (TRUE).</p>
</td></tr>
<tr><td><code id="size_n_color_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;size_n_color&#8288;</span>&rsquo; plots circles centered on the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;
coordinates. The size and color of the circles may also be specified
individually, allowing four dimensions of variation to be displayed on the
plot.
</p>
<p>&lsquo;<span class="samp">&#8288;size_n_color&#8288;</span>&rsquo; may also be used to display a &quot;visual table&quot; as in the second
example. Here the x and y coordinates are used to associate the symbols with
two categorical variables, underlying cause of death and year of observation.
If the x values are not passed to the function, it will try to space out the
circles evenly in a representation of the matrix. If the matrix is not square,
use a plotting device that has about the same proportion of height and width as
the matrix.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a>, <a href="graphics.html#topic+points">points</a>, <a href="graphics.html#topic+par">par</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> meantemp&lt;-c(19,22,25,29,21,20,16,27,23,26)
 totalrain&lt;-c(174,152,196,120,177,183,92,153,161,85)
 numpumpkin&lt;-c(53,47,61,63,38,42,48,71,66,29)
 meanwt&lt;-c(1.5,2.3,2.8,1.9,2.4,1.8,2.6,2.2,1.7)
 size_n_color(meantemp,totalrain,meanwt/5,NA,xlim=c(15,30),
  color.scale(numpumpkin,c(0.8,0),c(0.8,1),0),
  xlab="Temperature (degrees C)",ylab="Rainfall (mm)",
  main="Number and weight of pumpkins by temperature and rainfall",
  xat=seq(15,30,by=5),yat=seq(80,200,by=20))  
 color.legend(15,55,18.5,60,seq(40,70,by=10),
  rect.col=color.scale(seq(40,70,by=10),c(0.8,0),c(0.8,1),0))
 points(15:18,rep(126,4),cex=seq(1.5,3.0,by=0.5))
 text(15:19,rep(134,5),c("1.5","2.0","2.5","3.0","kg"))
 par(xpd=TRUE)
 text(13.5,60,"Number of\npumpkins")
 par(xpd=FALSE)
 # now display a "visual table" of delayed registrations by underlying cause of
 # death and year of observation. The sizes of the circles represent the log of
 # the number of deaths and the colors represent the percentage of deaths that
 # occurred in the year prior to registration or earlier
 data(death_reg)
 size_n_color(x=matrix(rep(1996:2010,each=22),nrow=22),
  y=matrix(rep(1:22,15),nrow=22),size=t(death_reg[[1]])/200,
  col=color.scale(t(death_reg[[2]]),c(0,0.8,1),c(1,0.2,0),0),
  ylim=c(1,22),main="Delayed registrations by ICD chapter",
  xlab="Year",xaxlab=1996:2010,xat=1996:2010,xcex=0.8,
  yaxlab=colnames(death_reg[[1]]),ycex=0.8,ygrid=TRUE,mar=c(5,6,4,2))
 color.legend(1994,-3.5,2000,-2.5,seq(0,50,by=10),cex=0.8,
  rect.col=color.scale(seq(0,50,by=10),c(0,0.8,1),c(1,0.2,0),0))
 par(xpd=TRUE)
 text(1993.4,-2.5,"Pct.\nslow",cex=0.8)
 par(xpd=FALSE)
</code></pre>

<hr>
<h2 id='sizeplot'>Plot with repeated symbols by size</h2><span id='topic+sizeplot'></span>

<h3>Description</h3>

<p>Plots a set of (x,y) data with repeated points denoted by larger
symbol sizes
</p>


<h3>Usage</h3>

<pre><code class='language-R'> sizeplot(x, y, scale=1, pow=0.5, powscale=TRUE, size=c(1,4), add=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sizeplot_+3A_x">x</code></td>
<td>
<p>x coordinates of data</p>
</td></tr>
<tr><td><code id="sizeplot_+3A_y">y</code></td>
<td>
<p>y coordinates of data</p>
</td></tr>
<tr><td><code id="sizeplot_+3A_scale">scale</code></td>
<td>
<p>scaling factor for size of symbols</p>
</td></tr>
<tr><td><code id="sizeplot_+3A_pow">pow</code></td>
<td>
<p>power exponent for size of symbols</p>
</td></tr>
<tr><td><code id="sizeplot_+3A_powscale">powscale</code></td>
<td>
<p>(logical) use power scaling for symbol size?</p>
</td></tr>
<tr><td><code id="sizeplot_+3A_size">size</code></td>
<td>
<p>(numeric vector) min and max size for scaling, if powscale=FALSE</p>
</td></tr>
<tr><td><code id="sizeplot_+3A_add">add</code></td>
<td>
<p>(logical) add to an existing plot?</p>
</td></tr>
<tr><td><code id="sizeplot_+3A_...">...</code></td>
<td>
<p>other arguments to &lsquo;<span class="samp">&#8288;plot()&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;points()&#8288;</span>&rsquo;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Most useful for plotting (e.g.) discrete data, where repeats are
likely.  If all points are repeated equally, gives a warning.  The
size of a point is given by <code class="reqn">scale*n^pow</code>, where n is the number of
repeats, if powscale is TRUE, or it is scaled between size[1] and size[2],
if powscale is FALSE.
</p>


<h3>Value</h3>

<p>A plot is produced on the current device, or points are added to the
current plot if &lsquo;<span class="samp">&#8288;add=TRUE&#8288;</span>&rsquo;.
</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+symbols">symbols</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x &lt;- c(0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.3,0.3)
 y &lt;- c( 1,  1,  1,  1,  2,  2,  2,  3,  3,  4,  5 )
 plot(x,y)
 sizeplot(x,y)
 sizeplot(x,y,pch=2)
</code></pre>

<hr>
<h2 id='sizetree'>Display a hierarchical breakdown of disjunct categories</h2><span id='topic+sizetree'></span>

<h3>Description</h3>

<p>Display a data frame in which the values in each successive
column represent subcategories of the previous column as stacked
rectangles.</p>


<h3>Usage</h3>

<pre><code class='language-R'> sizetree(x,left=0,top,right=1,lastcenter=NA,showval=TRUE,showcount=TRUE,
  stacklabels=TRUE,firstcall=TRUE,col=NULL,border=NA,toplab=NULL,base.cex=1,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sizetree_+3A_x">x</code></td>
<td>
<p>A data frame in which each successive column represents
subcategories of the previous column.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_left">left</code></td>
<td>
<p>The left edge of the current stack of rectangles in user units.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_top">top</code></td>
<td>
<p>The top of the current stack of rectangles in user units.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_right">right</code></td>
<td>
<p>The right edge of the current stack of rectangles in user units.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_lastcenter">lastcenter</code></td>
<td>
<p>The center of the previous rectangle from which the next
breakdown of categories arises. There is almost no reason to change it.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_showval">showval</code></td>
<td>
<p>Whether to display the values representing the categories.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_showcount">showcount</code></td>
<td>
<p>Whether to display the count for the categories.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_stacklabels">stacklabels</code></td>
<td>
<p>Whether to display the names of the dataframe beneath
the stacked rectangles.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_firstcall">firstcall</code></td>
<td>
<p>A flag for the function - do not alter this.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_col">col</code></td>
<td>
<p>Optional fill colors for the rectangles. See Details</p>
</td></tr>
<tr><td><code id="sizetree_+3A_border">border</code></td>
<td>
<p>Color for border around the rectangles. See details</p>
</td></tr>
<tr><td><code id="sizetree_+3A_toplab">toplab</code></td>
<td>
<p>Optional labels to display a the top of each stack.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_base.cex">base.cex</code></td>
<td>
<p>The base character expansion for the labels.</p>
</td></tr>
<tr><td><code id="sizetree_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;sizetree&#8288;</span>&rsquo; displays disjunct hierarchical categories as stacked rectangles.
It accepts a data frame in which the values in the first column represent
categories, the values in the second column represent subcategories of the
first column, and so on. The first column will be displayed as a stack of
rectangles, the height of each proportional to the count for each category.
Each substack of rectangles in the second stack will represent the breakdown
of counts for its superordinate category and so on through the columns.
Empty categories are ignored and NAs will produce gaps, which will propagate
across subsequent stacks.
</p>
<p>The user can simply pass the data frame, which should only contain columns that
are hierarchical categories (example 1). The colors will probably not be ideal.
The user can pass the same colors for the all levels (example 2). If this is
done, &lsquo;<span class="samp">&#8288;sizetree&#8288;</span>&rsquo; will try to match colors to categories when
the number of categories is diminishing (e.g. some levels are missing in the
sub-categories) and the columns of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; are factors with the same levels in
the same order. This will work if the category labels are the same in each level,
but remember to add the names to the colors before passing them to the function.
This will not work if there are more categories in the lower levels. If &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo;
is a list, this is not done, and the user will have to work out the correct colors
for each level. This is particularly important when the category labels and the
number of categories is different in different levels (example 3).
</p>
<p>In some sizetrees, the subcategory counts are very low compared to the overall
number of data objects. This results in rectangles that are very thin vertically.
One way to get better legibility of the labels is to use dark colors for the
rectangles, so that the labels are white, and no borders (set &lsquo;<span class="samp">&#8288;border&#8288;</span>&rsquo; to NA).
The user can also select only part of the data frame &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; to expand sections
of the sizetree as in the last example.
</p>
<p>The labels are sized to fit the vertical extent of the bars. However, it is
possible that the labels may extend horizontally beyond the bar(s). The
&lsquo;<span class="samp">&#8288;base.cex&#8288;</span>&rsquo; argument can be used to shrink the labels if this happens.
Remember that &lsquo;<span class="samp">&#8288;base.cex&#8288;</span>&rsquo; will shrink all the labels, not just the ones
that are too wide.
</p>
<p>The &lsquo;<span class="samp">&#8288;firstcall&#8288;</span>&rsquo; argument is necessary for the function to initialize the
plot, as each breakdown involves a recursive call. If it is changed, the best
that can be expected is an uninformative plot.
</p>


<h3>Value</h3>

<p> nil </p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> cat1&lt;-factor(sample(c("None","Low","Medium","High","Extreme"),40,TRUE),
  levels=c("None","Low","Medium","High","Extreme"))
 cat2&lt;-factor(sample(c("None","Low","Medium","High"),40,TRUE),
  levels=c("None","Low","Medium","High"))
 cat3&lt;-factor(sample(c("None","Low","High"),40,TRUE),
  levels=c("None","Low","High"))
 hcats&lt;-data.frame(cat1,cat2,cat3)
 # throw in a few NAs
 hcats$cat1[10]&lt;-NA
 hcats$cat2[c(15,20)]&lt;-NA
 hcats$cat3[c(11,14,25)]&lt;-NA
 # first let sizetree work out the colors
 sizetree(hcats,main="Sizetree with automatic colors")
 # now see what happens with a list of the same colors for each level
 bhcol&lt;-c("#ff8080","#dddd80","#80ff80","#0000ff","#80dddd")
 sizetree(hcats,col=list(bhcol,bhcol,bhcol),
  main="Sizetree with the same colors each level")
 # finally, specify different colors for categories with different labels
 sexhaireye&lt;-data.frame(sex=factor(sample(c("Male","Female"),50,TRUE)),
  hair=factor(sample(c("Blond","Red","Brown","Black"),50,TRUE)),
  eye=factor(sample(c("Gold","Green","Blue"),50,TRUE)))
 shecol&lt;-list(c("pink","lightblue"),c("#000000","#dddd00","#886600","#ee8800"),
  c("blue","gold","green"))
 sizetree(sexhaireye,main="Sex, hair and eye color",
  col=shecol,toplab=c("Sex","Hair color","Eye color"))
 # now expand the female part of the sizetree
 sizetree(sexhaireye[sexhaireye[,1]=="Female",],
  main="Sex, hair and eye color (Females only)",
  col=shecol,toplab=c("Sex","Hair color","Eye color"))
</code></pre>

<hr>
<h2 id='sliceArray'>Slice an array</h2><span id='topic+sliceArray'></span>

<h3>Description</h3>

<p>Slices one dimension from an array by taking one element from the first dimension.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> sliceArray(x,slice)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sliceArray_+3A_x">x</code></td>
<td>
<p>An array</p>
</td></tr>
<tr><td><code id="sliceArray_+3A_slice">slice</code></td>
<td>
<p>The index of the slice to take from the first dimension of the array.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;sliceArray&#8288;</span>&rsquo; builds an extractor string containing the value of &lsquo;<span class="samp">&#8288;slice&#8288;</span>&rsquo;
as the first element and as many commas as needed to match the dimensions of the
array. It then applies the extractor function to &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and returns the result. 
Note how the array &quot;slice&quot; swaps dimensions in the example.
</p>


<h3>Value</h3>

<p>The desired slice of the array.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="base.html#topic+array">array</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> a1&lt;-array(1:27,dim=c(3,3,3))
 a1
 sliceArray(a1,2)
</code></pre>

<hr>
<h2 id='smoothColors'>Build a vector of color values</h2><span id='topic+smoothColors'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;smoothColors&#8288;</span>&rsquo; calculates a sequence of colors. If two color names 
in the arguments are separated by a number, that number of interpolated
colors will be inserted between the two color endpoints. Any number of
color names and integers may be passed, but the last argument must be
a color name. If more than one integer appears between two color names,
only the first will be used in the interpolation and the others will be
ignored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> smoothColors(...,alpha=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smoothColors_+3A_...">...</code></td>
<td>
<p>an arbitrary sequence of color names and integers beginning
and ending with a color name.</p>
</td></tr>
<tr><td><code id="smoothColors_+3A_alpha">alpha</code></td>
<td>
<p>optional &lsquo;<span class="samp">&#8288;alpha&#8288;</span>&rsquo; (transparency) value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of hexadecimal color values as used by &lsquo;<span class="samp">&#8288;col&#8288;</span>&rsquo;.</p>


<h3>Note</h3>

<p>For more R functions that transform numeric values into
colors or produce colors that can be used to represent values, see the 
<span class="pkg">colourschemes</span> package.
</p>


<h3>Author(s)</h3>

<p>Barry Rowlingson</p>


<h3>See Also</h3>

<p><a href="#topic+color.gradient">color.gradient</a>,<a href="grDevices.html#topic+rgb">rgb</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(1:10,main="Test opaque colors",type="n",axes=FALSE)
 box()
 rect(1:7,1:7,3:9,3:9,col=smoothColors("red",2,"green",2,"blue"))
</code></pre>

<hr>
<h2 id='soil.texture'>Soil texture triangle plot</h2><span id='topic+soil.texture'></span>

<h3>Description</h3>

<p>Display a USDA soil texture triangle with optional grid, labels and
soil texture points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soil.texture(soiltexture=NULL, main="", at=seq(0.1, 0.9, by=0.1),
             axis.labels=c("percent sand", "percent silt",
                           "percent clay"),
             tick.labels=list(l=seq(10, 90, by=10), r=seq(10, 90, by=10),
                              b=seq(10, 90, by=10)),
             show.names=TRUE, show.lines=TRUE, col.names="gray",
             bg.names=par("bg"), show.grid=FALSE, col.axis="black",
             col.lines="gray", col.grid="gray", lty.grid=3,
             show.legend=FALSE, label.points=FALSE, point.labels=NULL,
             col.symbols="black", pch=par("pch"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="soil.texture_+3A_soiltexture">soiltexture</code></td>
<td>
<p>Matrix of soil textures where each row is a
soil sample and three columns contain the proportions of the
components sand, silt and clay in the range 0 to 1 or
percentages in the range 0 to 100.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_main">main</code></td>
<td>
<p>The title of the soil texture plot. Defaults to nothing.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_at">at</code></td>
<td>
<p>Positions on the three axes where ticks will be drawn.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_axis.labels">axis.labels</code></td>
<td>
<p>Labels for the axes.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_tick.labels">tick.labels</code></td>
<td>
<p>The tick labels for the three axes.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_show.names">show.names</code></td>
<td>
<p>Logical - whether to show the names of different
soil types within the soil triangle.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_show.lines">show.lines</code></td>
<td>
<p>Logical - whether to show the boundaries of the
different soil types within the soil triangle.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_col.names">col.names</code></td>
<td>
<p>Color of the soil names. Defaults to gray.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_bg.names">bg.names</code></td>
<td>
<p>Color to use when drawing a blank patch for the names
of soil types.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_show.grid">show.grid</code></td>
<td>
<p>Logical - whether to show grid lines at each 10
level of each soil component.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_col.axis">col.axis</code></td>
<td>
<p>Color of the triangular axes, ticks and labels.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_col.lines">col.lines</code></td>
<td>
<p>Color of the boundary lines. Defaults to gray.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_col.grid">col.grid</code></td>
<td>
<p>Color of the grid lines. Defaults to gray.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_lty.grid">lty.grid</code></td>
<td>
<p>Type of line for the grid. Defaults to dashed.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_show.legend">show.legend</code></td>
<td>
<p>Logical - whether to display a legend.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_label.points">label.points</code></td>
<td>
<p>Logical - whether to call
<a href="#topic+thigmophobe.labels">thigmophobe.labels</a> to label the points.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_point.labels">point.labels</code></td>
<td>
<p>Optional labels for the points or legend.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_col.symbols">col.symbols</code></td>
<td>
<p>Color of the symbols representing each value.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_pch">pch</code></td>
<td>
<p>Symbols to use in plotting values.</p>
</td></tr>
<tr><td><code id="soil.texture_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <a href="#topic+triax.points">triax.points</a>
and then &lsquo;<span class="samp">&#8288;points&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;soil.texture&#8288;</span>&rsquo; displays a triangular plot area on which soil
textures defined as proportions of sand, silt and clay can be plotted.
Optional grid, vertex labels, soil type divisions and names may also
be displayed. If a matrix of soil textures is present, these will be
plotted.
</p>


<h3>Value</h3>

<p>If &lsquo;<span class="samp">&#8288;soiltexture&#8288;</span>&rsquo; was included, a list of the &lsquo;<span class="samp">&#8288;x,y&#8288;</span>&rsquo;
positions of the soil types plotted. If not, nil.
</p>


<h3>Note</h3>

<p>This is now a special case of &lsquo;<span class="samp">&#8288;triax.plot&#8288;</span>&rsquo;.</p>


<h3>Author(s)</h3>

<p>Sander Oom, Jim Lemon, and Michael Toews</p>


<h3>References</h3>

<p>U.S. Department of Agriculture, Natural Resources Conservation Service,
2007. <em>National Soil Survey Handbook</em>, title 430-VI.//
formerly
&lsquo;<span class="samp">&#8288;https://www.nrcs.usda.gov/wps/portal/nrcs/detail/soils/survey/class/taxonomy/?cid=nrcs142p2_053577&#8288;</span>&rsquo;
</p>
<p>U.S. Department of Agriculture, Natural Resources Conservation Service,
2007. <em>Soil Texture Calculator</em>//
formerly
&lsquo;<span class="samp">&#8288;https://www.nrcs.usda.gov/wps/portal/nrcs/detail/soils/survey/class/taxonomy/?cid=nrcs142p2_053577&#8288;</span>&rsquo;
</p>


<h3>See Also</h3>

<p><a href="#topic+get.soil.texture">get.soil.texture</a>, <a href="#topic+triax.plot">triax.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> data(soils)
 soil.texture(main="NO DATA")
 soil.texture(soils, main="DEFAULT", pch=2)
 soil.texture(soils, main="LINES AND NAMES", show.lines=TRUE,
  show.names=TRUE, pch=3)
 soiltex.return&lt;-soil.texture(soils[1:6,], main="GRID AND LEGEND",
  show.grid=TRUE, pch=4, col.symbols=1:6, show.legend=TRUE)
 par(soiltex.return$oldpar)
</code></pre>

<hr>
<h2 id='soil.texture.uk'>Soil texture triangle plot using UK conventions</h2><span id='topic+soil.texture.uk'></span>

<h3>Description</h3>

<p>Display a UK style soil texture triangle with optional grid, labels and
soil texture points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> soil.texture.uk(soiltexture = NULL, main = "",at = seq(0.1, 0.9, by = 0.1),
  axis.labels = c("percent sand", "percent silt", "percent clay"),
  tick.labels = list(l = seq(10, 90, by = 10), r = seq(10, 90, by = 10),
  b = seq(10, 90, by = 10)), show.names = TRUE,
  show.lines = TRUE, col.names = "gray", bg.names = par("bg"),
  show.grid = FALSE, col.axis = "black", col.lines = "gray",
  col.grid = "gray", lty.grid = 3, show.legend = FALSE, label.points = FALSE,
  point.labels = NULL, col.symbols = "black", pch = par("pch"),
  h1 = NA, h3 = NA, t1 = NA, t3 = NA, lwduk = 2, xpos = NA, ypos = NA,
  snames = NA, cexuk = 1.1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="soil.texture.uk_+3A_soiltexture">soiltexture</code></td>
<td>
<p>Matrix of soil textures where each row is a
soil sample and three columns containing the percentages of the
components sand, silt and clay in the range 0 to 100.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_main">main</code></td>
<td>
<p>The title of the soil texture plot. Defaults to nothing.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_at">at</code></td>
<td>
<p>Positions on the three axes where ticks will be drawn.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_axis.labels">axis.labels</code></td>
<td>
<p>Labels for the axes.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_tick.labels">tick.labels</code></td>
<td>
<p>The tick labels for the three axes.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_show.names">show.names</code></td>
<td>
<p>Logical - whether to show the names of different
soil types within the soil triangle.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_show.lines">show.lines</code></td>
<td>
<p>Logical - whether to show the boundaries of the
different soil types within the soil triangle.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_col.names">col.names</code></td>
<td>
<p>Color of the soil names. Defaults to gray.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_bg.names">bg.names</code></td>
<td>
<p>Color to use when drawing a blank patch for the names
of soil types.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_show.grid">show.grid</code></td>
<td>
<p>Logical - whether to show grid lines at each 10
level of each soil component.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_col.axis">col.axis</code></td>
<td>
<p>Color of the triangular axes, ticks and labels.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_col.lines">col.lines</code></td>
<td>
<p>Color of the boundary lines. Defaults to gray.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_col.grid">col.grid</code></td>
<td>
<p>Color of the grid lines. Defaults to gray.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_lty.grid">lty.grid</code></td>
<td>
<p>Type of line for the grid. Defaults to dashed.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_show.legend">show.legend</code></td>
<td>
<p>Logical - whether to display a legend.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_label.points">label.points</code></td>
<td>
<p>Logical - whether to call
<a href="#topic+thigmophobe.labels">thigmophobe.labels</a> to label the points.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_point.labels">point.labels</code></td>
<td>
<p>Optional labels for the points or legend.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_col.symbols">col.symbols</code></td>
<td>
<p>Color of the symbols representing each value.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_pch">pch</code></td>
<td>
<p>Symbols to use in plotting values.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_h1">h1</code>, <code id="soil.texture.uk_+3A_h3">h3</code>, <code id="soil.texture.uk_+3A_t1">t1</code>, <code id="soil.texture.uk_+3A_t3">t3</code></td>
<td>
<p>Points used in drawing boundaries for soil types.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_lwduk">lwduk</code></td>
<td>
<p>Line width for the boundaries</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_xpos">xpos</code>, <code id="soil.texture.uk_+3A_ypos">ypos</code></td>
<td>
<p>Positions for the soil type labels.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_snames">snames</code></td>
<td>
<p>Soil type labels.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_cexuk">cexuk</code></td>
<td>
<p>Character expansion for the soil type labels.</p>
</td></tr>
<tr><td><code id="soil.texture.uk_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <a href="#topic+triax.points">triax.points</a>
and then &lsquo;<span class="samp">&#8288;points&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;soil.texture.uk&#8288;</span>&rsquo; displays a triangular plot area on which soil
textures defined as proportions of sand, silt and clay can be plotted.
It is similar to the &lsquo;<span class="samp">&#8288;soil.texture&#8288;</span>&rsquo; function but uses the UK
display conventions.
</p>


<h3>Value</h3>

<p>If &lsquo;<span class="samp">&#8288;soiltexture&#8288;</span>&rsquo; was included, a list of the &lsquo;<span class="samp">&#8288;x,y&#8288;</span>&rsquo;
positions of the soil types plotted. If not, nil.
</p>


<h3>Author(s)</h3>

<p>Julian Stander</p>


<h3>See Also</h3>

<p><a href="#topic+triax.plot">triax.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> soils.sw.percent&lt;-data.frame(
  Sand=c(67,67,66,67,36,25,24,59,27,9,8,8,20,
  45,50,56,34,29,39,41,94,98,97,93,96,99),
  Silt=c(17,16,9,8,39,48,54,27,46,70,68,68,66,
  34,30,24,48,53,46,48,2,2,2,4,1,1),
  Clay=c(16,17,25,25,25,27,22,14,27,21,24,24,
  14,21,20,20,18,18,15,11,4,0,1,3,3,0))
 soils.sw.cols &lt;- c(1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3,
  3, 3, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6)
 soils.sw.names &lt;- c("Ardington","Astrop","Atrim",
  "Banbury","Beacon","Beckfoot")
 soil.texture.uk(soils.sw.percent,
  main = "Ternary Diagram for Some Soils from South West England",
  col.lines = "black", col.names = "black", show.grid = TRUE,
  col.grid = "blue", lty.grid = 2,  pch = 16, cex = 1.0,
  col.symbols = soils.sw.cols, h1 = NA, h3 = NA, t1 = NA,
  t3 = NA , lwduk = 2, xpos = NA, ypos = NA,
  snames = NA, cexuk = 1.1)
 legend("topleft", legend = soils.sw.names, col = 1:max(soils.sw.cols),
  pch = 16, cex = 1.1, title = "Location", bty = "n")
</code></pre>

<hr>
<h2 id='soils'>Soil texture data from 125 soils</h2><span id='topic+soils'></span>

<h3>Description</h3>

<p>A set of 125 soil texture measurements from soils from various parts of the
world.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(soils)
</code></pre>


<h3>Source</h3>

<p>T.H. Skaggs, L.M. Arya, P.J. Shouse and B.P. Mohanty (2001)
Estimating Particle-Size Distribution from Limited Soil Texture Data.
Soil Science Society of America Journal 65:1038-1044.
</p>

<hr>
<h2 id='spread.labels'> Spread labels for irregularly spaced values </h2><span id='topic+spread.labels'></span>

<h3>Description</h3>

<p>Places labels for irregularly spaced values in a regular staggered order
</p>


<h3>Usage</h3>

<pre><code class='language-R'> spread.labels(x,y,labels=NULL,ony=NA,offsets=NA,between=FALSE,
  linecol=par("fg"),srt=0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spread.labels_+3A_x">x</code>, <code id="spread.labels_+3A_y">y</code></td>
<td>
<p>x and y data values</p>
</td></tr>
<tr><td><code id="spread.labels_+3A_labels">labels</code></td>
<td>
<p>text strings</p>
</td></tr>
<tr><td><code id="spread.labels_+3A_ony">ony</code></td>
<td>
<p>Whether to force the labels to be spread horizontally
(FALSE) or vertically (TRUE). Defaults to whichever way the points are
most spread out.</p>
</td></tr>
<tr><td><code id="spread.labels_+3A_offsets">offsets</code></td>
<td>
<p>How far away from the data points to place the labels.
Defaults to one quarter of the plot span for all, staggered on each side.</p>
</td></tr>
<tr><td><code id="spread.labels_+3A_between">between</code></td>
<td>
<p>Whether to place the labels between two sets of points.</p>
</td></tr>
<tr><td><code id="spread.labels_+3A_linecol">linecol</code></td>
<td>
<p>Optional colors for the lines drawn to the points.</p>
</td></tr>
<tr><td><code id="spread.labels_+3A_srt">srt</code></td>
<td>
<p>Rotation of the labels in degrees.</p>
</td></tr>
<tr><td><code id="spread.labels_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is mainly useful when labeling irregularly spaced data points
that are &quot;spread out&quot; along one dimension. It places the labels regularly
spaced and staggered on the long dimension of the data, drawing lines from
each label to the point it describes.
</p>
<p>If &lsquo;<span class="samp">&#8288;between&#8288;</span>&rsquo; is TRUE, the function expects two points for each label
and will attempt to place the labels between two vertical lines of points.
Lines will be drawn from the ends of each label to the two corresponding
points.
</p>
<p>If spreading labels horizontally, the user may wish to rotate the labels by
90 degrees (&lsquo;<span class="samp">&#8288;srt=90&#8288;</span>&rsquo;). If long labels run off the edge of the plot,
increase the &lsquo;<span class="samp">&#8288;xlim&#8288;</span>&rsquo; for extra room.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>References</h3>

<p>Cooke, L.J. &amp; Wardle, J. (2005) Age and gender differences in
children's food preferences. British Journal of Nutrition, 93: 741-746.
</p>


<h3>See Also</h3>

<p>&lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;spread.lab (TeachingDemos)&#8288;</span>&rsquo;</p>


<h3>Examples</h3>

<pre><code class='language-R'> # spread labels out in the x dimension using defaults
 x&lt;-sort(rnorm(10))
 y&lt;-rnorm(10)/10
 plot(x,y,ylim=c(-1,1),type="p")
 nums&lt;-c("one","two","three","four","five","six","seven","eight","nine","ten")
 spread.labels(x,y,nums)
 # food preferences of children by sex (Cooke &amp; Wardle, 2005)
 fpkids&lt;-data.frame(Food=c("Fatty/sugary","Fruit","Starchy","Meat",
  "Proc.meat","Eggs","Fish","Dairy","Vegetables"),
  Female=c(4.21,4.22,3.98,3.57,3.55,3.46,3.34,3.26,3.13),
  Male=c(4.35,4.13,4.02,3.9,3.81,3.64,3.45,3.27,2.96))
 plot(rep(1,9),fpkids$Female,xlim=c(0.8,2.2),
  ylim=range(c(fpkids$Female,fpkids$Male)),xlab="Sex",xaxt="n",
  ylab="Preference rating",main="Children's food preferences by sex",
  col="red")
 axis(1,at=1:2,labels=c("Female","Male"))
 points(rep(2,9),fpkids$Male,col="blue",pch=2)
 spread.labels(rep(1:2,each=9),c(fpkids$Female,fpkids$Male),
  fpkids$Food,between=TRUE,linecol=c("red","blue"))
</code></pre>

<hr>
<h2 id='spreadout'>Spread out a vector of numbers to a minimum interval</h2><span id='topic+spreadout'></span>

<h3>Description</h3>

<p>Spread out a vector of numbers so that there is a minimum interval
between any two numbers when in ascending or descending order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> spreadout(x,mindist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spreadout_+3A_x">x</code></td>
<td>
<p>A numeric vector which may contain NAs.</p>
</td></tr>
<tr><td><code id="spreadout_+3A_mindist">mindist</code></td>
<td>
<p>The minimum interval between any two values when in ascending
or descending order.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;spreadout&#8288;</span>&rsquo; starts at or near the middle of the vector and increases the
intervals between the ordered values. NAs are preserved. &lsquo;<span class="samp">&#8288;spreadout&#8288;</span>&rsquo;
first tries to spread groups of values with intervals less than &lsquo;<span class="samp">&#8288;mindist&#8288;</span>&rsquo;
out neatly away from the mean of the group. If this doesn't entirely succeed,
a second pass that forces values away from the middle is performed.
</p>
<p>&lsquo;<span class="samp">&#8288;spreadout&#8288;</span>&rsquo; is currently used to avoid overplotting of axis tick labels
where they may be close together.
</p>


<h3>Value</h3>

<p>On success, the spread out values. If there are less than two valid
values, the original vector is returned.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>Examples</h3>

<pre><code class='language-R'> spreadout(c(1,3,3,3,3,5),0.2)
 spreadout(c(1,2.5,2.5,3.5,3.5,5),0.2)
 spreadout(c(5,2.5,2.5,NA,3.5,1,3.5,NA),0.2)
 # this will almost always invoke the brute force second pass
 spreadout(rnorm(10),0.5)
</code></pre>

<hr>
<h2 id='stackpoly'>
Display the columns of a matrix or data frame as stacked polygons
</h2><span id='topic+stackpoly'></span>

<h3>Description</h3>

<p>Plot one or more columns of numeric values as the top edges of polygons
instead of lines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> stackpoly(x,y=NULL,main="",xlab="",ylab="",xat=NA,xaxlab=NA,
  xlim=NA,ylim=NA,lty=1,lwd=1,border=NA,col=NULL,staxx=FALSE,stack=FALSE,
  axis2=TRUE,axis4=TRUE,padj=0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stackpoly_+3A_x">x</code></td>
<td>
<p>A numeric data frame or matrix with the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; values. If
&lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; is NULL, these will become the &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; values and the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;
positions will be the integers from 1 to dim(x)[1].</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_y">y</code></td>
<td>
<p>The &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; values.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_main">main</code></td>
<td>
<p>The title for the plot.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_xlab">xlab</code>, <code id="stackpoly_+3A_ylab">ylab</code></td>
<td>
<p>x and y axis labels for the plot.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_xat">xat</code></td>
<td>
<p>Where to put the optional xaxlabs.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_xaxlab">xaxlab</code></td>
<td>
<p>Optional labels for the x positions.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_xlim">xlim</code></td>
<td>
<p>Optional x limits.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_ylim">ylim</code></td>
<td>
<p>Optional y limits.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_lty">lty</code></td>
<td>
<p>Line type for the polygon borders.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_lwd">lwd</code></td>
<td>
<p>Line width for the polygon borders.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_border">border</code></td>
<td>
<p>Color for the polygon borders.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_col">col</code></td>
<td>
<p>Color to fill the polygons. If NULL, &lsquo;<span class="samp">&#8288;rainbow&#8288;</span>&rsquo; will be
called to generate the colors. If NA, the polygons will not be filled.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_staxx">staxx</code></td>
<td>
<p>Whether to call &lsquo;<span class="samp">&#8288;staxlab&#8288;</span>&rsquo; to stagger the x axis labels.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_stack">stack</code></td>
<td>
<p>Whether to stack the successive values on top of each other.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_axis2">axis2</code></td>
<td>
<p>Whether to display the left ordinate on the plot.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_axis4">axis4</code></td>
<td>
<p>Whether to display the right ordinate on the plot.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_padj">padj</code></td>
<td>
<p>Vertical justfication of the x axis labels, defaulting to &quot;top&quot;.
Can be a vector with an element for each label.</p>
</td></tr>
<tr><td><code id="stackpoly_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;stackpoly&#8288;</span>&rsquo; is similar to a line plot with the area under the
lines filled with color(s). Ideally, each successive set of y values
is greater than the values in the previous set so that the polygons 
form a rising series of crests. If &lsquo;<span class="samp">&#8288;stack&#8288;</span>&rsquo; is TRUE, this is not a
problem unless some values of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; are negative.
</p>
<p>If &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; is a vector, not a matrix or list, the values will
be displayed as a &quot;waterfall plot&quot;.
</p>
<p>The options for &lsquo;<span class="samp">&#8288;axis2&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;axis4&#8288;</span>&rsquo; can be used to produce
panel plots. See the last example.
</p>


<h3>Value</h3>

<p>nil
</p>


<h3>Author(s)</h3>

<p>Jim Lemon and Thomas Petzoldt (waterfall plot option) - thanks to
Phil Novack-Gottshall for the mismatched x and y fix</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+polygon">polygon</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> testx&lt;-matrix(abs(rnorm(100)),nrow=10)
 stackpoly(matrix(cumsum(testx),nrow=10),main="Test Stackpoly I",
  xaxlab=c("One","Two","Three","Four","Five",
  "Six","Seven","Eight","Nine","Ten"),border="black",staxx=TRUE)
 stackpoly(testx,main="Test Stackpoly II",
  xaxlab=c("One","Two","Three","Four","Five",
  "Six","Seven","Eight","Nine","Ten"),border="black",
  staxx=TRUE,stack=TRUE)
 layout(matrix(1:2,nrow=1))
 oldmar&lt;-par(mar=c(5,4,4,0))
 stackpoly(rev(sort(testx-mean(testx))),
  main="Waterfall Plot (x-mean)",xat=seq(10,90,by=10),
  xlab="Index",ylab="Value",lwd=3,col="green",border="black",
  axis4=FALSE)
 ylim&lt;-par("usr")[3:4]
 par(mar=c(5,0,4,4))
 stackpoly(rev(sort((testx-mean(testx))/sd(as.vector(testx)))),
  ylim=ylim,main="Waterfall Plot ((x-mean)/sd)",xat=seq(10,90,by=10),
  xlab="Index",lwd=3,col="lightblue",border="black",axis2=FALSE)
 par(oldmar)
</code></pre>

<hr>
<h2 id='staircase.plot'>Display a staircase plot</h2><span id='topic+staircase.plot'></span>

<h3>Description</h3>

<p>Displays a plot showing a sequence of changing totals and increments as
successive linked bars.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> staircase.plot(heights,totals=NA,labels=NULL,halfwidth=0.3,main="",
 mar=NA,total.col="blue",inc.col=NA,bg.col=NA,direction="e",las=1,
 display.height=TRUE,stagger=FALSE,cex=par("cex"),prefix="",suffix="",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="staircase.plot_+3A_heights">heights</code></td>
<td>
<p>vector of numeric values or a matrix or data frame with at least
two columns. The first column must be numeric and the second may be numeric or
logical.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_totals">totals</code></td>
<td>
<p>A vector of logicals or zero/non-zero values indicating whether
the corresponding height is a total (TRUE) or an increment (FALSE).</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_labels">labels</code></td>
<td>
<p>An optional vector of labels for the bars.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_halfwidth">halfwidth</code></td>
<td>
<p>Half of the width of a bar as a proportion. See Details.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_main">main</code></td>
<td>
<p>A title for the plot.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_mar">mar</code></td>
<td>
<p>Margins for the plot. Defaults to 10 on the baseline axis, 3 on the
top and 1 on the other two sides.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_total.col">total.col</code></td>
<td>
<p>Color(s) for the bars representing successive totals.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_inc.col">inc.col</code></td>
<td>
<p>Color(s) for the bars representing increments.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_bg.col">bg.col</code></td>
<td>
<p>The background color for the plot.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_direction">direction</code></td>
<td>
<p>Direction in which the bars should be presented. See Details.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_las">las</code></td>
<td>
<p>Orientation for the bar labels. See &lsquo;<span class="samp">&#8288;par&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_display.height">display.height</code></td>
<td>
<p>Whether to display the totals and increments at the upper
ends of the bars. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_stagger">stagger</code></td>
<td>
<p>Whether to stagger the labels to avoid overlap.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_cex">cex</code></td>
<td>
<p>The usual character expansion value.</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_prefix">prefix</code></td>
<td>
<p>A prefix to the numbers displayed next to the bars (e.g. $).</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_suffix">suffix</code></td>
<td>
<p>A suffix as for prefix (e.g. %).</p>
</td></tr>
<tr><td><code id="staircase.plot_+3A_...">...</code></td>
<td>
<p>arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a plot representing successive changes in counts or values. For example,
if a research study attempts to contact a certain number of people and some
cannot be contacted, some decline to participate, some are ineligible, the final
sample will be smaller than the initial contact list. The first value will be the
total of attempts, there will be a number of decrements, and the last value will
be the actual sample. There may be intermediate totals specified. This produces
a visual display of the sampling procedure. See the example.
</p>
<p>The bars are placed at integer values on the axis representing the succession of
counts or values. The width of the bars is determined by the argument
&lsquo;<span class="samp">&#8288;halfwidth&#8288;</span>&rsquo;. This defaults to 0.3, meaning that the bar extends 0.3 to each
side, so that the proportion of bar to space is 0.6 to 0.4. The succession of
bars is determined by the &lsquo;<span class="samp">&#8288;direction&#8288;</span>&rsquo; argument. The default is &quot;e&quot; (east),
meaning that the first bar is at the left of the plot and subsequent bars are
placed to the right. The other three possibilities follow the conventional
compass layout.
</p>
<p>The &lsquo;<span class="samp">&#8288;prefix&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;suffix&#8288;</span>&rsquo; arguments allow the user to specify units
for the numbers displayed next to the bars. If a single value is passed, all
numbers will get the same prefix or suffix. Different prefixes or suffixes for 
each number can be passed as vectors.
</p>
<p>The &lsquo;<span class="samp">&#8288;getFigCtr&#8288;</span>&rsquo; function is called to center the plot title in the figure
region as the plot area is typically off center.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a>, <a href="#topic+getFigCtr">getFigCtr</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> sample_size&lt;-c(500,-72,428,-94,334,-45,289)
 totals&lt;-c(TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE)
 labels&lt;-c("Contact list","Uncontactable","","Declined","","Ineligible",
  "Final sample")
 staircase.plot(sample_size,totals,labels,
  main="Acquisition of the sample (staircase.plot)",
  total.col="gray",inc.col=2:4,bg.col="#eeeebb",direction="s")
</code></pre>

<hr>
<h2 id='staircasePlot'>Display a staircase plot</h2><span id='topic+staircasePlot'></span>

<h3>Description</h3>

<p>Displays a plot showing a sequence of changing totals and increments as
successive linked bars.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> staircasePlot(heights,totals=NA,labels=NULL,halfwidth=0.3,main="",mar=NA,
 stair.info=list(total.col="blue",inc.col=NA,border=par("fg")),bg.col=NA,
 direction="e",las=1,display.height=TRUE,stagger=FALSE,cex=par("cex"),
 prefix="",suffix="",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="staircasePlot_+3A_heights">heights</code></td>
<td>
<p>vector of numeric values or a matrix or data frame with at least
two columns. The first column must be numeric and the second may be numeric or
logical.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_totals">totals</code></td>
<td>
<p>A vector of logicals or zero/non-zero values indicating whether
the corresponding height is a total (TRUE) or an increment (FALSE).</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_labels">labels</code></td>
<td>
<p>An optional vector of labels for the bars.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_halfwidth">halfwidth</code></td>
<td>
<p>Half of the width of a bar as a proportion. See Details.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_main">main</code></td>
<td>
<p>A title for the plot.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_mar">mar</code></td>
<td>
<p>Margins for the plot. Defaults to 10 on the baseline axis, 3 on the
top and 1 on the other two sides.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_stair.info">stair.info</code></td>
<td>
<p>A list of arguments for the bars including color(s) 
for the bars representing successive totals, and increments and the 
border color.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_bg.col">bg.col</code></td>
<td>
<p>The background color for the plot.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_direction">direction</code></td>
<td>
<p>Direction in which the bars should be presented. See Details.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_las">las</code></td>
<td>
<p>Orientation for the bar labels. See &lsquo;<span class="samp">&#8288;par&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_display.height">display.height</code></td>
<td>
<p>Whether to display the totals and increments at the upper
ends of the bars. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_stagger">stagger</code></td>
<td>
<p>Whether to stagger the labels to avoid overlap.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_cex">cex</code></td>
<td>
<p>The usual character expansion value.</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_prefix">prefix</code></td>
<td>
<p>A prefix to the numbers displayed next to the bars (e.g. $).</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_suffix">suffix</code></td>
<td>
<p>A suffix as for prefix (e.g. %).</p>
</td></tr>
<tr><td><code id="staircasePlot_+3A_...">...</code></td>
<td>
<p>arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays a plot representing successive changes in counts or values. For example,
if a research study attempts to contact a certain number of people and some
cannot be contacted, some decline to participate, some are ineligible, the final
sample will be smaller than the initial contact list. The first value will be the
total of attempts, there will be a number of decrements, and the last value will
be the actual sample. There may be intermediate totals specified. This produces
a visual display of the sampling procedure. See the example.
</p>
<p>The bars are placed at integer values on the axis representing the succession of
counts or values. The width of the bars is determined by the argument
&lsquo;<span class="samp">&#8288;halfwidth&#8288;</span>&rsquo;. This defaults to 0.3, meaning that the bar extends 0.3 to each
side, so that the proportion of bar to space is 0.6 to 0.4. The succession of
bars is determined by the &lsquo;<span class="samp">&#8288;direction&#8288;</span>&rsquo; argument. The default is &quot;e&quot; (east),
meaning that the first bar is at the left of the plot and subsequent bars are
placed to the right. The other three possibilities follow the conventional
compass layout.
</p>
<p>The &lsquo;<span class="samp">&#8288;prefix&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;suffix&#8288;</span>&rsquo; arguments allow the user to specify units
for the numbers displayed next to the bars. If a single value is passed, all
numbers will get the same prefix or suffix. Different prefixes or suffixes for 
each number can be passed as vectors.
</p>
<p>The &lsquo;<span class="samp">&#8288;getFigCtr&#8288;</span>&rsquo; function is called to center the plot title in the figure
region as the plot area is typically off center.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a>, <a href="#topic+getFigCtr">getFigCtr</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> sample_size&lt;-c(500,-72,428,-94,334,-45,289)
 totals&lt;-c(TRUE,FALSE,TRUE,FALSE,TRUE,FALSE,TRUE)
 labels&lt;-c("Contact list","Uncontactable","","Declined","","Ineligible",
  "Final sample")
 staircasePlot(sample_size,totals,labels,
  main="Acquisition of the sample (staircasePlot)",
  total.col="gray",inc.col=2:4,bg.col="#eeeebb",direction="s")
</code></pre>

<hr>
<h2 id='starPie'>A pie-like graphic object</h2><span id='topic+starPie'></span>

<h3>Description</h3>

<p>Display a polygon with each sector proportional to a vector of numeric values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> starPie(x,y,radext,values,maxval=NA,border=par("fg"),col=NA,prop.area=FALSE,
  label="",labelpos=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="starPie_+3A_x">x</code>, <code id="starPie_+3A_y">y</code></td>
<td>
<p>The coordinate position for the center of the starPie.</p>
</td></tr>
<tr><td><code id="starPie_+3A_radext">radext</code></td>
<td>
<p>The maximum distance from the center of the starPie to one vertex of
the polygon.</p>
</td></tr>
<tr><td><code id="starPie_+3A_values">values</code></td>
<td>
<p>A vector of numeric values.</p>
</td></tr>
<tr><td><code id="starPie_+3A_maxval">maxval</code></td>
<td>
<p>A maximum value for scaling the values to the radius. If NA, the
maximum value in &lsquo;<span class="samp">&#8288;values&#8288;</span>&rsquo; will be used.</p>
</td></tr>
<tr><td><code id="starPie_+3A_border">border</code></td>
<td>
<p>The color to use for the borders of the polygon sectors.</p>
</td></tr>
<tr><td><code id="starPie_+3A_col">col</code></td>
<td>
<p>The color(s) to use for the fills of the polygon.</p>
</td></tr>
<tr><td><code id="starPie_+3A_prop.area">prop.area</code></td>
<td>
<p>Whether to scale the values to the area (TRUE) or the
radial extent (FALSE) of the polygon sectors.</p>
</td></tr>
<tr><td><code id="starPie_+3A_label">label</code></td>
<td>
<p>Optional text labels for the starPies.</p>
</td></tr>
<tr><td><code id="starPie_+3A_labelpos">labelpos</code></td>
<td>
<p>Positions of the labels relative to the starPies.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;starPie&#8288;</span>&rsquo; displays a polygon centered on the &lsquo;<span class="samp">&#8288;x,y&#8288;</span>&rsquo; position having
sectors of equal angular extent. The radial extent of each sector
is proportional to the values in the numeric vector &lsquo;<span class="samp">&#8288;lengths&#8288;</span>&rsquo;. If the
&lsquo;<span class="samp">&#8288;prop.area&#8288;</span>&rsquo; argument is TRUE, the proportion is based on the area of the
sector, and if &lsquo;<span class="samp">&#8288;prop.area&#8288;</span>&rsquo; is FALSE, the proportion is on the radial extent.
As the function is intended to exaggerate the differences between different
starPies, the default produces sectors proportional to the squares of the
&lsquo;<span class="samp">&#8288;lengths&#8288;</span>&rsquo;.
</p>
<p>&lsquo;<span class="samp">&#8288;starPie&#8288;</span>&rsquo; is intended to display a visual analog of the relative value of
matched attributes of a number of similar objects or groups. Thus objects having
similar attributes will produce similar looking starPies. When constructing such
a matrix, it is necessary for &lsquo;<span class="samp">&#8288;maxval&#8288;</span>&rsquo; to be specified, usually as the
overall maximum value in any of the attribute value vectors. If &lsquo;<span class="samp">&#8288;maxval&#8288;</span>&rsquo; is
not specified in such a situation, only the relative values within each vector
will determine the radial extents of each starPie. There appears to be no reason
to have different sector colors for different objects, but the user can display
more than one set of starPies on a plot with different sector colors if
necessary.
</p>
<p>&lsquo;<span class="samp">&#8288;starPie&#8288;</span>&rsquo; calls &lsquo;<span class="samp">&#8288;getYmult&#8288;</span>&rsquo; to automatically adjust for both the aspect
and coordinate ratio of the plot.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>Examples</h3>

<pre><code class='language-R'> date_mat&lt;-data.frame(sex=rep(c("M","F"),each=10),
  names=c("Abe","Bob","Col","Dave","Eddie","Frank","Geoff","Harry","Igor","Jack",
  "Alice","Betty","Clare","Dora","Eva","Fran","Grace","Hilda","Iris","Joan"),
  eating=sample(0:100,20),dancing=sample(0:100,20),movies=sample(0:100,20),
  reading=sample(0:100,20),travel=sample(0:100,20))
 plot(0,xlim=c(0.5,10.5),ylim=c(0,3),type="n",axes=FALSE,xlab="",ylab="Sex",
  main="Date matching matrix")
 par(xpd=TRUE)
 legend(0.7,-0.3,c("Eat out","Dance","Movies","Read","Travel"),fill=rainbow(5),
  ncol=5)
 par(xpd=FALSE)
 box()
 axis(2,at=c(0.9,2.4),labels=c("Male","Female"))
 starPie(x=rep(1:10,2),y=rep(c(0.9,2.4),each=10),radext=0.5,
  values=as.matrix(date_mat[,3:7]),label=as.character(date_mat[["names"]]))
</code></pre>

<hr>
<h2 id='staxlab'> Place staggered or angled labels on an axis </h2><span id='topic+staxlab'></span>

<h3>Description</h3>

<p>Places labels on an axis in a regular staggered order or at an angle
</p>


<h3>Usage</h3>

<pre><code class='language-R'> staxlab(side=1,at,labels,nlines=2,top.line=0.5,line.spacing=0.8,
  srt=NULL,ticklen=0.03,adj=1,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="staxlab_+3A_side">side</code></td>
<td>
<p>axis on which to place the labels, as in &lsquo;<span class="samp">&#8288;axis&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="staxlab_+3A_at">at</code></td>
<td>
<p>where to place the labels in user units, as in &lsquo;<span class="samp">&#8288;axis&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="staxlab_+3A_labels">labels</code></td>
<td>
<p>text strings</p>
</td></tr>
<tr><td><code id="staxlab_+3A_nlines">nlines</code></td>
<td>
<p>How many lines to use to stagger the labels.</p>
</td></tr>
<tr><td><code id="staxlab_+3A_top.line">top.line</code></td>
<td>
<p>Distance from the axis to place the first line of text.</p>
</td></tr>
<tr><td><code id="staxlab_+3A_line.spacing">line.spacing</code></td>
<td>
<p>Spacing between lines of text labels.</p>
</td></tr> 
<tr><td><code id="staxlab_+3A_srt">srt</code></td>
<td>
<p>Text rotation.</p>
</td></tr>
<tr><td><code id="staxlab_+3A_ticklen">ticklen</code></td>
<td>
<p>Proportion of plot height in user units to place text
below the plot.</p>
</td></tr>
<tr><td><code id="staxlab_+3A_adj">adj</code></td>
<td>
<p>horizontal adjustment of the labels.</p>
</td></tr>
<tr><td><code id="staxlab_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to &lsquo;<span class="samp">&#8288;mtext&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>This function is mainly useful when either long axis labels or a large
number of labels are to be placed without overlapping. It staggers the 
labels along the axis specified. The user may wish to increase the space
beneath the plot using &lsquo;<span class="samp">&#8288;mar&#8288;</span>&rsquo; before calling &lsquo;<span class="samp">&#8288;staxlab&#8288;</span>&rsquo;. It is
probably only useful on the bottom or left side of the plot.
</p>
<p>If &lsquo;<span class="samp">&#8288;srt&#8288;</span>&rsquo; is not NULL, the labels will be rotated &lsquo;<span class="samp">&#8288;srt&#8288;</span>&rsquo; degrees
and placed below the plot. This method will only place labels at the
bottom. Note that this option only works on the lower and left axes.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon (thanks to Tim Elwell-Sutton for the log axis fix)</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+mtext">mtext</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-rnorm(12)
 plot(x,axes=FALSE)
 box()
 months&lt;-c("January","February","March","April","May","June",
  "July","August","September","October","November","December")
 staxlab(1,1:12,months)
 plot(x,axes=FALSE)
 box()
 staxlab(1,1:12,months,srt=45)
 ylabels&lt;-round(seq(min(x),max(x),length.out=10),3)
 staxlab(2,ylabels,ylabels,srt=45)
</code></pre>

<hr>
<h2 id='std.error'>Calculate standard error of the mean</h2><span id='topic+std.error'></span>

<h3>Description</h3>

<p>Calculates the standard error of the mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> std.error(x,na.rm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="std.error_+3A_x">x</code></td>
<td>
<p>A vector of numerical observations.</p>
</td></tr>
<tr><td><code id="std.error_+3A_na.rm">na.rm</code></td>
<td>
<p>Dummy argument to match other functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;std.error&#8288;</span>&rsquo; will accept a numeric vector.
</p>


<h3>Value</h3>

<p>The conventional standard error of the mean = sd(x)/sqrt(sum(!is.na(x)))
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+sd">sd</a></p>

<hr>
<h2 id='sumbrk'>Count specified values in a vector</h2><span id='topic+sumbrk'></span>

<h3>Description</h3>

<p>Counts the number of values in a vector that are equal to a specified value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> sumbrk(x,trueval=TRUE,na.rm=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumbrk_+3A_x">x</code></td>
<td>
<p>a character, factor or numeric vector.</p>
</td></tr>
<tr><td><code id="sumbrk_+3A_trueval">trueval</code></td>
<td>
<p>the value to be matched in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="sumbrk_+3A_na.rm">na.rm</code></td>
<td>
<p>whether to remove NA values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;sumbrk&#8288;</span>&rsquo; counts the values in &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; matching a specified value.
It is mainly to allow these sums to be calculated in the &lsquo;<span class="samp">&#8288;brkdnNest&#8288;</span>&rsquo;
function.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+brkdnNest">brkdnNest</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> sumbrk(sample(LETTERS,100,TRUE),trueval="M")
</code></pre>

<hr>
<h2 id='symbolbarplot'>barplot filled with symbols</h2><span id='topic+symbolbarplot'></span>

<h3>Description</h3>

<p>Produces a barplot where each piece of the barplot is filled with the
number of symbols equal to the size of the bar
</p>


<h3>Usage</h3>

<pre><code class='language-R'> symbolbarplot(height,width=1,space=NULL,names.arg=NULL,
  legend.text=NULL,beside=FALSE,horiz=FALSE,col=heat.colors(NR),
  border=par("fg"),main=NULL,sub=NULL,xlab=NULL,ylab=NULL,xlim=NULL,
  ylim=NULL,axes=TRUE,axisnames=TRUE,inside=TRUE,plot=TRUE,rel.width=0.8,
  symbol="circles",symbbox=TRUE,debug=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="symbolbarplot_+3A_height">height</code></td>
<td>
<p>numeric vector or matrix of barplot heights</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_width">width</code></td>
<td>
<p>width of bars</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_space">space</code></td>
<td>
<p>space between bars</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_names.arg">names.arg</code></td>
<td>
<p>vector of names</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_legend.text">legend.text</code></td>
<td>
<p>vector of legend text</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_beside">beside</code></td>
<td>
<p>(logical) plot bars beside each other?</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_horiz">horiz</code></td>
<td>
<p>(logical) horizontal barplot?</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_col">col</code></td>
<td>
<p>vector of colors</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_border">border</code></td>
<td>
<p>plot border?</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_main">main</code></td>
<td>
<p>main title</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_sub">sub</code></td>
<td>
<p>subtitle</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_xlab">xlab</code></td>
<td>
<p>x axis label</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_ylab">ylab</code></td>
<td>
<p>y axis label</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_xlim">xlim</code></td>
<td>
<p>x limits</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_ylim">ylim</code></td>
<td>
<p>y limits</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_axes">axes</code></td>
<td>
<p>draw axes?</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_axisnames">axisnames</code></td>
<td>
<p>label horizontal axis?</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_inside">inside</code></td>
<td>
<p>draw lines dividing adjacent bars?</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_plot">plot</code></td>
<td>
<p>produce plot?</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_rel.width">rel.width</code></td>
<td>
<p>relative width of symbols</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_symbol">symbol</code></td>
<td>
<p>which symbol to use</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_symbbox">symbbox</code></td>
<td>
<p>draw boxes for symbol boxes?</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_debug">debug</code></td>
<td>
<p>debug output?</p>
</td></tr>
<tr><td><code id="symbolbarplot_+3A_...">...</code></td>
<td>
<p>further arguments to multsymbolbox</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nil
</p>


<h3>Note</h3>

<p>This is a mostly a hack of barplot()</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(1001)
 bvals &lt;- matrix(rpois(12,20),nrow=3)
 b &lt;- symbolbarplot(bvals)
</code></pre>

<hr>
<h2 id='symbolbox'>Draw a box filled with symbols</h2><span id='topic+symbolbox'></span>

<h3>Description</h3>

<p>Draws a box on the current figure that is filled with symbols
representing individual counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'> symbolbox(x1,y1,x2,y2,tot,relw=0.5,fg=par("fg"),bg=par("bg"),box=TRUE,
  debug = TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="symbolbox_+3A_x1">x1</code></td>
<td>
<p>left side of box</p>
</td></tr>
<tr><td><code id="symbolbox_+3A_y1">y1</code></td>
<td>
<p>bottom side of box</p>
</td></tr>
<tr><td><code id="symbolbox_+3A_x2">x2</code></td>
<td>
<p>right side of box</p>
</td></tr>
<tr><td><code id="symbolbox_+3A_y2">y2</code></td>
<td>
<p>top side of box</p>
</td></tr>
<tr><td><code id="symbolbox_+3A_tot">tot</code></td>
<td>
<p>total number of symbols to put in the box</p>
</td></tr>
<tr><td><code id="symbolbox_+3A_relw">relw</code></td>
<td>
<p>relative width (relative to height) of symbols</p>
</td></tr>
<tr><td><code id="symbolbox_+3A_fg">fg</code></td>
<td>
<p>foreground color</p>
</td></tr>
<tr><td><code id="symbolbox_+3A_bg">bg</code></td>
<td>
<p>background color</p>
</td></tr>
<tr><td><code id="symbolbox_+3A_box">box</code></td>
<td>
<p>(logical) draw box border?</p>
</td></tr>
<tr><td><code id="symbolbox_+3A_debug">debug</code></td>
<td>
<p>debug output?</p>
</td></tr>
<tr><td><code id="symbolbox_+3A_...">...</code></td>
<td>
<p>additional arguments to polygon() for drawing box</p>
</td></tr>
</table>


<h3>Details</h3>

<p>tries to automatically figure out appropriate scaling to fit symbols
into the box
</p>


<h3>Value</h3>

<p>none; draws on the current figure
</p>


<h3>Author(s)</h3>

<p>Ben Bolker</p>


<h3>See Also</h3>

<p><a href="#topic+multsymbolbox">multsymbolbox</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(1:10,1:10,type="n")
 symbolbox(2,5,3,7,tot=20)
 symbolbox(6,2,10,6,tot=50,fg="blue",bg="magenta")
</code></pre>

<hr>
<h2 id='tab.title'>
Display the title of a plot as a colored tab
</h2><span id='topic+tab.title'></span>

<h3>Description</h3>

<p>Display the title of a plot as a colored tab.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> tab.title(label,text.col=par("fg"),tab.col=par("bg"),border=par("fg"),
  lwd=par("lwd"),cex=1.5,pad.mult=1.6,radius=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tab.title_+3A_label">label</code></td>
<td>
<p>The title for the plot.</p>
</td></tr>
<tr><td><code id="tab.title_+3A_text.col">text.col</code></td>
<td>
<p>The color for the title text.</p>
</td></tr>
<tr><td><code id="tab.title_+3A_tab.col">tab.col</code></td>
<td>
<p>The color for the tab fill.</p>
</td></tr>
<tr><td><code id="tab.title_+3A_border">border</code></td>
<td>
<p>The color for the tab border.</p>
</td></tr>
<tr><td><code id="tab.title_+3A_lwd">lwd</code></td>
<td>
<p>The line width for the border.</p>
</td></tr>
<tr><td><code id="tab.title_+3A_cex">cex</code></td>
<td>
<p>Character expansion for the title.</p>
</td></tr>
<tr><td><code id="tab.title_+3A_pad.mult">pad.mult</code></td>
<td>
<p>How much higher to make the tab relative to the label.</p>
</td></tr>
<tr><td><code id="tab.title_+3A_radius">radius</code></td>
<td>
<p>What proportion of the tab corners to round off.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;tab.title&#8288;</span>&rsquo; displays the plot title in a colored tab. The tab can be
rounded at the upper corners by specifying the proportion of the tab
height to be rounded as a number between 0 and 1. If the tab is too high
to fit on the figure region, a warning will be displayed and the tab will
still be shown. 
</p>


<h3>Value</h3>

<p>nil
</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+polygon">polygon</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> testx&lt;-matrix(cumsum(rnorm(30)^2)+1,nrow=10)
 stackpoly(testx,main="",
  xaxlab=c("One","Two","Three","Four","Five",
  "Six","Seven","Eight","Nine","Ten"),staxx=TRUE)
 tab.title("Three Squiggly Lines",tab.col="yellow",radius=0.5)
</code></pre>

<hr>
<h2 id='taylor.diagram'> Taylor diagram </h2><span id='topic+taylor.diagram'></span>

<h3>Description</h3>

<p> Display a Taylor diagram</p>


<h3>Usage</h3>

<pre><code class='language-R'> taylor.diagram(ref,model,add=FALSE,col="red",pch=19,pos.cor=TRUE,
  xlab="Standard deviation",ylab="",main="Taylor Diagram",
  show.gamma=TRUE,ngamma=3,gamma.col=8,sd.arcs=0,
  ref.sd=FALSE,sd.method="sample",grad.corr.lines=c(0.2,0.4,0.6,0.8,0.9),
  pcex=1,cex.axis=1,normalize=FALSE,mar=c(4,3,4,3),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taylor.diagram_+3A_ref">ref</code></td>
<td>
<p>numeric vector - the reference values.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_model">model</code></td>
<td>
<p>numeric vector - the predicted model values.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_add">add</code></td>
<td>
<p>whether to draw the diagram or just add a point.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_col">col</code></td>
<td>
<p>the color for the points displayed.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_pch">pch</code></td>
<td>
<p>the type of point to display.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_pos.cor">pos.cor</code></td>
<td>
<p>whether to display only positive (&lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo;) or all
values of correlation (&lsquo;<span class="samp">&#8288;FALSE&#8288;</span>&rsquo;).</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_xlab">xlab</code>, <code id="taylor.diagram_+3A_ylab">ylab</code></td>
<td>
<p>plot axis labels.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_main">main</code></td>
<td>
<p>title for the plot.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_show.gamma">show.gamma</code></td>
<td>
<p>whether to display standard deviation arcs around
the reference point (only for &lsquo;<span class="samp">&#8288;pos.cor=TRUE&#8288;</span>&rsquo;).</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_ngamma">ngamma</code></td>
<td>
<p>the number of gammas to display (default=3).</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_gamma.col">gamma.col</code></td>
<td>
<p>color to use for the gamma arcs (only with pos.cor=TRUE).</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_sd.arcs">sd.arcs</code></td>
<td>
<p>whether to display arcs along the standard deviation axes
(see Details).</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_ref.sd">ref.sd</code></td>
<td>
<p>whether to display the arc representing the reference
standard deviation.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_sd.method">sd.method</code></td>
<td>
<p>Whether to use the sample or estimated population SD.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_grad.corr.lines">grad.corr.lines</code></td>
<td>
<p>the values for the radial lines for correlation
values (see Details).</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_pcex">pcex</code></td>
<td>
<p>character expansion for the plotted points.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_cex.axis">cex.axis</code></td>
<td>
<p>character expansion for the axis text.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_normalize">normalize</code></td>
<td>
<p>whether to normalize the models so that the reference
has a standard deviation of 1.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_mar">mar</code></td>
<td>
<p>margins - only applies to the &lsquo;<span class="samp">&#8288;pos.cor=TRUE&#8288;</span>&rsquo; plot.</p>
</td></tr>
<tr><td><code id="taylor.diagram_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Taylor diagram is used to display the quality of model predictions
against the reference values, typically direct observations.
</p>
<p>A diagram is built by plotting one model against the reference,
then adding alternative model points. If &lsquo;<span class="samp">&#8288;normalize=TRUE&#8288;</span>&rsquo; 
when plotting the first model, remember to set it to &lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo;
when plotting additional models.
</p>
<p>Two displays are available. One displays the entire range of correlations
from -1 to 1. Setting &lsquo;<span class="samp">&#8288;pos.cor&#8288;</span>&rsquo; to &lsquo;<span class="samp">&#8288;FALSE&#8288;</span>&rsquo; will produce this
display. The -1 to 1 display includes a radial grid for the correlation
values. When &lsquo;<span class="samp">&#8288;pos.cor&#8288;</span>&rsquo; is set to &lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo;, only the
range from 0 to 1 will be displayed. The &lsquo;<span class="samp">&#8288;gamma&#8288;</span>&rsquo; lines and the arc at
the reference standard deviation are optional in this display.
</p>
<p>Both the standard deviation arcs and the gamma lines are optional in the
&lsquo;<span class="samp">&#8288;pos.cor=TRUE&#8288;</span>&rsquo; version. Setting &lsquo;<span class="samp">&#8288;sd.arcs&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;grad.corr.lines&#8288;</span>&rsquo;
to zero or FALSE will cause them not to be displayed. If more than one value is
passed for &lsquo;<span class="samp">&#8288;sd.arcs&#8288;</span>&rsquo;, the function will try to use the values passed,
otherwise it will call &lsquo;<span class="samp">&#8288;pretty&#8288;</span>&rsquo; to calculate the values.
</p>


<h3>Value</h3>

<p>The values of &lsquo;<span class="samp">&#8288;par&#8288;</span>&rsquo; that preceded the function. This allows the
user to add points to the diagram, then restore the original values. This
is only necessary when using the 0 to 1 correlation range.
</p>


<h3>Author(s)</h3>

<p>Olivier Eterradossi with modifications by Jim Lemon</p>


<h3>References</h3>

<p>Taylor, K.E. (2001) Summarizing multiple aspects of model performance in a
single diagram. Journal of Geophysical Research, 106: 7183-7192.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # fake some reference data
 ref&lt;-rnorm(30,sd=2)
 # add a little noise
 model1&lt;-ref+rnorm(30)/2
 # add more noise
 model2&lt;-ref+rnorm(30)
 # display the diagram with the better model
 oldpar&lt;-taylor.diagram(ref,model1)
 # now add the worse model
 taylor.diagram(ref,model2,add=TRUE,col="blue")
 # get approximate legend position
 lpos&lt;-1.5*sd(ref)
 # add a legend
 legend(lpos,lpos,legend=c("Better","Worse"),pch=19,col=c("red","blue"))
 # now restore par values
 par(oldpar)
 # show the "all correlation" display
 taylor.diagram(ref,model1,pos.cor=FALSE)
 taylor.diagram(ref,model2,add=TRUE,col="blue")
</code></pre>

<hr>
<h2 id='textbox'>Add text box</h2><span id='topic+textbox'></span>

<h3>Description</h3>

<p>Add text to plot, justified, in a box
</p>


<h3>Usage</h3>

<pre><code class='language-R'> textbox(x, y, textlist, justify=c('l','c','r'), cex=1, leading=0.5, box=TRUE,
 adj=c(0,0), font=NULL, vfont=NULL, col=NULL, border=NULL, fill=NA, density=NULL,
 angle=45, lty=par("lty"), lwd=par("lwd"), margin=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="textbox_+3A_x">x</code></td>
<td>
<p>x position: a vector with min. and max. x-position</p>
</td></tr>
<tr><td><code id="textbox_+3A_y">y</code></td>
<td>
<p>y position: location of the top of the box</p>
</td></tr>
<tr><td><code id="textbox_+3A_textlist">textlist</code></td>
<td>
<p>a vector of text strings</p>
</td></tr>
<tr><td><code id="textbox_+3A_justify">justify</code></td>
<td>
<p>x alignment: 'l'=left, 'c'=center, 'r'=right.</p>
</td></tr>
<tr><td><code id="textbox_+3A_cex">cex</code></td>
<td>
<p>character expansion</p>
</td></tr>
<tr><td><code id="textbox_+3A_leading">leading</code></td>
<td>
<p>inter-line spacing</p>
</td></tr>
<tr><td><code id="textbox_+3A_box">box</code></td>
<td>
<p>whether to draw a box around the text</p>
</td></tr>
<tr><td><code id="textbox_+3A_adj">adj</code></td>
<td>
<p>adjustment for x and y position, default is no adjustment,
see Details</p>
</td></tr>
<tr><td><code id="textbox_+3A_font">font</code></td>
<td>
<p>text font, see Details</p>
</td></tr>
<tr><td><code id="textbox_+3A_vfont">vfont</code></td>
<td>
<p>text font, see Details</p>
</td></tr>
<tr><td><code id="textbox_+3A_col">col</code></td>
<td>
<p>text color</p>
</td></tr>
<tr><td><code id="textbox_+3A_border">border</code></td>
<td>
<p>box border color</p>
</td></tr>
<tr><td><code id="textbox_+3A_fill">fill</code></td>
<td>
<p>box fill color</p>
</td></tr>
<tr><td><code id="textbox_+3A_density">density</code></td>
<td>
<p>box shading line density, see Details</p>
</td></tr>
<tr><td><code id="textbox_+3A_angle">angle</code></td>
<td>
<p>box shading line angle, see Details</p>
</td></tr>
<tr><td><code id="textbox_+3A_lty">lty</code></td>
<td>
<p>box border and shading line types, see Details</p>
</td></tr>
<tr><td><code id="textbox_+3A_lwd">lwd</code></td>
<td>
<p>box border and shading line width, see Details</p>
</td></tr>
<tr><td><code id="textbox_+3A_margin">margin</code></td>
<td>
<p>amount to adjust box border in or out. See Details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Draws text in the box by pasting the textlist vector together, splitting it
into words, and then adding words to the current line until the line is wide
enough before moving on to the next line.
</p>
<p>&lsquo;<span class="samp">&#8288;margin&#8288;</span>&rsquo; may be a vector of 1, 2, or 4 values, corresponding to 
adjustment of all borders (1 value), top/bottom and left/right borders
(2 values), or bottom/left/top/right borders (4 values).  A positive value
moves text inwards from specified (x,y) position with border remaining at (x,y),
and a negative value moves the border outwards from (x,y) with the text
remaining at (x,y).
</p>
<p>The &lsquo;<span class="samp">&#8288;density&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;angle&#8288;</span>&rsquo; arguments have the same behavior as in the
&lsquo;<span class="samp">&#8288;rect&#8288;</span>&rsquo; function. The &lsquo;<span class="samp">&#8288;adj, font&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;vfont&#8288;</span>&rsquo; arguments have the same
behavior as in the &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo; function. The &lsquo;<span class="samp">&#8288;lty&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;lwd&#8288;</span>&rsquo; 
arguments have the same behavior as in the &lsquo;<span class="samp">&#8288;lines&#8288;</span>&rsquo; function.
</p>


<h3>Value</h3>

<p>y-position of bottom line of box, or y-position of next line if there is no box.
</p>


<h3>Author(s)</h3>

<p>Ben Bolker. Improvements by Ted Toal.</p>


<h3>Examples</h3>

<pre><code class='language-R'> plot.new()
 textbox(c(0,0.2), 1, c("many words","more words","why not?",
  "keep going",rep("and going",10)))
 textbox(c(0.3,0.5), 1, c("keep going",rep("and going",10)), cex=0.45,
  col="blue", border="red", fill="#00FFEE80", density=25, angle=60)
 textbox(c(0.6,0.8), 1, c("keep going",rep("and going",10)), justify='c', cex=0.6,
  leading=1, font=4, border="gold", lty=2, lwd=4, margin=0.025)
 textbox(c(0.6,0.8), 0.5, c("keep going",rep("and going",10)), justify='r', cex=0.7,
  col="purple", font=3, border="green", margin=-0.025)
 lines(c(0,1), c(1,1), col="red", lty=2)
 lines(c(0,1), c(0.5,0.5), col="red", lty=2)
</code></pre>

<hr>
<h2 id='thigmophobe'>Find the direction away from the closest point</h2><span id='topic+thigmophobe'></span>

<h3>Description</h3>

<p>Find the direction away from the closest point</p>


<h3>Usage</h3>

<pre><code class='language-R'> thigmophobe(x,y=NULL,names=seq_along(z),xlog=par("xlog"),ylog=par("ylog"),
  usr=par("usr"),pin=par("pin"),eps=.Machine$double.eps,pi=base::pi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thigmophobe_+3A_x">x</code>, <code id="thigmophobe_+3A_y">y</code></td>
<td>
<p>Numeric data vectors. Typically the x/y coordinates of
plotted points. If arrays are passed, they will be silently coerced to
numeric vectors.</p>
</td></tr>
<tr><td><code id="thigmophobe_+3A_names">names</code></td>
<td>
<p>Names for the vector of directions.</p>
</td></tr>
<tr><td><code id="thigmophobe_+3A_xlog">xlog</code>, <code id="thigmophobe_+3A_ylog">ylog</code></td>
<td>
<p>Flags for logarithmic axes. See Note.</p>
</td></tr>
<tr><td><code id="thigmophobe_+3A_usr">usr</code></td>
<td>
<p>The extent of the plot in user units.</p>
</td></tr>
<tr><td><code id="thigmophobe_+3A_pin">pin</code></td>
<td>
<p>Extent of the plot in inches.</p>
</td></tr>
<tr><td><code id="thigmophobe_+3A_eps">eps</code></td>
<td>
<p>smallest number that can be represented on the system.</p>
</td></tr>
<tr><td><code id="thigmophobe_+3A_pi">pi</code></td>
<td>
<p>value of pi.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;thigmophobe&#8288;</span>&rsquo; returns the direction (as 1|2|3|4 - see pos= in 
&lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;) away from the nearest point to each of the points 
described by &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;.
</p>


<h3>Value</h3>

<p>A vector of directions away from the point nearest to each point.
</p>


<h3>Note</h3>

<p>&lsquo;<span class="samp">&#8288;thigmophobe&#8288;</span>&rsquo; is typically used to get the offsets to automatically
place labels on a scatterplot or similar using &lsquo;<span class="samp">&#8288;thigmophobe.labels&#8288;</span>&rsquo;
to avoid overlapping labels. The name means &quot;one who fears being touched&quot;.
</p>
<p>The &lsquo;<span class="samp">&#8288;plot.span&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;xlog&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;ylog&#8288;</span>&rsquo; arguments were added to
allow &lsquo;<span class="samp">&#8288;thigmophobe&#8288;</span>&rsquo; to be used outside of base graphics.
</p>


<h3>Author(s)</h3>

<p>Bill Venables</p>


<h3>See Also</h3>

<p><a href="#topic+thigmophobe.labels">thigmophobe.labels</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-rnorm(10)
 y&lt;-rnorm(10)
 thigmophobe(x,y)
</code></pre>

<hr>
<h2 id='thigmophobe.labels'>Place labels away from the nearest point</h2><span id='topic+thigmophobe.labels'></span>

<h3>Description</h3>

<p>&lsquo;<span class="samp">&#8288;thigmophobe.labels&#8288;</span>&rsquo; places labels adjacent to each point, 
offsetting each label in the direction returned by 
&lsquo;<span class="samp">&#8288;thigmophobe&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> thigmophobe.labels(x,y,labels=NULL,text.pos=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thigmophobe.labels_+3A_x">x</code>, <code id="thigmophobe.labels_+3A_y">y</code></td>
<td>
<p>Numeric data vectors or a list with two components. 
Typically the x/y coordinates of plotted points.</p>
</td></tr>
<tr><td><code id="thigmophobe.labels_+3A_labels">labels</code></td>
<td>
<p>A vector of strings that will be placed adjacent to
each point. Defaults to the indices of the coordinates.</p>
</td></tr>
<tr><td><code id="thigmophobe.labels_+3A_text.pos">text.pos</code></td>
<td>
<p>An optional vector of text positions (see 
<a href="graphics.html#topic+text">text</a>).</p>
</td></tr>
<tr><td><code id="thigmophobe.labels_+3A_...">...</code></td>
<td>
<p>additional arguments are passed to &lsquo;<span class="samp">&#8288;text&#8288;</span>&rsquo;</p>
</td></tr></table>
<p>.
</p>


<h3>Details</h3>

<p>Typically used to automatically place labels on a scatterplot or 
similar to avoid overlapping labels. &lsquo;<span class="samp">&#8288;thigmophobe.labels&#8288;</span>&rsquo;
will sometimes place a label off the plot or fail to separate
labels in clusters of points. The user can manually adjust the
errant labels by running &lsquo;<span class="samp">&#8288;thigmophobe&#8288;</span>&rsquo; first and saving
the returned vector. Then modify the position values to place
the labels properly and pass the edited vector to
&lsquo;<span class="samp">&#8288;thigmophobe.labels&#8288;</span>&rsquo; as the &lsquo;<span class="samp">&#8288;text.pos&#8288;</span>&rsquo; argument. This
takes precedence over the positions calculated by &lsquo;<span class="samp">&#8288;thigmophobe&#8288;</span>&rsquo;.
</p>
<p>&lsquo;<span class="samp">&#8288;thigmophobe&#8288;</span>&rsquo; will fail with only two labels, as it can't figure out
the nearest neighbors. If you really want to use this with two labels, just
eyeball the plot and work out in which direction the labels will go. Then
pass the directions to &lsquo;<span class="samp">&#8288;thigmophobe.labels&#8288;</span>&rsquo; as the &lsquo;<span class="samp">&#8288;text.pos&#8288;</span>&rsquo;
argument. When all else fails, look to &lsquo;<span class="samp">&#8288;placeLabels&#8288;</span>&rsquo;.
</p>
<p>Both &lsquo;<span class="samp">&#8288;pointLabel&#8288;</span>&rsquo; in the <span class="pkg">maptools</span> package and &lsquo;<span class="samp">&#8288;spread.labs&#8288;</span>&rsquo;
in the <span class="pkg">TeachingDemos</span> package use more sophisticated algorithms to
place the labels and are worth a try if &lsquo;<span class="samp">&#8288;thigmophobe&#8288;</span>&rsquo; just won't get it
right.
</p>


<h3>Value</h3>

<p>A vector of directions away from the point nearest to each point.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon (thanks to Stephen Milborrow for finding the single point bug
and Erik Aronesty for finding the two point problem.)</p>


<h3>See Also</h3>

<p><a href="#topic+thigmophobe">thigmophobe</a>, <a href="graphics.html#topic+text">text</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> x&lt;-rnorm(20)
 y&lt;-rnorm(20)
 xlim&lt;-range(x)
 xspace&lt;-(xlim[2]-xlim[1])/20
 xlim&lt;-c(xlim[1]-xspace,xlim[2]+xspace)
 ylim&lt;-range(y)
 yspace&lt;-(ylim[2]-ylim[1])/20
 ylim&lt;-c(ylim[1]-yspace,ylim[2]+yspace)
 plotlabels&lt;-
  c("one","two","three","four","five","six","seven","eight","nine","ten",
  "eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen",
  "eighteen","nineteen","twenty")
 plot(x=x,y=y,xlim=xlim,ylim=ylim,main="Test thigmophobe.labels")
 # skip the almost invisible yellow label, make them bold
 thigmophobe.labels(x,y,plotlabels,col=c(2:6,8:12),font=2)
</code></pre>

<hr>
<h2 id='triax.abline'>Lines for triangle plot</h2><span id='topic+triax.abline'></span>

<h3>Description</h3>

<p>Display lines on a triangle plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> triax.abline(b=NULL,r=NULL,l=NULL,col=par("col"),lty=par("lty"),
  cc.axes=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triax.abline_+3A_b">b</code></td>
<td>
<p>Lines relating to the bottom axis.</p>
</td></tr>
<tr><td><code id="triax.abline_+3A_r">r</code></td>
<td>
<p>Lines relating to the right axis.</p>
</td></tr>
<tr><td><code id="triax.abline_+3A_l">l</code></td>
<td>
<p>Lines relating to the left axis.</p>
</td></tr>
<tr><td><code id="triax.abline_+3A_col">col</code></td>
<td>
<p>Color(s) of the lines.</p>
</td></tr>
<tr><td><code id="triax.abline_+3A_lty">lty</code></td>
<td>
<p>Type(s) of the lines.</p>
</td></tr>
<tr><td><code id="triax.abline_+3A_cc.axes">cc.axes</code></td>
<td>
<p>Clockwise/counterclockwise axes and ticks.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;triax.abline&#8288;</span>&rsquo; displays one or more lines on a triangle plot. Lines
are oriented in the conventional way, horizontal for the left axis, 
slanting up to the right for the right axis and up to the left for the 
bottom axis. If &lsquo;<span class="samp">&#8288;cc.axes&#8288;</span>&rsquo; is TRUE, the orientation is up-left for
the left axis, horizontal for the right axis and up-right for the bottom
axis.
</p>
<p>Remember to call &lsquo;<span class="samp">&#8288;triax.plot&#8288;</span>&rsquo; with &lsquo;<span class="samp">&#8288;no.add=FALSE&#8288;</span>&rsquo; and restore
the graphics parameters as in the example or the lines will not be
placed properly.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+triax.plot">triax.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> triax.return&lt;-triax.plot(data.frame(bottom=0.4,right=0.3,left=0.3),
  main="Triax ablines",no.add=FALSE)
 triax.abline(l=0.3,col="red")
 triax.abline(r=0.3,col="green")
 triax.abline(b=0.4,col="blue")
 par(triax.return$oldpar)
</code></pre>

<hr>
<h2 id='triax.fill'>Triangle plot fill</h2><span id='topic+triax.fill'></span>

<h3>Description</h3>

<p>Fill a triangle plot with smaller triangles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> triax.fill(col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triax.fill_+3A_col">col</code></td>
<td>
<p>List of colors (see Details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order for &lsquo;<span class="samp">&#8288;triax.fill&#8288;</span>&rsquo; to fill an existing plot that has
been created by a call to &lsquo;<span class="samp">&#8288;triax.plot&#8288;</span>&rsquo;, the user must supply
a list of fill colors. The first element of the list must begin with
at least one value that can be interpreted as a color. The second
element must begin with at least three such values, and so on, adding
two values for each element of the list. Each list element will be
displayed as a row of colored triangles starting at the top of the
plot. The number of elements in the list determines the number of
rows that will be displayed.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+triax.plot">triax.plot</a>,<a href="#topic+color.scale">color.scale</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> # the data will be something like response at different proportions
 fillval&lt;-list(0,c(0,0.1,0),c(0,0.1,0.2,0.1,0),
  c(0,0.1,0.2,0.3,0.2,0.1,0),c(0,0.1,0.2,0.3,0.4,0.3,0.2,0.1,0),
  c(0,0.1,0.2,0.3,0.4,0.5,0.4,0.3,0.2,0.1,0),
  c(0,0,0.1,0.2,0.3,0.4,0.5,0.4,0.3,0.2,0.1,0,0),
  c(0,0,0,0.1,0.1,0.2,0.3,0.4,0.3,0.2,0.1,0.1,0,0,0))
 # use some method of converting values to colors
 fillcol&lt;-sapply(fillval,function(x) {x*10+1} )
 oldpar&lt;-triax.plot(main="Test of triax.fill function")
 triax.fill(fillcol)
 par(oldpar)
</code></pre>

<hr>
<h2 id='triax.frame'>Triangle plot frame</h2><span id='topic+triax.frame'></span>

<h3>Description</h3>

<p>Display a three axis frame with optional grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> triax.frame(at=seq(0.1,0.9,by=0.1),axis.labels=NULL,
 tick.labels=NULL,col.axis="black",cex.axis=1,cex.ticks=1,
 align.labels=TRUE,show.grid=FALSE,col.grid="gray",lty.grid=par("lty"),
 cc.axes=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triax.frame_+3A_at">at</code></td>
<td>
<p>The tick positions on the three axes.</p>
</td></tr>
<tr><td><code id="triax.frame_+3A_axis.labels">axis.labels</code></td>
<td>
<p>Labels for the three axes in the order bottom, right
left. Defaults to the column names.</p>
</td></tr>
<tr><td><code id="triax.frame_+3A_tick.labels">tick.labels</code></td>
<td>
<p>The tick labels for the axes.
Defaults to argument &lsquo;<span class="samp">&#8288;at&#8288;</span>&rsquo; (proportions).</p>
</td></tr>
<tr><td><code id="triax.frame_+3A_col.axis">col.axis</code></td>
<td>
<p>Color of the triangular axes, ticks and labels.</p>
</td></tr>
<tr><td><code id="triax.frame_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Character expansion for axis labels.</p>
</td></tr>
<tr><td><code id="triax.frame_+3A_cex.ticks">cex.ticks</code></td>
<td>
<p>Character expansion for the tick labels.</p>
</td></tr>
<tr><td><code id="triax.frame_+3A_align.labels">align.labels</code></td>
<td>
<p>Logical - whether to align axis and tick labels with
the axes.</p>
</td></tr>
<tr><td><code id="triax.frame_+3A_show.grid">show.grid</code></td>
<td>
<p>Whether to display grid lines at the ticks.</p>
</td></tr>
<tr><td><code id="triax.frame_+3A_col.grid">col.grid</code></td>
<td>
<p>Color of the grid lines. Defaults to gray.</p>
</td></tr>
<tr><td><code id="triax.frame_+3A_lty.grid">lty.grid</code></td>
<td>
<p>Type of line for the grid.</p>
</td></tr>
<tr><td><code id="triax.frame_+3A_cc.axes">cc.axes</code></td>
<td>
<p>Whether to align the axes clockwise or counterclockwise.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;triax.frame&#8288;</span>&rsquo; displays a triangular plot area on which proportions
or percentages may be displayed. An optional grid may also be displayed.
If &lsquo;<span class="samp">&#8288;cc.axes&#8288;</span>&rsquo; is TRUE, both the axes and axis ticks will be in
reverse order.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+triax.points">triax.points</a>,<a href="#topic+triax.abline">triax.abline</a>,<a href="#topic+triax.fill">triax.fill</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> triax.plot(main="DEFAULT")
 triax.plot(main="Clockwise axes",cc.axes=TRUE)
</code></pre>

<hr>
<h2 id='triax.plot'>Triangle plot</h2><span id='topic+triax.plot'></span>

<h3>Description</h3>

<p>Display a triangle plot with optional grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> triax.plot(x=NULL,main="",at=seq(0.1,0.9,by=0.1),
 axis.labels=NULL,tick.labels=NULL,col.axis="black",cex.axis=1,
 cex.ticks=1,
 align.labels=TRUE,show.grid=FALSE,col.grid="gray",lty.grid=par("lty"),
 cc.axes=FALSE,show.legend=FALSE,label.points=FALSE,point.labels=NULL,
 col.symbols="black",pch=par("pch"),mar=c(5,2,4,2),no.add=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triax.plot_+3A_x">x</code></td>
<td>
<p>Matrix where each row is three proportions or percentages
that must sum to 1 or 100 respectively.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_main">main</code></td>
<td>
<p>The title of the triangle plot. Defaults to nothing.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_at">at</code></td>
<td>
<p>The tick positions on the three axes.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_axis.labels">axis.labels</code></td>
<td>
<p>Labels for the three axes in the order left, right,
bottom. Defaults to the column names.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_tick.labels">tick.labels</code></td>
<td>
<p>The tick labels for the three axes as a list with
three components l, r and b (left, right and bottom).
Defaults to argument &lsquo;<span class="samp">&#8288;at&#8288;</span>&rsquo; (proportions).</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_col.axis">col.axis</code></td>
<td>
<p>Color of the triangular axes, ticks and labels.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Character expansion for axis labels.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_cex.ticks">cex.ticks</code></td>
<td>
<p>Character expansion for the tick labels.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_align.labels">align.labels</code></td>
<td>
<p>Logical - whether to align axis and tick labels with
the axes.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_show.grid">show.grid</code></td>
<td>
<p>Whether to display grid lines at the ticks.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_col.grid">col.grid</code></td>
<td>
<p>Color of the grid lines. Defaults to gray.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_lty.grid">lty.grid</code></td>
<td>
<p>Type of line for the grid.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_cc.axes">cc.axes</code></td>
<td>
<p>Whether axes and axis ticks should be clockwise or
counterclockwise.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_show.legend">show.legend</code></td>
<td>
<p>Logical - whether to display a legend.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_label.points">label.points</code></td>
<td>
<p>Logical - whether to call &lsquo;<span class="samp">&#8288;thigmophobe.labels&#8288;</span>&rsquo; to
label the points.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_point.labels">point.labels</code></td>
<td>
<p>Optional labels for the points and/or legend.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_col.symbols">col.symbols</code></td>
<td>
<p>Color of the symbols representing each value.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_pch">pch</code></td>
<td>
<p>Symbols to use in plotting values.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_mar">mar</code></td>
<td>
<p>Margins for the triangle plot.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_no.add">no.add</code></td>
<td>
<p>Whether to restore the previous plotting parameters
(&lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo;) or leave them, allowing more points to be added.</p>
</td></tr>
<tr><td><code id="triax.plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to &lsquo;<span class="samp">&#8288;points&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;triax.plot&#8288;</span>&rsquo; displays a triangular plot area on which proportions
or percentages are displayed. A grid or legend may also be displayed.
</p>


<h3>Value</h3>

<p>A list containing &lsquo;<span class="samp">&#8288;xypos&#8288;</span>&rsquo; (the &lsquo;<span class="samp">&#8288;x,y&#8288;</span>&rsquo; positions plotted)
and &lsquo;<span class="samp">&#8288;oldpar&#8288;</span>&rsquo; (the plotting parameters at the time &lsquo;<span class="samp">&#8288;triax.plot&#8288;</span>&rsquo;
was called).
</p>


<h3>Note</h3>

<p>A three axis plot can only properly display one or more
sets of three proportions that each sum to 1 (or percentages that sum
to 100). Other values may be scaled to proportions (or percentages), 
but unless each set of three sums to 1 (or 100), they will not plot
properly and &lsquo;<span class="samp">&#8288;triax.points&#8288;</span>&rsquo; will complain appropriately. Note also
that &lsquo;<span class="samp">&#8288;triax.plot&#8288;</span>&rsquo; will only display properly in a square plot,
which is forced by &lsquo;<span class="samp">&#8288;par(pty="s")&#8288;</span>&rsquo;.
</p>
<p>In case the user does want to plot values with different sums, the
axis tick labels can be set to different ranges to accomodate this.
&lsquo;<span class="samp">&#8288;triax.points&#8288;</span>&rsquo; will still complain, but it will plot the values.
</p>
<p>If planning to add points with &lsquo;<span class="samp">&#8288;triax.points&#8288;</span>&rsquo; call &lsquo;<span class="samp">&#8288;triax.plot&#8288;</span>&rsquo;
with &lsquo;<span class="samp">&#8288;no.add=FALSE&#8288;</span>&rsquo; and restore plotting parameters after the
points are added.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon - thanks to Ben Daughtry for the info on counterclockwise axes.
</p>


<h3>See Also</h3>

<p><a href="#topic+triax.points">triax.points</a>, <a href="#topic+triax.abline">triax.abline</a>, <a href="#topic+thigmophobe.labels">thigmophobe.labels</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(soils)
 triax.plot(soils[1:10,],main="DEFAULT")
 triax.plot(soils[1:10,],main="PERCENTAGES (Counterclockwise axes)",
  tick.labels=list(l=seq(10,90,by=10),r=seq(10,90,by=10),b=seq(10,90,by=10)),
  pch=3,cc.axes=TRUE)
 triax.return&lt;-triax.plot(soils[1:6,],main="GRID AND LEGEND",
  show.grid=TRUE,show.legend=TRUE,col.symbols=1:6,pch=4)
 # triax.plot changes a few parameters
 par(triax.return$oldpar)
</code></pre>

<hr>
<h2 id='triax.points'>Triangle plot points</h2><span id='topic+triax.points'></span>

<h3>Description</h3>

<p>Display points on a triangle plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> triax.points(x,show.legend=FALSE,label.points=FALSE,
 point.labels=NULL,col.symbols=par("fg"),pch=par("pch"),
 bg.symbols=par("bg"),cc.axes=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triax.points_+3A_x">x</code></td>
<td>
<p>Matrix or data frame where each row is three proportions or 
percentages that must sum to 1 or 100 respectively.</p>
</td></tr>
<tr><td><code id="triax.points_+3A_show.legend">show.legend</code></td>
<td>
<p>Logical - whether to display a legend.</p>
</td></tr>
<tr><td><code id="triax.points_+3A_label.points">label.points</code></td>
<td>
<p>Logical - whether to call &lsquo;<span class="samp">&#8288;thigmophobe.labels&#8288;</span>&rsquo;
to label the points.</p>
</td></tr>
<tr><td><code id="triax.points_+3A_point.labels">point.labels</code></td>
<td>
<p>Optional labels for the points and/or legend.</p>
</td></tr>
<tr><td><code id="triax.points_+3A_col.symbols">col.symbols</code></td>
<td>
<p>Color of the symbols representing each value.</p>
</td></tr>
<tr><td><code id="triax.points_+3A_pch">pch</code></td>
<td>
<p>Symbols to use in plotting values.</p>
</td></tr>
<tr><td><code id="triax.points_+3A_bg.symbols">bg.symbols</code></td>
<td>
<p>Background color for plotting symbols.</p>
</td></tr>
<tr><td><code id="triax.points_+3A_cc.axes">cc.axes</code></td>
<td>
<p>Clockwise or counterclockwise axes and ticks.</p>
</td></tr>
<tr><td><code id="triax.points_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to &lsquo;<span class="samp">&#8288;points&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order for &lsquo;<span class="samp">&#8288;triax.points&#8288;</span>&rsquo; to add points to an existing plot,
the argument &lsquo;<span class="samp">&#8288;no.add&#8288;</span>&rsquo; in the initial call to &lsquo;<span class="samp">&#8288;triax.plot&#8288;</span>&rsquo; 
must be set to &lsquo;<span class="samp">&#8288;FALSE&#8288;</span>&rsquo;. Failing to do this will result in the
points being plotted in the wrong places. It is then up to the user
to call &lsquo;<span class="samp">&#8288;par&#8288;</span>&rsquo; as in the example below to restore plotting
parameters altered during the triangle plot.
</p>
<p>&lsquo;<span class="samp">&#8288;triax.points&#8288;</span>&rsquo; displays each triplet of proportions or percentages
as a symbol on the triangle plot. Unless each triplet sums to 1 
(or 100), they will not plot properly and &lsquo;<span class="samp">&#8288;triax.points&#8288;</span>&rsquo; will 
complain appropriately.
</p>


<h3>Value</h3>

<p>A list of the &lsquo;<span class="samp">&#8288;x,y&#8288;</span>&rsquo; positions plotted.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="#topic+triax.plot">triax.plot</a>,<a href="#topic+thigmophobe.labels">thigmophobe.labels</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> data(soils)
 triax.return&lt;-triax.plot(soils[1:10,],
  main="Adding points to a triangle plot",no.add=FALSE)
 triax.points(soils[11:20,],col.symbols="green",pch=3)
 par(triax.return$oldpar)
</code></pre>

<hr>
<h2 id='tsxpos'>Calculate equispaced x positions.</h2><span id='topic+tsxpos'></span>

<h3>Description</h3>

<p>Calculate equispaced x positions of values that have been
plotted with the plot command.</p>


<h3>Usage</h3>

<pre><code class='language-R'> tsxpos(x,xlim,nint)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsxpos_+3A_x">x</code></td>
<td>
<p>A vector of numeric values or a time series object created with
the ts function.</p>
</td></tr>
<tr><td><code id="tsxpos_+3A_xlim">xlim</code></td>
<td>
<p>Explicit x limits for the x positions.</p>
</td></tr>
<tr><td><code id="tsxpos_+3A_nint">nint</code></td>
<td>
<p>The number of <em>intervals</em> between x positions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;tsxpos&#8288;</span>&rsquo; calculates equispaced x positions for a vector of values or
a time series created with the &lsquo;<span class="samp">&#8288;ts&#8288;</span>&rsquo; command from the <span class="pkg">stats</span> package.
It assumes that the default x limits have been used in the existing plot. It
adds the appropriate padding if &lsquo;<span class="samp">&#8288;par("xaxs")&#8288;</span>&rsquo; is &quot;r&quot;. It is mainly useful
when x axis labels or some other markers are to be added to a time series plot.
</p>
<p>A plot device must be open. If the user wishes to specify explicit x limits
or the number of intervals (not values), these will override the calculations
from the x values.
</p>


<h3>Value</h3>

<p>The calculated x positions in user units.</p>


<h3>Author(s)</h3>

<p>Jim Lemon (thanks to Prof J.C. Nash for the idea)</p>


<h3>Examples</h3>

<pre><code class='language-R'> # create a vector of numbers
 y&lt;-rnorm(28)
 par(mfrow=c(2,1),mar=c(6,4,4,2))
 plot(y,main="Plot of the values")
 # convert it into a time series object
 yt&lt;-ts(y,start=2011,frequency=12)
 # don't use the default axis
 plot(yt,main="Plot of the time series",xaxt="n",xlab="Month")
 labelpos&lt;-tsxpos(yt)
 # display an axis showing the months only
 staxlab(1,labelpos,rep(month.abb,length.out=28))
 par(mfrow=c(1,1),mar=c(5,4,4,2))
</code></pre>

<hr>
<h2 id='twoord.plot'> Plot with two ordinates </h2><span id='topic+twoord.plot'></span>

<h3>Description</h3>

<p>Two sets of values are displayed on the same plot with different ordinate
scales on the left and right.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> twoord.plot(lx,ly,rx,ry,data=NULL,main="",xlim=NULL,lylim=NULL,rylim=NULL,
 mar=c(5,4,4,4),lcol=1,rcol=2,xlab="",lytickpos=NA,ylab="",ylab.at=NA,
 rytickpos=NA,rylab="",rylab.at=NA,lpch=1,rpch=2,
 type="b",xtickpos=NULL,xticklab=NULL,halfwidth=0.4,axislab.cex=1,
 do.first=NULL,xaxt="s",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twoord.plot_+3A_lx">lx</code>, <code id="twoord.plot_+3A_ly">ly</code>, <code id="twoord.plot_+3A_rx">rx</code>, <code id="twoord.plot_+3A_ry">ry</code></td>
<td>
<p>y and optional x values for the plot</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_data">data</code></td>
<td>
<p>an optional data frame from which to obtain the above values</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_main">main</code></td>
<td>
<p>Title for the plot</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_xlim">xlim</code></td>
<td>
<p>optional x limits as in &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_lylim">lylim</code>, <code id="twoord.plot_+3A_rylim">rylim</code></td>
<td>
<p>optional y limits for the left and right axes
respectively</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_mar">mar</code></td>
<td>
<p>optional margin adjustment, defaults to &lsquo;<span class="samp">&#8288;c(5,4,4,4)&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_lcol">lcol</code>, <code id="twoord.plot_+3A_rcol">rcol</code></td>
<td>
<p>colors to distinguish the two sets of values</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_xlab">xlab</code></td>
<td>
<p>X axis label as in &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_lytickpos">lytickpos</code></td>
<td>
<p>Optional positions for the left axis tick labels.</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_ylab">ylab</code></td>
<td>
<p>Left Y axis label as in &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_ylab.at">ylab.at</code></td>
<td>
<p>Optional position for the left Y axis label</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_rytickpos">rytickpos</code></td>
<td>
<p>Optional positions for the right axis tick labels.</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_rylab">rylab</code></td>
<td>
<p>Right Y axis label</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_rylab.at">rylab.at</code></td>
<td>
<p>Optional position for the right Y axis label</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_lpch">lpch</code>, <code id="twoord.plot_+3A_rpch">rpch</code></td>
<td>
<p>plot symbols to distinguish the two sets of values</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_type">type</code></td>
<td>
<p>as in &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_xtickpos">xtickpos</code></td>
<td>
<p>Optional positions for x-axis tick labels.</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_xticklab">xticklab</code></td>
<td>
<p>Optional labels for x-axis. Useful for things like dates.</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_halfwidth">halfwidth</code></td>
<td>
<p>Half the width of the bars in user units. The bars are
centered on successive integers if no &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; values are supplied.</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_axislab.cex">axislab.cex</code></td>
<td>
<p>Character expansion for the axis labels and tick labels.</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_do.first">do.first</code></td>
<td>
<p>Optional command(s) that will be executed immediately after
the blank plot is displayed.</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_xaxt">xaxt</code></td>
<td>
<p>Whether to display the x-axis - &quot;n&quot; = no.</p>
</td></tr>
<tr><td><code id="twoord.plot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;points&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;twoord.plot&#8288;</span>&rsquo; automates the process of displaying two sets of
values that have different ranges on the same plot. It is principally
useful in illustrating some relationship between the values across the
observations. It is assumed that the &lsquo;<span class="samp">&#8288;lx&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;rx&#8288;</span>&rsquo; values
are at least adjacent, and probably overlapping.
</p>
<p>It is best to pass all the arguments &lsquo;<span class="samp">&#8288;lx, ly, rx, ry&#8288;</span>&rsquo;, but the
function will attempt to substitute sensible x values if one or two
are missing.
</p>
<p>If at least one of the &lsquo;<span class="samp">&#8288;type&#8288;</span>&rsquo; arguments is &quot;bar&quot;, bars will be plotted
instead of points or lines. It is best to plot the bars first (i.e. relative
to the left axis) if the other type is points or lines, as the bars will
usually obscure at least some of the points or lines. Using NA for the color
of the bars will partially correct this. If both types are to be bars,
remember to pass somewhat different x values or the bars will be overplotted.
</p>
<p>Note that more values can be added to the plot using &lsquo;<span class="samp">&#8288;points&#8288;</span>&rsquo; or
&lsquo;<span class="samp">&#8288;lines&#8288;</span>&rsquo;, but remember that these will be plotted relative to the left
ordinate.
</p>
<p>The &lsquo;<span class="samp">&#8288;do.first&#8288;</span>&rsquo; argument is useful for adding a background color or grid
to the plot as shown in the first two examples.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Note</h3>

<p>There are many objections to the use of plots with two different 
ordinate scales, and some of them are even sensible and supported by 
controlled observation. Many of the objections rest on assertions that the 
spatial arrangement of the values plotted will override all other 
evidence. Here are two:
</p>
<p>The viewer will assume that the vertical position of the data points 
indicates a quantitative relationship.
</p>
<p>To some extent. It is probably not a good idea to have the spatial 
relationship of the points opposed to their numerical relationship. That 
is to say, if one set of values is in the range of 0-10 and the other 
20-100, it is best to arrange the plot so that the latter values are 
not plotted below the former. See the second example, which illustrates 
a method for separating the two series and offsetting the axes.
</p>
<p>The viewer will assume that an intersection of lines indicates an 
intersection of values.
</p>
<p>If the visual elements representing values can be arranged to avoid 
intersections, so much the better. Many people have no trouble 
distinguishing which visual elements are linked to which axis as long as 
they are both coded similarly, usually with colors and/or symbols. In the 
special case where there is an underlying relationship between the two 
such as the probability of that value occurring under some conditions, it 
may help to mark the point(s) where this occurs.
</p>
<p>It may be useful to consider &lsquo;<span class="samp">&#8288;gap.plot&#8288;</span>&rsquo; or separate plots as an
alternative.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon (thanks to Christophe Dutang for the idea of using bars
and lines in the same plot, Clair Crossupton for pointing out that
dates on the x-axis weren't very good, Jacob Kasper for the axis
character expansion and Ye Lin for finally motivating me to add the
do.first argument.)</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> xval1 &lt;- seq.Date(as.Date("2017-01-02"),
  as.Date("2017-01-10"), by="day")
 xval2 &lt;- seq.Date(as.Date("2017-01-01"),
  as.Date("2017-01-15"), by="day")
 going_up&lt;-seq(3,7,by=0.5)+rnorm(9)
 going_down&lt;-rev(60:74)+rnorm(15)
 twoord.plot(2:10,going_up,1:15,going_down,xlab="Sequence",
  ylab="Ascending values",rylab="Descending values",lcol=4,
  main="Plot with two ordinates - points and lines",
  do.first="plot_bg();grid(col=\"white\",lty=1)")
 axis.Date(1,xval2)
 # now separate the lines
 twoord.plot(2:10,going_up,1:15,going_down,xlab="Sequence",
  lylim=range(going_up)+c(-1,10),rylim=range(going_down)+c(-10,2),
  ylab="Ascending values",ylab.at=5,rylab="Descending values",
  rylab.at=65,lcol=4,main="Plot with two ordinates - separated lines",
  lytickpos=3:7,rytickpos=seq(55,75,by=5),
  do.first="plot_bg();grid(col=\"white\",lty=1)")
 twoord.plot(2:10,going_up,1:15,going_down,xlab="Sequence",
  lylim=range(going_up)+c(-1,10),rylim=range(going_down)+c(-10,2),
  type=c("bar","l"),ylab="Ascending values",ylab.at=5,
  rylab="Descending values",rylab.at=65,
  main="Bars on left axis, lines on right axis",
  lytickpos=3:7,rytickpos=seq(55,75,by=5),
  lcol=3,rcol=4,do.first="plot_bg()")
 twoord.plot(2:10,going_up,1:15,going_down,xlab="Sequence",
  lylim=c(-3,8),rylim=c(50,100),type=c("l","bar"),
  ylab="Ascending values",rylab="Descending values",
  lytickpos=3:7,rytickpos=seq(55,75,by=5),ylab.at=5,rylab.at=65,
  main="Lines on left axis, bars on right axis",
  lcol=3,rcol=4,do.first="plot_bg(\"yellow\")")
 # histogram with density curve superimposed
 xhist&lt;-hist(rnorm(100),plot=FALSE)
 xdens&lt;-dnorm(seq(-3,3,by=0.05))
 twoord.plot(xhist$mids,xhist$counts,seq(-3,3,by=0.05),
 xdens,type=c("bar","l"),lcol=4,rcol=2,ylab="Counts",
 rylab="Density",main="Histogram and density curve",
 halfwidth=0.2,lylim=c(0,max(xhist$counts)+1),rylim=c(0,0.45),lwd=2)
</code></pre>

<hr>
<h2 id='twoord.stackplot'>Multiple (stack) plot with two ordinates</h2><span id='topic+twoord.stackplot'></span>

<h3>Description</h3>

<p>Two set of data are plotted on two different ordinate scales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twoord.stackplot(lx, rx, ldata, rdata, lcol, rcol, ltype, rtype, 
	border, rylab, lylab, xlab, ..., incrylim=NULL,
	halfwidth=0.4, leftfront=FALSE, mar = c(5, 4, 4, 4))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twoord.stackplot_+3A_lx">lx</code>, <code id="twoord.stackplot_+3A_rx">rx</code></td>
<td>
<p>x-values for left/right data.</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_ldata">ldata</code>, <code id="twoord.stackplot_+3A_rdata">rdata</code></td>
<td>
<p>data on the left/right y-axes.</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_lcol">lcol</code>, <code id="twoord.stackplot_+3A_rcol">rcol</code></td>
<td>
<p>colors to be used for left/right data.</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_ltype">ltype</code>, <code id="twoord.stackplot_+3A_rtype">rtype</code></td>
<td>
<p>line types to be used for left/right data, see details.</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_border">border</code></td>
<td>
<p>color for the border of barplot</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_rylab">rylab</code>, <code id="twoord.stackplot_+3A_lylab">lylab</code></td>
<td>
<p>labels for the left/right y-axes.</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_xlab">xlab</code></td>
<td>
<p>labels for the x-axis.</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_incrylim">incrylim</code></td>
<td>
<p>a number to increase the limits of y-axes.</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_halfwidth">halfwidth</code></td>
<td>
<p>half the width of the bars in user units. 
The bars are centered on successive integers if no x values are supplied</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_leftfront">leftfront</code></td>
<td>
<p>if &lsquo;<span class="samp">&#8288;TRUE&#8288;</span>&rsquo;, plot the left data on the front layer.</p>
</td></tr>
<tr><td><code id="twoord.stackplot_+3A_mar">mar</code></td>
<td>
<p>optional margin adjustment, defaults to c(5,4,4,4).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;twoord.stackplot&#8288;</span>&rsquo; works in the same way as &lsquo;<span class="samp">&#8288;twoord.plot&#8288;</span>&rsquo;
on which it is heavily inspired. The functions let the user plot
multiple curve/point or bar plots on the same graph with two different axes.
The line type can be one of the following &lsquo;<span class="samp">&#8288;"l"&#8288;</span>&rsquo; for lines,
&lsquo;<span class="samp">&#8288;"p"&#8288;</span>&rsquo; for points, &lsquo;<span class="samp">&#8288;"b"&#8288;</span>&rsquo; for both points and line, 
&lsquo;<span class="samp">&#8288;"o"&#8288;</span>&rsquo; for overplotted, &lsquo;<span class="samp">&#8288;"bar"&#8288;</span>&rsquo; for barplot.
</p>


<h3>Value</h3>

<p> nil </p>


<h3>Author(s)</h3>

<p> Christophe Dutang </p>


<h3>See Also</h3>

<p><a href="#topic+twoord.plot">twoord.plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># plot data
#

time &lt;- 0:25

A &lt;- 1+1/2*sin(time/2)
B &lt;- A + rnorm(length(A), sd=1/10)
B &lt;- B + rnorm(length(A), sd=1/10)

sizeA &lt;- floor(450*(1 + 1/4*sin(time/2+2))*(1+.1))
sizeB &lt;- 1000-sizeA

C &lt;- (A*sizeA + B*sizeB)/(sizeA+sizeB)


#typical usage 
#

twoord.stackplot(lx=time, rx=time, ldata=cbind(sizeA, sizeB), 
	rdata=cbind(A, B, C),  lcol=c("grey80", "white"), 
	rcol=c("blue", "red","black"), ltype="bar", rtype=c("l","p","o"), 
	border="grey80", lylab="Size", rylab="A,B,C", xlab="Time", 
	main="a plot", incrylim=2/100)

#add a legend
#

par(xpd=TRUE) #extend the area of plotting
par(new=TRUE) #to add new graph "layers"
plot(0:1, 0:1, type="n", xlab="",ylab="", axes=FALSE) #redo the x/y limits

#first legend
legend(-0.18, 1.2, leg=c("Size A", "Size B"), fill=c("grey80", "white")) 
#second legend
legend(.97, -0.08, leg=c("A", "B", "C"), col=c("blue", "red","black"), 
	pch=c(NA, 19, 19), lty=c(1,NA,1)) 

par(xpd=FALSE, new=FALSE) #default setting



#reverse the order of plotting
twoord.stackplot(lx=time, rx=time, ldata=cbind(sizeA, sizeB), 
	rdata=cbind(A, B, C),  lcol=c("grey80", "white"), 
	rcol=c("blue", "red","black"), ltype="bar", rtype=c("l","p","o"), 
	border="grey80", lylab="Size", rylab="A,B,C", xlab="Time", 
	main="a plot", incrylim=2/100, leftfront=TRUE)

</code></pre>

<hr>
<h2 id='valid.n'>
Find the number of valid (not NA) values
</h2><span id='topic+valid.n'></span>

<h3>Description</h3>

<p>Finds the number of valid (not NA) or total values in an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> valid.n(x,na.rm=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="valid.n_+3A_x">x</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="valid.n_+3A_na.rm">na.rm</code></td>
<td>
<p>Whether to count all values (FALSE) or only those not NA.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;valid.n&#8288;</span>&rsquo; finds the number of valid values of the object if &lsquo;<span class="samp">&#8288;na.rm=TRUE&#8288;</span>&rsquo;.
</p>


<h3>Value</h3>

<p>The number of valid values or the length of the object.</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>

<hr>
<h2 id='vectorField'>Display magnitude/direction vectors</h2><span id='topic+vectorField'></span>

<h3>Description</h3>

<p>Display magnitude/direction vectors as arrows on an existing plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'>
vectorField(u,v,xpos=NA,ypos=NA,scale=1,headspan=0.1,
 vecspec=c("lonlat","rad","deg"),col=par("fg"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vectorField_+3A_u">u</code>, <code id="vectorField_+3A_v">v</code></td>
<td>
<p>x (longitude) and y (latitude) offsets OR
orientation and magnitude in either radians or degrees. See details.</p>
</td></tr>
<tr><td><code id="vectorField_+3A_xpos">xpos</code>, <code id="vectorField_+3A_ypos">ypos</code></td>
<td>
<p>The centers of the vectors in user units.</p>
</td></tr>
<tr><td><code id="vectorField_+3A_scale">scale</code></td>
<td>
<p>The proportion of each cell that the maximal vector will fill.
See details.</p>
</td></tr>
<tr><td><code id="vectorField_+3A_headspan">headspan</code></td>
<td>
<p>The extent of the heads of the arrows as a proportion of
cell size.</p>
</td></tr>
<tr><td><code id="vectorField_+3A_vecspec">vecspec</code></td>
<td>
<p>How the vectors are described. See details</p>
</td></tr>
<tr><td><code id="vectorField_+3A_col">col</code></td>
<td>
<p>Color(s) for the arrows.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;vectorField&#8288;</span>&rsquo; displays arrows on an existing plot. Each arrow is specified
by a position on the plot &lsquo;<span class="samp">&#8288;xpos,ypos&#8288;</span>&rsquo; and either x/y offsets or
orientation and magnitude. The default is x/y offsets, and the user must
specify whether radians or degrees are used if the orientation/magnitude option
is used.
</p>
<p>If the first four arguments are matrices, there must be no missing values. If
these arguments are vectors, the calculation of the scaling of the magnitudes
and length of the arrowheads may be slightly different.
</p>


<h3>Value</h3>

<p> nil </p>


<h3>Author(s)</h3>

<p>Jim Lemon (original code by Robin Hankin and Brian Ripley)</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+arrows">arrows</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
  # this requires the maps package, and just wouldn't pass check
  require(maps)
  map("world",xlim=c(110,155),ylim=c(-40,-10))
  par(xpd=TRUE)
  text(132,-5,"Approximate magnetic deviation - Australia",cex=1.5)
  par(xpd=FALSE)
  long&lt;-rep(seq(117.5,152.5,by=5),6)
  lat&lt;-rep(c(-12.5,-17.5,-22.5,-27.5,-32.5,-37.5),each=8)
  # just show the direction, don't have a magnitude difference
  mag&lt;-rep(1,48)
  devdeg&lt;-c(110,98,85,65,65,65,65,65,
   115,100,90,80,72,66,63,55,
   130,100,90,82,72,67,62,54,
   122,111,95,86,70,67,56,48,
   118,116,110,87,74,68,62,45,
   128,115,107,90,78,66,53,45)
  vectorField(devdeg,mag,long,lat,scale=0.7,vecspec="deg")
 
## End(Not run)
 # do a magnitude/direction plot with radians
 plot(1:10,type="n",main="Random vectors")
 mag&lt;-runif(100)+1
 dir&lt;-runif(100)*2*pi
 xpos&lt;-rep(1:10,10)
 ypos&lt;-rep(1:10,each=10)
 vectorcol&lt;-sample(colors(),100)
 vectorField(dir,mag,xpos,ypos,scale=0.8,vecspec="rad",col=vectorcol)
</code></pre>

<hr>
<h2 id='violin_plot'>Display a &quot;violin&quot; plot</h2><span id='topic+violin_plot'></span>

<h3>Description</h3>

<p>Displays violin plots (rotated kernel density plots on each
side of boxplots).</p>


<h3>Usage</h3>

<pre><code class='language-R'> violin_plot(X=rnorm(50),at,add=FALSE,na.rm=TRUE,bw,violin_width,
 violin_end_width=0.005,equal_width=TRUE,show_box=TRUE,box_width=0.01,
 box_col="black",show_outliers=TRUE,outlier_pch=NA,range=1.5,xlim,ylim,
 axes=TRUE,ann=TRUE,xlab="",ylab="",x_axis_labels,main="Violin Plot",
 col="red",median_col="white",show_mean=FALSE,mean_pch=19,
 mean_pch_col="yellow",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="violin_plot_+3A_x">X</code></td>
<td>
<p>A vector or matrix or data frame of numeric values.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_at">at</code></td>
<td>
<p>Horizontal position(s) for the violin plot(s).</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_add">add</code></td>
<td>
<p>Whether this violin should be added to an existing plot.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove NA values. Passed to functions such as
&lsquo;<span class="samp">&#8288;boxplot&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;density&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_bw">bw</code></td>
<td>
<p>Vector or bandwidth values for &lsquo;<span class="samp">&#8288;density&#8288;</span>&rsquo;. Will be
recycled. If not provided then will be calculated using &lsquo;<span class="samp">&#8288;bw.nrd0&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_violin_width">violin_width</code></td>
<td>
<p>Multiplier to scale the width of the &lsquo;<span class="samp">&#8288;violin&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_violin_end_width">violin_end_width</code></td>
<td>
<p>Multiplier to scale the width of the ends of the
violin.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_equal_width">equal_width</code></td>
<td>
<p>Should all violin widths be equal?</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_show_box">show_box</code></td>
<td>
<p>Whether to display the box.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_box_width">box_width</code></td>
<td>
<p>Multiplier for the width of internal boxes.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_box_col">box_col</code></td>
<td>
<p>Fill color for the internal rectangle.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_show_outliers">show_outliers</code></td>
<td>
<p>Whther to display outliers as points.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_outlier_pch">outlier_pch</code></td>
<td>
<p>Symbol for displaying outliers.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_range">range</code></td>
<td>
<p>Passed to &lsquo;<span class="samp">&#8288;boxplot&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_xlim">xlim</code>, <code id="violin_plot_+3A_ylim">ylim</code></td>
<td>
<p>Explicitly set the plot limits.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_axes">axes</code></td>
<td>
<p>Logical value indicating whether both axes should be
drawn on the plot.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_ann">ann</code></td>
<td>
<p>Annotate the plots with axis titles and overall titles.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_xlab">xlab</code>, <code id="violin_plot_+3A_ylab">ylab</code></td>
<td>
<p>Labels for the X and Y axes.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_x_axis_labels">x_axis_labels</code></td>
<td>
<p>Labels for the violins.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_main">main</code></td>
<td>
<p>Title for the violin plot.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_col">col</code></td>
<td>
<p>Fill color for the violin(s). Will be recycled.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_median_col">median_col</code></td>
<td>
<p>Fill color for the median mark.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_show_mean">show_mean</code></td>
<td>
<p>Whether to plot the mean as well as the median.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_mean_pch">mean_pch</code></td>
<td>
<p>Symbol to use for the mean.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_mean_pch_col">mean_pch_col</code></td>
<td>
<p>Fill color for the mean symbol.</p>
</td></tr>
<tr><td><code id="violin_plot_+3A_...">...</code></td>
<td>
<p>Extra arguments passed to &lsquo;<span class="samp">&#8288;polygon&#8288;</span>&rsquo; used for
representing violin(s).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;violin_plot&#8288;</span>&rsquo; displays one or more violin plots by drawing 
rotated kernel density curves on each side of box plots.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Darshan Baral</p>


<h3>Examples</h3>

<pre><code class='language-R'> # plotting a data frame
 violin_plot(mtcars)

 set.seed(42)
 normvar&lt;-c(rnorm(49),-3)
 unifvar&lt;-runif(50,-2,2)
 normvar2&lt;-rnorm(45)

 # plotting a matrix
 violin_plot(matrix(c(normvar,unifvar),ncol=2),
  main="Default Plot",x_axis_labels=c("Normal","Uniform"))

 # plotting with different colors and with at specified
 violin_plot(matrix(c(normvar,unifvar),ncol=2),at=1:3,
  main="Different colors and extra space",
  x_axis_labels=c("Normal","Uniform","Normal"),
  show_outliers=TRUE,col=c("blue","red"),median_col="lightgray",
  pch=6)

 # adding a violin to existing plot
 violin_plot(normvar2,at=3,add=TRUE,col="green",violin_width=1)
</code></pre>

<hr>
<h2 id='weighted.hist'>
Display a weighted histogram
</h2><span id='topic+weighted.hist'></span>

<h3>Description</h3>

<p>Calculate the counts of the weighted values in specified bins and 
optionally display either a frequency or density histogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> weighted.hist(x,w,breaks="Sturges",col=NULL,plot=TRUE,
 freq=TRUE,ylim=NA,ylab=NULL,xaxis=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weighted.hist_+3A_x">x</code></td>
<td>
<p>A vector of numeric values</p>
</td></tr>
<tr><td><code id="weighted.hist_+3A_w">w</code></td>
<td>
<p>A vector of weights at least as long as x.</p>
</td></tr>
<tr><td><code id="weighted.hist_+3A_breaks">breaks</code></td>
<td>
<p>The endpoints of the ranges into which to count the weighted
values.</p>
</td></tr>
<tr><td><code id="weighted.hist_+3A_col">col</code></td>
<td>
<p>An optional vector of colors for the bars of the histogram.</p>
</td></tr>
<tr><td><code id="weighted.hist_+3A_plot">plot</code></td>
<td>
<p>Whether to plot a histogram.</p>
</td></tr>
<tr><td><code id="weighted.hist_+3A_freq">freq</code></td>
<td>
<p>Whether to plot counts or densities.</p>
</td></tr>
<tr><td><code id="weighted.hist_+3A_ylim">ylim</code></td>
<td>
<p>The limits of the plot ordinate.</p>
</td></tr>
<tr><td><code id="weighted.hist_+3A_ylab">ylab</code></td>
<td>
<p>Label for the ordinate.</p>
</td></tr>
<tr><td><code id="weighted.hist_+3A_xaxis">xaxis</code></td>
<td>
<p>Whether to display an X axis.</p>
</td></tr>
<tr><td><code id="weighted.hist_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;barplot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;weighted.hist&#8288;</span>&rsquo; calculates the weighted counts of values falling 
into the ranges specified by &lsquo;<span class="samp">&#8288;breaks&#8288;</span>&rsquo;. Instead of counting each 
value as 1, it counts the corresponding value in &lsquo;<span class="samp">&#8288;w&#8288;</span>&rsquo; (the weight).
</p>
<p>&lsquo;<span class="samp">&#8288;breaks&#8288;</span>&rsquo; may be specified by a monotonically increasing vector 
of numbers that are interpreted as the endpoints of the ranges, a 
single number representing the number of ranges desired or the name 
of the function to calculate the ranges (see <a href="graphics.html#topic+hist">hist</a>).
If a vector of numbers is passed that does not include all values in 
&lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;, the user is warned.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<p>breaks - The endpoints of the intervals
</p>
<p>counts - The weighted counts
</p>
<p>density - The weighted counts divided by their sum.
</p>
<p>mids - The midpoints of the intervals and the bars displayed.
</p>
<p>xname - the name of &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.
</p>


<h3>Author(s)</h3>

<p>Jim Lemon and Hadley Wickham - thanks to Ben Graf for asking for a
custom x axis option and Martin Maechler for fixing the barplot problem</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+hist">hist</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> testx&lt;-sample(1:10,300,TRUE)
 testw&lt;-seq(1,4,by=0.01)
 weighted.hist(testx,testw,breaks=1:10,main="Test weighted histogram")
</code></pre>

<hr>
<h2 id='zoomInPlot'>
Display a plot with a rectangular section expanded in an adjacent plot
</h2><span id='topic+zoomInPlot'></span>

<h3>Description</h3>

<p>Display one plot on the left half of a device and an expanded section of that
plot on the right half of the device with connecting lines showing the expansion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> zoomInPlot(x,y=NULL,xlim=NULL,ylim=NULL,rxlim=xlim,rylim=ylim,xend=NA,
  zoomtitle=NULL,titlepos=NA,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zoomInPlot_+3A_x">x</code>, <code id="zoomInPlot_+3A_y">y</code></td>
<td>
<p>numeric data vectors. If &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; is not specified, it is set equal
to &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; is set to &lsquo;<span class="samp">&#8288;1:length(y)&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="zoomInPlot_+3A_xlim">xlim</code>, <code id="zoomInPlot_+3A_ylim">ylim</code></td>
<td>
<p>Limits for the initial plot.</p>
</td></tr>
<tr><td><code id="zoomInPlot_+3A_rxlim">rxlim</code>, <code id="zoomInPlot_+3A_rylim">rylim</code></td>
<td>
<p>Limits for the expanded plot. These must be within the above.</p>
</td></tr>
<tr><td><code id="zoomInPlot_+3A_xend">xend</code></td>
<td>
<p>Where to end the segments that indicate the expansion. Defaults to
just left of the tick labels on the left ordinate.</p>
</td></tr>
<tr><td><code id="zoomInPlot_+3A_zoomtitle">zoomtitle</code></td>
<td>
<p>The title of the plot, display in the top center.</p>
</td></tr>
<tr><td><code id="zoomInPlot_+3A_titlepos">titlepos</code></td>
<td>
<p>The horizontal position of the title in user units of the
zoomed plot.</p>
</td></tr>
<tr><td><code id="zoomInPlot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to &lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;<span class="samp">&#8288;zoomInPlot&#8288;</span>&rsquo; sets up a two column layout in the current device and calls
&lsquo;<span class="samp">&#8288;plot&#8288;</span>&rsquo; to display a plot in the left column. It then draws a rectangle
corresponding to the &lsquo;<span class="samp">&#8288;rxlim&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;rylim&#8288;</span>&rsquo; arguments and displays a
second plot of that rectangle in the right column. It is currently very simple
and will probably become more flexible in future versions.
</p>
<p>It just has. If &lsquo;<span class="samp">&#8288;rxlim&#8288;</span>&rsquo; is set to NA, &lsquo;<span class="samp">&#8288;locator&#8288;</span>&rsquo; will be called and
the user can define the zoomed rectangle by clicking on each corner. This is a
shameless ripoff of a suggestion by Greg Snow on the help list. Thanks, Greg.
</p>


<h3>Value</h3>

<p>nil</p>


<h3>Author(s)</h3>

<p>Jim Lemon</p>


<h3>See Also</h3>

<p><a href="graphics.html#topic+plot">plot</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> zoomInPlot(rnorm(100),rnorm(100),rxlim=c(-1,1),rylim=c(-1,1),
  zoomtitle="Zoom In Plot",titlepos=-1.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
