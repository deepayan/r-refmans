<!DOCTYPE html><html><head><title>Help for package ipsRdbs</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ipsRdbs}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#beanie'><p>Age and value of 50 beanie baby toys</p></a></li>
<li><a href='#bill'><p>Wealth, age and region of 225 billionaires in 1992 as reported in the</p>
Fortune magazine</a></li>
<li><a href='#bodyfat'><p>Body fat percentage data for 102 elite male athletes  training at the</p>
Australian Institute of Sport.</a></li>
<li><a href='#bombhits'><p>Number of bomb hits in London during World War II</p></a></li>
<li><a href='#butterfly'><p>Draws a butterfly as in the front cover of the book</p></a></li>
<li><a href='#cement'><p>Breaking strength of cement data</p></a></li>
<li><a href='#cfail'><p>Weekly number of failures of a university computer system over a period of</p>
two years. This is a data vector containing 104 values.</a></li>
<li><a href='#cheese'><p>Testing of cheese data set</p></a></li>
<li><a href='#emissions'><p>Nitrous oxide emission data</p></a></li>
<li><a href='#err_age'><p>Errors in guessing ages of Southampton mathematicians</p></a></li>
<li><a href='#ffood'><p>Service (waiting) times (in seconds)  of customers at a fast-food</p>
restaurant.</a></li>
<li><a href='#gasmileage'><p>Gas mileage of four models of car</p></a></li>
<li><a href='#monty'><p># Simulation of the Monty Hall Problem</p>
# Demonstrates that switching is always better than staying with
# your initial guess
Programme written by Corey Chivers, 2012</a></li>
<li><a href='#possum'><p>Body weight and length of possums (tree living furry animals who are mostly</p>
nocturnal (marsupial) caught in 7 different regions of Australia.</a></li>
<li><a href='#puffin'><p>Puffin nesting data set. It contains data regarding</p>
nesting habits of common puffin</a></li>
<li><a href='#rice'><p>Riece yield data</p></a></li>
<li><a href='#see_the_clt_for_Bernoulli'><p>Illustration of the CLT for samples from the Bernoulli distribution</p></a></li>
<li><a href='#see_the_clt_for_uniform'><p>Illustration of the central limit theorem for sampling from the</p>
uniform distribution</a></li>
<li><a href='#see_the_wlln_for_uniform'><p>Illustration of the weak law of large numbers  for sampling from the</p>
uniform distribution</a></li>
<li><a href='#wgain'><p>Weight gain data from 68 first year students during their first 12</p>
weeks in college</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Introduction to Probability, Statistics and R for Data Based
Sciences</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-19</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains data sets, programmes and illustrations 
    discussed in the book, "Introduction to Probability, Statistics and R:
    Foundations for Data-Based Sciences."  Sahu (2023, isbn:978-3-031-37864-5)
    describes the methods in detail.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sujit K. Sahu &lt;S.K.Sahu@soton.ac.uk&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.sujitsahu.com">https://www.sujitsahu.com</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a> | file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rdpack, utils, ggplot2, extraDistr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>GGally, xtable, MASS, knitr, rmarkdown, testthat, tidyr,
huxtable, RColorBrewer, markdown, bookdown, BiocStyle</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sujit-sahu/ipsRdbs/issues">https://github.com/sujit-sahu/ipsRdbs/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-30 07:07:36 UTC; sks</td>
</tr>
<tr>
<td>Author:</td>
<td>Sujit K. Sahu <a href="https://orcid.org/0000-0003-2315-3598"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-05 13:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='beanie'>Age and value of 50 beanie baby toys</h2><span id='topic+beanie'></span>

<h3>Description</h3>

<p>Age and value of 50 beanie baby toys
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beanie
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 50 rows and 3 columns.
</p>


<h3>Source</h3>

<p>Beanie world magazine
@format A data frame with 50 rows and 3 columns:
</p>

<dl>
<dt>name</dt><dd><p>Name of the toy</p>
</dd>
<dt>age</dt><dd><p>Age of the toy in months</p>
</dd>
<dt>value</dt><dd><p>Market value of the toy in US dollars</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'> summary(beanie)
 head(beanie)
</code></pre>

<hr>
<h2 id='bill'>Wealth, age and region of 225 billionaires in 1992 as reported in the 
Fortune magazine</h2><span id='topic+bill'></span>

<h3>Description</h3>

<p>Wealth, age and region of 225 billionaires in 1992 as reported in the 
Fortune magazine
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bill
</code></pre>


<h3>Format</h3>

<p>A data frame with 225 rows and three columns:
</p>

<dl>
<dt>wealth</dt><dd><p>Wealth in billions of US dollars</p>
</dd>
<dt>age</dt><dd><p>Age of the billionaire</p>
</dd>
<dt>region</dt><dd><p>five regions:Asia, Europe, Middle East, United States, and Other</p>
</dd>
</dl>



<h3>Source</h3>

<p>Fortune magazine 1992.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(bill)
summary(bill)
library(ggplot2)
gg &lt;- ggplot2::ggplot(data=bill, aes(x=age, y=wealth)) +
geom_point(aes(col=region, size=wealth)) + 
geom_smooth(method="loess", se=FALSE) + 
xlim(c(7, 102)) + 
ylim(c(1, 37)) + 
labs(subtitle="Wealth vs Age of Billionaires", 
y="Wealth (Billion US $)", x="Age", 
title="Scatterplot", caption = "Source: Fortune Magazine, 1992.")
plot(gg)
</code></pre>

<hr>
<h2 id='bodyfat'>Body fat percentage data for 102 elite male athletes  training at the 
Australian Institute of Sport.</h2><span id='topic+bodyfat'></span>

<h3>Description</h3>

<p>Body fat percentage data for 102 elite male athletes  training at the 
Australian Institute of Sport.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bodyfat
</code></pre>


<h3>Format</h3>

<p>A data frame with 102 rows and two columns:
</p>

<dl>
<dt>Skinfold</dt><dd><p>Skin-fold thicknesses measured using calipers</p>
</dd>
<dt>Bodyfat</dt><dd><p>Percentage of fat content in the body</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data collected by Dr R. Telford who was working for 
the Australian Institute of Sport (AIS)
</p>


<h3>Examples</h3>

<pre><code class='language-R'> summary(bodyfat)
plot(bodyfat$Skinfold,  bodyfat$Bodyfat, xlab="Skin", ylab="Fat")
plot(bodyfat$Skinfold,  log(bodyfat$Bodyfat), xlab="Skin", ylab="log Fat")
plot(log(bodyfat$Skinfold),  log(bodyfat$Bodyfat), xlab="log Skin", ylab="log Fat")
old.par &lt;- par(no.readonly = TRUE)
# par(mfrow=c(2,2)) # draws four plots in a graph
plot(bodyfat$Skinfold,  bodyfat$Bodyfat, xlab="Skin", ylab="Fat")
plot(bodyfat$Skinfold,  log(bodyfat$Bodyfat), xlab="Skin", ylab="log Fat")
plot(log(bodyfat$Skinfold),  log(bodyfat$Bodyfat), xlab="log Skin", ylab="log Fat")
plot(1:5, 1:5, axes=FALSE, xlab="", ylab="",  type="n")
text(2, 2, "Log both X and Y")
text(2, 1, "To have the best plot")
# Keep the transformed variables in the data set 
bodyfat$logskin &lt;- log(bodyfat$Skinfold)
bodyfat$logbfat &lt;- log(bodyfat$Bodyfat)
bodyfat$logskin &lt;- log(bodyfat$Skinfold)
par(old.par)
 # Create a grouped variable 
bodyfat$cutskin &lt;- cut(log(bodyfat$Skinfold), breaks=6) 
boxplot(data=bodyfat, Bodyfat~cutskin, col=2:7)
head(bodyfat)
require(ggplot2)
p2 &lt;- ggplot(data=bodyfat, aes(x=cutskin, y=logbfat)) + 
geom_boxplot(col=2:7) + 
stat_summary(fun=mean, geom="line", aes(group=1), col="blue", linewidth=1) +
labs(x="Skinfold", y="Percentage of log bodyfat", 
title="Boxplot of log-bodyfat percentage vs grouped log-skinfold")  
plot(p2)

n &lt;- nrow(bodyfat)
x &lt;- bodyfat$logskin
y &lt;- bodyfat$logbfat
xbar &lt;- mean(x)
ybar &lt;- mean(y)
sx2 &lt;- var(x)
sy2 &lt;- var(y)
sxy &lt;- cov(x, y)
r &lt;- cor(x, y)
print(list(n=n, xbar=xbar, ybar=ybar, sx2=sx2, sy2=sy2, sxy=sxy, r=r))
hatbeta1 &lt;- r * sqrt(sy2/sx2) # calculates estimate of the slope
hatbeta0 &lt;- ybar - hatbeta1 * xbar # calculates estimate of the intercept
rs &lt;-  y - hatbeta0 - hatbeta1 * x  # calculates residuals
s2 &lt;- sum(rs^2)/(n-2)  # calculates estimate of sigma2
s2
bfat.lm &lt;- lm(logbfat ~ logskin, data=bodyfat)
### Check the diagnostics 
plot(bfat.lm$fit, bfat.lm$res, xlab="Fitted values", ylab = "Residuals")
abline(h=0)
### Should be a random scatter
qqnorm(bfat.lm$res)
qqline(bfat.lm$res)

# All Points should be on the straight line 
summary(bfat.lm)
anova(bfat.lm)
plot(bodyfat$logskin,  bodyfat$logbfat, xlab="log Skin", ylab="log Fat")
abline(bfat.lm, col=7)
title("Scatter plot with the fitted Linear Regression line")
# 95% CI for beta(1)
# 0.88225 + c(-1, 1) * qt(0.975, df=100) *  0.02479 
# round(0.88225 + c(-1, 1) * qt(0.975, df=100) *  0.02479, 2)
# To test H0: beta1 = 1. 
tstat &lt;- (0.88225 -1)/0.02479 
pval &lt;- 2 * (1- pt(abs(tstat), df=100))
x &lt;- seq(from=-5, to=5, length=500)
y &lt;- dt(x, df=100)
plot(x, y,  xlab="", ylab="", type="l")
title("T-density with df=100")
abline(v=abs(tstat))
abline(h=0)
x1 &lt;- seq(from=abs(tstat), to=10, length=100)
y1 &lt;- rep(0, length=100)
x2 &lt;- x1
y2 &lt;- dt(x1, df=100)
segments(x1, y1, x2, y2)
abline(h=0)
# Predict at a new value of Skinfold=70
# Create a new data set called new
newx &lt;- data.frame(logskin=log(70))
a &lt;- predict(bfat.lm, newdata=newx, se.fit=TRUE) 
# Confidence interval for the mean of log bodyfat  at skinfold=70
a &lt;- predict(bfat.lm, newdata=newx, interval="confidence") 
# a
#          fit      lwr     upr
# [1,] 2.498339 2.474198 2.52248
# Prediction interval for a future log bodyfat  at skinfold=70
a &lt;- predict(bfat.lm, newdata=newx, interval="prediction") 
a
#          fit      lwr      upr
# [1,] 2.498339 2.333783 2.662895
#prediction intervals for the mean 
pred.bfat.clim &lt;- predict(bfat.lm, data=bodyfat, interval="confidence")
#prediction intervals for future observation
pred.bfat.plim &lt;- suppressWarnings(predict(bfat.lm, data=bodyfat, interval="prediction"))
plot(bodyfat$logskin,  bodyfat$logbfat, xlab="log Skin", ylab="log Fat")
abline(bfat.lm, col=5)
lines(log(bodyfat$Skinfold), pred.bfat.clim[,2], lty=2, col=2) 
lines(log(bodyfat$Skinfold), pred.bfat.clim[,3], lty=2, col=2) 
lines(log(bodyfat$Skinfold), pred.bfat.plim[,2], lty=4, col=3) 
lines(log(bodyfat$Skinfold), pred.bfat.plim[,3], lty=4, col=3) 
title("Scatter plot with the fitted line and prediction intervals")
symb &lt;- c("Fitted line", "95% CI for mean", "95% CI for observation")
## legend(locator(1), legend = symb, lty = c(1, 2, 4), col = c(5, 2, 3))
# Shows where we predicted earlier 
abline(v=log(70))
summary(bfat.lm)
anova(bfat.lm)
</code></pre>

<hr>
<h2 id='bombhits'>Number of bomb hits in London during World War II</h2><span id='topic+bombhits'></span>

<h3>Description</h3>

<p>Number of bomb hits in London during World War II
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bombhits
</code></pre>


<h3>Format</h3>

<p>A data frame with two columns and six rows:
</p>

<dl>
<dt>numberhit</dt><dd><p>The number of  bomb hits during World War II 
in each of the 576 areas in London.</p>
</dd>
<dt>freq</dt><dd><p>Frequency of the number of hits</p>
</dd>
</dl>



<h3>Source</h3>

<p>Shaw and Shaw (2019).
</p>


<h3>Examples</h3>

<pre><code class='language-R'> summary(bombhits)
 # Create a vector of data 
 x &lt;- c(rep(0, 229), rep(1, 211), rep(2, 93), rep(3, 35), rep(4, 7), 5)
 y &lt;- c(229, 211, 93, 35, 7, 1) # Frequencies 
 rel_freq &lt;- y/576
 xbar &lt;- mean(x)
 pois_prob &lt;- dpois(x=0:5, lambda=xbar)
 fit_freq &lt;- pois_prob * 576
  #Check 
  cbind(x=0:5, obs_freq=y, rel_freq =round(rel_freq, 4),  
  Poisson_prob=round(pois_prob, 4), fit_freq=round(fit_freq, 1))
  obs_freq &lt;- y
  xuniques &lt;- 0:5
  a &lt;- data.frame(xuniques=0:5, obs_freq =y, fit_freq=fit_freq)
  barplot(rbind(obs_freq, fit_freq), 
  args.legend = list(x = "topright"), 
  xlab="No of bomb hits",  
  names.arg = xuniques,  beside=TRUE, 
  col=c("darkblue","red"), 
  legend =c("Observed", "Fitted"), 
  main="Observed and Poisson distribution fitted frequencies 
  for the number of bomb hits in London")
</code></pre>

<hr>
<h2 id='butterfly'>Draws a butterfly as in the front cover of the book</h2><span id='topic+butterfly'></span>

<h3>Description</h3>

<p>Draws a butterfly as in the front cover of the book
</p>


<h3>Usage</h3>

<pre><code class='language-R'>butterfly(color = 2, p1 = 2, p2 = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="butterfly_+3A_color">color</code></td>
<td>
<p>This is the color to use in the plot. It can take any value 
that R can use for color, e.g. 1, 2, &quot;blue&quot; etc.</p>
</td></tr>
<tr><td><code id="butterfly_+3A_p1">p1</code></td>
<td>
<p>Parameter controlling the shape of the butterfly</p>
</td></tr>
<tr><td><code id="butterfly_+3A_p2">p2</code></td>
<td>
<p>Second parameter controlling the shape of the butterfly</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects. It generates a plot
whose colour and shape are determined by the supplied parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>butterfly(color = 6)
old.par &lt;- par(no.readonly = TRUE)
par(mfrow=c(2, 2))
butterfly(color = 6)
butterfly(p1=5, p2=5, color=2)
butterfly(p1=10, p2=1.5, color = "seagreen")
butterfly(p1=20, p2=4, color = "blue")
par(old.par) # par(mfrow=c(1, 1))
</code></pre>

<hr>
<h2 id='cement'>Breaking strength of cement data</h2><span id='topic+cement'></span>

<h3>Description</h3>

<p>Breaking strength of cement data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cement
</code></pre>


<h3>Format</h3>

<p>A data frame with 36 rows and 3 columns:
</p>

<dl>
<dt>strength</dt><dd><p>Breaking strength in pounds per square inch</p>
</dd>
<dt>gauger</dt><dd><p>Three different gauger machines which mixes cement with water</p>
</dd>
<dt>breaker</dt><dd><p>Three different breakers breaking the cement cubes</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'> summary(cement)
</code></pre>

<hr>
<h2 id='cfail'>Weekly number of failures of a university computer system over a period of 
two years. This is a data vector containing 104 values.</h2><span id='topic+cfail'></span>

<h3>Description</h3>

<p>Weekly number of failures of a university computer system over a period of 
two years. This is a data vector containing 104 values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cfail
</code></pre>


<h3>Format</h3>

<p>An object of class <code>numeric</code> of length 104.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> summary(cfail)
 # 95% Confidence interval 
 c(3.75-1.96 * 3.381/sqrt(104), 3.75+1.96*3.381/sqrt(104)) # =(3.10,4.40).
 x &lt;- cfail 
 n &lt;- length(x)
 h &lt;- qnorm(0.975) 
 # 95% Confidence interval Using quadratic inversion 
 mean(x) + (h*h)/(2*n) + c(-1, 1) * h/sqrt(n) * sqrt(h*h/(4*n) + mean(x))
 # Modelling 
 # Observed frequencies 
 obs_freq &lt;- as.vector(table(x))
 # Obtain unique x values 
 xuniques &lt;- sort(unique(x))
 lam_hat &lt;- mean(x)
 fit_freq &lt;- n * dpois(xuniques, lambda=lam_hat)
 fit_freq &lt;- round(fit_freq, 1)
 # Create a data frame for plotting 
 a &lt;- data.frame(xuniques=xuniques, obs_freq = obs_freq, fit_freq=fit_freq)
 barplot(rbind(obs_freq, fit_freq), args.legend = list(x = "topright"), 
 xlab="No of weekly computer failures",  
 names.arg = xuniques,  beside=TRUE, col=c("darkblue","red"), 
 legend =c("Observed", "Fitted"), 
 main="Observed and Poisson distribution fitted frequencies 
 for the computer failure data: cfail")
</code></pre>

<hr>
<h2 id='cheese'>Testing of cheese data set</h2><span id='topic+cheese'></span>

<h3>Description</h3>

<p>Testing of cheese data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cheese
</code></pre>


<h3>Format</h3>

<p>A data frame with 30 rows and 5 columns
</p>

<dl>
<dt>Taste</dt><dd><p>A measure of taste quality of cheese</p>
</dd>
<dt>AceticAcid</dt><dd><p>Concentration of Acetic acid</p>
</dd>
<dt>H2S</dt><dd><p>Concentration of hydrogen sulphide</p>
</dd>
<dt>LacticAcid</dt><dd><p>Concentration lactic acid</p>
</dd>
<dt>logH2S</dt><dd><p>Logarithm of H2S</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'> summary(cheese)
 pairs(cheese)
 GGally::ggpairs(data=cheese)
 cheese.lm &lt;- lm(Taste ~ AceticAcid +  LacticAcid + logH2S, data=cheese, subset=2:30)
 # Check the diagnostics 
 plot(cheese.lm$fit, cheese.lm$res, xlab="Fitted values", ylab = "Residuals")
 abline(h=0)
 # Should be a random scatter
 qqnorm(cheese.lm$res)
 qqline(cheese.lm$res)
 summary(cheese.lm)
 cheese.lm2 &lt;- lm(Taste ~ LacticAcid + logH2S, data=cheese)
 # Check the diagnostics 
 plot(cheese.lm2$fit, cheese.lm2$res, xlab="Fitted values", ylab = "Residuals")
 abline(h=0)
 qqnorm(cheese.lm2$res)
 qqline(cheese.lm2$res)
 summary(cheese.lm2)
 # How can we predict? 
 newcheese &lt;- data.frame(AceticAcid = 300, LacticAcid = 1.5, logH2S=4)
 cheese.pred &lt;- predict(cheese.lm2, newdata=newcheese, se.fit=TRUE)
 cheese.pred
 # Obtain confidence interval 
 cheese.pred$fit + c(-1, 1) * qt(0.975, df=27) * cheese.pred$se.fit
 # Using R to predict  
 cheese.pred.conf.limits &lt;- predict(cheese.lm2, newdata=newcheese, interval="confidence")
 cheese.pred.conf.limits
 # How to find prediction interval 
 cheese.pred.pred.limits &lt;- predict(cheese.lm2, newdata=newcheese, interval="prediction")
 cheese.pred.pred.limits
</code></pre>

<hr>
<h2 id='emissions'>Nitrous oxide emission data</h2><span id='topic+emissions'></span>

<h3>Description</h3>

<p>Nitrous oxide emission data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emissions
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 54 rows and 13 columns.
</p>


<h3>Source</h3>

<p>Australian Traffic Accident Research Bureau 
@format A data frame with thirteen columns and 54 rows. 
</p>

<dl>
<dt>Make</dt><dd><p>Make of the car</p>
</dd>
<dt>Odometer</dt><dd><p>Odometer reading of the car</p>
</dd>
<dt>Capacity</dt><dd><p>Engine capacity of the car</p>
</dd>
<dt>CS505</dt><dd><p>A measurement taken while running the engine from a cold 
start for 505 seconds</p>
</dd> 
<dt>T867</dt><dd><p>A measurement taken while running the engine in transition 
from cold to hot for 867 seconds</p>
</dd>
<dt>H505</dt><dd><p>A measurement taken while running the hot engine for 
505 seconds</p>
</dd>
<dt>ADR27</dt><dd><p>A previously used measurement standard</p>
</dd>
<dt>ADR37</dt><dd><p>Result of the Australian standard ADR37test</p>
</dd>
<dt>logCS505</dt><dd><p>Logarithm of CS505</p>
</dd>
<dt>logT867</dt><dd><p>Logarithm of T867</p>
</dd>
<dt>logH505</dt><dd><p>Logarithm of H505</p>
</dd>
<dt>logADR27</dt><dd><p>Logarithm of ADR27</p>
</dd>
<dt>logADR37</dt><dd><p>Logarithm of ADR37</p>
</dd> 
</dl>



<h3>Examples</h3>

<pre><code class='language-R'> summary(emissions)
 
 rawdata &lt;- emissions[, c(8, 4:7)]
 pairs(rawdata)
# Fit the model on the raw scale 
raw.lm &lt;- lm(ADR37 ~ ADR27 + CS505  + T867 + H505, data=rawdata) 
old.par &lt;- par(no.readonly = TRUE)
par(mfrow=c(2,1))
plot(raw.lm$fit, raw.lm$res,xlab="Fitted values",ylab="Residuals", main="Anscombe plot") 
abline(h=0)
qqnorm(raw.lm$res,main="Normal probability plot")
qqline(raw.lm$res)
# summary(raw.lm)
logdata &lt;- log(rawdata)
# This only logs the values but not the column names!
# We can use the following command to change the column names or you can use
# fix(logdata) to do it. 
dimnames(logdata)[[2]] &lt;- c("logADR37", "logCS505", "logT867", "logH505", "logADR27")
pairs(logdata)
log.lm &lt;- lm(logADR37 ~ logADR27 + logCS505  + logT867 + logH505, data=logdata) 
plot(log.lm$fit, log.lm$res,xlab="Fitted values",ylab="Residuals", main="Anscombe plot") 
abline(h=0)
qqnorm(log.lm$res,main="Normal probability plot")
qqline(log.lm$res)
summary(log.lm)
log.lm2 &lt;- lm(logADR37 ~ logADR27 + logT867 + logH505, data=logdata) 
summary(log.lm2)
plot(log.lm2$fit, log.lm2$res,xlab="Fitted values",ylab="Residuals", main="Anscombe plot") 
abline(h=0)
qqnorm(log.lm2$res,main="Normal probability plot")
qqline(log.lm2$res)
par(old.par)
#####################################
# Multicollinearity Analysis 
######################################
mod.adr27 &lt;-  lm(logADR27 ~ logT867 + logCS505 + logH505, data=logdata) 
summary(mod.adr27) # Multiple R^2 = 0.9936,
mod.t867 &lt;-  lm(logT867 ~ logADR27 + logH505 + logCS505, data=logdata)  
summary(mod.t867) # Multiple R^2 = 0.977,
mod.cs505 &lt;-  lm(logCS505 ~ logADR27 + logH505 + logT867, data=logdata)  
summary(mod.cs505) # Multiple R^2 = 0.9837,
mod.h505 &lt;-  lm(logH505 ~ logADR27 + logCS505 + logT867, data=logdata)  
summary(mod.h505) # Multiple R^2 = 0.5784,
# Variance inflation factors 
vifs &lt;- c(0.9936, 0.977, 0.9837, 0.5784)
vifs &lt;- 1/(1-vifs) 
#Condition numbers 
X &lt;- logdata 
# X is a copy of logdata 
X[,1] &lt;- 1
# the first column of X is 1
# this is for the intercept 
X &lt;- as.matrix(X) 
# Coerces X to be a matrix
xtx &lt;- t(X) %*% X # Gives X^T X
eigenvalues &lt;- eigen(xtx)$values
kappa &lt;- max(eigenvalues)/min(eigenvalues)
kappa &lt;- sqrt(kappa)
# kappa = 244 is much LARGER than 30!

### Validation statistic
# Fit the log.lm2 model with the first 45 observations  
# use the fitted model to predict the remaining 9 observations 
# Calculate the mean square error validation statistic 
log.lmsub &lt;- lm(logADR37 ~ logADR27 + logT867 + logH505, data=logdata, subset=1:45) 
# Now predict all 54 observations using the fitted model
mod.pred &lt;- predict(log.lmsub, logdata, se.fit=TRUE) 
mod.pred$fit # provides all the 54 predicted values 
logdata$pred &lt;- mod.pred$fit
# Get only last 9 
a &lt;- logdata[46:54, ]
validation.residuals &lt;- a$logADR37 - a$pred  
validation.stat &lt;- mean(validation.residuals^2)
validation.stat
</code></pre>

<hr>
<h2 id='err_age'>Errors in guessing ages of Southampton mathematicians</h2><span id='topic+err_age'></span>

<h3>Description</h3>

<p>@format A data frame with 550 rows and 10 columns
</p>

<dl>
<dt>group</dt><dd><p>Group number of the students guessing the ages</p>
</dd>
<dt>size</dt><dd><p>Number of students in the group</p>
</dd>
<dt>females</dt><dd><p>How many female guessers were in the group</p>
</dd>
<dt>photo</dt><dd><p>Photograph number guessed, can take value 1 to 10.</p>
</dd>
<dt>sex</dt><dd><p>Gender of the photographed person.</p>
</dd>
<dt>race</dt><dd><p>Race of the photographed person.</p>
</dd>
<dt>est_age</dt><dd><p>Estimated age of the photographed person.</p>
</dd>
<dt>tru_age</dt><dd><p>True age of the photographed person.</p>
</dd>
<dt>error</dt><dd><p>The value of error, estimated age minus true age</p>
</dd>
<dt>abs_error</dt><dd><p>Absolute value of the error</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>err_age
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 550 rows and 10 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> summary(err_age)
</code></pre>

<hr>
<h2 id='ffood'>Service (waiting) times (in seconds)  of customers at a fast-food 
restaurant.</h2><span id='topic+ffood'></span>

<h3>Description</h3>

<p>@format A data frame with 10 rows and 2 columns:
</p>

<dl>
<dt>AM</dt><dd><p>Waiting times for customers served during 9-10AM</p>
</dd>
<dt>PM</dt><dd><p>Waiting times for customers served during 2-3PM</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>ffood
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 10 rows and 2 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> summary(ffood)
 # 95% Confidence interval for the mean waiting time usig t-distribution
 a &lt;- c(ffood$AM, ffood$PM)
 mean(a) + c(-1, 1) * qt(0.975, df=19) * sqrt(var(a))/sqrt(20) 
 # Two sample t-test for the difference between morning and afternoon times
 t.test(ffood$AM, ffood$PM)
</code></pre>

<hr>
<h2 id='gasmileage'>Gas mileage of four models of car</h2><span id='topic+gasmileage'></span>

<h3>Description</h3>

<p>Gas mileage of four models of car
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gasmileage
</code></pre>


<h3>Format</h3>

<p>A data frame with two columns and eleven rows:
</p>

<dl>
<dt>mileage</dt><dd><p>Mileage obtained</p>
</dd>
<dt>model</dt><dd><p>Four car models</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>summary(gasmileage)
y &lt;- c(22, 26,  28, 24, 29,   29, 32, 28,  23, 24)
xx &lt;- c(1,1,2,2,2,3,3,3,4,4)
# Plot the observations 
plot(xx, y, col="red", pch="*", xlab="Model", ylab="Mileage")
# Method1: Hand calculation 
ni &lt;- c(2, 3, 3, 2)
means &lt;- tapply(y, xx, mean)
vars &lt;- tapply(y, xx, var)
round(rbind(means, vars), 2)
sum(y^2) # gives 7115
totalSS &lt;- sum(y^2) - 10 * (mean(y))^2 # gives 92.5 
RSSf &lt;- sum(vars*(ni-1)) # gives 31.17 
groupSS &lt;- totalSS - RSSf # gives 61.3331.17/6
meangroupSS &lt;- groupSS/3 # gives 20.44
meanErrorSS &lt;- RSSf/6 # gives 5.194
Fvalue &lt;- meangroupSS/meanErrorSS # gives 3.936 
pvalue &lt;- 1-pf(Fvalue, df1=3, df2=6)

#### Method 2: Illustrate using dummy variables
#################################
#Create the design matrix X for the full regression model
g &lt;- 4
n1 &lt;- 2 
n2 &lt;- 3
n3 &lt;- 3
n4 &lt;- 2
n &lt;- n1+n2+n3+n4
X &lt;- matrix(0, ncol=g, nrow=n)       #Set X as a zero matrix initially
X[1:n1,1] &lt;- 1    #Determine the first column of X
X[(n1+1):(n1+n2),2] &lt;- 1   #the 2nd column
X[(n1+n2+1):(n1+n2+n3),3] &lt;- 1    #the 3rd
X[(n1+n2+n3+1):(n1+n2+n3+n4),4] &lt;- 1    #the 4th 
#################################
####Fitting the  full model####
#################################
#Estimation
XtXinv &lt;- solve(t(X)%*%X)
betahat &lt;- XtXinv %*%t(X)%*%y   #Estimation of the coefficients
Yhat &lt;- X%*%betahat   #Fitted Y values
Resids &lt;- y - Yhat   #Residuals
SSE &lt;- sum(Resids^2)   #Error sum of squares
S2hat &lt;- SSE/(n-g)   #Estimation of sigma-square; mean square for error
Sigmahat &lt;- sqrt(S2hat)

##############################################################
####Fitting the reduced model -- the 4 means are equal #####
##############################################################
Xr &lt;- matrix(1, ncol=1, nrow=n)
kr &lt;- dim(Xr)[2]
#Estimation
Varr &lt;- solve(t(Xr)%*%Xr)
hbetar &lt;- solve(t(Xr)%*%Xr)%*%t(Xr)%*% y   #Estimation of the coefficients
hYr = Xr%*%hbetar   #Fitted Y values
Resir &lt;- y - hYr   #Residuals
SSEr &lt;- sum(Resir^2)   #Total sum of squares
###################################################################
####F-test for comparing the reduced model with the full model ####
###################################################################
FStat &lt;- ((SSEr-SSE)/(g-kr))/(SSE/(n-g))  #The test statistic of the F-test
alpha &lt;- 0.05
Critical_value_F &lt;- qf(1-alpha, g-kr,n-g)  #The critical constant of F-test
pvalue_F &lt;- 1-pf(FStat,g-kr, n-g)   #p-value of F-test

modelA &lt;- c(22, 26)
modelB &lt;- c(28, 24, 29)
modelC &lt;- c(29, 32, 28)
modelD &lt;- c(23, 24)

SSerror = sum( (modelA-mean(modelA))^2 ) + sum( (modelB-mean(modelB))^2 ) 
+ sum( (modelC-mean(modelC))^2 ) + sum( (modelD-mean(modelD))^2 )
SStotal &lt;-  sum( (y-mean(y))^2 ) 
SSgroup &lt;- SStotal-SSerror

####
#### Method 3: Use the  built-in function lm directly

#####################################
aa &lt;- "modelA"
bb &lt;- "modelB"
cc &lt;- "modelC"
dd &lt;- "modelD"
Expl &lt;- c(aa,aa,bb,bb,bb,cc,cc,cc,dd,dd)
is.factor(Expl)
Expl &lt;- factor(Expl)
model1 &lt;- lm(y~Expl)
summary(model1)      
anova(model1)
###Alternatively ###

xxf &lt;- factor(xx)
is.factor(xxf)
model2 &lt;- lm(y~xxf)
summary(model2)
anova(model2)
</code></pre>

<hr>
<h2 id='monty'># Simulation of the Monty Hall Problem
# Demonstrates that switching is always better than staying with 
# your initial guess
Programme written by Corey Chivers, 2012</h2><span id='topic+monty'></span>

<h3>Description</h3>

<p># Simulation of the Monty Hall Problem
# Demonstrates that switching is always better than staying with 
# your initial guess
Programme written by Corey Chivers, 2012
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monty(strat = "stay", N = 1000, print_games = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monty_+3A_strat">strat</code></td>
<td>
<p>Strategy to use; possibilities are:
</p>
  
<ul>
<li><p>&quot;stay&quot; Do not change the initial door chosen  
</p>
</li>
<li><p>&quot;swap&quot; Swap the door chosen initially.  
</p>
</li>
<li><p>&quot;random&quot; Randomly decide to stay or swap.
</p>
</li></ul>
</td></tr>
<tr><td><code id="monty_+3A_n">N</code></td>
<td>
<p>How many games to play, defaults to 1000.</p>
</td></tr>
<tr><td><code id="monty_+3A_print_games">print_games</code></td>
<td>
<p>Logical; whether to print the results of each game.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects. If the supplied parameter 
<code>print_games</code> is TRUE, then it prints out the result
(Win or Loss) of each of the N simulated games. Finally it reports the 
overall percentage of winning.   
</p>
<p>####################################################
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example code
monty("stay")
monty("switch")
monty("random")
</code></pre>

<hr>
<h2 id='possum'>Body weight and length of possums (tree living furry animals who are mostly 
nocturnal (marsupial) caught in 7 different regions of Australia.</h2><span id='topic+possum'></span>

<h3>Description</h3>

<p>Body weight and length of possums (tree living furry animals who are mostly 
nocturnal (marsupial) caught in 7 different regions of Australia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>possum
</code></pre>


<h3>Format</h3>

<p>A data frame with 101 rows and 3 columns:
</p>

<dl>
<dt>Body_Weight</dt><dd><p>Body weight in kilogram</p>
</dd>
<dt>Length</dt><dd><p>Body length of the possum</p>
</dd>
<dt>Location</dt><dd><p>7 different regions of Australia: (1) Western  
Austrailia (W.A), (2) South Australia (S.A), (3) Northern Territory 
(N.T), (4) Queensland (QuL), (5) New South Wales (NSW),   
(6) Victoria (Vic) and (7) Tasmania (Tas). </p>
</dd>
</dl>



<h3>Source</h3>

<p>Lindenmayer and Donnelly (1995).
</p>


<h3>References</h3>

<p>Lindenmayer DBVKLCRB, Donnelly CF (1995).
&ldquo;Morphological variation among columns of the mountain brushtail possum, Trichosurus caninus Ogilby (Phalangeridae: Marsupiala).&rdquo;
<em>Australian Journal of Zoology</em>, <b>43</b>, 449-458.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(possum)
 dim(possum)
 summary(possum)
 ## Code lines used in the book
 ## Create a new data set   
 poss &lt;- possum 
 poss$region &lt;- factor(poss$Location)
 levels(poss$region) &lt;- c("W.A", "S.A", "N.T", "QuL", "NSW", "Vic", "Tas")
 colnames(poss)&lt;-c("y","z","Location", "x")
 head(poss)
 # Draw side by side boxplots 
 boxplot(y~x, data=poss, col=2:8, xlab="region", ylab="Weight")
 # Obtain scatter plot 
 # Start with a skeleton plot 
 plot(poss$z, poss$y, type="n", xlab="Length", ylab="Weight")
 # Add points for the seven regions
 for (i in 1:7) {
    points(poss$z[poss$Location==i],poss$y[poss$Location==i],type="p", pch=as.character(i), col=i)
    }
## Add legends 
 legend(x=76, y=4.2, legend=paste(as.character(1:7), levels(poss$x)),  lty=1:7, col=1:7)
 # Start  modelling 
 #Fit the model with interaction. 
 poss.lm1&lt;-lm(y~z+x+z:x,data=poss)
 summary(poss.lm1)
 plot(poss$z, poss$y,type="n", xlab="Length", ylab="Weight")
 for (i in 1:7) {
 lines(poss$z[poss$Location==i],poss.lm1$fit[poss$Location==i],type="l",
 lty=i, col=i, lwd=1.8)
 points(poss$z[poss$Location==i],poss$y[poss$Location==i],type="p",
 pch=as.character(i), col=i)
 }
 poss.lm0 &lt;- lm(y~z,data=poss)
 abline(poss.lm0, lwd=3, col=9)
 # Has drawn the seven parallel regression lines
 legend(x=76, y=4.2, legend=paste(as.character(1:7), levels(poss$x)), 
 lty=1:7, col=1:7)
 
 n &lt;- length(possum$Body_Weight)
 # Wrong model since Location is not a numeric covariate 
 wrong.lm &lt;- lm(Body_Weight~Location, data=possum)
 summary(wrong.lm)
 
 nis &lt;- table(possum$Location)
 meanwts &lt;- tapply(possum$Body_Weight, possum$Location, mean)
 varwts &lt;- tapply(possum$Body_Weight, possum$Location, var)
 datasums &lt;- data.frame(nis=nis, mean=meanwts, var=varwts)
 datasums &lt;- data.frame(nis=nis, mean=meanwts, var=varwts)
 modelss &lt;- sum(datasums[,2] * (meanwts - mean(meanwts))^2)
 residss &lt;- sum( (datasums[,2] - 1) * varwts)
 
 fvalue &lt;- (modelss/6) / (residss/94)
 fcritical &lt;- qf(0.95, df1= 6, df2=94)
 x &lt;- seq(from=0, to=12, length=200)
 y &lt;- df(x, df1=6, df2=94)
 plot(x, y, type="l", xlab="", ylab="Density of F(6, 94)", col=4)
 abline(v=fcritical, lty=3, col=3)
 abline(v=fvalue, lty=2, col=2)
 pvalue &lt;- 1-pf(fvalue, df1=6, df2=94)
 
 ### Doing the above in R
 # Convert  the Location column to a factor
 possum$Location &lt;- as.factor(possum$Location)
 summary(possum)  # Now Location is a factor 
  
 # Put the identifiability constraint:
 options(contrasts=c("contr.treatment", "contr.poly"))
 colnames(possum) &lt;- c("y", "z", "x")
 # Fit model M1
 possum.lm1 &lt;- lm(y~x, data=possum)
 summary(possum.lm1)
 anova(possum.lm1)
 possum.lm2 &lt;- lm(y~z, data=poss)
 summary(possum.lm2)
 anova(possum.lm2)
 # Include both location and length but no interaction 
 possum.lm3 &lt;-  lm(y~x+z, data=poss)
 summary(possum.lm3)
 anova(possum.lm3)
 # Include interaction effect 
 possum.lm4 &lt;-  lm(y~x+z+x:z, data=poss)
 summary(possum.lm4)
 anova(possum.lm4)
 anova(possum.lm2, possum.lm3)
 #Check the diagnostics for M3
 plot(possum.lm3$fit, possum.lm3$res,xlab="Fitted values",ylab="Residuals", 
 main="Anscombe plot")
 abline(h=0)
 qqnorm(possum.lm3$res,main="Normal probability plot")
 qqline(possum.lm3$res)
 
</code></pre>

<hr>
<h2 id='puffin'>Puffin nesting data set. It contains data regarding 
nesting habits of common puffin</h2><span id='topic+puffin'></span>

<h3>Description</h3>

<p>Puffin nesting data set. It contains data regarding 
nesting habits of common puffin
</p>


<h3>Usage</h3>

<pre><code class='language-R'>puffin
</code></pre>


<h3>Format</h3>

<p>A data frame with 38 rows and 5 columns:
</p>

<dl>
<dt>Nesting_Frequency</dt><dd><p>Number of nests</p>
</dd>
<dt>Grass_Cover</dt><dd><p>Percentage of area covered by grass</p>
</dd>
<dt>Mean_Soil_Depth</dt><dd><p>Mean soil depth in centimeter</p>
</dd>
<dt>Slope_Angle</dt><dd><p>Slope angle in degrees</p>
</dd>
<dt>Distance_from_Edge</dt><dd><p>Distance of the plot from the cliff edge in meter</p>
</dd>
</dl>



<h3>Source</h3>

<p>Nettleship (1972).
</p>


<h3>References</h3>

<p>Nettleship DN (1972).
&ldquo;Breeding Success of the Common Puffin (Fratercula arctica L.)  on Different Habitats at Great Island, Newfoundland.&rdquo;
<em>Ecological Monographs</em>, <b>42</b>, 239-268.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(puffin)
dim(puffin)
summary(puffin)
pairs(puffin)
puffin$sqrtfreq &lt;- sqrt(puffin$Nesting_Frequency)
puff.sqlm &lt;- lm(sqrtfreq~ Grass_Cover + Mean_Soil_Depth + Slope_Angle 
+Distance_from_Edge, data=puffin) 
old.par &lt;- par(no.readonly = TRUE)
par(mfrow=c(2,1))
qqnorm(puff.sqlm$res,main="Normal probability plot")
qqline(puff.sqlm$res)
plot(puff.sqlm$fit, puff.sqlm$res,xlab="Fitted values",ylab="Residuals", 
main="Anscombe plot")
abline(h=0)
summary(puff.sqlm)
par(old.par)
#####################################
# F test for two betas at the  same time: 
######################################
puff.sqlm2 &lt;- lm(sqrtfreq~ Mean_Soil_Depth + Distance_from_Edge, data=puffin) 
anova(puff.sqlm)
anova(puff.sqlm2)
fval &lt;-  1/2*(14.245-12.756)/0.387 # 1.924 
qf(0.95, 2, 33) # 3.28
1-pf(fval, 2, 33) # 0.162
anova(puff.sqlm2, puff.sqlm)
</code></pre>

<hr>
<h2 id='rice'>Riece yield data</h2><span id='topic+rice'></span>

<h3>Description</h3>

<p>Riece yield data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rice
</code></pre>


<h3>Format</h3>

<p>A data frame with three columns and 68 rows:
</p>

<dl>
<dt>Yield</dt><dd><p>Yield of rice in kilograms</p>
</dd>
<dt>Days</dt><dd><p>Number of days after flowering before harvesting</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bal and Ojha (1975).
</p>


<h3>Examples</h3>

<pre><code class='language-R'> summary(rice)
 plot(rice$Days, rice$Yield, pch="*", xlab="Days", ylab="Yield")
 rice$daymin31 &lt;- rice$Days-31
 rice.lm &lt;- lm(Yield ~ daymin31, data=rice)
 summary(rice.lm)
 # Check the diagnostics 
 plot(rice.lm$fit, rice.lm$res, xlab="Fitted values", ylab = "Residuals")
 abline(h=0)
 # Should be a random scatter
 # Needs a quadratic term
 
 qqnorm(rice.lm$res)
 qqline(rice.lm$res)
 rice.lm2 &lt;- lm(Yield ~ daymin31 + I(daymin31^2) , data=rice)
 old.par &lt;- par(no.readonly = TRUE)
 par(mfrow=c(1, 2))
 plot(rice.lm2$fit, rice.lm2$res, xlab="Fitted values", ylab = "Residuals")
 abline(h=0)
 # Should be a random scatter 
 # Much better plot!
 qqnorm(rice.lm2$res)
 qqline(rice.lm2$res)
 summary(rice.lm2)
 par(old.par) # par(mfrow=c(1,1))
 plot(rice$Days,  rice$Yield, xlab="Days", ylab="Yield")
 lines(rice$Days, rice.lm2$fit, lty=1, col=3)
 rice.lm3 &lt;- lm(Yield ~ daymin31 + I(daymin31^2)+I(daymin31^3) , data=rice)
 #check the diagnostics 
 summary(rice.lm3) # Will print the summary of the fitted model 
 #### Predict at a new value of Days=31.1465
 
 # Create a new data set called new
 new &lt;- data.frame(daymin31=32.1465-31)
 
 a &lt;- predict(rice.lm2, newdata=new, se.fit=TRUE) 
 # Confidence interval for the mean of rice yield  at day=31.1465
 a &lt;- predict(rice.lm2, newdata=new, interval="confidence") 
 a
 #          fit      lwr      upr
 # [1,] 3676.766 3511.904 3841.628
 # Prediction interval for a future yield at day=31.1465
 b &lt;- predict(rice.lm2, newdata=new, interval="prediction") 
 b
 # fit      lwr      upr
 #[1,] 3676.766 3206.461 4147.071
</code></pre>

<hr>
<h2 id='see_the_clt_for_Bernoulli'>Illustration of the CLT for samples from the Bernoulli distribution</h2><span id='topic+see_the_clt_for_Bernoulli'></span>

<h3>Description</h3>

<p>Illustration of the CLT for samples from the Bernoulli distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>see_the_clt_for_Bernoulli(nsize = 10, nrep = 10000, prob = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="see_the_clt_for_Bernoulli_+3A_nsize">nsize</code></td>
<td>
<p>Sample size, n. Its default value is 10.</p>
</td></tr>
<tr><td><code id="see_the_clt_for_Bernoulli_+3A_nrep">nrep</code></td>
<td>
<p>Number of replications. How many samples of size <code>nsize</code> 
should be taken, default value is 10000.</p>
</td></tr>
<tr><td><code id="see_the_clt_for_Bernoulli_+3A_prob">prob</code></td>
<td>
<p>True probability of success for the Bernoulli trials</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of means of the replicated samples.
It  also has the side effect of drawing a histogram of 
the standardized sample means and a superimposed density function 
of the standard normal distribution. The better the CLT approximation,
the closer are the superimposed density and the histogram.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- see_the_clt_for_Bernoulli()
old.par &lt;- par(no.readonly = TRUE)
par(mfrow=c(2, 3))
a30 &lt;- see_the_clt_for_Bernoulli(nsize=30)
a50 &lt;- see_the_clt_for_Bernoulli(nsize=50)
a100 &lt;- see_the_clt_for_Bernoulli(nsize=100)
a500 &lt;- see_the_clt_for_Bernoulli(nsize=500)
a1000 &lt;- see_the_clt_for_Bernoulli(nsize=1000)
a5000 &lt;- see_the_clt_for_Bernoulli(nsize=5000)
par(old.par)
</code></pre>

<hr>
<h2 id='see_the_clt_for_uniform'>Illustration of the central limit theorem for sampling from the 
uniform distribution</h2><span id='topic+see_the_clt_for_uniform'></span>

<h3>Description</h3>

<p>Illustration of the central limit theorem for sampling from the 
uniform distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>see_the_clt_for_uniform(nsize = 10, nrep = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="see_the_clt_for_uniform_+3A_nsize">nsize</code></td>
<td>
<p>Sample size, n. Its default value is 10.</p>
</td></tr>
<tr><td><code id="see_the_clt_for_uniform_+3A_nrep">nrep</code></td>
<td>
<p>Number of replications. How many samples of size <code>nsize</code> 
should be taken, default value is 10000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of means of the replicated samples.  The function also 
has the side effect of drawing a histogram of the sample means and 
two superimposed density functions: one estimated from the data using 
the <code>density</code> function and the other is the density of the CLT 
approximated normal distribution. The better the CLT approximation, the 
closer are the two superimposed densities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- see_the_clt_for_uniform()
old.par &lt;- par(no.readonly = TRUE) 
par(mfrow=c(2, 3))
a1 &lt;- see_the_clt_for_uniform(nsize=1)
a2 &lt;- see_the_clt_for_uniform(nsize=2)
a3 &lt;- see_the_clt_for_uniform(nsize=5)
a4 &lt;- see_the_clt_for_uniform(nsize=10)
a5 &lt;- see_the_clt_for_uniform(nsize=20)
a6 &lt;- see_the_clt_for_uniform(nsize=50)
par(old.par)
ybars &lt;- see_the_clt_for_uniform(nsize=12)
zbars &lt;- (ybars - mean(ybars))/sd(ybars)
k &lt;- 100
u &lt;- seq(from=min(zbars), to= max(zbars), length=k)
ecdf &lt;-  rep(NA, k)
for(i in 1:k) ecdf[i] &lt;- length(zbars[zbars&lt;u[i]])/length(zbars)
tcdf &lt;- pnorm(u)
plot(u, tcdf, type="l", col="red", lwd=4, xlab="", ylab="cdf")
lines(u, ecdf, lty=2, col="darkgreen", lwd=4)
symb &lt;- c("cdf of sample means", "cdf of N(0, 1)")
legend(x=-3.5, y=0.4, legend = symb, lty = c(2, 1), 
col = c("darkgreen","red"), bty="n")

</code></pre>

<hr>
<h2 id='see_the_wlln_for_uniform'>Illustration of the weak law of large numbers  for sampling from the 
uniform distribution</h2><span id='topic+see_the_wlln_for_uniform'></span>

<h3>Description</h3>

<p>Illustration of the weak law of large numbers  for sampling from the 
uniform distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>see_the_wlln_for_uniform(nsize = 10, nrep = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="see_the_wlln_for_uniform_+3A_nsize">nsize</code></td>
<td>
<p>Sample size, n. Its default value is 10.</p>
</td></tr>
<tr><td><code id="see_the_wlln_for_uniform_+3A_nrep">nrep</code></td>
<td>
<p>Number of replications. How many samples of size <code>nsize</code> 
should be taken, default value is 10000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list giving the x values and the density estimates y, from the 
generated random samples.  The function  also draws the empirical density on
the  current graphics device.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a1 &lt;- see_the_wlln_for_uniform(nsize=1, nrep=50000)
a2 &lt;- see_the_wlln_for_uniform(nsize=10, nrep=50000)
a3 &lt;- see_the_wlln_for_uniform(nsize=50, nrep=50000)
a4 &lt;- see_the_wlln_for_uniform(nsize=100, nrep=50000)
plot(a4, type="l", lwd=2, ylim=range(c(a1$y, a2$y, a3$y, a4$y)), col=1, 
lty=1, xlab="mean", ylab="density estimates")
lines(a3, type="l", lwd=2, col=2, lty=2)
lines(a2, type="l", lwd=2, col=3, lty=3)
lines(a1, type="l", lwd=2, col=4, lty=4)
symb &lt;- c("n=1", "n=10", "n=50", "n=100")
legend(x=0.37, y=11.5, legend = symb, lty =4:1, col = 4:1)
</code></pre>

<hr>
<h2 id='wgain'>Weight gain data from 68 first year students during their first 12 
weeks in college</h2><span id='topic+wgain'></span>

<h3>Description</h3>

<p>@format A data frame with three columns and 68 rows:
</p>

<dl>
<dt>student</dt><dd><p>Student number, 1 to 68.</p>
</dd>
<dt>initial</dt><dd><p>Initial weight in kilogram</p>
</dd>
<dt>final</dt><dd><p>Final weight in kilogram</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>wgain
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 68 rows and 3 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> summary(wgain)
 # 95% Confidence interval for mean weight gain 
 x &lt;- wgain$final - wgain$initial
 mean(x) + c(-1, 1) * qt(0.975, df=67) * sqrt(var(x)/68)
 # t-test to test the mean difference equals 0
 t.test(x)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
