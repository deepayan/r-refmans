<!DOCTYPE html><html><head><title>Help for package DBfit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DBfit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DBfit-package'>
<p>A Double Bootstrap Method for Analyzing Linear Models With Autoregressive Errors</p></a></li>
<li><a href='#boot1'>
<p>First Boostrap Procedure For parameter estimations</p></a></li>
<li><a href='#boot2'>
<p>First Boostrap Procedure For parameter estimations</p></a></li>
<li><a href='#dbfit'>
<p>The main function for the double bootstrap method</p></a></li>
<li><a href='#durbin1fit'>
<p>Durbin stage 1 fit</p></a></li>
<li><a href='#durbin1xy'>
<p>Creating New X and Y for Durbin Stage 1</p></a></li>
<li><a href='#durbin2fit'>
<p>Durbin stage 2 fit</p></a></li>
<li><a href='#fullr'>
<p>QR decomposition for non-full rank design matrix for Rfit.</p></a></li>
<li><a href='#hmdesign2'>
<p>the Two-Phase Design Matrix</p></a></li>
<li><a href='#hmmat'>
<p>K-Phase Design Matrix</p></a></li>
<li><a href='#hypothmat'>
<p>General Linear Tests of the regression coefficients</p></a></li>
<li><a href='#lagx'>
<p>Lag Functions</p></a></li>
<li><a href='#nurho'>
<p>Creating a new response variable for Durbin stage 2</p></a></li>
<li><a href='#print.dbfit'>
<p>DBfit Internal Print Functions</p></a></li>
<li><a href='#rhoci2'>
<p>A fisher type CI of the autoregressive parameter rho</p></a></li>
<li><a href='#simpgen1hm2'>
<p>Simulation Data Generating Function</p></a></li>
<li><a href='#simula'>
<p>Work Horse Function to implement the Double Bootstrap method</p></a></li>
<li><a href='#simulacorrection'>
<p>Work Horse Function to Implement the Double Bootstrap Method For .99 Cases</p></a></li>
<li><a href='#summary.dbfit'>
<p>Summarize the double bootstrap (DB) fit</p></a></li>
<li><a href='#testdata'>
<p>testdata</p></a></li>
<li><a href='#wrho'>
<p>Creating a new design matrix for Durbin stage 2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Double Bootstrap Method for Analyzing Linear Models with
Autoregressive Errors</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-04-30</td>
</tr>
<tr>
<td>Author:</td>
<td>Joseph W. McKean and Shaofeng Zhang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shaofeng Zhang &lt;shaofeng.zhang@wmich.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes the double bootstrap as discussed in McKnight, McKean, and Huitema (2000) &lt;<a href="https://doi.org/10.1037%2F1082-989X.5.1.87">doi:10.1037/1082-989X.5.1.87</a>&gt;. 
              The double bootstrap method provides a better fit for a linear model with autoregressive errors than ARIMA when the sample size is small.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>Rfit</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-30 20:11:09 UTC; zsf</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-30 20:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='DBfit-package'>
A Double Bootstrap Method for Analyzing Linear Models With Autoregressive Errors
</h2><span id='topic+DBfit-package'></span><span id='topic+DBfit'></span>

<h3>Description</h3>

<p>Computes the double bootstrap as discussed in McKnight, McKean, and Huitema (2000) &lt;doi:10.1037/1082-989X.5.1.87&gt;. 
              The double bootstrap method provides a better fit for a linear model with autoregressive errors than ARIMA when the sample size is small.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> DBfit</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> A Double Bootstrap Method for Analyzing Linear Models with
Autoregressive Errors</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-04-30</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Joseph W. McKean and Shaofeng Zhang</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Shaofeng Zhang &lt;shaofeng.zhang@wmich.edu&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Computes the double bootstrap as discussed in McKnight, McKean, and Huitema (2000) &lt;doi:10.1037/1082-989X.5.1.87&gt;. 
              The double bootstrap method provides a better fit for a linear model with autoregressive errors than ARIMA when the sample size is small.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> Rfit</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
DBfit-package           A Double Bootstrap Method for Analyzing Linear
                        Models With Autoregressive Errors
boot1                   First Boostrap Procedure For parameter
                        estimations
boot2                   First Boostrap Procedure For parameter
                        estimations
dbfit                   The main function for the double bootstrap
                        method
durbin1fit              Durbin stage 1 fit
durbin1xy               Creating New X and Y for Durbin Stage 1
durbin2fit              Durbin stage 2 fit
fullr                   QR decomposition for non-full rank design
                        matrix for Rfit.
hmdesign2               the Two-Phase Design Matrix
hmmat                   K-Phase Design Matrix
hypothmat               General Linear Tests of the regression
                        coefficients
lagx                    Lag Functions
nurho                   Creating a new response variable for Durbin
                        stage 2
print.dbfit             DBfit Internal Print Functions
rhoci2                  A fisher type CI of the autoregressive
                        parameter rho
simpgen1hm2             Simulation Data Generating Function
simula                  Work Horse Function to implement the Double
                        Bootstrap method
simulacorrection        Work Horse Function to Implement the Double
                        Bootstrap Method For .99 Cases
summary.dbfit           Summarize the double bootstrap (DB) fit
testdata                testdata
wrho                    Creating a new design matrix for Durbin stage 2
</pre>


<h3>Author(s)</h3>

<p>Joseph W. McKean and Shaofeng Zhang
</p>
<p>Maintainer: Shaofeng Zhang &lt;shaofeng.zhang@wmich.edu&gt;
</p>


<h3>References</h3>

<p>McKnight, S. D., McKean, J. W., and Huitema, B. E. (2000). A double bootstrap method
to analyze linear models with autoregressive error terms. Psychological methods,
5 (1), 87.
Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>

<hr>
<h2 id='boot1'>
First Boostrap Procedure For parameter estimations
</h2><span id='topic+boot1'></span>

<h3>Description</h3>

<p>Function performing the first bootstrap procedure to yield the parameter estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot1(y, phi1, arp, nbs, x, allb, method, scores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot1_+3A_y">y</code></td>
<td>

<p>the response variable
</p>
</td></tr>
<tr><td><code id="boot1_+3A_phi1">phi1</code></td>
<td>

<p>the Durbin two-stage estimate of the autoregressive parameter rho
</p>
</td></tr>
<tr><td><code id="boot1_+3A_arp">arp</code></td>
<td>

<p>the order of autoregressive errors
</p>
</td></tr>
<tr><td><code id="boot1_+3A_nbs">nbs</code></td>
<td>

<p>the bootstrap size
</p>
</td></tr>
<tr><td><code id="boot1_+3A_x">x</code></td>
<td>

<p>the original design matrix (including intercept), without centering
</p>
</td></tr>
<tr><td><code id="boot1_+3A_allb">allb</code></td>
<td>

<p>all the Durbin two-stage estimates of the regression coefficients 
</p>
</td></tr>
<tr><td><code id="boot1_+3A_method">method</code></td>
<td>

<p>If &quot;OLS&quot;, uses the ordinary least square; If &quot;RANK&quot;, uses the rank-based fit
</p>
</td></tr>
<tr><td><code id="boot1_+3A_scores">scores</code></td>
<td>

<p>Default is Wilcoxon scores
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An estimate of the bias is returned
</p>


<h3>Note</h3>

<p>This function is for internal use. The main function for users is <code>dbfit</code>.
</p>

<hr>
<h2 id='boot2'>
First Boostrap Procedure For parameter estimations
</h2><span id='topic+boot2'></span>

<h3>Description</h3>

<p>Function performing the second bootstrap procedure to yield the inference of the regression coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot2(y, xcopy, phi1, beta, nbs, method, scores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot2_+3A_y">y</code></td>
<td>

<p>the response variable
</p>
</td></tr>
<tr><td><code id="boot2_+3A_xcopy">xcopy</code></td>
<td>

<p>the original design matrix (including intercept), without centering
</p>
</td></tr>
<tr><td><code id="boot2_+3A_phi1">phi1</code></td>
<td>

<p>the estimate of the autoregressive parameter rho from the first bootstrap procedure
</p>
</td></tr>
<tr><td><code id="boot2_+3A_beta">beta</code></td>
<td>

<p>the estimates of the regression coefficients from the first bootstrap procedure
</p>
</td></tr>
<tr><td><code id="boot2_+3A_nbs">nbs</code></td>
<td>

<p>the bootstrap size
</p>
</td></tr>
<tr><td><code id="boot2_+3A_method">method</code></td>
<td>

<p>If &quot;OLS&quot;, uses the ordinary least square; If &quot;RANK&quot;, uses rank-based fit
</p>
</td></tr>
<tr><td><code id="boot2_+3A_scores">scores</code></td>
<td>

<p>Default is Wilcoxon scores
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>betacov</code></td>
<td>

<p>the estimate of var-cov matrix of betas
</p>
</td></tr>
<tr><td><code>allbeta</code></td>
<td>

<p>the estimates of betas inside of the second bootstrap, not the final estimates of betas. The final estimates of betas are still from <code>boot1</code>.
</p>
</td></tr>
<tr><td><code>rhostar</code></td>
<td>

<p>the estimates of rho inside of the second bootstrap, not the final estimates of rho. The final estimate(s) of rho are still from <code>boot1</code>.
</p>
</td></tr>
<tr><td><code>MSEstar</code></td>
<td>

<p>MSE used inside of the second bootstrap.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is for internal use. The main function for users is <code>dbfit</code>
</p>

<hr>
<h2 id='dbfit'>
The main function for the double bootstrap method
</h2><span id='topic+dbfit.default'></span><span id='topic+dbfit.formula'></span><span id='topic+dbfit'></span>

<h3>Description</h3>

<p>This function is used to implement the double bootstrap method. It is used to yield estimates of both regression coefficients and autoregressive parameters(rho), and also the inference of them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
dbfit(x, y, arp, nbs = 500, nbscov = 500, 
conf = 0.95, correction = TRUE, method = "OLS", scores, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbfit_+3A_x">x</code></td>
<td>

<p>the design matrix, including intercept, i.e. the first column being ones.
</p>
</td></tr>
<tr><td><code id="dbfit_+3A_y">y</code></td>
<td>

<p>the response variable.
</p>
</td></tr>
<tr><td><code id="dbfit_+3A_arp">arp</code></td>
<td>

<p>the order of autoregressive errors.
</p>
</td></tr>
<tr><td><code id="dbfit_+3A_nbs">nbs</code></td>
<td>

<p>the bootstrap size for the first bootstrap procedure. Default is 500.
</p>
</td></tr>
<tr><td><code id="dbfit_+3A_nbscov">nbscov</code></td>
<td>

<p>the bootstrap size for the second bootstrap procedure. Default is 500.
</p>
</td></tr>
<tr><td><code id="dbfit_+3A_conf">conf</code></td>
<td>

<p>the confidence level of CI for rho, default is 0.95.
</p>
</td></tr>
<tr><td><code id="dbfit_+3A_correction">correction</code></td>
<td>

<p>logical. Currently, ONLY works for order 1, i.e. for order &gt; 1, this correction will not get involved. If TRUE, uses the correction for cases that the estimate of rho is 0.99. Default is TRUE.
</p>
</td></tr>
<tr><td><code id="dbfit_+3A_method">method</code></td>
<td>

<p>the method to be used for fitting. If &quot;OLS&quot;, uses the ordinary least square <code>lm</code>; If &quot;RANK&quot;, uses the rank-based fit <code>rfit</code>.
</p>
</td></tr>
<tr><td><code id="dbfit_+3A_scores">scores</code></td>
<td>

<p>Default is Wilcoxon scores
</p>
</td></tr>
<tr><td><code id="dbfit_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to fitting routines
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the double bootstrap as discussed in McKnight, McKean, and Huitema (2000). For details, see the references.
</p>


<h3>Value</h3>

<table>
<tr><td><code>coefficients</code></td>
<td>

<p>the estimates of regression coefficients based on the first bootstrap procedure
</p>
</td></tr>
<tr><td><code>rho1</code></td>
<td>

<p>the Durbin two-stage estimate of the autoregressive parameter rho
</p>
</td></tr>
<tr><td><code>adjar</code></td>
<td>

<p>the estimates of regression coefficients based on the first bootstrap procedure
</p>
</td></tr>
<tr><td><code>mse</code></td>
<td>

<p>the mean square error
</p>
</td></tr>
<tr><td><code>rho_CI_1</code></td>
<td>

<p>the first type of CI for rho, see the second reference for details.
</p>
</td></tr>
<tr><td><code>rho_CI_2</code></td>
<td>

<p>the second type of CI for rho, see the second reference for details.
</p>
</td></tr>
<tr><td><code>rho_CI_3</code></td>
<td>

<p>the third type of CI for rho, see the second reference for details.
</p>
</td></tr>
<tr><td><code>betacov</code></td>
<td>

<p>the estimate of the variance-covariance matrix of betas
</p>
</td></tr>
<tr><td><code>tabbeta</code></td>
<td>

<p>a table of point estimates, SE's, test statistics and p-values.
</p>
</td></tr>
<tr><td><code>flag99</code></td>
<td>

<p>an indicator; if 1, it indicates the original fit yields an estimate of rho to be 0.99. When the correction is requested (default), the correction procedure kicks in, and the final estimates of rho is corrected. Only valid if order 1 is specified.
</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>

<p>the residuals, that is response minus fitted values.
</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>

<p>the fitted mean values.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joseph W. McKean and Shaofeng Zhang
</p>


<h3>References</h3>

<p>McKnight, S. D., McKean, J. W., and Huitema, B. E. (2000). A double bootstrap method
to analyze linear models with autoregressive error terms. Psychological methods,
5 (1), 87.
</p>
<p>Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>


<h3>See Also</h3>

<p>dbfit.formula
</p>


<h3>Examples</h3>

<pre><code class='language-R'># make sure the dependent package Rfit is installed
# To save users time, we set both bootstrap sizes to be 100 in this example. 
# Defaults are both 500. 

# data(testdata)
# This data is generated by a two-phase design, with autoregressive order being one, 
# autoregressive coefficient being 0.6 and all regression coefficients being 0. 
# Both the first and second phase have 20 observations.

# y &lt;- testdata[,5]
# x &lt;- testdata[,1:4]
# fit1 &lt;- dbfit(x,y,1, nbs = 100, nbscov = 100) # OLS fit, default
# summary(fit1) 
# Note that the CI's of autoregressive coef are not shown in the summary.
# Instead, they are attributes of model fit.
# fit1$rho_CI_1

# fit2 &lt;- dbfit(x,y,1, nbs = 100, nbscov = 100 ,method="RANK") # rank-based fit

# When fitting with autoregressive order 2, 
# the estimate of the second order autoregressive coefficient should not be significant,
# since this data is generated with order 1.

# fit3 &lt;- dbfit(x,y,2, nbs = 100, nbscov = 100)
# fit3$rho_CI_1 # The first row is lower bounds, and second row is upper bounds

</code></pre>

<hr>
<h2 id='durbin1fit'>
Durbin stage 1 fit
</h2><span id='topic+durbin1fit'></span>

<h3>Description</h3>

<p>Function implements the Durbin stage 1 fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>durbin1fit(y, x, arp, method, scores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="durbin1fit_+3A_y">y</code></td>
<td>

<p>the response variable in stage 1, not the original response variable
</p>
</td></tr>
<tr><td><code id="durbin1fit_+3A_x">x</code></td>
<td>

<p>the model matrix in stage 1, not the original design matrix
</p>
</td></tr>
<tr><td><code id="durbin1fit_+3A_arp">arp</code></td>
<td>

<p>the order of autoregressive errors.
</p>
</td></tr>
<tr><td><code id="durbin1fit_+3A_method">method</code></td>
<td>

<p>the method to be used for fitting. If &quot;OLS&quot;, uses the ordinary least square; If &quot;RANK&quot;, uses the rank-based fit.
</p>
</td></tr>
<tr><td><code id="durbin1fit_+3A_scores">scores</code></td>
<td>

<p>Default is Wilcoxon scores
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is for internal use. The main function for users is <code>dbfit</code>.
</p>


<h3>References</h3>

<p>McKnight, S. D., McKean, J. W., and Huitema, B. E. (2000). A double bootstrap method
to analyze linear models with autoregressive error terms. Psychological methods,
5 (1), 87.
Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>

<hr>
<h2 id='durbin1xy'>
Creating New X and Y for Durbin Stage 1
</h2><span id='topic+durbin1xy'></span>

<h3>Description</h3>

<p>Functions provides the tranformed reponse variable and model matrix for Durbin stage 1 fit. For details of the transformation, see the reference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>durbin1xy(y, x, arp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="durbin1xy_+3A_y">y</code></td>
<td>

<p>the orginal response variable
</p>
</td></tr>
<tr><td><code id="durbin1xy_+3A_x">x</code></td>
<td>

<p>the orginal design matrix with first column of all one's (corresponding to the intercept)
</p>
</td></tr>
<tr><td><code id="durbin1xy_+3A_arp">arp</code></td>
<td>

<p>the order of autoregressive errors.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>McKnight, S. D., McKean, J. W., and Huitema, B. E. (2000). A double bootstrap method
to analyze linear models with autoregressive error terms. Psychological methods,
5 (1), 87.
Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>

<hr>
<h2 id='durbin2fit'>
Durbin stage 2 fit
</h2><span id='topic+durbin2fit'></span>

<h3>Description</h3>

<p>Function implements the Durbin stage 1 fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>durbin2fit(yc, xc, adjphi, method, scores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="durbin2fit_+3A_yc">yc</code></td>
<td>

<p>a transformed reponse variable
</p>
</td></tr>
<tr><td><code id="durbin2fit_+3A_xc">xc</code></td>
<td>

<p>a transformed design matrix
</p>
</td></tr>
<tr><td><code id="durbin2fit_+3A_adjphi">adjphi</code></td>
<td>

<p>the Durbin stage 1 estimate(s) of the autoregressive parameters rho
</p>
</td></tr>
<tr><td><code id="durbin2fit_+3A_method">method</code></td>
<td>

<p>the method to be used for fitting. If &quot;OLS&quot;, uses the ordinary least square; If &quot;RANK&quot;, uses the rank-based fit.
</p>
</td></tr>
<tr><td><code id="durbin2fit_+3A_scores">scores</code></td>
<td>

<p>Default is Wilcoxon scores
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>the estimates of regression coefficients</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the estimate of standard deviation of the white noise</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is for internal use. The main function for users is <code>dbfit</code>.
</p>


<h3>References</h3>

<p>McKnight, S. D., McKean, J. W., and Huitema, B. E. (2000). A double bootstrap method
to analyze linear models with autoregressive error terms. Psychological methods,
5 (1), 87.
Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>

<hr>
<h2 id='fullr'>
QR decomposition for non-full rank design matrix for Rfit.
</h2><span id='topic+fullr'></span>

<h3>Description</h3>

<p>With Rfit recent update, it cannot return partial results with sigular design matrix (as opposed to lm). This function uses QR decomposition for Rfit to resolve this issue, so that dbfit can run robust version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fullr(x, p1)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fullr_+3A_x">x</code></td>
<td>

<p>design matrix, including intercept, i.e. the first column being ones.
</p>
</td></tr>
<tr><td><code id="fullr_+3A_p1">p1</code></td>
<td>

<p>number of first few columns of x that are lineraly independent.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is for internal use.
</p>

<hr>
<h2 id='hmdesign2'>
the Two-Phase Design Matrix
</h2><span id='topic+hmdesign2'></span>

<h3>Description</h3>

<p>Returns the design matrix for a two-phase intervention model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmdesign2(n1, n2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hmdesign2_+3A_n1">n1</code></td>
<td>

<p>number of obs in phase 1
</p>
</td></tr>
<tr><td><code id="hmdesign2_+3A_n2">n2</code></td>
<td>

<p>number of obs in phase 2
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It returns a matrix of 4 columns.
As discussed in Huitema, Mckean, &amp; Mcknight (1999), in
two-phase design: beta0 = intercept, beta1 = slope for Phase 1, beta2 = level change from Phase
1 to Phase 2, and beta3 slope change from Phase 1 to Phase 2.
</p>


<h3>References</h3>

<p>Huitema, B. E., Mckean, J. W., &amp; Mcknight, S. (1999). Autocorrelation effects on least-
squares intervention analysis of short time series. Educational and Psychological
Measurement, 59 (5), 767-786.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n1 &lt;- 15
n2 &lt;- 15
hmdesign2(n1, n2)
</code></pre>

<hr>
<h2 id='hmmat'>
K-Phase Design Matrix
</h2><span id='topic+hmmat'></span>

<h3>Description</h3>

<p>Returns the design matrix for a general k-phase intervention model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmmat(vecss, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hmmat_+3A_vecss">vecss</code></td>
<td>

<p>a vector of length k with each element being the number of observations in each phase
</p>
</td></tr>
<tr><td><code id="hmmat_+3A_k">k</code></td>
<td>

<p>number of phases
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It returns a matrix of 2*k columns. The design can be unbalanced, i.e. each phase has different observations.
</p>


<h3>References</h3>

<p>Huitema, B. E., Mckean, J. W., &amp; Mcknight, S. (1999). Autocorrelation effects on least-
squares intervention analysis of short time series. Educational and Psychological
Measurement, 59 (5), 767-786.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hmdesign2">hmdesign2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># a three-phase design matrix
hmmat(c(10,10,10),3)
</code></pre>

<hr>
<h2 id='hypothmat'>
General Linear Tests of the regression coefficients
</h2><span id='topic+hypothmat'></span>

<h3>Description</h3>

<p>Performs general linear tests of the regressio coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hypothmat(sfit, mmat, n, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hypothmat_+3A_sfit">sfit</code></td>
<td>

<p>the result of a call to dbfit.
</p>
</td></tr>
<tr><td><code id="hypothmat_+3A_mmat">mmat</code></td>
<td>

<p>a full row rank q*(p+1) matrix, where q is the row number of the matrix and p is number of independent variables.
</p>
</td></tr>
<tr><td><code id="hypothmat_+3A_n">n</code></td>
<td>

<p>total number of observations.
</p>
</td></tr>
<tr><td><code id="hypothmat_+3A_p">p</code></td>
<td>

<p>number of independent variables.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions performs the general linear F-test of the form H0: Mb = 0 vs HA: Mb != 0.
</p>


<h3>Value</h3>

<table>
<tr><td><code>tst</code></td>
<td>
<p>the test statistic</p>
</td></tr>
<tr><td><code>pvf</code></td>
<td>
<p>the p-value of the F-test</p>
</td></tr>
</table>


<h3>References</h3>

<p>McKnight, S. D., McKean, J. W., and Huitema, B. E. (2000). A double bootstrap method
to analyze linear models with autoregressive error terms. Psychological methods,
5 (1), 87.
Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data(testdata)
# y&lt;-testdata[,5]
# x&lt;-testdata[,1:4]
# fit1&lt;-dbfit(x,y,1) # OLS fit, default
# a test that H0: b1 = b3 vs HA: b1 != b3
# mat&lt;-matrix(c(1,0,0,-1),nrow=1) 
# hypothmat(sfit=fit1,mmat=mat,n=40,p=4)
</code></pre>

<hr>
<h2 id='lagx'>
Lag Functions
</h2><span id='topic+lagx'></span><span id='topic+lagmat'></span>

<h3>Description</h3>

<p>For preparing the transformed x and y in the Durbin stage 1 fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lagx(x, s1, s2)
lagmat(x, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lagx_+3A_x">x</code></td>
<td>

<p>a vector or the design matrix, including intercept, i.e. the first column being ones.
</p>
</td></tr>
<tr><td><code id="lagx_+3A_s1">s1</code></td>
<td>

<p>starting index of the slice.
</p>
</td></tr>
<tr><td><code id="lagx_+3A_s2">s2</code></td>
<td>

<p>end index of the slice.
</p>
</td></tr>
<tr><td><code id="lagx_+3A_p">p</code></td>
<td>

<p>the order of autoregressive errors.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>These function are for internal use.
</p>

<hr>
<h2 id='nurho'>
Creating a new response variable for Durbin stage 2
</h2><span id='topic+nurho'></span>

<h3>Description</h3>

<p>It returns a new response variable (vector) for Durbin stage 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nurho(yc, adjphi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nurho_+3A_yc">yc</code></td>
<td>

<p>the centered response variable y
</p>
</td></tr>
<tr><td><code id="nurho_+3A_adjphi">adjphi</code></td>
<td>

<p>(initial) estimate of rho in Durbin stage 1
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>see reference.
</p>


<h3>Note</h3>

<p>This function is for internal use. The main function for users is <code>dbfit</code>.
</p>


<h3>References</h3>

<p>McKnight, S. D., McKean, J. W., and Huitema, B. E. (2000). A double bootstrap method
to analyze linear models with autoregressive error terms. Psychological methods,
5 (1), 87.
Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>

<hr>
<h2 id='print.dbfit'>
DBfit Internal Print Functions
</h2><span id='topic+print.dbfit'></span><span id='topic+print.summary.dbfit'></span>

<h3>Description</h3>

<p>These functions print the output in a user-friendly manner using the internal R function <code>print</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dbfit'
print(x, ...)
## S3 method for class 'summary.dbfit'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.dbfit_+3A_x">x</code></td>
<td>

<p>An object to be printed
</p>
</td></tr>
<tr><td><code id="print.dbfit_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to <code>print</code>
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+dbfit">dbfit</a></code>, <code><a href="#topic+summary.dbfit">summary.dbfit</a></code>
</p>

<hr>
<h2 id='rhoci2'>
A fisher type CI of the autoregressive parameter rho
</h2><span id='topic+rhoci2'></span>

<h3>Description</h3>

<p>This function returns a Fisher type CI for rho, which is then used to correct the .99 cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rhoci2(n, rho, cv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rhoci2_+3A_n">n</code></td>
<td>

<p>total number of observations
</p>
</td></tr>
<tr><td><code id="rhoci2_+3A_rho">rho</code></td>
<td>

<p>final estimate of rho, usually .99.
</p>
</td></tr>
<tr><td><code id="rhoci2_+3A_cv">cv</code></td>
<td>

<p>critical value for CI
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>see reference.
</p>


<h3>Note</h3>

<p>This function is for internal use.
</p>


<h3>References</h3>

<p>Shaofeng Zhang (2017). Ph.D. Dissertation.
Rao, C. R. (1952). Advanced statistical methods in biometric research. p. 231
</p>

<hr>
<h2 id='simpgen1hm2'>
Simulation Data Generating Function
</h2><span id='topic+simpgen1hm2'></span>

<h3>Description</h3>

<p>Generates the simulation data for a two-phase intervention model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simpgen1hm2(n1, n2, rho, beta = c(0, 0, 0, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simpgen1hm2_+3A_n1">n1</code></td>
<td>

<p>number of obs in phase 1
</p>
</td></tr>
<tr><td><code id="simpgen1hm2_+3A_n2">n2</code></td>
<td>

<p>number of obs in phase 2
</p>
</td></tr>
<tr><td><code id="simpgen1hm2_+3A_rho">rho</code></td>
<td>

<p>pre-defined autoregressive parameter(s)
</p>
</td></tr>
<tr><td><code id="simpgen1hm2_+3A_beta">beta</code></td>
<td>

<p>pre-defined regression coefficients
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used for simulations when developing the package. With pre-defined sample sizes in both phases and parameters, it returns a simulated data.
</p>


<h3>Value</h3>

<table>
<tr><td><code>mat</code></td>
<td>
<p>a matrix containing the simulation data. The last column is the response variable. All other columns make up the design matrix.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+hmdesign2">hmdesign2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> n1 &lt;- 15
 n2 &lt;- 15
 rho &lt;- 0.6
 beta &lt;- c(0,0,0,0)
 dat &lt;- simpgen1hm2(n1, n2, rho, beta)
 dat
</code></pre>

<hr>
<h2 id='simula'>
Work Horse Function to implement the Double Bootstrap method
</h2><span id='topic+simula'></span>

<h3>Description</h3>

<p><code>simula</code> is the original work horse function to implement the DB method. However, when this function returns an estimate of rho to be .99, another work horse function <code>simulacorrection</code> kicks in.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simula(x, y, arp, nbs, nbscov, conf, method, scores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simula_+3A_x">x</code></td>
<td>

<p>the design matrix, including intercept, i.e. the first column being ones.
</p>
</td></tr>
<tr><td><code id="simula_+3A_y">y</code></td>
<td>

<p>the response variable.
</p>
</td></tr>
<tr><td><code id="simula_+3A_arp">arp</code></td>
<td>

<p>the order of autoregressive errors.
</p>
</td></tr>
<tr><td><code id="simula_+3A_nbs">nbs</code></td>
<td>

<p>the bootstrap size for the first bootstrap procedure. Default is 500.
</p>
</td></tr>
<tr><td><code id="simula_+3A_nbscov">nbscov</code></td>
<td>

<p>the bootstrap size for the second bootstrap procedure. Default is 500.
</p>
</td></tr>
<tr><td><code id="simula_+3A_conf">conf</code></td>
<td>

<p>the confidence level of CI for rho, default is 0.95. 
</p>
</td></tr>
<tr><td><code id="simula_+3A_method">method</code></td>
<td>

<p>the method to be used for fitting. If &quot;OLS&quot;, uses the ordinary least square <code>lm</code>; If &quot;RANK&quot;, uses the rank-based fit <code>rfit</code>.
</p>
</td></tr>
<tr><td><code id="simula_+3A_scores">scores</code></td>
<td>

<p>Default is Wilcoxon scores
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>see <code><a href="#topic+dbfit">dbfit</a></code>.
</p>


<h3>Note</h3>

<p>Users should use <code>dbfit</code> to perform the analysis.
</p>


<h3>References</h3>

<p>McKnight, S. D., McKean, J. W., and Huitema, B. E. (2000). A double bootstrap method
to analyze linear models with autoregressive error terms. Psychological methods,
5 (1), 87.
Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dbfit">dbfit</a></code>.
</p>

<hr>
<h2 id='simulacorrection'>
Work Horse Function to Implement the Double Bootstrap Method For .99 Cases 
</h2><span id='topic+simulacorrection'></span>

<h3>Description</h3>

<p>When function <code>simula</code> returns an estimate of rho to be .99, this function kicks in and ouputs a corrected estimate of rho. Currently, this only works for order 1, i.e. for order &gt; 1, this correction will not get involved.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulacorrection(x, y, arp, nbs, nbscov, method, scores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulacorrection_+3A_x">x</code></td>
<td>

<p>the design matrix, including intercept, i.e. the first column being ones.
</p>
</td></tr>
<tr><td><code id="simulacorrection_+3A_y">y</code></td>
<td>

<p>the response variable.
</p>
</td></tr>
<tr><td><code id="simulacorrection_+3A_arp">arp</code></td>
<td>

<p>the order of autoregressive errors.
</p>
</td></tr>
<tr><td><code id="simulacorrection_+3A_nbs">nbs</code></td>
<td>

<p>the bootstrap size for the first bootstrap procedure. Default is 500.
</p>
</td></tr>
<tr><td><code id="simulacorrection_+3A_nbscov">nbscov</code></td>
<td>

<p>the bootstrap size for the second bootstrap procedure. Default is 500.
</p>
</td></tr>
<tr><td><code id="simulacorrection_+3A_method">method</code></td>
<td>

<p>the method to be used for fitting. If &quot;OLS&quot;, uses the ordinary least square <code>lm</code>; If &quot;RANK&quot;, uses the rank-based fit <code>rfit</code>.
</p>
</td></tr>
<tr><td><code id="simulacorrection_+3A_scores">scores</code></td>
<td>

<p>Default is Wilcoxon scores
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If 0.99 problem is detected, then construct Fisher
CI for both initial estimate (in Durbin stage 1) and first bias-corrected estimate (perform only one bootstrap, instead of a loop); if the midpoint of latter is smaller than 0.95, then this midpoint is the final
estimate for rho; otherwise the midpoint of the former CI is the final estimate.
</p>
<p>By default, when function <code>simula</code> returns an estimate of rho to be .99, this function kicks in and ouputs a corrected estimate of rho. However, users can turn the auto correction off by setting correction=&quot;FALSE&quot; in <code>dbfit</code>. Users are encouraged to investigate why the stationarity assumption is violated based on their experience of time series analysis and knowledge of the data.
</p>


<h3>Note</h3>

<p>Users should use <code>dbfit</code> to perform the analysis.
</p>


<h3>References</h3>

<p>Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dbfit">dbfit</a></code>.
</p>

<hr>
<h2 id='summary.dbfit'>
Summarize the double bootstrap (DB) fit
</h2><span id='topic+summary.dbfit'></span>

<h3>Description</h3>

<p>It summarizes the DB fit in a way that is similar to OLS <code>lm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dbfit'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.dbfit_+3A_object">object</code></td>
<td>

<p>a result of the call to <code>rfit</code>
</p>
</td></tr>
<tr><td><code id="summary.dbfit_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>call</code></td>
<td>
<p>the call to <code>rfit</code></p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>a table of point estimates, standard errors, t-ratios and p-values</p>
</td></tr>
<tr><td><code>rho1</code></td>
<td>
<p>the Durbin two-stage estimate of rho</p>
</td></tr>
<tr><td><code>adjar</code></td>
<td>
<p>the DB (final) estimate of rho</p>
</td></tr>
<tr><td><code>flag99</code></td>
<td>
<p>an indicator; if 1, it indicates the original fit yields an estimate of rho to be 0.99. Only valid if order 1 is specified.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># data(testdata)
# y&lt;-testdata[,5]
# x&lt;-testdata[,1:4]
# fit1&lt;-dbfit(x,y,1) # OLS fit, default
# summary(fit1)
</code></pre>

<hr>
<h2 id='testdata'>
testdata
</h2><span id='topic+testdata'></span>

<h3>Description</h3>

<p>This data serves as a test data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("testdata")</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations. First 4 columns make up the design matrix, while the last column is the response variable. This data is generated by a two-phase design, with autoregressive order being one, autoregressive coefficient being 0.6 and all regression coefficients being 0. Both the first and second phase have 20 observations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(testdata)
</code></pre>

<hr>
<h2 id='wrho'>
Creating a new design matrix for Durbin stage 2
</h2><span id='topic+wrho'></span>

<h3>Description</h3>

<p>It returns a new design matrix for Durbin stage 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrho(xc, adjphi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrho_+3A_xc">xc</code></td>
<td>

<p>centered design matrix, no column of ones
</p>
</td></tr>
<tr><td><code id="wrho_+3A_adjphi">adjphi</code></td>
<td>

<p>(initial) estimate of rho in Durbin stage 1
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>see reference.
</p>


<h3>Note</h3>

<p>This function is for internal use. The main function for users is <code>dbfit</code>.
</p>


<h3>References</h3>

<p>McKnight, S. D., McKean, J. W., and Huitema, B. E. (2000). A double bootstrap method
to analyze linear models with autoregressive error terms. Psychological methods,
5 (1), 87.
Shaofeng Zhang (2017). Ph.D. Dissertation.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
