<!DOCTYPE html><html><head><title>Help for package mnlfa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mnlfa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mnlfa-package'>
<p>Moderated Nonlinear Factor Analysis</p></a></li>
<li><a href='#data.mnlfa01'>
<p>Example Datasets for <span class="pkg">mnlfa</span> Package</p></a></li>
<li><a href='#mnlfa'>
<p>Moderated Nonlinear Factor Analysis</p></a></li>
<li><a href='#mnlfa_expand_to_list'>
<p>Expands Input Into a List</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Moderated Nonlinear Factor Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-11 22:06:20</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexander Robitzsch [aut,cre] (&lt;https://orcid.org/0000-0002-8226-3132&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexander Robitzsch &lt;robitzsch@ipn.uni-kiel.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Conducts moderated nonlinear factor analysis (e.g., Curran et al., 2014,
    &lt;<a href="https://doi.org/10.1080%2F00273171.2014.889594">doi:10.1080/00273171.2014.889594</a>&gt;). 
    Regularization methods are implemented for assessing non-invariant items. 
    Currently, the package includes dichotomous items and unidimensional
    item response models. Extensions will be included in future package
    versions.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>CDM (&ge; 7.0-4), stats, utils</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Enhances:</td>
<td>aMNLFA, GPCMlasso, sirt</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/alexanderrobitzsch/mnlfa">https://github.com/alexanderrobitzsch/mnlfa</a>,
<a href="https://sites.google.com/view/alexander-robitzsch/software">https://sites.google.com/view/alexander-robitzsch/software</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-11 21:07:54 UTC; sunpn563</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-11 21:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mnlfa-package'>
Moderated Nonlinear Factor Analysis
</h2><span id='topic+mnlfa-package'></span>

<h3>Description</h3>


<p>    Conducts moderated nonlinear factor analysis (e.g., Curran et al., 2014,
    &lt;doi:10.1080/00273171.2014.889594&gt;). 
    Regularization methods are implemented for assessing non-invariant items. 
    Currently, the package includes dichotomous items and unidimensional
    item response models. Extensions will be included in future package
    versions.
</p>


<h3>Author(s)</h3>

<p>Alexander Robitzsch [aut,cre] (&lt;https://orcid.org/0000-0002-8226-3132&gt;)
</p>
<p>Maintainer: Alexander Robitzsch &lt;robitzsch@ipn.uni-kiel.de&gt;
</p>


<h3>References</h3>

<p>Curran, P. J., McGinley, J. S., Bauer, D. J., Hussong, A. M., Burns, A.,
Chassin, L., Sher, K., &amp; Zucker, R. (2014).
A moderated nonlinear factor model for the development of commensurate measures
in integrative data analysis. <em>Multivariate Behavioral Research, 49</em>(3),
214-231.
http://dx.doi.org/10.1080/00273171.2014.889594
</p>

<hr>
<h2 id='data.mnlfa01'>
Example Datasets for <span class="pkg">mnlfa</span> Package
</h2><span id='topic+data.mnlfa01'></span>

<h3>Description</h3>

<p>Example datasets for <span class="pkg">mnlfa</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data.mnlfa01)
</code></pre>


<h3>Format</h3>


<ul>
<li>  <p><code>data.mnlfa01</code>
</p>
<p>A data frame with 1000 observations for 12 items and 2 covariates.
</p>
<p><code>'data.frame':   1000 obs. of  14 variables:</code> <br />
<code> $ female: num  0.5 -0.5 0.5 -0.5 0.5 -0.5 0.5 -0.5 0.5 -0.5 ...</code> <br />
<code> $ age   : num  0.79 0.36 0.22 0.79 0.22 -0.34 -0.76 -0.06 0.22 0.65 ...</code> <br />
<code> $ I1    : int  1 1 1 1 1 1 1 0 1 1 ...</code> <br />
<code> $ I2    : int  0 0 1 1 1 0 1 1 1 1 ...</code> <br />
<code> $ I3    : int  1 0 1 0 0 1 0 1 1 1 ...</code> <br />
<code> $ I4    : int  1 0 0 1 1 0 1 1 0 1 ...</code> <br />
<code> $ I5    : int  1 0 0 0 0 1 1 0 0 1 ...</code> <br />
<code> $ I6    : int  1 0 1 1 1 0 1 0 0 1 ...</code> <br />
<code> $ I7    : int  1 0 1 1 0 1 1 1 1 1 ...</code> <br />
<code> $ I8    : int  0 0 1 0 1 0 1 1 1 1 ...</code> <br />
<code> $ I9    : int  1 0 0 1 1 0 0 0 1 0 ...</code> <br />
<code> $ I10   : int  0 0 0 0 0 0 0 0 0 1 ...</code> <br />
<code> $ I11   : int  0 0 1 0 0 0 0 0 0 1 ...</code> <br />
<code> $ I12   : int  0 0 0 0 0 1 1 0 1 0 ...</code> <br />
</p>
</li></ul>


<hr>
<h2 id='mnlfa'>
Moderated Nonlinear Factor Analysis
</h2><span id='topic+mnlfa'></span><span id='topic+summary.mnlfa'></span>

<h3>Description</h3>

<p>General function for conducting moderated nonlinear factor analysis
(Curran et al., 2014). Item slopes and item intercepts can be modeled as functions
of person covariates.
</p>
<p>Parameter regularization is allowed. For categorical covariates,
group lasso can be used for regularization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnlfa(dat, items, item_type="2PL", formula_int=~1, formula_slo=~1, formula_mean=~0,
   formula_sd=~0, theta=NULL, parm_list_init=NULL, parm_trait_init=NULL, prior_init=NULL,
   regular_lam=c(0, 0), regular_type=c("none", "none"), maxit=1000, msteps=4, conv=1e-05,
   conv_mstep=1e-04, h=1e-04, parms_regular_types=NULL, parms_regular_lam=NULL,
   parms_iterations=NULL, center_parms=NULL, center_max_iter=6, L_max=.07,
   verbose=TRUE)

## S3 method for class 'mnlfa'
summary(object, file=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnlfa_+3A_dat">dat</code></td>
<td>

<p>Data frame with item responses
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_items">items</code></td>
<td>

<p>Vector containing item names
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_item_type">item_type</code></td>
<td>

<p>String or vector of item types. Currently, only item types <code>"1PL"</code> or
<code>"2PL"</code> can be chosen.
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_formula_int">formula_int</code></td>
<td>

<p>String or list with formula for item intercepts
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_formula_slo">formula_slo</code></td>
<td>

<p>String or list with formula for item slopes
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_formula_mean">formula_mean</code></td>
<td>

<p>Formula for mean of the trait distribution
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_formula_sd">formula_sd</code></td>
<td>

<p>Formula for standard deviation of the trait distribution
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_theta">theta</code></td>
<td>

<p>Grid of <code class="reqn">\theta</code> values used for approximation of normally
distributed trait
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_parm_list_init">parm_list_init</code></td>
<td>

<p>Optional list of initial item parameters
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_parm_trait_init">parm_trait_init</code></td>
<td>
<p>Optional list of initial parameters for trait distribution</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_prior_init">prior_init</code></td>
<td>
<p>Optional matrix of prior distribution for persons</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_regular_lam">regular_lam</code></td>
<td>

<p>Vector of length two containing two general regularization
parameters for item intercepts and item slopes
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_regular_type">regular_type</code></td>
<td>

<p>Type of regularization method. Can be <code>"none"</code>,
<code>"lasso"</code>, <code>"scad"</code> or <code>"mcp"</code>.
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_maxit">maxit</code></td>
<td>

<p>Maximum number of iterations
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_msteps">msteps</code></td>
<td>

<p>Maximum number of M-steps
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_conv">conv</code></td>
<td>

<p>Convergence criterion with respect to parameters
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_conv_mstep">conv_mstep</code></td>
<td>

<p>Convergence criterion in M-step
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_h">h</code></td>
<td>

<p>Numerical differentiation parameter
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_parms_regular_types">parms_regular_types</code></td>
<td>

<p>Optional list containing parameter specific regularization types
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_parms_regular_lam">parms_regular_lam</code></td>
<td>

<p>Optional list containing parameter specific regularization parameters
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_parms_iterations">parms_iterations</code></td>
<td>

<p>Optional list containing sequence of parameter indices used for updating
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_center_parms">center_parms</code></td>
<td>
<p>Optional list indicating which parameters
should be centered during initial iterations.</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_center_max_iter">center_max_iter</code></td>
<td>
<p>Maximum number of iterations in which parameters
should be centered.</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_l_max">L_max</code></td>
<td>
<p>Majorization parameter used in regularization</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_verbose">verbose</code></td>
<td>

<p>Logical indicating whether output should be printed
</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_object">object</code></td>
<td>
<p>Object of class <code>mnlfa</code></p>
</td></tr>
<tr><td><code id="mnlfa_+3A_file">file</code></td>
<td>
<p>Optional file name</p>
</td></tr>
<tr><td><code id="mnlfa_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The moderated factor analysis model for dichotomous responses defined as
</p>
<p style="text-align: center;"><code class="reqn">P(X_{pi}=1 | \theta_p )=invlogit( a_{pi} \theta_p - b_{pi} ) </code>
</p>

<p>The trait distribution <code class="reqn">\theta_p \sim N( \mu_p, \sigma_p^2)</code>
allows a latent regression of person covariates on the mean
with <code class="reqn">\mu_p=\bold{X}_p \bold{\gamma}</code> (to be specified in <code>formula_mean</code>)
and the logarithm of the standard deviation <code class="reqn">\log \sigma_p=\bold{Z}_p \bold{\delta} </code>
(to be specified in <code>formula_sd</code>).
Item intercepts and item slopes can be moderated by person covariates, i.e.
<code class="reqn">a_{pi}=\bold{W}_{pi} \bold{\alpha}_i </code> and
<code class="reqn">b_{pi}=\bold{V}_{pi} \bold{\beta}_i </code>. Regularization on (some of) the
<code class="reqn">\bold{\alpha}_i</code> or <code class="reqn">\bold{\beta}_i</code> parameters is allowed.
</p>
<p>The model is estimated using an EM algorithm with the coordinate descent
method during the M-step (Sun et al., 2016).
</p>


<h3>Value</h3>

<p>List with model results including
</p>
<table>
<tr><td><code>item</code></td>
<td>
<p>Summary table for item parameters</p>
</td></tr>
<tr><td><code>trait</code></td>
<td>
<p>Summary table for trait parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Curran, P. J., McGinley, J. S., Bauer, D. J., Hussong, A. M., Burns, A.,
Chassin, L., Sher, K., &amp; Zucker, R. (2014).
A moderated nonlinear factor model for the development of commensurate measures
in integrative data analysis. <em>Multivariate Behavioral Research, 49</em>(3),
214-231.
http://dx.doi.org/10.1080/00273171.2014.889594
</p>
<p>Sun, J., Chen, Y., Liu, J., Ying, Z., &amp; Xin, T. (2016). Latent variable selection for
multidimensional item response theory models via L1 regularization.
<em>Psychometrika, 81</em>(4), 921-939.
https://doi.org/10.1007/s11336-016-9529-6
</p>


<h3>See Also</h3>

<p>See also the <span class="pkg">aMNLFA</span> package for automatized moderated nonlinear factor analysis
which provides convenient wrapper functions for automized analysis
in the <em>Mplus</em> software.
</p>
<p>See the <span class="pkg">GPCMlasso</span> package for the regularized generalized partial credit model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Dichotomous data, 1PL model
#############################################################################

data(data.mnlfa01, package="mnlfa")

dat &lt;- data.mnlfa01
# extract items from dataset
items &lt;- grep("I[0-9]", colnames(dat), value=TRUE)
I &lt;- length(items)

# maximum number of iterations (use only few iterations for the only purpose of
# providing CRAN checks)
maxit &lt;- 10

#***** Model 1: 1PL model without moderating parameters and without covariates for traits

# no covariates for trait
formula_mean &lt;- ~0
formula_sd &lt;- ~1
# no item covariates
formula_int &lt;- ~1
formula_slo &lt;- ~1

mod1 &lt;- mnlfa::mnlfa( dat=dat, items, item_type="1PL", formula_int=formula_int,
             formula_slo=formula_slo, formula_mean=formula_mean, formula_sd=formula_sd,
             maxit=maxit )
summary(mod1)


#***** Model 2: 1PL model without moderating parameters and with covariates for traits

# covariates for trait
formula_mean &lt;- ~female + age
formula_sd &lt;- ~1

mod2 &lt;- mnlfa::mnlfa( dat=dat, items, item_type="1PL", formula_int=formula_int,
             formula_slo=formula_slo, formula_mean=formula_mean, formula_sd=formula_sd)
summary(mod2)

#***** Model 3: 1PL model with moderating parameters and with covariates for traits
#***   Regularization method 'mcp'

# covariates for trait
formula_mean &lt;- ~female + age
formula_sd &lt;- ~1
# moderation effects for items
formula_int &lt;- ~1+female+age
formula_slo &lt;- ~1

# center parameters for female and age in initial iterations for improving convergence
center_parms &lt;- list( rep(2,I), rep(3,I) )

# regularization parameters for item intercept and item slope, respectively
regular_lam &lt;- c(.06, .25)
regular_type &lt;- c("mcp","none")

mod3 &lt;- mnlfa::mnlfa( dat=dat, items, item_type="1PL", formula_int=formula_int,
            formula_slo=formula_slo, formula_mean=formula_mean, formula_sd=formula_sd,
            center_parms=center_parms, regular_lam=regular_lam, regular_type=regular_type )
summary(mod3)


#***** Model 4: 1PL model with selected moderated item parameters

#* trait distribution
formula_mean &lt;- ~0+female+age
formula_sd &lt;- ~1

#* formulas for item intercepts
formula_int &lt;- ~1
formula_int &lt;- mnlfa::mnlfa_expand_to_list(x=formula_int, names_list=items)
mod_items &lt;- c(4,5,6,7)
for (ii in mod_items){
    formula_int[[ii]] &lt;- ~1+female+age
}
formula_slo &lt;- ~1

mod4 &lt;- mnlfa::mnlfa( dat=dat, items, item_type="1PL", formula_int=formula_int,
              formula_slo=formula_slo, formula_mean=formula_mean, formula_sd=formula_sd)
mod4$item
mod4$trait
summary(mod4)

</code></pre>

<hr>
<h2 id='mnlfa_expand_to_list'>
Expands Input Into a List
</h2><span id='topic+mnlfa_expand_to_list'></span>

<h3>Description</h3>

<p>Expands an input into a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnlfa_expand_to_list(x, names_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnlfa_expand_to_list_+3A_x">x</code></td>
<td>

<p>An R object
</p>
</td></tr>
<tr><td><code id="mnlfa_expand_to_list_+3A_names_list">names_list</code></td>
<td>

<p>Names of the list
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Test example
#############################################################################

formula_int &lt;- ~1+female+age
items &lt;- paste0("I",1:12)
formula_int &lt;- mnlfa::mnlfa_expand_to_list(x=formula_int, names_list=items)
formula_int[[1]] &lt;- ~0
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
