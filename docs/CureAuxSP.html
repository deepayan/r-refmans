<!DOCTYPE html><html lang="en"><head><title>Help for package CureAuxSP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CureAuxSP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CureAuxSP'><p>CureAuxSP: Mixture Cure Models with Auxiliary Subgroup Survival Probabilities.</p></a></li>
<li><a href='#Print.SMC.AuxSP'><p>Print SMC.AuxSP object returned by our main function SMC.AuxSP()</p></a></li>
<li><a href='#Probs.Sub'><p>Calculate subgroup survival probabilities</p></a></li>
<li><a href='#sdata.SMC'><p>Generate simulated dataset from a well-designed PH mixture cure model</p></a></li>
<li><a href='#SMC.AuxSP'><p>Semi-parametric mixture cure model with auxiliary subgroup survival information</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Mixture Cure Models with Auxiliary Subgroup Survival
Probabilities</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Jie Ding <a href="https://orcid.org/0000-0002-6083-7529"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Jialiang Li <a href="https://orcid.org/0000-0002-9704-4135"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Mengxiu Zhang <a href="https://orcid.org/0009-0001-3773-3019"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Xiaoguang Wang <a href="https://orcid.org/0000-0002-5598-062X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jie Ding &lt;dingjie@mail.dlut.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate mixture cure models with subgroup survival probabilities as auxiliary information. A reference of the underlying methods is Jie Ding, Jialiang Li and Xiaoguang Wang (2024) &lt;<a href="https://doi.org/10.1093%2Fjrsssc%2Fqlad106">doi:10.1093/jrsssc/qlad106</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, survival, lars, mvtnorm, methods, TCGAbiolinks</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td>&lt;<a href="https://github.com/biostat-jieding/CureAuxSP&amp;gt;">https://github.com/biostat-jieding/CureAuxSP&gt;</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-27 21:04:54 UTC; biost</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-28 18:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CureAuxSP'>CureAuxSP: Mixture Cure Models with Auxiliary Subgroup Survival Probabilities.</h2><span id='topic+CureAuxSP'></span>

<h3>Description</h3>

<p>This package provides an information synthesis framework that can Estimate mixture cure models with subgroup survival probabilities
as auxiliary information. The underlying methods are based on the paper titled &quot;Efficient auxiliary information synthesis for
cure rate model&quot;, which has been published in Jie Ding, Jialiang Li and Xiaoguang Wang (2024) <a href="doi:10.1093/jrsssc/qlad106">doi:10.1093/jrsssc/qlad106</a>.
project work
</p>

<hr>
<h2 id='Print.SMC.AuxSP'>Print SMC.AuxSP object returned by our main function SMC.AuxSP()</h2><span id='topic+Print.SMC.AuxSP'></span>

<h3>Description</h3>

<p>Output of <code>SMC.AuxSP</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Print.SMC.AuxSP(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Print.SMC.AuxSP_+3A_object">object</code></td>
<td>
<p>an object of SMC.AuxSP</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function has no return value and is used to print the results in a <code>SMC.AuxSP</code> class with a better presentation.
</p>

<hr>
<h2 id='Probs.Sub'>Calculate subgroup survival probabilities</h2><span id='topic+Probs.Sub'></span>

<h3>Description</h3>

<p>Calculate Subgroup survival probabilities basedon the Kaplan-Meier estimation procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Probs.Sub(tstar, sdata, G)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Probs.Sub_+3A_tstar">tstar</code></td>
<td>
<p>time points that the survival probabilities will be estimated at.</p>
</td></tr>
<tr><td><code id="Probs.Sub_+3A_sdata">sdata</code></td>
<td>
<p>a survival dataset (dataframe) in which to interpret the variables named in the <code>formula</code> and the <code>cureform</code>.</p>
</td></tr>
<tr><td><code id="Probs.Sub_+3A_g">G</code></td>
<td>
<p>a matrix used to indicate which subgroups he/she belongs to for each of these subjects.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the estimated subgroup survival probabilities for a given survival dataset.
</p>

<hr>
<h2 id='sdata.SMC'>Generate simulated dataset from a well-designed PH mixture cure model</h2><span id='topic+sdata.SMC'></span>

<h3>Description</h3>

<p>Generate simulated dataset from a well-designed PH mixture cure model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdata.SMC(n, trace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sdata.SMC_+3A_n">n</code></td>
<td>
<p>the sample size of the simulated dataset.</p>
</td></tr>
<tr><td><code id="sdata.SMC_+3A_trace">trace</code></td>
<td>
<p>a logical value that indicates whether the information about cure rate and censoring rate should be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the simulated dataset from a well-designed PH mixture cure model.
</p>

<hr>
<h2 id='SMC.AuxSP'>Semi-parametric mixture cure model with auxiliary subgroup survival information</h2><span id='topic+SMC.AuxSP'></span>

<h3>Description</h3>

<p>Fit the semi-parametric mixture cure model with auxiliary subgroup survival probability information
based on the control variate technique.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMC.AuxSP(
  formula,
  cureform,
  sdata,
  aux = NULL,
  hetero = FALSE,
  N = Inf,
  latency = "PH",
  nboot = 400
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SMC.AuxSP_+3A_formula">formula</code></td>
<td>
<p>a formula expression, of the form <code>response ~ predictors</code>.
The <code>response</code> is a <code>Surv</code> object (from R package &quot;survival&quot;) with right censoring.
It is used to specify the covariate (risk factor) effects on the failure time of uncured subjects.
See the documentation for <code>survreg</code> and <code>Surv</code> in R package <code>survival</code> for details.
The expression to the right of the &quot;~&quot; specifies the effect of covariates on the failure time of uncured patients.</p>
</td></tr>
<tr><td><code id="SMC.AuxSP_+3A_cureform">cureform</code></td>
<td>
<p>indicator function a formula expression, of the form <code>cureform ~ predictors</code>.
It is used to specify the effects of covariates on the cure rate.
Note that a covariate is allowed to be used in both <code>formula</code> and <code>cureform</code>.</p>
</td></tr>
<tr><td><code id="SMC.AuxSP_+3A_sdata">sdata</code></td>
<td>
<p>a survival dataset (dataframe) in which to interpret the variables named in the <code>formula</code> and the <code>cureform</code>.</p>
</td></tr>
<tr><td><code id="SMC.AuxSP_+3A_aux">aux</code></td>
<td>
<p>indicates the historical aggregated statistics. It is a list of lists, and each sub-list represents auxiliary information from the same time point.
We combine multiple time points together and each time point contains the following four elements
<code>tstar</code> the time point that the auxiliary information was calculated at;
<code>sprob</code> auxiliary subgroup survival rates for each subgroup at the current time point;
<code>gfunc</code> a function used to identify the subgroup.</p>
</td></tr>
<tr><td><code id="SMC.AuxSP_+3A_hetero">hetero</code></td>
<td>
<p>denotes a logical value. If it is <code>TRUE</code>, the penalization will be applied to identify the
potential heterogeneous auxiliary subgroup survival rates and make a refinement to the final estimator.</p>
</td></tr>
<tr><td><code id="SMC.AuxSP_+3A_n">N</code></td>
<td>
<p>records the sample size of the external sdata that we extract auxiliary information from.
The default value is <code>N = Inf</code>, which is the case that the uncertainty is ignored.
If <code>N</code> is not <code>Inf</code>, the method that takes the uncertainty into consideration will be adopted automatically.</p>
</td></tr>
<tr><td><code id="SMC.AuxSP_+3A_latency">latency</code></td>
<td>
<p>specifies the model used in latency part.
It can be <code>PH</code> which represents the proportional hazards model, or <code>AFT</code> which represents the accelerated failure time model.
The default is the PH mixture cure model, that is, <code>latency = "PH"</code></p>
</td></tr>
<tr><td><code id="SMC.AuxSP_+3A_nboot">nboot</code></td>
<td>
<p>specifies the number of bootstrap sampling. The default <code>nboot = 400</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a function used to fit the semiparametric mixture cure model with auxilary subgrop survival information.
The method used here is the control variate technique.
The test statistic for evaluating the homogeneity assumption will also be calculated.
</p>


<h3>Value</h3>

<p>An object of class <code>SMC.AuxSP</code> is returned.
Specifically, it contains: <code>model</code>, a description of the model we fit; <code>suffix</code>, a character that indicates the status of auxiliary information; <code>coefficients</code>, estimated parameters.
For more friendly presentation, we provide a function <code>Print.SMC.AuxSP()</code> that can examine this newly defined class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#--------------------------------------------------------------------#
# illustration via simulated dataset (from PH mixture cure model) ####
#--------------------------------------------------------------------#

## library
library(survival)
library(CureAuxSP)

## generate both the internal dataset of interest and the external dataset

# - the internal dataset
set.seed(1)
sdata.internal &lt;- sdata.SMC(n = 300)
head(sdata.internal)

# - the external dataset
set.seed(1)
sdata.external &lt;- sdata.SMC(n = 10000)

## prepare the auxiliary information based on the external dataset

# - define two functions for subgroup splitting
gfunc.t1 &lt;- function(X,Z=NULL){
  rbind((X[,1] &lt;  0 &amp; X[,2] == 0), (X[,1] &gt;= 0 &amp; X[,2] == 0),
        (X[,1] &lt;  0 &amp; X[,2] == 1), (X[,1] &gt;= 0 &amp; X[,2] == 1))}
gfunc.t2 &lt;- function(X,Z=NULL){rbind((X[,2] == 0), (X[,2] == 1))}

# - calculate subgroup survival rates
sprob.t1 &lt;- Probs.Sub(tstar = 1, sdata = sdata.external,
                      G = gfunc.t1(X = sdata.external[,-c(1,2)]))
sprob.t2 &lt;- Probs.Sub(tstar = 2, sdata = sdata.external,
                      G = gfunc.t2(X = sdata.external[,-c(1,2)]))
cat("Information at t* = 1:", sprob.t1, "\nInformation at t* = 2:", sprob.t2)

# - prepare the set that collects information about auxiliary data
aux &lt;- list(
  time1 = list(tstar = 1, gfunc = gfunc.t1, sprob = c(0.73,0.70,0.88,0.83)),
  time2 = list(tstar = 2, gfunc = gfunc.t2, sprob = c(0.62,0.76)-0.20)
)


## fit the model without auxiliary information
set.seed(1)
sol.PHMC &lt;-  SMC.AuxSP(
  formula = Surv(yobs,delta) ~ X1 + X2, cureform = ~ X1,
  sdata = sdata.internal, aux = NULL, latency = "PH"
)
Print.SMC.AuxSP(object = sol.PHMC)

## fit the model with auxiliary information

# - ignore heterogeneity
set.seed(1)
sol.PHMC.Homo &lt;-  SMC.AuxSP(
  formula = Surv(yobs,delta) ~ X1 + X2, cureform = ~ X1,
  sdata = sdata.internal, aux = aux, hetero = FALSE, latency = "PH"
)
Print.SMC.AuxSP(object = sol.PHMC.Homo)

# - consider heterogeneity
set.seed(1)
sol.PHMC.Hetero &lt;-  SMC.AuxSP(
  formula = Surv(yobs,delta) ~ X1 + X2, cureform = ~ X1,
  sdata = sdata.internal, aux = aux, hetero = TRUE, latency = "PH"
)
Print.SMC.AuxSP(object = sol.PHMC.Hetero)



#--------------------------------------------------------------------#
# illustration via real breast cancer dataset (from TCGA program) ####
#   - the R package "TCGAbiolinks" should be downloaded in advance
#   - see "10.18129/B9.bioc.TCGAbiolinks" for more help
#--------------------------------------------------------------------#

## library
library(survival)
library(CureAuxSP)

## prepare the breast cancer dataset

# - download clinical data from the TCGA website
query &lt;- TCGAbiolinks::GDCquery(project = "TCGA-BRCA",
                                data.category = "Clinical", file.type = "xml")
TCGAbiolinks::GDCdownload(query)
clinical &lt;- TCGAbiolinks::GDCprepare_clinic(query, clinical.info = "patient")

# - a preparation
sdata.pre &lt;- data.frame(
  yobs   = ifelse(!is.na(clinical[,'days_to_death']),clinical[,'days_to_death'],
                  clinical[,'days_to_last_followup'])/365,
  delta  = ifelse(!is.na(clinical[,'days_to_death']),1,0),
  ER     = ifelse(
    clinical[,'breast_carcinoma_estrogen_receptor_status']=='Positive',1,
    ifelse(clinical[,'breast_carcinoma_estrogen_receptor_status']=='Negative',0,NA)),
  Age    = clinical[,'age_at_initial_pathologic_diagnosis'],
  Race   = ifelse(clinical[,'race_list']=='BLACK OR AFRICAN AMERICAN','black',
                  ifelse(clinical[,'race_list']=='WHITE','white','other')),
  Gender = ifelse(clinical[,'gender']=='FEMALE','Female',
                  ifelse(clinical[,'gender']=='MALE','Male',NA)),
  Stage  = sapply(
    clinical[,'stage_event_pathologic_stage'],
    function(x,pattern='Stage X|Stage IV|Stage [I]*'){
      ifelse(grepl(pattern,x),regmatches(x,regexpr(pattern,x)),NA)},USE.NAMES = FALSE)
)

# - extract covariates and remove undesiable subjects and NA
sdata.TCGA &lt;- na.omit(
  sdata.pre[
    sdata.pre[,'yobs'] &gt; 0
    &amp; sdata.pre[,'Age'] &lt;= 75
    &amp; sdata.pre[,'Gender'] == "Female"
    &amp; sdata.pre[,'Race'] %in% c('white')
    &amp; sdata.pre[,'Stage'] %in% c('Stage I','Stage II','Stage III'),
    c('yobs','delta','Age','ER'),
  ]
)
rownames(sdata.TCGA) &lt;- NULL

# - summary statistics of the internal dataset
summary(sdata.TCGA)

## plot a figure to show the existence of a cure fraction
# pdf("Figure_KM_TCGA_BRCA.pdf",width=8.88,height=6.66); {
plot(
  survival::survfit(survival::Surv(yobs, delta) ~ 1, data = sdata.TCGA),
  conf.int = T, mark.time = TRUE, lwd = 2,
  ylab = "Survival Probability", xlab = "Survival Time (in Years)",
  xlim = c(0,25), ylim = c(0,1)
)
# }; dev.off()

## fit the model without auxiliary information

# - rescale the Age variable
Age.Min &lt;- min(sdata.TCGA$Age); Age.Max &lt;- max(sdata.TCGA$Age)
sdata.TCGA$Age &lt;- (sdata.TCGA$Age-Age.Min)/(Age.Max-Age.Min)

# - fit the model
set.seed(1)
sol.PHMC &lt;-  SMC.AuxSP(
  formula = Surv(yobs,delta) ~ Age + ER, cureform = ~ Age + ER,
  sdata = sdata.TCGA, aux = NULL, latency = "PH"
)
Print.SMC.AuxSP(object = sol.PHMC)

## fit the model with auxiliary information

# - prepare the auxiliary information
Age.Cut &lt;- c(0,(c(40,50,60)-Age.Min)/(Age.Max-Age.Min),1)
gfunc.t1 &lt;- function(X,Z){
  rbind((X[,1] &gt;= Age.Cut[1] &amp; X[,1] &lt;  Age.Cut[2] &amp; X[,2] == 1),
        (X[,1] &gt;= Age.Cut[2] &amp; X[,1] &lt;  Age.Cut[3] &amp; X[,2] == 1),
        (X[,1] &gt;= Age.Cut[3] &amp; X[,1] &lt;  Age.Cut[4] &amp; X[,2] == 1),
        (X[,1] &gt;= Age.Cut[4] &amp; X[,1] &lt;= Age.Cut[5] &amp; X[,2] == 1),
        (X[,1] &gt;= Age.Cut[1] &amp; X[,1] &lt;  Age.Cut[2] &amp; X[,2] == 0),
        (X[,1] &gt;= Age.Cut[2] &amp; X[,1] &lt;  Age.Cut[3] &amp; X[,2] == 0),
        (X[,1] &gt;= Age.Cut[3] &amp; X[,1] &lt;  Age.Cut[4] &amp; X[,2] == 0),
        (X[,1] &gt;= Age.Cut[4] &amp; X[,1] &lt;= Age.Cut[5] &amp; X[,2] == 0))}
gfunc.t2 &lt;- function(X,Z){rbind((X[,2] == 1), (X[,2] == 0))}
aux &lt;- list(
  time1 = list(tstar = 5, gfunc = gfunc.t1,
               sprob = c(0.810,0.935,0.925,0.950,0.695,0.780,0.830,0.850)),
  time2 = list(tstar = 10, gfunc = gfunc.t2, sprob = c(0.825,0.705))
)

# - ignore heterogeneity
set.seed(1)
sol.PHMC.Homo &lt;-  SMC.AuxSP(
  formula = Surv(yobs,delta) ~ Age + ER, cureform = ~ Age + ER,
  sdata = sdata.TCGA, aux = aux, hetero = FALSE, N = 1910, latency = "PH"
)
Print.SMC.AuxSP(object = sol.PHMC.Homo)

# - consider heterogeneity
set.seed(1)
sol.PHMC.Hetero &lt;-  SMC.AuxSP(
  formula = Surv(yobs,delta) ~ Age + ER, cureform = ~ Age + ER,
  sdata = sdata.TCGA, aux = aux, hetero = TRUE, N = 1910, latency = "PH"
)
Print.SMC.AuxSP(object = sol.PHMC.Hetero)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
