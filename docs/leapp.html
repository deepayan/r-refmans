<!DOCTYPE html><html><head><title>Help for package leapp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {leapp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#leapp-package'>
<p>latent effect adjustment after primary projection</p></a></li>
<li><a href='#AlternateSVD'>
<p>Alternating singular value decomposition</p></a></li>
<li><a href='#FindAUC'><p>Compute the area under the ROC curve (AUC)</p></a></li>
<li><a href='#FindFpr'><p>Compute the false positive rate at given sizes of retrieved genes</p></a></li>
<li><a href='#FindPrec'><p>compute the precision at given sizes of retrieved genes</p></a></li>
<li><a href='#FindRec'>
<p>compute the recall at given sizes of retrieved genes</p></a></li>
<li><a href='#FindTpr'><p>compute the true positive rate at given sizes of retrieved genes</p></a></li>
<li><a href='#IPOD'>
<p>Iterative penalized outlier detection algorithm</p></a></li>
<li><a href='#IPODFUN'>
<p>compute the iterative penalized outlier detection given the noise standard deviation sigma</p></a></li>
<li><a href='#leapp'><p>latent effect adjustment after primary projection</p></a></li>
<li><a href='#Pvalue'><p>Calculate statistics and p-values</p></a></li>
<li><a href='#ridge'><p> Outlier detection with a ridge penalty</p></a></li>
<li><a href='#ROCplot'><p>plot ROC curve</p></a></li>
<li><a href='#simdat'><p>Simulated gene expression data affected by a group variable and an unobserved factor</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-19</td>
</tr>
<tr>
<td>Title:</td>
<td>Latent Effect Adjustment After Primary Projection</td>
</tr>
<tr>
<td>Author:</td>
<td>Yunting Sun &lt;yunting.sun@gmail.com&gt; , Nancy R.Zhang
        &lt;nzhang@stanford.edu&gt;, Art B.Owen &lt;owen@stanford.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yunting Sun &lt;yunting.sun@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>These functions take a gene expression value matrix, a
        primary covariate vector, an additional known covariates
        matrix.  A two stage analysis is applied to counter the effects
        of latent variables on the rankings of hypotheses.  The
        estimation and adjustment of latent effects are proposed by
        Sun, Zhang and Owen (2011).  "leapp" is developed in the
        context of microarray experiments, but may be used as a general
        tool for high throughput data sets where dependence may be
        involved.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1), sva, MASS, corpcor</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-19 20:46:12 UTC; ytsun</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-19 21:10:02 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='leapp-package'>
latent effect adjustment after primary projection
</h2><span id='topic+leapp-package'></span>

<h3>Description</h3>

<p>These functions take a gene expression value matrix, a primary covariate vector, an additional known covariates matrix.  A two stage analysis is applied to counter the effects of latent variables on the rankings of hypotheses.  The estimation and adjustment of latent effects are proposed by Sun, Zhang and Owen (2011).   &quot;leapp&quot; is developed in the context of microarray experiments, but may be used as a general tool for high throughput data sets where dependence may be involved.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> leapp</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-01-05</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> What license is it under?</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Maintainer: Yunting Sun &lt;yunting.sun@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Sun, Zhang and Owen (2011), &quot;Multiple hypothesis testing, adjusting for latent
variables&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
   library(sva)
   library(MASS)
   library(leapp)
   data(simdat)
   model &lt;- cbind(rep(1,60),simdat$g)
   model0 &lt;- cbind(rep(1,60))
   p.raw &lt;- f.pvalue(simdat$data,model,model0)
   p.oracle &lt;-f.pvalue(simdat$data - simdat$u
    
   p.leapp &lt;- leapp(simdat$data,pred.prim = simdat$g)$p
   p = cbind(p.raw,p.oracle, p.leapp)
   topk = seq(0,0.5,length.out = 50)*1000
   null.set = which(simdat$gamma !=0)
   fpr= apply(p,2,FindFpr,null.set,topk)
   tpr= apply(p,2,FindTpr,null.set,topk)
   ROCplot(fpr,tpr, main = "ROC Comparison", 
           name.method = c("raw","oracle","leapp"), save = FALSE )
 
## End(Not run)
</code></pre>

<hr>
<h2 id='AlternateSVD'>
Alternating singular value decomposition
</h2><span id='topic+AlternateSVD'></span>

<h3>Description</h3>

<p>The algorithm alternates between 1) computing latent loadings u and latent variable v and 2) estimating noise standard deviation for each of the N genes.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AlternateSVD(x, r, pred = NULL, max.iter = 10, TOL = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AlternateSVD_+3A_x">x</code></td>
<td>

<p>an N by n data matrix 
</p>
</td></tr>
<tr><td><code id="AlternateSVD_+3A_r">r</code></td>
<td>

<p>a numeric, number of latent factors to estimate
</p>
</td></tr>
<tr><td><code id="AlternateSVD_+3A_pred">pred</code></td>
<td>

<p>an n by s matrix,  each column is a vector of known covariates for n samples, s covariates are considered, default to <code>NULL</code>  
</p>
</td></tr>
<tr><td><code id="AlternateSVD_+3A_max.iter">max.iter</code></td>
<td>

<p>a numeric, maximum number of iteration allowed, default to 10
</p>
</td></tr>
<tr><td><code id="AlternateSVD_+3A_tol">TOL</code></td>
<td>

<p>a numeric, tolerance level for the algorithm to converge, default to 1e-04
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>sigma</code></td>
<td>
<p>a vector of length N,  noise standard deviations for N genes</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>an N by s matrix, estimated coefficients for known covariates</p>
</td></tr>
<tr><td><code>uest</code></td>
<td>
<p>an N by r matrix, estimated latent loadings</p>
</td></tr>
<tr><td><code>vest</code></td>
<td>
<p>an n by r matrix, estiamted latent factors</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>

<hr>
<h2 id='FindAUC'>Compute the area under the ROC curve (AUC) </h2><span id='topic+FindAUC'></span>

<h3>Description</h3>

<p>Given a vector of p values for m genes and a set of null genes,  compute the area under ROC curve using the Wilcoxin statistics  
</p>


<h3>Usage</h3>

<pre><code class='language-R'> FindAUC(pvalue, ind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FindAUC_+3A_pvalue">pvalue</code></td>
<td>
<p>A vector of p values, one for each gene, with length m </p>
</td></tr>
<tr><td><code id="FindAUC_+3A_ind">ind</code></td>
<td>
<p>A vector of indices that the corresponding gene are true positive </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>auc</code></td>
<td>
<p>A numeric, area under the ROC curve for the given gene list</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>

<hr>
<h2 id='FindFpr'>Compute the false positive rate at given sizes of retrieved genes </h2><span id='topic+FindFpr'></span>

<h3>Description</h3>

<p>Given a vector of sizes of retrieved genes, for each size k, select
the top k genes with smallest p values and compute the false positive rate from
the retrieved genes and the true positive genes.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'> FindFpr(pvalue, ind,topk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FindFpr_+3A_pvalue">pvalue</code></td>
<td>
<p>A vector of p values, one for each gene, with length m </p>
</td></tr>
<tr><td><code id="FindFpr_+3A_ind">ind</code></td>
<td>
<p>A vector of indices that the corresponding gene are true positive </p>
</td></tr>
<tr><td><code id="FindFpr_+3A_topk">topk</code></td>
<td>
<p>A vector of integers ranging from 1 to m ,  length of retrieved
gene list</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fpr</code></td>
<td>
<p>A vector of false positive rates at given sizes of retrieval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>

<hr>
<h2 id='FindPrec'>compute the precision at given sizes of retrieved genes </h2><span id='topic+FindPrec'></span>

<h3>Description</h3>

<p>Given a vector of sizes of retrieved genes, for each size k, select
the top k genes with smallest p values and compute the precision from
the retrieved genes and the true positive genes.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'> FindPrec(pvalue, ind,topk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FindPrec_+3A_pvalue">pvalue</code></td>
<td>
<p>A vector of p values, one for each gene, with length m </p>
</td></tr>
<tr><td><code id="FindPrec_+3A_ind">ind</code></td>
<td>
<p>A vector of indices that the corresponding gene are true positive </p>
</td></tr>
<tr><td><code id="FindPrec_+3A_topk">topk</code></td>
<td>
<p>A vector of integers ranging from 1 to m ,  length of retrieved
gene list</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>prec</code></td>
<td>
<p>A vector of precisions at given sizes of retrieval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>

<hr>
<h2 id='FindRec'>
compute the recall at given sizes of retrieved genes
</h2><span id='topic+FindRec'></span>

<h3>Description</h3>

<p>Given a vector of sizes of retrieved genes, for each size k, select
the top k genes with smallest p values and compute the recall from
the retrieved genes and the true positive genes.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FindRec(pvalue, ind, topk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FindRec_+3A_pvalue">pvalue</code></td>
<td>
<p>A vector of p values, one for each gene, with length m </p>
</td></tr>
<tr><td><code id="FindRec_+3A_ind">ind</code></td>
<td>
<p>A vector of indices that the corresponding gene are true positive </p>
</td></tr>
<tr><td><code id="FindRec_+3A_topk">topk</code></td>
<td>
<p>A vector of integers ranging from 1 to m ,  length of retrieved
gene list</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>rec</code></td>
<td>
<p>A vector of precisions at given sizes of retrieval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>

<hr>
<h2 id='FindTpr'>compute the true positive rate at given sizes of retrieved genes </h2><span id='topic+FindTpr'></span>

<h3>Description</h3>

<p>Given a vector of sizes of retrieved genes, for each size k, select
the top k genes with smallest p values and compute the true positive rate from
the retrieved genes and the true positive genes.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'> FindTpr(pvalue, ind,topk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FindTpr_+3A_pvalue">pvalue</code></td>
<td>
<p>A vector of p values, one for each gene, with length m </p>
</td></tr>
<tr><td><code id="FindTpr_+3A_ind">ind</code></td>
<td>
<p>A vector of indices that the corresponding gene are true positive </p>
</td></tr>
<tr><td><code id="FindTpr_+3A_topk">topk</code></td>
<td>
<p>A vector of integers ranging from 1 to m ,  length of retrieved
gene list</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>tpr</code></td>
<td>
<p>A vector of True positive rates at given sizes of retrieval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>

<hr>
<h2 id='IPOD'>
Iterative penalized outlier detection algorithm   
</h2><span id='topic+IPOD'></span>

<h3>Description</h3>

<p> Outlier detection and robust regression through an iterative penalized regression 
with tuning parameter chosen by  modified BIC</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPOD(X, Y, H, method = "hard", TOL = 1e-04, length.out = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IPOD_+3A_x">X</code></td>
<td>

<p>an N by k design matrix  
</p>
</td></tr>
<tr><td><code id="IPOD_+3A_y">Y</code></td>
<td>

<p>an N by 1 response
</p>
</td></tr>
<tr><td><code id="IPOD_+3A_h">H</code></td>
<td>

<p>an N by N projection matrix <code>X(X'X)^{-1}X'</code>
</p>
</td></tr>
<tr><td><code id="IPOD_+3A_method">method</code></td>
<td>

<p>a string, if method = &quot;hard&quot;, hard thresholding is applied; if method = &quot;soft&quot;, soft thresholding is applied
</p>
</td></tr>
<tr><td><code id="IPOD_+3A_tol">TOL</code></td>
<td>

<p>relative iterative converence tolerance, default to 1e-04
</p>
</td></tr>
<tr><td><code id="IPOD_+3A_length.out">length.out</code></td>
<td>
<p>A numeric, number of candidate tuning parameter lambda under consideration for further modified BIC model selection,  default to 50. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there is no predictors,  set <code>X = NULL</code>. 
</p>
<p>Y = X beta + gamma + sigma epsilon
</p>
<p>Y is N by 1 reponse vector, X is N by k design matrix, beta is k by 1 coefficients, gamma is N by 1 outlier indicator, sigma is a scalar and the noise standard deviation and epsilon is N by 1 vector with components independently distributed as standard normal N(0,1).   
</p>


<h3>Value</h3>

<table>
<tr><td><code>gamma</code></td>
<td>
<p>a vector of length N, estimated outlier indicator gamma</p>
</td></tr>
<tr><td><code>resOpt.scale</code></td>
<td>
<p>a vector of length N, test statistics for each of the N genes</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>a vector of length N, p-values for each of the N genes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>

<hr>
<h2 id='IPODFUN'>
compute the iterative penalized outlier detection given the noise standard deviation sigma
</h2><span id='topic+IPODFUN'></span>

<h3>Description</h3>

<p>Y = X beta + gamma + sigma epsilon
estimate k by 1 coefficients vector beta and N by 1 outlier indicator vector gamma from (Y,X).     
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPODFUN(X, Y, H, sigma, betaInit, method = "hard", TOL = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IPODFUN_+3A_x">X</code></td>
<td>
<p>an N by k design matrix </p>
</td></tr>
<tr><td><code id="IPODFUN_+3A_y">Y</code></td>
<td>
<p>an N by 1 response vector</p>
</td></tr>
<tr><td><code id="IPODFUN_+3A_h">H</code></td>
<td>
<p>an N by N projection matrix X(X'X)^-1X' </p>
</td></tr>
<tr><td><code id="IPODFUN_+3A_sigma">sigma</code></td>
<td>
<p>a numeric,  noise standard deviation</p>
</td></tr>
<tr><td><code id="IPODFUN_+3A_betainit">betaInit</code></td>
<td>
<p>a k by 1 initial value for coeffient beta</p>
</td></tr>
<tr><td><code id="IPODFUN_+3A_method">method</code></td>
<td>
<p>a string, if &quot;hard&quot;, conduct hard thresholding, if &quot;soft&quot;, conduct soft thresholding, default to &quot;hard&quot;</p>
</td></tr>
<tr><td><code id="IPODFUN_+3A_tol">TOL</code></td>
<td>
<p>a numeric,  tolerance of convergence,  default to 1e-04</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The initial estimator for the coefficient beta can be chosen to be the estimator from a robust linear regression</p>


<h3>Value</h3>

<table>
<tr><td><code>gamma</code></td>
<td>
<p>an N by 1 vector of estimated outlier indicator</p>
</td></tr>
<tr><td><code>ress</code></td>
<td>
<p>an N by 1 vector of residual Y - X beta - gamma </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>


<h3>References</h3>

<p>She, Y. and Owen, A.B. &quot;Outlier detection using nonconvex penalized regression&quot; 2010
</p>

<hr>
<h2 id='leapp'>latent effect adjustment after primary projection</h2><span id='topic+leapp'></span>

<h3>Description</h3>

<p>Adjust for latent factors and conduct multiple hypotheses testing from
gene expression data using the algorithm of Sun,Zhang and Owen (2011).
Number of latent factors can be chosen by Buja and Eyuboglu (1992).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leapp (data,pred.prim,pred.covar,
         O = NULL, num.fac = "buja", method = "hard", sparse = TRUE,
         centered = FALSE, verbose = FALSE, perm.num = 50, 
         TOL = 1e-4, length.out = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leapp_+3A_data">data</code></td>
<td>
<p>An N genes by n arrays matrix of expression data</p>
</td></tr>
<tr><td><code id="leapp_+3A_pred.prim">pred.prim</code></td>
<td>
<p>An n by 1 primary predictor</p>
</td></tr>
<tr><td><code id="leapp_+3A_pred.covar">pred.covar</code></td>
<td>
<p>An n by s known covariate matrix not of primary
interest</p>
</td></tr>
<tr><td><code id="leapp_+3A_o">O</code></td>
<td>
<p>An n by n rotation matrix such that O  pred.prim = (1, 0,...,0)</p>
</td></tr>
<tr><td><code id="leapp_+3A_num.fac">num.fac</code></td>
<td>
<p>A numeric or string,  number of latent factors chosen.  it has default value &quot;buja&quot; which uses Buja and Eyuboglu (1992) to pick the number of factors</p>
</td></tr>
<tr><td><code id="leapp_+3A_method">method</code></td>
<td>
<p>A string which takes values in (&quot;hard&quot;,&quot;soft&quot;).  &quot;hard&quot;:  hard thresholding in the IPOD algorithm; &quot;soft&quot;: soft thresholding in the IPOD algorithm</p>
</td></tr>
<tr><td><code id="leapp_+3A_sparse">sparse</code></td>
<td>
<p>A logical value,  if <code>TRUE</code>, the signal is sparse and the proportion of non-null genes is small, use IPOD algorithm in Owen and She (2010) to enforce sparsity.  If <code>FALSE</code>, the signal is not sparse, use ridge type penalty to carry out the inference as in Sun,Zhang, Owen (2011). Default to <code>TRUE</code></p>
</td></tr>   
<tr><td><code id="leapp_+3A_centered">centered</code></td>
<td>
<p>A logical value,  indicates whether the data has been centered at zero, default to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="leapp_+3A_verbose">verbose</code></td>
<td>
<p>A logical value, if <code>TRUE</code>, will print much information as algorithm proceeds, default to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="leapp_+3A_perm.num">perm.num</code></td>
<td>
<p>A numeric, number of permutation performed using algorithm of Buja and Eyuboglu (1992), default to 50</p>
</td></tr>
<tr><td><code id="leapp_+3A_tol">TOL</code></td>
<td>
<p>A numeric,  convergence tolerance level, default to 1e-4</p>
</td></tr>
<tr><td><code id="leapp_+3A_length.out">length.out</code></td>
<td>
<p>A numeric, number of candidate tuning parameter lambda under consideration for further modified BIC model selection,  default to 50. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data for test i should be in the ith row of data. If the rotation matrix O is set to NULL, the function will compute one rotation from primary predictor pred.prim.
</p>


<h3>Value</h3>

<table>
<tr><td><code>p</code></td>
<td>
<p>A vector of p-values one for each row of data.</p>
</td></tr>
<tr><td><code>vest</code></td>
<td>
<p>An n by num.fac matrix, estimated latent factors</p>
</td></tr>
<tr><td><code>uest</code></td>
<td>
<p>An N by num.fac matrix, estimated latent loadings</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>An N by 1 vector, estimated primary effect</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>An N by 1 vector, estimated noise standard deviation one for each row of data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
  ## Load data
  data(simdat)
  
  
    
  #Calculate the p-values
  p &lt;- leapp(simdat$data,pred.prim = simdat$g,method = "hard")$p
  auc &lt;- FindAUC(p, which(simdat$gamma!=0))
  
  
 
## End(Not run)
</code></pre>

<hr>
<h2 id='Pvalue'>Calculate statistics and p-values</h2><span id='topic+Pvalue'></span>

<h3>Description</h3>

<p>Calculate F-statistics, t-statistics and corresponding p-values given
multiple regression models under the null and alternative hypotheses.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  Pvalue(dat, mod, mod0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pvalue_+3A_dat">dat</code></td>
<td>
<p>An N genes by n arrays matrix of expression data</p>
</td></tr>
<tr><td><code id="Pvalue_+3A_mod">mod</code></td>
<td>
<p>An n by (s+1)  design matrix  under the full model
(alternative), the first column is the primary predictor, s&gt;=0 and
the rest of the columns are additional covariates </p>
</td></tr>
<tr><td><code id="Pvalue_+3A_mod0">mod0</code></td>
<td>
<p>An n by s design  matrix under the null hypothesis, s&gt;=0,
should be the same as the 2:(s+1) columns of mod.  If s=0, please set mod0 = <code>NULL</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>p</code></td>
<td>
<p>An N by 1 vector of p-values one for each row of data.</p>
</td></tr>
<tr><td><code>tstat</code></td>
<td>
<p>An N by 1 vector of t-statistics for primary parameters. </p>
</td></tr>
<tr><td><code>fstat</code></td>
<td>
<p>An N by 1 vector of F-statistics for primary parameters.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>An N by (s+1) matrix of coefficients with respect to
design matrix mod under the full model. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
      data(simdat)
      n = ncol(simdat$data)
      mod = cbind(simdat$g, rep(1,n))
      mod0 = cbind(rep(1,n))
      result = Pvalue(dimdat$data,mod = mod, mod0 = mod0)
  
## End(Not run)
  
</code></pre>

<hr>
<h2 id='ridge'> Outlier detection with a ridge penalty 
</h2><span id='topic+ridge'></span>

<h3>Description</h3>

<p>Outlier detection and robust regression with a ridge type penalty on the outlier indicator gamma.  Allow non sparse outliers and require known noise standard deviation.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ridge(X, Y, H, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ridge_+3A_x">X</code></td>
<td>

<p>an N by k design matrix
</p>
</td></tr>
<tr><td><code id="ridge_+3A_y">Y</code></td>
<td>
<p> an N by 1 response vector
</p>
</td></tr>
<tr><td><code id="ridge_+3A_h">H</code></td>
<td>
<p> an N by N projection matrix <code>X(X'X)^{-1}X'</code>
</p>
</td></tr>
<tr><td><code id="ridge_+3A_sigma">sigma</code></td>
<td>
<p>a numeric, noise standard deviation
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>p</code></td>
<td>
<p>an N by 1 vector of p-values for each of the N genes</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>an N by 1 vector of estimated primary variable gamma</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>

<hr>
<h2 id='ROCplot'>plot ROC curve </h2><span id='topic+ROCplot'></span>

<h3>Description</h3>

<p>Input an p by d matrix, each column of which contains false positive rates(FPR) computed from each of the d methods and p significance levels and a matrix of corresponding true positive rates(TPR) at the same significance levels.   Plot ROC curve for each of the d methods.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ROCplot(fpr,tpr,main, name.method, 
         xlim = c(0,0.2),ylim = c(0.4,1), save = TRUE, name.file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ROCplot_+3A_fpr">fpr</code></td>
<td>
<p>A matrix of false positive rates for increasing sizes of retrieved significant genes </p>
</td></tr>
<tr><td><code id="ROCplot_+3A_tpr">tpr</code></td>
<td>
<p>A vector of corresponding true positive rates at the same significance levels  </p>
</td></tr>
<tr><td><code id="ROCplot_+3A_main">main</code></td>
<td>
<p>a string, title of the figure</p>
</td></tr>
<tr><td><code id="ROCplot_+3A_name.method">name.method</code></td>
<td>
<p>a string vector of length d containing names of the d methods</p>
</td></tr>
<tr><td><code id="ROCplot_+3A_xlim">xlim</code></td>
<td>
<p>the range of the x axis(FPR), default to c(0,0.2)</p>
</td></tr>
<tr><td><code id="ROCplot_+3A_ylim">ylim</code></td>
<td>
<p>the range of the y axis (TPR), default to c(0.4,1)</p>
</td></tr>
<tr><td><code id="ROCplot_+3A_save">save</code></td>
<td>
<p>a logical value, if <code>TRUE</code>, will save the plot to an png file, default to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="ROCplot_+3A_name.file">name.file</code></td>
<td>
<p>a string giving the name of the png file to save the plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The order of the name.method should be the same as that in the fpr and tpr.  
</p>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
   library(sva)
   library(MASS)
   library(leapp)
   data(simdat)
   model &lt;- cbind(rep(1,60),simdat$g)
   model0 &lt;- cbind(rep(1,60))
   p.raw &lt;- f.pvalue(simdat$data,model,model0)
   p.oracle &lt;-f.pvalue(simdat$data - simdat$u
    
   p.leapp &lt;- leapp(simdat$data,pred.prim = simdat$g, method = "hard")$p
   p = cbind(p.raw,p.oracle, p.leapp)
   topk = seq(0,0.5,length.out = 50)*1000
   null.set = which(simdat$gamma !=0)
   fpr= apply(p,2,FindFpr,null.set,topk)
   tpr= apply(p,2,FindTpr,null.set,topk)
   ROCplot(fpr,tpr, main = "ROC Comparison",
           name.method = c("raw","oracle","leapp"), save = FALSE )
 
## End(Not run)
</code></pre>

<hr>
<h2 id='simdat'>Simulated gene expression data affected by a group variable and an unobserved factor</h2><span id='topic+simdat'></span>

<h3>Description</h3>

<p>This data set is a simulated gene expression matrix with N(0,1)
background noise and affected by two variables.  gene expression values of 1000 genes from 60 samples are simulated.  First 30 samples are from case group and last 30 samples are from control group.  The primary treatment variable g affects ten percent of the genes and the latent variable affects uniformly on the genes.  The correlation between primary treatment variable g and the latent variable is 0.5 and the SNR = 1, SLR = 0.5. The variances of noise across genes are distributed as inverse gamma. Also included in the data are a vector of normalized primary variable g, a vector of primary parameter gamma,a vector of latent factor v, a vector of latent loadings u and a vector of noise standard deviation for all genes sigma.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simdat)</code></pre>


<h3>Format</h3>

<p>A list of 6 components</p>


<h3>Value</h3>

<table>
<tr><td><code>data</code></td>
<td>
<p>A 1000 x 60 gene expression value matrix with genes in rows and arrays in columns</p>
</td></tr>
<tr><td><code>g</code></td>
<td>
<p>A vector of length 60, primary variable </p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>A vector of length 1000, primary parameter </p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>A vector of length 60, latent variable</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>A vector of length 1000, latent loadings </p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>A vector of length 1000, noise standard deviation for each of the 1000 genes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yunting Sun <a href="mailto:yunting.sun@gmail.com">yunting.sun@gmail.com</a>, Nancy R.Zhang <a href="mailto:nzhang@stanford.edu">nzhang@stanford.edu</a>, Art B.Owen <a href="mailto:owen@stanford.edu">owen@stanford.edu</a></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
