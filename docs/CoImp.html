<!DOCTYPE html><html><head><title>Help for package CoImp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CoImp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CoImp'><p>Copula-Based Imputation Method</p></a></li>
<li><a href='#CoImp-class'><p>Class &quot;CoImp&quot;</p></a></li>
<li><a href='#MAR'><p>Generation of multivariate missing at random (MAR) data</p></a></li>
<li><a href='#MAR-class'><p>Class &quot;MAR&quot;</p></a></li>
<li><a href='#MCAR'><p>Generation of multivariate MCAR data</p></a></li>
<li><a href='#MCAR-class'><p>Class &quot;MCAR&quot;</p></a></li>
<li><a href='#PerfMeasure'><p>Performance measures for evaluating the goodness of an imputed database</p></a></li>
<li><a href='#PerfMeasure-class'><p>Class &quot;PerfMeasure&quot;</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Copula Based Imputation Method</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-06-28</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Francesca Marta Lilja Di Lascio, Simone Giannerini</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0), methods, copula</td>
</tr>
<tr>
<td>Imports:</td>
<td>nnet, gtools, locfit</td>
</tr>
<tr>
<td>Description:</td>
<td>Copula based imputation method. A semiparametric imputation procedure for missing multivariate data based on conditional copula specifications.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-06-28 22:04:58 UTC; Administrator</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-06-28 22:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='CoImp'>Copula-Based Imputation Method</h2><span id='topic+CoImp'></span>

<h3>Description</h3>

<p>Imputation method based on conditional copula functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CoImp(X, n.marg = ncol(X), x.up = NULL, x.lo = NULL, q.up = rep(0.85, n.marg), 
            q.lo = rep(0.15, n.marg), type.data = "continuous", smoothing = 
            rep(0.5, n.marg), plot = TRUE, model = list(normalCopula(0.5, 
            dim=n.marg),  claytonCopula(10, dim=n.marg), gumbelCopula(10, 
            dim=n.marg), frankCopula(10, dim=n.marg), tCopula(0.5, 
            dim=n.marg,...), rotCopula(claytonCopula(10,dim=n.marg), 
            flip=rep(TRUE,n.marg)),...), start. = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CoImp_+3A_x">X</code></td>
<td>
<p>a data matrix with missing values. Missing values should be denoted
with <code>NA</code>.</p>
</td></tr>
<tr><td><code id="CoImp_+3A_n.marg">n.marg</code></td>
<td>
<p>the number of variables in X.</p>
</td></tr>
<tr><td><code id="CoImp_+3A_x.up">x.up</code></td>
<td>
<p>a numeric vector of length n.marg with the upper value of each margin used in the Hit or Miss method. Specify either x.up xor q.up.</p>
</td></tr>
<tr><td><code id="CoImp_+3A_x.lo">x.lo</code></td>
<td>
<p>a numeric vector of length n.marg with the lower value of each margin used in the Hit or Miss method. Specify either x.lo xor q.lo.</p>
</td></tr>
<tr><td><code id="CoImp_+3A_q.up">q.up</code></td>
<td>
<p>a numeric vector of length n.marg with the probability of the quantile used to define x.up for each margin. Specify either x.up xor q.up.</p>
</td></tr>
<tr><td><code id="CoImp_+3A_q.lo">q.lo</code></td>
<td>
<p>a numeric vector of length n.marg with the probability of the quantile used to define x.lo for each margin. Specify either x.lo xor q.lo.</p>
</td></tr>   
<tr><td><code id="CoImp_+3A_type.data">type.data</code></td>
<td>
<p>the nature of the variables in X: <code>discrete</code> or <code>continuous</code>.</p>
</td></tr>
<tr><td><code id="CoImp_+3A_smoothing">smoothing</code></td>
<td>
<p>values for the nearest neighbour component of the smoothing parameter of the <code>lp</code> function.</p>
</td></tr>
<tr><td><code id="CoImp_+3A_plot">plot</code></td>
<td>
<p>logical: if <code>TRUE</code> plots the estimated marginal densities and a bar plot of the percentages of missing and available data for each margin.</p>
</td></tr>  
<tr><td><code id="CoImp_+3A_model">model</code></td>
<td>
<p>a list of copula models to be used for the imputation, see the Details section.
This should be one of <code>normal</code> and <code>t</code> (with <code>dispstr</code> as in the <code>copula</code> package), <code>frank</code>, <code>clayton</code>, <code>gumbel</code>, and <code>rotated copulas</code>.
As in <code>fitCopula</code>, itau fitting coerced tCopula to 'df.fixed=TRUE'.</p>
</td></tr>
<tr><td><code id="CoImp_+3A_start.">start.</code></td>
<td>
<p>a numeric vector of starting values for the parameter optimization via <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="CoImp_+3A_...">...</code></td>
<td>
<p>further parameters for <code><a href="copula.html#topic+fitCopula">fitCopula</a></code>, <code><a href="locfit.html#topic+lp">lp</a></code> and further graphical arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>CoImp is an imputation method based on conditional copula functions that allows to impute missing observations according to the multivariate dependence structure of the generating process without any assumptions on the margins. This method can be used independently from the dimension and the kind (monotone or non monotone) of the missing patterns.
</p>
<p>Brief description of the approach:
</p>

<ol>
<li><p> estimate both the margins and the copula model on available data by means of the semi-parametric sequential two-step inference for margins;
</p>
</li>
<li><p> derive conditional density functions of the missing variables given non-missing ones through the corresponding conditional copulas obtained by using the Bayes' rule;
</p>
</li>
<li><p> impute missing values by drawing observations from the conditional density functions derived at the previous step. The Monte Carlo method used is the Hit or Miss.
</p>
</li></ol>

<p>The estimation approach for the copula fit is semiparametric: a range of nonparametric margins and parametric copula models can be selected by the user.
</p>


<h3>Value</h3>

<p>An object of S4 class &quot;CoImp&quot;, which is a list with the following elements:
</p>
<table>
<tr><td><code>Missing.data.matrix</code></td>
<td>
<p>the original missing data matrix to be imputed.</p>
</td></tr>
<tr><td><code>Perc.miss</code></td>
<td>
<p>the matrix of the percentage of missing and available data.</p>
</td></tr>
<tr><td><code>Estimated.Model</code></td>
<td>
<p>the estimated copula model on the available data.</p>
</td></tr>
<tr><td><code>Estimation.Method</code></td>
<td>
<p>the estimation method used for the copula <code>Estimated.Model</code>.</p>
</td></tr>
<tr><td><code>Index.matrix.NA</code></td>
<td>
<p>matrix indices of the missing data.</p>
</td></tr>
<tr><td><code>Smooth.param</code></td>
<td>
<p>the smoothing parameter alpha selected on the basis of the AIC.</p>
</td></tr>
<tr><td><code>Imputed.data.matrix</code></td>
<td>
<p>the imputed data matrix.</p>
</td></tr>
<tr><td><code>Estimated.Model.Imp</code></td>
<td>
<p>the estimated copula model on the imputed data matrix.</p>
</td></tr>
<tr><td><code>Estimation.Method.Imp</code></td>
<td>
<p>the estimation method used for the copula <code>Estimated.Model.Imp</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. Giannerini, S. and Reale A. (201x) &quot;A multivariate technique based on conditional copula specification for the imputation of complex dependent data&quot;. Working paper.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2015) &quot;Exploring Copulas for the Imputation of Complex Dependent Data&quot;. Statistical Methods &amp; Applications, 24(1), p. 159-175. DOI 10.1007/s10260-014-0287-2.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2014) &quot;Imputation of complex dependent data by conditional copulas: analytic versus semiparametric approach&quot;, Book of proceedings of the 21st International Conference on Computational Statistics (COMPSTAT 2014), p. 491-497. ISBN 9782839913478.
</p>
<p>Bianchi, G. Di Lascio, F.M.L. Giannerini, S. Manzari, A. Reale, A. and Ruocco, G. (2009) &quot;Exploring copulas for the imputation of missing nonlinearly dependent data&quot;. Proceedings of the VII Meeting Classification and Data Analysis Group of the Italian Statistical Society (Cladag), Editors: Salvatore Ingrassia and Roberto Rocci, Cleup, p. 429-432. ISBN: 978-88-6129-406-6.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## generate data from a 4-variate Frank copula with different margins

set.seed(21)
n.marg &lt;- 4
theta  &lt;- 5
copula &lt;- frankCopula(theta, dim = n.marg)
mymvdc &lt;- mvdc(copula, c("norm", "gamma", "beta","gamma"), list(list(mean=7, sd=2),
list(shape=3, rate=2), list(shape1=4, shape2=1), list(shape=4, rate=3)))
n      &lt;- 20
x.samp &lt;- copula::rMvdc(n, mymvdc)

# randomly introduce univariate and multivariate missing

perc.mis    &lt;- 0.3
set.seed(11)
miss.row    &lt;- sample(1:n, perc.mis*n, replace=TRUE)
miss.col    &lt;- sample(1:n.marg, perc.mis*n, replace=TRUE)
miss        &lt;- cbind(miss.row,miss.col)
x.samp.miss &lt;- replace(x.samp,miss,NA)

# impute missing values

imp &lt;- CoImp(x.samp.miss, n.marg=n.marg, smoothing = rep(0.6,n.marg), plot=TRUE,
       type.data="continuous", model=list(normalCopula(0.5, dim=n.marg),
       frankCopula(10, dim=n.marg), gumbelCopula(10, dim=n.marg)));

# methods show and plot

show(imp)
plot(imp)

## Not run: 
## generate data from a 3-variate Clayton copula and introduce missing by
## using the MCAR function and try to impute through a rotated copula

set.seed(11)
n.marg &lt;- 3
theta  &lt;- 5
copula &lt;- claytonCopula(theta, dim = n.marg)
mymvdc &lt;- mvdc(copula, c("beta", "beta", "beta"), list(list(shape1=4, shape2=1),
            list(shape1=.5, shape2=.5), list(shape1=2, shape2=3)))
n      &lt;- 50
x.samp &lt;- copula::rMvdc(n, mymvdc)

# randomly introduce MCAR univariate and multivariate missing

perc.miss &lt;- 0.15
setseed   &lt;- set.seed(13)
x.samp.miss &lt;- MCAR(x.samp, perc.miss, setseed)
x.samp.miss &lt;- x.samp.miss@"db.missing"

# impute missing values

imp &lt;- CoImp(x.samp.miss, n.marg=n.marg, smoothing = c(0.45,0.2,0.5), plot=TRUE,
        q.lo=rep(0.1,n.marg), q.up=rep(0.9,n.marg), model=list(claytonCopula(0.5,
        dim=n.marg),  rotCopula(claytonCopula(0.5,dim=n.marg))));

# methods show and plot

show(imp)
plot(imp)

## End(Not run)
</code></pre>

<hr>
<h2 id='CoImp-class'>Class &quot;CoImp&quot;</h2><span id='topic+CoImp-class'></span><span id='topic+show+2CCoImp-method'></span><span id='topic+plot+2CCoImp+2Cmissing-method'></span>

<h3>Description</h3>

<p>A class for <code>CoImp</code> and its extensions</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("CoImp", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Missing.data.matrix</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Original missing data matrix to be imputed.</p>
</dd>
<dt><code>Perc.miss</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Missing and available data percentage for each variable.</p>
</dd>
<dt><code>Estimated.Model</code>:</dt><dd><p>Object of class <code>"list"</code>. The list contains:
</p>

<table>
<tr>
 <td style="text-align: left;">
            <code>model</code>    </td><td style="text-align: left;"> the copula model selected and estimated on the complete cases. </td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>dimension</code></td><td style="text-align: left;"> the dimension of the <code>model</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>parameter</code></td><td style="text-align: left;"> the estimated dependence parameter of the <code>model</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>number</code>   </td><td style="text-align: left;"> the index of the estimated model in the list of models given in input.</td>
</tr>
<tr>
 <td style="text-align: left;">
            </td>
</tr>

</table>

</dd>
<dt><code>Estimation.Method</code>:</dt><dd><p>Object of class <code>"character"</code>. The estimation method used for the copula model in <code>Estimated.Model</code>. Allowed methods are in <code><a href="copula.html#topic+fitCopula">fitCopula</a></code>.</p>
</dd>
<dt><code>Index.matrix.NA</code>:</dt><dd><p>Object of class <code>"matrix"</code>. Matrix of row and column indexes of missing data.</p>
</dd>
<dt><code>Smooth.param</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The values of the nearest neighbor component of the smoothing parameter of the <code>lp</code> function.</p>
</dd>
<dt>Imputed.data.matrix</dt><dd><p>Object of class <code>"matrix"</code>. The imputed data matrix.</p>
</dd>
<dt>Estimated.Model.Imp</dt><dd><p>Object of class <code>"list"</code>. The list contains:
</p>

<table>
<tr>
 <td style="text-align: left;">
            <code>model</code>    </td><td style="text-align: left;"> the copula model selected and estimated on the imputed cases. </td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>dimension</code></td><td style="text-align: left;"> the dimension of the <code>model</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>parameter</code></td><td style="text-align: left;"> the estimated dependence parameter of the <code>model</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
            <code>number</code>   </td><td style="text-align: left;"> the index of the estimated model in the list of models given in input.</td>
</tr>
<tr>
 <td style="text-align: left;">
            </td>
</tr>

</table>

</dd>
<dt>Estimation.Method.Imp</dt><dd><p>Object of class <code>"character"</code>.The estimation method used for the copula model in <code>Estimated.Model.Imp</code>. Allowed methods are in <code><a href="copula.html#topic+fitCopula">fitCopula</a></code>.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>plot</dt><dd><p><code>signature(x = "CoImp", y = "missing")</code>: ...</p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "CoImp")</code>: ...</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. Giannerini, S. and Reale A. (201x) &quot;A multivariate technique based on conditional copula specification for the imputation of complex dependent data&quot;. Working paper.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2015) &quot;Exploring Copulas for the Imputation of Complex Dependent Data&quot;. Statistical Methods &amp; Applications, 24(1), p. 159-175. DOI 10.1007/s10260-014-0287-2.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2014) &quot;Imputation of complex dependent data by conditional copulas: analytic versus semiparametric approach&quot;, Book of proceedings of the 21st International Conference on Computational Statistics (COMPSTAT 2014), p. 491-497. ISBN 9782839913478.
</p>
<p>Bianchi, G. Di Lascio, F.M.L. Giannerini, S. Manzari, A. Reale, A. and Ruocco, G. (2009) &quot;Exploring copulas for the imputation of missing nonlinearly dependent data&quot;. Proceedings of the VII Meeting Classification and Data Analysis Group of the Italian Statistical Society (Cladag), Editors: Salvatore Ingrassia and Roberto Rocci, Cleup, p. 429-432. ISBN: 978-88-6129-406-6.
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+CoImp">CoImp</a></code>, <code><a href="#topic+MCAR">MCAR</a></code>, <code><a href="#topic+MAR">MAR</a></code>, <code><a href="locfit.html#topic+lp">lp</a></code> and <code><a href="copula.html#topic+copula-class">copula</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("CoImp")
</code></pre>

<hr>
<h2 id='MAR'>Generation of multivariate missing at random (MAR) data</h2><span id='topic+MAR'></span>

<h3>Description</h3>

<p>Introduction of artificial missing at random (MAR) data in a given data set. Missing values are multivariate and have generic pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAR(db.complete, perc.miss = 0.3, setseed = 13, mcols = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MAR_+3A_db.complete">db.complete</code></td>
<td>
<p>the complete data matrix.</p>
</td></tr>
<tr><td><code id="MAR_+3A_perc.miss">perc.miss</code></td>
<td>
<p>the percentage of missing values to be generated.</p>
</td></tr>
<tr><td><code id="MAR_+3A_setseed">setseed</code></td>
<td>
<p>the seed for the generation of the missing values.</p>
</td></tr>
<tr><td><code id="MAR_+3A_mcols">mcols</code></td>
<td>
<p>the index of the columns in which to introduce MAR values.</p>
</td></tr>
<tr><td><code id="MAR_+3A_...">...</code></td>
<td>
<p>further parameters for <code><a href="copula.html#topic+fitCopula">fitCopula</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>





<p>MAR introduce artificial missing at random values in a given complete data set. Missing values are univariate and multivariate and have generic pattern.
</p>


<h3>Value</h3>

<p>An object of S4 class &quot;MAR&quot;, which is a list with the following element:
</p>
<table>
<tr><td><code>perc.record.missing</code></td>
<td>
<p>Object of class <code>"numeric"</code>. A percentage value.</p>
</td></tr>
<tr><td><code>db.missing</code></td>
<td>
<p>Object of class <code>"matrix"</code>. A data set with artificial multivariate MAR.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. Giannerini, S. and Reale A. (201x) &quot;A multivariate technique based on conditional copula specification for the imputation of complex dependent data&quot;. Working paper.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2015) &quot;Exploring Copulas for the Imputation of Complex Dependent Data&quot;. Statistical Methods &amp; Applications, 24(1), p. 159-175. DOI 10.1007/s10260-014-0287-2.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2014) &quot;Imputation of complex dependent data by conditional copulas: analytic versus semiparametric approach&quot;, Book of proceedings of the 21st International Conference on Computational Statistics (COMPSTAT 2014), p. 491-497. ISBN 9782839913478.
</p>
<p>Bianchi, G. Di Lascio, F.M.L. Giannerini, S. Manzari, A. Reale, A. and Ruocco, G. (2009) &quot;Exploring copulas for the imputation of missing nonlinearly dependent data&quot;. Proceedings of the VII Meeting Classification and Data Analysis Group of the Italian Statistical Society (Cladag), Editors: Salvatore Ingrassia and Roberto Rocci, Cleup, p. 429-432. ISBN: 978-88-6129-406-6.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# generate data from a 4-variate Gumbel copula with different margins

set.seed(11)
n.marg &lt;- 4
theta  &lt;- 5
copula &lt;- frankCopula(theta, dim = n.marg)
mymvdc &lt;- mvdc(copula, c("norm", "gamma", "beta","gamma"), list(list(mean=7, sd=2),
list(shape=3, rate=2), list(shape1=4, shape2=1), list(shape=4, rate=3)))
n      &lt;- 30
x.samp &lt;- rMvdc(n, mymvdc)

# apply MAR by introducing 30% of missing data

mar    &lt;- MAR(db.complete = x.samp, perc.miss = 0.3, setseed = 11)

mar
</code></pre>

<hr>
<h2 id='MAR-class'>Class &quot;MAR&quot;</h2><span id='topic+MAR-class'></span>

<h3>Description</h3>

<p>A class for <code>MAR</code> and its extensions</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("MAR", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>perc.record.missing</code>:</dt><dd><p>Object of class <code>"numeric"</code>.  A percentage value.</p>
</dd>
<dt><code>db.missing</code>:</dt><dd><p>Object of class <code>"matrix"</code>. A data set with artificial multivariate MAR with generic pattern.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "MAR")</code>: ... </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. Giannerini, S. and Reale A. (201x) &quot;A multivariate technique based on conditional copula specification for the imputation of complex dependent data&quot;. Working paper.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2015) &quot;Exploring Copulas for the Imputation of Complex Dependent Data&quot;. Statistical Methods &amp; Applications, 24(1), p. 159-175. DOI 10.1007/s10260-014-0287-2.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2014) &quot;Imputation of complex dependent data by conditional copulas: analytic versus semiparametric approach&quot;, Book of proceedings of the 21st International Conference on Computational Statistics (COMPSTAT 2014), p. 491-497. ISBN 9782839913478.
</p>
<p>Bianchi, G. Di Lascio, F.M.L. Giannerini, S. Manzari, A. Reale, A. and Ruocco, G. (2009) &quot;Exploring copulas for the imputation of missing nonlinearly dependent data&quot;. Proceedings of the VII Meeting Classification and Data Analysis Group of the Italian Statistical Society (Cladag), Editors: Salvatore Ingrassia and Roberto Rocci, Cleup, p. 429-432. ISBN: 978-88-6129-406-6.
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+CoImp">CoImp</a></code>, <code><a href="locfit.html#topic+lp">lp</a></code> and <code><a href="copula.html#topic+copula-class">copula</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("MAR")
</code></pre>

<hr>
<h2 id='MCAR'>Generation of multivariate MCAR data</h2><span id='topic+MCAR'></span>

<h3>Description</h3>

<p>Introduction of artificial missing completely at random (MCAR) data in a given data set. Missing values are multivariate and have generic pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCAR(db.complete, perc.miss = 0.3, setseed = 13, mcols = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCAR_+3A_db.complete">db.complete</code></td>
<td>
<p>the complete data matrix.</p>
</td></tr>
<tr><td><code id="MCAR_+3A_perc.miss">perc.miss</code></td>
<td>
<p>the percentage of missing value to be generated.</p>
</td></tr>
<tr><td><code id="MCAR_+3A_setseed">setseed</code></td>
<td>
<p>the seed for the generation of the missing values.</p>
</td></tr>
<tr><td><code id="MCAR_+3A_mcols">mcols</code></td>
<td>
<p>the index of the columns in which to introduce MCAR values.</p>
</td></tr>
<tr><td><code id="MCAR_+3A_...">...</code></td>
<td>
<p>further parameters for <code><a href="copula.html#topic+fitCopula">fitCopula</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>





<p>MCAR introduce artificial missing completely at random values in a given complete data set. Missing values are multivariate and have generic pattern.
</p>


<h3>Value</h3>

<p>An object of S4 class &quot;MCAR&quot;, which is a list with the following element:
</p>
<table>
<tr><td><code>db.missing</code></td>
<td>
<p>Object of class <code>"matrix"</code>. A data set with artificial multivariate MCAR.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. Giannerini, S. and Reale A. (201x) &quot;A multivariate technique based on conditional copula specification for the imputation of complex dependent data&quot;. Working paper.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2015) &quot;Exploring Copulas for the Imputation of Complex Dependent Data&quot;. Statistical Methods &amp; Applications, 24(1), p. 159-175. DOI 10.1007/s10260-014-0287-2.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2014) &quot;Imputation of complex dependent data by conditional copulas: analytic versus semiparametric approach&quot;, Book of proceedings of the 21st International Conference on Computational Statistics (COMPSTAT 2014), p. 491-497. ISBN 9782839913478.
</p>
<p>Bianchi, G. Di Lascio, F.M.L. Giannerini, S. Manzari, A. Reale, A. and Ruocco, G. (2009) &quot;Exploring copulas for the imputation of missing nonlinearly dependent data&quot;. Proceedings of the VII Meeting Classification and Data Analysis Group of the Italian Statistical Society (Cladag), Editors: Salvatore Ingrassia and Roberto Rocci, Cleup, p. 429-432. ISBN: 978-88-6129-406-6.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# generate data from a 4-variate Gumbel copula with different margins

set.seed(11)
n.marg &lt;- 4
theta  &lt;- 5
copula &lt;- frankCopula(theta, dim = n.marg)
mymvdc &lt;- mvdc(copula, c("norm", "gamma", "beta","gamma"), list(list(mean=7, sd=2),
list(shape=3, rate=2), list(shape1=4, shape2=1), list(shape=4, rate=3)))
n      &lt;- 30
x.samp &lt;- rMvdc(n, mymvdc)

# apply MCAR by introducing 30% of missing data

mcar   &lt;- MCAR(db.complete = x.samp, perc.miss = 0.3, setseed = 11)

mcar

# same example as above but introducing missing only in the first and third column

mcar2   &lt;- MCAR(db.complete = x.samp, perc.miss = 0.3, setseed = 11, mcols=c(1,3))

mcar2

</code></pre>

<hr>
<h2 id='MCAR-class'>Class &quot;MCAR&quot;</h2><span id='topic+MCAR-class'></span>

<h3>Description</h3>

<p>A class for <code>MCAR</code> and its extensions</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("MCAR", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>db.missing</code>:</dt><dd><p>Object of class <code>"matrix"</code>. A data set with artificial multivariate MCAR.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "MCAR")</code>: ... </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. Giannerini, S. and Reale A. (201x) &quot;A multivariate technique based on conditional copula specification for the imputation of complex dependent data&quot;. Working paper.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2015) &quot;Exploring Copulas for the Imputation of Complex Dependent Data&quot;. Statistical Methods &amp; Applications, 24(1), p. 159-175. DOI 10.1007/s10260-014-0287-2.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2014) &quot;Imputation of complex dependent data by conditional copulas: analytic versus semiparametric approach&quot;, Book of proceedings of the 21st International Conference on Computational Statistics (COMPSTAT 2014), p. 491-497. ISBN 9782839913478.
</p>
<p>Bianchi, G. Di Lascio, F.M.L. Giannerini, S. Manzari, A. Reale, A. and Ruocco, G. (2009) &quot;Exploring copulas for the imputation of missing nonlinearly dependent data&quot;. Proceedings of the VII Meeting Classification and Data Analysis Group of the Italian Statistical Society (Cladag), Editors: Salvatore Ingrassia and Roberto Rocci, Cleup, p. 429-432. ISBN: 978-88-6129-406-6.
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+CoImp">CoImp</a></code>, <code><a href="locfit.html#topic+lp">lp</a></code> and <code><a href="copula.html#topic+copula-class">copula</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("MCAR")
</code></pre>

<hr>
<h2 id='PerfMeasure'>Performance measures for evaluating the goodness of an imputed database</h2><span id='topic+PerfMeasure'></span>

<h3>Description</h3>

<p>Set of measures useful to evaluate the goodness of the used imputation method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PerfMeasure(db.complete, db.imputed, db.missing, n.marg = 2, model = 
                        list(normalCopula(0.5, dim=n.marg), claytonCopula(10, 
                        dim=n.marg), gumbelCopula(10, dim=n.marg), frankCopula(10, 
                        dim=n.marg), tCopula(0.5, dim=n.marg,...), 
                        rotCopula(claytonCopula(10,dim=n.marg),flip=rep(TRUE,n.marg)),
                        ...), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PerfMeasure_+3A_db.complete">db.complete</code></td>
<td>
<p>the complete data matrix.</p>
</td></tr>
<tr><td><code id="PerfMeasure_+3A_db.imputed">db.imputed</code></td>
<td>
<p>the imputed data matrix.</p>
</td></tr>
<tr><td><code id="PerfMeasure_+3A_db.missing">db.missing</code></td>
<td>
<p>the data matrix with <code>NA</code> data.</p>
</td></tr>
<tr><td><code id="PerfMeasure_+3A_n.marg">n.marg</code></td>
<td>
<p>the number of variables in db.complete.</p>
</td></tr>
<tr><td><code id="PerfMeasure_+3A_model">model</code></td>
<td>
<p>a list of copula models to be used for the imputation. See the Details section.
This should be one of <code>normal</code> and <code>t</code> (with <code>dispstr</code> as in the <code>copula</code> package), <code>frank</code>, <code>clayton</code>, <code>gumbel</code>, and <code>rotated copulas</code>.
As in <code>fitCopula</code>, itau fitting coerced tCopula to 'df.fixed=TRUE'.</p>
</td></tr>
<tr><td><code id="PerfMeasure_+3A_...">...</code></td>
<td>
<p>further parameters for <code><a href="copula.html#topic+fitCopula">fitCopula</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>









<p>PerfMeasure computes some measures useful for evaluating the goodness of the used imputation method.
PerfMeasure requires in input the imputed, the complete and the missing data matrix and gives in output
five different measures of performance. See below for details
</p>


<h3>Value</h3>

<p>An object of S4 class &quot;PerfMeasure&quot;, which is a list with the following elements:
</p>
<table>
<tr><td><code>MARE</code></td>
<td>
<p>Object of class <code>"numeric"</code>. The mean (on the replications performed) of the absolute relative error between the imputed and the corresponding original value.</p>
</td></tr>
<tr><td><code>RB</code></td>
<td>
<p>Object of class <code>"numeric"</code>. The relative bias of the estimator for the dependence parameter.</p>
</td></tr>
<tr><td><code>RRMSE</code></td>
<td>
<p>Object of class <code>"numeric"</code>. The relative root mean squared error of the estimator for the dependence parameter.</p>
</td></tr>


<tr><td><code>TID</code></td>
<td>
<p>Object of class <code>"vector"</code>. Upper and lower tail dependence indexes for bivariate copulas. Original function is in <code><a href="copula.html#topic+tailIndex">tailIndex</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. Giannerini, S. and Reale A. (201x) &quot;A multivariate technique based on conditional copula specification for the imputation of complex dependent data&quot;. Working paper.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2015) &quot;Exploring Copulas for the Imputation of Complex Dependent Data&quot;. Statistical Methods &amp; Applications, 24(1), p. 159-175. DOI 10.1007/s10260-014-0287-2.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2014) &quot;Imputation of complex dependent data by conditional copulas: analytic versus semiparametric approach&quot;, Book of proceedings of the 21st International Conference on Computational Statistics (COMPSTAT 2014), p. 491-497. ISBN 9782839913478.
</p>
<p>Bianchi, G. Di Lascio, F.M.L. Giannerini, S. Manzari, A. Reale, A. and Ruocco, G. (2009) &quot;Exploring copulas for the imputation of missing nonlinearly dependent data&quot;. Proceedings of the VII Meeting Classification and Data Analysis Group of the Italian Statistical Society (Cladag), Editors: Salvatore Ingrassia and Roberto Rocci, Cleup, p. 429-432. ISBN: 978-88-6129-406-6.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# generate data from a 4-variate Gumbel copula with different margins

set.seed(11)
n.marg &lt;- 4
theta  &lt;- 5
copula &lt;- frankCopula(theta, dim = n.marg)
mymvdc &lt;- mvdc(copula, c("norm", "gamma", "beta","gamma"), list(list(mean=7, sd=2),
 list(shape=3, rate=2), list(shape1=4, shape2=1), list(shape=4, rate=3)))
n      &lt;- 20
x.samp &lt;- rMvdc(n, mymvdc)

# randomly introduce univariate and multivariate missing

perc.mis    &lt;- 0.3
set.seed(11)
miss.row    &lt;- sample(1:n, perc.mis*n, replace=TRUE)
miss.col    &lt;- sample(1:n.marg, perc.mis*n, replace=TRUE)
miss        &lt;- cbind(miss.row,miss.col)
x.samp.miss &lt;- replace(x.samp,miss,NA)

# impute missing values

imp &lt;- CoImp(x.samp.miss, n.marg=n.marg, smoothing=rep(0.6,n.marg), plot=TRUE,
            type.data="continuous");
imp

# apply PerfMeasure to the imputed data set

pm &lt;- PerfMeasure(db.complete=x.samp, db.missing=x.samp.miss,
            db.imputed=imp@"Imputed.data.matrix", n.marg=4)
pm
str(pm)

## End(Not run)

</code></pre>

<hr>
<h2 id='PerfMeasure-class'>Class &quot;PerfMeasure&quot;</h2><span id='topic+PerfMeasure-class'></span><span id='topic+show+2CPerfMeasure-method'></span>

<h3>Description</h3>

<p>A class for <code>PerfMeasure</code> and its extensions</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("PerfMeasure", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>MARE</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The mean (on the replications performed) of the absolute relative error between the imputed and the corresponding original value.</p>
</dd>
<dt><code>RB</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The relative bias of the estimator for the dependence parameter.</p>
</dd>
<dt><code>RRMSE</code>:</dt><dd><p>Object of class <code>"numeric"</code>. The relative root mean squared error of the estimator for the dependence parameter.</p>
</dd>


<dt><code>TID</code>:</dt><dd><p>Object of class <code>"vector"</code>. Upper and lower tail dependence indexes for bivariate copulas. Original function is in <code><a href="copula.html#topic+tailIndex">tailIndex</a></code>.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "PerfMeasure")</code>: ... </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. Giannerini, S. and Reale A. (201x) &quot;A multivariate technique based on conditional copula specification for the imputation of complex dependent data&quot;. Working paper.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2015) &quot;Exploring Copulas for the Imputation of Complex Dependent Data&quot;. Statistical Methods &amp; Applications, 24(1), p. 159-175. DOI 10.1007/s10260-014-0287-2.
</p>
<p>Di Lascio, F.M.L., Giannerini, S. and Reale, A. (2014) &quot;Imputation of complex dependent data by conditional copulas: analytic versus semiparametric approach&quot;, Book of proceedings of the 21st International Conference on Computational Statistics (COMPSTAT 2014), p. 491-497. ISBN 9782839913478.
</p>
<p>Bianchi, G. Di Lascio, F.M.L. Giannerini, S. Manzari, A. Reale, A. and Ruocco, G. (2009) &quot;Exploring copulas for the imputation of missing nonlinearly dependent data&quot;. Proceedings of the VII Meeting Classification and Data Analysis Group of the Italian Statistical Society (Cladag), Editors: Salvatore Ingrassia and Roberto Rocci, Cleup, p. 429-432. ISBN: 978-88-6129-406-6.
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+CoImp">CoImp</a></code>, <code><a href="locfit.html#topic+lp">lp</a></code> and <code><a href="copula.html#topic+copula-class">copula</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("PerfMeasure")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
