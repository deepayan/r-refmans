<!DOCTYPE html><html><head><title>Help for package TUWmodel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TUWmodel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#example_TUWmodel'><p>Data-sample</p></a></li>
<li><a href='#TUWmodel'><p>Lumped hydrological model developed at the Vienna University of Technology for education purposes</p></a></li>
<li><a href='#TUWmodel_dual'><p>Lumped dual layer hydrological model developed at the Vienna University of Technology for education purposes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Lumped/Semi-Distributed Hydrological Model for Education
Purposes</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-02-25</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), stats</td>
</tr>
<tr>
<td>Description:</td>
<td>The model, developed at the Vienna University of Technology, is a lumped conceptual rainfall-runoff model, following the structure of the HBV model. 
             The model can also be run in a semi-distributed fashion and with dual representation of soil layer.
             The model runs on a daily or shorter time step and consists of a snow routine, a soil moisture routine and a flow routing routine. 
             See Parajka, J., R. Merz, G. Bloeschl (2007) &lt;<a href="https://doi.org/10.1002%2Fhyp.6253">doi:10.1002/hyp.6253</a>&gt; Uncertainty and multiple objective calibration in regional water balance modelling: case study in 320 Austrian catchments, Hydrological Processes, 21, 435-446. </td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-02-25 14:09:34 UTC; alviglio</td>
</tr>
<tr>
<td>Author:</td>
<td>Alberto Viglione [aut, cre],
  Juraj Parajka [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alberto Viglione &lt;alberto.viglione@polito.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-02-26 12:00:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='example_TUWmodel'>Data-sample</h2><span id='topic+example_TUWmodel'></span><span id='topic+Q_Vils'></span><span id='topic+P_Vils'></span><span id='topic+T_Vils'></span><span id='topic+PET_Vils'></span><span id='topic+SWE_Vils'></span><span id='topic+areas_Vils'></span>

<h3>Description</h3>

<p>Data for examples in the package
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(example_TUWmodel)
</code></pre>


<h3>Format</h3>

<p>The data are time series for the river Vils at Vils (Laende):
</p>

<ol>
<li> <p><code>Q_Vils</code> vector of observed daily discharges [mm/day];
</p>
</li>
<li> <p><code>P_Vils</code> matrix of observed daily precipitation [mm/day] for 6 zones;
</p>
</li>
<li> <p><code>T_Vils</code> matrix of observed daily temperatures [degC] for 6 zones;
</p>
</li>
<li> <p><code>PET_Vils</code> matrix of potential evapotranspiration [mm/day] for 6 zones;
</p>
</li>
<li> <p><code>SWE_Vils</code> matrix of observed snow water equivalent [mm] for 6 zones;
</p>
</li>
<li> <p><code>areas_Vils</code> areas of the 6 zones.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(example_TUWmodel)

ls()

t &lt;- as.Date(rownames(P_Vils))
plot(t, apply(P_Vils, 1, weighted.mean, w=areas_Vils), 
     type="S", xlab="", ylab="Precipitation [mm/day]")

plot(t, apply(PET_Vils, 1, weighted.mean, w=areas_Vils), 
     type="l", xlab="", ylab="Potential evapotranspiration [mm/day]")

plot(t, T_Vils[,1], type="l", xlab="", ylab="Temperature [degC]")
 lines(t, T_Vils[,6], col=3)

plot(t, SWE_Vils[,6], col=3, type="l", xlab="", ylab="Snow water equivalent [mm]")
 lines(t, SWE_Vils[,1], col=1)

plot(as.Date(names(Q_Vils)), Q_Vils, type="l", xlab="", ylab="Runoff [mm/day]")
</code></pre>

<hr>
<h2 id='TUWmodel'>Lumped hydrological model developed at the Vienna University of Technology for education purposes</h2><span id='topic+TUWmodel'></span><span id='topic+hbvmodel'></span>

<h3>Description</h3>

<p><code>TUWmodel</code> is a lumped conceptual rainfall-runoff model, following the structure of the HBV model. 
The model runs on a daily or shorter timestep and consists of a snow routine, a soil moisture routine and a flow routing routine. 
See Parajka, J., R. Merz, G. Bloeschl (2007) Uncertainty and multiple objective calibration in regional water balance modelling: case study in 320 Austrian catchments, Hydrological Processes, 21, 435-446.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> TUWmodel (prec, airt, ep, area=1, 
           param=c(1.2,1.2,2,-2,0,0.9,100,3.3,0.5,9,105,50,2,10,26.5), 
           incon=c(50,0,2.5,2.5), itsteps=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TUWmodel_+3A_prec">prec</code></td>
<td>
<p>vector/matrix of precipitation input [mm/timestep] (<code>ncol</code> = number of zones)</p>
</td></tr>
<tr><td><code id="TUWmodel_+3A_airt">airt</code></td>
<td>
<p>vector/matrix of air temperatures [degC]</p>
</td></tr>
<tr><td><code id="TUWmodel_+3A_ep">ep</code></td>
<td>
<p>vector/matrix of potential evapotranspiration [mm/timestep]</p>
</td></tr>

<tr><td><code id="TUWmodel_+3A_area">area</code></td>
<td>
<p>if more zones, vector of the percentage of area for each zone (or proportional to it, i.e., if the sum is different from 1, it will be rescaled to be 1)</p>
</td></tr>
<tr><td><code id="TUWmodel_+3A_param">param</code></td>
<td>
<p>vector/matrix of parameters (<code>ncol</code> = number of zones):
</p>

<ol>
<li> <p><code>SCF</code> snow correction factor [-] (e.g., 0.9-1.5);
</p>
</li>
<li> <p><code>DDF</code> degree day factor [mm/degC/timestep] (e.g., 0.0-5.0 mm/degC/day);
</p>
</li>
<li> <p><code>Tr</code> threshold temperature above which precipitation is rain [degC] (e.g., 1.0-3.0 degC);
</p>
</li>
<li> <p><code>Ts</code> threshold temperature below which precipitation is snow [degC] (e.g., -3.0-1.0 degC);
</p>
</li>
<li> <p><code>Tm</code> threshold temperature above which melt starts [degC] (e.g., -2.0-2.0 degC);
</p>
</li>
<li> <p><code>LPrat</code> parameter related to the limit for potential evaporation [-] (e.g., 0.0-1.0);
</p>
</li>
<li> <p><code>FC</code> field capacity, i.e., max soil moisture storage [mm] (e.g., 0-600 mm);
</p>
</li>
<li> <p><code>BETA</code> the non linear parameter for runoff production [-] (e.g., 0.0-20.0);
</p>
</li>
<li> <p><code>k0</code> storage coefficient for very fast response [timestep] (e.g., 0.0-2.0 days);
</p>
</li>
<li> <p><code>k1</code> storage coefficient for fast response [timestep] (e.g., 2.0-30.0 days);
</p>
</li>
<li> <p><code>k2</code> storage coefficient for slow response [timestep] (e.g., 30.0-250.0 days);
</p>
</li>
<li> <p><code>lsuz</code> threshold storage state, i.e., the very fast response start if exceeded [mm] (e.g., 1.0-100.0 mm);
</p>
</li>
<li> <p><code>cperc</code> constant percolation rate [mm/timestep] (e.g., 0.0-8.0 mm/day);
</p>
</li>
<li> <p><code>bmax</code> maximum base at low flows [timestep] (e.g., 0.0-30.0 days);
</p>
</li>
<li> <p><code>croute</code> free scaling parameter [timestep^2/mm] (e.g., 0.0-50.0 days^2/mm);
</p>
</li></ol>

</td></tr>
<tr><td><code id="TUWmodel_+3A_incon">incon</code></td>
<td>
<p>vector/matrix of initial conditions for the model (<code>ncol</code> = number of zones):
<code>SSM0</code> soil moisture [mm];
<code>SWE0</code> snow water equivalent [mm];
<code>SUZ0</code> initial value for fast (upper zone) response storage [mm];
<code>SLZ0</code> initial value for slow (lower zone) response storage [mm]</p>
</td></tr>
<tr><td><code id="TUWmodel_+3A_itsteps">itsteps</code></td>
<td>
<p>length of the output (if NULL all the time series are used)</p>
</td></tr>
</table>


<h3>Details</h3>


<p>More details about the model structure are given in the Appendix of
</p>
<p>Parajka, J., R. Merz, G. Bloeschl (2007) Uncertainty and multiple objective calibration in regional water balance modelling: case study in 320 Austrian catchments, Hydrological Processes, 21, 435-446, doi:10.1002/hyp.6253.
</p>
<p>An example of using <code>TUWmodel</code>, including R scripts for automatic calibration, can be found in the Supplement of 
</p>
<p>Ceola, S., et al. (2015) Virtual laboratories: new opportunities for collaborative water science, Hydrology and Earth System Sciences, 19(4), 2101-2117, doi:10.5194/hess-19-2101-2015.
</p>


<h3>Value</h3>

<p><code>TUWmodel</code> gives a vector of simulated runoff as <code>q</code> [mm/timestep], and the following vector/matrices:
</p>

<ol>
<li> <p><code>qzones</code> simulated runoff for each zone [mm/timestep];
</p>
</li>
<li> <p><code>q0</code> surface runoff [mm/timestep];
</p>
</li>
<li> <p><code>q1</code> subsurface runoff [mm/timestep];
</p>
</li>
<li> <p><code>q2</code> baseflow [mm/timestep];
</p>
</li>
<li> <p><code>rain</code> liquid precipitation [mm/timestep];
</p>
</li>
<li> <p><code>snow</code> solid precipitation [mm/timestep];
</p>
</li>
<li> <p><code>melt</code> snowmelt [mm/timestep];
</p>
</li>
<li> <p><code>moist</code> soil moisture [mm];
</p>
</li>
<li> <p><code>swe</code> snow water equivalent [mm];
</p>
</li>
<li> <p><code>eta</code> actual evapo-transpiration [mm/timestep];
</p>
</li>
<li> <p><code>suz</code> upper storage zone [mm];
</p>
</li>
<li> <p><code>slz</code> lower storage zone [mm];
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>## Load the data
data(example_TUWmodel)


## Simulate runoff and plot observed vs simulated series
## Lumped case (weighted means of the inputs)
simLump &lt;- TUWmodel(prec=apply(P_Vils, 1, weighted.mean, w=areas_Vils), 
                    airt=apply(T_Vils, 1, weighted.mean, w=areas_Vils),
                    ep=apply(PET_Vils, 1, weighted.mean, w=areas_Vils), 
                    area=sum(areas_Vils),
             param=c(1.02,1.70,2,0,-0.336,
                     0.934,121,2.52,
                     0.473,9.06,142,
                     50.1,2.38,10,25))

plot(as.Date(names(Q_Vils)), Q_Vils, type="l", xlab="", ylab="Discharges [mm/day]")
 lines(as.Date(rownames(T_Vils)), simLump$q, col=2)
legend("topleft", legend=c("Observations","Simulations"), col=c(1,2), lty=1, bty="n")

plot(as.Date(rownames(SWE_Vils)), apply(SWE_Vils, 1, weighted.mean, w=areas_Vils), 
     type="l", xlab="", ylab="Snow Water Equivalent [mm]")
 lines(as.Date(rownames(T_Vils)), simLump$swe, col=2)

## Distribute input case (6 zones)
simDist &lt;- TUWmodel(prec=P_Vils, airt=T_Vils, ep=PET_Vils, area=areas_Vils/sum(areas_Vils),
             param=c(1.02,1.70,2,0,-0.336,
                     0.934,121,2.52, 
                     0.473,9.06,142,
                     50.1,2.38,10,25))

plot(as.Date(names(Q_Vils)), Q_Vils, type="l", xlab="", ylab="Discharges [mm/day]")
 lines(as.Date(rownames(T_Vils)), simDist$q, col=2)
legend("topleft", legend=c("Observations","Simulations"), col=c(1,2), lty=1, bty="n")

plot(as.Date(rownames(SWE_Vils)), apply(SWE_Vils, 1, weighted.mean, w=areas_Vils),
     type="l", xlab="", ylab="Snow Water Equivalent [mm]")
 lines(as.Date(rownames(T_Vils)), apply(simDist$swe, 1, weighted.mean, w=areas_Vils), col=2)

## Distributed input and parameters case
parametri &lt;- matrix(rep(c(1.02,1.70,2,0,-0.336,
                          0.934,121,2.52,
                          0.473,9.06,142,
                          50.1,2.38,10,25), 6), ncol=6)
parametri[2,] &lt;- c(1.4, 1.7, 1.9, 2.2, 2.4, 3.0)
simDist2 &lt;- TUWmodel(prec=P_Vils,
                    airt=T_Vils, 
                    ep=PET_Vils, 
                    area=areas_Vils/sum(areas_Vils),
             param=parametri)

plot(as.Date(names(Q_Vils)), Q_Vils, type="l", xlab="", ylab="Discharges [mm/day]")
 lines(as.Date(rownames(T_Vils)), simDist2$q, col=2)
legend("topleft", legend=c("Observations","Simulations"), col=c(1,2), lty=1, bty="n")
</code></pre>

<hr>
<h2 id='TUWmodel_dual'>Lumped dual layer hydrological model developed at the Vienna University of Technology for education purposes</h2><span id='topic+TUWmodel_dual'></span><span id='topic+hbvmodel_dual'></span>

<h3>Description</h3>

<p><code>TUWmodel_dual</code> is a lumped conceptual rainfall-runoff model with dual representation of soil layer developed at the TUW, 
following the structure of the HBV model. The dual soil layer consists of a skin soil layer which represents the layer observed 
by satellite soil moisture sensors and a root zone soil storage which is identical with the original TUWmodel concept.
The model runs on a daily or shorter timestep and has similar structure as the original TUWmodel function.
More information about the dual layer concept and its implementation can be found in Parajka, J., V. Naeimi, G. Bloeschl 
and J. Komma (2009) Matching ERS scatterometer based soil moisture patterns with simulations of a conceptual dual layer 
hydrologic model over Austria, Hydrol. Earth Syst. Sci., 13, 259-271.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> TUWmodel_dual (prec, airt, ep, area=1, 
            param=c(1.2,1.2,2,-2,0,0.9,100,3.3,0.5,9,105,50,2,10,26.5,1,0.8,10), 
            incon=c(50,0,2.5,2.5,0), itsteps=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TUWmodel_dual_+3A_prec">prec</code></td>
<td>
<p>vector/matrix of precipitation input [mm/timestep] (<code>ncol</code> = number of zones)</p>
</td></tr>
<tr><td><code id="TUWmodel_dual_+3A_airt">airt</code></td>
<td>
<p>vector/matrix of air temperatures [degC]</p>
</td></tr>
<tr><td><code id="TUWmodel_dual_+3A_ep">ep</code></td>
<td>
<p>vector/matrix of potential evapotranspiration [mm/timestep]</p>
</td></tr>

<tr><td><code id="TUWmodel_dual_+3A_area">area</code></td>
<td>
<p>if more zones, vector of the percentage of area for each zone (or proportional to it, i.e., if the sum is different from 1, it will be rescaled to be 1)</p>
</td></tr>
<tr><td><code id="TUWmodel_dual_+3A_param">param</code></td>
<td>
<p>vector/matrix of parameters (<code>ncol</code> = number of zones):
</p>

<ol>
<li> <p><code>SCF</code> snow correction factor [-] (e.g., 0.9-1.5);
</p>
</li>
<li> <p><code>DDF</code> degree day factor [mm/degC/timestep] (e.g., 0.0-5.0 mm/degC/day);
</p>
</li>
<li> <p><code>Tr</code> threshold temperature above which precipitation is rain [degC] (e.g., 1.0-3.0 degC);
</p>
</li>
<li> <p><code>Ts</code> threshold temperature below which precipitation is snow [degC] (e.g., -3.0-1.0 degC);
</p>
</li>
<li> <p><code>Tm</code> threshold temperature above which melt starts [degC] (e.g., -2.0-2.0 degC);
</p>
</li>
<li> <p><code>LPrat</code> parameter related to the limit for potential evaporation [-] (e.g., 0.0-1.0);
</p>
</li>
<li> <p><code>FC</code> field capacity, i.e., max soil moisture storage [mm] (e.g., 0-600 mm);
</p>
</li>
<li> <p><code>BETA</code> the non linear parameter for runoff production [-] (e.g., 0.0-20.0);
</p>
</li>
<li> <p><code>k0</code> storage coefficient for very fast response [timestep] (e.g., 0.0-2.0 days);
</p>
</li>
<li> <p><code>k1</code> storage coefficient for fast response [timestep] (e.g., 2.0-30.0 days);
</p>
</li>
<li> <p><code>k2</code> storage coefficient for slow response [timestep] (e.g., 30.0-250.0 days);
</p>
</li>
<li> <p><code>lsuz</code> threshold storage state, i.e., the very fast response start if exceeded [mm] (e.g., 1.0-100.0 mm);
</p>
</li>
<li> <p><code>cperc</code> constant percolation rate [mm/timestep] (e.g., 0.0-8.0 mm/day);
</p>
</li>
<li> <p><code>bmax</code> maximum base at low flows [timestep] (e.g., 0.0-30.0 days);
</p>
</li>
<li> <p><code>croute</code> free scaling parameter [timestep^2/mm] (e.g., 0.0-50.0 days^2/mm);
</p>
</li>
<li> <p><code>fc_skin</code> field capacity, i.e., max soil moisture storage, of the top soil skin layer [mm] (e.g., 0.1-10 mm);
</p>
</li>
<li> <p><code>f_eta</code> ???? [??] (e.g., 0.7-0.95 ??);
</p>
</li>
<li> <p><code>k_moist</code> ???? [??] (e.g., 5-15 ??);
</p>
</li></ol>

</td></tr>
<tr><td><code id="TUWmodel_dual_+3A_incon">incon</code></td>
<td>
<p>vector/matrix of initial conditions for the model (<code>ncol</code> = number of zones):
<code>SSM0</code> initial value of soil moisture [mm];
<code>SWE0</code> initial value of snow water equivalent [mm];
<code>SUZ0</code> initial value for fast (upper zone) response storage [mm];
<code>SLZ0</code> initial value for slow (lower zone) response storage [mm];
<code>SSL0</code> initial value of top soil skin layer storage [mm]</p>
</td></tr>
<tr><td><code id="TUWmodel_dual_+3A_itsteps">itsteps</code></td>
<td>
<p>length of the output (if NULL all the time series are used)</p>
</td></tr>
</table>


<h3>Details</h3>


<p>More details about the model structure are given in 
</p>
<p>Parajka, J., V. Naeimi, G. Bloeschl and J. Komma (2009) Matching ERS scatterometer based soil moisture patterns with simulations of a conceptual dual layer hydrologic model over Austria, Hydrol. Earth Syst. Sci., 13, 259-271.
</p>


<h3>Value</h3>

<p><code>TUWmodel_dual</code> gives a vector of simulated runoff as <code>q</code> [mm/timestep], and the following vector/matrices:
</p>

<ol>
<li> <p><code>qzones</code> simulated runoff for each zone [mm/timestep];
</p>
</li>
<li> <p><code>q0</code> surface runoff [mm/timestep];
</p>
</li>
<li> <p><code>q1</code> subsurface runoff [mm/timestep];
</p>
</li>
<li> <p><code>q2</code> baseflow [mm/timestep];
</p>
</li>
<li> <p><code>rain</code> liquid precipitation [mm/timestep];
</p>
</li>
<li> <p><code>snow</code> solid precipitation [mm/timestep];
</p>
</li>
<li> <p><code>melt</code> snowmelt [mm/timestep];
</p>
</li>
<li> <p><code>moist</code> soil moisture [mm];
</p>
</li>
<li> <p><code>swe</code> snow water equivalent [mm];
</p>
</li>
<li> <p><code>eta</code> actual evapo-transpiration [mm/timestep];
</p>
</li>
<li> <p><code>suz</code> upper storage zone [mm];
</p>
</li>
<li> <p><code>slz</code> lower storage zone [mm];
</p>
</li>
<li> <p><code>ssl</code> top soil skin layer storage [mm];
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>## Load the data
data(example_TUWmodel)


## Simulate runoff and plot observed vs simulated series
## Lumped case (weighted means of the inputs)
simLump &lt;- TUWmodel_dual(prec=apply(P_Vils, 1, weighted.mean, w=areas_Vils), 
                     airt=apply(T_Vils, 1, weighted.mean, w=areas_Vils),
                     ep=apply(PET_Vils, 1, weighted.mean, w=areas_Vils), 
                     area=sum(areas_Vils),
              param=c(1.02,1.70,2,0,-0.336,
                      0.934,121,2.52,
                      0.473,9.06,142,
                      50.1,2.38,10,25,1,0.8,10))

plot(as.Date(names(Q_Vils)), Q_Vils, type="l", xlab="", ylab="Discharges [mm/day]")
 lines(as.Date(rownames(T_Vils)), simLump$q, col=2)
legend("topleft", legend=c("Observations","Simulations"), col=c(1,2), lty=1, bty="n")

plot(as.Date(rownames(SWE_Vils)), apply(SWE_Vils, 1, weighted.mean, w=areas_Vils), 
     type="l", xlab="", ylab="Snow Water Equivalent [mm]")
 lines(as.Date(rownames(T_Vils)), simLump$swe, col=2)

## Distribute input case (6 zones)
simDist &lt;- TUWmodel_dual(prec=P_Vils, airt=T_Vils, ep=PET_Vils, area=areas_Vils/sum(areas_Vils),
             param=c(1.02,1.70,2,0,-0.336,
                     0.934,121,2.52, 
                     0.473,9.06,142,
                     50.1,2.38,10,25,1,0.8,10))

plot(as.Date(names(Q_Vils)), Q_Vils, type="l", xlab="", ylab="Discharges [mm/day]")
 lines(as.Date(rownames(T_Vils)), simDist$q, col=2)
legend("topleft", legend=c("Observations","Simulations"), col=c(1,2), lty=1, bty="n")

plot(as.Date(rownames(SWE_Vils)), apply(SWE_Vils, 1, weighted.mean, w=areas_Vils),
     type="l", xlab="", ylab="Snow Water Equivalent [mm]")
 lines(as.Date(rownames(T_Vils)), apply(simDist$swe, 1, weighted.mean, w=areas_Vils), col=2)

## Distributed input and parameters case
parametri &lt;- matrix(rep(c(1.02,1.70,2,0,-0.336,
                          0.934,121,2.52,
                          0.473,9.06,142,
                          50.1,2.38,10,25,1,0.8,10), 6), ncol=6)
parametri[2,] &lt;- c(1.4, 1.7, 1.9, 2.2, 2.4, 3.0)
simDist2 &lt;- TUWmodel_dual(prec=P_Vils,
                      airt=T_Vils, 
                      ep=PET_Vils, 
                      area=areas_Vils/sum(areas_Vils),
                param=parametri)

plot(as.Date(names(Q_Vils)), Q_Vils, type="l", xlab="", ylab="Discharges [mm/day]")
 lines(as.Date(rownames(T_Vils)), simDist2$q, col=2)
legend("topleft", legend=c("Observations","Simulations"), col=c(1,2), lty=1, bty="n")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
