<!DOCTYPE html><html><head><title>Help for package mMARCH.AC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mMARCH.AC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ActCosinor_long2'><p>Cosinor Model for Circadian Rhythmicity for the Whole Dataset</p></a></li>
<li><a href='#ActCosinor2'><p>Cosinor Model for Circadian Rhythmicity</p></a></li>
<li><a href='#ActExtendCosinor_long2'><p>Cosinor Model for Circadian Rhythmicity for the Whole Dataset</p></a></li>
<li><a href='#ActExtendCosinor2'><p>Extended Cosinor Model for Circadian Rhythmicity</p></a></li>
<li><a href='#bin_data2'><p>Bin data into longer windows</p></a></li>
<li><a href='#create.shell'><p>Create a template shell script of mMARCH.AC</p></a></li>
<li><a href='#data.imputation'><p>Data imputation for the cleaned data with annotation</p></a></li>
<li><a href='#DataShrink'><p>Annotating the merged data for all accelerometer files in the GGIR output</p></a></li>
<li><a href='#fragmentation_long2'><p>Fragmentation Metrics for Whole Dataset</p></a></li>
<li><a href='#fragmentation2'><p>Fragmentation Metrics</p></a></li>
<li><a href='#get_mean_sd_hour'><p>get subject average of time variables</p></a></li>
<li><a href='#ggir.datatransform'><p>Transform the data and merge all accelerometer files in the GGIR output</p></a></li>
<li><a href='#ggir.summary'><p>Description of all accelerometer files in the GGIR output</p></a></li>
<li><a href='#IS_long2'><p>Interdaily Statbility for the Whole Dataset</p></a></li>
<li><a href='#IS2'><p>Interdaily Statbility</p></a></li>
<li><a href='#IV_long2'><p>Intradaily Variability for the Whole Dataset</p></a></li>
<li><a href='#IV2'><p>Intradaily Variability</p></a></li>
<li><a href='#jive.predict2'><p>Modified jive.predict function  (package: r.jive)</p></a></li>
<li><a href='#makeSleepDataMatrix'><p>Make a sleep matrix based on the sleep onset and wake up time</p></a></li>
<li><a href='#mMARCH.AC.maincall'><p>Main Call for Data Processing after Runing GGIR for Accelerometer Data</p></a></li>
<li><a href='#PAfun'><p>Timne Metrics for Whole Dataset</p></a></li>
<li><a href='#pheno.plot'><p>View phenotype variables</p></a></li>
<li><a href='#RA_long2'><p>Relative Amplitude for the Whole Datset</p></a></li>
<li><a href='#RA2'><p>Relative Amplitude</p></a></li>
<li><a href='#SVDmiss2'><p>Modified SVDmiss function (package  SpatioTemporal)</p></a></li>
<li><a href='#Time_long2'><p>Timne Metrics for Whole Dataset</p></a></li>
<li><a href='#Time2'><p>Time of A Certain activity State</p></a></li>
<li><a href='#Tvol2'><p>Total Volumen of Activity for Whole Dataset</p></a></li>
<li><a href='#wear_flag'><p>Create Wear/Nonwear Flags</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.9.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-16</td>
</tr>
<tr>
<td>Title:</td>
<td>Processing of Accelerometry Data with 'GGIR' in mMARCH</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wei Guo &lt;wei.guo3@nih.gov&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Mobile Motor Activity Research Consortium for Health (mMARCH) is a collaborative network of studies of clinical and community samples that employ common clinical, biological, and digital mobile measures across involved studies. One of the main scientific goals of mMARCH sites is developing a better understanding of the inter-relationships between accelerometry-measured physical activity (PA), sleep (SL), and circadian rhythmicity (CR) and mental and physical health in children, adolescents, and adults. Currently, there is no consensus on a standard procedure for a data processing pipeline of raw accelerometry data, and few open-source tools to facilitate their development. The R package 'GGIR' is the most prominent open-source software package that offers great functionality and tremendous user flexibility to process raw accelerometry data. However, even with 'GGIR', processing done in a harmonized and reproducible fashion requires a non-trivial amount of expertise combined with a careful implementation. In addition, novel accelerometry-derived features of PA/SL/CR capturing multiscale, time-series, functional, distributional and other complimentary aspects of accelerometry data being constantly proposed and become available via non-GGIR R implementations.  To address these issues, mMARCH developed a streamlined harmonized and reproducible pipeline for loading and cleaning raw accelerometry data, extracting features available through 'GGIR' as well as through non-GGIR R packages, implementing several data and feature quality checks, merging all features of PA/SL/CR together, and performing multiple analyses including Joint Individual Variation Explained (JIVE), an unsupervised machine learning dimension reduction technique that identifies latent factors capturing joint across and individual to each of three domains of PA/SL/CR.  In detail, the pipeline generates all necessary R/Rmd/shell files for data processing after running 'GGIR' (v2.4.0) for accelerometer data. In module 1, all csv files in the 'GGIR' output directory were read, transformed and then merged. In module 2, the 'GGIR' output files were checked and summarized in one excel sheet. In module 3, the merged data was cleaned according to the number of valid hours on each night and the number of valid days for each subject. In module 4, the cleaned activity data was imputed by the average Euclidean norm minus one (ENMO) over all the valid days for each subject. Finally, a comprehensive report of data processing was created using Rmarkdown, and the report includes few exploratory plots and multiple commonly used features extracted from minute level actigraphy data.  Reference: Guo W, Leroux A, Shou S, Cui L, Kang S, Strippoli MP, Preisig M, Zipunnikov V, Merikangas K (2022) Processing of accelerometry data with GGIR in Motor Activity Research Consortium for Health (mMARCH) Journal for the Measurement of Physical Behaviour, 6(1): 37-44.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/WeiGuoNIMH/mMARCH.AC">https://github.com/WeiGuoNIMH/mMARCH.AC</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/WeiGuoNIMH/mMARCH.AC/issues">https://github.com/WeiGuoNIMH/mMARCH.AC/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>refund, denseFLMM, dplyr, xlsx, survival, stats, tidyr, zoo,
ineq, cosinor, cosinor2, abind, accelerometry, ActCR, ActFrag,
minpack.lm, kableExtra, GGIR</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-16 15:23:04 UTC; guow4</td>
</tr>
<tr>
<td>Author:</td>
<td>Wei Guo [aut, cre],
  Andrew Leroux [aut],
  Vadim Zipunnikov [aut],
  Kathleen Merikangas [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-16 15:54:36 UTC</td>
</tr>
</table>
<hr>
<h2 id='ActCosinor_long2'>Cosinor Model for Circadian Rhythmicity for the Whole Dataset</h2><span id='topic+ActCosinor_long2'></span>

<h3>Description</h3>

<p>A parametric approach to study circadian rhythmicity assuming cosinor shape.This function is a whole dataset
wrapper for <code>ActCosinor</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ActCosinor_long2(count.data, window = 1, daylevel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ActCosinor_long2_+3A_count.data">count.data</code></td>
<td>
<p><code>data.frame</code> of dimension n * (p+2) containing the
p dimensional activity data for all n subject days.
The first two columns have to be ID and Day. ID can be
either <code>character</code> or <code>numeric</code>. Day has to be <code>numeric</code> indicating
the sequence of days within each subject.</p>
</td></tr>
<tr><td><code id="ActCosinor_long2_+3A_window">window</code></td>
<td>
<p><code>numeric</code> The calculation needs the window size of the data. E.g window = 1 means each epoch is in one-minute window.</p>
</td></tr>
<tr><td><code id="ActCosinor_long2_+3A_daylevel">daylevel</code></td>
<td>
<p><code>logical</code>   If the cosinor model was run for day-level data. The default value is FALSE while the activity data for all days were used for model fitting. When the value is TRUE, the single day data were used for model fitting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the following 5 columns
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>ID</p>
</td></tr>
<tr><td><code>ndays</code></td>
<td>
<p>number of days</p>
</td></tr>
<tr><td><code>mes</code></td>
<td>
<p>MESRO, which is short for midline statistics of rhythm, which is a rhythm adjusted mean. This represents mean activity level.</p>
</td></tr>
<tr><td><code>amp</code></td>
<td>
<p>amplitude, a measure of half the extend of predictable variation within a cycle. This represents the highest activity one can achieve.</p>
</td></tr>
<tr><td><code>acro</code></td>
<td>
<p>acrophase, a meaure of the time of the overall high values recurring in each cycle. Here it has a unit of radian. This represents time to reach the peak.</p>
</td></tr>
<tr><td><code>acrotime</code></td>
<td>
<p>acrophase in the unit of the time (hours)</p>
</td></tr>
<tr><td><code>ndays</code></td>
<td>
<p>Number of days modeled</p>
</td></tr>
</table>

<hr>
<h2 id='ActCosinor2'>Cosinor Model for Circadian Rhythmicity</h2><span id='topic+ActCosinor2'></span>

<h3>Description</h3>

<p>A parametric approach to study circadian rhythmicity assuming cosinor shape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ActCosinor2(x, window = 1, n1440 = 1440)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ActCosinor2_+3A_x">x</code></td>
<td>
<p><code>vector</code> vector of dimension n*1440 which reprsents n days of 1440 minute activity data</p>
</td></tr>
<tr><td><code id="ActCosinor2_+3A_window">window</code></td>
<td>
<p>The calculation needs the window size of the data. E.g window = 1 means each epoch is in one-minute window.</p>
</td></tr>
<tr><td><code id="ActCosinor2_+3A_n1440">n1440</code></td>
<td>
<p>the number of points of a day. Default is 1440 for the minute-level data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr><td><code>mes</code></td>
<td>
<p>MESOR which is short for midline statistics of rhythm, which is a rhythm adjusted mean. This represents mean activity level.</p>
</td></tr>
<tr><td><code>amp</code></td>
<td>
<p>amplitude, a measure of half the extend of predictable variation within a cycle. This represents the highest activity one can achieve.</p>
</td></tr>
<tr><td><code>acro</code></td>
<td>
<p>acrophase, a meaure of the time of the overall high values recurring in each cycle. Here it has a unit of radian. This represents time to reach the peak.</p>
</td></tr>
<tr><td><code>acrotime</code></td>
<td>
<p>acrophase in the unit of the time (hours)</p>
</td></tr>
<tr><td><code>ndays</code></td>
<td>
<p>Number of days modeled</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cornelissen, G. Cosinor-based rhythmometry. Theor Biol Med Model 11, 16 (2014). https://doi.org/10.1186/1742-4682-11-16
</p>

<hr>
<h2 id='ActExtendCosinor_long2'>Cosinor Model for Circadian Rhythmicity for the Whole Dataset</h2><span id='topic+ActExtendCosinor_long2'></span>

<h3>Description</h3>

<p>Extended cosinor model based on sigmoidally transformed cosine curve using anti-logistic transformation.This function is a whole dataset
wrapper for <code>ActExtendCosinor</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ActExtendCosinor_long2(
  count.data,
  window = 1,
  lower = c(0, 0, -1, 0, -3),
  upper = c(Inf, Inf, 1, Inf, 27),
  daylevel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ActExtendCosinor_long2_+3A_count.data">count.data</code></td>
<td>
<p><code>data.frame</code> of dimension n * (p+2) containing the
p dimensional activity data for all n subject days.
The first two columns have to be ID and Day. ID can be
either <code>character</code> or <code>numeric</code>. Day has to be <code>numeric</code> indicating
the sequence of days within each subject.</p>
</td></tr>
<tr><td><code id="ActExtendCosinor_long2_+3A_window">window</code></td>
<td>
<p><code>numeric</code> The calculation needs the window size of the data. E.g window = 1 means each epoch is in one-minute window.
window size as an argument.</p>
</td></tr>
<tr><td><code id="ActExtendCosinor_long2_+3A_lower">lower</code></td>
<td>
<p><code>numeric</code> A numeric vector of lower bounds on each of the five parameters (in the order of minimum, amplitude, alpha, beta, acrophase) for the NLS. If not given, the default lower bound for each parameter is set to <code>-Inf</code>.</p>
</td></tr>
<tr><td><code id="ActExtendCosinor_long2_+3A_upper">upper</code></td>
<td>
<p><code>numeric</code> A numeric vector of upper bounds on each of the five parameters (in the order of minimum, amplitude, alpha, beta, acrophase) for the NLS. If not given, the default lower bound for each parameter is set to <code>Inf</code></p>
</td></tr>
<tr><td><code id="ActExtendCosinor_long2_+3A_daylevel">daylevel</code></td>
<td>
<p><code>logical</code>  If the cosinor model was run for day-level data. The default value is FALSE while the activity data for all days were used for model fitting. When the value is TRUE, the single day data were used for model fitting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the following 5 columns
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>ID</p>
</td></tr>
<tr><td><code>ndays</code></td>
<td>
<p>number of days</p>
</td></tr>
<tr><td><code>minimum</code></td>
<td>
<p>Minimum value of the of the function.</p>
</td></tr>
<tr><td><code>amp</code></td>
<td>
<p>amplitude, a measure of half the extend of predictable variation within a cycle. This represents the highest activity one can achieve.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>It determines whether the peaks of the curve are wider than the troughs: when alpha is small, the troughs are narrow and the peaks are wide; when alpha is large, the troughs are wide and the peaks are narrow.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>It dertermines whether the transformed function rises and falls more steeply than the cosine curve: large values of beta produce curves that are nearly square waves.</p>
</td></tr>
<tr><td><code>acrotime</code></td>
<td>
<p>acrophase is the time of day of the peak in the unit of the time (hours)</p>
</td></tr>
<tr><td><code>F_pseudo</code></td>
<td>
<p>Measure the improvement of the fit obtained by the non-linear estimation of the transformed cosine model</p>
</td></tr>
<tr><td><code>UpMesor</code></td>
<td>
<p>Time of day of switch from low to high activity. Represents the timing of the rest- activity rhythm. Lower (earlier) values indicate increase in activity earlier in the day and suggest a more advanced circadian phase.</p>
</td></tr>
<tr><td><code>DownMesor</code></td>
<td>
<p>Time of day of switch from high to low activity. Represents the timing of the rest-activity rhythm. Lower (earlier) values indicate decline in activity earlier in the day, suggesting a more advanced circadian phase.</p>
</td></tr>
<tr><td><code>MESOR</code></td>
<td>
<p>A measure analogous to the MESOR of the cosine model (or half the deflection of the curve) can be obtained from mes=min+amp/2. However, it goes through the middle of the peak, and is therefore not equal to the MESOR of the cosine model, which is the mean of the data.</p>
</td></tr>
</table>

<hr>
<h2 id='ActExtendCosinor2'>Extended Cosinor Model for Circadian Rhythmicity</h2><span id='topic+ActExtendCosinor2'></span>

<h3>Description</h3>

<p>Extended cosinor model based on sigmoidally transformed cosine curve using anti-logistic transformation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ActExtendCosinor2(
  x,
  window = 1,
  lower = c(0, 0, -1, 0, -3),
  upper = c(Inf, Inf, 1, Inf, 27),
  n1440 = 1440
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ActExtendCosinor2_+3A_x">x</code></td>
<td>
<p><code>vector</code> vector of dimension n*1440 which represents n days of 1440 minute activity data</p>
</td></tr>
<tr><td><code id="ActExtendCosinor2_+3A_window">window</code></td>
<td>
<p>The calculation needs the window size of the data. E.g window = 1 means each epoch is in one-minute window.</p>
</td></tr>
<tr><td><code id="ActExtendCosinor2_+3A_lower">lower</code></td>
<td>
<p>A numeric vector of lower bounds on each of the five parameters (in the order of minimum, amplitude, alpha, beta, acrophase) for the NLS. If not given, the default lower bound for each parameter is set to <code>-Inf</code>.</p>
</td></tr>
<tr><td><code id="ActExtendCosinor2_+3A_upper">upper</code></td>
<td>
<p>A numeric vector of upper bounds on each of the five parameters (in the order of minimum, amplitude, alpha, beta, acrophase) for the NLS. If not given, the default lower bound for each parameter is set to <code>Inf</code></p>
</td></tr>
<tr><td><code id="ActExtendCosinor2_+3A_n1440">n1440</code></td>
<td>
<p>the number of points of a day. Default is 1440 for the minute-level data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr><td><code>minimum</code></td>
<td>
<p>Minimum value of the of the function.</p>
</td></tr>
<tr><td><code>amp</code></td>
<td>
<p>amplitude, a measure of half the extend of predictable variation within a cycle. This represents the highest activity one can achieve.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>It determines whether the peaks of the curve are wider than the troughs: when alpha is small, the troughs are narrow and the peaks are wide; when alpha is large, the troughs are wide and the peaks are narrow.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>It dertermines whether the transformed function rises and falls more steeply than the cosine curve: large values of beta produce curves that are nearly square waves.</p>
</td></tr>
<tr><td><code>acrotime</code></td>
<td>
<p>acrophase is the time of day of the peak in the unit of the time (hours)</p>
</td></tr>
<tr><td><code>F_pseudo</code></td>
<td>
<p>Measure the improvement of the fit obtained by the non-linear estimation of the transformed cosine model</p>
</td></tr>
<tr><td><code>UpMesor</code></td>
<td>
<p>Time of day of switch from low to high activity. Represents the timing of the rest- activity rhythm. Lower (earlier) values indicate increase in activity earlier in the day and suggest a more advanced circadian phase.</p>
</td></tr>
<tr><td><code>DownMesor</code></td>
<td>
<p>Time of day of switch from high to low activity. Represents the timing of the rest-activity rhythm. Lower (earlier) values indicate decline in activity earlier in the day, suggesting a more advanced circadian phase.</p>
</td></tr>
<tr><td><code>MESOR</code></td>
<td>
<p>A measure analogous to the MESOR of the cosine model (or half the deflection of the curve) can be obtained from mes=min+amp/2. However, it goes through the middle of the peak, and is therefore not equal to the MESOR of the cosine model, which is the mean of the data.</p>
</td></tr>
<tr><td><code>ndays</code></td>
<td>
<p>Number of days modeled.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Marler MR, Gehrman P, Martin JL, Ancoli-Israel S. The sigmoidally transformed cosine curve: a mathematical model for circadian rhythms with symmetric non-sinusoidal shapes. Stat Med.
</p>

<hr>
<h2 id='bin_data2'>Bin data into longer windows</h2><span id='topic+bin_data2'></span>

<h3>Description</h3>

<p>Bin minute level data into different time resolutions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin_data2(x = x, window = 1, method = c("average", "sum"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bin_data2_+3A_x">x</code></td>
<td>
<p><code>vector</code> of activity data.</p>
</td></tr>
<tr><td><code id="bin_data2_+3A_window">window</code></td>
<td>
<p>window size used to bin the original 1440 dimensional data into. Window size
should be an integer factor of 1440</p>
</td></tr>
<tr><td><code id="bin_data2_+3A_method">method</code></td>
<td>
<p><code>character</code> of &quot;sum&quot; or &quot;average&quot;, function used to bin the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of binned data
</p>

<hr>
<h2 id='create.shell'>Create a template shell script of mMARCH.AC</h2><span id='topic+create.shell'></span>

<h3>Description</h3>

<p>Create a template shell script of mMARCH.AC, named as STUDYNAME_part0.maincall.R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.shell()
</code></pre>


<h3>Value</h3>

<p>The function will create a template shell script of mMARCH.AC in the current directory, names as STUDYNAME_part0.maincall.R
</p>

<hr>
<h2 id='data.imputation'>Data imputation for the cleaned data with annotation</h2><span id='topic+data.imputation'></span>

<h3>Description</h3>

<p>Data imputation for the merged ENMO data with annotation. The missing values were imputated by the average ENMO over all the valid days for each subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.imputation(workdir, csvInput = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.imputation_+3A_workdir">workdir</code></td>
<td>
<p><code>character</code> Directory where the output needs to be stored. Note that this directory must exist.</p>
</td></tr>
<tr><td><code id="data.imputation_+3A_csvinput">csvInput</code></td>
<td>
<p><code>character</code> File name with or without directory for sample information in CSV format. The ENMO data will be read through read.csv(csvInput,header=1) command, and the missing values were imputated by the average ENMO over all the valid days for each subject at each time point. In this package, csvInput =  flag_All_studyname_ENMO.data.Xs.csv.  If csvInput=NULL, all available data from module 3 will be imputed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Files were written to the specified sub-directory, named as impu.flag_All_studyname_ENMO.data.Xs.csv, which Xs is the epoch size to which acceleration was averaged (seconds) in GGIR output.  This excel file includs the following columns,
</p>
<table>
<tr><td><code>filename</code></td>
<td>
<p>accelerometer file name </p>
</td></tr> 
<tr><td><code>Date</code></td>
<td>
<p>date recored from the GGIR part2.summary file </p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p>IDs recored from the GGIR part2.summary file </p>
</td></tr>
<tr><td><code>calender_date</code></td>
<td>
<p>date in the format of yyyy-mm-dd </p>
</td></tr>
<tr><td><code>N.valid.hours</code></td>
<td>
<p>number of hours with valid data recored from the part2_daysummary.csv file in the GGIR output </p>
</td></tr>
<tr><td><code>N.hours</code></td>
<td>
<p>number of hours of measurement recored from the part2_daysummary.csv file in the GGIR output </p>
</td></tr>
<tr><td><code>weekday</code></td>
<td>
<p>day of the week-Day of the week </p>
</td></tr>
<tr><td><code>measurementday</code></td>
<td>
<p>day of measurement-Day number relative to start of the measurement </p>
</td></tr>
<tr><td><code>newID</code></td>
<td>
<p>new IDs defined as the user-defined function of filename2id(), e.g. substrings of the filename </p>
</td></tr> 
<tr><td><code>Nmiss_c9_c31</code></td>
<td>
<p>number of NAs from the 9th to 31th column in the part2_daysummary.csv file in the GGIR output</p>
</td></tr> 
<tr><td><code>missing</code></td>
<td>
<p>&quot;M&quot; indicates missing for an invalid day, and  &quot;C&quot; indicates completeness for a valid day </p>
</td></tr>
<tr><td><code>Ndays</code></td>
<td>
<p>number of days of measurement  </p>
</td></tr>
<tr><td><code>ith_day</code></td>
<td>
<p>rank of the measurementday, for example, the value is 1,2,3,4,-3,-2,-1 for measurementday = 1,...,7 </p>
</td></tr>
<tr><td><code>Nmiss</code></td>
<td>
<p>number of missing (invalid) days  </p>
</td></tr>
<tr><td><code>Nnonmiss</code></td>
<td>
<p>number of non-missing (valid) days </p>
</td></tr> 
<tr><td><code>misspattern</code></td>
<td>
<p>indicators of missing/nonmissing for all measurement days at the subject level </p>
</td></tr>
<tr><td><code>RowNonWear</code></td>
<td>
<p>number of columnns in the non-wearing matrix </p>
</td></tr>
<tr><td><code>NonWearMin</code></td>
<td>
<p>number of minutes of non-wearing</p>
</td></tr>
<tr><td><code>daysleeper</code></td>
<td>
<p>If 0 then the person is a nightsleeper (sleep period did not overlap with noon) if value=1 then the person is a daysleeper (sleep period did overlap with noon).</p>
</td></tr>  	
<tr><td><code>remove16h7day</code></td>
<td>
<p>indicator of a key qulity control output. If remove16h7day=1, the day need to be removed. If remove16h7day=0, the day need to be kept.</p>
</td></tr>   
<tr><td><code>duplicate</code></td>
<td>
<p>If duplicate=&quot;remove&quot;,  the accelerometer files will not be used in the data analysis of module5.</p>
</td></tr> 
<tr><td><code>ImpuMiss.b</code></td>
<td>
<p>number of missing values on the ENMO data before imputation</p>
</td></tr>	
<tr><td><code>ImpuMiss.a</code></td>
<td>
<p>number of missing values on the ENMO data after imputation</p>
</td></tr>		
<tr><td><code>KEEP</code></td>
<td>
<p>The value is &quot;keep&quot;/&quot;remove&quot;, e.g. KEEP=&quot;remove&quot; if remove16h7day=1 or duplicate=&quot;remove&quot; or ImpuMiss.a&gt;0</p>
</td></tr>
</table>

<hr>
<h2 id='DataShrink'>Annotating the merged data for all accelerometer files in the GGIR output</h2><span id='topic+DataShrink'></span>

<h3>Description</h3>

<p>Annotating the merged ENMO/ANGLEZ data by adding some descriptive variables such as number of valid days and missing pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DataShrink(
  studyname,
  outputdir,
  workdir,
  QCdays.alpha = 7,
  QChours.alpha = 16,
  summaryFN = "../summary/part24daysummary.info.csv",
  epochIn = 5,
  epochOut = 60,
  useIDs.FN = NULL,
  RemoveDaySleeper = FALSE,
  trace = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DataShrink_+3A_studyname">studyname</code></td>
<td>
<p><code>character</code> Specify the study name that used in the output file names</p>
</td></tr>
<tr><td><code id="DataShrink_+3A_outputdir">outputdir</code></td>
<td>
<p><code>character</code> Directory where the GGIR output was stored.</p>
</td></tr>
<tr><td><code id="DataShrink_+3A_workdir">workdir</code></td>
<td>
<p><code>character</code> Directory where the output needs to be stored. Note that this directory must exist.</p>
</td></tr>
<tr><td><code id="DataShrink_+3A_qcdays.alpha">QCdays.alpha</code></td>
<td>
<p><code>number</code>  Minimum required number of valid days in subject specific analysis as a quality control step in module2. Default is 7 days.</p>
</td></tr>
<tr><td><code id="DataShrink_+3A_qchours.alpha">QChours.alpha</code></td>
<td>
<p><code>number</code>  Minimum required number of valid hours in day specific analysis as a quality control step in module2. Default is 16 hours.</p>
</td></tr>
<tr><td><code id="DataShrink_+3A_summaryfn">summaryFN</code></td>
<td>
<p><code>character</code> Filename with or without directory for sample information in CSV format, which includes summary description of each accelerometer file. Some description will be extracted and merged into the ENMO/ANGLEZ data.</p>
</td></tr>
<tr><td><code id="DataShrink_+3A_epochin">epochIn</code></td>
<td>
<p><code>number</code>  Epoch size to which acceleration was averaged (seconds) in GGIR output. Defaut is 5 seconds.</p>
</td></tr>
<tr><td><code id="DataShrink_+3A_epochout">epochOut</code></td>
<td>
<p><code>number</code>  Epoch size to which acceleration was averaged (seconds) in module1. Defaut is 60 seconds.</p>
</td></tr>
<tr><td><code id="DataShrink_+3A_useids.fn">useIDs.FN</code></td>
<td>
<p><code>character</code> Filename with or without directory for sample information in CSV format, which inclues &quot;filename&quot; and &quot;duplicate&quot; in the headlines at least. If duplicate=&quot;remove&quot;,  the accelerometer files will not be used in the data analysis of module 5-7. Defaut is NULL, which makes all accelerometer files will be used in module 5-7.</p>
</td></tr>
<tr><td><code id="DataShrink_+3A_removedaysleeper">RemoveDaySleeper</code></td>
<td>
<p><code>logical</code>  Specify if the daysleeper nights are removed from the calculation of number of valid days for each subject. Default is FALSE.</p>
</td></tr>
<tr><td><code id="DataShrink_+3A_trace">trace</code></td>
<td>
<p><code>logical</code>  Specify if the intermediate results is printed when the function was executed. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Files were written to the specified sub-directory, named as flag_ALL_studyname_ENMO.data.Xs.csv and flag_ALL_studyname_ANGLEZ.data.Xs.csv, which Xs is the epoch size to which acceleration was averaged (seconds) in GGIR output.  This excel file includs the following columns, 
</p>
<table>
<tr><td><code>filename</code></td>
<td>
<p>accelerometer file name </p>
</td></tr> 
<tr><td><code>Date</code></td>
<td>
<p>date recored from the GGIR part2.summary file </p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p>IDs recored from the GGIR part2.summary file </p>
</td></tr>
<tr><td><code>calender_date</code></td>
<td>
<p>date in the format of yyyy-mm-dd </p>
</td></tr>
<tr><td><code>N.valid.hours</code></td>
<td>
<p>number of hours with valid data recored from the part2_daysummary.csv file in the GGIR output </p>
</td></tr>
<tr><td><code>N.hours</code></td>
<td>
<p>number of hours of measurement recored from the part2_daysummary.csv file in the GGIR output </p>
</td></tr>
<tr><td><code>weekday</code></td>
<td>
<p>day of the week-Day of the week </p>
</td></tr>
<tr><td><code>measurementday</code></td>
<td>
<p>day of measurement-Day number relative to start of the measurement </p>
</td></tr>
<tr><td><code>newID</code></td>
<td>
<p>new IDs defined as the user-defined function of filename2id(), e.g. substrings of the filename </p>
</td></tr> 
<tr><td><code>Nmiss_c9_c31</code></td>
<td>
<p>number of NAs from the 9th to 31th column in the part2_daysummary.csv file in the GGIR output</p>
</td></tr> 
<tr><td><code>missing</code></td>
<td>
<p>&quot;M&quot; indicates missing for an invalid day, and  &quot;C&quot; indicates completeness for a valid day </p>
</td></tr>
<tr><td><code>Ndays</code></td>
<td>
<p>number of days of measurement  </p>
</td></tr>
<tr><td><code>ith_day</code></td>
<td>
<p>rank of the measurementday, for example, the value is 1,2,3,4,-3,-2,-1 for measurementday = 1,...,7 </p>
</td></tr>
<tr><td><code>Nmissday</code></td>
<td>
<p>number of missing (invalid) days  </p>
</td></tr>
<tr><td><code>Nnonmiss</code></td>
<td>
<p>number of non-missing (valid) days </p>
</td></tr> 
<tr><td><code>misspattern</code></td>
<td>
<p>indicators of missing/nonmissing for all measurement days at the subject level </p>
</td></tr>
<tr><td><code>RowNonWear</code></td>
<td>
<p>number of columnns in the non-wearing matrix </p>
</td></tr>
<tr><td><code>NonWearMin</code></td>
<td>
<p>number of minutes of non-wearing</p>
</td></tr>
<tr><td><code>Nvalid.day</code></td>
<td>
<p>number of valid days with/without removing daysleeper nights; It is equal to Nnonmiss when RemoveDaySleeper=FALSE.</p>
</td></tr>	
<tr><td><code>daysleeper</code></td>
<td>
<p>If 0 then the person is a nightsleeper (sleep period did not overlap with noon) if value=1 then the person is a daysleeper (sleep period did overlap with noon) at the night. This is a night-level varialbe.</p>
</td></tr>  
<tr><td><code>remove16h7day</code></td>
<td>
<p>indicator of a key qulity control output. If remove16h7day=1, the day need to be removed. If remove16h7day=0, the day need to be kept.</p>
</td></tr>   
<tr><td><code>duplicate</code></td>
<td>
<p>If duplicate=&quot;remove&quot;,  the accelerometer files will not be used in the data analysis of module5-7.</p>
</td></tr>
</table>

<hr>
<h2 id='fragmentation_long2'>Fragmentation Metrics for Whole Dataset</h2><span id='topic+fragmentation_long2'></span>

<h3>Description</h3>

<p>Fragmentation methods to study the transition between two states, e.g.
sedentary v.s. active.This function is a whole dataset wrapper for <code>fragmentation</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fragmentation_long2(
  count.data,
  weartime,
  thresh,
  bout.length = 1,
  metrics = c("mean_bout", "TP", "Gini", "power", "hazard", "all"),
  by = c("day", "subject")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fragmentation_long2_+3A_count.data">count.data</code></td>
<td>
<p><code>data.frame</code> of dimension n*1442 containing the 1440 minutes of activity data for all n subject days.
The first two columns have to be ID and Day. ID can be either <code>character</code> or <code>numeric</code>. Day has to be <code>numeric</code> indicating
the sequency of days within each subject.</p>
</td></tr>
<tr><td><code id="fragmentation_long2_+3A_weartime">weartime</code></td>
<td>
<p><code>data.frame</code> with dimension of <code>count.data</code>.
The first two columns have to be ID and Day.ID can be either <code>character</code> or <code>numeric</code>. Day has to be <code>numeric</code> indicating
the sequencey of days within each subject.</p>
</td></tr>
<tr><td><code id="fragmentation_long2_+3A_thresh">thresh</code></td>
<td>
<p>threshold to define the two states.</p>
</td></tr>
<tr><td><code id="fragmentation_long2_+3A_bout.length">bout.length</code></td>
<td>
<p>minimum duration of defining an active bout; defaults to 1.</p>
</td></tr>
<tr><td><code id="fragmentation_long2_+3A_metrics">metrics</code></td>
<td>
<p>What is the fragmentation metrics to exract. Can be
&quot;mean_bout&quot;,&quot;TP&quot;,&quot;Gini&quot;,&quot;power&quot;,&quot;hazard&quot;,or all the above metrics &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="fragmentation_long2_+3A_by">by</code></td>
<td>
<p>Determine whether fragmentation is calcualted by day or by subjects (i.e. aggregate bouts across days).
by-subject is recommended to gain more power.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Metrics include
mean_bout (mean bout duration),
TP (between states transition probability),
Gini (gini index),
power (alapha parameter for power law distribution)
hazard (average hazard function)
</p>


<h3>Value</h3>

<p>A dataframe with some of the following columns
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>identifier of the person</p>
</td></tr>
<tr><td><code>Day</code></td>
<td>
<p><code>numeric</code> vector indicating the sequencey of days within each subject. </p>
</td></tr>
<tr><td><code>mean_r</code></td>
<td>
<p>mean sedentary bout duration</p>
</td></tr>
<tr><td><code>mean_a</code></td>
<td>
<p>mean active bout duration</p>
</td></tr>
<tr><td><code>SATP</code></td>
<td>
<p>sedentary to active transition probability</p>
</td></tr>
<tr><td><code>ASTP</code></td>
<td>
<p>bactive to sedentary transition probability</p>
</td></tr>
<tr><td><code>Gini_r</code></td>
<td>
<p>Gini index for active bout</p>
</td></tr>
<tr><td><code>Gini_a</code></td>
<td>
<p>Gini index for sedentary bout</p>
</td></tr>
<tr><td><code>h_r</code></td>
<td>
<p>hazard function for sedentary bout</p>
</td></tr>
<tr><td><code>h_a</code></td>
<td>
<p>hazard function for active bout</p>
</td></tr>
<tr><td><code>alpha_r</code></td>
<td>
<p>power law parameter for sedentary bout</p>
</td></tr>
<tr><td><code>alpha_a</code></td>
<td>
<p>power law parameter for active bout</p>
</td></tr>
</table>

<hr>
<h2 id='fragmentation2'>Fragmentation Metrics</h2><span id='topic+fragmentation2'></span>

<h3>Description</h3>

<p>Fragmentation methods to study the transition between two states, e.g.
sedentary v.s. active.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fragmentation2(
  x,
  w,
  thresh,
  bout.length = 1,
  metrics = c("mean_bout", "TP", "Gini", "power", "hazard", "all")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fragmentation2_+3A_x">x</code></td>
<td>
<p><code>integer</code> <code>vector</code> of activity data.</p>
</td></tr>
<tr><td><code id="fragmentation2_+3A_w">w</code></td>
<td>
<p><code>vector</code> of wear flag data with same dimension as <code>x</code>.</p>
</td></tr>
<tr><td><code id="fragmentation2_+3A_thresh">thresh</code></td>
<td>
<p>threshold to binarize the data.</p>
</td></tr>
<tr><td><code id="fragmentation2_+3A_bout.length">bout.length</code></td>
<td>
<p>minimum duration of defining an active bout; defaults to 1.</p>
</td></tr>
<tr><td><code id="fragmentation2_+3A_metrics">metrics</code></td>
<td>
<p>What is the fragmentation metrics to exract. Can be
&quot;mean_bout&quot;,&quot;TP&quot;,&quot;Gini&quot;,&quot;power&quot;,&quot;hazard&quot;,or all the above metrics &quot;all&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Metrics include
mean_bout (mean bout duration),
TP (between states transition probability),
Gini (gini index),
power (alapha parameter for power law distribution)
hazard (average hazard function)
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr><td><code>mean_r</code></td>
<td>
<p>mean sedentary bout duration</p>
</td></tr>
<tr><td><code>mean_a</code></td>
<td>
<p>mean active bout duration</p>
</td></tr>
<tr><td><code>SATP</code></td>
<td>
<p>sedentary to active transition probability</p>
</td></tr>
<tr><td><code>ASTP</code></td>
<td>
<p>bactive to sedentary transition probability</p>
</td></tr>
<tr><td><code>Gini_r</code></td>
<td>
<p>Gini index for active bout</p>
</td></tr>
<tr><td><code>Gini_a</code></td>
<td>
<p>Gini index for sedentary bout</p>
</td></tr>
<tr><td><code>h_r</code></td>
<td>
<p>hazard function for sedentary bout</p>
</td></tr>
<tr><td><code>h_a</code></td>
<td>
<p>hazard function for active bout</p>
</td></tr>
<tr><td><code>alpha_r</code></td>
<td>
<p>power law parameter for sedentary bout</p>
</td></tr>
<tr><td><code>alpha_a</code></td>
<td>
<p>power law parameter for active bout</p>
</td></tr>
</table>


<h3>References</h3>

<p>Junrui Di, Andrew Leroux, Jacek Urbanek, Ravi Varadhan, Adam P. Spira, Jennifer Schrack, Vadim Zipunnikov.
Patterns of sedentary and active time accumulation are associated with mortality in US adults: The NHANES study. bioRxiv 182337; doi: https://doi.org/10.1101/182337
</p>

<hr>
<h2 id='get_mean_sd_hour'>get subject average of time variables</h2><span id='topic+get_mean_sd_hour'></span>

<h3>Description</h3>

<p>A function for calcualting the average timing of variables (in this case the M10 and L5).  Find the average timing mu that min sum  min[ (tind_i - mu)^2, (1440 + mu - tind_i )^2 ]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mean_sd_hour(tind, unit2minute = 60, out = c("mean", "sd"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mean_sd_hour_+3A_tind">tind</code></td>
<td>
<p><code>numeric</code> A vector of times which we want to get an average/sd for. The first two columns have to be ID and Day.</p>
</td></tr>
<tr><td><code id="get_mean_sd_hour_+3A_unit2minute">unit2minute</code></td>
<td>
<p><code>numeric</code> The ratio of the unit of time and minute. For example, the input unit is hour, the unit2minute = 60.</p>
</td></tr>
<tr><td><code id="get_mean_sd_hour_+3A_out">out</code></td>
<td>
<p><code>character</code> Specify get the mean or sd of the time variables. Default=c(&quot;mean&quot;,&quot;sd&quot;) when both mean and sd are calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean and sd of the input timing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=c(1,1,1,23,23,23) 
get_mean_sd_hour(tind=x,  unit2minute=60) 
x=12+c(1,1,1,23,23,23) 
get_mean_sd_hour(tind=x,  unit2minute=60)   
x=c(1:100/5, 20+4:50/200) 
get_mean_sd_hour(tind=x,  unit2minute=60)

</code></pre>

<hr>
<h2 id='ggir.datatransform'>Transform the data and merge all accelerometer files in the GGIR output</h2><span id='topic+ggir.datatransform'></span>

<h3>Description</h3>

<p>An accelerometer file was transformed into wide data matrix, in which the rows represent available days and the columns including all timestamps for 24 hours. Further, the wide data was merged together.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggir.datatransform(
  outputdir,
  subdir,
  studyname,
  numericID = FALSE,
  sortByid = "newID",
  f0 = 1,
  f1 = 1e+06,
  epochIn = 5,
  epochOut = 5,
  DoubleHour = c("average", "earlier", "later"),
  mergeVar = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggir.datatransform_+3A_outputdir">outputdir</code></td>
<td>
<p><code>character</code> Directory where the GGIR output was stored.</p>
</td></tr>
<tr><td><code id="ggir.datatransform_+3A_subdir">subdir</code></td>
<td>
<p><code>character</code> Sub-directory where the summary output was stored under the current directory. Defaut is &quot;data&quot;.</p>
</td></tr>
<tr><td><code id="ggir.datatransform_+3A_studyname">studyname</code></td>
<td>
<p><code>character</code> Specify the study name that used in the output file names</p>
</td></tr>
<tr><td><code id="ggir.datatransform_+3A_numericid">numericID</code></td>
<td>
<p><code>logical</code> Specify if the ID is numeric when checking ID errors in module2. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ggir.datatransform_+3A_sortbyid">sortByid</code></td>
<td>
<p><code>character</code>  Specify the name of &quot;ID&quot; for each accelerometer file in the report of module5. The value could be &quot;newID&quot;,&quot;id&quot; and &quot;filename&quot;. Defaut is &quot;filename&quot;.</p>
</td></tr>
<tr><td><code id="ggir.datatransform_+3A_f0">f0</code></td>
<td>
<p><code>number</code>  File index to start with (default = 1). Index refers to the filenames sorted in increasing order.</p>
</td></tr>
<tr><td><code id="ggir.datatransform_+3A_f1">f1</code></td>
<td>
<p><code>number</code>  File index to finish with. Note that file ends with the minimum of f1 and the number of files available. Default = 1000000.</p>
</td></tr>
<tr><td><code id="ggir.datatransform_+3A_epochin">epochIn</code></td>
<td>
<p><code>number</code>  Epoch size to which acceleration was averaged (seconds) in GGIR output. Defaut is 5 seconds.</p>
</td></tr>
<tr><td><code id="ggir.datatransform_+3A_epochout">epochOut</code></td>
<td>
<p><code>number</code>  Epoch size to which acceleration was averaged (seconds) in module1. Defaut is 600 seconds.</p>
</td></tr>
<tr><td><code id="ggir.datatransform_+3A_doublehour">DoubleHour</code></td>
<td>
<p><code>character</code>  Specify the method of processing the double hours for days that daylight saving time starts and ends for example. In detail, DoubleHour = c(&quot;average&quot;,&quot;earlier&quot;,&quot;later&quot;). The acceleration data was averaged on double hours when DoulbeHour=&quot;average&quot;. Only the acceleration data in the earlier occurrence was remained for double hours while the other duplicate data were ignored when DoulbeHour=&quot;earlier&quot;. Only the acceleration data in the later occurrence was remained for double hours while the other duplicate data were ignored when DoulbeHour=&quot;later&quot;.  Default is &quot;average&quot;.</p>
</td></tr>
<tr><td><code id="ggir.datatransform_+3A_mergevar">mergeVar</code></td>
<td>
<p><code>number</code>  Specify which of the varaible need to be processed and merged. For example, mergeVar = 1 makes that the M$metalong varialbes were read from R data on the directory of /meta/basic under GGIR ourput directory, which includes &quot;nonwearscore&quot;,&quot;clippingscore&quot;,&quot;lightmean&quot;,&quot;lightpeak&quot;,&quot;temperaturemean&quot; and &quot;EN&quot;.  When mergeVar = 2, makes that the &quot;enmo&quot; and &quot;anglez&quot; varialbes were read from csv data on the directory of /meta/csv under GGIR ourput directory.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mergeVar = 1</code></td>
<td>
<p>Six files were written to the specified sub-directory as follows,</p>
</td></tr>
<tr><td><code>nonwearscore_studyname_f0_f1_Xs.xlsx</code></td>
<td>
<p>Data matrix of nonwearscore, where f0 and f1 are the file index to start and finish with and Xs is the epoch size to which acceleration was averaged (seconds) in GGIR output.</p>
</td></tr>  
<tr><td><code>clippingscore_studyname_f0_f1_Xs.xlsx</code></td>
<td>
<p>Data matrix of clippingscore</p>
</td></tr> 
<tr><td><code>lightmean_studyname_f0_f1_Xs.xlsx</code></td>
<td>
<p>Data matrix of lightmean</p>
</td></tr> 
<tr><td><code>lightpeak_studyname_f0_f1_Xs.xlsx</code></td>
<td>
<p>Data matrix of lightpeak</p>
</td></tr> 
<tr><td><code>temperaturemean_studyname_f0_f1_Xs.xlsx</code></td>
<td>
<p>Data matrix of temperaturemean</p>
</td></tr> 
<tr><td><code>EN_studyname_f0_f1_Xs.xlsx</code></td>
<td>
<p>Data matrix of EN</p>
</td></tr> 
<tr><td><code>mergeVar = 2</code></td>
<td>
<p>Two files were written to the specified sub-directory as follows,</p>
</td></tr>
<tr><td><code>studyname_ENMO.dataf0_f1_Xs.xlsx</code></td>
<td>
<p>Data matrix of ENMO, where f0 and f1 are the file index to start and finish with and Xs is the epoch size to which acceleration was averaged (seconds) in GGIR output.</p>
</td></tr> 
<tr><td><code>studyname_ANGLEZ.dataf0_f1_Xs.xlsx</code></td>
<td>
<p>Data matrix of ANGLEZ</p>
</td></tr>
</table>

<hr>
<h2 id='ggir.summary'>Description of all accelerometer files in the GGIR output</h2><span id='topic+ggir.summary'></span>

<h3>Description</h3>

<p>Description of all accelerometer files in the GGIR output and this script was executed when mode=2 in the main call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggir.summary(
  bindir = NULL,
  outputdir,
  studyname,
  numericID = FALSE,
  sortByid = "filename",
  subdir = "summary",
  part5FN = "WW_L50M125V500_T5A5",
  QChours.alpha = 16,
  filename2id = NULL,
  desiredtz = "US/Eastern",
  trace = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggir.summary_+3A_bindir">bindir</code></td>
<td>
<p><code>character</code> Directory where the accelerometer files are stored or list for the purpose of extracting the bin file list. Default=NULL when it is not available and therefore the bin file list is extracted from the /meta/basic folder of the GGIR output.</p>
</td></tr>
<tr><td><code id="ggir.summary_+3A_outputdir">outputdir</code></td>
<td>
<p><code>character</code> Directory where the GGIR output was stored.</p>
</td></tr>
<tr><td><code id="ggir.summary_+3A_studyname">studyname</code></td>
<td>
<p><code>character</code> Specify the study name that used in the output file names</p>
</td></tr>
<tr><td><code id="ggir.summary_+3A_numericid">numericID</code></td>
<td>
<p><code>logical</code> Specify if the ID is numeric when checking ID errors in module2. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ggir.summary_+3A_sortbyid">sortByid</code></td>
<td>
<p><code>character</code>  Specify the name of &quot;ID&quot; for each accelerometer file in the report of module2. The value could be &quot;newID&quot;,&quot;id&quot; and &quot;filename&quot;. Defaut is &quot;filename&quot;.</p>
</td></tr>
<tr><td><code id="ggir.summary_+3A_subdir">subdir</code></td>
<td>
<p><code>character</code> Sub-directory where the summary output was stored under the current directory. Defaut is &quot;summary&quot;.</p>
</td></tr>
<tr><td><code id="ggir.summary_+3A_part5fn">part5FN</code></td>
<td>
<p><code>character</code>  Specify which output is used in the GGIR part5 results. Defaut is &quot;WW_L50M125V500_T5A5&quot;, which means that part5_daysummary_WW_L50M125V500_T5A5.csv and part5_personsummary_WW_L50M125V500_T5A5.csv are used in the analysis.</p>
</td></tr>
<tr><td><code id="ggir.summary_+3A_qchours.alpha">QChours.alpha</code></td>
<td>
<p><code>number</code>  Minimum required number of valid hours in day specific analysis as a quality control step in module2. Default is 16 hours.</p>
</td></tr>
<tr><td><code id="ggir.summary_+3A_filename2id">filename2id</code></td>
<td>
<p><code>R function</code>  User defined function for converting filename to sample IDs. Default is NULL.</p>
</td></tr>
<tr><td><code id="ggir.summary_+3A_desiredtz">desiredtz</code></td>
<td>
<p><code>charcter</code>  desired timezone: see also http://en.wikipedia.org/wiki/Zone.tab. Used in g.inspectfile(). Default is &quot;US/Eastern&quot;.</p>
</td></tr>
<tr><td><code id="ggir.summary_+3A_trace">trace</code></td>
<td>
<p><code>logical</code>  Specify if the intermediate results is printed when the function was executed. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Four files were written to the specified sub-directory
</p>
<table>
<tr><td><code>studyname_ggir_output_summary.xlsx</code></td>
<td>
<p>This excel file includs 9 pages as follows,</p>
</td></tr> 
<tr><td><code>page 1</code></td>
<td>
<p> List of files in the GGIR output</p>
</td></tr> 
<tr><td><code>page 2</code></td>
<td>
<p> Summary of files </p>
</td></tr>
<tr><td><code>page 3</code></td>
<td>
<p> List of duplicate IDs </p>
</td></tr>
<tr><td><code>page 4</code></td>
<td>
<p> ID errors </p>
</td></tr>
<tr><td><code>page 5</code></td>
<td>
<p> Number of valid days </p>
</td></tr>
<tr><td><code>page 6</code></td>
<td>
<p> Table of number of valid/missing days </p>
</td></tr>
<tr><td><code>page 7</code></td>
<td>
<p> Missing patten </p>
</td></tr>
<tr><td><code>page 8</code></td>
<td>
<p> Frequency of the missing pattern </p>
</td></tr>
<tr><td><code>page 9</code></td>
<td>
<p> Description of all accelerometer files</p>
</td></tr>  
<tr><td><code>page 10</code></td>
<td>
<p> Inspects accelerometer file for key information, including: monitor brand, sample frequency and file header</p>
</td></tr>  
<tr><td><code>studyname_ggir_output_summary_plot.pdf</code></td>
<td>
<p>Some plots such as the number of valid days, which were included in the module5_studyname_Data_process_report.html file as well.</p>
</td></tr>
<tr><td><code>part24daysummary.info.csv</code></td>
<td>
<p>Intermediate results for description of each accelerometer file.</p>
</td></tr>
<tr><td><code>studyname_samples_remove_temp.csv</code></td>
<td>
<p>Create studyname_samples_remove.csv file by filling &quot;remove&quot; in the &quot;duplicate&quot; column in this template. If duplicate=&quot;remove&quot;,  the accelerometer files will not be used in the data analysis of module 5-7.</p>
</td></tr>
</table>

<hr>
<h2 id='IS_long2'>Interdaily Statbility for the Whole Dataset</h2><span id='topic+IS_long2'></span>

<h3>Description</h3>

<p>This function calcualte interdaily stability, a nonparametric metric
of circadian rhtymicity. This function is a whole dataset
wrapper for <code>IS</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IS_long2(count.data, window = 1, method = c("average", "sum"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IS_long2_+3A_count.data">count.data</code></td>
<td>
<p><code>data.frame</code> of dimension n * (1440+2) containing the
1440 dimensional activity data for all n subject days.
The first two columns have to be ID and Day. ID can be
either <code>character</code> or <code>numeric</code>. Day has to be <code>numeric</code> indicating
the sequency of days within each subject.</p>
</td></tr>
<tr><td><code id="IS_long2_+3A_window">window</code></td>
<td>
<p>an <code>integer</code> indicating what is the window to bin the data before
the function can be apply to the dataset. For details, see <code>bin_data</code>.</p>
</td></tr>
<tr><td><code id="IS_long2_+3A_method">method</code></td>
<td>
<p><code>character</code> of &quot;sum&quot; or &quot;average&quot;, function used to bin the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the following 2 columns
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>ID</p>
</td></tr>
<tr><td><code>IS</code></td>
<td>
<p>IS</p>
</td></tr>
</table>


<h3>References</h3>

<p>Junrui Di et al. Joint and individual representation of domains of physical activity, sleep, and circadian rhythmicity. Statistics in Biosciences.
</p>

<hr>
<h2 id='IS2'>Interdaily Statbility</h2><span id='topic+IS2'></span>

<h3>Description</h3>

<p>This function calcualte interdaily stability, a nonparametric metric
of circadian rhtymicity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IS2(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IS2_+3A_x">x</code></td>
<td>
<p><code>data.frame</code> of dimension ndays by p, where p is the dimension of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>IS
</p>


<h3>References</h3>

<p>Junrui Di et al. Joint and individual representation of domains of physical activity, sleep, and circadian rhythmicity. Statistics in Biosciences.
</p>

<hr>
<h2 id='IV_long2'>Intradaily Variability for the Whole Dataset</h2><span id='topic+IV_long2'></span>

<h3>Description</h3>

<p>This function calcualte intradaily variability, a nonparametric metric
reprsenting fragmentation of circadian rhtymicity. This function is a whole dataset
wrapper for <code>IV</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IV_long2(count.data, window = 1, method = c("average", "sum"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IV_long2_+3A_count.data">count.data</code></td>
<td>
<p><code>data.frame</code> of dimension n * (1440+2) containing the
1440 dimensional activity data for all n subject days.
The first two columns have to be ID and Day. ID can be
either <code>character</code> or <code>numeric</code>. Day has to be <code>numeric</code> indicating
the sequency of days within each subject.</p>
</td></tr>
<tr><td><code id="IV_long2_+3A_window">window</code></td>
<td>
<p>an <code>integer</code> indicating what is the window to bin the data before
the function can be apply to the dataset. For details, see <code>bin_data</code>.</p>
</td></tr>
<tr><td><code id="IV_long2_+3A_method">method</code></td>
<td>
<p><code>character</code> of &quot;sum&quot; or &quot;average&quot;, function used to bin the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the following 5 columns
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>ID</p>
</td></tr>
<tr><td><code>Day</code></td>
<td>
<p>Day</p>
</td></tr>
<tr><td><code>IV</code></td>
<td>
<p>IV</p>
</td></tr>
</table>


<h3>References</h3>

<p>Junrui Di et al. Joint and individual representation of domains of physical activity, sleep, and circadian rhythmicity. Statistics in Biosciences.
</p>

<hr>
<h2 id='IV2'>Intradaily Variability</h2><span id='topic+IV2'></span>

<h3>Description</h3>

<p>This function calcualte intradaily variability, a nonparametric metric
reprsenting fragmentation of circadian rhtymicity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IV2(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IV2_+3A_x">x</code></td>
<td>
<p><code>vector</code> of activity data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>IV
</p>


<h3>References</h3>

<p>Junrui Di et al. Joint and individual representation of domains of physical activity, sleep, and circadian rhythmicity. Statistics in Biosciences.
</p>

<hr>
<h2 id='jive.predict2'>Modified jive.predict function  (package: r.jive)</h2><span id='topic+jive.predict2'></span>

<h3>Description</h3>

<p>Replace SVDmiss by SVDmiss2 in the function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jive.predict2(data.new, jive.output)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jive.predict2_+3A_data.new">data.new</code></td>
<td>
<p><code>data.new</code>  A list of two or more linked data matrices on which to estimate JIVE scores.  These matrices must have the same column dimension N, which is assumed to be common.</p>
</td></tr>
<tr><td><code id="jive.predict2_+3A_jive.output">jive.output</code></td>
<td>
<p><code>jive.output</code> An object of class &quot;jive&quot;, with row dimensions matching those for data.new.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See jive.predict(package:r.jive) for details.
</p>


<h3>Value</h3>

<p>See r.jive:: jive.predict for details
</p>

<hr>
<h2 id='makeSleepDataMatrix'>Make a sleep matrix based on the sleep onset and wake up time</h2><span id='topic+makeSleepDataMatrix'></span>

<h3>Description</h3>

<p>Make a sleep matrix (sleep=1 and wake=0) based on the sleep onset and wake up time for the purpose of calculating physical acitivy features during wake up time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeSleepDataMatrix(sleepFN, epochOut = 60, impute = TRUE, outputFN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeSleepDataMatrix_+3A_sleepfn">sleepFN</code></td>
<td>
<p><code>charcter</code> The input file name with path of sleep onset and wake up. By default, we use part4_nightsummary_sleep_full.csv under /results/QC folder from GGIR output.</p>
</td></tr>
<tr><td><code id="makeSleepDataMatrix_+3A_epochout">epochOut</code></td>
<td>
<p><code>number</code>  Epoch size to which acceleration was averaged (seconds) in part 3. Defaut is 60 seconds.</p>
</td></tr>
<tr><td><code id="makeSleepDataMatrix_+3A_impute">impute</code></td>
<td>
<p><code>logical</code>  Specify if the missing sleep time was imputed based on the averge sleep onset and wake up time. Default is TRUE.</p>
</td></tr>
<tr><td><code id="makeSleepDataMatrix_+3A_outputfn">outputFN</code></td>
<td>
<p><code>character</code>  The output file name that the nonsleep matrix was wrote to. It includs filename, Date, daysleeper, sleeponset, wakeup, oldDate, sleepwindow, sleepimpute, MIN1, MIN2, ..., MIN1440 for the minutes level data when flag.epochOut=60 seconds.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sleep matrix and messages of sleep data. 
</p>
<table>
<tr><td><code>duplicatedays</code></td>
<td>
<p>Duplicate days of sleep data if exists</p>
</td></tr>
<tr><td><code>sleepproblem</code></td>
<td>
<p>Invalid sleep data if exists</p>
</td></tr>  
<tr><td><code>sleep matrix (0/1)</code></td>
<td>
<p>write the sleep matrix to a csv file specified by outputFN</p>
</td></tr>
</table>

<hr>
<h2 id='mMARCH.AC.maincall'>Main Call for Data Processing after Runing GGIR for Accelerometer Data</h2><span id='topic+mMARCH.AC.maincall'></span>

<h3>Description</h3>

<p>This R script will generate all necessary R/Rmd/shell files for data processing after running GGIR for accelerometer data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mMARCH.AC.maincall(
  mode,
  useIDs.FN = NULL,
  currentdir,
  studyname,
  bindir = NULL,
  outputdir,
  epochIn = 5,
  epochOut = 60,
  log.multiplier = 9250,
  use.cluster = TRUE,
  QCdays.alpha = 7,
  QChours.alpha = 16,
  QCnights.feature.alpha = c(0, 0, 0, 0),
  DoubleHour = c("average", "earlier", "later")[1],
  QC.sleepdur.avg = c(3, 12),
  QC.nblocks.sleep.avg = c(6, 29),
  Rversion = "R",
  filename2id = NULL,
  PA.threshold = c(40, 100, 400),
  PA.threshold2 = c(50, 100, 400),
  desiredtz = "US/Eastern",
  RemoveDaySleeper = FALSE,
  part5FN = "WW_L50M100V400_T5A5",
  NfileEachBundle = 20,
  holidayFN = NULL,
  trace = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mMARCH.AC.maincall_+3A_mode">mode</code></td>
<td>
<p><code>number</code> Specify which of the five modules need to be run, e.g. mode = 0 makes that all R/Rmd/sh files are generated for other modules. When mode = 1, all csv files in the GGIR output directory were read, transformed and then merged. When mode = 2, the GGIR output files were checked and summarized in one excel sheet. When mode = 3, the merged data was cleaned according to the number of valid hours on each night and the number of valid days for each subject. When mode = 4, the cleaned data was imputed.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_useids.fn">useIDs.FN</code></td>
<td>
<p><code>character</code> Filename with or without directory for sample information in CSV format, which including &quot;filename&quot; and &quot;duplicate&quot; in the headlines at least. If duplicate=&quot;remove&quot;,  the accelerometer files will not be used in the data analysis of module 5-7. Defaut is NULL, which makes all accelerometer files will be used in module 5-7.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_currentdir">currentdir</code></td>
<td>
<p><code>character</code> Directory where the output needs to be stored. Note that this directory must exist.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_studyname">studyname</code></td>
<td>
<p><code>character</code> Specify the study name that used in the output file names</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_bindir">bindir</code></td>
<td>
<p><code>character</code> Directory where the accelerometer files are stored or list</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_outputdir">outputdir</code></td>
<td>
<p><code>character</code> Directory where the GGIR output was stored.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_epochin">epochIn</code></td>
<td>
<p><code>number</code>  Epoch size to which acceleration was averaged (seconds) in GGIR output. Defaut is 5 seconds.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_epochout">epochOut</code></td>
<td>
<p><code>number</code>  Epoch size to which acceleration was averaged (seconds) in module 3. Defaut is 60 seconds.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_log.multiplier">log.multiplier</code></td>
<td>
<p><code>number</code> The coefficient used in the log transformation of the ENMO data, i.e. log( log.multiplier * ENMO + 1), which have been used in module 5-7. Defaut is 9250.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_use.cluster">use.cluster</code></td>
<td>
<p><code>logical</code>  Specify if module1 will be done by parallel computing. Default is TRUE, and the CSV file in GGIR output will be merged for every 20 files first, and then combined for all.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_qcdays.alpha">QCdays.alpha</code></td>
<td>
<p><code>number</code>  Minimum required number of valid days in subject specific analysis as a quality control step in module2. Default is 7 days.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_qchours.alpha">QChours.alpha</code></td>
<td>
<p><code>number</code>  Minimum required number of valid hours in day specific analysis as a quality control step in module2. Default is 16 hours.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_qcnights.feature.alpha">QCnights.feature.alpha</code></td>
<td>
<p><code>number</code>  Minimum required number of valid nights in day specific mean, SD, weekday mean and weekend mean analysis as a quality control step in the JIVE analysis. Default is  c(0,0,0,0), i.e. no additional data cleaning in this step.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_doublehour">DoubleHour</code></td>
<td>
<p><code>character</code>  Specify the method of processing the double hours for days that daylight saving time starts and ends for example. In detail, DoubleHour = c(&quot;average&quot;,&quot;earlier&quot;,&quot;later&quot;). The acceleration data was averaged on double hours when DoulbeHour=&quot;average&quot;. Only the acceleration data in the earlier occurrence was remained for double hours while the other duplicate data were ignored when DoulbeHour=&quot;earlier&quot;. Only the acceleration data in the later occurrence was remained for double hours while the other duplicate data were ignored when DoulbeHour=&quot;later&quot;.  Default is &quot;average&quot;.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_qc.sleepdur.avg">QC.sleepdur.avg</code></td>
<td>
<p><code>number</code>  As taking the deault value of QC.sleepdur.avg=c(3,12), individuals were excluded with an average sleep duration &lt;3 hour or &gt;12 hour.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_qc.nblocks.sleep.avg">QC.nblocks.sleep.avg</code></td>
<td>
<p><code>number</code>  As taking the deault value of QC.nblocks.sleep.avg=c(6,29), individuals were excluded with an average number of nocturnal sleep episodes &lt; 6 or &gt; 29.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_rversion">Rversion</code></td>
<td>
<p><code>character</code>  R version, eg. &quot;R/3.6.3&quot;. Default is &quot;R&quot;.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_filename2id">filename2id</code></td>
<td>
<p><code>R function</code>  User defined function for converting filename to sample IDs. Default is NULL.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_pa.threshold">PA.threshold</code></td>
<td>
<p><code>number</code>  Threshold for light, moderate and vigorous physical activity. Default is c(40,100,400).</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_pa.threshold2">PA.threshold2</code></td>
<td>
<p><code>number</code>  Second threshold for light, moderate and vigorous physical activity. Default is c(50,100,400). The activity features will end with &quot;_C2&quot; for those that were calculated based on PA.threshold2.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_desiredtz">desiredtz</code></td>
<td>
<p><code>charcter</code>  desired timezone: see also http://en.wikipedia.org/wiki/Zone.tab. Used in g.inspectfile(). Default is &quot;US/Eastern&quot;. Used in g.inspectfile() function to inspect acceleromether file for brand, sample frequency in module 2.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_removedaysleeper">RemoveDaySleeper</code></td>
<td>
<p><code>logical</code>  Specify if the daysleeper nights are removed from the calculation of number of valid days for each subject. Default is FALSE.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_part5fn">part5FN</code></td>
<td>
<p><code>character</code>  Specify which output is used in the GGIR part5 results. Defaut is &quot;WW_L50M100V400_T5A5&quot;, which means that part5_daysummary_WW_L50M100V400_T5A5.csv and part5_personsummary_WW_L50M100V400_T5A5.csv are used in the analysis.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_nfileeachbundle">NfileEachBundle</code></td>
<td>
<p><code>number</code>  Number of files in each bundle when the csv data were read and processed in a cluster. Default is 20.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_holidayfn">holidayFN</code></td>
<td>
<p><code>character</code>  Specify the holiday file including filename (optional), Date (mm/dd/year) and holiday (1/0) columns. When it is available, the holiday will be marked into the &quot;weekends&quot; group in weekday/weekend specific feature calculations in module7d. Defaut is NULL.</p>
</td></tr>
<tr><td><code id="mMARCH.AC.maincall_+3A_trace">trace</code></td>
<td>
<p><code>logical</code>  Specify if the intermediate results is printed when the function was executed. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>See mMARCH.AC manual for details.
</p>

<hr>
<h2 id='PAfun'>Timne Metrics for Whole Dataset</h2><span id='topic+PAfun'></span>

<h3>Description</h3>

<p>This function is a whole dataset wrapper for <code>Time</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PAfun(count.data, weartime, PA.threshold = c(50, 100, 400))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PAfun_+3A_count.data">count.data</code></td>
<td>
<p><code>data.frame</code> of dimension n*1442 containing the 1440 minute activity data for all n subject days.
The first two columns have to be ID and Day.</p>
</td></tr>
<tr><td><code id="PAfun_+3A_weartime">weartime</code></td>
<td>
<p><code>data.frame</code> with dimension of <code>count.data</code>.
The first two columns have to be ID and Day.</p>
</td></tr>
<tr><td><code id="PAfun_+3A_pa.threshold">PA.threshold</code></td>
<td>
<p>threshold to calculate the time in minutes of sedentary, light, moderate and vigorous activity the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with some of the following columns
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>identifier of the person</p>
</td></tr>
<tr><td><code>Day</code></td>
<td>
<p>indicator of which day of activity it is, can be a numeric vector of sequence 1,2,... or a string of date</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>time of certain state</p>
</td></tr>
</table>

<hr>
<h2 id='pheno.plot'>View phenotype variables</h2><span id='topic+pheno.plot'></span>

<h3>Description</h3>

<p>This R script will generate plot for each variable and write description to a log file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pheno.plot(
  inputFN,
  outFN = paste("plot_", inputFN, ".pdf", sep = ""),
  csv = TRUE,
  sep = " ",
  start = 3,
  read = TRUE,
  logFN = NULL,
  track = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pheno.plot_+3A_inputfn">inputFN</code></td>
<td>
<p><code>character</code> Input file name or input data</p>
</td></tr>
<tr><td><code id="pheno.plot_+3A_outfn">outFN</code></td>
<td>
<p><code>character</code> Output pdf file name for the plots</p>
</td></tr>
<tr><td><code id="pheno.plot_+3A_csv">csv</code></td>
<td>
<p><code>logical</code>  Specify if input file is a CSV file. Default is TRUE.</p>
</td></tr>
<tr><td><code id="pheno.plot_+3A_sep">sep</code></td>
<td>
<p><code>character</code> Separator between columns. Default is space. If csv=TRUE, this will not be used.</p>
</td></tr>
<tr><td><code id="pheno.plot_+3A_start">start</code></td>
<td>
<p><code>number</code> The location of the first phenotype variable starts in the input file.</p>
</td></tr>
<tr><td><code id="pheno.plot_+3A_read">read</code></td>
<td>
<p><code>logical</code>  Specify if inputFN is a file name or a data. Default is TRUE when inputFN is a file name.</p>
</td></tr>
<tr><td><code id="pheno.plot_+3A_logfn">logFN</code></td>
<td>
<p><code>character</code>  File name of the log file. Default is NULL, while logFN=paste(inputFN,&quot;.log&quot;,sep=&quot;&quot;) in the function.</p>
</td></tr>
<tr><td><code id="pheno.plot_+3A_track">track</code></td>
<td>
<p><code>logical</code>   Specify if the intermediate results is printed when the function was executed. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Files were written to the current directory. One is .pdf file for plots and the other is .log file for variable description.
</p>

<hr>
<h2 id='RA_long2'>Relative Amplitude for the Whole Datset</h2><span id='topic+RA_long2'></span>

<h3>Description</h3>

<p>This function calcualte relative amplitude, a nonparametric metric
of circadian rhtymicity. This function is a whole dataset
wrapper for <code>RA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RA_long2(
  count.data,
  window = 1,
  method = c("average", "sum"),
  noon2noon = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RA_long2_+3A_count.data">count.data</code></td>
<td>
<p><code>data.frame</code> of dimension n * (p+2) containing the
p dimensional activity data for all n subject days.
The first two columns have to be ID and Day. ID can be
either <code>character</code> or <code>numeric</code>. Day has to be <code>numeric</code> indicating
the sequency of days within each subject.</p>
</td></tr>
<tr><td><code id="RA_long2_+3A_window">window</code></td>
<td>
<p>since the caculation of M10 and L5 depends on the dimension of data, we need to include
window size as an argument. This function is a whole dataset
wrapper for <code>RA</code>.</p>
</td></tr>
<tr><td><code id="RA_long2_+3A_method">method</code></td>
<td>
<p><code>character</code> of &quot;sum&quot; or &quot;average&quot;, function used to bin the data</p>
</td></tr>
<tr><td><code id="RA_long2_+3A_noon2noon">noon2noon</code></td>
<td>
<p><code>logical</code>  Specify if M10 and L5 were calculated from noon to noon. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the following 3 columns
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>ID</p>
</td></tr>
<tr><td><code>Day</code></td>
<td>
<p>Day</p>
</td></tr>
<tr><td><code>RA</code></td>
<td>
<p>RA</p>
</td></tr>
</table>

<hr>
<h2 id='RA2'>Relative Amplitude</h2><span id='topic+RA2'></span>

<h3>Description</h3>

<p>This function calcualte relative amplitude, a nonparametric metric
reprsenting fragmentation of circadian rhtymicity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RA2(x, window = 1, method = c("average", "sum"), noon2noon = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RA2_+3A_x">x</code></td>
<td>
<p><code>vector</code> vector of activity data</p>
</td></tr>
<tr><td><code id="RA2_+3A_window">window</code></td>
<td>
<p>since the caculation of M10 and L5 depends on the dimension of data, we need to include
window size as an argument.</p>
</td></tr>
<tr><td><code id="RA2_+3A_method">method</code></td>
<td>
<p><code>character</code> of &quot;sum&quot; or &quot;average&quot;, function used to bin the data</p>
</td></tr>
<tr><td><code id="RA2_+3A_noon2noon">noon2noon</code></td>
<td>
<p><code>logical</code>  Specify if M10 and L5 were calculated from noon to noon. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>RA
</p>


<h3>References</h3>

<p>Junrui Di et al. Joint and individual representation of domains of physical activity, sleep, and circadian rhythmicity. Statistics in Biosciences.
</p>

<hr>
<h2 id='SVDmiss2'>Modified SVDmiss function (package  SpatioTemporal)</h2><span id='topic+SVDmiss2'></span>

<h3>Description</h3>

<p>Modify ncomp = min(ncol(X),nrow(X),ncomp) for the matrix with nrow(X)&lt;ncol(X)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SVDmiss2(X, niter = 200, ncomp = dim(X)[2], conv.reldiff = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SVDmiss2_+3A_x">X</code></td>
<td>
<p><code>X</code>  Data matrix, with missing values marked by 'NA'.</p>
</td></tr>
<tr><td><code id="SVDmiss2_+3A_niter">niter</code></td>
<td>
<p><code>niter</code>  Maximum number of iterations to run before exiting, 'Inf' will run until the 'conv.reldiff' criteria is met.</p>
</td></tr>
<tr><td><code id="SVDmiss2_+3A_ncomp">ncomp</code></td>
<td>
<p><code>ncomp</code>  Number of SVD components to use in the reconstruction (&gt;0).</p>
</td></tr>
<tr><td><code id="SVDmiss2_+3A_conv.reldiff">conv.reldiff</code></td>
<td>
<p><code>conv.reldiff</code>  Assume the iterative procedure has converged when the relative difference between two consecutive iterations is less than 'conv.reldiff'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See SVDmiss(package:SpatioTemporal) for details.
</p>


<h3>Value</h3>

<p>See SpatioTemporal:: SVDmiss for details
</p>

<hr>
<h2 id='Time_long2'>Timne Metrics for Whole Dataset</h2><span id='topic+Time_long2'></span>

<h3>Description</h3>

<p>This function is a whole dataset wrapper for <code>Time</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Time_long2(count.data, weartime, thresh, smallerthan = TRUE, bout.length = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Time_long2_+3A_count.data">count.data</code></td>
<td>
<p><code>data.frame</code> of dimension n*1442 containing the 1440 minute activity data for all n subject days.
The first two columns have to be ID and Day.</p>
</td></tr>
<tr><td><code id="Time_long2_+3A_weartime">weartime</code></td>
<td>
<p><code>data.frame</code> with dimension of <code>count.data</code>.
The first two columns have to be ID and Day.</p>
</td></tr>
<tr><td><code id="Time_long2_+3A_thresh">thresh</code></td>
<td>
<p>threshold to binarize the data.</p>
</td></tr>
<tr><td><code id="Time_long2_+3A_smallerthan">smallerthan</code></td>
<td>
<p>Find a state that is smaller than a threshold, or greater than or equal to.</p>
</td></tr>
<tr><td><code id="Time_long2_+3A_bout.length">bout.length</code></td>
<td>
<p>minimum duration of defining an active bout; defaults to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with some of the following columns
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>identifier of the person</p>
</td></tr>
<tr><td><code>Day</code></td>
<td>
<p>indicator of which day of activity it is, can be a numeric vector of sequence 1,2,... or a string of date</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>time of certain state</p>
</td></tr>
</table>

<hr>
<h2 id='Time2'>Time of A Certain activity State</h2><span id='topic+Time2'></span>

<h3>Description</h3>

<p>Calculate the total time of being in certain state, e.g. sedentary, active, MVPA, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Time2(x, w, thresh, smallerthan = TRUE, bout.length = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Time2_+3A_x">x</code></td>
<td>
<p><code>vector</code> of activity data.</p>
</td></tr>
<tr><td><code id="Time2_+3A_w">w</code></td>
<td>
<p><code>vector</code> of wear flag data with same dimension as <code>x</code>.</p>
</td></tr>
<tr><td><code id="Time2_+3A_thresh">thresh</code></td>
<td>
<p>threshold to binarize the data.</p>
</td></tr>
<tr><td><code id="Time2_+3A_smallerthan">smallerthan</code></td>
<td>
<p>Find a state that is smaller than a threshold, or greater than or equal to.</p>
</td></tr>
<tr><td><code id="Time2_+3A_bout.length">bout.length</code></td>
<td>
<p>minimum duration of defining an active bout; defaults to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Time
</p>

<hr>
<h2 id='Tvol2'>Total Volumen of Activity for Whole Dataset</h2><span id='topic+Tvol2'></span>

<h3>Description</h3>

<p>Calculate total volume of activity level, which includes
<code>TLAC</code> (total log transfored activity counts),
<code>TAC</code> (total activity counts).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tvol2(count.data, weartime, logtransform = FALSE, log.multiplier = 9250)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Tvol2_+3A_count.data">count.data</code></td>
<td>
<p><code>data.frame</code> of dimension n*1442 containing the 1440 minute activity data for all n subject days.
The first two columns have to be ID and Day.</p>
</td></tr>
<tr><td><code id="Tvol2_+3A_weartime">weartime</code></td>
<td>
<p><code>data.frame</code> with dimension of <code>count.data</code>.
The first two columns have to be ID and Day.</p>
</td></tr>
<tr><td><code id="Tvol2_+3A_logtransform">logtransform</code></td>
<td>
<p>if <code>TRUE</code>, then calcualte <code>TLAC</code>. Or calculate <code>TAC</code>.</p>
</td></tr>
<tr><td><code id="Tvol2_+3A_log.multiplier">log.multiplier</code></td>
<td>
<p><code>number</code> The coefficient used in the log transformation of the ENMO data, i.e. log( log.multiplier * ENMO + 1). Defaut is 9250.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>log transormation is defined as log(x+1).
</p>


<h3>Value</h3>

<p>A dataframe with some of the following columns
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>identifier of the person</p>
</td></tr>
<tr><td><code>Day</code></td>
<td>
<p>indicator of which day of activity it is, can be a numeric vector of sequence 1,2,... or a string of date</p>
</td></tr>
<tr><td><code>TAC</code></td>
<td>
<p>total activity count</p>
</td></tr>
<tr><td><code>TLAC</code></td>
<td>
<p>total log activity count</p>
</td></tr>
</table>

<hr>
<h2 id='wear_flag'>Create Wear/Nonwear Flags</h2><span id='topic+wear_flag'></span>

<h3>Description</h3>

<p>Determine during which time period, subject should wear the device.
It is preferable that user provide their own wear/non wear flag which should has the same dimension
as the activity data. This function provide wear/non wear flag based on time of day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wear_flag(count.data, start = "05:00", end = "23:00")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wear_flag_+3A_count.data">count.data</code></td>
<td>
<p><code>data.frame</code> of dimension n*1442 containing the 1440 minute activity data for all n subject days.
The first two columns have to be ID and Day.</p>
</td></tr>
<tr><td><code id="wear_flag_+3A_start">start</code></td>
<td>
<p>start time, a string in the format of 24hr, e.g. &quot;05:00&quot;; defaults to &quot;05:00&quot;.</p>
</td></tr>
<tr><td><code id="wear_flag_+3A_end">end</code></td>
<td>
<p>end time, a string in the format of 24hr, e.g. &quot;23:00&quot;; defaults to &quot;23:00&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fragmentation metrics are usually defined when subject is awake. The <code>weartime</code> provide time periods on which those features should be extracted.
This can be also used as indication of wake/sleep.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with same dimension and column name as the <code>count.data</code>, with 0/1 as the elments
reprensting wear, nonwear respectively.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
