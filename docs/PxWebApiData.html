<!DOCTYPE html><html lang="en"><head><title>Help for package PxWebApiData</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PxWebApiData}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ApiData'><p>PX-Web Data by API</p></a></li>
<li><a href='#MakeUrl'><p>MakeUrl from id</p></a></li>
<li><a href='#Number'><p>Adding leading zeros</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>PX-Web Data by API</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-01</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Øyvind Langsrud &lt;oyl@ssb.no&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>httr, rjstat, jsonlite, pxweb</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>Description:</td>
<td>Function to read PX-Web data into R via API. The example code reads data from the three national statistical institutes, Statistics Norway, Statistics Sweden and Statistics Finland.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://statisticsnorway.github.io/ssb-pxwebapidata/">https://statisticsnorway.github.io/ssb-pxwebapidata/</a>,
<a href="https://github.com/statisticsnorway/ssb-pxwebapidata">https://github.com/statisticsnorway/ssb-pxwebapidata</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/statisticsnorway/ssb-pxwebapidata/issues">https://github.com/statisticsnorway/ssb-pxwebapidata/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-01 15:54:30 UTC; oyl</td>
</tr>
<tr>
<td>Author:</td>
<td>Øyvind Langsrud [aut, cre],
  Jan Bruusgaard [aut],
  Solveig Bjørkholt [ctb],
  Susie Jentoft [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-01 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ApiData'>PX-Web Data by API</h2><span id='topic+ApiData'></span><span id='topic+GetApiData'></span><span id='topic+pxwebData'></span><span id='topic+PxData'></span><span id='topic+ApiData1'></span><span id='topic+ApiData2'></span><span id='topic+ApiData12'></span><span id='topic+GetApiData1'></span><span id='topic+GetApiData2'></span><span id='topic+GetApiData12'></span><span id='topic+pxwebData1'></span><span id='topic+pxwebData2'></span><span id='topic+pxwebData12'></span><span id='topic+PxData1'></span><span id='topic+PxData2'></span><span id='topic+PxData12'></span>

<h3>Description</h3>

<p>A function to read PX-Web data into R via API. The example code reads data from the three national statistical institutes, Statistics Norway, Statistics Sweden and Statistics Finland.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ApiData(
  urlToData,
  ...,
  getDataByGET = FALSE,
  returnMetaData = FALSE,
  returnMetaValues = FALSE,
  returnMetaFrames = FALSE,
  returnApiQuery = FALSE,
  defaultJSONquery = c(1, -2, -1),
  verbosePrint = FALSE,
  use_factors = FALSE,
  urlType = "SSB",
  apiPackage = "httr",
  dataPackage = "rjstat",
  returnDataSet = NULL,
  makeNAstatus = TRUE,
  responseFormat = "json-stat2"
)

GetApiData(..., getDataByGET = TRUE)

pxwebData(..., apiPackage = "pxweb", dataPackage = "pxweb")

PxData(..., apiPackage = "pxweb", dataPackage = "rjstat")

ApiData1(..., returnDataSet = 1)

ApiData2(..., returnDataSet = 2)

ApiData12(..., returnDataSet = 12)

GetApiData1(..., returnDataSet = 1)

GetApiData2(..., returnDataSet = 2)

GetApiData12(..., returnDataSet = 12)

pxwebData1(..., returnDataSet = 1)

pxwebData2(..., returnDataSet = 2)

pxwebData12(..., returnDataSet = 12)

PxData1(..., returnDataSet = 1)

PxData2(..., returnDataSet = 2)

PxData12(..., returnDataSet = 12)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ApiData_+3A_urltodata">urlToData</code></td>
<td>
<p>url to data or id of SSB data</p>
</td></tr>
<tr><td><code id="ApiData_+3A_...">...</code></td>
<td>
<p>specification of JSON query for each variable</p>
</td></tr>
<tr><td><code id="ApiData_+3A_getdatabyget">getDataByGET</code></td>
<td>
<p>When TRUE, readymade dataset by GET</p>
</td></tr>
<tr><td><code id="ApiData_+3A_returnmetadata">returnMetaData</code></td>
<td>
<p>When TRUE, metadata returned</p>
</td></tr>
<tr><td><code id="ApiData_+3A_returnmetavalues">returnMetaValues</code></td>
<td>
<p>When TRUE, values from metadata returned</p>
</td></tr>
<tr><td><code id="ApiData_+3A_returnmetaframes">returnMetaFrames</code></td>
<td>
<p>When TRUE, values and valueTexts from metadata returned as data frames</p>
</td></tr>
<tr><td><code id="ApiData_+3A_returnapiquery">returnApiQuery</code></td>
<td>
<p>When TRUE, JSON query returned</p>
</td></tr>
<tr><td><code id="ApiData_+3A_defaultjsonquery">defaultJSONquery</code></td>
<td>
<p>specification for variables not included in ...</p>
</td></tr>
<tr><td><code id="ApiData_+3A_verboseprint">verbosePrint</code></td>
<td>
<p>When TRUE, printing to console</p>
</td></tr>
<tr><td><code id="ApiData_+3A_use_factors">use_factors</code></td>
<td>
<p>Parameter to <code><a href="rjstat.html#topic+fromJSONstat">fromJSONstat</a></code> defining whether dimension categories should be factors or character objects.</p>
</td></tr>
<tr><td><code id="ApiData_+3A_urltype">urlType</code></td>
<td>
<p>Parameter defining how url is constructed from id number. Currently two Statistics Norway possibilities: &quot;SSB&quot; (Norwegian) or &quot;SSBen&quot; (English)</p>
</td></tr>
<tr><td><code id="ApiData_+3A_apipackage">apiPackage</code></td>
<td>
<p>Package used to capture json(-stat) data from API: <code>"httr"</code> (default) or <code>"pxweb"</code></p>
</td></tr>
<tr><td><code id="ApiData_+3A_datapackage">dataPackage</code></td>
<td>
<p>Package used to transform json(-stat) data to data frame: <code>"rjstat"</code> (default) or <code>"pxweb"</code></p>
</td></tr>
<tr><td><code id="ApiData_+3A_returndataset">returnDataSet</code></td>
<td>
<p>Possible non-NULL values are <code>1</code>, <code>2</code> and <code>12</code>. Then a single data set is returned as a data frame.
</p>

<ul>
<li> <p><strong><code>1</code>:</strong> The first data set
</p>
</li>
<li> <p><strong><code>2</code>:</strong> The second data set
</p>
</li>
<li> <p><strong><code>12</code>:</strong> Both data sets combined
</p>
</li></ul>
</td></tr>
<tr><td><code id="ApiData_+3A_makenastatus">makeNAstatus</code></td>
<td>
<p>When TRUE and when dataPackage is <code>"rjstat"</code> and when missing entries in <code>value</code>,
the function tries to add an additional variable, named <code>NAstatus</code>, with status codes.</p>
</td></tr>
<tr><td><code id="ApiData_+3A_responseformat">responseFormat</code></td>
<td>
<p>Response format to be used when <code>apiPackage</code> and <code>dataPackage</code> are defaults  (<code>"json-stat"</code> or <code>"json-stat2"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each variable is specified by using the variable name as input parameter. The value can be specified as:
TRUE (all), FALSE (eliminated), imaginary value (top), variable indices,
original variable id's (values) or variable labels (valueTexts).
Reversed indices can be specified as negative values.
Indices outside the range are removed. Variables not specified is set to the value of defaultJSONquery
whose default means the first and the two last elements.
</p>
<p>The value can also be specified as a (unnamed) two-element list corresponding to the two
query elements, filter and values. In addition it possible with a single-element list.
Then filter is set to 'all'. See examples.
</p>
<p>A comment attribute with elements <code>label</code>, <code>source</code> and <code>updated</code> is added to output as a named character vector.
When available, the elements <code>tableid</code> and <code>contents</code> are also included, resulting in a vector with 3 to 5 elements.
Run <code><a href="base.html#topic+comment">comment</a></code> to obtain this information.
</p>
<p>Functionality in the package <code>pxweb</code> can be utilized by making use of the parameters
<code>apiPackage</code> and <code>dataPackage</code>
as implemented as the wrappers <code>PxData</code> and <code>pxwebData</code>.
With data sets too large for ordinary downloads, <code>PxData</code> can solve the problem (multiple downloads).
When using <code>pxwebData</code>, data will be downloaded in px-json format instead of json-stat and the output data frame
will be organized differently (ContentsCode categories as separate variables).
</p>


<h3>Value</h3>

<p>list of two data sets (label and id)
</p>


<h3>Note</h3>

<p>See the package vignette for aggregations using filter <code>agg</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##### Readymade dataset by GET.  Works for readymade datasets and "saved-JSON-stat-query-links".
x &lt;- ApiData("https://data.ssb.no/api/v0/dataset/1066.json?lang=en", getDataByGET = TRUE)
x[[1]]  # The label version of the data set
x[[2]]  # The id version of the data set
names(x)
comment(x)

##### As above with single data set output
url &lt;- "https://data.ssb.no/api/v0/dataset/1066.json?lang=en"
x1 &lt;- ApiData1(url, getDataByGET = TRUE) # as x[[1]]
x2 &lt;- ApiData2(url, getDataByGET = TRUE) # as x[[2]]
ApiData12(url, getDataByGET = TRUE) # Combined

##### Special output
ApiData("https://data.ssb.no/api/v0/en/table/11419", returnMetaData = TRUE)   # meta data
ApiData("https://data.ssb.no/api/v0/en/table/11419", returnMetaValues = TRUE) # meta data values
ApiData("https://data.ssb.no/api/v0/en/table/11419", returnMetaFrames = TRUE) # list of data frames
ApiData("https://data.ssb.no/api/v0/en/table/11419", returnApiQuery = TRUE)   # query using defaults


##### Ordinary use     (makeNAstatus is in use in first two examples)

# NACE2007 as imaginary value (top 10), ContentsCode as TRUE (all), Tid is default
x &lt;- ApiData("https://data.ssb.no/api/v0/en/table/11419", NACE2007 = 10i, ContentsCode = TRUE)

# Two specified and the last is default (as above) - in Norwegian change en to no in url
x &lt;- ApiData("https://data.ssb.no/api/v0/no/table/11419", NACE2007 = 10i, ContentsCode = TRUE)

# Number of residents (bosatte) last year, each region
x &lt;- ApiData("https://data.ssb.no/api/v0/en/table/04861", Region = TRUE, 
        ContentsCode = "Bosatte", Tid = 1i)

# Number of residents (bosatte) each year, total
ApiData("https://data.ssb.no/api/v0/en/table/04861", Region = FALSE, 
        ContentsCode = "Bosatte", Tid = TRUE)

# Some years
ApiData("https://data.ssb.no/api/v0/en/table/04861", Region = FALSE, 
        ContentsCode = "Bosatte", Tid = c(1, 5, -1))

# Two selected regions
ApiData("https://data.ssb.no/api/v0/en/table/04861", Region = c("1103", "0301"), 
        ContentsCode = 2, Tid = c(1, -1))


##### Using id instead of url, unnamed input and verbosePrint
ApiData(4861, c("1103", "0301"), 1, c(1, -1)) # same as below 
ApiData(4861, Region = c("1103", "0301"), ContentsCode=2, Tid=c(1, -1)) 
names(ApiData(4861,returnMetaFrames = TRUE))  # these names from metadata assumed two lines above
ApiData("4861", c("1103", "0301"), 1, c(1, -1),  urlType="SSBen")
ApiData("01222", c("1103", "0301"), c(4, 9:11), 2i, verbosePrint = TRUE)
ApiData(1066, getDataByGET = TRUE,  urlType="SSB")
ApiData(1066, getDataByGET = TRUE,  urlType="SSBen")


##### Advanced use using list. See details above. Try returnApiQuery=TRUE on the same examples. 
ApiData(4861, Region = list("03*"), ContentsCode = 1, Tid = 5i) # "all" can be dropped from the list
ApiData(4861, Region = list("all", "03*"), ContentsCode = 1, Tid = 5i)  # same as above
ApiData(04861, Region = list("item", c("1103", "0301")), ContentsCode = 1, Tid = 5i)


##### Using data from SCB to illustrate returnMetaFrames
urlSCB &lt;- "https://api.scb.se/OV0104/v1/doris/sv/ssd/BE/BE0101/BE0101A/BefolkningNy"
mf &lt;- ApiData(urlSCB, returnMetaFrames = TRUE)
names(mf)              # All the variable names
attr(mf, "text")       # Corresponding text information as attribute
mf$ContentsCode        # Data frame for the fifth variable (alternatively  mf[[5]])
attr(mf,"elimination") # Finding variables that can be eliminated
ApiData(urlSCB,        # Eliminating all variables that can be eliminated (line below)
        Region = FALSE, Civilstand = FALSE, Alder = FALSE,  Kon = FALSE,
        ContentsCode  = "BE0101N1", # Selecting a single ContentsCode by text input
        Tid = TRUE)                 # Choosing all possible values of Tid.
 
               
##### Using data from Statfi to illustrate use of input by variable labels (valueTexts)
urlStatfi &lt;- "https://pxdata.stat.fi/PXWeb/api/v1/en/StatFin/kuol/statfin_kuol_pxt_12au.px"
ApiData(urlStatfi, returnMetaFrames = TRUE)$Tiedot
ApiData(urlStatfi, Alue = FALSE, Vuosi = TRUE, Tiedot = "Population")  # same as Tiedot = 21


##### Wrappers PxData and pxwebData

# Exact same output as ApiData
PxData(4861, Region = "0301", ContentsCode = TRUE, Tid = c(1, -1))

# Data organized differently
pxwebData(4861, Region = "0301", ContentsCode = TRUE, Tid = c(1, -1))


# Large query. ApiData will not work.
if(FALSE){ # This query is "commented out" 
  z &lt;- PxData("https://api.scb.se/OV0104/v1/doris/sv/ssd/BE/BE0101/BE0101A/BefolkningNy", 
              Region = TRUE, Civilstand = TRUE, Alder = 1:10, Kon = FALSE, 
              ContentsCode = "BE0101N1", Tid = 1:10, verbosePrint = TRUE)
}


##### Small example where makeNAstatus is in use
ApiData("04469", Tid = "2020", ContentsCode = 1, Alder = TRUE, Region = "3011")



</code></pre>

<hr>
<h2 id='MakeUrl'>MakeUrl from id</h2><span id='topic+MakeUrl'></span>

<h3>Description</h3>

<p>MakeUrl from id
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MakeUrl(id, urlType = "SSB", getDataByGET = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MakeUrl_+3A_id">id</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="MakeUrl_+3A_urltype">urlType</code></td>
<td>
<p>Currently two possibilities: &quot;SSB&quot; (Norwegian) or &quot;SSBen&quot; (English)</p>
</td></tr>
<tr><td><code id="MakeUrl_+3A_getdatabyget">getDataByGET</code></td>
<td>
<p>As input to ApiData</p>
</td></tr>
</table>


<h3>Value</h3>

<p>url as string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MakeUrl(4861)
MakeUrl(4861, "SSBen")
MakeUrl(1066, getDataByGET = TRUE)
MakeUrl(1066, "SSBen", getDataByGET = TRUE)
</code></pre>

<hr>
<h2 id='Number'>Adding leading zeros</h2><span id='topic+Number'></span>

<h3>Description</h3>

<p>Adding leading zeros
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Number(n, width = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Number_+3A_n">n</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="Number_+3A_width">width</code></td>
<td>
<p>width</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Number as string
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
