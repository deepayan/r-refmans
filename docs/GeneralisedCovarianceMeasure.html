<!DOCTYPE html><html lang="en"><head><title>Help for package GeneralisedCovarianceMeasure</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GeneralisedCovarianceMeasure}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GeneralisedCovarianceMeasure'><p>Package for testing conditional independence based on the Generalized Covariance Measure (GCM)</p></a></li>
<li><a href='#comp.resids'><p>Wrapper function to computing residuals from a regression method</p></a></li>
<li><a href='#gcm.test'><p>Test for Conditional Independence Based on the Generalized Covariance Measure (GCM)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Test for Conditional Independence Based on the Generalized
Covariance Measure (GCM)</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Jonas Peters and Rajen D. Shah</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jonas Peters &lt;jonas.peters@math.ku.dk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A statistical hypothesis test for conditional independence. It performs nonlinear regressions on the conditioning variable and then tests for a vanishing covariance between the resulting residuals. It can be applied to both univariate random variables and multivariate random vectors. Details of the method can be found in Rajen D. Shah and Jonas Peters: The Hardness of Conditional Independence Testing and the Generalised Covariance Measure, Annals of Statistics 48(3), 1514&ndash;1538, 2020.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>CVST, graphics, kernlab, mgcv, stats, xgboost</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-23 11:23:10 UTC; jonas</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-24 08:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='GeneralisedCovarianceMeasure'>Package for testing conditional independence based on the Generalized Covariance Measure (GCM)</h2><span id='topic+GeneralisedCovarianceMeasure'></span><span id='topic+GeneralisedCovarianceMeasure-package'></span>

<h3>Description</h3>

<p>Contains the function gcm.test that can be used for performing a conditional independence test based on the GCM.
</p>


<h3>Author(s)</h3>

<p>Jonas Peters <a href="mailto:jonas.peters@math.ku.dk">jonas.peters@math.ku.dk</a>, Rajen D. Shah
</p>


<h3>References</h3>

<p>Please cite the following paper.
Rajen D. Shah, Jonas Peters:
&quot;The Hardness of Conditional Independence Testing and the Generalised Covariance Measure&quot;
<a href="https://arxiv.org/abs/1804.07203">https://arxiv.org/abs/1804.07203</a>
</p>

<hr>
<h2 id='comp.resids'>Wrapper function to computing residuals from a regression method</h2><span id='topic+comp.resids'></span>

<h3>Description</h3>

<p>This function is used for the GCM test. 
Other methods can be added.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.resids(V, Z, regr.pars, regr.method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comp.resids_+3A_v">V</code></td>
<td>
<p>A (nxp)-dimensional matrix (or data frame) with n observations of p variables.</p>
</td></tr>
<tr><td><code id="comp.resids_+3A_z">Z</code></td>
<td>
<p>A (nxp)-dimensional matrix (or data frame) with n observations of p variables.</p>
</td></tr>
<tr><td><code id="comp.resids_+3A_regr.pars">regr.pars</code></td>
<td>
<p>Some regression methods require a list of additional options.</p>
</td></tr>
<tr><td><code id="comp.resids_+3A_regr.method">regr.method</code></td>
<td>
<p>A string indicating the regression method that is used. Currently implemented are 
&quot;gam&quot;, &quot;xgboost&quot;, &quot;kernel.ridge&quot;, &quot;nystrom&quot;. The regression is performed only if 
not both resid.XonZ and resid.YonZ are set to NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of residuals.
</p>


<h3>References</h3>

<p>Please cite the following paper.
Rajen D. Shah, Jonas Peters: 
&quot;The Hardness of Conditional Independence Testing and the Generalised Covariance Measure&quot;
https://arxiv.org/abs/1804.07203
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 250 
Z &lt;- 4*rnorm(n) 
X &lt;- 2*sin(Z) + rnorm(n)
res &lt;- comp.resids(X, Z, regr.pars = list(), regr.method = "gam")

</code></pre>

<hr>
<h2 id='gcm.test'>Test for Conditional Independence Based on the Generalized Covariance Measure (GCM)</h2><span id='topic+gcm.test'></span>

<h3>Description</h3>

<p>Test for Conditional Independence Based on the Generalized Covariance Measure (GCM)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gcm.test(X, Y, Z = NULL, alpha = 0.05, regr.method = "xgboost",
  regr.pars = list(), plot.residuals = FALSE, nsim = 499L,
  resid.XonZ = NULL, resid.YonZ = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gcm.test_+3A_x">X</code></td>
<td>
<p>A (nxp)-dimensional matrix (or data frame) with n observations of p variables.</p>
</td></tr>
<tr><td><code id="gcm.test_+3A_y">Y</code></td>
<td>
<p>A (nxp)-dimensional matrix (or data frame) with n observations of p variables.</p>
</td></tr>
<tr><td><code id="gcm.test_+3A_z">Z</code></td>
<td>
<p>A (nxp)-dimensional matrix (or data frame) with n observations of p variables.</p>
</td></tr>
<tr><td><code id="gcm.test_+3A_alpha">alpha</code></td>
<td>
<p>Significance level of the test.</p>
</td></tr>
<tr><td><code id="gcm.test_+3A_regr.method">regr.method</code></td>
<td>
<p>A string indicating the regression method that is used. Currently implemented are 
&quot;gam&quot;, &quot;xgboost&quot;, &quot;kernel.ridge&quot;. The regression is performed only if 
not both resid.XonZ and resid.YonZ are set to NULL.</p>
</td></tr>
<tr><td><code id="gcm.test_+3A_regr.pars">regr.pars</code></td>
<td>
<p>Some regression methods require a list of additional options.</p>
</td></tr>
<tr><td><code id="gcm.test_+3A_plot.residuals">plot.residuals</code></td>
<td>
<p>A Boolean indicating whether some plots should be shown.</p>
</td></tr>
<tr><td><code id="gcm.test_+3A_nsim">nsim</code></td>
<td>
<p>An integer indicating the number of bootstrap samples used to approximate the null distribution of the
test statistic.</p>
</td></tr>
<tr><td><code id="gcm.test_+3A_resid.xonz">resid.XonZ</code></td>
<td>
<p>It is possible to directly provide the residuals instead of performing a regression. 
If set to NULL, the regression method specified in regr.method is used.</p>
</td></tr>
<tr><td><code id="gcm.test_+3A_resid.yonz">resid.YonZ</code></td>
<td>
<p>It is possible to directly provide the residuals instead of performing a regression. 
If set to NULL, the regression method specified in regr.method is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function tests whether X is conditionally independent of Y given Z. The output is a list containing
</p>

<ul>
<li> <p><code>p.value</code>: P-value of the test. 
</p>
</li>
<li> <p><code>test.statistic</code>: Test statistic of the test.
</p>
</li>
<li> <p><code>reject</code>: Boolean that is true iff p.value &lt; alpha.
</p>
</li></ul>



<h3>References</h3>

<p>Please cite the following paper.
Rajen D. Shah, Jonas Peters: 
&quot;The Hardness of Conditional Independence Testing and the Generalised Covariance Measure&quot;
<a href="https://arxiv.org/abs/1804.07203">https://arxiv.org/abs/1804.07203</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 250 
Z &lt;- 4*rnorm(n) 
X &lt;- 2*sin(Z) + rnorm(n)
Y &lt;- 2*sin(Z) + rnorm(n)
Y2 &lt;- 2*sin(Z) + X + rnorm(n)
gcm.test(X, Y, Z, regr.method = "gam")
gcm.test(X, Y2, Z, regr.method = "gam")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
