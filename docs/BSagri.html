<!DOCTYPE html><html lang="en"><head><title>Help for package BSagri</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BSagri}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#allignment'><p> Allignment according to one factor</p></a></li>
<li><a href='#BOOTSimpson'><p> Simultaneous confidence intervals for Simpson indices</p></a></li>
<li><a href='#Brachycera'><p>Eklektor counts of Brachycera</p></a></li>
<li><a href='#c2compnames'><p> Define row names of a contrast matrix, depending on its column names</p></a></li>
<li><a href='#CCDiff'><p> Contrasts of parameters simulated in BUGS</p></a></li>
<li><a href='#CCDiff.boot'><p> Compute contrasts of chains of joint empirical distributions.</p></a></li>
<li><a href='#CCDiff.default'><p> Compute contrasts of chains of joint empirical distributions.</p></a></li>
<li><a href='#CCRatio'><p> Ratio - contrasts of parameters simulated in BUGS</p></a></li>
<li><a href='#CCRatio.boot'><p> Compute ratio contrasts of chains of joint empirical distributions.</p></a></li>
<li><a href='#CCRatio.default'><p> Compute ratio contrasts of chains of joint empirical distributions.</p></a></li>
<li><a href='#checkargssim'><p> For internal use.</p></a></li>
<li><a href='#Cica1'><p> Catches of Planthoppers and Leafhoppers</p></a></li>
<li><a href='#Cica2'><p>  Catches of Planthoppers and Leafhoppers</p></a></li>
<li><a href='#CIGLM'><p> Wrapper to compute confidence intervals from glms</p></a></li>
<li><a href='#CInp'><p> Construct local confidence intervals from joint empirical distribution.</p></a></li>
<li><a href='#CountRep'><p>Simulated count data incl. repeated measurements</p></a></li>
<li><a href='#Decomp'><p> A simulated data set</p></a></li>
<li><a href='#Diptera'><p>  Soil eklektor data for some families of Diptera</p></a></li>
<li><a href='#ExNBCov'><p> Simulated example data, drawn from a Negative Binomial Distribution</p></a></li>
<li><a href='#ExPCov'><p> Simulated example data following a Poisson distribution</p></a></li>
<li><a href='#fakeln'><p>A simulated data set of lognormal data</p></a></li>
<li><a href='#Feeding'><p> Pupation and Hatching rate in a feeding experiment with four varieties</p></a></li>
<li><a href='#IAcontrasts'><p> Interaction contrasts for 2-factorial designs</p></a></li>
<li><a href='#IAcontrastsCMAT'><p> Interaction contrasts for a two-factorial design</p></a></li>
<li><a href='#Lepi'><p> Insect counts of 12 Species</p></a></li>
<li><a href='#minus2slash'><p> Replace - by / in character strings</p></a></li>
<li><a href='#MM1'><p>Simulated data set for a simple mixed model</p></a></li>
<li><a href='#MMPois'><p> Simulated data for a simple mixed model with Poisson response</p></a></li>
<li><a href='#MMPoisRep'><p> Simulated data for a simple mixed model with Poisson response</p></a></li>
<li><a href='#modelparm.methods'><p> For internal use. Extract model parameters needed for multcomp from objects of class gamlss</p>
or geeglm.</a></li>
<li><a href='#Nematocera'><p> Trap counts of Nematocera</p></a></li>
<li><a href='#plotCI.Methods'><p> Plot confidence intervals calculated by pairwiseCI</p></a></li>
<li><a href='#print.np'><p> Print function for SCSnp</p></a></li>
<li><a href='#R2Bugsdat1w'><p> For internal use</p></a></li>
<li><a href='#R2Bugsdat1w.data.frame'><p> For internal use.</p></a></li>
<li><a href='#SCSnp'><p> Simultaneous confidence sets from empirical joint distribution.</p></a></li>
<li><a href='#simplesimint'><p> Simultaneous confidence intervals from raw estimates</p></a></li>
<li><a href='#summary.simplesimint'><p> Detailed print out for simplesimint objects</p></a></li>
<li><a href='#UnlogCI'><p> Transform confidence intervals from glm fits.</p></a></li>
<li><a href='#vcov.gamlss'><p> Extract variance covariance matrix from objects of class gamlss</p></a></li>
<li><a href='#vcov.geeglm'><p> Extract variance covariance matrix from objects of class geeglm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Safety Assessment in Agricultural Field Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-10</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-04-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Frank Schaarschmidt</td>
</tr>
<tr>
<td>Description:</td>
<td>Collection of functions, data sets and code examples 
 for evaluations of field trials with the objective of equivalence assessment.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frank Schaarschmidt &lt;schaarschmidt@biostat.uni-hannover.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>gamlss, multcomp, MCPAN</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, boot, mratios, stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-04-19 11:44:49 UTC; Schaarschmidt</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-04-20 09:15:20 UTC</td>
</tr>
</table>
<hr>
<h2 id='allignment'> Allignment according to one factor </h2><span id='topic+allignment'></span>

<h3>Description</h3>

<p>Substracts the mean or median from observations belonging to the same level of a factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allignment(response, block, type = c("mean", "median"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="allignment_+3A_response">response</code></td>
<td>
<p> a numeric vector </p>
</td></tr>
<tr><td><code id="allignment_+3A_block">block</code></td>
<td>
<p> a factor of the same length as <code>response</code> </p>
</td></tr>
<tr><td><code id="allignment_+3A_type">type</code></td>
<td>
<p> type of location measure to calculate and substract; only the choices &quot;mean&quot; and &quot;median&quot; are supported </p>
</td></tr>
<tr><td><code id="allignment_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to <code>mean</code> or <code>median</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Splits <code>response</code> according to the levels of <code>block</code>, calculates and substracts the mean or median and returns the resulting vector in appropriate order.
</p>


<h3>Value</h3>

<p>A numeric vector.
</p>

<hr>
<h2 id='BOOTSimpson'> Simultaneous confidence intervals for Simpson indices </h2><span id='topic+BOOTSimpsonD'></span><span id='topic+BOOTSimpsonR'></span>

<h3>Description</h3>

<p>NOTE: This is a Test-version and is not sufficiently checked for correctness so far.
Simultaneous confidence intervals for differences and ratios of Simpsons indices of diversity
are calculated from data sets with repeated samples of communities and designs with 
more than two treatments groups. The intervals are calculated based on a stratified, non-parametric 
ordinary bootstrap sample of Simpsonindices, and applying the Algorithm of Besag et al.(1995) on the joint
empirical distribution of differences (BOOTSimpsonD) or ratios (BOOTSimpsonR) of the original distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BOOTSimpsonD(X, f, type = "Dunnett", cmat = NULL, conf.level = 0.95,
 alternative=c("two.sided", "less", "greater"), madj=TRUE, ...)

BOOTSimpsonR(X, f, type = "Dunnett", cmat = NULL, conf.level = 0.95,
 alternative=c("two.sided", "less", "greater"), madj=TRUE, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BOOTSimpson_+3A_x">X</code></td>
<td>
<p> a data.frame of dimension n times p, containing integer entries as species counts of p species from n independent samplings</p>
</td></tr>
<tr><td><code id="BOOTSimpson_+3A_f">f</code></td>
<td>
<p> a factor, usually with more than two levels. Must be of length n, when X is an n times p matrix </p>
</td></tr>
<tr><td><code id="BOOTSimpson_+3A_type">type</code></td>
<td>
<p> a single character string, defining a contrast type. Supported options are 'Dunnett','Tukey','Sequen'; for more options, see <code>?contrMatratio</code> in <span class="pkg">mratios</span> when using <code>BOOTSimpsonR</code>
or <code>contrMat</code> in <span class="pkg">multcomp</span> when using <code>BOOTSimpsonD</code> </p>
</td></tr>
<tr><td><code id="BOOTSimpson_+3A_cmat">cmat</code></td>
<td>
<p> user defined contrasts:
when using <code>BOOTSimpsonD</code>, this should be a numeric contrast matrix, with k columns when the factor <code>f</code> has k levels and should define differences of these levels;
when using <code>BOOTSimpsonR</code>, this should be a list with two numeric contrast matrices in the entries <code>numC</code> and <code>denC</code> for numerators and denominator of the ratios, respectively; each having k columns when the factor <code>f</code> has k levels
</p>
</td></tr>
<tr><td><code id="BOOTSimpson_+3A_conf.level">conf.level</code></td>
<td>
<p>  a single numeric value between 0.5 and 1  </p>
</td></tr>
<tr><td><code id="BOOTSimpson_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, one of 'two.sided','less' and 'greater' </p>
</td></tr>
<tr><td><code id="BOOTSimpson_+3A_madj">madj</code></td>
<td>
<p> a single logical value, indicating whether simultaneous (if <code>TRUE</code>, the default) or marginal confidence intervals (if FALSE) shall be computed </p>
</td></tr>
<tr><td><code id="BOOTSimpson_+3A_...">...</code></td>
<td>
<p> Further arguments to be passed to the function <code>boot</code> from package <span class="pkg">boot</span>;
most importantly, the number of Bootstrap samples can be chosen via the parameter <code>R</code> (default is <code>R=999</code>); see <code>?boot</code> for further options.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NOTE: This is a test version!
</p>


<h3>Value</h3>

<p>If <code>madj=TRUE</code>, an object of class &quot;SCSnp&quot;, see <code><a href="#topic+SCSnp">SCSnp</a></code> for details.
If <code>madj=FALSE</code>, an object of class &quot;CInp&quot;, see <code><a href="#topic+CInp">CInp</a></code> for details.
</p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>See Also</h3>

 <p><code><a href="#topic+SCSnp">SCSnp</a></code>,
these function internally make use of <code><a href="#topic+CCDiff.boot">CCDiff.boot</a></code>, <code><a href="#topic+CCDiff.default">CCDiff.default</a></code>,
<code><a href="#topic+CCRatio.boot">CCRatio.boot</a></code>, <code><a href="#topic+CCRatio.default">CCRatio.default</a></code>,
<code>boot</code> and <code>estSimpsonf</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
X&lt;-t(rmultinom(n=40,size=100,
 prob=c(0.3,0.2,0.2,0.1,0.1,0.05,0.05)))

colnames(X)&lt;-paste("Sp",1:7,sep="")

DAT&lt;-as.data.frame(X)

f&lt;-as.factor(rep(c("A","B","C","D"),each=10))

SCIdunnettd&lt;-BOOTSimpsonD(X=DAT, f=f, type = "Dunnett",
 conf.level = 0.95, alternative = "two.sided", R=500)
 # with small no of bootstraps for illustration

SCIdunnettd


</code></pre>

<hr>
<h2 id='Brachycera'>Eklektor counts of Brachycera</h2><span id='topic+Brachycera'></span>

<h3>Description</h3>

<p>In a field trial, 4 treatments were arranged in a randomized complete block design with 8 blocks
and 32 plots. Soil eklektor traps were placed in each plot, on six dates
from 2005-07-12 to 2005-09-25, the number of individuals of Brachycera (Flies, Order Diptera)
hatching from soil were counted. The individuals were classified to the family level. Interest
was in assessing potential effects of the novel treatment (Novum) on the abundance of Brachycera, compared to a 
near standard (Standard) and two additional standard treatments, A and B.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Brachycera)</code></pre>


<h3>Format</h3>

<p>A data frame with 192 observations on the following 15 variables.
</p>

<dl>
<dt><code>Date</code></dt><dd><p>a POSIXt variable, the time of counting the individuals in the eklektor trap</p>
</dd>
<dt><code>Treatment</code></dt><dd><p>a factor with 4 levels <code>A</code> <code>B</code> <code>Standard</code> <code>Novum</code>,
where <code>Novum</code> is the novel treatment of interest in safety assessment, and <code>Standard</code> is the nearest standard treatment which commonly accepted.
<code>A</code> and <code>B</code> are two additional standard treatments.</p>
</dd>
<dt><code>Block</code></dt><dd><p>a numeric vector, specifying the eight blocks 1-8</p>
</dd>
<dt><code>Plot</code></dt><dd><p>a factor with levels <code>A1</code> <code>A2</code> to <code>Standard8</code>, indicator of the individuals plots</p>
</dd>
<dt><code>Agromy</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
<dt><code>Anthom</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
<dt><code>Callip</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
<dt><code>Chloro</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
<dt><code>Ephyd</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
<dt><code>Droso</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
<dt><code>Hybo</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
<dt><code>Musci</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
<dt><code>Phori</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
<dt><code>Sphaer</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
<dt><code>Total</code></dt><dd><p>a numeric vector, counts of individuals</p>
</dd>
</dl>



<h3>Source</h3>

<p>...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Brachycera)

par(mar=c(11,5,3,1))

boxplot(Total ~ Treatment*Date, data=Brachycera, las=2, 
col=c("white","white","blue","green"))

legend(x=15, y=80, legend=levels(Brachycera$Treatment),
 fill=c("white","white","blue","green"))

</code></pre>

<hr>
<h2 id='c2compnames'> Define row names of a contrast matrix, depending on its column names</h2><span id='topic+c2compnames'></span>

<h3>Description</h3>

<p>Define row names of a contrast matrix, depending on its column names, as can be necessary for contrasts matrices.
Currently, two options to do that are available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>c2compnames(cmat, ntype = "aggr")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="c2compnames_+3A_cmat">cmat</code></td>
<td>
<p> a contrast matrix </p>
</td></tr>
<tr><td><code id="c2compnames_+3A_ntype">ntype</code></td>
<td>
<p> a single character string,
defining how to build names from the column names of <code>cmat</code>,
currently onls <code>"aggr"</code>
(aggregates names of groups with negative and positive coefficients),
and <code>"sequ"</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input matrix cmat, with its row names replaced.
</p>


<h3>See Also</h3>

 <p><code>contrMat</code> in <span class="pkg">multcomp</span> to define contrast matrices of different types</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# names for interaction contrasts:

n1&lt;-c(10,10,10,10)
names(n1)&lt;-c("A","B","C","D")

n2&lt;-c(3,3,3)
names(n2)&lt;-c(1,2,3)

library(multcomp)

CMT1&lt;-contrMat(n1, type="Tukey")

CMT2&lt;-contrMat(n2, type="Tukey")

IAC&lt;-IAcontrastsCMAT(CMAT1=CMT1, CMAT2=CMT2)

c2compnames(IAC, ntype="aggr")

c2compnames(IAC, ntype="sequ")


###############################

# names for Williams-type contrasts:

n1&lt;-c(10,10,10,10)
names(n1)&lt;-c("C0","D1","D5","D10")


CMW&lt;-contrMat(n1, type="Williams")

CMW

c2compnames(CMW, ntype="aggr")

c2compnames(CMW, ntype="sequ")



</code></pre>

<hr>
<h2 id='CCDiff'> Contrasts of parameters simulated in BUGS </h2><span id='topic+CCDiff'></span>

<h3>Description</h3>

<p>Calculate linear combinations of parameters simulated in BUGS. This is a test version for internal use!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CCDiff(bugs, dat, cmat = NULL, 
type = c("Dunnett", "Tukey", "Sequen", "Williams", "Changepoint"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CCDiff_+3A_bugs">bugs</code></td>
<td>
<p> an object of class <code>bugs</code>, containing N values of the joint posterior distribution of in an N-times-P matrix named <code>muvec</code> </p>
</td></tr>
<tr><td><code id="CCDiff_+3A_dat">dat</code></td>
<td>
<p> an object of <code>R2Bugsdat1w</code> </p>
</td></tr>
<tr><td><code id="CCDiff_+3A_cmat">cmat</code></td>
<td>
<p> a contrast matrix of dimensions M-times-P</p>
</td></tr>
<tr><td><code id="CCDiff_+3A_type">type</code></td>
<td>
<p> a single character string, which type of comparisons to perform, if <code>cmat</code> is not given; this argument is ignored if <code>cmat</code> ist specified </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Testversion, for internal use.
</p>


<h3>Value</h3>

<p>An object of class &quot;CCDiff&quot;, a list with elements
</p>
<table role = "presentation">
<tr><td><code>chains</code></td>
<td>
<p>the N-times-M matrix of the transformed joint posterior distribution</p>
</td></tr>
<tr><td><code>bugs</code></td>
<td>
<p>the bugs object, as input</p>
</td></tr>
<tr><td><code>dat</code></td>
<td>
<p>the object of class &quot;R2Bugsdat1w&quot;, as input</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p>the M-times-P contrast matrix</p>
</td></tr>
</table>

<hr>
<h2 id='CCDiff.boot'> Compute contrasts of chains of joint empirical distributions. </h2><span id='topic+CCDiff.boot'></span>

<h3>Description</h3>

<p>Compute contrasts of chains of joint empirical distributions obtained by stratified bootstrap.
For internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CCDiff.boot(x, cmat = NULL,
 type = c("Dunnett", "Tukey", "Sequen", "Williams",
 "Changepoint", "McDermott", "GrandMean", "Marcus"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CCDiff.boot_+3A_x">x</code></td>
<td>
<p> an object of class &quot;boot&quot; as can be obtained by callinf <code>boot</code> in package <span class="pkg">boot</span> with stratified bootstrap </p>
</td></tr>
<tr><td><code id="CCDiff.boot_+3A_cmat">cmat</code></td>
<td>
<p> an optional contrast matrix, ncol(cmat) should be the same the number of strata in x </p>
</td></tr>
<tr><td><code id="CCDiff.boot_+3A_type">type</code></td>
<td>
<p> a single character string, naming a contrast type available in <code>contrMat</code> in package <span class="pkg">multcomp</span>, see <code>?contrMat</code> for details </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Testversion. For internal use.
</p>

<hr>
<h2 id='CCDiff.default'> Compute contrasts of chains of joint empirical distributions. </h2><span id='topic+CCDiff.default'></span>

<h3>Description</h3>

<p>Compute contrasts of chains of joint empirical distributions.
For internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CCDiff.default(x, cmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CCDiff.default_+3A_x">x</code></td>
<td>
<p> an N times K matrix with numeric entries </p>
</td></tr>
<tr><td><code id="CCDiff.default_+3A_cmat">cmat</code></td>
<td>
<p> a contrast matrix with K columns </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Denote the elements of <code>x</code> by <code class="reqn">x_{nk}</code> and denote the elements of <code>cmat</code> by
<code class="reqn">c_{mk}</code>. Function <code>CCDiff.default</code> simply calculates:
</p>
<p style="text-align: center;"><code class="reqn">\sum_{k=1}^{K}c_{mk}x_{nk}</code>
</p>
<p> for each m=1,...,M and n=1,...,N.
The result is a N times M matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# What the function does:

# a 10 times 4 matrix

X&lt;-round(cbind(
 rnorm(10,1,1),
 rnorm(10,1,1),
 rnorm(10,1,1),
 rnorm(10,1,1)))

# and a x times 4 contrast matrix

CMAT&lt;-rbind(
c(-1,1,0,0),
c(-1,0,1,0),
c(-1,0,0,1)
)

CCDiff.default(x=X, cmat=CMAT)

</code></pre>

<hr>
<h2 id='CCRatio'> Ratio - contrasts of parameters simulated in BUGS </h2><span id='topic+CCRatio'></span>

<h3>Description</h3>

<p>Calculate ratios of parameters simulated in BUGS. This is a test version for internal use!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CCRatio(bugs, dat, cmat = NULL,
 type = c("Dunnett", "Tukey", "Sequen", "Williams", "Changepoint"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CCRatio_+3A_bugs">bugs</code></td>
<td>
<p> an object of class <code>bugs</code>, containing N values of the joint posterior distribution of in an N-times-P matrix named <code>muvec</code> </p>
</td></tr>
<tr><td><code id="CCRatio_+3A_dat">dat</code></td>
<td>
<p> an object of <code>R2Bugsdat1w</code> </p>
</td></tr>
<tr><td><code id="CCRatio_+3A_cmat">cmat</code></td>
<td>
<p> a list containing two contrast matrices of dimensions M-times-P as elements <code>numC</code>, <code>denC</code> giving the numerator and denominator coefficients for the ratios to be calculated</p>
</td></tr>
<tr><td><code id="CCRatio_+3A_type">type</code></td>
<td>
<p> a single character string, which type of comparisons to perform, if <code>cmat</code> is not given; this argument is ignored if <code>cmat</code> ist specified </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A testversion.
</p>


<h3>Value</h3>

<p>An object of class &quot;CCRatio&quot;, a list with elements
</p>
<table role = "presentation">
<tr><td><code>chains</code></td>
<td>
<p>the N-times-M matrix of the transformed joint posterior distribution</p>
</td></tr>
<tr><td><code>bugs</code></td>
<td>
<p>the bugs object, as input</p>
</td></tr>
<tr><td><code>dat</code></td>
<td>
<p>the object of class &quot;R2Bugsdat1w&quot;, as input</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p>the M-times-P contrast matrix</p>
</td></tr>
</table>

<hr>
<h2 id='CCRatio.boot'> Compute ratio contrasts of chains of joint empirical distributions. </h2><span id='topic+CCRatio.boot'></span>

<h3>Description</h3>

<p>Compute contrasts of chains of joint empirical distributions.
For internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CCRatio.boot(x, cmat = NULL,
 type = c("Dunnett", "Tukey", "Sequen", "Williams",
 "Changepoint", "McDermott", "GrandMean", "Marcus"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CCRatio.boot_+3A_x">x</code></td>
<td>
<p> an object of class &quot;boot&quot; as can be obtained by callinf <code>boot</code> in package <span class="pkg">boot</span> with stratified bootstrap </p>
</td></tr>
<tr><td><code id="CCRatio.boot_+3A_cmat">cmat</code></td>
<td>
<p> an optional list of two contrast matrices, in entries <code>numC</code> and <code>denC</code> of the list;
ncol(numC) and ncol(denC) should be the same the number of strata in x </p>
</td></tr>
<tr><td><code id="CCRatio.boot_+3A_type">type</code></td>
<td>
<p> a single character string, naming a contrast type available in <code>contrMatRatio</code> in package <span class="pkg">mratios</span>, see <code>?contrMatRatio</code> for details </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Testversion. For internal use.
</p>

<hr>
<h2 id='CCRatio.default'> Compute ratio contrasts of chains of joint empirical distributions. </h2><span id='topic+CCRatio.default'></span>

<h3>Description</h3>

<p>Compute ratio contrasts of chains of joint empirical distributions.
For internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CCRatio.default(x, cmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CCRatio.default_+3A_x">x</code></td>
<td>
<p> an N times K matrix with numeric entries </p>
</td></tr>
<tr><td><code id="CCRatio.default_+3A_cmat">cmat</code></td>
<td>
<p> a list with entries <code>numC</code> and <code>denC</code>,
each containing a contrast matrix with K columns (must be the same K as in x!)
and M rows (is your choice, the number of contrasts of interest) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Denote the elements of <code>x</code> by <code class="reqn">x_{nk}</code>.
Denote the numetator of <code>cmat</code> by <code class="reqn">C</code> 
with elements <code class="reqn">c_{mk}</code> and the denominator of <code>cmat</code> as
<code class="reqn">D</code> with elements <code class="reqn">d_{mk}</code>.
Function <code>CCRatio.default</code> simply calculates
</p>
<p style="text-align: center;"><code class="reqn">\frac{\sum_{k=1}^{K}c_{mk}x_{nk}}{\sum_{k=1}^{K}d_{mk}x_{nk}}</code>
</p>
<p> for each m=1,...,M and n=1,...,N.
The result is a N times M matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

X&lt;-round(cbind(
 rnorm(10,1,1),
 rnorm(10,1,1),
 rnorm(10,1,1),
 rnorm(10,1,1)))

# and numerator and denominator
# x times 4 contrast matrix

NMAT&lt;-rbind(
c(1,0,0,0),
c(1,0,0,0),
c(1,0,0,0)
)


DMAT&lt;-rbind(
c(0,1,0,0),
c(0,0,1,0),
c(0,0,0,1)
)


CCRatio.default(x=X, cmat=list(numC=NMAT, denC=DMAT) )


</code></pre>

<hr>
<h2 id='checkargssim'> For internal use. </h2><span id='topic+checkargssim'></span>

<h3>Description</h3>

<p>For internal use. Check the appropriateness of input arguments of function simplesimint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkargssim(coef, vcov, cmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkargssim_+3A_coef">coef</code></td>
<td>
<p> a vector of parameters </p>
</td></tr>
<tr><td><code id="checkargssim_+3A_vcov">vcov</code></td>
<td>
<p> the corresponding covariance matrix </p>
</td></tr>
<tr><td><code id="checkargssim_+3A_cmat">cmat</code></td>
<td>
<p> a contrast matrix </p>
</td></tr>
</table>

<hr>
<h2 id='Cica1'> Catches of Planthoppers and Leafhoppers </h2><span id='topic+Cica1'></span>

<h3>Description</h3>

<p>Data of a field trial concerning the impact of a genetically modified variety on the abundance of Planthoppers and Leafhoppers.
The trial was designed as a randomized complete block design with 8 blocks (Row). In each block, three treatments
were randomized: a conventional variety treated with insecticides (Insecticide), a genetically modified variety (GM),
and the near-isogenic line (Iso) the to genetically modified line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Cica1)</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 6 variables.
</p>

<dl>
<dt><code>Field</code></dt><dd><p>a factor with levels <code>1</code> <code>2</code>, separating the two major sites of the trial. On field 1, the blocks 1-5 were situated, on field 2, blocks 6-8 were situated. </p>
</dd>
<dt><code>Row</code></dt><dd><p>a factor with 8 levels, specifying the blocks:<code>R1</code> <code>R2</code> <code>R3</code> <code>R4</code> <code>R5</code> <code>R6</code> <code>R7</code> <code>R8</code></p>
</dd>
<dt><code>Year</code></dt><dd><p>a numeric vector, for year 1 of the trial</p>
</dd>
<dt><code>Treatment</code></dt><dd><p>a factor with 3 levels, specifying the genetically modified variety <code>GM</code>,
the conventional variety treated with insecticides <code>Insecticide</code>,
and the variety that was near-isogenic to the GM variety <code>Iso</code></p>
</dd>
<dt><code>Au_Bonitur</code></dt><dd><p>Counts of Auchenorryhncha by visual assessment</p>
</dd>
<dt><code>Zs_sweep_netting</code></dt><dd><p>Counts of the major species Zyginidia scutellaris, catched by sweep nets</p>
</dd>
</dl>



<h3>Source</h3>

<p>...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cica1)

layout(matrix(1:2,ncol=1))

ylim&lt;-range(Cica1[,c("Au_Bonitur","Zs_sweep_netting")])

boxplot(Au_Bonitur ~ Treatment, data=Cica1,
 main= "Aucherrhyncha, visual assessment", ylim=ylim)

boxplot(Zs_sweep_netting ~ Treatment, data=Cica1,
 main="Z.scutellaris, sweep netting", ylim=ylim)


</code></pre>

<hr>
<h2 id='Cica2'>  Catches of Planthoppers and Leafhoppers </h2><span id='topic+Cica2'></span>

<h3>Description</h3>

<p>Data of a field trial concerning the impact of a genetically modified variety on the abundance of Planthoppers and Leafhoppers.
The trial was designed as a randomized complete block design with 8 blocks (Row). In each block, three treatments
were randomized: a conventional variety treated with insecticides (Insecticide), a genetically modified variety (GM),
and the near-isogenic line (Iso) the to genetically modified line. These data originate from the second year of the trial in Cica1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Cica2)</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 8 variables.
</p>

<dl>
<dt><code>Field</code></dt><dd><p>a factor with 2 levels, <code>1</code> <code>2</code>, separating the two major sites of the trial. On field 1, the blocks 1-5 were situated, on field 2, blocks 6-8 were situated.</p>
</dd>
<dt><code>Row</code></dt><dd><p>a factor with 8 levels, specifying the blocks: <code>R1</code> <code>R2</code> <code>R3</code> <code>R4</code> <code>R5</code> <code>R6</code> <code>R7</code> <code>R8</code></p>
</dd>
<dt><code>Year</code></dt><dd><p>a numeric vector, with value 2 for the second year </p>
</dd>
<dt><code>Treatment</code></dt><dd><p>a factor with 3 levels, specifying the genetically modified variety <code>GM</code>,
the conventional variety treated with insecticides <code>Insecticide</code>,
and the variety that was near-isogenic to the GM variety <code>Iso</code></p>
</dd>
<dt><code>Au_Bonitur</code></dt><dd><p>counts of Auchenorryhncha by visual assessment</p>
</dd>
<dt><code>Zs_sweep_netting</code></dt><dd><p>counts of the major species Zyginidia scutellaris, catched by sweep nets</p>
</dd>
<dt><code>Zs_yellow_traps</code></dt><dd><p>counts of Zyginidia scutellaris, catched by yellow traps</p>
</dd>
<dt><code>Zs_stick_traps</code></dt><dd><p>counts of Zyginidia scutellaris, catched by sticky traps</p>
</dd>
</dl>



<h3>Source</h3>

<p>...
</p>


<h3>References</h3>

<p>See <code><a href="#topic+Cica1">Cica1</a></code> for data of the same trial a year earlier
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cica2)


# A comparison of the treatments:

layout(matrix(1:4,ncol=4))

ylim&lt;-range(Cica2[,c("Au_Bonitur","Zs_sweep_netting", "Zs_yellow_traps", "Zs_stick_traps")])

boxplot(Au_Bonitur ~ Treatment, data=Cica2,
 main= "Aucherrhyncha, visual assessment", ylim=ylim, horizontal=TRUE, las=1)

boxplot(Zs_sweep_netting ~ Treatment, data=Cica2,
 main="Z.scutellaris, sweep netting", ylim=ylim, horizontal=TRUE, las=1)

boxplot(Zs_yellow_traps ~ Treatment, data=Cica2,
 main="Z.scutellaris, yellow traps", ylim=ylim, horizontal=TRUE, las=1)

boxplot(Zs_stick_traps ~ Treatment, data=Cica2,
 main="Z.scutellaris, sticky traps", ylim=ylim, horizontal=TRUE, las=1)

# A comparison of sampling methods:

pairs(Cica2[,c("Au_Bonitur","Zs_sweep_netting", "Zs_yellow_traps", "Zs_stick_traps")])

</code></pre>

<hr>
<h2 id='CIGLM'> Wrapper to compute confidence intervals from glms </h2><span id='topic+CIGLM'></span>

<h3>Description</h3>

<p>Computes confidence intervals from the output of a glm, by calling to glht(multcomp).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIGLM(x, conf.level = 0.95, method = c("Raw", "Adj", "Bonf"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CIGLM_+3A_x">x</code></td>
<td>
<p> a object of class <code>"glm"</code>, <code>"gamlss"</code>, or <code>"glm.nb"</code> as can be obtained by calling to function <code>glm</code>, function <code>gamlss</code> in package <code>gamlss</code>, or function <code>glm.nb</code> in package <code>MASS</code>  </p>
</td></tr>
<tr><td><code id="CIGLM_+3A_conf.level">conf.level</code></td>
<td>
<p>  confidence level, a single numeric value between 0.5 and 1 </p>
</td></tr>
<tr><td><code id="CIGLM_+3A_method">method</code></td>
<td>
<p> a single character string, with <code>"Raw"</code> for unadjusted intervals, <code>"Adj"</code> for multiplicity adjusted intervals taking the correlations into account, or <code>"Bonf"</code> for a Bonferroni adjustment </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is just a wrapper to <code>confint.glht</code> of package <code>multcomp</code>.
</p>
<p>Note that except for the simple general linear model with assumption of Gaussian response, the resulting intervals are exact intervals.
In other cases, the methods are only asymptotically correct, hence might give misleading results for small sample sizes!
</p>


<h3>Value</h3>

<p>An object of class <code>"confint.glht"</code>
</p>


<h3>See Also</h3>

 <p><code>confint.glht</code> in package <code>multcomp</code> for the function that is used internally,
<code><a href="#topic+UnlogCI">UnlogCI</a></code> for a simple function to bring confidence intervals back to the original scales
when there is a log or logit link, with appropriate naming.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Diptera)
library(multcomp)

modelfit &lt;- glm(Ges ~ Treatment, data=Diptera, family=quasipoisson)
comps &lt;- glht(modelfit, mcp(Treatment="Tukey"))
CIs&lt;-CIGLM(comps, method="Raw")
CIs

CIsAdj&lt;-CIGLM(comps, method="Adj")
CIsAdj

CIsBonf&lt;-CIGLM(comps, method="Bonf")
CIsBonf

library(gamlss)

modelfit2 &lt;- gamlss(Ges ~ Treatment, data=Diptera, family=NBI)
comps2 &lt;- glht(modelfit2, mcp(Treatment="Tukey"))
CIs2&lt;-CIGLM(comps2, method="Raw")
CIs2

CIsAdj2&lt;-CIGLM(comps2, method="Adj")
CIsAdj2

CIsBonf2&lt;-CIGLM(comps2, method="Bonf")
CIsBonf2



</code></pre>

<hr>
<h2 id='CInp'> Construct local confidence intervals from joint empirical distribution. </h2><span id='topic+CInp'></span><span id='topic+CInp.default'></span><span id='topic+CInp.CCRatio'></span><span id='topic+CInp.CCDiff'></span><span id='topic+CInp.bugs'></span>

<h3>Description</h3>

<p>Construct local confidence intervals for each parameter from the empirical joint distribution of 
a parameter vector of length P. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## Default S3 method:
CInp(x, conf.level = 0.95,
 alternative = "two.sided", ...)

## S3 method for class 'CCRatio'
CInp(x, ...)

## S3 method for class 'CCDiff'
CInp(x, ...)

## S3 method for class 'bugs'
CInp(x, conf.level = 0.95,
 alternative = "two.sided", whichp = NULL, ...)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CInp_+3A_x">x</code></td>
<td>
<p> an N-times-P matrix, or an object of class <code>CCRatio</code>, <code>CCDiff</code>, <code>bugs</code>, as can be obtained by calling the functions <code><a href="#topic+CCRatio">CCRatio</a></code>, <code><a href="#topic+CCDiff">CCDiff</a></code>, or <code>openbugs</code> in package <code>R2WinBUGS</code> </p>
</td></tr>
<tr><td><code id="CInp_+3A_conf.level">conf.level</code></td>
<td>
<p> a single numeric value between 0.5 and 1, specifying the local confidence level for each of the P parameters </p>
</td></tr>
<tr><td><code id="CInp_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, one of <code>"two.sided"</code>, <code>"less"</code>, <code>"greater"</code>, for two-sided, upper and lower limits  </p>
</td></tr>
<tr><td><code id="CInp_+3A_whichp">whichp</code></td>
<td>
<p> a single character string, naming an element of the <code>sims.list</code> if <code>x</code> is a <code>bugs</code> object, ignored otherwise </p>
</td></tr>
<tr><td><code id="CInp_+3A_...">...</code></td>
<td>
<p>currently not used </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Construct simple confidence intervals based on order statistics applied to the marginal empirical distributions in <code>x</code>.
</p>


<h3>Value</h3>

<p>An object of class &quot;CInp&quot;, a list with elements
</p>
<table role = "presentation">
<tr><td><code>conf.int</code></td>
<td>
<p>a P-times-2 matrix containing the lower and upper confidence limits</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>a numeric vector of length P, containing the medians of the P marginal empirical distributions</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> the input object</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p> the number of values outside each confidence interval, i.e. conf.level*N</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p> the number of values used to construct each confidence interval</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>a single numeric value, the nominal confidence level, as input</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a single character string, as input</p>
</td></tr>
</table>


<h3>See Also</h3>

<p> The function internally used is <code><a href="stats.html#topic+quantile">quantile</a></code> with its default settings. 
See <code><a href="#topic+SCSnp">SCSnp</a></code> for simultaneous sets.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Assume a 100 times 4 matrix of 4 mutually independent
# normal variables:

X&lt;-cbind(rnorm(100), rnorm(100), rnorm(100), rnorm(100))

lcits&lt;-CInp(x=X, conf.level=0.95, alternative="two.sided")
lcits

ci1&lt;-lcits$conf.int[1,]
length( which(X[,1]&gt;=ci1[1] &amp; X[,1]&lt;=ci1[2] ) )


ci2&lt;-lcits$conf.int[2,]
length( which(X[,2]&gt;=ci2[1] &amp; X[,2]&lt;=ci2[2] ) )


</code></pre>

<hr>
<h2 id='CountRep'>Simulated count data incl. repeated measurements</h2><span id='topic+CountRep'></span>

<h3>Description</h3>

<p>Simulated data set of repeated count data within subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CountRep)</code></pre>


<h3>Format</h3>

<p>A data frame with 160 observations on the following 4 variables.
</p>

<dl>
<dt><code>Abundance</code></dt><dd><p>a numeric vector with counts simulated from overdispersed and autocorrelated Poisson distributions</p>
</dd>
<dt><code>ID</code></dt><dd><p>a factor with levels <code>N1</code> <code>N2</code> ,..., <code>n40</code>, specifying the subject</p>
</dd>
<dt><code>Time</code></dt><dd><p>a factor with levels <code>T1</code> <code>T2</code> <code>T3</code> <code>T4</code>, specifying the time</p>
</dd>
<dt><code>Treatment</code></dt><dd><p>a factor with levels <code>N</code> <code>S1</code> <code>S2</code> <code>S3</code></p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(CountRep)


</code></pre>

<hr>
<h2 id='Decomp'> A simulated data set</h2><span id='topic+Decomp'></span>

<h3>Description</h3>

<p>A simulated data set, resembling an experiment on the decomposition
of plant material from four different varieties in soil.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Decomp)</code></pre>


<h3>Format</h3>

<p>A data frame with 1152 observations on the following 5 variables.
</p>

<dl>
<dt><code>Block</code></dt><dd><p>a numeric vector, giving the names of the Blocks</p>
</dd>
<dt><code>PID</code></dt><dd><p>a numeric vector, giving the the number of the experimental unit</p>
</dd>
<dt><code>Variety</code></dt><dd><p>a factor with levels <code>N</code> <code>S1</code> <code>S2</code> <code>S3</code>, specifying the variety assigned to the experimental unit, randomized within each Block</p>
</dd>
<dt><code>Time</code></dt><dd><p>a factor with levels <code>t1</code> <code>t2</code> <code>t3</code> <code>t4</code> <code>t5</code> <code>t6</code>, specifying time points at which measurements were taken</p>
</dd>
<dt><code>Perc</code></dt><dd><p>a numeric vector, giving the percentage of material</p>
</dd>
</dl>



<h3>Details</h3>

<p>The experiment is a randomized complete block design, with repeated measurements within each experimental unit and additional subsamplings within each time point.
Plant material from four different varieties was deposited in bags in soil of 32 experimental units (coded by the variable PID), where the varieties had been grown in the vegetation period before. A total number of 36 bags was placed in each experimental unit.
At six different time points, plant material was excavated and the content of the bags was analysed concerning the percentage of decomposition relative to the content at the begin of the experiment.
At each time point, six bags were excavated at each experimental unit. Some bags could not be found anymore (data missing).
The objective was to assess whether properties of the varieties obstruct the decompostion of plant material in the soil. The variety <code>N</code> is of special interest, while the varieties <code>S1</code>, <code>S2</code>, <code>S3</code> are standard varieties.  
</p>
<p>Note, that this data set merely serves as an example to evaluate clustered data. Neither in the mean effects nor in the actual data points it does resemble a true experiment!
</p>


<h3>Source</h3>

<p>Simulated.
</p>


<h3>References</h3>

<p>Resembling the experimental structure of an experiment performed by Sabine Prescher (JKI Braunschweig).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Decomp)

</code></pre>

<hr>
<h2 id='Diptera'>  Soil eklektor data for some families of Diptera</h2><span id='topic+Diptera'></span>

<h3>Description</h3>

<p>Hatching of some families of Diptera was recorded in summer 2005 using eklektors covering 2 square meters
of soil surface each. A total of 32 eklektors were arranged in a randomized field trial. Total counts of
individuals over the whole season are reported. Aim was to assess the impact of a novel treatment on the abundance of
Diptera with larval development in the soil, compared to three standard treatments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Diptera)</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 7 variables.
</p>

<dl>
<dt><code>Callip</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Chloro</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Ephyd</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Droso</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Ges</code></dt><dd><p>a numeric vector, total number of species</p>
</dd>
<dt><code>Chiro</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Treatment</code></dt><dd><p>a factor, specifying the four different treatments,
with levels <code>S1</code> <code>S2</code> for two standard treatments, <code>SNovum</code> for the standard treatment most similar to the novel treatment, and <code>Novum</code>, for the novel treatment</p>
</dd>
</dl>



<h3>Source</h3>

<p>personal communications S. Prescher, JKI Braunschweig, Germany
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Diptera)


layout(matrix(1:6, nrow=3))

boxplot(Callip~Treatment, data=Diptera, horizontal=TRUE, las=1,
 main="Abundanz Callip", col=c("white","white","blue","red"))

boxplot(Chloro~Treatment, data=Diptera, horizontal=TRUE, las=1,
 main="Abundanz Chloro", col=c("white","white","blue","red"))

boxplot(Ephyd~Treatment, data=Diptera, horizontal=TRUE, las=1,
 main="Abundanz Ephyd", col=c("white","white","blue","red"))

boxplot(Droso~Treatment, data=Diptera, horizontal=TRUE, las=1,
 main="Abundanz Droso", col=c("white","white","blue","red"))

boxplot(Chiro~Treatment, data=Diptera, horizontal=TRUE, las=1,
 main="Abundanz Chiro", col=c("white","white","blue","red"))

boxplot(Ges~Treatment, data=Diptera, horizontal=TRUE, las=1,
 main="Abundanz all Diptera", col=c("white","white","blue","red"))


</code></pre>

<hr>
<h2 id='ExNBCov'> Simulated example data, drawn from a Negative Binomial Distribution</h2><span id='topic+ExNBCov'></span>

<h3>Description</h3>

<p>Simulated example data, response drawn from a Negative Binomial Distribution,
Covariables follow a multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ExNBCov)</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 12 variables.
</p>

<dl>
<dt><code>Resp</code></dt><dd><p>a numeric vector, a response of counts</p>
</dd>
<dt><code>Group</code></dt><dd><p>a factor with levels <code>A1</code> <code>A2</code> <code>A3</code> <code>A4</code>, e.g. varieties</p>
</dd>
<dt><code>X1</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>X2</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>X3</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>X4</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>X5</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>X6</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>X7</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>X8</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>X9</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>X10</code></dt><dd><p>a numeric covariable</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(ExNBCov)

boxplot(Resp ~ Group, data=ExNBCov)

pairs(ExNBCov)

</code></pre>

<hr>
<h2 id='ExPCov'> Simulated example data following a Poisson distribution</h2><span id='topic+ExPCov'></span>

<h3>Description</h3>

<p>Reponse follows a Poisson distribution, the covariables follow a multivariate normal on the log-scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ExPCov)</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 12 variables.
</p>

<dl>
<dt><code>resp</code></dt><dd><p>a response of counts</p>
</dd>
<dt><code>A</code></dt><dd><p>a factor with levels <code>A1</code> <code>A2</code> <code>A3</code> <code>A4</code>, e.g. varieties</p>
</dd>
<dt><code>C1</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>C2</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>C3</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>C4</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>C5</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>C6</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>C7</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>C8</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>C9</code></dt><dd><p>a numeric covariable</p>
</dd>
<dt><code>C10</code></dt><dd><p>a numeric covariable</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(ExPCov)

boxplot(resp ~ A, data=ExPCov)

pairs(ExPCov)

</code></pre>

<hr>
<h2 id='fakeln'>A simulated data set of lognormal data</h2><span id='topic+fakeln'></span>

<h3>Description</h3>

<p>A simulated data set of lognormal data, could be concentrations 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fakeln)</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 2 variables.
</p>

<dl>
<dt><code>Concmug</code></dt><dd><p>a numeric vector, serving as response variable</p>
</dd>
<dt><code>Treat</code></dt><dd><p>a factor with levels <code>N</code> <code>S</code> <code>Sa</code> <code>Sb</code></p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(fakeln)
boxplot(Concmug ~ Treat, data=fakeln)
</code></pre>

<hr>
<h2 id='Feeding'> Pupation and Hatching rate in a feeding experiment with four varieties</h2><span id='topic+Feeding'></span>

<h3>Description</h3>

<p>Larvae of a non-target organism were fed with plant material derived from a novel variety(Novum),
material from three standard varieties (NStandard: the standard variety most similar to Novum,
and two additional standard varieties S1 and S2). Objective was to assess the impact of Novum on the pupation and hatching rate of an animal that potentially feeds on plant material compared to accepted standard varieties.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Feeding)</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 5 variables.
</p>

<dl>
<dt><code>Rep</code></dt><dd><p>a factor with 32 levels indexing the 32 replications</p>
</dd> 
<dt><code>Variety</code></dt><dd><p>a factor with 4 levels: <code>S1</code> and <code>S2</code> are two standard varieties, <code>Novum</code> is a novel variety, and <code>NStandard</code> is the standard variety most similar to <code>Novum</code> </p>
</dd>
<dt><code>Total</code></dt><dd><p>the total number of animals in each experimental unit</p>
</dd>
<dt><code>Pupating</code></dt><dd><p>number of individuals pupating in each unit, the others died</p>
</dd>
<dt><code>Hatching</code></dt><dd><p>number of individuals hatching from the pupae</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(Feeding)

# Larval mortality:

Feeding$Lmort &lt;- Feeding$Total - Feeding$Pupating

fit1&lt;-glm(cbind(Pupating,Lmort)~Variety,data=Feeding, family=quasibinomial)
anova(fit1, test="F")


</code></pre>

<hr>
<h2 id='IAcontrasts'> Interaction contrasts for 2-factorial designs </h2><span id='topic+IAcontrasts'></span>

<h3>Description</h3>

<p>Builds a family of intercation contrasts for complete two-factorial designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IAcontrasts(type, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IAcontrasts_+3A_type">type</code></td>
<td>
<p> a vector of two character strings, specifying the contrast <code>type</code>, currently, <code>"Tukey"</code>, <code>"Dunnett"</code>, <code>"Sequence"</code> or <code>"Identity"</code> are accepted </p>
</td></tr>
<tr><td><code id="IAcontrasts_+3A_k">k</code></td>
<td>
<p> a vector of two integers, specifying the number of groups in each factor of the two-factorial design </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates contrast matrices using <code>contrMat</code> from package <span class="pkg">multcomp</span>, creates the kronecker product of both and creates suitable columnnames.
</p>


<h3>Value</h3>

<p>A matrix with k[1]*k[2] columns and a number of rows depending on type.
</p>


<h3>See Also</h3>

<p> for 2-way interaction contrasts directly based on 2 contrasts matrices, see <code><a href="#topic+IAcontrastsCMAT">IAcontrastsCMAT</a></code>;
two possibilities to specify appropriate rownames are implemented in function <code><a href="#topic+c2compnames">c2compnames</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
IAC&lt;-IAcontrasts(type=c("Tukey", "Tukey"), k=c(3,4))

IAC

IAC2&lt;-c2compnames(IAC, ntype="sequ")
IAC2

</code></pre>

<hr>
<h2 id='IAcontrastsCMAT'> Interaction contrasts for a two-factorial design </h2><span id='topic+IAcontrastsCMAT'></span>

<h3>Description</h3>

<p>Builds a family of intercation contrasts for complete two-factorial designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IAcontrastsCMAT(CMAT1, CMAT2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IAcontrastsCMAT_+3A_cmat1">CMAT1</code></td>
<td>
<p> a (named) contrast matrix </p>
</td></tr>
<tr><td><code id="IAcontrastsCMAT_+3A_cmat2">CMAT2</code></td>
<td>
<p> a (named) contrast matrix </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Builds the kronecker product of <code>CMAT1</code> and <code>CMAT2</code> and creates suitable columnnames.
Note that <code>CMAt1</code> and <code>CMAT2</code> are not checked, and hence its up to the user to define them suitably.
</p>


<h3>Value</h3>

<p>A matrix with k[1]*k[2] columns.
</p>


<h3>See Also</h3>

<p> for interaction contrasts based on contrast definition and the number of levels of the factors in atwo-way layout, see <code><a href="#topic+IAcontrasts">IAcontrasts</a></code>;
two possibilities to specify appropriate rownames are implemented in function <code><a href="#topic+c2compnames">c2compnames</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(multcomp)


n1&lt;-c(10,10,10,10)
names(n1)&lt;-c("A","B","C","D")

n2&lt;-c(3,3,3)
names(n2)&lt;-c(1,2,3)

CMT1&lt;-contrMat(n1, type="Tukey")

CMT2&lt;-contrMat(n2, type="Tukey")

IAC&lt;-IAcontrastsCMAT(CMAT1=CMT1, CMAT2=CMT2)

c2compnames(IAC, ntype="sequ")

###


n1&lt;-c(10,10,10,10)
names(n1)&lt;-c("A","B","C","D")

n2&lt;-c(3,3,3)
names(n2)&lt;-c(1,2,3)

CMD1&lt;-contrMat(n1, type="Dunnett")

CMD2&lt;-contrMat(n2, type="Dunnett")

IAC&lt;-IAcontrastsCMAT(CMAT1=CMD1, CMAT2=CMD2)

c2compnames(IAC, ntype="sequ")


</code></pre>

<hr>
<h2 id='Lepi'> Insect counts of 12 Species</h2><span id='topic+Lepi'></span>

<h3>Description</h3>

<p>Simulated data, inpired by a real field investigating the potential impact of genetically modified crop
on several insect species belonging to the same order. The trial was designed as a randomized complete block design with 8 blocks
(Block), and a total of 24 plots. In each block, three treatments (Treatment) were randomized:
a conventional variety treated with insecticides (Ins), a genetically modified variety (GM) without insecticide treatment,
and the near-isogenic variety (Iso) the to genetically modified variety, without insecticide treatment.
Individuals were counted (after classification to the species level) in two different dates in each year of the trial, where the the second date
was of higher importance for assessment of impacts of GM variety on non-target species. In total 12 Species were observed during the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Lepi)</code></pre>


<h3>Format</h3>

<p>A data frame with 144 observations on the following 17 variables.
</p>

<dl>
<dt><code>Year</code></dt><dd><p>a numeric vector, the year 1, 2, 3</p>
</dd>
<dt><code>Date</code></dt><dd><p>a numeric vector, 1 and 2 separating the 2 sampling date in each year </p>
</dd>
<dt><code>Block</code></dt><dd><p>a numeric vector, with values 1-8, indicator variable for the 8 blocks</p>
</dd>
<dt><code>Treatment</code></dt><dd><p>a factor with three levels identifying the varieties: <code>GM</code> is the genetically modified variety,
<code>Ins</code> the conventional variety with insecticide treatment and <code>Iso</code> the near isognic line without insecticide treatment</p>
</dd>
<dt><code>Plot</code></dt><dd><p>a factor with 24 levels, identifying the individual plots</p>
</dd>
<dt><code>Sp1</code></dt><dd><p>counts of taxon 1</p>
</dd>
<dt><code>Sp2</code></dt><dd><p>counts of taxon 2</p>
</dd>
<dt><code>Sp3</code></dt><dd><p>counts of taxon 3</p>
</dd>
<dt><code>Sp4</code></dt><dd><p>counts of taxon 4</p>
</dd>
<dt><code>Sp5</code></dt><dd><p>counts of taxon 5</p>
</dd>
<dt><code>Sp6</code></dt><dd><p>counts of taxon 6</p>
</dd>
<dt><code>Sp7</code></dt><dd><p>counts of taxon 7</p>
</dd>
<dt><code>Sp8</code></dt><dd><p>counts of taxon 8</p>
</dd>
<dt><code>Sp9</code></dt><dd><p>counts of taxon 9</p>
</dd>
<dt><code>Sp10</code></dt><dd><p>counts of taxon 10</p>
</dd>
<dt><code>Sp11</code></dt><dd><p>counts of taxon 11</p>
</dd>
<dt><code>Sp12</code></dt><dd><p>counts of taxon 12</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Lepi)

str(Lepi)

summary(Lepi)

SPEC&lt;-names(Lepi)[-(1:5)]

# Occurrence

occur&lt;-lapply(X=Lepi[,SPEC], FUN=function(x){length(which(x&gt;0))})

unlist(occur)

# Species with reasonable occurence in the whole data:

SPEC2&lt;-SPEC[c(1,2,3,6,8,9,11)]

pairs(Lepi[,SPEC2])

# 


layout(matrix(1:2, ncol=1 ))
par(mar=c(2,8,2,1))

boxplot(Sp2 ~ Treatment*Year, data=Lepi, main="Species 2",
 las=1, horizontal=TRUE, col=c("red","white","white"))

boxplot(Sp3 ~ Treatment*Year, data=Lepi, main="Species 3",
 las=1, horizontal=TRUE, col=c("red","white","white"))


</code></pre>

<hr>
<h2 id='minus2slash'> Replace - by / in character strings</h2><span id='topic+minus2slash'></span>

<h3>Description</h3>

<p>Replace - by / in character strings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minus2slash(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="minus2slash_+3A_x">x</code></td>
<td>
<p> a vector of character strings </p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of character strings
</p>

<hr>
<h2 id='MM1'>Simulated data set for a simple mixed model</h2><span id='topic+MM1'></span>

<h3>Description</h3>

<p>Simulated data set for a simple mixed model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MM1)</code></pre>


<h3>Format</h3>

<p>A data frame with 160 observations on the following 3 variables.
</p>

<dl>
<dt><code>Y</code></dt><dd><p>a numeric vector, the response, sampled from a normal distribution</p>
</dd>
<dt><code>F</code></dt><dd><p>a factor with levels <code>F1</code> <code>F2</code> <code>F3</code> <code>F4</code>, representing fixed effects</p>
</dd>
<dt><code>R</code></dt><dd><p>a factor with levels <code>R1</code> <code>R2</code> <code>R3</code> <code>R4</code> <code>R5</code>, representing random effects, sampled from a normal distribution</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(MM1)
boxplot(Y~F*R, data=MM1)
</code></pre>

<hr>
<h2 id='MMPois'> Simulated data for a simple mixed model with Poisson response</h2><span id='topic+MMPois'></span>

<h3>Description</h3>

<p>A fixed factor F (four levels) and a random factor (five levels), modifying the mean response (random Intercept)
Y is a variable following a Poisson distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MMPois)</code></pre>


<h3>Format</h3>

<p>A data frame with 160 observations on the following 3 variables.
</p>

<dl>
<dt><code>Y</code></dt><dd><p>a numeric vector, the Poisson distributed response.</p>
</dd>
<dt><code>F</code></dt><dd><p>a factor with levels <code>F1</code> <code>F2</code> <code>F3</code> <code>F4</code></p>
</dd>
<dt><code>R</code></dt><dd><p>a factor with levels <code>R1</code> <code>R2</code> <code>R3</code> <code>R4</code> <code>R5</code></p>
</dd>
</dl>



<h3>Source</h3>

<p>simulation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MMPois)

boxplot(Y~R*F, data=MMPois, las=2)

</code></pre>

<hr>
<h2 id='MMPoisRep'> Simulated data for a simple mixed model with Poisson response</h2><span id='topic+MMPoisRep'></span>

<h3>Description</h3>

<p>Simulated data with a fixed factor cult (4 levels), with 8 randomized replications each,
a (fixed) factor time (6 levels), which are repeated measurements taken from the same experimental units.
The 32 experimental (plotid) units differ in their mean response follwing a gaussian distribution.
The response Y follows a Poisson distribution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MMPoisRep)</code></pre>


<h3>Format</h3>

<p>A data frame with 192 observations on the following 4 variables.
</p>

<dl>
<dt><code>plotid</code></dt><dd><p>a factor with 32 levels, representing the 32 experimental units (plots)</p>
</dd>
<dt><code>cult</code></dt><dd><p>a factor with 4 levels (<code>C1</code> <code>C2</code> <code>C3</code> <code>C4</code>), representing a fixed factor (e.g. the cultivar)</p>
</dd>
<dt><code>time</code></dt><dd><p>a factor with 6 levels (<code>T1</code> <code>T2</code> <code>T3</code> <code>T4</code> <code>T5</code> <code>T6</code>) specifying repeated measurements on the same experimental units (plotid) over time</p>
</dd>
<dt><code>Y</code></dt><dd><p>a numeric vector, following a Poisson distribution</p>
</dd>
</dl>



<h3>Source</h3>

<p>simulation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MMPoisRep)

boxplot(Y ~ cult*time, data=MMPoisRep, las=TRUE)

</code></pre>

<hr>
<h2 id='modelparm.methods'> For internal use. Extract model parameters needed for multcomp from objects of class gamlss
or geeglm.</h2><span id='topic+modelparm.gamlss'></span><span id='topic+modelparm.geeglm'></span>

<h3>Description</h3>

<p>Only for internal use with <code>glht</code> in package <span class="pkg">multcomp</span>.
Extracts model parameters needed for <code>glht(multcomp)</code> from objects of 
class <code>gamlss</code> or <code>geeglm</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamlss'
modelparm(model, coef.=coef, vcov.=vcov, df = NULL, ...)
## S3 method for class 'geeglm'
modelparm(model, coef.=coef, vcov.=vcov, df = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modelparm.methods_+3A_model">model</code></td>
<td>
<p> an object of class <code>gamlss</code> and <code>geeglm</code>, respectively</p>
</td></tr>
<tr><td><code id="modelparm.methods_+3A_coef.">coef.</code></td>
<td>
<p> a function to extract fitted mean parameters from models of class <code>gamlss</code> and <code>geeglm</code></p>
</td></tr>
<tr><td><code id="modelparm.methods_+3A_vcov.">vcov.</code></td>
<td>
<p> a function to extract the estimated covariance matrix from models of class <code>gamlss</code> and <code>geeglm</code></p>
</td></tr>
<tr><td><code id="modelparm.methods_+3A_df">df</code></td>
<td>
<p> a single positive integer, the user-defined degrees of freedom. By default, <code>df=NULL</code>, the funtion will extract the residual degrees of freedom from the model.</p>
</td></tr>
<tr><td><code id="modelparm.methods_+3A_...">...</code></td>
<td>
<p> further argument, not used</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Test versions. Only for internal use. Further checks still need to be implemented.
</p>


<h3>Value</h3>

<p>As modelparm.default in package multcomp, a list with elements 
</p>
<table role = "presentation">
<tr><td><code>coef</code></td>
<td>
<p>a numeric vector with the estimated model parameters</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>a matrix with numeric entries, and dimensions as length(coef)</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>a single numeric value, the residual degree of freedom</p>
</td></tr>
<tr><td><code>estimable</code></td>
<td>
<p>a logical vector, specifying which rows/colums of vcov correspond to non-NA parameters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel Gerhard, Frank Schaarschmidt adapting code by T.Hothorn available in <code>modelparm.default</code>, package <code>multcomp</code></p>


<h3>See Also</h3>

<p> function <code>glht</code> in package <code>multcomp</code> </p>

<hr>
<h2 id='Nematocera'> Trap counts of Nematocera</h2><span id='topic+Nematocera'></span>

<h3>Description</h3>

<p>In a field trial, 4 treatments (A,B, Standard, Novum) were arranged in a randomized complete block design with 8 blocks
and 32 plots. In summer 2005 soil eklektor traps were placed in each plot, on six dates from
2005-07-12 to 2005-09-25, the number of individuals of Nematocera (gnats, midges and others)
hatching from soil were counted. The individuals were classified to the family level.
Interest was in assessing potential effects of a novel agricultural practice (Novum)
on the abundance of Nematocera.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Nematocera)</code></pre>


<h3>Format</h3>

<p>A data frame with 192 observations on the following 14 variables.
</p>

<dl>
<dt><code>Date</code></dt><dd><p>a POSIXt, the time of counting the individuals in the eklektor trap</p>
</dd>
<dt><code>Treatment</code></dt><dd><p>a factor with 4 levels, <code>A</code>, <code>B</code>, <code>Standard</code> and <code>Novum</code>, where <code>Novum</code> is the novel treatment, <code>Standard</code> is the standard treatment most similar to <code>Novum</code>, and <code>A</code> and <code>B</code> are additional standard treatments.</p>
</dd>
<dt><code>Block</code></dt><dd><p>a numeric vector, specifying the blocks 1-8</p>
</dd>
<dt><code>Plot</code></dt><dd><p>a factor with 32 levels <code>A1</code> to <code>Standard8</code>, indicator variables for the individual eklektors</p>
</dd>
<dt><code>Bibio</code></dt><dd><p>a numeric vector, counts of individuals, belonging to the family</p>
</dd>
<dt><code>Cecido</code></dt><dd><p>a numeric vector, counts of individuals, belonging to the family</p>
</dd>
<dt><code>Cerato</code></dt><dd><p>a numeric vector, counts of individuals, belonging to the family</p>
</dd>
<dt><code>Chiro</code></dt><dd><p>a numeric vector, counts of individuals, belonging to the family</p>
</dd>
<dt><code>Myceto</code></dt><dd><p>a numeric vector, counts of individuals, belonging to the family</p>
</dd>
<dt><code>Psycho</code></dt><dd><p>a numeric vector, counts of individuals, belonging to the family</p>
</dd>
<dt><code>Scato</code></dt><dd><p>a numeric vector, counts of individuals, belonging to the family</p>
</dd>
<dt><code>Sciari</code></dt><dd><p>a numeric vector, counts of individuals, belonging to the family</p>
</dd>
<dt><code>Tipuli</code></dt><dd><p>a numeric vector, counts of individuals, belonging to the family</p>
</dd>
<dt><code>Total</code></dt><dd><p>a numeric vector, total count of individuals belonging to the suborder Nematocera</p>
</dd>
</dl>



<h3>Source</h3>

<p>personal communications, S.Prescher, JKI Braunschweig, Germany
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Nematocera)

par(mar=c(11,5,3,1))

boxplot(Total ~ Treatment*Date, data=Nematocera, las=2, col=c("white","white","blue","green"))
legend(x=15, y=100, legend=levels(Nematocera$Treatment), fill=c("white","white","blue","green"))

pairs(Nematocera[,c("Cecido","Cerato","Chiro","Myceto","Psycho","Sciari")])

</code></pre>

<hr>
<h2 id='plotCI.Methods'> Plot confidence intervals calculated by pairwiseCI </h2><span id='topic+plotCI.UnlogCI'></span><span id='topic+plotCI.simplesimint'></span>

<h3>Description</h3>

<p>Plot confidence intervals calculated by calling pairwiseCI or UnlogCI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'UnlogCI'
plotCI(x, ...)
## S3 method for class 'simplesimint'
plotCI(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotCI.Methods_+3A_x">x</code></td>
<td>
<p> an object of class <code>"UnlogCI"</code> <code>"simplesimint"</code> as can be obtained by calling <code><a href="#topic+UnlogCI">UnlogCI</a></code> or <code><a href="#topic+simplesimint">simplesimint</a></code> </p>
</td></tr>
<tr><td><code id="plotCI.Methods_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to <code>plotCII</code>, see <code>?plotCII</code> in package <span class="pkg">MCPAN</span> for details </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot.
</p>

<hr>
<h2 id='print.np'> Print function for SCSnp </h2><span id='topic+print.SCSnp'></span><span id='topic+print.CInp'></span><span id='topic+print.simplesimint'></span><span id='topic+print.UnlogCI'></span>

<h3>Description</h3>

<p>A print functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SCSnp'
print(x, ...)
## S3 method for class 'CInp'
print(x, ...)
## S3 method for class 'simplesimint'
print(x, ...)
## S3 method for class 'UnlogCI'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.np_+3A_x">x</code></td>
<td>
<p> an object of class <code>SCSnp</code> as can be obtained by calling <code><a href="#topic+SCSnp">SCSnp</a></code> </p>
</td></tr>
<tr><td><code id="print.np_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <code>print</code> </p>
</td></tr>
</table>

<hr>
<h2 id='R2Bugsdat1w'> For internal use </h2><span id='topic+R2Bugsdat1w'></span>

<h3>Description</h3>

<p>Transform a data set to a dataset appropriate for certain OpenBUGS models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R2Bugsdat1w(formula, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="R2Bugsdat1w_+3A_formula">formula</code></td>
<td>
<p> a formula of the style <code>response ~ treatment</code>, where <code>response</code> is a numeric or integer variable, and <code>treatment</code> is a factor variable in <code>data</code> </p>
</td></tr>
<tr><td><code id="R2Bugsdat1w_+3A_data">data</code></td>
<td>
<p> a data.frame, containing the <code>response</code>- and <code>treatment</code>-variables in <code>formula</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use.
</p>


<h3>Value</h3>

<p>a list, containing the elements
</p>
<table role = "presentation">
<tr><td><code>bugsdat</code></td>
<td>
<p>a list of variables appropriate for certain BUGS models</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>a vector of character strings, naming the parameters to save for a call to OpenBUGS</p>
</td></tr>
<tr><td><code>inits</code></td>
<td>
<p> a vector of initial values for the parameters</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the original data set</p>
</td></tr>
<tr><td><code>Intercept</code></td>
<td>
<p>a single logical indicating whether an Intercept was used to parameterize the factor variable</p>
</td></tr>
</table>

<hr>
<h2 id='R2Bugsdat1w.data.frame'> For internal use. </h2><span id='topic+R2Bugsdat1w.data.frame'></span>

<h3>Description</h3>

<p>Transform a data set to a dataset appropriate for certain OpenBUGS models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R2Bugsdat1w.data.frame(data, response, treatment, Intercept = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="R2Bugsdat1w.data.frame_+3A_data">data</code></td>
<td>
<p> a data.frame </p>
</td></tr>
<tr><td><code id="R2Bugsdat1w.data.frame_+3A_response">response</code></td>
<td>
<p> a single character string, naming a numeric variable in <code>data</code> </p>
</td></tr>
<tr><td><code id="R2Bugsdat1w.data.frame_+3A_treatment">treatment</code></td>
<td>
<p> a single character string, naming a factor variable in <code>data</code>  </p>
</td></tr>
<tr><td><code id="R2Bugsdat1w.data.frame_+3A_intercept">Intercept</code></td>
<td>
<p> a single logical value, defining, whether an Intercept shall be used for the construction of the design matrix </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use.
</p>


<h3>Value</h3>

<p>a list, containing the elements
</p>
<table role = "presentation">
<tr><td><code>bugsdat</code></td>
<td>
<p>a list of variables appropriate for certain BUGS models</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>a vector of character strings, naming the parameters to save for a call to OpenBUGS</p>
</td></tr>
<tr><td><code>inits</code></td>
<td>
<p> a vector of initial values for the parameters</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the original data set</p>
</td></tr>
<tr><td><code>Intercept</code></td>
<td>
<p>a single logical indicating whether an Intercept was used to parameterize the factor variable</p>
</td></tr>
</table>

<hr>
<h2 id='SCSnp'> Simultaneous confidence sets from empirical joint distribution. </h2><span id='topic+SCSnp'></span><span id='topic+SCSnp.default'></span><span id='topic+SCSnp.CCDiff'></span><span id='topic+SCSnp.CCRatio'></span><span id='topic+SCSnp.bugs'></span>

<h3>Description</h3>

<p>Calcualte simultaneous confidence sets according to Besag et al. (1995) from a empirical joint distribution of a parameter vector. Joint empirical distributions might be obtained from WinBUGS or OpenBUGS calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## Default S3 method:
SCSnp(x, conf.level = 0.95,
 alternative = "two.sided", ...)

## S3 method for class 'bugs'
SCSnp(x, conf.level = 0.95,
 alternative = "two.sided", whichp = NULL, ...)

## S3 method for class 'CCRatio'
SCSnp(x, ...)

## S3 method for class 'CCDiff'
SCSnp(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SCSnp_+3A_x">x</code></td>
<td>
<p> a matrix N-times-P matrix or an object of class <code>CCRatio</code> or <code>CCDiff</code> </p>
</td></tr>
<tr><td><code id="SCSnp_+3A_conf.level">conf.level</code></td>
<td>
<p> a single numeric value between 0.5 and 1, the simultaneous confidence level</p>
</td></tr>
<tr><td><code id="SCSnp_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, one of <code>"two.sided"</code>, <code>"less"</code>, <code>"greater"</code>, for two-sided, upper and lower limits  </p>
</td></tr>
<tr><td><code id="SCSnp_+3A_whichp">whichp</code></td>
<td>
<p> a single character string, naming an element of the <code>sims.list</code> if <code>x</code> is a <code>bugs</code> object, ignored otherwise </p>
</td></tr>
<tr><td><code id="SCSnp_+3A_...">...</code></td>
<td>
<p> further arguments, currently not used </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let P be the number of parameters in the parameter vector and N be the total number of values obtained for the empirical joint distribution of the parameter vector, e.g. as can be obtaine e.g., from Gibbs sampling.
</p>


<h3>Value</h3>

<p>An object of class &quot;SCSnp&quot;, a list with elements
</p>
<table role = "presentation">
<tr><td><code>conf.int</code></td>
<td>
<p>a P-times-2 matrix containing the lower and upper confidence limits</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>a numeric vector of length P, containing the medians of the P marginal empirical distributions</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> the input object</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p> the number of values outside the SCS, i.e. conf.level*N</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p> the number of values used to construct the confidence set</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>a single numeric value, the nominal confidence level, as input</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a single character string, as input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt, adapting an earliere version of Gemechis D. Djira</p>


<h3>References</h3>

<p> Besag J, Green P, Higdon D, Mengersen K (1995): Bayesian Computation and Stochastic Systems. Statistical Science 10 (1), 3-66.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+CInp">CInp</a></code> for a wrapper to <code>quantile</code> to compute simple percentile intervals on each of P marginal distributions</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Assume a 1000 times 4 matrix of 4 mutually independent
# normal variables:

X&lt;-cbind(rnorm(1000), rnorm(1000), rnorm(1000), rnorm(1000))

SCSts&lt;-SCSnp(x=X, conf.level=0.9, alternative="two.sided")
SCSts

SCS&lt;-SCSts$conf.int

in1&lt;-X[,1]&gt;=SCS[1,1] &amp; X[,1]&lt;=SCS[1,2] 

in2&lt;-X[,2]&gt;=SCS[2,1] &amp; X[,2]&lt;=SCS[2,2] 

in3&lt;-X[,3]&gt;=SCS[3,1] &amp; X[,3]&lt;=SCS[3,2] 

in4&lt;-X[,4]&gt;=SCS[4,1] &amp; X[,4]&lt;=SCS[4,2] 

sum(in1*in2*in3*in4)


</code></pre>

<hr>
<h2 id='simplesimint'> Simultaneous confidence intervals from raw estimates</h2><span id='topic+simplesimint'></span>

<h3>Description</h3>

<p>Calculates simultaneous confidence intervals for multiple contrasts based on a parameter vector,
its variance-covariance matrix and (optionally) the degrees of freedom, using quantiles of the multivar
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplesimint(coef, vcov, cmat, df = NULL, conf.level = 0.95,
 alternative = c("two.sided", "less", "greater"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simplesimint_+3A_coef">coef</code></td>
<td>
<p> a single numeric vector, specifying the point estimates of the parameters of interest </p>
</td></tr>
<tr><td><code id="simplesimint_+3A_vcov">vcov</code></td>
<td>
<p> the variance-covariance matrix corresponding to <code>coef</code>, should be of dimension P-times-P, when <code>coef</code> is of P </p>
</td></tr>
<tr><td><code id="simplesimint_+3A_cmat">cmat</code></td>
<td>
<p> the contrasts matrix specifying the comparisons of interest with respect to <code>coef</code>, should have P columns, when <code>coef</code> is of length p </p>
</td></tr>
<tr><td><code id="simplesimint_+3A_df">df</code></td>
<td>
<p> optional, the degree of freedom for the multivariate t-distribution; if specified, quantiles from the multivariate t-distribution are used for confidence interval estimation, if not specified (default), quantiles of the multivariate normal distribution are used</p>
</td></tr>
<tr><td><code id="simplesimint_+3A_conf.level">conf.level</code></td>
<td>
<p> a single numeric value between 0.5 and 1.0; the simultaneous confidence level </p>
</td></tr>
<tr><td><code id="simplesimint_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, <code>"two.sided"</code> for intervals, <code>"less"</code> for upper limits, and <code>"greater"</code> for lower limits </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the methods formerly available in package <span class="pkg">multcomp</span>, function <code>csimint</code>.
Input values are a vector of parameter estimates <code class="reqn">\mu</code> of length <code class="reqn">P</code>,
a corresponding estimate for its variance-covariance matrix <code class="reqn">\Sigma</code> (P times P), and a 
contrast matrix <code class="reqn">C</code> of dimension <code class="reqn">M \times P</code>. The contrasts <code class="reqn">L = C \mu</code> are computed,
the variance-covariance matrix (being a function of <code class="reqn">C</code> and <code class="reqn">\Sigma</code>) and the corresponding correlation matrix <code class="reqn">R</code> are computed.
Finally, confidence intervals for <code class="reqn">L</code> are computed: if df is given, quantiles of an M-dimensional t distribution with correlation matrix R are used,
otherwise quantiles of an M-dimensional standard normal distribution with correlation matrix R are used.
</p>


<h3>Value</h3>

<p>An object of class &quot;simplesimint&quot;
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p>the estimates of the contrasts</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>the lower confidence limits</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>the upper confidence limits</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p>the contrast matrix, as input</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string, as input</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>a numeric value, as input</p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p>a numeric value, the quantile used for confidence interval estimation</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>a numeric value or NULL, as input</p>
</td></tr>
<tr><td><code>stderr</code></td>
<td>
<p>the standard error of the contrasts</p>
</td></tr>
<tr><td><code>vcovC</code></td>
<td>
<p>the variance covariance matrix of the contrasts</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>This is a testversion and has not been checked extensively. 
</p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>See Also</h3>

<p> See <code>?coef</code> and <code>?vcov</code> for extracting of parameter vectors and corresponding variance covariance matrices from various model fits. </p>


<h3>Examples</h3>

<pre><code class='language-R'>

# For the simple case of Gaussian response
# variables with homoscedastic variance,
# see the following example


library(mratios)
data(angina)

boxplot(response ~ dose, data=angina)

# Fit a cell means model,

fit&lt;-lm(response ~ 0+dose, data=angina)

# extract cell means, the corresponding
# variance-covariance matrix and the
# residual degree of freedom,

cofi&lt;-coef(fit)
vcofi&lt;-vcov(fit)
dofi&lt;-fit$df.residual

# define an appropriate contrast matrix,
# here, comparisons to control

n&lt;-unlist(lapply(split(angina$response, f=angina$dose), length))
names(n)&lt;-names(cofi)

cmat&lt;-contrMat(n=n, type="Dunnett")
cmat

#

test&lt;-simplesimint(coef=cofi, vcov=vcofi, df=dofi, cmat=cmat, alternative="greater" )

test

summary(test)

plotCI(test)

### Note, that the same result can be achieved much more conveniently
### using confint.glht in package multcomp


</code></pre>

<hr>
<h2 id='summary.simplesimint'> Detailed print out for simplesimint objects </h2><span id='topic+summary.simplesimint'></span>

<h3>Description</h3>

<p>Produce a detailed print out for objects of class &quot;simplesimint&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simplesimint'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.simplesimint_+3A_object">object</code></td>
<td>
<p>an object of class <code>"simplesimint"</code> as can be obtained by calling <code><a href="#topic+simplesimint">simplesimint</a></code> </p>
</td></tr>
<tr><td><code id="summary.simplesimint_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to <code>print</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print
</p>

<hr>
<h2 id='UnlogCI'> Transform confidence intervals from glm fits. </h2><span id='topic+UnlogCI'></span><span id='topic+UnlogCI.glht'></span>

<h3>Description</h3>

<p>Transform confidence intervals derived from glm fits back to original scale and give appropriate names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glht'
UnlogCI(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UnlogCI_+3A_x">x</code></td>
<td>
<p> an object of class <code>"confint.glht"</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Applies exponential function on the estimates and confidence limits and creates useful names for the comparisons and parameters.
</p>


<h3>Value</h3>

<p>An object of class <code>"UnlogCI"</code>.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+plotCI.UnlogCI">plotCI.UnlogCI</a></code> for plotting the result </p>


<h3>Examples</h3>

<pre><code class='language-R'>
# # # CI for odds ratios
# # # for models on the logit-link

data(Feeding)

# Larval mortality:

Feeding$Lmort &lt;- Feeding$Total - Feeding$Pupating

fit1&lt;-glm(cbind(Pupating,Lmort)~Variety,data=Feeding, family=quasibinomial)
anova(fit1, test="F")

library(multcomp)

comp&lt;-glht(fit1, mcp(Variety="Tukey"))

CIraw&lt;-CIGLM(comp,method="Raw")

CIraw

UnlogCI(CIraw)

plotCI(UnlogCI(CIraw), lines=c(0.25,0.5,2,4),
 lineslwd=c(1,2,2,1), linescol=c("red","black","black","red"))


# # # # # # #

# # #  CI for ratios of means
# # # for models on the log-link

data(Diptera)

# Larval mortality:

fit2&lt;-glm(Ges~Treatment, data=Diptera, family=quasipoisson)
anova(fit2, test="F")

library(multcomp)

comp&lt;-glht(fit2, mcp(Treatment="Tukey"))

CIadj&lt;-CIGLM(comp,method="Adj")

CIadj

UnlogCI(CIadj)

plotCI(UnlogCI(CIadj), lines=c(0.5,1,2), lineslwd=c(2,1,1))


</code></pre>

<hr>
<h2 id='vcov.gamlss'> Extract variance covariance matrix from objects of class gamlss </h2><span id='topic+vcov.gamlss'></span>

<h3>Description</h3>

<p>Only for internal use. Extract the covariance matrix corresponding to the mu parameters of a gamlss-fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamlss'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.gamlss_+3A_object">object</code></td>
<td>
<p> An object of class &quot;gamlss&quot; as can be created by calling <code>gamlss</code> </p>
</td></tr>
<tr><td><code id="vcov.gamlss_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only for internal use. Needs implementation of warnings.
</p>


<h3>Value</h3>

<p>A matrix of dimension mxm, if m is the length of mu-parameters from a gamlss fit.
</p>


<h3>Author(s)</h3>

<p> Daniel Gerhard </p>


<h3>See Also</h3>

<p>  packages <code>gamlss</code> and <code>multcomp</code> </p>

<hr>
<h2 id='vcov.geeglm'> Extract variance covariance matrix from objects of class geeglm </h2><span id='topic+vcov.geeglm'></span>

<h3>Description</h3>

<p>Only for internal use with function glht: Extract the variance covariance matrix corresponding to the mu parameters of a gamlss-fit.
Merely a wrapper of the method internally used in function summary.geeglm, package geepack.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'geeglm'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.geeglm_+3A_object">object</code></td>
<td>
<p> An object of class &quot;geeglm&quot; as can be created by calling <code>geeglm</code> in package <span class="pkg">geepack</span>.</p>
</td></tr>
<tr><td><code id="vcov.geeglm_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Test version. Only for internal use. Needs implementation of warnings.
</p>


<h3>Value</h3>

<p>A matrix of dimension m times m, if m is the length of coefficients from a geeglm fit.
</p>


<h3>See Also</h3>

<p>  packages <code>gamlss</code> and <code>multcomp</code> </p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
