<!DOCTYPE html><html lang="en-GB"><head><title>Help for package gbm.auto</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gbm.auto}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gbm.auto-package'><p>gbm.auto: Automated Boosted Regression Tree Modelling and Mapping Suite</p></a></li>
<li><a href='#Adult_Females'><p>Data: Numbers of 4 adult female rays caught in 2137 Irish Sea trawls, 1994 to 2014</p></a></li>
<li><a href='#AllPreds_E'><p>Data: Predicted abundances of 4 ray species generated using gbm.auto</p></a></li>
<li><a href='#AllScaledData'><p>Data: Scaled abundance data for 2 subsets of 4 rays in the Irish Sea, by gbm.cons</p></a></li>
<li><a href='#breaks.grid'><p>Defines breakpoints for draw.grid and legend.grid; mapplots fork</p></a></li>
<li><a href='#calibration'><p>calibration</p></a></li>
<li><a href='#gbm.auto'><p>Automated Boosted Regression Tree modelling and mapping suite</p></a></li>
<li><a href='#gbm.basemap'><p>Creates Basemaps for Gbm.auto mapping from your data range</p></a></li>
<li><a href='#gbm.bfcheck'><p>Calculates minimum Bag Fraction size for gbm.auto</p></a></li>
<li><a href='#gbm.cons'><p>Conservation Area Mapping</p></a></li>
<li><a href='#gbm.factorplot'><p>Creates ggplots of marginal effect for factorial variables from plot.gbm in gbm.auto.</p></a></li>
<li><a href='#gbm.lmplots'><p>Plot linear models for all expvar against the resvar</p></a></li>
<li><a href='#gbm.loop'><p>Calculate Coefficient Of Variation surfaces for gbm.auto predictions</p></a></li>
<li><a href='#gbm.map'><p>Maps of predicted abundance from Boosted Regression Tree modelling</p></a></li>
<li><a href='#gbm.mapsf'><p>Maps of predicted abundance from Boosted Regression Tree modelling</p></a></li>
<li><a href='#gbm.rsb'><p>Representativeness Surface Builder</p></a></li>
<li><a href='#gbm.step.sd'><p>Function to assess optimal no of boosting trees using k-fold cross validation</p></a></li>
<li><a href='#gbm.subset'><p>Subset gbm.auto input datasets to 2 groups using the partial deviance plots</p></a></li>
<li><a href='#gbm.valuemap'><p>Decision Support Tool that generates (Marine) Protected Area options using</p>
species predicted abundance maps</a></li>
<li><a href='#grids'><p>Data: Explanatory variables for rays in the Irish Sea</p></a></li>
<li><a href='#Juveniles'><p>Data: Explanatory and response variables for 4 juvenile rays in the Irish Sea</p></a></li>
<li><a href='#lmplot'><p>Plot linear model for two variables with R2 &amp; P printed and saved</p></a></li>
<li><a href='#roc'><p>roc</p></a></li>
<li><a href='#samples'><p>Data: Numbers of 4 ray species caught in 2137 Irish Sea trawls, 1994 to 2014</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Automated Boosted Regression Tree Modelling and Mapping Suite</td>
</tr>
<tr>
<td>Version:</td>
<td>2024.10.01</td>
</tr>
<tr>
<td>Description:</td>
<td>Automates delta log-normal boosted regression tree abundance
    prediction. Loops through parameters provided (LR (learning rate), TC
    (tree complexity), BF (bag fraction)), chooses best, simplifies, &amp;
    generates line, dot &amp; bar plots, &amp; outputs these &amp; predictions &amp; a
    report, makes predicted abundance maps, and Unrepresentativeness
    surfaces.  Package core built around 'gbm' (gradient boosting machine)
    functions in 'dismo' (Hijmans, Phillips, Leathwick &amp; Jane Elith, 2020
    &amp; ongoing), itself built around 'gbm' (Greenwell, Boehmke, Cunningham
    &amp; Metcalfe, 2020 &amp; ongoing, originally by Ridgeway). Indebted to
    Elith/Leathwick/Hastie 2008 'Working Guide'
    &lt;<a href="https://doi.org/10.1111%2Fj.1365-2656.2008.01390.x">doi:10.1111/j.1365-2656.2008.01390.x</a>&gt;; workflow follows Appendix S3.
    See <a href="https://www.simondedman.com/">https://www.simondedman.com/</a> for published guides and papers
    using this package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>beepr (&ge; 1.2), dismo (&ge; 1.3-14), dplyr (&ge; 1.0.9), gbm (&ge;
2.1.1), ggmap (&ge; 3.0.2), ggplot2 (&ge; 3.4.2), ggspatial (&ge;
1.1.9), lifecycle, lubridate (&ge; 1.9.2), mapplots (&ge; 1.5),
Metrics (&ge; 0.1.4), readr (&ge; 2.1.4), sf (&ge; 0.9-7), stars (&ge;
0.6-3), starsExtra (&ge; 0.2.7), stats (&ge; 3.3.1), stringi (&ge;
1.6.1), tidyselect (&ge; 1.2.0), viridis (&ge; 0.6.4)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-01 18:29:28 UTC; simon</td>
</tr>
<tr>
<td>Author:</td>
<td>Simon Dedman <a href="https://orcid.org/0000-0002-9108-972X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Simon Dedman &lt;simondedman@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-01 21:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='gbm.auto-package'>gbm.auto: Automated Boosted Regression Tree Modelling and Mapping Suite</h2><span id='topic+gbm.auto-package'></span>

<h3>Description</h3>

<p>Automates delta log-normal boosted regression tree abundance prediction. Loops through parameters provided (LR (learning rate), TC (tree complexity), BF (bag fraction)), chooses best, simplifies, &amp; generates line, dot &amp; bar plots, &amp; outputs these &amp; predictions &amp; a report, makes predicted abundance maps, and Unrepresentativeness surfaces. Package core built around 'gbm' (gradient boosting machine) functions in 'dismo' (Hijmans, Phillips, Leathwick &amp; Jane Elith, 2020 &amp; ongoing), itself built around 'gbm' (Greenwell, Boehmke, Cunningham &amp; Metcalfe, 2020 &amp; ongoing, originally by Ridgeway). Indebted to Elith/Leathwick/Hastie 2008 'Working Guide' <a href="https://doi.org/10.1111/j.1365-2656.2008.01390.x">doi:10.1111/j.1365-2656.2008.01390.x</a>; workflow follows Appendix S3. See <a href="https://www.simondedman.com/">https://www.simondedman.com/</a> for published guides and papers using this package.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Simon Dedman <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a> (<a href="https://orcid.org/0000-0002-9108-972X">ORCID</a>)
</p>

<hr>
<h2 id='Adult_Females'>Data: Numbers of 4 adult female rays caught in 2137 Irish Sea trawls, 1994 to 2014</h2><span id='topic+Adult_Females'></span>

<h3>Description</h3>

<p>2137 capture events of adult female cuckoo, thornback, spotted and blonde
rays in the Irish Sea from 1994 to 2014 by the ICES IBTS, including
explanatory variables: Length Per Unit Effort in that area by the commercial
fishery, depth, temperature, distance to shore, and current speed at the
bottom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Adult_Females)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2137 rows and 13 variables:
</p>

<dl>
<dt>Longitude</dt><dd><p>Decimal longitudes in the Irish Sea</p>
</dd>
<dt>Latitude</dt><dd><p>Decimal latitudes in the Irish Sea</p>
</dd>
<dt>Haul_Index</dt><dd><p>ICES IBTS area, survey, station, and year</p>
</dd>
<dt>F_LPUE</dt><dd><p>Commercial fishery LPUE in Kg/Hr</p>
</dd>
<dt>Depth</dt><dd><p>Metres, decimal</p>
</dd>
<dt>Temperature</dt><dd><p>Degrees, decimal</p>
</dd>
<dt>Salinity</dt><dd><p>PPM</p>
</dd>
<dt>Distance_to_Shore</dt><dd><p>Metres, decimal</p>
</dd>
<dt>Current_Speed</dt><dd><p>Metres per second at the seabed</p>
</dd>
<dt>Cuckoo</dt><dd><p>Numbers of cuckoo rays caught, standardised to 1 hour</p>
</dd>
<dt>Thornback</dt><dd><p>Numbers of thornback rays caught, standardised to 1 hour</p>
</dd>
<dt>Blonde</dt><dd><p>Numbers of blonde rays caught, standardised to 1 hour</p>
</dd>
<dt>Spotted</dt><dd><p>Numbers of spotted rays caught, standardised to 1 hour</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Source</h3>

<p><a href="http://datras.ices.dk">http://datras.ices.dk</a>
</p>

<hr>
<h2 id='AllPreds_E'>Data: Predicted abundances of 4 ray species generated using gbm.auto</h2><span id='topic+AllPreds_E'></span>

<h3>Description</h3>

<p>Predicted abundances of 4 ray species generated using gbm.auto, and
Irish commercial beam trawler effort 2012.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AllPreds_E)
</code></pre>


<h3>Format</h3>

<p>A data frame with 378570 rows and 7 variables:
</p>

<dl>
<dt>Latitude</dt><dd><p>Decimal latitudes in the Irish Sea</p>
</dd>
<dt>Longitude</dt><dd><p>Decimal longitudes in the Irish Sea</p>
</dd>
<dt>Cuckoo</dt><dd><p>Predicted abundances of cuckoo rays in the Irish Sea, generated using gbm.auto</p>
</dd>
<dt>Thornback</dt><dd><p>Predicted abundances of thornback rays in the Irish Sea, generated using gbm.auto</p>
</dd>
<dt>Blonde</dt><dd><p>Predicted abundances of blonde rays in the Irish Sea, generated using gbm.auto</p>
</dd>
<dt>Spotted</dt><dd><p>Predicted abundances of spotted rays in the Irish Sea, generated using gbm.auto</p>
</dd>
<dt>Effort</dt><dd><p>Irish commercial beam trawler effort 2012</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>

<hr>
<h2 id='AllScaledData'>Data: Scaled abundance data for 2 subsets of 4 rays in the Irish Sea, by gbm.cons</h2><span id='topic+AllScaledData'></span>

<h3>Description</h3>

<p>A dataset containing the output of the gbm.cons example run, conservation
priority areas within the Irish Sea for juvenile and adult female cuckoo,
blonde, thornback and spotted rays.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AllScaledData)
</code></pre>


<h3>Format</h3>

<p>A data frame with 378570 rows and 3 variables:
</p>

<dl>
<dt>Longitude</dt><dd><p>Decimal longitudes in the Irish Sea</p>
</dd>
<dt>Latitude</dt><dd><p>Decimal latitudes in the Irish Sea</p>
</dd>
<dt>allscaled</dt><dd><p>Relative abundance. Each juvenile and adult female
cuckoo, blonde, thornback and spotted ray scaled to 1 and added together</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>

<hr>
<h2 id='breaks.grid'>Defines breakpoints for draw.grid and legend.grid; mapplots fork</h2><span id='topic+breaks.grid'></span>

<h3>Description</h3>

<p>Defines breakpoints from values in grd with options to exclude outliers,
set number of bins, and include a dedicated zero column.
Forked by SD 05/01/2019 to add 'lo', else bins always begin at 0, killing
plotting when all data are in a tight range at high values e.g. 600:610
</p>


<h3>Usage</h3>

<pre><code class='language-R'>breaks.grid(grd, quantile = 0.975, ncol = 12, zero = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="breaks.grid_+3A_grd">grd</code></td>
<td>
<p>An array produced by make.grid or a list produced by
make.multigrid or a vector of positive values.</p>
</td></tr>
<tr><td><code id="breaks.grid_+3A_quantile">quantile</code></td>
<td>
<p>The maximum value of the breaks will be determined by the
quantile given here. This can be used to deal with outlying values in grd.
If quantile = 1 then the maximum value of the breaks will be the same as the
maximum value in grd.</p>
</td></tr>
<tr><td><code id="breaks.grid_+3A_ncol">ncol</code></td>
<td>
<p>Number of colours to be used, always one more than the number of
breakpoints. Defaults to 12.</p>
</td></tr>
<tr><td><code id="breaks.grid_+3A_zero">zero</code></td>
<td>
<p>Logical, should zero be included as a separate category? Defaults
to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of breakpoints for draw.grid in mapplots
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>
<p>Hans Gerritsen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>breaks.grid(100,ncol=6)
breaks.grid(100,ncol=5,zero=FALSE)

# create breaks on the log scale
exp(breaks.grid(log(10000),ncol=4,zero=FALSE))
</code></pre>

<hr>
<h2 id='calibration'>calibration</h2><span id='topic+calibration'></span>

<h3>Description</h3>

<p>Internal use only. Jane Elith/John Leathwick 17th March 2005. Calculates
calibration statistics for either binomial or count data but the family
argument must be specified for the latter a conditional test for the latter
will catch most failures to specify the family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibration(obs, preds, family = c("binomial", "bernoulli", "poisson"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibration_+3A_obs">obs</code></td>
<td>
<p>Observed data.</p>
</td></tr>
<tr><td><code id="calibration_+3A_preds">preds</code></td>
<td>
<p>Predicted data.</p>
</td></tr>
<tr><td><code id="calibration_+3A_family">family</code></td>
<td>
<p>Statistical distribution family. Choose one.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>roc &amp; calibration stats internally within gbm runs e.g. in gbm.auto.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>

<hr>
<h2 id='gbm.auto'>Automated Boosted Regression Tree modelling and mapping suite</h2><span id='topic+gbm.auto'></span>

<h3>Description</h3>

<p>Automates delta log normal boosted regression trees abundance prediction.
Loops through all permutations of parameters provided (learning
rate, tree complexity, bag fraction), chooses the best, then simplifies it.
Generates line, dot and bar plots, and outputs these and the predictions
and a report of all variables used, statistics for tests, variable
interactions, predictors used and dropped, etc. If selected, generates
predicted abundance maps, and Unrepresentativeness surfaces.
See www.GitHub.com/SimonDedman/gbm.auto for issues, feedback, and development
suggestions. See SimonDedman.com for links to walkthrough paper, and papers
and thesis published using this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.auto(
  grids = NULL,
  samples,
  expvar,
  resvar,
  randomvar = FALSE,
  tc = c(2),
  lr = c(0.01, 0.005),
  bf = 0.5,
  offset = NULL,
  n.trees = 50,
  ZI = "CHECK",
  fam1 = c("bernoulli", "binomial", "poisson", "laplace", "gaussian"),
  fam2 = c("gaussian", "bernoulli", "binomial", "poisson", "laplace"),
  simp = TRUE,
  gridslat = 2,
  gridslon = 1,
  samplesGridsAreaScaleFactor = 1,
  multiplot = TRUE,
  cols = grey.colors(1, 1, 1),
  linesfiles = TRUE,
  smooth = FALSE,
  savedir = tempdir(),
  savegbm = TRUE,
  loadgbm = NULL,
  varint = TRUE,
  map = TRUE,
  shape = NULL,
  RSB = TRUE,
  BnW = TRUE,
  alerts = TRUE,
  pngtype = c("cairo-png", "quartz", "Xlib"),
  gaus = TRUE,
  MLEvaluate = TRUE,
  brv = NULL,
  grv = NULL,
  Bin_Preds = NULL,
  Gaus_Preds = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.auto_+3A_grids">grids</code></td>
<td>
<p>Explanatory data to predict to. Import with (e.g.) read.csv and
specify object name. Defaults to NULL (won't predict to grids).</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_samples">samples</code></td>
<td>
<p>Explanatory and response variables to predict from. Keep col
names short (~17 characters max), no odd characters, spaces, starting
numerals or terminal periods. Spaces may be converted to periods in directory
names, underscores won't. Can be a subset of a large dataset.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_expvar">expvar</code></td>
<td>
<p>Vector of names or column numbers of explanatory variables in
'samples': c(1,3,6) or c(&quot;Temp&quot;,&quot;Sal&quot;). No default.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_resvar">resvar</code></td>
<td>
<p>Name or column number(s) of response variable in samples: 12,
c(1,4), &quot;Rockfish&quot;. No default. Column name is ideally species name.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_randomvar">randomvar</code></td>
<td>
<p>Add a random variable (uniform distribution, 0-1) to the expvars, to see whether
other expvars perform better or worse than random.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_tc">tc</code></td>
<td>
<p>Permutations of tree complexity allowed, can be vector with
the largest sized number no larger than the number of explanatory variables
e.g. c(2,7), or a list of 2 single numbers or vectors, the first to be passed
to the binary BRT, the second to the Gaussian, e.g. tc = list(c(2,6), 2) or
list(6, c(2,6)).</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_lr">lr</code></td>
<td>
<p>Permutations of learning rate allowed. Can be a vector or a list of
2 single numbers or vectors, the first to be passed to the binary BRT, the
second to the Gaussian, e.g. lr = list(c(0.01,0.02),0.0001) or
list(0.01,c(0.001, 0.0005)).</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_bf">bf</code></td>
<td>
<p>Permutations of bag fraction allowed, can be single number, vector
or list, per tc and lr. Defaults to 0.5.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_offset">offset</code></td>
<td>
<p>Column number or quoted name in samples, containing offset values relating to the
samples. A numeric vector of length equal to the number of cases. Similar to weighting, see
https://towardsdatascience.com/offsetting-the-model-logic-to-implementation-7e333bc25798 .</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_n.trees">n.trees</code></td>
<td>
<p>From gbm.step, number of initial trees to fit. Can be
single or list but not vector i.e. list(fam1,fam2).</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_zi">ZI</code></td>
<td>
<p>Are data zero-inflated? TRUE FALSE &quot;CHECK&quot;. Choose one. TRUE:
delta BRT, log-normalised Gaus, reverse log-norm and bias corrected. FALSE:
do Gaussian only, no log-normalisation. &quot;CHECK&quot;: Tests data for you. Default is
&quot;CHECK&quot;. TRUE and FALSE aren't in quotes, &quot;CHECK&quot; is.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_fam1">fam1</code></td>
<td>
<p>Probability distribution family for 1st part of delta process,
defaults to &quot;bernoulli&quot;. Choose one.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_fam2">fam2</code></td>
<td>
<p>Probability distribution family for 2nd part of delta process,
defaults to &quot;gaussian&quot;. Choose one.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_simp">simp</code></td>
<td>
<p>Try simplifying best BRTs?</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_gridslat">gridslat</code></td>
<td>
<p>Column number for latitude in 'grids'.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_gridslon">gridslon</code></td>
<td>
<p>Column number for longitude in 'grids'.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_samplesgridsareascalefactor">samplesGridsAreaScaleFactor</code></td>
<td>
<p>Scale up or down factor so values in the predict-to pixels of
'grids' match the spatial scale sampled by rows in 'samples'. Default 1 means no change.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_multiplot">multiplot</code></td>
<td>
<p>Create matrix plot of all line files? Default true.
turn off if big n of exp vars causes an error due to margin size problems.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_cols">cols</code></td>
<td>
<p>Barplot colour vector. Assignment in order of explanatory
variables. Default 1<em>white: white bars black borders. '1</em>' repeats.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_linesfiles">linesfiles</code></td>
<td>
<p>Save individual line plots' data as csv's? Default TRUE.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_smooth">smooth</code></td>
<td>
<p>Apply a smoother to the line plots? Default FALSE.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_savedir">savedir</code></td>
<td>
<p>Save outputs to a temporary directory (default) else change to
current directory e.g. &quot;/home/me/folder&quot;. Do not use getwd() here.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_savegbm">savegbm</code></td>
<td>
<p>Save gbm objects and make available in environment after
running? Open with load(&quot;Bin_Best_Model&quot;) Default TRUE.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_loadgbm">loadgbm</code></td>
<td>
<p>Relative or (very much preferably) absolute location of folder containing
Bin_Best_Model and Gaus_Best_Model. If set will skip BRT calculations and do
predicted maps and csvs. Avoids re-running BRT models again (the slow bit),
can run normally once with savegbm=T then multiple times with new grids &amp;
loadgbm to predict to multiple grids e.g. different seasons, areas, etc.
Default NULL, character vector, &quot;./&quot; for working directory.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_varint">varint</code></td>
<td>
<p>Calculate variable interactions? Default:TRUE, FALSE for error:
&quot;contrasts can be applied only to factors with 2 or more levels&quot;.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_map">map</code></td>
<td>
<p>Save abundance map png files?</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_shape">shape</code></td>
<td>
<p>Enter the full path to downloaded map e.g. coastline shapefile, possibly from
gbm.basemap, typically Crop_Map.shp, including the .shp. Can also name an existing object in the
environment, read in with sf::st_read. Default NULL, in which case bounds calculated by gbm.mapsf
which then calls gbm.basemap to download and auto-generate the base map.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_rsb">RSB</code></td>
<td>
<p>Run Unrepresentativeness surface builder? Default TRUE.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_bnw">BnW</code></td>
<td>
<p>Repeat maps in black and white e.g. for print journals. Default
TRUE.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_alerts">alerts</code></td>
<td>
<p>Play sounds to mark progress steps. Default TRUE but running
multiple small BRTs in a row (e.g. gbm.loop) can cause RStudio to crash.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_pngtype">pngtype</code></td>
<td>
<p>Filetype for png files, alternatively try &quot;quartz&quot; on Mac.
Choose one.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_gaus">gaus</code></td>
<td>
<p>Do family2 (typically Gaussian) runs as well as family1
(typically Bin)? Default TRUE.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_mlevaluate">MLEvaluate</code></td>
<td>
<p>do machine learning evaluation metrics &amp; plots? Default
TRUE.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_brv">brv</code></td>
<td>
<p>Dummy param for package testing for CRAN, ignore.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_grv">grv</code></td>
<td>
<p>Dummy param for package testing for CRAN, ignore.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_bin_preds">Bin_Preds</code></td>
<td>
<p>Dummy param for package testing for CRAN, ignore.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_gaus_preds">Gaus_Preds</code></td>
<td>
<p>Dummy param for package testing for CRAN, ignore.</p>
</td></tr>
<tr><td><code id="gbm.auto_+3A_...">...</code></td>
<td>
<p>Optional arguments for gbm.step (dismo package) arguments n.trees and
max.trees, both of which can be added in list(1,2) format to pass to fam1 and
2; for gbm.mapsf colourscale, heatcolours, colournumber, and others.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Errors and their origins:
</p>

<ol>
<li><p> install ERROR: dependencies ‘rgdal’, ‘rgeos’ are not available for package ‘gbm.auto’.
For Linux/*buntu systems, in terminal, type: 'sudo apt install libgeos-dev', 'sudo apt install
libproj-dev', 'sudo apt install libgdal-dev'.
</p>
</li>
<li><p> Error in FUN(X[[i]], ...) : only defined on a data frame with all numeric
variables. Check your variable types are correct, e.g. numerics haven't been imported
as factors because there's an errant first row of text information before the
data. Remove NA rows from the response variable if present: convert blank
cells to NA on import with read.csv(x, na.strings = &quot;&quot;) then
samples2 &lt;- samples[-which(is.na(samples[,resvar_column_number])),]
</p>
</li>
<li><p> At BF=0.5, if nrows &lt;= 42, gbm.step will crash. Use gbm.bfcheck to determine optimal viable BF
size.
</p>
</li>
<li><p> Maps/plots don't work/output. If on a Mac, try changing pngtype to &quot;quartz&quot;.
</p>
</li>
<li><p> Error in while (delta.deviance &gt; tolerance.test &amp; n.fitted &lt;
max.trees): missing value where TRUE/FALSE needed. If running a zero-inflated delta model
(bernoulli/bin &amp; gaussian/gaus), Data are expected to contain zeroes (lots of them in zero-
inflated cases), have you already filtered them out, i.e. are only testing the positive cases?
Or do you only have positive cases? If so only run (e.g.) Gaussian: set ZI to FALSE.
</p>
</li>
<li><p> Error in round(gbm.object$cv.statistics$deviance.mean, 4) : non-numeric argument to
mathematical function. LR or BF probably too low in earlier BRT (normally Gaus run with highest
TC).
</p>
</li>
<li><p> Error in if (n.trees &gt; x$n.trees) argument is of length zero. LR or BF probably too low
in earlier BRT (normally Gaus run with highest TC).
</p>
</li>
<li><p> Error in gbm.fit(x, y, offset = offset, distribution = distribution, w = w): The dataset size
is too small or subsampling rate is too large: nTrain*bag.fraction &lt;= n.minobsinnode. LR or BF
probably too low in earlier BRT (normally Gaus run with highest TC). It may be that you don't
have enough positive samples to run BRT modelling. Run gbm.bfcheck to check recommended minimum
BF size.
</p>
</li>
<li><p> Warning message: In cor(y_i, u_i) : the standard deviation is zero. LR or BF probably too low
in earlier BRT (normally Gaus run with highest TC). It may be that you don't have enough positive
samples to run BRT modelling. Run gbm.bfcheck to check recommended minimum BF size. Similarly:
glm.fit: fitted probabilities numerically 0 or 1 occurred, and glm.fit: algorithm did not
converge. Similarly: Error in if (get(paste0(&quot;Gaus_BRT&quot;, &quot;.tc&quot;, j, &quot;.lr&quot;, k, &quot;.bf&quot;,
l))$self.statistics$correlation[[1]]: argument is of length zero. See also: Error 15.
</p>
</li>
<li><p> Anomalous values can obfuscate clarity in line plots e.g. salinity range 32:35ppm but dataset
has errant 0 value: plot axis will be 0:35, and 99.99% of the data will be in the tiny bit at
the right. Clean your data beforehand.
</p>
</li>
<li><p> Error in plot.new() : figure margins too large: In RStudio, adjust plot pane (usually bottom
right) to increase its size. Still fails? Set multiplot=FALSE.
</p>
</li>
<li><p> Error in dev.print(file = paste0(&quot;./&quot;, names(samples[i]), &quot;/pred_dev_bin.jpeg&quot;): can only
print from a screen device. An earlier failed run (e.g. LR/BF too low) left a plotting device
open. Close it with: 'dev.off()'.
</p>
</li>
<li><p> RStudio crashed: set alerts=F and pause cloud sync programs if outputting to a synced folder.
</p>
</li>
<li><p> Error in grDevices::dev.copy(device = function (filename = &quot;Rplot%03d.jpeg&quot;, could not open
file './resvar/pred_dev_bin.jpeg' (or similar). Your resvar column name contains an
illegal character e.g. /&amp;'_. Fix with colnames(samples)[n] &lt;- &quot;BetterName&quot;.
</p>
</li>
<li><p> Error in gbm.fit: Poisson requires the response to be a positive integer. If running Poisson
distributions, ensure the response variables are positive integers, but if they are, try a
smaller LR.
</p>
</li>
<li><p> If lineplots of factorial variables include empty columns be sure to remove unused levels
with samples %&lt;&gt;% droplevels() before the gbm.auto run.
</p>
</li>
<li><p> Error in seq.default(from = min(x$var.levels[[i.var[i]]]), to =
max(x$var.levels[[i.var[i]]]):'from' must be a finite number. If you logged any expvars
with log() and they has zeroes in them, those zeroes became imaginary numbers. Use
log1p() instead.
</p>
</li>
<li><p> Error in loadNamespace...'dismo' 1.3-9 is being loaded, but &gt;= 1.3.10 is required: first do
remotes::install_github(&quot;rspatial/dismo&quot;) then library(dismo).
</p>
</li>
<li><p> Error in if (scope &gt;= 160) res &lt;- &quot;c&quot; : missing value where TRUE/FALSE needed. Check gridslat
and gridslon are indexing the correct columns in grids.
</p>
</li></ol>

<p>ALSO: check this section in the other functions run by gbm.auto e.g. gbm.mapsf, gbm.basemap. Use
traceback() to find the source of errors.
</p>
<p>I strongly recommend that you download papers 1 to 5 (or just the doctoral thesis) on
<a href="http://www.simondedman.com">http://www.simondedman.com</a>, with emphasis on P4 (the guide) and P1 (statistical background).
Elith et al 2008 (<a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/j.1365-2656.2008.01390.x">https://besjournals.onlinelibrary.wiley.com/doi/10.1111/j.1365-2656.2008.01390.x</a>) is also strongly
recommended.
Just because you CAN try every conceivable combination of tc, lr, bf, all, at once doesn't mean
you should. Try a range of lr in shrinking orders of magnitude from 0.1 to 0.000001, find the
best, THEN try tc c(2, n.expvars), find the best THEN bf c(0.5, 0.75, 0.9) and then in between if
either outperform 0.5.
</p>


<h3>Value</h3>

<p>Line, dot and bar plots, a report of all variables used, statistics
for tests, variable interactions, predictors used and dropped, etc. If
selected, generates predicted abundance maps, and Unrepresentativeness surface. Biggest
Interactions in the report csv: see ?dismo::gbm.interactions .
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Not run. Note: grids file was heavily cropped for CRAN upload so output map
# predictions only cover patchy chunks of the Irish Sea, not the whole area.
# Full versions of these files:
# https://drive.google.com/file/d/1WHYpftP3roozVKwi_R_IpW7tlZIhZA7r
# /view?usp=sharing
library(gbm.auto)
data(grids)
data(samples)
# Set your working directory
gbm.auto(grids = grids, samples = samples, expvar = c(4:8, 10), resvar = 11,
tc = c(2,7), lr = c(0.005, 0.001), ZI = TRUE, savegbm = FALSE)

</code></pre>

<hr>
<h2 id='gbm.basemap'>Creates Basemaps for Gbm.auto mapping from your data range</h2><span id='topic+gbm.basemap'></span>

<h3>Description</h3>

<p>Downloads unzips crops &amp; saves NOAAs global coastline shapefiles to user-set
box. Use for 'shape' in gbm.map. If downloading in RStudio uncheck
&quot;Use secure download method for HTTP&quot; in Tools &gt; Global Options &gt; Packages.
Simon Dedman, 2015/6 simondedman@gmail.com GitHub.com/SimonDedman/gbm.auto
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.basemap(
  bounds = NULL,
  grids = NULL,
  gridslat = NULL,
  gridslon = NULL,
  getzip = TRUE,
  zipvers = "2.3.7",
  savedir = tempdir(),
  savename = "Crop_Map",
  res = "CALC",
  extrabounds = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.basemap_+3A_bounds">bounds</code></td>
<td>
<p>Region to crop to: c(xmin,xmax,ymin,ymax).</p>
</td></tr>
<tr><td><code id="gbm.basemap_+3A_grids">grids</code></td>
<td>
<p>If bounds unspecified, name your grids database here.</p>
</td></tr>
<tr><td><code id="gbm.basemap_+3A_gridslat">gridslat</code></td>
<td>
<p>If bounds unspecified, specify which column in grids is
latitude.</p>
</td></tr>
<tr><td><code id="gbm.basemap_+3A_gridslon">gridslon</code></td>
<td>
<p>If bounds unspecified, specify which column in grids is
longitude.</p>
</td></tr>
<tr><td><code id="gbm.basemap_+3A_getzip">getzip</code></td>
<td>
<p>Download &amp; unpack GSHHS data to WD? &quot;TRUE&quot; else
absolute/relative reference to GSHHS_shp folder, including that folder.</p>
</td></tr>
<tr><td><code id="gbm.basemap_+3A_zipvers">zipvers</code></td>
<td>
<p>GSHHS version, in case it updates. Please email developer (SD)
if this is incorrect.</p>
</td></tr>
<tr><td><code id="gbm.basemap_+3A_savedir">savedir</code></td>
<td>
<p>Save outputs to a temporary directory (default) else change to
current directory e.g. &quot;/home/me/folder&quot;. Do not use getwd() here.</p>
</td></tr>
<tr><td><code id="gbm.basemap_+3A_savename">savename</code></td>
<td>
<p>Shapefile save-name, no shp extension, default is &quot;Crop_Map&quot;</p>
</td></tr>
<tr><td><code id="gbm.basemap_+3A_res">res</code></td>
<td>
<p>Resolution, 1:5 (low:high) OR c,l,i,h,f (coarse, low,
intermediate, high, full) or &quot;CALC&quot; to calculate based on bounds. Choose one.</p>
</td></tr>
<tr><td><code id="gbm.basemap_+3A_extrabounds">extrabounds</code></td>
<td>
<p>Grow bounds 16pct each direction to expand rectangular
datasets basemaps over the entire square area created by basemap in mapplots.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>errors and their origins:
</p>

<ol>
<li><p> Error in setwd(getzip) : cannot change working directory
If you've specified the location of the local GSHHS_shp folder, ensure you're
in the correct directory relative to it. This error means it looked for the
folder and couldn't find it.
</p>
</li>
<li><p> subscript out of bounds: can't crop world map to your bounds.
Check lat/lon are the right way around: check gridslat and gridslon point to the correct columns
for lat and lon in grids, and those columns named (something like) lat and lon, ARE ACTUALLY the
latitudes and longitudes, and not the wrong way around.
</p>
</li>
<li><p> If your download is timing out use options(timeout = 240).
</p>
</li>
<li><p> Error in if (scope &gt;= 160) res &lt;- &quot;c&quot; : missing value where TRUE/FALSE needed. Check gridslat
and gridslon are indexing the correct columns in grids.
</p>
</li></ol>



<h3>Value</h3>

<p>basemap coastline file for gbm.map in gbm.auto. &quot;cropshp&quot;
SpatialPolygonsDataFrame in in local environment &amp; user-named files in
&quot;CroppedMap&quot; folder. Load later with maptools function:
MyMap &lt;- sf::st_read(dsn = &quot;./CroppedMap/Crop_Map.shp&quot;, layer = &quot;Crop_Map, quiet = TRUE)
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Not run: downloads and saves external data.
data(samples)
mybounds &lt;- c(range(samples[,3]),range(samples[,2]))
gbm.basemap(bounds = mybounds, getzip = "./GSHHS_shp/",
savename = "My_Crop_Map", res = "f")
# In this example GSHHS folder already downloaded to the working directory
# hence I pointed getzip at that rather than having it download the zip again


</code></pre>

<hr>
<h2 id='gbm.bfcheck'>Calculates minimum Bag Fraction size for gbm.auto</h2><span id='topic+gbm.bfcheck'></span>

<h3>Description</h3>

<p>Provides minimum bag fractions for gbm.auto, preventing failure
due to bf &amp; samples rows limit. Simon Dedman, 2016, simondedman@gmail.com,
GitHub.com/SimonDedman/gbm.auto
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.bfcheck(samples, resvar, ZI = "CHECK", grv = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.bfcheck_+3A_samples">samples</code></td>
<td>
<p>Samples dataset, same as gbm.auto.</p>
</td></tr>
<tr><td><code id="gbm.bfcheck_+3A_resvar">resvar</code></td>
<td>
<p>Response variable column in samples.</p>
</td></tr>
<tr><td><code id="gbm.bfcheck_+3A_zi">ZI</code></td>
<td>
<p>Are samples zero-inflated? TRUE/FALSE/&quot;CHECK&quot;.</p>
</td></tr>
<tr><td><code id="gbm.bfcheck_+3A_grv">grv</code></td>
<td>
<p>Dummy param for package testing for CRAN, ignore.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints minimum Bag Fraction size for gbm.auto.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(samples)
gbm.bfcheck(samples = samples, resvar = "Cuckoo")
</code></pre>

<hr>
<h2 id='gbm.cons'>Conservation Area Mapping</h2><span id='topic+gbm.cons'></span>

<h3>Description</h3>

<p>Runs gbm.auto for multiple subsets of the same overall dataset and
scales the combined results, leading to maps which highlight areas of high
conservation importance for multiple species in the same study area e.g.
using juvenile and adult female subsets to locate candidate nursery grounds
and spawning areas respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.cons(
  mygrids,
  subsets,
  alerts = TRUE,
  map = TRUE,
  BnW = TRUE,
  resvars,
  gbmautos = TRUE,
  savedir = tempdir(),
  expvars,
  tcs = NULL,
  lrs = rep(list(c(0.01, 0.005)), length(resvars)),
  bfs = rep(0.5, length(resvars)),
  ZIs = rep("CHECK", length(resvars)),
  colss = rep(list(grey.colors(1, 1, 1)), length(resvars)),
  linesfiless = rep(FALSE, length(resvars)),
  savegbms = rep(TRUE, length(resvars)),
  varints = rep(TRUE, length(resvars)),
  maps = rep(TRUE, length(resvars)),
  RSBs = rep(TRUE, length(resvars)),
  BnWs = rep(TRUE, length(resvars)),
  zeroes = rep(TRUE, length(resvars)),
  shape = NULL,
  pngtype = c("cairo-png", "quartz", "Xlib"),
  gridslat = 2,
  gridslon = 1,
  grids = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.cons_+3A_mygrids">mygrids</code></td>
<td>
<p>Gridded lat+long+data object to predict to.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_subsets">subsets</code></td>
<td>
<p>Subset name(s): character; single or vector, corresponding to
matching-named dataset objects e.g. read in by read.csv().</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_alerts">alerts</code></td>
<td>
<p>Play sounds to mark progress steps.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_map">map</code></td>
<td>
<p>Produce maps.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_bnw">BnW</code></td>
<td>
<p>Also produce B&amp;W maps?</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_resvars">resvars</code></td>
<td>
<p>Vector of resvars cols from dataset objects for gbm.autos,
length(subsets)*species, no default.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_gbmautos">gbmautos</code></td>
<td>
<p>Do gbm.auto runs for species? Default TRUE, set FALSE if
already run and output files in expected directories.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_savedir">savedir</code></td>
<td>
<p>Save outputs to a temporary directory (default) else change to
current directory e.g. &quot;/home/me/folder&quot;. Do not use getwd() here.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_expvars">expvars</code></td>
<td>
<p>List object of expvar vectors for gbm.autos, length = no. of
subsets * no. of species. No default.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_tcs">tcs</code></td>
<td>
<p>Gbm.auto parameters, auto-calculated below if not provided by user.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_lrs">lrs</code></td>
<td>
<p>Gbm.auto parameter, uses defaults if not provided by user.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_bfs">bfs</code></td>
<td>
<p>Gbm.auto parameter, uses defaults if not provided by user.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_zis">ZIs</code></td>
<td>
<p>Gbm.auto parameter, autocalculated below if not provided by user.
Choose one entry.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_colss">colss</code></td>
<td>
<p>Gbm.auto parameter, uses defaults if not provided by user.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_linesfiless">linesfiless</code></td>
<td>
<p>Gbm.auto parameter, uses defaults if not provided by user.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_savegbms">savegbms</code></td>
<td>
<p>Gbm.auto parameter, uses defaults if not provided by user.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_varints">varints</code></td>
<td>
<p>Gbm.auto parameter, uses defaults if not provided by user.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_maps">maps</code></td>
<td>
<p>Gbm.auto parameter, uses defaults if not provided by user.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_rsbs">RSBs</code></td>
<td>
<p>Gbm.auto parameter, uses defaults if not provided by user.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_bnws">BnWs</code></td>
<td>
<p>Gbm.auto parameter, uses defaults if not provided by user.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_zeroes">zeroes</code></td>
<td>
<p>For breaks.grid, include zero-only category in colour
breakpoints and subsequent legend. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_shape">shape</code></td>
<td>
<p>Coastline file for gbm.map.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_pngtype">pngtype</code></td>
<td>
<p>File-type for png files, alternatively try &quot;quartz&quot; on Mac.
Choose one.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_gridslat">gridslat</code></td>
<td>
<p>Per Gbm.auto defaults to 2.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_gridslon">gridslon</code></td>
<td>
<p>Per Gbm.auto defaults to 1.</p>
</td></tr>
<tr><td><code id="gbm.cons_+3A_grids">grids</code></td>
<td>
<p>Dummy param for package testing for CRAN, ignore.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Maps via gbm.map &amp; saved data as csv file.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Not run: downloads and saves external data.
data(grids)
gbm.cons(mygrids = grids, subsets = c("Juveniles","Adult_Females"),
         resvars = c(44:47,11:14),
         expvars = list(c(4:11,15,17,21,25,29,37),
                        c(4:11,15,18,22,26,30,38),
                        c(4:11,15,19,23,27,31),
                        c(4:11,15,20,24,28,32,39),
                        4:10, 4:10, 4:10, 4:10),
         tcs = list(c(2,14), c(2,14), 13, c(2,14), c(2,6), c(2,6), 6,
         c(2,6)),
         lrs = list(c(0.01,0.005), c(0.01,0.005), 0.005, c(0.01,0.005),
               0.005, 0.005, 0.001, 0.005),
         ZIs = rep(TRUE, 8),
         savegbms = rep(FALSE, 8),
         varints = rep(FALSE, 8),
         RSBs = rep(FALSE, 8),
         BnWs = rep(FALSE, 8),
         zeroes = rep(FALSE,8))
         

</code></pre>

<hr>
<h2 id='gbm.factorplot'>Creates ggplots of marginal effect for factorial variables from plot.gbm in gbm.auto.</h2><span id='topic+gbm.factorplot'></span>

<h3>Description</h3>

<p>Creates an additional plot to those created by gbm.plot within gbm.auto. Can also take
Bin/Gaus_Best_line.csv or similar csvs directly. Allows changing of x axis levels and all ggplot
and ggsave params.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.factorplot(
  x,
  factorplotlevels = NULL,
  ggplot2guideaxisangle = 0,
  ggplot2labsx = "",
  ggplot2labsy = "Marginal Effect",
  ggplot2axistext = 1.5,
  ggplot2axistitle = 2,
  ggplot2legendtext = 1,
  ggplot2legendtitle = 1.5,
  ggplot2legendtitlealign = 0,
  ggplot2plotbackgroundfill = "white",
  ggplot2plotbackgroundcolour = "grey50",
  ggplot2striptextx = 2,
  ggplot2panelbordercolour = "black",
  ggplot2panelborderfill = NA,
  ggplot2panelborderlinewidth = 1,
  ggplot2legendspacingx = grid::unit(0, "cm"),
  ggplot2legendbackground = ggplot2::element_blank(),
  ggplot2panelbackgroundfill = "white",
  ggplot2panelbackgroundcolour = "grey50",
  ggplot2panelgridcolour = "grey90",
  ggplot2legendkey = ggplot2::element_blank(),
  ggsavefilename = paste0(lubridate::today(), "_Categorical-variable.png"),
  ggsaveplot = ggplot2::last_plot(),
  ggsavedevice = "png",
  ggsavepath = "",
  ggsavescale = 2,
  ggsavewidth = 10,
  ggsaveheight = 4,
  ggsaveunits = "in",
  ggsavedpi = 300,
  ggsavelimitsize = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.factorplot_+3A_x">x</code></td>
<td>
<p>Input data.frame or tibble or csv (full file address including .csv) to read, must be a
categorical variable.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_factorplotlevels">factorplotlevels</code></td>
<td>
<p>Character vector of the variable's levels to reorder the x axis by, all
must match those in the first column of the csv exactly. Default NULL orders from high to low Y
value.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2guideaxisangle">ggplot2guideaxisangle</code></td>
<td>
<p>Default 0. Set at e.g. 90 to rotate.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2labsx">ggplot2labsx</code></td>
<td>
<p>Default: &quot;&quot;.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2labsy">ggplot2labsy</code></td>
<td>
<p>Default: &quot;Marginal Effect&quot;.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2axistext">ggplot2axistext</code></td>
<td>
<p>Default: 1.5.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2axistitle">ggplot2axistitle</code></td>
<td>
<p>Default: 2.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2legendtext">ggplot2legendtext</code></td>
<td>
<p>Default: 1.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2legendtitle">ggplot2legendtitle</code></td>
<td>
<p>Default: 1.5.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2legendtitlealign">ggplot2legendtitlealign</code></td>
<td>
<p>Default: 0, # otherwise effect type title centre aligned for some reason.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2plotbackgroundfill">ggplot2plotbackgroundfill</code></td>
<td>
<p>Default: &quot;white&quot;, white background.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2plotbackgroundcolour">ggplot2plotbackgroundcolour</code></td>
<td>
<p>Default: &quot;grey50&quot;, background lines.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2striptextx">ggplot2striptextx</code></td>
<td>
<p>Default: 2.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2panelbordercolour">ggplot2panelbordercolour</code></td>
<td>
<p>Default: &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2panelborderfill">ggplot2panelborderfill</code></td>
<td>
<p>Default: NA.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2panelborderlinewidth">ggplot2panelborderlinewidth</code></td>
<td>
<p>Default: 1.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2legendspacingx">ggplot2legendspacingx</code></td>
<td>
<p>Default: unit(0, &quot;cm&quot;), # compress spacing between legend items, this is min.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2legendbackground">ggplot2legendbackground</code></td>
<td>
<p>Default: ggplot2::element_blank().</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2panelbackgroundfill">ggplot2panelbackgroundfill</code></td>
<td>
<p>Default: &quot;white&quot;.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2panelbackgroundcolour">ggplot2panelbackgroundcolour</code></td>
<td>
<p>Default: &quot;grey50&quot;.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2panelgridcolour">ggplot2panelgridcolour</code></td>
<td>
<p>Default: &quot;grey90&quot;.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggplot2legendkey">ggplot2legendkey</code></td>
<td>
<p>Default: ggplot2::element_blank().</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggsavefilename">ggsavefilename</code></td>
<td>
<p>Default: paste0(saveloc, lubridate::today(), &quot;_SankeyAlluvial_EMT.SoEv-EfTyp_Col-EfSz.png&quot;).</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggsaveplot">ggsaveplot</code></td>
<td>
<p>Default: last_plot().</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggsavedevice">ggsavedevice</code></td>
<td>
<p>Default: &quot;png&quot;.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggsavepath">ggsavepath</code></td>
<td>
<p>Default: &quot;&quot;.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggsavescale">ggsavescale</code></td>
<td>
<p>Default: 2.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggsavewidth">ggsavewidth</code></td>
<td>
<p>Default: 10.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggsaveheight">ggsaveheight</code></td>
<td>
<p>Default: 4.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggsaveunits">ggsaveunits</code></td>
<td>
<p>Default: &quot;in&quot;.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggsavedpi">ggsavedpi</code></td>
<td>
<p>Default: 300.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_ggsavelimitsize">ggsavelimitsize</code></td>
<td>
<p>Default: TRUE.</p>
</td></tr>
<tr><td><code id="gbm.factorplot_+3A_...">...</code></td>
<td>
<p>Allow params to be called from higher function esp gbm.auto.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'r lifecycle::badge(&quot;experimental&quot;)
</p>


<h3>Value</h3>

<p>Factorial ggplot saved with users preferred location and name.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>

<hr>
<h2 id='gbm.lmplots'>Plot linear models for all expvar against the resvar</h2><span id='topic+gbm.lmplots'></span>

<h3>Description</h3>

<p>Loops the lmplot function, shows linear model plots for all expvar against the resvar. Good
practice to do this before running gbm.auto so you have a sense of the basic relationship of the
variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.lmplots(
  samples = NULL,
  expvar = NULL,
  resvar = NULL,
  expvarnames = NULL,
  resvarname = NULL,
  savedir = NULL,
  plotname = NULL,
  pngtype = c("cairo-png", "quartz", "Xlib"),
  r2line = TRUE,
  pointtext = FALSE,
  pointlabs = resvar,
  pointcol = "black",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.lmplots_+3A_samples">samples</code></td>
<td>
<p>Explanatory and response variables to predict from. Keep col
names short (~17 characters max), no odd characters, spaces, starting
numerals or terminal periods. Spaces may be converted to periods in directory
names, underscores won't. Can be a subset of a large dataset.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_expvar">expvar</code></td>
<td>
<p>Vector of names or column numbers of explanatory variables in
'samples': c(1,3,6) or c(&quot;Temp&quot;,&quot;Sal&quot;). No default.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_resvar">resvar</code></td>
<td>
<p>Name or column number(s) of response variable in samples: 12,
c(1,4), &quot;Rockfish&quot;. No default. Column name is ideally species name.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_expvarnames">expvarnames</code></td>
<td>
<p>Vector of names same length as expvar, if you want nicer names.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_resvarname">resvarname</code></td>
<td>
<p>Single character object, if you want a nicer resvar name.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_savedir">savedir</code></td>
<td>
<p>Save location, end with &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_plotname">plotname</code></td>
<td>
<p>Character vector of plot names else expvarnames else expvar will be used.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_pngtype">pngtype</code></td>
<td>
<p>Filetype for png files, alternatively try &quot;quartz&quot; on Mac.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_r2line">r2line</code></td>
<td>
<p>Plot rsquared trendline, default TRUE.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_pointtext">pointtext</code></td>
<td>
<p>Label each point? Default FALSE.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_pointlabs">pointlabs</code></td>
<td>
<p>Point labels, defaults to resvar value.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_pointcol">pointcol</code></td>
<td>
<p>Points colour, default &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="gbm.lmplots_+3A_...">...</code></td>
<td>
<p>Allows controlling of text label params e.g. adj cex &amp;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Errors and their origins:
</p>


<h3>Value</h3>

<p>Invisibly saves png plots into savedir.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>

<hr>
<h2 id='gbm.loop'>Calculate Coefficient Of Variation surfaces for gbm.auto predictions</h2><span id='topic+gbm.loop'></span>

<h3>Description</h3>

<p>Bagging introduces stochasticity which can result in sizeable variance in
output predictions by gbm.auto for small datasets. This function runs a user-
specified number of loops through the same gbm.auto parameter combinations
and calculates the Coefficient Of Variation in the predicted abundance scores
for each site aka cell. This can be mapped, to spatially demonstrate the
output variance range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.loop(
  loops = 10,
  savedir = tempdir(),
  savecsv = TRUE,
  calcpreds = TRUE,
  varmap = TRUE,
  measure = "CPUE",
  cleanup = FALSE,
  grids = NULL,
  samples,
  expvar,
  resvar,
  randomvar = FALSE,
  tc = c(2),
  lr = c(0.01),
  bf = 0.5,
  n.trees = 50,
  ZI = "CHECK",
  fam1 = c("bernoulli", "binomial", "poisson", "laplace", "gaussian"),
  fam2 = c("gaussian", "bernoulli", "binomial", "poisson", "laplace"),
  simp = TRUE,
  gridslat = 2,
  gridslon = 1,
  multiplot = FALSE,
  cols = grey.colors(1, 1, 1),
  linesfiles = TRUE,
  smooth = FALSE,
  savegbm = FALSE,
  loadgbm = NULL,
  varint = FALSE,
  map = TRUE,
  shape = NULL,
  RSB = FALSE,
  BnW = FALSE,
  alerts = FALSE,
  pngtype = c("cairo-png", "quartz", "Xlib"),
  gaus = TRUE,
  MLEvaluate = TRUE,
  runautos = TRUE,
  Min.Inf = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.loop_+3A_loops">loops</code></td>
<td>
<p>The number of loops required, integer.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_savedir">savedir</code></td>
<td>
<p>Save outputs to a temporary directory (default) else change to
current directory e.g. &quot;/home/me/folder&quot;. Do not use getwd() here.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_savecsv">savecsv</code></td>
<td>
<p>Save coefficients of variation in simple &amp; extended format.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_calcpreds">calcpreds</code></td>
<td>
<p>Calculate coefficients of variation of predicted abundance?</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_varmap">varmap</code></td>
<td>
<p>Create a map of the coefficients of variation outputs?</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_measure">measure</code></td>
<td>
<p>Map legend, coefficients of variation of what? Default CPUE.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_cleanup">cleanup</code></td>
<td>
<p>Remove gbm.auto-generated directory each loop? Default FALSE.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_grids">grids</code></td>
<td>
<p>See gbm.auto help for all subsequent params.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_samples">samples</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_expvar">expvar</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_resvar">resvar</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_randomvar">randomvar</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_tc">tc</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_lr">lr</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_bf">bf</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_n.trees">n.trees</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_zi">ZI</code></td>
<td>
<p>See gbm.auto help. Choose one.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_fam1">fam1</code></td>
<td>
<p>See gbm.auto help. Choose one.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_fam2">fam2</code></td>
<td>
<p>See gbm.auto help. Choose one.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_simp">simp</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_gridslat">gridslat</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_gridslon">gridslon</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_multiplot">multiplot</code></td>
<td>
<p>See gbm.auto help. Default False</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_cols">cols</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_linesfiles">linesfiles</code></td>
<td>
<p>See gbm.auto help; TRUE or linesfiles calculations fail.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_smooth">smooth</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_savegbm">savegbm</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_loadgbm">loadgbm</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_varint">varint</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_map">map</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_shape">shape</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_rsb">RSB</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_bnw">BnW</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_alerts">alerts</code></td>
<td>
<p>See gbm.auto help; default FALSE as frequent use can crash
RStudio.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_pngtype">pngtype</code></td>
<td>
<p>See gbm.auto help. Choose one.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_gaus">gaus</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_mlevaluate">MLEvaluate</code></td>
<td>
<p>See gbm.auto help.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_runautos">runautos</code></td>
<td>
<p>Run gbm.autos, default TRUE, turn off to only collate
numbered-folder results.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_min.inf">Min.Inf</code></td>
<td>
<p>Dummy param for package testing for CRAN, ignore.</p>
</td></tr>
<tr><td><code id="gbm.loop_+3A_...">...</code></td>
<td>
<p>Additional params for gbm.auto sub-functions including gbm.step.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Thanks to a 2023 improvement to gbm.auto and gbm.loop,
</p>


<h3>Value</h3>

<p>Returns a data frame of lat, long, 1 predicted abundance per loop,
and a final variance score per cell.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Not run: downloads and saves external data.
library("gbm.auto")
data(grids) # load grids
data(samples) # load samples
gbmloopexample &lt;- gbm.loop(loops = 2, samples = samples,
grids = grids, expvar = c(4:10), resvar = 11, simp = F)


</code></pre>

<hr>
<h2 id='gbm.map'>Maps of predicted abundance from Boosted Regression Tree modelling</h2><span id='topic+gbm.map'></span>

<h3>Description</h3>

<p>Generates maps from the outputs of gbm.step then Gbm.predict.grids, handled
automatically within gbm.auto but can be run alone, and generates
representativeness surfaces from the output of gbm.rsb.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.map(
  x,
  y,
  z,
  byx = NULL,
  byy = NULL,
  grdfun = mean,
  mapmain = "Predicted CPUE (numbers per hour): ",
  species = "Response Variable",
  heatcolours = c("white", "yellow", "orange", "red", "brown4"),
  colournumber = 8,
  shape = NULL,
  landcol = "grey80",
  mapback = "lightblue",
  legendloc = "bottomright",
  legendtitle = "CPUE",
  lejback = "white",
  zero = TRUE,
  quantile = 1,
  byxout = FALSE,
  breaks = NULL,
  byxport = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.map_+3A_x">x</code></td>
<td>
<p>Vector of longitudes, from make.grid in mapplots; x. Order by this
(descending) SECOND.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_y">y</code></td>
<td>
<p>Vector of latitudes, from make.grid in mapplots; grids[,gridslat].
Order by this (descending) first.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_z">z</code></td>
<td>
<p>Vector of abundances generated by gbm.predict.grids, from make.grid
in mapplots; grids[,predabund].</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_byx">byx</code></td>
<td>
<p>Longitudinal width of grid cell, from make.grid in mapplots.
Autogenerated if left blank.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_byy">byy</code></td>
<td>
<p>Latitudinal height of grid cell, from make.grid in mapplots.
Autogenerated if left blank.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_grdfun">grdfun</code></td>
<td>
<p>make.grid operand for &gt;=2 values per cell. Default:mean, other
options: sum prod min max sd se var.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_mapmain">mapmain</code></td>
<td>
<p>Plot title, has species value appended. Default &quot;Predicted
CPUE (numbers per hour): &quot;.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_species">species</code></td>
<td>
<p>Response variable name, from basemap in mapplots;
names(samples[i]). Defaults to &quot;Response Variable&quot;.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_heatcolours">heatcolours</code></td>
<td>
<p>Vector for abundance colour scale, defaults to the heatcol from
legend.grid and draw.grid in mapplots which is c(&quot;white&quot;, &quot;yellow&quot;, &quot;orange&quot;
, &quot;red&quot;, &quot;brown4&quot;).</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_colournumber">colournumber</code></td>
<td>
<p>Number of colours to spread heatcol over, default:8.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_shape">shape</code></td>
<td>
<p>Basemap shape to draw, from draw.shape in mapplots. Defaults to
NULL which calls gbm.basemap to generate it for you. First read in a shp file e.g. myshape &lt;-
sf::st_read(dsn = paste0(savename, &quot;.shp&quot;), layer = savename, quiet = TRUE), then use shape = myshape.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_landcol">landcol</code></td>
<td>
<p>Colour for 'null' area of map (for marine plots, this is
land), from draw.shape in mapplots. Default &quot;grey80&quot; (light grey).</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_mapback">mapback</code></td>
<td>
<p>Basemap background colour, defaults to lightblue (ocean for
marine plots).</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_legendloc">legendloc</code></td>
<td>
<p>Location on map of legend box, from legend.grid in mapplots,
default bottomright.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_legendtitle">legendtitle</code></td>
<td>
<p>The metric of abundance, e.g. CPUE for fisheries, from
legend.grid in mapplots. Default &quot;CPUE&quot;.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_lejback">lejback</code></td>
<td>
<p>Background colour of legend, from legend.grid in mapplots.
Default &quot;white&quot;.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_zero">zero</code></td>
<td>
<p>Force include 0-only bin in breaks.grid and thus legend? Default
TRUE.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_quantile">quantile</code></td>
<td>
<p>Set max quantile of data to include in bins, from breaks.grid
in mapplots; lower to e.g. 0.975 cutoff outliers; default 1.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_byxout">byxout</code></td>
<td>
<p>Export byx to use elsewhere? Default:FALSE.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_breaks">breaks</code></td>
<td>
<p>Vector of breakpoints for colour scales; default blank,
generated automatically.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_byxport">byxport</code></td>
<td>
<p>Dummy param for package testing for CRAN, ignore.</p>
</td></tr>
<tr><td><code id="gbm.map_+3A_...">...</code></td>
<td>
<p>Additional arguments for legend.grid's ... which passes to legend.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
Superseded by gbm.mapsf on 2023-08-07, but still works.
</p>
<p>Errors and their origins:
</p>
<p>Error in seq.default(xlim[1], xlim[2], by = byx):wrong sign in 'by' argument
Check that your lat &amp; long columns are the right way around. Ensure grids
data are gridded, i.e. they are in a regular pattern of same/similar lines of lat/lon, even if
they're missing sections.
</p>
<p>Suggested parameter values:
z = rsbdf[,&quot;Unrepresentativeness&quot;]
</p>
<p>mapmain = &quot;Unrepresentativeness: &quot;
</p>
<p>legendtitle = &quot;UnRep 0-1&quot;
</p>


<h3>Value</h3>

<p>Species abundance maps using data provided by gbm.auto, and
Representativeness Surface Builder maps using data provided by gbm.rsb, to be
run in a png/par/gbm.map/dev.off sequence.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>
<p>Hans Gerritsen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Not run: downloads and saves external data.
# Suggested code for outputting to png:
data(grids)
# set working directory somewhere suitable
png(filename = "gbmmap.png", width = 7680, height = 7680, units = "px",
pointsize = 192, bg = "white", res = NA, family = "", type = "cairo-png")
par(mar = c(3.2,3,1.3,0), las = 1, mgp = c(2.1,0.5,0), xpd = FALSE)
gbm.map(x = grids[,"Longitude"], y = grids[,"Latitude"], z = grids[,"Effort"]
, species = "Effort")
dev.off()


</code></pre>

<hr>
<h2 id='gbm.mapsf'>Maps of predicted abundance from Boosted Regression Tree modelling</h2><span id='topic+gbm.mapsf'></span>

<h3>Description</h3>

<p>Generates maps from the outputs of gbm.step then Gbm.predict.grids, handled automatically within
gbm.auto but can be run alone, and generates representativeness surfaces from the output of
gbm.rsb.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.mapsf(
  predabund = NULL,
  predabundlon = 2,
  predabundlat = 1,
  predabundpreds = 3,
  myLocation = NULL,
  trim = TRUE,
  trimfivepct = FALSE,
  scale100 = FALSE,
  gmapsAPI = NULL,
  mapsource = "google",
  googlemap = TRUE,
  maptype = "satellite",
  darkenproportion = 0,
  mapzoom = NULL,
  shape = NULL,
  expandfactor = 0,
  colourscale = "viridis",
  colorscale = NULL,
  heatcolours = c("white", "yellow", "orange", "red", "brown4"),
  colournumber = 8,
  colourscalelimits = NULL,
  colourscalebreaks = NULL,
  colourscalelabels = NULL,
  colourscaleexpand = NULL,
  studyspecies = "MySpecies",
  plottitle = paste0("Predicted abundance of ", studyspecies),
  plotsubtitle = "CPUE",
  legendtitle = "CPUE",
  plotcaption = paste0("gbm.auto::gbm.mapsf, ", lubridate::today()),
  axisxlabel = "Longitude",
  axisylabel = "Latitude",
  legendposition = c(0.05, 0.15),
  fontsize = 12,
  fontfamily = "Times New Roman",
  filesavename = paste0(lubridate::today(), "_", studyspecies, "_", legendtitle, ".png"),
  savedir = tempdir(),
  receiverlats = NULL,
  receiverlons = NULL,
  receivernames = NULL,
  receiverrange = NULL,
  recpointscol = "black",
  recpointsfill = "white",
  recpointsalpha = 0.5,
  recpointssize = 1,
  recpointsshape = 21,
  recbufcol = "grey75",
  recbuffill = "grey",
  recbufalpha = 0.5,
  reclabcol = "black",
  reclabfill = NA,
  reclabnudgex = 0,
  reclabnudgey = -200,
  reclabpad = 0,
  reclabrad = 0.15,
  reclabbord = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.mapsf_+3A_predabund">predabund</code></td>
<td>
<p>Predicted abundance data frame produced by gbm.auto (Abundance_Preds_only.csv),
with Latitude, Longitude, and Predicted Abundance columns. Default NULL. You need to read the csv
in R if not already present as an object in the environment.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_predabundlon">predabundlon</code></td>
<td>
<p>Longitude column number. Default 2.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_predabundlat">predabundlat</code></td>
<td>
<p>Latitude column number. Default 1.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_predabundpreds">predabundpreds</code></td>
<td>
<p>Predicted abundance column number, default 3.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_mylocation">myLocation</code></td>
<td>
<p>Location for extents, format c(xmin, ymin, xmax, ymax). Default NULL, extents
autocreated from data.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_trim">trim</code></td>
<td>
<p>Remove NA &amp; &lt;=0 values and crop to remaining date extents? Default TRUE.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_trimfivepct">trimfivepct</code></td>
<td>
<p>Replace anything &lt; 5% of the max value (i.e. &lt; 95% UD contour in home range
analysis) with NA since it won't be drawn (for movegroup dBBMMs). Default FALSE.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_scale100">scale100</code></td>
<td>
<p>Scale Predicted Abundance to 100? Default FALSE.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_gmapsapi">gmapsAPI</code></td>
<td>
<p>Enter your Google maps API here, quoted character string. Default NULL.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_mapsource">mapsource</code></td>
<td>
<p>Source for ggmap::get_map; uses Stamen as fallback if no Google Maps API present
. Options: &quot;google&quot;, &quot;stamen&quot;, &quot;gbm.basemap&quot;. Default &quot;google&quot;. Using &quot;gbm.basemap&quot; requires one
to have run that functiuon already, and enter its location using the shape paramater below.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_googlemap">googlemap</code></td>
<td>
<p>If pulling basemap from Google maps, this sets expansion factors since Google
Maps tiling zoom setup doesn't align to myLocation extents. Default TRUE.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_maptype">maptype</code></td>
<td>
<p>Type of map for ggmap::get_map param maptype. Options: Google mapsource: &quot;terrain&quot;,
&quot;terrain-background&quot;, &quot;satellite&quot;, &quot;roadmap&quot;, &quot;hybrid&quot;. Stamen mapsource: &quot;terrain&quot;,
&quot;terrain-background&quot;, &quot;terrain-labels&quot;, &quot;terrain-lines&quot;, &quot;watercolor&quot;, &quot;toner&quot;, &quot;toner-2010&quot;,
&quot;toner-2011&quot;, &quot;toner-background&quot;, &quot;toner-hybrid&quot;, &quot;toner-labels&quot;, &quot;toner-lines&quot;, &quot;toner-lite&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_darkenproportion">darkenproportion</code></td>
<td>
<p>Amount to darken the google/stamen basemap, 0-1. Default 0.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_mapzoom">mapzoom</code></td>
<td>
<p>Highest number = zoomed in. Google: 3 (continent) - 21 (building). stamen: 0-18.
Default 9.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_shape">shape</code></td>
<td>
<p>If mapsource is &quot;gbm.basemap&quot;, enter the full path to gbm.basemaps downloaded map,
typically Crop_Map.shp, including the .shp. Default NULL. Can also name an existing object in the
environment, read in with sf::st_read.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_expandfactor">expandfactor</code></td>
<td>
<p>Extents expansion factor for basemap. default 0.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_colourscale">colourscale</code></td>
<td>
<p>Scale fill colour scheme to use, default &quot;viridis&quot;, other option is
&quot;gradient&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_colorscale">colorscale</code></td>
<td>
<p>Scale fill colour scheme to use, default NULL, populating this will overwrite
colourscale.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_heatcolours">heatcolours</code></td>
<td>
<p>Vector of colours if gradient selected for colourscale, defaults to heatmap
theme.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_colournumber">colournumber</code></td>
<td>
<p>Number of colours to spread heatcolours over, if gradient selected for
colourscale. Default 8.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_colourscalelimits">colourscalelimits</code></td>
<td>
<p>Colour scale limits, default NULL, vector of 2, e.g. c(0, 0).</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_colourscalebreaks">colourscalebreaks</code></td>
<td>
<p>Colour scale breaks, default NULL.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_colourscalelabels">colourscalelabels</code></td>
<td>
<p>Colour scale labels, default NULL, must match number of breaks.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_colourscaleexpand">colourscaleexpand</code></td>
<td>
<p>Colour scale expand, default NULL, vector of 2, e.g. c(0, 0).</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_studyspecies">studyspecies</code></td>
<td>
<p>Name of your study species, appears in plot title and savename. Default
&quot;MySpecies&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_plottitle">plottitle</code></td>
<td>
<p>Title of the resultant plot, default paste0(&quot;Predicted abundance of &quot;,
studyspecies).</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_plotsubtitle">plotsubtitle</code></td>
<td>
<p>Plot subtitle, default &quot;&quot;CPUE&quot;. Can add the n of your individuals.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_legendtitle">legendtitle</code></td>
<td>
<p>Legend title, default &quot;CPUE&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_plotcaption">plotcaption</code></td>
<td>
<p>Plot caption, default &quot;gbm.auto::gbm.mapsf&quot; + today's date.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_axisxlabel">axisxlabel</code></td>
<td>
<p>Default &quot;Longitude&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_axisylabel">axisylabel</code></td>
<td>
<p>Default &quot;Latitude&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_legendposition">legendposition</code></td>
<td>
<p>Vector of 2, format c(1,2), Proportional distance of (middle?) of legend
box from L to R, percent distance from Bottom to Top. Values 0 to 1. Default c(0.05, 0.15).</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_fontsize">fontsize</code></td>
<td>
<p>Font size, default 12.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_fontfamily">fontfamily</code></td>
<td>
<p>= Font family, default &quot;Times New Roman&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_filesavename">filesavename</code></td>
<td>
<p>File savename, default today's date + studyspecies + legendtitle.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_savedir">savedir</code></td>
<td>
<p>Save outputs to a temporary directory (default) else change to current directory
e.g. &quot;/home/me/folder&quot;. Do not use getwd() here. No terminal slash. E.g.
paste0(movegroupsavedir, &quot;Plot/&quot;) .</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_receiverlats">receiverlats</code></td>
<td>
<p>Vector of latitudes for receivers to be plotted.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_receiverlons">receiverlons</code></td>
<td>
<p>Vector of longitudes for receivers to be plotted. Same length as receiverlats.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_receivernames">receivernames</code></td>
<td>
<p>Vector of names for receivers to be plotted. Same length as receiverlats.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_receiverrange">receiverrange</code></td>
<td>
<p>Single (will be recycled), or vector (same length as receiverlats) of
detection ranges in metres for receivers to be plotted. If you have a max and a (e.g.) 90 percent
detection range, probably use max.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_recpointscol">recpointscol</code></td>
<td>
<p>Colour of receiver centrepoint outlines. Default &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_recpointsfill">recpointsfill</code></td>
<td>
<p>Colour of receiver centrepoint fills. Default &quot;white&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_recpointsalpha">recpointsalpha</code></td>
<td>
<p>Alpha value of receiver centrepoint fills, 0 (invisible) to 1 (fully
visible). Default 0.5.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_recpointssize">recpointssize</code></td>
<td>
<p>Size of receiver points. Default 1.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_recpointsshape">recpointsshape</code></td>
<td>
<p>Shape of receiver points, default 21, circle with outline and fill.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_recbufcol">recbufcol</code></td>
<td>
<p>Colour of the receiver buffer circle outlines. Default &quot;grey75&quot;</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_recbuffill">recbuffill</code></td>
<td>
<p>Colour of the receiver buffer circle fills. Default &quot;grey&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_recbufalpha">recbufalpha</code></td>
<td>
<p>Alpha value of receiver buffer fills, 0 (invisible) to 1 (fully visible).
Default 0.5.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_reclabcol">reclabcol</code></td>
<td>
<p>Receiver label text colour. Default &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_reclabfill">reclabfill</code></td>
<td>
<p>Receiver label fill colour, NA for no fill. Default NA.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_reclabnudgex">reclabnudgex</code></td>
<td>
<p>Receiver label offset nudge in X dimension. Default 0.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_reclabnudgey">reclabnudgey</code></td>
<td>
<p>Receiver label offset nudge in Y dimension. Default -200.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_reclabpad">reclabpad</code></td>
<td>
<p>Receiver label padding in lines. Default 0.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_reclabrad">reclabrad</code></td>
<td>
<p>Receiver label radius in lines. Default 0.15.</p>
</td></tr>
<tr><td><code id="gbm.mapsf_+3A_reclabbord">reclabbord</code></td>
<td>
<p>Receiver label border in mm. Default 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Error in seq.default(xlim[1], xlim[2], by = byx):wrong sign in 'by' argument
Check that your lat &amp; long columns are the right way around. Ensure grids (predabund) data are
gridded, i.e. they are in a regular pattern of same/similar lines of lat/lon, even if they're
missing sections.
</p>
<p>Suggested parameter values:
z = rsbdf[,&quot;Unrepresentativeness&quot;]
</p>
<p>mapmain = &quot;Unrepresentativeness: &quot;
</p>
<p>legendtitle = &quot;UnRep 0-1&quot;
</p>


<h4>How to get Google map basemaps</h4>

<p>(from https://www.youtube.com/watch?v=O5cUoVpVUjU):
</p>

<ol>
<li><p> Sign up with dev console: a. You must enter credit card details, but won’t be charged if your
daily API requests stay under the limit. b. Follow the link:
https://console.cloud.google.com/projectselector2/apis/dashboard?supportedpurview=project c.
Sign up for Google cloud account (it may auto populate your current gmail), click agree and
continue. d. Click the navigation email in the top left corner and click on Billing. e. Create a
billing account – they will NOT auto charge after trial ends. f. Enter information, click on
'start my free trial'. They may offer a free credit for trying out their service. More pricing
details: https://mapsplatform.google.com/pricing/ . g. Click “Select a Project” then
“New project” in the top right corner. h. Enter Project Name, leave Location as is, click
“Create”. i. You should now see your project name at the top, where the drop-down menu is.
</p>
</li>
<li><p> Enable Maps and Places API: a. Click 'Library' on the left. b. In the search field type “Maps”
. c. Scroll down, click “Maps Java Script API”. d. Click Enable. e. Click 'Library' again, search
“Places”, click on “Places API”. f. Click Enable.
</p>
</li>
<li><p> Create Credentials for API  Key: a. Return to 'APIs &amp; Services' page. b. Click on Credentials.
c. At the top click 'Create Credentials &gt; API Key'. d. API key should pop up with option to copy
it. e. You can restrict the key if you want by following steps 4 &amp; 5 here:
https://www.youtube.com/watch?v=O5cUoVpVUjU&amp;t=232s
</p>
</li></ol>




<h3>Value</h3>

<p>Species abundance maps using data provided by gbm.auto, and
Representativeness Surface Builder maps using data provided by gbm.rsb, to be
run in a png/par/gbm.map/dev.off sequence.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Not run

</code></pre>

<hr>
<h2 id='gbm.rsb'>Representativeness Surface Builder</h2><span id='topic+gbm.rsb'></span>

<h3>Description</h3>

<p>Loops through explanatory variables comparing their histogram in 'samples' to
their histogram in 'grids' to see how well the explanatory variable range in
samples represents the range being predicted to in grids. Assigns a
representativeness score per variable per site in grids, and takes the
average score per site if there's more than 1 expvar. Saves this to a CSV;
it's plotted by gbm.map if called in gbm.auto. This shows you which areas
have the most and least representative coverage by samples, therefore where you
can have the most/least confidence in the predictions from gbm.predict.grids.
Can be called directly, and choosing a subset of expvars allows one to see
their individual / collective representativeness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.rsb(samples, grids, expvarnames, gridslat, gridslon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.rsb_+3A_samples">samples</code></td>
<td>
<p>Data frame with response and explanatory variables.</p>
</td></tr>
<tr><td><code id="gbm.rsb_+3A_grids">grids</code></td>
<td>
<p>Data frame of (more/different) explanatory variables and no
response variable, to be predicted to by gbm.predict.grids.</p>
</td></tr>
<tr><td><code id="gbm.rsb_+3A_expvarnames">expvarnames</code></td>
<td>
<p>Vector of column names of explanatory variables being
tested. Can be length 1. Names must match in samples and grids.</p>
</td></tr>
<tr><td><code id="gbm.rsb_+3A_gridslat">gridslat</code></td>
<td>
<p>Column number for latitude in 'grids'.</p>
</td></tr>
<tr><td><code id="gbm.rsb_+3A_gridslon">gridslon</code></td>
<td>
<p>Column number for longitude in 'grids'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Gridded data table of representativeness values which is then mapped
with gbm.map and also saved as a csv
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(samples)
data(grids)
rsbdf_bin &lt;- gbm.rsb(samples, grids, expvarnames = names(samples[c(4:8, 10)])
, gridslat = 2, gridslon = 1)

</code></pre>

<hr>
<h2 id='gbm.step.sd'>Function to assess optimal no of boosting trees using k-fold cross validation</h2><span id='topic+gbm.step.sd'></span>

<h3>Description</h3>

<p>SD fork of dismo's gbm.step to add evaluation metrics like d.squared and rmse. J. Leathwick and
J. Elith - 19th September 2005, version 2.9. Function to assess optimal no of boosting trees
using k-fold cross validation. Implements the cross-validation procedure described on page 215 of
Hastie T, Tibshirani R, Friedman JH (2001) The Elements of Statistical Learning: Data Mining,
Inference, and Prediction Springer-Verlag, New York.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.step.sd(
  data,
  gbm.x,
  gbm.y,
  offset = NULL,
  fold.vector = NULL,
  tree.complexity = 1,
  learning.rate = 0.01,
  bag.fraction = 0.75,
  site.weights = rep(1, nrow(data)),
  var.monotone = rep(0, length(gbm.x)),
  n.folds = 10,
  prev.stratify = TRUE,
  family = "bernoulli",
  n.trees = 50,
  step.size = n.trees,
  max.trees = 10000,
  tolerance.method = "auto",
  tolerance = 0.001,
  plot.main = TRUE,
  plot.folds = FALSE,
  verbose = TRUE,
  silent = FALSE,
  keep.fold.models = FALSE,
  keep.fold.vector = FALSE,
  keep.fold.fit = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.step.sd_+3A_data">data</code></td>
<td>
<p>The input dataframe.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_gbm.x">gbm.x</code></td>
<td>
<p>The predictors.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_gbm.y">gbm.y</code></td>
<td>
<p>The response.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_offset">offset</code></td>
<td>
<p>Allows an offset to be specified.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_fold.vector">fold.vector</code></td>
<td>
<p>Allows a fold vector to be read in for CV with offsets,.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_tree.complexity">tree.complexity</code></td>
<td>
<p>Sets the complexity of individual trees.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_learning.rate">learning.rate</code></td>
<td>
<p>Sets the weight applied to inidivudal trees.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_bag.fraction">bag.fraction</code></td>
<td>
<p>Sets the proportion of observations used in selecting variables.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_site.weights">site.weights</code></td>
<td>
<p>Allows varying weighting for sites.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_var.monotone">var.monotone</code></td>
<td>
<p>Restricts responses to individual predictors to monotone.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_n.folds">n.folds</code></td>
<td>
<p>Number of folds.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_prev.stratify">prev.stratify</code></td>
<td>
<p>Prevalence stratify the folds - only for p/a data.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_family">family</code></td>
<td>
<p>Family - bernoulli (=binomial), poisson, laplace or gaussian.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_n.trees">n.trees</code></td>
<td>
<p>Number of initial trees to fit.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_step.size">step.size</code></td>
<td>
<p>Numbers of trees to add at each cycle.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_max.trees">max.trees</code></td>
<td>
<p>Max number of trees to fit before stopping.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_tolerance.method">tolerance.method</code></td>
<td>
<p>Method to use in deciding to stop - &quot;fixed&quot; or &quot;auto&quot;.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_tolerance">tolerance</code></td>
<td>
<p>Tolerance value to use - if method == fixed is absolute, if auto is multiplier * total mean deviance.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_plot.main">plot.main</code></td>
<td>
<p>Plot hold-out deviance curve.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_plot.folds">plot.folds</code></td>
<td>
<p>Plot the individual folds as well.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_verbose">verbose</code></td>
<td>
<p>Control amount of screen reporting.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_silent">silent</code></td>
<td>
<p>To allow running with no output for simplifying model).</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_keep.fold.models">keep.fold.models</code></td>
<td>
<p>Keep the fold models from cross valiation.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_keep.fold.vector">keep.fold.vector</code></td>
<td>
<p>Allows the vector defining fold membership to be kept.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_keep.fold.fit">keep.fold.fit</code></td>
<td>
<p>Allows the predicted values for observations from CV to be kept.</p>
</td></tr>
<tr><td><code id="gbm.step.sd_+3A_...">...</code></td>
<td>
<p>Allows for any additional plotting parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Divides the data into 10 subsets, with stratification by prevalence if required for pa data then
fits a gbm model of increasing complexity along the sequence from n.trees to n.trees + (n.steps *
step.size) calculating the residual deviance at each step along the way after each fold
processed, calculates the average holdout residual deviance and its standard error then
identifies the optimal number of trees as that at which the holdout deviance is minimised and
fits a model with this number of trees, returning it as a gbm model along with additional
information from the cv selection process.
</p>
<p>D squared is 1 - (cv.dev / total.deviance). Abeare thesis: For each of the
fitted models, the pseudo-R2, or D2, or Explained Deviance, was calculated
for comparison, where: D2 = 1 – (residual deviance/total deviance).
</p>
<p>requires gbm library from Cran
requires roc and calibration scripts of J Elith
requires calc.deviance script of J Elith/J Leathwick
</p>


<h3>Value</h3>

<p>GBM models using gbm as the engine.
</p>

<hr>
<h2 id='gbm.subset'>Subset gbm.auto input datasets to 2 groups using the partial deviance plots</h2><span id='topic+gbm.subset'></span>

<h3>Description</h3>

<p>Set your working directory to the output folder of a gbm.auto/gbm.loop run.
This function returns the variable value corresponding to the 0 value on the
lineplots, which should be the optimal place to split the dataset into 2
subsets, low and high, IF the relationship doesn't cross 0 more than once.
Function is similarly useful to quickly get the 0-point value in these cases,
i.e. where values below are detrimental, values above beneficial (check
plots though)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.subset(x, fams = c("Bin", "Gaus"), loop = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.subset_+3A_x">x</code></td>
<td>
<p>Vector of variable names.</p>
</td></tr>
<tr><td><code id="gbm.subset_+3A_fams">fams</code></td>
<td>
<p>Vector of statistical data distribution family names to be modelled by gbm.</p>
</td></tr>
<tr><td><code id="gbm.subset_+3A_loop">loop</code></td>
<td>
<p>Is the folder a gbm.loop output?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>loop varnames are BinLineLoop_VAR.csv &amp; GausLineLoop_VAR.csv
normal varnames are Bin_Best_line_VAR.csv &amp; Gaus_Best_line_VAR.csv
</p>
<p>Just use average between the last negative &amp; first positive point
unless any points fall on zero
</p>


<h3>Value</h3>

<p>a list of breakpoint values which datasets can be subsetted using.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Not run: requires completed gbm.auto run.
# having run gbm.auto (with linesfiles=TRUE), set working directory there
data(samples)
gbm.subset(x = names(samples[c(4:8, 10)]), fams = c("Bin", "Gaus"))


</code></pre>

<hr>
<h2 id='gbm.valuemap'>Decision Support Tool that generates (Marine) Protected Area options using
species predicted abundance maps</h2><span id='topic+gbm.valuemap'></span>

<h3>Description</h3>

<p>Scales response variable data, maps a user-defined explanatory variable to be
avoided, e.g. fishing effort, combines them into a map showing areas to
preferentially close. Bpa, the precautionary biomass required to protect the
spawning stock, is used to calculate MPA size. MPA is then grown to add
subsequent species starting from the most conservationally at-risk species,
resulting in one MPA map per species, and a multicolour MPA map of all.
All maps list the percentage of the avoid-variables total that is overlapped
by the MPA in the map legend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbm.valuemap(
  dbase,
  loncolno = 1,
  latcolno = 2,
  goodcols,
  badcols,
  conservecol = NULL,
  plotthis = c("good", "bad", "both", "close"),
  maploops = c("Combo", "Biomass", "Effort", "Conservation"),
  savedir = tempdir(),
  savethis = TRUE,
  HRMSY = 0.15,
  goodweight = NULL,
  badweight = NULL,
  m = 1,
  alerts = TRUE,
  BnW = TRUE,
  shape = NULL,
  pngtype = c("cairo-png", "quartz", "Xlib"),
  byxport = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbm.valuemap_+3A_dbase">dbase</code></td>
<td>
<p>Data.frame to load. Expects Lon, Lat &amp; data columns: predicted
abundances, fishing effort etc. E.g.: Abundance_Preds_All.csv from gbm.auto.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_loncolno">loncolno</code></td>
<td>
<p>Column number in dbase which has longitudes.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_latcolno">latcolno</code></td>
<td>
<p>Column number in dbase which has latitudes.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_goodcols">goodcols</code></td>
<td>
<p>Which column numbers are abundances (where higher = better)?
List them in order of highest conservation importance first e.g. c(3,1,2,4).
Either numeric column number or quoted character column name.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_badcols">badcols</code></td>
<td>
<p>Which col no.s are 'negative' e.g. fishing (where higher =
worse)? Either numeric column number or quoted character column name.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_conservecol">conservecol</code></td>
<td>
<p>Conservation column, from gbm.cons.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_plotthis">plotthis</code></td>
<td>
<p>Vector of variable types to plot. Delete any,or all w/ NULL.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_maploops">maploops</code></td>
<td>
<p>Vector of sort loops to run. See Dedman et al 2017 &quot;Towards a
flexible Decision Support Tool for MSY-based Marine Protected Area design
for skates and rays&quot;;
https://academic.oup.com/icesjms/article/74/2/576/2669563 . All 4 options
create a total MPA which conserves Bpa, but in different ways: Biomass
closes areas of high biomass first. Effort closes areas of high fisheries
area last. Combo strikes a balance between the two, and you can change the
default 1:1 balance with goodweight and badweight parameters. Conservation
uses the output of gbm.cons to prioritise closure of areas of high
conservation value, which may not be identical to areas of highest biomass.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_savedir">savedir</code></td>
<td>
<p>Save outputs to a temporary directory (default) else change to
current directory e.g. &quot;/home/me/folder&quot;. Do not use getwd() here.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_savethis">savethis</code></td>
<td>
<p>Export all data as csv?</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_hrmsy">HRMSY</code></td>
<td>
<p>Maximum percent of each goodcols stock which can be removed
yearly, as decimal (0.15 = 15 pct). Must protect remainder: 1-HRMSY. Single
number or vector. If vector, same order as goodcols. Required.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_goodweight">goodweight</code></td>
<td>
<p>Single/vector weighting multiple(s) for goodcols array.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_badweight">badweight</code></td>
<td>
<p>Ditto for badcols array.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_m">m</code></td>
<td>
<p>Multiplication factor for Bpa units. 1000 to convert tonnes to
kilos, 0.001 kilos to tonnes. Assumedly the same for all goodcols.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_alerts">alerts</code></td>
<td>
<p>Play sounds to mark progress steps.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_bnw">BnW</code></td>
<td>
<p>Also produce greyscale images for print publications.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_shape">shape</code></td>
<td>
<p>Set coastline shapefile, else uses British Isles. Generate your
own with gbm.basemap.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_pngtype">pngtype</code></td>
<td>
<p>File-type for png files, alternatively try &quot;quartz&quot; on Mac.
Choose one.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_byxport">byxport</code></td>
<td>
<p>Dummy param for package testing for CRAN, ignore.</p>
</td></tr>
<tr><td><code id="gbm.valuemap_+3A_...">...</code></td>
<td>
<p>Optional terms for gbm.map.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bpa is the volume of biomass under the 2D abundance surface e.g. predabund
from gbm.auto. B (biomass), * HRMSY (Fmsy proportion) = Bpa. You may be able
to get Fmsy from stock asssessments etc.
maploops: explain concept of biomass vs effort, combo in the middle (default
weighting 1:1 can change with good/badweight), and Conservation from gbm.cons.
</p>


<h3>Value</h3>

<p>Species abundance, abundance vs avoid variable, and MPA maps per
species and sort type, in b&amp;w if set. CSVs of all maps if set.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>

<hr>
<h2 id='grids'>Data: Explanatory variables for rays in the Irish Sea</h2><span id='topic+grids'></span>

<h3>Description</h3>

<p>A dataset containing explanatory variables for environment, fishery and
predators of rays including juveniles in the Irish Sea.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(grids)
</code></pre>


<h3>Format</h3>

<p>A data frame with 378570 rows and 43 variables:
</p>

<dl>
<dt>Longitude</dt><dd><p>Decimal longitudes in the Irish Sea</p>
</dd>
<dt>Latitude</dt><dd><p>Decimal latitudes in the Irish Sea</p>
</dd>
<dt>Depth</dt><dd><p>Metres, decimal</p>
</dd>
<dt>Temperature</dt><dd><p>Degrees, decimal</p>
</dd>
<dt>Salinity</dt><dd><p>PPM</p>
</dd>
<dt>Current_Speed</dt><dd><p>Metres per second at the seabed</p>
</dd>
<dt>Distance_to_Shore</dt><dd><p>Metres, decimal</p>
</dd>
<dt>F_LPUE</dt><dd><p>Commercial fishery LPUE in Kg/Hr</p>
</dd>
<dt>Scallop</dt><dd><p>Average KwH Scallop effort from logbooks, Marine Institute and MMO combined</p>
</dd>
<dt>MI_Av_E_Hr</dt><dd><p>Average effort hours, Marine Institute Scallop VMS, 0.03 x 0.02 rectangles, all Irish Sea, 2006-14</p>
</dd>
<dt>MI_Av_LPUE</dt><dd><p>Average scallop CPUE, Marine Institute Scallop VMS, 0.03 x 0.02 rectangles, all Irish Sea, 2006-14</p>
</dd>
<dt>MI_Sum_Liv</dt><dd><p>Sum of live weight. Average scallop CPUE, Marine Institute Scallop VMS, 0.03 x 0.02 rectangles, all Irish Sea, 2006-14</p>
</dd>
<dt>Whelk</dt><dd><p>MMO Whelk LPUE 2009-12, pivot, polygons to points</p>
</dd>
<dt>MmoAvScKwh</dt><dd><p>MMO Scallop Effort 2009-12, pivot, polygons to points. ICES rectangles</p>
</dd>
<dt>HubDist</dt><dd><p>map calc, distance of grid point to nearest datras point representing it (for preds)</p>
</dd>
<dt>Cod_C</dt><dd><p>ICES IBTS CPUE of cod caught between 1994 - 2014 large enough to predate upon &lt;= year 1 cuckoo rays</p>
</dd>
<dt>Cod_T</dt><dd><p>As Cod_C for yr1 thornback rays</p>
</dd>
<dt>Cod_B</dt><dd><p>As Cod_C for yr1 blonde rays</p>
</dd>
<dt>Cod_S</dt><dd><p>As Cod_C for yr1 spotted rays</p>
</dd>
<dt>Haddock_C</dt><dd><p>As Cod_C, haddock predating upon cuckoo rays</p>
</dd>
<dt>Haddock_T</dt><dd><p>As Cod_C, haddock predating upon thornback rays</p>
</dd>
<dt>Haddock_B</dt><dd><p>As Cod_C, haddock predating upon blonde rays</p>
</dd>
<dt>Haddock_S</dt><dd><p>As Cod_C, haddock predating upon spotted rays</p>
</dd>
<dt>Plaice_C</dt><dd><p>As Cod_C, plaice predating upon cuckoo rays</p>
</dd>
<dt>Plaice_T</dt><dd><p>As Cod_C, plaice predating upon thornback rays</p>
</dd>
<dt>Plaice_B</dt><dd><p>As Cod_C, plaice predating upon blonde rays</p>
</dd>
<dt>Plaice_S</dt><dd><p>As Cod_C, plaice predating upon spotted rays</p>
</dd>
<dt>Whiting_C</dt><dd><p>As Cod_C, whiting predating upon cuckoo rays</p>
</dd>
<dt>Whiting_T</dt><dd><p>As Cod_C, whiting predating upon thornback rays</p>
</dd>
<dt>Whiting_B</dt><dd><p>As Cod_C, whiting predating upon blonde rays</p>
</dd>
<dt>Whiting_S</dt><dd><p>As Cod_C, whiting predating upon spotted rays</p>
</dd>
<dt>ComSkt_C</dt><dd><p>As Cod_C, common skate predating upon cuckoo rays</p>
</dd>
<dt>ComSkt_T</dt><dd><p>As Cod_C, common skate predating upon thornback rays</p>
</dd>
<dt>ComSkt_B</dt><dd><p>As Cod_C, common skate predating upon blonde rays</p>
</dd>
<dt>ComSkt_S</dt><dd><p>As Cod_C, common skate predating upon spotted rays</p>
</dd>
<dt>Blonde_C</dt><dd><p>As Cod_C, blonde ray predating upon cuckoo rays</p>
</dd>
<dt>Blonde_T</dt><dd><p>As Cod_C, blonde ray predating upon thornback rays</p>
</dd>
<dt>Blonde_S</dt><dd><p>As Cod_C, blonde ray predating upon spotted rays</p>
</dd>
<dt>C_Preds</dt><dd><p>All predator CPUEs combined for cuckoo rays</p>
</dd>
<dt>T_Preds</dt><dd><p>All predator CPUEs combined for thornback rays</p>
</dd>
<dt>B_Preds</dt><dd><p>All predator CPUEs combined for blonde rays</p>
</dd>
<dt>S_Preds</dt><dd><p>All predator CPUEs combined for spotted rays</p>
</dd>
<dt>Effort</dt><dd><p>Irish commercial beam trawler effort 2012</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Source</h3>

<p><a href="http://oar.marine.ie/handle/10793/958">http://oar.marine.ie/handle/10793/958</a>
</p>

<hr>
<h2 id='Juveniles'>Data: Explanatory and response variables for 4 juvenile rays in the Irish Sea</h2><span id='topic+Juveniles'></span>

<h3>Description</h3>

<p>A dataset containing explanatory variables for environment, fishery and
predators of juvenile rays in the Irish Sea, and the response variables,
abundance CPUEs of cuckoo, thornback, blonde and spotted rays.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Juveniles)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2136 rows and 46 variables:
</p>

<dl>
<dt>Survey_StNo_HaulNo_Year</dt><dd><p>Index column of combined Survey number, station number, haul number, and year</p>
</dd>
<dt>Latitude</dt><dd><p>Decimal latitudes in the Irish Sea</p>
</dd>
<dt>Longitude</dt><dd><p>Decimal longitudes in the Irish Sea</p>
</dd>
<dt>Depth</dt><dd><p>Metres, decimal</p>
</dd>
<dt>Temperature</dt><dd><p>Degrees, decimal</p>
</dd>
<dt>Salinity</dt><dd><p>PPM</p>
</dd>
<dt>Current_Speed</dt><dd><p>Metres per second at the seabed</p>
</dd>
<dt>Distance_to_Shore</dt><dd><p>Metres, decimal</p>
</dd>
<dt>F_LPUE</dt><dd><p>Commercial fishery LPUE in Kg/Hr</p>
</dd>
<dt>Scallop</dt><dd><p>Average KwH Scallop effort from logbooks, Marine Institute and MMO combined</p>
</dd>
<dt>MI_Av_E_Hr</dt><dd><p>Average effort hours, Marine Institute Scallop VMS, 0.03 x 0.02 rectangles, all Irish Sea, 2006-14</p>
</dd>
<dt>MI_Av_LPUE</dt><dd><p>Average scallop CPUE, Marine Institute Scallop VMS, 0.03 x 0.02 rectangles, all Irish Sea, 2006-14</p>
</dd>
<dt>MI_Sum_Liv</dt><dd><p>Sum of live weight. Average scallop CPUE, Marine Institute Scallop VMS, 0.03 x 0.02 rectangles, all Irish Sea, 2006-14</p>
</dd>
<dt>Whelk</dt><dd><p>MMO Whelk LPUE 2009-12, pivot, polygons to points</p>
</dd>
<dt>MmoAvScKwh</dt><dd><p>MMO Scallop Effort 2009-12, pivot, polygons to points. ICES rectangles</p>
</dd>
<dt>Cod_C</dt><dd><p>ICES IBTS CPUE of cod caught between 1994 - 2014 large enough to predate upon &lt;= year 1 cuckoo rays</p>
</dd>
<dt>Cod_T</dt><dd><p>As Cod_C for yr1 thornback rays</p>
</dd>
<dt>Cod_B</dt><dd><p>As Cod_C for yr1 blonde rays</p>
</dd>
<dt>Cod_S</dt><dd><p>As Cod_C for yr1 spotted rays</p>
</dd>
<dt>Haddock_C</dt><dd><p>As Cod_C, haddock predating upon cuckoo rays</p>
</dd>
<dt>Haddock_T</dt><dd><p>As Cod_C, haddock predating upon thornback rays</p>
</dd>
<dt>Haddock_B</dt><dd><p>As Cod_C, haddock predating upon blonde rays</p>
</dd>
<dt>Haddock_S</dt><dd><p>As Cod_C, haddock predating upon spotted rays</p>
</dd>
<dt>Plaice_C</dt><dd><p>As Cod_C, plaice predating upon cuckoo rays</p>
</dd>
<dt>Plaice_T</dt><dd><p>As Cod_C, plaice predating upon thornback rays</p>
</dd>
<dt>Plaice_B</dt><dd><p>As Cod_C, plaice predating upon blonde rays</p>
</dd>
<dt>Plaice_S</dt><dd><p>As Cod_C, plaice predating upon spotted rays</p>
</dd>
<dt>Whiting_C</dt><dd><p>As Cod_C, whiting predating upon cuckoo rays</p>
</dd>
<dt>Whiting_T</dt><dd><p>As Cod_C, whiting predating upon thornback rays</p>
</dd>
<dt>Whiting_B</dt><dd><p>As Cod_C, whiting predating upon blonde rays</p>
</dd>
<dt>Whiting_S</dt><dd><p>As Cod_C, whiting predating upon spotted rays</p>
</dd>
<dt>ComSkt_C</dt><dd><p>As Cod_C, common skate predating upon cuckoo rays</p>
</dd>
<dt>ComSkt_T</dt><dd><p>As Cod_C, common skate predating upon thornback rays</p>
</dd>
<dt>ComSkt_B</dt><dd><p>As Cod_C, common skate predating upon blonde rays</p>
</dd>
<dt>ComSkt_S</dt><dd><p>As Cod_C, common skate predating upon spotted rays</p>
</dd>
<dt>Blonde_C</dt><dd><p>As Cod_C, blonde ray predating upon cuckoo rays</p>
</dd>
<dt>Blonde_T</dt><dd><p>As Cod_C, blonde ray predating upon thornback rays</p>
</dd>
<dt>Blonde_S</dt><dd><p>As Cod_C, blonde ray predating upon spotted rays</p>
</dd>
<dt>C_Preds</dt><dd><p>All predator CPUEs combined for cuckoo rays</p>
</dd>
<dt>T_Preds</dt><dd><p>All predator CPUEs combined for thornback rays</p>
</dd>
<dt>B_Preds</dt><dd><p>All predator CPUEs combined for blonde rays</p>
</dd>
<dt>S_Preds</dt><dd><p>All predator CPUEs combined for spotted rays</p>
</dd>
<dt>Cuckoo</dt><dd><p>Numbers of juvenile cuckoo rays caught, standardised to 1 hour</p>
</dd>
<dt>Thornback</dt><dd><p>Numbers of juvenile thornback rays caught, standardised to 1 hour</p>
</dd>
<dt>Blonde</dt><dd><p>Numbers of juvenile blonde rays caught, standardised to 1 hour</p>
</dd>
<dt>Spotted</dt><dd><p>Numbers of juvenile spotted rays caught, standardised to 1 hour</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>

<hr>
<h2 id='lmplot'>Plot linear model for two variables with R2 &amp; P printed and saved</h2><span id='topic+lmplot'></span>

<h3>Description</h3>

<p>Simple function to plot and name a linear model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmplot(
  x,
  y,
  xname = "X variable",
  yname = "Y variable",
  pngtype = c("cairo-png", "quartz", "Xlib"),
  xlab = xname,
  ylab = yname,
  plotname = xname,
  r2line = TRUE,
  pointtext = FALSE,
  pointlabs = x,
  pointcol = "black",
  savedir = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmplot_+3A_x">x</code></td>
<td>
<p>Explanatory variable data.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_y">y</code></td>
<td>
<p>Response variable data.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_xname">xname</code></td>
<td>
<p>Variable name for plot header.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_yname">yname</code></td>
<td>
<p>Variable name for plot header.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_pngtype">pngtype</code></td>
<td>
<p>Filetype for png files, alternatively try &quot;quartz&quot; on Mac.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_xlab">xlab</code></td>
<td>
<p>X axis label, parsed from xname unless specified.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_ylab">ylab</code></td>
<td>
<p>Y axis label, parsed from yname unless specified.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_plotname">plotname</code></td>
<td>
<p>Filename for png, parsed from xname unless specified.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_r2line">r2line</code></td>
<td>
<p>Plot rsquared trendline, default TRUE.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_pointtext">pointtext</code></td>
<td>
<p>Label each point? Default FALSE.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_pointlabs">pointlabs</code></td>
<td>
<p>Point labels, defaults to resvar value.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_pointcol">pointcol</code></td>
<td>
<p>Points colour, default &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_savedir">savedir</code></td>
<td>
<p>Save location, end with &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="lmplot_+3A_...">...</code></td>
<td>
<p>Allows controlling of text label params e.g. adj cex &amp;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Errors and their origins:
</p>


<h3>Value</h3>

<p>Invisibly saves png plot into savedir.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>

<hr>
<h2 id='roc'>roc</h2><span id='topic+roc'></span>

<h3>Description</h3>

<p>Internal use only. Adapted from Ferrier, Pearce and Watson's code, by J.Elith
, see: Hanley, J.A. &amp; McNeil, B.J. (1982) The meaning and use of the area
under a Receiver Operating Characteristic (ROC) curve. Radiology, 143, 29-36.
Also Pearce, J. &amp; Ferrier, S. (2000) Evaluating the predictive performance of
habitat models developed using logistic regression. Ecological Modelling,
133, 225-245. This is the non-parametric calculation for area under the ROC
curve, using the fact that a MannWhitney U statistic is closely related to
the area. In dismo, this is used in the gbm routines, but not elsewhere (see
evaluate).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roc(obsdat, preddat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="roc_+3A_obsdat">obsdat</code></td>
<td>
<p>Observed data.</p>
</td></tr>
<tr><td><code id="roc_+3A_preddat">preddat</code></td>
<td>
<p>Predicted data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>roc &amp; calibration stats internally within gbm runs e.g. in gbm.auto.
</p>


<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>roc(obsdat = rbinom(100,size = 1, prob = 0.5), preddat = runif(100))

</code></pre>

<hr>
<h2 id='samples'>Data: Numbers of 4 ray species caught in 2137 Irish Sea trawls, 1994 to 2014</h2><span id='topic+samples'></span>

<h3>Description</h3>

<p>2244 capture events of cuckoo, thornback, spotted and blonde rays in the Irish
Sea from 1994 to 2014 by the ICES IBTS, including explanatory variables:
Length Per Unit Effort in that area by the commercial fishery, fishing effort
by same, depth, temperature, distance to shore, and current speed at the
bottom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(samples)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2244 rows and 14 variables:
</p>

<dl>
<dt>Survey_StNo_HaulNo_Year</dt><dd><p>Index column of combined Survey number, station number, haul number, and year</p>
</dd>
<dt>Latitude</dt><dd><p>Decimal latitudes in the Irish Sea</p>
</dd>
<dt>Longitude</dt><dd><p>Decimal longitudes in the Irish Sea</p>
</dd>
<dt>Depth</dt><dd><p> Metres, decimal</p>
</dd>
<dt>Temperature</dt><dd><p>Degrees, decimal</p>
</dd>
<dt>Salinity</dt><dd><p>PPM</p>
</dd>
<dt>Current_Speed</dt><dd><p>Metres per second at the seabed</p>
</dd>
<dt>Distance_to_Shore</dt><dd><p>Metres, decimal</p>
</dd>
<dt>F_LPUE</dt><dd><p>Commercial fishery LPUE in Kg/Hr</p>
</dd>
<dt>Effort</dt><dd><p>Irish commercial beam trawler effort 2012</p>
</dd>
<dt>Cuckoo</dt><dd><p>Numbers of juvenile cuckoo rays caught, standardised to 1 hour</p>
</dd>
<dt>Thornback</dt><dd><p>Numbers of juvenile thornback rays caught, standardised to 1 hour</p>
</dd>
<dt>Blonde</dt><dd><p>Numbers of juvenile blonde rays caught, standardised to 1 hour</p>
</dd>
<dt>Spotted</dt><dd><p>Numbers of juvenile spotted rays caught, standardised to 1 hour</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simon Dedman, <a href="mailto:simondedman@gmail.com">simondedman@gmail.com</a>
</p>


<h3>Source</h3>

<p><a href="http://oar.marine.ie/handle/10793/958">http://oar.marine.ie/handle/10793/958</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
