<!DOCTYPE html><html><head><title>Help for package ToolsForCoDa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ToolsForCoDa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Artificial'><p>Two sets of 3-part compositions</p></a></li>
<li><a href='#bentonites'><p>Isotopic and chemical compositions of bentonites</p></a></li>
<li><a href='#canocov'>
<p>Canonical correlation analysis.</p></a></li>
<li><a href='#cen'><p>centring of a data matrix</p></a></li>
<li><a href='#clrmat'>
<p>Centred log-ratio transformation</p></a></li>
<li><a href='#largest.kappas'>
<p>Calculate condition indices for subcompositions</p></a></li>
<li><a href='#lrpca'>
<p>Logratio principal component analysis with condition indices</p></a></li>
<li><a href='#tr'><p>Compute the trace of a matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Tools for Compositional Data Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-09-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Jan Graffelman &lt;jan.graffelman@upc.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Graffelman &lt;jan.graffelman@upc.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.8.0), MASS, calibrate, HardyWeinberg</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for multivariate analysis with compositional data. Includes a function for doing compositional canonical correlation analysis.  This analysis requires two data matrices of compositions, which can be adequately transformed and used as entries in a specialized program for canonical correlation analysis, that is able to deal with singular covariance matrices. The methodology is described in Graffelman et al. (2017) &lt;<a href="https://doi.org/10.1101%2F144584">doi:10.1101/144584</a>&gt;. A function for log-ratio principal component analysis with condition number computations has been added to the package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td>www.R-project.org, <a href="http://www-eio.upc.edu/~jan/">http://www-eio.upc.edu/~jan/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-19 18:20:26 UTC; jangr</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-20 14:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Artificial'>Two sets of 3-part compositions</h2><span id='topic+Artificial'></span>

<h3>Description</h3>

<p>The list object <code>Artificial</code> contains two data frames of 3-part
compositions. The data refer to the example in Section 3.1 of
Graffelman et al. (2017) 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Artificial)</code></pre>


<h3>Format</h3>

<p>A list containing two data frames containing 100 observations.</p>


<h3>Source</h3>

<p>Laird, N. M. and Lange, C. Table 7.11, p. 124</p>


<h3>References</h3>

<p>Graffelman, J., Pawlowsky-Glahn, V., Egozcue, J.J. and
Buccianti, A. (2017) Compositional Canonical Correlation Analysis. 
</p>

<hr>
<h2 id='bentonites'>Isotopic and chemical compositions of bentonites</h2><span id='topic+bentonites'></span>

<h3>Description</h3>

<p>The data consists of 14 geological samples from the US with their major oxide
composition (SiO2, Al2O3, Fe2O3, MnO, MgO, CaO, K2O, Na2O and H2O+) and
delta Deuterium and delta-18-Oxysgen (dD,d18O). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bentonites")</code></pre>


<h3>Format</h3>

<p>A data frame with 14 observations on the following 11 variables.
</p>

<dl>
<dt><code>Si</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Al</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Fe</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Mn</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Mg</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Ca</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>K</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Na</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>H20</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dD</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>d18O</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Cadrin, A.A.J (1995), Tables 1 and 2.
Reyment, R. A. and Savazzi, E. (1999), pp. 220-222.
</p>


<h3>References</h3>

<p>Cadrin, A.A.J., Kyser, T.K., Caldwell, W.G.E. and Longstaffe,
F.J. (1995) Isotopic and chemical compositions of bentonites as
paleoenvironmental indicators of the Cretaceous Western Interior Seaway
Palaeogeography, Palaeoclimatology, Palaeoecology 119 pp. 301&ndash;320.
</p>
<p>Reyment, R. A. and Savazzi, E. (1999) Aspects of Multivariate Statistical Analysis in Geology, Elsevier
Science B.V., Amsterdam. https://doi.org/10.1016/B978-044482568-1/50012-4
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bentonites)
</code></pre>

<hr>
<h2 id='canocov'>
Canonical correlation analysis.
</h2><span id='topic+canocov'></span>

<h3>Description</h3>

<p>Function <code>canocov</code> performs a canonical correlation analysis. It
operates on raw data matrices, which are only centered in the
program. It uses generalized inverses and can deal with structurally
singular covariance matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>canocov(X, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="canocov_+3A_x">X</code></td>
<td>
<p>The n times p X matrix of observations</p>
</td></tr>
<tr><td><code id="canocov_+3A_y">Y</code></td>
<td>
<p>The n times q Y matrix of observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>canocov</code> computes the solution by a singular value 
decomposition of the transformed between set covariance matrix.
</p>


<h3>Value</h3>

<p>Returns a list with the following results
</p>
<table>
<tr><td><code>ccor</code></td>
<td>
<p> the canonical correlations </p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p> canonical weights of the X variables </p>
</td></tr> 
<tr><td><code>B</code></td>
<td>
<p> canonical weights of the Y variables </p>
</td></tr> 
<tr><td><code>U</code></td>
<td>
<p> canonical X variates </p>
</td></tr> 
<tr><td><code>V</code></td>
<td>
<p> canonical Y variates </p>
</td></tr> 
<tr><td><code>Fs</code></td>
<td>
<p> biplot markers for X variables (standard coordinates) </p>
</td></tr>
<tr><td><code>Gs</code></td>
<td>
<p> biplot markers for Y variables (standard coordinates) </p>
</td></tr>
<tr><td><code>Fp</code></td>
<td>
<p> biplot markers for X variables (principal coordinates) </p>
</td></tr>
<tr><td><code>Gp</code></td>
<td>
<p> biplot markers for Y variables (principal coordinates) </p>
</td></tr>
<tr><td><code>Rxu</code></td>
<td>
<p> canonical loadings, (correlations X variables, canonical X variates)</p>
</td></tr>
<tr><td><code>Rxv</code></td>
<td>
<p> canonical loadings, (correlations X variables, canonical Y variates)</p>
</td></tr>
<tr><td><code>Ryu</code></td>
<td>
<p> canonical loadings, (correlations Y variables, canonical X variates)</p>
</td></tr>
<tr><td><code>Ryv</code></td>
<td>
<p> canonical loadings, (correlations Y variables, canonical Y variates)</p>
</td></tr>
<tr><td><code>Sxu</code></td>
<td>
<p> covariance X variables, canonical X variates</p>
</td></tr>
<tr><td><code>Sxv</code></td>
<td>
<p> covariance X variables, canonical Y variates</p>
</td></tr>
<tr><td><code>Syu</code></td>
<td>
<p> covariance Y variables, canonical X variates</p>
</td></tr>
<tr><td><code>Syv</code></td>
<td>
<p> covariance Y variables, canonical Y variates</p>
</td></tr>
<tr><td><code>fitRxy</code></td>
<td>
<p> goodness of fit of the between-set correlation matrix </p>
</td></tr>
<tr><td><code>fitXs</code></td>
<td>
<p> adequacy coefficients of X variables </p>
</td></tr> 
<tr><td><code>fitXp</code></td>
<td>
<p> redundancy coefficients of X variables </p>
</td></tr> 
<tr><td><code>fitYs</code></td>
<td>
<p> adequacy coefficients of Y variables </p>
</td></tr> 
<tr><td><code>fitYp</code></td>
<td>
<p> redundancy coefficients of Y variables</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman <a href="mailto:jan.graffelman@upc.edu">jan.graffelman@upc.edu</a> </p>


<h3>References</h3>

 
<p>Hotelling, H. (1935) The most predictable criterion. Journal of Educational 
Psychology (26) pp. 139-142.
</p>
<p>Hotelling, H. (1936) Relations between two sets of variates. Biometrika
(28) pp. 321-377.
</p>
<p>Johnson, R. A. and Wichern, D. W. (2002) Applied Multivariate Statistical Analysis.
New Jersey: Prentice Hall.   
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cancor">cancor</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
X &lt;- matrix(runif(75),ncol=3)
Y &lt;- matrix(runif(75),ncol=3)
cca.results &lt;- canocov(X,Y)
</code></pre>

<hr>
<h2 id='cen'>centring of a data matrix</h2><span id='topic+cen'></span>

<h3>Description</h3>

<p>centres the columns of a matrix to mean zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cen(X,w=rep(1,nrow(X))/nrow(X))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cen_+3A_x">X</code></td>
<td>
<p>a raw data matrix.</p>
</td></tr>
<tr><td><code id="cen_+3A_w">w</code></td>
<td>
<p>a vector of case weights.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a matrix</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>Examples</h3>

<pre><code class='language-R'>X&lt;-matrix(runif(10),ncol=2)
Y&lt;-cen(X)
print(Y)
</code></pre>

<hr>
<h2 id='clrmat'>
Centred log-ratio transformation
</h2><span id='topic+clrmat'></span>

<h3>Description</h3>

<p>Program <code>clrmat</code> calculates the centred log-ratio transformation
for a matrix of compositions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clrmat(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clrmat_+3A_x">X</code></td>
<td>
<p>A matrix of compositions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the transformed data</p>


<h3>Author(s)</h3>

<p> Jan Graffelman <a href="mailto:jan.graffelman@upc.edu">jan.graffelman@upc.edu</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Artificial)
Xsim.com &lt;- Artificial$Xsim.com
Xclr &lt;- clrmat(Xsim.com)
</code></pre>

<hr>
<h2 id='largest.kappas'>
Calculate condition indices for subcompositions
</h2><span id='topic+largest.kappas'></span>

<h3>Description</h3>

<p>Function <code>largest.kappas</code> calculates the condition numbers for all subcompositions of a given size, for a particular compositional data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>largest.kappas(Xcom, nparts = 3, sizetoplist = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="largest.kappas_+3A_xcom">Xcom</code></td>
<td>
<p>A data matrix with compositions in rows</p>
</td></tr>
<tr><td><code id="largest.kappas_+3A_nparts">nparts</code></td>
<td>
<p>The number of parts for the subcompositions to be analysed.</p>
</td></tr>
<tr><td><code id="largest.kappas_+3A_sizetoplist">sizetoplist</code></td>
<td>
<p>The length of the list of the &quot;best&quot; subcompositions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Log-ratio PCA is executed for each subcompostion, and the resulting eigenvalues and eigenvectors are stored.
</p>


<h3>Value</h3>

<p>A data frame with an ordered list of subcompositions</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(runif(600),ncol=6)
Xcom &lt;- X/rowSums(X)
Results &lt;- largest.kappas(Xcom)
</code></pre>

<hr>
<h2 id='lrpca'>
Logratio principal component analysis with condition indices
</h2><span id='topic+lrpca'></span>

<h3>Description</h3>

<p>Function <code>lrpca</code> performs logratio principal component analysis. It returns the variance decomposition, principal components, biplot coordinates and a table with condition indices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrpca(Xcom)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrpca_+3A_xcom">Xcom</code></td>
<td>
<p>A matrix with compositions in its rows</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculations are based on the singular value decompositon of the clr transformed compositions.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Fp</code></td>
<td>
<p>matrix with principal components</p>
</td></tr>
<tr><td><code>Fs</code></td>
<td>
<p>matrix with standardized principal components</p>
</td></tr>
<tr><td><code>Gp</code></td>
<td>
<p>biplot markers for parts (principal coordinates)</p>
</td></tr>
<tr><td><code>Gs</code></td>
<td>
<p>biplot markers for parts (standard coordinates)</p>
</td></tr>
<tr><td><code>La</code></td>
<td>
<p>eigenvalues</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>singular values</p>
</td></tr>
<tr><td><code>decom</code></td>
<td>
<p>table with variance decomposition</p>
</td></tr>
<tr><td><code>kappalist</code></td>
<td>
<p>table with condition indices and eigenvectors</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+princomp">princomp</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bentonites)
Ben &lt;- bentonites[,1:8]
Ben.com &lt;- Ben/rowSums(Ben)
out.lrpca &lt;- lrpca(Ben.com)
</code></pre>

<hr>
<h2 id='tr'>Compute the trace of a matrix</h2><span id='topic+tr'></span>

<h3>Description</h3>

<p><code>tr</code> computes the trace of a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tr(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tr_+3A_x">X</code></td>
<td>
<p>a (square) matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the trace (a scalar)
</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(runif(25),ncol=5)
print(X)
print(tr(X))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
