<!DOCTYPE html><html><head><title>Help for package allofus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {allofus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#allofus-package'><p>allofus: Interface for 'All of Us' Researcher Workbench</p></a></li>
<li><a href='#aou_atlas_cohort'><p>Retrieve a cohort from ATLAS for use in All of Us</p></a></li>
<li><a href='#aou_bucket_to_workspace'><p>Move files from a bucket to your workspace</p></a></li>
<li><a href='#aou_codebook'><p>All of Us Modified Codebook</p></a></li>
<li><a href='#aou_cohort_example'><p>Example cohort definition and SQL query from ATLAS</p></a></li>
<li><a href='#aou_concept_set'><p>Get occurrences of a concept set from AoU for a given cohort</p></a></li>
<li><a href='#aou_connect'><p>Create a connection to the database in All of Us</p></a></li>
<li><a href='#aou_health_history'><p>All of Us Health History Codebook</p></a></li>
<li><a href='#aou_join'><p>Join current query to another table</p></a></li>
<li><a href='#aou_ls_bucket'><p>List the current files in your bucket</p></a></li>
<li><a href='#aou_ls_workspace'><p>List the current files in your workspace</p></a></li>
<li><a href='#aou_observation_period'><p>Generate an observation period table based on OMOP Conventions</p></a></li>
<li><a href='#aou_session_info'><p>Print session information for the AoU R environment</p></a></li>
<li><a href='#aou_sql'><p>Execute a SQL query on the All of Us database</p></a></li>
<li><a href='#aou_survey'><p>Function to query allofus observation table for survey responses</p></a></li>
<li><a href='#aou_table_info'><p>Table of tables, columns, and use for researchers from the CT data dictionary</p></a></li>
<li><a href='#aou_tables'><p>List tables in the AoU Database</p></a></li>
<li><a href='#aou_workspace_to_bucket'><p>Save a file from your workspace to your bucket</p></a></li>
<li><a href='#CAST'><p>Date add function to be passed along to SQL</p></a></li>
<li><a href='#DATE_ADD'><p>Date add function to be passed along to SQL</p></a></li>
<li><a href='#DATE_DIFF'><p>Date add function to be passed along to SQL</p></a></li>
<li><a href='#on_workbench'><p>Check to see whether you are on the All of Us workbench</p></a></li>
<li><a href='#STRING_AGG'><p>Date add function to be passed along to SQL</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Interface for 'All of Us' Researcher Workbench</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Streamline use of the 'All of Us' Researcher Workbench (<a href="https://www.researchallofus.org/data-tools/workbench/">https://www.researchallofus.org/data-tools/workbench/</a>)with tools to extract and manipulate data from the 'All of Us' database. Increase interoperability with the Observational Health Data Science and Informatics ('OHDSI') tool stack by decreasing reliance of 'All of Us' tools and allowing for cohort creation via 'Atlas'. Improve reproducible and transparent research using 'All of Us'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, tidyr, magrittr, dplyr (&ge; 1.1.0), glue, bigrquery,
purrr, stats, utils, dbplyr, sessioninfo, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>DBI, knitr, rmarkdown, testthat (&ge; 3.0.0), kableExtra, DT,
googlesheets4, tibble, forcats, gh, SqlRender (&ge; 1.6.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://roux-ohdsi.github.io/allofus/">https://roux-ohdsi.github.io/allofus/</a>,
<a href="https://github.com/roux-ohdsi/allofus">https://github.com/roux-ohdsi/allofus</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/roux-ohdsi/allofus/issues">https://github.com/roux-ohdsi/allofus/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-20 21:43:06 UTC; robcavanaugh</td>
</tr>
<tr>
<td>Author:</td>
<td>Louisa Smith <a href="https://orcid.org/0000-0001-9029-4644"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Rob Cavanaugh <a href="https://orcid.org/0000-0002-2114-6565"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rob Cavanaugh &lt;r.cavanaugh@northeastern.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-21 17:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>1:10 %&gt;% sum()
</code></pre>

<hr>
<h2 id='allofus-package'>allofus: Interface for 'All of Us' Researcher Workbench</h2><span id='topic+allofus'></span><span id='topic+allofus-package'></span>

<h3>Description</h3>

<p>Streamline use of the 'All of Us' Researcher Workbench (<a href="https://www.researchallofus.org/data-tools/workbench/">https://www.researchallofus.org/data-tools/workbench/</a>)with tools to extract and manipulate data from the 'All of Us' database. Increase interoperability with the Observational Health Data Science and Informatics ('OHDSI') tool stack by decreasing reliance of 'All of Us' tools and allowing for cohort creation via 'Atlas'. Improve reproducible and transparent research using 'All of Us'.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Rob Cavanaugh <a href="mailto:r.cavanaugh@northeastern.edu">r.cavanaugh@northeastern.edu</a> (<a href="https://orcid.org/0000-0002-2114-6565">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Louisa Smith <a href="mailto:l.smith@northeastern.edu">l.smith@northeastern.edu</a> (<a href="https://orcid.org/0000-0001-9029-4644">ORCID</a>) [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://roux-ohdsi.github.io/allofus/">https://roux-ohdsi.github.io/allofus/</a>
</p>
</li>
<li> <p><a href="https://github.com/roux-ohdsi/allofus">https://github.com/roux-ohdsi/allofus</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/roux-ohdsi/allofus/issues">https://github.com/roux-ohdsi/allofus/issues</a>
</p>
</li></ul>


<hr>
<h2 id='aou_atlas_cohort'>Retrieve a cohort from ATLAS for use in All of Us</h2><span id='topic+aou_atlas_cohort'></span>

<h3>Description</h3>

<p>This function retrieves a cohort definition from ATLAS and generates the cohort in All of Us.
Observation periods are first generated for each subject using the <code><a href="#topic+aou_observation_period">aou_observation_period()</a></code> function.
The resulting cohort is a dataframe with the cohort start and end dates for each subject.
The function is based on a similar function in <a href="https://github.com/cmayer2/r4aou">https://github.com/cmayer2/r4aou</a> with some tweaks
to generate the appropriate observation periods and incorporate other package functions.
Please see the online vignette for additional details insert link here
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_atlas_cohort(
  cohort_definition,
  cohort_sql,
  persistence_window = 548,
  end_date_buffer = 60,
  exclude_aou_visits = FALSE,
  debug = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_atlas_cohort_+3A_cohort_definition">cohort_definition</code></td>
<td>
<p>A cohort definition generated using <code style="white-space: pre;">&#8288;getCohortDefinition() from ROhdsiWebApi&#8288;</code></p>
</td></tr>
<tr><td><code id="aou_atlas_cohort_+3A_cohort_sql">cohort_sql</code></td>
<td>
<p>The cohort_sql generated using <code style="white-space: pre;">&#8288;getCohortSql() from ROhdsiWebApi&#8288;</code></p>
</td></tr>
<tr><td><code id="aou_atlas_cohort_+3A_persistence_window">persistence_window</code></td>
<td>
<p>Longest allowable time between visits for the same observation period. Defaults to 548 (see details)</p>
</td></tr>
<tr><td><code id="aou_atlas_cohort_+3A_end_date_buffer">end_date_buffer</code></td>
<td>
<p>Number of days to add to last observed date. Defaults to 60 (see details)</p>
</td></tr>
<tr><td><code id="aou_atlas_cohort_+3A_exclude_aou_visits">exclude_aou_visits</code></td>
<td>
<p>Whether to exclude All of Us clinical visits (i.e., for program-specific measurements,
not part of the participants' typical EHR) from the observation period. Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="aou_atlas_cohort_+3A_debug">debug</code></td>
<td>
<p>Print the query to the console; useful for debugging.</p>
</td></tr>
<tr><td><code id="aou_atlas_cohort_+3A_...">...</code></td>
<td>
<p>Further arguments passed along to <code>collect()</code> if <code>collect = TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Follows conventions described here: <a href="https://ohdsi.github.io/CommonDataModel/ehrObsPeriods.html">https://ohdsi.github.io/CommonDataModel/ehrObsPeriods.html</a>
</p>


<h3>Value</h3>

<p>A dataframe with the resulting cohort. The SQL query used to generate the cohort is stored as an attribute.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# generate a simple stroke cohort
# see https://atlas-demo.ohdsi.org/#/cohortdefinition/1788061
# aou_cohort_example contains the results of
# cd &lt;- ROhdsiWebApi::getCohortDefinition(1788061, "https://atlas-demo.ohdsi.org/WebAPI")
# cd_sql &lt;- ROhdsiWebApi::getCohortSql(cd, "https://atlas-demo.ohdsi.org/WebAPI")

cohort &lt;- aou_atlas_cohort(
  cohort_definition = aou_cohort_example$cd,
  cohort_sql = aou_cohort_example$cd_sql
)

# print query that was executed
cat(attr(cohort, "query"))

</code></pre>

<hr>
<h2 id='aou_bucket_to_workspace'>Move files from a bucket to your workspace</h2><span id='topic+aou_bucket_to_workspace'></span>

<h3>Description</h3>

<p>This function retrieves a file from your bucket and moves it
into your workspace where it can be read into R, e.g., using a function like <code>write.csv()</code>.
See <a href="https://cloud.google.com/storage/docs/gsutil/commands/cp">https://cloud.google.com/storage/docs/gsutil/commands/cp</a> for details on the
underlying function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_bucket_to_workspace(
  file,
  directory = FALSE,
  bucket = getOption("aou.default.bucket")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_bucket_to_workspace_+3A_file">file</code></td>
<td>
<p>The name of a file in your bucket, a vector of multiple files, a directory,
or a file pattern (e.g. &quot;.csv&quot;).</p>
</td></tr>
<tr><td><code id="aou_bucket_to_workspace_+3A_directory">directory</code></td>
<td>
<p>Whether <code>file</code> refers to an entire directory you want to move.</p>
</td></tr>
<tr><td><code id="aou_bucket_to_workspace_+3A_bucket">bucket</code></td>
<td>
<p>Bucket to retrieve file from. Defaults to <code>getOption("aou.default.bucket")</code>,
which is <code>Sys.getenv('WORKSPACE_BUCKET')</code> unless specified otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# save a file to the bucket
tmp &lt;- tempdir()
write.csv(data.frame(x = 1), file.path(tmp,"testdata.csv"))
aou_workspace_to_bucket(file.path(tmp,"testdata.csv"))
# read the file back into the workspace
aou_bucket_to_workspace("testdata.csv")
# read in to your local environment
read.csv("testdata.csv")


</code></pre>

<hr>
<h2 id='aou_codebook'>All of Us Modified Codebook</h2><span id='topic+aou_codebook'></span>

<h3>Description</h3>

<p>This table consists of mapped rows from the
publicly available All of Us Survey Codebook
to the All of Us PPI Vocabulary available on Athena . A small number of rows did not
match between the codebook and the Athena PPI Vocabulary. It can also be accessed in R using <code>allofus::aou_codebook</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_codebook
</code></pre>


<h3>Format</h3>

<p><code>aou_codebook</code>
A data frame with 702 rows and 11 columns:
</p>

<dl>
<dt>concept_code</dt><dd><p>chr; Concept code from AOU codebook</p>
</dd>
<dt>concept_id</dt><dd><p>int; mapped concept_id from PPI vocabulary</p>
</dd>
<dt>concept_name</dt><dd><p>chr; Formatted text name of concept</p>
</dd>
<dt>concept_class_id</dt><dd><p>chr; type of survey item - question or answer</p>
</dd>
<dt>form_name</dt><dd><p>int; name of survey</p>
</dd>
<dt>field_type</dt><dd><p>chr; type of question (radio, text, checkbox etc.)</p>
</dd>
<dt>field_label</dt><dd><p>chr; The actual text of the question or answer</p>
</dd>
<dt>choices</dt><dd><p>int; choices for question if radio or checkbox</p>
</dd>
<dt>standard_concept</dt><dd><p>chr; Whether concept_id is a standard omop concept</p>
</dd>
<dt>valid_start_Date</dt><dd><p>chr; start date for concept</p>
</dd>
<dt>valid_end_Date</dt><dd><p>int; end date for concept</p>
</dd>
<dt>link</dt><dd><p>chr; link to survey pdf</p>
</dd>
</dl>



<h3>Details</h3>

<p>Questions relating to specific conditions are not included as part of this table.
They are instead available in the <code>aou_health_history</code> table.
</p>

<ul>
<li><p><a href="https://docs.google.com/spreadsheets/d/1Ey8MScRYZ9QyS4izVYScISLMb62QEhSM-ErbG27dNtw/edit#gid=1832128489">All of Us codebook</a>
</p>
</li>
<li><p><a href="https://github.com/roux-ohdsi/allofus/blob/main/data-raw/pkg_data.R">Code to generate table</a>
</p>
</li></ul>


<hr>
<h2 id='aou_cohort_example'>Example cohort definition and SQL query from ATLAS</h2><span id='topic+aou_cohort_example'></span>

<h3>Description</h3>

<p>A list containing a sample cohort definition and SQL query from the demo ATLAS for a cohort of stroke survivors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_cohort_example
</code></pre>


<h3>Format</h3>

<p><code>aou_cohort_example</code>
</p>

<dl>
<dt>cd</dt><dd><p>Cohort definition object</p>
</dd>
<dt>cd_sql</dt><dd><p>SQL query for cohort definition</p>
</dd>
</dl>


<hr>
<h2 id='aou_concept_set'>Get occurrences of a concept set from AoU for a given cohort</h2><span id='topic+aou_concept_set'></span>

<h3>Description</h3>

<p>Get occurrences of a concept set from AoU for a given cohort
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_concept_set(
  cohort = NULL,
  concepts,
  start_date = NULL,
  end_date = NULL,
  domains = c("condition", "measurement", "observation", "procedure", "drug", "device",
    "visit"),
  output = "indicator",
  concept_set_name = "concept_set",
  min_n = 1,
  con = getOption("aou.default.con"),
  collect = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_concept_set_+3A_cohort">cohort</code></td>
<td>
<p>query to a cohort or local dataframe with a column called &quot;person_id&quot;, and (possibly) columns for start_date and end_date.
If not provided, defaults to entire All of Us cohort.</p>
</td></tr>
<tr><td><code id="aou_concept_set_+3A_concepts">concepts</code></td>
<td>
<p>a vector of concept ids</p>
</td></tr>
<tr><td><code id="aou_concept_set_+3A_start_date">start_date</code></td>
<td>
<p>chr; the name of the start_date column in the cohort table; defaults to NULL to pull data across all dates</p>
</td></tr>
<tr><td><code id="aou_concept_set_+3A_end_date">end_date</code></td>
<td>
<p>chr; the name of the end_date column in the cohort table; defaults to NULL to pull data across all dates</p>
</td></tr>
<tr><td><code id="aou_concept_set_+3A_domains">domains</code></td>
<td>
<p>chr; a vector of domains to search for the concepts in (&quot;condition&quot;, &quot;measurement&quot;, &quot;observation&quot;, &quot;procedure&quot;, &quot;drug&quot;, &quot;device&quot;, &quot;visit&quot;); defaults to all</p>
</td></tr>
<tr><td><code id="aou_concept_set_+3A_output">output</code></td>
<td>
<p>one of &quot;indicator&quot;, &quot;count&quot;, &quot;all&quot;; do you want to return a 1 if a person has any matching concepts and 0 if not (&quot;indicator&quot;),
the number of matching concepts per person (&quot;count&quot;), or all info about the matching concepts (&quot;all&quot;). Defaults to &quot;indicator&quot;</p>
</td></tr>
<tr><td><code id="aou_concept_set_+3A_concept_set_name">concept_set_name</code></td>
<td>
<p>chr; If output = &quot;indicator&quot; or output = &quot;n&quot;, name for that column. Defaults to &quot;concept_set&quot;.</p>
</td></tr>
<tr><td><code id="aou_concept_set_+3A_min_n">min_n</code></td>
<td>
<p>dbl; If output = &quot;indicator&quot;, the minimum number of occurrences per person to consider the indicator true. Defaults to 1.</p>
</td></tr>
<tr><td><code id="aou_concept_set_+3A_con">con</code></td>
<td>
<p>connection to the allofus SQL database. Defaults to getOption(&quot;aou.default.con&quot;), which is set automatically if you use <code>aou_connect()</code></p>
</td></tr>
<tr><td><code id="aou_concept_set_+3A_collect">collect</code></td>
<td>
<p>lgl; whether to collect from the database</p>
</td></tr>
<tr><td><code id="aou_concept_set_+3A_...">...</code></td>
<td>
<p>further arguments passed along to <code>collect()</code> if <code>collect = TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe if collect = TRUE; a remote tbl if not
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# indicator for any aspirin at any time
aspirin_users &lt;- aou_concept_set(dplyr::tbl(con, "person"),
  concepts = 1191, concept_set_name = "aspirin", domains = "drug"
)

# starting with person table to create a cohort
people &lt;- dplyr::tbl(con, "person") %&gt;%
  dplyr::filter(person_id &lt; 2000000) %&gt;%
  dplyr::mutate(
    start = as.Date("2021-01-01"),
    end = as.Date("2023-12-31")
  )

dat &lt;- aou_concept_set(
  cohort = people,
  concepts = c(725115, 1612146, 1613031),
  start_date = "start",
  end_date = "end",
  concept_set_name = "CGM",
  output = "all"
)

</code></pre>

<hr>
<h2 id='aou_connect'>Create a connection to the database in All of Us</h2><span id='topic+aou_connect'></span>

<h3>Description</h3>

<p>Use this function to create a <code>BigQueryConnection</code> object.
You can reference this object to connect to the All of Us database and run
SQL code using, e.g., <code>dbplyr</code> or <code>DBI</code>. A message is printed with the connection
status (successful or not).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_connect(CDR = getOption("aou.default.cdr"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_connect_+3A_cdr">CDR</code></td>
<td>
<p>The name of the &quot;curated data repository&quot; to connect to. Defaults to
<code>getOption("aou.default.cdr")</code>, which is <code>Sys.getenv('WORKSPACE_CDR')</code> if not specified otherwise
(i.e., the &quot;mainline&quot; CDR).
On the controlled tier, specify the &quot;base&quot; CDR with <code>CDR = paste0(Sys.getenv('WORKSPACE_CDR'), "_base")</code>.</p>
</td></tr>
<tr><td><code id="aou_connect_+3A_...">...</code></td>
<td>
<p>Further arguments passed along to <code>DBI::dbConnect()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>BigQueryConnection</code> object. This object is also saved as an option (<code>getOption("aou.default.con")</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
con &lt;- aou_connect()
# reference the observation table in the database
dplyr::tbl(con, "observation")
# print a list of the tables in the database
DBI::dbListTables(con)

</code></pre>

<hr>
<h2 id='aou_health_history'>All of Us Health History Codebook</h2><span id='topic+aou_health_history'></span>

<h3>Description</h3>

<p>This table consists of rows of the codebook pertaining to the health history questions. In early All of Us surveys,
these questions were asked separately about the respondent and the respondent's family. In the current version,
the questions are asked on the same survey. The nested nature of these questions makes them challenging to deal with.
It can also be accessed in R using <code>allofus::aou_health_history</code>.
</p>

<ul>
<li><p><a href="https://github.com/roux-ohdsi/allofus/blob/main/data-raw/pkg_data.R">Code to generate table</a>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>aou_health_history
</code></pre>


<h3>Format</h3>

<p><code>aou_health_history</code>
A data frame with 1685  rows and 9 columns:
</p>

<dl>
<dt>question</dt><dd><p>chr; Question asked on survey</p>
</dd>
<dt>relative</dt><dd><p>chr; Person to whom the answer pertains</p>
</dd>
<dt>condition</dt><dd><p>chr; Formatted text name of concept</p>
</dd>
<dt>category</dt><dd><p>chr; Type of health condition</p>
</dd>
<dt>concept_code</dt><dd><p>chr; Concept code from AOU codebook</p>
</dd>
<dt>concept_id_specific</dt><dd><p>int; Concept id for the answer</p>
</dd>
<dt>concept_id_overall</dt><dd><p>int; Concept id for the condition overall</p>
</dd>
<dt>concept_id_question</dt><dd><p>int; Concept id for the overarching question</p>
</dd>
<dt>form_name</dt><dd><p>chr; Survey name</p>
</dd>
</dl>


<hr>
<h2 id='aou_join'>Join current query to another table</h2><span id='topic+aou_join'></span>

<h3>Description</h3>

<p>Simple wrapper for join functions to join an existing query
to another table in the All of Us database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_join(
  data,
  table,
  type,
  by = NULL,
  suffix = c("_x", "_y"),
  con = getOption("aou.default.con"),
  x_as = NULL,
  y_as = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_join_+3A_data">data</code></td>
<td>
<p>unexecuted SQL query from dbplyr/dplyr.</p>
</td></tr>
<tr><td><code id="aou_join_+3A_table">table</code></td>
<td>
<p>the omop table (or other remote table in your schema) you wish to join, as a character string, or a tbl object.</p>
</td></tr>
<tr><td><code id="aou_join_+3A_type">type</code></td>
<td>
<p>the type of join. use types available in dplyr: left, right, inner, anti, full etc.</p>
</td></tr>
<tr><td><code id="aou_join_+3A_by">by</code></td>
<td>
<p>columns to join on</p>
</td></tr>
<tr><td><code id="aou_join_+3A_suffix">suffix</code></td>
<td>
<p>suffix preferences to add when joining data with the same column names not specified in the by argument.</p>
</td></tr>
<tr><td><code id="aou_join_+3A_con">con</code></td>
<td>
<p>connection to the allofus SQL database. Defaults to getOption(&quot;aou.default.con&quot;), which is set automatically if you use <code>aou_connect()</code></p>
</td></tr>
<tr><td><code id="aou_join_+3A_x_as">x_as</code></td>
<td>
<p>optional; a string for the name of the left table</p>
</td></tr>
<tr><td><code id="aou_join_+3A_y_as">y_as</code></td>
<td>
<p>optional; a string for the name of the right table</p>
</td></tr>
<tr><td><code id="aou_join_+3A_...">...</code></td>
<td>
<p>arguments passed on to the join function. e.g., by = &quot;person_id&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are a few good reasons to use aou_join() when possible over the x_join functions from dplyr.
First, it reduces the code necessary to join an existing table to another table. Second,
it includes checks/workarounds for two sources of common errors using dbplyr:
it automatically appends the x_as and y_as arguments to the join call if they are not provided and
it changes the default suffix from .x/.y to _x/_y for cases with shared column names not specified by
the <code>by</code> argument which will result in a SQL error.
</p>


<h3>Value</h3>

<p>Continued dbplyr query
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

con &lt;- aou_connect()
obs_tbl &lt;- dplyr::tbl(con, "observation") %&gt;%
  dplyr::select(-provider_id)
obs_tbl %&gt;%
  aou_join("person", type = "left", by = "person_id")

</code></pre>

<hr>
<h2 id='aou_ls_bucket'>List the current files in your bucket</h2><span id='topic+aou_ls_bucket'></span>

<h3>Description</h3>

<p>The files stored in a bucket are not easily visible from a notebook. List
all files in the bucket or files matching a certain pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_ls_bucket(
  pattern = "",
  silent = FALSE,
  recursive = TRUE,
  bucket = getOption("aou.default.bucket"),
  gsutil_args = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_ls_bucket_+3A_pattern">pattern</code></td>
<td>
<p>Regular expression, such as &quot;*.csv&quot; or a single file name e.g., &quot;mydata.csv&quot;.
Default will find all files apart from notebooks (.ipynb files).</p>
</td></tr>
<tr><td><code id="aou_ls_bucket_+3A_silent">silent</code></td>
<td>
<p>Whether to omit the names of files found. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="aou_ls_bucket_+3A_recursive">recursive</code></td>
<td>
<p>Whether to search subdirectories. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="aou_ls_bucket_+3A_bucket">bucket</code></td>
<td>
<p>Bucket to retrieve file from. Defaults to <code>getOption("aou.default.bucket")</code>,
which is <code>Sys.getenv('WORKSPACE_BUCKET')</code> unless specified otherwise.</p>
</td></tr>
<tr><td><code id="aou_ls_bucket_+3A_gsutil_args">gsutil_args</code></td>
<td>
<p>A string containing other arguments passed to <code style="white-space: pre;">&#8288;gsutil ls&#8288;</code>.
See <a href="https://cloud.google.com/storage/docs/gsutil/commands/ls">https://cloud.google.com/storage/docs/gsutil/commands/ls</a> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of file names
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# list all files, including in subdirectories
aou_ls_bucket()
# list all csv files
aou_ls_bucket("*.csv")

</code></pre>

<hr>
<h2 id='aou_ls_workspace'>List the current files in your workspace</h2><span id='topic+aou_ls_workspace'></span>

<h3>Description</h3>

<p>The files stored in a workspace are not easily visible from a notebook. List
all files in the workspace (apart from notebooks) or files matching a certain pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_ls_workspace(pattern = "", silent = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_ls_workspace_+3A_pattern">pattern</code></td>
<td>
<p>Regular expression, such as &quot;*.csv&quot; or a single file name e.g., &quot;mydata.csv&quot;.
Default will find all files apart from notebooks (.ipynb files).</p>
</td></tr>
<tr><td><code id="aou_ls_workspace_+3A_silent">silent</code></td>
<td>
<p>Whether to omit the names of files found. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="aou_ls_workspace_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>list.files()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of file names
</p>


<h3>Examples</h3>

<pre><code class='language-R'>my_workspace_files &lt;- aou_ls_workspace(silent = TRUE)
aou_ls_workspace("*.csv")
aou_ls_workspace(path = "data")

</code></pre>

<hr>
<h2 id='aou_observation_period'>Generate an observation period table based on OMOP Conventions</h2><span id='topic+aou_observation_period'></span>

<h3>Description</h3>

<p>Generate an observation period table based on OMOP Conventions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_observation_period(
  cohort = NULL,
  persistence_window = 548,
  end_date_buffer = 60,
  exclude_aou_visits = FALSE,
  con = getOption("aou.default.con"),
  collect = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_observation_period_+3A_cohort">cohort</code></td>
<td>
<p>Query to a cohort or local dataframe with column &quot;person_id&quot;. If no cohort is provided,
defaults to the entire All of Us cohort</p>
</td></tr>
<tr><td><code id="aou_observation_period_+3A_persistence_window">persistence_window</code></td>
<td>
<p>Longest allowable time between visits for the same observation period. Defaults to 548 (see details)</p>
</td></tr>
<tr><td><code id="aou_observation_period_+3A_end_date_buffer">end_date_buffer</code></td>
<td>
<p>Number of days to add to last observed date. Defaults to 60 (see details)</p>
</td></tr>
<tr><td><code id="aou_observation_period_+3A_exclude_aou_visits">exclude_aou_visits</code></td>
<td>
<p>Whether to exclude All of Us clinical visits (i.e., for program-specific measurements,
not part of the participants' typical EHR) from the observation period. Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="aou_observation_period_+3A_con">con</code></td>
<td>
<p>Connection to the allofus SQL database. Defaults to getOption(&quot;aou.default.con&quot;), which is set automatically if you use <code>aou_connect()</code></p>
</td></tr>
<tr><td><code id="aou_observation_period_+3A_collect">collect</code></td>
<td>
<p>Whether to collect the data or keep as SQL query. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="aou_observation_period_+3A_...">...</code></td>
<td>
<p>Further arguments passed along to <code>collect()</code> if <code>collect = TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Follows conventions described here: <a href="https://ohdsi.github.io/CommonDataModel/ehrObsPeriods.html">https://ohdsi.github.io/CommonDataModel/ehrObsPeriods.html</a>
</p>


<h3>Value</h3>

<p>a sql query or local data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cohort &lt;- dplyr::tbl(con, "cb_search_person") %&gt;%
  dplyr::filter(has_ehr_data == 1) %&gt;%
  head(100) %&gt;%
  dplyr::select(person_id)

observation_periods &lt;- aou_observation_period(cohort,
  persistence_window = 548,
  end_date_buffer = 60,
  collect = FALSE
)

</code></pre>

<hr>
<h2 id='aou_session_info'>Print session information for the AoU R environment</h2><span id='topic+aou_session_info'></span>

<h3>Description</h3>

<p>For the purposes of reproducibility, it is important to know the version of R,
the packages, and the AoU release that you are using. This function prints
this information to the console.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_session_info(CDR = getOption("aou.default.cdr"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_session_info_+3A_cdr">CDR</code></td>
<td>
<p>The name of the CDR to use. Defaults to <code>getOption("aou.default.cdr")</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three elements: the platform, the AoU release, and the packages
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
allofus::aou_session_info()

</code></pre>

<hr>
<h2 id='aou_sql'>Execute a SQL query on the All of Us database</h2><span id='topic+aou_sql'></span>

<h3>Description</h3>

<p>Execute a SQL query on the All of Us database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_sql(query, CDR = getOption("aou.default.cdr"), debug = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_sql_+3A_query">query</code></td>
<td>
<p>A SQL query (BigQuery dialect) to be executed. Interpreted
with <code>glue::glue()</code>, so expressions enclosed with braces will be evaluated.
References to <code>"{CDR}"</code> or <code>"{cdr}"</code> will be evaluated automatically (see examples).</p>
</td></tr>
<tr><td><code id="aou_sql_+3A_cdr">CDR</code></td>
<td>
<p>The name of the &quot;curated data repository&quot; that will be used in any
references of the form <code>"{CDR}"</code> or <code>"{cdr}"</code> in the query (see examples). Defaults to
<code>getOption("aou.default.cdr")</code>, which is <code>Sys.getenv('WORKSPACE_CDR')</code> if not specified otherwise
(i.e., the &quot;mainline&quot; CDR).
On the controlled tier, specify the &quot;base&quot; CDR with <code>CDR = paste0(Sys.getenv('WORKSPACE_CDR'), "_base")</code>.</p>
</td></tr>
<tr><td><code id="aou_sql_+3A_debug">debug</code></td>
<td>
<p>Print the query to the console; useful for debugging.</p>
</td></tr>
<tr><td><code id="aou_sql_+3A_...">...</code></td>
<td>
<p>All other arguments passed to <code>bigrquery::bq_table_download()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the results of the query.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Examples based on AoU snippets
aou_sql("
  -- Compute the count of unique participants in our All of Us cohort.
  SELECT
  COUNT(DISTINCT person_id) AS total_number_of_participants
  FROM
  `{CDR}.person`
")

MEASUREMENT_OF_INTEREST &lt;- "hemoglobin"
aou_sql('
-- Compute summary information for our measurements of interest for our cohort.
--
-- PARAMETERS:
--   MEASUREMENT_OF_INTEREST: a case-insensitive string, such as "hemoglobin", to be compared
--                            to all measurement concept names to identify those of interest

WITH
  --
  -- Use a case insensitive string to search the measurement concept names of those
  -- measurements we do have in the measurements table.
  --
  labs_of_interest AS (
  SELECT
    measurement_concept_id,
    measurement_concept.concept_name AS measurement_name,
    unit_concept_id,
    unit_concept.concept_name AS unit_name
  FROM
    `{CDR}.measurement`
  LEFT JOIN `{CDR}.concept` AS measurement_concept
  ON measurement_concept.concept_id = measurement_concept_id
  LEFT JOIN `{CDR}.concept` AS unit_concept
  ON unit_concept.concept_id = unit_concept_id
  WHERE
    REGEXP_CONTAINS(measurement_concept.concept_name, r"(?i){MEASUREMENT_OF_INTEREST}")
  GROUP BY
    measurement_concept_id,
    unit_concept_id,
    measurement_concept.concept_name,
    unit_concept.concept_name
)
  --
  -- Summarize the information about each measurement concept of interest that our
  -- prior query identified.
  --
SELECT
  measurement_name AS measurement,
  IFNULL(unit_name, "NA") AS unit,
  COUNT(1) AS N,
  COUNTIF(value_as_number IS NULL
    AND (value_as_concept_id IS NULL
      OR value_as_concept_id = 0)) AS missing,
  MIN(value_as_number) AS min,
  MAX(value_as_number) AS max,
  AVG(value_as_number) AS avg,
  STDDEV(value_as_number) AS stddev,
  APPROX_QUANTILES(value_as_number, 4) AS quantiles,
  COUNTIF(value_as_number IS NOT NULL) AS num_numeric_values,
  COUNTIF(value_as_concept_id IS NOT NULL
      AND value_as_concept_id != 0) AS num_concept_values,
  COUNTIF(operator_concept_id IS NOT NULL) AS num_operators,
  IF(src_id = "PPI/PM", "PPI", "EHR") AS measurement_source,
  measurement_concept_id,
  unit_concept_id
FROM
  `{CDR}.measurement`
INNER JOIN
 labs_of_interest USING(measurement_concept_id, unit_concept_id)
LEFT JOIN
  `{CDR}.measurement_ext` USING(measurement_id)
GROUP BY
  measurement_concept_id,
  measurement_name,
  measurement_source,
  unit_concept_id,
  unit_name
ORDER BY
  N DESC
', debug = TRUE)

</code></pre>

<hr>
<h2 id='aou_survey'>Function to query allofus observation table for survey responses</h2><span id='topic+aou_survey'></span>

<h3>Description</h3>

<p>Because responses to the survey questions stored in the ds_survey table do not
include skipped questions (i.e., missing data!), this function makes it easier to
query the observation table for responses to survey questions so that the skipped
responses are included.
</p>
<p>The function will return a dataframe or SQL tbl with the initial cohort table along
with a column for each question included in <code>questions</code> and answers for
each person_id in the cells. The column names (questions) can
be returned as the concept_code or concept_id or by providing new column names. For each question, a column with
the suffix &quot;_date&quot; is included with the date on which the question was answered.
When questions can have multiple answers (&quot;checkbox&quot;-style questions), answers
are returned as a comma-separated string.
</p>
<p>To find the desired survey questions, use the all of us data dictionary,
survey codebook, athena, data browser, or the allofus R package
modified codebook which can be found here: https://roux-ohdsi.github.io/allofus/articles/searchable_codebook.html
For questions regarding an individual's health history or family health history,
the function requires the specific concept_id (or concept_code) for individual in question,
whether that is &quot;self&quot; or another relative. Responses are returned as &quot;Yes&quot; if the respondent
answered that the individual had the condition, &quot;No&quot; if the respondent answered that the individual
did not have that condition (or omitted it when selecting from related conditions), a
skip response if the question was skipped, and NA if the respondent did not answer the question.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_survey(
  cohort = NULL,
  questions,
  question_output = "concept_code",
  clean_answers = TRUE,
  con = getOption("aou.default.con"),
  collect = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_survey_+3A_cohort">cohort</code></td>
<td>
<p>tbl or dataframe with a cohort that includes a column called person_id</p>
</td></tr>
<tr><td><code id="aou_survey_+3A_questions">questions</code></td>
<td>
<p>either a vector of concept_ids or concept_codes for questions to return results</p>
</td></tr>
<tr><td><code id="aou_survey_+3A_question_output">question_output</code></td>
<td>
<p>how to name the columns. Options include as the text of the concept code (&quot;concept_code&quot;), as concept ids preceded by
&quot;x_&quot; (&quot;concept_id&quot;), or using a custom vector of column names matching the vector of <code>questions</code>. Defaults to &quot;concept_code&quot;.</p>
</td></tr>
<tr><td><code id="aou_survey_+3A_clean_answers">clean_answers</code></td>
<td>
<p>whether to clean the answers to the survey questions. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="aou_survey_+3A_con">con</code></td>
<td>
<p>connection to the allofus SQL database. Defaults to getOption(&quot;aou.default.con&quot;), which is created automatically with <code>aou_connect()</code></p>
</td></tr>
<tr><td><code id="aou_survey_+3A_collect">collect</code></td>
<td>
<p>whether to return the results as a local (TRUE) or database table</p>
</td></tr>
<tr><td><code id="aou_survey_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>collect()</code> when <code>collect = TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe if collect = TRUE; a remote tbl if not
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

con &lt;- aou_connect()
cohort &lt;- dplyr::tbl(con, "person") %&gt;%
  dplyr::filter(person_id &gt; 5000000) %&gt;%
  dplyr::select(person_id, year_of_birth, gender_concept_id)

aou_survey(
  cohort,
  questions = c(1585375, 1586135),
  question_output = "concept_code"
)
aou_survey(
  cohort,
  questions = c(1585811, 1585386),
  question_output = c("pregnancy", "insurance")
)
aou_survey(
  cohort,
  questions = c(1585375, 1586135, 1740719, 43529932),
  question_output = c("income", "birthplace", "grandpa_bowel_obstruction", "t2dm"),
  collect = FALSE
)

aou_survey(cohort,
  questions = 1384452,
  question_output = "osteoarthritis"
) %&gt;%
  dplyr::count(osteoarthritis)

</code></pre>

<hr>
<h2 id='aou_table_info'>Table of tables, columns, and use for researchers from the CT data dictionary</h2><span id='topic+aou_table_info'></span>

<h3>Description</h3>

<p>A data frame containing tables and columns in the aou OMOP CDM created from
https://docs.google.com/spreadsheets/d/1XLVq84LLd0VZMioF2sPwyiaPw3EFp5c8o1CTWGPH-Yc/edit#gid=1815943286.
Note that the column 'value_source_value' has been manually added as it is missing from the data dictionary.
</p>

<ul>
<li><p><a href="https://github.com/roux-ohdsi/allofus/blob/main/data-raw/more_data.R">Code to generate table</a>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>aou_table_info
</code></pre>


<h3>Format</h3>

<p><code>aou_table_info</code>
</p>

<dl>
<dt>table_name</dt><dd><p>chr; name of the table</p>
</dd>
<dt>columns</dt><dd><p>chr; columns in the table</p>
</dd>
<dt>recommended_for_research</dt><dd><p>chr; whether the table is recomended for research</p>
</dd>
</dl>


<hr>
<h2 id='aou_tables'>List tables in the AoU Database</h2><span id='topic+aou_tables'></span>

<h3>Description</h3>

<p>List tables in the AoU Database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_tables(con = getOption("aou.default.con"), remove_na = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_tables_+3A_con">con</code></td>
<td>
<p>Connection to the allofus SQL database. Defaults to <code>getOption("aou.default.con")</code>,
which is created automatically with <code>aou_connect()</code></p>
</td></tr>
<tr><td><code id="aou_tables_+3A_remove_na">remove_na</code></td>
<td>
<p>Whether to remove tables that are not in the data dictionary. Defaults to <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the table names and the number of columns
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
con &lt;- aou_connect()
aou_tables()

</code></pre>

<hr>
<h2 id='aou_workspace_to_bucket'>Save a file from your workspace to your bucket</h2><span id='topic+aou_workspace_to_bucket'></span>

<h3>Description</h3>

<p>This function moves a file saved in a workspace
to a bucket, where it can be retrieved even if the environment is deleted. To use, first save the desired
object as a file to the workspace (e.g., <code>write.csv(object, "filename.csv")</code>) and then run this function
(e.g., <code>aou_workspace_to_bucket(files = "filename.csv")</code>). See <a href="https://cloud.google.com/storage/docs/gsutil/commands/cp">https://cloud.google.com/storage/docs/gsutil/commands/cp</a> for details on the
underlying function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aou_workspace_to_bucket(
  file,
  directory = FALSE,
  bucket = getOption("aou.default.bucket")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aou_workspace_to_bucket_+3A_file">file</code></td>
<td>
<p>The name of a file in your bucket, a vector of multiple files, a directory,
or a file pattern (e.g. &quot;.csv&quot;). See Details.</p>
</td></tr>
<tr><td><code id="aou_workspace_to_bucket_+3A_directory">directory</code></td>
<td>
<p>Whether <code>file</code> refers to an entire directory you want to move.</p>
</td></tr>
<tr><td><code id="aou_workspace_to_bucket_+3A_bucket">bucket</code></td>
<td>
<p>Bucket to save files to. Defaults to <code>getOption("aou.default.bucket")</code>,
which is <code>Sys.getenv('WORKSPACE_BUCKET')</code> unless specified otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# create test files in a temporary directory
tmp &lt;- tempdir()
write.csv(data.frame(x = 1), file.path(tmp,"testdata1.csv"))
write.csv(data.frame(y = 2), file.path(tmp,"testdata2.csv"))
# save a file to the bucket
aou_workspace_to_bucket(file.path(tmp, "testdata1.csv"))
# save multiple files at once
aou_workspace_to_bucket(c(file.path(tmp, "testdata1.csv"), file.path(tmp, "testdata2.csv")))
# save an entire directory
aou_workspace_to_bucket(tmp, directory = TRUE)

</code></pre>

<hr>
<h2 id='CAST'>Date add function to be passed along to SQL</h2><span id='topic+CAST'></span>

<h3>Description</h3>

<p>Date add function to be passed along to SQL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CAST(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CAST_+3A_...">...</code></td>
<td>
<p>additional arguments passed to dbplyr SQL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Internal, passed along to dbplyr SQL.
</p>

<hr>
<h2 id='DATE_ADD'>Date add function to be passed along to SQL</h2><span id='topic+DATE_ADD'></span>

<h3>Description</h3>

<p>Date add function to be passed along to SQL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DATE_ADD(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DATE_ADD_+3A_...">...</code></td>
<td>
<p>additional arguments passed to dbplyr SQL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Internal, passed along to dbplyr SQL.
</p>

<hr>
<h2 id='DATE_DIFF'>Date add function to be passed along to SQL</h2><span id='topic+DATE_DIFF'></span>

<h3>Description</h3>

<p>Date add function to be passed along to SQL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DATE_DIFF(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DATE_DIFF_+3A_...">...</code></td>
<td>
<p>additional arguments passed to dbplyr SQL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Internal, passed along to dbplyr SQL.
</p>

<hr>
<h2 id='on_workbench'>Check to see whether you are on the All of Us workbench</h2><span id='topic+on_workbench'></span>

<h3>Description</h3>

<p>Use this function to check whether you are on the
All of Us Researcher Workbench. This is useful for writing code that
can be used both on the workbench and locally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>on_workbench()
</code></pre>


<h3>Value</h3>

<p>TRUE if you are on the workbench, FALSE otherwise
</p>


<h3>Examples</h3>

<pre><code class='language-R'>on_workbench()
</code></pre>

<hr>
<h2 id='STRING_AGG'>Date add function to be passed along to SQL</h2><span id='topic+STRING_AGG'></span>

<h3>Description</h3>

<p>Date add function to be passed along to SQL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>STRING_AGG(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="STRING_AGG_+3A_...">...</code></td>
<td>
<p>additional arguments passed to dbplyr SQL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Internal, passed along to dbplyr SQL.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
