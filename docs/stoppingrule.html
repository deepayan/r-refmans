<!DOCTYPE html><html lang="en"><head><title>Help for package stoppingrule</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stoppingrule}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#stoppingrule'><p>Create and Evaluate Stopping Rules for Safety Monitoring</p></a></li>
<li><a href='#bdryfcn'><p>Stopping Rule Boundary Function</p></a></li>
<li><a href='#bdryfcn.bin'><p>Stopping Rule Boundary Function (Binary Data)</p></a></li>
<li><a href='#bdryfcn.surv'><p>Stopping Rule Boundary Function (Survival Data)</p></a></li>
<li><a href='#calc.bnd.bin'><p>Stopping Boundary Calculation (Binary Data)</p></a></li>
<li><a href='#calc.bnd.surv'><p>Stopping Boundary Calculation (Survival Data)</p></a></li>
<li><a href='#calc.rule'><p>Stopping Rule Calculation</p></a></li>
<li><a href='#calc.rule.bin'><p>Stopping Rule Calculation (Binary Data)</p></a></li>
<li><a href='#calc.rule.surv'><p>Stopping Rule Calculation (Survival Data)</p></a></li>
<li><a href='#findconst.bin'><p>Search for Calibration Value (Binary Data)</p></a></li>
<li><a href='#findconst.surv'><p>Search for Calibration Value (Survival Data)</p></a></li>
<li><a href='#lines.rule.bin'><p>Add Stopping Rule Curve to Current Plot (Binary Data)</p></a></li>
<li><a href='#lines.rule.surv'><p>Add Stopping Rule Curve to Current Plot (Survival Data)</p></a></li>
<li><a href='#OC.rule'><p>Operating Characteristics Function</p></a></li>
<li><a href='#OC.rule.bin'><p>Operating Characteristics Function (Binary Data)</p></a></li>
<li><a href='#OC.rule.surv'><p>Operating Characteristics Function (Survival Data)</p></a></li>
<li><a href='#opchars.bin'><p>Operating Characteristics Function (Binary Data)</p></a></li>
<li><a href='#opchars.surv'><p>Operating Characteristics Function (Survival Data)</p></a></li>
<li><a href='#plot.rule.bin'><p>Plot Stopping Rule (Binary Data)</p></a></li>
<li><a href='#plot.rule.surv'><p>Plot Stopping Rule (Survival Data)</p></a></li>
<li><a href='#simdata_weibull'><p>Simulate survival data for safety monitoring under Weibull distribution</p></a></li>
<li><a href='#simtrials.surv'><p>Simulate trials with safety monitoring by survival data stopping rules</p></a></li>
<li><a href='#stopping.prob.surv'><p>Calculating the stopping probability given a rejection boundary (Survival Data)</p></a></li>
<li><a href='#table.rule.bin'><p>Tabulate Stopping Rule (Binary Data)</p></a></li>
<li><a href='#table.rule.surv'><p>Tabulate Stopping Rule (Survival data)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Create and Evaluate Stopping Rules for Safety Monitoring</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael J. Martens &lt;mmartens@mcw.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for creating, displaying, and evaluating stopping rules for safety monitoring in clinical studies.</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, graphics, pracma, matrixStats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-07 03:51:45 UTC; mmartens</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael J. Martens [aut, cre],
  Qinghua Lian [aut],
  Brent R. Logan [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-07 04:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='stoppingrule'>Create and Evaluate Stopping Rules for Safety Monitoring</h2><span id='topic+stoppingrule'></span><span id='topic+stoppingrule-package'></span>

<h3>Description</h3>

<p>Provides functions for creating, displaying, and evaluating stopping rules for safety monitoring in clinical studies.
</p>


<h3>Author(s)</h3>

<p>Michael J. Martens <a href="mailto:mmartens@mcw.edu">mmartens@mcw.edu</a>
</p>

<hr>
<h2 id='bdryfcn'>Stopping Rule Boundary Function</h2><span id='topic+bdryfcn'></span>

<h3>Description</h3>

<p>A wrapper function to calculate the boundary for a given stopping rule for safety monitoring for time-to-event data or binary data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdryfcn(data.type, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bdryfcn_+3A_data.type">data.type</code></td>
<td>
<p>Type of data, choices include 'bin' for binary data and 'surv' for time-to-event data</p>
</td></tr>
<tr><td><code id="bdryfcn_+3A_...">...</code></td>
<td>
<p>Other options to be passed to the corresponding stopping rule calculation. Please refer to the corresponding data type-specific <code>bdryfcn()</code> function for more details</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A univariate function that defines the rejection boundary at any number of evaluable patients (binary data) or amount of follow-up time (time-to-event data)
</p>

<hr>
<h2 id='bdryfcn.bin'>Stopping Rule Boundary Function (Binary Data)</h2><span id='topic+bdryfcn.bin'></span>

<h3>Description</h3>

<p>Calculate the boundary for a given stopping rule
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdryfcn.bin(n, p0, type, cval, param = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bdryfcn.bin_+3A_n">n</code></td>
<td>
<p>Maximum sample size for safety monitoring</p>
</td></tr>
<tr><td><code id="bdryfcn.bin_+3A_p0">p0</code></td>
<td>
<p>The toxicity probability under the null hypothesis</p>
</td></tr>
<tr><td><code id="bdryfcn.bin_+3A_type">type</code></td>
<td>
<p>The method used for constructing the stopping rule. Choices include a Pocock test (&quot;Pocock&quot;), an O'Brien-Fleming test (&quot;OBF&quot;), a Wang-Tsiatis test (&quot;WT&quot;), the Bayesian beta-binomial method (&quot;BB&quot;) proposed by Geller et al. 2003, the Bayesian beta-binomial method (&quot;CC&quot;) proposed by Chen and Chaloner 2006, a truncated SPRT (&quot;SPRT&quot;), and a maximized SPRT (&quot;MaxSPRT&quot;).</p>
</td></tr>
<tr><td><code id="bdryfcn.bin_+3A_cval">cval</code></td>
<td>
<p>Critical value for stopping rule method. For Wang-Tsiatis tests, this is the Delta parameter. For the Bayesian Beta-Binomial method, this is the threshold on the posterior probability. For the truncated SPRT, this is the threshold on the log likelihood ratio. For the MaxSPRT, this is the threshold on the log generalized likelihood ratio.</p>
</td></tr>
<tr><td><code id="bdryfcn.bin_+3A_param">param</code></td>
<td>
<p>A vector of the extra parameter(s) needed for certain stopping rule methods. For binomial Wang-Tsiatis tests, this is the Delta parameter. For the Geller et al. method, this is the vector of hyperparameters (a,b) for the beta prior on the toxicity probability. For Chen and Chaloner's method, this is the vector (a,b,p1,nu), containing the hyperparameters (a,b) for the beta prior on the toxicity probability, the targeted alternative toxicity probability p1, and the threshold nu for the posterior probability that the true toxicity probability p &gt; p1. For truncated SPRT, this is the targeted alternative toxicity probability p1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A univariate function that defines the rejection boundary at any number of evaluable patients
</p>

<hr>
<h2 id='bdryfcn.surv'>Stopping Rule Boundary Function (Survival Data)</h2><span id='topic+bdryfcn.surv'></span>

<h3>Description</h3>

<p>Calculate the boundary for a given stopping rule
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdryfcn.surv(n, p0, type, tau, cval, param = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bdryfcn.surv_+3A_n">n</code></td>
<td>
<p>Maximum sample size for safety monitoring</p>
</td></tr>
<tr><td><code id="bdryfcn.surv_+3A_p0">p0</code></td>
<td>
<p>The probability of a toxicity occurring in <code>tau</code> units of time under the null hypothesis</p>
</td></tr>
<tr><td><code id="bdryfcn.surv_+3A_type">type</code></td>
<td>
<p>The method used for constructing the stopping rule. Choices including a Pocock test (&quot;Pocock&quot;),
a O'Brein-Fleming test (&quot;OBF&quot;), a Wang-Tsiatis test (&quot;WT&quot;), the Bayesian Gamma-Poisson method (&quot;GP&quot;),
a truncated sequential probability ratio test (&quot;SPRT&quot;), and a maximized SPRT (&quot;MaxSPRT&quot;)</p>
</td></tr>
<tr><td><code id="bdryfcn.surv_+3A_tau">tau</code></td>
<td>
<p>Length of observation period</p>
</td></tr>
<tr><td><code id="bdryfcn.surv_+3A_cval">cval</code></td>
<td>
<p>Critical value for the stopping rule. For Wang-Tsiatis tests, this is the Delta parameter. For the Bayesian Gamma-Poisson method, this is the threshold on the posterior probability. For the truncated SPRT, this is the threshold on the log likelihood ratio. For the MaxSPRT, this is the threshold on the log generalized likelihood ratio.</p>
</td></tr>
<tr><td><code id="bdryfcn.surv_+3A_param">param</code></td>
<td>
<p>A vector of the extra parameter(s) needed for certain stopping rule methods. For Wang-Tsiatis tests, this is the Delta parameter. For truncated SPRT, this is the targeted alternative toxicity probability p1. For Bayesian Gamma-Poisson model, this is the vector of hyperparameters (shape,rate) for the gamma prior on the toxicity event rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A univariate function that defines the rejection boundary at any amount of total follow-up time
</p>

<hr>
<h2 id='calc.bnd.bin'>Stopping Boundary Calculation (Binary Data)</h2><span id='topic+calc.bnd.bin'></span>

<h3>Description</h3>

<p>Internal workhorse function to calculate stopping boundary for a given method, treating toxicities as binary data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.bnd.bin(n, p0, type, cval, param)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc.bnd.bin_+3A_n">n</code></td>
<td>
<p>Maximum sample size for safety monitoring</p>
</td></tr>
<tr><td><code id="calc.bnd.bin_+3A_p0">p0</code></td>
<td>
<p>The toxicity probability under the null hypothesis</p>
</td></tr>
<tr><td><code id="calc.bnd.bin_+3A_type">type</code></td>
<td>
<p>The method used for constructing the stopping rule</p>
</td></tr>
<tr><td><code id="calc.bnd.bin_+3A_cval">cval</code></td>
<td>
<p>Critical value for stopping rule method. For Wang-Tsiatis tests, this is the Delta parameter. For the Bayesian Beta-Binomial method, this is the threshold on the posterior probability. For the truncated SPRT, this is the threshold on the log likelihood ratio. For the MaxSPRT, this is the threshold on the log generalized likelihood ratio.</p>
</td></tr>
<tr><td><code id="calc.bnd.bin_+3A_param">param</code></td>
<td>
<p>A vector of the extra parameter(s) needed for certain stopping rule methods. For binomial Wang-Tsiatis tests, this is the Delta parameter. For the Geller et al. method, this is the vector of hyperparameters (a,b) for the beta prior on the toxicity probability. For Chen and Chaloner's method, this is the vector (a,b,p1,nu), containing the hyperparameters (a,b) for the beta prior on the toxicity probability, the targeted alternative toxicity probability p1, and the threshold nu for the posterior probability that the true toxicity probability p &gt; p1. For truncated SPRT, this is the targeted alternative toxicity probability p1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of stopping boundaries at the sample sizes 1, 2, ..., n
</p>

<hr>
<h2 id='calc.bnd.surv'>Stopping Boundary Calculation (Survival Data)</h2><span id='topic+calc.bnd.surv'></span>

<h3>Description</h3>

<p>Internal workhorse function to calculate stopping boundary for a given method for time-to-event data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.bnd.surv(n, p0, type, tau, cval, maxInf = "expected", param = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc.bnd.surv_+3A_n">n</code></td>
<td>
<p>maximum sample size for safety monitoring</p>
</td></tr>
<tr><td><code id="calc.bnd.surv_+3A_p0">p0</code></td>
<td>
<p>The probability of a toxicity occurring in <code>tau</code> units of time under the null hypothesis</p>
</td></tr>
<tr><td><code id="calc.bnd.surv_+3A_type">type</code></td>
<td>
<p>The method used for constructing the stopping rule</p>
</td></tr>
<tr><td><code id="calc.bnd.surv_+3A_tau">tau</code></td>
<td>
<p>Length of observation period</p>
</td></tr>
<tr><td><code id="calc.bnd.surv_+3A_cval">cval</code></td>
<td>
<p>Critical value for the stopping rule. For Wang-Tsiatis tests, this is the Delta parameter. For the Bayesian Gamma-Poisson method, this is the threshold on the posterior probability. For the truncated SPRT, this is the threshold on the log likelihood ratio. For the MaxSPRT, this is the threshold on the log generalized likelihood ratio.</p>
</td></tr>
<tr><td><code id="calc.bnd.surv_+3A_maxinf">maxInf</code></td>
<td>
<p>Specification of the maximum information (maximum exposure time) used for designing the
stopping rule. Options include the expected exposure time for n patients used H0 (&quot;expected&quot;) and the
maximum possible exposure time (&quot;maximum&quot;). Default is &quot;expected&quot; (expected exposure time in cohort).</p>
</td></tr>
<tr><td><code id="calc.bnd.surv_+3A_param">param</code></td>
<td>
<p>A vector of the extra parameter(s) needed for certain stopping rule methods. For Wang-Tsiatis tests, this is the Delta parameter. For truncated SPRT, this is the targeted alternative toxicity probability p1. For Bayesian Gamma-Poisson model, this is the vector of hyperparameters (shape,rate) for the gamma prior on the toxicity event rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of three items: tau, number of events that can trigger a stop, and the corresponding total follow up time.
</p>

<hr>
<h2 id='calc.rule'>Stopping Rule Calculation</h2><span id='topic+calc.rule'></span>

<h3>Description</h3>

<p>A wrapper function to calculate a stopping rule for safety monitoring for time-to-event data or binary data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.rule(data.type, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc.rule_+3A_data.type">data.type</code></td>
<td>
<p>Type of data, choices include 'bin' for binary data and 'surv' for time-to-event data</p>
</td></tr>
<tr><td><code id="calc.rule_+3A_...">...</code></td>
<td>
<p>Other options to be passed to the corresponding stopping rule calculation. Please refer to the corresponding data type-specific <code>calc.rule()</code> function for more details</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Please refer to the corresponding data type-specific <code>calc.rule()</code> function for details on its output
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
calc.rule(data.type="bin",ns=1:50,p0=0.20,alpha=0.10,type="WT",param=0.25)
calc.rule(data.type="surv",n=50,p0=0.20,alpha=0.10,type="WT",tau=100,param=0.25)

## End(Not run)
</code></pre>

<hr>
<h2 id='calc.rule.bin'>Stopping Rule Calculation (Binary Data)</h2><span id='topic+calc.rule.bin'></span>

<h3>Description</h3>

<p>Calculate a stopping rule for safety monitoring, treating toxicities as binary data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.rule.bin(ns, p0, alpha, type, param = NULL, iter = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc.rule.bin_+3A_ns">ns</code></td>
<td>
<p>A vector of sample sizes at which sequential testing is performed</p>
</td></tr>
<tr><td><code id="calc.rule.bin_+3A_p0">p0</code></td>
<td>
<p>The toxicity probability under the null hypothesis</p>
</td></tr>
<tr><td><code id="calc.rule.bin_+3A_alpha">alpha</code></td>
<td>
<p>The desired type I error / false positive rate for the stopping rule</p>
</td></tr>
<tr><td><code id="calc.rule.bin_+3A_type">type</code></td>
<td>
<p>The method used for constructing the stopping rule. Choices include a Pocock test (&quot;Pocock&quot;), an O'Brien-Fleming test (&quot;OBF&quot;), a Wang-Tsiatis test (&quot;WT&quot;), the Bayesian beta-binomial method (&quot;BB&quot;) proposed by Geller et al. 2003, the Bayesian beta-binomial method (&quot;CC&quot;) proposed by Chen and Chaloner 2006, a truncated SPRT (&quot;SPRT&quot;), and a maximized SPRT (&quot;MaxSPRT&quot;).</p>
</td></tr>
<tr><td><code id="calc.rule.bin_+3A_param">param</code></td>
<td>
<p>A vector of the extra parameter(s) needed for certain stopping rule methods. For binomial Wang-Tsiatis tests, this is the Delta parameter. For the Geller et al. method, this is the vector of hyperparameters (a,b) for the beta prior on the toxicity probability. For Chen and Chaloner's method, this is the vector (a,b,p1,nu), containing the hyperparameters (a,b) for the beta prior on the toxicity probability, the targeted alternative toxicity probability p1, and the threshold nu for the posterior probability that the true toxicity probability p &gt; p1. For truncated SPRT, this is the targeted alternative toxicity probability p1.</p>
</td></tr>
<tr><td><code id="calc.rule.bin_+3A_iter">iter</code></td>
<td>
<p>The number of iterations used to search for the boundary</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A rule.bin object, which is a list with the following elements: Rule, a two-column matrix with the sample sizes <code>ns</code> and their corresponding rejection boundaries; <code>ns</code>; <code>p0</code>; <code>alpha</code>; <code>type</code>; <code>param</code>; and cval, the boundary parameter for the rule
</p>


<h3>References</h3>

<p>Chen, C. and Chaloner, K. (2006). A Bayesian stopping rule for a single arm study: With a case study of stem cell transplantation. <em>Statistics in Medicine</em> <strong>25(17)</strong>, 2956-66.
</p>
<p>Geller, N.L., Follman, D., Leifer, E.S. and Carter, S.L. (2003). Design of early trials in stem cell transplantation: a hybrid frequentist-Bayesian approach. <em>Advances in Clinical Trial Biostatistics</em>.
</p>
<p>Goldman, A.I. (1987). Issues in designing sequential stopping rules for monitoring side effects in clinical trials. <em>Controlled Clinical Trials</em>  <strong>8(4)</strong>, 327-37.
</p>
<p>Ivanova, A., Qaqish, B.F. and Schell, M.J. (2005). Continuous toxicity monitoring in phase II trials in oncology. <em>Biometrics</em> <strong>61(2)</strong>, 540-545.
</p>
<p>Kulldorff, M., Davis, R.L., Kolczak, M., Lewis, E., Lieu, T. and Platt, R. (2011). A maximized sequential probability ratio test for drug and vaccine safety surveillance. <em>Sequential Analysis</em> <strong>30(1)</strong>, 58-78.
</p>
<p>Martens, M.J. and Logan, B.R. (2024). Statistical Rules for Safety Monitoring in Clinical Trials. <em>Clinical Trials</em> <strong>21(2)</strong>, 152-161.
</p>
<p>Pocock, S.J. (1977). Group sequential methods in the design and analysis of clinical trials. <em>Biometrika</em> <strong>64(2)</strong>, 191-199.
</p>
<p>Wang, S.K. and Tsiatis, A.A. (1987). Approximately optimal one-parameter boundaries for group sequential trials. <em>Biometrics</em> <strong>193-199</strong>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # Binomial Pocock test in 50 patient cohort at 10% level, expected toxicity
# probability of 20%
calc.rule.bin(ns=1:50,p0=0.20,alpha=0.10,type="Pocock")

# Binomial Wang-Tsiatis test with Delta = 0.25 in 50 patient cohort at 10% level,
# expected toxicity probability of 20%
calc.rule.bin(ns=1:50,p0=0.20,alpha=0.10,type="WT",param=0.25)

# Beta-binomial test of Geller et al. 2003 with hyperparameters (1, 9) in 100
# patient cohort at 5% level, expected toxicity probability of 10%
calc.rule.bin(ns=1:100,p0=0.10,alpha=0.05,type="BB",param=c(1,9))

# Binomial truncated SPRT with p1 = 0.3 in 100 patient cohort at 5% level,
# expected toxicity probability of 10%
calc.rule.bin(ns=1:100,p0=0.10,alpha=0.05,type="SPRT",param=0.3)

## End(Not run)
</code></pre>

<hr>
<h2 id='calc.rule.surv'>Stopping Rule Calculation (Survival Data)</h2><span id='topic+calc.rule.surv'></span>

<h3>Description</h3>

<p>Calculate a stopping rule for safety monitoring for time-to-event data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.rule.surv(n, p0, alpha, type, tau, maxInf = "expected", param = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc.rule.surv_+3A_n">n</code></td>
<td>
<p>Maximum sample size for safety monitoring</p>
</td></tr>
<tr><td><code id="calc.rule.surv_+3A_p0">p0</code></td>
<td>
<p>The probability of a toxicity occurring in <code>tau</code> units of time under the null hypothesis</p>
</td></tr>
<tr><td><code id="calc.rule.surv_+3A_alpha">alpha</code></td>
<td>
<p>The nominal type I error/false positive rate for the stopping rule,
under an assumption that the cumulative number of events follows a Poisson process
over the study duration.</p>
</td></tr>
<tr><td><code id="calc.rule.surv_+3A_type">type</code></td>
<td>
<p>The method used for constructing the stopping rule. Choices including a Pocock test (&quot;Pocock&quot;),
a O'Brein-Fleming test (&quot;OBF&quot;), a Wang-Tsiatis test (&quot;WT&quot;), the Bayesian Gamma-Poisson method (&quot;GP&quot;),
a truncated sequential probability ratio test (&quot;SPRT&quot;), and a maximized SPRT (&quot;MaxSPRT&quot;)</p>
</td></tr>
<tr><td><code id="calc.rule.surv_+3A_tau">tau</code></td>
<td>
<p>Length of observation period</p>
</td></tr>
<tr><td><code id="calc.rule.surv_+3A_maxinf">maxInf</code></td>
<td>
<p>Specification of the maximum information (maximum exposure time) used for designing the
stopping rule. Options include the expected exposure time for n patients used H0 (&quot;expected&quot;) and the
maximum possible exposure time (&quot;maximum&quot;). Default is &quot;expected&quot; (expected exposure time in cohort).</p>
</td></tr>
<tr><td><code id="calc.rule.surv_+3A_param">param</code></td>
<td>
<p>A vector of the extra parameter(s) needed for certain stopping rule methods. For Wang-Tsiatis tests, this is the Delta parameter. For truncated SPRT, this is the targeted alternative toxicity probability p1. For Bayesian Gamma-Poisson model, this is the vector of hyperparameters (shape,rate) for the gamma prior on the toxicity event rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A rule.surv object, which is a list with the following elements: Rule, a two-column matrix with total follow-up times for each stage and their corresponding rejection boundaries; <code>n</code>; <code>p0</code>; <code>alpha</code>; <code>type</code>; <code>tau</code>; <code>param</code>; and cval, the boundary parameter for the rule
</p>


<h3>References</h3>

<p>Martens, M. J., Lian, Q., Geller, N. L., Leifer, E. S., and Logan, B. L. (2024). Sequential monitoring of time-to-event safety endpoints in clinical trials. <em>Clinical Trials</em>, ePub ahead of print.
</p>
<p>Kulldorff, M., Davis, R. L., Kolczak, M., Lewis, E., Lieu, T., and Platt, R. (2011). A maximized sequential probability ratio test for drug and vaccine safety surveillance. <em>Sequential Analysis</em>, <strong>30(1)</strong>, 58–78.
</p>
<p>Zacks, S. and Mukhopadhyay, N. (2006). Exact risks of sequential point estimators of the exponential parameter. <em>Sequential Analysis</em>, <strong>25(2)</strong>, 203–226.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # Survival Pocock test in 50 patient cohort at 10% level, expected toxicity
# probability of 20%, 100 day observation period
calc.rule.surv(n=50,p0=0.20,alpha=0.10,type="Pocock",tau=100)

# Survival Wang-Tsiatis test with Delta = 0.25 in 50 patient cohort at 10% level,
# expected toxicity probability of 20%, 100 day observation period
calc.rule.surv(n=50,p0=0.20,alpha=0.10,type="WT",tau=100,param=0.25)

# Gamma-Poisson test with hyperparameters (1, 1000) in 100 patient cohort at 5% level,
# expected toxicity probability of 10%, 60 day observation period
calc.rule.surv(n=100,p0=0.10,alpha=0.05,type="GP",tau=60,param=c(1,1000))

# Truncated exponential SPRT with p1 = 0.3 in 100 patient cohort at 5% level,
# expected toxicity probability of 10%, 60 day observation period
calc.rule.surv(n=100,p0=0.10,alpha=0.05,type="SPRT",tau=60,param=0.3)

## End(Not run)
</code></pre>

<hr>
<h2 id='findconst.bin'>Search for Calibration Value (Binary Data)</h2><span id='topic+findconst.bin'></span>

<h3>Description</h3>

<p>Internal workhorse function to calculate the calibration constant value that attains level alpha for given method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findconst.bin(ns, p0, alpha, type, l, u, iter = 50, param)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findconst.bin_+3A_ns">ns</code></td>
<td>
<p>A vector of sample sizes at which sequential testing is performed</p>
</td></tr>
<tr><td><code id="findconst.bin_+3A_p0">p0</code></td>
<td>
<p>The toxicity probability under the null hypothesis</p>
</td></tr>
<tr><td><code id="findconst.bin_+3A_alpha">alpha</code></td>
<td>
<p>The desired type I error / false positive rate for the stopping rule</p>
</td></tr>
<tr><td><code id="findconst.bin_+3A_type">type</code></td>
<td>
<p>The method used for constructing the stopping rule</p>
</td></tr>
<tr><td><code id="findconst.bin_+3A_l">l</code></td>
<td>
<p>Lower starting value of bracket for calibration constant</p>
</td></tr>
<tr><td><code id="findconst.bin_+3A_u">u</code></td>
<td>
<p>Upper starting value of bracket for calibration constant</p>
</td></tr>
<tr><td><code id="findconst.bin_+3A_iter">iter</code></td>
<td>
<p>The number of iterations used to search for the boundary</p>
</td></tr>
<tr><td><code id="findconst.bin_+3A_param">param</code></td>
<td>
<p>A vector of the extra parameter(s) needed for certain stopping rule methods. For binomial Wang-Tsiatis tests, this is the Delta parameter. For the Geller et al. method, this is the vector of hyperparameters (a,b) for the beta prior on the toxicity probability. For Chen and Chaloner's method, this is the vector (a,b,p1,nu), containing the hyperparameters (a,b) for the beta prior on the toxicity probability, the targeted alternative toxicity probability p1, and the threshold nu for the posterior probability that the true toxicity probability p &gt; p1. For truncated SPRT, this is the targeted alternative toxicity probability p1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The calibration constant used for subsequent stopping boundary calculation
</p>

<hr>
<h2 id='findconst.surv'>Search for Calibration Value (Survival Data)</h2><span id='topic+findconst.surv'></span>

<h3>Description</h3>

<p>Internal workhorse function to calculate the calibration constant value that attains level alpha for given method for time-to-event data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findconst.surv(n, p0, alpha, type, tau, maxInf = "expected", param = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findconst.surv_+3A_n">n</code></td>
<td>
<p>Maximum sample size for safety monitoring</p>
</td></tr>
<tr><td><code id="findconst.surv_+3A_p0">p0</code></td>
<td>
<p>The probability of a toxicity occurring in <code>tau</code> units of time under the null hypothesis</p>
</td></tr>
<tr><td><code id="findconst.surv_+3A_alpha">alpha</code></td>
<td>
<p>The nominal type I error/false positive rate for the stopping rule,
under an assumption that the cumulative number of events follows a Poisson process
over the study duration.</p>
</td></tr>
<tr><td><code id="findconst.surv_+3A_type">type</code></td>
<td>
<p>The method used for constructing the stopping rule</p>
</td></tr>
<tr><td><code id="findconst.surv_+3A_tau">tau</code></td>
<td>
<p>Length of observation period</p>
</td></tr>
<tr><td><code id="findconst.surv_+3A_maxinf">maxInf</code></td>
<td>
<p>Specification of the maximum information (maximum exposure time) used for designing the
stopping rule. Options include the expected exposure time for n patients used H0 (&quot;expected&quot;) and the
maximum possible exposure time (&quot;maximum&quot;). Default is &quot;expected&quot; (expected exposure time in cohort).</p>
</td></tr>
<tr><td><code id="findconst.surv_+3A_param">param</code></td>
<td>
<p>A vector of the extra parameter(s) needed for certain stopping rule methods. For Wang-Tsiatis tests, this is the Delta parameter. For truncated SPRT, this is the targeted alternative toxicity probability p1. For Bayesian Gamma-Poisson model, this is the vector of hyperparameters (shape,rate) for the gamma prior on the toxicity event rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The calibration constant used for subsequent stopping boundary calculation
</p>

<hr>
<h2 id='lines.rule.bin'>Add Stopping Rule Curve to Current Plot (Binary Data)</h2><span id='topic+lines.rule.bin'></span>

<h3>Description</h3>

<p>Add a binary stopping rule graphically as a curve on current plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rule.bin'
lines(x, smooth = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lines.rule.bin_+3A_x">x</code></td>
<td>
<p>A <code>rule.bin</code> object calculated by <code>calc.rule.bin()</code> function</p>
</td></tr>
<tr><td><code id="lines.rule.bin_+3A_smooth">smooth</code></td>
<td>
<p>Binary indicator of whether stopping rule boundary should be smoothed by linear interpolation between evaluation points</p>
</td></tr>
<tr><td><code id="lines.rule.bin_+3A_...">...</code></td>
<td>
<p>Other options to be passed to generic <code>lines</code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value; function solely modifies current plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # Binomial Pocock test in 50 patient cohort at 10% level, expected toxicity probability of 20%
poc_rule = calc.rule.bin(ns=1:50,p0=0.20,alpha=0.10,type="Pocock")

# Bayesian beta-binomial method of Geller et al. in 50 patient cohort at 10% level,
# expected toxicity probability of 20%
bb_rule = calc.rule.bin(ns=1:50,p0=0.20,alpha=0.10,type="BB",param=c(2,8))

# Plot stopping boundaries for stopping rules
plot(poc_rule,col="blue")
lines(bb_rule,col="red")

## End(Not run)
</code></pre>

<hr>
<h2 id='lines.rule.surv'>Add Stopping Rule Curve to Current Plot (Survival Data)</h2><span id='topic+lines.rule.surv'></span>

<h3>Description</h3>

<p>Add a survival stopping rule graphically as a curve on current plot for time-to-event data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rule.surv'
lines(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lines.rule.surv_+3A_x">x</code></td>
<td>
<p>A <code>rule.surv</code> object calculated by <code>calc.rule.surv()</code> function</p>
</td></tr>
<tr><td><code id="lines.rule.surv_+3A_...">...</code></td>
<td>
<p>Other options to be passed to generic <code>lines()</code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, function solely modifies current plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: poc_rule = calc.rule.surv(n=50,p0=0.20,alpha=0.10,type="Pocock",tau=100)
gp_rule = calc.rule.surv(n=50,p0=0.20,alpha=0.10,type="GP",tau=100,param=c(1,1000))
plot(poc_rule)
lines(gp_rule,col="red")

## End(Not run)
</code></pre>

<hr>
<h2 id='OC.rule'>Operating Characteristics Function</h2><span id='topic+OC.rule'></span>

<h3>Description</h3>

<p>A wrapper function to compute operating characteristics for a stopping rule at a set of toxicity rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OC.rule(data.type, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OC.rule_+3A_data.type">data.type</code></td>
<td>
<p>Type of data, choices include 'bin' for binary data and 'surv' for time-to-event data</p>
</td></tr>
<tr><td><code id="OC.rule_+3A_...">...</code></td>
<td>
<p>Other options to be passed to the corresponding operating characteristics calculation. Please refer to the corresponding <code>OC.rule()</code> function for more details</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Please refer to the corresponding data type-specific <code>OC.rule()</code> function for more details
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: bb_rule = calc.rule(data.type="bin",ns=1:50,p0=0.20,alpha=0.10,type="BB",param=c(2,8))
gp_rule = calc.rule(data.type="surv",n=50,p0=0.20,alpha=0.10,type="GP",tau=60,param=c(1,1000))
OC.rule(data.type="bin",rule=bb_rule,ps=seq(0.1, 0.5, 0.1))
OC.rule(data.type="bin",rule=bb_rule,ps=seq(0.1, 0.5, 0.1),tau=60,A=730)
OC.rule(data.type="surv",rule=gp_rule,ps=seq(0.1, 0.5, 0.1),MC=1000, A=730)

## End(Not run)
</code></pre>

<hr>
<h2 id='OC.rule.bin'>Operating Characteristics Function (Binary Data)</h2><span id='topic+OC.rule.bin'></span>

<h3>Description</h3>

<p>Compute operating characteristics for a stopping rule at a set of toxicity rates. Characteristics calculated include the overall rejection probability, the expected number of patients evaluated, and the expected number of events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OC.rule.bin(rule, ps, tau = NULL, A = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OC.rule.bin_+3A_rule">rule</code></td>
<td>
<p>A <code>rule.bin</code> object calculated by <code>calc.rule.bin()</code> function</p>
</td></tr>
<tr><td><code id="OC.rule.bin_+3A_ps">ps</code></td>
<td>
<p>A vector of toxicity probabilities at which the operating characteristics will be computed</p>
</td></tr>
<tr><td><code id="OC.rule.bin_+3A_tau">tau</code></td>
<td>
<p>Length of observation period</p>
</td></tr>
<tr><td><code id="OC.rule.bin_+3A_a">A</code></td>
<td>
<p>Length of the enrollment period</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>tau</code> and <code>A</code> are specified, the expected number of events includes events among patients who are still pending evaluation at the time of early stopping, computed under an assumption of a random uniform accrual distribution. Otherwise, only events that occurred prior to stopping are included, as the number of events occurring in pending patients depends on <code>tau</code> and <code>A</code>.
</p>


<h3>Value</h3>

<p>A matrix with columns containing the toxicity probabilities <code>ps</code>, the corresponding rejection probabilities, and the corresponding expected number of events. If <code>tau</code> and <code>A</code> are also specified, the expected numbers of enrolled patients and the expected calendar time at the point of stopping/study end are also included.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # Binomial Pocock test in 50 patient cohort at 10% level, expected toxicity probability of 20%
poc_rule = calc.rule.bin(ns=1:50,p0=0.20,alpha=0.10,type="Pocock")

# Bayesian beta-binomial method of Geller et al. in 50 patient cohort at 10% level,
# expected toxicity probability of 20%
bb_rule = calc.rule.bin(ns=1:50,p0=0.20,alpha=0.10,type="BB",param=c(2,8))

# Compute operating characteristics at toxicity probabilities of 20%, 25%, 30%, 35%, and 40%
OC.rule.bin(rule=poc_rule,ps=seq(0.2,0.4,0.05))
OC.rule.bin(rule=bb_rule,ps=seq(0.2,0.4,0.05),tau=30,A=730)

## End(Not run)
</code></pre>

<hr>
<h2 id='OC.rule.surv'>Operating Characteristics Function (Survival Data)</h2><span id='topic+OC.rule.surv'></span>

<h3>Description</h3>

<p>Compute operating characteristics for a stopping rule at a set of toxicity rates.
Characteristics calculated include the overall rejection probability, the expected
number of patients evaluated, and the expected number of events for time-to-event data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OC.rule.surv(rule, ps, MC, A, s = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OC.rule.surv_+3A_rule">rule</code></td>
<td>
<p>A <code>rule.surv</code> object calculated by <code>calc.rule.surv()</code> function</p>
</td></tr>
<tr><td><code id="OC.rule.surv_+3A_ps">ps</code></td>
<td>
<p>A vector of toxicity probabilities at which the operating characteristics will be computed</p>
</td></tr>
<tr><td><code id="OC.rule.surv_+3A_mc">MC</code></td>
<td>
<p>Number of Monte Carlo replicates to simulate for estimating operating characteristics. If <code>MC</code> = 0, a Poisson process assumption on the event process is used to compute operating characteristics.</p>
</td></tr>
<tr><td><code id="OC.rule.surv_+3A_a">A</code></td>
<td>
<p>Length of the enrollment period. Only required if <code>MC</code> &gt; 0.</p>
</td></tr>
<tr><td><code id="OC.rule.surv_+3A_s">s</code></td>
<td>
<p>Shape parameter for the Weibull distribution used to simulate event times. Default is <code>s</code> = 1 (exponential). Only required if <code>MC</code> &gt; 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Operating characteristics are generated either by Monte Carlo estimation or computed
directly under a Poisson process assumption for the event process over time. The
Monte Carlo approach assumes a random uniform accrual distribution and a Weibull
event time distribution with distribution function <code class="reqn">exp(-\lambda * t^s)</code>, so
it requires specification of the enrollment period length and shape parameter
of the event distribution.
</p>


<h3>Value</h3>

<p>A matrix with columns containing the toxicity probabilities <code>ps</code>,
the corresponding rejection probabilities, and the corresponding expected number
of events. If <code>MC</code> is not NULL, the expected number of enrolled patients
and expected calendar time at the point of stopping/study end are also included.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  poc_rule = calc.rule.surv(n=50,p0=0.20,alpha=0.10,type="Pocock",tau=100)
gp_rule = calc.rule.surv(n=50,p0=0.20,alpha=0.10,type="GP",tau=60,param=c(1,1000))
OC.rule.surv(rule=poc_rule,ps=seq(0.2,0.4,0.05),MC=0)
OC.rule.surv(rule=gp_rule,ps=seq(0.2,0.4,0.05),MC=0)

set.seed(82426499)
ps = seq(0.15,0.35,0.05)
wt_rule = calc.rule.surv(n=46,p0=0.15,alpha=0.10,type="WT",tau=100,param=0.25)
OC.rule.surv(rule=wt_rule,ps=ps,MC=1000,A=1095)

p1h = 0.3418071
sp_rule = calc.rule.surv(n=46,p0=0.15,alpha=0.10,type="SPRT",tau=100,param=p1h)
OC.rule.surv(rule=sp_rule,ps=ps,MC=1000,A=1095)

gp_rule = calc.rule.surv(n=46,p0=0.15,alpha=0.10,type="GP",tau=100,
                          param=11.5*c(-log(1-0.15),100))
OC.rule.surv(rule=gp_rule,ps=ps,MC=1000,A=1095)

## End(Not run)
</code></pre>

<hr>
<h2 id='opchars.bin'>Operating Characteristics Function (Binary Data)</h2><span id='topic+opchars.bin'></span>

<h3>Description</h3>

<p>Internal workhorse function to calculate operating characteristics for a given stopping rule and toxicity probability
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opchars.bin(rule, p, tau = NULL, A = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="opchars.bin_+3A_rule">rule</code></td>
<td>
<p>A <code>rule.bin</code> object calculated by <code>calc.rule.bin()</code> function</p>
</td></tr>
<tr><td><code id="opchars.bin_+3A_p">p</code></td>
<td>
<p>The toxicity probability</p>
</td></tr>
<tr><td><code id="opchars.bin_+3A_tau">tau</code></td>
<td>
<p>Length of observation period</p>
</td></tr>
<tr><td><code id="opchars.bin_+3A_a">A</code></td>
<td>
<p>Length of the enrollment period.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the toxicity probability <code>p</code>, and the corresponding rejection probability and expected number of events. If <code>tau</code> and <code>A</code> are also specified, the expected number of enrolled patients and the expected calendar time at the point of stopping/study end are also included.
</p>

<hr>
<h2 id='opchars.surv'>Operating Characteristics Function (Survival Data)</h2><span id='topic+opchars.surv'></span>

<h3>Description</h3>

<p>Internal workhorse function to calculate operating characteristics for a given stopping rule and toxicity probability
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opchars.surv(rule, p, MC, A, s = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="opchars.surv_+3A_rule">rule</code></td>
<td>
<p>A <code>rule.surv</code> object calculated by <code>calc.rule.surv()</code> function</p>
</td></tr>
<tr><td><code id="opchars.surv_+3A_p">p</code></td>
<td>
<p>The toxicity probability</p>
</td></tr>
<tr><td><code id="opchars.surv_+3A_mc">MC</code></td>
<td>
<p>Number of Monte Carlo replicates to simulate for estimating operating characteristics. If <code>MC</code> = 0, a Poisson process assumption on the event process is used to compute operating characteristics.</p>
</td></tr>
<tr><td><code id="opchars.surv_+3A_a">A</code></td>
<td>
<p>Length of the enrollment period. Only required if <code>MC</code> &gt; 0.</p>
</td></tr>
<tr><td><code id="opchars.surv_+3A_s">s</code></td>
<td>
<p>Shape parameter for the Weibull distribution used to simulate event times. Only required if <code>MC</code> &gt; 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the rejection probability <code>p</code>, and the corresponding
rejection probability and number of events. If <code>MC</code> is not NULL, the expected
number of enrolled patients and total follow up time are also included.
</p>

<hr>
<h2 id='plot.rule.bin'>Plot Stopping Rule (Binary Data)</h2><span id='topic+plot.rule.bin'></span>

<h3>Description</h3>

<p>Display a stopping rule graphically as a curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rule.bin'
plot(
  x,
  smooth = TRUE,
  xlim = c(0, max(x$ns)),
  ylim = c(0, max(x$Rule[, 2]) + 1),
  xlab = "# Evaluable",
  ylab = "# Events",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.rule.bin_+3A_x">x</code></td>
<td>
<p>A <code>rule.bin</code> object calculated by <code>calc.rule.bin()</code> function</p>
</td></tr>
<tr><td><code id="plot.rule.bin_+3A_smooth">smooth</code></td>
<td>
<p>Binary indicator of whether stopping rule boundary should be smoothed by linear interpolation between evaluation points</p>
</td></tr>
<tr><td><code id="plot.rule.bin_+3A_xlim">xlim</code></td>
<td>
<p>The x limits (x1, x2) of the plot. Note that x1 &gt; x2 is allowed and leads to a ‘reversed axis’.</p>
</td></tr>
<tr><td><code id="plot.rule.bin_+3A_ylim">ylim</code></td>
<td>
<p>The y limits of the plot.</p>
</td></tr>
<tr><td><code id="plot.rule.bin_+3A_xlab">xlab</code></td>
<td>
<p>The title for the x axis</p>
</td></tr>
<tr><td><code id="plot.rule.bin_+3A_ylab">ylab</code></td>
<td>
<p>The title for the y axis</p>
</td></tr>
<tr><td><code id="plot.rule.bin_+3A_...">...</code></td>
<td>
<p>Other options to be passed to generic <code>plot</code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value; function solely generates a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # Binomial Pocock test in 50 patient cohort at 10% level, expected toxicity probability of 20%
poc_rule = calc.rule.bin(ns=1:50,p0=0.20,alpha=0.10,type="Pocock")

# Bayesian beta-binomial method of Geller et al. in 50 patient cohort at 10% level,
# expected toxicity probability of 20%
bb_rule = calc.rule.bin(ns=1:50,p0=0.20,alpha=0.10,type="BB",param=c(2,8))

# Plot stopping boundary with smoothing
plot(poc_rule,col="blue")
lines(bb_rule,col="red")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.rule.surv'>Plot Stopping Rule (Survival Data)</h2><span id='topic+plot.rule.surv'></span>

<h3>Description</h3>

<p>Display a stopping rule graphically as a curve for time-to-event data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rule.surv'
plot(
  x,
  xlim = c(0, max(x$Rule[, 1])),
  ylim = c(0, max(x$Rule[, 2]) + 1),
  xlab = "Total Exposure Time",
  ylab = "# Events",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.rule.surv_+3A_x">x</code></td>
<td>
<p>A <code>rule.surv</code> object calculated by <code>calc.rule.surv()</code> function</p>
</td></tr>
<tr><td><code id="plot.rule.surv_+3A_xlim">xlim</code></td>
<td>
<p>The x limits (x1, x2) of the plot. Note that x1 &gt; x2 is allowed and leads to a ‘reversed axis’.</p>
</td></tr>
<tr><td><code id="plot.rule.surv_+3A_ylim">ylim</code></td>
<td>
<p>The y limits of the plot.</p>
</td></tr>
<tr><td><code id="plot.rule.surv_+3A_xlab">xlab</code></td>
<td>
<p>The title for the x axis</p>
</td></tr>
<tr><td><code id="plot.rule.surv_+3A_ylab">ylab</code></td>
<td>
<p>The title for the y axis</p>
</td></tr>
<tr><td><code id="plot.rule.surv_+3A_...">...</code></td>
<td>
<p>Other parameters passed to the <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value; function solely generates a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: poc_rule = calc.rule.surv(n=50,p0=0.20,alpha=0.10,type="Pocock",tau=100)
gp_rule = calc.rule.surv(n=50,p0=0.20,alpha=0.10,type="GP",tau=100,param=c(1,1000))
plot(poc_rule)
lines(gp_rule,col="red")

## End(Not run)
</code></pre>

<hr>
<h2 id='simdata_weibull'>Simulate survival data for safety monitoring under Weibull distribution</h2><span id='topic+simdata_weibull'></span>

<h3>Description</h3>

<p>Internal function to simulate survival data from Weibull distribution for evaluating safety
monitoring rules. A random sample of size <code>n</code> is generated from a Weibull
distribution with shape parameter <code>s</code> to attain a toxicity rate of <code>p</code> at
survival time <code>tau</code>. Enrollment times are also simulated over an accrual period
of duration <code>A</code> under a uniform (0,<code>A</code>) distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simdata_weibull(n, p, tau, A, s = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simdata_weibull_+3A_n">n</code></td>
<td>
<p>Maximum sample size for safety monitoring</p>
</td></tr>
<tr><td><code id="simdata_weibull_+3A_p">p</code></td>
<td>
<p>The probability of a toxicity occurring in <code>tau</code> units of time under the null hypothesis</p>
</td></tr>
<tr><td><code id="simdata_weibull_+3A_tau">tau</code></td>
<td>
<p>Length of observation period</p>
</td></tr>
<tr><td><code id="simdata_weibull_+3A_a">A</code></td>
<td>
<p>Length of accrual period</p>
</td></tr>
<tr><td><code id="simdata_weibull_+3A_s">s</code></td>
<td>
<p>Shape parameter for the Weibull distribution; default value is 1
(exponential distribution)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with two columns: patient enrollment time and event time
</p>

<hr>
<h2 id='simtrials.surv'>Simulate trials with safety monitoring by survival data stopping rules</h2><span id='topic+simtrials.surv'></span>

<h3>Description</h3>

<p>Internal workhorse function used to simulate trials with safety monitoring by
survival data stopping rules. The provided stopping <code>rule</code> is used for
monitoring of <code>MC</code> simulated trials. For each trial, a random sample is
generated from a Weibull distribution with shape parameter <code>s</code> to attain
a toxicity rate of <code>p</code>. Enrollment times are simulated over an accrual
period of duration <code>A</code> under a uniform (0,<code>A</code>) distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simtrials.surv(rule, p, MC, A, s = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simtrials.surv_+3A_rule">rule</code></td>
<td>
<p>A <code>rule.surv</code> object with the safety stopping rule for evaluation</p>
</td></tr>
<tr><td><code id="simtrials.surv_+3A_p">p</code></td>
<td>
<p>The probability of a toxicity occurring in <code>tau</code> units of time
under the null hypothesis</p>
</td></tr>
<tr><td><code id="simtrials.surv_+3A_mc">MC</code></td>
<td>
<p>Number of Monte Carlo replicated datasets to simulate</p>
</td></tr>
<tr><td><code id="simtrials.surv_+3A_a">A</code></td>
<td>
<p>Length of accrual period</p>
</td></tr>
<tr><td><code id="simtrials.surv_+3A_s">s</code></td>
<td>
<p>Shape parameter for the Weibull distribution; default value is 1
(exponential distribution)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with <code>MC</code> rows and 14 columns, one row per simulated
trial. Columns include the stopping rule type and design parameters,
the numbers of events and enrolled patients, the total follow-up time
in the cohort, the calendar time when the study ends, the reject/no reject
decision, and the last stage of monitoring reached when the study ends.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(13)
wt_rule = calc.rule.surv(n=46,p0=0.15,alpha=0.10,type="WT",tau=100,param=0.25)
sims = simtrials.surv(rule=wt_rule,p=0.15,MC=1000,A=1095)
c(mean(sims$stopped),mean(sims$n.Toxicity),mean(sims$n.Enrolled),mean(sims$Calendar.Time))
sims = simtrials.surv(rule=wt_rule,p=0.35,MC=1000,A=1095)
c(mean(sims$stopped),mean(sims$n.Toxicity),mean(sims$n.Enrolled),mean(sims$Calendar.Time))

gp_rule = calc.rule.surv(n=46,p0=0.15,alpha=0.10,type="GP",tau=100,param=11.5*c(-log(1-0.15),100))
sims = simtrials.surv(rule=gp_rule,p=0.15,MC=1000,A=1095)
c(mean(sims$stopped),mean(sims$n.Toxicity),mean(sims$n.Enrolled),mean(sims$Calendar.Time))
sims = simtrials.surv(rule=gp_rule,p=0.35,MC=1000,A=1095)
c(mean(sims$stopped),mean(sims$n.Toxicity),mean(sims$n.Enrolled),mean(sims$Calendar.Time))

## End(Not run)
</code></pre>

<hr>
<h2 id='stopping.prob.surv'>Calculating the stopping probability given a rejection boundary (Survival Data)</h2><span id='topic+stopping.prob.surv'></span>

<h3>Description</h3>

<p>Internal workhouse function to calculate the stopping probability given a rejection boundary for time-to-event data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stopping.prob.surv(bnd, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stopping.prob.surv_+3A_bnd">bnd</code></td>
<td>
<p>A list object calculated by <code>calc.bnd.surv</code> function</p>
</td></tr>
<tr><td><code id="stopping.prob.surv_+3A_p">p</code></td>
<td>
<p>True toxicity probability</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of three: stopping probabilities at each stage, total stopping probability, and non-stopping probabilities of each possible number of events at the last stage.
</p>

<hr>
<h2 id='table.rule.bin'>Tabulate Stopping Rule (Binary Data)</h2><span id='topic+table.rule.bin'></span>

<h3>Description</h3>

<p>Summarize a stopping rule in a condensed tabular format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>table.rule.bin(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="table.rule.bin_+3A_x">x</code></td>
<td>
<p>A <code>rule.bin</code> object calculated by <code>calc.rule.bin()</code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with two columns: the ranges of evaluable patients, and corresponding rejection boundaries for these ranges
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Binomial Pocock test in 50 patient cohort at 10% level, expected toxicity probability of 20%
## Not run: poc_rule = calc.rule.bin(ns=1:50,p0=0.20,alpha=0.10,type="Pocock")

# Tabulate stopping boundary
table.rule.bin(poc_rule)

## End(Not run)
</code></pre>

<hr>
<h2 id='table.rule.surv'>Tabulate Stopping Rule (Survival data)</h2><span id='topic+table.rule.surv'></span>

<h3>Description</h3>

<p>Summarize a stopping rule in a condensed tabular format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>table.rule.surv(rule, dec = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="table.rule.surv_+3A_rule">rule</code></td>
<td>
<p>A <code>rule.surv</code> object calculated by <code>calc.rule.surv()</code> function</p>
</td></tr>
<tr><td><code id="table.rule.surv_+3A_dec">dec</code></td>
<td>
<p>Number of decimal places to which the stagewise total follow-up times should be rounded</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with two columns: total follow up time and their corresponding rejection boundary
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: gp_rule = calc.rule.surv(n=50,p0=0.20,alpha=0.10,type="GP",tau=100,param=c(1,1000))
table.rule.surv(gp_rule,2)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
