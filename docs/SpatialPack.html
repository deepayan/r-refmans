<!DOCTYPE html><html><head><title>Help for package SpatialPack</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SpatialPack}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#clipping'><p>Clipping image</p></a></li>
<li><a href='#codisp'><p>Codispersion Coefficient</p></a></li>
<li><a href='#cor.spatial'><p>Tjostheim's Coefficient</p></a></li>
<li><a href='#CQ'><p>Codispersion based similarity index</p></a></li>
<li><a href='#denoise'><p>Remove noise from an image</p></a></li>
<li><a href='#imnoise'><p>Add noise to image</p></a></li>
<li><a href='#modified.Ftest'><p>Modified F test</p></a></li>
<li><a href='#modified.ttest'><p>Modified t test</p></a></li>
<li><a href='#murray'><p>The Murray smelter site dataset</p></a></li>
<li><a href='#normalize'><p>Normalization for a matrix</p></a></li>
<li><a href='#radiata'><p>The Pinus Radiata dataset</p></a></li>
<li><a href='#RGB2gray'><p>Convert RGB image or colormap to grayscale image</p></a></li>
<li><a href='#SSIM'><p>Structural similarity index</p></a></li>
<li><a href='#texmos2'><p>USC texture mosaic number 2</p></a></li>
<li><a href='#twelve'><p>Ishihara plate number 1</p></a></li>
<li><a href='#wheat'><p>Brodatz texture image, Straw (D15)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Assessment the Association Between Two Spatial
Processes</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-08-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Felipe Osorio <a href="https://orcid.org/0000-0002-4675-5201"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Ronny Vallejos <a href="https://orcid.org/0000-0001-5519-0946"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Francisco Cuevas [ctb],
  Diego Mancilla [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Felipe Osorio &lt;felipe.osorios@usm.cl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools to assess the association between two spatial processes. Currently,
  several methodologies are implemented: A modified t-test to perform hypothesis testing
  about the independence between the processes, a suitable nonparametric correlation
  coefficient, the codispersion coefficient, and an F test for assessing the multiple
  correlation between one spatial process and several others. Functions for image
  processing and computing the spatial association between images are also provided.
  Functions contained in the package are intended to accompany Vallejos, R., Osorio, F.,
  Bevilacqua, M. (2020). Spatial Relationships Between Two Georeferenced Variables:
  With Applications in R. Springer, Cham &lt;<a href="https://doi.org/10.1007%2F978-3-030-56681-4">doi:10.1007/978-3-030-56681-4</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0), fastmatrix</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>fastmatrix</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://spatialpack.mat.utfsm.cl">http://spatialpack.mat.utfsm.cl</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-18 20:12:18 UTC; felipe</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-19 13:00:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='clipping'>Clipping image</h2><span id='topic+clipping'></span>

<h3>Description</h3>

<p>This function returns the image which restricts pixel value from the specified range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clipping(img, low = 0, high = 1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clipping_+3A_img">img</code></td>
<td>
<p>input grayscale image matrix.</p>
</td></tr>
<tr><td><code id="clipping_+3A_low">low</code></td>
<td>
<p>lowest value.</p>
</td></tr>
<tr><td><code id="clipping_+3A_high">high</code></td>
<td>
<p>highest value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>grayscale image matrix with the same size as <code>img</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(texmos2)
plot(as.raster(texmos2))

# the appearance of next one doesn't change because of normalization
x &lt;- normalize(2 * texmos2)
plot(as.raster(x))
title(main = "Doubled pixel value with normalization", font.main = 1)

# the next one is saturated as expected
x &lt;- clipping(2 * texmos2)
plot(as.raster(x))
title(main = "Doubled pixel value with clipping", font.main = 1)
</code></pre>

<hr>
<h2 id='codisp'>Codispersion Coefficient</h2><span id='topic+codisp'></span>

<h3>Description</h3>

<p>Computes the codispersion coefficient between two spatial variables for a given
number of classes for the lag distance.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  codisp(x, y, coords, nclass = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="codisp_+3A_x">x</code></td>
<td>
<p>an <code class="reqn">n</code>-dimensional vector of data values.</p>
</td></tr>
<tr><td><code id="codisp_+3A_y">y</code></td>
<td>
<p>an <code class="reqn">n</code>-dimensional vector of data values.</p>
</td></tr>
<tr><td><code id="codisp_+3A_coords">coords</code></td>
<td>
<p>an <code class="reqn">n</code>-by-2 matrix containing coordinates of the <code class="reqn">n</code> data
locations in each row.</p>
</td></tr>
<tr><td><code id="codisp_+3A_nclass">nclass</code></td>
<td>
<p>a single number giving the number of cells for the codispersion
coefficient. The default is 13. If this argument is <code>NULL</code> Sturges' formula is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The procedure computes the codispersion coefficient for two spatial sequences
defined on general (non-rectangular) grids. First, a given number of bins are
constructed for the lag distance. Then the codispersion is computed for each bin.
</p>


<h3>Value</h3>

<p>A list with class <code>"codisp"</code> containing the following components:
</p>
<table>
<tr><td><code>coef</code></td>
<td>
<p>a vector of size <code>nclass</code> containing the values of the codispersion
coefficient.</p>
</td></tr>
<tr><td><code>upper.bounds</code></td>
<td>
<p>upper bounds of the intervals constructed to compute the
codispersion coefficient.</p>
</td></tr>
<tr><td><code>card</code></td>
<td>
<p>number of elements in each interval generated to compute the
codispersion coefficient.</p>
</td></tr>
</table>
<p>The function <code>plot</code> can be used to obtain a graph of the codispersion coefficient
versus the lag distance.
</p>


<h3>References</h3>

<p>Matheron, G. (1965),
<em>Les Variables Regionalisees et leur Estimation</em>.
Masson, Paris.
</p>
<p>Rukhin, A., Vallejos, R. (2008),
Codispersion coefficient for spatial and temporal series.
<em>Statistics and Probability Letters</em> <b>78</b>, 1290-1300.
</p>
<p>Vallejos, R. (2008).
Assessing the association between two spatial or temporal sequences.
<em>Journal of Applied Statistics</em> <b>35</b>, 1323-1343.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Murray Smelter site dataset
data(murray)

# defining the arsenic (As) and lead (Pb) variables from the murray dataset
x &lt;- murray$As
y &lt;- murray$Pb

# extracting the coordinates from Murray dataset
coords &lt;- murray[c("xpos","ypos")]

# computing the codispersion coefficient
z &lt;- codisp(x, y, coords)
z

## plotting the codispersion coefficient vs. the lag distance
plot(z)

# Comovement between two time series representing the monthly deaths
# from bronchitis, emphysema and asthma in the UK for 1974-1979
x &lt;- mdeaths
y &lt;- fdeaths
coords &lt;- cbind(1:72, rep(1,72))
z &lt;- codisp(x, y, coords)

# plotting codispersion and cross-correlation functions
par(mfrow = c(1,2))
ccf(x, y, ylab = "cross-correlation", max.lag = 20)
plot(z)
</code></pre>

<hr>
<h2 id='cor.spatial'>Tjostheim's Coefficient</h2><span id='topic+cor.spatial'></span>

<h3>Description</h3>

<p>Computes Tjostheim's coefficient for two spatial sequences observed over the same
locations on the plane.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  cor.spatial(x, y, coords)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor.spatial_+3A_x">x</code></td>
<td>
<p>an <code class="reqn">n</code>-dimensional vector of data values.</p>
</td></tr>
<tr><td><code id="cor.spatial_+3A_y">y</code></td>
<td>
<p>an <code class="reqn">n</code>-dimensional vector of data values.</p>
</td></tr>
<tr><td><code id="cor.spatial_+3A_coords">coords</code></td>
<td>
<p>an <code class="reqn">n</code>-by-2 matrix containing coordinates of the <code class="reqn">n</code> data
locations in each row.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implemented  technique is a nonparametric coefficient that summarizes the
association between two spatial variables. This coefficient was first introduced
by Tjostheim (1978) and later generalized by Hubert and Golledge (1992). The
computation of the coefficient is based on the construction of ranks associated
to suitable modifications of the coordinates. Tjostheim's coefficient is a variant
of the correlation coefficient (<code><a href="stats.html#topic+cor">cor</a></code>) to be used in a spatial statistics
context.
</p>


<h3>Value</h3>

<p>Tjostheim's coefficient. The variance is returned as the attribute <code>"variance"</code>.
</p>


<h3>References</h3>

<p>Tjostheim, D., (1978),
A measure of association for spatial variables.
<em>Biometrika</em> <b>65</b>, 109-114.
</p>
<p>Hubert, L., Golledge, R.G., (1982),
Measuring association between spatially defined variables: Tjostheim's coefficient index and some extensions.
<em>Geographical Analysis</em> <b>14</b>, 273-278.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Murray Smelter site dataset
data(murray)

# defining the arsenic (As) and lead (Pb) variables from the murray dataset
x &lt;- murray$As
y &lt;- murray$Pb

# extracting the coordinates from Murray dataset
coords &lt;- murray[c("xpos","ypos")]

# computing Tjostheim's coefficient
z &lt;- cor.spatial(x, y, coords)
z
</code></pre>

<hr>
<h2 id='CQ'>Codispersion based similarity index</h2><span id='topic+CQ'></span>

<h3>Description</h3>

<p>This function computes a similarity index (CQ) based on the codispersion coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CQ(x, y, h = c(0,1), eps = c(0.01, 0.03), L = 255)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CQ_+3A_x">x</code></td>
<td>
<p>reference image matrix (grayscale)</p>
</td></tr>
<tr><td><code id="CQ_+3A_y">y</code></td>
<td>
<p>distorted image matrix (grayscale)</p>
</td></tr>
<tr><td><code id="CQ_+3A_h">h</code></td>
<td>
<p>2-dimensional vector of the spatial lag. Default value is <code>h = c(0,1)</code>.</p>
</td></tr>
<tr><td><code id="CQ_+3A_eps">eps</code></td>
<td>
<p>rescaling constants, by default <code>eps = c(0.01, 0.03)</code></p>
</td></tr>
<tr><td><code id="CQ_+3A_l">L</code></td>
<td>
<p>dynamic range of the images, by default <code>L = 255</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>CQ</code></td>
<td>
<p>codispersion based similarity index between images <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code>direction</code></td>
<td>
<p>vector of spatial lag.</p>
</td></tr>
<tr><td><code>comps</code></td>
<td>
<p>components of <code>CQ</code>, that is <code>luminance</code>, <code>contrast</code> and <code>codispersion</code></p>
</td></tr>
<tr><td><code>stats</code></td>
<td>
<p>sample statistics (means, variances and covariance) for each image.</p>
</td></tr>
<tr><td><code>speed</code></td>
<td>
<p>Running time taken by the procedure.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ojeda, S.M., Lamberti, P.W., Vallejos, R. (2012).
Measure of similarity between images based on the codispersion coefficient.
<em>Journal of Electronic Imaging</em> <b>21</b>, 023019.
</p>
<p>Vallejos, R., Mancilla, D., Acosta, J. (2016).
Image similarity assessment based on coefficients of spatial association.
<em>Journal of Mathematical Imaging and Vision</em> <b>56</b>, 77-98.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(texmos2)

y &lt;- imnoise(texmos2, type = "gaussian")
plot(as.raster(y))
o &lt;- CQ(texmos2, y, h = c(0,1))
o

y &lt;- imnoise(texmos2, type = "speckle")
plot(as.raster(y))
o &lt;- CQ(texmos2, y, h = c(0,1))
o
</code></pre>

<hr>
<h2 id='denoise'>Remove noise from an image</h2><span id='topic+denoise'></span>

<h3>Description</h3>

<p>This function removes noise from an input image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>denoise(img, type = "Lee", looks = 1, damping = 1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="denoise_+3A_img">img</code></td>
<td>
<p>input grayscale image matrix.</p>
</td></tr>
<tr><td><code id="denoise_+3A_type">type</code></td>
<td>
<p>character string, specifying the type of filter: <code>"median"</code>,
<code>"Lee"</code>, <code>"enhanced"</code> (enhanced Lee filter), <code>"Kuan"</code> and <code>"Nathan"</code>.</p>
</td></tr>
<tr><td><code id="denoise_+3A_looks">looks</code></td>
<td>
<p>specifies the equivalent (or effective) number of looks used to estimate
noise variance, and it effectively controls the amount of smoothing applied to the
image by the filter. A smaller value leads to more smoothing; a larger value preserves
more distinct image features. The default value is <code>looks = 1</code>.</p>
</td></tr>
<tr><td><code id="denoise_+3A_damping">damping</code></td>
<td>
<p>specifies the extent of exponential damping effect on filtering,
by default <code>damping = 1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The median filter, in which each pixel is replaced by the median of nearby values is
suitable to remove additive noise from an image.
</p>
<p>The Lee filter reduces the speckle noise by applying a spatial filter to each pixel
in an image, which filters the data based on local statistics calculated within a
square window. The value of the center pixel is replaced by a value calculated
using the neighboring pixels. Use the Lee filter to smooth speckled data that has
a multiplicative component.
</p>
<p>The Enhanced Lee filter is a refined version of the Lee filter, reducing the speckle
noise effectively by preserving image sharpness and detail. Use the Enhanced Lee filter
to reduce speckle while preserving texture information.
</p>
<p>The Kuan filter follows a similar filtering process to the Lee filter in reducing
speckle noise. This filter also applies a spatial filter to each pixel in an image,
filtering the data based on local statistics of the centered pixel value that is
calculated using the neighboring pixels.
</p>
<p>Nathan filter is a particular case of the Kuan filter, obtained by puting <code>looks
  = 1</code>, and is thus applicable to 1-look SAR images only.
</p>
<p>The size of the pixel window used to each filter is 3-by-3.
</p>


<h3>Value</h3>

<p>Filtered image, returned as a numeric matrix. It allows a better image interpretation.
The <code>denoise</code> function clips output pixel values to the range <code class="reqn">[0,1]</code> after
removing the noise.
</p>


<h3>References</h3>

<p>Lee, J.S. (1980).
Digital image enhancement and noise filtering by use of local statistics.
<em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em> PAMI-2, 165-168.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(texmos2)
  x &lt;- imnoise(texmos2, type = "saltnpepper", epsilon = 0.10)
  plot(as.raster(x))

  y &lt;- denoise(x, type = "median")
  plot(as.raster(y))

  x &lt;- imnoise(texmos2, type = "speckle")
  plot(as.raster(x))

  y &lt;- denoise(x, type = "Lee")
  plot(as.raster(y))
</code></pre>

<hr>
<h2 id='imnoise'>Add noise to image</h2><span id='topic+imnoise'></span>

<h3>Description</h3>

<p>This function adds noise to an input image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imnoise(img, type = "gaussian", mean = 0, sd = 0.01, epsilon = 0.05, var = 0.04,
       looks = 1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="imnoise_+3A_img">img</code></td>
<td>
<p>input grayscale image matrix.</p>
</td></tr>
<tr><td><code id="imnoise_+3A_type">type</code></td>
<td>
<p>character string, specifying the type of contamination: <code>"gaussian"</code>
(Gaussian white/additive noise), <code>"saltnpepper"</code> (salt and pepper noise or on-off noise),
<code>"speckle"</code> (uniform multiplicative noise) and <code>"gamma"</code> (gamma multiplicative noise).</p>
</td></tr>
<tr><td><code id="imnoise_+3A_mean">mean</code></td>
<td>
<p>mean for the Gaussian noise, default value is <code>mean = 0</code>.</p>
</td></tr>
<tr><td><code id="imnoise_+3A_sd">sd</code></td>
<td>
<p>standard deviation for the Gaussian noise, default value is <code>sd = 0.01</code>.</p>
</td></tr>
<tr><td><code id="imnoise_+3A_epsilon">epsilon</code></td>
<td>
<p>contamination percentage for the salt and pepper noise with default noise
density <code>0.05</code>. This affects approximately <code>epsilon</code>% of pixels.</p>
</td></tr>
<tr><td><code id="imnoise_+3A_var">var</code></td>
<td>
<p>variance of uniform multiplicative noise using the equation <code class="reqn">noise = img + unif * img</code>,
with <code class="reqn">unif</code> is uniformly distributed with mean <code class="reqn">0</code> and variance <code>var</code>. Default value
is <code>var = 0.04</code>.</p>
</td></tr>
<tr><td><code id="imnoise_+3A_looks">looks</code></td>
<td>
<p>parameter of gamma multiplicative noise. The default value is <code>looks = 1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Noisy image, returned as a numeric matrix. The <code>imnoise</code> function clips output
pixel values to the range <code class="reqn">[0,1]</code> after adding noise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(texmos2)
  x &lt;- imnoise(texmos2, type = "saltnpepper", epsilon = 0.10)
  plot(as.raster(x))

  y &lt;- imnoise(texmos2, type = "speckle")
  plot(as.raster(y))

  z &lt;- imnoise(texmos2, type = "gamma", looks = 4)
  plot(as.raster(z))
</code></pre>

<hr>
<h2 id='modified.Ftest'>Modified F test</h2><span id='topic+modified.Ftest'></span>

<h3>Description</h3>

<p>Performs a modified version of the <em>F</em> test to assess the multiple correlation
between one spatial processes and several others.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  modified.Ftest(x, y, coords, nclass = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modified.Ftest_+3A_x">x</code></td>
<td>
<p>an <code class="reqn">n</code>-by-<code class="reqn">q</code> matrix of data values.</p>
</td></tr>
<tr><td><code id="modified.Ftest_+3A_y">y</code></td>
<td>
<p>an <code class="reqn">n</code>-dimensional vector of data values.</p>
</td></tr>
<tr><td><code id="modified.Ftest_+3A_coords">coords</code></td>
<td>
<p>an <code class="reqn">n</code>-by-2 matrix containing coordinates of the <code class="reqn">n</code> data
locations in each row.</p>
</td></tr>
<tr><td><code id="modified.Ftest_+3A_nclass">nclass</code></td>
<td>
<p>a single number giving the number of cells for Moran's index.
The default is 13. If this argument is <code>NULL</code> Sturges' formula us used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methodology implemented is a modified <em>F</em> test for assessing the multiple
correlation between one spatial process and several others. The test is based on
corrections of the multiple correlation coefficient between the two spatially
correlated sequences and required the estimation of an effective sample size.
This factor takes into account the spatial association of both processes.
</p>


<h3>Value</h3>

<p>A list with class <code>"mod.Ftest"</code> containing the following components:
</p>
<table>
<tr><td><code>corr</code></td>
<td>
<p>the sample correlation coefficient.</p>
</td></tr>
<tr><td><code>ESS</code></td>
<td>
<p>the estimated effective sample size.</p>
</td></tr>
<tr><td><code>Fstat</code></td>
<td>
<p>the value of the (unscaled) <em>F</em>-statistic.</p>
</td></tr>
<tr><td><code>df1</code>, <code>df2</code></td>
<td>
<p>degrees of freedom for the <em>F</em>-statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the <em>p</em>-value for the test.</p>
</td></tr>
<tr><td><code>upper.bounds</code></td>
<td>
<p>upper bounds of the intervals constructed to compute Moran's <em>I</em>.</p>
</td></tr>
<tr><td><code>card</code></td>
<td>
<p>number of elements in each interval generated to compute Moran's <em>I</em>.</p>
</td></tr>
<tr><td><code>imoran</code></td>
<td>
<p>a matrix containing Moran's index for each interval associated with
the response and predicted variables.</p>
</td></tr>
</table>
<p>The generic functions <code>print</code> and <code>summary</code> are used to obtain
and print additional details about the modified <em>F</em> test.
</p>


<h3>References</h3>

<p>Dutilleul, P., Pelletier, B., Alpargu, G. (2008).
Modified <em>F</em> tests for assessing the multiple correlation between one spatial
process and several others.
<em>Journal of Statistical Planning and Inference</em> <b>138</b>, 1402-1415.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The Pinus Radiata data set
data(radiata)

# defining the response and predictor variables from the radiata data set
y &lt;- radiata$height
x &lt;- radiata[c("basal","altitude","slope")]

# extracting the coordinates from the radiata data set
coords &lt;- radiata[c("xpos","ypos")]

# computing the modified F-test of spatial association
z &lt;- modified.Ftest(x, y, coords)
z

# display the upper bounds, cardinality and the computed Moran's index
summary(z)
</code></pre>

<hr>
<h2 id='modified.ttest'>Modified t test</h2><span id='topic+modified.ttest'></span>

<h3>Description</h3>

<p>Performs a modified version of the <em>t</em> test to assess the correlation between
two spatial processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  modified.ttest(x, y, coords, nclass = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modified.ttest_+3A_x">x</code></td>
<td>
<p>an <code class="reqn">n</code>-dimensional vector of data values.</p>
</td></tr>
<tr><td><code id="modified.ttest_+3A_y">y</code></td>
<td>
<p>an <code class="reqn">n</code>-dimensional vector of data values.</p>
</td></tr>
<tr><td><code id="modified.ttest_+3A_coords">coords</code></td>
<td>
<p>an <code class="reqn">n</code>-by-2 matrix containing coordinates of the <code class="reqn">n</code> data
locations in each row.</p>
</td></tr>
<tr><td><code id="modified.ttest_+3A_nclass">nclass</code></td>
<td>
<p>a single number giving the number of cells for Moran's index.
The default is 13. If this argument is <code>NULL</code> Sturges' formula us used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methodology implemented is a modified <em>t</em> test of spatial association
based on the work of Clifford and Richardson (1989). The test is based on
corrections of the sample correlation coefficient between the two spatially
correlated sequences and required the estimation of an effective sample size.
This factor takes into account the spatial association of both processes.
</p>


<h3>Value</h3>

<p>A list with class <code>"mod.ttest"</code> containing the following components:
</p>
<table>
<tr><td><code>corr</code></td>
<td>
<p>the sample correlation coefficient.</p>
</td></tr>
<tr><td><code>ESS</code></td>
<td>
<p>the estimated effective sample size.</p>
</td></tr>
<tr><td><code>Fstat</code></td>
<td>
<p>the value of the (unscaled) <em>F</em>-statistic.</p>
</td></tr>
<tr><td><code>dof</code></td>
<td>
<p>the estimated degrees of freedom for the <em>F</em>-statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the <em>p</em>-value for the test.</p>
</td></tr>
<tr><td><code>upper.bounds</code></td>
<td>
<p>upper bounds of the intervals constructed to compute Moran's <em>I</em>.</p>
</td></tr>
<tr><td><code>card</code></td>
<td>
<p>number of elements in each interval generated to compute Moran's <em>I</em>.</p>
</td></tr>
<tr><td><code>imoran</code></td>
<td>
<p>a matrix containing Moran's index for each interval associated with
both variables.</p>
</td></tr>
</table>
<p>The generic functions <code>print</code> and <code>summary</code> are used to obtain
and print additional details about the modified <em>t</em> test.
</p>


<h3>References</h3>

<p>Clifford, P., Richardson, S., Hemon, D. (1989).
Assessing the significance of the correlation between two spatial processes.
<em>Biometrics</em> <b>45</b>, 123-134.
</p>
<p>Dutilleul, P. (1993).
Modifying the <em>t</em> test for assessing the correlation between two spatial processes.
<em>Biometrics</em> <b>49</b>, 305-314.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Murray Smelter site dataset
data(murray)

# defining the arsenic (As) and lead (Pb) variables from the murray dataset
x &lt;- murray$As
y &lt;- murray$Pb

# extracting the coordinates from Murray dataset
coords &lt;- murray[c("xpos","ypos")]

# computing the modified t-test of spatial association
z &lt;- modified.ttest(x, y, coords)
z

# display the upper bounds, cardinality and the computed Moran's index
summary(z)
</code></pre>

<hr>
<h2 id='murray'>The Murray smelter site dataset</h2><span id='topic+murray'></span>

<h3>Description</h3>

<p>The dataset consists of soil samples collected in and around the vacant, industrially
contaminated, Murray smelter site (Utah, USA). This area was polluted by airborne emissions
and the disposal of waste slag from the smelting process. A total of 253 locations were
included in the study, and soil samples were taken from each location. Each georeferenced
sample point is a pool composite of four closely adjacent soil samples in which the
concentration of the heavy metals arsenic (As) and lead (Pb) was determined.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(murray)</code></pre>


<h3>Format</h3>

<p>A data frame with 253 observations on the following 5 variables.
</p>

<dl>
<dt>As</dt><dd><p> arsenic concentrations measurements.</p>
</dd>
<dt>Pb</dt><dd><p> lead concentrations measurements.</p>
</dd>
<dt>xpos</dt><dd> <p><code>x</code>-coordinates.</p>
</dd>
<dt>ypos</dt><dd> <p><code>y</code>-coordinates.</p>
</dd>
<dt>quad</dt><dd><p> a factor where numbers indicate different sub-regions within the area.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Griffith, D., Paelinck, J.H.P. (2011).
<em>Non-Standard Spatial Statistics</em>.
Springer, New York.
</p>

<hr>
<h2 id='normalize'>Normalization for a matrix</h2><span id='topic+normalize'></span>

<h3>Description</h3>

<p>This function normalizes an image matrix so that the minimum value is 0 and the
maximum value is 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize(img)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_+3A_img">img</code></td>
<td>
<p>target image</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Image matrix in which minimum value is 0 and maximum value is 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(twelve)
  x &lt;- RGB2gray(twelve, method = "RMY")
  x &lt;- normalize(x)
  plot(as.raster(x))
</code></pre>

<hr>
<h2 id='radiata'>The Pinus Radiata dataset</h2><span id='topic+radiata'></span>

<h3>Description</h3>

<p>Pinus radiata is one of the mostly widely planted species in Chile and is planted in a wide
array of soil types and regional climates. The plots were located in the Escuadron sector,
south of Concepcion, in the southern portion of Chile and has an area of 1244.43 hectares.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(radiata)</code></pre>


<h3>Format</h3>

<p>A data frame with 468 observations on the following 6 variables.
</p>

<dl>
<dt>xpos</dt><dd> <p><code>x</code>-coordinates.</p>
</dd>
<dt>ypos</dt><dd> <p><code>y</code>-coordinates.</p>
</dd>
<dt>basal</dt><dd><p> basal area measurements.</p>
</dd>
<dt>height</dt><dd><p> dominant tree height.</p>
</dd>
<dt>altitude</dt><dd><p> altitude in meters.</p>
</dd>
<dt>slope</dt><dd><p> slope of the terrain plot.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Cuevas, F., Porcu, E., Vallejos, R. (2013).
Study of spatial relationships between two sets of variables: A nonparametric approach.
<em>Journal of Nonparametric Statistics</em> <b>25</b>, 695-714.
</p>
<p>Vallejos, R., Osorio, F., Bevilacqua, M. (2020).
<em>Spatial Relationships Between Two Georeferenced Variables: With Applications in R</em>.
Springer, Cham.
</p>

<hr>
<h2 id='RGB2gray'>Convert RGB image or colormap to grayscale image</h2><span id='topic+RGB2gray'></span>

<h3>Description</h3>

<p>This function converts color image to gray image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RGB2gray(img, method = "average", weights = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RGB2gray_+3A_img">img</code></td>
<td>
<p>target image, specified as an <code>nrow</code>-by-<code>ncol</code>-by-3 numeric array.</p>
</td></tr>
<tr><td><code id="RGB2gray_+3A_method">method</code></td>
<td>
<p>character, procedure for converting color to grayscale. Available methods
are <code>"average"</code>, <code>"BT240"</code>, <code>"brighter"</code> (or maximum decomposition),
<code>"darker"</code> (or minimu decomposition), <code>"ITU"</code> (or BT.709), <code>"lightness"</code>
(or desaturation), <code>"LUMA"</code> (or BT.601), <code>"RMY"</code> and <code>"weighted"</code> (user provided).</p>
</td></tr>
<tr><td><code id="RGB2gray_+3A_weights">weights</code></td>
<td>
<p>weights for red (R), green (G), and blue (B) channels. Required if
<code>method = "weighted"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Grayscale image, returned as an <code>nrow</code>-by-<code>ncol</code> numeric matrix with values
in the range <code class="reqn">[0,1]</code>.
</p>
<p><code>RGB2gray</code> converts RGB values to grayscale values by forming a weighted sum
of the R, G, and B channels.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(twelve)
  par(pty = "s", mfrow = c(1,3))
  plot(as.raster(twelve)) # in RGB
  title(main = "original", font.main = 1)

  x &lt;- RGB2gray(twelve, method = "RMY")
  plot(as.raster(x)) # in grayscale
  title(main = "RMY", font.main = 1)

  x &lt;- RGB2gray(twelve, method = "ITU")
  plot(as.raster(x)) # OMG! 12 is gone...
  title(main = "ITU", font.main = 1)
</code></pre>

<hr>
<h2 id='SSIM'>Structural similarity index</h2><span id='topic+SSIM'></span>

<h3>Description</h3>

<p>This function computes the structural similarity index (SSIM) proposed by Wang et al. (2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SSIM(x, y, alpha = 1, beta = 1, gamma = 1, eps = c(0.01, 0.03), L = 255)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SSIM_+3A_x">x</code></td>
<td>
<p>reference image matrix (grayscale)</p>
</td></tr>
<tr><td><code id="SSIM_+3A_y">y</code></td>
<td>
<p>distorted image matrix (grayscale)</p>
</td></tr>
<tr><td><code id="SSIM_+3A_alpha">alpha</code></td>
<td>
<p>weight associated with luminance, default value is <code>alpha = 1</code>.</p>
</td></tr>
<tr><td><code id="SSIM_+3A_beta">beta</code></td>
<td>
<p>weight associated with contrast, default value is <code>beta = 1</code>.</p>
</td></tr>
<tr><td><code id="SSIM_+3A_gamma">gamma</code></td>
<td>
<p>weight associated with structure, default value is <code>gamma = 1</code>.</p>
</td></tr>
<tr><td><code id="SSIM_+3A_eps">eps</code></td>
<td>
<p>rescaling constants, by default <code>eps = c(0.01, 0.03)</code></p>
</td></tr>
<tr><td><code id="SSIM_+3A_l">L</code></td>
<td>
<p>dynamic range of the images, by default <code>L = 255</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>SSIM</code></td>
<td>
<p>structural similarity index between images <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>weights (<code>alpha</code>, <code>beta</code>, <code>gamma</code>) associated
with each component of <code>SSIM</code></p>
</td></tr>
<tr><td><code>comps</code></td>
<td>
<p>components of <code>SSIM</code>, that is <code>luminance</code>, <code>contrast</code> and <code>structure</code></p>
</td></tr>
<tr><td><code>stats</code></td>
<td>
<p>sample statistics (means, variances and covariance) for each image.</p>
</td></tr>
<tr><td><code>speed</code></td>
<td>
<p>Running time taken by the procedure.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wang, Z., Bovik, A.C. (2002).
A universal image quality index.
<em>IEEE Signal Processing Letters</em> <b>9</b>, 81-84.
</p>
<p>Wang, Z., Bovik, A.C., Sheikh, H.R., Simoncelli, E.P. (2004).
Image quality assessment: From error visibility to structural similarity.
<em>IEEE Transactions on Image Processing</em> <b>13</b>, 600-612.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(texmos2)

y &lt;- imnoise(texmos2, type = "gaussian")
plot(as.raster(y))
o &lt;- SSIM(texmos2, y)
o

y &lt;- imnoise(texmos2, type = "speckle")
plot(as.raster(y))
o &lt;- SSIM(texmos2, y)
o
</code></pre>

<hr>
<h2 id='texmos2'>USC texture mosaic number 2</h2><span id='topic+texmos2'></span>

<h3>Description</h3>

<p>Gray-level texture map with information about mosaic composed of eight different
texture samples taken from the Brodatz texture book, available from USC-SIPI image
database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(texmos2)</code></pre>


<h3>Format</h3>

<p>A grayscale matrix of size 512-by-512.
</p>


<h3>Source</h3>

<p>Brodatz, P. (1966).
<em>Textures: A Photographic Album for Artist and Designers</em>.
Dover Publications, New York.
</p>
<p>USC-SIPI image database, URL: <a href="https://sipi.usc.edu/database/">https://sipi.usc.edu/database/</a>
</p>

<hr>
<h2 id='twelve'>Ishihara plate number 1</h2><span id='topic+twelve'></span>

<h3>Description</h3>

<p>Ishihara plate number 1, with the numeral <code>'12'</code> designed to be visible by all
persons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(twelve)</code></pre>


<h3>Format</h3>

<p>An array of 380-by-380-by-3 representing a RGB image.
</p>

<hr>
<h2 id='wheat'>Brodatz texture image, Straw (D15)</h2><span id='topic+wheat'></span>

<h3>Description</h3>

<p>Gray-level texture image depicting wheat taken from the Brodatz texture book,
available from USC-SIPI image database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wheat)</code></pre>


<h3>Format</h3>

<p>A grayscale matrix of size 512-by-512.
</p>


<h3>Source</h3>

<p>Brodatz, P. (1966).
<em>Textures: A Photographic Album for Artist and Designers</em>.
Dover Publications, New York.
</p>
<p>USC-SIPI image database, URL: <a href="https://sipi.usc.edu/database/">https://sipi.usc.edu/database/</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
