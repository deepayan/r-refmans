<!DOCTYPE html><html><head><title>Help for package rlme</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rlme}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#beta_var'><p>Estimate fixed-effect variance for Joint Rank Method (JR) in three-level</p>
nested design.</a></li>
<li><a href='#compare.fits'><p>Compare Fits</p></a></li>
<li><a href='#dispvar'><p>Rank-based dispersion estimate.</p></a></li>
<li><a href='#fitdvcov'><p>Fitdvcov</p></a></li>
<li><a href='#GEER_est'><p>GEER: General Estimating Equation Rank-Based Estimation Method</p></a></li>
<li><a href='#getgrstplot'><p>Q-Q Plot and Standardized Residual Plot for the GR fit.</p></a></li>
<li><a href='#getlmestplot'><p>Q-Q Plot and Standardized Residual Plot for the REML or ML fit.</p></a></li>
<li><a href='#GR_est'><p>GR Method</p></a></li>
<li><a href='#hbrwts_gr'><p>HBR Weight</p></a></li>
<li><a href='#instruction'><p>Instruction</p></a></li>
<li><a href='#JR_est'><p>JR Method</p></a></li>
<li><a href='#LM_est'><p>Linear Model Estimation using the nlme package.</p></a></li>
<li><a href='#lmr'><p>Rank Based Fixed Effect Regression</p></a></li>
<li><a href='#minimize_dispersion'><p>Minimize Dispersion Function</p></a></li>
<li><a href='#plot.rlme'><p>Plot rlme Fit</p></a></li>
<li><a href='#rhosch'><p>Cluster Correlation Coefficient Estimate</p></a></li>
<li><a href='#rhosect'><p>Subcluster Correlation Coefficient Estimate</p></a></li>
<li><a href='#rlme'><p>Rank-based Estimates for Mixed-Effects Nested Models</p></a></li>
<li><a href='#rlme-package'><p>rlme</p></a></li>
<li><a href='#rpr'><p>Cluster and Subcluster effects</p></a></li>
<li><a href='#rprmeddis'><p>Rprmeddis</p></a></li>
<li><a href='#schools'><p>PISA Literacy Data</p></a></li>
<li><a href='#stanresidgr'><p>Calculate Standard Residuals</p></a></li>
<li><a href='#summary.rlme'><p>rlme Summary</p></a></li>
<li><a href='#wilonestep'><p>Wilcoxon estimate for independent linear models</p></a></li>
<li><a href='#wilstep'><p>Wilcoxon One Step Rank-based Estimate in GR Method</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Rank-Based Estimation and Prediction in Random Effects Nested
Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-01-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Yusuf Bilgic, Herb Susmann and Joseph McKean</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yusuf Bilgic &lt;bilgic@geneseo.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates robust rank-based fixed effects and predicts robust
    random effects in two- and three- level random effects nested models.
    The methodology is described in Bilgic &amp; Susmann (2013) <a href="https://journal.r-project.org/archive/2013/RJ-2013-027/">https://journal.r-project.org/archive/2013/RJ-2013-027/</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, quantreg, nlme, mgcv, stringr, magic, robustbase, Rcpp,
stats, utils, graphics</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-01-09 15:42:36 UTC; herb</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-01-09 17:35:55 UTC</td>
</tr>
</table>
<hr>
<h2 id='beta_var'>Estimate fixed-effect variance for Joint Rank Method (JR) in three-level
nested design.</h2><span id='topic+beta_var'></span>

<h3>Description</h3>

<p>Fixed effect variance estimation for Joint Rank Method (JR). It assumes
Compound Symmetric (CS) structure of error terms. For k-level design, there
are k-1 intra/inter-class parameters to place in a correlation matrix of
errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta_var(x, school, tauhat, v1, v2, v3, section, mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta_var_+3A_x">x</code></td>
<td>
<p>Data frame of covariates.</p>
</td></tr>
<tr><td><code id="beta_var_+3A_school">school</code></td>
<td>
<p>A vector of cluster.</p>
</td></tr>
<tr><td><code id="beta_var_+3A_tauhat">tauhat</code></td>
<td>
<p>This is obtained from Rank-based fitting. 
<code>tauhat</code> here~~</p>
</td></tr>
<tr><td><code id="beta_var_+3A_v1">v1</code></td>
<td>
<p>This is 1, main diagonal element for correlation matrix of
observations. Correlation of an observation with itself is 1.</p>
</td></tr>
<tr><td><code id="beta_var_+3A_v2">v2</code></td>
<td>
<p>Intra-cluster correlation coefficient.</p>
</td></tr>
<tr><td><code id="beta_var_+3A_v3">v3</code></td>
<td>
<p>Intra-subcluster correlation coefficient.</p>
</td></tr>
<tr><td><code id="beta_var_+3A_section">section</code></td>
<td>
<p>A vector of subclusters, nx1.</p>
</td></tr>
<tr><td><code id="beta_var_+3A_mat">mat</code></td>
<td>
<p>A matrix of numbers of observations in subclusters.  Dimension is
Ixmax(number ofsubclusters). Each row indicates one cluster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Correlation coefficients are obtained using Moment Estimates. See Klole et.
al (2009), Bilgic (2012) and HM (2012)
</p>


<h3>Value</h3>

<table>
<tr><td><code>var</code></td>
<td>
<p> The variance of fixed estimated. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yusuf Bilgic
</p>


<h3>References</h3>

<p>Y. K. Bilgic. Rank-based estimation and prediction for mixed
effects models in nested designs. 2012. URL
http://scholarworks.wmich.edu/dissertations/40. Dissertation.
</p>
<p>J. Kloke, J. W. McKean and M. Rashid. Rank-based estimation and associated
inferences for linear models with cluster correlated errors. Journal of the
American Statistical Association, 104(485):384-390, 2009.
</p>
<p>T. P. Hettmansperger and J. W. McKean. Robust Nonparametric Statistical
Methods. Chapman Hall, 2012.
</p>

<hr>
<h2 id='compare.fits'>Compare Fits</h2><span id='topic+compare.fits'></span>

<h3>Description</h3>

<p>Compares two model fits. It returns tdbeta value and cfits values of two
fits. The function uses the fixed effects estimates from fit 1 and fit 2
along with the covariance of the rank-based fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare.fits(x, fit1, fit2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare.fits_+3A_x">x</code></td>
<td>
<p>Matrix of covariates</p>
</td></tr>
<tr><td><code id="compare.fits_+3A_fit1">fit1</code></td>
<td>
<p>A class of type rlme.</p>
</td></tr>
<tr><td><code id="compare.fits_+3A_fit2">fit2</code></td>
<td>
<p>A class of type rlme.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns tdbeta and cfits values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitdvcov">fitdvcov</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(schools)
model = y ~ 1 + sex + age + (1 | region) + (1 | region:school)

# Extract covariants into matrix
cov = as.matrix(data.frame(schools[,"sex"], schools[,"age"]))

# Fit the models using each method
reml.fit = rlme(model, schools, method="reml")
gr.fit = rlme(model, schools, method="gr")

compare.fits(cov, reml.fit, gr.fit)

</code></pre>

<hr>
<h2 id='dispvar'>Rank-based dispersion estimate.</h2><span id='topic+dispvar'></span>

<h3>Description</h3>

<p>This is an unbiased estimator with a correction factor for standard
deviation when normal errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dispvar(x, score = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dispvar_+3A_x">x</code></td>
<td>
<p>vector</p>
</td></tr>
<tr><td><code id="dispvar_+3A_score">score</code></td>
<td>
<p>score type - 1 or 2</p>
</td></tr>
</table>


<h3>References</h3>

<p>T. P. Hettmansperger and J. W. McKean. Robust Nonparametric
Statistical Methods. Chapman Hall, 2012.
</p>

<hr>
<h2 id='fitdvcov'>Fitdvcov</h2><span id='topic+fitdvcov'></span>

<h3>Description</h3>

<p>Obtains measurement for the fits based on estimates beta1, beta2 and
covariance matrix from a rank based methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitdvcov(x1, beta1, beta2, vcw)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitdvcov_+3A_x1">x1</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="fitdvcov_+3A_beta1">beta1</code></td>
<td>
<p>model 1 beta estimate</p>
</td></tr>
<tr><td><code id="fitdvcov_+3A_beta2">beta2</code></td>
<td>
<p>model 2 beta estimate</p>
</td></tr>
<tr><td><code id="fitdvcov_+3A_vcw">vcw</code></td>
<td>
<p>variance matrix</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+compare.fits">compare.fits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Compare GR and JR methods

data(schools)

model = y ~ 1 + sex + age + (1 | region) + (1 | region:school)

# Extract covariants into matrix
cov = as.matrix(data.frame(schools[,"sex"], schools[,"age"]))

# Fit the models using each method
jr.fit = rlme(model, schools, method="jr")
gr.fit = rlme(model, schools, method="gr")

# Extract beta estimates, ignoring the intercept
jr.beta = jr.fit$fixed.effects$Estimate[c(2, 3)]
gr.beta = gr.fit$fixed.effects$Estimate[c(2, 3)]

# Extract beta variance matrix
var.b = jr.fit$var.b

fitdvcov(cov, jr.beta, gr.beta, var.b)

</code></pre>

<hr>
<h2 id='GEER_est'>GEER: General Estimating Equation Rank-Based Estimation Method</h2><span id='topic+GEER_est'></span>

<h3>Description</h3>

<p>The package rlme calls this function for gee method, one of the methods
proposed in Bilgic's study (2012). Also see Kloke et al. (2013).  
concise (1-5 lines) description of what the function does. ~~
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GEER_est(x, y, I, sec, mat, school, section, weight = "wil",
  rprpair = "hl-disp", verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GEER_est_+3A_x">x</code></td>
<td>
<p>Design matrix, pxn, without intercept.</p>
</td></tr>
<tr><td><code id="GEER_est_+3A_y">y</code></td>
<td>
<p>Response vector of nx1.</p>
</td></tr>
<tr><td><code id="GEER_est_+3A_i">I</code></td>
<td>
<p>Number of clusters.</p>
</td></tr>
<tr><td><code id="GEER_est_+3A_sec">sec</code></td>
<td>
<p>A vector of subcluster numbers in clusters.</p>
</td></tr>
<tr><td><code id="GEER_est_+3A_mat">mat</code></td>
<td>
<p>A matrix of numbers of observations in subclusters.  Dimension is
Ixmax(number ofsubclusters). Each row indicates one cluster.</p>
</td></tr>
<tr><td><code id="GEER_est_+3A_school">school</code></td>
<td>
<p>A vector of clusters, nx1.</p>
</td></tr>
<tr><td><code id="GEER_est_+3A_section">section</code></td>
<td>
<p>A vector of subclusters, nx1.</p>
</td></tr>
<tr><td><code id="GEER_est_+3A_weight">weight</code></td>
<td>
<p>When weight=&quot;hbr&quot;, it uses hbr weights in GEE weights. By
default, =&quot;wil&quot;, it uses Wilcoxon weights. See the theory in the references.</p>
</td></tr>
<tr><td><code id="GEER_est_+3A_rprpair">rprpair</code></td>
<td>
<p>By default, it uses &quot;hl-disp&quot; in the random prediction
procedure (RPP). Also, &quot;med-mad&quot; would be an alternative.</p>
</td></tr>
<tr><td><code id="GEER_est_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print out diagnostic messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>theta</code></td>
<td>
<p> Fixed effect estimates. </p>
</td></tr>
<tr><td><code>ses</code></td>
<td>
<p> Standard error for the fixed esimates. </p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p> Variances of cluster, subcluster, and residual. </p>
</td></tr>
<tr><td><code>ehat</code></td>
<td>
<p> Raw error. </p>
</td></tr>
<tr><td><code>ehats</code></td>
<td>
<p> Independence error from last weighted step. </p>
</td></tr>
<tr><td><code>effect_sch</code></td>
<td>
<p> Cluster random error. </p>
</td></tr>
<tr><td><code>effect_sec</code></td>
<td>
<p> Subcluster random error. </p>
</td></tr>
<tr><td><code>effect_err</code></td>
<td>
<p> Epsilon error. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yusuf K. Bilgic, yekabe@hotmail.com
</p>


<h3>References</h3>

<p>Y. K. Bilgic. Rank-based estimation and prediction for mixed
effects models in nested designs. 2012. URL
http://scholarworks.wmich.edu/dissertations/40. Dissertation.
</p>
<p>A. Abebe, J. W. McKean, J. D. Kloke and Y. K. Bilgic. Iterated reweighted
rank-based estimates for gee models. 2013. Submitted.
</p>


<h3>See Also</h3>

<p>rlme, GR_est, JR_est, rprmeddisp
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See the rlme function.

</code></pre>

<hr>
<h2 id='getgrstplot'>Q-Q Plot and Standardized Residual Plot for the GR fit.</h2><span id='topic+getgrstplot'></span>

<h3>Description</h3>

<p>It gets Q-Q Plot and Standardized Residual Plot of residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getgrstplot(rlme.fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getgrstplot_+3A_rlme.fit">rlme.fit</code></td>
<td>
<p>RLME fit object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fit is obtained from rlme()
</p>


<h3>See Also</h3>

<p>rlme
</p>

<hr>
<h2 id='getlmestplot'>Q-Q Plot and Standardized Residual Plot for the REML or ML fit.</h2><span id='topic+getlmestplot'></span>

<h3>Description</h3>

<p>It gets Q-Q Plot and Standardized Residual Plot of residuals.
concise (1-5 lines) description of what the function does.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getlmestplot(rlme.fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getlmestplot_+3A_rlme.fit">rlme.fit</code></td>
<td>
<p>The fit is obtained from rlme()</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>rlme
</p>

<hr>
<h2 id='GR_est'>GR Method</h2><span id='topic+GR_est'></span>

<h3>Description</h3>

<p>Fits a model using the GR method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GR_est(x, y, I, sec, mat, school, section, rprpair = "hl-disp",
  verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GR_est_+3A_x">x</code></td>
<td>
<p>Covariate matrix or data frame.</p>
</td></tr>
<tr><td><code id="GR_est_+3A_y">y</code></td>
<td>
<p>Response matrix or data frame.</p>
</td></tr>
<tr><td><code id="GR_est_+3A_i">I</code></td>
<td>
<p>Number of clusters</p>
</td></tr>
<tr><td><code id="GR_est_+3A_sec">sec</code></td>
<td>
<p>A vector of subcluster numbers in clusters.</p>
</td></tr>
<tr><td><code id="GR_est_+3A_mat">mat</code></td>
<td>
<p>A matrix of numbers of observations in subclusters.  Dimension is
Ixmax(number ofsubclusters). Each row indicates one cluster.</p>
</td></tr>
<tr><td><code id="GR_est_+3A_school">school</code></td>
<td>
<p>A vector of clusters, nx1.</p>
</td></tr>
<tr><td><code id="GR_est_+3A_section">section</code></td>
<td>
<p>A vector of subclusters, nx1.</p>
</td></tr>
<tr><td><code id="GR_est_+3A_rprpair">rprpair</code></td>
<td>
<p>By default, it uses &quot;hl-disp&quot; in the random prediction
procedure (RPP). Also, &quot;med-mad&quot; would be an alternative.</p>
</td></tr>
<tr><td><code id="GR_est_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print out messages from the
algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>theta</code></td>
<td>
<p> Fixed effect estimates. </p>
</td></tr>
<tr><td><code>ses</code></td>
<td>
<p> Standard error for the fixed esimates. </p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p> Variances of cluster, subcluster, and residual. </p>
</td></tr>
<tr><td><code>ehat</code></td>
<td>
<p> Raw error. </p>
</td></tr>
<tr><td><code>ehats</code></td>
<td>
<p> Independence error from last weighted step. </p>
</td></tr>
<tr><td><code>effect_sch</code></td>
<td>
<p> Cluster random error. </p>
</td></tr>
<tr><td><code>effect_sec</code></td>
<td>
<p> Subcluster random error. </p>
</td></tr>
<tr><td><code>effect_err</code></td>
<td>
<p> Epsilon error. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yusuf Bilgic
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See rlme function

</code></pre>

<hr>
<h2 id='hbrwts_gr'>HBR Weight</h2><span id='topic+hbrwts_gr'></span>

<h3>Description</h3>

<p>Calculates hbr weights for the GEER method. This turns a vector of weights
for a vector of errors. Used to make factor space more robust, up to 50%
breakdown. See HM (2012) and Terpstra and McKean (2005) for details. The ww
package produces this weights as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hbrwts_gr(xmat, y, percent = 0.95, intest = ltsreg(xmat, y)$coef)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hbrwts_gr_+3A_xmat">xmat</code></td>
<td>
<p>Design matrix, pxn, without intercept.</p>
</td></tr>
<tr><td><code id="hbrwts_gr_+3A_y">y</code></td>
<td>
<p>Response vector in nx1.</p>
</td></tr>
<tr><td><code id="hbrwts_gr_+3A_percent">percent</code></td>
<td>
<p>This is 0.95.</p>
</td></tr>
<tr><td><code id="hbrwts_gr_+3A_intest">intest</code></td>
<td>
<p>This is obtained from myltsreg(xmat, y)$coef</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ww package explains how it is obtained.
</p>


<h3>Author(s)</h3>

<p>J. W. McKean
</p>


<h3>References</h3>

<p>T. P. Hettmansperger and J. W. McKean. Robust Nonparametric
Statistical Methods. Chapman Hall, 2012.
</p>
<p>J. T. Terpstra and J. W. McKean. Rank-based analysis of linear models using
R. Journal of Statistical Software, 14(7):1 - 26, 7 2005. ISSN 1548-7660.
URL http://www.jstatsoft.org/v14/i07.
</p>


<h3>See Also</h3>

<p>GEER_est
</p>

<hr>
<h2 id='instruction'>Instruction</h2><span id='topic+instruction'></span>

<h3>Description</h3>

<p>A data frame on school instruction results.
</p>


<h3>Format</h3>

<p>A data frame with 1190 observations on the following 13 variables.
</p>

<dl>
<dt>X</dt><dd><p>a numeric vector</p>
</dd>
<dt>girl</dt><dd><p>a numeric vector</p>
</dd>
<dt>minority</dt><dd><p>a numeric vector</p>
</dd>
<dt>mathkind</dt><dd><p>a numeric vector</p>
</dd>
<dt>mathgain</dt><dd><p>a numeric vector</p>
</dd>
<dt>ses</dt><dd><p>a numeric vector</p>
</dd>
<dt>yearstea</dt><dd><p>a numeric vector</p>
</dd>
<dt>mathknow</dt><dd><p>a numeric vector</p>
</dd>
<dt>housepov</dt><dd><p>a numeric vector</p>
</dd>
<dt>mathprep</dt><dd><p>a numeric vector</p>
</dd>
<dt>classid</dt><dd><p>a numeric vector identifying the class within school</p>
</dd>
<dt>schoolid</dt><dd><p>a numeric vector identifying the school</p>
</dd>
<dt>childid</dt><dd><p>a numeric vector</p>
</dd>
</dl>


<h3>Source</h3>

<p>West, B., Welch, K. B., &amp; Galecki, A. T. (2006). Linear mixed
models: a practical guide using statistical software. Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# The following code takes a few minutes to run.
# In the interest of saving CRAN's example testing time,
# it has been commented out. If you want to use it,
# just uncomment and run.

# data(instruction)
# attach(instruction)

# data = data.frame(
#   y = mathgain,
#   mathkind = mathkind, 
#   girl = girl,
#   minority = minority,
#   ses = ses, 
#   school = factor(schoolid), 
#   section = factor(classid))


# fit.rlme = rlme(y ~ 1 + mathkind + girl + minority + ses + (1 | school) + (1 | school:section),
#  data = data,
#  method = "gr")
  
# summary(fit.rlme)
</code></pre>

<hr>
<h2 id='JR_est'>JR Method</h2><span id='topic+JR_est'></span>

<h3>Description</h3>

<p>Fit a model using the JR method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JR_est(x, y, I, sec, mat, school, section, rprpair = "hl-disp",
  verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JR_est_+3A_x">x</code></td>
<td>
<p>Covariate matrix or data frame</p>
</td></tr>
<tr><td><code id="JR_est_+3A_y">y</code></td>
<td>
<p>Response matrix or data frame</p>
</td></tr>
<tr><td><code id="JR_est_+3A_i">I</code></td>
<td>
<p>Number of clusters.</p>
</td></tr>
<tr><td><code id="JR_est_+3A_sec">sec</code></td>
<td>
<p>A vector of subcluster numbers in clusters.</p>
</td></tr>
<tr><td><code id="JR_est_+3A_mat">mat</code></td>
<td>
<p>A matrix of numbers of observations in subclusters.  Dimension is
Ixmax(number ofsubclusters). Each row indicates one cluster.
<code>mat</code> here~~</p>
</td></tr>
<tr><td><code id="JR_est_+3A_school">school</code></td>
<td>
<p>A vector of clusters, nx1.</p>
</td></tr>
<tr><td><code id="JR_est_+3A_section">section</code></td>
<td>
<p>A vector of subclusters, nx1.</p>
</td></tr>
<tr><td><code id="JR_est_+3A_rprpair">rprpair</code></td>
<td>
<p>By default, it uses &quot;hl-disp&quot; in the random prediction
procedure (RPP). Also, &quot;med-mad&quot; would be an alternative.</p>
</td></tr>
<tr><td><code id="JR_est_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print out diagnostic messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>theta</code></td>
<td>
<p> Fixed effect estimates. </p>
</td></tr>
<tr><td><code>ses</code></td>
<td>
<p> Standard error for the fixed esimates. </p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p> Covariate variance estimates using RPP (Groggel and Dubnicka's procedure). </p>
</td></tr>
<tr><td><code>ehat</code></td>
<td>
<p> Raw error. </p>
</td></tr>
<tr><td><code>effect_sch</code></td>
<td>
<p> Cluster random error. </p>
</td></tr>
<tr><td><code>effect_sec</code></td>
<td>
<p> Subcluster random error. </p>
</td></tr>
<tr><td><code>effect_err</code></td>
<td>
<p> Epsilon error. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yusuf Bilgic
</p>


<h3>See Also</h3>

<p>rlme
</p>

<hr>
<h2 id='LM_est'>Linear Model Estimation using the nlme package.</h2><span id='topic+LM_est'></span>

<h3>Description</h3>

<p>This gets the REML or ML estimates and predictions of random effects from
the nlme package. 
function does.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LM_est(x, y, dat, method = "REML")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LM_est_+3A_x">x</code></td>
<td>
<p>Design matrix, (p+1)xn, with intercept.</p>
</td></tr>
<tr><td><code id="LM_est_+3A_y">y</code></td>
<td>
<p>Response vector of nx1.</p>
</td></tr>
<tr><td><code id="LM_est_+3A_dat">dat</code></td>
<td>
<p>Data frame</p>
</td></tr>
<tr><td><code id="LM_est_+3A_method">method</code></td>
<td>
<p>Character string indicating method to use, either &quot;ML&quot; or
&quot;REML&quot; (defaults to REML).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>theta</code></td>
<td>
<p> Fixed effects esimates.</p>
</td></tr>
<tr><td><code>ses</code></td>
<td>
<p> Standard error for fixed effects.</p>
</td></tr>
<tr><td><code>varb</code></td>
<td>
<p> Variances.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p> Error. </p>
</td></tr>
<tr><td><code>ehat</code></td>
<td>
<p> Raw residuals </p>
</td></tr>
<tr><td><code>standr.lme</code></td>
<td>
<p> Standardized residual </p>
</td></tr>
<tr><td><code>effect_sch</code></td>
<td>
<p> Cluster random error. </p>
</td></tr>
<tr><td><code>effect_sec</code></td>
<td>
<p> Subcluster random error. </p>
</td></tr>
<tr><td><code>effect_err</code></td>
<td>
<p> Epsilon error. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yusuf Bilgic
</p>


<h3>References</h3>

<p>J. Pinheiro, D. Bates, S. DebRoy, D. Sarkar and R Development
Core Team. nlme linear and non- linear mixed effects models. The R Journal,
2011. URL http://CRAN.R-project.org/package=nlme. R package version 3.1-98.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rlme">rlme</a></code>
</p>

<hr>
<h2 id='lmr'>Rank Based Fixed Effect Regression</h2><span id='topic+lmr'></span>

<h3>Description</h3>

<p>Computes rank based regression estimates for fixed effect models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmr(f, data, se = FALSE, method = "L-BFGS-B")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmr_+3A_f">f</code></td>
<td>
<p>A model formula</p>
</td></tr>
<tr><td><code id="lmr_+3A_data">data</code></td>
<td>
<p>Data to use for model fitting</p>
</td></tr>
<tr><td><code id="lmr_+3A_se">se</code></td>
<td>
<p>Boolean indicating whether or not to calculate standard errors for
intercept and slope estimates</p>
</td></tr>
<tr><td><code id="lmr_+3A_method">method</code></td>
<td>
<p>Optimization method to use. Will accept any method usable by
optim, e.g. one of c(&quot;Nelder-Mead&quot;, &quot;BFGS&quot;, &quot;CG&quot;, &quot;L-BFGS-B&quot;, &quot;SANN&quot;,
&quot;Brent&quot;). &quot;BFGS&quot; or &quot;L-BFGS-B&quot; are reccomended. &quot;L-BFGS-B&quot; should be used
for large datasets to conserve memory.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fixed.effects</code></td>
<td>
<p> Fixed effect estimates </p>
</td></tr>
<tr><td><code>ehat</code></td>
<td>
<p>Residuals from model </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Herb Susmann
</p>


<h3>See Also</h3>

<p>rlme, optim
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load schools data
data(schools)

# Fit fixed effects model with lmr
lmr.fit = lmr(y ~ age + sex, data=schools)

summary(lmr.fit)

# Fit with lmr and calculate standard errors
lmr.fit = lmr(y ~ age + sex, data=schools, se=TRUE)

summary(lmr.fit)

</code></pre>

<hr>
<h2 id='minimize_dispersion'>Minimize Dispersion Function</h2><span id='topic+minimize_dispersion'></span>

<h3>Description</h3>

<p>Uses optim to find regression estimates which minimize dispersion function
on X and Y input matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minimize_dispersion(X, Y, method = "BFGS", init.guess = "quantreg",
  verbose = FALSE, se = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="minimize_dispersion_+3A_x">X</code></td>
<td>
<p>Input matrix</p>
</td></tr>
<tr><td><code id="minimize_dispersion_+3A_y">Y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="minimize_dispersion_+3A_method">method</code></td>
<td>
<p>Method optim should use - one of &quot;Nelder-Mead&quot;, &quot;BFGS&quot;, &quot;CG&quot;,
&quot;L-BFGS-B&quot;, &quot;SANN&quot;, or &quot;Brent&quot;.</p>
</td></tr>
<tr><td><code id="minimize_dispersion_+3A_init.guess">init.guess</code></td>
<td>
<p>How to calculate the first regression estimate. Defaults
to using quantile regression.</p>
</td></tr>
<tr><td><code id="minimize_dispersion_+3A_verbose">verbose</code></td>
<td>
<p>Whether to print out verbose messages.</p>
</td></tr>
<tr><td><code id="minimize_dispersion_+3A_se">se</code></td>
<td>
<p>Whether or not to calculate standard errors of regression
estimates.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>theta</code></td>
<td>
<p>Regression parameter estimates</p>
</td></tr>
<tr><td><code>ehat</code></td>
<td>
<p>Regression residuals</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Herb Susmann
</p>

<hr>
<h2 id='plot.rlme'>Plot rlme Fit</h2><span id='topic+plot.rlme'></span>

<h3>Description</h3>

<p>Generates Normal Q-Q plot of residuals from rlme fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlme'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.rlme_+3A_x">x</code></td>
<td>
<p>A list of class rlme. Store as fit.rlme.</p>
</td></tr>
<tr><td><code id="plot.rlme_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(schools)
rlme.fit = rlme(y ~ 1 + sex + age + (1 | region) + (1 | region:school), schools, method="gr")
plot(rlme.fit)

</code></pre>

<hr>
<h2 id='rhosch'>Cluster Correlation Coefficient Estimate</h2><span id='topic+rhosch'></span>

<h3>Description</h3>

<p>Moment estimate version of correlation coefficient in a cluster in a
three-level nested design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rhosch(ahat, school, section)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rhosch_+3A_ahat">ahat</code></td>
<td>
<p>A vector of scores. Wilcoxon scores are used in the package.</p>
</td></tr>
<tr><td><code id="rhosch_+3A_school">school</code></td>
<td>
<p>A vector of clusters.</p>
</td></tr>
<tr><td><code id="rhosch_+3A_section">section</code></td>
<td>
<p>A vector of subclusters.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Y. K. Bilgic. Rank-based estimation and prediction for mixed
effects models in nested designs. 2012. URL
http://scholarworks.wmich.edu/dissertations/40. Dissertation.
</p>

<hr>
<h2 id='rhosect'>Subcluster Correlation Coefficient Estimate</h2><span id='topic+rhosect'></span>

<h3>Description</h3>

<p>Moment estimate version of correlation coefficient in a subcluster in a
three-level nested design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rhosect(ahat, school, section)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rhosect_+3A_ahat">ahat</code></td>
<td>
<p>A vector of scores. Wilcoxon scores are used in the package.</p>
</td></tr>
<tr><td><code id="rhosect_+3A_school">school</code></td>
<td>
<p>A vector of clusters.</p>
</td></tr>
<tr><td><code id="rhosect_+3A_section">section</code></td>
<td>
<p>A vector of subclusters.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Y. K. Bilgic. Rank-based estimation and prediction for mixed
effects models in nested designs. 2012. URL
http://scholarworks.wmich.edu/dissertations/40. Dissertation.
</p>

<hr>
<h2 id='rlme'>Rank-based Estimates for Mixed-Effects Nested Models</h2><span id='topic+rlme'></span>

<h3>Description</h3>

<p>This function estimates fixed effects and predicts random effects in two-
and three-level random effects nested models using three rank-based fittings
(GR, GEER, JR) via the prediction method algorithm RPP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlme(f, data, method = "gr", print = FALSE, na.omit = TRUE,
  weight = "wil", rprpair = "hl-disp", verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rlme_+3A_f">f</code></td>
<td>
<p>An object of class formula describing the mixed effects model. The
syntax is same as in the lme4 package. Example: y ~ 1 + sex + age + (1 |
region) + (1 | region:school) - sex and age are the fixed effects, region
and school are the nested random effects, school is nested within region.</p>
</td></tr>
<tr><td><code id="rlme_+3A_data">data</code></td>
<td>
<p>The dataframe to analyze. Data should be cleaned prior to
analysis: cluster and subcluster columns are expected to be integers and in
order (e.g. all clusters and subclusters )</p>
</td></tr>
<tr><td><code id="rlme_+3A_method">method</code></td>
<td>
<p>string indicating the method to use (one of &quot;gr&quot;, &quot;jr&quot;,
&quot;reml&quot;, and &quot;geer&quot;). defaults to &quot;gr&quot;.</p>
</td></tr>
<tr><td><code id="rlme_+3A_print">print</code></td>
<td>
<p>Whether or not to print a summary of results. Defaults to
false.</p>
</td></tr>
<tr><td><code id="rlme_+3A_na.omit">na.omit</code></td>
<td>
<p>Whether or not to omit rows containing NA values. Defaults to
true.</p>
</td></tr>
<tr><td><code id="rlme_+3A_weight">weight</code></td>
<td>
<p>When weight=&quot;hbr&quot;, it uses hbr weights in GEE weights. By
default, =&quot;wil&quot;, it uses Wilcoxon weights. See the theory in the references.</p>
</td></tr>
<tr><td><code id="rlme_+3A_rprpair">rprpair</code></td>
<td>
<p>By default, it uses &quot;hl-disp&quot; in the random prediction
procedure (RPP). Also, &quot;med-mad&quot; would be an alternative.</p>
</td></tr>
<tr><td><code id="rlme_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print out diagnostic messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The iterative methods GR and GEER can be quite slow for large datasets; try
JR for faster analysis. If you want to use the GR method, try using
rprpair='med-mad'. This method avoids building a NxN covariance matrix which
can quickly become unwieldly with large data.
</p>


<h3>Value</h3>

<p>The function returns a list of class &quot;rlme&quot;. Use summary.rlme to see
a summary of the fit.
</p>
<table>
<tr><td><code>formula</code></td>
<td>
<p> The model formula. </p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> The method used. </p>
</td></tr>
<tr><td><code>fixed.effects</code></td>
<td>
<p> Estimate of fixed effects. </p>
</td></tr>
<tr><td><code>random.effects</code></td>
<td>
<p>Estimate of random effects. </p>
</td></tr>
<tr><td><code>standard.residual</code></td>
<td>
<p> Residuals. </p>
</td></tr>
<tr><td><code>intra.class.correlations</code></td>
<td>
<p> Intra/inter-class correlationa estimates obtained from RPP. </p>
</td></tr>
<tr><td><code>t.value</code></td>
<td>
<p> t-values. </p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p> p-values. </p>
</td></tr>
<tr><td><code>location</code></td>
<td>
<p> Location.  </p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p> Scale.  </p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> The response variable y.  </p>
</td></tr>
<tr><td><code>num.obs</code></td>
<td>
<p> Number of observations in provided dataset.</p>
</td></tr>
<tr><td><code>num.clusters</code></td>
<td>
<p> The number of clusters. </p>
</td></tr>
<tr><td><code>num.subclusters</code></td>
<td>
<p> The number of subclusters. </p>
</td></tr>
<tr><td><code>effect.err</code></td>
<td>
<p> Effect from error. </p>
</td></tr>
<tr><td><code>effect.cluster</code></td>
<td>
<p> Effect from cluster. </p>
</td></tr>
<tr><td><code>effect.subcluster</code></td>
<td>
<p>Effect from subcluster. </p>
</td></tr>
<tr><td><code>var.b</code></td>
<td>
<p> Variances of fixed effects estimate (Beta estimates). </p>
</td></tr>
<tr><td><code>xstar</code></td>
<td>
<p> Weighted design matrix with error covariance matrix. </p>
</td></tr>
<tr><td><code>ystar</code></td>
<td>
<p> Weighted response vector with its covariance matrix.</p>
</td></tr>
<tr><td><code>ehat</code></td>
<td>
<p> The raw residual.  </p>
</td></tr>
<tr><td><code>ehats</code></td>
<td>
<p> The raw residual after weighted step. Scaled residual. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yusuf Bilgic <a href="mailto:yekabe@hotmail.com">yekabe@hotmail.com</a> and Herb Susmann <a href="mailto:hps1@geneseo.edu">hps1@geneseo.edu</a>
</p>


<h3>References</h3>

<p>Y. K. Bilgic. Rank-based estimation and prediction for mixed
effects models in nested designs. 2012. URL
http://scholarworks.wmich.edu/dissertations/40. Dissertation.
</p>
<p>T. P. Hettmansperger and J. W. McKean. Robust Nonparametric Statistical
Methods. Chapman Hall, 2012.
</p>


<h3>See Also</h3>

<p>summary.rlme, plot.rlme, compare.fits
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(schools)

rlme.fit = rlme(y ~ 1 + sex + age + (1 | region) + (1 | region:school), schools, method="gr")
summary(rlme.fit)

# Try method="geer", "reml", "ml" and "jr" along with 
# rprpair="hl-disp" (not robust), and "med-mad" (robust),
# weight="hbr" is for the gee method.

</code></pre>

<hr>
<h2 id='rlme-package'>rlme</h2><span id='topic+rlme-package'></span>

<h3>Description</h3>

<p>An R package for rank-based robust estimation and prediction in random
effects nested models
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> rlme</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
0.2</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2013-07-07</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Yusuf Bilgic <a href="mailto:bilgic@geneseo.edu">bilgic@geneseo.edu</a>, Herb Susmann
<a href="mailto:hps1@geneseo.edu">hps1@geneseo.edu</a> and Joseph McKean <a href="mailto:joemckean@yahoo.com">joemckean@yahoo.com</a>
</p>
<p>Maintainer: Yusuf Bilgic <a href="mailto:bilgic@geneseo.edu">bilgic@geneseo.edu</a> or
<a href="mailto:yusuf.k.bilgic@gmail.com">yusuf.k.bilgic@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rlme">rlme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(rlme)
data(schools)
formula = y ~ 1 + sex + age + (1 | region) + (1 | region:school)
rlme.fit = rlme(formula, schools)
summary(rlme.fit)

</code></pre>

<hr>
<h2 id='rpr'>Cluster and Subcluster effects</h2><span id='topic+rpr'></span>

<h3>Description</h3>

<p>Partitions model residuals into cluster and subcluster effects using RPP
algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpr(f, resd, data, rprpair = "hl-disp")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpr_+3A_f">f</code></td>
<td>
<p>A model formula which specifices the random effects (see example)</p>
</td></tr>
<tr><td><code id="rpr_+3A_resd">resd</code></td>
<td>
<p>The residuals from the fitted model</p>
</td></tr>
<tr><td><code id="rpr_+3A_data">data</code></td>
<td>
<p>The data the model was fitted on</p>
</td></tr>
<tr><td><code id="rpr_+3A_rprpair">rprpair</code></td>
<td>
<p>Character string indicating the location and scale parameters
to use. Default to &quot;hl-disp&quot;, but may also be &quot;med-mad&quot;. See Bilgic (2012).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>siga2</code></td>
<td>
<p> Variance from cluster </p>
</td></tr>
<tr><td><code>sigw2</code></td>
<td>
<p> Variance from subcluster </p>
</td></tr>
<tr><td><code>sigmae2</code></td>
<td>
<p> Remaining variance not accounted for by variance of cluster and subcluster </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. W. McKean and Y. K. Bilgic
</p>


<h3>References</h3>

<p>Y. K. Bilgic. Rank-based estimation and prediction for mixed
effects models in nested designs. 2012. URL
http://scholarworks.wmich.edu/dissertations/40. Dissertation.
</p>


<h3>See Also</h3>

<p>rprmeddis, dispvar
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load school data
data(schools)

# Fit fixed effects model with lmr
lmr.fit = lmr(y ~ age + sex, data=schools)

# Three level design
# Partition residuals into school and region effects with rpp algorithm
rpr(y ~ age + sex + (1 | school) + (1 | school:region), lmr.fit$ehat, schools)

# Two level design
# Estimate variance in residuals from school
rpr(y ~ age + sex + (1 | school), lmr.fit$ehat, schools)

</code></pre>

<hr>
<h2 id='rprmeddis'>Rprmeddis</h2><span id='topic+rprmeddis'></span>

<h3>Description</h3>

<p>Robust rank-based prediction algorithm that gets predictions for random
errors in three-level nested design. It needs one location and scale
estimators. Hodges-Lehmann location estimate and dispersion functional
estimate pair is called with rprpair=&quot;hl-disp&quot; -by default- ; median and MAD
pair is called with rprpair=&quot;med-mad&quot; in rlme().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rprmeddis(I, sec, mat, ehat, location, scale, rprpair = "hl-disp")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rprmeddis_+3A_i">I</code></td>
<td>
<p>Number of clusters.</p>
</td></tr>
<tr><td><code id="rprmeddis_+3A_sec">sec</code></td>
<td>
<p>A vector of subcluster numbers in clusters.</p>
</td></tr>
<tr><td><code id="rprmeddis_+3A_mat">mat</code></td>
<td>
<p>A matrix of numbers of observations in subclusters.  Dimension is
Ixmax(number ofsubclusters). Each row indicates one cluster.</p>
</td></tr>
<tr><td><code id="rprmeddis_+3A_ehat">ehat</code></td>
<td>
<p>The residuals that inherits random effects and error effect to
be predicted.</p>
</td></tr>
<tr><td><code id="rprmeddis_+3A_location">location</code></td>
<td>
<p>If location = scale = 1 then use Median and MAD in RPP If
location = scale = 2 then use HL &amp; Dispvar in RPP Note: this is deprecated.
You should specify the location &amp; scale parameters by using the rprpair
parameter.</p>
</td></tr>
<tr><td><code id="rprmeddis_+3A_scale">scale</code></td>
<td>
<p>1 means mad, 2 means disp as scale estimators</p>
</td></tr>
<tr><td><code id="rprmeddis_+3A_rprpair">rprpair</code></td>
<td>
<p>Character string indicating the location and scale parameters
to use. Default to &quot;hl-disp&quot;, but may also be &quot;med-mad&quot;. See Bilgic (2012).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The rprmeddisp() function yields predictions of random effects and errors
vectors along with scale estimates in each level. This function was designed
for three-level nested design. See rprmeddisp2() in the package, this is for
two-level nested design.
</p>


<h3>Author(s)</h3>

<p>Yusuf Bilgic <a href="mailto:yekabe@hotmail.com">yekabe@hotmail.com</a>
</p>


<h3>References</h3>

<p>Y. K. Bilgic. Rank-based estimation and prediction for mixed
effects models in nested designs. 2012. URL
http://scholarworks.wmich.edu/dissertations/40. Dissertation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rpr">rpr</a></code> <code><a href="#topic+dispvar">dispvar</a></code>
</p>

<hr>
<h2 id='schools'>PISA Literacy Data</h2><span id='topic+schools'></span>

<h3>Description</h3>

<p>The data in Program for International Assessment (PISA) on academic
proficiency in schools around the world.
</p>


<h3>Format</h3>

<p>A data frame with 334 observations on the following 6 variables.
</p>

<dl>
<dt>y</dt><dd><p>a numeric vector indicating student literacy</p>
</dd>
<dt>socio</dt><dd><p>a numeric vector</p>
</dd>
<dt>sex</dt><dd><p>a numeric vector</p>
</dd>
<dt>age</dt><dd><p>a numeric vector</p>
</dd>
<dt>region</dt><dd><p>a numeric vector indicating four regions</p>
</dd>
<dt>school</dt><dd><p>a numeric vector indicating the schools within region</p>
</dd>
</dl>


<h3>References</h3>

<p>OECD (2010). PISA 2009 Results. http://www.oecd.org/
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#
# The example takes a few seconds to run, so in order to 
# save CRAN's testing time it has been commented out. 
# To run, simply uncomment and execute.
#

# data(schools)
# rlme.fit = rlme(y ~ 1 + sex + age + (1 | region) + (1 | region:school), 
#	schools, method="gr")
# summary(rlme.fit)
</code></pre>

<hr>
<h2 id='stanresidgr'>Calculate Standard Residuals</h2><span id='topic+stanresidgr'></span>

<h3>Description</h3>

<p>Standardizes the residuals obtained from the GR fitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stanresidgr(x, y, resid, delta = 0.8, param = 2, conf = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stanresidgr_+3A_x">x</code></td>
<td>
<p>Design matrix.</p>
</td></tr>
<tr><td><code id="stanresidgr_+3A_y">y</code></td>
<td>
<p>Response vector.</p>
</td></tr>
<tr><td><code id="stanresidgr_+3A_resid">resid</code></td>
<td>
<p>Residuals obtained from the rank-based fitting.</p>
</td></tr>
<tr><td><code id="stanresidgr_+3A_delta">delta</code></td>
<td>
<p>See HM (2012).</p>
</td></tr>
<tr><td><code id="stanresidgr_+3A_param">param</code></td>
<td>
<p>See HM (2012).</p>
</td></tr>
<tr><td><code id="stanresidgr_+3A_conf">conf</code></td>
<td>
<p>See HM (2012).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. W.  McKean
</p>


<h3>References</h3>

<p>T. P. Hettmansperger and J. W. McKean. Robust Nonparametric
Statistical Methods. Chapman Hall, 2012.
</p>
<p>Y. K. Bilgic. Rank-based estimation and prediction for mixed effects models
in nested designs. 2012. URL http://scholarworks.wmich.edu/dissertations/40.
Dissertation.
</p>

<hr>
<h2 id='summary.rlme'>rlme Summary</h2><span id='topic+summary.rlme'></span>

<h3>Description</h3>

<p>Summarizes a model fit from the rmle function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rlme'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.rlme_+3A_object">object</code></td>
<td>
<p>A list of class rlme</p>
</td></tr>
<tr><td><code id="summary.rlme_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Herb Susmann <a href="mailto:hps1@geneseo.edu">hps1@geneseo.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rlme">rlme</a></code> <code><a href="#topic+plot.rlme">plot.rlme</a></code>
</p>

<hr>
<h2 id='wilonestep'>Wilcoxon estimate for independent linear models</h2><span id='topic+wilonestep'></span>

<h3>Description</h3>

<p>This function gets weighted rank based fittings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wilonestep(y, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wilonestep_+3A_y">y</code></td>
<td>
<p>Response vector of nx1.</p>
</td></tr>
<tr><td><code id="wilonestep_+3A_x">x</code></td>
<td>
<p>Design matrix, pxn, without intercept.</p>
</td></tr>
</table>


<h3>References</h3>

<p>J. T. Terpstra and J. W. McKean. Rank-based analysis of linear
models using R. Journal of Statistical Software, 14(7) 1 &ndash; 26, 7 2005. ISSN
1548-7660. URL http://www.jstatsoft.org/v14/i07.
</p>

<hr>
<h2 id='wilstep'>Wilcoxon One Step Rank-based Estimate in GR Method</h2><span id='topic+wilstep'></span>

<h3>Description</h3>

<p>Gets weighted rank based fittings for nested designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wilstep(I, sec, mat, init = F, y, x, sigmaa2 = 1, sigmaw2 = 1,
  sigmae2 = 1, thetaold = c(0), eps = 1e-04, iflag2 = 0,
  rprpair = "hl-disp")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wilstep_+3A_i">I</code></td>
<td>
<p>Number of clusters.</p>
</td></tr>
<tr><td><code id="wilstep_+3A_sec">sec</code></td>
<td>
<p>A vector of subcluster numbers in clusters.</p>
</td></tr>
<tr><td><code id="wilstep_+3A_mat">mat</code></td>
<td>
<p>A matrix of numbers of observations in subclusters.  Dimension is
Ixmax(number ofsubclusters). Each row indicates one cluster.</p>
</td></tr>
<tr><td><code id="wilstep_+3A_init">init</code></td>
<td>
<p>boolean</p>
</td></tr>
<tr><td><code id="wilstep_+3A_y">y</code></td>
<td>
<p>Response vector of nx1.</p>
</td></tr>
<tr><td><code id="wilstep_+3A_x">x</code></td>
<td>
<p>Design matrix, pxn, without intercept.</p>
</td></tr>
<tr><td><code id="wilstep_+3A_sigmaa2">sigmaa2</code></td>
<td>
<p>Initial sigma for cluster in three-level design.</p>
</td></tr>
<tr><td><code id="wilstep_+3A_sigmaw2">sigmaw2</code></td>
<td>
<p>Initial sigma for subcluster in three-level design.</p>
</td></tr>
<tr><td><code id="wilstep_+3A_sigmae2">sigmae2</code></td>
<td>
<p>Initial sigma for error in three-level design.</p>
</td></tr>
<tr><td><code id="wilstep_+3A_thetaold">thetaold</code></td>
<td>
<p>Initial input.</p>
</td></tr>
<tr><td><code id="wilstep_+3A_eps">eps</code></td>
<td>
<p>Epsilon value</p>
</td></tr>
<tr><td><code id="wilstep_+3A_iflag2">iflag2</code></td>
<td>
<p>y or n</p>
</td></tr>
<tr><td><code id="wilstep_+3A_rprpair">rprpair</code></td>
<td>
<p>Either 'hl-disp' or 'med-mad'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Initial inputs are from the independent model.
</p>


<h3>Author(s)</h3>

<p>J. W. McKean and Y. K. Bilgic
</p>


<h3>References</h3>

<p>Y. K. Bilgic and J. W. McKean. Iteratively reweighted
generalized rank-based method in mixed models. 2013. Under preperation.
</p>
<p>J. T. Terpstra and J. W. McKean. Rank-based analysis of linear models using
R. Journal of Statistical Software, 14(7) 1 - 26, 7 2005. ISSN 1548-7660.
URL http://www.jstatsoft.org/v14/i07.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
