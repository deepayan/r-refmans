<!DOCTYPE html><html lang="en"><head><title>Help for package GREENeR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GREENeR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GREENeR-package'><p>GREENeR: Geospatial Regression Equation for European Nutrient Losses</p></a></li>
<li><a href='#aggregate_loop'><p>Aggregate loop</p></a></li>
<li><a href='#annual_data_TN'><p>Annual data TN</p></a></li>
<li><a href='#annual_data_TP'><p>Annual data TP</p></a></li>
<li><a href='#append_empty_cols'><p>Append empty columns</p></a></li>
<li><a href='#calculate_shreve'><p>Calculate shreve</p></a></li>
<li><a href='#calib_boxplot'><p>Boxplot of best parameters</p></a></li>
<li><a href='#calib_dot'><p>Dot plot of goodness-of-fit metric vs parameter value</p></a></li>
<li><a href='#calib_green'><p>Calibration of the GREEN model</p></a></li>
<li><a href='#calib_green_help'><p>Parallel calibration help function</p></a></li>
<li><a href='#catch_data_TN'><p>Catch data TN</p></a></li>
<li><a href='#catch_data_TP'><p>Catch data TP</p></a></li>
<li><a href='#check_colnames_annual'><p>Check colnames</p></a></li>
<li><a href='#check_colnames_catch'><p>Check colnames catch_data</p></a></li>
<li><a href='#check_years'><p>Check years</p></a></li>
<li><a href='#compare_calib'><p>Plot comparing observed vs modeled loads for two set of parameters</p></a></li>
<li><a href='#create_levels'><p>Create levels</p></a></li>
<li><a href='#create_lits_of_maps'><p>Preprocessing data for scenario summary</p></a></li>
<li><a href='#create_map'><p>Create map</p></a></li>
<li><a href='#data_preparation'><p>data_preparation</p></a></li>
<li><a href='#evolution_plot'><p>Evolution plot</p></a></li>
<li><a href='#evolution_plot_area'><p>Evolution plot area</p></a></li>
<li><a href='#gr_density_plot'><p>Density plot</p></a></li>
<li><a href='#green_shares'><p>Geospatial Regression Equation parallel execution returning the source</p>
apportionment</a></li>
<li><a href='#input_maps'><p>Map average load input by source</p></a></li>
<li><a href='#input_plot'><p>Plot input load by source</p></a></li>
<li><a href='#input_Tserie'><p>Time series of annual load inputs by source</p></a></li>
<li><a href='#input_Tserie_area'><p>Time series of annual load inputs by source and km2</p></a></li>
<li><a href='#LakeRetent_plot'><p>Lake retention values summary</p></a></li>
<li><a href='#launch_green'><p>GREEN execution</p></a></li>
<li><a href='#load_map'><p>Load DA map</p></a></li>
<li><a href='#load_SA_map'><p>Load SA map</p></a></li>
<li><a href='#multiple_map'><p>Multiple Map</p></a></li>
<li><a href='#N4_sankey'><p>Nutrient balance flow plot</p></a></li>
<li><a href='#nutrient_maps'><p>Map average load output by source</p></a></li>
<li><a href='#nutrient_tserie'><p>Output load time series plot</p></a></li>
<li><a href='#nutrient_tserie_darea'><p>Output load time series plot</p></a></li>
<li><a href='#read_geometry'><p>Read geometry</p></a></li>
<li><a href='#read_NSdata'><p>Read NS data</p></a></li>
<li><a href='#references_plot'><p>Reference summary plot</p></a></li>
<li><a href='#region_nut_balance'><p>Nutrient balance based in the application of the Geospatial Regression</p>
Equation returning the diffuse, land retention, point sources</a></li>
<li><a href='#scatter_plot'><p>Scatter plot of goodness-of-fit metric vs parameters</p></a></li>
<li><a href='#select_params'><p>Selection of best calibration parameters</p></a></li>
<li><a href='#sh_file'><p>Sh file</p></a></li>
<li><a href='#shreve'><p>Shreve</p></a></li>
<li><a href='#simobs_annual_plot'><p>Facet year plot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Geospatial Regression Equation for European Nutrient Losses
(GREEN)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>A. Udias [aut],
  B. Grizzetti [aut],
  O. Vigiak [aut],
  J. Gomez [aut],
  C. Alfaro [aut, cre],
  A. Aloe [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>C. Alfaro &lt;c.alfarog@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools and methods to apply the model Geospatial Regression Equation
    for European Nutrient losses (GREEN); 
    Grizzetti et al. (2005) &lt;<a href="https://doi.org/10.1016%2Fj.jhydrol.2004.07.036">doi:10.1016/j.jhydrol.2004.07.036</a>&gt;; 
    Grizzetti et al. (2008);
    Grizzetti et al. (2012) &lt;<a href="https://doi.org/10.1111%2Fj.1365-2486.2011.02576.x">doi:10.1111/j.1365-2486.2011.02576.x</a>&gt;; 
    Grizzetti et al. (2021) &lt;<a href="https://doi.org/10.1016%2Fj.gloenvcha.2021.102281">doi:10.1016/j.gloenvcha.2021.102281</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>FME (&ge; 1.3.6.1), data.table (&ge; 1.13.6), reshape2 (&ge; 1.4.4),
ggplot2 (&ge; 3.3.5), graphics (&ge; 3.6.1), sf (&ge; 1.0-2), dplyr
(&ge; 1.0.7), magrittr (&ge; 2.0.1), tmap (&ge; 3.3-2), gridExtra (&ge;
2.3), tidyselect (&ge; 1.1.0), classInt (&ge; 0.4-3), grDevices (&ge;
3.5), networkD3 (&ge; 0.4), parallelly (&ge; 1.30.0)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/calfarog/GREENeR">https://github.com/calfarog/GREENeR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/calfarog/GREENeR/issues">https://github.com/calfarog/GREENeR/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, codetools</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-01 12:00:57 UTC; cesar.alfaro</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-01 12:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='GREENeR-package'>GREENeR: Geospatial Regression Equation for European Nutrient Losses</h2><span id='topic+GREENeR-package'></span><span id='topic+GREENeR'></span>

<h3>Description</h3>

<p>The package provides tools and methods to apply the model Geospatial
Regression Equation for European Nutrient losses (GREEN;
Grizzetti et al. (2005); Grizzetti et al. (2012); Grizzetti et al. (2021)) to
an area of interest in R environment. The package comprises functions for
assessing annual nutrient (nitrogen and phosphorus) loads from a basin or
region of interest, land and river retention, and contribution shares by
sources. A brief description of the model, including sources and parameters,
can be found at the end of this document. Further, the package includes
functions for loading spatio-temporal data , calibrating basin parameters,
performing an advanced sensitivity analysis to evaluate the calibration
results, and visualizing model inputs and outputs through plots and maps.
The package is parallel-capable to alleviate the computational burden in
large basins.
</p>


<h3>References</h3>

<p>Grizzetti, B., Bouraoui, F., De Marsily, G., &amp; Bidoglio, G. (2005). A
statistical method for source apportionment of riverine nitrogen loads.
Journal of Hydrology, 304(1-4), 302-315.
<a href="https://doi.org/10.1016/j.jhydrol.2004.07.036">doi:10.1016/j.jhydrol.2004.07.036</a>
</p>
<p>Grizzetti, B., Bouraoui, F., De Marsily, G., (2008). Assessing nitrogen
pressures on European surface water. Global Biogeochem. Cycles 22..
</p>
<p>Grizzetti, B., Bouraoui, F., &amp; Aloe, A. (2012). Changes of nitrogen and
phosphorus loads to E uropean seas. Global Change Biology, 18(2), 769-782.
<a href="https://doi.org/10.1111/j.1365-2486.2011.02576.x">doi:10.1111/j.1365-2486.2011.02576.x</a>
</p>
<p>Grizzetti, B., Vigiak, O., Udias, A., Aloe, A., Zanni, M., Bouraoui, F.,
Pistocchi, A., Dorati, C., Friedland, R., De Roo, A., others &amp; Bielza, M.
(2021). How EU policies could reduce nutrient pollution in European inland
and coastal waters. Global Environmental Change, 69, 102281.
<a href="https://doi.org/10.1016/j.gloenvcha.2021.102281">doi:10.1016/j.gloenvcha.2021.102281</a>
</p>

<hr>
<h2 id='aggregate_loop'>Aggregate loop</h2><span id='topic+aggregate_loop'></span>

<h3>Description</h3>

<p>This function aggregate the variables of data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggregate_loop(listaShrt, cdat_greenLt, years, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aggregate_loop_+3A_listashrt">listaShrt</code></td>
<td>
<p>cdat_greenLt A data frame</p>
</td></tr>
<tr><td><code id="aggregate_loop_+3A_years">years</code></td>
<td>
<p>A vector of integer</p>
</td></tr>
<tr><td><code id="aggregate_loop_+3A_type">type</code></td>
<td>
<p>A character with values &quot;L&quot; when running launch_green and &quot;N&quot;
when running region_nut_balance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix
</p>

<hr>
<h2 id='annual_data_TN'>Annual data TN</h2><span id='topic+annual_data_TN'></span>

<h3>Description</h3>

<p>Defines the sources of nutrient (nitrogen) for each year and catchments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annual_data_TN
</code></pre>


<h3>Format</h3>

<p>A data frame with 14 variables:
</p>

<dl>
<dt><code>BasinID</code></dt><dd><p>integer. The basin unique identifier.</p>
</dd>
<dt><code>YearValue</code></dt><dd><p>integer. The year for which data are defined.</p>
</dd>
<dt><code>HydroID</code></dt><dd><p>integer positive. Unique catchment identifier.</p>
</dd>
<dt><code>NextDownID</code></dt><dd><p>integer. Unique identifier of the catchment to
which the catchment goes.</p>
</dd>
<dt><code>Atm</code></dt><dd><p>double. Annual nitrogen deposition from atmosphere
(ton/yr).</p>
</dd>
<dt><code>Min</code></dt><dd><p>double. Annual amount of nitrogen from mineral
fertilisers (ton/yr).</p>
</dd>
<dt><code>Man</code></dt><dd><p>double. Annual amount of nitrogen in manure fertilisers
(ton/yr).</p>
</dd>
<dt><code>Fix</code></dt><dd><p>double. Annual amount of nitrogen fixation by leguminous
crops and fodder (ton/yr).</p>
</dd>
<dt><code>Soil</code></dt><dd><p>double. Annual amount of nitrogen fixation by bacteria
in soils (ton/yr).</p>
</dd>
<dt><code>Sd</code></dt><dd><p>double. Nitrogen input from scattered dwellings (ton/yr).</p>
</dd>
<dt><code>Ps</code></dt><dd><p>double. Nitrogen input from point sources (ton/yr).</p>
</dd>
<dt><code>YearlyMass</code></dt><dd><p>double. Observed annual total nitrogen load
(TN ton/yr) from monitoring station data.</p>
</dd>
<dt><code>ForestFraction</code></dt><dd><p>double. Non-agricultural land cover in the
catchment (fraction).</p>
</dd>
<dt><code>InvNrmRain</code></dt><dd><p>double. Inverse of normalized rainfall.</p>
</dd>
</dl>


<hr>
<h2 id='annual_data_TP'>Annual data TP</h2><span id='topic+annual_data_TP'></span>

<h3>Description</h3>

<p>Defines the sources of nutrient (phosphorus) for each year and catchments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annual_data_TP
</code></pre>


<h3>Format</h3>

<p>A data frame with 12 variables:
</p>

<dl>
<dt><code>BasinID</code></dt><dd><p>integer. The basin unique identifier.</p>
</dd>
<dt><code>YearValue</code></dt><dd><p>integer. The year for which data are defined.</p>
</dd>
<dt><code>HydroID</code></dt><dd><p>integer positive. Unique catchment identifier.</p>
</dd>
<dt><code>NextDownID</code></dt><dd><p>integer. Unique identifier of the catchment to
which the catchment goes.</p>
</dd>
<dt><code>Bg</code></dt><dd><p>double. Annual amount of phosphorus background losses
(ton/yr).</p>
</dd>
<dt><code>Min</code></dt><dd><p>double. Annual amount of phosphorus mineral fertilisers
(ton/yr).</p>
</dd>
<dt><code>Man</code></dt><dd><p>double. Annual amount of phosphorus in manure fertilisers
(ton/yr).</p>
</dd>
<dt><code>Sd</code></dt><dd><p>double. Phosphorus input from scattered dwellings
(ton/yr).</p>
</dd>
<dt><code>Ps</code></dt><dd><p>double. Phosphorus input from point sources (ton/yr).</p>
</dd>
<dt><code>YearlyMass</code></dt><dd><p>double. Observed annual total phosphorus load
(TP ton/yr) from monitoring station data.</p>
</dd>
<dt><code>ForestFraction</code></dt><dd><p>double. Non-agricultural land cover in the
catchment (fraction).</p>
</dd>
<dt><code>InvNrmRain</code></dt><dd><p>double. Inverse of normalized rainfall.</p>
</dd>
</dl>


<hr>
<h2 id='append_empty_cols'>Append empty columns</h2><span id='topic+append_empty_cols'></span>

<h3>Description</h3>

<p>This function add empty values to the data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>append_empty_cols(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="append_empty_cols_+3A_df">df</code></td>
<td>
<p>data frame. A data frame to add two new columns, Fix and Soil</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One object, a data frame.
</p>

<hr>
<h2 id='calculate_shreve'>Calculate shreve</h2><span id='topic+calculate_shreve'></span>

<h3>Description</h3>

<p>Calculate shreve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_shreve(catch_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_shreve_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame
</p>

<hr>
<h2 id='calib_boxplot'>Boxplot of best parameters</h2><span id='topic+calib_boxplot'></span>

<h3>Description</h3>

<p>Returns boxplots of best model parameters ranked according to
different goodness-of-fit measures, and also boxplot with the distribution of
the parameters values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calib_boxplot(df_cb, rate_bs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calib_boxplot_+3A_df_cb">df_cb</code></td>
<td>
<p>data frame. Table with the result of the calibration process.</p>
</td></tr>
<tr><td><code id="calib_boxplot_+3A_rate_bs">rate_bs</code></td>
<td>
<p>numeric. Rate (%) of parameters selected from the whole set
produced in the calibration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Multiple boxplots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TP)
data(annual_data_TP)
# the parameter for the calibration of the model
n_iter &lt;- 2 # number of iterations
# the lower limits for all params (alpha_P, alpha_L, sd_coef)
low &lt;- c(10, 0.000, 0.1)
# the upper limits for all params (alpha_P, alpha_L, sd_coef)
upp &lt;- c(70, 0.3,  0.9)
# years in which the model should be executed
years &lt;- 1990:2018
# execution of the calibration
df_calib &lt;- calib_green(catch_data_TP, annual_data_TP, n_iter, low, upp,
years)
# Generating the box plots
rateBS &lt;- 5 # rate of best set of parameter to include in the plots
calib_boxplot(df_calib, rateBS)


</code></pre>

<hr>
<h2 id='calib_dot'>Dot plot of goodness-of-fit metric vs parameter value</h2><span id='topic+calib_dot'></span>

<h3>Description</h3>

<p>Dot plot of goodness-of-fit metric vs parameters value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calib_dot(df_cb, param)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calib_dot_+3A_df_cb">df_cb</code></td>
<td>
<p>data frame. A table with the result of the calibration process.</p>
</td></tr>
<tr><td><code id="calib_dot_+3A_param">param</code></td>
<td>
<p>character. Goodness of fit measures. See alternatives link &quot;NSE&quot;
&quot;rNSE&quot;, &quot;NSE&quot;, &quot;mNSE&quot;, &quot;MAE&quot;, &quot;PBIAS&quot;, &quot;cp&quot;, &quot;R2&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Multiple dot plots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
# the parameter for the calibration of the model
n_iter &lt;- 2 # number of iterations
# the lower limits for all params (alpha_P, alpha_L, sd_coef)
low &lt;- c(10, 0.000, 0.1)
# the upper limits for all params (alpha_P, alpha_L, sd_coef)
upp &lt;- c(70, 0.3,  0.9)
# years in which the model should be executed
years &lt;- 1990:2018
# execution of the calibration
df_calib &lt;- calib_green(catch_data_TN, annual_data_TN, n_iter, low, upp,
years)
# Generating the dot plots
gof_mes &lt;- "NSE"
calib_dot(df_calib, gof_mes)


</code></pre>

<hr>
<h2 id='calib_green'>Calibration of the GREEN model</h2><span id='topic+calib_green'></span>

<h3>Description</h3>

<p>Runs GREEN model calibration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calib_green(catch_data, annual_data, n_iter, low, upp, years)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calib_green_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. Definition of the topological sequence of
catchments.</p>
</td></tr>
<tr><td><code id="calib_green_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
<tr><td><code id="calib_green_+3A_n_iter">n_iter</code></td>
<td>
<p>numeric. Number of iterations for the calibration process.</p>
</td></tr>
<tr><td><code id="calib_green_+3A_low">low</code></td>
<td>
<p>numeric. Lower bounds of the calibration parameters.</p>
</td></tr>
<tr><td><code id="calib_green_+3A_upp">upp</code></td>
<td>
<p>numeric. Upper bounds of the calibration parameters.</p>
</td></tr>
<tr><td><code id="calib_green_+3A_years">years</code></td>
<td>
<p>integer. Years to be used in the calibration. For sequences use
c(yearini:yearend).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One object, a data frame with the model calibration
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
# the parameter for the calibration of the model
n_iter &lt;- 2 # number of iterations
# the lower limits for all params (alpha_P, alpha_L, sd_coef)
low &lt;- c(10, 0.000, 0.1)
# the upper limits for all params (alpha_P, alpha_L, sd_coef)
upp &lt;- c(70, 0.3,  0.9)
# years in which the model should be executed
years &lt;- 1990:2018
# execution of the calibration
dF_calib &lt;- calib_green(catch_data_TN, annual_data_TN, n_iter, low, upp,
years)


</code></pre>

<hr>
<h2 id='calib_green_help'>Parallel calibration help function</h2><span id='topic+calib_green_help'></span>

<h3>Description</h3>

<p>This is a help function for calib_green function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calib_green_help(task, catch_data, annual_data, years, latin_range)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calib_green_help_+3A_task">task</code></td>
<td>
<p>An integer with the number of simulation</p>
</td></tr>
<tr><td><code id="calib_green_help_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. It defines the topological sequence
of catchments.</p>
</td></tr>
<tr><td><code id="calib_green_help_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. It defines the sources of nutrient for each
year and catchments.</p>
</td></tr>
<tr><td><code id="calib_green_help_+3A_years">years</code></td>
<td>
<p>integer. It defines the years of interest.</p>
</td></tr>
<tr><td><code id="calib_green_help_+3A_latin_range">latin_range</code></td>
<td>
<p>data frame. It defines the values for the params taking +
into account the limits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix
</p>

<hr>
<h2 id='catch_data_TN'>Catch data TN</h2><span id='topic+catch_data_TN'></span>

<h3>Description</h3>

<p>Defines the topological sequence of catchments for nitrogen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catch_data_TN
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt><code>HydroID</code></dt><dd><p>integer positive. Unique catchment identifier.</p>
</dd>
<dt><code>To_catch</code></dt><dd><p>integer. Unique identifier of the catchment to which
the catchment goes. Note that for the outlet To_catch== -1.</p>
</dd>
<dt><code>Shreve</code></dt><dd><p>integer. this indicates the Shreve order of the
topological sequence in the stream network.</p>
</dd>
<dt><code>LakeFrRet</code></dt><dd><p>fraction, 0-1. Lake retention fraction.</p>
</dd>
<dt><code>NrmLengthKm</code></dt><dd><p>double. Normalized length of catchment reach.</p>
</dd>
</dl>


<hr>
<h2 id='catch_data_TP'>Catch data TP</h2><span id='topic+catch_data_TP'></span>

<h3>Description</h3>

<p>Defines the topological sequence of catchments for phosphorus.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catch_data_TP
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt><code>HydroID</code></dt><dd><p>integer positive. Unique catchment identifier.</p>
</dd>
<dt><code>To_catch</code></dt><dd><p>integer. Unique identifier of the catchment to which
the catchment goes. Note that for the outlet To_catch== -1.</p>
</dd>
<dt><code>Shreve</code></dt><dd><p>integer. this indicates the Shreve order of the
topological sequence in the stream network.</p>
</dd>
<dt><code>LakeFrRet</code></dt><dd><p>fraction, 0-1. Lake retention fraction.</p>
</dd>
<dt><code>NrmLengthKm</code></dt><dd><p>double. Normalized length of catchment reach.</p>
</dd>
</dl>


<hr>
<h2 id='check_colnames_annual'>Check colnames</h2><span id='topic+check_colnames_annual'></span>

<h3>Description</h3>

<p>This function checks that all column names for the catch_data
data frame are correct.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_colnames_annual(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_colnames_annual_+3A_df">df</code></td>
<td>
<p>data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame
</p>

<hr>
<h2 id='check_colnames_catch'>Check colnames catch_data</h2><span id='topic+check_colnames_catch'></span>

<h3>Description</h3>

<p>This function checks that all column names for the annual_data
data frame are correct.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_colnames_catch(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_colnames_catch_+3A_df">df</code></td>
<td>
<p>data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame
</p>

<hr>
<h2 id='check_years'>Check years</h2><span id='topic+check_years'></span>

<h3>Description</h3>

<p>This function check if years are in data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_years(loc_years, years)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_years_+3A_loc_years">loc_years</code></td>
<td>
<p>numeric. A vector of integer with the years of interest</p>
</td></tr>
<tr><td><code id="check_years_+3A_years">years</code></td>
<td>
<p>numeric. A vector of integer with the years with information in
data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of integer
</p>

<hr>
<h2 id='compare_calib'>Plot comparing observed vs modeled loads for two set of parameters</h2><span id='topic+compare_calib'></span>

<h3>Description</h3>

<p>Returns a scatter plot comparing observed versus modeled loads
obtained with two model parameter sets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_calib(
  catch_data,
  annual_data,
  alpha_p1,
  alpha_l1,
  sd_coef1,
  alpha_p2,
  alpha_l2,
  sd_coef2,
  years,
  name_basin,
  setPlabels
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_calib_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. Definition of the topological sequence of
catchments.</p>
</td></tr>
<tr><td><code id="compare_calib_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
<tr><td><code id="compare_calib_+3A_alpha_p1">alpha_p1</code></td>
<td>
<p>numeric. The basin retention coefficient of the first set of
parameters.</p>
</td></tr>
<tr><td><code id="compare_calib_+3A_alpha_l1">alpha_l1</code></td>
<td>
<p>numeric. The river retention coefficient of the first set of
parameters.</p>
</td></tr>
<tr><td><code id="compare_calib_+3A_sd_coef1">sd_coef1</code></td>
<td>
<p>numeric. Fraction of domestic diffuse sources that reaches
the stream network of the first set of parameters.</p>
</td></tr>
<tr><td><code id="compare_calib_+3A_alpha_p2">alpha_p2</code></td>
<td>
<p>numeric. The basin retention coefficient of the second set of
parameters.</p>
</td></tr>
<tr><td><code id="compare_calib_+3A_alpha_l2">alpha_l2</code></td>
<td>
<p>numeric. The river retention coefficient of the second set of
parameters.</p>
</td></tr>
<tr><td><code id="compare_calib_+3A_sd_coef2">sd_coef2</code></td>
<td>
<p>numeric. Fraction of domestic diffuse sources that reaches
the stream network of the second set of parameters.</p>
</td></tr>
<tr><td><code id="compare_calib_+3A_years">years</code></td>
<td>
<p>numeric. Years to be shown in the plot.</p>
</td></tr>
<tr><td><code id="compare_calib_+3A_name_basin">name_basin</code></td>
<td>
<p>character. Name of the basin (title of the plot).</p>
</td></tr>
<tr><td><code id="compare_calib_+3A_setplabels">setPlabels</code></td>
<td>
<p>character. Labels identifying each set of parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scatter plot and a list with two data frames with model GREEN
applied to two model parameter sets
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)

# the first set of parameters to assess the basin model
alpha_p &lt;- 35.09
alpha_l &lt;- 0.02
sd_coef &lt;- 0.2

# the second set of parameters to assess the basin model
alpha_p2 &lt;- 41.23
alpha_l2 &lt;- 0.0015
sd_coef2 &lt;- 0.6

# years in which the plot will we shown
years &lt;- 1990:2018

nameBasin &lt;- "Lay"

# generating the scatter plot comparing two set of parameters observed
# versus modeled loads by year
setPlabels &lt;- c("bestNSE","bestR2")
compare_calib(catch_data_TN, annual_data_TN, alpha_p , alpha_l, sd_coef,
alpha_p2, alpha_l2, sd_coef2, years, nameBasin, setPlabels)


</code></pre>

<hr>
<h2 id='create_levels'>Create levels</h2><span id='topic+create_levels'></span>

<h3>Description</h3>

<p>This function create the levels for the data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_levels(df, no_sf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_levels_+3A_df">df</code>, <code id="create_levels_+3A_no_sf">no_sf</code></td>
<td>
<p>data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list
</p>

<hr>
<h2 id='create_lits_of_maps'>Preprocessing data for scenario summary</h2><span id='topic+create_lits_of_maps'></span>

<h3>Description</h3>

<p>This function blah, blah, blah....
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_lits_of_maps(
  hydroSf,
  long_basin,
  unit,
  legend_position,
  param_list,
  style
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_lits_of_maps_+3A_hydrosf">hydroSf</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="create_lits_of_maps_+3A_long_basin">long_basin</code></td>
<td>
<p>numeric. The longitude of the basin.</p>
</td></tr>
<tr><td><code id="create_lits_of_maps_+3A_unit">unit</code></td>
<td>
<p>character. The unit of the data.</p>
</td></tr>
<tr><td><code id="create_lits_of_maps_+3A_legend_position">legend_position</code></td>
<td>
<p>numeric. It indicates de position of the legend of the
plot. (Default: 1)</p>
</td></tr>
<tr><td><code id="create_lits_of_maps_+3A_param_list">param_list</code></td>
<td>
<p>list. A list with the maps to plot.</p>
</td></tr>
<tr><td><code id="create_lits_of_maps_+3A_style">style</code></td>
<td>
<p>character. The style of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with maps
</p>

<hr>
<h2 id='create_map'>Create map</h2><span id='topic+create_map'></span>

<h3>Description</h3>

<p>This function create a tm map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_map(
  hydroSf,
  var_name,
  style_map,
  scale_barRefs,
  scale_barTexts,
  title,
  palette,
  legend_position = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_map_+3A_hydrosf">hydroSf</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="create_map_+3A_var_name">var_name</code></td>
<td>
<p>character. The name of a data variable that it is contains
in data frame</p>
</td></tr>
<tr><td><code id="create_map_+3A_style_map">style_map</code>, <code id="create_map_+3A_scale_barrefs">scale_barRefs</code>, <code id="create_map_+3A_scale_bartexts">scale_barTexts</code></td>
<td>
<p>numeric.</p>
</td></tr>
<tr><td><code id="create_map_+3A_title">title</code></td>
<td>
<p>character. The title of the plot</p>
</td></tr>
<tr><td><code id="create_map_+3A_palette">palette</code></td>
<td>
<p>character. The colors of the map</p>
</td></tr>
<tr><td><code id="create_map_+3A_legend_position">legend_position</code></td>
<td>
<p>numeric. It indicates de position of the legend of the
plot. (Default: 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with map of the basin
</p>

<hr>
<h2 id='data_preparation'>data_preparation</h2><span id='topic+data_preparation'></span>

<h3>Description</h3>

<p>Prepare data to launch green
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_preparation(catch_data, annual_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_preparation_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. Definition of the topological sequence of
catchments.</p>
</td></tr>
<tr><td><code id="data_preparation_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One list with two data table
</p>

<hr>
<h2 id='evolution_plot'>Evolution plot</h2><span id='topic+evolution_plot'></span>

<h3>Description</h3>

<p>This function plot the evolution of the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evolution_plot(
  data,
  title = NULL,
  xaxis.title = NULL,
  yaxis.title,
  x,
  y,
  colour = NULL,
  wrap = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evolution_plot_+3A_data">data</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="evolution_plot_+3A_title">title</code></td>
<td>
<p>character. The plot title</p>
</td></tr>
<tr><td><code id="evolution_plot_+3A_xaxis.title">xaxis.title</code></td>
<td>
<p>character. The title of x axis</p>
</td></tr>
<tr><td><code id="evolution_plot_+3A_yaxis.title">yaxis.title</code></td>
<td>
<p>character. The title of y axis</p>
</td></tr>
<tr><td><code id="evolution_plot_+3A_x">x</code></td>
<td>
<p>character. The name of variable in data to represent in x axis</p>
</td></tr>
<tr><td><code id="evolution_plot_+3A_y">y</code></td>
<td>
<p>character. The name of variable in data to represent in y axis</p>
</td></tr>
<tr><td><code id="evolution_plot_+3A_colour">colour</code></td>
<td>
<p>character. The name of variable in data to represent colour</p>
</td></tr>
<tr><td><code id="evolution_plot_+3A_wrap">wrap</code></td>
<td>
<p>character. The name of variable in data to represent wrap</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for the side effect of drawing a plot
</p>

<hr>
<h2 id='evolution_plot_area'>Evolution plot area</h2><span id='topic+evolution_plot_area'></span>

<h3>Description</h3>

<p>This function blah, blah, blah....
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evolution_plot_area(
  annual_data,
  new_data,
  title_plot = NULL,
  xaxis.title = NULL,
  yaxis.title,
  x,
  y,
  colour = NULL,
  wrap = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evolution_plot_area_+3A_annual_data">annual_data</code>, <code id="evolution_plot_area_+3A_new_data">new_data</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="evolution_plot_area_+3A_title_plot">title_plot</code></td>
<td>
<p>character. The plot title</p>
</td></tr>
<tr><td><code id="evolution_plot_area_+3A_xaxis.title">xaxis.title</code></td>
<td>
<p>character. The title of x axis</p>
</td></tr>
<tr><td><code id="evolution_plot_area_+3A_yaxis.title">yaxis.title</code></td>
<td>
<p>character. The title of y axis</p>
</td></tr>
<tr><td><code id="evolution_plot_area_+3A_x">x</code></td>
<td>
<p>character. The name of variable in data to represent in x axis</p>
</td></tr>
<tr><td><code id="evolution_plot_area_+3A_y">y</code></td>
<td>
<p>character. The name of variable in data to represent in y axis</p>
</td></tr>
<tr><td><code id="evolution_plot_area_+3A_colour">colour</code></td>
<td>
<p>character. The name of variable in data to represent colour</p>
</td></tr>
<tr><td><code id="evolution_plot_area_+3A_wrap">wrap</code></td>
<td>
<p>character. The name of variable in data to represent wrap</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot
</p>

<hr>
<h2 id='gr_density_plot'>Density plot</h2><span id='topic+gr_density_plot'></span>

<h3>Description</h3>

<p>This function blah, blah, blah....
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gr_density_plot(df_plot, plot_index, basin_name, cSD)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gr_density_plot_+3A_df_plot">df_plot</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="gr_density_plot_+3A_plot_index">plot_index</code></td>
<td>
<p>numeric. The indexes to plot</p>
</td></tr>
<tr><td><code id="gr_density_plot_+3A_basin_name">basin_name</code></td>
<td>
<p>character. The name of the basin</p>
</td></tr>
<tr><td><code id="gr_density_plot_+3A_csd">cSD</code></td>
<td>
<p>numeric. The standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for the side effect of drawing a plot
</p>

<hr>
<h2 id='green_shares'>Geospatial Regression Equation parallel execution returning the source
apportionment</h2><span id='topic+green_shares'></span>

<h3>Description</h3>

<p>Run GREEN model with selected parameter set and returns the
nutrient load by each source for all catchments in the Basin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>green_shares(catch_data, annual_data, alpha_p, alpha_l, sd_coef, loc_years)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="green_shares_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. Definition of the topological sequence of
catchments.</p>
</td></tr>
<tr><td><code id="green_shares_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
<tr><td><code id="green_shares_+3A_alpha_p">alpha_p</code></td>
<td>
<p>numeric. First model parameter, the basin retention
coefficient.</p>
</td></tr>
<tr><td><code id="green_shares_+3A_alpha_l">alpha_l</code></td>
<td>
<p>numeric. Second model parameter, the river retention
coefficient.</p>
</td></tr>
<tr><td><code id="green_shares_+3A_sd_coef">sd_coef</code></td>
<td>
<p>numeric. Third model parameter, fraction of domestic diffuse
sources that reaches the stream network.</p>
</td></tr>
<tr><td><code id="green_shares_+3A_loc_years">loc_years</code></td>
<td>
<p>integer. Years in which the model should be executed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One object, a data frame with the nutrient load by each source for
all catchments in the Basin
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
# the parameter to assess the basin model
alpha_p &lt;- 35.09
alpha_l &lt;- 0.02
sd_coef &lt;- 0.2
# year in which the model should be executed
loc_years &lt;- 1990:2018
# Computing the source apportionment
basin_loads_s &lt;- green_shares(catch_data_TN, annual_data_TN, alpha_p, alpha_l,
sd_coef, loc_years)


</code></pre>

<hr>
<h2 id='input_maps'>Map average load input by source</h2><span id='topic+input_maps'></span>

<h3>Description</h3>

<p>Map showing the mean load input by source
</p>


<h3>Usage</h3>

<pre><code class='language-R'>input_maps(
  catch_data,
  annual_data,
  sh_file,
  plot.type,
  style_map = "fisher",
  scale_barTextS = 0.7,
  legend_position = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="input_maps_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. Definition of the topological sequence of
catchments.</p>
</td></tr>
<tr><td><code id="input_maps_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
<tr><td><code id="input_maps_+3A_sh_file">sh_file</code></td>
<td>
<p>sf object. The spatial information.</p>
</td></tr>
<tr><td><code id="input_maps_+3A_plot.type">plot.type</code></td>
<td>
<p>character. Alternatives of the map: input load (kt) by type
divided by year and catchment. “gr1”: by km2; “gr2”: by year/km2.</p>
</td></tr>
<tr><td><code id="input_maps_+3A_style_map">style_map</code></td>
<td>
<p>character. Alternatives to create the intervals in the maps.
Chosen style: one of &quot;fixed&quot;, &quot;sd&quot;, &quot;equal&quot;, &quot;pretty&quot;, &quot;quantile&quot;, &quot;kmeans&quot;,
&quot;hclust&quot;, &quot;bclust&quot;, &quot;fisher&quot;, &quot;jenks&quot;.</p>
</td></tr>
<tr><td><code id="input_maps_+3A_scale_bartexts">scale_barTextS</code></td>
<td>
<p>numeric. To modify the size of the text in the legend.</p>
</td></tr>
<tr><td><code id="input_maps_+3A_legend_position">legend_position</code></td>
<td>
<p>numeric. Legend position: 1 (default): &quot;right&quot;,
&quot;bottom&quot;; 2: &quot;left&quot;, &quot;up&quot;; 3: &quot;right&quot;, &quot;bottom&quot;; 4: &quot;right&quot;, &quot;up&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for the side effect of drawing a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
data(sh_file)
# the Input Load Map by source type 1 (lines)
input_maps(catch_data_TN, annual_data_TN, sh_file, plot.type = "gr1",
legend_position = 2)
# the Input Load Map by source type 2 (lines &amp; area)
input_maps(catch_data_TN, annual_data_TN, sh_file, plot.type = "gr2",
legend_position = 2)


</code></pre>

<hr>
<h2 id='input_plot'>Plot input load by source</h2><span id='topic+input_plot'></span>

<h3>Description</h3>

<p>A grouped barplot representing the average input load by source
for the whole basin or a three density plots showing the distribution of
nutrient sources (7 for nitrogen, 5 for phosphorous).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>input_plot(annual_data, sh_file, basin_name, plot.type, coef_SD = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="input_plot_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
<tr><td><code id="input_plot_+3A_sh_file">sh_file</code></td>
<td>
<p>sf object. The spatial information.</p>
</td></tr>
<tr><td><code id="input_plot_+3A_basin_name">basin_name</code></td>
<td>
<p>character. The title of the plot.</p>
</td></tr>
<tr><td><code id="input_plot_+3A_plot.type">plot.type</code></td>
<td>
<p>character. Possible values: Bar plot (&quot;B&quot;) or
Density plot (“D”).</p>
</td></tr>
<tr><td><code id="input_plot_+3A_coef_sd">coef_SD</code></td>
<td>
<p>numeric. The standard deviation coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for the side effect of drawing a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'># the data of the TN scenario
data(annual_data_TN)
data(sh_file)
# The name of the basin
basin_name &lt;- "Lay"
# the barplot
input_plot(annual_data = annual_data_TN, basin_name = basin_name, plot.type = "B")
# the density plots
input_plot(annual_data_TN, sh_file, basin_name, "D")

</code></pre>

<hr>
<h2 id='input_Tserie'>Time series of annual load inputs by source</h2><span id='topic+input_Tserie'></span>

<h3>Description</h3>

<p>Creates a time series plot showing basin inputs by
source
</p>


<h3>Usage</h3>

<pre><code class='language-R'>input_Tserie(catch_data, annual_data, sh_file, basin_name, plot.type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="input_Tserie_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. Definition of the topological sequence of
catchments.</p>
</td></tr>
<tr><td><code id="input_Tserie_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
<tr><td><code id="input_Tserie_+3A_sh_file">sh_file</code></td>
<td>
<p>sf object. The spatial information.</p>
</td></tr>
<tr><td><code id="input_Tserie_+3A_basin_name">basin_name</code></td>
<td>
<p>character. The title of the plot</p>
</td></tr>
<tr><td><code id="input_Tserie_+3A_plot.type">plot.type</code></td>
<td>
<p>character. Alternative of the plot: “gr1”: stacked area;
“gr2”: lines &amp; area.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A time-series plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
data(sh_file)
# The title of the plot
plotTitle &lt;- "Time series for the Lay Basin"
# the time serie plot 1 (lines)
input_Tserie(catch_data_TN, annual_data_TN, sh_file, plotTitle, "gr1")
# the time serie plot 2 (lines &amp; area)
input_Tserie(catch_data_TN, annual_data_TN, sh_file, plotTitle, "gr2")


</code></pre>

<hr>
<h2 id='input_Tserie_area'>Time series of annual load inputs by source and km2</h2><span id='topic+input_Tserie_area'></span>

<h3>Description</h3>

<p>Creates a time series plot showing basin inputs by
source
</p>


<h3>Usage</h3>

<pre><code class='language-R'>input_Tserie_area(catch_data, annual_data, sh_file, basin_name, plot.type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="input_Tserie_area_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. Definition of the topological sequence of
catchments.</p>
</td></tr>
<tr><td><code id="input_Tserie_area_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
<tr><td><code id="input_Tserie_area_+3A_sh_file">sh_file</code></td>
<td>
<p>sf object. The spatial information.</p>
</td></tr>
<tr><td><code id="input_Tserie_area_+3A_basin_name">basin_name</code></td>
<td>
<p>character. The title of the plot</p>
</td></tr>
<tr><td><code id="input_Tserie_area_+3A_plot.type">plot.type</code></td>
<td>
<p>character. Alternative of the plot:  “gr1”:  stacked area by km2; “gr2”  lines &amp; area by km2 and Shreve.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A time-series plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
data(sh_file)
# The title of the plot
plotTitle &lt;- "Time series for the Lay Basin"
# the time serie plot 1 (by km2)
input_Tserie(catch_data_TN, annual_data_TN, sh_file, plotTitle, "gr1")
# the time serie plot 2 (by km2 and Shreve)
input_Tserie(catch_data_TN, annual_data_TN, sh_file, plotTitle, "gr2")

# catch_data &lt;- The_Scen[[1]]
# annual_data &lt;- The_Scen[[2]]
# sh_file &lt;- The_Sf_shape
</code></pre>

<hr>
<h2 id='LakeRetent_plot'>Lake retention values summary</h2><span id='topic+LakeRetent_plot'></span>

<h3>Description</h3>

<p>Summary of the reference values in the stations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LakeRetent_plot(catch_data_TN)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LakeRetent_plot_+3A_catch_data_tn">catch_data_TN</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>barplot &amp; histogram-density
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
LakeRetent_plot(catch_data_TN)


</code></pre>

<hr>
<h2 id='launch_green'>GREEN execution</h2><span id='topic+launch_green'></span>

<h3>Description</h3>

<p>Applies the model GREEN (Grizzetti et al.
[@grizzetti2012changes, @grizzetti2021eu]) to a basin and returns annual
nutrient (nitrogen or phosphorus) load for all catchments in the basin
</p>


<h3>Usage</h3>

<pre><code class='language-R'>launch_green(
  catch_data,
  annual_data,
  alpha_p,
  alpha_l,
  sd_coef,
  loc_years,
  atm_coeff = 0.38
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="launch_green_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. Definition of the topological sequence of
catchments.</p>
</td></tr>
<tr><td><code id="launch_green_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
<tr><td><code id="launch_green_+3A_alpha_p">alpha_p</code></td>
<td>
<p>numeric. First model parameter, the basin retention
coefficient.</p>
</td></tr>
<tr><td><code id="launch_green_+3A_alpha_l">alpha_l</code></td>
<td>
<p>numeric. Second model parameter, the river retention
coefficient.</p>
</td></tr>
<tr><td><code id="launch_green_+3A_sd_coef">sd_coef</code></td>
<td>
<p>numeric. Third model parameter, fraction of domestic diffuse
sources that reaches the stream network.</p>
</td></tr>
<tr><td><code id="launch_green_+3A_loc_years">loc_years</code></td>
<td>
<p>integer. Years in which the model should be executed.</p>
</td></tr>
<tr><td><code id="launch_green_+3A_atm_coeff">atm_coeff</code></td>
<td>
<p>numeric. It defines the atmospheric attenuation coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One object, a data frame
</p>

<hr>
<h2 id='load_map'>Load DA map</h2><span id='topic+load_map'></span>

<h3>Description</h3>

<p>This function creates a tmap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_map(hydroSf, long_basin, title, style_map, legend_position = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load_map_+3A_hydrosf">hydroSf</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="load_map_+3A_long_basin">long_basin</code></td>
<td>
<p>numeric.</p>
</td></tr>
<tr><td><code id="load_map_+3A_title">title</code></td>
<td>
<p>string. The title of the map</p>
</td></tr>
<tr><td><code id="load_map_+3A_style_map">style_map</code></td>
<td>
<p>character. The style of the map</p>
</td></tr>
<tr><td><code id="load_map_+3A_legend_position">legend_position</code></td>
<td>
<p>numeric. It indicates de position of the legend of the
plot. (Default: 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with map of the basin
</p>

<hr>
<h2 id='load_SA_map'>Load SA map</h2><span id='topic+load_SA_map'></span>

<h3>Description</h3>

<p>This function creates a tmap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_SA_map(
  hydroSf_merge,
  refN_P,
  long_basin,
  unity,
  style_map,
  legend_position = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load_SA_map_+3A_hydrosf_merge">hydroSf_merge</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="load_SA_map_+3A_refn_p">refN_P</code></td>
<td>
<p>numeric. The number of variables of the data frame</p>
</td></tr>
<tr><td><code id="load_SA_map_+3A_long_basin">long_basin</code></td>
<td>
<p>numeric.</p>
</td></tr>
<tr><td><code id="load_SA_map_+3A_unity">unity</code></td>
<td>
<p>character. The units of hydroSf</p>
</td></tr>
<tr><td><code id="load_SA_map_+3A_style_map">style_map</code></td>
<td>
<p>character. The style of the map</p>
</td></tr>
<tr><td><code id="load_SA_map_+3A_legend_position">legend_position</code></td>
<td>
<p>numeric. It indicates de position of the legend of the
plot. (Default: 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with map of the basin
</p>

<hr>
<h2 id='multiple_map'>Multiple Map</h2><span id='topic+multiple_map'></span>

<h3>Description</h3>

<p>This function creates an arrange of tmap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiple_map(hydroSf, refN_P, long_basin, unit, legend_position = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiple_map_+3A_hydrosf">hydroSf</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="multiple_map_+3A_refn_p">refN_P</code></td>
<td>
<p>numeric. The number of variables of the data frame</p>
</td></tr>
<tr><td><code id="multiple_map_+3A_long_basin">long_basin</code></td>
<td>
<p>numeric.</p>
</td></tr>
<tr><td><code id="multiple_map_+3A_unit">unit</code></td>
<td>
<p>character. The units of hydroSf</p>
</td></tr>
<tr><td><code id="multiple_map_+3A_legend_position">legend_position</code></td>
<td>
<p>numeric. It indicates de position of the legend of the
plot. (Default: 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with map of the basin
</p>

<hr>
<h2 id='N4_sankey'>Nutrient balance flow plot</h2><span id='topic+N4_sankey'></span>

<h3>Description</h3>

<p>Nutrient balance flow in Sankey plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>N4_sankey(Nbalance_out)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="N4_sankey_+3A_nbalance_out">Nbalance_out</code></td>
<td>
<p>data frame. Nutrient balance result from the Nutbalance()
function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Sankey diagram and a data frame with the some variable values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
# the parameter to assess the basin model
alpha_p &lt;- 35.09
alpha_l &lt;- 0.02
sd_coef &lt;- 0.2
# years in which the model should be executed
loc_years &lt;- 1990:2018
# Computing the nutrient balance
nut_bal &lt;- region_nut_balance(catch_data_TN, annual_data_TN, alpha_p, alpha_l,
sd_coef, loc_years)
# Plot the sankey plot with the result of the balance
sank &lt;- N4_sankey(nut_bal)


</code></pre>

<hr>
<h2 id='nutrient_maps'>Map average load output by source</h2><span id='topic+nutrient_maps'></span>

<h3>Description</h3>

<p>Creates maps showing basin output total or by source loads
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nutrient_maps(green_file, sh_file, plot.type, style, legend_position = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nutrient_maps_+3A_green_file">green_file</code></td>
<td>
<p>data frame of GREEN model results from green_shares()
function. Nutrient Load by source apportionment of nutrient for each year
and catchments.</p>
</td></tr>
<tr><td><code id="nutrient_maps_+3A_sh_file">sh_file</code></td>
<td>
<p>sf object. The spatial information of the basin.</p>
</td></tr>
<tr><td><code id="nutrient_maps_+3A_plot.type">plot.type</code></td>
<td>
<p>character. Alternatives of the map: “gr1”: output load
(kt/y) by source; “gr2”: Total Load, log10 (kt/y); “gr3”: Total Load
by km2 (kt/year/km2).</p>
</td></tr>
<tr><td><code id="nutrient_maps_+3A_style">style</code></td>
<td>
<p>charater. The style of the plot.</p>
</td></tr>
<tr><td><code id="nutrient_maps_+3A_legend_position">legend_position</code></td>
<td>
<p>numeric. Legend position: 1 (default): &quot;right&quot;,
&quot;bottom&quot;; 2: &quot;left&quot;, &quot;up&quot;; 3: &quot;right&quot;, &quot;bottom&quot;; 4: &quot;right&quot;, &quot;up&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for the side effect of drawing a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
data(sh_file)
# the parameter to assess the basin model
alpha_p &lt;- 35.09
alpha_l &lt;- 0.02
sd_coef &lt;- 0.2
# years in which the model should be executed
loc_years &lt;- 1990:2018
# Computing the source apportionment
basin_sa &lt;- green_shares(catch_data_TN, annual_data_TN, alpha_p, alpha_l,
sd_coef, loc_years)
# Basin Output Load  Maps by source
Lpos &lt;- 1
nutrient_maps(basin_sa, sh_file, plot.type = "gr1", style = "log10", legend_position = Lpos)
# Basin Output Specific Load  Maps
Lpos &lt;- 1
nutrient_maps(basin_sa, sh_file, plot.type = "gr2", style = "log10", legend_position = Lpos)
# Basin Output Specific Load by km2 Maps
Lpos &lt;- 1
nutrient_maps(basin_sa, sh_file, plot.type = "gr3", style = "fisher", legend_position = Lpos)


</code></pre>

<hr>
<h2 id='nutrient_tserie'>Output load time series plot</h2><span id='topic+nutrient_tserie'></span>

<h3>Description</h3>

<p>Creates a time series plot showing basin model results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nutrient_tserie(green_file, basin_name, plot.type, file_path = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nutrient_tserie_+3A_green_file">green_file</code></td>
<td>
<p>data frame. Nutrient Load by source apportionment of
nutrient for each year and catchments.</p>
</td></tr>
<tr><td><code id="nutrient_tserie_+3A_basin_name">basin_name</code></td>
<td>
<p>character. The title of the plot.</p>
</td></tr>
<tr><td><code id="nutrient_tserie_+3A_plot.type">plot.type</code></td>
<td>
<p>character. Alternative of the plot: output load (t) by
source; gr1: Basin average by Shreve (t/y/km2); gr2: Outlet total (kt/y).</p>
</td></tr>
<tr><td><code id="nutrient_tserie_+3A_file_path">file_path</code></td>
<td>
<p>character. The path to save the csv.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for the side effect of drawing a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
data(sh_file)
# the parameter to assess the basin model
alpha_p &lt;- 35.09
alpha_l &lt;- 0.02
sd_coef &lt;- 0.2
# years in which the model should be executed
loc_years &lt;- 1990:2018
# Computing the source apportionment
basin_sa &lt;- green_shares(catch_data_TN, annual_data_TN, alpha_p, alpha_l,
sd_coef, loc_years)
# The title of the plot
plotTitle &lt;- "Time series Load Output for the Lay Basin"
# Output Load Basin average time series (lines)
nutrient_tserie(basin_sa, basin_name = plotTitle, plot.type = "gr1")
# Total Load in the Basin Outlet time series (lines)
nutrient_tserie(basin_sa, basin_name = plotTitle, plot.type = "gr2")


</code></pre>

<hr>
<h2 id='nutrient_tserie_darea'>Output load time series plot</h2><span id='topic+nutrient_tserie_darea'></span>

<h3>Description</h3>

<p>Creates a time series plot showing basin model results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nutrient_tserie_darea(green_file, sh_file, basin_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nutrient_tserie_darea_+3A_green_file">green_file</code></td>
<td>
<p>data frame. Nutrient Load by source apportionment of
nutrient for each year and catchments.</p>
</td></tr>
<tr><td><code id="nutrient_tserie_darea_+3A_sh_file">sh_file</code></td>
<td>
<p>sf object. The spatial information.</p>
</td></tr>
<tr><td><code id="nutrient_tserie_darea_+3A_basin_name">basin_name</code></td>
<td>
<p>character. The title of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for the side effect of drawing a plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
data(sh_file)
# the parameter to assess the basin model
alpha_p &lt;- 35.09
alpha_l &lt;- 0.02
sd_coef &lt;- 0.2
# years in which the model should be executed
loc_years &lt;- 1990:2018
# Computing the source apportionment
basin_sa &lt;- green_shares(catch_data_TN, annual_data_TN, alpha_p, alpha_l,
sd_coef, loc_years)
basin_name &lt;- "Visla Basin"
nutrient_tserie_darea(basin_sa, sh_file, basin_name)


</code></pre>

<hr>
<h2 id='read_geometry'>Read geometry</h2><span id='topic+read_geometry'></span>

<h3>Description</h3>

<p>Function to read the geometry file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_geometry(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_geometry_+3A_file">file</code></td>
<td>
<p>string. A string with the name and extension of the geometry file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One object, a sf file.
</p>

<hr>
<h2 id='read_NSdata'>Read NS data</h2><span id='topic+read_NSdata'></span>

<h3>Description</h3>

<p>Function to read the data and return the data frame for GREEN
execution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_NSdata(path, tsn, obs, ff, rain, topo, lr, length)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_NSdata_+3A_path">path</code></td>
<td>
<p>string. A string with the path of the CSV files.</p>
</td></tr>
<tr><td><code id="read_NSdata_+3A_tsn">tsn</code></td>
<td>
<p>file. A CSV file with nine variables YearValue (integer),
HydroID (integer), Atm (float), Min (float), Man (float), Fix (float),
Soil (float), Sd (float) and Ps (float).</p>
</td></tr>
<tr><td><code id="read_NSdata_+3A_obs">obs</code></td>
<td>
<p>file. A CSV file with three variables YearValue (integer),
HydroID (integer) and YearlyMass (float).</p>
</td></tr>
<tr><td><code id="read_NSdata_+3A_ff">ff</code></td>
<td>
<p>file. A CSV file with three variables YearValue (integer),
HydroID (integer) and ForestFraction (float).</p>
</td></tr>
<tr><td><code id="read_NSdata_+3A_rain">rain</code></td>
<td>
<p>file. A CSV file with three variables YearValue (integer),
HydroID (integer) and Rain (float).</p>
</td></tr>
<tr><td><code id="read_NSdata_+3A_topo">topo</code></td>
<td>
<p>file. A CSV file with two variables HydroID (integer) and
Next_HydroID (integer).</p>
</td></tr>
<tr><td><code id="read_NSdata_+3A_lr">lr</code></td>
<td>
<p>file. A CSV file with three variables HydroID (integer),
AvgDepth (float) and ResTime (float).</p>
</td></tr>
<tr><td><code id="read_NSdata_+3A_length">length</code></td>
<td>
<p>file. A CSV file with two variables HydroID (integer) and
LengthKm (float).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One object, a list with two data frame. First position of the list
contains the catch data and the second one the annual data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
path &lt;- "https://raw.githubusercontent.com/calfarog/GREENeR_data/main/data/csv/"
ns_data &lt;- read_NSdata(path, "TS_nutrients.csv", "Obs_monitoring.csv",
"ForestFr.csv", "Precipitation.csv", "Topology.csv", "LakeProperties.csv",
"Length.csv")


</code></pre>

<hr>
<h2 id='references_plot'>Reference summary plot</h2><span id='topic+references_plot'></span>

<h3>Description</h3>

<p>Summary of the reference values in the stations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>references_plot(annual_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="references_plot_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A barplot, a histogram-density and a boxplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(annual_data_TN)
references_plot(annual_data_TN)

</code></pre>

<hr>
<h2 id='region_nut_balance'>Nutrient balance based in the application of the Geospatial Regression
Equation returning the diffuse, land retention, point sources</h2><span id='topic+region_nut_balance'></span>

<h3>Description</h3>

<p>Computes the basin nutrient balance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>region_nut_balance(
  catch_data,
  annual_data,
  alpha_p,
  alpha_l,
  sd_coef,
  loc_years,
  atm_coeff = 0.38
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="region_nut_balance_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. Definition of the topological sequence of
catchments.</p>
</td></tr>
<tr><td><code id="region_nut_balance_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
<tr><td><code id="region_nut_balance_+3A_alpha_p">alpha_p</code></td>
<td>
<p>numeric. First model parameter, the basin retention
coefficient.</p>
</td></tr>
<tr><td><code id="region_nut_balance_+3A_alpha_l">alpha_l</code></td>
<td>
<p>numeric. Second model parameter, the river retention
coefficient.</p>
</td></tr>
<tr><td><code id="region_nut_balance_+3A_sd_coef">sd_coef</code></td>
<td>
<p>numeric. Third model parameter, fraction of domestic diffuse
sources that reaches the stream network.</p>
</td></tr>
<tr><td><code id="region_nut_balance_+3A_loc_years">loc_years</code></td>
<td>
<p>integer. Years in which the model should be executed.</p>
</td></tr>
<tr><td><code id="region_nut_balance_+3A_atm_coeff">atm_coeff</code></td>
<td>
<p>numeric. A value for atmospheric attenuation coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One object, a data frame with the basin nutrient balance
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
# the parameter to assess the basin model
alpha_p &lt;- 35.09
alpha_l &lt;- 0.02
sd_coef &lt;- 0.2
# year in which the model should be executed
loc_years &lt;- 1990:2018
# Computing the nutrient balance
basin_loads_b &lt;- region_nut_balance(catch_data_TN, annual_data_TN, alpha_p, alpha_l,
sd_coef, loc_years)


</code></pre>

<hr>
<h2 id='scatter_plot'>Scatter plot of goodness-of-fit metric vs parameters</h2><span id='topic+scatter_plot'></span>

<h3>Description</h3>

<p>Scatter plot of goodness-of-fit metric vs parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scatter_plot(df_cb, param)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scatter_plot_+3A_df_cb">df_cb</code></td>
<td>
<p>data frame. A table with the result of the calibration process.</p>
</td></tr>
<tr><td><code id="scatter_plot_+3A_param">param</code></td>
<td>
<p>character. Goodness of fit metric:&quot;NSE&quot;, &quot;rNSE&quot;, &quot;NSE&quot;,
&quot;mNSE&quot;, &quot;MAE&quot;, &quot;PBIAS&quot;, &quot;cp&quot;, &quot;R2&quot;,...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Multiple scatter plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
# the parameter for the calibration of the model
n_iter &lt;- 2 # number of iterations
# the lower limits for all params (alpha_P, alpha_L, sd_coef)
low &lt;- c(10, 0.000, 0.1)
# the upper limits for all params (alpha_P, alpha_L, sd_coef)
upp &lt;- c(70, 0.3,  0.9)
# years in which the model should be executed
years &lt;- 1990:2018
# execution of the calibration
df_calib &lt;- calib_green(catch_data_TN, annual_data_TN, n_iter, low, upp,
years)
gof_mes &lt;- "NSE"
scatter_plot(df_calib, gof_mes)


</code></pre>

<hr>
<h2 id='select_params'>Selection of best calibration parameters</h2><span id='topic+select_params'></span>

<h3>Description</h3>

<p>Return the best calibration parameter set according to one
goodness-of-fit metric
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_params(df_cb, param)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_params_+3A_df_cb">df_cb</code></td>
<td>
<p>data frame. The result of the calibration process.</p>
</td></tr>
<tr><td><code id="select_params_+3A_param">param</code></td>
<td>
<p>numeric. Goodness-of-fit measures. &quot;NSE&quot;, &quot;rNSE&quot;, &quot;NSE&quot;,
&quot;mNSE&quot;, &quot;MAE&quot;, &quot;PBIAS&quot;, &quot;cp&quot;, &quot;R2&quot;,...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the 3 parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# the data of the TN scenario
data(catch_data_TN)
data(annual_data_TN)
# the parameter for the calibration of the model
n_iter &lt;- 2 # number of iterations
# the lower limits for all params (alpha_P, alpha_L, sd_coef)
low &lt;- c(10, 0.000, 0.1)
# the upper limits for all params (alpha_P, alpha_L, sd_coef)
upp &lt;- c(70, 0.3,  0.9)
# years in which the model should be executed
years &lt;- 1990:2018
# execution of the calibration
df_calib &lt;- calib_green(catch_data_TN, annual_data_TN, n_iter, low, upp,
years)
# Extract the best set of parameter according to a Goodnes of fit metric
gof_mes &lt;- "NSE"
NSE_bestParams &lt;- select_params(df_calib, gof_mes)


</code></pre>

<hr>
<h2 id='sh_file'>Sh file</h2><span id='topic+sh_file'></span>

<h3>Description</h3>

<p>An sf (simple features) object  that includes attributes and
geometries in the form of a data frame. Data frame (or tibble) with rows of
features, columns of attributes, and a special geometry column that contains
the spatial aspects of the features
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sh_file
</code></pre>


<h3>Format</h3>

<p>Simple feature collection with 6 features and 14 fields:
</p>

<dl>
<dt><code>OBJECTID</code></dt><dd><p>integer Identifier of the spatial object (one for
each catchment)</p>
</dd>
<dt><code>HydroID</code></dt><dd><p>integer Unique catchment identifier</p>
</dd>
<dt><code>NextDownID</code></dt><dd><p>integer Unique identifier of the catchment to
which the catchment goes</p>
</dd>
<dt><code>BasinID</code></dt><dd><p>integer Identifier of the Basin to all  catchment
belong</p>
</dd>
<dt><code>JunctionID</code></dt><dd><p>integer Unique identifier of the catchment to
which the catchment goes. Note that for the outlet JunctionID == -1</p>
</dd>
<dt><code>AreaSqkm</code></dt><dd><p>double Area of each catchment</p>
</dd>
<dt><code>DrainAreaS</code></dt><dd><p>double Drain Area of each catchment</p>
</dd>
<dt><code>Shreve</code></dt><dd><p>integer Indicates Shreve order, i.e. in headwater = 1;
at the outlet Shreve = max(Shreve)</p>
</dd>
<dt><code>geometry</code></dt><dd><p>sfc objects represent the geometry of a single
feature and contains information about the feature’s coordinates,
dimension, and type of geometry</p>
</dd>
</dl>


<hr>
<h2 id='shreve'>Shreve</h2><span id='topic+shreve'></span>

<h3>Description</h3>

<p>Function to read the data and return the data frame for GREEN
execution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shreve(the_SC)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shreve_+3A_the_sc">the_SC</code></td>
<td>
<p>table. A table with topology data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One object, a data frame with the shreve.
</p>

<hr>
<h2 id='simobs_annual_plot'>Facet year plot</h2><span id='topic+simobs_annual_plot'></span>

<h3>Description</h3>

<p>This function blah, blah, blah....
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simobs_annual_plot(
  catch_data,
  annual_data,
  alpha_p,
  alpha_l,
  sd_coef,
  years,
  name_basin,
  maxvalue
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simobs_annual_plot_+3A_catch_data">catch_data</code></td>
<td>
<p>data frame. Definition of the topological sequence of
catchments.</p>
</td></tr>
<tr><td><code id="simobs_annual_plot_+3A_annual_data">annual_data</code></td>
<td>
<p>data frame. Sources of nutrient for each year and
catchments.</p>
</td></tr>
<tr><td><code id="simobs_annual_plot_+3A_alpha_p">alpha_p</code></td>
<td>
<p>numeric. First model parameter, the basin retention
coefficient.</p>
</td></tr>
<tr><td><code id="simobs_annual_plot_+3A_alpha_l">alpha_l</code></td>
<td>
<p>numeric. Second model parameter, the river retention
coefficient.</p>
</td></tr>
<tr><td><code id="simobs_annual_plot_+3A_sd_coef">sd_coef</code></td>
<td>
<p>numeric. Third model parameter, fraction of domestic diffuse
sources that reaches the stream network.</p>
</td></tr>
<tr><td><code id="simobs_annual_plot_+3A_years">years</code></td>
<td>
<p>integer. Years to be used in the calibration. For sequences use
c(yearini:yearend).</p>
</td></tr>
<tr><td><code id="simobs_annual_plot_+3A_name_basin">name_basin</code></td>
<td>
<p>character. The name of the basin</p>
</td></tr>
<tr><td><code id="simobs_annual_plot_+3A_maxvalue">maxvalue</code></td>
<td>
<p>numeric. The maximum value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One object, a data frame
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
