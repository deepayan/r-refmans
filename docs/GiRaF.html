<!DOCTYPE html><html><head><title>Help for package GiRaF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GiRaF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#exact.mrf'>
<p>Exact sampler for Gibbs Random Fields</p></a></li>
<li><a href='#GiRaF-package'>
<p>A toolbox for Gibbs Random Fields analysis</p></a></li>
<li><a href='#NC.mrf'>
<p>Normalising constant of a Gibbs Random Field</p></a></li>
<li><a href='#sampler.mrf'>
<p>MCMC samplers for Gibbs Random Fields</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Gibbs Random Fields Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-02-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Julien Stoehr, Pierre Pudlo and Nial Friel</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Julien Stoehr &lt;julien.stoehr@ucd.ie&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows calculation on, and
 sampling from Gibbs Random Fields, and more precisely general 
 homogeneous Potts model. The primary tool is the exact computation of
 the intractable normalising constant for small rectangular lattices. 
 Beside the latter function, it contains method that give exact sample from the likelihood
 for small enough rectangular lattices or approximate sample from the 
 likelihood using MCMC samplers for large lattices.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp (&ge; 0.12.3)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, BH</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-14 15:34:52 UTC; hornik</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-14 16:34:25 UTC</td>
</tr>
</table>
<hr>
<h2 id='exact.mrf'>
Exact sampler for Gibbs Random Fields
</h2><span id='topic+exact.mrf'></span>

<h3>Description</h3>

<p>exact.mrf gives exact sample from the likelihood of a general Potts model defined on a rectangular <code class="reqn">h x w</code> lattice (<code class="reqn">h \le w</code>) with either a first order or a second order dependency structure and a small number of rows (up to 19 for 2-state models).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exact.mrf(h, w, param, ncolors = 2, nei = 4,  
          pot = NULL, top = NULL, left = NULL, 
          bottom = NULL, right = NULL, corner = NULL, view = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exact.mrf_+3A_h">h</code></td>
<td>
<p>the number of rows of the rectangular lattice.</p>
</td></tr>
<tr><td><code id="exact.mrf_+3A_w">w</code></td>
<td>
<p>the number of columns of the rectangular lattice.</p>
</td></tr>
<tr><td><code id="exact.mrf_+3A_param">param</code></td>
<td>
<p>numeric entry setting the interaction parameter (edges parameter)</p>
</td></tr>
<tr><td><code id="exact.mrf_+3A_ncolors">ncolors</code></td>
<td>
<p>the number of states for the discrete random variables. By default, ncolors = 2.</p>
</td></tr>
<tr><td><code id="exact.mrf_+3A_nei">nei</code></td>
<td>
<p>the number of neighbors. The latter must be one of nei = 4 or nei = 8, which respectively correspond to a first order and a second order dependency structure. By default, nei = 4.</p>
</td></tr>
<tr><td><code id="exact.mrf_+3A_pot">pot</code></td>
<td>
<p>numeric entry setting homogeneous potential on singletons (vertices parameter). By default, pot = NULL</p>
</td></tr>
<tr><td><code id="exact.mrf_+3A_top">top</code>, <code id="exact.mrf_+3A_left">left</code>, <code id="exact.mrf_+3A_bottom">bottom</code>, <code id="exact.mrf_+3A_right">right</code>, <code id="exact.mrf_+3A_corner">corner</code></td>
<td>
<p>numeric entry setting constant borders for the lattice. By default, top = NULL, left = NULL, bottom = NULL, right = NULL, corner = NULL.</p>
</td></tr>
<tr><td><code id="exact.mrf_+3A_view">view</code></td>
<td>
<p>Logical value indicating whether the draw should be printed. Do not display the optional borders.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Friel, N. and Rue, H. (2007). Recursive computing and simulation-free inference for general factorizable models. <em>Biometrika</em>, <b>94(3)</b>:661&ndash;672.
</p>


<h3>See Also</h3>

<p>The &ldquo;GiRaF-introduction&rdquo; vignette
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dimension of the lattice
height &lt;- 8
width &lt;- 10

# Interaction parameter
Beta &lt;- 0.6 # Isotropic configuration
# Beta &lt;- c(0.6, 0.6) # Anisotropic configuration when nei = 4
# Beta &lt;- c(0.6, 0.6, 0.6, 0.6) # Anisotropic configuration when nei = 8

# Number of colors
K &lt;- 2 
# Number of neighbors 
G &lt;- 4

# Optional potential on sites
potential &lt;- runif(K,-1,1)
# Optional borders. 
Top &lt;- Bottom &lt;- sample(0:(K-1), width, replace = TRUE)
Left &lt;- Right &lt;- sample(0:(K-1), height, replace = TRUE)
Corner &lt;- sample(0:(K-1), 4, replace = TRUE)

# Exact sampling for the default setting
exact.mrf(h = height, w = width, param = Beta, view = TRUE)

# When specifying the number of colors and neighbors
exact.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta, 
          view = TRUE)
          
# When specifying an optional potential on sites
exact.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta, 
       pot = potential, view = TRUE)
       
# When specifying possible borders. The users will omit to mention all
# the non-existing borders
exact.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta, 
       top = Top, left = Left, bottom = Bottom, right = Right, corner = Corner, view = TRUE)
</code></pre>

<hr>
<h2 id='GiRaF-package'>
A toolbox for Gibbs Random Fields analysis
</h2><span id='topic+GiRaF-package'></span><span id='topic+GiRaF'></span>

<h3>Description</h3>

<p><span class="pkg">GiRaF</span> is a package for calculations on, and sampling from Gibbs (or discrete Markov) random fields.
</p>


<h3>Details</h3>

<p><span class="pkg">GiRaF</span> offers various tools for the analysis of Gibbs random fields and more precisely general homogeneous Potts model with possible anisotropy and potential on singletons (cliques composed of single vertex). <span class="pkg">GiRaF</span> substantially lowers the barrier for practitioners aiming at analysing such Gibbs random fields. <span class="pkg">GiRaF</span> contains exact methods for small lattices and several approximate methods for larger lattices that make the analysis easier for practitioners.
</p>
<p>The &ldquo;GiRaF-introduction&rdquo; vignette gives a detailled introduction on the package.
</p>
<p>For a complete list of functions, use library(help = &quot;GiRaF&quot;).
</p>


<h3>Author(s)</h3>

<p>Julien Stoehr, Pierre Pudlo and Nial Friel.
</p>
<p>Maintainer: Julien Stoehr &lt;julien.stoehr@ucd.ie&gt;
</p>


<h3>References</h3>

<p>Friel, N. and Rue, H. (2007). Recursive computing and simulation-free inference for general factorizable models. <em>Biometrika</em>, <b>94(3)</b>:661&ndash;672.
</p>
<p>Geman, S. and Geman, D. (1984). Stochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images. <em>IEEE Transactions on Pattern Analysis and Machine Intellignence</em>, <b>6(6)</b>:721-741.
</p>
<p>Reeves, R. and Pettitt, A. N. (2004). Efficient recursions for general factorisable models. <em>Biometrika</em>, <b>91(3)</b>:751&ndash;757.
</p>
<p>Swendsen, R. H. and Wang, J.-S. (1987). Nonuniversal critical dynamics in Monte Carlo simulations. <em>Pysical Review Letters</em>, <b>58(2)</b>:86-88.
</p>


<h3>See Also</h3>

<p>The &ldquo;GiRaF-introduction&rdquo; vignette
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dimension of the lattice
height &lt;- 8
width &lt;- 10

# Interaction parameter
Beta &lt;- 0.6 # Isotropic configuration
# Beta &lt;- c(0.6, 0.6) # Anisotropic configuration when nei = 4
# Beta &lt;- c(0.6, 0.6, 0.6, 0.6) # Anisotropic configuration when nei = 8

# Number of colors
K &lt;- 2 
# Number of neighbors 
G &lt;- 4

# Optional potential on sites
potential &lt;- runif(K,-1,1)
# Optional borders. 
Top &lt;- Bottom &lt;- sample(0:(K-1), width, replace = TRUE)
Left &lt;- Right &lt;- sample(0:(K-1), height, replace = TRUE)
Corner &lt;- sample(0:(K-1), 4, replace = TRUE)

# Partition function for the default setting
NC.mrf(h = height, w = width, param = Beta)

# When specifying the number of colors and neighbors
NC.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta)

# When specifying an optional potential on sites
NC.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta, 
       pot = potential)
       
# When specifying possible borders. The users will omit to mention all
# the non-existing borders
NC.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta, 
       top = Top, left = Left, bottom = Bottom, right = Right, corner = Corner)
       
# Exact sampling for the default setting
exact.mrf(h = height, w = width, param = Beta, view = TRUE)

# When specifying the number of colors and neighbors
exact.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta, 
          view = TRUE)
          
# When specifying an optional potential on sites
exact.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta, 
       pot = potential, view = TRUE)
       
# When specifying possible borders. The users will omit to mention all
# the non-existing borders
exact.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta, 
       top = Top, left = Left, bottom = Bottom, right = Right, corner = Corner, view = TRUE)
       
# Algorithm settings
n &lt;- 200
method &lt;- "Gibbs"

# Sampling method for the default setting
sampler.mrf(iter = n, sampler = method, h = height, w = width, 
            param = Beta, view = TRUE)
            
# Sampling using an existing configuration as starting point
sampler.mrf(iter = n, sampler = method, h = height, w = width, 
            ncolors = K, nei = G, param = Beta, 
            initialise = FALSE, view = TRUE)
            
# Specifying optional arguments. The users may omit to mention all
# the non-existing borders
sampler.mrf(iter = n, sampler = method, h = height, w = width, 
            ncolors = K, nei = G, param = Beta,
            pot = potential, top = Top, left = Left, bottom = Bottom, 
            right = Right, corner = Corner, view = TRUE)
            
# Gibbs sampler with sequential updates of the sites. 
sampler.mrf(iter = n, sampler = "Gibbs", h = height, w = width, 
            ncolors = K, nei = G, param = Beta,
            random = FALSE, view = TRUE)
</code></pre>

<hr>
<h2 id='NC.mrf'>
Normalising constant of a Gibbs Random Field
</h2><span id='topic+NC.mrf'></span>

<h3>Description</h3>

<p>Partition function of a general Potts model defined on a rectangular <code class="reqn">h x w</code> lattice (<code class="reqn">h \le w</code>) with either a first order or a second order dependency structure and a small number of rows (up to 25 for 2-state models).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NC.mrf(h, w, param, ncolors = 2, nei = 4,  
       pot = NULL, top = NULL, left = NULL, 
       bottom = NULL, right = NULL, corner = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NC.mrf_+3A_h">h</code></td>
<td>
<p>the number of rows of the rectangular lattice.</p>
</td></tr>
<tr><td><code id="NC.mrf_+3A_w">w</code></td>
<td>
<p>the number of columns of the rectangular lattice.</p>
</td></tr>
<tr><td><code id="NC.mrf_+3A_param">param</code></td>
<td>
<p>numeric entry setting the interaction parameter (edges parameter)</p>
</td></tr>
<tr><td><code id="NC.mrf_+3A_ncolors">ncolors</code></td>
<td>
<p>the number of states for the discrete random variables. By default, ncolors = 2.</p>
</td></tr>
<tr><td><code id="NC.mrf_+3A_nei">nei</code></td>
<td>
<p>the number of neighbors. The latter must be one of nei = 4 or nei = 8, which respectively correspond to a first order and a second order dependency structure. By default, nei = 4.</p>
</td></tr>
<tr><td><code id="NC.mrf_+3A_pot">pot</code></td>
<td>
<p>numeric entry setting homogeneous potential on singletons (vertices parameter). By default, pot = NULL</p>
</td></tr>
<tr><td><code id="NC.mrf_+3A_top">top</code>, <code id="NC.mrf_+3A_left">left</code>, <code id="NC.mrf_+3A_bottom">bottom</code>, <code id="NC.mrf_+3A_right">right</code>, <code id="NC.mrf_+3A_corner">corner</code></td>
<td>
<p>numeric entry setting constant borders for the lattice. By default, top = NULL, left = NULL, bottom = NULL, right = NULL, corner = NULL.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Friel, N. and Rue, H. (2007). Recursive computing and simulation-free inference for general factorizable models. <em>Biometrika</em>, <b>94(3)</b>:661&ndash;672.
</p>
<p>Reeves, R. and Pettitt, A. N. (2004). Efficient recursions for general factorisable models. <em>Biometrika</em>, <b>91(3)</b>:751&ndash;757.
</p>


<h3>See Also</h3>

<p>The &ldquo;GiRaF-introduction&rdquo; vignette
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dimension of the lattice
height &lt;- 8
width &lt;- 10

# Interaction parameter
Beta &lt;- 0.6 # Isotropic configuration
# Beta &lt;- c(0.6, 0.6) # Anisotropic configuration when nei = 4
# Beta &lt;- c(0.6, 0.6, 0.6, 0.6) # Anisotropic configuration when nei = 8

# Number of colors
K &lt;- 2 
# Number of neighbors 
G &lt;- 4

# Optional potential on sites
potential &lt;- runif(K,-1,1)
# Optional borders. 
Top &lt;- Bottom &lt;- sample(0:(K-1), width, replace = TRUE)
Left &lt;- Right &lt;- sample(0:(K-1), height, replace = TRUE)
Corner &lt;- sample(0:(K-1), 4, replace = TRUE)

# Partition function for the default setting
NC.mrf(h = height, w = width, param = Beta)

# When specifying the number of colors and neighbors
NC.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta)

# When specifying an optional potential on sites
NC.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta, 
       pot = potential)
       
# When specifying possible borders. The users will omit to mention all
# the non-existing borders
NC.mrf(h = height, w = width, ncolors = K, nei = G, param = Beta, 
       top = Top, left = Left, bottom = Bottom, right = Right, corner = Corner)
</code></pre>

<hr>
<h2 id='sampler.mrf'>
MCMC samplers for Gibbs Random Fields
</h2><span id='topic+sampler.mrf'></span>

<h3>Description</h3>

<p>sampler.mrf gives approximate sample from the likelihood of a general Potts model defined on a rectangular <code class="reqn">h x w</code> lattice (<code class="reqn">h \le w</code>) with either a first order or a second order dependency structure. Available options are the Gibbs sampler (Geman and Geman (1984)) and the Swendsen-Wang algorithm (Swendsen and Wang (1987)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampler.mrf(iter, sampler = "Gibbs" , h, w, 
          param, ncolors = 2, nei = 4, pot = NULL, 
          top = NULL, left = NULL, bottom = NULL, right = NULL, 
          corner = NULL, initialise = TRUE, random = TRUE, view = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampler.mrf_+3A_iter">iter</code></td>
<td>
<p>Number of iterations of the algorithm.</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_sampler">sampler</code></td>
<td>
<p>The method to be used. The latter must be one of &quot;Gibbs&quot; or &quot;SW&quot; corresponding respectively to the Gibbs sampler and the Swendsen-Wang algorithm.</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_h">h</code></td>
<td>
<p>the number of rows of the rectangular lattice.</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_w">w</code></td>
<td>
<p>the number of columns of the rectangular lattice.</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_param">param</code></td>
<td>
<p>numeric entry setting the interaction parameter (edges parameter)</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_ncolors">ncolors</code></td>
<td>
<p>the number of states for the discrete random variables. By default, ncolors = 2.</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_nei">nei</code></td>
<td>
<p>the number of neighbors. The latter must be one of nei = 4 or nei = 8, which respectively correspond to a first order and a second order dependency structure. By default, nei = 4.</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_pot">pot</code></td>
<td>
<p>numeric entry setting homogeneous potential on singletons (vertices parameter). By default, pot = NULL</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_top">top</code>, <code id="sampler.mrf_+3A_left">left</code>, <code id="sampler.mrf_+3A_bottom">bottom</code>, <code id="sampler.mrf_+3A_right">right</code>, <code id="sampler.mrf_+3A_corner">corner</code></td>
<td>
<p>numeric entry setting constant borders for the lattice. By default, top = NULL, left = NULL, bottom = NULL, right = NULL, corner = NULL.</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_initialise">initialise</code></td>
<td>
<p>Logical value indicating whether initial guess should be randomly drawn.</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_random">random</code></td>
<td>
<p>Logical value indicating whether the sites should be updated sequentially or randomdly. Used only with the &quot;Gibbs&quot; option.</p>
</td></tr>
<tr><td><code id="sampler.mrf_+3A_view">view</code></td>
<td>
<p>Logical value indicating whether the draw should be printed. Do not display the optional borders.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Geman, S. and Geman, D. (1984). Stochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images. <em>IEEE Transactions on Pattern Analysis and Machine Intellignence</em>, <b>6(6)</b>:721-741.
</p>
<p>Swendsen, R. H. and Wang, J.-S. (1987). Nonuniversal critical dynamics in Monte Carlo simulations. <em>Pysical Review Letters</em>, <b>58(2)</b>:86-88.
</p>


<h3>See Also</h3>

<p>The &ldquo;GiRaF-introduction&rdquo; vignette
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Algorithm settings
n &lt;- 200
method &lt;- "Gibbs"

# Dimension of the lattice
height &lt;- width &lt;- 100

# Interaction parameter
Beta &lt;- 0.6 # Isotropic configuration
# Beta &lt;- c(0.6, 0.6) # Anisotropic configuration when nei = 4
# Beta &lt;- c(0.6, 0.6, 0.6, 0.6) # Anisotropic configuration when nei = 8

# Number of colors
K &lt;- 2 
# Number of neighbors 
G &lt;- 4

# Optional potential on sites
potential &lt;- runif(K,-1,1)
# Optional borders. 
Top &lt;- Bottom &lt;- sample(0:(K-1), width, replace = TRUE)
Left &lt;- Right &lt;- sample(0:(K-1), height, replace = TRUE)
Corner &lt;- sample(0:(K-1), 4, replace = TRUE)

# Sampling method for the default setting
sampler.mrf(iter = n, sampler = method, h = height, w = width, 
            param = Beta, view = TRUE)
            
# Sampling using an existing configuration as starting point
sampler.mrf(iter = n, sampler = method, h = height, w = width, 
            ncolors = K, nei = G, param = Beta, 
            initialise = FALSE, view = TRUE)
            
# Specifying optional arguments. The users may omit to mention all
# the non-existing borders
sampler.mrf(iter = n, sampler = method, h = height, w = width, 
            ncolors = K, nei = G, param = Beta,
            pot = potential, top = Top, left = Left, bottom = Bottom, 
            right = Right, corner = Corner, view = TRUE)
            
# Gibbs sampler with sequential updates of the sites. 
sampler.mrf(iter = n, sampler = "Gibbs", h = height, w = width, 
            ncolors = K, nei = G, param = Beta,
            random = FALSE, view = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
