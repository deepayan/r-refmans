<!DOCTYPE html><html lang="en"><head><title>Help for package phylolm.hp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phylolm.hp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#creatbin'><p>Internal function for glmm.hp() to create diagonal matrix</p></a></li>
<li><a href='#genList'><p>Internal function for glmm.hp()</p></a></li>
<li><a href='#odd'><p>Internal function for glmm.hp() to determine whether the odd number</p></a></li>
<li><a href='#phyloglm.hp'><p>Hierarchical Partitioning of R2 for Phylogenetic Generalized Linear Regression</p></a></li>
<li><a href='#phylolm.hp'><p>Hierarchical Partitioning of R2 for Phylogenetic Linear Regression</p></a></li>
<li><a href='#plot.phyloglmhp'><p>Plot for a <code>phyloglm.hp</code> object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hierarchical Partitioning of R2 for Phylogenetic Linear
Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-30</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0),rr2,phylolm,ggplot2,vegan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiangshan Lai &lt;lai@njfu.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Conducts hierarchical partitioning to calculate individual contributions of phylogenetic tree and  predictors (groups) towards total R2  for phylogenetic linear regression models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/laijiangshan/phylolm.hp">https://github.com/laijiangshan/phylolm.hp</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-01 00:02:16 UTC; lai</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiangshan Lai <a href="https://orcid.org/0000-0002-0279-8816"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Gang Wang [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-05 15:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='creatbin'>Internal function for glmm.hp() to create diagonal matrix</h2><span id='topic+creatbin'></span>

<h3>Description</h3>

<p>Internal function for glmm.hp() to create diagonal matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>creatbin(col, binmatrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="creatbin_+3A_col">col</code></td>
<td>
<p>Imput number.</p>
</td></tr>
<tr><td><code id="creatbin_+3A_binmatrix">binmatrix</code></td>
<td>
<p>Imput empty matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix
</p>
<table role = "presentation">
<tr><td><code>a matix</code></td>
<td>
<p>A diagonal matrix</p>
</td></tr>
</table>

<hr>
<h2 id='genList'>Internal function for glmm.hp()</h2><span id='topic+genList'></span>

<h3>Description</h3>

<p>Internal function for glmm.hp()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genList(ivlist, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genList_+3A_ivlist">ivlist</code></td>
<td>
<p>The names of explanatory variable.</p>
</td></tr>
<tr><td><code id="genList_+3A_value">value</code></td>
<td>
<p>The sequence ID.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector
</p>
<table role = "presentation">
<tr><td><code>newlist</code></td>
<td>
<p>A vector for variable index.</p>
</td></tr>
</table>

<hr>
<h2 id='odd'>Internal function for glmm.hp() to determine whether the odd number</h2><span id='topic+odd'></span>

<h3>Description</h3>

<p>Internal function for glmm.hp() to determine whether the odd number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odd(val)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="odd_+3A_val">val</code></td>
<td>
<p>Imput number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical value
</p>
<table role = "presentation">
<tr><td><code>Logical value</code></td>
<td>
<p>TRUE or FALSE</p>
</td></tr>
</table>

<hr>
<h2 id='phyloglm.hp'>Hierarchical Partitioning of R2 for Phylogenetic Generalized Linear Regression</h2><span id='topic+phyloglm.hp'></span>

<h3>Description</h3>

<p>Hierarchical Partitioning of R2 for Phylogenetic Generalized Linear Regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phyloglm.hp(mod, iv = NULL, commonality = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phyloglm.hp_+3A_mod">mod</code></td>
<td>
<p>Fitted phylolm or phyloglm model objects.</p>
</td></tr>
<tr><td><code id="phyloglm.hp_+3A_iv">iv</code></td>
<td>
<p>optional the relative importance of predicotr groups will be evaluated. The input for iv should be a list containing the names of each group of variables. The variable names must be the names of the predictor variables in mod.</p>
</td></tr>
<tr><td><code id="phyloglm.hp_+3A_commonality">commonality</code></td>
<td>
<p>Logical; If TRUE, the result of commonality analysis is shown, the default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function conducts hierarchical partitioning to calculate the individual contributions of phylogenetic signal and each predictor towards total R2 from rr2 package for phylogenetic linear regression.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Total.R2</code></td>
<td>
<p>The R2 for the full model.</p>
</td></tr>
<tr><td><code>commonality.analysis</code></td>
<td>
<p>If commonality=TRUE, a matrix containing the value and percentage of all commonality (2^N-1 for N predictors or matrices).</p>
</td></tr>
<tr><td><code>Individual.R2</code></td>
<td>
<p>A matrix containing individual effects and percentage of individual effects for phylogenetic tree and each predictor</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jiangshan Lai <a href="mailto:lai@njfu.edu.cn">lai@njfu.edu.cn</a>
</p>


<h3>References</h3>


<ul>
<li><p> Lai J.,Zhu W., Cui D.,Mao L.(2023)Extension of the glmm.hp package to Zero-Inflated generalized linear mixed models and multiple regression.Journal of Plant Ecology,16(6):rtad038&lt;DOI:10.1093/jpe/rtad038&gt;
</p>
</li>
<li><p> Lai J.,Zou Y., Zhang S.,Zhang X.,Mao L.(2022)glmm.hp: an R package for computing individual effect of predictors in generalized linear mixed models.Journal of Plant Ecology,15(6):1302-1307&lt;DOI:10.1093/jpe/rtac096&gt;
</p>
</li>
<li><p> Lai J.,Zou Y., Zhang J.,Peres-Neto P.(2022) Generalizing hierarchical and variation partitioning in multiple regression and canonical analyses using the rdacca.hp R package.Methods in Ecology and Evolution,13(4):782-788&lt;DOI:10.1111/2041-210X.13800&gt;
</p>
</li>
<li><p> Chevan, A. &amp; Sutherland, M. (1991). Hierarchical partitioning. American Statistician, 45, 90-96. doi:10.1080/00031305.1991.10475776
</p>
</li>
<li><p> Nimon, K., Oswald, F.L. &amp; Roberts, J.K. (2013). Yhat: Interpreting regression effects. R package version 2.0.0.
</p>
</li>
<li><p> Nimon, Ho, L. S. T. and Ane, C. 2014. &quot;A linear-time algorithm for Gaussian and non-Gaussian trait evolution models&quot;. Systematic Biology 63(3):397-408.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(phylolm)
library(rr2)
set.seed(231)
tre &lt;- rcoal(60)
taxa &lt;- sort(tre$tip.label) 
b0 &lt;- 0      
b1 &lt;- 0.3    
b2 &lt;- 0.5 
b3 &lt;- 0.4
x &lt;- rTrait(n=1, phy=tre, model="lambda", parameters=list(ancestral.state=0, sigma2=15, lambda=0.9))          
x2 &lt;- rTrait(n=1, phy=tre, model="lambda",  
parameters=list(ancestral.state=0, sigma2=10, lambda=0.9))  
x3 &lt;- rTrait(n=1, phy=tre, model="lambda",  
parameters=list(ancestral.state=0, sigma2=13, lambda=0.9)) 
y &lt;- b0 + b1 * x + b2 * x2 + b3*x3+ rTrait(n=1, phy=tre, model="lambda",
parameters=list(ancestral.state=0, sigma2=5, lambda=0.9))            
dat &lt;- data.frame(trait=y[taxa], pred=x[taxa], pred2=x2[taxa],pred3=x3[taxa])
fit &lt;- phylolm(trait ~ pred + pred2 + pred3, data=dat, phy=tre, model="lambda")
phyloglm.hp(fit,commonality=TRUE)
iv=list(env1="pred",env2=c("pred2","pred3"))
phyloglm.hp(fit,iv)
set.seed(123456)
tre &lt;- rtree(50)
x1 &lt;- rTrait(n=1, phy=tre)  
x2 &lt;- rTrait(n=1, phy=tre)
x3 &lt;- rTrait(n=1, phy=tre)
X &lt;- cbind(rep(1, 50), x1, x2, x3)
y &lt;- rbinTrait(n=1, phy=tre, beta=c(-1, 0.9, 0.9, 0.5), alpha=1, X=X)
dat &lt;- data.frame(trait01=y, predictor1=x1, predictor2=x2, predictor3=x3)
fit &lt;- phyloglm(trait01 ~ predictor1 + predictor2 + predictor3, phy=tre, data=dat)
phyloglm.hp(fit)
iv=list(env1="predictor1",env2=c("predictor2","predictor3"))
phyloglm.hp(fit,iv)
</code></pre>

<hr>
<h2 id='phylolm.hp'>Hierarchical Partitioning of R2 for Phylogenetic Linear Regression</h2><span id='topic+phylolm.hp'></span>

<h3>Description</h3>

<p>Hierarchical Partitioning of R2 for Phylogenetic Linear Regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylolm.hp(mod, iv = NULL, commonality = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phylolm.hp_+3A_mod">mod</code></td>
<td>
<p>Fitted phylolm or phyloglm model objects.</p>
</td></tr>
<tr><td><code id="phylolm.hp_+3A_iv">iv</code></td>
<td>
<p>optional the relative importance of predicotr groups will be evaluated. The input for iv should be a list containing the names of each group of variables. The variable names must be the names of the predictor variables in mod.</p>
</td></tr>
<tr><td><code id="phylolm.hp_+3A_commonality">commonality</code></td>
<td>
<p>Logical; If TRUE, the result of commonality analysis is shown, the default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function conducts hierarchical partitioning to calculate the individual contributions of phylogenetic signal and each predictor towards total R2 from rr2 package for phylogenetic linear regression.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Total.R2</code></td>
<td>
<p>The R2 for the full model.</p>
</td></tr>
<tr><td><code>commonality.analysis</code></td>
<td>
<p>If commonality=TRUE, a matrix containing the value and percentage of all commonality (2^N-1 for N predictors or matrices).</p>
</td></tr>
<tr><td><code>Individual.R2</code></td>
<td>
<p>A matrix containing individual effects and percentage of individual effects for phylogenetic tree and each predictor</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jiangshan Lai <a href="mailto:lai@njfu.edu.cn">lai@njfu.edu.cn</a>
</p>


<h3>References</h3>


<ul>
<li><p> Lai J.,Zhu W., Cui D.,Mao L.(2023)Extension of the glmm.hp package to Zero-Inflated generalized linear mixed models and multiple regression.Journal of Plant Ecology,16(6):rtad038&lt;DOI:10.1093/jpe/rtad038&gt;
</p>
</li>
<li><p> Lai J.,Zou Y., Zhang S.,Zhang X.,Mao L.(2022)glmm.hp: an R package for computing individual effect of predictors in generalized linear mixed models.Journal of Plant Ecology,15(6):1302-1307&lt;DOI:10.1093/jpe/rtac096&gt;
</p>
</li>
<li><p> Lai J.,Zou Y., Zhang J.,Peres-Neto P.(2022) Generalizing hierarchical and variation partitioning in multiple regression and canonical analyses using the rdacca.hp R package.Methods in Ecology and Evolution,13(4):782-788&lt;DOI:10.1111/2041-210X.13800&gt;
</p>
</li>
<li><p> Chevan, A. &amp; Sutherland, M. (1991). Hierarchical partitioning. American Statistician, 45, 90-96. doi:10.1080/00031305.1991.10475776
</p>
</li>
<li><p> Nimon, K., Oswald, F.L. &amp; Roberts, J.K. (2013). Yhat: Interpreting regression effects. R package version 2.0.0.
</p>
</li>
<li><p> Nimon, Ho, L. S. T. and Ane, C. 2014. &quot;A linear-time algorithm for Gaussian and non-Gaussian trait evolution models&quot;. Systematic Biology 63(3):397-408.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(phylolm)
library(rr2)
set.seed(231)
tre &lt;- rcoal(60)
taxa &lt;- sort(tre$tip.label) 
b0 &lt;- 0      
b1 &lt;- 0.3    
b2 &lt;- 0.5 
b3 &lt;- 0.4
x &lt;- rTrait(n=1, phy=tre, model="lambda", parameters=list(ancestral.state=0, sigma2=15, lambda=0.9))          
x2 &lt;- rTrait(n=1, phy=tre, model="lambda",  
parameters=list(ancestral.state=0, sigma2=10, lambda=0.9))  
x3 &lt;- rTrait(n=1, phy=tre, model="lambda",  
parameters=list(ancestral.state=0, sigma2=13, lambda=0.9)) 
y &lt;- b0 + b1 * x + b2 * x2 + b3*x3+ rTrait(n=1, phy=tre, model="lambda",
parameters=list(ancestral.state=0, sigma2=5, lambda=0.9))            
dat &lt;- data.frame(trait=y[taxa], pred=x[taxa], pred2=x2[taxa],pred3=x3[taxa])
fit &lt;- phylolm(trait ~ pred + pred2 + pred3, data=dat, phy=tre, model="lambda")
phylolm.hp(fit,commonality=TRUE)
iv=list(env1="pred",env2=c("pred2","pred3"))
phylolm.hp(fit,iv)
set.seed(123456)
tre &lt;- rtree(50)
x1 &lt;- rTrait(n=1, phy=tre)  
x2 &lt;- rTrait(n=1, phy=tre)
x3 &lt;- rTrait(n=1, phy=tre)
X &lt;- cbind(rep(1, 50), x1, x2, x3)
y &lt;- rbinTrait(n=1, phy=tre, beta=c(-1, 0.9, 0.9, 0.5), alpha=1, X=X)
dat &lt;- data.frame(trait01=y, predictor1=x1, predictor2=x2, predictor3=x3)
fit &lt;- phyloglm(trait01 ~ predictor1 + predictor2 + predictor3, phy=tre, data=dat)
phylolm.hp(fit)
iv=list(env1="predictor1",env2=c("predictor2","predictor3"))
phylolm.hp(fit,iv)
</code></pre>

<hr>
<h2 id='plot.phyloglmhp'>Plot for a <code><a href="#topic+phyloglm.hp">phyloglm.hp</a></code> object</h2><span id='topic+plot.phyloglmhp'></span>

<h3>Description</h3>

<p>Plot for a <code><a href="#topic+phyloglm.hp">phyloglm.hp</a></code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phyloglmhp'
plot(x, plot.perc = FALSE, commonality = FALSE, color = NULL, dig = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.phyloglmhp_+3A_x">x</code></td>
<td>
<p>A <code><a href="#topic+phyloglm.hp">phyloglm.hp</a></code> object.</p>
</td></tr>
<tr><td><code id="plot.phyloglmhp_+3A_plot.perc">plot.perc</code></td>
<td>
<p>Logical;if TRUE, the bar plot (based on ggplot2 package) of the percentage to individual effects of variables and phylogenetic signal towards total explained variation, the default is FALSE to show plot with original individual effects.</p>
</td></tr>
<tr><td><code id="plot.phyloglmhp_+3A_commonality">commonality</code></td>
<td>
<p>Logical; If TRUE, the result of commonality analysis is shown, the default is FALSE.</p>
</td></tr>
<tr><td><code id="plot.phyloglmhp_+3A_color">color</code></td>
<td>
<p>Color of variables.</p>
</td></tr>
<tr><td><code id="plot.phyloglmhp_+3A_dig">dig</code></td>
<td>
<p>Integer; number of decimal places in Venn diagram.</p>
</td></tr>
<tr><td><code id="plot.phyloglmhp_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object
</p>


<h3>Author(s)</h3>

<p>Jiangshan Lai <a href="mailto:lai@njfu.edu.cn">lai@njfu.edu.cn</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(phylolm)
library(rr2)
set.seed(123456)
tre &lt;- rtree(50)
x1 &lt;- rTrait(n=1, phy=tre)  
x2 &lt;- rTrait(n=1, phy=tre)
X &lt;- cbind(rep(1, 50), x1, x2)
y &lt;- rbinTrait(n=1, phy=tre, beta=c(-1, 0.8, 0.9), alpha=1, X=X)
dat &lt;- data.frame(trait01=y, predictor1=x1, predictor2=x2)
fit &lt;- phyloglm(trait01 ~ predictor1 + predictor2, phy=tre, data=dat)
plot(phyloglm.hp(fit,commonality=TRUE))
plot(phyloglm.hp(fit,commonality=TRUE),commonality=TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
