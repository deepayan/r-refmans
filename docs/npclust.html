<!DOCTYPE html><html><head><title>Help for package npclust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {npclust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ARTIS'><p>Asthma Randomized Trial of Indoor-Wood Smoke Data</p></a></li>
<li><a href='#ConfInterval'><p>Confidence Interval</p></a></li>
<li><a href='#ncda'><p>Nonparametric Clustered Data Analysis</p></a></li>
<li><a href='#Plot.box'><p>Box plots.</p></a></li>
<li><a href='#Plot.ConfInt'><p>Bar plots for two-sided confidence intervals</p></a></li>
<li><a href='#ProcessData'><p>Process data set.</p></a></li>
<li><a href='#skin'><p>Skin Irritation Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Tests for Incomplete Clustered Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-08</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yue Cui &lt;YueCui@MissouriState.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Nonparametric tests for clustered data in pre-post intervention design documented in Cui and Harrar (2021) &lt;<a href="https://doi.org/10.1002%2Fbimj.201900310">doi:10.1002/bimj.201900310</a>&gt; and Harrar and Cui (2022) &lt;<a href="https://doi.org/10.1016%2Fj.jspi.2022.05.009">doi:10.1016/j.jspi.2022.05.009</a>&gt;. Other than the main test results mentioned in the reference paper, this package also provides a function to calculate the sample size allocations for the input long format data set, and also a function for adjusted/unadjusted confidence intervals calculations. There are also functions to visualize the distribution of data across different intervention groups over time, and also the adjusted/unadjusted confidence intervals.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-12 18:50:02 UTC</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, MASS, ggplot2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-12 00:01:37 UTC; yuecui</td>
</tr>
<tr>
<td>Author:</td>
<td>Yue Cui <a href="https://orcid.org/0000-0002-7304-9409"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Solomon W. Harrar [ctb]</td>
</tr>
</table>
<hr>
<h2 id='ARTIS'>Asthma Randomized Trial of Indoor-Wood Smoke Data</h2><span id='topic+ARTIS'></span>

<h3>Description</h3>

<p>A subset of the data set from a randomized trial of interventions to improve childhood asthma
in homes with wood-burning stoves. The original data was collected on 115 children
with asthma living in 98 eligible households. The outcomes are domain scores
for Pediatric Asthma Quality of Life Questionnaire (PAQLQ) in symptoms, activity
limitation and emotional function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARTIS
</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows and 6 variables:
</p>

<dl>
<dt><code>homeid </code></dt><dd><p>unique id for each household</p>
</dd>
<dt><code>intervention </code></dt><dd><p>indicator for intervention, where 0 = pre-intervention, 1=after-intervention</p>
</dd>
<dt><code>tx </code></dt><dd><p>intervention type, where 1 = sham fiter, 2 = updated wood-burning stove, 3 = air-filter</p>
</dd>
<dt><code>symptoms_pqol </code></dt><dd><p>PAQLQ for symtoms</p>
</dd>
<dt><code>act_pqol </code></dt><dd><p>PAQLQ score for activity</p>
</dd>
<dt><code>emot_pqol </code></dt><dd><p>PAQLQ score for emotional function</p>
</dd>
</dl>



<h3>Source</h3>

<p>Noonan, Curtis W., and Tony J. Ward. &quot;Asthma randomized trial of indoor
wood smoke (ARTIS): rationale and methods.&quot;
Contemporary clinical trials 33, no. 5 (2012): 1080-1087.
</p>


<h3>References</h3>

<p>Noonan, Curtis W., Erin O. Semmens, Paul Smith, Solomon W.
Harrar, Luke Montrose, Emily Weiler, Marcy McNamara, and Tony J. Ward.
&quot;Randomized trial of interventions to improve childhood asthma in homes
with wood-burning stoves.&quot;
Environmental health perspectives 125, no. 9 (2017): 097010.
([PubMed](https://pubmed.ncbi.nlm.nih.gov/28935614/));
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ARTIS)
head(ARTIS)
</code></pre>

<hr>
<h2 id='ConfInterval'>Confidence Interval</h2><span id='topic+ConfInterval'></span>

<h3>Description</h3>

<p>Construct confidence intervals for effect sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ConfInterval(object, level, side="two.sided",
adjust=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ConfInterval_+3A_object">object</code></td>
<td>
<p>a fitted model object from ncda().</p>
</td></tr>
<tr><td><code id="ConfInterval_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="ConfInterval_+3A_side">side</code></td>
<td>
<p>a character string specifying the side of the confidence bound,
must be one of &quot;two.sided&quot; (default), &quot;left&quot; or &quot;right&quot;.</p>
</td></tr>
<tr><td><code id="ConfInterval_+3A_adjust">adjust</code></td>
<td>
<p>an optional character string specifying the multiple adjustment method,
by default there is no adjustment, if specified, must be one of &quot;Bonferroni&quot; or &quot;Working-Hotelling&quot;.
You can specify just the initial letter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list or a vector. If the confidence interval is two-sided, lower and
upper bounds are stored in lists for each nonparametric effect size estimate.
Otherwise, the lower/upper bounds are stored in vectors in the order of the effect size estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>skin_analysis &lt;- ncda(score~tx, skin, intervention, subject,
                      indicator=c("control","treatment"),
                      Contrast=matrix(c(1,-1), nrow = 1))
ConfInterval(skin_analysis,0.95)

ARTIS_analysis &lt;- ncda(emot_pqol~tx, ARTIS, intervention, homeid,
                       indicator = c("0","1"))
ConfInterval(ARTIS_analysis,0.95)
ConfInterval(ARTIS_analysis,0.95,"two.sided","B")
ConfInterval(ARTIS_analysis,0.95,"left","W")

</code></pre>

<hr>
<h2 id='ncda'>Nonparametric Clustered Data Analysis</h2><span id='topic+ncda'></span>

<h3>Description</h3>

<p>Main function to calculate nonparametric effect sizes and conduct hypothesis tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ncda(formula,data,period,subject,indicator=NULL,Contrast=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ncda_+3A_formula">formula</code></td>
<td>
<p>An object of class &quot;formula&quot; (or one that can be coerced to that class):
a symbolic description of the model to be fitted. The details of model specification are
given under ‘Details’.</p>
</td></tr>
<tr><td><code id="ncda_+3A_data">data</code></td>
<td>
<p>a data frame in the long format.</p>
</td></tr>
<tr><td><code id="ncda_+3A_period">period</code></td>
<td>
<p>time indicator variable.</p>
</td></tr>
<tr><td><code id="ncda_+3A_subject">subject</code></td>
<td>
<p>subject or cluster ID</p>
</td></tr>
<tr><td><code id="ncda_+3A_indicator">indicator</code></td>
<td>
<p>an optional vector of characters indicating the order of pre and post intervention period;
must match the levels of period argument if specified; if not specified, the pre and post intervention
period will be ordered in the alphabet order by default</p>
</td></tr>
<tr><td><code id="ncda_+3A_contrast">Contrast</code></td>
<td>
<p>an optional contrast matrix for effect sizes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model has the form response ~ tx where response is the (numeric)
response variable and tx is the treatment variable.
</p>


<h3>Value</h3>

<p>An object with effect sizes and other test details.
</p>


<h3>References</h3>

<p>Cui, Yue, Frank Konietschke, and Solomon W. Harrar. &quot;The
nonparametric Behrens–Fisher problem in partially complete clustered data.&quot;
Biometrical Journal 63.1 (2021): 148-167.
</p>
<p>Harrar, Solomon W., and Yue Cui. &quot;Nonparametric methods for clustered data
in pre-post intervention design.&quot; Journal of Statistical Planning and
Inference 222 (2023): 1-21.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ARTIS_analysis &lt;- ncda(symptoms_pqol~tx, ARTIS, intervention, homeid,
                        indicator=c("0","1"),
                        Contrast=matrix(c(1,-1,1,-1,1,-1), nrow = 1))
names(ARTIS_analysis)
ARTIS_analysis$p.vector

skin_analysis &lt;- ncda(score~tx, skin, intervention, subject,
                      indicator=c("control","treatment"),
                      Contrast=matrix(c(1,-1), nrow = 1))
skin_analysis$TotalSampleSize
skin_analysis$p.vector
</code></pre>

<hr>
<h2 id='Plot.box'>Box plots.</h2><span id='topic+Plot.box'></span>

<h3>Description</h3>

<p>Box plot of the input data set by treatments and time period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.box(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Plot.box_+3A_object">object</code></td>
<td>
<p>a fitted model object from ncda() or a processed data set from ProcessData()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Box plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Plot from analysis object

ARTIS_analysis &lt;- ncda(emot_pqol~tx, ARTIS, intervention, homeid,
                       indicator = c("0","1"))
Plot.box(ARTIS_analysis)

skin_analysis &lt;- ncda(score~tx, skin, intervention, subject,
                      indicator = c("control","treatment"))
Plot.box(skin_analysis)
# Plot from processed data set
ARTIS_result &lt;- ProcessData(ARTIS, tx, intervention, homeid, symptoms_pqol,
                            indicator = c("0","1"))
skin_result &lt;- ProcessData(skin, tx, intervention, subject, score,
                           indicator = c("control","treatment"))
Plot.box(ARTIS_result)
Plot.box(skin_result)
</code></pre>

<hr>
<h2 id='Plot.ConfInt'>Bar plots for two-sided confidence intervals</h2><span id='topic+Plot.ConfInt'></span>

<h3>Description</h3>

<p>Bar plots for two-sided confidence intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.ConfInt(object, level, side="two.sided",
adjust=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Plot.ConfInt_+3A_object">object</code></td>
<td>
<p>a fitted model object from ncda().</p>
</td></tr>
<tr><td><code id="Plot.ConfInt_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="Plot.ConfInt_+3A_side">side</code></td>
<td>
<p>a character string specifying the side of the confidence bound,
must be one of &quot;two.sided&quot; (default), &quot;left&quot; or &quot;right&quot;.</p>
</td></tr>
<tr><td><code id="Plot.ConfInt_+3A_adjust">adjust</code></td>
<td>
<p>an optional character string specifying the multiple adjustment method,
by default there is no adjustment, if specified, must be one of &quot;Bonferroni&quot; or
&quot;Working-Hotelling&quot;. You can specify just the initial letter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bar plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>skin_analysis &lt;- ncda(score~tx, skin, intervention, subject,
                      indicator=c("control","treatment"),
                      Contrast=matrix(c(1,-1), nrow = 1))
Plot.ConfInt(skin_analysis,0.95,"Two-Sided")

ARTIS_analysis &lt;- ncda(emot_pqol~tx, ARTIS, intervention, homeid,
                       indicator = c("0","1"))
Plot.ConfInt(ARTIS_analysis,0.95,"Two-Sided")
Plot.ConfInt(ARTIS_analysis,0.95,"Two-Sided","Bonferroni")
Plot.ConfInt(ARTIS_analysis,0.95,"Two-Sided","Working-Hotelling")

</code></pre>

<hr>
<h2 id='ProcessData'>Process data set.</h2><span id='topic+ProcessData'></span>

<h3>Description</h3>

<p>Sample size and cluster size calculation for the imported data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ProcessData(data, tx, period, subject, resp, indicator=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ProcessData_+3A_data">data</code></td>
<td>
<p>a data frame in the long format.</p>
</td></tr>
<tr><td><code id="ProcessData_+3A_tx">tx</code></td>
<td>
<p>treatment variable.</p>
</td></tr>
<tr><td><code id="ProcessData_+3A_period">period</code></td>
<td>
<p>time indicator variable.</p>
</td></tr>
<tr><td><code id="ProcessData_+3A_subject">subject</code></td>
<td>
<p>subject or cluster ID</p>
</td></tr>
<tr><td><code id="ProcessData_+3A_resp">resp</code></td>
<td>
<p>response variable to be analyzed.</p>
</td></tr>
<tr><td><code id="ProcessData_+3A_indicator">indicator</code></td>
<td>
<p>an optional vector of characters indicating the order of pre and post intervention period;
must match the levels of period argument if specified; if not specified, the pre and post intervention
period will be ordered in the alphabet order by default</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the following components:
</p>

<dl>
<dt><code>trt </code></dt><dd><p>number of treatments</p>
</dd>
<dt><code>nc </code></dt><dd><p>complete cluster sample size within each treatment group</p>
</dd>
<dt><code>n1 </code></dt><dd><p>incomplete cluster sample size pre intervention within each treatment group</p>
</dd>
<dt><code>n2 </code></dt><dd><p>incomplete cluster sample size post intervention within each treatment group</p>
</dd>
<dt><code>m1c </code></dt><dd><p>complete cluster sizes pre-intervention within each treatment group</p>
</dd>
<dt><code>m2c </code></dt><dd><p>complete cluster size post-intervention within each treatment group</p>
</dd>
<dt><code>m1i </code></dt><dd><p>incomplete cluster sizes pre-intervention within each treatment group</p>
</dd>
<dt><code>m2i </code></dt><dd><p>incomplete cluster sizes post-intervention within each treatment group</p>
</dd>
<dt><code>x1c </code></dt><dd><p>complete data pre-intervention within each treatment group</p>
</dd>
<dt><code>x2c </code></dt><dd><p>complete data post-intervention within each treatment group</p>
</dd>
<dt><code>x1i </code></dt><dd><p>incomplete data pre-intervention within each treatment group</p>
</dd>
<dt><code>x2i </code></dt><dd><p>incomplete data post-intervention within each treatment group</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>ARTIS_result &lt;- ProcessData(ARTIS, tx, intervention, homeid, symptoms_pqol,
                            c("0","1"))
names(ARTIS_result)
skin_result &lt;- ProcessData(skin, tx, intervention, subject, score,
                           c("control","treatment"))
skin_result$nc
skin_result$n1
skin_result$n2
</code></pre>

<hr>
<h2 id='skin'>Skin Irritation Data</h2><span id='topic+skin'></span>

<h3>Description</h3>

<p>The data set is a re-simulated part from an ongoing
neuodermatitis study where researchers investigate the
efficacy of an ointment in reducing the severity of skin irritation on the
backs of the hands of 25 neurodermatitis patients, where 10 patients’ backs
of the hands were rubbed with the ointment and 15 were not. The response is
a BI-RADS rating score and the lower the score the better the clinical record.
Every remarkable skin irritation was graded on every patients back of the
hands and thus, the numbers of replicates differ across the patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skin
</code></pre>


<h3>Format</h3>

<p>A data frame with 107 rows and 4 variables:
</p>

<dl>
<dt><code>tx </code></dt><dd><p>treatment group</p>
</dd>
<dt><code>intervention </code></dt><dd><p>intervention period indicator</p>
</dd>
<dt><code>subject </code></dt><dd><p>subject ID</p>
</dd>
<dt><code>score </code></dt><dd><p>BI-RADS rating score, where 1 = very mild irritation,
2 =slight irritation, 3 =mild irritation, 4 =heavy irritation and
5 =severe irritation</p>
</dd>
</dl>



<h3>References</h3>

<p>Roy, A, Harrar, SW, Konietschke, F. The nonparametric
Behrens-Fisher problem with dependent replicates. Statistics in Medicine.
2019; 38: 4939– 4962. https://doi.org/10.1002/sim.8343
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(skin)
head(skin)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
