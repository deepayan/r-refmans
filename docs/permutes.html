<!DOCTYPE html><html><head><title>Help for package permutes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {permutes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#clusterperm.glm'><p>Cluster-based permutation tests for time series data, based on generalized linear models or other <code>buildmer</code> models. This is an alias for <code>clusterperm.lm</code> provided for discoverability.</p></a></li>
<li><a href='#clusterperm.glmer'><p>Cluster-based permutation tests for time series data, based on generalized linear mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>clusterperm.lmer</code> provided for discoverability.</p></a></li>
<li><a href='#clusterperm.glmmTMB'><p>Cluster-based permutation tests for time series data, based on <code>buildglmmTMB</code>.</p></a></li>
<li><a href='#clusterperm.lm'><p>Cluster-based permutation tests for time series data, based on mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>clusterperm.lmer</code>, except that random effects are explicily disallowed.</p></a></li>
<li><a href='#clusterperm.lmer'><p>Cluster-based permutation tests for time series data, based on mixed-effects models or other <code>buildmer</code> models.</p></a></li>
<li><a href='#MMN'><p>ERP data from Jager (in prep.). See the vignettes for details.</p></a></li>
<li><a href='#perm.glm'><p>A general permutation test for mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>perm.lm</code> provided for discoverability.</p></a></li>
<li><a href='#perm.glmer'><p>A general permutation test for mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>perm.lmer</code> provided for discoverability.</p></a></li>
<li><a href='#perm.glmmTMB'><p>A general permutation test for <code>glmmTMB</code> models.</p></a></li>
<li><a href='#perm.lm'><p>A general permutation test for mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>perm.lmer</code>, except that random effects are explicily disallowed.</p></a></li>
<li><a href='#perm.lmer'><p>A general permutation test for mixed-effects models or other <code>buildmer</code> models.</p></a></li>
<li><a href='#permu.test'><p>Permutation tests for time series data, based on classic linear regression or ANOVA</p>
This is a legacy function that is primarily provided for backward compatibility. You should probably use <code>perm.lm</code> or <code>perm.lmer</code> instead.
<code>permu.test</code> is the only function to support multivariate responses, although multivariate data can trivially be recoded into a univariate model.
<code>permu.test</code> does not support random effects or corrected p-values (e.g. the cluster mass test), which are supported by <code>permutelm</code>.</a></li>
<li><a href='#plot.permutes'><p>Create a heatmap of the results of cluster-based permutation testing.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Permutation Tests for Time Series Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.8</td>
</tr>
<tr>
<td>Author:</td>
<td>Cesko C. Voeten [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cesko C. Voeten &lt;cvoeten@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Helps you determine the analysis window to use when analyzing densely-sampled
    time-series data, such as EEG data, using permutation testing (Maris &amp; Oostenveld, 2007)
    &lt;<a href="https://doi.org/10.1016%2Fj.jneumeth.2007.03.024">doi:10.1016/j.jneumeth.2007.03.024</a>&gt;. These permutation tests can help identify the timepoints
    where significance of an effect begins and ends, and the results can be plotted in various
    types of heatmap for reporting. Mixed-effects models are supported using an implementation of
    the approach by Lee &amp; Braun (2012) &lt;<a href="https://doi.org/10.1111%2Fj.1541-0420.2011.01675.x">doi:10.1111/j.1541-0420.2011.01675.x</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>plyr, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>buildmer (&ge; 2.3), car, doParallel, ggplot2, glmmTMB, knitr,
lme4, lmPerm, permuco, rmarkdown, viridis</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.freebsd.org/copyright/freebsd-license.html">FreeBSD</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.com/cvoeten/permutes/-/issues">https://gitlab.com/cvoeten/permutes/-/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-27 22:40:55 UTC; cesko</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-28 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='clusterperm.glm'>Cluster-based permutation tests for time series data, based on generalized linear models or other <code>buildmer</code> models. This is an alias for <code>clusterperm.lm</code> provided for discoverability.</h2><span id='topic+clusterperm.glm'></span>

<h3>Description</h3>

<p>Cluster-based permutation tests for time series data, based on generalized linear models or other <code>buildmer</code> models. This is an alias for <code>clusterperm.lm</code> provided for discoverability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterperm.glm(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterperm.glm_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code>clusterperm.lm</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>clusterperm.lm, clusterperm.lmer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>perms &lt;- clusterperm.glm(Fz ~ Deviant * Session,data=MMN,series.var=~Time)

</code></pre>

<hr>
<h2 id='clusterperm.glmer'>Cluster-based permutation tests for time series data, based on generalized linear mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>clusterperm.lmer</code> provided for discoverability.</h2><span id='topic+clusterperm.glmer'></span>

<h3>Description</h3>

<p>Cluster-based permutation tests for time series data, based on generalized linear mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>clusterperm.lmer</code> provided for discoverability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterperm.glmer(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterperm.glmer_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code>clusterperm.lmer</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>clusterperm.lmer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Testing a single EEG electrode, with random effects by participants
perms &lt;- perm.glmer(Fz ~ Deviant * Session + (Deviant * Session | Subject),data=MMN)
# Testing a single EEG electrode, with random effects by participants, ANOVA inference
perms &lt;- perm.glmer(Fz ~ Deviant * Session + (Deviant * Session | Subject),data=MMN,type='anova')


</code></pre>

<hr>
<h2 id='clusterperm.glmmTMB'>Cluster-based permutation tests for time series data, based on <code>buildglmmTMB</code>.</h2><span id='topic+clusterperm.glmmTMB'></span>

<h3>Description</h3>

<p>Cluster-based permutation tests for time series data, based on <code>buildglmmTMB</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterperm.glmmTMB(
  formula,
  data = NULL,
  family = gaussian(),
  weights = NULL,
  offset = NULL,
  series.var = ~0,
  buildmerControl = list(direction = "order", crit = "LRT", quiet = TRUE),
  nperm = 1000,
  type = "regression",
  parallel = FALSE,
  progress = "none"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterperm.glmmTMB_+3A_formula">formula</code></td>
<td>
<p>A normal formula, possibly using <code>lme4</code>-style random effects. This can also be a buildmer terms object, provided <code>dep</code> is passed in <code>buildmerControl</code>. Only a single response variable is supported. For binomial models, the <code>cbind</code> syntax is not supported; please convert your dependent variable to a proportion and use weights instead.</p>
</td></tr>
<tr><td><code id="clusterperm.glmmTMB_+3A_data">data</code></td>
<td>
<p>The data.</p>
</td></tr>
<tr><td><code id="clusterperm.glmmTMB_+3A_family">family</code></td>
<td>
<p>The family.</p>
</td></tr>
<tr><td><code id="clusterperm.glmmTMB_+3A_weights">weights</code></td>
<td>
<p>An optional vector of prior case weights. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="clusterperm.glmmTMB_+3A_offset">offset</code></td>
<td>
<p>An optional vector containing a prior offset term. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="clusterperm.glmmTMB_+3A_series.var">series.var</code></td>
<td>
<p>A one-sided formula giving the variable grouping the time series.</p>
</td></tr>
<tr><td><code id="clusterperm.glmmTMB_+3A_buildmercontrol">buildmerControl</code></td>
<td>
<p>Options overriding the defaults in <code>buildmerControl</code>.</p>
</td></tr>
<tr><td><code id="clusterperm.glmmTMB_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations.</p>
</td></tr>
<tr><td><code id="clusterperm.glmmTMB_+3A_type">type</code></td>
<td>
<p>A character string of either <code>'anova'</code> or <code>'regression'</code>. The former runs an analysis of variance and returns F-values and p-values based on the explained variance of each factor in the design. The latter runs a linear-regression analysis and returns t-values and p-values based on individual effects. When running ANOVA, it is advised to use orthogonal predictors, as type III sums of squares are used.</p>
</td></tr>
<tr><td><code id="clusterperm.glmmTMB_+3A_parallel">parallel</code></td>
<td>
<p>Whether to parallelize the permutation testing using plyr's <code>parallel</code> option. Needs some additional set-up; see the plyr documentation.</p>
</td></tr>
<tr><td><code id="clusterperm.glmmTMB_+3A_progress">progress</code></td>
<td>
<p>A plyr <code>.progress</code> bar name, see the plyr documentation. If not <code>'none'</code> while <code>parallel=TRUE</code>, an ad-hoc solution will be used, which will be visible if the cluster nodes were created with <code>outfile=''</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If not explicitly overridden in the <code>buildmerControl</code> argument, the function changes a few buildmer defaults to make more sense for permutation testing. This includes setting <code>direction='order'</code> and <code>quiet=TRUE</code>. Set these options explicitly to override this behavior.
Because model comparisons are used for efficient permutation testing, REML is not supported.
Omega squared is not available for mixed-effects ANOVA; the <code>w2</code> column will not be included in the resulting <code>permutes</code> object.
The returned object provides the raw bootstrap samples in the <code>pb</code> attribute. These are used to compute a corrected p-value using Maris &amp; Oostenveld's (2007) cluster mass statistic, but can also be used by the user to compute other such statistics. These obviously significantly increase the size of the R object; if this becomes a problem, there is no harm in deleting them using e.g. <code>attr(x,'perms') &lt;- NULL</code>.
</p>
<p><code>clusterperm.glmmTMB</code> is much slower than <code>clusterperm.lmer</code>, but it is also more flexible, allowing for things like beta regression and zero-inflation.
</p>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# buildglmmTMB is much slower than clusterperm.lmer

perms &lt;- clusterperm.glmmTMB(Fz ~ Deviant * Session + (Deviant * Session | Subject),
	data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,],series.var=~Time)


</code></pre>

<hr>
<h2 id='clusterperm.lm'>Cluster-based permutation tests for time series data, based on mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>clusterperm.lmer</code>, except that random effects are explicily disallowed.</h2><span id='topic+clusterperm.lm'></span>

<h3>Description</h3>

<p>Cluster-based permutation tests for time series data, based on mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>clusterperm.lmer</code>, except that random effects are explicily disallowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterperm.lm(
  formula,
  data = NULL,
  family = gaussian(),
  weights = NULL,
  offset = NULL,
  series.var,
  buildmerControl = list(direction = "order", crit = "LRT", quiet = TRUE, ddf = "lme4"),
  nperm = 1000,
  type = "regression",
  parallel = FALSE,
  progress = "none"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterperm.lm_+3A_formula">formula</code></td>
<td>
<p>A normal formula without random effects. This can also be a buildmer terms object, provided <code>dep</code> is passed in <code>buildmerControl</code>. Only a single response variable is supported. For binomial models, the <code>cbind</code> syntax is not supported; please convert your dependent variable to a proportion and use weights instead.</p>
</td></tr>
<tr><td><code id="clusterperm.lm_+3A_data">data</code></td>
<td>
<p>The data.</p>
</td></tr>
<tr><td><code id="clusterperm.lm_+3A_family">family</code></td>
<td>
<p>The family.</p>
</td></tr>
<tr><td><code id="clusterperm.lm_+3A_weights">weights</code></td>
<td>
<p>An optional vector of prior case weights. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="clusterperm.lm_+3A_offset">offset</code></td>
<td>
<p>An optional vector containing a prior offset term. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="clusterperm.lm_+3A_series.var">series.var</code></td>
<td>
<p>A one-sided formula giving the variable grouping the time series.</p>
</td></tr>
<tr><td><code id="clusterperm.lm_+3A_buildmercontrol">buildmerControl</code></td>
<td>
<p>Options overriding the defaults in <code>buildmerControl</code>.</p>
</td></tr>
<tr><td><code id="clusterperm.lm_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations.</p>
</td></tr>
<tr><td><code id="clusterperm.lm_+3A_type">type</code></td>
<td>
<p>A character string of either <code>'anova'</code> or <code>'regression'</code>. The former runs an analysis of variance and returns F-values and p-values based on the explained variance of each factor in the design. The latter runs a linear-regression analysis and returns t-values and p-values based on individual effects. When running ANOVA, it is advised to use orthogonal predictors, as type III sums of squares are used.</p>
</td></tr>
<tr><td><code id="clusterperm.lm_+3A_parallel">parallel</code></td>
<td>
<p>Whether to parallelize the permutation testing using plyr's <code>parallel</code> option. Needs some additional set-up; see the plyr documentation.</p>
</td></tr>
<tr><td><code id="clusterperm.lm_+3A_progress">progress</code></td>
<td>
<p>A plyr <code>.progress</code> bar name, see the plyr documentation. If not <code>'none'</code> while <code>parallel=TRUE</code>, an ad-hoc solution will be used, which will be visible if the cluster nodes were created with <code>outfile=''</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If not explicitly overridden in the <code>buildmerControl</code> argument, the function changes a few buildmer defaults to make more sense for permutation testing. This includes setting <code>direction='order'</code> and <code>quiet=TRUE</code>. Set these options explicitly to override this behavior.
Because model comparisons are used for efficient permutation testing, REML is not supported.
Omega squared is not available for mixed-effects ANOVA; the <code>w2</code> column will not be included in the resulting <code>permutes</code> object.
The returned object provides the raw bootstrap samples in the <code>pb</code> attribute. These are used to compute a corrected p-value using Maris &amp; Oostenveld's (2007) cluster mass statistic, but can also be used by the user to compute other such statistics. These obviously significantly increase the size of the R object; if this becomes a problem, there is no harm in deleting them using e.g. <code>attr(x,'perms') &lt;- NULL</code>.
</p>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>See Also</h3>

<p>clusterperm.lmer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>perms &lt;- clusterperm.lm(Fz ~ Deviant * Session,data=MMN,series.var=~Time)

</code></pre>

<hr>
<h2 id='clusterperm.lmer'>Cluster-based permutation tests for time series data, based on mixed-effects models or other <code>buildmer</code> models.</h2><span id='topic+clusterperm.lmer'></span>

<h3>Description</h3>

<p>Cluster-based permutation tests for time series data, based on mixed-effects models or other <code>buildmer</code> models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterperm.lmer(
  formula,
  data = NULL,
  family = gaussian(),
  weights = NULL,
  offset = NULL,
  series.var = ~0,
  buildmerControl = list(direction = "order", crit = "LRT", quiet = TRUE, ddf = "lme4"),
  nperm = 1000,
  type = "regression",
  parallel = FALSE,
  progress = "none"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterperm.lmer_+3A_formula">formula</code></td>
<td>
<p>A normal formula, possibly using <code>lme4</code>-style random effects. This can also be a buildmer terms object, provided <code>dep</code> is passed in <code>buildmerControl</code>. Only a single response variable is supported. For binomial models, the <code>cbind</code> syntax is not supported; please convert your dependent variable to a proportion and use weights instead.</p>
</td></tr>
<tr><td><code id="clusterperm.lmer_+3A_data">data</code></td>
<td>
<p>The data.</p>
</td></tr>
<tr><td><code id="clusterperm.lmer_+3A_family">family</code></td>
<td>
<p>The family.</p>
</td></tr>
<tr><td><code id="clusterperm.lmer_+3A_weights">weights</code></td>
<td>
<p>An optional vector of prior case weights. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="clusterperm.lmer_+3A_offset">offset</code></td>
<td>
<p>An optional vector containing a prior offset term. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="clusterperm.lmer_+3A_series.var">series.var</code></td>
<td>
<p>A one-sided formula giving the variable grouping the time series.</p>
</td></tr>
<tr><td><code id="clusterperm.lmer_+3A_buildmercontrol">buildmerControl</code></td>
<td>
<p>Options overriding the defaults in <code>buildmerControl</code>.</p>
</td></tr>
<tr><td><code id="clusterperm.lmer_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations.</p>
</td></tr>
<tr><td><code id="clusterperm.lmer_+3A_type">type</code></td>
<td>
<p>A character string of either <code>'anova'</code> or <code>'regression'</code>. The former runs an analysis of variance and returns F-values and p-values based on the explained variance of each factor in the design. The latter runs a linear-regression analysis and returns t-values and p-values based on individual effects. When running ANOVA, it is advised to use orthogonal predictors, as type III sums of squares are used.</p>
</td></tr>
<tr><td><code id="clusterperm.lmer_+3A_parallel">parallel</code></td>
<td>
<p>Whether to parallelize the permutation testing using plyr's <code>parallel</code> option. Needs some additional set-up; see the plyr documentation.</p>
</td></tr>
<tr><td><code id="clusterperm.lmer_+3A_progress">progress</code></td>
<td>
<p>A plyr <code>.progress</code> bar name, see the plyr documentation. If not <code>'none'</code> while <code>parallel=TRUE</code>, an ad-hoc solution will be used, which will be visible if the cluster nodes were created with <code>outfile=''</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If not explicitly overridden in the <code>buildmerControl</code> argument, the function changes a few buildmer defaults to make more sense for permutation testing. This includes setting <code>direction='order'</code> and <code>quiet=TRUE</code>. Set these options explicitly to override this behavior.
Because model comparisons are used for efficient permutation testing, REML is not supported.
Omega squared is not available for mixed-effects ANOVA; the <code>w2</code> column will not be included in the resulting <code>permutes</code> object.
The returned object provides the raw bootstrap samples in the <code>pb</code> attribute. These are used to compute a corrected p-value using Maris &amp; Oostenveld's (2007) cluster mass statistic, but can also be used by the user to compute other such statistics. These obviously significantly increase the size of the R object; if this becomes a problem, there is no harm in deleting them using e.g. <code>attr(x,'perms') &lt;- NULL</code>.
</p>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Testing a single EEG electrode, with random effects by participants
perms &lt;- clusterperm.lmer(Fz ~ Deviant * Session + (Deviant * Session | Subject),
	data=MMN,series.var=~Time)
# Testing a single EEG electrode, with random effects by participants, ANOVA inference
perms &lt;- clusterperm.lmer(Fz ~ Deviant * Session + (Deviant * Session | Subject),
	data=MMN,series.var=~Time,type='anova')


</code></pre>

<hr>
<h2 id='MMN'>ERP data from Jager (in prep.). See the vignettes for details.</h2><span id='topic+MMN'></span>

<h3>Description</h3>

<p>ERP data from Jager (in prep.). See the vignettes for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MMN)
</code></pre>


<h3>Format</h3>

<p>A standard data frame.
</p>

<hr>
<h2 id='perm.glm'>A general permutation test for mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>perm.lm</code> provided for discoverability.</h2><span id='topic+perm.glm'></span>

<h3>Description</h3>

<p>A general permutation test for mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>perm.lm</code> provided for discoverability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm.glm(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm.glm_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code>perm.lm</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>perm.lm, perm.lmer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>perms &lt;- perm.glm(Fz ~ Deviant * Session,data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,])

</code></pre>

<hr>
<h2 id='perm.glmer'>A general permutation test for mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>perm.lmer</code> provided for discoverability.</h2><span id='topic+perm.glmer'></span>

<h3>Description</h3>

<p>A general permutation test for mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>perm.lmer</code> provided for discoverability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm.glmer(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm.glmer_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code>perm.lmer</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>perm.lmer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Testing a single EEG electrode, with random effects by participants
perms &lt;- perm.glmer(Fz ~ Deviant * Session + (Deviant * Session | Subject),
                    data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,])
# Testing a single EEG electrode, with random effects by participants, ANOVA inference
perms &lt;- perm.glmer(Fz ~ Deviant * Session + (Deviant * Session | Subject),
                    data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,],type='anova')


</code></pre>

<hr>
<h2 id='perm.glmmTMB'>A general permutation test for <code>glmmTMB</code> models.</h2><span id='topic+perm.glmmTMB'></span>

<h3>Description</h3>

<p>A general permutation test for <code>glmmTMB</code> models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm.glmmTMB(
  formula,
  data = NULL,
  family = gaussian(),
  weights = NULL,
  offset = NULL,
  buildmerControl = list(direction = "order", crit = "LRT", quiet = TRUE, ddf = "lme4"),
  nperm = 1000,
  type = "regression",
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm.glmmTMB_+3A_formula">formula</code></td>
<td>
<p>A normal formula, possibly using <code>lme4</code>-style random effects. This can also be a buildmer terms object, provided <code>dep</code> is passed in <code>buildmerControl</code>. Only a single response variable is supported. For binomial models, the <code>cbind</code> syntax is not supported; please convert your dependent variable to a proportion and use weights instead.</p>
</td></tr>
<tr><td><code id="perm.glmmTMB_+3A_data">data</code></td>
<td>
<p>The data.</p>
</td></tr>
<tr><td><code id="perm.glmmTMB_+3A_family">family</code></td>
<td>
<p>The family.</p>
</td></tr>
<tr><td><code id="perm.glmmTMB_+3A_weights">weights</code></td>
<td>
<p>An optional vector of prior case weights. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="perm.glmmTMB_+3A_offset">offset</code></td>
<td>
<p>An optional vector containing a prior offset term. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="perm.glmmTMB_+3A_buildmercontrol">buildmerControl</code></td>
<td>
<p>Options overriding the defaults in <code>buildmerControl</code>.</p>
</td></tr>
<tr><td><code id="perm.glmmTMB_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations.</p>
</td></tr>
<tr><td><code id="perm.glmmTMB_+3A_type">type</code></td>
<td>
<p>A character string of either <code>'anova'</code> or <code>'regression'</code>. The former runs an analysis of variance and returns F-values and p-values based on the explained variance of each factor in the design. The latter runs a linear-regression analysis and returns t-values and p-values based on individual effects. When running ANOVA, it is advised to use orthogonal predictors, as type III sums of squares are used.</p>
</td></tr>
<tr><td><code id="perm.glmmTMB_+3A_progress">progress</code></td>
<td>
<p>Logical indicating whether to print progress messages during the permutation testing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If not explicitly overridden in the <code>buildmerControl</code> argument, the function changes a few buildmer defaults to make more sense for permutation testing. This includes setting <code>direction='order'</code> and <code>quiet=TRUE</code>. Set these options explicitly to override this behavior.
Because model comparisons are used for efficient permutation testing, REML is not supported.
Omega squared is not available for mixed-effects ANOVA; the <code>w2</code> column will not be included in the resulting <code>permutes</code> object.
The returned object provides the raw bootstrap samples in the <code>pb</code> attribute. These are used to compute a corrected p-value using Maris &amp; Oostenveld's (2007) cluster mass statistic, but can also be used by the user to compute other such statistics. These obviously significantly increase the size of the R object; if this becomes a problem, there is no harm in deleting them using e.g. <code>attr(x,'perms') &lt;- NULL</code>.
</p>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Testing a single EEG electrode, with random effects by participants
perms &lt;- perm.glmmTMB(Fz ~ Deviant * Session,data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,])


</code></pre>

<hr>
<h2 id='perm.lm'>A general permutation test for mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>perm.lmer</code>, except that random effects are explicily disallowed.</h2><span id='topic+perm.lm'></span>

<h3>Description</h3>

<p>A general permutation test for mixed-effects models or other <code>buildmer</code> models. This is an alias for <code>perm.lmer</code>, except that random effects are explicily disallowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm.lm(
  formula,
  data = NULL,
  family = gaussian(),
  weights = NULL,
  offset = NULL,
  buildmerControl = list(direction = "order", crit = "LRT", quiet = TRUE, ddf = "lme4"),
  nperm = 1000,
  type = "regression",
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm.lm_+3A_formula">formula</code></td>
<td>
<p>A normal formula, possibly using <code>lme4</code>-style random effects. This can also be a buildmer terms object, provided <code>dep</code> is passed in <code>buildmerControl</code>. Only a single response variable is supported. For binomial models, the <code>cbind</code> syntax is not supported; please convert your dependent variable to a proportion and use weights instead.</p>
</td></tr>
<tr><td><code id="perm.lm_+3A_data">data</code></td>
<td>
<p>The data.</p>
</td></tr>
<tr><td><code id="perm.lm_+3A_family">family</code></td>
<td>
<p>The family.</p>
</td></tr>
<tr><td><code id="perm.lm_+3A_weights">weights</code></td>
<td>
<p>An optional vector of prior case weights. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="perm.lm_+3A_offset">offset</code></td>
<td>
<p>An optional vector containing a prior offset term. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="perm.lm_+3A_buildmercontrol">buildmerControl</code></td>
<td>
<p>Options overriding the defaults in <code>buildmerControl</code>.</p>
</td></tr>
<tr><td><code id="perm.lm_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations.</p>
</td></tr>
<tr><td><code id="perm.lm_+3A_type">type</code></td>
<td>
<p>A character string of either <code>'anova'</code> or <code>'regression'</code>. The former runs an analysis of variance and returns F-values and p-values based on the explained variance of each factor in the design. The latter runs a linear-regression analysis and returns t-values and p-values based on individual effects. When running ANOVA, it is advised to use orthogonal predictors, as type III sums of squares are used.</p>
</td></tr>
<tr><td><code id="perm.lm_+3A_progress">progress</code></td>
<td>
<p>Logical indicating whether to print progress messages during the permutation testing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If not explicitly overridden in the <code>buildmerControl</code> argument, the function changes a few buildmer defaults to make more sense for permutation testing. This includes setting <code>direction='order'</code> and <code>quiet=TRUE</code>. Set these options explicitly to override this behavior.
Because model comparisons are used for efficient permutation testing, REML is not supported.
Omega squared is not available for mixed-effects ANOVA; the <code>w2</code> column will not be included in the resulting <code>permutes</code> object.
The returned object provides the raw bootstrap samples in the <code>pb</code> attribute. These are used to compute a corrected p-value using Maris &amp; Oostenveld's (2007) cluster mass statistic, but can also be used by the user to compute other such statistics. These obviously significantly increase the size of the R object; if this becomes a problem, there is no harm in deleting them using e.g. <code>attr(x,'perms') &lt;- NULL</code>.
</p>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Testing a single EEG electrode, with random effects by participants
perms &lt;- perm.lm(Fz ~ Deviant * Session,data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,])
# Testing a single EEG electrode, with random effects by participants, ANOVA inference
perms &lt;- perm.lm(Fz ~ Deviant * Session,data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,],type='anova')


</code></pre>

<hr>
<h2 id='perm.lmer'>A general permutation test for mixed-effects models or other <code>buildmer</code> models.</h2><span id='topic+perm.lmer'></span>

<h3>Description</h3>

<p>A general permutation test for mixed-effects models or other <code>buildmer</code> models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm.lmer(
  formula,
  data = NULL,
  family = gaussian(),
  weights = NULL,
  offset = NULL,
  buildmerControl = list(direction = "order", crit = "LRT", quiet = TRUE, ddf = "lme4"),
  nperm = 1000,
  type = "regression",
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm.lmer_+3A_formula">formula</code></td>
<td>
<p>A normal formula, possibly using <code>lme4</code>-style random effects. This can also be a buildmer terms object, provided <code>dep</code> is passed in <code>buildmerControl</code>. Only a single response variable is supported. For binomial models, the <code>cbind</code> syntax is not supported; please convert your dependent variable to a proportion and use weights instead.</p>
</td></tr>
<tr><td><code id="perm.lmer_+3A_data">data</code></td>
<td>
<p>The data.</p>
</td></tr>
<tr><td><code id="perm.lmer_+3A_family">family</code></td>
<td>
<p>The family.</p>
</td></tr>
<tr><td><code id="perm.lmer_+3A_weights">weights</code></td>
<td>
<p>An optional vector of prior case weights. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="perm.lmer_+3A_offset">offset</code></td>
<td>
<p>An optional vector containing a prior offset term. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td></tr>
<tr><td><code id="perm.lmer_+3A_buildmercontrol">buildmerControl</code></td>
<td>
<p>Options overriding the defaults in <code>buildmerControl</code>.</p>
</td></tr>
<tr><td><code id="perm.lmer_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations.</p>
</td></tr>
<tr><td><code id="perm.lmer_+3A_type">type</code></td>
<td>
<p>A character string of either <code>'anova'</code> or <code>'regression'</code>. The former runs an analysis of variance and returns F-values and p-values based on the explained variance of each factor in the design. The latter runs a linear-regression analysis and returns t-values and p-values based on individual effects. When running ANOVA, it is advised to use orthogonal predictors, as type III sums of squares are used.</p>
</td></tr>
<tr><td><code id="perm.lmer_+3A_progress">progress</code></td>
<td>
<p>Logical indicating whether to print progress messages during the permutation testing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If not explicitly overridden in the <code>buildmerControl</code> argument, the function changes a few buildmer defaults to make more sense for permutation testing. This includes setting <code>direction='order'</code> and <code>quiet=TRUE</code>. Set these options explicitly to override this behavior.
Because model comparisons are used for efficient permutation testing, REML is not supported.
Omega squared is not available for mixed-effects ANOVA; the <code>w2</code> column will not be included in the resulting <code>permutes</code> object.
The returned object provides the raw bootstrap samples in the <code>pb</code> attribute. These are used to compute a corrected p-value using Maris &amp; Oostenveld's (2007) cluster mass statistic, but can also be used by the user to compute other such statistics. These obviously significantly increase the size of the R object; if this becomes a problem, there is no harm in deleting them using e.g. <code>attr(x,'perms') &lt;- NULL</code>.
</p>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Testing a single EEG electrode, with random effects by participants
perms &lt;- perm.lmer(Fz ~ Deviant * Session + (Deviant * Session | Subject),
                   data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,])
# Testing a single EEG electrode, with random effects by participants, ANOVA inference
perms &lt;- perm.lmer(Fz ~ Deviant * Session + (Deviant * Session | Subject),
                   data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,],type='anova')


</code></pre>

<hr>
<h2 id='permu.test'>Permutation tests for time series data, based on classic linear regression or ANOVA
This is a legacy function that is primarily provided for backward compatibility. You should probably use <code>perm.lm</code> or <code>perm.lmer</code> instead.
<code>permu.test</code> is the only function to support multivariate responses, although multivariate data can trivially be recoded into a univariate model.
<code>permu.test</code> does not support random effects or corrected p-values (e.g. the cluster mass test), which are supported by <code>permutelm</code>.</h2><span id='topic+permu.test'></span>

<h3>Description</h3>

<p>Permutation tests for time series data, based on classic linear regression or ANOVA
This is a legacy function that is primarily provided for backward compatibility. You should probably use <code>perm.lm</code> or <code>perm.lmer</code> instead.
<code>permu.test</code> is the only function to support multivariate responses, although multivariate data can trivially be recoded into a univariate model.
<code>permu.test</code> does not support random effects or corrected p-values (e.g. the cluster mass test), which are supported by <code>permutelm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permu.test(
  formula,
  data,
  subset = NULL,
  type = "anova",
  parallel = FALSE,
  progress = "text",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permu.test_+3A_formula">formula</code></td>
<td>
<p>A formula of the following form: <code>outcome ~ predictors | series variable</code>. Multivariate outcomes (e.g. 32 EEG electrodes) are supported; use <code>cbind(Fp1,Fp2,etc) ~ predictors | series</code>.</p>
</td></tr>
<tr><td><code id="permu.test_+3A_data">data</code></td>
<td>
<p>The dataset referencing these predictors.</p>
</td></tr>
<tr><td><code id="permu.test_+3A_subset">subset</code></td>
<td>
<p>If specified, will only analyze the specified subset of the data.</p>
</td></tr>
<tr><td><code id="permu.test_+3A_type">type</code></td>
<td>
<p>A character string of either <code>'anova'</code> or <code>'regression'</code>. The former runs an analysis of variance and returns F-values and p-values based on the explained variance of each factor in the design. The latter runs a linear-regression analysis and returns t-values and p-values based on individual effects. When running ANOVA, it is advised to use orthogonal predictors, as type III sums of squares are used.</p>
</td></tr>
<tr><td><code id="permu.test_+3A_parallel">parallel</code></td>
<td>
<p>Whether to parallelize the permutation testing using plyr's <code>parallel</code> option. Needs some additional set-up; see the plyr documentation.</p>
</td></tr>
<tr><td><code id="permu.test_+3A_progress">progress</code></td>
<td>
<p>A plyr <code>.progress</code> bar name, see the plyr documentation. Ignored if parallel=TRUE.</p>
</td></tr>
<tr><td><code id="permu.test_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to <code>lmp</code>/<code>aovp</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>See Also</h3>

<p><code>clusterperm.lm</code>, <code>clusterperm.lmer</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# EEG data example using the MMN dataset

# Run permutation tests on all electrodes and timepoints, reporting p-values for the three
# manipulated factors
perms &lt;- permu.test(cbind(Fp1,AF3,F7,F3,FC1,FC5,C3,CP1,CP5,P7,P3,Pz,PO3,O1,Oz,O2,PO4,P4,
	P8,CP6,CP2,C4,FC6,FC2,F4,F8,AF4,Fp2,Fz,Cz) ~ Deviant * Session | Time,data=MMN)

# Run the tests in parallel on two CPU threads
# first, set up the parallel backend
library(doParallel)
cl &lt;- makeCluster(2)
registerDoParallel(cl)
perms &lt;- permu.test(cbind(Fp1,AF3,F7,F3,FC1,FC5,C3,CP1,CP5,P7,P3,Pz,PO3,O1,Oz,O2,PO4,P4,
	P8,CP6,CP2,C4,FC6,FC2,F4,F8,AF4,Fp2,Fz,Cz) ~ Deviant * Session | Time,data=MMN,
	parallel=TRUE)
stopCluster(cl)

# Plot the results by F-value, removing points that were not significant in the
# permutation tests
plot(perms,sig='p')

# t-values instead of F-values
perms &lt;- permu.test(cbind(Fp1,AF3,F7,F3,FC1,FC5,C3,CP1,CP5,P7,P3,Pz,PO3,O1,Oz,O2,PO4,P4,
	P8,CP6,CP2,C4,FC6,FC2,F4,F8,AF4,Fp2,Fz,Cz) ~ Deviant * Session | Time,data=MMN,
	type='regression')


</code></pre>

<hr>
<h2 id='plot.permutes'>Create a heatmap of the results of cluster-based permutation testing.</h2><span id='topic+plot.permutes'></span>

<h3>Description</h3>

<p>Create a heatmap of the results of cluster-based permutation testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'permutes'
plot(
  x,
  type = c("LRT", "F", "t", "beta", "w2", "cluster_mass"),
  breaks = NULL,
  sig = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.permutes_+3A_x">x</code></td>
<td>
<p>Output of <code>permu.test</code> or <code>clusterperm.lmer</code> or associated functions. You may want to subset it if you want to simulate zooming in.</p>
</td></tr>
<tr><td><code id="plot.permutes_+3A_type">type</code></td>
<td>
<p>The quantity to plot. For ANOVA, the options are <code>'LRT'</code> (default; this is the permutation statistic, which is a likelihood-ratio-test statistic), <code>'F'</code>, <code>'p'</code> (this is the permutation p-value of the permutation statistic), or <code>'w2'</code> (omega squared; not available for mixed-effects models). For regression, the options are <code>'t'</code>, <code>'beta'</code>, or <code>'p'</code>.</p>
</td></tr>
<tr><td><code id="plot.permutes_+3A_breaks">breaks</code></td>
<td>
<p>The granularity of the labels of the x axis. Pass &lsquo;unique(x[,2])&rsquo; to get a tick for every timepoint. Combine this trick with subsetting of your dataset, and perhaps averaging over all your dependent variables, to &lsquo;zoom in&rsquo; on your data to help you determine precisely where significance begins and stops to occur.</p>
</td></tr>
<tr><td><code id="plot.permutes_+3A_sig">sig</code></td>
<td>
<p>An optional column name. If specified, only cases with a value of &lt;.05 in this column will be plotted. NULL by default, but suggested to be set to <code>'p.cluster_mass'</code> for easy visualization of the cluster-mass-test results, or <code>'p'</code> to directly use the permutation p-values.</p>
</td></tr>
<tr><td><code id="plot.permutes_+3A_...">...</code></td>
<td>
<p>Other arguments, which will be ignored (the ellipsis is provided for consistency with the generic plot() method).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 object.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
