<!DOCTYPE html><html><head><title>Help for package HLMdiag</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HLMdiag}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adjust_lmList.formula'><p>Fitting Common Models via <code>lm</code></p></a></li>
<li><a href='#ahd'><p>Methylprednisolone data</p></a></li>
<li><a href='#autism'><p>Autism data</p></a></li>
<li><a href='#case_delete.default'><p>Case Deletion for <code>mer</code>/<code>lmerMod</code> objects</p></a></li>
<li><a href='#compare_eb_ls'><p>Visually comparing shrinkage and LS estimates</p></a></li>
<li><a href='#covratio.default'><p>Influence on precision of fixed effects in HLMs</p></a></li>
<li><a href='#dotplot_diag'><p>Dot plots for influence diagnostics</p></a></li>
<li><a href='#extract_design'><p>Extracting covariance matrices from lme</p></a></li>
<li><a href='#hlm_augment'><p>Calculating residuals and influence diagnostics for HLMs</p>
</p>
<p><code>hlm_augment</code> is used to compute residuals, fitted values, and influence diagnostics for a</p>
hierarchical linear model. The residuals and fitted values are computed using Least Squares(LS)
and Empirical Bayes (EB) methods. The influence diagnostics are computed through one step
approximations.</a></li>
<li><a href='#hlm_influence.default'><p>Calculating influence diagnostics for HLMs</p></a></li>
<li><a href='#hlm_resid.default'><p>Calculating residuals from HLMs</p></a></li>
<li><a href='#HLMdiag'><p>Diagnostic tools for hierarchical (multilevel) linear models</p></a></li>
<li><a href='#HLMdiag-defunct'><p>Defunct functions in package HLMdiag</p></a></li>
<li><a href='#HLMdiag-deprecated'><p>Deprecated functions in HLMdiag</p></a></li>
<li><a href='#leverage.default'><p>Leverage for HLMs</p></a></li>
<li><a href='#LSresids.default'><p>Calculating least squares residuals</p></a></li>
<li><a href='#mdffits.default'><p>Influence on fixed effects of HLMs</p></a></li>
<li><a href='#pull_resid.default'><p>Computationally Efficient HLM Residuals</p></a></li>
<li><a href='#radon'><p>Radon data</p></a></li>
<li><a href='#resid_conditional.default'><p>Conditional residuals</p></a></li>
<li><a href='#resid_marginal.default'><p>Marginal residuals</p></a></li>
<li><a href='#resid_ranef'><p>Random effects residuals</p></a></li>
<li><a href='#rotate_ranef.default'><p>Calculate s-dimensional rotated random effects</p></a></li>
<li><a href='#rvc.default'><p>Relative variance change for HLMs</p></a></li>
<li><a href='#varcomp.mer'><p>Extracting variance components</p></a></li>
<li><a href='#wages'><p>Wages for male high school dropouts</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Diagnostic Tools for Hierarchical (Multilevel) Linear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adam Loy &lt;loyad01@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A suite of diagnostic tools for hierarchical
    (multilevel) linear models. The tools include
    not only leverage and traditional deletion diagnostics (Cook's
    distance, covratio, covtrace, and MDFFITS) but also 
    convenience functions and graphics for residual analysis. Models
    can be fit using either lmer in the 'lme4' package or lme in the 'nlme' package.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 0.9.2), stats, methods, plyr, reshape2, MASS,
Matrix, mgcv, dplyr, magrittr, stringr, purrr, tibble,
tidyselect, janitor, Rcpp, rlang, ggrepel, diagonals</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mlmRev, WWGbook, lme4 (&ge; 1.0), nlme, testthat, knitr,
rmarkdown, car, gridExtra, qqplotr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Collate:</td>
<td>'diagnostic_functions.R' 'group_level_residual_functions.R'
'identification.R' 'plot_functions.R' 'adjust_formula_lmList.R'
'case_delete.R' 'LSresids.R' 'HLMdiag-deprecated.R'
'HLMdiag-package.R' 'hlm_augment.R' 'hlm_influence.R'
'hlm_resid.R' 'help.R' 'influence_functions.R'
'utility_functions.R' 'rotate_ranefs.R' 'autism.R' 'ahd.R'
'radon.R' 'pull_resid.R' 'residual_functions.R'
'HLMdiag-defunct.R'</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/aloy/HLMdiag">https://github.com/aloy/HLMdiag</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/aloy/HLMdiag/issues">https://github.com/aloy/HLMdiag/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-01 14:27:35 UTC; aloy</td>
</tr>
<tr>
<td>Author:</td>
<td>Adam Loy [cre, aut],
  Jaylin Lowe [aut],
  Jack Moran [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-02 04:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='adjust_lmList.formula'>Fitting Common Models via <code>lm</code></h2><span id='topic+adjust_lmList.formula'></span><span id='topic+adjust_lmList'></span><span id='topic+adjust_lmList+2Cformula+2Cdata.frame-method'></span>

<h3>Description</h3>

<p>Separate linear models are fit via <code>lm</code> similar to <code>lmList</code>,
however, <code>adjust_lmList</code> can handle models where a factor takes only one
level within a group. In this case, the <code>formula</code> is updated eliminating
the offending factors from the formula for that group as the effect is
absorbed into the intercept.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
adjust_lmList(object, data, pool)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjust_lmList.formula_+3A_object">object</code></td>
<td>
<p>a linear formula such as that used by <code>lmList</code>, e.g.
<code>y ~ x1 + ... + xn | g</code>, where <code>g</code> is a grouping factor.</p>
</td></tr>
<tr><td><code id="adjust_lmList.formula_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="adjust_lmList.formula_+3A_pool">pool</code></td>
<td>
<p>a logical value that indicates whether the pooled standard
deviation/error should be used.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Douglas Bates, Martin Maechler and Ben Bolker (2012). lme4:
Linear mixed-effects models using S4 classes. R package version 0.999999-0.
</p>


<h3>See Also</h3>

<p><code><a href="lme4.html#topic+lmList">lmList</a>, <a href="stats.html#topic+lm">lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Exam, package = 'mlmRev')
sepLM &lt;- adjust_lmList(normexam ~ standLRT + sex + schgend | school, data = Exam)
confint(sepLM)

</code></pre>

<hr>
<h2 id='ahd'>Methylprednisolone data</h2><span id='topic+ahd'></span>

<h3>Description</h3>

<p>Data from a longitudinal study examining the effectiveness of Methylprednisolone
as a treatment for patients with severe alcoholic hepatitis. Subjects were
randomly assigned to a treatment (31 received a placebo, 35 received the 
treatment) and serum bilirubin was measures each week for four weeks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ahd)
</code></pre>


<h3>Format</h3>

<p>A data frame with 330 observations on the following 5 variables:
</p>

<dl>
<dt>treatment</dt><dd><p>The treatment a  subject received - a factor. Levels are
<code>placebo</code> and <code>treated</code>.</p>
</dd>
<dt>subject</dt><dd><p>Subject ID - a factor.</p>
</dd>
<dt>week</dt><dd><p>Week of the study (0&ndash;4) - the time variable.</p>
</dd>
<dt>sbvalue</dt><dd><p>Serum bilirubin level (in <code class="reqn">\mu</code>mol/L). </p>
</dd>
<dt>baseline</dt><dd><p>A subject's serum bilirubin level at week 0.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Vonesh, E. F. and Chinchilli, V. M. (1997) <em>Linear and Nonlinear Models for the 
Analysis of Repeated Measurements</em>. Marcel Dekker, New York.
</p>


<h3>References</h3>

<p>Carithers, R. L., Herlong, H. F., Diehl, A. M., Shaw, E. W., Combes, B., 
Fallon, H. J. &amp; Maddrey, W. C. (1989) Methylprednisolone therapy in 
patients with severe alcoholic hepatitis. <em>Annals of Internal Medicine</em>, 
<b>110</b>(9), 685&ndash;690.
</p>

<hr>
<h2 id='autism'>Autism data</h2><span id='topic+autism'></span>

<h3>Description</h3>

<p>Data from a prospective longitudinal study following 214 children between 
the ages of 2 and 13 who were diagnosed with either autism spectrum disorder
or non-spectrum developmental delays at age 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(autism)
</code></pre>


<h3>Format</h3>

<p>A data frame with 604 observation on the following 7 variables:
</p>

<dl>
<dt>childid</dt><dd><p>Child ID.</p>
</dd>
<dt>sicdegp</dt><dd><p>Sequenced Inventory of Communication Development group (an
assessment of expressive language development) - a factor. Levels are 
<code>low</code>, <code>med</code>, and <code>high</code>.</p>
</dd>
<dt>age2</dt><dd><p>Age (in years) centered around age 2 (age at diagnosis).</p>
</dd>
<dt>vsae</dt><dd><p>Vineland Socialization Age Equivalent</p>
</dd>
<dt>gender</dt><dd><p>Child's gender - a factor. Levels are <code>male</code> and <code>female</code>.</p>
</dd>
<dt>race</dt><dd><p>Child's race - a factor. Levels are <code>white</code> and <code>nonwhite</code>.</p>
</dd>
<dt>bestest2</dt><dd><p>Diagnosis at age 2 - a factor. Levels are <code>autism</code> and 
<code>pdd</code> (pervasive developmental disorder).</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://www-personal.umich.edu/~kwelch/">http://www-personal.umich.edu/~kwelch/</a>
</p>


<h3>References</h3>

<p>Anderson, D. K., Lord, C., Risi, S., DiLavore, P. S., Shulman, C., 
Thurm, A., et al. (2007). Patterns of growth in verbal abilities among 
children with autism spectrum disorder. <em>Journal of Consulting and 
Clinical Psychology</em>, <b>75</b>(4), 594&ndash;604. 
</p>
<p>Anderson, D. K., Oti, R. S., Lord, C., &amp; Welch, K. (2009). 
Patterns of Growth in Adaptive Social Abilities Among Children with Autism 
Spectrum Disorders. <em>Journal of Abnormal Child Psychology</em>, 
<b>37</b>(7), 1019&ndash;1034.
</p>

<hr>
<h2 id='case_delete.default'>Case Deletion for <code>mer</code>/<code>lmerMod</code> objects</h2><span id='topic+case_delete.default'></span><span id='topic+case_delete.mer'></span><span id='topic+case_delete'></span><span id='topic+case_delete.lmerMod'></span><span id='topic+case_delete.lme'></span>

<h3>Description</h3>

<p>This function is used to iteratively delete groups corresponding to the
levels of a hierarchical linear model. It uses <code>lmer()</code> to fit
the models for each deleted case (i.e. uses brute force). To investigate
numerous levels of the model, the function will need to be called multiple
times, specifying the group (level) of interest each time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
case_delete(model, ...)

## S3 method for class 'mer'
case_delete(
  model,
  level = 1,
  type = c("both", "fixef", "varcomp"),
  delete = NULL,
  ...
)

## S3 method for class 'lmerMod'
case_delete(
  model,
  level = 1,
  type = c("both", "fixef", "varcomp"),
  delete = NULL,
  ...
)

## S3 method for class 'lme'
case_delete(
  model,
  level = 1,
  type = c("both", "fixef", "varcomp"),
  delete = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="case_delete.default_+3A_model">model</code></td>
<td>
<p>the original hierarchical model fit using <code>lmer()</code></p>
</td></tr>
<tr><td><code id="case_delete.default_+3A_...">...</code></td>
<td>
<p>do not use</p>
</td></tr>
<tr><td><code id="case_delete.default_+3A_level">level</code></td>
<td>
<p>a variable used to define the group for which cases will be
deleted.  If <code>level = 1</code> (default), then the function will delete
individual observations.</p>
</td></tr>
<tr><td><code id="case_delete.default_+3A_type">type</code></td>
<td>
<p>the part of the model for which you are obtaining deletion
diagnostics: the fixed effects (<code>"fixef"</code>), variance components
(<code>"varcomp"</code>), or <code>"both"</code> (default).</p>
</td></tr>
<tr><td><code id="case_delete.default_+3A_delete">delete</code></td>
<td>
<p>numeric index of individual cases to be deleted. If the <code>level</code> parameter 
is specified, <code>delete</code> may also take the form of a character vector consisting of group 
names as they appear in <code>flist</code>. It is possible to set <code>level</code> and delete individual
cases from different groups using <code>delete</code>, so numeric indices should be double checked 
to confirm that they encompass entire groups. If <code>delete = NULL</code> then all cases are iteratively deleted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the following components:
</p>

<dl>
<dt><code>fixef.original</code></dt><dd><p>the original fixed effects estimates</p>
</dd>
<dt><code>ranef.original</code></dt><dd><p>the original predicted random effects</p>
</dd>
<dt><code>vcov.original</code></dt><dd><p>the original variance-covariance matrix for the fixed effects</p>
</dd>
<dt><code>varcomp.original</code></dt><dd><p>the original estimated variance components</p>
</dd>
<dt><code>fixef.delete</code></dt><dd><p>a list of the fixed effects estimated after case deletion</p>
</dd>
<dt><code>ranef.delete</code></dt><dd><p>a list of the random effects predicted after case deletion</p>
</dd>
<dt><code>vcov.delete</code></dt><dd><p>a list of the variance-covariance matrices for the fixed 
effects obtained after case deletion</p>
</dd>
<dt><code>fitted.delete</code></dt><dd><p>a list of the fitted values obtained after case
deletion</p>
</dd>
<dt><code>varcomp.delete</code></dt><dd><p>a list of the estimated variance components obtained after
case deletion</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>References</h3>

<p>Christensen, R., Pearson, L.M., and Johnson, W. (1992)
Case-Deletion Diagnostics for Mixed Models, <em>Technometrics</em>, <b>34</b>, 38
&ndash; 45.
</p>
<p>Schabenberger, O. (2004) Mixed Model Influence Diagnostics, in
<em>Proceedings of the Twenty-Ninth SAS Users Group International
Conference</em>, SAS Users Group International.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleepstudy, package = 'lme4')
fm &lt;- lme4::lmer(Reaction ~ Days + (Days|Subject), sleepstudy)

# Deleting every Subject
fmDel &lt;- case_delete(model = fm, level = "Subject", type = "both")

# Deleting only subject 308
del308 &lt;- case_delete(model = fm, level = "Subject", type = "both", delete = 308)

# Deleting a subset of subjects
delSubset &lt;- case_delete(model = fm, level = "Subject", type = "both", delete = 308:310)

</code></pre>

<hr>
<h2 id='compare_eb_ls'>Visually comparing shrinkage and LS estimates</h2><span id='topic+compare_eb_ls'></span>

<h3>Description</h3>

<p>This function creates a plot (using <code>qplot()</code>) where the shrinkage
estimate appears on the horizontal axis and the LS estimate appears on the
vertical axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_eb_ls(eb, ols, identify = FALSE, silent = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_eb_ls_+3A_eb">eb</code></td>
<td>
<p>a matrix of random effects</p>
</td></tr>
<tr><td><code id="compare_eb_ls_+3A_ols">ols</code></td>
<td>
<p>a matrix of the OLS estimates found using <code>random_ls_coef</code></p>
</td></tr>
<tr><td><code id="compare_eb_ls_+3A_identify">identify</code></td>
<td>
<p>the percentage of points to identify as unusual,
<code>FALSE</code> if you do not want the points identified.</p>
</td></tr>
<tr><td><code id="compare_eb_ls_+3A_silent">silent</code></td>
<td>
<p>logical: should the list of data frames used to make the plots
be suppressed.</p>
</td></tr>
<tr><td><code id="compare_eb_ls_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to <code>qplot()</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wages.fm1 &lt;- lme4::lmer(lnw ~ exper + (exper | id), data = wages)
wages.sepLM &lt;- adjust_lmList(lnw ~ exper | id, data = wages)
rancoef.eb &lt;- coef(wages.fm1)$id
rancoef.ols &lt;- coef(wages.sepLM)
compare_eb_ls(eb = rancoef.eb, ols = rancoef.ols, identify = 0.01)

</code></pre>

<hr>
<h2 id='covratio.default'>Influence on precision of fixed effects in HLMs</h2><span id='topic+covratio.default'></span><span id='topic+covtrace.default'></span><span id='topic+covratio.mer'></span><span id='topic+covratio'></span><span id='topic+covratio.lmerMod'></span><span id='topic+covratio.lme'></span><span id='topic+covtrace.mer'></span><span id='topic+covtrace'></span><span id='topic+covtrace.lmerMod'></span><span id='topic+covtrace.lme'></span>

<h3>Description</h3>

<p>These functions calculate measures of the change in the covariance
matrices for the fixed effects based on the deletion of an
observation, or group of observations, for a hierarchical 
linear model fit using <code>lmer</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
covratio(object, ...)

## Default S3 method:
covtrace(object, ...)

## S3 method for class 'mer'
covratio(object, level = 1, delete = NULL, ...)

## S3 method for class 'lmerMod'
covratio(object, level = 1, delete = NULL, ...)

## S3 method for class 'lme'
covratio(object, level = 1, delete = NULL, ...)

## S3 method for class 'mer'
covtrace(object, level = 1, delete = NULL, ...)

## S3 method for class 'lmerMod'
covtrace(object, level = 1, delete = NULL, ...)

## S3 method for class 'lme'
covtrace(object, level = 1, delete = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covratio.default_+3A_object">object</code></td>
<td>
<p>fitted object of class <code>mer</code> or <code>lmerMod</code></p>
</td></tr>
<tr><td><code id="covratio.default_+3A_...">...</code></td>
<td>
<p>do not use</p>
</td></tr>
<tr><td><code id="covratio.default_+3A_level">level</code></td>
<td>
<p>variable used to define the group for which cases will be
deleted.  If <code>level = 1</code> (default), then individual cases will be deleted.</p>
</td></tr>
<tr><td><code id="covratio.default_+3A_delete">delete</code></td>
<td>
<p>index of individual cases to be deleted. To delete specific 
observations the row number must be specified. To delete higher level
units the group ID and <code>group</code> parameter must be specified.
If <code>delete = NULL</code> then all cases are iteratively deleted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both the covariance ratio (<code>covratio</code>) and the covariance trace
(<code>covtrace</code>) measure the change in the covariance matrix
of the fixed effects based on the deletion of a subset of observations.
The key difference is how the variance covariance matrices are compared:
<code>covratio</code> compares the ratio of the determinants while <code>covtrace</code>
compares the trace of the ratio.
</p>


<h3>Value</h3>

<p>If <code>delete = NULL</code> then a vector corresponding to each deleted
observation/group is returned.
</p>
<p>If <code>delete</code> is specified then a single value is returned corresponding
to the deleted subset specified.
</p>


<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>References</h3>

<p>Christensen, R., Pearson, L., &amp; Johnson, W. (1992) 
Case-deletion diagnostics for mixed models. <em>Technometrics</em>, <b>34</b>(1), 
38&ndash;45.
</p>
<p>Schabenberger, O. (2004) Mixed Model Influence Diagnostics,
in <em>Proceedings of the Twenty-Ninth SAS Users Group International Conference</em>,
SAS Users Group International.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+leverage.mer">leverage.mer</a></code>, <code><a href="#topic+cooks.distance.mer">cooks.distance.mer</a></code>
<code><a href="#topic+mdffits.mer">mdffits.mer</a></code>, <code><a href="#topic+rvc.mer">rvc.mer</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(sleepstudy, package = 'lme4')
ss &lt;- lme4::lmer(Reaction ~ Days + (Days | Subject), data = sleepstudy)

# covratio for individual observations
ss.cr1 &lt;- covratio(ss)

# covratio for subject-level deletion
ss.cr2 &lt;- covratio(ss, level = "Subject")

## Not run: 
## A larger example
data(Exam, package = 'mlmRev')
fm &lt;- lme4::lmer(normexam ~ standLRT * schavg + (standLRT | school), data = Exam)

# covratio for individual observations
cr1 &lt;- covratio(fm)

# covratio for school-level deletion
cr2 &lt;- covratio(fm, level = "school")

## End(Not run)

# covtrace for individual observations
ss.ct1 &lt;- covtrace(ss)

# covtrace for subject-level deletion
ss.ct2 &lt;- covtrace(ss, level = "Subject")

## Not run: 
## Returning to the larger example
# covtrace for individual observations
ct1 &lt;- covtrace(fm)

# covtrace for school-level deletion
ct2 &lt;- covtrace(fm, level = "school")

## End(Not run)
</code></pre>

<hr>
<h2 id='dotplot_diag'>Dot plots for influence diagnostics</h2><span id='topic+dotplot_diag'></span>

<h3>Description</h3>

<p>This is a function that can be used to create (modified) dotplots for the
diagnostic measures.  The plot allows the user to understand the distribution
of the diagnostic measure and visually identify unusual cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dotplot_diag(
  x,
  cutoff,
  name = c("cooks.distance", "mdffits", "covratio", "covtrace", "rvc", "leverage"),
  data,
  index = NULL,
  modify = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dotplot_diag_+3A_x">x</code></td>
<td>
<p>values of the diagnostic of interest</p>
</td></tr>
<tr><td><code id="dotplot_diag_+3A_cutoff">cutoff</code></td>
<td>
<p>value(s) specifying the boundary for unusual values of the 
diagnostic. The cutoff(s) can either be supplied by the user, or automatically
calculated using measures of internal scaling if <code>cutoff = "internal"</code>.</p>
</td></tr>
<tr><td><code id="dotplot_diag_+3A_name">name</code></td>
<td>
<p>what diagnostic is being plotted
(one of <code>"cooks.distance"</code>, <code>"mdffits"</code>, <code>"covratio"</code>, 
<code>"covtrace"</code>, <code>"rvc"</code>, or <code>"leverage"</code>).
This is used for the calculation of &quot;internal&quot; cutoffs.</p>
</td></tr>
<tr><td><code id="dotplot_diag_+3A_data">data</code></td>
<td>
<p>data frame to use (optional)</p>
</td></tr>
<tr><td><code id="dotplot_diag_+3A_index">index</code></td>
<td>
<p>optional parameter to specify index (IDs) of <code>x</code> values.
If <code>NULL</code>(default), values will be indexed in the order of the vector 
passed to <code>x</code>.</p>
</td></tr>
<tr><td><code id="dotplot_diag_+3A_modify">modify</code></td>
<td>
<p>specifies the <code>geom</code> to be used to produce a 
space-saving modification: either <code>"dotplot"</code> or <code>"boxplot"</code></p>
</td></tr>
<tr><td><code id="dotplot_diag_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to <code>ggplot()</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>The resulting plot uses <code>coord_flip</code> to rotate the plot, so when
adding customized axis labels you will need to flip the names 
between the x and y axes.
</p>


<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleepstudy, package = 'lme4')
fm &lt;- lme4::lmer(Reaction ~ Days + (Days | Subject), sleepstudy)

#Observation level deletion and diagnostics
obs.infl &lt;- hlm_influence(fm, level = 1)

dotplot_diag(x = obs.infl$cooksd, cutoff = "internal", name = "cooks.distance", modify = FALSE)

dotplot_diag(x = obs.infl$mdffits, cutoff = "internal", name = "cooks.distance", modify = FALSE)

# Subject level deletion and diagnostics
subject.infl  &lt;- hlm_influence(fm, level = "Subject")

dotplot_diag(x = subject.infl$cooksd, cutoff = "internal",
             name = "cooks.distance", modify = FALSE)
             
dotplot_diag(x = subject.infl$mdffits, cutoff = "internal", name = "mdffits", modify = "dotplot")
</code></pre>

<hr>
<h2 id='extract_design'>Extracting covariance matrices from lme</h2><span id='topic+extract_design'></span>

<h3>Description</h3>

<p>This function extracts the full covariance matrices from a mixed/hierarchical
linear model fit using <code>lme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_design(b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_design_+3A_b">b</code></td>
<td>
<p>a fitted model object of class <code>lme</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of matrices is returned.
</p>

<ul>
<li><p><code>D</code> contains the covariance matrix of the random effects.
</p>
</li>
<li><p><code>V</code> contains the covariance matrix of the response.
</p>
</li>
<li><p><code>X</code> contains the fixed-effect model matrix.
</p>
</li>
<li><p><code>Z</code> contains the random-effect model matrix.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>References</h3>

<p>This method has been adapted from the method
<code>mgcv::extract.lme.cov</code> in the <code>mgcv</code> package, written by Simon
N. Wood <a href="mailto:simon.wood@r-project.org">simon.wood@r-project.org</a>.
</p>

<hr>
<h2 id='hlm_augment'>Calculating residuals and influence diagnostics for HLMs
<code>hlm_augment</code> is used to compute residuals, fitted values, and influence diagnostics for a 
hierarchical linear model. The residuals and fitted values are computed using Least Squares(LS)
and Empirical Bayes (EB) methods. The influence diagnostics are computed through one step 
approximations.</h2><span id='topic+hlm_augment'></span><span id='topic+hlm_augment.default'></span><span id='topic+hlm_augment.lmerMod'></span>

<h3>Description</h3>

<p>Calculating residuals and influence diagnostics for HLMs
</p>
<p><code>hlm_augment</code> is used to compute residuals, fitted values, and influence diagnostics for a 
hierarchical linear model. The residuals and fitted values are computed using Least Squares(LS)
and Empirical Bayes (EB) methods. The influence diagnostics are computed through one step 
approximations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hlm_augment(object, ...)

## Default S3 method:
hlm_augment(object, ...)

## S3 method for class 'lmerMod'
hlm_augment(object, level = 1, include.ls = TRUE, data = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hlm_augment_+3A_object">object</code></td>
<td>
<p>an object of class <code>lmerMod</code> or <code>lme</code>.</p>
</td></tr>
<tr><td><code id="hlm_augment_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr>
<tr><td><code id="hlm_augment_+3A_level">level</code></td>
<td>
<p>which residuals should be extracted and what cases should be deleted for influence diagnostics.
If <code>level = 1</code> (default), then within-group (case-level) residuals are returned and influence diagnostics
are calculated for individual observations. Otherwise, <code>level</code> should be the name of a grouping
factor as defined in <code>flist</code> for a <code>lmerMod</code> object or as in <code>groups</code> for a <code>lme</code> object.
This will return between-group residuals and influence diagnostics calculated for each group.</p>
</td></tr>
<tr><td><code id="hlm_augment_+3A_include.ls">include.ls</code></td>
<td>
<p>a logical indicating if LS residuals should be included in the
return tibble. <code>include.ls = FALSE</code> decreases runtime substantially.</p>
</td></tr>
<tr><td><code id="hlm_augment_+3A_data">data</code></td>
<td>
<p>the original data frame passed to 'lmer'. This is only necessary for 'lmerMod' models where
'na.action = &quot;na.exclude&quot;'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>hlm_augment</code> function combines functionality from <code>hlm_resid</code>
and <code>hlm_influence</code> for a simpler way of obtaining residuals and influence 
diagnostics. Please see <code>?hlm_resid</code> and <code>?hlm_influence</code> for additional information 
about the returned values.
</p>


<h3>Note</h3>

<p><code>hlm_augment</code> does not allow for the deletion of specific cases, the specification of other
types of leverage, or the use of full refits of the model instead of one step approximations for influence
diagnostics. If this additional functionality is desired, <code>hlm_influence</code> should be used instead. The additional
parameter <code>standardize</code> is available in <code>hlm_resid</code>; if this are desired, <code>hlm_resid</code>
should be used instead.
</p>

<hr>
<h2 id='hlm_influence.default'>Calculating influence diagnostics for HLMs</h2><span id='topic+hlm_influence.default'></span><span id='topic+hlm_influence.lmerMod'></span><span id='topic+hlm_influence'></span><span id='topic+hlm_influence.lme'></span>

<h3>Description</h3>

<p>This function is used to compute influence diagnostics for a hierarchical linear model.
It takes a model fit as a <code>lmerMod</code> object or as a <code>lme</code> object and returns a tibble with Cook's
distance, MDFFITS, covtrace, covratio, and leverage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
hlm_influence(model, ...)

## S3 method for class 'lmerMod'
hlm_influence(
  model,
  level = 1,
  delete = NULL,
  approx = TRUE,
  leverage = "overall",
  data = NULL,
  ...
)

## S3 method for class 'lme'
hlm_influence(
  model,
  level = 1,
  delete = NULL,
  approx = TRUE,
  leverage = "overall",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hlm_influence.default_+3A_model">model</code></td>
<td>
<p>an object of class <code>lmerMod</code> or <code>lme</code></p>
</td></tr>
<tr><td><code id="hlm_influence.default_+3A_...">...</code></td>
<td>
<p>not in use</p>
</td></tr>
<tr><td><code id="hlm_influence.default_+3A_level">level</code></td>
<td>
<p>used to define the group for which cases are deleted and influence
diagnostics are calculated. If <code>level = 1</code> (default), then influence diagnostics are
calculated for individual observations. Otherwise, <code>level</code> should be the name of a grouping
factor as defined in <code>flist</code> for a <code>lmerMod</code> object or as in <code>groups</code> for a <code>lme</code> object.</p>
</td></tr>
<tr><td><code id="hlm_influence.default_+3A_delete">delete</code></td>
<td>
<p>numeric index of individual cases to be deleted. If the <code>level</code> parameter 
is specified, <code>delete</code> may also take the form of a character vector consisting of group 
names as they appear in <code>flist</code> for <code>lme4</code> models or as in <code>groups</code> for <code>nlme</code> models. 
If <code>delete = NULL</code> then all cases are iteratively deleted.</p>
</td></tr>
<tr><td><code id="hlm_influence.default_+3A_approx">approx</code></td>
<td>
<p>logical parameter used to determine how the influence diagnostics are calculated.
If <code>FALSE</code> (default), influence diagnostics are calculated using a one step approximation.
If <code>TRUE</code>, influence diagnostics are calculated by iteratively deleting groups and refitting
the model using <code>lmer</code>. This method is more accurate, but slower than the one step approximation.
If <code>approx = FALSE</code>, the returned tibble also contains columns for relative variance change (RVC).</p>
</td></tr>
<tr><td><code id="hlm_influence.default_+3A_leverage">leverage</code></td>
<td>
<p>a character vector to determine which types of leverage should be included in the
returned tibble. There are four options: 'overall' (default), 'fixef', 'ranef', or 'ranef.uc'.
One or more types may be specified. For additional information about the types of leverage, see
<code>?leverage</code>.</p>
</td></tr>
<tr><td><code id="hlm_influence.default_+3A_data">data</code></td>
<td>
<p>(optional) the data frame used to fit the model. This is only necessary for <code>lmerMod</code> models if
<code>na.action = "na.exclude"</code> was set.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>hlm_influence</code> function provides a wrapper that appends influence diagnostics
to the original data. The approximated influence diagnostics returned by this
function are equivalent to those returned by <code>cooks.distance</code>, <code>mdffits</code>, <code>covtrace</code>,
<code>covratio</code>, and <code>leverage</code>. The exact influence diagnostics obtained through a full
refit of the data are also available through <code>case_delete</code> and the accompanying functions
<code>cooks.distance</code>, <code>mdffits</code>, <code>covtrace</code>, and <code>covratio</code> that can be called
directly on the <code>case_delete</code> object.
</p>


<h3>Note</h3>

<p>It is possible to set <code>level</code> and delete individual cases from different groups using 
<code>delete</code>, so numeric indices should be double checked to confirm that they encompass entire groups.
Additionally, if <code>delete</code> is specified, leverage values are not returned in the resulting tibble.
</p>

<hr>
<h2 id='hlm_resid.default'>Calculating residuals from HLMs</h2><span id='topic+hlm_resid.default'></span><span id='topic+hlm_resid.lmerMod'></span><span id='topic+hlm_resid'></span><span id='topic+hlm_resid.lme'></span>

<h3>Description</h3>

<p><code>hlm_resid</code> takes a hierarchical linear model fit as a <code>lmerMod</code> or
<code>lme</code> object and extracts residuals and predicted values from the model,
using Least Squares (LS) and Empirical Bayes (EB) methods. It then appends
them to the model data frame in the form of a tibble inspired by the <code>augment</code>
function in <code>broom</code>. This unified framework enables the analyst to more
easily conduct an upward residual analysis during model exploration/checking.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
hlm_resid(object, ...)

## S3 method for class 'lmerMod'
hlm_resid(
  object,
  level = 1,
  standardize = FALSE,
  include.ls = TRUE,
  data = NULL,
  ...
)

## S3 method for class 'lme'
hlm_resid(
  object,
  level = 1,
  standardize = FALSE,
  include.ls = TRUE,
  data = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hlm_resid.default_+3A_object">object</code></td>
<td>
<p>an object of class <code>lmerMod</code> or <code>lme</code>.</p>
</td></tr>
<tr><td><code id="hlm_resid.default_+3A_...">...</code></td>
<td>
<p>do not use</p>
</td></tr>
<tr><td><code id="hlm_resid.default_+3A_level">level</code></td>
<td>
<p>which residuals should be extracted: 1 for within-group
(case-level) residuals, the name of a grouping factor for between-group
residuals (as defined in <code>flist</code> in <code>lmerMod</code> objects or in
<code>groups</code> in <code>lme</code> objects)</p>
</td></tr>
<tr><td><code id="hlm_resid.default_+3A_standardize">standardize</code></td>
<td>
<p>for any level, if <code>standardize = TRUE</code> the
standardized residuals will be returned for any group; for level-1 only, if
<code>standardize = "semi"</code> then the semi-standardized level-1 residuals
will be returned</p>
</td></tr>
<tr><td><code id="hlm_resid.default_+3A_include.ls">include.ls</code></td>
<td>
<p>a logical indicating if LS residuals be included in the
return tibble. <code>include.ls = FALSE</code> decreases runtime substantially.</p>
</td></tr>
<tr><td><code id="hlm_resid.default_+3A_data">data</code></td>
<td>
<p>if <code>na.action = na.exclude</code>, the user must provide the data
set used to fit the model, otherwise <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>hlm_resid</code> function provides a wrapper that will extract
residuals and predicted values from a fitted <code>lmerMod</code> or <code>lme</code>
object. The function provides access to residual quantities already made available by
the functions <code>resid</code>, <code>predict</code>, and <code>ranef</code>, but adds
additional functionality. Below is a list of types of residuals and predicted
values that are extracted and appended to the model data.
</p>

<dl>
<dt><strong>level-1 residuals</strong></dt><dd></dd>
<dt><code>.resid</code> and <code>.fitted</code></dt><dd><p>Residuals calculated using
the EB method (using maximum likelihood). Level-1 EB residuals are interrelated
with higher level residuals. Equivalent to the residuals extracted by
<code>resid(object)</code> and <code>predict(object)</code> respectively. When
<code>standardize = TRUE</code>, residuals are standardized by sigma components of
the model object.</p>
</dd>
<dt><code>.ls.resid</code> and <code>.ls.fitted</code></dt><dd><p>Residuals calculated calculated
by fitting separate LS regression models for each group. Level-1 LS residuals
are unconfounded by higher level residuals, but unreliable for small
within-group sample sizes.</p>
</dd>
<dt><code>.mar.resid</code> and <code>.mar.fitted</code></dt><dd><p>Marginal residuals only
consider the fixed effect portion of the estimates. Equivalent to
<code>resid(object, level=0)</code> in <code>nlme</code>, not currently implemented
within the <code>lme4::resid</code> function. When <code>standardize = TRUE</code>,
Cholesky marginal residuals are returned.</p>
</dd>
<dt><strong>higher-level residuals</strong> (random effects)</dt><dd></dd>
<dt><code>.ranef.var_name</code></dt><dd><p>The group level random effects using the EB method of
estimating parameters. Equivalent to <code>ranef(object)</code> on the specified
level. EB residuals are preferred at higher levels as LS residuals are dependent
on a large sample size.</p>
</dd>
<dt><code>.ls.var_name</code></dt><dd><p>The group level random effects using the LS method of
estimating parameters. Calculated using <code>ranef</code> on a <code>lmList</code>
object to compare the random effects of individual models to the global
model.</p>
</dd>
</dl>

<p>Note that <code>standardize = "semi"</code> is only implemented for level-1 LS residuals.
</p>


<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>, Jack Moran, Jaylin Lowe
</p>


<h3>References</h3>

<p>Hilden-Minton, J. (1995) Multilevel diagnostics for mixed and hierarchical 
linear models. University of California Los Angeles.
</p>
<p>Houseman, E. A., Ryan, L. M., &amp; Coull, B. A. (2004) 
Cholesky Residuals for Assessing Normal Errors in a Linear 
Model With Correlated Outcomes. 
<em>Journal of the American Statistical Association</em>, 99(466), 383&ndash;394.
</p>
<p>David Robinson and Alex Hayes (2020). broom: Convert Statistical Analysis
Objects into Tidy Tibbles. R package version 0.5.6.
<a href="https://CRAN.R-project.org/package=broom">https://CRAN.R-project.org/package=broom</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hlm_augment">hlm_augment</a></code>, <code><a href="stats.html#topic+resid">resid</a></code>, <code><a href="nlme.html#topic+ranef">ranef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleepstudy, package = "lme4")
fm.lmer &lt;- lme4::lmer(Reaction ~ Days + (Days|Subject), sleepstudy)
fm.lme &lt;- nlme::lme(Reaction ~ Days, random = ~Days|Subject, sleepstudy)

# level-1 and marginal residuals
fm.lmer.res1 &lt;- hlm_resid(fm.lmer) ## raw level-1 and mar resids
fm.lmer.res1
fm.lme.std1 &lt;- hlm_resid(fm.lme, standardize = TRUE) ## std level-1 and mar resids
fm.lme.std1

# level-2 residuals
fm.lmer.res2 &lt;- hlm_resid(fm.lmer, level = "Subject") ## level-2 ranefs
fm.lmer.res2
fm.lme.res2 &lt;- hlm_resid(fm.lme, level = "Subject", include.ls = FALSE) ##level-2 ranef, no LS
fm.lme.res2
</code></pre>

<hr>
<h2 id='HLMdiag'>Diagnostic tools for hierarchical (multilevel) linear models</h2><span id='topic+HLMdiag'></span><span id='topic+package-HLMdiag'></span>

<h3>Description</h3>

<p>HLMdiag provides a suite of diagnostic tools for hierarchical 
(multilevel) linear models fit using the <code>lme4</code> or <code>nlme</code>
packages. These tools are grouped below by purpose. 
See the help documentation for additional information
about each function.
</p>


<h3>Details</h3>

<p><b>Residual analysis</b>
</p>
<p>HLMdiag's <code><a href="#topic+hlm_resid">hlm_resid</a></code> function provides a wrapper that 
extracts residuals and fitted values for individual observations
or groups of observations. In addition to being a wrapper function for functions
implemented in the <code>lme4</code> and <code>nlme</code> packages,
<code><a href="#topic+hlm_resid">hlm_resid</a></code> provides access to the marginal and least squares
residuals.
</p>
<p><b>Influence analysis</b>
</p>
<p>HLMdiag's <code><a href="#topic+hlm_influence">hlm_influence</a></code> function provides a convenient wrapper 
to obtain influence diagnostics for each observation or group of observations 
appended to the data used to fit the model. The diagnostics returned by 
<code><a href="#topic+hlm_influence">hlm_influence</a></code> include Cook's distance, MDFFITS, covariance trace (covtrace),
covariance ratio (covratio), leverage, and relative variance change (RVC). 
HLMdiag also contains functions to calculate these diagnostics individually, as discussed below. 
</p>
<p>Influence on fitted values
</p>
<p>HLMdiag provides <code><a href="#topic+leverage">leverage</a></code> that calculates the influence
that observations/groups have on the fitted values (leverage). 
For mixed/hierarchical models leverage can be decomposed into two parts: the 
fixed part and the random part. We refer the user to the references
cited in the help documentation for additional explanation.
</p>
<p>Influence on fixed effects estimates
</p>
<p>HLMdiag provides <code><a href="#topic+cooks.distance">cooks.distance</a></code> and <code><a href="#topic+mdffits">mdffits</a></code>
to assess the influence of subsets of observations on the fixed effects.
</p>
<p>Influence on precision of fixed effects
</p>
<p>HLMdiag provides <code><a href="#topic+covratio">covratio</a></code> and <code><a href="#topic+covtrace">covtrace</a></code>
to assess the influence of subsets of observations on the precision of
the fixed effects.
</p>
<p>Influence on variance components
</p>
<p>HLMdiag's <code><a href="#topic+rvc">rvc</a></code> calculates the relative variance change to
assess the influence of subsets of observations on the variance
components.
</p>
<p><b>Graphics</b>
</p>
<p>HLMdiag also strives to make graphical assessment easier in the 
<code>ggplot2</code> framework by providing dotplots for influence diagnostics
(<code><a href="#topic+dotplot_diag">dotplot_diag</a></code>), grouped Q-Q plots (<code><a href="#topic+group_qqnorm">group_qqnorm</a></code>),
and Q-Q plots that combine the functionality of <code><a href="stats.html#topic+qqnorm">qqnorm</a></code> and
<code><a href="stats.html#topic+qqline">qqline</a></code> (<code><a href="#topic+ggplot_qqnorm">ggplot_qqnorm</a></code>).
</p>

<hr>
<h2 id='HLMdiag-defunct'>Defunct functions in package HLMdiag</h2><span id='topic+HLMdiag-defunct'></span><span id='topic+HLMresid'></span><span id='topic+HLMresid.default'></span><span id='topic+HLMresid.lmerMod'></span><span id='topic+HLMresid.mer'></span><span id='topic+diagnostics'></span><span id='topic+group_qqnorm'></span><span id='topic+ggplot_qqnorm'></span>

<h3>Description</h3>

<p>These functions are defunct and no longer available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HLMresid(...)

HLMresid.default(...)

HLMresid.lmerMod(...)

HLMresid.mer(...)

diagnostics(...)

group_qqnorm(...)

ggplot_qqnorm(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HLMdiag-defunct_+3A_...">...</code></td>
<td>
<p>arguments passed to defunct functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>HLMresid</code> is replaced by <code><a href="#topic+hlm_resid">hlm_resid</a></code>
</p>
<p><code>diagnostics</code> is replaced by <code><a href="#topic+hlm_influence">hlm_influence</a></code>
</p>
<p><code>group_qqnorm</code> and <code>group_qqnorm</code> are replaced by functions in <span class="pkg">qqplotr</span>. 
See <code><a href="qqplotr.html#topic+stat_qq_point">stat_qq_point</a></code>, <code><a href="qqplotr.html#topic+stat_qq_line">stat_qq_line</a></code>, and 
<code><a href="qqplotr.html#topic+stat_qq_band">stat_qq_band</a></code>.
</p>

<hr>
<h2 id='HLMdiag-deprecated'>Deprecated functions in HLMdiag</h2><span id='topic+HLMdiag-deprecated'></span>

<h3>Description</h3>

<p>These functions still work but will be removed (defunct) in the next version.
</p>


<h3>Details</h3>


<ul>
<li> <p><code><a href="#topic+HLMresid">HLMresid</a></code>: This function is deprecated, and will
be removed in the next version of this package.
</p>
</li>
<li> <p><code><a href="#topic+diagnostics">diagnostics</a></code>: This function is deprecated, and will
be removed in the next version of this package.
</p>
</li></ul>


<hr>
<h2 id='leverage.default'>Leverage for HLMs</h2><span id='topic+leverage.default'></span><span id='topic+leverage.mer'></span><span id='topic+leverage'></span><span id='topic+leverage.lmerMod'></span><span id='topic+leverage.lme'></span>

<h3>Description</h3>

<p>This function calculates the leverage of
a hierarchical linear model fit by <code>lmer</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
leverage(object, ...)

## S3 method for class 'mer'
leverage(object, level = 1, ...)

## S3 method for class 'lmerMod'
leverage(object, level = 1, ...)

## S3 method for class 'lme'
leverage(object, level = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leverage.default_+3A_object">object</code></td>
<td>
<p>fitted object of class <code>mer</code> of <code>lmerMod</code></p>
</td></tr>
<tr><td><code id="leverage.default_+3A_...">...</code></td>
<td>
<p>do not use</p>
</td></tr>
<tr><td><code id="leverage.default_+3A_level">level</code></td>
<td>
<p>the level at which the leverage should be calculated: either
1 for observation level leverage (default) or the name of the grouping factor 
(as defined in <code>flist</code> of the <code>mer</code> object) for group level
leverage. <code>leverage</code> assumes that the grouping factors are unique;
thus, if IDs are repeated within each unit, unique IDs must be generated 
by the user prior to use of <code>leverage</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Demidenko and Stukel (2005) describe leverage for mixed (hierarchical)
linear models as being the sum of two components, a leverage associated with the 
fixed (<code class="reqn">H_1</code>) and a leverage associated with the random effects (<code class="reqn">H_2</code>) where
</p>
<p style="text-align: center;"><code class="reqn">H_1 = X (X^\prime V^{-1} X)^{-1} X^\prime V^{-1}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">H_2 = ZDZ^{\prime} V^{-1} (I - H_1)</code>
</p>

<p>Nobre and Singer (2011) propose using
</p>
<p style="text-align: center;"><code class="reqn">H_2^* = ZDZ^{\prime}</code>
</p>

<p>as the random effects leverage as it does not rely on the fixed effects.
</p>
<p>For individual observations <code>leverage</code> uses the diagonal elements of the 
above matrices as the measure of leverage. For higher-level units, 
<code>leverage</code> uses the mean trace of the above matrices associated with each
higher-level unit.
</p>


<h3>Value</h3>

<p><code>leverage</code> returns a data frame with the following columns:
</p>

<dl>
<dt><code>overall</code></dt><dd><p>The overall leverage, i.e. <code class="reqn">H = H_1 + H_2</code>.</p>
</dd>
<dt><code>fixef</code></dt><dd><p>The leverage corresponding to the fixed effects.</p>
</dd>
<dt><code>ranef</code></dt><dd><p>The leverage corresponding to the random effects 
proposed by Demidenko and Stukel (2005).</p>
</dd>
<dt><code>ranef.uc</code></dt><dd><p>The (unconfounded) leverage corresponding to the 
random effects proposed by Nobre and Singer (2011).</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>References</h3>

<p>Demidenko, E., &amp; Stukel, T. A. (2005) 
Influence analysis for linear mixed-effects models. 
<em>Statistics in Medicine</em>, <b>24</b>(6), 893&ndash;909.
</p>
<p>Nobre, J. S., &amp; Singer, J. M. (2011) 
Leverage analysis for linear mixed  models. 
<em>Journal of Applied Statistics</em>, <b>38</b>(5), 1063&ndash;1072.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cooks.distance.mer">cooks.distance.mer</a></code>, <code><a href="#topic+mdffits.mer">mdffits.mer</a></code>,
<code><a href="#topic+covratio.mer">covratio.mer</a></code>, <code><a href="#topic+covtrace.mer">covtrace.mer</a></code>, <code><a href="#topic+rvc.mer">rvc.mer</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleepstudy, package = 'lme4')
fm &lt;- lme4::lmer(Reaction ~ Days + (Days | Subject), sleepstudy)

# Observation level leverage
lev1 &lt;- leverage(fm, level = 1)
head(lev1)

# Group level leverage
lev2 &lt;- leverage(fm, level = "Subject")
head(lev2)
</code></pre>

<hr>
<h2 id='LSresids.default'>Calculating least squares residuals</h2><span id='topic+LSresids.default'></span><span id='topic+LSresids.mer'></span><span id='topic+LSresids'></span><span id='topic+LSresids.lmerMod'></span><span id='topic+LSresids.lme'></span>

<h3>Description</h3>

<p>This function calculates least squares (LS) residuals
found by fitting separate LS regression models to each case.
For examples see the documentation for <code>HLMresid</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
LSresids(object, ...)

## S3 method for class 'mer'
LSresids(object, level, sim = NULL, standardize = FALSE, ...)

## S3 method for class 'lmerMod'
LSresids(object, level, standardize = FALSE, ...)

## S3 method for class 'lme'
LSresids(object, level, standardize = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LSresids.default_+3A_object">object</code></td>
<td>
<p>an object of class <code>mer</code> or <code>lmerMod</code>.</p>
</td></tr>
<tr><td><code id="LSresids.default_+3A_...">...</code></td>
<td>
<p>do not use</p>
</td></tr>
<tr><td><code id="LSresids.default_+3A_level">level</code></td>
<td>
<p>which residuals should be extracted: 1 for case-level
residuals or the name of a grouping factor (as defined in <code>flist</code> of the 
<code>mer</code> object) for between-group residuals.</p>
</td></tr>
<tr><td><code id="LSresids.default_+3A_sim">sim</code></td>
<td>
<p>optional argument giving the data frame used for LS residuals. This
is used mainly when dealing with simulations. Removed in version 0.3.2.</p>
</td></tr>
<tr><td><code id="LSresids.default_+3A_standardize">standardize</code></td>
<td>
<p>if <code>TRUE</code> the standardized level-1
residuals will also be returned (if <code>level = 1</code>); if <code>"semi"</code> then
the semi-standardized level-1 residuals will be returned.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>References</h3>

<p>Hilden-Minton, J. (1995) Multilevel diagnostics for mixed and hierarchical 
linear models. University of California Los Angeles.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HLMresid">HLMresid</a></code>
</p>

<hr>
<h2 id='mdffits.default'>Influence on fixed effects of HLMs</h2><span id='topic+mdffits.default'></span><span id='topic+cooks.distance.mer'></span><span id='topic+cooks.distance'></span><span id='topic+cooks.distance.lmerMod'></span><span id='topic+cooks.distance.lme'></span><span id='topic+mdffits.mer'></span><span id='topic+mdffits'></span><span id='topic+mdffits.lmerMod'></span><span id='topic+mdffits.lme'></span>

<h3>Description</h3>

<p>These functions calculate measures of the change in the fixed effects
estimates based on the deletion of an observation, or group of 
observations, for a hierarchical linear model fit using <code>lmer</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
mdffits(object, ...)

## S3 method for class 'mer'
cooks.distance(model, level = 1, delete = NULL, ...)

## S3 method for class 'lmerMod'
cooks.distance(model, level = 1, delete = NULL, include.attr = FALSE, ...)

## S3 method for class 'lme'
cooks.distance(model, level = 1, delete = NULL, include.attr = FALSE, ...)

## S3 method for class 'mer'
mdffits(object, level = 1, delete = NULL, ...)

## S3 method for class 'lmerMod'
mdffits(object, level = 1, delete = NULL, include.attr = FALSE, ...)

## S3 method for class 'lme'
mdffits(object, level = 1, delete = NULL, include.attr = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdffits.default_+3A_object">object</code></td>
<td>
<p>fitted object of class <code>mer</code> or <code>lmerMod</code></p>
</td></tr>
<tr><td><code id="mdffits.default_+3A_...">...</code></td>
<td>
<p>do not use</p>
</td></tr>
<tr><td><code id="mdffits.default_+3A_model">model</code></td>
<td>
<p>fitted model of class <code>mer</code> or <code>lmerMod</code></p>
</td></tr>
<tr><td><code id="mdffits.default_+3A_level">level</code></td>
<td>
<p>variable used to define the group for which cases will be
deleted.  If <code>level = 1</code> (default), then individual cases will be deleted.</p>
</td></tr>
<tr><td><code id="mdffits.default_+3A_delete">delete</code></td>
<td>
<p>index of individual cases to be deleted. To delete specific 
observations the row number must be specified. To delete higher level
units the group ID and <code>group</code> parameter must be specified.
If <code>delete = NULL</code> then all cases are iteratively deleted.</p>
</td></tr>
<tr><td><code id="mdffits.default_+3A_include.attr">include.attr</code></td>
<td>
<p>logical value determining whether the difference between 
the full and deleted parameter estimates should be included. If <code>FALSE</code> 
(default), a numeric vector of Cook's distance or MDFFITS is returned. 
If <code>TRUE</code>, a tibble with the Cook's distance or MDFFITS values in the 
first column and the parameter differences in the remaining columns is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both Cook's distance and MDFFITS measure the change in the 
fixed effects estimates based on the deletion of a subset of observations. 
The key difference between the two diagnostics is that Cook's distance uses
the covariance matrix for the fixed effects from the original
model while MDFFITS uses the covariance matrix from the deleted 
model.
</p>


<h3>Value</h3>

<p>Both functions return a numeric vector (or single value if 
<code>delete</code> has been specified) as the default. If <code>include.attr = TRUE</code>, 
then a tibble is returned. The first column consists of the Cook's distance or
MDFFITS values, and the later columns capture the difference between the full
and deleted parameter estimates.
</p>


<h3>Note</h3>

<p>Because MDFFITS requires the calculation of the covariance matrix
for the fixed effects for every model, it will be slower.
</p>


<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>References</h3>

<p>Christensen, R., Pearson, L., &amp; Johnson, W. (1992) 
Case-deletion diagnostics for mixed models. <em>Technometrics</em>, <b>34</b>, 
38&ndash;45.
</p>
<p>Schabenberger, O. (2004) Mixed Model Influence Diagnostics,
in <em>Proceedings of the Twenty-Ninth SAS Users Group International Conference</em>,
SAS Users Group International.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+leverage.mer">leverage.mer</a></code>,
<code><a href="#topic+covratio.mer">covratio.mer</a></code>, <code><a href="#topic+covtrace.mer">covtrace.mer</a></code>, <code><a href="#topic+rvc.mer">rvc.mer</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleepstudy, package = 'lme4')
ss &lt;- lme4::lmer(Reaction ~ Days + (Days | Subject), sleepstudy)

# Cook's distance for individual observations
ss.cd.lev1 &lt;- cooks.distance(ss)

# Cook's distance for each Subject
ss.cd.subject &lt;- cooks.distance(ss, level = "Subject")

## Not run: 
data(Exam, package = 'mlmRev')
fm &lt;- lme4::lmer(normexam ~ standLRT * schavg + (standLRT | school), Exam)

# Cook's distance for individual observations
cd.lev1 &lt;- cooks.distance(fm)

# Cook's distance for each school
cd.school &lt;- cooks.distance(fm, level = "school")

# Cook's distance when school 1 is deleted
cd.school1 &lt;- cooks.distance(fm, level = "school", delete = 1)


## End(Not run)


# MDFFITS  for individual observations
ss.m1 &lt;- mdffits(ss)

# MDFFITS for each Subject
ss.m.subject &lt;- mdffits(ss, level = "Subject")

## Not run:   

# MDFFITS  for individual observations
m1 &lt;- mdffits(fm)

# MDFFITS for each school
m.school &lt;- mdffits(fm, level = "school")

## End(Not run)
</code></pre>

<hr>
<h2 id='pull_resid.default'>Computationally Efficient HLM Residuals</h2><span id='topic+pull_resid.default'></span><span id='topic+pull_resid.lmerMod'></span><span id='topic+pull_resid'></span><span id='topic+pull_resid.lme'></span>

<h3>Description</h3>

<p><code>pull_resid</code> takes a hierarchical linear model fit as a <code>lmerMod</code>
or <code>lme</code> object and returns various types of level-1 residuals as a
vector. Because the <code>pull_resid</code> only calculates one type of residual,
it is more efficient than using <code><a href="#topic+hlm_resid">hlm_resid</a></code> and indexing the
resulting tibble. <code>pull_resid</code> is designed to be used with methods that
take a long time to run, such as the resampling methods found in the
<code>lmeresampler</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
pull_resid(object, ...)

## S3 method for class 'lmerMod'
pull_resid(object, type = "ls", standardize = FALSE, ...)

## S3 method for class 'lme'
pull_resid(object, type = "ls", standardize = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pull_resid.default_+3A_object">object</code></td>
<td>
<p>an object of class <code>lmerMod</code> or <code>lme</code>.</p>
</td></tr>
<tr><td><code id="pull_resid.default_+3A_...">...</code></td>
<td>
<p>not in use</p>
</td></tr>
<tr><td><code id="pull_resid.default_+3A_type">type</code></td>
<td>
<p>which residuals should be returned. Can be either 'ls', 'eb', or
'marginal'</p>
</td></tr>
<tr><td><code id="pull_resid.default_+3A_standardize">standardize</code></td>
<td>
<p>a logical indicating if residuals should be standardized</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><code>type = "ls"</code></dt><dd><p>Residuals calculated by fitting separate LS
regression models for each group. LS residuals are unconfounded by higher
level residuals, but unreliable for small within-group sample sizes. When
<code>standardize = TRUE</code>, residuals are standardized by sigma components of
the model object.</p>
</dd>
<dt><code>type = "eb"</code></dt><dd><p>Residuals calculated using the empirical Bayes (EB)
method using maximum likelihood. EB residuals are interrelated with higher
level residuals. When <code>standardize = TRUE</code>, residuals are standardized
by sigma components of the model object.</p>
</dd>
<dt><code>type = "marginal"</code></dt><dd><p>Marginal residuals only consider the fixed
effect portion of the estimates. When <code>standardize = TRUE</code>, Cholesky
residuals are returned.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><a href="#topic+hlm_resid">hlm_resid</a>
</p>

<hr>
<h2 id='radon'>Radon data</h2><span id='topic+radon'></span>

<h3>Description</h3>

<p>Radon measurements of 919 owner-occupied homes in 85 counties of Minnesota.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(radon)
</code></pre>


<h3>Format</h3>

<p>A data frame with 919 observations on the following 5 variables:
</p>

<dl>
<dt>log.radon</dt><dd><p>Radon measurement (in log pCi/L, i.e., log picoCurie per liter)</p>
</dd>
<dt>basement</dt><dd><p>Indicator for the level of the home at which the radon measurement
was taken - 0 = basement, 1 = first floor.</p>
</dd>
<dt>uranium</dt><dd><p>Average county-level soil uranium content.</p>
</dd>
<dt>county</dt><dd><p>County ID.</p>
</dd>
<dt>county.name</dt><dd><p>County name - a factor.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://www.stat.columbia.edu/~gelman/arm/software/">http://www.stat.columbia.edu/~gelman/arm/software/</a>
</p>


<h3>References</h3>

<p>Price, P. N., Nero, A. V. and Gelman, A. (1996) Bayesian prediction of mean 
indoor radon concentrations for Minnesota counties. <em>Health Physics</em>.
<b>71</b>(6), 922&ndash;936.
</p>
<p>Gelman, A. and Hill, J. (2007) <em>Data analysis using regression and 
multilevel/hierarchical models</em>. Cambridge University Press.
</p>

<hr>
<h2 id='resid_conditional.default'>Conditional residuals</h2><span id='topic+resid_conditional.default'></span><span id='topic+resid_conditional.lmerMod'></span><span id='topic+resid_conditional'></span><span id='topic+resid_conditional.lme'></span>

<h3>Description</h3>

<p>Calculates conditional residuals of <code>lmerMod</code> and <code>lme</code> model objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
resid_conditional(object, type)

## S3 method for class 'lmerMod'
resid_conditional(
  object,
  type = c("raw", "pearson", "studentized", "cholesky")
)

## S3 method for class 'lme'
resid_conditional(
  object,
  type = c("raw", "pearson", "studentized", "cholesky")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_conditional.default_+3A_object">object</code></td>
<td>
<p>an object of class <code>lmerMod</code> or <code>lme</code>.</p>
</td></tr>
<tr><td><code id="resid_conditional.default_+3A_type">type</code></td>
<td>
<p>a character string specifying what type of residuals should be calculated.
It is set to <code>"raw"</code> (observed - fitted) by default. Other options include
<code>"pearson"</code>, <code>"studentized"</code>, and <code>"cholesky"</code>. 
Partial matching of arguments is used, so only the first character needs to be provided.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a model of the form <code class="reqn">Y = X \beta + Z b + \epsilon</code>,
four types of marginal residuals can be calculated:
</p>

<dl>
<dt><code>raw</code></dt><dd><p><code class="reqn">e = Y - X \hat{beta} - Z \hat{b}</code></p>
</dd>
<dt><code>pearson</code></dt><dd><p><code class="reqn">e / \sqrt{diag(\hat{Var}(Y|b)})</code></p>
</dd>
<dt><code>studentized</code></dt><dd><p><code class="reqn">e / \sqrt{diag(\hat{Var}(e))}</code></p>
</dd>
<dt><code>cholesky</code></dt><dd><p><code class="reqn">\hat{C}^{-1} e</code> where <code class="reqn">\hat{C}\hat{C}^\prime = \hat{Var}(e)</code></p>
</dd>
</dl>



<h3>Value</h3>

<p>A vector of conditional residuals.
</p>


<h3>References</h3>

<p>Singer, J. M., Rocha, F. M. M., &amp; Nobre, J. S. (2017). 
Graphical Tools for Detecting Departures from Linear Mixed Model 
Assumptions and Some Remedial Measures. 
<em>International Statistical Review</em>, <b>85</b>, 290&ndash;324.
</p>
<p>Schabenberger, O. (2004) Mixed Model Influence Diagnostics,
in <em>Proceedings of the Twenty-Ninth SAS Users Group International Conference</em>,
SAS Users Group International.
</p>

<hr>
<h2 id='resid_marginal.default'>Marginal residuals</h2><span id='topic+resid_marginal.default'></span><span id='topic+resid_marginal.lmerMod'></span><span id='topic+resid_marginal'></span><span id='topic+resid_marginal.lme'></span>

<h3>Description</h3>

<p>Calculates marginal residuals of <code>lmerMod</code> and <code>lme</code> model objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
resid_marginal(object, type)

## S3 method for class 'lmerMod'
resid_marginal(object, type = c("raw", "pearson", "studentized", "cholesky"))

## S3 method for class 'lme'
resid_marginal(object, type = c("raw", "pearson", "studentized", "cholesky"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_marginal.default_+3A_object">object</code></td>
<td>
<p>an object of class <code>lmerMod</code> or <code>lme</code>.</p>
</td></tr>
<tr><td><code id="resid_marginal.default_+3A_type">type</code></td>
<td>
<p>a character string specifying what type of residuals should be calculated.
It is set to <code>"raw"</code> (observed - fitted) by default. Other options include
<code>"pearson"</code>, <code>"studentized"</code>, and <code>"cholesky"</code>. Partial matching of arguments is used, 
so only the first character needs to be provided.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a model of the form <code class="reqn">Y = X \beta + Z b + \epsilon</code>,
four types of marginal residuals can be calculated:
</p>

<dl>
<dt><code>raw</code></dt><dd><p><code class="reqn">r = Y - X \hat{beta}</code></p>
</dd>
<dt><code>pearson</code></dt><dd><p><code class="reqn">r / \sqrt{ diag(\hat{Var}(Y)})</code></p>
</dd>
<dt><code>studentized</code></dt><dd><p><code class="reqn">r / \sqrt{ diag(\hat{Var}(r)})</code></p>
</dd>
<dt><code>cholesky</code></dt><dd><p><code class="reqn">\hat{C}^{-1} r</code> where <code class="reqn">\hat{C}\hat{C}^\prime = \hat{Var}(Y)</code></p>
</dd>
</dl>



<h3>Value</h3>

<p>A vector of marginal residuals.
</p>


<h3>References</h3>

<p>Singer, J. M., Rocha, F. M. M., &amp; Nobre, J. S. (2017). 
Graphical Tools for Detecting Departures from Linear Mixed Model 
Assumptions and Some Remedial Measures. 
<em>International Statistical Review</em>, <b>85</b>, 290&ndash;324.
</p>
<p>Schabenberger, O. (2004) Mixed Model Influence Diagnostics,
in <em>Proceedings of the Twenty-Ninth SAS Users Group International Conference</em>,
SAS Users Group International.
</p>

<hr>
<h2 id='resid_ranef'>Random effects residuals</h2><span id='topic+resid_ranef'></span>

<h3>Description</h3>

<p>Calculates Random effects  residuals of <code>lmerMod</code> model objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resid_ranef(object, level, which, standardize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_ranef_+3A_object">object</code></td>
<td>
<p>an object of class <code>lmerMod</code>.</p>
</td></tr>
<tr><td><code id="resid_ranef_+3A_level">level</code></td>
<td>
<p>DESCRIPTION</p>
</td></tr>
<tr><td><code id="resid_ranef_+3A_which">which</code></td>
<td>
<p>DESCRIPTION</p>
</td></tr>
<tr><td><code id="resid_ranef_+3A_standardize">standardize</code></td>
<td>
<p>DESCRIPTION</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of conditional residuals.
</p>

<hr>
<h2 id='rotate_ranef.default'>Calculate s-dimensional rotated random effects</h2><span id='topic+rotate_ranef.default'></span><span id='topic+rotate_ranef.mer'></span><span id='topic+rotate_ranef'></span><span id='topic+rotate_ranef.lmerMod'></span><span id='topic+rotate_ranef.lme'></span>

<h3>Description</h3>

<p>This function calculates reduced dimensional rotated random effects. 
The rotation reduces the influence of the residuals from other levels
of the model so that distributional assessment of the resulting
random effects is possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
rotate_ranef(.mod, ...)

## S3 method for class 'mer'
rotate_ranef(.mod, .L, s = NULL, .varimax = FALSE, ...)

## S3 method for class 'lmerMod'
rotate_ranef(.mod, .L, s = NULL, .varimax = FALSE, ...)

## S3 method for class 'lme'
rotate_ranef(.mod, .L, s = NULL, .varimax = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rotate_ranef.default_+3A_.mod">.mod</code></td>
<td>
<p>an object of class <code>mer</code> or <code>lmerMod</code>.</p>
</td></tr>
<tr><td><code id="rotate_ranef.default_+3A_...">...</code></td>
<td>
<p>do not use</p>
</td></tr>
<tr><td><code id="rotate_ranef.default_+3A_.l">.L</code></td>
<td>
<p>a matrix defining which combination of random effects are of interest.</p>
</td></tr>
<tr><td><code id="rotate_ranef.default_+3A_s">s</code></td>
<td>
<p>the dimension of the subspace of interest.</p>
</td></tr>
<tr><td><code id="rotate_ranef.default_+3A_.varimax">.varimax</code></td>
<td>
<p>if <code>.varimax = TRUE</code> than the raw varimax rotation 
will be applied to the resulting rotation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>References</h3>

<p>Loy, A. &amp; Hofmann, H. (in press). Are you Normal? 
The Problem of Confounded Residual Structures in Hierarchical Linear Models.
<em>Journal of Computational and Graphical Statistics</em>.
</p>

<hr>
<h2 id='rvc.default'>Relative variance change for HLMs</h2><span id='topic+rvc.default'></span><span id='topic+rvc.mer'></span><span id='topic+rvc'></span><span id='topic+rvc.lmerMod'></span><span id='topic+rvc.lme'></span>

<h3>Description</h3>

<p>This function calculates the relative variance change (RVC) of
hierarchical linear models fit via <code>lmer</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
rvc(object, ...)

## S3 method for class 'mer'
rvc(object, level = 1, delete = NULL, ...)

## S3 method for class 'lmerMod'
rvc(object, level = 1, delete = NULL, ...)

## S3 method for class 'lme'
rvc(object, level = 1, delete = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rvc.default_+3A_object">object</code></td>
<td>
<p>fitted object of class <code>mer</code> or <code>lmerMod</code></p>
</td></tr>
<tr><td><code id="rvc.default_+3A_...">...</code></td>
<td>
<p>do not use</p>
</td></tr>
<tr><td><code id="rvc.default_+3A_level">level</code></td>
<td>
<p>variable used to define the group for which cases will be
deleted.  If <code>level = 1</code> (default), then individual cases will be deleted.</p>
</td></tr>
<tr><td><code id="rvc.default_+3A_delete">delete</code></td>
<td>
<p>index of individual cases to be deleted. To delete specific 
observations the row number must be specified. To delete higher level
units the group ID and <code>group</code> parameter must be specified.
If <code>delete = NULL</code> then all cases are iteratively deleted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>delete = NULL</code> a matrix with columns corresponding to the variance 
components of the model and rows corresponding to the deleted 
observation/group is returned. 
</p>
<p>If <code>delete</code> is specified then a named vector is returned.
</p>
<p>The residual variance is named <code>sigma2</code> and the other variance 
components are named <code>D**</code> where the trailing digits give the
position in the covariance matrix of the random effects.
</p>


<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>References</h3>

<p>Dillane, D. (2005) Deletion Diagnostics for the Linear Mixed Model. 
Ph.D. thesis, Trinity College Dublin
</p>


<h3>See Also</h3>

<p><code><a href="#topic+leverage.mer">leverage.mer</a></code>, 
<code><a href="#topic+cooks.distance.mer">cooks.distance.mer</a></code>, <code><a href="#topic+mdffits.mer">mdffits.mer</a></code>,
<code><a href="#topic+covratio.mer">covratio.mer</a></code>, <code><a href="#topic+covtrace.mer">covtrace.mer</a></code>
</p>

<hr>
<h2 id='varcomp.mer'>Extracting variance components</h2><span id='topic+varcomp.mer'></span>

<h3>Description</h3>

<p>This function extracts the variance components from a mixed/hierarchical
linear model fit using <code>lmer</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varcomp.mer(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varcomp.mer_+3A_object">object</code></td>
<td>
<p>a fitted model object of class <code>mer</code> or <code>lmerMod</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector is returned. <code>sigma2</code> denotes the residual
variance. The other variance components are names <code>D**</code> where the
trailing digits specify the of that variance component in the covariance
matrix of the random effects.
</p>


<h3>Author(s)</h3>

<p>Adam Loy <a href="mailto:loyad01@gmail.com">loyad01@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleepstudy, package = "lme4") 
fm1 &lt;- lme4::lmer(Reaction ~ Days + (Days|Subject), sleepstudy)
varcomp.mer(fm1)
</code></pre>

<hr>
<h2 id='wages'>Wages for male high school dropouts</h2><span id='topic+wages'></span>

<h3>Description</h3>

<p>Data on the labor-market experience of male high school
dropouts.
</p>


<h3>Format</h3>

<p>A data frame with 6402 observations on the following 15 variables.
</p>
 <dl>
<dt>id</dt><dd><p>respondent id - a factor with 888 levels.</p>
</dd>
<dt>lnw</dt><dd><p>natural log of wages expressed in 1990 dollars.</p>
</dd>
<dt>exper</dt><dd><p>years of experience in the work force</p>
</dd> <dt>ged</dt><dd><p>equals 1 if
respondent has obtained a GED as of the time of survey, 0 otherwise</p>
</dd>
<dt>postexp</dt><dd><p>labor force participation since obtaining a GED (in years) -
before a GED is earned postexp = 0, and on the day a GED is earned postexp =
0</p>
</dd> <dt>black</dt><dd><p>factor - equals 1 if subject is black, 0 otherwise</p>
</dd>
<dt>hispanic</dt><dd><p>factor - equals 1 if subject is hispanic, 0 otherwise</p>
</dd>
<dt>hgc</dt><dd><p>highest grade completed - takes integers 6 through 12</p>
</dd>
<dt>hgc.9</dt><dd><p>hgc - 9, a centered version of hgc</p>
</dd> <dt>uerate</dt><dd><p>local area
unemployment rate for that year</p>
</dd> <dt>ue.7</dt><dd></dd> <dt>ue.centert1</dt><dd></dd>
<dt>ue.mean</dt><dd></dd> <dt>ue.person.cen</dt><dd></dd> <dt>ue1</dt><dd></dd> </dl>


<h3>Source</h3>

<p>These data are originally from the 1979 National
Longitudinal Survey on Youth (NLSY79).
</p>
<p>Singer and Willett (2003) used these data for examples in
chapter (insert info. here) and the data sets used can be
found on the UCLA Statistical Computing website:
<a href="https://stats.idre.ucla.edu/other/examples/alda/">https://stats.idre.ucla.edu/other/examples/alda/</a>
</p>
<p>Additionally the data were discussed by Cook and Swayne
(2003) and the data can be found on the GGobi website:
<a href="http://ggobi.org/book.html">http://ggobi.org/book.html</a>.
</p>


<h3>References</h3>

<p>Singer, J. D. and Willett, J. B. (2003), <em>Applied
Longitudinal Data Analysis: Modeling Change and Event
Occurrence</em>, New York: Oxford University Press.
</p>
<p>Cook, D. and Swayne, D. F. (2007), <em>Interactive and
Dynamic Graphics for Data Analysis with R and GGobi</em>,
Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(wages)
summary(wages)

## Not run: 
library(lme4)
lmer(lnw ~ exper + (exper | id), data = wages)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
