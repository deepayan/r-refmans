<!DOCTYPE html><html><head><title>Help for package STEPCAM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {STEPCAM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#generate.Artificial.Data'>
<p>Generate Artifical data that can be used by the STEPCAM model</p></a></li>
<li><a href='#plotSMC'>
<p>Plot the progression of the SMC algorithm.</p></a></li>
<li><a href='#plotSTEPCAM'>
<p>Plot the output generated by the STEPCAM_ABC function</p></a></li>
<li><a href='#STEPCAM_ABC'>
<p>ABC-SMC inference of the STEPCAM model</p></a></li>
<li><a href='#STEPCAM-internal'><p>Internal STEPCAM functions</p></a></li>
<li><a href='#STEPCAM-package'>
<p>ABC-SMC Inference of STEPCAM</p></a></li>
<li><a href='#TernPlot'>
<p>Create a ternary plot from results of the STEPCAM_ABC function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>ABC-SMC Inference of STEPCAM</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-09-17</td>
</tr>
<tr>
<td>Imports:</td>
<td>gtools, FD, stats, MASS, vcd, ade4, grid, geometry, ape</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>Description:</td>
<td>Collection of model estimation, and model plotting functions 
             related to the STEPCAM family of community assembly models. 
             STEPCAM is a STEPwise Community Assembly Model that infers 
             the relative contribution of Dispersal Assembly, Habitat Filtering 
             and Limiting Similarity from a dataset consisting of the 
             combination of trait and abundance data. See also <a href="http://onlinelibrary.wiley.com/wol1/doi/10.1890/14-0454.1/abstract">http://onlinelibrary.wiley.com/wol1/doi/10.1890/14-0454.1/abstract</a> for more information.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/thijsjanzen/STEPCAM">https://github.com/thijsjanzen/STEPCAM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/thijsjanzen/STEPCAM">https://github.com/thijsjanzen/STEPCAM</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-09-21 09:29:56 UTC; janzen</td>
</tr>
<tr>
<td>Author:</td>
<td>Thijs Janzen [aut, cre],
  Fons van der Plas [aut],
  Thorsten Hauffe [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thijs Janzen &lt;thijsjanzen@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-09-21 12:21:01</td>
</tr>
</table>
<hr>
<h2 id='generate.Artificial.Data'>
Generate Artifical data that can be used by the STEPCAM model
</h2><span id='topic+generate.Artificial.Data'></span>

<h3>Description</h3>

<p>This function generates artifical data with a given number of species, traits and communities. The generated data can directly be used in
STEPCAM-ABC inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate.Artificial.Data(n_species, n_traits, n_communities,
occurence_distribution, average_richness, sd_richness, mechanism_random)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate.Artificial.Data_+3A_n_species">n_species</code></td>
<td>
<p>The number of species in the species pool (so across all communities) of the desired dataset. </p>
</td></tr>
<tr><td><code id="generate.Artificial.Data_+3A_n_traits">n_traits</code></td>
<td>
<p>The number of traits in the desired dataset.</p>
</td></tr>
<tr><td><code id="generate.Artificial.Data_+3A_n_communities">n_communities</code></td>
<td>
<p>The number of communities in the desired dataset.</p>
</td></tr>
<tr><td><code id="generate.Artificial.Data_+3A_occurence_distribution">occurence_distribution</code></td>
<td>
<p>species occurrence distribution (analogous to species abundance distribution) in species pool. A lognormal distribution is assumed. The higher the value, the more uneven the occurrence distribution in the species pool</p>
</td></tr>
<tr><td><code id="generate.Artificial.Data_+3A_average_richness">average_richness</code></td>
<td>
<p>average richness in local community as a proportion of richness in species pool</p>
</td></tr>
<tr><td><code id="generate.Artificial.Data_+3A_sd_richness">sd_richness</code></td>
<td>
<p>standard deviation in richness across communities</p>
</td></tr>
<tr><td><code id="generate.Artificial.Data_+3A_mechanism_random">mechanism_random</code></td>
<td>
<p>if TRUE, species are randomly drawn from from species pool. If FALSE, it is assumed that a certain trait combination is optimal in each community and species with traits similar to this optimum more likely end up in the local community. Therefore, random.mechanism = FALSE assumes filtering processes to be most dominant in community assembly</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>traits</code></td>
<td>
<p>A matrix containing the traits for all species, rows are the different species, column correspond to the respective traits.</p>
</td></tr>
<tr><td><code>abundances</code></td>
<td>
<p>A matrix containing the abundances of all species for all plots. Rows correspond to species, columns to plots.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fons van der Plas</p>


<h3>Examples</h3>

<pre><code class='language-R'>Artificial.Data &lt;- generate.Artificial.Data(n_species=40, n_traits=3, n_communities = 5,
                   occurence_distribution = 0.2, average_richness = 0.5, sd_richness = 0.2,
                   mechanism_random = FALSE)
</code></pre>

<hr>
<h2 id='plotSMC'>
Plot the progression of the SMC algorithm.
</h2><span id='topic+plotSMC'></span>

<h3>Description</h3>

<p>This function plots the progression over the several iterations of the ABC-SMC algorithm. It can be used to explore results obtained with the STEPCAM-ABC function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSMC(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSMC_+3A_path">path</code></td>
<td>
<p>Working Directory</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thijs Janzen</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
Artificial.Data &lt;- generate.Artificial.Data(n_species = 40, n_traits = 3,
                        n_communities = 5, occurence_distribution = 0.2,
                        average_richness = 0.5, sd_richness = 0.2,
                        mechanism_random=FALSE)
O &lt;- STEPCAM_ABC(Artificial.Data$abundances, Artificial.Data$traits,
                 numParticles = 10, n_traits = 3, plot_number = 1, stopRate = 0.8)
currentDir &lt;- getwd();
plotSMC(paste(currentDir,"/",sep=""));

## End(Not run)
</code></pre>

<hr>
<h2 id='plotSTEPCAM'>
Plot the output generated by the STEPCAM_ABC function
</h2><span id='topic+plotSTEPCAM'></span>

<h3>Description</h3>

<p>This function plots the posterior distribution inferred by the STEPCAM_ABC function for the three community assembly parameters dispersal assembly, habitat filtering and limiting similarity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSTEPCAM(output)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSTEPCAM_+3A_output">output</code></td>
<td>
<p>The list generated by the function STEPCAM_ABC as output, this list contains the following elements: <br />
- <code>DA</code> a vector containing the posterior distribution for the parameter dispersal assembly <br />
- <code>HF</code> a vector containing the posterior distribution for the parameter habitat filtering <br />
- <code>LS</code> a vector containing the posterior distribution for the parameter limiting similarity <br />
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thijs Janzen</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
Artificial.Data &lt;- generate.Artificial.Data(n_species = 40, n_traits = 3,
                        n_communities = 5, occurence_distribution = 0.2,
                        average_richness = 0.5, sd_richness = 0.2,
                        mechanism_random=FALSE)
O &lt;- STEPCAM_ABC(Artificial.Data$abundances,Artificial.Data$traits,
                 numParticles=10,n_traits=3,plot_number=1,stopRate=0.8);
plotSTEPCAM(O);

## End(Not run)
</code></pre>

<hr>
<h2 id='STEPCAM_ABC'>
ABC-SMC inference of the STEPCAM model
</h2><span id='topic+STEPCAM_ABC'></span>

<h3>Description</h3>

<p>ABC-SMC inference of the relative contribution of stochasticy (or random removal), filtering and limiting similarity (e.g. of shared resources (competition) or predators) through the use of stepwise commmunity assembly and fitting Functional Diversity patterns of simulated communities with those of observed communities. It takes quite a lot of computing time to run this function, so it is recommended to first run it for a very simple (species poor, artificial) dataset (see example).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>STEPCAM_ABC(data_abundances, data_species, numParticles, n_traits,
                        plot_number, stopRate,
                        stop_at_iteration,
                        continue_from_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="STEPCAM_ABC_+3A_data_abundances">data_abundances</code></td>
<td>

<p><code>data_abundances</code> is a matrix containing the abundances of all species over all plots. <br />
<code>rows</code> every row corresponds to a different plot or community <br />
<code>columns</code> every column corresponds to a different species. <br />
For an example of a suitable <code>data_abundances</code> matrix, run the <code>generate.Artificial.Data</code> function
</p>
</td></tr>
<tr><td><code id="STEPCAM_ABC_+3A_data_species">data_species</code></td>
<td>

<p><code>data_species</code> is a matrix containing the species' specific traits. <br />
<code>rows</code> every row corresponds to a different species <br />
<code>columns</code> the first column contains the name of the species, every consecutive column corresponds to a different trait <br />
It is important to realize that ideally, the number of traits is lower than the number of species in the most species poor plot of the 'data_abundances' matrix, as FRic calculation requires at least as many species as their are traits, and will autmatically omit some traits if this assumption is not met. <br />
For an example of a suitable data_species matrix, run the generate.Artificial.Data function
</p>
</td></tr>
<tr><td><code id="STEPCAM_ABC_+3A_numparticles">numParticles</code></td>
<td>
<p>The number of particles to be used in the ABC-SMC analysis.
</p>
</td></tr>
<tr><td><code id="STEPCAM_ABC_+3A_n_traits">n_traits</code></td>
<td>
<p>The number of traits used in the analysis.
</p>
</td></tr>
<tr><td><code id="STEPCAM_ABC_+3A_plot_number">plot_number</code></td>
<td>
<p>Row number of the plot for which we want to infer the contributions of stochasticity, filtering and competition.
</p>
</td></tr>
<tr><td><code id="STEPCAM_ABC_+3A_stoprate">stopRate</code></td>
<td>
<p>The SMC procedure stops as soon as the acceptance rate of newly proposed parameter combinations drops below this level. Beware that low values
for this parameter might lead into long computation times.</p>
</td></tr>
<tr><td><code id="STEPCAM_ABC_+3A_stop_at_iteration">stop_at_iteration</code></td>
<td>
<p>If the user instead wants to perform a fixed number of iterations, this parameter sets the maximum number of iterations (the SMC stops when either the maximum number of iterations is reached, or the acceptance rate drops below the stopRate, whatever happens first)</p>
</td></tr>
<tr><td><code id="STEPCAM_ABC_+3A_continue_from_file">continue_from_file</code></td>
<td>
<p>Should the ABC-SMC algorithm continue from previous output of the STEPCAM_ABC function?</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>DA</code></td>
<td>
<p>Posterior distribution of the relative contribution of dispersal assembly (random removal steps) to community assembly</p>
</td></tr>
<tr><td><code>HF</code></td>
<td>
<p>Posterior distribution of the relative contribution of habitat filtering to community assembly</p>
</td></tr>
<tr><td><code>LS</code></td>
<td>
<p>Posterior distribution of the relative contribution of limiting similarity to community assembly</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thijs Janzen &amp; Fons van der Plas + Torsten Hauffe
</p>


<h3>References</h3>

<p> Fons van der Plas, Thijs Janzen, Alejandro Ordonez, Wimke Fokkema, Josephine Reinders, Rampal S. Etienne, and Han Olff 2015. A new modeling approach estimates the relative importance of different community assembly processes. Ecology 96:1502-1515.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
Artificial.Data &lt;- generate.Artificial.Data(n_species = 40, n_traits = 3,
                        n_communities = 5, occurence_distribution = 0.2,
                        average_richness = 0.5, sd_richness = 0.2,
                        mechanism_random=FALSE)
O &lt;- STEPCAM_ABC(Artificial.Data$abundances, Artificial.Data$traits,
                 numParticles = 10, n_traits = 3, plot_number = 1, stopRate = 0.8)

## End(Not run)
</code></pre>

<hr>
<h2 id='STEPCAM-internal'>Internal STEPCAM functions</h2><span id='topic+ABC_SMC'></span><span id='topic+calcSD'></span><span id='topic+calculateDistance'></span><span id='topic+calculateWeight'></span><span id='topic+fallout.competition'></span><span id='topic+fallout.filtering'></span><span id='topic+fallout.dispersal'></span><span id='topic+generateFrequencies'></span><span id='topic+generateValues'></span><span id='topic+getFromPrevious'></span><span id='topic+getRandomVals'></span><span id='topic+normalizeWeights'></span><span id='topic+perturb'></span><span id='topic+plotElement'></span><span id='topic+scaleSpeciesvalues'></span><span id='topic+STEPCAM'></span><span id='topic+ternaryplot2'></span><span id='topic+ordinationAxes'></span><span id='topic+strippedDbFd'></span><span id='topic+detMnbsp'></span>

<h3>Description</h3>

<p>Internal STEPCAM functions</p>


<h3>Details</h3>

<p>These are not to be called by the user</p>

<hr>
<h2 id='STEPCAM-package'>
ABC-SMC Inference of STEPCAM
</h2><span id='topic+STEPCAM-package'></span>

<h3>Description</h3>

<p>ABC-SMC inference of the relative contribution of dispersal assembly, filtering and limiting similarity through the use of stepwise commmunity assembly.
<br /> <br />
Updates <br />
Version 1.2 <br />
- STEPCAM can now be found on GitHub: https://github.com/thijsjanzen/STEPCAM <br />
- Merged STEPCAM code with the supplementary code of Hauffe et al. 2016 <br />
- Added two vignettes <br />
- Added a large number of code tests <br />
Version 1.1.2 <br />
- updated the prior - now all three processes have a mean prior value of 1/3, and a log-normal kind shape in [0,1]
Version 1.1.1 <br />
- fixed a bug in the ABC-SMC code leading to the error &quot;Error in if (fit &lt; threshold)  : missing value where TRUE/FALSE needed&quot; <br />
Version 1.1 <br />
- calculation of the diversity indices is plit up into two parts: calculating the ordination axes, and the actual calculation of the indices - this allows for a speed up of the code by moving the calculation of the ordination axes outside the SMC algorithm. Many thanks to Torsten Hauffe for this improvement! <br />
- Corrected scaling of the dbFD function - it now always treats abundances as presence/absence data, much thanks to Torsten Hauffe for pointing this out! <br />
- updated references <br />
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> STEPCAM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-09-20</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL 2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The function STEPCAM_ABC performs an ABC-SMC analysis of the STEPCAM model on user provided data,
the functions plotSMC, plotSTEPCAM and TernPlot provide functions to plot the output generated by the ABC-SMC analysis.
</p>


<h3>Author(s)</h3>

<p>Thijs Janzen &amp; Fons van der Plas
</p>
<p>Maintainer: Thijs Janzen &lt;thijsjanzen@gmail.com&gt;
</p>


<h3>References</h3>

<p>Fons van der Plas, Thijs Janzen, Alejandro Ordonez, Wimke Fokkema, Josephine Reinders, Rampal S. Etienne, and Han Olff 2015. A new modeling approach estimates the relative importance of different community assembly processes. Ecology 96:1502-1515.
</p>
<p>Hauffe, Torsten, Christian Albrecht, and Thomas Wilke. Assembly processes of gastropod community change with horizontal and vertical zonation in ancient Lake Ohrid: a metacommunity speciation perspective. Biogeosciences 13.10 (2016): 2901-2911.
</p>

<hr>
<h2 id='TernPlot'>
Create a ternary plot from results of the STEPCAM_ABC function
</h2><span id='topic+TernPlot'></span>

<h3>Description</h3>

<p>This function plots the obtained combinations of dispersal assembly, habitat filtering and limiting similarity of best fitting models in a Ternary plot, similar to Figure 3 in van der Plas et al. 2015
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TernPlot(output)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TernPlot_+3A_output">output</code></td>
<td>
<p>A list with the following elements: <br />
- <code>DA</code>  a vector containing the posterior distribution for the parameter dispersal assembly <br />
- <code>HF</code>  a vector containing the posterior distribution for the parameter habitat filtering <br />
- <code>LS</code>  a vector containing the posterior distribution for the parameter limiting similarity <br />
This list is generated as output by the function STEPCAM_ABC</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fons van der Plas. Adapted from the ternaryplot function from the 'vcd' package</p>


<h3>References</h3>

<p>Fons van der Plas, Thijs Janzen, Alejandro Ordonez, Wimke Fokkema, Josephine Reinders, Rampal S. Etienne, and Han Olff 2015. A new modeling approach estimates the relative importance of different community assembly processes. Ecology 96:1502-1515.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
Artificial.Data &lt;- generate.Artificial.Data(n_species = 40, n_traits = 3,
                        n_communities = 5, occurence_distribution = 0.2,
                        average_richness = 0.5, sd_richness = 0.2,
                        mechanism_random=FALSE)
O &lt;- STEPCAM_ABC(Artificial.Data$abundances, Artificial.Data$traits,
                 numParticles = 10, n_traits = 3, plot_number = 1, stopRate = 0.8);
TernPlot(O);

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
