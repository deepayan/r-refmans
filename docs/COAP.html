<!DOCTYPE html><html><head><title>Help for package COAP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {COAP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gendata_simu'><p>Generate simulated data</p></a></li>
<li><a href='#RR_COAP'><p>Fit the COAP model</p></a></li>
<li><a href='#selectParams'><p>Select the parameters in COAP models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>High-Dimensional Covariate-Augmented Overdispersed Poisson
Factor Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-05-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Wei Liu [aut, cre],
  Qingzhi Zhong [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wei Liu &lt;liuweideng@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A covariate-augmented overdispersed Poisson factor model is proposed to jointly perform a high-dimensional Poisson factor analysis and estimate a large coefficient matrix for overdispersed count data.
    More details can be referred to Liu et al. (2024) &lt;<a href="https://doi.org/10.1093%2Fbiomtc%2Fujae031">doi:10.1093/biomtc/ujae031</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>irlba, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, stats, Rcpp (&ge; 1.0.10)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/feiyoung/COAP">https://github.com/feiyoung/COAP</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/feiyoung/COAP/issues">https://github.com/feiyoung/COAP/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-02 03:21:19 UTC; Liuxianju</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-02 03:42:48 UTC</td>
</tr>
</table>
<hr>
<h2 id='gendata_simu'>Generate simulated data</h2><span id='topic+gendata_simu'></span>

<h3>Description</h3>

<p>Generate simulated data from covariate-augmented Poisson factor models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gendata_simu(
  seed = 1,
  n = 300,
  p = 50,
  d = 20,
  q = 6,
  rank0 = 3,
  rho = c(1.5, 1),
  sigma2_eps = 0.1,
  seed.beta = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gendata_simu_+3A_seed">seed</code></td>
<td>
<p>a postive integer, the random seed for reproducibility of data generation process.</p>
</td></tr>
<tr><td><code id="gendata_simu_+3A_n">n</code></td>
<td>
<p>a postive integer, specify the sample size.</p>
</td></tr>
<tr><td><code id="gendata_simu_+3A_p">p</code></td>
<td>
<p>a postive integer, specify the dimension of count variables.</p>
</td></tr>
<tr><td><code id="gendata_simu_+3A_d">d</code></td>
<td>
<p>a postive integer,  specify the dimension of covariate matrix.</p>
</td></tr>
<tr><td><code id="gendata_simu_+3A_q">q</code></td>
<td>
<p>a postive integer,  specify the number of factors.</p>
</td></tr>
<tr><td><code id="gendata_simu_+3A_rank0">rank0</code></td>
<td>
<p>a postive integer, specify the rank of the coefficient matrix.</p>
</td></tr>
<tr><td><code id="gendata_simu_+3A_rho">rho</code></td>
<td>
<p>a numeric vector with length 2 and positive elements, specify the signal strength of regression coefficient and loading matrix, respectively.</p>
</td></tr>
<tr><td><code id="gendata_simu_+3A_sigma2_eps">sigma2_eps</code></td>
<td>
<p>a positive real, the variance of overdispersion error.</p>
</td></tr>
<tr><td><code id="gendata_simu_+3A_seed.beta">seed.beta</code></td>
<td>
<p>a postive integer, the random seed for reproducibility of data generation process by fixing the regression coefficient matrix beta.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>None
</p>


<h3>Value</h3>

<p>return a list including the following components: (1) X, the high-dimensional count matrix; (2) Z, the high-dimensional covriate matrix; (3) bbeta0, the low-rank large coefficient matrix; (4) B0, the loading matrix; (5) H0, the factor matrix; (6) rank: the true rank of bbeta0; (7) q: the true number of factors.
</p>


<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RR_COAP">RR_COAP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 300; p &lt;- 100
d &lt;- 20; q &lt;- 6; r &lt;- 3
datlist &lt;- gendata_simu(n=n, p=p, d=20, q=q, rank0=r)
str(datlist)
</code></pre>

<hr>
<h2 id='RR_COAP'>Fit the COAP model</h2><span id='topic+RR_COAP'></span>

<h3>Description</h3>

<p>Fit the covariate-augmented overdispersed Poisson factor model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RR_COAP(
  X_count,
  multiFac = rep(1, nrow(X_count)),
  Z = matrix(1, nrow(X_count), 1),
  rank_use = 5,
  q = 15,
  epsELBO = 1e-05,
  maxIter = 30,
  verbose = TRUE,
  joint_opt_beta = FALSE,
  fast_svd = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RR_COAP_+3A_x_count">X_count</code></td>
<td>
<p>a count matrix, the observed count matrix.</p>
</td></tr>
<tr><td><code id="RR_COAP_+3A_multifac">multiFac</code></td>
<td>
<p>an optional vector, the normalization factor for each unit; default as full-one vector.</p>
</td></tr>
<tr><td><code id="RR_COAP_+3A_z">Z</code></td>
<td>
<p>an optional matrix, the covariate matrix; default as a full-one column vector if there is no additional covariates.</p>
</td></tr>
<tr><td><code id="RR_COAP_+3A_rank_use">rank_use</code></td>
<td>
<p>an optional integer, specify the rank of the regression coefficient matrix; default as 5.</p>
</td></tr>
<tr><td><code id="RR_COAP_+3A_q">q</code></td>
<td>
<p>an optional string, specify the number of factors; default as 15.</p>
</td></tr>
<tr><td><code id="RR_COAP_+3A_epselbo">epsELBO</code></td>
<td>
<p>an optional positive vlaue, tolerance of relative variation rate of the envidence lower bound value, defualt as '1e-5'.</p>
</td></tr>
<tr><td><code id="RR_COAP_+3A_maxiter">maxIter</code></td>
<td>
<p>the maximum iteration of the VEM algorithm. The default is 30.</p>
</td></tr>
<tr><td><code id="RR_COAP_+3A_verbose">verbose</code></td>
<td>
<p>a logical value, whether output the information in iteration.</p>
</td></tr>
<tr><td><code id="RR_COAP_+3A_joint_opt_beta">joint_opt_beta</code></td>
<td>
<p>a logical value, whether use the joint optimization method to update bbeta. The default is <code>FALSE</code>, which means using the separate optimization method.</p>
</td></tr>
<tr><td><code id="RR_COAP_+3A_fast_svd">fast_svd</code></td>
<td>
<p>a logical value, whether use the fast SVD algorithm in the update of bbeta; default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>None
</p>


<h3>Value</h3>

<p>return a list including the following components: (1) H, the predicted factor matrix; (2) B, the estimated loading matrix; (3) bbeta, the estimated low-rank large coefficient matrix; (4) invLambda, the inverse of the estimated variances of error; (5) H0, the factor matrix; (6) ELBO: the ELBO value when algorithm stops; (7) ELBO_seq: the sequence of ELBO values.
</p>


<h3>References</h3>

<p>Liu, W. and Q. Zhong (2024). High-dimensional covariate-augmented overdispersed poisson factor model. arXiv preprint arXiv:2402.15071.
</p>


<h3>See Also</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 300; p &lt;- 100
d &lt;- 20; q &lt;- 6; r &lt;- 3
datlist &lt;- gendata_simu(n=n, p=p, d=20, q=q, rank0=r)
str(datlist)
fitlist &lt;- RR_COAP(X_count=datlist$X, Z = datlist$Z, q=6, rank_use=3)
str(fitlist)
</code></pre>

<hr>
<h2 id='selectParams'>Select the parameters in COAP models</h2><span id='topic+selectParams'></span>

<h3>Description</h3>

<p>Select the number of factors and the rank of coefficient matrix in the covariate-augmented overdispersed Poisson factor model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectParams(
  X_count,
  Z,
  multiFac = rep(1, nrow(X_count)),
  q_max = 15,
  r_max = 24,
  threshold = c(0.1, 0.01),
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selectParams_+3A_x_count">X_count</code></td>
<td>
<p>a count matrix, the observed count matrix.</p>
</td></tr>
<tr><td><code id="selectParams_+3A_z">Z</code></td>
<td>
<p>an optional matrix, the covariate matrix; default as a full-one column vector if there is no additional covariates.</p>
</td></tr>
<tr><td><code id="selectParams_+3A_multifac">multiFac</code></td>
<td>
<p>an optional vector, the normalization factor for each unit; default as full-one vector.</p>
</td></tr>
<tr><td><code id="selectParams_+3A_q_max">q_max</code></td>
<td>
<p>an optional string, specify the upper bound for the number of factors; default as 15.</p>
</td></tr>
<tr><td><code id="selectParams_+3A_r_max">r_max</code></td>
<td>
<p>an optional integer, specify the upper bound for the rank of the regression coefficient matrix; default as 24.</p>
</td></tr>
<tr><td><code id="selectParams_+3A_threshold">threshold</code></td>
<td>
<p>an optional 2-dimensional positive vector, specify the the thresholds that filters the singular values of beta and B, respectively.</p>
</td></tr>
<tr><td><code id="selectParams_+3A_verbose">verbose</code></td>
<td>
<p>a logical value, whether output the information in iteration.</p>
</td></tr>
<tr><td><code id="selectParams_+3A_...">...</code></td>
<td>
<p>other arguments passed to the function <code><a href="#topic+RR_COAP">RR_COAP</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The threshold is to filter the singular values with  low signal, to assist the identification of underlying model structure.
</p>


<h3>Value</h3>

<p>return a named vector with names 'hr' and 'hq', the estimated rank and number of factors.
</p>


<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RR_COAP">RR_COAP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 300; p &lt;- 100
d &lt;- 20; q &lt;- 6; r &lt;- 3
datlist &lt;- gendata_simu(seed=30, n=n, p=p, d=20, q=q, rank0=r)
str(datlist)
set.seed(1)
para_vec &lt;- selectParams(X_count=datlist$X, Z = datlist$Z)
print(para_vec)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
