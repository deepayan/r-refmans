<!DOCTYPE html><html><head><title>Help for package TeachingSampling</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TeachingSampling}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BigCity'><p>Full Person-level Population Database</p></a></li>
<li><a href='#BigLucy'><p>Full Business Population Database</p></a></li>
<li><a href='#Deltakl'><p>Variance-Covariance Matrix of the Sample Membership Indicators for Fixed Size Without Replacement Sampling Designs</p></a></li>
<li><a href='#Domains'><p>Domains Indicator Matrix</p></a></li>
<li><a href='#E.1SI'><p>Estimation of the Population Total under Single Stage Simple Random Sampling Without Replacement</p></a></li>
<li><a href='#E.2SI'><p>Estimation of the Population Total under Two Stage Simple Random Sampling Without Replacement</p></a></li>
<li><a href='#E.BE'><p>Estimation of the Population Total under Bernoulli Sampling Without Replacement</p></a></li>
<li><a href='#E.Beta'><p>Estimation of the population regression coefficients under SI designs</p></a></li>
<li><a href='#E.piPS'><p>Estimation of the Population Total under Probability Proportional to Size Sampling Without Replacement</p></a></li>
<li><a href='#E.PO'><p>Estimation of the Population Total under Poisson Sampling Without Replacement</p></a></li>
<li><a href='#E.PPS'><p>Estimation of the Population Total under Probability Proportional to Size Sampling With Replacement</p></a></li>
<li><a href='#E.Quantile'><p>Estimation of a Population quantile</p></a></li>
<li><a href='#E.SI'><p>Estimation of the Population Total under Simple Random Sampling Without Replacement</p></a></li>
<li><a href='#E.STpiPS'><p>Estimation of the Population Total under Stratified Probability Proportional to Size Sampling Without Replacement</p></a></li>
<li><a href='#E.STPPS'><p>Estimation of the Population Total under Stratified Probability Proportional to Size Sampling With Replacement</p></a></li>
<li><a href='#E.STSI'><p>Estimation of the Population Total under Stratified Simple Random Sampling Without Replacement</p></a></li>
<li><a href='#E.SY'><p>Estimation of the Population Total under Systematic Sampling Without Replacement</p></a></li>
<li><a href='#E.Trim'><p>Weight Trimming and Redistribution</p></a></li>
<li><a href='#E.UC'><p>Estimation of the Population Total and its variance using the Ultimate Cluster technique</p></a></li>
<li><a href='#E.WR'><p>Estimation of the Population Total under Simple Random Sampling With Replacement</p></a></li>
<li><a href='#GREG.SI'><p>The Generalized Regression Estimator under SI sampling design</p></a></li>
<li><a href='#HH'><p>The Hansen-Hurwitz Estimator</p></a></li>
<li><a href='#HT'><p>The Horvitz-Thompson Estimator</p></a></li>
<li><a href='#Ik'><p>Sample Membership Indicator</p></a></li>
<li><a href='#IkRS'><p>Sample Membership Indicator for Random Size sampling designs</p></a></li>
<li><a href='#IkWR'><p>Sample Membership Indicator for with Replacements sampling designs</p></a></li>
<li><a href='#IPFP'><p>Iterative Proportional Fitting Procedure</p></a></li>
<li><a href='#Lucy'><p>Some Business Population Database</p></a></li>
<li><a href='#nk'><p>Sample Selection Indicator for With Replacement Sampling Designs</p></a></li>
<li><a href='#OrderWR'><p>Pseudo-Support for Fixed Size With Replacement Sampling Designs</p></a></li>
<li><a href='#p.WR'><p>Generalization of every with replacement sampling design</p></a></li>
<li><a href='#Pik'><p>Inclusion Probabilities for Fixed Size Without Replacement Sampling Designs</p></a></li>
<li><a href='#PikHol'><p>Optimal Inclusion Probabilities Under Multi-purpose Sampling</p></a></li>
<li><a href='#Pikl'><p>Second Order Inclusion Probabilities for Fixed Size Without Replacement Sampling Designs</p></a></li>
<li><a href='#PikPPS'><p>Inclusion Probabilities in Proportional to Size Sampling Designs</p></a></li>
<li><a href='#PikSTPPS'><p>Inclusion Probabilities in Stratified Proportional to Size Sampling Designs</p></a></li>
<li><a href='#S.BE'><p>Bernoulli Sampling Without Replacement</p></a></li>
<li><a href='#S.piPS'><p>Probability Proportional to Size Sampling Without Replacement</p></a></li>
<li><a href='#S.PO'><p>Poisson Sampling</p></a></li>
<li><a href='#S.PPS'><p>Probability Proportional to Size Sampling With Replacement</p></a></li>
<li><a href='#S.SI'><p>Simple Random Sampling Without Replacement</p></a></li>
<li><a href='#S.STpiPS'><p>Stratified Sampling Applying Without Replacement piPS Design in all Strata</p></a></li>
<li><a href='#S.STPPS'><p>Stratified Sampling Applying PPS Design in all Strata</p></a></li>
<li><a href='#S.STSI'><p>Stratified sampling applying SI design in all strata</p></a></li>
<li><a href='#S.SY'><p>Systematic Sampling</p></a></li>
<li><a href='#S.WR'><p>Simple Random Sampling With Replacement</p></a></li>
<li><a href='#Support'><p>Sampling Support for Fixed Size Without Replacement Sampling Designs</p></a></li>
<li><a href='#SupportRS'><p>Sampling Support for Random Size Without Replacement Sampling Designs</p></a></li>
<li><a href='#SupportWR'><p>Sampling Support for Fixed Size With Replacement Sampling Designs</p></a></li>
<li><a href='#T.SIC'><p>Computation of Population Totals for Clusters</p></a></li>
<li><a href='#VarHT'><p>Variance of the Horvitz-Thompson Estimator</p></a></li>
<li><a href='#VarSYGHT'><p>Two different varaince estimators for the Horvitz-Thompson estimator</p></a></li>
<li><a href='#Wk'><p>The Calibration Weights</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Selection of Samples and Parameter Estimation in Finite
Population</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Version:</td>
<td>4.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-04-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Hugo Andres Gutierrez Rojas &lt;hagutierrezro@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hugo Andres Gutierrez Rojas &lt;hagutierrezro@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5), dplyr, magrittr</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows the user to draw probabilistic samples and make inferences from a finite population based on several sampling designs.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-21 19:54:19 UTC; psirusteam</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-21 21:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='BigCity'>Full Person-level Population Database</h2><span id='topic+BigCity'></span>

<h3>Description</h3>

<p>This data set corresponds to some socioeconomic variables from 150266 people of a city in a particular year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BigCity)</code></pre>


<h3>Format</h3>


<dl>
<dt>HHID</dt><dd><p>The identifier of the household. It corresponds to an alphanumeric sequence (four letters and five digits).</p>
</dd>
<dt>PersonID</dt><dd><p>The identifier of the person within the household. NOTE it is not a unique identifier of a person for the whole population. It corresponds to an alphanumeric sequence (five letters and two digits).</p>
</dd>
<dt>Stratum</dt><dd><p>Households are located in geographic strata. There are 119 strata across the city.</p>
</dd>
<dt>PSU</dt><dd><p>Households are clustered in cartographic segments defined as primary sampling units (PSU). There are 1664 PSU and they are nested within strata.</p>
</dd>
<dt>Zone</dt><dd><p>Segments clustered within strata can be located within urban or rural areas along the city.</p>
</dd>
<dt>Sex</dt><dd><p>Sex of the person.</p>
</dd>
<dt>Income</dt><dd><p>Per capita monthly income.</p>
</dd>
<dt>Expenditure</dt><dd><p>Per capita monthly expenditure.</p>
</dd>
<dt>Employment</dt><dd><p>A person's employment status.</p>
</dd>
<dt>Poverty</dt><dd><p>This variable indicates whether the person is poor or not. It depends on income.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Lucy">Lucy</a>, <a href="#topic+BigLucy">BigLucy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BigCity)
attach(BigCity)

estima &lt;- data.frame(Income, Expenditure)
# The population totals
colSums(estima)
# Some parameters of interest
table(Poverty, Zone)
xtabs(Income ~ Poverty + Zone)
# Correlations among characteristics of interest
cor(estima)
# Some useful histograms
hist(Income)
hist(Expenditure)
# Some useful plots
boxplot(Income ~ Poverty)
barplot(table(Employment))
pie(table(MaritalST))
</code></pre>

<hr>
<h2 id='BigLucy'>Full Business Population Database</h2><span id='topic+BigLucy'></span>

<h3>Description</h3>

<p>This data set corresponds to some financial variables of 85396 industrial companies of a city in a particular fiscal year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BigLucy)</code></pre>


<h3>Format</h3>


<dl>
<dt>ID</dt><dd><p>The identifier of the company. It correspond to an alphanumeric sequence (two letters and three digits)</p>
</dd>
<dt>Ubication</dt><dd><p>The address of the principal office of the company in the city</p>
</dd>
<dt>Level</dt><dd><p>The industrial companies are discrimitnated according to the Taxes declared. 
There are small, medium and big companies</p>
</dd>
<dt>Zone</dt><dd><p>The country is divided by counties. A company belongs to a particular zone according to its cartographic location.</p>
</dd>
<dt>Income</dt><dd><p>The total ammount of a company's earnings (or profit) in the previuos fiscal year. It is calculated by taking 
revenues and adjusting for the cost of doing business</p>
</dd>
<dt>Employees</dt><dd><p>The total number of persons working for the company in the previuos fiscal year</p>
</dd>
<dt>Taxes</dt><dd><p>The total ammount of a company's income Tax</p>
</dd>
<dt>SPAM</dt><dd><p>Indicates if the company uses the Internet and WEBmail options in order to make self-propaganda.</p>
</dd>
<dt>ISO</dt><dd><p>Indicates if the company is certified by the International Organization for Standardization.</p>
</dd>
<dt>Years</dt><dd><p>The age of the company.</p>
</dd>
<dt>Segments</dt><dd><p>Cartographic segments by county. A segment comprises in average 10 companies located close to each other.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Lucy">Lucy</a>, <a href="#topic+BigCity">BigCity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BigLucy)
attach(BigLucy)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
# The population totals
colSums(estima)
# Some parameters of interest
table(SPAM,Level)
xtabs(Income ~ Level+SPAM)
# Correlations among characteristics of interest
cor(estima)
# Some useful histograms
hist(Income)
hist(Taxes)
hist(Employees)
# Some useful plots
boxplot(Income ~ Level)
barplot(table(Level))
pie(table(SPAM))
</code></pre>

<hr>
<h2 id='Deltakl'>Variance-Covariance Matrix of the Sample Membership Indicators for Fixed Size Without Replacement Sampling Designs</h2><span id='topic+Deltakl'></span>

<h3>Description</h3>

<p>Computes the Variance-Covariance matrix of the sample membership indicators in the population given a
fixed sample size design</p>


<h3>Usage</h3>

<pre><code class='language-R'>Deltakl(N, n, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Deltakl_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="Deltakl_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="Deltakl_+3A_p">p</code></td>
<td>
<p>A vector containing the selection probabilities of a fixed size without replacement sampling design. The sum of the values of this vector must be one</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">kl</code>th unit of the Variance-Covariance matrix of the sample membership indicators is defined as 
<code class="reqn">\Delta_{kl}=\pi_{kl}-\pi_k\pi_l</code>
</p>


<h3>Value</h3>

<p>The function returns a symmetric matrix of size <code class="reqn">N \times N</code> containing the variances-covariances among the sample membership indicators for each pair of units in the finite population.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VarHT">VarHT</a>, <a href="#topic+Pikl">Pikl</a>, <a href="#topic+Pik">Pik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
# The sample size is n=2
n &lt;- 2
# p is the probability of selection of every sample. 
p &lt;- c(0.13, 0.2, 0.15, 0.1, 0.15, 0.04, 0.02, 0.06, 0.07, 0.08)
# Note that the sum of the elements of this vector is one
sum(p)
# Computation of the Variance-Covariance matrix of the sample membership indicators
Deltakl(N, n, p)
</code></pre>

<hr>
<h2 id='Domains'>Domains Indicator Matrix</h2><span id='topic+Domains'></span>

<h3>Description</h3>

<p>Creates a matrix of domain indicator variables for every single unit in the selected sample or in the entire population</p>


<h3>Usage</h3>

<pre><code class='language-R'>Domains(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Domains_+3A_y">y</code></td>
<td>
<p>Vector of the domain of interest containing the membership of each unit to a specified category of the domain</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each value of y represents the domain which a specified unit belongs</p>


<h3>Value</h3>

<p>The function returns a <code class="reqn">n\times p</code> matrix, where <code class="reqn">n</code> is the number of units in the selected 
sample and <code class="reqn">p</code> is the number of categories of the domain of interest. The values of this matrix are zero,  if the unit does not 
belongs to a specified category and one, otherwise.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.SI">E.SI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# This domain contains only two categories: "yes" and "no"
x &lt;- as.factor(c("yes","yes","yes","no","no","no","no","yes","yes"))
Domains(x)

############
## Example 2
############
# Uses the Lucy data to draw a random sample of units according 
# to a SI design
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
sam &lt;- sample(N,n)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variable SPAM is a domain of interest
Doma &lt;- Domains(SPAM)
Doma
# HT estimation of the absolute domain size for every category in the domain
# of interest
E.SI(N,n,Doma)

############
## Example 3
############
# Following with Example 2... 
# The variables of interest are: Income, Employees and Taxes
# This function allows to estimate the population total of this variables for every 
# category in the domain of interest SPAM 
estima &lt;- data.frame(Income, Employees, Taxes)
SPAM.no &lt;- estima*Doma[,1]
SPAM.yes &lt;- estima*Doma[,2]
E.SI(N,n,SPAM.no)
E.SI(N,n,SPAM.yes)
</code></pre>

<hr>
<h2 id='E.1SI'>Estimation of the Population Total under Single Stage Simple Random Sampling Without Replacement</h2><span id='topic+E.1SI'></span>

<h3>Description</h3>

<p>This function computes the Horvitz-Thompson estimator of the population total according to a single stage sampling design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.1SI(NI, nI, y, PSU)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.1SI_+3A_ni">NI</code></td>
<td>
<p>Population size of Primary Sampling Units.</p>
</td></tr>
<tr><td><code id="E.1SI_+3A_ni">nI</code></td>
<td>
<p>Sample size of Primary Sampling Units.</p>
</td></tr>
<tr><td><code id="E.1SI_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containig the recollected 
information of the variables of interest for every unit in the 
selected sample.</p>
</td></tr>
<tr><td><code id="E.1SI_+3A_psu">PSU</code></td>
<td>
<p>Vector identifying the membership to the strata of 
each unit in the population.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a data matrix whose columns correspond to 
the estimated parameters of the variables of interest.
</p>


<h3>Value</h3>

<p>This function returns the estimation of the population total of 
every single variable of interest, its estimated standard error 
and its estimated coefficient of variation.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hugogutierrez at gmail.com&gt;
</p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.2SI">E.2SI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data('BigCity')
Households &lt;- BigCity %&gt;% group_by(HHID) %&gt;%
summarise(Stratum = unique(Stratum),
            PSU = unique(PSU),
            Persons = n(),
            Income = sum(Income),
            Expenditure = sum(Expenditure))
            
attach(Households)
UI &lt;- levels(as.factor(Households$PSU))
NI &lt;- length(UI)
nI &lt;- 100 

samI &lt;- S.SI(NI, nI)
sampleI &lt;- UI[samI]

CityI &lt;- Households[which(Households$PSU %in% sampleI), ]
attach(CityI)
area &lt;- as.factor(CityI$PSU)
estima &lt;- data.frame(CityI$Persons, CityI$Income, CityI$Expenditure)

E.1SI(NI, nI, estima, area)
</code></pre>

<hr>
<h2 id='E.2SI'>Estimation of the Population Total under Two Stage Simple Random Sampling Without Replacement</h2><span id='topic+E.2SI'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson estimator of the population total according to a 2SI sampling design</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.2SI(NI, nI, Ni, ni, y, PSU)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.2SI_+3A_ni">NI</code></td>
<td>
<p>Population size of Primary Sampling Units</p>
</td></tr>
<tr><td><code id="E.2SI_+3A_ni">nI</code></td>
<td>
<p>Sample size of Primary Sampling Units</p>
</td></tr>
<tr><td><code id="E.2SI_+3A_ni">Ni</code></td>
<td>
<p>Vector of population sizes of Secundary Sampling Units selected in the first draw</p>
</td></tr>      
<tr><td><code id="E.2SI_+3A_ni">ni</code></td>
<td>
<p>Vector of sample sizes of Secundary Sampling Units</p>
</td></tr>
<tr><td><code id="E.2SI_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containig the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
<tr><td><code id="E.2SI_+3A_psu">PSU</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated standard error and its estimated coefficient of variation</p>


<h3>Value</h3>

<p>The function returns a data matrix whose columns correspond to the estimated parameters of the variables of interest</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Dise?o de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.SI">S.SI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Uses Lucy data to draw a twostage simple random sample 
# accordind to a 2SI design. Zone is the clustering variable
data(Lucy)
attach(Lucy)
summary(Zone)
# The population of clusters or Primary Sampling Units
UI&lt;-c("A","B","C","D","E")
NI &lt;- length(UI)
# The sample size is nI=3
nI &lt;- 3
# Selects the sample of PSUs
samI&lt;-S.SI(NI,nI)
dataI&lt;-UI[samI]
dataI   
# The sampling frame of Secondary Sampling Unit is saved in Lucy1 ... Lucy3
Lucy1&lt;-Lucy[which(Zone==dataI[1]),]
Lucy2&lt;-Lucy[which(Zone==dataI[2]),]
Lucy3&lt;-Lucy[which(Zone==dataI[3]),]
# The size of every single PSU
N1&lt;-dim(Lucy1)[1]
N2&lt;-dim(Lucy2)[1]
N3&lt;-dim(Lucy3)[1]
Ni&lt;-c(N1,N2,N3)
# The sample size in every PSI is 135 Secondary Sampling Units
n1&lt;-135
n2&lt;-135
n3&lt;-135
ni&lt;-c(n1,n2,n3)
# Selects a sample of Secondary Sampling Units inside the PSUs
sam1&lt;-S.SI(N1,n1)
sam2&lt;-S.SI(N2,n2)
sam3&lt;-S.SI(N3,n3)
# The information about each Secondary Sampling Unit in the PSUs
# is saved in data1 ... data3
data1&lt;-Lucy1[sam1,]
data2&lt;-Lucy2[sam2,]
data3&lt;-Lucy3[sam3,]
# The information about each unit in the final selected sample is saved in data
data&lt;-rbind(data1, data2, data3)
attach(data)
# The clustering variable is Zone
Cluster &lt;- as.factor(as.integer(Zone))
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
# Estimation of the Population total
E.2SI(NI,nI,Ni,ni,estima,Cluster)

########################################################
## Example 2 Total Census to the entire population
########################################################
# Uses Lucy data to draw a cluster random sample
# accordind to a SI design ...
# Zone is the clustering variable
data(Lucy)
attach(Lucy)
summary(Zone)
# The population of clusters
UI&lt;-c("A","B","C","D","E")
NI &lt;- length(UI)
# The sample size equals to the population size of PSU
nI &lt;- NI
# Selects every single PSU
samI&lt;-S.SI(NI,nI)
dataI&lt;-UI[samI]
dataI   
# The sampling frame of Secondary Sampling Unit is saved in Lucy1 ... Lucy5
Lucy1&lt;-Lucy[which(Zone==dataI[1]),]
Lucy2&lt;-Lucy[which(Zone==dataI[2]),]
Lucy3&lt;-Lucy[which(Zone==dataI[3]),]
Lucy4&lt;-Lucy[which(Zone==dataI[4]),]
Lucy5&lt;-Lucy[which(Zone==dataI[5]),]
# The size of every single PSU
N1&lt;-dim(Lucy1)[1]
N2&lt;-dim(Lucy2)[1]
N3&lt;-dim(Lucy3)[1]
N4&lt;-dim(Lucy4)[1]
N5&lt;-dim(Lucy5)[1]
Ni&lt;-c(N1,N2,N3,N4,N5)
# The sample size of Secondary Sampling Units equals to the size of each PSU
n1&lt;-N1
n2&lt;-N2
n3&lt;-N3
n4&lt;-N4
n5&lt;-N5
ni&lt;-c(n1,n2,n3,n4,n5)
# Selects every single Secondary Sampling Unit inside the PSU
sam1&lt;-S.SI(N1,n1)
sam2&lt;-S.SI(N2,n2)
sam3&lt;-S.SI(N3,n3)
sam4&lt;-S.SI(N4,n4)
sam5&lt;-S.SI(N5,n5)
# The information about each unit in the cluster is saved in Lucy1 ... Lucy5
data1&lt;-Lucy1[sam1,]
data2&lt;-Lucy2[sam2,]
data3&lt;-Lucy3[sam3,]
data4&lt;-Lucy4[sam4,]
data5&lt;-Lucy5[sam5,]
# The information about each Secondary Sampling Unit
# in the sample (census) is saved in data
data&lt;-rbind(data1, data2, data3, data4, data5)
attach(data)
# The clustering variable is Zone
Cluster &lt;- as.factor(as.integer(Zone))
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
# Estimation of the Population total
E.2SI(NI,nI,Ni,ni,estima,Cluster)
# Sampling error is null
</code></pre>

<hr>
<h2 id='E.BE'>Estimation of the Population Total under Bernoulli Sampling Without Replacement</h2><span id='topic+E.BE'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson estimator of the population total according to a BE sampling design</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.BE(y, prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.BE_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every unit in the selected sample</p>
</td></tr>
<tr><td><code id="E.BE_+3A_prob">prob</code></td>
<td>
<p>Inclusion probability for each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated standard error and its estimated coefficient of variation under an BE sampling design</p>


<h3>Value</h3>

<p>The function returns a data matrix whose columns correspond to the estimated parameters of the variables of interest</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.BE">S.BE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uses the Lucy data to draw a Bernoulli sample
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
n=400
prob=n/N
sam &lt;- S.BE(N,prob)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.BE(estima,prob)
</code></pre>

<hr>
<h2 id='E.Beta'>Estimation of the population regression coefficients under SI designs</h2><span id='topic+E.Beta'></span>

<h3>Description</h3>

<p>Computes the estimation of regression coefficients using the principles of the Horvitz-Thompson estimator</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.Beta(N, n, y, x, ck=1, b0=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.Beta_+3A_n">N</code></td>
<td>
<p>The population size</p>
</td></tr>
<tr><td><code id="E.Beta_+3A_n">n</code></td>
<td>
<p>The sample size</p>
</td></tr>
<tr><td><code id="E.Beta_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every unit in the selected sample</p>
</td></tr>
<tr><td><code id="E.Beta_+3A_x">x</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected auxiliary information for every unit in the selected sample</p>
</td></tr>
<tr><td><code id="E.Beta_+3A_ck">ck</code></td>
<td>
<p>By default equals to one. It is a vector of weights induced by the structure of variance of the supposed model</p>
</td></tr>
<tr><td><code id="E.Beta_+3A_b0">b0</code></td>
<td>
<p>By default FALSE. The intercept of the regression model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population regression coefficients in a supposed linear model, its estimated variance and its estimated coefficient of variation under an SI sampling design</p>


<h3>Value</h3>

<p>The function returns a vector whose entries correspond to the estimated parameters of the regression coefficients</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GREG.SI">GREG.SI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################################################################
## Example 1: Linear models involving continuous auxiliary information
######################################################################

# Draws a simple random sample without replacement
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
sam &lt;- S.SI(N, n)
# The information about the units in the sample 
# is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)

########### common mean model 

estima&lt;-data.frame(Income, Employees, Taxes)
x &lt;- rep(1,n)
E.Beta(N, n, estima,x,ck=1,b0=FALSE)


########### common ratio model 

estima&lt;-data.frame(Income)
x &lt;- data.frame(Employees)
E.Beta(N, n, estima,x,ck=x,b0=FALSE)

########### Simple regression model without intercept

estima&lt;-data.frame(Income, Employees)
x &lt;- data.frame(Taxes)
E.Beta(N, n, estima,x,ck=1,b0=FALSE)

########### Multiple regression model without intercept

estima&lt;-data.frame(Income)
x &lt;- data.frame(Employees, Taxes)
E.Beta(N, n, estima,x,ck=1,b0=FALSE)

########### Simple regression model with intercept

estima&lt;-data.frame(Income, Employees)
x &lt;- data.frame(Taxes)
E.Beta(N, n, estima,x,ck=1,b0=TRUE)

########### Multiple regression model with intercept

estima&lt;-data.frame(Income)
x &lt;- data.frame(Employees, Taxes)
E.Beta(N, n, estima,x,ck=1,b0=TRUE)

###############################################################
## Example 2: Linear models with discrete auxiliary information
###############################################################

# Draws a simple random sample without replacement
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
sam &lt;- S.SI(N,n)
# The information about the sample units is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The auxiliary information
Doma&lt;-Domains(Level)

########### Poststratified common mean model

estima&lt;-data.frame(Income, Employees, Taxes)
E.Beta(N, n, estima,Doma,ck=1,b0=FALSE)

########### Poststratified common ratio model

estima&lt;-data.frame(Income, Employees)
x&lt;-Doma*Taxes
E.Beta(N, n, estima,x,ck=1,b0=FALSE)
</code></pre>

<hr>
<h2 id='E.piPS'>Estimation of the Population Total under Probability Proportional to Size Sampling Without Replacement</h2><span id='topic+E.piPS'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson estimator of the population total according to a <code class="reqn">\pi</code>PS sampling design</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.piPS(y, Pik)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.piPS_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
<tr><td><code id="E.piPS_+3A_pik">Pik</code></td>
<td>
<p>Vector of inclusion probabilities for each unit in the selected sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated variance and its estimated coefficient of variation under a <code class="reqn">\pi</code>PPS sampling design. This function uses the results of approximate expressions for
the estimated variance of the Horvitz-Thompson estimator</p>


<h3>Value</h3>

<p>The function returns a data matrix whose columns correspond to the estimated parameters of the variables of interest</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Matei, A. and Tille, Y. (2005), Evaluation of Variance Approximations and Estimators in Maximun
Entropy Sampling with Unequal Probability and Fixed Sample Design. <em>Journal of Official Statistics</em>. Vol 21, 4, 543-570.<br />
Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.piPS">S.piPS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uses the Lucy data to draw a sample according to a piPS
# without replacement design
data(Lucy)
attach(Lucy)
# The inclusion probability of each unit is proportional to the variable Income
# The selected sample of size n=400
n &lt;- 400
res &lt;- S.piPS(n, Income)
sam &lt;- res[,1]
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# Pik.s is the inclusion probability of every single unit in the selected sample
Pik.s &lt;- res[,2]
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.piPS(estima,Pik.s)
# Same results than HT function
HT(estima, Pik.s)
</code></pre>

<hr>
<h2 id='E.PO'>Estimation of the Population Total under Poisson Sampling Without Replacement</h2><span id='topic+E.PO'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson estimator of the population total according to a PO sampling design</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.PO(y, Pik)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.PO_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every unit in the selected sample</p>
</td></tr>
<tr><td><code id="E.PO_+3A_pik">Pik</code></td>
<td>
<p>Vector of inclusion probabilities for each unit in the selected sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated standard error and its estimated coefficient of variation under a PO sampling design</p>


<h3>Value</h3>

<p>The function returns a data matrix whose columns correspond to the estimated parameters of the variables of interest</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.PO">S.PO</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uses the Lucy data to draw a Poisson sample
data(Lucy)
attach(Lucy)
N &lt;- dim(Lucy)[1]
# The population size is 2396. The expected sample size is 400
# The inclusion probability is proportional to the variable Income
n &lt;- 400
Pik&lt;-n*Income/sum(Income)
# The selected sample
sam &lt;- S.PO(N,Pik)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The inclusion probabilities of each unit in the selected smaple
inclusion &lt;- Pik[sam]
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.PO(estima,inclusion)
</code></pre>

<hr>
<h2 id='E.PPS'>Estimation of the Population Total under Probability Proportional to Size Sampling With Replacement</h2><span id='topic+E.PPS'></span>

<h3>Description</h3>

<p>Computes the Hansen-Hurwitz estimator of the population total according to a probability proportional to size sampling with replacement design</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.PPS(y, pk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.PPS_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every unit in the selected sample</p>
</td></tr>
<tr><td><code id="E.PPS_+3A_pk">pk</code></td>
<td>
<p>A vector containing selection probabilities for each unit in the sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated standard error and its estimated coefficient of variation estimated under a probability proportional to size sampling with replacement design</p>


<h3>Value</h3>

<p>The function returns a data matrix whose columns correspond to the estimated parameters of the variables of interest</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.PPS">S.PPS</a>, <a href="#topic+HH">HH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uses the Lucy data to draw a random sample according to a
# PPS with replacement design
data(Lucy)
attach(Lucy)
# The selection probability of each unit is proportional to the variable Income
m &lt;- 400
res &lt;- S.PPS(m,Income)
# The selected sample
sam &lt;- res[,1]
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# pk.s is the selection probability of each unit in the selected sample
pk.s &lt;- res[,2]
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.PPS(estima,pk.s)
</code></pre>

<hr>
<h2 id='E.Quantile'>Estimation of a Population quantile</h2><span id='topic+E.Quantile'></span>

<h3>Description</h3>

<p>Computes the estimation of a population quantile using the principles of the Horvitz-Thompson estimator</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.Quantile(y, Qn, Pik)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.Quantile_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
<tr><td><code id="E.Quantile_+3A_qn">Qn</code></td>
<td>
<p>Quantile of interest</p>
</td></tr>
<tr><td><code id="E.Quantile_+3A_pik">Pik</code></td>
<td>
<p>A vector containing inclusion probabilities for each unit in the sample. 
If missing, the function will assign the same weights to each unit in the sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population quantile of every single variable of interest</p>


<h3>Value</h3>

<p>The function returns a vector whose entries correspond to the estimated quantiles of the variables of interest</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HT">HT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vectors y and x give the values of the variables of interest
y&lt;-c(32, 34, 46, 89, 35)
x&lt;-c(52, 60, 75, 100, 50)
z&lt;-cbind(y,x)
# Inclusion probabilities for a design of size n=2
Pik&lt;-c(0.58, 0.34, 0.48, 0.33, 0.27)
# Estimation of the sample median
E.Quantile(y, 0.5)
# Estimation of the sample Q1
E.Quantile(x, 0.25)
# Estimation of the sample Q3
E.Quantile(z, 0.75)
# Estimation of the sample median
E.Quantile(z, 0.5, Pik)

############
## Example 2
############
# Uses the Lucy data to draw a PPS sample with replacement

data(Lucy)
attach(Lucy)

# The selection probability of each unit is proportional to the variable Income
# The sample size is m=400
m=400
res &lt;- S.PPS(m,Income)
# The selected sample
sam &lt;- res[,1]
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
# The vector of selection probabilities of units in the sample
pk.s &lt;- res[,2]
# The vector of inclusion probabilities of units in the sample
Pik.s&lt;-1-(1-pk.s)^m
# The information about the sample units is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
# Estimation of sample median
E.Quantile(estima,0.5,Pik.s)
</code></pre>

<hr>
<h2 id='E.SI'>Estimation of the Population Total under Simple Random Sampling Without Replacement</h2><span id='topic+E.SI'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson estimator of the population total according to an SI sampling design</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.SI(N, n, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.SI_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="E.SI_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="E.SI_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated standard error and its
estimated coefficient of variation under an SI sampling design</p>


<h3>Value</h3>

<p>The function returns a data matrix whose columns correspond to the estimated parameters of the variables of interest</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.SI">S.SI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Uses the Lucy data to draw a random sample of units according to a SI design
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
sam &lt;- S.SI(N,n)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.SI(N,n,estima)

############
## Example 2
############
# Following with Example 1. The variable SPAM is a domain of interest
Doma &lt;- Domains(SPAM)
# This function allows to estimate the size of each domain in SPAM
estima &lt;- data.frame(Doma)
E.SI(N,n,Doma)

############
## Example 3
############
# Following with Example 1. The variable SPAM is a domain of interest
Doma &lt;- Domains(SPAM)
# This function allows to estimate the parameters of the variables of interest 
# for every category in the domain SPAM
estima &lt;- data.frame(Income, Employees, Taxes)
SPAM.no &lt;-  cbind(Doma[,1], estima*Doma[,1])
SPAM.yes &lt;- cbind(Doma[,1], estima*Doma[,2])
# Before running the following lines, notice that:
# The first column always indicates the population size
# The second column is an estimate of the size of the category in the domain SPAM
# The remaining columns estimates the parameters of interest 
# within the corresponding category in the domain SPAM
E.SI(N,n,SPAM.no)
E.SI(N,n,SPAM.yes)

############
## Example 4
############
# Following with Example 1. The variable SPAM is a domain of interest 
# and the variable ISO is a populational subgroup of interest
Doma &lt;- Domains(SPAM)
estima &lt;- Domains(Zone)
# Before running the following lines, notice that:
# The first column indicates wheter the unit 
# belongs to the first category of SPAM or not
# The remaining columns indicates wheter the unit 
# belogns to the categories of Zone
SPAM.no &lt;-  data.frame(SpamNO=Doma[,1], Zones=estima*Doma[,1])
# Before running the following lines, notice that:
# The first column indicates wheter the unit 
# belongs to the second category of SPAM or not
# The remaining columns indicates wheter the unit 
# belogns to the categories of Zone
SPAM.yes &lt;- data.frame(SpamYES=Doma[,2], Zones=estima*Doma[,2])
# Before running the following lines, notice that:
# The first column always indicates the population size
# The second column is an estimate of the size of the 
# first category in the domain SPAM
# The remaining columns estimates the size of the categories 
# of Zone within the corresponding category of SPAM
# Finnaly, note that the sum of the point estimates of the last 
# two columns gives exactly the point estimate in the second column
E.SI(N,n,SPAM.no)
# Before running the following lines, notice that:
# The first column always indicates the population size
# The second column is an estimate of the size of the 
# second category in the domain SPAM
# The remaining columns estimates the size of the categories 
# of Zone within the corresponding category of SPAM
# Finnaly, note that the sum of the point estimates of the last two 
# columns gives exactly the point estimate in the second column
E.SI(N,n,SPAM.yes)

</code></pre>

<hr>
<h2 id='E.STpiPS'>Estimation of the Population Total under Stratified Probability Proportional to Size Sampling Without Replacement</h2><span id='topic+E.STpiPS'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson estimator of the population total according to a probability proportional to size
sampling without replacement design in each stratum</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.STpiPS(y, pik, S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.STpiPS_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
<tr><td><code id="E.STpiPS_+3A_pik">pik</code></td>
<td>
<p>A vector containing inclusion probabilities for each unit in the sample</p>
</td></tr>
<tr><td><code id="E.STpiPS_+3A_s">S</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in selected sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated standard error, its estimated coefficient of variation and its corresponding DEFF in all of the strata and finally in the entire population</p>


<h3>Value</h3>

<p>The function returns an array composed by several  matrices representing each variable of interest. The columns of each matrix
correspond to the estimated parameters of the variables of interest in each stratum and in the entire population</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.STpiPS">S.STpiPS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uses the Lucy data to draw a stratified random sample 
# according to a PPS design in each stratum

data(Lucy)
attach(Lucy)
# Level is the stratifying variable
summary(Level)

# Defines the size of each stratum
N1&lt;-summary(Level)[[1]]
N2&lt;-summary(Level)[[2]]
N3&lt;-summary(Level)[[3]]
N1;N2;N3

# Defines the sample size at each stratum
n1&lt;-N1
n2&lt;-100
n3&lt;-200
nh&lt;-c(n1,n2,n3)
nh
# Draws a stratified sample
S &lt;- Level
x &lt;- Employees

res &lt;- S.STpiPS(S, x, nh)
sam &lt;- res[,1]
pik &lt;- res[,2]

data &lt;- Lucy[sam,]
attach(data)

estima &lt;- data.frame(Income, Employees, Taxes)
E.STpiPS(estima,pik,Level)
</code></pre>

<hr>
<h2 id='E.STPPS'>Estimation of the Population Total under Stratified Probability Proportional to Size Sampling With Replacement</h2><span id='topic+E.STPPS'></span>

<h3>Description</h3>

<p>Computes the Hansen-Hurwitz estimator of the population total according to a probability proportional to size
sampling with replacement design</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.STPPS(y, pk, mh, S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.STPPS_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
<tr><td><code id="E.STPPS_+3A_pk">pk</code></td>
<td>
<p>A vector containing selection probabilities for each unit in the sample</p>
</td></tr>
<tr><td><code id="E.STPPS_+3A_mh">mh</code></td>
<td>
<p>Vector of sample size in each stratum</p>
</td></tr>
<tr><td><code id="E.STPPS_+3A_s">S</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in selected sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated standard error and its estimated coefficient of variation in all of the stratum and finally in the entire population</p>


<h3>Value</h3>

<p>The function returns an array composed by several  matrices representing each variable of interest. The columns of each matrix
correspond to the estimated parameters of the variables of interest in each stratum and in the entire population</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.STPPS">S.STPPS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uses the Lucy data to draw a stratified random sample 
# according to a PPS design in each stratum

data(Lucy)
attach(Lucy)
# Level is the stratifying variable
summary(Level)
# Defines the sample size at each stratum
m1&lt;-83
m2&lt;-100
m3&lt;-200
mh&lt;-c(m1,m2,m3)
# Draws a stratified sample
res&lt;-S.STPPS(Level, Income, mh)
# The selected sample
sam&lt;-res[,1]
# The selection probability of each unit in the selected sample
pk &lt;- res[,2]
pk
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.STPPS(estima,pk,mh,Level)
</code></pre>

<hr>
<h2 id='E.STSI'>Estimation of the Population Total under Stratified Simple Random Sampling Without Replacement</h2><span id='topic+E.STSI'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson estimator of the population total according to a STSI sampling design</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.STSI(S, Nh, nh, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.STSI_+3A_s">S</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in the population</p>
</td></tr>
<tr><td><code id="E.STSI_+3A_nh">Nh</code></td>
<td>
<p>Vector of stratum sizes</p>
</td></tr>      
<tr><td><code id="E.STSI_+3A_nh">nh</code></td>
<td>
<p>Vector of sample sizes in each stratum</p>
</td></tr>
<tr><td><code id="E.STSI_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated standard error and its estimated coefficient of variation in all of the strata and finally in the entire population</p>


<h3>Value</h3>

<p>The function returns an array composed by several  matrices representing each variable of interest. The columns of each matrix
correspond to the estimated parameters of the variables of interest in each stratum and in the entire population</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.STSI">S.STSI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Uses the Lucy data to draw a stratified random sample 
# according to a SI design in each stratum

data(Lucy)
attach(Lucy)
# Level is the stratifying variable
summary(Level)
# Defines the size of each stratum
N1&lt;-summary(Level)[[1]]
N2&lt;-summary(Level)[[2]]
N3&lt;-summary(Level)[[3]]
N1;N2;N3
Nh &lt;- c(N1,N2,N3)
# Defines the sample size at each stratum
n1&lt;-N1
n2&lt;-100
n3&lt;-200
nh&lt;-c(n1,n2,n3)
# Draws a stratified sample
sam &lt;- S.STSI(Level, Nh, nh)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.STSI(Level,Nh,nh,estima)

############
## Example 2
############
# Following with Example 1. The variable SPAM is a domain of interest
Doma &lt;- Domains(SPAM)
# This function allows to estimate the parameters of the variables of interest
# for every category in the domain SPAM
SPAM.no &lt;- estima*Doma[,1]
SPAM.yes &lt;- estima*Doma[,2]
E.STSI(Level, Nh, nh, Doma)
E.STSI(Level, Nh, nh, SPAM.no)
E.STSI(Level, Nh, nh, SPAM.yes)
</code></pre>

<hr>
<h2 id='E.SY'>Estimation of the Population Total under Systematic Sampling Without Replacement</h2><span id='topic+E.SY'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson estimator of the population total according to an SY sampling design</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.SY(N, a, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.SY_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="E.SY_+3A_a">a</code></td>
<td>
<p>Number of groups dividing the population</p>
</td></tr>
<tr><td><code id="E.SY_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated standard error and its estimated coefficient of variation under an SY sampling design</p>


<h3>Value</h3>

<p>The function returns a data matrix whose columns correspond to the estimated parameters of the variables of interest</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.SY">S.SY</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uses the Lucy data to draw a Systematic sample
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
# The population is divided in 6 groups
# The selected sample
sam &lt;- S.SY(N,6)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.SY(N,6,estima)
</code></pre>

<hr>
<h2 id='E.Trim'>Weight Trimming and Redistribution</h2><span id='topic+E.Trim'></span>

<h3>Description</h3>

<p>This function performs a method of trimming sampling weights based on the 
evenly redistribution of the net ammount of weight loss among units whose
weights were not trimmed. This way, the sum of the timmed sampling weights 
remains the same as the original weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.Trim(dk, L, U)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.Trim_+3A_dk">dk</code></td>
<td>
<p>Vector of original sampling weights.</p>
</td></tr>
<tr><td><code id="E.Trim_+3A_l">L</code></td>
<td>
<p>Lower bound for weights.</p>
</td></tr>
<tr><td><code id="E.Trim_+3A_u">U</code></td>
<td>
<p>Upper bound for weights.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a vector of trimmed sampling weigths.
</p>


<h3>Value</h3>

<p>This function returns a vector of trimmed weights.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt; with contributions
from Javier Nunez &lt;javier_nunez at inec.gob.ec&gt;
</p>


<h3>References</h3>

<p>Valliant, R. et. al. (2013), <em>Practical Tools for Designing and
Weigthing Survey Samples</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas 
y estimacion de parametros</em>. Editorial Universidad Santo Tomas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1
dk &lt;- c(1, 1, 1, 10) 
summary(dk)
L &lt;- 1
U &lt;- 3.5 * median(dk)
dkTrim &lt;- E.Trim(dk, L, U)
sum(dk)
sum(dkTrim)

# Example 2
dk &lt;- rnorm(1000, 10, 10)
L &lt;- 1
U &lt;- 3.5 * median(dk)
dkTrim &lt;- E.Trim(dk, L, U)
sum(dk)
sum(dkTrim)
summary(dk)
summary(dkTrim)
hist(dk)
hist(dkTrim)
</code></pre>

<hr>
<h2 id='E.UC'>Estimation of the Population Total and its variance using the Ultimate Cluster technique</h2><span id='topic+E.UC'></span>

<h3>Description</h3>

<p>This function computes a weighted estimator of the population total and
estimates its variance by using the Ultimate Cluster technique. This approximation
performs well in many sampling designs. The user specifically needs to
declare the variables of interest, the primary sampling units, the strata, and 
the sampling weights for every singlt unit in the sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.UC(S, PSU, dk, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.UC_+3A_s">S</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in selected sample.</p>
</td></tr>
<tr><td><code id="E.UC_+3A_psu">PSU</code></td>
<td>
<p>Vector identifying the membership to the strata of 
each unit in the population.</p>
</td></tr>
<tr><td><code id="E.UC_+3A_dk">dk</code></td>
<td>
<p>Sampling weights of the units in the sample.</p>
</td></tr>
<tr><td><code id="E.UC_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containig the recollected 
information of the variables of interest for every unit in the 
selected sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a data matrix whose columns correspond to 
the estimated parameters of the variables of interest.
</p>


<h3>Value</h3>

<p>This function returns the estimation of the population total of 
every single variable of interest, its estimated standard error 
and its estimated coefficient of variation.
</p>


<h3>Author(s)</h3>

<p>Hsugo Andres Gutierrez Rojas &lt;hugogutierrez at gmail.com&gt;
</p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.2SI">E.2SI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#############################
## Example 1:              ##
## Stratified Two-stage SI ##
#############################

data('BigCity')
FrameI &lt;- BigCity %&gt;% group_by(PSU) %&gt;%
summarise(Stratum = unique(Stratum),
          Persons = n(),
          Income = sum(Income),
          Expenditure = sum(Expenditure))
            
attach(FrameI)

sizes = FrameI %&gt;% group_by(Stratum) %&gt;%
        summarise(NIh = n(),
        nIh = 2,
        dI = NIh/nIh)
        
NIh &lt;- sizes$NIh
nIh &lt;- sizes$nIh

samI &lt;- S.STSI(Stratum, NIh, nIh)
UI &lt;- levels(as.factor(FrameI$PSU))
sampleI &lt;- UI[samI]
          
FrameII &lt;- left_join(sizes, BigCity[which(BigCity$PSU %in% sampleI), ])
attach(FrameII)

HHdb &lt;- FrameII %&gt;% 
        group_by(PSU) %&gt;%
        summarise(Ni = length(unique(HHID)))
        
Ni &lt;- as.numeric(HHdb$Ni)
ni &lt;- ceiling(Ni * 0.1)
ni
sum(ni)

sam = S.SI(Ni[1], ni[1])
clusterII = FrameII[which(FrameII$PSU == sampleI[1]), ]
sam.HH &lt;- data.frame(HHID = unique(clusterII$HHID)[sam])
clusterHH &lt;- left_join(sam.HH, clusterII, by = "HHID") 
clusterHH$dki &lt;- Ni[1]/ni[1]
clusterHH$dk &lt;- clusterHH$dI * clusterHH$dki
data = clusterHH
for (i in 2:length(Ni)) {
      sam = S.SI(Ni[i], ni[i])
      clusterII = FrameII[which(FrameII$PSU == sampleI[i]), ]
      sam.HH &lt;- data.frame(HHID = unique(clusterII$HHID)[sam])
      clusterHH &lt;- left_join(sam.HH, clusterII, by = "HHID") 
      clusterHH$dki &lt;- Ni[i]/ni[i]
      clusterHH$dk &lt;- clusterHH$dI * clusterHH$dki
      data1 = clusterHH
      data = rbind(data, data1)
}

sum(data$dk)
attach(data)
estima &lt;- data.frame(Income, Expenditure)
area &lt;- as.factor(PSU)
stratum &lt;- as.factor(Stratum)

E.UC(stratum, area, dk, estima)

################################
## Example 2:                 ##
## Self weighted Two-stage SI ##
################################

data('BigCity')
FrameI &lt;- BigCity %&gt;% group_by(PSU) %&gt;%
summarise(Stratum = unique(Stratum),
          Households = length(unique(HHID)),
          Income = sum(Income),
          Expenditure = sum(Expenditure))
            
attach(FrameI)

sizes = FrameI %&gt;% group_by(Stratum) %&gt;%
        summarise(NIh = n(),
        nIh = 2)
        
NIh &lt;- sizes$NIh
nIh &lt;- sizes$nIh

resI &lt;- S.STpiPS(Stratum, Households, nIh)
head(resI)
samI &lt;- resI[, 1]
piI &lt;- resI[, 2]
UI &lt;- levels(as.factor(FrameI$PSU))
sampleI &lt;- data.frame(PSU = UI[samI], dI = 1/piI) 
 
FrameII &lt;- left_join(sampleI, 
           BigCity[which(BigCity$PSU %in% sampleI[,1]), ])
           
attach(FrameII)

HHdb &lt;- FrameII %&gt;% 
        group_by(PSU) %&gt;%
        summarise(Ni = length(unique(HHID)))
Ni &lt;- as.numeric(HHdb$Ni)
ni &lt;- 5

sam = S.SI(Ni[1], ni)
clusterII = FrameII[which(FrameII$PSU == sampleI$PSU[1]), ]
sam.HH &lt;- data.frame(HHID = unique(clusterII$HHID)[sam])
clusterHH &lt;- left_join(sam.HH, clusterII, by = "HHID") 
clusterHH$dki &lt;- Ni[1]/ni
clusterHH$dk &lt;- clusterHH$dI * clusterHH$dki
data = clusterHH
for (i in 2:length(Ni)) {
      sam = S.SI(Ni[i], ni)
      clusterII = FrameII[which(FrameII$PSU == sampleI$PSU[i]), ]
      sam.HH &lt;- data.frame(HHID = unique(clusterII$HHID)[sam])
      clusterHH &lt;- left_join(sam.HH, clusterII, by = "HHID") 
      clusterHH$dki &lt;- Ni[i]/ni
      clusterHH$dk &lt;- clusterHH$dI * clusterHH$dki
      data1 = clusterHH
      data = rbind(data, data1)
}

sum(data$dk)
attach(data)
estima &lt;- data.frame(Income, Expenditure)
area &lt;- as.factor(PSU)
stratum &lt;- as.factor(Stratum)

E.UC(stratum, area, dk, estima)
</code></pre>

<hr>
<h2 id='E.WR'>Estimation of the Population Total under Simple Random Sampling With Replacement</h2><span id='topic+E.WR'></span>

<h3>Description</h3>

<p>Computes the Hansen-Hurwitz estimator of the population total according to a simple random
sampling with replacement design</p>


<h3>Usage</h3>

<pre><code class='language-R'>E.WR(N, m, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E.WR_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="E.WR_+3A_m">m</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="E.WR_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the estimation of the population total of every single variable of interest, its estimated variance and its
estimated coefficient of variation estimated under an simple random with replacement design</p>


<h3>Value</h3>

<p>The function returns a data matrix whose columns correspond to the estimated parameters of the variables of interest</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.WR">S.WR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uses the Lucy data to draw a random sample according to a WR design
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
m &lt;- 400
sam &lt;- S.WR(N,m)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.WR(N,m,estima)
</code></pre>

<hr>
<h2 id='GREG.SI'>The Generalized Regression Estimator under SI sampling design</h2><span id='topic+GREG.SI'></span>

<h3>Description</h3>

<p>Computes the generalized regression estimator of the population total for several variables of interest under simple random sampling without replacement</p>


<h3>Usage</h3>

<pre><code class='language-R'>GREG.SI(N, n, y, x, tx, b, b0=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GREG.SI_+3A_n">N</code></td>
<td>
<p>The population size</p>
</td></tr>
<tr><td><code id="GREG.SI_+3A_n">n</code></td>
<td>
<p>The sample size</p>
</td></tr>
<tr><td><code id="GREG.SI_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
<tr><td><code id="GREG.SI_+3A_x">x</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected auxiliary information for every unit in the selected sample</p>
</td></tr>
<tr><td><code id="GREG.SI_+3A_tx">tx</code></td>
<td>
<p>Vector containing the populations totals of the auxiliary information</p>
</td></tr>
<tr><td><code id="GREG.SI_+3A_b">b</code></td>
<td>
<p>Vector of estimated regression coefficients</p>
</td></tr>
<tr><td><code id="GREG.SI_+3A_b0">b0</code></td>
<td>
<p>By default FALSE. The intercept of the regression model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a vector of total population estimates for each variable of interest, its estimated standard error and its estimated coefficient of variation.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.Beta">E.Beta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>######################################################################
## Example 1: Linear models involving continuous auxiliary information
######################################################################

# Draws a simple random sample without replacement
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
sam &lt;- S.SI(N,n)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)

########### common mean model

estima&lt;-data.frame(Income, Employees, Taxes)
x &lt;- rep(1,n)
model &lt;- E.Beta(N, n, estima, x, ck=1,b0=FALSE)
b &lt;- t(as.matrix(model[1,,]))
tx &lt;- c(N)
GREG.SI(N,n,estima,x,tx, b, b0=FALSE)

########### common ratio model

estima&lt;-data.frame(Income)
x &lt;- data.frame(Employees)
model &lt;- E.Beta(N, n, estima, x, ck=x,b0=FALSE)
b &lt;- t(as.matrix(model[1,,]))
tx &lt;- sum(Lucy$Employees)
GREG.SI(N,n,estima,x,tx, b, b0=FALSE)

########### Simple regression model without intercept

estima&lt;-data.frame(Income, Employees)
x &lt;- data.frame(Taxes)
model &lt;- E.Beta(N, n, estima, x, ck=1,b0=FALSE)
b &lt;- t(as.matrix(model[1,,]))
tx &lt;- sum(Lucy$Taxes)
GREG.SI(N,n,estima,x,tx, b, b0=FALSE)

########### Multiple regression model without intercept

estima&lt;-data.frame(Income)
x &lt;- data.frame(Employees, Taxes)
model &lt;- E.Beta(N, n, estima, x, ck=1, b0=FALSE)
b &lt;- as.matrix(model[1,,])
tx &lt;- c(sum(Lucy$Employees), sum(Lucy$Taxes))
GREG.SI(N,n,estima,x,tx, b, b0=FALSE) 

########### Simple regression model with intercept

estima&lt;-data.frame(Income, Employees)
x &lt;- data.frame(Taxes)
model &lt;- E.Beta(N, n, estima, x, ck=1,b0=TRUE) 
b &lt;- as.matrix(model[1,,])
tx &lt;- c(N, sum(Lucy$Taxes))
GREG.SI(N,n,estima,x,tx, b, b0=TRUE) 

########### Multiple regression model with intercept

estima&lt;-data.frame(Income)                               
x &lt;- data.frame(Employees, Taxes)
model &lt;- E.Beta(N, n, estima, x, ck=1,b0=TRUE)
b &lt;- as.matrix(model[1,,])
tx &lt;- c(N, sum(Lucy$Employees), sum(Lucy$Taxes))            
GREG.SI(N,n,estima,x,tx, b, b0=TRUE) 

####################################################################
## Example 2: Linear models with discrete auxiliary information
####################################################################

# Draws a simple random sample without replacement
data(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
sam &lt;- S.SI(N,n)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)

# The auxiliary information is discrete type
Doma&lt;-Domains(Level)

########### Poststratified common mean model

estima&lt;-data.frame(Income, Employees, Taxes)
model &lt;- E.Beta(N, n, estima, Doma, ck=1,b0=FALSE)
b &lt;- t(as.matrix(model[1,,]))
tx &lt;- colSums(Domains(Lucy$Level))
GREG.SI(N,n,estima,Doma,tx, b, b0=FALSE) 

########### Poststratified common ratio model 

estima&lt;-data.frame(Income, Employees)
x &lt;- Doma*Taxes
model &lt;- E.Beta(N, n, estima, x ,ck=1,b0=FALSE)
b &lt;- as.matrix(model[1,,])
tx &lt;- colSums(Domains(Lucy$Level)*Lucy$Taxes)
GREG.SI(N,n,estima,x,tx, b, b0=FALSE) 

######################################################################
## Example 3: Domains estimation trough the postestratified estimator
######################################################################

# Draws a simple random sample without replacement
data(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
sam &lt;- S.SI(N,n)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)

# The auxiliary information is discrete type
Doma&lt;-Domains(Level)

########### Poststratified common mean model for the 
  # Income total in each poststratum ###################

estima&lt;-Doma*Income
model &lt;- E.Beta(N, n, estima, Doma, ck=1, b0=FALSE)
b &lt;- t(as.matrix(model[1,,]))
tx &lt;- colSums(Domains(Lucy$Level))
GREG.SI(N,n,estima,Doma,tx, b, b0=FALSE) 

########### Poststratified common mean model for the 
  # Employees total in each poststratum ###################

estima&lt;-Doma*Employees
model &lt;- E.Beta(N, n, estima, Doma, ck=1,b0=FALSE)
b &lt;- t(as.matrix(model[1,,]))
tx &lt;- colSums(Domains(Lucy$Level))
GREG.SI(N,n,estima,Doma,tx, b, b0=FALSE) 

########### Poststratified common mean model for the 
  # Taxes total in each poststratum ###################

estima&lt;-Doma*Taxes
model &lt;- E.Beta(N, n, estima, Doma, ck=1, b0=FALSE)
b &lt;- t(as.matrix(model[1,,]))
tx &lt;- colSums(Domains(Lucy$Level))
GREG.SI(N,n,estima,Doma,tx, b, b0=FALSE) 

</code></pre>

<hr>
<h2 id='HH'>The Hansen-Hurwitz Estimator</h2><span id='topic+HH'></span>

<h3>Description</h3>

<p>Computes the Hansen-Hurwitz Estimator estimator of the population total for several variables of interest</p>


<h3>Usage</h3>

<pre><code class='language-R'>HH(y, pk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HH_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every unit in the selected sample</p>
</td></tr>
<tr><td><code id="HH_+3A_pk">pk</code></td>
<td>
<p>A vector containing selection probabilities for each unit in the selected sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Hansen-Hurwitz estimator is given by
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^m\frac{y_i}{p_i}</code>
</p>

<p>where <code class="reqn">y_i</code> is the value of the variables of interest for the <code class="reqn">i</code>th unit, and <code class="reqn">p_i</code> is its corresponding 
selection probability. This estimator is restricted to with replacement sampling designs.
</p>


<h3>Value</h3>

<p>The function returns a vector of total population estimates for each variable of interest, its estimated standard error and its estimated coefficient of variation.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HT">HT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vectors y1 and y2 give the values of the variables of interest
y1&lt;-c(32, 34, 46, 89, 35)
y2&lt;-c(1,1,1,0,0)
y3&lt;-cbind(y1,y2)
# The population size is N=5
N &lt;- length(U)
# The sample size is m=2
m &lt;- 2
# pk is the probability of selection of every single unit
pk &lt;- c(0.35, 0.225, 0.175, 0.125, 0.125)
# Selection of a random sample with replacement
sam &lt;- sample(5,2, replace=TRUE, prob=pk)
# The selected sample is
U[sam]
# The values of the variables of interest for the units in the sample
y1[sam]
y2[sam]
y3[sam,]
# The Hansen-Hurwitz estimator
HH(y1[sam],pk[sam])
HH(y2[sam],pk[sam])
HH(y3[sam,],pk[sam])


############
## Example 2
############
# Uses the Lucy data to draw a simple random sample with replacement
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
m &lt;- 400
sam &lt;- sample(N,m,replace=TRUE)
# The vector of selection probabilities of units in the sample
pk &lt;- rep(1/N,m)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
HH(estima, pk)

################################################################
## Example 3 HH is unbiased for with replacement sampling designs
################################################################

# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector y1 and y2 are the values of the variables of interest
y&lt;-c(32, 34, 46, 89, 35)
# The population size is N=5
N &lt;- length(U)
# The sample size is m=2
m &lt;- 2
# pk is the probability of selection of every single unit
pk &lt;- c(0.35, 0.225, 0.175, 0.125, 0.125)
# p is the probability of selection of every possible sample
p &lt;- p.WR(N,m,pk)
p
sum(p)
# The sample membership matrix for random size without replacement sampling designs
Ind &lt;- nk(N,m)
Ind
# The support with the values of the elements
Qy &lt;- SupportWR(N,m, ID=y)                 
Qy
# The support with the values of the elements
Qp &lt;- SupportWR(N,m, ID=pk)                 
Qp
# The HT estimates for every single sample in the support
HH1 &lt;- HH(Qy[1,], Qp[1,])[1,]
HH2 &lt;- HH(Qy[2,], Qp[2,])[1,]
HH3 &lt;- HH(Qy[3,], Qp[3,])[1,] 
HH4 &lt;- HH(Qy[4,], Qp[4,])[1,] 
HH5 &lt;- HH(Qy[5,], Qp[5,])[1,] 
HH6 &lt;- HH(Qy[6,], Qp[6,])[1,] 
HH7 &lt;- HH(Qy[7,], Qp[7,])[1,]
HH8 &lt;- HH(Qy[8,], Qp[8,])[1,]
HH9 &lt;- HH(Qy[9,], Qp[9,])[1,]
HH10 &lt;- HH(Qy[10,], Qp[10,])[1,]
HH11 &lt;- HH(Qy[11,], Qp[11,])[1,]
HH12 &lt;- HH(Qy[12,], Qp[12,])[1,]
HH13 &lt;- HH(Qy[13,], Qp[13,])[1,]
HH14 &lt;- HH(Qy[14,], Qp[14,])[1,]
HH15 &lt;- HH(Qy[15,], Qp[15,])[1,]
# The HT estimates arranged in a vector
Est &lt;- c(HH1, HH2, HH3, HH4, HH5, HH6, HH7, HH8, HH9, HH10, HH11, HH12, HH13,
HH14, HH15)
Est
# The HT is actually desgn-unbiased
data.frame(Ind, Est, p)
sum(Est*p)
sum(y)
</code></pre>

<hr>
<h2 id='HT'>The Horvitz-Thompson Estimator</h2><span id='topic+HT'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson estimator of the population total for several
variables of interest</p>


<h3>Usage</h3>

<pre><code class='language-R'>HT(y, Pik)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HT_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr>
<tr><td><code id="HT_+3A_pik">Pik</code></td>
<td>
<p>A vector containing the inclusion probabilities for each unit in the selected sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Horvitz-Thompson estimator is given by
</p>
<p style="text-align: center;"><code class="reqn">\sum_{k \in U}\frac{y_k}{{\pi}_k}</code>
</p>

<p>where <code class="reqn">y_k</code> is the value of the variables of interest for the <code class="reqn">k</code>th unit, and <code class="reqn">{\pi}_k</code> 
its corresponding inclusion probability. This estimator could be used for without replacement designs 
as well as for with replacement designs.
</p>


<h3>Value</h3>

<p>The function returns a vector of total population estimates for each variable of interest.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HH">HH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Uses the Lucy data to draw a simple random sample without replacement
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
sam &lt;- sample(N,n)
# The vector of inclusion probabilities for each unit in the sample
pik &lt;- rep(n/N,n)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
HT(estima, pik)

############
## Example 2
############
# Uses the Lucy data to draw a simple random sample with replacement
data(Lucy)

N &lt;- dim(Lucy)[1]
m &lt;- 400
sam &lt;- sample(N,m,replace=TRUE)
# The vector of selection probabilities of units in the sample
pk &lt;- rep(1/N,m)
# Computation of the inclusion probabilities
pik &lt;- 1-(1-pk)^m
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
HT(estima, pik)

############
## Example 3
############
# Without replacement sampling
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector y1 and y2 are the values of the variables of interest
y1&lt;-c(32, 34, 46, 89, 35)
y2&lt;-c(1,1,1,0,0)
y3&lt;-cbind(y1,y2)
# The population size is N=5
N &lt;- length(U)
# The sample size is n=2
n &lt;- 2
# The sample membership matrix for fixed size without replacement sampling designs
Ind &lt;- Ik(N,n)
# p is the probability of selection of every possible sample
p &lt;- c(0.13, 0.2, 0.15, 0.1, 0.15, 0.04, 0.02, 0.06, 0.07, 0.08)
# Computation of the inclusion probabilities
inclusion &lt;- Pik(p, Ind)
# Selection of a random sample
sam &lt;- sample(5,2)
# The selected sample
U[sam]
# The inclusion probabilities for these two units
inclusion[sam]
# The values of the variables of interest for the units in the sample
y1[sam]
y2[sam]
y3[sam,]
# The Horvitz-Thompson estimator
HT(y1[sam],inclusion[sam])
HT(y2[sam],inclusion[sam])
HT(y3[sam,],inclusion[sam])

############
## Example 4
############
# Following Example 3... With replacement sampling
# The population size is N=5
N &lt;- length(U)
# The sample size is m=2
m &lt;- 2
# pk is the probability of selection of every single unit
pk &lt;- c(0.9, 0.025, 0.025, 0.025, 0.025)
# Computation of the inclusion probabilities
pik &lt;- 1-(1-pk)^m
# Selection of a random sample with replacement
sam &lt;- sample(5,2, replace=TRUE, prob=pk)
# The selected sample
U[sam]
# The inclusion probabilities for these two units
inclusion[sam]
# The values of the variables of interest for the units in the sample
y1[sam]
y2[sam]
y3[sam,]
# The Horvitz-Thompson estimator
HT(y1[sam],inclusion[sam])
HT(y2[sam],inclusion[sam])
HT(y3[sam,],inclusion[sam])

####################################################################
## Example 5 HT is unbiased for without replacement sampling designs
##                  Fixed sample size
####################################################################

# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector y1 and y2 are the values of the variables of interest
y&lt;-c(32, 34, 46, 89, 35)
# The population size is N=5
N &lt;- length(U)
# The sample size is n=2
n &lt;- 2
# The sample membership matrix for fixed size without replacement sampling designs
Ind &lt;- Ik(N,n)
Ind
# p is the probability of selection of every possible sample
p &lt;- c(0.13, 0.2, 0.15, 0.1, 0.15, 0.04, 0.02, 0.06, 0.07, 0.08)
sum(p)
# Computation of the inclusion probabilities
inclusion &lt;- Pik(p, Ind)
inclusion
sum(inclusion)
# The support with the values of the elements
Qy &lt;-Support(N,n,ID=y)
Qy
# The HT estimates for every single sample in the support
HT1&lt;- HT(y[Ind[1,]==1], inclusion[Ind[1,]==1])
HT2&lt;- HT(y[Ind[2,]==1], inclusion[Ind[2,]==1])
HT3&lt;- HT(y[Ind[3,]==1], inclusion[Ind[3,]==1])
HT4&lt;- HT(y[Ind[4,]==1], inclusion[Ind[4,]==1])
HT5&lt;- HT(y[Ind[5,]==1], inclusion[Ind[5,]==1])
HT6&lt;- HT(y[Ind[6,]==1], inclusion[Ind[6,]==1])
HT7&lt;- HT(y[Ind[7,]==1], inclusion[Ind[7,]==1])
HT8&lt;- HT(y[Ind[8,]==1], inclusion[Ind[8,]==1])
HT9&lt;- HT(y[Ind[9,]==1], inclusion[Ind[9,]==1]) 
HT10&lt;- HT(y[Ind[10,]==1], inclusion[Ind[10,]==1]) 
# The HT estimates arranged in a vector
Est &lt;- c(HT1, HT2, HT3, HT4, HT5, HT6, HT7, HT8, HT9, HT10)
Est
# The HT is actually desgn-unbiased
data.frame(Ind, Est, p)
sum(Est*p)
sum(y)

####################################################################
## Example 6 HT is unbiased for without replacement sampling designs
##                  Random sample size
####################################################################

# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector y1 and y2 are the values of the variables of interest
y&lt;-c(32, 34, 46, 89, 35)
# The population size is N=5
N &lt;- length(U)
# The sample membership matrix for random size without replacement sampling designs
Ind &lt;- IkRS(N)
Ind
# p is the probability of selection of every possible sample
p &lt;- c(0.59049, 0.06561, 0.06561, 0.06561, 0.06561, 0.06561, 0.00729, 0.00729,
       0.00729, 0.00729, 0.00729, 0.00729, 0.00729, 0.00729, 0.00729, 0.00729, 0.00081,
       0.00081, 0.00081, 0.00081, 0.00081, 0.00081, 0.00081, 0.00081, 0.00081, 0.00081,
       0.00009, 0.00009, 0.00009, 0.00009, 0.00009, 0.00001)
sum(p)
# Computation of the inclusion probabilities
inclusion &lt;- Pik(p, Ind)
inclusion
sum(inclusion)
# The support with the values of the elements
Qy &lt;-SupportRS(N, ID=y)
Qy
# The HT estimates for every single sample in the support
HT1&lt;- HT(y[Ind[1,]==1], inclusion[Ind[1,]==1])
HT2&lt;- HT(y[Ind[2,]==1], inclusion[Ind[2,]==1])
HT3&lt;- HT(y[Ind[3,]==1], inclusion[Ind[3,]==1])
HT4&lt;- HT(y[Ind[4,]==1], inclusion[Ind[4,]==1])
HT5&lt;- HT(y[Ind[5,]==1], inclusion[Ind[5,]==1])
HT6&lt;- HT(y[Ind[6,]==1], inclusion[Ind[6,]==1])
HT7&lt;- HT(y[Ind[7,]==1], inclusion[Ind[7,]==1])
HT8&lt;- HT(y[Ind[8,]==1], inclusion[Ind[8,]==1])
HT9&lt;- HT(y[Ind[9,]==1], inclusion[Ind[9,]==1]) 
HT10&lt;- HT(y[Ind[10,]==1], inclusion[Ind[10,]==1]) 
HT11&lt;- HT(y[Ind[11,]==1], inclusion[Ind[11,]==1])
HT12&lt;- HT(y[Ind[12,]==1], inclusion[Ind[12,]==1])
HT13&lt;- HT(y[Ind[13,]==1], inclusion[Ind[13,]==1])
HT14&lt;- HT(y[Ind[14,]==1], inclusion[Ind[14,]==1])
HT15&lt;- HT(y[Ind[15,]==1], inclusion[Ind[15,]==1])
HT16&lt;- HT(y[Ind[16,]==1], inclusion[Ind[16,]==1])
HT17&lt;- HT(y[Ind[17,]==1], inclusion[Ind[17,]==1])
HT18&lt;- HT(y[Ind[18,]==1], inclusion[Ind[18,]==1])
HT19&lt;- HT(y[Ind[19,]==1], inclusion[Ind[19,]==1]) 
HT20&lt;- HT(y[Ind[20,]==1], inclusion[Ind[20,]==1]) 
HT21&lt;- HT(y[Ind[21,]==1], inclusion[Ind[21,]==1])
HT22&lt;- HT(y[Ind[22,]==1], inclusion[Ind[22,]==1])
HT23&lt;- HT(y[Ind[23,]==1], inclusion[Ind[23,]==1])
HT24&lt;- HT(y[Ind[24,]==1], inclusion[Ind[24,]==1])
HT25&lt;- HT(y[Ind[25,]==1], inclusion[Ind[25,]==1])
HT26&lt;- HT(y[Ind[26,]==1], inclusion[Ind[26,]==1])
HT27&lt;- HT(y[Ind[27,]==1], inclusion[Ind[27,]==1])
HT28&lt;- HT(y[Ind[28,]==1], inclusion[Ind[28,]==1])
HT29&lt;- HT(y[Ind[29,]==1], inclusion[Ind[29,]==1]) 
HT30&lt;- HT(y[Ind[30,]==1], inclusion[Ind[30,]==1]) 
HT31&lt;- HT(y[Ind[31,]==1], inclusion[Ind[31,]==1])
HT32&lt;- HT(y[Ind[32,]==1], inclusion[Ind[32,]==1])
# The HT estimates arranged in a vector
Est &lt;- c(HT1, HT2, HT3, HT4, HT5, HT6, HT7, HT8, HT9, HT10, HT11, HT12, HT13,
         HT14, HT15, HT16, HT17, HT18, HT19, HT20, HT21, HT22, HT23, HT24, HT25, HT26, 
         HT27, HT28, HT29, HT30, HT31, HT32)
Est
# The HT is actually desgn-unbiased
data.frame(Ind, Est, p)
sum(Est*p)
sum(y)

################################################################
## Example 7 HT is unbiased for with replacement sampling designs
################################################################

# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector y1 and y2 are the values of the variables of interest
y&lt;-c(32, 34, 46, 89, 35)
# The population size is N=5
N &lt;- length(U)
# The sample size is m=2
m &lt;- 2
# pk is the probability of selection of every single unit
pk &lt;- c(0.35, 0.225, 0.175, 0.125, 0.125)
# p is the probability of selection of every possible sample
p &lt;- p.WR(N,m,pk)
p
sum(p)
# The sample membership matrix for random size without replacement sampling designs
Ind &lt;- IkWR(N,m)
Ind
# The support with the values of the elements
Qy &lt;- SupportWR(N,m, ID=y)                 
Qy
# Computation of the inclusion probabilities
pik &lt;- 1-(1-pk)^m
pik
# The HT estimates for every single sample in the support
HT1 &lt;- HT(y[Ind[1,]==1], pik[Ind[1,]==1])
HT2 &lt;- HT(y[Ind[2,]==1], pik[Ind[2,]==1])
HT3 &lt;- HT(y[Ind[3,]==1], pik[Ind[3,]==1])
HT4 &lt;- HT(y[Ind[4,]==1], pik[Ind[4,]==1])
HT5 &lt;- HT(y[Ind[5,]==1], pik[Ind[5,]==1])
HT6 &lt;- HT(y[Ind[6,]==1], pik[Ind[6,]==1])
HT7 &lt;- HT(y[Ind[7,]==1], pik[Ind[7,]==1])
HT8 &lt;- HT(y[Ind[8,]==1], pik[Ind[8,]==1])
HT9 &lt;- HT(y[Ind[9,]==1], pik[Ind[9,]==1])
HT10 &lt;- HT(y[Ind[10,]==1], pik[Ind[10,]==1])
HT11 &lt;- HT(y[Ind[11,]==1], pik[Ind[11,]==1])
HT12 &lt;- HT(y[Ind[12,]==1], pik[Ind[12,]==1])
HT13 &lt;- HT(y[Ind[13,]==1], pik[Ind[13,]==1])
HT14 &lt;- HT(y[Ind[14,]==1], pik[Ind[14,]==1])
HT15 &lt;- HT(y[Ind[15,]==1], pik[Ind[15,]==1])
# The HT estimates arranged in a vector
Est &lt;- c(HT1, HT2, HT3, HT4, HT5, HT6, HT7, HT8, HT9, HT10, HT11, HT12, HT13,
         HT14, HT15)
Est
# The HT is actually desgn-unbiased
data.frame(Ind, Est, p)
sum(Est*p)
sum(y)
</code></pre>

<hr>
<h2 id='Ik'>Sample Membership Indicator</h2><span id='topic+Ik'></span>

<h3>Description</h3>

<p>Creates a matrix of values (0, if the unit belongs to a specified sample and 1, otherwise) 
for every possible sample under fixed sample size designs without replacement</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ik(N, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ik_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="Ik_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">binom(N)(n)</code> rows and <code class="reqn">N</code> columns. The <code class="reqn">k</code>th column corresponds to the sample 
membership indicator, of the <code class="reqn">k</code>th unit, to a possible sample.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Support">Support</a>, <a href="#topic+Pik">Pik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
n &lt;- 2
# The sample membership matrix for fixed size without replacement sampling designs
Ik(N,n)
# The first unit, Yves, belongs to the first four possible samples 
</code></pre>

<hr>
<h2 id='IkRS'>Sample Membership Indicator for Random Size sampling designs</h2><span id='topic+IkRS'></span>

<h3>Description</h3>

<p>Creates a matrix of values (0, if the unit belongs to a specified sample and 1, otherwise) 
for every possible sample under random sample size designs without replacement</p>


<h3>Usage</h3>

<pre><code class='language-R'>IkRS(N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IkRS_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">2^N</code> rows and <code class="reqn">N</code> columns. The <code class="reqn">k</code>th column corresponds to the sample 
membership indicator, of the <code class="reqn">k</code>th unit, to a possible sample.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SupportRS">SupportRS</a>, <a href="#topic+Pik">Pik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
n &lt;- 3
# The sample membership matrix for fixed size without replacement sampling designs
IkRS(N)
# The first sample is a null one and the last sample is a census
</code></pre>

<hr>
<h2 id='IkWR'>Sample Membership Indicator for with Replacements sampling designs</h2><span id='topic+IkWR'></span>

<h3>Description</h3>

<p>Creates a matrix of values (1, if the unit belongs to a specified sample and 0, otherwise) 
for every possible sample under fixed sample size designs without replacement</p>


<h3>Usage</h3>

<pre><code class='language-R'>IkWR(N, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IkWR_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="IkWR_+3A_m">m</code></td>
<td>
<p>Sample size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">binom(N+m-1)(m)</code> rows and <code class="reqn">N</code> columns. The <code class="reqn">k</code>th column corresponds to the sample 
membership indicator, of the <code class="reqn">k</code>th unit, to a possible sample. It returns a value of 1, even if the element is selected more than once in a with replacement sample.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nk">nk</a>, <a href="#topic+Support">Support</a>, <a href="#topic+Pik">Pik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
m &lt;- 2
# The sample membership matrix for fixed size without replacement sampling designs
IkWR(N,m)
</code></pre>

<hr>
<h2 id='IPFP'>Iterative Proportional Fitting Procedure</h2><span id='topic+IPFP'></span>

<h3>Description</h3>

<p>Adjustment of a table on the margins</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPFP(Table, Col.knw, Row.knw, tol=0.0001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IPFP_+3A_table">Table</code></td>
<td>
<p>A contingency table</p>
</td></tr>
<tr><td><code id="IPFP_+3A_col.knw">Col.knw</code></td>
<td>
<p>A vector containing the true totals of the columns</p>
</td></tr>
<tr><td><code id="IPFP_+3A_row.knw">Row.knw</code></td>
<td>
<p>A vector containing the true totals of the Rows</p>
</td></tr>
<tr><td><code id="IPFP_+3A_tol">tol</code></td>
<td>
<p>The control value, by default equal to 0.0001</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adjust a contingency table on the know margins of the population with the Raking Ratio method</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Deming, W. &amp; Stephan, F. (1940), On a least squares adjustment of a sampled frequency 
table when the expected marginal totals are known. <em>Annals of Mathematical Statistics</em>, 11, 427-444.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Some example of Ardilly and Tille 
Table &lt;- matrix(c(80,90,10,170,80,80,150,210,130),3,3)
rownames(Table) &lt;- c("a1", "a2","a3")
colnames(Table) &lt;- c("b1", "b2","b3")
# The table with labels
Table
# The known and true margins
Col.knw &lt;- c(150,300,550)
Row.knw &lt;- c(430,360,210)
# The adjusted table
IPFP(Table,Col.knw,Row.knw,tol=0.0001)

############
## Example 2
############
# Draws a simple random sample
data(Lucy)
attach(Lucy)

N&lt;-dim(Lucy)[1]
n&lt;-400
sam&lt;-sample(N,n)
data&lt;-Lucy[sam,]
attach(data)
dim(data)
# Two domains of interest
Doma1&lt;-Domains(Level)
Doma2&lt;-Domains(SPAM)
# Cross tabulate of domains
SPAM.no&lt;-Doma2[,1]*Doma1
SPAM.yes&lt;-Doma2[,2]*Doma1
# Estimation
E.SI(N,n,Doma1)
E.SI(N,n,Doma2)
est1 &lt;-E.SI(N,n,SPAM.no)[,2:4]
est2 &lt;-E.SI(N,n,SPAM.yes)[,2:4]
est1;est2
# The contingency table estimated from above
Table &lt;- cbind(est1[1,],est2[1,])
rownames(Table) &lt;- c("Big", "Medium","Small")
colnames(Table) &lt;- c("SPAM.no", "SPAM.yes")
# The known and true margins
Col.knw &lt;- colSums(Domains(Lucy$SPAM))
Row.knw&lt;- colSums(Domains(Lucy$Level))
# The adjusted table
IPFP(Table,Col.knw,Row.knw,tol=0.0001)
</code></pre>

<hr>
<h2 id='Lucy'>Some Business Population Database</h2><span id='topic+Lucy'></span>

<h3>Description</h3>

<p>This data set corresponds to a random sample of BigLucy. It contains some financial variables of 2396 industrial companies of a city in a particular fiscal year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Lucy)</code></pre>


<h3>Format</h3>


<dl>
<dt>ID</dt><dd><p>The identifier of the company. It correspond to an alphanumeric sequence (two letters and three digits)</p>
</dd>
<dt>Ubication</dt><dd><p>The address of the principal office of the company in the city</p>
</dd>
<dt>Level</dt><dd><p>The industrial companies are discrimitnated according to the Taxes declared. 
There are small, medium and big companies</p>
</dd>
<dt>Zone</dt><dd><p>The city is divided by geoghrafical zones. A company is classified in a particular zone according to its address</p>
</dd>
<dt>Income</dt><dd><p>The total ammount of a company's earnings (or profit) in the previuos fiscal year. It is calculated by taking 
revenues and adjusting for the cost of doing business</p>
</dd>
<dt>Employees</dt><dd><p>The total number of persons working for the company in the previuos fiscal year</p>
</dd>
<dt>Taxes</dt><dd><p>The total ammount of a company's income Tax</p>
</dd>
<dt>SPAM</dt><dd><p>Indicates if the company uses the Internet and WEBmail options in order to make self-propaganda.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BigLucy">BigLucy</a>, <a href="#topic+BigCity">BigCity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Lucy)
attach(Lucy)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
# The population totals
colSums(estima)
# Some parameters of interest
table(SPAM,Level)
xtabs(Income ~ Level+SPAM)
# Correlations among characteristics of interest
cor(estima)
# Some useful histograms
hist(Income)
hist(Taxes)
hist(Employees)
# Some useful plots
boxplot(Income ~ Level)
barplot(table(Level))
pie(table(SPAM))
</code></pre>

<hr>
<h2 id='nk'>Sample Selection Indicator for With Replacement Sampling Designs</h2><span id='topic+nk'></span>

<h3>Description</h3>

<p>The function returns a matrix of <code class="reqn">binom(N+m-1)(m)</code> rows and <code class="reqn">N</code> columns. Creates a matrix of values (0, if the unit does not belongs to a specified sample, 1, if the unit is selected once in the sample; 2, if the unit is selected twice in the sample, etc.) for every possible sample under fixed sample size designs with replacement</p>


<h3>Usage</h3>

<pre><code class='language-R'>nk(N, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nk_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="nk_+3A_m">m</code></td>
<td>
<p>Sample size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">binom(N+m-1)(m)</code> rows and <code class="reqn">N</code> columns. The <code class="reqn">k</code>th column corresponds to the sample 
selection indicator, of the <code class="reqn">k</code>th unit, to a possible sample.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SupportWR">SupportWR</a>, <a href="#topic+Pik">Pik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
m &lt;- 2
# The sample membership matrix for fixed size without replacement sampling designs
nk(N,m)
</code></pre>

<hr>
<h2 id='OrderWR'>Pseudo-Support for Fixed Size With Replacement Sampling Designs</h2><span id='topic+OrderWR'></span>

<h3>Description</h3>

<p>Creates a matrix containing every possible ordered sample under fixed sample size with replacement designs</p>


<h3>Usage</h3>

<pre><code class='language-R'>OrderWR(N,m,ID=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OrderWR_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="OrderWR_+3A_m">m</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="OrderWR_+3A_id">ID</code></td>
<td>
<p>By default FALSE, a vector of values (numeric or string) identifying each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of samples in a with replacement support is not equal to the number
of ordered samples induced by a with replacement sampling design.</p>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">N^m</code> rows and <code class="reqn">m</code> columns. Each row of this matrix
corresponds to a possible ordered sample.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a>. The author acknowledges to Hanwen Zhang for valuable suggestions.</p>


<h3>References</h3>

<p>Tille, Y. (2006), <em>Sampling Algorithms</em>. Springer<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SupportWR">SupportWR</a>, <a href="#topic+Support">Support</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
# Under this context, there are five (5) possible ordered samples
OrderWR(N,1)
# The same output, but labeled
OrderWR(N,1,ID=U)
# y is the variable of interest
y&lt;-c(32,34,46,89,35)
OrderWR(N,1,ID=y)

# If the smaple size is m=2, there are (25) possible ordered samples
OrderWR(N,2)
# The same output, but labeled
OrderWR(N,2,ID=U)
# y is the variable of interest
y&lt;-c(32,34,46,89,35)
OrderWR(N,2,ID=y)

# Note that the number of ordered samples is not equal to the number of 
# samples in a well defined with-replacement support 
OrderWR(N,2)
SupportWR(N,2)

OrderWR(N,4)
SupportWR(N,4)
</code></pre>

<hr>
<h2 id='p.WR'>Generalization of every with replacement sampling design</h2><span id='topic+p.WR'></span>

<h3>Description</h3>

<p>Computes the selection probability (sampling design) of each with replacement sample</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.WR(N, m, pk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.WR_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="p.WR_+3A_m">m</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="p.WR_+3A_pk">pk</code></td>
<td>
<p>A vector containing selection probabilities for each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Every with replacement sampling design is a particular case of a multinomial 
distribution. 
</p>
<p style="text-align: center;"><code class="reqn">p(\mathbf{S}=\mathbf{s})=\frac{m!}{n_1!n_2!\cdots n_N!}\prod_{i=1}^N p_k^{n_k}</code>
</p>

<p>where <code class="reqn">n_k</code> is the number of times that the <code class="reqn">k</code>-th unit is selected in a sample.
</p>


<h3>Value</h3>

<p>The function returns a vector of selection probabilities for every with-replacement sample.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# With replacement simple random sampling
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector pk is the sel?ection probability of the units in the finite population
pk &lt;- c(0.2, 0.2, 0.2, 0.2, 0.2)
sum(pk)
N &lt;- length(pk)
m &lt;- 3
# The smapling design
p &lt;- p.WR(N, m, pk)
p
sum(p)

############
## Example 2
############
# With replacement PPS random sampling
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector x is the auxiliary information and y is the variables of interest
x&lt;-c(32, 34, 46, 89, 35)
y&lt;-c(52, 60, 75, 100, 50)
# Vector pk is the sel?ection probability of the units in the finite population
pk &lt;- x/sum(x)
sum(pk)
N &lt;- length(pk)
m &lt;- 3
# The smapling design
p &lt;- p.WR(N, m, pk)
p
sum(p)
</code></pre>

<hr>
<h2 id='Pik'>Inclusion Probabilities for Fixed Size Without Replacement Sampling Designs</h2><span id='topic+Pik'></span>

<h3>Description</h3>

<p>Computes the first-order inclusion probability of each unit in the population given a
fixed sample size design</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pik(p, Ind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pik_+3A_p">p</code></td>
<td>
<p>A vector containing the selection probabilities of a fixed size without replacement sampling design. The sum of the values of this vector must be one</p>
</td></tr>
<tr><td><code id="Pik_+3A_ind">Ind</code></td>
<td>
<p>A sample membership indicator matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The inclusion probability of the <code class="reqn">k</code>th unit is defined as the probability that this unit will be
included in a sample, it is denoted by <code class="reqn">\pi_k</code> and obtained from a given sampling design as follows:
</p>
<p style="text-align: center;"><code class="reqn">\pi_k=\sum_{s\ni k}p(s)</code>
</p>



<h3>Value</h3>

<p>The function returns a vector of inclusion probabilities for each unit in the finite population.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HT">HT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
# The sample size is n=2
n &lt;- 2
# The sample membership matrix for fixed size without replacement sampling designs
Ind &lt;- Ik(N,n)
# p is the probability of selection of every sample. 
p &lt;- c(0.13, 0.2, 0.15, 0.1, 0.15, 0.04, 0.02, 0.06, 0.07, 0.08)
# Note that the sum of the elements of this vector is one
sum(p)
# Computation of the inclusion probabilities
inclusion &lt;- Pik(p, Ind)
inclusion
# The sum of inclusion probabilities is equal to the sample size n=2
sum(inclusion)
</code></pre>

<hr>
<h2 id='PikHol'>Optimal Inclusion Probabilities Under Multi-purpose Sampling</h2><span id='topic+PikHol'></span>

<h3>Description</h3>

<p>Computes the population vector of optimal inclusion probabilities under the Holmbergs's Approach</p>


<h3>Usage</h3>

<pre><code class='language-R'>PikHol(n, sigma, e, Pi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PikHol_+3A_n">n</code></td>
<td>
<p>Vector of optimal sample sizes for each of the characteristics of interest.</p>
</td></tr>
<tr><td><code id="PikHol_+3A_sigma">sigma</code></td>
<td>
<p>A matrix containing the size measures for each characteristics of interest.</p>
</td></tr>
<tr><td><code id="PikHol_+3A_e">e</code></td>
<td>
<p>Maximum allowed error under the ANOREL approach.</p>
</td></tr>
<tr><td><code id="PikHol_+3A_pi">Pi</code></td>
<td>
<p>Matrix of first order inclusion probabilities. By default, this probabilites are
proportional to each sigma.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assuming that all of the characteristic of interest are equally important, the Holmberg's sampling design
yields the following inclusion probabilities
</p>
<p style="text-align: center;"><code class="reqn">\pi_{(opt)k}=\frac{n^*\sqrt{a_{qk}}}{\sum_{k\in U}\sqrt{a_{qk}}}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">n^*\geq \frac{(\sum_{k\in U}\sqrt{a_{qk}})^2}{(1+c)Q+\sum_{k\in U}a_{qk}}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">a_{qk}= \sum_{q=1}^Q \frac{\sigma^2_{qk}}{\sum_{k\in U}\left( \frac{1}{\pi_{qk}}-1\right)\sigma^2_{qk}}</code>
</p>

<p>Note that <code class="reqn">\sigma^2_{qk}</code> is a size measure associated with the k-th element in the q-th characteristic of interest.
</p>


<h3>Value</h3>

<p>The function returns a vector of inclusion probabilities.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Holmberg, A. (2002), On the Choice of Sampling Design under GREG Estimation in Multiparameter Surveys.
<em>RD Department, Statistics Sweden</em>.<br />
Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#######################
#### First example ####
#######################

# Uses the Lucy data to draw an otpimal sample
# in a multipurpose survey context
data(Lucy)
attach(Lucy)
# Different sample sizes for two characteristics of interest: Employees and Taxes
N &lt;- dim(Lucy)[1]
n &lt;- c(350,400)
# The size measure is the same for both characteristics of interest,
# but the relationship in between is different
sigy1 &lt;- sqrt(Income^(1))
sigy2 &lt;- sqrt(Income^(2))
# The matrix containign the size measures for each characteristics of interest
sigma&lt;-cbind(sigy1,sigy2)
# The vector of optimal inclusion probabilities under the Holmberg's approach
Piks&lt;-PikHol(n,sigma,0.03)
# The optimal sample size is given by the sum of piks
n=round(sum(Piks))
# Performing the S.piPS function in order to select the optimal sample of size n
res&lt;-S.piPS(n,Piks)
sam &lt;- res[,1]
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# Pik.s is the vector of inclusion probability of every single unit
# in the selected sample
Pik.s &lt;- res[,2]
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.piPS(estima,Pik.s)

########################
#### Second example ####
########################

# We can define our own first inclusion probabilities
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- c(350,400)

sigy1 &lt;- sqrt(Income^(1))
sigy2 &lt;- sqrt(Income^(2))
sigma&lt;-cbind(sigy1,sigy2)
pikas &lt;- cbind(rep(400/N, N), rep(400/N, N))

Piks&lt;-PikHol(n,sigma,0.03, pikas)

n=round(sum(Piks))
n

res&lt;-S.piPS(n,Piks)
sam &lt;- res[,1]

data &lt;- Lucy[sam,]
attach(data)
names(data)

Pik.s &lt;- res[,2]
estima &lt;- data.frame(Income, Employees, Taxes)
E.piPS(estima,Pik.s)
</code></pre>

<hr>
<h2 id='Pikl'>Second Order Inclusion Probabilities for Fixed Size Without Replacement Sampling Designs</h2><span id='topic+Pikl'></span>

<h3>Description</h3>

<p>Computes the second-order inclusion probabilities of each par of units in the population given a
fixed sample size design</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pikl(N, n, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pikl_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="Pikl_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="Pikl_+3A_p">p</code></td>
<td>
<p>A vector containing the selection probabilities of a fixed size without replacement sampling design. The sum of the values of this vector must be one</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The second-order inclusion probability of the <code class="reqn">kl</code>th units is defined as the probability that unit <code class="reqn">k</code> and unit 
<code class="reqn">l</code> will be both included in a sample; it is denoted by <code class="reqn">\pi_{kl}</code> and obtained from a given sampling design as follows:
</p>
<p style="text-align: center;"><code class="reqn">\pi_{kl}=\sum_{s\ni k,l}p(s)</code>
</p>



<h3>Value</h3>

<p>The function returns a symmetric matrix of size <code class="reqn">N \times N</code> containing the second-order inclusion probabilities 
for each pair of units in the finite population.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VarHT">VarHT</a>, <a href="#topic+Deltakl">Deltakl</a>, <a href="#topic+Pik">Pik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
# The sample size is n=2
n &lt;- 2
# p is the probability of selection of every sample. 
p &lt;- c(0.13, 0.2, 0.15, 0.1, 0.15, 0.04, 0.02, 0.06, 0.07, 0.08)
# Note that the sum of the elements of this vector is one
sum(p)
# Computation of the second-order inclusion probabilities
Pikl(N, n, p)
</code></pre>

<hr>
<h2 id='PikPPS'>Inclusion Probabilities in Proportional to Size Sampling Designs</h2><span id='topic+PikPPS'></span>

<h3>Description</h3>

<p>For a given sample size, this function returns a vector of first order
inclusion probabilities for a sampling design proportional to an auxiliary variable</p>


<h3>Usage</h3>

<pre><code class='language-R'>PikPPS(n,x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PikPPS_+3A_n">n</code></td>
<td>
<p>Integer indicating the sample size</p>
</td></tr>      
<tr><td><code id="PikPPS_+3A_x">x</code></td>
<td>
<p>Vector of auxiliary information for each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a given vector of auxiliary information with value <code class="reqn">x_k</code> for the <code class="reqn">k</code>-th unit and 
population total <code class="reqn">t_x</code>, the following expression 
</p>
<p style="text-align: center;"><code class="reqn">\pi_k=n\times \frac{x_k}{t_x}</code>
</p>

<p>is not always less than unity. A sequential algorithm must be used in order to ensure that for every
unit in the population the inclusion probability gives less or equal to unity.</p>


<h3>Value</h3>

<p>The function returns a vector of inclusion probabilities of size <code class="reqn">N</code>. 
Every element of this vector is a value between zero and one.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PikHol">PikHol</a>, <a href="#topic+E.piPS">E.piPS</a>, <a href="#topic+S.piPS">S.piPS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
x &lt;- c(30,41,50,170,43,200)
n &lt;- 3
# Two elements yields values bigger than one
n*x/sum(x)
# With this functions, all of the values are between zero and one
PikPPS(n,x)
# The sum is equal to the sample size
sum(PikPPS(n,x))

############
## Example 2
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# The auxiliary information
x &lt;- c(52, 60, 75, 100, 50)
# Gives the inclusion probabilities for the population accordin to a 
# proportional to size design without replacement of size n=4
pik &lt;- PikPPS(4,x)
pik
# The selected sample is
sum(pik)

############
## Example 3
############
# Uses the Lucy data to compute teh vector of inclusion probabilities 
# accordind to a piPS without replacement design
data(Lucy)
attach(Lucy)
# The sample size
n=400
# The selection probability of each unit is proportional to the variable Income
pik &lt;- PikPPS(n,Income)
# The inclusion probabilities of the units in the sample
pik
# The sum of the values in pik is equal to the sample size
sum(pik)
# According to the design some elements must be selected
# They are called forced inclusion units
which(pik==1)
</code></pre>

<hr>
<h2 id='PikSTPPS'>Inclusion Probabilities in Stratified Proportional to Size Sampling Designs</h2><span id='topic+PikSTPPS'></span>

<h3>Description</h3>

<p>For a given sample size, in each stratum, this function returns a vector of first order
inclusion probabilities for an stratified sampling design proportional to an auxiliary variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PikSTPPS(S, x, nh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PikSTPPS_+3A_s">S</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in the population.</p>
</td></tr>
<tr><td><code id="PikSTPPS_+3A_x">x</code></td>
<td>
<p>Vector of auxiliary information for each unit in the population.</p>
</td></tr>
<tr><td><code id="PikSTPPS_+3A_nh">nh</code></td>
<td>
<p>The vector defningn the sample size in each stratum.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>is not always less than unity. A sequential algorithm must be used in order to ensure that for 
every unit in the population the inclusion probability gives a proper value; i.e. less or equal
to unity.
</p>


<h3>Value</h3>

<p>A vector of inclusion probablilities in a stratified finite population.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
Sarndal, C-E. and Swensson, B. and Wretman, J. (2003), <em>Model Assisted Survey Sampling</em>. Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PikHol">PikHol</a>, <a href="#topic+PikPPS">PikPPS</a>, <a href="#topic+S.STpiPS">S.STpiPS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# The auxiliary information
x &lt;- c(52, 60, 75, 100, 50)
# Vector Strata contains an indicator variable of stratum membership
Strata &lt;- c("A", "A", "A", "B", "B")
# The sample size in each stratum
nh &lt;- c(2,2)
# The vector of inclusion probablities for a stratified piPS sample 
# without replacement of size two within each stratum
Pik &lt;- PikSTPPS(Strata, x, nh)
Pik

# Some checks
sum(Pik)
sum(nh)

############
## Example 2
############
# Uses the Lucy data to compute the vector of inclusion probablities 
# for a stratified random sample according to a piPS design in each stratum

data(Lucy)
attach(Lucy)
# Level is the stratifying variable
summary(Level)

# Defines the size of each stratum
N1&lt;-summary(Level)[[1]]
N2&lt;-summary(Level)[[2]]
N3&lt;-summary(Level)[[3]]
N1;N2;N3

# Defines the sample size at each stratum
n1&lt;-70
n2&lt;-100
n3&lt;-200
nh&lt;-c(n1,n2,n3)
nh

# Computes the inclusion probabilities for the stratified population
S &lt;- Level
x &lt;- Employees
Pik &lt;- PikSTPPS(S, x, nh)

# Some checks
sum(Pik)
sum(nh)
</code></pre>

<hr>
<h2 id='S.BE'>Bernoulli Sampling Without Replacement</h2><span id='topic+S.BE'></span>

<h3>Description</h3>

<p>Draws a Bernoulli sample without replacement of expected size $n$ from a population of size $N$</p>


<h3>Usage</h3>

<pre><code class='language-R'>S.BE(N, prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S.BE_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="S.BE_+3A_prob">prob</code></td>
<td>
<p>Inclusion probability for each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The selected sample is drawn according to a sequential procedure algorithm based on an uniform distribution. The Bernoulli
sampling design is not a fixed sample size one.</p>


<h3>Value</h3>

<p>The function returns a vector of size <code class="reqn">N</code>. Each element of this vector indicates if the unit was selected. Then,
if the value of this vector for unit <code class="reqn">k</code> is zero, the unit <code class="reqn">k</code> was not selected in the sample; otherwise, the unit was
selected in the sample.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.<br />
Tille, Y. (2006), <em>Sampling Algorithms</em>. Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.BE">E.BE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Draws a Bernoulli sample without replacement of expected size n=3
# The inlusion probability is 0.6 for each unit in the population
sam &lt;- S.BE(5,0.6)
sam
# The selected sample is
U[sam]

############
## Example 2
############
# Uses the Lucy data to draw a Bernoulli sample

data(Lucy)
attach(Lucy)
N &lt;- dim(Lucy)[1]
# The population size is 2396. If the expected sample size is 400
# then, the inclusion probability must be 400/2396=0.1669
sam &lt;- S.BE(N,0.01669)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
</code></pre>

<hr>
<h2 id='S.piPS'>Probability Proportional to Size Sampling Without Replacement</h2><span id='topic+S.piPS'></span>

<h3>Description</h3>

<p>Draws a probability proportional to size sample without replacement of size <code class="reqn">n</code> from a population of size <code class="reqn">N</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>S.piPS(n, x, e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S.piPS_+3A_x">x</code></td>
<td>
<p>Vector of auxiliary information for each unit in the population</p>
</td></tr>
<tr><td><code id="S.piPS_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="S.piPS_+3A_e">e</code></td>
<td>
<p>By default, a vector of size <code class="reqn">N</code> of independent random numbers drawn from the <code class="reqn">Uniform(0,1)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The selected sample is drawn according to the Sunter method (sequential-list procedure)</p>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">m</code> rows and two columns. Each element of the first column indicates the unit that
was selected. Each element of the second column indicates the selection probability of this unit</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.piPS">E.piPS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# The auxiliary information
x &lt;- c(52, 60, 75, 100, 50)
# Draws a piPS sample without replacement of size n=3
res &lt;- S.piPS(3,x)
res
sam &lt;- res[,1] 
sam
# The selected sample is
U[sam]

############
## Example 2
############
# Uses the Lucy data to draw a random sample of units accordind to a
# piPS without replacement design

data(Lucy)
attach(Lucy)
# The selection probability of each unit is proportional to the variable Income
res &lt;- S.piPS(400,Income)
# The selected sample
sam &lt;- res[,1]
# The inclusion probabilities of the units in the sample
Pik.s &lt;- res[,2]
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
</code></pre>

<hr>
<h2 id='S.PO'>Poisson Sampling</h2><span id='topic+S.PO'></span>

<h3>Description</h3>

<p>Draws a Poisson sample of expected size $n$ from a population of size $N$</p>


<h3>Usage</h3>

<pre><code class='language-R'>S.PO(N, Pik)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S.PO_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="S.PO_+3A_pik">Pik</code></td>
<td>
<p>Vector of inclusion probabilities for each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The selected sample is drawn according to a sequential procedure algorithm based on a uniform distribution. The Poisson
sampling design is not a fixed sample size one.</p>


<h3>Value</h3>

<p>The function returns a vector of size <code class="reqn">N</code>. Each element of this vector indicates if the unit was selected. Then,
if the value of this vector for unit <code class="reqn">k</code> is zero, the unit <code class="reqn">k</code> was not selected in the sample; otherwise, the unit was
selected in the sample.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.<br />
Tille, Y. (2006), <em>Sampling Algorithms</em>. Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.PO">E.PO</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Draws a Bernoulli sample without replacement of expected size n=3
# "Erik" is drawn in every possible sample becuse its inclusion probability is one
Pik &lt;- c(0.5, 0.2, 1, 0.9, 0.5)
sam &lt;- S.PO(5,Pik)
sam
# The selected sample is
U[sam]

############
## Example 2
############
# Uses the Lucy data to draw a Poisson sample
data(Lucy)
attach(Lucy)
N &lt;- dim(Lucy)[1]
n &lt;- 400
Pik&lt;-n*Income/sum(Income)
# None element of Pik bigger than one
which(Pik&gt;1)
# The selected sample
sam &lt;- S.PO(N,Pik)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
</code></pre>

<hr>
<h2 id='S.PPS'>Probability Proportional to Size Sampling With Replacement</h2><span id='topic+S.PPS'></span>

<h3>Description</h3>

<p>Draws a probability proportional to size sample with replacement of size <code class="reqn">m</code> from a population of size <code class="reqn">N</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>S.PPS(m,x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S.PPS_+3A_m">m</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="S.PPS_+3A_x">x</code></td>
<td>
<p>Vector of auxiliary information for each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The selected sample is drawn according to the cumulative total method (sequential-list procedure)</p>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">m</code> rows and two columns. Each element of the first column indicates the unit that
was selected. Each element of the second column indicates the selection probability of this unit</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.PPS">E.PPS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# The auxiliary information
x &lt;- c(52, 60, 75, 100, 50)
# Draws a PPS sample with replacement of size m=3
res &lt;- S.PPS(3,x)
sam &lt;- res[,1]
# The selected sample is
U[sam]

############
## Example 2
############
# Uses the Lucy data to draw a random sample according to a 
# PPS with replacement design
data(Lucy)
attach(Lucy)
# The selection probability of each unit is proportional to the variable Income
m &lt;- 400
res&lt;-S.PPS(400,Income)
# The selected sample
sam &lt;- res[,1]
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
</code></pre>

<hr>
<h2 id='S.SI'>Simple Random Sampling Without Replacement</h2><span id='topic+S.SI'></span>

<h3>Description</h3>

<p>Draws a simple random sample without replacement of size <code class="reqn">n</code> from a population of size <code class="reqn">N</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>S.SI(N, n, e=runif(N))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S.SI_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="S.SI_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>      
<tr><td><code id="S.SI_+3A_e">e</code></td>
<td>
<p>By default, a vector of size <code class="reqn">N</code> of independent random numbers drawn from the <code class="reqn">Uniform(0,1)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The selected sample is drawn according to a selection-rejection (list-sequential) algorithm</p>


<h3>Value</h3>

<p>The function returns a vector of size <code class="reqn">N</code>. Each element of this vector indicates if the unit was selected. Then, 
if the value of this vector for unit <code class="reqn">k</code> is zero, the unit <code class="reqn">k</code> was not selected in the sample; otherwise, the unit was
selected in the sample.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

      
<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Fan, C.T., Muller, M.E., Rezucha, I. (1962), Development of sampling plans by using sequential
(item by item) selection techniques and digital computer, <em>Journal of the American Statistical Association</em>, 57, 387-402.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.SI">E.SI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Fixes the random numbers in order to select a sample
# Ideal for teaching purposes in the blackboard
e &lt;- c(0.4938, 0.7044, 0.4585, 0.6747, 0.0640)
# Draws a simple random sample without replacement of size n=3
sam &lt;- S.SI(5,3,e)
sam
# The selected sample is
U[sam]

############
## Example 2
############
# Uses the Marco and Lucy data to draw a random sample according to a SI design
data(Marco)
data(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
sam&lt;-S.SI(N,n)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
</code></pre>

<hr>
<h2 id='S.STpiPS'>Stratified Sampling Applying Without Replacement piPS Design in all Strata</h2><span id='topic+S.STpiPS'></span>

<h3>Description</h3>

<p>Draws a probability proportional to size simple random sample without 
replacement of size <code class="reqn">n_h</code> in stratum <code class="reqn">h</code> of size <code class="reqn">N_h</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>S.STpiPS(S,x,nh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S.STpiPS_+3A_s">S</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in the population</p>
</td></tr>
<tr><td><code id="S.STpiPS_+3A_x">x</code></td>
<td>
<p>Vector of auxiliary information for each unit in the population</p>
</td></tr>    
<tr><td><code id="S.STpiPS_+3A_nh">nh</code></td>
<td>
<p>Vector of sample size in each stratum</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The selected sample is drawn according to the Sunter method (sequential-list procedure) in each stratum</p>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">n=n_1+\cdots+n_h</code> rows and two columns. Each element of the first column indicates the unit that
was selected. Each element of the second column indicates the inclusion probability of this unit</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.STpiPS">E.STpiPS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# The auxiliary information
x &lt;- c(52, 60, 75, 100, 50)
# Vector Strata contains an indicator variable of stratum membership 
Strata &lt;- c("A", "A", "A", "B", "B")
# Then sample size in each stratum
mh &lt;- c(2,2)
# Draws a stratified PPS sample with replacement of size n=4
res &lt;- S.STPPS(Strata, x, mh)
# The selected sample
sam &lt;- res[,1]
U[sam]
# The selection probability of each unit selected to be in the sample
pk &lt;- res[,2]
pk

############
## Example 2
############
# Uses the Lucy data to draw a stratified random sample 
# according to a piPS design in each stratum

data(Lucy)
attach(Lucy)
# Level is the stratifying variable
summary(Level)

# Defines the size of each stratum
N1&lt;-summary(Level)[[1]]
N2&lt;-summary(Level)[[2]]
N3&lt;-summary(Level)[[3]]
N1;N2;N3

# Defines the sample size at each stratum
n1&lt;-70
n2&lt;-100
n3&lt;-200
nh&lt;-c(n1,n2,n3)
nh
# Draws a stratified sample
S &lt;- Level
x &lt;- Employees

res &lt;- S.STpiPS(S, x, nh)
sam&lt;-res[,1]
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
# The selection probability of each unit selected in the sample
pik &lt;- res[,2]
pik
</code></pre>

<hr>
<h2 id='S.STPPS'>Stratified Sampling Applying PPS Design in all Strata</h2><span id='topic+S.STPPS'></span>

<h3>Description</h3>

<p>Draws a probability proportional to size simple random sample with 
replacement of size <code class="reqn">m_h</code> in stratum <code class="reqn">h</code> of size <code class="reqn">N_h</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>S.STPPS(S,x,mh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S.STPPS_+3A_s">S</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in the population</p>
</td></tr>
<tr><td><code id="S.STPPS_+3A_x">x</code></td>
<td>
<p>Vector of auxiliary information for each unit in the population</p>
</td></tr>    
<tr><td><code id="S.STPPS_+3A_mh">mh</code></td>
<td>
<p>Vector of sample size in each stratum</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The selected sample is drawn according to the cumulative total method (sequential-list procedure) in each stratum</p>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">m=m_1+\cdots+m_h</code> rows and two columns. Each element of the first column indicates the unit that
was selected. Each element of the second column indicates the selection probability of this unit</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.STPPS">E.STPPS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# The auxiliary information
x &lt;- c(52, 60, 75, 100, 50)
# Vector Strata contains an indicator variable of stratum membership 
Strata &lt;- c("A", "A", "A", "B", "B")
# Then sample size in each stratum
mh &lt;- c(2,2)
# Draws a stratified PPS sample with replacement of size n=4
res &lt;- S.STPPS(Strata, x, mh)
# The selected sample
sam &lt;- res[,1]
U[sam]
# The selection probability of each unit selected to be in the sample
pk &lt;- res[,2]
pk

############
## Example 2
############
# Uses the Lucy data to draw a stratified random sample 
# according to a PPS design in each stratum

data(Lucy)
attach(Lucy)
# Level is the stratifying variable
summary(Level)
# Defines the sample size at each stratum
m1&lt;-70
m2&lt;-100
m3&lt;-200
mh&lt;-c(m1,m2,m3)
# Draws a stratified sample
res&lt;-S.STPPS(Level, Income, mh)
# The selected sample
sam&lt;-res[,1]
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
# The selection probability of each unit selected in the sample
pk &lt;- res[,2]
pk
</code></pre>

<hr>
<h2 id='S.STSI'>Stratified sampling applying SI design in all strata</h2><span id='topic+S.STSI'></span>

<h3>Description</h3>

<p>Draws a simple random sample without replacement of size <code class="reqn">n_h</code> in stratum <code class="reqn">h</code> of size <code class="reqn">N_h</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>S.STSI(S, Nh, nh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S.STSI_+3A_s">S</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in the population</p>
</td></tr>
<tr><td><code id="S.STSI_+3A_nh">Nh</code></td>
<td>
<p>Vector of stratum sizes</p>
</td></tr>      
<tr><td><code id="S.STSI_+3A_nh">nh</code></td>
<td>
<p>Vector of sample size in each stratum</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The selected sample is drawn according to a selection-rejection (list-sequential) algorithm in each stratum</p>


<h3>Value</h3>

<p>The function returns a vector of size <code class="reqn">n=n_1+\cdots+n_H</code>. Each element of this vector indicates the unit that was selected.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.STSI">E.STSI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector Strata contains an indicator variable of stratum membership 
Strata &lt;- c("A", "A", "A", "B", "B")
Strata
# The stratum sizes
Nh &lt;- c(3,2)
# Then sample size in each stratum
nh &lt;- c(2,1)
# Draws a stratified simple random sample without replacement of size n=3
sam &lt;- S.STSI(Strata, Nh, nh)
sam
# The selected sample is
U[sam]

############
## Example 2
############
# Uses the Lucy data to draw a stratified random sample
#  accordind to a SI design in each stratum
data(Lucy)
attach(Lucy)
# Level is the stratifying variable
summary(Level)
# Defines the size of each stratum
N1&lt;-summary(Level)[[1]]
N2&lt;-summary(Level)[[2]]
N3&lt;-summary(Level)[[3]]
N1;N2;N3
Nh &lt;- c(N1,N2,N3)
# Defines the sample size at each stratum
n1&lt;-70
n2&lt;-100
n3&lt;-200
nh&lt;-c(n1,n2,n3)
# Draws a stratified sample
sam &lt;- S.STSI(Level, Nh, nh)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
</code></pre>

<hr>
<h2 id='S.SY'>Systematic Sampling</h2><span id='topic+S.SY'></span>

<h3>Description</h3>

<p>Draws a Systematic sample of size $n$ from a population of size $N$</p>


<h3>Usage</h3>

<pre><code class='language-R'>S.SY(N, a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S.SY_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="S.SY_+3A_a">a</code></td>
<td>
<p>Number of groups dividing the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The selected sample is drawn according to a random start.</p>


<h3>Value</h3>

<p>The function returns a vector of size <code class="reqn">n</code>. Each element of this vector indicates the unit that was selected.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a>. The author acknowledges to
Kristina Stodolova <a href="mailto:Kristyna.Stodolova@seznam.cz">Kristyna.Stodolova@seznam.cz</a> for valuable suggestions.</p>


<h3>References</h3>

<p>Madow, L.H. and Madow, W.G. (1944), On the theory of systematic sampling. <em>Annals of Mathematical Statistics</em>. 15, 1-24.<br />
Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling. Springer</em>.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.SY">E.SY</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# The population of size N=5 is divided in a=2 groups
# Draws a Systematic sample. 
sam &lt;- S.SY(5,2)
sam
# The selected sample is
U[sam]
# There are only two possible samples

############
## Example 2
############
# Uses the Lucy data to draw a Systematic sample
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
# The population is divided in 6 groups
# The selected sample
sam &lt;- S.SY(N,6)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
</code></pre>

<hr>
<h2 id='S.WR'>Simple Random Sampling With Replacement</h2><span id='topic+S.WR'></span>

<h3>Description</h3>

<p>Draws a simple random sample witht replacement of size <code class="reqn">m</code> from a population of size <code class="reqn">N</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>S.WR(N, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S.WR_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="S.WR_+3A_m">m</code></td>
<td>
<p>Sample size</p>
</td></tr>      
</table>


<h3>Details</h3>

<p>The selected sample is drawn according to a sequential procedure algorithm based on a binomial distribution</p>


<h3>Value</h3>

<p>The function returns a vector of size <code class="reqn">m</code>. Each element of this vector indicates the unit that was selected.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

      
<p>Tille, Y. (2006), <em>Sampling Algorithms</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E.WR">E.WR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Draws a simple random sample witho replacement of size m=3
sam &lt;- S.WR(5,3)
sam
# The selected sample
U[sam]

############
## Example 2
############
# Uses the Lucy data to draw a random sample of units accordind to a
# simple random sampling with replacement design
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
m &lt;- 400
sam&lt;-S.WR(N,m)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
</code></pre>

<hr>
<h2 id='Support'>Sampling Support for Fixed Size Without Replacement Sampling Designs</h2><span id='topic+Support'></span>

<h3>Description</h3>

<p>Creates a matrix containing every possible sample under fixed sample size designs</p>


<h3>Usage</h3>

<pre><code class='language-R'>Support(N, n, ID=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Support_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="Support_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="Support_+3A_id">ID</code></td>
<td>
<p>By default FALSE, a vector of values (numeric or string) identifying each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A support is defined as the set of samples such that for any sample in the support, all the permutations
of the coordinates of the sample are also in the support</p>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">binom(N)(n)</code> rows and <code class="reqn">n</code> columns. Each row of this matrix 
corresponds to a possible sample</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Tille, Y. (2006), <em>Sampling Algorithms</em>. Springer<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ik">Ik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
n &lt;- 2
# The support for fixed size without replacement sampling designs
# Under this context, there are ten (10) possibles samples
Support(N,n)
# The same support, but labeled
Support(N,n,ID=U)
# y is the variable of interest
y&lt;-c(32,34,46,89,35)
# The following output is very useful when checking 
# the design-unbiasedness of an estimator
Support(N,n,ID=y)
</code></pre>

<hr>
<h2 id='SupportRS'>Sampling Support for Random Size Without Replacement Sampling Designs</h2><span id='topic+SupportRS'></span>

<h3>Description</h3>

<p>Creates a matrix containing every possible sample under random sample size designs</p>


<h3>Usage</h3>

<pre><code class='language-R'>SupportRS(N, ID=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SupportRS_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="SupportRS_+3A_id">ID</code></td>
<td>
<p>By default FALSE, a vector of values (numeric or string) identifying each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A support is defined as the set of samples such that for any sample in the support, all the permutations of the coordinates of the sample are also in the support</p>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">2^N</code> rows and <code class="reqn">N</code> columns. Each row of this matrix corresponds to a possible sample</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Tille, Y. (2006), <em>Sampling Algorithms</em>. Springer<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+IkRS">IkRS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
# The support for fixed size without replacement sampling designs
# Under this context, there are ten (10) possibles samples
SupportRS(N)
# The same support, but labeled
SupportRS(N, ID=U)
# y is the variable of interest
y&lt;-c(32,34,46,89,35)
# The following output is very useful when checking 
# the design-unbiasedness of an estimator
SupportRS(N, ID=y)
</code></pre>

<hr>
<h2 id='SupportWR'>Sampling Support for Fixed Size With Replacement Sampling Designs</h2><span id='topic+SupportWR'></span>

<h3>Description</h3>

<p>Creates a matrix containing every possible sample under fixed sample size with replacement designs</p>


<h3>Usage</h3>

<pre><code class='language-R'>SupportWR(N, m, ID=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SupportWR_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="SupportWR_+3A_m">m</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="SupportWR_+3A_id">ID</code></td>
<td>
<p>By default FALSE, a vector of values (numeric or string) identifying each unit in the population</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A support is defined as the set of samples such that, for any sample in the support, all the permutations
of the coordinates of the sample are also in the support</p>


<h3>Value</h3>

<p>The function returns a matrix of <code class="reqn">binom(N+m-1)(m)</code> rows and <code class="reqn">m</code> columns. Each row of this matrix 
corresponds to a possible sample</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Ortiz, J. E. (2009), <em>Simulacion y metodos estadisticos</em>. Editorial Universidad Santo Tomas. <br />
Tille, Y. (2006), <em>Sampling Algorithms</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Support">Support</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector U contains the label of a population
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
N &lt;- length(U)
m &lt;- 2
# The support for fixed size without replacement sampling designs
# Under this context, there are ten (10) possibles samples
SupportWR(N, m)
# The same support, but labeled
SupportWR(N, m, ID=U)
# y is the variable of interest
y&lt;-c(32,34,46,89,35)
# The following output is very useful when checking 
# the design-unbiasedness of an estimator
SupportWR(N, m, ID=y)
</code></pre>

<hr>
<h2 id='T.SIC'>Computation of Population Totals for Clusters</h2><span id='topic+T.SIC'></span>

<h3>Description</h3>

<p>Computes the population total of the characteristics of interest in clusters. This function is used in order to estimate totals when doing a Pure Cluster Sample.</p>


<h3>Usage</h3>

<pre><code class='language-R'>T.SIC(y,Cluster)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="T.SIC_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every
unit in the selected sample</p>
</td></tr> 
<tr><td><code id="T.SIC_+3A_cluster">Cluster</code></td>
<td>
<p>Vector identifying the membership to the cluster of each unit in the selected sample of clusters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a matrix of clusters totals. The columns of each matrix
correspond to the totals of the variables of interest in each cluster</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S.SI">S.SI</a>, <a href="#topic+E.SI">E.SI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector y1 and y2 are the values of the variables of interest
y1&lt;-c(32, 34, 46, 89, 35)
y2&lt;-c(1,1,1,0,0)
y3&lt;-cbind(y1,y2)
# Vector Cluster contains a indicator variable of cluster membership 
Cluster &lt;- c("C1", "C2", "C1", "C2", "C1")
Cluster
# Draws a stratified simple random sample without replacement of size n=3
T.SIC(y1,Cluster)
T.SIC(y2,Cluster)
T.SIC(y3,Cluster)

########################################################
## Example 2 Sampling and estimation in Cluster smapling
########################################################
# Uses Lucy data to draw a clusters sample according to a SI design
# Zone is the clustering variable
data(Lucy)
attach(Lucy)
summary(Zone)
# The population of clusters
UI&lt;-c("A","B","C","D","E")
NI=length(UI)
# The sample size
nI=2
# Draws a simple random sample of two clusters
samI&lt;-S.SI(NI,nI)
dataI&lt;-UI[samI]
dataI   
# The information about each unit in the cluster is saved in Lucy1 and Lucy2
data(Lucy)
Lucy1&lt;-Lucy[which(Zone==dataI[1]),]
Lucy2&lt;-Lucy[which(Zone==dataI[2]),]
LucyI&lt;-rbind(Lucy1,Lucy2)
attach(LucyI)
# The clustering variable is Zone
Cluster &lt;- as.factor(as.integer(Zone))
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
Ty&lt;-T.SIC(estima,Cluster)
# Estimation of the Population total
E.SI(NI,nI,Ty)
</code></pre>

<hr>
<h2 id='VarHT'>Variance of the Horvitz-Thompson Estimator</h2><span id='topic+VarHT'></span>

<h3>Description</h3>

<p>Computes the theoretical variance of the Horvitz-Thompson estimator given a without replacement fixed sample size design</p>


<h3>Usage</h3>

<pre><code class='language-R'>VarHT(y, N, n, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VarHT_+3A_y">y</code></td>
<td>
<p>Vector containing the recollected information of the characteristic of interest for every unit in the population</p>
</td></tr>
<tr><td><code id="VarHT_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="VarHT_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="VarHT_+3A_p">p</code></td>
<td>
<p>A vector containing the selection probabilities of a fixed size without replacement sampling design. The sum of the values of this vector must be one</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variance of the Horvitz-Thompson estimator, under a given sampling design <code class="reqn">p</code>, is given by 
</p>
<p style="text-align: center;"><code class="reqn">Var_p(\hat{t}_{y,\pi})=\sum_{k\in U}\sum_{l \in U}\Delta_{kl}\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}</code>
</p>



<h3>Value</h3>

<p>The function returns the value of the theoretical variances of the Horviz-Thompson estimator.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HT">HT</a>, <a href="#topic+Deltakl">Deltakl</a>, <a href="#topic+Pikl">Pikl</a>, <a href="#topic+Pik">Pik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Without replacement sampling
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector y1 and y2 are the values of the variables of interest
y1&lt;-c(32, 34, 46, 89, 35)
y2&lt;-c(1,1,1,0,0)
# The population size is N=5
N &lt;- length(U)
# The sample size is n=2
n &lt;- 2
# p is the probability of selection of every possible sample
p &lt;- c(0.13, 0.2, 0.15, 0.1, 0.15, 0.04, 0.02, 0.06, 0.07, 0.08)

# Calculates the theoretical variance of the HT estimator
VarHT(y1, N, n, p)
VarHT(y2, N, n, p)
</code></pre>

<hr>
<h2 id='VarSYGHT'>Two different varaince estimators for the Horvitz-Thompson estimator</h2><span id='topic+VarSYGHT'></span>

<h3>Description</h3>

<p>This function estimates the variance of the Horvitz-Thompson estimator.
Two different variance estimators are computed: the original one, due to Horvitz-Thompson
and the one due to Sen (1953) and Yates, Grundy (1953). 
The two approaches yield unbiased estimator under fixed-size sampling  schemes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VarSYGHT(y, N, n, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VarSYGHT_+3A_y">y</code></td>
<td>
<p>Vector containing the information of the characteristic of interest 
for every unit in the population.</p>
</td></tr>
<tr><td><code id="VarSYGHT_+3A_n">N</code></td>
<td>
<p>Population size.</p>
</td></tr>
<tr><td><code id="VarSYGHT_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="VarSYGHT_+3A_p">p</code></td>
<td>
<p>A vector containing the selection probabilities of a fixed size without replacement sampling design. 
The sum of the values of this vector must be one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns two variance estimator for every possible sample
within a fixed-size sampling support. 
The first estimator is due to Horvitz-Thompson and is given by the following expression:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Var}_1(\hat{t}_{y,\pi}) = \sum_{k \in U}\sum_{l\in U}\frac{\Delta_{kl}}{\pi_{kl}}\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}</code>
</p>

<p>The second estimator is due to Sen (1953) and Yates-Grundy (1953). It is given by the following expression:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Var}_2(\hat{t}_{y,\pi}) = -\frac{1}{2}\sum_{k \in U}\sum_{l\in U}\frac{\Delta_{kl}}{\pi_{kl}}(\frac{y_k}{\pi_k} - \frac{y_l}{\pi_l})^2</code>
</p>



<h3>Value</h3>

<p>This function returns a data frame of every possible sample in 
within a sampling support, with its corresponding variance estimates.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas 
y estimacion de parametros</em>. Editorial Universidad Santo Tomas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1
# Without replacement sampling
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector y1 and y2 are the values of the variables of interest
y1&lt;-c(32, 34, 46, 89, 35)
y2&lt;-c(1,1,1,0,0)
# The population size is N=5
N &lt;- length(U)
# The sample size is n=2
n &lt;- 2
# p is the probability of selection of every possible sample
p &lt;- c(0.13, 0.2, 0.15, 0.1, 0.15, 0.04, 0.02, 0.06, 0.07, 0.08)

# Calculates the estimated variance for the HT estimator
VarSYGHT(y1, N, n, p)
VarSYGHT(y2, N, n, p)

# Unbiasedness holds in the estimator of the total
sum(y1)
sum(VarSYGHT(y1, N, n, p)$p * VarSYGHT(y1, N, n, p)$Est.HT)
sum(y2)
sum(VarSYGHT(y2, N, n, p)$p * VarSYGHT(y2, N, n, p)$Est.HT)

# Unbiasedness also holds in the two variances
VarHT(y1, N, n, p)
sum(VarSYGHT(y1, N, n, p)$p * VarSYGHT(y1, N, n, p)$Est.Var1)
sum(VarSYGHT(y1, N, n, p)$p * VarSYGHT(y1, N, n, p)$Est.Var2)

VarHT(y2, N, n, p)
sum(VarSYGHT(y2, N, n, p)$p * VarSYGHT(y2, N, n, p)$Est.Var1)
sum(VarSYGHT(y2, N, n, p)$p * VarSYGHT(y2, N, n, p)$Est.Var2)

# Example 2: negative variance estimates

x = c(2.5, 2.0, 1.1, 0.5)
N = 4
n = 2
p = c(0.31, 0.20, 0.14, 0.03, 0.01, 0.31)

VarSYGHT(x, N, n, p)

# Unbiasedness holds in the estimator of the total
sum(x)
sum(VarSYGHT(x, N, n, p)$p * VarSYGHT(x, N, n, p)$Est.HT)

# Unbiasedness also holds in the two variances
VarHT(x, N, n, p)
sum(VarSYGHT(x, N, n, p)$p * VarSYGHT(x, N, n, p)$Est.Var1)
sum(VarSYGHT(x, N, n, p)$p * VarSYGHT(x, N, n, p)$Est.Var2)
</code></pre>

<hr>
<h2 id='Wk'>The Calibration Weights</h2><span id='topic+Wk'></span>

<h3>Description</h3>

<p>Computes the calibration weights (Chi-squared distance) for the estimation of the population total of several variables of interest.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Wk(x,tx,Pik,ck,b0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Wk_+3A_x">x</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected auxiliary information for every unit in the selected sample</p>
</td></tr>
<tr><td><code id="Wk_+3A_tx">tx</code></td>
<td>
<p>Vector containing the populations totals of the auxiliary information</p>
</td></tr>
<tr><td><code id="Wk_+3A_pik">Pik</code></td>
<td>
<p>A vector containing inclusion probabilities for each unit in the sample</p>
</td></tr>
<tr><td><code id="Wk_+3A_ck">ck</code></td>
<td>
<p>A vector of weights induced by the structure of variance of the supposed model</p>
</td></tr>
<tr><td><code id="Wk_+3A_b0">b0</code></td>
<td>
<p>By default FALSE. The intercept of the regression model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calibration weights satisfy the following expression
</p>
<p style="text-align: center;"><code class="reqn">\sum_{k\in S}w_kx_k=\sum_{k\in U}x_k</code>
</p>



<h3>Value</h3>

<p>The function returns a vector of calibrated weights.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br />
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>############
## Example 1
############
# Without replacement sampling
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector x is the auxiliary information and y is the variables of interest
x&lt;-c(32, 34, 46, 89, 35)
y&lt;-c(52, 60, 75, 100, 50)
# pik is some vector of inclusion probabilities in the sample
# In this case the sample size is equal to the population size
pik&lt;-rep(1,5)
w1&lt;-Wk(x,tx=236,pik,ck=1,b0=FALSE)
sum(x*w1)
# Draws a sample size without replacement
sam &lt;- sample(5,2)
pik &lt;- c (0.8,0.2,0.2,0.5,0.3)
# The auxiliary information an variable of interest in the selected smaple
x.s&lt;-x[sam]
y.s&lt;-y[sam]
# The vector of inclusion probabilities in the selected smaple
pik.s&lt;-pik[sam]
# Calibration weights under some specifics model
w2&lt;-Wk(x.s,tx=236,pik.s,ck=1,b0=FALSE)
sum(x.s*w2)

w3&lt;-Wk(x.s,tx=c(5,236),pik.s,ck=1,b0=TRUE)
sum(w3)
sum(x.s*w3)

w4&lt;-Wk(x.s,tx=c(5,236),pik.s,ck=x.s,b0=TRUE)
sum(w4)
sum(x.s*w4)

w5&lt;-Wk(x.s,tx=236,pik.s,ck=x.s,b0=FALSE)
sum(x.s*w5)

######################################################################
## Example 2: Linear models involving continuous auxiliary information
######################################################################

# Draws a simple random sample without replacement
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
Pik &lt;- rep(n/N, n)
sam &lt;- S.SI(N,n)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)

########### common ratio model ###################

estima&lt;-data.frame(Income)
x &lt;- Employees
tx &lt;- sum(Lucy$Employees)
w &lt;- Wk(x, tx, Pik, ck=1, b0=FALSE)
sum(x*w)
tx
# The calibration estimation
colSums(estima*w)

########### Simple regression model without intercept ###################

estima&lt;-data.frame(Income, Employees)
x &lt;- Taxes
tx &lt;- sum(Lucy$Taxes)
w&lt;-Wk(x,tx,Pik,ck=x,b0=FALSE)
sum(x*w)
tx
# The calibration estimation
colSums(estima*w)

########### Multiple regression model without intercept ###################

estima&lt;-data.frame(Income)
x &lt;- cbind(Employees, Taxes)
tx &lt;- c(sum(Lucy$Employees), sum(Lucy$Taxes))
w &lt;- Wk(x,tx,Pik,ck=1,b0=FALSE)
sum(x[,1]*w)
sum(x[,2]*w)
tx
# The calibration estimation
colSums(estima*w)

########### Simple regression model with intercept ###################

estima&lt;-data.frame(Income, Employees)
x &lt;- Taxes
tx &lt;- c(N,sum(Lucy$Taxes))
w &lt;- Wk(x,tx,Pik,ck=1,b0=TRUE)
sum(1*w)
sum(x*w)
tx
# The calibration estimation
colSums(estima*w)

########### Multiple regression model with intercept ###################

estima&lt;-data.frame(Income)
x &lt;- cbind(Employees, Taxes)
tx &lt;- c(N, sum(Lucy$Employees), sum(Lucy$Taxes))
w &lt;- Wk(x,tx,Pik,ck=1,b0=TRUE)
sum(1*w)
sum(x[,1]*w)
sum(x[,2]*w)
tx
# The calibration estimation
colSums(estima*w)

####################################################################
## Example 3: Linear models involving discrete auxiliary information
####################################################################

# Draws a simple random sample without replacement
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
n &lt;- 400
sam &lt;- S.SI(N,n)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# Vector of inclusion probabilities for units in the selected sample
Pik&lt;-rep(n/N,n)
# The auxiliary information is discrete type
Doma&lt;-Domains(Level)

########### Poststratified common mean model ###################

estima&lt;-data.frame(Income, Employees, Taxes)
tx &lt;- colSums(Domains(Lucy$Level))
w &lt;- Wk(Doma,tx,Pik,ck=1,b0=FALSE)
sum(Doma[,1]*w)
sum(Doma[,2]*w)
sum(Doma[,3]*w)
tx
# The calibration estimation
colSums(estima*w)

########### Poststratified common ratio model ###################

estima&lt;-data.frame(Income, Employees)
x&lt;-Doma*Taxes
tx &lt;- colSums(Domains(Lucy$Level))
w &lt;- Wk(x,tx,Pik,ck=1,b0=FALSE)
sum(x[,1]*w)
sum(x[,2]*w)
sum(x[,3]*w)
tx
# The calibration estimation
colSums(estima*w)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
