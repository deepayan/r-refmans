<!DOCTYPE html><html><head><title>Help for package msltrend</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {msltrend}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#msltrend'><p>msltrend: A package providing improved techniques to estimate trend, velocity</p>
and acceleration from sea level records.</a></li>
<li><a href='#Balt'><p>Ocean water level data for Baltimore, USA</p></a></li>
<li><a href='#msl.forecast'><p>Projected sea level rise integrated with historical record.</p></a></li>
<li><a href='#msl.pdf'><p>Pdf plotting options.</p></a></li>
<li><a href='#msl.plot'><p>Screen plotting options.</p></a></li>
<li><a href='#msl.trend'><p>Isolate trend component from mean sea level records.</p></a></li>
<li><a href='#s'><p>sample 'msl.trend' object</p></a></li>
<li><a href='#summary'><p>Summary outputs of decomposed time series.</p></a></li>
<li><a href='#t'><p>sample 'msl.forecast' object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Improved Techniques to Estimate Trend, Velocity and Acceleration
from Sea Level Records</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.2)</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-01-11</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of annual average ocean water level time series
    from long (minimum length 80 years) individual records, providing improved
    estimates of trend (mean sea level) and associated real-time velocities and
    accelerations. Improved trend estimates are based on Singular Spectrum Analysis
    methods. Various gap-filling options are included to accommodate incomplete time
    series records. The package also contains a forecasting module to consider the
    implication of user defined quantum of sea level rise between the end of the
    available historical record and the year 2100. A wide range of screen and pdf
    plotting options are available in the package.</td>
</tr>
<tr>
<td>Author:</td>
<td>Phil J Watson &lt;philwatson.slr@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Phil J Watson &lt;philwatson.slr@gmail.com&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>changepoint (&ge; 2.1.1), forecast (&ge; 6.2), plyr (&ge; 1.8.3),
Rssa (&ge; 0.13-1), tseries (&ge; 0.10-34), zoo (&ge; 1.7-12)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-01-12 07:34:12 UTC; z3466903</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-01-12 08:46:00</td>
</tr>
</table>
<hr>
<h2 id='msltrend'>msltrend: A package providing improved techniques to estimate trend, velocity
and acceleration from sea level records.</h2><span id='topic+msltrend'></span><span id='topic+msltrend-package'></span>

<h3>Description</h3>

<p>The 'msltrend' package provides improved estimates of trend (mean sea
level) and associated real-time velocities and accelerations from long (minimum
80 years), individual, annual average ocean water level data records. Improved
trend estimates are based on Singular Spectrum Analysis methods. Various gap-filling
options are included to accommodate incomplete time series records. The package
also contains a forecasting module to consider the implication of user defined
quantum of sea level rise between the end of the available historical record
and the year 2100. A wide range of screen and pdf plotting options are available
within the package.
</p>


<h3>msltrend functions</h3>

<p>The <code><a href="#topic+msl.trend">msl.trend</a></code> function is the key entry point to the package
deconstructing annual average time series data records into a trend and
associated real-time velocities and accelerations, filling necessary internal
structures which facilitate all functions in this package (Refer Watson 2016a,b
for more detail).
</p>
<p>The <code><a href="#topic+msl.forecast">msl.forecast</a></code> function enables a user defined quantum of sea
level rise to be added from the end of the deconstructed historical record to
the year 2100. Similalrly, this function estimates real-time velocities and
accelerations from the start of the available historical record to the year 2100.
</p>


<h3>References</h3>

<p>Watson, P.J., 2016a. Identifying the best performing time series
analytics for sea-level research. In: <em>Time Series Analysis and
Forecasting, Contributions to Statistics</em>, ISBN 978-3-319-28725-6, Springer
International Publishing (in press).
</p>
<p>Watson, P.J., 2016b. How to improve estimates of real-time acceleration in
the mean sea level signal. In: Vila-Concejo, A., Bruce, E., Kennedy, D.M.,
and McCarroll, R.J. (eds.), Proceedings of the 14th International Coastal
Symposium (Sydney, Australia). <em>Journal of Coastal Research</em>,
Special Issue, No. 75. Coconut Creek (Florida), ISSN 0749-0208 (in press).
</p>

<hr>
<h2 id='Balt'>Ocean water level data for Baltimore, USA</h2><span id='topic+Balt'></span>

<h3>Description</h3>

<p>Annual average ocean water level data from Permanent Service for Mean Sea
Level (UK).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Balt)
</code></pre>


<h3>Format</h3>

<p>Time series data file with the first column the year and the second
column the corresponding annual average ocean water level (mm). File contains
112 records spanning the period from 1904 to 2014 with a single missing value
in 1990.</p>


<h3>Details</h3>

<p>The raw (*.csv) form of this data set is used extensively in the
examples throughout this manual.
</p>


<h3>Source</h3>

<p><a href="http://www.psmsl.org/data/obtaining/map.html">Permanent Service
for Mean Sea Level (2015)</a>
</p>


<h3>References</h3>

<p>Holgate, S.J., Matthews, A., Woodworth, P.L., Rickards, L.J.,
Tamisiea, M.E., Bradshaw, E., Foden, P.R., Gordon, K.M., Jevrejeva, S. and
Pugh, J., 2013. New data systems and products at the Permanent Service for
Mean Sea Level. <em>Journal of Coastal Research</em>, 29(3), pp. 493-504.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msl.trend">msl.trend</a></code>, <code><a href="#topic+msl.forecast">msl.forecast</a></code>,
<code><a href="#topic+msl.plot">msl.plot</a></code>, <code><a href="#topic+msl.pdf">msl.pdf</a></code>, <code><a href="#topic+summary">summary</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Balt)
plot(Balt, type = "l", xlab = "Year", ylab = "Annual Average Mean Sea Level (mm)",
main = 'BALTIMORE, USA')
str(Balt) # check structure of data file
</code></pre>

<hr>
<h2 id='msl.forecast'>Projected sea level rise integrated with historical record.</h2><span id='topic+msl.forecast'></span>

<h3>Description</h3>

<p>Projected sea level rise integrated with historical record.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msl.forecast(object, slr = 800, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msl.forecast_+3A_object">object</code></td>
<td>
<p>of class &ldquo;msl.trend&rdquo; (see <code><a href="#topic+msl.trend">msl.trend</a></code> and
<code><a href="#topic+s">s</a></code>).</p>
</td></tr>
<tr><td><code id="msl.forecast_+3A_slr">slr</code></td>
<td>
<p>numeric, enables a user defined amount of projected sea level
rise in millimetres. The user range is [200 to 1500] where 800 is the
default setting.</p>
</td></tr>
<tr><td><code id="msl.forecast_+3A_plot">plot</code></td>
<td>
<p>logical, if &lsquo;TRUE&rsquo; then the original time series is
plotted to the screen along with the trend component, the result of gap
filling (where necessary) and the added quantum of sea level rise
selected. 95% confidence intervals have also been applied. Default = TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This routine adds a user specified quantum of sea level rise
from the end of the deconstructed historical record to the year 2100.
All internal parameters captured in the <code><a href="#topic+msl.trend">msl.trend</a></code> object
are passed directly to <code><a href="#topic+msl.forecast">msl.forecast</a></code>.
</p>


<h3>Value</h3>

<p>An object of class &ldquo;msl.forecast&rdquo; is returned with the
following elements:
</p>

<dl>
<dt><strong>$Station.Name: </strong></dt><dd><p>the name of the data record.</p>
</dd>
<dt><strong>$Summary: </strong></dt><dd><p>a summary data frame of relevant attributes
relating to the trend and the inputted annual average data set extended
to 2100 with projected sea level rise, including:</p>
</dd>
</dl>

<ul>
<li><p>$Year: input data; 
</p>
</li>
<li><p>$MSL: input data; 
</p>
</li>
<li><p>$Trend: mean sea level trend; 
</p>
</li>
<li><p>$TrendSD: standard deviation of the determined mean sea level
trend; 
</p>
</li>
<li><p>$Vel: velocity (or first derivative) of mean sea level trend
(mm/year); 
</p>
</li>
<li><p>$VelSD: standard deviation of the velocity of the mean sea level
trend; 
</p>
</li>
<li><p>$Acc: acceleration (or second derivative) of mean sea level trend
(mm/year/year); 
</p>
</li>
<li><p>$AccSD: standard deviation of the acceleration of the mean sea
level trend; and 
</p>
</li>
<li><p>$FilledTS: gap-filled time series (where necessary). 
</p>
</li></ul>



<dl>
<dt><strong>$Velocity: </strong></dt><dd><p>outputs the peak velocity and the year in
which it occurs.</p>
</dd>
<dt><strong>$Acceleration: </strong></dt><dd><p>outputs the peak acceleration and the
year in which it occurs.</p>
</dd>
<dt><strong>$Historical.Record: </strong></dt><dd><p>outputs details of the start, end
and length of the input data set.</p>
</dd>
<dt><strong>$Historical.Fillgaps: </strong></dt><dd><p>outputs the extent of missing data
(years) in the original record and the gap filling method used (where
necessary).</p>
</dd>
<dt><strong>$Projected.SLR: </strong></dt><dd><p>details the amount of sea level rise
applied between the end of the historical record and the year 2100.</p>
</dd>
<dt><strong>$Bootstrapping.Iterations: </strong></dt><dd><p>outputs the number of
iterations used to generate the respective standard deviations for error
margins.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+msl.trend">msl.trend</a></code>, <code><a href="#topic+msl.plot">msl.plot</a></code>, <code><a href="#topic+msl.pdf">msl.pdf</a></code>,
<code><a href="#topic+summary">summary</a></code>, <code><a href="#topic+Balt">Balt</a></code>, <code><a href="#topic+s">s</a></code>, <code><a href="#topic+t">t</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -------------------------------------------------------------------------
# Isolate trend from Baltimore record, filling gaps with spline interpolation,
# 500 iterations and adding 1000 mm of slr to 2100. Use raw 'Balt.csv' data file.
# Note: ordinarily user would call 'File.csv' direct from working directory
# using the following sample code:
# s &lt;- msl.trend('Balt.csv', fillgaps = 3, iter = 500, 'BALTIMORE, USA')
# t &lt;- msl.forecast(s, slr = 1000)
# -------------------------------------------------------------------------

data(s) # msl.trend object from above-mentioned example
data(t) # msl.forecast object from above-mentioned example
str(t) # check structure of msl.forecast object
msl.plot(s, type=2) # check screen output of gapfilling and trend estimate
msl.plot(t, type=2) # check screen output of adding 1000 mm of sea level rise

</code></pre>

<hr>
<h2 id='msl.pdf'>Pdf plotting options.</h2><span id='topic+msl.pdf'></span>

<h3>Description</h3>

<p>Pdf plotting options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msl.pdf(x, file_name = " ", type = 1, ci = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msl.pdf_+3A_x">x</code></td>
<td>
<p>object of class &ldquo;msl.trend&rdquo; (see <code><a href="#topic+msl.trend">msl.trend</a></code> and
<code><a href="#topic+s">s</a></code>) or &ldquo;msl.forecast&rdquo; (see <code><a href="#topic+msl.forecast">msl.forecast</a></code> and
<code><a href="#topic+t">t</a></code>).</p>
</td></tr>
<tr><td><code id="msl.pdf_+3A_file_name">file_name</code></td>
<td>
<p>is a character string indicating the name of the pdf output
file. If this field is left blank the output file will be automatically saved
in the working directory under the default name &quot;File1.pdf&quot;.</p>
</td></tr>
<tr><td><code id="msl.pdf_+3A_type">type</code></td>
<td>
<p>numeric, enables a user defined input to select the type of chart
to be plotted. The default setting (type = 1) provides 3 charts in the same
plot area with the time series in the top panel, instantaneous velocity in
the middle panel and instantaneous acceleration in the bottom panel. The
alternatives (2, 3 and 4) are single panel plots of time series, instantaneous
velocity and instantaneous acceleration, respectively.</p>
</td></tr>
<tr><td><code id="msl.pdf_+3A_ci">ci</code></td>
<td>
<p>numeric, enables a user defined input to select the type of
confidence interval to be displayed on the plots. The default setting
(ci = 1) corresponds to a 95% confidence interval whilst ci=2 provides a
99% confidence interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This routine provides a range of pdf plotting options for both
&ldquo;msl.trend&rdquo; (see <code><a href="#topic+msl.trend">msl.trend</a></code>) and &ldquo;msl.forecast&rdquo;
(see <code><a href="#topic+msl.forecast">msl.forecast</a></code>) objects. Three panel plots (type 1 or
default) are formatted with width = 16.54 inches and height = 20 inches.
Single panel plots (types 2, 3, 4) are formatted with width = 16.54 inches
and height = 15 inches. All plots are designed to be proportionally correct
when imported into documents and re-sized to the width of a standard A4 page.
The same range of alternative screen plotting options are available via
<code><a href="#topic+msl.plot">msl.plot</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msl.trend">msl.trend</a></code>, <code><a href="#topic+msl.forecast">msl.forecast</a></code>,
<code><a href="#topic+msl.plot">msl.plot</a></code>, <code><a href="#topic+Balt">Balt</a></code>, <code><a href="#topic+s">s</a></code>, <code><a href="#topic+t">t</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -------------------------------------------------------------------------
# Isolate trend from Baltimore record, filling gaps with spline interpolation,
# 500 iterations and adding 1000 mm of slr to 2100. Use raw 'Balt.csv' data file.
# Note: ordinarily user would call 'File.csv' direct from working directory
# using the following sample code:
# s &lt;- msl.trend('Balt.csv', fillgaps = 3, iter = 500, 'BALTIMORE, USA')
# t &lt;- msl.forecast(s, slr = 1000)
# -------------------------------------------------------------------------

data(s) # msl.trend object from above-mentioned example
data(t) # msl.forecast object from above-mentioned example

# default output, 3 panels, 95% confidence intervals.
msl.pdf(s)
# Check 'File1.pdf' in working directory

# pdf plot time series, 95% confidence intervals.
msl.pdf(s, file_name = 'Series.pdf', type = 2)
# Check 'Series.pdf' file in working directory

# pdf plot instantaneous velocity, 95% confidence intervals.
msl.pdf(s, file_name = 'Velocity.pdf', type = 3)
# Check 'Velocity.pdf' file in working directory

# pdf plot instantaneous acceleration, 99% confidence intervals.
msl.pdf(s, file_name = 'Acceleration.pdf', type = 4, ci = 2)
# Check 'Acceleration.pdf' file in working directory

# default output, 3 panels, 95% confidence intervals.
msl.pdf(t, file_name = 'Forecast.pdf')
# Check 'Forecast.pdf' file in working directory

</code></pre>

<hr>
<h2 id='msl.plot'>Screen plotting options.</h2><span id='topic+msl.plot'></span>

<h3>Description</h3>

<p>Screen plotting options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msl.plot(x, type = 1, ci = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msl.plot_+3A_x">x</code></td>
<td>
<p>object of class &ldquo;msl.trend&rdquo; (see <code><a href="#topic+msl.trend">msl.trend</a></code> and
<code><a href="#topic+s">s</a></code>) or &ldquo;msl.forecast&rdquo; (see <code><a href="#topic+msl.forecast">msl.forecast</a></code> and
<code><a href="#topic+t">t</a></code>).</p>
</td></tr>
<tr><td><code id="msl.plot_+3A_type">type</code></td>
<td>
<p>numeric, enables a user defined input to select the type of chart
to be plotted. The default setting (type = 1) provides 3 charts in the same
plot area with the time series in the top panel, instantaneous velocity in
the middle panel and instantaneous acceleration in the bottom panel. The
alternatives (2, 3 and 4) are single panel plots of time series, instantaneous
velocity and instantaneous acceleration, respectively.</p>
</td></tr>
<tr><td><code id="msl.plot_+3A_ci">ci</code></td>
<td>
<p>numeric, enables a user defined input to select the type of
confidence interval to be displayed on the plots. The default setting (ci = 1)
corresponds to a 95% confidence interval whilst ci=2 provides a 99%
confidence interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This routine provides a range of screen plotting options for both
&ldquo;msl.trend&rdquo; (see <code><a href="#topic+msl.trend">msl.trend</a></code>) and &ldquo;msl.forecast&rdquo;
(see <code><a href="#topic+msl.forecast">msl.forecast</a></code>) objects. The same range of alternative pdf
plotting options are available via <code><a href="#topic+msl.pdf">msl.pdf</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msl.trend">msl.trend</a></code>, <code><a href="#topic+msl.forecast">msl.forecast</a></code>,
<code><a href="#topic+msl.pdf">msl.pdf</a></code>, <code><a href="#topic+Balt">Balt</a></code>, <code><a href="#topic+s">s</a></code>, <code><a href="#topic+t">t</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -------------------------------------------------------------------------
# Isolate trend from Baltimore record, filling gaps with spline interpolation,
# 500 iterations and adding 1000 mm of slr to 2100. Use raw 'Balt.csv' data file.
# Note: ordinarily user would call 'File.csv' direct from working directory
# using the following sample code:
# s &lt;- msl.trend('Balt.csv', fillgaps = 3, iter = 500, 'BALTIMORE, USA')
# t &lt;- msl.forecast(s, slr = 1000)
# -------------------------------------------------------------------------

data(s) # msl.trend object from above-mentioned example
data(t) # msl.forecast object from above-mentioned example
msl.plot(s) # default screen plot output, 3 panels, 95% confidence intervals
msl.plot(s, type = 2) # plot time series, 95% confidence intervals
msl.plot(s, type = 3) # plot instantaneous velocity, 95% confidence intervals
msl.plot(s, type = 4, ci = 2) # plot acceleration, 99% confidence intervals
msl.plot(t) # default screen plot output, 3 panels, 95% confidence intervals
msl.plot(t, type = 2) # plot time series, 95% confidence intervals
msl.plot(t, type = 3) # plot instantaneous velocity, 95% confidence intervals
msl.plot(t, type = 4, ci = 2) # plot acceleration, 99% confidence intervals

</code></pre>

<hr>
<h2 id='msl.trend'>Isolate trend component from mean sea level records.</h2><span id='topic+msl.trend'></span>

<h3>Description</h3>

<p>Isolate trend component from mean sea level records.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msl.trend(file, station_name = " ", fillgaps = 1, iter = 10000,
  plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msl.trend_+3A_file">file</code></td>
<td>
<p>csv format input file <strong>with no header row</strong> of annual
average water levels. This file must contain 2 columns with the first column
the time period (in years) and the second column annual average ocean water
levels (in millimetres). Missing data must be denoted by &ldquo;NA&rdquo;. Missing
data and maximum missing data gap are limited to 15% and 5%, respectively,
of the data record. The minimum length data record processed by the package
is 80 years.
</p>
<p><strong>Warning: </strong> If input data files do not conform to these pre-conditions,
the analysis will be terminated. It should be further noted that the existence
of quasi 60 year oscillations in global mean sea level have been well recognised
in the literature. Therefore, in order to be effective for climate change and
sea level research, only input files with a minimum length exceeding 80 years
have been considered in order that the package can identify and isloate such
signals.</p>
</td></tr>
<tr><td><code id="msl.trend_+3A_station_name">station_name</code></td>
<td>
<p>character string, providing the name of the data record.
</p>
<p><strong>Note: </strong>This field can be left blank, however, it is retained for use
in banner labelling of all plotting and pdf outputs.</p>
</td></tr>
<tr><td><code id="msl.trend_+3A_fillgaps">fillgaps</code></td>
<td>
<p>numeric, provides 3 alternative gap filling procedures for
missing data. The default procedure (fillgaps = 1) is based on iterative gap
filling using Singular Spectrum Analysis (refer <code><a href="Rssa.html#topic+igapfill">igapfill</a></code>)
. The alternatives (2 and 3) are based on linear interpolation and cubic
spline interpolation, respectively (refer <code><a href="zoo.html#topic+na.approx">na.approx</a></code>).
</p>
<p><strong>Note: </strong>Gap filled portions of the time series are denoted in red on
the default screen plot. This is done specifically to provide ready visual
observation to discern if the selected gap filling method provides an
appropriate estimate within the gaps in keeping with the remainder of the
historical record. Depending on the nature of the record and extent of gaps,
some trial and error between alternatives might be necessary to optimise gap
filling.</p>
</td></tr>
<tr><td><code id="msl.trend_+3A_iter">iter</code></td>
<td>
<p>numeric, enables a user defined number of iterations for
bootstrapping to determine error margins. The user range is [500 to 10000]
where 10000 is the default setting.
</p>
<p><strong>Warning: </strong>Although the default setting provides a more accurate basis
for estimating error margins, the degree of iterations slows the analysis and
can take several minutes to run.</p>
</td></tr>
<tr><td><code id="msl.trend_+3A_plot">plot</code></td>
<td>
<p>logical, if &lsquo;TRUE&rsquo; then the original time series is
plotted to the screen along with the trend component and the result of gap
filling (where necessary). 95% confidence intervals have also been applied.
Default = TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the key entry point to the package. This function deconstructs
annual average time series data into a trend and associated real-time velocities
and accelerations, filling necessary internal structures to facilitate all
other functions in this package. The trend is isloated using Singular Spectrum
Analysis, in particular, aggregating components whose low frequency band [0 to
0.01] exceed a threshold contribution of 75%. Associated velocities and
accelerations are determined through the fitting of a cubic smoothing spline
to the trend with 1 degree of freedom per every 8 years of record length.
Refer Watson (2016a,b) for more detail.
</p>


<h3>Value</h3>

<p>An object of class &ldquo;msl.trend&rdquo; is returned with the following
elements:
</p>

<dl>
<dt><strong>$Station.Name: </strong></dt><dd><p>the name of the data record.</p>
</dd>
<dt><strong>$Summary: </strong></dt><dd><p>a summary data frame of the relevant attributes
relating to the trend and
the inputted annual average data set, including:</p>
</dd>
</dl>

<ul>
<li><p>$Year: input data; 
</p>
</li>
<li><p>$MSL: input data; 
</p>
</li>
<li><p>$Trend: mean sea level trend; 
</p>
</li>
<li><p>$TrendSD: standard deviation of the determined mean sea level
trend; 
</p>
</li>
<li><p>$Vel: velocity (or first derivative) of mean sea level trend
(mm/year); 
</p>
</li>
<li><p>$VelSD: standard deviation of the velocity of the mean sea level
trend; 
</p>
</li>
<li><p>$Acc: acceleration (or second derivative) of mean sea level trend
(mm/year/year); 
</p>
</li>
<li><p>$AccSD: standard deviation of the acceleration of the mean sea level
trend; 
</p>
</li>
<li><p>$Resids: time series of uncorrelated residuals; and 
</p>
</li>
<li><p>$FilledTS: gap-filled time series (where necessary). 
</p>
</li></ul>



<dl>
<dt><strong>$Velocity: </strong></dt><dd><p>outputs of the peak velocity and the year in
which it occurred.</p>
</dd>
<dt><strong>$Acceleration: </strong></dt><dd><p>outputs of the peak acceleration and the
year in which it occurred.</p>
</dd>
<dt><strong>$Record.Length: </strong></dt><dd><p>outputs details of the start, end and
length of the input data set.</p>
</dd>
<dt><strong>$Fillgaps: </strong></dt><dd><p>outputs the extent of missing data (years) in
the original record and the gap filling method used (where necessary).</p>
</dd>
<dt><strong>$Bootstrapping.Iterations: </strong></dt><dd><p>outputs the number of iterations
used to generate the respective standard deviations for error margins.</p>
</dd>
<dt><strong>$Changepoints: </strong></dt><dd><p>outputs the number and time at which
changepoints in the variance of the uncorrelated residuals occur (if any).
Where changepoints are identified, block bootstrapping procedures are used
with residuals quarantined between changepoints.</p>
</dd>
</dl>



<h3>References</h3>

<p>Watson, P.J., 2016a. Identifying the best performing time series
analytics for sea-level research. In: <em>Time Series Analysis and
Forecasting, Contributions to Statistics</em>, ISBN 978-3-319-28725-6, Springer
International Publishing (in press).
</p>
<p>Watson, P.J., 2016b. How to improve estimates of real-time acceleration in
the mean sea level signal. In: Vila-Concejo, A., Bruce, E., Kennedy, D.M.,
and McCarroll, R.J. (eds.), Proceedings of the 14th International Coastal
Symposium (Sydney, Australia). <em>Journal of Coastal Research</em>,
Special Issue, No. 75. Coconut Creek (Florida), ISSN 0749-0208 (in press).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msl.forecast">msl.forecast</a></code>, <code><a href="#topic+msl.plot">msl.plot</a></code>,
<code><a href="#topic+msl.pdf">msl.pdf</a></code>, <code><a href="#topic+summary">summary</a></code>, <code><a href="#topic+Balt">Balt</a></code>, <code><a href="#topic+s">s</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -------------------------------------------------------------------------
# Isolate trend from Baltimore record, filling gaps with spline interpolation and
# 500 iterations. Use raw 'Balt.csv' data file. Note: ordinarily user would call
# 'File.csv' direct from working directory using the following sample code:
# s &lt;- msl.trend('Balt.csv', fillgaps = 3, iter = 500, 'BALTIMORE, USA') # DONT RUN
# -------------------------------------------------------------------------

data(s) # msl.trend object from above-mentioned example
str(s) # check structure of msl.trend object
msl.plot(s, type=2) # check screen output of gapfilling and trend estimate


</code></pre>

<hr>
<h2 id='s'>sample 'msl.trend' object</h2><span id='topic+s'></span>

<h3>Description</h3>

<p>Output of call to <code><a href="#topic+msl.trend">msl.trend</a></code> used extensively in examples throughout
this Manual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(s)
</code></pre>


<h3>Format</h3>

<p>msl.trend object</p>


<h3>Details</h3>

<p>This <code><a href="#topic+msl.trend">msl.trend</a></code> object is used extensively in the
examples throughout this manual in order to call the object direct rather than
producing the same via original code which can be computationally expensive. This
object results from a decomposition of the Baltimore record, filling gaps with
spline interpolation and using 500 iterations to generate error margins via
bootstrapping.
</p>
<p><strong>Note: </strong>Ordinarily the user would call 'File.csv' direct from working
directory, creating the 'msl.trend' object using the following sample code:
</p>
<p>s &lt;- msl.trend('Balt.csv', fillgaps = 3, iter = 500, 'BALTIMORE, USA') # DON'T RUN
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msl.trend">msl.trend</a></code>, <code><a href="#topic+msl.forecast">msl.forecast</a></code>,
<code><a href="#topic+msl.plot">msl.plot</a></code>, <code><a href="#topic+msl.pdf">msl.pdf</a></code>, <code><a href="#topic+summary">summary</a></code>,
<code><a href="#topic+Balt">Balt</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(s)
str(s) # check structure of object
</code></pre>

<hr>
<h2 id='summary'>Summary outputs of decomposed time series.</h2><span id='topic+summary'></span>

<h3>Description</h3>

<p>Summary outputs of decomposed time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>of class &ldquo;msl.trend&rdquo; (see <code><a href="#topic+msl.trend">msl.trend</a></code>) or
&ldquo;msl.forecast&rdquo; (see <code><a href="#topic+msl.forecast">msl.forecast</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This routine provides a screen summary of the respective outputs
from a <code><a href="#topic+msl.trend">msl.trend</a></code> or <code><a href="#topic+msl.forecast">msl.forecast</a></code> object. The
summary produced is identical to str( ) for an object of class
&ldquo;msl.trend&rdquo; (see <code><a href="#topic+msl.trend">msl.trend</a></code>) or &ldquo;msl.forecast&rdquo;
(see <code><a href="#topic+msl.forecast">msl.forecast</a></code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msl.trend">msl.trend</a></code>, <code><a href="#topic+msl.forecast">msl.forecast</a></code>,
<code><a href="#topic+Balt">Balt</a></code>, <code><a href="#topic+s">s</a></code>, <code><a href="#topic+t">t</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -------------------------------------------------------------------------
# Isolate trend from Baltimore record, filling gaps with spline interpolation,
# 500 iterations and adding 1000 mm of slr to 2100. Use raw 'Balt.csv' data file.
# Note: ordinarily user would call 'File.csv' direct from working directory
# using the following sample code:
# s &lt;- msl.trend('Balt.csv', fillgaps = 3, iter = 500, 'BALTIMORE, USA')
# t &lt;- msl.forecast(s, slr = 1000)
# -------------------------------------------------------------------------

data(s) # msl.trend object from above-mentioned example
data(t) # msl.forecast object from above-mentioned example
summary(s) # summary for object of class 'msl.trend' object
summary(t) # summary for object of class 'msl.forecast' object

</code></pre>

<hr>
<h2 id='t'>sample 'msl.forecast' object</h2><span id='topic+t'></span>

<h3>Description</h3>

<p>Output of call to <code><a href="#topic+msl.forecast">msl.forecast</a></code> used extensively in examples throughout
this Manual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(t)
</code></pre>


<h3>Format</h3>

<p>msl.forecast object</p>


<h3>Details</h3>

<p>This <code><a href="#topic+msl.forecast">msl.forecast</a></code> object is used extensively in the
examples throughout this manual in order to call the object direct rather than
producing the same via original code which can be computationally expensive. This
object results from a decomposition of the Baltimore record, filling gaps with
spline interpolation and using 500 iterations to generate error margins via
bootstrapping (see <code><a href="#topic+s">s</a></code>). This 'msl.trend' object is then parsed to
<code><a href="#topic+msl.forecast">msl.forecast</a></code> with the addition of 1000 millimetres of sea level rise
between the end of the historical record and 2100.
</p>
<p><strong>Note: </strong>Ordinarily the user would call 'File.csv' direct from working
directory, creating the 'msl.trend' object first, then creating the above-mentioned
<code><a href="#topic+msl.forecast">msl.forecast</a></code> object using the following sample code:
</p>
<p>s &lt;- msl.trend('Balt.csv', fillgaps = 3, iter = 500, 'BALTIMORE, USA') # DON'T RUN
</p>
<p>t &lt;- msl.forecast(s, slr = 1000) # DON'T RUN
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msl.trend">msl.trend</a></code>, <code><a href="#topic+msl.forecast">msl.forecast</a></code>,
<code><a href="#topic+msl.plot">msl.plot</a></code>, <code><a href="#topic+msl.pdf">msl.pdf</a></code>, <code><a href="#topic+summary">summary</a></code>,
<code><a href="#topic+Balt">Balt</a></code>, <code><a href="#topic+s">s</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(t)
str(t) # check structure of object
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
