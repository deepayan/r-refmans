<!DOCTYPE html><html><head><title>Help for package versus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {versus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#versus-package'><p>versus: Compare Data Frames</p></a></li>
<li><a href='#compare'><p>Compare two data frames</p></a></li>
<li><a href='#example_df_a'><p>Modified version of <code>datasets::mtcars</code> - version a</p></a></li>
<li><a href='#example_df_b'><p>Modified version of <code>datasets::mtcars</code> - version b</p></a></li>
<li><a href='#slice_diffs'><p>Get rows with differing values</p></a></li>
<li><a href='#slice_unmatched'><p>Get rows in only one table</p></a></li>
<li><a href='#value_diffs'><p>Get the differing values from a comparison</p></a></li>
<li><a href='#versus_tidy_select'><p>Argument type: tidy-select</p></a></li>
<li><a href='#weave_diffs_long'><p>Get differences in context</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Compare Data Frames</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A toolset for interactively exploring the differences between two data frames.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>rlang (&ge; 1.1.0), cli, dplyr (&ge; 1.1.0), glue, tidyselect (&ge;
1.2.0), vctrs (&ge; 0.6.4), tibble, pillar, purrr, collapse (&ge;
2.0.9), data.table</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://eutwt.github.io/versus/">https://eutwt.github.io/versus/</a>, <a href="https://github.com/eutwt/versus">https://github.com/eutwt/versus</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/eutwt/versus/issues">https://github.com/eutwt/versus/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-12 00:13:02 UTC; mbp</td>
</tr>
<tr>
<td>Author:</td>
<td>Ryan Dickerson [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ryan Dickerson &lt;fresh.tent5866@fastmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-12 00:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='versus-package'>versus: Compare Data Frames</h2><span id='topic+versus'></span><span id='topic+versus-package'></span>

<h3>Description</h3>

<p>Compare two tables
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Ryan Dickerson <a href="mailto:fresh.tent5866@fastmail.com">fresh.tent5866@fastmail.com</a> [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://eutwt.github.io/versus/">https://eutwt.github.io/versus/</a>
</p>
</li>
<li> <p><a href="https://github.com/eutwt/versus">https://github.com/eutwt/versus</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/eutwt/versus/issues">https://github.com/eutwt/versus/issues</a>
</p>
</li></ul>


<hr>
<h2 id='compare'>Compare two data frames</h2><span id='topic+compare'></span>

<h3>Description</h3>

<p><code>compare()</code> creates a representation of the differences between two tables,
along with a shallow copy of the tables. This output is used
as the <code>comparison</code> argument when exploring the differences further with other
versus functions e.g. <code style="white-space: pre;">&#8288;slice_*()&#8288;</code> and <code style="white-space: pre;">&#8288;weave_*()&#8288;</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(table_a, table_b, by, allow_both_NA = TRUE, coerce = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_+3A_table_a">table_a</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="compare_+3A_table_b">table_b</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="compare_+3A_by">by</code></td>
<td>
<p>&lt;<code><a href="#topic+versus_tidy_select">tidy-select</a></code>&gt;. Selection of columns to use when matching rows between
<code>.data_a</code> and <code>.data_b</code>. Both data frames must be unique on <code>by</code>.</p>
</td></tr>
<tr><td><code id="compare_+3A_allow_both_na">allow_both_NA</code></td>
<td>
<p>Logical. If <code>TRUE</code> a missing value in both data frames is
considered as equal</p>
</td></tr>
<tr><td><code id="compare_+3A_coerce">coerce</code></td>
<td>
<p>Logical. If <code>FALSE</code> and columns from the input tables have
differing classes, the function throws an error.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt><code>compare()</code></dt><dd><p>A list of data frames having the following elements:
</p>

<dl>
<dt>tables</dt><dd>
<p>A data frame with one row per input table showing the number of rows
and columns in each.
</p>
</dd>
<dt>by</dt><dd>
<p>A data frame with one row per <code>by</code> column showing the class
of the column in each of the input tables.
</p>
</dd>
<dt>intersection</dt><dd>
<p>A data frame with one row per column common to <code>table_a</code> and
<code>table_b</code> and columns &quot;n_diffs&quot; showing the number of values which
are different between the two tables, &quot;class_a&quot;/&quot;class_b&quot; the class of the
column in each table, and &quot;value_diffs&quot; a (nested) data frame showing
the the values in each table which are unequal and the <code>by</code> columns
</p>
</dd>
<dt>unmatched_cols</dt><dd>
<p>A data frame with one row per column which is in one input table but
not the other and columns &quot;table&quot;: which table the column appears in,
&quot;column&quot;: the name of the column, and &quot;class&quot;: the class of the
column.
</p>
</dd>
<dt>unmatched_rows</dt><dd>
<p>A data frame which, for each row present in one input table but not
the other, contains the column &quot;table&quot; showing which table the row appears
in and the <code>by</code> columns for that row.
</p>
</dd>
</dl>

</dd>
</dl>



<h3>data.table inputs</h3>

<p>If the input is a data.table, you may want <code>compare()</code> to make a deep copy instead
of a shallow copy so that future changes to the table don't affect the comparison.
To achieve this, you can set <code>options(versus.copy_data_table = TRUE)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>compare(example_df_a, example_df_b, by = car)

</code></pre>

<hr>
<h2 id='example_df_a'>Modified version of <code>datasets::mtcars</code> - version a</h2><span id='topic+example_df_a'></span>

<h3>Description</h3>

<p>A version of mtcars with some values altered and some rows/columns removed. Not for
informational purposes, used only to demonstrate the comparison of two slightly
different data frames. Since some values were altered at random, the values do
not necessarily reflect the true original values. The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_df_a
</code></pre>


<h3>Format</h3>

<p>A data frame with 9 rows and 9 variables:
</p>

<dl>
<dt>car</dt><dd><p>The rowname in the corresponding <code>datasets::mtcars</code> row</p>
</dd>
<dt>mpg</dt><dd><p>Miles/(US) gallon</p>
</dd>
<dt>cyl</dt><dd><p>Number of cylinders</p>
</dd>
<dt>disp</dt><dd><p>Displacement (cu.in.)</p>
</dd>
<dt>hp</dt><dd><p>Gross horsepower</p>
</dd>
<dt>drat</dt><dd><p>Rear axle ratio</p>
</dd>
<dt>wt</dt><dd><p>Weight (1000 lbs)</p>
</dd>
<dt>vs</dt><dd><p>Engine (0 = V-shaped, 1 = straight)</p>
</dd>
<dt>am</dt><dd><p>Transmission (0 = automatic, 1 = manual)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Sourced from the CRAN datasets package, with modified values. Originally from
Henderson and Velleman (1981), Building multiple regression models interactively. <em>Biometrics</em>, <strong>37</strong>, 391–411.
</p>

<hr>
<h2 id='example_df_b'>Modified version of <code>datasets::mtcars</code> - version b</h2><span id='topic+example_df_b'></span>

<h3>Description</h3>

<p>A version of mtcars with some values altered and some rows/columns removed. Not for
informational purposes, used only to demonstrate the comparison of two slightly
different data frames. Since some values were altered at random, the values do
not necessarily reflect the true original values. The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_df_b
</code></pre>


<h3>Format</h3>

<p>A data frame with 9 rows and 9 variables:
</p>

<dl>
<dt>car</dt><dd><p>The rowname in the corresponding <code>datasets::mtcars</code> row</p>
</dd>
<dt>wt</dt><dd><p>Weight (1000 lbs)</p>
</dd>
<dt>mpg</dt><dd><p>Miles/(US) gallon</p>
</dd>
<dt>hp</dt><dd><p>Gross horsepower</p>
</dd>
<dt>cyl</dt><dd><p>Number of cylinders</p>
</dd>
<dt>disp</dt><dd><p>Displacement (cu.in.)</p>
</dd>
<dt>carb</dt><dd><p>Number of carburetors</p>
</dd>
<dt>drat</dt><dd><p>Rear axle ratio</p>
</dd>
<dt>vs</dt><dd><p>Engine (0 = V-shaped, 1 = straight)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Sourced from the CRAN datasets package, with modified values. Originally from
Henderson and Velleman (1981), Building multiple regression models interactively. <em>Biometrics</em>, <strong>37</strong>, 391–411.
</p>

<hr>
<h2 id='slice_diffs'>Get rows with differing values</h2><span id='topic+slice_diffs'></span>

<h3>Description</h3>

<p>Get rows with differing values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slice_diffs(comparison, table, column = everything())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slice_diffs_+3A_comparison">comparison</code></td>
<td>
<p>The output of <code>compare()</code></p>
</td></tr>
<tr><td><code id="slice_diffs_+3A_table">table</code></td>
<td>
<p>One of <code>"a"</code> or <code>"b"</code> indicating which of the tables used to
create <code>comparison</code> should be sliced</p>
</td></tr>
<tr><td><code id="slice_diffs_+3A_column">column</code></td>
<td>
<p>&lt;<code><a href="#topic+versus_tidy_select">tidy-select</a></code>&gt;. A row will be in the output if
the comparison shows differing values for any columns matching this argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input table is filtered to the rows for which <code>comparison</code>
shows differing values for one of the columns selected by <code>column</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>comp &lt;- compare(example_df_a, example_df_b, by = car)
comp |&gt; slice_diffs("a", mpg)
comp |&gt; slice_diffs("b", mpg)
comp |&gt; slice_diffs("a", c(mpg, disp))
</code></pre>

<hr>
<h2 id='slice_unmatched'>Get rows in only one table</h2><span id='topic+slice_unmatched'></span><span id='topic+slice_unmatched_both'></span>

<h3>Description</h3>

<p>Get rows in only one table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slice_unmatched(comparison, table)

slice_unmatched_both(comparison)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slice_unmatched_+3A_comparison">comparison</code></td>
<td>
<p>The output of <code>compare()</code></p>
</td></tr>
<tr><td><code id="slice_unmatched_+3A_table">table</code></td>
<td>
<p>One of <code>"a"</code> or <code>"b"</code> indicating which of the tables used to
create <code>comparison</code> should be sliced</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>slice_unmatched()</code></td>
<td>
<p>The table identified by <code>table</code> is filtered
to the rows <code>comparison</code> shows as not appearing in the other table</p>
</td></tr>
<tr><td><code>slice_unmatched_both()</code></td>
<td>
<p>The output of <code>slice_unmatched()</code> for both input
tables row-stacked with a column <code>table</code> indicating which table the row
is from. The output contains only columns present in both tables.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>comp &lt;- compare(example_df_a, example_df_b, by = car)
comp |&gt; slice_unmatched("a")
comp |&gt; slice_unmatched("b")

# slice_unmatched(comp, "a") output is the same as
example_df_a |&gt; dplyr::anti_join(example_df_b, by = comp$by$column)

comp |&gt; slice_unmatched_both()
</code></pre>

<hr>
<h2 id='value_diffs'>Get the differing values from a comparison</h2><span id='topic+value_diffs'></span><span id='topic+value_diffs_stacked'></span>

<h3>Description</h3>

<p>Get the differing values from a comparison
</p>


<h3>Usage</h3>

<pre><code class='language-R'>value_diffs(comparison, column)

value_diffs_stacked(comparison, column = everything())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="value_diffs_+3A_comparison">comparison</code></td>
<td>
<p>The output of <code>compare()</code></p>
</td></tr>
<tr><td><code id="value_diffs_+3A_column">column</code></td>
<td>
<p>&lt;<code><a href="#topic+versus_tidy_select">tidy-select</a></code>&gt;. The output will show the differing values
for the provided columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>value_diffs()</code></td>
<td>
<p>A data frame with one row for each element
of <code>col</code> found to be unequal between the input tables (
<code>table_a</code> and <code>table_b</code> from the original <code>compare()</code> output)
The output table has the column specified by <code>column</code> from each of the
input tables, plus the <code>by</code> columns. </p>
</td></tr>
<tr><td><code>value_diffs_stacked()</code>, <code>value_diffs_all()</code></td>
<td>
<p>A data frame containing
the <code>value_diffs()</code> outputs for the specified columns combined row-wise
using <code>dplyr::bind_rows()</code>. If <code>dplyr::bind_rows()</code> is not possible
due to incompatible types, values are converted to character first.
<code>value_diffs_all()</code> is the same as <code>value_diffs_stacked()</code> with
<code>column = everything()</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>comp &lt;- compare(example_df_a, example_df_b, by = car)
value_diffs(comp, disp)
value_diffs_stacked(comp, c(disp, mpg))
</code></pre>

<hr>
<h2 id='versus_tidy_select'>Argument type: tidy-select</h2><span id='topic+versus_tidy_select'></span>

<h3>Description</h3>

<p>This page describes the <code style="white-space: pre;">&#8288;&lt;tidy-select&gt;&#8288;</code> argument modifier which
indicates that the argument uses <strong>tidy selection</strong>, a sub-type of
tidy evaluation. If you've never heard of tidy evaluation before,
start with the practical introduction in
<a href="https://r4ds.hadley.nz/functions.html#data-frame-functions">https://r4ds.hadley.nz/functions.html#data-frame-functions</a> then
then read more about the underlying theory in
<a href="https://rlang.r-lib.org/reference/topic-data-mask.html">https://rlang.r-lib.org/reference/topic-data-mask.html</a>.
</p>


<h3>Overview of selection features</h3>

<p>tidyselect implements a DSL for selecting variables. It provides helpers
for selecting variables:
</p>

<ul>
<li> <p><code>var1:var10</code>: variables lying between <code>var1</code> on the left and <code>var10</code> on the right.
</p>
</li></ul>


<ul>
<li> <p><code><a href="tidyselect.html#topic+starts_with">starts_with(&quot;a&quot;)</a></code>: names that start with <code>"a"</code>.
</p>
</li>
<li> <p><code><a href="tidyselect.html#topic+starts_with">ends_with(&quot;z&quot;)</a></code>: names that end with <code>"z"</code>.
</p>
</li>
<li> <p><code><a href="tidyselect.html#topic+starts_with">contains(&quot;b&quot;)</a></code>: names that contain <code>"b"</code>.
</p>
</li>
<li> <p><code><a href="tidyselect.html#topic+starts_with">matches(&quot;x.y&quot;)</a></code>: names that match regular expression <code>x.y</code>.
</p>
</li>
<li> <p><code><a href="tidyselect.html#topic+starts_with">num_range(x, 1:4)</a></code>: names following the pattern, <code>x1</code>, <code>x2</code>, ..., <code>x4</code>.
</p>
</li>
<li> <p><code><a href="tidyselect.html#topic+all_of">all_of(vars)</a></code>/<code><a href="tidyselect.html#topic+all_of">any_of(vars)</a></code>:
matches names stored in the character vector <code>vars</code>. <code>all_of(vars)</code> will
error if the variables aren't present; <code>any_of(var)</code> will match just the
variables that exist.
</p>
</li>
<li> <p><code><a href="tidyselect.html#topic+everything">everything()</a></code>: all variables.
</p>
</li>
<li> <p><code><a href="tidyselect.html#topic+everything">last_col()</a></code>: furthest column on the right.
</p>
</li>
<li> <p><code><a href="tidyselect.html#topic+where">where(is.numeric)</a></code>: all variables where
<code>is.numeric()</code> returns <code>TRUE</code>.
</p>
</li></ul>

<p>As well as operators for combining those selections:
</p>

<ul>
<li> <p><code>!selection</code>: only variables that don't match <code>selection</code>.
</p>
</li>
<li> <p><code>selection1 &amp; selection2</code>: only variables included in both <code>selection1</code> and <code>selection2</code>.
</p>
</li>
<li> <p><code>selection1 | selection2</code>: all variables that match either <code>selection1</code> or <code>selection2</code>.
</p>
</li></ul>



<h3>Key techniques</h3>


<ul>
<li><p> If you want the user to supply a tidyselect specification in a
function argument, you need to tunnel the selection through the function
argument. This is done by embracing the function argument <code>{{ }}</code>,
e.g <code>unnest(df, {{ vars }})</code>.
</p>
</li>
<li><p> If you have a character vector of column names, use <code>all_of()</code>
or <code>any_of()</code>, depending on whether or not you want unknown variable
names to cause an error, e.g <code>unnest(df, all_of(vars))</code>,
<code>unnest(df, !any_of(vars))</code>.
</p>
</li>
<li><p> To suppress <code style="white-space: pre;">&#8288;R CMD check&#8288;</code> <code>NOTE</code>s about unknown variables use <code>"var"</code>
instead of <code>var</code>:
</p>
</li></ul>

<div class="sourceCode R"><pre># has NOTE
df %&gt;% select(x, y, z)

# no NOTE
df %&gt;% select("x", "y", "z")
</pre></div>

<hr>
<h2 id='weave_diffs_long'>Get differences in context</h2><span id='topic+weave_diffs_long'></span><span id='topic+weave_diffs_wide'></span>

<h3>Description</h3>

<p>Get differences in context
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weave_diffs_long(comparison, column = everything())

weave_diffs_wide(comparison, column = everything())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weave_diffs_long_+3A_comparison">comparison</code></td>
<td>
<p>The output of <code>compare()</code></p>
</td></tr>
<tr><td><code id="weave_diffs_long_+3A_column">column</code></td>
<td>
<p>&lt;<code><a href="#topic+versus_tidy_select">tidy-select</a></code>&gt;. A row will be in the output if
the comparison shows differing values for any columns matching this argument</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>weave_diffs_wide()</code></td>
<td>
<p>The input <code>table_a</code> filtered to rows where
differing values exist for one of the columns selected by <code>column</code>.
The selected columns with differences will be in the result twice, one for
each input table.</p>
</td></tr>
<tr><td><code>weave_diffs_long()</code></td>
<td>
<p>Input tables are filtered to rows where
differing values exist for one of the columns selected by <code>column</code>.
These two sets of rows (one for each input table) are interleaved row-wise.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>comp &lt;- compare(example_df_a, example_df_b, by = car)
comp |&gt; weave_diffs_wide(disp)
comp |&gt; weave_diffs_wide(c(mpg, disp))
comp |&gt; weave_diffs_long(disp)
comp |&gt; weave_diffs_long(c(mpg, disp))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
