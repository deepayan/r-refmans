<!DOCTYPE html><html><head><title>Help for package modelSSE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {modelSSE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#convert.epipara.to.delappara'><p>To convert model parameters</p></a></li>
<li><a href='#COVID19_JanApr2020_HongKong'><p>A dataset of COVID-19 outbreak in Hong Kong</p></a></li>
<li><a href='#d_nextgenclusterdistn'><p>The next-generation cluster size distribution</p></a></li>
<li><a href='#d_offspringdistn'><p>The offspring distribution</p></a></li>
<li><a href='#d_outbreakdistn'><p>The final outbreak size distribution</p></a></li>
<li><a href='#d_reproductiondistn'><p>The distribution of individual reproduction number</p></a></li>
<li><a href='#MERS_2013_MEregion'><p>A dataset of MERS outbreaks in the Middle East region</p></a></li>
<li><a href='#mpox_19801984_DRC'><p>A dataset of mpox outbreaks in DRC</p></a></li>
<li><a href='#overalllikelihood'><p>The likelihood function</p></a></li>
<li><a href='#paraest.MCMC'><p>To estimate model parameters using Markov chain Monte Carlo approach</p></a></li>
<li><a href='#paraest.ML'><p>To estimate model parameters using maximum likelihood approach</p></a></li>
<li><a href='#smallpox_19581973_Europe'><p>A dataset of smallpox outbreaks in Europe</p></a></li>
<li><a href='#tailoffspringQ'><p>The &quot;20/80&quot; rule</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Modelling Infectious Disease Superspreading from Contact Tracing
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-3</td>
</tr>
<tr>
<td>Description:</td>
<td>Comprehensive analytical tools are provided to characterize infectious disease superspreading from contact tracing surveillance data. The underlying theoretical frameworks of this toolkit include branching process with transmission heterogeneity (Lloyd-Smith et al. (2005) &lt;<a href="https://doi.org/10.1038%2Fnature04153">doi:10.1038/nature04153</a>&gt;), case cluster size distribution (Nishiura et al. (2012) &lt;<a href="https://doi.org/10.1016%2Fj.jtbi.2011.10.039">doi:10.1016/j.jtbi.2011.10.039</a>&gt;, Blumberg et al. (2014) &lt;<a href="https://doi.org/10.1371%2Fjournal.ppat.1004452">doi:10.1371/journal.ppat.1004452</a>&gt;, and Kucharski and Althaus (2015) &lt;<a href="https://doi.org/10.2807%2F1560-7917.ES2015.20.25.21167">doi:10.2807/1560-7917.ES2015.20.25.21167</a>&gt;), and decomposition of reproduction number (Zhao et al. (2022) &lt;<a href="https://doi.org/10.1371%2Fjournal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Delaporte</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-07 09:28:10 UTC; zhaoshi</td>
</tr>
<tr>
<td>Author:</td>
<td>Shi Zhao <a href="https://orcid.org/0000-0001-8722-6149"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shi Zhao &lt;zhaoshi.cmsa@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-07 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='convert.epipara.to.delappara'>To convert model parameters</h2><span id='topic+convert.epipara.to.delappara'></span>

<h3>Description</h3>

<p>This function (i.e., <code>convert.epipara.to.delappara()</code>) converts a list of pre-defined epidemiological parameters into a list of statistical parameters,
such that a probability function of Delaporte distribution may recognize, which is for <strong>internal use only</strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert.epipara.to.delappara(
  para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert.epipara.to.delappara_+3A_para">para</code></td>
<td>
<p>A list (<code>list</code>) of epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter can be either a scalar, or a vector.
For the parameters being assigned with values of vectors, the vectors should be of the same length.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td></tr>
<tr><td><code id="convert.epipara.to.delappara_+3A_offspring.type">offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li><p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li><p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li><p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li><p><code>"P"</code> indicates the <em>Poisson</em> distribution.
</p>
</li></ul>

<p>By default, <code>offspring.type = 'D'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For different values of <code>offspring.type</code>,
</p>

<ul>
<li><p>When <code>offspring.type = "D"</code>, no action to the pre-defined epidemiological parameters; 
</p>
</li>
<li><p>When <code>offspring.type = "NB"</code>, we set parameter <code>shift = 0</code> internally; 
</p>
</li>
<li><p>When <code>offspring.type = "G"</code>, we set parameters <code>disp = 1</code> and <code>shift = 0</code> internally; and 
</p>
</li>
<li><p>When <code>offspring.type = "P"</code>, we set parameters <code>disp = +Inf</code> and <code>shift = mean</code> internally. 
</p>
</li></ul>



<h3>Value</h3>

<p>A list of statistical parameters in the format of <code>list(alpha = ?, beta = ?, lambda = ?)</code>
that can be recognized by Delaporte distribution.
</p>


<h3>Note</h3>

<p>It would be difficult to interpret the converted statistical parameters,
and thus we set this function <code>convert.epipara.to.delappara()</code> as a internal function.
We do not recommend the users to use this function externally unless for special reasons.
</p>


<h3>References</h3>

<p>Vose D. Risk analysis: a quantitative guide. John Wiley &amp; Sons. 2008; pp. 618-619. ISBN: 978-0-470-51284-5
</p>


<h3>See Also</h3>

<p><code><a href="Delaporte.html#topic+ddelap">Delaporte</a></code> for the parameterization of Delaporte distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert.epipara.to.delappara(
  para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D'
)
convert.epipara.to.delappara(
  para = list(mean = 1, disp = 1, shift = 0),
  offspring.type = 'G'
)

convert.epipara.to.delappara(
  para = list(mean = c(0.5, 1, 2), disp = c(0.1, 0.1, 0.3), shift = 0.2)
)

</code></pre>

<hr>
<h2 id='COVID19_JanApr2020_HongKong'>A dataset of COVID-19 outbreak in Hong Kong</h2><span id='topic+COVID19_JanApr2020_HongKong'></span>

<h3>Description</h3>

<p>This dataset (i.e., <code>COVID19_JanApr2020_HongKong</code>) contains 290 observations of <strong>offspring case number</strong> generated by one seed case,
which were collected during the coronavirus disease 2019 (COVID-19) outbreak in Hong Kong, China from January to April 2020.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COVID19_JanApr2020_HongKong
</code></pre>


<h3>Format</h3>

<p>A data frame (<code>data.frame</code>) with 290 rows of records, and 2 columns of variables:
</p>

<dl>
<dt><code>obs</code></dt><dd><p>Observations of offspring (or secondary) case numbers generated by each seed case.</p>
</dd>
<dt><code>type</code></dt><dd><p>A categorical variable takes the value &quot;secondary&quot; indicating the type of observations.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Summary of data and outbreak situation of the Severe Respiratory Disease associated with a Novel Infectious Agent,
released by the Centre for Health Protection, Department of Health, the Government of the Hong Kong Special Administrative Region.
See for example, <a href="https://www.coronavirus.gov.hk/eng/index.html">https://www.coronavirus.gov.hk/eng/index.html</a>
</p>


<h3>References</h3>

<p>Adam DC, Wu P, Wong JY, Lau EH, Tsang TK, Cauchemez S, Leung GM, Cowling BJ. Clustering and superspreading potential of SARS-CoV-2 infections in Hong Kong. <em>Nature Medicine</em>. 2020;26(11):1714-1719.
<a href="https://doi.org/10.1038/s41591-020-1092-0">doi:10.1038/s41591-020-1092-0</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(COVID19_JanApr2020_HongKong)
summary(COVID19_JanApr2020_HongKong)
table(COVID19_JanApr2020_HongKong$obs)

</code></pre>

<hr>
<h2 id='d_nextgenclusterdistn'>The next-generation cluster size distribution</h2><span id='topic+d_nextgenclusterdistn'></span><span id='topic+p_nextgenclusterdistn'></span><span id='topic+q_nextgenclusterdistn'></span><span id='topic+r_nextgenclusterdistn'></span>

<h3>Description</h3>

<p>Density, cumulative distribution, quantile, and random variable generating functions for the <strong>next-generation cluster size</strong> distribution with pre-defined epidemiological parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_nextgenclusterdistn(
  x = 5,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = FALSE
)

p_nextgenclusterdistn(
  q = 10.5,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  lower.tail = TRUE,
  is.log = FALSE
)

q_nextgenclusterdistn(
  p = 0.8,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  lower.tail = TRUE
)

r_nextgenclusterdistn(
  n = 10,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_nextgenclusterdistn_+3A_x">x</code></td>
<td>
<p>A scalar, or a vector of positive integer, for the next-generation cluster size.  The value of <code>x</code> must be not less than <code>seed.size</code>.</p>
</td></tr>
<tr><td><code id="d_nextgenclusterdistn_+3A_seed.size">seed.size</code></td>
<td>
<p>A scalar, or a vector of positive integer.
For vector type of <code>seed.size</code>, it only applies to <code>d_nextgenclusterdistn()</code>, <code>p_nextgenclusterdistn()</code>, and <code>q_nextgenclusterdistn()</code>.
If <code>seed.size</code> and <code>x</code>, <code>q</code> or <code>p</code> are vectors, <code>seed.size</code> should be of the same length as <code>x</code>, <code>q</code> or <code>p</code>.</p>
</td></tr>
<tr><td><code id="d_nextgenclusterdistn_+3A_epi.para">epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter can be either a scalar, or a vector.
For the parameters being assigned with values of vectors, the vectors should be of the same length.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td></tr>
<tr><td><code id="d_nextgenclusterdistn_+3A_offspring.type">offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li><p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li><p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li><p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li><p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li></ul>

<p>By default, <code>offspring.type = 'D'</code>.</p>
</td></tr>
<tr><td><code id="d_nextgenclusterdistn_+3A_is.log">is.log</code></td>
<td>
<p>A logical variable, under which probability would be taken natural logarithm, if <code>is.log = TRUE</code>.
By default, <code>is.log = FALSE</code>.</p>
</td></tr>
<tr><td><code id="d_nextgenclusterdistn_+3A_q">q</code></td>
<td>
<p>A scalar, or a vector of positive number (not necessarily integer), for the next-generation cluster size. The value of <code>q</code> must be not less than <code>seed.size</code>.</p>
</td></tr>
<tr><td><code id="d_nextgenclusterdistn_+3A_lower.tail">lower.tail</code></td>
<td>
<p>A logical variable, under which the probability is cumulative distribution function (CDF, i.e., <em>P(X &lt;= x)</em>), if <code>lower.tail = TRUE</code>, and otherwise, 1 - CDF (i.e., <em>P(X &gt; x)</em>).
By default, <code>lower.tail = TRUE</code>.</p>
</td></tr>
<tr><td><code id="d_nextgenclusterdistn_+3A_p">p</code></td>
<td>
<p>A scalar, or a vector of probability (i.e., ranging from 0 to 1).</p>
</td></tr>
<tr><td><code id="d_nextgenclusterdistn_+3A_n">n</code></td>
<td>
<p>A scalar of positive integer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>d_nextgenclusterdistn()</code> returns the probability of having a next-generation case cluster with size <code>x</code> generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>p_nextgenclusterdistn()</code> returns the probability of having a next-generation case cluster with size less than or equal to, or larger than <code>q</code> (depending on the value of <code>lower.tail</code>), generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>q_nextgenclusterdistn()</code> returns a value such that there is a probability of <code>p</code> for having a next-generation case cluster with size less than or equal to, or larger than this value (depending on the value of <code>lower.tail</code>) generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>r_nextgenclusterdistn()</code> returns a set of random variables of <code>n</code> next-generation cluster size, given (<code>seed.size</code>).
</p>


<h3>Value</h3>

<p>For the values returned from the four functions,
</p>

<ul>
<li><p><code>d_nextgenclusterdistn()</code> is the <em>probability mass function</em> (PMF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li><p><code>p_nextgenclusterdistn()</code> is the <em>cumulative distribution function</em> (CDF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li><p><code>q_nextgenclusterdistn()</code> is the <em>quantile function</em>, and it returns value of quantile (positive integer); and 
</p>
</li>
<li><p><code>r_nextgenclusterdistn()</code> is the <em>random variable generating function</em>, and it generates a set of <code>n</code> random variables (positive integers). 
</p>
</li></ul>



<h3>Note</h3>

<p>Depending on the values of parameters, the functions could take hours to complete, given the double-summation nature for the Delaporte distribution.
</p>


<h3>References</h3>

<p>Blumberg S, Lloyd-Smith JO. Inference of R 0 and transmission heterogeneity from the size distribution of stuttering chains. <em>PLoS Computational Biology</em>. 2013 May 2;9(5):e1002993.
<a href="https://doi.org/10.1371/journal.pcbi.1002993">doi:10.1371/journal.pcbi.1002993</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>See Also</h3>

<p><code><a href="Delaporte.html#topic+ddelap">Delaporte</a></code> for the parameterization of Delaporte distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Please see the "Usage" section.

</code></pre>

<hr>
<h2 id='d_offspringdistn'>The offspring distribution</h2><span id='topic+d_offspringdistn'></span><span id='topic+p_offspringdistn'></span><span id='topic+q_offspringdistn'></span><span id='topic+r_offspringdistn'></span>

<h3>Description</h3>

<p>Density, cumulative distribution, quantile, and random variable generating functions for the <strong>offspring</strong> distribution with pre-defined epidemiological parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_offspringdistn(
  x = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = FALSE
)

p_offspringdistn(
  q = 1.5,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = FALSE,
  lower.tail = TRUE
)

q_offspringdistn(
  p = 0.8,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  lower.tail = TRUE
)

r_offspringdistn(
  n = 10,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_offspringdistn_+3A_x">x</code></td>
<td>
<p>A scalar, or a vector of non-negative integer.</p>
</td></tr>
<tr><td><code id="d_offspringdistn_+3A_epi.para">epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter can be either a scalar, or a vector.
For the parameters being assigned with values of vectors, the vectors should be of the same length.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td></tr>
<tr><td><code id="d_offspringdistn_+3A_offspring.type">offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li><p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li><p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li><p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li><p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li></ul>

<p>By default, <code>offspring.type = 'D'</code>.</p>
</td></tr>
<tr><td><code id="d_offspringdistn_+3A_is.log">is.log</code></td>
<td>
<p>A logical variable, under which probability would be taken natural logarithm, if <code>is.log = TRUE</code>.
By default, <code>is.log = FALSE</code>.</p>
</td></tr>
<tr><td><code id="d_offspringdistn_+3A_q">q</code></td>
<td>
<p>A scalar, or a vector of non-negative number (not necessarily integer).</p>
</td></tr>
<tr><td><code id="d_offspringdistn_+3A_lower.tail">lower.tail</code></td>
<td>
<p>A logical variable, under which the probability is cumulative distribution function (CDF, i.e., <em>P(X &lt;= x)</em>), if <code>lower.tail = TRUE</code>, and otherwise, 1 - CDF (i.e., <em>P(X &gt; x)</em>).
By default, <code>lower.tail = TRUE</code>.</p>
</td></tr>
<tr><td><code id="d_offspringdistn_+3A_p">p</code></td>
<td>
<p>A scalar, or a vector of probability (i.e., ranging from 0 to 1).</p>
</td></tr>
<tr><td><code id="d_offspringdistn_+3A_n">n</code></td>
<td>
<p>A scalar of positive integer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For different values of <code>offspring.type</code>,
</p>

<ul>
<li><p>When <code>offspring.type = "D"</code>, no action to any parameter; 
</p>
</li>
<li><p>When <code>offspring.type = "NB"</code>, we set parameter <code>shift = 0</code>; 
</p>
</li>
<li><p>When <code>offspring.type = "G"</code>, we set parameters <code>disp = 1</code> and <code>shift = 0</code>; and 
</p>
</li>
<li><p>When <code>offspring.type = "P"</code>, we set parameters <code>disp = +Inf</code> and <code>shift = mean</code>. 
</p>
</li></ul>



<h3>Value</h3>

<p>For the values returned from the four functions,
</p>

<ul>
<li><p><code>d_offspringdistn()</code> is the <em>probability mass function</em> (PMF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li><p><code>p_offspringdistn()</code> is the <em>cumulative distribution function</em> (CDF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li><p><code>q_offspringdistn()</code> is the <em>quantile function</em>, and it returns value of quantile (non-negative integer); and 
</p>
</li>
<li><p><code>r_offspringdistn()</code> is the <em>random variable generating function</em>, and it generates a set of <code>n</code> random variables (non-negative integers). 
</p>
</li></ul>



<h3>Note</h3>

<p>Depending on the values of parameters, the functions could take hours to complete, given the double-summation nature for the Delaporte distribution.
</p>


<h3>References</h3>

<p>Vose D. Risk analysis: a quantitative guide. John Wiley &amp; Sons. 2008; pp. 618-619. ISBN: 978-0-470-51284-5
</p>
<p>Lloyd-Smith JO, Schreiber SJ, Kopp PE, Getz WM. Superspreading and the effect of individual variation on disease emergence. <em>Nature</em>. 2005;438(7066):355-359.
<a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>See Also</h3>

<p><code><a href="Delaporte.html#topic+ddelap">Delaporte</a></code> for the parameterization of Delaporte distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Please see the "Usage" section.


## the following returns the proportion of index cases that generated at least 1 offspring cases.
p_offspringdistn(
  q = 0,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D', lower.tail = FALSE
)

## reproducing the results in Adam, et al. (2020)
## paper doi link: https://doi.org/10.1038/s41591-020-1092-0 (see Fig 3b),
## where the number of offspring cases were fitted
## with parameter R of 0.58 and k of 0.43 under NB distribution.
data(COVID19_JanApr2020_HongKong)
hist(
  COVID19_JanApr2020_HongKong$obs, breaks = c(0:100) -0.5, xlim = c(0,12),
  freq = FALSE, xlab = 'secondary cases', ylab = 'rel. freq.', main = ''
)
lines(0:12, d_offspringdistn(
  x = 0:12,
  epi.para = list(mean = 0.58, disp = 0.43, shift = 0.2),
  offspring.type = "NB"
), pch = 20, type = 'o', lty = 2)


## an example to generate 100 rv of offspring case number
table(r_offspringdistn(
  n = 100,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D'
))

</code></pre>

<hr>
<h2 id='d_outbreakdistn'>The final outbreak size distribution</h2><span id='topic+d_outbreakdistn'></span><span id='topic+p_outbreakdistn'></span><span id='topic+q_outbreakdistn'></span><span id='topic+r_outbreakdistn'></span>

<h3>Description</h3>

<p>Density, cumulative distribution, quantile, and random variable generating functions for the <strong>final outbreak size</strong> distribution with pre-defined epidemiological parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_outbreakdistn(
  x = 10,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = FALSE
)

p_outbreakdistn(
  q = 30.5,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  lower.tail = TRUE,
  is.log = FALSE
)

q_outbreakdistn(
  p = 0.8,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  lower.tail = TRUE,
  upr.limit = 1000
)

r_outbreakdistn(
  n = 10,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  upr.limit = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_outbreakdistn_+3A_x">x</code></td>
<td>
<p>A scalar, or a vector of final outbreak size, which is positive integer. The value of <code>x</code> must be not less than <code>seed.size</code>.</p>
</td></tr>
<tr><td><code id="d_outbreakdistn_+3A_seed.size">seed.size</code></td>
<td>
<p>A scalar, or a vector of positive integer.
For vector type of <code>seed.size</code>, it only applies to <code>d_outbreakdistn()</code>, and <code>p_outbreakdistn()</code>.
If <code>seed.size</code> and <code>x</code> or <code>q</code> are vectors, <code>seed.size</code> should be of the same length as <code>x</code> or <code>q</code>.</p>
</td></tr>
<tr><td><code id="d_outbreakdistn_+3A_epi.para">epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter must be a scalar.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td></tr>
<tr><td><code id="d_outbreakdistn_+3A_offspring.type">offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li><p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li><p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li><p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li><p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li></ul>

<p>By default, <code>offspring.type = 'D'</code>.</p>
</td></tr>
<tr><td><code id="d_outbreakdistn_+3A_is.log">is.log</code></td>
<td>
<p>A logical variable, under which probability would be taken natural logarithm, if <code>is.log = TRUE</code>.
By default, <code>is.log = FALSE</code>.</p>
</td></tr>
<tr><td><code id="d_outbreakdistn_+3A_q">q</code></td>
<td>
<p>A scalar, or a vector of positive number (not necessarily integer). The value of <code>q</code> must be not less than <code>seed.size</code>.</p>
</td></tr>
<tr><td><code id="d_outbreakdistn_+3A_lower.tail">lower.tail</code></td>
<td>
<p>A logical variable, under which the probability is cumulative distribution function (CDF, i.e., <em>P(X &lt;= x)</em>), if <code>lower.tail = TRUE</code>, and otherwise, 1 - CDF (i.e., <em>P(X &gt; x)</em>).
By default, <code>lower.tail = TRUE</code>.</p>
</td></tr>
<tr><td><code id="d_outbreakdistn_+3A_p">p</code></td>
<td>
<p>A scalar, or a vector of probability (i.e., ranging from 0 to 1).</p>
</td></tr>
<tr><td><code id="d_outbreakdistn_+3A_upr.limit">upr.limit</code></td>
<td>
<p>A positive integer.
If the result final outbreak size is larger than <code>upr.limit</code>, the returned value will be set as &quot;<code>&gt; upr.limit</code>&quot;.
The value of <code>upr.limit</code> must be larger than <code>seed.size</code>.
By default, <code>upr.limit = 1000</code>, and no need to change the default setting here unless for special reasons.</p>
</td></tr>
<tr><td><code id="d_outbreakdistn_+3A_n">n</code></td>
<td>
<p>A scalar of positive integer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>d_outbreakdistn()</code> returns the probability of having an outbreak with final size <code>x</code> generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>p_outbreakdistn()</code> returns the probability of having an outbreak with final size less than or equal to, or larger than <code>q</code> (depending on the value of <code>lower.tail</code>), generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>q_outbreakdistn()</code> returns a value such that there is a probability of <code>p</code> for having a final outbreak size less than or equal to, or larger than this value (depending on the value of <code>lower.tail</code>) generated by <code>seed.size</code> index cases, where (<code>seed.size</code>) is given.
</p>
<p>Function <code>r_outbreakdistn()</code> returns a set of <code>n</code> random variables of final outbreak size, given (<code>seed.size</code>).
</p>


<h3>Value</h3>

<p>For the values returned from the four functions,
</p>

<ul>
<li><p><code>d_outbreakdistn()</code> is the <em>probability mass function</em> (PMF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li><p><code>p_outbreakdistn()</code> is the <em>cumulative distribution function</em> (CDF), and it returns value of probability (i.e., ranging from 0 to 1); 
</p>
</li>
<li><p><code>q_outbreakdistn()</code> is the <em>quantile function</em>, and it returns value of quantile (positive integer); and 
</p>
</li>
<li><p><code>r_outbreakdistn()</code> is the <em>random variable generating function</em>, and it generates a set of <code>n</code> random variables (positive integers). 
</p>
</li></ul>

<p>Specially, due to the computational consumption, an upper limit was set for the functions <code>q_outbreakdistn()</code> and <code>r_outbreakdistn()</code>,
i.e., <code>upr.limit</code>, and thus, both functions here return value in string form (i.e., <code>character</code>).
</p>


<h3>Note</h3>

<p>Each parameter in <code>epi.para = list(mean = ?, disp = ?, shift = ?)</code> should be a scalar, which means vector is not allowed here.
</p>
<p>When <code>q</code> is large, e.g., <code>q</code> &gt; 10000, the function <code>p_outbreakdistn()</code> could take few seconds, or even minutes to complete.
</p>
<p>When <code>upr.limit</code> is large, e.g., <code>upr.limit</code> &gt; 10000, the functions <code>q_outbreakdistn()</code> and <code>r_outbreakdistn()</code> could take few seconds, or even minutes to complete.
Thus, we do not recommend the users to change the default setting of <code>upr.limit</code> unless for special reasons.
</p>


<h3>References</h3>

<p>Farrington CP, Kanaan MN, Gay NJ. Branching process models for surveillance of infectious diseases controlled by mass vaccination. <em>Biostatistics</em>. 2003;4(2):279-95.
<a href="https://doi.org/10.1093/biostatistics/4.2.279">doi:10.1093/biostatistics/4.2.279</a>
</p>
<p>Nishiura H, Yan P, Sleeman CK, Mode CJ. Estimating the transmission potential of supercritical processes based on the final size distribution of minor outbreaks. <em>Journal of Theoretical Biology</em>. 2012;294:48-55.
<a href="https://doi.org/10.1016/j.jtbi.2011.10.039">doi:10.1016/j.jtbi.2011.10.039</a>
</p>
<p>Blumberg S, Funk S, Pulliam JR. Detecting differential transmissibilities that affect the size of self-limited outbreaks. <em>PLoS Pathogens</em>. 2014;10(10):e1004452.
<a href="https://doi.org/10.1371/journal.ppat.1004452">doi:10.1371/journal.ppat.1004452</a>
</p>
<p>Kucharski AJ, Althaus CL. The role of superspreading in Middle East respiratory syndrome coronavirus (MERS-CoV) transmission. <em>Eurosurveillance</em>. 2015;20(25):21167.
<a href="https://doi.org/10.2807/1560-7917.ES2015.20.25.21167">doi:10.2807/1560-7917.ES2015.20.25.21167</a>
</p>
<p>Endo A, Abbott S, Kucharski AJ, Funk S. Estimating the overdispersion in COVID-19 transmission using outbreak sizes outside China. <em>Wellcome Open Research</em>. 2020;5:67.
<a href="https://doi.org/10.12688/wellcomeopenres.15842.3">doi:10.12688/wellcomeopenres.15842.3</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+d_offspringdistn">d_offspringdistn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## an example to generate 1000 rv of final outbreak size
table(r_outbreakdistn(
  n = 1000,
  seed.size = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  upr.limit = 10
))




## an attempt to reproduce the results in Guo, et al. (2022)
## paper doi link: https://doi.org/10.1016/j.jinf.2022.05.041 (see Fig 1B),
## where the probability of one seed case generating an outbreak with final size &gt;= a given number,
## with parameter R of 0.78 and k of 0.10 under NB distribution.
plot(1:100, 1 - c(0,cumsum(d_outbreakdistn(
  x = 1:99,
  seed.size = 1,
  epi.para = list(mean = 0.78, disp = 0.10, shift = 0.2),
  offspring.type = "NB",
))), log = 'y', type = 'l', xlab = 'outbreak size', ylab = 'probability')
plot(1:100, c(1,p_outbreakdistn(
  q = 1:99,
  seed.size = 1,
  epi.para = list(mean = 0.78, disp = 0.10, shift = 0.2),
  offspring.type = "NB",
  lower.tail = FALSE
)), log = 'y', type = 'l', xlab = 'outbreak size', ylab = 'probability')



</code></pre>

<hr>
<h2 id='d_reproductiondistn'>The distribution of individual reproduction number</h2><span id='topic+d_reproductiondistn'></span>

<h3>Description</h3>

<p>This function (i.e., <code>d_reproductiondistn()</code>) is the probability density function (PDF) of <strong>individual reproduction number</strong> that was modelled as a shifted gamma distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_reproductiondistn(
  x = 1,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_reproductiondistn_+3A_x">x</code></td>
<td>
<p>A scalar, or a vector of non-negative integer.</p>
</td></tr>
<tr><td><code id="d_reproductiondistn_+3A_epi.para">epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter can be either a scalar, or a vector.
For the parameters being assigned with values of vectors, the vectors should be of the same length.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td></tr>
<tr><td><code id="d_reproductiondistn_+3A_offspring.type">offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li><p><code>"D"</code> indicates the Delaporte distribution for offspring cases, where reproduction number follows a <em>shifted gamma</em> distribution; 
</p>
</li>
<li><p><code>"NB"</code> indicates the negative binomial distribution for offspring cases, where reproduction number follows a (non-shifted, or standard) <em>gamma</em> distribution; 
</p>
</li>
<li><p><code>"G"</code> indicates the geometric distribution for offspring cases, where reproduction number follows an <em>exponential</em> distribution; or 
</p>
</li>
<li><p><code>"P"</code> indicates the Poisson distribution for offspring cases, where reproduction number follows a <em>Dirac delta</em> distribution. 
</p>
</li></ul>

<p>By default, <code>offspring.type = 'D'</code>.</p>
</td></tr>
<tr><td><code id="d_reproductiondistn_+3A_is.log">is.log</code></td>
<td>
<p>A logical variable, under which probability would be taken natural logarithm, if <code>is.log = TRUE</code>.
By default, <code>is.log = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>d_reproductiondistn()</code> is the probability density function (PDF), and it returns value of probability density (non-negative value).
</p>


<h3>Note</h3>

<p>Only the PDF of individual reproduction number (i.e., <code>d_reproductiondistn()</code>) was created here (without cumulative distribution, quantile, or random variable generating functions).
The function <code>d_reproductiondistn()</code> was used mainly for data visualization purpose (rather than using for analysis),
because the distribution of individual reproduction number was not explicitly used in model fitting to the disease contact tracing data.
</p>
<p>When <code>offspring.type = "P"</code>, individual reproduction number follows a <em>Dirac delta</em> distribution, which is difficult to return any value, or visualize the PDF, because of the nature of this pulse function.
</p>


<h3>References</h3>

<p>Lloyd-Smith JO, Schreiber SJ, Kopp PE, Getz WM. Superspreading and the effect of individual variation on disease emergence. <em>Nature</em>. 2005;438(7066):355-359.
<a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## an example to visualize individual reproduction number is as follows.
plot(seq(0.01,9.99, length.out = 1001), d_reproductiondistn(
  x = seq(0,10, length.out = 1001),
  epi.para = list(mean = 2, disp = 1.5, shift = 0.5),
  offspring.type = "D",
  is.log = FALSE
), type = 'l', xlab = 'individual reproduction number', ylab = 'density')

</code></pre>

<hr>
<h2 id='MERS_2013_MEregion'>A dataset of MERS outbreaks in the Middle East region</h2><span id='topic+MERS_2013_MEregion'></span>

<h3>Description</h3>

<p>This dataset (i.e., <code>MERS_2013_MEregion</code>) contains 55 observations of <strong>final outbreak size</strong> generated by given numbers of seed cases,
which were collected in Middle East respiratory syndrome (MERS) outbreaks in the Middle East (ME) regions in 2013.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MERS_2013_MEregion
</code></pre>


<h3>Format</h3>

<p>A data frame (<code>data.frame</code>) with 55 rows of records, and 3 columns of variables:
</p>

<dl>
<dt><code>obs.seed</code></dt><dd><p>Observations of the number of seed cases that generated the outbreak.</p>
</dd>
<dt><code>obs.finalsize</code></dt><dd><p>Observations of final outbreak size generated by given numbers (given in <code>obs.seed</code>) of seed cases.</p>
</dd>
<dt><code>type</code></dt><dd><p>A categorical variable takes the value &quot;outbreaksize&quot; indicating the type of observations.</p>
</dd>
</dl>



<h3>References</h3>

<p>Poletto C, Pelat C, Levy-Bruhl D, Yazdanpanah Y, Boelle PY, Colizza V. Assessment of the Middle East respiratory syndrome coronavirus (MERS-CoV) epidemic in the Middle East and risk of international spread using a novel maximum likelihood analysis approach. <em>Eurosurveillance</em>. 2014;19(23):20824.
<a href="https://doi.org/10.2807/1560-7917.ES2014.19.23.20824">doi:10.2807/1560-7917.ES2014.19.23.20824</a>, see the &quot;baseline&quot; column in Table 1 for the raw data.
</p>
<p>Kucharski AJ, Althaus CL. The role of superspreading in Middle East respiratory syndrome coronavirus (MERS-CoV) transmission. <em>Eurosurveillance</em>. 2015;20(25):21167.
<a href="https://doi.org/10.2807/1560-7917.ES2015.20.25.21167">doi:10.2807/1560-7917.ES2015.20.25.21167</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MERS_2013_MEregion)
summary(MERS_2013_MEregion)

</code></pre>

<hr>
<h2 id='mpox_19801984_DRC'>A dataset of mpox outbreaks in DRC</h2><span id='topic+mpox_19801984_DRC'></span>

<h3>Description</h3>

<p>This dataset (i.e., <code>mpox_19801984_DRC</code>) contains 125 observations of one of the following types:
</p>

<ul>
<li><p><strong>offspring case number</strong>, 
</p>
</li>
<li><p><strong>next-generation cluster size</strong>, and 
</p>
</li>
<li><p><strong>final outbreak size</strong>, 
</p>
</li></ul>

<p>generated by given numbers of seed cases,
which were collected in mpox (i.e., monkeypox) outbreaks in Democratic Republic of the Congo (DRC, or previous named &quot;Zaire&quot; before 1997) from 1980 to 1984.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mpox_19801984_DRC
</code></pre>


<h3>Format</h3>

<p>A data frame (<code>data.frame</code>) with 125 rows of records, and 3 columns of variables:
</p>

<dl>
<dt><code>obs.seed</code></dt><dd><p>Observations of the number of seed cases that generated the offspring cases in the next transmission generation.</p>
</dd>
<dt><code>obs.size</code></dt><dd><p>Observations of cases numbers generated by given numbers (given in <code>obs.seed</code>) of seed cases, see <code>type</code> variable for the detailed meaning of the value recorded under this variable here.</p>
</dd>
<dt><code>type</code></dt><dd>
<p>A categorical variable takes one of the 3 values indicating the type of observations for <code>obs.size</code> as follows:
</p>

<ul>
<li><p><code>"offpring"</code> indicated the <strong>offspring case number</strong>, generated by 1 seed case for each observation.
</p>
</li>
<li><p><code>"nextgen"</code> indicated the <strong>next-generation cluster size</strong> (including seed cases), generated by a group of seed cases with size given in <code>obs.seed</code>.
</p>
</li>
<li><p><code>"outbreak"</code> indicated the <strong>final outbreak size</strong> (including seed cases), generated by a group of seed cases with size given in <code>obs.seed</code>.
</p>
</li></ul>

</dd>
</dl>



<h3>Details</h3>

<p>Note one difference between <code>mpox_19801984_DRC</code> and the original dataset (i.e., the dataset presented in reference) was that for simplicity, observations in the original dataset that involved transmission chains of more than 1 generation were aggregated as <strong>final outbreak size</strong> observations in <code>mpox_19801984_DRC</code>.
</p>


<h3>References</h3>

<p>Fine PE, Jezek Z, Grab B, Dixon H. The transmission potential of monkeypox virus in human populations. <em>International Journal of Epidemiology</em>. 1988;17(3):643-650.
<a href="https://doi.org/10.1093/ije/17.3.643">doi:10.1093/ije/17.3.643</a>, see Table 1 for the raw data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mpox_19801984_DRC)
summary(mpox_19801984_DRC)
table(mpox_19801984_DRC$type)

</code></pre>

<hr>
<h2 id='overalllikelihood'>The likelihood function</h2><span id='topic+overalllikelihood'></span>

<h3>Description</h3>

<p>This function (i.e., <code>overalllikelihood()</code>) calculates the likelihood value with a list of pre-defined epidemiological parameters and a given structured contact tracing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  is.log = TRUE,
  data = NULL,
  var.name = list(obssize = NULL, seedsize = NULL, typelab = NULL),
  obs.type.lab = list(offspring = NULL, nextgen = NULL, outbreak = NULL)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="overalllikelihood_+3A_epi.para">epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter must be a scalar.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td></tr>
<tr><td><code id="overalllikelihood_+3A_offspring.type">offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li><p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li><p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li><p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li><p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li></ul>

<p>By default, <code>offspring.type = 'D'</code>.</p>
</td></tr>
<tr><td><code id="overalllikelihood_+3A_is.log">is.log</code></td>
<td>
<p>A logical variable, under which the likelihood would be taken natural logarithm, i.e., log-likelihood, if <code>is.log = TRUE</code>.
By default, <code>is.log = TRUE</code>.</p>
</td></tr>
<tr><td><code id="overalllikelihood_+3A_data">data</code></td>
<td>
<p>A data frame (<code>data.frame</code>), or a vector (only when <code>obs.type.lab = "offspring"</code>) that contains the structured contact tracing data.</p>
</td></tr>
<tr><td><code id="overalllikelihood_+3A_var.name">var.name</code></td>
<td>
<p>A list (<code>list</code>), or a character of variable name for the column names of dataset given in <code>data</code>.
For a list of variable names, it should be in the format of <code>list(obssize = ?, seedsize = ?, typelab = ?)</code>.
Please see the details section for more information.
By default, <code>var.name = list(obssize = NULL, seedsize = NULL, typelab = NULL)</code>.</p>
</td></tr>
<tr><td><code id="overalllikelihood_+3A_obs.type.lab">obs.type.lab</code></td>
<td>
<p>A list (<code>list</code>), or a character of labels (i.e., &quot;offspring&quot;, &quot;nextgen&quot;, or &quot;outbreak&quot;) for the type of observations.
For a list of labels, it should be in the format of <code>list(offspring = ?, nextgen = ?, outbreak = ?)</code>.
Please see the details section for more information.
By default, <code>obs.type.lab = list(offspring = NULL, nextgen = NULL, outbreak = NULL)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>obs.type.lab</code> is a character, it should be either <code>"offspring"</code>, <code>"nextgen"</code>, or <code>"outbreak"</code> for type of observations.
</p>
<p>When <code>obs.type.lab</code> is a list, this occurs when the contact tracing data has more than one types of observations.
See example 4 in the Examples section.
</p>
<p>When the contact tracing dataset is offspring case observations, the function arguments <code>data</code> could be either a vector, or a data frame.
If <code>data</code> is a vector, it is not necessary to assign any value to <code>var.name</code>.
If <code>data</code> is a data frame, it is necessary to identify the variable name of offspring observations in <code>var.name</code>.
See example 1 in the Examples section.
</p>
<p>When the contact tracing dataset is next-generation cluster size, or final outbreak size observations, the variable names of both observations and seed case size should be identified in <code>var.name</code> with the format of <code>list(obssize = ?, seedsize = ?)</code>.
See example 2 and example 3 in the Examples section.
</p>
<p>When the contact tracing dataset has more than one types of observations, the variable names of observations, seed case size, and observation type should be identified in <code>var.name</code> with the format of <code>list(obssize = ?, seedsize = ?, typelab = ?)</code>.
See example 4 in the Examples section.
</p>


<h3>Value</h3>

<p>The log-likelihood (by default), or likelihood value from contact tracing data, with pre-defined epidemiological parameters.
</p>


<h3>Note</h3>

<p>Each parameter in <code>epi.para = list(mean = ?, disp = ?, shift = ?)</code> should be a scalar, which means vector is not allowed here.
</p>
<p>For the contact tracing data in <code>data</code>, unknown observations (i.e., <code>NA</code>) is not allowed.
</p>


<h3>References</h3>

<p>Lloyd-Smith JO, Schreiber SJ, Kopp PE, Getz WM. Superspreading and the effect of individual variation on disease emergence. <em>Nature</em>. 2005;438(7066):355-359.
<a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>
<p>Nishiura H, Yan P, Sleeman CK, Mode CJ. Estimating the transmission potential of supercritical processes based on the final size distribution of minor outbreaks. <em>Journal of Theoretical Biology</em>. 2012;294:48-55.
<a href="https://doi.org/10.1016/j.jtbi.2011.10.039">doi:10.1016/j.jtbi.2011.10.039</a>
</p>
<p>Blumberg S, Funk S, Pulliam JR. Detecting differential transmissibilities that affect the size of self-limited outbreaks. <em>PLoS Pathogens</em>. 2014;10(10):e1004452.
<a href="https://doi.org/10.1371/journal.ppat.1004452">doi:10.1371/journal.ppat.1004452</a>
</p>
<p>Kucharski AJ, Althaus CL. The role of superspreading in Middle East respiratory syndrome coronavirus (MERS-CoV) transmission. <em>Eurosurveillance</em>. 2015;20(25):21167.
<a href="https://doi.org/10.2807/1560-7917.ES2015.20.25.21167">doi:10.2807/1560-7917.ES2015.20.25.21167</a>
</p>
<p>Endo A, Abbott S, Kucharski AJ, Funk S. Estimating the overdispersion in COVID-19 transmission using outbreak sizes outside China. <em>Wellcome Open Research</em>. 2020;5:67.
<a href="https://doi.org/10.12688/wellcomeopenres.15842.3">doi:10.12688/wellcomeopenres.15842.3</a>
</p>
<p>Adam DC, Wu P, Wong JY, Lau EH, Tsang TK, Cauchemez S, Leung GM, Cowling BJ. Clustering and superspreading potential of SARS-CoV-2 infections in Hong Kong. <em>Nature Medicine</em>. 2020;26(11):1714-1719.
<a href="https://doi.org/10.1038/s41591-020-1092-0">doi:10.1038/s41591-020-1092-0</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example 1 #
## likelihood for the offspring observations
data(COVID19_JanApr2020_HongKong)
overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  data = COVID19_JanApr2020_HongKong,
  var.name = list(obssize = 'obs'),
  obs.type.lab = 'offspring'
)
overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
)


# example 2 #
## likelihood for the next-generation cluster size observations
data(smallpox_19581973_Europe)
overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D',
  data = smallpox_19581973_Europe,
  var.name = list(obssize = 'obs.clustersize', seedsize = 'obs.seed'),
  obs.type.lab = 'nextgen'
)


# example 3 #
## likelihood for the final outbreak size observations
data(MERS_2013_MEregion)
overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D',
  data = MERS_2013_MEregion,
  var.name = list(obssize = 'obs.finalsize', seedsize = 'obs.seed'),
  obs.type.lab = 'outbreak'
)


# example 4 #
## likelihood for more than one types of observations
data(mpox_19801984_DRC)
overalllikelihood(
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = 'D',
  data = mpox_19801984_DRC,
  var.name = list(obssize = 'obs.size', seedsize = 'obs.seed', typelab = 'type'),
  obs.type.lab = list(offspring = 'offspring', nextgen = 'nextgen', outbreak = 'outbreak')
)


# example 5 #
## reproducing the AIC results in Adam, et al. (2020) https://doi.org/10.1038/s41591-020-1092-0,
## (see Supplementary Table 4),
## where the AIC scores were calculated for NB, Geometric, and Poisson models from top to bottom.
## Here, the AIC is defined as: AIC = -2 * log-likelihood + 2 * number of unknown model parameters.
data(COVID19_JanApr2020_HongKong)
overalllikelihood(
  epi.para = list(mean = 0.58, disp = 0.43, shift = 0.2),
  offspring.type = "NB",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
) * (-2) + 2*2
overalllikelihood(
  epi.para = list(mean = 0.63, disp = 0.43, shift = 0.2),
  offspring.type = "G",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
) * (-2) + 1*2
overalllikelihood(
  epi.para = list(mean = 0.58, disp = 0.43, shift = 0.2),
  offspring.type = "P",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
) * (-2) + 1*2

</code></pre>

<hr>
<h2 id='paraest.MCMC'>To estimate model parameters using Markov chain Monte Carlo approach</h2><span id='topic+paraest.MCMC'></span>

<h3>Description</h3>

<p>This function (i.e., <code>paraest.MCMC()</code>) performs model parameter estimation using random walk <strong>Markov chain Monte Carlo</strong> (MCMC) approach with given structured contact tracing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paraest.MCMC(
  can.epi.para.start = list(mean = 1, disp = 0.5, shift = 0.2),
  isfix.epi.para = list(mean = FALSE, disp = FALSE, shift = FALSE),
  offspring.type = "D",
  para.comb.num = 10000,
  burnin.frac = 0.33,
  data = NULL,
  var.name = list(obssize = NULL, seedsize = NULL, typelab = NULL),
  obs.type.lab = list(offspring = NULL, nextgen = NULL, outbreak = NULL)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paraest.MCMC_+3A_can.epi.para.start">can.epi.para.start</code></td>
<td>
<p>A list (<code>list</code>) of the starting values for unknown epidemiological parameters for offspring distribution.
The list should be in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>.
Each parameter must be a scalar, and only accept non-negative values.
The default setting is given in the code Usage section.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td></tr>
<tr><td><code id="paraest.MCMC_+3A_isfix.epi.para">isfix.epi.para</code></td>
<td>
<p>A list (<code>list</code>) of logistic values that indicate whether each parameter is fixed.
By default, <code>isfix.epi.para = list(mean = FALSE, disp = FALSE, shift = FALSE)</code>, where all three parameters are not fixed and to be estimated.</p>
</td></tr>
<tr><td><code id="paraest.MCMC_+3A_offspring.type">offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li><p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li><p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li><p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li><p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li></ul>

<p>By default, <code>offspring.type = 'D'</code>.</p>
</td></tr>
<tr><td><code id="paraest.MCMC_+3A_para.comb.num">para.comb.num</code></td>
<td>
<p>A positive integer for the number of iterations used for MCMC runs.
By default, <code>para.comb.num = 10000</code>, and no need to change the default setting here unless for special reasons.</p>
</td></tr>
<tr><td><code id="paraest.MCMC_+3A_burnin.frac">burnin.frac</code></td>
<td>
<p>A number with range strictly between 0 and 1 for the fraction of MCMC chain that will be discarded as the &quot;burn-in&quot; stage.
By default, <code>burnin.frac = 0.33</code>, and no need to change the default setting here unless for special reasons.</p>
</td></tr>
<tr><td><code id="paraest.MCMC_+3A_data">data</code></td>
<td>
<p>A data frame (<code>data.frame</code>), or a vector (only when <code>obs.type.lab = "offspring"</code>) that contains the structured contact tracing data.</p>
</td></tr>
<tr><td><code id="paraest.MCMC_+3A_var.name">var.name</code></td>
<td>
<p>A list (<code>list</code>), or a character of variable name for the column names of dataset given in <code>data</code>.
For a list of variable names, it should be in the format of <code>list(obssize = ?, seedsize = ?, typelab = ?)</code>.
Please see the details section for more information.
By default, <code>var.name = list(obssize = NULL, seedsize = NULL, typelab = NULL)</code>.</p>
</td></tr>
<tr><td><code id="paraest.MCMC_+3A_obs.type.lab">obs.type.lab</code></td>
<td>
<p>A list (<code>list</code>), or a character of labels (i.e., &quot;offspring&quot;, &quot;nextgen&quot;, or &quot;outbreak&quot;) for the type of observations.
For a list of labels, it should be in the format of <code>list(offspring = ?, nextgen = ?, outbreak = ?)</code>.
Please see the details section for more information.
By default, <code>obs.type.lab = list(offspring = NULL, nextgen = NULL, outbreak = NULL)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the values of parameters given in <code>can.epi.para.start</code>,
they are some rough starting points for the MCMC to run, which are not necessarily to be precise (but have to be within a reasonable range), and
they will used as a &quot;start&quot; status to find the posterior MCMC samples.
</p>
<p>When <code>obs.type.lab</code> is a character, it should be either <code>"offspring"</code>, <code>"nextgen"</code>, or <code>"outbreak"</code> for type of observations.
When <code>obs.type.lab</code> is a list, this occurs when the contact tracing data has more than one types of observations.
</p>
<p>When the contact tracing dataset is offspring case observations, the function arguments <code>data</code> could be either a vector, or a data frame.
If <code>data</code> is a vector, it is not necessary to assign any value to <code>var.name</code>.
If <code>data</code> is a data frame, it is necessary to identify the variable name of offspring observations in <code>var.name</code>.
</p>
<p>When the contact tracing dataset is next-generation cluster size, or final outbreak size observations, the variable names of both observations and seed case size should be identified in <code>var.name</code> with the format of <code>list(obssize = ?, seedsize = ?)</code>.
</p>
<p>When the contact tracing dataset has more than one types of observations, the variable names of observations, seed case size, and observation type should be identified in <code>var.name</code> with the format of <code>list(obssize = ?, seedsize = ?, typelab = ?)</code>.
</p>


<h3>Value</h3>

<p>A list (i.e., <code>list</code>) contains the following three items:
</p>

<ul>
<li><p>a data frame (<code>data.frame</code>) summaries the median, and 2.5% and 97.5% percentiles (95% credible interval, CrI) of the posterior MCMC samples for each unknown parameters,
</p>
</li>
<li><p>the maximum log-likelihood value, and
</p>
</li>
<li><p>a data frame (<code>data.frame</code>) of the posterior MCMC samples and their corresponding log-likelihood values.
</p>
</li></ul>



<h3>Note</h3>

<p>Each parameter in <code>can.epi.para.start = list(mean = ?, disp = ?, shift = ?)</code> should be a scalar, which means vector is not allowed here.
</p>
<p>For the contact tracing data in <code>data</code>, unknown observations (i.e., <code>NA</code>) is not allowed.
</p>
<p>As <code>para.comb.num</code> is the number of iterations for the MCMC runs, when <code>para.comb.num</code> is large, e.g., <code>para.comb.num</code> &gt; 100000, the function <code>paraest.MCMC()</code> could take few seconds, or even minutes to complete, depending on the sample size, etc.
Thus, we do not recommend the users to change the default setting of <code>para.comb.num</code> unless for special reasons.
</p>


<h3>References</h3>

<p>Blumberg S, Funk S, Pulliam JR. Detecting differential transmissibilities that affect the size of self-limited outbreaks. <em>PLoS Pathogens</em>. 2014;10(10):e1004452.
<a href="https://doi.org/10.1371/journal.ppat.1004452">doi:10.1371/journal.ppat.1004452</a>
</p>
<p>Kucharski AJ, Althaus CL. The role of superspreading in Middle East respiratory syndrome coronavirus (MERS-CoV) transmission. <em>Eurosurveillance</em>. 2015;20(25):21167.
<a href="https://doi.org/10.2807/1560-7917.ES2015.20.25.21167">doi:10.2807/1560-7917.ES2015.20.25.21167</a>
</p>
<p>Adam DC, Wu P, Wong JY, Lau EH, Tsang TK, Cauchemez S, Leung GM, Cowling BJ. Clustering and superspreading potential of SARS-CoV-2 infections in Hong Kong. <em>Nature Medicine</em>. 2020;26(11):1714-1719.
<a href="https://doi.org/10.1038/s41591-020-1092-0">doi:10.1038/s41591-020-1092-0</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+overalllikelihood">modelSSE::overalllikelihood()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# example 1: for offspring observations #
## reproducing the parameter estimation results in Adam, et al. (2020)
## paper doi link: https://doi.org/10.1038/s41591-020-1092-0,
## (see the first row in Supplementary Table 4),
## where R of 0.58 (95% CI: 0.45, 0.72), and k of 0.43 (95% CI: 0.29, 0.67).
data(COVID19_JanApr2020_HongKong)
set.seed(2023)
MCMC.output = paraest.MCMC(
  #can.epi.para.start = list(mean = 0.60, disp = 0.50, shift = 0.20),
  offspring.type = "NB", para.comb.num = 10000,
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
)
print(MCMC.output$epi.para.est.output)
## Then, plot the posterior fitting results using 100 randomly-selected MCMC samples.
hist(
  COVID19_JanApr2020_HongKong$obs, breaks = c(0:100) -0.5, xlim = c(0,12),
  freq = FALSE, xlab = 'secondary cases', ylab = 'rel. freq.', main = ''
)
for(jj in 1:100){
  temp.random.col.index = sample.int(n = nrow(MCMC.output$est.record.mat), size = 1)
  est.record.array = MCMC.output$est.record.mat[temp.random.col.index,]
  lines(0:12, d_offspringdistn(
    x = 0:12,
    epi.para = list(
      mean = est.record.array$epi.para.mean,
      disp = est.record.array$epi.para.disp, shift = 0.1
    ),
    offspring.type = "NB"
  ), col = '#0066FF33', type = 'l', lty = 3)
}


# example 2: for offspring observations #
## reproducing the parameter estimation results in Zhao, et al. (2020)
## paper doi link: https://doi.org/10.1371/journal.pcbi.1010281,
## (see the results of dataset #3 using Delaporte distribution in Table 1), where
## R of 0.59 (95% CI: 0.46, 0.78),
## k of 0.16 (95% CI: 0.06, 0.40), and
## shift of 0.17 (95% CI: 0.04, 0.30).
data(COVID19_JanApr2020_HongKong)
set.seed(2023)
paraest.MCMC(
  can.epi.para.start = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
)$epi.para.est.output


# example 3: for next-generation cluster size observations #
## reproducing the parameter estimation results in Blumberg, et al, (2014)
## paper doi link: https://doi.org/10.1371/journal.ppat.1004452,
## (see the last row in Table 3, and Fig 4A),
## where R of 3.14 (95% CI: 2, &gt;6), and k of 0.37 (95% CI: not reported).
data(smallpox_19581973_Europe)
set.seed(2023)
paraest.MCMC(
  can.epi.para.start = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "NB",
  data = smallpox_19581973_Europe,
  var.name = list(obssize = 'obs.clustersize', seedsize = 'obs.seed'),
  obs.type.lab = 'nextgen'
)$epi.para.est.output


# example 4: final outbreak size observations #
## reproducing the parameter estimation results in Kucharski, Althaus. (2015)
## paper doi link: https://doi.org/10.2807/1560-7917.ES2015.20.25.21167,
## (see Fig 1, and Finding section),
## where R of 0.47 (95% CI: 0.29, 0.80), and k of 0.26 (95% CI: 0.09, 1.24).
data(MERS_2013_MEregion)
set.seed(2023)
paraest.MCMC(
  can.epi.para.start = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "NB",
  data = MERS_2013_MEregion,
  var.name = list(obssize = 'obs.finalsize', seedsize = 'obs.seed'),
  obs.type.lab = 'outbreak'
)$epi.para.est.output


# example 5: for more than one types of observations #
## reproducing the parameter estimation results in Blumberg, et al, (2014)
## paper doi link: https://doi.org/10.1371/journal.ppat.1004452,
## (see the last row in Table 5, and Fig 6A),
## where R of 0.3 (95% CI: 0.2, 0.5), and k of 0.4 (95% CI: not reported).
data(mpox_19801984_DRC)
set.seed(2023)
paraest.MCMC(
  can.epi.para.start = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "NB", para.comb.num = 30000,
  data = mpox_19801984_DRC,
  var.name = list(obssize = 'obs.size', seedsize = 'obs.seed', typelab = 'type'),
  obs.type.lab = list(offspring = 'offspring', nextgen = 'nextgen', outbreak = 'outbreak')
)$epi.para.est.output



</code></pre>

<hr>
<h2 id='paraest.ML'>To estimate model parameters using maximum likelihood approach</h2><span id='topic+paraest.ML'></span>

<h3>Description</h3>

<p>This function (i.e., <code>paraest.ML()</code>) performs model parameter estimation using <strong>maximum likelihood</strong> (ML) approach with given structured contact tracing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paraest.ML(
  can.epi.para.range = list(mean = c(0.1, 2), disp = c(0.01, 2.5), shift = c(0.01, 0.5)),
  offspring.type = "D",
  para.comb.num = 1000,
  can.epi.para.set = NULL,
  data = NULL,
  var.name = list(obssize = NULL, seedsize = NULL, typelab = NULL),
  obs.type.lab = list(offspring = NULL, nextgen = NULL, outbreak = NULL)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paraest.ML_+3A_can.epi.para.range">can.epi.para.range</code></td>
<td>
<p>A list (<code>list</code>) of ranges, or fixed values for unknown epidemiological parameters for offspring distribution.
For the ranges of unknown epidemiological parameters, the list should be in the format of <code>list(mean = c(?, ?), disp = c(?, ?), shift = c(?, ?))</code>.
For the fixed values of unknown epidemiological parameters, the list should be in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>.
Each parameter must be a scalar, and only accept non-negative values.
The default setting is given in the code Usage section.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td></tr>
<tr><td><code id="paraest.ML_+3A_offspring.type">offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li><p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li><p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li><p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li><p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li></ul>

<p>By default, <code>offspring.type = 'D'</code>.</p>
</td></tr>
<tr><td><code id="paraest.ML_+3A_para.comb.num">para.comb.num</code></td>
<td>
<p>A positive integer for the number of parameter combinations used to construct log-likelihood profile.
By default, <code>para.comb.num = 1000</code>, and no need to change the default setting here unless for special reasons.</p>
</td></tr>
<tr><td><code id="paraest.ML_+3A_can.epi.para.set">can.epi.para.set</code></td>
<td>
<p>A data frame (<code>data.frame</code>) of different parameter combinations.
The data frame must have three variables with names <code>"epi.para.mean"</code>, <code>"epi.para.disp"</code>, and <code>"epi.para.shift"</code> for the three parameters.
By default, <code>can.epi.para.set = NULL</code>.
Note that the function argument <code>can.epi.para.set</code> is usually used internally, and thus no need to change the default setting here unless for special reasons</p>
</td></tr>
<tr><td><code id="paraest.ML_+3A_data">data</code></td>
<td>
<p>A data frame (<code>data.frame</code>), or a vector (only when <code>obs.type.lab = "offspring"</code>) that contains the structured contact tracing data.</p>
</td></tr>
<tr><td><code id="paraest.ML_+3A_var.name">var.name</code></td>
<td>
<p>A list (<code>list</code>), or a character of variable name for the column names of dataset given in <code>data</code>.
For a list of variable names, it should be in the format of <code>list(obssize = ?, seedsize = ?, typelab = ?)</code>.
Please see the details section for more information.
By default, <code>var.name = list(obssize = NULL, seedsize = NULL, typelab = NULL)</code>.</p>
</td></tr>
<tr><td><code id="paraest.ML_+3A_obs.type.lab">obs.type.lab</code></td>
<td>
<p>A list (<code>list</code>), or a character of labels (i.e., &quot;offspring&quot;, &quot;nextgen&quot;, or &quot;outbreak&quot;) for the type of observations.
For a list of labels, it should be in the format of <code>list(offspring = ?, nextgen = ?, outbreak = ?)</code>.
Please see the details section for more information.
By default, <code>obs.type.lab = list(offspring = NULL, nextgen = NULL, outbreak = NULL)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the ranges of parameters given in <code>can.epi.para.range</code>,
they are some rough ranges, which are not necessarily to be precise (but have to be within a reasonable range), and
they will used as a &quot;start&quot; status to find the maximum likelihood estimate.
</p>
<p>When <code>obs.type.lab</code> is a character, it should be either <code>"offspring"</code>, <code>"nextgen"</code>, or <code>"outbreak"</code> for type of observations.
When <code>obs.type.lab</code> is a list, this occurs when the contact tracing data has more than one types of observations.
</p>
<p>When the contact tracing dataset is offspring case observations, the function arguments <code>data</code> could be either a vector, or a data frame.
If <code>data</code> is a vector, it is not necessary to assign any value to <code>var.name</code>.
If <code>data</code> is a data frame, it is necessary to identify the variable name of offspring observations in <code>var.name</code>.
</p>
<p>When the contact tracing dataset is next-generation cluster size, or final outbreak size observations, the variable names of both observations and seed case size should be identified in <code>var.name</code> with the format of <code>list(obssize = ?, seedsize = ?)</code>.
</p>
<p>When the contact tracing dataset has more than one types of observations, the variable names of observations, seed case size, and observation type should be identified in <code>var.name</code> with the format of <code>list(obssize = ?, seedsize = ?, typelab = ?)</code>.
</p>


<h3>Value</h3>

<p>A list (i.e., <code>list</code>) contains the following three items:
</p>

<ul>
<li><p>a data frame (<code>data.frame</code>) of the maximum likelihood estimate and 95% confidence interval (CI) of each unknown parameters,
</p>
</li>
<li><p>the maximum log-likelihood value, and
</p>
</li>
<li><p>a data frame (<code>data.frame</code>) of different parameter combinations and their corresponding log-likelihood values.
</p>
</li></ul>



<h3>Note</h3>

<p>For the contact tracing data in <code>data</code>, unknown observations (i.e., <code>NA</code>) is not allowed.
</p>
<p>When <code>para.comb.num</code> is large, e.g., <code>para.comb.num</code> &gt; 10000, the function <code>paraest.ML()</code> could take few seconds, or even minutes to complete, depending on the sample size, and model settings, etc.
Thus, we do not recommend the users to change the default setting of <code>para.comb.num</code> unless for special reasons.
</p>


<h3>References</h3>

<p>Blumberg S, Funk S, Pulliam JR. Detecting differential transmissibilities that affect the size of self-limited outbreaks. <em>PLoS Pathogens</em>. 2014;10(10):e1004452.
<a href="https://doi.org/10.1371/journal.ppat.1004452">doi:10.1371/journal.ppat.1004452</a>
</p>
<p>Kucharski AJ, Althaus CL. The role of superspreading in Middle East respiratory syndrome coronavirus (MERS-CoV) transmission. <em>Eurosurveillance</em>. 2015;20(25):21167.
<a href="https://doi.org/10.2807/1560-7917.ES2015.20.25.21167">doi:10.2807/1560-7917.ES2015.20.25.21167</a>
</p>
<p>Adam DC, Wu P, Wong JY, Lau EH, Tsang TK, Cauchemez S, Leung GM, Cowling BJ. Clustering and superspreading potential of SARS-CoV-2 infections in Hong Kong. <em>Nature Medicine</em>. 2020;26(11):1714-1719.
<a href="https://doi.org/10.1038/s41591-020-1092-0">doi:10.1038/s41591-020-1092-0</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+overalllikelihood">modelSSE::overalllikelihood()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## try to estimate the parameter (which is already known),
## using random samples generated from a geometric distribution with mean of 1.
set.seed(2020)
paraest.ML(
  can.epi.para.range = list(mean = c(0.1, 2.0), disp = c(0.01, 2.5), shift = c(0.01,0.5)),
  offspring.type = "NB", para.comb.num = 100,
  data = r_offspringdistn(
    n = 99, epi.para = list(mean = 1, disp = 0.5, shift = 0.2), offspring.type = "G"
  ),
  obs.type.lab = 'offspring'
)$epi.para.est.output




# example 1: for offspring observations #
## reproducing the parameter estimation results in Adam, et al. (2020)
## paper doi link: https://doi.org/10.1038/s41591-020-1092-0,
## (see the first row in Supplementary Table 4),
## where R of 0.58 (95% CI: 0.45, 0.72), and k of 0.43 (95% CI: 0.29, 0.67).
data(COVID19_JanApr2020_HongKong)
set.seed(2020)
paraest.ML(
  can.epi.para.range = list(mean = c(0.1, 2.0), disp = c(0.01, 2.5), shift = c(0.01,0.5)),
  offspring.type = "NB",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
)$epi.para.est.output


# example 2: for offspring observations #
## reproducing the parameter estimation results in Zhao, et al. (2020)
## paper doi link: https://doi.org/10.1371/journal.pcbi.1010281,
## (see the results of dataset #3 using Delaporte distribution in Table 1), where
## R of 0.59 (95% CI: 0.46, 0.78),
## k of 0.16 (95% CI: 0.06, 0.40), and
## shift of 0.17 (95% CI: 0.04, 0.30).
data(COVID19_JanApr2020_HongKong)
set.seed(2020)
paraest.ML(
  can.epi.para.range = list(mean = c(0.1, 2.0), disp = c(0.01, 2.5), shift = c(0.01,0.5)),
  offspring.type = "D",
  data = COVID19_JanApr2020_HongKong$obs,
  obs.type.lab = 'offspring'
)$epi.para.est.output


# example 3: for next-generation cluster size observations #
## reproducing the parameter estimation results in Blumberg, et al, (2014)
## paper doi link: https://doi.org/10.1371/journal.ppat.1004452,
## (see the last row in Table 3, and Fig 4A),
## where R of 3.14 (95% CI: 2, &gt;6), and k of 0.37 (95% CI: not reported).
data(smallpox_19581973_Europe)
set.seed(2020)
paraest.ML(
  can.epi.para.range = list(mean = c(0.1, 10.0), disp = c(0.01, 2.5), shift = c(0.01,0.5)),
  offspring.type = "NB",
  data = smallpox_19581973_Europe,
  var.name = list(obssize = 'obs.clustersize', seedsize = 'obs.seed'),
  obs.type.lab = 'nextgen'
)$epi.para.est.output


# example 4: final outbreak size observations #
## reproducing the parameter estimation results in Kucharski, Althaus. (2015)
## paper doi link: https://doi.org/10.2807/1560-7917.ES2015.20.25.21167,
## (see Fig 1, and Finding section),
## where R of 0.47 (95% CI: 0.29, 0.80), and k of 0.26 (95% CI: 0.09, 1.24).
data(MERS_2013_MEregion)
set.seed(2020)
paraest.ML(
  can.epi.para.range = list(mean = c(0.1, 2.0), disp = c(0.01, 2.5), shift = c(0.01,0.5)),
  offspring.type = "NB",
  data = MERS_2013_MEregion,
  var.name = list(obssize = 'obs.finalsize', seedsize = 'obs.seed'),
  obs.type.lab = 'outbreak'
)$epi.para.est.output


# example 5: for more than one types of observations #
## reproducing the parameter estimation results in Blumberg, et al, (2014)
## paper doi link: https://doi.org/10.1371/journal.ppat.1004452,
## (see the last row in Table 5, and Fig 6A),
## where R of 0.3 (95% CI: 0.2, 0.5), and k of 0.4 (95% CI: not reported).
data(mpox_19801984_DRC)
set.seed(2020)
paraest.ML(
  can.epi.para.range = list(mean = c(0.1, 2.0), disp = c(0.01, 2.5), shift = c(0.01,0.5)),
  offspring.type = "NB",
  data = mpox_19801984_DRC,
  var.name = list(obssize = 'obs.size', seedsize = 'obs.seed', typelab = 'type'),
  obs.type.lab = list(offspring = 'offspring', nextgen = 'nextgen', outbreak = 'outbreak')
)$epi.para.est.output



</code></pre>

<hr>
<h2 id='smallpox_19581973_Europe'>A dataset of smallpox outbreaks in Europe</h2><span id='topic+smallpox_19581973_Europe'></span>

<h3>Description</h3>

<p>This dataset (i.e., <code>smallpox_19581973_Europe</code>) contains 34 observations of <strong>next-generation cluster size</strong> generated by given numbers of seed cases,
which were collected in smallpox outbreaks in Europe from 1958 to 1973.
Here, in this dataset, only the smallpox case observations involved in the <em>first</em> indigenous transmission generation were recorded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smallpox_19581973_Europe
</code></pre>


<h3>Format</h3>

<p>A data frame (<code>data.frame</code>) with 34 of records, and 3 columns of variables:
</p>

<dl>
<dt><code>obs.seed</code></dt><dd><p>Observations of the number of seed cases that generated the offspring cases in the next transmission generation.</p>
</dd>
<dt><code>obs.clustersize</code></dt><dd><p>Observations of next-generation cluster size generated by given numbers (given in <code>obs.seed</code>) of seed cases.</p>
</dd>
<dt><code>type.obs</code></dt><dd><p>A categorical variable takes the value &quot;nextgen_clustersize&quot; indicating the type of observations.</p>
</dd>
</dl>



<h3>References</h3>

<p>Fenner F, Henderson DA, Arita I, Jezek Z, Ladnyi ID. Smallpox and its eradication. <em>Geneva: World Health Organization</em>. 1988.
<a href="https://apps.who.int/iris/handle/10665/39485">https://apps.who.int/iris/handle/10665/39485</a>, see Table 23.4 for the raw data.
</p>
<p>Blumberg S, Funk S, Pulliam JR. Detecting differential transmissibilities that affect the size of self-limited outbreaks. <em>PLoS Pathogens</em>. 2014;10(10):e1004452.
<a href="https://doi.org/10.1371/journal.ppat.1004452">doi:10.1371/journal.ppat.1004452</a>, see Table 3 in the data supplementary file for the processed data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(smallpox_19581973_Europe)
summary(smallpox_19581973_Europe)

</code></pre>

<hr>
<h2 id='tailoffspringQ'>The &quot;20/80&quot; rule</h2><span id='topic+tailoffspringQ'></span><span id='topic+mostinfectiousP'></span>

<h3>Description</h3>

<p>To calculate proportion of (<code>Q</code>) offspring cases generated from proportion of (<code>P</code>) the most infectious index cases with pre-defined epidemiological parameters for the offspring distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tailoffspringQ(
  P = 0.2,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  n.seed = 1000
)

mostinfectiousP(
  Q = 0.8,
  epi.para = list(mean = 1, disp = 0.5, shift = 0.2),
  offspring.type = "D",
  n.seed = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tailoffspringQ_+3A_p">P</code>, <code id="tailoffspringQ_+3A_q">Q</code></td>
<td>
<p>A scalar, or a vector of probability (i.e., ranging from 0 to 1).</p>
</td></tr>
<tr><td><code id="tailoffspringQ_+3A_epi.para">epi.para</code></td>
<td>
<p>A list (<code>list</code>) of pre-defined epidemiological parameters for offspring distribution, in the format of <code>list(mean = ?, disp = ?, shift = ?)</code>,
where the three parameters accept non-negative values.
Each parameter must be a scalar.
For Delaporte distribution, the value of <code>mean</code> should be larger than the value of <code>shift</code>.</p>
</td></tr>
<tr><td><code id="tailoffspringQ_+3A_offspring.type">offspring.type</code></td>
<td>
<p>A character label (<code>character</code>) indicating the type of distribution used to describe the offspring distribution.
It only accepts one of the following values:
</p>

<ul>
<li><p><code>"D"</code> indicates the <em>Delaporte</em> distribution, 
</p>
</li>
<li><p><code>"NB"</code> indicates the <em>negative binomial</em> distribution, 
</p>
</li>
<li><p><code>"G"</code> indicates the <em>geometric</em> distribution, or 
</p>
</li>
<li><p><code>"P"</code> indicates the <em>Poisson</em> distribution. 
</p>
</li></ul>

<p>By default, <code>offspring.type = 'D'</code>.</p>
</td></tr>
<tr><td><code id="tailoffspringQ_+3A_n.seed">n.seed</code></td>
<td>
<p>A positive integer, for the number of seeds used to solve <code>P</code> or <code>Q</code> numerically.
By default, <code>n.seed = 1000</code>, and no need to change the default setting here unless for special reasons.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code>tailoffspringQ()</code> returns the proportion of (<code>Q</code>) offspring cases generated from proportion of (<code>P</code>) index cases, where (<code>P</code>) is given.
</p>
<p>Function <code>mostinfectiousP()</code> returns the proportion of (<code>P</code>) index cases that generated proportion of (<code>Q</code>) offspring cases, where (<code>Q</code>) is given.
</p>


<h3>Note</h3>

<p>When <code>n.seed</code> is large, e.g., <code>n.seed</code> &gt; 100000, the functions could take minutes to complete.
As such, we do not recommend the users to change the default setting of <code>n.seed</code> unless for special reasons.
</p>
<p>Each parameter in <code>epi.para = list(mean = ?, disp = ?, shift = ?)</code> should be a scalar, which means vector is not allowed here.
</p>


<h3>References</h3>

<p>Lloyd-Smith JO, Schreiber SJ, Kopp PE, Getz WM. Superspreading and the effect of individual variation on disease emergence. <em>Nature</em>. 2005;438(7066):355-359.
<a href="https://doi.org/10.1038/nature04153">doi:10.1038/nature04153</a>
</p>
<p>Endo A, Abbott S, Kucharski AJ, Funk S. Estimating the overdispersion in COVID-19 transmission using outbreak sizes outside China. <em>Wellcome Open Research</em>. 2020;5:67.
<a href="https://doi.org/10.12688/wellcomeopenres.15842.3">doi:10.12688/wellcomeopenres.15842.3</a>
</p>
<p>Adam DC, Wu P, Wong JY, Lau EH, Tsang TK, Cauchemez S, Leung GM, Cowling BJ. Clustering and superspreading potential of SARS-CoV-2 infections in Hong Kong. <em>Nature Medicine</em>. 2020;26(11):1714-9.
<a href="https://doi.org/10.1038/s41591-020-1092-0">doi:10.1038/s41591-020-1092-0</a>
</p>
<p>Zhao S, Chong MK, Ryu S, Guo Z, He M, Chen B, Musa SS, Wang J, Wu Y, He D, Wang MH. Characterizing superspreading potential of infectious disease: Decomposition of individual transmissibility. <em>PLoS Computational Biology</em>. 2022;18(6):e1010281.
<a href="https://doi.org/10.1371/journal.pcbi.1010281">doi:10.1371/journal.pcbi.1010281</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+d_offspringdistn">d_offspringdistn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


## reproducing the results in Endo, et al. (2020) https://doi.org/10.12688/wellcomeopenres.15842.3,
## where ~80% offspring cases were generated from ~10% index cases
## with parameters R of ~2.5 (ranging from 2 to 3) and
## k of ~0.1 (ranging from 0.05 to 0.20) under NB distribution.
tailoffspringQ(
  P = 0.10,
  epi.para = list(mean = 2.5, disp = 0.10, shift = 0.2),
  offspring.type = "NB"
)
mostinfectiousP(
  Q = 0.80,
  epi.para = list(mean = 2.5, disp = 0.10, shift = 0.2),
  offspring.type = "NB"
)


## reproducing the results in Adam, et al. (2020) https://doi.org/10.1038/s41591-020-1092-0,
## where ~80% offspring cases were generated from ~19% index cases
## with parameters R of 0.58 and k of 0.43 under NB distribution.
tailoffspringQ(
  P = 0.19,
  epi.para = list(mean = 0.58, disp = 0.43, shift = 0.2),
  offspring.type = "NB"
)
mostinfectiousP(
  Q = 0.80,
  epi.para = list(mean = 0.58, disp = 0.43, shift = 0.2),
  offspring.type = "NB"
)



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
