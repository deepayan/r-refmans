<!DOCTYPE html><html><head><title>Help for package vioplot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vioplot}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#histoplot'><p>histoplot</p></a></li>
<li><a href='#vioplot'><p>Violin Plot</p></a></li>
<li><a href='#vioplot.stats'><p>Violin Plot Statistics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Violin Plot</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-12-08</td>
</tr>
<tr>
<td>Description:</td>
<td>A violin plot is a combination of a box plot and a kernel density plot. This package allows extensive customisation of violin plots. </td>
</tr>
<tr>
<td>Depends:</td>
<td>sm, zoo</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/TomKellyGenetics/vioplot">https://github.com/TomKellyGenetics/vioplot</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/TomKellyGenetics/vioplot/issues">https://github.com/TomKellyGenetics/vioplot/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>base, ggplot2, RColorBrewer, knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-09 01:26:08 UTC; tom</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Adler [aut, cph],
  S. Thomas Kelly [aut, cre],
  Tom M. Elliott [aut, ctb],
  Jordan Adamson [aut, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>S. Thomas Kelly &lt;tomkellygenetics@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-09 17:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='histoplot'>histoplot</h2><span id='topic+histoplot'></span><span id='topic+histoplot.matrix'></span><span id='topic+histogram.matrix'></span><span id='topic+histoplot.list'></span><span id='topic+histoplot.data.frame'></span><span id='topic+histoplot.formula'></span><span id='topic+histoplot.default'></span>

<h3>Description</h3>

<p>Produce histogram plot(s) of the given (grouped) values with enhanced annotation and colour per group. Includes customisation of colours for each aspect of the histogram, boxplot, and separate histograms. This supports input of data as a list or formula, being backwards compatible with <code><a href="#topic+histoplot">histoplot</a></code> (0.2) and taking input in a formula as used for <code><a href="graphics.html#topic+boxplot">boxplot</a></code>.
</p>
<p>Interpreting the columns (or rows) of a matrix as different groups, draw a boxplot for each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'matrix'
histoplot(x, use.cols = TRUE, ...)

## S3 method for class 'list'
histoplot(x, ...)

## S3 method for class 'data.frame'
histoplot(x, ...)

## S3 method for class 'matrix'
histoplot(x, use.cols = TRUE, ...)

## S3 method for class 'formula'
histoplot(
  formula,
  data = NULL,
  ...,
  subset,
  na.action = NULL,
  add = FALSE,
  ann = !add,
  horizontal = FALSE,
  side = "both",
  xlab = mklab(y_var = horizontal),
  ylab = mklab(y_var = !horizontal),
  names = NULL,
  drop = FALSE,
  sep = ".",
  lex.order = FALSE
)

## Default S3 method:
histoplot(
  x,
  ...,
  data = NULL,
  breaks = "Sturges",
  xlim = NULL,
  ylim = NULL,
  names = NULL,
  horizontal = FALSE,
  col = "grey50",
  border = par()$fg,
  lty = 1,
  lwd = 1,
  rectCol = par()$fg,
  lineCol = par()$fg,
  pchMed = 19,
  colMed = "white",
  colMed2 = "grey 75",
  at,
  add = FALSE,
  wex = 1,
  drawRect = TRUE,
  areaEqual = FALSE,
  axes = TRUE,
  frame.plot = axes,
  panel.first = NULL,
  panel.last = NULL,
  asp = NA,
  main = "",
  sub = "",
  xlab = NA,
  ylab = NA,
  line = NA,
  outer = FALSE,
  xlog = NA,
  ylog = NA,
  adj = NA,
  ann = NA,
  ask = NA,
  bg = NA,
  bty = NA,
  cex = NA,
  cex.axis = NA,
  cex.lab = NA,
  cex.main = NA,
  cex.names = NULL,
  cex.sub = NA,
  cin = NA,
  col.axis = NA,
  col.lab = NA,
  col.main = NA,
  col.sub = NA,
  cra = NA,
  crt = NA,
  csi = NA,
  cxy = NA,
  din = NA,
  err = NA,
  family = NA,
  fg = NA,
  fig = NA,
  fin = NA,
  font = NA,
  font.axis = NA,
  font.lab = NA,
  font.main = NA,
  font.sub = NA,
  lab = NA,
  las = NA,
  lend = NA,
  lheight = NA,
  ljoin = NA,
  lmitre = NA,
  mai = NA,
  mar = NA,
  mex = NA,
  mfcol = NA,
  mfg = NA,
  mfrow = NA,
  mgp = NA,
  mkh = NA,
  new = NA,
  oma = NA,
  omd = NA,
  omi = NA,
  page = NA,
  pch = NA,
  pin = NA,
  plt = NA,
  ps = NA,
  pty = NA,
  smo = NA,
  srt = NA,
  tck = NA,
  tcl = NA,
  usr = NA,
  xaxp = NA,
  xaxs = NA,
  xaxt = NA,
  xpd = NA,
  yaxp = NA,
  yaxs = NA,
  yaxt = NA,
  ylbias = NA,
  log = "",
  logLab = c(1, 2, 5),
  na.action = NULL,
  na.rm = T,
  side = "both"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="histoplot_+3A_x">x</code></td>
<td>
<p>a numeric matrix.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_...">...</code></td>
<td>
<p>Further arguments to <code><a href="#topic+histoplot">histoplot</a></code>.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_use.cols">use.cols</code></td>
<td>
<p>logical indicating if columns (by default) or rows (use.cols = FALSE) should be plotted.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_formula">formula</code></td>
<td>
<p>a formula, such as y ~ grp, where y is a numeric vector of data values to be split into groups according to the grouping variable grp (usually a factor).</p>
</td></tr>
<tr><td><code id="histoplot_+3A_data">data</code></td>
<td>
<p>a data.frame (or list) from which the variables in formula should be taken.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used for plotting.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. The default is to ignore missing values in either the response or the group.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_add">add</code></td>
<td>
<p>logical. if FALSE (default) a new plot is created</p>
</td></tr>
<tr><td><code id="histoplot_+3A_horizontal">horizontal</code></td>
<td>
<p>logical. To use horizontal or vertical histograms. Note that log scale can only be used on the x-axis for horizontal histograms, and on the y-axis otherwise.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_side">side</code></td>
<td>
<p>defaults to &quot;both&quot;. Assigning &quot;left&quot; or &quot;right&quot; enables one sided plotting of histograms. May be applied as a scalar across all groups.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_names">names</code></td>
<td>
<p>one label, or a vector of labels for the data must match the number of data given</p>
</td></tr>
<tr><td><code id="histoplot_+3A_drop">drop</code>, <code id="histoplot_+3A_sep">sep</code>, <code id="histoplot_+3A_lex.order">lex.order</code></td>
<td>
<p>defines groups to plot from formula, passed to <code>split.default</code>, see there.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_breaks">breaks</code></td>
<td>
<p>the breaks for the density estimator, as explained in hist</p>
</td></tr>
<tr><td><code id="histoplot_+3A_xlim">xlim</code>, <code id="histoplot_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y coordinates ranges.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_col">col</code></td>
<td>
<p>Graphical parameter for fill colour of the histogram(s) polygon. NA for no fill colour. If col is a vector, it specifies the colour per histogram, and colours are reused if necessary.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_border">border</code></td>
<td>
<p>Graphical parameters for the colour of the histogram border passed to lines. NA for no border. If border is a vector, it specifies the colour per histogram, and colours are reused if necessary.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_lty">lty</code>, <code id="histoplot_+3A_lwd">lwd</code></td>
<td>
<p>Graphical parameters for the histogram passed to lines and polygon</p>
</td></tr>
<tr><td><code id="histoplot_+3A_rectcol">rectCol</code></td>
<td>
<p>Graphical parameters to control fill colour of the box. NA for no fill colour. If col is a vector, it specifies the colour per histogram, and colours are reused if necessary.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_linecol">lineCol</code></td>
<td>
<p>Graphical parameters to control colour of the box outline and whiskers. NA for no border. If lineCol is a vector, it specifies the colour per histogram, and colours are reused if necessary.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_pchmed">pchMed</code></td>
<td>
<p>Graphical parameters to control shape of the median point. If pchMed is a vector, it specifies the shape per histogram.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_colmed">colMed</code>, <code id="histoplot_+3A_colmed2">colMed2</code></td>
<td>
<p>Graphical parameters to control colour of the median point. If colMed is a vector, it specifies the colour per histogram. colMed specifies the fill colour in all cases unless pchMed is 21:25 in which case colMed is the border colour and colMed2 is the fill colour.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_at">at</code></td>
<td>
<p>position of each histogram. Default to 1:n</p>
</td></tr>
<tr><td><code id="histoplot_+3A_wex">wex</code></td>
<td>
<p>relative expansion of the histogram.  If wex is a vector, it specifies the area/width size per histogram and sizes are reused if necessary.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_drawrect">drawRect</code></td>
<td>
<p>logical. The box is drawn if TRUE.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_areaequal">areaEqual</code></td>
<td>
<p>logical. Density plots checked for equal area if TRUE. wex must be scalar, relative widths of histograms depend on area.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_axes">axes</code>, <code id="histoplot_+3A_frame.plot">frame.plot</code>, <code id="histoplot_+3A_panel.first">panel.first</code>, <code id="histoplot_+3A_panel.last">panel.last</code>, <code id="histoplot_+3A_asp">asp</code>, <code id="histoplot_+3A_line">line</code>, <code id="histoplot_+3A_outer">outer</code>, <code id="histoplot_+3A_adj">adj</code>, <code id="histoplot_+3A_ann">ann</code>, <code id="histoplot_+3A_ask">ask</code>, <code id="histoplot_+3A_bg">bg</code>, <code id="histoplot_+3A_bty">bty</code>, <code id="histoplot_+3A_cin">cin</code>, <code id="histoplot_+3A_col.axis">col.axis</code>, <code id="histoplot_+3A_col.lab">col.lab</code>, <code id="histoplot_+3A_col.main">col.main</code>, <code id="histoplot_+3A_col.sub">col.sub</code>, <code id="histoplot_+3A_cra">cra</code>, <code id="histoplot_+3A_crt">crt</code>, <code id="histoplot_+3A_csi">csi</code>, <code id="histoplot_+3A_cxy">cxy</code>, <code id="histoplot_+3A_din">din</code>, <code id="histoplot_+3A_err">err</code>, <code id="histoplot_+3A_family">family</code>, <code id="histoplot_+3A_fg">fg</code>, <code id="histoplot_+3A_fig">fig</code>, <code id="histoplot_+3A_fin">fin</code>, <code id="histoplot_+3A_font">font</code>, <code id="histoplot_+3A_font.axis">font.axis</code>, <code id="histoplot_+3A_font.lab">font.lab</code>, <code id="histoplot_+3A_font.main">font.main</code>, <code id="histoplot_+3A_font.sub">font.sub</code>, <code id="histoplot_+3A_lab">lab</code>, <code id="histoplot_+3A_las">las</code>, <code id="histoplot_+3A_lend">lend</code>, <code id="histoplot_+3A_lheight">lheight</code>, <code id="histoplot_+3A_ljoin">ljoin</code>, <code id="histoplot_+3A_lmitre">lmitre</code>, <code id="histoplot_+3A_mai">mai</code>, <code id="histoplot_+3A_mar">mar</code>, <code id="histoplot_+3A_mex">mex</code>, <code id="histoplot_+3A_mfcol">mfcol</code>, <code id="histoplot_+3A_mfg">mfg</code>, <code id="histoplot_+3A_mfrow">mfrow</code>, <code id="histoplot_+3A_mgp">mgp</code>, <code id="histoplot_+3A_mkh">mkh</code>, <code id="histoplot_+3A_new">new</code>, <code id="histoplot_+3A_oma">oma</code>, <code id="histoplot_+3A_omd">omd</code>, <code id="histoplot_+3A_omi">omi</code>, <code id="histoplot_+3A_page">page</code>, <code id="histoplot_+3A_pch">pch</code>, <code id="histoplot_+3A_pin">pin</code>, <code id="histoplot_+3A_plt">plt</code>, <code id="histoplot_+3A_ps">ps</code>, <code id="histoplot_+3A_pty">pty</code>, <code id="histoplot_+3A_smo">smo</code>, <code id="histoplot_+3A_srt">srt</code>, <code id="histoplot_+3A_tck">tck</code>, <code id="histoplot_+3A_tcl">tcl</code>, <code id="histoplot_+3A_usr">usr</code>, <code id="histoplot_+3A_xaxp">xaxp</code>, <code id="histoplot_+3A_xaxs">xaxs</code>, <code id="histoplot_+3A_xaxt">xaxt</code>, <code id="histoplot_+3A_xpd">xpd</code>, <code id="histoplot_+3A_yaxp">yaxp</code>, <code id="histoplot_+3A_yaxs">yaxs</code>, <code id="histoplot_+3A_ylbias">ylbias</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>)).</p>
</td></tr>
<tr><td><code id="histoplot_+3A_main">main</code>, <code id="histoplot_+3A_sub">sub</code>, <code id="histoplot_+3A_xlab">xlab</code>, <code id="histoplot_+3A_ylab">ylab</code></td>
<td>
<p>graphical parameters passed to plot.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_ylog">ylog</code>, <code id="histoplot_+3A_xlog">xlog</code></td>
<td>
<p>A logical value (see log in <code><a href="graphics.html#topic+plot.default">plot.default</a></code>). If ylog is TRUE, a logarithmic scale is in use (e.g., after plot(*, log = &quot;y&quot;)). For horizontal = TRUE then, if xlog is TRUE, a logarithmic scale is in use (e.g., after plot(*, log = &quot;x&quot;)). For a new device, it defaults to FALSE, i.e., linear scale.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_cex">cex</code></td>
<td>
<p>A numerical value giving the amount by which plotting text should be magnified relative to the default.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The magnification to be used for y axis annotation relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_cex.lab">cex.lab</code></td>
<td>
<p>The magnification to be used for x and y labels relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_cex.main">cex.main</code></td>
<td>
<p>The magnification to be used for main titles relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_cex.names">cex.names</code></td>
<td>
<p>The magnification to be used for x axis annotation relative to the current setting of cex. Takes the value of cex.axis if not given.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_cex.sub">cex.sub</code></td>
<td>
<p>The magnification to be used for sub-titles relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_yaxt">yaxt</code></td>
<td>
<p>A character which specifies the y axis type. Specifying &quot;n&quot; suppresses plotting.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_log">log</code></td>
<td>
<p>Logarithmic scale if log = &quot;y&quot; or TRUE. Invokes ylog = TRUE. If horizontal is TRUE then invokes xlog = TRUE.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_loglab">logLab</code></td>
<td>
<p>Increments for labelling y-axis on log-scale, defaults to numbers starting with 1, 2, 5, and 10.</p>
</td></tr>
<tr><td><code id="histoplot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical value indicating whether NA values should be stripped before the computation proceeds. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# box- vs histogram-plot
par(mfrow=c(2,1))
mu&lt;-2
si&lt;-0.6
bimodal&lt;-c(rnorm(1000,-mu,si),rnorm(1000,mu,si))
uniform&lt;-runif(2000,-4,4)
normal&lt;-rnorm(2000,0,3)
histoplot(bimodal,uniform,normal)
boxplot(bimodal,uniform,normal)

# add to an existing plot
x &lt;- rnorm(100)
y &lt;- rnorm(100)
plot(x, y, xlim=c(-5,5), ylim=c(-5,5))
histoplot(x, col="tomato", horizontal=TRUE, at=-4, add=TRUE,lty=2, rectCol="gray")
histoplot(y, col="cyan", horizontal=FALSE, at=-4, add=TRUE,lty=2)

# formula input
data("iris")
histoplot(Sepal.Length~Species, data = iris, main = "Sepal Length",
        col=c("lightgreen", "lightblue", "palevioletred"))
legend("topleft", legend=c("setosa", "versicolor", "virginica"),
       fill=c("lightgreen", "lightblue", "palevioletred"), cex = 0.5)

data("diamonds", package = "ggplot2")
palette &lt;- RColorBrewer::brewer.pal(9, "Pastel1")
par(mfrow=c(3, 1))
histoplot(price ~ cut, data = diamonds, las = 1, col = palette)
histoplot(price ~ clarity, data = diamonds, las = 2, col = palette)
histoplot(price ~ color, data = diamonds, las = 2, col = palette)
par(mfrow=c(3, 1))

#generate example data
data_one &lt;- rnorm(100)
data_two &lt;- rnorm(50, 1, 2)

#generate histogram plot with similar functionality to histoplot
histoplot(data_one, data_two, col="magenta")

#note vioplox defaults to a greyscale plot
histoplot(data_one, data_two)

#colours can be customised separately, with axis labels, legends, and titles
histoplot(data_one, data_two, col=c("red","blue"), names=c("data one", "data two"),
   main="data histogram", xlab="data class", ylab="data read")
legend("topleft", fill=c("red","blue"), legend=c("data one", "data two"))

#colours can be customised for the histogram fill and border separately
histoplot(data_one, data_two, col="grey85", border="purple", names=c("data one", "data two"),
   main="data histogram", xlab="data class", ylab="data read")

#colours can also be customised for the boxplot rectange and lines (border and whiskers)
histoplot(data_one, data_two, col="grey85", rectCol="lightblue", lineCol="blue",
   border="purple", names=c("data one", "data two"),
   main="data histogram", xlab="data class", ylab="data read")

#these colours can also be customised separately for each histogram
histoplot(data_one, data_two, col=c("skyblue", "plum"), rectCol=c("lightblue", "palevioletred"),
   lineCol="blue", border=c("royalblue", "purple"), names=c("data one", "data two"),
   main="data histogram", xlab="data class", ylab="data read")

#this applies to any number of histograms, given that colours are provided for each
histoplot(data_one, data_two, rnorm(200, 3, 0.5), rpois(200, 2.5),  rbinom(100, 10, 0.4),
   col=c("red", "orange", "green", "blue", "violet"),
   rectCol=c("palevioletred", "peachpuff", "lightgreen", "lightblue", "plum"),
   lineCol=c("red4", "orangered", "forestgreen", "royalblue", "mediumorchid"),
   border=c("red4", "orangered", "forestgreen", "royalblue", "mediumorchid"),
   names=c("data one", "data two", "data three", "data four", "data five"),
   main="data histogram", xlab="data class", ylab="data read")

#The areaEqual parameter scales with width of histograms
#histograms will have equal density area (including missing tails) rather than equal maximum width
histoplot(data_one, data_two, areaEqual=TRUE)

histoplot(data_one, data_two, areaEqual=TRUE,
   col=c("skyblue", "plum"), rectCol=c("lightblue", "palevioletred"),
   lineCol="blue", border=c("royalblue", "purple"), names=c("data one", "data two"),
   main="data histogram", xlab="data class", ylab="data read")

histoplot(data_one, data_two, rnorm(200, 3, 0.5), rpois(200, 2.5),  rbinom(100, 10, 0.4),
   areaEqual=TRUE, col=c("red", "orange", "green", "blue", "violet"),
   rectCol=c("palevioletred", "peachpuff", "lightgreen", "lightblue", "plum"),
   lineCol=c("red4", "orangered", "forestgreen", "royalblue", "mediumorchid"),
   border=c("red4", "orangered", "forestgreen", "royalblue", "mediumorchid"),
   names=c("data one", "data two", "data three", "data four", "data five"),
   main="data histogram", xlab="data class", ylab="data read")
</code></pre>

<hr>
<h2 id='vioplot'>Violin Plot</h2><span id='topic+vioplot'></span><span id='topic+violinplot'></span><span id='topic+vioplot.matrix'></span><span id='topic+violin.matrix'></span><span id='topic+violinplot.matrix'></span><span id='topic+vioplot.list'></span><span id='topic+vioplot.data.frame'></span><span id='topic+vioplot.formula'></span><span id='topic+vioplot.default'></span>

<h3>Description</h3>

<p>Produce violin plot(s) of the given (grouped) values with enhanced annotation and colour per group. Includes customisation of colours for each aspect of the violin, boxplot, and separate violins. This supports input of data as a list or formula, being backwards compatible with <code><a href="#topic+vioplot">vioplot</a></code> (0.2) and taking input in a formula as used for <code><a href="graphics.html#topic+boxplot">boxplot</a></code>.
</p>
<p>Interpreting the columns (or rows) of a matrix as different groups, draw a boxplot for each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'matrix'
vioplot(x, use.cols = TRUE, ...)

## S3 method for class 'list'
vioplot(x, ...)

## S3 method for class 'data.frame'
vioplot(x, ...)

## S3 method for class 'matrix'
vioplot(x, use.cols = TRUE, ...)

## S3 method for class 'formula'
vioplot(
  formula,
  data = NULL,
  ...,
  subset,
  na.action = NULL,
  add = FALSE,
  ann = !add,
  horizontal = FALSE,
  side = "both",
  xlab = mklab(y_var = horizontal),
  ylab = mklab(y_var = !horizontal),
  names = NULL,
  drop = FALSE,
  sep = ".",
  lex.order = FALSE
)

## Default S3 method:
vioplot(
  x,
  ...,
  data = NULL,
  range = 1.5,
  h = NULL,
  xlim = NULL,
  ylim = NULL,
  names = NULL,
  horizontal = FALSE,
  col = "grey50",
  border = par()$fg,
  lty = 1,
  lwd = 1,
  rectCol = par()$fg,
  lineCol = par()$fg,
  pchMed = 19,
  colMed = "white",
  colMed2 = "grey 75",
  at,
  add = FALSE,
  wex = 1,
  drawRect = TRUE,
  areaEqual = FALSE,
  axes = TRUE,
  frame.plot = axes,
  panel.first = NULL,
  panel.last = NULL,
  asp = NA,
  main = "",
  sub = "",
  xlab = NA,
  ylab = NA,
  line = NA,
  outer = FALSE,
  xlog = NA,
  ylog = NA,
  adj = NA,
  ann = NA,
  ask = NA,
  bg = NA,
  bty = NA,
  cex = NA,
  cex.axis = NA,
  cex.lab = NA,
  cex.main = NA,
  cex.names = NULL,
  cex.sub = NA,
  cin = NA,
  col.axis = NA,
  col.lab = NA,
  col.main = NA,
  col.sub = NA,
  cra = NA,
  crt = NA,
  csi = NA,
  cxy = NA,
  din = NA,
  err = NA,
  family = NA,
  fg = NA,
  fig = NA,
  fin = NA,
  font = NA,
  font.axis = NA,
  font.lab = NA,
  font.main = NA,
  font.sub = NA,
  lab = NA,
  las = NA,
  lend = NA,
  lheight = NA,
  ljoin = NA,
  lmitre = NA,
  mai = NA,
  mar = NA,
  mex = NA,
  mfcol = NA,
  mfg = NA,
  mfrow = NA,
  mgp = NA,
  mkh = NA,
  new = NA,
  oma = NA,
  omd = NA,
  omi = NA,
  page = NA,
  pch = NA,
  pin = NA,
  plt = NA,
  ps = NA,
  pty = NA,
  smo = NA,
  srt = NA,
  tck = NA,
  tcl = NA,
  usr = NA,
  xaxp = NA,
  xaxs = NA,
  xaxt = NA,
  xpd = NA,
  yaxp = NA,
  yaxs = NA,
  yaxt = NA,
  ylbias = NA,
  log = "",
  logLab = c(1, 2, 5),
  na.action = NULL,
  na.rm = T,
  side = "both",
  plotCentre = "point"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vioplot_+3A_x">x</code></td>
<td>
<p>a numeric matrix.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_...">...</code></td>
<td>
<p>Further arguments to <code><a href="#topic+vioplot">vioplot</a></code>.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_use.cols">use.cols</code></td>
<td>
<p>logical indicating if columns (by default) or rows (use.cols = FALSE) should be plotted.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_formula">formula</code></td>
<td>
<p>a formula, such as y ~ grp, where y is a numeric vector of data values to be split into groups according to the grouping variable grp (usually a factor).</p>
</td></tr>
<tr><td><code id="vioplot_+3A_data">data</code></td>
<td>
<p>a data.frame (or list) from which the variables in formula should be taken.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used for plotting.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. The default is to ignore missing values in either the response or the group.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_add">add</code></td>
<td>
<p>logical. if FALSE (default) a new plot is created</p>
</td></tr>
<tr><td><code id="vioplot_+3A_horizontal">horizontal</code></td>
<td>
<p>logical. To use horizontal or vertical violins. Note that log scale can only be used on the x-axis for horizontal violins, and on the y-axis otherwise.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_side">side</code></td>
<td>
<p>defaults to &quot;both&quot;. Assigning &quot;left&quot; or &quot;right&quot; enables one sided plotting of violins. May be applied as a scalar across all groups.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_names">names</code></td>
<td>
<p>one label, or a vector of labels for the data must match the number of data given</p>
</td></tr>
<tr><td><code id="vioplot_+3A_drop">drop</code>, <code id="vioplot_+3A_sep">sep</code>, <code id="vioplot_+3A_lex.order">lex.order</code></td>
<td>
<p>defines groups to plot from formula, passed to <code>split.default</code>, see there.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_range">range</code></td>
<td>
<p>a factor to calculate the upper/lower adjacent values</p>
</td></tr>
<tr><td><code id="vioplot_+3A_h">h</code></td>
<td>
<p>the height for the density estimator, if omit as explained in sm.density, h will be set to an optimum.  A vector of length one, two or three, defining the smoothing parameter. A normal kernel function is used and h is its standard deviation. If this parameter is omitted, a normal optimal smoothing parameter is used.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_xlim">xlim</code>, <code id="vioplot_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y coordinates ranges.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_col">col</code></td>
<td>
<p>Graphical parameter for fill colour of the violin(s) polygon. NA for no fill colour. If col is a vector, it specifies the colour per violin, and colours are reused if necessary.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_border">border</code></td>
<td>
<p>Graphical parameters for the colour of the violin border passed to lines. NA for no border. If border is a vector, it specifies the colour per violin, and colours are reused if necessary.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_lty">lty</code>, <code id="vioplot_+3A_lwd">lwd</code></td>
<td>
<p>Graphical parameters for the violin passed to lines and polygon</p>
</td></tr>
<tr><td><code id="vioplot_+3A_rectcol">rectCol</code></td>
<td>
<p>Graphical parameters to control fill colour of the box. NA for no fill colour. If col is a vector, it specifies the colour per violin, and colours are reused if necessary.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_linecol">lineCol</code></td>
<td>
<p>Graphical parameters to control colour of the box outline and whiskers. NA for no border. If lineCol is a vector, it specifies the colour per violin, and colours are reused if necessary.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_pchmed">pchMed</code></td>
<td>
<p>Graphical parameters to control shape of the median point. If pchMed is a vector, it specifies the shape per violin.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_colmed">colMed</code>, <code id="vioplot_+3A_colmed2">colMed2</code></td>
<td>
<p>Graphical parameters to control colour of the median point. If colMed is a vector, it specifies the colour per violin. colMed specifies the fill colour in all cases unless pchMed is 21:25 in which case colMed is the border colour and colMed2 is the fill colour.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_at">at</code></td>
<td>
<p>position of each violin. Default to 1:n</p>
</td></tr>
<tr><td><code id="vioplot_+3A_wex">wex</code></td>
<td>
<p>relative expansion of the violin.  If wex is a vector, it specifies the area/width size per violin and sizes are reused if necessary.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_drawrect">drawRect</code></td>
<td>
<p>logical. The box is drawn if TRUE.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_areaequal">areaEqual</code></td>
<td>
<p>logical. Density plots checked for equal area if TRUE. wex must be scalar, relative widths of violins depend on area.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_axes">axes</code>, <code id="vioplot_+3A_frame.plot">frame.plot</code>, <code id="vioplot_+3A_panel.first">panel.first</code>, <code id="vioplot_+3A_panel.last">panel.last</code>, <code id="vioplot_+3A_asp">asp</code>, <code id="vioplot_+3A_line">line</code>, <code id="vioplot_+3A_outer">outer</code>, <code id="vioplot_+3A_adj">adj</code>, <code id="vioplot_+3A_ann">ann</code>, <code id="vioplot_+3A_ask">ask</code>, <code id="vioplot_+3A_bg">bg</code>, <code id="vioplot_+3A_bty">bty</code>, <code id="vioplot_+3A_cin">cin</code>, <code id="vioplot_+3A_col.axis">col.axis</code>, <code id="vioplot_+3A_col.lab">col.lab</code>, <code id="vioplot_+3A_col.main">col.main</code>, <code id="vioplot_+3A_col.sub">col.sub</code>, <code id="vioplot_+3A_cra">cra</code>, <code id="vioplot_+3A_crt">crt</code>, <code id="vioplot_+3A_csi">csi</code>, <code id="vioplot_+3A_cxy">cxy</code>, <code id="vioplot_+3A_din">din</code>, <code id="vioplot_+3A_err">err</code>, <code id="vioplot_+3A_family">family</code>, <code id="vioplot_+3A_fg">fg</code>, <code id="vioplot_+3A_fig">fig</code>, <code id="vioplot_+3A_fin">fin</code>, <code id="vioplot_+3A_font">font</code>, <code id="vioplot_+3A_font.axis">font.axis</code>, <code id="vioplot_+3A_font.lab">font.lab</code>, <code id="vioplot_+3A_font.main">font.main</code>, <code id="vioplot_+3A_font.sub">font.sub</code>, <code id="vioplot_+3A_lab">lab</code>, <code id="vioplot_+3A_las">las</code>, <code id="vioplot_+3A_lend">lend</code>, <code id="vioplot_+3A_lheight">lheight</code>, <code id="vioplot_+3A_ljoin">ljoin</code>, <code id="vioplot_+3A_lmitre">lmitre</code>, <code id="vioplot_+3A_mai">mai</code>, <code id="vioplot_+3A_mar">mar</code>, <code id="vioplot_+3A_mex">mex</code>, <code id="vioplot_+3A_mfcol">mfcol</code>, <code id="vioplot_+3A_mfg">mfg</code>, <code id="vioplot_+3A_mfrow">mfrow</code>, <code id="vioplot_+3A_mgp">mgp</code>, <code id="vioplot_+3A_mkh">mkh</code>, <code id="vioplot_+3A_new">new</code>, <code id="vioplot_+3A_oma">oma</code>, <code id="vioplot_+3A_omd">omd</code>, <code id="vioplot_+3A_omi">omi</code>, <code id="vioplot_+3A_page">page</code>, <code id="vioplot_+3A_pch">pch</code>, <code id="vioplot_+3A_pin">pin</code>, <code id="vioplot_+3A_plt">plt</code>, <code id="vioplot_+3A_ps">ps</code>, <code id="vioplot_+3A_pty">pty</code>, <code id="vioplot_+3A_smo">smo</code>, <code id="vioplot_+3A_srt">srt</code>, <code id="vioplot_+3A_tck">tck</code>, <code id="vioplot_+3A_tcl">tcl</code>, <code id="vioplot_+3A_usr">usr</code>, <code id="vioplot_+3A_xaxp">xaxp</code>, <code id="vioplot_+3A_xaxs">xaxs</code>, <code id="vioplot_+3A_xaxt">xaxt</code>, <code id="vioplot_+3A_xpd">xpd</code>, <code id="vioplot_+3A_yaxp">yaxp</code>, <code id="vioplot_+3A_yaxs">yaxs</code>, <code id="vioplot_+3A_ylbias">ylbias</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>)).</p>
</td></tr>
<tr><td><code id="vioplot_+3A_main">main</code>, <code id="vioplot_+3A_sub">sub</code>, <code id="vioplot_+3A_xlab">xlab</code>, <code id="vioplot_+3A_ylab">ylab</code></td>
<td>
<p>graphical parameters passed to plot.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_ylog">ylog</code>, <code id="vioplot_+3A_xlog">xlog</code></td>
<td>
<p>A logical value (see log in <code><a href="graphics.html#topic+plot.default">plot.default</a></code>). If ylog is TRUE, a logarithmic scale is in use (e.g., after plot(*, log = &quot;y&quot;)). For horizontal = TRUE then, if xlog is TRUE, a logarithmic scale is in use (e.g., after plot(*, log = &quot;x&quot;)). For a new device, it defaults to FALSE, i.e., linear scale.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_cex">cex</code></td>
<td>
<p>A numerical value giving the amount by which plotting text should be magnified relative to the default.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The magnification to be used for y axis annotation relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_cex.lab">cex.lab</code></td>
<td>
<p>The magnification to be used for x and y labels relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_cex.main">cex.main</code></td>
<td>
<p>The magnification to be used for main titles relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_cex.names">cex.names</code></td>
<td>
<p>The magnification to be used for x axis annotation relative to the current setting of cex. Takes the value of cex.axis if not given.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_cex.sub">cex.sub</code></td>
<td>
<p>The magnification to be used for sub-titles relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_yaxt">yaxt</code></td>
<td>
<p>A character which specifies the y axis type. Specifying &quot;n&quot; suppresses plotting.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_log">log</code></td>
<td>
<p>Logarithmic scale if log = &quot;y&quot; or TRUE. Invokes ylog = TRUE. If horizontal is TRUE then invokes xlog = TRUE.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_loglab">logLab</code></td>
<td>
<p>Increments for labelling y-axis on log-scale, defaults to numbers starting with 1, 2, 5, and 10.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical value indicating whether NA values should be stripped before the computation proceeds. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="vioplot_+3A_plotcentre">plotCentre</code></td>
<td>
<p>defaults to &quot;points&quot;, plotting a central point at the median. If &quot;line&quot; is given a median line is plotted (subject to side) alternatively.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# box- vs violin-plot
par(mfrow=c(2,1))
mu&lt;-2
si&lt;-0.6
bimodal&lt;-c(rnorm(1000,-mu,si),rnorm(1000,mu,si))
uniform&lt;-runif(2000,-4,4)
normal&lt;-rnorm(2000,0,3)
vioplot(bimodal,uniform,normal)
boxplot(bimodal,uniform,normal)

# add to an existing plot
x &lt;- rnorm(100)
y &lt;- rnorm(100)
plot(x, y, xlim=c(-5,5), ylim=c(-5,5))
vioplot(x, col="tomato", horizontal=TRUE, at=-4, add=TRUE,lty=2, rectCol="gray")
vioplot(y, col="cyan", horizontal=FALSE, at=-4, add=TRUE,lty=2)

# formula input
data("iris")
vioplot(Sepal.Length~Species, data = iris, main = "Sepal Length",
        col=c("lightgreen", "lightblue", "palevioletred"))
legend("topleft", legend=c("setosa", "versicolor", "virginica"),
       fill=c("lightgreen", "lightblue", "palevioletred"), cex = 0.5)

data("diamonds", package = "ggplot2")
palette &lt;- RColorBrewer::brewer.pal(9, "Pastel1")
par(mfrow=c(3, 1))
vioplot(price ~ cut, data = diamonds, las = 1, col = palette)
vioplot(price ~ clarity, data = diamonds, las = 2, col = palette)
vioplot(price ~ color, data = diamonds, las = 2, col = palette)
par(mfrow=c(3, 1))

#generate example data
data_one &lt;- rnorm(100)
data_two &lt;- rnorm(50, 1, 2)

#generate violin plot with similar functionality to vioplot
vioplot(data_one, data_two, col="magenta")

#note vioplox defaults to a greyscale plot
vioplot(data_one, data_two)

#colours can be customised separately, with axis labels, legends, and titles
vioplot(data_one, data_two, col=c("red","blue"), names=c("data one", "data two"),
   main="data violin", xlab="data class", ylab="data read")
legend("topleft", fill=c("red","blue"), legend=c("data one", "data two"))

#colours can be customised for the violin fill and border separately
vioplot(data_one, data_two, col="grey85", border="purple", names=c("data one", "data two"),
   main="data violin", xlab="data class", ylab="data read")

#colours can also be customised for the boxplot rectange and lines (border and whiskers)
vioplot(data_one, data_two, col="grey85", rectCol="lightblue", lineCol="blue",
   border="purple", names=c("data one", "data two"),
   main="data violin", xlab="data class", ylab="data read")

#these colours can also be customised separately for each violin
vioplot(data_one, data_two, col=c("skyblue", "plum"), rectCol=c("lightblue", "palevioletred"),
   lineCol="blue", border=c("royalblue", "purple"), names=c("data one", "data two"),
   main="data violin", xlab="data class", ylab="data read")

#this applies to any number of violins, given that colours are provided for each
vioplot(data_one, data_two, rnorm(200, 3, 0.5), rpois(200, 2.5),  rbinom(100, 10, 0.4),
   col=c("red", "orange", "green", "blue", "violet"),
   rectCol=c("palevioletred", "peachpuff", "lightgreen", "lightblue", "plum"),
   lineCol=c("red4", "orangered", "forestgreen", "royalblue", "mediumorchid"),
   border=c("red4", "orangered", "forestgreen", "royalblue", "mediumorchid"),
   names=c("data one", "data two", "data three", "data four", "data five"),
   main="data violin", xlab="data class", ylab="data read")

#The areaEqual parameter scales with width of violins
#Violins will have equal density area (including missing tails) rather than equal maximum width
vioplot(data_one, data_two, areaEqual=TRUE)

vioplot(data_one, data_two, areaEqual=TRUE,
   col=c("skyblue", "plum"), rectCol=c("lightblue", "palevioletred"),
   lineCol="blue", border=c("royalblue", "purple"), names=c("data one", "data two"),
   main="data violin", xlab="data class", ylab="data read")

vioplot(data_one, data_two, rnorm(200, 3, 0.5), rpois(200, 2.5),  rbinom(100, 10, 0.4),
   areaEqual=TRUE, col=c("red", "orange", "green", "blue", "violet"),
   rectCol=c("palevioletred", "peachpuff", "lightgreen", "lightblue", "plum"),
   lineCol=c("red4", "orangered", "forestgreen", "royalblue", "mediumorchid"),
   border=c("red4", "orangered", "forestgreen", "royalblue", "mediumorchid"),
   names=c("data one", "data two", "data three", "data four", "data five"),
   main="data violin", xlab="data class", ylab="data read")
</code></pre>

<hr>
<h2 id='vioplot.stats'>Violin Plot Statistics</h2><span id='topic+vioplot.stats'></span><span id='topic+violin.stats'></span><span id='topic+violinplot.stats'></span>

<h3>Description</h3>

<p>This function is typically called by another function to gather the statistics necessary
for producing box plots, but may be invoked separately. See: <code><a href="grDevices.html#topic+boxplot.stats">boxplot.stats</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stats'
vioplot(x, coef = 1.5, do.conf = TRUE, do.out = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vioplot.stats_+3A_x">x</code></td>
<td>
<p>a numeric vector for which the violin plot will be constructed <code>NA</code>s and <code>NaN</code>s are allowed and omitted).</p>
</td></tr>
<tr><td><code id="vioplot.stats_+3A_coef">coef</code></td>
<td>
<p>this determines how far the plot ‘whiskers’ extend out from the box. If coef is positive, the
whiskers extend to the most extreme data point which is no more than coef times the length of the box away
from the box. A value of zero causes the whiskers to extend to the data extremes (and no outliers be returned).</p>
</td></tr>
<tr><td><code id="vioplot.stats_+3A_do.conf">do.conf</code>, <code id="vioplot.stats_+3A_do.out">do.out</code></td>
<td>
<p>logicals; if FALSE, the conf or out component respectively will be empty in the result.</p>
</td></tr>
<tr><td><code id="vioplot.stats_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="#topic+vioplot">vioplot</a></code>.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
