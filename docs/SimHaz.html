<!DOCTYPE html><html lang="en"><head><title>Help for package SimHaz</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SimHaz}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SimHaz-package'>
<p>Simulated Survival and Hazard Analysis for time-dependent</p></a></li>
<li><a href='#getpower.clst'>
<p>Calculate power for the Cox proportional hazard model with</p>
time-dependent exposure using method 1 with clustering</a></li>
<li><a href='#getpower.method1'>
<p>Calculate power for the Cox proportional hazard model with</p>
time-dependent exposure using method 1</a></li>
<li><a href='#getpower.method2'>
<p>Calculate power for the Cox proportional hazard model with</p>
time-dependent exposure using method 2</a></li>
<li><a href='#plot_power'>
<p>Plot power curves for survival analysis with time-dependent exposure</p></a></li>
<li><a href='#plot_simuData'>
<p>Make an incidence plot from simulated data.</p></a></li>
<li><a href='#tdSim.clst'>
<p>Simulate 1 dataframe (1 simulation) of time-dependent exposure</p>
under method 1 with a clustering data frame</a></li>
<li><a href='#tdSim.method1'>
<p>Simulate 1 dataframe (1 simulation) of time-dep exposure under method 1</p></a></li>
<li><a href='#tdSim.method2'>
<p>Simulate 1 dataframe (1 simulation) of time-dep exposure under method 2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-09-29</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulated Survival and Hazard Analysis for Time-Dependent
Exposure</td>
</tr>
<tr>
<td>Author:</td>
<td>Danyi Xiong, Teeranan Pokaprakarn, Hiroto Udagawa, Nusrat Rabbee</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nusrat Rabbee &lt;rabbee@berkeley.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival</td>
</tr>
<tr>
<td>Description:</td>
<td>Generate power for the Cox proportional hazards model by simulating survival events data with time dependent exposure status for subjects. A dichotomous exposure variable is considered with a single transition from unexposed to exposed status during the subject's time on study.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.stat.berkeley.edu/~rabbee/research_webpage.htm">http://www.stat.berkeley.edu/~rabbee/research_webpage.htm</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/rabbeelab/SimHaz/issues">https://github.com/rabbeelab/SimHaz/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-10-19 04:26:18 UTC; hiroto</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-10-19 08:41:51</td>
</tr>
</table>
<hr>
<h2 id='SimHaz-package'>
Simulated Survival and Hazard Analysis for time-dependent
</h2><span id='topic+SimHaz-package'></span><span id='topic+SimHaz'></span>

<h3>Description</h3>

<p>This package generates power for the Cox proportional hazards model by simulating survival events data with time dependent exposure status for subjects. A dichotomous exposure variable is considered with a single transition from unexposed to exposed status during the subject time's in the study.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> SimHaz</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.1 </td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-09-29</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 </td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: R (&gt;= 3.1.1)
Imports: survival
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Danyi Xiong, Teeranan Pokaprakarn, Hiroto Udagawa, Nusrat Rabbee <br />
Maintainer: Nusrat Rabbee &lt;rabbee@berkeley.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a dataset of 600 subjects with time-dependent exposure without
# considering minimum follow-up time or minimum post-exposure follow-up time.
# Specifically, set the duration of the study to be 24 months; the median time to
# event for control group to be 24 months; exposure effect to be 0.3; median time
# to censoring to be 14 months; and exposure proportion to be 20%.

df1 &lt;- tdSim.method1(N = 600, duration = 24, lambda = log(2)/24, rho = 1, 
   beta = 0.3, rateC = log(2)/14, exp.prop = 0.2, 
   prop.fullexp  = 0, maxrelexptime = 1, min.futime = 0,
   min.postexp.futime = 0)
   
# We recommend setting nSim to at least 500. It is set to 10 in the example to
# reduce run time for CRAN submission.

ret &lt;- getpower.method1(nSim = 10, N = 600, b = 0.3, exp.prop = 0.2, 
	type = "td", scenario = " ", maxrelexptime = 1/6, min.futime = 4,
	min.postexp.futime = 4, output.fn = "output.csv")

</code></pre>

<hr>
<h2 id='getpower.clst'>
Calculate power for the Cox proportional hazard model with
time-dependent exposure using method 1 with clustering
</h2><span id='topic+getpower.clst'></span>

<h3>Description</h3>

<p>This functions runs nSim (number of simulations; specified by the user) Monte Carlo simulations on the Cox proportional model with a cluster option. At each simulation, the function calls tdSim.clst internally. The function returns a data frame of scenario-specific parameters (including statistical power) and appends the output to a file with file name specified in the input parameters list. The user also has an option to display an incidence plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getpower.clst(nSim, N, duration = 24, med.TTE.Control = 24, rho = 1, beta,
    med.TimeToCensor = 14, df, type, scenario, prop.fullexp = 0,
    maxrelexptime = 1, min.futime = 0, min.postexp.futime = 0, output.fn,
    simu.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getpower.clst_+3A_nsim">nSim</code></td>
<td>

<p>Number of simulations.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_n">N</code></td>
<td>

<p>Number of subjects to be screened.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_duration">duration</code></td>
<td>

<p>Length of the study in months; the default value is 24 (months).
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_med.tte.control">med.TTE.Control</code></td>
<td>

<p>Median time to event for control group; the default value is 24 (months).
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_rho">rho</code></td>
<td>

<p>Shape parameter of the Weibull distribution. Default is 1, which will generate survival times by using the exponential distribution.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_beta">beta</code></td>
<td>

<p>A numeric value that represents the exposure effect, which is the regression coefficient (log hazard ratio) that represents the magnitude of the relationship between the exposure covariate and the risk of an event. 
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_med.timetocensor">med.TimeToCensor</code></td>
<td>

<p>Median time to censoring for all subjects. The default value is 14 (months). Also see help document for tdSim.method1.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_df">df</code></td>
<td>

<p>A user-specified n by 3 clustering data frame with columns corresponding to cat_id (category id, which is the physician site id. It can be either text strings or integers), cat_prop (category proportion, which is the proportion of subjects in corresponding a category id), and cat_exprate (category exposure rate, which is the exposure proportion corresponding to a category id). n rows corresponds to n different physician sites.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_type">type</code></td>
<td>

<p>A text string indicating the what type of dataset is of interest. Either &quot;fixed&quot; or &quot;td&quot; should be inputted.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_scenario">scenario</code></td>
<td>

<p>A text string to name a scenario that is being simulated. The user can simply put &quot; &quot; if he/she decides to not name the scenario.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_prop.fullexp">prop.fullexp</code></td>
<td>

<p>A numeric value in interval [0, 1) that represents the proportion of exposed subjects that are fully exposed from the beginning to the end of the study. The default value is 0, which means all exposed subjects have an exposure status transition at some point during the study.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_maxrelexptime">maxrelexptime</code></td>
<td>

<p>A numeric value that represents minimum post-exposure follow-up time (in months). The default value is 0, which means no minimum post-exposure follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study after their exposure.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_min.futime">min.futime</code></td>
<td>

<p>A numeric value that represents minimum follow-up time (in months). The default value is 0, which means no minimum follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_min.postexp.futime">min.postexp.futime</code></td>
<td>

<p>A numeric value that represents minimum post-exposure follow-up time (in months). The default value is 0, which means no minimum post-exposure follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study after their exposure.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_output.fn">output.fn</code></td>
<td>

<p>A .csv filename to write in the output. If the filename does not exist, the function will create a new .csv file for the output.
</p>
</td></tr>
<tr><td><code id="getpower.clst_+3A_simu.plot">simu.plot</code></td>
<td>

<p>A logical value indicating whether or not to output an incidence plot.The default value is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates power based on the Cox regression model, which calls the coxph function from the survival library using the the simulated data from tdSim.clst
</p>


<h3>Value</h3>

<p>A data.frame object with 3 rows and columns corresponding to
</p>
<table role = "presentation">
<tr><td><code>i_scenario</code></td>
<td>

<p>Scenario name specified by the user.
</p>
</td></tr>
<tr><td><code>i_type</code></td>
<td>

<p>Dataset type specified by the user.
</p>
</td></tr>
<tr><td><code>i_N</code></td>
<td>

<p>Number of subjects to be screened, specified by the user.
</p>
</td></tr>
<tr><td><code>i_min.futime</code></td>
<td>

<p>Minimum follow-up time to be considered, specified by the user.
</p>
</td></tr>
<tr><td><code>i_min.postexp.futime</code></td>
<td>

<p>Minimum post-exposure follow-up time to be considered, specified by the user.
</p>
</td></tr>
<tr><td><code>i_cat</code></td>
<td>

<p>Category id specified in user's input data frame.
</p>
</td></tr>
<tr><td><code>i_cat_prop</code></td>
<td>

<p>Category proportion specified in user's input data frame.
</p>
</td></tr>
<tr><td><code>i_cat_exp.prop</code></td>
<td>

<p>Category exposure proportion specified in user's input dataframe.
</p>
</td></tr>
<tr><td><code>i_exp.prop</code></td>
<td>

<p>Weighted exposure proportion calculated from user's input dataframe.
</p>
</td></tr>
<tr><td><code>i_lambda</code></td>
<td>

<p>Value of the scale parameter of the Weibull distribution to generate survival times. Calculated from median time to event for control group, which is specified by the user.
</p>
</td></tr>
<tr><td><code>i_rho</code></td>
<td>

<p>User-specified Value of the shape parameter of the Weibull distribution to generate survival times.
</p>
</td></tr>
<tr><td><code>i_rateC</code></td>
<td>

<p>Rate of the exponential distribution to generate censoring times. Calculated from median time to censoring, which is specified by the user.
</p>
</td></tr>
<tr><td><code>i_beta</code></td>
<td>
<p>Input value of regression coefficient (log hazard ratio).
</p>
</td></tr>
<tr><td><code>N_eff</code></td>
<td>

<p>Simulated number of evaluable subjects, which is the resulting number of subjects with or without considering minimum follow-up time and/or minimum post-exposure follow-up time.
</p>
</td></tr>
<tr><td><code>N_effexp_p</code></td>
<td>

<p>Simulated proportion of exposed subjects with or without considering minimum follow-up time and/or minimum post-exposure follow-up time.
</p>
</td></tr>
<tr><td><code>bhat</code></td>
<td>

<p>Simulated value of regression coefficient (log hazard ratio).
</p>
</td></tr>
<tr><td><code>HR</code></td>
<td>

<p>Simulated value of hazard ratio.
</p>
</td></tr>
<tr><td><code>d</code></td>
<td>

<p>Simulated number of events in total.
</p>
</td></tr>
<tr><td><code>d_c</code></td>
<td>

<p>Simulated number of events in control group.
</p>
</td></tr>
<tr><td><code>d_exp</code></td>
<td>

<p>Simulated number of events in exposed group.
</p>
</td></tr>
<tr><td><code>mst_c</code></td>
<td>

<p>Simulated median survival time in control group.
</p>
</td></tr>
<tr><td><code>mst_exp</code></td>
<td>

<p>Simulated median survival time in exposed group.
</p>
</td></tr>
<tr><td><code>pow</code></td>
<td>
<p>Simulated statistical power from the Cox regression model on data with time-dependent exposure.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyi Xiong, Teeranan Pokaprakarn, Hiroto Udagawa, Nusrat Rabbee <br />
Maintainer: Nusrat Rabbee &lt;rabbee@berkeley.edu&gt;
</p>


<h3>References</h3>

<p>Savignoni et al.: Matching methods to create paired survival data based on an exposure occurring over time: a simulation study with application to breast cancer. 
</p>
<p>BMC Medical Research Methodology 2014 14:83. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Install the survival package if needed.

library(survival)

# Create a clustering data frame as input with 3 categories and a 20% weighted
# exposure proportion.
  
input_df &lt;- data.frame(cat_id = c('lo', 'med', 'hi'),
	cat_prop = c(0.65, 0.2, 0.15), cat_exp.prop = c(0.1, 0.3, 0.5))

# We recommend setting nSim to at least 500. It is set to 10 in the example to
# reduce run time for CRAN submission.

# Run 10 simulations. Each time simulate a dataset of 600 subjects with
# time-dependent exposure with both minimum follow-up time (4 months) and
# minimum post-exposure follow-up time (4 months) imposed. Also consider a
# quick exposure after entering the study for each exposed subject. Set the
# maximum relative exposure time to be 1/6. 

# Set the duration of the study to be 24 months; the median time to event for
# control group to be 24 months; exposure effect to be 0.3; median time to
# censoring to be 14 months.

ret &lt;- getpower.clst(nSim = 10, N = 600, beta = 0.3, df = input_df,
    type = "td", scenario = "clustering", maxrelexptime = 1/6, min.futime = 4,
    min.postexp.futime = 4, output.fn = "output_clst.csv",) 
</code></pre>

<hr>
<h2 id='getpower.method1'>
Calculate power for the Cox proportional hazard model with
time-dependent exposure using method 1
</h2><span id='topic+getpower.method1'></span>

<h3>Description</h3>

<p>This functions runs nSim (Number of simulations, specified by the user) Monte Carlo simulations, each time it calling tdSim.method1 internally. The function returns a data frame of scenario-specific parameters (including statistical power) and appends the output to a file with file name specified in the input parameters list. The user also have an option whether to plot an incidence plot or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getpower.method1(nSim, N, duration = 24, med.TTE.Control = 24, rho = 1,
    med.TimeToCensor = 14, beta, exp.prop, type, scenario, prop.fullexp = 0,
    maxrelexptime = 1, min.futime = 0, min.postexp.futime = 0, output.fn, 
    simu.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getpower.method1_+3A_nsim">nSim</code></td>
<td>

<p>Number of simulations.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_n">N</code></td>
<td>

<p>Number of subjects to be screened.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_duration">duration</code></td>
<td>

<p>Length of the study in months; the default value is 24 (months).
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_med.tte.control">med.TTE.Control</code></td>
<td>

<p>Median time to event for control group; the default value is 24 (months).
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_rho">rho</code></td>
<td>

<p>Shape parameter of the Weibull distribution. Default is 1, which will generate survival times by using the exponential distribution.
</p>
</td></tr> 
<tr><td><code id="getpower.method1_+3A_med.timetocensor">med.TimeToCensor</code></td>
<td>

<p>Median time to censoring for all subjects. The default value is 14 (months).
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_beta">beta</code></td>
<td>

<p>A numeric value that represents the exposure effect, which is the regression coefficient (log hazard ratio) that represent the magnitude of the relationship between the exposure covariate and the risk of an event.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_exp.prop">exp.prop</code></td>
<td>

<p>A numeric value between 0 and 1 (not include 0 and 1) that represents the proportion of subjects that are assigned with an exposure.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_type">type</code></td>
<td>

<p>A text string indicating the what type of dataset is of interest. Either one of &quot;fixed&quot; or &quot;td&quot; should be inputted.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_scenario">scenario</code></td>
<td>

<p>Any text string inputted by the user as an option to name a scenario that is being simulated. The use can simply put &quot; &quot;  if he/she decide to not name the scenario.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_prop.fullexp">prop.fullexp</code></td>
<td>

<p>A numeric value in interval [0, 1) that represents the proportion of exposed subjects that are fully exposed from the beginning to the end of the study. The default value is 0, which means all exposed subjects have an exposure status transition at some point during the study.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_maxrelexptime">maxrelexptime</code></td>
<td>

<p>A numeric value in interval (0, 1] that represents the maximum relative exposure time. Suppose this value is p, the exposure time for each subject is then uniformly distributed from 0 to p*subject's time in the study. The default value is 1, which means all exposed subjects have an exposure status transition at any point during the time in study.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_min.futime">min.futime</code></td>
<td>

<p>A numeric value that represents minimum follow-up time (in months). The default value is 0, which means no minimum follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_min.postexp.futime">min.postexp.futime</code></td>
<td>

<p>A numeric value that represents minimum post-exposure follow-up time (in months). The default value is 0, which means no minimum post-exposure follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study after their exposure.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_output.fn">output.fn</code></td>
<td>

<p>A .csv filename to write in the output. If the filename does not exist, the function will create a new .csv file for the output.
</p>
</td></tr>
<tr><td><code id="getpower.method1_+3A_simu.plot">simu.plot</code></td>
<td>

<p>A logical value indicating whether or not to output an incidence plot. The default value is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates power based on the Cox regression model, which calls the coxph function from the survival library using the the simulated data from tdSim.method1.
</p>


<h3>Value</h3>

<p>A data.frame object with columns corresponding to
</p>
<table role = "presentation">
<tr><td><code>i_scenario</code></td>
<td>

<p>Scenario name specified by the user
</p>
</td></tr>
<tr><td><code>i_type</code></td>
<td>

<p>Dataset type specified by the user
</p>
</td></tr>
<tr><td><code>i_N</code></td>
<td>

<p>Number of subjects to be screened, specified by the user
</p>
</td></tr>
<tr><td><code>i_min.futime</code></td>
<td>

<p>Minimum follow-up time to be considered, specified by the user
</p>
</td></tr>
<tr><td><code>i_min.postexp.futime</code></td>
<td>

<p>Minimum post-exposure follow-up time to be considered, specified by the user
</p>
</td></tr>
<tr><td><code>i_exp.prop</code></td>
<td>

<p>Exposure rate specified by the user
</p>
</td></tr>
<tr><td><code>i_lambda</code></td>
<td>

<p>Value of the scale parameter of the Weibull distribution to generate survival times. Calculated from median time to event for control group, which is specified by the user.
</p>
</td></tr>
<tr><td><code>i_rho</code></td>
<td>

<p>User-specified value of the shape parameter of the Weibull distribution to generate survival times
</p>
</td></tr>
<tr><td><code>i_rateC</code></td>
<td>

<p>Rate of the exponential distribution to generate censoring times. Calculated from median time to censoring, which is specified by the user. i_beta  Input value of regression coefficient (log hazard ratio).
</p>
</td></tr>
<tr><td><code>N_eff</code></td>
<td>

<p>Simulated number of evaluable subjects, which is the resulting number of subjects with or without considering minimum follow-up time and/or minimum post-exposure follow-up time.
</p>
</td></tr>
<tr><td><code>N_effexp_p</code></td>
<td>

<p>Simulated proportion of exposed subjects with or without considering minimum follow-up time and/or minimum post-exposure follow-up time.
</p>
</td></tr>
<tr><td><code>bhat</code></td>
<td>

<p>Simulated value of regression coefficient (log hazard ratio)
</p>
</td></tr>
<tr><td><code>HR</code></td>
<td>

<p>Simulated value of hazard ratio
</p>
</td></tr>
<tr><td><code>d</code></td>
<td>

<p>Simulated number of events in total
</p>
</td></tr>
<tr><td><code>d_c</code></td>
<td>

<p>Simulated number of events in control group
</p>
</td></tr>
<tr><td><code>d_exp</code></td>
<td>

<p>Simulated number of events in exposed group
</p>
</td></tr>
<tr><td><code>mst_c</code></td>
<td>

<p>Simulated median survival time in control group
</p>
</td></tr>
<tr><td><code>mst_exp</code></td>
<td>

<p>Simulated median survival time in exposed group
</p>
</td></tr>
<tr><td><code>pow</code></td>
<td>

<p>Simulated statistical power from the Cox regression model on data with
time-dependent exposure
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyi Xiong, Teeranan Pokaprakarn, Hiroto Udagawa, Nusrat Rabbee <br />
Maintainer: Nusrat Rabbee &lt;rabbee@berkeley.edu&gt;
</p>


<h3>References</h3>

<p>Therneau T (2015). A Package for Survival Analysis in S. version 2.38,
</p>
<p>http://CRAN.R-project.org/package=survival
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Install the survival package if needed.

library(survival)

# We recommend setting nSim to at least 500. It is set to 10 in the example to
# reduce run time for CRAN submission.

# Run 10 simulations. Each time simulate a dataset of 600 subjects with
# time-dependent exposure with both minimum follow-up time (4 months) and
# minimum post-exposure follow-up time (4 months) imposed. Also consider a
# quick exposure after entering the study for each exposed subject. Set the
# maximum relative exposure time to be 1/6. 

# Set the duration of the study to be 24 months; the median time to event for
# control group to be 24 months; exposure effect to be 0.3; median time to
# censoring to be 14 months; and exposure proportion to be 20%.


ret &lt;- getpower.method1(nSim = 10, N = 600, b = 0.3, exp.prop = 0.2,
    type = "td", scenario = " ", maxrelexptime = 1/6, min.futime = 4,
    min.postexp.futime = 4, output.fn = "output.csv")

</code></pre>

<hr>
<h2 id='getpower.method2'>
Calculate power for the Cox proportional hazard model with
time-dependent exposure using method 2
</h2><span id='topic+getpower.method2'></span>

<h3>Description</h3>

<p>This functions runs nSim (Number of simulations, specified by the user) Monte Carlo simulations, each time calling tdSim.method2 internally. The function returns a data frame of scenario-specific input parameters- and also output statistical power. The user has the option to append the output to a file with file name specified in the input parameters list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getpower.method2(nSim = 500, N, duration = 24, scenario, lambda12,
  lambda23 = NULL, lambda13, HR = NULL, exp.prop, rateC, min.futime, 
  min.postexp.futime, output.fn, simu.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getpower.method2_+3A_nsim">nSim</code></td>
<td>

<p>Number of simulations.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_n">N</code></td>
<td>

<p>Number of subjects to be screened.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_duration">duration</code></td>
<td>

<p>Length of the study in months; the default value is 24 (months).
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_scenario">scenario</code></td>
<td>

<p>Any text string inputted by the user as an option to name a scenario that is being simulated. The use can simply put &quot; &quot; if he/she decides to not name the scenario.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_lambda12">lambda12</code></td>
<td>

<p>Lambda12 parameter to control time to exposure.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_lambda23">lambda23</code></td>
<td>

<p>Lambda23 parameter to control time to event after exposure.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_lambda13">lambda13</code></td>
<td>

<p>Lambda13 parameter to control time to event in the control group.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_hr">HR</code></td>
<td>

<p>Hazard Ratio. This input is optional. If HR is set and lambda23 is not set, lambda23 = lambda13*HR.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_exp.prop">exp.prop</code></td>
<td>

<p>A numeric value between 0 and 1 (not include 0 and 1) that represents the proportion of subjects that are assigned with an exposure.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_ratec">rateC</code></td>
<td>

<p>Rate of the exponential distribution to generate censoring times.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_min.futime">min.futime</code></td>
<td>

<p>A numeric value that represents minimum follow-up time (in months). The default value is 0, which means no minimum follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_min.postexp.futime">min.postexp.futime</code></td>
<td>

<p>A numeric value that represents minimum post-exposure follow-up time (in months). The default value is 0, which means no minimum post-exposure follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study after their exposure.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_output.fn">output.fn</code></td>
<td>

<p>A .csv filename to write in the output. If the filename does not exist, the function will create a new .csv file for the output.
</p>
</td></tr>
<tr><td><code id="getpower.method2_+3A_simu.plot">simu.plot</code></td>
<td>

<p>A logical value indicating whether or not to output an incidence plot.The default value is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates power based on the Cox regression model, which calls the coxph function from the survival library using the the simulated data from tdSim.method2.
</p>


<h3>Value</h3>

<p>A data.frame object with columns corresponding to
</p>
<table role = "presentation">
<tr><td><code>i_scenario</code></td>
<td>
<p>Scenario name specified by the user</p>
</td></tr>
<tr><td><code>i_N</code></td>
<td>
<p>Number of subjects needs to be screened, specified by the user</p>
</td></tr>
<tr><td><code>i_min.futime</code></td>
<td>
<p>Minimum follow-up time to be considered, specified by the user</p>
</td></tr>
<tr><td><code>i_min.postexp.futime</code></td>
<td>
<p>Minimum post-exposure follow-up time to be
considered, specified by the user</p>
</td></tr>
<tr><td><code>i_exp.prop</code></td>
<td>
<p>Exposure rate specified by the user</p>
</td></tr>
<tr><td><code>i_lambda12</code></td>
<td>
<p>Lambda12 parameter to control time to exposure</p>
</td></tr>
<tr><td><code>i_lambda23</code></td>
<td>
<p>Lambda23 parameter to control time to event after exposure</p>
</td></tr>
<tr><td><code>i_lambda13</code></td>
<td>
<p>Lambda13 parameter to control time to event in the control group</p>
</td></tr>
<tr><td><code>i_rateC</code></td>
<td>
<p>Rate of the exponential distribution to generate censoring times.
Calculated from median time to censoring, which is specified by the user.
i_beta  Input value of regression coefficient (log hazard ratio)</p>
</td></tr>
<tr><td><code>N_eff</code></td>
<td>
<p>Simulated number of evaluable subjects, which is the resulting number of
subjects with or without considering minimum follow-up time and/or minimum post-exposure follow-up time</p>
</td></tr>
<tr><td><code>N_effexp_p</code></td>
<td>
<p>Simulated proportion of exposed subjects with or without
considering minimum follow-up time and/or minimum
post-exposure follow-up time</p>
</td></tr>
<tr><td><code>bhat</code></td>
<td>
<p>Simulated value of regression coefficient (log hazard ratio)</p>
</td></tr>
<tr><td><code>HR</code></td>
<td>
<p>Simulated value of hazard ratio</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Simulated number of events in total</p>
</td></tr>
<tr><td><code>d_c</code></td>
<td>
<p>Simulated number of events in control group</p>
</td></tr>
<tr><td><code>d_exp</code></td>
<td>
<p>Simulated number of events in exposed group</p>
</td></tr>
<tr><td><code>mst_c</code></td>
<td>
<p>Simulated median survival time in control group</p>
</td></tr>
<tr><td><code>mst_exp</code></td>
<td>
<p>Simulated median survival time in exposed group</p>
</td></tr>
<tr><td><code>pow</code></td>
<td>
<p>Simulated statistical power from the Cox regression model on data with
time-dependent exposure</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyi Xiong, Teeranan Pokaprakarn, Hiroto Udagawa, Nusrat Rabbee <br />
Maintainer: Nusrat Rabbee &lt;rabbee@berkeley.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We recommend setting nSim to at least 500. It is set to 10 in the example to
# reduce run time for CRAN submission.

# Run 10 simulations. Each time simulate a dataset of 600 subjects

ret &lt;- getpower.method2(nSim=10, N=600, duration=24, scenario="test",
  lambda12=1.3, lambda23=0.04, lambda13=0.03, HR=NULL,exp.prop=0.2, rateC=0.05,
  min.futime=4, min.postexp.futime=4,output.fn="database.csv", simu.plot=FALSE) 
</code></pre>

<hr>
<h2 id='plot_power'>
Plot power curves for survival analysis with time-dependent exposure
</h2><span id='topic+plot_power'></span>

<h3>Description</h3>

<p>This function plots a power curve at each time and returns a subsetted data
frame that match the list of input parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_power(table_df, N, type, exp.prop, min.futime, min.postexp.futime,
    show.plot = FALSE, newplot = FALSE, col = NULL, lty, lwd, pch)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_power_+3A_table_df">table_df</code></td>
<td>

<p>A data frame read from a .csv file of a format output from the getpower.method1 function.
</p>
</td></tr>
<tr><td><code id="plot_power_+3A_n">N</code></td>
<td>

<p>Number of subjects needs to be screened
</p>
</td></tr>
<tr><td><code id="plot_power_+3A_type">type</code></td>
<td>

<p>A text string indicating the what type of dataset is of interest.   Either one of
&quot;fixed&quot; or &quot;td&quot; should be inputted
</p>
</td></tr>
<tr><td><code id="plot_power_+3A_exp.prop">exp.prop</code></td>
<td>

<p>A numeric value between 0 and 1 (not include 0 and 1) that represents the proportion of subjects that are assigned with an exposure
</p>
</td></tr>
<tr><td><code id="plot_power_+3A_min.futime">min.futime</code></td>
<td>

<p>A numeric value that represents minimum follow-up time (in months). The default value is 0, which means no minimum follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study
</p>
</td></tr>
<tr><td><code id="plot_power_+3A_min.postexp.futime">min.postexp.futime</code></td>
<td>

<p>A numeric value that represents minimum post-exposure follow-up time (in months). The default value is 0, which means no minimum post-exposure follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study after their exposure
</p>
</td></tr>
<tr><td><code id="plot_power_+3A_show.plot">show.plot</code></td>
<td>

<p>A logical value indicating whether to output a power curve or not. The default value is TRUE
</p>
</td></tr>
<tr><td><code id="plot_power_+3A_newplot">newplot</code></td>
<td>

<p>A logical value indicating whether to create a new plot or add to an existing plot
</p>
</td></tr>
<tr><td><code id="plot_power_+3A_col">col</code>, <code id="plot_power_+3A_lty">lty</code>, <code id="plot_power_+3A_lwd">lwd</code>, <code id="plot_power_+3A_pch">pch</code></td>
<td>

<p>Graphical parameters as in the regular plot function in R
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The gist of this function is that the user can check the plot with the values in the output data frame. Moreover, it is flexible that the user can choose to only output the data frame in order to plot their own graph (such as add titles or legends) based on the data. The user can also add as many lines as possible to an existing power curve plot so that he/she is allowed to compare different scenarios.
</p>


<h3>Value</h3>

<p>A data.frame object with columns corresponding to
</p>
<table role = "presentation">
<tr><td><code>i_N</code></td>
<td>

<p>Number of subjects needs to be screened, specified by the user
</p>
</td></tr>
<tr><td><code>N_eff</code></td>
<td>

<p>Simulated number of evaluable subjects, which is the resulting number of subjects with or without considering minimum follow-up time and/or minimum post-exposure follow-up time
</p>
</td></tr>
<tr><td><code>i_beta</code></td>
<td>

<p>Input value of regression coefficient (log hazard ratio)
</p>
</td></tr>
<tr><td><code>pow</code></td>
<td>

<p>Simulated statistical power from the Cox regression model on data with time-dependent exposure
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyi Xiong, Teeranan Pokaprakarn, Hiroto Udagawa, Nusrat Rabbee <br />
Maintainer: Nusrat Rabbee &lt;rabbee@berkeley.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We recommend setting nSim to at least 500. It is set to 10 in the example to
# reduce run time for CRAN submission.

ret &lt;- getpower.method1(nSim = 10, N = 600, b = 0.3, exp.prop = 0.2, 
    type = "td", scenario =  " ", maxrelexptime = 1/6, min.futime = 4, 
    min.postexp.futime = 4, output.fn = "output.csv")
	
ret2 &lt;- getpower.method1(nSim = 10, N = 600, b = 0.3, exp.prop = 0.2, 
    type = "td", scenario = " ", maxrelexptime = 1/6, min.futime = 4, 
    min.postexp.futime = 0, output.fn ="output.csv")
	
# Read in .csv file as a data frame

tb &lt;-  read.csv("output.csv", header = TRUE, sep = ",")

	# Visualize the subsetted data frame of interest and create a new plot

visualize1 &lt;- plot_power(table_df = tb, N = 600, type = "td", exp.prop = 0.2,
    min.futime = 4, min.postexp.futime = 4, show.plot = TRUE, newplot = TRUE,
    col = "red", lty = 1, lwd = 2, pch = 16)

# Add a different power curve to the previously created plot

visualize2 &lt;- plot_power(table_df = tb, N = 600, type = "td", exp.prop=0.2, 
    min.futime = 4, min.postexp.futime = 0, show.plot = TRUE, newplot = FALSE,
    col = "blue", lty = 1, lwd = 2, pch = 16)
</code></pre>

<hr>
<h2 id='plot_simuData'>
Make an incidence plot from simulated data.
</h2><span id='topic+plot_simuData'></span>

<h3>Description</h3>

<p>Create an incidence plot ordered by follow-up time from a survival data simulated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_simuData(data, title="Sample Survival Data")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_simuData_+3A_data">data</code></td>
<td>

<p>A dataframe of survival data containing the following columns: id, start, stop, status, x
</p>
</td></tr>
<tr><td><code id="plot_simuData_+3A_title">title</code></td>
<td>

<p>Title of the graph
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This makes the incidence plot of the survival data based on the input dataframe from the tdSim.method1 or tdSim.method2 function. More generally, this function would also works with a dataframe containing survival data with the same columns name as indicated above.
</p>


<h3>Author(s)</h3>

<p>Danyi Xiong, Teeranan Pokaprakarn, Hiroto Udagawa, Nusrat Rabbee <br />
Maintainer: Nusrat Rabbee &lt;rabbee@berkeley.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- tdSim.method2(500, duration=24,lambda12=1.3,lambda23=0.04, 
    lambda13=0.03, exp.prop=0.2,rateC=0.05, min.futime=4, min.postexp.futime=4)
	
plot_simuData(dat, title='method2_filter')
</code></pre>

<hr>
<h2 id='tdSim.clst'>
Simulate 1 dataframe (1 simulation) of time-dependent exposure
under method 1 with a clustering data frame
</h2><span id='topic+tdSim.clst'></span>

<h3>Description</h3>

<p>This function allows the user to input a data frame with clustering
parameters and generates a simulated dataset with time-dependent exposure.
In particular, the output dataset has a column corresponding to the physician site id, which will be used as a clustering variable in the Cox regression model in power calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdSim.clst(N, duration = 24, lambda, rho = 1, beta, rateC, df,
    prop.fullexp = 0, maxrelexptime = 1, min.futime = 0, min.postexp.futime = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tdSim.clst_+3A_n">N</code></td>
<td>

<p>Number of subjects needs to be screened
</p>
</td></tr>
<tr><td><code id="tdSim.clst_+3A_duration">duration</code></td>
<td>

<p>Length of the study in Months. The default value is 24 (months)
</p>
</td></tr>
<tr><td><code id="tdSim.clst_+3A_lambda">lambda</code></td>
<td>

<p>Scale parameter of the Weibull distribution, which is calculated as log(2) / median time to event for control group
</p>
</td></tr>
<tr><td><code id="tdSim.clst_+3A_rho">rho</code></td>
<td>

<p>Shape parameter of the Weibull distribution, which is defaulted as 1, as we generate survival times by using the exponential distribution
</p>
</td></tr>
<tr><td><code id="tdSim.clst_+3A_beta">beta</code></td>
<td>

<p>A numeric value that represents the exposure effect, which is the
regression coefficient (log hazard ratio) that represent the magnitude of
the relationship between the exposure covariate and the risk of an event
</p>
</td></tr>
<tr><td><code id="tdSim.clst_+3A_ratec">rateC</code></td>
<td>

<p>Rate of the exponential distribution to generate censoring times, which is calculated as log(2) / median time to censoring
</p>
</td></tr>
<tr><td><code id="tdSim.clst_+3A_df">df</code></td>
<td>

<p>A user-specified n (n 3) by 3 clustering data frame with columns corresponding to cat_id (category id, which is the physician site id. It can be either text strings or integers), cat_prop (category proportion, which is the proportion of subjects in corresponding a category id), and cat_exprate (category exposure rate, which is the exposure proportion corresponding to a category id). n rows corresponds to n different physician sites
</p>
</td></tr>
<tr><td><code id="tdSim.clst_+3A_prop.fullexp">prop.fullexp</code></td>
<td>

<p>A numeric value in interval [0, 1) that represents the proportion of exposed subjects that are fully exposed from the beginning to the end of the study. The default value is 0, which means all exposed subjects have an exposure status transition at some point during the study
</p>
</td></tr>
<tr><td><code id="tdSim.clst_+3A_maxrelexptime">maxrelexptime</code></td>
<td>

<p>A numeric value in interval (0, 1] that represents the maximum relative exposure time. Suppose this value is p, the exposure time for each subject is then uniformly distributed from 0 to p*subject's time in the study. The default value is 1, which means all exposed subjects have an exposure status transition at any point during the time in study.  </p>
</td></tr>
<tr><td><code id="tdSim.clst_+3A_min.futime">min.futime</code></td>
<td>

<p>A numeric value that represents minimum follow-up time (in months). The default value is 0, which means no minimum follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study
</p>
</td></tr>
<tr><td><code id="tdSim.clst_+3A_min.postexp.futime">min.postexp.futime</code></td>
<td>
<p>A numeric value that represents minimum post-exposure follow-up time (in months). The default value is 0, which means no minimum post-exposure follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study after their exposure
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The current version of this function allows the user to input a data frame with at
least 3 categories of physician sites, because the function uses a multinomial
distribution to assign subjects into each category according to the corresponding category proportion
</p>


<h3>Value</h3>

<p>A data.frame object with columns corresponding to
</p>
<table role = "presentation">
<tr><td><code>id</code></td>
<td>

<p>Integer that represents a subject's identification number
</p>
</td></tr>
<tr><td><code>start</code></td>
<td>

<p>For counting process formulation. Represents the start of each time interval
</p>
</td></tr>
<tr><td><code>stop</code></td>
<td>

<p>For counting process formulation. Represents the end of each time interval
</p>
</td></tr>
<tr><td><code>status</code></td>
<td>

<p>Indicator of event. status = 1 when event occurs and 0 otherwise
</p>
</td></tr>
<tr><td><code>x</code></td>
<td>

<p>Indicator of exposure. x = 1 when exposed and 0 otherwise
</p>
</td></tr>
<tr><td><code>clst_id</code></td>
<td>

<p>For clustering in the Cox proportional hazard model. Represents label of each subject's corresponding physician site
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyi Xiong, Teeranan Pokaprakarn, Hiroto Udagawa, Nusrat Rabbee <br />
Maintainer: Nusrat Rabbee &lt;rabbee@berkeley.edu&gt;
</p>


<h3>References</h3>

<p>T. Therneau and C. Crowson (2015). Using Time Dependent Covariates and Time Dependent Coefficients in the Cox Model.
</p>
<p>https://cran.r-project.org/web/packages/survival/vignettes/timedep.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a clustering data frame as input with 3 categories and a 20% weighted
# exposure proportion.
  
input_df &lt;- data.frame(cat_id = c('lo', 'med', 'hi'), 
	cat_prop = c(0.65, 0.2, 0.15), cat_exp.prop = c(0.1, 0.3, 0.5))

# Simulate a dataset of 600 subjects with time-dependent exposure. Consider
# both minimum follow-up time (4 months) and minimum post-exposure follow-up
# time (4 months). Also consider a quick exposure after entering the study for
# each exposed subject. Set the maximum relative exposure time to be 1/6. 

# Set the duration of the study to be 24 months; the median time to event for
# control group to be 24 months; exposure effect to be 0.3; median time to
# censoring to be 14 months.

df_tdclst &lt;- tdSim.clst(N = 600, duration = 24, lambda = log(2)/24, rho = 1,
    beta = 0.3, rateC = log(2)/14, df = input_df, prop.fullexp = 0,
    maxrelexptime = 1/6, min.futime = 4, min.postexp.futime = 4)
</code></pre>

<hr>
<h2 id='tdSim.method1'>
Simulate 1 dataframe (1 simulation) of time-dep exposure under method 1
</h2><span id='topic+tdSim.method1'></span>

<h3>Description</h3>

<p>This function generates a simulated dataset with time-dependent exposure under  
method 1 with a user-specified list of parameters as input. Survival times and censoring times are generated from the exponential distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdSim.method1(N, duration = 24, lambda, rho = 1, beta, rateC, exp.prop, 
    prop.fullexp  = 0, maxrelexptime = 1, min.futime = 0, min.postexp.futime = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tdSim.method1_+3A_n">N</code></td>
<td>

<p>Number of subjects needs to be screened
</p>
</td></tr>
<tr><td><code id="tdSim.method1_+3A_duration">duration</code></td>
<td>

<p>Length of the study in Months. The default value is 24 (months)
</p>
</td></tr>
<tr><td><code id="tdSim.method1_+3A_lambda">lambda</code></td>
<td>

<p>Scale parameter of the Weibull distribution, which is calculated as log(2) / median time to event for control group
</p>
</td></tr>
<tr><td><code id="tdSim.method1_+3A_rho">rho</code></td>
<td>

<p>Shape parameter of the Weibull distribution, which is defaulted as 1, as we generate survival times by using the exponential distribution
</p>
</td></tr>
<tr><td><code id="tdSim.method1_+3A_beta">beta</code></td>
<td>

<p>A numeric value that represents the exposure effect, which is the regression coefficient (log hazard ratio) that represent the magnitude of the relationship between the exposure covariate and the risk of an event
</p>
</td></tr>
<tr><td><code id="tdSim.method1_+3A_ratec">rateC</code></td>
<td>

<p>Rate of the exponential distribution to generate censoring times, which is calculated as log(2) / median time to censoring
</p>
</td></tr>
<tr><td><code id="tdSim.method1_+3A_exp.prop">exp.prop</code></td>
<td>

<p>A numeric value between 0 and 1 (not include 0 and 1) that represents the proportion of subjects that are assigned with an exposure
</p>
</td></tr>
<tr><td><code id="tdSim.method1_+3A_prop.fullexp">prop.fullexp</code></td>
<td>

<p>A numeric value in interval [0, 1) that represents the proportion of exposed subjects that are fully exposed from the beginning to the end of the study. The default value is 0, which means all exposed subjects have an exposure status transition at some point during the study
</p>
</td></tr>
<tr><td><code id="tdSim.method1_+3A_maxrelexptime">maxrelexptime</code></td>
<td>

<p>A numeric value in interval (0, 1] that represents the maximum relative exposure time. Suppose this value is p, the exposure time for each subject is then uniformly distributed from 0 to p*subject's time in the study. The default value is 1, which means all exposed subjects have an exposure status transition at any point during the time in study.
</p>
</td></tr>
<tr><td><code id="tdSim.method1_+3A_min.futime">min.futime</code></td>
<td>

<p>A numeric value that represents minimum follow-up time (in months). The default value is 0, which means no minimum follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study
</p>
</td></tr>
<tr><td><code id="tdSim.method1_+3A_min.postexp.futime">min.postexp.futime</code></td>
<td>

<p>A numeric value that represents minimum post-exposure follow-up time (in months). The default value is 0, which means no minimum post-exposure follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study after their exposure
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no minimum follow-up time or minimum post-exposure follow-up time is considered (min.fut = 0 and min.postexp.fut = 0), then the output data frame
will have N subjects. If we consider minimum follow-up time or both, then the
output data frame will have at most N subjects. 
</p>


<h3>Value</h3>

<p>A data.frame object with columns corresponding to
</p>
<table role = "presentation">
<tr><td><code>id</code></td>
<td>

<p>Integer that represents a subject's identification number
</p>
</td></tr>
<tr><td><code>start</code></td>
<td>

<p>For counting process formulation. Represents the start of each time interval
</p>
</td></tr>
<tr><td><code>stop</code></td>
<td>

<p>For counting process formulation. Represents the end of each time interval
</p>
</td></tr>
<tr><td><code>status</code></td>
<td>

<p>Indicator of event. status = 1 when event occurs and 0 otherwise
</p>
</td></tr>
<tr><td><code>x</code></td>
<td>

<p>Indicator of exposure. x = 1 when exposed and 0 otherwise
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyi Xiong, Teeranan Pokaprakarn, Hiroto Udagawa, Nusrat Rabbee <br />
Maintainer: Nusrat Rabbee &lt;rabbee@berkeley.edu&gt;
</p>


<h3>References</h3>

<p>Therneau and C. Crowson (2015). Using Time Dependent Covariates and Time Dependent Coefficients in the Cox Model.
</p>
<p>https://cran.r-project.org/web/packages/survival/vignettes/timedep.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a dataset of 600 subjects with time-dependent exposure without
# considering minimum follow-up time or minimum post-exposure follow-up time.
# Specifically, set the duration of the study to be 24 months; the median time to
# event for control group to be 24 months; exposure effect to be 0.3; median time
# to censoring to be 14 months; and exposure proportion to be 20%.

df1 &lt;- tdSim.method1(N = 600, duration = 24, lambda = log(2)/24, rho = 1, 
   beta = 0.3, rateC = log(2)/14, exp.prop = 0.2, prop.fullexp  = 0, 
   maxrelexptime = 1, min.fut = 0, min.postexp.fut = 0)

# Simulate a dataset of 600 subjects with time-dependent exposure with
# both minimum follow-up time (4 months) and minimum post-exposure
# follow-up time (4 months) imposed. Other parameters remain the same as
# in the first case.

df2 &lt;- tdSim.method1(N = 600, duration = 24, lambda = log(2)/24, rho = 1, 
   beta = 0.3, rateC = log(2)/14, exp.prop = 0.2, prop.fullexp  = 0, 
   maxrelexptime = 1, min.fut = 4, min.postexp.fut = 4)

# Simulate a dataset of 600 subjects with time-dependent exposure with
# both minimum follow-up time (4 months) and minimum post-exposure
# follow-up time (4 months) imposed. Also consider a quick exposure after
# entering the study for each exposed subject. Set the maximum relative
# exposure time to be 1/6. Other parameters remain the same as in the first case.

df3 &lt;- tdSim.method1(N = 600, duration = 24, lambda = log(2)/24, rho = 1, 
   beta = 0.3, rateC = log(2)/14, exp.prop = 0.2, prop.fullexp  = 0,
   maxrelexptime = 1/6, min.fut = 4,min.postexp.fut = 4)
</code></pre>

<hr>
<h2 id='tdSim.method2'>
Simulate 1 dataframe (1 simulation) of time-dep exposure under method 2
</h2><span id='topic+tdSim.method2'></span>

<h3>Description</h3>

<p>This function simulate Survival Data. It generates a simulated dataset with time-dependent exposure under method 2 with a user-specified list of parameters as input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
tdSim.method2(N,duration, lambda12, lambda23=NULL, lambda13, 
    HR=NULL, exp.prop,rateC, min.futime = 0, min.postexp.futime = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tdSim.method2_+3A_n">N</code></td>
<td>

<p>Number of subjects
</p>
</td></tr>
<tr><td><code id="tdSim.method2_+3A_duration">duration</code></td>
<td>

<p>Duration of the study. This is used in censoring
</p>
</td></tr>
<tr><td><code id="tdSim.method2_+3A_lambda12">lambda12</code></td>
<td>

<p>Lambda12 parameter to control time to exposure
</p>
</td></tr>
<tr><td><code id="tdSim.method2_+3A_lambda23">lambda23</code></td>
<td>

<p>Lambda23 parameter to control time to event after exposure
</p>
</td></tr>
<tr><td><code id="tdSim.method2_+3A_lambda13">lambda13</code></td>
<td>

<p>Lambda13 parameter to control time to event in the control group
</p>
</td></tr>
<tr><td><code id="tdSim.method2_+3A_hr">HR</code></td>
<td>

<p>Hazard Ratio. This input is optional. If HR is set and lambda23 is not set, lambda23 = lambda13*HR
</p>
</td></tr>
<tr><td><code id="tdSim.method2_+3A_exp.prop">exp.prop</code></td>
<td>

<p>A numeric value between 0 and 1 (not include 0 and 1) that represents the proportion of subjects that are assigned with an exposure
</p>
</td></tr>
<tr><td><code id="tdSim.method2_+3A_ratec">rateC</code></td>
<td>

<p>Rate of the exponential distribution to generate censoring times
</p>
</td></tr>
<tr><td><code id="tdSim.method2_+3A_min.futime">min.futime</code></td>
<td>

<p>A numeric value that represents minimum follow-up time (in months). The default value is 0, which means no minimum follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study
</p>
</td></tr>
<tr><td><code id="tdSim.method2_+3A_min.postexp.futime">min.postexp.futime</code></td>
<td>

<p>A numeric value that represents minimum post-exposure follow-up time (in months). The default value is 0, which means no minimum post-exposure follow-up time is considered. If it has a positive value, this argument will help exclude subjects that only spend a short amount of time in the study after their exposure
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulata a Survival dataset using a modified version of illness-death model controlled by lambda12, lambda23, lambda13
</p>


<h3>Value</h3>

<p>A data.frame object with columns corresponding to
</p>
<table role = "presentation">
<tr><td><code>id</code></td>
<td>

<p>Integer that represents a subject's identification number
</p>
</td></tr>
<tr><td><code>start</code></td>
<td>

<p>For counting process formulation. Represents the start of each time interval
</p>
</td></tr>
<tr><td><code>stop</code></td>
<td>

<p>For counting process formulation. Represents the end of each time interval
</p>
</td></tr>
<tr><td><code>status</code></td>
<td>

<p>Indicator of event. status = 1 when event occurs and 0 otherwise
</p>
</td></tr>
<tr><td><code>x</code></td>
<td>

<p>Indicator of exposure. x = 1 when exposed and 0 otherwise
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyi Xiong, Teeranan Pokaprakarn, Hiroto Udagawa, Nusrat Rabbee <br />
Maintainer: Nusrat Rabbee &lt;rabbee@berkeley.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_data &lt;- tdSim.method2(500, duration=24,lambda12=1.3,lambda23=0.04, 
    lambda13=0.03, exp.prop=0.2,rateC=0.05, min.futime=4, min.postexp.futime=4)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
