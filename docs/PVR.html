<!DOCTYPE html><html><head><title>Help for package PVR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PVR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PSR'>
<p>Creates a phylogenetic signal-representation (PSR) curve for a given phylogeny and trait set and computes its area.</p></a></li>
<li><a href='#PSR-class'><p>Class <code>"PSR"</code></p></a></li>
<li><a href='#PSRplot'>
<p>Plot function for objects of class PSR</p></a></li>
<li><a href='#PVR'>
<p>Phylogenetic eigenvectors regression.</p></a></li>
<li><a href='#PVR-class'><p>Class <code>"PVR"</code></p></a></li>
<li><a href='#PVR-package'>
<p>Computes <b>P</b>hylogenetic eigen<b>V</b>ectors <b>R</b>egression and <b>P</b>hylogentic <b>S</b>ignal-<b>R</b>epresentation curve (with null and neutral expectations).</p></a></li>
<li><a href='#PVRdecomp'>
<p>Phylogenetic distances matrix (eigen)decomposition.</p></a></li>
<li><a href='#VarPartplot'>
<p>Plot function for objects of class PVR to show variation partition components.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Phylogenetic Eigenvectors Regression and Phylogentic
Signal-Representation Curve</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-05-29</td>
</tr>
<tr>
<td>Author:</td>
<td>Thiago Santos</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thiago Santos &lt;thiago.santos@ufvjm.edu.br&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates (and controls for) phylogenetic signal through phylogenetic eigenvectors regression (PVR) and phylogenetic signal-representation (PSR) curve, along with some plot utilities.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>splancs, ape, methods, graphics, stats, utils, MASS</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-30 20:02:35 UTC; Thiago</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-30 22:29:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='PSR'>
Creates a phylogenetic signal-representation (PSR) curve for a given phylogeny and trait set and computes its area.
</h2><span id='topic+PSR'></span>

<h3>Description</h3>

<p>Phylogenetic signal-representation (PSR) curve, built upon phylogenetic eigenvector regression (PVR). Sequential PVR models are fitted after successively increasing the number of eigenvectors and plotting their R2 against the accumulated eigenvalues. The PSR area, expressing deviations from Brownian motion, is strongly correlated with Blomberg's K-statistics, so nonlinear PSR curves reveal if traits are evolving at a slower or higher rate than expected. The PSR area is also correlated with phylogenetic half-life under an OU process, so both methods describe the relationship between interspecific variation and time since divergence among species shape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PSR(x, trait = NULL, null.model = FALSE, Brownian.model = FALSE, times = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PSR_+3A_x">x</code></td>
<td>

<p>A object of class PVR (created using PVRdecomp function).
</p>
</td></tr>
<tr><td><code id="PSR_+3A_trait">trait</code></td>
<td>

<p>A vector, data frame or matrix that contains contiuous or binary traits sets (for data frames and matrices, each column must represent a trait set). For now, only the first colunm will be used.
</p>
</td></tr>
<tr><td><code id="PSR_+3A_null.model">null.model</code></td>
<td>

<p>Logical. Should the function estimates the null expectation for the PSR area. Default is FALSE.
</p>
</td></tr>
<tr><td><code id="PSR_+3A_brownian.model">Brownian.model</code></td>
<td>

<p>Logical. Should the function estimates the Brownian (neutral) expectation for the PSR area. Default is FALSE.
</p>
</td></tr>
<tr><td><code id="PSR_+3A_times">times</code></td>
<td>

<p>Number of iterations used in null.model and Brownian.model.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>PSR function returns a object of (S4) class PSR that extends the (S4) class PVR, by adding: a PSR slot that contains the area (and p if null.model = TRUE) for each trait set, the cumulative eigenvalues and R2 that determine the curve; a slot with the null and neutral expectations (if any).
</p>


<h3>Author(s)</h3>

<p>Santos, T; Diniz-Filho, J.A.F.; Rangel, T.F.; Bini, L.M.
</p>


<h3>References</h3>

<p>Diniz-Filho, J.A.F., Sant'Ana, C.E.R. and Bini, L.M. (1998). An eigenvector method for estimating phylogenetic inertia. Evolution 52:1247-1262.
</p>
<p>Diniz-filho, J.A.F., Rangel, T.F., Santos, T. and Bini, L.M. (2012). Exploring patterns of interespecific variation in quantitative traits using sequential phylogenetic eigenvector regressions. Evolution, 66(4):1079-1090.
</p>
<p>Diniz-filho, J.A.F., Bini, L.M., Rangel, T.F., Morales-Castilla, I., Olalla-Tarraga, M.A., Rodriguez, M.A. and Hawkins, B.A. (2012). On the selection of phylogenetic eigenvectors for ecological analyses. Ecography, 35:239-249.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PVR">PVR</a></code>,  <code><a href="#topic+PVRdecomp">PVRdecomp</a></code>,  <code><a href="#topic+PSRplot">PSRplot</a></code>,  <code><a href="#topic+VarPartplot">VarPartplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(splancs)
#Creating a 10 tips ultrametric random phylogeny
library(ape)
tree &lt;- rcoal(10)
#Decomposing phylogenetic distance matrix derived from tree into a set of orthogonal vectors
x &lt;- PVRdecomp(tree)
trait &lt;- runif(10)
y &lt;- PSR(x, trait)
summary(y)
</code></pre>

<hr>
<h2 id='PSR-class'>Class <code>"PSR"</code></h2><span id='topic+PSR-class'></span><span id='topic+plot+2CPSR-method'></span><span id='topic+show+2CPSR-method'></span>

<h3>Description</h3>

<p>A S4 class that extends S4 PVR class in order to accommodate PSR analysis results.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("PSR", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>PSRarea</code>:</dt><dd><p>Object of class <code>"data.frame"</code> that contains PSR curve area.</p>
</dd>
<dt><code>PSR</code>:</dt><dd><p>Object of class <code>"data.frame"</code> that contais accumulated r squared and  eigenvalues.</p>
</dd>
<dt><code>Expect.area.values</code>:</dt><dd><p>Object of class <code>"list"</code> that contains the expected null and neutral area values.</p>
</dd>
<dt><code>nullPSR</code>:</dt><dd><p>Object of class <code>"matrix"</code> nested in the Expect.area.values slot that contains the expected null area values.</p>
</dd>
<dt><code>BrownianPSR</code>:</dt><dd><p>Object of class <code>"matrix"</code> nested in the Expect.area.values slot that contains the expected Brownian (neutral) area values.</p>
</dd>
<dt><code>Eigen</code>:</dt><dd><p>Object of class <code>"list"</code> that contains the eigenvalues and eigenvectors generated by phylogenetic distance matrix eigendecomposition. Inherited from PVR class.</p>
</dd>
<dt><code>phyDist</code>:</dt><dd><p>Object of class <code>"matrix"</code> that contains a phylogenetic distance matrix. Inherited from PVR class.</p>
</dd>
<dt><code>phylo</code>:</dt><dd><p>Object of class <code>"phylo"</code> that contains a phylogeny. Inherited from PVR class.</p>
</dd>
<dt><code>Selection</code>:</dt><dd><p>Object of class <code>"list"</code> that contains the selection method (along with its statistics) used to select the vectors, the selected vectors IDs and a matrix that contains the selected vectors. Inherited from PVR class.</p>
</dd>
<dt><code>PVR</code>:</dt><dd><p>Object of class <code>"list"</code> that contains the <b>P</b>hilogenetic  Eigen<b>V</b>ectors <b>R</b>egression r squared and residuals. Inherited from PVR class.</p>
</dd>
<dt><code>VarPart</code>:</dt><dd><p>Object of class <code>"list"</code> that contains the variation partition components. Inherited from PVR class.</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="#topic+PVR-class">PVR</a>"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>plot</dt><dd><p><code>signature(x = "PSR")</code>: ... </p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "PSR")</code>: ... </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Santos, T; Diniz-Filho, J.A.F.; Rangel, T.F.; Bini, L.M.
</p>


<h3>References</h3>

<p>Diniz-Filho, J.A.F., Sant'Ana, C.E.R. and Bini, L.M. (1998). An eigenvector method for estimating phylogenetic inertia. Evolution 52:1247-1262.
</p>
<p>Legendre, P. and Legendre, L. (1998). Numerical ecology, 2nd Englished. Elsevier.
</p>
<p>Diniz-filho, J.A.F., Rangel, T.F., Santos, T. and Bini, L.M. (2012). Exploring patterns of interespecific variation in quantitative traits using sequential phylogenetic eigenvector regressions. Evolution, 66(4):1079-1090.
</p>
<p>Diniz-filho, J.A.F., Bini, L.M., Rangel, T.F., Morales-Castilla, I., Olalla-Tarraga, M.A., Rodriguez, M.A. and Hawkins, B.A. (2012). On the selection of phylogenetic eigenvectors for ecological analyses. Ecography, 35:239-249.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PVR-class">PVR-class</a></code>, <code><a href="#topic+PVR">PVR</a></code>, <code><a href="#topic+PSR">PSR</a></code>,  <code><a href="#topic+PVRdecomp">PVRdecomp</a></code>,  <code><a href="#topic+PSRplot">PSRplot</a></code>,  <code><a href="#topic+VarPartplot">VarPartplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("PSR")
</code></pre>

<hr>
<h2 id='PSRplot'>
Plot function for objects of class PSR 
</h2><span id='topic+PSRplot'></span>

<h3>Description</h3>

<p>Plot PSR curve along with null and neutral expectations curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PSRplot(x, info = c("area", "null", "Brownian", "both"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PSRplot_+3A_x">x</code></td>
<td>

<p>An object of class PSR
</p>
</td></tr>
<tr><td><code id="PSRplot_+3A_info">info</code></td>
<td>

<p>Type of information to be ploted. It can be &quot;area&quot; (to plot only the PSR curve), &quot;null&quot; (to plot PSR curve and null PSR curve), &quot;neutral&quot; (to plot PSR curve and neutral PSR curve) and &quot;both&quot; (to plot PSR curve and both null and neutral PSR curve).
</p>
</td></tr>
<tr><td><code id="PSRplot_+3A_...">...</code></td>
<td>

<p>Parameters passed to the plot function.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Santos, T; Diniz-Filho, J.A.F.; Rangel, T.F.; Bini, L.M.
</p>


<h3>References</h3>

<p>Diniz-Filho, J.A.F., Sant'Ana, C.E.R. and Bini, L.M. (1998). An eigenvector method for estimating phylogenetic inertia. Evolution 52:1247-1262.
</p>
<p>Diniz-filho, J.A.F., Rangel, T.F., Santos, T. and Bini, L.M. (2012). Exploring patterns of interespecific variation in quantitative traits using sequential phylogenetic eigenvector regressions. Evolution, 66(4):1079-1090.
</p>
<p>Diniz-filho, J.A.F., Bini, L.M., Rangel, T.F., Morales-Castilla, I., Olalla-Tarraga, M.A., Rodriguez, M.A. and Hawkins, B.A. (2012). On the selection of phylogenetic eigenvectors for ecological analyses. Ecography, 35:239-249.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PSR">PSR</a></code>,  <code><a href="#topic+PVRdecomp">PVRdecomp</a></code>,  <code><a href="#topic+PVR">PVR</a></code>,  <code><a href="#topic+VarPartplot">VarPartplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(splancs)
#Creating a 10 tips ultrametric random phylogeny
library(ape)
tree &lt;- rcoal(10)
#Decomposing phylogenetic distance matrix derived from tree into a set of orthogonal vectors
x &lt;- PVRdecomp(tree)
trait &lt;- runif(10)
res &lt;- PSR(x, trait = trait, null.model = TRUE, Brownian.model = TRUE, times = 10)
PSRplot(res, info = "both")
</code></pre>

<hr>
<h2 id='PVR'>
Phylogenetic eigenvectors regression.
</h2><span id='topic+PVR'></span>

<h3>Description</h3>

<p>The phylogenetic eigenvector regression (PVR) starts by performing an eigendecomposition of a pairwise double-centered phylogenetic distance matrix between species. The eigenvectors (representing the traits under analysis) estimated values express phylogenetic trends in data and residuals express independent evolution of each species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PVR(x,phy,trait,envVar,method="moran",weights,
scaled=FALSE,sig=TRUE,sig.t=0.05,MI.t=0.05,psr.t=0.01,
accvalue.t=0.9,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PVR_+3A_x">x</code></td>
<td>

<p>An object of class PVR (created by the PVRdecomp function) or class PSR (requiered by the &quot;PSR&quot; method).
</p>
</td></tr>
<tr><td><code id="PVR_+3A_phy">phy</code></td>
<td>

<p>An object of class phylo that contains an ultrametric phylogeny.
</p>
</td></tr>
<tr><td><code id="PVR_+3A_trait">trait</code></td>
<td>

<p>A vector, data frame or matrix that contains traits sets (for data frames and matrices, each column must represent a trait set).
</p>
</td></tr>
<tr><td><code id="PVR_+3A_envvar">envVar</code></td>
<td>

<p>A vector, data frame or matrix that contains environmental variables. Used to estimates the variation of a trait set that is explained by phylogeny and by environment.
</p>
</td></tr>
<tr><td><code id="PVR_+3A_method">method</code></td>
<td>

<p>Character string. A name for the eigenvectors selection method. It can be &quot;moran&quot;, &quot;stepwise&quot;, &quot;psr&quot; or &quot;sequential&quot;.
</p>
</td></tr>
<tr><td><code id="PVR_+3A_weights">weights</code></td>
<td>

<p>Weighting matrix based on Phylogenetic distances used in the &quot;moran&quot; method. If no weights matrix is provided, weights will be set to max(D) - Dij, where D is the phylogenetic distance matrix. 
</p>
</td></tr>
<tr><td><code id="PVR_+3A_scaled">scaled</code></td>
<td>

<p>Logical. Should the phylogenetic distances be scaled into the range of 0 to 1. Default is FALSE.
</p>
</td></tr>
<tr><td><code id="PVR_+3A_sig">sig</code></td>
<td>

<p>Logical. Should the eigenvectors selected by the &quot;moran&quot; method be selected by the significance of residuals autocorrelation. If FALSE the eigenvectors will be selected by Moran's I values.
</p>
</td></tr>
<tr><td><code id="PVR_+3A_mi.t">MI.t</code></td>
<td>

<p>Minimum residuals Moran's I value used to select eigenvectors when significance is FALSE.
</p>
</td></tr>
<tr><td><code id="PVR_+3A_sig.t">sig.t</code></td>
<td>

<p>The significance treshold used to select eigenvectors by the &quot;moran&quot; method.
</p>
</td></tr>
<tr><td><code id="PVR_+3A_psr.t">psr.t</code></td>
<td>

<p>The minimum acumulate R2 gain treshold used to select eigenvectors by the &quot;PSR&quot; method.
</p>
</td></tr>
<tr><td><code id="PVR_+3A_accvalue.t">accvalue.t</code></td>
<td>

<p>Relative accumulated eigenvalue treshold use to select the eigenvectors by the &quot;sequential&quot; method.
</p>
</td></tr>
<tr><td><code id="PVR_+3A_...">...</code></td>
<td>

<p>Parameters passed to the stepwise regression used in the &quot;AIC&quot; method
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A PVR class object.
</p>


<h3>Author(s)</h3>

<p>Santos, T; Diniz-Filho, J.A.F.; Rangel, T.F.; Bini, L.M.
</p>


<h3>References</h3>

<p>Diniz-Filho, J.A.F., Sant'Ana, C.E.R. and Bini, L.M. (1998). An eigenvector method for estimating phylogenetic inertia. Evolution, 52:1247-1262.
</p>
<p>Legendre, P. and Legendre, L. (1998). Numerical ecology, 2nd Englished. Elsevier.
</p>
<p>Desdevises, Y., Legendre, P., Azouzi, L. and Morand, S. (2003). Quantifying phylogenetic structured environmental variation, Evolution, 57(11):2647-2652
</p>
<p>Diniz-filho, J.A.F., Rangel, T.F., Santos, T. and Bini, L.M. (2012). Exploring patterns of interespecific variation in quantitative traits using sequential phylogenetic eigenvector regressions. Evolution, 66(4):1079-1090.
</p>
<p>Diniz-filho, J.A.F., Bini, L.M., Rangel, T.F., Morales-Castilla, I., Olalla-Tarraga, M.A., Rodriguez, M.A. and Hawkins, B.A. (2012). On the selection of phylogenetic eigenvectors for ecological analyses. Ecography, 35:239-249.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PSR">PSR</a></code>,  <code><a href="#topic+PVRdecomp">PVRdecomp</a></code>,  <code><a href="#topic+PSRplot">PSRplot</a></code>,  <code><a href="#topic+VarPartplot">VarPartplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ape)
tree &lt;- rcoal(10)
#Decomposing phylogenetic distance matrix derived from tree into a set of orthogonal vectors
x &lt;- PVRdecomp(tree)
trait &lt;- runif(10)
y &lt;- PVR(x, trait = trait, method = "moran")
str(y)
</code></pre>

<hr>
<h2 id='PVR-class'>Class <code>"PVR"</code></h2><span id='topic+PVR-class'></span><span id='topic+show+2CPVR-method'></span>

<h3>Description</h3>

<p>A S4 class that contains eigenvalues and eigenvectors from decomposition of a phylogenetic distance matrix and PVR r squared and residuals.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("PVR", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Eigen</code>:</dt><dd><p>Object of class <code>"list"</code> that contains the eigenvalues and eigenvectors generated by phylogenetic distance matrix eigendecomposition.</p>
</dd>
<dt><code>phyDist</code>:</dt><dd><p>Object of class <code>"matrix"</code> that contains a phylogenetic distance matrix.</p>
</dd>
<dt><code>phylo</code>:</dt><dd><p>Object of class <code>"phylo"</code> that contains a phylogeny.</p>
</dd>
<dt><code>Selection</code>:</dt><dd><p>Object of class <code>"list"</code> that contains the selection method (along with its statistics) used to select the vectors, the selected vectors IDs and a matrix that contains the selected vectors.</p>
</dd>
<dt><code>PVR</code>:</dt><dd><p>Object of class <code>"list"</code> that contains the <b>P</b>hilogenetic  Eigen<b>V</b>ectors <b>R</b>egression r squared and residuals.</p>
</dd>
<dt><code>VarPart</code>:</dt><dd><p>Object of class <code>"list"</code> that contains the variation partition components.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "PVR")</code>: Always print the <code>Eigen</code> slot.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Santos, T; Diniz-Filho, J.A.F.; Rangel, T.F.; Bini, L.M.
</p>


<h3>References</h3>

<p>Diniz-Filho, J.A.F., Sant'Ana, C.E.R. and Bini, L.M. (1998). An eigenvector method for estimating phylogenetic inertia. Evolution 52:1247-1262.
</p>
<p>Legendre, P. and Legendre, L. (1998). Numerical ecology, 2nd Englished. Elsevier.
</p>
<p>Diniz-filho, J.A.F., Rangel, T.F., Santos, T. and Bini, L.M. (2012). Exploring patterns of interespecific variation in quantitative traits using sequential phylogenetic eigenvector regressions. Evolution, 66(4):1079-1090.
</p>
<p>Diniz-filho, J.A.F., Bini, L.M., Rangel, T.F., Morales-Castilla, I., Olalla-Tarraga, M.A., Rodriguez, M.A. and Hawkins, B.A. (2012). On the selection of phylogenetic eigenvectors for ecological analyses. Ecography, 35:239-249.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PSR-class">PSR-class</a></code>, <code><a href="#topic+PVR">PVR</a></code>, <code><a href="#topic+PSR">PSR</a></code>,  <code><a href="#topic+PVRdecomp">PVRdecomp</a></code>,  <code><a href="#topic+PSRplot">PSRplot</a></code>,  <code><a href="#topic+VarPartplot">VarPartplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("PVR")
</code></pre>

<hr>
<h2 id='PVR-package'>
Computes <b>P</b>hylogenetic eigen<b>V</b>ectors <b>R</b>egression and <b>P</b>hylogentic <b>S</b>ignal-<b>R</b>epresentation curve (with null and neutral expectations).
</h2><span id='topic+PVR-package'></span>

<h3>Description</h3>

<p>Computes PVR and PSR curve along with some plot utilitties.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PVR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-05-29</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL &gt;= 2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Santos, T; Diniz-Filho, J.A.F.; Rangel, T.F.; Bini, L.M.
</p>
<p>Maintainer: Thiago Santos &lt;thiago.santos@ufvjm.edu.br&gt;
</p>


<h3>References</h3>

<p>Diniz-Filho, J.A.F., Sant'Ana, C.E.R. and Bini, L.M. (1998). An eigenvector method for estimating phylogenetic inertia. Evolution 52:1247-1262.
</p>
<p>Diniz-filho, J.A.F., Rangel, T.F., Santos, T. and Bini, L.M. (2012). Exploring patterns of interespecific variation in quantitative traits using sequential phylogenetic eigenvector regressions. Evolution, 66(4):1079-1090.
</p>
<p>Diniz-filho, J.A.F., Bini, L.M., Rangel, T.F., Morales-Castilla, I., Olalla-Tarraga, M.A., Rodriguez, M.A. and Hawkins, B.A. (2012). On the selection of phylogenetic eigenvectors for ecological analyses. Ecography, 35:239-249.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PVR-class">PVR-class</a></code>, <code><a href="#topic+PSR-class">PSR-class</a></code>, <code><a href="#topic+PVR">PVR</a></code>, <code><a href="#topic+PSR">PSR</a></code>,  <code><a href="#topic+PVRdecomp">PVRdecomp</a></code>,  <code><a href="#topic+PSRplot">PSRplot</a></code>,  <code><a href="#topic+VarPartplot">VarPartplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(splancs)
#Creating a 10 tips ultrametric random phylogeny
library(ape)
tree &lt;- rcoal(10)
#Decomposing phylogenetic distance matrix derived from tree into a set of orthogonal vectors
x &lt;- PVRdecomp(tree)
trait &lt;- runif(10)
y &lt;- PSR(x, trait)
y
</code></pre>

<hr>
<h2 id='PVRdecomp'>
Phylogenetic distances matrix (eigen)decomposition.
</h2><span id='topic+PVRdecomp'></span>

<h3>Description</h3>

<p>The PVRdecomp function decompose phylogenetic distance matrices (computed based on phylogenies) into a set of orthongonal eigenvectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PVRdecomp(phy, type = "newick", dist = NULL, scale = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PVRdecomp_+3A_phy">phy</code></td>
<td>

<p>An object of class phylo that contains a ultrametric phylogeny with branch lengths or a character string that represents a phylogeny file (must have full path) of type given by type.
</p>
</td></tr>
<tr><td><code id="PVRdecomp_+3A_type">type</code></td>
<td>

<p>A character string with the phylogeny file format. It can be &quot;newick&quot; or &quot;nexus&quot;. Used only if phy is a character string, ignored otherwise.
</p>
</td></tr>
<tr><td><code id="PVRdecomp_+3A_dist">dist</code></td>
<td>

<p>A phylogenetic distance matrix. Not used.
</p>
</td></tr>
<tr><td><code id="PVRdecomp_+3A_scale">scale</code></td>
<td>

<p>Logical. Should the phylogenetic distances be scaled into the range of 0 to 1. Default is FALSE.
</p>
</td></tr>
<tr><td><code id="PVRdecomp_+3A_...">...</code></td>
<td>

<p>Not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The PVRdecomp funtion returns a object of (S4) class PVR with an Eigen slot that contains eigenvalues and eigenvectors computed after the matrix decomposition.
</p>


<h3>Author(s)</h3>

<p>Santos, T; Diniz-Filho, J.A.F.; Rangel, T.F.; Bini, L.M.
</p>


<h3>References</h3>

<p>Diniz-Filho, J.A.F., Sant'Ana, C.E.R. and Bini, L.M. (1998). An eigenvector method for estimating phylogenetic inertia. Evolution 52:1247-1262.
</p>
<p>Diniz-filho, J.A.F., Rangel, T.F., Santos, T. and Bini, L.M. (2012). Exploring patterns of interespecific variation in quantitative traits using sequential phylogenetic eigenvector regressions. Evolution, 66(4):1079-1090.
</p>
<p>Diniz-filho, J.A.F., Bini, L.M., Rangel, T.F., Morales-Castilla, I., Olalla-Tarraga, M.A., Rodriguez, M.A. and Hawkins, B.A. (2012). On the selection of phylogenetic eigenvectors for ecological analyses. Ecography, 35:239-249.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PVR">PVR</a></code>,  <code><a href="#topic+PSR">PSR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ape)
tree &lt;- rcoal(10)
#Decomposing phylogenetic distance matrix derived from tree into a set of orthogonal vectors
x &lt;- PVRdecomp(tree, scale = TRUE)
str(x)
</code></pre>

<hr>
<h2 id='VarPartplot'>
Plot function for objects of class PVR to show variation partition components.
</h2><span id='topic+VarPartplot'></span>

<h3>Description</h3>

<p>Plot a, b, c and d components of traits variation partition between phylogeny and environment (as defined by Desdevises et al., 2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VarPartplot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VarPartplot_+3A_x">x</code></td>
<td>

<p>An object of class PVR with a non NULL slot VarPart.
</p>
</td></tr>
<tr><td><code id="VarPartplot_+3A_...">...</code></td>
<td>

<p>Parameters passed to the plot function.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Santos, T; Diniz-Filho, J.A.F.; Rangel, T.F.; Bini, L.M.
</p>


<h3>References</h3>

<p>Diniz-Filho, J.A.F., Sant'Ana, C.E.R. and Bini, L.M. (1998). An eigenvector method for estimating phylogenetic inertia. Evolution 52:1247-1262.
</p>
<p>Legendre, P. and Legendre, L. (1998). Numerical ecology, 2nd Englished. Elsevier.
</p>
<p>Desdevises, Y., Legendre, P., Azouzi, L. and Morand, S. (2003). Quantifying phylogenetic structured environmental variation, Evolution, 57(11):2647-2652.
</p>
<p>Diniz-filho, J.A.F., Rangel, T.F., Santos, T. and Bini, L.M. (2012). Exploring patterns of interespecific variation in quantitative traits using sequential phylogenetic eigenvector regressions. Evolution, 66(4):1079-1090.
</p>
<p>Diniz-filho, J.A.F., Bini, L.M., Rangel, T.F., Morales-Castilla, I., Olalla-Tarraga, M.A., Rodriguez, M.A. and Hawkins, B.A. (2012). On the selection of phylogenetic eigenvectors for ecological analyses. Ecography, 35:239-249.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PSR">PSR</a></code>,  <code><a href="#topic+PVRdecomp">PVRdecomp</a></code>,  <code><a href="#topic+PVR">PVR</a></code>,  <code><a href="#topic+PSRplot">PSRplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ape)
tree &lt;- rcoal(10)
#Decomposing phylogenetic distance matrix derived from tree into a set of orthogonal vectors
x &lt;- PVRdecomp(tree)
trait &lt;- runif(10)
envvar &lt;- runif(10)
y &lt;- PVR(x, trait = trait, envVar = envvar, method = "moran")
VarPartplot(y)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
