<!DOCTYPE html><html><head><title>Help for package ensembleMOS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ensembleMOS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#brierScore'>
<p>Brier Score</p></a></li>
<li><a href='#cdf'>
<p>Cummulative distribution function for ensemble forcasting models</p></a></li>
<li><a href='#controlMOScsg0'>
<p>Control parameters for censored and shifted gamma EMOS models</p></a></li>
<li><a href='#controlMOSgev0'>
<p>Control parameters for censored generalized extreme value distribution EMOS models</p></a></li>
<li><a href='#controlMOSlognormal'>
<p>Control parameters for log-normal EMOS models</p></a></li>
<li><a href='#controlMOSnormal'>
<p>Control parameters for Gaussian (normal) EMOS models</p></a></li>
<li><a href='#controlMOStruncnormal'>
<p>Control parameters for truncated normal EMOS models</p></a></li>
<li><a href='#crps'>
<p>Continuous Ranked Probability Score</p></a></li>
<li><a href='#ensembleMOS'>
<p>EMOS modeling</p></a></li>
<li><a href='#ensembleMOScsg0'>
<p>Censored and shifted gamma EMOS modeling</p></a></li>
<li><a href='#ensembleMOSgev0'>
<p>Censored generalized extreme value distribution EMOS modeling</p></a></li>
<li><a href='#ensembleMOSlognormal'>
<p>Log-normal EMOS modeling</p></a></li>
<li><a href='#ensembleMOSnormal'>
<p>Gaussian (normal) EMOS modeling</p></a></li>
<li><a href='#ensembleMOStruncnormal'>
<p>Truncated normal EMOS modeling</p></a></li>
<li><a href='#fitMOS'>
<p>EMOS model fit to a training set</p></a></li>
<li><a href='#fitMOScsg0'>
<p>Censored and shifted gamma EMOS modeling</p></a></li>
<li><a href='#fitMOSgev0'>
<p>Censored generalized extreme value distribution EMOS modeling</p></a></li>
<li><a href='#fitMOSlognormal'>
<p>Log-normal EMOS model fit to a training set</p></a></li>
<li><a href='#fitMOSnormal'>
<p>Gaussian (normal) EMOS model fit to a training set</p></a></li>
<li><a href='#fitMOStruncnormal'>
<p>Truncated normal EMOS model fit to a training set</p></a></li>
<li><a href='#pars'>
<p>Forecast distribution parameters</p></a></li>
<li><a href='#quantileForecast'>
<p>Quantile forecasts at observation locations</p></a></li>
<li><a href='#trainingData'>
<p>Extract Training Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Ensemble Model Output Statistics</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-21</td>
</tr>
<tr>
<td>Author:</td>
<td>RA Yuen, Sandor Baran, Chris Fraley, Tilmann Gneiting, Sebastian Lerch, Michael Scheuerer, Thordis Thorarinsdottir</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sandor Baran &lt;baran.sandor@inf.unideb.hu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0), ensembleBMA, chron, evd</td>
</tr>
<tr>
<td>Suggests:</td>
<td>fields, maps</td>
</tr>
<tr>
<td>Description:</td>
<td>Ensemble Model Output Statistics to create probabilistic
        forecasts from ensemble forecasts and weather observations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-22 09:40:18 UTC; sebastian</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-22 09:50:57 UTC</td>
</tr>
</table>
<hr>
<h2 id='brierScore'>
Brier Score
</h2><span id='topic+brierScore'></span><span id='topic+brierScore.ensembleMOScsg0'></span><span id='topic+brierScore.ensembleMOSgev0'></span><span id='topic+brierScore.fitMOScsg0'></span><span id='topic+brierScore.fitMOSgev0'></span>

<h3>Description</h3>

<p>Computes the Brier score for the probability of exceedance of precipitation threshold values 
for univariate ensemble forecasting models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brierScore(fit, ensembleData, thresholds, dates=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brierScore_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data, obtained using
<code><a href="#topic+fitMOS">fitMOS</a></code> or <br /> <code><a href="#topic+ensembleMOS">ensembleMOS</a></code>. Only available
for the censored and shifted gamma, and the censored generalized
extreme value distribution model.
</p>
</td></tr>
<tr><td><code id="brierScore_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble forecasts,
verification observations and possibly dates.
Missing values (indicated by <code>NA</code>) are allowed.
This need not be the data used for the model <code>fit</code>,
although it must include the same ensemble members.
</p>
</td></tr>
<tr><td><code id="brierScore_+3A_thresholds">thresholds</code></td>
<td>

<p>Threshold values for which the probability of exceedance is evaluated, set to 0 
to evaluate probability of precipitation forecasts.
</p>
</td></tr>
<tr><td><code id="brierScore_+3A_dates">dates</code></td>
<td>

<p>The dates for which the CRPS will be computed.
These dates must be consistent with <code>fit</code> and <code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitMOS</code>,
which also ignores date information.
</p>
</td></tr>
<tr><td><code id="brierScore_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the Brier scores are only available for EMOS models suitable for
precipitation accumulation, i.e. the censored and shifted gamma, and the censored generalized
extreme value distribution EMOS model.
</p>


<h3>Value</h3>

<p><code>BScores</code> is a vector giving the Brier scores for each instance in the
data. 
</p>


<h3>References</h3>

<p>T. Gneiting and A. E. Raftery,
Strictly proper scoring rules, prediction and estimation,
<em>Journal of the American Statistical Association</em> 102:359&ndash;378, 2007.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOS">ensembleMOS</a></code>,
<code><a href="#topic+fitMOS">fitMOS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("PCP24","obs", sep = ".")
ens &lt;- paste("PCP24", ensMemNames, sep = ".")
prcpTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

prcpTestFitCSG0 &lt;- ensembleMOScsg0(prcpTestData, trainingDays = 25,
                                   dates = "2008010100")

brierScore(prcpTestFitCSG0, ensembleData = prcpTestData, 
           thresholds = 0)
</code></pre>

<hr>
<h2 id='cdf'>
Cummulative distribution function for ensemble forcasting models
</h2><span id='topic+cdf'></span><span id='topic+cdf.ensembleMOSnormal'></span><span id='topic+cdf.ensembleMOStruncnormal'></span><span id='topic+cdf.ensembleMOSlognormal'></span><span id='topic+cdf.ensembleMOScsg0'></span><span id='topic+cdf.ensembleMOSgev0'></span><span id='topic+cdf.fitMOSnormal'></span><span id='topic+cdf.fitMOStruncnormal'></span><span id='topic+cdf.fitMOSlognormal'></span><span id='topic+cdf.fitMOScsg0'></span><span id='topic+cdf.fitMOSgev0'></span>

<h3>Description</h3>

<p>Computes the cumulative distribution function (CDF)
of an ensemble forecasting model at observation locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdf(fit, ensembleData, values, dates = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdf_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data, obtained using
<code><a href="#topic+fitMOS">fitMOS</a></code> or <code><a href="#topic+ensembleMOS">ensembleMOS</a></code>.
</p>
</td></tr>
<tr><td><code id="cdf_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble forecasts,
verification observations and possibly dates.
Missing values (indicated by <code>NA</code>) are allowed.
This need not be the data used for the model <code>fit</code>,
although it must include the same ensemble members.
</p>
</td></tr>
<tr><td><code id="cdf_+3A_values">values</code></td>
<td>

<p>The vector of desired values at which the CDF of the ensemble
forecasting model is to be evaluated.
</p>
</td></tr>
<tr><td><code id="cdf_+3A_dates">dates</code></td>
<td>

<p>The dates for which the CDF will be computed.
These dates must be consistent with <code>fit</code> and <code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitMOS</code>,
which also ignores date information.
</p>
</td></tr>
<tr><td><code id="cdf_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is generic, and can be applied to any ensemble forecasting
model obtained using <code><a href="#topic+fitMOS">fitMOS</a></code> or <code><a href="#topic+ensembleMOS">ensembleMOS</a></code>. 
</p>
<p>For the EMOS models that allow for point masses at 0, i.e. the censored and 
shifted gamma, and the censored generalized extreme value distribution EMOS model,
the function contains an addition logical argument <code>randomizeATzero</code> that specifies
whether the value of the CDF at zero should be chosen randomly from the interval between
0 and the value of the CDF at zero. The default choice if <code>FALSE</code>, setting
<code>randomizeATzero = TRUE</code> is practical for computing randomized PIT values.
</p>


<h3>Value</h3>

<p>A matrix of probabilities corresponding to the CDF at the desired values.
Useful for determining propability of freezing, precipitation, etc.
</p>


<h3>References</h3>

<p>T. Gneiting, A. E. Raftery, A. H. Westveld and T. Goldman,
Calibrated probabilistic forecasting using ensemble model output
statistics and minimum CRPS estimation.
<em>Monthly Weather Review</em> 133:1098&ndash;1118, 2005.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOS">ensembleMOS</a></code>,
<code><a href="#topic+fitMOS">fitMOS</a></code>,
<code><a href="#topic+quantileForecast">quantileForecast</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

tempTestFit &lt;- ensembleMOS(tempTestData, trainingDays = 25, 
                           model = "normal",
                           dates = "2008010100")

tempTestCDF &lt;- cdf(tempTestFit, tempTestData,
                   values = seq(from=277, to=282, by = 1))

tempTestCDF
</code></pre>

<hr>
<h2 id='controlMOScsg0'>
Control parameters for censored and shifted gamma EMOS models
</h2><span id='topic+controlMOScsg0'></span>

<h3>Description</h3>

<p>Specifies a list of values controling the censored and shifted gamma EMOS fit
of ensemble forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlMOScsg0(scoringRule = c("crps", "log"),
               optimRule = c("Nelder-Mead", "BFGS", "L-BFGS-B"),
               coefRule = c("square", "none", "positive"),
               varRule = c("square", "none"),
               start = list(a = NULL, B = NULL,
                            c = NULL, d = NULL, q = NULL),
               maxIter = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlMOScsg0_+3A_scoringrule">scoringRule</code></td>
<td>

<p>The scoring rule to be used in optimum score estimation. Options
are &quot;crps&quot; for the continuous ranked probability score and &quot;log&quot; for
the logarithmic score.
</p>
</td></tr>
<tr><td><code id="controlMOScsg0_+3A_optimrule">optimRule</code></td>
<td>

<p>Numerical optimization method to be supplied to <code>optim</code>. 
Options are &quot;BFGS&quot; for the
Broyden-Fletcher-Goldfarb-Shanno algorithm and &quot;Nelder-Mead&quot; for the
Nelder-Mead method, see <a href="stats.html#topic+optim">optim</a> for details. Note that these 
options are only available for <code>scoringRule = "log"</code>. 
In case of <code>scoringRule = "crps"</code>, the optimization method
is set to &quot;L-BFGS-B&quot; by default.
</p>
</td></tr>
<tr><td><code id="controlMOScsg0_+3A_coefrule">coefRule</code></td>
<td>

<p>Method to control non-negativity of regression
estimates. Options are:
</p>

<ul>
<li> <p><code>"square"</code> EMOS coefficients are
parameterized as squares and thus gauranteed to be non-negative.
</p>
</li>
<li> <p><code>"positive"</code> finds non-negative coefficents
iteratively by setting negative estimates at the current iteration
to zero. 
</p>
</li>
<li> <p><code>"none"</code> no restriction on the coefficient
estimates.
</p>
</li></ul>

</td></tr>
<tr><td><code id="controlMOScsg0_+3A_varrule">varRule</code></td>
<td>

<p>Method to control non-negativity of the scale parameters.
Options <code>"square"</code> and <code>"none"</code> are the same as in
<code>coefRule</code>.
</p>
</td></tr>
<tr><td><code id="controlMOScsg0_+3A_start">start</code></td>
<td>

<p>A list of starting parameters, <code>a</code>, <code>B</code>, <code>c</code>, <code>d</code> 
and <code>q</code> specifying initial values for the intercept coefficient
and variance parameters supplied to <code>optim</code>. See details.
</p>
</td></tr>
<tr><td><code id="controlMOScsg0_+3A_maxiter">maxIter</code></td>
<td>

<p>An integer specifying the upper limit of the number of iterations
used to fit the model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no value is assigned to an argument, the first entry of 
the list of possibly choices will be used by default.
Note that optimMethod options are only available for <code>scoringRule = "log"</code>. 
In case of <code>scoringRule = "crps"</code>, the optimization method
is set to &quot;L-BFGS-B&quot; by default.
</p>
<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>, the
following shifted gamma model left-censored at 0
is fit by <code>ensembleMOScsg0</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ Gamma_0(\kappa,\theta,q)</code>
</p>

<p>where <code class="reqn">Gamma_0</code> denotes the shifted gamma distribution left-censored at zero,
with shape <code class="reqn">\kappa</code>, scale <code class="reqn">\theta</code> and shift <code class="reqn">q</code>. The model is 
parametrized such that the mean <code class="reqn">\kappa\theta</code> is a linear function
<code class="reqn">a + b_1 X_1 + \ldots + b_m X_m</code>
of the ensemble forecats, and the variance <code class="reqn">\kappa\theta^2</code> is a linear
function of the ensemble mean <code class="reqn">c+d \overline{f}</code>, see <a href="#topic+ensembleMOScsg0">ensembleMOScsg0</a>
for details.
</p>


<h3>Value</h3>

<p>A list whose components are the input arguments and their assigned
values.
</p>


<h3>References</h3>

<p>M. Scheuerer and T. M. Hamill, Statistical post-processing of ensemble precipitation
forecasts by fitting censored, shifted gamma distributions. 
<em>Monthly Weather Review</em> 143:4578&ndash;4596, 2015.
</p>
<p>S. Baran and D. Nemoda, Censored and shifted gamma distribution based EMOS
model for probabilistic quantitative precipitation forecasting. 
<em>Environmetrics</em> 27:280&ndash;292, 2016.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOScsg0">ensembleMOScsg0</a></code>,
<code><a href="#topic+fitMOScsg0">fitMOScsg0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("PCP24","obs", sep = ".")
ens &lt;- paste("PCP24", ensMemNames, sep = ".")
prcpTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

prcpTestFitCSG0 &lt;- ensembleMOScsg0(prcpTestData, trainingDays = 25,
                                   dates = "2008010100",
                                   control = controlMOScsg0(maxIter = as.integer(100),
                                                            scoringRule = "log",
                                                            optimRule = "Nelder-Mead",
                                                            coefRule= "none", 
                                                            varRule = "square"))

</code></pre>

<hr>
<h2 id='controlMOSgev0'>
Control parameters for censored generalized extreme value distribution EMOS models
</h2><span id='topic+controlMOSgev0'></span>

<h3>Description</h3>

<p>Specifies a list of values controling the censored generalized extreme value distribution
EMOS fit of ensemble forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlMOSgev0(optimRule = c("Nelder-Mead", "L-BFGS-B", "BFGS"),
               coefRule = c("square", "none", "positive"),
               varRule = c("square", "none"),
               start = list(a = NULL, B = NULL, 
                            s = NULL, c = NULL, 
                            d = NULL, q = NULL),
               maxIter = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlMOSgev0_+3A_optimrule">optimRule</code></td>
<td>

<p>Numerical optimization method to be supplied to <code>optim</code>. 
Options are &quot;BFGS&quot; for the Broyden-Fletcher-Goldfarb-Shanno algorithm,
&quot;L-BFGS-B&quot; for a constrained version thereof, and &quot;Nelder-Mead&quot; for the
Nelder-Mead method, see <a href="stats.html#topic+optim">optim</a> for details.
</p>
</td></tr>
<tr><td><code id="controlMOSgev0_+3A_coefrule">coefRule</code></td>
<td>

<p>Method to control non-negativity of regression
estimates. Options are:
</p>

<ul>
<li> <p><code>"square"</code> EMOS coefficients are
parameterized as squares and thus gauranteed to be non-negative.
</p>
</li>
<li> <p><code>"positive"</code> finds non-negative coefficents
iteratively by setting negative estimates at the current iteration
to zero. 
</p>
</li>
<li> <p><code>"none"</code> no restriction on the coefficient
estimates.
</p>
</li></ul>

</td></tr>
<tr><td><code id="controlMOSgev0_+3A_varrule">varRule</code></td>
<td>

<p>Method to control non-negativity of the scale parameters.
Options <code>"square"</code> and <code>"none"</code> are the same as in
<code>coefRule</code>.
</p>
</td></tr>
<tr><td><code id="controlMOSgev0_+3A_start">start</code></td>
<td>

<p>A list of starting parameters, <code>a</code>, <code>B</code>, <code>s</code>, 
<code>c</code>, <code>d</code> and <code>q</code> specifying initial values for the 
location, scale and shape coefficients supplied to <code>optim</code>. See details.
</p>
</td></tr>
<tr><td><code id="controlMOSgev0_+3A_maxiter">maxIter</code></td>
<td>

<p>An integer specifying the upper limit of the number of iterations
used to fit the model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that only minimum CRPS estimation is available and
chosen by default.
</p>
<p>If no value is assigned to an argument, the first entry of 
the list of possibly choices will be used by default.
</p>
<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>, the
following generalized extreme value distribution EMOS
model left-censored at 0 is fit by <code>ensembleMOSgev0</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ GEV_0(\mu,\sigma,q)</code>
</p>

<p>where <code class="reqn">GEV_0</code> denotes the generalized extreme value distribution
left-censored at zero,
with location <code class="reqn">\mu</code>, scale <code class="reqn">\sigma</code> and shape <code class="reqn">q</code>. The model is 
parametrized such that the mean <code class="reqn">m</code> is a linear function
<code class="reqn">a + b_1 X_1 + \ldots + b_m X_m + s p_0</code>
of the ensemble forecats, where <code class="reqn">p_0</code> denotes the ratio of ensemble forecasts
that are exactly 0, and the shape parameter <code class="reqn">\sigma</code> is a linear
function of the ensemble variance <code class="reqn">c + d MD(X_1,\ldots,X_m)</code>, where
<code class="reqn">MD(X_1,\ldots,X_m)</code> is Gini's mean difference. 
See <a href="#topic+ensembleMOSgev0">ensembleMOSgev0</a> for details.
</p>


<h3>Value</h3>

<p>A list whose components are the input arguments and their assigned
values.
</p>


<h3>References</h3>

<p>M. Scheuerer, Probabilistic quantitative precipitation forecasting using ensemble
model output statistics. <em>Quarterly Journal of the Royal Meteorological
Society</em> 140:1086&ndash;1096, 2014.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOScsg0">ensembleMOScsg0</a></code>,
<code><a href="#topic+fitMOScsg0">fitMOScsg0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("PCP24","obs", sep = ".")
ens &lt;- paste("PCP24", ensMemNames, sep = ".")
prcpTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")
                             
prcpTestFitGEV0 &lt;- ensembleMOSgev0(prcpTestData, trainingDays = 25,
                        dates = "2008010100",
                        control = controlMOSgev0(maxIter = as.integer(100),
                           optimRule = "Nelder-Mead",
                           coefRule= "none", 
                           varRule = "square"))
</code></pre>

<hr>
<h2 id='controlMOSlognormal'>
Control parameters for log-normal EMOS models
</h2><span id='topic+controlMOSlognormal'></span>

<h3>Description</h3>

<p>Specifies a list of values controling the log-normal EMOS fit
of ensemble forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlMOSlognormal(scoringRule = c("crps", "log"),
                    optimRule = c("BFGS","Nelder-Mead"),
                    coefRule = c("square", "none", "positive"),
                    varRule = c("square", "none"),
                    start = list(a = NULL, B = NULL,
                                 c = NULL, d = NULL),
                    maxIter = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlMOSlognormal_+3A_scoringrule">scoringRule</code></td>
<td>

<p>The scoring rule to be used in optimum score estimation.  Options
are &quot;crps&quot; for the continuous ranked probability score and &quot;log&quot; for
the logarithmic score.
</p>
</td></tr>
<tr><td><code id="controlMOSlognormal_+3A_optimrule">optimRule</code></td>
<td>

<p>Numerical optimization method to be supplied to <code>optim</code>. 
Options are &quot;BFGS&quot; for the
Broyden-Fletcher-Goldfarb-Shanno algorithm and &quot;Nelder-Mead&quot; for the
Nelder-Mead method, see <a href="stats.html#topic+optim">optim</a> for details.
</p>
</td></tr>
<tr><td><code id="controlMOSlognormal_+3A_coefrule">coefRule</code></td>
<td>

<p>Method to control non-negativity of regression
estimates. Options are:
</p>

<ul>
<li> <p><code>"square"</code> EMOS coefficients are
parameterized as squares and thus gauranteed to be non-negative.
</p>
</li>
<li> <p><code>"positive"</code> finds non-negative coefficents
iteratively by setting negative estimates at the current iteration
to zero. 
</p>
</li>
<li> <p><code>"none"</code> no restriction on the coefficient
estimates.
</p>
</li></ul>

</td></tr>
<tr><td><code id="controlMOSlognormal_+3A_varrule">varRule</code></td>
<td>

<p>Method to control non-negativity of the variance parameters.
Options <code>"square"</code> and <code>"none"</code> are the same as in
<code>coefRule</code>.
</p>
</td></tr>
<tr><td><code id="controlMOSlognormal_+3A_start">start</code></td>
<td>

<p>A list of starting parameters, <code>a</code>, <code>B</code>, <code>c</code> and
<code>d</code> specifying initial values for the intercept coefficient
and scale parameters supplied to <code>optim</code>. See details.
</p>
</td></tr>
<tr><td><code id="controlMOSlognormal_+3A_maxiter">maxIter</code></td>
<td>

<p>An integer specifying the upper limit of the number of iterations
used to fit the model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no value is assigned to an argument, the first entry of 
the list of possibly choices will be used by default.
Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>,  the
following log-normal model is fit by <code>ensembleMOSlognormal</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ LN(\mu, \sigma)</code>
</p>

<p>where <code class="reqn">LN</code> denotes the log-normal distrbution with <code>meanlog</code> 
parameter <code class="reqn">\mu</code> and <code>scalelog</code> parameter <code class="reqn">\sigma</code>, see
<a href="stats.html#topic+Lognormal">Lognormal</a>. The model is parametrized such that the mean value of 
the log-normal distribution is a linear function <code class="reqn">a + b_1 X_1 + \ldots + b_m X_m</code>
of the ensemble forecats, and the variance is a linear function
<code class="reqn">c + d S^2</code>. For transformations between <code class="reqn">\mu, \sigma</code> and mean
and variance of the log-normal distribution, see Baran and Lerch (2015).
See <a href="#topic+ensembleMOSlognormal">ensembleMOSlognormal</a> for details.
</p>
<p>Note that in case of <code>scoringRule = "log"</code>, forecast cases in the
training period with observation values of 0 are ignored in the model 
estimation as 0 is not included in the support of the log-normal 
distribution.
</p>


<h3>Value</h3>

<p>A list whose components are the input arguments and their assigned
values.
</p>


<h3>References</h3>

<p>S. Baran and S. Lerch, Log-normal distribution based Ensemble Model
Output Statistics models for probabilistic wind-speed forecasting. 
<em>Quarterly Journal of the Royal Meteorological Society</em> 141:2289&ndash;2299,
2015.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOSlognormal">ensembleMOSlognormal</a></code>,
<code><a href="#topic+fitMOSlognormal">fitMOSlognormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("MAXWSP10","obs", sep = ".")
ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")
windTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

windTestFitLN &lt;- ensembleMOSlognormal(windTestData, trainingDays = 25,
                                      dates = "2008010100",
                                      control = controlMOSlognormal(maxIter = as.integer(100),
                                                                    scoringRule = "log",
                                                                    optimRule = "BFGS",
                                                                    coefRule= "none", 
                                                                    varRule = "square"))
</code></pre>

<hr>
<h2 id='controlMOSnormal'>
Control parameters for Gaussian (normal) EMOS models
</h2><span id='topic+controlMOSnormal'></span>

<h3>Description</h3>

<p>Specifies a list of values controling the Gaussian (normal) EMOS fit
of ensemble forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlMOSnormal(scoringRule = c("crps", "log"),
                 optimRule = c("BFGS","Nelder-Mead"),
                 coefRule = c("square", "none", "positive"),
                 varRule = c("square", "none"),
                 start = list(a = NULL, B = NULL,
                              c = NULL, d = NULL),
                 maxIter = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlMOSnormal_+3A_scoringrule">scoringRule</code></td>
<td>

<p>The scoring rule to be used in optimum score estimation.  Options
are &quot;crps&quot; for the continuous ranked probability score and &quot;log&quot; for
the logarithmic score.
</p>
</td></tr>
<tr><td><code id="controlMOSnormal_+3A_optimrule">optimRule</code></td>
<td>

<p>Numerical optimization method to be supplied to <code>optim</code>. 
Options are &quot;BFGS&quot; for the
Broyden-Fletcher-Goldfarb-Shanno algorithm and &quot;Nelder-Mead&quot; for the
Nelder-Mead method, see <a href="stats.html#topic+optim">optim</a> for details.
</p>
</td></tr>
<tr><td><code id="controlMOSnormal_+3A_coefrule">coefRule</code></td>
<td>

<p>Method to control non-negativity of regression
estimates. Options are:
</p>

<ul>
<li> <p><code>"square"</code> EMOS coefficients are
parameterized as squares and thus gauranteed to be non-negative.
</p>
</li>
<li> <p><code>"positive"</code> finds non-negative coefficents
iteratively by setting negative estimates at the current iteration
to zero. 
</p>
</li>
<li> <p><code>"none"</code> no restriction on the coefficient
estimates.
</p>
</li></ul>

</td></tr>
<tr><td><code id="controlMOSnormal_+3A_varrule">varRule</code></td>
<td>

<p>Method to control non-negativity of the variance parameters.
Options <code>"square"</code> and <code>"none"</code> are the same as in
<code>coefRule</code>.
</p>
</td></tr>
<tr><td><code id="controlMOSnormal_+3A_start">start</code></td>
<td>

<p>A list of starting parameters, <code>a</code>, <code>B</code>, <code>c</code> and
<code>d</code> specifying initial values for the intercept coefficient
and variance parameters supplied to <code>optim</code>. See details.
</p>
</td></tr>
<tr><td><code id="controlMOSnormal_+3A_maxiter">maxIter</code></td>
<td>

<p>An integer specifying the upper limit of the number of iterations
used to fit the model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no value is assigned to an argument, the first entry of 
the list of possibly choices will be used by default.
Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>,  the
following Gaussian model is fit by <code>ensembleMOSnormal</code>: 
</p>
<p style="text-align: center;"><code class="reqn"> Y ~ N(a + b_1 X_1 + ... + b_m X_m , c + dS^2).</code>
</p>

<p><code>B</code> is the array of fitted regression coefficients <code class="reqn">b_1,
    \ldots, b_m</code> for each date.  See <a href="#topic+ensembleMOSnormal">ensembleMOSnormal</a> for details.
</p>


<h3>Value</h3>

<p>A list whose components are the input arguments and their assigned
values.
</p>


<h3>References</h3>

<p>T. Gneiting, A. E. Raftery, A. H. Westveld and T. Goldman,
calibrated probabilistic forecasting using ensemble model output
statistics and minimum CRPS estimation.
<em>Monthly Weather Review</em> 133:1098&ndash;1118, 2005.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOSnormal">ensembleMOSnormal</a></code>,
<code><a href="#topic+fitMOSnormal">fitMOSnormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

tempTestFit &lt;- ensembleMOSnormal(tempTestData, trainingDays = 25, 
                                 dates = "2008010100",
                                 control = controlMOSnormal(maxIter = as.integer(100),
                                                            scoringRule = "log",
                                                            optimRule = "BFGS",
                                                            coefRule= "none", 
                                                            varRule = "square"))
</code></pre>

<hr>
<h2 id='controlMOStruncnormal'>
Control parameters for truncated normal EMOS models
</h2><span id='topic+controlMOStruncnormal'></span>

<h3>Description</h3>

<p>Specifies a list of values controling the truncated normal EMOS fit
of ensemble forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlMOStruncnormal(scoringRule = c("crps", "log"),
                      optimRule = c("BFGS","Nelder-Mead"),
                      coefRule = c("square", "none", "positive"),
                      varRule = c("square", "none"),
                      start = list(a = NULL, B = NULL,
                                   c = NULL, d = NULL),
                      maxIter = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlMOStruncnormal_+3A_scoringrule">scoringRule</code></td>
<td>

<p>The scoring rule to be used in optimum score estimation. Options
are &quot;crps&quot; for the continuous ranked probability score and &quot;log&quot; for
the logarithmic score.
</p>
</td></tr>
<tr><td><code id="controlMOStruncnormal_+3A_optimrule">optimRule</code></td>
<td>

<p>Numerical optimization method to be supplied to <code>optim</code>. 
Options are &quot;BFGS&quot; for the
Broyden-Fletcher-Goldfarb-Shanno algorithm and &quot;Nelder-Mead&quot; for the
Nelder-Mead method, see <a href="stats.html#topic+optim">optim</a> for details.
</p>
</td></tr>
<tr><td><code id="controlMOStruncnormal_+3A_coefrule">coefRule</code></td>
<td>

<p>Method to control non-negativity of regression
estimates. Options are:
</p>

<ul>
<li> <p><code>"square"</code> EMOS coefficients are
parameterized as squares and thus gauranteed to be non-negative.
</p>
</li>
<li> <p><code>"positive"</code> finds non-negative coefficents
iteratively by setting negative estimates at the current iteration
to zero. 
</p>
</li>
<li> <p><code>"none"</code> no restriction on the coefficient
estimates.
</p>
</li></ul>

</td></tr>
<tr><td><code id="controlMOStruncnormal_+3A_varrule">varRule</code></td>
<td>

<p>Method to control non-negativity of the scale parameters.
Options <code>"square"</code> and <code>"none"</code> are the same as in
<code>coefRule</code>.
</p>
</td></tr>
<tr><td><code id="controlMOStruncnormal_+3A_start">start</code></td>
<td>

<p>A list of starting parameters, <code>a</code>, <code>B</code>, <code>c</code> and
<code>d</code> specifying initial values for the intercept coefficient
and variance parameters supplied to <code>optim</code>. See details.
</p>
</td></tr>
<tr><td><code id="controlMOStruncnormal_+3A_maxiter">maxIter</code></td>
<td>

<p>An integer specifying the upper limit of the number of iterations
used to fit the model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no value is assigned to an argument, the first entry of 
the list of possibly choices will be used by default.
</p>
<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>, the
following truncated normal model is fit by <code>ensembleMOStruncnormal</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ N_0(a + b_1 X_1 + ... + b_m X_m, c + dS^2),</code>
</p>

<p>where <code class="reqn">N_0</code> denotes the normal distribution truncated at zero,
with location <code class="reqn">a + b_1 X_1 + ... + b_m X_m</code> and squared scale
<code class="reqn">c + dS^2</code>.
<code>B</code> is a vector of fitted regression coefficients <code class="reqn">b_1,
  \ldots, b_m</code>. See <a href="#topic+ensembleMOStruncnormal">ensembleMOStruncnormal</a> for details.  
</p>


<h3>Value</h3>

<p>A list whose components are the input arguments and their assigned
values.
</p>


<h3>References</h3>

<p>T. L. Thorarinsdottir and T. Gneiting,
Probabilistic forecasts of wind speed: 
Ensemble model output statistics by using 
heteroscedastic censored regression.
<em>Journal of the Royal Statistical Society Series A</em> 
173:371&ndash;388, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOStruncnormal">ensembleMOStruncnormal</a></code>,
<code><a href="#topic+fitMOStruncnormal">fitMOStruncnormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("MAXWSP10","obs", sep = ".")
ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")
windTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

windTestFitTN &lt;- ensembleMOStruncnormal(windTestData, trainingDays = 25,
                                        dates = "2008010100",
                                        control = controlMOStruncnormal(maxIter = as.integer(100),
                                                                        scoringRule = "log",
                                                                        optimRule = "BFGS",
                                                                        coefRule= "none", 
                                                                        varRule = "square"))
</code></pre>

<hr>
<h2 id='crps'>
Continuous Ranked Probability Score
</h2><span id='topic+crps'></span><span id='topic+crps.ensembleMOSnormal'></span><span id='topic+crps.ensembleMOStruncnormal'></span><span id='topic+crps.ensembleMOSlognormal'></span><span id='topic+crps.ensembleMOScsg0'></span><span id='topic+crps.ensembleMOSgev0'></span><span id='topic+crps.fitMOSnormal'></span><span id='topic+crps.fitMOStruncnormal'></span><span id='topic+crps.fitMOSlognormal'></span><span id='topic+crps.fitMOScsg0'></span><span id='topic+crps.fitMOSgev0'></span>

<h3>Description</h3>

<p>Computes the continuous ranked probability score (CRPS)
for univariate ensemble forecasting models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crps(fit, ensembleData, dates=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crps_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data, obtained using
<code><a href="#topic+fitMOS">fitMOS</a></code> or <br /> <code><a href="#topic+ensembleMOS">ensembleMOS</a></code>.
</p>
</td></tr>
<tr><td><code id="crps_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble forecasts,
verification observations and possibly dates.
Missing values (indicated by <code>NA</code>) are allowed.
This need not be the data used for the model <code>fit</code>,
although it must include the same ensemble members.
</p>
</td></tr>
<tr><td><code id="crps_+3A_dates">dates</code></td>
<td>

<p>The dates for which the CRPS will be computed.
These dates must be consistent with <code>fit</code> and <code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitMOS</code>,
which also ignores date information.
</p>
</td></tr>
<tr><td><code id="crps_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These methods are generic, and can be applied to all ensemble
forecasting models. Missing values in forecasts and/or observations
result in <code>NA</code> values in the CRPS vector.
</p>


<h3>Value</h3>

<p><code>crps</code> is a matrix giving the CRPS for each instance in the data for 
both the raw ensemble and the probabilistic forecast. 
</p>


<h3>References</h3>

<p>T. Gneiting and A. E. Raftery,
Strictly proper scoring rules, prediction and estimation,
<em>Journal of the American Statistical Association</em> 102:359&ndash;378, 2007.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOS">ensembleMOS</a></code>,
<code><a href="#topic+fitMOS">fitMOS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

tempTestFit &lt;- ensembleMOS(tempTestData, trainingDays = 25, 
                           dates = "2008010100",
                           model = "normal")

crpsValues &lt;- crps(tempTestFit, tempTestData)
colMeans(crpsValues)
</code></pre>

<hr>
<h2 id='ensembleMOS'>
EMOS modeling
</h2><span id='topic+ensembleMOS'></span><span id='topic+ensembleObsLabels'></span><span id='topic+ensembleSize'></span><span id='topic+ensembleNobs'></span><span id='topic+ensembleValidDates'></span><span id='topic+ensembleVerifObs'></span><span id='topic+ensembleObsLabels.ensembleData'></span><span id='topic+ensembleSize.ensembleData'></span><span id='topic+ensembleNobs.ensembleData'></span><span id='topic+ensembleValidDates.ensembleData'></span><span id='topic+ensembleVerifObs.ensembleData'></span><span id='topic+matchEnsembleMembers'></span><span id='topic+matchEnsembleMembers.ensembleMOSnormal'></span><span id='topic+matchEnsembleMembers.fitMOSnormal'></span><span id='topic+ensembleMemberLabels'></span><span id='topic+ensembleMemberLabels.ensembleData'></span><span id='topic+matchITandFH.default'></span><span id='topic+matchITandFH'></span><span id='topic+getExchangeable'></span><span id='topic+getHH'></span>

<h3>Description</h3>

<p>Fits a EMOS model to ensemble forecasts.
Allows specification of a model, training rule, and forecasting dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleMOS(ensembleData, trainingDays, consecutive = FALSE,
            dates = NULL, control = NULL, warmStart = FALSE,
            model = NULL, exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleMOS_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts with the
corresponding verifying observations and their dates.
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td></tr>
<tr><td><code id="ensembleMOS_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td></tr> 
<tr><td><code id="ensembleMOS_+3A_consecutive">consecutive</code></td>
<td>

<p>If <code>TRUE</code> then the sequence of dates in the training set are
treated as consecutive, i.e. date gaps are ignored
</p>
</td></tr>
<tr><td><code id="ensembleMOS_+3A_dates">dates</code></td>
<td>

<p>The dates for which EMOS forecasting models are desired.
By default, this will be all dates in <code>ensembleData</code>
for which modeling is allowed given the training rule.
</p>
</td></tr>
<tr><td><code id="ensembleMOS_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions. The corresponding
control function has to be chosen in accordance with the selected 
<code>model</code>. For the Gaussian (normal) EMOS model see <a href="#topic+controlMOSnormal">controlMOSnormal</a>,
for the truncated normal model see <a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a>,
for the log-normal model see <a href="#topic+controlMOSlognormal">controlMOSlognormal</a>,
for the censored and shifted gamma model see <a href="#topic+controlMOScsg0">controlMOScsg0</a>,
and for the censored generalized extreme value distribution model see <a href="#topic+controlMOSgev0">controlMOSgev0</a>.
</p>
</td></tr>
<tr><td><code id="ensembleMOS_+3A_warmstart">warmStart</code></td>
<td>

<p>If <code>TRUE</code>, then starting values for parameters in optimization
are set to the estimates of the preceding date's fit.
</p>
</td></tr> 
<tr><td><code id="ensembleMOS_+3A_model">model</code></td>
<td>

<p>A character string describing the EMOS model to be fit.
Current choices are <code>"normal"</code> (typically used for temperature
or pressure data), <code>"truncnormal"</code> (typically used for wind 
speed data), <code>"lognormal"</code> (typically used for wind 
speed data), <code>"csg0"</code> (typically used for precipitation accumulation data),
and <code>"gev0"</code> (typically used for precipitation accumulation data).
For specific details on model fitting see <a href="#topic+ensembleMOSnormal">ensembleMOSnormal</a>,
<a href="#topic+ensembleMOStruncnormal">ensembleMOStruncnormal</a>, <a href="#topic+ensembleMOSlognormal">ensembleMOSlognormal</a>, 
<a href="#topic+ensembleMOScsg0">ensembleMOScsg0</a>, or <a href="#topic+ensembleMOSgev0">ensembleMOSgev0</a>.
</p>
</td></tr>
<tr><td><code id="ensembleMOS_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The model fit will have equal weights and parameters within each
group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If dates are specified in <code>dates</code> that cannot be forecast
with the training rule, the corresponding EMOS model parameter
outputs will be missing (<code>NA</code>) but not <code>NULL</code>. <br />
The training rule uses the number of days corresponding to its
<code>length</code> regardless of whether or not the dates are consecutive.
<br />
</p>


<h3>Value</h3>

<p>A list containing information on the training (length, lag and the 
number of instances used for training for each modeling date), the
exchangeability, and vectors and/or matrics containing the estimated
regression and variance coefficient values depending on the specified
<code>model</code>.
</p>


<h3>References</h3>

<p><em>Gaussian (normal) EMOS model</em>: <br />
T. Gneiting, A. E. Raftery, A. H. Westveld and T. Goldman,
Calibrated probabilistic forecasting using ensemble model output
statistics and minimum CRPS estimation.
<em>Monthly Weather Review</em> 133:1098&ndash;1118, 2005.
<br /><br />
<em>Truncated normal EMOS model</em>: <br />
T. L. Thorarinsdottir and T. Gneiting,
Probabilistic forecasts of wind speed: 
Ensemble model output statistics by using 
heteroscedastic censored regression.
<em>Journal of the Royal Statistical Society Series A</em> 
173:371&ndash;388, 2010.
<br /><br />
<em>Log-normal EMOS model</em>: <br />
S. Baran and S. Lerch, Log-normal distribution based Ensemble Model
Output Statistics models for probabilistic wind-speed forecasting. 
<em>Quarterly Journal of the Royal Meteorological Society</em> 141:2289&ndash;2299,
2015.
<br /><br />
<em>Censored and shifted gamma EMOS model</em>: <br />
M. Scheuerer and T. M. Hamill, Statistical post-processing of ensemble precipitation
forecasts by fitting censored, shifted gamma distributions. 
<em>Monthly Weather Review</em> 143:4578&ndash;4596, 2015.<br />
S. Baran and D. Nemoda, Censored and shifted gamma distribution based EMOS
model for probabilistic quantitative precipitation forecasting. 
<em>Environmetrics</em> 27:280&ndash;292, 2016.  
<br /><br />
<em>Censored generalized extreme value distribution EMOS model</em>: <br />
M. Scheuerer, Probabilistic quantitative precipitation forecasting using ensemble
model output statistics. <em>Quarterly Journal of the Royal Meteorological
Society</em> 140:1086&ndash;1096, 2014.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trainingData">trainingData</a></code>,
<code><a href="#topic+ensembleMOSnormal">ensembleMOSnormal</a></code>,
<code><a href="#topic+ensembleMOStruncnormal">ensembleMOStruncnormal</a></code>,
<code><a href="#topic+ensembleMOSlognormal">ensembleMOSlognormal</a></code>,
<code><a href="#topic+ensembleMOScsg0">ensembleMOScsg0</a></code>,
<code><a href="#topic+ensembleMOSgev0">ensembleMOSgev0</a></code>,
<code><a href="#topic+controlMOSnormal">controlMOSnormal</a></code>,
<code><a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a></code>,
<code><a href="#topic+controlMOSlognormal">controlMOSlognormal</a></code>,
<code><a href="#topic+controlMOScsg0">controlMOScsg0</a></code>,
<code><a href="#topic+controlMOSgev0">controlMOSgev0</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

tempTestFit &lt;- ensembleMOS(tempTestData, trainingDays = 25, 
                           model = "normal")

 ## Same as
 ## tempTestFit &lt;- ensembleMOSnormal(tempTestData, trainingDays = 25)
</code></pre>

<hr>
<h2 id='ensembleMOScsg0'>
Censored and shifted gamma EMOS modeling
</h2><span id='topic+ensembleMOScsg0'></span>

<h3>Description</h3>

<p>Fits a censored and shifted gamma EMOS model to ensemble forecasts for
specified dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleMOScsg0(ensembleData, trainingDays, consecutive = FALSE,
                dates = NULL, control = controlMOScsg0(),
                warmStart = FALSE, exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleMOScsg0_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts with
the corresponding verifying observations and their dates.
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td></tr>
<tr><td><code id="ensembleMOScsg0_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td></tr>
<tr><td><code id="ensembleMOScsg0_+3A_consecutive">consecutive</code></td>
<td>

<p>If <code>TRUE</code> then the sequence of dates in the training set are
treated as consecutive, i.e. date gaps are ignored.
</p>
</td></tr>
<tr><td><code id="ensembleMOScsg0_+3A_dates">dates</code></td>
<td>

<p>The dates for which EMOS forecasting models are desired.
By default, this will be all dates in <code>ensembleData</code>
for which modeling is allowed given the training rule.
</p>
</td></tr>
<tr><td><code id="ensembleMOScsg0_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions specified via the
function  <a href="#topic+controlMOScsg0">controlMOScsg0</a>. For details
and default values, see <a href="#topic+controlMOScsg0">controlMOScsg0</a>.
</p>
</td></tr>
<tr><td><code id="ensembleMOScsg0_+3A_warmstart">warmStart</code></td>
<td>

<p>If <code>TRUE</code>, then starting values for parameters in optimization
are set to the estimates of the preceding date's fit.
</p>
</td></tr>
<tr><td><code id="ensembleMOScsg0_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The modeling will have equal parameters within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>, the
following shifted gamma model left-censored at 0
is fit by <code>ensembleMOScsg0</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ Gamma_0(\kappa,\theta,q)</code>
</p>

<p>where <code class="reqn">Gamma_0</code> denotes the shifted gamma distribution left-censored at zero,
with shape <code class="reqn">\kappa</code>, scale <code class="reqn">\theta</code> and shift <code class="reqn">q</code>. The model is 
parametrized such that the mean <code class="reqn">\kappa\theta</code> is a linear function
<code class="reqn">a + b_1 X_1 + \ldots + b_m X_m</code>
of the ensemble forecats, and the variance <code class="reqn">\kappa\theta^2</code> is a linear
function of the ensemble mean <code class="reqn">c+d \overline{f}</code>, see Baran and Nemoda (2016) 
for details.
</p>
<p><code>B</code> is a vector of fitted regression coefficients: <code class="reqn">b_1,
  \ldots, b_m</code>.  Specifically, <code class="reqn">a, b_1,\ldots, b_m, c, d, q</code> are
fitted to optimize
<code>control$scoringRule</code> over the specified training period using
<code>optim</code> with <code>method = control$optimRule</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>training</code></td>
<td>

<p>A list containing information on the training length and lag and
the number of instances used for training for each modeling date.
</p>
</td></tr>
<tr><td><code>a</code></td>
<td>

<p>A vector of fitted EMOS intercept parameters for each date.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>

<p>A matrix of fitted EMOS coefficients for each date.
</p>
</td></tr>
<tr><td><code>c</code>, <code>d</code></td>
<td>

<p>The fitted parameters for the variance, see details.
</p>
</td></tr>
<tr><td><code>q</code></td>
<td>

<p>Fitted shift parameter, see details.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>M. Scheuerer and T. M. Hamill, Statistical post-processing of ensemble precipitation
forecasts by fitting censored, shifted gamma distributions. 
<em>Monthly Weather Review</em> 143:4578&ndash;4596, 2015.
</p>
<p>S. Baran and D. Nemoda, Censored and shifted gamma distribution based EMOS
model for probabilistic quantitative precipitation forecasting. 
<em>Environmetrics</em> 27:280&ndash;292, 2016.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+controlMOScsg0">controlMOScsg0</a></code>,
<code><a href="#topic+fitMOScsg0">fitMOScsg0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("PCP24","obs", sep = ".")
ens &lt;- paste("PCP24", ensMemNames, sep = ".")
prcpTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

fitDates &lt;- c("2008010100", "2008010200")
prcpTestFitGEV0 &lt;- ensembleMOSgev0(prcpTestData, trainingDays = 25,
                                   dates = fitDates)
</code></pre>

<hr>
<h2 id='ensembleMOSgev0'>
Censored generalized extreme value distribution EMOS modeling
</h2><span id='topic+ensembleMOSgev0'></span>

<h3>Description</h3>

<p>Fits a Censored generalized extreme value distribution EMOS model to ensemble forecasts for
specified dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleMOSgev0(ensembleData, trainingDays, consecutive = FALSE,
                dates = NULL, control = controlMOSgev0(),
                warmStart = FALSE, exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleMOSgev0_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts with
the corresponding verifying observations and their dates.
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td></tr>
<tr><td><code id="ensembleMOSgev0_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td></tr>
<tr><td><code id="ensembleMOSgev0_+3A_consecutive">consecutive</code></td>
<td>

<p>If <code>TRUE</code> then the sequence of dates in the training set are
treated as consecutive, i.e. date gaps are ignored.
</p>
</td></tr>
<tr><td><code id="ensembleMOSgev0_+3A_dates">dates</code></td>
<td>

<p>The dates for which EMOS forecasting models are desired.
By default, this will be all dates in <code>ensembleData</code>
for which modeling is allowed given the training rule.
</p>
</td></tr>
<tr><td><code id="ensembleMOSgev0_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions specified via the
function  <a href="#topic+controlMOSgev0">controlMOSgev0</a>. For details
and default values, see <a href="#topic+controlMOSgev0">controlMOSgev0</a>.
</p>
</td></tr>
<tr><td><code id="ensembleMOSgev0_+3A_warmstart">warmStart</code></td>
<td>

<p>If <code>TRUE</code>, then starting values for parameters in optimization
are set to the estimates of the preceding date's fit.
</p>
</td></tr>
<tr><td><code id="ensembleMOSgev0_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The modeling will have equal parameters within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>, the
following generalized extreme value distribution EMOS
model left-censored at 0 is fit by <code>ensembleMOSgev0</code>: 
</p>
<p style="text-align: center;"><code class="reqn"> Y ~ GEV_0(\mu,\sigma,q)</code>
</p>

<p>where <code class="reqn">GEV_0</code> denotes the generalized extreme value distribution
left-censored at zero,
with location <code class="reqn">\mu</code>, scale <code class="reqn">\sigma</code> and shape <code class="reqn">q</code>. The model is 
parametrized such that the mean <code class="reqn">m</code> is a linear function
<code class="reqn">a + b_1 X_1 + \ldots + b_m X_m + s p_0</code>
of the ensemble forecats, where <code class="reqn">p_0</code> denotes the ratio of ensemble forecasts
that are exactly 0, and the shape parameter <code class="reqn">\sigma</code> is a linear
function of the ensemble variance <code class="reqn">c + d MD(X_1,\ldots,X_m)</code>, where
<code class="reqn">MD(X_1,\ldots,X_m)</code> is Gini's mean difference. 
See <a href="#topic+ensembleMOSgev0">ensembleMOSgev0</a> for details.
</p>
<p><code>B</code> is a vector of fitted regression coefficients: <code class="reqn">b_1,
  \ldots, b_m</code>.  Specifically, <code class="reqn">a, b_1,\ldots, b_m, s, c, d, q</code> are
fitted to optimize
the mean CRPS over the specified training period using
<code>optim</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>training</code></td>
<td>

<p>A list containing information on the training length and lag and
the number of instances used for training for each modeling date.
</p>
</td></tr>
<tr><td><code>a</code></td>
<td>

<p>A vector of fitted EMOS intercept parameters for each date.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>

<p>A matrix of fitted EMOS coefficients for each date.
</p>
</td></tr>
<tr><td><code>s</code></td>
<td>

<p>A vector of fitted EMOS coefficients for <code class="reqn">p_0</code> for each date, 
see details.
</p>
</td></tr>
<tr><td><code>c</code>, <code>d</code></td>
<td>

<p>The fitted coefficients for the shape parameter, see details.
</p>
</td></tr>
<tr><td><code>q</code></td>
<td>

<p>Fitted shape parameter, see details.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>M. Scheuerer, Probabilistic quantitative precipitation forecasting using ensemble
model output statistics. <em>Quarterly Journal of the Royal Meteorological
Society</em> 140:1086&ndash;1096, 2014.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+controlMOSgev0">controlMOSgev0</a></code>,
<code><a href="#topic+fitMOSgev0">fitMOSgev0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("PCP24","obs", sep = ".")
ens &lt;- paste("PCP24", ensMemNames, sep = ".")
prcpTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")
                             
prcpTestFitGEV0 &lt;- ensembleMOSgev0(prcpTestData, trainingDays = 25,
                                   dates = "2008010100")
</code></pre>

<hr>
<h2 id='ensembleMOSlognormal'>
Log-normal EMOS modeling
</h2><span id='topic+ensembleMOSlognormal'></span>

<h3>Description</h3>

<p>Fits a log-normal EMOS model to ensemble forecasts for
specified dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleMOSlognormal(ensembleData, trainingDays, consecutive = FALSE,
                     dates = NULL, control = controlMOSlognormal(),
                     warmStart = FALSE, exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleMOSlognormal_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts with
the corresponding verifying observations and their dates.
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td></tr>
<tr><td><code id="ensembleMOSlognormal_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td></tr>
<tr><td><code id="ensembleMOSlognormal_+3A_consecutive">consecutive</code></td>
<td>

<p>If <code>TRUE</code> then the sequence of dates in the training set are
treated as consecutive, i.e. date gaps are ignored.
</p>
</td></tr>
<tr><td><code id="ensembleMOSlognormal_+3A_dates">dates</code></td>
<td>

<p>The dates for which EMOS forecasting models are desired.
By default, this will be all dates in <code>ensembleData</code>
for which modeling is allowed given the training rule.
</p>
</td></tr>
<tr><td><code id="ensembleMOSlognormal_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions specified via the
function  <a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a>. For details
and default values, see <a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a>.
</p>
</td></tr>
<tr><td><code id="ensembleMOSlognormal_+3A_warmstart">warmStart</code></td>
<td>

<p>If <code>TRUE</code>, then starting values for parameters in optimization
are set to the estimates of the preceding date's fit.
</p>
</td></tr>
<tr><td><code id="ensembleMOSlognormal_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The modeling will have equal parameters within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>,  the
following log-normal model is fit by <code>ensembleMOSlognormal</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ LN(\mu, \sigma)</code>
</p>

<p>where <code class="reqn">LN</code> denotes the log-normal distrbution with <code>meanlog</code> 
parameter <code class="reqn">\mu</code> and <code>scalelog</code> parameter <code class="reqn">\sigma</code>, see
<a href="stats.html#topic+Lognormal">Lognormal</a>. The model is parametrized such that the mean value of 
the log-normal distribution is a linear function <code class="reqn">a + b_1 X_1 + \ldots + b_m X_m</code>
of the ensemble forecats, and the variance is a linear function
<code class="reqn">c + d S^2</code>. For transformations between <code class="reqn">\mu, \sigma</code> and mean
and variance of the log-normal distribution, see Baran and Lerch (2015).
See <a href="#topic+ensembleMOSlognormal">ensembleMOSlognormal</a> for details.
<code>B</code> is a vector of fitted regression coefficients: <code class="reqn">b_1,
  \ldots, b_m</code>.  Specifically, <code class="reqn">a, b_1,\ldots, b_m, c, d</code> are
fitted to optimize
<code>control$scoringRule</code> over the specified training period using
<code>optim</code> with <code>method = control$optimRule</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>training</code></td>
<td>

<p>A list containing information on the training length and lag and
the number of instances used for training for each modeling date.
</p>
</td></tr>
<tr><td><code>a</code></td>
<td>

<p>A vector of fitted EMOS intercept parameters for each date.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>

<p>A matrix of fitted EMOS coefficients for each date.
</p>
</td></tr>
<tr><td><code>c</code>, <code>d</code></td>
<td>

<p>The fitted parameters for the variance, see details.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>S. Baran and S. Lerch, Log-normal distribution based Ensemble Model
Output Statistics models for probabilistic wind-speed forecasting. 
<em>Quarterly Journal of the Royal Meteorological Society</em> 141:2289&ndash;2299,
2015.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+controlMOSlognormal">controlMOSlognormal</a></code>,
<code><a href="#topic+fitMOSlognormal">fitMOSlognormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("MAXWSP10","obs", sep = ".")
ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")
windTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

windTestFitLN &lt;- ensembleMOSlognormal(windTestData, trainingDays = 25)
</code></pre>

<hr>
<h2 id='ensembleMOSnormal'>
Gaussian (normal) EMOS modeling
</h2><span id='topic+ensembleMOSnormal'></span>

<h3>Description</h3>

<p>Fits a Gaussian (normal) EMOS model to ensemble forecasts for
specified dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleMOSnormal(ensembleData, trainingDays, consecutive = FALSE,
                  dates = NULL, control = controlMOSnormal(),
                  warmStart = FALSE, exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleMOSnormal_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts with
the corresponding verifying observations and their dates.
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td></tr>
<tr><td><code id="ensembleMOSnormal_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td></tr>
<tr><td><code id="ensembleMOSnormal_+3A_consecutive">consecutive</code></td>
<td>

<p>If <code>TRUE</code> then the sequence of dates in the training set are
treated as consecutive, i.e. date gaps are ignored.
</p>
</td></tr>
<tr><td><code id="ensembleMOSnormal_+3A_dates">dates</code></td>
<td>

<p>The dates for which EMOS forecasting models are desired.
By default, this will be all dates in <code>ensembleData</code>
for which modeling is allowed given the training rule.
</p>
</td></tr>
<tr><td><code id="ensembleMOSnormal_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions specified via the
function  <a href="#topic+controlMOSnormal">controlMOSnormal</a>. For details
and default values, see <a href="#topic+controlMOSnormal">controlMOSnormal</a>.
</p>
</td></tr>
<tr><td><code id="ensembleMOSnormal_+3A_warmstart">warmStart</code></td>
<td>

<p>If <code>TRUE</code>, then starting values for parameters in optimization
are set to the estimates of the preceding date's fit.
</p>
</td></tr>
<tr><td><code id="ensembleMOSnormal_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The modeling will have equal parameters within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>,  the
following Gaussian model is fit by <code>ensembleMOSnormal</code>: 
</p>
<p style="text-align: center;"><code class="reqn"> Y ~ N(a + b_1 X_1 + ... + b_m X_m , c + dS^2).</code>
</p>

<p><code>B</code> is a vector of fitted regression coefficients: <code class="reqn">b_1,
    \ldots ,b_m</code>.  Specifically, <code class="reqn">a,b_1,\ldots , b_m, c, d</code> are
fitted to optimize
<code>control$scoringRule</code> over the specified training period using
<code>optim</code> with <code>method = control$optimRule</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>training</code></td>
<td>

<p>A list containing information on the training length and lag and
the number of instances used for training for each modeling date.
</p>
</td></tr>
<tr><td><code>a</code></td>
<td>

<p>A vector of fitted EMOS intercept parameters for each date.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>

<p>A matrix of fitted EMOS coefficients for each date.
</p>
</td></tr>
<tr><td><code>c</code>, <code>d</code></td>
<td>

<p>Vectors of the fitted variance parameters for each date, see details.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>T. Gneiting, A. E. Raftery, A. H. Westveld and T. Goldman,
Calibrated probabilistic forecasting using ensemble model output
statistics and minimum CRPS estimation.
<em>Monthly Weather Review</em> 133:1098&ndash;1118, 2005.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+controlMOSnormal">controlMOSnormal</a></code>,
<code><a href="#topic+fitMOSnormal">fitMOSnormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")
                             
tempTestFit &lt;- ensembleMOSnormal(tempTestData, trainingDays = 25)
</code></pre>

<hr>
<h2 id='ensembleMOStruncnormal'>
Truncated normal EMOS modeling
</h2><span id='topic+ensembleMOStruncnormal'></span>

<h3>Description</h3>

<p>Fits a truncated normal EMOS model to ensemble forecasts for
specified dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensembleMOStruncnormal(ensembleData, trainingDays, consecutive = FALSE,
                       dates = NULL, control = controlMOStruncnormal(),
                       warmStart = FALSE, exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensembleMOStruncnormal_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts with
the corresponding verifying observations and their dates.
Missing values (indicated by <code>NA</code>) are allowed.
</p>
</td></tr>
<tr><td><code id="ensembleMOStruncnormal_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer giving the number of time steps (e.g. days)
in the training period. There is no default.
</p>
</td></tr>
<tr><td><code id="ensembleMOStruncnormal_+3A_consecutive">consecutive</code></td>
<td>

<p>If <code>TRUE</code> then the sequence of dates in the training set are
treated as consecutive, i.e. date gaps are ignored.
</p>
</td></tr>
<tr><td><code id="ensembleMOStruncnormal_+3A_dates">dates</code></td>
<td>

<p>The dates for which EMOS forecasting models are desired.
By default, this will be all dates in <code>ensembleData</code>
for which modeling is allowed given the training rule.
</p>
</td></tr>
<tr><td><code id="ensembleMOStruncnormal_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions specified via the
function  <a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a>. For details
and default values, see <a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a>.
</p>
</td></tr>
<tr><td><code id="ensembleMOStruncnormal_+3A_warmstart">warmStart</code></td>
<td>

<p>If <code>TRUE</code>, then starting values for parameters in optimization
are set to the estimates of the preceding date's fit.
</p>
</td></tr>
<tr><td><code id="ensembleMOStruncnormal_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The modeling will have equal parameters within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>, the
following truncated normal model is fit by <code>ensembleMOStruncnormal</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ N_0(a + b_1 X_1 + ... + b_m X_m, c + dS^2),</code>
</p>

<p>where <code class="reqn">N_0</code> denotes the normal distribution truncated at zero,
with location <code class="reqn">a + b_1 X_1 + ... + b_m X_m</code> and squared scale
<code class="reqn">c + dS^2</code>.
<code>B</code> is a vector of fitted regression coefficients: <code class="reqn">b_1,
  \ldots, b_m</code>.  Specifically, <code class="reqn">a, b_1,\ldots, b_m, c, d</code> are
fitted to optimize
<code>control$scoringRule</code> over the specified training period using
<code>optim</code> with <code>method = control$optimRule</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>training</code></td>
<td>

<p>A list containing information on the training length and lag and
the number of instances used for training for each modeling date.
</p>
</td></tr>
<tr><td><code>a</code></td>
<td>

<p>A vector of fitted EMOS intercept parameters for each date.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>

<p>A matrix of fitted EMOS coefficients for each date.
</p>
</td></tr>
<tr><td><code>c</code>, <code>d</code></td>
<td>

<p>The fitted parameters for the squared scale, see details.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>T. L. Thorarinsdottir and T. Gneiting,
Probabilistic forecasts of wind speed: 
Ensemble model output statistics by using 
heteroscedastic censored regression.
<em>Journal of the Royal Statistical Society Series A</em> 
173:371&ndash;388, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a></code>,
<code><a href="#topic+fitMOStruncnormal">fitMOStruncnormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("MAXWSP10","obs", sep = ".")
ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")
windTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

windTestFitTN &lt;- ensembleMOStruncnormal(windTestData, trainingDays = 25)
</code></pre>

<hr>
<h2 id='fitMOS'>
EMOS model fit to a training set
</h2><span id='topic+fitMOS'></span>

<h3>Description</h3>

<p>Fits an EMOS model to a given training set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitMOS(ensembleData, control = NULL, model = NULL,
       exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitMOS_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included.  This is the training set for the model.
</p>
</td></tr>
<tr><td><code id="fitMOS_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions. The corresponding
control function has to be chosen in accordance with the selected 
<code>model</code>. For the Gaussian (normal) EMOS model see <a href="#topic+controlMOSnormal">controlMOSnormal</a>,
for the truncated normal model see <a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a>,
for the log-normal model see <a href="#topic+controlMOSlognormal">controlMOSlognormal</a>,
for the censored and shifted gamma model see <a href="#topic+controlMOScsg0">controlMOScsg0</a>,
and for the censored generalized extreme value distribution model see <a href="#topic+controlMOSgev0">controlMOSgev0</a>.
</p>
</td></tr>
<tr><td><code id="fitMOS_+3A_model">model</code></td>
<td>

<p>A character string describing the EMOS model to be fit.
Current choices are <code>"normal"</code> (typically used for temperature
or pressure data), <code>"truncnormal"</code> (typically used for wind 
speed data), <code>"lognormal"</code> (typically used for wind 
speed data), <code>"csg0"</code> (typically used for precipitation accumulation data),
and <code>"gev0"</code> (typically used for precipitation accumulation data).
For specific details on model fitting see <a href="#topic+ensembleMOSnormal">ensembleMOSnormal</a>,
<a href="#topic+ensembleMOStruncnormal">ensembleMOStruncnormal</a>, <a href="#topic+ensembleMOSlognormal">ensembleMOSlognormal</a>, 
<a href="#topic+ensembleMOScsg0">ensembleMOScsg0</a>, or <a href="#topic+ensembleMOSgev0">ensembleMOSgev0</a>.
</p>
</td></tr>
<tr><td><code id="fitMOS_+3A_exchangeable">exchangeable</code></td>
<td>

<p>A numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The model fit will have equal weights and parameters
within each group.
The default determines exchangeability from <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with estimated coefficient values. The specific content depends on 
the chosen <code>model</code>.
</p>


<h3>References</h3>

<p><em>Gaussian (normal) EMOS model</em>: <br />
T. Gneiting, A. E. Raftery, A. H. Westveld and T. Goldman,
Calibrated probabilistic forecasting using ensemble model output
statistics and minimum CRPS estimation.
<em>Monthly Weather Review</em> 133:1098&ndash;1118, 2005.
<br /><br />
<em>Truncated (normal) EMOS model</em>: <br />
T. L. Thorarinsdottir and T. Gneiting,
Probabilistic forecasts of wind speed: 
Ensemble model output statistics by using 
heteroscedastic censored regression.
<em>Journal of the Royal Statistical Society Series A</em> 
173:371&ndash;388, 2010.
<br /><br />
<em>Log-normal EMOS model</em>: <br />
S. Baran and S. Lerch, Log-normal distribution based Ensemble Model
Output Statistics models for probabilistic wind-speed forecasting. 
<em>Quarterly Journal of the Royal Meteorological Society</em> 141:2289&ndash;2299,
2015.
<br /><br />
<em>Censored and shifted gamma EMOS model</em>: <br />
M. Scheuerer and T. M. Hamill, Statistical post-processing of ensemble precipitation
forecasts by fitting censored, shifted gamma distributions. 
<em>Monthly Weather Review</em> 143:4578&ndash;4596, 2015.<br />
S. Baran and D. Nemoda, Censored and shifted gamma distribution based EMOS
model for probabilistic quantitative precipitation forecasting. 
<em>Environmetrics</em> 27:280&ndash;292, 2016.  
<br /><br />
<em>Censored generalized extreme value distribution EMOS model</em>: <br />
M. Scheuerer, Probabilistic quantitative precipitation forecasting using ensemble
model output statistics. <em>Quarterly Journal of the Royal Meteorological
Society</em> 140:1086&ndash;1096, 2014.
</p>


<h3>See Also</h3>

<p><a href="#topic+fitMOSnormal">fitMOSnormal</a>
<a href="#topic+fitMOStruncnormal">fitMOStruncnormal</a>
<a href="#topic+fitMOSlognormal">fitMOSlognormal</a>
<a href="#topic+fitMOScsg0">fitMOScsg0</a>
<a href="#topic+fitMOSgev0">fitMOSgev0</a>
<a href="#topic+controlMOSnormal">controlMOSnormal</a>
<a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a>
<a href="#topic+controlMOSlognormal">controlMOSlognormal</a>
<a href="#topic+controlMOScsg0">controlMOScsg0</a>
<a href="#topic+controlMOSgev0">controlMOSgev0</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

tempTrain &lt;- trainingData(tempTestData, trainingDays = 30,
                          date  = "2008010100")

tempTrainFit &lt;- fitMOS(tempTrain, model = "normal")

## equivalent to
##    tempTrainFit &lt;- fitMOSnormal(tempTrain)
</code></pre>

<hr>
<h2 id='fitMOScsg0'>
Censored and shifted gamma EMOS modeling
</h2><span id='topic+fitMOScsg0'></span>

<h3>Description</h3>

<p>Fits a censored and shifted gamma EMOS model to a given training set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitMOScsg0(ensembleData, control = controlMOScsg0(),
           exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitMOScsg0_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included.  This is the training set for the model.
</p>
</td></tr>
<tr><td><code id="fitMOScsg0_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions specified via the
function  <a href="#topic+controlMOScsg0">controlMOScsg0</a>. For details
and default values, see <a href="#topic+controlMOScsg0">controlMOScsg0</a>.
</p>
</td></tr>
<tr><td><code id="fitMOScsg0_+3A_exchangeable">exchangeable</code></td>
<td>

<p>An optional numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The models have equal EMOS coefficients within each group.
If supplied, this argument will override any specification of
exchangeability in <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>, the
following shifted gamma model left-censored at 0
is fit by <code>ensembleMOScsg0</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ Gamma_0(\kappa,\theta,q)</code>
</p>

<p>where <code class="reqn">Gamma_0</code> denotes the shifted gamma distribution left-censored at zero,
with shape <code class="reqn">\kappa</code>, scale <code class="reqn">\theta</code> and shift <code class="reqn">q</code>. The model is 
parametrized such that the mean <code class="reqn">\kappa\theta</code> is a linear function
<code class="reqn">a + b_1 X_1 + \ldots + b_m X_m</code>
of the ensemble forecats, and the variance <code class="reqn">\kappa\theta^2</code> is a linear
function of the ensemble mean <code class="reqn">c+d \overline{f}</code>, see Baran and Nemoda (2016) 
for details.
</p>
<p><code>B</code> is a vector of fitted regression coefficients: <code class="reqn">b_1,
  \ldots, b_m</code>.  Specifically, <code class="reqn">a, b_1,\ldots, b_m, c, d</code> are
fitted to optimize
<code>control$scoringRule</code> over the specified training period using
<code>optim</code> with <code>method = control$optimRule</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>training</code></td>
<td>

<p>A list containing information on the training length and lag and
the number of instances used for training for each modeling date.
</p>
</td></tr>
<tr><td><code>a</code></td>
<td>

<p>A vector of fitted EMOS intercept parameters for each date.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>

<p>A matrix of fitted EMOS coefficients for each date.
</p>
</td></tr>
<tr><td><code>c</code>, <code>d</code></td>
<td>

<p>The fitted parameters for the variance, see details.
</p>
</td></tr>
<tr><td><code>q</code></td>
<td>

<p>Fitted shift parameter, see details.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>M. Scheuerer and T. M. Hamill, Statistical post-processing of ensemble precipitation
forecasts by fitting censored, shifted gamma distributions. 
<em>Monthly Weather Review</em> 143:4578&ndash;4596, 2015.
</p>
<p>S. Baran and D. Nemoda, Censored and shifted gamma distribution based EMOS
model for probabilistic quantitative precipitation forecasting. 
<em>Environmetrics</em> 27:280&ndash;292, 2016.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+controlMOScsg0">controlMOScsg0</a></code>,
<code><a href="#topic+ensembleMOScsg0">ensembleMOScsg0</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("PCP24","obs", sep = ".")
ens &lt;- paste("PCP24", ensMemNames, sep = ".")
prcpTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

prcpTrain &lt;- trainingData(prcpTestData, trainingDays = 30,
                             date = "2008010100")

prcpTestFit &lt;- fitMOScsg0(prcpTrain)
</code></pre>

<hr>
<h2 id='fitMOSgev0'>
Censored generalized extreme value distribution EMOS modeling
</h2><span id='topic+fitMOSgev0'></span>

<h3>Description</h3>

<p>Fits a censored generalized extreme value distribution EMOS model to a given training set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitMOSgev0(ensembleData, control = controlMOSgev0(),
           exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitMOSgev0_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included.  This is the training set for the model.
</p>
</td></tr>
<tr><td><code id="fitMOSgev0_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions specified via the
function  <a href="#topic+controlMOSgev0">controlMOSgev0</a>. For details
and default values, see <a href="#topic+controlMOSgev0">controlMOSgev0</a>.
</p>
</td></tr>
<tr><td><code id="fitMOSgev0_+3A_exchangeable">exchangeable</code></td>
<td>

<p>An optional numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The models have equal EMOS coefficients within each group.
If supplied, this argument will override any specification of
exchangeability in <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>, the
following generalized extreme value distribution EMOS
model left-censored at 0 is fit by <code>ensembleMOSgev0</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ GEV_0(\mu,\sigma,q)</code>
</p>

<p>where <code class="reqn">GEV_0</code> denotes the generalized extreme value distribution
left-censored at zero,
with location <code class="reqn">\mu</code>, scale <code class="reqn">\sigma</code> and shape <code class="reqn">q</code>. The model is 
parametrized such that the mean <code class="reqn">m</code> is a linear function
<code class="reqn">a + b_1 X_1 + \ldots + b_m X_m + s p_0</code>
of the ensemble forecats, where <code class="reqn">p_0</code> denotes the ratio of ensemble forecasts
that are exactly 0, and the shape parameter <code class="reqn">\sigma</code> is a linear
function of the ensemble variance <code class="reqn">c + d MD(X_1,\ldots,X_m)</code>, where
<code class="reqn">MD(X_1,\ldots,X_m)</code> is Gini's mean difference. 
See <a href="#topic+ensembleMOSgev0">ensembleMOSgev0</a> for details.
</p>
<p><code>B</code> is a vector of fitted regression coefficients: <code class="reqn">b_1,
  \ldots, b_m</code>.  Specifically, <code class="reqn">a, b_1,\ldots, b_m, s, c, d, q</code> are
fitted to optimize
the mean CRPS over the specified training period using
<code>optim</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>training</code></td>
<td>

<p>A list containing information on the training length and lag and
the number of instances used for training for each modeling date.
</p>
</td></tr>
<tr><td><code>a</code></td>
<td>

<p>A vector of fitted EMOS intercept parameters for each date.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>

<p>A matrix of fitted EMOS coefficients for each date.
</p>
</td></tr>
<tr><td><code>s</code></td>
<td>

<p>A vector of fitted EMOS coefficients for <code class="reqn">p_0</code> for each date, 
see details.
</p>
</td></tr>
<tr><td><code>c</code>, <code>d</code></td>
<td>

<p>The fitted coefficients for the shape parameter, see details.
</p>
</td></tr>
<tr><td><code>q</code></td>
<td>

<p>Fitted shape parameter, see details.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>M. Scheuerer, Probabilistic quantitative precipitation forecasting using ensemble
model output statistics. <em>Quarterly Journal of the Royal Meteorological
Society</em> 140:1086&ndash;1096, 2014.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+controlMOSgev0">controlMOSgev0</a></code>,
<code><a href="#topic+ensembleMOSgev0">ensembleMOSgev0</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("PCP24","obs", sep = ".")
ens &lt;- paste("PCP24", ensMemNames, sep = ".")
prcpTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

prcpTrain &lt;- trainingData(prcpTestData, trainingDays = 30,
                             date = "2008010100")

prcpTestFit &lt;- fitMOSgev0(prcpTrain)
</code></pre>

<hr>
<h2 id='fitMOSlognormal'>
Log-normal EMOS model fit to a training set
</h2><span id='topic+fitMOSlognormal'></span>

<h3>Description</h3>

<p>Fits a log-normal EMOS model to a given training set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitMOSlognormal(ensembleData, control = controlMOSlognormal(),
                exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitMOSlognormal_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included.  This is the training set for the model.
</p>
</td></tr>
<tr><td><code id="fitMOSlognormal_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions specified via the
function  <a href="#topic+controlMOSlognormal">controlMOSlognormal</a>. For details
and default values, see <a href="#topic+controlMOSlognormal">controlMOSlognormal</a>.
</p>
</td></tr>
<tr><td><code id="fitMOSlognormal_+3A_exchangeable">exchangeable</code></td>
<td>

<p>An optional numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The models have equal EMOS coefficients within each group.
If supplied, this argument will override any specification of
exchangeability in <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>,  the
following log-normal model is fit by <code>ensembleMOSlognormal</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ LN(\mu, \sigma)</code>
</p>

<p>where <code class="reqn">LN</code> denotes the log-normal distrbution with <code>meanlog</code> 
parameter <code class="reqn">\mu</code> and <code>scalelog</code> parameter <code class="reqn">\sigma</code>, see
<a href="stats.html#topic+Lognormal">Lognormal</a>. The model is parametrized such that the mean value of 
the log-normal distribution is a linear function <code class="reqn">a + b_1 X_1 + \ldots + b_m X_m</code>
of the ensemble forecats, and the variance is a linear function
<code class="reqn">c + d S^2</code>. For transformations between <code class="reqn">\mu, \sigma</code> and mean
and variance of the log-normal distribution, see Baran and Lerch (2015).
See <a href="#topic+ensembleMOSlognormal">ensembleMOSlognormal</a> for details.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>a</code></td>
<td>

<p>The fitted intercept.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>

<p>The fitted EMOS coefficients.
</p>
</td></tr>
<tr><td><code>c</code>, <code>d</code></td>
<td>

<p>The fitted parameters for the variance, see details.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>S. Baran and S. Lerch, Log-normal distribution based Ensemble Model
Output Statistics models for probabilistic wind-speed forecasting. 
<em>Quarterly Journal of the Royal Meteorological Society</em> 141:2289&ndash;2299,
2015.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+controlMOSlognormal">controlMOSlognormal</a></code>,
<code><a href="#topic+ensembleMOSlognormal">ensembleMOSlognormal</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("MAXWSP10","obs", sep = ".")
ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")
windTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")
                             
windTrain &lt;- trainingData(windTestData, trainingDays = 30,
                          date = "2008010100")

windTestFit &lt;- fitMOSlognormal(windTrain)
</code></pre>

<hr>
<h2 id='fitMOSnormal'>
Gaussian (normal) EMOS model fit to a training set
</h2><span id='topic+fitMOSnormal'></span>

<h3>Description</h3>

<p>Fits a Gaussian (normal) EMOS model to a given training set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitMOSnormal(ensembleData, control = controlMOSnormal(),
             exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitMOSnormal_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included.  This is the training set for the model.
</p>
</td></tr>
<tr><td><code id="fitMOSnormal_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions specified via the
function  <a href="#topic+controlMOSnormal">controlMOSnormal</a>. For details
and default values, see <a href="#topic+controlMOSnormal">controlMOSnormal</a>.
</p>
</td></tr>
<tr><td><code id="fitMOSnormal_+3A_exchangeable">exchangeable</code></td>
<td>

<p>An optional numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The models have equal EMOS coefficients within each group.
If supplied, this argument will override any specification of
exchangeability in <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>,  the
following Gaussian model is fit by <code>ensembleMOSnormal</code>: 
</p>
<p style="text-align: center;"><code class="reqn"> Y ~ N(a + b_1 X_1 + ... + b_m X_m , c + dS^2).</code>
</p>

<p><code>B</code> is a vector of fitted regression coefficients: <code class="reqn">b_1,
    \ldots ,b_m</code>.  Specifically, <code class="reqn">a,b_1,\ldots , b_m, c, d</code> are
fitted to optimize
<code>control$scoringRule</code> over the specified training period using
<code>optim</code> with <code>method = control$optimRule</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>a</code></td>
<td>

<p>The fitted intercept.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>

<p>The fitted EMOS coefficients.
</p>
</td></tr>
<tr><td><code>c</code>, <code>d</code></td>
<td>

<p>The fitted variance parameters, see details.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>T. Gneiting, A. E. Raftery, A. H. Westveld and T. Goldman,
Calibrated probabilistic forecasting using ensemble model output
statistics and minimum CRPS estimation.
<em>Monthly Weather Review</em> 133:1098&ndash;1118, 2005.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+controlMOSnormal">controlMOSnormal</a></code>,
<code><a href="#topic+ensembleMOSnormal">ensembleMOSnormal</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

tempTrain &lt;- trainingData(tempTestData, trainingDays = 30,
                             date = "2008010100")

tempTrainFit &lt;- fitMOSnormal(tempTrain)
</code></pre>

<hr>
<h2 id='fitMOStruncnormal'>
Truncated normal EMOS model fit to a training set
</h2><span id='topic+fitMOStruncnormal'></span>

<h3>Description</h3>

<p>Fits a truncated normal EMOS model to a given training set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitMOStruncnormal(ensembleData, control = controlMOStruncnormal(),
                  exchangeable = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitMOStruncnormal_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object including ensemble forecasts and
verification observations.
Missing values (indicated by <code>NA</code>) are allowed. Dates are ignored
if they are included.  This is the training set for the model.
</p>
</td></tr>
<tr><td><code id="fitMOStruncnormal_+3A_control">control</code></td>
<td>

<p>A list of control values for the fitting functions specified via the
function  <a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a>. For details
and default values, see <a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a>.
</p>
</td></tr>
<tr><td><code id="fitMOStruncnormal_+3A_exchangeable">exchangeable</code></td>
<td>

<p>An optional numeric or character vector or factor indicating groups of
ensemble members that are exchangeable (indistinguishable).
The models have equal EMOS coefficients within each group.
If supplied, this argument will override any specification of
exchangeability in <code>ensembleData</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given an ensemble of size <code class="reqn">m</code>: <code class="reqn">X_1, \ldots , X_m</code>, the
following truncated normal model is fit by <code>ensembleMOStruncnormal</code>: 
</p>
<p style="text-align: center;"><code class="reqn">Y ~ N_0(a + b_1 X_1 + ... + b_m X_m, c + dS^2),</code>
</p>

<p>where <code class="reqn">N_0</code> denotes the normal distribution truncated at zero,
with location <code class="reqn">a + b_1 X_1 + ... + b_m X_m</code> and squared scale
<code class="reqn">c + dS^2</code>.
<code>B</code> is a vector of fitted regression coefficients: <code class="reqn">b_1,
  \ldots, b_m</code>.  Specifically, <code class="reqn">a, b_1,\ldots, b_m, c, d</code> are
fitted to optimize
<code>control$scoringRule</code> over the specified training period using
<code>optim</code> with <code>method = control$optimRule</code>.
</p>


<h3>Value</h3>

<p>A list with the following output components:
</p>
<table>
<tr><td><code>a</code></td>
<td>

<p>The fitted intercept.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>

<p>The fitted EMOS coefficients.
</p>
</td></tr>
<tr><td><code>c</code>, <code>d</code></td>
<td>

<p>The fitted parameters for the squared scale, see details.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>T. L. Thorarinsdottir and T. Gneiting,
Probabilistic forecasts of wind speed: 
Ensemble model output statistics by using 
heteroscedastic censored regression.
<em>Journal of the Royal Statistical Society Series A</em> 
173:371&ndash;388, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+controlMOStruncnormal">controlMOStruncnormal</a></code>,
<code><a href="#topic+ensembleMOStruncnormal">ensembleMOStruncnormal</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("MAXWSP10","obs", sep = ".")
ens &lt;- paste("MAXWSP10", ensMemNames, sep = ".")
windTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")
                             
windTrain &lt;- trainingData(windTestData, trainingDays = 30,
                          date = "2008010100")

windTestFit &lt;- fitMOStruncnormal(windTrain)
</code></pre>

<hr>
<h2 id='pars'>
Forecast distribution parameters
</h2><span id='topic+pars'></span><span id='topic+pars.ensembleMOSnormal'></span><span id='topic+pars.ensembleMOStruncnormal'></span><span id='topic+pars.ensembleMOSlognormal'></span><span id='topic+pars.ensembleMOScsg0'></span><span id='topic+pars.ensembleMOSgev0'></span><span id='topic+pars.fitMOSnormal'></span><span id='topic+pars.fitMOStruncnormal'></span><span id='topic+pars.fitMOSlognormal'></span><span id='topic+pars.fitMOScsg0'></span><span id='topic+pars.fitMOSgev0'></span>

<h3>Description</h3>

<p>Computes the parameters of the forecast distribution
resulting for univariate ensemble forecasting models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  pars(fit, ensembleData, dates=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pars_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data, obtained using
<code><a href="#topic+fitMOS">fitMOS</a></code> or <br /> <code><a href="#topic+ensembleMOS">ensembleMOS</a></code>.
</p>
</td></tr>
<tr><td><code id="pars_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble forecasts,
verification observations and possibly dates.
Missing values (indicated by <code>NA</code>) are allowed.
This need not be the data used for the model <code>fit</code>,
although it must include the same ensemble members.
</p>
</td></tr>
<tr><td><code id="pars_+3A_dates">dates</code></td>
<td>

<p>The dates for which the parameters will be computed.
These dates must be consistent with <code>fit</code> and <code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
The dates are ignored if <code>fit</code> originates from <code>fitMOS</code>,
which also ignores date information.
</p>
</td></tr>
<tr><td><code id="pars_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These methods are generic, and can be applied to all ensemble
forecasting models. 
</p>


<h3>Value</h3>

<p><code>pars</code> is a matrix giving the distribution parameter values
for each instance in the data. The returned parameters denoted in
the column names depend on  the model used to generate the 
<code>fit</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOS">ensembleMOS</a></code>,
<code><a href="#topic+fitMOS">fitMOS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

tempTestFit &lt;- ensembleMOS(tempTestData, trainingDays = 25, 
                           dates = c("2008010100", "2008010200"),
                           model = "normal")

parValues &lt;- pars(tempTestFit, tempTestData)
parValues
</code></pre>

<hr>
<h2 id='quantileForecast'>
Quantile forecasts at observation locations
</h2><span id='topic+quantileForecast'></span><span id='topic+quantileForecast.ensembleMOSnormal'></span><span id='topic+quantileForecast.fitMOSnormal'></span><span id='topic+quantileForecast.ensembleMOStruncnormal'></span><span id='topic+quantileForecast.fitMOStruncnormal'></span><span id='topic+quantileForecast.ensembleMOSlognormal'></span><span id='topic+quantileForecast.fitMOSlognormal'></span><span id='topic+quantileForecast.ensembleMOScsg0'></span><span id='topic+quantileForecast.fitMOScsg0'></span><span id='topic+quantileForecast.ensembleMOSgev0'></span><span id='topic+quantileForecast.fitMOSgev0'></span>

<h3>Description</h3>

<p>Computes quantiles for the probability distribution function
(PDF) for ensemble forecasting models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantileForecast(fit, ensembleData, quantiles = 0.5, dates = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantileForecast_+3A_fit">fit</code></td>
<td>

<p>A model fit to ensemble forecasting data.
</p>
</td></tr>
<tr><td><code id="quantileForecast_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble
forecasts, verification observations and possibly dates.
Missing values (indicated by <code>NA</code>) are allowed. 
This need not be the data used for the model <code>fit</code>,
although it must include the same ensemble members.
</p>
</td></tr>
<tr><td><code id="quantileForecast_+3A_quantiles">quantiles</code></td>
<td>

<p>The vector of desired quantiles for the PDF of the EMOS model.
</p>
</td></tr>
<tr><td><code id="quantileForecast_+3A_dates">dates</code></td>
<td>

<p>The dates for which the quantile forecasts will be computed.
These dates must be consistent with <code>fit</code> and
<code>ensembleData</code>.
The default is to use all of the dates in <code>fit</code>.
If <code>ensembleData</code> does not include dates, they will
be inferred from <code>fit</code> and <code>dates</code>.
</p>
</td></tr>
<tr><td><code id="quantileForecast_+3A_...">...</code></td>
<td>

<p>Included for generic function compatibility.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is generic, and can be applied to any ensemble forecasting
model.  This can be used to compute prediction intervals for the PDF. 
</p>


<h3>Value</h3>

<p>A matrix of forecasts corresponding to the desired quantiles.
</p>


<h3>References</h3>

<p>T. Gneiting, A. E. Raftery, A. H. Westveld and T. Goldman,
Calibrated probabilistic forecasting using ensemble model output
statistics and minimum CRPS estimation.
<em>Monthly Weather Review</em> 133:1098&ndash;1118, 2005.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOS">ensembleMOS</a></code>,
<code><a href="#topic+fitMOS">fitMOS</a></code>,
<code><a href="#topic+cdf">cdf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

tempTestFit &lt;- ensembleMOS(tempTestData, trainingDays = 25, 
                           dates = c("2008010100", "2008010200"),
                           model = "normal")

tempTestForc &lt;- quantileForecast(tempTestFit, tempTestData)
</code></pre>

<hr>
<h2 id='trainingData'>
Extract Training Data
</h2><span id='topic+trainingData'></span>

<h3>Description</h3>

<p>Extracts a subset of an <code>ensembleData</code> object corresponding
to a given date and number of  training days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trainingData(ensembleData, trainingDays, consecutive = FALSE, date)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trainingData_+3A_ensembledata">ensembleData</code></td>
<td>

<p>An <code>ensembleData</code> object that includes ensemble
forecasts, observations and dates.
</p>
</td></tr>
<tr><td><code id="trainingData_+3A_trainingdays">trainingDays</code></td>
<td>

<p>An integer specifying the number of days in the training period.
</p>
</td></tr>
<tr><td><code id="trainingData_+3A_consecutive">consecutive</code></td>
<td>

<p>If <code>TRUE</code> then dates in training set are treated as consecutive,
i.e. date gaps are ignored.
</p>
</td></tr>
<tr><td><code id="trainingData_+3A_date">date</code></td>
<td>

<p>The date for which the training data is desired.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>ensembleData</code> object corresponding to the training data for
the given date relative to <br /> <code>ensembleData</code>.
</p>


<h3>References</h3>

<p>A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian model averaging to calibrate forecast ensembles,
<em>Monthly Weather Review</em> 133:1155-1174, 2005.
</p>
<p>J. M. Sloughter, A. E. Raftery, T. Gneiting and C. Fraley,
Probabilistic quantitative precipitation forecasting
using Bayesian model averaging,
<em>Monthly Weather Review</em> 135:3309&ndash;3320, 2007.
</p>
<p>C. Fraley, A. E. Raftery, T. Gneiting and J. M. Sloughter,
<code>ensembleBMA</code>: An <code>R</code> Package for Probabilistic Forecasting
using Ensembles and Bayesian Model Averaging,
Technical Report No. 516R, Department of Statistics, University of
Washington, December 2008. <br />
Available at: http://www.stat.washington.edu/research/reports/
</p>
<p>C. Fraley, A. E. Raftery and T. Gneiting,
Calibrating multi-model forecast ensembles with exchangeable and missing
members using Bayesian model averaging, <em>Monthly Weather Review</em>
138:190-202, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ensembleMOSnormal">ensembleMOSnormal</a></code>,
<code><a href="#topic+fitMOSnormal">fitMOSnormal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ensBMAtest", package = "ensembleBMA")

ensMemNames &lt;- c("gfs","cmcg","eta","gasp","jma","ngps","tcwb","ukmo")

obs &lt;- paste("T2", "obs", sep = ".")
ens &lt;- paste("T2", ensMemNames, sep = ".")
tempTestData &lt;- ensembleData(forecasts = ensBMAtest[,ens],
                             dates = ensBMAtest[,"vdate"],
                             observations = ensBMAtest[,obs],
                             station = ensBMAtest[,"station"],
                             forecastHour = 48,
                             initializationTime = "00")

tempTrain &lt;- trainingData(tempTestData, trainingDays = 30,
                             date = "2008010100")

tempTrainFit &lt;- fitMOSnormal(tempTrain)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
