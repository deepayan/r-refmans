<!DOCTYPE html><html><head><title>Help for package RSizeBiased</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RSizeBiased}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Cond.KL.Weib.Gamma'><p>Kullback-Leibler divergence between the (parametrized with respect to shape and mean or variance) of the Weibull or gamma distribution and its (assumed) maximum likelihood estimates.</p></a></li>
<li><a href='#d_rsize_Weibull'><p>Weibull size biased distribution of order <code class="reqn">r</code>.</p></a></li>
<li><a href='#log_Lik_Weib_gamma_weighted'><p>Log likelihood function for the weighted gamma or Weibull distributions.</p></a></li>
<li><a href='#p_rsize_Weibull'><p>Weibull size biased c.d.f. of order <code class="reqn">r</code>.</p></a></li>
<li><a href='#r_moment_gamma_Weib'><p><code class="reqn">r-</code>th moment of the gamma or the Weibull distribution.</p></a></li>
<li><a href='#r_rsize_Weibull'><p>Weibull size biased random number generation of order <code class="reqn">r</code> (modified).</p></a></li>
<li><a href='#s11.s22'><p>Variance estimates for test statistics <code class="reqn">\zeta_{n,r}^i, i=1,2</code> specifically for the Weibull and gamma distributions.</p></a></li>
<li><a href='#Size.BiasedMV.Tests'><p>Test statistics.</p></a></li>
<li><a href='#T1T2.Mean.Var'><p>Test statistic <code class="reqn">T_{n,r}^1</code> or <code class="reqn">T_{n,r}^2</code> depending on user input.</p></a></li>
<li><a href='#ufc'><p>Upper Flat Creek forest cruise tree data</p></a></li>
<li><a href='#zeta_plug_in'><p><code class="reqn">\zeta_{n,r}^i, i=1,2</code> test statistic for the Weibull or the gamma distribution (depending on user input.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hypothesis Testing Based on R-Size Biased Samples</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, pracma</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions and examples for testing hypothesis about the population mean and variance on samples drawn by r-size biased sampling schemes.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-24 12:14:23 UTC; Dimitris</td>
</tr>
<tr>
<td>Author:</td>
<td>Dimitrios Bagkavos [aut, cre],
  Polychronis Economou [aut],
  Apostolos Batsidis [aut],
  Gorgios Tzavelas [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-29 08:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Cond.KL.Weib.Gamma'>Kullback-Leibler divergence between the (parametrized with respect to shape and mean or variance) of the Weibull or gamma distribution and its (assumed) maximum likelihood estimates.</h2><span id='topic+Cond.KL.Weib.Gamma'></span>

<h3>Description</h3>

<p>The function returns the Kullback-Leibler divergence (minus a constant) between the (parametrized with respect to shape and mean or variance) underlying Weibull or gamma distribution and its (assumed) maximum likelihood estimates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cond.KL.Weib.Gamma(par,nullvalue,hata,hatb,type,dist)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Cond.KL.Weib.Gamma_+3A_par">par</code></td>
<td>
<p>The (actual) shape parameter <code class="reqn">\alpha</code> of the distribution.</p>
</td></tr>
<tr><td><code id="Cond.KL.Weib.Gamma_+3A_nullvalue">nullvalue</code></td>
<td>
<p>The (actual) distribution mean or variance.</p>
</td></tr>
<tr><td><code id="Cond.KL.Weib.Gamma_+3A_hata">hata</code></td>
<td>
<p>Maximum likelihood estimate of the shape parameter of the distribution.</p>
</td></tr>
<tr><td><code id="Cond.KL.Weib.Gamma_+3A_hatb">hatb</code></td>
<td>
<p>Maximum likelihood estimate of the scale parameter of the distribution.</p>
</td></tr>
<tr><td><code id="Cond.KL.Weib.Gamma_+3A_type">type</code></td>
<td>
<p>Numeric switch, enables the choice of mean or variance: type: 1 for mean, 2 (or any other value != 1) for variance.</p>
</td></tr>
<tr><td><code id="Cond.KL.Weib.Gamma_+3A_dist">dist</code></td>
<td>
<p> Character switch, enables the choice of distribution: type &quot;weib&quot; for the Weibull or &quot;gamma&quot; for the gamma distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Kullback-Leibler divergence between the Weibull(<code class="reqn">\alpha, \beta)</code> or the gamma(<code class="reqn">\alpha, \beta)</code> and its maximum likelihood estimate Gamma(<code class="reqn">\hat \alpha, \hat \beta)</code> is  given by
</p>
<p style="text-align: center;"><code class="reqn">
D_{KL} =  (\hat \alpha -1)\Psi(\hat \alpha) - \log\hat \beta - \hat \alpha - \log \Gamma(\hat \alpha) + \log\Gamma(  \alpha) + \alpha \log \beta - (\alpha -1)(\Psi(\hat \alpha)  + \log \hat \beta) + \frac{ \hat \beta \hat \alpha}{\lambda}.
</code>
</p>

<p>Since <code class="reqn">D_{KL}</code> is  used to determine the closest distribution - given its mean or variance - to the estimated gamma p.d.f., the first four terms are omitted from the function outcome, i.e. the function returns the result of the following quantity:
</p>
<p style="text-align: center;"><code class="reqn">
 \log\Gamma(  \alpha) + \alpha \log \beta - (\alpha -1)(\Psi(\hat \alpha)  + \log \hat \beta) + \frac{ \hat \beta \hat \alpha}{\lambda}.
</code>
</p>

<p>For the Weibull distribution the corresponding formulas are
</p>
<p style="text-align: center;"><code class="reqn">
D_{KL} =   \log \frac{\hat \alpha}{{\hat \beta}^{\hat \alpha}} - \log \frac{\alpha}{{\beta}^{\alpha}} + (\hat \alpha - \alpha) \left ( \log \hat \beta - \frac{\gamma}{\hat \alpha} \right ) + \left (\frac{\hat \beta}{\beta} \right )^\alpha \Gamma\left ( \frac{\alpha}{\hat \alpha} +1 \right ) -1
</code>
</p>

<p>and since <code class="reqn">D_{KL}</code> is  used to determine the closest distribution - given its mean or variance - to the estimated gamma p.d.f., the first   term is omitted from the function outcome, i.e. the function returns the result of the following quantity:
</p>
<p style="text-align: center;"><code class="reqn">
   - \log \frac{\alpha}{{\beta}^{\alpha}} + (\hat \alpha - \alpha) \left ( \log \hat \beta - \frac{\gamma}{\hat \alpha} \right ) + \left (\frac{\hat \beta}{\beta} \right )^\alpha \Gamma\left ( \frac{\alpha}{\hat \alpha} +1 \right ) -1
</code>
</p>



<h3>Value</h3>

<p>A scalar, the value of the Kullback-Leibler divergence (minus a constant).</p>


<h3>Author(s)</h3>

<p>Polychronis Economou
</p>
<p>R implementation and documentation: Polychronis Economou  &lt;peconom@upatras.gr&gt;
</p>


<h3>References</h3>

<p> Economou et. al. (2021). Hypothesis testing for the population mean and variance based on r-size biased samples, under review.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#K-L divergence for the Gamma distribution for shape=2
#and variance=3 and their assumed MLE=(1,1):
 Cond.KL.Weib.Gamma(2,3,1,1,2, "gamma")
#K-L divergence for the Weibull distribution for shape=2
#and variance=3 and their assumed MLE=(1,1):
 Cond.KL.Weib.Gamma(2,3,1,1,2, "weib")
</code></pre>

<hr>
<h2 id='d_rsize_Weibull'>Weibull size biased distribution of order <code class="reqn">r</code>.</h2><span id='topic+d_rsize_Weibull'></span>

<h3>Description</h3>

<p>Calculates the density of the <code class="reqn">r-</code>size biased Weibull distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_rsize_Weibull(x,TRpar,r) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_rsize_Weibull_+3A_x">x</code></td>
<td>
<p>Grid points where the functional is being calculated.</p>
</td></tr>
<tr><td><code id="d_rsize_Weibull_+3A_trpar">TRpar</code></td>
<td>
<p>A vector of length 2, containing the shape and scale parameters of the distribution.</p>
</td></tr>
<tr><td><code id="d_rsize_Weibull_+3A_r">r</code></td>
<td>
<p>The size (order) of the distribution. The special cases <code class="reqn">r=1,2,3</code> correspond to  length, area, volume biased samples respectively and are the most frequently encountered in practice. The case <code class="reqn">r=0</code> corresponds to random samples from the Weibull distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">r-</code>size density of the observed biased sample <code class="reqn">X_1, \dots, X_n</code> is defined  by
</p>
<p style="text-align: center;"><code class="reqn">f_r(x; \theta)=\frac{x^r f(x; \theta)}{E(X^r)}</code>
</p>

<p>where <code class="reqn">f(x; \theta)</code> is the density of the Weibull distribution and <code class="reqn">\theta</code> the vector of the shape and scale parameters of the distribution.
</p>


<h3>Value</h3>

<p>A vector of length equal to the length of <code class="reqn">x</code>.</p>


<h3>Author(s)</h3>

<p>Polychronis Economou
</p>
<p>R implementation and documentation: Polychronis Economou  &lt;peconom@upatras.gr&gt;
</p>


<h3>References</h3>

<p> Economou et. al. (2021). Hypothesis testing for the population mean and variance based on r-size biased samples, under review.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+p_rsize_Weibull">p_rsize_Weibull</a></code>, <code><a href="#topic+r_rsize_Weibull">r_rsize_Weibull</a></code>    </p>


<h3>Examples</h3>

<pre><code class='language-R'># example of r-size Weibull distribution, r=0,1,2
x&lt;- seq(0, 10, length=50)
dens.0.size&lt;-d_rsize_Weibull(x,c(2,3),0)
dens.1.size&lt;-d_rsize_Weibull(x,c(2,3),1)
dens.2.size&lt;-d_rsize_Weibull(x,c(2,3),2)
plot(x, dens.0.size, type="l", ylab="r-denisty")
lines(x, dens.1.size, col=2)
lines(x, dens.2.size, col=3)
legend("topright",legend=c("r= 0","r= 1","r= 2"),
       col=c("black","red","green"),lty=c(1,1,1))
</code></pre>

<hr>
<h2 id='log_Lik_Weib_gamma_weighted'>Log likelihood function for the weighted gamma or Weibull distributions.</h2><span id='topic+log_Lik_Weib_gamma_weighted'></span>

<h3>Description</h3>

<p>Calculates the log-likelihood function of the weighted gamma or Weibull (depends on user input)  distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_Lik_Weib_gamma_weighted(TRpar,datain,r,dist)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_Lik_Weib_gamma_weighted_+3A_trpar">TRpar</code></td>
<td>
<p>A vector of length 2, containing the shape and scale parameters of the distribution.</p>
</td></tr>
<tr><td><code id="log_Lik_Weib_gamma_weighted_+3A_datain">datain</code></td>
<td>
<p>The available sample points.</p>
</td></tr>
<tr><td><code id="log_Lik_Weib_gamma_weighted_+3A_r">r</code></td>
<td>
<p>The size (order) of the distribution. The special cases <code class="reqn">r=1,2,3</code> correspond to  length, area, volume biased samples respectively and are the most frequently encountered in practice. The case <code class="reqn">r=0</code> corresponds to random samples from the Gamma distribution.</p>
</td></tr>
<tr><td><code id="log_Lik_Weib_gamma_weighted_+3A_dist">dist</code></td>
<td>
<p>Character switch, enables the choice of distribution: type &quot;weib&quot; for the Weibull or &quot;gamma&quot; for the gamma distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The  log likelihood function of the weighted gamma  distribution is defined  by
</p>
<p style="text-align: center;"><code class="reqn"> \log L = \sum_{i=1}^n log f_r(X_i; \theta) </code>
</p>

<p>where <code class="reqn">f_r(x; \theta)</code> is the density of the <code class="reqn">r-</code>size biased gamma distribution. Setting <code class="reqn">r=0</code> corresponds to the log likelihood of the Gamma distribution.
</p>
<p>In the case of Weibull, the  log likelihood   is defined  by
</p>
<p style="text-align: center;"><code class="reqn"> \log L = \sum_{i=1}^n log f_r(X_i; \theta) </code>
</p>

<p>where <code class="reqn">f_r(x; \theta)</code> is the density of the <code class="reqn">r-</code>size biased Weibull distribution. Setting <code class="reqn">r=0</code> corresponds to the log likelihood of the Weibull distribution.
</p>


<h3>Value</h3>

<p>A scalar, the result of the log likelihood calculation.</p>


<h3>Author(s)</h3>

<p>Polychronis Economou
</p>
<p>R implementation and documentation: Polychronis Economou  &lt;peconom@upatras.gr&gt;
</p>


<h3>References</h3>

<p> Economou et. al. (2021). Hypothesis testing for the population mean and variance based on r-size biased samples, under review.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Log-likelihood for the gamma distribution for true parms=(2,3), r=0:
log_Lik_Weib_gamma_weighted(c(2,3), rgamma(100, shape=2, scale=3), 0, "gamma")
#Log-likelihood for the Weibull distribution for true parms=(2,3), r=0:
log_Lik_Weib_gamma_weighted(c(2,3), rweibull(100, shape=2, scale=3), 0, "weib")
</code></pre>

<hr>
<h2 id='p_rsize_Weibull'>Weibull size biased c.d.f. of order <code class="reqn">r</code>.</h2><span id='topic+p_rsize_Weibull'></span>

<h3>Description</h3>

<p>Calculates the cumulative distribution of the <code class="reqn">r-</code>size biased Weibull distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>p_rsize_Weibull(q,TRpar,r) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_rsize_Weibull_+3A_q">q</code></td>
<td>
<p>Points where the functional is being calculated.</p>
</td></tr>
<tr><td><code id="p_rsize_Weibull_+3A_trpar">TRpar</code></td>
<td>
<p>A vector of length 2, containing the shape and scale parameters of the distribution.</p>
</td></tr>
<tr><td><code id="p_rsize_Weibull_+3A_r">r</code></td>
<td>
<p>The size (order) of the distribution. The special cases <code class="reqn">r=1,2,3</code> correspond to  length, area, volume biased samples respectively and are the most frequently encountered in practice. The case <code class="reqn">r=0</code> corresponds to random samples from the Weibull distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">r-</code>size c.d.f. of the Weibull density is defined  by
</p>
<p style="text-align: center;"><code class="reqn">F_r(y; \theta)=\int_{0}^{y} \frac{x^r f(x; \theta)}{E(X^r)} \,dx</code>
</p>

<p>where <code class="reqn">\theta</code> is a bivariate vector with the the shape and scale of the Weibull distribution.
</p>


<h3>Value</h3>

<p>A vector of length equal to the lemgth of <code class="reqn">x</code>.</p>


<h3>Author(s)</h3>

<p>Polychronis Economou
</p>
<p>R implementation and documentation: Polychronis Economou  &lt;peconom@upatras.gr&gt;
</p>


<h3>References</h3>

<p> Economou et. al. (2021). Hypothesis testing for the population mean and variance based on r-size biased samples, under review.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+d_rsize_Weibull">d_rsize_Weibull</a></code>, <code><a href="#topic+r_rsize_Weibull">r_rsize_Weibull</a></code>    </p>


<h3>Examples</h3>

<pre><code class='language-R'># c.d.f of the r-size Weibull distribution, r=0,1,2 evalutated at a specific point x.
x&lt;- 2
dist.0.size&lt;-p_rsize_Weibull(x,c(2,3),0)
dist.1.size&lt;-p_rsize_Weibull(x,c(2,3),1)
dist.2.size&lt;-p_rsize_Weibull(x,c(2,3),2)
</code></pre>

<hr>
<h2 id='r_moment_gamma_Weib'><code class="reqn">r-</code>th moment of the gamma or the Weibull distribution.</h2><span id='topic+r_moment_gamma_Weib'></span>

<h3>Description</h3>

<p>Calculates the <code class="reqn">r-</code>th moment of the gamma or Weibull distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>r_moment_gamma_Weib(TRpar,r,dist)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r_moment_gamma_Weib_+3A_trpar">TRpar</code></td>
<td>
<p>A vector of length 2, containing the shape and scale parameters of the distribution.</p>
</td></tr>
<tr><td><code id="r_moment_gamma_Weib_+3A_r">r</code></td>
<td>
<p>The size (order) of the distribution. The special cases <code class="reqn">r=1,2,3</code> correspond to  length, area, volume biased samples respectively and are the most frequently encountered in practice. The case <code class="reqn">r=0</code> corresponds to random samples from the Gamma distribution.</p>
</td></tr>
<tr><td><code id="r_moment_gamma_Weib_+3A_dist">dist</code></td>
<td>
<p> Character switch, enables the choice of distribution: type &quot;weib&quot; for the Weibull or &quot;gamma&quot; for the gamma distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the case of the <code class="reqn">\Gamma(\alpha, \beta)</code> distribution the <code class="reqn">r</code>-th moment is given by
</p>
<p style="text-align: center;"><code class="reqn">\mu_r = \int_0^{\infty} x^r f(x;\alpha, \beta)\,dx =\beta^r \frac{\Gamma(\alpha+r)}{\Gamma(\alpha)},  \alpha&gt; -r </code>
</p>

<p>while for the <code class="reqn">W(\alpha, \beta)</code> distribution the <code class="reqn">r</code>-th moment is given by
</p>
<p style="text-align: center;"><code class="reqn">\mu_r = \int_0^{\infty} x^r f(x;\alpha, \beta)\,dx = \beta^r \Gamma\left(1+\frac{\alpha}{r}\right), \alpha&gt; -r </code>
</p>



<h3>Value</h3>

<p>A scalar, the value of the moment.</p>


<h3>Author(s)</h3>

<p>Polychronis Economou
</p>
<p>R implementation and documentation: Polychronis Economou  &lt;peconom@upatras.gr&gt;
</p>


<h3>References</h3>

<p> Economou et. al. (2021). Hypothesis testing for the population mean and variance based on r-size biased samples, under review.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#r-moment for the Gamma distribution for true parms=(2,3), r=1:
r_moment_gamma_Weib(c(2,3),1, "gamma")
#r-moment for for the Weibull distribution for true parms=(2,3), r=1:
r_moment_gamma_Weib(c(2,3),1, "weib")
</code></pre>

<hr>
<h2 id='r_rsize_Weibull'>Weibull size biased random number generation of order <code class="reqn">r</code> (modified).</h2><span id='topic+r_rsize_Weibull'></span>

<h3>Description</h3>

<p>Provides a random sample of size <code class="reqn">n</code> from the <code class="reqn">r-</code>size biased Weibull distribution (modified).</p>


<h3>Usage</h3>

<pre><code class='language-R'>r_rsize_Weibull(n,TRpar,r) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r_rsize_Weibull_+3A_n">n</code></td>
<td>
<p>Number of th sample data points to be provided.</p>
</td></tr>
<tr><td><code id="r_rsize_Weibull_+3A_trpar">TRpar</code></td>
<td>
<p>A vector of length 2, containing the shape and scale parameters of the distribution.</p>
</td></tr>
<tr><td><code id="r_rsize_Weibull_+3A_r">r</code></td>
<td>
<p>The size (order) of the distribution. The special cases <code class="reqn">r=1,2,3</code> correspond to  length, area, volume biased samples respectively and are the most frequently encountered in practice. The case <code class="reqn">r=0</code> corresponds to random samples from the Weibull distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">r-</code>size random number generator from the Weibull distribution is implemented based on a change-of-variable technique, to the standard gamma distribution as described by Gove and Patil (1998).
</p>


<h3>Value</h3>

<p>A vector of length <code class="reqn">n</code> with the random sample.</p>


<h3>Author(s)</h3>

<p>Polychronis Economou
</p>
<p>R implementation and documentation: Polychronis Economou  &lt;peconom@upatras.gr&gt;
</p>


<h3>References</h3>

<p>Gove J.H. and Patil G.P. (1998). Modeling the Basal Area-size Distribution of Forest Stands: A Compatible
Approach. Forest Science, 44(2), 285-297.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+d_rsize_Weibull">d_rsize_Weibull</a></code>, <code><a href="#topic+p_rsize_Weibull">p_rsize_Weibull</a></code>    </p>


<h3>Examples</h3>

<pre><code class='language-R'>#Random number geenration for the r-size Weibull distribution.
r_rsize_Weibull(100,c(2,3),1)
</code></pre>

<hr>
<h2 id='s11.s22'>Variance estimates for test statistics <code class="reqn">\zeta_{n,r}^i, i=1,2</code> specifically for the Weibull and gamma distributions.</h2><span id='topic+s11.s22'></span>

<h3>Description</h3>

<p>Variance estimates for test statistics <code class="reqn">\zeta_{n,r}^i, i=1,2</code> specifically for the Weibull and gamma distributions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>s11.s22(TRpar,r,sgg,dist)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s11.s22_+3A_trpar">TRpar</code></td>
<td>
<p>A vector of length 2, containing the shape and scale parameters of the Weibull distribution.</p>
</td></tr>
<tr><td><code id="s11.s22_+3A_r">r</code></td>
<td>
<p>The size (order) of the distribution. The special cases <code class="reqn">r=1,2,3</code> correspond to  length, area, volume biased samples respectively and are the most frequently encountered in practice. The case <code class="reqn">r=0</code> corresponds to random samples from the underlying distribution.</p>
</td></tr>
<tr><td><code id="s11.s22_+3A_sgg">sgg</code></td>
<td>
<p> Character switch (&quot;s11&quot; or &quot;s22&quot;), enables choosing between the s11 and s22 options</p>
</td></tr>
<tr><td><code id="s11.s22_+3A_dist">dist</code></td>
<td>
<p>Character switch, enables the choice of distribution: type &quot;weib&quot; for the Weibull or &quot;gamma&quot; for the gamma distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provided that <code class="reqn">\mu_r, r=1, 2, \dots </code> is the <code class="reqn">r</code>th moment of the Weibull or the Gamma distribution, then
</p>
<p style="text-align: center;"><code class="reqn"> \sigma_{1,r}^2 = \mu_r (\mu_{2-r}) - 2 \mu_1 \mu_{1-r} + \mu_1^2 \mu_{-r}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn"> \sigma_{2,r}^2 = -4\mu_r \bigl ( 2\mu_{1}^2 - \mu_2) - 2) \mu_1 \mu_{1-r} +  (2\mu_1^2 - \mu_{2})^2
  +  (8\mu_1^2 - 2\mu_{2}) \mu_{2-r} - 4 \mu_1 \mu_{3-r} + \mu_{4-r}  \bigr ) </code>
</p>



<h3>Value</h3>

<p>A scalar with the value of the variance estimate for the test statistic.</p>


<h3>Author(s)</h3>

<p>Polychronis Economou
</p>
<p>R implementation and documentation: Polychronis Economou  &lt;peconom@upatras.gr&gt;
</p>


<h3>References</h3>

<p> Economou et. al. (2021). Hypothesis testing for the population mean and variance based on r-size biased samples, under review.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+zeta_plug_in">zeta_plug_in</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>#s11 for the Gamma distribution for true parms=(2,3), r=1:
s11.s22(c(2,3),1, "s11", "gamma")
#s22 for for the Weibull distribution for true parms=(2,3), r=1:
s11.s22(c(2,3),1, "s22",  "weib")
</code></pre>

<hr>
<h2 id='Size.BiasedMV.Tests'>Test statistics.</h2><span id='topic+Size.BiasedMV.Tests'></span>

<h3>Description</h3>

<p>The function returns the test statistics for testing a null hypothesis for the mean and a null hypothesis for the varaince.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Size.BiasedMV.Tests(datain_r,r,nullMEAN,nullVAR,start_par,nboot,alpha,prior_sel,distr)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Size.BiasedMV.Tests_+3A_datain_r">datain_r</code></td>
<td>
<p>The available sample points.</p>
</td></tr>
<tr><td><code id="Size.BiasedMV.Tests_+3A_r">r</code></td>
<td>
<p>The size (order) of the distribution. The special cases <code class="reqn">r=1,2,3</code> correspond to  length, area, volume biased samples respectively and are the most frequently encountered in practice. The case <code class="reqn">r=0</code> corresponds to random samples from the gamma or theWeibull distribution.</p>
</td></tr>
<tr><td><code id="Size.BiasedMV.Tests_+3A_nullmean">nullMEAN</code></td>
<td>
<p>The null value of the distribution mean.</p>
</td></tr>
<tr><td><code id="Size.BiasedMV.Tests_+3A_nullvar">nullVAR</code></td>
<td>
<p>The null value of the distribution variance.</p>
</td></tr>
<tr><td><code id="Size.BiasedMV.Tests_+3A_start_par">start_par</code></td>
<td>
<p>Vector with two values, containing the starting values for the MLE for the two parameter distribution (Weibull or gamma) .</p>
</td></tr>
<tr><td><code id="Size.BiasedMV.Tests_+3A_nboot">nboot</code></td>
<td>
<p>Defines the  number of bootstrap replications.</p>
</td></tr>
<tr><td><code id="Size.BiasedMV.Tests_+3A_alpha">alpha</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="Size.BiasedMV.Tests_+3A_prior_sel">prior_sel</code></td>
<td>
<p>&quot;normal&quot; for the normal distribution or &quot;gamma&quot; for the gamma.</p>
</td></tr>
<tr><td><code id="Size.BiasedMV.Tests_+3A_distr">distr</code></td>
<td>
<p> Character switch, enables the choice of distribution: type &quot;weib&quot; for the Weibull or &quot;gamma&quot; for the gamma distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistics implemented are given by the Plug-in and the bootstrap Methods as described in section 3.1 and 3.2 of Economou et al (2021).
</p>


<h3>Value</h3>

<p>An object containing the following components.
</p>
<table>
<tr><td><code>par</code></td>
<td>
<p>A vector of the MLE of the distribution parameters.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>A scalar, the maximized log-likelihood.</p>
</td></tr>
<tr><td><code>CovMatrix</code></td>
<td>
<p>The Variance - Covariance matrix of the MLEs.</p>
</td></tr>
<tr><td><code>Zeta_i</code></td>
<td>
<p>A vector of the values of the <code class="reqn">\zeta_{n,r}^i, i=1,2</code> test statistics (if defined)</p>
</td></tr>
<tr><td><code>Tivalues</code></td>
<td>
<p>A vector of the values of the <code class="reqn">T^i_{n,r}, i=1,2</code> test statistics</p>
</td></tr>
<tr><td><code>T1_bootstrap_quan</code></td>
<td>
<p>A vector of the bootstrap quantiles for the <code class="reqn">T^1_{n,r}</code> test statistic for each one of the significance levels alpha.</p>
</td></tr>
<tr><td><code>T2_bootstrap_quan</code></td>
<td>
<p>A vector of the bootstrap quantiles for the <code class="reqn">T^2_{n,r}</code> test statistic for each one of the significance levels alpha.</p>
</td></tr>
<tr><td><code>NullValues</code></td>
<td>
<p>A vector of the null values of the distribution mean and variance.</p>
</td></tr>
<tr><td><code>distribution</code></td>
<td>
<p>Character representing the choice of distribution: &quot;weib&quot; for the Weibull or &quot;gamma&quot; for the gamma distribution.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>A vector of significance levels for the test level.</p>
</td></tr>
<tr><td><code>bootstrap_p_mean</code></td>
<td>
<p>A scalar with the bootstrap p-value for testing the mean.</p>
</td></tr>
<tr><td><code>bootstrap_p_var</code></td>
<td>
<p>A scalar with the bootstrap p-value for testing the variance.</p>
</td></tr>
<tr><td><code>decision</code></td>
<td>
<p>A matrix of 0 and 1 of the decisions taken for each one of the significance levels alpha based on the bootstrap method. The first row corresponds to the null hypothesis for the mean and the second to the null hypothesis for the variance.</p>
</td></tr>
<tr><td><code>asymptotic_p_mean</code></td>
<td>
<p>A scalar with the asymptotic p-value for testing the mean (if <code class="reqn">\zeta_{n,r}^1</code> is defined).</p>
</td></tr>
<tr><td><code>asymptotic_p_var</code></td>
<td>
<p>A scalar with the asymptotic p-value for testing the variance (if <code class="reqn">\zeta_{n,r}^2</code> is defined).</p>
</td></tr>
<tr><td><code>decisionasympt</code></td>
<td>
<p>A matrix of 0 and 1 of the decisions taken for each one of the significance levels alpha based on the plug-in method and the asymptotic distribution of the test statistics. The first row corresponds to the null hypothesis for the mean and the second to the null hypothesis for the variance.</p>
</td></tr>
<tr><td><code>prior_selection</code></td>
<td>
<p>Character representing the choice of the prior distribution for the bootstrap method: &quot;normal&quot; for the normal distribution or &quot;gamma&quot; for the gamma.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Polychronis Economou
</p>
<p>R implementation and documentation: Polychronis Economou  &lt;peconom@upatras.gr&gt;
</p>


<h3>References</h3>

<p>Economou et. al. (2021). Hypothesis testing for the population mean and variance based on r-size biased samples, under review.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ufc)
datain_r &lt;- ufc[,4]
nullMEAN &lt;- 14 #according to null mean in Sec. 6.3,  Economou et. al. (2021).
nullVAR &lt;- 180 #according to null variance in Sec. 6.3,  Economou et. al. (2021).
Size.BiasedMV.Tests(datain_r, 2, nullMEAN, nullVAR,  c(2,3), 100, 0.05, "normal", "gamma")
</code></pre>

<hr>
<h2 id='T1T2.Mean.Var'>Test statistic <code class="reqn">T_{n,r}^1</code> or <code class="reqn">T_{n,r}^2</code> depending on user input.</h2><span id='topic+T1T2.Mean.Var'></span>

<h3>Description</h3>

<p>The test statistics <code class="reqn">T_{n,r}^1</code> and <code class="reqn">T_{n,r}^2</code>  are consistent estimators of the mean value <code class="reqn">\mathrm{E}(X)</code> and variance   <code class="reqn">\mathrm{Var}(X)</code> respectively given an <code class="reqn">r-</code>size biased sample.</p>


<h3>Usage</h3>

<pre><code class='language-R'>T1T2.Mean.Var(datain,r, type) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="T1T2.Mean.Var_+3A_datain">datain</code></td>
<td>
<p>The available sample points.</p>
</td></tr>
<tr><td><code id="T1T2.Mean.Var_+3A_r">r</code></td>
<td>
<p>The size (order) of the distribution. The special cases <code class="reqn">r=1,2,3</code> correspond to  length, area, volume biased samples respectively and are the most frequently encountered in practice. The case <code class="reqn">r=0</code> corresponds to random samples from the underlying distribution.</p>
</td></tr>
<tr><td><code id="T1T2.Mean.Var_+3A_type">type</code></td>
<td>
<p>Numeric switch: type =1 corresponds to the T1 statistic while any other numeric value will cause calculation of T2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The test statistic <code class="reqn">T_{n,r}^1</code> is defined by
</p>
<p style="text-align: center;"><code class="reqn"> T_{n,r}^{1}=\frac{\sum_{i=1}^n X_i^{1-r}}{\sum_{i=1}^n X_i^{-r}}.</code>
</p>

<p>The test statistic <code class="reqn">T_{n,r}^2</code> is defined by
</p>
<p style="text-align: center;"><code class="reqn"> T_{n,r}^{2}= \frac{\sum_{i=1}^n X_i^{2-r}}{\sum_{i=1}^nX_i^{-r}}-{\left(\frac{\sum_{i=1}^n X_i^{1-r}}{\sum_{i=1}^n X_i^{-r}}\right)^2}.</code>
</p>



<h3>Value</h3>

<p>A scalar, the value of the test statistic for the given sample.</p>


<h3>Author(s)</h3>

<p>Polychronis Economou
</p>
<p>R implementation and documentation: Polychronis Economou  &lt;peconom@upatras.gr&gt;
</p>


<h3>References</h3>

<p> Economou et. al. (2021). Hypothesis testing for the population mean and variance based on r-size biased samples, under review.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#e.g.:
T1T2.Mean.Var(rgamma(100, 2,3),0, 1)
</code></pre>

<hr>
<h2 id='ufc'>Upper Flat Creek forest cruise tree data</h2><span id='topic+ufc'></span>

<h3>Description</h3>

<p>Forest measurement data from the Upper Flat Creek unit of the University of Idaho Experimental Forest, measured in 1991.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ufc </code></pre>


<h3>Format</h3>

<p>A data frame with 336 observations on the following 5 variables;  plot (plot label), tree (tree label),   species (species kbd with levels DF, GF, WC, WL),   dbh.cm (tree diameter at 1.37 m. from the ground, measured in centimetres.), height.m  (tree height measured in metres).
</p>


<h3>Details</h3>

<p>The inventory was based on variable radius plots with 6.43 sq. m. per ha. BAF (Basal Area Factor). The forest stand was 121.5 ha. This version of the data omits errors, trees with missing heights, and uncommon species. The four species are Douglas-fir, grand fir, western red cedar, and western larch.
</p>


<h3>Source</h3>

<p>Harold Osborne and Ross Appelgren of the University of Idaho Experimental Forest.
</p>


<h3>References</h3>

<p><a href="https://www.springer.com/gp/book/9781441977618">Robinson, A.P., and J.D. Hamann. 2010. Forest Analytics with R: an Introduction. Springer.</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(ufc)
  </code></pre>

<hr>
<h2 id='zeta_plug_in'><code class="reqn">\zeta_{n,r}^i, i=1,2</code> test statistic for the Weibull or the gamma distribution (depending on user input.</h2><span id='topic+zeta_plug_in'></span>

<h3>Description</h3>

<p>Studentized version of the <code class="reqn">T^i_{n,r}, i=1,2</code> test statistic for the Weibull/gamma distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>zeta_plug_in(null_value, datain,r,EST_par,type, dist)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zeta_plug_in_+3A_null_value">null_value</code></td>
<td>
<p>The parameter value in the hypothesis test under the null</p>
</td></tr>
<tr><td><code id="zeta_plug_in_+3A_datain">datain</code></td>
<td>
<p>The available sample points.</p>
</td></tr>
<tr><td><code id="zeta_plug_in_+3A_r">r</code></td>
<td>
<p>The size (order) of the distribution. The special cases <code class="reqn">r=1,2,3</code> correspond to  length, area, volume biased samples respectively and are the most frequently encountered in practice. The case <code class="reqn">r=0</code> corresponds to random samples from the underlying distribution.</p>
</td></tr>
<tr><td><code id="zeta_plug_in_+3A_est_par">EST_par</code></td>
<td>
<p>A vector of length 2, containing the shape and scale parameters of the Weibull distribution.</p>
</td></tr>
<tr><td><code id="zeta_plug_in_+3A_type">type</code></td>
<td>
<p>Numeric switch: type =1 returns the <code class="reqn">\zeta_{n,r}^1</code> test statistic, any other value returns <code class="reqn">\zeta_{n,r}^2</code></p>
</td></tr>
<tr><td><code id="zeta_plug_in_+3A_dist">dist</code></td>
<td>
<p> Character switch, enables the choice of distribution: type &quot;weib&quot; for the Weibull or &quot;gamma&quot; for the gamma distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>type</code>=1  the function returns
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{n} \frac{T_{n,r^1} - \mu^0}{ \sigma_{1,r}(\hat \theta_n)} \rightarrow N(0,1)</code>
</p>

<p>after using the fact that under the null we have <code class="reqn">\mu_1=\mu^0</code>. Any other value for <code>type</code> returns
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{n} \frac{T_{n,r^2} - \sigma_0^2}{ \sigma_{2,r}(\hat \theta_n)} \rightarrow N(0,1)</code>
</p>

<p>in which case the fact that var(X)<code class="reqn">=\sigma_0^2</code> under the null has been used.
</p>


<h3>Value</h3>

<p>A scalar with the value of the test statistic.</p>


<h3>Author(s)</h3>

<p>Polychronis Economou
</p>
<p>R implementation and documentation: Polychronis Economou  &lt;peconom@upatras.gr&gt;
</p>


<h3>References</h3>

<p> Economou et. al. (2021). Hypothesis testing for the population mean and variance based on r-size biased samples, under review.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ufc)
datain_r &lt;- ufc[,4]
nullMEAN &lt;- 14
# ml estimates = c(2.6555,8.0376),  taken from section 6.2 in Economou et. al. (2021).
zeta_plug_in(nullMEAN, datain_r, 2, c(2.6555,8.0376),1, "gamma") #corresponds to mean

nullVar &lt;- 180
zeta_plug_in(nullVar, datain_r, 2, c(2.6555,8.0376),2, "gamma") #corresponds to var

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
