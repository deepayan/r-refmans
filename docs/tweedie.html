<!DOCTYPE html><html><head><title>Help for package tweedie</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tweedie}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AICtweedie'><p>Tweedie Distributions</p></a></li>
<li><a href='#dtweedie.dldphi'><p>Tweedie Distributions</p></a></li>
<li><a href='#dtweedie.saddle'><p>Tweedie Distributions (saddlepoint approximation)</p></a></li>
<li><a href='#logLiktweedie'><p>Tweedie Distributions</p></a></li>
<li><a href='#Tweedie'><p>Tweedie Distributions</p></a></li>
<li><a href='#Tweedie internals'><p>Tweedie internal function</p></a></li>
<li><a href='#tweedie-package'>
<p>Tweedie Distributions</p></a></li>
<li><a href='#tweedie.convert'><p>Convert Tweedie parameters</p></a></li>
<li><a href='#tweedie.dev'><p>Tweedie Distributions: the deviance function</p></a></li>
<li><a href='#tweedie.plot'><p>Tweedie Distributions: plotting</p></a></li>
<li><a href='#tweedie.profile'><p>Tweedie Distributions: mle estimation of p</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.3.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-08-17</td>
</tr>
<tr>
<td>Title:</td>
<td>Evaluation of Tweedie Exponential Family Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter K. Dunn [cre, aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter K. Dunn &lt;pdunn2@usc.edu.au&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.8.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>stabledist, statmod(&ge; 1.4.20)</td>
</tr>
<tr>
<td>Description:</td>
<td>Maximum likelihood computations for Tweedie families, including the series expansion (Dunn and Smyth, 2005; &lt;<a href="https://doi.org/10.1007%2Fs11222-005-4070-y">doi:10.1007/s11222-005-4070-y</a>&gt;) and the Fourier inversion  (Dunn and Smyth, 2008; &lt;<a href="https://doi.org/10.1007%2Fs11222-007-9039-6">doi:10.1007/s11222-007-9039-6</a>&gt;), and related methods.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-17 01:02:19 UTC; pdunn2</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-17 07:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AICtweedie'>Tweedie Distributions</h2><span id='topic+AICtweedie'></span>

<h3>Description</h3>

<p>The AIC for Tweedie glms</p>


<h3>Usage</h3>

<pre><code class='language-R'>	AICtweedie( glm.obj, dispersion=NULL, k = 2, verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AICtweedie_+3A_glm.obj">glm.obj</code></td>
<td>
<p>a fitted Tweedie <code>glm</code> object</p>
</td></tr>
<tr><td><code id="AICtweedie_+3A_dispersion">dispersion</code></td>
<td>
<p>the dispersion parameter <code class="reqn">\phi</code>; the default is <code>NULL</code> which means to use an estimate</p>
</td></tr>
<tr><td><code id="AICtweedie_+3A_k">k</code></td>
<td>
<p>numeric: the penalty per parameter to be used; the default is <code class="reqn">k=2</code></p>
</td></tr>
<tr><td><code id="AICtweedie_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code> (the default), a warning message is produced about the Poisson case; see the second Note below</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="stats.html#topic+AIC">AIC</a></code> for more details on the <abbr><span class="acronym">AIC</span></abbr>;
see <code><a href="#topic+dtweedie">dtweedie</a></code> for more details on computing the Tweedie densities
</p>


<h3>Value</h3>

<p>Returns a numeric value with the
corresponding <abbr><span class="acronym">AIC</span></abbr> (or <abbr><span class="acronym">BIC</span></abbr>, depending on <code class="reqn">k</code>)
</p>


<h3>Note</h3>

<p>Computing the <abbr><span class="acronym">AIC</span></abbr> may take a long time.
</p>


<h3>Note</h3>

<p>Tweedie distributions with the index parameter as 1
correspond to Poisson distributions when <code class="reqn">\phi = 1</code>.
However,
in general a Tweedie distribution with an index parameter equal to one
may not be referring to a Poisson distribution with <code class="reqn">\phi=1</code>,
so we cannot assume that <code class="reqn">\phi=1</code> just because the index parameter is set to one.
If the Poisson distribution is intended,
then <code>dispersion=1</code> should be specified.
The same argument applies for similar situations.
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73&ndash;86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267&ndash;280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Jorgensen, B. (1997).
<em>Theory of Dispersion Models</em>.
Chapman and Hall, London.
</p>
<p>Sakamoto, Y., Ishiguro, M., and Kitagawa G. (1986). 
<em>Akaike Information Criterion Statistics</em>. 
D. Reidel Publishing Company.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+AIC">AIC</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(statmod) # Needed to use  tweedie  family object

### Generate some fictitious data
test.data &lt;- rgamma(n=200, scale=1, shape=1)

### Fit a Tweedie glm and find the AIC
m1 &lt;- glm( test.data~1, family=tweedie(link.power=0, var.power=2) )

### A Tweedie glm with p=2 is equivalent to a gamma glm:
m2 &lt;- glm( test.data~1, family=Gamma(link=log))

### The models are equivalent, so the AIC shoud be the same:
AICtweedie(m1)
AIC(m2)

</code></pre>

<hr>
<h2 id='dtweedie.dldphi'>Tweedie Distributions</h2><span id='topic+dtweedie.dldphi'></span><span id='topic+dtweedie.dldphi.saddle'></span>

<h3>Description</h3>

<p>Derivatives of the log-likelihood with respect to <code class="reqn">\phi</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>dtweedie.dldphi(phi, mu, power, y )
dtweedie.dldphi.saddle(phi, mu, power, y )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dtweedie.dldphi_+3A_y">y</code></td>
<td>
<p>vector of quantiles</p>
</td></tr>
<tr><td><code id="dtweedie.dldphi_+3A_mu">mu</code></td>
<td>
<p>the mean</p>
</td></tr>
<tr><td><code id="dtweedie.dldphi_+3A_phi">phi</code></td>
<td>
<p>the dispersion</p>
</td></tr>
<tr><td><code id="dtweedie.dldphi_+3A_power">power</code></td>
<td>
<p>the value of <code class="reqn">p</code> such that the variance is 
<code class="reqn">\mbox{var}[Y]=\phi\mu^p</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Tweedie family of distributions belong to the class
of exponential dispersion models (<abbr><span class="acronym">EDM</span></abbr>s),
famous for their role in generalized linear models.
The Tweedie distributions are the <abbr><span class="acronym">EDM</span></abbr>s with a variance of the form
<code class="reqn">\mbox{var}[Y]=\phi\mu^p</code>
where <code class="reqn">p</code> is greater than or equal to one, or less than or equal to zero.
<b>This function only evaluates for <code class="reqn">p</code>
greater than or equal to one.</b>
Special cases include the 
normal (<code class="reqn">p=0</code>),
Poisson (<code class="reqn">p=1</code> with <code class="reqn">\phi=1</code>),
gamma (<code class="reqn">p=2</code>)
and
inverse Gaussian (<code class="reqn">p=3</code>)
distributions.
For other values of  <code>power</code>,
the distributions are still defined but cannot be written in closed form,
and hence evaluation is very difficult.
</p>


<h3>Value</h3>

<p>the value of the derivative 
<code class="reqn">\partial\ell/\partial\phi</code>
where <code class="reqn">\ell</code> is the log-likelihood for the specified
Tweedie distribution.
<code>dtweedie.dldphi.saddle</code>
uses the saddlepoint approximation to determine the derivative;
<code>dtweedie.dldphi</code>
uses an infinite series expansion.
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73&ndash;86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267&ndash;280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2001).
Tweedie family densities: methods of evaluation.
<em>Proceedings of the 16th International Workshop on Statistical Modelling</em>,
Odense, Denmark, 2&ndash;6 July
</p>
<p>Jorgensen, B. (1987).
Exponential dispersion models.
<em>Journal of the Royal Statistical Society</em>, B,
<b>49</b>, 127&ndash;162.
</p>
<p>Jorgensen, B. (1997).
<em>Theory of Dispersion Models</em>.
Chapman and Hall, London.
</p>
<p>Sidi, Avram (1982).
The numerical evaluation of very oscillatory infinite integrals by
extrapolation.
<em>Mathematics of Computation</em>
<b>38</b>(158), 517&ndash;529.
doi: <a href="https://doi.org/10.1090/S0025-5718-1982-0645667-5">10.1090/S0025-5718-1982-0645667-5</a>
</p>
<p>Sidi, Avram (1988).  
A user-friendly extrapolation method for
oscillatory infinite integrals.
<em>Mathematics of Computation</em>
<b>51</b>(183), 249&ndash;266.
doi: <a href="https://doi.org/10.1090/S0025-5718-1988-0942153-5">10.1090/S0025-5718-1988-0942153-5</a>
</p>
<p>Tweedie, M. C. K. (1984).
An index which distinguishes between some important exponential families.
<em>Statistics: Applications and New Directions.
Proceedings of the Indian Statistical Institute Golden Jubilee International Conference</em>
(Eds. J. K. Ghosh and J. Roy), pp. 579-604. Calcutta: Indian Statistical Institute.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dtweedie.saddle">dtweedie.saddle</a></code>, 
<code><a href="#topic+dtweedie">dtweedie</a></code>,
<code><a href="#topic+tweedie.profile">tweedie.profile</a></code>, 
<code><a href="statmod.html#topic+tweedie">tweedie</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Plot dl/dphi against candidate values of phi
power &lt;- 2
mu &lt;- 1 
phi &lt;- seq(2, 8, by=0.1)

set.seed(10000) # For reproducability
y &lt;- rtweedie( 100, mu=mu, power=power, phi=3)
   # So we expect the maximum to occur at  phi=3

dldphi &lt;- dldphi.saddle &lt;- array( dim=length(phi))

for (i in (1:length(phi))) {
   dldphi[i] &lt;- dtweedie.dldphi( y=y, power=power, mu=mu, phi=phi[i]) 
   dldphi.saddle[i] &lt;- dtweedie.dldphi.saddle( y=y, power=power, mu=mu, phi=phi[i]) 
}

plot( dldphi ~ phi, lwd=2, type="l",
   ylab=expression(phi), xlab=expression(paste("dl / d",phi) ) )
lines( dldphi.saddle ~ phi, lwd=2, col=2, lty=2)
legend( "bottomright", lwd=c(2,2), lty=c(1,2), col=c(1,2),
   legend=c("'Exact' (using series)","Saddlepoint") )

# Neither are very good in this case!
   
</code></pre>

<hr>
<h2 id='dtweedie.saddle'>Tweedie Distributions (saddlepoint approximation)</h2><span id='topic+dtweedie.saddle'></span>

<h3>Description</h3>

<p>Saddlepoint density for the Tweedie distributions</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtweedie.saddle(y, xi=NULL, mu, phi, eps=1/6, power=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dtweedie.saddle_+3A_y">y</code></td>
<td>
<p>the vector of responses</p>
</td></tr>
<tr><td><code id="dtweedie.saddle_+3A_xi">xi</code></td>
<td>
<p>the value of <code class="reqn">\xi</code> such that the variance is 
<code class="reqn">\mbox{var}[Y]=\phi\mu^{\xi}</code></p>
</td></tr>
<tr><td><code id="dtweedie.saddle_+3A_power">power</code></td>
<td>
<p>a synonym for <code class="reqn">\xi</code></p>
</td></tr>
<tr><td><code id="dtweedie.saddle_+3A_mu">mu</code></td>
<td>
<p>the mean</p>
</td></tr>
<tr><td><code id="dtweedie.saddle_+3A_phi">phi</code></td>
<td>
<p>the dispersion</p>
</td></tr>
<tr><td><code id="dtweedie.saddle_+3A_eps">eps</code></td>
<td>
<p>the offset in computing the variance function.
The default is <code>eps=1/6</code>
(as suggested by Nelder and Pregibon, 1987).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Tweedie family of distributions belong to the class
of exponential dispersion models (<abbr><span class="acronym">EDM</span></abbr>s),
famous for their role in generalized linear models.
The Tweedie distributions are the <abbr><span class="acronym">EDM</span></abbr>s with a variance of the form
<code class="reqn">\mbox{var}[Y]=\phi\mu^p</code>
where <code class="reqn">p</code> is greater than or equal to one, or less than or equal to zero.
<b>This function only evaluates for <code class="reqn">p</code>
greater than or equal to one.</b>
Special cases include the 
normal (<code class="reqn">p=0</code>),
Poisson (<code class="reqn">p=1</code> with <code class="reqn">\phi=1</code>),
gamma (<code class="reqn">p=2</code>)
and
inverse Gaussian (<code class="reqn">p=3</code>)
distributions.
For other values of  <code>power</code>,
the distributions are still defined but cannot be written in closed form,
and hence evaluation is very difficult.
</p>
<p>When <code class="reqn">1&lt;p&lt;2</code>,
the distribution are continuous for <code class="reqn">Y</code> greater than zero,
with a positive mass at <code class="reqn">Y=0</code>.
For <code class="reqn">p&gt;2</code>, 
the distributions are continuous for <code class="reqn">Y</code> greater than zero.
</p>
<p>This function approximates the density using the
saddlepoint approximation defined by Nelder and Pregibon (1987).
</p>


<h3>Value</h3>

<p>saddlepoint (approximate) density
for the given Tweedie distribution with parameters 
<code>mu</code>,
<code>phi</code>
and
<code>power</code>.
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Daniels, H. E. (1954).
Saddlepoint approximations in statistics.
<em>Annals of Mathematical Statistics</em>,
<b>25</b>(4), 631&ndash;650.
</p>
<p>Daniels, H. E. (1980).
Exact saddlepoint approximations.
<em>Biometrika</em>,
<b>67</b>, 59&ndash;63.
doi: <a href="https://doi.org/10.1093/biomet/67.1.59">10.1093/biomet/67.1.59</a>
</p>
<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73&ndash;86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2001).
Tweedie family densities: methods of evaluation.
<em>Proceedings of the 16th International Workshop on Statistical Modelling</em>,
Odense, Denmark, 2&ndash;6 July
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267&ndash;280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Jorgensen, B. (1987).
Exponential dispersion models.
<em>Journal of the Royal Statistical Society</em>, B,
<b>49</b>, 127-162.
</p>
<p>Jorgensen, B. (1997).
<em>Theory of Dispersion Models</em>,
Chapman and Hall, London.
</p>
<p>Nelder, J. A. and Pregibon, D. (1987).
An extended quasi-likelihood function.
<em>Biometrika</em>,
<b>74</b>(2), 221&ndash;232.
doi: <a href="https://doi.org/10.1093/biomet/74.2.221">10.1093/biomet/74.2.221</a>
</p>
<p>Tweedie, M. C. K. (1984). 
An index which distinguishes between some important exponential families.
<em>Statistics: Applications and New Directions.
Proceedings of the Indian Statistical Institute Golden Jubilee International Conference</em>
(Eds. J. K. Ghosh and J. Roy), pp. 579-604. Calcutta: Indian Statistical Institute.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dtweedie">dtweedie</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- 2.5
mu &lt;- 1
phi &lt;- 1
y &lt;- seq(0, 10, length=100)
fy &lt;- dtweedie( y=y, power=p, mu=mu, phi=phi)
plot(y, fy, type="l")
# Compare to the saddlepoint density
f.saddle &lt;- dtweedie.saddle( y=y, power=p, mu=mu, phi=phi)
lines( y, f.saddle, col=2 )
</code></pre>

<hr>
<h2 id='logLiktweedie'>Tweedie Distributions</h2><span id='topic+logLiktweedie'></span>

<h3>Description</h3>

<p>The log likelihood for Tweedie models</p>


<h3>Usage</h3>

<pre><code class='language-R'>	logLiktweedie( glm.obj, dispersion=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLiktweedie_+3A_glm.obj">glm.obj</code></td>
<td>
<p>a fitted Tweedie <code>glm</code> object</p>
</td></tr>
<tr><td><code id="logLiktweedie_+3A_dispersion">dispersion</code></td>
<td>
<p>the dispersion parameter <code class="reqn">\phi</code>; the default is <code>NULL</code> which means to use an estimate</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The log-likelihood is computed from the <abbr><span class="acronym">AIC</span></abbr>,
so see <code><a href="#topic+AICtweedie">AICtweedie</a></code> for more details.
</p>


<h3>Value</h3>

<p>Returns the log-likelihood from the specified model
</p>


<h3>Note</h3>

<p>Computing the log-likelihood may take a long time.
</p>


<h3>Note</h3>

<p>Tweedie distributions with the index parameter as 1
correspond to Poisson distributions when <code class="reqn">\phi = 1</code>.
However,
in general a Tweedie distribution with an index parameter equal to one
may not be referring to a Poisson distribution with <code class="reqn">\phi=1</code>,
so we cannot assume that <code class="reqn">\phi=1</code> just because the index parameter is set to one.
If the Poisson distribution is intended,
then <code>dispersion=1</code> should be specified.
The same argument applies for similar situations.
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73&ndash;86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267&ndash;280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Jorgensen, B. (1997).
<em>Theory of Dispersion Models</em>.
Chapman and Hall, London.
</p>
<p>Sakamoto, Y., Ishiguro, M., and Kitagawa G. (1986). 
<em>Akaike Information Criterion Statistics</em>. 
D. Reidel Publishing Company.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AICtweedie">AICtweedie</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(statmod) # Needed to use  tweedie  family object

### Generate some fictitious data
test.data &lt;- rgamma(n=200, scale=1, shape=1)

### Fit a Tweedie glm and find the AIC
m1 &lt;- glm( test.data~1, family=tweedie(link.power=0, var.power=2) )

### A Tweedie glm with p=2 is equivalent to a gamma glm:
m2 &lt;- glm( test.data~1, family=Gamma(link=log))

### The models are equivalent, so the AIC shoud be the same:
logLiktweedie(m1)
logLik(m2)

</code></pre>

<hr>
<h2 id='Tweedie'>Tweedie Distributions</h2><span id='topic+dtweedie'></span><span id='topic+dtweedie.series'></span><span id='topic+dtweedie.inversion'></span><span id='topic+dtweedie.stable'></span><span id='topic+ptweedie'></span><span id='topic+ptweedie.series'></span><span id='topic+ptweedie.inversion'></span><span id='topic+qtweedie'></span><span id='topic+rtweedie'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random
generation for the Tweedie family of distributions</p>


<h3>Usage</h3>

<pre><code class='language-R'>	dtweedie(y, xi=NULL, mu, phi, power=NULL)
	dtweedie.series(y, power, mu, phi)
	dtweedie.inversion(y, power, mu, phi, exact=TRUE, method)
	dtweedie.stable(y, power, mu, phi)
	ptweedie(q, xi=NULL, mu, phi, power=NULL)
	ptweedie.series(q, power, mu, phi)
	qtweedie(p, xi=NULL, mu, phi, power=NULL)
	rtweedie(n, xi=NULL, mu, phi, power=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Tweedie_+3A_y">y</code>, <code id="Tweedie_+3A_q">q</code></td>
<td>
<p>vector of quantiles</p>
</td></tr>
<tr><td><code id="Tweedie_+3A_p">p</code></td>
<td>
<p>vector of probabilities</p>
</td></tr>
<tr><td><code id="Tweedie_+3A_n">n</code></td>
<td>
<p>the number of observations</p>
</td></tr>
<tr><td><code id="Tweedie_+3A_xi">xi</code></td>
<td>
<p>the value of <code class="reqn">\xi</code> such that the variance is 
<code class="reqn">\mbox{var}[Y]=\phi\mu^{\xi}</code></p>
</td></tr>
<tr><td><code id="Tweedie_+3A_power">power</code></td>
<td>
<p>a synonym for <code class="reqn">\xi</code></p>
</td></tr>
<tr><td><code id="Tweedie_+3A_mu">mu</code></td>
<td>
<p>the mean</p>
</td></tr>
<tr><td><code id="Tweedie_+3A_phi">phi</code></td>
<td>
<p>the dispersion</p>
</td></tr>
<tr><td><code id="Tweedie_+3A_exact">exact</code></td>
<td>
<p>logical flag; 
if <code>TRUE</code> (the default),
exact zeros are used with
the <code class="reqn">W</code>-algorithm of Sidi (1982);
if <code>FALSE</code>,
approximate (asymptotic) zeros are used in place of exact zeros.
Using asymptotic zeros requires less computation but is often less accurate;
using exact zeros can be slower but generally improves accuracy.</p>
</td></tr>
<tr><td><code id="Tweedie_+3A_method">method</code></td>
<td>
<p>either <code>1</code>, <code>2</code> or <code>3</code>,
determining which of three methods to use to compute the density
using the inversion method.
If <code>method</code> is <code>NULL</code> (the default),
the optimal method (in terms of relative accuracy) is used, element-by-element of <code>y</code>.
See the Note in the Details section below</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Tweedie family of distributions belong to the class
of exponential dispersion models (<abbr><span class="acronym">EDM</span></abbr>s),
famous for their role in generalized linear models.
The Tweedie distributions are the <abbr><span class="acronym">EDM</span></abbr>s with a variance of the form
<code class="reqn">\mbox{var}[Y]=\phi\mu^p</code>
where <code class="reqn">p</code> is greater than or equal to one, or less than or equal to zero.
<b>This function only evaluates for <code class="reqn">p</code>
greater than or equal to one.</b>
Special cases include the 
normal (<code class="reqn">p=0</code>),
Poisson (<code class="reqn">p=1</code> with <code class="reqn">\phi=1</code>),
gamma (<code class="reqn">p=2</code>)
and
inverse Gaussian (<code class="reqn">p=3</code>)
distributions.
For other values of  <code>power</code>,
the distributions are still defined but cannot be written in closed form,
and hence evaluation is very difficult.
</p>
<p>When <code class="reqn">1&lt;p&lt;2</code>,
the distribution are continuous for <code class="reqn">Y</code> greater than zero,
with a positive mass at <code class="reqn">Y=0</code>.
For <code class="reqn">p&gt;2</code>, 
the distributions are continuous for <code class="reqn">Y</code> greater than zero.
</p>
<p>This function evaluates the density or cumulative probability 
using one of two methods, 
depending on the combination of parameters. 
One method is the evaluation of an infinite series.
The second interpolates some stored values computed from a 
Fourier inversion technique. 
</p>
<p>The function <code>dtweedie.inversion</code>
evaluates the density using a Fourier series technique; 
<code>ptweedie.inversion</code> does likewise for the cumulative 
probabilities. 
The actual code is contained in an external FORTRAN program. 
Different code is used for <code class="reqn">p&gt;2</code>
and for <code class="reqn">1&lt;p&lt;2</code>. 
</p>
<p>The function <code>dtweedie.series</code> evaluates the density
using a series expansion; 
a different series expansion
is used for <code class="reqn">p&gt;2</code> and for <code class="reqn">1&lt;p&lt;2</code>.
The function <code>ptweedie.series</code> does likewise for the 
cumulative probabilities but only for <code class="reqn">1&lt;p&lt;2</code>. 
</p>
<p>The function <code>dtweedie.stable</code> exploits the link between
the stable distribution (Nolan, 1997) and Tweedie distributions,
as discussed in Jorgensen, Chapter 4.
These are computed using Nolan's algorithm as implemented
in the  <code>stabledist</code>  package (which is therefore required to use
the <code>dtweedie.stable</code> function).
</p>
<p>The function <code>dtweedie</code> uses a two-dimensional interpolation procedure to 
compute the density for some parts of the parameter space from 
previously computed values found from the series or the 
inversion. For other parts of the parameter space, 
the series solution is found. 
</p>
<p><code>ptweedie</code> returns either the computed series 
solution or inversion solution.
</p>


<h3>Value</h3>

<p>density (<code>dtweedie</code>),
probability (<code>ptweedie</code>),
quantile (<code>qtweedie</code>)
or random sample (<code>rtweedie</code>)
for the given Tweedie distribution with parameters 
<code>mu</code>, 
<code>phi</code>
and 
<code>power</code>.
</p>


<h3>Note</h3>

<p>The <code>method</code>s changed from version 1.4 to 1.5
(methods 1 and 2 swapped).
The methods are defined in Dunn and Smyth (2008).
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73&ndash;86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267&ndash;280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2001).
Tweedie family densities: methods of evaluation.
<em>Proceedings of the 16th International Workshop on Statistical Modelling</em>,
Odense, Denmark, 2&ndash;6 July
</p>
<p>Jorgensen, B. (1987).
Exponential dispersion models.
<em>Journal of the Royal Statistical Society</em>, B,
<b>49</b>, 127&ndash;162.
</p>
<p>Jorgensen, B. (1997).
<em>Theory of Dispersion Models</em>.
Chapman and Hall, London.
</p>
<p>Nolan, John P (1997).
Numerical calculation of stable densities and distribution functions.
<em>Communication in Statistics&mdash;Stochastic models</em>,
<b>13</b>(4). 759&ndash;774.
doi: <a href="https://doi.org/10.1080/15326349708807450">10.1080/15326349708807450</a>
</p>
<p>Sidi, Avram (1982).
The numerical evaluation of very oscillatory infinite integrals by
extrapolation.
<em>Mathematics of Computation</em>
<b>38</b>(158), 517&ndash;529.
doi: <a href="https://doi.org/10.1090/S0025-5718-1982-0645667-5">10.1090/S0025-5718-1982-0645667-5</a>
</p>
<p>Sidi, Avram (1988).  
A user-friendly extrapolation method for
oscillatory infinite integrals.
<em>Mathematics of Computation</em>
<b>51</b>(183), 249&ndash;266.
doi: <a href="https://doi.org/10.1090/S0025-5718-1988-0942153-5">10.1090/S0025-5718-1988-0942153-5</a>
</p>
<p>Tweedie, M. C. K. (1984).
An index which distinguishes between some important exponential families.
<em>Statistics: Applications and New Directions.
Proceedings of the Indian Statistical Institute Golden Jubilee International Conference</em>
(Eds. J. K. Ghosh and J. Roy), pp. 579-604. Calcutta: Indian Statistical Institute.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dtweedie.saddle">dtweedie.saddle</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>### Plot a Tweedie density
power &lt;- 2.5
mu &lt;- 1 
phi &lt;- 1 
y &lt;- seq(0, 6, length=500) 
fy &lt;- dtweedie( y=y, power=power, mu=mu, phi=phi) 
plot(y, fy, type="l", lwd=2, ylab="Density")
# Compare to the saddlepoint density
f.saddle &lt;- dtweedie.saddle( y=y, power=power, mu=mu, phi=phi) 
lines( y, f.saddle, col=2 )
legend("topright", col=c(1,2), lwd=c(2,1),
    legend=c("Actual","Saddlepoint") )

### A histogram of Tweedie random numbers
hist( rtweedie( 1000, power=1.2, mu=1, phi=1) )

### An example of the multimodal feature of the Tweedie
### family with power near 1 (from Dunn and Smyth, 2005).
y &lt;- seq(0.001,2,len=1000)
mu &lt;- 1
phi &lt;- 0.1
p &lt;- 1.02
f1 &lt;- dtweedie(y,mu=mu,phi=phi,power=p)
plot(y, f1, type="l", xlab="y", ylab="Density")
p &lt;- 1.05
f2&lt;- dtweedie(y,mu=mu,phi=phi,power=p)
lines(y,f2, col=2)

### Compare series and saddlepoint methods
y &lt;- seq(0.001,2,len=1000)
mu &lt;- 1
phi &lt;- 0.1
p &lt;- 1.02
f.series &lt;- dtweedie.series( y,mu=mu,phi=phi,power=p )
f.saddle &lt;- dtweedie.saddle( y,mu=mu,phi=phi,power=p )

f.all &lt;- c( f.series, f.saddle )
plot( range(f.all) ~ range( y ), xlab="y", ylab="Density", 
  type="n")
lines( f.series ~ y, lty=1, col=1)
lines( f.saddle ~ y, lty=3, col=3)

legend("topright", lty=c(1,3), col=c(1,3),
  legend=c("Series","Saddlepoint") )

</code></pre>

<hr>
<h2 id='Tweedie+20internals'>Tweedie internal function</h2><span id='topic+dtweedie.dlogfdphi'></span><span id='topic+dtweedie.logl'></span><span id='topic+dtweedie.logl.saddle'></span><span id='topic+dtweedie.logv.bigp'></span><span id='topic+dtweedie.logw.smallp'></span><span id='topic+dtweedie.interp'></span><span id='topic+dtweedie.jw.smallp'></span><span id='topic+dtweedie.kv.bigp'></span><span id='topic+dtweedie.series.bigp'></span><span id='topic+dtweedie.series.smallp'></span><span id='topic+stored.grids'></span><span id='topic+twcdf'></span><span id='topic+twpdf'></span>

<h3>Description</h3>

<p>Internal tweedie functions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>	dtweedie.dlogfdphi(y, mu, phi, power)
	dtweedie.logl(phi, y, mu, power)
	dtweedie.logl.saddle( phi, power, y, mu, eps=0)
	dtweedie.logv.bigp( y, phi, power)
	dtweedie.logw.smallp(y, phi, power)
	dtweedie.interp(grid, nx, np, xix.lo, xix.hi,p.lo, p.hi, power, xix)
	dtweedie.jw.smallp(y, phi, power )
	dtweedie.kv.bigp(y, phi, power)
	dtweedie.series.bigp(power, y, mu, phi)
	dtweedie.series.smallp(power, y, mu, phi)
	stored.grids(power)
	twpdf(p, phi, y, mu, exact, verbose, funvalue, exitstatus, relerr, its )
	twcdf(p, phi, y, mu, exact,          funvalue, exitstatus, relerr, its )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Tweedie+2B20internals_+3A_y">y</code></td>
<td>
<p>the vector of responses</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_power">power</code></td>
<td>
<p>the value of <code class="reqn">p</code> such that the variance is
<code class="reqn">\mbox{var}[Y]=\phi\mu^p</code></p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_mu">mu</code></td>
<td>
<p>the mean</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_phi">phi</code></td>
<td>
<p>the dispersion</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_grid">grid</code></td>
<td>
<p>the interpolation grid necessary for the given value of <code class="reqn">p</code></p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_nx">nx</code></td>
<td>
<p>the number of interpolation points in the <code class="reqn">\xi</code> dimension</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_np">np</code></td>
<td>
<p>the number of interpolation points in the <code class="reqn">p</code> dimension</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_xix.lo">xix.lo</code></td>
<td>
<p>the lower value of the transformed <code class="reqn">\xi</code> value used in the interpolation grid.
(Note that the value of <code class="reqn">\xi</code> is from <code class="reqn">0</code> to <code class="reqn">\infty</code>,
and is transformed such that it is on the range <code class="reqn">0</code> to <code class="reqn">1</code>.)</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_xix.hi">xix.hi</code></td>
<td>
<p>the higher value of the transformed <code class="reqn">\xi</code> value used in the interpolation grid.</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_p.lo">p.lo</code></td>
<td>
<p>the lower value of <code class="reqn">p</code> value used in the interpolation grid.</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_p.hi">p.hi</code></td>
<td>
<p>the higher value of <code class="reqn">p</code> value used in the interpolation grid.</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_xix">xix</code></td>
<td>
<p>the value of the transformed <code class="reqn">\xi</code> at which a value is sought.</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_eps">eps</code></td>
<td>
<p>the offset in computing the variance function in the saddlepoint approximation.
The default is <code>eps=1/6</code>
(as suggested by Nelder and Pregibon, 1987).</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_p">p</code></td>
<td>
<p>the Tweedie index parameter</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_exact">exact</code></td>
<td>
<p>a flag for the FORTRAN to use exact-zeros acceleration algorithmic the calculation (1 means to do so)</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_verbose">verbose</code></td>
<td>
<p>a flag for the FORTRAN: 1 means to be verbose </p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_funvalue">funvalue</code></td>
<td>
<p>the value of the call returned by the FORTRAN code</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_exitstatus">exitstatus</code></td>
<td>
<p>the exit status returned by the FORTRAN code</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_relerr">relerr</code></td>
<td>
<p>an estimation of the relative error returned by the FORTRAN code</p>
</td></tr>
<tr><td><code id="Tweedie+2B20internals_+3A_its">its</code></td>
<td>
<p>the number of iterations of the algorithm returned by the FORTRAN code</p>
</td></tr>	
</table>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Nelder, J. A. and Pregibon, D. (1987).
An extended quasi-likelihood function
<em>Biometrika</em>,
<b>74</b>(2), 221&ndash;232.
doi10.1093/biomet/74.2.221
</p>

<hr>
<h2 id='tweedie-package'>
Tweedie Distributions
</h2><span id='topic+tweedie-package'></span><span id='topic+Tweedie'></span>

<h3>Description</h3>

<p>Functions for computing and fitting the Tweedie family of distributions
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
	Package: </td><td style="text-align: left;"> tweedie</td>
</tr>
<tr>
 <td style="text-align: left;">
	Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
	Version: </td><td style="text-align: left;"> 2.3.2</td>
</tr>
<tr>
 <td style="text-align: left;">
	Date: </td><td style="text-align: left;"> 2017-12-14</td>
</tr>
<tr>
 <td style="text-align: left;">
	License: </td><td style="text-align: left;"> GPL (&gt;=2)
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Peter K Dunn
</p>
<p>Maintainer: Peter K Dunn &lt;pdunn2@usc.edu.au&gt;
</p>


<h3>References</h3>

<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73&ndash;86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267&ndash;280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2001).
Tweedie family densities: methods of evaluation.
<em>Proceedings of the 16th International Workshop on Statistical Modelling</em>,
Odense, Denmark, 2&ndash;6 July
</p>
<p>Jorgensen, B. (1987).
Exponential dispersion models.
<em>Journal of the Royal Statistical Society</em>, B,
<b>49</b>, 127&ndash;162.
</p>
<p>Jorgensen, B. (1997).
<em>Theory of Dispersion Models</em>.
Chapman and Hall, London.
</p>
<p>Tweedie, M. C. K. (1984).
An index which distinguishes between some important exponential families.
<em>Statistics: Applications and New Directions.
Proceedings of the Indian Statistical Institute Golden Jubilee International Conference</em>
(Eds. J. K. Ghosh and J. Roy), pp. 579&ndash;604. Calcutta: Indian Statistical Institute.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random numbers
set.seed(987654)
y &lt;- rtweedie( 20, xi=1.5, mu=1, phi=1)
	# With Tweedie index  xi   between 1 and 2, this produces continuous
	# data with exact zeros
x &lt;- rnorm( length(y), 0, 1)  # Unrelated predictor

# With exact zeros, Tweedie index  xi  must be between 1 and 2

# Fit the tweedie distribution; expect  xi  about 1.5
library(statmod)

xi.vec &lt;- seq(1.1, 1.9, by=0.5)
out &lt;- tweedie.profile( y~1, xi.vec=xi.vec, do.plot=TRUE, verbose=TRUE)

# Fit the glm
require(statmod) # Provides  tweedie  family functions
summary(glm( y ~ x, family=tweedie(var.power=out$xi.max, link.power=0) ))
</code></pre>

<hr>
<h2 id='tweedie.convert'>Convert Tweedie parameters</h2><span id='topic+tweedie.convert'></span>

<h3>Description</h3>

<p>Converts Tweedie distribution parameters to the parameters of the underlying distributions</p>


<h3>Usage</h3>

<pre><code class='language-R'>	tweedie.convert( xi=NULL, mu, phi, power=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tweedie.convert_+3A_xi">xi</code></td>
<td>
<p>the value of <code class="reqn">\xi</code> such that the variance is 
<code class="reqn">\mbox{var}[Y]=\phi\mu^{\xi}</code></p>
</td></tr>
<tr><td><code id="tweedie.convert_+3A_power">power</code></td>
<td>
<p>a synonym for <code class="reqn">\xi</code></p>
</td></tr>
<tr><td><code id="tweedie.convert_+3A_mu">mu</code></td>
<td>
<p>the mean</p>
</td></tr>
<tr><td><code id="tweedie.convert_+3A_phi">phi</code></td>
<td>
<p>the dispersion</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Tweedie family of distributions with <code class="reqn">1&lt;\xi&lt;2</code>
is the Poisson sum of gamma distributions
(where the Poisson distribution has mean <code class="reqn">\lambda</code>,
and the gamma distribution has scale and shape parameters).
When used to fit a glm,    
the model is fitted with the usual glm parameters:
the mean <code class="reqn">\mu</code>
and the dispersion parameter <code class="reqn">\phi</code>.
This function converts the parameters
<code class="reqn">(p, \mu, \phi)</code>
to the values of the parameters of the underlying Poisson distribution <code class="reqn">\lambda</code>
and gamma distribution (scale and shape parameters).
</p>


<h3>Value</h3>

<p>a list containing the values of
the mean of the underlying Poisson distribution (as <code>poisson.lambda</code>),
the scale parameter of the underlying gamma distribution (as <code>gamma.scale</code>),
the shape parameter of the underlying gamma distribution (as <code>gamma.shape</code>),
the probability of obtaining a zero response (as <code>p0</code>),
the mean of the underlying gamma distribution (as <code>gamma.mean</code>),
and
the dispersion parameter of the underlying gamma distribution (as <code>gamma.phi</code>).
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73&ndash;86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267&ndash;280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2001).
Tweedie family densities: methods of evaluation.
<em>Proceedings of the 16th International Workshop on Statistical Modelling</em>,
Odense, Denmark, 2&ndash;6 July
</p>
<p>Tweedie, M. C. K. (1984).
An index which distinguishes between some important exponential families.
<em>Statistics: Applications and New Directions.
Proceedings of the Indian Statistical Institute Golden Jubilee International Conference</em>
(Eds. J. K. Ghosh and J. Roy), pp. 579-604. Calcutta: Indian Statistical Institute.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dtweedie.saddle">dtweedie.saddle</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>tweedie.convert(xi=1.5, mu=1, phi=1)
</code></pre>

<hr>
<h2 id='tweedie.dev'>Tweedie Distributions: the deviance function</h2><span id='topic+tweedie.dev'></span>

<h3>Description</h3>

<p>The deviance function for the Tweedie family of distributions</p>


<h3>Usage</h3>

<pre><code class='language-R'>tweedie.dev(y, mu, power)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tweedie.dev_+3A_y">y</code></td>
<td>
<p>vector of quantiles (which can be zero if <code class="reqn">1&lt;p&lt;2</code></p>
</td></tr>
<tr><td><code id="tweedie.dev_+3A_mu">mu</code></td>
<td>
<p>the mean</p>
</td></tr>
<tr><td><code id="tweedie.dev_+3A_power">power</code></td>
<td>
<p>the value of <code class="reqn">p</code> such that the variance is 
<code class="reqn">\mbox{var}[Y]=\phi\mu^p</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Tweedie family of distributions belong to the class
of exponential dispersion models (<abbr><span class="acronym">EDM</span></abbr>s),
famous for their role in generalized linear models.
The Tweedie distributions are the <abbr><span class="acronym">EDM</span></abbr>s with a variance of the form
<code class="reqn">\mbox{var}[Y]=\phi\mu^p</code>
where <code class="reqn">p</code> is greater than or equal to one, or less than or equal to zero.
<b>This function only evaluates for <code class="reqn">p</code>
greater than or equal to one.</b>
Special cases include the 
normal (<code class="reqn">p=0</code>),
Poisson (<code class="reqn">p=1</code> with <code class="reqn">\phi=1</code>),
gamma (<code class="reqn">p=2</code>)
and
inverse Gaussian (<code class="reqn">p=3</code>)
distributions.
For other values of  <code>power</code>,
the distributions are still defined but cannot be written in closed form,
and hence evaluation is very difficult.
</p>
<p>The deviance is defined by <code><a href="stats.html#topic+deviance">deviance</a></code> as
&ldquo;up to a constant, minus twice the maximized log-likelihood.
Where sensible, the constant is chosen so that a saturated
model has deviance zero.&rdquo;
</p>


<h3>Value</h3>

<p>the value of the deviance 
for the given Tweedie distribution with parameters 
<code>mu</code>, 
<code>phi</code>
and 
<code>power</code>.
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73&ndash;86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267&ndash;280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2001).
Tweedie family densities: methods of evaluation.
<em>Proceedings of the 16th International Workshop on Statistical Modelling</em>,
Odense, Denmark, 2&ndash;6 July
</p>
<p>Jorgensen, B. (1987).
Exponential dispersion models.
<em>Journal of the Royal Statistical Society</em>, B,
<b>49</b>, 127&ndash;162.
</p>
<p>Jorgensen, B. (1997).
<em>Theory of Dispersion Models</em>.
Chapman and Hall, London.
</p>
<p>Sidi, Avram (1982).
The numerical evaluation of very oscillatory infinite integrals by
extrapolation.
<em>Mathematics of Computation</em>
<b>38</b>(158), 517&ndash;529.
doi: <a href="https://doi.org/10.1090/S0025-5718-1982-0645667-5">10.1090/S0025-5718-1982-0645667-5</a>
</p>
<p>Sidi, Avram (1988).  
A user-friendly extrapolation method for
oscillatory infinite integrals.
<em>Mathematics of Computation</em>
<b>51</b>(183), 249&ndash;266.
doi: <a href="https://doi.org/10.1090/S0025-5718-1988-0942153-5">10.1090/S0025-5718-1988-0942153-5</a>
</p>
<p>Tweedie, M. C. K. (1984).
An index which distinguishes between some important exponential families.
<em>Statistics: Applications and New Directions.
Proceedings of the Indian Statistical Institute Golden Jubilee International Conference</em>
(Eds. J. K. Ghosh and J. Roy), pp. 579-604. Calcutta: Indian Statistical Institute.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dtweedie">dtweedie</a></code>,
<code><a href="#topic+dtweedie.saddle">dtweedie.saddle</a></code>,
<code><a href="statmod.html#topic+tweedie">tweedie</a></code>,
<code><a href="stats.html#topic+deviance">deviance</a></code>,
<code><a href="stats.html#topic+glm">glm</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Plot a Tweedie deviance function when 1&lt;p&lt;2
mu &lt;- 1 

y &lt;- seq(0, 6, length=100) 

dev1 &lt;- tweedie.dev( y=y, mu=mu, power=1.1) 
dev2 &lt;- tweedie.dev( y=y, mu=mu, power=1.5)
dev3 &lt;- tweedie.dev( y=y, mu=mu, power=1.9) 

plot(range(y), range( c(dev1, dev2, dev3)), 
   type="n", lwd=2, ylab="Deviance", xlab=expression(italic(y)) )

lines( y, dev1, lty=1, col=1, lwd=2 )
lines( y, dev2, lty=2, col=2, lwd=2 )
lines( y, dev3, lty=3, col=3, lwd=2 )


legend("top", col=c(1,2,3), lwd=c(2,2,2), lty=c(1,2,3),
    legend=c("p=1.1","p=1.5", "p=1.9") )


### Plot a Tweedie deviance function when p&gt;2
mu &lt;- 1 

y &lt;- seq(0.1, 6, length=100) 

dev1 &lt;- tweedie.dev( y=y, mu=mu, power=2) # Gamma
dev2 &lt;- tweedie.dev( y=y, mu=mu, power=3) # Inverse Gaussian
dev3 &lt;- tweedie.dev( y=y, mu=mu, power=4) 

plot(range(y), range( c(dev1, dev2, dev3)), 
   type="n", lwd=2, ylab="Deviance", xlab=expression(italic(y)) )

lines( y, dev1, lty=1, col=1, lwd=2 )
lines( y, dev2, lty=2, col=2, lwd=2 )
lines( y, dev3, lty=3, col=3, lwd=2 )


legend("top", col=c(1,2,3), lwd=c(2,2,2), lty=c(1,2,3),
    legend=c("p=2 (gamma)", "p=3 (inverse Gaussian)", "p=4") )

</code></pre>

<hr>
<h2 id='tweedie.plot'>Tweedie Distributions: plotting</h2><span id='topic+tweedie.plot'></span>

<h3>Description</h3>

<p>Plotting Tweedie density and distribution functions</p>


<h3>Usage</h3>

<pre><code class='language-R'>   tweedie.plot(y, xi, mu, phi, type="pdf", power=NULL, add=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tweedie.plot_+3A_y">y</code></td>
<td>
<p>vector of values at which to evaluate and plot</p>
</td></tr>
<tr><td><code id="tweedie.plot_+3A_xi">xi</code></td>
<td>
<p>the value of <code class="reqn">\xi</code> such that the variance is 
<code class="reqn">\mbox{var}[Y]=\phi\mu^{\xi}</code></p>
</td></tr>
<tr><td><code id="tweedie.plot_+3A_power">power</code></td>
<td>
<p>a synonym for <code class="reqn">\xi</code></p>
</td></tr>
<tr><td><code id="tweedie.plot_+3A_mu">mu</code></td>
<td>
<p>the mean</p>
</td></tr>
<tr><td><code id="tweedie.plot_+3A_phi">phi</code></td>
<td>
<p>the dispersion</p>
</td></tr>
<tr><td><code id="tweedie.plot_+3A_type">type</code></td>
<td>
<p>what to plot: <code>pdf</code> (the default) means the probability function,
or <code>cdf</code>, the cumulative distribution function</p>
</td></tr>
<tr><td><code id="tweedie.plot_+3A_add">add</code></td>
<td>
<p>if <code>TRUE</code>, the plot is added to the current device;
if <code>FALSE</code> (the default), a new plot is produced</p>
</td></tr>
<tr><td><code id="tweedie.plot_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to the plotting method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For details, see <code><a href="#topic+dtweedie">dtweedie</a></code>
</p>


<h3>Value</h3>

<p>this function is usually called for side-effect of
producing a plot of the specified Tweedie distribution,
properly plotting the exact zero that occurs at <code class="reqn">y=0</code>
when <code class="reqn">1&lt;p&lt;2</code>.
However,
it also produces a list with the computed density at the given points,
with components <code>y</code> and <code>x</code> respectively,
such that <code>plot(y~x)</code> approximately reproduces the plot.
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73&ndash;86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267&ndash;280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2001).
Tweedie family densities: methods of evaluation.
<em>Proceedings of the 16th International Workshop on Statistical Modelling</em>,
Odense, Denmark, 2&ndash;6 July
</p>
<p>Jorgensen, B. (1987).
Exponential dispersion models.
<em>Journal of the Royal Statistical Society</em>, B,
<b>49</b>, 127&ndash;162.
</p>
<p>Jorgensen, B. (1997).
<em>Theory of Dispersion Models</em>.
Chapman and Hall, London.
</p>
<p>Nolan, John P (1997).
Numerical calculation of stable densities and distribution functions.
<em>Communication in Statistics&mdash;Stochastic models</em>,
<b>13</b>(4). 759&ndash;774.
doi: <a href="https://doi.org/10.1080/15326349708807450">10.1080/15326349708807450</a>
</p>
<p>Sidi, Avram (1982).
The numerical evaluation of very oscillatory infinite integrals by
extrapolation.
<em>Mathematics of Computation</em>
<b>38</b>(158), 517&ndash;529.
doi: <a href="https://doi.org/10.1090/S0025-5718-1982-0645667-5">10.1090/S0025-5718-1982-0645667-5</a>
</p>
<p>Sidi, Avram (1988).  
A user-friendly extrapolation method for
oscillatory infinite integrals.
<em>Mathematics of Computation</em>
<b>51</b>(183), 249&ndash;266.
doi: <a href="https://doi.org/10.1090/S0025-5718-1988-0942153-5">10.1090/S0025-5718-1988-0942153-5</a>
</p>
<p>Tweedie, M. C. K. (1984).
An index which distinguishes between some important exponential families.
<em>Statistics: Applications and New Directions.
Proceedings of the Indian Statistical Institute Golden Jubilee International Conference</em>
(Eds. J. K. Ghosh and J. Roy), pp. 579-604. Calcutta: Indian Statistical Institute.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dtweedie">dtweedie</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>### Plot a Tweedie density with 1&lt;p&lt;2
yy &lt;- seq(0,5,length=100)
tweedie.plot( power=1.7, mu=1, phi=1, y=yy, lwd=2)
tweedie.plot( power=1.2, mu=1, phi=1, y=yy, add=TRUE, lwd=2, col="red")
legend("topright",lwd=c(2,2), col=c("black","red"), pch=c(19,19),
   legend=c("p=1.7","p=1.2") )

### Plot distribution functions
tweedie.plot( power=1.05, mu=1, phi=1, y=yy,
   lwd=2, type="cdf", ylim=c(0,1))
tweedie.plot( power=2, mu=1, phi=1, y=yy, 
   add=TRUE, lwd=2, type="cdf",col="red")
legend("bottomright",lwd=c(2,2), col=c("black","red"),
   legend=c("p=1.05","p=2") )

### Now, plot two densities, combining p&gt;2 and 1&lt;p&lt;2
tweedie.plot( power=3.5, mu=1, phi=1, y=yy, lwd=2)
tweedie.plot( power=1.5, mu=1, phi=1, y=yy, lwd=2, col="red", add=TRUE)
legend("topright",lwd=c(2,2), col=c("black","red"), pch=c(NA,19),
   legend=c("p=3.5","p=1.5") )
</code></pre>

<hr>
<h2 id='tweedie.profile'>Tweedie Distributions: mle estimation of p</h2><span id='topic+tweedie.profile'></span>

<h3>Description</h3>

<p>Maximum likelihood estimation of the Tweedie index parameter <code class="reqn">p</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tweedie.profile(formula, p.vec=NULL, xi.vec=NULL, link.power=0, 
      data, weights, offset, fit.glm=FALSE,
      do.smooth=TRUE, do.plot=FALSE, do.ci=do.smooth,
      eps=1/6, 
      control=list( epsilon=1e-09, maxit=glm.control()$maxit, trace=glm.control()$trace ),
      do.points=do.plot, method="inversion", conf.level=0.95, 
      phi.method=ifelse(method == "saddlepoint", "saddlepoint", "mle"), 
      verbose=FALSE, add0=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tweedie.profile_+3A_formula">formula</code></td>
<td>
<p>a formula expression as for other regression models and generalized linear models, 
of the form <code>response ~ predictors</code>. 
For details, 
see the documentation for <code><a href="stats.html#topic+lm">lm</a></code>, 
<code><a href="stats.html#topic+glm">glm</a></code> and <code><a href="stats.html#topic+formula">formula</a></code></p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_p.vec">p.vec</code></td>
<td>
<p>a vector of <code>p</code> values for consideration.
The values must all be larger than one
(if the response variable has exact zeros,
the values must all be between one and two).
If <code>NULL</code> (the default),
<code>p.vec</code> is set to 
<code>seq(1.2, 1.8, by=0.1)</code> if the 
response contains any zeros,
or
<code>seq(1.5, 5, by=0.5)</code> if the 
response contains no zeros.
See the DETAILS section below for further details.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_xi.vec">xi.vec</code></td>
<td>
<p>the same as <code>p.vec</code>;
some authors use the <code class="reqn">p</code> notation for the index parameter,
and some use <code class="reqn">\xi</code>;
this function detects which is used and then uses that notation throughout</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_link.power">link.power</code></td>
<td>
<p>the power link function to use.
These link functions <code class="reqn">g(\cdot)</code> are of the form 
<code class="reqn">g(\eta)=\eta^{\rm link.power}</code>,
and the special case of <code>link.power=0</code> (the default)
refers to the logarithm link function.
See the documentation for 
<code><a href="statmod.html#topic+tweedie">tweedie</a></code> also.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment 
(or object coercible by <code>as.data.frame</code> to a data frame) 
containing the variables in the model.  
If not found in <code>data</code>, 
the variables are taken from <code>environment(formula)</code>, 
typically the environment from which <code>glm</code> is called.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.  Should be <code>NULL</code> or a numeric vector.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em>
known component to be included in the linear predictor during fitting.  
This should be <code>NULL</code> or a numeric vector of length either one or
equal to the number of cases. 
One or more <code>offset</code> terms can
be included in the formula instead or as well, 
and if both are specified their sum is used.  
See <code><a href="stats.html#topic+model.offset">model.offset</a></code>.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_fit.glm">fit.glm</code></td>
<td>
<p>logical flag.
If <code>TRUE</code>,
the Tweedie generalized linear model is fitted using the value of <code class="reqn">p</code>
found by the profiling function.
If <code>FALSE</code> (the default),
no model is fitted.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_do.smooth">do.smooth</code></td>
<td>
<p>logical flag.
If <code>TRUE</code> (the default),
a spline is fitted to the data to smooth the profile likelihood plot.
If <code>FALSE</code>,
no smoothing is used 
(and the function is quicker).
<b>Note</b> that <code>p.vec</code> must contain <em>at least five points</em>
for smoothing to be allowed.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_do.plot">do.plot</code></td>
<td>
<p>logical flag.
If <code>TRUE</code>,
a plot of the profile likelihood is produce.
If <code>FALSE</code> (the default),
no plot is produced.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_do.ci">do.ci</code></td>
<td>
<p>logical flag.
If <code>TRUE</code>,
the nominal 100*<code>conf.level</code>
is computed.
If <code>FALSE</code>,
no confidence interval is computed.
By default,
<code>do.ci</code> is the same value as <code>do.smooth</code>,
since a confidence interval will only be accurate if
smoothing has been performed.
Indeed,
if <code>do.smooth=FALSE</code>,
confidence intervals are never computed and
<code>do.ci</code> is forced to <code>FALSE</code> if it is given as <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_eps">eps</code></td>
<td>
<p>the offset in computing the variance function.
The default is <code>eps=1/6</code>
(as suggested by Nelder and Pregibon, 1987).
Note <code>eps</code> is ignored unless the 
<code>method="saddlepoint"</code>
as it makes no sense otherwise.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_control">control</code></td>
<td>
<p>a list of parameters for controlling the fitting process;
see <code><a href="stats.html#topic+glm.control">glm.control</a></code> and <code><a href="stats.html#topic+glm">glm</a></code>.
The default is to use the maximum number of iterations <code>maxit</code> and the
<code>trace</code> setting as given in <code><a href="stats.html#topic+glm.control">glm.control</a></code>,
but to set <code>epsilon</code> to <code>1e-09</code> to ensure a smoother plot</p>
</td></tr>   
<tr><td><code id="tweedie.profile_+3A_do.points">do.points</code></td>
<td>
<p>plot the points on the plot where the
(log-) likelihood is computed for the given values of <code>p</code>;
defaults to the same value as <code>do.plot</code></p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_method">method</code></td>
<td>
<p>the method for computing the (log-) likelihood.
One of
<code>"series"</code>,
<code>"inversion"</code> (the default),
<code>"interpolation"</code>
or
<code>"saddlepoint"</code>.
If there are any troubles using this function,
sometimes a change of method will fix the problem.
Note that <code>method="saddlepoint"</code>
is only an approximate method for computing the (log-) likelihood.
Using <code>method="interpolation"</code>
may produce a jump in the profile likelihood as it changes computational regimes.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level for the computation of the nominal
confidence interval.
The default is <code>conf.level=0.95</code>.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_phi.method">phi.method</code></td>
<td>
<p>the method for estimating <code>phi</code>,
one of
<code>"saddlepoint"</code>
or
<code>"mle"</code>.
A maximum likelihood estimate is used unless
<code>method="saddlepoint"</code>,
when the saddlepoint approximation method is used.
Note that using 
<code>phi.method="saddlepoint"</code>
is equivalent to using the mean deviance estimator of <code>phi</code>.
</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_verbose">verbose</code></td>
<td>
<p>the amount of feedback requested:
<code>0</code> or <code>FALSE</code> means minimal feedback (the default), 
<code>1</code> or <code>TRUE</code> means some feedback,
or <code>2</code> means to show all feedback.
Since the function can be slow and sometimes problematic,
feedback can be good;
but it can also be unnecessary when one knows all is well.</p>
</td></tr>
<tr><td><code id="tweedie.profile_+3A_add0">add0</code></td>
<td>
<p>if <code>TRUE</code>, the value <code>p=0</code> is used in forming the profile log-likelihood
(corresponding to the normal distribution);
the default value is <code>add0=FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each value in <code>p.vec</code>,
the function computes an estimate of <code>phi</code>
and then computes the value of the log-likelihood for these parameters.
The plot of the log-likelihood against <code>p.vec</code> 
allows the maximum likelihood value of <code>p</code>
to be found.
Once the value of <code>p</code> is found,
the distribution within the class of Tweedie distribution is identified.
</p>


<h3>Value</h3>

<p>The main purpose of the function is to estimate the value
of the Tweedie index parameter, <code class="reqn">p</code>,
which is produced by the output list as <code>p.max</code>.
Optionally (if <code>do.plot=TRUE</code>),
a plot is produced that shows the profile log-likelihood
computed at each value in <code>p.vec</code>
(smoothed if <code>do.smooth=TRUE</code>).
This function can be temperamental 
(for theoretical reasons involved in numerically computing the density),
and this plot shows the values of <code class="reqn">p</code> requested on the
horizontal axis (using <code><a href="graphics.html#topic+rug">rug</a></code>); 
there may be fewer points on the plot,
since the likelihood some values of <code class="reqn">p</code> requested
may have returned <code>NaN</code>, <code>Inf</code> or <code>NA</code>.
</p>
<p>A list containing the components:
<code>y</code> and <code>x</code>
(such that <code>plot(x,y)</code> (partially)
recreates the profile likelihood plot);
<code>ht</code> (the height of the nominal confidence interval);
<code>L</code> (the estimate of the (log-) likelihood at each given value of <code>p</code>);
<code>p</code> (the <code>p</code>-values used);
<code>phi</code> (the computed values of <code>phi</code> at the values in <code>p</code>);
<code>p.max</code> (the estimate of the mle of <code>p</code>);
<code>L.max</code> (the estimate of the (log-) likelihood at <code>p.max</code>);
<code>phi.max</code> (the estimate of <code>phi</code> at <code>p.max</code>);
<code>ci</code> (the lower and upper limits of the confidence interval for <code>p</code>);
<code>method</code> (the method used for estimation: <code>series</code>, <code>inversion</code>, 
<code>interpolation</code> or <code>saddlepoint</code>);
<code>phi.method</code> (the method used for estimation of <code>phi</code>:
<code>saddlepoint</code> or <code>phi</code>).
</p>
<p>If <code>glm.fit</code> is <code>TRUE</code>,
the list also contains a component <code>glm.obj</code>,
a <code>glm</code> object  for the fitted Tweedie generalized linear model.
</p>


<h3>Note</h3>

<p>The estimates of <code>p</code>
and <code>phi</code> are printed.
The result is printed invisibly.
</p>
<p>If the response variable has any exact zeros,
the values in <code>p.vec</code>
must all be between one and two.
</p>
<p>The function is sometimes unstable and may fail.
It may also be very slow.
One solution is to change the method.
The default is <code>method="inversion"</code> (the default);
then try <code>method="series"</code>,
<code>method="interpolation"</code>
and
<code>method="saddlepoint"</code>
in that order.
Note that 
<code>method="saddlepoint"</code>
is an approximate method only.
Also make sure the values in <code>p.vec</code>
are suitable for the data  
(see above paragraph).
</p>
<p>It is recommended that for the first use with a data set,
use <code>p.vec</code> with only a small number of values
and set
<code>do.smooth=FALSE</code>,
<code>do.ci=FALSE</code>.
If this is successful,
a larger vector <code>p.vec</code>
and smoothing can be used.
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)
</p>


<h3>References</h3>

<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73&ndash;86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267&ndash;280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2001).
Tweedie family densities: methods of evaluation.
<em>Proceedings of the 16th International Workshop on Statistical Modelling</em>,
Odense, Denmark, 2&ndash;6 July
</p>
<p>Jorgensen, B. (1987).
Exponential dispersion models.
<em>Journal of the Royal Statistical Society</em>, B,
<b>49</b>, 127&ndash;162.
</p>
<p>Jorgensen, B. (1997).
<em>Theory of Dispersion Models</em>.
Chapman and Hall, London.
</p>
<p>Nelder, J. A. and Pregibon, D. (1987).
An extended quasi-likelihood function.
<em>Biometrika</em>
<b>74</b>(2),
221&ndash;232.
doi: <a href="https://doi.org/10.1093/biomet/74.2.221">10.1093/biomet/74.2.221</a>
</p>
<p>Tweedie, M. C. K. (1984).
An index which distinguishes between some important exponential families.
<em>Statistics: Applications and New Directions.
Proceedings of the Indian Statistical Institute Golden Jubilee International Conference</em>
(Eds. J. K. Ghosh and J. Roy), pp. 579-604. Calcutta: Indian Statistical Institute.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dtweedie">dtweedie</a></code>,
<code><a href="#topic+dtweedie.saddle">dtweedie.saddle</a></code>,
<code><a href="statmod.html#topic+tweedie">tweedie</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(statmod) # Needed to use  tweedie.profile
# Generate some fictitious data
test.data &lt;- rgamma(n=200, scale=1, shape=1)
# The gamma is a Tweedie distribution with power=2;
# let's see if p=2 is suggested by  tweedie.profile:
## Not run: 
	out &lt;- tweedie.profile( test.data ~ 1, 
		p.vec=seq(1.5, 2.5, by=0.2) )
	out$p.max
	out$ci

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
