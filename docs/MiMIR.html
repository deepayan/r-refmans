<!DOCTYPE html><html><head><title>Help for package MiMIR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MiMIR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acc_LOBOV'><p>acc_LOBOV</p></a></li>
<li><a href='#activateButtn'><p>activateButtn</p></a></li>
<li><a href='#Ahola_Olli_betas'><p>T2D-score Betas</p></a></li>
<li><a href='#apply.fit'><p>apply.fit</p></a></li>
<li><a href='#apply.fit_surro'><p>apply.fit_surro</p></a></li>
<li><a href='#apply.scale'><p>apply.scale</p></a></li>
<li><a href='#BBMRI_hist'><p>BBMRI_hist</p></a></li>
<li><a href='#BBMRI_hist_plot'><p>multi_hist</p></a></li>
<li><a href='#BBMRI_hist_scaled'><p>BBMRI_hist_scaled</p></a></li>
<li><a href='#binarize_all_pheno'><p>binarize_all_pheno</p></a></li>
<li><a href='#BMI_LDL_eGFR'><p>BMI_LDL_eGFR</p></a></li>
<li><a href='#c21'><p>c21</p></a></li>
<li><a href='#calculate_surrogate_scores'><p>calculate_surrogate_scores</p></a></li>
<li><a href='#calib_data_frame'><p>calib_data_frame</p></a></li>
<li><a href='#calibration_surro'><p>calibration_surro</p></a></li>
<li><a href='#comp_covid_score'><p>comp_covid_score</p></a></li>
<li><a href='#comp.CVD_score'><p>comp.CVD_score</p></a></li>
<li><a href='#comp.mort_score'><p>comp.mort_score</p></a></li>
<li><a href='#comp.T2D_Ahola_Olli'><p>comp.T2D_Ahola_Olli</p></a></li>
<li><a href='#cor_assoc'><p>cor_assoc</p></a></li>
<li><a href='#covid_betas'><p>COVID-score betas</p></a></li>
<li><a href='#CVD_score_betas'><p>CVD-score betas</p></a></li>
<li><a href='#do_metabowas'><p>Helper function to compute MetaboWASs</p></a></li>
<li><a href='#find_BBMRI_names'><p>find_BBMRI_names</p></a></li>
<li><a href='#get.p'><p>get.p</p></a></li>
<li><a href='#get.s'><p>get.s</p></a></li>
<li><a href='#getECE'><p>getECE</p></a></li>
<li><a href='#getMCE'><p>helper function to calculate the MCE of the calibrations</p></a></li>
<li><a href='#getvol'><p>getvol</p></a></li>
<li><a href='#hist_plots'><p>hist_plots</p></a></li>
<li><a href='#hist_plots_mortality'><p>hist_plots_mortality</p></a></li>
<li><a href='#impute_miss'><p>impute_miss</p></a></li>
<li><a href='#is.sym'><p>is.sym</p></a></li>
<li><a href='#kapmeier_scores'><p>kapmeier_scores</p></a></li>
<li><a href='#loading'><p>withSpinner</p></a></li>
<li><a href='#loading_spin'><p>loading_spin</p></a></li>
<li><a href='#LOBOV_accuracies'><p>LOBOV_accuracies</p></a></li>
<li><a href='#metabo_names_translator'><p>metabolomics feature nomenclatures</p></a></li>
<li><a href='#metabolites_subsets'><p>metabolomics feature subsets</p></a></li>
<li><a href='#MetaboWAS'><p>MetaboWAS</p></a></li>
<li><a href='#model_coeff_heat'><p>model_coeff_heat</p></a></li>
<li><a href='#MOLEPI_LCBC_header'><p>MOLEPI_LCBC_header</p></a></li>
<li><a href='#mort_betas'><p>Mortality score betas</p></a></li>
<li><a href='#multi_hist'><p>multi_hist</p></a></li>
<li><a href='#NA_message'><p>NA_message</p></a></li>
<li><a href='#PARAM_metaboAge'><p>PARAMETERS MetaboAge</p></a></li>
<li><a href='#PARAM_surrogates'><p>PARAMETERS surrogates</p></a></li>
<li><a href='#pheno_barplots'><p>pheno_barplots</p></a></li>
<li><a href='#phenotypes_names'><p>phenotypic features names</p></a></li>
<li><a href='#plattCalib_evaluation'><p>Function that plots the Platt Calibrations using plotly</p></a></li>
<li><a href='#plattCalibration'><p>plattCalibration</p></a></li>
<li><a href='#plot_corply'><p>plot_corply</p></a></li>
<li><a href='#plot_na_heatmap'><p>plot_na_heatmap</p></a></li>
<li><a href='#plotly_NA_message'><p>plotly_NA_message</p></a></li>
<li><a href='#predictions_surrogates'><p>predictions_surrogates</p></a></li>
<li><a href='#prep_data_COVID_score'><p>prep_data_COVID_score</p></a></li>
<li><a href='#prep_met_for_scores'><p>prep_met_for_scores</p></a></li>
<li><a href='#QCprep'><p>QCprep</p></a></li>
<li><a href='#QCprep_surrogates'><p>QCprep_surrogates</p></a></li>
<li><a href='#rendertable'><p>rendertable</p></a></li>
<li><a href='#report.dim'><p>report.dim</p></a></li>
<li><a href='#resort.on.p'><p>resort.on.p</p></a></li>
<li><a href='#resort.on.s'><p>resort.on.s</p></a></li>
<li><a href='#roc_surro'><p>roc_surro</p></a></li>
<li><a href='#roc_surro_subplots'><p>roc_surro_subplots</p></a></li>
<li><a href='#scatterplot_predictions'><p>scatterplot_predictions</p></a></li>
<li><a href='#startApp'><p>startMiMIR</p></a></li>
<li><a href='#subset_metabolites_overlap'><p>subset_metabolites_overlap</p></a></li>
<li><a href='#subset_samples_miss'><p>subset_samples_miss</p></a></li>
<li><a href='#subset_samples_sd'><p>subset_samples_sd</p></a></li>
<li><a href='#subset_samples_sd_surrogates'><p>subset_samples_sd_surrogates</p></a></li>
<li><a href='#subset_samples_zero'><p>subset_samples_miss</p></a></li>
<li><a href='#synthetic_metabolic_dataset'><p>synthetic metabolomics dataset</p></a></li>
<li><a href='#synthetic_phenotypic_dataset'><p>synthetic metabolomics dataset</p></a></li>
<li><a href='#ttest_scores'><p>ttest_scores</p></a></li>
<li><a href='#ttest_surrogates'><p>ttest_surrogates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Metabolomics-Based Models for Imputing Risk</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides an intuitive framework for ad-hoc statistical analysis of 1H-NMR metabolomics by Nightingale Health. It allows to easily explore new metabolomics measurements assayed by Nightingale Health, comparing the distributions with a large Consortium (BBMRI-nl); project previously published metabolic scores [&lt;<a href="https://doi.org/10.1016%2Fj.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>&gt;, &lt;<a href="https://doi.org/10.1161%2FCIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>&gt;, &lt;<a href="https://doi.org/10.1038%2Fs41467-019-11311-9">doi:10.1038/s41467-019-11311-9</a>&gt;, &lt;<a href="https://doi.org/10.7554%2FeLife.63033">doi:10.7554/eLife.63033</a>&gt;, &lt;<a href="https://doi.org/10.1161%2FCIRCULATIONAHA.114.013116">doi:10.1161/CIRCULATIONAHA.114.013116</a>&gt;, &lt;<a href="https://doi.org/10.1007%2Fs00125-019-05001-w">doi:10.1007/s00125-019-05001-w</a>&gt;]; and calibrate the metabolic surrogate values to a desired dataset.   </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>caret, DT, foreach, ggplot2, heatmaply, matrixStats, plotly,
pROC, purrr, shiny, shinycssloaders, shinyFiles,
shinydashboard, shinyjs, shinyWidgets, stats, survival,
survminer, dplyr, fs</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), ggfortify, knitr, rmarkdown</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-01 08:31:19 UTC; danielebizzarri</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniele Bizzarri <a href="https://orcid.org/0000-0002-6881-273X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Marcel Reinders <a href="https://orcid.org/0000-0002-1148-1562"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ths],
  Marian Beekman <a href="https://orcid.org/0000-0003-0585-6206"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Pieternella Eline Slagboom
    <a href="https://orcid.org/0000-0002-2875-4723"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, ths],
  Erik van den Akker
    <a href="https://orcid.org/0000-0002-7693-0728"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniele Bizzarri &lt;d.bizzarri@lumc.nl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-01 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='acc_LOBOV'>acc_LOBOV</h2><span id='topic+acc_LOBOV'></span>

<h3>Description</h3>

<p>Accuracy of the Leave One Biobank Out Validation of the surrogate metabolic-modesl performed in BBMRI-nl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("acc_LOBOV")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 20.
</p>


<h3>Details</h3>

<p>Dataframe containing the accuracy obtained during the Leave One Biobank Out Validation of the surrogate metabolic-modesl  in BBMRI-nl.
</p>


<h3>References</h3>

<p>The method is described in:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("acc_LOBOV")

</code></pre>

<hr>
<h2 id='activateButtn'>activateButtn</h2><span id='topic+activateButtn'></span>

<h3>Description</h3>

<p>helper function to activate buttons based on 2 checks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>activateButtn(check1, check2, button)
</code></pre>


<h3>Value</h3>

<p>button activation
</p>

<hr>
<h2 id='Ahola_Olli_betas'>T2D-score Betas</h2><span id='topic+Ahola_Olli_betas'></span>

<h3>Description</h3>

<p>The coefficients used to compute the T2Diabetes score by Ahola Olli.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Ahola_Olli_betas")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 7 rows and 3 columns.
</p>


<h3>Details</h3>

<p>Dataframe containing the abbreviation of the metabolites, the metabolites names and finally the Coefficients to compute the T2Diabetes score
</p>


<h3>References</h3>

<p>Ahola-Olli,A.V. et al. (2019) Circulating metabolites and the risk of type 2 diabetes: a prospective study of 11,896 young adults from four Finnish cohorts. Diabetologia, 62, 2298-2309, <a href="doi:10.1007/s00125-019-05001-w">doi:10.1007/s00125-019-05001-w</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Ahola_Olli_betas")

</code></pre>

<hr>
<h2 id='apply.fit'>apply.fit</h2><span id='topic+apply.fit'></span>

<h3>Description</h3>

<p>Function to compute the MetaboAge score made by van den Akker et al. on Nightingale metabolomics data-set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply.fit(mat, FIT)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply.fit_+3A_mat">mat</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="apply.fit_+3A_fit">FIT</code></td>
<td>
<p>The betas of the linear regression composing the MetaboAge by van den Akker et al.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multivariate model indicating the biological age of an individual, based on 56 metabolic features.
It was trained using a linear regression in BBMRI-nl, a Consortium of 28 cohorts comprising ~25,000 individuals.
</p>


<h3>Value</h3>

<p>data-frame containing the value of the MetaboAge by van den Akker et al.
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the metaboAge as described in:
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCULATIONAHA.114.013116">doi:10.1161/CIRCULATIONAHA.114.013116</a>
</p>


<h3>See Also</h3>

<p>QCprep, subset_metabolites_overlap, subset_samples_miss, subset_samples_zero, subset_samples_sd, impute_miss, apply.scale,report.dim
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
#Pre-process the metabolic features
prepped_met&lt;-QCprep(as.matrix(metabolic_measures[,metabolites_subsets$MET63]), PARAM_metaboAge)
#Apply the metaboAge
metaboAge&lt;-apply.fit(prepped_met, FIT=PARAM_metaboAge$FIT_COEF)

</code></pre>

<hr>
<h2 id='apply.fit_surro'>apply.fit_surro</h2><span id='topic+apply.fit_surro'></span>

<h3>Description</h3>

<p>Function that apply on of the surrogates models to the NH-metabolomics concentrations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply.fit_surro(mat, FIT, post = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply.fit_surro_+3A_mat">mat</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="apply.fit_surro_+3A_fit">FIT</code></td>
<td>
<p>The betas of the logistic regressions composing the surrogates by Bizzarri et al.</p>
</td></tr>
<tr><td><code id="apply.fit_surro_+3A_post">post</code></td>
<td>
<p>logical to obtain posterior probabilities</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bizzarri et al. built multivariate models,using 56 metabolic features quantified by Nightingale, to predict the 19 binary characteristics of an individual.
The binary variables are: sex, diabetes status, metabolic syndrome status, lipid medication usage, blood pressure lowering medication,
current smoking, alcohol consumption, high age, middle age, low age, high hsCRP, high triglycerides, high ldl cholesterol,
high total cholesterol, low hdl cholesterol, low eGFR, low white blood cells, low hemoglobin levels.
</p>


<h3>Value</h3>

<p>numeric data.frame with the metabolomics-based surrogates by Bizzarri et al.
</p>


<h3>References</h3>

<p>This function was made to vidualize the binarized variables calculated following the rules indicated in the article:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>See Also</h3>

<p>QCprep_surrogates, calculate_surrogate_scores, subset_samples_sd_surrogates, predictions_surrogates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
# Do the pre-processing steps to the metabolic measures
metabolic_measures&lt;-QCprep_surrogates(as.matrix(metabolic_measures), Nmax_miss=1,Nmax_zero=1)

#load the phenotypic dataset
phenotypes &lt;- read.csv("phenotypes_file_path",header = TRUE, row.names = 1)
#Calculating the binarized surrogates
bin_pheno&lt;-binarize_all_pheno(phenotypes)

#Apply the surrogate models
surrogates&lt;-foreach::foreach(i=MiMIR::phenotypes_names$out_surro, .combine="cbind") %do% {
pred&lt;-apply.fit_surro(as.matrix(metabo_measures), 
PARAM_surrogates$models_betas[i,])}


## End(Not run)

</code></pre>

<hr>
<h2 id='apply.scale'>apply.scale</h2><span id='topic+apply.scale'></span>

<h3>Description</h3>

<p>Helper function created to scale the NH-metabolomics matrix samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply.scale(dat, MEAN, SD, quiet = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply.scale_+3A_dat">dat</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="apply.scale_+3A_mean">MEAN</code></td>
<td>
<p>numeric vector indicating the mean of the metabolites present in dat</p>
</td></tr>
<tr><td><code id="apply.scale_+3A_sd">SD</code></td>
<td>
<p>numeric vector indicating the standard deviations of the metabolites present in dat</p>
</td></tr>
<tr><td><code id="apply.scale_+3A_quiet">quiet</code></td>
<td>
<p>Tlogical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The matrix z-scaling the Nightingale-metabolomics dataset using the given Means and SDs
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the metaboAge as described in:
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>
</p>


<h3>See Also</h3>

<p>QCprep, apply.fit, subset_metabolites_overlap, subset_samples_miss, subset_samples_zero, subset_samples_sd, impute_miss, and report.dim
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
#Apply the scaling to the metabolic features
mat &lt;- apply.scale(metabolic_measures, MEAN=PARAM_metaboAge$MEAN, SD=PARAM_metaboAge$SD)

## End(Not run)

</code></pre>

<hr>
<h2 id='BBMRI_hist'>BBMRI_hist</h2><span id='topic+BBMRI_hist'></span>

<h3>Description</h3>

<p>Distributions of the Nightingale Health metabolic features in BBMRI-nl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("BBMRI_hist")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 57.
</p>


<h3>Details</h3>

<p>List containing the histograms of the metabolomics-features in BBMRI-nl.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("BBMRI_hist")

</code></pre>

<hr>
<h2 id='BBMRI_hist_plot'>multi_hist</h2><span id='topic+BBMRI_hist_plot'></span>

<h3>Description</h3>

<p>Function to plot the ~60 metabolites used for the metabolomics-based scores and compare them to to their distributions in BBMRI-nl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BBMRI_hist_plot(
  dat,
  x_name,
  color = MiMIR::c21,
  scaled = FALSE,
  datatype = "metabolite",
  main = "Comparison with the metabolites measures in BBMRI"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BBMRI_hist_plot_+3A_dat">dat</code></td>
<td>
<p>data.frame or matrix with the metabolites</p>
</td></tr>
<tr><td><code id="BBMRI_hist_plot_+3A_x_name">x_name</code></td>
<td>
<p>string with the name of the selected variable</p>
</td></tr>
<tr><td><code id="BBMRI_hist_plot_+3A_color">color</code></td>
<td>
<p>colors selected for all the variables</p>
</td></tr>
<tr><td><code id="BBMRI_hist_plot_+3A_scaled">scaled</code></td>
<td>
<p>logical to z-scale the variables</p>
</td></tr>
<tr><td><code id="BBMRI_hist_plot_+3A_datatype">datatype</code></td>
<td>
<p>a character vector indicating what data type is being plotted</p>
</td></tr>
<tr><td><code id="BBMRI_hist_plot_+3A_main">main</code></td>
<td>
<p>title of the plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the distribution of a metabolic feature in the uploaded dataset, compared to their distributions in BBMRI-nl.
The selection of features available is done following the metabolic scores features.
</p>


<h3>Value</h3>

<p>plotly image with the histogram of the selected variable compared to the distributions in BBMRI-nl
</p>


<h3>References</h3>

<p>The selection of metabolic features available is the one selected by the papers:
Deelen,J. et al. (2019) A metabolic profile of all-cause mortality risk identified in an observational study of 44,168 individuals. Nature Communications, 10, 1-8, <a href="doi:10.1038/s41467-019-11311-9">doi:10.1038/s41467-019-11311-9</a>
Ahola-Olli,A.V. et al. (2019) Circulating metabolites and the risk of type 2 diabetes: a prospective study of 11,896 young adults from four Finnish cohorts. Diabetologia, 62, 2298-2309, <a href="doi:10.1007/s00125-019-05001-w">doi:10.1007/s00125-019-05001-w</a>
Wurtz,P. et al. (2015) Metabolite profiling and cardiovascular event risk: a prospective study of 3 population-based cohorts. Circulation, 131, 774-785, <a href="doi:10.1161/CIRCULATIONAHA.114.013116">doi:10.1161/CIRCULATIONAHA.114.013116</a>
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(plotly)
library(MiMIR)

#load the metabolites dataset
metabolic_measures &lt;- synthetic_metabolic_dataset

BBMRI_hist_plot(metabolic_measures, x_name="alb", scaled=TRUE)

</code></pre>

<hr>
<h2 id='BBMRI_hist_scaled'>BBMRI_hist_scaled</h2><span id='topic+BBMRI_hist_scaled'></span>

<h3>Description</h3>

<p>Z-scaled distributions of the Nightingale Health metabolic features in BBMRI-nl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("BBMRI_hist_scaled")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 57.
</p>


<h3>Details</h3>

<p>List containing the histograms of the scaled metabolomics-features in BBMRI-nl.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("BBMRI_hist_scaled")

</code></pre>

<hr>
<h2 id='binarize_all_pheno'>binarize_all_pheno</h2><span id='topic+binarize_all_pheno'></span>

<h3>Description</h3>

<p>Helper function created to binarize the phenotypes used to calculate the metabolomics based surrogate made by Bizzarri et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binarize_all_pheno(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binarize_all_pheno_+3A_data">data</code></td>
<td>
<p>phenotypes data.frame containing some of the following variables (with the same namenclature):
&quot;sex&quot;,&quot;diabetes&quot;, &quot;lipidmed&quot;,  &quot;blood_pressure_lowering_med&quot;, &quot;current_smoking&quot;,
&quot;metabolic_syndrome&quot;, &quot;alcohol_consumption&quot;, &quot;age&quot;,&quot;BMI&quot;, &quot;ln_hscrp&quot;,&quot;waist_circumference&quot;,
&quot;weight&quot;,&quot;height&quot;, &quot;triglycerides&quot;, &quot;ldl_chol&quot;, &quot;hdlchol&quot;, &quot;totchol&quot;, &quot;eGFR&quot;,&quot;wbc&quot;,&quot;hgb&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bizzarri et al. built multivariate models,using 56 metabolic features quantified by Nightingale, to predict the 19 binary characteristics of an individual.
The binary variables are: sex, diabetes status, metabolic syndrome status, lipid medication usage, blood pressure lowering medication,
current smoking, alcohol consumption, high age, middle age, low age, high hsCRP, high triglycerides, high ldl cholesterol,
high total cholesterol, low hdl cholesterol, low eGFR, low white blood cells, low hemoglobin levels.
</p>


<h3>Value</h3>

<p>The phenotypic variables binarized following the thresholds in in the metabolomics surrogates made by by Bizzarri et al.
</p>


<h3>References</h3>

<p>This function was made to binarize the variables following the same rules indicated in the article:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>See Also</h3>

<p>pheno_barplots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)

#load the phenotypes dataset
phenotypes &lt;- synthetic_phenotypic_dataset
#Calculate BMI, LDL cholesterol and eGFR
binarized_phenotypes&lt;-binarize_all_pheno(phenotypes)

</code></pre>

<hr>
<h2 id='BMI_LDL_eGFR'>BMI_LDL_eGFR</h2><span id='topic+BMI_LDL_eGFR'></span>

<h3>Description</h3>

<p>#' Function created to calculate: 1) BMI using height and weight; 2) LDL cholesterol using HDL cholesterol, triglycerides, totchol;
3) eGFR creatinine levels, sex and age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BMI_LDL_eGFR(phenotypes, metabo_measures)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BMI_LDL_eGFR_+3A_phenotypes">phenotypes</code></td>
<td>
<p>data.frame containing height and weight, HDL cholesterol, triglycerides, totchol, sex and age</p>
</td></tr>
<tr><td><code id="BMI_LDL_eGFR_+3A_metabo_measures">metabo_measures</code></td>
<td>
<p>numeric data-frame with Nightingale metabolomics quantifications containing creatinine levels (crea)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>phenotypes data.frame with the addition of BMI, LDL cholesterol and eGFR
</p>


<h3>References</h3>

<p>This function is constructed to calculate BMI, LDL cholesterol and eGFR as in the following papers:
</p>
<p>BMI: Flint AJ, Rexrode KM, Hu FB, Glynn RJ, Caspard H, Manson JE et al. Body mass index, waist circumference, and risk of coronary heart disease: a prospective study among men and women. Obes Res Clin Pract 2010; 4: e171-e181, <a href="doi:10.1016/j.orcp.2010.01.001">doi:10.1016/j.orcp.2010.01.001</a>
</p>
<p>LDL-cholesterol: Friedewald WT, Levy RI, Fredrickson DS. Estimation of the Concentration of Low-Density Lipoprotein Cholesterol in Plasma, Without Use of the Preparative Ultracentrifuge. Clin Chem 1972; 18: 499-502, &lt;doi.org/10.1093/clinchem/18.6.499&gt;
</p>
<p>eGFR: Carrero Juan Jesus, Andersson Franko Mikael, Obergfell Achim, Gabrielsen Anders, Jernberg Tomas. hsCRP Level and the Risk of Death or Recurrent Cardiovascular Events in Patients With Myocardial Infarction: a Healthcare-Based Study. J Am Heart Assoc 2019; 8: e012638, &lt;doi: 10.1161/JAHA.119.012638&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)

#load the dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
phenotypes &lt;- synthetic_phenotypic_dataset
#Calculate BMI, LDL cholesterol and eGFR
phenotypes&lt;-BMI_LDL_eGFR(phenotypes, metabolic_measures)

</code></pre>

<hr>
<h2 id='c21'>c21</h2><span id='topic+c21'></span>

<h3>Description</h3>

<p>Colors attributed to each metabolomics-based model in MiMIR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("c21")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 21.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("c21")

</code></pre>

<hr>
<h2 id='calculate_surrogate_scores'>calculate_surrogate_scores</h2><span id='topic+calculate_surrogate_scores'></span>

<h3>Description</h3>

<p>Function to compute the surrogate scores by Bizzarri et al. from  the Nightingale metabolomics matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_surrogate_scores(
  met,
  pheno,
  PARAM_surrogates,
  bin_names = c("sex", "diabetes"),
  Nmax_miss = 1,
  Nmax_zero = 1,
  post = TRUE,
  roc = FALSE,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_surrogate_scores_+3A_met">met</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="calculate_surrogate_scores_+3A_pheno">pheno</code></td>
<td>
<p>phenotypic data.frame including this clinical variables (with the same nomenclature): &quot;sex&quot;,&quot;diabetes&quot;, &quot;lipidmed&quot;,  &quot;blood_pressure_lowering_med&quot;, &quot;current_smoking&quot;,
&quot;metabolic_syndrome&quot;, &quot;alcohol_consumption&quot;, &quot;age&quot;,&quot;BMI&quot;, &quot;ln_hscrp&quot;,&quot;waist_circumference&quot;,
&quot;weight&quot;,&quot;height&quot;, &quot;triglycerides&quot;, &quot;ldl_chol&quot;, &quot;hdlchol&quot;, &quot;totchol&quot;, &quot;eGFR&quot;,&quot;wbc&quot;,&quot;hgb&quot;</p>
</td></tr>
<tr><td><code id="calculate_surrogate_scores_+3A_param_surrogates">PARAM_surrogates</code></td>
<td>
<p>list containing the parameters to compute the metabolomics-based surrogates</p>
</td></tr>
<tr><td><code id="calculate_surrogate_scores_+3A_bin_names">bin_names</code></td>
<td>
<p>vector of strings containing the names of the binary variables</p>
</td></tr>
<tr><td><code id="calculate_surrogate_scores_+3A_nmax_miss">Nmax_miss</code></td>
<td>
<p>numeric value indicating the maximum number of missing values allowed per sample (Number suggested=1)</p>
</td></tr>
<tr><td><code id="calculate_surrogate_scores_+3A_nmax_zero">Nmax_zero</code></td>
<td>
<p>numeric value indicating the maximum number of zeros allowed per sample (Number suggested=1)</p>
</td></tr>
<tr><td><code id="calculate_surrogate_scores_+3A_post">post</code></td>
<td>
<p>logical to indicate if the function should calculate the posterior probabilities</p>
</td></tr>
<tr><td><code id="calculate_surrogate_scores_+3A_roc">roc</code></td>
<td>
<p>logical to plot ROC curves for the metabolomics surrogate (available only for the phenotypes included)</p>
</td></tr>
<tr><td><code id="calculate_surrogate_scores_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bizzarri et al. built multivariate models,using 56 metabolic features quantified by Nightingale, to predict the 19 binary characteristics of an individual.
The binary variables are: sex, diabetes status, metabolic syndrome status, lipid medication usage, blood pressure lowering medication,
current smoking, alcohol consumption, high age, middle age, low age, high hsCRP, high triglycerides, high ldl cholesterol,
high total cholesterol, low hdl cholesterol, low eGFR, low white blood cells, low hemoglobin levels.
</p>


<h3>Value</h3>

<p>if pheno is not available: list with the surrogates and the Nightingale metabolomics matrix after QC.
if pheno is available: list with the surrogates, ROC curves, phenotypes, binarized phenotypes and the Nightingale metabolomics matrix after QC,
</p>


<h3>References</h3>

<p>This function was made to vidualize the binarized variables calculated following the rules indicated in the article:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>See Also</h3>

<p>QCprep_surrogates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(MiMIR)
require(foreach)
require(pROC)
require(foreach)

#load dataset
m &lt;- synthetic_metabolic_dataset
p &lt;- synthetic_phenotypic_dataset
#Apply the surrogates
sur&lt;-calculate_surrogate_scores(met=m,pheno=p,MiMIR::PARAM_surrogates,bin_names=c("sex","diabetes"))

</code></pre>

<hr>
<h2 id='calib_data_frame'>calib_data_frame</h2><span id='topic+calib_data_frame'></span>

<h3>Description</h3>

<p>helper function that creates a data.frame with the Platt Calibrations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calib_data_frame(calibrations, bin_phenotypes, bin_pheno_available)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calib_data_frame_+3A_calibrations">calibrations</code></td>
<td>
<p>list result of calibration_surro</p>
</td></tr>
<tr><td><code id="calib_data_frame_+3A_bin_phenotypes">bin_phenotypes</code></td>
<td>
<p>data.frame with binary phenotypes resulting form binarize_all_pheno</p>
</td></tr>
<tr><td><code id="calib_data_frame_+3A_bin_pheno_available">bin_pheno_available</code></td>
<td>
<p>string with the names of the binarize clinical variables available in the dataset</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with the calibrated surrogates
</p>

<hr>
<h2 id='calibration_surro'>calibration_surro</h2><span id='topic+calibration_surro'></span>

<h3>Description</h3>

<p>helper function that calculates the Platt Calibrations  for all the surrogates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibration_surro(
  bin_phenotypes,
  surrogates,
  bin_names,
  bin_pheno_available,
  pl = FALSE,
  nbins = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibration_surro_+3A_bin_phenotypes">bin_phenotypes</code></td>
<td>
<p>data.frame with binary phenotypes resulting form binarize_all_pheno</p>
</td></tr>
<tr><td><code id="calibration_surro_+3A_surrogates">surrogates</code></td>
<td>
<p>data.frame with surrogates resulting from calculate_surrogate_scores</p>
</td></tr>
<tr><td><code id="calibration_surro_+3A_bin_names">bin_names</code></td>
<td>
<p>string with the names of the binarize clinical variables</p>
</td></tr>
<tr><td><code id="calibration_surro_+3A_bin_pheno_available">bin_pheno_available</code></td>
<td>
<p>string with the names of the binarize clinical variables available in the dataset</p>
</td></tr>
<tr><td><code id="calibration_surro_+3A_pl">pl</code></td>
<td>
<p>TRUE/FALSE. If TRUE creates the calibration plots</p>
</td></tr>
<tr><td><code id="calibration_surro_+3A_nbins">nbins</code></td>
<td>
<p>number of bins for the plots</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the calibrated surrogates
</p>


<h3>See Also</h3>

<p>plattCalibration
</p>

<hr>
<h2 id='comp_covid_score'>comp_covid_score</h2><span id='topic+comp_covid_score'></span>

<h3>Description</h3>

<p>Function to compute the COVID severity score made by Nightingale Health UK Biobank Initiative et al. on Nightingale metabolomics data-set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp_covid_score(dat, betas = MiMIR::covid_betas, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comp_covid_score_+3A_dat">dat</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="comp_covid_score_+3A_betas">betas</code></td>
<td>
<p>data.frame containing the coefficients used for the regression of the COVID-score</p>
</td></tr>
<tr><td><code id="comp_covid_score_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multivariate model predicting the risk of severe COVID-19 infection.
It is based on 37 metabolic features and trained using LASSO regression on 52,573 samples from the UK-biobanks.
</p>


<h3>Value</h3>

<p>data-frame containing the value of the COVID-score on the uploaded data-set
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the COVID-score as described in:
Nightingale Health UK Biobank Initiative et al. (2021) Metabolic biomarker profiling for identification of susceptibility to severe pneumonia and COVID-19 in the general population. eLife, 10, e63033, <a href="doi:10.7554/eLife.63033">doi:10.7554/eLife.63033</a>
</p>


<h3>See Also</h3>

<p>prep_data_COVID_score, covid_betas, comp.mort_score
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- synthetic_metabolic_dataset

#Compute the mortality score
mortScore&lt;-comp_covid_score(dat=metabolic_measures, quiet=TRUE)

</code></pre>

<hr>
<h2 id='comp.CVD_score'>comp.CVD_score</h2><span id='topic+comp.CVD_score'></span>

<h3>Description</h3>

<p>Function to compute CVD-score made by Peter Wurtz et al. made by Deelen et al. on Nightingale metabolomics data-set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.CVD_score(met, phen, betas, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comp.CVD_score_+3A_met">met</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="comp.CVD_score_+3A_phen">phen</code></td>
<td>
<p>data-frame containing phenotypic information of the samples (specifically: sex, systolic_blood_pressure, current_smoking, diabetes, blood_pressure_lowering_med, lipidmed, totchol, and hdlchol)</p>
</td></tr>
<tr><td><code id="comp.CVD_score_+3A_betas">betas</code></td>
<td>
<p>The betas of the linear regression composing the CVD-score</p>
</td></tr>
<tr><td><code id="comp.CVD_score_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data-frame containing the value of the CVD-score on the uploaded data-set
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the CVD-score as described in:
Wurtz,P. et al. (2015) Metabolite profiling and cardiovascular event risk: a prospective study of 3 population-based cohorts. Circulation, 131, 774-785, <a href="doi:10.1161/CIRCULATIONAHA.114.013116">doi:10.1161/CIRCULATIONAHA.114.013116</a>
</p>


<h3>See Also</h3>

<p>prep_met_for_scores, CVD_score_betas, comp.T2D_Ahola_Olli, comp.mort_score
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)

#load the dataset
met &lt;- synthetic_metabolic_dataset
phen&lt;-synthetic_phenotypic_dataset
#Prepare the metabolic features fo the mortality score
CVDscore&lt;-comp.CVD_score(met= met, phen=phen, betas=MiMIR::CVD_score_betas, quiet=TRUE)


</code></pre>

<hr>
<h2 id='comp.mort_score'>comp.mort_score</h2><span id='topic+comp.mort_score'></span>

<h3>Description</h3>

<p>Function to compute the mortality score made by Deelen et al. on Nightingale metabolomics data-set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.mort_score(dat, betas = mort_betas, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comp.mort_score_+3A_dat">dat</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="comp.mort_score_+3A_betas">betas</code></td>
<td>
<p>data.frame containing the coefficients used for the regression of the mortality score</p>
</td></tr>
<tr><td><code id="comp.mort_score_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This multivariate model predicts all-cause mortality at 5 or 10 years better than clinical variables normally associated with mortality.
It is constituted of 14 metabolic features quantified by Nightingale Health.
It was originally trained using a stepwise Cox regression analysis in a meta-analysis on 12 cohorts composed by 44,168 individuals.
</p>


<h3>Value</h3>

<p>data-frame containing the value of the mortality score on the uploaded data-set
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the mortality score as described in:
Deelen,J. et al. (2019) A metabolic profile of all-cause mortality risk identified in an observational study of 44,168 individuals. Nature Communications, 10, 1-8, <a href="doi:10.1038/s41467-019-11311-9">doi:10.1038/s41467-019-11311-9</a>
</p>


<h3>See Also</h3>

<p>prep_met_for_scores, mort_betas, comp.T2D_Ahola_Olli, comp.CVD_score
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
#Prepare the metabolic features fo the mortality score
mortScore&lt;-comp.mort_score(metabolic_measures,quiet=TRUE)

</code></pre>

<hr>
<h2 id='comp.T2D_Ahola_Olli'>comp.T2D_Ahola_Olli</h2><span id='topic+comp.T2D_Ahola_Olli'></span>

<h3>Description</h3>

<p>Function to compute the T2D score made by Ahola Olli et al. on Nightingale metabolomics data-set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp.T2D_Ahola_Olli(met, phen, betas, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comp.T2D_Ahola_Olli_+3A_met">met</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="comp.T2D_Ahola_Olli_+3A_phen">phen</code></td>
<td>
<p>data-frame containing phenotypic information of the samples (in particular: sex, age, BMI and the clinically measured glucose)</p>
</td></tr>
<tr><td><code id="comp.T2D_Ahola_Olli_+3A_betas">betas</code></td>
<td>
<p>The betas of the linear regression composing the T2D-score</p>
</td></tr>
<tr><td><code id="comp.T2D_Ahola_Olli_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This metabolomics-based score is associated with incident Type 2 Diabetes, made by Ahola-Olli et al.
It is constructed using phe, l_vldl_ce_percentage and l_hdl_fc quantified by Nightingale Health,
and some phenotypic information: sex, age, BMI, fasting glucose.
It was trained using a stepwise logistic regression on 3 cohorts.
</p>


<h3>Value</h3>

<p>data-frame containing the value of the T2D-score on the uploaded data-set
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the T2D-score as described in:
Ahola-Olli,A.V. et al. (2019) Circulating metabolites and the risk of type 2 diabetes: a prospective study of 11,896 young adults from four Finnish cohorts. Diabetologia, 62, 2298-2309, <a href="doi:10.1007/s00125-019-05001-w">doi:10.1007/s00125-019-05001-w</a>
</p>


<h3>See Also</h3>

<p>prep_met_for_scores, Ahola_Olli_betas, comp.mort_score, comp.CVD_score
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)

#load the dataset
met &lt;- synthetic_metabolic_dataset
phen&lt;-synthetic_phenotypic_dataset
#Prepare the metabolic features fo the mortality score
T2Dscore&lt;-comp.T2D_Ahola_Olli(met= met, phen=phen,betas=MiMIR::Ahola_Olli_betas, quiet=TRUE)

</code></pre>

<hr>
<h2 id='cor_assoc'>cor_assoc</h2><span id='topic+cor_assoc'></span>

<h3>Description</h3>

<p>Function to calulate the correlation between 2 matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor_assoc(dat1, dat2, feat1, feat2, method = "pearson", quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor_assoc_+3A_dat1">dat1</code></td>
<td>
<p>matrix 1</p>
</td></tr>
<tr><td><code id="cor_assoc_+3A_dat2">dat2</code></td>
<td>
<p>matrix 2</p>
</td></tr>
<tr><td><code id="cor_assoc_+3A_feat1">feat1</code></td>
<td>
<p>vector of strings with the names of the selected variables in dat</p>
</td></tr>
<tr><td><code id="cor_assoc_+3A_feat2">feat2</code></td>
<td>
<p>vector if strings with the names of the selected variables in dat2</p>
</td></tr>
<tr><td><code id="cor_assoc_+3A_method">method</code></td>
<td>
<p>indicates which methods of the correlation to use</p>
</td></tr>
<tr><td><code id="cor_assoc_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Value</h3>

<p>correlations of the selected variables in the 2 martrices
</p>


<h3>See Also</h3>

<p>plot_corply
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)

#load the dataset
m &lt;- as.matrix(synthetic_metabolic_dataset)

#Compute the pearson correlation of all the variables in the data.frame metabolic_measures
cors&lt;-cor_assoc(m, m, MiMIR::metabolites_subsets$MET63,MiMIR::metabolites_subsets$MET63)

</code></pre>

<hr>
<h2 id='covid_betas'>COVID-score betas</h2><span id='topic+covid_betas'></span>

<h3>Description</h3>

<p>The coefficients used to compute the COVID score by Nightingale Health UK Biobank Initiative et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("covid_betas")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 25 rows and 3 columns.
</p>


<h3>Details</h3>

<p>Dataframe containing the abbreviation of the metabolites, the metabolites names and finally the Coefficients to compute the COVID score
</p>


<h3>References</h3>

<p>Nightingale Health UK Biobank Initiative et al. (2021) Metabolic biomarker profiling for identification of susceptibility to severe pneumonia and COVID-19 in the general population. eLife, 10, e63033, <a href="doi:10.7554/eLife.63033">doi:10.7554/eLife.63033</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("covid_betas")

</code></pre>

<hr>
<h2 id='CVD_score_betas'>CVD-score betas</h2><span id='topic+CVD_score_betas'></span>

<h3>Description</h3>

<p>The coefficients used to compute the CVD score by Wurtz et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CVD_score_betas")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 12 rows and 3 columns.
</p>


<h3>Details</h3>

<p>Dataframe containing the abbreviation of the metabolites, the metabolites names and finally the Coefficients to compute the COVID score
</p>


<h3>References</h3>

<p>Wurtz,P. et al. (2015) Metabolite profiling and cardiovascular event risk: a prospective study of 3 population-based cohorts. Circulation, 131, 774-785, <a href="doi:10.1161/CIRCULATIONAHA.114.013116">doi:10.1161/CIRCULATIONAHA.114.013116</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("CVD_score_betas")

</code></pre>

<hr>
<h2 id='do_metabowas'>Helper function to compute MetaboWASs</h2><span id='topic+do_metabowas'></span>

<h3>Description</h3>

<p>This helper function is called when doing Metabolites wide association analysis. It reports the results of linear regression models to study the association of a test variable to each metabolites individually and corrected for the covariates indicated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_metabowas(
  phen,
  dat,
  test_variable = "age",
  covariates = c("sex"),
  adj_method = "BH",
  quiet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_metabowas_+3A_phen">phen</code></td>
<td>
<p>phenotypes data.frame</p>
</td></tr>
<tr><td><code id="do_metabowas_+3A_dat">dat</code></td>
<td>
<p>metabolites data.frame</p>
</td></tr>
<tr><td><code id="do_metabowas_+3A_test_variable">test_variable</code></td>
<td>
<p>the variable to be investigated</p>
</td></tr>
<tr><td><code id="do_metabowas_+3A_covariates">covariates</code></td>
<td>
<p>the covariates that you want to add</p>
</td></tr>
<tr><td><code id="do_metabowas_+3A_adj_method">adj_method</code></td>
<td>
<p>correction method.</p>
</td></tr>
<tr><td><code id="do_metabowas_+3A_quiet">quiet</code></td>
<td>
<p>if FALSE it will plot the amount of people avaialble</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results= the results of the MetaboWAS (estimate, tstatistics, pvalue, BH corrected pvalue)
</p>

<hr>
<h2 id='find_BBMRI_names'>find_BBMRI_names</h2><span id='topic+find_BBMRI_names'></span>

<h3>Description</h3>

<p>Function to translate Nightingale metabolomics alternative metabolite names to the ones used in BBMRI-nl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_BBMRI_names(names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_BBMRI_names_+3A_names">names</code></td>
<td>
<p>vector of strings with the metabolic features names to be translated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with the uploaded metabolites names on the first column and the BBMRI names on the second column.
</p>


<h3>References</h3>

<p>This is a function originally created for the package ggforestplot and modified ad hoc for our package
(https://nightingalehealth.github.io/ggforestplot/articles/index.html).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)
library(purrr)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
#Find the metabolites names used in BBMRI-nl
nam&lt;-find_BBMRI_names(colnames(metabolic_measures)) 

</code></pre>

<hr>
<h2 id='get.p'>get.p</h2><span id='topic+get.p'></span>

<h3>Description</h3>

<p>helper function for extracting pvalues from cor.assoc results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.p(res)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.p_+3A_res">res</code></td>
<td>
<p>Results of cor.assoc</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the matrix of the pvalues of the associations
</p>

<hr>
<h2 id='get.s'>get.s</h2><span id='topic+get.s'></span>

<h3>Description</h3>

<p>helper function for extracting statistics from cor.assoc results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.s(res)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.s_+3A_res">res</code></td>
<td>
<p>Results of cor.assoc</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the matrix of associations
</p>

<hr>
<h2 id='getECE'>getECE</h2><span id='topic+getECE'></span>

<h3>Description</h3>

<p>helper function to calculate the ECE of calibrations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getECE(actual, predicted, n_bins = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getECE_+3A_actual">actual</code></td>
<td>
<p>observed binary phenotype</p>
</td></tr>
<tr><td><code id="getECE_+3A_predicted">predicted</code></td>
<td>
<p>predicted values</p>
</td></tr>
<tr><td><code id="getECE_+3A_n_bins">n_bins</code></td>
<td>
<p>the number of bins</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ECE value
</p>

<hr>
<h2 id='getMCE'>helper function to calculate the MCE of the calibrations</h2><span id='topic+getMCE'></span>

<h3>Description</h3>

<p>helper function to calculate the MCE of the calibrations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMCE(actual, predicted, n_bins = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMCE_+3A_actual">actual</code></td>
<td>
<p>real values of the variables</p>
</td></tr>
<tr><td><code id="getMCE_+3A_predicted">predicted</code></td>
<td>
<p>predicted values by one of the surrogates</p>
</td></tr>
<tr><td><code id="getMCE_+3A_n_bins">n_bins</code></td>
<td>
<p>the number of bins</p>
</td></tr>
</table>


<h3>Value</h3>

<p>MCE value
</p>

<hr>
<h2 id='getvol'>getvol</h2><span id='topic+getvol'></span>

<h3>Description</h3>

<p>helper function to retrieve the volumes for the download from the Rshiny application
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getvol()
</code></pre>


<h3>Value</h3>

<p>table
</p>

<hr>
<h2 id='hist_plots'>hist_plots</h2><span id='topic+hist_plots'></span>

<h3>Description</h3>

<p>#' Function to plot the histograms for all the variables in dat
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hist_plots(
  dat,
  x_name,
  color = MiMIR::c21,
  scaled = FALSE,
  datatype = "metabolic score",
  main = "Predictors Distributions"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist_plots_+3A_dat">dat</code></td>
<td>
<p>data.frame or matrix with the variables to plot</p>
</td></tr>
<tr><td><code id="hist_plots_+3A_x_name">x_name</code></td>
<td>
<p>string with the names of the selected variables in dat</p>
</td></tr>
<tr><td><code id="hist_plots_+3A_color">color</code></td>
<td>
<p>colors selected for all the variables</p>
</td></tr>
<tr><td><code id="hist_plots_+3A_scaled">scaled</code></td>
<td>
<p>logical to z-scale the variables</p>
</td></tr>
<tr><td><code id="hist_plots_+3A_datatype">datatype</code></td>
<td>
<p>a character vector indicating what data type is beeing plotted</p>
</td></tr>
<tr><td><code id="hist_plots_+3A_main">main</code></td>
<td>
<p>title of the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly image with the histograms of the selected variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(MiMIR)
require(plotly)
require(matrixStats)
#load the metabolites dataset
m &lt;- synthetic_metabolic_dataset

#Apply a surrogate models and plot the ROC curve
surrogates&lt;-calculate_surrogate_scores(m, PARAM_surrogates=MiMIR::PARAM_surrogates, roc=FALSE)
#Plot the histogram of the surrogate sex values scaled 
hist_plots(surrogates$surrogates, x_name="s_sex", scaled=TRUE)

</code></pre>

<hr>
<h2 id='hist_plots_mortality'>hist_plots_mortality</h2><span id='topic+hist_plots_mortality'></span>

<h3>Description</h3>

<p>#' Function to plot the histogram of the mortality score separated for different age ranges as a plotly image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hist_plots_mortality(mort_score, phenotypes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist_plots_mortality_+3A_mort_score">mort_score</code></td>
<td>
<p>data.frame containing the mortality score</p>
</td></tr>
<tr><td><code id="hist_plots_mortality_+3A_phenotypes">phenotypes</code></td>
<td>
<p>data.frame containing age</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly image with the histogram of the mortality score separated in 3 age ranges
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)
library(plotly)
#' #load the dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
phenotypes &lt;- synthetic_phenotypic_dataset

#Compute the mortality score
mortScore&lt;-comp.mort_score(metabolic_measures,quiet=TRUE)
#Plot the mortality score histogram at different ages
hist_plots_mortality(mortScore, phenotypes)

</code></pre>

<hr>
<h2 id='impute_miss'>impute_miss</h2><span id='topic+impute_miss'></span>

<h3>Description</h3>

<p>Helper function that subsets the NH-metabolomics matrix to the samples with less than Nmax zeros
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute_miss(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impute_miss_+3A_x">x</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function created that subsets the NH-metabolomics matrix samples to the ones for which the metabolites
included in MetaboAge for which the log of the metabolic concentrations are not more than 5SD away from their mean
</p>


<h3>Value</h3>

<p>matrix of the Nightingale-metabolomics dataset with missing values imputed to zero
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the metaboAge as described in:
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>
</p>


<h3>See Also</h3>

<p>QCprep, apply.fit, subset_metabolites_overlap, subset_samples_miss, subset_samples_zero, subset_samples_sd, apply.scale, and report.dim
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
#Imputing missing values
mat &lt;- impute_miss(metabolic_measures)

## End(Not run)

</code></pre>

<hr>
<h2 id='is.sym'>is.sym</h2><span id='topic+is.sym'></span>

<h3>Description</h3>

<p>Defining a helper function to check whether a supplied matrix is symmetric:
helper function to check whether a supplied matrix is symmetric
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.sym(res)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.sym_+3A_res">res</code></td>
<td>
<p>Results of cor.assoc</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE/FALSE
</p>

<hr>
<h2 id='kapmeier_scores'>kapmeier_scores</h2><span id='topic+kapmeier_scores'></span>

<h3>Description</h3>

<p>#' Function that creates a Kaplan Meier comparing first and last tertile of a metabolic score
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kapmeier_scores(predictors, pheno, score, Eventname = "Event")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kapmeier_scores_+3A_predictors">predictors</code></td>
<td>
<p>The data.frame containing the predictors</p>
</td></tr>
<tr><td><code id="kapmeier_scores_+3A_pheno">pheno</code></td>
<td>
<p>The data.frame containing the phenotypes</p>
</td></tr>
<tr><td><code id="kapmeier_scores_+3A_score">score</code></td>
<td>
<p>a character string indicating which predictor to use</p>
</td></tr>
<tr><td><code id="kapmeier_scores_+3A_eventname">Eventname</code></td>
<td>
<p>a character string with the name of the event to print on the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly with a Kaplan Meier comparing first and last tertile of a metabolic score
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(MiMIR)
require(plotly)
require(survminer)
require(ggfortify)
require(ggplot2)

#load the dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
phenotypes &lt;- synthetic_phenotypic_dataset

#Compute the mortality score
mortScore&lt;-comp.mort_score(metabolic_measures,quiet=TRUE)

#Plot a Kaplan Meier
kapmeier_scores(predictors=mortScore, pheno=phenotypes, score="mortScore")

</code></pre>

<hr>
<h2 id='loading'>withSpinner</h2><span id='topic+loading'></span>

<h3>Description</h3>

<p>helper function to show that the dataset is loading
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loading()
</code></pre>


<h3>Value</h3>

<p>loader
</p>

<hr>
<h2 id='loading_spin'>loading_spin</h2><span id='topic+loading_spin'></span>

<h3>Description</h3>

<p>helper function to create a loading spinner for the calibration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loading_spin(plot)
</code></pre>


<h3>Value</h3>

<p>loading spinner
</p>

<hr>
<h2 id='LOBOV_accuracies'>LOBOV_accuracies</h2><span id='topic+LOBOV_accuracies'></span>

<h3>Description</h3>

<p>Function created to visualize the accuracies in the current dataset compared to the
accuracies in the Leave One Biobank Out Validation in Bizzarri et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LOBOV_accuracies(surrogates, bin_phenotypes, bin_pheno_available, acc_LOBOV)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LOBOV_accuracies_+3A_surrogates">surrogates</code></td>
<td>
<p>numeric data.frame containing the surrogate values by Bizzarri et al.</p>
</td></tr>
<tr><td><code id="LOBOV_accuracies_+3A_bin_phenotypes">bin_phenotypes</code></td>
<td>
<p>numeric data.frame with the binarized phenotypes output of binarize_all_pheno</p>
</td></tr>
<tr><td><code id="LOBOV_accuracies_+3A_bin_pheno_available">bin_pheno_available</code></td>
<td>
<p>vector of strings with the available phenotypes</p>
</td></tr>
<tr><td><code id="LOBOV_accuracies_+3A_acc_lobov">acc_LOBOV</code></td>
<td>
<p>accuracy of LOBOV calculated in Bizzarri et al.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Comparison of the AUCs of the surrogates in the updated dataset and the
results of the Leave One Biobank Out Validation made in BBMRI-nl.
</p>


<h3>Value</h3>

<p>Boxplot with the accuracies of the LOBOV
</p>


<h3>References</h3>

<p>This function was made to vidualize the binarized variables calculated following the rules indicated in the article:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(pROC)
require(plotly)
require(MiMIR)
require(foreach)
require(ggplot2)

#load the dataset
m &lt;- synthetic_metabolic_dataset
p&lt;- synthetic_phenotypic_dataset

#Calculating the binarized surrogates
b_p&lt;-binarize_all_pheno(p)
#Apply a surrogate models and plot the ROC curve
sur&lt;-calculate_surrogate_scores(m, p, MiMIR::PARAM_surrogates, bin_names=colnames(b_p))
p_avail&lt;-colnames(b_p)[c(1:5)]
LOBOV_accuracies(sur$surrogates, b_p, p_avail, MiMIR::acc_LOBOV)

</code></pre>

<hr>
<h2 id='metabo_names_translator'>metabolomics feature nomenclatures</h2><span id='topic+metabo_names_translator'></span>

<h3>Description</h3>

<p>Translator of the names of the metabolomics-features to the ones used in BBMRI-nl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("metabo_names_translator")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 228 rows and 9 columns.
</p>


<h3>References</h3>

<p>This is a list originally created for the package ggforestplot and modified ad-hoc for our package
(https://nightingalehealth.github.io/ggforestplot/articles/index.html).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("metabo_names_translator")

</code></pre>

<hr>
<h2 id='metabolites_subsets'>metabolomics feature subsets</h2><span id='topic+metabolites_subsets'></span>

<h3>Description</h3>

<p>List containing all the subset of the metabolomics-based features used for our models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("metabolites_subsets")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 8.
</p>


<h3>References</h3>

<p>The selection of metabolic features available is the one selected by the papers:
Deelen,J. et al. (2019) A metabolic profile of all-cause mortality risk identified in an observational study of 44,168 individuals. Nature Communications, 10, 1-8, <a href="doi:10.1038/s41467-019-11311-9">doi:10.1038/s41467-019-11311-9</a>
Ahola-Olli,A.V. et al. (2019) Circulating metabolites and the risk of type 2 diabetes: a prospective study of 11,896 young adults from four Finnish cohorts. Diabetologia, 62, 2298-2309, <a href="doi:10.1007/s00125-019-05001-w">doi:10.1007/s00125-019-05001-w</a>
Wurtz,P. et al. (2015) Metabolite profiling and cardiovascular event risk: a prospective study of 3 population-based cohorts. Circulation, 131, 774-785, <a href="doi:10.1161/CIRCULATIONAHA.114.013116">doi:10.1161/CIRCULATIONAHA.114.013116</a>
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("metabolites_subsets")

</code></pre>

<hr>
<h2 id='MetaboWAS'>MetaboWAS</h2><span id='topic+MetaboWAS'></span>

<h3>Description</h3>

<p>Function to calculate a Metabolome Wide Association study
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MetaboWAS(met, pheno, test_variable, covariates, img = TRUE, adj_method = "BH")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MetaboWAS_+3A_met">met</code></td>
<td>
<p>numeric data.frame with the metabolomics features</p>
</td></tr>
<tr><td><code id="MetaboWAS_+3A_pheno">pheno</code></td>
<td>
<p>data.frame containing the phenotype of interest</p>
</td></tr>
<tr><td><code id="MetaboWAS_+3A_test_variable">test_variable</code></td>
<td>
<p>string vector with the name of the phenotype of interest</p>
</td></tr>
<tr><td><code id="MetaboWAS_+3A_covariates">covariates</code></td>
<td>
<p>string vector with the name of the variables to be added as a covariate</p>
</td></tr>
<tr><td><code id="MetaboWAS_+3A_img">img</code></td>
<td>
<p>logical indicating if the function should plot a Manhattan plot</p>
</td></tr>
<tr><td><code id="MetaboWAS_+3A_adj_method">adj_method</code></td>
<td>
<p>multiple testing correction method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a function to compute linear associations individually for each variable in the first data.frame
with the test variable and corrected for the selected covariates.
This function to computes linear regression modelindividually for each variable in the first data.frame
with the test variable and adjusted for potential confounders.
False Discovery Rate (FDR) is applied to account for multiple testing correction.
The user has the faculty to select the test variable and the potential covariates within the pool of variables in the phenotypic file input.
The results of the associations are reported in a Manhattan plot
</p>
<p>The p-value of the association is then corrected using Benjamini Hochberg.
Finally we use plotly to plot a Manhattan Plot, which reports on the x-axis the list of metabolites reported in the Nightingale Health,
divided in groups, and on the y-axis the -log (adjusted p-value).
</p>


<h3>Value</h3>

<p>res= the results of the MetaboWAS, manhplot= the Manhattan plot made with plotly, N_hits= the number of significant hits
</p>


<h3>References</h3>

<p>This method is also described and used in:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(MiMIR)
require(plotly)
require(ggplot2)

#' #load the dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
phenotypes &lt;- synthetic_phenotypic_dataset

#Computing a MetaboWAS for age corrected by sex
MetaboWAS(met=metabolic_measures, pheno=phenotypes, test_variable="age", covariates= "sex")

</code></pre>

<hr>
<h2 id='model_coeff_heat'>model_coeff_heat</h2><span id='topic+model_coeff_heat'></span>

<h3>Description</h3>

<p>Function to plot the scaled coefficients of the metabolic scores
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_coeff_heat(
  mort_betas,
  metaboAge_betas,
  surrogates_betas,
  Ahola_Olli_betas,
  CVD_score_betas,
  COVID_score_betas
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_coeff_heat_+3A_mort_betas">mort_betas</code></td>
<td>
<p>dataframe withthe coefficients of the mortality score</p>
</td></tr>
<tr><td><code id="model_coeff_heat_+3A_metaboage_betas">metaboAge_betas</code></td>
<td>
<p>dataframe with the coefficients of the metaboAge</p>
</td></tr>
<tr><td><code id="model_coeff_heat_+3A_surrogates_betas">surrogates_betas</code></td>
<td>
<p>dataframe with the coefficients of the surrogates</p>
</td></tr>
<tr><td><code id="model_coeff_heat_+3A_ahola_olli_betas">Ahola_Olli_betas</code></td>
<td>
<p>dataframe with the coefficients of the T2D score</p>
</td></tr>
<tr><td><code id="model_coeff_heat_+3A_cvd_score_betas">CVD_score_betas</code></td>
<td>
<p>dataframe with the coefficients of the CVD score</p>
</td></tr>
<tr><td><code id="model_coeff_heat_+3A_covid_score_betas">COVID_score_betas</code></td>
<td>
<p>ataframe with the coefficients of the COVID_score</p>
</td></tr>
</table>


<h3>Value</h3>

<p>heatmapply with the scaled coefficients of the metabolic scores
</p>

<hr>
<h2 id='MOLEPI_LCBC_header'>MOLEPI_LCBC_header</h2><span id='topic+MOLEPI_LCBC_header'></span>

<h3>Description</h3>

<p>helper function to create a header with the links to MOLEPI, LCBC, LUMC and BBMRI-nl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MOLEPI_LCBC_header()
</code></pre>


<h3>Value</h3>

<p>header for Rshiny app
</p>

<hr>
<h2 id='mort_betas'>Mortality score betas</h2><span id='topic+mort_betas'></span>

<h3>Description</h3>

<p>The coefficients used to compute the mortality score by Deelen et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("mort_betas")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 14 rows and 3 columns.
</p>


<h3>Details</h3>

<p>Dataframe containing the abbreviation of the metabolites, the metabolites names and finally the Coefficients to compute the mortality score
</p>


<h3>References</h3>

<p>Deelen,J. et al. (2019) A metabolic profile of all-cause mortality risk identified in an observational study of 44,168 individuals. Nature Communications, 10, 1-8, <a href="doi:10.1038/s41467-019-11311-9">doi:10.1038/s41467-019-11311-9</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mort_betas")

</code></pre>

<hr>
<h2 id='multi_hist'>multi_hist</h2><span id='topic+multi_hist'></span>

<h3>Description</h3>

<p>#' Function to plot the histograms for all the variables in dat
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_hist(dat, color = MiMIR::c21, scaled = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi_hist_+3A_dat">dat</code></td>
<td>
<p>data.frame or matrix with the variables to plot</p>
</td></tr>
<tr><td><code id="multi_hist_+3A_color">color</code></td>
<td>
<p>colors selected for all the variables</p>
</td></tr>
<tr><td><code id="multi_hist_+3A_scaled">scaled</code></td>
<td>
<p>logical to z-scale the variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly image with the histograms for all the variables in dat
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(plotly)
library(MiMIR)

#load the dataset
metabolic_measures &lt;- synthetic_metabolic_dataset

multi_hist(metabolic_measures[,MiMIR::metabolites_subsets$MET14], scaled=T)


</code></pre>

<hr>
<h2 id='NA_message'>NA_message</h2><span id='topic+NA_message'></span>

<h3>Description</h3>

<p>helper function to create a plot indicating a problem with a plotly image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NA_message(main = "Metabolites are missing, please check your upload!")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NA_message_+3A_main">main</code></td>
<td>
<p>Message to plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot
</p>

<hr>
<h2 id='PARAM_metaboAge'>PARAMETERS MetaboAge</h2><span id='topic+PARAM_metaboAge'></span>

<h3>Description</h3>

<p>The coefficients used to compute the MetaboAge by van den Akker et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("PARAM_metaboAge")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 8.
</p>


<h3>Details</h3>

<p>List containing all the information to pre-process and compute the MetaboAge.
</p>


<h3>References</h3>

<p>van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("PARAM_metaboAge")

</code></pre>

<hr>
<h2 id='PARAM_surrogates'>PARAMETERS surrogates</h2><span id='topic+PARAM_surrogates'></span>

<h3>Description</h3>

<p>The coefficients used to compute the metabolomics-based surrogate clinical variables by Bizzarri et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("PARAM_surrogates")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 6.
</p>


<h3>Details</h3>

<p>List containing all the information to pre-process and compute the surrogate clinical variables.
</p>


<h3>References</h3>

<p>Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("PARAM_surrogates")

</code></pre>

<hr>
<h2 id='pheno_barplots'>pheno_barplots</h2><span id='topic+pheno_barplots'></span>

<h3>Description</h3>

<p>#' Function created to binarize the phenotypes used to calculate the metabolomics based surrogate made by Bizzarri et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pheno_barplots(bin_phenotypes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pheno_barplots_+3A_bin_phenotypes">bin_phenotypes</code></td>
<td>
<p>phenotypes data.frame containing some of the following variables (with the same namenclature):
&quot;sex&quot;,&quot;diabetes&quot;, &quot;lipidmed&quot;,  &quot;blood_pressure_lowering_med&quot;, &quot;current_smoking&quot;,
&quot;metabolic_syndrome&quot;, &quot;alcohol_consumption&quot;, &quot;age&quot;,&quot;BMI&quot;, &quot;ln_hscrp&quot;,&quot;waist_circumference&quot;,
&quot;weight&quot;,&quot;height&quot;, &quot;triglycerides&quot;, &quot;ldl_chol&quot;, &quot;hdlchol&quot;, &quot;totchol&quot;, &quot;eGFR&quot;,&quot;wbc&quot;,&quot;hgb&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bizzarri et al. built multivariate models,using 56 metabolic features quantified by Nightingale, to predict the 19 binary characteristics of an individual.
The binary variables are: sex, diabetes status, metabolic syndrome status, lipid medication usage, blood pressure lowering medication,
current smoking, alcohol consumption, high age, middle age, low age, high hsCRP, high triglycerides, high ldl cholesterol,
high total cholesterol, low hdl cholesterol, low eGFR, low white blood cells, low hemoglobin levels.
</p>


<h3>Value</h3>

<p>The phenotypic variables binarized following the thresholds in in the metabolomics surrogates made by by Bizzarri et al.
</p>


<h3>References</h3>

<p>This function was made to vidualize the binarized variables calculated following the rules indicated in the article:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>See Also</h3>

<p>binarize_all_pheno
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(MiMIR)
require(foreach)

#load the phenotypes dataset
phenotypes &lt;- synthetic_phenotypic_dataset

#Calculate BMI, LDL cholesterol and eGFR
binarized_phenotypes&lt;-binarize_all_pheno(phenotypes)
#Plot the variables
pheno_barplots(binarized_phenotypes)


</code></pre>

<hr>
<h2 id='phenotypes_names'>phenotypic features names</h2><span id='topic+phenotypes_names'></span>

<h3>Description</h3>

<p>List containing all the subsets of phenotypics variables used in the app
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("phenotypes_names")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("phenotypes_names")

</code></pre>

<hr>
<h2 id='plattCalib_evaluation'>Function that plots the Platt Calibrations using plotly</h2><span id='topic+plattCalib_evaluation'></span>

<h3>Description</h3>

<p>Function that plots the Platt Calibrations using plotly
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plattCalib_evaluation(
  r,
  p,
  p.orig,
  name,
  nbins = 10,
  annot_x = c(1, 1),
  annot_y = c(0.1, 0.3)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plattCalib_evaluation_+3A_r">r</code></td>
<td>
<p>binary real data</p>
</td></tr>
<tr><td><code id="plattCalib_evaluation_+3A_p">p</code></td>
<td>
<p>predicted probabilities</p>
</td></tr>
<tr><td><code id="plattCalib_evaluation_+3A_p.orig">p.orig</code></td>
<td>
<p>the uncalibrated posterior probabilities</p>
</td></tr>
<tr><td><code id="plattCalib_evaluation_+3A_name">name</code></td>
<td>
<p>character string indicating the name of the calibrated variable</p>
</td></tr>
<tr><td><code id="plattCalib_evaluation_+3A_nbins">nbins</code></td>
<td>
<p>number of bins to create the plots</p>
</td></tr>
<tr><td><code id="plattCalib_evaluation_+3A_annot_x">annot_x</code></td>
<td>
<p>integer indicating the x axis points in which the ECE and MCE values will be plotted</p>
</td></tr>
<tr><td><code id="plattCalib_evaluation_+3A_annot_y">annot_y</code></td>
<td>
<p>integer indicating the y axis points in which the ECE and MCE values will be plotted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with Reliability diagram and histogram with calibrations and original predictions
</p>

<hr>
<h2 id='plattCalibration'>plattCalibration</h2><span id='topic+plattCalibration'></span>

<h3>Description</h3>

<p>Function that calculates the Platt Calibrations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plattCalibration(r.calib, p.calib, nbins = 10, pl = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plattCalibration_+3A_r.calib">r.calib</code></td>
<td>
<p>observed binary phenotype</p>
</td></tr>
<tr><td><code id="plattCalibration_+3A_p.calib">p.calib</code></td>
<td>
<p>predicted probabilities</p>
</td></tr>
<tr><td><code id="plattCalibration_+3A_nbins">nbins</code></td>
<td>
<p>number of bins to create the plots</p>
</td></tr>
<tr><td><code id="plattCalibration_+3A_pl">pl</code></td>
<td>
<p>logical indicating if the function should plot the Reliability diagram and histogram of the calibrations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Many popular machine learning algorithms produce inaccurate predicted probabilities, especially when applied on a dataset different than the training set.
Platt (1999) proposed an adjustment, in which the original probabilities are used as a predictor in a single-variable logistic regression to produce more accurate adjusted predicted probabilities.
The function will also help the evaluation of the calibration, by plotting: reliability diagrams and distributions of the calibrated and non-calibrated probabilities.
The reliability diagrams plots the mean predicted value within a certain range of posterior probabilities, against the fraction of accurately predicted values.
Finally, we also report accuracy measures for the calibrations: the ECE, MCE and the Log-Loss of the probabilities before and after calibration.
</p>


<h3>Value</h3>

<p>list with samples, responses, calibrations, ECE, MCE and calibration plots if save==T
</p>


<h3>References</h3>

<p>This is a function originally created for the package in eRic, under the name prCalibrate and modified ad hoc for our purposes
(<a href="https://rdrr.io/github/etlundquist/eRic/man/prCalibrate.html">Github</a>)
</p>
<p>J. C. Platt, 'Probabilistic Outputs for Support Vector Machines and Comparisons to Regularized Likelihood Methods', in Advances in Large Margin Classifiers, 1999, pp. 61-74.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)
library(plotly)

#load the dataset
met &lt;- synthetic_metabolic_dataset
phen &lt;- synthetic_phenotypic_dataset

#Calculating the binarized surrogates
b_phen&lt;-binarize_all_pheno(phen)
#Apply a surrogate models and plot the ROC curve
surr&lt;-calculate_surrogate_scores(met, phen,MiMIR::PARAM_surrogates, bin_names=colnames(b_phen))
#Calibration of the surrogate sex
real_data&lt;-as.numeric(b_phen$sex)
pred_data&lt;-surr$surrogates[,"s_sex"]
plattCalibration(r.calib=real_data, p.calib=pred_data, nbins = 10, pl=TRUE)

</code></pre>

<hr>
<h2 id='plot_corply'>plot_corply</h2><span id='topic+plot_corply'></span>

<h3>Description</h3>

<p>Function creating plottig the correlation between 2 datasets, dat1 x dat2 on basis of (partial) correlations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_corply(
  res,
  main = NULL,
  zlim = NULL,
  reorder.x = FALSE,
  reorder.y = reorder.x,
  resort_on_p = FALSE,
  abs = FALSE,
  cor.abs = FALSE,
  reorder_dend = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_corply_+3A_res">res</code></td>
<td>
<p>associations obtained with cor.assoc</p>
</td></tr>
<tr><td><code id="plot_corply_+3A_main">main</code></td>
<td>
<p>title of the plot</p>
</td></tr>
<tr><td><code id="plot_corply_+3A_zlim">zlim</code></td>
<td>
<p>max association to plot</p>
</td></tr>
<tr><td><code id="plot_corply_+3A_reorder.x">reorder.x</code></td>
<td>
<p>logical indicating if the function should reorder the x axis based on clustering</p>
</td></tr>
<tr><td><code id="plot_corply_+3A_reorder.y">reorder.y</code></td>
<td>
<p>logical indicating if the function should reorder the y axis based on clustering</p>
</td></tr>
<tr><td><code id="plot_corply_+3A_resort_on_p">resort_on_p</code></td>
<td>
<p>logical indicating if the function should reorder x and y axis based on the pvalues of the associations</p>
</td></tr>
<tr><td><code id="plot_corply_+3A_abs">abs</code></td>
<td>
<p>logical indicating if the function should  reorder based the absolute values</p>
</td></tr>
<tr><td><code id="plot_corply_+3A_cor.abs">cor.abs</code></td>
<td>
<p>logical indicating if the function should reorder the plot base on the absolute values</p>
</td></tr>
<tr><td><code id="plot_corply_+3A_reorder_dend">reorder_dend</code></td>
<td>
<p>Tlogical indicating if the function should reorder the plot based on dendrogram</p>
</td></tr>
</table>


<h3>Value</h3>

<p>heatmap with the results of cor.assoc
</p>


<h3>See Also</h3>

<p>cor_assoc
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stats)

#load the dataset
m &lt;- as.matrix(synthetic_metabolic_dataset)

#Compute the pearson correlation of all the variables in the data.frame metabolic_measures
cors&lt;-cor_assoc(m, m, MiMIR::metabolites_subsets$MET63,MiMIR::metabolites_subsets$MET63)
#Plot the correlations
plot_corply(cors, main="Correlations metabolites")

</code></pre>

<hr>
<h2 id='plot_na_heatmap'>plot_na_heatmap</h2><span id='topic+plot_na_heatmap'></span>

<h3>Description</h3>

<p>Function plotting information about missing &amp; zero values on the indicated matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_na_heatmap(dat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_na_heatmap_+3A_dat">dat</code></td>
<td>
<p>The matrix or data.frame</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This heatmap indicates the available values in grey and missing or zeros in white.
On the sides two bar plots on the sides, one showing the missingn or zero values
per row and another to show the missing or zeroes per column.
</p>


<h3>Value</h3>

<p>Plot with a central heatmap and two histogram on the sides
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(graphics)
library(MiMIR)

#load the metabolites dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
#Plot the missing values in the metabolomics matrix
plot_na_heatmap(metabolic_measures)

</code></pre>

<hr>
<h2 id='plotly_NA_message'>plotly_NA_message</h2><span id='topic+plotly_NA_message'></span>

<h3>Description</h3>

<p>helper function to create a plotly indicating a problem with a plotly image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotly_NA_message(main = "Phenotype not available!")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotly_NA_message_+3A_main">main</code></td>
<td>
<p>Message to plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly image
</p>

<hr>
<h2 id='predictions_surrogates'>predictions_surrogates</h2><span id='topic+predictions_surrogates'></span>

<h3>Description</h3>

<p>Helper function that apply a surrogate model and plot a ROC curve the accuracy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictions_surrogates(FIT, data, title_img = FALSE, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictions_surrogates_+3A_fit">FIT</code></td>
<td>
<p>numeric vector with betas of the logistic regressions composing the surrogates by Bizzarri et al.</p>
</td></tr>
<tr><td><code id="predictions_surrogates_+3A_data">data</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics and the binarized phenotype to predict</p>
</td></tr>
<tr><td><code id="predictions_surrogates_+3A_title_img">title_img</code></td>
<td>
<p>string with title of the image</p>
</td></tr>
<tr><td><code id="predictions_surrogates_+3A_plot">plot</code></td>
<td>
<p>logical to obtain the ROC curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bizzarri et al. built multivariate models,using 56 metabolic features quantified by Nightingale, to predict the 19 binary characteristics of an individual.
The binary variables are: sex, diabetes status, metabolic syndrome status, lipid medication usage, blood pressure lowering medication,
current smoking, alcohol consumption, high age, middle age, low age, high hsCRP, high triglycerides, high ldl cholesterol,
high total cholesterol, low hdl cholesterol, low eGFR, low white blood cells, low hemoglobin levels.
</p>


<h3>Value</h3>

<p>If plot==TRUE The surrogate predictions and the roc curve. If plot==F only the surrogate predictions
</p>


<h3>References</h3>

<p>This function was made to vidualize the binarized variables calculated following the rules indicated in the article:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>See Also</h3>

<p>QCprep_surrogates, calculate_surrogate_scores, subset_samples_sd_surrogates, apply.fit_surro
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
# Do the pre-processing steps to the metabolic measures
metabolic_measures&lt;-QCprep_surrogates(as.matrix(metabolic_measures), Nmax_miss=1,Nmax_zero=1)

#load the phenotypic dataset
phenotypes &lt;- read.csv("phenotypes_file_path",header = TRUE, row.names = 1)
#Calculating the binarized surrogates
bin_pheno&lt;-binarize_all_pheno(phenotypes)

#Apply a surrogate models and plot the ROC curve
data&lt;-data.frame(out=factor(phenotypes_names$bin_names[,1]), metabo_measures)
colnames(data)[1]&lt;-"out"
pred&lt;-predictions_surrogates(PARAM_surrogates$models_betas["s_sex",], data=data, title_img="s_sex")


## End(Not run)

</code></pre>

<hr>
<h2 id='prep_data_COVID_score'>prep_data_COVID_score</h2><span id='topic+prep_data_COVID_score'></span>

<h3>Description</h3>

<p>Helper function to pre-process the Nightingale Health metabolomics data-set before applying the COVID score.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_data_COVID_score(
  dat,
  featID = c("gp", "dha", "crea", "mufa", "apob_apoa1", "tyr", "ile", "sfa_fa", "glc",
    "lac", "faw6_faw3", "phe", "serum_c", "faw6_fa", "ala", "pufa", "glycine", "his",
    "pufa_fa", "val", "leu", "alb", "faw3", "ldl_c", "serum_tg"),
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_data_COVID_score_+3A_dat">dat</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="prep_data_COVID_score_+3A_featid">featID</code></td>
<td>
<p>vector of strings with the names of metabolic features included in the COVID-score</p>
</td></tr>
<tr><td><code id="prep_data_COVID_score_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Nightingale-metabolomics data-frame after pre-processing (checked for zeros, z-scaled and log-transformed) according to what has been done by the authors of the original papers.
</p>


<h3>References</h3>

<p>This function is constructed to be able to follow the pre-processing steps described in:
Nightingale Health UK Biobank Initiative et al. (2021) Metabolic biomarker profiling for identification of susceptibility to severe pneumonia and COVID-19 in the general population. eLife, 10, e63033, <a href="doi:10.7554/eLife.63033">doi:10.7554/eLife.63033</a>
</p>


<h3>See Also</h3>

<p>prep_met_for_scores, covid_betas, comp_covid_score
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(MiMIR)
require(matrixStats)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
#Prepare the metabolic features fo the mortality score
prepped_met &lt;- prep_data_COVID_score(dat=metabolic_measures)


</code></pre>

<hr>
<h2 id='prep_met_for_scores'>prep_met_for_scores</h2><span id='topic+prep_met_for_scores'></span>

<h3>Description</h3>

<p>Helper function to pre-process the Nightingale Health metabolomics data-set before applying the mortality, Type-2-diabetes and CVD scores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_met_for_scores(dat, featID, plusone = FALSE, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_met_for_scores_+3A_dat">dat</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="prep_met_for_scores_+3A_featid">featID</code></td>
<td>
<p>vector of strings with the names of metabolic features included in the score selected</p>
</td></tr>
<tr><td><code id="prep_met_for_scores_+3A_plusone">plusone</code></td>
<td>
<p>logical to determine if a value of 1.0 should be added to all metabolic features (TRUE) or only to the ones featuring zeros before log-transforming (FALSE)</p>
</td></tr>
<tr><td><code id="prep_met_for_scores_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Nightingale-metabolomics data-frame after pre-processing (checked for zeros, zscale and log-transformed) according to what has been done by the authors of the original papers.
</p>


<h3>References</h3>

<p>This function is constructed to be able to follow the pre-processing steps described in:
Deelen,J. et al. (2019) A metabolic profile of all-cause mortality risk identified in an observational study of 44,168 individuals. Nature Communications, 10, 1-8, <a href="doi:10.1038/s41467-019-11311-9">doi:10.1038/s41467-019-11311-9</a>.
</p>
<p>Ahola-Olli,A.V. et al. (2019) Circulating metabolites and the risk of type 2 diabetes: a prospective study of 11,896 young adults from four Finnish cohorts. Diabetologia, 62, 2298-2309, <a href="doi:10.1007/s00125-019-05001-w">doi:10.1007/s00125-019-05001-w</a>
</p>
<p>Wurtz,P. et al. (2015) Metabolite profiling and cardiovascular event risk: a prospective study of 3 population-based cohorts. Circulation, 131, 774-785, <a href="doi:10.1161/CIRCULATIONAHA.114.013116">doi:10.1161/CIRCULATIONAHA.114.013116</a>
</p>


<h3>See Also</h3>

<p>comp.mort_score, mort_betas, comp.T2D_Ahola_Olli, comp.CVD_score
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)

#load the Nightingale metabolomics dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
#Prepare the metabolic features fo the mortality score
prepped_met &lt;- prep_met_for_scores(metabolic_measures,featID=MiMIR::mort_betas$Abbreviation)

</code></pre>

<hr>
<h2 id='QCprep'>QCprep</h2><span id='topic+QCprep'></span>

<h3>Description</h3>

<p>Helper function to pre-process the Nightingale Health metabolomics data-set before applying the MetaboAge score by van den Akker et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QCprep(mat, PARAM_metaboAge, quiet = TRUE, Nmax_zero = 1, Nmax_miss = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QCprep_+3A_mat">mat</code></td>
<td>
<p>numeric data-frame NH-metabolomics matrix.</p>
</td></tr>
<tr><td><code id="QCprep_+3A_param_metaboage">PARAM_metaboAge</code></td>
<td>
<p>list containing all the parameters to compute the metaboAge (metabolic features list,BBMRI-nl means and SDs of the metabolic features, and coefficients)</p>
</td></tr>
<tr><td><code id="QCprep_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
<tr><td><code id="QCprep_+3A_nmax_zero">Nmax_zero</code></td>
<td>
<p>numberic value indicating the maximum number of zeros allowed per sample (Number suggested=1)</p>
</td></tr>
<tr><td><code id="QCprep_+3A_nmax_miss">Nmax_miss</code></td>
<td>
<p>numberic value indicating the maximum number of missing values allowed per sample (Number suggested=1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nightingale-metabolomics data-frame after pre-processing (checked for zeros, missing values, samples&gt;5SD from the BBMRI-mean, imputing the missing values and z-scaled)
</p>


<h3>References</h3>

<p>This function is constructed to be able to follow the pre-processing steps described in:
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCULATIONAHA.114.013116">doi:10.1161/CIRCULATIONAHA.114.013116</a>
</p>


<h3>See Also</h3>

<p>apply.fit
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- synthetic_metabolic_dataset

#Pre-process the metabolic features
prepped_met&lt;-QCprep(as.matrix(metabolic_measures[,metabolites_subsets$MET63]), PARAM_metaboAge)

</code></pre>

<hr>
<h2 id='QCprep_surrogates'>QCprep_surrogates</h2><span id='topic+QCprep_surrogates'></span>

<h3>Description</h3>

<p>Helper function to pre-process the Nightingale Health metabolomics data-set before applying metabolomics-based surrogates by Bizzarri et al.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QCprep_surrogates(
  mat,
  PARAM_surrogates,
  Nmax_miss = 1,
  Nmax_zero = 1,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QCprep_surrogates_+3A_mat">mat</code></td>
<td>
<p>numeric data-frame Nightingale metabolomics matrix.</p>
</td></tr>
<tr><td><code id="QCprep_surrogates_+3A_param_surrogates">PARAM_surrogates</code></td>
<td>
<p>is a list holding the parameters to compute the surrogates</p>
</td></tr>
<tr><td><code id="QCprep_surrogates_+3A_nmax_miss">Nmax_miss</code></td>
<td>
<p>numeric value indicating the maximum number of missing values allowed per sample (Number suggested=1)</p>
</td></tr>
<tr><td><code id="QCprep_surrogates_+3A_nmax_zero">Nmax_zero</code></td>
<td>
<p>numeric value indicating the maximum number of zeros allowed per sample (Number suggested=1)</p>
</td></tr>
<tr><td><code id="QCprep_surrogates_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bizzarri et al. built multivariate models,using 56 metabolic features quantified by Nightingale, to predict the 19 binary characteristics of an individual.
The binary variables are: sex, diabetes status, metabolic syndrome status, lipid medication usage, blood pressure lowering medication,
current smoking, alcohol consumption, high age, middle age, low age, high hsCRP, high triglycerides, high ldl cholesterol,
high total cholesterol, low hdl cholesterol, low eGFR, low white blood cells, low hemoglobin levels.
</p>


<h3>Value</h3>

<p>Nightingale-metabolomics data-frame after pre-processing (checked for zeros, missing values, samples&gt;5SD from the BBMRI-mean, imputing the missing values and z-scaled)
</p>


<h3>References</h3>

<p>This function was made to vidualize the binarized variables calculated following the rules indicated in the article:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>See Also</h3>

<p>binarize_all_pheno
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
#Pre-process the metabolic features
prepped_met&lt;-QCprep_surrogates(as.matrix(metabolic_measures), MiMIR::PARAM_surrogates)


</code></pre>

<hr>
<h2 id='rendertable'>rendertable</h2><span id='topic+rendertable'></span>

<h3>Description</h3>

<p>helper function to create a table for an Rshiny app
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rendertable(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rendertable_+3A_data">data</code></td>
<td>
<p>the dataset to show</p>
</td></tr>
</table>


<h3>Value</h3>

<p>table
</p>

<hr>
<h2 id='report.dim'>report.dim</h2><span id='topic+report.dim'></span>

<h3>Description</h3>

<p>Helper function to report on the console the dimension of the NH metabolomics matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report.dim(x, header, trailing = "0")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="report.dim_+3A_x">x</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="report.dim_+3A_header">header</code></td>
<td>
<p>string describing the sub-sampling of the NH-metabolomics matrix</p>
</td></tr>
<tr><td><code id="report.dim_+3A_trailing">trailing</code></td>
<td>
<p>number of digits to show</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The report of the NH-metabolomics matrix dimension
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the metaboAge as described in:
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>
</p>


<h3>See Also</h3>

<p>QCprep, apply.fit, subset_metabolites_overlap, subset_samples_miss, subset_samples_zero, subset_samples_sd, impute_miss, and apply.scale
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
#Apply the scaling to the metabolic features
cat(report.dim(x, header=paste0("Pruning samples on 5SD")))

## End(Not run)

</code></pre>

<hr>
<h2 id='resort.on.p'>resort.on.p</h2><span id='topic+resort.on.p'></span>

<h3>Description</h3>

<p>helper function for clustering cor.assoc results reordering based on the pvalues
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resort.on.p(res, abs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resort.on.p_+3A_res">res</code></td>
<td>
<p>Results of cor.assoc</p>
</td></tr>
<tr><td><code id="resort.on.p_+3A_abs">abs</code></td>
<td>
<p>TRUE/FALSE. If TRUE it will cluster the absolute values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the clustered order of the associations based on the pvalues
</p>

<hr>
<h2 id='resort.on.s'>resort.on.s</h2><span id='topic+resort.on.s'></span>

<h3>Description</h3>

<p>helper function for clustering cor.assoc results reordering based on the associations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resort.on.s(res, abs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resort.on.s_+3A_res">res</code></td>
<td>
<p>Results of cor.assoc</p>
</td></tr>
<tr><td><code id="resort.on.s_+3A_abs">abs</code></td>
<td>
<p>TRUE/FALSE. If TRUE it will cluster the absolute values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the clustered order of the associations
</p>

<hr>
<h2 id='roc_surro'>roc_surro</h2><span id='topic+roc_surro'></span>

<h3>Description</h3>

<p>Function that creates a ROC curve of the selected metabolic surrogates as a plotly image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roc_surro(surrogates, bin_phenotypes, x_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roc_surro_+3A_surrogates">surrogates</code></td>
<td>
<p>numeric data.frame of metabolomics-based surrogate values by Bizzarri et al.</p>
</td></tr>
<tr><td><code id="roc_surro_+3A_bin_phenotypes">bin_phenotypes</code></td>
<td>
<p>logic data.frame of binarized phenotypes</p>
</td></tr>
<tr><td><code id="roc_surro_+3A_x_name">x_name</code></td>
<td>
<p>vector of strings with the names of the selected binary phenotypes for the roc</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly image with the ROC curves for one or more selected variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(pROC)
require(plotly)
require(foreach)
require(MiMIR)

#load the dataset
met &lt;- synthetic_metabolic_dataset
phen&lt;- synthetic_phenotypic_dataset

#Calculating the binarized surrogates
b_phen&lt;-binarize_all_pheno(phen)
#Apply a surrogate models and plot the ROC curve
surr&lt;-calculate_surrogate_scores(met, phen, MiMIR::PARAM_surrogates, colnames(b_phen))
#Plot the ROC curves
roc_surro(surr$surrogates, b_phen, "sex")

</code></pre>

<hr>
<h2 id='roc_surro_subplots'>roc_surro_subplots</h2><span id='topic+roc_surro_subplots'></span>

<h3>Description</h3>

<p>Function that plots the ROCs of the surrogates of all the available surrogate models as plotly sub-plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roc_surro_subplots(surrogates, bin_phenotypes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roc_surro_subplots_+3A_surrogates">surrogates</code></td>
<td>
<p>numeric data.frame containing the surrogate values by Bizzarri et al.</p>
</td></tr>
<tr><td><code id="roc_surro_subplots_+3A_bin_phenotypes">bin_phenotypes</code></td>
<td>
<p>numeric data.frame with the binarized phenotypes output of binarize_all_pheno</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly image with all the ROCs for all the available clinical variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pROC)
library(plotly)
library(MiMIR)

#load the dataset
met &lt;- synthetic_metabolic_dataset
phen&lt;- synthetic_phenotypic_dataset

#Calculating the binarized surrogates
b_phen&lt;-binarize_all_pheno(phen)
#Apply a surrogate models and plot the ROC curve
surr&lt;-calculate_surrogate_scores(met, phen, MiMIR::PARAM_surrogates, colnames(b_phen))

roc_surro_subplots(surr$surrogates, b_phen)


</code></pre>

<hr>
<h2 id='scatterplot_predictions'>scatterplot_predictions</h2><span id='topic+scatterplot_predictions'></span>

<h3>Description</h3>

<p>Function to visualize a scatter-plot comparing two variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scatterplot_predictions(x, p, title, xname = "x", yname = "predicted x")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scatterplot_predictions_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="scatterplot_predictions_+3A_p">p</code></td>
<td>
<p>second numeric vector</p>
</td></tr>
<tr><td><code id="scatterplot_predictions_+3A_title">title</code></td>
<td>
<p>string vector with the title</p>
</td></tr>
<tr><td><code id="scatterplot_predictions_+3A_xname">xname</code></td>
<td>
<p>string vector with the name of the variable on the x axis</p>
</td></tr>
<tr><td><code id="scatterplot_predictions_+3A_yname">yname</code></td>
<td>
<p>string vector with the name of the variable on the y axis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly image with the scatterplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(plotly)
#load the dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
phenotypes &lt;- synthetic_phenotypic_dataset

#Pre-process the metabolic features
prepped_met&lt;-QCprep(as.matrix(metabolic_measures), MiMIR::PARAM_metaboAge)
#Apply the metaboAge
metaboAge&lt;-apply.fit(prepped_met, FIT=PARAM_metaboAge$FIT_COEF)

age&lt;-data.frame(phenotypes$age)
rownames(age)&lt;-rownames(phenotypes)
scatterplot_predictions(age, metaboAge, title="Chronological Age vs MetaboAge")

</code></pre>

<hr>
<h2 id='startApp'>startMiMIR</h2><span id='topic+startApp'></span>

<h3>Description</h3>

<p>Start the application MiMIR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startApp(launch.browser = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="startApp_+3A_launch.browser">launch.browser</code></td>
<td>
<p>TRUE/FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function starts the R-Shiny tool called MiMIR (Metabolomics-based Models for Imputing Risk),
a graphical user interface that provides an intuitive framework for ad-hoc statistical analysis of Nightingale Health's 1H-NMR metabolomics data
and allows for the projection and calibration of 24 pre-trained metabolomics-based models, without any pre-required programming knowledge.
</p>


<h3>Value</h3>

<p>Opens application. If <code>launch.browser</code>=TRUE in default web browser
</p>


<h3>References</h3>

<p>Deelen,J. et al. (2019) A metabolic profile of all-cause mortality risk identified in an observational study of 44,168 individuals. Nature Communications, 10, 1-8, doi: 10.1038/s41467-019-11311-9.
Ahola-Olli,A.V. et al. (2019) Circulating metabolites and the risk of type 2 diabetes: a prospective study of 11,896 young adults from four Finnish cohorts. Diabetologia, 62, 2298-2309, doi: 10.1007/s00125-019-05001-w
Wurtz,P. et al. (2015) Metabolite profiling and cardiovascular event risk: a prospective study of 3 population-based cohorts. Circulation, 131, 774-785, doi: 10.1161/CIRCULATIONAHA.114.013116
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, doi: 10.1016/j.ebiom.2021.103764
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, doi:10.1161/CIRCGEN.119.002610
</p>

<hr>
<h2 id='subset_metabolites_overlap'>subset_metabolites_overlap</h2><span id='topic+subset_metabolites_overlap'></span>

<h3>Description</h3>

<p>Helper function that subsets the NH-metabolomics matrix features to the selection in metabolites needed for the metabolic score
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_metabolites_overlap(x, metabos, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_metabolites_overlap_+3A_x">x</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="subset_metabolites_overlap_+3A_metabos">metabos</code></td>
<td>
<p>vector of strings containing the names of the metabolic features to be selected</p>
</td></tr>
<tr><td><code id="subset_metabolites_overlap_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with the selected Nightingale-metabolomics features
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the metaboAge as described in:
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>
</p>


<h3>See Also</h3>

<p>QCprep, apply.fit, subset_samples_miss, subset_samples_zero, subset_samples_sd, impute_miss, apply.scale, and report.dim
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
#Select the metabolic features
mat &lt;- subset_metabolites_overlap(x=metabolic_measures,metabos=PARAM_metaboAge$MET)

## End(Not run)

</code></pre>

<hr>
<h2 id='subset_samples_miss'>subset_samples_miss</h2><span id='topic+subset_samples_miss'></span>

<h3>Description</h3>

<p>Helper function that subsets the NH-metabolomics matrix to the samples with less than Nmax missing values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_samples_miss(x, Nmax = 1, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_samples_miss_+3A_x">x</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="subset_samples_miss_+3A_nmax">Nmax</code></td>
<td>
<p>integer indicating  the max number of missing values allowed per sample (N suggested= 1)</p>
</td></tr>
<tr><td><code id="subset_samples_miss_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with the samples with limited amount of missing values in the Nightingale-metabolomics dataset
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the metaboAge as described in:
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>
</p>


<h3>See Also</h3>

<p>QCprep, apply.fit, subset_metabolites_overlap, subset_samples_zero, subset_samples_sd, impute_miss, apply.scale, and report.dim
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
#Select the samples with only 1 missing value
mat &lt;- subset_samples_miss(x=metabolic_measures, Nmax=1)


## End(Not run)

</code></pre>

<hr>
<h2 id='subset_samples_sd'>subset_samples_sd</h2><span id='topic+subset_samples_sd'></span>

<h3>Description</h3>

<p>Helper function that subsets the NH-metabolomics matrix to the samples with limited numbers of outliers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_samples_sd(x, MEAN, SD, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_samples_sd_+3A_x">x</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="subset_samples_sd_+3A_mean">MEAN</code></td>
<td>
<p>numeric vector indicating the mean of the metabolites in x</p>
</td></tr>
<tr><td><code id="subset_samples_sd_+3A_sd">SD</code></td>
<td>
<p>numeric vector indicating the standard deviations of the metabolites in x</p>
</td></tr>
<tr><td><code id="subset_samples_sd_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with the samples with limited amount of outliers in the Nightingale-metabolomics dataset
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the metaboAge as described in:
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>
</p>


<h3>See Also</h3>

<p>QCprep, apply.fit, subset_metabolites_overlap, subset_samples_miss, subset_samples_zero, impute_miss, apply.scale, and report.dim
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
#Select the samples with low outliers
mat &lt;- subset_samples_sd(x=metabolic_measures, Nmax=1)

## End(Not run)

</code></pre>

<hr>
<h2 id='subset_samples_sd_surrogates'>subset_samples_sd_surrogates</h2><span id='topic+subset_samples_sd_surrogates'></span>

<h3>Description</h3>

<p>Helper function that subsets the NH-metabolomics matrix to the samples with limited numbers of outliers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_samples_sd_surrogates(x, MEAN, SD, N = 5, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_samples_sd_surrogates_+3A_x">x</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="subset_samples_sd_surrogates_+3A_mean">MEAN</code></td>
<td>
<p>numeric vector indicating the mean of the metabolites in x</p>
</td></tr>
<tr><td><code id="subset_samples_sd_surrogates_+3A_sd">SD</code></td>
<td>
<p>numeric vector indicating the standard deviations of the metabolites in x</p>
</td></tr>
<tr><td><code id="subset_samples_sd_surrogates_+3A_n">N</code></td>
<td>
<p>numeric vector indicating the amount of standard deviations away from the mean after which we consider an outlier (N suggested=5)</p>
</td></tr>
<tr><td><code id="subset_samples_sd_surrogates_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bizzarri et al. built multivariate models,using 56 metabolic features quantified by Nightingale, to predict the 19 binary characteristics of an individual.
The binary variables are: sex, diabetes status, metabolic syndrome status, lipid medication usage, blood pressure lowering medication,
current smoking, alcohol consumption, high age, middle age, low age, high hsCRP, high triglycerides, high ldl cholesterol,
high total cholesterol, low hdl cholesterol, low eGFR, low white blood cells, low hemoglobin levels.
</p>


<h3>Value</h3>

<p>matrix with the samples with limited amount of outliers in the Nightingale-metabolomics dataset
</p>


<h3>References</h3>

<p>This function was made to vidualize the binarized variables calculated following the rules indicated in the article:
Bizzarri,D. et al. (2022) 1H-NMR metabolomics-based surrogates to impute common clinical risk factors and endpoints. EBioMedicine, 75, 103764, <a href="doi:10.1016/j.ebiom.2021.103764">doi:10.1016/j.ebiom.2021.103764</a>
</p>


<h3>See Also</h3>

<p>QCprep_surrogates, calculate_surrogate_scores, apply.fit_surro
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
#Select the samples with low outliers
mat &lt;- subset_samples_sd_surrogates(x=metabolic_measures, Nmax=1)

## End(Not run)

</code></pre>

<hr>
<h2 id='subset_samples_zero'>subset_samples_miss</h2><span id='topic+subset_samples_zero'></span>

<h3>Description</h3>

<p>Helper function that subsets the NH-metabolomics matrix to the samples with less than Nmax zeros
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_samples_zero(x, Nmax = 1, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_samples_zero_+3A_x">x</code></td>
<td>
<p>numeric data-frame with Nightingale-metabolomics</p>
</td></tr>
<tr><td><code id="subset_samples_zero_+3A_nmax">Nmax</code></td>
<td>
<p>integer indicating  the max number of missing values allowed per sample (N suggested= 1)</p>
</td></tr>
<tr><td><code id="subset_samples_zero_+3A_quiet">quiet</code></td>
<td>
<p>logical to suppress the messages in the console</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with the samples with limited amount of zeros in the Nightingale-metabolomics dataset
</p>


<h3>References</h3>

<p>This function is constructed to be able to apply the metaboAge as described in:
van den Akker Erik B. et al. (2020) Metabolic Age Based on the BBMRI-NL 1H-NMR Metabolomics Repository as Biomarker of Age-related Disease. Circulation: Genomic and Precision Medicine, 13, 541-547, <a href="doi:10.1161/CIRCGEN.119.002610">doi:10.1161/CIRCGEN.119.002610</a>
</p>


<h3>See Also</h3>

<p>QCprep, apply.fit, subset_metabolites_overlap, subset_samples_miss, subset_samples_sd, impute_miss, apply.scale, and report.dim
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MiMIR)

#load the Nightignale metabolomics dataset
metabolic_measures &lt;- read.csv("Nightingale_file_path",header = TRUE, row.names = 1)
#Select samples with only 1 zero
mat &lt;- subset_samples_zero(x=metabolic_measures, Nmax=1)


## End(Not run)

</code></pre>

<hr>
<h2 id='synthetic_metabolic_dataset'>synthetic metabolomics dataset</h2><span id='topic+synthetic_metabolic_dataset'></span>

<h3>Description</h3>

<p>Data.frame containing a synthetic dataset of the Nightingale Metabolomics dataset created with the package synthpop from the LLS_PAROFF dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("synthetic_metabolic_dataset")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 500 rows and 229 columns.
</p>


<h3>References</h3>

<p>M. Schoenmaker et al., 'Evidence of genetic enrichment for exceptional survival using a family approach: the Leiden Longevity Study', Eur. J. Hum. Genet., vol. 14, no. 1, Art. no. 1, Jan. 2006, <a href="doi:10.1038/sj.ejhg.5201508">doi:10.1038/sj.ejhg.5201508</a>
B. Nowok, G. M. Raab, and C. Dibben, 'synthpop: Bespoke Creation of Synthetic Data in R', J. Stat. Softw., vol. 74, no. 1, Art. no. 1, Oct. 2016, <a href="doi:10.18637/jss.v074.i11">doi:10.18637/jss.v074.i11</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("synthetic_metabolic_dataset")

</code></pre>

<hr>
<h2 id='synthetic_phenotypic_dataset'>synthetic metabolomics dataset</h2><span id='topic+synthetic_phenotypic_dataset'></span>

<h3>Description</h3>

<p>Data.frame containing a synthetic dataset of phenotypic dataset created with the package synthpop from the LLS_PAROFF dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("synthetic_metabolic_dataset")
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 500 rows and 24 columns.
</p>


<h3>References</h3>

<p>M. Schoenmaker et al., 'Evidence of genetic enrichment for exceptional survival using a family approach: the Leiden Longevity Study', Eur. J. Hum. Genet., vol. 14, no. 1, Art. no. 1, Jan. 2006, <a href="doi:10.1038/sj.ejhg.5201508">doi:10.1038/sj.ejhg.5201508</a>
B. Nowok, G. M. Raab, and C. Dibben, 'synthpop: Bespoke Creation of Synthetic Data in R', J. Stat. Softw., vol. 74, no. 1, Art. no. 1, Oct. 2016, <a href="doi:10.18637/jss.v074.i11">doi:10.18637/jss.v074.i11</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("synthetic_metabolic_dataset")

</code></pre>

<hr>
<h2 id='ttest_scores'>ttest_scores</h2><span id='topic+ttest_scores'></span>

<h3>Description</h3>

<p>#' Function that creates a boxplot with a continuous variable split using the binary variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttest_scores(dat, pred, pheno)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ttest_scores_+3A_dat">dat</code></td>
<td>
<p>The data.frame containing the 2 variables</p>
</td></tr>
<tr><td><code id="ttest_scores_+3A_pred">pred</code></td>
<td>
<p>character indicating the y variable</p>
</td></tr>
<tr><td><code id="ttest_scores_+3A_pheno">pheno</code></td>
<td>
<p>character indicating the binary variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly boxplot with the continuous variable split using the binary variable
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MiMIR)
library(plotly)

#load the dataset
metabolic_measures &lt;- synthetic_metabolic_dataset
phenotypes &lt;- synthetic_phenotypic_dataset

#Compute the mortality score
mortScore&lt;-comp.mort_score(metabolic_measures,quiet=TRUE)
dat&lt;-data.frame(predictor=mortScore, pheno=phenotypes$sex)
colnames(dat)&lt;-c("predictor","pheno")
ttest_scores(dat = dat, pred= "mortScore", pheno="sex")

</code></pre>

<hr>
<h2 id='ttest_surrogates'>ttest_surrogates</h2><span id='topic+ttest_surrogates'></span>

<h3>Description</h3>

<p>Function that calculates a t-test and a plotly image of the selected surrogates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttest_surrogates(surrogates, bin_phenotypes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ttest_surrogates_+3A_surrogates">surrogates</code></td>
<td>
<p>numeric data.frame containing the surrogate values by Bizzarri et al.</p>
</td></tr>
<tr><td><code id="ttest_surrogates_+3A_bin_phenotypes">bin_phenotypes</code></td>
<td>
<p>numeric data.frame with the binarized phenotypes output of binarize_all_pheno</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Barplot and T-test indicating if the surrogate variables could split accordingly the real value of the binary clinical variables.
</p>


<h3>Value</h3>

<p>plotly image with all the ROCs for all the available clinical variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(pROC)
require(plotly)
require(MiMIR)
require(foreach)

#load the dataset
m &lt;- synthetic_metabolic_dataset
p &lt;- synthetic_phenotypic_dataset

#Calculating the binarized surrogates
b_p&lt;-binarize_all_pheno(p)
#Apply a surrogate models and plot the ROC curve
surr&lt;-calculate_surrogate_scores(met=m, pheno=p, MiMIR::PARAM_surrogates, bin_names=colnames(b_p))
ttest_surrogates(surr$surrogates, b_p)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
