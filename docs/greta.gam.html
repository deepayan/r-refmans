<!DOCTYPE html><html lang="en-GB"><head><title>Help for package greta.gam</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {greta.gam}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#greta.gam'><p>greta.gam: generalised additive models in greta using mgcv</p></a></li>
<li><a href='#evaluate_smooths'><p>evaluate smooths at new data</p></a></li>
<li><a href='#smooths'><p>greta array representations of mgcv smooth terms</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalised Additive Models in 'greta' using 'mgcv'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A 'greta' (Golding (2019) &lt;<a href="https://doi.org/10.21105%2Fjoss.01601">doi:10.21105/joss.01601</a>&gt;) module that lets you use 'mgcv' smoother functions and formula syntax to define smooth terms for use in a 'greta' model. You can then define your own likelihood to complete the model, and fit it by Markov Chain Monte Carlo (MCMC).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License (&ge; 2)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, mgcv, rlang, stats</td>
</tr>
<tr>
<td>Depends:</td>
<td>greta (&ge; 0.5.0), R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, spelling, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/greta-dev/greta.gam">https://github.com/greta-dev/greta.gam</a>,
<a href="https://greta-dev.github.io/greta.gam/">https://greta-dev.github.io/greta.gam/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/greta-dev/greta.gam/issues">https://github.com/greta-dev/greta.gam/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-17 00:00:37 UTC; nick</td>
</tr>
<tr>
<td>Author:</td>
<td>Nick Golding <a href="https://orcid.org/0000-0001-8916-5570"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Nicholas Tierney <a href="https://orcid.org/0000-0003-1460-8722"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  David L Miller [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicholas Tierney &lt;nicholas.tierney@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-17 10:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='greta.gam'>greta.gam: generalised additive models in greta using mgcv</h2><span id='topic+greta.gam-package'></span><span id='topic+greta.gam'></span>

<h3>Description</h3>

<p>greta.gam is a module for greta that lets you use mgcv's
smoother functions and formula syntax to define smooth terms for use in a
greta model. You can then define your own likelihood to complete the
model, and fit it by MCMC.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Nicholas Tierney <a href="mailto:nicholas.tierney@gmail.com">nicholas.tierney@gmail.com</a> (<a href="https://orcid.org/0000-0003-1460-8722">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Nick Golding <a href="mailto:nick.golding.research@gmail.com">nick.golding.research@gmail.com</a> (<a href="https://orcid.org/0000-0001-8916-5570">ORCID</a>) [copyright holder]
</p>
</li>
<li><p> David L Miller <a href="mailto:dave@ninepointeightone.net">dave@ninepointeightone.net</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/greta-dev/greta.gam">https://github.com/greta-dev/greta.gam</a>
</p>
</li>
<li> <p><a href="https://greta-dev.github.io/greta.gam/">https://greta-dev.github.io/greta.gam/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/greta-dev/greta.gam/issues">https://github.com/greta-dev/greta.gam/issues</a>
</p>
</li></ul>


<hr>
<h2 id='evaluate_smooths'>evaluate smooths at new data</h2><span id='topic+evaluate_smooths'></span>

<h3>Description</h3>

<p>Evaluate a set of smooths at new data locations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_smooths(x, newdata)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluate_smooths_+3A_x">x</code></td>
<td>
<p>a greta array created with greta.gam::smooths</p>
</td></tr>
<tr><td><code id="evaluate_smooths_+3A_newdata">newdata</code></td>
<td>
<p>a dataframe with the same column names and datatypes as that
used to create x, with data at which to evaluate the smooths</p>
</td></tr>
</table>


<h3>Value</h3>

<p>greta array
</p>


<h3>Author(s)</h3>

<p>Nick Golding
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
n &lt;- 30
x &lt;- runif(n, 0, 10)
f &lt;- function(x) {
  sin(x * 2) + 1.6 * (x &lt; 3) - 1.4 * (x &gt; 7)
}
y &lt;- f(x) + rnorm(n, 0, 0.3)
x_plot &lt;- seq(0, 10, length.out = 200)

z &lt;- smooths(~ s(x), data = data.frame(x = x))

distribution(y) &lt;- normal(z, 0.3)

z_pred &lt;- evaluate_smooths(z, newdata = data.frame(x = x_plot))

z_pred

## End(Not run)
</code></pre>

<hr>
<h2 id='smooths'>greta array representations of mgcv smooth terms</h2><span id='topic+smooths'></span>

<h3>Description</h3>

<p><code>smooths</code> translates the right hand side of a mgcv GAM
formula into a corresponding Bayesian representation of smooth terms. This
formula may include multiple combined smooths of different types, as well
as fixed effect terms and intercepts. The resulting greta array
representing the combined smooth can then be used in a greta model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooths(formula, data = list(), knots = NULL, sp = NULL, tol = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smooths_+3A_formula">formula</code></td>
<td>
<p>a GAM formula representing the smooth terms, as in
<code><a href="mgcv.html#topic+gam">mgcv::gam()</a></code>. Only the right hand side of the formula
will be used.</p>
</td></tr>
<tr><td><code id="smooths_+3A_data">data</code></td>
<td>
<p>a data frame or list containing the covariates required by the
formula. These covariates cannot be greta arrays.</p>
</td></tr>
<tr><td><code id="smooths_+3A_knots">knots</code></td>
<td>
<p>an optional list containing user specified knot values to be
used for basis construction, as in <code><a href="mgcv.html#topic+gam">mgcv::gam()</a></code> These
knots cannot be greta arrays.</p>
</td></tr>
<tr><td><code id="smooths_+3A_sp">sp</code></td>
<td>
<p>an optional vector of smoothing parameters, two per smooth term in
the model, in the same order as the formula. If <code>sp = NULL</code>, all
smoothing parameters will be learned, otherwise all smoothing parameters
must be specified by the user. The smoothing parameters may either be a
numeric vector or a greta array (which could be a variable).</p>
</td></tr>
<tr><td><code id="smooths_+3A_tol">tol</code></td>
<td>
<p>a non-negative scalar numerical tolerance parameter. You can try
increasing this if the model has numerical stability issues</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only the right hand side of <code>formula</code> will be used to define
the smooth terms. The user must complete the gam model by specifying the
link and likelihood term in greta. A warning will be issued if the formula
has a left hand side.
</p>
<p>Note that by default, GAM formulas add an intercept term. If you have
already specified an intercept for your greta model, you can remove the
intercept from the smooth term by adding <code>-1</code> as a term in your
formula.
</p>
<p>Like <code><a href="mgcv.html#topic+jagam">mgcv::jagam()</a></code>, <code>smooths</code> translates a
mgcv GAM formula into a Bayesian representation of the smooth terms, using
the GAM smoothing penalty matrix as a multivariate normal prior to penalise
model fitting. Unlike <code>gam</code>, <code>smooths</code> does not perform the
integration required to penalise model fitting. The model must be fitted by
MCMC to carry out this integration - it does not make sense to do maximum
likelihood optimisation on a greta model that uses <code>smooths</code>.
</p>


<h3>Value</h3>

<p>Object of class &quot;greta_array&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
n &lt;- 30
x &lt;- runif(n, 0, 10)
f &lt;- function(x) {
  sin(x * 2) + 1.6 * (x &lt; 3) - 1.4 * (x &gt; 7)
}
y &lt;- f(x) + rnorm(n, 0, 0.3)
x_plot &lt;- seq(0, 10, length.out = 200)

z &lt;- smooths(~ s(x), data = data.frame(x = x))

distribution(y) &lt;- normal(z, 0.3)

z_pred &lt;- evaluate_smooths(z, newdata = data.frame(x = x_plot))

# build model
m &lt;- model(z_pred)
draws &lt;- mcmc(m, n_samples = 100)

plot(x, y, pch = 19, cex = 0.4, col = "red")
apply(draws[[1]], 1, lines, x = x_plot, col = "blue")
points(x, y, pch = 19, cex = 0.4, col = "red")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
