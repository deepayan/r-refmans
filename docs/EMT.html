<!DOCTYPE html><html><head><title>Help for package EMT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EMT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EMT-package'><p>Exact Multinomial Test: Goodness-of-Fit Test for Discrete Multivariate Data</p></a></li>
<li><a href='#EMT-internal'><p> Internal functions for the EMT package</p></a></li>
<li><a href='#multinomial.test'><p> Exact Multinomial Test: Goodness-of-Fit Test for Discrete Multivariate Data</p></a></li>
<li><a href='#plotMultinom'><p> Plot the Probability distribution fot the Exact Multinomial Test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Exact Multinomial Test: Goodness-of-Fit Test for Discrete
Multivariate Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Uwe Menzel</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Uwe Menzel &lt;uwemenzel@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Goodness-of-fit tests for discrete multivariate data. It is
        tested if a given observation is likely to have occurred under
        the assumption of an ab-initio model. Monte Carlo methods are provided to
        make the package capable of solving high-dimensional problems.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-26 15:40:25 UTC; uwe</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-26 16:10:02 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='EMT-package'>Exact Multinomial Test: Goodness-of-Fit Test for Discrete Multivariate Data</h2><span id='topic+EMT-package'></span><span id='topic+EMT'></span>

<h3>Description</h3>

<p>The package provides functions to carry out a Goodness-of-fit test for discrete multivariate data. 
It is tested if a given observation is likely to have occurred under the assumption of an ab-initio model. 
A p-value can be calculated using different distance measures between observed and expected frequencies. 
A Monte Carlo method is provided to make the package capable of solving high-dimensional problems.  
The main user functions are <code>multinomial.test</code> and <code>plotMultinom</code>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> CCP</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-02-06</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Uwe Menzel
</p>
<p>Maintainer: Uwe Menzel  &lt;uwemenzel@gmail.com&gt;
</p>

<hr>
<h2 id='EMT-internal'> Internal functions for the EMT package </h2><span id='topic+ExactMultinomialTest'></span><span id='topic+ExactMultinomialTestChisquare'></span><span id='topic+MonteCarloMultinomialTest'></span><span id='topic+MonteCarloMultinomialTestChisquare'></span><span id='topic+chisqStat'></span><span id='topic+findVectors'></span>

<h3>Description</h3>

<p>Internal functions for the EMT package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExactMultinomialTest(observed, prob, size, groups, numEvents)
ExactMultinomialTestChisquare(observed, prob, size, groups, numEvents)
MonteCarloMultinomialTest(observed, prob, size, groups, 
                         numEvents, ntrial, atOnce)
MonteCarloMultinomialTestChisquare(observed, prob, size, groups,
                         numEvents, ntrial, atOnce)
chisqStat(observed,expected)
findVectors(groups,size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMT-internal_+3A_observed">observed</code></td>
<td>
<p> vector describing the observation: contains the <em>observed numbers</em> of items in each category. </p>
</td></tr>
<tr><td><code id="EMT-internal_+3A_prob">prob</code></td>
<td>
<p> vector describing the model: contains the <em>hypothetical probabilities</em> corresponding to each category. </p>
</td></tr>
<tr><td><code id="EMT-internal_+3A_expected">expected</code></td>
<td>
<p>vector containing the expected numbers of items in each category under the assumption that the model is valid.</p>
</td></tr>
<tr><td><code id="EMT-internal_+3A_size">size</code></td>
<td>
<p> sample size, sum of the components of the vector <code>observed</code>. </p>
</td></tr>
<tr><td><code id="EMT-internal_+3A_groups">groups</code></td>
<td>
<p> number of categories in the experiment. </p>
</td></tr>
<tr><td><code id="EMT-internal_+3A_numevents">numEvents</code></td>
<td>
<p> number of possible outcomes of the experiment. </p>
</td></tr>
<tr><td><code id="EMT-internal_+3A_ntrial">ntrial</code></td>
<td>
<p> number of simulated samples in the Monte Carlo approach. </p>
</td></tr>
<tr><td><code id="EMT-internal_+3A_atonce">atOnce</code></td>
<td>
<p> a parameter of more technical nature. Determines how much memory is used for big arrays.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are not intended to be called by the user.
</p>

<hr>
<h2 id='multinomial.test'> Exact Multinomial Test: Goodness-of-Fit Test for Discrete Multivariate Data</h2><span id='topic+multinomial.test'></span>

<h3>Description</h3>

<p>Goodness-of-fit tests for discrete multivariate data. 
It is tested if a given observation is likely to have occurred under the assumption of an ab-initio model. 
Monte Carlo methods are provided to make the function capable of solving high-dimensional problems.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multinomial.test(observed, prob, useChisq = FALSE,
               MonteCarlo = FALSE, ntrial = 1e6, atOnce = 1e6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multinomial.test_+3A_observed">observed</code></td>
<td>
<p> vector describing the observation: contains the <em>observed numbers</em> of items in each category. </p>
</td></tr>
<tr><td><code id="multinomial.test_+3A_prob">prob</code></td>
<td>
<p> vector describing the model: contains the <em>hypothetical probabilities</em> corresponding to each category. </p>
</td></tr>
<tr><td><code id="multinomial.test_+3A_usechisq">useChisq</code></td>
<td>
<p> if <code>TRUE</code>, Pearson's chisquare is used as a distance measure between observed and expected frequencies. </p>
</td></tr>
<tr><td><code id="multinomial.test_+3A_montecarlo">MonteCarlo</code></td>
<td>
<p> if <code>TRUE</code>, a Monte Carlo approach is used. </p>
</td></tr>
<tr><td><code id="multinomial.test_+3A_ntrial">ntrial</code></td>
<td>
<p> number of simulated samples in the Monte Carlo approach. </p>
</td></tr>
<tr><td><code id="multinomial.test_+3A_atonce">atOnce</code></td>
<td>
<p> a parameter of more technical nature. Determines how much memory is used for big arrays. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The Exact Multinomial Test is a Goodness-of-fit test for discrete multivariate data. 
It is tested if a given observation is likely to have occurred under the assumption of an ab-initio model. 
In the experimental setup belonging to the test, <em>n</em> items fall into <em>k</em> categories with certain probabilities
(sample size <em>n</em> with <em>k</em> categories). 
The <b>observation</b>, described by the vector <code>observed</code>, indicates how many items have been observed in each category.  
The <b>model</b>, determined by the vector <code>prob</code>, assigns to each category the hypothetical probability that an item falls into it. 
Now, if the observation is unlikely to have occurred under the assumption of the model, it is advisible to
regard the model as <em>not</em> valid. The p-value estimates how likely the observation is, given the model.   
In particular, low p-values suggest that the model is <em>not</em> valid.
The <b>default approach</b> used by <code>multinomial.test</code> obtains the p-values by 
calculating the exact probabilities of <em>all</em> possible outcomes given <code>n</code> and <code>k</code>,
using the multinomial probability distribution function <code><a href="stats.html#topic+dmultinom">dmultinom</a></code> provided by R. 
Then, by default, the p-value is obtained by summing the probabilities of all outcomes which are less likely
than the observed outcome (or equally likely as the observed outcome), i.e. by summing all <code class="reqn">p(i) &lt;= p(observed)</code>
(distance measure based on probabilities).
Alternatively, the p-value can be obtained by summing the probabilities of all outcomes connected with a chisquare no smaller than
the chisquare connected with the actual observation (distance measure based on chisquare). 
The latter is triggered by setting <code>useChisq = TRUE</code>.
Having a sample of size <em>n</em> in an experiment with <em>k</em> categories, the number of distinct
possible outcomes is the binomial coefficient <code>choose(n+k-1,k-1)</code>. This number grows rapidly with increasing parameters <em>n</em> and
<em>k</em>. If the parameters grow too big, numerical calculation might fail because of time or
memory limitations. 
In this case, usage of a <b>Monte Carlo approach</b> provided by <code>multinomial.test</code> is suggested.
A Monte Carlo approach, activated by setting <code>MonteCarlo = TRUE</code>,
simulates withdrawal of <em>ntrial</em> samples of size <em>n</em> from the hypothetical distribution specified by the vector <code>prob</code>. 
The default value for <em>ntrial</em> is <code>100000</code> but might be incremented for big <em>n</em> and <em>k</em>. 
The advantage of the Monte Carlo approach is that memory requirements and running time are essentially determined by <em>ntrial</em> 
but not by <em>n</em> or <em>k</em>. 
By default, the p-value is then obtained by summing the relative frequencies of occurrence of unusual outcomes, i.e. of
outcomes occurring less frequently than the observed one (or equally frequent as the observed one).    
Alternatively, as above, Pearson's chisquare can be used as a distance measure by setting <code>useChisq = TRUE</code>.
The parameter <em>atOnce</em> is of more technical nature, with a default value of <code class="reqn">1000000</code>. This value should be decremented
for computers with low memory to avoid overflow, and can be incremented for large-CPU computers to speed up calculations. 
The parameter is only effective for Monte Carlo calculations.
</p>


<h3>Value</h3>

<table>
<tr><td><code>id</code></td>
<td>
<p>textual description of the method used.</p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p>sample size <em>n</em>, equals the sum of the components of the vector <code>observed</code>.</p>
</td></tr>
<tr><td><code>groups</code></td>
<td>
<p>number of categories <em>k</em> in the experiment, equals the number of components of the vector <code>observed</code>.</p>
</td></tr> 
<tr><td><code>numEvents</code></td>
<td>
<p>number of different events for the model considered.</p>
</td></tr>  
<tr><td><code>stat</code></td>
<td>
<p>textual description of the distance measure used.</p>
</td></tr>
<tr><td><code>allProb</code></td>
<td>
<p>vector containing the probabilities (rel. frequencies for the Monte Carlo approach) of all possible outcomes (might be huge for big <em>n</em> and <em>k</em>).</p>
</td></tr>
<tr><td><code>criticalValue</code></td>
<td>
<p>the critical value of the hypothesis test.</p>
</td></tr>
<tr><td><code>ntrial</code></td>
<td>
<p>number of trials if the Monte Carlo approach was used, <code>NULL</code> otherwise.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the calculated p-value rounded to four significant digits.</p>
</td></tr>  
</table>


<h3>Note</h3>

<p> For two categories (<code class="reqn">k = 2</code>), the test is called Exact Binomial Test.
</p>


<h3>Author(s)</h3>

<p> Uwe Menzel &lt;uwemenzel@gmail.com&gt;</p>


<h3>References</h3>

<p>H. Bayo Lawal (2003)
<em>Categorical data analysis with SAS and SPSS applications</em>, Volume 1, Chapter 3
ISBN: 978-0-8058-4605-8
</p>
<p>Read, T. R. C. and Cressie, N. A. C. (1988). 
<em>Goodness-of-fit statistics for discrete multivariate data.</em> 
Springer, New York.
</p>


<h3>See Also</h3>

  
<p>The Multinomial Distribution: <code><a href="stats.html#topic+dmultinom">dmultinom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load the EMT package:
library(EMT)

## Input data for a three-dimensional case:
observed &lt;- c(5,2,1)   		 
prob &lt;- c(0.25, 0.5, 0.25) 	 

## Calculate p-value using default options:
out &lt;- multinomial.test(observed, prob)        
# p.value = 0.0767

## Plot the probabilities for each event:
plotMultinom(out)

## Calculate p-value for the same input using Pearson's chisquare:
out &lt;- multinomial.test(observed, prob, useChisq = TRUE)  
# p.value = 0.0596 ; not the same!

## Test the hypothesis that all sides of a dice have the same probabilities:
prob &lt;- rep(1/6, 6)	                 
observed &lt;- c(4, 5, 2, 7, 0, 1)			
out &lt;- multinomial.test(observed, prob) 
# p.value = 0.0357 -&gt; better get another dice!

# the same problem using a Monte Carlo approach:
## Not run: 
  out &lt;- multinomial.test(observed, prob, MonteCarlo = TRUE, ntrial = 5e+6)   

## End(Not run)

</code></pre>

<hr>
<h2 id='plotMultinom'> Plot the Probability distribution fot the Exact Multinomial Test</h2><span id='topic+plotMultinom'></span>

<h3>Description</h3>

<p>This function takes the results of <code>multinomial.test</code> as input and plots the calculated probability
distribution.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMultinom(listMultinom)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMultinom_+3A_listmultinom">listMultinom</code></td>
<td>
<p> a list created by running the function <code>multinomial.test</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>plotMultinom</code> displays a barplot of the probabilities for the individual events.
The probabilities are shown in descending order from the left to the right.
Events contributing to the p-value are marked red.
Plots are only made if the number of different events is lower than or equal to 100 and for low number of trials in Monte Carlo simulations.
</p>


<h3>Value</h3>

<p>The first argument (<em>listMultinom</em>) is returned without modification. 
</p>


<h3>Author(s)</h3>

<p> Uwe Menzel   &lt;uwemenzel@gmail.com&gt; </p>


<h3>See Also</h3>

  
<p>The Multinomial Distribution: <code><a href="#topic+multinomial.test">multinomial.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load the EMT package:
library(EMT)

## input and calculation of p-values:
observed &lt;- c(5,2,1)   		
prob &lt;- c(0.25, 0.5, 0.25) 
out &lt;- multinomial.test(observed, prob)     # p.value = 0.0767

## Plot the probability distribution:
plotMultinom(out)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
