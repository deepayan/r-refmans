<!DOCTYPE html><html><head><title>Help for package predictNMB</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {predictNMB}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#predictNMB-package'><p>predictNMB: Evaluate Clinical Prediction Models by Net Monetary Benefit</p></a></li>
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#autoplot.predictNMBscreen'><p>Create plots of from screened predictNMB simulations.</p></a></li>
<li><a href='#autoplot.predictNMBsim'><p>Create plots of from predictNMB simulations.</p></a></li>
<li><a href='#ce_plot'><p>Create a cost-effectiveness plot.</p></a></li>
<li><a href='#ce_plot.predictNMBsim'><p>Create a cost-effectiveness plot.</p></a></li>
<li><a href='#do_nmb_sim'><p>Do the predictNMB simulation, evaluating the net monetary benefit (NMB) of the</p>
simulated model.</a></li>
<li><a href='#evaluate_cutpoint_cost'><p>Evaluates a cutpoint by returning the mean treatment cost per sample.</p></a></li>
<li><a href='#evaluate_cutpoint_nmb'><p>Evaluates a cutpoint by returning the mean NMB per sample.</p></a></li>
<li><a href='#evaluate_cutpoint_qalys'><p>Evaluates a cutpoint by returning the mean QALYs lost per sample.</p></a></li>
<li><a href='#get_inbuilt_cutpoint'><p>Get a cutpoint using the methods inbuilt to predictNMB</p></a></li>
<li><a href='#get_inbuilt_cutpoint_methods'><p>Get a vector of all the inbuilt cutpoint methods</p></a></li>
<li><a href='#get_nmb_sampler'><p>Make a NMB sampler for use in <code>do_nmb_sim()</code> or</p>
<code>screen_simulation_inputs()</code></a></li>
<li><a href='#get_sample'><p>Samples data for a prediction model with a specified AUC and prevalence.</p></a></li>
<li><a href='#get_thresholds'><p>Gets probability thresholds given predicted probabilities, outcomes and NMB.</p></a></li>
<li><a href='#print.predictNMBscreen'><p>Print a summary of a predictNMBscreen object</p></a></li>
<li><a href='#print.predictNMBsim'><p>Print a summary of a predictNMBsim object</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#screen_simulation_inputs'><p>Screen many simulation inputs: a parent function to <code>do_nmb_sim()</code></p></a></li>
<li><a href='#summary.predictNMBscreen'><p>Create table summaries of <code>predictNMBscreen</code> objects.</p></a></li>
<li><a href='#summary.predictNMBsim'><p>Create table summaries of <code>predictNMBsim</code> objects.</p></a></li>
<li><a href='#theme_sim'><p>Returns a <code>ggplot2</code> theme that reduces clutter in an <code>autoplot()</code></p>
of a <code>predictNMBsim</code> object.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Evaluate Clinical Prediction Models by Net Monetary Benefit</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates when and where a model-guided treatment strategy may 
    outperform a treat-all or treat-none approach by Monte Carlo simulation and 
    evaluation of the Net Monetary Benefit. Details can be viewed in 
    Parsons et al. (2023) &lt;<a href="https://doi.org/10.21105%2Fjoss.05328">doi:10.21105/joss.05328</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>assertthat, cutpointr, dplyr, ggplot2, magrittr, pmsampsize,
rlang, scales, stats, tibble, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, covr, flextable, knitr, parallel, pbapply,
rmarkdown, testthat (&ge; 3.0.0), vdiffr, withr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://docs.ropensci.org/predictNMB/">https://docs.ropensci.org/predictNMB/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/predictNMB/issues">https://github.com/ropensci/predictNMB/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-03 07:19:02 UTC; n10891277</td>
</tr>
<tr>
<td>Author:</td>
<td>Rex Parsons <a href="https://orcid.org/0000-0002-6053-8174"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Robin Blythe <a href="https://orcid.org/0000-0002-3643-4332"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Adrian Barnett <a href="https://orcid.org/0000-0001-6339-0374"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Emi Tanaka [rev] (Emi Tanaka reviewed predictNMB for rOpenSci, see
    &lt;https://github.com/ropensci/software-review/issues/566&gt;.),
  Tinula Kariyawasam [rev] (Tinula Kariyawasam reviewed predictNMB for
    rOpenSci, see
    &lt;https://github.com/ropensci/software-review/issues/566&gt;.),
  Susanna Cramb <a href="https://orcid.org/0000-0001-9041-9531"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Steven McPhail <a href="https://orcid.org/0000-0002-1463-662X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rex Parsons &lt;rex.parsons94@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-03 07:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='predictNMB-package'>predictNMB: Evaluate Clinical Prediction Models by Net Monetary Benefit</h2><span id='topic+predictNMB'></span><span id='topic+predictNMB-package'></span>

<h3>Description</h3>

<p>To learn more about how to use predictNMB, see the vignettes at the
<a href="https://docs.ropensci.org/predictNMB/index.html">website</a> or using
the following code:
</p>
<p><code>browseVignettes(package = "predictNMB")</code>
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Rex Parsons <a href="mailto:rex.parsons94@gmail.com">rex.parsons94@gmail.com</a> (<a href="https://orcid.org/0000-0002-6053-8174">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Robin Blythe (<a href="https://orcid.org/0000-0002-3643-4332">ORCID</a>)
</p>
</li>
<li><p> Adrian Barnett (<a href="https://orcid.org/0000-0001-6339-0374">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Emi Tanaka (Emi Tanaka reviewed predictNMB for rOpenSci, see &lt;https://github.com/ropensci/software-review/issues/566&gt;.) [reviewer]
</p>
</li>
<li><p> Tinula Kariyawasam (Tinula Kariyawasam reviewed predictNMB for rOpenSci, see &lt;https://github.com/ropensci/software-review/issues/566&gt;.) [reviewer]
</p>
</li>
<li><p> Susanna Cramb (<a href="https://orcid.org/0000-0001-9041-9531">ORCID</a>) [contributor]
</p>
</li>
<li><p> Steven McPhail (<a href="https://orcid.org/0000-0002-1463-662X">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://docs.ropensci.org/predictNMB/">https://docs.ropensci.org/predictNMB/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ropensci/predictNMB/issues">https://github.com/ropensci/predictNMB/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='autoplot.predictNMBscreen'>Create plots of from screened predictNMB simulations.</h2><span id='topic+autoplot.predictNMBscreen'></span>

<h3>Description</h3>

<p>Create plots of from screened predictNMB simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predictNMBscreen'
autoplot(
  object,
  x_axis_var = NULL,
  constants = list(),
  what = c("nmb", "inb", "cutpoints", "qalys", "costs"),
  inb_ref_col = NA,
  plot_range = TRUE,
  plot_conf_level = TRUE,
  plot_line = TRUE,
  plot_alpha = 0.5,
  dodge_width = 0,
  conf.level = 0.95,
  methods_order = NULL,
  rename_vector,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.predictNMBscreen_+3A_object">object</code></td>
<td>
<p>A <code>predictNMBscreen</code> object.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_x_axis_var">x_axis_var</code></td>
<td>
<p>The desired screened factor to be displayed along the
x axis. For example, if the simulation screen was used with many values for
event rate, this could be &quot;event_rate&quot;. Defaults to the first detected,
varied input.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_constants">constants</code></td>
<td>
<p>Named vector. If multiple inputs were screened in this
object, this argument can be used to modify the selected values for all
those except the input that's varying along the x-axis. See the
<a href="https://docs.ropensci.org/predictNMB/articles/summarising-results-with-predictNMB.html">summarising methods vignette</a>.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_what">what</code></td>
<td>
<p>What to summarise: one of &quot;nmb&quot;, &quot;inb&quot;, &quot;cutpoints&quot;, &quot;qalys&quot; or
&quot;costs&quot;. Defaults to &quot;nmb&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_inb_ref_col">inb_ref_col</code></td>
<td>
<p>Which cutpoint method to use as the reference strategy
when calculating the incremental net monetary benefit.
See <code>do_nmb_sim</code> for more information.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_plot_range">plot_range</code></td>
<td>
<p><code>logical</code>. Whether or not to plot the range of the
distribution as a thin line. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_plot_conf_level">plot_conf_level</code></td>
<td>
<p><code>logical</code>. Whether or not to plot the confidence
region of the distribution as a thicker line. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_plot_line">plot_line</code></td>
<td>
<p><code>logical</code>. Whether or not to connect the medians of
the distributions for each method along the x-axis. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_plot_alpha">plot_alpha</code></td>
<td>
<p>Alpha value (transparency) of all plot elements. Defaults to 0.5.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_dodge_width">dodge_width</code></td>
<td>
<p>The dodge width of plot elements. Can be used to avoid
excessive overlap between methods. Defaults to 0.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence level of the interval.
Defaults to 0.95 (coloured area of distribution represents 95% CIs).</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_methods_order">methods_order</code></td>
<td>
<p>The order (left to right) to display the cutpoint
methods.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_rename_vector">rename_vector</code></td>
<td>
<p>A named vector for renaming the methods in the summary.
The values of the vector are the default names and the names given are the
desired names in the output.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBscreen_+3A_...">...</code></td>
<td>
<p>Additional (unused) arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot method works with <code>predictNMBscreen</code> objects that are
created using <code>screen_simulation_inputs()</code>. Can be used to visualise
distributions from many different simulations and assign a varying input
to the x-axis of the plot.
</p>


<h3>Value</h3>

<p>Returns a <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_nmb &lt;- function() c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
sim_screen_obj &lt;- screen_simulation_inputs(
  n_sims = 50, n_valid = 10000, sim_auc = seq(0.7, 0.9, 0.1),
  event_rate = c(0.1, 0.2, 0.3),
  fx_nmb_training = get_nmb, fx_nmb_evaluation = get_nmb,
  cutpoint_methods = c("all", "none", "youden", "value_optimising")
)

autoplot(sim_screen_obj)

autoplot(
  sim_screen_obj,
  x_axis_var = "event_rate",
  constants = c(sim_auc = 0.8),
  dodge_width = 0.02,
  rename_vector = c(
    "Value-Optimising" = "value_optimising",
    "Treat-None" = "none",
    "Treat-All" = "all",
    "Youden Index" = "youden"
  )
)

</code></pre>

<hr>
<h2 id='autoplot.predictNMBsim'>Create plots of from predictNMB simulations.</h2><span id='topic+autoplot.predictNMBsim'></span>

<h3>Description</h3>

<p>Create plots of from predictNMB simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predictNMBsim'
autoplot(
  object,
  what = c("nmb", "inb", "cutpoints", "qalys", "costs"),
  inb_ref_col = NA,
  conf.level = 0.95,
  methods_order = NULL,
  n_bins = 40,
  label_wrap_width = 12,
  fill_cols = c("grey50", "#ADD8E6"),
  median_line_size = 2,
  median_line_alpha = 0.5,
  median_line_col = "black",
  rename_vector,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.predictNMBsim_+3A_object">object</code></td>
<td>
<p>A <code>predictNMBsim</code> object.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_what">what</code></td>
<td>
<p>What to summarise: one of &quot;nmb&quot;, &quot;inb&quot;, &quot;cutpoints&quot;, &quot;qalys&quot; or
&quot;costs&quot;. Defaults to &quot;nmb&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_inb_ref_col">inb_ref_col</code></td>
<td>
<p>Which cutpoint method to use as the reference strategy
when calculating the incremental net monetary benefit.
See <code>do_nmb_sim</code> for more information.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence level of the interval.
Defaults to 0.95 (coloured area of distribution represents 95% CIs).</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_methods_order">methods_order</code></td>
<td>
<p>The order (left to right) to display the
cutpoint methods.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_n_bins">n_bins</code></td>
<td>
<p>The number of bins used when constructing histograms.
Defaults to 40.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_label_wrap_width">label_wrap_width</code></td>
<td>
<p>The number of characters in facet labels at which
the label is wrapped. Default is 12.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_fill_cols">fill_cols</code></td>
<td>
<p>Vector containing the colours used for fill aesthetic of
histograms. The first colour represents the area outside of the confidence
region, second colour shows the confidence region. Defaults to
<code>c("grey50", "#ADD8E6")</code>.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_median_line_size">median_line_size</code></td>
<td>
<p>Size of line used to represent the median of
distribution. Defaults to 2.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_median_line_alpha">median_line_alpha</code></td>
<td>
<p>Alpha (transparency) for line used to represent the median of
distribution. Defaults to 0.5.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_median_line_col">median_line_col</code></td>
<td>
<p>Colour of line used to represent the median of
distribution. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_rename_vector">rename_vector</code></td>
<td>
<p>A named vector for renaming the methods in the summary.
The values of the vector are the default names and the names given are the
desired names in the output.</p>
</td></tr>
<tr><td><code id="autoplot.predictNMBsim_+3A_...">...</code></td>
<td>
<p>Additional (unused) arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot method works with <code>predictNMBsim</code> objects that are created
using <code>do_nmb_sim()</code>. Can be used to visualise distributions from
simulations for different cutpoint methods.
</p>


<h3>Value</h3>

<p>Returns a <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_nmb &lt;- function() c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
sim_obj &lt;- do_nmb_sim(
  sample_size = 200, n_sims = 50, n_valid = 10000, sim_auc = 0.7,
  event_rate = 0.1, fx_nmb_training = get_nmb, fx_nmb_evaluation = get_nmb,
  cutpoint_methods = c("all", "none", "youden", "value_optimising")
)

autoplot(
  sim_obj,
  rename_vector = c(
    "Value- Optimising" = "value_optimising",
    "Treat- None" = "none",
    "Treat- All" = "all",
    "Youden Index" = "youden"
  )
) + theme_sim()

</code></pre>

<hr>
<h2 id='ce_plot'>Create a cost-effectiveness plot.</h2><span id='topic+ce_plot'></span>

<h3>Description</h3>

<p>Create a cost-effectiveness plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ce_plot(
  object,
  ref_col,
  wtp,
  show_wtp = TRUE,
  methods_order = NULL,
  rename_vector,
  shape = 21,
  wtp_linetype = "dashed",
  add_prop_ce = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ce_plot_+3A_object">object</code></td>
<td>
<p>A <code>predictNMBsim</code> object.</p>
</td></tr>
<tr><td><code id="ce_plot_+3A_ref_col">ref_col</code></td>
<td>
<p>Which cutpoint method to use as the reference strategy
when calculating the incremental net monetary benefit. Often sensible to use
a &quot;all&quot; or &quot;none&quot; approach for this.</p>
</td></tr>
<tr><td><code id="ce_plot_+3A_wtp">wtp</code></td>
<td>
<p>A <code>numeric</code>. The willingness to pay (WTP) value used to create a
WTP threshold line on the plot (if <code>show_wtp = TRUE</code>). Defaults to the
WTP stored in the <code>predictNMBsim</code> object.</p>
</td></tr>
<tr><td><code id="ce_plot_+3A_show_wtp">show_wtp</code></td>
<td>
<p>A <code>logical</code>. Whether or not to show the willingness to
pay threshold.</p>
</td></tr>
<tr><td><code id="ce_plot_+3A_methods_order">methods_order</code></td>
<td>
<p>The order (within the legend) to display the
cutpoint methods.</p>
</td></tr>
<tr><td><code id="ce_plot_+3A_rename_vector">rename_vector</code></td>
<td>
<p>A named vector for renaming the methods in the summary.
The values of the vector are the default names and the names given are the
desired names in the output.</p>
</td></tr>
<tr><td><code id="ce_plot_+3A_shape">shape</code></td>
<td>
<p>The <code>shape</code> used for <code>ggplot2::geom_point()</code>.
Defaults to 21 (hollow circles). If <code>shape = "method"</code> or
<code>shape = "cost-effective"</code> (only applicable when <code>show_wtp = TRUE</code>)
, then the shape will be mapped to that aesthetic.</p>
</td></tr>
<tr><td><code id="ce_plot_+3A_wtp_linetype">wtp_linetype</code></td>
<td>
<p>The <code>linetype</code> used for <code>ggplot2::geom_abline()</code>
when making the WTP. Defaults to <code>"dashed"</code>.</p>
</td></tr>
<tr><td><code id="ce_plot_+3A_add_prop_ce">add_prop_ce</code></td>
<td>
<p>Whether to append the proportion of simulations for that
method which were cost-effective (beneath the WTP threshold)
to their labels in the legend. Only applicable when <code>show_wtp = TRUE</code>.</p>
</td></tr>
<tr><td><code id="ce_plot_+3A_...">...</code></td>
<td>
<p>Additional (unused) arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot method works with <code>predictNMBsim</code> objects that are created
using <code>do_nmb_sim()</code>. Can be used to visualise the simulations on a
cost-effectiveness plot (costs vs effectiveness)
</p>


<h3>Value</h3>

<p>Returns a <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_nmb_evaluation &lt;- get_nmb_sampler(
  qalys_lost = function() rnorm(1, 0.33, 0.03),
  wtp = 28000,
  high_risk_group_treatment_effect = function() exp(rnorm(n = 1, mean = log(0.58), sd = 0.43)),
  high_risk_group_treatment_cost = function() rnorm(n = 1, mean = 161, sd = 49)
)

sim_obj &lt;- do_nmb_sim(
  sample_size = 200, n_sims = 50, n_valid = 10000, sim_auc = 0.7,
  event_rate = 0.1, fx_nmb_training = get_nmb_evaluation, fx_nmb_evaluation = get_nmb_evaluation
)

ce_plot(sim_obj, ref_col = "all")

</code></pre>

<hr>
<h2 id='ce_plot.predictNMBsim'>Create a cost-effectiveness plot.</h2><span id='topic+ce_plot.predictNMBsim'></span>

<h3>Description</h3>

<p>Create a cost-effectiveness plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predictNMBsim'
ce_plot(
  object,
  ref_col,
  wtp,
  show_wtp = TRUE,
  methods_order = NULL,
  rename_vector,
  shape = 21,
  wtp_linetype = "dashed",
  add_prop_ce = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ce_plot.predictNMBsim_+3A_object">object</code></td>
<td>
<p>A <code>predictNMBsim</code> object.</p>
</td></tr>
<tr><td><code id="ce_plot.predictNMBsim_+3A_ref_col">ref_col</code></td>
<td>
<p>Which cutpoint method to use as the reference strategy
when calculating the incremental net monetary benefit. Often sensible to use
a &quot;all&quot; or &quot;none&quot; approach for this.</p>
</td></tr>
<tr><td><code id="ce_plot.predictNMBsim_+3A_wtp">wtp</code></td>
<td>
<p>A <code>numeric</code>. The willingness to pay (WTP) value used to create a
WTP threshold line on the plot (if <code>show_wtp = TRUE</code>). Defaults to the
WTP stored in the <code>predictNMBsim</code> object.</p>
</td></tr>
<tr><td><code id="ce_plot.predictNMBsim_+3A_show_wtp">show_wtp</code></td>
<td>
<p>A <code>logical</code>. Whether or not to show the WTP threshold.</p>
</td></tr>
<tr><td><code id="ce_plot.predictNMBsim_+3A_methods_order">methods_order</code></td>
<td>
<p>The order (within the legend) to display the
cutpoint methods.</p>
</td></tr>
<tr><td><code id="ce_plot.predictNMBsim_+3A_rename_vector">rename_vector</code></td>
<td>
<p>A named vector for renaming the methods in the summary.
The values of the vector are the default names and the names given are the
desired names in the output.</p>
</td></tr>
<tr><td><code id="ce_plot.predictNMBsim_+3A_shape">shape</code></td>
<td>
<p>The <code>shape</code> used for <code>ggplot2::geom_point()</code>.
Defaults to 21 (hollow circles). If <code>shape = "method"</code> or
<code>shape = "cost-effective"</code> (only applicable when <code>show_wtp = TRUE</code>)
, then the shape will be mapped to that aesthetic.</p>
</td></tr>
<tr><td><code id="ce_plot.predictNMBsim_+3A_wtp_linetype">wtp_linetype</code></td>
<td>
<p>The <code>linetype</code> used for <code>ggplot2::geom_abline()</code>
when making the WTP. Defaults to <code>"dashed"</code>.</p>
</td></tr>
<tr><td><code id="ce_plot.predictNMBsim_+3A_add_prop_ce">add_prop_ce</code></td>
<td>
<p>Whether to append the proportion of simulations for that
method which were cost-effective (beneath the WTP threshold)
to their labels in the legend. Only applicable when <code>show_wtp = TRUE</code>.</p>
</td></tr>
<tr><td><code id="ce_plot.predictNMBsim_+3A_...">...</code></td>
<td>
<p>Additional (unused) arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot method works with <code>predictNMBsim</code> objects that are created
using <code>do_nmb_sim()</code>. Can be used to visualise the simulations on a
cost-effectiveness plot (costs vs effectiveness)
</p>


<h3>Value</h3>

<p>Returns a <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_nmb_evaluation &lt;- get_nmb_sampler(
  qalys_lost = function() rnorm(1, 0.33, 0.03),
  wtp = 28000,
  high_risk_group_treatment_effect = function() exp(rnorm(n = 1, mean = log(0.58), sd = 0.43)),
  high_risk_group_treatment_cost = function() rnorm(n = 1, mean = 161, sd = 49)
)

sim_obj &lt;- do_nmb_sim(
  sample_size = 200, n_sims = 50, n_valid = 10000, sim_auc = 0.7,
  event_rate = 0.1, fx_nmb_training = get_nmb_evaluation, fx_nmb_evaluation = get_nmb_evaluation
)

ce_plot(sim_obj, ref_col = "all")

</code></pre>

<hr>
<h2 id='do_nmb_sim'>Do the predictNMB simulation, evaluating the net monetary benefit (NMB) of the
simulated model.</h2><span id='topic+do_nmb_sim'></span>

<h3>Description</h3>

<p>Do the predictNMB simulation, evaluating the net monetary benefit (NMB) of the
simulated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_nmb_sim(
  sample_size,
  n_sims,
  n_valid,
  sim_auc,
  event_rate,
  cutpoint_methods = get_inbuilt_cutpoint_methods(),
  fx_nmb_training,
  fx_nmb_evaluation,
  meet_min_events = TRUE,
  min_events = NA,
  show_progress = FALSE,
  cl = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_nmb_sim_+3A_sample_size">sample_size</code></td>
<td>
<p>Sample size of training set. If missing, a sample size
calculation will be performed and the calculated size will be used.</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_n_sims">n_sims</code></td>
<td>
<p>Number of simulations to run.</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_n_valid">n_valid</code></td>
<td>
<p>Sample size for evaluation set.</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_sim_auc">sim_auc</code></td>
<td>
<p>Simulated model discrimination (AUC).</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_event_rate">event_rate</code></td>
<td>
<p>Simulated event rate of the binary outcome being predicted.
Also known as prevalence.</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_cutpoint_methods">cutpoint_methods</code></td>
<td>
<p>A value or vector of cutpoint methods to include.
Defaults to use the inbuilt methods:
</p>

<ul>
<li><p>&quot;all&quot; = treat all patients (cutpoint = 0)
</p>
</li>
<li><p>&quot;none&quot; = treat no patients (cutpoint = 1)
</p>
</li>
<li><p>&quot;value_optimising&quot; = select the cutpoint that maximises NMB
</p>
</li>
<li><p>&quot;youden&quot; = select cutpoint based on the Youden index, also known as
the J-index (sensitivity + specificity - 1)
</p>
</li>
<li><p>&quot;cost_minimising&quot; = select the cutpoint that minimises expected value
of costs
</p>
</li>
<li><p>&quot;prod_sens_spec&quot; = product of sensitivity and specificity
(sensitivity * specificity)
</p>
</li>
<li><p>&quot;roc01&quot; = selects the closest threshold to the (0,1) point on the ROC
curve
</p>
</li></ul>

<p>User-defined cutpoint methods can be used by passing the name of a function
that takes the following arguments:
</p>

<ul>
<li><p><code>predicted</code> (predicted probabilities)
</p>
</li>
<li><p><code>actual</code> (the actual, binary outcome)
</p>
</li>
<li><p><code>nmb</code> (a named vector containing NMB values assigned to each
predicted class (i.e. c(&quot;TP&quot; = -3, &quot;TN&quot; = 0, &quot;FP&quot; = -1, &quot;FN&quot; = -4)))
</p>
</li></ul>

<p>See <code>?get_thresholds</code> for an example of a user-defined cutpoint
function.</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_fx_nmb_training">fx_nmb_training</code></td>
<td>
<p>Function or <code>NMBsampler</code> that returns a named vector of NMB assigned
to classifications used for obtaining cutpoint on training set.</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_fx_nmb_evaluation">fx_nmb_evaluation</code></td>
<td>
<p>Function or <code>NMBsampler</code> that returns a named vector of NMB
assigned to classifications used for obtaining cutpoint on evaluation set.</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_meet_min_events">meet_min_events</code></td>
<td>
<p>Whether or not to incrementally add samples until the
expected number of events (<code>sample_size * event_rate</code>) is met.
(Applies to sampling of training data only.)</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_min_events">min_events</code></td>
<td>
<p>The minimum number of events to include in the training
sample. If less than this number are included in sample of size
<code>sample_size</code>, additional samples are added until the <code>min_events</code> is met.
The default (<code>NA</code>) will use the expected value given the
<code>event_rate</code> and the <code>sample_size</code>.</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_show_progress">show_progress</code></td>
<td>
<p>Logical. Whether to display a progress bar. Requires the
<code>pbapply</code> package.</p>
</td></tr>
<tr><td><code id="do_nmb_sim_+3A_cl">cl</code></td>
<td>
<p>A cluster made using <code>parallel::makeCluster()</code>.
If a cluster is provided, the simulation will be done in parallel.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs a simulation for a given set of inputs that represent a
healthcare setting using model-guided interventions. <br /><br />
The arguments <code>fx_nmb_training</code> and <code>fx_nmb_evaluation</code>
should be functions that capture the treatment being used, its costs and
effectiveness, and the costs of the outcome being treated/prevented. <br /><br />
Both of these are functions that return a named vector of NMB values when
called and are used for obtaining and evaluating cutpoints, respectively.
For example, the following function returns the appropriately named vector.
<br /><br />
<code>get_nmb &lt;- function() c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)</code>
</p>
<p>There is a helper function, <code>get_nmb_sampler()</code>, to help you
create these.
</p>


<h3>Value</h3>

<p>Returns a <code>predictNMBsim</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_nmb &lt;- function() c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
do_nmb_sim(
  sample_size = 200, n_sims = 50, n_valid = 10000, sim_auc = 0.7,
  event_rate = 0.1, fx_nmb_training = get_nmb, fx_nmb_evaluation = get_nmb
)

</code></pre>

<hr>
<h2 id='evaluate_cutpoint_cost'>Evaluates a cutpoint by returning the mean treatment cost per sample.</h2><span id='topic+evaluate_cutpoint_cost'></span>

<h3>Description</h3>

<p>Evaluates a cutpoint by returning the mean treatment cost per sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_cutpoint_cost(predicted, actual, pt, nmb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_cutpoint_cost_+3A_predicted">predicted</code></td>
<td>
<p>A vector of predicted probabilities.</p>
</td></tr>
<tr><td><code id="evaluate_cutpoint_cost_+3A_actual">actual</code></td>
<td>
<p>A vector of actual outcomes.</p>
</td></tr>
<tr><td><code id="evaluate_cutpoint_cost_+3A_pt">pt</code></td>
<td>
<p>The probability threshold to be evaluated.</p>
</td></tr>
<tr><td><code id="evaluate_cutpoint_cost_+3A_nmb">nmb</code></td>
<td>
<p>A named vector containing NMB assigned to each classification and
the treatment costs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>numeric</code> value representing the mean cost for that
cutpoint and data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>evaluate_cutpoint_cost(
  predicted = runif(1000),
  actual = sample(c(0, 1), size = 1000, replace = TRUE),
  pt = 0.1,
  nmb = c(
    "qalys_lost" = 5,
    "low_risk_group_treatment_cost" = 0,
    "high_risk_group_treatment_cost" = 1,
    "low_risk_group_treatment_effect" = 0,
    "high_risk_group_treatment_effect" = 0.3,
    "outcome_cost" = 10
  )
)
</code></pre>

<hr>
<h2 id='evaluate_cutpoint_nmb'>Evaluates a cutpoint by returning the mean NMB per sample.</h2><span id='topic+evaluate_cutpoint_nmb'></span>

<h3>Description</h3>

<p>Evaluates a cutpoint by returning the mean NMB per sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_cutpoint_nmb(predicted, actual, pt, nmb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_cutpoint_nmb_+3A_predicted">predicted</code></td>
<td>
<p>A vector of predicted probabilities.</p>
</td></tr>
<tr><td><code id="evaluate_cutpoint_nmb_+3A_actual">actual</code></td>
<td>
<p>A vector of actual outcomes.</p>
</td></tr>
<tr><td><code id="evaluate_cutpoint_nmb_+3A_pt">pt</code></td>
<td>
<p>The probability threshold to be evaluated.</p>
</td></tr>
<tr><td><code id="evaluate_cutpoint_nmb_+3A_nmb">nmb</code></td>
<td>
<p>A named vector containing NMB assigned to each classification.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>numeric</code> value representing the NMB for that
cutpoint and data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>evaluate_cutpoint_nmb(
  predicted = runif(1000),
  actual = sample(c(0, 1), size = 1000, replace = TRUE),
  pt = 0.1,
  nmb = c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
)
</code></pre>

<hr>
<h2 id='evaluate_cutpoint_qalys'>Evaluates a cutpoint by returning the mean QALYs lost per sample.</h2><span id='topic+evaluate_cutpoint_qalys'></span>

<h3>Description</h3>

<p>Evaluates a cutpoint by returning the mean QALYs lost per sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_cutpoint_qalys(predicted, actual, pt, nmb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_cutpoint_qalys_+3A_predicted">predicted</code></td>
<td>
<p>A vector of predicted probabilities.</p>
</td></tr>
<tr><td><code id="evaluate_cutpoint_qalys_+3A_actual">actual</code></td>
<td>
<p>A vector of actual outcomes.</p>
</td></tr>
<tr><td><code id="evaluate_cutpoint_qalys_+3A_pt">pt</code></td>
<td>
<p>The probability threshold to be evaluated.</p>
</td></tr>
<tr><td><code id="evaluate_cutpoint_qalys_+3A_nmb">nmb</code></td>
<td>
<p>A named vector containing NMB assigned to each classification and
the treatment effects and QALYS lost due to the event of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>numeric</code> value representing the mean QALYs for that
cutpoint and data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>evaluate_cutpoint_qalys(
  predicted = runif(1000),
  actual = sample(c(0, 1), size = 1000, replace = TRUE),
  pt = 0.1,
  nmb = c(
    "qalys_lost" = 5,
    "low_risk_group_treatment_effect" = 0,
    "high_risk_group_treatment_effect" = 0.5
  )
)
</code></pre>

<hr>
<h2 id='get_inbuilt_cutpoint'>Get a cutpoint using the methods inbuilt to predictNMB</h2><span id='topic+get_inbuilt_cutpoint'></span>

<h3>Description</h3>

<p>Get a cutpoint using the methods inbuilt to predictNMB
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_inbuilt_cutpoint(predicted, actual, nmb, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_inbuilt_cutpoint_+3A_predicted">predicted</code></td>
<td>
<p>A vector of predicted probabilities</p>
</td></tr>
<tr><td><code id="get_inbuilt_cutpoint_+3A_actual">actual</code></td>
<td>
<p>A vector of actual outcomes</p>
</td></tr>
<tr><td><code id="get_inbuilt_cutpoint_+3A_nmb">nmb</code></td>
<td>
<p>A named vector containing NMB assigned to each classification</p>
</td></tr>
<tr><td><code id="get_inbuilt_cutpoint_+3A_method">method</code></td>
<td>
<p>A cutpoint selection method to be used
methods that can be used as the method argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a selected cutpoint (numeric).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get the list of available methods:
get_inbuilt_cutpoint_methods()

## get the cutpoint that maximises the Youden index for a given set of
## probabilities and outcomes
get_inbuilt_cutpoint(
  predicted = runif(1000),
  actual = sample(c(0, 1), size = 1000, replace = TRUE),
  method = "youden"
)

</code></pre>

<hr>
<h2 id='get_inbuilt_cutpoint_methods'>Get a vector of all the inbuilt cutpoint methods</h2><span id='topic+get_inbuilt_cutpoint_methods'></span>

<h3>Description</h3>

<p>Get a vector of all the inbuilt cutpoint methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_inbuilt_cutpoint_methods()
</code></pre>


<h3>Value</h3>

<p>Returns a vector cutpoint methods that can be used in
<code>do_nmb_sim()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_inbuilt_cutpoint_methods()
</code></pre>

<hr>
<h2 id='get_nmb_sampler'>Make a NMB sampler for use in <code>do_nmb_sim()</code> or
<code>screen_simulation_inputs()</code></h2><span id='topic+get_nmb_sampler'></span>

<h3>Description</h3>

<p>Make a NMB sampler for use in <code>do_nmb_sim()</code> or
<code>screen_simulation_inputs()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_nmb_sampler(
  outcome_cost,
  wtp,
  qalys_lost,
  high_risk_group_treatment_effect,
  high_risk_group_treatment_cost,
  low_risk_group_treatment_effect = 0,
  low_risk_group_treatment_cost = 0,
  use_expected_values = FALSE,
  nboot = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_nmb_sampler_+3A_outcome_cost">outcome_cost</code></td>
<td>
<p>The cost of the outcome. Must be provided if <code>wtp</code>
and <code>qalys_lost</code> are not.
Or can be used in addition to these arguments to represent additional cost
to the health burden.</p>
</td></tr>
<tr><td><code id="get_nmb_sampler_+3A_wtp">wtp</code></td>
<td>
<p>Willingness-to-pay.</p>
</td></tr>
<tr><td><code id="get_nmb_sampler_+3A_qalys_lost">qalys_lost</code></td>
<td>
<p>Quality-adjusted life years (QALYs) lost due to healthcare
event being predicted.</p>
</td></tr>
<tr><td><code id="get_nmb_sampler_+3A_high_risk_group_treatment_effect">high_risk_group_treatment_effect</code></td>
<td>
<p>The effect of the treatment provided
to patients given high risk prediction. Can be a number of a function.
Provide a function to incorporate uncertainty.</p>
</td></tr>
<tr><td><code id="get_nmb_sampler_+3A_high_risk_group_treatment_cost">high_risk_group_treatment_cost</code></td>
<td>
<p>The cost of the treatment provided to
patients given high risk prediction. Can be a number of a function.
Provide a function to incorporate uncertainty.</p>
</td></tr>
<tr><td><code id="get_nmb_sampler_+3A_low_risk_group_treatment_effect">low_risk_group_treatment_effect</code></td>
<td>
<p>The effect of the treatment provided
to patients given low risk prediction. Can be a number of a function.
Provide a function to incorporate uncertainty. Defaults to 0 (no treatment).</p>
</td></tr>
<tr><td><code id="get_nmb_sampler_+3A_low_risk_group_treatment_cost">low_risk_group_treatment_cost</code></td>
<td>
<p>The cost of the treatment provided to
patients given low risk prediction. Can be a number of a function.
Provide a function to incorporate uncertainty. Defaults to 0 (no treatment).</p>
</td></tr>
<tr><td><code id="get_nmb_sampler_+3A_use_expected_values">use_expected_values</code></td>
<td>
<p>Logical. If <code>TRUE</code>, gets the mean of many
samples from the produced function and returns these every time. This is a
sensible choice when using the resulting function for selecting the cutpoint.
See <code>fx_nmb_training</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="get_nmb_sampler_+3A_nboot">nboot</code></td>
<td>
<p>The number of samples to use when creating a function that
returns the expected values. Defaults to 10000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>NMBsampler</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_nmb_training &lt;- get_nmb_sampler(
  outcome_cost = 100,
  high_risk_group_treatment_effect = function() rbeta(1, 1, 2),
  high_risk_group_treatment_cost = 10,
  use_expected_values = TRUE
)
get_nmb_evaluation &lt;- get_nmb_sampler(
  outcome_cost = 100,
  high_risk_group_treatment_effect = function() rbeta(1, 1, 2),
  high_risk_group_treatment_cost = 10
)

get_nmb_training()
get_nmb_training()
get_nmb_training()
get_nmb_evaluation()
get_nmb_evaluation()
get_nmb_evaluation()
</code></pre>

<hr>
<h2 id='get_sample'>Samples data for a prediction model with a specified AUC and prevalence.</h2><span id='topic+get_sample'></span>

<h3>Description</h3>

<p>Samples data for a prediction model with a specified AUC and prevalence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sample(auc, n_samples, prevalence, min_events = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_sample_+3A_auc">auc</code></td>
<td>
<p>The Area Under the (receiver operating characteristic) Curve.</p>
</td></tr>
<tr><td><code id="get_sample_+3A_n_samples">n_samples</code></td>
<td>
<p>Number of samples to draw.</p>
</td></tr>
<tr><td><code id="get_sample_+3A_prevalence">prevalence</code></td>
<td>
<p>Prevalence or event rate of the binary outcome as
a proportion (0.1 = 10%).</p>
</td></tr>
<tr><td><code id="get_sample_+3A_min_events">min_events</code></td>
<td>
<p>Minimum number of events required in the sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>data.frame</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_sample(0.7, 1000, 0.1)
</code></pre>

<hr>
<h2 id='get_thresholds'>Gets probability thresholds given predicted probabilities, outcomes and NMB.</h2><span id='topic+get_thresholds'></span>

<h3>Description</h3>

<p>Gets probability thresholds given predicted probabilities, outcomes and NMB.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_thresholds(predicted, actual, nmb, cutpoint_methods = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_thresholds_+3A_predicted">predicted</code></td>
<td>
<p>A vector of predicted probabilities.</p>
</td></tr>
<tr><td><code id="get_thresholds_+3A_actual">actual</code></td>
<td>
<p>A vector of actual outcomes.</p>
</td></tr>
<tr><td><code id="get_thresholds_+3A_nmb">nmb</code></td>
<td>
<p>A named vector containing NMB assigned to true positives,
true negatives, false positives and false negatives</p>
</td></tr>
<tr><td><code id="get_thresholds_+3A_cutpoint_methods">cutpoint_methods</code></td>
<td>
<p>Which cutpoint method(s) to return.
The default (NULL) uses all the inbuilt methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>list</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# get thresholds using default (all inbuilt) cutpoint methods
get_thresholds(
  predicted = runif(1000),
  actual = sample(c(0, 1), size = 1000, replace = TRUE),
  nmb = c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
)


# get cutpoints using user-defined functions
# These functions must take the \code{predicted} and \code{actual}
# as arguments. They can also take \code{nmb} (named vector containing NMB
# with values for TP, FP, TN, FN).
fx_roc01 &lt;- function(predicted, actual, ...) {
  cutpointr::cutpointr(
    x = predicted, class = actual, method = cutpointr::minimize_metric,
    metric = cutpointr::roc01,
    silent = TRUE
  )[["optimal_cutpoint"]]
}

fx_sum_sens_spec &lt;- function(predicted, actual, ...) {
  cutpointr::cutpointr(
    x = predicted, class = actual, method = cutpointr::maximize_metric,
    metric = cutpointr::sum_sens_spec,
    silent = TRUE
  )[["optimal_cutpoint"]]
}

get_thresholds(
  predicted = runif(1000),
  actual = sample(c(0, 1), size = 1000, replace = TRUE),
  cutpoint_methods = c("fx_roc01", "fx_sum_sens_spec"),
  nmb = c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
)

# get a combination of cutpoints from both user-defined functions and
# inbuilt methods
get_thresholds(
  predicted = runif(1000),
  actual = sample(c(0, 1), size = 1000, replace = TRUE),
  cutpoint_methods = c(
    "fx_roc01",
    "fx_sum_sens_spec",
    "youden",
    "all",
    "none"
  ),
  nmb = c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
)

</code></pre>

<hr>
<h2 id='print.predictNMBscreen'>Print a summary of a predictNMBscreen object</h2><span id='topic+print.predictNMBscreen'></span>

<h3>Description</h3>

<p>Print a summary of a predictNMBscreen object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predictNMBscreen'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.predictNMBscreen_+3A_x">x</code></td>
<td>
<p>A <code>predictNMBscreen</code> object.</p>
</td></tr>
<tr><td><code id="print.predictNMBscreen_+3A_...">...</code></td>
<td>
<p>Optional, ignored arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>print(x)</code> returns <code>x</code> invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_nmb &lt;- function() c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
sim_screen_obj &lt;- screen_simulation_inputs(
  n_sims = 50, n_valid = 10000, sim_auc = seq(0.7, 0.9, 0.1),
  event_rate = 0.1,
  fx_nmb_training = get_nmb, fx_nmb_evaluation = get_nmb
)
print(sim_screen_obj)

</code></pre>

<hr>
<h2 id='print.predictNMBsim'>Print a summary of a predictNMBsim object</h2><span id='topic+print.predictNMBsim'></span>

<h3>Description</h3>

<p>Print a summary of a predictNMBsim object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predictNMBsim'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.predictNMBsim_+3A_x">x</code></td>
<td>
<p>A <code>predictNMBsim</code> object.</p>
</td></tr>
<tr><td><code id="print.predictNMBsim_+3A_...">...</code></td>
<td>
<p>Optional, ignored arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>print(x)</code> returns <code>x</code> invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_nmb &lt;- function() c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
sim_obj &lt;- do_nmb_sim(
  sample_size = 200, n_sims = 50, n_valid = 10000, sim_auc = 0.7,
  event_rate = 0.1, fx_nmb_training = get_nmb, fx_nmb_evaluation = get_nmb
)
print(sim_obj)

</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+autoplot'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ggplot2</dt><dd><p><code><a href="ggplot2.html#topic+autoplot">autoplot</a></code></p>
</dd>
</dl>

<hr>
<h2 id='screen_simulation_inputs'>Screen many simulation inputs: a parent function to <code>do_nmb_sim()</code></h2><span id='topic+screen_simulation_inputs'></span>

<h3>Description</h3>

<p>Runs <code>do_nmb_sim()</code> with a range of inputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>screen_simulation_inputs(
  sample_size,
  n_sims,
  n_valid,
  sim_auc,
  event_rate,
  cutpoint_methods = get_inbuilt_cutpoint_methods(),
  fx_nmb_training,
  fx_nmb_evaluation,
  pair_nmb_train_and_evaluation_functions = FALSE,
  meet_min_events = TRUE,
  min_events = NA,
  show_progress = FALSE,
  cl = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screen_simulation_inputs_+3A_sample_size">sample_size</code></td>
<td>
<p>A value (or vector of values): Sample size of training
set. If missing, a sample size calculation will be performed and the
calculated size will be used.</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_n_sims">n_sims</code></td>
<td>
<p>A value (or vector of values): Number of simulations to run.</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_n_valid">n_valid</code></td>
<td>
<p>A value (or vector of values): Sample size for evaluation set.</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_sim_auc">sim_auc</code></td>
<td>
<p>A value (or vector of values): Simulated model discrimination
(AUC).</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_event_rate">event_rate</code></td>
<td>
<p>A value (or vector of values): simulated event rate of the
binary outcome being predicted.</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_cutpoint_methods">cutpoint_methods</code></td>
<td>
<p>cutpoint methods to include. Defaults to use the
inbuilt methods. This doesn't change across calls to <code>do_nmb_sim()</code>.</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_fx_nmb_training">fx_nmb_training</code></td>
<td>
<p>A function or <code>NMBsampler</code> (or list of) that returns named
vector of NMB assigned to classifications use for obtaining cutpoint on
training set.</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_fx_nmb_evaluation">fx_nmb_evaluation</code></td>
<td>
<p>A function or <code>NMBsampler</code> (or list of) that returns
named vector of NMB assigned to classifications use for obtaining cutpoint
on evaluation set.</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_pair_nmb_train_and_evaluation_functions">pair_nmb_train_and_evaluation_functions</code></td>
<td>
<p><code>logical</code>.
Whether or not to pair the lists of functions passed for
<code>fx_nmb_training</code> and <code>fx_nmb_evaluation</code>. If two treatment
strategies are being used, it may make more sense to pair these because
selecting a value-optimising or cost-minimising threshold using one strategy
but evaluating another is likely unwanted.</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_meet_min_events">meet_min_events</code></td>
<td>
<p>Whether or not to incrementally add samples until the
expected number of events (<code>sample_size * event_rate</code>) is met.
(Applies to sampling of training data only.)</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_min_events">min_events</code></td>
<td>
<p>A value: the minimum number of events to include in the
training sample. If less than this number are included in sample of size
<code>sample_size</code>, additional samples are added until the min_events is met.
The default (<code>NA</code>) will use the expected value given the
<code>event_rate</code> and the <code>sample_size</code>.</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_show_progress">show_progress</code></td>
<td>
<p>Logical. Whether to display a progress bar.</p>
</td></tr>
<tr><td><code id="screen_simulation_inputs_+3A_cl">cl</code></td>
<td>
<p>A cluster made using <code>parallel::makeCluster()</code>. If a cluster
is provided, the simulation will be done in parallel.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>predictNMBscreen</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Screen for optimal cutpoints given increasing values of
# model discrimination (sim_auc)

get_nmb &lt;- function() c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
sim_screen_obj &lt;- screen_simulation_inputs(
  n_sims = 50, n_valid = 10000, sim_auc = seq(0.7, 0.9, 0.1),
  event_rate = 0.1, fx_nmb_training = get_nmb, fx_nmb_evaluation = get_nmb
)

</code></pre>

<hr>
<h2 id='summary.predictNMBscreen'>Create table summaries of <code>predictNMBscreen</code> objects.</h2><span id='topic+summary.predictNMBscreen'></span>

<h3>Description</h3>

<p>Create table summaries of <code>predictNMBscreen</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predictNMBscreen'
summary(
  object,
  what = c("nmb", "inb", "cutpoints"),
  inb_ref_col = NULL,
  agg_functions = list(median = function(x) {
     round(stats::median(x), digits = 2)

    }, `95% CI` = function(x) {
     paste0(round(stats::quantile(x, probs = c(0.025,
    0.975)), digits = 1), collapse = " to ")
 }),
  rename_vector,
  show_full_inputs = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.predictNMBscreen_+3A_object">object</code></td>
<td>
<p>A <code>predictNMBscreen</code> object.</p>
</td></tr>
<tr><td><code id="summary.predictNMBscreen_+3A_what">what</code></td>
<td>
<p>What to summarise: one of &quot;nmb&quot;, &quot;inb&quot; or &quot;cutpoints&quot;.
Defaults to &quot;nmb&quot;.</p>
</td></tr>
<tr><td><code id="summary.predictNMBscreen_+3A_inb_ref_col">inb_ref_col</code></td>
<td>
<p>Which cutpoint method to use as the reference strategy
when calculating the incremental net monetary benefit. See <code>do_nmb_sim</code>
for more information.</p>
</td></tr>
<tr><td><code id="summary.predictNMBscreen_+3A_agg_functions">agg_functions</code></td>
<td>
<p>A named list of functions to use to aggregate the
selected values. Defaults to the median and 95% interval.</p>
</td></tr>
<tr><td><code id="summary.predictNMBscreen_+3A_rename_vector">rename_vector</code></td>
<td>
<p>A named vector for renaming the methods in the summary.
The values of the vector are the default names and the names given are the
desired names in the output.</p>
</td></tr>
<tr><td><code id="summary.predictNMBscreen_+3A_show_full_inputs">show_full_inputs</code></td>
<td>
<p>A logical. Whether or not to include the inputs used
for simulation alongside aggregations.</p>
</td></tr>
<tr><td><code id="summary.predictNMBscreen_+3A_...">...</code></td>
<td>
<p>Additional, ignored arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Table summaries will be based on the <code>what</code> argument.
Using &quot;nmb&quot; returns the simulated values for NMB, with no reference group;
&quot;inb&quot; returns the difference between simulated values for NMB and a set
strategy defined by <code>inb_ref_col</code>; &quot;cutpoints&quot; returns the cutpoints
selected (0, 1).
</p>


<h3>Value</h3>

<p>Returns a <code>tibble</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# perform screen with increasing values of model discimination (sim_auc)

get_nmb &lt;- function() c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
sim_screen_obj &lt;- screen_simulation_inputs(
  n_sims = 50, n_valid = 10000, sim_auc = seq(0.7, 0.9, 0.1),
  event_rate = 0.1, fx_nmb_training = get_nmb, fx_nmb_evaluation = get_nmb,
  cutpoint_methods = c("all", "none", "youden", "value_optimising")
)
summary(
  sim_screen_obj,
  rename_vector = c(
    "Value_Optimising" = "value_optimising",
    "Treat_None" = "none",
    "Treat_All" = "all",
    "Youden_Index" = "youden"
  )
)

</code></pre>

<hr>
<h2 id='summary.predictNMBsim'>Create table summaries of <code>predictNMBsim</code> objects.</h2><span id='topic+summary.predictNMBsim'></span>

<h3>Description</h3>

<p>Create table summaries of <code>predictNMBsim</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predictNMBsim'
summary(
  object,
  what = c("nmb", "inb", "cutpoints"),
  inb_ref_col = NULL,
  agg_functions = list(median = function(x) {
     round(stats::median(x), digits = 2)

    }, `95% CI` = function(x) {
     paste0(round(stats::quantile(x, probs = c(0.025,
    0.975)), digits = 1), collapse = " to ")
 }),
  rename_vector,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.predictNMBsim_+3A_object">object</code></td>
<td>
<p>A <code>predictNMBsim</code> object.</p>
</td></tr>
<tr><td><code id="summary.predictNMBsim_+3A_what">what</code></td>
<td>
<p>What to summarise: one of &quot;nmb&quot;, &quot;inb&quot; or &quot;cutpoints&quot;.
Defaults to &quot;nmb&quot;.</p>
</td></tr>
<tr><td><code id="summary.predictNMBsim_+3A_inb_ref_col">inb_ref_col</code></td>
<td>
<p>Which cutpoint method to use as the reference strategy
when calculating the incremental net monetary benefit. See <code>do_nmb_sim</code>
for more information.</p>
</td></tr>
<tr><td><code id="summary.predictNMBsim_+3A_agg_functions">agg_functions</code></td>
<td>
<p>A named list of functions to use to aggregate the
selected values. Defaults to the median and 95% interval.</p>
</td></tr>
<tr><td><code id="summary.predictNMBsim_+3A_rename_vector">rename_vector</code></td>
<td>
<p>A named vector for renaming the methods in the summary.
The values of the vector are the default names and the names given are the
desired names in the output.</p>
</td></tr>
<tr><td><code id="summary.predictNMBsim_+3A_...">...</code></td>
<td>
<p>Additional, ignored arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Table summaries will be based on the <code>what</code> argument.
Using &quot;nmb&quot; returns the simulated values for NMB, with no reference group;
&quot;inb&quot; returns the difference between simulated values for NMB and a set
strategy defined by <code>inb_ref_col</code>; &quot;cutpoints&quot; returns the cutpoints
selected (0, 1).
</p>


<h3>Value</h3>

<p>Returns a <code>tibble</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# perform simulation with do_nmb_sim()

get_nmb &lt;- function() c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
sim_obj &lt;- do_nmb_sim(
  sample_size = 200, n_sims = 50, n_valid = 10000, sim_auc = 0.7,
  event_rate = 0.1, fx_nmb_training = get_nmb, fx_nmb_evaluation = get_nmb,
  cutpoint_methods = c("all", "none", "youden", "value_optimising")
)
summary(
  sim_obj,
  rename_vector = c(
    "Value_Optimising" = "value_optimising",
    "Treat_None" = "none",
    "Treat_All" = "all",
    "Youden_Index" = "youden"
  )
)

</code></pre>

<hr>
<h2 id='theme_sim'>Returns a <code>ggplot2</code> theme that reduces clutter in an <code>autoplot()</code>
of a <code>predictNMBsim</code> object.</h2><span id='topic+theme_sim'></span>

<h3>Description</h3>

<p>Returns a <code>ggplot2</code> theme that reduces clutter in an <code>autoplot()</code>
of a <code>predictNMBsim</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_sim()
</code></pre>


<h3>Value</h3>

<p>Returns a <code>ggplot2</code> theme.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
get_nmb &lt;- function() c("TP" = -3, "TN" = 0, "FP" = -1, "FN" = -4)
sim_obj &lt;- do_nmb_sim(
  sample_size = 200, n_sims = 50, n_valid = 10000, sim_auc = 0.7,
  event_rate = 0.1, fx_nmb_training = get_nmb, fx_nmb_evaluation = get_nmb
)

autoplot(sim_obj) + theme_sim()


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
