<!DOCTYPE html><html><head><title>Help for package MHTrajectoryR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MHTrajectoryR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MHTrajectoryR-package'><p>Detection of adverse drug events by analyzing Metropolis-Hastings Markov chain trajectory.</p></a></li>
<li><a href='#Analyze_oneAE'>
<p>Signal detection using via variable selection in logistic regression.</p>
The Bayesian Information Criterion maximization is assessed using Metropolis-Hastings
algorithm.</a></li>
<li><a href='#exampleAE'><p>A simulated data</p></a></li>
<li><a href='#exampleDrugs'><p>A simulated data</p></a></li>
<li><a href='#OmopReference'>
<p>The OMOP reference set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Model Selection in Logistic Regression for the
Detection of Adverse Drug Reactions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-02-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthieu Marbac and Mohammed Sedki</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mohammed Sedki &lt;Mohammed.sedki@u-psud.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Spontaneous adverse event reports have a high potential for detecting adverse drug reactions. However, due to their dimension, the analysis of such databases requires statistical methods. We propose to use a logistic regression whose sparsity is viewed as a model selection challenge. Since the model space is huge, a Metropolis-Hastings algorithm carries out the model selection by maximizing the BIC criterion.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel, mgcv</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-04-05 12:48:04 UTC; sedki</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-04-05 17:40:22</td>
</tr>
</table>
<hr>
<h2 id='MHTrajectoryR-package'>Detection of adverse drug events by analyzing Metropolis-Hastings Markov chain trajectory.
</h2><span id='topic+MHTrajectoryR-package'></span><span id='topic+MHTrajectoryR'></span>

<h3>Description</h3>

<p>Spontaneous adverse event reports have a high potential for detecting adverse drug reactions.
However, due to their dimension, the analysis of such databases requires statistical methods.
The MHTrajectoryR package propose to use a logistic regression whose sparsity is viewed as a model selection
challenge. Since the model space is huge, a Metropolis-Hastings algorithm carries out the model selection
by maximizing the BIC criterion through Markov chain trajectory.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MHTrajectoryR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-02-07</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The main function is Analyze_oneAE.
</p>


<h3>Author(s)</h3>

<p>Matthieu Marbac and Mohammed Sedki
Maintainer: Mohammed Sedki &lt;mohammed.sedki@u-psud.fr&gt;
</p>


<h3>References</h3>

<p>Matthieu Marbac, Pascale Tubert-Bitter, Mohammed Sedki: 
Bayesian model selection in logistic regression for the detection
of adverse drug reactions. (http://arxiv.org/abs/1505.03366) (accepted for publication
in Biometrical Journal).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  data(exampleAE)
  data(exampleDrugs)
  res &lt;- Analyze_oneAE(exampleAE[,1], exampleDrugs, 10, 1, 10)
  # print signals (drugs relied to the adverse event)
  print(res$signal)

## End(Not run)
</code></pre>

<hr>
<h2 id='Analyze_oneAE'>
Signal detection using via variable selection in logistic regression. 
The Bayesian Information Criterion maximization is assessed using Metropolis-Hastings
algorithm.
</h2><span id='topic+Analyze_oneAE'></span>

<h3>Description</h3>

<p>Spontaneous adverse event reports have a high potential for detecting adverse drug reactions.
However, due to their dimension, the analysis of such databases requires statistical methods.
The MHTrajectoryR package propose to use a logistic regression whose sparsity is viewed as a model selection
challenge. Since the model space is huge, a Metropolis-Hastings algorithm carries out the model selection
by maximizing the BIC criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Analyze_oneAE(ae, drug, maxit, alpha, nbinit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Analyze_oneAE_+3A_ae">ae</code></td>
<td>

<p>The response binary vector which indicates if the adverse event is observed (value 1)
and (value 0) otherwise. It must have the sime length with the number of rows of matrix of drugs
consumption.
</p>
</td></tr>
<tr><td><code id="Analyze_oneAE_+3A_drug">drug</code></td>
<td>

<p>The matrix of drugs consumption or the matrix of binary covariates. 
Each row corresponds to one individual drugs consumption. Each column corresponds
to one drug.
</p>
</td></tr>
<tr><td><code id="Analyze_oneAE_+3A_maxit">maxit</code></td>
<td>

<p>Number of iteration of the Metropolis-Hastings algorithm. 
In other words, the length of one trajectory of the Metropolis-Hastings
Markov Chain.
</p>
</td></tr>
<tr><td><code id="Analyze_oneAE_+3A_alpha">alpha</code></td>
<td>

<p>The parameter that define the neighbordhood. 
</p>
</td></tr>
<tr><td><code id="Analyze_oneAE_+3A_nbinit">nbinit</code></td>
<td>

<p>The number of random initialisations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p> list of  (best) the best model that maximize the BIC.  (all) all explored models through the trajectory.
(signals) the detected signals (positive, negative or unknown) in OMOP reference set. 
</p>


<h3>Author(s)</h3>

<p>Mohammed Sedki and Matthieu Marbac
</p>


<h3>References</h3>

<p>Matthieu Marbac, Pascale Tubert-Bitter, Mohammed Sedki: 
Bayesian model selection in logistic regression for the detection
of adverse drug reactions. <a href="http://arxiv.org/abs/1505.03366">http://arxiv.org/abs/1505.03366</a> (accepted for publication
in Biometrical Journal).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  data(exampleAE)
  data(exampleDrugs)
  res &lt;- Analyze_oneAE(exampleAE[,1], exampleDrugs, 10, 1, 10)
  # print signals (drugs relied to the adverse event)
  print(res$signal)

## End(Not run)
</code></pre>

<hr>
<h2 id='exampleAE'>A simulated data</h2><span id='topic+exampleAE'></span>

<h3>Description</h3>

<p>This simulated data indicates the adverse events of 100 individuals about 5 events (0: absence, 1: presence)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(exampleAE)
</code></pre>

<hr>
<h2 id='exampleDrugs'>A simulated data</h2><span id='topic+exampleDrugs'></span>

<h3>Description</h3>

<p>This simulated data indicates the drugs consumption of 100 individuals about 100 drugs (0: absence, 1: presence)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(exampleDrugs)
</code></pre>

<hr>
<h2 id='OmopReference'>
The OMOP reference set
</h2><span id='topic+OmopReference'></span>

<h3>Description</h3>

<p>The OMOP Ryan et al.(2013) reference set of test cases that contains both positive and negative controls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(OmopReference)</code></pre>


<h3>Format</h3>

<p>A set of 399 negative and positive controls or couples of adverse event and drug.
</p>

<dl>
<dt><code>AE</code></dt><dd><p>a character vector  indicating adverse events</p>
</dd>
<dt><code>ATC</code></dt><dd><p>The Anatomical Therapeutic Chemical (ATC) code</p>
</dd>
<dt><code>statu</code></dt><dd><p>a numeric vector indicating if positive (1) or negative (0) control</p>
</dd>
</dl>



<h3>Details</h3>

<p>To evaluate and compare the performances of the competing methods, we use the OMOP 
Ryan et al.(2013) reference set of test cases that contains both positive and negative 
controls. Four adverse events (i.e. d = 4) were studied in this reference set : 
acute myocardial infarction (AMI), acute kidney injury (AKI), acute liver injury (ALI), and 
upper gastro-intestinal bleeding (GIB). There are three-hundred and ninety-nine test cases 
where 165 positive controls and 234 negative controls were identified across the
four adverse events of interest. More details are given by Table 1. Ryan et al. (2013) 
indicate that the majority of positive controls for AKI and GIB were supported by randomized 
clinical trial evidence, while the majority of positive controls for ALI and AMI were only based 
on published case reports. Then a positive control is a pair (drug and adverse event) which is 
supported by randomized clinical trial evidence or based on published case reports whereas a 
negative control is not met by neither of the these methods.
</p>


<h3>Source</h3>

<p>Ryan, P., Schuemie, M., Welebob, E., Duke, J., Valentine, S., and Hartzema, A. (2013). 
Defining a reference set to support methodological research in drug safety. Drug safety, 36(1), 33-47.
</p>


<h3>References</h3>

<p>Ryan, P., Schuemie, M., Welebob, E., Duke, J., Valentine, S., and Hartzema, A. (2013). 
Defining a reference set to support methodological research in drug safety. Drug safety, 36(1), 33-47.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(OmopReference)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
