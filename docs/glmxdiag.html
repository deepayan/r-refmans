<!DOCTYPE html><html><head><title>Help for package glmxdiag</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {glmxdiag}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#avplot'><p>Added Variable Plot</p></a></li>
<li><a href='#cookDist'>
<p>Visualize Cook's distances</p></a></li>
<li><a href='#devAnalysis'>
<p>Graphical analysis of Deviance</p></a></li>
<li><a href='#DFbeta'><p>Visualize DFbetas</p></a></li>
<li><a href='#diabetes'><p>Diabetes</p></a></li>
<li><a href='#funComp'>
<p>Compatibility of functions</p></a></li>
<li><a href='#influenceDiag'>
<p>Influence Diagnostic Measures</p></a></li>
<li><a href='#leverage'>
<p>Visualize Leverages</p></a></li>
<li><a href='#linkLin'><p>Checking linearity of link function</p></a></li>
<li><a href='#moons'><p>Moons of the 13 planets of the Solar System</p></a></li>
<li><a href='#Qresiduals'><p>Graphical normality testing for quantile residuals</p></a></li>
<li><a href='#stopping'><p>Stopping</p></a></li>
<li><a href='#varCheck'><p>Checking adequacy of variance function</p></a></li>
<li><a href='#variableOut'><p>Excluding a variable from the model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-01-04</td>
</tr>
<tr>
<td>Title:</td>
<td>A Collection of Graphic Tools for GLM Diagnostics and some
Extensions</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides diagnostic graphic tools for GLMs, beta-binomial regression model (estimated by 'VGAM' package), beta regression model (estimated by 'betareg' package) and negative binomial regression model (estimated by 'MASS' package). Since most of functions implemented in 'glmxdiag' already exist in other packages, the aim is to provide the user unique functions that work on almost all regression models previously specified. Details about some of the implemented functions can be found in Brown (1992) &lt;<a href="https://doi.org/10.2307%2F2347617">doi:10.2307/2347617</a>&gt;, Dunn and Smyth (1996) &lt;<a href="https://doi.org/10.2307%2F1390802">doi:10.2307/1390802</a>&gt;, O'Hara Hines and Carter (1993) &lt;<a href="https://doi.org/10.2307%2F2347405">doi:10.2307/2347405</a>&gt;, Wang (1985) &lt;<a href="https://doi.org/10.2307%2F1269708">doi:10.2307/1269708</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-06 13:18:39 UTC; peppe</td>
</tr>
<tr>
<td>Author:</td>
<td>Giuseppe Reale [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Giuseppe Reale &lt;giuseppe.reale97@gmail.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>VGAM</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-10 08:32:45 UTC</td>
</tr>
</table>
<hr>
<h2 id='avplot'>Added Variable Plot</h2><span id='topic+avplot'></span>

<h3>Description</h3>

<p>Constructs added variable plots for generalized linear models and extensions admitted by <code>glmxdiag</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>avplot(model, variables, type = c("Wang", "Hines-Carter"), label.id,
              n.label.id, xlab, ylab, main, pos, pch, cex, lcol, lwd, lty, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="avplot_+3A_model">model</code></td>
<td>
<p>a model supported by <code>glmxdiag</code>.</p>
</td></tr>
<tr><td><code id="avplot_+3A_variables">variables</code></td>
<td>
<p>a vector of characters containing names of regressors; must be included inside the model matrix. If nothing is specified, avplot is applied on all variables.</p>
</td></tr>
<tr><td><code id="avplot_+3A_type">type</code></td>
<td>
<p>default is &quot;<code>Wang</code>&quot; developed by Wang (1985); if &quot;<code>Hines-Carter</code>&quot; the method developed by Hines and Carter (1993) is used.</p>
</td></tr>
<tr><td><code id="avplot_+3A_label.id">label.id</code></td>
<td>
<p>labels of observations, should be a vector with n elements</p>
</td></tr>
<tr><td><code id="avplot_+3A_n.label.id">n.label.id</code></td>
<td>
<p>number of observations to label in the plot that most influence the &quot;clean&quot; relationship of considered variables. Cook's distance is used as the measure of influence.</p>
</td></tr>
<tr><td><code id="avplot_+3A_xlab">xlab</code></td>
<td>
<p>title for the x axis.</p>
</td></tr>
<tr><td><code id="avplot_+3A_ylab">ylab</code></td>
<td>
<p>title for the y axis.</p>
</td></tr>
<tr><td><code id="avplot_+3A_main">main</code></td>
<td>
<p>an overall title for the plot.</p>
</td></tr>
<tr><td><code id="avplot_+3A_pos">pos</code></td>
<td>
<p>position of observations labels. Values <code>1, 2, 3, 4</code> respectively indicate below, left, above, right.</p>
</td></tr>
<tr><td><code id="avplot_+3A_pch">pch</code></td>
<td>
<p>type of points.</p>
</td></tr>
<tr><td><code id="avplot_+3A_cex">cex</code></td>
<td>
<p>size of points.</p>
</td></tr>
<tr><td><code id="avplot_+3A_lcol">lcol</code></td>
<td>
<p>color of line.</p>
</td></tr>
<tr><td><code id="avplot_+3A_lwd">lwd</code></td>
<td>
<p>width of line.</p>
</td></tr>
<tr><td><code id="avplot_+3A_lty">lty</code></td>
<td>
<p>type of line.</p>
</td></tr>
<tr><td><code id="avplot_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The aim of added variable plot is to isolate the relationship between a specific variable and the response, i.e. fixing all the other variables included in the linear predictor. In the y-axis there are the <em>working residuals</em> of the reduced model (i.e. a model where the variable we're interested in, say &quot;x&quot;, is excluded) while on the x-axis there are the residuals of regression of x using all the other variables.
Values in both axis are weighted: Wang (1985) uses the <em>working weights</em> of the reduced model while Hines and Carter (1993) suggest that using the weights of the full model is more reliable in indicating the presence of influential observations.
</p>


<h3>Value</h3>

<p>Doesn't return a value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>References</h3>

<p>Wang, P C. (1985) Adding a variable in generalized linear models. Technometrics 27, 273-276.
</p>
<p>R. J. O'Hara Hines, &amp; Carter, E. M. (1993). Improved Added Variable and Partial Residual Plots for the Detection of Influential Observations in Generalized Linear Models. Journal of the Royal Statistical Society. Series C (Applied Statistics), 42(1), 3-20.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(moons)
m &lt;- glm(Moons ~ Mass + Distance + Diameter, 
         family = poisson, data = moons)
summary(m)
avplot(m, 'Distance', label.id = moons$Name)

</code></pre>

<hr>
<h2 id='cookDist'>
Visualize Cook's distances
</h2><span id='topic+cookDist'></span>

<h3>Description</h3>

<p>Graphical visualization of Cook's distances for each observation within input model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cookDist(object, label.id, n.label.id, xlab, ylab, pos, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cookDist_+3A_object">object</code></td>
<td>
<p>object of class 'influence', see Details.</p>
</td></tr>
<tr><td><code id="cookDist_+3A_label.id">label.id</code></td>
<td>
<p>labels of observations, should be a vector with n elements.</p>
</td></tr>
<tr><td><code id="cookDist_+3A_n.label.id">n.label.id</code></td>
<td>
<p>number of observations with highest Cook's distance to label in the plot.</p>
</td></tr>
<tr><td><code id="cookDist_+3A_xlab">xlab</code></td>
<td>
<p>title for the x axis.</p>
</td></tr>
<tr><td><code id="cookDist_+3A_ylab">ylab</code></td>
<td>
<p>title for the y axis.</p>
</td></tr>
<tr><td><code id="cookDist_+3A_pos">pos</code></td>
<td>
<p>position of observations labels. Values <code>1, 2, 3, 4</code> respectively indicate below, left, above, right.</p>
</td></tr>
<tr><td><code id="cookDist_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function only works with objects given as output from <code>influenceDiag</code>, it takes Cook's distances and plot them as vertical segments.
</p>
<p>High values are associated to high influence within the model.
</p>


<h3>Value</h3>

<p>Doesn't return a value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mtcars")
mod &lt;- glm(mpg ~ cyl + hp + carb, family = Gamma, data = mtcars)
inf &lt;- influenceDiag(mod)
cookDist(inf, label.id = rownames(mtcars))

</code></pre>

<hr>
<h2 id='devAnalysis'>
Graphical analysis of Deviance
</h2><span id='topic+devAnalysis'></span>

<h3>Description</h3>

<p>A graphical tool developed by Brown (1992) to assess the contribution of one or more of the explanatory variables inside a Generalized Linear Model. This plot displays all single variable comparisons and shows how they relate to other terms that are already in the model in terms of deviance. The output plot is divided into three frames, see Details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>devAnalysis(model, cex.pl = .8, cex.vars = 1, cex.vars2 = 1, 
            layout.heights = c(1.2,0.8,4), pl.scale = 1,
            xlab, ylab, title)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="devAnalysis_+3A_model">model</code></td>
<td>
<p>a model supported by <code>glmxdiag</code>.</p>
</td></tr>
<tr><td><code id="devAnalysis_+3A_cex.pl">cex.pl</code></td>
<td>
<p>dimension of points of linear predictors.</p>
</td></tr>
<tr><td><code id="devAnalysis_+3A_cex.vars">cex.vars</code></td>
<td>
<p>dimension of variables names inside lower frame.</p>
</td></tr>
<tr><td><code id="devAnalysis_+3A_cex.vars2">cex.vars2</code></td>
<td>
<p>dimension of variables names inside medium frame.</p>
</td></tr>
<tr><td><code id="devAnalysis_+3A_layout.heights">layout.heights</code></td>
<td>
<p>a vector with three heights for the frames, from upper to lower.</p>
</td></tr>
<tr><td><code id="devAnalysis_+3A_pl.scale">pl.scale</code></td>
<td>
<p>proportion given to the sub-frame of the lower frame indicating the linear predictors.</p>
</td></tr>
<tr><td><code id="devAnalysis_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis of lower frame.</p>
</td></tr>
<tr><td><code id="devAnalysis_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis of lower frame.</p>
</td></tr>
<tr><td><code id="devAnalysis_+3A_title">title</code></td>
<td>
<p>an overall title for the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to give a clear explanation of the plot, these will be given referred to the output plot of example code.
The plot is divide into three frames: upper, medium and lower; we will start by explaining the lower one.
</p>
<p>On the y axis we have the residual deviance and each horizontal line corresponds to the (residual) deviance of a particular fitted model. 
On the right side of each horizontal line there are plus signs: based on the column they're in, they indicate if that specific variable is included in the linear predictor. For example, looking at the first horizontal line (right under the names diam, mass, dist), there are no plus signs on the adjacent columns: that is the null model.
The line under the null model has a plus sign in correspondece of dist, i.e. only variable distance is included within that model.
</p>
<p>The differences in deviance corresponding to the addition of a term to the various possible models (i.e. models not containing the term in question) are represented by vertical lines connecting the two appropriate horizontal model lines. For example the first vertical line connects the null model to the one that has just diam in the linear predictor. 
Note that this frame is divided into blocks and each one contains the differences in deviance (i.e. vertical lines) corresponding to addition of a specific variable; in this case there are three blocks for three variables.
</p>
<p>The upper frame is just a summary of the lower one; the vertical lines are the same but in a reduced scale.
The medium frame indicates the linear predictors of a model before adding the block-specific variable. For example the are no plus signs under the first vertical line; this means that it corresponds to the change in deviance when diam is added to the null model (because we are in the diam block as in the lower frame).
The second line corresponds to the difference in deviance in a model containing only mass due to adding diam, and so on.
</p>
<p>This graph is really useful to investigate the relationship between variable inside a model. In this case we may notice that adding mass is relevant when there are no variables or only dist; on the other hand its contribution is almost imperceptible when diam is already included within linear predictor. 
</p>
<p>If the description of arguments <code>layout.heights</code> and <code>pl.scale</code> is not clear, the best way to understand their role is to run the code a few times changing these parameters: this will do it.
</p>
<p>The best advice is to use this function with a maximum of 4-5 variables or else the plot will result confusing.
</p>


<h3>Value</h3>

<p>Doesn't return a value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>References</h3>

<p>Brown, D. (1992). A Graphical Analysis of Deviance. Journal of the Royal Statistical Society. Series C (Applied Statistics), 41(1), 55-62. 
</p>
<p>M. Sciandra &amp; A. Plaia (2018) A graphical model selection tool for mixed models, Communications in Statistics - Simulation and Computation, 47:9, 2624-2638
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(moons)
dist &lt;- moons$Distance
diam &lt;- moons$Diameter
mass &lt;- moons$Mass
mod &lt;- glm(moons$Moons ~ diam + mass + dist, family = poisson)
devAnalysis(mod, cex.vars = 1.3, cex.vars2 = 1.1)

</code></pre>

<hr>
<h2 id='DFbeta'>Visualize DFbetas</h2><span id='topic+DFbeta'></span>

<h3>Description</h3>

<p>Graphical visualization of DFbetas for each observation and chosen variables within input model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DFbeta(object, variables, centered = TRUE, label.id, n.label.id, 
              xlab, ylab, main, pos, pch, cex, lcol, lwd, lty, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DFbeta_+3A_object">object</code></td>
<td>
<p>object of class 'influence', see Details.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_variables">variables</code></td>
<td>
<p>a vector of characters containing names of variables; if nothing is specified, DFbetas for all variables are plotted.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_centered">centered</code></td>
<td>
<p>logical, if TRUE the plot is centered on the coefficients of the full model and each point corresponds to the coefficient if the i-th observation is excluded. if FALSE, usual DFbetas centered on zero are plotted.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_label.id">label.id</code></td>
<td>
<p>labels of observations, should be a vector with n elements.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_n.label.id">n.label.id</code></td>
<td>
<p>number of observations with highest DFbetas to label in the plot.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_xlab">xlab</code></td>
<td>
<p>title for the x axis.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_ylab">ylab</code></td>
<td>
<p>title for the y axis.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_main">main</code></td>
<td>
<p>an overall title for the plot.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_pos">pos</code></td>
<td>
<p>position of observations labels. Values <code>1, 2, 3, 4</code> respectively indicate below, left, above, right.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_pch">pch</code></td>
<td>
<p>type of points.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_cex">cex</code></td>
<td>
<p>size of points.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_lcol">lcol</code></td>
<td>
<p>color of line.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_lwd">lwd</code></td>
<td>
<p>width of line.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_lty">lty</code></td>
<td>
<p>type of line.</p>
</td></tr>
<tr><td><code id="DFbeta_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function only works with objects given as output from <code>influenceDiag</code>.
</p>
<p>DFbetas are calculated as <em>B - B(-i)</em> hence they are not standardized; if <code>centered</code> is set to TRUE then each plotted point corresponds to B(-i), otherwise to B - B(-i).
</p>


<h3>Value</h3>

<p>Doesn't return a value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("mtcars")
mod &lt;- glm(mpg ~ cyl + hp + carb, family = Gamma, data = mtcars)
inf &lt;- influenceDiag(mod)
DFbeta(inf, label.id = rownames(mtcars))
DFbeta(inf, variables = 'cyl', label.id = rownames(mtcars), pos = 2)

# to visualize all of them in a single plot
par(mfrow = c(2, 2))
DFbeta(inf, label.id = rownames(mtcars))
# press &lt;Enter&gt; four times
par(mfrow = c(1, 1))

</code></pre>

<hr>
<h2 id='diabetes'>Diabetes</h2><span id='topic+diabetes'></span>

<h3>Description</h3>

<p>This data comes from a study (Sockett et al, 1987) of the factors affecting patterns of insulin-dependent mellitus in children. The objective is to investigate the dependence of the level of serum C-peptide on the various other factors in order to understand the patterns of residual insulin secretion. The response measurement is the logarithm of C-peptide concentration (pmol/ml) at the diagnosis, and the predictor measurements age and base deficit, a measure of acidity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("diabetes")</code></pre>


<h3>Format</h3>

<p>A data frame with 43 observations on the following 3 variables.
</p>

<dl>
<dt><code>Age</code></dt><dd><p>age of the child.</p>
</dd>
<dt><code>Def</code></dt><dd><p>base deficit, a measure of acidity.</p>
</dd>
<dt><code>C_pep</code></dt><dd><p>logarithm of C-peptide concentration (pmol/ml).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Generalized Additive Models (p.304) by Hastie &amp; Tibshirani, Chapman &amp; Hall.</p>

<hr>
<h2 id='funComp'>
Compatibility of functions
</h2><span id='topic+funComp'></span>

<h3>Description</h3>

<p>Not all functions inside <code>glmxdiag</code> are available for quasi-GLM or GLM extensions . The output table helps the user orientate inside the package in order to check which function can be used according to the model under analysis. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funComp()
</code></pre>


<h3>Value</h3>

<p>Returns a dataframe. 'X' inside a cell means that the row-function can be used with the specific column-model, otherwise it cannot be used.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>Examples</h3>

<pre><code class='language-R'>funComp()
</code></pre>

<hr>
<h2 id='influenceDiag'>
Influence Diagnostic Measures
</h2><span id='topic+influenceDiag'></span>

<h3>Description</h3>

<p>Calculates or extracts some influence diagnostic measures such as DFbetas, Cook's distance and leverage. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>influenceDiag(model, approx = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="influenceDiag_+3A_model">model</code></td>
<td>
<p>a model supported by <code>glmxdiag</code>.</p>
</td></tr>
<tr><td><code id="influenceDiag_+3A_approx">approx</code></td>
<td>
<p>logical, if TRUE the function is faster but returns approximated results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Leverage is extracted from the models using <code>hatvalues</code> function of each model class.
</p>
<p>The elements for GLMs and negative binomial regression models are always approximated as they are extracted from <code>influence</code> function.
</p>
<p>The argument <code>approx</code> can be useful only with models of class <em>vglm</em> and <em>betareg</em> since <code>influence</code> method function is not defined and items are fully calculated. It estimates <em>n</em> models where observations are excluded one by one. When <code>approx = T</code> one step approximation is used; the <em>tol</em> parameter within every fitting model function is set high such that the fitting process stops at the first iteration hence results are not exact but they are supposed to be close.
</p>
<p>For betabinomial models, cook's distance is replaced with the quantity (b - b(-i)) Var(b) (b - b(-i)))/p as suggested by <em>glmtoolbox</em> package..
</p>
<p>The aim of the function is to group these diagnostic measures in one list; one should use <code>influenceDiag</code> to calculate the measures and use the output object inside functions <code>DFbeta</code>, <code>cookDist</code> and <code>leverage</code> in order to graphically visualize results.
</p>


<h3>Value</h3>

<p>Returns a list of class &quot;influence&quot; with the following elements:
</p>
<table>
<tr><td><code>DFbeta</code></td>
<td>
<p>data frame containing dfbetas for all observations and variables.</p>
</td></tr>
<tr><td><code>cookDist</code></td>
<td>
<p>a vector containing cook's distances.</p>
</td></tr>
<tr><td><code>leverage</code></td>
<td>
<p>hat values, i.e. the diagonal of the hat matrix.</p>
</td></tr>
<tr><td><code>full.beta</code></td>
<td>
<p>coefficients of the full model.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>family name</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mtcars")
mod &lt;- glm(mpg ~ cyl + hp + carb + wt, family = Gamma, data = mtcars)
inf &lt;- influenceDiag(mod)
cookDist(inf)
leverage(inf)
DFbeta(inf)
</code></pre>

<hr>
<h2 id='leverage'>
Visualize Leverages
</h2><span id='topic+leverage'></span>

<h3>Description</h3>

<p>Graphical visualization of leverages for each observation within input model. Corresponds to the main diagonal of the hat matrix, i.e <em>H[i,i]</em>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leverage(object, label.id, n.label.id, xlab, ylab, pos,
         hline, lcol, lwd, lty, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leverage_+3A_object">object</code></td>
<td>
<p>object of class 'influence', see Details.</p>
</td></tr>
<tr><td><code id="leverage_+3A_label.id">label.id</code></td>
<td>
<p>labels of observations, should be a vector with n elements.</p>
</td></tr>
<tr><td><code id="leverage_+3A_n.label.id">n.label.id</code></td>
<td>
<p>number of observations with highest leverage to label in the plot.</p>
</td></tr>
<tr><td><code id="leverage_+3A_xlab">xlab</code></td>
<td>
<p>title for the x axis.</p>
</td></tr>
<tr><td><code id="leverage_+3A_ylab">ylab</code></td>
<td>
<p>title for the y axis.</p>
</td></tr>
<tr><td><code id="leverage_+3A_pos">pos</code></td>
<td>
<p>position of observations labels. Values <code>1, 2, 3, 4</code> respectively indicate below, left, above, right.</p>
</td></tr>
<tr><td><code id="leverage_+3A_hline">hline</code></td>
<td>
<p>numeric, where to position the horizontal line; useful to individuate points that exceed a specific treshold. Defaults to 2*p/n.</p>
</td></tr>
<tr><td><code id="leverage_+3A_lcol">lcol</code></td>
<td>
<p>color of line.</p>
</td></tr>
<tr><td><code id="leverage_+3A_lwd">lwd</code></td>
<td>
<p>width of line.</p>
</td></tr>
<tr><td><code id="leverage_+3A_lty">lty</code></td>
<td>
<p>type of line.</p>
</td></tr>
<tr><td><code id="leverage_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function only works with objects given as output from <code>influenceDiag</code>.
</p>
<p>A rule of thumbs says that an observations has high leverage if H[i,i] &gt; 2*p/n where p is the number of coefficients and n the sample size. 
</p>


<h3>Value</h3>

<p>Doesn't return a value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mtcars")
mod &lt;- glm(mpg ~ cyl + hp + carb, family = Gamma, data = mtcars)
inf &lt;- influenceDiag(mod)
leverage(inf, label.id = rownames(mtcars))
</code></pre>

<hr>
<h2 id='linkLin'>Checking linearity of link function</h2><span id='topic+linkLin'></span>

<h3>Description</h3>

<p>According to Lovison (2014), if the link function is correctly specified then there is a linear relationship between the working response variable <em>z</em> and the linear predictor <em>eta</em>. This plot suggests if the link function is appropriate.</p>


<h3>Usage</h3>

<pre><code class='language-R'>linkLin(model, smooth = TRUE, xlab, ylab, main, pch, lcol, lwd, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linkLin_+3A_model">model</code></td>
<td>
<p>a model supported by <code>glmxdiag</code>.</p>
</td></tr>
<tr><td><code id="linkLin_+3A_smooth">smooth</code></td>
<td>
<p>logical, whether to plot a smoothing spline.</p>
</td></tr>
<tr><td><code id="linkLin_+3A_xlab">xlab</code></td>
<td>
<p>title for the x axis.</p>
</td></tr>
<tr><td><code id="linkLin_+3A_ylab">ylab</code></td>
<td>
<p>title for the y axis.</p>
</td></tr>
<tr><td><code id="linkLin_+3A_main">main</code></td>
<td>
<p>an overall title for the plot.</p>
</td></tr>
<tr><td><code id="linkLin_+3A_pch">pch</code></td>
<td>
<p>type of points.</p>
</td></tr>
<tr><td><code id="linkLin_+3A_lcol">lcol</code></td>
<td>
<p>color of the smoothing line.</p>
</td></tr>
<tr><td><code id="linkLin_+3A_lwd">lwd</code></td>
<td>
<p>size of the smoothing line.</p>
</td></tr>
<tr><td><code id="linkLin_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The assumption behind the output plot is that the model is correctly specified. In the y-axis there is the working response variable while on the x-axis there is the linear predictor: the more their relationship is linear the more appropriate the link function should be. 
</p>


<h3>Value</h3>

<p>Doesn't return a value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Simulate the data


set.seed(5)
n.obs &lt;- 100
x &lt;- rnorm(n.obs)
shape &lt;- 25
mu &lt;- exp(1 + .5* x)
y &lt;- rgamma(n.obs, rate = shape / mu, shape = shape)

true.mod &lt;- glm(y ~ x, family = Gamma(link = 'log'))
wrong1 &lt;- glm(y ~ x, family = Gamma(link = 'inverse'))
wrong2 &lt;- glm(y ~ x, family = Gamma(link = 'identity'))

par(mfrow = c(2, 2))
linkLin(true.mod)
linkLin(wrong1)
linkLin(wrong2)
par(mfrow = c(1, 1))

</code></pre>

<hr>
<h2 id='moons'>Moons of the 13 planets of the Solar System</h2><span id='topic+moons'></span>

<h3>Description</h3>

<p>This dataset contains informations about dimensions, number of moons and distance from the Sun of the eight planets and the five dwarf planets of the Solar System. The objective is to find a proper relationship between the number of moons and other variables. 
All variables are normalized in respect to the Earth, so that it has always value 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("moons")</code></pre>


<h3>Format</h3>

<p>A data frame with 13 observations on the following 5 variables.
</p>

<dl>
<dt><code>Name</code></dt><dd><p>name of the planet.</p>
</dd>
<dt><code>Distance</code></dt><dd><p>distance from the sun.</p>
</dd>
<dt><code>Diameter</code></dt><dd><p>diameter of the planet.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>mass of the planet.</p>
</dd>
<dt><code>Moons</code></dt><dd><p>number of moons.</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://en.wikipedia.org/wiki/Planet
</p>

<hr>
<h2 id='Qresiduals'>Graphical normality testing for quantile residuals</h2><span id='topic+Qresiduals'></span>

<h3>Description</h3>

<p>Derives quantile residuals of the input model and creates two plots: the first compares density of a standard normal distribution to the residuals' empirical density while the other one is a <em>QQplot</em>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qresiduals(model, plot.it = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qresiduals_+3A_model">model</code></td>
<td>
<p>a model supported by <code>glmxdiag</code>.</p>
</td></tr>
<tr><td><code id="Qresiduals_+3A_plot.it">plot.it</code></td>
<td>
<p>logical, whether to plot the results or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Quantile residuals are defined on a continuous cumulative distribution function; for binomial, beta-binomial, poisson and negative binomial regression models the <em>Randomized quantile residuals</em> are used.
</p>
<p>Residuals have an important role inside the global diagnostic of a regression model. Any departure from the standard normal distribution can be considered as a warning that one or more aspects of the model are misspecified. Quantile residuals are particullary useful with models that do not have a continuous response variable, such as a binomial or poisson models; see examples.
</p>


<h3>Value</h3>

<p>Called for side effects but invisibly returns the calculated quantile residuals.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>References</h3>

<p>Peter K. Dunn and Gordon K. Smyth (1996). Randomized Quantile Residuals. Journal of Computational and Graphical Statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate the data

set.seed(10)
n &lt;- 100
x1 &lt;- rt(n, df = 4)
x2 &lt;- rnorm(n, sd = 2)
b &lt;- c(1, .5, .5)
eta &lt;- b[1] + b[2] * x1 + b[3] * x2
prob &lt;- exp(eta)/(1 + exp(eta))
y &lt;- rbinom(n, size = 1, prob = prob)

# The model is correctly specified
mod &lt;- glm(y ~ x1 + x2, family = binomial)

res.p &lt;- residuals(mod, type = 'pearson')
res.d &lt;- residuals(mod, type = 'deviance')
qres &lt;- Qresiduals(mod, plot.it = FALSE)

shapiro.test(res.p) # not normal
shapiro.test(res.d) # not normal
shapiro.test(qres) # normal

y.hat &lt;- fitted(mod)

plot(y.hat, res.p) # uninformative 
plot(y.hat, res.d) # uninformative 
plot(y.hat, qres)

Qresiduals(mod)

</code></pre>

<hr>
<h2 id='stopping'>Stopping</h2><span id='topic+stopping'></span>

<h3>Description</h3>

<p>This data set concerns the stopping distances for cars travelling at different speeds. There are replicate values for some speeds. The objective is to find a model for these data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("stopping")</code></pre>


<h3>Format</h3>

<p>A data frame with 63 observations on the following 2 variables.
</p>

<dl>
<dt><code>Speed</code></dt><dd><p>travelling speed (miles per hour).</p>
</dd>
<dt><code>Distance</code></dt><dd><p>stopping distance (feet).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Snee, R.D. (1986) An alternative approach to fitting models when re-expression of the
response is useful. <em>Journal of Quality Technology</em>, 18,211-225.
</p>
<p>A Handbook of Small Data Sets (p.354) by Hand, Daly, McConway, Lunn, Ostrowski. Chapman &amp; Hall.
</p>

<hr>
<h2 id='varCheck'>Checking adequacy of variance function</h2><span id='topic+varCheck'></span>

<h3>Description</h3>

<p>According to GLM theory, the true variance function can be estimated as (y-mu)^2/phi. Comparing this quantity with the variance function assumed by the model suggests if the chosen one is appropriate. If the model is correct, points should be arranged near the bisector; otherwise this plot suggests the direction of the error made by chosing the variance function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>varCheck(model, xlab, ylab, pch, col, lcol, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varCheck_+3A_model">model</code></td>
<td>
<p>a model supported by <code>glmxdiag</code>.</p>
</td></tr>
<tr><td><code id="varCheck_+3A_xlab">xlab</code></td>
<td>
<p>title for the x axis.</p>
</td></tr>
<tr><td><code id="varCheck_+3A_ylab">ylab</code></td>
<td>
<p>title for the y axis.</p>
</td></tr>
<tr><td><code id="varCheck_+3A_pch">pch</code></td>
<td>
<p>type of points.</p>
</td></tr>
<tr><td><code id="varCheck_+3A_col">col</code></td>
<td>
<p>color of the points.</p>
</td></tr>
<tr><td><code id="varCheck_+3A_lcol">lcol</code></td>
<td>
<p>color of the bisector.</p>
</td></tr>
<tr><td><code id="varCheck_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Doesn't return a value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(stopping, package = 'glmxdiag')
mod &lt;- glm(Distance ~ Speed, family = Gamma(link = 'sqrt'), data = stopping)
varCheck(mod)


</code></pre>

<hr>
<h2 id='variableOut'>Excluding a variable from the model</h2><span id='topic+variableOut'></span>

<h3>Description</h3>

<p>Graphically compares models in terms of Information Criterion, each one corresponds to a model where a specific variable is deleted from the linear predictor. </p>


<h3>Usage</h3>

<pre><code class='language-R'>variableOut(model, k = 2, update.it = FALSE, xlab, ylab, pch, 
                   col, lty, ylim, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variableOut_+3A_model">model</code></td>
<td>
<p>a model supported by <code>glmxdiag</code>.</p>
</td></tr>
<tr><td><code id="variableOut_+3A_k">k</code></td>
<td>
<p>numeric, the penalty per parameter to be used; the default <code>k = 2</code> is the classical AIC.</p>
</td></tr>
<tr><td><code id="variableOut_+3A_update.it">update.it</code></td>
<td>
<p>logical; if TRUE, model without the variable corresponding to the lowest score is returned.</p>
</td></tr>
<tr><td><code id="variableOut_+3A_xlab">xlab</code></td>
<td>
<p>title for the x axis.</p>
</td></tr>
<tr><td><code id="variableOut_+3A_ylab">ylab</code></td>
<td>
<p>title for the y axis, by default is 'AIC'; should be changed if a different k is chosen.</p>
</td></tr>
<tr><td><code id="variableOut_+3A_pch">pch</code></td>
<td>
<p>type of points.</p>
</td></tr>
<tr><td><code id="variableOut_+3A_col">col</code></td>
<td>
<p>color of points and segments.</p>
</td></tr>
<tr><td><code id="variableOut_+3A_lty">lty</code></td>
<td>
<p>type of horizontal line.</p>
</td></tr>
<tr><td><code id="variableOut_+3A_ylim">ylim</code></td>
<td>
<p>y limits of the plot.</p>
</td></tr>
<tr><td><code id="variableOut_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>plot.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each plotted point corresponds to the score of the model where the variable indicated on x axis is excluded.
A dashed line is drawn in correspondence of the full model score.
</p>
<p>Points and segments corresponding to variables whose deletion lead to a increment of the scored are black, those who lead to a decrement are red.
</p>
<p>The output plot can be seen as a graphic version of the first step of <code>stepAIC</code> function inside <code>MASS</code> package.
</p>
<p>Theory about Information Criterion suggests that if the minimum score doesn't belong to the full model, then the linear predictor may not be appropriate.
</p>


<h3>Value</h3>

<p>Called for side effects, but if <code>update.it</code> is set to TRUE returns a model without the variable corresponding to the lowest score.
</p>


<h3>Author(s)</h3>

<p>Giuseppe Reale
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("moons")
model &lt;- glm(Moons ~ Diameter * Mass + Distance, family = poisson, data = moons)
variableOut(model)

n &lt;- nobs(model)
new.model &lt;- variableOut(model, k = log(n), ylab = 'BIC', update.it = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
