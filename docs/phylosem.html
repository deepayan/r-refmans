<!DOCTYPE html><html lang="en"><head><title>Help for package phylosem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phylosem}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as_fitted_DAG'><p>Convert phylosem to phylopath output</p></a></li>
<li><a href='#as_phylo4d'><p>Convert phylosem to phylo4d</p></a></li>
<li><a href='#as_sem'><p>Convert phylosem to sem output</p></a></li>
<li><a href='#average'><p>Choose model</p></a></li>
<li><a href='#average.compare_phylosem'><p>Choose model</p></a></li>
<li><a href='#best'><p>Extract best fitted model</p></a></li>
<li><a href='#best.compare_phylosem'><p>Extract best fitted model</p></a></li>
<li><a href='#choice'><p>Choose model</p></a></li>
<li><a href='#choice.compare_phylosem'><p>Choose model</p></a></li>
<li><a href='#coef.phylosem'><p>Extract path coefficients</p></a></li>
<li><a href='#compare_phylosem'><p>Compare phylogenetic structural equation models</p></a></li>
<li><a href='#list_parameters'><p>List fixed and random effects</p></a></li>
<li><a href='#Mlifehist_ver1_0'><p>Fisheries natural mortality example</p></a></li>
<li><a href='#parse_path'><p>Parse path</p></a></li>
<li><a href='#phylosem'><p>Fit phylogenetic structural equation model</p></a></li>
<li><a href='#phylosem_control'><p>Detailed control for phylosem structure</p></a></li>
<li><a href='#print.phylosem'><p>Print parameter estimates and standard errors.</p></a></li>
<li><a href='#summary.phylosem'><p>summarize phylosem</p></a></li>
<li><a href='#vcov.phylosem'><p>Extract Variance-Covariance Matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Phylogenetic Structural Equation Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-02</td>
</tr>
<tr>
<td>Imports:</td>
<td>sem, ape, phylobase, phylopath, methods</td>
</tr>
<tr>
<td>Depends:</td>
<td>TMB, R (&ge; 4.0.0),</td>
</tr>
<tr>
<td>Suggests:</td>
<td>semPlot, TreeTools, Rphylopars, phylolm, fishtree, phyr,
knitr, rmarkdown, ggplot2, testthat, phylosignal, adephylo</td>
</tr>
<tr>
<td>Enhances:</td>
<td>phytools, DiagrammeR</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppEigen, TMB</td>
</tr>
<tr>
<td>Description:</td>
<td>Applies phylogenetic comparative methods (PCM) and phylogenetic trait imputation using 
    structural equation models (SEM), extending methods from Thorson et al. (2023) &lt;<a href="https://doi.org/10.1111%2F2041-210X.14076">doi:10.1111/2041-210X.14076</a>&gt;.  
    This implementation includes a minimal set of features, to 
    allow users to easily read all of the documentation and source code.  PCM using SEM 
    includes phylogenetic linear models and structural equation models as nested submodels, 
    but also allows imputation of missing values.  Features and comparison with other packages
    are described in Thorson and van der Bijl (2023) &lt;<a href="https://doi.org/10.1111%2Fjeb.14234">doi:10.1111/jeb.14234</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://james-thorson-noaa.github.io/phylosem/">https://james-thorson-noaa.github.io/phylosem/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/James-Thorson-NOAA/phylosem/issues">https://github.com/James-Thorson-NOAA/phylosem/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-02 20:47:55 UTC; James.Thorson</td>
</tr>
<tr>
<td>Author:</td>
<td>James Thorson <a href="https://orcid.org/0000-0001-7415-1010"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Wouter van der Bijl
    <a href="https://orcid.org/0000-0002-7366-1868"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James Thorson &lt;James.Thorson@noaa.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-02 21:15:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='as_fitted_DAG'>Convert phylosem to phylopath output</h2><span id='topic+as_fitted_DAG'></span>

<h3>Description</h3>

<p>Convert output from package phylosem to phylopath
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_fitted_DAG(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_fitted_DAG_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+phylosem">phylosem</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Convert output to format supplied by <code><a href="phylopath.html#topic+est_DAG">est_DAG</a></code>
</p>

<hr>
<h2 id='as_phylo4d'>Convert phylosem to phylo4d</h2><span id='topic+as_phylo4d'></span>

<h3>Description</h3>

<p>Convert output from package phylosem to phylo4d object from package phylobase
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_phylo4d(object, what = c("Estimate", "Std. Error"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_phylo4d_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+phylosem">phylosem</a></code></p>
</td></tr>
<tr><td><code id="as_phylo4d_+3A_what">what</code></td>
<td>
<p>Select what to convert (Estimate / Std. Error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This package is intended to for use in using plots assocaited with package sem,
e.g., using package plotSEM <code>semPlot::semPlotModel</code>
</p>


<h3>Value</h3>

<p>phylosem output to converted format supplied by <code><a href="phylobase.html#topic+phylo4d">phylo4d</a></code>
</p>

<hr>
<h2 id='as_sem'>Convert phylosem to sem output</h2><span id='topic+as_sem'></span>

<h3>Description</h3>

<p>Convert output from package phylosem to output from package sem
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_sem(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_sem_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+phylosem">phylosem</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output converted to format supplied by <code><a href="sem.html#topic+sem">sem</a></code>
</p>

<hr>
<h2 id='average'>Choose model</h2><span id='topic+average'></span>

<h3>Description</h3>

<p>Choose model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>average(x, cut_off, avg_method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="average_+3A_x">x</code></td>
<td>
<p>output from <code>compare_phylosem</code></p>
</td></tr>
<tr><td><code id="average_+3A_cut_off">cut_off</code></td>
<td>
<p>threshold where any model with delta-AIC greater than this value is excluded from average</p>
</td></tr>
<tr><td><code id="average_+3A_avg_method">avg_method</code></td>
<td>
<p>see <code><a href="phylopath.html#topic+average_DAGs">average_DAGs</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an AIC-weighted average of fitted models from <code><a href="#topic+compare_phylosem">compare_phylosem</a></code> after conversion to format from [phylopath::est_DAG]
</p>

<hr>
<h2 id='average.compare_phylosem'>Choose model</h2><span id='topic+average.compare_phylosem'></span>

<h3>Description</h3>

<p>Choose model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'compare_phylosem'
average(x, cut_off = 2, avg_method = "conditional")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="average.compare_phylosem_+3A_x">x</code></td>
<td>
<p>output from <code>compare_phylosem</code></p>
</td></tr>
<tr><td><code id="average.compare_phylosem_+3A_cut_off">cut_off</code></td>
<td>
<p>threshold where any model with delta-AIC greater than this value is excluded from average</p>
</td></tr>
<tr><td><code id="average.compare_phylosem_+3A_avg_method">avg_method</code></td>
<td>
<p>see <code><a href="phylopath.html#topic+average_DAGs">average_DAGs</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an AIC-weighted average of fitted models from <code><a href="#topic+compare_phylosem">compare_phylosem</a></code> after conversion to format from <code><a href="phylopath.html#topic+est_DAG">est_DAG</a></code>
</p>

<hr>
<h2 id='best'>Extract best fitted model</h2><span id='topic+best'></span>

<h3>Description</h3>

<p>Extract best fitted model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>best(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="best_+3A_x">x</code></td>
<td>
<p>output from <code><a href="#topic+compare_phylosem">compare_phylosem</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns best model from those fitted using <code><a href="#topic+compare_phylosem">compare_phylosem</a></code>
</p>

<hr>
<h2 id='best.compare_phylosem'>Extract best fitted model</h2><span id='topic+best.compare_phylosem'></span>

<h3>Description</h3>

<p>Extract best fitted model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'compare_phylosem'
best(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="best.compare_phylosem_+3A_x">x</code></td>
<td>
<p>output from <code>compare_phylosem</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns best model from those fitted using <code><a href="#topic+compare_phylosem">compare_phylosem</a></code>
</p>

<hr>
<h2 id='choice'>Choose model</h2><span id='topic+choice'></span>

<h3>Description</h3>

<p>Choose model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choice(x, choice)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="choice_+3A_x">x</code></td>
<td>
<p>output from <code>compare_phylosem</code></p>
</td></tr>
<tr><td><code id="choice_+3A_choice">choice</code></td>
<td>
<p>Integer indicating model to extract</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns chosen model from those fitted using <code><a href="#topic+compare_phylosem">compare_phylosem</a></code>
</p>

<hr>
<h2 id='choice.compare_phylosem'>Choose model</h2><span id='topic+choice.compare_phylosem'></span>

<h3>Description</h3>

<p>Choose model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'compare_phylosem'
choice(x, choice)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="choice.compare_phylosem_+3A_x">x</code></td>
<td>
<p>output from <code>compare_phylosem</code></p>
</td></tr>
<tr><td><code id="choice.compare_phylosem_+3A_choice">choice</code></td>
<td>
<p>Integer indicating model to extract</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns chosen model from those fitted using <code><a href="#topic+compare_phylosem">compare_phylosem</a></code>
</p>

<hr>
<h2 id='coef.phylosem'>Extract path coefficients</h2><span id='topic+coef.phylosem'></span>

<h3>Description</h3>

<p>Extract path coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylosem'
coef(object, standardized = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.phylosem_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+phylosem">phylosem</a></code></p>
</td></tr>
<tr><td><code id="coef.phylosem_+3A_standardized">standardized</code></td>
<td>
<p>Whether to standardize regression coefficients</p>
</td></tr>
<tr><td><code id="coef.phylosem_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data-frame listing all path coefficients, their parameter index and estimated values
</p>

<hr>
<h2 id='compare_phylosem'>Compare phylogenetic structural equation models</h2><span id='topic+compare_phylosem'></span>

<h3>Description</h3>

<p>Fits several phylogenetic structural equation model for further comparison
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_phylosem(
  sem_set,
  tree,
  data,
  family = rep("fixed", ncol(data)),
  covs,
  estimate_ou = FALSE,
  estimate_lambda = FALSE,
  estimate_kappa = FALSE,
  control = phylosem_control(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_phylosem_+3A_sem_set">sem_set</code></td>
<td>
<p>A named list of structural equation model specifications,
where each element will be passed as argument <code>sem</code> to
<code><a href="#topic+phylosem">phylosem</a></code></p>
</td></tr>
<tr><td><code id="compare_phylosem_+3A_tree">tree</code></td>
<td>
<p>phylogenetic structure, using class <code><a href="ape.html#topic+as.phylo">as.phylo</a></code></p>
</td></tr>
<tr><td><code id="compare_phylosem_+3A_data">data</code></td>
<td>
<p>data-frame providing variables being modeled.  Missing values are inputted
as NA.  If an SEM includes a latent variable (i.e., variable with no available measurements)
then it still must be inputted as a column of <code>data</code> with entirely NA values.</p>
</td></tr>
<tr><td><code id="compare_phylosem_+3A_family">family</code></td>
<td>
<p>Character-vector listing the distribution used for each column of <code>data</code>, where
each element must be <code>fixed</code>, <code>normal</code>, <code>binomial</code>, or <code>poisson</code>.
<code>family="fixed"</code> is default behavior and assumes that a given variable is measured exactly.
Other options correspond to different specifications of measurement error.</p>
</td></tr>
<tr><td><code id="compare_phylosem_+3A_covs">covs</code></td>
<td>
<p>optional: a character vector of one or more elements, with each element
giving a string of variable names, separated by commas. Variances and covariances
among all variables in each such string are added to the model. For confirmatory
factor analysis models specified via <code>cfa</code>, <code>covs</code> defaults to all of
the factors in the model, thus specifying all variances and covariances among these factors.
<em>Warning</em>: <code>covs="x1, x2"</code> and <code>covs=c("x1", "x2")</code> are <em>not</em>
equivalent: <code>covs="x1, x2"</code> specifies the variance of <code>x1</code>, the variance
of <code>x2</code>, <em>and</em> their covariance, while <code>covs=c("x1", "x2")</code> specifies
the variance of <code>x1</code> and the variance of <code>x2</code> <em>but not</em> their covariance.</p>
</td></tr>
<tr><td><code id="compare_phylosem_+3A_estimate_ou">estimate_ou</code></td>
<td>
<p>Boolean indicating whether to estimate an autoregressive (Ornstein-Uhlenbeck)
process using additional parameter <code>lnalpha</code>,
corresponding to the <code>model="OUrandomRoot"</code> parameterization from <span class="pkg">phylolm</span>
as listed in <a href="https://doi.org/10.1093/sysbio/syu005">doi:10.1093/sysbio/syu005</a></p>
</td></tr>
<tr><td><code id="compare_phylosem_+3A_estimate_lambda">estimate_lambda</code></td>
<td>
<p>Boolean indicating whether to estimate additional branch lengths for
phylogenetic tips (a.k.a. the Pagel-lambda term) using additional parameter <code>logitlambda</code></p>
</td></tr>
<tr><td><code id="compare_phylosem_+3A_estimate_kappa">estimate_kappa</code></td>
<td>
<p>Boolean indicating whether to estimate a nonlinear scaling of branch
lengths (a.k.a. the Pagel-kappa term) using additional parameter <code>lnkappa</code></p>
</td></tr>
<tr><td><code id="compare_phylosem_+3A_control">control</code></td>
<td>
<p>Output from <code><a href="#topic+phylosem_control">phylosem_control</a></code>, used to define user
settings, and see documentation for that function for details.</p>
</td></tr>
<tr><td><code id="compare_phylosem_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+phylosem">phylosem</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object (list) of class 'compare_phylosem', containing a list of
output from <code><a href="#topic+phylosem">phylosem</a></code>
</p>

<hr>
<h2 id='list_parameters'>List fixed and random effects</h2><span id='topic+list_parameters'></span>

<h3>Description</h3>

<p><code>list_parameters</code> lists all fixed and random effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_parameters(Obj, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list_parameters_+3A_obj">Obj</code></td>
<td>
<p>Compiled TMB object</p>
</td></tr>
<tr><td><code id="list_parameters_+3A_verbose">verbose</code></td>
<td>
<p>Boolean, whether to print messages to terminal</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Tagged-list of fixed and random effects, returned invisibly and printed to screen
</p>

<hr>
<h2 id='Mlifehist_ver1_0'>Fisheries natural mortality example</h2><span id='topic+Mlifehist_ver1_0'></span>

<h3>Description</h3>

<p>Data used to demonstrate phylogenetic comparative methods for fisheries science. 
Specifically a copy of the Then et al. database <a href="https://doi.org/10.1093/icesjms/fsu136">doi:10.1093/icesjms/fsu136</a> 
using file &quot;Mlifehist_ver1.0.csv&quot; accessed from 
<a href="https://www.vims.edu/research/departments/fisheries/programs/mort_db/">https://www.vims.edu/research/departments/fisheries/programs/mort_db/</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Mlifehist_ver1_0)
</code></pre>

<hr>
<h2 id='parse_path'>Parse path</h2><span id='topic+parse_path'></span>

<h3>Description</h3>

<p><code>parse_path</code> is copied from <code>sem::parse.path</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_path(path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parse_path_+3A_path">path</code></td>
<td>
<p>text to parse</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Copied with permission from John Fox under licence GPL (&gt;= 2)
</p>


<h3>Value</h3>

<p>Tagged-list defining variables and direction for a specified path coefficient
</p>

<hr>
<h2 id='phylosem'>Fit phylogenetic structural equation model</h2><span id='topic+phylosem'></span>

<h3>Description</h3>

<p>Fits a phylogenetic structural equation model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylosem(
  sem,
  tree,
  data,
  family = rep("fixed", ncol(data)),
  covs = colnames(data),
  estimate_ou = FALSE,
  estimate_lambda = FALSE,
  estimate_kappa = FALSE,
  data_labels = rownames(data),
  tmb_inputs = NULL,
  control = phylosem_control()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phylosem_+3A_sem">sem</code></td>
<td>
<p>structural equation model structure, passed to either <code><a href="sem.html#topic+specifyModel">specifyModel</a></code>
or <code><a href="sem.html#topic+specifyEquations">specifyEquations</a></code> and then parsed to control
the set of path coefficients and variance-covariance parameters</p>
</td></tr>
<tr><td><code id="phylosem_+3A_tree">tree</code></td>
<td>
<p>phylogenetic structure, using class <code><a href="ape.html#topic+as.phylo">as.phylo</a></code></p>
</td></tr>
<tr><td><code id="phylosem_+3A_data">data</code></td>
<td>
<p>data-frame providing variables being modeled.  Missing values are inputted
as NA.  If an SEM includes a latent variable (i.e., variable with no available measurements)
then it still must be inputted as a column of <code>data</code> with entirely NA values.</p>
</td></tr>
<tr><td><code id="phylosem_+3A_family">family</code></td>
<td>
<p>Character-vector listing the distribution used for each column of <code>data</code>, where
each element must be <code>fixed</code>, <code>normal</code>, <code>binomial</code>, or <code>poisson</code>.
<code>family="fixed"</code> is default behavior and assumes that a given variable is measured exactly.
Other options correspond to different specifications of measurement error.</p>
</td></tr>
<tr><td><code id="phylosem_+3A_covs">covs</code></td>
<td>
<p>optional: a character vector of one or more elements, with each element
giving a string of variable names, separated by commas. Variances and covariances
among all variables in each such string are added to the model. For confirmatory
factor analysis models specified via <code>cfa</code>, <code>covs</code> defaults to all of
the factors in the model, thus specifying all variances and covariances among these factors.
<em>Warning</em>: <code>covs="x1, x2"</code> and <code>covs=c("x1", "x2")</code> are <em>not</em>
equivalent: <code>covs="x1, x2"</code> specifies the variance of <code>x1</code>, the variance
of <code>x2</code>, <em>and</em> their covariance, while <code>covs=c("x1", "x2")</code> specifies
the variance of <code>x1</code> and the variance of <code>x2</code> <em>but not</em> their covariance.</p>
</td></tr>
<tr><td><code id="phylosem_+3A_estimate_ou">estimate_ou</code></td>
<td>
<p>Boolean indicating whether to estimate an autoregressive (Ornstein-Uhlenbeck)
process using additional parameter <code>lnalpha</code>,
corresponding to the <code>model="OUrandomRoot"</code> parameterization from <span class="pkg">phylolm</span>
as listed in <a href="https://doi.org/10.1093/sysbio/syu005">doi:10.1093/sysbio/syu005</a></p>
</td></tr>
<tr><td><code id="phylosem_+3A_estimate_lambda">estimate_lambda</code></td>
<td>
<p>Boolean indicating whether to estimate additional branch lengths for
phylogenetic tips (a.k.a. the Pagel-lambda term) using additional parameter <code>logitlambda</code></p>
</td></tr>
<tr><td><code id="phylosem_+3A_estimate_kappa">estimate_kappa</code></td>
<td>
<p>Boolean indicating whether to estimate a nonlinear scaling of branch
lengths (a.k.a. the Pagel-kappa term) using additional parameter <code>lnkappa</code></p>
</td></tr>
<tr><td><code id="phylosem_+3A_data_labels">data_labels</code></td>
<td>
<p>For each row of <code>data</code>, listing the corresponding name from
<code>tree$tip.label</code>.  Default pulls <code>data_labels</code> from <code>rownames(data)</code></p>
</td></tr>
<tr><td><code id="phylosem_+3A_tmb_inputs">tmb_inputs</code></td>
<td>
<p>optional tagged list that overrides the default constructor
for TMB inputs (use at your own risk)</p>
</td></tr>
<tr><td><code id="phylosem_+3A_control">control</code></td>
<td>
<p>Output from <code><a href="#topic+phylosem_control">phylosem_control</a></code>, used to define user
settings, and see documentation for that function for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that parameters <code>logitlambda</code>, <code>lnkappa</code>, and <code>lnalpha</code> if estimated are each estimated as having a single value
that applies to all modeled variables.
This differs from default behavior in <span class="pkg">phylolm</span>, where these parameters only apply to the &quot;response&quot; and not &quot;predictor&quot; variables.
This also differs from default behavior in <span class="pkg">phylopath</span>, where a different value is estimated
in each call to <span class="pkg">phylolm</span> during the d-separation estimate of path coefficients. However, it is
consistent with default behavior in <span class="pkg">Rphylopars</span>, and estimates should be comparable in that case.
These additional parameters are estimated with unbounded support, which differs somewhat from default
bounded estimates in <span class="pkg">phylolm</span>, although parameters should match if overriding <span class="pkg">phylolm</span> defaults
to use unbounded support.  Finally, <code>phylosem</code> allows these three parameters to be estimated in any
combination, which is expanded functionality relative to the single-option functionality in <span class="pkg">phylolm</span>.
</p>
<p>Also note that <span class="pkg">phylopath</span> by default uses standardized coefficients.  To achieve matching parameter estimates between
<span class="pkg">phylosem</span> and <span class="pkg">phylopath</span>, standardize each variable to have a standard deviation of 1.0 prior to fitting with <span class="pkg">phylosem</span>.
</p>


<h3>Value</h3>

<p>An object (list) of class 'phylosem'. Elements include:
</p>

<dl>
<dt>data</dt><dd><p>Copy of argument <code>data</code></p>
</dd>
<dt>SEM_model</dt><dd><p>SEM model parsed from <code>sem</code> using <code><a href="sem.html#topic+specifyModel">specifyModel</a></code> or <code><a href="sem.html#topic+specifyEquations">specifyEquations</a></code></p>
</dd>
<dt>obj</dt><dd><p>TMB object from <code><a href="TMB.html#topic+MakeADFun">MakeADFun</a></code></p>
</dd>
<dt>tree</dt><dd><p>Copy of argument <code>tree</code></p>
</dd>
<dt>tmb_inputs</dt><dd><p>The list of inputs passed to <code><a href="TMB.html#topic+MakeADFun">MakeADFun</a></code></p>
</dd>
<dt>opt</dt><dd><p>The output from <code><a href="stats.html#topic+nlminb">nlminb</a></code></p>
</dd>
<dt>sdrep</dt><dd><p>The output from <code><a href="TMB.html#topic+sdreport">sdreport</a></code></p>
</dd>
<dt>report</dt><dd><p>The output from <code>obj$report()</code></p>
</dd>
<dt>parhat</dt><dd><p>The output from <code>obj$env$parList()</code> containing maximum likelihood estimates and empirical Bayes predictions</p>
</dd>
</dl>



<h3>References</h3>

<p>**Introducing the package, its features, and comparison with other software
(to cite when using phylosem):**
</p>
<p>Thorson, J. T., &amp; van der Bijl, W. (In press). phylosem: A fast and simple
R package for phylogenetic inference and trait imputation using phylogenetic
structural equation models. Journal of Evolutionary Biology.
<a href="https://doi.org/10.1111/jeb.14234">doi:10.1111/jeb.14234</a>
</p>
<p>*Statistical methods for phylogenetic structural equation models*
</p>
<p>Thorson, J. T., Maureaud, A. A., Frelat, R., Merigot, B., Bigman, J. S., Friedman,
S. T., Palomares, M. L. D., Pinsky, M. L., Price, S. A., &amp; Wainwright, P. (2023).
Identifying direct and indirect associations among traits by merging phylogenetic
comparative methods and structural equation models. Methods in Ecology and Evolution,
14(5), 1259-1275. <a href="https://doi.org/10.1111/2041-210X.14076">doi:10.1111/2041-210X.14076</a>
</p>
<p>*Earlier development of computational methods, originally used for phlogenetic factor analysis:*
</p>
<p>Thorson, J. T. (2020). Predicting recruitment density dependence and intrinsic growth rate for all fishes
worldwide using a data-integrated life-history model. Fish and Fisheries, 21(2),
237-251. <a href="https://doi.org/10.1111/faf.12427">doi:10.1111/faf.12427</a>
</p>
<p>Thorson, J. T., Munch, S. B., Cope, J. M., &amp; Gao, J. (2017). Predicting life
history parameters for all fishes worldwide. Ecological Applications, 27(8),
2262-2276. <a href="https://doi.org/10.1002/eap.1606">doi:10.1002/eap.1606</a>
</p>
<p>*Earlier development of phylogenetic path analysis:*
</p>
<p>van der Bijl, W. (2018). phylopath: Easy phylogenetic path analysis in
R. PeerJ, 6, e4718. <a href="https://doi.org/10.7717/peerj.4718">doi:10.7717/peerj.4718</a>
</p>
<p>von Hardenberg, A., &amp; Gonzalez-Voyer, A. (2013). Disentangling
evolutionary cause-effect relationships with phylogenetic confirmatory
path analysis. Evolution; International Journal of Organic Evolution,
67(2), 378-387. <a href="https://doi.org/10.1111/j.1558-5646.2012.01790.x">doi:10.1111/j.1558-5646.2012.01790.x</a>
</p>
<p>*Interface involving SEM 'arrow notation' is repurposed from:*
</p>
<p>Fox, J., Nie, Z., &amp; Byrnes, J. (2020). Sem: Structural equation models.
R package version 3.1-11. <a href="https://CRAN.R-project.org/package=sem">https://CRAN.R-project.org/package=sem</a>
</p>
<p>*Coercing output to phylo4d depends upon:*
</p>
<p>Bolker, B., Butler, M., Cowan, P., de Vienne, D., Eddelbuettel, D., Holder, M.,
Jombart, T., Kembel, S., Michonneau, F., &amp; Orme, B. (2015). phylobase:
Base package for phylogenetic structures and comparative data. R Package Version 0.8.0.
<a href="https://CRAN.R-project.org/package=phylobase">https://CRAN.R-project.org/package=phylobase</a>
</p>
<p>*Laplace approximation for parameter estimation depends upon:*
</p>
<p>Kristensen, K., Nielsen, A., Berg, C. W., Skaug, H., &amp; Bell, B. M. (2016).
TMB: Automatic differentiation and Laplace approximation. Journal of Statistical Software,
70(5), 1-21. <a href="https://doi.org/10.18637/jss.v070.i05">doi:10.18637/jss.v070.i05</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load data set
data(rhino, rhino_tree, package="phylopath")

# Run phylosem
model = "
  DD -&gt; RS, p1
  BM -&gt; LS, p2
  BM -&gt; NL, p3
  NL -&gt; DD, p4
"
psem = phylosem( sem = model,
          data = rhino[,c("BM","NL","DD","RS","LS")],
          tree = rhino_tree )

# Convert and plot using phylopath
library(phylopath)
my_fitted_DAG = as_fitted_DAG(psem)
coef_plot( my_fitted_DAG )
plot( my_fitted_DAG )

# Convert to phylo4d to extract estimated traits and Standard errors
# for all ancestors and tips in the tree.
# In this rhino example, note that species are labeled s1-s100
# and ancestral nodes are not named.
(traits_est = as_phylo4d(psem))
(traits_SE = as_phylo4d(psem, what="Std. Error"))

# Convert to sem and plot
library(sem)
my_sem = as_sem(psem)
pathDiagram( model = my_sem,
                  style = "traditional",
                  edge.labels = "values" )
effects( my_sem )

# Plot using semPlot
if( require(semPlot) ){
  myplot = semPlotModel( my_sem )
  semPaths( my_sem,
                   nodeLabels = myplot@Vars$name )
}

</code></pre>

<hr>
<h2 id='phylosem_control'>Detailed control for phylosem structure</h2><span id='topic+phylosem_control'></span>

<h3>Description</h3>

<p>Define a list of control parameters.  Note that
the format of this input is likely to change more rapidly than that of
<code><a href="#topic+phylosem">phylosem</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylosem_control(
  nlminb_loops = 1,
  newton_loops = 1,
  trace = 0,
  eval.max = 1000,
  iter.max = 1000,
  getsd = TRUE,
  quiet = FALSE,
  run_model = TRUE,
  getJointPrecision = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phylosem_control_+3A_nlminb_loops">nlminb_loops</code></td>
<td>
<p>Integer number of times to call <code><a href="stats.html#topic+nlminb">nlminb</a></code>.</p>
</td></tr>
<tr><td><code id="phylosem_control_+3A_newton_loops">newton_loops</code></td>
<td>
<p>Integer number of Newton steps to do after running
<code><a href="stats.html#topic+nlminb">nlminb</a></code>.</p>
</td></tr>
<tr><td><code id="phylosem_control_+3A_trace">trace</code></td>
<td>
<p>Parameter values are printed every 'trace' iteration
for the outer optimizer. Passed to
'control' in <code><a href="stats.html#topic+nlminb">nlminb</a></code>.</p>
</td></tr>
<tr><td><code id="phylosem_control_+3A_eval.max">eval.max</code></td>
<td>
<p>Maximum number of evaluations of the objective function
allowed. Passed to 'control' in <code><a href="stats.html#topic+nlminb">nlminb</a></code>.</p>
</td></tr>
<tr><td><code id="phylosem_control_+3A_iter.max">iter.max</code></td>
<td>
<p>Maximum number of iterations allowed. Passed to 'control' in
<code><a href="stats.html#topic+nlminb">nlminb</a></code>.</p>
</td></tr>
<tr><td><code id="phylosem_control_+3A_getsd">getsd</code></td>
<td>
<p>Boolean indicating whether to call <code><a href="TMB.html#topic+sdreport">sdreport</a></code></p>
</td></tr>
<tr><td><code id="phylosem_control_+3A_quiet">quiet</code></td>
<td>
<p>Boolean indicating whether to run model printing messages to terminal or not;</p>
</td></tr>
<tr><td><code id="phylosem_control_+3A_run_model">run_model</code></td>
<td>
<p>Boolean indicating whether to estimate parameters (the default), or
instead to return the model inputs and compiled TMB object without running;</p>
</td></tr>
<tr><td><code id="phylosem_control_+3A_getjointprecision">getJointPrecision</code></td>
<td>
<p>whether to get the joint precision matrix.  Passed
to <code><a href="TMB.html#topic+sdreport">sdreport</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 object of class &quot;phylosem_control&quot; that specifies detailed model settings,
allowing user specification while also specifying default values
</p>

<hr>
<h2 id='print.phylosem'>Print parameter estimates and standard errors.</h2><span id='topic+print.phylosem'></span>

<h3>Description</h3>

<p>Print parameter estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylosem'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.phylosem_+3A_x">x</code></td>
<td>
<p>Output from <code><a href="#topic+phylosem">phylosem</a></code></p>
</td></tr>
<tr><td><code id="print.phylosem_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>prints (and invisibly returns) output from <code><a href="stats.html#topic+nlminb">nlminb</a></code>
</p>

<hr>
<h2 id='summary.phylosem'>summarize phylosem</h2><span id='topic+summary.phylosem'></span>

<h3>Description</h3>

<p>Summarize phylosem output from phylosem, including calculating intercepts at the tree root
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylosem'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.phylosem_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+phylosem">phylosem</a></code></p>
</td></tr>
<tr><td><code id="summary.phylosem_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data-frame containing all estimated intercepts, path coefficients, and variance-covariance parameters
as well as their standard errors
</p>

<hr>
<h2 id='vcov.phylosem'>Extract Variance-Covariance Matrix</h2><span id='topic+vcov.phylosem'></span>

<h3>Description</h3>

<p>extract the covariance of fixed effects, or both fixed and random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylosem'
vcov(object, which = c("fixed", "random", "both"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.phylosem_+3A_object">object</code></td>
<td>
<p>output from <code>phylosem</code></p>
</td></tr>
<tr><td><code id="vcov.phylosem_+3A_which">which</code></td>
<td>
<p>whether to extract the covariance among fixed effects, random effects, or both</p>
</td></tr>
<tr><td><code id="vcov.phylosem_+3A_...">...</code></td>
<td>
<p>ignored, for method compatibility</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
