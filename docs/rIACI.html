<!DOCTYPE html><html lang="en"><head><title>Help for package rIACI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rIACI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calculate_quantiles'><p>Calculate Temperature Quantiles</p></a></li>
<li><a href='#calculate_standardized'><p>Calculate Standardized Indices</p></a></li>
<li><a href='#calculate_wind_quantiles'><p>Calculate Wind Quantiles</p></a></li>
<li><a href='#cdd'><p>Calculate Consecutive Dry Days (CDD)</p></a></li>
<li><a href='#cdd_std'><p>Calculate Standardized CDD Index</p></a></li>
<li><a href='#check_basic_argument_validity'><p>Check Validity of Basic Arguments</p></a></li>
<li><a href='#climate_input'><p>Climate Input Function</p></a></li>
<li><a href='#create_date_sequence'><p>Create Date Sequence</p></a></li>
<li><a href='#csv_to_netcdf'><p>CSV to NetCDF Function</p></a></li>
<li><a href='#download_data'><p>Download ERA5-Land Data</p></a></li>
<li><a href='#export_data_to_csv'><p>Export Data to CSV Function</p></a></li>
<li><a href='#fill_data_series'><p>Fill Data Series</p></a></li>
<li><a href='#generate_na_masks'><p>Generate NA Masks</p></a></li>
<li><a href='#get_series_lengths'><p>Get Series Lengths</p></a></li>
<li><a href='#get.series.lengths.at.ends'><p>Get Series Lengths at Ends</p></a></li>
<li><a href='#iaci_output'><p>Calculate Integrated Iberian Actuarial Climate Index (IACI)</p></a></li>
<li><a href='#monthly_to_seasonal'><p>Convert Monthly Data to Seasonal Data</p></a></li>
<li><a href='#nday_consec_prec_max'><p>Maximum Precipitation Over Consecutive Days</p></a></li>
<li><a href='#output_all'><p>Output IACI of all grids</p></a></li>
<li><a href='#percent_days_op_threshold'><p>Percent of Days Above or Below Threshold</p></a></li>
<li><a href='#process_data'><p>Process Data Function</p></a></li>
<li><a href='#running_mean'><p>Running Mean</p></a></li>
<li><a href='#rx5day'><p>Calculate Rx5day Index</p></a></li>
<li><a href='#rx5day_std'><p>Calculate Standardized Rx5day Index</p></a></li>
<li><a href='#sea_input'><p>Sea Level Input Function</p></a></li>
<li><a href='#sea_std'><p>Calculate Standardized Sea Level Index</p></a></li>
<li><a href='#spell_length_max'><p>Maximum Length of Consecutive Dry Days</p></a></li>
<li><a href='#t10p'><p>Calculate T10p Index</p></a></li>
<li><a href='#t10p_std'><p>Calculate Standardized T10p Index</p></a></li>
<li><a href='#t90p'><p>Calculate T90p Index</p></a></li>
<li><a href='#t90p_std'><p>Calculate Standardized T90p Index</p></a></li>
<li><a href='#tapply.fast'><p>Fast tapply Function</p></a></li>
<li><a href='#tn10p'><p>Calculate TN10p Index</p></a></li>
<li><a href='#tn90p'><p>Calculate TN90p Index</p></a></li>
<li><a href='#tx10p'><p>Calculate TX10p Index</p></a></li>
<li><a href='#tx90p'><p>Calculate TX90p Index</p></a></li>
<li><a href='#w90p'><p>Calculate W90p Index</p></a></li>
<li><a href='#w90p_std'><p>Calculate Standardized W90p Index</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Iberian Actuarial Climate Index Calculations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates the Iberian Actuarial Climate Index and its components—including temperature, precipitation, wind power, and sea level data—to support climate change analysis and risk assessment. See "Zhou et al." (2023) &lt;<a href="https://doi.org/10.26360%2F2023_3">doi:10.26360/2023_3</a>&gt; for further details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.5), dplyr, tidyr, lubridate, magrittr,
reticulate, ecmwfr, readr, stats, utils</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>roxygen2, devtools, knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-17 14:53:24 UTC; nnnn</td>
</tr>
<tr>
<td>Author:</td>
<td>Nan Zhou <a href="https://orcid.org/0009-0002-5166-6753"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nan Zhou &lt;zhounan@ucm.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-17 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calculate_quantiles'>Calculate Temperature Quantiles</h2><span id='topic+calculate_quantiles'></span>

<h3>Description</h3>

<p>Computes temperature quantiles based on data within a specified base range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_quantiles(
  data_series,
  date_sequence,
  base.range,
  n,
  temp.qtiles,
  min.base.data.fraction.present
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_quantiles_+3A_data_series">data_series</code></td>
<td>
<p>Numeric vector. Data series aligned with date sequence.</p>
</td></tr>
<tr><td><code id="calculate_quantiles_+3A_date_sequence">date_sequence</code></td>
<td>
<p>Date vector. Complete date sequence.</p>
</td></tr>
<tr><td><code id="calculate_quantiles_+3A_base.range">base.range</code></td>
<td>
<p>Numeric vector. Base range years.</p>
</td></tr>
<tr><td><code id="calculate_quantiles_+3A_n">n</code></td>
<td>
<p>Integer. Window size for running averages.</p>
</td></tr>
<tr><td><code id="calculate_quantiles_+3A_temp.qtiles">temp.qtiles</code></td>
<td>
<p>Numeric vector. Quantiles to calculate.</p>
</td></tr>
<tr><td><code id="calculate_quantiles_+3A_min.base.data.fraction.present">min.base.data.fraction.present</code></td>
<td>
<p>Numeric. Minimum fraction of data required in base range.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame. Calculated quantiles.
</p>

<hr>
<h2 id='calculate_standardized'>Calculate Standardized Indices</h2><span id='topic+calculate_standardized'></span>

<h3>Description</h3>

<p>Helper function to calculate standardized indices based on a reference period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_standardized(df, freq, base_range)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_standardized_+3A_df">df</code></td>
<td>
<p>Data frame. Input data with Date and Value columns.</p>
</td></tr>
<tr><td><code id="calculate_standardized_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;seasonal&quot;.</p>
</td></tr>
<tr><td><code id="calculate_standardized_+3A_base_range">base_range</code></td>
<td>
<p>Numeric vector. Base range years.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with standardized values.
</p>

<hr>
<h2 id='calculate_wind_quantiles'>Calculate Wind Quantiles</h2><span id='topic+calculate_wind_quantiles'></span>

<h3>Description</h3>

<p>Computes the 90th percentile of wind speed for index calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_wind_quantiles(
  wind_data_series,
  date_sequence,
  base_range,
  wind_qtile = 0.9
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_wind_quantiles_+3A_wind_data_series">wind_data_series</code></td>
<td>
<p>Numeric vector. Wind data series aligned with date sequence.</p>
</td></tr>
<tr><td><code id="calculate_wind_quantiles_+3A_date_sequence">date_sequence</code></td>
<td>
<p>Date vector. Complete date sequence.</p>
</td></tr>
<tr><td><code id="calculate_wind_quantiles_+3A_base_range">base_range</code></td>
<td>
<p>Numeric vector. Base range years.</p>
</td></tr>
<tr><td><code id="calculate_wind_quantiles_+3A_wind_qtile">wind_qtile</code></td>
<td>
<p>Numeric. Wind quantile to calculate (default is 0.90).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame. Calculated wind thresholds.
</p>

<hr>
<h2 id='cdd'>Calculate Consecutive Dry Days (CDD)</h2><span id='topic+cdd'></span>

<h3>Description</h3>

<p>Calculates the maximum length of consecutive dry days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdd(ci, spells_can_span_years = TRUE, monthly = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cdd_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object created by <code><a href="#topic+climate_input">climate_input</a></code>.</p>
</td></tr>
<tr><td><code id="cdd_+3A_spells_can_span_years">spells_can_span_years</code></td>
<td>
<p>Logical. Whether spells can span across years (default is TRUE).</p>
</td></tr>
<tr><td><code id="cdd_+3A_monthly">monthly</code></td>
<td>
<p>Logical. Whether to interpolate annual data to monthly data (default is TRUE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and calculated CDD values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate annual CDD index
cdd_values &lt;- cdd(ci, monthly = FALSE)

</code></pre>

<hr>
<h2 id='cdd_std'>Calculate Standardized CDD Index</h2><span id='topic+cdd_std'></span>

<h3>Description</h3>

<p>Calculates the standardized consecutive dry days index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdd_std(ci, freq = c("monthly", "seasonal"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cdd_std_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object.</p>
</td></tr>
<tr><td><code id="cdd_std_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;seasonal&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and standardized CDD values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate standardized CDD index on a monthly basis
cdd_std_values &lt;- cdd_std(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='check_basic_argument_validity'>Check Validity of Basic Arguments</h2><span id='topic+check_basic_argument_validity'></span>

<h3>Description</h3>

<p>Validates the input parameters to ensure they are valid and consistent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_basic_argument_validity(tmax, tmin, prec, wind, dates, base.range, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_basic_argument_validity_+3A_tmax">tmax</code></td>
<td>
<p>Numeric vector. Maximum temperature data.</p>
</td></tr>
<tr><td><code id="check_basic_argument_validity_+3A_tmin">tmin</code></td>
<td>
<p>Numeric vector. Minimum temperature data.</p>
</td></tr>
<tr><td><code id="check_basic_argument_validity_+3A_prec">prec</code></td>
<td>
<p>Numeric vector. Precipitation data.</p>
</td></tr>
<tr><td><code id="check_basic_argument_validity_+3A_wind">wind</code></td>
<td>
<p>Numeric vector. Wind data.</p>
</td></tr>
<tr><td><code id="check_basic_argument_validity_+3A_dates">dates</code></td>
<td>
<p>Date vector. Dates corresponding to the data.</p>
</td></tr>
<tr><td><code id="check_basic_argument_validity_+3A_base.range">base.range</code></td>
<td>
<p>Numeric vector of length 2. The base range years.</p>
</td></tr>
<tr><td><code id="check_basic_argument_validity_+3A_n">n</code></td>
<td>
<p>Numeric. A parameter used in calculations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Stops execution if validation fails.
</p>

<hr>
<h2 id='climate_input'>Climate Input Function</h2><span id='topic+climate_input'></span>

<h3>Description</h3>

<p>Processes climate data and calculates necessary statistics for climate index calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climate_input(
  tmax = NULL,
  tmin = NULL,
  prec = NULL,
  wind = NULL,
  dates = NULL,
  base.range = c(1961, 1990),
  n = 5,
  quantiles = NULL,
  temp.qtiles = c(0.1, 0.9),
  wind.qtile = 0.9,
  max.missing.days = c(annual = 15, monthly = 3),
  min.base.data.fraction.present = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="climate_input_+3A_tmax">tmax</code></td>
<td>
<p>Numeric vector. Maximum temperature data.</p>
</td></tr>
<tr><td><code id="climate_input_+3A_tmin">tmin</code></td>
<td>
<p>Numeric vector. Minimum temperature data.</p>
</td></tr>
<tr><td><code id="climate_input_+3A_prec">prec</code></td>
<td>
<p>Numeric vector. Precipitation data.</p>
</td></tr>
<tr><td><code id="climate_input_+3A_wind">wind</code></td>
<td>
<p>Numeric vector. Wind speed data.</p>
</td></tr>
<tr><td><code id="climate_input_+3A_dates">dates</code></td>
<td>
<p>Date vector. Dates corresponding to the data.</p>
</td></tr>
<tr><td><code id="climate_input_+3A_base.range">base.range</code></td>
<td>
<p>Numeric vector of length 2. Base range years for calculations (default is c(1961, 1990)).</p>
</td></tr>
<tr><td><code id="climate_input_+3A_n">n</code></td>
<td>
<p>Integer. Window size for running averages (default is 5).</p>
</td></tr>
<tr><td><code id="climate_input_+3A_quantiles">quantiles</code></td>
<td>
<p>List. Pre-calculated quantiles (optional).</p>
</td></tr>
<tr><td><code id="climate_input_+3A_temp.qtiles">temp.qtiles</code></td>
<td>
<p>Numeric vector. Temperature quantiles to calculate (default is c(0.10, 0.90)).</p>
</td></tr>
<tr><td><code id="climate_input_+3A_wind.qtile">wind.qtile</code></td>
<td>
<p>Numeric. Wind quantile to calculate (default is 0.90).</p>
</td></tr>
<tr><td><code id="climate_input_+3A_max.missing.days">max.missing.days</code></td>
<td>
<p>Named numeric vector. Maximum allowed missing days for annual and monthly data (default is c(annual = 15, monthly = 3)).</p>
</td></tr>
<tr><td><code id="climate_input_+3A_min.base.data.fraction.present">min.base.data.fraction.present</code></td>
<td>
<p>Numeric. Minimum fraction of data required in base range (default is 0.1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing processed data and related information for climate index calculations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)

# 4. Examine the structure of ci
str(ci)

</code></pre>

<hr>
<h2 id='create_date_sequence'>Create Date Sequence</h2><span id='topic+create_date_sequence'></span>

<h3>Description</h3>

<p>Generates a complete sequence of dates from the earliest to the latest date provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_date_sequence(dates)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_date_sequence_+3A_dates">dates</code></td>
<td>
<p>Date vector. Original dates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Date vector. A complete sequence of dates.
</p>

<hr>
<h2 id='csv_to_netcdf'>CSV to NetCDF Function</h2><span id='topic+csv_to_netcdf'></span>

<h3>Description</h3>

<p>Merges CSV files in a specified directory into a single NetCDF file, completing the grid by filling missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>csv_to_netcdf(csv_dir, output_file, freq)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="csv_to_netcdf_+3A_csv_dir">csv_dir</code></td>
<td>
<p>Character. Directory containing CSV files, each file representing a single latitude-longitude point.
The filename format should be 'lat_lon.csv'.</p>
</td></tr>
<tr><td><code id="csv_to_netcdf_+3A_output_file">output_file</code></td>
<td>
<p>Character. Path to the output NetCDF file.</p>
</td></tr>
<tr><td><code id="csv_to_netcdf_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of the data, either ''monthly'&lsquo; or '&rsquo;seasonal''.
- ''monthly'&lsquo; data uses date format '&rsquo;YYYY-MM''.
- ''seasonal'&lsquo; data uses date format like '&rsquo;YYYY-SSS'&lsquo; (e.g., '&rsquo;1961-DJF'').</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. The NetCDF file is saved to the specified location.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example usage of csv_to_netcdf
csv_directory &lt;- "/path/to/csv_files"
output_netcdf_file &lt;- "/path/to/output_file.nc"
csv_to_netcdf(csv_dir = csv_directory, output_file = output_netcdf_file, freq = "monthly")

## End(Not run)
</code></pre>

<hr>
<h2 id='download_data'>Download ERA5-Land Data</h2><span id='topic+download_data'></span>

<h3>Description</h3>

<p>Downloads ERA5-Land data from the ECMWF Climate Data Store for the specified time range and variables.
Implements a retry mechanism to handle transient errors during data download.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_data(
  start_year,
  end_year,
  start_month = 1,
  end_month = 12,
  variables = c("10m_u_component_of_wind", "10m_v_component_of_wind", "2m_temperature",
    "total_precipitation"),
  dataset = "reanalysis-era5-land",
  area = c(-90, -180, 90, 180),
  output_dir = "cds_data",
  user_id,
  user_key,
  max_retries = 3,
  retry_delay = 5,
  timeout = 7200
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_data_+3A_start_year">start_year</code></td>
<td>
<p>Integer. The starting year for data download.</p>
</td></tr>
<tr><td><code id="download_data_+3A_end_year">end_year</code></td>
<td>
<p>Integer. The ending year for data download.</p>
</td></tr>
<tr><td><code id="download_data_+3A_start_month">start_month</code></td>
<td>
<p>Integer. The starting month (default is 1).</p>
</td></tr>
<tr><td><code id="download_data_+3A_end_month">end_month</code></td>
<td>
<p>Integer. The ending month (default is 12).</p>
</td></tr>
<tr><td><code id="download_data_+3A_variables">variables</code></td>
<td>
<p>Character vector. Variables to download.
Default includes common variables: <code>c("10m_u_component_of_wind", "10m_v_component_of_wind",
"2m_temperature", "total_precipitation")</code>.</p>
</td></tr>
<tr><td><code id="download_data_+3A_dataset">dataset</code></td>
<td>
<p>Character. Dataset short name (default is &quot;reanalysis-era5-land&quot;).</p>
</td></tr>
<tr><td><code id="download_data_+3A_area">area</code></td>
<td>
<p>Numeric vector. Geographical area specified as <code>c(North, West, South, East)</code>.</p>
</td></tr>
<tr><td><code id="download_data_+3A_output_dir">output_dir</code></td>
<td>
<p>Character. Directory to save the downloaded data (default is &quot;cds_data&quot;).</p>
</td></tr>
<tr><td><code id="download_data_+3A_user_id">user_id</code></td>
<td>
<p>Character. Your ECMWF user ID.</p>
</td></tr>
<tr><td><code id="download_data_+3A_user_key">user_key</code></td>
<td>
<p>Character. Your ECMWF API key.</p>
</td></tr>
<tr><td><code id="download_data_+3A_max_retries">max_retries</code></td>
<td>
<p>Integer. Maximum number of retry attempts in case of download failure (default is 3).</p>
</td></tr>
<tr><td><code id="download_data_+3A_retry_delay">retry_delay</code></td>
<td>
<p>Numeric. Delay between retry attempts in seconds (default is 5).</p>
</td></tr>
<tr><td><code id="download_data_+3A_timeout">timeout</code></td>
<td>
<p>Numeric. Timeout duration for each request in seconds (default is 7200, i.e., 2 hours).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Data is downloaded to the specified output directory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Set your ECMWF user ID and key
user_id &lt;- "your_user_id"
user_key &lt;- "your_api_key"

# Define the geographical area (North, West, South, East)
area &lt;- c(90, -180, -90, 180) # Global

# Download data for 2020
download_data(
  start_year = 2020,
  end_year = 2020,
  variables = c("2m_temperature", "total_precipitation"),
  area = area,
  user_id = user_id,
  user_key = user_key
)

## End(Not run)
</code></pre>

<hr>
<h2 id='export_data_to_csv'>Export Data to CSV Function</h2><span id='topic+export_data_to_csv'></span>

<h3>Description</h3>

<p>Exports data from a NetCDF file to CSV files, one for each latitude and longitude point, including only points where data is present.
This function utilizes a Python script to perform the data processing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_data_to_csv(nc_file, output_dir)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="export_data_to_csv_+3A_nc_file">nc_file</code></td>
<td>
<p>Character. Path to the NetCDF file.</p>
</td></tr>
<tr><td><code id="export_data_to_csv_+3A_output_dir">output_dir</code></td>
<td>
<p>Character. Output directory where CSV files will be saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calls a Python script using the 'reticulate' package to process the NetCDF file.
The Python script 'data_processing.py' should be located in the 'python' directory of the 'rIACI' package.
Only grid points with available data are exported to CSV files.
Each CSV file corresponds to a specific latitude and longitude point.
</p>


<h3>Value</h3>

<p>None. CSV files are saved to the specified output directory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example usage of export_data_to_csv
netcdf_file &lt;- "/path/to/processed_data.nc"
csv_output_directory &lt;- "/path/to/csv_output"
export_data_to_csv(nc_file = netcdf_file, output_dir = csv_output_directory)

## End(Not run)
</code></pre>

<hr>
<h2 id='fill_data_series'>Fill Data Series</h2><span id='topic+fill_data_series'></span>

<h3>Description</h3>

<p>Aligns the input data with the complete date sequence, filling missing dates with NA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_data_series(data, dates, date_sequence)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_data_series_+3A_data">data</code></td>
<td>
<p>Numeric vector. Original data series.</p>
</td></tr>
<tr><td><code id="fill_data_series_+3A_dates">dates</code></td>
<td>
<p>Date vector. Dates corresponding to the data.</p>
</td></tr>
<tr><td><code id="fill_data_series_+3A_date_sequence">date_sequence</code></td>
<td>
<p>Date vector. Complete date sequence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector. Data series aligned with the date sequence.
</p>

<hr>
<h2 id='generate_na_masks'>Generate NA Masks</h2><span id='topic+generate_na_masks'></span>

<h3>Description</h3>

<p>Creates masks for annual and monthly data based on maximum allowed missing days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_na_masks(data_series_list, date_sequence, max.missing.days)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_na_masks_+3A_data_series_list">data_series_list</code></td>
<td>
<p>List. List of data series.</p>
</td></tr>
<tr><td><code id="generate_na_masks_+3A_date_sequence">date_sequence</code></td>
<td>
<p>Date vector. Complete date sequence.</p>
</td></tr>
<tr><td><code id="generate_na_masks_+3A_max.missing.days">max.missing.days</code></td>
<td>
<p>Named numeric vector. Maximum allowed missing days.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List. NA masks for annual and monthly data.
</p>

<hr>
<h2 id='get_series_lengths'>Get Series Lengths</h2><span id='topic+get_series_lengths'></span>

<h3>Description</h3>

<p>Calculates the lengths of consecutive TRUE values in a logical vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_series_lengths(bools)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_series_lengths_+3A_bools">bools</code></td>
<td>
<p>Logical vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector. Lengths of consecutive TRUE runs.
</p>

<hr>
<h2 id='get.series.lengths.at.ends'>Get Series Lengths at Ends</h2><span id='topic+get.series.lengths.at.ends'></span>

<h3>Description</h3>

<p>Calculates the lengths of runs at the ends of a logical vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.series.lengths.at.ends(x, na.value = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.series.lengths.at.ends_+3A_x">x</code></td>
<td>
<p>Logical vector.</p>
</td></tr>
<tr><td><code id="get.series.lengths.at.ends_+3A_na.value">na.value</code></td>
<td>
<p>Logical. Value to assign to NA elements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector. Lengths of runs at the ends.
</p>

<hr>
<h2 id='iaci_output'>Calculate Integrated Iberian Actuarial Climate Index (IACI)</h2><span id='topic+iaci_output'></span>

<h3>Description</h3>

<p>Integrates various standardized indices to compute the IACI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iaci_output(ci, si, freq = c("monthly", "seasonal"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iaci_output_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object.</p>
</td></tr>
<tr><td><code id="iaci_output_+3A_si">si</code></td>
<td>
<p>Data frame. Sea level input data.</p>
</td></tr>
<tr><td><code id="iaci_output_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;seasonal&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and IACI values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a climate_input object
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# 2. Create a sea level data frame with sea_input()
monthly_seq &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-01"),
  by   = "month"
)
sea_dates &lt;- format(monthly_seq, "%Y-%m")
n &lt;- length(sea_dates)
linear_trend &lt;- seq(0, 10, length.out = n)
random_noise &lt;- rnorm(n, mean = 0, sd = 0.3)
sea_values   &lt;- 10 + linear_trend + random_noise  # starts ~10, ends ~20
si &lt;- sea_input(Date = sea_dates, Value = sea_values)
# Then:
# 3. Calculate the IACI with monthly frequency
result &lt;- iaci_output(ci, si, freq = "monthly")

</code></pre>

<hr>
<h2 id='monthly_to_seasonal'>Convert Monthly Data to Seasonal Data</h2><span id='topic+monthly_to_seasonal'></span>

<h3>Description</h3>

<p>Aggregates monthly data into seasonal averages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monthly_to_seasonal(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monthly_to_seasonal_+3A_data">data</code></td>
<td>
<p>Data frame. Monthly data with Date and Value columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with seasonal data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Assuming you have monthly data in a data frame 'monthly_data'
# with columns 'Date' (in 'YYYY-MM' format) and 'Value'
seasonal_data &lt;- monthly_to_seasonal(monthly_data)

## End(Not run)
</code></pre>

<hr>
<h2 id='nday_consec_prec_max'>Maximum Precipitation Over Consecutive Days</h2><span id='topic+nday_consec_prec_max'></span>

<h3>Description</h3>

<p>Calculates maximum precipitation over consecutive n days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nday_consec_prec_max(
  daily_prec,
  date_factor,
  ndays,
  center_mean_on_last_day = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nday_consec_prec_max_+3A_daily_prec">daily_prec</code></td>
<td>
<p>Numeric vector. Daily precipitation data.</p>
</td></tr>
<tr><td><code id="nday_consec_prec_max_+3A_date_factor">date_factor</code></td>
<td>
<p>Factor. Date grouping factor.</p>
</td></tr>
<tr><td><code id="nday_consec_prec_max_+3A_ndays">ndays</code></td>
<td>
<p>Integer. Number of consecutive days.</p>
</td></tr>
<tr><td><code id="nday_consec_prec_max_+3A_center_mean_on_last_day">center_mean_on_last_day</code></td>
<td>
<p>Logical. Whether to center the mean on the last day.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector. Maximum precipitation amounts.
</p>

<hr>
<h2 id='output_all'>Output IACI of all grids</h2><span id='topic+output_all'></span>

<h3>Description</h3>

<p>Processes all CSV files in the input directory and outputs the results to the output directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>output_all(
  si,
  input_dir,
  output_dir,
  freq = c("monthly", "seasonal"),
  base.range = c(1961, 1990),
  time.span = c(1961, 2022)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="output_all_+3A_si">si</code></td>
<td>
<p>Data frame. Sea level input data.</p>
</td></tr>
<tr><td><code id="output_all_+3A_input_dir">input_dir</code></td>
<td>
<p>Character. Directory containing input CSV files.</p>
</td></tr>
<tr><td><code id="output_all_+3A_output_dir">output_dir</code></td>
<td>
<p>Character. Directory to save output files.</p>
</td></tr>
<tr><td><code id="output_all_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;seasonal&quot;.</p>
</td></tr>
<tr><td><code id="output_all_+3A_base.range">base.range</code></td>
<td>
<p>Numeric vector. Base range years (default is c(1961, 1990)).</p>
</td></tr>
<tr><td><code id="output_all_+3A_time.span">time.span</code></td>
<td>
<p>Numeric vector. Time span for output data (default is c(1961, 2022)).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Results are saved to the output directory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Assume we have sea level data 'si' and input/output directories
input_dir &lt;- "path/to/input/csv/files"
output_dir &lt;- "path/to/save/output/files"
# Run the output_all function with monthly frequency
output_all(si, input_dir, output_dir, freq = "monthly")

## End(Not run)
</code></pre>

<hr>
<h2 id='percent_days_op_threshold'>Percent of Days Above or Below Threshold</h2><span id='topic+percent_days_op_threshold'></span>

<h3>Description</h3>

<p>Calculates the percentage of days exceeding or below a threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>percent_days_op_threshold(
  temp,
  dates,
  month_day,
  date_factor,
  quantiles_df,
  qtile,
  op = "&lt;",
  max_missing_days
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="percent_days_op_threshold_+3A_temp">temp</code></td>
<td>
<p>Numeric vector. Temperature data.</p>
</td></tr>
<tr><td><code id="percent_days_op_threshold_+3A_dates">dates</code></td>
<td>
<p>Date vector. Dates corresponding to the data.</p>
</td></tr>
<tr><td><code id="percent_days_op_threshold_+3A_month_day">month_day</code></td>
<td>
<p>Character vector. Month-day strings.</p>
</td></tr>
<tr><td><code id="percent_days_op_threshold_+3A_date_factor">date_factor</code></td>
<td>
<p>Factor. Date grouping factor (e.g., monthly or annual).</p>
</td></tr>
<tr><td><code id="percent_days_op_threshold_+3A_quantiles_df">quantiles_df</code></td>
<td>
<p>Data frame. Quantiles data.</p>
</td></tr>
<tr><td><code id="percent_days_op_threshold_+3A_qtile">qtile</code></td>
<td>
<p>Numeric. Quantile to use.</p>
</td></tr>
<tr><td><code id="percent_days_op_threshold_+3A_op">op</code></td>
<td>
<p>Character. Comparison operator, e.g., '&lt;' or '&gt;'.</p>
</td></tr>
<tr><td><code id="percent_days_op_threshold_+3A_max_missing_days">max_missing_days</code></td>
<td>
<p>Named numeric vector. Maximum allowed missing days.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector or data frame with calculated percentages.
</p>

<hr>
<h2 id='process_data'>Process Data Function</h2><span id='topic+process_data'></span>

<h3>Description</h3>

<p>Processes NetCDF files in the input directory and saves merged and processed data to the output directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_data(input_dir, output_dir, save_merged = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_data_+3A_input_dir">input_dir</code></td>
<td>
<p>Character. Directory containing input NetCDF files.</p>
</td></tr>
<tr><td><code id="process_data_+3A_output_dir">output_dir</code></td>
<td>
<p>Character. Directory to save output files.</p>
</td></tr>
<tr><td><code id="process_data_+3A_save_merged">save_merged</code></td>
<td>
<p>Logical. If TRUE, saves the merged NetCDF file. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Outputs are saved to the specified directory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example usage of process_data
input_directory &lt;- "/path/to/input/netcdf_files"
output_directory &lt;- "/path/to/output"
process_data(input_dir = input_directory, output_dir = output_directory, save_merged = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='running_mean'>Running Mean</h2><span id='topic+running_mean'></span>

<h3>Description</h3>

<p>Calculates the running mean of a vector over a specified window size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>running_mean(vec, bin)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="running_mean_+3A_vec">vec</code></td>
<td>
<p>Numeric vector. Input data.</p>
</td></tr>
<tr><td><code id="running_mean_+3A_bin">bin</code></td>
<td>
<p>Integer. Window size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector. Running mean values.
</p>

<hr>
<h2 id='rx5day'>Calculate Rx5day Index</h2><span id='topic+rx5day'></span>

<h3>Description</h3>

<p>Calculates the maximum consecutive 5-day precipitation amount.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rx5day(ci, freq = c("monthly", "annual"), center_mean_on_last_day = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rx5day_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object created by <code><a href="#topic+climate_input">climate_input</a></code>.</p>
</td></tr>
<tr><td><code id="rx5day_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;annual&quot;.</p>
</td></tr>
<tr><td><code id="rx5day_+3A_center_mean_on_last_day">center_mean_on_last_day</code></td>
<td>
<p>Logical. Whether to center the mean on the last day (default is FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and calculated Rx5day values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate monthly Rx5day index
rx5day_values &lt;- rx5day(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='rx5day_std'>Calculate Standardized Rx5day Index</h2><span id='topic+rx5day_std'></span>

<h3>Description</h3>

<p>Calculates the standardized Rx5day index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rx5day_std(ci, freq = c("monthly", "seasonal"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rx5day_std_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object.</p>
</td></tr>
<tr><td><code id="rx5day_std_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;seasonal&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and standardized Rx5day values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate standardized Rx5day index on a monthly basis
rx5day_std_values &lt;- rx5day_std(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='sea_input'>Sea Level Input Function</h2><span id='topic+sea_input'></span>

<h3>Description</h3>

<p>Creates a data frame for sea level data input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sea_input(Date = NULL, Value = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sea_input_+3A_date">Date</code></td>
<td>
<p>Character vector. Dates in &quot;YYYY-MM&quot; format.</p>
</td></tr>
<tr><td><code id="sea_input_+3A_value">Value</code></td>
<td>
<p>Numeric vector. Sea level values (default is NA).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with Date and Value columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Create a monthly sequence from 1960-01 through 2020-12
monthly_seq &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-01"),
  by   = "month"
)

# Convert to "YYYY-MM" format, which sea_input() expects
sea_dates &lt;- format(monthly_seq, "%Y-%m")

# 2. Generate random data with an upward linear trend plus some noise
n &lt;- length(sea_dates)
linear_trend &lt;- seq(0, 10, length.out = n)
random_noise &lt;- rnorm(n, mean = 0, sd = 0.3)
sea_values   &lt;- 10 + linear_trend + random_noise  # starts ~10, ends ~20

# 3. Create a sea level data frame with sea_input()
si &lt;- sea_input(Date = sea_dates, Value = sea_values)

# 4. Inspect the first few rows
head(si)

</code></pre>

<hr>
<h2 id='sea_std'>Calculate Standardized Sea Level Index</h2><span id='topic+sea_std'></span>

<h3>Description</h3>

<p>Calculates the standardized sea level index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sea_std(si, ci, freq = c("monthly", "seasonal"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sea_std_+3A_si">si</code></td>
<td>
<p>Data frame. Sea level input data created by <code><a href="#topic+sea_input">sea_input</a></code>.</p>
</td></tr>
<tr><td><code id="sea_std_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object containing the base range (e.g., created by <code><a href="#topic+climate_input">climate_input</a></code>).</p>
</td></tr>
<tr><td><code id="sea_std_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;seasonal&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and standardized sea level values.
</p>

<hr>
<h2 id='spell_length_max'>Maximum Length of Consecutive Dry Days</h2><span id='topic+spell_length_max'></span>

<h3>Description</h3>

<p>Calculates the maximum length of consecutive dry days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spell_length_max(daily_prec, date_factor, threshold, op, spells_can_span_years)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spell_length_max_+3A_daily_prec">daily_prec</code></td>
<td>
<p>Numeric vector. Daily precipitation data.</p>
</td></tr>
<tr><td><code id="spell_length_max_+3A_date_factor">date_factor</code></td>
<td>
<p>Factor. Date grouping factor.</p>
</td></tr>
<tr><td><code id="spell_length_max_+3A_threshold">threshold</code></td>
<td>
<p>Numeric. Precipitation threshold.</p>
</td></tr>
<tr><td><code id="spell_length_max_+3A_op">op</code></td>
<td>
<p>Character. Comparison operator.</p>
</td></tr>
<tr><td><code id="spell_length_max_+3A_spells_can_span_years">spells_can_span_years</code></td>
<td>
<p>Logical. Whether spells can span across years.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector. Maximum spell lengths.
</p>

<hr>
<h2 id='t10p'>Calculate T10p Index</h2><span id='topic+t10p'></span>

<h3>Description</h3>

<p>Calculates the combined percentage of days when temperature is below the 10th percentile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t10p(ci, freq = c("monthly", "annual"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="t10p_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object.</p>
</td></tr>
<tr><td><code id="t10p_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;annual&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and calculated T10p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate monthly T10p index
t10p_values &lt;- t10p(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='t10p_std'>Calculate Standardized T10p Index</h2><span id='topic+t10p_std'></span>

<h3>Description</h3>

<p>Calculates the standardized T10p index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t10p_std(ci, freq = c("monthly", "seasonal"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="t10p_std_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object.</p>
</td></tr>
<tr><td><code id="t10p_std_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;seasonal&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and standardized T10p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate standardized T10p index on a monthly basis
t10p_std_values &lt;- t10p_std(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='t90p'>Calculate T90p Index</h2><span id='topic+t90p'></span>

<h3>Description</h3>

<p>Calculates the combined percentage of days when temperature is above the 90th percentile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t90p(ci, freq = c("monthly", "annual"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="t90p_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object.</p>
</td></tr>
<tr><td><code id="t90p_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;annual&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and calculated T90p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate monthly T90p index
t90p_values &lt;- t90p(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='t90p_std'>Calculate Standardized T90p Index</h2><span id='topic+t90p_std'></span>

<h3>Description</h3>

<p>Calculates the standardized T90p index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t90p_std(ci, freq = c("monthly", "seasonal"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="t90p_std_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object.</p>
</td></tr>
<tr><td><code id="t90p_std_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;seasonal&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and standardized T90p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate standardized T90p index on a monthly basis
t90p_std_values &lt;- t90p_std(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='tapply.fast'>Fast tapply Function</h2><span id='topic+tapply.fast'></span>

<h3>Description</h3>

<p>Provides a faster implementation of tapply for factor-type indices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tapply.fast(X, INDEX, FUN = NULL, ..., simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tapply.fast_+3A_x">X</code></td>
<td>
<p>Numeric vector. Data to be applied.</p>
</td></tr>
<tr><td><code id="tapply.fast_+3A_index">INDEX</code></td>
<td>
<p>Factor. Indexing factor.</p>
</td></tr>
<tr><td><code id="tapply.fast_+3A_fun">FUN</code></td>
<td>
<p>Function. Function to apply.</p>
</td></tr>
<tr><td><code id="tapply.fast_+3A_simplify">simplify</code></td>
<td>
<p>Logical. Whether to simplify the result.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List or vector. Result of applying FUN to X grouped by INDEX.
</p>

<hr>
<h2 id='tn10p'>Calculate TN10p Index</h2><span id='topic+tn10p'></span>

<h3>Description</h3>

<p>Calculates the percentage of days when minimum temperature is below the 10th percentile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tn10p(ci, freq = c("monthly", "annual"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tn10p_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object created by <code><a href="#topic+climate_input">climate_input</a></code>.</p>
</td></tr>
<tr><td><code id="tn10p_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;annual&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and calculated TN10p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate monthly TN10p index
tn10p_values &lt;- tn10p(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='tn90p'>Calculate TN90p Index</h2><span id='topic+tn90p'></span>

<h3>Description</h3>

<p>Calculates the percentage of days when minimum temperature is above the 90th percentile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tn90p(ci, freq = c("monthly", "annual"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tn90p_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object created by <code><a href="#topic+climate_input">climate_input</a></code>.</p>
</td></tr>
<tr><td><code id="tn90p_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;annual&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and calculated TN90p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 5. Calculate monthly TN90p index
tn90p_values &lt;- tn90p(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='tx10p'>Calculate TX10p Index</h2><span id='topic+tx10p'></span>

<h3>Description</h3>

<p>Calculates the percentage of days when maximum temperature is below the 10th percentile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tx10p(ci, freq = c("monthly", "annual"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tx10p_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object created by <code><a href="#topic+climate_input">climate_input</a></code>.</p>
</td></tr>
<tr><td><code id="tx10p_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;annual&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and calculated TX10p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# Calculate monthly TX10p index
tx10p_values &lt;- tx10p(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='tx90p'>Calculate TX90p Index</h2><span id='topic+tx90p'></span>

<h3>Description</h3>

<p>Calculates the percentage of days when maximum temperature is above the 90th percentile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tx90p(ci, freq = c("monthly", "annual"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tx90p_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object created by <code><a href="#topic+climate_input">climate_input</a></code>.</p>
</td></tr>
<tr><td><code id="tx90p_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;annual&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and calculated TX90p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 5. Calculate monthly TX90p index
tx90p_values &lt;- tx90p(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='w90p'>Calculate W90p Index</h2><span id='topic+w90p'></span>

<h3>Description</h3>

<p>Calculates the percentage of days when wind speed is above the 90th percentile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w90p(ci, freq = c("monthly", "annual"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="w90p_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object created by <code><a href="#topic+climate_input">climate_input</a></code>.</p>
</td></tr>
<tr><td><code id="w90p_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot; or &quot;annual&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and calculated W90p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate monthly W90p index
w90p_values &lt;- w90p(ci, freq = "monthly")

</code></pre>

<hr>
<h2 id='w90p_std'>Calculate Standardized W90p Index</h2><span id='topic+w90p_std'></span>

<h3>Description</h3>

<p>Calculates the standardized W90p index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w90p_std(ci, freq = c("monthly", "seasonal"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="w90p_std_+3A_ci">ci</code></td>
<td>
<p>List. Climate input object.</p>
</td></tr>
<tr><td><code id="w90p_std_+3A_freq">freq</code></td>
<td>
<p>Character. Frequency of calculation, either &quot;monthly&quot;, &quot;seasonal&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with dates and standardized W90p values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Generate a daily date sequence from 1960-01-01 to 2020-12-31
dates &lt;- seq.Date(
  from = as.Date("1960-01-01"),
  to   = as.Date("2020-12-31"),
  by   = "day"
)

# 2. Create random weather data for each date
n &lt;- length(dates)
tmax &lt;- runif(n, min = 5, max = 40)
tmin &lt;- runif(n, min = -10,  max = 5)
# Example: use a Poisson distribution to simulate precipitation
prec &lt;- rpois(n, lambda = 2)
# Random wind speeds, e.g., 0 to 10 m/s
wind &lt;- runif(n, min = 0, max = 10)

# 3. Construct the climate_input object
ci &lt;- climate_input(
  tmax  = tmax,
  tmin  = tmin,
  prec  = prec,
  wind  = wind,
  dates = dates
)
# Then:
# 4. Calculate standardized W90p index on a monthly basis
w90p_std_values &lt;- w90p_std(ci, freq = "monthly")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
