<!DOCTYPE html><html><head><title>Help for package BHH2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BHH2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anovaPlot'><p>Graphical Anova</p></a></li>
<li><a href='#corrosion.data'><p>Corrosion data</p></a></li>
<li><a href='#dotPlot'><p> Dot plot: scatter plot with stacked dots similar to the stem-and-leaf plot</p></a></li>
<li><a href='#dots'><p>Dots display</p></a></li>
<li><a href='#ffDesMatrix'><p>Full or fractional factorial design matrix generation</p></a></li>
<li><a href='#ffFullMatrix'><p>Full model matrix from a design matrix</p></a></li>
<li><a href='#heads.data'><p>Machine heads data</p></a></li>
<li><a href='#lambdaPlot'><p>Lambda plot: traces the t and F statistics in Box-Cox transformation of the response</p></a></li>
<li><a href='#penicillin.data'><p>Penicillin data</p></a></li>
<li><a href='#permtest'><p>Permutation test: randomization test for small size samples</p></a></li>
<li><a href='#poison.data'><p>Poison example data set</p></a></li>
<li><a href='#shoes.data'><p>Boys' shoes data set</p></a></li>
<li><a href='#subsets'><p>Generation of all the combinations of k elements from n possible</p></a></li>
<li><a href='#tab03B1'><p> Table 3.2</p></a></li>
<li><a href='#tab03B2'><p> Table 3.3</p></a></li>
<li><a href='#tomato.data'><p>Tomato plants data set</p></a></li>
<li><a href='#woolen.data'><p>Textile experiment data set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2016.05.31</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-05-31</td>
</tr>
<tr>
<td>Title:</td>
<td>Useful Functions for Box, Hunter and Hunter II</td>
</tr>
<tr>
<td>Author:</td>
<td>Ernesto Barrios</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kjetil B.Halvorsen &lt;kjetil1001@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions and data sets reproducing some examples in
             Box, Hunter and Hunter II.  Useful for statistical design
             of experiments, especially factorial experiments.  </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>FrF2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-05-31 19:19:25 UTC; kjetil</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-05-31 23:18:13</td>
</tr>
</table>
<hr>
<h2 id='anovaPlot'>Graphical Anova</h2><span id='topic+anovaPlot'></span>

<h3>Description</h3>

<p>Dots plot displaying the deviations of factor levels from the mean
showing the residuals as reference distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    anovaPlot(obj, stacked = TRUE, base = TRUE, axes = TRUE,
    faclab = TRUE, labels = FALSE, cex = par("cex"),
    cex.lab = par("cex.lab"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anovaPlot_+3A_obj">obj</code></td>
<td>
<p>Object of class <code>aov</code> or <code>lm</code> for which marginal
deviations from the mean and the residuals distribution is displayed.</p>
</td></tr>
<tr><td><code id="anovaPlot_+3A_stacked">stacked</code></td>
<td>
<p>logical. If <code>TRUE</code> and if it is necessary the dots are
stacked, otherwise all points are displayed at same level with possible
overlapping.</p>
</td></tr>
<tr><td><code id="anovaPlot_+3A_base">base</code></td>
<td>
<p>logical. By default a base line is displayed for each factor.
If <code>FALSE</code> this line is omitted.</p>
</td></tr>
<tr><td><code id="anovaPlot_+3A_axes">axes</code></td>
<td>
<p>logical. By default a scaled axes is drawn for each factor.
If <code>FALSE</code> the axes are omitted.</p>
</td></tr>
<tr><td><code id="anovaPlot_+3A_faclab">faclab</code></td>
<td>
<p>logical. By default factor effect names and
&lsquo;Residuals&rsquo; are used to label each dot plot. No axis is labelled otherwise.</p>
</td></tr>
<tr><td><code id="anovaPlot_+3A_labels">labels</code></td>
<td>
<p>logical. By default, dots are used to the display.
If <code>labels=TRUE</code> then factor levels are displayed for the factor dots
plots and sequential enumeration is used for the residuals.</p>
</td></tr>
<tr><td><code id="anovaPlot_+3A_cex">cex</code></td>
<td>
<p>numeric. Expansion factor of the character used for labelling the factor levels.</p>
</td></tr>
<tr><td><code id="anovaPlot_+3A_cex.lab">cex.lab</code></td>
<td>
<p>numeric. Expansion factor of the character used for labelling each factor.</p>
</td></tr>
<tr><td><code id="anovaPlot_+3A_...">...</code></td>
<td>
<p>additional parameters passed to the <code>dots</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dots plot are displayed for the scaled deviations of factor levels from
the grand mean and the distribution of the residuals is shown at the bottom
of the plot for graphical comparison. The scaled factor for the factor
deviations is <code class="reqn">\sqrt{n/k}</code>, where <code class="reqn">k</code> and <code class="reqn">n</code>
are the factor and residuals degrees of freedom reported by <code>anova(obj)</code>.
If <code>labels=TRUE</code> then the factor levels are used for as points
instead of dots. This option is useful to post labelling the dot plots.
See <code><a href="#topic+dots">dots</a></code> function.
The Anova plot is built in a <code class="reqn">(0,1)\times(0,1)</code> plot
area. The area plot is divided to accommodate each of the factors and
the residual at the bottom of the plotting area. The function returns a
list with the coordinates of all the dots displayed.
</p>


<h3>Value</h3>

<p>The function is called for graphical display of factor levels mean and
residuals as reference distribution. An invisible list with the actual (x,y)
coordinates used for each of
the factors and residuals.
</p>


<h3>warning</h3>

<p>The function identifies as an interaction factor any factor
with the colon character &quot;:&quot; in its name. Factors like &quot;I(A:B)&quot;
will give you problems.
</p>


<h3>Note</h3>

<p>The anova plot presented here is thought for graphical comparison of
factor effects in one-layer balanced designed experiments. The function
is not prepared for general situations. However, representation of some
simple split-plot experiments is possible.
</p>


<h3>Author(s)</h3>

<p>Ernesto Barrios</p>


<h3>References</h3>

<p>Box G. E. P. (2000). <em>Box on Quality</em>.
Edited by G. C. Tiao et al. New York: Wiley.
</p>
<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dots">dots</a></code>, <code><a href="#topic+dotPlot">dotPlot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BHH2)
data(heads.data)
heads.data$periods &lt;- factor(heads.data$periods)
heads.data$heads &lt;- factor(heads.data$heads)

heads.aov &lt;- aov(resp~periods+heads,data=heads.data)
anovaPlot(heads.aov)

anovaPlot(heads.aov,labels=TRUE,faclab=TRUE)

</code></pre>

<hr>
<h2 id='corrosion.data'>Corrosion data</h2><span id='topic+corrosion.data'></span>

<h3>Description</h3>

<p>Corrosion resistance study data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(corrosion.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 4 variables.
</p>

<dl>
<dt>run</dt><dd><p>factor with 6 levels. The casting order.</p>
</dd>
<dt>heats</dt><dd><p>factor with 3 levels. The casting temperature.</p>
</dd>
<dt>coating</dt><dd><p>factor with 4 levels. The coating treatment.</p>
</dd>
<dt>resistance</dt><dd><p>numeric vector. Corrosion resistance response.</p>
</dd>
</dl>



<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(corrosion.data)
str(corrosion.data)
plot(corrosion.data)
</code></pre>

<hr>
<h2 id='dotPlot'> Dot plot: scatter plot with stacked dots similar to the stem-and-leaf plot </h2><span id='topic+dotPlot'></span>

<h3>Description</h3>

<p>Displays an one-dimensional scatter plot with stacking similar to stem-and-leaf plot or histograms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dotPlot(x, y = 0, xlim = range(x,na.rm=TRUE), xlab = NULL, 
    scatter = FALSE, hmax = 1, base = TRUE, axes = TRUE, frame = FALSE, 
    pch = 21, pch.size = "x", labels = NULL, hcex = 1, cex =par("cex"), 
    cex.axis = par("cex.axis"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dotPlot_+3A_x">x</code></td>
<td>
<p> numeric vector to be displayed.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_y">y</code></td>
<td>
<p>numeric. Height of the basis of the plot.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_xlim">xlim</code></td>
<td>
<p>numeric. Range of the x axis.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_xlab">xlab</code></td>
<td>
<p>character string. label for the horizontal axis.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_scatter">scatter</code></td>
<td>
<p>logical. If TRUE a one-dimensional scatter plot of x, similar to <code>rug</code>,
is displayed at the base of the plot.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_hmax">hmax</code></td>
<td>
<p>numeric. Height of the highest dot.
<code>hmax=1</code> as default. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_base">base</code></td>
<td>
<p>logical. If <code>TRUE</code> (default) a base line for the dots
(characters) is displayed.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_axes">axes</code></td>
<td>
<p>logical. If <code>TRUE</code> labelled axis is displayed.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_frame">frame</code></td>
<td>
<p>logical. If <code>FALSE</code> the plot frame is omitted.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_pch">pch</code></td>
<td>
<p>numeric or character. Character number or character to be used
for the display.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_pch.size">pch.size</code></td>
<td>
<p>numeric. Character to be used to distribute the &quot;dots&quot; (<code>pch</code>).
See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_labels">labels</code></td>
<td>
<p>character vector. If <code>NULL</code> (default) each point (dot)
is displayed using character <code>pch</code>, otherwise vector <code>labels</code>
is used for the display. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_hcex">hcex</code></td>
<td>
<p>numeric. Expansion (shrink) factor for character height.
See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_cex">cex</code></td>
<td>
<p>numeric. Expansion factor used for character display.
See <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>numeric. Expansion factor used in case of labelling the axis.</p>
</td></tr>
<tr><td><code id="dotPlot_+3A_...">...</code></td>
<td>
<p>additional graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Basically function <code>dotPlot</code> calls function <a href="#topic+dots">dots</a> to display
a stacked one-dimensional scatter plot within vertical limits 0 and 1.
See <code><a href="#topic+dots">dots</a></code> for more details.
</p>


<h3>Value</h3>

<p>The function is called for its side effect which is to produce one-dimensional
scatter plot with stacking as described, for example, in Chambers et al. (1983)
It returns invisible a data frame with the actual coordinates (in users units).
</p>


<h3>Note</h3>

<p>Since the dots are stacked vertically, their alignment is subject
to rounding errors. Dots may be slightly moved in either side from their
actual value.
</p>


<h3>Author(s)</h3>

<p>Ernesto Barrios</p>


<h3>References</h3>

<p> Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P.
A. (1983)
<em> Graphical Methods for Data Analysis.</em>
New York: Chapman \&amp; Hall
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+dots">dots</a></code>, <code><a href="graphics.html#topic+stem">stem</a></code>,<code><a href="graphics.html#topic+hist">hist</a></code>,<code><a href="graphics.html#topic+dotchart">dotchart</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BHH2)
data(tab03B1)
attach(tab03B1)
stem(yield) #stem-leaf plot
plt &lt;- dotPlot(yield) # equivalent dotPlot

# same dot plot with max and min observations labelled
plt &lt;- dotPlot(yield,xlim=c(75,95),xlab="yield",pch.size="x",hcex=1)
text(c(min(yield),max(yield),80),rep(0.05,3),c("min","max",80))
segments(80,min(plt$y),80,max(plt$y),lty=2)
detach()
</code></pre>

<hr>
<h2 id='dots'>Dots display</h2><span id='topic+dots'></span>

<h3>Description</h3>

<p>The function adds to the current plot an one-dimensional scatter plot with stacking similar to a
stem-leaf plot or histograms but using characters. .
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    dots(x = , y = 0.1, xlim = range(x,na.rm=TRUE), stacked = FALSE, hmax= 0.5,
    base = TRUE, axes = FALSE, pch = 21, pch.size = "x", labels = NULL,
    hcex = 1, cex = par("cex"), cex.axis = par("cex.axis"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dots_+3A_x">x</code></td>
<td>
<p>numeric vector to be displayed in the dot plot.</p>
</td></tr>
<tr><td><code id="dots_+3A_y">y</code></td>
<td>
<p>numeric. Height of the dots (characters) at the base level. By default
<code>y=0.1</code> thinking on a plot with <code>ylim=c(0,1)</code>.</p>
</td></tr>
<tr><td><code id="dots_+3A_xlim">xlim</code></td>
<td>
<p>numeric vector with 2 entries: <code>xmin</code> and <code>xmax</code>. These values determine
the width of the displayed dot plot not necessarily equal to the limits of the plot.</p>
</td></tr>
<tr><td><code id="dots_+3A_stacked">stacked</code></td>
<td>
<p>logical. If <code>TRUE</code> characters are stacked,
otherwise a scatter plot of the data is displayed at <code>y</code> level using character <code>pch</code>.</p>
</td></tr>
<tr><td><code id="dots_+3A_hmax">hmax</code></td>
<td>
<p>numeric. The maximum height in user units. By default
<code>hmax=0.5</code> thinking on a plot with <code>ylim=c(0,1)</code>. See <code>y</code>.</p>
</td></tr>
<tr><td><code id="dots_+3A_base">base</code></td>
<td>
<p>logical. If <code>TRUE</code> a horizontal line is displayed at the bottom of the plot.</p>
</td></tr>
<tr><td><code id="dots_+3A_axes">axes</code></td>
<td>
<p>logical. If <code>TRUE</code> an labelled axis is shown.</p>
</td></tr>
<tr><td><code id="dots_+3A_pch">pch</code></td>
<td>
<p>numeric or character. Character number or character to be used for the display.</p>
</td></tr>
<tr><td><code id="dots_+3A_pch.size">pch.size</code></td>
<td>
<p>numeric. Character to be used to distribute the &quot;dots&quot; (<code>pch</code>).
See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="dots_+3A_labels">labels</code></td>
<td>
<p>character vector. If <code>NULL</code> (default) each point (dot) is displayed using
character <code>pch</code>, otherwise vector <code>labels</code> is used for the display. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="dots_+3A_hcex">hcex</code></td>
<td>
<p>numeric. Expansion (shrink) factor for character height. See details.</p>
</td></tr>
<tr><td><code id="dots_+3A_cex">cex</code></td>
<td>
<p>numeric. Expansion factor used for character display. See <a href="graphics.html#topic+par">par</a>.</p>
</td></tr>
<tr><td><code id="dots_+3A_cex.axis">cex.axis</code></td>
<td>
<p>numeric. Expansion factor used in case of labelling the axis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>dots</code> adds to the current plot a dot plot similar to a
stem-and-leaf plot using characters specified by <code>pch</code> and
<code>labels=NULL</code>. If <code>labels</code> is not <code>NULL</code> then it is
expected to be a character vector and will
will be used to display each of the points. Its use is repeated or cut short if necessary.
The function computes the width and height size using character <code>pch.size</code> calling
<code>strwidth</code> and <code>strheight</code>, but displays <code>pch</code> instead.
Mainly this is used when <code>pch</code> is not given by a quoted character,
for example, <code>pch=21</code>. Also, currently the par(&quot;mkh&quot;) is ignored so
<code>hcex</code> is used to compute the &quot;working&quot; height of the characters:
<code>hcex*strheight(pch.size,units="user")</code>. If <code>stacked=TRUE</code>,
the base line is divided in subintervals of size <code>strwidth(pch.size)</code>
and computed the number of points in each subinterval. If maximum number
of stacked characters exceed <code>hmax</code> then the characters are overlapped to
adjust their total height to <code>hmax</code>.
</p>


<h3>Value</h3>

<p>Invisible data frame with columns (x,y,labels). &lsquo;x&rsquo; and &lsquo;y&rsquo; are the coordinates
in user units of each point and &lsquo;labels&rsquo; the corresponding character displayed.
</p>


<h3>Author(s)</h3>

<p>Ernesto Barrios</p>


<h3>See Also</h3>

<p><code><a href="#topic+dotPlot">dotPlot</a></code>, <code><a href="#topic+anovaPlot">anovaPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BHH2)
set.seed(4)
# Defines the height of the plot area between c(0,1)
dotPlot(rnorm(100),xlab="x")

x &lt;- rnorm(100)

# plots (possibly) overlapping points at y=0.3
dots(x,y=0.3)
# plots (possibly) overlapping points at y=0.4
dots(x,y=0.4,stacked=TRUE,base=FALSE)
# plots (hopefully) stacked points at y=0.5 allowing the dots to as high as 0.9
dots(x,y=0.5,stacked=TRUE,base=FALSE,hmax=.9)
</code></pre>

<hr>
<h2 id='ffDesMatrix'>Full or fractional factorial design matrix generation</h2><span id='topic+ffDesMatrix'></span>

<h3>Description</h3>

<p>The function generates the design matrix provided the
number of 2-levels design factors and defining relations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffDesMatrix(k, gen = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffDesMatrix_+3A_k">k</code></td>
<td>
<p>numeric. The number of 2-levels design factors in the designs.</p>
</td></tr>
<tr><td><code id="ffDesMatrix_+3A_gen">gen</code></td>
<td>
<p>list. If <code>NULL</code> (default) a full factorial design is
generated. Otherwise, each component of the list is a numeric vector of
corresponding to each of the defining relations used to compose the
design. See <strong>Details</strong>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A defining relation is declared by a vector where the first entry
corresponds to the left hand side (LHS) of the defining
equation. For example, if <code>k=5</code>, and <code>gen=list(c(-5,1,2,3,4))</code>,
then the defining equation is <code class="reqn">-5=1*2*3*4</code>. A full 2-levels (-1,1)
factorial design is generated. For each defining relation the LHS column
is replaced by the corresponding columns product. At the end repeated
runs are removed from the matrix.
</p>


<h3>Value</h3>

<p>The function returns a 2-levels design matrix with <code>k</code> columns.
</p>


<h3>Author(s)</h3>

<p>Ernesto Barrios</p>


<h3>See Also</h3>

<p><code><a href="conf.design.html#topic+conf.design">conf.design</a></code> of the
<span class="pkg"><a href="conf.design.html#topic+conf.design">conf.design</a></span> package,
<code><a href="FrF2.html#topic+FrF2">FrF2</a></code> from the <span class="pkg"><a href="FrF2.html#topic+FrF2">FrF2</a></span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ffDesMatrix(5) # Full 2^5 factorial design
ffDesMatrix(5,gen=list(c(5,1,2,3,4))) # 2^(5-1) factorial design
ffDesMatrix(5,gen=list(c(4,1,2),c(-5,1,3))) # 2^(5-2) factorial design
</code></pre>

<hr>
<h2 id='ffFullMatrix'>Full model matrix from a design matrix</h2><span id='topic+ffFullMatrix'></span>

<h3>Description</h3>

<p>The function builds the full matrix with the constant term, main effects and
interactions from a design matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ffFullMatrix(X, x, maxInt, blk = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffFullMatrix_+3A_x">X</code></td>
<td>
<p>numeric matrix. Design matrix.</p>
</td></tr>
<tr><td><code id="ffFullMatrix_+3A_x">x</code></td>
<td>
<p>numeric vector. Design matrix entries to use to construct the full model matrix.</p>
</td></tr>
<tr><td><code id="ffFullMatrix_+3A_maxint">maxInt</code></td>
<td>
<p>numeric. Highest interaction order.</p>
</td></tr>
<tr><td><code id="ffFullMatrix_+3A_blk">blk</code></td>
<td>
<p>numeric matrix. Each column correspond to a blocking factor.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Columns <code>x</code> of matrix <code>X</code> are used for main effects. All
the 2, ... , <code>maxInt</code> order interaction are constructed.
The first columns of the final matrix correspond to the constant term (1's)
and block factors.
</p>


<h3>Value</h3>

<p>The function returns list with the following components:
</p>
<table>
<tr><td><code>Xa</code></td>
<td>
<p>matrix</p>
</td></tr></table>
<p>. Augmented matrix with columns for the constant terms,
blocking factors, main effects, second order interactions, ..., etc.
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>numeric vector. Design matrix <code>X</code> factor (column) numbers
used to build the complete model matrix.</p>
</td></tr>
<tr><td><code>maxInt</code></td>
<td>
<p>numeric. The highest interaction order.</p>
</td></tr>
<tr><td><code>nTerms</code></td>
<td>
<p>numeric vector. Contains the number of blocking factors,
main effects, 2nd order interaction effects, ... , etc.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ernesto Barrios</p>


<h3>See Also</h3>

<p><code><a href="#topic+ffDesMatrix">ffDesMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(X &lt;- ffDesMatrix(5,gen=list(c(5,1,2,3,4))))
ffFullMatrix(X[,1:4],x=c(1,2,3,4),maxInt=2,blk=X[,5])
ffFullMatrix(X[,1:5],x=c(1,3,5),maxInt=3)
</code></pre>

<hr>
<h2 id='heads.data'>Machine heads data</h2><span id='topic+heads.data'></span>

<h3>Description</h3>

<p>Data set of the variability of machine heads in a quality improvement experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(heads.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 30 observations on the following 6 variables.
</p>

<dl>
<dt>obs</dt><dd><p>numeric. Observation number.</p>
</dd>
<dt>periods</dt><dd><p>factor. Periods factor (P1, ..., P6).</p>
</dd>
<dt>heads</dt><dd><p>factor. Type of head factor (H1, ..., H5).</p>
</dd>
<dt>days</dt><dd><p>factor. Day factor (D1 and D2).</p>
</dd>
<dt>shifts</dt><dd><p>factor. Shift factor (S1, S2, and S3).</p>
</dd>
<dt>resp</dt><dd><p>numeric. Response.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box, G. E. P. (1993). &quot;How to Get Lucky&quot;.
<em>Quality Engineering</em>, Vol. 5, No. 3, pp 517-524.
</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heads.data)
str(heads.data)
plot(heads.data)
</code></pre>

<hr>
<h2 id='lambdaPlot'>Lambda plot: traces the t and F statistics in Box-Cox transformation of the response</h2><span id='topic+lambdaPlot'></span>

<h3>Description</h3>

<p>Trace regression coefficients' <em>t</em>-values or <em>F</em>-ratios for different values of <code class="reqn">\lambda</code> in
the Box-Cox transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambdaPlot(mod, lambda = seq(-1, 1, by = 0.1), stat = "F", global = TRUE,
    cex = par("cex"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambdaPlot_+3A_mod">mod</code></td>
<td>
<p>list. A list of class <code>lm</code>.</p>
</td></tr>
<tr><td><code id="lambdaPlot_+3A_lambda">lambda</code></td>
<td>
<p>numeric. The values of <code class="reqn">\lambda</code> in the Box-Cox transformation. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="lambdaPlot_+3A_stat">stat</code></td>
<td>
<p>character. Either <code>"t"</code> of <code>"F"</code>, corresponding to the
coefficients' <em>t</em>-values or <em>F</em>-ratios to display.</p>
</td></tr>
<tr><td><code id="lambdaPlot_+3A_global">global</code></td>
<td>
<p>logical. Applied only for <code>stat="F"</code>, if <code>TRUE</code>,
the model's <em>F</em>-ratio is traced, otherwise the coefficients' <em>F</em>-statistics.</p>
</td></tr>
<tr><td><code id="lambdaPlot_+3A_cex">cex</code></td>
<td>
<p>numeric. Expansion factor used to label the trace lines.<code>par("cex")</code> bu default.</p>
</td></tr>
<tr><td><code id="lambdaPlot_+3A_...">...</code></td>
<td>
<p>additional graphical parameters passed to <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The response is transformed as
<code class="reqn">Y=(y^{\lambda}-1)/\lambda</code>
for each value of <code class="reqn">\lambda</code> (<code>lambda</code>) and the model refitted.
The <em>t</em>-values or <em>F</em>-ratios of the coefficients are saved for the display.
If <code>global=TRUE</code>, then the <em>F</em>-ratio of the whole model is
plotted instead.
</p>


<h3>Value</h3>

<p>The function returns an invisible list with components:
</p>
<table>
<tr><td><code>lambda</code></td>
<td>
<p>numeric. Vector of length <code>m</code> with the
different values of <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code>t.lambda</code></td>
<td>
<p>matrix (<code>k x m</code>), where <code>m</code>
is the number of coefficients in model <code>mod</code> without the intercept,
with the coefficient's <em>t</em>-values.</p>
</td></tr>
<tr><td><code>f.lambda</code></td>
<td>
<p>matrix (<code>k x m</code>) with the coefficient's <em>F</em>-values.
if <code>global = FALSE</code>, otherwise the matrix is (<code>1 x m</code>), with the
corresponding model <em>F</em>-ratio.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>For each value of <code class="reqn">\lambda</code> the model is refitted. Computations can be
done more efficiently and will be incorporated in future versions.</p>


<h3>Author(s)</h3>

<p>Ernesto Barrios</p>


<h3>References</h3>

<p>Box, G. E. P. and C. Fung (1995)
&quot;The Importance of Data Transformation in Designed Experiments for Life Testing&quot;.
<em>Quality Engineering</em>, Vol. 7, No. 3, pp. 625-68.
</p>
<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BHH2)
# Lambda Plot tracing t values.
data(woolen.data)
woolen.lm &lt;- lm(y~x1+x2+x3+I(x1^2)+I(x2^2)+I(x3^2)+
                    I(x1*x2)+I(x1*x3)+I(x2*x3)+I(x1*x2*x3),data=woolen.data)
lambdaPlot(woolen.lm,cex=.8,stat="t")

# Lambda Plot tracing F values.
woolen2.lm &lt;- lm(y~x1+x2+x3,data=woolen.data)
lambdaPlot(woolen2.lm,lambda=seq(-1,1,length=41),stat="F",global=TRUE)

# Lambda Plot tracing F values.
data(poison.data)
poison.lm &lt;- lm(y~treat*poison,data=poison.data)
lambdaPlot(poison.lm,lambda=seq(-3,1,by=.1),stat="F",global=FALSE)
</code></pre>

<hr>
<h2 id='penicillin.data'>Penicillin data</h2><span id='topic+penicillin.data'></span>

<h3>Description</h3>

<p>Penicillin yield example data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(penicillin.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations on the following 4 variables.
</p>

<dl>
<dt>blend</dt><dd><p>factor with 5 levels: <code>B1</code> <code>B2</code> <code>B3</code> <code>B4</code> <code>B5</code>.
Blend factor used to block the experiment.</p>
</dd>
<dt>run</dt><dd><p>numeric vector. Run order within the blocking (Blend) factor.</p>
</dd>
<dt>treat</dt><dd><p>factor with levels: <code>A</code> <code>B</code> <code>C</code> <code>D</code>.
The process variants called treatment.</p>
</dd>
<dt>yield</dt><dd><p>numeric vector. Experiment yield response.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (1978).
<em>Statistics for Experimenters</em>. New York: Wiley.
</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(penicillin.data)
str(penicillin.data)
plot(penicillin.data)
</code></pre>

<hr>
<h2 id='permtest'>Permutation test: randomization test for small size samples</h2><span id='topic+permtest'></span>

<h3>Description</h3>

<p>Permutation test for means and variance comparisons.</p>


<h3>Usage</h3>

<pre><code class='language-R'>       permtest(x, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permtest_+3A_x">x</code></td>
<td>
<p>numeric vector. Sample group X.</p>
</td></tr>
<tr><td><code id="permtest_+3A_y">y</code></td>
<td>
<p>numeric vector. Sample group Y.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the one&ndash;sample problem, the function builds all <code class="reqn">2^n</code>
possible <code class="reqn">\pm x_i</code> combinations. For the two&ndash;sample problem,
all possible <code class="reqn">B(n+m,n)</code> samples size
<code class="reqn">n</code> (=<code>length(x)</code>) and <code class="reqn">m</code> (=<code>length(y)</code>) are
generated and the permutation distributions for the <em>t</em>-statistics
and <em>F</em>-ratios. <em>p</em>-values are computed based on these
distributions.
</p>


<h3>Value</h3>

<p>The function returns the number <code class="reqn">N</code> of different samples
generated for the permutation distribution, the observed <em>t</em>-statistic,
its <em>p</em>-value, based on both, the parametric and permutation
distributions as well as the observed <em>F</em>-ratio and its corresponding
<em>p</em>-values. The test may take a long time to generate all the possible
combinations. It has been tested for <code class="reqn">n + m = 22</code> and
<code class="reqn">n &lt; 12</code>.
</p>


<h3>WARNING</h3>

<p>The test may take a long time to generate all the possible
combinations.</p>


<h3>Author(s)</h3>

<p>Ernesto Barrios</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>See Also</h3>

<p><code>onet.permutation</code> and <code>towt.permutation</code>
of <span class="pkg">DAAG</span> package, and <code>perm.test</code> of the <span class="pkg">exactRankTests</span>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BHH2)

# Permutation test for Tomato Data
data(tomato.data)
cat("Tomato Data (not paired):\n")
attach(tomato.data)
a &lt;- pounds[fertilizer=="A"]
b &lt;- pounds[fertilizer=="B"]
print(round(test &lt;- permtest(b,a),3))
detach()

# Permutation test for Boy's Shoes Example
data(shoes.data)
cat("Shoes Data (paired):\n")
attach(shoes.data)
x &lt;- matB-matA
print(round(test &lt;- permtest(x),3))
detach()

</code></pre>

<hr>
<h2 id='poison.data'>Poison example data set</h2><span id='topic+poison.data'></span>

<h3>Description</h3>

<p>Poison data from Biological Experiment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(poison.data)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>poison</dt><dd><p>factor with 3 levels: P1, P2 and P3.</p>
</dd>
<dt>treat</dt><dd><p>factor with 4 levels: trA, trB, trC and trD.</p>
</dd>
<dt>y</dt><dd><p>numeric. Survival time as response.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box, G. E. P. and D. R. Cox, An Analysis of Transformations (with discussion),
<em>Journal of the Royal Statistical Society</em>,
Series B, Vol. 26, No. 2, pp. 211&ndash;254.
</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(poison.data)
str(poison.data)
plot(poison.data)
</code></pre>

<hr>
<h2 id='shoes.data'>Boys' shoes data set</h2><span id='topic+shoes.data'></span>

<h3>Description</h3>

<p>Data for the Boys' Shoes Example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(shoes.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 5 variables.
</p>

<dl>
<dt>boy</dt><dd><p>numeric. Boy number.</p>
</dd>
<dt>matA</dt><dd><p>numeric. Amount of wear of shoe made from material A.</p>
</dd>
<dt>sideA</dt><dd><p>factor. Foot side which shoe of material A is used.</p>
</dd>
<dt>matB</dt><dd><p>numeric. Amount of wear of shoe made from material B.</p>
</dd>    
<dt>sideB</dt><dd><p>factor. Foot side which shoe of material B is used.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (1978). 
<em>Statistics for Experimenters</em>. New York: Wiley.
</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shoes.data)
str(shoes.data)
plot(shoes.data)
</code></pre>

<hr>
<h2 id='subsets'>Generation of all the combinations of k elements from n possible</h2><span id='topic+subsets'></span>

<h3>Description</h3>

<p>Generates all different subsets of size <code class="reqn">r</code> chosen from <code class="reqn">n</code>
different elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subsets(n, r, v = 1:n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subsets_+3A_n">n</code></td>
<td>
<p>numeric. Number of elements to choose from.</p>
</td></tr>
<tr><td><code id="subsets_+3A_r">r</code></td>
<td>
<p>numeric. Size of the subsets.</p>
</td></tr>
<tr><td><code id="subsets_+3A_v">v</code></td>
<td>
<p>vector. Numeric or character vector of size <code>n</code> with the
labels of the <code class="reqn">n</code> elements to choose from.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of dimension (<code class="reqn">N \times r</code>), where <code class="reqn">N</code> is
the total number of different combinations of <code class="reqn">r</code> elements chosen
from <code class="reqn">n</code> possible.
</p>


<h3>Note</h3>

<p>This particular version of the function was taken from a
message from Bill Venables to &lsquo;<span class="file">r-help</span>&rsquo; list on Sun, 17 Dec 2000.
</p>


<h3>Author(s)</h3>

<p>Bill Venables <a href="mailto:Bill.Venables@cmis.csiro.au">Bill.Venables@cmis.csiro.au</a></p>


<h3>References</h3>

<p>Venables, Bill. &quot;Programmers Note&quot;, R-News, Vol 1/1, Jan. 2001.
<a href="http://cran.r-project.org/doc/Rnews">http://cran.r-project.org/doc/Rnews</a>
</p>


<h3>See Also</h3>

<p><code>combinations</code> of the <span class="pkg">gtools</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BHH2)
subsets(5,3)
subsets(5,3,letters)
subsets(5,3,c(10,20,30,50,80))
</code></pre>

<hr>
<h2 id='tab03B1'> Table 3.2 </h2><span id='topic+tab03B1'></span>

<h3>Description</h3>

<p>Production record of 210 consecutive batch yield values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tab03B1)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>yield</dt><dd><p>a numeric vector</p>
</dd>
<dt>ave10</dt><dd><p>a numeric vector. Moving average of last 10 observations.
First 9 entries NA</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>tab03B1</code> data frame has 210 rows and 2 columns.
</p>


<h3>Source</h3>

<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (1978). 
<em>Statistics for Experimenters</em>. New York: Wiley.
</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BHH2)
data(tab03B1)
attach(tab03B1)
stem(yield)
stem(ave10)
plot(yield,xlab="time order",ylab="yield")
detach()
</code></pre>

<hr>
<h2 id='tab03B2'> Table 3.3 </h2><span id='topic+tab03B2'></span>

<h3>Description</h3>

<p>Reference set of differences between averages of two adjacent
sets of 10 successive batches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tab03B2)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>diff10</dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>tab03B2</code> data frame has 200 rows and 1 column.
First 9 entries are <code>NA</code>.
</p>


<h3>Source</h3>

<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (1978).
<em>Statistics for Experimenters</em>. New York: Wiley.
</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BHH2)
data(tab03B2)
attach(tab03B2)
# displays the differences as dot plot (similar to histograms)
plt &lt;- dotPlot(diff10,xlim=2.55*c(-1,+1),xlab="differences")
segments(1.3,0,1.3,max(plt$y))  #vertical line at x=1.3
detach()
</code></pre>

<hr>
<h2 id='tomato.data'>Tomato plants data set</h2><span id='topic+tomato.data'></span>

<h3>Description</h3>

<p>Yield of tomato plants under two different fertilizers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tomato.data)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>pos</dt><dd><p>numeric. Row position</p>
</dd>
<dt>pounds</dt><dd><p>numeric. Plant's yield in pounds.</p>
</dd>
<dt>fertilizer</dt><dd><p>factor. Type of fertilizer (A or B).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (1978).
<em>Statistics for Experimenters</em>. New York: Wiley.
</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tomato.data)
str(tomato.data)
plot(tomato.data)
</code></pre>

<hr>
<h2 id='woolen.data'>Textile experiment data set</h2><span id='topic+woolen.data'></span>

<h3>Description</h3>

<p>Woolen thread experiment data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(woolen.data)</code></pre>


<h3>Format</h3>

<p>This data frame with 27 observations contains the following columns:
</p>

<dl>
<dt>x1</dt><dd><p>numeric. Length of test specimens factor.</p>
</dd>
<dt>x2</dt><dd><p>numeric. Amplitude of loading cycle factor.</p>
</dd>
<dt>x3</dt><dd><p>numeric. Load factor.</p>
</dd>
<dt>y</dt><dd><p>numeric. Cycles to failure response.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box, G. E. P. and D. R. Cox (1964). 
&quot;An Analysis of Transformations (with discussion)&quot;,
<em>Journal of the Royal Statistical Society</em>, 
Series B, Vol. 26, No. 2, pp. 211&ndash;254.
</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters II</em>. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(woolen.data)
str(woolen.data)
plot(woolen.data)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
